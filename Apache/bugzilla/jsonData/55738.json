[{"count": 0, "tags": [], "bug_id": 55738, "is_private": false, "id": 171011, "attachment_id": null, "creator": "karpov@viva64.com", "creation_time": "2013-11-03T10:06:46Z", "time": "2013-11-03T10:06:46Z", "text": "Hello. I am recheck httpd-trunk 2.5.0 and find few issues.\nI am use PVS-Studio Static Code Analyzer http://www.viva64.com/\n\nSuspicious:\n\nV528 It is odd that pointer to 'char' type is compared with the '\\0' value. Probably meant: ** ctx->re_source == '\\0'. libhttpd util_expr_eval.c 167\n\nV528: http://www.viva64.com/en/d/0117/\n\ntypedef struct {\n  ....\n  const char **re_source;\n  ....\n} ap_expr_eval_ctx_t;\n\nstatic const char *ap_expr_eval_re_backref(ap_expr_eval_ctx_t *ctx, unsigned int n)\n{\n  int len;\n  if (!ctx->re_pmatch || !ctx->re_source ||\n      *ctx->re_source == '\\0' ||\n      ctx->re_nmatch < n + 1)\n    return \"\";\n  ....\n}\n-------------------------------------------------------------------------------\nV597 The compiler could delete the 'memset' function call, which is used to flush 'x' buffer. The RtlSecureZeroMemory() function should be used to erase the private data. apr apr_md4.c 362\n\nV597: http://www.viva64.com/en/d/0208/\n\nstatic void MD4Transform(apr_uint32_t state[4], const unsigned char block[64])\n{\n  apr_uint32_t a = state[0], b = state[1],\n               c = state[2], d = state[3],\n               x[APR_MD4_DIGESTSIZE];  \n  ....\n  /* Zeroize sensitive information. */\n  memset(x, 0, sizeof(x));\n}\n\nV597 The compiler could delete the 'memset' function call, which is used to flush 'tmpbuf' buffer. The RtlSecureZeroMemory() function should be used to erase the private data. apr apr_md5.c 436\nV597 The compiler could delete the 'memset' function call, which is used to flush 'final' buffer. The RtlSecureZeroMemory() function should be used to erase the private data. apr apr_md5.c 662\nV597 The compiler could delete the 'memset' function call, which is used to flush 'tmpbuf' buffer. The RtlSecureZeroMemory() function should be used to erase the private data. aprutil apr_md5.c 436\nV597 The compiler could delete the 'memset' function call, which is used to flush 'final' buffer. The RtlSecureZeroMemory() function should be used to erase the private data. aprutil apr_md5.c 662\nV597 The compiler could delete the 'memset' function call, which is used to flush 'x' buffer. The RtlSecureZeroMemory() function should be used to erase the private data. aprutil apr_md4.c 362\nV597 The compiler could delete the 'memset' function call, which is used to flush 'buf' buffer. The RtlSecureZeroMemory() function should be used to erase the private data. htdbm passwd_common.c 165\n-------------------------------------------------------------------------------\nV614 Potentially uninitialized pointer 'wch' used. apr start.c 58\n\nV614: http://www.viva64.com/en/d/0230/\n\nstatic int warrsztoastr(const char * const * *retarr,\n                        const wchar_t * arrsz, int args)\n{\n  const apr_wchar_t *wch;\n  ....\n\n  if (args < 0) {\n    for (args = 1, wch = arrsz; wch[0] || wch[1]; ++wch)\n      if (!*wch)\n       ++args;\n  }\n  wsize = 1 + wch - arrsz;\n  ....\n}\n-------------------------------------------------------------------------------\nV654 The condition 'retry < 2' of loop is always true. mod_proxy_wstunnel mod_proxy_wstunnel.c 436\n\nV654: http://www.viva64.com/en/d/0275/\n\nstatic int proxy_wstunnel_handler(....)\n{\n  int retry;\n  ....\n  retry = 0;\n  while (retry < 2) {\n    char *locurl = url;\n    ....\n    // Variable 'retry' is not used\n    ....\n  }\n  ....\n}\n\n----\nBest regards,\nAndrey Karpov\nPh.D. in Mathematics, CTO\nOOO \"Program Verification Systems\" (Co Ltd)\nURL: www.viva64.com\nE-Mail: karpov@viva64.com"}]