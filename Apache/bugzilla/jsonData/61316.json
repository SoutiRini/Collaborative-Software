[{"count": 0, "tags": [], "bug_id": 61316, "attachment_id": null, "text": "Testing 8.5.18 (Release candidate) from apache-tomcat-8.5.18-src.zip\nthe following test is consistently failing:\n\norg.apache.jasper.compiler.TestEncodingDetector\n\nTesting on Windows 10, Java 8/Java 7 x all connectors - all are failing.\n\nComparing unpacked -src.zip with fresh checkout of the tag,\nthe files used by this test differ.\n\n>svn st\nM       test\\webapp\\jsp\\encoding\\bom-none-prolog-utf16be.jspx\nM       test\\webapp\\jsp\\encoding\\bom-none-prolog-utf16le.jspx\nM       test\\webapp\\jsp\\encoding\\bom-utf16be-prolog-none.jsp\nM       test\\webapp\\jsp\\encoding\\bom-utf16be-prolog-none.jspx\nM       test\\webapp\\jsp\\encoding\\bom-utf16be-prolog-utf16be.jspx\nM       test\\webapp\\jsp\\encoding\\bom-utf16be-prolog-utf16le.jspx\nM       test\\webapp\\jsp\\encoding\\bom-utf16be-prolog-utf8.jspx\nM       test\\webapp\\jsp\\encoding\\bom-utf16le-prolog-none.jsp\nM       test\\webapp\\jsp\\encoding\\bom-utf16le-prolog-none.jspx\nM       test\\webapp\\jsp\\encoding\\bom-utf16le-prolog-utf16be.jspx\nM       test\\webapp\\jsp\\encoding\\bom-utf16le-prolog-utf16le.jspx\nM       test\\webapp\\jsp\\encoding\\bom-utf16le-prolog-utf8.jspx\n\nThe list of diffing files is the same for -src.zip and -src.tar.gz.\n\n\nLooking into the files from src.zip with a hex editor\n(e.g. bom-none-prolog-utf16be.jspx), I see sequences like\n000D 0A00 0D0A\n\nThese '0D0A' sequences apparently originate from LF -> CRLF conversion that treated these 16-bit files as 8-bit ones.\n\nLooking into the files from src.tar.gz, I see\n000A 000A\n\nAll line wraps are doubled - there are additional empty lines everywhere.\n\nThe correct file in svn repository has\n000D 000A", "id": 199872, "time": "2017-07-19T14:19:59Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2017-07-19T14:19:59Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 61316, "attachment_id": null, "id": 199877, "time": "2017-07-19T20:35:13Z", "creator": "chris@christopherschultz.net", "creation_time": "2017-07-19T20:35:13Z", "is_private": false, "text": "Could this be a svn client problem?\n\n$ svn pget svn:mime-type test/webapp/jsp/encoding/bom-none-prolog-none.jspx\ntext/plain; charset=UTF-8\n$ svn pget svn:eol-style test/webapp/jsp/encoding/bom-none-prolog-none.jspx\nnative\n\n$ svn pget svn:mime-type test/webapp/jsp/encoding/bom-utf16be-prolog-utf16le.jspx\ntext/plain; charset=UTF-16BE\n$ svn pget svn:eol-style test/webapp/jsp/encoding/bom-utf16be-prolog-utf16le.jspx\nsvn: warning: W200017: Property 'svn:eol-style' not found on 'test/webapp/jsp/encoding/bom-utf16be-prolog-utf16le.jspx'\nsvn: E200000: A problem occurred; see other errors for details\n\nShould the eol-style be set for any of these files? Should the mime-type be application/binary, or do we trust svn clients not to botch the encoding?"}, {"count": 2, "tags": [], "creator": "knst.kolinko@gmail.com", "attachment_id": null, "text": "svn is configured correctly:\nIf I run the tests from svn checkout, it completes successfully on my Windows, and it completes successfully at Buildbot (on Linux).\n\nFrom svn pont of view the files with 16-bit characters should be treated as binary. The should not have svn:eol-style property on them.\n\n\nThe problem is with configuration of <fixcrlf> task in build.xml.", "id": 199890, "time": "2017-07-20T13:13:29Z", "bug_id": 61316, "creation_time": "2017-07-20T13:13:29Z", "is_private": false}, {"count": 3, "tags": [], "creator": "markt@apache.org", "is_private": false, "text": "Fixed in:\n- trunk for 9.0.0.M25 onwards\n- 8.5.x for 8.5.19 onwards", "id": 199981, "time": "2017-07-24T11:55:11Z", "bug_id": 61316, "creation_time": "2017-07-24T11:55:11Z", "attachment_id": null}]