[{"attachment_id": 21756, "tags": [], "bug_id": 44732, "is_private": false, "count": 0, "id": 115204, "time": "2008-04-01T14:21:50Z", "creator": "tuure.laurinolli@indagon.com", "creation_time": "2008-04-01T14:21:50Z", "text": "Created attachment 21756\nTest program\n\nThe attached test program when run against the attached test file throws ClassCastException.\n\nSteps to reproduce:\n- Run attached test program with attached test file\n\nActual result:\n- Program crashes with the following stack trace:\nStack trace:\njava -cp lib/poi-3.0.2-FINAL-20080204.jar:. MinimalTest\nException in thread \"main\" java.lang.ClassCastException: org.apache.poi.hpsf.PropertySet cannot be cast to org.apache.poi.hpsf.DocumentSummaryInformation\n        at org.apache.poi.POIDocument.readProperties(POIDocument.java:74)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:171)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:259)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:240)\n        at MinimalTest.main(MinimalTest.java:7)\n\nExpected result:\n- The program should exit succesfully\n\nExact POI version:\npoi-3.0.2-FINAL-20080204.jar"}, {"attachment_id": 21757, "tags": [], "bug_id": 44732, "is_private": false, "count": 1, "id": 115205, "time": "2008-04-01T14:22:58Z", "creator": "tuure.laurinolli@indagon.com", "creation_time": "2008-04-01T14:22:58Z", "text": "Created attachment 21757\nTest data"}, {"count": 2, "tags": [], "creator": "tuure.laurinolli@indagon.com", "attachment_id": null, "id": 115206, "time": "2008-04-01T14:26:44Z", "bug_id": 44732, "creation_time": "2008-04-01T14:26:44Z", "is_private": false, "text": "Additional information:\n- The test data is saved with a Debian OpenOffice.org 2.0.4.9 from Debian \n- If the test data is opened with OO.o 2.2.1 for Windows and resaved, POI can open it\n\nIs it just a broken file that OO.o can cope with for some reason? Even in that case ClassCastException is a bit rough :)"}, {"count": 3, "tags": [], "creator": "josh@apache.org", "attachment_id": null, "is_private": false, "id": 115223, "time": "2008-04-01T18:36:15Z", "bug_id": 44732, "creation_time": "2008-04-01T18:36:15Z", "text": "The sample code + spreadsheet work OK in the latest svn trunk.\n\nPOIDocument.java must have changed since 3.0.2.  Line 74 does not seem to correspond to the supplied stack trace.\n\nIf you find the same problem on the latest trunk, please re-open this bug.\n"}, {"attachment_id": null, "tags": [], "creator": "tuure.laurinolli@indagon.com", "text": "Hm yes, appparently some kind of fix for this was applied to trunk in r620582.", "count": 4, "id": 115231, "time": "2008-04-02T01:42:04Z", "bug_id": 44732, "creation_time": "2008-04-02T01:42:04Z", "is_private": false}]