[{"count": 0, "tags": [], "bug_id": 21723, "text": "If the @dir of a <fileset> does not exist, it causes the build to fail, but this\ncauses a problem in the following scenario:\n\n1. my build script needs to accept two env variables.\n   either one (or both) of them need to be present.\n\n2. Those two env vars are used to build a classpath. thus:\n\n   <path id=\"classpath\">\n     <fileset dir=\"${env.VARIABLE1}/lib\" includes=\"*.jar\" />\n     <fileset dir=\"${env.VARIABLE2}/sub/lib\" includes=\"*.jar\" />\n   </path>\n\n3. this classpath is shared from various targets in the build script,\n   therefore it needs to be defined at the top-level.\n\n4. but if only VARIABLE1 is defined and VARIABLE2 is not, it causes\n   the build failure, and there's no workaround for it.\n\n\nthis would have been very simple if I could write:\n\n   <path id=\"classpath\">\n     <fileset dir=\"${env.VARIABLE1}/lib\" includes=\"*.jar\" if=\"env.VARIABLE1\"/>\n     <fileset dir=\"${env.VARIABLE2}/sub/lib\" includes=\"*.jar\" if=\"env.VARIABLE2\" />\n   </path>\n\nThis feature would have many uses. For example, when I create a zip file, I\ncould change the contents of it based on the build property.\n\n\nAlso, little Google search shows that I'm not the only one who'd like to see\nthis feature. See http://ant-contrib.sourceforge.net/fileset.html", "id": 40954, "time": "2003-07-18T23:14:40Z", "creator": "kk@kohsuke.org", "creation_time": "2003-07-18T23:14:40Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "stevel@apache.org", "attachment_id": null, "is_private": false, "id": 40956, "time": "2003-07-18T23:47:46Z", "bug_id": 21723, "creation_time": "2003-07-18T23:47:46Z", "text": "Patternsets have conditionality -have you tried using them to define a fileset"}, {"attachment_id": null, "tags": [], "creator": "kk@kohsuke.org", "is_private": false, "count": 2, "id": 40957, "time": "2003-07-19T00:00:34Z", "bug_id": 21723, "creation_time": "2003-07-19T00:00:34Z", "text": "Specifying non-existent directory to the dir attribute of <fileset>\ncauses the problem, so I fail to see how a conditional <patternset>\nwill solve this issue.\n\nIn other words, if the property \"var\" is undefined,\n\n<fileset dir=${var}\">\n  <patternset refid=\"some.conditional.pattern\" />\n</fileset>\n\nwill always fail regardless of the actual definition of the pattern set.\n\nSo my understanding is that it doesn't help my particular case.\n\n(In fact, it seems to me that I can now argue that <fileset>s should have @if\nand @unless since <patternset>s do)"}, {"count": 3, "tags": [], "creator": "jan@materne.de", "attachment_id": null, "is_private": false, "id": 43761, "time": "2003-09-05T16:26:59Z", "bug_id": 21723, "creation_time": "2003-09-05T16:26:59Z", "text": "That problem of \"non-existing-directory-filesets\" is topic of 11270.\n\n*** This bug has been marked as a duplicate of 11270 ***"}]