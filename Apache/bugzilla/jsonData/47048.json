[{"text": "Created attachment 23508\nworkbook containing the scenario described\n\nI've got a named range in my Excel sheet: \nIs_Multicar_Vehicle(='Veh Applicability'!$B$17:$G$17) i.e the above named range refers to cells from B17 to G17 in another sheet named \"Veh Applicability\".\n\nNow I've the following formula in a cell C19 of sheet named \"Input\".\n=SUM(Is_Multicar_Vehicle)\n\nThe following is the code snippet used to evaluate the above cell\n\t\t\tHSSFCell cell1 =  workbook.getSheet(\"Input\").getRow(18).getCell(2);\n\t\t\tCellValue MultipleCarIndicator1 =  hsf.evaluate(cell1);\n\t\t\t\n\nWhen I try to evalute the above cell, I am getting the below exception\nException in thread \"main\" java.lang.RuntimeException: Don't now how to evalate name 'Is_Multicar_Vehicle'\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.getEvalForPtg(WorkbookEvaluator.java:439)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateFormula(WorkbookEvaluator.java:334)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateAny(WorkbookEvaluator.java:216)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluate(WorkbookEvaluator.java:180)\n\tat org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluateFormulaCellValue(HSSFFormulaEvaluator.java:297)\n\tat org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluate(HSSFFormulaEvaluator.java:159)\n\t\nI'm attaching the excel sheet used.\nI've used both POI 3.2 final and the 3.5beta5 release.\nPlease fix this issue. I am very much in need of this.\n\nRegards,\nKiran Sireesh", "tags": [], "bug_id": 47048, "attachment_id": 23508, "count": 0, "id": 126354, "time": "2009-04-18T04:39:56Z", "creator": "kiransireesh@gmail.com", "creation_time": "2009-04-18T04:39:56Z", "is_private": false}, {"count": 1, "attachment_id": null, "creator": "josh@apache.org", "text": "Fixed in svn r775376.\n\njunits added\n\nIn your sample workbook, the defined name \"Is_Multicar_Vehicle\" is marked as 'complex' even though it is just an area ref.\nCurrently POI only evaluates defined names which are simple cell or area references.  Until now (according to existing test samples) it was assumed that these would not be flagged as complex.  It is not clear what the 'complex' flag is used for.\n\nBTW - there was another bug in POI's implementation of INDEX() that would prevent your example code from completing. This has been fixed in svn r775360.  POI now produces the correct result: 1.0", "id": 127047, "time": "2009-05-15T15:56:11Z", "bug_id": 47048, "creation_time": "2009-05-15T15:56:11Z", "tags": [], "is_private": false}]