[{"count": 0, "tags": [], "bug_id": 17075, "text": "The OS is IBM z/OS 1.2.\n\nWhen using the jar task on z/OS, the manifest.mf cannot be read. (The error is\nalso on ear and war tasks). \n\nWhen the manifest file is in ascii format (having been transmitted as binary\nfrom the IDE to the z/OS based source control system) The following error is\nproduced:\n\n[jar] Manifest is invalid: Manifest line \"(/>\u00d1\u00c3\u00c1\u00cb\u00c8\u00ee\u00c1\u00ca\u00cb\u00d1?>\n\nBUILD FAILED\nfile:/home/t129563/projects/deploy/genericUBSbuild.xml:32: Invalid Manifest:\n/home/t129563/projects/trade2v2/TradeEJBs/bin/META-INF/MANIFEST.MF\n        at org.apache.tools.ant.taskdefs.Jar.getManifest(Jar.java:225)\n        at org.apache.tools.ant.taskdefs.Jar.getManifest(Jar.java:201)\n        at org.apache.tools.ant.taskdefs.Jar.createManifest(Jar.java:284)\n        etc.... \n\nThe manaifest class is using a Reader and therefore trying to translate from\nnative encoding (IBM-1047). But the file is not in nmative encoding, and it\nwould not be natural for it to be under these circumstances (in a source control\nrepository).\n\nWhen the manfiest on z/OS is in EBCDIC format (for the purposes of testing this)\n, then the build runs through OK but the resulting manifest file in the jar is\nstill in EBCDIC format and is therefore useless. \n\nFrom what I can see, the problem is that the manifest.class uses a Reader to\nopen and parse the manifest file, this expects to convert from the native\nencoding. Later when the manifest is copied, a Stream is used which takes no\naccount of encoding.\n\nThere is no work around for this problem.\n\nFor the jar related tasks to work under z/OS the manifest should be read as\nascii without any codepage conversion.", "id": 31283, "time": "2003-02-14T10:29:52Z", "creator": "neal.johnston-ward@ubs.com", "creation_time": "2003-02-14T10:29:52Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "conor@apache.org", "attachment_id": null, "text": "I have changed the Manifest code to read and write manifests in UTF-8. The spec\nintimates that this should be the case (although it is not explicitly stated).\nThanks. Could you try the next nightly build?", "id": 31347, "time": "2003-02-16T02:37:38Z", "bug_id": 17075, "creation_time": "2003-02-16T02:37:38Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 17075, "text": "Thanks for your help to this problem,\n\nI have tested with the nightly build of the 16th Feb, and also with the CVS\nsnapshot of the 17th, but none of these fix my problem. Are you sure that your\nchanges went it, because I cannot see any changes in Jar.java (or Manifest.java)\nrelated to this problem.\n\nI will test tomorrow with the nightly build of the 17th to see if it has the\nchanges.\n\nThanks\n\nNeal", "id": 31447, "time": "2003-02-17T14:50:15Z", "creator": "neal.johnston-ward@ubs.com", "creation_time": "2003-02-17T14:50:15Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "I have taken the latest build and the modifications work fine on z/OS.\n\nThanks for resolving this problem.\n\nNeal", "attachment_id": null, "id": 31504, "creator": "neal.johnston-ward@ubs.com", "time": "2003-02-18T12:24:41Z", "bug_id": 17075, "creation_time": "2003-02-18T12:24:41Z", "is_private": false}, {"count": 4, "tags": [], "creator": "conor@apache.org", "attachment_id": null, "text": "The change to using UTF-8 caused some problems when Ant 1.5.2 was released since\nthey relied on the platform default encoding. Well, actually I believe their\nmanifests would have been invalid but that is maybe beside the point. I have\nreverted the behaviour to using the platform encoding and introduced a\nmanifestencoding attribute to allow that to be overridden.\n\nIf you are interested, you could check out the next nightly build.\n\nThanks", "id": 33637, "time": "2003-03-22T10:36:22Z", "bug_id": 17075, "creation_time": "2003-03-22T10:36:22Z", "is_private": false}]