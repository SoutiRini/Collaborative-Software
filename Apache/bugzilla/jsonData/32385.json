[{"count": 0, "tags": [], "bug_id": 32385, "attachment_id": null, "id": 67438, "time": "2004-11-25T01:20:34Z", "creator": "jplejacq@quoininc.com", "creation_time": "2004-11-25T01:20:34Z", "is_private": false, "text": "An SVN checkout of revision 106423 on 2004-Nov-24 seems to be broken.  When\ncreating a new document in the default document, the following errors are observed:\n\n* The sitetree in the Site tab is no longer visible.\n\n* Selecting the navigation link to the new document causes the following\n  exception:\n\ncause: org.apache.lenya.ac.AccessControlException:\njava.lang.StringIndexOutOfBoundsException: String index out of range: -1\n\nstacktrace[hide]\n\norg.apache.lenya.ac.AccessControlException:\njava.lang.StringIndexOutOfBoundsException: String index out of range: -1\n\tat\norg.apache.lenya.cms.ac.DocumentPolicyManagerWrapper.getPolicyURL(DocumentPolicyManagerWrapper.java:94)\n\tat\norg.apache.lenya.cms.ac.DocumentPolicyManagerWrapper.getPolicy(DocumentPolicyManagerWrapper.java:226)\n\tat\norg.apache.lenya.ac.impl.PolicyAuthorizer.authorizePolicy(PolicyAuthorizer.java:136)\n\tat org.apache.lenya.ac.impl.PolicyAuthorizer.authorize(PolicyAuthorizer.java:101)\n\tat\norg.apache.lenya.ac.impl.DefaultAccessController.authorize(DefaultAccessController.java:117)\n\tat\norg.apache.lenya.ac.impl.BypassableAccessController.authorize(BypassableAccessController.java:154)\n\tat\norg.apache.lenya.cms.cocoon.acting.DelegatingAuthorizerAction.doAct(DelegatingAuthorizerAction.java:67)\n\tat\norg.apache.lenya.cms.cocoon.acting.AccessControlAction.act(AccessControlAction.java:83)\n\tat\norg.apache.lenya.cms.cocoon.acting.DelegatingAuthorizerAction.act(DelegatingAuthorizerAction.java:49)\n\nThe page seems to be correctly created and the sitetree.xml properly updated."}, {"count": 1, "tags": [], "text": "I get the same exception with:\ncocoon-2.1.5.1-src.tar.gz\nlenya_20041127234150.tar.gz\nUsing Jetty\n\n\nAlso, if I edit an existing page with BXE, when I save:\nDocument couldn't be saved Something went wrong: 200 <html><body/></html>\nerror.log:\nERROR   (2004-11-28) 01:28.20:841   [flow] (/default/authoring/index.html)\nPoolThread-0/FOM_Cocoon.FOM_Log: Can not edit doucment\n\n\nWhen I launch BXE:\norg.apache.excalibur.source.SourceNotFoundException:\nfile:/var/lenya/build/lenya/webapp/lenya/pubs/default/resources/misc/bxe/homepage-bxe.css\ndoesn't exist.\n", "attachment_id": null, "bug_id": 32385, "id": 67514, "time": "2004-11-28T07:34:07Z", "creator": "AHands@unforgettable.com", "creation_time": "2004-11-28T07:34:07Z", "is_private": false}, {"count": 2, "tags": [], "creator": "roku@apache.org", "attachment_id": null, "id": 67515, "time": "2004-11-28T09:42:13Z", "bug_id": 32385, "creation_time": "2004-11-28T09:42:13Z", "is_private": false, "text": "Works for me:\n\nLinux+cocoon 2.1.5.1"}, {"count": 3, "tags": [], "bug_id": 32385, "is_private": false, "text": "Here's the bug:\n\norg/apache/lenya/cms/publication/DefaultDocumentBuilder.java\n.getLanguage(String)\n\n if (url.length() >= 3 && url.substring(url.length() -6).indexOf(\"_\") != -1) {\n\nThat \"3\" should be a \"6\"\n\nAccording to svn, this bug was introduced on Monday:\n> Lifted 2-letter language code restriction. It is now possible to create pages\n> with a language code of zh-tw, for instance.\n> It is still possible to use the short en, de as well.\n", "id": 67529, "time": "2004-11-29T01:23:13Z", "creator": "AHands@unforgettable.com", "creation_time": "2004-11-29T01:23:13Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "andreas@apache.org", "attachment_id": null, "is_private": false, "id": 67884, "time": "2004-12-03T17:26:10Z", "bug_id": 32385, "creation_time": "2004-12-03T17:26:10Z", "text": "I fixed in in 1.2.X. Does the problem also apply to the trunk?"}, {"count": 5, "tags": [], "creator": "gregor@apache.org", "attachment_id": null, "is_private": false, "id": 67923, "time": "2004-12-04T05:52:32Z", "bug_id": 32385, "creation_time": "2004-12-04T05:52:32Z", "text": "your fix breaks extended language codes:\n\nThe requested document '/index_de-CH.html' with document-id '/index_de-CH' does\nnot exist.\n"}, {"count": 6, "tags": [], "bug_id": 32385, "attachment_id": null, "id": 67975, "time": "2004-12-06T10:00:51Z", "creator": "andreas@apache.org", "creation_time": "2004-12-06T10:00:51Z", "is_private": false, "text": "OK, I'll try it again.\nSeems to be either this way or that :)"}, {"count": 7, "tags": [], "creator": "andreas@apache.org", "is_private": false, "text": "Should work now in 1.2.X.", "id": 67976, "time": "2004-12-06T10:42:48Z", "bug_id": 32385, "creation_time": "2004-12-06T10:42:48Z", "attachment_id": null}, {"count": 8, "tags": [], "creator": "A.Kuckartz@ping.de", "attachment_id": null, "is_private": false, "id": 68031, "time": "2004-12-07T08:58:17Z", "bug_id": 32385, "creation_time": "2004-12-07T08:58:17Z", "text": "Reduced severity to major. The fix should be tested before release."}, {"count": 9, "tags": [], "bug_id": 32385, "is_private": false, "text": "this has been fixed", "id": 69973, "time": "2005-01-22T04:59:04Z", "creator": "gregor@apache.org", "creation_time": "2005-01-22T04:59:04Z", "attachment_id": null}]