[{"count": 0, "tags": [], "creator": "gls@gknw.net", "text": "Hello folks,\n\nTrunk R664253 Branch R664254 added the DBD_LIST to the build process. \nThe makefile checked if DBD_LIST was defined or it would gently tell you\nthat the drivers could not be made as none were defined. \n\n!IFDEF DBD_LIST\n..\n..\n!ELSE\n#     no DBD_LIST\n\n_trydbd:\n\t@echo -----\n\t@echo apr_dbd drivers will not build unless DBD_LIST is set to the list\n\t@echo of all the client modules available in the LIB and INCLUDE path.\n\n!ENDIF\n\nTrunk R704771 Branch R712514 removed the check for the DBD_LIST since the odbc driver was going to be built on Windows since support for odbc is built in. At this time the above check was removed and the odbc was directly inserted into the for loop prior to the value of the DBD_LIST render the check unnecessary. Had this unneeded check been left behind, it would have at least been a clue when adding dbm in the build. \n\nTrunk R799069 Branch R799070 \n\n-_trydbd:\n+_trydb:\n..\n..\n+\tcd ..\\dbm\n+\tfor %d in ($(DBM_LIST)) do \\\n+\t  $(MAKE) $(MAKEOPT) -f apr_dbm_%d.mak CFG=\"apr_dbm_%d - Win32 $(LONG)\" RECURSE=0 $(CTARGET)\n \tcd ..\\..\\..\n !ELSEIF $(USESLN) == 1\n..\n..\n !ELSE\n..\n..\n+\t@for %d in ($(DBM_LIST)) do \\\n+\t  msdev Apache.dsw /USEENV /MAKE \\\n+\t\t\"apr_dbm_%d - Win32 $(LONG)\" /NORECURSE $(CTARGET)\n !ENDIF\n\nThe problem show up cause unlike odbc, there is no built in support for any of the DBMs and since they have been added to the dbd build section without a check to see if DBM_LIST is actually defined, the for loop is being fed and undefined value and nmake barfs. \n\nfor %d in () do \\\n\n--------------------Configuration: apr_dbd_odbc - Win32 Release--------------------\nLinking...\n   Creating library Release/apr_dbd_odbc-1.lib and object Release/apr_dbd_odbc-1.exp\nEmbed .manifest\napr_dbd_odbc-1.dll - 0 error(s), 0 warning(s)\nNMAKE : fatal error U1077: 'for' : return code '0x3020302'\nStop.\nError executing NMAKE.\n\nSee attached patches. It is not pretty but the dbd and dbm cannot simply be built together and a separate build for dbm is a made necessary.\n\nGregg", "id": 129557, "time": "2009-08-07T00:30:32Z", "bug_id": 47659, "creation_time": "2009-08-07T00:30:32Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "gls@gknw.net", "text": "Created attachment 24115\npatch against trunk", "id": 129558, "time": "2009-08-07T00:31:25Z", "bug_id": 47659, "creation_time": "2009-08-07T00:31:25Z", "is_private": false, "attachment_id": 24115}, {"count": 2, "attachment_id": 24116, "bug_id": 47659, "text": "Created attachment 24116\npatch against branch", "id": 129559, "time": "2009-08-07T00:32:03Z", "creator": "gls@gknw.net", "creation_time": "2009-08-07T00:32:03Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 47659, "attachment_id": null, "text": "Gregg, thanks for the patch, will integrate.", "id": 129568, "time": "2009-08-07T07:18:59Z", "creator": "wrowe@apache.org", "creation_time": "2009-08-07T07:18:59Z", "is_private": false}]