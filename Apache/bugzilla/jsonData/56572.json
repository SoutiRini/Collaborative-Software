[{"count": 0, "tags": [], "bug_id": 56572, "text": "Hi, \n\nAs define in the interface org.apache.poi.ss.usermodel.Cell, the method setStyle can accept a null value (from javadoc) : \"If the value is null then the style information is removed causing the cell to used the default workbook style.\"\n\nOr when I look at the implemenation in HSSFCell, I saw that: \npublic void setCellStyle(CellStyle style) {\n        setCellStyle( (HSSFCellStyle)style );\n    }\n    public void setCellStyle(HSSFCellStyle style) {\n        // Verify it really does belong to our workbook\n        style.verifyBelongsToWorkbook(_book);\n\n        short styleIndex;\n        if(style.getUserStyleName() != null) {\n            styleIndex = applyUserCellStyle(style);\n        } else {\n            styleIndex = style.getIndex();\n        }\n\n        // Change our cell record to use this style\n        _record.setXFIndex(styleIndex);\n    }\n\nSo a null value is not checked and not taken into account.\n\nThanks,\n\nMayeul", "id": 175532, "time": "2014-05-28T15:26:36Z", "creator": "mayeul.rousselet@gmail.com", "creation_time": "2014-05-28T15:26:36Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 56572, "text": "How does XSSF behave in this case?\n\n(i.e. is this a bug in the javadoc, or a hssf specific bit of missing functionality)", "id": 175533, "time": "2014-05-28T16:40:17Z", "creator": "apache@gagravarr.org", "creation_time": "2014-05-28T16:40:17Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "text": "Hi,\n\nXssf behaves as expected : \n\npublic void setCellStyle(CellStyle style) {\n    if(style == null) {\n        if(_cell.isSetS()) _cell.unsetS();\n    } else {\n     ....\n    }\n}", "is_private": false, "bug_id": 56572, "id": 175541, "time": "2014-05-29T09:30:16Z", "creator": "mayeul.rousselet@gmail.com", "creation_time": "2014-05-29T09:30:16Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "apache@gagravarr.org", "is_private": false, "id": 175543, "attachment_id": null, "bug_id": 56572, "creation_time": "2014-05-29T11:40:34Z", "time": "2014-05-29T11:40:34Z", "text": "Thanks for investigating, fixed in r1598258."}, {"count": 4, "attachment_id": null, "creator": "mayeul.rousselet@gmail.com", "text": "I am really amazed by your responsiveness.\nGlad to help and thanks a lot.\n\nMayeul", "id": 175544, "time": "2014-05-29T11:45:22Z", "bug_id": 56572, "creation_time": "2014-05-29T11:45:22Z", "tags": [], "is_private": false}]