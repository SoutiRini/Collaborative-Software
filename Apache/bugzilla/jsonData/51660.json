[{"count": 0, "tags": [], "bug_id": 51660, "text": "Hi,\n\nI'm deploying a POI program using Java Web Start (JWS, which uses .jnlp files). It worked, but there was a long (30 second) pause. The pause only occured when launching using JWS, and it occurred at the moment POI code was called. When launching my app locally there was no pause. In the java console, i typed '5' to get the verbose JWS output to see what was happening during the pause. The console showed that JWS was looking for an 'xbean.jar' file, repeatedly for the whole 30 seconds. I couldn't figure out why, since the POI binary distribution had no xbean.jar file, it only included the xmlbeans-2.3.0.jar file. My own code did not include any reference to xbeans.jar, and in my jnlp file there was no reference to it.\n\nAfter hours of debugging, I traced the problem to POI's use of xmlbeans-2.3.0.jar. When I replaced that jar with xbeans.jar and jsr173_1.0_api.jar from the latest xmlbeans-2.5.0.zip of binaries then the webstart app worked fine without any pauses. What led me to try this was the directions given on this site:\nhttp://systeminetwork.com/article/new-poi-release-brings-excels-xlsx-support-rpg\n\nTo fix this problem, the POI downloadable distribution of binaries should drop xmlbeans-2.3.0.jar and include both xbeans.jar and jsr173_1.0_api.jar from the latest xmlbeans binaries. I guess that devs will not detect this bug that i describe unless they try running POI as a JWS app. \n\nI suspect that the anomally is due to POI devs using the up-to-date xbeans.jar file in their code which was used to compile the POI jars, but then that xbeans.jar file was not included in the downloadable binary distribution that users like me download. We get the old xmlbeans-2.3.0.jar file which is out of date and causes the problem that I encountered.\n\nBy the way, POI is an extremely useful project and I want to thank all of you devs for your hard work. Much appreciated.\n\nBest wishes,\nKeith", "id": 148613, "time": "2011-08-15T15:58:07Z", "creator": "keithphw@hotmail.com", "creation_time": "2011-08-15T15:58:07Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 51660, "is_private": false, "id": 148614, "attachment_id": null, "creator": "apache@gagravarr.org", "creation_time": "2011-08-15T16:02:52Z", "time": "2011-08-15T16:02:52Z", "text": "Everything is built and run against xmlbean 2.3, so we all use the same version you do. I'd check your JWS setup, as you might not be referencing the correct files\n\nWe still compile for a fairly old version of xmlbeans as there are lots of people using the 2.3 runtime already in their code. If we moved to 2.5 then they'd be unable to use POI without upgrading, which they're often unable to do"}, {"count": 2, "tags": [], "bug_id": 51660, "text": "Created attachment 27387\njnlp file that works, no pauses and which uses the new xbeans.jar", "id": 148615, "attachment_id": 27387, "creator": "keithphw@hotmail.com", "creation_time": "2011-08-15T16:24:17Z", "time": "2011-08-15T16:24:17Z", "is_private": false}, {"count": 3, "tags": [], "text": "Created attachment 27388\nold jnlp file that has the long 30 second pause. Uses the old xmlbeans-2.3.0.jar, rather than the newer xbeans.jar\n\nThanks Nick for your reply, I understand the need to keep the old version.\n\nBut somewhere, the new xbeans.jar file is being referenced.\n\nIn the previous attachement is the new JWS jnlp file that works, no pauses (deal.jnlp).\n\nAttached here is the old one which pauses for 30 seconds (dealOld.jnlp).\n\nYou can see it looking for xbeans.jar if you enable the JWS console to be seen and type '5'. You see the following output (ignore the exception, that is my code which throws that and is irrelevant to this problem):\n\n\nJava Web Start 1.6.0_26\nUsing JRE version 1.6.0_26-b03 Java HotSpot(TM) Client VM\nUser home directory = C:\\Users\\Keith\n----------------------------------------------------\nc:   clear console window\nf:   finalize objects on finalization queue\ng:   garbage collect\nh:   display this help message\nm:   print memory usage\no:   trigger logging\np:   reload proxy configuration\nq:   hide console\nr:   reload policy configuration\ns:   dump system and deployment properties\nt:   dump thread list\nv:   dump thread stack\n0-5: set trace level to <n>\n----------------------------------------------------\nTrace level set to 5: all ... completed.\nsecurity: User has granted the priviledges to the code for this session only\nsecurity: Adding certificate in Deployment session certificate store\nsecurity: Added certificate in Deployment session certificate store\nsecurity: Saving certificates in Deployment session certificate store\nsecurity: Saved certificates in Deployment session certificate store\nsecurity: Mark trusted: http://www.keithwoodward.com/deal/webstartOld/dealOld.jnlp\nbasic: LD - All JAR files signed: http://www.keithwoodward.com/deal/webstartOld/dealOld.jnlp\nbasic: passing security checks; secureArgs:true, allSigned:false\nbasic: trusted app: true, -secure=false\nbasic: DefaultMatchJRE: \n  JREDesc:    JREDesc[version 1.6.0_26, heap=-1--1, args=null, href=http://java.sun.com/products/autodl/j2se, sel=true, null, null]\n  JREInfo:    JREInfo for index 0:\n    platform is: 1.6\n    product is: 1.6.0_26\n    location is: http://java.sun.com/products/autodl/j2se\n    path is: C:\\Program Files (x86)\\Java\\jre6\\bin\\javaw.exe\n    args is: null\n    native platform is: Windows, x86 [ x86, 32bit ]\n    enabled is: true\n    registered is: true\n    system is: true\n\n  Init Heap:  -1\n  Max  Heap:  67108864\n  Satisfying: true, true\n  SatisfyingVersion: true\n  SatisfyingJVMArgs: true, true\n  SatisfyingSecure: true\n  Selected JVMParam: [JVMParameters: isSecure: true, args: ]\n  Running  JVMParam: [JVMParameters: isSecure: true, args: ]\nbasic: continuing launch in this VM\nbasic: Main-class: deal.Main\ncache:  Read manifest for http://www.keithwoodward.com/deal/webstartOld/lib/xmlbeans-2.3.0.jar: read=272 full=63538\nsecurity: JAVAWS AppPolicy Permission requested for: http://www.keithwoodward.com/deal/webstartOld/lib/xmlbeans-2.3.0.jar\nsecurity: Istrusted: http://www.keithwoodward.com/deal/webstartOld/dealOld.jnlp true\ncache:  Read manifest for http://www.keithwoodward.com/deal/webstartOld/lib/dom4j-1.6.1.jar: read=229 full=6330\nsecurity: JAVAWS AppPolicy Permission requested for: http://www.keithwoodward.com/deal/webstartOld/lib/dom4j-1.6.1.jar\nsecurity: Istrusted: http://www.keithwoodward.com/deal/webstartOld/dealOld.jnlp true\ncache:  Read manifest for http://www.keithwoodward.com/deal/webstartOld/lib/poi-3.8-beta3-20110606.jar: read=219 full=38969\nsecurity: JAVAWS AppPolicy Permission requested for: http://www.keithwoodward.com/deal/webstartOld/lib/poi-3.8-beta3-20110606.jar\nsecurity: Istrusted: http://www.keithwoodward.com/deal/webstartOld/dealOld.jnlp true\ncache:  Read manifest for http://www.keithwoodward.com/deal/webstartOld/lib/poi-ooxml-3.8-beta3-20110606.jar: read=219 full=8728\nsecurity: JAVAWS AppPolicy Permission requested for: http://www.keithwoodward.com/deal/webstartOld/lib/poi-ooxml-3.8-beta3-20110606.jar\nsecurity: Istrusted: http://www.keithwoodward.com/deal/webstartOld/dealOld.jnlp true\ncache:  Read manifest for http://www.keithwoodward.com/deal/webstartOld/lib/poi-ooxml-schemas-3.8-beta3-20110606.jar: read=219 full=140701\nsecurity: JAVAWS AppPolicy Permission requested for: http://www.keithwoodward.com/deal/webstartOld/lib/poi-ooxml-schemas-3.8-beta3-20110606.jar\nsecurity: Istrusted: http://www.keithwoodward.com/deal/webstartOld/dealOld.jnlp true\ncache:  Read manifest for http://www.keithwoodward.com/deal/webstartOld/lib/stax-api-1.0.1.jar: read=192 full=1705\nsecurity: JAVAWS AppPolicy Permission requested for: http://www.keithwoodward.com/deal/webstartOld/lib/stax-api-1.0.1.jar\nsecurity: Istrusted: http://www.keithwoodward.com/deal/webstartOld/dealOld.jnlp true\ncache:  Read manifest for http://www.keithwoodward.com/deal/webstartOld/deal.jar: read=261 full=2033\nsecurity: JAVAWS AppPolicy Permission requested for: http://www.keithwoodward.com/deal/webstartOld/deal.jar\nsecurity: Istrusted: http://www.keithwoodward.com/deal/webstartOld/dealOld.jnlp true\nsecurity: JAVAWS AppPolicy Permission requested for: http://www.keithwoodward.com/deal/webstartOld/deal.jar\nsecurity: Istrusted: http://www.keithwoodward.com/deal/webstartOld/dealOld.jnlp true\nQuestionPane: tmpdirString == C:\\Users\\Keith\\AppData\\Local\\Temp\\\nQuestionCache: chNum == 1, qNum == 1, questionAndChapterExist(qNum, chNum) == true\nsecurity: JAVAWS AppPolicy Permission requested for: http://www.keithwoodward.com/deal/webstartOld/lib/poi-ooxml-3.8-beta3-20110606.jar\nsecurity: Istrusted: http://www.keithwoodward.com/deal/webstartOld/dealOld.jnlp true\nsecurity: JAVAWS AppPolicy Permission requested for: http://www.keithwoodward.com/deal/webstartOld/lib/poi-3.8-beta3-20110606.jar\nsecurity: Istrusted: http://www.keithwoodward.com/deal/webstartOld/dealOld.jnlp true\nsecurity: JAVAWS AppPolicy Permission requested for: http://www.keithwoodward.com/deal/webstartOld/lib/xmlbeans-2.3.0.jar\nsecurity: Istrusted: http://www.keithwoodward.com/deal/webstartOld/dealOld.jnlp true\nsecurity: JAVAWS AppPolicy Permission requested for: http://www.keithwoodward.com/deal/webstartOld/lib/poi-ooxml-schemas-3.8-beta3-20110606.jar\nsecurity: Istrusted: http://www.keithwoodward.com/deal/webstartOld/dealOld.jnlp true\nsecurity: JAVAWS AppPolicy Permission requested for: http://www.keithwoodward.com/deal/webstartOld/lib/dom4j-1.6.1.jar\nsecurity: Istrusted: http://www.keithwoodward.com/deal/webstartOld/dealOld.jnlp true\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nnetwork: Connecting http://www.keithwoodward.com/deal/webstartOld/lib/xbean.jar with proxy=DIRECT\nnetwork: Connecting socket://www.keithwoodward.com:80 with proxy=DIRECT\nQuestionCache: chNum == 1, qNum == 2, questionAndChapterExist(qNum, chNum) == true\nQuestionCache: chNum == 1, qNum == 3, questionAndChapterExist(qNum, chNum) == true\njava.io.IOException: Stream closed\n\tat java.io.BufferedInputStream.getInIfOpen(Unknown Source)\n\tat java.io.BufferedInputStream.fill(Unknown Source)\n\tat java.io.BufferedInputStream.read1(Unknown Source)\n\tat java.io.BufferedInputStream.read(Unknown Source)\n\tat java.io.FilterInputStream.read(Unknown Source)\n\tat java.io.PushbackInputStream.read(Unknown Source)\n\tat java.util.zip.ZipInputStream.readFully(Unknown Source)\n\tat java.util.zip.ZipInputStream.readLOC(Unknown Source)\n\tat java.util.zip.ZipInputStream.getNextEntry(Unknown Source)\n\tat org.apache.poi.openxml4j.util.ZipInputStreamZipEntrySource.<init>(ZipInputStreamZipEntrySource.java:51)\n\tat org.apache.poi.openxml4j.opc.ZipPackage.<init>(ZipPackage.java:82)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.open(OPCPackage.java:224)\n\tat org.apache.poi.util.PackageHelper.open(PackageHelper.java:39)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:190)\n\tat deal.Question.getAnswer(Question.java:55)\n\tat deal.QuestionCache.makeQuestionList(QuestionCache.java:48)\n\tat deal.QuestionCache.<init>(QuestionCache.java:22)\n\tat deal.QuestionPane.<init>(QuestionPane.java:65)\n\tat deal.DealFrame.<init>(DealFrame.java:88)\n\tat deal.Main$1.run(Main.java:17)\n\tat java.awt.event.InvocationEvent.dispatch(Unknown Source)\n\tat java.awt.EventQueue.dispatchEventImpl(Unknown Source)\n\tat java.awt.EventQueue.access$000(Unknown Source)\n\tat java.awt.EventQueue$1.run(Unknown Source)\n\tat java.awt.EventQueue$1.run(Unknown Source)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)\n\tat java.awt.EventQueue.dispatchEvent(Unknown Source)\n\tat java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)\n\tat java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)\n\tat java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)\n\tat java.awt.EventDispatchThread.pumpEvents(Unknown Source)\n\tat java.awt.EventDispatchThread.pumpEvents(Unknown Source)\n\tat java.awt.EventDispatchThread.run(Unknown Source)\nQuestionCache: chNum == 2, qNum == 1, questionAndChapterExist(qNum, chNum) == true\nQuestionPane: continueCounter == 0\n: e.getComponent().getSize() == java.awt.Dimension[width=250,height=250]\n: e.getComponent().getSize() == java.awt.Dimension[width=250,height=250]\n\nCheers,\nKeith", "is_private": false, "bug_id": 51660, "id": 148616, "time": "2011-08-15T16:26:47Z", "creator": "keithphw@hotmail.com", "creation_time": "2011-08-15T16:26:47Z", "attachment_id": 27388}, {"count": 4, "tags": [], "text": "You can use XMLBeans 2.6 since a few versions of POI so I think this one is fixed since that was implemented.", "is_private": false, "bug_id": 51660, "id": 184720, "time": "2015-08-23T19:42:40Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-08-23T19:42:40Z", "attachment_id": null}]