[{"count": 0, "attachment_id": null, "bug_id": 21616, "is_private": false, "id": 40749, "time": "2003-07-15T16:38:26Z", "creator": "alex.scotti@tiscalinet.it", "creation_time": "2003-07-15T16:38:26Z", "tags": [], "text": "Uploading with commons.fileupload works fine in tomcat alone but under iis5 jk2 \nfiles over approx. 50kb fails with :\n\njavax.servlet.ServletException:\nProcessing of multipart/form-data request failed. Stream ended unexpectedly"}, {"count": 1, "attachment_id": null, "bug_id": 21616, "is_private": false, "id": 42566, "time": "2003-08-11T18:17:10Z", "creator": "j.tervoorde@home.nl", "creation_time": "2003-08-11T18:17:10Z", "tags": [], "text": "I've ran into this too. This: \nhttp://www.mail-archive.com/tomcat-dev@jakarta.apache.org/msg06868.html\nfixed it for me. If you want the recompiled dll just send me an email\n(j.tervoorde@home.nl).\n\nBtw, if you're using iis for ntlm authentication only you might want to\ntry this: http://jcifs.samba.org."}, {"count": 2, "tags": [], "creator": "j.tervoorde@home.nl", "is_private": false, "text": "Created attachment 8562\nThe patched isapi_redirector2.dll", "id": 45590, "time": "2003-10-14T11:24:19Z", "bug_id": 21616, "creation_time": "2003-10-14T11:24:19Z", "attachment_id": 8562}, {"count": 3, "tags": [], "bug_id": 21616, "attachment_id": null, "text": "\nWhat is the purpose of the attached dll?\nAre you suggesting that we _try_ to find a bug decompiling?\nPlease provide the source code patch, using diff -u.\nAlso you should name the jk2 version you are using.\n", "id": 45663, "time": "2003-10-14T18:08:04Z", "creator": "mturk@apache.org", "creation_time": "2003-10-14T18:08:04Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 21616, "attachment_id": null, "text": "I am getting this same error with Tomcat 4.1.29 / IIS 5 / MOD JK 2.0.4. I tested\nthe attached DLL and it fixed my problem. I'm assuming the pached DLL used the\ncode from the post in the link above (which to my understanding was implemented\ninto JK1).\n\nIf i upload files with IIS as the fronted it breaks. If i upload using tomcat as\nthe frontend it works.\n\nIs it possible to have a look at this again? I can give you dumps from my Tomcat\nlogs if that will help.", "id": 61887, "time": "2004-08-12T14:21:47Z", "creator": "emile@battery9.co.za", "creation_time": "2004-08-12T14:21:47Z", "is_private": false}, {"count": 5, "tags": [], "creator": "james@kenilik.com", "text": "Any chance of someone supplying a fix based on the latest version of \nisapi_redirector2.dll?  I'm not qualified to help.", "id": 62951, "time": "2004-09-02T09:36:18Z", "bug_id": 21616, "creation_time": "2004-09-02T09:36:18Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 21616, "attachment_id": null, "text": "I have a similar test case: using commons HttpClient to send a chunked text/xml \nPOST to a servlet running under 5.0.25, where the xml is 56,662 bytes. With the \nstandard connector, the receiving servlet gets the entire XML document just \nfine. Using IIS 5.0 and connector 2.0.4, the receiving servlet fails with 0 \nbytes readable from the request input stream. RequestDumperValve shows that the \nheaders and other data from the two requests are identical, showing a chunked \ntransfer encoding header with a content length of -1, as it should.  The method \nrequest.getReader() when using the standard connector supplieas a reader that \nsuccessfully reads all 56,662 bytes.  The same reader when JK2 connector is in \nuse returns -1 on the first read attempt.\n\nIf the request is not chunked, both the standard connector and the JK2 \nconnector handle the 56,662 byte XML post just fine.  The JK2 path fails only \nwhen chunked encoding is in use.\n\nI'm currently trying to get full tracing turned on for the connector in \nworkers2.properties, and setting debug=\"99\" in the JkCoyoteHandler connector to \nstart tracking this down. I will post again when I have more information. ", "id": 63321, "time": "2004-09-09T22:42:09Z", "creator": "steve_olson@illinoispower.com", "creation_time": "2004-09-09T22:42:09Z", "is_private": false}, {"count": 7, "attachment_id": null, "bug_id": 21616, "is_private": false, "id": 63516, "time": "2004-09-14T09:53:49Z", "creator": "j.tervoorde@home.nl", "creation_time": "2004-09-14T09:53:49Z", "tags": [], "text": "No, i was not suggesting you'd decompile the dll. I just attached it so the \nothers could use it. Anyway, i got the patch from here:\nhttp://marc.theaimsgroup.com/?l=tomcat-dev&m=103944368410308&w=2"}, {"count": 8, "tags": [], "creator": "michael.motal@austingoodwill.org", "is_private": false, "text": "We are experiencing this also with IIS 6, Tomcat 5.0.25, JVM 1.4.2_04-b05 from\nSun, Windows 2003 v5.2. ", "id": 65311, "time": "2004-10-19T14:23:58Z", "bug_id": 21616, "creation_time": "2004-10-19T14:23:58Z", "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 21616, "attachment_id": 13490, "text": "Created attachment 13490\nProposed patch", "id": 67147, "time": "2004-11-18T16:29:50Z", "creator": "sr@d-90.nl", "creation_time": "2004-11-18T16:29:50Z", "is_private": false}, {"count": 10, "attachment_id": null, "bug_id": 21616, "is_private": false, "id": 67148, "time": "2004-11-18T16:38:56Z", "creator": "sr@d-90.nl", "creation_time": "2004-11-18T16:38:56Z", "tags": [], "text": "This bug can be reproduced by playing back a HTTP request (upload for example)\nlarger than ~55kB, if the HTTP chunks are anything else than 8kB each.\n8kB seems to be the magic size, because it is able to clear the lpbData buffer\nentirely.\n\nIf the lpbData buffer is read while it contains less than 8kB, then directly\nafterwards the ReadClient() method is invoked to fill up the rest of the buffer.\n\nIf the content_read is not updated directly, the jk2_service_iis_read method (in\njk_service_iis.c) fails. (it might be worth it to take a look at that too)"}, {"count": 11, "tags": [], "creator": "yoavs@computer.org", "is_private": false, "id": 67559, "creation_time": "2004-11-29T19:50:22Z", "time": "2004-11-29T19:50:22Z", "bug_id": 21616, "text": "As of November 15, 2004, JK2 is no longer supported. All bugs related to JK2 \nwill be marked as WONTFIX. In its place, some of its features have been \nbackported to jk1. Most of those features will be seen in 1.2.7, which is \nslated for release on November 30th, 2004.\n\nAnother alternative is the ajp addition to mod_proxy which will be part of \napache 2.\n\nFor more information on the Tomat connectors docs at\nhttp://jakarta.apache.org/tomcat/connectors-doc/\n", "attachment_id": null}]