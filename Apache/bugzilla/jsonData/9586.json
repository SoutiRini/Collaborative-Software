[{"count": 0, "tags": [], "bug_id": 9586, "attachment_id": null, "id": 17099, "time": "2002-06-03T19:31:10Z", "creator": "Christian.Hujer@itcqis.com", "creation_time": "2002-06-03T19:31:10Z", "is_private": false, "text": "Hello,\n\n\nI just have found out that the ftp task seems to be corrupt in Ant 1.5Beta2 (at\nleast for me). The ftp task worked fine in Ant 1.5Beta1 (at least for me).\n\nThe corruption obiously occurs when the ftp tasks tries to upload a directory\nthat is newer on the local file system than on the remote file system.  The ftp\ntask then tries to create the already existing directory, which causes the task\nto fail with an FTP 550 Response Code.\n\nI was able to reproduce this behaviour on two different FTP Servers.\nOne gave me:\n[...]could not create directory: 550 de: File exists[...]\nAnotherone gave me:\n[...]could not create directory: 550: Permission denied[...]\n\nSince both FTP Servers are not my FTP servers, I do not know what types of ftp\ndemons are running these services. Sorry.\n\nI report this against Platform All and OS All because I believe this bug is OS\nand Platform independant. Sorry if I am wrong.\n\nI use Ant 1.5Beta2 on a machine with JDK 1.4 from SUN on a P-III-600 with SuSE\nLinux 7.3/8.0 and NetComponents.jar from Savarese NetComponents 1.3.8a.\n\nI have attached a build.xml to reproduce the error.\nIf you cannot reproduce the error, just wait. This might be the remote machine\nhaving a \"newer\" (sorry, don't know the right word) time than your machine. Wait\na few minutes and run ant again. The directory to upload must locally have a\nnewer timestamp than the directory on the remote machine.\n\n\nI hope I provided all information neccessary.\n\nIf you need further information, you are invited to mail me.\n\n\nGreetings\n\nChristian\n\n\n\nbuild.xml:\n\n<project name=\"CrashFTP\" default=\"crash\">\n    <description>\n        This will show how the FTP Task of Ant 1.5Beta2 fails to upload files\nfrom a directory within a fileset into an existing\n        directory.\n    </description>\n\n    <target\n        name=\"crash\"\n        description=\"Run the test case, try crashing the FTP Task\"\n    >\n        <!-- Setup the files for a first time -->\n        <antcall target=\"init\" />\n\n        <!-- Upload the files for the first time. Everything should be fine. -->\n        <antcall target=\"upload\" />\n\n        <!-- Now clean up and create the files new to simulate everyday work.\nThe directory now is newer than on the remote machine. -->\n        <antcall target=\"clean\" />\n        <antcall target=\"init\" />\n\n        <!-- upload it a second time so the structure already exists. Fails. -->\n        <antcall target=\"upload\" />\n    </target>\n\n    <target\n        name=\"clean\"\n        description=\"delete temporary files\"\n    >\n        <delete dir=\"dest\" />\n    </target>\n\n    <target\n        name=\"init\"\n        description=\"Create a directory and file structure as a test case\"\n    >\n        <mkdir dir=\"dest/htdocs/de\" />\n        <touch file=\"dest/htdocs/de/test.html\" />\n    </target>\n\n    <target\n        name=\"upload\"\n        description=\"upload files on a server - calling it twice will fail\"\n    >\n        <ftp\n            server=\"*******\"\n            userid=\"*******\"\n            password=\"*******\"\n            depends=\"yes\"\n            passive=\"yes\"\n        >\n            <fileset dir=\"dest/htdocs\" />\n        </ftp>\n    </target>\n</project>"}, {"count": 1, "tags": [], "creator": "stevel@apache.org", "attachment_id": null, "id": 17105, "time": "2002-06-03T20:13:02Z", "bug_id": 9586, "creation_time": "2002-06-03T20:13:02Z", "is_private": false, "text": "what happens when you set ignoreNoncriticalErrors=true"}, {"count": 2, "tags": [], "bug_id": 9586, "attachment_id": null, "text": "Setting ignoreCriticalErrors on yes helps. But I hope this won't be the final solution. I consider creating a directory that's already there as an error. I think the ftp task has to check first wether a directory already exists before trying to create it. There might be cases, where an existing directory shall not be silently ignored with ignoreCriticalerrors=\"true\".  What do you think? ", "id": 17494, "time": "2002-06-10T15:12:37Z", "creator": "Christian.Hujer@itcqis.com", "creation_time": "2002-06-10T15:12:37Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 9586, "attachment_id": null, "id": 24362, "time": "2002-10-11T18:12:18Z", "creator": "mcepek@smsi.com", "creation_time": "2002-10-11T18:12:18Z", "is_private": false, "text": "This happens for me too.\n\nIn my case I am trying to re-upload a javadoc tree from one machine to another \nvia FTP.  This worked with a single ftp send task in Ant 1.4.1, but no longer \nworks in Ant 1.5.1 with the error indicated in this bug summary.\n\nHere's the Ant code:\n\n    <target name=\"javadoc_publish\" depends=\"init\">\n        <ftp action=\"send\" binary=\"no\" server=\"${JAVADOC_PUBLISH_HOST}\"\n                userid=\"${JAVADOC_PUBLISH_USERID}\"\n                password=\"${JAVADOC_PUBLISH_PSWD}\"\n                remotedir=\"${JAVADOC_PUBLISH_DIR}\">\n            <fileset dir=\"${javadoc_all_dir}\"/>\n        </ftp>\n    </target>\n\nAnd here's the error I'm getting:\n\n    javadoc_publish:\n    sending files\n    file:.../build.xml:115: could not create directory: 550 com: Cannot\n        create a file when that file already exists.\n\n    BUILD FAILED\n\n'com' is the first subdirectory in my JAVADOC_PUBLISH_DIR tree:\n  javadoc/com/smsi/common/...\n\nI've tried deleting the tree first using <ftp action=\"del\"...>, but I can't \nmake that work for some other reason.\n\nThe ignoreNonCriticalErrors=\"yes\" workaround DOES get me by for now.\n\n"}, {"count": 4, "tags": [], "creator": "conor@apache.org", "attachment_id": null, "text": "*** Bug 10392 has been marked as a duplicate of this bug. ***", "id": 31678, "time": "2003-02-20T14:29:09Z", "bug_id": 9586, "creation_time": "2003-02-20T14:29:09Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 9586, "attachment_id": null, "id": 31732, "time": "2003-02-21T09:55:02Z", "creator": "conor@apache.org", "creation_time": "2003-02-21T09:55:02Z", "is_private": false, "text": "Fixed - I have changed the <ftp> task so that it attempts to cwd to the\ndirectories in question and only to try and create the dir if the cwd fails.\nThis eliminates the need to ignorenoncritical errors for wu-ftpd systems at least."}]