[{"count": 0, "tags": [], "creator": "alexander.stoev@gmail.com", "is_private": false, "text": "I have XLS file generated with POI (either 3.11 or 3.12). File is OK if I open it with Open Office or Google Drive but fails in MS Office. Found that it fails with the MS Validator(http://www.microsoft.com/en-us/download/details.aspx?id=26794) with :\n\n\n\n<BFFValidation path=\"NAME.xlsx\" datetime=\"08/12/15 07:44:35\" result=\"FAILED\">\n  <ParseStack>\n    <Type builtinType=\"Docfile\" docName=\"MS-XLS\" sectionTitle=\"Compound File\" msdnLink=\"http://msdn.microsoft.com/en-us/library/b91df1c9-6bfa-4ab4-8218-7bb0d73624ca\">\n      <Info>Built-in type \"Docfile\": The root storage object of an OLE compound file. For more information, see http://msdn.microsoft.com/en-us/library/dd942138.aspx.</Info>\n    </Type>\n    <Type builtinType=\"Stream\" docName=\"MS-XLS\" sectionTitle=\"Stream\" msdnLink=\"http://msdn.microsoft.com/en-us/library/f67ac5ed-b0a7-4b2c-9b7a-28933eeaac7e\" streamName=\"Workbook\" streamOffset=\"0\" hexStreamOffset=\"0x0\">\n      <Info>Built-in type \"Stream\": Any stream object for OLE compound files. The entire file contents for other files.</Info>\n    </Type>\n    <Type docName=\"MS-XLS\" sectionTitle=\"Workbook Stream (Workbook)\" msdnLink=\"http://msdn.microsoft.com/en-us/library/f682f4b0-8c6b-444e-83f8-52d156f1e8ba\" streamName=\"Workbook\" streamOffset=\"2747\" hexStreamOffset=\"0xabb\"/>\n    <Type docName=\"MS-XLS\" sectionTitle=\"Workbook Stream (Workbook)\" msdnLink=\"http://msdn.microsoft.com/en-us/library/f682f4b0-8c6b-444e-83f8-52d156f1e8ba\" streamName=\"Workbook\" streamOffset=\"2747\" hexStreamOffset=\"0xabb\"/>\n    <Type docName=\"MS-XLS\" sectionTitle=\"Substream\" msdnLink=\"http://msdn.microsoft.com/en-us/library/dd947025(v=office.12).aspx\" streamName=\"Workbook\" streamOffset=\"2767\" hexStreamOffset=\"0xacf\"/>\n    <Type docName=\"MS-XLS\" sectionTitle=\"Record\" msdnLink=\"http://msdn.microsoft.com/en-us/library/170e90ce-87d7-4758-9331-dcf14cd72388\" streamName=\"Workbook\" streamOffset=\"2767\" hexStreamOffset=\"0xacf\"/>\n    <Type docName=\"MS-XLS\" sectionTitle=\"Index\" sectionNumber=\"2.4.144\" msdnLink=\"http://msdn.microsoft.com/en-us/library/67C20922-0427-4C2D-96CC-2267D3F09E8C\" streamName=\"Workbook\" streamOffset=\"2771\" hexStreamOffset=\"0xad3\"/>\n    <Type docName=\"MS-OSHARED\" sectionTitle=\"FilePointer\" msdnLink=\"http://msdn.microsoft.com/en-us/library/dd904963(v=office.12).aspx\" streamName=\"Workbook\" streamOffset=\"2783\" hexStreamOffset=\"0xadf\" childId=\"4\" hexChildId=\"0x4\"/>\n  </ParseStack>\n  <LastData><![CDATA[\n00 00 00 00 -- -- -- --  -- -- -- -- -- -- -- --  ....\n]]></LastData>\n</BFFValidation>\n\n\nSo it seem POI has generated incompatible file. \nThe content is quite simple - single sheet with two rows (first one bold) and several cells.\nAny suggestions?\nThanks\nAleksandar", "id": 184509, "time": "2015-08-12T15:15:55Z", "bug_id": 58240, "creation_time": "2015-08-12T15:15:55Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 58240, "attachment_id": null, "id": 184516, "time": "2015-08-12T15:20:14Z", "creator": "apache@gagravarr.org", "creation_time": "2015-08-12T15:20:14Z", "is_private": false, "text": "Can you try again with a recent nightly build / wait a week or so then try again with 3.13 beta 2?"}, {"count": 2, "tags": [], "creator": "alexander.stoev@gmail.com", "attachment_id": null, "text": "I tried with the latest available maven dependency 3.13-beta1 - same result.", "id": 184527, "time": "2015-08-12T18:30:13Z", "bug_id": 58240, "creation_time": "2015-08-12T18:30:13Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 58240, "attachment_id": null, "id": 184528, "time": "2015-08-12T18:44:04Z", "creator": "apache@gagravarr.org", "creation_time": "2015-08-12T18:44:04Z", "is_private": false, "text": "As requested:\n\n> Can you try again with a recent nightly build / wait a week or so then try again with 3.13 beta 2?"}, {"count": 4, "tags": [], "text": "OK, same with the nightly build from today - https://builds.apache.org/job/POI/781/\n\nBest,\nAleksandar", "is_private": false, "id": 184529, "creator": "alexander.stoev@gmail.com", "time": "2015-08-12T19:12:24Z", "bug_id": 58240, "creation_time": "2015-08-12T19:12:24Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 58240, "attachment_id": null, "id": 184534, "time": "2015-08-13T07:15:44Z", "creator": "alexander.stoev@gmail.com", "creation_time": "2015-08-13T07:15:44Z", "is_private": false, "text": "Hey,\n\nI played a bit to see if I can find some better reason - nope.\nI cut the code to just this :\n Workbook workbook = new HSSFWorkbook();\n Sheet sheet = workbook.createSheet();\n workbook.write(stream);\n workbook.close();\nThe validation still fails. I wouldn't care if MS Office didn't refuses to load the file.\nIt runs under JBoss wildfly-8.1.0.Final with jdk1.7.0_75, same with OpenSuse(13.1) and Ubuntu (both x64).\nThe situation is really strange ...\n\nBest,\nAleksandar"}, {"count": 6, "tags": [], "bug_id": 58240, "attachment_id": null, "id": 185229, "time": "2015-09-14T16:16:14Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-09-14T16:16:14Z", "is_private": false, "text": "I tried the steps you list, the resulting document opens just fine in Excel for me.\n\nI also tried the validator, it reported FAILED similar to your output, however I tried a few other documents and many fail, even some that I saved using Excel itself, not sure how good the validation matches to what Excel actually allows...\n\nAny chance that an older version of poi is pulled in here for some reason? It seems like it is somehow only happening for you here."}, {"count": 7, "tags": [], "bug_id": 58240, "attachment_id": null, "id": 190102, "time": "2016-04-10T10:17:39Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-04-10T10:17:39Z", "is_private": false, "text": "No update for some time therefor I am resolving this for now until we get more information that allows us to reproduce this. We primarily depend on Excel itself to verify files."}, {"count": 8, "tags": [], "bug_id": 58240, "is_private": false, "text": "Hello,\n\nwhat other information do you need to have a look at the issue. As described the file generated fails the MS validation.\n\nBest,\nAleksandar", "id": 190104, "time": "2016-04-10T11:16:57Z", "creator": "alexander.stoev@gmail.com", "creation_time": "2016-04-10T11:16:57Z", "attachment_id": null}]