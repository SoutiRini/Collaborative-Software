[{"count": 0, "tags": [], "bug_id": 53150, "attachment_id": null, "text": "There are two issues with formatting fractions with a numerator value of 0 - For example, format 1.0 as a fraction yields with 1 digit numerator and denominators yields \"1 1/9\".\n\n1. \nThis junit patch (to TestDataFormatter.java:testFractions) demonstrates the issue:\n\nassertEquals(\"1 0/9\",   dfUS.formatRawCellContents(1.0, -1, \"# #/#\"));\n\n\nI believe the solution to the following is:\n\nIn org.apache.poi.ss.usermodel.DataFormatter$FractionFormat, near line 1009:\nfor(int i2 = (int)(Math.pow(10,  fractParts[1].length())- 1d); i2 > 0; i2--){\n\nThat loop's test should be i2 >= 0.\n\nWas numerator meant to be abbreviated as num, instead of neum?\n\n2. In Excel 2003, 1.0 with a format of \"# #/#\" gets written as \"1    \" (the fraction's digits are replaced by spaces and no / is written). I would expect some kind of emulateCsv support to handle this if it's decided that the solution to step #1 above is to print fractions as 0/d.", "id": 158438, "time": "2012-04-25T19:55:29Z", "creator": "robert_kish@yahoo.com", "creation_time": "2012-04-25T19:55:29Z", "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 53150, "text": "I've just tested with r1497023, and the formatting now works the same as in excel for a whole number and \"# #/#\", so it looks like some of the recent fraction format fixes have solved this.", "id": 168086, "time": "2013-06-26T20:40:23Z", "creator": "apache@gagravarr.org", "creation_time": "2013-06-26T20:40:23Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 53150, "attachment_id": null, "text": "(In reply to Nick Burch from comment #1)\n> I've just tested with r1497023, and the formatting now works the same as in\n> excel for a whole number and \"# #/#\", so it looks like some of the recent\n> fraction format fixes have solved this.\n\nI've just tested with 3.10-beta1. The calculations, for the most part, are better. (See https://issues.apache.org/bugzilla/show_bug.cgi?id=55419)\n\nThe FractionFormat class, that implements the fractions logic, is now documented as not handling the Excel's spacing. While not ideal, because the solution itself is quite difficult, it's a good start.\n\nIt's more important for the numeric portion to be more correct, than the whitespace to be valid. I'm OK with how this was handled.", "id": 169450, "time": "2013-08-14T21:08:22Z", "creator": "robert_kish@yahoo.com", "creation_time": "2013-08-14T21:08:22Z", "is_private": false}]