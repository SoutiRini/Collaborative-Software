[{"count": 0, "tags": [], "creator": "mthomas@awarix.com", "attachment_id": null, "is_private": false, "id": 95939, "time": "2006-11-17T09:48:11Z", "bug_id": 40994, "creation_time": "2006-11-17T09:48:11Z", "text": "MemoryMonitor gui utility updates its components outside of Swing thread"}, {"count": 1, "tags": [], "text": "Created attachment 19135\npatch for MemoryMonitor to update in Swing thread", "is_private": false, "id": 95940, "creation_time": "2006-11-17T09:49:07Z", "time": "2006-11-17T09:49:07Z", "creator": "mthomas@awarix.com", "bug_id": 40994, "attachment_id": 19135}, {"count": 2, "tags": [], "bug_id": 40994, "text": "Comment on attachment 19135\npatch for MemoryMonitor to update in Swing thread\n\n--- sources/org/apache/batik/util/gui/MemoryMonitor.java.orig\t2005-11-07\n10:16:40.000000000 -0600\n+++ sources/org/apache/batik/util/gui/MemoryMonitor.java    2006-11-17\n11:52:06.000000000 -0600\n@@ -53,6 +53,7 @@\n import javax.swing.JComponent;\n import javax.swing.JFrame;\n import javax.swing.JPanel;\n+import javax.swing.SwingUtilities;\n\n import org.apache.batik.util.gui.resource.ActionMap;\n import org.apache.batik.util.gui.resource.ButtonFactory;\n@@ -692,12 +693,16 @@\n\tfor (;;) {\n\tlong free  = runtime.freeMemory();\n\tlong total = runtime.totalMemory();\n-\tIterator it = components.iterator();\n-\twhile (it.hasNext()) {\n-\t    Component c = (Component)it.next();\n-\t    ((MemoryChangeListener)c).memoryStateChanged(total, free);\n-\t    c.repaint();\n-\t}\n+\tfinal Iterator it = components.iterator();\n+\t SwingUtilities.invokeLater(new Runnable() {\n+\t    public void run() {\n+\t\twhile (it.hasNext()) {\n+\t\t    Component c = (Component)it.next();\n+\t\t     ((MemoryChangeListener)c).memoryStateChanged(total, free);\n+\t\t    c.repaint();\n+\t\t }\n+\t     }\n+\t});\n\t\t try {\n\t\t     sleep(timeout);\n\t\t     synchronized(this) {", "id": 95941, "time": "2006-11-17T09:55:19Z", "creator": "mthomas@awarix.com", "creation_time": "2006-11-17T09:55:19Z", "is_private": false, "attachment_id": 19135}, {"count": 3, "tags": [], "creator": "mthomas@awarix.com", "attachment_id": 19136, "text": "Created attachment 19136\ncorrect patch", "id": 95942, "time": "2006-11-17T09:56:03Z", "bug_id": 40994, "creation_time": "2006-11-17T09:56:03Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 40994, "text": "Created attachment 19137\nlast correction", "id": 95943, "time": "2006-11-17T10:04:54Z", "creator": "mthomas@awarix.com", "creation_time": "2006-11-17T10:04:54Z", "is_private": false, "attachment_id": 19137}, {"count": 5, "tags": [], "bug_id": 40994, "attachment_id": null, "is_private": false, "id": 97186, "time": "2006-12-22T03:38:50Z", "creator": "deweese@apache.org", "creation_time": "2006-12-22T03:38:50Z", "text": "This is fixed in SVN.\nThanks for raising the issue."}, {"count": 6, "tags": [], "text": "(In reply to comment #5)\n> This is fixed in SVN.\n> Thanks for raising the issue.\n\nisn't this directly related to the other question with\nupdates-outside-of-swing-thread??\ni would say, calling component.repaint() is/was enough.\nwhat do i miss??", "is_private": false, "id": 97187, "creation_time": "2006-12-22T05:42:32Z", "time": "2006-12-22T05:42:32Z", "creator": "info@dvholten.de", "bug_id": 40994, "attachment_id": null}, {"count": 7, "attachment_id": null, "bug_id": 40994, "text": "> (In reply to comment #5)\n> > This is fixed in SVN.\n\n(In reply to comment #6)\n> isn't this directly related to the other question with\n> updates-outside-of-swing-thread??\n> i would say, calling component.repaint() is/was enough.\n> what do i miss??\n\n   Well the 'RepaintThread' doesn't just call 'repaint'\nit actually calls 'memoryStateChanged' listeners on the\nSwing components.  The 'History' part of the window in \nparticular then modifies a number of internal data\nstructures that are also used during the Swing repaint.\n\n   The two options were to make these methods thread\nsafe (which there is a reasonable argument for), or\nto make the memoryStateChanged 'events' be delivered\nonly in the swing thread (so they can't cause problems\nwith the swing repaint).  I picked the latter as it\nseemed easier...", "id": 97215, "time": "2006-12-24T08:08:46Z", "creator": "deweese@apache.org", "creation_time": "2006-12-24T08:08:46Z", "tags": [], "is_private": false}]