[{"count": 0, "tags": [], "text": "I was looking for what patterns are valid for url-pattern, and I was unable to find any official documentation, so I went to the source: http://svn.apache.org/repos/asf/tomcat/tc7.0.x/trunk/java/org/apache/catalina/core/ApplicationFilterFactory.java\n\nI believe this line is an error:\n\n                } else if ('/' == requestPath.charAt(testPath.length() - 2)) {\n\nAnd I believe it should be:\n\n                } else if ('/' == requestPath.charAt(testPath.length() - 1)) {", "attachment_id": null, "bug_id": 56512, "id": 175154, "time": "2014-05-12T07:58:15Z", "creator": "j__n@yahoo.com", "creation_time": "2014-05-12T07:58:15Z", "is_private": false}, {"count": 1, "tags": [], "creator": "knst.kolinko@gmail.com", "attachment_id": null, "is_private": false, "id": 175156, "time": "2014-05-12T11:13:18Z", "bug_id": 56512, "creation_time": "2014-05-12T11:13:18Z", "text": "(In reply to j__n from comment #0)\n> I was looking for what patterns are valid for url-pattern, and I was unable\n> to find any official documentation,\n\nRead the Servlet specification. It is all documented there."}, {"count": 2, "tags": [], "text": "(In reply to j__n from comment #0)\n> I was looking for what patterns are valid for url-pattern, and I was unable\n> to find any official documentation, so I went to the source:\n\nThe code in ApplicationFilterFactory.matchFiltersURL(String, String) is\n\n[[[\n        // Case 2 - Path Match (\"/.../*\")\n        if (testPath.equals(\"/*\"))\n            return (true);\n        if (testPath.endsWith(\"/*\")) {\n            if (testPath.regionMatches(0, requestPath, 0,\n                                       testPath.length() - 2)) {\n                if (requestPath.length() == (testPath.length() - 2)) {\n                    return (true);\n                } else if ('/' == requestPath.charAt(testPath.length() - 2)) {\n                    return (true);\n                }\n            }\n            return (false);\n        }\n]]]\n\n\"testPath.length() - 2\" is url-pattern minus ending \"/*\".\n\nThe first \"if (requestPath.length() == (testPath.length() - 2))\" covers the case when request uri is equal to pattern.substring(0, pattern.length()-2).\n\nThe second \"if ('/' == requestPath.charAt(testPath.length() - 2))\" covers the case when request uri starts with (pattern.substring(0, pattern.length()-2) + '/').\n\nI see no error here.", "attachment_id": null, "bug_id": 56512, "id": 175159, "time": "2014-05-12T12:19:42Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2014-05-12T12:19:42Z", "is_private": false}, {"count": 3, "tags": [], "creator": "j__n@yahoo.com", "text": "argh.  i was staring at that for ages and kept reading it as `requestPath.charAt(requestPath.length() - 2)` .  must be something wrong with my testcase then.  will go back and see.", "id": 175191, "time": "2014-05-14T03:41:42Z", "bug_id": 56512, "creation_time": "2014-05-14T03:41:42Z", "is_private": false, "attachment_id": null}]