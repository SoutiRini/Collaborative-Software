[{"count": 0, "tags": [], "creator": "etj@genera.no", "attachment_id": null, "id": 40817, "time": "2003-07-16T12:53:08Z", "bug_id": 21650, "creation_time": "2003-07-16T12:53:08Z", "is_private": false, "text": "It seems that the following xml filename ordering results in an error:\n\nAvstandEntity-cmp-rdbms-jar.xml\nejb-jar.xml\nweblogic-ejb-jar.xml\n\nIf naming of files is changed to:\n\nXAvstandEntity-cmp-rdbms-jar.xml\nweblogic-ejb-jar.xml\nejb-jar.xml, it works.\n\nThe reason seems to be that the tool.processDescriptor(files[index], saxParser)\n[line 591] in EjbJar.java assumes ordering of the array: String[] files to be:\nejb-jar.xml as the first entry.\n\nHowever this does not occur when the operating system orders on alphabetical \nascending order.\n\nThe symptom can be found when looking into the generic.jar assembled in the \nprocess. The content of ejb-jar.xml and the cmp-rdbms-jar.xml will be identical.\nBecause it assumes that the first file parsed is the ejb-jar.xml file. \nThis is not neccecerily the case if the first letter of the cmp-rdbms-jar.xml \n(eg. AvstandEntity-cmp-rdbms-jar.xml) is lesser than \"e\"(ejb-jar.xml).\n\nThe stacktrace being given on failure is:\njava.lang.ClassCastException\n        at weblogic.ejb20.dd.xml.DDUtils.loadEJBJarDescriptorFromJarFile\n(DDUtils.java:155)\n        at weblogic.ejb20.dd.xml.DDUtils.createDescriptorFromJarFile\n(DDUtils.java:139)\n        at weblogic.ejb20.dd.xml.DDUtils.createDescriptorFromJarFile\n(DDUtils.java:130)\n        at weblogic.ejbc20.runBody(ejbc20.java:338)\n        at weblogic.utils.compiler.Tool.run(Tool.java:79)\n        at weblogic.ejbc.main(ejbc.java:21)\nERROR: java.lang.ClassCastException\nkode\\no\\Lisa.xml [223] Exception while calling weblogic.ejbc. Details: Ejbc \nreported an error\n        at \norg.apache.tools.ant.taskdefs.optional.ejb.WeblogicDeploymentTool.buildWeblogicJ\nar(WeblogicDeploymentTool.java:633)\n        at \norg.apache.tools.ant.taskdefs.optional.ejb.WeblogicDeploymentTool.writeJar\n(WeblogicDeploymentTool.java:651)\n        at \norg.apache.tools.ant.taskdefs.optional.ejb.GenericDeploymentTool.processDescript\nor(GenericDeploymentTool.java:480)\n        at org.apache.tools.ant.taskdefs.optional.ejb.EjbJar.execute\n(EjbJar.java:592)\n        at org.apache.tools.ant.Task.perform(Task.java:341)\n        at org.apache.tools.ant.Target.execute(Target.java:309)\n        at org.apache.tools.ant.Target.performTasks(Target.java:336)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1339)\n        at org.apache.tools.ant.taskdefs.Ant.execute(Ant.java:397)\n        at org.apache.tools.ant.taskdefs.CallTarget.execute(CallTarget.java:143)\n        at net.sf.antcontrib.logic.ForEach.execute(Unknown Source)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:193)\n        at org.apache.tools.ant.Task.perform(Task.java:341)\n        at org.apache.tools.ant.Target.execute(Target.java:309)\n        at org.apache.tools.ant.Target.performTasks(Target.java:336)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1339)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1255)\n        at org.apache.tools.ant.module.run.TargetExecutor.run\n(TargetExecutor.java:331)\n        at org.netbeans.core.execution.RunClassThread.run\n(RunClassThread.java:118)\nCaused by: Ejbc reported an error\n        at \norg.apache.tools.ant.taskdefs.optional.ejb.WeblogicDeploymentTool.buildWeblogicJ\nar(WeblogicDeploymentTool.java:627)\n        ... 18 more\n--- Nested Exception ---\nEjbc reported an error\n        at \norg.apache.tools.ant.taskdefs.optional.ejb.WeblogicDeploymentTool.buildWeblogicJ\nar(WeblogicDeploymentTool.java:627)\n        at \norg.apache.tools.ant.taskdefs.optional.ejb.WeblogicDeploymentTool.writeJar\n(WeblogicDeploymentTool.java:651)\n        at \norg.apache.tools.ant.taskdefs.optional.ejb.GenericDeploymentTool.processDescript\nor(GenericDeploymentTool.java:480)\n        at org.apache.tools.ant.taskdefs.optional.ejb.EjbJar.execute\n(EjbJar.java:592)\n        at org.apache.tools.ant.Task.perform(Task.java:341)\n        at org.apache.tools.ant.Target.execute(Target.java:309)\n        at org.apache.tools.ant.Target.performTasks(Target.java:336)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1339)\n        at org.apache.tools.ant.taskdefs.Ant.execute(Ant.java:397)\n        at org.apache.tools.ant.taskdefs.CallTarget.execute(CallTarget.java:143)\n        at net.sf.antcontrib.logic.ForEach.execute(Unknown Source)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:193)\n        at org.apache.tools.ant.Task.perform(Task.java:341)\n        at org.apache.tools.ant.Target.execute(Target.java:309)\n        at org.apache.tools.ant.Target.performTasks(Target.java:336)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1339)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1255)\n        at org.apache.tools.ant.module.run.TargetExecutor.run\n(TargetExecutor.java:331)\n        at org.netbeans.core.execution.RunClassThread.run\n(RunClassThread.java:118)"}, {"count": 1, "tags": [], "bug_id": 21650, "attachment_id": null, "is_private": false, "id": 40826, "time": "2003-07-16T13:12:58Z", "creator": "bodewig@apache.org", "creation_time": "2003-07-16T13:12:58Z", "text": "*** Bug 21651 has been marked as a duplicate of this bug. ***"}, {"count": 2, "tags": [], "bug_id": 21650, "is_private": false, "text": "*** Bug 21653 has been marked as a duplicate of this bug. ***", "id": 40828, "time": "2003-07-16T13:13:18Z", "creator": "bodewig@apache.org", "creation_time": "2003-07-16T13:13:18Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "conor@apache.org", "attachment_id": null, "id": 44091, "time": "2003-09-12T07:05:20Z", "bug_id": 21650, "creation_time": "2003-09-12T07:05:20Z", "is_private": false, "text": "The order is not important, but you need to select only the ejb-jar descriptors.\nThese are the only files processed by <ejbjar>. The CMP descriptors are picked\nup automatically from the content of the weblogic descriptor (the type-storage\nelement). Trying to process the CMP descriptors will generate a bogus ejb-jar.\n\nPlease refer to the doco http://ant.apache.org/manual/OptionalTasks/ejb.html#ejbjar\n\nThere are a few tidbits worth noting:\n\n\"The task works as a directory scanning task, and performs an action for each\ndeployment descriptor found. As such the includes and excludes should be set to\nensure that all desired EJB descriptors are found, but no application server\ndescriptors are found. For each descriptor found, ejbjar will parse the\ndeployment descriptor to determine the necessary class files which implement the\nbean.\"\n\nand\n\n\"In Ant 1.3, ejbjar parses the weblogic deployment descriptor to discover the\nCMP descriptors, which are then included automatically. This behaviour is\ncontrolled by the newCMP attribute. Note that if you move to the new method of\ndetermining CMP descriptors, you will need to update your weblogic deployment\ndescriptor's <type-storage> element. In the above example, you would define this\nas META-INF/Customer-weblogic-cmp-rdbms-jar.xml.\"\n\n\nSo, you need to set up your includes a bit more tightly. Please check out the\nexamples.\n\n"}]