[{"text": "When a class or jar file is replaced for a running web application,\ntomcat reloads class files, it also reinitialize\nthe context and the connection pool.  But if there are\nusers hitting the site and prob. still using the connections, \nthe connections dont get\nclosed property. These connections still connect to\nthe DB server, but can no longer be referenced in the newly intialized\nconnection pool.\n\nThese connections don't get released unless tomcat server is restarted.\n\nThis bug can be reproduced by replacing a jar file or a class file in the web \napplication that is actively accessed by multiple users.\n\nOne can see the lost db connections by comparing the total number of \nconnections in connection pool with the number of db connections opened from \ntomcat server to the db server(netstat -a |grep dbPortNumber will do the trick)", "tags": [], "bug_id": 18615, "is_private": false, "count": 0, "id": 34357, "time": "2003-04-02T16:14:40Z", "creator": "sal_cheung@yahoo.com", "creation_time": "2003-04-02T16:14:40Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 18615, "attachment_id": null, "text": "There is no way for the container to fix this, as there's no standard way to\nnotify the datasource (except wait for the connections to time out). If the\ndatasource is no longer referenced, then it will be GCed eventually, which\nshould release the connections. The webapp can use a variety of notifications to\ncleanup important resources (releasing connections, etc).", "id": 35528, "time": "2003-04-18T13:52:35Z", "creator": "remm@apache.org", "creation_time": "2003-04-18T13:52:35Z", "is_private": false}]