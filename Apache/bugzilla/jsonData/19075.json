[{"count": 0, "tags": [], "bug_id": 19075, "is_private": false, "text": "Here is the simplified code:\n\nstmt.execute(sql);\nResultSet rs = stmt.getResultSet();\nif (rs!=null)\n{\nif (rs.next())\n{\n...\n}\n}\n\nIt happens that NullPointerException is thrown inside ResultSet next(), inspite \nit is not null.\n\"sql\" which is a String contains stored procedure with parameters. It may \nreturn update counts.\nAccording to java documentation getResultSet in case when there is update count \nor there are no more results should return null.\nIt seems to me that in DelegatingResultSet.java \n_res is null.\nHere is code from DelegatingResultSet.java:\n    public boolean next()\n        throws SQLException\n    {\n        return _res.next();\n    }\n\n\n\nHere is stack:\n\njava.lang.NullPointerException\n\tat org.apache.commons.dbcp.DelegatingResultSet.next\n(DelegatingResultSet.java:135)\n\tat com.metrosoft.iq.IQManager.save(IQManager.java:493)\n\tat com.metrosoft.iq.IQManager.save(IQManager.java:425)\n\tat org.apache.jsp.handle_request_new_jsp._jspService\n(handle_request_new_jsp.java:184)\n\tat com.metrosoft.servlets.jsp.JspLoggingPage.service\n(JspLoggingPage.java:80)\n\tat org.apache.jasper.servlet.JspServletWrapper.service\n(JspServletWrapper.java:210)\n\tat org.apache.jasper.servlet.JspServlet.serviceJspFile\n(JspServlet.java:295)\n\tat org.apache.jasper.servlet.JspServlet.service(JspServlet.java:241)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java:247)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java:193)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke\n(StandardWrapperValve.java:256)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardContextValve.invoke\n(StandardContextValve.java:191)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardContext.invoke\n(StandardContext.java:2415)\n\tat org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:180)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.valves.ErrorDispatcherValve.invoke\n(ErrorDispatcherValve.java:171)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:641)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke\n(ErrorReportValve.java:172)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:641)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:174)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.coyote.tomcat4.CoyoteAdapter.service\n(CoyoteAdapter.java:223)\n\tat org.apache.coyote.http11.Http11Processor.process\n(Http11Processor.java:594)\n\tat \norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnectio\nn(Http11Protocol.java:392)\n\tat org.apache.tomcat.util.net.TcpWorkerThread.runIt\n(PoolTcpEndpoint.java:565)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:619)\n\tat java.lang.Thread.run(Thread.java:484)\n\nIt happens also on 4.1.18, but tt was working fine on Apache Tomcat version \n4.0.4\n\nbest regards\nJakub Dudek\n\nJakub Dudek, IT developer\nMicrosoft Certified Professional\nMetrosoft Polska\nemail:jakubd@metrosoft.com\nemail:jdudek@elf.ii.uj.edu.pl\nwww.metrosoft.com", "id": 35344, "time": "2003-04-16T15:37:08Z", "creator": "jakubd@metrosoft.com", "creation_time": "2003-04-16T15:37:08Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "funkman@joedog.org", "attachment_id": null, "text": "This a commons-dbcp bug, not a tomcat bug. [Which I think is fixed in the\nnightly builds of dbcp]\n", "id": 35347, "time": "2003-04-16T15:41:58Z", "bug_id": 19075, "creation_time": "2003-04-16T15:41:58Z", "is_private": false}]