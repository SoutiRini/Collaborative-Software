[{"count": 0, "tags": [], "bug_id": 46898, "attachment_id": null, "id": 125729, "creation_time": "2009-03-24T01:27:28Z", "time": "2009-03-24T01:27:28Z", "creator": "kokkik.cheong@streamsolutions.com.sg", "text": "Hi,\n\nI've posted similar issue on Jan 2009. I thought the problem was solved but it re-occur again. I've attached 2 java source files and an excel spreadsheet. As mentioned, the unexpected error code -60 was stating circular reference which is not found in excel spreadsheet.\n\nPlease update the source file as i've hardcoded the excel spreadsheet path into it.\n\nRegards,\n\nKK", "is_private": false}, {"count": 1, "tags": [], "bug_id": 46898, "attachment_id": null, "id": 125747, "time": "2009-03-24T05:12:21Z", "creator": "kokkik.cheong@streamsolutions.com.sg", "creation_time": "2009-03-24T05:12:21Z", "is_private": false, "text": "Hi,\n\nI've tested the code using 3.5 beta 5 as well. The result return is same. I'll upload the file via other website and provide a link later. (Due to 1 MB constraint in bugzilla website)\n\nRegards,\n\nKok Kik."}, {"count": 2, "tags": [], "bug_id": 46898, "attachment_id": 23409, "is_private": false, "id": 125759, "time": "2009-03-24T08:01:45Z", "creator": "kokkik.cheong@streamsolutions.com.sg", "creation_time": "2009-03-24T08:01:45Z", "text": "Created attachment 23409\nJava Application\n\nSmall app to \na. Update parameter at worksheet \"Parameters & Data\"\nb. Extract data on worksheet \"SI\".\n\nCommand to execute:\njava -Xms128m -Xmx512m -cp \"lib\\poi-scratchpad-3.5-beta5-20090219.jar;lib\\po\ni-3.5-beta5-20090219.jar;lib\\poi-contrib-3.5-beta5-20090219.jar;.\" poi_hssf \"spreadsheet name.xls\"\n\nPlease note that the spreadsheet will be provided in URL later. (Once uploaded successfully)"}, {"count": 3, "tags": [], "creator": "kokkik.cheong@streamsolutions.com.sg", "attachment_id": null, "id": 125766, "time": "2009-03-24T09:08:20Z", "bug_id": 46898, "creation_time": "2009-03-24T09:08:20Z", "is_private": false, "text": "Please download the spreadsheet at ftp site located at ftp.streamsolutions.com.sg.\nUser id is ftp@streamsolutions.com.sg and no password.\nThe file is poi-200903.zip."}, {"count": 4, "tags": [], "bug_id": 46898, "attachment_id": null, "text": "Fixed in svn 760162\n\njunit added\n\nThanks for the example - it would have been difficult to guess the cause of this error.  The problem was with the interaction between caching formula results and  detection of circular references.  The bug depends on the order of evaluation.  This is probably why you mentioned the problem as being intermittent. Take at look at the new unit test for an isolated example.", "id": 125888, "time": "2009-03-30T13:56:44Z", "creator": "josh@apache.org", "creation_time": "2009-03-30T13:56:44Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 46898, "attachment_id": 31349, "id": 173496, "time": "2014-02-27T00:45:03Z", "creator": "cliff.binstock@xbrlcloud.com", "creation_time": "2014-02-27T00:45:03Z", "is_private": false, "text": "Created attachment 31349\nPatch which checks for circular reference error code"}, {"count": 6, "tags": [], "creator": "cliff.binstock@xbrlcloud.com", "attachment_id": 31350, "id": 173497, "time": "2014-02-27T00:45:45Z", "bug_id": 46898, "creation_time": "2014-02-27T00:45:45Z", "is_private": false, "text": "Created attachment 31350\nXLSX with circular reference"}, {"count": 7, "tags": [], "creator": "cliff.binstock@xbrlcloud.com", "attachment_id": null, "is_private": false, "id": 173498, "time": "2014-02-27T00:49:20Z", "bug_id": 46898, "creation_time": "2014-02-27T00:49:20Z", "text": "It seems that circular references are handled correctly for HSSF, but not XSSF.  In fact, all of the circular reference tests cases (and most others for that matter) seem to be related to HSSF, so I wasn't sure where to put an XSSF-specific test case (or suite).\n\nI have included a patch that works (doesn't create an Exception, and creates a \"VALUE#!\" error in the spreadsheet. But, it seems like maybe there is an architectual issue in that this isn't handled at the HSSF level."}, {"count": 8, "tags": [], "bug_id": 46898, "is_private": false, "id": 180130, "creation_time": "2015-01-02T21:30:51Z", "time": "2015-01-02T21:30:51Z", "creator": "dominik.stadler@gmx.at", "text": "I have changed the tests via r1649122 to also run for XSSF, they run fine currently so the cases verified for HSSF work fine for XSSF as well already.\n\nFor the proposed change to FormulaError to change the error to INVALID_VALUE I am not sure if this is the right thing to do as it leaves ERROR_CIRCULAR_REF in some places (e.g. value.getErrorValue()) and changes the error to VALUE_INVALID in others, obviously I don't know this part of the code well enough to be sure, but wouldn't we change the error-code in a more central place to have INVALID_VALLUE everywhere?", "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 46898, "attachment_id": null, "id": 195218, "time": "2016-11-25T21:58:02Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-11-25T21:58:02Z", "is_private": false, "text": "I think the main part is fixed here, please create a separate bug with an up-to-date patch if you think there should be more changes applied."}]