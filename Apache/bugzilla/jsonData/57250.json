[{"count": 0, "tags": [], "bug_id": 57250, "attachment_id": null, "text": "I guess the bug was introduced by commit 1620997 (Bug 56854 - XMLBeans performance when using getXXXList() and other proxy methods).\n\nTested with version 3.11-beta3.\n\nThe setSlideOrder() method removes old slide at wrong position:\n\nafter insert:\n<xml-fragment xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\">\n  <p:sldId id=\"257\" r:id=\"rId7\"/>\n  <p:sldId id=\"256\" r:id=\"rId2\"/>\n  <p:sldId id=\"257\" r:id=\"rId7\"/>\n</xml-fragment>\n\nafter remove:\n<xml-fragment xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\">\n  <p:sldId id=\"257\" r:id=\"rId7\"/>\n  <p:sldId id=\"257\" r:id=\"rId7\"/>\n</xml-fragment>\n\nFinally the presentation refers to the same slide twice and the old slide is not more reachable.\n\nThe following unit test fails (create a slide show insert-infront.pptx with a single slide containing text \"Test me\"):\n\n    @Test\n    public void testInsertInfront() throws Exception {\n       XMLSlideShow ss = XSLFTestDataSamples.openSampleDocument(\"insert-infront.pptx\");\n       XSLFSlide slide;\n       \n       assertEquals(1, ss.getSlides().length);\n       \n       slide = ss.getSlides()[0];\n       assertContains(getSlideText(slide), \"Test me\");\n       \n       slide = ss.createSlide();\n       ss.setSlideOrder(slide, 0);\n       slide.createTextBox().setText(\"New slide\");\n       \n       // Save and re-load\n       ss = XSLFTestDataSamples.writeOutAndReadBack(ss);\n\n       assertEquals(2, ss.getSlides().length);\n       \n       slide = ss.getSlides()[0];\n       assertContains(getSlideText(slide), \"New slide\");\n       \n       slide = ss.getSlides()[1];\n       assertContains(getSlideText(slide), \"Test me\");\n    }", "id": 179248, "time": "2014-11-24T11:58:39Z", "creator": "vladk.dev@gmail.com", "creation_time": "2014-11-24T11:58:39Z", "is_private": false}, {"count": 1, "tags": [], "creator": "yaniv@kundas.net", "text": "I will fix as soon as Apache SVN server comes back.", "id": 179498, "time": "2014-12-04T07:43:08Z", "bug_id": 57250, "creation_time": "2014-12-04T07:43:08Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 57250, "text": "Created attachment 32266\nFix for bug 57250", "id": 179599, "time": "2014-12-07T14:46:33Z", "creator": "yaniv@kundas.net", "creation_time": "2014-12-07T14:46:33Z", "is_private": false, "attachment_id": 32266}, {"count": 3, "attachment_id": null, "creator": "kiwiwings@apache.org", "text": "Thank you for the patch. Applied with r1643684", "id": 179600, "time": "2014-12-07T15:28:45Z", "bug_id": 57250, "creation_time": "2014-12-07T15:28:45Z", "tags": [], "is_private": false}]