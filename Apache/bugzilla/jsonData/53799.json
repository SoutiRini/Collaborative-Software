[{"count": 0, "tags": [], "bug_id": 53799, "attachment_id": null, "id": 161826, "time": "2012-08-30T04:39:11Z", "creator": "tony810428@hotmail.com", "creation_time": "2012-08-30T04:39:11Z", "is_private": false, "text": "I wanted to remove all comments in my workbook, but exception was thrown.\n\nmy code as follow,\n\n-------------\nfor (int i = sheet.getLastRowNum() ; i >=0 ; i --) {\n    Row row = sheet.getRow(i) ;\n\t\n    if (row == null) {\n        continue ;\n    }\n\t\n    for (int j = row.getLastCellNum() ; j >= 0 ; j --) {\n        org.apache.poi.ss.usermodel.Cell c = row.getCell(j) ;\n    \n        if (c == null) {\n    \t    continue ;\n        }\n\n        c.removeCellComment() ;\n        row.removeCell(c) ;\n    }\n\t\n    sheet.removeRow(row) ;\n}\n--------------------\n\n\nwhen the number of comments in .xls more than 60 or more, will throw exception as follow\n\n-----------------------\n//HSSFCell, line is 1065\nthrow new IllegalStateException(\"Found the wrong records before the TextObjectRecord, can't remove comment\");\n----------------------\n\nis any firend can help? thanks~~~~"}, {"count": 1, "tags": [], "bug_id": 53799, "attachment_id": null, "is_private": false, "id": 161829, "time": "2012-08-30T07:38:30Z", "creator": "superrubiroyd@gmail.com", "creation_time": "2012-08-30T07:38:30Z", "text": "Hi,\n\nAttach please the source .xls file you work with\n\nRegards, Evgeniy"}, {"count": 2, "tags": [], "creator": "tony810428@hotmail.com", "attachment_id": 29305, "text": "Created attachment 29305\nthis xls can remove all comments\n\nthis xls can remove all comments", "id": 161839, "time": "2012-08-30T12:59:40Z", "bug_id": 53799, "creation_time": "2012-08-30T12:59:40Z", "is_private": false}, {"count": 3, "tags": [], "creator": "tony810428@hotmail.com", "attachment_id": 29306, "text": "Created attachment 29306\nthis xls can't remove all comments\n\nI added 2 rows to this xls base on before xls, and this xls can't remove all comments,", "id": 161840, "time": "2012-08-30T13:02:26Z", "bug_id": 53799, "creation_time": "2012-08-30T13:02:26Z", "is_private": false}, {"count": 4, "tags": [], "text": "(In reply to comment #1)\nI added 2 xls files, thanks\n\n> Hi,\n> \n> Attach please the source .xls file you work with\n> \n> Regards, Evgeniy", "is_private": false, "id": 161841, "creator": "tony810428@hotmail.com", "time": "2012-08-30T13:04:41Z", "bug_id": 53799, "creation_time": "2012-08-30T13:04:41Z", "attachment_id": null}, {"count": 5, "tags": [], "text": "I've executed your code with both of your input files successully.\nPlease, say what version of POI do you use.\n\nI used POI trunk latest build. You can see download links on http://poi.apache.org/\nor build yourself from SVN trunk, see http://poi.apache.org/subversion.html. \n\nRegards, Evgeniy", "is_private": false, "id": 161855, "creator": "superrubiroyd@gmail.com", "time": "2012-08-30T19:44:42Z", "bug_id": 53799, "creation_time": "2012-08-30T19:44:42Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 53799, "attachment_id": 29312, "id": 161865, "time": "2012-08-31T12:56:40Z", "creator": "tony810428@hotmail.com", "creation_time": "2012-08-31T12:56:40Z", "is_private": false, "text": "Created attachment 29312\nCode & Run Result\n\noh no..My Code Can't Pass~~~ why?\nI use poi-3.8-20120326.jar\nthx"}, {"count": 7, "tags": [], "text": "Hi Virgil.Chen\n\nYou can download the latest build from this link https://builds.apache.org/job/POI/lastSuccessfulBuild/artifact/build/dist/\n\nRegards, Evgeniy", "is_private": false, "id": 161872, "creator": "superrubiroyd@gmail.com", "time": "2012-08-31T19:31:39Z", "bug_id": 53799, "creation_time": "2012-08-31T19:31:39Z", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 53799, "attachment_id": null, "id": 161884, "time": "2012-09-02T01:45:22Z", "creator": "tony810428@hotmail.com", "creation_time": "2012-09-02T01:45:22Z", "is_private": false, "text": "Dear Evgeniy,\n\nIt's very strange~~ ah ha~~\n\nI download poi-bin-3.9-beta1-20120829.tar.gz to run my test case, but get the same Error~~\n\nany suggestion? JDK Version? OS ?\n\nthank you very much~~\n\n\n\nRegards, Virgil\n\n(In reply to comment #7)\n> Hi Virgil.Chen\n> \n> You can download the latest build from this link\n> https://builds.apache.org/job/POI/lastSuccessfulBuild/artifact/build/dist/\n> \n> Regards, Evgeniy"}, {"count": 9, "tags": [], "text": "Hi Virgil,\n\nI think that OS or jdk version don't affect the result in this case.\nI've checked your code with POI 3.8 and this bug really appeared.\n\nProbably you have two POI libraries in classpath. Please check your configuration one more time and if you find old POI library in your classpath just remove it.\n\nRegards, Evgeniy\n\n(In reply to comment #8)\n> Dear Evgeniy,\n> \n> It's very strange~~ ah ha~~\n> \n> I download poi-bin-3.9-beta1-20120829.tar.gz to run my test case, but get\n> the same Error~~\n> \n> any suggestion? JDK Version? OS ?\n> \n> thank you very much~~\n> \n> \n> \n> Regards, Virgil\n> \n> (In reply to comment #7)\n> > Hi Virgil.Chen\n> > \n> > You can download the latest build from this link\n> > https://builds.apache.org/job/POI/lastSuccessfulBuild/artifact/build/dist/\n> > \n> > Regards, Evgeniy", "is_private": false, "id": 161887, "creator": "superrubiroyd@gmail.com", "time": "2012-09-02T08:59:29Z", "bug_id": 53799, "creation_time": "2012-09-02T08:59:29Z", "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 53799, "attachment_id": null, "id": 161888, "time": "2012-09-02T10:41:03Z", "creator": "tony810428@hotmail.com", "creation_time": "2012-09-02T10:41:03Z", "is_private": false, "text": "Dear Evgeniy,\n\nI created a new project and ran the test case under 3.9-jar, it's passed,\nyou are right, thank you  very much.\n\nI will take the other way to my project so as to avoid it, and waiting next version release.\n\nanyway, thanks~~~\n\n\n\n\n\n(In reply to comment #9)\n> Hi Virgil,\n> \n> I think that OS or jdk version don't affect the result in this case.\n> I've checked your code with POI 3.8 and this bug really appeared.\n> \n> Probably you have two POI libraries in classpath. Please check your\n> configuration one more time and if you find old POI library in your\n> classpath just remove it.\n> \n> Regards, Evgeniy\n> \n> (In reply to comment #8)\n> > Dear Evgeniy,\n> > \n> > It's very strange~~ ah ha~~\n> > \n> > I download poi-bin-3.9-beta1-20120829.tar.gz to run my test case, but get\n> > the same Error~~\n> > \n> > any suggestion? JDK Version? OS ?\n> > \n> > thank you very much~~\n> > \n> > \n> > \n> > Regards, Virgil\n> > \n> > (In reply to comment #7)\n> > > Hi Virgil.Chen\n> > > \n> > > You can download the latest build from this link\n> > > https://builds.apache.org/job/POI/lastSuccessfulBuild/artifact/build/dist/\n> > > \n> > > Regards, Evgeniy"}, {"count": 11, "tags": [], "bug_id": 53799, "attachment_id": null, "id": 161890, "time": "2012-09-02T12:36:04Z", "creator": "superrubiroyd@gmail.com", "creation_time": "2012-09-02T12:36:04Z", "is_private": false, "text": "Virgil,\n\nI'm glad that I helped you. Good luck in your project.\n\nRegards, Evgeniy\n\n(In reply to comment #10)\n> Dear Evgeniy,\n> \n> I created a new project and ran the test case under 3.9-jar, it's passed,\n> you are right, thank you  very much.\n> \n> I will take the other way to my project so as to avoid it, and waiting next\n> version release.\n> \n> anyway, thanks~~~\n> \n> \n> \n> \n> \n> (In reply to comment #9)\n> > Hi Virgil,\n> > \n> > I think that OS or jdk version don't affect the result in this case.\n> > I've checked your code with POI 3.8 and this bug really appeared.\n> > \n> > Probably you have two POI libraries in classpath. Please check your\n> > configuration one more time and if you find old POI library in your\n> > classpath just remove it.\n> > \n> > Regards, Evgeniy\n> > \n> > (In reply to comment #8)\n> > > Dear Evgeniy,\n> > > \n> > > It's very strange~~ ah ha~~\n> > > \n> > > I download poi-bin-3.9-beta1-20120829.tar.gz to run my test case, but get\n> > > the same Error~~\n> > > \n> > > any suggestion? JDK Version? OS ?\n> > > \n> > > thank you very much~~\n> > > \n> > > \n> > > \n> > > Regards, Virgil\n> > > \n> > > (In reply to comment #7)\n> > > > Hi Virgil.Chen\n> > > > \n> > > > You can download the latest build from this link\n> > > > https://builds.apache.org/job/POI/lastSuccessfulBuild/artifact/build/dist/\n> > > > \n> > > > Regards, Evgeniy"}]