[{"count": 0, "tags": [], "creator": "Dmitry.Romanov@gmail.com", "attachment_id": 30758, "id": 169683, "time": "2013-08-23T20:23:58Z", "bug_id": 55476, "creation_time": "2013-08-23T20:23:58Z", "is_private": false, "text": "Created attachment 30758\nthe 2-lines patch to XWPFRun which solves the problem of adding images to docx document using XWPFDocument\n\nIf you try to add a picture to XWPFDocument:\n\nXWPFDocument document = new XWPFDocument().createParagraph().createRun().addPicture(pictureIn, Document.PICTURE_TYPE_JPEG, \"test.jpg\", Units.toEMU(300), Units.toEMU(100));\n\nand then will save it using:\n\ndocument.write(outputStream);\n\nMicrosoft Word won't open such file saying that it is corrupted.\nThere is discussion which touches this issue as well in comments in:\nhttps://issues.apache.org/bugzilla/show_bug.cgi?id=49765\n\nIn particular the root cause is mentioned here:\nhttps://issues.apache.org/bugzilla/show_bug.cgi?id=49765#c14\n\nI'm attaching the patch which resolves the issue."}, {"count": 1, "tags": [], "creator": "didfet@free.fr", "attachment_id": null, "text": "I've tested the patch (I had just made one of my own). It works fine, the pic:pic tag is not empty anymore.", "id": 169726, "time": "2013-08-27T00:09:25Z", "bug_id": 55476, "creation_time": "2013-08-27T00:09:25Z", "is_private": false}, {"count": 2, "tags": [], "text": "Didier,\nI see you marked the bug as RESOLVED/FIXED but I can't see the change in SVN at least in the trunk\nWhen would we expect committing the patch to SVN?", "is_private": false, "bug_id": 55476, "id": 169740, "time": "2013-08-27T18:38:03Z", "creator": "Dmitry.Romanov@gmail.com", "creation_time": "2013-08-27T18:38:03Z", "attachment_id": null}, {"count": 3, "text": "Sorry, I don't exactly know how the patches are supposed to be submitted to SVN or notified to committers. In the guidelines they just say \"set the subject to [PATCH] followed by a brief description\", maybe this is what we should do. Please tell me if I should change the status back.\nBut I think this patch should be committed soon because this issue has been reported several times in forums and in this database.", "bug_id": 55476, "is_private": false, "id": 169747, "time": "2013-08-27T20:48:10Z", "creator": "didfet@free.fr", "creation_time": "2013-08-27T20:48:10Z", "tags": [], "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 55476, "is_private": false, "text": "reponening this issue then as it is not commited yet", "id": 169756, "time": "2013-08-28T05:28:35Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2013-08-28T05:28:35Z", "attachment_id": null}, {"count": 5, "tags": [], "text": "\u6211\u7684\u4e5f\u662f\u8fd9\u4e2a\u95ee\u9898", "is_private": false, "id": 179213, "creation_time": "2014-11-21T01:29:14Z", "time": "2014-11-21T01:29:14Z", "creator": "y674277429@163.com", "bug_id": 55476, "attachment_id": null}, {"count": 6, "tags": [], "creator": "dominik.stadler@gmx.at", "is_private": false, "id": 188448, "attachment_id": null, "bug_id": 55476, "creation_time": "2016-02-15T19:18:22Z", "time": "2016-02-15T19:18:22Z", "text": "I tried, but could not reproduce this problem, adding pictures worked fine, Microsoft Word could open the document. See the unit-test added in r1730598.\n\nTherefore I am closing this for now, if this is still does not work for you with the latest version of POI then please provide the sample code and the exact version of Microsoft Word that you are using to allow us to reproduce this."}]