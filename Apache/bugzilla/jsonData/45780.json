[{"count": 0, "tags": [], "creator": "antti.koskimaki@joinex.com", "attachment_id": 22556, "id": 120538, "time": "2008-09-11T07:57:56Z", "bug_id": 45780, "creation_time": "2008-09-11T07:57:56Z", "is_private": false, "text": "Created attachment 22556\nPatch for shiftRows to update area references too\n\nHSSFSheet.shiftRows updates single references (A1) but leaves area references (A1:A4) intact. \n\nPatch fixing this attaced. I simply handled AreaPtg exactly the same way RefPtg was handled."}, {"count": 1, "tags": [], "text": "Fixed in svn r696038.\n\nThis fix has added (hopefully complete) support for adjusting area refs due to row shifting.  Formulas are now adjusted in every cell in the workbook (i.e current *and* all other sheets).  However, other (non-cell) formulas such as defined names, data validation and conditional formats are not adjusted yet.\n\nThis turned out to be more complex than expected. There are many permutations regarding the exact relation of the moved rows to the area ref in question, for example whether the moved rows initially overlap or end up overlapping the area ref, whether the overlap is complete or partial.  JUnits were updated and added to cover this new functionality.\n\nThe Ptg translation logic was moved into a separate class, 'FormulaShifter', to allow for easier testing and enhancement.  This class could be augmented later to provide support for shifting columns, or perhaps any rectangular region.  The Ptg adjusting logic should be easy to re-use for non-cell formulas if someone ever wants to write that patch.\n", "is_private": false, "bug_id": 45780, "id": 120693, "time": "2008-09-16T13:38:44Z", "creator": "josh@apache.org", "creation_time": "2008-09-16T13:38:44Z", "attachment_id": null}]