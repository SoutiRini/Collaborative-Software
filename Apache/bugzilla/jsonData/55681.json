[{"count": 0, "tags": [], "bug_id": 55681, "attachment_id": null, "text": "I am testing what happens when Encode/Decode Exceptions occur during JSR-356 communication.  In our case, we do NOT use annotation, but we \"extend Endpoint\" and \"implement Whole<ThingworxMessage>\".  I was forcing a DecodeException to occur - expecting to my onError to be called with the actual DecodeException.  Instead, I got a Null.  \n\nStepping the following code in Tomcat:\n\nin onMessage, the ((WsSession)session) is NULL.  As a result, the actual DecodeException (cause) is lost.\n\n       // Can this message be decoded?\n        Object payload;\n        try {\n            payload = decode(message);\n        } catch (DecodeException de) {\n            ((WsSession) session).getLocal().onError(session, de);\n            return;\n        }\n\n\nTracing this further up the stack, I found that Util.getMessageHandlers is initializing it and passing NULL in for the session:\n\n            if (decoderMatch.getTextDecoders().size() > 0) {\n                MessageHandlerResult result = new MessageHandlerResult(\n                        new PojoMessageHandlerWholeText(listener, m, null,\n                                endpointConfig,\n                                decoderMatch.getTextDecoders(), new Object[1],\n                                0, false, -1, -1),\n                        MessageHandlerResultType.TEXT);\n                results.add(result);\n            }\n\nPlease let me know if I can provide any more details.\n\n-bob", "id": 170711, "time": "2013-10-20T17:37:21Z", "creator": "bob.deremer@thingworx.com", "creation_time": "2013-10-20T17:37:21Z", "is_private": false}, {"count": 1, "tags": [], "creator": "markt@apache.org", "text": "Fixed in trunk for 8.0.0-RC6 onwards and in 7.0.x for 7.0.78 onwards.", "id": 170713, "time": "2013-10-20T21:05:41Z", "bug_id": 55681, "creation_time": "2013-10-20T21:05:41Z", "is_private": false, "attachment_id": null}, {"count": 2, "attachment_id": null, "bug_id": 55681, "is_private": false, "id": 170714, "time": "2013-10-20T21:05:59Z", "creator": "markt@apache.org", "creation_time": "2013-10-20T21:05:59Z", "tags": [], "text": "Whoops. That should be 7.0.48"}]