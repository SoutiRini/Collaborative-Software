[{"count": 0, "tags": [], "text": "The following xml file fails when using java 1.2, but works with java 1.3 or\nnewer.  The xml file is:\n\n<?xml version=\"1.0\"?>\n<project name=\"Config\" default=\"help\" basedir=\".\">\n  <patternset id=\"fixcrlf_files\">\n    <include name=\"*.xml\"/>\n  </patternset>\n  <target name=\"fix_newlines\">\n    <echo message=\"Modifying text files ...\"/>\n    <chmod perm=\"+w\">\n      <fileset dir=\".\">\n        <patternset refid=\"fixcrlf_files\"/>\n      </fileset>\n    </chmod>\n  </target>\n</project>\n\nIt is being executed by doing the following:\n\nconfig.sh fix_newlines\n\nHere is config.sh:\n\n#!/bin/sh\n\njava -cp \"ant.jar:xercesImpl.jar:optional.jar:xml-apis.jar\" \\\n    org.apache.tools.ant.Main -v -f config.xml \"$@\"\n\n\nHere is the output when run with java 1.2:\n\nApache Ant version 1.5 compiled on July 9 2002\nBuildfile: config.xml\nDetected Java version: 1.2 in: /usr/java1.2/jre\nDetected OS: SunOS\nparsing buildfile config.xml with URI = file:/users/devp/mc/config.xml\nProject base dir set to: /users/devp/mc\nBuild sequence for target `fix_newlines' is [fix_newlines]\nComplete build sequence is [fix_newlines]\n\nfix_newlines:\n     [echo] Modifying text files ...\n    [chmod] Current OS is SunOS\n    [chmod] Executing 'chmod' with arguments:\n    [chmod] '+w'\n    [chmod] '/users/devp/mc/config.xml'\n    [chmod] \n    [chmod] The ' characters around the executable and arguments are\n    [chmod] not part of the command.\n\nBUILD FAILED\nfile:/users/devp/mc/config.xml:9: Execute failed: java.io.IOException: Cannot\nlocate antRun script: Property 'ant.home' not found\n        at java.lang.Throwable.fillInStackTrace(Native Method)\n        at java.lang.Throwable.fillInStackTrace(Compiled Code)\n        at java.lang.Throwable.<init>(Compiled Code)\n        at java.lang.Exception.<init>(Exception.java:42)\n        at java.lang.RuntimeException.<init>(RuntimeException.java:47)\n        at org.apache.tools.ant.BuildException.<init>(BuildException.java:99)\n        at org.apache.tools.ant.BuildException.<init>(Compiled Code)\n        at org.apache.tools.ant.taskdefs.ExecuteOn.runExec(Compiled Code)\n        at org.apache.tools.ant.taskdefs.ExecTask.execute(ExecTask.java:250)\n        at org.apache.tools.ant.taskdefs.Chmod.execute(Chmod.java:211)\n        at org.apache.tools.ant.Task.perform(Task.java:317)\n        at org.apache.tools.ant.Target.execute(Compiled Code)\n        at org.apache.tools.ant.Target.performTasks(Target.java:334)\n        at org.apache.tools.ant.Project.executeTarget(Compiled Code)\n        at org.apache.tools.ant.Project.executeTargets(Compiled Code)\n        at org.apache.tools.ant.Main.runBuild(Compiled Code)\n        at org.apache.tools.ant.Main.start(Compiled Code)\n        at org.apache.tools.ant.Main.main(Main.java:235)\n--- Nested Exception ---\njava.io.IOException: Cannot locate antRun script: Property 'ant.home' not found\n        at java.lang.Throwable.fillInStackTrace(Native Method)\n        at java.lang.Throwable.fillInStackTrace(Compiled Code)\n        at java.lang.Throwable.<init>(Compiled Code)\n        at java.lang.Exception.<init>(Exception.java:42)\n        at java.io.IOException.<init>(IOException.java:47)\n        at\norg.apache.tools.ant.taskdefs.Execute$ScriptCommandLauncher.exec(Execute.java:784)\n        at org.apache.tools.ant.taskdefs.Execute.launch(Execute.java:417)\n        at org.apache.tools.ant.taskdefs.Execute.execute(Execute.java:428)\n        at org.apache.tools.ant.taskdefs.ExecTask.runExecute(Compiled Code)\n        at org.apache.tools.ant.taskdefs.ExecuteOn.runExec(Compiled Code)\n        at org.apache.tools.ant.taskdefs.ExecTask.execute(ExecTask.java:250)\n        at org.apache.tools.ant.taskdefs.Chmod.execute(Chmod.java:211)\n        at org.apache.tools.ant.Task.perform(Task.java:317)\n        at org.apache.tools.ant.Target.execute(Compiled Code)\n        at org.apache.tools.ant.Target.performTasks(Target.java:334)\n        at org.apache.tools.ant.Project.executeTarget(Compiled Code)\n        at org.apache.tools.ant.Project.executeTargets(Compiled Code)\n        at org.apache.tools.ant.Main.runBuild(Compiled Code)\n        at org.apache.tools.ant.Main.start(Compiled Code)\n        at org.apache.tools.ant.Main.main(Main.java:235)\n\nTotal time: 3 seconds\n\n\n\nHere is the output when run with java 1.3:\n\nApache Ant version 1.5 compiled on July 9 2002\nBuildfile: config.xml\nDetected Java version: 1.3 in: /sonicqa/solaris/j2re1_3_1_01/j2re1_3_1_01\nDetected OS: SunOS\nparsing buildfile config.xml with URI = file:/users/devp/mc/config.xml\nProject base dir set to: /users/devp/mc\nBuild sequence for target `fix_newlines' is [fix_newlines]\nComplete build sequence is [fix_newlines]\n\nfix_newlines:\n     [echo] Modifying text files ...\n    [chmod] Current OS is SunOS\n    [chmod] Executing 'chmod' with arguments:\n    [chmod] '+w'\n    [chmod] '/users/devp/mc/config.xml'\n    [chmod] \n    [chmod] The ' characters around the executable and arguments are\n    [chmod] not part of the command.\n\nBUILD SUCCESSFUL\nTotal time: 3 seconds\n\n\n\nThis issue is occuring when forking a java process.", "is_private": false, "bug_id": 11568, "id": 20811, "time": "2002-08-08T18:28:23Z", "creator": "mc@sonicsoftware.com", "creation_time": "2002-08-08T18:28:23Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 11568, "attachment_id": null, "id": 20812, "time": "2002-08-08T18:34:13Z", "creator": "mc@sonicsoftware.com", "creation_time": "2002-08-08T18:34:13Z", "is_private": false, "text": "The last line should read:\n\nThis issue is ALSO occuring when forking a java process from within the xml file."}, {"count": 2, "tags": [], "creator": "billb@progress.com", "text": "When running under a 1.1 or 1.2 JVM or when the <exec> task's vmlauncher \nattribute is set to false, Ant uses the bin/antRun script if the dir attribute \nis specified with a directory other than the current one.  In order to find the \nantRun script, the property ant.home must be set to the base directory where Ant \nis installed, i.e. -Dant.home=/usr/local/ant.  Like the <exec> task, the <chmod> \ntask is executing the native UNIX chmod command so it needs to call the antRun \nscript to change the directory before running the command.\n\nIn 1.3 JVM's and above, Runtime.exec supports the ability to launch an \nexecutable in a different directory so the antRun script isn't required to run \nthe command.\n\nIf the above is substantially correct, can someone mark the bug appropriately?", "id": 20814, "time": "2002-08-08T18:59:17Z", "bug_id": 11568, "creation_time": "2002-08-08T18:59:17Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 11568, "attachment_id": null, "id": 20815, "time": "2002-08-08T19:16:15Z", "creator": "mc@sonicsoftware.com", "creation_time": "2002-08-08T19:16:15Z", "is_private": false, "text": "\nThe fact that this same script works with Ant 1.3 would lead me to believe that\nit is a regression issue."}, {"count": 4, "tags": [], "bug_id": 11568, "attachment_id": null, "id": 20848, "time": "2002-08-09T14:47:00Z", "creator": "bodewig@apache.org", "creation_time": "2002-08-09T14:47:00Z", "is_private": false, "text": "Bill is correct and your script should fail for the same reason in Ant 1.3."}, {"count": 5, "tags": [], "bug_id": 11568, "attachment_id": null, "text": "I checked this on a Solaris box with both 1.3 and 1.5 using JDK 1.2.2\n\nI ran using a script without the -Dant.home\n\nsbailliez>java -cp ~/opt/jakarta-ant-1.3/lib/ant.jar:~/opt/j\nakarta-ant-1.3/lib/parser.jar:~/opt/jakarta-ant-1.3/lib/jaxp.jar \norg.apache.tools.ant.Main -v\n\nAnt version 1.3 compiled on March 2 2001\n\nBuildfile: build.xml\nDetected Java Version: 1.2\nDetected OS: SunOS\nparsing buildfile /home/sbailliez/build.xml with URI = file:/home/sbailliez/buil\nd.xml\nProject base dir set to: /home/sbailliez\nBuild sequence for target `fix_newlines' is [fix_newlines]\nComplete build sequence is [fix_newlines]\n\nfix_newlines:\n     [echo] Modifying text files ...\n    [chmod] Myos = SunOS\n    [chmod] chmod +w\n    [chmod] Executing chmod +w /home/sbailliez/build.xml\n\nBUILD SUCCESSFUL\n\nTotal time: 0 seconds\n\nsbailliez>java -cp ~/opt/jakarta-ant-1.5/lib/ant.jar:~/opt/j\nakarta-ant-1.5/lib/xercesImpl.jar:~/opt/jakarta-ant-1.3/lib/xml-ap\nis.jar org.apache.tools.ant.Main -v\n\nApache Ant version 1.5 compiled on July 9 2002\nBuildfile: build.xml\nDetected Java version: 1.2 in: /usr/jdk1.2.2_ref/jre\nDetected OS: SunOS\nparsing buildfile build.xml with URI = file:/home/sbailliez/build.xml\nProject base dir set to: /home/sbailliez\nBuild sequence for target `fix_newlines' is [fix_newlines]\nComplete build sequence is [fix_newlines]\n\nfix_newlines:\n     [echo] Modifying text files ...\n    [chmod] Current OS is SunOS\n    [chmod] Executing 'chmod' with arguments:\n    [chmod] '+w'\n    [chmod] '/home/sbailliez/build.xml'\n    [chmod] \n    [chmod] The ' characters around the executable and arguments are\n    [chmod] not part of the command.\n\nBUILD FAILED\nfile:/home/sbailliez/build.xml:8: Execute failed: java.io.IOException: Cannot lo\ncate antRun script: Property 'ant.home' not found\n        at org.apache.tools.ant.taskdefs.ExecuteOn.runExec(ExecuteOn.java, Compi\nled Code)\n        at org.apache.tools.ant.taskdefs.ExecTask.execute(ExecTask.java, Compile\nd Code)\n        at org.apache.tools.ant.taskdefs.Chmod.execute(Chmod.java, Compiled Code\n)\n        at org.apache.tools.ant.Task.perform(Task.java, Compiled Code)\n        at org.apache.tools.ant.Target.execute(Target.java, Compiled Code)\n        at org.apache.tools.ant.Target.performTasks(Target.java, Compiled Code)\n        at org.apache.tools.ant.Project.executeTarget(Project.java, Compiled Cod\ne)\n        at org.apache.tools.ant.Project.executeTargets(Project.java, Compiled Co\nde)\n        at org.apache.tools.ant.Main.runBuild(Main.java, Compiled Code)\n        at org.apache.tools.ant.Main.start(Main.java, Compiled Code)\n        at org.apache.tools.ant.Main.main(Main.java, Compiled Code)\n--- Nested Exception ---\njava.io.IOException: Cannot locate antRun script: Property 'ant.home' not found\n        at org.apache.tools.ant.taskdefs.Execute$ScriptCommandLauncher.exec(Exec\nute.java, Compiled Code)\n        at org.apache.tools.ant.taskdefs.Execute.launch(Execute.java, Compiled C\node)\n        at org.apache.tools.ant.taskdefs.Execute.execute(Execute.java, Compiled \nCode)\n        at org.apache.tools.ant.taskdefs.ExecTask.runExecute(ExecTask.java, Comp\niled Code)\n        at org.apache.tools.ant.taskdefs.ExecuteOn.runExec(ExecuteOn.java, Compi\nled Code)\n        at org.apache.tools.ant.taskdefs.ExecTask.execute(ExecTask.java, Compile\nd Code)\n        at org.apache.tools.ant.taskdefs.Chmod.execute(Chmod.java, Compiled Code\n)\n        at org.apache.tools.ant.Task.perform(Task.java, Compiled Code)\n        at org.apache.tools.ant.Target.execute(Target.java, Compiled Code)\n        at org.apache.tools.ant.Target.performTasks(Target.java, Compiled Code)\n        at org.apache.tools.ant.Project.executeTarget(Project.java, Compiled Cod\ne)\n        at org.apache.tools.ant.Project.executeTargets(Project.java, Compiled Co\nde)\n        at org.apache.tools.ant.Main.runBuild(Main.java, Compiled Code)\n        at org.apache.tools.ant.Main.start(Main.java, Compiled Code)\n        at org.apache.tools.ant.Main.main(Main.java, Compiled Code)\n\nTotal time: 2 seconds\n\n\n", "id": 21027, "time": "2002-08-14T14:38:59Z", "creator": "sbailliez@apache.org", "creation_time": "2002-08-14T14:38:59Z", "is_private": false}, {"count": 6, "tags": [], "text": "Ooops reopening", "attachment_id": null, "bug_id": 11568, "id": 21029, "time": "2002-08-14T14:39:37Z", "creator": "sbailliez@apache.org", "creation_time": "2002-08-14T14:39:37Z", "is_private": false}, {"count": 7, "tags": [], "text": "This is not strictly a regression. You are not running Ant properly because you\nare not defining ant.home \n\n", "attachment_id": null, "bug_id": 11568, "id": 29682, "time": "2003-01-19T14:51:38Z", "creator": "conor@apache.org", "creation_time": "2003-01-19T14:51:38Z", "is_private": false}]