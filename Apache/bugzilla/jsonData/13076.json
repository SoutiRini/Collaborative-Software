[{"count": 0, "tags": [], "creator": "dennis@righthandmanager.com", "attachment_id": null, "text": "The version is actually 1.8.0-dev, but I didn't see that in the list.\n\nI got the following exception when running BiffViewer on the file attached to\nthis bug:\n\n============================================\nOffset 0x20db (8411)\n[WARNING] Unknown Ptg 12 (18) at cell (10,1)\nrecordid = 0x6, size =30\njava.lang.NullPointerException\n        at org.apache.poi.hssf.record.FormulaRecord.toString(FormulaRecord.java:\n548)\n        at org.apache.poi.hssf.dev.BiffViewer.createRecord(BiffViewer.java:638)\n        at org.apache.poi.hssf.dev.BiffViewer.createRecords(BiffViewer.java:158)\n\n        at org.apache.poi.hssf.dev.BiffViewer.run(BiffViewer.java:110)\n        at org.apache.poi.hssf.dev.BiffViewer.main(BiffViewer.java:687)", "id": 23533, "time": "2002-09-27T14:01:24Z", "bug_id": 13076, "creation_time": "2002-09-27T14:01:24Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 13076, "attachment_id": 3259, "id": 23534, "time": "2002-09-27T14:03:14Z", "creator": "dennis@righthandmanager.com", "creation_time": "2002-09-27T14:03:14Z", "is_private": false, "text": "Created attachment 3259\nExcel document that caused the bug report"}, {"count": 2, "tags": [], "bug_id": 13076, "text": "I found what causes the NPE. In FormulaRecord.fillFields(), if an\nUnsupportedOperationException is thrown while parsing, the field\nfield_8_parsed_expr is set to null, but then the following appears in\nFormulaRecord.toString() (line 548):\n\nbuffer.append(\"    .numptgsinarray  = \").append(field_8_parsed_expr.size())\n                .append(\"\\n\");\n            \nfor (int k = 0; k < field_8_parsed_expr.size(); k++ ) {\n\nEither reference to field_8_parsed_expr.size() will cause an NPE because the\nfield was set to null.", "id": 26104, "time": "2002-11-11T22:06:56Z", "creator": "dennis@righthandmanager.com", "creation_time": "2002-11-11T22:06:56Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "dennis@righthandmanager.com", "attachment_id": 3821, "text": "Created attachment 3821\nPatch file that fixes the problem", "id": 26138, "time": "2002-11-12T16:45:37Z", "bug_id": 13076, "creation_time": "2002-11-12T16:45:37Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 13076, "text": "Patch attached. Note that this patch means that BiffViewer will not fail with an\nexception when a formula doesn't parse--you'll just see a WARNING in the output.\nMaybe that means you want to change BiffViewer, but this is the right patch for\nthis problem, anyway.", "id": 26139, "time": "2002-11-12T16:46:01Z", "creator": "dennis@righthandmanager.com", "creation_time": "2002-11-12T16:46:01Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "poi-support@buni.org", "attachment_id": null, "text": "applied and committed.  Please crosscheck.  It would be good if we could signal\nan error in a recoverable way.  ", "id": 27138, "time": "2002-11-28T18:59:00Z", "bug_id": 13076, "creation_time": "2002-11-28T18:59:00Z", "is_private": false}]