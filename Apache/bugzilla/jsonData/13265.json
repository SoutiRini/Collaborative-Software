[{"count": 0, "tags": [], "creator": "sunkarsr@lycos.com", "attachment_id": null, "text": "Hi,\n\nI am using POI 1.5 released version to create excel files and for some reason I \ncouldn't create them on Windows NT 4.0, WebSphere Application Server 3.5 and \nJDK 1.2.2.\n\nI am trying to create an excel file with 3 sheets in it and some colors and \ncontent. I don't see any exception or error when I am trying to create the \nfile. However when I look at the created file, I see only ASCII characters in \nan unreadable format. All three sheets were combined in to one sheet with \ndefault file name as sheet name.\n\nCould some one explain me why and how to fix this.\n\nThanks for all your help and attention,\n-Srinvas", "id": 23870, "time": "2002-10-03T23:45:43Z", "bug_id": 13265, "creation_time": "2002-10-03T23:45:43Z", "is_private": false}, {"count": 1, "tags": [], "creator": "julien.ferre@unilog.fr", "attachment_id": null, "text": "I have the same problem with a Windows 2000 and WAS 3.5.3. I use Visual Ages \nfor java for developpement and have no problem with the XLS files I generate, \nso I guess it must come form the WAS's JVM.", "id": 23893, "time": "2002-10-04T08:50:04Z", "bug_id": 13265, "creation_time": "2002-10-04T08:50:04Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 13265, "attachment_id": null, "is_private": false, "id": 23907, "time": "2002-10-04T12:10:54Z", "creator": "poi-support@buni.org", "creation_time": "2002-10-04T12:10:54Z", "text": "For starts please ensure you're using 1.5.1 and not 1.5.  Secondly, in reporting\nbugs we need the minimum simplest code necessary to reproduce the bug as well as\nthe result (sheet).  (Click create a new attachment)..  Otherwise I can only\nguess whats wrong.\n\n-Andy"}, {"count": 3, "tags": [], "bug_id": 13265, "attachment_id": 3346, "id": 23909, "time": "2002-10-04T12:28:48Z", "creator": "julien.ferre@unilog.fr", "creation_time": "2002-10-04T12:28:48Z", "is_private": false, "text": "Created attachment 3346\nPOI sample code that don't works"}, {"count": 4, "tags": [], "bug_id": 13265, "attachment_id": 3347, "id": 23910, "time": "2002-10-04T12:30:39Z", "creator": "julien.ferre@unilog.fr", "creation_time": "2002-10-04T12:30:39Z", "is_private": false, "text": "Created attachment 3347\nSample of what is generated"}, {"count": 5, "tags": [], "bug_id": 13265, "attachment_id": null, "text": "We use POI 1.5.1\nHere is the code sample we use to create the XLS file. \nI didn't have time to isolate the POI code inside our main code and the \ndevelopper didn't take time to make a component to use POI API (grrrr :()\n\nWe don't do make very complicated things.\nI also attach the result of this code.\nthanks for help\n\n", "id": 23911, "time": "2002-10-04T12:31:21Z", "creator": "julien.ferre@unilog.fr", "creation_time": "2002-10-04T12:31:21Z", "is_private": false}, {"count": 6, "tags": [], "text": "Okay...from this the best I can say is your code looks fine overall.  Nothing\njumps out at me.  (Since I can't run it this doesn't mean much).  However the\nfile has crap in the header.  I ran org.apache.poi.hssf.dev.BiffViewer on it and\neven the first few bytes are garbled.  It looks as if some other garbage got\nwritten to the top of the file.  I opened it in vi and the header has some\nstrange things in it that I would not expect to see:\n\n\u00c8\u00f0^Y4\u00a1\u00b1^Z\u00e1\u00e7*^C^P\u00e7*^C^P\u00e7*^C^P\u00e7*^C^P;^@^C^@\u00fe\u00ff    \n^@\u00e7*^C^P\u00e7*^C^P\u00e7*^C^P^@\u00b6^A^P^D^@^@^@\u00e7*^C^P\u00e7*^C^P^D^@^@^@\u00e7*^C^P~X\u00a7\u00c6^P~X\u00a7\u00c6^P\u00e7*^C^P\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\n^H^P^@^@^F^E^@\u00d3^P\u00cc^GA^@^@^@^F^@^@^@\u00e1^@^B^@\u00b0^D\u00c1^@^B^@^@^@\u00e2^@^@^@\\^@p^@^D^@^@db2admin\n                                                                               \n                    B\n\nThis is the header from a healthy file:\n\n\u00d0\u00cf^Q\u00e0\u00a1\u00b1^Z\u00e1^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@;^@^C^@\u00fe\u00ff    \n^@^F^@^@^@^@^@^@^@^@^@^@^@^A^@^@^@^H^@^@^@^@^@^@^@^@^P^@^@\u00fe\u00ff\u00ff\u00ff^A^@^@^@\u00fe\u00ff\u00ff\u00ff^@^@^@^@\n    \n^@^@^@\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\u00ff\n ^H^P^@^@^F^E^@\u00af^X\u00cd^G\u00c1@^@^@^F^A^@^@\u00e1^@^B^@\u00b0^D\u00c1^@^B^@^@^@\u00e2^@^@^@\\^@p^@^D^@^@nameas Wegmueller                                                                                            B\n\nGranted this is a goofy check since its binary and I'm opening it with a text\neditor, however if you look at the first few characters its always the same.  \n\nI'm closing this as a bug as it doesn't seem to be a bug in POI rather some\nquirkiness in WS.  Repost to the poi-users list and see if any websphere folks\nthere can help you.  I know someone had a similar problem awhile back that they\nwere able to resolve.  I'd also like to make the suggestion that if you'd like\nto fix this you're going to have to invest the time to do the legwork as no one\nis going to do the dirty work for you for free (even if they can) just because\nyou \"don't have time\".  My attitude is generally \"I'm willing to help\n(especially if it helps the project as a whole), but you have to commit to doing\nthe bulk of the work.\"\n\n-Andy", "is_private": false, "id": 23921, "creator": "poi-support@buni.org", "time": "2002-10-04T13:48:20Z", "bug_id": 13265, "creation_time": "2002-10-04T13:48:20Z", "attachment_id": null}, {"count": 7, "tags": [], "text": "Thanks. I didn't want anyone to do the dirty job. it just appears that when we \nare deploying the applicaiton under websphere the files are not correct nay \nmore whereas they are under VAJ. SO I was wondering if anyone has the same \nproblem. I saw that bug on the bug list and tought it was the same. \nI was wondering if anyone had alreayd solved the problem or at least I wanted \nto know if it was unsolvable. \ni didn't have the time mean it appears realyl soon and right now I didn't have \nthe time as I had a release to prepare quite fast so I didn't have to make a \nclear test. i aslo did not try to take that time as someone had the same \nproblem.\nI will follow your adivse and go to user list.\nthanks for the time you take. and sorry to get you into on nervse. i use to \nmake the dirty job here so i undertsand you very well\n", "is_private": false, "id": 23922, "creator": "julien.ferre@unilog.fr", "time": "2002-10-04T13:56:54Z", "bug_id": 13265, "creation_time": "2002-10-04T13:56:54Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 13265, "is_private": false, "count": 8, "id": 23928, "time": "2002-10-04T14:52:00Z", "creator": "sunkarsr@lycos.com", "creation_time": "2002-10-04T14:52:00Z", "text": "Thanks a bunch to Ferre and Andy for your attention. I didn't mean that this is \nbug in POI and some one has to fix it. I thought may be I could find some one \nelse who is experiencing the similar problem and could help me with that. \nAgain, I don't expect others to do the dirty job for me (which doesn't make any \nsense).\n\nGiven that this could be an issue with WAS (I assume) I'll see if I can find \nany solution to this.\n\nFerre, could you let us know if you find any on this.\n\nThanks again to both of you for your time and attention in this."}, {"count": 9, "tags": [], "text": "cool.  For future reference.  the most appropriate place to ask for help is on\nthe poi-user mail list.  Bugzilla is for bugs and patches.  Thanks.", "is_private": false, "id": 23943, "creator": "poi-support@buni.org", "time": "2002-10-04T18:23:28Z", "bug_id": 13265, "creation_time": "2002-10-04T18:23:28Z", "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 13265, "attachment_id": null, "id": 24067, "creation_time": "2002-10-07T14:17:45Z", "time": "2002-10-07T14:17:45Z", "creator": "sunkarsr@lycos.com", "text": "I installed Fix Pack 4 on WAS 3.5 and it did fix the problem. (Before I had Fix \nPack 2.) Hope this helps !", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 13265, "is_private": false, "count": 11, "id": 92145, "time": "2006-08-11T15:34:34Z", "creator": "virupatel@hotmail.com", "creation_time": "2006-08-11T15:34:34Z", "text": "(In reply to comment #4)\n> Created an attachment (id=3347) [edit]\n> Sample of what is generated\n\nI came across the same problem and found that response buffer needs to be \ncleared before writing HSSF output to the console.\n\nThis problem seems to be only with BEA Weblogic and the code works fine with \nother servers. The sample code is attached below.\n\ntry{\n\tOutputStream fOut = response.getOutputStream();\n\t\n\tresponse.reset();\t\t\t\t\t\t\n\tresponse.setContentType(\"application/vnd.ms-excel\");\n\tresponse.setHeader(\"Content-Disposition\",\"inline;filename=report.xls\");\n\t\t\n\tworkbook.write(fOut);\n\t\t\t\t\t\t\t\n\tfOut.flush();\n\tfOut.close();\t\t\t\t\n}catch(Exception e){\n\tSystem.out.println(\"Error Occured\");\n}\n\nHope that helps.\nThanks\nViral Patel"}]