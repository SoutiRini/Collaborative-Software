[{"count": 0, "tags": [], "text": "The XSSFDrawing.createCellComment contains this validation check:\n        if(comments.findCellComment(ref) != null) {\n            throw new IllegalArgumentException(\"Multiple cell comments in one cell are not allowed, cell: \" + ref);\n        }\n\nThis is wrong because this assumes the comment is added to the col1 and row1. But this is the anchor only and does not necessarily mean that this comment is added to this cell. Real life sample from Excel 2010:\n\t\t<x:ClientData ObjectType=\"Note\">\n\t\t\t<x:MoveWithCells/>\n\t\t\t<x:SizeWithCells/>\n\t\t\t<x:Anchor>\n    2, 15, 1, 14, 3, 55, 5, 21</x:Anchor>\n\t\t\t<x:AutoFill>False</x:AutoFill>\n\t\t\t<x:Row>2</x:Row>\n\t\t\t<x:Column>1</x:Column>\n\t\t\t<x:Visible/>\n\t\t</x:ClientData>\nIn this the anchor is cell C2 (col 2, row 1) but the comment is set for cell B3 (col 1, row 2).\n\nSo this validation check has to be removed.", "is_private": false, "bug_id": 59186, "id": 189523, "time": "2016-03-17T09:33:32Z", "creator": "snowy@web.de", "creation_time": "2016-03-17T09:33:32Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 59186, "text": "Created attachment 33681\nPatch that removes the validation", "id": 189527, "time": "2016-03-17T10:49:37Z", "creator": "snowy@web.de", "creation_time": "2016-03-17T10:49:37Z", "is_private": false, "attachment_id": 33681}, {"count": 2, "text": "Remember that Excel's cell address format is inverted: column/row.\n\nB3 (row 3, col B) is cell 2, 1 (0-indexed)\nC2 (row 2, col C) is cell 1, 2 (0-indexed)\n\nI believe the code works correctly.", "creator": "onealj@apache.org", "is_private": false, "id": 189560, "time": "2016-03-18T03:47:35Z", "bug_id": 59186, "creation_time": "2016-03-18T03:47:35Z", "tags": [], "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 59186, "attachment_id": null, "text": "Refer to bug 56835\nUnit test which demonstrates that adding a comment in the same cell twice is not allowed (since it would produce a corrupt workbook):\nhttp://svn.apache.org/viewvc/poi/trunk/src/ooxml/testcases/org/apache/poi/xssf/usermodel/TestXSSFDrawing.java?r1=1633397&r2=1633396&pathrev=1633397", "id": 189562, "time": "2016-03-18T03:58:29Z", "creator": "onealj@apache.org", "creation_time": "2016-03-18T03:58:29Z", "is_private": false}]