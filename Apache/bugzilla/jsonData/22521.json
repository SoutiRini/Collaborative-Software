[{"count": 0, "attachment_id": null, "creator": "epritcha@wiley.co.uk", "text": "When running the core <java> task with fork=\"false\", <sysproperty> fails to set\njava.endorsed.dirs such that it is used by the JVM; i.e. I get a\njava.lang.NoClassDefFoundError exception. \n\nWorks correctly as either <sysproperty> or \"-D\" <arg> when fork=\"true\"; i.e. I\ndon't get a java.lang.NoClassDefFoundError exception.\n\nJDK 1.4.2\nAnt 1.5.4\nSolaris 5.8\n\nbuild.xml snippit (in non-working case):\n\n  <target name=\"testsoap\" depends=\"main\">\n\n    <java classname=\"client.TestSOAPClient\" fork=\"false\">\n      <sysproperty key=\"java.endorsed.dirs\" file=\"${jwsdp.endorsed.dir}\"/>\n      <classpath>\n        <pathelement location=\"${build.dir}/${appname}/classes\"/>\n        <fileset refid=\"saaj.classpath\"/>\n        <fileset refid=\"jakata-commons.classpath\"/>\n        <fileset refid=\"j2ee.classpath\"/>\n      </classpath>\n    </java>\n  </target>", "id": 42924, "time": "2003-08-18T15:11:30Z", "bug_id": 22521, "creation_time": "2003-08-18T15:11:30Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "text": "Well, I am sure that the property is being passed down. However, the fact that\nyou are running unforked probably means that a new JVM is not being started up,\nso the new endorsed dir setting is not being picked up by anything.\n\nI am not sure that this is fixable; it may one of those 'why you have to fork'\nthings that we have to document. ", "is_private": false, "id": 42928, "creator": "stevel@apache.org", "time": "2003-08-18T17:07:20Z", "bug_id": 22521, "creation_time": "2003-08-18T17:07:20Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "stevel@apache.org", "attachment_id": null, "id": 43022, "creation_time": "2003-08-19T23:55:51Z", "time": "2003-08-19T23:55:51Z", "bug_id": 22521, "text": "On this subject, we may want to have ant.bat/sh to make ANT_HOME/lib endorsed,\nas I seem to be running against crimson on Java1.4.2+linux, against my implicit\n'here is a copy of xerces' wishes.", "is_private": false}, {"count": 3, "tags": [], "bug_id": 22521, "text": "I also think it's because of fork=\"false\".  You are simply not able to convince\nthe currently running JVM that it should consider some other dirs as endorsed\nby changing the property.\n\nWONTFIX means CANTFIX here.", "id": 44461, "time": "2003-09-22T15:49:04Z", "creator": "bodewig@apache.org", "creation_time": "2003-09-22T15:49:04Z", "is_private": false, "attachment_id": null}]