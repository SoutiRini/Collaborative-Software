[{"count": 0, "tags": [], "creator": "maxim@tradertools.com", "attachment_id": null, "text": "I switched from Tomcat 3.2.1 to latest 3.3.1 final and got exception;\nhere is Tomcat's output:\n---------------------------------------------------------------------\n2002-04-01 09:35:31 - ServerXmlReader: Config=$TOMCAT_HOME\\conf\\server.xml\n2002-04-01 09:35:31 - PathSetter: home=C:\\Program Files\\Tomcat\n2002-04-01 09:35:31 - ContextXmlReader: Context config=$TOMCAT_HOME\\conf\\apps-12\n7.0.0.1.xml\n2002-04-01 09:35:31 - ContextXmlReader: Context config=$TOMCAT_HOME\\conf\\apps-ad\nmin.xml\n2002-04-01 09:35:31 - ContextXmlReader: Context config=$TOMCAT_HOME\\conf\\apps-ex\namples.xml\n2002-04-01 09:35:31 - AutoWebApp: Loaded from config: DEFAULT:/admin\n2002-04-01 09:35:31 - AutoWebApp: Loaded from config: DEFAULT:/examples\n2002-04-01 09:35:31 - AutoWebApp: Auto-Adding DEFAULT:/LsGateway\n2002-04-01 09:35:31 - AutoWebApp: Auto-Adding DEFAULT:/\n2002-04-01 09:35:31 - ContextManager: Tomcat configured and in stable state\n2002-04-01 09:35:31 - ContextManager: Adding  DEFAULT:/admin\n2002-04-01 09:35:31 - ContextManager: Adding  DEFAULT:/examples\n2002-04-01 09:35:31 - ContextManager: Adding  DEFAULT:/LsGateway\n2002-04-01 09:35:31 - ContextManager: Adding  DEFAULT:/ROOT\n2002-04-01 09:35:33 - Ctx(/LsGateway) : Exception in preInit org.apache.crimson.\njaxp.SAXParserFactoryImpl - java.lang.ClassCastException: org.apache.crimson.jax\np.SAXParserFactoryImpl\n        at javax.xml.parsers.SAXParserFactory.newInstance(SAXParserFactory.java:\n135)\n        at pfs.ls.gateway.LsGateway.<init>(LsGateway.java:33)\n        at java.lang.Class.newInstance0(Native Method)\n        at java.lang.Class.newInstance(Unknown Source)\n        at org.apache.tomcat.facade.ServletHandler.getServlet(ServletHandler.jav\na:346)\n        at org.apache.tomcat.facade.ServletHandler.preInit(ServletHandler.java:4\n39)\n        at org.apache.tomcat.facade.ServletHandler.init(ServletHandler.java:228)\n\n        at org.apache.tomcat.facade.LoadOnStartupInterceptor.contextInit(LoadOnS\ntartupInterceptor.java:136)\n        at org.apache.tomcat.core.Context.init(Context.java:542)\n        at org.apache.tomcat.core.ContextManager.init(ContextManager.java:597)\n        at org.apache.tomcat.startup.EmbededTomcat.initContextManager(EmbededTom\ncat.java:564)\n        at org.apache.tomcat.startup.EmbededTomcat.execute1(EmbededTomcat.java:7\n03)\n        at org.apache.tomcat.startup.EmbededTomcat$1.run(EmbededTomcat.java:687)\n\n        at org.apache.tomcat.util.compat.Jdk12Support$PrivilegedProxy.run(Jdk12S\nupport.java:190)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at org.apache.tomcat.util.compat.Jdk12Support.doPrivileged(Jdk12Support.\njava:100)\n        at org.apache.tomcat.startup.EmbededTomcat.execute(EmbededTomcat.java:68\n5)\n        at java.lang.reflect.Method.invoke(Native Method)\n        at org.apache.tomcat.util.IntrospectionUtils.execute(IntrospectionUtils.\njava:87)\n        at org.apache.tomcat.startup.Main.execute(Main.java:313)\n        at org.apache.tomcat.startup.Main.main(Main.java:140)\n\nEmbededTomcat: Init time 6409\n2002-04-01 09:35:34 - Http10Interceptor: Starting on 8080\n2002-04-01 09:35:34 - Ajp12Interceptor: Starting on 8007\n2002-04-01 09:35:34 - Ajp13Interceptor: Starting on 8009\nEmbededTomcat: Startup time 561\n--------------------------------------------------------------\nCode that causes exception is:\npublic class LsGateway extends HttpServlet\n{\n  ...\n  private javax.xml.parsers.SAXParserFactory spf = \njavax.xml.parsers.SAXParserFactory.newInstance(); //Exception at this line\n  ...\n  public void init(ServletConfig config) throws ServletException\n  {\n    super.init(config);\n    ...\n  }\n  ...\n}\n\nHowewer, when I changed my code as follows everything works fine:\npublic class LsGateway extends HttpServlet\n{\n  ...\n  private javax.xml.parsers.SAXParserFactory spf;\n  ...\n  public void init(ServletConfig config) throws ServletException\n  {\n    super.init(config);\n    spf = javax.xml.parsers.SAXParserFactory.newInstance(); \n  }\n  ...\n}\nI'm using default, unchanged configuration, that means using XML parser \nprovided by Tomcat.", "id": 12617, "time": "2002-04-01T09:11:00Z", "bug_id": 7654, "creation_time": "2002-04-01T09:11:00Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 7654, "attachment_id": null, "id": 18633, "time": "2002-06-27T04:23:07Z", "creator": "william.barker@wilshire.com", "creation_time": "2002-06-27T04:23:07Z", "is_private": false, "text": "This is now fixed in the CVS HEAD.\n\nHowever, loading the SAXParserFactory outside of the init method may not be \nportable to other servlet containers."}]