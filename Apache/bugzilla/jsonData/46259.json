[{"count": 0, "tags": [], "creator": "axel.roeslein@googlemail.com", "attachment_id": 22909, "text": "Created attachment 22909\n\"style1\" applied to A1, \"style2\" to A2\n\nHSSFCellStyle.getUserStyleName() returns null on a document where\nMS Office or Open Office clearly show a user style applied.\n\nPOI 3.2 FINAL has the same behaviour.\n\nBiffViewer shows user style.", "id": 122710, "time": "2008-11-21T07:37:48Z", "bug_id": 46259, "creation_time": "2008-11-21T07:37:48Z", "is_private": false}, {"count": 1, "tags": [], "creator": "axel.roeslein@googlemail.com", "is_private": false, "text": "My test code:\n---\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.InputStream;\nimport java.util.Iterator;\n\nimport org.apache.poi.hssf.usermodel.HSSFCell;\nimport org.apache.poi.hssf.usermodel.HSSFCellStyle;\nimport org.apache.poi.hssf.usermodel.HSSFRow;\nimport org.apache.poi.hssf.usermodel.HSSFSheet;\nimport org.apache.poi.hssf.usermodel.HSSFWorkbook;\nimport org.apache.poi.poifs.filesystem.POIFSFileSystem;\n\n\npublic class TestUserStyle {\n    public static void main(String[] args) throws Exception {\n        \n        if (args.length == 0 || args[0] == null) {\n            System.err.println(\"no input, no output\");\n            Runtime.getRuntime().exit(1);\n        }\n            \n        File inputFile = new File(args[0]);\n        if (!inputFile.canRead())\n            throw new Exception(\"cannot read '\" + args[0] + \"'\");\n        InputStream inp = new FileInputStream(args[0]);\n        HSSFWorkbook wb = new HSSFWorkbook(new POIFSFileSystem(inp));\n        \n        HSSFSheet sheet = wb.getSheetAt(0);\n        if (sheet == null)\n            throw new Exception(\"cannot get sheet 0\");\n        \n        Iterator<?> rowIterator = sheet.rowIterator();\n        while (rowIterator.hasNext()) {\n            HSSFRow row = (HSSFRow) rowIterator.next();\n            \n            Iterator<?> cellIterator = row.cellIterator();\n            while (cellIterator.hasNext()) {\n                HSSFCell cell = (HSSFCell) cellIterator.next();\n                HSSFCellStyle cellStyle = cell.getCellStyle();\n                String userStyleName = cellStyle.getUserStyleName();\n                System.out.println(\"row \" + row.getRowNum() + \", col \" + cell.getColumnIndex());\n                if (userStyleName != null)\n                    System.out.println(\"   user style: \" + userStyleName);\n                else\n                    System.out.println(\"   no user style\");\n                    \n            }\n        }\n    }\n}\n---\n\nResult:\n\nrow 0, col 0\n   no user style\nrow 1, col 0\n   no user style\nrow 2, col 0\n   no user style\n\n", "id": 122714, "time": "2008-11-21T08:15:53Z", "bug_id": 46259, "creation_time": "2008-11-21T08:15:53Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "josh@apache.org", "is_private": false, "text": "Is it possible that you need to go one level up with 'getParentStyle()'?\n\nThe following code seems to work (I am not sure if it all makes sense though):\n\nURL url = new URL(\"https://issues.apache.org/bugzilla/attachment.cgi?id=22909\");\nHttpURLConnection hconn = (HttpURLConnection) url.openConnection();\nHSSFWorkbook wb = new HSSFWorkbook(hconn.getInputStream());\nHSSFSheet sheet = wb.getSheetAt(0);\nHSSFCellStyle cellStyleA1 = sheet.getRow(0).getCell(0).getCellStyle();\nHSSFCellStyle cellStyleA2 = sheet.getRow(1).getCell(0).getCellStyle();\nassertEquals(\"style1\", cellStyleA1.getParentStyle().getUserStyleName());\nassertEquals(\"style2\", cellStyleA2.getParentStyle().getUserStyleName());\n", "id": 122921, "time": "2008-11-28T18:12:54Z", "bug_id": 46259, "creation_time": "2008-11-28T18:12:54Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "axel.roeslein@googlemail.com", "attachment_id": null, "text": "This looks better. With user style derived from parent style I get\nthe style names I was looking for.\n\nNow the question is how to detect whether to user parent style or not.\n", "id": 122923, "time": "2008-11-28T23:41:27Z", "bug_id": 46259, "creation_time": "2008-11-28T23:41:27Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 46259, "text": "I think we will keep it this way for now as Excel is providing the information this way and POI is largely modelled around the existing format. If you want to work with user defined styles, you can use the getParentStyle() method to get at it.\n\nAdding stuff from the parentStyle in the childStyle automatically would probably cause unrelated things to break.", "count": 4, "id": 182800, "time": "2015-05-01T21:25:43Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-05-01T21:25:43Z", "is_private": false}]