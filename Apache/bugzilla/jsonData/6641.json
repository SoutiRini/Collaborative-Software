[{"attachment_id": null, "tags": [], "creator": "martin@mhengesbach.de", "text": "Hi,\n\nwhen I try to download files with MS Word (for example: \nhttps://test.iwka.de/protectedarea/test.doc) from a protected area with a MS IE \n5.5 I get the error \"the internet page could not be opened. File not found or \nnot reachable\". When I try to download it from a non protected area it works. \n\nI have a special hardware constellation:\nI have an application server with tomcat 4.0.2 with the standard HTTP 1.1 \nconnector. And there is another box wich does hardware SSL encryption.\nBecause of the SSL encryption I have defined the HTTP Connector like that:\n\n<Connector className=\"org.apache.catalina.connector.http.HttpConnector\"\nport=\"80\" minProcessors=\"1\" maxProcessors=\"200\" redirectPort=\"443\"\nscheme=\"https\" acceptCount=\"20\" debug=\"0\" secure=\"true\" proxyPort=\"443\" />\n\nSo, now to the courius things:\n- With tomcat 4.0.1 it WORKS!\n- When I try it without the SSL encryption it works\n- With an other browser (mozilla...) it works\n\nI have looked in the lock files, watched the network traffic with a network \nmonitor and so on. I see no differences but something happend with tomcat 4.0.2 \nso that it didn't work any more. Any ideas?\n\nMartin", "count": 0, "id": 11094, "time": "2002-02-22T10:49:45Z", "bug_id": 6641, "creation_time": "2002-02-22T10:49:45Z", "is_private": false}, {"count": 1, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "id": 11196, "time": "2002-02-27T05:05:07Z", "bug_id": 6641, "creation_time": "2002-02-27T05:05:07Z", "is_private": false, "text": "Unfortunately, I can't reproduce this bug. So while I'd like to fix it, I can't\ndo anything without you debugging what in the request / response something might\nbe different which would cause IE to fail."}, {"count": 2, "tags": [], "bug_id": 6641, "attachment_id": null, "id": 11202, "time": "2002-02-27T09:41:41Z", "creator": "vicentesalvador@netscape.net", "creation_time": "2002-02-27T09:41:41Z", "is_private": false, "text": "I can confirm this bug on W2000- JDK 1.4, So OS should be all"}, {"count": 3, "tags": [], "bug_id": 6641, "text": "I can't download pdf,doc,xls ... file with IE through an HTTPS+BasicAuth \nconnexion. \nIE----SSL+Basic Auth------>Apache+mod_jk------------ajp13-------->tomcat4.0.2\n\nI got an error as described in http://support.microsoft.com/default.aspx?\nscid=kb;EN-US;q196505. \n\nThis is due to HTTP cache control headers returned by tomcat. When a page is \ndownloaded with an authentication, the HTTP server set cache control headers \n(Pragma, Cache-Control, Expires) to avoid proxies to cache the page.In such \ncase, this gives something like that :\n\nHTTP/1.1 200 OK\nContent-Type: application/pdf\nContent-Length: 111219\nDate: Tue, 26 Feb 2002 16:20:32 GMT\nPragma: No-cache\nServer: Apache Tomcat/4.0.2 (HTTP/1.1 Connector)\nCache-Control: no-cache\nLast-Modified: Tue, 26 Feb 2002 16:13:27 GMT\nETag: \"111219-1014740007000\"\nExpires: Thu, 01 Jan 1970 00:00:00 GMT\n\nWhen the page is downloaded through an HTTPS connexions, those cache control \nheaders are not more needed because the document is encrypted ! Through the \nmod_jk connector (even with JkExtractSSL directive), tomcat always set cache \ncontrol headers when Authentication is done. \n\nI have done some tests with Apache. Cache control headers are not set when \nusing SSL and Authentication and I have no problem with IE to \ndownload .pdf, .doc etc ...\nSo, there might be something to correct in the Ajp13 connector...\n\nBye,\n", "id": 11203, "time": "2002-02-27T10:03:31Z", "creator": "vroyer@althes.fr", "creation_time": "2002-02-27T10:03:31Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 6641, "text": "Not only an AJP13 connector issue. I've tested this with a \"non encrypted\"\nconnection retrieving a Word document from a protected area and it Fails!!!", "count": 4, "id": 11208, "time": "2002-02-27T10:56:27Z", "creator": "vicentesalvador@netscape.net", "creation_time": "2002-02-27T10:56:27Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 6641, "attachment_id": null, "text": "Hi remy, here are the steps to reproduce the problem:\n\n1. Create a sample Word document and put it on\nexamples/jsp/security/protected/sample.doc\n2. Start catalina and get this document:\nhttp://localhost/jsp/security/protected/sample.doc\n3. Authenticate as tomcat\n4. The Open-Save dialog appears. Select open and the document opens on word OK.\n5. Change URL to http://localhost/jsp/security/protected/sample.xxx\n   The error page appears\n6. Put again the correct URL:\n   http://localhost/jsp/security/protected/sample.doc\n\nSometimes the IE thows and error and others opens the Form login as Word\ndocument. This is because catalina tries to re-authenticate the document. Here\nis the log file that demonstrates this:\n\n127.0.0.1 - - [27/Feb/2002:12:16:28 1000] \"GET\n/jsp/security/protected/sample.doc HTTP/1.1\" 404 675\n127.0.0.1 - - [27/Feb/2002:12:16:35 1000] \"GET\n/examples/jsp/security/protected/sample.doc HTTP/1.1\" 302 654\n127.0.0.1 - - [27/Feb/2002:12:16:35 1000] \"GET\n/examples/jsp/security/protected/login.jsp HTTP/1.1\" 200 611\n127.0.0.1 - - [27/Feb/2002:12:16:40 1000] \"POST\n/examples/jsp/security/protected/j_security_check HTTP/1.1\" 302 654\n127.0.0.1 - tomcat [27/Feb/2002:12:16:40 1000] \"GET\n/examples/jsp/security/protected/sample.doc HTTP/1.1\" 200 19456\n127.0.0.1 - - [27/Feb/2002:12:16:43 1000] \"OPTIONS\n/examples/jsp/security/protected HTTP/1.1\" 200 -\n127.0.0.1 - - [27/Feb/2002:12:16:43 1000] \"GET /_vti_inf.html HTTP/1.1\" 404 615\n127.0.0.1 - - [27/Feb/2002:12:16:43 1000] \"POST /_vti_bin/shtml.exe/_vti_rpc\nHTTP/1.1\" 404 657\n127.0.0.1 - - [27/Feb/2002:12:16:43 1000] \"OPTIONS\n/examples/jsp/security/protected/sample.doc HTTP/1.1\" 200 -\n127.0.0.1 - tomcat [27/Feb/2002:12:16:51 1000] \"GET\n/examples/jsp/security/protected/login.jsp HTTP/1.1\" 200 611\n127.0.0.1 - - [27/Feb/2002:12:16:51 1000] \"GET\n/jsp/security/protected/sample.doc HTTP/1.1\" 404 675\n127.0.0.1 - - [27/Feb/2002:12:16:58 1000] \"GET\n/jsp/security/protected/sample.doc HTTP/1.1\" 404 675\n127.0.0.1 - tomcat [27/Feb/2002:12:17:03 1000] \"GET\n/examples/jsp/security/protected/sample.doc HTTP/1.1\" 200 19456\n127.0.0.1 - - [27/Feb/2002:12:17:05 1000] \"OPTIONS\n/examples/jsp/security/protected HTTP/1.1\" 200 -\n127.0.0.1 - - [27/Feb/2002:12:17:05 1000] \"GET /_vti_inf.html HTTP/1.1\" 404 615\n127.0.0.1 - - [27/Feb/2002:12:17:05 1000] \"POST /_vti_bin/shtml.exe/_vti_rpc\nHTTP/1.1\" 404 657\n127.0.0.1 - - [27/Feb/2002:12:17:05 1000] \"OPTIONS\n/examples/jsp/security/protected/sample.doc HTTP/1.1\" 200 -\n127.0.0.1 - - [27/Feb/2002:12:17:05 1000] \"GET\n/examples/jsp/security/protected/sample.doc HTTP/1.1\" 302 654\n127.0.0.1 - - [27/Feb/2002:12:17:05 1000] \"GET\n/examples/jsp/security/protected/login.jsp HTTP/1.1\" 200 611\n127.0.0.1 - tomcat [27/Feb/2002:12:17:37 1000] \"GET\n/examples/jsp/security/protected/tomcat.gif HTTP/1.1\" 200 1934\n127.0.0.1 - tomcat [27/Feb/2002:12:20:37 1000] \"GET\n/examples/jsp/security/protected/tomcat.xxx HTTP/1.1\" 404 675\n127.0.0.1 - tomcat [27/Feb/2002:12:24:50 1000] \"GET\n/examples/jsp/security/protected/sample.doc HTTP/1.1\" 200 19456\n127.0.0.1 - - [27/Feb/2002:12:24:52 1000] \"OPTIONS\n/examples/jsp/security/protected HTTP/1.1\" 200 -\n127.0.0.1 - - [27/Feb/2002:12:24:52 1000] \"GET /_vti_inf.html HTTP/1.1\" 404 615\n127.0.0.1 - - [27/Feb/2002:12:24:52 1000] \"POST /_vti_bin/shtml.exe/_vti_rpc\nHTTP/1.1\" 404 657\n127.0.0.1 - - [27/Feb/2002:12:24:52 1000] \"OPTIONS\n/examples/jsp/security/protected/sample.doc HTTP/1.1\" 200 -\n127.0.0.1 - - [27/Feb/2002:12:24:52 1000] \"GET\n/examples/jsp/security/protected/sample.doc HTTP/1.1\" 302 654\n127.0.0.1 - - [27/Feb/2002:12:24:52 1000] \"GET\n/examples/jsp/security/protected/login.jsp HTTP/1.1\" 200 611", "id": 11209, "time": "2002-02-27T11:21:53Z", "creator": "vicentesalvador@netscape.net", "creation_time": "2002-02-27T11:21:53Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 6641, "attachment_id": null, "text": "Fine. I'll remove the cache control headers if the connection is secure.\nNow if somebody could explain to me how this isn't a IE bug, I would be happy (I\ndon't see the problem with setting the cache control headers, even if it's not\nuseful ...).", "id": 11226, "time": "2002-02-27T17:06:49Z", "creator": "remm@apache.org", "creation_time": "2002-02-27T17:06:49Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 6641, "text": "Fixed in both branches.", "count": 7, "id": 11235, "time": "2002-02-27T17:43:45Z", "creator": "remm@apache.org", "creation_time": "2002-02-27T17:43:45Z", "is_private": false}, {"text": "Hi again remy,\n\nAs you can see in my previous post with test case. This bug is not only for\nsecure (https) connections also occurs with standard http connections. I'seen\nthe cvs post  you've made to solve this bug and I'm not sure this will solve the\nproblem.\n\nThe problem is with authenticate contexts not with secure connections!!!. Please\ntry my sample and verify that it trully works. ", "tags": [], "bug_id": 6641, "attachment_id": null, "count": 8, "id": 11247, "time": "2002-02-27T18:50:46Z", "creator": "vicentesalvador@netscape.net", "creation_time": "2002-02-27T18:50:46Z", "is_private": false}, {"count": 9, "tags": [], "text": "Well, it's an IE bug in that case, and it won't be fixed.\nSince IE reissues the request, I don't understand why it's not handling it well\nthe second time.\nI assume upgrading to a newer IE version would fix the problem.", "attachment_id": null, "id": 11250, "creation_time": "2002-02-27T19:02:10Z", "time": "2002-02-27T19:02:10Z", "creator": "remm@apache.org", "bug_id": 6641, "is_private": false}, {"count": 10, "tags": [], "bug_id": 6641, "attachment_id": null, "text": "But 4.0.1 works fine with IE 5.5 ;-)\n\nand look at the log, it seems like the authenticated context is lost second time\nwe get the file!!!\n\nI think we should spend a little more time trying to catch this issue, because\nIE is very extended browser on the market.", "id": 11252, "time": "2002-02-27T19:28:39Z", "creator": "vicentesalvador@netscape.net", "creation_time": "2002-02-27T19:28:39Z", "is_private": false}, {"count": 11, "tags": [], "creator": "martin.hengesbach@iwka.de", "text": "I have tested it with IE 5.0, IE 5.5 SP2 and IE 6.0 The error was in every \nversion. So, it might be an IE error but I can't imagine that MS will correct \nit in the next time... AND, in tomcat 4.0.1 there wasn't the error. So the \nproblem originate from the update from tomcat 4.0.1 to 4.0.2.", "id": 11253, "time": "2002-02-27T19:31:01Z", "bug_id": 6641, "creation_time": "2002-02-27T19:31:01Z", "is_private": false, "attachment_id": null}, {"count": 12, "tags": [], "bug_id": 6641, "text": "TC 4.0.1 allowed protected resources to be cached, which is a security problem\n(any proxy between the client and the server would cache the resource, and could\nserve the resource to another client). TC 4.0.2 doesn't allow protected\nresources to be cached.\n\nAs for the \"it seems like the authenticated context is lost second time we get\nthe file!!!\": if you correctly resubmit the authentication credentials, it will\nwork. Besides, I don't see anything bad in the logs, except some MS FP junk (GET\n/_vti_inf.html HTTP/1.1).\n\nIf you have a problem, the workaround is easy: download the file to your HD, and\nopen it from there, instead of relying on the HTTP redirector IE provides\nthrough its fancy OLE 2 embedding.\n\nLastly, \"So, it might be an IE error but I can't imagine that MS will correct it\nin the next time...\" is NEVER A GOOD ARGUMENT, esp if it deals with security. If\nyou're not happy with that policy, you should use another vendor.", "id": 11254, "time": "2002-02-27T19:42:03Z", "creator": "remm@apache.org", "creation_time": "2002-02-27T19:42:03Z", "is_private": false, "attachment_id": null}, {"text": "*** Bug 8923 has been marked as a duplicate of this bug. ***", "tags": [], "bug_id": 6641, "attachment_id": null, "count": 13, "id": 15846, "time": "2002-05-09T19:40:03Z", "creator": "danrodney@hotmail.com", "creation_time": "2002-05-09T19:40:03Z", "is_private": false}]