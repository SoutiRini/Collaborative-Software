[{"count": 0, "tags": [], "creator": "rick@knowleses.org", "text": "Not sure if this is fixed in the recent versions, or even if it should be, but \nthought it should be noted somewhere. Feel free to close this as invalid, \nsince it isn't tomcat's fault. \n\nWhen being crawled by the google bot (User-Agent: Mozilla/5.0 (compatible; \nGooglebot/2.1; +http://www.google.com/bot.html)) the following exception gets \nthrown on each of the servlets I've deployed that implement the getLastModified\n() call.\n\njava.lang.IllegalArgumentException: Mon, 06 Feb 2006 17:14:33\n\tat org.apache.coyote.tomcat5.CoyoteRequest.getDateHeader\n(CoyoteRequest.java:1887)\n\tat org.apache.coyote.tomcat5.CoyoteRequestFacade.getDateHeader\n(CoyoteRequestFacade.java:426)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:691)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java:237)\n\nI'm pretty sure the error is Google's. The RFC requires a timezone to be \nappended for date headers (and more specfically a GMT timezone), which this \none doesn't have. \n\nWould it be possible to have tomcat simply throw a warning here ? It is a \nrecoverable error if we assumed the timezone was GMT if omitted, and logged as \nan invalid timestamp ? Or possibly even trapped, logged as a warning and \nassumed to be not supplied (i.e. = 1970).\n\nI understand this is probably not a tomcat bug, and I will lodge it with the \nGoogle bot support as well, but wondered whether it might not be a good \nrobustness thing to add in anyway.", "id": 85495, "attachment_id": null, "bug_id": 38546, "creation_time": "2006-02-07T04:15:03Z", "time": "2006-02-07T04:15:03Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 38546, "text": "Errr ... okay, on further inspection it looks like they are using the ANSI C \nasctime() format. From the RFC 2616 spec:\n\nHTTP applications have historically allowed three different formats\n   for the representation of date/time stamps:\n\n      Sun, 06 Nov 1994 08:49:37 GMT  ; RFC 822, updated by RFC 1123\n      Sunday, 06-Nov-94 08:49:37 GMT ; RFC 850, obsoleted by RFC 1036\n      Sun Nov  6 08:49:37 1994       ; ANSI C's asctime() format\n\n   The first format is preferred as an Internet standard and represents\n   a fixed-length subset of that defined by RFC 1123 [8] (an update to\n   RFC 822 [9]). The second format is in common use, but is based on the\n   obsolete RFC 850 [12] date format and lacks a four-digit year.\n   HTTP/1.1 clients and servers that parse the date value MUST accept\n   all three formats (for compatibility with HTTP/1.0), though they MUST\n   only generate the RFC 1123 format for representing HTTP-date values\n   in header fields. See section 19.3 for further information.\n\nAnd from section 19.3:\n\n      - If an HTTP header incorrectly carries a date value with a time\n        zone other than GMT, it MUST be converted into GMT using the\n        most conservative possible conversion.\n\n\nI expect that Google are trying to maintain HTTP/1.0 compliance, and hence the \n1.0 style date header.\n\nI guess that does make this a bug in Tomcat (or at least in the servlet api \nclasses)", "id": 85496, "time": "2006-02-07T04:43:04Z", "creator": "rick@knowleses.org", "creation_time": "2006-02-07T04:43:04Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 38546, "text": "Whoops - apologies. I misread that date format and add that second comment too \nquickly. It's a misformed RFC 822 format, which means it's Google's fault.\n\nSorry for the back and forth ... ", "id": 85497, "time": "2006-02-07T04:50:31Z", "creator": "rick@knowleses.org", "creation_time": "2006-02-07T04:50:31Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 38546, "attachment_id": null, "text": "No problem about the back and forth.  This is interesting issue, as you noted,\nso thanks for investigating it.  I hesitate to put a fix in Tomcat in order to\naddress someone else's fault, as that leads to bloat and more maintenance\noverhead.  \n\nHowever, if you submit a small patch for the relevant code to just look for an\nif-modified-since header with a missing timezone, log a warning and assume it's\nGMT, I'll be glad to review and commit it as/if relevant, assuming no objections\nfrom other committers.  So it's up to you...", "id": 87995, "time": "2006-04-13T20:47:52Z", "creator": "yoavs@computer.org", "creation_time": "2006-04-13T20:47:52Z", "is_private": false}, {"count": 4, "tags": [], "creator": "markt@apache.org", "text": "Changeing severity.", "id": 90079, "time": "2006-06-11T23:47:41Z", "bug_id": 38546, "creation_time": "2006-06-11T23:47:41Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 38546, "is_private": false, "text": "*** Bug 19921 has been marked as a duplicate of this bug. ***", "id": 129881, "time": "2009-08-24T06:29:47Z", "creator": "bodewig@apache.org", "creation_time": "2009-08-24T06:29:47Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 38546, "text": "No patch, no interest from committers so resolove as WONTFIX.", "id": 146933, "time": "2011-06-07T15:01:26Z", "creator": "markt@apache.org", "creation_time": "2011-06-07T15:01:26Z", "is_private": false, "attachment_id": null}]