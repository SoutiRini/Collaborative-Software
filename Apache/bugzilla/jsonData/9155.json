[{"count": 0, "tags": [], "bug_id": 9155, "text": "In the following method in LoggingEvent.java\n\n  public\n  void getMDCCopy() {\n    if(mdcLookupRequired) {\n      ndcLookupRequired = false;\n      // the clone call is required for asynchronous logging.\n      // See also bug #5932.\n      Hashtable t = (Hashtable) MDC.getContext();\n      if(t != null) {\n\tmdcCopy = (Hashtable) t.clone();\n      }\n    }\n  }\n\nndcLookupRequired is set to false when it should be mdcLookupRequired which is \nset to false.", "id": 16226, "time": "2002-05-16T13:22:56Z", "creator": "apache-bugs@thebap.org", "creation_time": "2002-05-16T13:22:56Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 9155, "attachment_id": null, "id": 16321, "time": "2002-05-17T10:27:40Z", "creator": "ceki@apache.org", "creation_time": "2002-05-17T10:27:40Z", "is_private": false, "text": "\nGood catch! I'll fix it immediately and will release log4j 1.2.1 afterwards. By \nthe way, did you detect this bug by reading the code or by observing at \ndeployment time? Regards, Ceki\n\nps: I'll also add a test case in order detect such silly errors as early as \npossible.\n"}, {"count": 2, "tags": [], "bug_id": 9155, "attachment_id": null, "id": 16322, "time": "2002-05-17T10:36:38Z", "creator": "apache-bugs@thebap.org", "creation_time": "2002-05-17T10:36:38Z", "is_private": false, "text": "I spotted this reading the code (or rather using find). I don't think that this \nwould actualy have an issue in a deployed system. The only issues would be if \nyou called getMDCCopy() before calling getNDC() which would then not cache the \nNDC localy. However you don't do that so it should be ok."}]