[{"count": 0, "tags": [], "bug_id": 53109, "attachment_id": 28643, "id": 158210, "time": "2012-04-20T01:44:18Z", "creator": "shun.konishi@nifty.com", "creation_time": "2012-04-20T01:44:18Z", "is_private": false, "text": "Created attachment 28643\nTestdata\n\nThe following exception has occurred when opening the file.\n\n----\n\norg.apache.poi.hssf.record.RecordInputStream$LeftoverDataException: Initialisation of record 0x894 left 10 bytes remaining still to be read.\n\tat org.apache.poi.hssf.record.RecordInputStream.hasNextRecord(RecordInputStream.java:156)\n\tat org.apache.poi.hssf.record.RecordFactoryInputStream.nextRecord(RecordFactoryInputStream.java:231)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:443)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:285)\n\tat org.apache.poi.ss.usermodel.WorkbookFactory.create(WorkbookFactory.java:88)\n\n---\nError file has following conditions.\n\n- Has named cell.\n- Named cell has comment.\n- Name of named cell or comment has multibyte characters.\n\nI fixed NameCommentRecord as follows.\n\n----\n//Constructor.  NameCommentRecord(final RecordInputStream ris)\n    if (in.readByte() == 0) {\n        field_6_name_text = StringUtil.readCompressedUnicode(in, field_4_name_length);\n    } else {\n        field_6_name_text = StringUtil.readUnicodeLE(in, field_4_name_length);\n    }\n    if (in.readByte() == 0) {\n        field_7_comment_text = StringUtil.readCompressedUnicode(in, field_5_comment_length);\n    } else {\n        field_7_comment_text = StringUtil.readUnicodeLE(in, field_5_comment_length);\n    }\n---\nSo I can read file.\nI think the serialize method have to change too.\n\nPlease check my changes.\n\nregards.\n\nShunji Konishi"}, {"count": 1, "tags": [], "bug_id": 53109, "attachment_id": null, "text": "This is finally fixed now via r1682999 by correctly reading/writing the unicode-flag of the NameCommentRecord as per the spec.", "id": 183262, "time": "2015-06-01T20:51:28Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-06-01T20:51:28Z", "is_private": false}]