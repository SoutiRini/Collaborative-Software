[{"count": 0, "tags": [], "creator": "dirk.verbeeck@pandora.be", "attachment_id": null, "id": 43093, "time": "2003-08-21T14:25:13Z", "bug_id": 22625, "creation_time": "2003-08-21T14:25:13Z", "is_private": false, "text": "Move issue from commons-dbcp to tomcat\n------------------------------------------------------------\n[dbcp] removing a webapp does not force connections closed\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=21182 \n------------------------------------------------------------\nDescription:\nas reported by Michael Holly and Tony Locke on commons-user@jakarta.apache.org\n\"removing\" a Tomcat webapp does not force connections present in DBCP pool be\nclosed.\n\nIn fact even if the webapp is unloaded and dbcp is unloaded \nthere is nobody to call BasicDataSource.close()"}, {"count": 1, "tags": [], "creator": "dirk.verbeeck@pandora.be", "text": "Mail to tomcat-dev (20/08/2003)\n--------------------------------\nHi\n\nHere at commons-dbcp we have an open issue about the datasource not being closed\nwhen the webapp context is removed.\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=21182\n\nThere is a workaround but I think it should be fixed inside the container.\nThe BasicDataSource tomcat is using has a close method but I don't think it is\ncalled.\nI've looked in the tomcat 4 source but cannot find anything related to\nclosing/shutting down resources.\n\nI would do something like this in the NamingContextListener\n   public void removeResource(String name) {\n       try {\n           Object resource = envCtx.lookup(name);\n           Method closeMethod = resource.getClass().getMethod(\"close\", null);\n           closeMethod.invoke(resource, null);\n       }\n       catch (Exception e) {\n           log(\"Cannot close resource \" + e);\n       }\n\n       try {\n           envCtx.unbind(name);\n       } catch (NamingException e) {\n           log(sm.getString(\"naming.unbindFailed\", e));\n       }\n   }\n\nMind you, I have never even compiled tomcat so maybe I'm totally looking in the\nwrong place here.\nOther solutions would be implementing a special interface or factory method or ...\n\nWe could of cource document the issue for tomcat 4 and fix it in 5.\nComments?\n\nRegards\nDirk ", "id": 43094, "time": "2003-08-21T14:27:19Z", "bug_id": 22625, "creation_time": "2003-08-21T14:27:19Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 22625, "is_private": false, "text": "See reasoning in bug 22626.", "id": 44131, "time": "2003-09-12T20:10:20Z", "creator": "medthomas@ntlworld.com", "creation_time": "2003-09-12T20:10:20Z", "attachment_id": null}]