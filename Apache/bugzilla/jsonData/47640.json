[{"count": 0, "tags": [], "creator": "camskinner@gmail.com", "attachment_id": null, "id": 129445, "time": "2009-08-04T08:41:03Z", "bug_id": 47640, "creation_time": "2009-08-04T08:41:03Z", "is_private": false, "text": "More specifically, only the most recently created target will be shown. The generated targets still exist and can be called normally, they just don't appear in the ant -p output.\n\nThe following build file demonstrates the issue:\n\n<project name=\"test\" basedir=\".\">\n  <target name=\"foo\" description=\"Foo task\"/>\n\n  <script language=\"javascript\">\n    <![CDATA[\n      importClass(org.apache.tools.ant.Target);\n      var t1 = new Target();\n      t1.setName(\"script-target-1\");\n      t1.setDescription(\"Target 1 generated from script\");\n      project.addTarget(t1);\n\n      var t2 = new Target();\n      t2.setName(\"script-target-2\");\n      t2.setDescription(\"Target 2 generated from script\");\n      project.addTarget(t2);\n    ]]>\n  </script>\n</project>\n\nThe output from ant -p is this:\n\nBuildfile: build.xml\n\nMain targets:\n\n foo              Foo task\n script-target-2  Target 2 generated from script\n\n\nant -p -v generates this:\n\nApache Ant version 1.7.1 compiled on November 10 2008\nBuildfile: build.xml\nDetected Java version: 1.6 in: /usr/lib/jvm/java-6-sun-1.6.0.14/jre\nDetected OS: Linux\nparsing buildfile /home/cam/test/build.xml with URI = file:/home/cam/test/build.xml\nProject base dir set to: /home/cam/test\n[antlib:org.apache.tools.ant] Could not load definitions from resource org/apache/tools/ant/antlib.xml. It could not be found.\n\nMain targets:\n\n foo              Foo task\n script-target-2  Target 2 generated from script\nOther targets:\n\n\n\nscript-target-1 is not appearing in the output. However, I can run that target:\n\nant script-target-1\nBuildfile: build.xml\n\nscript-target-1:\n\nBUILD SUCCESSFUL\nTotal time: 0 seconds\n\n\nCommenting out the second half of the script results in script-target-1 being displayed from ant -p."}, {"count": 1, "tags": [], "text": "Confirmed.\n\nThe problem is in Main#removeDuplicateTargets where any targets that share the\nsame location information are considered to be the same target (for the sake of\nhelping import).\n\nI'll look into tightening up the \"is longer\" check to \"is longer and ends with\nthe same name\" or something similar, but meanwhile you should be setting the\nlocation of your targets explicitly (to different locations, of course) which\nshould help you case.", "attachment_id": null, "bug_id": 47640, "id": 129835, "time": "2009-08-21T04:43:10Z", "creator": "bodewig@apache.org", "creation_time": "2009-08-21T04:43:10Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 47640, "attachment_id": null, "text": "Well, I decided to document that target locations should be unique since there are different places in Ant that might assume this.\n\nsvn revision 806523", "id": 129836, "time": "2009-08-21T05:39:16Z", "creator": "bodewig@apache.org", "creation_time": "2009-08-21T05:39:16Z", "is_private": false}]