[{"count": 0, "tags": [], "bug_id": 37244, "attachment_id": null, "id": 81734, "time": "2005-10-26T01:27:47Z", "creator": "iamroshan@gmail.com", "creation_time": "2005-10-26T01:27:47Z", "is_private": false, "text": "Hi, \n\n\n  We had recently migrated from Apache 1.3.28 (HP-UX) to Apache 1.3.33 \n(Linux) and are facing a wierd senario where in we have got bad request \nresponses in the logs at some important pages in the website. \n\n\nWhat was triaged till now: \n---------------------------- \n TCP dump was taken and studied: what I found was at the end of a HTTP \npost request coming from the client ends with 5 binary characters (this \nnumber varies) which are more than the \"Content-Length\" specified in \nthe header. Now the webserver forwards this data specified within the \ncontent length and a response is sent back as expected. The next \nrequest which comes in from the client gets the 5 extra binary \ncharacters prepended to the GET request and this causes a HTTP 400 \nresponse. These 5 binary characters show up in the access logs of \napache along with the above mentioned GET request and hex values are \nthe same. \n\nA sample selection as seen in the access logs (Note the binary values before \nthe GETs):\n==============================================================================\n160.81.118.42 - - [17/Oct/2005:01:21:37 -0500] \"GET /docroot/controlpage.jsp?\nid=pcat17014&type=page&_requestid=120816 HTTP/1.1\" 200 \n58532 \"https://secure.somesite.com/docroot/controlpage.jsp?\nid=pcat17013&type=page&_requestid=120813\" \"Mozilla/4.0 (compatible; MSIE 6.0; \nGomezAgent 2.0; Windows NT)\"\n67.84.19.77 - - [17/Oct/2005:01:22:58 -0500] \"\\xe9\\xc1\n\\xbf\\x8djGET /docroot/controlpage.jsp?id=pcat17014&type=page&_requestid=117467 \nHTTP/1.1\" 200 63330 \"https://secure.somesite.com/docroot/controlpage.jsp?\nid=pcat17013&type=page&_requestid=117417\" \"Mozilla/4.0 (compatible; MSIE 6.0; \nAOL 9.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)\"\n69.168.182.91 - - [17/Oct/2005:01:23:18 -0500] \"\\xf3\\xaf\\x86\\xc7\n\\xc7GET /docroot/controlpage.jsp?id=pcat17014&type=page&_requestid=121650 \nHTTP/1.1\" 200 62035 \"https://secure.somesite.com/docroot/controlpage.jsp?\nid=pcat17013&type=page&_requestid=121604\" \"Mozilla/4.0 (compatible; MSIE 6.0; \nWindows NT 5.1; .NET CLR 1.1.4322)\"\n172.175.206.213 - - [17/Oct/2005:01:23:48 -0500] \"\\xe3,\\xc5\n\\x9c\\xafX\\x85K,\\xe3@\\x97\\x9eU`FGET /docroot/controlpage.jsp?\nid=pcat17014&type=page&_requestid=127093 HTTP/1.1\" 200 \n61442 \"https://secure.somesite.com/docroot/controlpage.jsp?\nid=pcat17013&type=page&_requestid=126893\" \"Mozilla/4.0 (compatible; MSIE 6.0; \nAOL 9.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322)\"\n71.107.55.61 - - [17/Oct/2005:01:28:14 -0500] \"GET /docroot/controlpage.jsp?\nid=pcat17014&type=page&_requestid=117849 HTTP/1.1\" 200 \n58626 \"https://secure.somesite.com/docroot/controlpage.jsp?\nid=pcat17013&type=page&_requestid=117829\" \"Mozilla/4.0 (compatible; MSIE 6.0; \nWindows NT 5.1; SV1)\"\n198.22.123.105 - - [17/Oct/2005:01:31:36 -0500] \"GET /docroot/controlpage.jsp?\nid=pcat17014&type=page&_requestid=121593 HTTP/1.0\" 200 \n59148 \"https://secure.somesite.com/docroot/controlpage.jsp?\nid=pcat17013&type=page&_requestid=121588\" \"Mozilla/4.0 (compatible; MSIE 6.0; \nWindows NT 5.0; .NET CLR 1.1.4322)\"\n===================================================================\n\nThis behaviour is seen quite frequently in all the new (linux) webservers and \nwas not observed with the earlier Apache 1.3.28 (HP-UX). \n\n\nQuestions: \n------------ \n1. Just to confirm, is a CRLF expected after the post request? The \nrequest had a content-length of 3025 and was sent to the webserver in \nchunks of 1460, 1460 and 110 which totals to 3030 including the extra 5 \nbytes. Also would the CRLF be included in the 3025 bytes mentioned in \nthe content-length? \n\n\n2. Where do these binary values get appended to the POST request from \nthe client? Is it a bug, some kind of buffer overflow? Is it a spyware in the \nclient? or is it a possible spoofing effort? \n\n\n3. What are the obivious or possible impacts of this observed behaviour? \n\n\n4. Is there any solution for this from a configuration standpoing with \nApache 1.3.33 or will reverting back to Apache 1.3.28 on Linux help? \n\n\n5. Where do you think I should post this data to get quick resolution? \n\n\nThanks in advance, \nRoshan"}, {"count": 1, "tags": [], "bug_id": 37244, "attachment_id": null, "id": 81754, "time": "2005-10-26T09:30:04Z", "creator": "wrowe@apache.org", "creation_time": "2005-10-26T09:30:04Z", "is_private": false, "text": "Bug 37206 described something very similar... can you confirm if you are\nusing the (ATG) Dynamo connection module?\n\nIf not, which connector are you using?"}, {"count": 2, "tags": [], "creator": "nick@webthing.com", "attachment_id": null, "is_private": false, "id": 81759, "time": "2005-10-26T11:13:02Z", "bug_id": 37244, "creation_time": "2005-10-26T11:13:02Z", "text": "SSL on Apache 1.x is well known to be complex and leave a lot of scope for \nincompatibility with (other) modules.  A term to google for is EAPI.  Since \nit's been obsolete for three and a half years, usual advice is to upgrade. \n \nHave you tried disabling keepalives as a workaround? "}, {"count": 3, "tags": [], "creator": "iamroshan@gmail.com", "attachment_id": null, "is_private": false, "id": 81772, "time": "2005-10-26T16:01:35Z", "bug_id": 37244, "creation_time": "2005-10-26T16:01:35Z", "text": "(In reply to comment #1)\n> Bug 37206 described something very similar... can you confirm if you are\n> using the (ATG) Dynamo connection module?\n> If not, which connector are you using?\n\nYes a Dynamo connection module is being used its dynamo63Apache.so which came \nalong with DAS 6.3."}, {"count": 4, "tags": [], "bug_id": 37244, "text": "(In reply to comment #2)\n> SSL on Apache 1.x is well known to be complex and leave a lot of scope for \n> incompatibility with (other) modules.  A term to google for is EAPI.  Since \n> it's been obsolete for three and a half years, usual advice is to upgrade. \n>  \n> Have you tried disabling keepalives as a workaround? \n\nThis issue is observed only after the migration from 1.3.28 to 1.3.33, and the \nSSL is not handled by apache but taken care by SSL h/w accelerators.", "id": 81773, "time": "2005-10-26T16:04:55Z", "creator": "iamroshan@gmail.com", "creation_time": "2005-10-26T16:04:55Z", "is_private": false, "attachment_id": null}, {"text": "(In reply to comment #4)\n> (In reply to comment #2)\n> > SSL on Apache 1.x is well known to be complex and leave a lot of scope for \n> > incompatibility with (other) modules.  A term to google for is EAPI.  \nSince \n> > it's been obsolete for three and a half years, usual advice is to upgrade. \n> >  \n> > Have you tried disabling keepalives as a workaround? \n> This issue is observed only after the migration from 1.3.28 to 1.3.33, and \nthe \n> SSL is not handled by apache but taken care by SSL h/w accelerators.\n\nThanks for your suggestion. This issue does not show up on the dev \nenvironments, hence keepalives was ruled out as a solution. I would like to \nunderstand the problem in greater detail before any action is taken.\n", "tags": [], "bug_id": 37244, "attachment_id": null, "count": 5, "id": 81774, "time": "2005-10-26T16:24:39Z", "creator": "iamroshan@gmail.com", "creation_time": "2005-10-26T16:24:39Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 37244, "attachment_id": null, "id": 81777, "time": "2005-10-26T17:25:12Z", "creator": "wrowe@apache.org", "creation_time": "2005-10-26T17:25:12Z", "is_private": false, "text": "\n  Please contact your module vendor for the appropriate version to plug\n  into Apache 1.3.33.\n\n*** This bug has been marked as a duplicate of 37206 ***"}, {"count": 7, "attachment_id": null, "bug_id": 37244, "text": "Just to let you guys know that there was a workaround which resolved the \nproblem. It was to set the keepAlives in the secure webserver to \"off\". We have \nnot seen the problem since then.", "id": 93536, "time": "2006-09-13T18:59:14Z", "creator": "iamroshan@gmail.com", "creation_time": "2006-09-13T18:59:14Z", "tags": [], "is_private": false}]