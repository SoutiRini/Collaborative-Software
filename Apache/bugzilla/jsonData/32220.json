[{"count": 0, "tags": [], "creator": "warp-9.9@usa.net", "attachment_id": null, "text": "The suexec actual_gname is incorrectly reported as a numeric id and not as an\nalphanumeric group name.\n\nPlease forgive me if this is too much information or not enough.  ;-)  This\nwould seem to be fairly cosmetic, but leaves much less confusing log files IMO.\n Also, I have made minor changes to one file, a \"diff -u\" patch, and tested, and\nit seems to work.  As always, use the \"-b\" (backup) option.  Apply one directory\nup from httpd-2.0.52 main source tree with -p0, or in httpd-2.0.52/support with\n-p2.  Just a disclaimer: I may not be aware if I did something unwise, but it\nwould seem very hard to screw this up.\n\n\nUnpatched (log):\n\n==> /usr/local/apache2/logs/suexec_log <==\n[2004-11-13 00:50:26]: uid: (1001/apache) gid: (1001/1001) cmd: id.sh\n\nPatched (log):\n\n==> /usr/local/apache2/logs/suexec_log <==\n[2004-11-13 00:36:54]: uid: (1001/apache) gid: (1001/apache) cmd: id.sh\n\n\nPatch (unified diff):\n\n/usr/local/src/apache/httpd -> diff -u\nhttpd-2.0.52/support/suexec.c.2004-11-13_LMW httpd-2.0.52/support/suexec.c\n\n--- httpd-2.0.52/support/suexec.c.2004-11-13_LMW        2004-08-23 11:07:18.0000\n00000 -0400\n+++ httpd-2.0.52/support/suexec.c       2004-11-13 00:25:49.000000000 -0500\n@@ -377,14 +377,17 @@\n             log_err(\"invalid target group name: (%s)\\n\", target_gname);\n             exit(106);\n         }\n-        gid = gr->gr_gid;\n-        actual_gname = strdup(gr->gr_name);\n     }\n     else {\n-        gid = atoi(target_gname);\n-        actual_gname = strdup(target_gname);\n+        if ((gr = getgrgid(atoi(target_gname))) == NULL) {\n+            log_err(\"invalid target group id: (%s)\\n\", target_gname);\n+            exit(106);\n+        }\n     }\n\n+    gid = gr->gr_gid;\n+    actual_gname = strdup(gr->gr_name);\n+\n #ifdef _OSD_POSIX\n     /*\n      * Initialize BS2000 user environment\n\n\nUnpatched (src):\n\n    /*\n     * Error out if the target group name is invalid.\n     */\n    if (strspn(target_gname, \"1234567890\") != strlen(target_gname)) {\n        if ((gr = getgrnam(target_gname)) == NULL) {\n            log_err(\"invalid target group name: (%s)\\n\", target_gname);\n            exit(106);\n        }\n        gid = gr->gr_gid;\n        actual_gname = strdup(gr->gr_name);\n    }\n    else {\n        gid = atoi(target_gname);\n        actual_gname = strdup(target_gname);\n    }\n\nPatched (src):\n\n    /*\n     * Error out if the target group name is invalid.\n     */\n    if (strspn(target_gname, \"1234567890\") != strlen(target_gname)) {\n        if ((gr = getgrnam(target_gname)) == NULL) {\n            log_err(\"invalid target group name: (%s)\\n\", target_gname);\n            exit(106);\n        }\n    }\n    else {\n        if ((gr = getgrgid(atoi(target_gname))) == NULL) {\n            log_err(\"invalid target group id: (%s)\\n\", target_gname);\n            exit(106);\n        }\n    }\n\n    gid = gr->gr_gid;\n    actual_gname = strdup(gr->gr_name);", "id": 66834, "time": "2004-11-13T06:39:27Z", "bug_id": 32220, "creation_time": "2004-11-13T06:39:27Z", "is_private": false}, {"text": "Also, although I have only observed and tested this issue with the 2.0.52 code\non the PC platform with a Linux operating system, the (cosmetic) bug may affect\nearlier versions, and the code in question would appear to be applicable to all\nplatforms and all operating systems.  I ask someone else with more experience to\nconfirm this, and update the bug report if need be.", "tags": [], "bug_id": 32220, "is_private": false, "count": 1, "id": 66835, "time": "2004-11-13T07:07:56Z", "creator": "warp-9.9@usa.net", "creation_time": "2004-11-13T07:07:56Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "jorton@redhat.com", "attachment_id": null, "is_private": false, "id": 66836, "time": "2004-11-13T07:48:58Z", "bug_id": 32220, "creation_time": "2004-11-13T07:48:58Z", "text": "\n\n*** This bug has been marked as a duplicate of 7862 ***"}]