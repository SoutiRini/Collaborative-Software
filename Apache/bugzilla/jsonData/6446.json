[{"count": 0, "attachment_id": null, "bug_id": 6446, "text": "In a web application with two security constraints with different sets of\nrequired roles, all access attempts to the second one are denied (403)\nafter successful authetication to the first.\n\nExample:\n\n  <security-constraint>\n    <web-resource-collection>\n      <web-resource-name>search</web-resource-name>\n      <url-pattern>/ch12/search/*</url-pattern>\n    </web-resource-collection>\n    <auth-constraint>\n      <role-name>admin</role-name>\n      <role-name>user</role-name>\n    </auth-constraint>\n  </security-constraint>\n\n  <security-constraint>\n    <web-resource-collection>\n      <web-resource-name>admin</web-resource-name>\n      <url-pattern>/ch12/admin/*</url-pattern>\n    </web-resource-collection>\n    <auth-constraint>\n      <role-name>admin</role-name>\n    </auth-constraint>\n  </security-constraint>\n\nAfter accessing resources protected by the \"search\" constraint as a user in \nthe role \"user\", all attempts to access resources protected by the \"admin\"\nconstraint are denied. Previous versions of Tomcat (at least TC 3.x) issued\na new challenge response in this case, which IMHO is a more accurate behavior.", "id": 10670, "time": "2002-02-14T00:27:50Z", "creator": "hans@gefionsoftware.com", "creation_time": "2002-02-14T00:27:50Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 6446, "is_private": false, "text": "\"Accurate\" it may or may not be, but it's not correct :->\n\nThe lifetime of an authentication is dependent on the login method used.  For \nexample, for form-based login you are authenticated through the duration of the \ncurrent session.  Therefore, a 403 is the right answer -- if the user should be \nable to access both sets of protected resources, he or she should be granted \nboth roles in the first place.\n\nJSR 115 or 154 may or may not change this for the future (although I doubt it \nfrom the discussions so far).\n", "id": 10674, "time": "2002-02-14T04:34:10Z", "creator": "craig.mcclanahan@sun.com", "creation_time": "2002-02-14T04:34:10Z", "attachment_id": null}]