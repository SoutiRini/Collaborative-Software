[{"count": 0, "tags": [], "bug_id": 52032, "text": "Created attachment 27776\nPatch of files to get AIOOB stack trace out\n\nI have a collection of files that when being processed via Tika will encounter a RuntimeException stemming from a ArrayIndexOutofBoundsException with no stack trace or Cause information.  The root AIOOB issue was fixed for many of these files in the daily build after the 3.8-b4 release, but was re-introduced by the HWPF rework done in revision 1178083. (The files are successful with revision 1178063)\n\nThe files that produce this error are confirmed as valid with the MS's bffvalidator utility.  Due to the sensitive nature of their contents, I'm not able to include them as examples.  I may be able to get a coworker to help me hex-edit out the sensitive info so that I can include them at a later point to help fix the root issue causing the AIOOB.\n\nIn the meantime , I was able to pinpoint the location where the mysterious AIOOB exception was spawning from.  It is originating out of ListLevel() when performing a LittleEndian.getShort().\n\nThe patch I've included does two things:\n  * Logs a warning message when the buffers bounds are about to be over blown.\n  * Catches and rethrows the AIOOB exception from the getShort() call as a RuntimeException,  so that additional stack trace information is available. (At least it is now visible in Tika)\n\nThe patch should help highlight future documents that encounter this problem and at least make it easier with tracking down and making the fix to get them to work in the future.", "id": 150584, "time": "2011-10-14T18:58:33Z", "creator": "rpi_alum@yahoo.com", "creation_time": "2011-10-14T18:58:33Z", "is_private": false, "attachment_id": 27776}, {"count": 1, "tags": [], "bug_id": 52032, "attachment_id": 27806, "text": "Created attachment 27806\nHex-edited Sample test file to blow AIOOB #1\n\nTest case file 1...  Hexedited original to remove sensitive information. Post hex-editing first attempt produced stack trace, subsequent runs did not.  This file worked with revision 1178063", "id": 150721, "time": "2011-10-18T18:33:02Z", "creator": "rpi_alum@yahoo.com", "creation_time": "2011-10-18T18:33:02Z", "is_private": false}, {"attachment_id": 27807, "tags": [], "bug_id": 52032, "is_private": false, "count": 2, "id": 150722, "time": "2011-10-18T18:33:50Z", "creator": "rpi_alum@yahoo.com", "creation_time": "2011-10-18T18:33:50Z", "text": "Created attachment 27807\nHex-edited Sample test file to blow AIOOB #2\n\nTest case file 2...  Hexedited original to remove sensitive information.  This file worked with revision 1178063"}, {"count": 3, "tags": [], "bug_id": 52032, "attachment_id": 27808, "text": "Created attachment 27808\nHex-edited Sample test file to blow AIOOB #3\n\nTest case file 3...  Hexedited original to remove sensitive information. Post hex-editing first attempt produced stack trace, subsequent runs did not.  This file worked with revision 1178063", "id": 150723, "time": "2011-10-18T18:34:17Z", "creator": "rpi_alum@yahoo.com", "creation_time": "2011-10-18T18:34:17Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 52032, "is_private": false, "id": 151035, "creation_time": "2011-10-29T23:58:51Z", "time": "2011-10-29T23:58:51Z", "creator": "vlsergey@gmail.com", "text": "shall be fixed in revision 1195077\nPlease, check.", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 52032, "attachment_id": null, "id": 151265, "creation_time": "2011-11-07T13:43:49Z", "time": "2011-11-07T13:43:49Z", "creator": "rpi_alum@yahoo.com", "text": "Fix appears to have resolved issue for 90% of files.  Will try to get examples of the remaining cases and open a new bug if those files are valid and still failing.\n\nThanks for the fix!!", "is_private": false}]