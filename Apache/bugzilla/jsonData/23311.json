[{"count": 0, "tags": [], "bug_id": 23311, "attachment_id": null, "text": "First of all, I want to apologies if there is a well known fix to my problem :P\n\nEnviroment:\nPII 333Mhz\n128M RAM + 256M swap\nRedhat 9.0 (Linux version 2.4.20-20.9)\njakarta-tomcat-4.1.27-LE-jdk14\nJRE build 1.4.2-b28\n\nI can't get tomcat (standalone) to run stably. My site (with fairly low \ntraffic) hangs after 7-14 days. When it hangs, I can still connect a browser to \nit, but the client just sits and waits forever. I have to kill and restart \ntomcat when this occures :(\n\nI've checked with 'netstat'. It appears that all connections to tomcat is in \nthe 'CLOSE_WAIT' state. They disappear when tomcat is killed.\n\nI've been searching almost two days without finding any usefull result.\n\nI refuse to believe that my Win95/tomcat config is more stable (about 1-2 \nmonths of uptime) than a linux/tomcat config. (well, I don't have to reboot the \ncomputer, but that's a minor comfort)\n\nIs my problem related to bug #14994 in any way?", "id": 44415, "time": "2003-09-21T21:49:58Z", "creator": "melvng@hotmail.com", "creation_time": "2003-09-21T21:49:58Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 23311, "attachment_id": null, "is_private": false, "id": 44417, "time": "2003-09-21T23:51:19Z", "creator": "william.barker@wilshire.com", "creation_time": "2003-09-21T23:51:19Z", "text": "From what I've seen so far, it looks identical to 14994.  For now, I'm giving \nyou the benefit of the doubt (and not marking this a duplicate).\n\nHowever, to get any farther, we'll need more information.  One thing that would \nbe particularly helpful is to attach a thread-dump (since you are on Linux, you \nwould get this by doing a \"kill -3 pid-of-tomcat\", where pid-of-tomcat is \ndetermined by doing a \"ps -ef\").  Other things of interest are unusual entries \nin your log files (with especial attention to IllegalStateExceptions), whether \nor not \"netstat -a\" shows anyone LISTENing on the port, etc.\n\nYou might also want to check out Bug #21763."}, {"count": 2, "tags": [], "bug_id": 23311, "text": "Ok, I'll make a thread-dump and watch the logs next time it hangs.\n\nActually, I've been running the new ThreadPool code for a couple of days now\n(fetched and compiled sources for 'org\\apache\\tomcat\\util\\threads' package from \nthe CVS on the 15.09.03).\n\nI'll post wether or not tomcat runs stably for ~3 weeks.\n\nThanks for your info.", "id": 44437, "time": "2003-09-22T11:10:40Z", "creator": "melvng@hotmail.com", "creation_time": "2003-09-22T11:10:40Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 23311, "attachment_id": null, "text": "Tomcat has just hanged after 10 days. I've taken netstat & threaddump in 2 \nsteps:\n1) at the time after hang...\n2) ...then connect a browser and check again with netstat & threaddump.\n\nStarting tomcat _(no -Xms/-Xmx options)_, a snippet from 'ps -efHl':\njava -Djava.awt.headless=true -Djava.endorsed.dirs=/usr/tomcat/common/endorsed -\nclasspath /usr/java/j2sdk1.4.2/lib/tools.jar:/usr/tomcat/bin/bootstrap.jar -\nDcatalina.base=/usr/tomcat -Dcatalina.home=/usr/tomcat -Dja\n\nBEFORE CONNECTING A CLIENT\n--------------------------\n\n[root@mimmi root]# netstat -a\nActive Internet connections (servers and established)\nProto Recv-Q Send-Q Local Address           Foreign Address         State\ntcp        0      0 *:1024                  *:*                     LISTEN\ntcp        0      0 mimmi.localdomain:1025  *:*                     LISTEN\ntcp        0      0 mimmi.localdomain:8005  *:*                     LISTEN\ntcp        0      0 *:8009                  *:*                     LISTEN\ntcp        0      0 *:netbios-ssn           *:*                     LISTEN\ntcp        0      0 *:sunrpc                *:*                     LISTEN\ntcp        0      0 *:http                  *:*                     LISTEN\ntcp        0      0 *:x11                   *:*                     LISTEN\ntcp        0      0 *:ssh                   *:*                     LISTEN\ntcp        0      0 *:ipp                   *:*                     LISTEN\ntcp        0      0 10.0.0.6:ssh            10.0.0.9:1115           ESTABLISHED\ntcp      298      0 10.0.0.6:http           ses.grsc.k12.ar.u:57445 ESTABLISHED\ntcp        0      0 10.0.0.6:http           11.80-203-235.nex:49333 ESTABLISHED\ntcp        0      0 10.0.0.6:netbios-ssn    10.0.0.9:1031           ESTABLISHED\ntcp        1      0 mimmi.localdomain:1134  mimmi.localdomain:mysql CLOSE_WAIT\ntcp      380      0 10.0.0.6:http           11.80-203-235.nex:57746 ESTABLISHED\nudp        0      0 *:1024                  *:*\nudp        0      0 10.0.0.6:netbios-ns     *:*\nudp        0      0 *:netbios-ns            *:*\nudp        0      0 10.0.0.6:netbios-dgm    *:*\nudp        0      0 *:netbios-dgm           *:*\nudp        0      0 mimmi.localdomain:1040  *:*\nudp        0      0 *:918                   *:*\nudp        0      0 *:bootpc                *:*\nudp        0      0 *:sunrpc                *:*\nudp        0      0 *:631                   *:*\nActive UNIX domain sockets (servers and established)\nProto RefCnt Flags       Type       State         I-Node Path\nunix  2      [ ACC ]     STREAM     LISTENING     2155   /dev/gpmctl\nunix  2      [ ACC ]     STREAM     LISTENING     2499   /tmp/.gdm_socket\nunix  9      [ ]         DGRAM                    1638   /dev/log\nunix  2      [ ACC ]     STREAM     LISTENING     2348   /tmp/.font-unix/fs7100\nunix  2      [ ACC ]     STREAM     LISTENING     2163   /tmp/.iroha_unix/IROHA\nunix  2      [ ACC ]     STREAM     LISTENING     2512   /tmp/.X11-unix/X0\nunix  3      [ ]         STREAM     CONNECTED     2559   /tmp/.X11-unix/X0\nunix  3      [ ]         STREAM     CONNECTED     2558\nunix  3      [ ]         STREAM     CONNECTED     2554   /tmp/.X11-unix/X0\nunix  3      [ ]         STREAM     CONNECTED     2553\nunix  3      [ ]         STREAM     CONNECTED     2537   /tmp/.font-unix/fs7100\nunix  3      [ ]         STREAM     CONNECTED     2536\nunix  3      [ ]         STREAM     CONNECTED     2539   /tmp/.X11-unix/X0\nunix  3      [ ]         STREAM     CONNECTED     2515\nunix  2      [ ]         DGRAM                    2435\nunix  2      [ ]         DGRAM                    2359\nunix  2      [ ]         DGRAM                    2188\nunix  2      [ ]         DGRAM                    2120\nunix  2      [ ]         DGRAM                    1859\nunix  2      [ ]         DGRAM                    1699\nunix  2      [ ]         DGRAM                    1649\n\nThread dump\n-----------\nFull thread dump Java HotSpot(TM) Client VM (1.4.2-b28 mixed mode):\n\n\"TP-Processor16\" daemon prio=1 tid=0x08488560 nid=0x707 in Object.wait() \n[4f014000..4f014714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x45510990> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Object.wait(Object.java:429)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:644)\n\t- locked <0x45510990> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"TP-Processor15\" daemon prio=1 tid=0x084879a8 nid=0x707 in Object.wait() \n[4ef93000..4ef93714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x45510a10> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Object.wait(Object.java:429)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:644)\n\t- locked <0x45510a10> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"TP-Processor14\" daemon prio=1 tid=0x08486df0 nid=0x707 in Object.wait() \n[4ef12000..4ef12714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x45510a90> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Object.wait(Object.java:429)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:644)\n\t- locked <0x45510a90> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"TP-Processor13\" daemon prio=1 tid=0x08486ad0 nid=0x707 in Object.wait() \n[4ee91000..4ee91714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x45510b10> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Object.wait(Object.java:429)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:644)\n\t- locked <0x45510b10> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"TP-Processor12\" daemon prio=1 tid=0x08482af8 nid=0x707 in Object.wait() \n[4ee10000..4ee10714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x4536c508> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Object.wait(Object.java:429)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:644)\n\t- locked <0x4536c508> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"TP-Processor11\" daemon prio=1 tid=0x08481f40 nid=0x707 in Object.wait() \n[4ed8f000..4ed8f714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x4536c588> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Object.wait(Object.java:429)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:644)\n\t- locked <0x4536c588> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"TP-Processor10\" daemon prio=1 tid=0x08481248 nid=0x707 in Object.wait() \n[4ed0e000..4ed0e714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x4536c608> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Object.wait(Object.java:429)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:644)\n\t- locked <0x4536c608> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"TP-Processor9\" daemon prio=1 tid=0x080aeb88 nid=0x707 in Object.wait() \n[4ec8d000..4ec8d714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x4536c688> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Object.wait(Object.java:429)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:644)\n\t- locked <0x4536c688> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"TP-Processor8\" daemon prio=1 tid=0x080adc70 nid=0x707 in Object.wait() \n[4ec0c000..4ec0c714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x45275708> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Object.wait(Object.java:429)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:644)\n\t- locked <0x45275708> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"TP-Processor7\" daemon prio=1 tid=0x080b0758 nid=0x707 in Object.wait() \n[4eb8b000..4eb8b714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x45275788> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Object.wait(Object.java:429)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:644)\n\t- locked <0x45275788> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"TP-Processor6\" daemon prio=1 tid=0x080b05e0 nid=0x707 in Object.wait() \n[4eb0a000..4eb0a714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x45275808> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Object.wait(Object.java:429)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:644)\n\t- locked <0x45275808> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"TP-Processor5\" daemon prio=1 tid=0x080b0260 nid=0x707 in Object.wait() \n[4ea89000..4ea89714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x45275888> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Object.wait(Object.java:429)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:644)\n\t- locked <0x45275888> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"Java2D Disposer\" daemon prio=1 tid=0x0848c7b0 nid=0x707 in Object.wait() \n[4ea08000..4ea08714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x4511a000> (a java.lang.ref.ReferenceQueue$Lock)\n\tat java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:111)\n\t- locked <0x4511a000> (a java.lang.ref.ReferenceQueue$Lock)\n\tat java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:127)\n\tat sun.java2d.Disposer.run(Disposer.java:100)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"TP-Monitor\" daemon prio=1 tid=0x0841d880 nid=0x707 in Object.wait() \n[4e987000..4e987714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x44facc70> (a \norg.apache.tomcat.util.threads.ThreadPool$MonitorRunnable)\n\tat org.apache.tomcat.util.threads.ThreadPool$MonitorRunnable.run\n(ThreadPool.java:551)\n\t- locked <0x44facc70> (a \norg.apache.tomcat.util.threads.ThreadPool$MonitorRunnable)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"TP-Processor4\" daemon prio=1 tid=0x0841cce0 nid=0x707 runnable \n[4e906000..4e906714]\n\tat java.net.PlainSocketImpl.socketAccept(Native Method)\n\tat java.net.PlainSocketImpl.accept(PlainSocketImpl.java:353)\n\t- locked <0x44fc6b70> (a java.net.PlainSocketImpl)\n\tat java.net.ServerSocket.implAccept(ServerSocket.java:448)\n\tat java.net.ServerSocket.accept(ServerSocket.java:419)\n\tat org.apache.jk.common.ChannelSocket.accept(ChannelSocket.java:268)\n\tat org.apache.jk.common.ChannelSocket.acceptConnections\n(ChannelSocket.java:531)\n\tat org.apache.jk.common.SocketAcceptor.runIt(ChannelSocket.java:660)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:668)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"TP-Processor3\" daemon prio=1 tid=0x08416868 nid=0x707 in Object.wait() \n[4e885000..4e885714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x44facd68> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Object.wait(Object.java:429)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:644)\n\t- locked <0x44facd68> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"TP-Processor2\" daemon prio=1 tid=0x08415d50 nid=0x707 in Object.wait() \n[4e804000..4e804714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x44facde8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Object.wait(Object.java:429)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:644)\n\t- locked <0x44facde8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"TP-Processor1\" daemon prio=1 tid=0x084159d8 nid=0x707 in Object.wait() \n[4e783000..4e783714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x44face68> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Object.wait(Object.java:429)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:644)\n\t- locked <0x44face68> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"TP-Monitor\" daemon prio=1 tid=0x084177c8 nid=0x707 in Object.wait() \n[4e702000..4e702714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x44faced0> (a \norg.apache.tomcat.util.threads.ThreadPool$MonitorRunnable)\n\tat org.apache.tomcat.util.threads.ThreadPool$MonitorRunnable.run\n(ThreadPool.java:551)\n\t- locked <0x44faced0> (a \norg.apache.tomcat.util.threads.ThreadPool$MonitorRunnable)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"TP-Processor4\" daemon prio=1 tid=0x084131d8 nid=0x707 in Object.wait() \n[4e681000..4e681714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x44facf88> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Object.wait(Object.java:429)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:644)\n\t- locked <0x44facf88> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"TP-Processor3\" daemon prio=1 tid=0x08412620 nid=0x707 in Object.wait() \n[4e600000..4e600714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x44fad008> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Object.wait(Object.java:429)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:644)\n\t- locked <0x44fad008> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"TP-Processor2\" daemon prio=1 tid=0x08411a80 nid=0x707 in Object.wait() \n[4e57f000..4e57f714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x44fad088> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Object.wait(Object.java:429)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:644)\n\t- locked <0x44fad088> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"TP-Processor1\" daemon prio=1 tid=0x08411120 nid=0x707 in Object.wait() \n[4e4fe000..4e4fe714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x44fad108> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Object.wait(Object.java:429)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:644)\n\t- locked <0x44fad108> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"HostConfig[localhost]\" daemon prio=1 tid=0x080d44b0 nid=0x707 waiting on \ncondition [4e47d000..4e47d714]\n\tat java.lang.Thread.sleep(Native Method)\n\tat org.apache.catalina.startup.HostConfig.threadSleep\n(HostConfig.java:824)\n\tat org.apache.catalina.startup.HostConfig.run(HostConfig.java:848)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"StandardManager[/ROOT.old]\" daemon prio=1 tid=0x080d4170 nid=0x707 waiting on \ncondition [4e3fc000..4e3fc714]\n\tat java.lang.Thread.sleep(Native Method)\n\tat org.apache.catalina.session.StandardManager.threadSleep\n(StandardManager.java:810)\n\tat org.apache.catalina.session.StandardManager.run\n(StandardManager.java:869)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"StandardManager[/webdav]\" daemon prio=1 tid=0x080d2a28 nid=0x707 waiting on \ncondition [4e37b000..4e37b714]\n\tat java.lang.Thread.sleep(Native Method)\n\tat org.apache.catalina.session.StandardManager.threadSleep\n(StandardManager.java:810)\n\tat org.apache.catalina.session.StandardManager.run\n(StandardManager.java:869)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"StandardManager[/tomcat-docs]\" daemon prio=1 tid=0x084a6d88 nid=0x707 waiting \non condition [4e08a000..4e08a714]\n\tat java.lang.Thread.sleep(Native Method)\n\tat org.apache.catalina.session.StandardManager.threadSleep\n(StandardManager.java:810)\n\tat org.apache.catalina.session.StandardManager.run\n(StandardManager.java:869)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"StandardManager[/manager]\" daemon prio=1 tid=0x08407fd0 nid=0x707 waiting on \ncondition [4e009000..4e009714]\n\tat java.lang.Thread.sleep(Native Method)\n\tat org.apache.catalina.session.StandardManager.threadSleep\n(StandardManager.java:810)\n\tat org.apache.catalina.session.StandardManager.run\n(StandardManager.java:869)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"StandardManager[/admin]\" daemon prio=1 tid=0x0838ffa0 nid=0x707 waiting on \ncondition [4e280000..4e280714]\n\tat java.lang.Thread.sleep(Native Method)\n\tat org.apache.catalina.session.StandardManager.threadSleep\n(StandardManager.java:810)\n\tat org.apache.catalina.session.StandardManager.run\n(StandardManager.java:869)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"Thread-2\" prio=1 tid=0x083ebbe0 nid=0x707 waiting on condition \n[4e10b000..4e10b714]\n\tat java.lang.Thread.sleep(Native Method)\n\tat mysite.CounterServlet$SaveThread.run(CounterServlet.java:372)\n\n\"StandardManager[]\" daemon prio=1 tid=0x080f9128 nid=0x707 waiting on condition \n[4d9fa000..4d9fa714]\n\tat java.lang.Thread.sleep(Native Method)\n\tat org.apache.catalina.session.StandardManager.threadSleep\n(StandardManager.java:810)\n\tat org.apache.catalina.session.StandardManager.run\n(StandardManager.java:869)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"WebappLoader[]\" daemon prio=1 tid=0x080c7e80 nid=0x707 waiting on condition \n[4d8e1000..4d8e1714]\n\tat java.lang.Thread.sleep(Native Method)\n\tat org.apache.catalina.loader.WebappLoader.threadSleep\n(WebappLoader.java:1208)\n\tat org.apache.catalina.loader.WebappLoader.run(WebappLoader.java:1328)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"StandardManager[/examples]\" daemon prio=1 tid=0x08161048 nid=0x707 waiting on \ncondition [4d74b000..4d74b714]\n\tat java.lang.Thread.sleep(Native Method)\n\tat org.apache.catalina.session.StandardManager.threadSleep\n(StandardManager.java:810)\n\tat org.apache.catalina.session.StandardManager.run\n(StandardManager.java:869)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"WebappLoader[/examples]\" daemon prio=1 tid=0x083b35d8 nid=0x707 waiting on \ncondition [4d6ca000..4d6ca714]\n\tat java.lang.Thread.sleep(Native Method)\n\tat org.apache.catalina.loader.WebappLoader.threadSleep\n(WebappLoader.java:1208)\n\tat org.apache.catalina.loader.WebappLoader.run(WebappLoader.java:1328)\n\tat java.lang.Thread.run(Thread.java:534)\n\n\"Signal Dispatcher\" daemon prio=1 tid=0x0809d1c0 nid=0x707 waiting on condition \n[0..0]\n\n\"Finalizer\" daemon prio=1 tid=0x08089488 nid=0x707 in Object.wait() \n[4c912000..4c912714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x44bf9ec0> (a java.lang.ref.ReferenceQueue$Lock)\n\tat java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:111)\n\t- locked <0x44bf9ec0> (a java.lang.ref.ReferenceQueue$Lock)\n\tat java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:127)\n\tat java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:159)\n\n\"Reference Handler\" daemon prio=1 tid=0x08087a10 nid=0x707 in Object.wait() \n[4c891000..4c891714]\n\tat java.lang.Object.wait(Native Method)\n\t- waiting on <0x44bf9f28> (a java.lang.ref.Reference$Lock)\n\tat java.lang.Object.wait(Object.java:429)\n\tat java.lang.ref.Reference$ReferenceHandler.run(Reference.java:115)\n\t- locked <0x44bf9f28> (a java.lang.ref.Reference$Lock)\n\n\"main\" prio=1 tid=0x080522e8 nid=0x707 runnable [bfffd000..bfffd908]\n\tat java.net.PlainSocketImpl.socketAccept(Native Method)\n\tat java.net.PlainSocketImpl.accept(PlainSocketImpl.java:353)\n\t- locked <0x44fad1c8> (a java.net.PlainSocketImpl)\n\tat java.net.ServerSocket.implAccept(ServerSocket.java:448)\n\tat java.net.ServerSocket.accept(ServerSocket.java:419)\n\tat org.apache.catalina.core.StandardServer.await\n(StandardServer.java:527)\n\tat org.apache.catalina.startup.Catalina.start(Catalina.java:521)\n\tat org.apache.catalina.startup.Catalina.execute(Catalina.java:400)\n\tat org.apache.catalina.startup.Catalina.process(Catalina.java:180)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke\n(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:324)\n\tat org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:203)\n\n\"VM Thread\" prio=1 tid=0x08086710 nid=0x707 runnable \n\n\"VM Periodic Task Thread\" prio=1 tid=0x0809f9c8 nid=0x707 waiting on condition \n\"Suspend Checker Thread\" prio=1 tid=0x0809c7d8 nid=0x707 runnable \n\nAFTER CONNECTING A CLIENT, IE 6, (11.80-203-235.nex:49388)\n----------------------------------------------------------\n\n[root@mimmi root]# netstat -a\nActive Internet connections (servers and established)\nProto Recv-Q Send-Q Local Address           Foreign Address         State\ntcp        0      0 *:1024                  *:*                     LISTEN\ntcp        0      0 mimmi.localdomain:1025  *:*                     LISTEN\ntcp        0      0 mimmi.localdomain:8005  *:*                     LISTEN\ntcp        0      0 *:8009                  *:*                     LISTEN\ntcp        0      0 *:netbios-ssn           *:*                     LISTEN\ntcp        0      0 *:sunrpc                *:*                     LISTEN\ntcp        0      0 *:http                  *:*                     LISTEN\ntcp        0      0 *:x11                   *:*                     LISTEN\ntcp        0      0 *:ssh                   *:*                     LISTEN\ntcp        0      0 *:ipp                   *:*                     LISTEN\ntcp      380      0 10.0.0.6:http           11.80-203-235.nex:49388 ESTABLISHED\ntcp        0     20 10.0.0.6:ssh            10.0.0.9:1115           ESTABLISHED\ntcp      298      0 10.0.0.6:http           ses.grsc.k12.ar.u:57445 ESTABLISHED\ntcp        0      0 10.0.0.6:http           11.80-203-235.nex:49333 ESTABLISHED\ntcp        0      0 10.0.0.6:netbios-ssn    10.0.0.9:1031           ESTABLISHED\ntcp        1      0 mimmi.localdomain:1134  mimmi.localdomain:mysql CLOSE_WAIT\ntcp      380      0 10.0.0.6:http           11.80-203-235.nex:57746 ESTABLISHED\nudp        0      0 *:1024                  *:*\nudp        0      0 10.0.0.6:netbios-ns     *:*\nudp        0      0 *:netbios-ns            *:*\nudp        0      0 10.0.0.6:netbios-dgm    *:*\nudp        0      0 *:netbios-dgm           *:*\nudp        0      0 mimmi.localdomain:1040  *:*\nudp        0      0 *:918                   *:*\nudp        0      0 *:bootpc                *:*\nudp        0      0 *:sunrpc                *:*\nudp        0      0 *:631                   *:*\nActive UNIX domain sockets (servers and established)\nProto RefCnt Flags       Type       State         I-Node Path\nunix  2      [ ACC ]     STREAM     LISTENING     2155   /dev/gpmctl\nunix  2      [ ACC ]     STREAM     LISTENING     2499   /tmp/.gdm_socket\nunix  9      [ ]         DGRAM                    1638   /dev/log\nunix  2      [ ACC ]     STREAM     LISTENING     2348   /tmp/.font-unix/fs7100\nunix  2      [ ACC ]     STREAM     LISTENING     2163   /tmp/.iroha_unix/IROHA\nunix  2      [ ACC ]     STREAM     LISTENING     2512   /tmp/.X11-unix/X0\nunix  3      [ ]         STREAM     CONNECTED     2559   /tmp/.X11-unix/X0\nunix  3      [ ]         STREAM     CONNECTED     2558\nunix  3      [ ]         STREAM     CONNECTED     2554   /tmp/.X11-unix/X0\nunix  3      [ ]         STREAM     CONNECTED     2553\nunix  3      [ ]         STREAM     CONNECTED     2537   /tmp/.font-unix/fs7100\nunix  3      [ ]         STREAM     CONNECTED     2536\nunix  3      [ ]         STREAM     CONNECTED     2539   /tmp/.X11-unix/X0\nunix  3      [ ]         STREAM     CONNECTED     2515\nunix  2      [ ]         DGRAM                    2435\nunix  2      [ ]         DGRAM                    2359\nunix  2      [ ]         DGRAM                    2188\nunix  2      [ ]         DGRAM                    2120\nunix  2      [ ]         DGRAM                    1859\nunix  2      [ ]         DGRAM                    1699\nunix  2      [ ]         DGRAM                    1649\n\nThread dump\n-----------\n(The same as above. Trust me, I've double checked + used a diff util.)\n\nComments\n--------\nI'm also running mysql with a jdbc driver. It has been hanging in \nthe 'CLOSE_WAIT' state before without being fatal. It just goes back \nto 'ESTABLISHED' when I browse a page that connects to mysql. I'm using the \nusual connectionpooling as described by mysql.\n\nThe connections now hangs in 'ESTABLISHED', it was before in 'CLOSE_WAIT'. \n(maybe because I noticed it sooner this time?)\n\nI'm using the new ThreadPool class. All classes in \npackage 'org\\apache\\tomcat\\util\\threads' was downloaded and compiled on the \n15.09.03.\n\nAlthough it seems like tomcat/java have hanged totally (no change in \nthreadstates after a client connection), it looks like there is some activity \nfrom 'top':\n  PID USER     PRI  NI  SIZE  RSS SHARE STAT %CPU %MEM   TIME CPU COMMAND\n 1799 root      15   0 40496  31M  1876 S     0.3 25.3  10:21   0 java\n16223 root      15   0  1104 1104   864 R     0.3  0.8   0:00   0 top\n\nAny chance that this is caused by too low memory (which the default is 32m?) ? \nI'd expect an out of memory exception, but I don't know...\n\nOh, now I got another client on the netstat list:\ntcp       32      0 10.0.0.6:http           80.80.18.252:1307       CLOSE_WAIT\n...and the diff util reported that the threaddumps was identical.\n\nMelv", "id": 44715, "time": "2003-09-25T19:55:05Z", "creator": "melvng@hotmail.com", "creation_time": "2003-09-25T19:55:05Z", "is_private": false}, {"count": 4, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "text": "The release notes were updated for 4.1.28 onwards to include the following:\n\n---------------\nTomcat on Linux:\n---------------\n<snip>\nGLIBC 2.2 / Linux 2.4 users should also define an environment variable:\nexport LD_ASSUME_KERNEL=2.2.5\n\n+ Additionally, Redhat 9.0 users should use the same setting, to avoid stability\n+ problems.\n\nThis also matches with a number of reports on the tomcat-user mailing list. I am\ngoing to resolve this as invalid since it is an OS issue.", "id": 77639, "time": "2005-07-25T21:10:39Z", "bug_id": 23311, "creation_time": "2005-07-25T21:10:39Z", "is_private": false}]