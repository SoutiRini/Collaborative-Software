[{"count": 0, "tags": [], "creator": "frank.caputo@edict.de", "attachment_id": 23522, "is_private": false, "id": 126411, "time": "2009-04-21T08:19:09Z", "bug_id": 47064, "creation_time": "2009-04-21T08:19:09Z", "text": "Created attachment 23522\nsvn patch file\n\nI patched JMeter to use the system look and feel by default and allow ctrl-click on the mac and use the apple-key for keyboard shortcuts of menu items.\n\nAll changes are platform independent. \nInstead of KeyEvent.CTRL_DOWN_MASK use Toolkit.getDefaultToolkit().getMenuShortcutKeyMask().\n\nisRightClick also checks e.isPopupTrigger().\n\nattached is the patchfile for 2.3.2."}, {"count": 1, "tags": [], "bug_id": 47064, "attachment_id": null, "text": "Thanks for the patch.\n\nUnfortunately, the patch does not seem to work for me - most of the changes are rejected. I don't know why that is.\n\nAlso, there is a Mac-specific change to jmeter.sh - are you sure that won't affect non-Mac Unixes? Can you generate a patch that detects the Mac?", "id": 126471, "time": "2009-04-23T16:11:07Z", "creator": "sebb@apache.org", "creation_time": "2009-04-23T16:11:07Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "frank.caputo@edict.de", "is_private": false, "count": 2, "id": 126478, "time": "2009-04-24T01:10:33Z", "bug_id": 47064, "creation_time": "2009-04-24T01:10:33Z", "text": "(In reply to comment #1)\n> Thanks for the patch.\n\nno problem.\n\n> Unfortunately, the patch does not seem to work for me - most of the changes are\n> rejected. I don't know why that is.\n\nfor me the patch works:\n\nsvn co http://svn.apache.org/repos/asf/jakarta/jmeter/tags/v2_3_2\ncd v2_3_2\npatch -p0 -i ~/Desktop/jmeter.diff\nant\n\nant compiles fine without errors.\n\n> Also, there is a Mac-specific change to jmeter.sh - are you sure that won't\n> affect non-Mac Unixes? Can you generate a patch that detects the Mac?\n\ni simply set a system property which is simply ignored on other systems than the mac."}, {"count": 3, "tags": [], "bug_id": 47064, "is_private": false, "text": "It works for me against the tag; however the current code in trunk has moved on a lot since then, which is presumably why the patch does not work against it.\n\nI suppose I can just do the replacements manually.\n\nIf I create a new nightly build with the changes, would you be able to test it out? I don't have a Mac to test on.", "id": 126479, "time": "2009-04-24T04:28:52Z", "creator": "sebb@apache.org", "creation_time": "2009-04-24T04:28:52Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 47064, "attachment_id": null, "id": 126480, "time": "2009-04-24T05:32:10Z", "creator": "sebb@apache.org", "creation_time": "2009-04-24T05:32:10Z", "is_private": false, "text": "The System LAF on Windows is not as nice as the Metal LAF, and I'm not prepared to change all the LAFs just to support Macs.\n\nI think one solution would be to allow the property \"jmeter.laf\" to have a local system override, e.g. \"jmeter.laf.<os.name>\" where <os.name> is obtained from the system at run-time.\n\nJMeter would look for \"jmeter.laf.<os.name>\", then \"jmeter.laf\".\n\nThis would allow one to change the default just for Macs.\n\nWhat does Java return for os.name on Macs? \nThis is shown in the jmeter.log file."}, {"count": 5, "tags": [], "bug_id": 47064, "attachment_id": null, "id": 126494, "time": "2009-04-24T10:13:36Z", "creator": "sebb@apache.org", "creation_time": "2009-04-24T10:13:36Z", "is_private": false, "text": "Applied most of the changes:\n\nURL: http://svn.apache.org/viewvc?rev=768370&view=rev\nLog:\nBug 47064 - fixes for Mac LAF\n\nThese are in the nightly builds starting with r768370.\n\nPlease can you try it out, and post details of the os.name."}, {"attachment_id": 23541, "tags": [], "creator": "milamber@apache.org", "is_private": false, "count": 6, "id": 126503, "time": "2009-04-24T13:36:52Z", "bug_id": 47064, "creation_time": "2009-04-24T13:36:52Z", "text": "Created attachment 23541\nPatch to work with os.name = \"linux\"\n\nWith New Revision 768370, JMeter doesn't start on Linux (ubuntu 9.04), because os.name is \"linux\" without space like \"windows xp\"\n\njmeter.log :\n2009/04/24 20:23:38 FATAL - jmeter.JMeter: An error occurred:  java.lang.ExceptionInInitializerError\n\tat java.lang.Class.forName0(Native Method)\n\tat java.lang.Class.forName(Class.java:169)\n\tat org.apache.jmeter.gui.action.ActionRouter.populateCommandMap(ActionRouter.java:275)\n\tat org.apache.jmeter.gui.action.ActionRouter.getInstance(ActionRouter.java:308)\n\tat org.apache.jmeter.JMeter.startGui(JMeter.java:220)\n\tat org.apache.jmeter.JMeter.start(JMeter.java:343)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.apache.jmeter.NewDriver.main(NewDriver.java:207)\nCaused by: java.lang.NullPointerException\n\tat org.apache.jmeter.gui.action.LookAndFeelCommand.getJMeterLaf(LookAndFeelCommand.java:77)\n\tat org.apache.jmeter.gui.action.LookAndFeelCommand.<clinit>(LookAndFeelCommand.java:49)\n\t... 11 more"}, {"count": 7, "tags": [], "bug_id": 47064, "attachment_id": null, "id": 126504, "time": "2009-04-24T13:37:51Z", "creator": "milamber@apache.org", "creation_time": "2009-04-24T13:37:51Z", "is_private": false, "text": "Note: I don't know if \"System.getProperty(\"os.name\")\" always return a correct string, but if it's return null, there are a possible NPE."}, {"count": 8, "text": "Thanks for report and patch, applied in:\n\nURL: http://svn.apache.org/viewvc?rev=768414&view=rev\nLog:\nOops - avoid NPE if os.name has no space in it.\nProps to Milamber, see Bug 47064\n\nI'll update the nightly build shortly.\n\nI don't think os.name should ever return null ...", "bug_id": 47064, "is_private": false, "id": 126505, "time": "2009-04-24T13:53:09Z", "creator": "sebb@apache.org", "creation_time": "2009-04-24T13:53:09Z", "tags": [], "attachment_id": null}, {"count": 9, "tags": [], "creator": "frank.caputo@edict.de", "attachment_id": null, "is_private": false, "id": 126532, "time": "2009-04-27T01:14:19Z", "bug_id": 47064, "creation_time": "2009-04-27T01:14:19Z", "text": "(In reply to comment #4)\n> The System LAF on Windows is not as nice as the Metal LAF, and I'm not prepared\n> to change all the LAFs just to support Macs.\n> \n> I think one solution would be to allow the property \"jmeter.laf\" to have a\n> local system override, e.g. \"jmeter.laf.<os.name>\" where <os.name> is obtained\n> from the system at run-time.\n> \n> JMeter would look for \"jmeter.laf.<os.name>\", then \"jmeter.laf\".\n> \n> This would allow one to change the default just for Macs.\n> \n> What does Java return for os.name on Macs? \n> This is shown in the jmeter.log file.\n\nMac OS X returns \"Mac OS X\" for \"os.name\".\n\nI think you should do something like:\n\n-------- code ------------------------------------\n\n// make os.name lower case and replace alt whitespaces with underscores \nString osName = System.getProperty(\"os.name\").toLowerCase().replaceAll(\"\\\\s\", \"_\");\nString laf = System.getProperty(\"jmeter.laf\");\n\nString osLaf = System.getProperty(\"jmeter.laf.\" + osName);\nif(osLaf != null) {\n    laf = osLaf;\n}\n\n-------- code ------------------------------------\n\nHere are some interesting links for os.name:\nhttp://developer.apple.com/technotes/tn2002/tn2110.html\nhttp://mindprod.com/jgloss/properties.html#OSNAME\n\nI will test the next nightly."}, {"count": 10, "text": "I think this is now finally fixed.\n\nI've added the ability to set the LAF to System or CrossPlatform, as well as to individual LAF implementations:\n\nURL: http://svn.apache.org/viewvc?rev=770777&view=rev\nLog:\n Bug 47064 -  Use System default Look And Feel (Mac)\n\nPlease re-open if the nightlies after r770777 don't work as expected on a Mac.", "bug_id": 47064, "is_private": false, "id": 126675, "time": "2009-05-01T11:12:58Z", "creator": "sebb@apache.org", "creation_time": "2009-05-01T11:12:58Z", "tags": [], "attachment_id": null}, {"count": 11, "tags": [], "bug_id": 47064, "attachment_id": null, "text": "I tried r772972 and it works fine out of the box on my mac.", "id": 127021, "time": "2009-05-14T08:02:14Z", "creator": "frank.caputo@edict.de", "creation_time": "2009-05-14T08:02:14Z", "is_private": false}, {"count": 12, "tags": [], "creator": "sebb@apache.org", "attachment_id": null, "is_private": false, "id": 127022, "time": "2009-05-14T08:54:19Z", "bug_id": 47064, "creation_time": "2009-05-14T08:54:19Z", "text": "Great - thanks for confirming this."}]