[{"count": 0, "tags": [], "creator": "agonzales@indra.es", "attachment_id": null, "id": 82224, "time": "2005-11-08T17:51:13Z", "bug_id": 37406, "creation_time": "2005-11-08T17:51:13Z", "is_private": false, "text": "Our project is called IKONOS and we are utilizing Apache/1.3.33 (Win32) \nPHP/4.3.11 mod_ssl/2.8.22 OpenSSL/0.9.7g on Windows 2000 Server. \nOur aplications is developed complety in php. We carry out connections (tcp) \nto Informix and to Microsoft SQL-SERVER.\nAlready it does a pair of months we have noting that the majority of the \nconnections established are not freed correctly.\nThis causes that the new connections are rejected and of way some programs php \nsaturate our servant web apache to ocacionar its\nimminent blockade, having that resuming the service apache constantly.  We \nhave carried out some changes in the configuration of httpd.conf an php.ini\nwith the possibility to stabilizing the problems, but we have not had better \nresults.  \n\nThe Apache.log shows us constantly the following warning:\n\n[Tue Nov 08 16:53:43 2005] [error] mod_ssl: SSL handshake failed (server \nykonos.gaeto.sescam.jclm.es:443, client 10.36.174.7) (OpenSSL library error \nfollows)\n[Tue Nov 08 16:53:43 2005] [error] OpenSSL: error:14094416:SSL \nroutines:SSL3_READ_BYTES:sslv3 alert certificate unknown\n\nThe php-error. log shows us constantly the following warning/error:\n\n[08-Nov-2005 13:50:33] PHP Warning:  odbc_do(): SQL error: [Microsoft][ODBC \nSQL Server Driver]Error en el v\u00ednculo de comunicaci\u00f3n, SQL state 08S01 in \nSQLExecDirect in d:\\apache\\htdocsseg\\radiologiaxml\\image_server.php on line 7\n\n[08-Nov-2005 13:50:33] PHP Warning:  odbc_fetch_into(): supplied argument is \nnot a valid ODBC result resource in \nd:\\apache\\htdocsseg\\radiologiaxml\\image_server.php on line 7\n\n[08-Nov-2005 13:50:33] PHP Warning:  odbc_free_result(): supplied argument is \nnot a valid ODBC result resource in \nd:\\apache\\htdocsseg\\radiologiaxml\\image_server.php on line 7\n\n[08-Nov-2005 11:40:18] PHP Warning:  ldap_bind(): Unable to bind to server: \nInvalid credentials in d:\\apache\\htdocsseg\\radiologiaxml\\listaimagenes.php on \nline 41\n\n\nOur present configuration of Apche is like continues:\n\n-------------------------------------------------------\n--------------------httpd.conf-------------------------\n-------------------------------------------------------\n\nWe have defused these two guidelines:\n\n\t#MaxSpareServers  10\n\n\t#MinSpareServers 5 \t\n\nWe have Paymasters the following guidelines:\n\n\n# Timeout: The number of seconds before receives and sends time out.\n#\nTimeout 300\n\n#\n# KeepAlive: Whether or not to allow persistent connections (more than\n# one request per connection). Set to \"Off\" to deactivate.\n#\nKeepAlive On\n\n#\n# MaxKeepAliveRequests: The maximum number of requests to allow\n# during a persistent connection. Set to 0 to allow an unlimited amount.\n# We recommend you leave this number high, for maximum performance.\n#\nMaxKeepAliveRequests 500\n\n#\n# KeepAliveTimeout: Number of seconds to wait for the next request from the\n# same client on the same connection.\n#\nKeepAliveTimeout 15\n\nMaxRequestsPerChild 0\n\n#\n# Number of concurrent threads (i.e., requests) the server will allow.\n# Set this value according to the responsiveness of the server (more\n# requests active at once means they're all handled more slowly) and\n# the amount of system resources you'll allow the server to consume.\n#\n#ThreadsPerChild 128\nThreadsPerChild 200\n\n#\n# Listen: Allows you to bind Apache to specific IP addresses and/or\n# ports, instead of the default. See also the <VirtualHost>\n# directive.\n#\nListen 80\nListen 443\n\n\n-------------------------------------------------------\n--------------------php.ini--------------------------\n-------------------------------------------------------\n\nOur configurations of php.ini is the following:\n\n\n[SQL]\nsql.safe_mode = Off\n\n[ODBC]\n;odbc.default_db    =  Not yet implemented\n;odbc.default_user  =  Not yet implemented\n;odbc.default_pw    =  Not yet implemented\n\n; Allow or prevent persistent links.\nodbc.allow_persistent = On\n\n; Check that a connection is still valid before reuse.\nodbc.check_persistent = On\n\n; Maximum number of persistent links.  -1 means no limit.\nodbc.max_persistent = -1\n\n; Maximum number of links (persistent + non-persistent).  -1 means no limit.\nodbc.max_links = -1  \n\n; Handling of LONG fields.  Returns number of bytes to variables.  0 means\n; passthru.\nodbc.defaultlrl = 4096  \n\n; Handling of binary data.  0 means passthru, 1 return as is, 2 convert to \nchar.\n; See the documentation on odbc_binmode and odbc_longreadlen for an explanation\n; of uodbc.defaultlrl and uodbc.defaultbinmode\nodbc.defaultbinmode = 1  \n\n\n[Informix]\n; Default host for ifx_connect() (doesn't apply in safe mode).\nifx.default_host =\n\n; Default user for ifx_connect() (doesn't apply in safe mode).\n\n; Default password for ifx_connect() (doesn't apply in safe mode).\n\n; Allow or prevent persistent links.\nifx.allow_persistent = On\n\n; Maximum number of persistent links.  -1 means no limit.\nifx.max_persistent = -1\n\n; Maximum number of links (persistent + non-persistent).  -1 means no limit.\nifx.max_links = -1\n\n; If on, select statements return the contents of a text blob instead of its \nid.\nifx.textasvarchar = 0\n\n; If on, select statements return the contents of a byte blob instead of its \nid.\nifx.byteasvarchar = 0\n\n; Trailing blanks are stripped from fixed-length char columns.  May help the\n; life of Informix SE users.\nifx.charasvarchar = 0\n\n; If on, the contents of text and byte blobs are dumped to a file instead of\n; keeping them in memory.\nifx.blobinfile = 0\n\n; NULL's are returned as empty strings, unless this is set to 1.  In that case,\n; NULL's are returned as string 'NULL'.\nifx.nullformat = 0\n\n\n[MSSQL]\n; Allow or prevent persistent links.\nmssql.allow_persistent = On\n\n; Maximum number of persistent links.  -1 means no limit.\nmssql.max_persistent = -1\n\n; Maximum number of links (persistent+non persistent).  -1 means no limit.\nmssql.max_links = -1\n\n; Minimum error severity to display.\nmssql.min_error_severity = 10\n\n; Minimum message severity to display.\nmssql.min_message_severity = 10\n\n; Compatability mode with old versions of PHP 3.0.\nmssql.compatability_mode = Off\n\n; Connect timeout\n;mssql.connect_timeout = 5\n\n; Query timeout\n;mssql.timeout = 60\n\n; Valid range 0 - 2147483647.  Default = 4096.\n;mssql.textlimit = 4096\n\n; Valid range 0 - 2147483647.  Default = 4096.\n;mssql.textsize = 4096\n\n; Limits the number of records in each batch.  0 = all records in one batch.\n;mssql.batchsize = 0\n\n; Specify how datetime and datetim4 columns are returned\n; On => Returns data converted to SQL server settings\n; Off => Returns values as YYYY-MM-DD hh:mm:ss\n;mssql.datetimeconvert = On\n\n; Use NT authentication when connecting to the server\nmssql.secure_connection = Off\n\n; Specify max number of processes. Default = 25\n;mssql.max_procs = 25\n\n[Sockets]\n; Use the system read() function instead of the php_read() wrapper.\nsockets.use_system_read = On\n\n-------------------------------------------------------------------------------\n--------------------------\n-------------------------------------------------------------------------------\n--------------------------\n\nWe believe in the possibility to solve this problem without having that to \nemigrate to versions of apache 2.\nNevertheless we expect that the community Apache can have some alternative \nthat permit us to solve this\nproblem."}, {"count": 1, "tags": [], "bug_id": 37406, "is_private": false, "text": "Apache (pre-2.1) doesn't make or release any database connections.  It's up to \nthe application that does so to free them. \n ", "id": 82231, "time": "2005-11-08T18:56:42Z", "creator": "nick@webthing.com", "creation_time": "2005-11-08T18:56:42Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 37406, "is_private": false, "text": "(In reply to comment #1)\n> Apache (pre-2.1) doesn't make or release any database connections.  It's up \nto \n> the application that does so to free them. \n>  \n\nYes, you have rason, but all the conection of Apache remain Waiting. Even it \nless we need you know if our configurations are the most appropriate or some \nanother solution is possible.", "id": 82267, "time": "2005-11-09T08:28:40Z", "creator": "agonzales@indra.es", "creation_time": "2005-11-09T08:28:40Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 37406, "attachment_id": null, "is_private": false, "id": 82319, "time": "2005-11-09T23:01:49Z", "creator": "rpluem@apache.org", "creation_time": "2005-11-09T23:01:49Z", "text": "Sorry, but this is clearly no httpd issue. It has something to do with either\n\n- your database drivers inside php\n- php itself\n- your php programs\n\nSo please consult\n\n- your database vendor\n- the php bug database\n- yourself\n\nBecause this is not an httpd bug this report has been set to RESOLVED INVALID.\nSorry, but we cannot save the whole world here ;-)."}]