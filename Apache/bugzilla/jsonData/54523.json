[{"count": 0, "tags": [], "text": "I use a simple script to generate 81000 rows in a .xlsx file, \nthen this file can not open in Excel 2010 with \"Excel found \nunreadable content\" error. And I got CRC error when try to\ndecompress it with 7zip on windows.\n\nAnd a .xlsx file with 80000 rows is ok...\n\nscripts:\n\tSXSSFWorkbook wb = new SXSSFWorkbook(100);\n\tSheet sh = wb.createSheet();\n\n\tfor (int i = 0; i < 81000; i++) {\n\t\tRow row = sh.createRow(i);\n\t\tfor (int j = 0; j < 1000; j++) {\n\t\t\tCell cell = row.createCell(j);\n\t\t\tcell.setCellValue(\"dddd\");\n\t\t}\n\t\tif (i % 100 == 0){\n\t\t\tSystem.out.println(\"x - \" + i);\n\t\t}\n\t}\n\n\tFileOutputStream out = new FileOutputStream(xlsx);\n\twb.write(out);\n\tout.close();\n\twb.dispose();", "is_private": false, "id": 165069, "creator": "pgf00a@gmail.com", "time": "2013-02-05T04:36:27Z", "bug_id": 54523, "creation_time": "2013-02-05T04:36:27Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 54523, "attachment_id": null, "text": "also exist in version 3.8, 3.9", "id": 165300, "time": "2013-02-18T11:09:22Z", "creator": "pgf00a@gmail.com", "creation_time": "2013-02-18T11:09:22Z", "is_private": false}, {"count": 2, "attachment_id": null, "bug_id": 54523, "is_private": false, "id": 165301, "time": "2013-02-18T11:14:06Z", "creator": "apache@gagravarr.org", "creation_time": "2013-02-18T11:14:06Z", "tags": [], "text": "Can you try on another machine / jvm? You shouldn't be getting a CRC error when decompressing, as that should all be handled automatically by the JVM, so that tends to imply that there's something broken about your setup"}, {"count": 3, "attachment_id": null, "bug_id": 54523, "is_private": false, "id": 165340, "time": "2013-02-19T02:17:03Z", "creator": "pgf00a@gmail.com", "creation_time": "2013-02-19T02:17:03Z", "tags": [], "text": "can you reproduce it? \ni compiled and ran it by:\n  javac.exe -cp poi-4.0-beta1/* Test.java\n  java.exe -cp poi-4.0-beta1/*;poi-4.0-beta1/ooxml-lib/*;. Test\n\nall following situations failed:\n\n1.ubuntu\n  java version \"1.6.0_24\"\n  OpenJDK Runtime Environment (IcedTea6 1.11.5) (6b24-1.11.5-0ubuntu1~12.04.1)\n  OpenJDK 64-Bit Server VM (build 20.0-b12, mixed mode)\n\n2 windows 7\n  java version \"1.7.0_11\"\n  Java(TM) SE Runtime Environment (build 1.7.0_11-b21)\n  Java HotSpot(TM) 64-Bit Server VM (build 23.6-b04, mixed mode)\n\n3 windows 7\n  java version \"1.6.0_27\"\n  Java(TM) SE Runtime Environment (build 1.6.0_27-b07)\n  Java HotSpot(TM) 64-Bit Server VM (build 20.2-b06, mixed mode)"}, {"count": 4, "tags": [], "creator": "pgf00a@gmail.com", "text": "Can any one reproduce it?\nOr need any other infomation?\nThanks a lot.", "id": 165666, "time": "2013-03-06T08:37:44Z", "bug_id": 54523, "creation_time": "2013-03-06T08:37:44Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 54523, "attachment_id": null, "is_private": false, "id": 165951, "time": "2013-03-18T10:33:00Z", "creator": "piotrprz@gmail.com", "creation_time": "2013-03-18T10:33:00Z", "text": "windows 7\njava version \"1.6.0_31\"\nJava(TM) SE Runtime Environment (build 1.6.0_31-b05)\nJava HotSpot(TM) 64-Bit Server VM (build 20.6-b01, mixed mode)\n\nwindows 7\njava version \"1.7.0_17\"\nJava(TM) SE Runtime Environment (build 1.7.0_17-b02)\nJava HotSpot(TM) Client VM (build 23.7-b01, mixed mode, sharing)\n\nXLSX file with 81000 rows has 203\u00a0234\u00a0945 bytes, when extracted with 7-zip xl/worksheets/sheet1.xml has 4\u00a0305\u00a0778\u00a0271 bytes (slightly more than 4 GB) and looks to be cut at this point.\n\nXLSX file with 80000 rows has 200\u00a0729\u00a0481 bytes, when extracted with 7-zip xl/worksheets/sheet1.xml has 4\u00a0252\u00a0483\u00a0271 bytes (almost 4 GB) and looks ok.\n\n4 GB seems to be some magic size after which sheet1.xml gets broken (cut)."}, {"count": 6, "tags": [], "bug_id": 54523, "attachment_id": null, "is_private": false, "id": 167055, "time": "2013-05-06T09:27:36Z", "creator": "pgf00a@gmail.com", "creation_time": "2013-05-06T09:27:36Z", "text": "It seems jdk after 1.7b55 supports zip64 in 2009.\n(https://blogs.oracle.com/xuemingshen/entry/zip64_support_for_4g_zipfile)\n\nBut it didn't help this problem. \nxlsx file generated by POI with newest jdk (1.7.0_21) didn't work.\n\nThe result xlsx file can be uncompress by 7zip successfully.\nAnd then I built a new zip file with 7zip, the new zip file\nworked with office."}, {"count": 7, "tags": [], "text": "Both the application \"zip\" from cygwin on Windows as well zip64 (http://sourceforge.net/projects/zip64file/) produce zip files that are deemed invalid by Excel 2013, however other tools can read all those files fine, seems Excel is much more picky about something in the file format.\n\nAlso choosing options to not compress at all with the zip64 tool did produce a file that got rejected by Excel.", "is_private": false, "id": 177494, "creator": "dominik.stadler@gmx.at", "time": "2014-09-01T14:03:23Z", "bug_id": 54523, "creation_time": "2014-09-01T14:03:23Z", "attachment_id": null}, {"count": 8, "tags": [], "creator": "aldrin.baroi@gmail.com", "text": "Apache POI version: 3.14, 3.15-BETA2\nExcel 2010\n\nNumber of columns in Excel Sheet:  208\nNumber of rows in Excel Sheet:  410,000 or more\n\nExcel displays \"Excel found unreadable content in '...'. Do you want to recover the contents of this workbook? If you trust...\" error message ONLY WHEN the number of rows exceeds 410,000 or so.", "id": 193900, "time": "2016-09-22T00:23:15Z", "bug_id": 54523, "creation_time": "2016-09-22T00:23:15Z", "is_private": false, "attachment_id": null}, {"count": 9, "attachment_id": null, "bug_id": 54523, "text": "I am closing this one as duplicate of 57342, both bugs describe the same issue.\n\n*** This bug has been marked as a duplicate of bug 57342 ***", "id": 194763, "time": "2016-11-01T20:04:28Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-11-01T20:04:28Z", "tags": [], "is_private": false}]