[{"count": 0, "text": "I'm not sure this is a bug - might be expected behaviour - I'm not expert in \nthis area.  Have tried to ascertain what should be happening, by reading the \nservlet/JSP spec docs and parts of the TC source code, but I'm still not quite \nsure.  I posted to tomcat-user twice seeking help on this (no responses).\n\nThe problem that I'm seeing is that when a JSP page includes one or more JSP \nfragments using <jsp:include> actions, but the fragment files don't exist, the \nincluding JSP page is returned to the browser without the fragments included.  \nIt's as if the including JSP ignores the missing fragments and continues being \nprocessed.  The including page is returned with SC of 200, as if there is no \nproblem. Nothing is written to any log file to indicate the problem.\n\nI would have expected this to return an exception or a 404, but neither \nhappens.  Is this the expected behaviour?  As it stands, a webapp bug like \nthis could go unnoticed for quite some time.  Normally TC is good at bringing \nbugs like this to the developer's attention.\n\nSee attached war for simple example.  First discovered on 5.5.9, verified same \nbehaviour on 5.5.12, both based on fresh TC installs.\n\nI appreciate that once the including JSP has written the part of its response \nbefore the include, the response could already be committed depending on \nbuffer size, so calling sendError() will cause an IllegalStateException.  \nAlso, may not be possible to return an error page at this point, again because \nthe response is already committed...?  Perhaps though an exception could be \nlogged?  Or, perhaps (?)the including page's processing should be stopped, \nrather than allowing it to continue.\n\nSome other info: I only discovered that I had omitted the fragment files from \nmy warfile when I first started TC from NetBeans rather than from TC batch \nscripts.  When I did this, the missing fragments are then reported with SC \n404.  As far as I can tell, it seems that the addition of the NetBeans \nHTTPMonitorFilter to conf/web.xml is what causes the 404 to be reported where \nit was previously silent.  Have drawn a blank on why this might be.\n\nFor more info (my posts to tc-user) see also: http://marc.theaimsgroup.com/?\nl=tomcat-user&m=113034098008166&w=2", "creator": "apache-bug-db@web-startup.co.uk", "is_private": false, "id": 82020, "time": "2005-11-01T22:59:43Z", "bug_id": 37326, "creation_time": "2005-11-01T22:59:43Z", "tags": [], "attachment_id": null}, {"attachment_id": 16849, "tags": [], "bug_id": 37326, "is_private": false, "count": 1, "id": 82021, "time": "2005-11-01T23:00:53Z", "creator": "apache-bug-db@web-startup.co.uk", "creation_time": "2005-11-01T23:00:53Z", "text": "Created attachment 16849\nexample war file"}, {"count": 2, "text": "I'm looking at org.apache.catalina.core.ApplicationDispatcher (which I think is\nthe relevant class), and it seems to log and re-throw all the exceptions. \nSteve, can you please retry it on 5.5.12 with DEBUG-level logging enabled for\nthis class, and post your findings when you get a chance?  Thanks.", "creator": "yoavs@computer.org", "is_private": false, "id": 82933, "time": "2005-11-28T21:27:21Z", "bug_id": 37326, "creation_time": "2005-11-28T21:27:21Z", "tags": [], "attachment_id": null}, {"count": 3, "tags": [], "creator": "apache-bug-db@web-startup.co.uk", "text": "(In reply to comment #2)\nOK have done that.  Used fresh install of TC5.5.12 installed as windows \nservice using the service.bat script (which is my standard dev setup).  TC is \nunmodified from standard install, except that I added my test.war (attached) \nto the webapps folder. No other changes to standard setup.  PS am using jdk \n1.5.0_02-b09\n\nFor some reason could not get DEBUG/ALL logging of the class to work with \njava.util.logging (which is what I normally use), so installed log4j instead \nexactly as described on the logging docs page (at \nhttp://tomcat.apache.org/tomcat-5.5-doc/logging.html), with the exception that \nI modified log4j.properties as shown below to give DEBUG level on the \nApplicationDispatcher, hope this is correct, not sure as do not know log4j \nwell:\n\nlog4j.rootLogger=info, R \nlog4j.appender.R=org.apache.log4j.RollingFileAppender \nlog4j.appender.R.File=${catalina.home}/logs/tomcat.log \nlog4j.appender.R.MaxFileSize=10MB \nlog4j.appender.R.MaxBackupIndex=10 \nlog4j.appender.R.layout=org.apache.log4j.PatternLayout \nlog4j.appender.R.layout.ConversionPattern=%p %t %c - %m%n \nlog4j.logger.org.apache.catalina.core.ApplicationDispatcher=DEBUG\n\nThen ran the request to http://localhost:8080/test/ to test the attached war.  \nPage worked fine as before, no reported errors in logfile or browser, despite \none of the included files being missing from the webapp.  The entire contents \nof the resulting tomcat.log are attached.\n\nHope this helps, just let me know if you need anything else.\n", "id": 82954, "time": "2005-11-29T11:32:42Z", "bug_id": 37326, "creation_time": "2005-11-29T11:32:42Z", "is_private": false, "attachment_id": null}, {"attachment_id": 17073, "tags": [], "bug_id": 37326, "text": "Created attachment 17073\ntomcat.log using log4j with DEBUG level for ApplicationDispatcher", "count": 4, "id": 82955, "time": "2005-11-29T11:33:40Z", "creator": "apache-bug-db@web-startup.co.uk", "creation_time": "2005-11-29T11:33:40Z", "is_private": false}, {"count": 5, "text": "Steve, thank you.  This helps.  I'll try to find more time to look at this\nwithin the next few days.", "creator": "yoavs@computer.org", "is_private": false, "id": 82970, "time": "2005-11-29T15:11:43Z", "bug_id": 37326, "creation_time": "2005-11-29T15:11:43Z", "tags": [], "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 37326, "attachment_id": null, "text": "Ooops, I guess I didn't get to this in a few days, did I?  It's piqued my\ncuriosity again.  Thanks for going through the debugging steps and attaching the\nWAR.  Your log4j configuration looks fine.  I'll try to run an instrumented\nversion of the code locally with more logging statements and see if I can learn\nanything.", "id": 97352, "time": "2006-12-26T16:45:30Z", "creator": "yoavs@computer.org", "creation_time": "2006-12-26T16:45:30Z", "is_private": false}, {"count": 7, "tags": [], "creator": "markt@apache.org", "text": "This has been fixed in 5.5.x and 6.0.x and will be included in the next releases\nof each.", "id": 106338, "time": "2007-08-04T11:20:08Z", "bug_id": 37326, "creation_time": "2007-08-04T11:20:08Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 37326, "is_private": false, "count": 8, "id": 113862, "time": "2008-02-18T12:36:32Z", "creator": "adamrabung@hotmail.com", "creation_time": "2008-02-18T12:36:32Z", "text": "Is it possible to disable this behavior with configuration?  I love the addition\nof this error, but I don't want to have to update legacy versions of my app."}, {"attachment_id": null, "tags": [], "bug_id": 37326, "text": "I am afraid not.", "count": 9, "id": 113863, "time": "2008-02-18T13:06:28Z", "creator": "markt@apache.org", "creation_time": "2008-02-18T13:06:28Z", "is_private": false}]