[{"count": 0, "tags": [], "creator": "lakshmi.nchandana@gmail.com", "is_private": false, "text": "I sent this query to the POI mailing list couple of days back and was advised to open a bug here.\n\nI tested hyperlinks with Apache POI (3.8 version) and it throws java.lang.IllegalStateException: The hyperlink for cell A2 references relation rId2, but that didn't exist!\nfor hyperlinks with non-breaking spaces. The non-breaking space in an hyperlink relation is not a valid java URI. These invalid characters should also be encoded for valid URI. Looks like the issue with white space in target URI was fixed in r1036215. \n\nWhen trying to convert such hyperlink to URI, a URISyntaxException is thrown.\n\nPlease find the attachment of the excel file including the hyperlink with a non-breaking space. \n\nBelow is the sample java code to demonstrate the issue.\n\nimport java.io.FileInputStream;\nimport java.io.IOException;\n\nimport org.apache.poi.ss.usermodel.Workbook;\nimport org.apache.poi.ss.usermodel.WorkbookFactory;\n\npublic class DemonstrateHyperlinkIssue {\n\t\n\tpublic static Workbook getCell(String fileName) throws Exception{\n\t\t\n\t\tFileInputStream input = null;\n\t\tWorkbook excelDoc = null;\n\t\t\n\t\ttry {\n\t\t\tinput = new FileInputStream(fileName);\n\t\t\texcelDoc = WorkbookFactory.create(input);\n\t\t\tinput.close();\n\t\t}\n\t\tcatch(IOException e)\n\t\t{\n\t\t\tthrow e;\n\t\t}\n\t\tfinally\n\t\t{\n\t\t\tif (input != null) {\n\t\t\t\tinput.close();\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn excelDoc;\n\t}\n\n\tpublic static void main(String [] args) {\n\t\ttry {\n\t\t\tWorkbook wb = getCell(\"C:\\\\pathToFile\\\\test.xlsx\");\n\t\t\tSystem.out.println(wb);\n\t\t} catch (Exception e) {\n\t\t\t// TODO Auto-generated catch block\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n}", "id": 159264, "time": "2012-05-23T21:13:23Z", "bug_id": 53282, "creation_time": "2012-05-23T21:13:23Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "lakshmi.nchandana@gmail.com", "is_private": false, "text": "Created attachment 28827\nExcel file containing the hyperlink with a non-breaking space", "id": 159269, "time": "2012-05-23T21:24:02Z", "bug_id": 53282, "creation_time": "2012-05-23T21:24:02Z", "attachment_id": 28827}, {"count": 2, "tags": [], "creator": "lakshmi.nchandana@gmail.com", "is_private": false, "text": "Comment on attachment 28827\nExcel file containing the hyperlink with a non-breaking space\n\nplease ignore this attachment.", "id": 159272, "time": "2012-05-23T21:27:39Z", "bug_id": 53282, "creation_time": "2012-05-23T21:27:39Z", "attachment_id": 28827}, {"count": 3, "attachment_id": null, "bug_id": 53282, "text": "Unable to attach the excel file.\n\nTo reproduce the error, copy/paste the below in an excel file\n\nnobody@nowhere.uk\u00a0\nnobody@nowhere.com", "id": 159274, "time": "2012-05-23T21:29:59Z", "creator": "lakshmi.nchandana@gmail.com", "creation_time": "2012-05-23T21:29:59Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "creator": "yegor@dinom.ru", "is_private": false, "text": "I can't reproduce it. \nPlease try again to attach a sample file with a nbsp . \n\nYegor\n\n(In reply to comment #3)\n> Unable to attach the excel file.\n> \n> To reproduce the error, copy/paste the below in an excel file\n> \n> nobody@nowhere.uk\u00a0\n> nobody@nowhere.com", "id": 159281, "time": "2012-05-24T08:28:06Z", "bug_id": 53282, "creation_time": "2012-05-24T08:28:06Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 53282, "attachment_id": 28830, "is_private": false, "id": 159296, "time": "2012-05-24T16:25:39Z", "creator": "lakshmi.nchandana@gmail.com", "creation_time": "2012-05-24T16:25:39Z", "text": "Created attachment 28830\nExcel file with a non-breaking space hyperlink"}, {"count": 6, "attachment_id": null, "bug_id": 53282, "text": "Fixed in r1403195. I included your sample in our collection of test files.\n\nYegor", "id": 163014, "time": "2012-10-29T08:44:24Z", "creator": "yegor@dinom.ru", "creation_time": "2012-10-29T08:44:24Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "bug_id": 53282, "text": "Created attachment 30385\nExcel sample with hyperlinks\n\nExcel sample with hyperlinks", "id": 167648, "attachment_id": 30385, "creator": "sivasubbareddy@gmail.com", "creation_time": "2013-06-04T09:59:13Z", "time": "2013-06-04T09:59:13Z", "is_private": false}, {"count": 8, "tags": [], "creator": "sivasubbareddy@gmail.com", "text": "We have tried with version 3.9 and 3.10 beta. Seems still issue is there. Attached a sample file the japanese hyperlink with a space.", "id": 167649, "time": "2013-06-04T10:00:43Z", "bug_id": 53282, "creation_time": "2013-06-04T10:00:43Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 53282, "attachment_id": null, "is_private": false, "id": 167788, "time": "2013-06-12T15:33:58Z", "creator": "apache@gagravarr.org", "creation_time": "2013-06-12T15:33:58Z", "text": "Are you able to produce a unit test, similar to the one Yegor did for r1403195, which shows how the problem still remains? That will help us track down what's still incorrect."}, {"count": 10, "tags": [], "creator": "kayulai2@gmail.com", "is_private": false, "text": "Created attachment 30683\nExcel file containing invalid hyperlink", "id": 169213, "time": "2013-08-07T02:51:38Z", "bug_id": 53282, "creation_time": "2013-08-07T02:51:38Z", "attachment_id": 30683}, {"count": 11, "tags": [], "creator": "kayulai2@gmail.com", "is_private": false, "text": "Comment on attachment 30683\nExcel file containing invalid hyperlink\n\nThis file contain a invalid email address hyperlink which can reproduce the probelm.", "id": 169214, "time": "2013-08-07T02:53:48Z", "bug_id": 53282, "creation_time": "2013-08-07T02:53:48Z", "attachment_id": 30683}, {"count": 12, "tags": [], "creator": "kiwiwings@apache.org", "text": "Fixed by svn rev r1563540.\n\nAlthough the last sample file containing the invalid hyperlink seems to be a bit hypothetical, I think it's better to receive/return an invalid-url, in case such a malformed uri is really generated, opposed to throwing an IllegalStateException", "id": 172854, "time": "2014-02-02T02:01:19Z", "bug_id": 53282, "creation_time": "2014-02-02T02:01:19Z", "is_private": false, "attachment_id": null}, {"count": 13, "tags": [], "creator": "peng.li@gmx.de", "is_private": false, "text": "It seems that the bug still exists in 3.10 final.\nI got a file from a customer where value like \"xxx@company.com; \n TEL: +001-123-456789\" is given as email address hyperlink in it. Try to import this file a IllegalStateException is thrown at the beginning and there is no way to correct the value afterwards in program.", "id": 176189, "time": "2014-07-03T12:34:43Z", "bug_id": 53282, "creation_time": "2014-07-03T12:34:43Z", "attachment_id": null}, {"count": 14, "attachment_id": null, "bug_id": 53282, "text": "I have been facing the same issue as well and I am using POI 3.10.1.\nThe excel that I have has autogenerated hyperlinks and some of them have spaces in the hyperlink.", "id": 179716, "time": "2014-12-11T18:49:13Z", "creator": "devscorpio2001@gmail.com", "creation_time": "2014-12-11T18:49:13Z", "tags": [], "is_private": false}, {"count": 15, "attachment_id": 32471, "bug_id": 53282, "is_private": false, "id": 181035, "time": "2015-02-13T03:36:46Z", "creator": "ameetchaubal@yahoo.com", "creation_time": "2015-02-13T03:36:46Z", "tags": [], "text": "Created attachment 32471\nhyperlink error\n\nI am getting a similar error on workbook.cloneSheet\nThe hyperlink for cell O2 references relation rId1, but that didn't exist!"}]