[{"count": 0, "tags": [], "bug_id": 38358, "attachment_id": null, "text": "I have to do a report with some value issued from an AS400. Anyway, when I put\nall my values and finally my formula, all other formula works perfectly but\nYIELD(TODAY()+3;V5;W5;... and so on, dosn't work...\n\nThe formula is parsed without any errors, and as a result, we ca see in the Cell :\n\nTODAY()+3;otherparams;)XYIELD\n\nwhere X is a strange caracter (sometimes a chinese sign, or a rectangle ...)\n\nI have to explain to my client that he must click on the Cell and click Enter\nand after that, copy the formula right down ... I've putted my formula with a\n'=' and in string type ...\n\nI've search a lot but there is apparently any other possibility to put a formula\nand to bypass the parsing done by HSSF ...\n\nSo if its possible when you know that your way is not completely finished,\nprovide another possibilty or a workaround ... If there is one, I'm really\ninterested !!!!", "id": 84910, "time": "2006-01-23T21:29:30Z", "creator": "pitilezard@gmail.com", "creation_time": "2006-01-23T21:29:30Z", "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 38358, "is_private": false, "id": 84925, "time": "2006-01-24T03:36:53Z", "creator": "jheight@apache.org", "creation_time": "2006-01-24T03:36:53Z", "tags": [], "text": "Can you provide this example of the problem as a small java application and\nattach it to this bug. Dont forget to include any excel files that this\napplication uses to exhbit the problem.\n\nThanks\n\nJason"}, {"count": 2, "tags": [], "creator": "pitilezard@gmail.com", "is_private": false, "text": "(In reply to comment #0)\n> I have to do a report with some value issued from an AS400. Anyway, when I put\n> all my values and finally my formula, all other formula works perfectly but\n> YIELD(TODAY()+3;V5;W5;... and so on, dosn't work...\n> \n> The formula is parsed without any errors, and as a result, we ca see in the Cell :\n> \n> TODAY()+3;otherparams;)XYIELD\n> \n> where X is a strange caracter (sometimes a chinese sign, or a rectangle ...)\n> \n> I have to explain to my client that he must click on the Cell and click Enter\n> and after that, copy the formula right down ... I've putted my formula with a\n> '=' and in string type ...\n> \n> I've search a lot but there is apparently any other possibility to put a formula\n> and to bypass the parsing done by HSSF ...\n> \n> So if its possible when you know that your way is not completely finished,\n> provide another possibilty or a workaround ... If there is one, I'm really\n> interested !!!!\n\nSorry for the so long gap between my answers.\n\nSome functions usefull to understand my code :\n\n\tpublic HSSFCell getCell(HSSFSheet sheet,int row,int col,int type) {\n\t\tHSSFRow r = sheet.getRow(row);\n\t\tif (r == null) {\n\t\t\tr = sheet.createRow(row);\n\t\t}\n\t\tHSSFCell c = r.getCell((short)col);\n\t\tif (c == null) {\n\t\t\tc = r.createCell((short)col);\n\t\t}\n\t\tc.setCellType(type);\n\t\treturn c;\n\t}\n\tpublic HSSFCell getCell(HSSFSheet sheet,int row, int col) {\n\t\treturn getCell(sheet,row,col,HSSFCell.CELL_TYPE_STRING);\n\t}\n\nThat's what I have now :\ngetCell(sheet,gap,9).setCellValue(\"=YIELD(DATE(\"+year+\";\"+month+\";\"+day+\") +\n3;W\"+(gap+1)+\";E\"+(gap+1)+\"/100;G\"+(gap+1)+\";100;V\"+(gap+1)+\";1)*100\");\n\nwith gap increasing and with some values everywhere ...\n\nI'd like to have:\ngetCell(sheet,gap,9,HSSFCell.CELL_TYPE_FORMULA).setCellFormula(\"=YIELD(DATE(\"+year+\";\"+month+\";\"+day+\")\n+ 3;W\"+(gap+1)+\";E\"+(gap+1)+\"/100;G\"+(gap+1)+\";100;V\"+(gap+1)+\";1)*100\");\n\nWhich is the same thing but without the need to type enter on each row of the\nbook ;)\n\nI cannot specify more as it is confidential data but I think all is here !\n\nThank you :)\n\nPS: If I have the time tonight I'll make a jar with an application running this\nbug but you have to get some financial plugins in you'r Excel in order to read\nit ... As YIELD is not a default function ...", "id": 85341, "time": "2006-02-02T14:03:55Z", "bug_id": 38358, "creation_time": "2006-02-02T14:03:55Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "pitilezard@gmail.com", "text": "Created attachment 18416\nA piece of process that produce an error\n\nHowto:\n* new folder\n* put testPOI.jar and poi.jar (version 2.5.1-final-20040804)\n* new empty excel file named test.xls\n* java -classpath testPOI.jar:poi.jar com.tests.Main\n\nfile outputed is result.xls which should contain a formula with YIELD in the\nfirst sheet column K.\n\nThank you in advance ;)", "id": 89852, "time": "2006-06-07T07:05:31Z", "bug_id": 38358, "creation_time": "2006-06-07T07:05:31Z", "is_private": false, "attachment_id": 18416}, {"count": 4, "tags": [], "bug_id": 38358, "attachment_id": null, "is_private": false, "id": 89854, "time": "2006-06-07T07:06:46Z", "creator": "pitilezard@gmail.com", "creation_time": "2006-06-07T07:06:46Z", "text": "I just put an attachement in order to show my problem !\n\nregards"}, {"count": 5, "tags": [], "bug_id": 38358, "attachment_id": null, "is_private": false, "id": 116455, "time": "2008-05-10T18:15:41Z", "creator": "josh@apache.org", "creation_time": "2008-05-10T18:15:41Z", "text": "As you mentioned YIELD() is not a standard function (it comes from the analysis toolpack).  Such functions need to be encoded with FuncVarPtg(ix=255) and a NameXPtg pointing to an external sheet. As of version 3.1, the formula parser does do this. Hopefully that will change in a release soon after.\n"}, {"count": 6, "tags": [], "bug_id": 38358, "attachment_id": null, "text": "This bug references a very old version of POI. As no new comments have been added in a long time, I'm assuming that this bug has now been fixed\n\nIf the bug still exists with the latest version of POI, please re-open the bug and add a comment indicating this, ideally also with a failing unit test", "id": 137304, "time": "2010-06-03T07:26:52Z", "creator": "apache@gagravarr.org", "creation_time": "2010-06-03T07:26:52Z", "is_private": false}]