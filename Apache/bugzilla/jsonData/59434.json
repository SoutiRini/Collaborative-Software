[{"attachment_id": null, "tags": [], "creator": "amanteaux+bzapache@gmail.com", "is_private": false, "count": 0, "id": 190751, "time": "2016-05-06T16:19:51Z", "bug_id": 59434, "creation_time": "2016-05-06T16:19:51Z", "text": "If a slide has a picture, it is possible to add a new picture on the slide using the code :\nbyte[] pictureData = IOUtils.toByteArray(new FileInputStream(\"image.png\"));\nXSLFPictureData pd = ppt.addPicture(pictureData, PictureData.PictureType.PNG);\nXSLFPictureShape pic = slide.createPicture(pd);\n\nHowever, if the picture already present on the slide have an hyperlink on it, the new picture cannot be added to the slide.\nHere is the stack trace generated:\nException in thread \"main\" org.apache.poi.POIXMLException: invalid package relationships\n\tat org.apache.poi.POIXMLDocumentPart.findExistingRelation(POIXMLDocumentPart.java:368)\n\tat org.apache.poi.POIXMLDocumentPart.addRelation(POIXMLDocumentPart.java:330)\n\tat org.apache.poi.xslf.usermodel.XSLFSheet.createPicture(XSLFSheet.java:226)\n\tat PoiTest.main(PoiTest.java:25)\nCaused by: org.apache.poi.openxml4j.exceptions.InvalidFormatException: Absolute URI forbidden: http://google.fr/test_poi\n\tat org.apache.poi.openxml4j.opc.PackagePartName.throwExceptionIfAbsoluteUri(PackagePartName.java:428)\n\tat org.apache.poi.openxml4j.opc.PackagePartName.throwExceptionIfInvalidPartUri(PackagePartName.java:177)\n\tat org.apache.poi.openxml4j.opc.PackagePartName.<init>(PackagePartName.java:85)\n\tat org.apache.poi.openxml4j.opc.PackagingURIHelper.createPartName(PackagingURIHelper.java:493)\n\tat org.apache.poi.openxml4j.opc.PackagePart.getRelatedPart(PackagePart.java:485)\n\tat org.apache.poi.POIXMLDocumentPart.findExistingRelation(POIXMLDocumentPart.java:362)\n\t... 3 more"}, {"count": 1, "tags": [], "creator": "kiwiwings@apache.org", "text": "Thanks for bringing this up.\nFixed with r1742816", "id": 190768, "time": "2016-05-08T13:29:45Z", "bug_id": 59434, "creation_time": "2016-05-08T13:29:45Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 59434, "attachment_id": null, "id": 190901, "creation_time": "2016-05-12T15:51:18Z", "time": "2016-05-12T15:51:18Z", "creator": "amanteaux+bzapache@gmail.com", "text": "Thank you for this fix!", "is_private": false}]