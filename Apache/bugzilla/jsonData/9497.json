[{"attachment_id": null, "tags": [], "bug_id": 9497, "text": "Old Bug #6841 was never addressed.\n\n\nA user reported a bug against mod_throttle claiming that mod_throttle failed to\nrecord the number of bytes sent when the request passed through mod_proxy. Apon\ndebugging and examination of the mod_proxy source, I found that \nap_proxy_send_fb() tracked and returned the number of bytes received/sent,\nbut that NO ONE made use of the return value to update the request_rec's\nbytes_sent field.\n\nFind enclosed a one line change to src/modules/proxy/proxy_util.c that updates\nthe request_rec.\n\nBy making the change in ap_proxy_send_fb(), http and ftp response from the\nremote server or from the cache will all correctly update the request_rec\nso that other modules can make use of this information in the logging phase. \n\nThis fix would be especially useful for mod_throttle and mod_watch.\n\n\n*** proxy_util.c.orig    Tue Nov 14 14:34:42 2000\n--- proxy_util.c    Tue Nov 14 14:49:25 2000\n***************\n*** 618,623 ****\n--- 618,626 ----\n      ap_bflush(con->client);\n\n      ap_kill_timeout(r);\n+\n+     r->bytes_sent += total_bytes_rcvd;\n+\n      return total_bytes_rcvd;\n  }", "count": 0, "id": 16879, "time": "2002-05-29T16:42:16Z", "creator": "achowe@snert.com", "creation_time": "2002-05-29T16:42:16Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 9497, "is_private": false, "count": 1, "id": 17066, "time": "2002-06-03T10:09:01Z", "creator": "minfrin@sharp.fm", "creation_time": "2002-06-03T10:09:01Z", "text": "This was committed earlier this week to CVS head - please test.\n"}]