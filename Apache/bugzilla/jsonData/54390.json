[{"count": 0, "tags": [], "text": "Installing Java 7 on OSX does not force Tomcat to use newly installed active JDK, instead it is still using the old .../CurrentJDK/Home mechanism.\n\n\nJava 7 Installation on OSX does not reside on conventional location on file system , which is being used by tomcat setclasspath.sh script. \nExcerpt from setclasspath.sh\n\nif [ -d \"/System/Library/Frameworks/JavaVM.framework/Versions/CurrentJDK/Home\" ];         \n   then\n   export     \n  JAVA_HOME=\"/System/Library/Frameworks/JavaVM.framework/Versions/CurrentJDK/Home\"\n\nSolution to the problem is to update setclasspath.sh script to ;\n\n    if [ -d \"$(/usr/libexec/java_home)\" ]; then\n      export JAVA_HOME=$(/usr/libexec/java_home)", "is_private": false, "id": 164491, "creation_time": "2013-01-08T18:13:08Z", "time": "2013-01-08T18:13:08Z", "creator": "zafarale@gmail.com", "bug_id": 54390, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 54390, "text": "> \n> Solution to the problem is to update setclasspath.sh script to ;\n> \n\nThe correct solution is to write your own setenv.sh script that sets JAVA_HOME or JRE_HOME variable as appropriate for your system,\nas documented in RUNNING.txt.\n\n\nI do not mind improving the auto-detection logic, but\n\n1. Do you have some official docs, regarding what JDK/JRE versions install where? Why one path and not the other? If there are several paths, what is the precedence in looking through them?\n\n2. Patches are to be provided in \"Unified diff\" format,\n\nhttp://tomcat.apache.org/bugreport.html#How_to_submit_patches_and_enhancement_requests", "id": 164492, "time": "2013-01-08T18:52:06Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2013-01-08T18:52:06Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "text": "IIRC, the correct and \"official\" (whatever that means) way of determining the JDK that has been set up as the default on Mac OS X is to run the command /usr/libexec/java_home. For example, on a system running Apple Java 6 and Java 7 OpenJDK and with Java 7 set as the default, I get this:\n\n$ /usr/libexec/java_home\n/Library/Java/JavaVirtualMachines/jdk1.7.0_07.jdk/Contents/Home\n$ `/usr/libexec/java_home`/bin/java -version\njava version \"1.7.0_07\"\nJava(TM) SE Runtime Environment (build 1.7.0_07-b10)\nJava HotSpot(TM) 64-bit Server VM (build 23.3-b01, mixed mode)\n\nOn a system with only Apple Java 6 instealled, I get this:\n\n$ /usr/libexec/java_home\n/System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home\n$ `/usr/libexec/java_home`/bin/java -version\njava version \"1.6.0_33\"\nJava(TM) SE Runtime Environment (build 1.6.0_33-b03-424-10M3720)\nJava HotSpot(TM) 64-bit Server VM (build 20.8-b03-424, mixed mode)\n\nIt took me a long time (hours) once upon a time to figure out how to correctly determine the default Java on Mac OS X, and this appears to be it. It would seem to me that, on Mac OS X, Tomcat should utilize the /usr/libexec/java_home command to determine JAVA_HOME when JAVA_HOME is not previously set. Just my $0.02.", "is_private": false, "id": 164493, "creator": "nicholas@nicholaswilliams.net", "time": "2013-01-08T19:15:25Z", "bug_id": 54390, "creation_time": "2013-01-08T19:15:25Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 54390, "attachment_id": null, "id": 164497, "time": "2013-01-08T20:44:05Z", "creator": "chris@christopherschultz.net", "creation_time": "2013-01-08T20:44:05Z", "is_private": false, "text": "(In reply to comment #2)\n> IIRC, the correct and \"official\" (whatever that means) way of determining\n> the JDK that has been set up as the default on Mac OS X is to run the\n> command /usr/libexec/java_home\n\n+1\n\nI'm not sure how far back in history this command goes, though. For instance, does 10.0.0 include it? The man page does not include any version information for the utility itself (at least on 10.8.2).\n\nIt's definitely worth checking for /usr/libexec/java_home and using it if it's there, though.\n\nFor those who don't know, 'java_home' allows multiple JVM versions to be installed side-by-side and the user may choose which one she wants for which purposes. I don't see a reason not to use the standard \"use the user's current top-preference JVM\" which is the default operation of 'java_home'."}, {"count": 4, "tags": [], "bug_id": 54390, "attachment_id": null, "id": 164504, "time": "2013-01-08T22:00:43Z", "creator": "zafarale@gmail.com", "creation_time": "2013-01-08T22:00:43Z", "is_private": false, "text": "Apple documentation suggests using /java_home utility to determine the JAVA_HOME\n\nhttp://developer.apple.com/library/mac/#qa/qa1170/_index.html\n\nit suggests as \n\n\"Another advantage of dynamically finding this path, as opposed to hardcoding the fixed endpoint, is that it is updated when a new version of Java...\"\n\nOracle also relying/using on the existing mechanism as they suggest using it at\n\nhttp://docs.oracle.com/javase/7/docs/webnotes/install/mac/mac-install-faq.html\n\neven though they suggested how to continue to use older apple versions of JDK\n\nexecuting /usr/libexec/java_home -X suggest that it maintains the plist for all installed jdk frameworks in osx terms.\n\nOther benifit of using java_home utlility, is its always available as i like to run tomcat via launchd, and i m sure all osx server installations will do"}, {"count": 5, "tags": [], "bug_id": 54390, "is_private": false, "text": "Worth mentioning: this is an improvement to bug #37284.", "id": 164505, "time": "2013-01-08T22:05:07Z", "creator": "chris@christopherschultz.net", "creation_time": "2013-01-08T22:05:07Z", "attachment_id": null}, {"text": "Fixed in trunk and 7.0.x. Will be in Tomcat 7.0.35.\n\nProposed for 6.0.x.", "tags": [], "bug_id": 54390, "is_private": false, "count": 6, "id": 164506, "time": "2013-01-08T22:12:08Z", "creator": "chris@christopherschultz.net", "creation_time": "2013-01-08T22:12:08Z", "attachment_id": null}, {"count": 7, "tags": [], "text": "just for knowledge, as i am bit knew to apache bugzilla. last comment does that mean proposed changes has been accepted", "attachment_id": null, "id": 164507, "creator": "zafarale@gmail.com", "time": "2013-01-08T22:18:09Z", "bug_id": 54390, "creation_time": "2013-01-08T22:18:09Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 54390, "attachment_id": null, "id": 164510, "time": "2013-01-08T22:32:11Z", "creator": "chuck.caldarale@unisys.com", "creation_time": "2013-01-08T22:32:11Z", "is_private": false, "text": "(In reply to comment #7)\n> just for knowledge, as i am bit knew to apache bugzilla. last comment does\n> that mean proposed changes has been accepted\n\nIt has been accepted for 7.0.x and 8.0, but still needs to be voted on for 6.0.x."}, {"count": 9, "tags": [], "text": "Thnaks", "is_private": false, "bug_id": 54390, "id": 164511, "time": "2013-01-08T22:50:19Z", "creator": "zafarale@gmail.com", "creation_time": "2013-01-08T22:50:19Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 54390, "text": "Fixed in Tomcat 6.0.x. Will be in 6.0.37.", "count": 10, "id": 164597, "time": "2013-01-12T01:38:43Z", "creator": "chris@christopherschultz.net", "creation_time": "2013-01-12T01:38:43Z", "is_private": false}]