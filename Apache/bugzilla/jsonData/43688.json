[{"count": 0, "tags": [], "bug_id": 43688, "attachment_id": null, "text": "Steps to Reproduce: \n1 - create a new visio file\n2 - modify its title with an application using poi like \"WriteTitle.java\" (poi\nexample)\n3 - open the document with visio and save it (don't modify the title).\n\nActual Results: \nthe document title is gone.\n\nExpected Results:\nthe title should be the same title modified by step one.\n\nI am using visio 2002 sp-2 - 10.0.6865\npoi-3.0.1-FINAL\n\ndescription:\n\nI modify visio document properties through poi( title,author, custom\nproperties...), everything looks fine.\nIf I modify the same document via visio application or via windows, the document\nentries are inverted VisioInformation(1st) et VisioDocument(2nd) then every\nproperties are lost (title...) and sometimes the document becomes unreadable.\n\nI check an original visio document with PoiBrowser, VisioInformation shoulb be\nbefore VisioDocument but if a document is modified via my application(poi)\nVisioDocument is before VisioInformation.\n\nI also tried with the example code \"WriteTitle.java\", it is the same result.", "id": 109691, "time": "2007-10-24T05:09:45Z", "creator": "fathi.nemeur@sacem.fr", "creation_time": "2007-10-24T05:09:45Z", "is_private": false}, {"count": 1, "tags": [], "creator": "fathi.nemeur@sacem.fr", "text": "Created attachment 21033\nPoiBowser view of the Document entries of an original visio and a corrupted one", "id": 109692, "time": "2007-10-24T05:14:37Z", "bug_id": 43688, "creation_time": "2007-10-24T05:14:37Z", "is_private": false, "attachment_id": 21033}, {"count": 2, "tags": [], "creator": "fathi.nemeur@sacem.fr", "attachment_id": 21034, "id": 109694, "time": "2007-10-24T05:17:32Z", "bug_id": 43688, "creation_time": "2007-10-24T05:17:32Z", "is_private": false, "text": "Created attachment 21034\nOriginal document.\r\nproperties modified\n\nif this file is saved via visio application, every properties disapeared"}, {"count": 3, "tags": [], "creator": "klute@apache.org", "text": "The order of entries in the property set doesn't matter. Properties are\nidentified by name. The so-called \"corrupted\" file looks not quite, but rather\ngood. At least the title is there.\n\nAnyway, if something is wrong with the properties after Vision wrote them, that\nlooked like a bug in Visio, not in HPSF.", "id": 109709, "time": "2007-10-24T11:12:00Z", "bug_id": 43688, "creation_time": "2007-10-24T11:12:00Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "fathi.nemeur@sacem.fr", "text": "First of all, thank you for checking my bug.\nI agree with you visio application is not bug free.\n\nAnyway, the problem happens only when a visio file is modified by HPSF.\nThe only difference noticed between a \"no-problem\" file and \"problem\" file is \nthe order of the document entries.\n\nIf you open and save the file in attachment with visio application, the title \nwill disappear.\n\nIs there anyway to force the order of \"VisioInformation\" and \"VisioDocument\" \ndocument entries.\n\nThank you\n\nnote : I wrote \"corrupted\" because I don't find any other that really fit the \nnature of the document.\n\n\n\n(In reply to comment #0)\n> Steps to Reproduce: \n> 1 - create a new visio file\n> 2 - modify its title with an application using poi like \"WriteTitle.java\" (poi\n> example)\n> 3 - open the document with visio and save it (don't modify the title).\n> Actual Results: \n> the document title is gone.\n> Expected Results:\n> the title should be the same title modified by step one.\n> I am using visio 2002 sp-2 - 10.0.6865\n> poi-3.0.1-FINAL\n> description:\n> I modify visio document properties through poi( title,author, custom\n> properties...), everything looks fine.\n> If I modify the same document via visio application or via windows, the \ndocument\n> entries are inverted VisioInformation(1st) et VisioDocument(2nd) then every\n> properties are lost (title...) and sometimes the document becomes unreadable.\n> I check an original visio document with PoiBrowser, VisioInformation shoulb be\n> before VisioDocument but if a document is modified via my application(poi)\n> VisioDocument is before VisioInformation.\n> I also tried with the example code \"WriteTitle.java\", it is the same result.\n\n(In reply to comment #3)\n> The order of entries in the property set doesn't matter. Properties are\n> identified by name. The so-called \"corrupted\" file looks not quite, but rather\n> good. At least the title is there.\n> Anyway, if something is wrong with the properties after Vision wrote them, \nthat\n> looked like a bug in Visio, not in HPSF.\n\n(In reply to comment #3)\n> The order of entries in the property set doesn't matter. Properties are\n> identified by name. The so-called \"corrupted\" file looks not quite, but rather\n> good. At least the title is there.\n> Anyway, if something is wrong with the properties after Vision wrote them, \nthat\n> looked like a bug in Visio, not in HPSF.\n\n", "id": 109725, "time": "2007-10-25T00:32:35Z", "bug_id": 43688, "creation_time": "2007-10-25T00:32:35Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "text": "Created attachment 21065\nopen and saved document\n\nThis is the same document.It was only opened and saved with.\nEvery properties are gone.You can compare with the original document in\nattachment.", "attachment_id": 21065, "bug_id": 43688, "id": 110028, "time": "2007-10-31T06:16:15Z", "creator": "fathi.nemeur@sacem.fr", "creation_time": "2007-10-31T06:16:15Z", "is_private": false}, {"count": 6, "tags": [], "creator": "fathi.nemeur@sacem.fr", "attachment_id": 21034, "id": 110029, "time": "2007-10-31T06:17:39Z", "bug_id": 43688, "creation_time": "2007-10-31T06:17:39Z", "is_private": false, "text": "Comment on attachment 21034\nOriginal document.\r\nproperties modified\n\nthe properties were modified using hpsf"}, {"count": 7, "tags": [], "creator": "klute@apache.org", "text": "In order to make this issue researchable you should submit the following:\n* the original file as created by Vision,\n* the file as modified by HPSF,\n* a JUnit test case exhibiting the faulty behaviour.", "id": 110071, "time": "2007-10-31T12:07:11Z", "bug_id": 43688, "creation_time": "2007-10-31T12:07:11Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "creator": "fathi.nemeur@sacem.fr", "attachment_id": 21086, "id": 110241, "time": "2007-11-05T06:21:05Z", "bug_id": 43688, "creation_time": "2007-11-05T06:21:05Z", "is_private": false, "text": "Created attachment 21086\nthe original file as created by Visio"}, {"count": 9, "tags": [], "creator": "fathi.nemeur@sacem.fr", "attachment_id": 21087, "id": 110242, "time": "2007-11-05T06:22:40Z", "bug_id": 43688, "creation_time": "2007-11-05T06:22:40Z", "is_private": false, "text": "Created attachment 21087\nthe file as modified by HPSF\n\nI modified the title and some customProperties by HPSF"}, {"count": 10, "tags": [], "bug_id": 43688, "attachment_id": 21088, "text": "Created attachment 21088\nthe HPSF modifed file edited and saved by Visio\n\nthe properties and the title are unavailable.", "id": 110243, "time": "2007-11-05T06:25:42Z", "creator": "fathi.nemeur@sacem.fr", "creation_time": "2007-11-05T06:25:42Z", "is_private": false}, {"count": 11, "tags": [], "bug_id": 43688, "attachment_id": 21089, "text": "Created attachment 21089\nJUnit test case exhibiting the faulty behaviour\n\nI used your example code source to modify the title and custom properties of a\ndocument", "id": 110244, "time": "2007-11-05T06:28:35Z", "creator": "fathi.nemeur@sacem.fr", "creation_time": "2007-11-05T06:28:35Z", "is_private": false}, {"count": 12, "tags": [], "creator": "fathi.nemeur@sacem.fr", "text": "You can find in attachment:\n - The original vsd file \"document.vsd\" (id = 21086).\n - The same document modified with HPSF (id = 21087).The title was modified and\n   some custom properties.When you open this everything seems fine.\n - The document edited and saved with visio(id = 21088).The title and \n   custom properties are lost.\n - The JUnit class (id = 21089)I used to modify the original document.It includes\n   a poi example method.\n\n", "id": 110257, "time": "2007-11-06T03:17:36Z", "bug_id": 43688, "creation_time": "2007-11-06T03:17:36Z", "is_private": false, "attachment_id": null}, {"count": 13, "tags": [], "bug_id": 43688, "attachment_id": null, "text": "Thanks for the info you provided! Now if I only could find some time to have a\nlook at them...", "id": 110258, "time": "2007-11-06T03:41:15Z", "creator": "klute@apache.org", "creation_time": "2007-11-06T03:41:15Z", "is_private": false}]