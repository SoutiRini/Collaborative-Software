[{"count": 0, "tags": [], "bug_id": 51870, "attachment_id": 27567, "is_private": false, "id": 149638, "time": "2011-09-22T16:09:11Z", "creator": "hannes@erven.at", "creation_time": "2011-09-22T16:09:11Z", "text": "Created attachment 27567\nPatch.\n\nI need to detect whether a given HSSFSheet already has DataValidation settings applied.\nThe DataValidityTable class already has a visitContainedRecords(RecordVisitor) method, that is currently inaccessible from both HSSFSheet and user code.\n\nThe following patch suggests to add a method \n\npublic void visitValidationData(RecordVisitor rv)\n\nto HSSFSheet to iterate through the DataValidation records.\nUse it like this:\n\nfinal RecordVisitor rv = new RecordVisitor() {\n  @Override\n  public void visitRecord(Record r) {\n    if (r instanceof DVRecord){\n      final DVRecord dr = (DVRecord) r;\n      // So there's the validation\n      if (dr.getDataType() == ValidationType.LIST){\n           // There is a DROP DOWN list! Use dr.* to examine location and content.\n      }\n    }\n  }\n};\nsheet.visitValidationData(rv);\n\n\n\nThe XSSFSheet already provides a getDataValidations() method,"}, {"count": 1, "tags": [], "text": "Unfortunately the path in its current form cannot be applied.\n\nHSSF does not expose classes for internal use: there are no getters that return record.* or model.* objects, these are hidden and it is by design. \n\nThink about implementing getDataValidations() in HSSFSheet. That would be cool and this method will go to the interface:\n\nIn the Sheet interface we will have  List<DataValidation> getDataValidations() \n\nand two implementations:\n\n List<HSSHDataValidation> getDataValidations()  \n List<XSSFDataValidation> getDataValidations() \n\nRegards,\nYegor", "is_private": false, "id": 170854, "creator": "yegor@dinom.ru", "time": "2013-10-26T10:38:46Z", "bug_id": 51870, "creation_time": "2013-10-26T10:38:46Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 51870, "attachment_id": null, "is_private": false, "id": 183221, "time": "2015-05-31T21:58:08Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-05-31T21:58:08Z", "text": "This method is available since some time already, therefore resolving this as FIXED."}]