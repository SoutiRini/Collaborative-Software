[{"count": 0, "tags": [], "text": "[reported by Luca Martini] <luca.martini@iet.unipi.it>\n\nIt seems that I found a minor inaccuracy in an error message.\n\nin org.apache.bcel.verifier.structurals.InstConstraintVisitor.java you wrote:\n\n\n\tpublic void visitPUTFIELD(PUTFIELD o){\n\t\n\t[snip]\n\n\t\tif (! ( objreftype.equals(curr) ||\n\t\t\t\t\t\t    objreftype.subclassOf(curr) ) ){\n\t\t\t\t\tconstraintViolated(o, \"The referenced field has the\nACC_PROTECTED modifier, and it's a member of the current class or a superclass\nof the current class. However, the referenced object type '\"+stack().peek()+\"'\nis not the current class or a subclass of the current class.\");\t\t\t\t}\n\t\t\t} \n\t\t}\n\nbut I think the referenced object type is not at the top of the stack but,\nnext to it.\n\nHowever, even if this check is done only on protected field (as stated in\nvmspec) the Standard Verifier checks it even for public fields (and it seems\nreasonable). You can try the stupid enclosed example (in Jasmin syntax): in this\ncase I substituted the putfield object reference of type with a reference of\ntype B. JustIce signals no error while the native verifier reports:\n\nException in thread \"main\" java.lang.VerifyError: (class: A, method: m\nsignature: (ILB;)V) Incompatible type for getting or setting field", "is_private": false, "id": 46660, "creator": "ehaase@inf.fu-berlin.de", "time": "2003-11-03T10:51:51Z", "bug_id": 24350, "creation_time": "2003-11-03T10:51:51Z", "attachment_id": null}, {"count": 1, "text": "So you are saying the refrence is the second on the stack and we should only check on protected fields?", "creator": "tcurdt@apache.org", "is_private": false, "id": 86369, "time": "2006-03-02T03:27:06Z", "bug_id": 24350, "creation_time": "2006-03-02T03:27:06Z", "tags": [], "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 24350, "attachment_id": null, "is_private": false, "id": 86678, "time": "2006-03-10T13:23:31Z", "creator": "tcurdt@apache.org", "creation_time": "2006-03-10T13:23:31Z", "text": "\n\n*** This bug has been marked as a duplicate of 24351 ***"}]