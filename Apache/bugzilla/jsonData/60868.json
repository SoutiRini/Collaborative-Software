[{"count": 0, "tags": [], "bug_id": 60868, "attachment_id": null, "id": 197676, "time": "2017-03-15T11:06:49Z", "creator": "guarale@hotmail.com", "creation_time": "2017-03-15T11:06:49Z", "is_private": false, "text": "If I call CTRow#isSetCustomHeight() on a row tag which has customHeight=\"false\"  the method call actually returns true.\n\nECMA 376 specifications (on 18.3.1.73) say that the possible values for attribute \"customHeight\" of \"row\" node are defined by the W3C XML Schema boolean datatype so both \"0\" and \"false\" values should be accepted.\n\nPlease note that Microsoft Excel writes \"1\" for \"true\" and removes the attribute for \"false\": in both cases CTRow#isSetCustomHeight() works fine,  whereas CTRow#setCustomHeight(false) actually writes \"false\", which is not properly recognized by CTRow#isSetCustomHeight()."}, {"count": 1, "tags": [], "text": "Thr CTRow class is generated from the OOXML XSD schemas. So the bug is XSSFRow or other XSSF class not comparing CTRow.isSetCustomHeight against all valid boolean values.\n\nIf you have the time to find the offending XSSF classes and write a patch, it'd be greatly appreciated!", "attachment_id": null, "id": 197682, "creator": "onealj@apache.org", "time": "2017-03-15T14:26:45Z", "bug_id": 60868, "creation_time": "2017-03-15T14:26:45Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 60868, "attachment_id": null, "id": 197803, "time": "2017-03-19T12:00:15Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2017-03-19T12:00:15Z", "is_private": false, "text": "I did take a look, \n\nthe generated isSetCustomHeight() actually does the following:\n\n            return this.get_store().find_attribute_user(CUSTOMHEIGHT$16) != null;\n\nso it returns true if the attribute appears in the XML.\n\nThe only place where POI itself uses isSetCustomHeight() is during clearing the manually set height, where a general isSet-call makes sense to use the default that is applied when the flag is not set at all.\n\nSo I currently don't see much that can be done inside Apache POI here, please reopen the bug with more suggestions if you disagree."}, {"count": 3, "tags": [], "creator": "guarale@hotmail.com", "attachment_id": null, "text": "I probably have misunanderstood the meaning of isSetCustomHeight().\nIt seems that the method I looked for was getCustomHeight().\n\nSince in Java boolean getters do not usually starts with \"get\" I have got confused by \"isSet...\".\n\nUnfortunately, since these classes are autogenerated, patching with better naming or clear javadoc is not possible.\n\nThanks for your answer and sorry again.", "id": 197830, "time": "2017-03-20T14:00:26Z", "bug_id": 60868, "creation_time": "2017-03-20T14:00:26Z", "is_private": false}]