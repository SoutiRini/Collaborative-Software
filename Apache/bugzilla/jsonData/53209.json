[{"count": 0, "tags": [], "bug_id": 53209, "attachment_id": null, "text": "Having a 3250 rows x 10 cells for each row seem to be the limit the number of styles.\n\n3500 x 10 breaks the excel file. \n\nAttached is a set of files/code to replicate the issue.", "id": 158935, "time": "2012-05-09T19:32:09Z", "creator": "awm@mbcli.com", "creation_time": "2012-05-09T19:32:09Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 53209, "attachment_id": 28750, "text": "Created attachment 28750\njava code and excel template to reproduce the error", "id": 158936, "time": "2012-05-09T19:34:06Z", "creator": "awm@mbcli.com", "creation_time": "2012-05-09T19:34:06Z", "is_private": false}, {"count": 2, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 158940, "time": "2012-05-09T21:35:04Z", "bug_id": 53209, "creation_time": "2012-05-09T21:35:04Z", "is_private": false, "text": "In HSSF, we have a maximum number of styles, and throw an exception if someone tries to add more than that\n\n    /**\n     * The maximum number of cell styles in a .xls workbook.\n     * The 'official' limit is 4,000, but POI allows a slightly larger number.\n     * This extra delta takes into account built-in styles that are automatically\n     * created for new workbooks\n     *\n     * See http://office.microsoft.com/en-us/excel-help/excel-specifications-and-limits-HP005199291.aspx\n     */\n    private static final int MAX_STYLES = 4030;\n\nThe .xlsx file format also has a maximum number of styles, but it doesn't look like we enforce that in the same way. From a quick check, neither XSSFWorkbook.createCellStyle() nor StylesTable appears to have the check\n\nThe fix is probably for someone to dig out the official maximum number of styles in a .xlsx file, from the file format docs, then implement a similar check in xssf"}, {"count": 3, "tags": [], "bug_id": 53209, "attachment_id": null, "id": 161159, "time": "2012-08-07T19:00:49Z", "creator": "nkruizinga@gmail.com", "creation_time": "2012-08-07T19:00:49Z", "is_private": false, "text": "According to http://msdn.microsoft.com/en-us/library/office/ff700514.aspx the maximum number of styles for Excel 2010 is 64000 ."}, {"count": 4, "tags": [], "bug_id": 53209, "attachment_id": null, "text": "We have fixed the checks for the limits as part of bug 58260, see r1696586, I think this one should be fixed as well through this, please report a new bug with sample code if you still run into problems. But note that usually styles should be re-used if possible as there are hard limits of how many styles Excel will accept.\n\n*** This bug has been marked as a duplicate of bug 58260 ***", "id": 184949, "time": "2015-09-03T19:28:40Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-09-03T19:28:40Z", "is_private": false}]