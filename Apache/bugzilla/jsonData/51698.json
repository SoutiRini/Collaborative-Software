[{"count": 0, "attachment_id": 27416, "creator": "zhh200910@gmail.com", "text": "Created attachment 27416\najp CPing packet forgery example\n\nbecause the ajp \"Data\" packet no \"CodeType\"\nand tomcat adopts lazy-reading strategy for reading ajp \"Data\" packet\uff0c\n(i.e., if you don't invoke request.getParameter(\"XXX\")\uff0ctomcat does't read post request \"Data\" packet)\n\nso\uff0cthe current \"Data\" packet keeping in the socket inputstream\uff0c\nthe connection is keep-alive, ajp bio/nio procesor reading the next packet\uff0c\nthis time, is \"Data\" packet\u3002\n\nif the first byte of \"Data\" packet'length is 0x02(Code Type of Forward Request Packet) or 0x0A(Code Type of CPing Packet)\uff0c\nthen tomcat will be in trouble.\n\nplease see the attachments.\n\nfirt example: ajp CPing packet forgery example\n\nsecond example: ajp Forward-Request packet forgery", "id": 148724, "time": "2011-08-20T07:54:08Z", "bug_id": 51698, "creation_time": "2011-08-20T07:54:08Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 51698, "text": "Created attachment 27417\najp Forward-Request packet forgery\n\nsecond example: ajp Forward-Request packet forgery", "id": 148725, "time": "2011-08-20T07:55:51Z", "creator": "zhh200910@gmail.com", "creation_time": "2011-08-20T07:55:51Z", "is_private": false, "attachment_id": 27417}, {"count": 2, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "is_private": false, "id": 148905, "time": "2011-08-29T19:45:57Z", "bug_id": 51698, "creation_time": "2011-08-29T19:45:57Z", "text": "This issue has been allocated CVE-2011-3190.\n\nThe Tomcat security team strongly discourages the reporting of potential security vulnerabilities via public channels such as this issue tracker. Potential security vulnerabilities should be reported privately to security@tomcat.apache.org\n\nThis issue has been fixed in trunk, 7.0.x, 6.0.x and 5.5.x and will be included in 7.0.21, 6.0.34 and 5.5.34 onwards."}, {"count": 3, "tags": [], "creator": "edwardquick@hotmail.com", "attachment_id": null, "is_private": false, "id": 148974, "time": "2011-09-02T10:35:50Z", "bug_id": 51698, "creation_time": "2011-09-02T10:35:50Z", "text": "Hi there, I was testing this out to see if my site was vulnerable and got the following results. I'm not sure looking at the code comments in ForwardRequestForgeryExample.java if the output below means it's vulnerable and what exactly that exploited. Could you help me out a bit please?\n\nThanks,\nEd.\n\nC:>java -cp . ForwardRequestForgeryExample\nSending AJP Forward-Request Packet...\nEnd\n\n$ tail -f catalina.out\nInvoke HelloWorldExample.doPost method:\n-------------------------------------------\nHost: my.evil-site.com\nRemoteAddr: 1.2.3.4\nLocalPort: 999\nwoo: I am here"}, {"count": 4, "attachment_id": null, "creator": "markt@apache.org", "text": "Bugzilla is not a support forum. Please use the users mailing list.", "id": 148975, "time": "2011-09-02T10:49:16Z", "bug_id": 51698, "creation_time": "2011-09-02T10:49:16Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "bug_id": 51698, "text": "Sorry about that. Will do.", "id": 148984, "time": "2011-09-02T13:04:04Z", "creator": "edwardquick@hotmail.com", "creation_time": "2011-09-02T13:04:04Z", "is_private": false, "attachment_id": null}]