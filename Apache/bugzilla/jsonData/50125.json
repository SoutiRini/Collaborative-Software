[{"count": 0, "tags": [], "creator": "ndhai77@yahoo.com", "text": "Hi\nI DON'T know if it is a BUG or we did something wrong ...\nI am using jk mod 1.2.26, Tomcat 5.5, Apache 2\nJVM Sun 1.6.0_12-b04, OS Debian\n\nworkers.properties:\nworkers.tomcat_home=/usr/share/tomcat5.5\nworkers.java_home=/usr/lib/jvm/java-6-sun\n\nps=/\nworker.list=worker1\nworker.worker1.port=8009\nworker.worker1.host=localhost\nworker.worker1.type=ajp13\nworker.worker1.lbfactor=1 \n\n\nIt works ALMOST ok but when I hit ANY exception, for ex, java.lang.NullPointerException, http doesn't reponse anymore. We have to restart Tomcat+Apache\n\nSorry for log in french:\n\nlocalhost log (tomcat)\n14 oct. 2010 23:40:20 org.apache.catalina.core.StandardWrapperValve invoke\nGRAVE: \"Servlet.service()\" pour la servlet jsp a g\u00e9n\u00e9r\u00e9 une exception\njava.lang.NullPointerException  \n\nacces.log (Apache)\nxyz.com:80 ip - - [14/Oct/2010:23:40:20 +0200] \"GET /xyz/jsp/test.jsp?p=test HTTP/1.1\" 500 3046 \"-\" \"\"\nxyz.com:80 ip - - [14/Oct/2010:23:44:41 +0200] \"GET /xyz/jsp/test.jsp?p=test HTTP/1.1\" 503 417 \"-\" \"\"\n\nerror.log (Apache)\n[Thu Oct 14 23:40:33 2010] [notice] caught SIGTERM, shutting down\n[Thu Oct 14 23:41:34 2010] [notice] Apache/2.2.9 (Debian) mod_jk/1.2.26 configured -- resuming normal operations\n[Thu Oct 14 23:45:03 2010] [notice] caught SIGTERM, shutting down\n[Thu Oct 14 23:45:04 2010] [notice] Apache/2.2.9 (Debian) mod_jk/1.2.26 configured -- resuming normal operations\n[Thu Oct 14 23:45:33 2010] [notice] caught SIGTERM, shutting down\n\nmod_jk.log (apache)\nThu Oct 14 23:37:03 2010]worker1 192.168.163.113 15.249507\n[Thu Oct 14 23:40:20 2010]worker1 192.168.163.113 0.058192\n[Thu Oct 14 23:41:34 2010][2281:2233493328] [info] init_jk::mod_jk.c (2830): mod_jk/1.2.26 initialized\n[Thu Oct 14 23:41:34 2010][2282:2233493328] [info] init_jk::mod_jk.c (2830): mod_jk/1.2.26 initialized\n[Thu Oct 14 23:44:41 2010][2286:1086212432] [info] jk_open_socket::jk_connect.c (566): connect to 127.0.0.1:8009 failed (errno=111)\n[Thu Oct 14 23:44:41 2010][2286:1086212432] [info] ajp_connect_to_endpoint::jk_ajp_common.c (869): Failed opening socket to (127.0.0.1:8009) (errno=111)\n[Thu Oct 14 23:44:41 2010][2286:1086212432] [error] \n\ncatalina (tomcat)\n14 oct. 2010 23:40:33 org.apache.coyote.http11.Http11BaseProtocol pause\nINFO: Suspension de Coyote HTTP/1.1 sur http-8180\n14 oct. 2010 23:43:42 org.apache.catalina.connector.Connector pause\nGRAVE: La suspension du gestionnaire de protocole a \u00e9chou\u00e9e\njava.net.ConnectException: Connection timed out \n\nOthers tests: divise by zero, or use an objet no declare => the same pb\n\n\nAnyone has the same pb ?\nthanks", "id": 140864, "time": "2010-10-20T12:26:49Z", "bug_id": 50125, "creation_time": "2010-10-20T12:26:49Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "rainer.jung@kippdata.de", "text": "Bugzilla is not a support forum. Plese post your questions to the Tomcat users list, or the Apache Web Server users list.\n\nTo subscribe, send mail to\n\n   users-subscribe@tomcat.apache.org\n\nor\n\n   users-subscribe@httpd.apache.org\n\nNevertheless here are some remarks that might be helpful. Please don't answer here but take the discussion to one of the lists.\n\n> It works ALMOST ok but when I hit ANY exception, for ex,\n> java.lang.NullPointerException, http doesn't reponse anymore. We have to\n> restart Tomcat+Apache\n\nThat's pretty strange, but ...\n\n> Sorry for log in french:\n\n... your logs speak a different language (assuming clocks are in sync):\n\nOrdered by timestamp:\n\nApache receives request, responds with 500:\n\nxyz.com:80 ip - - [14/Oct/2010:23:40:20 +0200] \"GET /xyz/jsp/test.jsp?p=test\nHTTP/1.1\" 500 3046 \"-\" \"\"\n\nmod_jk logs the request, it tool 0.05 seconds\n\n[Thu Oct 14 23:40:20 2010]worker1 192.168.163.113 0.058192\n\nand the reason for the status 500 is\n\n14 oct. 2010 23:40:20 org.apache.catalina.core.StandardWrapperValve invoke\nGRAVE: \"Servlet.service()\" pour la servlet jsp a g\u00e9n\u00e9r\u00e9 une exception\njava.lang.NullPointerException  \n\n\n13 seconds later someone tells Apache to shut down\n\n[Thu Oct 14 23:40:33 2010] [notice] caught SIGTERM, shutting down\n\n... and someone tells Tomcat to shutdown:\n\n14 oct. 2010 23:40:33 org.apache.coyote.http11.Http11BaseProtocol pause\nINFO: Suspension de Coyote HTTP/1.1 sur http-8180\n\nbut this shutdown hangs ...\n\nStarting up Apache again\n\n[Thu Oct 14 23:41:34 2010] [notice] Apache/2.2.9 (Debian) mod_jk/1.2.26\nconfigured -- resuming normal operations\n\nmod_jk loggs it initialized after the startup\n[Thu Oct 14 23:41:34 2010][2281:2233493328] [info] init_jk::mod_jk.c (2830):\nmod_jk/1.2.26 initialized\n[Thu Oct 14 23:41:34 2010][2282:2233493328] [info] init_jk::mod_jk.c (2830):\nmod_jk/1.2.26 initialized\n\nNow Tomcat proceeds shutting down\n\n14 oct. 2010 23:43:42 org.apache.catalina.connector.Connector pause\nGRAVE: La suspension du gestionnaire de protocole a \u00e9chou\u00e9e\njava.net.ConnectException: Connection timed out \n\nAnother request comes in, answered with 503\n\nxyz.com:80 ip - - [14/Oct/2010:23:44:41 +0200] \"GET /xyz/jsp/test.jsp?p=test\nHTTP/1.1\" 503 417 \"-\" \"\"\n\nRight, mod_jk says it couldn't connect to Tomcat\n\n[Thu Oct 14 23:44:41 2010][2286:1086212432] [info] jk_open_socket::jk_connect.c\n(566): connect to 127.0.0.1:8009 failed (errno=111)\n[Thu Oct 14 23:44:41 2010][2286:1086212432] [info]\najp_connect_to_endpoint::jk_ajp_common.c (869): Failed opening socket to\n(127.0.0.1:8009) (errno=111)\n[Thu Oct 14 23:44:41 2010][2286:1086212432] [error] \n\nand that's what we expect, since someone shut it down.\n\n22 seconds later Apache gets shut down again:\n\n[Thu Oct 14 23:45:03 2010] [notice] caught SIGTERM, shutting down\n[Thu Oct 14 23:45:04 2010] [notice] Apache/2.2.9 (Debian) mod_jk/1.2.26\nconfigured -- resuming normal operations\n[Thu Oct 14 23:45:33 2010] [notice] caught SIGTERM, shutting down\n\nIf you don't know who shuts down the components all the time, maybe someone implemented a clever log file monitoring and some automatism outside of Apache and Tomcat does it?\n\nRegards,\n\nRainer", "id": 140865, "time": "2010-10-20T13:13:21Z", "bug_id": 50125, "creation_time": "2010-10-20T13:13:21Z", "is_private": false, "attachment_id": null}]