[{"count": 0, "text": "Hi, this is my xls\n  A      B\n1 Cost   Amount\n2 T1     20\n3 T2     30\n4 T3     20\n5 Total  =B2+B3+B4 \n\n\nThis is the java code,XLTest.java. Here I am reading B3 , changing its value to \n100, and writing back the xls to see if B5 gives the right aggregate. \nUnfortunately i get a NullPointerException and also the xls file turns empty. I \nam including the stacktrace below. It would be very helpful if you can fix this \nor tell a work around.\n\nPOIFSFileSystem fs      =\n\t\t\t\tnew POIFSFileSystem(new FileInputStream\n(\"costpool.xls\"));\n\tHSSFWorkbook wb = new HSSFWorkbook(fs);\n\tHSSFSheet sheet = wb.getSheetAt(0);\n\tHSSFRow row1 = sheet.getRow(2);\n\tHSSFCell cell1 = row1.getCell((short)1);\n\n\tHSSFRow row2 = sheet.getRow(4);\n\tHSSFCell cell2 = row2.getCell((short)1);\n\n\tSystem.out.println(\"original values\");\n\n\n\tSystem.out.println(cell1.getNumericCellValue());\n\tSystem.out.println(cell2.getNumericCellValue());\n\n\tSystem.out.println(\"ok.....am changing the above values\");\n\n\tdouble num = 100;\n\tcell1.setCellValue(num);\t\n\n\tSystem.out.println(cell1.getNumericCellValue());\n\tSystem.out.println(cell2.getNumericCellValue());\n\n\n\n\t// Write the output to a file\n    FileOutputStream fileOut = new FileOutputStream(\"costpool.xls\");\n    wb.write(fileOut);\n    fileOut.close();\n\n\nStackTrace\n----------\n\nException in thread \"main\" java.lang.NullPointerException\n        at org.apache.poi.hssf.record.FormulaRecord.getTotalPtgSize\n(FormulaRecord.java:363)\n        at org.apache.poi.hssf.record.FormulaRecord.serialize\n(FormulaRecord.java:335)\n        at org.apache.poi.hssf.record.aggregates.ValueRecordsAggregate.serialize\n(ValueRecordsAggregate.java:174)\n        at org.apache.poi.hssf.model.Sheet.serialize(Sheet.java:584)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.getBytes\n(HSSFWorkbook.java:513)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.write\n(HSSFWorkbook.java:465)\n        at XLTest.main(XLTest.java:41)", "bug_id": 8542, "is_private": false, "id": 14818, "time": "2002-04-26T07:37:30Z", "creator": "maney_pal@yahoo.com", "creation_time": "2002-04-26T07:37:30Z", "tags": [], "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 8542, "is_private": false, "id": 14829, "attachment_id": null, "creator": "poi-support@buni.org", "creation_time": "2002-04-26T12:20:17Z", "time": "2002-04-26T12:20:17Z", "text": "please check against the CVS head.  We'll be putting out a new release candidate\nshortly.  Experimental formula parsing will be properly disabled."}, {"count": 2, "attachment_id": null, "creator": "poi-support@buni.org", "is_private": false, "id": 15860, "time": "2002-05-10T02:34:04Z", "bug_id": 8542, "creation_time": "2002-05-10T02:34:04Z", "tags": [], "text": "Please test this against the CVS head or a nightly build -- we've added formula\nsupport that should handle this."}, {"count": 3, "tags": [], "bug_id": 8542, "attachment_id": null, "is_private": false, "id": 17626, "time": "2002-06-11T21:27:22Z", "creator": "avik@apache.org", "creation_time": "2002-06-11T21:27:22Z", "text": "This should now work against both CVS HEAD and 1.5. The stated problem is \nformula related and has been fixed. "}]