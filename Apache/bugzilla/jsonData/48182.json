[{"count": 0, "tags": [], "bug_id": 48182, "attachment_id": 24520, "is_private": false, "id": 131891, "time": "2009-11-11T13:39:50Z", "creator": "torarnv@gmail.com", "creation_time": "2009-11-11T13:39:50Z", "text": "Created attachment 24520\nQuick fix, dunno if it's safe to proceed if only one or two of the tree subsitutions were found, so I opted for the tripple-check, feel free to change.\n\nttf2svg crashes with NPE when processing DejaVuSans-Oblique from\nhttp://dejavu.sourceforge.net/"}, {"count": 1, "tags": [], "creator": "torarnv@gmail.com", "is_private": false, "text": "Actually the SVG produced seems to be broken, or at least missing tons of glyphs, so the fix fix might not be correct (it only fixes the NPE).", "id": 131892, "time": "2009-11-11T14:06:48Z", "bug_id": 48182, "creation_time": "2009-11-11T14:06:48Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "keith@nearlyfree.org", "is_private": false, "text": "I hit this exact same bug, NPE.  Only for me it was on a font which I had processed with a subsetting tool (font-optimizer). I ended up applying the exact same patch to my local batik. Would be great to see this fix released.", "id": 139679, "time": "2010-09-03T19:00:16Z", "bug_id": 48182, "creation_time": "2010-09-03T19:00:16Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "helder.magalhaes@gmail.com", "is_private": false, "text": "(In reply to comment #2)\n> I hit this exact same bug, NPE.  Only for me it was on a font which I had\n> processed with a subsetting tool (font-optimizer).\n\nAre you able to attach the problematic font for further testing?\n\n\n> I ended up applying the\n> exact same patch to my local batik. Would be great to see this fix released.\n\nThanks for confirming that the patch works around the issue. Currently, I was mostly trying to figure out if checking/setting each of the three variables would help avoiding too much information lost whenever only of them is missing. ;-)\n\n\nThanks,\n Helder", "id": 139684, "time": "2010-09-04T06:33:55Z", "bug_id": 48182, "creation_time": "2010-09-04T06:33:55Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "helder.magalhaes@gmail.com", "text": "(In reply to comment #0)\n> ttf2svg crashes with NPE when processing DejaVuSans-Oblique from\n> http://dejavu.sourceforge.net/\n\n(In reply to comment #1)\n> Actually the SVG produced seems to be broken, or at least missing tons of\n> glyphs, so the fix fix might not be correct (it only fixes the NPE).\n\nThanks for the report. Are you able to provide the particular command line used in the conversion, including parameters [1], in order to help reproducing the issue?\n\nThanks,\n Helder\n\n\n[1] http://xmlgraphics.apache.org/batik/tools/font-converter.html", "id": 139685, "time": "2010-09-04T06:37:38Z", "bug_id": 48182, "creation_time": "2010-09-04T06:37:38Z", "is_private": false, "attachment_id": null}, {"count": 5, "attachment_id": 25987, "bug_id": 48182, "is_private": false, "id": 139690, "time": "2010-09-04T08:01:25Z", "creator": "helder.magalhaes@gmail.com", "creation_time": "2010-09-04T08:01:25Z", "tags": [], "text": "Created attachment 25987\nProposed fix v2\n\n(In reply to comment #0)\n> Quick fix, dunno if it's safe to proceed if only one or two of the tree\n> subsitutions were found, so I opted for the tripple-check, feel free to change.\n\nYes, I've checked that the code later invoked in getGlyphAsSVG verifies each of them independently, so I've updated your patch proposal so that the checks are also independently made. :-)\n\nI've verified that, with the patch applied, the issue no longer occurs, although I'd like you to confirm it as well before committing it.\n\n@Keith Grennan\nPlease confirm that the patch fixes the issue with your problematic font, otherwise please attach it as requested in comment 3. ;-)"}, {"count": 6, "tags": [], "creator": "helder.magalhaes@gmail.com", "is_private": false, "text": "(In reply to comment #5)\n> I've verified that, with the patch applied, the issue no longer occurs [...]\n\nBy the way, the command line during testing was:\n  build ttf2svg DejaVuSans-Oblique.ttf -testcard\n\nI'm also adjusting the bug's title/metadata to reflect a patch being available, as well as assuming operating system as \"All\", as I was able to reproduce in Windows as well.", "id": 139691, "time": "2010-09-04T08:06:08Z", "bug_id": 48182, "creation_time": "2010-09-04T08:06:08Z", "attachment_id": null}, {"count": 7, "attachment_id": null, "bug_id": 48182, "is_private": false, "id": 139713, "time": "2010-09-06T06:49:13Z", "creator": "helder.magalhaes@gmail.com", "creation_time": "2010-09-06T06:49:13Z", "tags": [], "text": "(In reply to comment #1)\n> Actually the SVG produced seems to be broken, or at least missing tons of\n> glyphs [...]\n\nThe miss of many glyphs probably has to do with not specifying the \"-autorange\" parameter (shown in command line but currently undocumented in the previous stated link [1], I'm working on it). Adding that to the command line makes Batik to try determining the glyphs in the font instead of using defaults (which seem range 32 to 128), which would explain the missing characters. :-)\n\nAgain, try it as well and report back. ;-)\n\n[1] http://xmlgraphics.apache.org/batik/tools/font-converter.html"}, {"count": 8, "tags": [], "bug_id": 48182, "attachment_id": null, "text": "(In reply to comment #7)\n> (In reply to comment #1)\n> > Actually the SVG produced seems to be broken, or at least missing tons of\n> > glyphs [...]\n> \n> The miss of many glyphs probably has to do with not specifying the \"-autorange\"\n> parameter (shown in command line but currently undocumented in the previous\n> stated link [1], I'm working on it). Adding that to the command line makes\n> Batik to try determining the glyphs in the font instead of using defaults\n> (which seem range 32 to 128), which would explain the missing characters. :-)\n> \n> Again, try it as well and report back. ;-)\n> \n> [1] http://xmlgraphics.apache.org/batik/tools/font-converter.html\n\nYour updated patch + '-autorange' seems to work fine here. Thanks!", "id": 139717, "time": "2010-09-06T07:05:16Z", "creator": "torarnv@gmail.com", "creation_time": "2010-09-06T07:05:16Z", "is_private": false}, {"count": 9, "tags": [], "creator": "helder.magalhaes@gmail.com", "is_private": false, "text": "Committed in revision 996358 [1].\n\nThanks, everyone, for the help. :-)\n\n[1] http://svn.eu.apache.org/viewvc?view=revision&revision=996358", "id": 139842, "time": "2010-09-12T17:11:28Z", "bug_id": 48182, "creation_time": "2010-09-12T17:11:28Z", "attachment_id": null}]