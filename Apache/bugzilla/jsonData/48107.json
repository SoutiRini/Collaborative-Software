[{"attachment_id": 24463, "tags": [], "bug_id": 48107, "is_private": false, "count": 0, "id": 131585, "time": "2009-11-02T11:14:03Z", "creator": "pvp@peterpichler.at", "creation_time": "2009-11-02T11:14:03Z", "text": "Created attachment 24463\nca-bundle.crt\n\nWhen using the client-cert below in your browser (Tryed with IE and Firefox)\nand the attached ca-bundle.crt in your apache... an SSL Error\n\nIn Log:\n[Mon Nov 02 17:10:49 2009] [error] Certificate Verification: Error (20): unable\nto get local issuer certificate\n\nIn Firefox an error message containing \"ssl_error_bad_cert_alert\"\n\nWhen removing (!) the first certificate of the ca-bundle (which has nothing to\ndo with the client certificate) it is possible to authenticate using the\nclient-cert. There are also some other possible changes in the order within\nca-bundle with the same effect.\n\nThe problem was detected in apache 2.2.11... but exists still in 2.2.14....\n\n-----BEGIN CERTIFICATE-----\nMIIC1jCCAb4CAQIwDQYJKoZIhvcNAQEEBQAwcDEiMCAGA1UEAxMZcG9ydGFsLmxm\ncnouYXQgQ2xpZW50LUNBMTENMAsGA1UECBMEV2llbjELMAkGA1UEBhMCQVQxHzAd\nBgkqhkiG9w0BCQEWEGhlbHBkZXNrQGxmcnouYXQxDTALBgNVBAoTBExGUlowHhcN\nMDgxMDAzMTQ0NDAzWhcNMTMxMDAyMTQ0NDAzWjB2MR4wHAYDVQQDExVDbGllbnQg\nQ2VydGlmaWNhdGUgMDIxDTALBgNVBAgTBFdpZW4xCzAJBgNVBAYTAkFUMRAwDgYJ\nKoZIhvcNAQkBFgEuMQ0wCwYDVQQKEwRMRlJaMRcwFQYDVQQLEw5wb3J0YWwubGZy\nei5hdDCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEA0pF23/iTs1qLxl8gn0wH\n01BzHd4eLprbBosy9zvhEmokEuqxZfvl5Ce0F8q7ZqGMFrfRK7ljux6B+Hqh0pDr\n2WhssC0sDRzrvya/1IL0QxkGNbPkPk823nn9dYllNu2z8d0T35tLuW/G44xcNFeD\nCv2cRMbS9CUAzAz9ocG81K0CAwEAATANBgkqhkiG9w0BAQQFAAOCAQEAuhXs5i1S\nAOCMNUM78TfAPh0lUIenTJB9n/K5wb/LsrkMF+SbXbE4YtRTBHERTCBys46l660K\nlJMi1rryNVu+HmKa1SpfMJwPr+EMTLvDKkRghSgtCIGU4L/b05hmU5eFfKPsHXKO\na2MNJR23Rmmiv+r+x0gIRz54dek7zqxpCBf8373kzVR7yNLPaaVxRJ5a6Sm6U53w\nQjZHpaZt8izcv1W7xhFCsV/XCauGFKX/qyGtN9oajtJhmEMdganQVCDsnl5YfpRl\nsWBr0E3GY4HNRpOm1lFyFqSdnrPriYkypP6gUFs/g92eg4+jiBEku/tVkOMkrBTR\nkw3B+c6K0T5Eig==\n-----END CERTIFICATE-----\n-----BEGIN RSA PRIVATE KEY-----\nMIICXAIBAAKBgQDSkXbf+JOzWovGXyCfTAfTUHMd3h4umtsGizL3O+ESaiQS6rFl\n++XkJ7QXyrtmoYwWt9EruWO7HoH4eqHSkOvZaGywLSwNHOu/Jr/UgvRDGQY1s+Q+\nTzbeef11iWU27bPx3RPfm0u5b8bjjFw0V4MK/ZxExtL0JQDMDP2hwbzUrQIDAQAB\nAoGAAZf4PlmzRHg69pVhudLpfD/vnxo/QDsLzVDgYd6iJXGINFxyW0M8yi1Cv6tZ\nH725QbLCcoJErvXcJfVHpEBUiJ0ttZuOAQzX5lbAti55QDaV0gw44wbUYuctj5RE\nDMZNJ/uYs/S4wfrHD67KARb1wYIkRI/eXoFXXQqCV4se9EECQQDucUStIuif1uCq\nlJXWmoe1/M/vivpePgWISn3VMw2/oPvrGvJjtA7ycH7aD9S4t+kDM0Hkl8DZGygt\nx9Bmhb03AkEA4hLBjrAOX7AhPrk21e8ODVeFvrR95ONO2K96498LECye2NggGEGg\naCe0QfGY7ddHMTxC0DPIF1HUdCyAFcwPOwJAekWdSQeYsLaY2QB+4eC2bQ1qd9UV\n1JQLdDt20YhvqW/dH0/fMl+YNpyXgC0UEXFFzP1Q8e8b1nlFnkxTwu8b+wJARHsB\n/sL916Z2q5VXMv6y9v+oF9h8ujTQ0Xp2c0hBBak+hNkS/8YBXQuJ4t/YP1OS0Ss7\n4e2NkuLKxFYmhnPFuQJBAK3P4IP/Slv4GnDKPZwfZ3Hj0DEwnObmfRD698eiWlKV\n4btnBUUJ1bkctm7fwnOWwNE5MviAf8sGh2bk20Xbu+M=\n-----END RSA PRIVATE KEY-----"}, {"attachment_id": null, "tags": [], "bug_id": 48107, "is_private": false, "count": 1, "id": 131588, "time": "2009-11-02T12:05:02Z", "creator": "rpluem@apache.org", "creation_time": "2009-11-02T12:05:02Z", "text": "Please set the loglevel to debug and provide the output of the error log during such a failed handshake.\nDoes it start working when you reduce your ca-bundle.crt file to just the certificate blocks (It currently contains comments, clear text certificate data and further stuff)?\nWhat version of openssl are you using?"}, {"count": 2, "tags": [], "creator": "jorton@redhat.com", "attachment_id": null, "is_private": false, "id": 131589, "time": "2009-11-02T12:11:57Z", "bug_id": 48107, "creation_time": "2009-11-02T12:11:57Z", "text": "This could be bug 46952.\n\nCan you fetch http://people.apache.org/~jorton/pr46952.diff - then\n\n$ patch modules/ssl/ssl_engine_io.c < pr46952.diff\n\nand rebuild?"}, {"attachment_id": null, "tags": [], "bug_id": 48107, "is_private": false, "count": 3, "id": 131623, "time": "2009-11-03T07:21:01Z", "creator": "woldra@gmx.de", "creation_time": "2009-11-03T07:21:01Z", "text": "(In reply to comment #1)\n> Please set the loglevel to debug and provide the output of the error log during\n> such a failed handshake.\n\nsee attached error_log\n\n> Does it start working when you reduce your ca-bundle.crt file to just the\n> certificate blocks (It currently contains comments, clear text certificate data\n> and further stuff)?\nWe already tried that before but it makes no difference.\n\n> What version of openssl are you using?\n\nopenssl version used by apache is 0.9.8f"}, {"count": 4, "tags": [], "creator": "woldra@gmx.de", "attachment_id": 24466, "is_private": false, "id": 131624, "time": "2009-11-03T07:22:12Z", "bug_id": 48107, "creation_time": "2009-11-03T07:22:12Z", "text": "Created attachment 24466\nlog with failed ssl handshake"}, {"count": 5, "tags": [], "bug_id": 48107, "is_private": false, "text": "(In reply to comment #2)\n> This could be bug 46952.\n> \n> Can you fetch http://people.apache.org/~jorton/pr46952.diff - then\n> \n> $ patch modules/ssl/ssl_engine_io.c < pr46952.diff\n> \n> and rebuild?\n\npatched and rebuilt apache - no difference.\n\nRegards", "id": 131625, "time": "2009-11-03T07:44:00Z", "creator": "woldra@gmx.de", "creation_time": "2009-11-03T07:44:00Z", "attachment_id": null}, {"count": 6, "tags": [], "creator": "pvp@peterpichler.at", "attachment_id": null, "is_private": false, "id": 132234, "time": "2009-11-23T02:28:14Z", "bug_id": 48107, "creation_time": "2009-11-23T02:28:14Z", "text": "There is no difference, when removing the text elements from the ca-bundle.crt file..."}]