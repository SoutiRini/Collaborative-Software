[{"count": 0, "tags": [], "bug_id": 52605, "attachment_id": null, "id": 153465, "time": "2012-02-05T17:27:48Z", "creator": "jmv_deb@nirgal.com", "creation_time": "2012-02-05T17:27:48Z", "is_private": false, "text": "From: Riccardo Murri <riccardo.murri@gmail.com>\n\nAs of version 2.2.16, Apache applies a fixed line length limit of 8192\nbytes when talking to a CGI script: in file `server/util_script.c`,\nfunction `ap_scan_script_header_err_core`, at lines 403--433,\none can read:\n\n        char x[MAX_STRING_LEN];\n        char *w, *l;\n        [...]\n        if (buffer) {\n            *buffer = '\\0';\n        }\n        w = buffer ? buffer : x;\n        [...]\n        while (1) {\n            int rv = (*getsfunc) (w, MAX_STRING_LEN - 1, getsfunc_data);\n\nwhere `MAX_STRING_LEN` is defined in `httpd.h` to be equal to\n`HUGE_STRING_LEN`, that is, 8192.\n\nThe directive `LimitRequestLine` should apply here as well, or the\ndocumentation should make it clear that this setting does not\ninfluence the CGI module."}, {"count": 1, "tags": [], "bug_id": 52605, "text": "The data being read isn't a request line or a request-anything, so why would that limit apply?", "id": 153466, "time": "2012-02-05T17:35:49Z", "creator": "covener@gmail.com", "creation_time": "2012-02-05T17:35:49Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 52605, "text": "Maybe I extracted the wrong bits of code, but in essence the problem\nis this: Apache truncates request lines passed to a CGI script to\n~8kB, and there is apparently no way of changing that setting.", "id": 153467, "time": "2012-02-05T18:07:44Z", "creator": "riccardo.murri@gmail.com", "creation_time": "2012-02-05T18:07:44Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 52605, "text": "On 2.2 I was able to send a request line >8k and see its value in the REQUEST_URI environment variable. Can you share the details of the test case?", "id": 153470, "time": "2012-02-05T18:58:13Z", "creator": "covener@gmail.com", "creation_time": "2012-02-05T18:58:13Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 52605, "attachment_id": null, "id": 153809, "time": "2012-02-15T14:22:50Z", "creator": "jmv_deb@nirgal.com", "creation_time": "2012-02-15T14:22:50Z", "is_private": false, "text": "I'm not sure this is related, but since commit 1200947 [1], documentation [2] says:\n\n\"Under normal conditions, the value should not be changed from the default. Also, you can't set this higher than 8190 without modifying the source and rebuilding.\"\n\nSee also bug 51665 [3]\n\n[1] https://httpd.apache.org/docs/2.2/en/mod/core.html#limitrequestline\n\n[2] https://svn.apache.org/viewvc/httpd/httpd/branches/2.2.x/docs/manual/mod/core.xml?r1=1166612&r2=1200947&pathrev=1200947\n\n[3] https://issues.apache.org/bugzilla/show_bug.cgi?id=51665"}, {"count": 5, "tags": [], "creator": "riccardo.murri@gmail.com", "attachment_id": null, "id": 153815, "creation_time": "2012-02-15T18:06:03Z", "time": "2012-02-15T18:06:03Z", "bug_id": 52605, "text": "I came across this issue when diagnosing a problem with the IkiWiki\nCGI.  Details of the IkiWiki issue can be found here (with pointers to\na similar bug in another software):\n\nhttp://bugs.debian.org/cgi-bin/bugreport.cgi?bug=638009\n\nIn essence, the problem is that the IkiWiki CGI script generates an\nHTTP 302 response, with a very long `Location: ...` line (~16k;\nbasically it embeds the text of the whole Wiki page in the http:// URL\nas a query parameter).  Then Apache (I was using the Debian \"squeeze\"\none) truncated the line, apparently at ~8k.\n\nThe IkiWiki bug has been corrected since (it shouldn't have issued a\nredirect in the first place), so current version will not exhibit that\nbehavior.", "is_private": false}]