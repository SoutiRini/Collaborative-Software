[{"count": 0, "tags": [], "text": "There seems to be a bug with the handling of error reports.\nIf you set the content-length in a response ( ServletResponse.setContentLength\n() ) to 0 or any other value greater than 0 and also set a status-code \n(HttpServletResponse.setStatus() ) to a value greater than 400 (401 is a very \ngood example), tomcat will send a wrong http-response to the client!\n\nThe client receives the header 'content-length' with the value 0 and stops \nreading from the stream. But the is also a html-message in the stream, wich was \ngenerated by tomcat ( org.apache.catalina.valves.ErrorReportValve.report() ).\n\nIf you are running persistent connections (keep-alive), with the next response \nthe client receives first the html-message and than the status line and the \nhttp-headers. So the html-message is in the wrong response on the wrong \nposition.\n\nIt don't strikes, if you are not running persistens connections, because the \nstream will be closed and a new one will be opened for the next request.\n\n===\n\nAnd there seems to be a second bug with the handling of error reports.\n\nIf you set a status-code, wich is not listed in \norg.apache.catalina.valves.LocalStrings.properties (999 for example), the html-\nmessage looks like this:\n\nHTTP Status 999 - Cannot find message associated with key '999'.\n\n( org.apache.catalina.util.StringManager.getStringInternal() - in the catch-\nblock null could be a better return value )", "is_private": false, "id": 60004, "creation_time": "2004-06-28T15:43:17Z", "time": "2004-06-28T15:43:17Z", "creator": "jens.mueller@dbv-winterthur.de", "bug_id": 29846, "attachment_id": null}, {"count": 1, "tags": [], "text": "The first part obviously works for me.\nThe second part will not be addressed.", "attachment_id": null, "bug_id": 29846, "id": 60006, "time": "2004-06-28T16:00:41Z", "creator": "remm@apache.org", "creation_time": "2004-06-28T16:00:41Z", "is_private": false}, {"count": 2, "attachment_id": null, "creator": "jens.mueller@dbv-winterthur.de", "text": "Oh sorry, I forgot an important detail.\nThis only appears, if you are connection with apache and mod_jk (in this case \nmod_jk 1.2.5) in front of the apache.", "id": 60007, "time": "2004-06-28T16:05:53Z", "bug_id": 29846, "creation_time": "2004-06-28T16:05:53Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "creator": "remm@apache.org", "is_private": false, "text": "*** Bug 29851 has been marked as a duplicate of this bug. ***", "id": 60021, "time": "2004-06-28T20:22:56Z", "bug_id": 29846, "creation_time": "2004-06-28T20:22:56Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "remm@apache.org", "text": "That's a useful precision.", "id": 60029, "time": "2004-06-28T23:01:32Z", "bug_id": 29846, "creation_time": "2004-06-28T23:01:32Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 29846, "text": "Becuase this only appears with mod_jk, I'm modifying the \"Component\" section of \nthis bug to Native:JK.  I'm also reducing the severity from \"Major\" to \"Normal\" \nand I suggest you try mod_jk 1.2.6 which was just released a couple of days ago.", "id": 61237, "time": "2004-07-28T15:04:39Z", "creator": "yoavs@computer.org", "creation_time": "2004-07-28T15:04:39Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "creator": "yoavs@computer.org", "is_private": false, "text": "Did mod_jk 1.2.6 fix your problem?  As you can tell by the fact no action has \nbeen taken on this issue, no one thinks it's significant.  If you really want a \nspeedy patch, the best option is for you to submit it.", "id": 66114, "time": "2004-10-29T18:07:40Z", "bug_id": 29846, "creation_time": "2004-10-29T18:07:40Z", "attachment_id": null}, {"count": 7, "tags": [], "creator": "yoavs@computer.org", "is_private": false, "text": "I'm closing this item, assuming this has been fixed by mod_jk 1.2.6 (and 1.2.7 \nis coming out tomorrow), and given that the OP has yet to respond to my \nquestion from a month ago.  Please feel free to reopen if you can conclusively \ndemonstrate this error still happens with 1.2.6.", "id": 67569, "time": "2004-11-29T19:55:01Z", "bug_id": 29846, "creation_time": "2004-11-29T19:55:01Z", "attachment_id": null}]