[{"count": 0, "tags": [], "text": "There appears to be no way to change the default thread stack size on \nmpm_worker (there is a directive for mpm netware).\n\nOn some systems, the default stacksize can be too small e.g. HP/UX and there \nis no way to change this (without hacking apache). Regretably, this causes \nsome nasty problems during shutdown, esp. when C++ based modules are employed.", "is_private": false, "id": 76659, "creator": "tpark@borland.com", "time": "2005-06-23T17:39:34Z", "bug_id": 35485, "creation_time": "2005-06-23T17:39:34Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 35485, "attachment_id": null, "id": 76662, "time": "2005-06-23T17:52:18Z", "creator": "trawick@apache.org", "creation_time": "2005-06-23T17:52:18Z", "is_private": false, "text": "ThreadSTackSize works with worker MPM in Apache 2.1-dev.\n\nIt has been a todo of mine for quite a while to backport the code to 2.0.x and\nput it up for a vote for inclusion in 2.0.next.  I'll try to remember to update\nthis PR when I do that."}, {"count": 2, "tags": [], "text": "The naughty bits are in here:\n\nhttp://svn.apache.org/viewcvs.cgi?rev=102931&view=rev\nhttp://svn.apache.org/viewcvs.cgi?rev=102975&view=rev\n", "is_private": false, "id": 76663, "creator": "trawick@apache.org", "time": "2005-06-23T17:57:42Z", "bug_id": 35485, "creation_time": "2005-06-23T17:57:42Z", "attachment_id": null}, {"count": 3, "tags": [], "text": "Try this quick and DIRTY patch in the interim:\n\nIndex: server/mpm/worker/worker.c\n===================================================================\n--- server/mpm/worker/worker.c  (revision 179865)\n+++ server/mpm/worker/worker.c  (working copy)\n@@ -1135,6 +1135,11 @@\n     /* 0 means PTHREAD_CREATE_JOINABLE */\n     apr_threadattr_detach_set(thread_attr, 0);\n  \n+    if (getenv(\"WORKER_STACKSIZE\") != NULL) {\n+        apr_threadattr_stacksize_set(thread_attr,\n+                                     atoi(getenv(\"WORKER_STACKSIZE\")));\n+    }\n+\n     ts->threads = threads;\n     ts->listener = NULL;\n     ts->child_num_arg = child_num_arg;\n\n(export WORKER_STACKSIZE=big-number)\n", "attachment_id": null, "bug_id": 35485, "id": 76666, "time": "2005-06-23T18:25:40Z", "creator": "trawick@apache.org", "creation_time": "2005-06-23T18:25:40Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 35485, "attachment_id": null, "text": "I can try this - looks good - only problem is that I'll need to add the apr \nroutine to set the stack size in the apr lib, as I couldn't find a \nstacksize 'setter' in Apache 2.0.\n", "id": 76670, "time": "2005-06-23T18:43:12Z", "creator": "tpark@borland.com", "creation_time": "2005-06-23T18:43:12Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 35485, "attachment_id": null, "text": "That feature has been in APR since\nWed Jan 19 21:51:07 2005 UTC\n\nThese Apache releases should have that in the bundled APR:\n\n    2.0.54  : released April 17, 2005 as GA.\n    2.0.53  : released February 7, 2005 as GA.\n", "id": 76671, "time": "2005-06-23T18:47:57Z", "creator": "trawick@apache.org", "creation_time": "2005-06-23T18:47:57Z", "is_private": false}, {"count": 6, "tags": [], "text": "My Bad! - I was looking at 2.0.48-era source code.\nApologies to all.\n\n-T\n\n", "is_private": false, "id": 76685, "creator": "tpark@borland.com", "time": "2005-06-24T04:34:56Z", "bug_id": 35485, "creation_time": "2005-06-24T04:34:56Z", "attachment_id": null}, {"count": 7, "tags": [], "creator": "chip@force-elite.com", "attachment_id": null, "text": "Fixed in 2.2.0.", "id": 83291, "time": "2005-12-06T07:52:46Z", "bug_id": 35485, "creation_time": "2005-12-06T07:52:46Z", "is_private": false}]