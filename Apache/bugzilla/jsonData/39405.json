[{"count": 0, "tags": [], "text": "Running a log parsing program against the access.log for an Apache 2.2.0 server\nI noticed it throwing out lots of errors as invalid. When I looked closely I\nnoticed all of those lines were failing to match the status code pattern of\n3-digits because the value inserted for %>s is 70007:\n\n218.63.252.219 - - [21/Apr/2006:22:27:14 -0400] \"POST /cgi-bin/forums/forums.pl\nHTTP/1.1\" 70007 34200 \"http://dcregistry.com/forums/dating/messages/2461.html\"\n\"Mozilla/4.0 (compatible; MSIE 5.5; Windows NT 5.0; .NET CLR 1.0.3705)\"\n218.63.252.219 - - [22/Apr/2006:12:59:45 -0400] \"POST /cgi-bin/forums/forums.pl\nHTTP/1.1\" 70007 34200 \"http://dcregistry.com/forums/dating/messages/560.html\"\n\"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.1.4322)\"\n218.63.252.219 - - [23/Apr/2006:05:02:17 -0400] \"POST /cgi-bin/forums/forums.pl\nHTTP/1.1\" 70007 35217 \"http://dcregistry.com/forums/music/messages/2467.html\"\n\"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.1.4322)\"\n\n\nReading around it seems that 70007 is an APR error code for a time out and I\nhave seen it used as such in the error log when an error occurs writing to the\nnetwork. But I think it is an error to log this number as the \"status code\" in\nthe access log because, according to the Apache docs:\n\n http://httpd.apache.org/docs/2.2/logs.html\n\n \"This is the status code that the server sends back to the client.\n   ...\n  The full list of possible status codes can be found in the HTTP\n  specification (RFC2616 section 10).\"\n\n70007 isn't a valid HTTP status code so it is incorrect to log it.\nI haven't looked into this further but I wonder if it is being generated\nbecause the log format is %>s - I.e. the last status that is generated.\nSince this occurs in an error condition to do with timing out the network\nresponse it seems likely it is occuring after the headers have been generated\n(and possibly sent) and when this error is generated Apache is overwriting the\nactual \"last\" status code. It maybe that the code is intending to replace the\nlast status with a 5xx error and is incorrectly copying the APR code into\nplace.\n\n\n\nI'm using the config:\n\n  LogFormat \"%a %l %u %t \\\"%r\\\" %>s %b \\\"%{Referer}i\\\" \\\"%{User-Agent}i\\\"\" combined\n  CustomLog /usr/local/apache/logs/access.log combined\n\n\napollo# httpd -M\nLoaded Modules:\n core_module (static)\n authn_file_module (static)\n authn_default_module (static)\n authz_host_module (static)\n authz_groupfile_module (static)\n authz_user_module (static)\n authz_default_module (static)\n auth_basic_module (static)\n include_module (static)\n filter_module (static)\n log_config_module (static)\n env_module (static)\n setenvif_module (static)\n mpm_prefork_module (static)\n http_module (static)\n mime_module (static)\n autoindex_module (static)\n suexec_module (static)\n cgi_module (static)\n negotiation_module (static)\n dir_module (static)\n actions_module (static)\n alias_module (static)\n rewrite_module (static)\n so_module (static)\n frontpage_module (shared)\n php5_module (shared)\nSyntax OK\n\nColin.", "attachment_id": null, "id": 88479, "creator": "ckeith@clara.net", "time": "2006-04-25T19:59:01Z", "bug_id": 39405, "creation_time": "2006-04-25T19:59:01Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 39405, "attachment_id": null, "id": 88480, "time": "2006-04-25T20:24:04Z", "creator": "rpluem@apache.org", "creation_time": "2006-04-25T20:24:04Z", "is_private": false, "text": "\n\n*** This bug has been marked as a duplicate of 31759 ***"}]