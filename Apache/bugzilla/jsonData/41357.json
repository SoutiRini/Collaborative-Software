[{"text": "The HLSFSlideShow.readPictures() method can result in an infinite loop. \n\nWhen trying to instantiate an PowerPointExtractor with\npoi-scratchpad-3.0-alpha3-20061212.jar the following exception was raised.\n\nProblem reading picture: java.lang.IllegalArgumentException: Unsupported picture\ntype: -61464\nYou document will probably become corrupted if you save it!\n\nWhile debugging i noticed that POI was trying to read pictures out of a PPT\npresentation, unfortunately at least one picture was of size 0 (don't know why).\n   That made the method HSLFSlideShow.readPictures() ran into an infinite loop\nat line 283 at\n            pos += imgsize;\nbecause imgsize was zero.", "tags": [], "bug_id": 41357, "is_private": false, "count": 0, "id": 97993, "time": "2007-01-12T05:02:56Z", "creator": "asf@raikoeckstein.de", "creation_time": "2007-01-12T05:02:56Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "text": "Could you attach the ppt file? Without it it is impossible to debug the problem. \n\nYegor", "id": 97996, "time": "2007-01-12T05:34:08Z", "bug_id": 41357, "creation_time": "2007-01-12T05:34:08Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 41357, "attachment_id": null, "id": 97999, "time": "2007-01-12T06:21:11Z", "creator": "apache@gagravarr.org", "creation_time": "2007-01-12T06:21:11Z", "is_private": false, "text": "It shouldn't be able to get into an infinite loop, as the code always winds on\nby the size of the header block (8 bytes)\n\nI've added a check to ensure the img size is positive, since a negative one\ncould lead to an infinite loop. \n\nCan you re-open the bug if this doesn't help, and upload the problem document?"}, {"count": 3, "tags": [], "creator": "asf@raikoeckstein.de", "text": "Created attachment 19401\nThe ppt presentation\n\nUnfortunately that change didn't help. I attached the problematic ppt file.", "id": 98009, "time": "2007-01-12T10:17:00Z", "bug_id": 41357, "creation_time": "2007-01-12T10:17:00Z", "is_private": false, "attachment_id": 19401}, {"text": "Ah, I was being bitten by java's garbage collection not playing nicely with\nloops of the kind we're using\n\nI've shifted the byte array creation until after we've decided we have a real\npicture. That fixes the memory exception for me. (I've also added a test to the\nsuite, using your sample doc, to check it stays fixed)", "tags": [], "creator": "apache@gagravarr.org", "is_private": false, "count": 4, "id": 98077, "time": "2007-01-15T08:41:14Z", "bug_id": 41357, "creation_time": "2007-01-15T08:41:14Z", "attachment_id": null}]