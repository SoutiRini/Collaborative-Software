[{"count": 0, "tags": [], "text": "First of all thanks for the Great work.\n\nWe run more than 100 apache servers on one Linux server/machine. Each apache\ninstance has 50 child processes. And mainly we run SSL in most of these cases. I\nthink configuration like this might be the cause of the problem i am\nexperiencing.  And i don't think it has to do anything to do with OS or apache\nversion i use.  When i had around 60 Apache servers running it was all fine.\nWhen i started adding more instances i started getting following error message\nin the error log.\n\n[Sat Aug 18 11:27:27 2007] [notice] Apache/2.0.49 (Unix) mod_ssl/2.0.49\nOpenSSL/0.9.7d mod_jk2/2.0.5-dev configured -- resuming normal operations\n[Sat Aug 18 11:28:29 2007] [error] shm.createSlot() create 0 returned NULL\n[Sat Aug 18 11:28:29 2007] [error] workerEnv.init() create slot epStat.14236 failed\n[Sat Aug 18 11:29:28 2007] [error] shm.createSlot() create 0 returned NULL\n[Sat Aug 18 11:29:28 2007] [error] workerEnv.init() create slot epStat.1 failed\n[Sat Aug 18 11:31:29 2007] [error] shm.createSlot() create 0 returned NULL\n[Sat Aug 18 11:31:29 2007] [error] workerEnv.init() create slot epStat.14334 failed\n[Sat Aug 18 11:33:28 2007] [error] shm.createSlot() create 0 returned NULL\n[Sat Aug 18 11:33:28 2007] [error] workerEnv.init() create slot epStat.13934 failed\n[Sat Aug 18 11:44:31 2007] [error] shm.createSlot() create 0 returned NULL\n[Sat Aug 18 11:44:31 2007] [error] workerEnv.init() create slot epStat.16304 failed\n[Sat Aug 18 11:49:31 2007] [error] shm.createSlot() create 0 returned NULL\n[Sat Aug 18 11:49:31 2007] [error] workerEnv.init() create slot epStat.16558 failed\n[Sat Aug 18 11:51:32 2007] [error] shm.createSlot() create 0 returned NULL\n[Sat Aug 18 11:51:32 2007] [error] workerEnv.init() create slot epStat.16560 failed\n[Sat Aug 18 11:52:32 2007] [error] shm.createSlot() create 0 returned NULL\n[Sat Aug 18 11:52:32 2007] [error] workerEnv.init() create slot epStat.16565 failed\n[Sat Aug 18 12:11:36 2007] [error] shm.createSlot() create 0 returned NULL\n\n\nIn spite of the above error messages Apache runs fine for few hours and then it\ngives following messages in the error.log\n\n[Sun Aug 19 23:56:30 2007] [notice] child pid 16491 exit signal Segmentation\nfault (11)\n[Sun Aug 19 23:56:59 2007] [notice] child pid 16879 exit signal Segmentation\nfault (11)\n[Sun Aug 19 23:57:29 2007] [notice] child pid 16770 exit signal Segmentation\nfault (11)\n[Sun Aug 19 23:58:00 2007] [notice] child pid 16910 exit signal Segmentation\nfault (11)\n[Sun Aug 19 23:58:30 2007] [notice] child pid 16942 exit signal Segmentation\nfault (11)\n[Sun Aug 19 23:59:31 2007] [notice] child pid 16993 exit signal Segmentation\nfault (11)\n\nApache server process still runs but now it refuses to serve any page it just\ndisplays blank page. Starting apache fixes this problem for another few hours. \n\nWe found the workaround of this problem.\n \n1) By moving logs directory to logs.old and creating the logs directory. Usually\nthis fixes the problem. \n\nThink same Shared memory Key is assigned to more than one apache instance\nrunning on the server.  Believe ftok is used to generate Shared memory Key and\nits having collision as i have lots of apaches running on one machine. To prove\nthis theory further we  hacked ftok function to return a key from a file.\n\n\n Desc:    This is an LD_PRELOAD hack that overrides the ftok()\n *          library function. This ftok reads an ftokdb file\n *          (defined here or by the FTOKDB environment variable)\n *          to determine which shm key to return rather than\n *          using the file's inode information.\n\nThis hack seems to work fine so far. Ideally i want Apache to use more\nrandomness than ftok provides so one can run more apache instances on one machine.\n\nHope this makes sense. Let me know if you need any further information.\n\nthanks in advance\nKrishna", "is_private": false, "bug_id": 43177, "id": 106964, "time": "2007-08-21T07:45:32Z", "creator": "Krishna.Rawat@gmail.com", "creation_time": "2007-08-21T07:45:32Z", "attachment_id": null}]