[{"count": 0, "tags": [], "bug_id": 31344, "attachment_id": null, "is_private": false, "id": 63985, "time": "2004-09-21T15:20:18Z", "creator": "jason@jasonpark.com", "creation_time": "2004-09-21T15:20:18Z", "text": "PATH_INFO when passed to mod_Rewrite in Apache 1.3.31 is incorrect.  It \ncontains the document path - which is appended to the rewrite statement.\n\nRewriteCond %{REQUEST_URI} ^/PROXYTHIS/.*\nRewriteRule /PROXYTHIS/(.*)$ http://www.anotherdomain.com/$1  [P]\n\n\nThis works fine on 1.3.29 and other prior versions and has the following \nfunctionality:\n\nOriginal: http://www.thisdomain.com/PROXYTHIS/test.cgi?This=that\nRewrite Proxy: proxy:http://www.anotherdomain.com/test.cgi\n\n-- Rewrite Log - From Apache 1.3.29 - Works Correctly --\nXxx.xxx.xxx.xxx - - [16/Sep/2004:13:45:07 -0500] \n[www.thisdomain.com/sid#80ccc6c][rid#80c731c/initial] (3) applying \npattern '/PROXYTHIS/(.*)$' to \nuri '/home/thisuser/public_html/PROXYTHIS/test.cgi'\nXxx.xxx.xxx.xxx - - [16/Sep/2004:13:45:07 -0500] \n[www.thisdomain.com/sid#80ccc6c][rid#80c731c/initial] (2) \nrewrite /home/thisuser/public_html/PROXYTHIS/test.cgi -> \nhttp://www.anotherdomain.com/test.cgi\nXxx.xxx.xxx.xxx - - [16/Sep/2004:13:45:07 -0500] \n[www.thisdomain.com/sid#80ccc6c][rid#80c731c/initial] (2) forcing proxy-\nthroughput with http://www.anotherdomain.com/test.cgi\nXxx.xxx.xxx.xxx - - [16/Sep/2004:13:45:07 -0500] \n[www.thisdomain.com/sid#80ccc6c][rid#80c731c/initial] (1) go-ahead with proxy \nrequest proxy:http://www.anotherdomain.com/test.cgi [OK]\n--\n\nWith Apache 1.3.31 though, I am getting some very unexpected behavior.  The \ndocument path, if the original document actually existed and was not to be \nrewritten, is appended to the proxy URL like so:\n\nOriginal: http://www.thisdomain.com/PROXYTHIS/test.cgi?This=that\nRewrite Proxy: \nproxy:http://www.anotherdomain.com/test.cgi/home/thisuser/public_html/PROXYTHIS\n/test.cgi\n\n-- Rewrite Log - From Apache 1.3.31 - INCORRECT --\nXxx.xxx.xxx.xxx - - [16/Sep/2004:13:47:13 -0500] \n[www.thisdomain.com/sid#80d87bc][rid#80a5454/initial] (2) init rewrite engine \nwith requested uri /PROXYTHIS/test.cgi\nXxx.xxx.xxx.xxx - - [16/Sep/2004:13:47:13 -0500] \n[www.thisdomain.com/sid#80d87bc][rid#80a5454/initial] (3) applying \npattern '/PROXYTHIS/(.*)$' to uri '/PROXYTHIS/test.cgi'\nXxx.xxx.xxx.xxx - - [16/Sep/2004:13:47:13 -0500] \n[www.thisdomain.com/sid#80d87bc][rid#80a5454/initial] (2) \nrewrite /PROXYTHIS/test.cgi -> http://www.anotherdomain.com/test.cgi\nXxx.xxx.xxx.xxx - - [16/Sep/2004:13:47:13 -0500] \n[www.thisdomain.com/sid#80d87bc][rid#80a5454/initial] (2) forcing proxy-\nthroughput with http://www.anotherdomain.com/test.cgi\nXxx.xxx.xxx.xxx - - [16/Sep/2004:13:47:13 -0500] \n[www.thisdomain.com/sid#80d87bc][rid#80a5454/initial] (1) go-ahead with proxy \nrequest \nproxy:http://www.anotherdomain.com/test.cgi/home/thisuser/public_html/PROXYTHIS\n/test.cgi [OK]\n\nI am not much of a C programmer, but I put in quite a bit of debug logging \ninto the mod_rewrite module and the stuff that is getting added on at the end \nis coming from PATH_INFO, which is the PATH_INFO passed into mod_rewrite as \nmod_rewrite does not modify it."}, {"count": 1, "tags": [], "creator": "robert@accettura.com", "is_private": false, "text": "1.190, 1.191, 1.192 look like most likely suspects:\n\nhttp://cvs.apache.org/viewcvs.cgi/apache-1.3/src/modules/standard/mod_rewrite.c?rev=1.199&view=log", "id": 68887, "time": "2004-12-23T05:53:51Z", "bug_id": 31344, "creation_time": "2004-12-23T05:53:51Z", "attachment_id": null}]