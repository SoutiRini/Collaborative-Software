[{"count": 0, "tags": [], "text": "On TIKA-2129, Seva Alekseyev shared a file that throws:\n\njava.lang.IllegalArgumentException: Unknown shape type: 4095\nat org.apache.poi.sl.usermodel.ShapeType.forId(ShapeType.java:314)\nat org.apache.poi.hslf.usermodel.HSLFShapeFactory.createSimpleShape(HSLFShapeFactory.java:98)\nat org.apache.poi.hslf.usermodel.HSLFShapeFactory.createShape(HSLFShapeFactory.java:62)\nat org.apache.poi.hslf.usermodel.HSLFSheet.getShapes(HSLFSheet.java:173)\nat org.apache.tika.parser.microsoft.HSLFExtractor.parse(HSLFExtractor.java:93)\nat org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:149)\nat org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:117)\n\nWhen I save the file as pptx, the shape is called \"AutoShape\". According to one vendor of MSOffice processing tools, 4095 is a recognized code for 'Unknown'.\n\nAny objections to adding this to ShapeType?", "is_private": false, "id": 194622, "creator": "tallison@mitre.org", "time": "2016-10-21T16:24:04Z", "bug_id": 60294, "creation_time": "2016-10-21T16:24:04Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 60294, "attachment_id": null, "is_private": false, "id": 194642, "time": "2016-10-22T18:52:53Z", "creator": "kiwiwings@apache.org", "creation_time": "2016-10-22T18:52:53Z", "text": "For shape types 0x0FFF is not defined (see MSOSPT [1]) - I could only find something for MSODGMT [2]. When the file is saved as .pptx, PP2016 create a custom geometry shape depicting a rectangle, but in .ppt I can't find that freeform shape structure.\nSo I would reuse the shape type NOT_PRIMITIVE in this case and not introduce another enumeration value.\n\n\n[1] https://msdn.microsoft.com/en-us/library/dd949385(v=office.12).aspx\n[2] https://msdn.microsoft.com/en-us/library/dd953236(v=office.12).aspx"}, {"count": 2, "tags": [], "creator": "kiwiwings@apache.org", "attachment_id": null, "is_private": false, "id": 194644, "time": "2016-10-22T19:35:30Z", "bug_id": 60294, "creation_time": "2016-10-22T19:35:30Z", "text": "fixed via r1766227"}, {"count": 3, "tags": [], "text": "... beside of reading the .ppt, I've also successfully rendered it ...", "attachment_id": null, "id": 194645, "creator": "kiwiwings@apache.org", "time": "2016-10-22T19:39:01Z", "bug_id": 60294, "creation_time": "2016-10-22T19:39:01Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 60294, "text": "Thank you, Andi!", "id": 194656, "time": "2016-10-24T16:44:20Z", "creator": "tallison@mitre.org", "creation_time": "2016-10-24T16:44:20Z", "is_private": false, "attachment_id": null}]