[{"count": 0, "tags": [], "bug_id": 19429, "attachment_id": null, "id": 36295, "time": "2003-04-29T14:24:43Z", "creator": "s.tesch@science-computing.de", "creation_time": "2003-04-29T14:24:43Z", "is_private": false, "text": "When using Apache 2.0.45 as a reverse proxy to connect a client over HTTPS to an\norigin server also using HTTPS, mod_ssl sometimes chokes with the following\nerror message:\n\n[Tue Apr 29 16:00:49 2003] [debug] ssl_engine_io.c(1489): OpenSSL: I/O error, 5\nbytes expected to read on BIO#15bf58 [mem: 17daf8]\n[Tue Apr 29 16:00:49 2003] [info] (70007)The timeout specified has expired: SSL\ninput filter read failed.\n\nThe error only occurs when \"KeepAlive on\" is used. Once I turn that off, it\nworks seamlessly. The backend server is known to work without a problem as a\nstandalone server and in conjunction with an Apache 1.3.x reverse proxy.\n\nThe configuration of the reverse proxy looks like this:\n\nServerRoot \"/root/of/revproxy\"\nServerAdmin S.Tesch@science-computing.de\nServerName 192.168.1.1\nUser nobody\nGroup nogroup\nHostNameLookups   off\nUseCanonicalName  Off\nServerSignature   Off\nIdentityCheck     off\n<Directory />\nOptions -FollowSymLinks -SymLinksIfOwnerMatch\nAllowOverride None\n</Directory>\n\nTimeout                 300\nKeepAlive               On\nMaxKeepAliveRequests    100\nKeepAliveTimeout        15\n\nTypesConfig /root/of/revproxy/mime.types\nPidFile         /root/of/revproxy/httpd.pid\nProxyRequests   off\nProxyVia        off\n\nListen 192.168.2.1:443\n\n<VirtualHost 192.168.2.1:443>\n        SSLEngine on\n        ServerName      192.168.2.1\n        ServerAdmin     S.Tesch@science-computing.de\n\n        ProxyPass        / https://origin.server/\n        ProxyPassReverse / https://origin.server/\n\n        SSLProxyEngine on\n\n        SSLCipherSuite \nALL:!ADH:!EXP56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL\n\n        SSLCertificateFile      server.crt\n        SSLCertificateKeyFile   server.key\n\n        SSLVerifyClient none\n        SSLCARevocationPath     ssl.crl\n        SetEnvIf User-Agent \".*MSIE.*\" \\\n                nokeepalive ssl-unclean-shutdown \\\n                downgrade-1.0 force-response-1.0\n</VirtualHost>\n\nAn example of the output of a failed request is this:\n\n<head><title>Error: 304</title></head><body>\n<h1>Error: 304</h1>\n<h2>Location: /images/new.gif</h2></body>\nHTTP/1.1 200 OK\nDate: Tue, 29 Apr 2003 14:14:27 GMT\nServer: Apache/1.3.27 (Unix) Debian GNU/Linux PHP/4.2.3 mod_ssl/2.8.9\nOpenSSL/0.9.6g mod_perl/1.26 mod_jk/1.1.0\nTransfer-Encoding: chunked\nContent-Type: text/html; charset=iso-8859-1\n\n1ff8\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 3.2//EN\">\n<HTML>\n<HEAD>\n<META HTTP-EQUIV=\"Expires\" CONTENT=\"-1\">\n<TITLE>\n... and so on...\n                </tr>\n\n8  \n        \nd3f\n        <tr>\n... some more HTML stuff...\n</HTML>\n0\n\nIt seems to me that the HTTP Body of a previous 304 Not modified response is\nstill spooking around and delivered to the client right before the HTTP Header\nof the new response is sent. Then again, a part of the actually requested\ndocument is sent, the stream is interrupted and the remaining data of that page\nis sent. Very weird behaviour, as it only occurrs every now and then.\n\nIf you need more information to hunt this bug down, please contact me.\n\nKeep up the good work!"}, {"count": 1, "tags": [], "bug_id": 19429, "attachment_id": null, "text": "That reply is http 1.1 chunking, it looks fine to me in that regards.", "id": 62699, "time": "2004-08-30T04:03:38Z", "creator": "chip@force-elite.com", "creation_time": "2004-08-30T04:03:38Z", "is_private": false}, {"count": 2, "attachment_id": null, "creator": "s.tesch@science-computing.de", "text": "Well, it is not. The response should start with the HTTP result code (eg. \nHTTP/1.1 200 OK). But it starts with leftover stuff from one of the last \nrequests. \n \nAs I recall it this problem has been resolved in 2.0.47 or even earlier. But \nthanks for taking a look at it anyway! \n\n*** This bug has been marked as a duplicate of 14678 ***", "id": 62740, "time": "2004-08-30T09:36:19Z", "bug_id": 19429, "creation_time": "2004-08-30T09:36:19Z", "tags": [], "is_private": false}]