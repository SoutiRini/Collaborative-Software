[{"count": 0, "tags": [], "bug_id": 32040, "attachment_id": null, "id": 66344, "time": "2004-11-03T15:11:33Z", "creator": "mac@donnell.com", "creation_time": "2004-11-03T15:11:33Z", "is_private": false, "text": "I been playing with Tomcat5 for a few weeks now and it is very unstable for \nme.  The app I am making uses JSF, but far too frequently tomcat hangs.  Below \nis a thread dump of one such hang.  (Doing a thread dump actually frees \nwhatever the problem was.)\n\nI find it hard to believe that any Tomcat release has a problem like this, so I \nwas first pointing the finger at myself, but I can think of anything I am doing \nwrong.\n\nAlso, most of the internal IO routines are used in our swing app, which has no \nsuch issues (that I know of) and runs on the the same PC with the same VM \nexecutable.\n\nLastly, the thread dump doesn't show my code in any of the stack dumps.  \nPerhaps the thread dump hid the evidence...I don't know.\n\nWhen it is hung, the shutdown.bat runs and exits, but tomcat never exits.  I \nhave not tried this on any other platform or release, but am willing to help in \nany way I can to get this issue resolved.\n\nThanks\nMark\n-----------------------------------------\n\nFull thread dump Java HotSpot(TM) Client VM (1.4.1_07-b02 mixed mode):\n\n\"TP-Monitor\" daemon prio=5 tid=0x1730BFF8 nid=0x104 in Object.wait() \n[186df000..186dfd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042ED400> (a \norg.apache.tomcat.util.threads.ThreadPool$MonitorRunnable)\n        at org.apache.tomcat.util.threads.ThreadPool$MonitorRunnable.run\n(ThreadPool.java:559)\n        - locked <042ED400> (a \norg.apache.tomcat.util.threads.ThreadPool$MonitorRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"TP-Processor4\" daemon prio=5 tid=0x1733AD40 nid=0x654 runnable \n[1869f000..1869fd88]\n        at java.net.PlainSocketImpl.socketAccept(Native Method)\n        at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:353)\n        - locked <042ED4B0> (a java.net.PlainSocketImpl)\n        at java.net.ServerSocket.implAccept(ServerSocket.java:448)\n        at java.net.ServerSocket.accept(ServerSocket.java:419)\n        at org.apache.jk.common.ChannelSocket.accept(ChannelSocket.java:295)\n        at org.apache.jk.common.ChannelSocket.acceptConnections\n(ChannelSocket.java:638)\n        at org.apache.jk.common.SocketAcceptor.runIt(ChannelSocket.java:847)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:683)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"TP-Processor3\" daemon prio=5 tid=0x1730DDE0 nid=0x870 in Object.wait() \n[1865f000..1865fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042ED6D8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042ED6D8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"TP-Processor2\" daemon prio=5 tid=0x172FF478 nid=0x9e4 in Object.wait() \n[1861f000..1861fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042ED758> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042ED758> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"TP-Processor1\" daemon prio=5 tid=0x172FFAA0 nid=0x994 in Object.wait() \n[185df000..185dfd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042ED7D8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042ED7D8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Monitor\" prio=5 tid=0x17335808 nid=0x688 in Object.wait() \n[1859f000..1859fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AF3A0> (a \norg.apache.tomcat.util.threads.ThreadPool$MonitorRunnable)\n        at org.apache.tomcat.util.threads.ThreadPool$MonitorRunnable.run\n(ThreadPool.java:559)\n        - locked <042AF3A0> (a \norg.apache.tomcat.util.threads.ThreadPool$MonitorRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor25\" daemon prio=5 tid=0x17570BF0 nid=0x810 runnable \n[1855f000..1855fd88]\n        at java.net.PlainSocketImpl.socketAccept(Native Method)\n        at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:353)\n        - locked <03E1CC10> (a java.net.PlainSocketImpl)\n        at java.net.ServerSocket.implAccept(ServerSocket.java:448)\n        at java.net.ServerSocket.accept(ServerSocket.java:419)\n        at org.apache.tomcat.util.net.DefaultServerSocketFactory.acceptSocket\n(DefaultServerSocketFactory.java:60)\n        at org.apache.tomcat.util.net.PoolTcpEndpoint.acceptSocket\n(PoolTcpEndpoint.java:368)\n        at org.apache.tomcat.util.net.TcpWorkerThread.runIt\n(PoolTcpEndpoint.java:549)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:683)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor24\" daemon prio=5 tid=0x175700E8 nid=0x8b4 runnable \n[1851f000..1851fd88]\n        at java.net.SocketInputStream.socketRead0(Native Method)\n        at java.net.SocketInputStream.read(SocketInputStream.java:129)\n        at org.apache.coyote.http11.InternalInputBuffer.fill\n(InternalInputBuffer.java:737)\n        at org.apache.coyote.http11.InternalInputBuffer.parseRequestLine\n(InternalInputBuffer.java:398)\n        at org.apache.coyote.http11.Http11Processor.process\n(Http11Processor.java:761)\n        at \norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnectio\nn(Http11Protocol.java:705)\n        at org.apache.tomcat.util.net.TcpWorkerThread.runIt\n(PoolTcpEndpoint.java:577)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:683)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor23\" daemon prio=5 tid=0x1756F5E0 nid=0x8a0 in Object.wait() \n[184df000..184dfd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AF558> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AF558> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor22\" daemon prio=5 tid=0x1756EAD8 nid=0x9b4 in Object.wait() \n[1849f000..1849fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AF5D8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AF5D8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor21\" daemon prio=5 tid=0x176A4370 nid=0x804 in Object.wait() \n[1845f000..1845fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AF658> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AF658> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor20\" daemon prio=5 tid=0x176A3950 nid=0x858 in Object.wait() \n[1841f000..1841fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AF6D8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AF6D8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor19\" daemon prio=5 tid=0x176A2F30 nid=0x728 in Object.wait() \n[183df000..183dfd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AF758> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AF758> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor18\" daemon prio=5 tid=0x176A2528 nid=0x5b4 in Object.wait() \n[1839f000..1839fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AF7D8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AF7D8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor17\" daemon prio=5 tid=0x0088B6A0 nid=0x9cc in Object.wait() \n[1835f000..1835fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AF858> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AF858> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor16\" daemon prio=5 tid=0x0088AC80 nid=0xa0c in Object.wait() \n[1831f000..1831fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AF8D8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AF8D8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor15\" daemon prio=5 tid=0x00889A80 nid=0x864 in Object.wait() \n[182df000..182dfd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AF958> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AF958> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor14\" daemon prio=5 tid=0x00889090 nid=0x6f0 in Object.wait() \n[1829f000..1829fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AF9D8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AF9D8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor13\" daemon prio=5 tid=0x1769B228 nid=0x94c in Object.wait() \n[1825f000..1825fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AFA58> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AFA58> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor12\" daemon prio=5 tid=0x1769A808 nid=0x7f0 in Object.wait() \n[1821f000..1821fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AFAD8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AFAD8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor11\" daemon prio=5 tid=0x17644FF8 nid=0xa1c in Object.wait() \n[181df000..181dfd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AFB58> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AFB58> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor10\" daemon prio=5 tid=0x17644E00 nid=0x630 in Object.wait() \n[1819f000..1819fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AFBD8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AFBD8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor9\" daemon prio=5 tid=0x17643ED0 nid=0x96c in Object.wait() \n[1815f000..1815fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AFC58> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AFC58> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor8\" daemon prio=5 tid=0x17354B08 nid=0x6a8 in Object.wait() \n[1811f000..1811fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AFCD8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AFCD8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor7\" daemon prio=5 tid=0x173548F8 nid=0x980 in Object.wait() \n[180df000..180dfd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AFD58> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AFD58> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor6\" daemon prio=5 tid=0x17353EF0 nid=0xa4c in Object.wait() \n[1809f000..1809fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AFDD8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AFDD8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor5\" daemon prio=5 tid=0x17353588 nid=0x640 in Object.wait() \n[1805f000..1805fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AFE58> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AFE58> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor4\" daemon prio=5 tid=0x17640550 nid=0xa20 in Object.wait() \n[1801f000..1801fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AFED8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AFED8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor3\" daemon prio=5 tid=0x172E4F38 nid=0x674 in Object.wait() \n[17fdf000..17fdfd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AFF58> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AFF58> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor2\" daemon prio=5 tid=0x16CC7E38 nid=0x78c in Object.wait() \n[17f9f000..17f9fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042AFFD8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042AFFD8> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"http-8080-Processor1\" daemon prio=5 tid=0x16CED868 nid=0x83c in Object.wait() \n[17f5f000..17f5fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <042B0058> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Object.wait(Object.java:426)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:655)\n        - locked <042B0058> (a \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"ContainerBackgroundProcessor[StandardEngine[Catalina]]\" daemon prio=5 \ntid=0x176B0BF8 nid=0x7e0 waiting on condition [17f1f000..17f\nfd88]\n        at java.lang.Thread.sleep(Native Method)\n        at \norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run\n(ContainerBase.java:1597)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"Signal Dispatcher\" daemon prio=10 tid=0x008420E0 nid=0x118 waiting on \ncondition [0..0]\n\n\"Finalizer\" daemon prio=9 tid=0x0083E890 nid=0x7a4 in Object.wait() \n[16b4f000..16b4fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <03CEE998> (a java.lang.ref.ReferenceQueue$Lock)\n        at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:111)\n        - locked <03CEE998> (a java.lang.ref.ReferenceQueue$Lock)\n        at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:127)\n        at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:159)\n\n\"Reference Handler\" daemon prio=10 tid=0x0083D408 nid=0x754 in Object.wait() \n[16b0f000..16b0fd88]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <03CEEA00> (a java.lang.ref.Reference$Lock)\n        at java.lang.Object.wait(Object.java:426)\n        at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:113)\n        - locked <03CEEA00> (a java.lang.ref.Reference$Lock)\n\n\"main\" prio=5 tid=0x00235960 nid=0x628 runnable [6f000..6fc40]\n        at java.net.PlainSocketImpl.socketAccept(Native Method)\n        at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:353)\n        - locked <0430C9D8> (a java.net.PlainSocketImpl)\n        at java.net.ServerSocket.implAccept(ServerSocket.java:448)\n        at java.net.ServerSocket.accept(ServerSocket.java:419)\n        at org.apache.catalina.core.StandardServer.await\n(StandardServer.java:513)\n        at org.apache.catalina.startup.Catalina.await(Catalina.java:619)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:579)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke\n(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:324)\n        at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:287)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:425)\n\n\"VM Thread\" prio=5 tid=0x0083C1D0 nid=0x908 runnable\n\n\"VM Periodic Task Thread\" prio=10 tid=0x00840D98 nid=0x740 waiting on condition\n\"Suspend Checker Thread\" prio=10 tid=0x008416F8 nid=0x7ec runnable"}, {"count": 1, "tags": [], "bug_id": 32040, "text": "Chances are your code or one of the libraries it uses is spawning non-daemon \nthreads and not terminating them appropriately.  The VM and Tomcat can't do \nthis for you.  The reason your Swing app works is that it makes a System.exit \ncall (most likely) when exiting.  If you add such a call to a \nServletContextListener's contextDestroyed method, you'll get around the problem \nyou see, but it's just a band-aid.  This issue has been explained on the tomcat-\nuser list numerous times.", "id": 66346, "time": "2004-11-03T15:19:27Z", "creator": "yoavs@computer.org", "creation_time": "2004-11-03T15:19:27Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "mac@donnell.com", "text": ">The reason your Swing app works is that it makes a System.exit \n>call (most likely)\n\nThe hang is evidenced by its not exiting, but that is not where I notice it \nfirst.  Tomcat just hangs and stops responding in all web applications.  This \nshould happen even if I had a bad webapp, should it?  I don't know if it is \nusing any CPU while it is hanging (I never bothered to check).  However my CPU \nmonitor shows next to nothing so it couldn't be using more than 10% at most, or \nI would have noticed.\n\nAlso, if I do have thread problems, shouldn't they be in the thread dump?\n\nI know it is not your job to debug my code, and if you tell this is all my \nfault, I will largely believe you, but I wanted to make sure you understood my \nissue. \n\n", "id": 66364, "time": "2004-11-03T17:08:00Z", "bug_id": 32040, "creation_time": "2004-11-03T17:08:00Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 32040, "attachment_id": null, "id": 66367, "time": "2004-11-03T17:15:11Z", "creator": "yoavs@computer.org", "creation_time": "2004-11-03T17:15:11Z", "is_private": false, "text": "The thread dump seems reasonable, i.e. the threads are waiting on what they \nshould be waiting on.  I suggest using a better JDK (1.4.1 is terrible, 1.4.2 \nmuch better), and running inside a profiler to see if you can tell exactly \nwhat's happening when it hangs.  Then I suggest taking your findings to the \ntomcat-user list for further discussion and suggestions.  Bugzilla is not a \ngood discussion forum: you will get more and better advice on the list.  After \nthat, you can always reopen this issue if you have definitive and specific \npoints in the Tomcat code that cause this."}]