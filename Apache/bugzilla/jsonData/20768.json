[{"count": 0, "tags": [], "bug_id": 20768, "attachment_id": null, "is_private": false, "id": 38831, "time": "2003-06-13T21:33:26Z", "creator": "jeremyw-ant-bugzilla@igmus.org", "creation_time": "2003-06-13T21:33:26Z", "text": "ChainReaderHelper.getAssembledReader has bad code in simple use of custom \nfilterreaders.\n\nThe following code is reached by my attached custom filterreader -- and by my \nreckoning, can never work.  The index 'j' is always past the end of \narray 'constructors' when 'constructors[j]' is used.\n\nsee org.apache.tools.ant.filters.util.ChainReaderHelper.getAssembledReader:\n\n185                                              final Constructor[] \nconstructors =\n186                                                  clazz.getConstructors();\n187                                              int j = 0;\n188                                              for (; j < \nconstructors.length; j++) {\n189                                                  Class[] types = \nconstructors[j]\n190                                                                    .getParam\neterTypes();\n191                                                  if (types.length == 1 &&\n192                                                      types\n[0].isAssignableFrom(Reader.class)) {\n193                                                      break;\n194                                                  }\n195                                              }\n196                                              final Reader[] rdr = \n{instream};\n197                                              instream =\n198 umagesh 1.1                                      (Reader) constructors\n[j].newInstance(rdr);"}, {"count": 1, "tags": [], "creator": "jeremyw-ant-bugzilla@igmus.org", "text": "Created attachment 6815\nFirst attempt at a custom filterreader", "id": 38833, "time": "2003-06-13T21:34:39Z", "bug_id": 20768, "creation_time": "2003-06-13T21:34:39Z", "is_private": false, "attachment_id": 6815}, {"count": 2, "tags": [], "creator": "umagesh@apache.org", "attachment_id": null, "text": "Change your custom filter reader's constructors to be public and it will.", "id": 38844, "time": "2003-06-13T23:08:29Z", "bug_id": 20768, "creation_time": "2003-06-13T23:08:29Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 20768, "is_private": false, "text": "The second constructor should be public.\nThe ChainReaderHelper code should check\na valid constructor has been found and\nthrow a build exception if not.\n", "id": 38926, "time": "2003-06-16T14:20:25Z", "creator": "peter.reilly@corvil.com", "creation_time": "2003-06-16T14:20:25Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 20768, "is_private": false, "id": 38975, "attachment_id": null, "creator": "umagesh@apache.org", "creation_time": "2003-06-17T15:52:26Z", "time": "2003-06-17T15:52:26Z", "text": "I have just committed a patch.  A build exception will be thrown if \ngetAssembledReader is unable to find an appropriate constructor."}]