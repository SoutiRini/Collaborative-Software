[{"count": 0, "tags": [], "bug_id": 61266, "attachment_id": 35105, "id": 199651, "time": "2017-07-09T10:50:54Z", "creator": "gaurav.chd3@gmail.com", "creation_time": "2017-07-09T10:50:54Z", "is_private": false, "text": "Created attachment 35105\nDOC file\n\nThe full exception stack trace is included below:\n\norg.apache.tika.exception.TikaException: TIKA-198: Illegal IOException from org.apache.tika.parser.microsoft.OfficeParser@547eb45\n\tat org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:286)\n\tat org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)\n\tat org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:135)\n\tat org.apache.tika.parser.ParserDecorator.parse(ParserDecorator.java:188)\n\tat org.apache.tika.parser.DigestingParser.parse(DigestingParser.java:74)\n\tat org.apache.tika.gui.TikaGUI.handleStream(TikaGUI.java:357)\n\tat org.apache.tika.gui.TikaGUI.openFile(TikaGUI.java:308)\n\tat org.apache.tika.gui.ParsingTransferHandler.importFiles(ParsingTransferHandler.java:94)\n\tat org.apache.tika.gui.ParsingTransferHandler.importData(ParsingTransferHandler.java:77)\n\tat javax.swing.TransferHandler.importData(Unknown Source)\n\tat javax.swing.TransferHandler$DropHandler.drop(Unknown Source)\n\tat java.awt.dnd.DropTarget.drop(Unknown Source)\n\tat javax.swing.TransferHandler$SwingDropTarget.drop(Unknown Source)\n\tat sun.awt.dnd.SunDropTargetContextPeer.processDropMessage(Unknown Source)\n\tat sun.awt.dnd.SunDropTargetContextPeer$EventDispatcher.dispatchDropEvent(Unknown Source)\n\tat sun.awt.dnd.SunDropTargetContextPeer$EventDispatcher.dispatchEvent(Unknown Source)\n\tat sun.awt.dnd.SunDropTargetEvent.dispatch(Unknown Source)\n\tat java.awt.Component.dispatchEventImpl(Unknown Source)\n\tat java.awt.Container.dispatchEventImpl(Unknown Source)\n\tat java.awt.Component.dispatchEvent(Unknown Source)\n\tat java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)\n\tat java.awt.LightweightDispatcher.processDropTargetEvent(Unknown Source)\n\tat java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)\n\tat java.awt.Container.dispatchEventImpl(Unknown Source)\n\tat java.awt.Window.dispatchEventImpl(Unknown Source)\n\tat java.awt.Component.dispatchEvent(Unknown Source)\n\tat java.awt.EventQueue.dispatchEventImpl(Unknown Source)\n\tat java.awt.EventQueue.access$500(Unknown Source)\n\tat java.awt.EventQueue$3.run(Unknown Source)\n\tat java.awt.EventQueue$3.run(Unknown Source)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat java.security.ProtectionDomain$JavaSecurityAccessImpl.doIntersectionPrivilege(Unknown Source)\n\tat java.security.ProtectionDomain$JavaSecurityAccessImpl.doIntersectionPrivilege(Unknown Source)\n\tat java.awt.EventQueue$4.run(Unknown Source)\n\tat java.awt.EventQueue$4.run(Unknown Source)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat java.security.ProtectionDomain$JavaSecurityAccessImpl.doIntersectionPrivilege(Unknown Source)\n\tat java.awt.EventQueue.dispatchEvent(Unknown Source)\n\tat java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)\n\tat java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)\n\tat java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)\n\tat java.awt.EventDispatchThread.pumpEvents(Unknown Source)\n\tat java.awt.EventDispatchThread.pumpEvents(Unknown Source)\n\tat java.awt.EventDispatchThread.run(Unknown Source)\nCaused by: org.apache.poi.poifs.filesystem.NotOLE2FileException: Invalid header signature; read 0x0000AB000000BE31, expected 0xE11AB1A1E011CFD0 - Your file appears not to be a valid OLE2 document\n\tat org.apache.poi.poifs.storage.HeaderBlock.<init>(HeaderBlock.java:181)\n\tat org.apache.poi.poifs.storage.HeaderBlock.<init>(HeaderBlock.java:140)\n\tat org.apache.poi.poifs.filesystem.NPOIFSFileSystem.<init>(NPOIFSFileSystem.java:302)\n\tat org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:124)\n\tat org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)\n\t... 43 more"}, {"count": 1, "tags": [], "bug_id": 61266, "attachment_id": null, "is_private": false, "id": 199653, "time": "2017-07-09T11:35:44Z", "creator": "onealj@apache.org", "creation_time": "2017-07-09T11:35:44Z", "text": "Same comment as bug 61265 and bug 61257, please provide a better bug title and include the version of POI that you're using.\n\nYou can remove the javax.swing, java.awt, and sun calls in the stack trace."}, {"count": 2, "tags": [], "bug_id": 61266, "attachment_id": null, "is_private": false, "id": 199654, "time": "2017-07-09T11:41:53Z", "creator": "onealj@apache.org", "creation_time": "2017-07-09T11:41:53Z", "text": "Caused by: org.apache.poi.poifs.filesystem.NotOLE2FileException: Invalid header signature; read 0x0000AB000000BE31, expected 0xE11AB1A1E011CFD0 - Your file appears not to be a valid OLE2 document\n\nGoogle Docs reported your file as corrupt as well. Are you sure this is a valid doc file and not encrypted?"}, {"count": 3, "tags": [], "creator": "gaurav.chd3@gmail.com", "attachment_id": null, "text": "This is a valid DOC file. This is an old file (year 1991). When we open this file (with text encoding as windows default) and resave it in docx format. Then, the docx format gets parsed successfully.", "id": 199655, "time": "2017-07-09T11:58:15Z", "bug_id": 61266, "creation_time": "2017-07-09T11:58:15Z", "is_private": false}, {"text": "If this is a 1991 Word file, then perhaps HWPFOldDocument (for Word 6 and Word 95) should be used instead of HWPFDocument (BIFF8). It's possible that this file format predates Word 6.\n\nNot sure if POI or Tika should be specifying a different file handler, though it's possible POI (and therefore Tika) can't read this ancient format.\n\nThe o.a.p.poifs.storage.HeaderBlock constructor recognizes that this file is not a BIFF2, 3, or 4 document.", "tags": [], "creator": "onealj@apache.org", "attachment_id": null, "count": 4, "id": 199656, "time": "2017-07-09T12:38:42Z", "bug_id": 61266, "creation_time": "2017-07-09T12:38:42Z", "is_private": false}, {"count": 5, "tags": [], "text": "Looks like POI doesn't currently support reading this file format.\n\nOpening the binary file in a text editor reveals that most of the document contents are saved as ASCII, with a few special characters to embed figures and designate the start of sections. This doesn't look like any OLE2 file I have seen before.\n\nPresumably if all that is needed is text extraction, you could use `strings` on this document.\n\nChanging this to an enhancement request in case someone is interested in figuring out what archaic file format this is and writing a primitive parser that can extract text from the document.", "is_private": false, "id": 199657, "creator": "onealj@apache.org", "time": "2017-07-09T13:16:08Z", "bug_id": 61266, "creation_time": "2017-07-09T13:16:08Z", "attachment_id": null}, {"count": 6, "tags": [], "creator": "onealj@apache.org", "attachment_id": null, "id": 199658, "time": "2017-07-09T13:26:31Z", "bug_id": 61266, "creation_time": "2017-07-09T13:26:31Z", "is_private": false, "text": "Starting with 0x31be, the provided file is presumably a Microsoft Write file, typically found with a .wri extension, though later saved with a .doc extension and *optionally* saved in an OLE2 container (this file isn't). This format dates back to the Windows 1.0 days (1985).\n\nhttp://www.filesignatures.net/index.php?page=search&search=31BE&mode=SIG\nhttps://en.wikipedia.org/wiki/Microsoft_Write\n\nStrictly speaking, Write is not part of the Microsoft Office suite."}, {"count": 7, "tags": [], "bug_id": 61266, "attachment_id": null, "is_private": false, "id": 199659, "time": "2017-07-09T16:27:27Z", "creator": "apache@gagravarr.org", "creation_time": "2017-07-09T16:27:27Z", "text": "I've added a more helpful exception for these files in r1801376, based on the mime magic from Apache Tika for them"}, {"count": 8, "tags": [], "bug_id": 61266, "attachment_id": null, "id": 202998, "time": "2018-01-01T15:40:13Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2018-01-01T15:40:13Z", "is_private": false, "text": "I think we won't pursue full support for such ancient file formats, better to convert them to something newer as likely all sorts of tools won't be able to handle these files any more soon.\n\nDetection was improved, so we at least state now that we found a Write-document which we cannot read."}]