[{"count": 0, "tags": [], "bug_id": 525, "text": "Any code in the body of a jsp:useBean tag is only executed once, when the bean\nis instantiated.  Our code needs to initialize an application scoped bean, so we\nput a call to our initialize method into the body of the jsp:useBean.\n\nHowever, the call to the initialize method is outside the synchronized block\nwhich instantiates the bean.  This means that the initialize code may not have\nfinished running by the time another request comes in.  This second request will\nthen start calling methods in the bean for which variables have not been\ninitialized.\nCan the code in the body of the useBean tag be put into the synchronized block\nwhere the bean is instantiated?\n\nAn extract from a generated page follows:\n\n\n com.volantis.mcs.utilities.Volantis volantis = null;\n                boolean _jspx_specialvolantis  = false;\n                 synchronized (application) {\n                    volantis= (com.volantis.mcs.utilities.Volantis)\n\npageContext.getAttribute(\"volantis\",PageContext.APPLICATION_SCOPE);\n                    if ( volantis == null ) {\n                        _jspx_specialvolantis = true;\n                        try {\n                            volantis = (com.volantis.mcs.utilities.Volantis)\nBeans.instantiate(getClassLoader(), \"com.volantis.mcs.utilities.Volantis\");\n                        } catch (Exception exc) {\n                             throw new ServletException (\" Cannot create bean of\nclass \"+\"com.volantis.mcs.utilities.Volantis\");\n                        }\n                        pageContext.setAttribute(\"volantis\", volantis,\nPageContext.APPLICATION_SCOPE);\n                    }\n                 }\n---- Another request coming in, after the bean has been instantiated, but before\ninitialize has finished will skip this block\n                if(_jspx_specialvolantis == true) {\n            // end\n            // HTML // begin [file=\"/Volantis-mcs.jsp\";from=(5,33);to=(6,0)]\n                out.write(\"\\r\\n\");\n            // end\n            // begin [file=\"/Volantis-mcs.jsp\";from=(6,2);to=(6,35)]\n                volantis.initialize(application);\n            // end\n            // begin [file=\"/Volantis-mcs.jsp\";from=(4,0);to=(5,33)]\n                }", "id": 560, "time": "2001-02-05T05:29:10Z", "creator": "mat@volantis.com", "creation_time": "2001-02-05T05:29:10Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 525, "text": "Personally I agree that this is a problem, but I'm still waiting on feedback \nfrom the specification team on this subject.  It probably won't make it into \n3.2.2, but will be left open so that it can be addressed in a later release.", "id": 1460, "time": "2001-03-20T12:38:13Z", "creator": "marc.saegesser@apropos.com", "creation_time": "2001-03-20T12:38:13Z", "is_private": false, "attachment_id": null}]