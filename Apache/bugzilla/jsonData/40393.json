[{"count": 0, "attachment_id": null, "bug_id": 40393, "is_private": false, "id": 92906, "time": "2006-09-01T16:55:02Z", "creator": "kirillcool@yahoo.com", "creation_time": "2006-09-01T16:55:02Z", "tags": [], "text": "The JSVGComponent.loadSVGDocument creates a new Thread to load the specified\ndocument. If too many JSVGComponents are placed on the same page and initialized\nin a loop, this causes creation of too many threads and eventually leads to\nOutOfMemory error. It would be nice to have a thread pool of configurable size\n(static for the JSVGComponent class)."}, {"count": 1, "attachment_id": null, "bug_id": 40393, "is_private": false, "id": 92999, "time": "2006-09-04T23:43:56Z", "creator": "deweese@apache.org", "creation_time": "2006-09-04T23:43:56Z", "tags": [], "text": "(In reply to comment #0)\n> The JSVGComponent.loadSVGDocument creates a new Thread to load the specified\n> document. If too many JSVGComponents are placed on the same page and initialized\n> in a loop, this causes creation of too many threads and eventually leads to\n> OutOfMemory error. It would be nice to have a thread pool of configurable size\n> (static for the JSVGComponent class).\n\n   I doubt that the thread pool would help much.  In all likelyhood\nyou are just running out of memory.  If you haven't already I would\nsuggest increasing the default memory allocation in the JDK.\n\n   Also since we restrict ourself to JDK 1.3 we would either have\nthe create our own thread pool or add a dependency on another java\nlibrary (I suppose Apache Avalon or the like must have one).  Since\nI'm fairly convinced that the number of threads is not the real\nissue I am reluctant to do this.\n\n   If you can provide good evidence that the problem is the\nthreads rather than the memory needed to display lots of SVG\nimages feel free to reopen."}, {"count": 2, "tags": [], "creator": "kirillcool@yahoo.com", "is_private": false, "id": 93001, "creation_time": "2006-09-04T23:53:13Z", "time": "2006-09-04T23:53:13Z", "bug_id": 40393, "text": "Well, i don't have evidence that all the threads lead to OOM error. But, when\nyou have 500 components in a scroll pane, it's not a good idea to have 500\nthreads running in any case... What's wrong with a dependency on Apache\nExcalibur that have thread pool implementation (i'll need to see if it's good\nfor this specific scenario - see bug 40394). You already have js.jar,\npdf-transcoder.jar, xerces and xml-apis. It's not the first dependency you'd\nintroduce.", "attachment_id": null}, {"count": 3, "attachment_id": null, "bug_id": 40393, "is_private": false, "id": 93005, "time": "2006-09-05T00:38:20Z", "creator": "deweese@apache.org", "creation_time": "2006-09-05T00:38:20Z", "tags": [], "text": "(In reply to comment #2)\n> Well, i don't have evidence that all the threads lead to OOM error. But, when\n> you have 500 components in a scroll pane, it's not a good idea to have 500\n> threads running in any case... \n\n   Isn't it a bad idea to have 500 components in the scroll pane when the\nuser's going to see, what like 20?  The swing components are designed to\npopulate the view on demand. I would suggest using this feature.\n\n> What's wrong with a dependency on Apache Excalibur that have \n> thread pool implementation (i'll need to see if it's good\n> for this specific scenario - see bug 40394). \n\n    I don't have a hard rule against dependencies it's\na matter of balencing the provided functionality vs \nthe additional synchronization issues it cause everyone \n(users of Batik now need Batik's version of that library\nto match the version that other tools may be using just\nas an example).\n\n> You already have js.jar, pdf-transcoder.jar, xerces and \n> xml-apis. It's not the first dependency you'd\n> introduce.\n\n    The only one above that is a hard dependency is xml-apis\nwhich is kind of required for an XML implementation.\njs.jar & pdf-transcoder.jar are only required if you are\nusing their functionality.  The Xerces dependency is \nconfigurable (simply requires a SAX 2 interface,\nand has recently moved to JAXP).\n\n"}]