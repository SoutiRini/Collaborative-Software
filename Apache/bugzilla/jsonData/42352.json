[{"count": 0, "tags": [], "creator": "vitus@gw.ac-sw.com", "text": "I wrote some code\n       final TIFFRenderer render = new TIFFRenderer() {\n          protected BufferedImage getBufferedImage(int w, int h) {\n            return new BufferedImage(w, h, BufferedImage.TYPE_BYTE_GRAY);\n          }\n        };\n        render.setUserAgent(userAgent);\n        userAgent.setRendererOverride(render);\n\n... and try exception\njavax.xml.transform.TransformerException: java.lang.ClassCastException\n        at\norg.apache.xalan.transformer.TransformerImpl.transformNode(TransformerImpl.java:1430)\n        at\norg.apache.xalan.transformer.TransformerImpl.transform(TransformerImpl.java:709)\n        at\norg.apache.xalan.transformer.TransformerImpl.transform(TransformerImpl.java:1284)\n        at\norg.apache.xalan.transformer.TransformerImpl.transform(TransformerImpl.java:1262)\n        at\ncom.academsoft.printing.PrintingProtocol.processOutData(PrintingProtocol.java:206)\n        at\ncom.academsoft.printing.PrintingProtocol.processInput(PrintingProtocol.java:173)\n        at com.academsoft.printing.Worker.process(Worker.java:48)\n        at com.academsoft.printing.Worker.run(Worker.java:68)\nCaused by: java.lang.ClassCastException\n        at\norg.apache.fop.render.bitmap.TIFFRenderer$LazyPageImagesIterator.next(TIFFRenderer.java:234)\n        at\norg.apache.fop.render.bitmap.TIFFRenderer.stopRenderer(TIFFRenderer.java:166)\n        at\norg.apache.fop.area.RenderPagesModel.endDocument(RenderPagesModel.java:241)\n        at org.apache.fop.area.AreaTreeHandler.endDocument(AreaTreeHandler.java:426)\n        at org.apache.fop.fo.FOTreeBuilder.endDocument(FOTreeBuilder.java:171)\n        at\norg.apache.xml.serializer.ToXMLSAXHandler.endDocument(ToXMLSAXHandler.java:181)\n        at\norg.apache.xalan.transformer.TransformerImpl.transformNode(TransformerImpl.java:1378)\n        ... 7 more\n\nwrote patch\n\ndiff -rNu fop-0.93/src/java/org/apache/fop/render/bitmap/TIFFRenderer.java\nfop-0.93.orig/src/java/org/apache/fop/render/bitmap/TIFFRenderer.java\n--- fop-0.93/src/java/org/apache/fop/render/bitmap/TIFFRenderer.java   \n2007-05-08 16:51:02.000000000 +0700\n+++ fop-0.93.orig/src/java/org/apache/fop/render/bitmap/TIFFRenderer.java      \n2007-01-04 02:44:43.000000000 +0600\n@@ -230,11 +230,10 @@\n                 return pageImage;\n             } else {\n                 //Decorate the image with a packed sample model for encoding by\nthe codec\n-              final SampleModel sampleModel = pageImage.getSampleModel();\n-//              SinglePixelPackedSampleModel sppsm;\n-//                sppsm = (SinglePixelPackedSampleModel)pageImage.getSampleModel();\n+                SinglePixelPackedSampleModel sppsm;\n+                sppsm = (SinglePixelPackedSampleModel)pageImage.getSampleModel();\n\n-                int bands = sampleModel.getNumBands();\n+                int bands = sppsm.getNumBands();\n                 int[] off = new int[bands];\n                 int w = pageImage.getWidth();\n                 int h = pageImage.getHeight();\n\nand all works.\n\nps. \nProduct:  \tFop.\n Component: - no tiff.", "id": 102932, "time": "2007-05-08T03:58:11Z", "bug_id": 42352, "creation_time": "2007-05-08T03:58:11Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "vitus@gw.ac-sw.com", "text": "Created attachment 20144\npatch for tiffrender\n\npatch for tiffrender", "id": 102933, "time": "2007-05-08T03:59:20Z", "bug_id": 42352, "creation_time": "2007-05-08T03:59:20Z", "is_private": false, "attachment_id": 20144}, {"count": 2, "tags": [], "bug_id": 42352, "attachment_id": null, "is_private": false, "id": 102934, "time": "2007-05-08T04:01:51Z", "creator": "vitus@gw.ac-sw.com", "creation_time": "2007-05-08T04:01:51Z", "text": "It's reverse patch!\npatch -R"}, {"count": 3, "tags": [], "creator": "gadams@apache.org", "text": "resetting P2 open bugs to P3 pending further review", "id": 157307, "time": "2012-04-07T01:41:22Z", "bug_id": 42352, "creation_time": "2012-04-07T01:41:22Z", "is_private": false, "attachment_id": null}]