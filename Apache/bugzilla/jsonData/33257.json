[{"count": 0, "tags": [], "bug_id": 33257, "text": "I am having problems setting debug on with my javac tasks.  I've tried \ndebug=\"on\", debug=\"true\", debug=on and debug=true.  All permutations are \nresolving to -g:none on the resulting javac command.  I have also messed with \nvarious debuglevels to try effecting the -g parameters with no luck.\n\nOur environment is one of an automated build process we've created internally.  \nWe are executing ant build via an executable java application.  We are using a \nIBM WebSphere Studio's java bin as our JAVA_HOME.", "id": 70127, "time": "2005-01-26T23:24:48Z", "creator": "bjhess@fedins.com", "creation_time": "2005-01-26T23:24:48Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 33257, "text": "What value are you specifying in the debuglevel attribute?", "id": 70130, "time": "2005-01-26T23:55:34Z", "creator": "mbenson@apache.org", "creation_time": "2005-01-26T23:55:34Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 33257, "text": "I have tried specifying all debuglevels (e.g. debuglevel=\"lines,vars,source\") \nand no debuglevels (e.g. not even including the attribute).", "id": 70171, "attachment_id": null, "creator": "bjhess@fedins.com", "creation_time": "2005-01-27T13:54:08Z", "time": "2005-01-27T13:54:08Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 33257, "is_private": false, "id": 70173, "attachment_id": null, "creator": "stevel@apache.org", "creation_time": "2005-01-27T15:13:50Z", "time": "2005-01-27T15:13:50Z", "text": "We have to warn you that it works for everyone else. So if it isnt working in\nyour case, it is probably something unusual about your configuration.\n\n1. what is the complete javac command.\n\n2. how are you testing that there is no debug information?\n\n3. what is your javac compiler? You say Websphere is JAVA_HOME -does it come\nwith its own version of javac. if so, what does it say its options and version are."}, {"count": 4, "tags": [], "text": "1.\n\nThe javac task is (since I don't think you are really looking for this, I'm not \ngoing to blow out all the variables):\n\n<javac destdir=\"${build}\" compiler=\"modern\" debug=\"on\">\n\t<src path=\"${source_dir}\" />\n\t<src path=\"${src_dir}\" />\n\t<classpath>\n\t\t<fileset dir=\"${ear_app}\">\n\t\t\t<include name=\"**/*.jar\" />\n\t\t</fileset>\n\t\t<fileset dir=\"${dependent_jars}\">\n\t\t\t<include name=\"**/*.jar\" />\n\t\t</fileset>\n\t\t<fileset dir=\"${server_v5_jars}\">\n\t\t\t<include name=\"**/*.jar\" />\n\t\t</fileset>\n\t\t<fileset dir=\"${server_v51_jars}\">\n\t\t\t<include name=\"**/*.jar\" />\n\t\t</fileset>\n\t\t<fileset dir=\"${server_v51_ext_jars}\">\n\t\t\t<include name=\"**/*.jar\" />\n\t\t</fileset>\n\t</classpath>\n</javac>\n\n\nThe javac command is (I'm not 100% sure of the syntax since I'm pulling this \nout of parts of the ant logs):\n\njavac -d 'C:\\Java Deployment Utility\\SIE Projects\\Java Infra\\TEST\\test \njava\\classes' -classpath 'a very large list of directories' -\nsourcepath 'C:\\Java Deployment Utility\\SIE Projects\\Java Infra\\TEST\\test \njava\\source;C:\\Java Deployment Utility\\SIE Projects\\Java Infra\\TEST\\test \njava\\src' -g:none\n\n2.\n\nBesides seeing the ant log that shows -g:none, I am also trying to debug within \nWSSD (WebSphere Studio and receiving an error that generally says \"The \nbreakpoint cannot be installed.  Class files must be generated with the line \nnumber attributes.\"\n\nIf I export the JAR from WSSD rather than using Ant to build it, this error \ndoes not occur.\n\n3.\n\nWSSD comes with its own version of javac.  From what I can see the version is \n1.4.1.0 and it _appears_ to be provided by IBM.  Unfortunately I'm not sure how \nto determine what its \"options\" are.\n\nI downloaded J2SE5 (javac 1.5.0-b64) from Sun with the same results.", "is_private": false, "bug_id": 33257, "id": 70180, "time": "2005-01-27T16:14:24Z", "creator": "bjhess@fedins.com", "creation_time": "2005-01-27T16:14:24Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 33257, "attachment_id": null, "is_private": false, "id": 70195, "time": "2005-01-27T18:39:56Z", "creator": "bjhess@fedins.com", "creation_time": "2005-01-27T18:39:56Z", "text": "I created a simple example to attempt to get my -g options working.  In this \nsimple example I was able to create the various debug options, judging by the \nrecorder's output.  I'm sure this comes as no surprise to you.\n\nIs it possible that there is a problem executing ant via Java with the \norg.apache.tools.ant.* classes?  Not sure if this will make any sense to you, \nbut here's the code we use to execute the build:\n\t\npublic static boolean createInfrastructureJar(\n\tString sandboxLocation,\n\tString destinationFileLocation,\n\tString sourceSandboxLocation,\n\tString stagingProjectMemberName) {\n\nAnt task = new Ant();\ntask.setInheritAll(true);\ntask.setAntfile(\n\tUtilityConstants.UTILITY_LOCATION\n\t\t+ \"\\\\infrastructure_jar_build.xml\");\n\n//set the value of other properties....\nProject project = new Project();\nproject.setProperty(\"work_area\", UtilityConstants.UTILITY_LOCATION);\nproject.setProperty(\"sandbox_location\", sandboxLocation);\nproject.setProperty(\"destination_file_location\", destinationFileLocation);\nproject.setProperty(\"source_sandbox_location\", sourceSandboxLocation);\nproject.setProperty(\n\t\"staging_project_member_name\",\n\tstagingProjectMemberName);\n\nboolean successfulBuild = executeAnt(task, project);\n\nreturn successfulBuild;\n}"}, {"attachment_id": null, "tags": [], "creator": "mbenson@apache.org", "is_private": false, "count": 6, "id": 70198, "time": "2005-01-27T18:58:11Z", "bug_id": 33257, "creation_time": "2005-01-27T18:58:11Z", "text": "Does UtilityConstants.UTILITY_LOCATION + \"\\\\infrastructure_jar_build.xml\") point\nto a valid Ant buildfile that contains everything you need for your build?  If\nso, have you tried running it through plain Ant to exonerate your execution\nframework here?"}, {"count": 7, "tags": [], "bug_id": 33257, "attachment_id": null, "text": "I have now run through Ant on the command line and have found the debug options \nto work correctly.  Any ideas when looking at the Java code I used to execute \n(Comment #5)?  I will be looking at alternative execution methods as I wait for \nmore comments...", "id": 70203, "time": "2005-01-27T21:23:06Z", "creator": "bjhess@fedins.com", "creation_time": "2005-01-27T21:23:06Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 33257, "attachment_id": null, "is_private": false, "id": 70211, "time": "2005-01-27T23:24:55Z", "creator": "bjhess@fedins.com", "creation_time": "2005-01-27T23:24:55Z", "text": "We modified the code used to execute the Ant from Java:\n\npublic static boolean createInfrastructureJar(\n\tString sandboxLocation,\n\tString destinationFileLocation,\n\tString sourceSandboxLocation,\n\tString stagingProjectMemberName) {\n\n\t//set the value of other properties....\n\tProject project = new Project();\n\tproject.init();\n\tproject.setProperty(\"work_area\", UtilityConstants.UTILITY_LOCATION);\n\tproject.setProperty(\"sandbox_location\", sandboxLocation);\n\tproject.setProperty(\n\t\t\"destination_file_location\",\n\t\tdestinationFileLocation);\n\tproject.setProperty(\"source_sandbox_location\", sourceSandboxLocation);\n\tproject.setProperty(\n\t\t\"staging_project_member_name\",\n\t\tstagingProjectMemberName);\n\n\tFile buildFile =\n\t\tnew File(\n\t\t\tUtilityConstants.UTILITY_LOCATION\n\t\t\t\t+ \"\\\\infrastructure_jar_build.xml\");\n\tProjectHelperImpl projectHelper = new ProjectHelperImpl();\n\tboolean successfulBuild = true;\n\ttry {\n\t\tprojectHelper.parse(project, buildFile);\n\t\tproject.executeTarget(\"all\");\n\t} catch (BuildException e) {\n\t\tsuccessfulBuild = false;\n\t}\n\n\treturn successfulBuild;\n}\n\n\n\nIt appears this issue is closed.  I haven't taken the time to analyze our \nchanges, but I know we quit using the Ant class entirely.\n\nThanks for your help in leading us down the right path."}, {"count": 9, "tags": [], "bug_id": 33257, "text": "Okay, one last thing is that you may want to consider using ProjectHelper2 over\nProjectHelperImpl.  I don't know all the pitfalls of using the latter but I know\nthey exist.  If you start having trouble, try using using a ProjectHelper2 instead.", "id": 70213, "time": "2005-01-27T23:41:34Z", "creator": "mbenson@apache.org", "creation_time": "2005-01-27T23:41:34Z", "is_private": false, "attachment_id": null}]