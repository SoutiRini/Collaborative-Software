[{"count": 0, "tags": [], "creator": "apache@haimsoft.com", "attachment_id": null, "text": "The CellIterator inner class (of HSSFRow, line 436) will skip the first cell.\n\nProblem being: \n- nextId begins at 0\n- the constructor calls findNext()\n- findNext increments nextId before selecting the first populated cell.\n\nQuick and easy fix is to default nextId to -1 so findNext() will increment to 0\nfirst time around.\n\nNot quite sure how to submit code changes, so thought this would do the job\n(marked as PatchAvailable).", "id": 92338, "time": "2006-08-18T13:58:44Z", "bug_id": 40285, "creation_time": "2006-08-18T13:58:44Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 40285, "text": "Good catch. Keep it up. Applied to Svn. Feel free in inspect and comment if\nreuqired.\n\nJason", "id": 92552, "time": "2006-08-25T22:22:38Z", "creator": "jheight@apache.org", "creation_time": "2006-08-25T22:22:38Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 40285, "is_private": false, "text": "This bug is still in the 3.0-alpha2-20060616 ", "id": 94325, "time": "2006-10-01T00:37:40Z", "creator": "cam@rocketdog.com.au", "creation_time": "2006-10-01T00:37:40Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 40285, "text": "I've also experienced this behavior. Attaching a code snippet:\n\n\tprivate String extractExcel( InputStream stream ) throws IOException {\n\t\tHashSet set = new HashSet();\n\t\tHSSFWorkbook workbook = new HSSFWorkbook(stream);\n\t\tint sheetCount = workbook.getNumberOfSheets();\n\t\tint resultLength = 0;\n\t\tfor( int i = 0 ; i < sheetCount ; i++ ) {\n\t\t\t//System.out.println( \"Reading sheet #\" + (i+1) );\n\t\t\tHSSFSheet at = workbook.getSheetAt( i );\n\t\t\tint rowCount = at.getPhysicalNumberOfRows();\n\t\t\tfor (int j = 0; i< rowCount; j++)  {\n\t\t\t\t//System.out.println( \"Reading row #\" + (j+1) );\n\t\t\t\tHSSFRow row = at.getRow( j );\n\t\t\t\tif (row == null) break;\n\t\t\t\tfor( Iterator iterator = row.cellIterator(); iterator.hasNext(); ) {\n\t\t\t\t\tHSSFCell cell = (HSSFCell)iterator.next();\n\t\t\t\t\tif( cell.getCellType() == HSSFCell.CELL_TYPE_STRING ) {\n\t\t\t\t\t\tString string = cell.getRichStringCellValue().getString();\n\t\t\t\t\t\tif( string != null && string.length() > 0 ) {\n\t\t\t\t\t\t\tif (set.add( string )) {\n\t\t\t\t\t\t\t\tresultLength += string.length();\n\t\t\t\t\t\t\t\tresultLength++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tStringBuffer result = new StringBuffer(resultLength);\n\t\tfor( Iterator iterator = set.iterator(); iterator.hasNext(); ) {\n\t\t\tresult.append( (String)iterator.next() ).append( ' ');\n\t\t}\n\t\treturn result.toString();\n\t}\n", "id": 95627, "time": "2006-11-09T10:49:19Z", "creator": "ssb_jakarta@360works.com", "creation_time": "2006-11-09T10:49:19Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 40285, "is_private": false, "text": "Works as of 12Jan2007, Testcase added. \nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=41366\n\nPlease verify!", "id": 98112, "time": "2007-01-16T01:46:18Z", "creator": "avik@apache.org", "creation_time": "2007-01-16T01:46:18Z", "attachment_id": null}]