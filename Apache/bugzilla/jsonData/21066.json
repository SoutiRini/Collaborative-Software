[{"count": 0, "tags": [], "bug_id": 21066, "attachment_id": null, "text": "I have tried:\njakarta-poi-1.8.0-dev-20020919.jar\njakarta-poi-1.10.0-dev-20030222.jar\npoi-2.0-pre1-20030517.jar\n\nIn each case using POI to modify a blank (open Excel press save) spreadsheet\ncreated using each of:\nExcel 2000 (9.0.2720)\nExcel 2002 (10.2614.2625)\nresulted in a blank spreadsheet\n\nUsing other input spreadsheets of varying complexity would result in a corrupt\noutput spreadsheet\nBut generally the result spreadsheet appeared as if it had not been modified\n\nThis problem does not occur using jakarta-poi-1.5.1-final-20020615.jar\n\n\n\nCode sample:\n\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\n\nimport org.apache.poi.poifs.filesystem.POIFSFileSystem;\nimport org.apache.poi.hssf.usermodel.HSSFWorkbook;\nimport org.apache.poi.hssf.usermodel.HSSFSheet;\nimport org.apache.poi.hssf.usermodel.HSSFRow;\nimport org.apache.poi.hssf.usermodel.HSSFCell;\n\npublic class testPOI {\n\tpublic static void main(String[] args) throws java.io.IOException,\njava.io.FileNotFoundException {\n\t\t// section 1\n\t\tPOIFSFileSystem fs = new POIFSFileSystem(new FileInputStream(\"blank.xls\"));\n\t\tHSSFWorkbook wb = new HSSFWorkbook(fs);\n\t\tHSSFSheet sheet = wb.getSheetAt(0);\n\t\t\n\t\t// section 2\n\t\t//HSSFWorkbook wb = new HSSFWorkbook();\n\t\t//HSSFSheet sheet = wb.createSheet(\"new sheet\");\n\t\t\n\t\tHSSFRow row = sheet.getRow(2);\n\t\tif(row == null)\n\t\t\trow = sheet.createRow((short)2);\n\t\tHSSFCell cell = row.getCell((short)3);\n\t\tif(cell == null)\n\t\t\tcell = row.createCell((short)3);\n\t\tcell.setCellType(HSSFCell.CELL_TYPE_STRING);\n\t\tcell.setCellValue(\"a test\");\n\t\t\n\t\tFileOutputStream fileOut = new FileOutputStream(\"output.xls\");\n\t\twb.write(fileOut);\n\t\tfileOut.close();\n\t}\n}", "id": 39372, "time": "2003-06-24T21:57:54Z", "creator": "tschafer@hotmail.com", "creation_time": "2003-06-24T21:57:54Z", "is_private": false}, {"count": 1, "tags": [], "text": "If however section 1 is commented out and section 2 is enabled\ncausing a new wb and sheet to be created the example works fine\nwith the newer versions of POI", "is_private": false, "id": 39374, "creator": "tschafer@hotmail.com", "time": "2003-06-24T22:00:58Z", "bug_id": 21066, "creation_time": "2003-06-24T22:00:58Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 21066, "attachment_id": 6961, "id": 39375, "time": "2003-06-24T22:02:22Z", "creator": "tschafer@hotmail.com", "creation_time": "2003-06-24T22:02:22Z", "is_private": false, "text": "Created attachment 6961\ntestPOI.java"}, {"count": 3, "tags": [], "text": "Created attachment 7283\nExcel 2000 blank spreadsheet", "attachment_id": 7283, "bug_id": 21066, "id": 40650, "time": "2003-07-14T16:54:49Z", "creator": "tschafer@hotmail.com", "creation_time": "2003-07-14T16:54:49Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 21066, "attachment_id": 7284, "id": 40651, "time": "2003-07-14T16:55:24Z", "creator": "tschafer@hotmail.com", "creation_time": "2003-07-14T16:55:24Z", "is_private": false, "text": "Created attachment 7284\nExcel 2002 blank spreadsheet"}, {"count": 5, "tags": [], "text": "we need to fix this..  I think there is a dupe.", "is_private": false, "id": 41412, "creator": "poi-support@buni.org", "time": "2003-07-24T16:59:42Z", "bug_id": 21066, "creation_time": "2003-07-24T16:59:42Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 21066, "attachment_id": null, "id": 41800, "time": "2003-07-30T18:47:22Z", "creator": "tschafer@hotmail.com", "creation_time": "2003-07-30T18:47:22Z", "is_private": false, "text": "This is still broken in poi-2.0-pre3-20030728.jar"}, {"count": 7, "tags": [], "bug_id": 21066, "attachment_id": null, "id": 44394, "time": "2003-09-21T11:19:03Z", "creator": "glens@apache.org", "creation_time": "2003-09-21T11:19:03Z", "is_private": false, "text": "There's a fix in CVS that I just commited that might solve your problem.  Try\nout this jar: http://www.apache.org/~glens/poi-20030921.jar"}]