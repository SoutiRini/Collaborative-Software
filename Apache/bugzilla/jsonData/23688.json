[{"count": 0, "tags": [], "bug_id": 23688, "attachment_id": null, "id": 45265, "time": "2003-10-08T22:29:11Z", "creator": "mkerr@webct.com", "creation_time": "2003-10-08T22:29:11Z", "is_private": false, "text": "I am using the the code that follows to set up an appender to ant log file from\nthe log4j events.  The only problem is I cannot set the log4j logging level\naccording to the ant logging level because there is no method to get the ant\nlogging level.  In order to see the logging then I must set logging in log4j to\nall and then let ant logging filter but this can really hurt performance if\nthere is alot of logging.\n\n\t// redirect log4j to ant logger\n\tAppender appender = Log4jToAnt.getAppenderForTask( this);\n\tLogger rootLogger = LogManager.getRootLogger();\n\tLevel savedRootLoggerLevel = rootLogger.getLevel();\n\tif( log4jDebug ) {\n\t    rootLogger.setLevel( Level.ALL); // turn on all logging and let ant filter\n\t} else {\n\t    rootLogger.setLevel( Level.ERROR); // turn off logging for improved speed\n\t}\n\t// TODO: performance improvement: find out way to detect ant logging level and\nset appropriately.\n\t// Note: Ant does not expose the logging value so we would need to modify ant\n!!! arg\n\tBasicConfigurator.configure( appender);\n\n\n    public static final int getAntMsgInt( Level level ) {\n\tif( level == Level.DEBUG ) {\n\t    return Project.MSG_DEBUG;\n\t} else if( level == Level.INFO ) {\n\t    return Project.MSG_VERBOSE;\n\t} else if( level == Level.WARN ) {\n\t    return Project.MSG_WARN;\n\t} else if( level == Level.ERROR ) {\n\t    return Project.MSG_ERR;\n\t} else if( level == Level.FATAL ) {\n\t    return Project.MSG_ERR;\n\t} else {\n\t    return Project.MSG_VERBOSE;\n\t}\n    }\n\n    public static final Appender getAppenderForTask( final Task task) {\n\treturn new AppenderSkeleton() {\n\t\tTask _task = task;\n\t\t{\n\t\t    _task.log( \"Started redirect of log4j to ant logger\", Project.MSG_VERBOSE );\n\t\t}\n\t\tpublic void append(LoggingEvent event) {\n\t\t    _task.log( event.getLoggerName().substring(\nevent.getLoggerName().lastIndexOf( \".\")+1) + \" \" + event.getRenderedMessage(),\ngetAntMsgInt( event.getLevel()));\n\t\t}\n\t\tpublic void close() {\n\t\t}\n                public boolean requiresLayout() { \n                    return false; \n\t\t}\n\t    };\n    }"}, {"attachment_id": null, "tags": [], "bug_id": 23688, "text": "\n\n*** This bug has been marked as a duplicate of 22460 ***", "count": 1, "id": 72608, "time": "2005-03-17T16:26:10Z", "creator": "bodewig@apache.org", "creation_time": "2005-03-17T16:26:10Z", "is_private": false}]