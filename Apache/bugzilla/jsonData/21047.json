[{"attachment_id": null, "tags": [], "creator": "hauser@acm.org", "is_private": false, "count": 0, "id": 39345, "time": "2003-06-24T14:29:09Z", "bug_id": 21047, "creation_time": "2003-06-24T14:29:09Z", "text": "As per http://fries.pushtotest.com/pipermail/users/2003-June/000772.html, I am\nrunning a jython script out of an ant file.\nThis works fine as long as I don't to add the statement\n\nimport os\n\nto the python script.\n\nThe same script works fine when called from the command line with the following\ndefinition:\njava.exe -Dpython.home=.\\lib\\jython ...\n\nIt would be great to be able to set evironment variables etc. similarly to the \n<env key=\"PYTHON_HOME\" value=\"${TestMakerDir/lib/jython}\"/ >\nas per http://ant.apache.org/manual/CoreTasks/exec.html also for the <script> tag."}, {"count": 1, "tags": [], "bug_id": 21047, "text": "also, if <script language=\"jpython\" ...\n\nit would be great if it were possible to access properties defined in ant (via\nbuild.xml or -D on the command line) from inside the (jpython) script somehow.\n\nUnfortunately, I couldn't get the below to work.\nbuild.xml:\n<<\n   <property name=\"jython.sys.path.lib\"\n\tlocation=\"${TestMakerDir}/lib/jython/Lib\" />\n>>\nand the test.a python script:\n<<from java.lang import System\njython_syspath_ant = System.getProperty( \"jython.sys.path.lib\")>>\n\nthe property was emtpy/'None'.\n\nFor this case an \"inheritall\" attribute as in\nhttp://ant.apache.org/manual/CoreTasks/antcall.html might be sufficient?", "id": 39353, "time": "2003-06-24T16:00:23Z", "creator": "hauser@acm.org", "creation_time": "2003-06-24T16:00:23Z", "is_private": false, "attachment_id": null}, {"count": 2, "text": "You are confusing some things, I'm afraid.\n\nWhen you use java -D... you are not setting environment variables, you set system\nproperties.  Setting env variables is not going to help at all, as Jython won't\nlook at them.\n\nYou will want to set the system property python.home for the Java VM that runs your\nscript task.  To do so, set the environment variable ANT_OPTS to\n-Dpython.home=.\\lib\\jython.  Alternatively you can use a registry in the\n.jython file in your home directory (no idea whether/how that works on Windows).\nSee thy Jython FAQ http://www.jython.org/cgi-bin/faqw.py?req=index\n\nAnt's properties are script variables automatically.  To expand property foo,\nyou don't use ${foo} in your script but simply foo.\n\nAlso, all references get turned into script objects, this includes the Project\ninstance which is access by its name.  If your project starts with\n\n<project name=\"kelwit\" ...>\n\nyou can access property jython.sys.path.lib as \nkelwit.getProperty(\"jython.sys.path.lib\") - it is not accessible via\nSystem.getProperty as <property> doesn't set system properties but properties\nof the Ant project instance.\n", "bug_id": 21047, "attachment_id": null, "id": 39414, "time": "2003-06-25T14:05:22Z", "creator": "bodewig@apache.org", "creation_time": "2003-06-25T14:05:22Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 21047, "text": "Thanks - this \n\n\"antprojectname\".getProperty(\"ant-property-name\")\n\ndoes work!\n\nSuggestion: mention this on the script.html page!!!\n------------\nRe environment variables:\n\nAs far as I understand, in my python script \n<<\nimport os\nusername = os.environ.get('USER')\n>>\nwould work too - if I could set it (i.e. \"USER\" for example) before starting jython.", "id": 39416, "time": "2003-06-25T14:34:37Z", "creator": "hauser@acm.org", "creation_time": "2003-06-25T14:34:37Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 21047, "text": "FYI - you don't need to use the project name literally to get to the project object.  Simply use \n'project' -makes scripts much more portable!", "id": 39424, "time": "2003-06-25T15:18:17Z", "creator": "jakarta@ehatchersolutions.com", "creation_time": "2003-06-25T15:18:17Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 21047, "text": "it is even such that ant properties (as long as they don't contain a \".\" in the\nname) can be accessed directly!", "id": 39432, "time": "2003-06-25T18:39:29Z", "creator": "hauser@acm.org", "creation_time": "2003-06-25T18:39:29Z", "is_private": false, "attachment_id": null}]