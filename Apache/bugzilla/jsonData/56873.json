[{"count": 0, "tags": [], "text": "Created attachment 31932\nMinimal example for NPE, <gzipresource>\n\nThis NPE was reliably reproducable in my Linux (Debian stable), with Ant 1.9.4. \n\nWhen trying to copy contents from a tar.gz file via a URL, it generates a NullPointException. --- It seems that this is caused by <gzipresource>, when I give this URL (ftp). \n\nHere's the minimal build script that gives me reliable reproduce in my Linux. Interestingly, on OSX, this \"hangs\" the Ant; but no NPE. \n\n( Note that the following build works all okay with 1.9.3 and below. ) \n\n=== \n<project basedir=\".\" default=\"test2\">\n<target name=\"test2\">\n<sequential>\n  <copy todir=\"temp/\">\n    <tarfileset>\n      <gzipresource>\n        <url url=\"ftp://ftp.ims.uni-stuttgart.de/pub/corpora/tree-tagger-MacOSX-3.2-intel.tar.gz\"/>\n      </gzipresource>\n    </tarfileset> \n      \n  </copy> \n</sequential> \n</target>\n</project> \n===\n\nI have added the minimal example as attachment.", "attachment_id": 31932, "id": 177273, "creator": "noh@cl.uni-heidelberg.de", "time": "2014-08-19T21:20:13Z", "bug_id": 56873, "creation_time": "2014-08-19T21:20:13Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 56873, "attachment_id": 31933, "text": "Created attachment 31933\nant -diag, just in case.", "id": 177274, "time": "2014-08-19T21:21:35Z", "creator": "noh@cl.uni-heidelberg.de", "creation_time": "2014-08-19T21:21:35Z", "is_private": false}, {"count": 2, "tags": [], "text": "Here's the trace of the NullPointException \n\n\nBUILD FAILED\n/home/mitarb/noh/Downloads/temp/build.xml:5: java.lang.NullPointerException\n\tat org.apache.tools.ant.types.resources.URLResource.getLastModified(URLResource.java:268)\n\tat org.apache.tools.ant.types.resources.ResourceDecorator.getLastModified(ResourceDecorator.java:96)\n\tat org.apache.tools.ant.types.ArchiveScanner.scanme(ArchiveScanner.java:331)\n\tat org.apache.tools.ant.types.ArchiveScanner.getResourceFiles(ArchiveScanner.java:216)\n\tat org.apache.tools.ant.types.ArchiveFileSet.iterator(ArchiveFileSet.java:320)\n\tat org.apache.tools.ant.taskdefs.Copy.execute(Copy.java:518)\n\tat org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:292)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:601)\n\tat org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)\n\tat org.apache.tools.ant.Task.perform(Task.java:348)\n\tat org.apache.tools.ant.taskdefs.Sequential.execute(Sequential.java:68)\n\tat org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:292)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:601)\n\tat org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)\n\tat org.apache.tools.ant.Task.perform(Task.java:348)\n\tat org.apache.tools.ant.Target.execute(Target.java:435)\n\tat org.apache.tools.ant.Target.performTasks(Target.java:456)\n\tat org.apache.tools.ant.Project.executeSortedTargets(Project.java:1393)\n\tat org.apache.tools.ant.Project.executeTarget(Project.java:1364)\n\tat org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n\tat org.apache.tools.ant.Project.executeTargets(Project.java:1248)\n\tat org.apache.tools.ant.Main.runBuild(Main.java:851)\n\tat org.apache.tools.ant.Main.startAnt(Main.java:235)\n\tat org.apache.tools.ant.launch.Launcher.run(Launcher.java:280)\n\tat org.apache.tools.ant.launch.Launcher.main(Launcher.java:109)", "attachment_id": null, "id": 177276, "creator": "noh@cl.uni-heidelberg.de", "time": "2014-08-20T06:10:01Z", "bug_id": 56873, "creation_time": "2014-08-20T06:10:01Z", "is_private": false}, {"count": 3, "tags": [], "creator": "bodewig@apache.org", "text": "git commit e8b160a\n\nThe strange thing is I don't see why it should have worked prior to Ant 1.9.4", "id": 177290, "time": "2014-08-21T05:30:03Z", "bug_id": 56873, "creation_time": "2014-08-21T05:30:03Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 56873, "attachment_id": null, "text": "I was wrong, my patch didn't fix anything as the isExists-call already opens the connection.  Will need to look into this once again.", "id": 177300, "time": "2014-08-22T04:28:36Z", "creator": "bodewig@apache.org", "creation_time": "2014-08-22T04:28:36Z", "is_private": false}, {"count": 5, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 177301, "time": "2014-08-22T04:38:26Z", "bug_id": 56873, "creation_time": "2014-08-22T04:38:26Z", "is_private": false, "text": "oh my, isExists special-cases FTP.\n\nYour test script simply hangs on Linux for me as well, it does so while trying zo figure out whether the file exists at all - more investigation pending."}, {"count": 6, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 177302, "time": "2014-08-22T05:40:53Z", "bug_id": 56873, "creation_time": "2014-08-22T05:40:53Z", "is_private": false, "text": "git commit c89d650 avoids the NPE but still hangs for me - I can get it unlocked if I throw in a few Thread#sleeps between attempts to open and close connections, it might be a timing, OS and URLConnection configuration issue, will look into it during the weekend."}, {"count": 7, "tags": [], "bug_id": 56873, "text": "this here introduced the problem http://svn.apache.org/viewvc/ant/core/trunk/src/main/org/apache/tools/ant/types/resources/URLResource.java?r1=1577796&r2=1577795&pathrev=1577796 - fixing bug #51110\n\nIf it worked for you prior to Ant 1.9.4. can you build Ant from git master and give it a try?", "id": 177303, "time": "2014-08-22T05:45:25Z", "creator": "bodewig@apache.org", "creation_time": "2014-08-22T05:45:25Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "text": "Thanks for quick response and check! I will try with trunk source with the pointed part on / off tonight.", "attachment_id": null, "bug_id": 56873, "id": 177304, "time": "2014-08-22T06:31:58Z", "creator": "noh@cl.uni-heidelberg.de", "creation_time": "2014-08-22T06:31:58Z", "is_private": false}, {"count": 9, "tags": [], "text": "> If it worked for you prior to Ant 1.9.4. can you build Ant from git master and give it a try?\n\nHello, I just cloned the git master with the following commit. \n> commit c89d650a9c8fdac5fd5cc71a5fd6dbfd48cc893b\n> Author: Stefan Bodewig <bodewig@apache.org>\n> Date:   Fri Aug 22 07:38:54 2014 +0200\n> \n>    PR 56973 getLastModified in URLResource throws NPE for FTP URLs\n\ngit commit c89d650 works for me. Here's some test I did with my users' ant versions... (all on the same network) \n\n1.8.4: the build runs Okay. \n1.9.3: the build runs Okay. \n1.9.4: the build stops with NPE.  \ngit master with commit c89d650: the build runs Okay. \n\nSo for me, the issue is resolved with the latest commit. --- (or we can at least say, it returned to its previous status of 1.9.3 for all? hmm. ) \n\nLet me know if you have any test that I can do for helping you.", "attachment_id": null, "bug_id": 56873, "id": 177316, "time": "2014-08-22T12:53:34Z", "creator": "noh@cl.uni-heidelberg.de", "creation_time": "2014-08-22T12:53:34Z", "is_private": false}, {"count": 10, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 177995, "time": "2014-09-21T09:13:23Z", "bug_id": 56873, "creation_time": "2014-09-21T09:13:23Z", "is_private": false, "text": "Thanks, I think the test has been sufficient."}]