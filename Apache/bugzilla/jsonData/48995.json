[{"count": 0, "tags": [], "creator": "sbrunot@gmail.com", "attachment_id": null, "id": 135669, "time": "2010-03-26T14:11:03Z", "bug_id": 48995, "creation_time": "2010-03-26T14:11:03Z", "is_private": false, "text": "When executing the following piece of code:\n\n\t\tXSSFWorkbook wb = new XSSFWorkbook();\n\t\tXSSFSheet sh = wb.createSheet(\"test\");\n\t\tXSSFRow row = sh.createRow(0);\n\t\tXSSFCell cell = row.createCell(0, XSSFCell.CELL_TYPE_STRING);\n\t\t\n\t\tRichTextString data = new XSSFRichTextString(\"bold not bold\");\n\t\tshort fontHeight = 12;\n\t\tXSSFFont boldFont = wb.createFont();\n\t\tboldFont.setFontName(\"Arial\");\n\t\tboldFont.setBoldweight(Font.BOLDWEIGHT_BOLD);\n\t\tboldFont.setColor(Font.COLOR_NORMAL);\n\t\tboldFont.setFontHeight(fontHeight);\n\n\t\tdata.applyFont(0, 4, boldFont);\n\t\t\n\t\tcell.setCellValue(data);\n\t\twb.write(new FileOutputStream(\"out.xlsx\"));\n\nand then opening the out.xlsx file in Microsoft Excel 2007, an error message is displayed: \"Excel found unreadable content in 'out.xlsx'. Do you want to recover the contents of this workbook ? If you trust the source of this workbook, click Yes.\""}, {"count": 1, "tags": [], "text": "Could you please upload two files to help us with this bug?\n\nFirstly, the output of your sample program which Excel is unable to read\n\nSecondly, can you please create a file in excel with the same contents you were hoping POI could give you?\n\nOnce we have those two files, we can compare the differences and figure out what POI is doing wrong.", "is_private": false, "bug_id": 48995, "id": 137145, "time": "2010-05-26T10:00:44Z", "creator": "apache@gagravarr.org", "creation_time": "2010-05-26T10:00:44Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "r_botto@yahoo.com", "text": "Created attachment 33520\nSource File for Sample main generating invalid worksheet", "id": 188189, "time": "2016-02-03T17:26:31Z", "bug_id": 48995, "creation_time": "2016-02-03T17:26:31Z", "is_private": false, "attachment_id": 33520}, {"count": 3, "tags": [], "creator": "r_botto@yahoo.com", "text": "Created attachment 33521\nInvalid worksheet generated with sample code", "id": 188190, "time": "2016-02-03T17:27:07Z", "bug_id": 48995, "creation_time": "2016-02-03T17:27:07Z", "is_private": false, "attachment_id": 33521}, {"count": 4, "tags": [], "creator": "r_botto@yahoo.com", "text": "Created attachment 33522\nScreenshot of PpenXMLSDK 2.0 Validation Tool for out.xslx", "id": 188191, "time": "2016-02-03T17:27:48Z", "bug_id": 48995, "creation_time": "2016-02-03T17:27:48Z", "is_private": false, "attachment_id": 33522}, {"count": 5, "tags": [], "bug_id": 48995, "attachment_id": 33523, "text": "Created attachment 33523\nConverted filed by Excell 2013", "id": 188192, "time": "2016-02-03T17:28:16Z", "creator": "r_botto@yahoo.com", "creation_time": "2016-02-03T17:28:16Z", "is_private": false}, {"count": 6, "tags": [], "creator": "r_botto@yahoo.com", "text": "Created attachment 33524\nOpenSDK 2.0 Validation tool for converted File", "id": 188193, "time": "2016-02-03T17:28:41Z", "bug_id": 48995, "creation_time": "2016-02-03T17:28:41Z", "is_private": false, "attachment_id": 33524}, {"count": 7, "tags": [], "creator": "r_botto@yahoo.com", "text": "I have the same problem reported in this incident, working with poi 3.13 also.\n\nI take the sample code here, generate a main program and a sample worksheet that fails to validate on Excel 2010 and Excel 2013. Also fails on OpenXML SDK 2.0 Productivity Tool (ScreenShot provided).\n\nIf you see the reported error, Validation reports that elemnt sz is unexpected in current context.\n\nLetting Excel 2013 to adjust the worksheet and saving it again, new worksheet validates with no problem. Comparing screenshots, you can see the only difference between two font definitions is element order. Invalid has (FontName, FontSize, Bold, Color). Valid one has (Bold, FontSize, Color, FontName)\n\nThe order that poi save the elements, is the order the setMethods are invoked on XSSFFont, (constructor invokes 2 methods, in bad order).\n\nI've made a workaround in my case, changing the order of set (and adding somes) on constructor of XSSFFont, but is an incomplete solution, if not all properties are setted. \nI have no clue on how to affect serialization order on xmlbeans library, may be you can apply a more generic solution to this problem.\n\nThanks in advance,\nRodolfo Botto", "id": 188194, "time": "2016-02-03T17:35:54Z", "bug_id": 48995, "creation_time": "2016-02-03T17:35:54Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "id": 201362, "time": "2017-10-09T17:56:38Z", "bug_id": 48995, "creation_time": "2017-10-09T17:56:38Z", "is_private": false, "text": "Updated code to produce the test-file\n\n        try (Workbook wb = new XSSFWorkbook()) {\n            Sheet sh = wb.createSheet(\"test\");\n            Row row = sh.createRow(0);\n            Cell cell = row.createCell(0, CellType.STRING);\n\n            RichTextString data = new XSSFRichTextString(\"bold not bold\");\n            Font boldFont = wb.createFont();\n            boldFont.setFontName(\"Arial\");\n            boldFont.setBold(true);\n            boldFont.setColor(Font.COLOR_NORMAL);\n            boldFont.setFontHeightInPoints((short) 12);\n\n            data.applyFont(0, 4, boldFont);\n\n            cell.setCellValue(data);\n            try (OutputStream stream = new FileOutputStream(\"/tmp/48995.xlsx\")) {\n                wb.write(stream);\n            }\n        }"}, {"count": 9, "tags": [], "creator": "dominik.stadler@gmx.at", "text": "Verifed that this works for me now with current versions of Apache POI and Microsoft Excel. \n\nPlease reopen and provide more details if this is still a problem for you.", "id": 201384, "time": "2017-10-10T11:38:40Z", "bug_id": 48995, "creation_time": "2017-10-10T11:38:40Z", "is_private": false, "attachment_id": null}]