[{"count": 0, "tags": [], "creator": "triemann@octoate.de", "attachment_id": null, "id": 95023, "creation_time": "2006-10-20T15:17:04Z", "time": "2006-10-20T15:17:04Z", "bug_id": 40806, "text": "We are using POI to index PPT for a P2P search engine. While crawling the web \nwe found this document: http://www.na.unep.net/OnePlanetManyPeople/THEMATIC/\nIntroduction.ppt which cause the following Exception:\n\njava.lang.ArrayIndexOutOfBoundsException: 57\nat org.apache.poi.util.LittleEndian.getNumber(LittleEndian.java:491)\nat org.apache.poi.util.LittleEndian.getInt(LittleEndian.java:139)\nat \norg.apache.poi.hslf.record.StyleTextPropAtom$TextPropCollection.buildTextPropList(StyleTextPropAtom.java:421)\nat \norg.apache.poi.hslf.record.StyleTextPropAtom.setParentTextSize(StyleTextPropAtom.java:270)\nat org.apache.poi.hslf.model.TextRun.<init>(TextRun.java:91)\nat org.apache.poi.hslf.model.TextRun.<init>(TextRun.java:68)\nat org.apache.poi.hslf.model.Sheet.findTextRuns(Sheet.java:126)\nat org.apache.poi.hslf.model.Sheet.findTextRuns(Sheet.java:88)\nat org.apache.poi.hslf.model.Slide.<init>(Slide.java:66)\nat \norg.apache.poi.hslf.usermodel.SlideShow.buildSlidesAndNotes(SlideShow.java:394)\nat org.apache.poi.hslf.usermodel.SlideShow.<init>(SlideShow.java:116)\nat \norg.apache.poi.hslf.extractor.PowerPointExtractor.<init>(PowerPointExtractor.java:85)", "is_private": false}, {"count": 1, "tags": [], "creator": "bjorn.wang@creuna.no", "attachment_id": 19197, "is_private": false, "id": 96344, "time": "2006-11-29T04:40:58Z", "bug_id": 40806, "creation_time": "2006-11-29T04:40:58Z", "text": "Created attachment 19197\nSimplest possible testcase showing the ArrayIndexOutOfBoundsError\n\nI use POI through Nutch for parsing Office documents.\n\nNote: No exception is thrown when I do my tests, but a lot of ERROR messages\nare logged, indicating that something is wrong:\n\nERROR - ContentReaderListener.extractTextBoxes(322) | extractClientTextBoxes\njava.lang.ArrayIndexOutOfBoundsException: -353698944\n\tat org.apache.poi.util.LittleEndian.getNumber(LittleEndian.java:491)\n\tat org.apache.poi.util.LittleEndian.getUShort(LittleEndian.java:64)\n\tat\norg.apache.nutch.parse.mspowerpoint.ContentReaderListener.extractTextBoxes(ContentReaderListener.java:200)\n\n\tat\norg.apache.nutch.parse.mspowerpoint.ContentReaderListener.processPOIFSReaderEvent(ContentReaderListener.java:110)\n\n\tat\norg.apache.poi.poifs.eventfilesystem.POIFSReader.processProperties(POIFSReader.java:260)\n\n\tat\norg.apache.poi.poifs.eventfilesystem.POIFSReader.read(POIFSReader.java:96)\n\tat\norg.apache.nutch.parse.mspowerpoint.PPTExtractor.extractText(PPTExtractor.java:49)\n\n\tat org.apache.nutch.parse.ms.MSExtractor.extract(MSExtractor.java:77)\n\tat\norg.apache.nutch.parse.ms.MSBaseParser.getParse(MSBaseParser.java:81)\n\tat\norg.apache.nutch.parse.mspowerpoint.MSPowerPointParser.getParse(MSPowerPointParser.java:44)\n\n\tat\nno.creuna.documentparser.DocumentParser.parseDocument(DocumentParser.java:156)\n\tat\ntest.no.creuna.documentparser.DocumentParserErrorsTest.testArrayIndexOutOfBoundsExceptionErrors(DocumentParserErrorsTest.java:186)"}, {"count": 2, "tags": [], "creator": "bjorn.wang@creuna.no", "attachment_id": null, "text": "I use POI through Nutch.\n\nWhen opening the attachment Nutch logs a series of errors from within POI:\n\nERROR - ContentReaderListener.extractTextBoxes(322) | extractClientTextBoxes\njava.lang.ArrayIndexOutOfBoundsException: -353698944\n\tat org.apache.poi.util.LittleEndian.getNumber(LittleEndian.java:491)\n\tat org.apache.poi.util.LittleEndian.getUShort(LittleEndian.java:64)\n\tat\norg.apache.nutch.parse.mspowerpoint.ContentReaderListener.extractTextBoxes(ContentReaderListener.java:200)\n\tat\norg.apache.nutch.parse.mspowerpoint.ContentReaderListener.processPOIFSReaderEvent(ContentReaderListener.java:110)\n\tat\norg.apache.poi.poifs.eventfilesystem.POIFSReader.processProperties(POIFSReader.java:260)\n\tat org.apache.poi.poifs.eventfilesystem.POIFSReader.read(POIFSReader.java:96)\n\tat\norg.apache.nutch.parse.mspowerpoint.PPTExtractor.extractText(PPTExtractor.java:49)\n\tat org.apache.nutch.parse.ms.MSExtractor.extract(MSExtractor.java:77)\n\tat org.apache.nutch.parse.ms.MSBaseParser.getParse(MSBaseParser.java:81)\n\tat\norg.apache.nutch.parse.mspowerpoint.MSPowerPointParser.getParse(MSPowerPointParser.java:44)\n\tat no.creuna.documentparser.DocumentParser.parseDocument(DocumentParser.java:156)\n\tat\ntest.no.creuna.documentparser.DocumentParserErrorsTest.testArrayIndexOutOfBoundsExceptionErrors(DocumentParserErrorsTest.java:186)\n", "id": 96346, "time": "2006-11-29T04:49:00Z", "bug_id": 40806, "creation_time": "2006-11-29T04:49:00Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 40806, "text": "I think this problem has now been fixed, thanks to Yegor's new understanding of\nthe ordering of TextProps in StyleTextPropAtom\n\nI can open your test powerpoint document without any exceptions, so I'm hoping\nthis is now closed. If you still get problems, can you re-open with a new\nproblem file?", "id": 98136, "time": "2007-01-16T07:52:08Z", "creator": "apache@gagravarr.org", "creation_time": "2007-01-16T07:52:08Z", "is_private": false, "attachment_id": null}]