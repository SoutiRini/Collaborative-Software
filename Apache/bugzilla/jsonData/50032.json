[{"count": 0, "tags": [], "bug_id": 50032, "text": "Created attachment 26105\nSimplified test plan showing the issue\n\nif the test plan is\nThread Group (Thread = 1 , Loop =2)\n+Sample1\n+If Controller (${JMeterThread.last_sample_ok})\n++Sample2\n++Sample3  (always fails)\n++Sample4  (always fails)\nThen the test plan executes correctly (i.e. Result is Sample1, Sample2, Sample3(failed) ,Sample1, Sample2, Sample3(failed)\n\n\nHowever if now we add a Simple Controller so that the plan is\nThread Group (Thread = 1 , Loop =2)\n+Sample1\n+If Controller (${JMeterThread.last_sample_ok})\n++Sample2\n++Simple Controller\n+++Sample3  (always fails)\n+++Sample4  (always fails)\n\nThen the test plan executes incorrectly(i.e. Result is Sample1, Sample2, Sample3(failed) ,Sample1, Sample2, Sample4(failed)\n\nThe only workaround I can see is to not have the simple controller (but other controllers like the IF will similarly impact the behavior so this isnt very viable)", "id": 140328, "time": "2010-09-30T13:52:36Z", "creator": "shettyd@gmail.com", "creation_time": "2010-09-30T13:52:36Z", "is_private": false, "attachment_id": 26105}, {"count": 1, "tags": [], "creator": "milamber@apache.org", "attachment_id": 26151, "text": "Created attachment 26151\nProposal patch", "id": 140624, "time": "2010-10-09T17:18:40Z", "bug_id": 50032, "creation_time": "2010-10-09T17:18:40Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 50032, "text": "Thanks for your report and test script.\n\nThis bug comes from a Simple controller's index which is not reinitialized on loop 2 (the next is sample 4 - not the sample 3)\nSolution: when \"If Controller\" breaks tree execution (after Sample 3 fails) run a reinitialization indexes on sub-controllers.\n\nin attachment, a proposal patch.\n@sebb: have you a comment before I commit the patch?", "id": 140625, "time": "2010-10-09T17:19:07Z", "creator": "milamber@apache.org", "creation_time": "2010-10-09T17:19:07Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "sebb@apache.org", "attachment_id": null, "is_private": false, "id": 140665, "time": "2010-10-11T12:16:43Z", "bug_id": 50032, "creation_time": "2010-10-11T12:16:43Z", "text": "Patch looks fine to me, except that I think the method reInitializeSubController() should be protected rather than public.\n\n[It can always be made public later if it proves necessary.]"}, {"count": 4, "tags": [], "bug_id": 50032, "text": "Thanks; fixed in SVN (and next nightly build):\n\nURL: http://svn.apache.org/viewvc?rev=1021512&view=rev\nLog:\nBug 50032 - Last_Sample_Ok along with other controllers doesnt work correctly when the threadgroup has multiple loops\n\nModified:\n    jakarta/jmeter/trunk/src/core/org/apache/jmeter/control/GenericController.java\n    jakarta/jmeter/trunk/src/core/org/apache/jmeter/control/IfController.java\n    jakarta/jmeter/trunk/test/src/org/apache/jmeter/control/TestIfController.java\n\nURL: http://svn.apache.org/viewvc?rev=1021514&view=rev\n\nModified:\n    jakarta/jmeter/trunk/xdocs/changes.xml", "id": 140679, "time": "2010-10-11T17:34:30Z", "creator": "milamber@apache.org", "creation_time": "2010-10-11T17:34:30Z", "is_private": false, "attachment_id": null}, {"count": 5, "attachment_id": null, "bug_id": 50032, "text": "URL: http://svn.apache.org/viewvc?rev=1061679&view=rev\nLog:\nNo need to return a value (improving patch Bug 50032)\n\nModified:\n    jakarta/jmeter/trunk/src/core/org/apache/jmeter/control/GenericController.java\n    jakarta/jmeter/trunk/src/core/org/apache/jmeter/control/IfController.java", "id": 143539, "time": "2011-01-21T03:26:14Z", "creator": "milamber@apache.org", "creation_time": "2011-01-21T03:26:14Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "attachment_id": null, "is_private": false, "id": 149160, "time": "2011-09-12T07:12:07Z", "bug_id": 50032, "creation_time": "2011-09-12T07:12:07Z", "text": "Hello,\nThis patch introduced a regression on IfController.\nAttached is a scenario that shows how an Infinite Loop will occur when a IfController contains a TransactionController.\nIf condition evaluates to false, reInitializeSubController will loop infinitely.\n\nI don't know if this reopening is a duplicate of 50618 but maybe another manifestation of the regression.\n\nRegards\nPhilippe Mouawad"}, {"count": 7, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "attachment_id": 27486, "text": "Created attachment 27486\nShows the issue", "id": 149161, "time": "2011-09-12T07:13:09Z", "bug_id": 50032, "creation_time": "2011-09-12T07:13:09Z", "is_private": false}, {"count": 8, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "text": "Created attachment 27487\nCSV file to use with Regression-Script.jmx.", "id": 149162, "time": "2011-09-12T07:13:35Z", "bug_id": 50032, "creation_time": "2011-09-12T07:13:35Z", "is_private": false, "attachment_id": 27487}, {"count": 9, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "attachment_id": null, "is_private": false, "id": 149167, "time": "2011-09-12T09:19:52Z", "bug_id": 50032, "creation_time": "2011-09-12T09:19:52Z", "text": "Hello,\nThere is another issue with patch, it's that it generates additional samples for transactions inside IfCOntroller due to the call to nextIsAController() inside reInitializeSubController.\n\nFor example when line in CSV is equal to 0, I get in \"View Results Tree\" calls to:\n- s3-createAddressAndHousing\n- S3-createLegalEntityAddress\n\nalthough sampler inside these are not executed.\n\nRegards\nPhilippe"}, {"count": 10, "tags": [], "text": "(In reply to comment #6)\n\nThanks. Fixed.\n\nURL: http://svn.apache.org/viewvc?rev=1170388&view=rev\nLog:\nIf Controller - Fixed a regression introduce by bug 50032\nSee: https://issues.apache.org/bugzilla/show_bug.cgi?id=50032#c6\nand https://issues.apache.org/bugzilla/show_bug.cgi?id=50618#c28\n\nModified:\n    jakarta/jmeter/trunk/src/core/org/apache/jmeter/control/GenericController.java\n    jakarta/jmeter/trunk/xdocs/changes.xml", "is_private": false, "bug_id": 50032, "id": 149196, "time": "2011-09-13T23:36:46Z", "creator": "milamber@apache.org", "creation_time": "2011-09-13T23:36:46Z", "attachment_id": null}, {"count": 11, "tags": [], "text": "Thank you for applying.\nMaybe a note should be added in Known issues regarding the incomplete fix of this isssue:\n- Currently it generates additional samples for transactions inside IfCOntroller due to the call to nextIsAController() inside reInitializeSubController.\n\nEven if sampler are not run.\nI don't know if you close this issue and open another bug or you keep this one opened.\n\nRegards\nPhilippe", "is_private": false, "bug_id": 50032, "id": 149204, "time": "2011-09-14T07:17:12Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2011-09-14T07:17:12Z", "attachment_id": null}, {"count": 12, "attachment_id": null, "creator": "milamber@apache.org", "text": "URL: http://svn.apache.org/viewvc?rev=1170707&view=rev\nLog:\nAdd two knows issues : bug 50032 and bug 50618\n\nModified:\n    jakarta/jmeter/trunk/xdocs/changes.xml", "id": 149233, "time": "2011-09-14T16:44:07Z", "bug_id": 50032, "creation_time": "2011-09-14T16:44:07Z", "tags": [], "is_private": false}, {"count": 13, "tags": [], "bug_id": 50032, "text": "Created attachment 27519\nFix to the issue where If Controller generates additional samples for children Transaction Controller inside when condition is false\n\nHello,\nHere is a fix to the known issue related to this bug:\n-If Controller generates additional samples for children Transaction Controller inside when condition is false.\n\nHere is how it works, once a thread enters reInitializeSubController() it flags the JMeterThreadContext if it's the first Parent.\nIn TransactionController listeners will not be notified that a sample occured since it didn't .\nOnce the first Parent has finished reinitializing, it unsets the flag in finally.\n\nI tested with attached JMX and it works.\nRegards\nPhilippe", "id": 149366, "time": "2011-09-17T12:36:29Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2011-09-17T12:36:29Z", "is_private": false, "attachment_id": 27519}, {"count": 14, "tags": [], "creator": "milamber@apache.org", "attachment_id": null, "is_private": false, "id": 149375, "time": "2011-09-17T15:06:22Z", "bug_id": 50032, "creation_time": "2011-09-17T15:06:22Z", "text": "Philippe, your patch don't respect code style used in JMeter. \n\n== No good ==\n         }\n         finally\n         {\n== Good ==\n         } finally {\n==========\n\n\n\n== No good ==\n         if(isReinitializingSubControllers)\n         {\n             isReinitializingSubControllers = false;\n         }\n         else\n         {\n             log.warn(\"Unsetting while flag is not true\");\n         }\n== Good ==\n         if (isReinitializingSubControllers) {  // please note: one space before left parenthesis\n             isReinitializingSubControllers = false;\n         } else {\n             log.warn(\"Unsetting while flag is not true\");\n         }\n=======\n\nComments on source code don't need have all characters in uppercase\n\n=======\n\n\"@see\" must follow by a classname, not a \"ISSUE\" keyword.\n\nPlease respect code style convention in JMeter for next submissions. Thanks."}, {"count": 15, "tags": [], "bug_id": 50032, "text": "Thanks for patch (even if it didn't follow code style :))\nApplied.\n\nNow, I close the bug. Thanks Phillippe.\n\nURL: http://svn.apache.org/viewvc?rev=1171999&view=rev\nLog:\nBug 50032 - Fixed a new regression introduced by bug 50032 when Transaction Controller is a child of If Controller\n\nModified:\n    jakarta/jmeter/trunk/src/core/org/apache/jmeter/control/GenericController.java\n    jakarta/jmeter/trunk/src/core/org/apache/jmeter/control/TransactionController.java\n    jakarta/jmeter/trunk/src/core/org/apache/jmeter/threads/JMeterContext.java\n    jakarta/jmeter/trunk/xdocs/changes.xml", "id": 149378, "time": "2011-09-17T15:09:46Z", "creator": "milamber@apache.org", "creation_time": "2011-09-17T15:09:46Z", "is_private": false, "attachment_id": null}, {"count": 16, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "attachment_id": null, "is_private": false, "id": 149379, "time": "2011-09-17T15:16:56Z", "bug_id": 50032, "creation_time": "2011-09-17T15:16:56Z", "text": "I am sorry for not respecting, I missed it.\nI will take care next time, anyway thanks for taking it as is.\nRegards\nPhilippe."}]