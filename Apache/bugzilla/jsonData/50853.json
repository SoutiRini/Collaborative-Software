[{"count": 0, "tags": [], "bug_id": 50853, "is_private": false, "id": 144664, "attachment_id": null, "creator": "stormbringer@mail.com", "creation_time": "2011-03-02T08:19:37Z", "time": "2011-03-02T08:19:37Z", "text": "Excel 2003 has 64K row limit and I can export up to 64K rows using POI, but only if I don't use sheet.autoSizeColumn(i) method.\n\nHere's a simple example that leads to this problem: try to create a sheet with over 33K rows (I used 34K) and a single column. When data is written, call sheet.autoSizeColumn to auto-fit the column and it breaks with this exception.\n\njava.lang.ArrayIndexOutOfBoundsException: -32732\n        at java.util.ArrayList.get(ArrayList.java:324)\n        at org.apache.poi.hssf.model.WorkbookRecordList.get(WorkbookRecordList.java:50)\n        at org.apache.poi.hssf.model.Workbook.getExFormatAt(Workbook.java:787)\n        at org.apache.poi.hssf.usermodel.HSSFCell.getCellStyle(HSSFCell.java:906)\n        at org.apache.poi.hssf.usermodel.HSSFSheet.autoSizeColumn(HSSFSheet.java:1727)\n        at org.apache.poi.hssf.usermodel.HSSFSheet.autoSizeColumn(HSSFSheet.java:1662)\n\nWhen there are more columns it breaks even sooner than that. My usecase has ~50 columns and it breaks even with 2K rows. It looks like it uses short int data type and it goes out of range.\n\nLet me know if you need more info.\n\nCheers"}, {"count": 1, "tags": [], "bug_id": 50853, "text": "Can you try with a recent svn nightly build? Only there have been some auto size fixes since 3.6, and you might find it's already been sorted", "id": 144665, "time": "2011-03-02T08:26:19Z", "creator": "apache@gagravarr.org", "creation_time": "2011-03-02T08:26:19Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 50853, "text": "Just tried with poi-3.8-beta1-20110302 and it still fails :(", "id": 144671, "time": "2011-03-02T09:05:48Z", "creator": "stormbringer@mail.com", "creation_time": "2011-03-02T09:05:48Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 50853, "is_private": false, "id": 144695, "attachment_id": null, "creator": "yegor@dinom.ru", "creation_time": "2011-03-03T03:57:46Z", "time": "2011-03-03T03:57:46Z", "text": "poi-3.8-beta1-20110302 fails, but with a different exception!\n\nYou are creating too many cell styles. The maximum number of cell styles in a workbook is 4000, see\nhttp://office.microsoft.com/en-us/excel-help/excel-specifications-and-limits-HP005199291.aspx\n\nCell Styles must be shared. Do not create per-cell, otherwise you will get a\n\u201cToo many styles\u201d error in Excel when opening your workbook. Think of Cell\nStyles like CSS and create them like that.\n\nhttp://poi.apache.org/faq.html#faq-N100EF\n\nYegor\n\n*** This bug has been marked as a duplicate of bug 49188 ***"}]