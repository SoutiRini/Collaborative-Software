[{"count": 0, "tags": [], "bug_id": 39509, "text": "The samples within the first Once-only controller contained within an \nInterleave controller run twice. Any following Once-only controllers within \nthe Interleave controller correctly run once.\n\nThe interleave controller contains 3 once-only controllers, each containing 2 \nhttp requests. These are followed by 7 http requests.\n\nI have also tried this on the 08 May 2006 build and get the same results.", "id": 88904, "time": "2006-05-08T14:18:21Z", "creator": "toxic.monkeys@virgin.net", "creation_time": "2006-05-08T14:18:21Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 39509, "attachment_id": null, "id": 89315, "time": "2006-05-20T20:31:08Z", "creator": "sebb@apache.org", "creation_time": "2006-05-20T20:31:08Z", "is_private": false, "text": "Confirmed.\n\nA simple workround is to add a dummy sampler before the first Once Only\ncontroller (e.g. Test Action)"}, {"count": 2, "tags": [], "bug_id": 39509, "text": "Created attachment 20179\nTest plan to show the bug", "id": 103099, "time": "2007-05-11T06:37:30Z", "creator": "alf@i100.no", "creation_time": "2007-05-11T06:37:30Z", "is_private": false, "attachment_id": 20179}, {"text": "(In reply to comment #2)\n> Created an attachment (id=20179) [edit]\n> Test plan to show the bug\n> \n\nI have not been able to make a patch for this problem, mainly because I am not\nsure how the correct behaviour would be.\nBelow is some of my thoughts after working on this, in case someone else are\ngoing to have a look at this bug.\n\nTo me, the problem seems to be related to InterleaveController, and the way that\ncontroller increases iteration count, and is being reinitialized.\n\nThe OnlyOnceController has an if test : \"if (event.getIteration() == 1) {\".\nBut for the InterleaveController, the first \"iteration count\" is 0, while for\nLoopController it is 1, because LoopController overrides \"getIterCount\".\n\nThe \"InterleaveController\" also never resets the iteration count, so you will\nonly once get the \"iteration count\" equal to 1 from a InterleaveController.\nThe LoopController resets the iteration count, so for each time the loop is\nentered, the OnlyOnceController is executed.", "tags": [], "bug_id": 39509, "attachment_id": null, "count": 3, "id": 103167, "time": "2007-05-14T06:39:41Z", "creator": "alf@i100.no", "creation_time": "2007-05-14T06:39:41Z", "is_private": false}, {"count": 4, "tags": [], "text": "Created attachment 20192\nUnit test patch\n\nThis patch is meant as a help if someone picks up the work on this bug.\nIt is a slight restructuring of the current tests, plus a failing test, to\nexpose the problem reported on the InterleaveController and OnlyOnceController.", "is_private": false, "id": 103168, "creator": "alf@i100.no", "time": "2007-05-14T06:42:32Z", "bug_id": 39509, "creation_time": "2007-05-14T06:42:32Z", "attachment_id": 20192}, {"count": 5, "tags": [], "bug_id": 39509, "attachment_id": null, "id": 111466, "time": "2007-12-05T15:00:03Z", "creator": "sebb@apache.org", "creation_time": "2007-12-05T15:00:03Z", "is_private": false, "text": "Once Only also behaves oddly under a Simple Controller - which one would \nexpect to be equivalent to a Loop Controller with count=1 - the OO should run \neach time round the thread group, but it only runs twice.\n\nTest plan to follow."}, {"count": 6, "tags": [], "bug_id": 39509, "attachment_id": 21233, "text": "Created attachment 21233\nTest showing diff behaviour of loop=1 and Simple Cont.", "id": 111467, "time": "2007-12-05T15:07:10Z", "creator": "sebb@apache.org", "creation_time": "2007-12-05T15:07:10Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 39509, "attachment_id": null, "id": 111560, "time": "2007-12-07T16:29:29Z", "creator": "sebb@apache.org", "creation_time": "2007-12-07T16:29:29Z", "is_private": false, "text": "The Once Only Controller needs to to know the state of its parent; this is \ncurrently achieved via the iterationStart() method.\n\nUnfortunately, not all Controllers actually call this method, and the \niteration count is not consistent - e.g. Loop Controller goes from 1 to \nloopmax, and repeats when the loop repeats, whereas for the Simple Controller, \nit starts at 0, and increments continually.\n\nThe behaviour of the OOC when part of a looping controller seems fairly well-\ndefined - and it performs as documented. But how should it behave as part of \nother non-looping controllers? This does not seem to be well defined, nor does \nit seem obvious how it should behave..."}, {"count": 8, "tags": [], "bug_id": 39509, "attachment_id": 23634, "text": "Created attachment 23634\nProposal patch\n\nI think that the problem is :\n* Thread group and Loop Controller is starting with 'iterCount' at 1 \n* but other controllers iterCount is starting with 0\n\nthus, OOC is executed 2 times (iterCount = 0 and = 1) when it is sub element of a controller which isn't a Loop or TG.\n\nThe patch modify TG and Loop Controller to start to 0 and changing the \"if (event.getIteration() == 1) {\" to 0 in OOC.", "id": 126918, "time": "2009-05-10T10:26:21Z", "creator": "milamber@apache.org", "creation_time": "2009-05-10T10:26:21Z", "is_private": false}, {"count": 9, "tags": [], "creator": "milamber@apache.org", "attachment_id": 23635, "id": 126919, "time": "2009-05-10T10:33:51Z", "bug_id": 39509, "creation_time": "2009-05-10T10:33:51Z", "is_private": false, "text": "Created attachment 23635\nTest cases\n\nElement \"04 TC Java Request\" must be count 1 time\nElement \"05 L OO Java Request\" must be count 5 times \nElement \"01 Java Request\" must be count 1 time\nElement \"00 Java Request\" must be count 1 time\nElement \"02 Java Request\" must be count 5 times\nElement \"03 TC Java Request\" must be count 1 time\nElement \"07 IL A Java Request\" must be count 1 time\nElement \"09 L OO Java Request\" must be count 5 times\nElement \"10 Loop Java Request\" must be count 20 times\nElement \"08 IL A Java Request\" must be count 3 times"}, {"count": 10, "tags": [], "creator": "milamber@apache.org", "attachment_id": 23636, "id": 126920, "time": "2009-05-10T10:34:54Z", "bug_id": 39509, "creation_time": "2009-05-10T10:34:54Z", "is_private": false, "text": "Created attachment 23636\nCapture test plan execution with proposal patch"}, {"count": 11, "tags": [], "text": "Thanks, the updated patch fixes the test case so it behaves as expected.\n\nHowever, some unit tests now fail. It's not yet clear whether the tests are wrong.\n\nI've had second thoughts about the Simple Controller. Rather than being regarded as a Loop count of 1, it should probably be regarded as just a grouping controller which does not affect its children, i.e. they should behave the same whether or not the controller is there. This agrees better with the existing documentation.", "is_private": false, "id": 126923, "creator": "sebb@apache.org", "time": "2009-05-10T15:36:07Z", "bug_id": 39509, "creation_time": "2009-05-10T15:36:07Z", "attachment_id": null}, {"count": 12, "tags": [], "text": "At least one of the unit tests is correct in failing - a loop count of 0 should not run any samples, but it runs forever. So I'm afraid the patch needs a bit more work.", "is_private": false, "id": 126924, "creator": "sebb@apache.org", "time": "2009-05-10T17:04:44Z", "bug_id": 39509, "creation_time": "2009-05-10T17:04:44Z", "attachment_id": null}, {"count": 13, "tags": [], "creator": "milamber@apache.org", "attachment_id": null, "id": 126927, "time": "2009-05-10T23:42:23Z", "bug_id": 39509, "creation_time": "2009-05-10T23:42:23Z", "is_private": false, "text": "Ok, I suppose that is the \"-1\" start value for iteration number.\nI will revise the patch"}, {"count": 14, "tags": [], "text": "Created attachment 23737\nProposal patch\n\nNew (replacing) patch to this bug.\nNow a \"(event.getIteration() == 0)\" when the precedent controller aren't a instance of LoopController (including Thread Group) \n\nAll test cases works (ant tests)\n\nUse cases:\nWhen OOC directly attached to TG : 1 iteration\nWhen OCC directly attached to Loop Controller : 1 iteration per loop\nWhen OOC attached to another controller : 1 iteration (scope TG)", "is_private": false, "id": 127528, "creator": "milamber@apache.org", "time": "2009-05-31T14:55:12Z", "bug_id": 39509, "creation_time": "2009-05-31T14:55:12Z", "attachment_id": 23737}, {"count": 15, "tags": [], "creator": "milamber@apache.org", "text": "Created attachment 23738\nTest Plan to (not) show bug (use cases)", "id": 127529, "time": "2009-05-31T14:58:47Z", "bug_id": 39509, "creation_time": "2009-05-31T14:58:47Z", "is_private": false, "attachment_id": 23738}, {"count": 16, "tags": [], "creator": "sebb@apache.org", "text": "Thanks very much, that last patch seems to have done the trick!\n\nURL: http://svn.apache.org/viewvc?rev=781785&view=rev\nLog:\nBug 39509 -  Once-only controller running twice", "id": 127656, "time": "2009-06-04T09:03:44Z", "bug_id": 39509, "creation_time": "2009-06-04T09:03:44Z", "is_private": false, "attachment_id": null}, {"count": 17, "tags": [], "text": "*** Bug 47647 has been marked as a duplicate of this bug. ***", "is_private": false, "id": 129481, "creator": "milamber@apache.org", "time": "2009-08-05T05:47:51Z", "bug_id": 39509, "creation_time": "2009-08-05T05:47:51Z", "attachment_id": null}, {"count": 18, "tags": [], "text": "Author: pmouawad\nDate: Tue Oct 24 07:06:54 2017\nNew Revision: 1813140\n\nURL: http://svn.apache.org/viewvc?rev=1813140&view=rev\nLog:\nBug 39509 - Once-only controller running twice\nRemove out of date note since this bug fixed the issues.", "attachment_id": null, "id": 201613, "creator": "p.mouawad@ubik-ingenierie.com", "time": "2017-10-24T07:12:51Z", "bug_id": 39509, "creation_time": "2017-10-24T07:12:51Z", "is_private": false}]