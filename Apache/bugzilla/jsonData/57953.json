[{"count": 0, "tags": [], "text": "httpd allows multiple certificates (RSA, DSA & ECC) for a single TLS virtual host. It would be extremely useful to add this feature to Tomcat.\n\nWe could easily extend the hack we used for SNI as follows:\n\n1. When parsing the client hello, remember the cipher suites the client asked for (currently we just skip over them).\n\n2. Filter the server supported cipher suites for each SSLHostConfig based on which certificate types are available.\n\n3. When doing selecting the SSLHostConfig and more than one certificate is present identify the preferred cipher suite (if server order: first cipher in server list that client supports; if client order: first cipher in client list that server supports) and from that select the appropriate certificate.\n\nAnd bingo, we can support RSA, DSA, ECC and whatever is next type certs in parallel.\n\nConfiguration wise I think the certificate attributes would need to move to a nested <Certificate .../> element within the <SSLHostConfig .../>", "is_private": false, "bug_id": 57953, "id": 183119, "time": "2015-05-27T08:55:17Z", "creator": "markt@apache.org", "creation_time": "2015-05-27T08:55:17Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "Implemented and tested in trunk for NIO and NIO2 if folks want to experiment. APR/native is untested at the moment.", "attachment_id": null, "bug_id": 57953, "id": 183700, "time": "2015-06-22T22:36:03Z", "creator": "markt@apache.org", "creation_time": "2015-06-22T22:36:03Z", "is_private": false}, {"count": 2, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "text": "Tested and working in APR/native as well.", "id": 183710, "time": "2015-06-23T13:47:11Z", "bug_id": 57953, "creation_time": "2015-06-23T13:47:11Z", "is_private": false}]