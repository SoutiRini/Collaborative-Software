[{"count": 0, "tags": [], "creator": "jesse@swank.ca", "text": "I am using poi-2.5.1-final-20040804.jar with Microsoft Office 2004 for Mac. I have used POI to create a \n.xls file that is unreadable by Microsoft Excel.\n\nWhen I attempt to open  the file created by POI, Excel reports a dialog, \"Unable to read file.\" when I \nattempt to open it. The file is unreadable only when a hyperlink label is >= 128 characters. The exact \nsame document opens fine if the hyperlink label is 127 characters or less.\n\nSee also issue 32255. In this case, POI writes the XLS file correctly without an \nArrayIndexOutOfBoundsException. The difference between the issues is that this hyperlink points to a \ndifferent sheet.\n\nHere is a test program. Execute it with a 128 (or greater) character parameter to create a broken Excel \nfile:\n\nimport java.util.*;\nimport java.io.*;\nimport org.apache.poi.hssf.usermodel.*;\n\n/**\n * This class uses POI to create an XLS file which cannot be read by\n * Microsoft Excel.\n *\n * @author <a href=\"mailto:jesse@swank.ca\">Jesse Wilson</a>\n */\npublic class ExcelHyperlink2 {\n    \n    public static void main(String[] args) throws IOException {\n        if(args.length != 1) {\n            System.out.println(\"Usage: ExcelHyperlink label\");\n            return;\n        }\n\n        // the target sheet\n        String targetSheetName = \"2\";\n        \n        // create a workbook, sheet, row and cell\n        HSSFWorkbook workbook = new HSSFWorkbook();\n        HSSFSheet sheet1 = workbook.createSheet(\"1\");\n        HSSFRow row = sheet1.createRow((short)0);\n        HSSFCell cell = row.createCell((short)0);\n            \n        // create a hyperlink in our cell, labelled by the argument\n        String target = \"\\\"#\" + targetSheetName + \"!B2\\\"\";\n        String label = \"\\\"\" + args[0] + \"\\\"\";\n        String formula = \"HYPERLINK(\" + target + \", \" + label + \")\";\n        System.out.println(formula);\n        cell.setCellFormula(formula);\n\n        // create a target sheet\n        HSSFSheet sheet2 = workbook.createSheet(targetSheetName);\n\n        // write the file\n        FileOutputStream xlsOut = new FileOutputStream(new File(\"hyperlink.xls\"));\n        workbook.write(xlsOut);\n        xlsOut.close();\n    }\n}", "id": 66969, "time": "2004-11-15T22:35:25Z", "bug_id": 32256, "creation_time": "2004-11-15T22:35:25Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "text": "I am using POI 2.5.1 final on Windows and experience the same issue. Running \nJava 1.4.2.", "is_private": false, "id": 84409, "creator": "darktyco@yahoo.com", "time": "2006-01-09T19:46:43Z", "bug_id": 32256, "creation_time": "2006-01-09T19:46:43Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 32256, "attachment_id": null, "text": "Using the latest code in SVN this test case works fine.\n\nJason", "id": 84695, "time": "2006-01-17T10:21:26Z", "creator": "jheight@apache.org", "creation_time": "2006-01-17T10:21:26Z", "is_private": false}]