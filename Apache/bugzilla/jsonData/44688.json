[{"count": 0, "tags": [], "creator": "Sumit.Jain@Lntinfotech.com", "text": "I am using the 3.0.1-FINAL version of POI. I was not successful in adding comments to more than one cell in a loop. I couldn't figure out what is happening to the comment objects I am creating using the command HSSFPatriarch.createComment() function. Please look at the code I am using bellow: \n\nScenario1: \nCreated a comment object, added it to the cell in a for loop --> expected result, all the cells in the excel sheet should have the same comment. \n==> Result I am getting: Only the top most cell of the excel sheet is having the comment. The cell is choosen arbritrarliy at times.\n\nScenario2: \nCreated a comment object, added it to the cell. Created another comment object (but not added to any cell) in a for loop --> expected result: all the cells in the excel sheet should have the first comment\n==> Result I am getting: One cell has the first comment and another has the second comment (please note, I've never added the second comment to any of the cells). The selection of the cells is arbitrary at times.\n\nMy actual requirement is to add comments to selected cells.\n\nYour help in this regard is highly appreciated.\n\nCode I've used for adding comments :\nHSSFPatriarch patr = finalSheet.createDrawingPatriarch();\nHSSFCell cell1 = finalSheet.createRow(4).createCell((short)1);\nHSSFCell cell = finalSheet.createRow(5).createCell((short)1);\nHSSFComment comment1 = patr.createComment(new HSSFClientAnchor(0, 100, 0, 0, (short)4, 2, (short) 6, 5));\ncomment1.setString(new HSSFRichTextString(\"help me\"));\ncomment1.setAuthor(\"SUMIT\");\nnewCell.setCellComment(comment1);\ncell.setCellComment(comment1); \ncell1.setCellComment(comment1);", "id": 115011, "time": "2008-03-27T04:19:58Z", "bug_id": 44688, "creation_time": "2008-03-27T04:19:58Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "text": "I have a feeling that a comment can only be added to one cell\n\nIf you create+attach one comment per cell, does it all work?", "is_private": false, "bug_id": 44688, "id": 115015, "time": "2008-03-27T05:02:44Z", "creator": "apache@gagravarr.org", "creation_time": "2008-03-27T05:02:44Z", "attachment_id": null}, {"count": 2, "attachment_id": null, "bug_id": 44688, "text": "--- Comment #1 from Nick Burch <nick@torchbox.com>  2008-03-27 05:02:44 PST ---\nI have a feeling that a comment can only be added to one cell\n\nIf you create+attach one comment per cell, does it all work?\n\n-------------------------------------------Sumit\n\n\ni have tried this too. i am creating the object of HSSFComment and HSSFCell in a loop and try to set that new object of comment in the cell and that too in a loop\n \nexpected result-->>>comment in all the cells\n\nresult-->>only one comment comes and that too in arbitary cell", "id": 115016, "time": "2008-03-27T05:14:43Z", "creator": "Sumit.Jain@Lntinfotech.com", "creation_time": "2008-03-27T05:14:43Z", "tags": [], "is_private": false}, {"count": 3, "attachment_id": null, "bug_id": 44688, "text": "I tried creating object of HSSFCell and HSSFComment object in a loop andtry to set that new object of comment in new cell.....\n\ni.e. i m always creating a new object of comment for each cell but thatdoest not even work.", "id": 115017, "time": "2008-03-27T05:28:09Z", "creator": "Sumit.Jain@Lntinfotech.com", "creation_time": "2008-03-27T05:28:09Z", "tags": [], "is_private": false}, {"count": 4, "attachment_id": null, "bug_id": 44688, "text": "If you add comments with poi, save and re-load into poi, do they appear on the correct cells then?\n\nIf not, could you please knock up a quick unit test for the problem? Just something that creates a new workbook and sheet, and adds a few cells, attaches comments to those. Write a to ByteArrayOutputStream, read in again from a ByteArrayInputStream, and assert that the comments are on the right cells (this bit will fail)\n\nWe'll then have something to test future fixes against", "id": 115023, "time": "2008-03-27T05:50:15Z", "creator": "apache@gagravarr.org", "creation_time": "2008-03-27T05:50:15Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "bug_id": 44688, "is_private": false, "text": "Created attachment 21727\nunit test containing object of HSSFComment being created in a loop\n\nThis  test file creates object of cell and comment in a loop and the output is---> comment in only one cell\n\nthis happens even after writing in ByteArrayOutputStream and then reading from ByteArrayInputStream", "id": 115061, "time": "2008-03-27T23:49:48Z", "creator": "Sumit.Jain@Lntinfotech.com", "creation_time": "2008-03-27T23:49:48Z", "attachment_id": 21727}, {"count": 6, "tags": [], "bug_id": 44688, "attachment_id": 21728, "text": "Created attachment 21728\nunit test containing one object of comment for all the cells \n\nThis  test file has only one comment for three cells and the output is -->>comment in only one cell\nthis happens even after writing in ByteArrayOutputStream and then reading from ByteArrayInputStream", "id": 115062, "time": "2008-03-27T23:54:40Z", "creator": "Sumit.Jain@Lntinfotech.com", "creation_time": "2008-03-27T23:54:40Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 44688, "text": "Created attachment 21729\nunit test containing one unused object of HSSFComment \n\nIN this test file i have created 3 cells and 2 comment objects and have not used one comment object\nThe comment object which is not used is being displayed in excel file in the first cell which is total disaster...", "id": 115063, "time": "2008-03-27T23:58:40Z", "creator": "Sumit.Jain@Lntinfotech.com", "creation_time": "2008-03-27T23:58:40Z", "is_private": false, "attachment_id": 21729}, {"count": 8, "tags": [], "creator": "Sumit.Jain@Lntinfotech.com", "text": "Created attachment 21730\nunit test showing more than 1 comment in a excel file\n\n this test file will only generate the expected result  while this is exactly same as in attachment no 21727", "id": 115064, "time": "2008-03-28T00:01:07Z", "bug_id": 44688, "creation_time": "2008-03-28T00:01:07Z", "is_private": false, "attachment_id": 21730}, {"count": 9, "attachment_id": null, "bug_id": 44688, "text": "Hi,\n\n(1) A comment can be assigned to only one cell. If you assign the same comment object to multiple cells then only the last cell will have it. \n(2) HSSFPatriarch is a sheet-scope object, not comment-scope. Move it out of the loop and all will be fine:\n\nHSSFPatriarch patr = finalsheet.createDrawingPatriarch();\nfor(int i=0;i<3;i++)\n{\n  HSSFCell cell1=finalsheet.createRow(2).createCell((short) i);\n  HSSFComment comment1 = patr.createComment(new HSSFClientAnchor(0, 100, 0, 0, (short)4, 2, (short) 6, 5));\n}\n\nI updated the docs to state it.\n\n(3) In the forth example you don't set comment text for comment2 and comment3. Excel doesn't like it and says the file is corrupted.\n\nCheck the code:\n\n HSSFPatriarch patr = finalsheet.createDrawingPatriarch();\n HSSFComment comment1 = patr.createComment(new HSSFClientAnchor(0, 100, 0, 0, (short)4, 2, (short) 6, 5));\n comment1.setString(new HSSFRichTextString(\"help me 1\"));\n HSSFComment comment2 = patr.createComment(new HSSFClientAnchor(0, 100, 0, 0, (short)4, 2, (short) 6, 5));\n //should it be comment2 \n comment1.setString(new HSSFRichTextString(\"help me 2\"));\n\n HSSFComment comment3 = patr.createComment(new HSSFClientAnchor(0, 100, 0, 0, (short)4, 2, (short) 6, 5));\n //should it be comment3 \n comment1.setString(new HSSFRichTextString(\"help me 3\"));\n\t \t \n cell1.setCellComment(comment1);\n cell2.setCellComment(comment2);\n cell3.setCellComment(comment3);\n\nIt looks like a copy/paste bug. \n\n(4) Your problem has nothing to do with serialization. It doesn't matter if you write directly to FileOutputStream or serialize in a byte buffer and then to a file. \n\nRegards,\nYegor", "id": 115070, "time": "2008-03-28T05:00:34Z", "creator": "yegor@dinom.ru", "creation_time": "2008-03-28T05:00:34Z", "tags": [], "is_private": false}]