[{"count": 0, "tags": [], "bug_id": 46908, "attachment_id": null, "id": 125778, "time": "2009-03-24T22:41:53Z", "creator": "apache@stuartr.net", "creation_time": "2009-03-24T22:41:53Z", "is_private": false, "text": "tomcat-users.xml has invalid encoding \"cp1252\" when using endorsed library xercesImpl.jar when tomcat is run for the first time.\n\n(in tomcat.6.0.16 the default encoding for the file was utf-8... now for tomcat.6.0.18 it is cp1252)\n\nWe have an installation process for our software which: \n1. Installs our software\n2. Fires up the windows installation for tomcat.6.0.18\n3. configures the endorsed java options by modifying the registry setting for tomcat  (ie -Djava.endorsed.dirs=C:\\Program Files\\Apache Software Foundation\\Tomcat 6.0\\endorsed)\n4. copies the endorsed jar files to the endorsed directory\n5. deploys our application's war file to the webapps directory.\n6. attempts to start tomcat\n\nThe generated exception is:\nINFO: Starting Servlet Engine: Apache Tomcat/6.0.18\nMar 25, 2009 4:06:37 PM org.apache.tomcat.util.digester.Digester fatalError\nSEVERE: Parse Fatal Error at line 1 column 40: Invalid encoding name \"cp1252\".\norg.xml.sax.SAXParseException: Invalid encoding name \"cp1252\".\n\tat org.apache.xerces.util.ErrorHandlerWrapper.createSAXParseException(Unknown Source)\n...\n\nMy workaround for this problem is to deploy a copy of tomcat-users.xml file with the encoding set to \"utf-8\" to the conf directory before tomcat is attempted to be started. (ie between steps 5 and 6 above).  Once tomcat is started, this file is overwritten anyway."}, {"count": 1, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "text": "The change to cp1252 is as a result of bug 45332.\n\nWhen you use xerces via the endorsed mechanism, the feature http://apache.org/xml/features/allow-java-encodings is false so cp1252 isn't recognised.\n\nI'll look at using the IANA names.", "id": 125789, "time": "2009-03-25T10:03:56Z", "bug_id": 46908, "creation_time": "2009-03-25T10:03:56Z", "is_private": false}, {"count": 2, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "text": "A fix has been made in trunk and proposed for 6.0.x.\n\nI took a different approach (which will only work with xerces) that tries to configure the xml parser to support the java encoding names.", "id": 125790, "time": "2009-03-25T10:55:47Z", "bug_id": 46908, "creation_time": "2009-03-25T10:55:47Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 46908, "attachment_id": null, "id": 127290, "time": "2009-05-22T08:00:07Z", "creator": "markt@apache.org", "creation_time": "2009-05-22T08:00:07Z", "is_private": false, "text": "This has been fixed in 6.0.x and will be included in 6.0.21 onwards."}]