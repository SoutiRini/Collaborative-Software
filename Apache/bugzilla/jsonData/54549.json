[{"count": 0, "attachment_id": null, "bug_id": 54549, "is_private": false, "id": 165178, "time": "2013-02-11T19:51:16Z", "creator": "daniel.lescohier@cnet.com", "creation_time": "2013-02-11T19:51:16Z", "tags": [], "text": "In mod_mime's AddEncoding documentation:\nhttps://httpd.apache.org/docs/2.4/mod/mod_mime.html#addencoding\n\nIt says:\n\n\"Old clients expect x-gzip and x-compress, however the standard dictates that they're equivalent to gzip and compress respectively. Apache does content encoding comparisons by ignoring any leading x-. When responding with an encoding Apache will use whatever form (i.e., x-foo or foo) the client requested. If the client didn't specifically request a particular form Apache will use the form given by the AddEncoding directive. To make this long story short, you should always use x-gzip and x-compress for these two specific encodings. More recent encodings, such as deflate, should be specified without the x-.\"\n\nThis functionality of choosing x-gzip or gzip for Content-Encoding based on Accept-Encoding actually depends on mod_negotiation being loaded, so that mod_negotiation's fix_encoding() fixup hook is registered.\n\nAt minimum, the AddEncoding documentation should be updated to say that mod_negotiation must be loaded in order for that functionality to work.\n\nHowever, one could argue that the fix_encoding() fixup belongs in mod_mime instead of mod_negotiation, because it implements a feature in mod_mime, not mod_negotiation.\n\nOn my QA server, before loading mod_negotiation (see difference in last line of each):\n\n> GET /js/dw.js HTTP/1.1\n> User-Agent: curl/7.15.5 (x86_64-redhat-linux-gnu) libcurl/7.15.5 OpenSSL/0.9.8b zlib/1.2.3 libidn/0.6.5\n> Host: dw.qa.com.com\n> Accept: */*\n> Accept-Encoding: deflate, gzip\n> \n< HTTP/1.1 200 OK\n< Date: Mon, 11 Feb 2013 18:41:21 GMT\n< Server: Apache/2.4.3\n< Vary: Accept-Encoding\n< Last-Modified: Wed, 05 Dec 2012 18:28:07 GMT\n< ETag: \"1a27-4d01f24cfbbc0\"\n< Accept-Ranges: bytes\n< Content-Length: 6695\n< Cache-Control: max-age=1800\n< Expires: Mon, 11 Feb 2013 19:11:21 GMT\n< P3P: CP=\"CAO DSP COR CURa ADMa DEVa PSAa PSDa IVAi IVDi CONi OUR OTRi IND PHY ONL UNI FIN COM NAV INT DEM STA\"\n< Content-Type: application/javascript\n< Content-Encoding: x-gzip\n\nAfter loading mod_negotiation:\n\n> GET /js/dw.js HTTP/1.1\n> User-Agent: curl/7.15.5 (x86_64-redhat-linux-gnu) libcurl/7.15.5 OpenSSL/0.9.8b zlib/1.2.3 libidn/0.6.5\n> Host: dw.qa.com.com\n> Accept: */*\n> Accept-Encoding: deflate, gzip\n> \n< HTTP/1.1 200 OK\n< Date: Mon, 11 Feb 2013 19:34:04 GMT\n< Server: Apache/2.4.3\n< Vary: Accept-Encoding\n< Last-Modified: Wed, 05 Dec 2012 18:28:07 GMT\n< ETag: \"1a27-4d01f24cfbbc0\"\n< Accept-Ranges: bytes\n< Content-Length: 6695\n< Cache-Control: max-age=1800\n< Expires: Mon, 11 Feb 2013 20:04:04 GMT\n< P3P: CP=\"CAO DSP COR CURa ADMa DEVa PSAa PSDa IVAi IVDi CONi OUR OTRi IND PHY ONL UNI FIN COM NAV INT DEM STA\"\n< Content-Type: application/javascript\n< Content-Encoding: gzip"}]