[{"count": 0, "tags": [], "creator": "syyid@poboxes.com", "is_private": false, "id": 74395, "attachment_id": null, "bug_id": 34727, "creation_time": "2005-05-03T19:29:40Z", "time": "2005-05-03T19:29:40Z", "text": "From tracing the code, it seems that a FontRecord is created with byte 14 > 0\nwhich in turn causes\nfield_10_font_name_len  > 0 causing unicode decoding code to be invoked which\nproduces the exception itself. I've followed the codepath and the data array is\nfilled directly from the inputstream, retrieving a +ve 124 for data[14].\n\nCaused by: java.lang.IllegalArgumentException: Illegal length\n    at org.apache.poi.util.StringUtil.getFromUnicodeLE(StringUtil.java:78)\n    at org.apache.poi.hssf.record.FontRecord.fillFields(FontRecord.java:146)\n    at org.apache.poi.hssf.record.Record.fillFields(Record.java:91)\n    at org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n    at org.apache.poi.hssf.record.FontRecord.<init>(FontRecord.java:88)\n    ... 25 more\n\nThe exception is thrown in getFromUnicodeLE but i havent encountered that method\nusually being called to begin with. \n\nThe font used itself is Arial so i'm not sure why its causing a problem.\n\nThe value for data[14]=124\nThe value for data[15]=109\n\nAlso when the getFromUnicodeLE function is called, the length of the byte array\ntitled string is 26 , the offset passed is 16 and the len paramater is 124. \nPrinting out the function  header \ngetFromUnicodeLE(final byte[] string,final int offset,final int len)\nand I get getFromUnicodeLE([B@1f436f5,16,124)\n\nAlso I got the same problem with 2.0 FINAL and the HEAD version I checked out\nfrom CVS"}, {"count": 1, "tags": [], "creator": "jheight@apache.org", "text": "Can you upload a excel file causing the issue, or recheck against the latest svn\ncode.\n\nJason", "id": 91684, "time": "2006-07-28T03:26:14Z", "bug_id": 34727, "creation_time": "2006-07-28T03:26:14Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 34727, "text": "\n\n*** This bug has been marked as a duplicate of 39190 ***", "id": 92573, "time": "2006-08-27T11:06:59Z", "creator": "jheight@apache.org", "creation_time": "2006-08-27T11:06:59Z", "is_private": false, "attachment_id": null}]