[{"count": 0, "tags": [], "creator": "satishkk@collabera.com", "attachment_id": null, "id": 133824, "time": "2010-01-22T01:30:42Z", "bug_id": 48598, "creation_time": "2010-01-22T01:30:42Z", "is_private": false, "text": "We are using poi3.0.2.jar file.\n\nwhere the code(attached) works fine for xls files\n\nwb=WorkbookFactory.create(fin);\nSheet sheet = wb.getSheetAt(0);\nRow row;\nCell cell;\nfor(int r = 0; r < rows; r++) {\n\tSystem.out.println();\n\trow = sheet.getRow(r);\n\tif(row != null) {\n\tfor(int c = -1; c < cols; c++) {\n\tcell = row.getCell((short)c);\n\t}\n\nwhere as if I  pass xlsx files its giving followig error.\n\njava.lang.IllegalArgumentException: Cell index must be >= 0\n\tat org.apache.poi.xssf.usermodel.XSSFRow.getCell(XSSFRow.java:191)\n\tat org.apache.poi.xssf.usermodel.XSSFRow.getCell(XSSFRow.java:178)\n\tat org.apache.poi.xssf.usermodel.XSSFRow.getCell(XSSFRow.java:35)\n\tat ReadExcel.readBoth(ReadExcel.java:190)\n\tat ReadExcel.main(ReadExcel.java:39)\n\nThe problem is with row.getCell(-1)\nthis method returns null in POI3.0.2\nthe same method throws IllegalArgumentException in POI3.5\n\nSo we need to change the code?"}, {"count": 1, "tags": [], "text": "row.getCell(-1) is not a valid thing to ask for\n\nAs the error message tells you, cells start at 0. Either ask for cells from 0 onwards, or use an iterator.", "is_private": false, "bug_id": 48598, "id": 133831, "time": "2010-01-22T02:23:04Z", "creator": "apache@gagravarr.org", "creation_time": "2010-01-22T02:23:04Z", "attachment_id": null}]