[{"count": 0, "tags": [], "bug_id": 46670, "is_private": false, "text": "When I try to refer to a cell in a different excel file, I do not get an error, but when I open the file in Excel, the contents of the cell is #REF!A1 for example. I used this code:\n\ncell.setCellFormula(\"folder\\\\[workbook.xls]sheet!A1\");\n\nSince I cannot find anything about this problem, I thought it could be a bug.\n\nGreetings,\n\nWim", "id": 124704, "time": "2009-02-07T02:58:17Z", "creator": "wimgoeman@gmail.com", "creation_time": "2009-02-07T02:58:17Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 46670, "is_private": false, "text": "I've discovered an issue (that appears to be similar to this issue) within an application that we have build (using POI 3.6). I can provide examples as needed, but is this specific issue slated for inclusion within POI 3.7?\n\nThanks,\n\nDave Sprague\nDirector, Product Management\nTrintech", "id": 135454, "time": "2010-03-18T22:42:54Z", "creator": "dave.sprague@trintech.com", "creation_time": "2010-03-18T22:42:54Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "dave.sprague@trintech.com", "attachment_id": null, "is_private": false, "id": 135686, "time": "2010-03-26T21:07:52Z", "bug_id": 46670, "creation_time": "2010-03-26T21:07:52Z", "text": "Trintech is supplying a zip file with examples. Please review file entitled 2160_1900_801_+_810_XXX_FY10_P05 (2).xls to determine if this issue is related."}, {"count": 3, "attachment_id": 25193, "bug_id": 46670, "text": "Created attachment 25193\nTrintech_POI examples.zip", "id": 135688, "time": "2010-03-26T21:10:32Z", "creator": "dave.sprague@trintech.com", "creation_time": "2010-03-26T21:10:32Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 46670, "text": "This looks to be very similar to bug #45970, except that was for URLs and this is for local files. I suspect a fix for one will fix the other", "id": 137357, "time": "2010-06-04T10:52:10Z", "creator": "apache@gagravarr.org", "creation_time": "2010-06-04T10:52:10Z", "is_private": false, "attachment_id": null}, {"count": 5, "attachment_id": null, "bug_id": 46670, "text": "I got the same problem on POI 3.6, and i see this issue has been opened 2 years ago. \nThis is a very important feature for developers working with excel files. \nI do not understand why is still unsolved...", "id": 146936, "time": "2011-06-07T17:34:17Z", "creator": "nicolamansi@gmail.com", "creation_time": "2011-06-07T17:34:17Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "bug_id": 46670, "text": "Apache POI is a volunteer project. If this new feature is important to you, please do work on it and send in patches!", "id": 146944, "time": "2011-06-07T21:09:16Z", "creator": "apache@gagravarr.org", "creation_time": "2011-06-07T21:09:16Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 46670, "text": "I'm very disappointed with your banal reply. \nI know that this is a volunteer project, in my post I was just pointing out that in 2 years none has noticed this important issue, and I do not understand the roughness of your reply.\nGreetings", "id": 146951, "time": "2011-06-08T07:43:24Z", "creator": "nicolamansi@gmail.com", "creation_time": "2011-06-08T07:43:24Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "creator": "valeriy.panfilov@gmail.com", "attachment_id": null, "is_private": false, "id": 178500, "time": "2014-10-16T07:55:02Z", "bug_id": 46670, "creation_time": "2014-10-16T07:55:02Z", "text": "Is there ANY workaround?"}, {"count": 9, "tags": [], "bug_id": 46670, "attachment_id": null, "is_private": false, "id": 178501, "time": "2014-10-16T08:34:27Z", "creator": "apache@gagravarr.org", "creation_time": "2014-10-16T08:34:27Z", "text": "There was a large amount of work done on 3D references (workbook+sheet+cell) in 3.11 beta 1, see http://poi.apache.org/changes.html#3.11-beta1 . A lot of things that used to fail with these now work. \n\nIt'd therefore be great if someone could re-test this specific issue with 3.11 beta 2, and see if the work in there has fixed this case as well. If not, a small junit unit test showing how this issue remains would be most helpful!"}, {"count": 10, "tags": [], "bug_id": 46670, "is_private": false, "text": "Created attachment 32116\nFailed test case for 3.11-beta2\n\nI wrote a simple test case for poi 3.11-beta2. I tried to modify some references to another .xls files, can be accessed locally or over http. The test failed, when I try to set cell formula with external reference it gives me #REF all the time.", "id": 178506, "time": "2014-10-16T11:38:44Z", "creator": "valeriy.panfilov@gmail.com", "creation_time": "2014-10-16T11:38:44Z", "attachment_id": 32116}, {"count": 11, "tags": [], "bug_id": 46670, "is_private": false, "text": "Thanks for the tests\n\nBased on this, I've added in r1633257 something based on your tests for HSSF only, along with an expanded version for HSSF and XSSF\n\nBad news - it fails on both, for different reasons... I suspect someone will need to fix the XSSF case first, as that should be simpler to understand, then look into why the HSSF one is failing earlier", "id": 178628, "time": "2014-10-20T23:24:17Z", "creator": "apache@gagravarr.org", "creation_time": "2014-10-20T23:24:17Z", "attachment_id": null}, {"count": 12, "attachment_id": null, "bug_id": 46670, "text": "I tried to work on this for the XSSF side, the following will parse the bookname when the formula is parsed, although the unit test does not build the \"ExternalLinkTable\" and thus the unit tests still fails and I could not see how that can be fixed correctly in the test or in the product code.\n\ndiff --git a/src/java/org/apache/poi/ss/formula/FormulaParser.java b/src/java/org/apache/poi/ss/formula/FormulaParser.java\nindex 72ed008..6940a71 100644\n--- a/src/java/org/apache/poi/ss/formula/FormulaParser.java\n+++ b/src/java/org/apache/poi/ss/formula/FormulaParser.java\n@@ -792,6 +792,18 @@ public final class FormulaParser {\n                        StringBuffer sb = new StringBuffer();\n \n                        Match('\\'');\n+                       // try again to read external workbook-name as it could have been enclosed in the single quotes\n+                       if (look == '[') {\n+                               StringBuilder sbBook = new StringBuilder();\n+                               GetChar();\n+                               while (look != ']') {\n+                                       sbBook.append(look);\n+                                       GetChar();\n+                               }\n+                               GetChar();\n+                               bookName = sbBook.toString();\n+                       }\n+\n                        boolean done = look == '\\'';\n                        while(!done) {\n                                sb.append(look);", "id": 183003, "time": "2015-05-17T21:53:32Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-05-17T21:53:32Z", "tags": [], "is_private": false}]