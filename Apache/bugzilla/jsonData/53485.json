[{"count": 0, "tags": [], "bug_id": 53485, "attachment_id": null, "text": "I'm using Async Servlet in my application for chatting\nand I've found threads like 'http-nio-80-ClientPoller' loads cpu for 100%\nit happens really frequently\n\nDo you have any suggestions how to fix it?\nThank you.\n\n<Connector port=\"80\"\n               protocol=\"org.apache.coyote.http11.Http11NioProtocol\"\n               connectionTimeout=\"20000\"\n               redirectPort=\"443\" \n               server=\" \"\n               maxKeepAliveRequests=\"-1\"\n               maxSpareThreads=\"200\" maxThreads=\"200\" minSpareThreads=\"100\"\n\n               socket.soKeepAlive=\"true\"\n               asyncTimeout=\"30000\"\n    />\n\npublic class AsyncChatServlet extends HttpServlet {\n\n    @Override\n    protected void doPost(final HttpServletRequest request, final HttpServletResponse response) throws ServletException, IOException {\n\n            final AsyncContext asyncContext = request.startAsync();\n            asyncContext.start(new Runnable() {\n                @Override\n                public void run() {\n                    try {\nChatServer chatServer = ChatContainer.getChatServer(chatRequest.getRoom());\n                            synchronized (chatServer) {\n//chatServer notified on new message\n                                chatServer.wait(20000);\n                            }\n...\n                    } catch (Exception e) {\n                        e.printStackTrace();\n                    }\n                    asyncContext.complete();\n}\n}", "id": 160343, "time": "2012-06-29T11:05:44Z", "creator": "dimazaur@gmail.com", "creation_time": "2012-06-29T11:05:44Z", "is_private": false}, {"count": 1, "tags": [], "creator": "markt@apache.org", "text": "Bugzilla is not a support forum. Please upgrade to the latest release (7.0.28 at the time of writing) that includes a number of NIO fixes. If you still see issues, please use the users mailing list to debug in the first instance. If this issue is re-opened you'll need to provide enough information for the issue to be reproduced and/or understood. Some thread dumps would be a start.", "id": 160345, "time": "2012-06-29T12:46:37Z", "bug_id": 53485, "creation_time": "2012-06-29T12:46:37Z", "is_private": false, "attachment_id": null}]