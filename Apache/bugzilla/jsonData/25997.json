[{"count": 0, "text": "Index: TTFFile.java\n===================================================================\nRCS file: /home/cvspublic/xml-fop/src/org/apache/fop/fonts/Attic/TTFFile.java,v\nretrieving revision 1.6.2.10\ndiff -w -u -r1.6.2.10 TTFFile.java\n--- TTFFile.java\t20 Sep 2003 21:48:18 -0000\t1.6.2.10\n+++ TTFFile.java\t8 Jan 2004 19:32:42 -0000\n@@ -51,10 +51,14 @@\n package org.apache.fop.fonts;\n \n import java.io.IOException;\n\n+\n import java.util.ArrayList;\n\n+\n import java.util.HashMap;\n\n+\n import java.util.Iterator;\n\n \n+\n /**\n  * Reads a TrueType file or a TrueType Collection.\n  * The TrueType spec can be found at the Microsoft\n@@ -112,6 +116,7 @@\n     HashMap ansiIndex;\n \n     private TTFDirTabEntry currentDirTab;\n+    private boolean isCFF = false;\n \n     /**\n      * Position inputstream to position indicated\n@@ -431,16 +436,22 @@\n         initAnsiWidths();\n         readPostscript(in);\n         readOS2(in);\n+        if (!isCFF) {\n         readIndexToLocation(in);\n         readGlyf(in);\n+        }\n         readName(in);\n         readPCLT(in);\n         readCMAP(in);     // Read cmap table and fill in ansiwidths\n         createCMaps();    // Create cmaps for bfentries\n         // print_max_min();\n \n+\t\tif (isCFF) {\n+\t\t\t// readGPOS(in); // GPOS is OpenType CFF analog of \nTrueType kerning table.\t\t\t\n+\t\t} else {\n         readKerning(in);\n     }\n+    }\n \n     private void createCMaps() {\n         cmaps = new ArrayList();\n@@ -626,6 +637,10 @@\n         return is_embeddable;\n     }\n \n+    public boolean isCFF() {\n+    \treturn isCFF;\n+    }\n+\n \n     /**\n      * Read Table Directory from the current position in the\n@@ -634,7 +649,22 @@\n      * as value.\n      */\n     protected void readDirTabs(FontFileReader in) throws IOException {\n-        in.skip(4);    // TTF_FIXED_SIZE\n+\t\tbyte[]  verBytes = new byte[4];\n+\t\tverBytes[0] = in.readTTFByte();\n+\t\tverBytes[1] = in.readTTFByte();\n+\t\tverBytes[2] = in.readTTFByte();\n+\t\tverBytes[3] = in.readTTFByte();\n+\t\tString version = new String(verBytes, \"ISO-8859-1\");\n+\t\tif (verBytes[1] == 0x01) {\n+\t\t\tSystem.out.println(\"Font is TrueType TTF format\");\t\n\t\t\n+\t\t} else if (version.equals(\"OTTO\")) {\n+\t\t\tSystem.out.println(\"Font is OpenType CFF format\");\n+\t\t\tisCFF = true;\n+\t\t} else {\n+\t\t\tString msg = \"Font does not appear to be either \nTrueType or OpenType\";\n+\t\t\tthrow new IOException(msg);\n+\t\t}\n+\n         int ntabs = in.readTTFUShort();\n         in.skip(6);    // 3xTTF_USHORT_SIZE\n \nIndex: TTFDirTabEntry.java\n===================================================================\nRCS file: /home/cvspublic/xml-\nfop/src/org/apache/fop/fonts/Attic/TTFDirTabEntry.java,v\nretrieving revision 1.4.2.2\ndiff -w -u -r1.4.2.2 TTFDirTabEntry.java\n--- TTFDirTabEntry.java\t20 Sep 2003 21:48:18 -0000\t1.4.2.2\n+++ TTFDirTabEntry.java\t8 Jan 2004 19:32:01 -0000\n@@ -50,7 +50,8 @@\n  */\n package org.apache.fop.fonts;\n \n-import java.io.IOException;\n\n+import java.io.IOException;\nimport java.io.UnsupportedEncodingException;\n+\n \n class TTFDirTabEntry {\n     byte[] tag;\n@@ -85,7 +86,18 @@\n          * \" length: \" + length +\n          * \" name: \" + new String(tag));\n          */\n-        return new String(tag, \"ISO-8859-1\");\n+\t\tString tagStr = new String(tag, \"ISO-8859-1\");\n+        // System.err.println(\"tag='\" + tagStr + \"'\");\n+\n+        //System.out.println(this.toString());\n+        return tagStr;\n     }\n \n+\tpublic String getTagString() {\n+\t\ttry {\n+\t\t\treturn new String(tag, \"ISO-8859-1\");\n+\t\t} catch (UnsupportedEncodingException e) {\n+\t\t\treturn this.toString(); // Should never happen.\n+\t\t}\n+\t}\n }\n\nIndex: TTFReader.java\n===================================================================\nRCS file: /home/cvspublic/xml-\nfop/src/org/apache/fop/fonts/apps/Attic/TTFReader.java,v\nretrieving revision 1.4.2.5\ndiff -w -u -r1.4.2.5 TTFReader.java\n--- TTFReader.java\t20 Sep 2003 21:48:18 -0000\t1.4.2.5\n+++ TTFReader.java\t8 Jan 2004 19:33:25 -0000\n@@ -425,6 +425,9 @@\n             }\n         }\n \n+\t\t// TODO: Need to get equivalent info from GPOS table for\n+\t\t// CFF fonts.\t\t\n+\t\tif (!ttf.isCFF()) {\n         // Get kerning\n         Iterator enum;\n         if (isCid)\n@@ -457,6 +460,7 @@\n                 }\n             }\n         }\n+\t\t}\n \n         return doc;\n     }", "bug_id": 25997, "attachment_id": null, "id": 50275, "time": "2004-01-08T19:50:15Z", "creator": "drmacro@yahoo.com", "creation_time": "2004-01-08T19:50:15Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "bowditch_chris@hotmail.com", "text": "related thread in FOP dev\n\nhttp://marc.theaimsgroup.com/?l=fop-dev&m=107342953607261&w=2", "id": 50302, "time": "2004-01-09T08:38:27Z", "bug_id": 25997, "creation_time": "2004-01-09T08:38:27Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 25997, "attachment_id": null, "text": "Won't be fixed in the maintenance branch. It is fixed in FOP Trunk. See\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=25999 and\nhttp://svn.apache.org/viewvc?view=rev&rev=503317", "id": 98938, "time": "2007-02-03T13:59:19Z", "creator": "jeremias@apache.org", "creation_time": "2007-02-03T13:59:19Z", "is_private": false}, {"count": 3, "tags": [], "creator": "gadams@apache.org", "attachment_id": null, "id": 156475, "time": "2012-04-01T13:48:39Z", "bug_id": 25997, "creation_time": "2012-04-01T13:48:39Z", "is_private": false, "text": "batch transition to closed remaining pre-FOP1.0 resolved bugs"}]