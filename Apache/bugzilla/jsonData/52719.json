[{"count": 0, "tags": [], "bug_id": 52719, "text": "The fix revision 423920 was aimed to remove an resource leak bug on the  JarFile \"jarFile \"  in the method \"validateJarFile\" of the file \"/tomcat/tc6.0.x/trunk/java/org/apache/catalina/loader/WebappClassLoader.java\" , but it is incomplete. \n\nWhen the statements at lines 3226-3245 throw any eception, the object \"jarFile \" can not be closed as expected. The best way to close such resource object is putting such close operations in the finaly block of a try-catch-finally structure.\n\nThe buggy code is copies as bellows: \n\n\n3220 protected boolean validateJarFile(File jarfile)\n        throws IOException {\n\n        if (triggers == null)\n            return (true);\n3225        JarFile jarFile = new JarFile(jarfile);\n3226        for (int i = 0; i < triggers.length; i++) {\n            Class clazz = null;\n            try {\n                if (parent != null) {\n                    clazz = parent.loadClass(triggers[i]);\n                } else {\n                    clazz = Class.forName(triggers[i]);\n                }\n            } catch (Throwable t) {\n                clazz = null;\n            }\n            if (clazz == null)\n                continue;\n            String name = triggers[i].replace('.', '/') + \".class\";\n            if (log.isDebugEnabled())\n                log.debug(\" Checking for \" + name);\n            JarEntry jarEntry = jarFile.getJarEntry(name);\n            if (jarEntry != null) {\n                log.info(\"validateJarFile(\" + jarfile + \n                    \") - jar not loaded. See Servlet Spec 2.3, \"\n                    + \"section 9.7.2. Offending class: \" + name);\n3246                jarFile.close();\n                return (false);\n            }\n        }\n        jarFile.close();\n        return (true);\n\n    }", "id": 153963, "time": "2012-02-21T09:37:53Z", "creator": "lianggt08@sei.pku.edu.cn", "creation_time": "2012-02-21T09:37:53Z", "is_private": false, "attachment_id": null}, {"count": 1, "attachment_id": null, "creator": "markt@apache.org", "is_private": false, "id": 154656, "time": "2012-03-07T22:00:35Z", "bug_id": 52719, "creation_time": "2012-03-07T22:00:35Z", "tags": [], "text": "r423920 has nothing to do with resource leaks. Starting a bug report with a clearly invalid statement does little to help the credibility of the report.\n\nSeverity set to something more realistic given the likelihood of this ever actually happening.\n\nFixed in trunk and 7.0.x for 7.0.27. Proposed for 6.0.x although I'd be equally happy with WONTFIX for 6.0.x."}, {"count": 2, "tags": [], "bug_id": 52719, "is_private": false, "id": 155265, "creation_time": "2012-03-23T17:02:47Z", "time": "2012-03-23T17:02:47Z", "creator": "knst.kolinko@gmail.com", "text": "Fixed in 6.0 with r1304483 and will be in 6.0.36", "attachment_id": null}]