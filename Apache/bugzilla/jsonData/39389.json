[{"count": 0, "tags": [], "bug_id": 39389, "attachment_id": null, "text": "Hi,\n\nWe use POI in production and have problems with extended ASCII WingDings.\n\nStandard ASCII characters with values less than 128 are displayed correctly. The\nproblem is with the chars with \nASCII values 128 through 255. \n\nWhen I open the generated workbook I see the 'unknown' glyph in positions where\nmy extended WingDings should be.\nBut If I switch the font to Arial and then back to WingDings I see the correct\nglyphs. It tells me that POI stores \nthe correct character values but something else is missing which prevents Excel\nfrom displaying them correctly. \n\nSee the attached test case.  I also have this problem when I try to use\nWingDings in the office drawing and put \nWingDings in a text box.\n\n\nRegards, Yegor Kozlov", "id": 88415, "time": "2006-04-24T10:01:57Z", "creator": "yegor@dinom.ru", "creation_time": "2006-04-24T10:01:57Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 39389, "attachment_id": 18161, "text": "Created attachment 18161\ntest case", "id": 88416, "time": "2006-04-24T10:03:00Z", "creator": "yegor@dinom.ru", "creation_time": "2006-04-24T10:03:00Z", "is_private": false}, {"count": 2, "tags": [], "text": "Created attachment 18165\nsample workbook with extended ascii wingdings", "is_private": false, "id": 88426, "creator": "yegor@dinom.ru", "time": "2006-04-24T13:03:29Z", "bug_id": 39389, "creation_time": "2006-04-24T13:03:29Z", "attachment_id": 18165}, {"attachment_id": null, "tags": [], "bug_id": 39389, "is_private": false, "count": 3, "id": 88464, "time": "2006-04-25T09:53:08Z", "creator": "yegor@dinom.ru", "creation_time": "2006-04-25T09:53:08Z", "text": "Hi\n\nI found what is wrong.\nIf you deal with symbolic fonts like Wingdings you need to set the correct\ncharacter set.\nThis is the important setting. \n\nI added the required modifiers to org.apache.poi.hssf.usermodel.HSSFFont. \n\nSo if you work with Wingdings  you need to set the charset as follows:\n\n HSSFFont hssfFont = wb.createFont();\n hssfFont.setFontName(\"Wingdings\");\n hssfFont.setCharSet(HSSFFont.SYMBOL_CHARSET); //this is the important setting!\n \nAfter I applied this change I could see the correct glyphs. \nIt works both for text in cells and in text box in escher graphics.\n\nRegards, Yegor Kozlov"}, {"count": 4, "tags": [], "bug_id": 39389, "attachment_id": 18179, "is_private": false, "id": 88465, "time": "2006-04-25T09:53:47Z", "creator": "yegor@dinom.ru", "creation_time": "2006-04-25T09:53:47Z", "text": "Created attachment 18179\npatch for HSSFFont"}, {"count": 5, "attachment_id": 18180, "creator": "yegor@dinom.ru", "is_private": false, "id": 88466, "time": "2006-04-25T09:54:22Z", "bug_id": 39389, "creation_time": "2006-04-25T09:54:22Z", "tags": [], "text": "Created attachment 18180\nHSSFFont which can modify charset"}, {"attachment_id": null, "tags": [], "bug_id": 39389, "text": "OK, I've applied your patch\n\nHowever, I think it's not very \"usermodel\" like to require people to know to\nchange the characterset after changing the font.\n\nWhat do people think about having a list of fonts which require the alternate\ncharacter set, and having setFontName() try to do the right thing?\n", "count": 6, "id": 90303, "time": "2006-06-16T14:58:39Z", "creator": "apache@gagravarr.org", "creation_time": "2006-06-16T14:58:39Z", "is_private": false}]