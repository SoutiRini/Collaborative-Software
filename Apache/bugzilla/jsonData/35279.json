[{"count": 0, "tags": [], "bug_id": 35279, "attachment_id": null, "text": "We found out that starting with apache version 2.0.49, the behavior of Apache \n(2.0.49 up to 2.0.54 )running with mod_ssl and OPenSSL/0.9.7g is changed after \nthe reception of a [RST, ACK] packet from Internet Explorer 6.0.\n\nThis problem does not happen with 2.0.47 and 2.0.48.\n\nThe impact is an increase packets transmitted and communication delays when \nthis behavior starts.\n\n\n1. Expected Behavior. Apache/OPenSSL use as a Proxy to WebLogic\n\nWhen we start Apache, and request a page (IE 6.0) using this kind of URL: \nhttps://mvperf1/jmsproxy/1KBytesR.jsp, we can see that the response is \nreturned as a single SSL packet as shown here.\n\nNo.     Time        Source                Destination           Protocol Info\n\n     19 0.091816    70.81.65.10           198.252.177.204       SSLv3    \nApplication Data\n\n     20 0.000218    198.252.177.204       198.252.177.27        HTTP     \nGET /jmsproxy/jmsproxy.do?\nevent=update&userid=Int1user2&count=20&ackIdList=&lastMsgCount=0&latency=113.60\n7810087752 HTTP/1.1\n\n     21 0.001157    198.252.177.27        198.252.177.204       HTTP     \nHTTP/1.1 200 OK\n\n     22 0.000012    198.252.177.204       198.252.177.27        TCP      43341 \n> 7002 [ACK] Seq=564 Ack=255 Win=16800 Len=0 TSV=478522705 TSER=171779478\n\n     23 0.000004    198.252.177.27        198.252.177.204       HTTP     \nContinuation or non-HTTP traffic\n\n     24 0.000005    198.252.177.204       198.252.177.27        TCP      43341 \n> 7002 [ACK] Seq=564 Ack=315 Win=16800 Len=0 TSV=478522705 TSER=171779478\n\n \n\n     25 0.000575    198.252.177.204       70.81.65.10           SSLv3    \nApplication Data, Application Data, Application Data, Application Data \n\nData returned as 1 packet (4 SSL section in this packet)\n\n     26 0.111146    70.81.65.10           198.252.177.204       TCP      62101 \n> https [ACK] Seq=450 Ack=353 Win=64272 Len=0\n\n\nIf there is no operation witht he IE Browser for 60 seconds, it will send a \n[RST, ACK] packet to Apache. After a few of these reset, then the next set of \ncommunication (after the normal SSL handshake) will cause Apache/OPenSLL to \nsend the SSL information as 4 independant packets.\n\nThe problem is relatively easy to reproduce with 1 or 2 IE browsers.\n\n\nNo.     Time        Source                Destination           Protocol Info\n\n     19 0.091816    70.81.65.10           198.252.177.204       SSLv3    \nApplication Data\n\n     20 0.000218    198.252.177.204       198.252.177.27        HTTP     \nGET /jmsproxy/jmsproxy.do?\nevent=update&userid=Int1user2&count=20&ackIdList=&lastMsgCount=0&latency=113.60\n7810087752 HTTP/1.1\n\n     21 0.001157    198.252.177.27        198.252.177.204       HTTP     \nHTTP/1.1 200 OK\n\n     22 0.000012    198.252.177.204       198.252.177.27        TCP      43341 \n> 7002 [ACK] Seq=564 Ack=255 Win=16800 Len=0 TSV=478522705 TSER=171779478\n\n     23 0.000004    198.252.177.27        198.252.177.204       HTTP     \nContinuation or non-HTTP traffic\n\n     24 0.000005    198.252.177.204       198.252.177.27        TCP      43341 \n> 7002 [ACK] Seq=564 Ack=315 Win=16800 Len=0 TSV=478522705 TSER=171779478\n\n \n\n     25 0.000575    198.252.177.204       70.81.65.10           SSLv3    \nApplication Data\n\n     26 0.000021    198.252.177.204       70.81.65.10           SSLv3    \nApplication Data\n\n     27 0.000039    198.252.177.204       70.81.65.10           SSLv3    \nApplication Data\n\n     28 0.111146    70.81.65.10           198.252.177.204       TCP      62101 \n> https [ACK] Seq=450 Ack=353 Win=64272 Len=0\n\n     29 0.000021    198.252.177.204       70.81.65.10           SSLv3    \nApplication Data\n\n     30 0.108034    70.81.65.10           198.252.177.204       TCP      62101 \n> https [ACK] Seq=450 Ack=455 Win=64170 Len=0", "id": 76191, "time": "2005-06-09T02:10:01Z", "creator": "jean.dagenais@integral.com", "creation_time": "2005-06-09T02:10:01Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 35279, "attachment_id": 15345, "text": "Created attachment 15345\npossible fix\n\nThanks for the detailed report and analysis.  Can you try this patch?", "id": 76197, "time": "2005-06-09T10:12:14Z", "creator": "jorton@redhat.com", "creation_time": "2005-06-09T10:12:14Z", "is_private": false}, {"count": 2, "tags": [], "creator": "jorton@redhat.com", "text": "This looks obviously correct, so, committed to trunk;\nhttp://svn.apache.org/viewcvs?rev=189971&view=rev\nand proposed for backport for 2.0.x.\n\nThanks again for the report and analysis.", "id": 76270, "time": "2005-06-10T17:21:55Z", "bug_id": 35279, "creation_time": "2005-06-10T17:21:55Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 35279, "attachment_id": null, "text": "We have tested the fix and confirm that the problem is resolved.\n", "id": 76396, "time": "2005-06-14T14:24:30Z", "creator": "jean.dagenais@integral.com", "creation_time": "2005-06-14T14:24:30Z", "is_private": false}]