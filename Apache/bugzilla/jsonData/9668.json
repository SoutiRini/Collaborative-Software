[{"count": 0, "tags": [], "creator": "rkhimasia@bcbsm.com", "attachment_id": null, "id": 17325, "time": "2002-06-06T16:33:46Z", "bug_id": 9668, "creation_time": "2002-06-06T16:33:46Z", "is_private": false, "text": "The PVCS task has been failing in Ant1.5Beta1 and Ant1.5Beta2. I have tried \nthis task with both JDK1.4 and JDK1.3.1 and get the same results. \n\nThis task use to work fine with ant1.4.1\n\nThe following is the output I get.\n------------------------------------------------------------------\nBuildfile: pvcsTargets.xml\nDetected Java version: 1.3 in: d:\\jdk1.3.1\\jre\nDetected OS: Windows NT\nparsing buildfile pvcsTargets.xml with URI = \nfile:C:/WebDenisBuildArea/pvcsTargets.xml\nProject base dir set to: C:\\WebDenisBuildArea\nBuild sequence for target `pvcsGet' is [init, pvcsGet]\nComplete build sequence is [init, pvcsGet, insertBuildInfo, \npvcsListVersionedFiles, pvcsLabelTrunk, pvcsLabelBranchHippa1, pvcsLabelProd, \npvcsLabelBranchProdFix, deleteTempPcliFile, pvcsLabelBranchBcnReferal]\n\ninit:\n [property] Loading C:\\WebDenisBuildArea\\antBuildGlobal.properties\n [property] Loading Environment myenv.\nOverride ignored for property pvcsLabel\n\npvcsGet:\n     [pvcs] Executing 'pcli' with arguments:\n     [pvcs] 'lvf'\n     [pvcs] '-z'\n     [pvcs] '-aw'\n     [pvcs] '-sp'/@/Public/antBuild''\n     [pvcs] '-pr'\\\\snt210\\DenisReEng\\DenisTeam\\PVCS''\n     [pvcs] ''/denis3''\n     [pvcs] The ' characters around the executable and arguments are\n     [pvcs] not part of the command.\n     [pvcs] PVCS Version Manager (VMGUI) v6.7.11 (Build 915.09) for Windows \nNT/80x86\n     [pvcs] Copyright 1985-2001 MERANT.  All rights reserved.\n     [pvcs] Creating folders\n     [pvcs] Considering \"\"\\\\snt210\\DenisReEng\\DenisTeam\\PVCS\\archives\\denis3\n\\denis_app.webapp-arc(C:\\WebDenisBuildArea\\tempFiles\\denis3\\denis_app.webapp)\"\"\n\nBUILD FAILED\nC:\\WebDenisBuildArea\\pvcsTargets.xml:110: Failed executing: pcli lvf -z -aw \"-\nsp'/@/Public/antBuild'\" \"-pr'\\\\snt210\\DenisReEng\\DenisTeam\\PVCS'\" \"'/denis3'\". \nException: MessageFormat parse error!\n\tat org.apache.tools.ant.taskdefs.optional.pvcs.Pvcs.execute\n(Pvcs.java:278)\n\tat org.apache.tools.ant.Task.perform(Task.java:317)\n\tat org.apache.tools.ant.Target.execute(Target.java:309)\n\tat org.apache.tools.ant.Target.performTasks(Target.java:334)\n\tat org.apache.tools.ant.Project.executeTarget(Project.java:1216)\n\tat org.apache.tools.ant.Project.executeTargets(Project.java:1160)\n\tat org.apache.tools.ant.Main.runBuild(Main.java:605)\n\tat org.apache.tools.ant.Main.start(Main.java:195)\n\tat org.apache.tools.ant.Main.main(Main.java:234)\n\nTotal time: 9 seconds"}, {"count": 1, "tags": [], "creator": "snewton@io.com", "attachment_id": null, "id": 17326, "time": "2002-06-06T16:42:50Z", "bug_id": 9668, "creation_time": "2002-06-06T16:42:50Z", "is_private": false, "text": "I would like to see your ant build file for that target.  However, as a test,\ntry adding the following attribute to the pvcs target:\n\nfilenameFormat=\"{0}-arc({1})\""}, {"count": 2, "tags": [], "bug_id": 9668, "attachment_id": null, "text": "I did add that filenameFormat attribute and that did fix the problem. Thanks. \n\nI have attached my new build file with the filenameFormat attribute, in \nthe \"pvcsGet\" target. In this file you will notice a lot of other targets to \nadd version labels to PVCS archives. It would be nice if ANT provided \nadditional tasks for doing this. \n\nThanks for you help.\n\nRahul.", "id": 17327, "time": "2002-06-06T17:04:27Z", "creator": "rkhimasia@bcbsm.com", "creation_time": "2002-06-06T17:04:27Z", "is_private": false}, {"count": 3, "tags": [], "creator": "rkhimasia@bcbsm.com", "attachment_id": null, "id": 17328, "time": "2002-06-06T17:05:13Z", "bug_id": 9668, "creation_time": "2002-06-06T17:05:13Z", "is_private": false, "text": "Here is the file.\n\n<?xml version='1.0' encoding='utf-8'?>\n<project name=\"PvcsTargets\" default=\"pvcsGetTrunk\" basedir=\".\" >\n    <description>\n        This ant project labels and gets files from PVCS. \n        This project has targets to version label files, get files from PVCS.\n\n        The addPvcsLabel target uses the PVCS PCLI command. This command\n        needs a PCLI_ID environment vartiable set, to let PCLI can get \n        permissions to work on the PVCS project database.\n\n        The targets in this file should be called from other files\n        like build.xml\n    </description>\n\n    <target name=\"init\" >\n        <property file=\"antBuildGlobal.properties\" />\n        <property environment=\"myenv\" />\n        <tstamp>\n            <format property=\"buildTime\" pattern=\"MMM d, yyyy h:mm a\" />\n        </tstamp>\n        <property name=\"repository\" \n            value=\"\\\\snt210\\DenisReEng\\DenisTeam\\PVCS\" />\n\n        <property name=\"pvcsLabel\" value=\"\" />\n        <property name=\"tempPcliFile\" value=\"tempPcliFile\" />\n\n        <property name=\"buildWorkspace\" \n            value=\"'/@/Public/antBuild'\" />\n        <property name=\"vaTrunkWorkspace\" \n            value=\"'/@/Public/VARunable/Trunk_Phase2_3'\" />\n        <property name=\"vaBranchBugFixWorkspace\" \n            value=\"'/@/Public/VARunable/Branch_Phase1_BugFix'\" />\n    </target>\n\n    <target name=\"pvcsListVersionedFiles\" depends=\"init\" >\n        <delete quiet=\"true\" file=\"${tempPcliFile}\" />\n        <exec executable=\"pcli\"  >\n            <arg line=\"run -ao${tempPcliFile} listversionedfiles -z -aw -\nsp${buildWorkspace} -pr${repository}\" />\n        </exec>\n        <replace file=\"${tempPcliFile}\" token=\"\\\\\" value=\"\\\\\\\" />\n    </target>\n\n    <target name=\"pvcsLabelProd\" depends=\"init\" >\n        <exec executable=\"vcs\" >\n            <arg line=\"-y -rPROD -v${pvcsLabel} @${tempPcliFile}\" />\n        </exec>\n    </target>\n\n    <target name=\"pvcsLabelTrunk\" depends=\"init\" \n            description=\"label PVCS files on the trunk\" >\n        <antcall target=\"pvcsListVersionedFiles\" />\n        <antcall target=\"pvcsLabelProd\" />\n        <exec executable=\"vcs\" >\n            <arg line=\"-y -rQA_(aix101) -v${pvcsLabel} @${tempPcliFile}\" />\n        </exec>\n        <exec executable=\"vcs\" >\n            <arg line=\"-y -rTest_(scratchy) -v${pvcsLabel} @${tempPcliFile}\" />\n        </exec>\n        <antcall target=\"deleteTempPcliFile\" />\n    </target>\n\n    <target name=\"pvcsLabelBranchProdFix\" depends=\"init\" \n            description=\"label PVCS files on the branch prodfix\" >\n        <antcall target=\"pvcsListVersionedFiles\" />\n        <antcall target=\"pvcsLabelProd\" />\n        <exec executable=\"vcs\" >\n            <arg line=\"-y -rprodfix_qa_(aix101) -v${pvcsLabel} \n@${tempPcliFile}\" />\n        </exec>\n        <exec executable=\"vcs\" >\n            <arg line=\"-y -rprodfix_test_(scratchy) -v${pvcsLabel} \n@${tempPcliFile}\" />\n        </exec>\n        <antcall target=\"deleteTempPcliFile\" />\n    </target>\n\n    <target name=\"pvcsLabelBranchBcnReferal\" depends=\"init\" \n            description=\"label PVCS files on the branch Bcn Referal\" >\n        <antcall target=\"pvcsListVersionedFiles\" />\n        <antcall target=\"pvcsLabelProd\" />\n        <exec executable=\"vcs\" >\n            <arg line=\"-y -rbcnreferal_qa_(aix101) -v${pvcsLabel} \n@${tempPcliFile}\" />\n        </exec>\n        <exec executable=\"vcs\" >\n            <arg line=\"-y -rbcnreferal_test_(scratchy) -v${pvcsLabel} \n@${tempPcliFile}\" />\n        </exec>\n        <antcall target=\"deleteTempPcliFile\" />\n    </target>\n\n    <target name=\"pvcsLabelBranchHippa1\" depends=\"init\" \n            description=\"label PVCS files on the branch Hippa1\" >\n        <antcall target=\"pvcsListVersionedFiles\" />\n        <antcall target=\"pvcsLabelProd\" />\n        <exec executable=\"vcs\" >\n            <arg line=\"-y -rhippa1_qa_(aix101) -v${pvcsLabel} \n@${tempPcliFile}\" />\n        </exec>\n        <exec executable=\"vcs\" >\n            <arg line=\"-y -rhippa1_test_(scratchy) -v${pvcsLabel} \n@${tempPcliFile}\" />\n        </exec>\n        <antcall target=\"deleteTempPcliFile\" />\n    </target>\n\n    <target name=\"deleteTempPcliFile\" depends=\"init\" >\n        <delete quiet=\"false\" file=\"${tempPcliFile}\" />\n    </target>\n\n    <target name=\"pvcsGet\" depends=\"init\" \n        description=\"gets files from PVCS\" >\n        <pvcs repository=\"'${repository}'\" \n            workspace=\"${buildWorkspace}\" \n          label=\"${pvcsLabel}\" \n          filenameFormat=\"{0}-arc({1})\"\n          updateonly=\"true\" >\n            <pvcsproject name=\"'/denis3'\" />\n        </pvcs>\n        <antcall target=\"insertBuildInfo\" inheritAll=\"true\" />\n    </target>\n\n    <target name=\"insertBuildInfo\" depends=\"init\" >\n        <property name=\"bottomMenuHtml\" \n            value=\"${docrootDir}/htmlTemp/bottomMenu.html\" />\n        <replace file=\"${bottomMenuHtml}\" token=\"##AntReplace_BuildNumber##\" \n            value=\"${pvcsLabel}\" />\n        <replace file=\"${bottomMenuHtml}\" token=\"##AntReplace_BuildTime##\" \n            value=\"${buildTime}\" />\n    </target>\n</project>\n"}, {"count": 4, "tags": [], "bug_id": 9668, "is_private": false, "text": "Documentation for the archive extension and filenameFormat attribute could be\nbetter.  Better pvcs tasks for ant would depend on demand and resources, and I\nwill help as I can.", "id": 17329, "time": "2002-06-06T17:17:37Z", "creator": "snewton@io.com", "creation_time": "2002-06-06T17:17:37Z", "attachment_id": null}]