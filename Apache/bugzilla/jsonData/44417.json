[{"text": "Following the example from\n\nhttp://poi.apache.org/hssf/quick-guide.html#NamedRanges\n\nI have the following code:\n\n    int cellIndex = workbook.getNameIndex(cellName);\n    HSSFName name = workbook.getNameAt(cellIndex);\n    AreaReference aref = new AreaReference(name.getReference());\n    // assume a single cell in named area\n    CellReference cref = aref.getAllReferencedCells()[0];\n    log.debug(cellName + \": \" +\n              cref.getSheetName() + \", \" + cref.getRow() +\n              \", \" + cref.getCol());\n    HSSFSheet s = workbook.getSheet(cref.getSheetName());\n\nUnfortunately, the getSheet() call returns null.  In the logging line above,\ngetSheetName() shows single quotes around the name.  If I remove those single\nquotes, the getSheet() call works correctly.\n\ni.e.:\n\n    HSSFSheet s = workbook.getSheet(cref.getSheetName().replaceAll(\"'\", \"\"));", "tags": [], "creator": "breaux@users.sourceforge.net", "is_private": false, "count": 0, "id": 113719, "time": "2008-02-13T09:33:51Z", "bug_id": 44417, "creation_time": "2008-02-13T09:33:51Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 44417, "attachment_id": 21525, "text": "Created attachment 21525\nsvn diffs for 16 changed files", "id": 113731, "time": "2008-02-13T22:32:15Z", "creator": "josh@apache.org", "creation_time": "2008-02-13T22:32:15Z", "is_private": false}, {"count": 2, "tags": [], "creator": "josh@apache.org", "is_private": false, "text": "Created attachment 21526\ntar bz2 of one added test case", "id": 113732, "time": "2008-02-13T22:32:48Z", "bug_id": 44417, "creation_time": "2008-02-13T22:32:48Z", "attachment_id": 21526}, {"count": 3, "attachment_id": null, "bug_id": 44417, "text": "Added patch to fix this bug.\n\nThe example provided was not explicit, but it is assumed that the sheet name \nhad special characters in it (probably a space).  There has been a recent \nchange (44336) that causes \"name.getReference()\" in the example to return \nquoted sheet names if any special characters are present.  The required fix is \nto make AreaReference and CellReference handle sheet names with special \ncharacters.\n\n\nFixed AreaReference.separateAreaRefs() to only consider cell delimiters (:) \noutside quoted sheet names.\nFixed CellReference.separateRefParts() to handle sheet names with special \ncharacters (assuming properly delimited).\nMade sure CellReference.getSheetName() returns a raw sheet name.\n\n\nChanged AreaReference to model its 2 CellReference components as first class \nfields 'firstCell' and 'lastCell' instead of an array.\n\nCreated new methods \"formatAsString()\" on AreaReference and CellReference and \nmoved important logic out of toString().  Added javadoc.\nReplaced all references to AreaReference.toString() and CellReference.toString\n() with calls to formatAsString().\n\nAdded test cases to existing junits TestAreaReference and TestCellReference.  \nAdded test suite for org.apache.poi.hssf.util package.\n\n", "id": 113733, "time": "2008-02-13T22:35:30Z", "creator": "josh@apache.org", "creation_time": "2008-02-13T22:35:30Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 44417, "attachment_id": null, "text": "Actually, that's correct, which I meant to include in the initial description. \nThat is, in this case, the Sheet name contains spaces in it.  Thanks for the\nquick response.", "id": 113745, "time": "2008-02-14T06:36:32Z", "creator": "breaux@users.sourceforge.net", "creation_time": "2008-02-14T06:36:32Z", "is_private": false}, {"count": 5, "tags": [], "creator": "apache@gagravarr.org", "is_private": false, "text": "Thanks for the patch Josh. I'd been planning to do something similar, but it\nlooks from your work that it was a bigger job than I'd expected, so it's great\nyou did it instead of me :)\n\nPatch applied to svn", "id": 113784, "time": "2008-02-15T04:05:38Z", "bug_id": 44417, "creation_time": "2008-02-15T04:05:38Z", "attachment_id": null}]