[{"count": 0, "tags": [], "text": "Apache threads are hanging after starting when Apache is started via one of\nour daemons (Apache is forked off) and Apache is invoked with the -DFOREGROUND option.\n\nThis is on a Linux system and the event MPM is used.\n\nIt's spinning in the ap_mpm_podx_check, doing a read on a bad file descriptor\nIt's trying to read from FD 2, which is the error_log\n\n#0  0x000000321ec0d9eb in read () from /lib64/libpthread.so.0\n#1  0x00000000004988e1 in ap_mpm_podx_check (pod=0x1d6e43a8) at mpm_unix.c:535\n#2  0x00000000005dbd67 in child_main (child_num_arg=2) at worker.c:1341\n#3  0x00000000005dbf1a in make_child (s=0x1d69fa08, slot=2) at worker.c:1427\n#4  0x00000000005dbfb7 in startup_children (number_to_start=1) at worker.c:1452\n#5  0x00000000005dcad5 in worker_run (_pconf=0x1d674138, plog=0x1d6a7648, s=0x1d69fa08) at worker.c:1811\n#6  0x0000000000466b72 in ap_run_mpm (pconf=0x1d674138, plog=0x1d6a7648, s=0x1d69fa08) at mpm_common.c:94\n#7  0x000000000045ed8c in main (argc=5, argv=0x7fff8be62ac8) at main.c:777\n\n\nStrace output:\nread(2, 0x7fff8be625fb, 1)              = -1 EBADF (Bad file descriptor)\nread(2, 0x7fff8be625fb, 1)              = -1 EBADF (Bad file descriptor)\nread(2, 0x7fff8be625fb, 1)              = -1 EBADF (Bad file descriptor)\nread(2, 0x7fff8be625fb, 1)              = -1 EBADF (Bad file descriptor)\n\nIf we run using the preform MPM everything works fine.  If Apache is run from the command line, using the event MPM, everything works fine.  It's only when we\nfork off Apache from our own daemon, use the -DFOREGROUND option, and use the event MPM.", "is_private": false, "bug_id": 57746, "id": 182010, "time": "2015-03-23T20:08:42Z", "creator": "john.swan@oracle.com", "creation_time": "2015-03-23T20:08:42Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "\nThis is using Apache 2.4.12.", "attachment_id": null, "bug_id": 57746, "id": 182017, "time": "2015-03-23T20:34:19Z", "creator": "john.swan@oracle.com", "creation_time": "2015-03-23T20:34:19Z", "is_private": false}, {"count": 2, "tags": [], "text": "I seem to have something similar. Apache 2.4.16 starts spinning wheels at one unidentified point in time. Requests are still served, but the process hogs 100% CPU.\n\nWithout debug symbols\n\n(gdb) bt\n#0  0x00007f1134eccf2d in read () from /lib64/libpthread.so.0\n#1  0x00000000004577b4 in ap_mpm_podx_check ()\n#2  0x000000000042a474 in ?? ()\n#3  0x00000000004694c7 in ?? ()\n#4  0x0000000000469c12 in ?? ()\n#5  0x000000000043161e in ap_run_mpm ()\n#6  0x000000000042af02 in main ()\n\n\nhttp://serverfault.com/questions/487530/find-out-what-high-cpu-usage-apache-process-is-actually-doing points me to /server-status but I can't read anything meaningful out of it just yet. Hints welcome.", "is_private": false, "id": 184972, "creation_time": "2015-09-04T20:24:19Z", "time": "2015-09-04T20:24:19Z", "creator": "leho@kraav.com", "bug_id": 57746, "attachment_id": null}, {"count": 3, "tags": [], "text": "What is the output of gdb's \"thread apply all bt\"?", "attachment_id": null, "bug_id": 57746, "id": 184973, "time": "2015-09-04T20:52:36Z", "creator": "ylavic.dev@gmail.com", "creation_time": "2015-09-04T20:52:36Z", "is_private": false}]