[{"count": 0, "tags": [], "bug_id": 56988, "attachment_id": null, "text": "Someone has configured ASF Buildbot for Tomcat with\n'echo base.path=../basepath > build.properties'\n\nIt resulted in failure at step \"extras-commons-logging\",\nhttp://ci.apache.org/builders/tomcat-7-trunk/builds/296\n\nSome log file snippets:\n\n[[[\ntestexist:\n     [echo] Testing  for ../basepath/avalon-framework-4.1.5/avalon-framework-4.1.5.jar\n\ndownloadfile:\n\n]]]\n\n[[[\nextras-commons-logging:\n   [gunzip] Expanding /home/buildslave32/slave32/tomcat-7-trunk/basepath/commons-logging-1.1.3/commons-logging-1.1.3-src.tar.gz to /home/buildslave32/slave32/tomcat-7-trunk/build/output/extras/logging/commons-logging-src.tar\n    [untar] Expanding: /home/buildslave32/slave32/tomcat-7-trunk/build/output/extras/logging/commons-logging-src.tar into /home/buildslave32/slave32/tomcat-7-trunk/build/output/extras/logging\n    [mkdir] Created dir: /home/buildslave32/slave32/tomcat-7-trunk/build/output/extras/logging/commons-logging-1.1.3-src/src/main/java/org/apache/juli\n     [move] Moving 16 files to /home/buildslave32/slave32/tomcat-7-trunk/build/output/extras/logging/commons-logging-1.1.3-src/src/main/java/org/apache/juli\n     [copy] Copying 1 file to /home/buildslave32/slave32/tomcat-7-trunk/build/output/extras/logging/commons-logging-1.1.3-src\n     [copy] Copying 4 files to /home/buildslave32/slave32/tomcat-7-trunk/build/output/extras/logging/commons-logging-1.1.3-src\n\ninit:\n     [echo] -------- Logging Wrapper Library 1.1.3 --------\n\nprepare:\n     [echo] \n     [echo]     Log4j12: log4j-1.2.17.jar\n     [echo]     \n     [echo]     \n     [echo]     LogKit: ../basepath/logkit-1.0.1/logkit-1.0.1.jar\n     [echo]     Avalon-Framework: ../basepath/avalon-framework-4.1.5/avalon-framework-4.1.5.jar\n     [echo]     \n    [mkdir] Created dir: /home/buildslave32/slave32/tomcat-7-trunk/build/output/extras/logging/commons-logging-1.1.3-src/target\n    [mkdir] Created dir: /home/buildslave32/slave32/tomcat-7-trunk/build/output/extras/logging/commons-logging-1.1.3-src/target/classes\n    [mkdir] Created dir: /home/buildslave32/slave32/tomcat-7-trunk/build/output/extras/logging/commons-logging-1.1.3-src/target/conf\n    [mkdir] Created dir: /home/buildslave32/slave32/tomcat-7-trunk/build/output/extras/logging/commons-logging-1.1.3-src/target/tests\n\nstatic:\n     [copy] Copying 1 file to /home/buildslave32/slave32/tomcat-7-trunk/build/output/extras/logging/commons-logging-1.1.3-src/target/conf\n\ndiscovery:\n\nlog4j12-warning:\n\nlog4j13-warning:\n\nlogkit-warning:\n     [echo] \n     [echo]     *** WARNING ***\n     [echo]     LogKit not found: Cannot Build LogKitLogger\n     [echo]     \n\njdk1.4-warning:\n\navalon-framework-warning:\n     [echo] \n     [echo]     *** WARNING ***\n     [echo]     Avalon-Framework not found: Cannot Build AvalonLogger\n     [echo]     \n\ncompile-non-log4j:\n    [javac] /home/buildslave32/slave32/tomcat-7-trunk/build/output/extras/logging/commons-logging-1.1.3-src/build2.xml:362: warning: 'includeantruntime' was not set, defaulting to build.sysclasspath=last; set to false for repeatable builds\n    [javac] Compiling 11 source files to /home/buildslave32/slave32/tomcat-7-trunk/build/output/extras/logging/commons-logging-1.1.3-src/target/classes\n    [javac] /home/buildslave32/slave32/tomcat-7-trunk/build/output/extras/logging/commons-logging-1.1.3-src/src/main/java/org/apache/juli/logging/impl/ServletContextCleaner.java:23: package javax.servlet does not exist\n    [javac] import javax.servlet.ServletContextEvent;\n    [javac]                     ^\n]]]\n\nSo,\n1. avalon-framework-4.1.5.jar was present and has not been downloaded\n2. commons-logging build script failed to detect it,\nwith \"Avalon-Framework not found: Cannot Build AvalonLogger\"\n\nCompilation is performed by \n\n    <ant antfile=\"${tomcat.extras}/logging/commons-logging-${commons-logging.version}-src/build2.xml\"\n         dir=\"${tomcat.extras}/logging/commons-logging-${commons-logging.version}-src\"\n         target=\"compile\" />\n\nSo dir is a different directory.\n\n\nFix\n====\nI was able to fix this issue by adding inheritAll=\"false\" to the above <ant> command.", "id": 177928, "time": "2014-09-17T12:27:06Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2014-09-17T12:27:06Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 56988, "attachment_id": null, "text": "Fixed by r1625599 and r1625606. The fix will be in 8.0.12, 7.0.56 onwards.", "id": 177935, "time": "2014-09-17T14:18:23Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2014-09-17T14:18:23Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 56988, "text": "Created attachment 32041\n2014-09-22_tc6_56988.patch\n\nPatch for Tomcat 6\nTested with Ant 1.8.0", "id": 178021, "time": "2014-09-22T10:40:49Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2014-09-22T10:40:49Z", "is_private": false, "attachment_id": 32041}, {"count": 3, "tags": [], "bug_id": 56988, "attachment_id": null, "text": "Fixed in Tomcat 6 by r1632761 and will be in 6.0.43 onwards.", "id": 178579, "time": "2014-10-18T11:26:21Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2014-10-18T11:26:21Z", "is_private": false}]