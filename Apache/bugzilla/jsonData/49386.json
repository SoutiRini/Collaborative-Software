[{"attachment_id": 25525, "tags": [], "creator": "rick.cameron@sap.com", "text": "Created attachment 25525\nPPTX showing NPE\n\nWhen Tika tried to read metadata from a PPTX that has a null creation date, an NPE occurs in PackagePropertiesPart.getDateValue. \n\n\tprivate String getDateValue(Nullable<Date> d) {\n\t\tif (d == null) {\n\t\t\treturn \"\";\n\t\t}\n\t\tSimpleDateFormat df = new SimpleDateFormat(\n\t\t\t\t\"yyyy-MM-dd'T'HH:mm:ss'Z'\");\n\t\treturn df.format(d.getValue());\n\t}\n\nAlthough the code checks whether d is null, it appears that d.getValue() returns null, and an NPE is thrown in SimpleDateFormat.format:\n\nCaused by: java.lang.NullPointerException\n\tat java.util.Calendar.setTime(Calendar.java:1075)\n\tat java.text.SimpleDateFormat.format(SimpleDateFormat.java:876)\n\tat java.text.SimpleDateFormat.format(SimpleDateFormat.java:869)\n\tat java.text.DateFormat.format(DateFormat.java:316)\n\tat org.apache.poi.openxml4j.opc.internal.PackagePropertiesPart.getDateValue(PackagePropertiesPart.java:587)", "count": 0, "id": 137341, "time": "2010-06-03T18:01:32Z", "bug_id": 49386, "creation_time": "2010-06-03T18:01:32Z", "is_private": false}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 137350, "time": "2010-06-04T08:02:53Z", "bug_id": 49386, "creation_time": "2010-06-04T08:02:53Z", "is_private": false, "text": "Fixed in r951384."}]