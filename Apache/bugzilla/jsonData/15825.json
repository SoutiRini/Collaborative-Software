[{"count": 0, "tags": [], "text": "If your dav client is windows explorer and you are listing a webdav folder with \na file with an & in the name, the name will not be displayed correctly.  \nmod_dav is generating correct XML encoding for the filename so if the file is \nnamed \"a & b.txt\" then it will generate \"a%20&amp;%20b.txt\" but windows \nexplorer does not recognize this.  Instead it wants to get \"a%20%26%20b.txt\" \nfor this filename.  If the function dav_xml_escape_uri is changed as follows \nthe correct filename will be encoded and the listing will work properly in \nwindows explorer.\n\n static const char *dav_xml_escape_uri(apr_pool_t *p, const char *uri)\n {\n     const char *e_uri = ap_escape_uri(p, uri);\n+    const char *scan;\n+    apr_size_t len = 0;\n+    apr_size_t extra = 0;\n+    char *qstr;\n+    char *qscan;\n+    char c;\n \n     /* check the easy case... */\n     if (ap_strchr_c(e_uri, '&') == NULL)\n         return e_uri;\n \n     /* there was a '&', so more work is needed... sigh. */\n+    for (scan = e_uri; (c = *scan) != '\\0'; ++scan, ++len) {\n+\tif (c == '&')\n+\t    extra += 2;\t\t/* %26 */\n+    }\n \n-    /*\n-     * Note: this is a teeny bit of overkill since we know there are no\n-     * '<' or '>' characters, but who cares.\n-     */\n-    return ap_xml_quote_string(p, e_uri, 0);\n+    /* nothing to do? */\n+    if (extra == 0)\n+\treturn e_uri;\n+\n+    qstr = apr_palloc(p, len + extra + 1);\n+    for (scan = e_uri, qscan = qstr; (c = *scan) != '\\0'; ++scan) {\n+\tif (c == '&') {\n+\t    *qscan++ = '%';\n+\t    *qscan++ = '2';\n+\t    *qscan++ = '6';\n+\t}\n+\telse {\n+\t    *qscan++ = c;\n+\t}\n+    }\n+\n+    *qscan = '\\0';\n+    return qstr;\n }", "attachment_id": null, "bug_id": 15825, "id": 28924, "time": "2003-01-06T23:43:33Z", "creator": "lneumann@webct.com", "creation_time": "2003-01-06T23:43:33Z", "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 15825, "is_private": false, "id": 38330, "time": "2003-06-04T10:46:42Z", "creator": "gstein@gmail.com", "creation_time": "2003-06-04T10:46:42Z", "tags": [], "text": "Bleh. I just posted about this to the dav-dev mailing list. See:\n\n   http://mailman.lyra.org/pipermail/dav-dev/2003-June/004761.html\n\nI consider this a bug in the client, rather than mod_dav. While the suggested\nfix does provide a legal/valid result, I'd prefer to avoid changing it. We could\njust find clients that break on the %26 style of behavior. Since what mod_dav is\ndoing is legal, and my preference is to avoid the change, I'm closing this as\nWONTFIX.\n\nJulian: I believe this may be a good item for your Web Folders compatibility page."}]