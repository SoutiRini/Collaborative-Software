[{"count": 0, "tags": [], "creator": "Ryan.Lubke@Sun.COM", "attachment_id": null, "text": "Given:\n\n     <fmt:bundle basename=\"some.package.Resources1\"/>\n     <c:out value=\"${page['javax.servlet.jsp.jstl.fmt.basename.page']}\"\n            default=\"Attribute not set\"/>\n     <fmt:locale value=\"de_DE\"/>\n     <fmt:parseDate value=\"Nov 21, 2000 3:45:02 AM\" type=\"both\"/>\n\n     ************************************************************\n\n     The resource bundle referred to by <fmt:bundle> resolves\n     to \"some.package.Resources1_en_US\".\n\n     Client is sending Accept-Language request header with a value\n     of en-US.\n\nResult:\n\nDate is unparsable by the action as it's formatted using the en_US\nlocale, not de_DE.\n\nSection 9.2 page 9-94 of public draft spec, second bullet:\n\n\"I18N default localization context\n \n If a default localation context for I18N actions is specified (via\n the javax.servlet.jsp.jstl.fmt.basename scoped attribute or context\n configuration parameter), the the locale of this default localization\n context for I18N actions is used as the formatting locale\n\n Formatting default localization context\n\n The formatting action itself establishes a localization context according to\n the algorithm described in section 9.3.  This algorithm requires one piece\n of information: the preferred locales.  The way the preferred locales ar set \n is exactly the same as with the I18N actions and is described in section 8.2.2\"\n\nSo if I interpret this correctly, if the basename attribute is present, it\nshould be used even if <fmt:locale> was called before attempting a formatting\noperation.", "id": 13034, "time": "2002-04-08T14:57:05Z", "bug_id": 7842, "creation_time": "2002-04-08T14:57:05Z", "is_private": false}, {"count": 1, "attachment_id": null, "creator": "jan.luehe@sun.com", "is_private": false, "id": 13054, "time": "2002-04-08T19:01:08Z", "bug_id": 7842, "creation_time": "2002-04-08T19:01:08Z", "tags": [], "text": "This is not a bug according to the current state of the spec ;-)\n\nAccording to the spec,\n\n  <fmt:bundle basename=\"some.package.Resources1\"/>\n\ncurrently stores the given base name as a scoped variable (the spec, as of\n4/8/02, does not yet know about \"configuration variables\").\n\nThe subsequent formatting action detects this scoped variable, and attempts to\nload the resource bundle with that base name and the preferred locale. In this\ncase, the preferred locale has been set to \"de_DE\" by the preceding <fmt:locale>\naction. Therefore, the formatting action attempts to load the resource bundle\nwith basename \"some.package.Resources1\" for the \"de_DE\" locale (according to the\nresource bundle determination algorithm from section 8.3.2), and uses the locale\nof the resulting resource bundle, if one is found, or otherwise establishes its\nown localization context (using the \"de_DE\" locale from the <fmt:locale>\naction).\n\nSince in your example the resource bundle determination algorithm does not yield\nany resource bundle for the given base name and \"de_DE\" locale, \"de_DE\" is used\nas the formatting locale, causing the parse operation to fail.\n\nNote that the expert group has proposed to change the behaviour of\n\n  <fmt:bundle basename=\"some.package.Resources1\"/>\n\nto actually load a resource bundle and store it in the new j.s.j.j.fmt.bundle\nconfiguration variable, in which case the client's preferred locale (\"en_US\")\nwill be considered for the resource bundle loading and subsequent formatting\naction.\n\nYour example has actually demonstrated how useful the new j.s.j.j.fmt.bundle\nconfig variable is going to be.\n\n\n"}, {"count": 2, "tags": [], "creator": "jan.luehe@sun.com", "attachment_id": null, "text": "As discussed w/ Ryan, I am closing this as \"not a bug\", since this is the\nexpected behaviour according to the current spec.\n\nThis test will be run again once the j.s.j.j.fmt.bundle configuration variable\nhas been added to the spec and implemented, in which case the parse operation\nshould work.\n\n", "id": 13061, "time": "2002-04-08T20:29:37Z", "bug_id": 7842, "creation_time": "2002-04-08T20:29:37Z", "is_private": false}]