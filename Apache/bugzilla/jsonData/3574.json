[{"count": 0, "tags": [], "bug_id": 3574, "attachment_id": null, "is_private": false, "id": 5428, "time": "2001-09-12T11:13:34Z", "creator": "pier@betaversion.org", "creation_time": "2001-09-12T11:13:34Z", "text": "HTTP-Basic authentication does not work (still) with mod_webapp under \nApache 1.3."}, {"count": 1, "tags": [], "creator": "pier@betaversion.org", "text": "Fixed in CVS thanks to Fred Romelfanger <fred@stsci.edu>", "id": 5501, "time": "2001-09-13T18:10:13Z", "bug_id": 3574, "creation_time": "2001-09-13T18:10:13Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 3574, "attachment_id": null, "is_private": false, "id": 5686, "time": "2001-09-17T15:55:02Z", "creator": "pier@betaversion.org", "creation_time": "2001-09-17T15:55:02Z", "text": "This has not been completely fixed with Fred's patch:\n\n> diff -c -r1.11 WarpRequestHandler.java\n> *** WarpRequestHandler.java     2001/08/09 20:08:58     1.11\n> --- WarpRequestHandler.java     2001/09/14 00:36:42\n> ***************\n> *** 75,80 ****\n> --- 75,82 ----\n> import org.apache.catalina.util.RequestUtil;\n> import org.apache.catalina.util.StringParser;\n> \n> + import java.security.Principal;\n> + \n> public class WarpRequestHandler {\n> \n>     private StringParser parser = new StringParser();\n> ***************\n> *** 167,172 ****\n> --- 169,179 ----\n>                         logger.debug(\"Request user=\"+user+\" auth=\"+auth);\n>                     request.setAuthType(auth);\n>                     // What to do for user name?\n> +                     if(user != null && auth != null && auth.equals(\"Basic\"))\n> {\n> +                         Principal prin = new BasicPrincipal(user);\n> +                         request.setUserPrincipal(prin);\n> +                     }\n> + \n>                     break;\n>                 }\n> \n> ***************\n> *** 397,401 ****\n> --- 404,427 ----\n>         }\n>     }\n> \n> +     class BasicPrincipal implements Principal {\n> +         private String user;\n> \n> +         BasicPrincipal(String user) {\n> +             this.user = user;\n> +         }\n> + \n> +         public boolean equals(Object another) {\n> +             return (another instanceof Principal &&\n> +                 ((Principal)another).getName().equals(user));\n> +         }\n> + \n> +         public String getName() {\n> +             return user;\n> +         }\n> + \n> +         public String toString() {\n> +             return getName();\n> +         }\n> +     }\n> }\n"}, {"count": 3, "tags": [], "bug_id": 3574, "attachment_id": null, "is_private": false, "id": 5687, "time": "2001-09-17T16:01:51Z", "creator": "pier@betaversion.org", "creation_time": "2001-09-17T16:01:51Z", "text": "Fred's patch allows users authenticated in Apache (via mod_auth*) to be \"seen\" correctly by Web \nApplications in Tomcat. But if Apache doesn't authenticate, Tomcat still doesn't see any \nauthentication information as the \"Authorization\" header is not processed. This patch will make it \nwork:\n\n> diff -U3 -r1.16 WarpRequestHandler.java\n> --- WarpRequestHandler.java     2001/09/14 01:04:19     1.16\n> +++ WarpRequestHandler.java     2001/09/17 22:54:39\n> @@ -299,6 +299,10 @@\n>          }\n>          if (name.equalsIgnoreCase(\"Accept-Language\"))\n>              parseAcceptLanguage(logger,req,value);\n> +\n> +        if (name.equalsIgnoreCase(\"Authorization\"))\n> +            req.setAuthorization(value);\n> +\n>          req.addHeader(name,value);\n>      }\n\nAnd it is in CVS now."}]