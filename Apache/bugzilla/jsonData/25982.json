[{"count": 0, "tags": [], "bug_id": 25982, "attachment_id": null, "is_private": false, "id": 50241, "time": "2004-01-08T12:43:49Z", "creator": "dawid.weiss@cs.put.poznan.pl", "creation_time": "2004-01-08T12:43:49Z", "text": "An empty include task inside a javac causes ANT to throw NullPointerException \nwhen attempting to create a StringBuffer. A sample script that causes this bug \nto show up (tested in ant 1.5.3 and 1.6.0):\n\n<project name=\"cw1\" basedir=\".\" default=\"compile\">\n\n  <target name=\"compile\">\n     <mkdir dir=\"src\" />\n     <mkdir dir=\"tmp/build\" />\n     <javac srcdir=\"src\" destdir=\"tmp/build\">\n            <include/>\n     </javac>\n  </target>\n  \n</project>\n\nStack trace:\n\njava.lang.NullPointerException\n        at java.lang.StringBuffer.<init>(StringBuffer.java:129)\n        at org.apache.tools.ant.types.PatternSet$NameEntry.toString(PatternSet.j\nava:126)\n        at java.lang.String.valueOf(String.java:2173)\n        at java.util.AbstractCollection.toString(AbstractCollection.java:451)\n        at java.util.Vector.toString(Vector.java:955)\n        at java.lang.String.valueOf(String.java:2173)\n        at java.lang.StringBuffer.append(StringBuffer.java:369)\n        at org.apache.tools.ant.types.PatternSet.toString(PatternSet.java:476)\n        at java.lang.String.valueOf(String.java:2173)\n        at java.lang.StringBuffer.append(StringBuffer.java:369)\n        at org.apache.tools.ant.types.AbstractFileSet.setupDirectoryScanner(Abst\nractFileSet.java:419)\n        at org.apache.tools.ant.types.AbstractFileSet.getDirectoryScanner(Abstra\nctFileSet.java:395)\n        at org.apache.tools.ant.taskdefs.MatchingTask.getDirectoryScanner(Matchi\nngTask.java:231)\n        at org.apache.tools.ant.taskdefs.Javac.execute(Javac.java:793)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:306)\n        at org.apache.tools.ant.Task.perform(Task.java:401)\n        at org.apache.tools.ant.Target.execute(Target.java:338)\n        at org.apache.tools.ant.Target.performTasks(Target.java:365)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1237)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1094)\n        at org.apache.tools.ant.Main.runBuild(Main.java:669)\n        at org.apache.tools.ant.Main.startAnt(Main.java:220)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:215)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:90)\n\n\nThe bug is probably trivial, but still a nice thing to know your program is \nfool-proof ;)\n\nCheers,\nDawid"}, {"count": 1, "tags": [], "bug_id": 25982, "attachment_id": null, "id": 50250, "time": "2004-01-08T13:39:45Z", "creator": "peter.reilly@corvil.com", "creation_time": "2004-01-08T13:39:45Z", "is_private": false, "text": "Fixed now in HEAD, thanks for the report.\n"}, {"count": 2, "tags": [], "bug_id": 25982, "text": "I'm not sure to silently ignore the <include/> is the best approach. Shouldn't \nthe build barf instead, complaining about the incomplete definition of the \n<include>!?!?!? Is this possible? --DD", "id": 50257, "time": "2004-01-08T14:44:00Z", "creator": "ddevienne@lgc.com", "creation_time": "2004-01-08T14:44:00Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "j_a_fernandez@yahoo.com", "is_private": false, "text": "I agree with Dominique on this. name is a mandatory attribute of include,\nhence one should throw a BuildException in such a case. No?\n", "id": 50266, "time": "2004-01-08T16:52:11Z", "bug_id": 25982, "creation_time": "2004-01-08T16:52:11Z", "attachment_id": null}, {"count": 4, "tags": [], "text": "This is true, but it is a question of finding where in the\ncode this should be tested.\n", "is_private": false, "id": 50267, "creation_time": "2004-01-08T17:06:52Z", "time": "2004-01-08T17:06:52Z", "creator": "peter.reilly@corvil.com", "bug_id": 25982, "attachment_id": null}, {"count": 5, "tags": [], "creator": "j_a_fernandez@yahoo.com", "attachment_id": null, "id": 50268, "time": "2004-01-08T17:14:27Z", "bug_id": 25982, "creation_time": "2004-01-08T17:14:27Z", "is_private": false, "text": "It should be checked in whatever is the equivalent of the execute() of tasks \nfor PatternSets or whatever. Looking at the code you modfied, instead I guess \nyou should thow a BuildException if name is null.\n\n  if (name == null) {\n    throw new BuildException(\"Mandatory attribute 'name' is missing\");\n  }\n  ....\n\nnot sure if this is the best location to do it. Haven't look at all the code.\n"}, {"count": 6, "tags": [], "bug_id": 25982, "text": "I committed the buildexception fix, it is better to\nthrow an exception here than to silently ignore the problem.", "id": 52855, "time": "2004-02-24T14:08:52Z", "creator": "peter.reilly@corvil.com", "creation_time": "2004-02-24T14:08:52Z", "is_private": false, "attachment_id": null}]