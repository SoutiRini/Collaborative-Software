[{"count": 0, "tags": [], "bug_id": 56675, "attachment_id": null, "id": 176070, "creation_time": "2014-06-26T21:12:17Z", "time": "2014-06-26T21:12:17Z", "creator": "skia.heliou@gmail.com", "text": "I've attempted to open files created in Excel 2013 as an XSSFWorkbook via an OPCPackage with PackageAccess.READ, but it throws a POIXMLException with the following stack (I have added my code after):\n\nException in thread \"main\" org.apache.poi.POIXMLException: org.apache.poi.openxml4j.exceptions.InvalidOperationException: Operation not allowed, document open in read only mode!\n  at org.apache.poi.POIXMLDocumentPart.createRelationship(POIXMLDocumentPart.java:393)\n  at org.apache.poi.POIXMLDocumentPart.createRelationship(POIXMLDocumentPart.java:353)\n  at org.apache.poi.xssf.usermodel.XSSFWorkbook.onDocumentRead(XSSFWorkbook.java:288)\n  at org.apache.poi.POIXMLDocument.load(POIXMLDocument.java:159)\n  at org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:200)\n  at workbook.io.WorkbookReaderTest.<init>(WorkbookReaderTest.java:19)\n  at workbook.io.WorkbookReaderTest.main(WorkbookReaderTest.java:25)\nCaused by: org.apache.poi.openxml4j.exceptions.InvalidOperationException: Operation not allowed, document open in read only mode!\n  at org.apache.poi.openxml4j.opc.OPCPackage.throwExceptionIfReadOnly(OPCPackage.java:507)\n  at org.apache.poi.openxml4j.opc.OPCPackage.createPart(OPCPackage.java:765)\n  at org.apache.poi.openxml4j.opc.OPCPackage.createPart(OPCPackage.java:741)\n  at org.apache.poi.POIXMLDocumentPart.createRelationship(POIXMLDocumentPart.java:373)\n  ... 6 more\n\n\nHere's my code:\n\n\npublic final class WorkbookReaderTest {\n\n  public WorkbookReaderTest(File inputFile) throws InvalidFormatException, IOException {\n    OPCPackage pkg = OPCPackage.open(inputFile, PackageAccess.READ);\n    XSSFWorkbook wb = new XSSFWorkbook(pkg);\n  }\n\n  public static void main(String[] args) throws InvalidFormatException, IOException {\n    new WorkbookReaderTest(new File(\"C:\\\\path\\\\blank workbook.xlsx\"));\n  }\n}\n\nIt seems that XLSX files created in Excel 2013 are the problem. XLSX files created in 2010 and then modified in 2013 seem to pose no problem, provided that at least 2 sheets remain from the original; when cut down to only 1 sheet from the original, I get the same exception, even if the 1 original sheet has new accompanying sheets in the same workbook.", "is_private": false}, {"count": 1, "tags": [], "text": "Any chance you could upload a sample file that shows the problem, along with a short junit unit test which triggers the exception with it?", "attachment_id": null, "bug_id": 56675, "id": 176071, "time": "2014-06-26T22:18:48Z", "creator": "apache@gagravarr.org", "creation_time": "2014-06-26T22:18:48Z", "is_private": false}, {"count": 2, "tags": [], "creator": "skia.heliou@gmail.com", "attachment_id": 31757, "id": 176079, "time": "2014-06-27T18:00:09Z", "bug_id": 56675, "creation_time": "2014-06-27T18:00:09Z", "is_private": false, "text": "Created attachment 31757\nA blank workbook created in Excel 2013\n\nThis is one of the workbooks I've used to test the issue.\n\nUnfortunately, I have no skill with JUnit."}, {"count": 3, "tags": [], "bug_id": 56675, "attachment_id": null, "id": 180482, "creation_time": "2015-01-22T15:02:34Z", "time": "2015-01-22T15:02:34Z", "creator": "dominik.stadler@gmx.at", "text": "Should be fixed in trunk via bug 57482, checked in with r1653825.\n\n*** This bug has been marked as a duplicate of bug 57482 ***", "is_private": false}]