[{"count": 0, "tags": [], "text": "If I use Oracle OCI driver, the sql will fail when it runs the second time. if \nI changed to use thin driver, it will be ok.\n\nThe script to test it is:\n\n<project name=\"dts-run\" default=\"test\" basedir=\".\">\n<!--\n\t<property name=\"project.dburl\" \nvalue=\"jdbc:oracle:thin:@oracle.point2.com.:1521:migrate\"/>\n-->\n\t<property name=\"project.dburl\" \nvalue=\"jdbc:oracle:oci8:@MIGRATE.POINT2.COM\"/>\n<!--\nIf this url is used, the following error will happen at the second sql task.\njava.lang.UnsatisfiedLinkError: Native Library C:\\oracle\\ora81\\bin\\ocijdbc8.dll \nalready loaded in another classloader\n        at java.lang.ClassLoader.loadLibrary0(ClassLoader.java:1346)\n        at java.lang.ClassLoader.loadLibrary(ClassLoader.java:1306)\n        at java.lang.Runtime.loadLibrary0(Runtime.java:749)\n        at java.lang.System.loadLibrary(System.java:820)\n        at oracle.jdbc.oci8.OCIDBAccess.logon(OCIDBAccess.java:228)\n        at oracle.jdbc.driver.OracleConnection.<init>(OracleConnection.java:249)\n        at oracle.jdbc.driver.OracleDriver.getConnectionInstance\n(OracleDriver.java:365)\n        at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:260)\n        at org.apache.tools.ant.taskdefs.SQLExec.execute(SQLExec.java:419)\n        at org.apache.tools.ant.Task.perform(Task.java:217)\n        at org.apache.tools.ant.Target.execute(Target.java:184)\n        at org.apache.tools.ant.Target.performTasks(Target.java:202)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:601)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:560)\n        at org.apache.tools.ant.Main.runBuild(Main.java:454)\n        at org.apache.tools.ant.Main.start(Main.java:153)\n        at org.apache.tools.ant.Main.main(Main.java:176)\n-->\n\t<property name=\"project.driver\" \nvalue=\"oracle.jdbc.driver.OracleDriver\"/>\n\t<property name=\"project.dbusername\" value=\"sreilly\"/>\n\t<property name=\"project.dbpassword\" value=\"sreilly\"/>\n\t<property name=\"project.dbclasspath\" \nvalue=\"C:\\catused\\phoenix\\deploy\\lib\\weblogic-java\\classes12.zip\"/>\n\t<target name=\"test\">\n\t\t<sql classpath=\"${project.dbclasspath}\" \n\t\t\tdriver=\"${project.driver}\" \n\t\t\turl=\"${project.dburl}\" \n\t\t\tuserid=\"${project.dbusername}\" \n\t\t\tpassword=\"${project.dbpassword}\" \n\t\t\tprint=\"yes\" \n\t\t\tshowheaders=\"false\">\n                select 2 from dual;\n\t\t</sql>\n\n\t\t<sql classpath=\"${project.dbclasspath}\" \n\t\t\tdriver=\"${project.driver}\" \n\t\t\turl=\"${project.dburl}\" \n\t\t\tuserid=\"${project.dbusername}\" \n\t\t\tpassword=\"${project.dbpassword}\" \n\t\t\tprint=\"yes\" \n\t\t\tshowheaders=\"false\">\n                select * from tab;\n\t\t</sql>\n\t</target>\n\n</project>", "is_private": false, "id": 18253, "creator": "qren@point2.com", "time": "2002-06-20T21:42:04Z", "bug_id": 10090, "creation_time": "2002-06-20T21:42:04Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 10090, "attachment_id": null, "text": "Does the problem go away if you put your driver into ANT_HOME/lib and don't use\nnested classpath elements to locate it?", "id": 18456, "time": "2002-06-24T10:26:13Z", "creator": "bodewig@apache.org", "creation_time": "2002-06-24T10:26:13Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 10090, "attachment_id": null, "id": 18458, "time": "2002-06-24T11:23:05Z", "creator": "sbailliez@apache.org", "creation_time": "2002-06-24T11:23:05Z", "is_private": false, "text": "Could you please run ant in verbose mode (ant -verbose) and post the output of \nthe sql task. It should output where it picks the driver from (cached, \nuncached, or system), ie:\n\nLoading xxxx using AntClassLoader with classpath yyyyy\nLoading xxxx using a cached AntClassLoader.\nLoading xxxx using system loader."}, {"count": 3, "tags": [], "bug_id": 10090, "text": "Sorry, my bad. I have several ant version in my computer. I was using ant 1.4, \nBut now when I make sure the version is 1.5, it works(1.4 does not work). Even \nI don't need to copy the driver into ANT_HOME/lib.  the output says \"Loading \nxxxx using a cached AntClassLoader\" at the second time.\n\n", "id": 18469, "attachment_id": null, "creator": "qren@point2.com", "creation_time": "2002-06-24T14:44:32Z", "time": "2002-06-24T14:44:32Z", "is_private": false}]