[{"count": 0, "tags": [], "creator": "jpihlaja@cc.helsinki.fi", "attachment_id": null, "text": "Seeking relative to the end of a file, when the file is opened using\nAPR_XTHREAD, doesn't as expected.  The check for seeking too far back is wrong,\nand it would seek in the wrong direction from the end-of-file anyway.  Symptoms\ninclude: opening a file in append mode w/APR_XTHREAD, and then writing to it,\nresults in data being written to the beginning of the file rather than\nappending.  Possible patch against 1.2.2 below:\n\ndiff -rubN apr-1.2.2.orig/file_io/win32/seek.c apr-1.2.2/file_io/win32/seek.c\n--- apr-1.2.2.orig/file_io/win32/seek.c 2005-09-09 00:47:13.000000000 +0300\n+++ apr-1.2.2/file_io/win32/seek.c      2006-01-30 02:30:19.000000000 +0200\n@@ -105,8 +105,8 @@\n         \n             case APR_END:\n                 rc = apr_file_info_get(&finfo, APR_FINFO_SIZE, thefile);\n-                if (rc == APR_SUCCESS && finfo.size - *offset < 0)\n-                    thefile->filePtr = finfo.size - *offset;\n+                if (rc == APR_SUCCESS && finfo.size + *offset >= 0)\n+                    thefile->filePtr = finfo.size + *offset;\n                 break;\n \n             default:", "id": 85179, "time": "2006-01-30T01:34:40Z", "bug_id": 38438, "creation_time": "2006-01-30T01:34:40Z", "is_private": false}, {"count": 1, "tags": [], "creator": "rooneg@electricjellyfish.net", "attachment_id": null, "id": 85186, "time": "2006-01-30T07:50:43Z", "bug_id": 38438, "creation_time": "2006-01-30T07:50:43Z", "is_private": false, "text": "Fix committed (with a test I added) in r373453.  Will merge into upcoming\nrelease once I confirm it passes on other platforms.\n\nThanks for the patch!"}]