[{"count": 0, "tags": [], "bug_id": 44700, "attachment_id": null, "is_private": false, "id": 115066, "time": "2008-03-28T02:06:53Z", "creator": "jethro.bakker@ordina.nl", "creation_time": "2008-03-28T02:06:53Z", "text": "Hello,\n\nCurrently I am facing the following problem with Log4J (v1.2.8 but also in v1.2.15). We use the DailyRollingFileAppender. Most of the log files are rolled once a day, but a few once an hour. The rolling proces seems ok, new files are created and the data in the files looks good. \n\nThe problem is that the applicationserver (WAS 6) holds a lock on the rolled files. We can not delete those files from the filesystem.\nWith the unix command fuser we can see which process is holding which log file. For example:\n\ncommon.log:  1302780 \ncommon.log.2008-03-25-11: \ncommon.log.2008-03-26-13: \ncommon.log.2008-03-26-19: \ncommon.log.2008-03-26-20: \ncommon.log.2008-03-26-21:  1302780 \n\nThe latest log file: common.log.2008-03-26-21 should not be locked! We have a workaround by using the touch command on the log4j.xml. The log configuration is (re)initialized and releases all the locks.\n\nWhat can we do about this problem?"}, {"count": 1, "tags": [], "creator": "thorbjoern@gmail.com", "text": "Can you please provide the log4j.xml file as an attachment for the issue reported?  \n\nAlso please describe the applications running in the WAS6 server.", "id": 118246, "time": "2008-07-03T12:56:34Z", "bug_id": 44700, "creation_time": "2008-07-03T12:56:34Z", "is_private": false, "attachment_id": null}, {"count": 2, "attachment_id": null, "bug_id": 44700, "is_private": false, "id": 141982, "time": "2010-11-24T17:40:29Z", "creator": "jtuchscherer@gmail.com", "creation_time": "2010-11-24T17:40:29Z", "tags": [], "text": "We are experiencing the same problem with log4j 1.2.16 running on a jetty web app on a Redhat machine.\n\nThe rollover logic appears to work just fine, but the java process holds a reference to the rotated files, so that we cannot delete them.\n\nPlease let me know if you need more info.\n\nHere is an excerpt form our log4j.xml\n[...]\n    <appender name=\"slm-debug-async\" class=\"org.apache.log4j.AsyncAppender\">\n        <appender-ref ref=\"slm-debug\"/>\n    </appender>\n    <appender name=\"slm-debug\" class=\"org.apache.log4j.DailyRollingFileAppender\">\n        <errorHandler class=\"org.apache.log4j.helpers.OnlyOnceErrorHandler\"/>\n\n        <!-- Rollover at midnight each day -->\n        <param name=\"DatePattern\" value=\"'.'yyyy-MM-dd\"/>\n\n        <param name=\"File\" value=\"@log.dir@/server.log\"/>\n        <param name=\"Append\" value=\"true\"/>\n\n    </appender>\n[...]\n    <root>\n        <appender-ref ref=\"slm-debug-async\"/>\n    </root>\n[...]"}]