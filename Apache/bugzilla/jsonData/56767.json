[{"count": 0, "tags": [], "bug_id": 56767, "is_private": false, "text": "Created attachment 31844\nFix for ap_update_child_status segfault\n\nI was debugging a weird segmentation fault with mod_wsgi and tracked it down to:\n\n\n       static int update_child_status_internal(int child_num,\n                                        int thread_num,\n                                        int status,\n                                        conn_rec *c,\n                                        request_rec *r)\n\n\nIn server/scoreboard.c (being called by ap_update_child_status)\n\nThe problem is that child_num is a negative number and that function is using it to index an array:\n\n    ws = &ap_scoreboard_image->servers[child_num][thread_num];\n\nSo it segfaults there.\n\nThe one setting child_num to -1 is mod_wsgi but checking other related functions in scoreboard.c, I belive we should be checking if child_num > 0 there. I also checked when the code was refactored and it seems  \"ap_update_child_status_from_indexes\" was originally used (which does the check) instead of update_child_status_internal so I believe it was left behind by mistake when refactoring the code.\n\n\nI'm attaching a fix to that, as well as for ap_update_child_status_from_conn, which do not check child_num either.", "id": 176641, "time": "2014-07-24T10:01:29Z", "creator": "ryotakatsuki@gmail.com", "creation_time": "2014-07-24T10:01:29Z", "attachment_id": 31844}, {"count": 1, "tags": [], "bug_id": 56767, "attachment_id": null, "is_private": false, "id": 179047, "time": "2014-11-11T12:07:33Z", "creator": "jkaluza@redhat.com", "creation_time": "2014-11-11T12:07:33Z", "text": "Committed in trunk in r1638073."}, {"count": 2, "tags": [], "bug_id": 56767, "attachment_id": null, "text": "Proposed in 2.4.x", "id": 179181, "time": "2014-11-19T07:13:10Z", "creator": "jkaluza@redhat.com", "creation_time": "2014-11-19T07:13:10Z", "is_private": false}, {"count": 3, "text": "This has been released in 2.4.12 (r1642851)", "bug_id": 56767, "attachment_id": null, "id": 182250, "time": "2015-04-04T21:48:23Z", "creator": "christophe.jaillet@wanadoo.fr", "creation_time": "2015-04-04T21:48:23Z", "tags": [], "is_private": false}]