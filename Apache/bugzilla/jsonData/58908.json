[{"count": 0, "tags": [], "bug_id": 58908, "attachment_id": null, "id": 187892, "time": "2016-01-22T07:58:14Z", "creator": "robert.flaherty@oracle.com", "creation_time": "2016-01-22T07:58:14Z", "is_private": false, "text": "This property is not yet available to tasks outside of a target.  It is currently set in Project.java:\n\n\n    public void executeTargets(final Vector<String> names) throws BuildException {\n        setUserProperty(MagicNames.PROJECT_INVOKED_TARGETS,\n                        CollectionUtils.flattenToString(names));\n        getExecutor().executeTargets(this, names.toArray(new String[names.size()]));\n    }\n\n\nand should be easily pushed out to the caller, Main.java:\n\n\n    setProperties(project);\n    ...\n    ProjectHelper.configureProject(project, buildFile);\n    ...\n    project.executeTargets(targets);\n\n\nahead of the configureProject() call which eventually executes the top-level tasks.  I think it can just be appended to the setProperties() method, where it already does:\n\n\n    project.setUserProperty(MagicNames.ANT_FILE,\n                            buildFile.getAbsolutePath());\n    project.setUserProperty(MagicNames.ANT_FILE_TYPE,\n                            MagicNames.ANT_FILE_TYPE_FILE);\n\nlike:\n\n\n    project.setUserProperty(MagicNames.PROJECT_INVOKED_TARGETS,\n                            CollectionUtils.flattenToString(targets));\n\nTried:\n\n<project name=\"test\" default=\"foobar\">\n\t<echo message=\"${ant.project.default-target}\" />\n\t<echo message=\"${ant.project.invoked-targets}\" />\n\t<echo message=\"${ant.file}\" />\n\t<echo message=\"${ant.file.type}\" />\n\t<target name=\"foobar\">\n\t</target>\n</project>"}, {"attachment_id": null, "tags": [], "bug_id": 58908, "is_private": false, "count": 1, "id": 187923, "time": "2016-01-23T14:14:37Z", "creator": "bodewig@apache.org", "creation_time": "2016-01-23T14:14:37Z", "text": "almost.\n\nThere is the special case of having no target specified at the command line at all - in this case Main adds the project's default target to the list which isn't known before configureProject has been invoked."}, {"count": 2, "tags": [], "bug_id": 58908, "attachment_id": null, "is_private": false, "id": 187924, "time": "2016-01-23T17:18:47Z", "creator": "robert.flaherty@oracle.com", "creation_time": "2016-01-23T17:18:47Z", "text": "I saw that code in Main.java which could have been hoisted up, but since the invocation on the command-line was nothing, I'd think that the property would be empty since \"ant.project.default-target\" is available to the user."}, {"attachment_id": null, "tags": [], "bug_id": 58908, "is_private": false, "count": 3, "id": 187926, "time": "2016-01-23T17:46:05Z", "creator": "bodewig@apache.org", "creation_time": "2016-01-23T17:46:05Z", "text": "Well, that's the contract of the property.\n\nOf course there is no such contract for top level tasks right now, so we could set the property and overwrite it later before invoking the regular targets."}, {"attachment_id": null, "tags": [], "bug_id": 58908, "is_private": false, "count": 4, "id": 188263, "time": "2016-02-07T14:43:59Z", "creator": "bodewig@apache.org", "creation_time": "2016-02-07T14:43:59Z", "text": "implemented with git commit 494e865"}]