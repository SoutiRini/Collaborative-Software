[{"count": 0, "tags": [], "bug_id": 37602, "attachment_id": null, "id": 82746, "time": "2005-11-23T10:25:58Z", "creator": "oliver.schalch@wyona.com", "creation_time": "2005-11-23T10:25:58Z", "is_private": false, "text": "If you try to Edit (with BXE, Kupu, Oneform) after you have select Submit from\nWorkflow Menu you get redirectet to the Login form.\n\n\nReproduce:\n\n1) Login to default publication on a clean lenya instance\n2) In Authoring Area on any document click Workflow -> Submit\n3) Click Edit -> Edit with BXE \u00a6 Kupu \u00a6 Oneform\n4) You will see the Login screen and have to login again, try login (lenya or\nalice), you will be back in Authoring."}, {"count": 1, "tags": [], "creator": "nettings@apache.org", "is_private": false, "text": "reproduced with lenya-1.4-HEAD from 2005-12-05.", "id": 83319, "time": "2005-12-06T16:55:14Z", "bug_id": 37602, "creation_time": "2005-12-06T16:55:14Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 37602, "attachment_id": null, "id": 83427, "time": "2005-12-08T16:41:05Z", "creator": "renaud.richardet@wyona.com", "creation_time": "2005-12-08T16:41:05Z", "is_private": false, "text": "reproduced with lenya-1.4-HEAD from 2005-12-05.\n\nThen tried to log as Alice to review the document. I expected that I would be\nable to edit the doc with BXE. I got kicked out as well."}, {"count": 3, "tags": [], "bug_id": 37602, "attachment_id": null, "id": 83481, "time": "2005-12-09T17:29:17Z", "creator": "felix.roethenbacher@wyona.com", "creation_time": "2005-12-09T17:29:17Z", "is_private": false, "text": "*** Bug 37534 has been marked as a duplicate of this bug. ***"}, {"count": 4, "tags": [], "bug_id": 37602, "attachment_id": null, "id": 83482, "time": "2005-12-09T17:32:33Z", "creator": "felix.roethenbacher@wyona.com", "creation_time": "2005-12-09T17:32:33Z", "is_private": false, "text": "Attaching a patch that disables workflow authorizer. Thanks Andreas for the hint."}, {"count": 5, "tags": [], "bug_id": 37602, "attachment_id": 17189, "id": 83483, "time": "2005-12-09T17:33:40Z", "creator": "felix.roethenbacher@wyona.com", "creation_time": "2005-12-09T17:33:40Z", "is_private": false, "text": "Created attachment 17189\nPatches src/webapp/lenya/pubs/default/config/ac/ac.xconf\n\nDisables workflow authorizer."}, {"count": 6, "tags": [], "bug_id": 37602, "is_private": false, "id": 83596, "attachment_id": null, "creator": "edith@apache.org", "creation_time": "2005-12-13T12:09:08Z", "time": "2005-12-13T12:09:08Z", "text": "The redirect to the login screen is solved with the patch, but it still remain a\nproblem: In the default pub, after a document has been submitted, the edit menus\nshould be disabled (workflow configuration). For the forms editor, the workflow\ninvocation test is performed in the usecase's checkPreconditions, but for bxe\nand kupu it is never made. "}, {"count": 7, "text": "weird bug, change the order of the menu items and the problem goes away:\n\nIndex: C:/src/lenya-1.4.x/src/modules/xhtml/config/menu.xsp\n===================================================================\n--- C:/src/lenya-1.4.x/src/modules/xhtml/config/menu.xsp\t(revision 356474)\n+++ C:/src/lenya-1.4.x/src/modules/xhtml/config/menu.xsp\t(working copy)\n@@ -47,10 +47,10 @@\n             String doctype = <input:get-attribute module=\"page-envelope\"\nas=\"string\" name=\"document-type\"/>;\n             if (\"xhtml\".equals(doctype)) {\n                 <block info=\"false\">\n+                  <item wf:event=\"edit\" uc:usecase=\"edit.forms\"><xsp:attribute\nname=\"href\"><xsp:expr>\"?form=\" +\ndoctype</xsp:expr></xsp:attribute><i18n:text>With Forms</i18n:text></item>\n+                  <item wf:event=\"edit\" uc:usecase=\"edit.oneform\"\nhref=\"?\"><i18n:text>With one Form</i18n:text></item>\n                   <item wf:event=\"edit\" uc:usecase=\"kupu\" uc:step=\"open\"\nhref=\"?\"><i18n:text>With Kupu</i18n:text></item>\n                   <item wf:event=\"edit\" uc:usecase=\"edit.bxe\"\nhref=\"?\"><i18n:text>With BXE</i18n:text></item>\n-                  <item wf:event=\"edit\" uc:usecase=\"edit.forms\"><xsp:attribute\nname=\"href\"><xsp:expr>\"?form=\" +\ndoctype</xsp:expr></xsp:attribute><i18n:text>With Forms</i18n:text></item>\n-                  <item wf:event=\"edit\" uc:usecase=\"edit.oneform\"\nhref=\"?\"><i18n:text>With one Form</i18n:text></item>\n                 </block>\n             }\n           </xsp:logic>", "creator": "dhc4z@virginia.edu", "is_private": false, "id": 83601, "time": "2005-12-13T17:33:47Z", "bug_id": 37602, "creation_time": "2005-12-13T17:33:47Z", "tags": [], "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 37602, "is_private": false, "count": 8, "id": 83634, "time": "2005-12-14T10:14:40Z", "creator": "edith@apache.org", "creation_time": "2005-12-14T10:14:40Z", "text": "Fixed. The problem is really caused by the omission of the workflow invocation\ntest and also the wrong registration of the kupu's usecase. "}]