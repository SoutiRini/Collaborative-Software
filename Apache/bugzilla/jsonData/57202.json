[{"count": 0, "tags": [], "text": "We are trying to upgrade our POI implementation from 3.9 version to 3.10.1, when doing so we encountered the below problem. \n\nExcel fraction value getting converted incorrectly in csv file. Sample input \n\nCell format in Excel : Fraction - Up to one digit (1/4)\nCell value in Excel : 44022813230178\nDisplayed value in Excel : 44022813230178\n\nIn Apache POI 3.9 version converted csv file for the about input file is\n\nPOI 3.9 csv file value : 44022813230178\n\nWhere as in POI 3.10-FINAL and 3.10.1 versions the output is incorrect\n\nPOI 3.10.1 and 3.10-FINAL csv value : 2147483647\n\nJava code used \nformatter = new DataFormatter(true);\ncsvLine.add(formatter.formatCellValue(cell));\n\nWhen i debug into the code of org.apache.poi.ss.usermodel.FractionFormat class, in the method format(Number num) I see a possible bug. The double value is getting converted into 'int'. \n\nIn the line number 123, sb.append(Integer.toString((int)wholePart));  there are multiple palaces where its converted to 'int'.", "is_private": false, "id": 179056, "creation_time": "2014-11-12T11:25:09Z", "time": "2014-11-12T11:25:09Z", "creator": "Kushal.j1987@gmail.com", "bug_id": 57202, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 57202, "attachment_id": null, "is_private": false, "id": 179057, "time": "2014-11-12T11:42:29Z", "creator": "apache@gagravarr.org", "creation_time": "2014-11-12T11:42:29Z", "text": "Can you retry with 3.11 beta 3?\n\n(Should be on all popular mirrors + maven central within the next 12 hours)\n\nAlso, it'd be helpful to know what POI thinks the format string is that applies to the problematic cell"}, {"count": 2, "tags": [], "creator": "Kushal.j1987@gmail.com", "is_private": false, "text": "I even tried with 3.11-beta2 (as that's the latest maven available), still getting the same result as 3.10-FINAL. \n\nThe format string POI applies to that cell is : # ?/?\n\nWill wait for 3.11-beta3 version and update the same.", "id": 179058, "time": "2014-11-12T12:06:59Z", "bug_id": 57202, "creation_time": "2014-11-12T12:06:59Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "tallison@mitre.org", "text": "Thank you for submitting this issue.  Y, we should switch to long, and we may need to convert the fraction calculation to BigDecimal, iirc.  I should have a patch by the end of the week.", "id": 179070, "time": "2014-11-12T16:16:43Z", "bug_id": 57202, "creation_time": "2014-11-12T16:16:43Z", "is_private": false, "attachment_id": null}, {"text": "Please state if this is still a problem on 3.14 or latest trunk.", "tags": [], "creator": "dominik.stadler@gmx.at", "is_private": false, "count": 4, "id": 189732, "time": "2016-03-26T12:54:13Z", "bug_id": 57202, "creation_time": "2016-03-26T12:54:13Z", "attachment_id": null}, {"text": "No update for several months, thus I am closing this as WORKSFORME for now, please reopen this bug if there is still a problem with a current version of POI.", "tags": [], "creator": "dominik.stadler@gmx.at", "is_private": false, "count": 5, "id": 193085, "time": "2016-08-13T20:47:13Z", "bug_id": 57202, "creation_time": "2016-08-13T20:47:13Z", "attachment_id": null}]