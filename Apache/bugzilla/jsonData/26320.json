[{"count": 0, "tags": [], "bug_id": 26320, "text": "A friend of mine (Jailton Lopes) reported a wierd behaviour in the following code:\n\nJSP:\n<c:out value = \"${requestScope.dummyValue}\">\nABCDEFGHIJLMN<br>\n</c:out>\n<c:out value = \"${requestScope.otherDummyValue}\"/>\n \nOutput:\nABCDEFGHIJLMN\nABCDEFGHIJLMN\n\n\nThe problem is that the second call to <c:out> is printing the default value of\n the previous call (which was set in the tag's body).\n \nAfter some research, I realized that's caused because Tomcat is pooling the \ntag handlers and OutSupport returns EVAL_BODY_BUFFERED. One way to solve the\nproblem is setting Tomcat to not pool the handlers, but that's not an elegant\nsolution. The ideal solution would be delegate the task of cleaning up its state\nto the tag handlers. As the tag handler API doesn't have a init() or similar\nmethod, we can do that on doStartTag(), as shown below:\n\nOriginal code:\n\npublic int doStartTag() throws JspException {\n    needBody = false;                       // reset state related to 'default'\n\nNew code:\n\npublic int doStartTag() throws JspException {\n    needBody = false;                       // reset state related to 'default'\n    this.bodyContent = null;                // clean-up body (just in case\ncontainer is pooling tag handlers)\n\n\n\nI'm doing these changes now, so we can fix this issue on 1.0.5 and 1.1.0.", "id": 50905, "time": "2004-01-21T19:00:00Z", "creator": "nagoya@felipeal.net", "creation_time": "2004-01-21T19:00:00Z", "is_private": false, "attachment_id": null}, {"count": 1, "attachment_id": null, "bug_id": 26320, "text": "Committed changes to CVS - waiting for TCK tests to mark bug as fixed.", "id": 50907, "time": "2004-01-21T19:25:27Z", "creator": "nagoya@felipeal.net", "creation_time": "2004-01-21T19:25:27Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 26320, "text": "Closed, as TCK ran fine.", "id": 50928, "time": "2004-01-22T01:29:24Z", "creator": "nagoya@felipeal.net", "creation_time": "2004-01-22T01:29:24Z", "is_private": false, "attachment_id": null}]