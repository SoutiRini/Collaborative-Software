[{"count": 0, "tags": [], "creator": "mathias.rupprecht@fja.com", "attachment_id": null, "id": 1837, "time": "2001-04-11T02:15:55Z", "bug_id": 1307, "creation_time": "2001-04-11T02:15:55Z", "is_private": false, "text": "I'm using Log4J 1.0.4, Windows NT 4.0 SP 6, VisualAge 3.5 Patch 2.\n\nLocationInfo.getClassName() run in VisualAge environment includes the return \nvalue of the caller method. (Veryfied with VA 3.02 and VA 3.5 Patch 2)\nExample: it is \"void test.test.B\" instead of \"test.test.B\".\n\nThis is because a stack trace in VisualAge looks like\n\njava.lang.RuntimeException\n\tjava.lang.Throwable()\n\tjava.lang.Exception()\n\tjava.lang.RuntimeException()\n\tvoid test.test.B.print()\n\tvoid test.test.A.printIndirect()\n\tvoid test.test.Run.main(java.lang.String [])\n\n\nI patched the method: (no diff, sorry)\n======================================================\n/**\n       Return the fully qualified class name of the caller making the\n       logging request.\n    */\n    public\n    String getClassName() {\n      if(fullInfo == null) return NA;\n      if(className == null) {\n\t// Starting the search from '(' is safer because there is\n\t// potentially a dot between the parentheses.\n\tint iend = fullInfo.lastIndexOf('(');\n\tint ibegin = 0;\n\tif(iend == -1) \n\t  className = NA;\n\telse {\n\t  iend = fullInfo.lastIndexOf('.', iend);\n\t  if (inVisualAge)\n\t  \t ibegin = fullInfo.lastIndexOf(' ', iend)+1;\n\t  \t // +1 to skip the ' '\n\t  if(iend == -1 || ibegin == -1) \n\t    className = NA;\n\t  else\n\t    className = this.fullInfo.substring(ibegin, iend);\n\t}\n      }\n      return className;\n    }\n======================================================\nI did no tests outside VisualAge, but it should do nothing with \ninVisualAge==false."}, {"count": 1, "tags": [], "bug_id": 1307, "attachment_id": null, "text": "Thanks. ", "id": 1992, "time": "2001-04-22T06:58:15Z", "creator": "bugzilla@apache.org", "creation_time": "2001-04-22T06:58:15Z", "is_private": false}]