[{"count": 0, "tags": [], "bug_id": 42541, "is_private": false, "text": "POI Version . poi-3.0-rc4-20070503.jar\nCreate a simple excel file . input a formula in C1 as =A1+B1\nCopy the same formula into the corresponding cells for the C column by dragging \nthe C1 Cell. Excel will generate the formulas automatically for the cells.\nSave the workbook and try opening it. \nInputStream istream = new FileInputStream(filename);\nPOIFSFileSystem fs = new POIFSFileSystem(new BufferedInputStream(istream));\nHSSFWorkbook wb= new HSSFWorkbook(fs,true);\nFileOutputStream fileOut = new FileOutputStream(\"c:\\\\test.xls\");\nwb.write(fileOut);\nfileOut.close();\nistream.close();\n\nAll the cells where the formula is copied will show #value instead of the value.\nThis happens only in the current release(poi-3.0-rc4-20070503).  \nCould somebody please fix this or suggest some solution. This happens only for \nthose formula cells that have been copied.", "id": 103776, "time": "2007-05-29T09:28:22Z", "creator": "sandeep30469@hotmail.com", "creation_time": "2007-05-29T09:28:22Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "sandeep30469@hotmail.com", "attachment_id": 20285, "is_private": false, "id": 103777, "time": "2007-05-29T09:29:46Z", "bug_id": 42541, "creation_time": "2007-05-29T09:29:46Z", "text": "Created attachment 20285\nSample excel file to test"}, {"count": 2, "tags": [], "bug_id": 42541, "is_private": false, "id": 112931, "creation_time": "2008-01-16T16:13:42Z", "time": "2008-01-16T16:13:42Z", "creator": "leprinco@yahoo.fr", "text": "Can't reproduce with latest version of POI and Excel 2000.\nI used your attachment and created a new one with your disposition.", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 42541, "text": "Retested OK in 3.1-beta1.\n\nThis may have had something to do with shared formulas.\n", "id": 116404, "time": "2008-05-08T23:22:13Z", "creator": "josh@apache.org", "creation_time": "2008-05-08T23:22:13Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "vkt3142@njit.edu", "text": "POI Version: poi-3.1-beta1-20080428.jar\n-----------------------------------------------------------------\nSample Excel File: template_183.xls (Attached)\n-----------------------------------------------------------------\nVariable names within the excel file (template_183.xls):\n-----------------------------------------------------------------\nEnd_1st: =OFFSET(testsheet!$A$2,0,0,COUNTA(testsheet!$A:$A)-1,1)\nEnd_Acct: =OFFSET(End_1st,,6)\nEnd_Bal: =OFFSET(End_1st,,19)\n\nJSP To Test: This jsp reads the excel file using POI and generates a copy of the excel file.\n\n+++++++++++++++++++++++++++++ JSP FILE +++++++++++++++++++++++++++++++++++++++++\n<%@ page import= \"java.util.*,java.io.*\"%>\n<%\n\tString fromPath = \"C:\\\\template_183.xls\";\n\tString toPath2 = \"C:\\\\template_183_POICOPY.xls\";\n\ttry{\n\t\tSystem.out.println(\"Before copyFilesUsingPOI\");\n\t\tInputStream istream = new FileInputStream(fromPath);\n\t\torg.apache.poi.poifs.filesystem.POIFSFileSystem fs = new org.apache.poi.poifs.filesystem.POIFSFileSystem(new BufferedInputStream(istream));\n\t\torg.apache.poi.hssf.usermodel.HSSFWorkbook wb= new org.apache.poi.hssf.usermodel.HSSFWorkbook(fs,true);\n\t\tFileOutputStream fileOut = new FileOutputStream(toPath2);\n\t\twb.write(fileOut);\n\t\tfileOut.close();\n\t\tistream.close();\n\t\tSystem.out.println(\"After copyFilesUsingPOI\");\n\t\t}catch(Exception e){\n\t\t\te.printStackTrace();\n\t\t}\n%>\n+++++++++++++++++++++++++++++ ENDJSP FILE ++++++++++++++++++++++++++++++++++++++\n------------------------------------------------------------\nOutput: (template_183_POICOPY.xls)All the cells where the formula is copied will show #value instead of the value in the original excel file. I am attaching the output file as well.\n------------------------------------------------------------\n\nCould someone please look into this issue. The #value error in this scenario is not resolved in the latest POI release.\n\nThank you.", "id": 117299, "time": "2008-06-03T09:17:24Z", "bug_id": 42541, "creation_time": "2008-06-03T09:17:24Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 42541, "is_private": false, "text": "Created attachment 22062\nSample excel file to test\n\nNote:\n-----\nVariable names within the excel file (template_183.xls)\n\nEnd_1st: =OFFSET(testsheet!$A$2,0,0,COUNTA(testsheet!$A:$A)-1,1)\nEnd_Acct: =OFFSET(End_1st,,6)\nEnd_Bal: =OFFSET(End_1st,,19)", "id": 117300, "time": "2008-06-03T09:18:32Z", "creator": "vkt3142@njit.edu", "creation_time": "2008-06-03T09:18:32Z", "attachment_id": 22062}, {"count": 6, "tags": [], "creator": "vkt3142@njit.edu", "is_private": false, "id": 117301, "creation_time": "2008-06-03T09:20:08Z", "time": "2008-06-03T09:20:08Z", "bug_id": 42541, "text": "Created attachment 22063\nOutput file - Note the #value for the for the formula cells", "attachment_id": 22063}, {"count": 7, "tags": [], "bug_id": 42541, "is_private": false, "text": "Thanks for the new attachment.  The problem is easy to reproduce. \n\nIt is a new bug though, so I have opened up bug 45123 to track the work.", "id": 117305, "time": "2008-06-03T10:04:02Z", "creator": "josh@apache.org", "creation_time": "2008-06-03T10:04:02Z", "attachment_id": null}]