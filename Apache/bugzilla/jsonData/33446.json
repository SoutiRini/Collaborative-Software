[{"count": 0, "tags": [], "bug_id": 33446, "is_private": false, "id": 70629, "creation_time": "2005-02-08T16:34:48Z", "time": "2005-02-08T16:34:48Z", "creator": "renyedi@yahoo.com", "text": "I found this problem while automating my build process. I am using CruiseControl\n2.2 which outputs logs in XML format and uses Ant's XML logger.\n\nThis is my stack trace:\n\njava.lang.NullPointerException\n        at\norg.apache.tools.ant.util.DOMElementWriter.encode(DOMElementWriter.java:174)\n        at\norg.apache.tools.ant.util.DOMElementWriter.write(DOMElementWriter.java:95)\n        at\norg.apache.tools.ant.util.DOMElementWriter.write(DOMElementWriter.java:113)\n        at org.apache.tools.ant.XmlLogger.buildFinished(XmlLogger.java:189)\n        at org.apache.tools.ant.Project.fireBuildFinished(Project.java:1796)\n        at org.apache.tools.ant.Main.runBuild(Main.java:693)\n        at org.apache.tools.ant.Main.startAnt(Main.java:188)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:196)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:55)\n\nThe line the exception occurs is:\n\nint len = value.length();\n\n\"value\" being the method's argument.\n\nThe fix seems obvious by checking value for null and in this case initializing\nlen with 0:\n\nint len = (value==null ? 0 : value.length());\n\nThis worked for me.", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 33446, "is_private": false, "id": 70630, "creation_time": "2005-02-08T16:37:29Z", "time": "2005-02-08T16:37:29Z", "creator": "renyedi@yahoo.com", "text": "Created attachment 14209\nThis solves the problem for me", "attachment_id": 14209}, {"count": 2, "attachment_id": null, "bug_id": 33446, "text": "Something logging in XML should know that it is illegal to omit a value from an\nattribute.\n\nThe XML Logger adds the following attributes:\n\n        buildElement.element.setAttribute(TIME_ATTR,\n                DefaultLogger.formatTime(totalTime));\n\n            buildElement.element.setAttribute(ERROR_ATTR,\n                    event.getException().toString());\n\nAn Exception, being a Throwable MUST NOT return null on toString, as this\nbreaches the contract of toString on a Throwable, formatTime should not be\nreturning null either.\n\nHow can this error be reproduced (Or could you adapt XmlLogger to give some info\n in case the event.getException().toString() returns null, to know which\nexception class is broken.)\n\nTo check this please replace the start of the buildFinished method in the\nXmlLogger class:\n\n    public void buildFinished(BuildEvent event) {\n        long totalTime = System.currentTimeMillis() - buildElement.startTime;\n        buildElement.element.setAttribute(TIME_ATTR,\n                DefaultLogger.formatTime(totalTime));\n\n        if (event.getException() != null) {\n            String temp = event.getException().toString();\n            temp = ((temp != null) ? temp : \n\"Throwable with incorrect toString(): \" +\nevent.getException().getClass().toString());\n\n            buildElement.element.setAttribute(ERROR_ATTR,\n                    temp);\n            // print the stacktrace in the build file it is always useful...\n            // better have too much info than not enough.\n            Throwable t = event.getException();\n            Text errText = doc.createCDATASection(StringUtils.getStackTrace(t));\n            Element stacktrace = doc.createElement(STACKTRACE_TAG);\n            stacktrace.appendChild(errText);\n            buildElement.element.appendChild(stacktrace);\n        }", "id": 70661, "time": "2005-02-08T23:17:07Z", "creator": "jkf@apache.org", "creation_time": "2005-02-08T23:17:07Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 33446, "text": "I think that this is fixed with the fix to bug 31840. (a\ntask name was not set and was used as an attribute value\nwithout checking).\nCan you check with the lastest cvs version of ant.\nIt may be good to use the patch here for safely sake,\nso I am leaving this bug open. ", "id": 70694, "time": "2005-02-09T11:09:05Z", "creator": "peterreilly@apache.org", "creation_time": "2005-02-09T11:09:05Z", "is_private": false, "attachment_id": null}, {"count": 4, "attachment_id": null, "bug_id": 33446, "text": "let's assume Peter is correct again.", "id": 79591, "time": "2005-09-07T21:04:10Z", "creator": "bodewig@apache.org", "creation_time": "2005-09-07T21:04:10Z", "tags": [], "is_private": false}]