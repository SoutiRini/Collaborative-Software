[{"count": 0, "tags": [], "bug_id": 36318, "text": "In the documentation on\nhttp://jakarta.apache.org/tomcat/tomcat-5.5-doc/appdev/sample/ a sample war file\nis linked with the link:\nhttp://jakarta.apache.org/tomcat/tomcat-5.5-doc/appdev/sample/sample.war\n\nThe file is not compressed correctly, it is impossible to uncompress it. For\nexample:\n\nC:\\Programme\\Tomcat\\webapps\\sample>jar -xvf sample.war\n     erstellt: META-INF/\n   extrahiert: META-INF/MANIFEST.MF\njava.util.zip.ZipException: invalid entry size (expected 975 but got 470 bytes)\n        at java.util.zip.ZipInputStream.readEnd(ZipInputStream.java:368)\n        at java.util.zip.ZipInputStream.read(ZipInputStream.java:141)\n        at sun.tools.jar.Main.extractFile(Main.java:714)\n        at sun.tools.jar.Main.extract(Main.java:677)\n        at sun.tools.jar.Main.run(Main.java:189)\n        at sun.tools.jar.Main.main(Main.java:903)", "id": 78877, "attachment_id": null, "creator": "seb_stein@gmx.de", "creation_time": "2005-08-23T11:32:10Z", "time": "2005-08-23T11:32:10Z", "is_private": false}, {"count": 1, "tags": [], "creator": "markt@apache.org", "text": "I have tested the file and I have no problems expanding it. A check of the file\ndate shows it has not changed since this report so it looks like your download\nwas corrupted.", "id": 80281, "time": "2005-09-21T21:32:16Z", "bug_id": 36318, "creation_time": "2005-09-21T21:32:16Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 36318, "attachment_id": null, "text": "What is your MD5/SHA1 sum of the file? \n \nsstein@laptop-seb:~/test$ wget \nhttp://jakarta.apache.org/tomcat/tomcat-5.5-doc/appdev/sample/sample.war \nsstein@laptop-seb:~/test$ md5sum sample.war   \n7f34e9dfcd6719f4a4de65a891384179  sample.war  \nsstein@laptop-seb:~/test$ sha1sum sample.war   \n4091cc5852a79912f0e3dfea6747ab5cae5163b6  sample.war  \nsstein@laptop-seb:~/test$ unzip sample.war   \nArchive:  sample.war  \n   creating: META-INF/  \n extracting: META-INF/MANIFEST.MF      \n  inflating: hello.jsp                bad CRC 03f8858c  (should be 23d12d91)  \n   creating: images/  \n   creating: images/CVS/  \n  inflating: images/CVS/Root          bad CRC 8d694f56  (should be 3f694f56)  \n  inflating: images/CVS/Repository     \n  inflating: images/CVS/Entries       bad CRC f30ae6d7  (should be ca2855dc)  \n  inflating: images/tomcat.gif        bad CRC e6ee8c60  (should be 9706fba8)  \n  inflating: index.html                \n  error:  invalid compressed data to inflate  \n   creating: WEB-INF/  \n   creating: WEB-INF/src/  \n   creating: WEB-INF/src/mypackage/  \n  inflating: WEB-INF/src/mypackage/Hello.java   bad CRC 81241ac3  (should be  \n739f5d43)  \n  inflating: WEB-INF/web.xml           \n  error:  invalid compressed data to inflate  \n   creating: WEB-INF/classes/  \n   creating: WEB-INF/classes/mypackage/  \n  inflating: WEB-INF/classes/mypackage/Hello.class    \n  error:  invalid compressed data to inflate  ", "id": 80282, "time": "2005-09-21T22:44:55Z", "creator": "seb_stein@gmx.de", "creation_time": "2005-09-21T22:44:55Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 36318, "attachment_id": null, "text": "My bad, I didn't check far enough. The file is broken. I'll upload a fixed one\nbut it will take a couple of hours to replicate to the main Apache web server.", "id": 80283, "time": "2005-09-21T23:09:56Z", "creator": "markt@apache.org", "creation_time": "2005-09-21T23:09:56Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 36318, "attachment_id": null, "text": "For the record, the MD5 of the fixed file is 8c6d76407406763b2b69b5fda3cf8e6d", "id": 80284, "time": "2005-09-21T23:17:56Z", "creator": "markt@apache.org", "creation_time": "2005-09-21T23:17:56Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 36318, "attachment_id": null, "id": 83096, "time": "2005-12-01T21:41:47Z", "creator": "dac@cafaro.net", "creation_time": "2005-12-01T21:41:47Z", "is_private": false, "text": "Just tried several times to download it and the corrupted file seems to be back.  \n\n$ md5sum sample.war\n7f34e9dfcd6719f4a4de65a891384179  sample.war\n(several download tries, I'm wondering if this is now a different file than your\nmd5sum, hence compression errors)\n\nArchive:  sample.war\n   creating: META-INF/\n extracting: META-INF/MANIFEST.MF\n  inflating: hello.jsp                bad CRC 03f8858c  (should be 23d12d91)\n   creating: images/\n   creating: images/CVS/\n  inflating: images/CVS/Root          bad CRC 8d694f56  (should be 3f694f56)\n  inflating: images/CVS/Repository\n  inflating: images/CVS/Entries       bad CRC f30ae6d7  (should be ca2855dc)\n  inflating: images/tomcat.gif        bad CRC e6ee8c60  (should be 9706fba8)\n  inflating: index.html\n  error:  invalid compressed data to inflate\n   creating: WEB-INF/\n   creating: WEB-INF/src/\n   creating: WEB-INF/src/mypackage/\n  inflating: WEB-INF/src/mypackage/Hello.java   bad CRC 81241ac3  (should be\n739f5d43)\n  inflating: WEB-INF/web.xml\n  error:  invalid compressed data to inflate\n   creating: WEB-INF/classes/\n   creating: WEB-INF/classes/mypackage/\n  inflating: WEB-INF/classes/mypackage/Hello.class\n  error:  invalid compressed data to inflate\n\nGetting the same older incorrect CRC errors.  Possibly a server replication\nerror somewhere?\n"}, {"count": 6, "tags": [], "bug_id": 36318, "text": "OK, fixed again. It will take a couple of hours to sync to the main web site.", "id": 83099, "attachment_id": null, "creator": "markt@apache.org", "creation_time": "2005-12-01T22:22:05Z", "time": "2005-12-01T22:22:05Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 36318, "attachment_id": null, "id": 83144, "time": "2005-12-02T16:18:50Z", "creator": "dac@cafaro.net", "creation_time": "2005-12-02T16:18:50Z", "is_private": false, "text": "Confirmed, looks good now, thanks."}, {"count": 8, "tags": [], "creator": "yoavs@computer.org", "text": "I'm reopening this until we find a proper fix in the release process.  The file\nis about to get corrupted again as I'm releasing 5.5.14.  I've investigated\nsome, but can't find the guilty task/target in the build process that is\ncorrupting this file.\n\nOthers have suggested that Ant's copy with filtering is to blame, but I cannot\nfind a copy with filtering task that applies to sample.war.  Same thing for the\nfixcrlf tasks suggested to me by someone privately.\n\nHelp investigating and resolving this matter would be appreciated.", "id": 83313, "time": "2005-12-06T15:13:29Z", "bug_id": 36318, "creation_time": "2005-12-06T15:13:29Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 36318, "attachment_id": null, "text": "I've also tested that the same happens on minotaur.apache.org, not just my PC,\nso it's not a Windows-specific thing.\n\nAnd I've also tested that the package-tgz-docs task by itself is not the\nculprit: if I place the right file in\n{tomcat.dist}/webapps/tomcat-docs/appdev/sample/sample.war, the resulting\nfulldocs.tar.gz is correct.  So the checksum change/corruption must be happening\nduring an earlier copy operation.", "id": 83315, "time": "2005-12-06T15:37:02Z", "creator": "yoavs@computer.org", "creation_time": "2005-12-06T15:37:02Z", "is_private": false}, {"count": 10, "tags": [], "bug_id": 36318, "attachment_id": null, "text": "fixcrlf was being applied.  Fixed in 5.5 head.", "id": 83329, "time": "2005-12-06T20:27:44Z", "creator": "Keith@Apache.org", "creation_time": "2005-12-06T20:27:44Z", "is_private": false}]