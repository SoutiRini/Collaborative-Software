[{"count": 0, "tags": [], "creator": "rsc@admadic.de", "attachment_id": null, "text": "The attached Excel file has several problems related to HSSF. First it is not in\nOLE2-format, but that can be solved by wrapping it with a POIFSFileSystem.\nSecond more relevant problem is, several records in the Excel file are shorter\nthan HSSF expects them. As of my understanding, the excel file is somewhat\n\"non-standard\". (Maybe the issues with this file are related to bug #42564.)\n\nAttached are the Excel file and test code to show the problem. \n\nI posted a message with more details about what I found out so far to the\nmailing list. If that should be included/attached here, please say so.\n\nBest wishes,\nRainer Schwarze", "id": 104365, "time": "2007-06-13T04:49:08Z", "bug_id": 42652, "creation_time": "2007-06-13T04:49:08Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 42652, "text": "Created attachment 20338\nExcel file with unexpected record sizes\n\nThis excel file is not in OLE2-format, to read it with HSSF one needs to wrap\nit inside a POIFSFileSystem.", "id": 104366, "time": "2007-06-13T04:51:52Z", "creator": "rsc@admadic.de", "creation_time": "2007-06-13T04:51:52Z", "is_private": false, "attachment_id": 20338}, {"count": 2, "tags": [], "bug_id": 42652, "attachment_id": 20339, "text": "Created attachment 20339\nTest case", "id": 104367, "time": "2007-06-13T04:52:39Z", "creator": "rsc@admadic.de", "creation_time": "2007-06-13T04:52:39Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 42652, "text": "Tried the example+test file in POI 3.1-beta1.  First crash is in DimensionsRecord, where POI expects to read 14 bytes but only gets 10. That's a strong hint that the actual document is really BIFF3-BIFF5 format.  You suggested that several records are shorter than expected, which tends to support this conclusion.\n\nSetting the workbook stream name to \"Workbook\" (which would indicate BIFF8) is not enough.  POI can only read spreadsheets that *fully* meet the BIFF8 spec.\n\n(No, bug 42564 was unrelated.  It was predominantly about ArrayPtg encoding issues)", "id": 116454, "time": "2008-05-10T18:05:44Z", "creator": "josh@apache.org", "creation_time": "2008-05-10T18:05:44Z", "is_private": false, "attachment_id": null}]