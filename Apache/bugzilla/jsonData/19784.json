[{"count": 0, "tags": [], "bug_id": 19784, "attachment_id": null, "id": 36933, "creation_time": "2003-05-08T23:31:45Z", "time": "2003-05-08T23:31:45Z", "creator": "mcrocker@markcrocker.com", "text": "There are circumstances where a StackMapType might have an index of -1. \nUnfortunately, the printIndex method in StackMapType has problems with this. \nThe fix is simple:\n\nOriginal code:\n\n  private String printIndex() {\n    if(type == Constants.ITEM_Object)\n      return \", class=\" + constant_pool.constantToString(index,\nConstants.CONSTANT_Class);\n    else if(type == Constants.ITEM_NewObject)\n      return \", offset=\" + index;\n    else\n      return \"\";\n  }\n\n\nProposed fix:\n\n  private String printIndex() {\n    if(type == Constants.ITEM_Object) {\n      if(index == -1) {\n        return \", class=<unknown>\";\n      } else {\n        return \", class=\" + constant_pool.constantToString(index,\nConstants.CONSTANT_Class) + \"(\" + index + \")\";\n      }\n    } else if(type == Constants.ITEM_NewObject) {\n      if(index == -1) {\n        return \", offset=<unknown>\";\n      } else {\n        return \", offset=\" + index;\n      }\n    } else {\n      return \"\";\n    }\n  }\n\nOne could also argue that the ConstantPool.constantToString methods should be\nfixed as well, though it could also be argued that such cases should fail.  In\nthe case of StackMapType.printIndex, the case is much clearer.\n\nP.S.  While I'm at this, Bugzilla for BCEL doesn't have an option to select\nversion 5.1 of BCEL.  This particular bug is in both 5.0 and 5.1.", "is_private": false}, {"count": 1, "tags": [], "bug_id": 19784, "attachment_id": null, "id": 70810, "time": "2005-02-11T04:30:33Z", "creator": "dbrosius@mebigfatguy.com", "creation_time": "2005-02-11T04:30:33Z", "is_private": false, "text": "Applied to SVN, thanks!"}, {"count": 2, "tags": [], "bug_id": 19784, "attachment_id": null, "is_private": false, "id": 70811, "time": "2005-02-11T04:31:03Z", "creator": "dbrosius@mebigfatguy.com", "creation_time": "2005-02-11T04:31:03Z", "text": "Applied to SVN, thanks!"}]