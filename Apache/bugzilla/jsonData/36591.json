[{"count": 0, "tags": [], "creator": "me@xmart.ws", "attachment_id": null, "is_private": false, "id": 79760, "time": "2005-09-10T14:42:11Z", "bug_id": 36591, "creation_time": "2005-09-10T14:42:11Z", "text": "Try this:\nhint: hello key corresponds to russian 'Privet' string ;)\n\n[/WEB-INF/classes/messages_ru_RU.properties]\nhello=\\u041F\\u0440\\u0438\\u0432\\u0435\\u0442\n[__________]\n\n[/WEB-INF/jspf/header.jspf]\n<%@page contentType=\"text/html\"%>\n<%@page pageEncoding=\"UTF-8\"%>\n<%@taglib prefix=\"fmt\" uri=\"http://java.sun.com/jsp/jstl/fmt\" %>\n[__________]\n\n[/index.jsp]\n<%@include file=\"/WEB-INF/jspf/header.jspf\" %>\n<fmt:message key=\"hello\" />\n[__________]\n\n\nUnfortunately, this wouldn't work :( and response is being sent using ISO-8859-1\nencoding.\n\nTo woorkaround this, I putthe following line into [/index.jsp]:\n  <%@page pageEncoding=\"UTF-8\"%>\n.. just before <%@include file=\"/WEB-INF/jspf/header.jspf\" %>\n(putting it after works well also)\n\nHowever, if I decide to change content type to text/plain, changing it in\n[header.jspf] works ok."}, {"count": 1, "tags": [], "bug_id": 36591, "is_private": false, "id": 80139, "creation_time": "2005-09-19T23:06:30Z", "time": "2005-09-19T23:06:30Z", "creator": "markt@apache.org", "text": "This is as per the spec.\n\n<spec-quote section=\"JSP.4.2\">\n...\nOnly the character encoding specified for the requested page is used; the\nencodings of files included via the include directive are not taken into\nconsideration. ...\n</spec-quote>", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 36591, "text": "*** Bug 36001 has been marked as a duplicate of this bug. ***", "id": 80141, "time": "2005-09-19T23:08:32Z", "creator": "markt@apache.org", "creation_time": "2005-09-19T23:08:32Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 36591, "is_private": false, "text": "I'm having the same issues. This statement in the specification relates to how\nthe response is encoded (and that's correct -- the first page takes precedence),\nbut I believe this error occurs at JSP-compilation level (the generated source\ncode has corrupted encoding from included files). \n\nCould you clarify, Mark?", "id": 83766, "time": "2005-12-18T02:53:38Z", "creator": "dawid.weiss@cs.put.poznan.pl", "creation_time": "2005-12-18T02:53:38Z", "attachment_id": null}, {"count": 4, "attachment_id": null, "creator": "markt@apache.org", "text": "Please provide the simplest test case the reproduces this issue and I'll take a\nlook.", "id": 83772, "time": "2005-12-18T17:25:51Z", "bug_id": 36591, "creation_time": "2005-12-18T17:25:51Z", "tags": [], "is_private": false}, {"count": 5, "attachment_id": null, "bug_id": 36591, "text": "Ok, it was my fault. I'll explain anyway -- maybe it'll help someone.\n\nJasper (JSP compiler) uses an algorithm to determine the encoding of every\nsingle JSP page. This also applies to all resources included with <%@include\nfile=\"\" %>) (the encoding is determined for each one of these files). So, unless\nyou have an explicit page encoding directive in all included files (<@%page\npageEncoding=\"UTF-8\" %>), you will encounter problems with corrupted input\nencoding (because included files will be read with the default encoding,\nregardless of the encoding of the main page).\n\nI still think the encoding of the main page should be the default to switch to\nfor all included resources if they don't declare any other explicit encoding...\nbut I guess it's not that important. Sorry for false alarm.", "id": 83781, "time": "2005-12-19T00:15:25Z", "creator": "dawid.weiss@cs.put.poznan.pl", "creation_time": "2005-12-19T00:15:25Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "bug_id": 36591, "text": "For the record, the current behaviour you have described is as required by the\nspec (JSP.4.1).", "id": 83782, "time": "2005-12-19T00:21:39Z", "creator": "markt@apache.org", "creation_time": "2005-12-19T00:21:39Z", "is_private": false, "attachment_id": null}]