[{"count": 0, "tags": [], "creator": "chennak.s@intellicus.com", "attachment_id": 33950, "is_private": false, "id": 191670, "time": "2016-06-15T11:45:29Z", "bug_id": 59705, "creation_time": "2016-06-15T11:45:29Z", "text": "Created attachment 33950\npivot table\n\nImplementation for XSSFPivotTable.addColumnLabel() method was wrong. \n\nImplementation provided for XSSFPivotTable.addColumnLabel() methods is actually the implementation for ValueLabel() methods.\n\nIf we are creating pivot tables using XSSFPivotTable.addColumnLabel(), the field is adding to the Values position in the excel file."}, {"count": 1, "tags": [], "creator": "chennak.s@intellicus.com", "is_private": false, "text": "i have updated code accordingly to fix this issue.\n\ni have created a new method XSSFPivotTable.addColumnLabel(int columnIndex) and changed the names of existing XSSFPivotTable.addColumnLabel() methods to XSSFPivotTable.addValueLabel()\n\n--------------------------------------------\nNew method, which i have added\n---------------------------------------\n  /**\n     * Add a column label using data from the given column.\n     * @param columnIndex the index of the column to be used as column label.\n     */\n    @Beta\n    public void addColumnLabel(int columnIndex) {\n        AreaReference pivotArea = getPivotArea();\n        int lastRowIndex = pivotArea.getLastCell().getRow() - pivotArea.getFirstCell().getRow();\n        int lastColIndex = pivotArea.getLastCell().getCol() - pivotArea.getFirstCell().getCol();\n\n        if(columnIndex > lastColIndex) {\n            throw new IndexOutOfBoundsException();\n        }\n        CTPivotFields pivotFields = pivotTableDefinition.getPivotFields();\n\n        CTPivotField pivotField = CTPivotField.Factory.newInstance();\n        CTItems items = pivotField.addNewItems();\n\n        pivotField.setAxis(STAxis.AXIS_COL);\n        pivotField.setShowAll(false);\n        for(int i = 0; i <= lastRowIndex; i++) {\n            items.addNewItem().setT(STItemType.DEFAULT);\n        }\n        items.setCount(items.sizeOfItemArray());\n        pivotFields.setPivotFieldArray(columnIndex, pivotField);\n\n        CTColFields colFields;\n        if(pivotTableDefinition.getColFields() != null) {\n            colFields = pivotTableDefinition.getColFields();\n        } else {\n            colFields = pivotTableDefinition.addNewColFields();\n        }\n\n        colFields.addNewField().setX(columnIndex);\n        colFields.setCount(colFields.sizeOfFieldArray());\n    }\n\n\n\n--------------------------------------------------\nChange of previous existing XSSFPivotTable.addColumnLabel methods to XSSFPivotTable.addValueLabel\n-----------------------------------------------------", "id": 191672, "time": "2016-06-15T11:54:36Z", "bug_id": 59705, "creation_time": "2016-06-15T11:54:36Z", "attachment_id": null}, {"count": 2, "tags": [], "text": "@Apache POI developers\n\nPlease verify it and resolve the ticket", "is_private": false, "bug_id": 59705, "id": 191673, "time": "2016-06-15T11:55:48Z", "creator": "chennak.s@intellicus.com", "creation_time": "2016-06-15T11:55:48Z", "attachment_id": null}, {"count": 3, "tags": [], "text": "Also please provide the provision to user to apply sorting on row label(s) and/or column label(s)", "attachment_id": null, "bug_id": 59705, "id": 191723, "time": "2016-06-17T05:06:57Z", "creator": "chennak.s@intellicus.com", "creation_time": "2016-06-17T05:06:57Z", "is_private": false}, {"count": 4, "tags": [], "creator": "onealj@apache.org", "attachment_id": null, "is_private": false, "id": 191724, "time": "2016-06-17T06:17:04Z", "bug_id": 59705, "creation_time": "2016-06-17T06:17:04Z", "text": "Thanks for your contribution!\n\nAny chance you could also write a unit test for this so that behavior can be verified in our automated builds?\nProbably the best place to add the unit test would be here: https://svn.apache.org/viewvc/poi/trunk/src/ooxml/testcases/org/apache/poi/xssf/usermodel/TestXSSFPivotTable.java?view=log"}, {"count": 5, "tags": [], "creator": "onealj@apache.org", "attachment_id": null, "is_private": false, "id": 191746, "time": "2016-06-17T10:50:52Z", "bug_id": 59705, "creation_time": "2016-06-17T10:50:52Z", "text": "*** Bug 59368 has been marked as a duplicate of this bug. ***"}]