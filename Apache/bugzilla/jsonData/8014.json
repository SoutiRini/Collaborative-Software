[{"count": 0, "tags": [], "text": "For testing, I have an alias called /C that points to \"C:\\Documents and Settings\\\". I keep my \nprofile directory on a separate disk that is mounted under \"C:\\Documents and Settings\\Sam\". \nHowever, the Sam\\ folder does not appear in Apache's directory listing. Additionally, while the \ndirectory listing is being generated, this appears in the error.log:\n\n[Fri Apr 12 14:33:05 \n2002] [error] [client 127.0.0.1] symlink doesn't point to a file or directory: C:/Documents and \nSettings/Sam\n\nAsking for anything under \"http://localhost/C/Documents and \nSettings/Sam\" manually throws a 403 back to the client, with the same error in the event \nlog.\n\nIf I remove the \"FollowSymLinks\" option for the directory then the error message is \ninstead:\n\n[Fri Apr 12 14:41:29 2002] [error] [client 127.0.0.1] Symbolic link not allowed: \nC:/Documents and Settings/Sam\n\nand a 403 is still returned to the browser.", "attachment_id": null, "bug_id": 8014, "id": 13364, "time": "2002-04-12T13:42:27Z", "creator": "sam@netcity.co.uk", "creation_time": "2002-04-12T13:42:27Z", "is_private": false}, {"count": 1, "tags": [], "creator": "slive@apache.org", "attachment_id": null, "id": 13412, "time": "2002-04-12T20:18:20Z", "bug_id": 8014, "creation_time": "2002-04-12T20:18:20Z", "is_private": false, "text": "Please don't submit to the bug database and post to the newsgroup at the same\ntime.  You may reopen this report if you don't get a response within a few\ndays on the newsgroup."}, {"count": 2, "tags": [], "bug_id": 8014, "text": "Reopening, with more information:\n\nSnippet from httpd.conf:\n   Alias /C \"C:/\"\n   <Directory \n\"C:/\">\n      Options Indexes FollowSymLinks MultiViews\n      AllowOverride None\n      Order \nallow,deny\n      Allow from all\n   </Directory>\n\nRequesting \nhttp://localhost/C/Documents%20and%20Settings/ returns a listing\nof the directory, but \nwith the expected \"Sam/\" entry (C:\\Documents and\nSettings\\Sam\\ is actually a mount point) \nomitted. Instead, \"[error] [client\n127.0.0.1] symlink doesn't point to a file or directory: \nC:/Documents and\nSettings/Sam\" appears in the error log.\n\nRequesting \nhttp://localhost/C/Documents%20and%20Settings/Sam/, or anything\ninside of it, returns a \n403 error and likewise adds \"[error] [client\n127.0.0.1] symlink doesn't point to a file or \ndirectory: C:/Documents and\nSettings/Sam\" to the error log.\n\nRequesting \nhttp://localhost/C/Documents%20and%20Settings/All%20Users/ or any\nof the other links \nfrom the directory listing works as it should.\n\nAfter doing some reading, it appears that what \nApache calls symlinks on\nWindows are actually NTFS Junctions; most junctions have a target of \na\nregular pathname (such as \"C:\\Target\\\"), but the mount point junctions\nWindows uses have a \ntarget in the form of\n\"\\\\?\\Volume{90b9a960-b928-11d5-bbf2-806d6172696f}\\\" (the classid is \nthe\nvolume's unique identifier).\n\nThe error message suggests that Apache is checking the \njunction target to\nsee if it is a valid path (which the mount point junction target is not) \nand\nthrowing the error. So it seems the problem lies within the code that Apache uses to check the \nsymlink/juntion target.", "id": 13956, "attachment_id": null, "creator": "sam@netcity.co.uk", "creation_time": "2002-04-18T10:16:49Z", "time": "2002-04-18T10:16:49Z", "is_private": false}, {"count": 3, "attachment_id": null, "bug_id": 8014, "text": "\n  This is fixed in the current 2.0.36-dev tree, and will be part of the\n  next 2.0.36 release we expect to roll out within a week or so.\n\n  Thanks for your report, your detailed examples, and for adopting Apache 2.0!\n\n", "id": 14588, "time": "2002-04-24T04:21:29Z", "creator": "wrowe@apache.org", "creation_time": "2002-04-24T04:21:29Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 8014, "attachment_id": null, "text": "The precise behavior noted in the original bug still occurs in 2.0.44 on UNC \n(remote share) paths under Win2K Server or Win2K3RC2:\n\nAlias /nas/junction/dir1/dir2/ \"//192.168.0.10/nas/junction/dir1/dir2/\"\n<Directory \"//192.168.0.10/nas/junction/dir1/dir2\">\n    Options Indexes FollowSymLinks\n    AllowOverride None\n    Order allow,deny\n    Allow from all\n</Directory>\n\n[Thu Mar 27 22:24:03 2003] [error] [client 67.67.67.117] \nForbidden: //192.168.0.10/nas/junction doesn't point to a file or directory\n\nIf FollowSymLinks is turned off, then:\n\n[Thu Mar 27 23:24:07 2003] [error] [client 67.67.67.117] Symbolic link not \nallowed: //192.168.0.10/nas/junction\n\nEither way, with indexing turned on and using the following mapping, Apache \nbrowses the directory fine, and generates an index, but does not see ANY of \nthe junctions:\n\nAlias /nas/ \"//192.168.0.10/nas/\"\n<Directory \"//192.168.0.10/nas\">\n    Options Indexes FollowSymLinks\n    AllowOverride None\n    Order allow,deny\n    Allow from all\n</Directory>\n\nIt sees regular folders and files just fine.\n\nNFTS can create at least two common types of junctions.  One is the MountVol \ntarget format shown in Sam's bug report, and the other is a path reference as \ncreated with \"linkd.exe\" from Win2K Resource Kit.  The above behavior is \nobserved with BOTH types.  \n\nI have rated this as MAJOR because without fixing this, Apache cannot be used \nto serve content from servers in a web farm that all work from a NAS server \nthat mounts many RAID arrays using the \"MountVol\" or \"LinkD\" method.  While \nthe LinkD method is uncommon, the MountVol method is offered in default \nWindows GUI Drive Management on volume creation, and is a common way to add \nnew volumes into an existing path structure.\n\n\n", "id": 34022, "time": "2003-03-28T07:46:10Z", "creator": "bugzilla@areallycool.com", "creation_time": "2003-03-28T07:46:10Z", "is_private": false}, {"count": 5, "tags": [], "creator": "kspinka@style.net", "text": "  I'm not 100% this fixes the issue mentioned at \nhttp://nagoya.apache.org/bugzilla/show_bug.cgi?id=8014 though I tried to \nreproduce the issue as I understood it.  If one of the bug submitters could \ntest it that would be great.  Bill, if you could verify that this change is \nreasonable I would appreciate it, the 'wanted' thing is a little vague to me.\n\n--- filestat.c.orig     Fri Mar  7 14:21:29 2003\n+++ filestat.c  Fri Mar 28 07:16:02 2003\n@@ -363,7 +363,8 @@\n         finfo->size = 0x7fffffff;\n #endif\n \n-    if (wininfo->dwFileAttributes & FILE_ATTRIBUTE_REPARSE_POINT) {\n+    if (wanted & APR_FINFO_LINK &&\n+        wininfo->dwFileAttributes & FILE_ATTRIBUTE_REPARSE_POINT) {\n         finfo->filetype = APR_LNK;\n     }\n     else if (wininfo->dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY) {\n\n\n   /kristofer", "id": 34046, "time": "2003-03-28T13:02:26Z", "bug_id": 8014, "creation_time": "2003-03-28T13:02:26Z", "is_private": false, "attachment_id": null}, {"count": 6, "attachment_id": null, "bug_id": 8014, "is_private": false, "id": 34900, "time": "2003-04-10T18:09:33Z", "creator": "nd@perlig.de", "creation_time": "2003-04-10T18:09:33Z", "tags": [], "text": "Reopen to get this on the radar. Bill? your turn ;-)"}, {"count": 7, "attachment_id": null, "bug_id": 8014, "is_private": false, "id": 35447, "time": "2003-04-17T16:56:54Z", "creator": "wrowe@apache.org", "creation_time": "2003-04-17T16:56:54Z", "tags": [], "text": "\n  This was fixed in 2.0.45.  Please upgrade, and if the problem persists, please\n  reopen the bug with the new error log entries and observations.\n"}, {"count": 8, "tags": [], "bug_id": 8014, "text": "  I stand corrected; that patch wasn't committed.\n\n  Now committed as of apr/file_io/win32/filestat.c revision 1.79,\n  and I expect you will see this in the forthcoming Apache 2.0.46.", "id": 37431, "time": "2003-05-19T14:04:27Z", "creator": "wrowe@apache.org", "creation_time": "2003-05-19T14:04:27Z", "is_private": false, "attachment_id": null}]