[{"count": 0, "tags": [], "bug_id": 31266, "attachment_id": null, "id": 63673, "time": "2004-09-16T17:54:54Z", "creator": "narliss@gmail.com", "creation_time": "2004-09-16T17:54:54Z", "is_private": false, "text": "According to RFC 2109, when sending cookies to the origin server, $Path and\n$Domain are optional attributes for the cookie header. The\nRequestUtil.parseCookieHeader method does not account for these optional\nparameters and could lead to an Illegal Argument Exception being thrown from\njavax.servlet.http.Cookie.\n\nThe parseCookieHeader method currently tokenizes the cookie header using the ';'\nas a delimeter. All name=value pairs are used to create new\njavax.servlet.http.Cookie objects. According to javax.servlet.http.Cookie: \n\n\"The name must conform to RFC 2109. That means it can contain only ASCII\nalphanumeric characters and cannot contain commas, semicolons, or white space or\nbegin with a $ character\"\n\nParseCookieHeader should look for the pat and domain keywords for each token and\nif found, their values should be added to the last cookie object created using\nthe setDomain and setPath cookie methods."}, {"count": 1, "tags": [], "bug_id": 31266, "is_private": false, "text": "I know not of this RequestUtil of which you speak.  There is no such class in \nTC 3.3.\n\nTomcat 3.3.2 parses RFC 2109 Cookie headers just fine for any example I can \nthrow at it.  \n\nFeel free to reopen if you have an example of a cookie header that fails to \nparse correctly.", "id": 63684, "time": "2004-09-17T03:34:12Z", "creator": "william.barker@wilshire.com", "creation_time": "2004-09-17T03:34:12Z", "attachment_id": null}, {"count": 2, "attachment_id": null, "creator": "narliss@gmail.com", "is_private": false, "id": 63736, "time": "2004-09-17T15:38:13Z", "bug_id": 31266, "creation_time": "2004-09-17T15:38:13Z", "tags": [], "text": "I appologize for getting ahead of myself. The RequestUtil.parseCookieHeader\nmethod is in Tomcat 5.5. RequestUtil.processCookies is in Tomcat 3.2.2 final\nhere:\nhttp://cvs.apache.org/viewcvs.cgi/jakarta-tomcat/src/share/org/apache/tomcat/util/Attic/RequestUtil.java?rev=1.14.2.1&only_with_tag=tomcat_32_final&view=markup\n\nI'm not sure how Tomcat 3.3 handles cookie parsing however if a cookie header\nlooks like this is presented to Tomcat 3.2.2 you will get an Illegal Argument\nException from javax.servlet.http.cookie if anyone calls RequestUtil.procesCookies:\n\ncookie: Foo=Bar; $Domain=.acme.com; $Path=/acme/ammo\n\n"}, {"count": 3, "tags": [], "bug_id": 31266, "attachment_id": null, "text": "Your Cookie header is malformed for RFC 2109 (the $Version is required).  \nHowever, TC 3.3 is lenient enough to parse your example correctly.\n\nSince this is now against TC 3.2, I'll leave it open.  However, you have a \nbetter chance of being struck by lightning than of ever seeing another 3.2.x \nrelease :).", "id": 63762, "time": "2004-09-18T02:51:33Z", "creator": "william.barker@wilshire.com", "creation_time": "2004-09-18T02:51:33Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 31266, "attachment_id": null, "text": "Marked as WONTFIX, since we are neither going to fix nor make a release for an\nunsupported Tomcat version. (This is more a case of CANTFIX).", "id": 93448, "time": "2006-09-12T17:57:05Z", "creator": "sriramnrn@gmail.com", "creation_time": "2006-09-12T17:57:05Z", "is_private": false}]