[{"count": 0, "tags": [], "bug_id": 12186, "attachment_id": null, "text": "When either or both of the begintoken or endtoken attributes are set to the \nempty string on the replacetokens filterchain, it falls in a heap.\n\nI would use copy with filtersets instead, but it doesn't allow me to have empty \nbegintoken or endtoken attributes.\n\nUsing the attached buildfile, running either of the targets gives:\n\nE:\\Construction>ant -verbose -buildfile e:\\bug.xml bob\nApache Ant version 1.5 compiled on July 9 2002\nBuildfile: e:\\bug.xml\nDetected Java version: 1.3 in: P:\\jdk1.3.1\\jre\nDetected OS: Windows NT\nparsing buildfile e:\\bug.xml with URI = file:e:/bug.xml\nProject base dir set to: E:\\\nBuild sequence for target `bob' is [bob]\nComplete build sequence is [bob, bob2]\n\nbob:\nProperty ${TODAY} has not been set\n     [copy] Copying 1 file to C:\\temp\n     [copy] Copying C:\\autoexec.bat to C:\\temp\\junk.zzz\n\nBUILD FAILED\njava.lang.StringIndexOutOfBoundsException: String index out of range: 0\n        at java.lang.String.charAt(String.java:516)\n        at org.apache.tools.ant.filters.ReplaceTokens.initialize\n(ReplaceTokens.java:274)\n        at org.apache.tools.ant.filters.ReplaceTokens.read\n(ReplaceTokens.java:133)\n        at org.apache.tools.ant.filters.BaseFilterReader.read\n(BaseFilterReader.java:123)\n        at java.io.BufferedReader.fill(BufferedReader.java:139)\n        at java.io.BufferedReader.readLine(BufferedReader.java:299)\n        at java.io.BufferedReader.readLine(BufferedReader.java:362)\n        at org.apache.tools.ant.util.FileUtils.copyFile(FileUtils.java:367)\n        at org.apache.tools.ant.util.FileUtils.copyFile(FileUtils.java:225)\n        at org.apache.tools.ant.taskdefs.Copy.doFileOperations(Copy.java:527)\n        at org.apache.tools.ant.taskdefs.Copy.execute(Copy.java:368)\n        at org.apache.tools.ant.Task.perform(Task.java:317)\n        at org.apache.tools.ant.Target.execute(Target.java:309)\n        at org.apache.tools.ant.Target.performTasks(Target.java:334)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1306)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1250)\n        at org.apache.tools.ant.Main.runBuild(Main.java:610)\n        at org.apache.tools.ant.Main.start(Main.java:196)\n        at org.apache.tools.ant.Main.main(Main.java:235)\n\nTotal time: 1 second", "id": 22017, "time": "2002-08-30T07:10:12Z", "creator": "Edwin_STEELE@rta.nsw.gov.au", "creation_time": "2002-08-30T07:10:12Z", "is_private": false}, {"count": 1, "tags": [], "text": "Created attachment 2872\nA build file that triggers the problem", "attachment_id": 2872, "id": 22018, "creator": "Edwin_STEELE@rta.nsw.gov.au", "time": "2002-08-30T07:11:16Z", "bug_id": 12186, "creation_time": "2002-08-30T07:11:16Z", "is_private": false}, {"count": 2, "tags": [], "creator": "umagesh@apache.org", "text": "I can add a check to ensure begintoken and endtoken are not empty.  But that\nwill not address your issue.\n\nI suggest you write a custom filter to replace exact String matches.\nIt is not reasonable to use the replacetokens filter without specifying tokens.\n", "id": 22175, "time": "2002-09-03T15:26:05Z", "bug_id": 12186, "creation_time": "2002-09-03T15:26:05Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 12186, "attachment_id": null, "text": "I have fixed the blow up - you will now get an exception setting a character\nattribute to an empty string. Also, I agree with Magesh that you cannot use the\nreplacetokens filter without token delimiters. ", "id": 31606, "time": "2003-02-19T14:50:11Z", "creator": "conor@apache.org", "creation_time": "2003-02-19T14:50:11Z", "is_private": false}]