[{"count": 0, "tags": [], "bug_id": 41135, "attachment_id": null, "id": 96654, "time": "2006-12-08T05:08:09Z", "creator": "gquiring@gmail.com", "creation_time": "2006-12-08T05:08:09Z", "is_private": false, "text": "Configure script for 2.2.3 crashes Solaris 9 (Sun v440 hardware). 2.0.54 \nconfigure script works fine.\n\nConfigure options:\n./configure \\ \n--prefix=/usr/local/apache \\ \n--enable-module=all \\ \n--enable-shared=max \\ \n--enable-module=so \n\nAfter about 20 seconds the configure script stops with these lines: \n\nCheck for compiler flags... \nchecking whether to enable -D_LARGEFILE64_SOURCE... \n\n/var/adm/messages: \n\nDec  7 07:11:11 dev1 unix: [ID 836849 kern.notice] \nDec  7 07:11:11 dev1 ^Mpanic[cpu2]/thread=3000f61e800: \nDec  7 07:11:11 dev1 unix: [ID 763660 kern.notice] rw_exit: lock not \nheld, lp=30 \n076111b10 wwwh=0 thread=3000f61e800 \nDec  7 07:11:11 dev1 unix: [ID 100000 kern.notice] \nDec  7 07:11:12 dev1 genunix: [ID 723222 kern.notice] 000002a100f07430 \nvxfs:vx_r \nwunlock+2c (300002d2c48, 300002d2c48, 7fffffffffffffff, 300000a98f0, 0, \n\n\n8) \nDec  7 07:11:13 dev1 genunix: [ID 179002 kern.notice]   %l0-3: \n0000000000000000 \n000003000ebe4448 000000000144f578 0000000000000060 \nDec  7 07:11:13 dev1   %l4-7: 000000000149adc0 00000000ffbff6e8 \n00000000ffbff6ec \n00000000065ca5ac \nDec  7 07:11:14 dev1 genunix: [ID 723222 kern.notice] 000002a100f074e0 \ngenunix:r \neclock+33c (300718fa678, 2a100f07740, 5, 0, 0, 0) \nDec  7 07:11:14 dev1 genunix: [ID 179002 kern.notice]   %l0-3: \n000000007845c758 \n00000300000a9868 0000000000000000 0000000000002000 \nDec  7 07:11:14 dev1   %l4-7: 00000300718fa678 000002a100f07740 \n000003000ebe4448 \n0000000081010100 \nDec  7 07:11:15 dev1 genunix: [ID 723222 kern.notice] 000002a100f07690 \ngenunix:c \nhklock+68 (300718fa678, 2, 0, 1092, 2102, 0) \nDec  7 07:11:16 dev1 genunix: [ID 179002 kern.notice]   %l0-3: \n0000000078431de0 \n0000030006f8b5a0 000003007233c530 000003000f61e800 \n\nOutput from crash files: \nmdb -k 4 \nLoading modules: [ unix krtld genunix ip usba ipc nfs ptm logindmux \nrandom ] \n\n> $C \n\n000002a100f06b81 vpanic(105d370, 1414990, 30076111b10, 0, 3000f61e800, \nfffffffffffffff8) \n000002a100f06c31 vx_rwunlock+0x2c(300002d2c48, 300002d2c48, \n7fffffffffffffff, \n300000a98f0, 0, 8) \n000002a100f06ce1 reclock+0x33c(300718fa678, 2a100f07740, 5, 0, 0, 0) \n000002a100f06e91 chklock+0x68(300718fa678, 2, 0, 1092, 2102, 0) \n000002a100f06f81 vx_space+0x210(0, 3007233c530, 2a100f07a98, 2102, 0, \n300003a88a8) \n000002a100f07041 fcntl+0xe94(100000, 7fffffffffffffff, 3000e9c61d0, 0, \n0, 0) \n000002a100f072f1 syscall_trap32+0xa8(3, 1b, ffbff808, 0, 0, 0)"}, {"count": 1, "tags": [], "bug_id": 41135, "attachment_id": null, "id": 96658, "time": "2006-12-08T06:13:30Z", "creator": "trawick@apache.org", "creation_time": "2006-12-08T06:13:30Z", "is_private": false, "text": "maybe somebody here will chime in with a work-around to skip that configure logic,\nbut to properly resolve the problem you need to report the kernel panic to Sun\n"}, {"count": 2, "tags": [], "creator": "gquiring@gmail.com", "attachment_id": null, "text": "Using --disable-lfs fixes the issue.  Question is why? Apach 2.0.x works fine \nwithout any issues.", "id": 96660, "time": "2006-12-08T06:19:27Z", "bug_id": 41135, "creation_time": "2006-12-08T06:19:27Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 41135, "text": "This is a Sun bug.  Contact Sun or try applying the current patch set.\n\nApache 2.0 (or rather, the bundled libapr) doesn't turn on lfs by default, so\nthis OS problem was bypassed when you built that level.\n\nMoving PR to product \"APR\"...\n\nNote that this kernel panic problem apparently does not affect many Solaris 9\nusers.  This is the first PR I've seen on this issue, and I haven't encountered\nit on Solaris 9 myself.  If you are able to determine how to identify a broken\nsystem, you can update this PR with that information.  On a broken system we\ncould halt the configure process and tell user they can apply a Solaris fix OR\nreinvoke configure with --disable-lfs, but with the caveat that their ABI is\nnon-standard (i.e., they can't use modules built for normal Apache 2.2.x) since\ndisabling lfs changes the ABI).", "id": 96662, "time": "2006-12-08T08:12:31Z", "creator": "trawick@apache.org", "creation_time": "2006-12-08T08:12:31Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 41135, "attachment_id": null, "id": 96663, "time": "2006-12-08T09:10:12Z", "creator": "gquiring@gmail.com", "creation_time": "2006-12-08T09:10:12Z", "is_private": false, "text": "The crash seems to be related to Veritas volume manager. "}]