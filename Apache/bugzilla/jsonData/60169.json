[{"attachment_id": null, "tags": [], "creator": "scajo06@ca.com", "is_private": false, "count": 0, "id": 193958, "time": "2016-09-23T19:53:12Z", "bug_id": 60169, "creation_time": "2016-09-23T19:53:12Z", "text": "Attempting to run Tomcat 8.5.036 on z/OS with 64 bit IBM Java 8 causes a ClassFormatException in processAnnotationsFile during Startup.\n\n\nSteps to Reproduce:\nStart Tomcat\n\n\nActual Results:\nTomcat fails to start.  STDERR shows the following error for multiple files:\n\norg.apache.catalina.startup.ContextConfig processAnnotationsFile\nSEVERE: Unable to process file ./cai/esd/CCS14/6B/nsmem/browser/help/abrowser/idmsagent/element.class. for annotations\norg.apache.tomcat.util.bcel.classfile.ClassFormatException: It is not a Java .class file\n.at org.apache.tomcat.util.bcel.classfile.ClassParser.readID(ClassParser.java:202)\n.at org.apache.tomcat.util.bcel.classfile.ClassParser.parse(ClassParser.java:80)\n.at org.apache.catalina.startup.ContextConfig.processAnnotationsStream(ContextConfig.java:2042)\n.at org.apache.catalina.startup.ContextConfig.processAnnotationsFile(ContextConfig.java:2025)\n.at org.apache.catalina.startup.ContextConfig.processAnnotationsFile(ContextConfig.java:2019)\n.at org.apache.catalina.startup.ContextConfig.processAnnotationsFile(ContextConfig.java:2019)\n.at org.apache.catalina.startup.ContextConfig.processAnnotationsFile(ContextConfig.java:2019)\n.at org.apache.catalina.startup.ContextConfig.processAnnotationsFile(ContextConfig.java:2019)\n.at org.apache.catalina.startup.ContextConfig.processAnnotationsFile(ContextConfig.java:2019)\n.at org.apache.catalina.startup.ContextConfig.processAnnotationsFile(ContextConfig.java:2019)\n.at org.apache.catalina.startup.ContextConfig.processAnnotationsFile(ContextConfig.java:2019)\n.at org.apache.catalina.startup.ContextConfig.processAnnotationsFile(ContextConfig.java:2019)\n.at org.apache.catalina.startup.ContextConfig.processAnnotationsFile(ContextConfig.java:2019)\norg.apache.catalina.startup.ContextConfig.processAnnotationsFile(ContextConfig.java:2019)\n.at org.apache.catalina.startup.ContextConfig.processAnnotationsUrl(ContextConfig.java:1961)\n.at org.apache.catalina.startup.ContextConfig.processAnnotations(ContextConfig.java:1912)\n.at org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1157)\n.at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:779)\n.at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:306)\n.at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:95)\n.at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)\n.at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5202)\n.at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:147)        \n.at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:725)\n.at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:701)     \n.at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:717)       \n.at org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1092)\n.at org.apache.catalina.startup.HostConfig$DeployDirectory.run(HostConfig.java:1834)\n.at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)     \n.at java.util.concurrent.FutureTask.run(FutureTask.java:267)                    \n.at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1143)\n.at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:618)\n.at java.lang.Thread.run(Thread.java:785)                                       \n\nSYSOUT shows:\nJVMJZBL1023N Invoking org.apache.catalina.startup.Bootstrap.main()...\nJVMJZBL1056I Arguments to main...                                    \nJVMJZBL1057I start                                                   \nCEE5230S The signal SIGXCPU was received.                            \n\n\nWorkaround:\nIn context.xml, add the following line:\n<JarScanner scanClassPath=\"false\"/>\n\nThis seems to prevent the scanning for annotations files since not all of our .class files are Java .class files."}, {"count": 1, "tags": [], "creator": "markt@apache.org", "is_private": false, "text": "I don't think that Tomcat should be expected to handle the situation where there are .class files on the Java class path that are not Java classes.", "id": 193967, "time": "2016-09-24T10:21:02Z", "bug_id": 60169, "creation_time": "2016-09-24T10:21:02Z", "attachment_id": null}]