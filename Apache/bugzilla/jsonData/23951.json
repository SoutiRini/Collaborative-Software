[{"count": 0, "tags": [], "creator": "jim.shen@moh.gov.on.ca", "text": "I called setSheetOrder(...) of HSSFWorkBook re-set the order of one worksheet. \nThe worksheet was re-located successfully. However, the sheet tab name for that \nlocation where the new sheet was moved to still points to the name of original \nsheet. \n\nTo re-produce:\n1) Open a workbook with two worksheets: sheet 1 followed by sheet 2;\n2) Call setSheetOrder(...) to move sheet 2 before sheet 1;\n3) Save the file;\n4) Open the modified file: see the sheet name in worksheet tab still has the \norder of sheet 1 followed by sheet 2 even though the actual work wheets have \nbeen switched.", "id": 45943, "time": "2003-10-20T18:16:24Z", "bug_id": 23951, "creation_time": "2003-10-20T18:16:24Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 23951, "text": "I can confirm that this happens in the 2.5.1 release.\n\nHere's a workaround that I use for the case where you want to put the last \nsheet in the first position:\n\n        for(int i = workbook.getNumberOfSheets() - 2; i >= 0 ; --i)\n        {\n            String sheetName = workbook.getSheetName(i);\n            workbook.cloneSheet(i);\n            workbook.removeSheetAt(i);\n            int lastSheet = workbook.getNumberOfSheets() - 1;\n            workbook.setSheetName(lastSheet, sheetName);\n            \n        }\n\nIt's probably not too hard to generalize this for an abitrary position.", "id": 90222, "time": "2006-06-14T21:03:43Z", "creator": "rich.renomeron@tcg.com", "creation_time": "2006-06-14T21:03:43Z", "is_private": false, "attachment_id": null}, {"count": 2, "attachment_id": null, "bug_id": 23951, "is_private": false, "id": 92501, "time": "2006-08-24T16:51:26Z", "creator": "adrianrm@web.de", "creation_time": "2006-08-24T16:51:26Z", "tags": [], "text": "I think the problem goes deeper. Here is an example error case:\n\nI have a workbook with 6 sheets\n1) Open the workbook\n2) Call setSheetOrder(...) to move sheet 3 before sheet 1;\n3) Save the file\n4) Open the file\nThe result is that the name of the tabs hasn't changed, but the contents of the\ntabs follow the order: 2,3,1,4,5,6.\n\nI've tried to fix it, but don't know much about the project, so it didn't make\n(apparently)anything. I changed the setSheetOrder method in class HSSFWorkbook:\n\n    public void setSheetOrder(String sheetname, int pos ) {\n        workbook.setSheetOrder(sheetname, pos);\n    \tint sheetNumber = getSheetIndex(sheetname);\n    \t//remove the sheet that needs to be reordered and place it in the spot we want\n    \tsheets.add(pos, sheets.remove(sheetNumber));\t        \n    }"}, {"count": 3, "tags": [], "bug_id": 23951, "attachment_id": null, "text": "Here's a better workaround for using setSheetOrder() without using cloneSheet() \nmethod. The current open-source version will not \n\nsupport sheet cloning if the sheet has any embedded images or objects. As \nyou've probably found out, setSheetOrder() only swaps \n\nthe actual sheet content -- not the sheet's name. So you'll need to manually \nset that on your own.\n\nAs regards to the contents not swapping properly, try not to think about it \nas 'sheet 3 BEFORE sheet 1', but rather the opposite \n\ndirection. So if you write the code as:\n\n   workbook.setSheetName(sheetNameWhereIndexIsZero, 3); //this will work.\n\nAnyways, here's my arbitrary positioned workaround:\n\n//sheetName buffer.\nint intTotalSheet = workbbook.getNumberOfSheets();\nString[] straSheetName = new String[intTotalSheet];\n\t        \nfor (int b=0; b<intTotalSheet; b++)\n   straSheetName[b] = workbook.getSheetName(b);\n\t    \t    \nworkbook.setSheetName(intTotalSheet-1, \"newSheet\");\t      \t    \nworkbook.setSheetName(0, SHEET_NAME);\t      \t    \nfor(int a = 1; a < intTotalSheet; a++)\n{\n    workbook.setSheetName(a, straSheetName[a-1]);\n}\nworkbook.setSheetOrder(wb.getSheetName(0), intTotalSheet-1);", "id": 101065, "time": "2007-03-27T12:44:41Z", "creator": "lingjiao.chen@tcg.com", "creation_time": "2007-03-27T12:44:41Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 23951, "attachment_id": 20308, "text": "Created attachment 20308\npatch that fixes the tab order problem\n\nthe problem was in sheet serialization, hssf did not actually write the bound\nsheets from the bound sheets collection and thus the records were written in\nthe original order.  This probably affected new sheets and other things as\nwell.", "id": 104031, "time": "2007-06-04T06:51:24Z", "creator": "poi-support@buni.org", "creation_time": "2007-06-04T06:51:24Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 23951, "text": "fixed in HEAD Mon Jun  4 13:52:54 UTC 2007", "id": 104032, "time": "2007-06-04T06:54:00Z", "creator": "poi-support@buni.org", "creation_time": "2007-06-04T06:54:00Z", "is_private": false, "attachment_id": null}]