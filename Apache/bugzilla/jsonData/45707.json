[{"count": 0, "tags": [], "bug_id": 45707, "text": "Created attachment 22496\nMain File Created By using POI \n\nThere are two files.\n1) Test-Main.xls --> Created by POI HSSF(Attached).\n2) Test-Child.xls --> File create from excel software installed with Office.\n\nSteps to Reproduce\nEXCEL file created by POI(Test-Main.xls) as Biff8.0 doesn't work after linking CELLs to a master sheet created by excel opened using Microsoft Office(Test-Child.xls).\n\nRecreate steps:\nCase -1\n1. Open a brand new workbook, lets call it\"Test-Child.xls\", leave it empty and save it.\n2. Open File \"Test-Main.xls\" (find attached) created by using HSSF POI\n3. Copy G3 cell value from \"Test-Main.xls\"\n4. Do a Paste-Special-Link of those cells into \"Test-Child.xls\"\n5. Save and close both workbooks\n6. Open just \"Test-Child.xls\"\n7. You will be prompted that this sheet has links, click Update.\n8. It works fine.\n\nCase -2 \n1. Open a brand new workbook, lets call it \"Test-Child.xls\", leave it empty and save it.\n2. Open File \"Test-Main.xls\" (find attached) created by using HSSF POI\n3. Copy \"F3\" or \"G5\" cell value from \"Test-Main.xls\"\n4. Do a Paste-Special-Link of those cells into \"Test-Child.xls\"\n5. Save and close both workbooks\n6. Open just \"Test-Child.xls\"\n7. You will be prompted that this sheet has links, click Update.\n8. You will then get an error that the link Cannot be updated\n9. If you check the link staus you will see a note that the source sheet must be open.\n\n\nCase -3\n1. Open a brand new workbook, lets call it \"Test-Child.xls\", leave it empty and save it.\n2. Open File \"Test-Main.xls\" (find attached) created by using HSSF POI\n3. Copy \"F3\" or \"G5\" cell value from \"Test-Main.xls\"\n4. Do a Paste-Special-Link of those cells into \"Test-Child.xls\"\n5. Save and close both workbooks\n6. Open just \"Test-Child.xls\"\n7. You will be prompted that this sheet has links, click Update.\n8. You will then get an error that the link Cannot be updated\n9. If you check the link staus you will see a note that the source sheet must be open.\n10. Close the \"Test-Child.xls\" workbook.\n11. Open workbook \"Test-Main.xls\"\n12. Change the value of F3 or G5 cells and save t.\n13. Close the \"Test-Main.xls\" workbook.\n14. Open \"Test-Child.xls\" workbook. It opens without any error!!!", "id": 120181, "time": "2008-08-28T08:56:40Z", "creator": "techie.anirudh@gmail.com", "creation_time": "2008-08-28T08:56:40Z", "is_private": false, "attachment_id": 22496}, {"count": 1, "tags": [], "bug_id": 45707, "attachment_id": null, "text": "POI 2.5 is over 4 years old...\n\nPlease re-try with a recent version of POI, and re-open the bug if the problem still remains.", "id": 120184, "time": "2008-08-28T09:53:48Z", "creator": "apache@gagravarr.org", "creation_time": "2008-08-28T09:53:48Z", "is_private": false}, {"count": 2, "attachment_id": null, "bug_id": 45707, "is_private": false, "id": 120187, "time": "2008-08-28T10:37:46Z", "creator": "josh@apache.org", "creation_time": "2008-08-28T10:37:46Z", "tags": [], "text": "The supplied POI generated file + Case-2 causes my Excel(2007) to completely crash.\nRe-saving Test-Main.xls in Excel (even without changes) makes the problem go away. \n\nI couldn't reproduce the problem using latest svn trunk. So it looks like the bug was fixed (probably some time ago).\n\nI tried regenerating a similar file (plain number cells, plain text cells).  Here is the code I used:\n\nHSSFWorkbook wb = new HSSFWorkbook();\nHSSFSheet sheet = wb.createSheet(\"Sheet1\");\nsheet.createRow(0).createCell(1).setCellValue(123.456);\nsheet.createRow(1).createCell(1).setCellValue(new HSSFRichTextString(\"abc.def\"));\nOutputStream os= new FileOutputStream(\"c:/temp/ex45707-linkDest.xls\");\nwb.write(os);\nos.close();\n\nAfter similar steps to Case-2 (linking to a text cell), the child spreadsheet had this formula:\n='C:\\temp\\[ex45707-linkDest.xls]Sheet1'!$B$2\n\nRe-opening the child (after closing all) does not cause a crash like it did before.  I ran through a few other variations of these use cases just to make sure there were no other problems."}]