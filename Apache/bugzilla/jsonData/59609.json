[{"count": 0, "tags": [], "bug_id": 59609, "attachment_id": null, "is_private": false, "id": 191151, "time": "2016-05-21T03:45:24Z", "creator": "michael.chirlin@gmail.com", "creation_time": "2016-05-21T03:45:24Z", "text": "The JSONPathPostProcessor uses the follow to turn the JSON results to string, however if toJSONString isn't used then all of the quotes will be removed.\n\n\nCurrent Example\n\nWith this Code (JSONPostProcessor 166-167):\n\nObject obj = extractedValues.get(0);\nString objAsString = obj != null ? obj.toString() : \"\"; //$NON-NLS-1$\n\nRun with:\n\n$.context\n\nAgainst:\n\n{\n  \"context\": {\n    \"#v\": \"abc123\",\n    \"#t\": \"string\"\n  }\n}\n\nResults in:\n\n{#v: abc123, #t: string}\n\nThis is incorrect, all of the quotes have been removed.\n\nIt should be replaced with something more like:\n\nString objAsString = \"\";\nif (extractedValues instanceof JSONArray) {\n objAsString = new JSONObject((Map) extractedValues.get(0)).toJSONString();\n}\n\nWhich when tested results:\n\n{\"#t\":\"string\",\"#v\":\"abc123\"}\n\nThis obviously needs to be extended for examples where more than one response is returned."}, {"count": 1, "tags": [], "text": "Created attachment 33861\nExtract JSON Objects as JSON Strings\n\nExtract JSON Objects as JSON Strings.\n\nThe old implementation gave a Map instance back for the described case.", "attachment_id": 33861, "id": 191160, "creation_time": "2016-05-22T10:39:47Z", "time": "2016-05-22T10:39:47Z", "creator": "felix.schumacher@internetallee.de", "bug_id": 59609, "is_private": false}, {"count": 2, "tags": [], "text": "Created attachment 33862\nExtract JSON Objects as JSON Strings\n\nKeep PostProcessor clean by moving the stringification into the JSONManager.\n\nIt would be good, if the interface of JSONManager would show, that it returns a list of Strings. But as it is a public interface it seems to be to late to change it now.", "attachment_id": 33862, "id": 191161, "creation_time": "2016-05-22T11:29:59Z", "time": "2016-05-22T11:29:59Z", "creator": "felix.schumacher@internetallee.de", "bug_id": 59609, "is_private": false}, {"count": 3, "attachment_id": null, "creator": "michael.chirlin@gmail.com", "is_private": false, "id": 191174, "time": "2016-05-22T23:13:39Z", "bug_id": 59609, "creation_time": "2016-05-22T23:13:39Z", "tags": [], "text": "There is an additional use case in which the extractedObject is an instanceof JSONArray rather than a Map (JSONObject).\n\nI propose updating the JSONManager stringifyJSONObject the following:\n\nprivate String stringifyJSONObject(Object obj) {\n  if (obj instanceof JSONArray) {\n    return ((JSONArray) obj).toJSONString();\n  } else if (obj instanceof Map) {\n    return new JSONObject((Map<String, ?>) obj).toJSONString();\n  }\n  return obj == null ? \"\" : obj.toString(); //$NON-NLS-1$\n}\n\nAn example would be:\n\n{\n  \"saveInto\": [\n    \"string1\"\n  ]\n}\n\nusing JSONPath:\n\n$.saveInto\n\nI'm not sure how you create the attachments or I would do it for you."}, {"count": 4, "tags": [], "text": "Created attachment 33882\nExtract JSON Objects as JSON Strings\n\nMy old patch should have worked with your use case already. But to be on the safe side, I added the case for JSONArray.", "is_private": false, "bug_id": 59609, "id": 191237, "time": "2016-05-24T19:15:24Z", "creator": "felix.schumacher@internetallee.de", "creation_time": "2016-05-24T19:15:24Z", "attachment_id": 33882}, {"count": 5, "tags": [], "text": "Ok for patch.\nThanks Felix", "is_private": false, "bug_id": 59609, "id": 191323, "time": "2016-05-30T19:23:20Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2016-05-30T19:23:20Z", "attachment_id": null}, {"count": 6, "tags": [], "text": "Date: Tue May 31 18:19:48 2016\nNew Revision: 1746310\n\nURL: http://svn.apache.org/viewvc?rev=1746310&view=rev\nLog:\nFormat extracted JSON Objects in JSON Post Processor correctly as JSON.\n\nBugzilla Id: 59609\n\nAdded:\n    jmeter/trunk/test/src/org/apache/jmeter/extractor/TestJSONPostProcessor.java\nModified:\n    jmeter/trunk/src/components/org/apache/jmeter/extractor/json/jsonpath/JSONManager.java\n    jmeter/trunk/src/components/org/apache/jmeter/extractor/json/jsonpath/JSONPostProcessor.java\n    jmeter/trunk/xdocs/changes.xml", "is_private": false, "id": 191337, "creator": "felix.schumacher@internetallee.de", "time": "2016-05-31T18:21:16Z", "bug_id": 59609, "creation_time": "2016-05-31T18:21:16Z", "attachment_id": null}]