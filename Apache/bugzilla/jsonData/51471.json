[{"count": 0, "tags": [], "bug_id": 51471, "attachment_id": null, "id": 147728, "creation_time": "2011-07-04T18:33:00Z", "time": "2011-07-04T18:33:00Z", "creator": "tlhackque@yahoo.com", "text": "IndexIgnore does not seem to honor <DirectoryMatch> sections.\n\nIt appears that ignore_entry is doing a literal compare of the directory path rather than taking the RE of the DirectoryMatch into account.\n\nConsider a simple test case:\n /var/www/fancy/HEEDME exists, as does /var/www/fancy/sub/HEEDME\n\nAlias /fancy/ /var/www/fancy/\n<Directory \"/var/www/fancy\">\n  Options +Indexes\n  IndexOptions FancyIndexing FoldersFirst NameWidth=* SuppressDescription TrackModified\n  IndexIgnore README ..\n  Order Deny,Allow\n  Allow from all\n</Directory>\n<DirectoryMatch \"^/var/www/fancy/.+\">\n  IndexIgnore HEEDME\n</DirectoryMatch>\n\nHEEDME correctly appears in the autoindex of /fancy/\n\nHEEDME incorrectly appears in the autoindex of /fancy/sub/\n\nHowever, if the DirectoryMatch is replaced by:\n\n<Directory \"/var/www/fancy/sub\">\n  IndexIgnore HEEDME\n</Directory>\n\nHEEMDE disappears as expected.  \n\nGiven that in real life, there are many subdirectories (that come and go), this is a major annoyance since the .conf file has to include (and be updated) for each subdirectory.", "is_private": false}, {"count": 1, "tags": [], "text": "fixed in r1204341", "is_private": false, "id": 151680, "creator": "covener@gmail.com", "time": "2011-11-21T03:31:07Z", "bug_id": 51471, "creation_time": "2011-11-21T03:31:07Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "covener@gmail.com", "attachment_id": null, "id": 151682, "time": "2011-11-21T05:16:11Z", "bug_id": 51471, "creation_time": "2011-11-21T05:16:11Z", "is_private": false, "text": "this was reverted, needs more work"}, {"count": 3, "tags": [], "bug_id": 51471, "attachment_id": null, "id": 197273, "time": "2017-02-25T17:38:04Z", "creator": "ckhatton@gmail.com", "creation_time": "2017-02-25T17:38:04Z", "is_private": false, "text": "This also affects me. This is the case I am using...\n\n<DirectoryMatch \"^/var/www/html/projects/[^/]+/?$\">                                                                                     \n        IndexIgnore ..                                                                                                                  \n</DirectoryMatch>\n\nSpecifically 'IndexIgnore' does not work - Other options do work.\n\nIf I write the absolute path, like tlhackque@yahoo.com describes, it works.\n\n---\n\nI tried asking the public, but I reckon it is a bug.\n\nhttp://stackoverflow.com/questions/41792706/why-doesnt-indexignore-work-for-directorymatch"}, {"count": 4, "tags": [], "text": "I have a similar issue with IndexIgnore inside an If-clause.\n\n<Directory /var/www>\n  DAV on\n  ForceType text/plain\n  AddDefaultCharset utf-8\n  Options +Indexes +FollowSymLinks +MultiViews\n  IndexOptions FancyIndexing\n  IndexOptions SuppressHTMLPreamble\n  IndexOptions FoldersFirst\n  IndexOptions IconsAreLinks\n  HeaderName /html/header.html\n  ReadmeName /html/footer.html\n  <If \"-R '10.144.22.1/32'\">\n    IndexIgnore footer.html header.html README.TXT LIESMICH.TXT README.TXT~ LIESMICH.TXT~ Thumbs.db\n  </If>\n  <Else>\n    IndexIgnore restricted footer.html header.html README.TXT LIESMICH.TXT README.TXT~ LIESMICH.TXT~ Thumbs.db\n  </Else>\n<Directory>\n\nExpected:\nWhat it should do is to ignore the listed files. And if the remote address is 10.144.22.1 it should display \"restricted\" else it should also not list it in the index.\n\nWhat happens:\nNeither IndexIgnore is fired. All files in the directory are listed.\n\nIf I put IndexIgnore outside the If-clause it works as expected.\n\nI guess there is an issue with IndexIgnore inside some \"dynamic\"-tags similar to the one described here.", "is_private": false, "id": 197432, "creator": "alexander.reintzsch+bugzilla@gmail.com", "time": "2017-03-03T15:57:44Z", "bug_id": 51471, "creation_time": "2017-03-03T15:57:44Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 51471, "attachment_id": null, "id": 197435, "time": "2017-03-03T18:09:05Z", "creator": "covener@gmail.com", "creation_time": "2017-03-03T18:09:05Z", "is_private": false, "text": "> I guess there is an issue with IndexIgnore inside some \"dynamic\"-tags\n> similar to the one described here.\n\nYes, the implementation is very weird/complicated/unique in mod_autoindex.  \n\nMost modules don't care what path was associated with the config section some config came from, because you only ever see the relevant ones merged together. But autoindex is remembering and fussing with the old paths and the full path to the current request.\n\n<If has a dummy path just like DirectoryMatch.\n\nI don't know if perhaps it all of this is trying to allow something like IndexIgnore subdir/FOO.BAR that doesn't propogate.\n\nI apparently tried to resolve it once and had to revert it. I am tempted to just create a more basic IndexIgnore that you can opt into that is much simpler which removes the risk of regression."}]