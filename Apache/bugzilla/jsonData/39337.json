[{"count": 0, "tags": [], "creator": "sf@sfritsch.de", "is_private": false, "text": "When issuing a POST request over https through a proxy, jmeter adds the\nContent-Length: header fromo the POST request to the CONNECT request to the\nproxy. This is invalid. Some proxies (but not squid) will then wait for the\ncontent while jmeter waits for the \"200 Connection established\" message from the\nproxy. The connection hangs.\n\nA sample request from a tcpdump is attached.", "id": 88194, "time": "2006-04-18T11:50:22Z", "bug_id": 39337, "creation_time": "2006-04-18T11:50:22Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "sf@sfritsch.de", "attachment_id": 18124, "id": 88195, "time": "2006-04-18T11:54:58Z", "bug_id": 39337, "creation_time": "2006-04-18T11:54:58Z", "is_private": false, "text": "Created attachment 18124\nsample request"}, {"count": 2, "tags": [], "text": "Which HTTP sampler did you use - was that the default, or Apache HTTPClient?", "attachment_id": null, "id": 88673, "creator": "sebb@apache.org", "time": "2006-04-30T16:45:22Z", "bug_id": 39337, "creation_time": "2006-04-30T16:45:22Z", "is_private": false}, {"count": 3, "tags": [], "creator": "sf@sfritsch.de", "attachment_id": null, "id": 88720, "time": "2006-05-02T14:22:36Z", "bug_id": 39337, "creation_time": "2006-05-02T14:22:36Z", "is_private": false, "text": "(In reply to comment #2)\n> Which HTTP sampler did you use - was that the default, or Apache HTTPClient?\n\nWhere can I see that? I found \n\n<stringProp name=\"TestElement.test_class\">org.apache.jmeter.protocol.\nhttp.sampler.HTTPSampler</stringProp>\n\nin the test plan file."}, {"count": 4, "tags": [], "creator": "sebb@apache.org", "text": "It says \"HTTP Request HTTPClient\" on the GUI if you are using the new sampler, \notherwise just \"HTTP Request\"\n\nThe Apache classname is HTTPSampler2, so you are using the default (Java) \nsampler.\n\nDoes the problem also occur with HTTP requests?", "id": 88724, "time": "2006-05-02T16:38:07Z", "bug_id": 39337, "creation_time": "2006-05-02T16:38:07Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "text": "It works with http. In this case, it sends the POST request with all headers \ndirectly to the proxy server, which is correct. There is no CONNECT request \nwith http. ", "is_private": false, "id": 89162, "creator": "sf@sfritsch.de", "time": "2006-05-16T13:26:08Z", "bug_id": 39337, "creation_time": "2006-05-16T13:26:08Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 39337, "text": "The HTTPSampler does not do any special processing to handle proxy servers. It\ndoes not issue a CONNECT request, as far as I can see.\n\nThis is all handled by the Java HTTP implementation, so it would seem that the\nproblem is in the Java code.\n\nNot sure what to suggest.\n\nIt's possible that JMeter is generating the headers incorrectly for use with\nHTTPS over a proxy, but somehow the same headers are OK for HTTP+proxy.\n\nI've no idea what to change to fix this.", "id": 89227, "time": "2006-05-17T22:37:22Z", "creator": "sebb@apache.org", "creation_time": "2006-05-17T22:37:22Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "creator": "sf@sfritsch.de", "text": "Ohh, you are right, this is a java problem. After some more googling I found \nthese bug reports:\n\nhttp://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6226610\nhttp://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6208335\n\nThe first one seems to imply that it is fixed in java 1.5.\n\nThanks for looking into it.", "id": 89307, "time": "2006-05-20T07:47:52Z", "bug_id": 39337, "creation_time": "2006-05-20T07:47:52Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "creator": "sebb@apache.org", "attachment_id": null, "id": 89308, "time": "2006-05-20T08:31:25Z", "bug_id": 39337, "creation_time": "2006-05-20T08:31:25Z", "is_private": false, "text": "Thanks for the bug pointers. I'll see about adding a note to the documentation.\n\nIf you can't upgrade to 1.5, or that does not work either, you could try using\nthe Apache HTTPClient implementation instead. There are some issues with this in\n2.1.1 which are fixed in the current nightly, so you may need to use that."}, {"count": 9, "tags": [], "creator": "sebb@apache.org", "text": "Updated Changes/\"known bugs\" to reference this bug.", "id": 106930, "time": "2007-08-20T05:17:37Z", "bug_id": 39337, "creation_time": "2007-08-20T05:17:37Z", "is_private": false, "attachment_id": null}]