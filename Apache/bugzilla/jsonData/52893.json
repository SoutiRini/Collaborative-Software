[{"attachment_id": 28456, "tags": [], "creator": "christophe.jaillet@wanadoo.fr", "text": "Created attachment 28456\nProposed patch\n\nHi, here is a set of small modification that improve a bit, IMO, the source code.\nFeel free to merge it to trunk or not.\n\nHope this helps.\nBest regards,\n\nCJ\n\n=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=\n\n modules/aaa/mod_authz_core.c  |    9 +++------\n modules/http/http_protocol.c  |    8 ++------\n modules/lua/mod_lua.c         |    7 +++----\n modules/proxy/mod_proxy_ftp.c |    7 +++----\n modules/proxy/proxy_util.c    |    2 +-\n modules/session/mod_session.c |    2 +-\n modules/test/mod_policy.c     |    9 ++++++---\n server/core.c                 |    4 ++--\n server/provider.c             |    4 ++--\n 9 files changed, 23 insertions(+), 29 deletions(-)\n\n=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=\n\nmodules/lua/mod_lua.c\n   - concat a call to apr_snprintf followed by apr_pstrcat into a single apr_psprintf in order to improve readability.\n\n\nmodules/session/mod_session.c\n   - there is no need to call apr_pstrcat in order to strcat only one string ! Use apr_pstrdup instead\n\n\nmodules/proxy/mod_proxy_ftp.c\n   - no need to use a local variable here, do it the same way as for 'user' a few line above\n   - no need to call apr_pstrcat to concat string literal. Do a direct assignment as two lines below\n\n\nmodules/aaa/mod_authz_core.c\n   - reorder the way the message is generated in order to avoid a call to apr_pstrcat. This way of building the error message is much more consistent with the rest of the code source\n\n\nmodules/proxy/proxy_util.c\n   - no need to apr_pstrdup constant string here\n\n\nmodules/http/http_protocol.c\n   - remove a spurious comment. TRACE seems to be handled only if (conf->trace_enable != AP_TRACE_DISABLE)\n   - all allowed methods are collected into a apr array, so why not use it untill the end of the function ? Remove \"recursive\" calls to apr_pstrcat in order to same memory and improve readability\n\n\nmodules/test/mod_policy.c\n   - do not have nested apr_pstrcat calls, because it duplicates memory. Reorder the code to improve readability instead.\n\n\nserver/core.c\n   - build IPv6 server name as in other parts on the code. prefer \n   - formatting (missing spaces)\n\n\nserver/provider.c\n   - do not ask for a parameter that it not used", "count": 0, "id": 154849, "time": "2012-03-12T21:38:47Z", "bug_id": 52893, "creation_time": "2012-03-12T21:38:47Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "sf@sfritsch.de", "text": "Thank. Committed as r1361801 with some more tweaks:\n\nmodules/http/http_protocol.c: further simplification\nmodules/test/mod_policy.c: further simplification\nmodules/proxy/mod_proxy_ftp.c: revert one part because it causes compiler warning about discarded constness", "count": 1, "id": 160657, "time": "2012-07-15T21:15:56Z", "bug_id": 52893, "creation_time": "2012-07-15T21:15:56Z", "is_private": false}]