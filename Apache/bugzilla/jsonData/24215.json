[{"count": 0, "tags": [], "bug_id": 24215, "text": "Excel sheet processing fails and causes:\n\njava.lang.RuntimeException: UnImplemented Celltype -1\n        at org.apache.poi.hssf.record.aggregates.ValueRecordsAggregate.construct\nRecord(ValueRecordsAggregate.java:361)\n        at org.apache.poi.hssf.record.aggregates.ValueRecordsAggregate.getCell(V\nalueRecordsAggregate.java:98)\n        at org.apache.poi.hssf.model.Sheet.getValueRecord(Sheet.java:557)\n        at org.apache.poi.hssf.usermodel.HSSFRow.getCell(HSSFRow.java:325)\n        at bug.ExcelBug.main(ExcelBug.java:27) \n\nSample file is provided an attachment.\n\nSample code:\n-------------------------\n\npackage bug;\n\nimport java.io.FileInputStream;\n\nimport org.apache.poi.hssf.usermodel.HSSFCell;\nimport org.apache.poi.hssf.usermodel.HSSFRow;\nimport org.apache.poi.hssf.usermodel.HSSFSheet;\nimport org.apache.poi.hssf.usermodel.HSSFWorkbook;\n\npublic class ExcelBug {\n    \n    public static void main(String args[]) {\n        try {\n            HSSFWorkbook wb = new HSSFWorkbook(new FileInputStream\n(\"test.xls\")); \n    \n            for (int sheetIndex = 0; sheetIndex < wb.getNumberOfSheets(); \nsheetIndex++) {\n                HSSFSheet sheet = wb.getSheetAt(sheetIndex);\n                int rows = sheet.getLastRowNum();\n    \n                for (int rowIndex = 0; rowIndex < rows; rowIndex++) {\n                    \n            \n                    HSSFRow row = sheet.getRow(rowIndex);\n                    int cells = row.getLastCellNum();\n    \n                    for (short cellIndex = 0; cellIndex < cells; cellIndex++) {\n                        HSSFCell cell  = row.getCell(cellIndex);\n                    }\n                }\n            }\n            \n        } catch(Throwable t) {\n            t.printStackTrace();\n        }\n        \n    }\n}", "id": 46433, "time": "2003-10-29T12:31:22Z", "creator": "poi@solita.fi", "creation_time": "2003-10-29T12:31:22Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "poi@solita.fi", "attachment_id": 8801, "id": 46434, "time": "2003-10-29T12:33:00Z", "bug_id": 24215, "creation_time": "2003-10-29T12:33:00Z", "is_private": false, "text": "Created attachment 8801\nHandling of this excel document fails"}, {"count": 2, "tags": [], "bug_id": 24215, "text": "Works with latest CVS. testcase added. ", "id": 46510, "time": "2003-10-30T16:27:25Z", "creator": "avik@apache.org", "creation_time": "2003-10-30T16:27:25Z", "is_private": false, "attachment_id": null}]