[{"count": 0, "tags": [], "text": "Created attachment 32171\nThe file used in my tests\n\nSame use case as in bug #57165.\n\nTo keep only a selected sheet, I have to move it at first position, then delete the others.\nBut if this sheet is the active one (or, perhaps, the selected one), Excel 2010 then complains about the file it opens.\n\nLooking at the file it points out, I found out that the reference to the active sheet has not been updated, so it points now to a non-existing sheet.\n\nFrench Excel error message is:\nEnregistrements supprim\u00e9s: Affichage dans la partie /xl/workbook.xml (Classeur)\n\nwhich can be roughly translated to:\nRemoved records: Display in the /xl/workbook.xml part (Workbook)\n\nWhen I open the pointed out file, I see:\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<workbook xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\"><fileVersion appName=\"xl\" lastEdited=\"5\" lowestEdited=\"5\" rupBuild=\"9303\"/><workbookPr filterPrivacy=\"1\" defaultThemeVersion=\"124226\"/><bookViews><workbookView xWindow=\"120\" yWindow=\"210\" windowWidth=\"21075\" windowHeight=\"7680\" activeTab=\"5\"/></bookViews><sheets><sheet name=\"Informative\" sheetId=\"7\" r:id=\"rId6\"/></sheets><calcPr calcId=\"125725\"/></workbook>\n\nNotice the activeTab=\"5\" part.\nAlso notice the sheetId=\"7\" r:id=\"rId6\" part, which might be part of the bug above mentioned.", "is_private": false, "id": 178859, "creator": "PhiLho@GMX.net", "time": "2014-10-31T11:25:17Z", "bug_id": 57171, "creation_time": "2014-10-31T11:25:17Z", "attachment_id": 32171}, {"count": 1, "tags": [], "text": "Created attachment 32175\nShow bugs", "attachment_id": 32175, "bug_id": 57171, "id": 178863, "time": "2014-10-31T11:30:50Z", "creator": "PhiLho@GMX.net", "creation_time": "2014-10-31T11:30:50Z", "is_private": false}, {"count": 2, "tags": [], "text": "Added a standalone class that loads the sample Excel file and reproduce the bugs (three bugs are shown, I numbered them with the Bugzilla id).\nYou might need to adjust the path to the sample.", "is_private": false, "id": 178865, "creation_time": "2014-10-31T11:33:04Z", "time": "2014-10-31T11:33:04Z", "creator": "PhiLho@GMX.net", "bug_id": 57171, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 57171, "attachment_id": 32199, "is_private": false, "id": 179014, "time": "2014-11-09T22:20:33Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2014-11-09T22:20:33Z", "text": "Created attachment 32199\nProposed fix which adjusts the active sheet in setSheetOrder() and removeSheet()\n\nFYI, I have a proposed fix for this and bug 57163, but would like to postpone checkin until after release 3.11 as it runs a slight risk of breaking stuff."}, {"count": 4, "tags": [], "bug_id": 57171, "attachment_id": null, "is_private": false, "id": 179931, "time": "2014-12-22T09:00:51Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2014-12-22T09:00:51Z", "text": "Fixed this and Bug 57163 via r1647264"}]