[{"count": 0, "tags": [], "bug_id": 42002, "attachment_id": null, "is_private": false, "id": 101255, "time": "2007-03-30T14:19:04Z", "creator": "bruno.haleblian@free.fr", "creation_time": "2007-03-30T14:19:04Z", "text": "Hi,\nAs I upgraded from 1.2.19 to 1.2.21, I hit the following regression :\na Wrong [emerg] \"Error in reading worker properties\" is thrown because I don't\nhave any JkWorkersFile defined.\nmod_jk.c should silently accept this, while the second part of test about empty\nmap looks correct.\nI suggest following fix (wich works for me but may need more test) :\n\n--- mod_jk.c.orig       2007-02-26 20:09:41.000000000 +0100\n+++ mod_jk.c    2007-03-30 22:47:31.000000000 +0200\n@@ -2658,17 +2658,16 @@\n     jk_set_worker_def_cache_size(mpm_threads);\n\n     /*     if(map_alloc(&init_map)) { */\n-    if (!jk_map_read_properties(init_map, conf->worker_file, NULL, 1, conf->log)) {\n-        if (jk_map_size(init_map) == 0) {\n-            ap_log_error(APLOG_MARK, APLOG_STARTUP | APLOG_CRIT,\n-                         0, NULL,\n-                         \"No worker file and no worker options in httpd.conf\"\n-                         \"use JkWorkerFile to set workers\");\n-        }\n+    if ((conf->worker_file!=NULL) && !jk_map_read_properties(init_map,\nconf->worker_file, NULL, 1, conf->log)) {\n         ap_log_error(APLOG_MARK, APLOG_EMERG | APLOG_NOERRNO, 0, NULL, \"Error\nin reading worker properties\");\n         return !OK;\n     }\n-\n+    if (jk_map_size(init_map) == 0) {\n+        ap_log_error(APLOG_MARK, APLOG_STARTUP | APLOG_CRIT,\n+                     0, NULL,\n+                     \"No worker file and no worker options in httpd.conf\"\n+                     \"use JkWorkerFile to set workers\");\n+    }\n     if (jk_map_resolve_references(init_map, \"worker.\", 1, 1, conf->log) ==\nJK_FALSE) {\n         ap_log_error(APLOG_MARK, APLOG_EMERG | APLOG_NOERRNO, 0, NULL, \"Error\nin resolving configuration references\");\n         return !OK;"}, {"count": 1, "tags": [], "bug_id": 42002, "attachment_id": null, "text": "Some more data about my platform may helps :\n32bits RedHat ES4 Update4 (Linux 2.6.9-42.ELsmp) - Apache/2.0.52 - \"worker\" mode", "id": 101256, "time": "2007-03-30T14:33:11Z", "creator": "bruno.haleblian@free.fr", "creation_time": "2007-03-30T14:33:11Z", "is_private": false}, {"count": 2, "text": "\n\n*** This bug has been marked as a duplicate of 41770 ***", "bug_id": 42002, "attachment_id": null, "id": 101262, "time": "2007-03-31T00:00:53Z", "creator": "mturk@apache.org", "creation_time": "2007-03-31T00:00:53Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 42002, "attachment_id": null, "text": "(In reply to comment #2)\n> \n> *** This bug has been marked as a duplicate of 41770 ***\n\nOops for not reading BZDB correctly, just missed it, sorry!\nGrepping the die message took so close to this quick fix...", "id": 101266, "time": "2007-03-31T06:23:07Z", "creator": "bruno.haleblian@free.fr", "creation_time": "2007-03-31T06:23:07Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 42002, "attachment_id": null, "is_private": false, "id": 112414, "time": "2008-01-01T17:03:43Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2008-01-01T17:03:43Z", "text": "Move a couple of fixed JK issues from resolved to closed."}]