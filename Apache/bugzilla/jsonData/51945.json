[{"count": 0, "tags": [], "bug_id": 51945, "attachment_id": null, "id": 150106, "creation_time": "2011-10-04T00:08:08Z", "time": "2011-10-04T00:08:08Z", "creator": "rpi_alum@yahoo.com", "text": "Unable to include sample document due to sensitive nature.\n\nSomehow one of my documents is ending up with a negative style index.  File opens successfully in Word 2010, and appears to be a Wrod97-2003 document.\n\nI tried adding an OR check with the greater than length to return NULL values when the index was less than zero. But it would then fail on the getStyleDescription() call.\n\nif ( styleIndex >= _styleDescriptions.length || styleIndex  < 0)\n{\n   return NIL_CHP;\n}\n\nStack Trace (Daily Build):\nCaused by: java.lang.ArrayIndexOutOfBoundsException: -2560\n\tat org.apache.poi.hwpf.model.StyleSheet.getCharacterStyle(StyleSheet.java:325)\n\tat org.apache.poi.hwpf.model.CHPX.getCharacterProperties(CHPX.java:74)\n\tat org.apache.poi.hwpf.usermodel.CharacterRun.<init>(CharacterRun.java:98)\n\tat org.apache.poi.hwpf.usermodel.Range.getCharacterRun(Range.java:853)\n\tat org.apache.poi.hwpf.model.PicturesTable.getAllPictures(PicturesTable.java:208)\n\tat org.apache.tika.parser.microsoft.WordExtractor$PicturesSource.<init>(WordExtractor.java:502)\n\tat org.apache.tika.parser.microsoft.WordExtractor$PicturesSource.<init>(WordExtractor.java:492)\n\tat org.apache.tika.parser.microsoft.WordExtractor.parse(WordExtractor.java:81)\n\tat org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:200)\n\tat org.apache.tika.", "is_private": false}, {"count": 1, "tags": [], "bug_id": 51945, "text": "Jeremy,\n\nDoes file passes binary format validation?\n\nSee here for details: \nhttp://blogs.msdn.com/b/officeinteroperability/archive/2011/07/12/microsoft-office-binary-file-format-validator-is-now-available.aspx", "id": 163234, "time": "2012-11-06T16:33:03Z", "creator": "vlsergey@gmail.com", "creation_time": "2012-11-06T16:33:03Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 51945, "text": "No update for a long time, therefore I am closing this, please reopen with more information if this is still a problem for you.", "id": 188417, "time": "2016-02-14T18:52:02Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-02-14T18:52:02Z", "is_private": false, "attachment_id": null}]