[{"count": 0, "tags": [], "bug_id": 29347, "attachment_id": null, "id": 58571, "time": "2004-06-02T18:44:22Z", "creator": "jwoehr@absolute-performance.com", "creation_time": "2004-06-02T18:44:22Z", "is_private": false, "text": "I was just adding  to the Ant Wiki AntOddities page the following macrodef :\n\n     <!-- Allows you define a new property with a value of ${${a}.${b}} which\ncan't be done by the Property task alone.  -->\n         <macrodef name=\"macro.compose-property\">\n             <attribute name=\"name\"/>\n             <attribute name=\"stem\"/>\n             <attribute name=\"selector\"/>\n             <sequential>\n                 <property name=\"@{name}\" value=\"${@{stem}.@{selector}}\"/>\n             </sequential>\n         </macrodef>\n\nI wrote a quick counter-example which shows how expansions of properties in Ant\nis not recursive:\n\n     <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n     <project basedir=\".\" default=\"all\" name=\"changeme\">\n         <target name=\"all\">\n             <property name=\"a\" value=\"arf\"/>\n             <property name=\"b\" value=\"bark\"/>\n             <property name=\"arf.bark\" value=\"woof woof woof\"/>\n             <echo message=\"${${a}.${b}}\"/>\n         </target>\n     </project>\n\nbut when I ran it, in Ant version 1.7 alpha built from CVS last night,  instead\nof getting the  unexpanded value of\nthe overall expression which I expected:\n\n     [echo] ${${a}.${b}}\n\nI received the unexpected:\n\n     [echo] ${${a}.bark}\n\nThis does not seem to me to be correct by the rules of Ant. Either the internal\nexpansion should be complete or not at all ... the right term should not expand\nand leave the left unexpanded. It seems to me the expected answer was the one\nreturned by Ant version 1.6.1 but I don't have that built now to see if the\ncurrent behavior is a regression."}, {"count": 1, "tags": [], "bug_id": 29347, "text": "\nWell, the whole reason for not having nested property expansion is that the \nparser does not do recursive nesting of brakets, which means that it cannot\ndetect that you are in a nested situation. It it were able to detect the case,\nthen I am almost certain we would allow nested expansion instead forbid it.\n\nLooking at your example, you have:\n   ${${a}.${b}}\nthe syntax for a property is: <prop> --> '${' <name>'}'  and <name> --> [^}]*\n\nwhich means the above gets interpreted as:\n  '${' \"${a\" '}' '.' '${' \"b\" '}' '}'\n- property \"${a\" does not exist so it is printed out textually\n- property \"b\" does exists, hence it is expanded\n\nIf we change this to understand recursion, we may as well do nested expansions.\n\n\n", "id": 58612, "time": "2004-06-03T10:32:58Z", "creator": "j_a_fernandez@yahoo.com", "creation_time": "2004-06-03T10:32:58Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "jwoehr@absolute-performance.com", "text": "I've done a sample enhancement to allow recursive property expansion. See\nattachments.", "id": 58659, "attachment_id": null, "bug_id": 29347, "creation_time": "2004-06-03T19:03:57Z", "time": "2004-06-03T19:03:57Z", "is_private": false}, {"text": "Created attachment 11753\nA patch which along with a new file adds recursive property expansion ... messier patch file than the actual changes warrant since I reformatted the file in NetBeans.", "tags": [], "bug_id": 29347, "is_private": false, "count": 3, "id": 58660, "time": "2004-06-03T19:06:21Z", "creator": "jwoehr@absolute-performance.com", "creation_time": "2004-06-03T19:06:21Z", "attachment_id": 11753}, {"count": 4, "tags": [], "creator": "jwoehr@absolute-performance.com", "attachment_id": 11754, "text": "Created attachment 11754\nThis new file accompanies the PropertyHandler.java patch and goes in ..ant/util", "id": 58661, "time": "2004-06-03T19:07:19Z", "bug_id": 29347, "creation_time": "2004-06-03T19:07:19Z", "is_private": false}, {"text": "Created attachment 11755\nTest case to illustrate recursive property expansion", "tags": [], "creator": "jwoehr@absolute-performance.com", "is_private": false, "count": 5, "id": 58662, "time": "2004-06-03T19:08:08Z", "bug_id": 29347, "creation_time": "2004-06-03T19:08:08Z", "attachment_id": 11755}, {"count": 6, "tags": [], "creator": "peter.reilly@corvil.com", "attachment_id": null, "is_private": false, "id": 58909, "time": "2004-06-09T08:33:45Z", "bug_id": 29347, "creation_time": "2004-06-09T08:33:45Z", "text": "Changing title to reflect the recursive patch\nand making this an enhancement"}, {"count": 7, "tags": [], "creator": "jwoehr@absolute-performance.com", "attachment_id": null, "is_private": false, "id": 59931, "time": "2004-06-27T04:28:51Z", "bug_id": 29347, "creation_time": "2004-06-27T04:28:51Z", "text": "In a recent message\n(http://marc.theaimsgroup.com/?l=ant-user&m=108819303623796&w=2) to the users@\nmailing list, Wascally Wabbit proposes a fix in my proposed patch to the file\nant/PropertyHelper.java. His fix is added to my patch and the new patch for that\none file is being attached to this report."}, {"count": 8, "tags": [], "bug_id": 29347, "is_private": false, "id": 59932, "creation_time": "2004-06-27T04:30:31Z", "time": "2004-06-27T04:30:31Z", "creator": "jwoehr@absolute-performance.com", "text": "Created attachment 11961\nPatch for file PropertyHelper.java that replaces my previous suggested patch and incorporates Wascally Wabbit's bug fix to the proposed patch", "attachment_id": 11961}, {"count": 9, "tags": [], "creator": "mguillemot@yahoo.fr", "is_private": false, "id": 104070, "attachment_id": null, "bug_id": 29347, "creation_time": "2007-06-05T04:59:39Z", "time": "2007-06-05T04:59:39Z", "text": "I think that \"Nested property expansion\" would be a better title because ${foo}\nshould evaluate to \"red green ${blue}\" if it is the value of the foo property no\nmatter if a property \"blue\" exists or not.\n\nWhy is this issue still opened and no committer has reacted since nearly 3 years?\n\nBecause this is a useful feature, WebTest (probably the project that makes the\nmost intensive usage of Ant) now performs nested properties evaluation during\ntest execution."}, {"count": 10, "tags": [], "creator": "alexeys@inventigo.com", "attachment_id": null, "is_private": false, "id": 104108, "time": "2007-06-05T18:49:42Z", "bug_id": 29347, "creation_time": "2007-06-05T18:49:42Z", "text": "Partly because there is <scriptdef> that can do anything without even touching\nANT core itself."}, {"count": 11, "tags": [], "bug_id": 29347, "text": "I think this has been superseeded by 1.8.x's PropertyHelpers and the props Antlib - I'd even close this issue if the props Antlib had been released ...", "id": 172126, "time": "2014-01-06T20:15:35Z", "creator": "bodewig@apache.org", "creation_time": "2014-01-06T20:15:35Z", "is_private": false, "attachment_id": null}, {"count": 12, "tags": [], "bug_id": 29347, "is_private": false, "id": 172127, "creation_time": "2014-01-06T20:23:17Z", "time": "2014-01-06T20:23:17Z", "creator": "jwoehr@absolute-performance.com", "text": "Hi Stefan ... Interesting to be discussing this 9.5 years later :) I will have to examine the props antlib ... thanks!", "attachment_id": null}, {"count": 13, "tags": [], "bug_id": 29347, "text": "Hi Jack, true, I must admit it felt a bit strange to me as well.", "id": 172135, "time": "2014-01-07T05:41:34Z", "creator": "bodewig@apache.org", "creation_time": "2014-01-07T05:41:34Z", "is_private": false, "attachment_id": null}]