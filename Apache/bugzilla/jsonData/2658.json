[{"count": 0, "tags": [], "creator": "david.hay@ecosse.net", "attachment_id": null, "text": "Tomcat fails on AIX when loading classes in Struts application on start up (see \ntrace below).  Works fine on other platforms.  Problem is loading classes \nspecified in web.xml using '/' as a separator.\n\nHad same problem back in 3.1, and fixed it by changing call to defineClass() in \nAdaptiveClassLoader, line 436, to call using dotted name (ie replace all /'s \nwith .'s).  The Java API specifically says that the name must be dotted, not \nslashed.\n\nIn 3.3m2, had to change DependClassLoader.java, line 134.  Here call is to \nClassLoader.loadClass(), which API does not explicitly say needs dotted name, \nbut by changing the /'s to .'s, it worked fine  ie\n\n         String dotname = name.replace('/', '.');\n         c = parent.loadClass(dotname);\n         if (c != null)\n         {\n            if (resolve) resolveClass(c);\n            dependency( c, res );\n            return c;\n         }\n\nNote: this was tested in 3.3m2, but I check the source code in 3.3m4, and it is \nthe same.\n\nTrace:\n\n2001-07-17 10:23:00 - ContextXmlReader: Context config=$TOMCAT_HOME/conf/apps-\n127.0.0.1.xml\n2001-07-17 10:23:00 - ContextXmlReader: Context config=$TOMCAT_HOME/conf/apps-\nadmin.xml\n2001-07-17 10:23:00 - ContextXmlReader: Context config=$TOMCAT_HOME/conf/apps-\nexamples.xml\n2001-07-17 10:23:00 - AutoWebApp: Already loaded: DEFAULT:/admin\n2001-07-17 10:23:00 - AutoWebApp: Already loaded: DEFAULT:/examples\n2001-07-17 10:23:00 - AutoWebApp: Auto-Adding DEFAULT:/\n2001-07-17 10:23:00 - AutoWebApp: Auto-Adding DEFAULT:/messenger\n2001-07-17 10:23:01 - ContextManager: Adding  DEFAULT:/admin\n2001-07-17 10:23:01 - ContextManager: Adding  DEFAULT:/examples\n2001-07-17 10:23:01 - ContextManager: Adding  DEFAULT:/ROOT\n2001-07-17 10:23:01 - ContextManager: Adding  DEFAULT:/messenger\n2001-07-17 10:23:03 - Ctx(/messenger) : Form login without form pages, \ndefaulting to basic /jsp/security/login.jsp null\n2001-07-17 10:23:03 - Http10Interceptor: Starting on 8080\n2001-07-17 10:23:03 - Ajp12Interceptor: Starting on 8007\n2001-07-17 10:23:03 - Ajp13Interceptor: Starting on 8009\n2001-07-17 10:23:12 - Ctx(/messenger) : Exception in preInit  Servlet/Action - \njava.lang.ClassNotFoundException: Servlet/Action\n\tat org.apache.tomcat.util.depend.DependClassLoader.loadClass\n(DependClassLoader.java:144)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:257)\n\tat org.apache.tomcat.facade.ServletHandler.getServlet\n(ServletHandler.java:342)\n\tat org.apache.tomcat.facade.ServletHandler.preInit\n(ServletHandler.java:402)\n\tat org.apache.tomcat.facade.ServletHandler.init(ServletHandler.java:231)\n\tat org.apache.tomcat.facade.ServletHandler.service\n(ServletHandler.java:435)\n\tat org.apache.tomcat.core.ContextManager.internalService\n(ContextManager.java:788)\n\tat org.apache.tomcat.core.ContextManager.service\n(ContextManager.java:701)\n\tat org.apache.tomcat.modules.server.Http10Interceptor.processConnection\n(Http10Interceptor.java:143)\n\tat org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java\n(Compiled Code))\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:497)\n\tat java.lang.Thread.run(Thread.java:498)\n\nDavid Hay", "id": 3780, "time": "2001-07-17T13:25:13Z", "bug_id": 2658, "creation_time": "2001-07-17T13:25:13Z", "is_private": false}, {"attachment_id": 329, "tags": [], "bug_id": 2658, "text": "Created attachment 329\nProposed patch", "count": 1, "id": 3781, "time": "2001-07-17T13:35:22Z", "creator": "david.hay@ecosse.net", "creation_time": "2001-07-17T13:35:22Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 2658, "attachment_id": 330, "is_private": false, "id": 3782, "time": "2001-07-17T13:36:10Z", "creator": "david.hay@ecosse.net", "creation_time": "2001-07-17T13:36:10Z", "text": "Created attachment 330\nProposed patch for Tomcat 3.1"}, {"attachment_id": null, "tags": [], "bug_id": 2658, "text": "I don't understand this - how does the class name ends up with \"/\" separator ???\nIt isn't supposed to happen - it's a bug in the declaration.", "count": 3, "id": 3789, "time": "2001-07-17T22:11:27Z", "creator": "cmanolache@yahoo.com", "creation_time": "2001-07-17T22:11:27Z", "is_private": false}]