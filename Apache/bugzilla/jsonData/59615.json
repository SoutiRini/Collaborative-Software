[{"count": 0, "tags": [], "text": "Created attachment 33864\npossible fix\n\nThis used to work in version <= 2.4.16. From 2.4.17 it gives following error:\n\n[Mon May 09 13:48:16.851313 2016] [ssl:emerg] [pid 26389:tid 1] AH01903: Failed to configure CA certificate chain!\n[Mon May 09 13:48:16.851430 2016] [ssl:emerg] [pid 26389:tid 1] AH02312: Fatal error initialising mod_ssl, exiting. \n\n--\n\nTo reproduce the issue add:\n\nSSLCertificateChainFile \"/path/to/attached/file\" \n\n--\n\nwhere the file looks like:\n\n-----BEGIN CERTIFICATE-----\n[some data..]\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\n[some data..]\n-----END CERTIFICATE-----\n\n--\n\nThe error is spotted in code here:\n\nhttpd-2.4.20/modules/ssl/ssl_engine_init.c:static int use_certificate_chain\n\n888    /* Make sure that only the error is just an EOF */\n889    if ((err = ERR_peek_error()) > 0) {\n890        if (!(   ERR_GET_LIB(err) == ERR_LIB_PEM\n891              && ERR_GET_REASON(err) == PEM_R_NO_START_LINE)) {\n892            BIO_free(bio);\n893            return -1;\n894        }\n\nBut it was actually generated long time ago:\n\nhttpd-2.4.20/modules/ssl/mod_ssl.c:static int ssl_hook_pre_config\n\n355    if (OBJ_txt2nid(\"id-on-dnsSRV\") == NID_undef) {\n\nIt sets:\n\nERR_GET_LIB = ERR_LIB_ASN1\nERR_GET_REASON = PEM_R_KEYBLOB_HEADER_PARSE_ERROR  \n\n(the error is generated from a2d_ASN1_OBJECT which is called from OBJ_txt2nid)\n\nThis can fixed by calling ERR_clear_error (see attached patch).\n\nThe problem was probably introduced with:\nhttp://svn.apache.org/viewvc?view=revision&revision=1706006", "is_private": false, "id": 191180, "creation_time": "2016-05-23T08:50:14Z", "time": "2016-05-23T08:50:14Z", "creator": "petr.sumbera@oracle.com", "bug_id": 59615, "attachment_id": 33864}]