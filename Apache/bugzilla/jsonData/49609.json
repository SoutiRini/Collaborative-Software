[{"count": 0, "tags": [], "bug_id": 49609, "text": "Created attachment 25777\nXLSX file that can't be opened with POI 3.7-dev\n\nAttempting to open the attached file fails with the following error:\n\nException in thread \"main\" org.apache.poi.openxml4j.exceptions.InvalidFormatException: Package should contain a content type part [M1.13]\n\tat org.apache.poi.openxml4j.opc.ZipPackage.getPartsImpl(ZipPackage.java:147)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.getParts(OPCPackage.java:588)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.open(OPCPackage.java:222)\n\tat org.apache.poi.ss.usermodel.WorkbookFactory.create(WorkbookFactory.java:63)\n\nThe file opens normally in Microsoft Excel 2008 for Mac.  If the file is saved as a Microsoft 97 file, POI opens it normally.\n\nThe file is from a non-standard source (a scientific instrument that saves its output as an .xlsx file).  The file contains a part name \"[content_types].xml\" (lower case), but the ZipPackage.getPartsImpl method expects the name \"[Content_Types].xml\" (mixed case).\n\nThe exception is caused by a call to entry.getName().equals(ContentTypeManager.CONTENT_TYPES_PART_NAME).  According to the Open Packaging Convention, \"Part name equivalence is determined by comparing part names as case-insensitive ASCII strings.\"\n\nThe bug also occurs in Windows XP.", "id": 138491, "time": "2010-07-16T18:53:24Z", "creator": "ebeaty@eragen.com", "creation_time": "2010-07-16T18:53:24Z", "is_private": false, "attachment_id": 25777}, {"count": 1, "tags": [], "creator": "yegor@dinom.ru", "is_private": false, "text": "Fixed in r965258\n\nThere were two problems with the attached file:\n\n1. [content_types].xml vs [Content_Types].xml \n\nYou are correct, the comparison of part names should be case-insensitive. \n\n2. The file appears to use backslashes as path separators. \n\nThe OPC spec tolerates backslashes in part names, see Annex A.3. I fixed POI to do the same.\n\nYegor", "id": 138501, "time": "2010-07-18T12:14:22Z", "bug_id": 49609, "creation_time": "2010-07-18T12:14:22Z", "attachment_id": null}]