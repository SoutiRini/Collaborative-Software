[{"count": 0, "tags": [], "text": "Created attachment 34894\nReproducer war\n\nWhen you try to use references to local xslt files inside same deployment.\nYou can get error when creating XML Transformer as transformer factory doesn't have URI resolver set to be able to recognize jstl protocol.\n\nReproducer \"test.war\" is attached.\nPart of code that makes it fail:\n\ntest.jsp:\n------------\n<c:import var=\"xslStylesheet\" url=\"/xsl/style.xsl\" charEncoding=\"UTF-8\" />\n<c:import url=\"http://localhost:8080/test/test.xml\" var=\"doc\"/>\n<x:transform xml=\"${doc}\" xslt=\"${xslStylesheet}\" xsltSystemId=\"/xsl/\">\n</x:transform> \n\nstyle.xsl\n---------------\n<?xml version=\"1.0\"?>\n<xsl:stylesheet xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"\n                xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n                version=\"1.0\">\n\n    <xsl:import href=\"parent.xsl\"/>\n...\n\nresults in\njavax.xml.transform.TransformerException: Had IO Exception with stylesheet file: parent.xsl\n\t   at org.apache.xalan.processor.TransformerFactoryImpl.newTemplates(TransformerFactoryImpl.java:942)\n\t   at org.apache.xalan.processor.TransformerFactoryImpl.newTransformer(TransformerFactoryImpl.java:780)\n\t   at __redirected.__TransformerFactory.newTransformer(__TransformerFactory.java:133)\n   at org.apache.taglibs.standard.util.XmlUtil.newTransformer(XmlUtil.java:187)\nCaused by: java.net.MalformedURLException: unknown protocol: jstl\n   at java.net.URL.<init>(URL.java:600)\n   at java.net.URL.<init>(URL.java:490)\n   at java.net.URL.<init>(URL.java:439)\n   at org.apache.xerces.impl.XMLEntityManager.setupCurrentEntity(XMLEntityManager.java:964)\n   at org.apache.xerces.impl.XMLVersionDetector.determineDocVersion(XMLVersionDetector.java:144)\n   at org.apache.xerces.parsers.XML11Configuration.parse(XML11Configuration.java:832)\n   at org.apache.xerces.parsers.XML11Configuration.parse(XML11Configuration.java:798)\n   at org.apache.xerces.parsers.XMLParser.parse(XMLParser.java:108)\n   at org.apache.xerces.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1198)\n   at org.apache.xerces.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:564)\n   at org.apache.xalan.processor.ProcessorInclude.parse(ProcessorInclude.java:312)\n\nThis is also tracked in Red Hat BZ https://bugzilla.redhat.com/show_bug.cgi?id=1320747\nas well as in WildFly Jira: https://issues.jboss.org/browse/WFLY-8498", "is_private": false, "id": 198130, "creator": "tomaz.cerar@gmail.com", "time": "2017-04-03T14:09:15Z", "bug_id": 60950, "creation_time": "2017-04-03T14:09:15Z", "attachment_id": 34894}, {"count": 1, "attachment_id": 34895, "creator": "tomaz.cerar@gmail.com", "text": "Created attachment 34895\nPatch that passes URI resolver to newTransformer\n\nProposed patch passes URI resolver to XmlUtil#newTransformer.\nso it is set on TRANSFORMER_FACTORY before new transformer is created.", "id": 198131, "time": "2017-04-03T14:12:25Z", "bug_id": 60950, "creation_time": "2017-04-03T14:12:25Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 60950, "attachment_id": 34896, "id": 198132, "time": "2017-04-03T14:51:07Z", "creator": "tomaz.cerar@gmail.com", "creation_time": "2017-04-03T14:51:07Z", "is_private": false, "text": "Created attachment 34896\nThread Safe Patch that passes URI resolver to newTransformer"}, {"count": 3, "tags": [], "text": "Reviewed and committed as r1790020, it will be in the next (1.2.6 ?) release.", "attachment_id": null, "bug_id": 60950, "id": 198135, "time": "2017-04-03T16:26:03Z", "creator": "remm@apache.org", "creation_time": "2017-04-03T16:26:03Z", "is_private": false}]