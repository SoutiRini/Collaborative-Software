[{"count": 0, "tags": [], "bug_id": 45275, "attachment_id": 22175, "text": "Created attachment 22175\nPatch for locked files during expired pages renewing\n\nThe problem appears when a cached page is reaching expiration and must be renew from a back end (http, ajp, coldfusion ...).\n\nIn fact the symptom is that the returned datas are never updated after expiration. Inspecting the code, it seems that the handle on the data file is not closed when the header in check for expiration and appear to be renewed.\n\nSo the patch adds a new function in the cache_provider structure for closing all opened handles on errors or expiration reached. This patch applies changes to mod_cache, mod_disk_cache and mod_mem_cache modules.\n\nThis patch is a work around and does not correct definitely the problem. In fact the conjunction of locks, multithreading and the duration between the open and close calls can makes the bug persistent on heavy loaded cached urls.\n\nSee also: Bug already reported for 2.2 (HEAD) with the id 39216. See it for explanations to reproduce the bug.", "id": 117970, "time": "2008-06-25T05:25:06Z", "creator": "philippe.duveau@free.fr", "creation_time": "2008-06-25T05:25:06Z", "is_private": false}]