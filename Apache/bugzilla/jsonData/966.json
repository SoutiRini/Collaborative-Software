[{"count": 0, "tags": [], "bug_id": 966, "is_private": false, "text": "When I serialize a DOM object with internal DTD, the output is no longer a well-\nformed xml document.\n\nFor example, I simply construct a DOM ojbect from dummy.xml and then serialize \nit:\n\ndummy.xml:\n<?xml version=\"1.0\"?>\n<!DOCTYPE foo  [\n        <!ELEMENT foo (bar*)>\n        <!ELEMENT bar (#PCDATA)>\n]>\n<foo>\n        <bar> blar... </bar>\n</foo>\n\n\nTestSerialize.java:\nimport javax.xml.parsers.*;\nimport org.w3c.dom.*;\nimport org.xml.sax.*;\nimport org.apache.xml.serialize.*;\n\n\npublic class TestSerialize {\n\n\n        public static void main(String[] argv) {\n                try {\n                        System.setProperty\n(\"javax.xml.parsers.DocumentBuilderFactory\",\n                                 \"org.apache.xerces.jaxp.DocumentBuilderFactoryI\nmpl\");\n                        DocumentBuilderFactory dbf =  \nDocumentBuilderFactory.newInstance();\n                        dbf.setValidating(true);\n                        DocumentBuilder db = dbf.newDocumentBuilder();\n                        Document doc = db.parse(\"file:///d:/dummy.xml\");\n                        java.io.StringWriter sw = new java.io.StringWriter();\n                        XMLSerializer xmlSer = new XMLSerializer(sw, null);\n                        xmlSer.serialize(doc);\n                        System.out.println(sw.toString());\n                } catch (Exception e) {\n                        e.printStackTrace();\n                }\n        }\n}\n\n\nOutput:\n\n\n        <!ELEMENT foo (bar*)>\n        <!ELEMENT bar (#PCDATA)>\n<?xml version=\"1.0\"?>\n<foo>  <bar> blar... </bar> </foo>\n\n\nThis is not well-formed and I cannot hand it directly to the next piece of xml \napp.  I tried to use different methods in OutputFormat class and still gets the \nsame output.  The only thing I can do is to call\n                        xmlSer.serialize(doc.getDocumentElement());\nIn which case I lose the DTD altogether.\n\nIs the output format by design or is it a bug?  Is there any way to generate a \nwell-formed xml with internal DTD through serialization?", "id": 1255, "time": "2001-03-13T14:00:00Z", "creator": "czhao@commonvision.com", "creation_time": "2001-03-13T14:00:00Z", "attachment_id": null}, {"text": "Fixed by Sandy Gao", "tags": [], "bug_id": 966, "is_private": false, "count": 1, "id": 1301, "time": "2001-03-15T13:05:49Z", "creator": "elena@apache.org", "creation_time": "2001-03-15T13:05:49Z", "attachment_id": null}]