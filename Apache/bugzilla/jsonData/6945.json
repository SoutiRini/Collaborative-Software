[{"count": 0, "tags": [], "bug_id": 6945, "attachment_id": null, "text": "I'm trying to run a JUnit test in JDK 1.1.8 (while running ANT in JDK 1.3.1), \nbut I'm getting errors because I can't change the JAVA_HOME setting.  I could do \nthis with a Windows exec call, which would really suck because it would not be \nplatform independent.  I can change the JVM, it seems I should also be able to \nchange the JAVA_HOME setting along with that from the java task.\n\nThis is an issue for anything that has a jvm property.  Even better is if I \ncould do the same for the JUnit task.\n  <target name=\"tests-118\" depends=\"\"> <!--jar-dist,compile-tests\"-->\n    <property environment=\"env\"/>\n    <property name=\"env.JAVA_HOME\" value=\"${jdk_1.1.8_home}\"/>\n    <echo message=\"JAVA_HOME = ${env.JAVA_HOME}\"/>\n    <java\n       classname=\"junit.textui.TestRunner\"\n       dir=\"${unittests}\"\n       fork=\"true\"\n       failonerror=\"true\"\n       jvm=\"${jdk_1.1.8_home}/bin/java\"\n    >\n       <arg value=\"MyTest\"/>\n       <sysproperty key=\"JAVA_HOME\" value=\"${jdk_1.1.8_home}\"/>\n       <sysproperty key=\"PATH\" value=\"${jdk_1.1.8_home}/bin\"/>\n    </java>\n\nmakes error ....\ntests-118:\n [property] Loading Environment env.\n [property] Override ignored for env.JAVA_HOME\n     [echo] JAVA_HOME = c:\\jdk1.3.1\n     [echo] ANT_HOME is set to = c:\\jakarta-ant-1.4.1\\bin\\\\..\n     [java] Forking c:\\jdk1.1.8\\bin\\java -classpath C:\\jdk1.1.8\\lib\\classes.zip;\nC:\\jdk1.1.8\\lib;D:\\cprj\\ant\\unittests;D:\\cprj\\ant\\allsources\\extjars\\junit.jar \njunit.textui.TestRunner MyTest\n     [java] .........................................\n     [java] MimeTable.load: file = c:\\jdk1.3.1\\lib\\content-types.properties, jav\na.io.FileNotFoundException: c:\\jdk1.3.1\\lib\\content-types.properties\n     [java] java.io.FileNotFoundException: c:\\jdk1.3.1\\lib\\content-types.propert\nies\n     [java]     at java.lang.Throwable.<init>(Throwable.java:74)\n     [java]     at java.lang.Exception.<init>(Exception.java:38)\n     [java]     at java.io.IOException.<init>(IOException.java:38)\n     [java]     at java.io.FileNotFoundException.<init>(FileNotFoundException.ja\nva:35)\n     [java]     at java.io.FileInputStream.<init>(FileInputStream.java:49)\n     [java]     at java.io.FileInputStream.<init>(FileInputStream.java:68)\n     [java]     at sun.net.www.MimeTable.load(MimeTable.java:205)\n     [java]     at sun.net.www.MimeTable.<init>(MimeTable.java:36)\n     [java]     at sun.net.www.MimeTable.getDefaultTable(MimeTable.java:45)\n     [java]     at sun.net.www.protocol.file.FileURLConnection.connect(FileURLCo\nnnection.java:45)\n     [java]     at sun.net.www.protocol.file.FileURLConnection.getInputStream(Fi\nleURLConnection.java:155)\n     [java]     at MyTest(Unknown Source)\n     [java]     at junit.framework.TestCase.runTest(TestCase.java:156)\n     [java]     at junit.framework.TestCase.runBare(TestCase.java:130)\n     [java]     at junit.framework.TestResult$1.protect(TestResult.java:106)\n     [java]     at junit.framework.TestResult.runProtected(TestResult.java:124)\n     [java]     at junit.framework.TestResult.run(TestResult.java:109)\n     [java]     at junit.framework.TestCase.run(TestCase.java:121)\n     [java]     at junit.framework.TestSuite.runTest(TestSuite.java:157)\n     [java]     at junit.framework.TestSuite.run(Compiled Code)\n     [java]     at junit.framework.TestSuite.runTest(TestSuite.java:157)\n     [java]     at junit.framework.TestSuite.run(Compiled Code)\n     [java]     at junit.framework.TestSuite.runTest(TestSuite.java:157)\n     [java]     at junit.framework.TestSuite.run(TestSuite.java:152)\n     [java]     at junit.textui.TestRunner.doRun(TestRunner.java:74)\n     [java]     at junit.textui.TestRunner.start(TestRunner.java:235)\n     [java]     at junit.textui.TestRunner.main(TestRunner.java:108)\n     [java] .........................................\n     [java] .........................................\n     [java] .........................................\n     [java] .........................................\n     [java] .........................................\n     [java] ...............\n     [java] Time: 18.506\n     [java]\n     [java] OK (261 tests)\n     [java]", "id": 11531, "time": "2002-03-07T04:05:14Z", "creator": "shinsato@inxight.com", "creation_time": "2002-03-07T04:05:14Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 6945, "attachment_id": null, "text": "It seems you are executing the 1.1.8 VM, aren't you?\n\nDon't get confused by the \"Override ignored for env.JAVA_HOME\" and the results\nof your <echo>s.  All they say is that you are trying to change the value of\nthe *Ant property* env.JAVA_HOME, not the environment variable, and that this\nfails because Ant's properties are immutable.\n\nWhy do you want to change the value of JAVA_HOME?\n\nCurrent nightly builds have a <junit> task that supports nested <env> elements\nthat let you set environment variables.  I'll assume this doesn what you want\nand close this report for now - please reopen if I have misunderstood your\nrequest.", "id": 12680, "time": "2002-04-02T14:26:20Z", "creator": "bodewig@apache.org", "creation_time": "2002-04-02T14:26:20Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 6945, "is_private": false, "id": 12699, "creation_time": "2002-04-02T17:27:07Z", "time": "2002-04-02T17:27:07Z", "creator": "shinsato@inxight.com", "text": "Yes, I am executing the 1.1.8 vm successfully, but I wanted to change the value \nof JAVA_HOME to avoid the error I listed, which is only happening because of the \nincorrect JAVA_HOME setting when executing the 1.1.8 VM.\n\nThe solution you describe that is available from the nightly builds is indeed \nwhat I need that would solve this, thanks!", "attachment_id": null}]