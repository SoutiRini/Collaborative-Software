[{"count": 0, "attachment_id": null, "bug_id": 34870, "text": "HP-UX 11.0 shell doesn't seem to like it when you use an environment variable\nthat has not been set.  I had to fix three lines to get configure to work me. I\nsaw other lines that potentially have the same problem but I have no way to test\nthem.\n\nThe following is a 'diff -ru' of configure.in and configure (since I can't seem\nto figure out how to attach a file when entering a new bug):\n\ndiff -ru jakarta-tomcat-connectors-1.2.12-src.orig/jk/native/configure\njakarta-tomcat-connectors-1.2.12-src/jk/native/configure\n--- jakarta-tomcat-connectors-1.2.12-src.orig/jk/native/configure      \n2005-05-07 05:41:32.000000000 -0500\n+++ jakarta-tomcat-connectors-1.2.12-src/jk/native/configure    2005-05-11\n10:42:01.000000000 -0500\n@@ -19983,7 +19983,7 @@\n\n             ${APXS} -q PREFIX >/dev/null 2>/dev/null || apxs_support=false\n\n-            if ${TEST} \"${apxs_support}\" = \"false\" ; then\n+            if ${TEST} \"${apxs_support:-}x\" = \"falsex\" ; then\n                 echo \"$as_me:$LINENO: result: could not find ${APXS}\" >&5\n echo \"${ECHO_T}could not find ${APXS}\" >&6\n                 { { echo \"$as_me:$LINENO: error: You must specify a valid\n--with-apxs path\" >&5\n@@ -20209,14 +20209,14 @@\n if ${TEST} -n \"${CFLAGS}\" ; then\n        APXSCFLAGS=\"${APXSCFLAGS} ${CFLAGS}\"\n fi\n-if ${TEST} -n \"${LDFLAGS}\" ; then\n+if ${TEST} \"${LDFLAGS:-}x\" != \"x\" ; then\n        APXSLDFLAGS=\"-Wl,${LDFLAGS}\"\n fi\n\n\n\n\n-if ${TEST} -n \"${JK_JNI_WORKER}\" ; then\n+if ${TEST} \"${JK_JNI_WORKER:-}x\" != \"x\" ; then\n\n WEBSERVER=\"jni ${WEBSERVER}\"\n\ndiff -ru jakarta-tomcat-connectors-1.2.12-src.orig/jk/native/configure.in\njakarta-tomcat-connectors-1.2.12-src/jk/native/configure.in\n--- jakarta-tomcat-connectors-1.2.12-src.orig/jk/native/configure.in   \n2005-04-27 10:06:45.000000000 -0500\n+++ jakarta-tomcat-connectors-1.2.12-src/jk/native/configure.in 2005-05-11\n10:44:16.000000000 -0500\n@@ -130,7 +130,7 @@\n\n             ${APXS} -q PREFIX >/dev/null 2>/dev/null || apxs_support=false\n\n-            if ${TEST} \"${apxs_support}\" = \"false\" ; then\n+            if ${TEST} \"${apxs_support:-}x\" = \"falsex\" ; then\n                 AC_MSG_RESULT(could not find ${APXS})\n                 AC_MSG_ERROR(You must specify a valid --with-apxs path)\n             fi\n@@ -317,14 +317,14 @@\n        APXSCFLAGS=\"${APXSCFLAGS} ${CFLAGS}\"\n fi\n dnl the APXSLDFLAGS is normaly empty but APXSCFLAGS is not.\n-if ${TEST} -n \"${LDFLAGS}\" ; then\n+if ${TEST} \"${LDFLAGS:-}x\" != \"x\" ; then\n        APXSLDFLAGS=\"-Wl,${LDFLAGS}\"\n fi\n AC_SUBST(APXSCFLAGS)\n AC_SUBST(APXSCPPFLAGS)\n AC_SUBST(APXSLDFLAGS)\n\n-if ${TEST} -n \"${JK_JNI_WORKER}\" ; then\n+if ${TEST} \"${JK_JNI_WORKER:-}x\" != \"x\" ; then\n\n WEBSERVER=\"jni ${WEBSERVER}\"", "id": 74728, "time": "2005-05-11T18:12:23Z", "creator": "mark.horstman@att.com", "creation_time": "2005-05-11T18:12:23Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "mark.horstman@att.com", "attachment_id": 14999, "id": 74729, "time": "2005-05-11T18:14:02Z", "bug_id": 34870, "creation_time": "2005-05-11T18:14:02Z", "is_private": false, "text": "Created attachment 14999\nHere's the same 'diff -ru' as an attachment"}, {"count": 2, "attachment_id": null, "bug_id": 34870, "text": "Your patch is invalid because it does not work on any known platform,\nand I doupt that it works on hp-ux too.\nif ${TEST} \"${apxs_support:-}x\"\n\nNot sure what the ':-' is ment to be used for (simely)?", "id": 76944, "time": "2005-07-03T11:12:33Z", "creator": "mturk@apache.org", "creation_time": "2005-07-03T11:12:33Z", "tags": [], "is_private": false}, {"count": 3, "attachment_id": null, "bug_id": 34870, "text": "In my experience HP-UX /bin/sh and /bin/ksh treats using unset environment\nvariables as an script error/abort. i.e. If VARX is not set, using ${VARX}\ncauses a shell script ending error.  Some OSes follow this error scheme, some do\nnot (treat it as an error).\n\nTo get around that shell error, you can use the Bourne Shell ':-' notation\nwithin variable references: \"${VARX:-foo}\" means \"Substitute with the value of\nVARX. If VARX is not set, use the value following the dash (in this case 'foo')\ninstead\". If you leave the value off \"${VARX:-}\", it means \"If VARX is not set,\nuse the value following the dash (in this case nothing) instead.\" It's an easy\nway to get around unset variable shell error. This type of notation should be\nsupported in all Bourne shell derivatives (it works on HP-UX, Solaris, AIX and\nLinux 'cause I use it all the time).\n\nSo, while this may work under Linux/bash and cause a script error/abort under HP-UX:\n\nif [ \"${a}x\" = \"x\" ]; then echo \"a is not set\"; else echo \"a is set\"; fi\n\nThis produces the desired result without error in both:\n\nif [ \"${a:-}x\" = \"x\" ]; then echo \"a is not set\"; else echo \"a is set\"; fi", "id": 77130, "time": "2005-07-08T19:45:18Z", "creator": "mark.horstman@att.com", "creation_time": "2005-07-08T19:45:18Z", "tags": [], "is_private": false}]