[{"count": 0, "tags": [], "creator": "naveeniq@gmail.com", "attachment_id": 27352, "text": "Created attachment 27352\nSample java file.\n\nautoSizeColumn does not sizes text when we have leading space in the cell.\nReference to bug #47082.\n\nChecked with jre6 and poi-3.7-20101029.jar. Can use the attached for reference.", "id": 148401, "time": "2011-08-05T11:22:06Z", "bug_id": 51622, "creation_time": "2011-08-05T11:22:06Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 51622, "text": "Created attachment 27353\nOutput file", "id": 148402, "time": "2011-08-05T11:23:12Z", "creator": "naveeniq@gmail.com", "creation_time": "2011-08-05T11:23:12Z", "is_private": false, "attachment_id": 27353}, {"count": 2, "tags": [], "bug_id": 51622, "attachment_id": 33253, "is_private": false, "id": 186231, "time": "2015-11-04T03:28:53Z", "creator": "onealj@apache.org", "creation_time": "2015-11-04T03:28:53Z", "text": "Created attachment 33253\nSheetUtil.java fix\n\nThis problem still exists in POI 3.13 and the latest 3.14 dev build. Cell width computation is done in org.apache.poi.ss.util.SheetUtil, so this bug is common to HSSF, XSSF, and SXSSF workbooks.\n\nThe problem is here[1]:\n> private static double getCellWidth(int defaultCharWidth, int colspan,\n>         CellStyle style, double width, AttributedString str) {\n> ...\n>     width = Math.max(width, ((layout.getBounds().getWidth() / colspan) / defaultCharWidth) + style.getIndention());\n\nShould be (bounds.getX() + bounds.getWidth()), since the bounding box starts at the first non-whitespace character.\n\nThis patch is untested and needs a corresponding unit tests before it can be committed.\n\n[1] https://svn.apache.org/viewvc/poi/trunk/src/java/org/apache/poi/ss/util/SheetUtil.java?view=markup#l180"}, {"count": 3, "tags": [], "bug_id": 51622, "attachment_id": null, "is_private": false, "id": 186232, "time": "2015-11-04T03:31:40Z", "creator": "onealj@apache.org", "creation_time": "2015-11-04T03:31:40Z", "text": "In your example (attachment 27352), the cell in the 4th row has a bounding rectangle of\njava.awt.geom.Rectangle2D$Float[x=58.570312,y=-7.703125,w=118.79785,h=7.890625]"}, {"count": 4, "tags": [], "bug_id": 51622, "attachment_id": null, "is_private": false, "id": 186233, "time": "2015-11-04T03:34:39Z", "creator": "onealj@apache.org", "creation_time": "2015-11-04T03:34:39Z", "text": "(In reply to Javen O'Neal from comment #3)\n> java.awt.geom.Rectangle2D$Float[x=58.570312,y=-7.703125,w=118.79785,h=7.\n> 890625]\nCorrection: java.awt.geom.Rectangle2D$Float[x=28.570312,y=-7.703125,w=118.79785,h=7.890625]\n\nThe defaultCharWidth is 6.323242 on my system, so assuming a space character is half the width of a \"0\" character in Arial, 9 leading spaces should have a width of 28.4546. Math checks out."}, {"count": 5, "tags": [], "bug_id": 51622, "text": "Created attachment 33254\nSheetUtil.java fix and corresponding unit test", "id": 186234, "time": "2015-11-04T06:38:58Z", "creator": "onealj@apache.org", "creation_time": "2015-11-04T06:38:58Z", "is_private": false, "attachment_id": 33254}, {"count": 6, "tags": [], "creator": "onealj@apache.org", "attachment_id": null, "text": "Applied attachment 33254 in r1712477 to trunk.\n\nUpdated site docs in r1712479.", "id": 186235, "time": "2015-11-04T06:46:13Z", "bug_id": 51622, "creation_time": "2015-11-04T06:46:13Z", "is_private": false}]