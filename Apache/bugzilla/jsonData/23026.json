[{"count": 0, "tags": [], "creator": "pranas@hotmail.com", "attachment_id": null, "id": 43885, "time": "2003-09-09T12:46:20Z", "bug_id": 23026, "creation_time": "2003-09-09T12:46:20Z", "is_private": false, "text": "1. JDBC driver in $CATALINA_HOME/common/lib/sapdbc.jar\n2. server.xml configuration:\n<Context path=\"/Test\" docBase=\"Test\" debug=\"5\" reloadable=\"true\"\ncrossContext=\"true\">\n<Logger className=\"org.apache.catalina.logger.FileLogger\"\nprefix=\"localhost_TestDB_log.\" suffix=\".txt\" timestamp=\"true\"/>\n<Resource name=\"jdbc/TestDB\" auth=\"Container\" type=\"javax.sql.DataSource\"/>\n<ResourceParams name=\"jdbc/TestDB\">\n<parameter> <name>factory</name>\n<value>org.apache.commons.dbcp.BasicDataSourceFactory</value> </parameter>\n<parameter> <name>maxActive</name> <value>45</value> </parameter>\n<parameter> <name>maxIdle</name> <value>5</value> </parameter>\n<parameter> <name>maxWait</name> <value>15000</value> </parameter>\n<parameter> <name>username</name> <value>DBA</value> </parameter>\n<parameter> <name>password</name> <value>PASSWORD</value> </parameter>\n<parameter> <name>driverClassName</name>\n<value>com.sap.dbtech.jdbc.DriverSapDB</value> </parameter>\n<parameter> <name>url</name> <value>jdbc:sapdb:///TestDB</value>\n</parameter>\n</ResourceParams>\n</Context>\n\n3. web.xml configuration:\n<web-app>\n...\n<servlet>\n<servlet-name>Test</servlet-name>\n<servlet-class>Test</servlet-class>\n</servlet>\n...\n<servlet-mapping>\n<servlet-name>Test</servlet-name>\n<url-pattern>/Test</url-pattern>\n</servlet-mapping>\n...\n<resource-ref>\n<description>Test DB Connection</description>\n<res-ref-name>jdbc/TestDB</res-ref-name>\n<res-type>javax.sql.DataSource</res-type>\n<res-auth>Container</res-auth>\n</resource-ref>\n...\n</web-app>\n\n4. Test Servlet:\n...\nContext initContext = new InitialContext();\nif (initContext != null) {\n    out.println(\"<p>OK. Got InitialContext()</p>\");\n} // if\n\nContext envContext = (Context)initContext.lookup(\"java:/comp/env\");\nif (envContext != null) {\n    out.println(\"<p>OK. Got initContext.lookup(\\\"java:/comp/env\\\")</p>\");\n} // if\n\nDataSource ds = (DataSource) envContext.lookup(\"jdbc/TestDB\");\nif (ds != null) {\n    out.println(\"<p>OK. Got envContext.lookup(\\\"jdbc/TestDB\\\")</p>\");\n} // if\n\nConnection con = ds.getConnection();\nif (con != null) {\n        out.println(\"<p>OK. ds.getConnection()</p>\");\n} // if\n\n} catch (Exception e) {\n    out.println(\"<p>\");\n    e.printStackTrace(out);\n    out.println(\"</p>\");\n} // catch\n...\nResult:\nOK. Got InitialContext()\nOK. Got initContext.lookup(\"java:/comp/env\")\nOK. Got envContext.lookup(\"jdbc/TestDB\")\njava.sql.SQLException: Cannot load JDBC driver class 'null' at\norg.apache.commons.dbcp.BasicDataSource.createDataSource(BasicDataSource.jav\na:529) at\norg.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:3\n12) at Test.processRequest(Test.java:79) at Test.doGet(Test.java:104) at\njavax.servlet.http.HttpServlet.service(HttpServlet.java:740) at\njavax.servlet.http.HttpServlet.service(HttpServlet.java:853) at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Application\nFilterChain.java:247) at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterCh\nain.java:193) at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.ja\nva:256)\n..."}, {"count": 1, "attachment_id": null, "creator": "dirk.verbeeck@pandora.be", "is_private": false, "id": 44145, "time": "2003-09-13T14:24:28Z", "bug_id": 23026, "creation_time": "2003-09-13T14:24:28Z", "tags": [], "text": "marked invalid by reporter, closing"}]