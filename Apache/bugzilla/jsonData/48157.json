[{"attachment_id": null, "tags": [], "bug_id": 48157, "is_private": false, "count": 0, "id": 131785, "time": "2009-11-07T08:04:00Z", "creator": "hauser@acm.org", "creation_time": "2009-11-07T08:04:00Z", "text": "as per http://extendedsubset.com/Renegotiating_TLS.pdf p. 4:\n\n\nIs there a way to disable X-Headers with GET like paths in coyote - is so, describe in http://tomcat.apache.org/tomcat-5.5-doc/ssl-howto.html\n\nsee also bug 3463 and http://forums.sun.com/thread.jspa?messageID=10857837"}, {"count": 1, "tags": [], "bug_id": 48157, "attachment_id": null, "id": 131787, "time": "2009-11-07T08:09:41Z", "creator": "hauser@acm.org", "creation_time": "2009-11-07T08:09:41Z", "is_private": false, "text": "see also Bug 48158"}, {"count": 2, "tags": [], "creator": "markt@apache.org", "text": "Chances are any attempt to filter these out could be defeated and there is always a risk of a false positive. In addition, there may be other, more complex, attack vectors that would not be blocked.\n\nI just kicked off a discussion on the dev list. Feel free to join in there.", "id": 131789, "time": "2009-11-07T09:09:42Z", "bug_id": 48157, "creation_time": "2009-11-07T09:09:42Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 48157, "text": "Since we do not really have the option use \"APR/Native\" and we would be happy to have X-Header fixing heuristics as another optional server.xml attribute.\nYou fear in comment 2 that there are other more complex attack vectors, but if we can, shouldn't we fix the immediate and obvious ones all the same - even if we can't guarantee that there aren't worse, but also more complex attack vectors.\n\nWe happily offer to test and report at least for our setup.", "id": 131813, "time": "2009-11-09T04:06:08Z", "creator": "hauser@acm.org", "creation_time": "2009-11-09T04:06:08Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "knst.kolinko@gmail.com", "text": "If you really want something like that, you can write a Filter or a Valve. See org.apache.catalina.valves.RequestDumperValve for an example.\n\nhttp://tomcat.apache.org/tomcat-6.0-doc/config/valve.html", "id": 131815, "time": "2009-11-09T05:12:13Z", "bug_id": 48157, "creation_time": "2009-11-09T05:12:13Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 48157, "text": "My current understanding is that a filter/valve as proposed will do very little to mitigate this attack as the SSL handshaking occurs at the JSSE level and is simply not visible to the BIO & NIO connector code.", "id": 131819, "time": "2009-11-09T06:08:15Z", "creator": "markt@apache.org", "creation_time": "2009-11-09T06:08:15Z", "is_private": false, "attachment_id": null}]