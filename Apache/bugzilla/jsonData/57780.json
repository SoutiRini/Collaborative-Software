[{"count": 0, "tags": [], "creator": "carlo.dellacqua@ext.piksel.it", "text": "Created attachment 32622\nTest classes and description of the results\n\nWe use POI 3.8-Final but the problem occurs also with 3.11.\nWe need the insert in cell comments strings with different font type and the code used is the following:\n\nXSSFWorkbook workbook = new XSSFWorkbook();\n\nXSSFFont font = workbook.createFont();\nfont.setFontName(\"Verdana\");\nfont.setFontHeightInPoints((short)14);\nfont.setBoldweight((short)700);\nfont.setColor(IndexedColors.BLUE.getIndex());\n\nXSSFCreationHelper creationHelper = workbook.getCreationHelper();     \nXSSFSheet sheet = workbook.createSheet();\nXSSFDrawing drawing = sheet.createDrawingPatriarch();     \nXSSFClientAnchor anchor = drawing.createAnchor(0, 0, 0, 0, 2, 2, 5, 5); \n\nXSSFRow row_0 = sheet.createRow(0);\n\nXSSFCell cell_0_0 = row_0.createCell(0);\ncell_0_0.setCellValue(\"Cell 0:0\");\nXSSFComment comment_0_0 = drawing.createCellComment(anchor);\nXSSFRichTextString rts_0_0 = creationHelper.createRichTextString(\"RichString 0:0 _x0046_\");\ntry {\n\trts_0_0.applyFont(font);\n} catch(java.lang.IllegalArgumentException iae) {\n\tSystem.out.println(\"testXSSF: Comment 0:0 - \"+iae);\n}\ncomment_0_0.setString(rts_0_0);\ncell_0_0.setCellComment(comment_0_0);\n\nand \nrts_0_0.applyFont(font);\nreturns the Exception.\n\nTo avoid the Exeception we have capitalized the text changing it from _x0046_ to _X0046_ (using Pattern/Matcher).\n\nHas to be noticed that HSSF (file extension .xls) manages without problem the text string.\n\nAttached you can find a test class (Text_xNNNN_applyFont) and the created Excel files.", "id": 182184, "time": "2015-03-30T13:50:44Z", "bug_id": 57780, "creation_time": "2015-03-30T13:50:44Z", "is_private": false, "attachment_id": 32622}, {"count": 1, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "id": 182512, "time": "2015-04-20T20:40:06Z", "bug_id": 57780, "creation_time": "2015-04-20T20:40:06Z", "is_private": false, "text": "I think this is basically a duplicate of bug 57008, which we closed as WONTFIX, see the comments further down in that bug for some explanation.\n\n*** This bug has been marked as a duplicate of bug 57008 ***"}]