[{"count": 0, "attachment_id": null, "creator": "dave.webster@virginmedia.co.uk", "text": "Hello All,\n\nDescription\n-----------\n\nCreating a new HSSFWorkbook causes a Java Exception to be thrown and the\nworkbook not created.  The attached spreadsheet AVON.xls shows this behaviour -\nit is a stripped down spreadsheet from a client ; I have stripped out almost all\ndata, worksheets, hidden worksheets, named ranges ... to leave this virtually\nempty sheet.\n\nExpected Behaviour\n------------------\n\nThat the workbook is created correctly.\n\nTo replicate\n------------\nThe following lines of code cause the exception to be thrown if the inFile is\nthe attached \"AVON.xls\"\n \n  POIFSFileSystem fs = new POIFSFileSystem (new FileInputStream (inFile));\n  wb = new HSSFWorkbook(fs);\n\nThe Exception is:\n\njava.lang.IndexOutOfBoundsException: Index: 0, Size: 0\n        at java.util.ArrayList.RangeCheck(ArrayList.java:547)\n        at java.util.ArrayList.get(ArrayList.java:322)\n        at org.apache.poi.util.IntMapper.get(IntMapper.java:81)\n        at org.apache.poi.hssf.record.SSTRecord.getString(SSTRecord.java:195)\n        at org.apache.poi.hssf.model.Workbook.getSSTString(Workbook.java:729)\n        at\norg.apache.poi.hssf.usermodel.HSSFRichTextString.<init>(HSSFRichTextString.java:57)\n        at org.apache.poi.hssf.usermodel.HSSFCell.<init>(HSSFCell.java:202)\n        at\norg.apache.poi.hssf.usermodel.HSSFRow.createCellFromRecord(HSSFRow.java:193)\n        at\norg.apache.poi.hssf.usermodel.HSSFSheet.setPropertiesFromSheet(HSSFSheet.java:177)\n        at org.apache.poi.hssf.usermodel.HSSFSheet.<init>(HSSFSheet.java:131)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:226)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:148)\n        at ExcelParser2.createWorkBook(ExcelParser2.java:47)\n        at ExcelParser2.main(ExcelParser2.java:330)\n\nWorkaround\n----------\n\nNone that I'm aware of ...\n\nAny ideas?\n\nCheers,", "id": 106331, "time": "2008-02-25T04:42:11Z", "bug_id": 44483, "creation_time": "2008-02-25T04:42:11Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 44483, "attachment_id": 21590, "is_private": false, "id": 105182, "time": "2008-02-25T04:43:06Z", "creator": "dave.webster@virginmedia.co.uk", "creation_time": "2008-02-25T04:43:06Z", "text": "Created attachment 21590\nspreadsheet which throws Exception when opened by HSSF"}, {"count": 2, "tags": [], "bug_id": 44483, "attachment_id": null, "id": 105027, "time": "2008-02-25T05:53:15Z", "creator": "dave.webster@virginmedia.co.uk", "creation_time": "2008-02-25T05:53:15Z", "is_private": false, "text": "Appologies, this is a duplicate of bug 42564, I forgot I modified the source to\nwork around this for one instance of a spreadsheet, obviously the workaround has\ncaused problems with other spreadsheets.\n\nAny update re: 42564 and the updated Excel file formats?\n\nCheers\n\n\n*** This bug has been marked as a duplicate of 42564 ***"}]