[{"attachment_id": 26602, "tags": [], "creator": "iset2468@yahoo.com", "is_private": false, "count": 0, "id": 143967, "time": "2011-02-03T16:13:58Z", "bug_id": 50717, "creation_time": "2011-02-03T16:13:58Z", "text": "Created attachment 26602\nCode snippet showing code that causes error.\n\nWhen changeTextInRichTextRun(rtRuns[k], updatedText); is called to update the text in a rich text field, the text the following happens:\n\nScenario 1 (text is the same length as original)\n1. POI performs as expected\n\nScenario 2 (text is updated to be smaller than the original text)\n1. Final text in text run (not rich text run) contains the new value plus the end characters from the original text up to the length of the original text\n2. The formatting on the entire slide is lost\n3. If getText is called on the rich text run, a string index out of bounds error occurs.\n\nScenario 3 (text is updated to be smaller than the original text)\n1. Final text in text run (not in rich text run) contains the truncated new value to the length of the original text\n2. The formatting on the entire slide is lost\n3. No string index out of bounds error occurs in this case.\n\nFormatting issues only show up when more than 1 rich text run is modified on the same PPT slide line and 1 is modified per scenarios 2 or 3 above."}, {"count": 1, "text": "The example is unfortunately incomplete (no ppt attached, not all methods \ndefined) and on the other hand the text handling has been rudimentary changed \n... and I guess it now handles your testcase correctly ... so I'm closing this \nfor now.\n\nFeel free to reopen the entry, if the trunk version is not working for you.", "bug_id": 50717, "is_private": false, "id": 186258, "time": "2015-11-05T00:56:07Z", "creator": "kiwiwings@apache.org", "creation_time": "2015-11-05T00:56:07Z", "tags": [], "attachment_id": null}]