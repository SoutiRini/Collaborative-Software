[{"count": 0, "tags": [], "creator": "rndbox@yahoo.com", "text": "poi-2.0-final-20051122.jar couldn't write Excel output properly when a formula\ncontains a Euro symbol, e.g, =TEXT('Value is '!H7,\"\u20ac###,##0\")\n\nThe output for \"\u20ac###,##0\" will become some garbage, but same length.\n\nIf I take out the Euro symbol then everything works fine.\n\nI'm following the Busy Developers' Guide to HSSF:\n// Write the output to a file\n    FileOutputStream fileOut = new FileOutputStream(\"workbook.xls\");\n    wb.write(fileOut);\n    fileOut.close();\n\nNote: I have no choice but to use poi 2.0 because all subsequent versions will\ncause errors on my workbook (quite complicated), \"Unable to read file.\" and\neventually \"Damage to the file was so extensive that repairs were not possible.\n Excel attemted to recover your formulas and values, but some data may have been\nlost or corrupted.\"  -- perhaps I should file another bug report for this later.\n\nIf there's no plan to back patch to version 2.0, if anyone know please tell me\nwhere to fix it so that I can do it myself.\n\nThank you very much.", "id": 82792, "time": "2005-11-24T09:35:05Z", "bug_id": 37622, "creation_time": "2005-11-24T09:35:05Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "text": "Btw, I have also tried:\n\nwb.setSheetName(0, wb.getSheetName(0), HSSFWorkbook.ENCODING_UTF_16)\n\nand\n\nwb.setSheetName(0, wb.getSheetName(0),HSSFWorkbook.ENCODING_COMPRESSED_UNICODE)\n\nand even\n\n(((wb.getSheetAt(0)).getRow(2)).getCell((short)4)).setEncoding(HSSFWorkbook.ENCODING_UTF_16)\n\nand\n\n(((wb.getSheetAt(0)).getRow(2)).getCell((short)4)).setEncoding(HSSFWorkbook.ENCODING_COMPRESSED_UNICODE)\n\nbefore writing the output, but didn't work.\n\nEven if setting individual cell works, I do not know when the users will type\nthe Euro symbol, it could exists anywhere in the workbook.", "attachment_id": null, "id": 82796, "creation_time": "2005-11-24T10:32:24Z", "time": "2005-11-24T10:32:24Z", "creator": "rndbox@yahoo.com", "bug_id": 37622, "is_private": false}, {"count": 2, "attachment_id": null, "bug_id": 37622, "text": "Fix applied to SVN. Tested in TestUnicodeWorksheet.\n\nJason", "id": 84153, "time": "2006-01-03T12:39:27Z", "creator": "jheight@apache.org", "creation_time": "2006-01-03T12:39:27Z", "tags": [], "is_private": false}]