[{"attachment_id": 31367, "tags": [], "bug_id": 56218, "is_private": false, "count": 0, "id": 173629, "time": "2014-03-05T10:47:10Z", "creator": "hong-thai.nguyen@polyspot.com", "creation_time": "2014-03-05T10:47:10Z", "text": "Created attachment 31367\nPatch check NPE with test case\n\nRead attached XLSX file, NPE raised\n{code}\nCaused by: java.lang.NullPointerException\n\tat org.apache.poi.xssf.usermodel.XSSFSimpleShape.<init>(XSSFSimpleShape.java:84)\n\tat org.apache.poi.xssf.usermodel.XSSFDrawing.getShapes(XSSFDrawing.java:377)\n\tat org.apache.poi.xssf.eventusermodel.XSSFReader$SheetIterator.getShapes(XSSFReader.java:295)\n\tat org.apache.tika.parser.microsoft.ooxml.XSSFExcelExtractorDecorator.buildXHTML(XSSFExcelExtractorDecorator.java:148)\n\tat org.apache.tika.parser.microsoft.ooxml.AbstractOOXMLExtractor.getXHTML(AbstractOOXMLExtractor.java:105)\n\tat org.apache.tika.parser.microsoft.ooxml.XSSFExcelExtractorDecorator.getXHTML(XSSFExcelExtractorDecorator.java:94)\n\tat org.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:112)\n\tat org.apache.tika.parser.microsoft.ooxml.OOXMLParser.parse(OOXMLParser.java:82)\n\tat org.apache.tika.parser.ParserDecorator.parse(ParserDecorator.java:91)\n\tat org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)\n\t... 24 more\n{code}\n\nOn line 84 of org.apache.poi.xssf.usermodel.XSSFSimpleShape, We would check that  body is not null (some shape has no text info, eg. lines)."}, {"count": 1, "tags": [], "bug_id": 56218, "is_private": false, "text": "Thanks for the patch, unfortunately it contains many unrelated changes like tab/space changes and formatting changes, making it hard to only apply the actual changes. Any chance you can re-do it so that it does not contain all these changes?\n\nAlso you will need to attach the test-file separately, as it is not contained in a text-only patch.", "id": 173864, "time": "2014-03-16T19:50:34Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2014-03-16T19:50:34Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 56218, "text": "This is actually already fixed in r1595127 via 56514.\n\n*** This bug has been marked as a duplicate of bug 56514 ***", "id": 182027, "time": "2015-03-23T21:27:04Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-03-23T21:27:04Z", "is_private": false, "attachment_id": null}]