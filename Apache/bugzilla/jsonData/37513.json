[{"count": 0, "tags": [], "bug_id": 37513, "attachment_id": null, "id": 82522, "time": "2005-11-15T19:04:13Z", "creator": "gerhard.karg@gmx.de", "creation_time": "2005-11-15T19:04:13Z", "is_private": false, "text": "Hi,\n\nafter building apache 2.1.9-beta (with LARGE FILE support) on a Linksys NSLU\nwith the following kernel:\nLinux NAS 2.4.22-xfs #1 Sun Jun 12 21:17:17 PDT 2005 armv5b unknown\n\ni tried to download a file with 4 GB. I can only download the first 2 GB via\nhttp, then the download is finished. Here is the strace:\n\n\npoll([{fd=8, events=POLLOUT, revents=POLLOUT}], 1, 300000) = 1\nsendfile(8, 9, [2130233804], 472628)    = 45360\npoll([{fd=8, events=POLLOUT, revents=POLLOUT}], 1, 300000) = 1\nsendfile(8, 9, [2130279164], 427268)    = 85712\npoll([{fd=8, events=POLLOUT, revents=POLLOUT}], 1, 300000) = 1\nsendfile(8, 9, [2130364876], 341556)    = 46620\npoll([{fd=8, events=POLLOUT, revents=POLLOUT}], 1, 300000) = 1\nsendfile(8, 9, [2130411496], 294936)    = 84452\npoll([{fd=8, events=POLLOUT, revents=POLLOUT}], 1, 300000) = 1\nsendfile(8, 9, [2130495948], 210484)    = 45360\npoll([{fd=8, events=POLLOUT, revents=POLLOUT}], 1, 300000) = 1\nsendfile(8, 9, [2130541308], 165124)    = 88548\npoll([{fd=8, events=POLLOUT, revents=POLLOUT}], 1, 300000) = 1\nsendfile(8, 9, [2130629856], 76576)     = 45360\npoll([{fd=8, events=POLLOUT, revents=POLLOUT}], 1, 300000) = 1\nsendfile(8, 9, [2130675216], 31216)     = 31216\nread(8, 0x138740, 8000)                 = -1 EAGAIN (Resource temporarily unavai\nlable)\nwrite(7, \"192.168.1.3 - - [15/Nov/2005:18:32:45 +0100] \\\"GET /test2.vob HTTP/1.1\n\\\" 200 4055453696\\n\", 86) = 86\nclose(8)                                = 0\nread(4, 0xbffffc9b, 1)                  = -1 EAGAIN (Resource temporarily unavai\nlable)\nclose(9)                                = 0\n\n\nSince the samba server on the NSLU is supporting files over 2 GB (i was able to\ncopy the 4 GB file via samba) - i wonder if this is a limitation in apache or\nthe linux kernel.\n\nThanks\n\ngkarg"}, {"count": 1, "tags": [], "bug_id": 37513, "attachment_id": null, "is_private": false, "id": 82523, "time": "2005-11-15T19:13:18Z", "creator": "chip@force-elite.com", "creation_time": "2005-11-15T19:13:18Z", "text": "what client are you using to download over http?"}, {"count": 2, "tags": [], "creator": "gerhard.karg@gmx.de", "attachment_id": null, "is_private": false, "id": 82524, "time": "2005-11-15T20:09:40Z", "bug_id": 37513, "creation_time": "2005-11-15T20:09:40Z", "text": "(In reply to comment #1)\n> what client are you using to download over http?\n\nFirefox 1.0.3"}, {"count": 3, "tags": [], "creator": "gerhard.karg@gmx.de", "attachment_id": null, "is_private": false, "id": 82526, "time": "2005-11-15T21:00:56Z", "bug_id": 37513, "creation_time": "2005-11-15T21:00:56Z", "text": "(In reply to comment #1)\n> what client are you using to download over http?\n\nI tried FlashGet and wget, too - same problem\n"}, {"count": 4, "attachment_id": null, "bug_id": 37513, "is_private": false, "id": 82530, "time": "2005-11-15T22:13:55Z", "creator": "rpluem@apache.org", "creation_time": "2005-11-15T22:13:55Z", "tags": [], "text": "I guess you do not have configured LARGE FILE support correctly / do not have\nfull support for large files on your system (at least not for sendfile):\n\n1. On Linux when using LARGE FILE support sendfile64 should show up in strace\ninstead of sendfile.\n2. Comparing the logic from sendfile_nonblocking in server/core_filters.c with\nthe strace output gives me the feeling that only 2GB are stored in the file bucket.\n\nMaybe it is only a sendfile problem on your environment. Please try the setting\n\nEnableSendfile Off\n\nin your config and let us know if the problem is still there."}, {"id": 82531, "tags": [], "creator": "chip@force-elite.com", "attachment_id": null, "count": 5, "text": "What version of wget? You need to be using at least wget 1.10+ to support LFS.", "time": "2005-11-15T22:38:08Z", "bug_id": 37513, "creation_time": "2005-11-15T22:38:08Z", "is_private": false}, {"id": 82570, "tags": [], "creator": "gerhard.karg@gmx.de", "attachment_id": null, "count": 6, "text": "After adding the setting\nEnableSendfile Off\nto the config file, everything is working fine.\n\nThank you very much\n\ngkarg", "time": "2005-11-16T16:39:47Z", "bug_id": 37513, "creation_time": "2005-11-16T16:39:47Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 37513, "attachment_id": null, "id": 82599, "time": "2005-11-16T22:12:10Z", "creator": "rpluem@apache.org", "creation_time": "2005-11-16T22:12:10Z", "is_private": false, "text": "Reopen bug and change it to Resolved Invalid as actually nothing was fixed. As\nfar as I can see, there was a problem with the sendfile implementation of the OS\n/ glibc."}, {"count": 8, "tags": [], "bug_id": 37513, "attachment_id": null, "text": "Reclassed to delete a version", "id": 135506, "time": "2010-03-22T06:00:57Z", "creator": "wrowe@apache.org", "creation_time": "2010-03-22T06:00:57Z", "is_private": false}]