[{"text": "If you have JAVA_HOME set to a path with spaces, ant.bat will build a classpath\nthat confuses java at the following lines:\n\n----------\nif exist \"%JAVA_HOME%\\lib\\tools.jar\" call \"%ANT_HOME%\\bin\\lcp.bat\"\n\"%JAVA_HOME%\\lib\\tools.jar\"\nif exist \"%JAVA_HOME%\\lib\\classes.zip\" call \"%ANT_HOME%\\bin\\lcp.bat\"\n\"%JAVA_HOME%\\lib\\classes.zip\"\n----------\n\nIn lcp.bat, the first line reads:\nset _CLASSPATHCOMPONENT=%1\n\nSince the parameter was passed to lcp.bat quoted, it gets added to the classpath\nvariable quoted like this:\n\n----------\n\"C:\\Program Files\\j2sdk1.4.1_01\\lib\\tools.jar\";O:\\Dev\\ProTools\\Apache\nAnt\\bin\\..\\lib\\xml-apis.jar;O:\\Dev\\ProTools\\Apache\nAnt\\bin\\..\\lib\\xercesImpl.jar;O:\\Dev\\ProTools\\Apache\nAnt\\bin\\..\\lib\\optional.jar;O:\\Dev\\ProTools\\Apache Ant\\bin\\..\\lib\\ant.jar;\n----------\n\nFor some reason, the quoted part works if it doesn't have spaces.  If it does\nhave spaces you get this:\n\n----------\nException in thread \"main\" java.lang.NoClassDefFoundError:\nFiles\\j2sdk1/4/1_01\\lib\\tools/jar;O:\\Dev\\Tools\\Apache\nAnt\\bin\\//\\lib\\xml-apis/jar;O:\\Dev\\Tools\\Apache\nAnt\\bin\\//\\lib\\xercesImpl/jar;O:\\Dev\\Tools\\Apache\nAnt\\bin\\//\\lib\\optional/jar;O:\\Dev\\Tools\\Apache Ant\\bin\\//\\lib\\ant/jar;\n----------\n\nI believe the correct fix (at least on NT/2K/XP) for this is to change the first\nline in lcp.bat to read:\nset _CLASSPATHCOMPONENT=%~1\n\nThe ~ tells the command interpreter to strip enclosing quotes if they exist (and\ndo nothing if they don't).", "tags": [], "bug_id": 15351, "attachment_id": null, "count": 0, "id": 27789, "time": "2002-12-13T11:50:55Z", "creator": "bogofilter+apache.org@gmail.com", "creation_time": "2002-12-13T11:50:55Z", "is_private": false}, {"count": 1, "tags": [], "creator": "conor@apache.org", "attachment_id": null, "id": 30494, "time": "2003-02-02T06:52:05Z", "bug_id": 15351, "creation_time": "2003-02-02T06:52:05Z", "is_private": false, "text": "There is no problem with JAVA_HOME having spaces but there is qith it having\nquotes. Does it have quotes? Environment variables with spaces can be defined in\nWondows without needing to use quotes.\n"}, {"text": "My original description (which I just re-verified) is accurate as stated.", "tags": [], "bug_id": 15351, "is_private": false, "count": 2, "id": 31332, "time": "2003-02-15T08:56:32Z", "creator": "bogofilter+apache.org@gmail.com", "creation_time": "2003-02-15T08:56:32Z", "attachment_id": null}, {"count": 3, "tags": [], "text": "I asked \"Does it have quotes?\". Can you let me know if your definition of\nJAVA_HOME has quotes?", "is_private": false, "bug_id": 15351, "id": 31336, "time": "2003-02-15T13:47:43Z", "creator": "conor@apache.org", "creation_time": "2003-02-15T13:47:43Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "bogofilter+apache.org@gmail.com", "attachment_id": null, "id": 31351, "time": "2003-02-16T07:22:06Z", "bug_id": 15351, "creation_time": "2003-02-16T07:22:06Z", "is_private": false, "text": "No."}, {"count": 5, "tags": [], "creator": "conor@apache.org", "text": "Fixed.", "id": 31380, "time": "2003-02-17T00:19:55Z", "bug_id": 15351, "creation_time": "2003-02-17T00:19:55Z", "is_private": false, "attachment_id": null}, {"count": 6, "attachment_id": null, "bug_id": 15351, "text": "*** Bug 17510 has been marked as a duplicate of this bug. ***", "id": 32126, "time": "2003-02-28T00:00:03Z", "creator": "conor@apache.org", "creation_time": "2003-02-28T00:00:03Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "creator": "igor.lastric@freesurf.ch", "attachment_id": null, "id": 34463, "time": "2003-04-03T18:17:52Z", "bug_id": 15351, "creation_time": "2003-04-03T18:17:52Z", "is_private": false, "text": "*** Bug 18256 has been marked as a duplicate of this bug. ***"}]