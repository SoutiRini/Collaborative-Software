[{"count": 0, "text": "Weblogic add characters like \"'\" or \":\" in the thread name. Thoses  characters\ncan provide some issues for specific stores like the TxXMLFileDescriptorsStore\nbecause this store is using the Xid name to create some folders. A small patch\nis to drop those characters when a new SlideXid is instantiated.\n\n\nHere is the patch for SlideTransaction : \n\nIndex: SlideTransaction.java\n===================================================================\nRCS file:\n/home/cvspublic/jakarta-slide/src/share/org/apache/slide/transaction/SlideTransaction.java,v\nretrieving revision 1.23\ndiff -u -r1.23 SlideTransaction.java\n--- SlideTransaction.java\t28 Jul 2004 09:34:33 -0000\t1.23\n+++ SlideTransaction.java\t5 Aug 2004 19:31:11 -0000\n@@ -1,7 +1,7 @@\n /*\n- * $Header:\n/home/cvspublic/jakarta-slide/src/share/org/apache/slide/transaction/SlideTransaction.java,v\n1.23 2004/07/28 09:34:33 ib Exp $\n- * $Revision: 1.23 $\n- * $Date: 2004/07/28 09:34:33 $\n+ * $Header:\n/home/cvspublic/jakarta-slide/src/share/org/apache/slide/transaction/SlideTransaction.java,v\n1.22 2004/02/19 16:58:26 ozeigermann Exp $\n+ * $Revision: 1.22 $\n+ * $Date: 2004/02/19 16:58:26 $\n  *\n  * ====================================================================\n  *\n@@ -69,10 +69,7 @@\n         globalCreatedTransactions++;\n         currentTransactionNumber  = globalCreatedTransactions;\n         currentThreadName         = Thread.currentThread().getName();\n-        xid = new SlideXid\n-            ((currentThreadName + \"-\" + System.currentTimeMillis() + \"-\"\n-                  + currentTransactionNumber).getBytes(),\n-             0, new byte[0]);\n+        xid = new SlideXid(this.getName().getBytes(), 0, new byte[0]);\n         this.transactionManager = transactionManager;\n     }\n     \n@@ -708,6 +705,18 @@\n             + \" xid \" + xid + \" in thread \" + currentThreadName +\n             (currentThreadName.equals(Thread.currentThread().getName())?\"\":\n                  \" current= \" + Thread.currentThread().getName());\n+    }\n+    \n+    /**\n+     *  Get the Xid name based on the threadName\n+     */\n+    public String getName()\n+    {\n+        // Some application servers like weblogic add characters like ' or : in\nthe thread name.\n+        // Thoses  character can gives issues for specific stores like the\nTxXMLFileDescriptorsStore\n+        // This store is using the Xid name to create some folders. So, drop\nthoses characters\n+        String currentThreadName =\nThread.currentThread().getName().replaceAll(\"'\", \"\").replaceAll(\":\", \"\");\n+        return currentThreadName + \"-\" + System.currentTimeMillis() + \"-\" +\ncurrentTransactionNumber;\n     }", "creator": "christophe.lombart@sword-technologies.com", "is_private": false, "id": 61602, "time": "2004-08-05T19:41:13Z", "bug_id": 30499, "creation_time": "2004-08-05T19:41:13Z", "tags": [], "attachment_id": null}, {"count": 1, "tags": [], "creator": "ozeigermann@apache.org", "is_private": false, "text": "Right. I already had something like this, but must have messed it up with the\nswitch to commons transactions. I will take care of this ASAP.", "id": 61691, "time": "2004-08-09T08:00:13Z", "bug_id": 30499, "creation_time": "2004-08-09T08:00:13Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "ozeigermann@apache.org", "text": "Can't use replaceAll, though, as it is not available in JDK1.3 :(", "id": 61692, "time": "2004-08-09T08:10:23Z", "bug_id": 30499, "creation_time": "2004-08-09T08:10:23Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "ozeigermann@apache.org", "is_private": false, "text": "Using replace instead and will only apply this to the file stores...", "id": 61693, "time": "2004-08-09T08:11:15Z", "bug_id": 30499, "creation_time": "2004-08-09T08:11:15Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "ozeigermann@apache.org", "text": "I have fixed this in the file stores. Could you check if it works for you?", "id": 61697, "time": "2004-08-09T09:37:31Z", "bug_id": 30499, "creation_time": "2004-08-09T09:37:31Z", "is_private": false, "attachment_id": null}]