[{"count": 0, "tags": [], "bug_id": 11744, "attachment_id": null, "id": 21105, "time": "2002-08-15T20:19:25Z", "creator": "mas@apache.org", "creation_time": "2002-08-15T20:19:25Z", "is_private": false, "text": "Problem observed with 1.5.1, 1.7.0, and nightly build 1.8.0-dev-20020813. \n\nPOIFS does not \"write\" an empty document stream correctly (i.e. a document that\nis zero bytes in length).  Failure is observed when trying to read the document\nin the form of an IOException with the message of either \"Cannot remove block[ 0\n]; out of range\" or \"block[ 0 ] already removed\".\n\nExample method to reproduce:\n\n    // construct a new POIFSFileSystem with an empty document\n    POIFSFileSystem fs = new POIFSFileSystem();\n    fs.getRoot().createDocument(\"Foo\", new ByteArrayInputStream(new byte[0]));\n    \n    // save the document into a byte array\n    ByteArrayOutputStream out = new ByteArrayOutputStream();\n    fs.writeFilesystem(out);\n\n    // now try to read the POIFSFileSystem from that byte array.  \n    new POIFSFileSystem(new ByteArrayInputStream(out.toByteArray()));\n\n\nThis was recently posted on poi-dev, but has been added here to make sure the\nbug is tracked and not forgotten about.  The post on poi-dev has much more\ndetail than what's here.  See: \nhttp://www.mail-archive.com/poi-dev%40jakarta.apache.org/msg03105.html"}, {"count": 1, "tags": [], "text": "Created attachment 11642\nOutlook (CDF?) expects -2 (end of chain) for empty SBAT propertys' start_block", "attachment_id": 11642, "id": 57997, "creator": "anandp@quickmonkey.com", "time": "2004-05-24T23:32:21Z", "bug_id": 11744, "creation_time": "2004-05-24T23:32:21Z", "is_private": false}, {"count": 2, "tags": [], "creator": "trejkaz@trypticon.org", "attachment_id": 20715, "text": "Created attachment 20715\nUnit test\n\nI can confirm that Anand's patch fixes the issue, and here is a unit test I\nwrote while confirming it.", "id": 107307, "time": "2007-08-27T17:53:17Z", "bug_id": 11744, "creation_time": "2007-08-27T17:53:17Z", "is_private": false}, {"count": 3, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "Patch and test applied, thanks", "id": 111411, "time": "2007-12-04T04:56:08Z", "bug_id": 11744, "creation_time": "2007-12-04T04:56:08Z", "is_private": false}]