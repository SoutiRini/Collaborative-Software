[{"count": 0, "tags": [], "creator": "katkere@praja.com", "attachment_id": null, "text": "This is an issue in embedded Tomcat scenario with multiple restarts. The \nLogDaemon thread created by TomcatLogger is not shutdown gracefully and \ncontinues to run even after ContextManager.stop() is called. So, every time \nTomcat is run (by calling ContextManager.start/stop), it adds one to the list \nof active threads.\n\nSimply commenting out <Logger> lines from server.xml eliminates the lingering \nthread problem (which may be the reason the connection handler shutdown methods \ncall System.exit(): for instance Ajp12ConnectionHandler has the following \ncomment:\n\tcontextM.stop();\n\t// same behavior as in past, because it seems that\n\t// stopping everything doesn't work - need to figure\n\t// out what happens with the threads ( XXX )\n\tSystem.exit(0);\n).\n\nLooking at cvs for Tomcat 3.3 and 4.0, the same problem may exist for 3.3 (in a \ndifferent location), but 4.0 seems OK.", "id": 1942, "time": "2001-04-19T17:22:52Z", "bug_id": 1418, "creation_time": "2001-04-19T17:22:52Z", "is_private": false}, {"count": 1, "tags": [], "text": "I think I have a fix, I'll check it in after some testing. We should make sure\nthis is resolved before releasing 3.3", "is_private": false, "id": 1962, "creator": "cmanolache@yahoo.com", "time": "2001-04-20T17:31:48Z", "bug_id": 1418, "creation_time": "2001-04-20T17:31:48Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "cmanolache@yahoo.com", "attachment_id": null, "text": "Fixed most of this, including the Expirer ( which was also hanging ). If you\nplay with shutdown/init and restarting please let me know if you find more \nproblems ( but more improvements will probably come in a fix after 3.3 )", "id": 1969, "time": "2001-04-21T12:38:06Z", "bug_id": 1418, "creation_time": "2001-04-21T12:38:06Z", "is_private": false}]