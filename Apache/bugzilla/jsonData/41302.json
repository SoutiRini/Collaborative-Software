[{"attachment_id": null, "tags": [], "bug_id": 41302, "text": "Hi,\n\nI installaed from source the 2.2.3 version for apache.\nThe configure was\n\n./configure --enable-expires=shared --enable-headers=shared --enable-proxy=shared --enable-proxy-http=shared --enable-rewrite=shared --enable-so --enable-dbd=shared --enable-authn-dbd=shared\n\nI'm trying to use dbd module a together with postgresql 8.1.x to authenticate \nusers.\n\nI \"discovered\" that if I use the following configuration (using VirtualHosts) \nthe database is (seems) never queried\n\nNameVirtualHost 192.168.1.5\nServerName elettra.local.effeci.info\n\n<VirtualHost effeci.homelinux.net>\n        ServerName effeci.effeci.info\n        DBDriver pgsql\n        DBDParams \"port=5432 host=localhost dbname=auth user=xxxx \npassword=xxxx\"\n\n        DocumentRoot /home/http\n        DBDMin     1\n        DBDKeep    1\n        DBDMax     10\n        DBDExptime 0\n\n        <Directory /home/http>\n                Order Deny,Allow\n                AuthType basic\n                AuthName \"Mio\"\n                AuthBasicProvider dbd\n                AuthDBDUserPWQuery \"select pass from users where login = %s\"\n                require valid-user\n        </Directory>\n</VirtualHost>\n\nIf I delete the VirtualHost configuration, the first ServerName and \nNameVirtualHost directives everything work fine.\n\nI found in bug 41141 that there is a \"reference\" to VirtualHost inheritance \nproblem, is the same bug?\n\nRegards\nChristian", "count": 0, "id": 97698, "time": "2007-01-05T08:35:06Z", "creator": "christian.fontana@gmail.com", "creation_time": "2007-01-05T08:35:06Z", "is_private": false}, {"count": 1, "tags": [], "creator": "chrisd@apache.org", "attachment_id": null, "id": 97700, "time": "2007-01-05T10:02:29Z", "bug_id": 41302, "creation_time": "2007-01-05T10:02:29Z", "is_private": false, "text": "I think you're probably running into some problems in mod_dbd right now\nthat relate to virtual hosts and configuration inheritence.  I described\nthem in more detail here, in the fourth section:\n\nhttp://marc.theaimsgroup.com/?l=apache-httpd-dev&m=116742014418304&w=2\n\nThe part that deals with the inheritence issues is the fourth \"groups\"\npatch here:\n\nhttp://people.apache.org/~chrisd/patches/mod_dbd_pools_groups/\n\nI've committed the first two patches from there to trunk, but I've had\nto go back and do some more work on the third \"pools\" one to make sure it\nworks with single-process MPMs, and I'm still waiting to find some time\nto test that; that relates to this bug report:\n\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=39985\n\nSo, if you can wait a bit, I'm aiming to get both patches into trunk\nfairly soon.  If you feel like trying to apply them to 2.2.3 yourself,\ngo for it, and let me know if the \"groups\" change fixes your problem."}, {"count": 2, "tags": [], "creator": "christian.fontana@gmail.com", "is_private": false, "id": 97715, "creation_time": "2007-01-06T05:34:32Z", "time": "2007-01-06T05:34:32Z", "bug_id": 41302, "text": "Thanks for your answers.\n\n> \n> http://marc.theaimsgroup.com/?l=apache-httpd-dev&m=116742014418304&w=2\n> \n\nI read more than once your post and I think I didn't understood it completely. \nBut the problem seems to be the one you describe.\n\n> So, if you can wait a bit, I'm aiming to get both patches into trunk\n> fairly soon.  \n\nYes, I can wait. The system is not yet productive. I'm testing different \nsolutions an the one based on SQL seems to be the perfect one in order not to \nduplicate credentials and use the alredy present corporate user repository.\n\n> If you feel like trying to apply them to 2.2.3 yourself,\n> go for it, and let me know if the \"groups\" change fixes your problem.\n\nI tried simply with patch p0 < <patch name> but I receive some errors. I \nsuppose it's due to the fact that the patch is written for the trunk version \nof mod_dbd, isn't it? \n\nI don't know so well the apr utils library to try to adapt the code. I'm going \nto try but I have before to understand how the module works and above all the \napr interface.\n\nThanks", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 41302, "is_private": false, "count": 3, "id": 99004, "time": "2007-02-05T21:18:34Z", "creator": "chrisd@apache.org", "creation_time": "2007-02-05T21:18:34Z", "text": "If you get a chance, could you test your original problematic configuration\nwith the latest mod_dbd.c from trunk?  I can't tell from your report if\nmy most recent changes will address your problem, but I think they might.\nPlease let me know what you find!  Thanks."}, {"count": 4, "tags": [], "bug_id": 41302, "attachment_id": null, "text": "(In reply to comment #3)\n> If you get a chance, could you test your original problematic configuration\n> with the latest mod_dbd.c from trunk?  \n\nFor sure I can test your code but I need some help. Is it enough to download \nthe apache 2.2.4 and the mod_dbd code from cvs and then compile as usual?", "id": 99057, "time": "2007-02-07T04:57:25Z", "creator": "christian.fontana@gmail.com", "creation_time": "2007-02-07T04:57:25Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 41302, "is_private": false, "count": 5, "id": 99067, "time": "2007-02-07T09:28:05Z", "creator": "chrisd@apache.org", "creation_time": "2007-02-07T09:28:05Z", "text": "Yes, that should be fine; I've compiled the mod_dbd.c code from trunk\nwith 2.2.3 and there are no problems there.  Any recent 2.2.x should be OK\nfor testing, so long as you're using the mod_dbd.c from trunk.  Thanks."}, {"count": 6, "tags": [], "creator": "christian.fontana@gmail.com", "text": "Sorry for the delay, but I was busy.\n\nI tested and it works fine: the database is correctly contacted.\n\nthanks\nchristian", "id": 99505, "time": "2007-02-16T14:56:48Z", "bug_id": 41302, "creation_time": "2007-02-16T14:56:48Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 41302, "attachment_id": null, "is_private": false, "id": 103250, "time": "2007-05-15T18:37:35Z", "creator": "chrisd@apache.org", "creation_time": "2007-05-15T18:37:35Z", "text": "*** Bug 42327 has been marked as a duplicate of this bug. ***"}]