[{"count": 0, "tags": [], "text": "Created attachment 28423\nPatch to resolve issue against http://svn.apache.org/repos/asf/poi/tags/REL_3_7\n\nAttempting to run ColumnHelper.getColumnWidth on a large worksheet (>110,000 rows) with a large number of merged regions (>40,000) runs for a very long time (ran for an entire weekend before it was noticed and aborted).\n\nThis method contains a loop across merged regions nested within a loop across rows, and several substantial methods are being called within the inner loop, possibly on the order of a billion times in my example.\n\nHowever, many of these time-consuming calls are retrieving static data in the context of this method, so the code can be refactored such that they're only run once (or once per row), and the results cached. The main problem calls are:\n\ngetNumMergedRegions()\ngetMergedRegion(i)\ngetRowNum()\n\nWith the code refactored thusly, the method ran within a few minutes.\n\nA patch is attached with these suggested changes. The patch is based on the REL_3_7 tag.", "attachment_id": 28423, "bug_id": 52834, "id": 154555, "time": "2012-03-06T02:02:38Z", "creator": "aron.nopanen@futrix.com", "creation_time": "2012-03-06T02:02:38Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 52834, "attachment_id": null, "id": 185536, "time": "2015-09-29T13:34:28Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-09-29T13:34:28Z", "is_private": false, "text": "As far as I see this method is not in ColumnHelper any more and XSSFSheet.getColumnWidth() does not handle merged regions specially, so I this seems to not be applicable any more. \n\nPlease post an updated patch and if possible some accompanying unit tests if this is still a problem for you."}, {"count": 2, "tags": [], "bug_id": 52834, "text": "Created attachment 33152\nEquivalent patch for release 3.11 (REL_3_11_FINAL tag)\n\nThis patch provides equivalent functionality to the old one targeting REL_3_7.", "id": 185544, "time": "2015-09-29T17:40:37Z", "creator": "aron.nopanen@futrix.com", "creation_time": "2015-09-29T17:40:37Z", "is_private": false, "attachment_id": 33152}, {"count": 3, "tags": [], "bug_id": 52834, "attachment_id": null, "id": 185545, "time": "2015-09-29T17:42:36Z", "creator": "aron.nopanen@futrix.com", "creation_time": "2015-09-29T17:42:36Z", "is_private": false, "text": "@Dominik - while the code has been refactored, the problem remains. Some time ago I created an equivalent patch against version 3.11; I thought I'd posted it here, but apparently not. Anyhow, I just did so.\n\nSorry, no relevant unit tests at this point."}]