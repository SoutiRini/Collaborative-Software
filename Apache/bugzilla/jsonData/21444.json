[{"count": 0, "tags": [], "bug_id": 21444, "attachment_id": null, "text": "> From: Andrew C. Oliver <acoliver@apache.org>\n   > Subject: Re: function table\n   > Sent: 09 Jul 2003 23:08:38\n\nIIRC, those are \"reserved\" or non-implemented.  We haven't yet implemented\n\"macro functions\"...  Shouldn't be hard to implement I suppose if we just\nadd a lookup for the POIFS filesystem in the event it can't lookup the\nfunction to verify its there and just use it...Otherwise we should probably\nthrow an exception.\n\nSomeone should put this in bugzilla as an [RFE] Macro functions if it isn't\nalready there.", "id": 40288, "time": "2003-07-09T19:04:56Z", "creator": "pkrause@soundbite.com", "creation_time": "2003-07-09T19:04:56Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 21444, "attachment_id": 7337, "text": "Created attachment 7337\nsupport for NamePtg.toFormulaString (no test cases)", "id": 40863, "time": "2003-07-16T20:56:25Z", "creator": "pkrause@soundbite.com", "creation_time": "2003-07-16T20:56:25Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 21444, "attachment_id": null, "text": "Posted a patch that makes toFormulaString work for macro functions that have \ninternal names.  Test cases to follow later - this patch is huge enough already.\n\nIssues:\n\n1. signature change\n AbstractFunctionPtg.toFormulaString(SheetReferences) is now\n AbstractFunctionPtg.toFormulaString(Workbook).\n\nThis is an incompatible change.\n\n2. NamePtg's field_3_zero\n Ugly hack to getSize to get around this.  See email on this topic for more \ninformation.\n\n\n", "id": 40864, "time": "2003-07-16T21:02:55Z", "creator": "pkrause@soundbite.com", "creation_time": "2003-07-16T21:02:55Z", "is_private": false}, {"count": 3, "tags": [], "text": "Created attachment 7353\nsrc/testcases/org/apache/poi/hssf/data/SquareMacro.xls is a small Excel file that defines and uses the SQUARE macro", "attachment_id": 7353, "id": 40919, "creator": "pkrause@soundbite.com", "time": "2003-07-17T18:42:24Z", "bug_id": 21444, "creation_time": "2003-07-17T18:42:24Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 21444, "attachment_id": 7354, "text": "Created attachment 7354\ntest case", "id": 40920, "time": "2003-07-17T18:47:18Z", "creator": "pkrause@soundbite.com", "creation_time": "2003-07-17T18:47:18Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 21444, "attachment_id": null, "id": 41422, "time": "2003-07-24T17:07:55Z", "creator": "poi-support@buni.org", "creation_time": "2003-07-24T17:07:55Z", "is_private": false, "text": "Whhy no unit tests? :-(\n\nI'm marking half this patch to be applied.. . The half with unit tests ;-)"}, {"count": 6, "tags": [], "bug_id": 21444, "attachment_id": null, "text": "The unit tests are posted separatly from the patch, but they belong together.\n\nThe procedure to follow is:\n1. Apply unit tests (7354) and excel file (7353).\n2. Run unit tests.  Watch them fail.\n3. Apply the patch (7337).  Run the unit tests again.  They should work now.\n4. Commit.\n\nThat being said, I have discovered a problem with an interaction betwen macros \nand nested IFs.  Stand by for an updated patch.  I would have posted it sooner, \nbut HEAD has been massively broken since July 18.  Since it doesn't look the \nHEAD is going to get fixed anytime soon, these patches will have to be checked \nmost carefully.", "id": 41435, "time": "2003-07-24T17:25:08Z", "creator": "pkrause@soundbite.com", "creation_time": "2003-07-24T17:25:08Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 21444, "attachment_id": 7495, "text": "Created attachment 7495\nrevised SquareMacro.xls", "id": 41436, "time": "2003-07-24T17:26:35Z", "creator": "pkrause@soundbite.com", "creation_time": "2003-07-24T17:26:35Z", "is_private": false}, {"count": 8, "tags": [], "creator": "poi-support@buni.org", "text": "you should be doing these against the REL_2_BRANCH...", "id": 41439, "time": "2003-07-24T17:39:04Z", "bug_id": 21444, "creation_time": "2003-07-24T17:39:04Z", "is_private": false, "attachment_id": null}, {"count": 9, "attachment_id": 7498, "creator": "pkrause@soundbite.com", "text": "Created attachment 7498\nrevised patch (test cases included) against HEAD", "id": 41451, "time": "2003-07-24T18:55:31Z", "bug_id": 21444, "creation_time": "2003-07-24T18:55:31Z", "tags": [], "is_private": false}, {"count": 10, "tags": [], "bug_id": 21444, "attachment_id": null, "text": "Revised patch handles nested macros and IF/macro nesting.\n\nAndy is right that this patch needs to be made against 2.0, but my workspace \nwas pointed at HEAD.  Now that it is posted. I will follow up with another \npatch against 2.0 as soon as I reconfigure my workspace.\n\nProcedure for this patch:\n1. Install 7495 as src/testcases/org/apache/poi/hssf/data/SquareMacro.xls.\n2. Patch 7498 against HEAD.\n3. Build, Test, and Commit.\n\nAvik, please note that this revised patch includes a completely rewritten \nNamePtg, including an implementation of writeBytes.  NameRecord also has a lot \nof changes, including several new accessors for reading the options field.", "id": 41453, "time": "2003-07-24T19:06:08Z", "creator": "pkrause@soundbite.com", "creation_time": "2003-07-24T19:06:08Z", "is_private": false}, {"count": 11, "tags": [], "bug_id": 21444, "attachment_id": null, "text": "I'll put this in after we release 2.0pre3 this week. Dont want to destabilise\nthat atm. ", "id": 41597, "time": "2003-07-27T19:28:30Z", "creator": "avik@apache.org", "creation_time": "2003-07-27T19:28:30Z", "is_private": false}, {"count": 12, "tags": [], "bug_id": 21444, "attachment_id": 7555, "text": "Created attachment 7555\npatch against REL_2_BRANCH", "id": 41691, "time": "2003-07-28T23:00:38Z", "creator": "pkrause@soundbite.com", "creation_time": "2003-07-28T23:00:38Z", "is_private": false}, {"count": 13, "tags": [], "bug_id": 21444, "attachment_id": null, "text": "I finally finished reconfiguring my workspace, so here is the patch against the \nrelease 2 branch.  This patch is completely automatic, and all the test cases \npass, so it should be safe to apply it as is.\n\nProcedure for this patch:\n1. Install 7495 as src/testcases/org/apache/poi/hssf/data/SquareMacro.xls.\n2. Patch 7555 against REL_2_BRANCH.\n3. Build, Test, and Commit.\n\n", "id": 41692, "time": "2003-07-28T23:04:46Z", "creator": "pkrause@soundbite.com", "creation_time": "2003-07-28T23:04:46Z", "is_private": false}, {"count": 14, "tags": [], "bug_id": 21444, "attachment_id": null, "text": "I think this is great.. however, since this is a very large patch, will apply\nthem after sleeping over it for a day. I think this solves a lot of our issues..\nso thanks.", "id": 41884, "time": "2003-07-31T18:34:29Z", "creator": "avik@apache.org", "creation_time": "2003-07-31T18:34:29Z", "is_private": false}, {"count": 15, "tags": [], "bug_id": 21444, "attachment_id": null, "text": "Checked in to REL_2_BRANCH and HEAD. Thanks a lot Paul. Please cross check.\nMaybe we should have a few more testcases for the toFormulaString\nimplementations for named ranges and 3DAreas. ", "id": 43203, "time": "2003-08-23T19:50:09Z", "creator": "avik@apache.org", "creation_time": "2003-08-23T19:50:09Z", "is_private": false}]