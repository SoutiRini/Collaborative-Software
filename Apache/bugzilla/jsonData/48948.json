[{"attachment_id": null, "tags": [], "creator": "kidder.scott@gmail.com", "text": "The ap_construct_url core API function does not properly handle the case where a request specifies a 'HOST' HTTP request header with malformed data.\n\nTo reproduce this bug, I use CURL in the following manner:\n\n  curl -H \"Host:foo.com, foo.com\" http://foo.com/something.html\n\nA module that I've written to pre-process requests invokes the ap_construct_url function in the following way:\n\n  char *inferred_url = ap_construct_url(req->pool, req->uri, req);\n\nIn my experience, the value of inferred_url is invariably:\n\n  http://foo.com, foo.com/something.html\n\nI know that it's incorrect for hosts to supply multiple values for the HOST request parameter.  But I have seen this occur.  In any case, Apache should handle it differently.  It might:\n\n(a) tokenize the HOST parameter by comma and use the first token value\n(b) use some other source for the hostname given in the request\n(c) indicate an error", "count": 0, "id": 135480, "time": "2010-03-19T18:41:02Z", "bug_id": 48948, "creation_time": "2010-03-19T18:41:02Z", "is_private": false}, {"count": 1, "tags": [], "text": "marking WONTFIX, I don't think httpd should mask broken clients/proxies/??? by trying to cope with this.", "is_private": false, "id": 149729, "creator": "covener@gmail.com", "time": "2011-09-25T18:00:01Z", "bug_id": 48948, "creation_time": "2011-09-25T18:00:01Z", "attachment_id": null}]