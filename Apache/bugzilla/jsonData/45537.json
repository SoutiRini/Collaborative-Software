[{"count": 0, "tags": [], "creator": "grizolle_benedicte@emc.com", "attachment_id": 22361, "is_private": false, "id": 119356, "time": "2008-08-04T08:06:24Z", "bug_id": 45537, "creation_time": "2008-08-04T08:06:24Z", "text": "Created attachment 22361\nContains JUnit test class and documents used for testing.\n\nThe text contained in the header and footer of a power point 2003 document is not extracted.\nFind in attachments the JUnit test class and the documents used for testing.\nWe expected to extract the word \"testdoc\" and \"test phrase\".\n\nnotes on the attached document:\n\n- the document \"Header.ppt\" contains the words \"testdoc\" and \"test phrase\" in the header.\n\n- the document \"Footer.ppt\" contains the words \"testdoc\" and \"test phrase\" in the footer.\n\n\n\"TestUnitPoi35Filter.java\" is the JUnit class."}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "is_private": false, "id": 119410, "time": "2008-08-05T09:35:43Z", "bug_id": 45537, "creation_time": "2008-08-05T09:35:43Z", "text": "There seems to be a bug in the header/footer support in hslf. For some reason, the headers and footers are showing as null.\n\nI've updated the powerpoint text extractor to include the headers and footers when found, but for now that won't help as they're not coming through\n\nThere's a disabled unit test in svn trunk for this, for when someone has a chance to look at powerpoint headers/footers. It's in src/scratchpad/testcases/org/apache/poi/hslf/extractor/TextExtractor.java"}, {"count": 2, "tags": [], "text": "I recently implemented usermodel support for headers / footers in HSLF:\nhttp://poi.apache.org/hslf/how-to-shapes.html#HeadersFooters\n\nYou may want to leverage it in the text extractor.\n\nYegor", "is_private": false, "id": 119411, "creation_time": "2008-08-05T09:55:17Z", "time": "2008-08-05T09:55:17Z", "creator": "yegor@dinom.ru", "bug_id": 45537, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 45537, "is_private": false, "id": 119412, "creation_time": "2008-08-05T10:05:42Z", "time": "2008-08-05T10:05:42Z", "creator": "apache@gagravarr.org", "text": "The problem is that the HeaderFooter object is returning null for the text in cases where I know there to be text there :(", "attachment_id": null}, {"count": 4, "attachment_id": null, "creator": "yegor@dinom.ru", "is_private": false, "id": 119414, "time": "2008-08-05T10:25:11Z", "bug_id": 45537, "creation_time": "2008-08-05T10:25:11Z", "tags": [], "text": "(In reply to comment #3)\n> The problem is that the HeaderFooter object is returning null for the text in\n> cases where I know there to be text there :(\n>\n\nYou only check headers / footers for slides. The missing ones are notes headers/footers.\n\nAdd the following code and all should be fine: \n\nif(getNoteText) {\n        \n        HeadersFooters hd = _show.getNotesHeadersFooters();\n        if(hd.isFooterVisible()) {\n            ret.append(hd.getFooterText() + \"\\n\");\n        }\n        if(hd.isHeaderVisible()) {\n            ret.append(hd.getHeaderText() + \"\\n\");\n        }\n}\n\nYegor"}, {"count": 5, "attachment_id": null, "creator": "apache@gagravarr.org", "text": "Thanks for that spot Yegor, I hadn't realised that the header/footer could be on notes too :/\n\nNow fixed in svn trunk - slide headers/footers are included by default, and notes headers/footers are included when notes are extracted", "id": 119442, "time": "2008-08-05T15:49:44Z", "bug_id": 45537, "creation_time": "2008-08-05T15:49:44Z", "tags": [], "is_private": false}]