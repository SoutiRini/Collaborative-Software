[{"count": 0, "tags": [], "text": "I'm not even sure this couldn't be mode to work or integrate with \n<XmlValidate>, but the latter didn't appear to validate against Schema (but I \ncould be wrong).\n\nAnyhow, this task simply rips off the dom.Writer example of Xerces-J 2.2.1 to \nload an XML file, with schema validation ON (can be configured to be strict or \nnot). If the XML is schema vaild, then nothing happens (and nothing is output). \nIf it's not, outputs the Xerces error (which is kinda human readable...), and \nthrows a build exception.\n\nI didn't try to make this task Jaxp-compatible, and directly used Xerces-J \nwhich is a compile-time (and thus runtime) dependency. I was surprised to \ndiscover the xmlParserAPIs.jar of Xerces has range classes not in JDK 1.4 which \nare required by Xerces-J!!!\n\nFeeble attempt to make this a condition too. Hopefully someone will find this \nuseful. I couldn't have written a schema for my XML without this task (Schemas \nare such strange beats).\n\nThanks for any comments, --DD", "attachment_id": null, "id": 26488, "creator": "ddevienne@lgc.com", "time": "2002-11-18T16:34:47Z", "bug_id": 14641, "creation_time": "2002-11-18T16:34:47Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 14641, "attachment_id": 3879, "id": 26489, "time": "2002-11-18T16:35:37Z", "creator": "ddevienne@lgc.com", "creation_time": "2002-11-18T16:35:37Z", "is_private": false, "text": "Created attachment 3879\nThe stand-alone <schemavalid> task/condition (which depends on Xerces-J 2.2.1)."}, {"count": 2, "tags": [], "creator": "ddevienne@lgc.com", "text": "Note that the XML document/file must declare the Schema-instance namespace, and \nspecify the location of the Schema using either xsi:noNamespaceSchemaLocation \nor xsi:schemaLocation for the validation to actually take place (as shown \nbelow). I have no clue whether validation for can be forced to happen without \nthese declarations... If anybody knows how to do that, please let me know. --DD\n\n<root xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n      xsi:noNamespaceSchemaLocation=\"root.xsd\"\n      root-attributes... />", "id": 26491, "time": "2002-11-18T16:40:29Z", "bug_id": 14641, "creation_time": "2002-11-18T16:40:29Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "Usage example:\n\n  <target name=\"validate\" depends=\"init, -buildmagic\"\n          description=\"Ensure dependencies.xml is valid against its schema\">\n    <schemavalid file=\"dependencies.xml\" />\n  </target>\n\nCan also take a nested <fileset> in addition to the 'file' attribute.\n\nHere's an example output of a schema error (task is silent without errors):\n\nP:\\com_lgc\\tahoe\\modules>build validate\nBuildfile: P:\\com_lgc\\tahoe\\modules\\build.xml\n\nvalidate:\ndependencies.xml:10:11:cvc-complex-type.2.4.a: Invalid content starting with \nelement 'dummy'. The content must match '((\"\":description){0-1},(\"\":project){1-\nUNBOUNDED})'.\n\nBUILD FAILED\nfile:P:/com_lgc/tahoe/modules/build.xml:75: org.xml.sax.SAXParseException: cvc-\ncomplex-type.2.4.a: Invalid content starting with element 'dummy'. The content \nmust match '((\"\":description){0-1},(\"\":project){1-UNBOUNDED})'.\n\nTotal time: 2 seconds", "is_private": false, "id": 26493, "creator": "ddevienne@lgc.com", "time": "2002-11-18T16:46:41Z", "bug_id": 14641, "creation_time": "2002-11-18T16:46:41Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 14641, "text": "<xmlvalidate> in CVS HEAD can validate schema - see the testSchemaGood and\ntestSchemaBad testcases in Ant's src/etc/testcases/taskdef/optional/xmlvalidate.xml\n\nCould you please look into it and see whether your task provides some additional\nfunctionality (and if so, enhance <xmlvalidate> ;-)?", "count": 4, "id": 26561, "time": "2002-11-19T13:01:29Z", "creator": "bodewig@apache.org", "creation_time": "2002-11-19T13:01:29Z", "is_private": false}, {"count": 5, "tags": [], "text": "This is what I get when I try to use <xmlvalidate>:\n\nP:\\com_lgc\\tahoe\\modules>build validate2\nBuildfile: P:\\com_lgc\\tahoe\\modules\\build.xml\n\nBUILD FAILED\nfile:P:/com_lgc/tahoe/modules/build.xml:83: The <xmlvalidate> task doesn't \nsupport the nested \"attribute\" element.\n\nTotal time: 1 second\n\n\nwith the build file fragment:\n\n  <target name=\"validate2\" depends=\"init\"\n          description=\"Ensure dependencies.xml is valid against its schema\">\n    <xmlvalidate warn=\"true\" lenient=\"false\">\n      <fileset dir=\".\" includes=\"dependencies.xml\" />\n      <attribute name=\"http://xml.org/sax/features/namespaces\"\n                 value=\"true\" />\n      <attribute name=\"http://xml.org/sax/features/validation\"\n                 value=\"true\" />\n      <attribute name=\"http://apache.org/xml/features/validation/schema\"\n                 value=\"true\" />\n      <attribute name=\"http://apache.org/xml/features/validation/schema-full-\nchecking\"\n                 value=\"true\" />\n    </xmlvalidate>\n  </target>\n\nSo it seems this is not available in Ant 1.5.1. Which seems consistent with the \ndocumentation that doesn't list <attribute> as a possible nested element, and \nnothing said about being able to validate against schemas in the text nor the \nexamples. I also find the attribute setting cumbersome, although it's generic \nof course.\n\nSo I guess I need to keep my <schemavalid> task/condition until <xmlvalidate>\nsupporting schema validation is supported. --DD", "attachment_id": null, "id": 26576, "creator": "ddevienne@lgc.com", "time": "2002-11-19T15:26:04Z", "bug_id": 14641, "creation_time": "2002-11-19T15:26:04Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 14641, "text": "like I said, in CVS HEAD.\n\nKeeping your task doesn't mean you couldn't help to enhance the CVS version of\n<xmlvalidate>.  Having it as a condition sounds nice, for example.", "id": 26577, "time": "2002-11-19T15:30:59Z", "creator": "bodewig@apache.org", "creation_time": "2002-11-19T15:30:59Z", "is_private": false, "attachment_id": null}, {"count": 7, "attachment_id": null, "creator": "ddevienne@lgc.com", "text": "Hoops, sorry, I missed that part. That would have saved me the time trying. My \n(youger) friends tell me I'm plagged by the way reading was taught in France \nwhen I was in school, when they tried an experimental fast reading technique \nskipping a lot of words, and infering the meaning ;-) So you see, it's not \nreally my fault!!! Thanks Stefan, --DD\n\nPS: I'm busy on <subant> right now, so I'll leave <xmlvalidate> aside for now.", "id": 26579, "time": "2002-11-19T15:35:59Z", "bug_id": 14641, "creation_time": "2002-11-19T15:35:59Z", "tags": [], "is_private": false}, {"count": 8, "tags": [], "text": "At the very least, we need to correct XmlValidates documentation. I think dd's\npatch has an ease of use advantage, BTW.", "attachment_id": null, "id": 26597, "creator": "stevel@apache.org", "time": "2002-11-19T17:24:43Z", "bug_id": 14641, "creation_time": "2002-11-19T17:24:43Z", "is_private": false}, {"count": 9, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 72594, "time": "2005-03-17T15:26:43Z", "bug_id": 14641, "creation_time": "2005-03-17T15:26:43Z", "is_private": false, "text": "I suppose 1.7's schemavalidate task should work."}]