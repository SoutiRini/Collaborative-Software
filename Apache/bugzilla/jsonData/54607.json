[{"count": 0, "tags": [], "creator": "nikola.stohanzl@ness.com", "is_private": false, "text": "Created attachment 29988\ntrivial test case, created in Excel 2010\n\nException in thread \"main\" java.lang.NullPointerException\n\tat org.apache.poi.ss.util.CellReference.<init>(CellReference.java:88)\n\tat org.apache.poi.xssf.usermodel.XSSFSheet.getTopRow(XSSFSheet.java:1181)\n\tat poi.ReadTest.main(ReadTest.java:22)\n\nfor the second sheet (note the first visible row of first sheet is 2). File is created in Excel 2010, saving it in xls format (Excel 97-2003) solves the issue.\n\nTo reproduce:\n\nWorkbook wb = WorkbookFactory.create(new File(\"c:/0/xxx.xlsx\"));\nfor (int si = 0; si < wb.getNumberOfSheets(); si++) {\n\tSheet sh = wb.getSheetAt(si);\n\tSystem.out.println(sh.getSheetName() + \"/\" + sh.getTopRow());\n}", "id": 165472, "time": "2013-02-25T08:45:08Z", "bug_id": 54607, "creation_time": "2013-02-25T08:45:08Z", "attachment_id": 29988}, {"count": 1, "tags": [], "creator": "dominik.stadler@gmx.at", "text": "It seems POI expects that sheets do have an attribute like this in sheetX.xml:\n    topLeftCell=\"A2\" \n\nHowever for your test-example, there is no such entry in sheet2.xml, seems the attribute is only there if a non-default top-row is set, but poi does not expect that. Other test-examples also don't have the attribute, seems a simple null check is missing.\n\nBTW, the same applies for getLeftCol() for XSSF/SXSSF.", "id": 167496, "time": "2013-05-30T08:44:45Z", "bug_id": 54607, "creation_time": "2013-05-30T08:44:45Z", "is_private": false, "attachment_id": null}, {"count": 2, "attachment_id": null, "bug_id": 54607, "text": "Fixed with SVN r1493686\n\n        M       src/ooxml/java/org/apache/poi/xssf/usermodel/XSSFSheet.java\n        M       src/ooxml/testcases/org/apache/poi/xssf/usermodel/TestXSSFSheet.java\n        A       test-data/spreadsheet/54607.xlsx\n\nAdded a null-check as well as test-cases covering these changes.", "id": 167870, "time": "2013-06-17T11:45:44Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2013-06-17T11:45:44Z", "tags": [], "is_private": false}]