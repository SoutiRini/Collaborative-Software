[{"count": 0, "tags": [], "text": "Howdy,\n\nWe are running Apache 1.3.27 on a pair of Redhat Linux 7.3 web servers. For \nsome reason, Apache will hang every 4 -5 days, and stop answering requests. The \nonly errors we receive are:\n\n[Wed Sep 10 13:20:13 2003] [notice] child pid 20902 exit signal Segmentation \nfault (11)\n[Wed Sep 10 13:20:53 2003] [notice] child pid 20899 exit signal Segmentation \nfault (11)\n[Wed Sep 10 13:21:00 2003] [notice] child pid 24929 exit signal Segmentation \nfault (11)\n[Wed Sep 10 13:21:01 2003] [notice] child pid 20901 exit signal Segmentation \nfault (11)\n[Wed Sep 10 13:21:50 2003] [notice] child pid 16969 exit signal Segmentation \nfault (11)\n[Wed Sep 10 13:21:51 2003] [notice] child pid 16963 exit signal Segmentation \nfault (11)\n[Wed Sep 10 13:22:39 2003] [notice] child pid 20861 exit signal Segmentation \nfault (11)\n[Wed Sep 10 13:22:46 2003] [notice] child pid 25042 exit signal Segmentation \nfault (11)\n\nas each child dies off. I have read through the archives, and thought that core \ndumps were not enabled, so I added \"ulimit -c unlimited\" to the rc script, and \nadded CoreDumpDirectory in my httpd.conf (the directory this points to is \nwriteable by root and the user the web server runs as). When I attach to the \nmain Apache process during one of these hangs, I see the following:\n\n(gdb) where\n#0  0x4020941e in select () from /lib/libc.so.6\n#1  0x08086078 in __DTOR_END__ ()\n#2  0x080602bc in standalone_main ()\n#3  0x08060aa3 in main ()\n#4  0x4014a1c4 in __libc_start_main () from /lib/libc.so.6\n\nI relaize this isn't the most helpful bt, but trying to give you as much info \nas I can. Here is the output of ps during the hang:\n\npache   20154  0.0  0.0     0    0 ?        Z    Sep07   0:07 [httpd <defunct>]\napache   20156  0.0  0.0     0    0 ?        Z    Sep07   0:07 [httpd <defunct>]\napache   24703  0.0  0.0     0    0 ?        Z    12:55   0:00 [httpd <defunct>]\napache   24713  0.0  0.0     0    0 ?        Z    12:56   0:00 [httpd <defunct>]\napache   24735  0.0  0.0     0    0 ?        Z    12:57   0:00 [httpd <defunct>]\napache   24802  0.0  0.0     0    0 ?        Z    13:03   0:00 [httpd <defunct>]\napache   24803  0.0  0.0 39232 2856 ?        S    13:03   0:00 [httpd]\napache   24804  0.0  0.0     0    0 ?        Z    13:03   0:00 [httpd <defunct>]\napache   24823  0.0  0.0     0    0 ?        Z    13:05   0:00 [httpd <defunct>]\napache   24843  0.0  0.0     0    0 ?        Z    13:07   0:00 [httpd <defunct>]\napache   24882  0.0  0.0     0    0 ?        Z    13:07   0:00 [httpd <defunct>]\napache   24883  0.0  0.0     0    0 ?        Z    13:07   0:00 [httpd <defunct>]\napache   24690  0.0  0.0 39440 3500 ?        T    12:55   0:00 [httpd]\napache   24884  0.0  0.0 39128 2488 ?        T    13:07   0:00 [httpd]\napache   16257  0.0  0.1 39912 3984 ?        T    Sep07   0:07 [httpd]\napache   16260  0.0  0.1 39904 3996 ?        T    Sep07   0:07 [httpd]\napache   16360  0.0  0.1 39804 3876 ?        T    Sep07   0:07 [httpd]\nroot     14716  0.0  0.0 38960 2344 ?        T    Sep05   0:00 /usr/sbin/httpd -\nDHAVE_ACCESS -DHAVE_PROXY -DHAVE_AUTH_ANON -DHAVE_ACTIONS -DHAVE_ALIAS -\nDHAVE_ASIS -DHAVE_AUTH -DHAVE_AUTOINDEX -DHAVE_AUTH_DB -DHAVE_AUTH_DBM -\nDHAVE_SSL -DHAVE_CERN_META -DHAVE_CGI -DHAVE_DIGEST -DHAVE_DIR -DHAVE_ENV -\nDHAVE_EXAMPLE -DHAVE_EXPIRES -DHAVE_HEADERS -DHAVE_IMAP -DHAVE_INCLUDE -\nDHAVE_INFO -DHAVE_LOG_AGENT -DHAVE_LOG_CONFIG -DHAVE_LOG_REFERER -DHAVE_MIME -\nDHAVE_MIME_MAGIC -DHAVE_MMAP_STATIC -DHAVE_NEGOTIATION -DHAVE_REWRITE -\nDHAVE_SETENVIF -DHAVE_SPELING -DHAVE_STATUS -DHAVE_UNIQUE_ID -DHAVE_USERDIR -\nDHAVE_USERTRACK -DHAVE_VHOST_ALIAS -DHAVE_AUTH_LDAP -DHAVE_PHP4 -DHAVE_WL_SSL\n\nWe are only utilizing the AUTH_LDAP and BEA Weblogic modules, and I have \nattached teh versions of all the applicable RPMs:\n\n\nglibc-common-2.2.5-42\nglibc-2.2.5-42\napache-1.3.27-2\nauth_ldap-1.6.0-9\nnetscape-ldapsdk-opt-5.08-5\nopenldap-2.0.23-4\nnss_ldap-189-4\n\nIf you have any recommendations on ways to dump core ( I tried kill -SIGSEGV \nPID), I am all ears. This would allow me to pinpoint where the hangup is \noccurring. If there are any additional debug flags I can enable, I can do this \nas well. The web servers that keep Segfaulting have a pretty decent load on \nthem.\n\nThank you,\n- Ryan", "attachment_id": null, "bug_id": 23084, "id": 43994, "time": "2003-09-10T20:37:41Z", "creator": "matty91@bellsouth.net", "creation_time": "2003-09-10T20:37:41Z", "is_private": false}, {"count": 1, "tags": [], "text": "see http://www.apache.org/~trawick/mod_prctl.c for a module you'll need with\nApache 1.3 on Linux 2.4 kernels in order for the Linux kernel to take a core dump\n\ncompile via \"apxs -c mod_prctl.c\" and add \"LoadModule prctl_module\n/path/to/mod_prctl.so\" to the end of your conf file\n\nyou still need to satisfy the other more usual requirements for a core dump\n(ulimit, CoredumpDirectory and/or file permissions, disk space)\n\nif coredump/backtrace suggests that this is an Apache httpd problem and you can\nrecreate with our latest (not RedHat's) Apache httpd, please re-open the PR and\nsubmit a backtrace\n\nfor now we assume it is not our problem\n\n", "is_private": false, "bug_id": 23084, "id": 49397, "time": "2003-12-19T01:10:01Z", "creator": "trawick@apache.org", "creation_time": "2003-12-19T01:10:01Z", "attachment_id": null}]