[{"count": 0, "tags": [], "text": "Hi all,\n\nI'm using Apache 2.0.44 on a old Sun Sparc Station 5 under NetBSD 1.6. I think,\nthere is no problem on this server as another Apache 1.3.26 is running on an\nother port w/o troubles. \n\nThis station has 2 ethernets card :\n\n- 1 connected to my internal network w/ a fixed address (192.168.0.3),\n- 1 connected to a cable modem binding to a dynamicaly address allocated by my\nISP DHCP server.\n\nMy problem is I can't access to this web server if I haven't specified the\naddress in the Listen directive.\n\nFor example :\nIf I use \"Listen 8085\", only\ntelnet localhost 8085\nsucceed. Connection from other machine fails w/ \"Connection refused\" error.\n\nIf I use \"Listen 192.168.0.3:8085\", I can connect from a machine on my own\nnetwork but a telnet fails :\ntelnet localhost 8085\nTrying ::1...\ntelnet: connect to address ::1: Connection refused\nTrying 127.0.0.1...\ntelnet: Unable to connect to remote host: Connection refused\n\nA simple workaround should be to use some Listen directive, but I will be\ndifficult w/ DHCP address.\nAny help welcome ;-D\n\nRgds,\n\nLaurent", "is_private": false, "id": 30607, "creator": "l_faillie@yahoo.com", "time": "2003-02-03T23:46:08Z", "bug_id": 16739, "creation_time": "2003-02-03T23:46:08Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 16739, "attachment_id": null, "id": 30699, "time": "2003-02-04T22:54:52Z", "creator": "l_faillie@yahoo.com", "creation_time": "2003-02-04T22:54:52Z", "is_private": false, "text": "According to 'netstat', it seems Apache2 only listening IPv6 networks on my\nsystem. I will try to add option \"--enable-v4-mapped\".\n\nAnyway, as the documentation said \"Listen w/o network make apache waiting for\nall network\", it should implie both v4 and v6 by default."}, {"count": 2, "tags": [], "bug_id": 16739, "attachment_id": null, "id": 30782, "time": "2003-02-05T23:00:49Z", "creator": "l_faillie@yahoo.com", "creation_time": "2003-02-05T23:00:49Z", "is_private": false, "text": "Using '--enable-v4-mapped', I can now connect to the machine ... but no data is\nsent :-(\n\ntelnet ra 8085\nTrying 192.168.0.3...\nConnected to ra.chez.moi.\nEscape character is '^]'.\nGET /\nConnection closed by foreign host.\n\nAny help welcome ;-D\n\nBye\n\nLaurent\n"}, {"count": 3, "tags": [], "bug_id": 16739, "attachment_id": null, "id": 30783, "time": "2003-02-05T23:17:18Z", "creator": "l_faillie@yahoo.com", "creation_time": "2003-02-05T23:17:18Z", "is_private": false, "text": "Well, I found a workaround in the database : as for bug #7492 of the \"old\ndatabase\", I have added a \"Listen 0.0.0.0:8085\". Now it's working :-)\n\nI keep this bug open, because I think a problem remains : ok, using\n--enable-v4-mapped, IPv4 networks is checked, but w/o this second Listen\ndirective, the server won't return correct page but only close the connection.\n\nBye\n\nLaurent\n"}, {"count": 4, "tags": [], "bug_id": 16739, "attachment_id": null, "is_private": false, "id": 30787, "time": "2003-02-06T01:36:09Z", "creator": "trawick@apache.org", "creation_time": "2003-02-06T01:36:09Z", "text": "Here is what is supposed to happen with recent Apache:\n\nFor any version of netbsd with IPv6, apache \n1) assumes v4-mapped addresses can't/shouldn't be used (i.e., assumes   \n--disable-v4-mapped)\n2) puts two listen statements in default config file:\n   Listen 0.0.0.0:port\n   Listen [::]:port\n\n   (note that if you have old config file the one with the \"right\" listen   \nstatements will be httpd-std.conf)\n\nAlso, when Apache doesn't plan to use v4-mapped addresses, it will enable the\nIPV6_V6ONLY socket option if it exists.\n\nThe documentation needs to talk about --enable-v4-mapped vs. --disable-v4-mapped\nand what Listen statement(s) is(are) needed in either case.\n\nAs far as the weird error scenario (--enable-v4-mapped, \"Listen 8085\", whatever\nis listening on port 8085 drops the connect):\nIs there truss or strace that you can use on Apache for this case to give an\nidea of what is happening?\n "}, {"count": 5, "attachment_id": null, "creator": "l_faillie@yahoo.com", "is_private": false, "id": 31012, "time": "2003-02-10T15:27:12Z", "bug_id": 16739, "creation_time": "2003-02-10T15:27:12Z", "tags": [], "text": "Hum, netstat -a doesn't help (apache listening on both ipv4 and v6 worlds, so \nnothing abnormal).\n\nI duno which other tests I can made to have more informations but add some \ntracing \"printf()\" inside Apache code. But ... where can I start ? I'm not fully \naware of \"deep inside\" stuffs in Apache code.\nAnyway, I will try.\n\nIf someone want to make some checks or tests, I can give a temporary access to \nthis machine. A slow machine but w/ a permanent connection to the web thru \ncable.\n\nBye\n\nLaurent\n\nPS: hum, what do you think about adding NetBSD as target OS in your side ? ;-D"}, {"count": 6, "tags": [], "bug_id": 16739, "attachment_id": null, "id": 31292, "time": "2003-02-14T14:12:07Z", "creator": "trawick@apache.org", "creation_time": "2003-02-14T14:12:07Z", "is_private": false, "text": "I'm changing this to a doc problem.\n\nI was able to verify that on NetBSD 1.6, the --enable-v4-mapped and\n--disable-v4-mapped configure options work properly and generate\nthe proper Listen directives in the default configuration file.\nBut the documentation was woefully inadequate for this issue,\nso it could not be expected that users who ignore the default\nconfiguration file would automatically arrive at the right set\nof Listen directives.\n\nBetter doc for this has now been added to the manual in this \nsection:\n\nhttp://httpd.apache.org/docs-2.0/bind.html#ipv6"}]