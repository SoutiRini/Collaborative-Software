[{"count": 0, "tags": [], "bug_id": 20093, "attachment_id": null, "id": 37513, "time": "2003-05-21T05:59:20Z", "creator": "y3x1-wwm9@spamex.com", "creation_time": "2003-05-21T05:59:20Z", "is_private": false, "text": "Conceptually, I think you should be able to use <condition> task\nat the <project> scope the same as you can use <property> type.\nIn this case, it seems very arbitary as to what considered a task\nand what is considered a type. It appears to be an artifact of the\ndesign.  Look at the <selector> type which is allowed to be at the\n<project> scope. It does a similar thing as <condition> except for\nfiles instead of properties.\n\nPlease consider making <condition> a core type rather than a task.\n\nI wanted to set some properties conditionally, and then\nload a property file \"properties/project.txt\" which sets\nmore properties based on the ${BUILD_DIR} property.\n\nSince <condition> is a task, I cannot put it directly under\nthe <project> but instead I have to put it inside a task.\n\nSo, I created an \"init\" target and inside there I can add\nthe <conditions> and then load the properties and then\nall my other tasks can depend on \"init\" target.\n\nThis works fine except that I also need to initialize some\nfilesets which use those properties for use in several targets.\nI used to have these filesets defined directly under <project>\ntag and then they were available using refid=\"filesetname\".\nHowever, now that I set the properties in \"init\" task, I have\nto define the filesets later. When I define the filesets in\nthe \"init\" task, I found that the refids were not valid in\nthe targets, e.g. \"compile\" that depended on \"init\".  The\nonly workaround I have found is to redefine the filesets in\neach target \"compile\", \"install\", etc. but that is really ugly.\n\n<?xml version=\"1.0\"?>\n<project name=\"sample\" default=\"compile\" >\n<property file=\"${basedir}/properties/local_unix.txt\"/>\n<property file=\"${basedir}/properties/local_windows.txt\"/>\n\n<condition name=\"BUILD_DIR\" value=\"${UNIX_BUILD_DIR}\">\n  <os name=\"unix\"/>\n</condition>\n\n<condition name=\"BUILD_DIR\" value=\"${WINDOWS_BUILD_DIR}\">\n  <os name=\"windows\"/>\n</condition>\n\n<property file=\"${basedir}/properties/build.txt\"/>\n<path id=\"classpath\">\n    ....\n</path>\n\n------------ATTEMPTED WORKAROUND. PROBLEM WITH \"classpath\"-----------\n<?xml version=\"1.0\"?>\n<project name=\"sample\" default=\"compile\" >\n<property file=\"${basedir}/properties/local_unix.txt\"/>\n<property file=\"${basedir}/properties/local_windows.txt\"/>\n\n<target name=\"init\">\n  <condition name=\"BUILD_DIR\" value=\"${UNIX_BUILD_DIR}\">\n    <os name=\"unix\"/>\n  </condition>\n\n  <condition name=\"BUILD_DIR\" value=\"${WINDOWS_BUILD_DIR}\">\n    <os name=\"windows\"/>\n  </condition>\n  <property file=\"${basedir}/properties/build.txt\"/>\n  <!-- This doesn't work. Cannot refer to \"classpath\" in compile target -->\n  <path id=\"classpath\">\n    ....\n  </path>\n</target>\n\n<target name=\"compile\" depends=\"init\" >\n...."}, {"count": 1, "tags": [], "bug_id": 20093, "attachment_id": null, "is_private": false, "id": 37517, "time": "2003-05-21T06:49:36Z", "creator": "bodewig@apache.org", "creation_time": "2003-05-21T06:49:36Z", "text": "In Ant 1.6 all tasks, including <condition> can be placed outside of targets."}]