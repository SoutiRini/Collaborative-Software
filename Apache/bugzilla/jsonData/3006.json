[{"count": 0, "tags": [], "bug_id": 3006, "text": "If my base type uses locally declared elements, an attempt to restrict that \ntype gets a rcase-Recurse.2 error.  (I'm not completely sure that this is a \nbug, since the spec's language on restrictions is so difficult.  But the XML \nSchema Primer's example of restricted types uses local element declarations.)\n\nHere is a schema that demonstrates the problem.  It has equivalent restricted \ntypes, one with a base type built of locally declared elements and the other \nwith a base type built of globally declared elements:\n\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<!-- edited with XML Spy v4.0 NT beta 2 build Jul 26 2001 \n(http://www.xmlspy.com) by Oscar Garcia Mata (MAN Roland Druckmaschinen AG, \nM\u00fchlheim) -->\n<xsd:schema targetNamespace=\"http://www.CIP4.org/JDFSchema_1\"\n xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n xmlns:jdf=\"http://www.CIP4.org/JDFSchema_1\"\n elementFormDefault=\"qualified\" attributeFormDefault=\"unqualified\">\n\n<xsd:element name=\"MyElementLocals\" type=\"jdf:RestrictedTypeLocals\"/>\n<xsd:element name=\"MyElementGlobals\" type=\"jdf:RestrictedTypeGlobals\"/>\n\n<xsd:element name=\"AGlobalElement1\" type=\"xsd:string\"/>\n<xsd:element name=\"AGlobalElement2\" type=\"xsd:string\"/>\n\n<xsd:complexType name=\"BaseTypeGlobals\">\n   <xsd:sequence>\n      <xsd:element ref=\"jdf:AGlobalElement1\" minOccurs=\"0\"/>\n      <xsd:element ref=\"jdf:AGlobalElement2\" minOccurs=\"0\"/>\n   </xsd:sequence>\n</xsd:complexType>\n\n<xsd:complexType name=\"RestrictedTypeGlobals\">\n   <xsd:complexContent>\n      <xsd:restriction base=\"jdf:BaseTypeGlobals\">\n         <xsd:sequence>\n            <xsd:element ref=\"jdf:AGlobalElement2\"/>\n         </xsd:sequence>\n      </xsd:restriction>\n   </xsd:complexContent>\n</xsd:complexType>\n\n<xsd:complexType name=\"BaseTypeLocals\">\n   <xsd:sequence>\n      <xsd:element name=\"ALocalElement1\" type=\"xsd:string\" minOccurs=\"0\"/>\n      <xsd:element name=\"ALocalElement2\" type=\"xsd:string\" minOccurs=\"0\"/>\n   </xsd:sequence>\n</xsd:complexType>\n\n<xsd:complexType name=\"RestrictedTypeLocals\">\n   <xsd:complexContent>\n      <xsd:restriction base=\"jdf:BaseTypeLocals\">\n         <xsd:sequence>\n            <xsd:element name=\"ALocalElement2\"/>\n         </xsd:sequence>\n      </xsd:restriction>\n   </xsd:complexContent>\n</xsd:complexType>\n\n</xsd:schema>\n\n\nHere is an instance document to go with it:\n\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n\n<MyElementLocals xmlns=\"http://www.CIP4.org/JDFSchema_1\" \nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" \nxsi:schemaLocation=\"http://www.CIP4.org/JDFSchema_1 Restriction.xsd\">\n   <ALocalElement2>Restricted type built from locally declared elements \n</ALocalElement2>\n</MyElementLocals>\n\n<!--\n<MyElementGlobals xmlns=\"http://www.CIP4.org/JDFSchema_1\" \nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" \nxsi:schemaLocation=\"http://www.CIP4.org/JDFSchema_1 Restriction.xsd\">\n   <AGlobalElement2>Restricted type built from globally declared elements \n</AGlobalElement2>\n</MyElementGlobals>\n-->", "id": 4300, "time": "2001-08-06T13:14:54Z", "creator": "jslein@crt.xerox.com", "creation_time": "2001-08-06T13:14:54Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 3006, "attachment_id": null, "id": 4328, "time": "2001-08-07T10:25:18Z", "creator": "sandygao@ca.ibm.com", "creation_time": "2001-08-07T10:25:18Z", "is_private": false, "text": "By looking at element \"ALocalElement2\" in type \"RestrictedTypeLocals\", I \nnoticed that you didn't specify a type for this element, so the parser uses the \ndefault type: \"xsd:anyType\".\n\nNow to make \"RestrictedTypeLocals\" validly derived \nfrom \"BaseTypeLocals\", \"xsd:anyType\" must be validly derived from \"xsd:string\", \nwhich is not true.\n\nTo solve the problem, simply provide a type for \"ALocalElement2\":\n  <xsd:element name=\"ALocalElement2\" type=\"xsd:string\"/>\n\nCheers,\nSandy Gao"}]