[{"count": 0, "attachment_id": null, "bug_id": 53904, "text": "When I generate a xlsx file which size is 1.7MB, I wait more than 11 minutes to finish. When I fix the bug, the time is reduce to 5 seconds.\nMy code(JDK 1.7):\ntry (BufferedOutputStream out = new BufferedOutputStream(desFile.getContent().getOutputStream())) {\n\t\t\tthis.workbook.write(out);\n} catch (IOException ex) {\n\tlog.error(ex.getMessage(), ex);\n}\n\nThe bug(org.apache.poi.openxml4j.opc.PackageRelationshipCollection)\uff1a\npublic PackageRelationship addRelationship(URI targetUri, TargetMode targetMode, String relationshipType, String id) {\n\tif (id == null) {\n\t\t// Generate a unique ID is id parameter is null.\n\t\tint i = 0;\n\t\tdo {\n\t\t\tid = \"rId\" + ++i;\n\t\t} while (relationshipsByID.get(id) != null);\n\t}\n\t......\n}\nThe variable i will raise form 0 to 1000000 when the method be called  1000000 and the loop will calculate more than 500000 billion times!\n\nI modified the code:\nprivate int currentRelationshipsId = 0;\npublic PackageRelationship addRelationship(URI targetUri, TargetMode targetMode,\n String relationshipType, String id) {\n\tif (id == null) {\n\t\t// Generate a unique ID is id parameter is null.\n\t\tid = \"rId\" + ++currentRelationshipsId;\n\t}\n\t......\n}\n\nThe performance became more faster.", "id": 162286, "time": "2012-09-19T14:42:42Z", "creator": "superinkfish@gmail.com", "creation_time": "2012-09-19T14:42:42Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 53904, "attachment_id": null, "is_private": false, "id": 165052, "time": "2013-02-04T15:07:27Z", "creator": "apache@gagravarr.org", "creation_time": "2013-02-04T15:07:27Z", "text": "Your suggested fix would run into problems if relationships were added using the other overloaded add methods. For example, if you opened an existing file with two relationships, then went to add a third, your code would fail by trying to add a second rId1\n\nIn r1442148 I've added something that'll hopefully greatly reduce the number of steps, but will still check for clashes. Could you please test that and see if it resolves the issue for you?"}, {"count": 2, "tags": [], "creator": "dm.smirnov@gmail.com", "text": "*** Bug 53582 has been marked as a duplicate of this bug. ***", "id": 165422, "time": "2013-02-21T13:05:07Z", "bug_id": 53904, "creation_time": "2013-02-21T13:05:07Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 53904, "attachment_id": null, "text": "No response for quite some time on this one, a potential fix was made, so I don't think we can improve much more here unless you can provide updated information about your experience with the changes that were applied, therefore I am closing this to FIXED for now.", "id": 177476, "time": "2014-08-31T20:22:20Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2014-08-31T20:22:20Z", "is_private": false}]