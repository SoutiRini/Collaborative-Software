[{"count": 0, "tags": [], "creator": "louis.c.hilden@wellsfargo.com", "attachment_id": null, "text": "Given the following example script:\n\n<project basedir=\".\" default=\"fails\" name=\"zipfilesetrefidbug\">\n\n    <zipfileset id=\"test.fileset\"\n                dir=\"${basedir}\"\n                includes=\"test1.jar,test2.jar,test3.jar\"/>\n                \n    <target name=\"fails\">\n        <jar destfile=\"test.war\">\n            <zipfileset refid=\"test.fileset\"\n                        prefix=\"WEB-INF/lib/\"/>\n        </jar>\n    </target>\n    \n    <target name=\"works\">\n        <jar destfile=\"test.war\">\n            <zipfileset dir=\"${basedir}\"\n                        includes=\"test1.jar,test2.jar,test3.jar\"\n                        prefix=\"WEB-INF/lib/\"/>\n        </jar>\n    </target>\n    \n</project>\n\nIf I execute the 'fails' target:\n\nant -f test.xml fails\nunzip -l test.war\n\nArchive:  test.war\n  Length     Date   Time    Name\n --------    ----   ----    ----\n        0  08-05-04 11:31   META-INF/\n      106  08-05-04 11:31   META-INF/MANIFEST.MF\n        0  08-05-04 11:20   test1.jar\n        0  08-05-04 11:20   test2.jar\n        0  08-05-04 11:20   test3.jar\n --------                   -------\n      106                   5 files\n\nYou'll notice that test?.jar does not have the prefix specified in the\nzipfileset, but if I execute the 'works' target:\n\nant -f test.xml works\nunzip -l test.war\n\nYou'll notice that test?.jar has the proper prefix specified in the zipfileset.\n\nArchive:  test.war\n  Length     Date   Time    Name\n --------    ----   ----    ----\n        0  08-05-04 11:31   META-INF/\n      106  08-05-04 11:31   META-INF/MANIFEST.MF\n        0  08-05-04 11:28   WEB-INF/\n        0  08-05-04 11:28   WEB-INF/lib/\n        0  08-05-04 11:20   WEB-INF/lib/test1.jar\n        0  08-05-04 11:20   WEB-INF/lib/test2.jar\n        0  08-05-04 11:20   WEB-INF/lib/test3.jar\n --------                   -------\n      106                   7 files", "id": 61599, "time": "2004-08-05T18:44:11Z", "bug_id": 30498, "creation_time": "2004-08-05T18:44:11Z", "is_private": false}, {"count": 1, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "text": "That's by design, refid gives you the same zipfileset that has been designed\nbefore, you can't modify any of its attributes.\n\nWhat is a bug, though, is that you can set the prefix attribute without getting\nan exception - that's why I don't close the bug now.", "id": 72208, "time": "2005-03-11T16:28:19Z", "bug_id": 30498, "creation_time": "2005-03-11T16:28:19Z", "is_private": false}, {"count": 2, "tags": [], "creator": "peterreilly@apache.org", "attachment_id": null, "text": "Added the check on prefix and other attributes in zipfileset.", "id": 94498, "time": "2006-10-04T14:27:35Z", "bug_id": 30498, "creation_time": "2006-10-04T14:27:35Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 30498, "attachment_id": null, "id": 96045, "time": "2006-11-21T13:51:59Z", "creator": "peterreilly@apache.org", "creation_time": "2006-11-21T13:51:59Z", "is_private": false, "text": "\n\n*** This bug has been marked as a duplicate of 41004 ***"}]