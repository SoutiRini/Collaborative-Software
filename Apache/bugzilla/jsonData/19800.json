[{"count": 0, "tags": [], "bug_id": 19800, "attachment_id": null, "id": 36984, "time": "2003-05-09T15:26:41Z", "creator": "petter.mahlen@chello.se", "creation_time": "2003-05-09T15:26:41Z", "is_private": false, "text": "I am running Tomcat 4.1.18 on a Cygwin/Windows 2000 machine with JSDK 1.4.1_01. \nWhen I use a servlet webapp of my own, it works without problems. However, when \nI tried running Apache soap_2_3_1, I get the following error:\n\n===========================================================\n2003-05-09 17:01:20 StandardWrapperValve[rpcrouter]: Allocate exception for \nservlet rpcrouter\njavax.servlet.ServletException: Error allocating a servlet instance\n\tat org.apache.catalina.core.StandardWrapper.allocate\n(StandardWrapper.java:670)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke\n(StandardWrapperValve.java:214)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardContextValve.invoke\n(StandardContextValve.java:191)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardContext.invoke\n(StandardContext.java:2415)\n\tat org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:180)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.valves.ErrorDispatcherValve.invoke\n(ErrorDispatcherValve.java:170)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:641)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke\n(ErrorReportValve.java:172)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:641)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:174)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.coyote.tomcat4.CoyoteAdapter.service\n(CoyoteAdapter.java:223)\n\tat org.apache.coyote.http11.Http11Processor.process\n(Http11Processor.java:432)\n\tat \norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnectio\nn(Http11Protocol.java:386)\n\tat org.apache.tomcat.util.net.TcpWorkerThread.runIt\n(PoolTcpEndpoint.java:534)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:530)\n\tat java.lang.Thread.run(Thread.java:536)\n----- Root Cause -----\njava.lang.NoClassDefFoundError: javax/servlet/http/HttpServlet\n\tat java.lang.ClassLoader.defineClass0(Native Method)\n\tat java.lang.ClassLoader.defineClass(ClassLoader.java:502)\n\tat java.security.SecureClassLoader.defineClass\n(SecureClassLoader.java:123)\n\tat java.net.URLClassLoader.defineClass(URLClassLoader.java:250)\n\tat java.net.URLClassLoader.access$100(URLClassLoader.java:54)\n\tat java.net.URLClassLoader$1.run(URLClassLoader.java:193)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:186)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:299)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:292)\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:265)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:255)\n\tat org.apache.catalina.loader.WebappClassLoader.loadClass\n(WebappClassLoader.java:1340)\n\tat org.apache.catalina.loader.WebappClassLoader.loadClass\n(WebappClassLoader.java:1274)\n\tat org.apache.catalina.core.StandardWrapper.loadServlet\n(StandardWrapper.java:884)\n\tat org.apache.catalina.core.StandardWrapper.allocate\n(StandardWrapper.java:666)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke\n(StandardWrapperValve.java:214)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardContextValve.invoke\n(StandardContextValve.java:191)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardContext.invoke\n(StandardContext.java:2415)\n\tat org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:180)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.valves.ErrorDispatcherValve.invoke\n(ErrorDispatcherValve.java:170)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:641)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke\n(ErrorReportValve.java:172)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:641)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:174)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.coyote.tomcat4.CoyoteAdapter.service\n(CoyoteAdapter.java:223)\n\tat org.apache.coyote.http11.Http11Processor.process\n(Http11Processor.java:432)\n\tat \norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnectio\nn(Http11Protocol.java:386)\n\tat org.apache.tomcat.util.net.TcpWorkerThread.runIt\n(PoolTcpEndpoint.java:534)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:530)\n\tat java.lang.Thread.run(Thread.java:536)\n===========================================================\n\n\n\nI was unable to locate the source code for 4.1.18 on the Tomcat web site, but \nlooking at the source for for 4.1.24, and guessing a change of the line numbers \nbased on the stack trace, I noted that it seems to be the call to \nsystem.loadClass() on line 1355 of org.apache.catalina.load.WebappClassLoader \nthat fails (case 0.2). So I tried copying servlet.jar from the Tomcat \ninstallation to $JAVA_HOME/jre/lib/ext, and that solved the problem. It seems \nquite inelegant to me, since obviously Tomcat has access to servlet.jar without \nit being located there.\n\nI am not quite able to follow how the class loader is chosen in \nStandardWrapper/WebappClassLoader, but there seems to be some kind of bug there \nor in the SOAP code. I also tried placing servlet.jar in the webapp's lib \ndirectory, but that did not work. I don't understand why this happens only with \nSOAP, and not with my own application, but then I have not tried to understand \nthe SOAP code."}, {"id": 37001, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "count": 1, "text": "Please provide a test webapp.", "time": "2003-05-09T18:05:09Z", "bug_id": 19800, "creation_time": "2003-05-09T18:05:09Z", "is_private": false}, {"count": 2, "tags": [], "text": "Without a test case I am unable to even start trying to fix this.", "is_private": false, "id": 55982, "creator": "markt@apache.org", "time": "2004-04-18T16:57:01Z", "bug_id": 19800, "creation_time": "2004-04-18T16:57:01Z", "attachment_id": null}]