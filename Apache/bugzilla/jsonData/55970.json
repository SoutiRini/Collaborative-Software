[{"count": 0, "text": "This is reproduction recipe for an issue reported on the users@ list.\n\nSee \"rc-10 bug?\" thread.\nhttp://tomcat.markmail.org/thread/m6eecxjuygj6yjxq\n\nSteps to reproduce with 8.0.0-RC10:\n-------------------------------------\n1. Mark the \"examples\" web application as reloadable, by adding the following file: /META-INF/context.xml\n\n<Context reloadable=\"true\"/>\n\n2. Add a stray non-jar file to the WEB-INF/lib directory.\nE.g. /WEB-INF/lib/foo.txt\n\n3. Start Tomcat.\n4. Every 10 seconds the examples webapp is reloaded.\nThis is accompanied by the following log messages:\n\n07-Jan-2014 22:01:58.672 INFO [ContainerBackgroundProcessor[StandardEngine[Catalina]]] org.apache.catalina.loader.WebappClassLoader.modified One of more JARs have been added to the web application [/examples]\n07-Jan-2014 22:01:58.673 INFO [ContainerBackgroundProcessor[StandardEngine[Catalina]]] org.apache.catalina.core.StandardContext.reload Reloading Context with name [/examples] has started\n07-Jan-2014 22:01:59.704 INFO [ContainerBackgroundProcessor[StandardEngine[Catalina]]] org.apache.catalina.core.StandardContext.reload Reloading Context with name [/examples] is completed\n-------------------------------------\n\nQuoting from the e-mail:\n[quote]\nFrom webappclassloader.java snippet below (line 737), jars[] does not only contain jars, but also any other resources. i added a howTo.txt file in WEB-INF/lib, which results in  jars.length will NEVER equal jarModificationTimes.size().\n\nFix is simple - just filter out the non-jar, non-executable elements b4 comparing. Workaround is equally trivial - remove said elements from the the lib folder.\nHope this helps,\nPeter\n\n        // Check if JARs have been added or removed\n        WebResource[] jars = resources.listResources(\"/WEB-INF/lib\");\n\n        if (jars.length > jarModificationTimes.size()) {\n            log.info(sm.getString(\"webappClassLoader.jarsAdded\",\n                    resources.getContext().getName()));\n            return true;\n        } else if (jars.length < jarModificationTimes.size()){\n            log.info(sm.getString(\"webappClassLoader.jarsRemoved\",\n                    resources.getContext().getName()));\n            return true;\n        }\n\n        for (WebResource jar : jars) {\n            if (jar.getName().endsWith(\".jar\") && jar.isFile() && jar.canRead()) {\n[/quote]\n\nThis affects only those web applications that were explicitly marked as \"reloadable\" in their or in the default context.xml file.\n\nIn the default configuration the \"reloadable\" flag is false and thus the \"modified()\" check in WebappLoader.backgroundProcess() is skipped.", "bug_id": 55970, "is_private": false, "id": 172150, "time": "2014-01-07T18:13:45Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2014-01-07T18:13:45Z", "tags": [], "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 55970, "is_private": false, "id": 172217, "attachment_id": null, "creator": "markt@apache.org", "creation_time": "2014-01-09T15:25:26Z", "time": "2014-01-09T15:25:26Z", "text": "Fixed in 8.0.x for 8.0.0 onwards."}]