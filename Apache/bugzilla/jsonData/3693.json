[{"count": 0, "attachment_id": null, "creator": "dan@dantanner.com", "is_private": false, "id": 5721, "time": "2001-09-18T09:43:02Z", "bug_id": 3693, "creation_time": "2001-09-18T09:43:02Z", "tags": [], "text": "My custom task works in Ant 1.3.\nIt doesn't in Ant 1.4.\nI didn't see anything in the release notes that indicate my custom task isn't \ncompliant anymore.\n\nHere's some info...I can provide more detail if necessary.\n\nPiece of build.xml in question:\n---------------------------------------------------------\n     <translationcheck logfile=\"build/TranslationCheck-AllFiles.log\" \nreportfor=\"entireset\">\n       <keyset>\n         <fileset dir=\"resources/translations\"\n \nincludes=\"base.properties,lang1.properties,mtg1.properties\" />\n       </keyset>\n       <searchset>\n         <fileset dir=\"web/user\" includes=\"**/*.jsp\" />\n         <fileset dir=\"source\" includes=\"**/*.java\" />\n         <ignore key=\"revision.mtg\" />\n         <ignore key=\"revision.lang\" />\n         <ignore key=\"revision.base\" />\n         <ignore key=\"jsp.httperrorpage.errormsg.404\" />\n       </searchset>\n     </translationcheck>\n----------------------------------------------------------\n\n\nSmall piece of my custom task: (I think it's my code's point of entry \ninto Ant)\n------------------------------------------------------------------------\n     FileSet fs = (FileSet)filesets.get(i);\n     DirectoryScanner ds = fs.getDirectoryScanner(project);\n----------------------------------------------------------\n\n\n\nPart of Ant output with debug turned on:\n------------------------------------------------------------------------\n    +Task: translationcheck\nFinding class com.katun.kolc.ant.TranslationCheck$SearchSet\nClass com.katun.kolc.ant.TranslationCheck$SearchSet loaded from ant loader\nFinding class com.katun.kolc.ant.TranslationCheck$KeySet\nClass com.katun.kolc.ant.TranslationCheck$KeySet loaded from ant loader\nClass java.lang.String loaded from parent loader\nClass java.util.List loaded from parent loader\nClass java.util.ArrayList loaded from parent loader\nClass org.apache.tools.ant.types.FileSet loaded from parent loader\n\nBUILD FAILED\n\njava.lang.NullPointerException\n         at \norg.apache.tools.ant.ProjectHelper.configure(ProjectHelper.java:651)\n         at \norg.apache.tools.ant.RuntimeConfigurable.maybeConfigure(RuntimeConfig\nurable.java:143)\n         at org.apache.tools.ant.Task.maybeConfigure(Task.java:178)\n         at \norg.apache.tools.ant.UnknownElement.handleChildren(UnknownElement.jav\na:139)\n         at \norg.apache.tools.ant.UnknownElement.maybeConfigure(UnknownElement.jav\na:88)\n         at org.apache.tools.ant.Task.perform(Task.java:216)\n         at org.apache.tools.ant.Target.execute(Target.java:164)\n         at org.apache.tools.ant.Target.performTasks(Target.java:182)\n         at org.apache.tools.ant.Project.executeTarget(Project.java:601)\n         at org.apache.tools.ant.Project.executeTargets(Project.java:560)\n         at org.apache.tools.ant.Main.runBuild(Main.java:454)\n         at org.apache.tools.ant.Main.start(Main.java:153)\n         at org.apache.tools.ant.Main.main(Main.java:176)\n--------------------------------------------------------"}, {"count": 1, "tags": [], "text": "More info:\nThe project variable is only null if the <taskdef> is within a target...It \nexists if the <taskdef> is a direct child of the <project>.\n\nI suppose this may be another effect of the classloader changes that have \noccured from 1.3 to 1.4.  We can get around this by making an <ant> call to a \nseparate build file, but currently this means that you can't put a taskdef \ninside a target...in our case our target was a build-custom-tasks target which \ndepended on a compile target (which ensured the custom task's class existed).", "is_private": false, "bug_id": 3693, "id": 6513, "time": "2001-10-09T14:11:26Z", "creator": "dan@dantanner.com", "creation_time": "2001-10-09T14:11:26Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 3693, "text": "fixed in nightly build 2001-10-31", "id": 7304, "time": "2001-10-30T05:04:52Z", "creator": "bodewig@apache.org", "creation_time": "2001-10-30T05:04:52Z", "is_private": false, "attachment_id": null}]