[{"count": 0, "tags": [], "text": "Created attachment 34884\nlocalhost.2017-03-28.log\n\nNoted when smoke-testing 8.5.13 RC, but this is reproducible with released 8.5.12 as well, so it is not a regression.\n\nSteps to reproduce:\n1. Start Tomcat 8.5 with security manager enabled\ncatalina.bat start -security\n\n2. Access the root page,\nhttp://localhost:8080/\n\nIt fails with error 500.\nStacktrace from 8.5.13:\n\njavax.el.PropertyNotFoundException: Property 'serverInfo' not found on type org.apache.catalina.core.ApplicationContextFacade\n at javax.el.BeanELResolver$BeanProperties.get(BeanELResolver.java:259)\n at javax.el.BeanELResolver$BeanProperties.access$300(BeanELResolver.java:212)\n at javax.el.BeanELResolver.property(BeanELResolver.java:346)\n at javax.el.BeanELResolver.getValue(BeanELResolver.java:92)\n at org.apache.jasper.el.JasperELResolver.getValue(JasperELResolver.java:110)\n at org.apache.el.parser.AstValue.getValue(AstValue.java:169)\n at org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:184)\n at org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate(PageContextImpl.java:944)\n at org.apache.jsp.index_jsp._jspService(index_jsp.java:155)\n\nSee attached file with full stacktrace.\n\n\nNotes:\n1. This does not happen when running without SecurityManager.\n2. This does not depends on version of java (occurs both with 7u80 and 8u121).\n\n\nI have seen similar errors when we were fixing CVE-2014-7810\n(see thread from 2014-11-17), but it should have been fixed by r1644017\nthat improved javax.el.BeanELResolver.", "is_private": false, "bug_id": 60925, "id": 198028, "time": "2017-03-27T23:01:30Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2017-03-27T23:01:30Z", "attachment_id": 34884}, {"count": 1, "tags": [], "text": "Tomcat 8.5.11 does not have this issue. The root page displays successfully.", "is_private": false, "bug_id": 60925, "id": 198029, "time": "2017-03-27T23:12:49Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2017-03-27T23:12:49Z", "attachment_id": null}, {"count": 2, "attachment_id": null, "bug_id": 60925, "is_private": false, "id": 198031, "time": "2017-03-27T23:32:29Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2017-03-27T23:32:29Z", "tags": [], "text": "I think that this is triggered by the change in r1784768,\nthat changed inheritance hierarchy in ApplicationContextFacade\n\nand the cause is that the solution implemented in r1644017 is incomplete:\nmethod BeanELResolver.populateFromInterfaces() does not enumerate parent interfaces of an interface."}, {"attachment_id": null, "tags": [], "bug_id": 60925, "is_private": false, "count": 3, "id": 198055, "time": "2017-03-29T13:07:58Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2017-03-29T13:07:58Z", "text": "For a record:\nThere exists a working temporary workaround for this issue:\ngrant permission to access the \"core\" package.\n\nE.g. for this test scenario (the ROOT web application),\nadding the following lines to catalina.policy file is sufficient:\n\ngrant codeBase \"file:${catalina.base}/webapps/ROOT/-\" {\n    permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.catalina.core\";\n};"}, {"count": 4, "tags": [], "creator": "markt@apache.org", "text": "To state the obvious, that work-around exposes a lot of Tomcat's internals to the web application.\n\nFixed in:\n- trunk for 9.0.0.M20 onwards\n- 8.5.x for 8.5.14 onwards\n- 8.0.x for 8.0.44 onwards\n- 7.0.x for 7.0.78 onwards", "id": 198067, "time": "2017-03-29T18:21:41Z", "bug_id": 60925, "creation_time": "2017-03-29T18:21:41Z", "is_private": false, "attachment_id": null}]