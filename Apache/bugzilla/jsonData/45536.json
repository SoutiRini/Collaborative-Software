[{"count": 0, "tags": [], "bug_id": 45536, "text": "This is happening running Hadoop unit tests, presumably because the buffer is 30MB of unicode text\n\n   [junit] Tests run: 4, Failures: 0, Errors: 0, Time elapsed: 7.987 sec\n    [junit] Exception in thread \"Main Thread\" java.lang.OutOfMemoryError: allocLargeObjectOrArray - Object size: 30177672, Num elements: 30177650\n    [junit]     at java.util.Arrays.copyOf(Arrays.java:2786)\n    [junit]     at java.lang.StringCoding.safeTrim(StringCoding.java:64)\n    [junit]     at java.lang.StringCoding.access$300(StringCoding.java:34)\n    [junit]     at java.lang.StringCoding$StringEncoder.encode(StringCoding.java:251)\n    [junit]     at java.lang.StringCoding.encode(StringCoding.java:272)\n    [junit]     at java.lang.LangAccessImpl.stringCodingDefaultEncode(LangAccessImpl.java:39)\n    [junit]     at java.lang.String.getBytes(String.java:987)\n    [junit]     at org.apache.tools.ant.taskdefs.optional.junit.PlainJUnitResultFormatter.endTestSuite(PlainJUnitResultFormatter.java:152)\n    [junit]     at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.fireEndTestSuite(JUnitTestRunner.java:619)\n    [junit]     at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:452)\n    [junit]     at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:911)\n    [junit]     at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:768)\n    [junit] Running org.apache.hadoop.mapred.TestKeyValueTextInputFormat\n    [junit] Tests run: 1, Failures: 0, Errors: 1, Time elapsed: 0 sec\n    [junit] Test org.apache.hadoop.mapred.TestKeyValueTextInputFormat FAILED (crashed)\n\nSeems to me we could write this data straight out to the file, instead of routing via a StringBuffer.", "id": 119353, "attachment_id": null, "creator": "stevel@apache.org", "creation_time": "2008-08-04T07:54:35Z", "time": "2008-08-04T07:54:35Z", "is_private": false}, {"count": 1, "tags": [], "text": "Created attachment 25075\npatch for the JUnitTestRunner and PlainJUnitResultFormatter\n\nPatch handles OOM gracefully in the test runner by intercepting that part of the process and replacing it with a string warning of memory problems.\n\nAt the output formatter avoids building everything up into one large string to output, instead every stream is put out separately and the buffers flushed, this makes it much more robust. \n\nNo tests, not unless you want to create 40MB worth of log4j output.", "attachment_id": 25075, "id": 134977, "creator": "stevel@apache.org", "time": "2010-03-01T17:00:34Z", "bug_id": 45536, "creation_time": "2010-03-01T17:00:34Z", "is_private": false}, {"count": 2, "tags": [], "creator": "bodewig@apache.org", "is_private": false, "text": "svn revision 1556001", "id": 172123, "time": "2014-01-06T19:57:41Z", "bug_id": 45536, "creation_time": "2014-01-06T19:57:41Z", "attachment_id": null}]