[{"count": 0, "tags": [], "bug_id": 29258, "attachment_id": null, "text": "When you upgrade an existing Tomcat 5.0.19 server to Tomcat 5.0.24+,\nyou may have problems getting the server to come up without adding\njmx.jar explicitly to the CLASSPATH.  This happens only after a\nbadly applied upgrade.\n\nThe \"fix\" to make sure this doesn't happen is to add jmx.jar to the\nCLASSPATH after commons-logging-api.jar.  Without this fix, you may see\nthis message in catalina.out:\n\n  Bootstrap: Class loader creation threw exception\n  java.lang.NoClassDefFoundError: javax/management/MBeanServerFactory\n          at org.apache.catalina.startup.Bootstrap.createClassLoader\n(Bootstrap.java:165)\n          at org.apache.catalina.startup.Bootstrap.initClassLoaders\n(Bootstrap.java:104)\n          at org.apache.catalina.startup.Bootstrap.init(Bootstrap.java:193)\n          at org.apache.catalina.startup.Bootstrap.init(Bootstrap.java:270)\n          at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n          at sun.reflect.NativeMethodAccessorImpl.invoke\n(NativeMethodAccessorImpl.java:39)\n          at sun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:25)\n          at java.lang.reflect.Method.invoke(Method.java:324)\n          at org.apache.commons.daemon.support.DaemonLoader.load\n(DaemonLoader.java:201)\n\nSince you can fix the configuration problem in the server, adding\njmx.jar explicitly to the CLASSPATH is a minor bug fix, although\nit might provide a big hint to people who are upgrading Tomcat\n5.0.19 servers.\n\nTypically this error means someone may have moved jmx.jar to its\nprevious resting place (i.e., $CATALINA_HOME/common/lib) because\nthey thought that's where it was supposed to go, so you can just\nrestore a correct copy of jmx.jar to bin to recover from this problem.\n\nThis could be avoided by a documentation update instead of a code\nchange.", "id": 58252, "time": "2004-05-27T21:09:08Z", "creator": "chris.cheyney@smarttrust.com", "creation_time": "2004-05-27T21:09:08Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 29258, "is_private": false, "text": "What documentation update would you suggest?", "id": 58265, "time": "2004-05-27T23:50:08Z", "creator": "yoavs@computer.org", "creation_time": "2004-05-27T23:50:08Z", "attachment_id": null}, {"count": 2, "tags": [], "text": "I think originally this worked by having inside the manifest of bootstrap.jar\nthe line\n\nClass-Path: jmx.jar commons-daemon.jar commons-logging-api.jar\n\nand putting jmx.jar to the bin directory.\n", "is_private": false, "bug_id": 29258, "id": 58283, "time": "2004-05-28T08:28:10Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2004-05-28T08:28:10Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "yoavs@computer.org", "attachment_id": null, "text": "The manifest for bootstrap.jar has not changed: it still contains jmx.jar \nbefore commons-logging in the classpath line.  Also, jmx.jar is still in the \nbin directory, so that hasn't changed either.", "id": 58323, "time": "2004-05-28T14:44:49Z", "bug_id": 29258, "creation_time": "2004-05-28T14:44:49Z", "is_private": false}, {"count": 4, "tags": [], "text": "I would update the change logs to add a more explicit comment about\njmx.jar residing in bin instead of common/lib.  Anything more than\nthat is probably overkill since you only get this problem when you\ndo something odd to the install (like moving the jmx.jar file into\ncommon/lib again, etc.).\n\nAdding jmx.jar to the startup scripts might help make it clear that\nthe startup has JMX dependencies.\n\n", "is_private": false, "bug_id": 29258, "id": 58327, "time": "2004-05-28T15:36:08Z", "creator": "chris.cheyney@smarttrust.com", "creation_time": "2004-05-28T15:36:08Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "yoavs@computer.org", "text": "It was already in the changelog (v5.0.20), but I don't think that's visible \nenough, so I've added the following to the RELEASE NOTES file, in the standard \nAPIs section:\n\nPlease note that the JMX API is available to applications as well.  The jmx.jar\nfile used to be located in the common/lib directory, but was moved to the bin\ndirectory as part of the Tomcat 5.0.20 release.  The jmx.jar is in Tomcat's\nbootstrap classpath (included via the Class Path line in bootstrap.jar's \nmanifest).\n\nThis will of course be visible and available starting with the next release, \n5.0.26.", "id": 58328, "time": "2004-05-28T15:45:03Z", "bug_id": 29258, "creation_time": "2004-05-28T15:45:03Z", "is_private": false, "attachment_id": null}, {"count": 6, "attachment_id": null, "creator": "Tam@SiuLung.com", "text": "I just downloaded 5.0.27 binary and it still occurs:\nsltam@delta:~/jakarta-tomcat-5.0.27$ bin/catalina.sh run\nUsing CATALINA_BASE:   /home/sltam/jakarta-tomcat-5.0.27\nUsing CATALINA_HOME:   /home/sltam/jakarta-tomcat-5.0.27\nUsing CATALINA_TMPDIR: /home/sltam/jakarta-tomcat-5.0.27/temp\nUsing JAVA_HOME:       /usr/lib/kaffe\nDue to new licensing guidelines mandated by the Apache Software\nFoundation Board of Directors, a JMX implementation can no longer\nbe distributed with the Apache Tomcat binaries. As a result, you\nmust download a JMX 1.2 implementation (such as the Sun Reference\nImplementation) and copy the JAR containing the API and\nimplementation of the JMX specification to:\n${catalina.home}/bin/jmx.jar\nsltam@delta:~/jakarta-tomcat-5.0.27$\n\nJDK: kaffe 1.1.5 branch\nSystem: Debian Linux unstable i686\n\nAdding this to catalina.sh solves:\nCLASSPATH=\"$CLASSPATH\":\"$CATALINA_HOME\"/bin/jmx.jar", "id": 60711, "time": "2004-07-16T16:22:59Z", "bug_id": 29258, "creation_time": "2004-07-16T16:22:59Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "creator": "yoavs@computer.org", "text": "Tomcat requires a JDK that understands Jar Class Path directives, which your \nkaffe 1.1.5 apparently doesn't.  If your JDK doesn't understand these \ndirectives, you may have to manually modify a number of things, not just \ncatalina.sh, as you undoubtedly know by now.", "id": 60924, "time": "2004-07-21T18:34:15Z", "bug_id": 29258, "creation_time": "2004-07-21T18:34:15Z", "is_private": false, "attachment_id": null}]