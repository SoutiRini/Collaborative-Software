[{"count": 0, "tags": [], "bug_id": 53269, "attachment_id": 28813, "id": 159208, "time": "2012-05-22T07:42:59Z", "creator": "apache_nospam@achner.com", "creation_time": "2012-05-22T07:42:59Z", "is_private": false, "text": "Created attachment 28813\ncorrupt file\n\nReproducible error\n\nXSSFWorkbook wb = new XSSFWorkbook();\nwb.createSheet(\"Test\");\n\nFileOutputStream os = new FileOutputStream(\"C:/dev/myfile1.xlsx\");\nwb.write(os);\nos.close();\nos = new FileOutputStream(\"C:/dev/myfile2.xlsx\");\nwb.write(os);\nos.close();\n\nSaving an existing workbook first time produces a correct file (3.236 Bytes). Saving it a second time produces a corrupt file (2.888 Bytes)."}, {"count": 1, "attachment_id": 28814, "bug_id": 53269, "is_private": false, "id": 159209, "time": "2012-05-22T07:44:12Z", "creator": "apache_nospam@achner.com", "creation_time": "2012-05-22T07:44:12Z", "tags": [], "text": "Created attachment 28814\ncorrect file"}, {"count": 2, "tags": [], "text": "This behavior is expected. Current architecture of XSSF allows you to save only once. Depending on the document, a second save may result in a corrupted file or in a exception. I'm going to update javadocs to reflect it.\n\nThe workaround is to re-read the file before saving it second time.\n\nYegor", "is_private": false, "id": 159210, "creator": "yegor@dinom.ru", "time": "2012-05-22T07:52:30Z", "bug_id": 53269, "creation_time": "2012-05-22T07:52:30Z", "attachment_id": null}]