[{"count": 0, "tags": [], "creator": "robstewart57@googlemail.com", "attachment_id": 23670, "is_private": false, "id": 127053, "time": "2009-05-16T08:23:59Z", "bug_id": 47206, "creation_time": "2009-05-16T08:23:59Z", "text": "Created attachment 23670\nZip file with 3 attachments\n\nHi there, I am experiencing some strange behaviour with the method XSFFSheet.autoSizeColumn(i)\n\nI have taken a spreadsheet with two rows. I have made two cells on the 2nd row contain more text than the cell directly above that, on row one.\n\nI saved the spreadsheet, one as Office 2003 format: 2003_Report.xls , and the other as 2007 format: 2007_Report.xlsx\n\nI attach a small Java program (Main.java attached). The intention is to adjust the column widths on both sheets, so that all columns are correctly adjusted to show all text as visible.\n\nThe application adjusts the 2003 (.xls) file just fine, but the 2007 (.xlsx) file does not show all the text in the 2nd row.\n\nNote this is a really simple example that I am using to illustrate a problem I'm experiencing with poi-dev3.5. I am dealing with spreadsheets with 100's of rows. Dealing with both xlsx and xls files, and the implementation of XSFFSheet.autoSizeColumn(i) does not deal with column widths very well.\n\nATTACHMENTS:\n- autoSizeColumn.zip\n- - 2003_Report.xls\n- - 2007_Report.xlsx\n- - Main.java\n\nThanks."}, {"count": 1, "text": "Created attachment 23672\nhssf screenshot", "bug_id": 47206, "attachment_id": 23672, "id": 127071, "time": "2009-05-17T09:44:55Z", "creator": "yegor@dinom.ru", "creation_time": "2009-05-17T09:44:55Z", "tags": [], "is_private": false}, {"count": 2, "text": "Created attachment 23673\nxssf screenshot", "bug_id": 47206, "attachment_id": 23673, "id": 127072, "time": "2009-05-17T09:45:53Z", "creator": "yegor@dinom.ru", "creation_time": "2009-05-17T09:45:53Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "is_private": false, "id": 127073, "time": "2009-05-17T09:51:30Z", "bug_id": 47206, "creation_time": "2009-05-17T09:51:30Z", "text": "I can't reproduce the problem. Both HSSF and XSSF outputs look OK to me. See attached screenshots. I'm using the latest trunk. \n\nThe Bug report says that the platform is \"Windows Vista\". Did you run the Java code on Windows or evaluated results only? If you run Java on *nix, make sure that the fonts are available. You may need to copy them into $JAVA_HOME/jre/lib/fonts\n\n\nRegards,\nYegor"}, {"count": 4, "tags": [], "bug_id": 47206, "attachment_id": null, "text": "Hi,\n\nI am happy to give you additional information, as I have pinpointed why the problem occurs. It is to do with the fact that I have applied a  XSSFCellStyle to each cell before calling the autoSizeColumn.\n\nI am creating a spreadsheet with multiple tabs (sheets). I am creating each sheet as such:\n----------\nString[] columns = new String[]{\"Column_1\",\"Column_2\", \"Column_3\"};\ncreateSheet(\"Part Number Comparisons\", columns);\n----------\n\nthen....\n--------------\n\n public void createSheet(String sheetName, String[] columns){\n         XSSFCellStyle style = wb.createCellStyle();\n        style.setFillForegroundColor(new XSSFColor(Color.lightGray));\n        style.setFillPattern(XSSFCellStyle.SOLID_FOREGROUND);\n        style.setAlignment(XSSFCellStyle.ALIGN_CENTER);\n        style.setBorderBottom(XSSFCellStyle.BORDER_THIN);\n\n         XSSFSheet sheet = wb.createSheet(sheetName);\n         sheet.createFreezePane( 0, 1, 0, 1 );\n         XSSFRow row = sheet.createRow((short) 0);\n\n         for(int i=0;i<columns.length;i++){\n             XSSFCell cell = row.createCell(i);\n         cell.setCellValue(columns[i].toString());\n         cell.setCellStyle(style);\n         }\n\n         XSSFRow row2 = sheet.createRow((short) 1);\n         XSSFCellStyle style2 = wb.createCellStyle();\n         style2.setFillForegroundColor(new XSSFColor(Color.WHITE));\n         style2.setFillPattern(XSSFCellStyle.SOLID_FOREGROUND);\n         style2.setAlignment(XSSFCellStyle.ALIGN_CENTER);\n    }\n\n-------------\n\n\nFINALLY, the resizeXLSXColumns(String FILENAME) method is called AFTER the above has taken place.\n\nSimply, the autoSizeColumns() for XSSFSheet does not deal with XSSFCellSytle very well, where as HSSFSheet seems to handle HSSFCellStyle Ok.\n\nHope that helps.\n\n\nRob Stewart", "id": 127119, "time": "2009-05-18T08:24:22Z", "creator": "robstewart57@googlemail.com", "creation_time": "2009-05-18T08:24:22Z", "is_private": false}, {"count": 5, "text": "Still can't get it. I combined createSheet() with Main.java and the output looks OK. All columns are resized correctly. \n\nCan you post an isolated example which demonstrates the problem? Perhaps, a version of Main.java including additional code. \n\nYegor", "bug_id": 47206, "is_private": false, "id": 127125, "time": "2009-05-18T11:32:06Z", "creator": "yegor@dinom.ru", "creation_time": "2009-05-18T11:32:06Z", "tags": [], "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 47206, "text": "Created attachment 23693\nIllustrates the incorrect behaviour", "id": 127176, "time": "2009-05-19T10:47:10Z", "creator": "robstewart57@googlemail.com", "creation_time": "2009-05-19T10:47:10Z", "is_private": false, "attachment_id": 23693}, {"count": 7, "tags": [], "bug_id": 47206, "is_private": false, "text": "Hi there,\n\nI'm adding an attachment, this time only the Main.java as this is all that is necessary.\n\nApologies for the red herrings in the previous email.\n\nThe Java code attached illustrates exactly the problem I'm having.\n\nThe code does:\n1. Make a new XSSF workbook\n2. Adds data to it\n3. Tries to resize the columns, but fails\n\nThoughts ?\n\nthanks.\n\nRob.", "id": 127177, "time": "2009-05-19T10:47:25Z", "creator": "robstewart57@googlemail.com", "creation_time": "2009-05-19T10:47:25Z", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 47206, "is_private": false, "text": "Fixed in r777834. \nExcel JDBC Driver is the culprit. It inserts strings in a funny way and POI couldn't read them. \n\nRegards,\nYegor", "id": 127323, "time": "2009-05-23T01:22:50Z", "creator": "yegor@dinom.ru", "creation_time": "2009-05-23T01:22:50Z", "attachment_id": null}, {"count": 9, "text": "Hi Yegor ,\n\nI am using 3.10 beta , but still i am having this issue. Please guide us how we can get it worked.\n\nPreviously i was using 3.7 HSSF, which was not having facility to pass number of rows.\n\n// keep some rows in\nmemory, exceeding rows will be flushed to disk.\n\nBut when i changed it to SXSSF , speed was superb to write excel.\n\nWith ur previous comment , i am understanding that autoresizecolumn is not possible in this way.  So i m looking for a way to use this with nice column width.\n\nThanks\nShubham", "bug_id": 47206, "is_private": false, "id": 177296, "time": "2014-08-21T15:57:51Z", "creator": "subhamgupta84@gmail.com", "creation_time": "2014-08-21T15:57:51Z", "tags": [], "attachment_id": null}]