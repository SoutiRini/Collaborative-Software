[{"count": 0, "tags": [], "creator": "o.dr@gmx.de", "attachment_id": null, "text": "We are still using J2EE 1.3 and use \"unstandard-taglibs\".\nThe Tag <size> doesn't work with arrays - it returns -1.\n\nError is in the class \"org.apache.taglibs.unstandard.SizeTag\":\n\n// Error\nif(target instanceof Collection) { \n     result = ( (Object[])target ).length;\n}\n\n// Bugfix  \nif(target.isArray) { \n     result = ( (Object[])target ).length;\n}\n\nAnd the casting (Object[]) doesn't works with primitive arrays (int[], boolean[], etc).", "id": 118811, "time": "2008-07-18T06:07:49Z", "bug_id": 45433, "creation_time": "2008-07-18T06:07:49Z", "is_private": false}, {"count": 1, "tags": [], "text": "Created attachment 22282\nSample jsp with <size>-Tag", "is_private": false, "bug_id": 45433, "id": 118812, "time": "2008-07-18T06:08:59Z", "creator": "o.dr@gmx.de", "creation_time": "2008-07-18T06:08:59Z", "attachment_id": 22282}, {"count": 2, "tags": [], "creator": "bayard@apache.org", "attachment_id": null, "id": 127358, "time": "2009-05-25T02:06:37Z", "bug_id": 45433, "creation_time": "2009-05-25T02:06:37Z", "is_private": false, "text": "svn ci -m \"Fixing bugzilla entry 45433. SizeTag doesn't accept arrays\"\nSending        src/main/java/org/apache/taglibs/unstandard/SizeTag.java\nTransmitting file data .\nCommitted revision 778359.\n\n\nIndex: src/main/java/org/apache/taglibs/unstandard/SizeTag.java\n===================================================================\n--- src/main/java/org/apache/taglibs/unstandard/SizeTag.java    (revision 775710)\n+++ src/main/java/org/apache/taglibs/unstandard/SizeTag.java    (working copy)\n@@ -75,8 +75,15 @@\n             if(target instanceof String) {\n                 result = ( (String)target ).length();\n             } else\n-            if(target instanceof Collection) {\n-                result = ( (Object[])target ).length;\n+            if(target.getClass().isArray()) {\n+                try {\n+                    Field lengthField = target.getClass().getField(\"length\");\n+                    result = lengthField.getInt(target);\n+                } catch(NoSuchFieldException nsfe) {\n+                    throw new JspException(\"Array found without a length field\", nsfe);\n+                } catch(IllegalAccessException iae) {\n+                    throw new JspException(\"Array found with a non-accessible length field\", iae);\n+                }\n             }\n         }\n         if(var == null && result != -1) {"}]