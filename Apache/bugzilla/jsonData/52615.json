[{"count": 0, "tags": [], "bug_id": 52615, "text": "We use tomcat as the web app server. After we upgraded it from 5.5.x to 7.0.14, a critical issue happens.\n\nWhen the uncaught exception stack contains \"com.xxx.services.server.dispatch.callback.UTF8SocketChannel\" and \"com.xxx.services.server.dispatch.callback.LineBufferedSocketChannel\", which both have a DispatcherSession member which is registered on a daemon thread Dispatcher, Dispatcher thread is also terminated unexpectedly. And I am sure NOT all the non-daemon threads are terminated.\n\nThe uncaught exception stake looks like:\nThrowable occurred:java.nio.channels.UnresolvedAddressException\n        at sun.nio.ch.Net.checkAddress(Net.java:41)\n        at sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:499)\n        at com.xxx.services.server.dispatch.callback.UTF8SocketChannel.connect(UTF8SocketChannel.java:90)\n        at com.xxx.services.server.dispatch.callback.LineBufferedSocketChannel.connect(LineBufferedSocketChannel.java:95)\n        at com.xxx.jas.agent.AgentConnection.connect(AgentConnection.java:85)\n        at com.xxx.jas.agent.action.OpenAgentConnection.action(OpenAgentConnection.java:26)\n        at com.xxx.jas.fiber.FiberAction.call(FiberAction.java:197)\n        at com.xxx.jas.fiber.action.flow.Block.action(Block.java:63)\n        at com.xxx.jas.fiber.FiberAction.call(FiberAction.java:197)\n        at com.xxx.jas.agent.AgentFiber.action(AgentFiber.java:233)\n        at com.xxx.jas.agent.AgentFiber$AgentFiberAction.action(AgentFiber.java:336)\n        at com.xxx.jas.fiber.FiberAction.call(FiberAction.java:197)\n        at com.xxx.jas.fiber.Fiber.runFiber(Fiber.java:670)\n        at com.xxx.jas.fiber.FiberThread.runFibers(FiberThread.java:258)\n        at com.xxx.jas.fiber.FiberThread.run(FiberThread.java:246)\n\nIt seems tomcat 7.0.14 do some 'additional' cleanups for uncaught exceptions.\n\nNote: It occurs when numbers of concurrent uncaught exceptions happened in a short time. And it hard to be reproduced on linux platform.", "id": 153518, "time": "2012-02-07T05:24:50Z", "creator": "wanyux@cn.ibm.com", "creation_time": "2012-02-07T05:24:50Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 52615, "text": "There is nothing in that stack trace that indicates any Tomcat code is involved.\n\nTomcat does nothing when an application thread terminates or an uncaught exception occurs on an application thread.", "id": 153541, "time": "2012-02-07T09:49:58Z", "creator": "markt@apache.org", "creation_time": "2012-02-07T09:49:58Z", "is_private": false, "attachment_id": null}]