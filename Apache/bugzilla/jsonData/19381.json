[{"count": 0, "tags": [], "creator": "willem@vt4.net", "text": "I ran into a minor problem in POI, at first I thought it to\nbe related to the size of the data in the spreadsheet, but it turned\nout to be the MergeCellsRecord that becomes too big, resulting \nin excel refusing to open the spreadsheet (\"Unable to read file\"),\nwhile Gnumeric accepts it to be opened, but when trying to save it, \ngnumeric throws this assertion: ** CRITICAL **: file\n/tmp/buildd/gnumeric-1.0.8/build/../plugins/excel/ms-biff.c: line 192\n(ms_biff_put_len_next): assertion `len < MAX_LIKED_BIFF_LEN' failed.\n\nThis MAX_LIKE_BIFF_LEN turns out to be 8192.\n\nRunning your biffview on the spreadsheet, and piping that through a\ngrep/perl oneliner to sort the record-identifiers by size gives this : \n\naa4028@gray : grep size|  biffview_01.txt | perl -pne 's/(.*=)(.*)/\\2\n\\1\\2/' | sort -n | tail -7\n63 recordid = 0x41e, size =63\n112 recordid = 0x5c, size =112\n1018 recordid = 0xff, size =1018\n7697 recordid = 0x3c, size =7697\n8222 recordid = 0x3c, size =8222\n8224 recordid = 0xfc, size =8224\n12330 recordid = 0xe5, size =12330\n^^^^^ => THE OFFENDER !!! too big (my guess)\n\nWhen I remove all merging of cells from the code, and then generate the \nsame spreadsheet again, Excel has no problems with the sheet anymore. \n\naa4028@gray : grep size|  biffview_02.txt | perl -pne 's/(.*=)(.*)/\\2\n\\1\\2/' | sort -n | tail -7\n58 recordid = 0xe5, size =58\n63 recordid = 0x41e, size =63\n112 recordid = 0x5c, size =112\n1018 recordid = 0xff, size =1018\n7697 recordid = 0x3c, size =7697\n8222 recordid = 0x3c, size =8222\n8224 recordid = 0xfc, size =8224\n==> NO RECORDS GREATER THEN 8224 ( not 8192? ) --> works fine.\n\nI thought I'd just inform you of this problem. I guess I'll just\nrework my code to use fewer merged cells !\n\nThanks for your work on POI !", "id": 36210, "time": "2003-04-28T08:04:52Z", "bug_id": 19381, "creation_time": "2003-04-28T08:04:52Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 19381, "attachment_id": null, "text": "\n\n*** This bug has been marked as a duplicate of 16362 ***", "id": 41386, "time": "2003-07-24T16:24:29Z", "creator": "poi-support@buni.org", "creation_time": "2003-07-24T16:24:29Z", "is_private": false}]