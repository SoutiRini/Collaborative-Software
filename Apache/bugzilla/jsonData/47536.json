[{"count": 0, "tags": [], "creator": "iforone@spof.pl", "attachment_id": null, "id": 128877, "time": "2009-07-15T09:50:40Z", "bug_id": 47536, "creation_time": "2009-07-15T09:50:40Z", "is_private": false, "text": "Hello,\n\nI've found a bug in apache* server which makes local DOS attack possible.\nThe attack consists in executnig a code (php** for example) which executes itself and server stops acceptig new clients.\n\nVulnerable to attack are mod_php and mod_cgi.\nIt would appear that php made by mod_fastcgi is resistant (the server doeas not accpeting new requests for socket which we're attacking but the\nrest works stable - in the situation when every site has its own socket, someone who attacks can turn off 'his own' site only.)\n\nThe attack is not fine but no limits (process/memory/procesor time limit) can block it.\nI menaged to lead to the situation when 1 php process was blocking the server.\n\nSoftware:\n- HTTPD:\n    * apache-2.2.11\n    * apache-2.2.9\n- OS:\n    * gentoo (linux-2.6.29/linux-2.6.27)\n    * freebsd (7.0)\n- PHP:\n    * 5.2.10 (+suhosin)\n    * 5.2.9\n\nPOC:\n-----------------------------------------------------------------\n<?php\n        $url = $_SERVER['HTTP_HOST'].$_SERVER['SCRIPT_NAME'];\n        echo $url;\n        if (!function_exists('curl_init'))\n            die(\"no curl\");\n        $handle = curl_init(\"http://$url\");\n        curl_setopt($handle, CURLOPT_USERAGENT, \"www_agent\");\n        curl_exec($handle);\n        curl_close($handle);\n?>\n-----------------------------------------------------------------\n\n*  It's hard for me to estimate if the possibility to carring out the attack is caused by 'weakness' of the server or php - if you think\n   that it's not the server's fault, please contack me.\n** The attack was carried out with the aid of php, but I think that any code (used as cgi) can DOS httpd.\n\nIf you need any additional information or think that isn't bug, please contack me.\n\nYours sincerely,\nBartosz /zynzel/ Kupidura"}, {"count": 1, "tags": [], "bug_id": 47536, "attachment_id": null, "text": "It's not really an Apache bug if somebody writes a PHP script with infinite recursion.  The solution is not to do that.", "id": 130620, "time": "2009-09-23T10:09:18Z", "creator": "poirier@pobox.com", "creation_time": "2009-09-23T10:09:18Z", "is_private": false}]