[{"count": 0, "attachment_id": 27938, "bug_id": 52186, "text": "Created attachment 27938\ntest and xlsx-file with unsuccessful column group\n\nIf we set the width of the columns and add group on the columns, the columns do not appear. \n\nAttachment contains a file with a test that generates xlsx-file with unsuccessful group and generated file.\n\nIncluded libraries:\n\u2022\tpoi-3.8-beta4-20110826.jar \n\u2022\tpoi-examples-3.8-beta4-20110826.jar \n\u2022\tpoi-excelant-3.8-beta4-20110826.jar \n\u2022\tpoi-ooxml-3.8-beta4-20110826.jar \n\u2022\tpoi-ooxml-schemas-3.8-beta4-20110826.jar \n\u2022\tpoi-scratchpad-3.8-beta4-20110826.jar", "id": 151504, "time": "2011-11-15T11:14:02Z", "creator": "alesya.strokina@gersis-software.com", "creation_time": "2011-11-15T11:14:02Z", "tags": [], "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 52186, "is_private": false, "id": 167178, "time": "2013-05-13T20:04:29Z", "creator": "vladk.dev@gmail.com", "creation_time": "2013-05-13T20:04:29Z", "tags": [], "text": "I can confirm the problem is still present in POI 3.9. Below is the simplest client to reproduce the problem:\n\n        Workbook wb = new XSSFWorkbook();\n        Sheet sheet1 = wb.createSheet(\"new sheet\");\n\n        sheet1.setColumnWidth(4, 5000);\n        sheet1.setColumnWidth(5, 5000);\n       \n        sheet1.groupColumn((short) 4, (short) 7);\n        sheet1.groupColumn((short) 9, (short) 12);\n\n        FileOutputStream fileOut = new FileOutputStream(\"outlining.xlsx\");\n        wb.write(fileOut);\n        fileOut.close();"}, {"count": 2, "tags": [], "creator": "vladk.dev@gmail.com", "text": "It appears that Excel 2010 doesn't like column definitions with undefined \"width\" attribute like follows:\n<cols>\n\t<col min=\"5\" max=\"5\" width=\"20.0\" customWidth=\"true\" collapsed=\"false\" outlineLevel=\"1\"/>\n\t<col min=\"6\" max=\"8\" collapsed=\"false\" outlineLevel=\"1\"/>\n</cols>\n\nThe Excel 2010 would create the following column configuration:\n<cols>\n\t<col min=\"5\" max=\"5\" width=\"20.0\" customWidth=\"1\" outlineLevel=\"1\"/>\n\t<col min=\"6\" max=\"8\" width=\"11.42578125\" customWidth=\"1\" outlineLevel=\"1\"/>\n</cols>\nwhereas width=\"11.42578125\" seems to be the default width for my system.\n\nAccording to the specification width is an optional attribute with unspecified default value: http://www.schemacentral.com/sc/ooxml/e-ssml_col-1.html\n\n\nThe mentioned column configuration was produced by the following code:\n\tsheet1.setColumnWidth(4, 20*256);\n\tsheet1.groupColumn( (short)4, (short)7 );\n\n\nA workaround is to set explicit width for all grouped columns after the grouping:\n\tsheet1.setColumnWidth(4, 20*256);\n\tsheet1.groupColumn( (short)4, (short)7 );\n\tsheet1.setColumnWidth(5, sheet1.getDefaultColumnWidth() * 256);\n\tsheet1.setColumnWidth(6, sheet1.getDefaultColumnWidth() * 256);\n\tsheet1.setColumnWidth(7, sheet1.getDefaultColumnWidth() * 256);\n\nDoes anyone have an idea what where the proper class/method to modify POI to make it setting \"width\" attribute always?", "id": 167959, "time": "2013-06-21T19:30:01Z", "bug_id": 52186, "creation_time": "2013-06-21T19:30:01Z", "is_private": false, "attachment_id": null}, {"count": 3, "attachment_id": null, "bug_id": 52186, "is_private": false, "id": 168057, "time": "2013-06-25T21:30:19Z", "creator": "apache@gagravarr.org", "creation_time": "2013-06-25T21:30:19Z", "tags": [], "text": "In Excel, if you group the columns, does it auto-calculate the width for you? \n\n(I'm just wondering if we can safely just read the widths of the columns to be grouped to set the overall grouping width, or if we'd need to do an auto-calculation first)\n\nAs for where to put the code, search for CTCols and CTCol, those should be the names of the xmlbeans classes for <cols> and <col> - any width setting code will want to go with/near similar modifications of those beans."}, {"count": 4, "tags": [], "text": "Excel 2010 creates <cols> tag with the following content for:\n\n- Excel sheet with one column having custom width\n<cols>\n\t<col min=\"2\" max=\"2\" width=\"26.625\" customWidth=\"1\"/>\n</cols>\n\n- Excel sheet with one column having custom width. The column is part of a column group \"2..4\". The column group is expanded.\n<cols>\n\t<col min=\"2\" max=\"2\" width=\"26.625\" customWidth=\"1\" outlineLevel=\"1\"/>\n\t<col min=\"3\" max=\"4\" width=\"11\" outlineLevel=\"1\"/>\n</cols>\n\n- Excel sheet with one column having custom width. The column is part of a column group \"2..4\". The column group is collapsed.\n<cols>\n\t<col min=\"2\" max=\"2\" width=\"26.625\" hidden=\"1\" customWidth=\"1\" outlineLevel=\"1\"/>\n\t<col min=\"3\" max=\"4\" width=\"0\" hidden=\"1\" customWidth=\"1\" outlineLevel=\"1\"/>\n\t<col min=\"5\" max=\"5\" width=\"11\" collapsed=\"1\"/>\n</cols>\n\nExcel 2010 never omits the \"width\" attribute in <col> tags. If the column width is not defined explicitly, it takes \"0\" for hidden columns and \"11\" for visible ones. \"11\" appears to be the default width. To behave like Excel 2010, the POI has to set \"width\" attribute whenever it creates a <col> tag.\n\nBy the way, Excel 2010 and POI have different default widths: Excel 2010 - \"11\", POI - \"8\". Why \"8\"? May the XSSFSheet.getDefaultColumnWidth() method be modified, to return 11 instead of 8?", "attachment_id": null, "bug_id": 52186, "id": 168061, "time": "2013-06-26T07:55:27Z", "creator": "vladk.dev@gmail.com", "creation_time": "2013-06-26T07:55:27Z", "is_private": false}, {"count": 5, "tags": [], "text": "Created attachment 30563\nPatch to set column width when grouping columns", "is_private": false, "bug_id": 52186, "id": 168350, "time": "2013-07-07T18:40:51Z", "creator": "vladk.dev@gmail.com", "creation_time": "2013-07-07T18:40:51Z", "attachment_id": 30563}, {"count": 6, "tags": [], "creator": "tallison@mitre.org", "text": "Should be fixed as of r1510587.", "id": 169136, "time": "2013-08-05T16:22:53Z", "bug_id": 52186, "creation_time": "2013-08-05T16:22:53Z", "is_private": false, "attachment_id": null}]