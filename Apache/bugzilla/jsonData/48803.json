[{"count": 0, "tags": [], "creator": "mleegwater@gmail.com", "is_private": false, "id": 134813, "attachment_id": null, "bug_id": 48803, "creation_time": "2010-02-23T11:35:23Z", "time": "2010-02-23T11:35:23Z", "text": "While using POI to generate a new Excel file no problems occur. However, when reading the generated file using Excel 2003 (SP3) the message \"File error: data may have been lost\" shows up when opening the generated file. (File is attached with contents converted to gibberish (quite literally)). Otherwise the file seems quite fine when reading it with Excel 2003. However when opening it using Excel 2000 the error message also occurs, but the file is not readable."}, {"count": 1, "tags": [], "bug_id": 48803, "text": "Created attachment 25041\nFile with error (zipped, due to size limit)", "id": 134814, "time": "2010-02-23T11:39:51Z", "creator": "mleegwater@gmail.com", "creation_time": "2010-02-23T11:39:51Z", "is_private": false, "attachment_id": 25041}, {"count": 2, "tags": [], "bug_id": 48803, "text": "Created attachment 25042\nSame file (zipped) without error (file with error saved by MS Excel 2003)", "id": 134815, "time": "2010-02-23T11:40:47Z", "creator": "mleegwater@gmail.com", "creation_time": "2010-02-23T11:40:47Z", "is_private": false, "attachment_id": 25042}, {"count": 3, "tags": [], "creator": "mzalewsk@us.ibm.com", "is_private": false, "id": 134867, "attachment_id": null, "bug_id": 48803, "creation_time": "2010-02-24T18:35:11Z", "time": "2010-02-24T18:35:11Z", "text": "The attached XLS contains two strings in the string table with a value of \"gibberish\".\n\nThe first one is a 'Rich Text' type, but there is only one format run. According to my reading of the Excel spec, a 'Rich Text' type should contain at least two distinct format runs.\n\nLook at your code where you are generating a Rich Text string. If there is only one format, apply the style to the cell itself (instead of applying one format to the entire string)."}, {"count": 4, "tags": [], "bug_id": 48803, "attachment_id": 25060, "text": "Created attachment 25060\nNew file (zipped) without Rich Text", "id": 134889, "time": "2010-02-25T16:01:45Z", "creator": "mleegwater@gmail.com", "creation_time": "2010-02-25T16:01:45Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 48803, "attachment_id": null, "text": "Thanks for your efforts Michael. A new 'gibberish' file has been added which, unfortunately has the same problem (or it looks like it). The Rich Text objects have been removed and the style issues have been implemented using the suggested cell.setCellStyle().", "id": 134890, "time": "2010-02-25T16:07:29Z", "creator": "mleegwater@gmail.com", "creation_time": "2010-02-25T16:07:29Z", "is_private": false}, {"count": 6, "tags": [], "text": "I see one more problem with the shared string table, but I have no idea how it comes about. In 'gibberish with errors.xls', the shared string table looks like this:\n\n[SST] strings=97908 unique=4\n0: 'gibberish' ref=2365 hash=a3697bb2\n1: 'gibberish'5 ref=95543 hash=a3697bb2\nEXTSST {strings_per_entry=8, sst_index=[{sst=1964, offset=12, unused=0}]}\n[/SST]\n\nThe header claims that the table has 4 unique strings, but there are only 2.\n\nIn 'gibberish with errors 2.xls', the shared string table looks like this:\n\n[SST] strings=97926 unique=2\n0: 'gibberish' ref=97926 hash=a3697bb2\nEXTSST {strings_per_entry=8, sst_index=[{sst=2057, offset=12, unused=0}]}\n[/SST]\n\nNow the table claims to have 2 unique strings, but there is only 1. It's also interesting to note: The two files have a different number of strings. In the first file, the total strings count is 97908, in the second it is 97926. In the above output fragments, ref= refers to the number of LABELSST cells that refer to a particular string. These numbers do add up, so POI is probably getting this number correct. (In the first file, 95543 + 2365 = 97908. In the second, there is only one SST entry, and it has 97926 cells which reference that value).\n\nI guess your code must be creating the value 'gibberish' in two different ways. Perhaps you set one value and then change it? In any event, this is definately a bug in POI. Probably two bugs\n\n1) POI should not allow a RichText value with only one format run to be put into the SST as a RichText. Instead, the format should be applied to the entire cell, and the value should be placed into the SST as simple text.\n\n2) POI appears to be counting the unique strings in the SST incorrectly. It doesn't usually do this -- there are probably thousands of users who do not encounter this problem.", "is_private": false, "id": 134910, "creator": "mzalewsk@us.ibm.com", "time": "2010-02-26T00:34:07Z", "bug_id": 48803, "creation_time": "2010-02-26T00:34:07Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 48803, "attachment_id": null, "text": "The cells are only written once. When I disable the 'gibberish11' tab the problem is no longer there. It may seem that this problem is size related. The 'gibberish9' and 'gibberish10' tabs are generated using the same code.\n\nThanks for your investigations.", "id": 135257, "time": "2010-03-11T09:01:31Z", "creator": "mleegwater@gmail.com", "creation_time": "2010-03-11T09:01:31Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 48803, "text": "Er, right. Revisited this issue today and found that setting the width of too many columns (more than HSSF supports) caused the problem.\n\nShould calls to HSSFSheet.setColumnWidth(int, int) be protected with a range check?", "id": 144177, "time": "2011-02-11T05:59:41Z", "creator": "mleegwater@gmail.com", "creation_time": "2011-02-11T05:59:41Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 48803, "text": "(In reply to comment #8)\n> Er, right. Revisited this issue today and found that setting the width of too\n> many columns (more than HSSF supports) caused the problem.\n> \n> Should calls to HSSFSheet.setColumnWidth(int, int) be protected with a range\n> check?\n\nHSSF should support the same number of files as excel does (256 for a .xls file). Are you finding something different?", "id": 144180, "time": "2011-02-11T07:22:50Z", "creator": "apache@gagravarr.org", "creation_time": "2011-02-11T07:22:50Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "creator": "mleegwater@gmail.com", "is_private": false, "id": 144192, "attachment_id": null, "bug_id": 48803, "creation_time": "2011-02-11T08:47:54Z", "time": "2011-02-11T08:47:54Z", "text": "(In reply to comment #9)\n> HSSF should support the same number of files as excel does (256 for a .xls\n> file). Are you finding something different?\nI am not finding something different. To comply with the column limitation the table was transposed, but the column widths were not."}, {"count": 11, "tags": [], "text": "As far as I can identify this should either be fixed or was some other problem in the first place, therefore I am closing this old bug report for now, please report a new bug if there is still something that seems to not work for you.", "attachment_id": null, "bug_id": 48803, "id": 192666, "time": "2016-07-26T20:05:33Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-07-26T20:05:33Z", "is_private": false}]