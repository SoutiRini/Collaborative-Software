[{"count": 0, "tags": [], "bug_id": 49170, "text": "Created attachment 25333\npatch against trunk.\n\nConfig\n<Manager className=\"org.apache.catalina.ha.session.DeltaManager\"\n         sendAllSessions=\"false\"\n         sendAllSessionsSize=\"XXXX\" />\n\nDeltaManager#handleGET_ALL_SESSIONS is as follows.\n=====\n...skip...\nif (isSendAllSessions()) {\n    sendSessions(sender, currentSessions, findSessionTimestamp);\n} else {\n    // send session at blocks\n    int len = currentSessions.length < getSendAllSessionsSize() ? currentSessions.length : getSendAllSessionsSize();        Session[] sendSessions = new Session[len];\n    for (int i = 0; i < currentSessions.length; i += getSendAllSessionsSize()) {\n        len = i + getSendAllSessionsSize() > currentSessions.length ? currentSessions.length - i : getSendAllSessionsSize();\n        System.arraycopy(currentSessions, i, sendSessions, 0, len);\n        sendSessions(sender, sendSessions,findSessionTimestamp);\n...skip...\n    }\n...skip...\n}\n\n=====\n\nsendSessions maintains previous Session. \n\nFor instance,\ncurrentSessions=[ssA, ssB, ssC, ssD, ssE]\nsendAllSessionsSize=3\n\nloop1 : sendSessions=[ssA, ssB, ssC]\nloop2 : sendSessions=[ssD, ssE, ssC]\n\nssC is transmitted two times.\nIt should be the following. \n\nloop1 :  sendSessions=[ssA, ssB, ssC]\nloop2 : sendSessions=[ssD, ssE]\n\nThis problem exists in TC5.5, TC6.0, and TC7.0. \n\nI made a patch against trunk.\n\nBest Regards.", "id": 136317, "time": "2010-04-22T06:54:01Z", "creator": "kfujino@apache.org", "creation_time": "2010-04-22T06:54:01Z", "is_private": false, "attachment_id": 25333}, {"count": 1, "tags": [], "creator": "kfujino@apache.org", "attachment_id": null, "text": "Fixed in trunk and proposed for 6.0.x and 5.5.x.", "id": 136318, "time": "2010-04-22T07:08:00Z", "bug_id": 49170, "creation_time": "2010-04-22T07:08:00Z", "is_private": false}, {"count": 2, "attachment_id": null, "creator": "kfujino@apache.org", "is_private": false, "id": 136748, "time": "2010-05-10T06:29:36Z", "bug_id": 49170, "creation_time": "2010-05-10T06:29:36Z", "tags": [], "text": "This fix applied to 6.0, will be in 6.0.27 onwards."}, {"count": 3, "tags": [], "bug_id": 49170, "text": "This fix applied to 5.5, will be in 5.5.30 onwards.", "id": 136749, "time": "2010-05-10T06:30:06Z", "creator": "kfujino@apache.org", "creation_time": "2010-05-10T06:30:06Z", "is_private": false, "attachment_id": null}]