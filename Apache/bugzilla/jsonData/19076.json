[{"count": 0, "tags": [], "bug_id": 19076, "text": "I am attempting to run the most recent nightly of Tomcat 5 .. when using a \nfilter I get the following exception:\n\n--------------------------\n\nApr 15, 2003 11:25:26 AM org.apache.catalina.core.ApplicationDispatcher \ndoForward\nSEVERE: Shouldn't happen - old code\njava.lang.Throwable\n        at org.apache.catalina.core.ApplicationDispatcher.doForward\n(ApplicationDispatcher.java:464)\n        at org.apache.catalina.core.ApplicationDispatcher.forward\n(ApplicationDispatcher.java:361)\n        at com.eloquent.ecs.ERequest.forward(ERequest.java:3659)\n        at com.eloquent.ecs.ERequest.service(ERequest.java:1499)\n        at com.eloquent.ecs.EServlet.doService(EServlet.java:381)\n        at com.eloquent.ecs.EServlet.doGet(EServlet.java:344)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:740)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java:288)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java:206)\n        at com.eloquent.ecs.filters.ECompressionFilter.doFilter\n(ECompressionFilter.java:88)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java:235)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.StandardWrapperValve.invoke\n(StandardWrapperValve.java:263)\n        at org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:151)\n        at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:552)\n        at org.apache.catalina.core.ContainerBase.invoke\n(ContainerBase.java:1017)\n        at org.apache.catalina.core.StandardContextValve.invoke\n(StandardContextValve.java:196)\n        at org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:151)\n        at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:552)\n        at org.apache.catalina.core.ContainerBase.invoke\n(ContainerBase.java:1017)\n        at org.apache.catalina.core.StandardContext.invoke\n(StandardContext.java:2698)\n        at org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:186)\n        at org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:151)\n        at org.apache.catalina.valves.ErrorDispatcherValve.invoke\n(ErrorDispatcherValve.java:171)\n        at org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:149)\n        at org.apache.catalina.valves.ErrorReportValve.invoke\n(ErrorReportValve.java:172)\n        at org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:149)\n        at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:552)\n        at org.apache.catalina.core.ContainerBase.invoke\n(ContainerBase.java:1017)\n        at org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:163)\n        at org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:151)\n        at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:552)\n        at org.apache.catalina.core.ContainerBase.invoke\n(ContainerBase.java:1017)\n        at org.apache.coyote.tomcat5.CoyoteAdapter.service\n(CoyoteAdapter.java:199)\n        at org.apache.coyote.http11.Http11Processor.process\n(Http11Processor.java:630)\n        at \norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnectio\nn(Http11Protocol.java:463)\n        at org.apache.tomcat.util.net.TcpWorkerThread.runIt\n(PoolTcpEndpoint.java:568)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:631)\n        at java.lang.Thread.run(Thread.java:534)\n\n----------------------------\n\nmy filter (a variant of the example compression filter) wraps the current \nservlet request in an class that extends HttpServletResponseWrapper .. for \nexample:\n\n     public class ECompressionServletResponseWrapper extends \nHttpServletResponseWrapper\n\nthe code in org.apache.catalina.core.ApplicationDispatcher.doForward makes a \ncheck to make sure the response is an instance of:\n\n    org.apache.catalina.connector.ResponseFacade\n\ncould that possibly be correct ?\n\nLen", "id": 35349, "time": "2003-04-16T15:50:17Z", "creator": "lkarpel@eloquent.com", "creation_time": "2003-04-16T15:50:17Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 19076, "attachment_id": null, "id": 35432, "time": "2003-04-17T15:34:29Z", "creator": "jfarcand@apache.org", "creation_time": "2003-04-17T15:34:29Z", "is_private": false, "text": "Fixed. The exception should no longer be displayed. Let me know if the\nfunctionality is still not working.\n\nThanks,\n\n-- Jeanfrancois"}]