[{"count": 0, "tags": [], "text": "My shell script that worked fine piped with CustomLog at earlier versions \nbefore 2.0.44 & 45 - gets its PID when server started, but looses its PID as \nsoon as the server has a GET page call.  At 2.0.44 the shell script was lost \ncompletly. At 2.0.45 the script gets a new higher PID after GET, but looses \ncontact with the httpd server.", "is_private": false, "bug_id": 18975, "id": 35063, "time": "2003-04-12T14:44:56Z", "creator": "webmaster@kreorg.hu", "creation_time": "2003-04-12T14:44:56Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 18975, "attachment_id": null, "id": 35178, "time": "2003-04-15T11:01:05Z", "creator": "trawick@apache.org", "creation_time": "2003-04-15T11:01:05Z", "is_private": false, "text": "Can you run strace on your log program to see why it terminates?  Did Apache\nkill it, did it get SIGPIPE, etc.?\n\nIf I understand your description, you can\n\n  start Apache\n  use ps to find pid of your log program\n  strace -p LOG_PROGRAM_PID\n  \nthen send a request to Apache from a browser\n\nand the strace output will show what is happening to your log program.\n"}, {"count": 2, "attachment_id": null, "bug_id": 18975, "is_private": false, "id": 35292, "time": "2003-04-16T04:39:11Z", "creator": "webmaster@kreorg.hu", "creation_time": "2003-04-16T04:39:11Z", "tags": [], "text": "Running strace, it gave the output below:\nread(0, \"1\", 1)                         = 1\nread(0, \"1\", 1)                         = 1\nread(0, \"1\", 1)                         = 1\nread(0, \".\", 1)                         = 1\nread(0, \"2\", 1)                         = 1\nread(0, \"2\", 1)                         = 1\nread(0, \"2\", 1)                         = 1\nread(0, \".\", 1)                         = 1\nread(0, \"3\", 1)                         = 1\nread(0, \"3\", 1)                         = 1\nread(0, \".\", 1)                         = 1\nread(0, \"4\", 1)                         = 1\nread(0, \" \", 1)                         = 1\nread(0, \"-\", 1)                         = 1\nread(0, \" \", 1)                         = 1\nread(0, \"-\", 1)                         = 1\nread(0, \" \", 1)                         = 1\nread(0, \"[\", 1)                         = 1\nread(0, \"1\", 1)                         = 1\nread(0, \"5\", 1)                         = 1\nread(0, \"/\", 1)                         = 1\nread(0, \"A\", 1)                         = 1\nread(0, \"p\", 1)                         = 1\nread(0, \"r\", 1)                         = 1\nread(0, \"/\", 1)                         = 1\nread(0, \"2\", 1)                         = 1\nread(0, \"0\", 1)                         = 1\nread(0, \"0\", 1)                         = 1\nread(0, \"3\", 1)                         = 1\nread(0, \":\", 1)                         = 1\nread(0, \"1\", 1)                         = 1\nread(0, \"3\", 1)                         = 1\nread(0, \":\", 1)                         = 1\nread(0, \"2\", 1)                         = 1\nread(0, \"3\", 1)                         = 1\nread(0, \":\", 1)                         = 1\nread(0, \"3\", 1)                         = 1\nread(0, \"2\", 1)                         = 1\nread(0, \" \", 1)                         = 1\nread(0, \"+\", 1)                         = 1\nread(0, \"0\", 1)                         = 1\nread(0, \"0\", 1)                         = 1\nread(0, \"0\", 1)                         = 1\nread(0, \"0\", 1)                         = 1\nread(0, \"]\", 1)                         = 1\nread(0, \" \", 1)                         = 1\nread(0, \"\\\"\", 1)                        = 1\nread(0, \"G\", 1)                         = 1\nread(0, \"E\", 1)                         = 1\nread(0, \"T\", 1)                         = 1\nread(0, \" \", 1)                         = 1\nread(0, \"/\", 1)                         = 1\nread(0, \"d\", 1)                         = 1\nread(0, \"i\", 1)                         = 1\nread(0, \"r\", 1)                         = 1\nread(0, \"-\", 1)                         = 1\nread(0, \"d\", 1)                         = 1\nread(0, \"i\", 1)                         = 1\nread(0, \"r\", 1)                         = 1\nread(0, \"/\", 1)                         = 1\nread(0, \"a\", 1)                         = 1\nread(0, \"p\", 1)                         = 1\nread(0, \"a\", 1)                         = 1\nread(0, \"g\", 1)                         = 1\nread(0, \"e\", 1)                         = 1\nread(0, \"o\", 1)                         = 1\nread(0, \"f\", 1)                         = 1\nread(0, \"h\", 1)                         = 1\nread(0, \"i\", 1)                         = 1\nread(0, \"s\", 1)                         = 1\nread(0, \"?\", 1)                         = 1\nread(0, \"v\", 1)                         = 1\nread(0, \"i\", 1)                         = 1\nread(0, \"e\", 1)                         = 1\nread(0, \"w\", 1)                         = 1\nread(0, \"=\", 1)                         = 1\nread(0, \"t\", 1)                         = 1\nread(0, \"e\", 1)                         = 1\nread(0, \"s\", 1)                         = 1\nread(0, \"t\", 1)                         = 1\nread(0, \" \", 1)                         = 1\nread(0, \"H\", 1)                         = 1\nread(0, \"T\", 1)                         = 1\nread(0, \"T\", 1)                         = 1\nread(0, \"P\", 1)                         = 1\nread(0, \"/\", 1)                         = 1\nread(0, \"1\", 1)                         = 1\nread(0, \".\", 1)                         = 1\nread(0, \"1\", 1)                         = 1\nread(0, \"\\\"\", 1)                        = 1\nread(0, \" \", 1)                         = 1\nread(0, \"2\", 1)                         = 1\nread(0, \"0\", 1)                         = 1\nread(0, \"0\", 1)                         = 1\nread(0, \" \", 1)                         = 1\nread(0, \"2\", 1)                         = 1\nread(0, \"8\", 1)                         = 1\nread(0, \"2\", 1)                         = 1\nread(0, \"8\", 1)                         = 1\nread(0, \" \", 1)                         = 1\nread(0, \"\\\"\", 1)                        = 1\nread(0, \"h\", 1)                         = 1\nread(0, \"t\", 1)                         = 1\nread(0, \"t\", 1)                         = 1\nread(0, \"p\", 1)                         = 1\nread(0, \":\", 1)                         = 1\nread(0, \"/\", 1)                         = 1\nread(0, \"/\", 1)                         = 1\nread(0, \"w\", 1)                         = 1\nread(0, \"w\", 1)                         = 1\nread(0, \"w\", 1)                         = 1\nread(0, \".\", 1)                         = 1\nread(0, \"a\", 1)                         = 1\nread(0, \"s\", 1)                         = 1\nread(0, \"i\", 1)                         = 1\nread(0, \"t\", 1)                         = 1\nread(0, \"1\", 1)                         = 1\nread(0, \"2\", 1)                         = 1\nread(0, \".\", 1)                         = 1\nread(0, \"h\", 1)                         = 1\nread(0, \"u\", 1)                         = 1\nread(0, \"/\", 1)                         = 1\nread(0, \"a\", 1)                         = 1\nread(0, \"p\", 1)                         = 1\nread(0, \"a\", 1)                         = 1\nread(0, \"g\", 1)                         = 1\nread(0, \"e\", 1)                         = 1\nread(0, \".\", 1)                         = 1\nread(0, \"h\", 1)                         = 1\nread(0, \"t\", 1)                         = 1\nread(0, \"m\", 1)                         = 1\nread(0, \"\\\"\", 1)                        = 1\nread(0, \" \", 1)                         = 1\nread(0, \"\\\"\", 1)                        = 1\nread(0, \"M\", 1)                         = 1\nread(0, \"o\", 1)                         = 1\nread(0, \"z\", 1)                         = 1\nread(0, \"i\", 1)                         = 1\nread(0, \"l\", 1)                         = 1\nread(0, \"l\", 1)                         = 1\nread(0, \"a\", 1)                         = 1\nread(0, \"/\", 1)                         = 1\nread(0, \"4\", 1)                         = 1\nread(0, \".\", 1)                         = 1\nread(0, \"0\", 1)                         = 1\nread(0, \" \", 1)                         = 1\nread(0, \"(\", 1)                         = 1\nread(0, \"c\", 1)                         = 1\nread(0, \"o\", 1)                         = 1\nread(0, \"m\", 1)                         = 1\nread(0, \"p\", 1)                         = 1\nread(0, \"a\", 1)                         = 1\nread(0, \"t\", 1)                         = 1\nread(0, \"i\", 1)                         = 1\nread(0, \"b\", 1)                         = 1\nread(0, \"l\", 1)                         = 1\nread(0, \"e\", 1)                         = 1\nread(0, \";\", 1)                         = 1\nread(0, \" \", 1)                         = 1\nread(0, \"M\", 1)                         = 1\nread(0, \"S\", 1)                         = 1\nread(0, \"I\", 1)                         = 1\nread(0, \"E\", 1)                         = 1\nread(0, \" \", 1)                         = 1\nread(0, \"6\", 1)                         = 1\nread(0, \".\", 1)                         = 1\nread(0, \"0\", 1)                         = 1\nread(0, \";\", 1)                         = 1\nread(0, \" \", 1)                         = 1\nread(0, \"W\", 1)                         = 1\nread(0, \"i\", 1)                         = 1\nread(0, \"n\", 1)                         = 1\nread(0, \"d\", 1)                         = 1\nread(0, \"o\", 1)                         = 1\nread(0, \"w\", 1)                         = 1\nread(0, \"s\", 1)                         = 1\nread(0, \" \", 1)                         = 1\nread(0, \"N\", 1)                         = 1\nread(0, \"T\", 1)                         = 1\nread(0, \" \", 1)                         = 1\nread(0, \"5\", 1)                         = 1\nread(0, \".\", 1)                         = 1\nread(0, \"1\", 1)                         = 1\nread(0, \";\", 1)                         = 1\nread(0, \" \", 1)                         = 1\nread(0, \".\", 1)                         = 1\nread(0, \"N\", 1)                         = 1\nread(0, \"E\", 1)                         = 1\nread(0, \"T\", 1)                         = 1\nread(0, \" \", 1)                         = 1\nread(0, \"C\", 1)                         = 1\nread(0, \"L\", 1)                         = 1\nread(0, \"R\", 1)                         = 1\nread(0, \" \", 1)                         = 1\nread(0, \"1\", 1)                         = 1\nread(0, \".\", 1)                         = 1\nread(0, \"0\", 1)                         = 1\nread(0, \".\", 1)                         = 1\nread(0, \"3\", 1)                         = 1\nread(0, \"7\", 1)                         = 1\nread(0, \"0\", 1)                         = 1\nread(0, \"5\", 1)                         = 1\nread(0, \")\", 1)                         = 1\nread(0, \"\\\"\", 1)                        = 1\nread(0, \"\\n\", 1)                        = 1\nrt_sigprocmask(SIG_BLOCK, NULL, [RT_0], 8) = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD TTOU], [RT_0], 8) = 0\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\npipe([3, 4])                            = 0\nrt_sigprocmask(SIG_BLOCK, [INT CHLD], [RT_0], 8) = 0\n_llseek(255, -391, [956], SEEK_CUR)     = 0\nfork()                                  = 8870\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\n--- SIGCHLD (Child exited) ---\nwait4(-1, [WIFEXITED(s) && WEXITSTATUS(s) == 0], WNOHANG, NULL) = 8870\nwait4(-1, 0xbffff588, WNOHANG, NULL)    = -1 ECHILD (No child processes)\nsigreturn()                             = ? (mask now [])\nrt_sigaction(SIGCHLD, {0x806dbb0, [], 0x4000000}, {0x806dbb0, [], 0x4000000}, \n8) = 0\nclose(4)                                = 0\nread(3, \"111.222.33.4\\n\", 128)          = 13\nread(3, \"\", 128)                        = 0\nclose(3)                                = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD], [RT_0], 8) = 0\nrt_sigaction(SIGINT, {0x806cdd0, [], 0x4000000}, {SIG_DFL}, 8) = 0\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\nrt_sigaction(SIGINT, {SIG_DFL}, {0x806cdd0, [], 0x4000000}, 8) = 0\nrt_sigprocmask(SIG_BLOCK, NULL, [RT_0], 8) = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD TTOU], [RT_0], 8) = 0\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\nread(255, \"\\nif echo $INPUT |grep -f $ANPATH\"..., 1347) = 391\nrt_sigprocmask(SIG_BLOCK, NULL, [RT_0], 8) = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD TTOU], [RT_0], 8) = 0\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD TTOU], [RT_0], 8) = 0\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD TTOU], [RT_0], 8) = 0\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD TTOU], [RT_0], 8) = 0\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD TTOU], [RT_0], 8) = 0\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD TTOU], [RT_0], 8) = 0\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD TTOU], [RT_0], 8) = 0\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD TTOU], [RT_0], 8) = 0\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD TTOU], [RT_0], 8) = 0\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD], [RT_0], 8) = 0\npipe([3, 4])                            = 0\nrt_sigprocmask(SIG_BLOCK, [INT CHLD], [CHLD RT_0], 8) = 0\n_llseek(255, -14, [1333], SEEK_CUR)     = 0\nfork()                                  = 8873\nrt_sigprocmask(SIG_SETMASK, [CHLD RT_0], NULL, 8) = 0\nclose(4)                                = 0\nclose(4)                                = -1 EBADF (Bad file descriptor)\nrt_sigprocmask(SIG_BLOCK, [INT CHLD], [CHLD RT_0], 8) = 0\nfork()                                  = 8874\nrt_sigprocmask(SIG_SETMASK, [CHLD RT_0], NULL, 8) = 0\nclose(3)                                = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD], [CHLD RT_0], 8) = 0\nrt_sigprocmask(SIG_SETMASK, [CHLD RT_0], NULL, 8) = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD], [CHLD RT_0], 8) = 0\nrt_sigaction(SIGINT, {0x806cdd0, [], 0x4000000}, {SIG_DFL}, 8) = 0\nwait4(-1, [WIFEXITED(s) && WEXITSTATUS(s) == 0], 0, NULL) = 8873\nwait4(-1, [WIFEXITED(s) && WEXITSTATUS(s) == 1], 0, NULL) = 8874\nrt_sigprocmask(SIG_BLOCK, [CHLD TTOU], [CHLD RT_0], 8) = 0\nrt_sigprocmask(SIG_SETMASK, [CHLD RT_0], NULL, 8) = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD], [CHLD RT_0], 8) = 0\nrt_sigprocmask(SIG_SETMASK, [CHLD RT_0], NULL, 8) = 0\nrt_sigprocmask(SIG_SETMASK, [CHLD RT_0], NULL, 8) = 0\nrt_sigaction(SIGINT, {SIG_DFL}, {0x806cdd0, [], 0x4000000}, 8) = 0\nclose(3)                                = -1 EBADF (Bad file descriptor)\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\n--- SIGCHLD (Child exited) ---\nwait4(-1, 0xbffff828, WNOHANG, NULL)    = -1 ECHILD (No child processes)\nsigreturn()                             = ? (mask now [])\nrt_sigprocmask(SIG_BLOCK, NULL, [RT_0], 8) = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD TTOU], [RT_0], 8) = 0\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD], [RT_0], 8) = 0\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\nread(255, \"\\t\\t\\t\\t\\t\\t\\nexit 0\\n\", 1347) = 14\nrt_sigprocmask(SIG_BLOCK, NULL, [RT_0], 8) = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD TTOU], [RT_0], 8) = 0\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD], [RT_0], 8) = 0\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\n_exit(0)                                = ?\n"}, {"count": 3, "tags": [], "text": "The last part of the strace is as follows:\n\nread(255, \"\\t\\t\\t\\t\\t\\t\\nexit 0\\n\", 1347) = 14\nrt_sigprocmask(SIG_BLOCK, NULL, [RT_0], 8) = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD TTOU], [RT_0], 8) = 0\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\nrt_sigprocmask(SIG_BLOCK, [CHLD], [RT_0], 8) = 0\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\nrt_sigprocmask(SIG_SETMASK, [RT_0], NULL, 8) = 0\n_exit(0)                                = ?\n\nLook at the first line quoted above:  It looks to me like the shell is reading\n\"exit 0\" from your piped log script and then exiting.  So your piped log script\nis choosing to exit.  I don't have any great guesses why, but I see\n\nread(255, \"\\nif echo $INPUT |grep -f $ANPATH\"..., 1347) = 391\n\na bit above, followed by running some child processes...\n\nmaybe you don't see the expected data in the input and choose to exit?\n\nI don't see Apache doing anything weird (your script didn't hit EOF on \nstdin, your script didn't get SIGTERM from Apache, etc.).  You'll need\nto review your script or add some tracing to it to see why your script\nis choosing to exit.\n\n", "is_private": false, "bug_id": 18975, "id": 35311, "time": "2003-04-16T10:26:21Z", "creator": "trawick@apache.org", "creation_time": "2003-04-16T10:26:21Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 18975, "text": "No further response.", "id": 38124, "time": "2003-06-01T16:49:28Z", "creator": "nd@perlig.de", "creation_time": "2003-06-01T16:49:28Z", "is_private": false, "attachment_id": null}]