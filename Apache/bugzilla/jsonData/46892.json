[{"count": 0, "tags": [], "creator": "nick.giles@ontology.com", "attachment_id": null, "is_private": false, "id": 125705, "time": "2009-03-23T08:10:11Z", "bug_id": 46892, "creation_time": "2009-03-23T08:10:11Z", "text": "When attempting to load a file that is readable by 3.2, get the following stack trace:\n\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\tat org.apache.poi.hssf.record.RecordFactory.createSingleRecord(RecordFactory.java:226)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:352)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:276)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:201)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:183)\n\n...\n\nCaused by: org.apache.poi.hssf.record.RecordFormatException: Expected to find a ContinueRecord in order to read remaining 65535 of 65535 chars\n\tat org.apache.poi.hssf.record.RecordInputStream.readStringCommon(RecordInputStream.java:318)\n\tat org.apache.poi.hssf.record.RecordInputStream.readUnicodeLEString(RecordInputStream.java:273)\n\tat org.apache.poi.hssf.record.pivottable.ExtendedPivotTableViewFieldsRecord.<init>(ExtendedPivotTableViewFieldsRecord.java:57)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:513)\n\tat org.apache.poi.hssf.record.RecordFactory.createSingleRecord(RecordFactory.java:224)\n\t... 42 more\n\n\nUnable to provide the data file, as it contains data that we cannot distribute, but if there is more info I can collect, happy to do so."}, {"count": 1, "tags": [], "text": "Can you re-test with a recent 3.5 nightly and see if it's fixed there or not?\n\nHowever, the stack trace does look like your file might be corrupt, or it's possible that the continue record is further from the original record than we expect it to be. Best to know if it's fixed first though", "attachment_id": null, "bug_id": 46892, "id": 125706, "time": "2009-03-23T08:16:01Z", "creator": "apache@gagravarr.org", "creation_time": "2009-03-23T08:16:01Z", "is_private": false}, {"count": 2, "tags": [], "creator": "nick.giles@ontology.com", "attachment_id": null, "is_private": false, "id": 125708, "time": "2009-03-23T08:36:58Z", "bug_id": 46892, "creation_time": "2009-03-23T08:36:58Z", "text": "Fails with 3.5-beta5-20090219, I can't find a link to any nightly builds on the website, would I have to download and build from source?\n\nThe file opens in Excel, OpenOffice and POI 3.2. It continues to fail to open even when I've deleted every sheet from the workbook, so it looks like it's hidden in the leftovers."}, {"count": 3, "tags": [], "creator": "nick.giles@ontology.com", "attachment_id": null, "id": 125709, "time": "2009-03-23T08:40:46Z", "bug_id": 46892, "creation_time": "2009-03-23T08:40:46Z", "is_private": false, "text": "(In reply to comment #2)\n> Fails with 3.5-beta5-20090219, I can't find a link to any nightly builds on the\n> website, would I have to download and build from source?\n> \n\nAnd if so, should I just use trunk?"}, {"count": 4, "tags": [], "creator": "yegor@dinom.ru", "is_private": false, "id": 125710, "attachment_id": null, "bug_id": 46892, "creation_time": "2009-03-23T08:50:40Z", "time": "2009-03-23T08:50:40Z", "text": "Daily builds can be downlaoded from http://encore.torchbox.com/poi-svn-build/\n\nYou say you can reproduce the trouble even if you delete all sheets from the workbook. Can you attach the leftovers? \n\nYegor"}, {"count": 5, "tags": [], "text": "It is fixed in poi-3.5-beta6-20090323.jar. A quick test suggests it was actually fixed in poi-3.5-beta6-20090212.jar (poi-3.5-beta6-20090211.jar fails).\n\nI was wrong about being able to reproduce with no sheets though, that was me not hitting refresh in Eclipse enough when testing...\n\nThanks, I'll probably wait for beta 6 then.", "attachment_id": null, "bug_id": 46892, "id": 125713, "time": "2009-03-23T09:22:57Z", "creator": "nick.giles@ontology.com", "creation_time": "2009-03-23T09:22:57Z", "is_private": false}, {"count": 6, "tags": [], "creator": "josh@apache.org", "is_private": false, "id": 125722, "attachment_id": null, "bug_id": 46892, "creation_time": "2009-03-23T14:33:58Z", "time": "2009-03-23T14:33:58Z", "text": "This bug is a duplicate of bug 46693\nIt's often a good idea to first try searching for existing reports of the same bug, for example:\nhttp://www.google.com/search?q=\"Expected+to+find+a+ContinueRecord+in+order+to+read+remaining+65535+of+65535+chars\"\n\n*** This bug has been marked as a duplicate of bug 46693 ***"}]