[{"count": 0, "tags": [], "creator": "michal@rulez.pl", "attachment_id": null, "text": "Dear All,\n\nI'm trying to compile an httpd-2.3.0-dev with mod_auth_form and SSL. It uses mod_session_*. During compilation I see there is a problem with some include files from apr and apr-util (no matter - last stable release - at time of writing both have version 1.3.2). \n\nBut from the beginning. \n\n1) I use ./buildconf to create all necessary configure files. \nhttpd was taken from svn.apache.org using following command :\n\nsvn co http://svn.apache.org/repos/asf/httpd/httpd/trunk httpd-trunk \nIts SVN revision is 681340. \n\nI don't have separate apr and apr-utils, so I've put them into httpd-trunk/srclib/apr and httpd-trunk/srclib/apr-util - apr and apr-util taken from SVN (or taken from stabsvn co le release (at time of writing - 1.3.2) - no matter, which source it is. \n\nLet's say, we are using current versions from SVN :\nsvn co http://svn.apache.org/repos/asf/apr/apr/trunk srclib/apr\nIts revision is 681340\n\nsvn co http://svn.apache.org/repos/asf/apr/apr/trunk srclib/apr\n\nconfigure phase works ok. \nMy configure line is : \n./configure --prefix=/usr/local/apache23-new --enable-http --enable-info --enable-authn-dbd --enable-authz-dbd --enable-dbd --enable-cache --enable-disk-cache --enable-mem-cache --enable-charset-lite --enable-proxy --enable-proxy-ajp --enable-ssl --enable-vhost-alias --enable-so --enable-rewrite --enable-speling --enable-mods-shared=all --with-included-apr --with-pgsql=/usr/local --enable-session --enable-session-crypto --enable-session-cookie --enable-session-dbd\n\nDuring make phase I see following error : \n\nmod_session_crypto.c:20:66: apr_ssl.h: No such file or directory\nmod_session_crypto.c:60: error: syntax error before \"apr_evp_factory_t\"\nmod_session_crypto.c: In function `crypt_init':\nmod_session_crypto.c:64: error: `conf' undeclared (first use in this function)\nmod_session_crypto.c:64: error: (Each undeclared identifier is reported only once\nmod_session_crypto.c:64: error: for each function it appears in.)\nmod_session_crypto.c:65: error: `r' undeclared (first use in this function)\nmod_session_crypto.c:73: error: `key' undeclared (first use in this function)\nmod_session_crypto.c:73: error: `APR_EVP_KEY_PUBLIC' undeclared (first use in this function)\nmod_session_crypto.c:74: error: `f' undeclared (first use in this function)\nmod_session_crypto.c:76: error: `APR_EVP_FACTORY_ASYM' undeclared (first use in this function)\nmod_session_crypto.c:84: error: `APR_EVP_KEY_SYM' undeclared (first use in this function)\nmod_session_crypto.c:87: error: `APR_EVP_FACTORY_SYM' undeclared (first use in this function)\nmod_session_crypto.c: In function `encrypt_string':\nmod_session_crypto.c:133: error: `apr_evp_factory_t' undeclared (first use in this function)\nmod_session_crypto.c:133: error: `f' undeclared (first use in this function)\nmod_session_crypto.c:134: error: `apr_evp_crypt_t' undeclared (first use in this function)\nmod_session_crypto.c:134: error: `e' undeclared (first use in this function)\nmod_session_crypto.c:135: error: syntax error before \"key\"\nmod_session_crypto.c:148: error: `key' undeclared (first use in this function)\nmod_session_crypto.c:153: error: `APR_EVP_ENCRYPT' undeclared (first use in this function)\nmod_session_crypto.c: In function `decrypt_string':\nmod_session_crypto.c:208: error: `apr_evp_factory_t' undeclared (first use in this function)\nmod_session_crypto.c:208: error: `f' undeclared (first use in this function)\nmod_session_crypto.c:209: error: `apr_evp_crypt_t' undeclared (first use in this function)\nmod_session_crypto.c:209: error: `e' undeclared (first use in this function)\nmod_session_crypto.c:210: error: syntax error before \"key\"\nmod_session_crypto.c:216: error: `key' undeclared (first use in this function)\nmod_session_crypto.c:221: error: `APR_EVP_DECRYPT' undeclared (first use in this function)\n*** Error code 1\n\nIt seems, there is a lack of apr_ssl.h in current release. I was searching previous SVN releases and it looks like this file was removed around 40000 revisions ago. Old file taken from older of apr releases of apr cause httpd to compile, but there are some symbol errors hard to reproduce in this bug report.\n\nSincerely,\n\nMichal Zapalski", "id": 119178, "time": "2008-07-31T05:14:21Z", "bug_id": 45515, "creation_time": "2008-07-31T05:14:21Z", "is_private": false}, {"count": 1, "tags": [], "text": "You need to use APR-UTIL from here: http://svn.eu.apache.org/viewvc/apr/apr-util/branches/ssl-evp/\nAs you already mentioned SSL support was removed from APR-UTIL trunk and moved to a branch. I am not sure if this branch is currently aligned with trunk. So you may need to backport trunk changes to this branch first before you can use them.", "is_private": false, "bug_id": 45515, "id": 119184, "time": "2008-07-31T08:17:46Z", "creator": "rpluem@apache.org", "creation_time": "2008-07-31T08:17:46Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 45515, "text": "> I am not sure if this branch is currently aligned with trunk.\n\nI don't think so.", "id": 119334, "time": "2008-08-03T23:54:52Z", "creator": "bojan@rexursive.com", "creation_time": "2008-08-03T23:54:52Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 45515, "text": "Not really a bug, so closing as such.", "id": 119699, "time": "2008-08-11T22:47:47Z", "creator": "bojan@rexursive.com", "creation_time": "2008-08-11T22:47:47Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 45515, "text": "apr-util is not responsible for adding this feature, it will be voted on for\ninclusion or rejected based on many criteria, some of which it fails today.\n\nSo since this feature is not guarenteed, mod_session's authors may need to\nconsider refactoring to rely upon mod_ssl, and if that is not possible, back\nto mod_ssl directly. \n\nIn any case, httpd/trunk does not compile with this module enabled using any\nASF-apr released code, and therefore the bug remains, and remains at httpd.", "id": 119728, "time": "2008-08-12T09:35:40Z", "creator": "wrowe@apache.org", "creation_time": "2008-08-12T09:35:40Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 45515, "attachment_id": null, "text": "Further correct bug assignment", "id": 119729, "time": "2008-08-12T09:36:11Z", "creator": "wrowe@apache.org", "creation_time": "2008-08-12T09:36:11Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 45515, "text": "Created attachment 23935\nup-to-date config.log for the failure\n\nReproduced the problem with latest (2009-07-07) dev snapshot of httpd/apr/apr-util, attached resulting config.log. IMO \"gcc: no input files\" at line 930 looks suspicious (I'm not knowledgeable though):\n\nconfigure:19305: checking whether to enable mod_session_crypto\nconfigure:19341: result: checking dependencies\nconfigure:19361: checking apr_crypto.h usability\nconfigure:19378: gcc -c  -g -O2 -pthread  -DLINUX=2 -D_REENTRANT -D_GNU_SOURCE -D_LARGEFILE64_SOURCE -I/tmp/wrk/apache/httpd/srclib/apr/include -I conftest.c >&5\ngcc: no input files", "id": 128588, "time": "2009-07-07T05:08:09Z", "creator": "alexey.v.varlamov@gmail.com", "creation_time": "2009-07-07T05:08:09Z", "is_private": false, "attachment_id": 23935}, {"attachment_id": null, "tags": [], "creator": "alexey.v.varlamov@gmail.com", "is_private": false, "count": 7, "id": 128621, "time": "2009-07-07T21:05:31Z", "bug_id": 45515, "creation_time": "2009-07-07T21:05:31Z", "text": "FYI, finally I was able to build the session-crypto (from trunk) with the following steps:\n1) Configure httpd with 2 additional keys (--with-crypto --with-openssl) but DO NOT enable session-crypto yet, like:\n./configure --with-ssl --with-crypto --with-openssl --enable-modules=\"so session\"\n2) make;make install\n3) Build & install the mod-session separately:\napxs -c -i -a mod_session_crypto.c\n\nSo the trick was to build APR with crypto API enabled and to circumvent the bug in configure. Additional problem was that the needed keys are not documented anywhere.\n\nHope my store will help you fixing this."}, {"count": 8, "tags": [], "creator": "minfrin@sharp.fm", "is_private": false, "text": "This was raised in 2008, assuming that any outstanding issues are fixed by now. If not, please reopen.", "id": 170594, "time": "2013-10-13T13:35:25Z", "bug_id": 45515, "creation_time": "2013-10-13T13:35:25Z", "attachment_id": null}]