[{"count": 0, "attachment_id": null, "creator": "dribagnac@bigfoot.com", "text": "I had an exception (Javadoc failed: java.io.IOException: CreateProcess) when \nI run my Doclet task on Windows XP. The fact is : my classpath is very long and \nWindows' shell can not handle it.\n   The 'useExternalFile' flag is set to true but it does not affect the \nclasspath's variable.\n   So I modify javadoc.java with the following code, is it possible to include \nit within a new release of Ant ?\n\n\n----------------------------------------------\n        File tmpList = null;\n        File optionsTmpList = null;\n        PrintWriter srcListWriter = null;\n        PrintWriter optionsListWriter = null;\n        try {\n\n            /**\n             * Write sourcefiles and package names to a temporary file\n             * if requested.\n             */\n            // Code added\n            // Write all options to a file             \n            if (useExternalFile) {\n                if (optionsTmpList == null) {\n                \toptionsTmpList = fileUtils.createTempFile\n(\"javadocOptions\", \"\", null);\n                \toptionsTmpList.deleteOnExit();\n                \t\n                \tString[] listOpt = toExecute.getArguments();\n                \ttoExecute.clearArgs();\n                    toExecute.createArgument()\n                        .setValue(\"@\" + optionsTmpList.getAbsolutePath());\n                    \n                    optionsListWriter = new PrintWriter(\n                            new FileWriter(optionsTmpList.getAbsolutePath(),\n                                           true));\n                    \n                    for (int i = 0; i < listOpt.length; i++) {\n\t\t\t\t\t\tString string = listOpt[i];\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (string.startsWith(\"-J-\")) {\n\t\t\t\t\t\t\ttoExecute.createArgument\n().setValue(string);\n\t\t\t\t\t\t} else  {\n\t\t\t\t\t\t\tif (string.startsWith(\"-\n\")) {\n\t\t\t\t\t\t\t\n\toptionsListWriter.println();\n\t\t\t\t\t\t\t\n\toptionsListWriter.print(string);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\n\toptionsListWriter.print(string);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\toptionsListWriter.print\n(\" \");\n\t\t\t\t\t\t}\n\t\t\t\t\t}                   \n                }\n                // End of added code\n                \n                if (tmpList == null) {\n                    tmpList = fileUtils.createTempFile(\"javadoc\", \"\", null);\n                    tmpList.deleteOnExit();\n                    toExecute.createArgument()\n                        .setValue(\"@\" + tmpList.getAbsolutePath());\n                }\n\n\n...\n\n\n\n\n        } finally {\n            if (srcListWriter != null) {\n                srcListWriter.close();\n            }\n            \n            // Added code\n            if (optionsListWriter != null) {\n                optionsListWriter.close();\n            }\n        }", "id": 95254, "time": "2006-10-31T08:24:57Z", "bug_id": 40852, "creation_time": "2006-10-31T08:24:57Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "peterreilly@apache.org", "text": "Just a couple of problems.\n1) the optionsListWriter is not closed/flushed, so the file\n   is not completed\n2) the code does not handle spaces in directory names\n3) if the paths have \\ and they are in quoted strings, javadoc does not\n   like them\n4) the patch should be provided as a diff agaist the\n   current svn version of ant (using svn diff command)\n5) the manual doc for javadoc would need to updated to describe\n   new behaviour of useExternalFile\n\nHowever, I think that this is a good idea,\nI do not know if it can get into Ant 1.7.0.\n\n\n", "id": 95259, "attachment_id": null, "bug_id": 40852, "creation_time": "2006-10-31T09:25:01Z", "time": "2006-10-31T09:25:01Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 40852, "text": "Created attachment 19060\npatch containing mods to javadoc\n\nThis patch should take care of the problems\ndescribed in #2, except for the update to\nthe manual", "id": 95260, "time": "2006-10-31T09:27:40Z", "creator": "peterreilly@apache.org", "creation_time": "2006-10-31T09:27:40Z", "is_private": false, "attachment_id": 19060}, {"count": 3, "tags": [], "creator": "peterreilly@apache.org", "attachment_id": null, "is_private": false, "id": 95261, "time": "2006-10-31T09:34:30Z", "bug_id": 40852, "creation_time": "2006-10-31T09:34:30Z", "text": "There is already a request for this:\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=26739\nSome code needs to be added to support jdk 1.3.\n"}, {"count": 4, "tags": [], "bug_id": 40852, "text": "Created attachment 19064\npatch for Ant 165\n\nI used CVS diff (diff -u -p) as I do not own svn at the office.\nThe patch is against the source code given with Ant 165 distrib. Seems to be\nrevision 278386\n(http://svn.apache.org/viewvc/ant/core/branches/ANT_16_BRANCH/src/main/org/apache/tools/ant/taskdefs/Javadoc.java?view=log)\n\nI add your code that test directory names.\nAnd finally this improvment is active only for JDK1.4+, even if JDK1.3 seems to\nwork correctly with it", "id": 95292, "time": "2006-11-01T06:56:05Z", "creator": "dribagnac@bigfoot.com", "creation_time": "2006-11-01T06:56:05Z", "is_private": false, "attachment_id": 19064}, {"count": 5, "tags": [], "bug_id": 40852, "text": "Created attachment 19067\nnew quoting\n\nNew patch, change the quoting to handle\nstuff like:\n<bottom><![CDATA[<i>Copyright &#169; 2000 \"Dummy Corp\".\n'\\hello'Reserved.</i>]]></bottom>\nalso incoperate javadoc4 test and handle exceptions\nwhen writing the options file.", "id": 95304, "time": "2006-11-01T11:09:36Z", "creator": "peterreilly@apache.org", "creation_time": "2006-11-01T11:09:36Z", "is_private": false, "attachment_id": 19067}, {"count": 6, "tags": [], "creator": "peterreilly@apache.org", "text": "commited the change, should be in ant 1.7.0.", "id": 95312, "attachment_id": null, "bug_id": 40852, "creation_time": "2006-11-01T15:19:50Z", "time": "2006-11-01T15:19:50Z", "is_private": false}]