[{"attachment_id": null, "tags": [], "creator": "asthanpati@corbus.com", "text": "HI All,\n\nPOI Version used : 3.8 Stable and poi-3.9-beta1-20120422, poi-3.9-beta1-20120628 (POI nightly builds from Jenkins)\n\nBelow is the sample code.\n\nSXSSFWorkbook workbook = new SXSSFWorkbook(50);\nworkbook.setCompressTempFiles(true);\nSXSSFSheet  worksheet=null;\nString header = \"\";\nCellStyle cellStyle = workbook.createCellStyle();\nFont font = workbook.createFont();\nFont fontd = workbook.createFont();\nArrayList rowdata = null;\nString data = \"\";\nSXSSFCell cell=null;\nCellStyle cellStyle1=null;\nSXSSFRow row=null;\n\n\t\t    \t\t\ncellStyle.setFillForegroundColor(IndexedColors.ROYAL_BLUE.index);\ncellStyle.setFillPattern(CellStyle.SOLID_FOREGROUND);\nfont.setBoldweight(Font.BOLDWEIGHT_BOLD);\nfont.setColor(IndexedColors.WHITE.index);\nfont.setFontHeightInPoints((short)10);\nfont.setFontName(\"Arial\");\ncellStyle.setFont(font);\n\nfontd.setColor(IndexedColors.BLACK.index);\nfontd.setFontHeightInPoints((short)10);\nfontd.setFontName(\"Arial\");\n\nSystem.out.println(\"Matrix Report noofrows::\"+noofrows);\nfor(long i = 0,rowNo=1 ; i < noofrows;i++,rowNo++){\n\nworksheet = (SXSSFSheet) workbook.createSheet(\"Matrix Report \"+sheetNo);\n\nrow = (SXSSFRow) worksheet.createRow(0);\n\nfor(int hl=0; hl<headerLength; hl++){\ncell = (SXSSFCell) row.createCell(hl);\nheader = (String)matrixReportHeader.get(hl);\ncell.setCellValue(header);\ncell.setCellStyle(cellStyle);\ncell=null;\n}\n\nrow = (SXSSFRow) worksheet.createRow((int)rowNo);\n\nrowdata = (ArrayList)matrixReportdata.get((int)i);\n\ncellStyle1 = workbook.createCellStyle();\n\nif(rowNo%2 != 0){\ncellStyle1.setFillForegroundColor(IndexedColors.LIGHT_CORNFLOWER_BLUE.index);\ncellStyle1.setFillPattern(CellStyle.SOLID_FOREGROUND);\n}\n\ncellStyle1.setFont(fontd);\n\nfor(int j=0; j<rowdata.size(); j++){\n\ncell = (SXSSFCell) row.createCell(j);\ndata = (String)rowdata.get(j);\n\nif(data==null) data=\"\";\ncell.setCellValue(data);\t\t\t\t\t\t\t\t\ncell.setCellStyle(cellStyle1);\n}\n}", "count": 0, "id": 160473, "time": "2012-07-06T12:09:04Z", "bug_id": 53514, "creation_time": "2012-07-06T12:09:04Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "yegor@dinom.ru", "text": "\nCurrent code is invalid, it repeatedly inserts the header row in a loop and this is why you see a blank row in the output. Move creation of the header row outside of the main loop and you will be good.", "count": 1, "id": 160665, "time": "2012-07-16T08:14:03Z", "bug_id": 53514, "creation_time": "2012-07-16T08:14:03Z", "is_private": false}, {"count": 2, "tags": [], "creator": "asthanpati@corbus.com", "text": "Hi Yegor Kozlov,\n\nI have put the header row inside main loop because. In my case no of row is more than what xlsx can support. I am checking if it more than xlsx can support then create a new worksheet and then continue writing the cell value.", "id": 160666, "attachment_id": null, "bug_id": 53514, "creation_time": "2012-07-16T09:03:55Z", "time": "2012-07-16T09:03:55Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "asthanpati@corbus.com", "text": "here is the actual code...\n\n\nint sheetNo=1;\nif(rowNo==1048575)\n{\nrowNo=1;\nsheetNo++;\n}\t\t\nif(rowNo==1)\n{\nworksheet = (SXSSFSheet) workbook.createSheet(\"Matrix Report \"+sheetNo);\nrow = (SXSSFRow) worksheet.createRow(0);\nfor(int hl=0; hl<headerLength; hl++){\ncell = (SXSSFCell) row.createCell(hl);\nheader = (String)matrixReportHeader.get(hl);\ncell.setCellValue(header);\ncell.setCellStyle(cellStyle);\n}\n}\n\ni need to create the header in the next worksheet also, that why header is in the main loop.", "count": 3, "id": 160667, "time": "2012-07-16T09:08:20Z", "bug_id": 53514, "creation_time": "2012-07-16T09:08:20Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 53514, "is_private": false, "text": "please post the full Java code that I can run and see the problem. I still think the problem is in your code but without a working example it is hard to tell where the problem is.", "id": 160668, "time": "2012-07-16T09:20:30Z", "creator": "yegor@dinom.ru", "creation_time": "2012-07-16T09:20:30Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 53514, "is_private": false, "text": "Here is the full code that i am using..\n\ntry {\n\n\t\n\tint headerLength = 15;\n\tint noofrows = 2048575;\n\t\n\n\tSXSSFWorkbook workbook = new SXSSFWorkbook(50);\n\tworkbook.setCompressTempFiles(true);\n\n\n\tSXSSFSheet  worksheet=null;\n\n\n\n\tString header = \"\";\n\tCellStyle cellStyle = workbook.createCellStyle();\n\n\tFont font = workbook.createFont();\n\tFont fontd = workbook.createFont();\n\t\n\tString data = \"\";\n\n\tSXSSFCell cell=null;\n\tCellStyle cellStyle1=null;\n\n\tSXSSFRow row=null;\n\tint sheetNo=1;\n\n\tcellStyle.setFillForegroundColor(IndexedColors.ROYAL_BLUE.index);\n\tcellStyle.setFillPattern(CellStyle.SOLID_FOREGROUND);\n\tfont.setBoldweight(Font.BOLDWEIGHT_BOLD);\n\tfont.setColor(IndexedColors.WHITE.index);\n\tfont.setFontHeightInPoints((short)10);\n\tfont.setFontName(\"Arial\");\n\tcellStyle.setFont(font);\n\n\tfontd.setColor(IndexedColors.BLACK.index);\n\tfontd.setFontHeightInPoints((short)10);\n\tfontd.setFontName(\"Arial\");\n\n\tSystem.out.println(\"Matrix Report noofrows::\"+noofrows);\n\tfor(long i = 0,rowNo=1 ; i < noofrows;i++,rowNo++){\n\n\tif(rowNo==1048575)\n\t{\n\trowNo=1;\n\tsheetNo++;\n\t}\t\n\tif(rowNo==1)\n\t{\n\tworksheet = (SXSSFSheet) workbook.createSheet(\"Matrix Report \"+sheetNo);\n\n\trow = (SXSSFRow) worksheet.createRow(0);\n\n\tfor(int hl=0; hl<headerLength; hl++){\n\tcell = (SXSSFCell) row.createCell(hl);\n\theader = hl+\"\";\n\tcell.setCellValue(header);\n\tcell.setCellStyle(cellStyle);\n\t\n\tcell=null;\n\t}\n\t}\n\n\trow = (SXSSFRow) worksheet.createRow((int)rowNo);\n\n\t\n\n\tcellStyle1 = workbook.createCellStyle();\n\n\tif(rowNo%2 != 0){\n\tcellStyle1.setFillForegroundColor(IndexedColors.LIGHT_CORNFLOWER_BLUE.index);\n\tcellStyle1.setFillPattern(CellStyle.SOLID_FOREGROUND);\n\t}\n\n\tcellStyle1.setFont(fontd);\n\n\tfor(int j=0; j<headerLength; j++){\n\n\tcell = (SXSSFCell) row.createCell(j);\n\tdata = j+\"\";\n\n\tif(data==null) data=\"\";\n\n\ttry{\n\tcell.setCellValue(Long.parseLong(data));\n\t}catch(NumberFormatException e){\n\ttry{\n\tcell.setCellValue(Double.parseDouble(data));\n\t}catch(NumberFormatException ee){\n\tcell.setCellValue(data);\n\t}catch(NullPointerException ee){\n\tcell.setCellValue(data);\n\t}\n\t}catch(NullPointerException e){\n\tcell.setCellValue(data);\t\t\t\t\t\t\t\t\n\t}\n\n\tcell.setCellStyle(cellStyle1);\n\t\n\tcell=null;\n\tdata=null;\n\t}\n\tcellStyle1=null;\n\trow=null;\n\t\n\t}\n\n\tFileOutputStream fileOut = new FileOutputStream(\"MatrixReport.xlsx\");\n\tworkbook.write(fileOut);\n\tfileOut.close();\n\t\n\t}catch(Exception e)\n\t{\n\t\te.printStackTrace();\n\t}", "id": 160669, "time": "2012-07-16T10:09:22Z", "creator": "asthanpati@corbus.com", "creation_time": "2012-07-16T10:09:22Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 53514, "is_private": false, "text": "Any update...??", "id": 160685, "time": "2012-07-17T09:23:30Z", "creator": "asthanpati@corbus.com", "creation_time": "2012-07-17T09:23:30Z", "attachment_id": null}, {"count": 7, "tags": [], "creator": "apache@gagravarr.org", "text": "Everyone involved in Apache POI is here as a volunteer, and works on problems on a best-effort basis. All software from the ASF is free! If your business needs quick responses, you should look into paying someone for a support contract...", "id": 160689, "attachment_id": null, "bug_id": 53514, "creation_time": "2012-07-17T09:42:45Z", "time": "2012-07-17T09:42:45Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 53514, "is_private": false, "text": "You are creating a cell style per row and this is wrong, see http://poi.apache.org/faq.html#faq-N100EF\n\nMove creation of cell style outside of the loop and define two styles for odd and even rows. Below is my modification of your code that works properly:  \n\n       try {\n\n\n            int headerLength = 15;\n            int noofrows = 48575;\n\n\n            SXSSFWorkbook workbook = new SXSSFWorkbook(50);\n            workbook.setCompressTempFiles(true);\n\n\n            SXSSFSheet worksheet = null;\n\n\n            String header = \"\";\n            CellStyle cellStyle = workbook.createCellStyle();\n\n            Font font = workbook.createFont();\n            Font fontd = workbook.createFont();\n\n            String data = \"\";\n\n            SXSSFCell cell = null;\n            CellStyle cellStyle1 = null;\n            CellStyle cellStyle2 = null;\n\n            SXSSFRow row = null;\n            int sheetNo = 1;\n\n            cellStyle.setFillForegroundColor(IndexedColors.ROYAL_BLUE.index);\n            cellStyle.setFillPattern(CellStyle.SOLID_FOREGROUND);\n            font.setBoldweight(Font.BOLDWEIGHT_BOLD);\n            font.setColor(IndexedColors.WHITE.index);\n            font.setFontHeightInPoints((short) 10);\n            font.setFontName(\"Arial\");\n            cellStyle.setFont(font);\n\n            fontd.setColor(IndexedColors.BLACK.index);\n            fontd.setFontHeightInPoints((short) 10);\n            fontd.setFontName(\"Arial\");\n\n\n            cellStyle1 = workbook.createCellStyle();\n            cellStyle1.setFillForegroundColor(IndexedColors.LIGHT_CORNFLOWER_BLUE.index);\n            cellStyle1.setFillPattern(CellStyle.SOLID_FOREGROUND);\n            cellStyle1.setFont(fontd);\n\n            cellStyle2 = workbook.createCellStyle();\n            cellStyle2.setFont(fontd);\n\n            System.out.println(\"Matrix Report noofrows::\" + noofrows);\n            for (long i = 0, rowNo = 1; i < noofrows; i++, rowNo++) {\n\n                if (rowNo == 1048575) {\n                    rowNo = 1;\n                    sheetNo++;\n                }\n                if (rowNo == 1) {\n                    worksheet = (SXSSFSheet) workbook.createSheet(\"Matrix Report \" + sheetNo);\n\n                    row = (SXSSFRow) worksheet.createRow(0);\n\n                    for (int hl = 0; hl < headerLength; hl++) {\n                        cell = (SXSSFCell) row.createCell(hl);\n                        header = hl + \"\";\n                        cell.setCellValue(header);\n                        cell.setCellStyle(cellStyle);\n\n                        cell = null;\n                    }\n                }\n\n                row = (SXSSFRow) worksheet.createRow((int) rowNo);\n\n\n\n                for (int j = 0; j < headerLength; j++) {\n\n                    cell = (SXSSFCell) row.createCell(j);\n                    data = j + \"\";\n\n                    if (data == null) data = \"\";\n\n                    try {\n                        cell.setCellValue(Long.parseLong(data));\n                    } catch (NumberFormatException e) {\n                        try {\n                            cell.setCellValue(Double.parseDouble(data));\n                        } catch (NumberFormatException ee) {\n                            cell.setCellValue(data);\n                        } catch (NullPointerException ee) {\n                            cell.setCellValue(data);\n                        }\n                    } catch (NullPointerException e) {\n                        cell.setCellValue(data);\n                    }\n\n                    cell.setCellStyle(rowNo%2 != 0 ? cellStyle1 : cellStyle2);\n\n                }\n            }\n\n            FileOutputStream fileOut = new FileOutputStream(\"MatrixReport.xlsx\");\n            workbook.write(fileOut);\n            fileOut.close();\n\n        } catch (Exception e) {\n            e.printStackTrace();\n        }", "id": 160691, "time": "2012-07-17T10:20:43Z", "creator": "yegor@dinom.ru", "creation_time": "2012-07-17T10:20:43Z", "attachment_id": null}]