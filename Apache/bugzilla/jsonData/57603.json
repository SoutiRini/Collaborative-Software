[{"count": 0, "tags": [], "bug_id": 57603, "attachment_id": 32498, "is_private": false, "id": 181181, "time": "2015-02-19T18:10:23Z", "creator": "srmiranda@gmail.com", "creation_time": "2015-02-19T18:10:23Z", "text": "Created attachment 32498\nTest program and word documents\n\nWhen HWPFDocument reads a Word document (.doc 2003) with six columns, writes a new document without problem. If Word document has seven or more columns, the write process creates a corrupt document, that MSWord can't read it."}, {"count": 1, "tags": [], "text": "Created attachment 33408\nEmpty document with a seven column table\n\nThis bug is also occurring with the latest Apache POI 3.14-beta1 on an empty document that is written without modifications.\n\nTo reproduce, you only need to open the attached file and write it back :\n        HWPFDocument doc = new HWPFDocument(new FileInputStream(inFile));\n        FileOutputStream fos = new FileOutputStream(outFile);\n        doc.write(fos);\n        fos.close();\n\nWord then displays an error when the output file is opened.", "attachment_id": 33408, "id": 187397, "creator": "thomas.schwery@gmail.com", "time": "2016-01-05T16:31:42Z", "bug_id": 57603, "creation_time": "2016-01-05T16:31:42Z", "is_private": false}, {"count": 2, "tags": [], "text": "After doing some additional tests, it seems that writing such a file and opening it again leads to an Exception. Here is a small testcase that reproduce the error using the previously attached document :\n\n    public void testSevenRowTable() throws Exception\n    {\n        HWPFDocument hwpfDocument = new HWPFDocument( POIDataSamples\n                .getDocumentInstance().openResourceAsStream( \"Bug57603-sevencolumns.doc\" ) );\n\n        ByteArrayOutputStream out = new ByteArrayOutputStream();\n        hwpfDocument.write(out);\n        out.close();\n\n        HWPFDocument hwpfDocument2 = new HWPFDocument(new ByteArrayInputStream(out.toByteArray()));\n    }", "is_private": false, "id": 187823, "creator": "thomas.schwery@gmail.com", "time": "2016-01-19T12:16:16Z", "bug_id": 57603, "creation_time": "2016-01-19T12:16:16Z", "attachment_id": null}, {"count": 3, "attachment_id": null, "creator": "dominik.stadler@gmx.at", "text": "I have added a disabled unit-test for this via r1753120.", "id": 192463, "time": "2016-07-17T21:18:34Z", "bug_id": 57603, "creation_time": "2016-07-17T21:18:34Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 57603, "text": "*** Bug 55541 has been marked as a duplicate of this bug. ***", "id": 192653, "time": "2016-07-26T13:03:41Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-07-26T13:03:41Z", "is_private": false, "attachment_id": null}]