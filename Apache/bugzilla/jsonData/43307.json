[{"count": 0, "tags": [], "bug_id": 43307, "text": "Despite how the previous bug report was closed, this is still unresolved in the \npublic release of 0.94.  If the user mistaken types in \"text-weight\" instead \nof \"font-weight\", FOP reports a generic error (included below) that does not \nelude to the words text-weight or a line number in which to find the problem.\n\nI redownloaded FOP, again, just to be sure FOP was the latest release version.  \nI picked up:\nfop-0.94-bin-jdk1.4.zip              23-Aug-2007 16:55   19M  \n\n\nusing command: fop -xsl temp.xsl -xml temp.xml -pdf output.pdf\n\nMy entire XSL file: (with the previous erroneous data text-weight=\"bold\")\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" \nxmlns:fo=\"http://www.w3.org/1999/XSL/Format\" \nxmlns:java=\"http://xml.apache.org/xslt/java\" >\n<xsl:template match=\"/\">\n<fo:root>\n        <fo:layout-master-set>\n        <fo:simple-page-master margin-right=\".5in\" margin-left=\".5in\" margin-\nbottom=\".25in\" margin-top=\".5in\" page-width=\"8.5in\" page-height=\"11in\" master-\nname=\"Simple\">\n         <fo:region-body margin-top=\"0cm\"/>\t\t\t\n         <fo:region-before extent=\"1.5cm\"/>\n         <fo:region-after extent=\"1cm\"/>\n       </fo:simple-page-master>\n     </fo:layout-master-set>\n     <fo:page-sequence master-reference=\"Simple\" initial-page-number=\"1\" force-\npage-count=\"no-force\">\n     <fo:flow flow-name=\"xsl-region-body\">\n     <!-- ===========FO CODE STARTS =============== -->\n     <fo:block/>\n     <fo:block text-weight=\"bold\">\n     $ \n     </fo:block>\n\n     <!-- ===========FO CODE ENDS ================= -->\n     </fo:flow>\n  </fo:page-sequence>\n</fo:root>\n</xsl:template>\n</xsl:stylesheet>\n\nXML File:\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<?xml-stylesheet type=\"text/xsl\" href=\"temp.xsl\"?>\n<vars>\n   <appid>123456</appid>\n</vars>\n\n\nWhat fop reported as the error.  Read carefully, there is no mention of text-\nweight:\n--- Standard Error ---\nSep 4, 2007 12:15:24 PM org.apache.fop.fo.FOTreeBuilder$MainFOHandler endElement\nWARNING: Mismatch: flow (http://www.w3.org/1999/XSL/Format) vs. block \n(http://www.w3.org/1999/XSL/Format)\nSep 4, 2007 12:15:24 PM org.apache.fop.fo.FOTreeBuilder$MainFOHandler endElement\nWARNING: Mismatch: page-sequence (http://www.w3.org/1999/XSL/Format) vs. flow \n(http://www.w3.org/1999/XSL/Format)\nSep 4, 2007 12:15:24 PM org.apache.fop.fo.FOTreeBuilder$MainFOHandler endElement\nWARNING: Mismatch: root (http://www.w3.org/1999/XSL/Format) vs. page-sequence \n(http://www.w3.org/1999/XSL/Format)\nSep 4, 2007 12:15:24 PM org.apache.fop.fo.FOTreeBuilder fatalError\nSEVERE: javax.xml.transform.TransformerException: \njava.lang.IllegalStateException: endElement() called for fo:root where there is \nno current element.\nSep 4, 2007 12:15:24 PM org.apache.fop.cli.Main startFOP\nSEVERE: Exception\njavax.xml.transform.TransformerException: java.lang.IllegalStateException: \nendElement() called for fo:root where there is no current element.\n\tat org.apache.fop.cli.InputHandler.transformTo(InputHandler.java:168)\n\tat org.apache.fop.cli.InputHandler.renderTo(InputHandler.java:115)\n\tat org.apache.fop.cli.Main.startFOP(Main.java:160)\n\tat org.apache.fop.cli.Main.main(Main.java:191)\n\n---------\n\n; SystemID: file:/C:/DocPrep/temp.xsl; Line#: 4; Column#: 10\njavax.xml.transform.TransformerException: java.lang.IllegalStateException: \nendElement() called for fo:root where there is no current element.\n\tat org.apache.xalan.transformer.TransformerImpl.executeChildTemplates\n(TransformerImpl.java:2416)\n\tat org.apache.xalan.transformer.TransformerImpl.applyTemplateToNode\n(TransformerImpl.java:2281)\n\tat org.apache.xalan.transformer.TransformerImpl.transformNode\n(TransformerImpl.java:1367)\n\tat org.apache.xalan.transformer.TransformerImpl.transform\n(TransformerImpl.java:709)\n\tat org.apache.xalan.transformer.TransformerImpl.transform\n(TransformerImpl.java:1284)\n\tat org.apache.xalan.transformer.TransformerImpl.transform\n(TransformerImpl.java:1262)\n\tat org.apache.fop.cli.InputHandler.transformTo(InputHandler.java:165)\n\tat org.apache.fop.cli.InputHandler.renderTo(InputHandler.java:115)\n\tat org.apache.fop.cli.Main.startFOP(Main.java:160)\n\tat org.apache.fop.cli.Main.main(Main.java:191)\nCaused by: java.lang.IllegalStateException: endElement() called for fo:root \nwhere there is no current element.\n\tat org.apache.fop.fo.FOTreeBuilder$MainFOHandler.endElement\n(FOTreeBuilder.java:368)\n\tat org.apache.fop.fo.FOTreeBuilder.endElement(FOTreeBuilder.java:194)\n\tat org.apache.xml.serializer.ToXMLSAXHandler.endElement\n(ToXMLSAXHandler.java:261)\n\tat org.apache.xalan.templates.ElemLiteralResult.execute\n(ElemLiteralResult.java:1399)\n\tat org.apache.xalan.transformer.TransformerImpl.executeChildTemplates\n(TransformerImpl.java:2411)\n\t... 9 more\n---------\njava.lang.IllegalStateException: endElement() called for fo:root where there is \nno current element.\n\tat org.apache.fop.fo.FOTreeBuilder$MainFOHandler.endElement\n(FOTreeBuilder.java:368)\n\tat org.apache.fop.fo.FOTreeBuilder.endElement(FOTreeBuilder.java:194)\n\tat org.apache.xml.serializer.ToXMLSAXHandler.endElement\n(ToXMLSAXHandler.java:261)\n\tat org.apache.xalan.templates.ElemLiteralResult.execute\n(ElemLiteralResult.java:1399)\n\tat org.apache.xalan.transformer.TransformerImpl.executeChildTemplates\n(TransformerImpl.java:2411)\n\tat org.apache.xalan.transformer.TransformerImpl.applyTemplateToNode\n(TransformerImpl.java:2281)\n\tat org.apache.xalan.transformer.TransformerImpl.transformNode\n(TransformerImpl.java:1367)\n\tat org.apache.xalan.transformer.TransformerImpl.transform\n(TransformerImpl.java:709)\n\tat org.apache.xalan.transformer.TransformerImpl.transform\n(TransformerImpl.java:1284)\n\tat org.apache.xalan.transformer.TransformerImpl.transform\n(TransformerImpl.java:1262)\n\tat org.apache.fop.cli.InputHandler.transformTo(InputHandler.java:165)\n\tat org.apache.fop.cli.InputHandler.renderTo(InputHandler.java:115)\n\tat org.apache.fop.cli.Main.startFOP(Main.java:160)\n\tat org.apache.fop.cli.Main.main(Main.java:191)\n\n--- Standard Output ---\n\"java\"\n\nIf there is a newer version of FOP that you are using that has fixed this \nissue, please let me know.", "id": 107708, "time": "2007-09-04T09:17:28Z", "creator": "drew.wells@clayton.net", "creation_time": "2007-09-04T09:17:28Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "drew.wells@clayton.net", "attachment_id": 20767, "is_private": false, "id": 107709, "time": "2007-09-04T09:18:51Z", "bug_id": 43307, "creation_time": "2007-09-04T09:18:51Z", "text": "Created attachment 20767\nTEMP.XSL\n\nAttached file with error of \"text-weight\" that caused the unhandled error in\nFOP."}, {"count": 2, "tags": [], "bug_id": 43307, "attachment_id": 20768, "text": "Created attachment 20768\nTEMP.XML\n\nattached XML file, used for building the fo from XSL", "id": 107710, "time": "2007-09-04T09:19:51Z", "creator": "drew.wells@clayton.net", "creation_time": "2007-09-04T09:19:51Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 43307, "attachment_id": null, "text": "\nConfirmed. The misleading error message only appears when using XML+XSL as input. If you first perform \nthe XSL transform, and run the resulting FO through FOP from the command-line, then the behavior is \ncorrect: ValidationException() on the 'text-weight' property.", "id": 107713, "time": "2007-09-04T10:00:02Z", "creator": "adelmelle@apache.org", "creation_time": "2007-09-04T10:00:02Z", "is_private": false}, {"count": 4, "tags": [], "creator": "adelmelle@apache.org", "attachment_id": null, "text": "\nDid a very quick debug session, and something very weird is going on when using XML+XSL as input. \nI placed some breakpoints in PropertyList, and noticed that convertAttributeToProperty() is called 4(!) \ntimes for the erroneous text-weight property.\n\nEverything works nicely, up until the call to FObj.attributeError(). Instead of causing a ValidationException, \nit seems the exception is swallowed by Xalan, which apparently recovers from it and happily tries to \ncontinue the transform... Have you tried a different XSLT processor?", "id": 107714, "time": "2007-09-04T10:28:51Z", "bug_id": 43307, "creation_time": "2007-09-04T10:28:51Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 43307, "is_private": false, "text": "\nYup. Looking a bit closer, could be the bug should be filed against Xalan here (2.7.0).\n\nNot a 100% sure, but instead of re-throwing the Exception, the XSLT processor seems to be triggered into \na flush (?)", "id": 107715, "time": "2007-09-04T10:46:58Z", "creator": "adelmelle@apache.org", "creation_time": "2007-09-04T10:46:58Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 43307, "attachment_id": null, "is_private": false, "id": 107717, "time": "2007-09-04T11:07:44Z", "creator": "drew.wells@clayton.net", "creation_time": "2007-09-04T11:07:44Z", "text": "I'm getting the same error in 0.93, I pulled 0.93 from \"previous fop binary\npackage\" and it registers as 0.93 under its -v (version) option.  \n\nFOP 0.20.5 ignores the error parameter entirely:\n\n[INFO] Using org.apache.xerces.parsers.SAXParser as SAX2 Parser\n[INFO] FOP 0.20.5\n[INFO] Using org.apache.xerces.parsers.SAXParser as SAX2 Parser\n[INFO] building formatting object tree\n[INFO] setting up fonts\n[ERROR] property 'text-weight' ignored\n[INFO] [1]\n[INFO] Parsing of document complete, stopping renderer"}, {"count": 7, "tags": [], "bug_id": 43307, "text": "(In reply to comment #6)\n> I'm getting the same error in 0.93, I pulled 0.93 from \"previous fop binary\n> package\" and it registers as 0.93 under its -v (version) option.  \n\nOK. What I actually meant by 'different processor', was plugging in Saxon instead of Xalan (which is \ndistributed with FOP and bundled with some JVMs).\n\n> \n> FOP 0.20.5 ignores the error parameter entirely:\n\nThis behavior can be mimicked in 0.9x by turning off strict-validation in the configuration (see: http://\nxmlgraphics.apache.org/fop/0.94/configuration.html)\n\nIt is not recommended to do so, but seems a viable option to work around this and avoid the exception \naltogether.", "id": 107719, "time": "2007-09-04T11:20:48Z", "creator": "adelmelle@apache.org", "creation_time": "2007-09-04T11:20:48Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "creator": "adelmelle@apache.org", "attachment_id": null, "text": "Did some further testing, and I am now definitely going to close this one.\n\nWhen using other versions of Xalan, the problem does not occur. We cannot do anything about this at the \nFOP side.\nTry replacing your XSLT processor to avoid the problem, or check with xalan-dev if it is a known bug and \nwhether a patch is available.", "id": 107754, "time": "2007-09-05T13:10:39Z", "bug_id": 43307, "creation_time": "2007-09-05T13:10:39Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 43307, "text": "batch transition to closed remaining pre-FOP1.0 resolved bugs", "id": 156482, "time": "2012-04-01T13:48:44Z", "creator": "gadams@apache.org", "creation_time": "2012-04-01T13:48:44Z", "is_private": false, "attachment_id": null}]