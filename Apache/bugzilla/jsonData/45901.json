[{"attachment_id": null, "tags": [], "bug_id": 45901, "is_private": false, "count": 0, "id": 121028, "time": "2008-09-26T12:26:05Z", "creator": "madan.kawle@gmail.com", "creation_time": "2008-09-26T12:26:05Z", "text": "Hello,\n\nI am generating the Cognos Reports through Java using Cognos API. While generating the reports we set the outputformat to XLWA (Microsoft Excel Web Archive (XLWA) format). The reports generated files have .xls extension.\n\nWhen I try to read this file it gives me the following error:\n\n------------------------------------------------------------------\njava.io.IOException: Invalid header signature; read 8243089445407770957, expected -2226271756974174256\n        at org.apache.poi.poifs.storage.HeaderBlockReader.<init>(HeaderBlockReader.java:112)\n        at org.apache.poi.poifs.filesystem.POIFSFileSystem.<init>(POIFSFileSystem.java:151)\n-------------------------------------------------------------------\n\nIf I open and save one of the report files in XLS format. The POI is able to read it correctly. Looks like it is unable to recognize the format. But since these reports are generated in batch mode and in huge number it is practically not possible to open and save all these reports in XLS format. Also, if I try to use SaveAs of MS-Excel, it show the SaveAs file Type to be mthml.\n\nI will appreciate if you could give me some pointers on this.\n\nThanks in advance!"}, {"count": 1, "tags": [], "text": "IIRC, mhtml = html in a specific format\n\nThe error tells you that the file isn't in ole2 format, so isn't a \"real\" excel file\n\nIf it's html, just process it with a html parser", "is_private": false, "id": 121030, "creation_time": "2008-09-26T13:01:41Z", "time": "2008-09-26T13:01:41Z", "creator": "apache@gagravarr.org", "bug_id": 45901, "attachment_id": null}]