[{"count": 0, "tags": [], "bug_id": 29986, "is_private": false, "text": "To quickly sum up my issue, I have two separate but dependent projects.  These\nprojects both <import file=\"../build-master.xml\" />.  They both call the jar\ntarget, which depends on compile, which depends on dependencies.  The idea\nbehind this process is that each project can build the projects that it depends\nupon, and that this process can be done recursively down to the foundation\nproject that depends on no other projects.\n\nThe problem is that when projectA calls the dependencies target which uses\nsubant to call the dependencies target on projectB (which projectA depends upon)\nAnt barfs with the following trace:\n\nStart Trace ---\nC:\\dev\\home\\dfaFinSys\\project\\travel_web>ant -v compile\nApache Ant version 1.6.1 compiled on February 12 2004\nBuildfile: build.xml\nDetected Java version: 1.4 in: C:\\j2sdk1.4.2_04\\jre\nDetected OS: Windows XP\nparsing buildfile C:\\dev\\home\\dfaFinSys\\project\\travel_web\\build.xml with URI =\nfile:///C:/dev/home/dfaFinSys/project/travel_web/build.xml\nProject base dir set to: C:\\dev\\home\\dfaFinSys\\project\\travel_web\n [property] Loading C:\\Documents and Settings\\Evans\\ant.properties\n [property] Unable to find property file: C:\\Documents and\nSettings\\Evans\\ant.properties\n [property] Loading C:\\dev\\home\\dfaFinSys\\project\\travel_web\\build.properties\n [property] Loading C:\\dev\\home\\dfaFinSys\\project\\build-master.properties\nImporting file ../build-master.xml from\nC:\\dev\\home\\dfaFinSys\\project\\travel_web\\build.xml\nparsing buildfile C:\\dev\\home\\dfaFinSys\\project\\build-master.xml with URI =\nfile:///C:/dev/home/dfaFinSys/project/build-master.xml\nOverriding previous definition of reference to dfa_project.dependencies\n [property] Loading Environment env.\nBuild sequence for target `compile' is [dependencies, compile]\nComplete build sequence is [dependencies, compile, setup-workspace, init, clean,\njar, war, ]\n\ndependencies:\n   [subant] calling target jar in build file\nC:\\dev\\home\\dfaFinSys\\project\\travel_web\\build.xml\nparsing buildfile C:\\dev\\home\\dfaFinSys\\project\\travel_web\\build.xml with URI =\nfile:///C:/dev/home/dfaFinSys/project/travel_web/build.xml\nProject base dir set to: C:\\dev\\home\\dfaFinSys\\project\\travel_web\n [property] Loading C:\\Documents and Settings\\Evans\\ant.properties\n [property] Unable to find property file: C:\\Documents and\nSettings\\Evans\\ant.properties\n [property] Loading C:\\dev\\home\\dfaFinSys\\project\\travel_web\\build.properties\n [property] Loading C:\\dev\\home\\dfaFinSys\\project\\build-master.properties\nImporting file ../build-master.xml from\nC:\\dev\\home\\dfaFinSys\\project\\travel_web\\build.xml\nparsing buildfile C:\\dev\\home\\dfaFinSys\\project\\build-master.xml with URI =\nfile:///C:/dev/home/dfaFinSys/project/build-master.xml\nOverriding previous definition of reference to dfa_project.dependencies\n [property] Loading Environment env.\nBuild sequence for target `jar' is [dependencies, compile, jar]\nComplete build sequence is [dependencies, compile, jar, setup-workspace, init,\nclean, war, ]\n\nBUILD FAILED\nC:\\dev\\home\\dfaFinSys\\project\\build-master.xml:145: subant task calling a target\nthat depends on its parent target 'dependencies'.\n        at org.apache.tools.ant.taskdefs.Ant.execute(Ant.java:368)\n        at org.apache.tools.ant.taskdefs.SubAnt.execute(SubAnt.java:182)\n        at org.apache.tools.ant.taskdefs.SubAnt.execute(SubAnt.java:112)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:269)\n        at org.apache.tools.ant.Task.perform(Task.java:364)\n        at org.apache.tools.ant.Target.execute(Target.java:301)\n        at org.apache.tools.ant.Target.performTasks(Target.java:328)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1215)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1063)\n        at org.apache.tools.ant.Main.runBuild(Main.java:632)\n        at org.apache.tools.ant.Main.startAnt(Main.java:183)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:197)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:56)\n\nTotal time: 1 second\nC:\\dev\\home\\dfaFinSys\\project\\travel_web>\nStop Trace ----\n\nHere's my project directory structure:\n\nprojects/\nprojects/build-master.xml\nprojects/build-master.properties\nprojects/apples/build.xml\nprojects/apples/build.properties\nprojects/apples/src/\nprojects/apples/classes/\nprojects/bananas/build.xml\nprojects/bananas/build.properties\nprojects/bananas/src/\nprojects/bananas/classes/\nprojects/oranges/build.xml\nprojects/oranges/build.properties\nprojects/oranges/src/\nprojects/oranges/classes/\n\nEach build.xml (project build file) looks like this:\n\n<project name=\"apples\" default=\"init\" basedir=\".\">\n  <patternset id=\"dfa_project.dependencies\">\n    <include name=\"oranges\" />\n  </patternset>\n  <property file=\"${user.home}/ant.properties\" />\n  <property file=\"build.properties\" />\n  <property file=\"../build-master.properties\" />\n  <import file=\"../build-master.xml\" />\n</project>\n\nbuild-master.xml defines all of the targets and sets up things like the build\nclasspath etc.  All of the projects have some level of dependency on the other\nprojects.  To handle building the project dependencies I have the following\ntarget in build-master.xml:\n\n  <!-- Build Prerequisite Projects -->\n  <target\n    name=\"dependencies\">\n\t<subant\n\t  target=\"jar\">\n\t  <dirset dir=\".\">\n\t    <patternset\n\t\t  id=\"dfa_project.dependencies\" />\n\t  </dirset>\n\t</subant>\n  </target>\n\nAnd the compile target looks like this (depends on dependencies target):\n\n  <!-- Default Source Compilation -->\n  <target name=\"compile\" depends=\"dependencies\">\n    <javac srcdir=\"${dfa_project.src}\" \n      destdir=\"${dfa_project.compile}\">\n      <classpath>\n        <path refid=\"libs.build\" />\n      </classpath>\n    </javac>\n  </target>\n\nIs there some way to get around this?  Or am I going to have to just duplicate\nthe bodies of the targets and define targets named \"apples-compile, apples-jar,\noranges-compile, oranges-jar\" etc.", "id": 60322, "time": "2004-07-08T21:36:57Z", "creator": "laran@elevasoft.com", "creation_time": "2004-07-08T21:36:57Z", "attachment_id": null}]