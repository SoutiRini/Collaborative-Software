[{"count": 0, "tags": [], "creator": "lidengni@gmail.com", "is_private": false, "text": "I am having weird unknown activities in the access log. Someone said it is\ncaused by some kind of loopback, but I have no clue how it is caused and how to\nstop the activities, which makes my access log grows very fast. \n\nI have several vhosts, and this activities only occur in the first vhost. If I\nhave both :80 and :442 (ssl) running, only the 1st ssl access log will catch\nsuch activities...\n\nI am using Fedora Core 4 latest updage. Apache is configured with \"./configure\n--enable-so --prefix=xxxxxx\"\n\nFollowing is a copy of the activities:\n\n::1 - - [19/Apr/2007:23:04:45 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:04:46 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:01 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:02 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:03 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:04 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:18 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:20 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:21 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:22 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:23 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:24 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:25 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:26 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:27 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:30 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:37 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:39 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:40 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:41 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:42 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:43 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:44 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:45 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:05:52 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:06:02 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:06:15 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:06:16 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:06:17 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:06:18 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:06:19 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:06:20 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:06:35 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:06:36 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:06:42 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:06:43 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:06:56 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:07:00 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:07:01 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:07:02 -0500] \"GET /\" 400 464\n::1 - - [19/Apr/2007:23:07:19 -0500] \"GET /\" 400 464\n...", "id": 102140, "time": "2007-04-23T11:30:11Z", "bug_id": 42200, "creation_time": "2007-04-23T11:30:11Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "basant.kukreja@sun.com", "is_private": false, "text": "Looks like \"/\" request is redirected and might be looping.\n\nIt looks like, it could be configuration issue.\n\nCan you share your configuration especially the vhost which is causing the problem?\n", "id": 102173, "time": "2007-04-23T15:17:06Z", "bug_id": 42200, "creation_time": "2007-04-23T15:17:06Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "lidengni@gmail.com", "text": "(In reply to comment #1)\n> Looks like \"/\" request is redirected and might be looping.\n> \n> It looks like, it could be configuration issue.\n> \n> Can you share your configuration especially the vhost which is causing the\nproblem?\n> \n\nhttpd-vhosts.conf looks like:\n#\n# Virtual Hosts\n#\n# If you want to maintain multiple domains/hostnames on your\n# machine you can setup VirtualHost containers for them. Most configurations\n# use only name-based virtual hosts so the server doesn't need to worry about\n# IP addresses. This is indicated by the asterisks in the directives below.\n#\n# Please see the documentation at\n# <URL:http://httpd.apache.org/docs/2.2/vhosts/>\n# for further details before you try to setup virtual hosts.\n#\n# You may use the command line option '-S' to verify your virtual host\n# configuration.\n\n#\n# Use name-based virtual hosting.\n#\nNameVirtualHost *:80\n\n#\n# VirtualHost example:\n# Almost any Apache directive may go into a VirtualHost container.\n# The first VirtualHost section is used for all requests that do not\n# match a ServerName or ServerAlias in any <VirtualHost> block.\n#\n<VirtualHost *:80>\n    ServerAdmin support@hosts.com\n    DocumentRoot /home/domains/hosts/nonsecure\n    ServerName hosts.com\n    ServerAlias www.hosts.com hosts\n    ErrorLog /home/logs/hosts-error_log\n    CustomLog /home/logs/hosts-access_log common\n</VirtualHost>\n\n<VirtualHost *:80>\n    ServerAdmin support@hosts2.com\n#    DocumentRoot /home/domains/hosts2/nonsecure\n    DocumentRoot /home/domains/hosts2/old\n    ServerName hosts2.com\n    ServerAlias www.hosts2.com hosts2\n    ErrorLog /home/logs/hosts2-error_log\n    CustomLog /home/logs/hosts2-access_log common\n</VirtualHost>\n\n<VirtualHost *:80>\n    ServerAdmin support@host3.com\n    DocumentRoot /home/domains/host3\n    ServerName host3.com\n    ServerAlias www.host3.com host3\n    ErrorLog /home/logs/host3-error_log\n    CustomLog /home/logs/host3-access_log common\n</VirtualHost>\n\n<VirtualHost *:80>\n    ...\n</VirtualHost>\n\n-------------------------------\nhttpd-ssl.conf looks like\n#\n# This is the Apache server configuration file providing SSL support.\n# It contains the configuration directives to instruct the server how to\n# serve pages over an https connection. For detailing information about these\n# directives see <URL:http://httpd.apache.org/docs/2.2/mod/mod_ssl.html>\n#\n# Do NOT simply read the instructions in here without understanding\n# what they do.  They're here only as hints or reminders.  If you are unsure\n# consult the online docs. You have been warned.\n#\n\n#\n# Pseudo Random Number Generator (PRNG):\n# Configure one or more sources to seed the PRNG of the SSL library.\n# The seed data should be of good random quality.\n# WARNING! On some platforms /dev/random blocks if not enough entropy\n# is available. This means you then cannot use the /dev/random device\n# because it would lead to very long connection times (as long as\n# it requires to make more entropy available). But usually those\n# platforms additionally provide a /dev/urandom device which doesn't\n# block. So, if available, use this one instead. Read the mod_ssl User\n# Manual for more details.\n#\n#SSLRandomSeed startup file:/dev/random  512\n#SSLRandomSeed startup file:/dev/urandom 512\n#SSLRandomSeed connect file:/dev/random  512\n#SSLRandomSeed connect file:/dev/urandom 512\n\n\n#\n# When we also provide SSL we have to listen to the\n# standard HTTP port (see above) and to the HTTPS port\n#\n# Note: Configurations that use IPv6 but not IPv4-mapped addresses need two\n#       Listen directives: \"Listen [::]:443\" and \"Listen 0.0.0.0:443\"\n#\nListen 443\n\n##\n##  SSL Global Context\n##\n##  All SSL configuration in this context applies both to\n##  the main server and all SSL-enabled virtual hosts.\n##\n\n#\n#   Some MIME-types for downloading Certificates and CRLs\n#\nAddType application/x-x509-ca-cert .crt\nAddType application/x-pkcs7-crl    .crl\n\n#   Pass Phrase Dialog:\n#   Configure the pass phrase gathering process.\n#   The filtering dialog program (`builtin' is a internal\n#   terminal dialog) has to provide the pass phrase on stdout.\nSSLPassPhraseDialog  builtin\n\n#   Inter-Process Session Cache:\n#   Configure the SSL Session Cache: First the mechanism\n#   to use and second the expiring timeout (in seconds).\n#SSLSessionCache         dbm:/home/server/logs/ssl_scache\nSSLSessionCache        shmcb:/home/server/logs/ssl_scache(512000)\nSSLSessionCacheTimeout  300\n\n#   Semaphore:\n#   Configure the path to the mutual exclusion semaphore the\n#   SSL engine uses internally for inter-process synchronization.\nSSLMutex  file:/home/server/logs/ssl_mutex\n\n##\n## SSL Virtual Host Context\n##\n\nNameVirtualHost *:443\n\n<VirtualHost *:443>\n        ServerAdmin support@hosts1.com\n        DocumentRoot /home/domains/hosts1/secure\n        ServerName hosts1.com:443\n        ServerAlias www.hosts1.com:443 hosts1:443\n        ErrorLog /home/logs/hosts1-ssl-error_log\n        CustomLog /home/logs/hosts1-ssl-access_log common\n\n        SSLEngine on\n        SSLCipherSuite\nALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL\n        SSLCertificateFile /home/server/conf/hosts2.crt\n        SSLCertificateKeyFile /home/server/conf/hosts2.key\n\n        <FilesMatch \"\\.(cgi|shtml|phtml|php)$\">\n                SSLOptions +StdEnvVars\n        </FilesMatch>\n\n        <Directory \"/home/server/cgi-bin\">\n                SSLOptions +StdEnvVars\n        </Directory>\n\n        BrowserMatch \".*MSIE.*\" \\\n                nokeepalive ssl-unclean-shutdown \\\n                downgrade-1.0 force-response-1.0\n        CustomLog /home/server/logs/ssl_request_log \\\n                \"%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \\\"%r\\\" %b\"\n</VirtualHost>\n\n<VirtualHost *:443>\n        ServerAdmin support@hosts2.com\n        DocumentRoot /home/domains/hosts2/secure\n        ServerName hosts2.com:443\n        ServerAlias www.hosts2.com:443 hosts2:443\n        ErrorLog /home/logs/hosts2-ssl-error_log\n        CustomLog /home/logs/hosts2-ssl-access_log common\n\n        SSLEngine on\n        SSLCipherSuite\nALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL\n        SSLCertificateFile /home/server/conf/hosts2.crt\n        SSLCertificateKeyFile /home/server/conf/hosts2.key\n\n        <FilesMatch \"\\.(cgi|shtml|phtml|php)$\">\n                SSLOptions +StdEnvVars\n        </FilesMatch>\n\n        <Directory \"/home/server/cgi-bin\">\n                SSLOptions +StdEnvVars\n        </Directory>\n\n        BrowserMatch \".*MSIE.*\" \\\n                nokeepalive ssl-unclean-shutdown \\\n                downgrade-1.0 force-response-1.0\n        CustomLog /home/server/logs/ssl_request_log \\\n                \"%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \\\"%r\\\" %b\"\n</VirtualHost>\n\n-----------------------------------\n.htaccess for all hosts look like\nOptions +FollowSymlinks\nRewriteEngine on\nrewritecond %{http_host} ^host1.com [nc]\nrewriterule ^(.*)$ http://www.host1.com/$1 [r=301,nc]", "count": 2, "id": 102186, "time": "2007-04-23T19:56:54Z", "bug_id": 42200, "creation_time": "2007-04-23T19:56:54Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 42200, "text": "I should add that the same config works fine on my test server at home, which\nhas indentical Fedora 4 kernel and RPMS updates...", "id": 102187, "time": "2007-04-23T20:00:11Z", "creator": "lidengni@gmail.com", "creation_time": "2007-04-23T20:00:11Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 42200, "text": "(In reply to comment #3)\n> I should add that the same config works fine on my test server at home, which\n> has indentical Fedora 4 kernel and RPMS updates...\n\nSorry, I may not be right. I grep \"::1\" in my test server, it has 4 same such\nactivities too. I didn't notice before:\n\n::1 - - [06/Jan/2007:19:05:59 -0600] \"GET / HTTP/1.0\" 200 161\n::1 - - [06/Jan/2007:19:06:00 -0600] \"GET / HTTP/1.0\" 200 161\n::1 - - [06/Jan/2007:19:06:12 -0600] \"GET / HTTP/1.0\" 200 161\n::1 - - [06/Jan/2007:19:06:13 -0600] \"GET / HTTP/1.0\" 200 161\n\nI think the \"/\" request looping may be the problem. I have in my index.php (in\nevery hosts) trying to redirect as:\n\n  if ( $_SERVER[\"REQUEST_URI\"] != '/' ) {\n    Header( \"HTTP/1.1 301 Moved Permanently\" );\n    Header( \"Location: /\" );\n    exit();\n  }\n\nBecause if someone uses \"http://www.domain.com/foo/\" where \"/foo\" is a valid\nfolder, it shows the page same as \"http://www.domain.com/\", and if\n\"http://www.domain.com/bar/\" is used, where \"/bar\" does not exist, it returns \"404\".\n\nMy redirect is trying to make \"http://www.domain.com/foo/\" go to\n\"http://www.domain.com/\".\n\nThanks\n\n", "id": 102188, "time": "2007-04-23T20:13:09Z", "creator": "lidengni@gmail.com", "creation_time": "2007-04-23T20:13:09Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "slive@apache.org", "attachment_id": null, "is_private": false, "id": 102245, "time": "2007-04-24T08:28:18Z", "bug_id": 42200, "creation_time": "2007-04-24T08:28:18Z", "text": "These are \"internal dummy connections\" (which you would see logged on a non-ssl\nhost if you logged the user-agent) used to wake up processes that need to be\nrecycled. They should be ignored.\n\nIn the future, please address questions like this to a user support forum (such\nas the users@httpd.apache.org mailing list) rather than the bug database unless\nyou are sure you have found a bug."}, {"count": 6, "tags": [], "bug_id": 42200, "is_private": false, "text": "(In reply to comment #5)\n> These are \"internal dummy connections\" (which you would see logged on a non-ssl\n> host if you logged the user-agent) used to wake up processes that need to be\n> recycled. They should be ignored.\n> \n> In the future, please address questions like this to a user support forum (such\n> as the users@httpd.apache.org mailing list) rather than the bug database unless\n> you are sure you have found a bug.\n\nI disagree and feel this needs to be taken care of.\n\nIf it is \"internal dummy connections\" used to wake up processes, why would you\nrecord them into the access log? As a user, I would not want to know some\ninternal processes to be recorded. All functions can be called internal processes.\n\nI thought my computer was having bug and called DELL support who can't resolve\nit, and spent a lot of time google around for this problem. And this is the\nfirst time I heard of \"internal dummy process\", I google it, and found many\nother users also have similar doubt.\n\nCan such dummy connection requests be thrown out of the normal access log? I\nlook at the log for real users' activities, not for internal dummy activities.\n\nRegards.", "id": 102250, "time": "2007-04-24T08:57:34Z", "creator": "lidengni@gmail.com", "creation_time": "2007-04-24T08:57:34Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 42200, "text": "This design decision has been discussed extensively on the dev@httpd.apache.org\nmailing list. Some improvements will be made in the future, I believe. But\nsimply dropping them from the logs by default would not be a good idea. Feel\nfree to head over there to discuss it further. But of course, search the\narchives first.", "id": 102252, "time": "2007-04-24T09:14:07Z", "creator": "slive@apache.org", "creation_time": "2007-04-24T09:14:07Z", "is_private": false, "attachment_id": null}]