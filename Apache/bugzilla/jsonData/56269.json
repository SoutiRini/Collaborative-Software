[{"count": 0, "attachment_id": 31391, "creator": "kiwiwings@apache.org", "text": "Created attachment 31391\ndifferent fractional rounding before save/load in Libre Office\n\nIn our project we discovered some rounding problem with date fractions.\nWe've got some data from a database tool (TOAD) which minimal calculated fractions differently, but the result when opening the file was ok.\nBut the DateUtil class uses the real milliseconds and therefore output 03.01.2014 10:59:59 instead of 11:00:00 (fraction was 41642.45833321759)\n\nAfter playing around with the fractions, it seems that at least Libre Office will round at 500 millisecs.\nActually when recalculate the second date in the example file, it will be saved as 10:59:59, but when reopening it will be 11:00:00.\n\nMS Excel Viewer can't be forced to recalc via [1] and I haven't check with project laptops Excel version ...\n\nShould this rounding be taken into account in the DateUtil class?\n\n\n\n[1] http://apache-poi.1045710.n5.nabble.com/How-to-force-Excel-to-recalculate-on-opening-xlsx-td3249595.html", "id": 173846, "time": "2014-03-15T13:03:01Z", "bug_id": 56269, "creation_time": "2014-03-15T13:03:01Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "kiwiwings@apache.org", "attachment_id": 31588, "id": 175012, "time": "2014-05-04T21:11:02Z", "bug_id": 56269, "creation_time": "2014-05-04T21:11:02Z", "is_private": false, "text": "Created attachment 31588\n[PATCH] Round fractionals to seconds\n\nThe patch adds another formatting option to the DateUtil class, to get rounded dates. I think, this should be the default, to have the date values rounded to seconds, but for the sake of compatibility I left the behavior unchanged."}, {"count": 2, "tags": [], "bug_id": 56269, "is_private": false, "text": "applied with svn rev r1592419", "id": 175013, "time": "2014-05-04T21:18:23Z", "creator": "kiwiwings@apache.org", "creation_time": "2014-05-04T21:18:23Z", "attachment_id": null}]