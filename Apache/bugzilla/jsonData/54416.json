[{"text": "The denoted HTTP method MKCALENDAR is not supported due to CVE-2011-3348 (http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3348).\n\nUnfortunately, that method is badly needed to support up-to-date CalDAV clients.", "tags": [], "creator": "thorben.betten@open-xchange.com", "attachment_id": null, "count": 0, "id": 164618, "time": "2013-01-14T12:11:01Z", "bug_id": 54416, "creation_time": "2013-01-14T12:11:01Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 54416, "attachment_id": null, "id": 164619, "time": "2013-01-14T12:39:26Z", "creator": "covener@gmail.com", "creation_time": "2013-01-14T12:39:26Z", "is_private": false, "text": "Can you elaborate on what that CVE has to do with the MKCALENDAR method and attach a log of mod_proxy_ajp doing something wrong?"}, {"count": 2, "attachment_id": null, "bug_id": 54416, "is_private": false, "id": 164622, "time": "2013-01-14T13:20:57Z", "creator": "marc.arens@open-xchange.com", "creation_time": "2013-01-14T13:20:57Z", "tags": [], "text": "AFAIU the result of the CVE is to return HTTP_NOT_IMPLEMENTED instead of HTTP_BAD_REQUEST which marked the the active node as \"in error\" state to prevent the DOS.\n\nThe main problem seems to be that mod_proxy_ajp responds with \"No such method MKCALENDAR\" to MKCALENDAR request.\n\n[Fri Dec 14 12:24:49 2012] [debug] mod_proxy_ajp.c(45): proxy: AJP: canonicalising URL //localhost:8009/servlet/dav/caldav/B731244A-5D06-4941-83F1-880A1EAE6343/\n[Fri Dec 14 12:24:49 2012] [debug] proxy_util.c(1525): [client 192.168.32.238] proxy: *: found reverse proxy worker for ajp://localhost:8009/servlet/dav/caldav/B731244A-5D06-4941-83F1-880A1EAE6343/\n[Fri Dec 14 12:24:49 2012] [debug] mod_proxy.c(1020): Running scheme ajp handler (attempt 0)\n[Fri Dec 14 12:24:49 2012] [debug] mod_proxy_ajp.c(681): proxy: AJP: serving URL ajp://localhost:8009/servlet/dav/caldav/B731244A-5D06-4941-83F1-880A1EAE6343/\n[Fri Dec 14 12:24:49 2012] [debug] proxy_util.c(2011): proxy: AJP: has acquired connection for (*)\n[Fri Dec 14 12:24:49 2012] [debug] proxy_util.c(2067): proxy: connecting ajp://localhost:8009/servlet/dav/caldav/B731244A-5D06-4941-83F1-880A1EAE6343/ to localhost:8009\n[Fri Dec 14 12:24:49 2012] [debug] proxy_util.c(2193): proxy: connected /servlet/dav/caldav/B731244A-5D06-4941-83F1-880A1EAE6343/ to localhost:8009\n[Fri Dec 14 12:24:49 2012] [debug] proxy_util.c(2444): proxy: AJP: fam 2 socket created to connect to *\n[Fri Dec 14 12:24:49 2012] [debug] ajp_header.c(224): Into ajp_marshal_into_msgb\n[Fri Dec 14 12:24:49 2012] [error] ajp_marshal_into_msgb - No such method MKCALENDAR\n[Fri Dec 14 12:24:49 2012] [error] ajp_send_header: ajp_marshal_into_msgb failed\n[Fri Dec 14 12:24:49 2012] [error] (120010)APR does not understand this error code: proxy: AJP: request failed to (null) (*)\n[Fri Dec 14 12:24:49 2012] [debug] proxy_util.c(2029): proxy: AJP: has released connection for (*)\n\n\nUsing Apache 2.2.16-6+squeeze10 in a setup with proxy_balancer and proxy_ajp here.\nSwitching to proxy_http as a workaorund lets Apache accept MKCALENDAR requests."}, {"count": 3, "tags": [], "text": "It looks to me like mod_proxy_ajp simply cannot forward methods it doesn't know, and it didn't know about this method before the CVE fix either.  If you agree, please change the subject of the bug to \"add MKCALENDAR method to mod_proxy_ajp\"", "is_private": false, "bug_id": 54416, "id": 164623, "time": "2013-01-14T13:40:51Z", "creator": "covener@gmail.com", "creation_time": "2013-01-14T13:40:51Z", "attachment_id": null}, {"count": 4, "tags": [], "text": "Sorry, subject is already appropriate!", "is_private": false, "bug_id": 54416, "id": 164624, "time": "2013-01-14T13:41:16Z", "creator": "covener@gmail.com", "creation_time": "2013-01-14T13:41:16Z", "attachment_id": null}, {"count": 5, "tags": [], "text": "Can you try the patch available at:\n\nhttp://people.apache.org/~rjung/patches/httpd-2_2_x-ajp-unknown_-methods.patch\n\nand report back? It is a straightforward port from mod_jk.\n\nIf it still doesn't work: what's the backend and which version?", "is_private": false, "bug_id": 54416, "id": 164721, "time": "2013-01-18T11:25:18Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2013-01-18T11:25:18Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 54416, "attachment_id": null, "is_private": false, "id": 164722, "time": "2013-01-18T11:30:03Z", "creator": "marc.arens@open-xchange.com", "creation_time": "2013-01-18T11:30:03Z", "text": "Thanks, i'll have a look at the patch."}, {"count": 7, "tags": [], "bug_id": 54416, "attachment_id": null, "id": 164725, "time": "2013-01-18T14:41:27Z", "creator": "marc.arens@open-xchange.com", "creation_time": "2013-01-18T14:41:27Z", "is_private": false, "text": "We just tested the patch successfully. MKCALENDAR is working now via mod_proxy_ajp. Additionally we ran our testuite of dav tests against the patched module and couldn't find any regressions either.\n\nThank you very much for the quick response."}, {"count": 8, "tags": [], "bug_id": 54416, "attachment_id": null, "id": 164727, "time": "2013-01-18T15:21:04Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2013-01-18T15:21:04Z", "is_private": false, "text": "Thanks for confirming the patch.\nFixed in trunk with r1435178.\nBackport to 2.4.x proposed.\nWhen backport happens, I will also propose for 2.2."}, {"count": 9, "tags": [], "bug_id": 54416, "attachment_id": null, "id": 164764, "time": "2013-01-21T16:14:29Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2013-01-21T16:14:29Z", "is_private": false, "text": "Applied to 2.4.x in r1436400. Will be part of 2.4.4.\nProposed for backport to 2.2.x."}, {"count": 10, "tags": [], "text": "Backported to 2.2.x today.\nShould be part of 2.2.24.", "is_private": false, "bug_id": 54416, "id": 165271, "time": "2013-02-15T15:53:36Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2013-02-15T15:53:36Z", "attachment_id": null}, {"count": 11, "attachment_id": null, "bug_id": 54416, "is_private": false, "id": 165603, "time": "2013-03-03T16:43:19Z", "creator": "sf@sfritsch.de", "creation_time": "2013-03-03T16:43:19Z", "tags": [], "text": "fixed in 2.4.4 and 2.2.24"}]