[{"count": 0, "attachment_id": null, "bug_id": 57923, "text": "Hey Guys,\n\nWe have a problem with the POI API.\nWe want to check whether the external spreadsheet, to which a formula refers, is integrated properly. For this we call the method HSSFName.getSheetName ().\n\nDuring this call, we get an ArrayIndexOutOfBoundsException. The reason is that, in this case the object Name (Konrekt HSSFName) does not refer to any formula and there is accordingly no PTGs. That's why flies here\n\"Ptg PTG = field_13_name_definition.getTokens () [0];\" a ArrayIndexOutOfBoundsException.\n\nOur suggestion would be as follows:\n\nThe method org.apache.poi.hssf.record.NameRecord.getExternSheetNumer () should be rewritten:\n\npublic int getExternSheetNumber(){\n                Ptg[] ptgs = field_13_name_definition.getTokens();\n\t\tif (ptgs.lenght < 1) {\n\t\t\treturn 0;\n\t\t}\n\t\tPtg ptg = ptgs[0];\n\n\t\tif (ptg.getClass() == Area3DPtg.class){\n\t\t\treturn ((Area3DPtg) ptg).getExternSheetIndex();\n\n\t\t}\n\t\tif (ptg.getClass() == Ref3DPtg.class){\n\t\t\treturn ((Ref3DPtg) ptg).getExternSheetIndex();\n\t\t}\n\t\treturn 0;\n\t}", "id": 182955, "time": "2015-05-12T11:33:38Z", "creator": "g.youansisiewe@lucanet.com", "creation_time": "2015-05-12T11:33:38Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "Any chance you could retest with 3.12 final?", "id": 182956, "time": "2015-05-12T12:08:18Z", "bug_id": 57923, "creation_time": "2015-05-12T12:08:18Z", "is_private": false}, {"count": 2, "attachment_id": null, "bug_id": 57923, "text": "The Problem still occurs in the version 3.12 Final", "id": 182970, "time": "2015-05-13T08:06:35Z", "creator": "g.youansisiewe@lucanet.com", "creation_time": "2015-05-13T08:06:35Z", "tags": [], "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 57923, "is_private": false, "count": 3, "id": 183669, "time": "2015-06-21T06:17:55Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-06-21T06:17:55Z", "text": "Can you provide a sample file and sample code which shows the Exception on HSSFName.getSheetName()"}, {"count": 4, "attachment_id": null, "bug_id": 57923, "is_private": false, "id": 183670, "time": "2015-06-21T06:57:09Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-06-21T06:57:09Z", "tags": [], "text": "Nevermind, the following is sufficient to reproduce the problem:\n\n        NameRecord record = new NameRecord();\n        assertEquals(0, record.getExternSheetNumber());\n\nthis is fixed via r1686689 now."}, {"count": 5, "tags": [], "creator": "g.youansisiewe@lucanet.com", "attachment_id": null, "text": "Is the fix also available in Version 3.11?\nHow can i get the actuel POI-Version with the fix?", "id": 183679, "time": "2015-06-22T06:58:24Z", "bug_id": 57923, "creation_time": "2015-06-22T06:58:24Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 57923, "is_private": false, "count": 6, "id": 183680, "time": "2015-06-22T09:37:54Z", "creator": "kiwiwings@apache.org", "creation_time": "2015-06-22T09:37:54Z", "text": "We usually don't backport features, only for CVEs.\nSo you need to grab a nightly until we push the next beta or final release.\nSee [1] or [2] for download infos \n\n[1] http://poi.apache.org/download.html\n[2] https://builds.apache.org/job/POI/lastSuccessfulBuild/artifact/build/dist/"}]