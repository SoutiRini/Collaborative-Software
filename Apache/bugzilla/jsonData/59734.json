[{"count": 0, "tags": [], "bug_id": 59734, "text": "XSSFName.setNameName and XSSFWorkbook.getName both involve a linear iteration through all names already in the workbook. This is a major performance bottleneck for an application creating lots of named ranges.\n\nI'll shortly attach a suggested patch which does the obvious thing and adds a map to do fast lookup.\n\nI'll also propose deprecating the methods on Workbook which operate in an index-based manner and replacing them with ones based on names.", "id": 191840, "time": "2016-06-20T12:42:25Z", "creator": "dtn-asfbugs@corefiling.co.uk", "creation_time": "2016-06-20T12:42:25Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "onealj@apache.org", "attachment_id": null, "text": "Are you planning on writing a CaseInsensitiveMap or importing https://commons.apache.org/proper/commons-collections/apidocs/org/apache/commons/collections4/map/CaseInsensitiveMap.html\n\nI guess you would also need a (scope (global or sheet), named range name) tuple class as your key, so you could hide the canonical case code there.", "id": 191846, "time": "2016-06-20T18:08:20Z", "bug_id": 59734, "creation_time": "2016-06-20T18:08:20Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 59734, "text": "The rather old patch I'm working from hides that logic in the key, so I'll probably go with that approach.", "id": 191859, "time": "2016-06-21T09:07:54Z", "creator": "dtn-asfbugs@corefiling.co.uk", "creation_time": "2016-06-21T09:07:54Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 59734, "text": "Fixed in r174521\n\nI opted to go with the commons collections route after all.\n\nExisting index-based methods have been deprecated rather than removed.", "id": 192713, "time": "2016-07-29T13:25:13Z", "creator": "dtn-asfbugs@corefiling.co.uk", "creation_time": "2016-07-29T13:25:13Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "onealj@apache.org", "attachment_id": null, "text": "(In reply to David North from comment #3)\n> Fixed in r174521\nCorrection: r1754521", "id": 192714, "time": "2016-07-29T16:15:12Z", "bug_id": 59734, "creation_time": "2016-07-29T16:15:12Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 59734, "attachment_id": null, "id": 194076, "time": "2016-09-29T00:17:11Z", "creator": "greg.woolsey@gmail.com", "creation_time": "2016-09-29T00:17:11Z", "is_private": false, "text": "Where is the new dependency tracked for end users?  The change log?  For people who don't use Maven or Ivy, it make come as a surprise that running their code suddenly fails with a NoClassDefFound error (it just did for me, running a local project with a local build of POI as a dependency).  I missed the commit message, and had to go find this issue.\n\nIt doesn't seem that hard to implement using a normal HashMap, where the desired name is upper or lower-cased between the user call and the map lookup.\n\nIt could be a Map<String, Map<String, Name>> construct, where the outer Map is by sheet name.  Global names would be mapped under the null entry.\n\nRequest sheet and table names would be looked up in the internal map by upper or lower case cannonicalization (null aware for sheets), and no special tuple or Commons Collections class would be needed.\n\nWas simplicity the only reason for adding the package dependency?"}, {"count": 6, "tags": [], "bug_id": 59734, "attachment_id": null, "id": 194080, "time": "2016-09-29T07:16:13Z", "creator": "dtn-asfbugs@corefiling.co.uk", "creation_time": "2016-09-29T07:16:13Z", "is_private": false, "text": "Simplicity/good developers don't write what they can steal.\n\nApologies for not noting the new dependency in the change log - I'll add a note to our release process to make sure this is covered next time round."}, {"count": 7, "tags": [], "creator": "onealj@apache.org", "attachment_id": null, "text": "I added a note on the new dependency to the changelog for the 3.15 release and I think it was mentioned in the release notes.[1]\n\nI realized that this dependency addition should have been added to the release notes after the release had been generated.[2]\n\n[1] https://poi.apache.org/changes.html\n[2] https://www.apache.org/dyn/closer.lua/poi/release/RELEASE-NOTES.txt", "id": 194090, "time": "2016-09-29T14:18:52Z", "bug_id": 59734, "creation_time": "2016-09-29T14:18:52Z", "is_private": false}, {"count": 8, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "text": "*** Bug 59432 has been marked as a duplicate of this bug. ***", "id": 194460, "time": "2016-10-15T20:26:17Z", "bug_id": 59734, "creation_time": "2016-10-15T20:26:17Z", "is_private": false}]