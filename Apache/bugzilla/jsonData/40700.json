[{"count": 0, "tags": [], "bug_id": 40700, "is_private": false, "text": "Subversion can not properly work with FSFS-backed repositories stored on an SMB filesystem for two \nreasons.\n\nFirst, apr_file_lock uses fcntl, which does not support file locks on SMB filesystems. A work-around is to \nuse flock in these cases, but it involves further complications in that shared locks are really treated as \nexclusive locks.\n\nSecond, apr_file_write allows Subversion to attempt a write operation with a zero byte buffer. This causes \nan I/O error to be trigger on Mac OS X 10.4 systems. A simple check of the buffer size would solve this \nproblem.", "id": 94608, "time": "2006-10-06T17:23:44Z", "creator": "spam_brian@mac.com", "creation_time": "2006-10-06T17:23:44Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 40700, "attachment_id": 18976, "is_private": false, "id": 94609, "time": "2006-10-06T17:27:30Z", "creator": "spam_brian@mac.com", "creation_time": "2006-10-06T17:27:30Z", "text": "Created attachment 18976\nPatch against revision 453816 of APR HEAD \n\nMac OS X work-around for file locking and zero byte write operations with files\non an SMB filesystem."}, {"count": 2, "tags": [], "bug_id": 40700, "is_private": false, "text": "\"don't do that\" is probably the best answer here.  If fcntl locking won't work\nover SMB then FSFS won't work over SMB.\n\nIf write(,,0) fails then that sounds like a Darwin bug, there's no excuse for\nthat really; Subversion needn't make such a call anyway so it could be worked\naround at in Subversion.", "id": 95067, "time": "2006-10-24T07:42:42Z", "creator": "jorton@redhat.com", "creation_time": "2006-10-24T07:42:42Z", "attachment_id": null}]