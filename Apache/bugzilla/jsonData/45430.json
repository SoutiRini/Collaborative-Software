[{"attachment_id": 22279, "tags": [], "bug_id": 45430, "is_private": false, "count": 0, "id": 118797, "time": "2008-07-18T02:28:14Z", "creator": "matthew.knl@gmail.com", "creation_time": "2008-07-18T02:28:14Z", "text": "Created attachment 22279\nTest Data\n\nI am using POI 3.5 Beta 1.\nI write following code to list all the Named Range in the Excel Workbook.\n\nWorkbook wb = new XSSFWorkbook(xlsx_path);\nfor(int j=0; j<wb.getNumberOfNames(); j++){\n\tName name = wb.getNameAt(j);\t\t\t\t\n\tString reference = name.getReference();\n\tString sheetName = name.getSheetName();\n\tSystem.out.println(\"reference: \" + reference);\n\tSystem.out.println(\"sheetName: \" + sheetName);\n}\n\nI found that the .getSheetName() method return the wrong value, it always return sheet one name, which doesn't match with .getReference() (the sheet name part).\n\nI have uploaded a sample .xlsx file, which contains three worksheets, each worksheet $A$1 has defined a named range. You can run above codes to check the result.\n\nExpected Result:\nreference: SheetA!$A$1\nsheetName: SheetA\nreference: SheetB!$A$1\nsheetName: SheetB\nreference: SheetC!$A$1\nsheetName: SheetC\n\nActual Result:\nreference: SheetA!$A$1\nsheetName: SheetA\nreference: SheetB!$A$1\nsheetName: SheetA\nreference: SheetC!$A$1\nsheetName: SheetA"}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "is_private": false, "id": 118830, "time": "2008-07-18T10:37:49Z", "bug_id": 45430, "creation_time": "2008-07-18T10:37:49Z", "text": "Fixed in svn - was an issue when no localSheetId was given"}, {"count": 2, "attachment_id": 22287, "bug_id": 45430, "text": "Created attachment 22287\nMacro-enabled workbook package structure", "id": 118849, "time": "2008-07-20T18:49:16Z", "creator": "matthew.knl@gmail.com", "creation_time": "2008-07-20T18:49:16Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "creator": "matthew.knl@gmail.com", "attachment_id": 22288, "is_private": false, "id": 118850, "time": "2008-07-20T18:50:31Z", "bug_id": 45430, "creation_time": "2008-07-20T18:50:31Z", "text": "Created attachment 22288\nMy patch to solve \"save macro-enabled workbook\" issue, temporary solution"}, {"count": 4, "tags": [], "creator": "matthew.knl@gmail.com", "attachment_id": null, "text": "(In reply to comment #2)\n> Created an attachment (id=22287) [details]\n> Macro-enabled workbook package structure\n> \n\nSorry, this attachment is should be referred to bug#45430.", "id": 118853, "time": "2008-07-20T18:57:08Z", "bug_id": 45430, "creation_time": "2008-07-20T18:57:08Z", "is_private": false}, {"count": 5, "tags": [], "creator": "matthew.knl@gmail.com", "attachment_id": null, "is_private": false, "id": 118854, "time": "2008-07-20T18:57:29Z", "bug_id": 45430, "creation_time": "2008-07-20T18:57:29Z", "text": "(In reply to comment #3)\n> Created an attachment (id=22288) [details]\n> My patch to solve \"save macro-enabled workbook\" issue, temporary solution\n> \n\nSorry, this attachment is should be referred to bug#45430."}]