[{"count": 0, "tags": [], "text": "If you use presetdef to create a new task definition,\nand you supply a default value to a \"cumulative\" parameter\nlike javac's \"srcdir\", users of that new definition\ncannot override that default value, they can only add\nto it.  I find this behavior surprising, and I feel that\nit seriously limits the usefulness of \"presetdef\".\n\nMany tasks have cumulative parameters like this, e.g.:\n\n   javac: srcdir, *classpath, extdirs, ...\n   javadoc: sourcepath, packagenames, ...\n   jar:  includes, excludes, ...\n\nI suspect that users of presetdef will find it much more\nuseful if default values of these cumulative parameters\ncan be overridden, not just supplemented.\n\nBTW, aside from this nit, \"presetdef\" is a wonderful\naddition to Ant.  THanks!\n\nThe following build file illustrates the problem\n\n========= CUT HERE ================================\n\n<?xml version=\"1.0\"?>\n\n<!--\n######################################################################\n To reproduce:\n 1.  Create two empty files:\n       default/empty.java\n       override/empty.java\n\n 2. Execute this build file with Ant v1.6\n       C:\\temp>ant\n       Buildfile: build.xml\n\n       all:\n        [my.javac] Compiling 2 source files\n        [my.javac] [parsing started C:\\temp\\default\\empty.java]\n        [my.javac] [parsing completed 31ms]\n        [my.javac] [parsing started C:\\temp\\override\\empty.java]\n        [my.javac] [parsing completed 0ms]\n        [my.javac] [total 391ms]\n\n       BUILD SUCCESSFUL\n       Total time: 1 second\n       C:\\temp>ant -version\n       Apache Ant version 1.6beta2 compiled on October 31 2003\n       C:\\temp>\n\n     Note that *both* files got compiled.\n\n######################################################################-->\n\n<project name=\"presetdef\" default=\"all\">\n\n  <presetdef name=\"my.javac\">\n    <!-- Provide default value for source directory. -->\n    <javac srcdir=\"default\" verbose=\"true\"/>\n  </presetdef>\n\n  <target name=\"all\">\n    <!-- I expected the following task to compile just the contents of\n         the directory \"override\", but (surprisingly) it also compiles\n         the contents of \"default\". -->\n    <my.javac srcdir=\"override\"/>\n  </target>\n\n</project>", "is_private": false, "id": 46823, "creator": "jmlennon@us.ibm.com", "time": "2003-11-04T22:05:35Z", "bug_id": 24411, "creation_time": "2003-11-04T22:05:35Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "Created attachment 8945\nPatch to modify behaviour of presetdef", "attachment_id": 8945, "bug_id": 24411, "id": 46865, "time": "2003-11-05T14:48:24Z", "creator": "peter.reilly@corvil.com", "creation_time": "2003-11-05T14:48:24Z", "is_private": false}, {"count": 2, "tags": [], "text": "I made a patch to preset to correct the odd behaviour\nIt involves changes to a number of core ant classes\n(UnknownElement, IntrospectionHelper and RuntimeConfigurable)\nand the code is a little 'hacky',\nso I have just made it a patch at the moment.\n\nThe patch will make attributes and text of the predefined\ntask optional, in that they can be overriden by the\nuser *without* the target class being aware of the override.", "attachment_id": null, "bug_id": 24411, "id": 46866, "time": "2003-11-05T14:57:28Z", "creator": "peter.reilly@corvil.com", "creation_time": "2003-11-05T14:57:28Z", "is_private": false}, {"count": 3, "attachment_id": null, "bug_id": 24411, "is_private": false, "id": 46909, "time": "2003-11-06T09:09:06Z", "creator": "peter.reilly@corvil.com", "creation_time": "2003-11-06T09:09:06Z", "tags": [], "text": "Ok committed the changes, this should be available\nin the next ant beta build"}]