[{"count": 0, "attachment_id": 35141, "bug_id": 61300, "text": "Created attachment 35141\ntriggering file\n\nI need to figure out if this is a POIFs bug or a parseSummaries bug.  This is triggered by a corrupted file.\n\nAt this location:\n\t  at org.apache.poi.util.IOUtils.copy(IOUtils.java:296)\n\t  at org.apache.poi.util.IOUtils.peekFirstNBytes(IOUtils.java:64)\n\t  at org.apache.poi.hpsf.PropertySet.isPropertySetStream(PropertySet.java:393)\n\t  at org.apache.poi.hpsf.PropertySet.<init>(PropertySet.java:191)\n\t  at org.apache.tika.parser.microsoft.SummaryExtractor.parseSummaryEntryIfExists(SummaryExtractor.java:83)\n\t  at org.apache.tika.parser.microsoft.SummaryExtractor.parseSummaries(SummaryExtractor.java:73)\n\n        while((count = inp.read(buff)) != -1) {\n            if(count > 0) {\n                out.write(buff, 0, count);\n            }\n        }\n\nOn the first iteration, the pos in inp is 0, but then the pos goes negative on each iteration, and this loop iterates for a very long time.\n\nThe source file that I corrupted is: testEXCEL_embeddedPDF_windows.xls", "id": 199798, "time": "2017-07-14T12:37:05Z", "creator": "tallison@mitre.org", "creation_time": "2017-07-14T12:37:05Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "dominik.stadler@gmx.at", "is_private": false, "text": "How can we reproduce this with POI alone? How is the document opened in Tika?", "id": 200387, "time": "2017-08-20T09:40:31Z", "bug_id": 61300, "creation_time": "2017-08-20T09:40:31Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 61300, "attachment_id": null, "is_private": false, "id": 200951, "time": "2017-09-19T12:13:51Z", "creator": "tallison@mitre.org", "creation_time": "2017-09-19T12:13:51Z", "text": "Dominik,\n  I'm sorry for never responding.  Y, looks like I could reproduce this in pure POI.\n\nfixed r1801989"}]