[{"count": 0, "tags": [], "text": "Created attachment 28764\nicontest.war\n\nThe issue was reported in the following thread on users@:\nhttp://markmail.org/thread/m6fimchl2jk2vyl4\nhttp://marc.info/?t=133665328700005&r=1&w=2\n\nI am able to reproduce the issue on current trunk with the following steps:\n\n1. Remove JreMemoryLeakPreventionListener from server.xml\n2. Deploy the attached war file, icontest.war\nIt contains WEB-INF/lib/icon.jar with several copies of Tomcat icon\n3. Start Tomcat and access the following URL:\nhttp://localhost:8080/icontest/favicon.ico\n\nExpected behaviour:\nThe icon is displayed\n\nActual behaviour:\n[[[\n13-May-2012 00:23:05.906 SEVERE [http-bio-8080-exec-1] org.apache.coyote.http11.AbstractHttp11Processor.process Error processing request\n java.lang.IllegalStateException: zip file closed\n\tat java.util.jar.JarFile.getMetaInfEntryNames(Native Method)\n\tat java.util.jar.JarFile.maybeInstantiateVerifier(JarFile.java:279)\n\tat java.util.jar.JarFile.getInputStream(JarFile.java:383)\n\tat org.apache.naming.resources.WARDirContext$WARResource.streamContent(WARDirContext.java:990)\n\tat org.apache.naming.resources.ProxyDirContext.cacheLoad(ProxyDirContext.java:1621)\n\tat org.apache.naming.resources.ProxyDirContext.cacheLookup(ProxyDirContext.java:1501)\n\tat org.apache.naming.resources.ProxyDirContext.lookup(ProxyDirContext.java:262)\n\tat org.apache.tomcat.util.http.mapper.Mapper.internalMapWrapper(Mapper.java:996)\n\tat org.apache.tomcat.util.http.mapper.Mapper.internalMap(Mapper.java:808)\n\tat org.apache.tomcat.util.http.mapper.Mapper.map(Mapper.java:671)\n\tat org.apache.catalina.connector.CoyoteAdapter.postParseRequest(CoyoteAdapter.java:646)\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:402)\n\tat org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:995)\n\tat org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:573)\n\tat org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:145)\n\tat org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:311)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n\tat java.lang.Thread.run(Thread.java:662)\n]]]", "is_private": false, "id": 158992, "creator": "knst.kolinko@gmail.com", "time": "2012-05-12T20:32:50Z", "bug_id": 53225, "creation_time": "2012-05-12T20:32:50Z", "attachment_id": 28764}, {"count": 1, "tags": [], "text": "possible problem r1130497", "is_private": false, "id": 159239, "creator": "fhanik@apache.org", "time": "2012-05-22T20:01:52Z", "bug_id": 53225, "creation_time": "2012-05-22T20:01:52Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 53225, "text": "Confirmed that setting urlCacheProtection=\"false\" for the JreMemoryLeakPreventionListener is sufficient to trigger this issue. Still digging as to the root cause.", "id": 159547, "time": "2012-05-31T08:29:02Z", "creator": "markt@apache.org", "creation_time": "2012-05-31T08:29:02Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "Fixed in trunk and 7.0.x and will be included in 7.0.28 onwards.", "attachment_id": null, "bug_id": 53225, "id": 159552, "time": "2012-05-31T10:04:13Z", "creator": "markt@apache.org", "creation_time": "2012-05-31T10:04:13Z", "is_private": false}, {"count": 4, "tags": [], "creator": "knst.kolinko@gmail.com", "attachment_id": null, "id": 159556, "time": "2012-05-31T10:38:04Z", "bug_id": 53225, "creation_time": "2012-05-31T10:38:04Z", "is_private": false, "text": "*** Bug 52746 has been marked as a duplicate of this bug. ***"}]