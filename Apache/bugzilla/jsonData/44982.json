[{"count": 0, "tags": [], "creator": "Matej.Spiller@siol.net", "text": "When I verify hash with RSA signature it fails with PORT_GetError == -8182 == 0xFFFFE00A == SEC_ERROR_BAD_SIGNATURE.\n\nIt seems to be the problem, because sign wraps hash with SGN_CreateDigestInfo, however verify does not.\n\nCan somebody confirm this?\n\nSuggesting adding the same logic to verify.\n\nOr even better replacing PK11_Sign and PK11_Verify with (and unifying RSA and DSA code):\n\nVFY_VerifyDigest(SECItem *digest, SECKEYPublicKey *key, SECItem *sig, SECOidTag algid, void *wincx) (http://mxr.mozilla.org/security/source/security/nss/lib/cryptohi/secvfy.c)\n\nSGN_Digest(SECKEYPrivateKey *privKey, SECOidTag algtag, SECItem *result, SECItem *digest) (see http://crypto.stanford.edu/firefox-rhash/data/secsign.c.html)\n\nHere you can see how PK11_Sign and PK11_Verify should be used for RSA and DSA.", "id": 116545, "time": "2008-05-12T23:40:13Z", "bug_id": 44982, "creation_time": "2008-05-12T23:40:13Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 44982, "text": "\n\n*** This bug has been marked as a duplicate of bug 49660 ***", "id": 141017, "time": "2010-10-25T20:32:29Z", "creator": "cantor.2@osu.edu", "creation_time": "2010-10-25T20:32:29Z", "is_private": false, "attachment_id": null}]