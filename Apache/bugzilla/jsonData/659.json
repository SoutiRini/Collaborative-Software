[{"count": 0, "tags": [], "creator": "kkocan@isolutionscorp.com", "attachment_id": null, "id": 789, "time": "2001-02-20T15:09:37Z", "bug_id": 659, "creation_time": "2001-02-20T15:09:37Z", "is_private": false, "text": "The NTEventLogAppender can only currently be configured\nusing the constructor.  This prevents the appender from\nbeing configured using the property file.  The constructor\nallows the server and the source to be specified.\n\nNTEventLogAppender.java does not have the methods:\nsetOption(), activateOptions(), getOptionStrings()\n\nThe following code represents most of the fix:\n\n  public static final String SOURCE_OPTION = \"Source\";\n  private String source = null;\n  private String server = null;\n  \n\n  public\n  void setOption(String key, String value) {\n    if(value == null) return;\n    super.setOption(key, value);\n    \n\n    if(key.equalsIgnoreCase(SOURCE_OPTION)) {\n      // Set the source for the NT Evetns\n      source = value.trim();\n      }\n  }\n\n  public\n  void activateOptions() {    \n      if (source != null) {\n          try {\n            _handle = registerEventSource(server, source);\n          } catch (Exception e) {\n            e.printStackTrace();\n            _handle = 0;\n          }\n      }\n  }\n\n  /**\n     Retuns the option names for this component \n   **/\n  public\n  String[] getOptionStrings() {\n    return OptionConverter.concatanateArrays(super.getOptionStrings(),\n          new String[] {SOURCE_OPTION});\n  }\n\n\n\n// In addition to the above, the source & server should be set\n// within the constructor ... the server also should be added\n// as an option in the above code"}, {"count": 1, "text": "This has been fixed. Sorry Matthias!", "bug_id": 659, "attachment_id": null, "id": 2010, "time": "2001-04-22T08:56:36Z", "creator": "bugzilla@apache.org", "creation_time": "2001-04-22T08:56:36Z", "tags": [], "is_private": false}]