[{"count": 0, "tags": [], "bug_id": 55790, "attachment_id": null, "id": 171278, "time": "2013-11-17T22:06:19Z", "creator": "krichy@cflinux.hu", "creation_time": "2013-11-17T22:06:19Z", "is_private": false, "text": "In freebsd, apr chooses to use APR_USE_FLOCK_SERIALIZE, which effectively makes use of files for locking. Unfortunately, mod_fcgid uses tmpnam() for filename creation, which creates a file in the defined P_tmpdir (/tmp). And meanwhile, my system periodically cleans /tmp as well, sometimes removing such lockfiles, and when the httpd processes are restarted, the lock initialization fails, and actually apache stops responding.\n\nEither mod_fcgid should be configurable to use other lockfile-s, or apr should choose another locking method on freebsd."}, {"count": 1, "attachment_id": null, "bug_id": 55790, "is_private": false, "id": 202631, "time": "2017-12-07T22:33:09Z", "creator": "JBlond@gmail.com", "creation_time": "2017-12-07T22:33:09Z", "tags": [], "text": "is this still relevant? On Linux it uses the log folder from apache.\n\n\nmodules/fcgid/fcgid_mutex_unix.c:117:    lockfile = apr_palloc(pconf, L_tmpnam);\nmodules/fcgid/fcgid_mutex_unix.c:118:    tmpnam(lockfile);\n\nsrclib/apr/file_io/unix/tempdir.c:62:          P_tmpdir      (POSIX define)\nsrclib/apr/file_io/unix/tempdir.c:104:#ifdef P_tmpdir\nsrclib/apr/file_io/unix/tempdir.c:109:    if (test_tempdir(P_tmpdir, p)) {\nsrclib/apr/file_io/unix/tempdir.c:110:        dir = P_tmpdir;\n\n\nFrom line 50\n\n    /* Our goal is to find a temporary directory suitable for writing\n       into.\n       Here's the order in which we'll try various paths:\n\n          $TMPDIR\n          $TMP\n          $TEMP\n          \"C:\\TEMP\"     (windows only)\n          \"SYS:\\TMP\"    (netware only)\n          \"/tmp\"\n          \"/var/tmp\"\n          \"/usr/tmp\"\n          P_tmpdir      (POSIX define)\n          `pwd`\n\n       NOTE: This algorithm is basically the same one used by Python\n       2.2's tempfile.py module.  */\n\n    /* Try the environment first. */"}, {"count": 2, "tags": [], "text": "That code is specific to 2.2, with 2.4 you can configure it using Mutex:\n\nhttps://httpd.apache.org/docs/2.4/mod/core.html#mutex\n\n\"Mutex fcgid-pipe ...\" and \"Mutex fcgid-proctbl ...\"", "attachment_id": null, "bug_id": 55790, "id": 202633, "time": "2017-12-08T10:33:59Z", "creator": "jorton@redhat.com", "creation_time": "2017-12-08T10:33:59Z", "is_private": false}]