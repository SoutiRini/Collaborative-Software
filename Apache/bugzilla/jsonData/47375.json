[{"count": 0, "tags": [], "creator": "sujikin@gmail.com", "is_private": false, "text": "Created attachment 23817\nThe xls file created by test code\n\nThe hyperlink created by POI for inter-sheet and file does not work. The same\ncode work fine for XSSF. Below is the test code.\n\n\npublic class HyperLinkTest extends TestCase {\n\n\tpublic void testClone() throws FileNotFoundException, IOException {\n\t\tHSSFWorkbook wb = new HSSFWorkbook(); // or new HSSFWorkbook();\n\t\tCreationHelper createHelper = wb.getCreationHelper();\n\n\t\t// cell style for hyperlinks\n\t\t// by default hypelrinks are blue and underlined\n\t\tCellStyle hlink_style = wb.createCellStyle();\n\t\tFont hlink_font = wb.createFont();\n\t\thlink_font.setUnderline(Font.U_SINGLE);\n\t\thlink_font.setColor(IndexedColors.BLUE.getIndex());\n\t\thlink_style.setFont(hlink_font);\n\n\t\tCell cell;\n\t\tSheet sheet = wb.createSheet(\"Hyperlinks\");\n\t\t// URL\n\t\tcell = sheet.createRow(0).createCell((short) 0);\n\t\tcell.setCellValue(\"URL Link\");\n\n\t\tHyperlink link = createHelper.createHyperlink(Hyperlink.LINK_URL);\n\t\tlink.setAddress(\"http://poi.apache.org/\");\n\t\tcell.setHyperlink(link);\n\t\tcell.setCellStyle(hlink_style);\n\n\t\t// link to a file in the current directory\n\t\tcell = sheet.createRow(1).createCell((short) 0);\n\t\tcell.setCellValue(\"File Link\");\n\t\tlink = createHelper.createHyperlink(Hyperlink.LINK_FILE);\n\t\tlink.setAddress(\"link1.xls\");\n\t\tcell.setHyperlink(link);\n\t\tcell.setCellStyle(hlink_style);\n\n\t\t// e-mail link\n\t\tcell = sheet.createRow(2).createCell((short) 0);\n\t\tcell.setCellValue(\"Email Link\");\n\t\tlink = createHelper.createHyperlink(Hyperlink.LINK_EMAIL);\n\t\t// note, if subject contains white spaces, make sure they are\n\t\t// url-encoded\n\t\tlink.setAddress(\"mailto:poi@apache.org?subject=Hyperlinks\");\n\t\tcell.setHyperlink(link);\n\t\tcell.setCellStyle(hlink_style);\n\n\t\t// link to a place in this workbook\n\n\t\t// create a target sheet and cell\n\t\tSheet sheet2 = wb.createSheet(\"Target Sheet\");\n\t\tsheet2.createRow(0).createCell((short) 0).setCellValue(\"Target Cell\");\n\n\t\tcell = sheet.createRow(3).createCell((short) 0);\n\t\tcell.setCellValue(\"Worksheet Link\");\n\t\tHyperlink link2 = createHelper.createHyperlink(Hyperlink.LINK_DOCUMENT);\n\t\tlink2.setAddress(\"'Target Sheet'!A1\");\n\t\tcell.setHyperlink(link2);\n\t\tcell.setCellStyle(hlink_style);\n\n\t\tFileOutputStream out = new FileOutputStream(\"hyperinks.xls\");\n\t\twb.write(out);\n\t\tout.close();\n\t}\n}", "id": 127986, "time": "2009-06-16T11:24:42Z", "bug_id": 47375, "creation_time": "2009-06-16T11:24:42Z", "attachment_id": 23817}, {"count": 1, "tags": [], "text": "Fixed in 786442. The regression was caused by r719546 committed in November 2008. \n\nThanks,\nYegor", "is_private": false, "id": 128078, "creator": "yegor@dinom.ru", "time": "2009-06-19T03:45:26Z", "bug_id": 47375, "creation_time": "2009-06-19T03:45:26Z", "attachment_id": null}]