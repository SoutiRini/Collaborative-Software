[{"count": 0, "tags": [], "bug_id": 46515, "attachment_id": null, "id": 123968, "time": "2009-01-12T13:23:30Z", "creator": "laird.trimble@gmail.com", "creation_time": "2009-01-12T13:23:30Z", "is_private": false, "text": "I have a workbook with two sheets.  The first sheet has one checkbox control on it.  The second sheet is empty.\n\nWhen I use POI to add an image to the empty spreadsheet, it corrupts the appearence of the checkbox in the first sheet.  \n\nThis behavior happens with 2.2-Final and the latest build that I could get, poi-3.5-beta4-20081217.jar.\n\nThe code that I use is shown below:\n\n            FileInputStream input = new FileInputStream(new File(templatePath));\n            POIFSFileSystem fs = new POIFSFileSystem(input);\n            wb = new HSSFWorkbook(fs);\n\n            // Get structure from webservice\n            String urlString = \"http://urlpath/etc);\n            URL structURL = new URL(urlString);\n            BufferedImage bimage = ImageIO.read(structURL);\n\n            // Convert BufferedImage to byte[]\n            ByteArrayOutputStream imageBAOS = new ByteArrayOutputStream();\n            ImageIO.write(bimage, \"jpeg\", imageBAOS);\n            imageBAOS.flush();\n            byte[]imageBytes = imageBAOS.toByteArray();\n            imageBAOS.close();\n\n            // Pop structure into Structure HSSFSheet\n            int pict = wb.addPicture(imageBytes, HSSFWorkbook.PICTURE_TYPE_JPEG);\n            HSSFPatriarch patriarch = wb.getSheet(\"Structure\").createDrawingPatriarch();\n            HSSFClientAnchor anchor = new HSSFClientAnchor(0, 0, 0, 0, (short) 1, 1, (short) 10, 22);\n            anchor.setAnchorType(2);\n            patriarch.createPicture(anchor, pict);\n\n            // Write out destination file\n            FileOutputStream fileOut = new FileOutputStream(destinationFile);\n            wb.write(fileOut);\n            fileOut.close();"}, {"attachment_id": 23106, "tags": [], "creator": "laird.trimble@gmail.com", "is_private": false, "count": 1, "id": 123969, "time": "2009-01-12T13:24:48Z", "bug_id": 46515, "creation_time": "2009-01-12T13:24:48Z", "text": "Created attachment 23106\nImput xls file\n\nThis is the input file used to demostrate this bug"}, {"count": 2, "tags": [], "bug_id": 46515, "attachment_id": 23107, "id": 123970, "time": "2009-01-12T13:26:12Z", "creator": "laird.trimble@gmail.com", "creation_time": "2009-01-12T13:26:12Z", "is_private": false, "text": "Created attachment 23107\nOutput file showing error\n\nThis is the output file with the munged checkbox on the first sheet."}, {"count": 3, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "text": "I could not reproduce this any more on 3.13/trunk so I think this is fixed in the meantime.", "id": 185523, "time": "2015-09-29T07:46:18Z", "bug_id": 46515, "creation_time": "2015-09-29T07:46:18Z", "is_private": false}]