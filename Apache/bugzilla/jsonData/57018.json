[{"count": 0, "tags": [], "creator": "rajeshwaran.n@chain-sys.com", "attachment_id": null, "text": "I am using POI XSSF for reading the xlsx file, I have the problem in reading the decimal values. For ex, value in sheet 34.56012 but returns as 34.560100234 for some specific values. Any solution for the problem could be appreciated!!..", "id": 178098, "time": "2014-09-25T06:27:54Z", "bug_id": 57018, "creation_time": "2014-09-25T06:27:54Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 57018, "attachment_id": null, "id": 178099, "time": "2014-09-25T06:59:42Z", "creator": "apache@gagravarr.org", "creation_time": "2014-09-25T06:59:42Z", "is_private": false, "text": "How are you fetching the cell values, and what formatting are you applying to them?"}, {"count": 2, "tags": [], "bug_id": 57018, "attachment_id": 32054, "id": 178100, "time": "2014-09-25T07:32:35Z", "creator": "rajeshwaran.n@chain-sys.com", "creation_time": "2014-09-25T07:32:35Z", "is_private": false, "text": "Created attachment 32054\nMyXSSFSheetHandler"}, {"count": 3, "tags": [], "bug_id": 57018, "attachment_id": null, "id": 178101, "time": "2014-09-25T07:33:19Z", "creator": "rajeshwaran.n@chain-sys.com", "creation_time": "2014-09-25T07:33:19Z", "is_private": false, "text": "public ArrayList<ArrayList<String>> getSheetData() throws IOException,\n\t\t\tOpenXML4JException, ParserConfigurationException, SAXException {\n\tOPCPackage xlsxPackage = OPCPackage.open(fileName, PackageAccess.READ);\n\tArrayList<ArrayList<String>> sheetData = new ArrayList<ArrayList<String>>();\n\tReadonlySharedStringsTable strings = new ReadonlySharedStringsTable(\n\t\txlsxPackage);\n\tXSSFReader xssfReader = new XSSFReader(xlsxPackage);\n\tStylesTable styles = xssfReader.getStylesTable();\n\tXSSFReader.SheetIterator iter = (XSSFReader.SheetIterator) xssfReader\n\t\t.getSheetsData();\n\tint index = 0;\n\tif (iter.hasNext()) {\n\t\tInputStream stream = iter.next();\n\t\tString sheetName = iter.getSheetName();\n\t\tthis.output.println();\n\t\tthis.output.println(sheetName + \" [index=\" + index + \"]:\");\n\t\tsheetData = processSheet(styles, strings, stream);\n\t\tstream.close();\n\t\t++index;\n\t}\n\treturn sheetData;\n}\n\n\npublic ArrayList<ArrayList<String>> processSheet(StylesTable styles,\n\t\tReadonlySharedStringsTable strings, InputStream sheetInputStream)\n\t\tthrows IOException, ParserConfigurationException, SAXException {\n\n\tInputSource sheetSource = new InputSource(sheetInputStream);\n\tSAXParserFactory saxFactory = SAXParserFactory.newInstance();\n\tSAXParser saxParser = saxFactory.newSAXParser();\n\tXMLReader sheetParser = saxParser.getXMLReader();\t\t\n\tContentHandler handler = new MyXSSFSheetHandler(styles, strings,\n\t\t\tthis.minColumns, this.output);\n\tsheetParser.setContentHandler(handler);\n\tsheetParser.parse(sheetSource);\n\treturn ((MyXSSFSheetHandler) handler).getData();\n}\n\nUsed this logic to read the data"}, {"count": 4, "tags": [], "creator": "apache@gagravarr.org", "is_private": false, "text": "What's the format string that Excel thinks is applied to the cell, and what is the one that POI sees? And what's the raw number stored by Excel in the file?", "id": 178102, "time": "2014-09-25T07:53:09Z", "bug_id": 57018, "creation_time": "2014-09-25T07:53:09Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 57018, "text": "Created attachment 32056\nxlsx file used to read", "id": 178107, "time": "2014-09-25T09:47:27Z", "creator": "rajeshwaran.n@chain-sys.com", "creation_time": "2014-09-25T09:47:27Z", "is_private": false, "attachment_id": 32056}, {"count": 6, "tags": [], "bug_id": 57018, "is_private": false, "id": 178108, "attachment_id": null, "creator": "rajeshwaran.n@chain-sys.com", "creation_time": "2014-09-25T09:49:32Z", "time": "2014-09-25T09:49:32Z", "text": "There is no format applied in cell of the sheet as well as POI while reading the data."}, {"count": 7, "tags": [], "bug_id": 57018, "attachment_id": null, "id": 178114, "time": "2014-09-25T15:05:42Z", "creator": "apache@gagravarr.org", "creation_time": "2014-09-25T15:05:42Z", "is_private": false, "text": "If you don't set any formatting, you'll just get the raw number as stored by Excel\n\nIf you want formatting rules to apply to a cell, you need to set a cell style that includes them!"}]