[{"count": 0, "tags": [], "text": "It would be good to have the worker name added - when it applies to all log entries. The appended patch tries a stab on it for jk_ajp_common.c", "attachment_id": null, "id": 176652, "creator": "knobi@knobisoft.de", "time": "2014-07-24T14:43:16Z", "bug_id": 56770, "creation_time": "2014-07-24T14:43:16Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 56770, "attachment_id": 31846, "is_private": false, "id": 176653, "time": "2014-07-24T14:49:19Z", "creator": "knobi@knobisoft.de", "creation_time": "2014-07-24T14:49:19Z", "text": "Created attachment 31846\nPatch to add worker name"}, {"count": 2, "tags": [], "creator": "knobi@knobisoft.de", "is_private": false, "id": 176654, "attachment_id": 31847, "bug_id": 56770, "creation_time": "2014-07-24T14:50:00Z", "time": "2014-07-24T14:50:00Z", "text": "Created attachment 31847\nPatched source file"}, {"count": 3, "attachment_id": null, "bug_id": 56770, "is_private": false, "id": 176663, "time": "2014-07-24T16:29:03Z", "creator": "chris@christopherschultz.net", "creation_time": "2014-07-24T16:29:03Z", "tags": [], "text": "Is there a reason you moved the call to ajp_update_stats from after the log to before it?"}, {"count": 4, "tags": [], "creator": "chris@christopherschultz.net", "attachment_id": 31847, "id": 176664, "time": "2014-07-24T16:30:45Z", "bug_id": 56770, "creation_time": "2014-07-24T16:30:45Z", "is_private": false, "text": "Comment on attachment 31847\nPatched source file\n\nMarking patched file as obsolete because it is redundant: the patch itself is sufficient."}, {"count": 5, "tags": [], "text": "Hi Christopher,\n\n you are talking about this hunk?\n\n@@ -2704,13 +2726,13 @@\n          */\n         ajp_next_connection(p, l);\n     }\n+    ajp_update_stats(e, aw, rc, l);\n     /* Log the error only once per failed request.\n      */\n     jk_log(l, JK_LOG_ERROR,\n-           \"(%s) connecting to tomcat failed.\",\n-           aw->name);\n+           \"(%s) connecting to tomcat failed (rc=%d, errors=%d, client_errors=%d).\",\n+           aw->name,rc,aw->s->errors,aw->s->client_errors);\n \n-    ajp_update_stats(e, aw, rc, l);\n     JK_TRACE_EXIT(l);\n     return rc;\n\nSorry for not mentioning it in the description. The explanation is simple.\n\nBefore the addition of the rc/errors/client_errors fields to the log it did not matter where the call to update_stats occurred relative to the logging. Now we want to display the updated numbers - at least I think so, therefore the call to update_stats needs to happen before the logging.\n\nCheers\nMartin", "is_private": false, "id": 176679, "creator": "knobi@knobisoft.de", "time": "2014-07-25T06:30:26Z", "bug_id": 56770, "creation_time": "2014-07-25T06:30:26Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 56770, "attachment_id": null, "id": 179917, "time": "2014-12-21T15:48:16Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2014-12-21T15:48:16Z", "is_private": false, "text": "I have added the patch with minor formatting changes in r1647159, it will be part of mod_jk 1.2.41.\nThanks again for your contribution!\nRainer"}]