[{"count": 0, "tags": [], "bug_id": 43161, "text": "hey!\n\nimho, there are some incorrectness in the construction of the DIB header:\n\n\" //Specifies the size, in bytes, of the bitmap file.\n        LittleEndian.putInt(header, 2, data.length); //DIB length including \nthe header\"\n\nwell, if it specifies the size of the file including the header then it should \nbe something like:\nLittleEndian.putInt(header, 2, data.length + header.lenght); \n\n\"//the offset, in bytes, from the header to the bitmap bits (looks like it is \nalways 2)\n        LittleEndian.putInt(header, 10, 2);\"\n\nthe size of the header is 14 bytes, so this field should be at least 14 (this \nis the basic header, almost in all DIB's there are another header following \nthis one, but I don't know should it be here or not...) so if you use only \nthis header, this fiels should be exactly 14.\n\nhope this info will be useful.\n\nmike.", "id": 106884, "time": "2007-08-18T04:38:48Z", "creator": "michael.vilensky@gmail.com", "creation_time": "2007-08-18T04:38:48Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 43161, "attachment_id": null, "text": "I am experiencing the same issue with version 3.6 (poi-scratchpad-3.6-20091214.jar).\n\nAttaching here a modified org.apache.poi.hslf.blip.DIB code\nBasically the current function getData() adds a proper header. I made a small modification to produce the correct header values and renamed the function to addBMPHeader(). I then created a wrapper so the original getData() is intact.\n\nI exposed addBMPHeader() as a separate public static method, because there are other cases where you need to append a header to the raw DIB information stored in the OLE2 stream. For example in Excel tables.\n\nI will attach the test case for this situation.", "id": 134449, "time": "2010-02-12T06:34:30Z", "creator": "ih.ng@databrokers.net", "creation_time": "2010-02-12T06:34:30Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 43161, "attachment_id": 24974, "text": "Created attachment 24974\nChanges in org.apache.poi.hslf.blip.DIB to fix the issue", "id": 134450, "time": "2010-02-12T06:37:46Z", "creator": "ih.ng@databrokers.net", "creation_time": "2010-02-12T06:37:46Z", "is_private": false}, {"count": 3, "tags": [], "text": "Patch applied in r949483.\n\nThanks,\nYegor", "attachment_id": null, "id": 137211, "creator": "yegor@dinom.ru", "time": "2010-05-30T02:58:06Z", "bug_id": 43161, "creation_time": "2010-05-30T02:58:06Z", "is_private": false}]