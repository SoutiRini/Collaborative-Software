[{"attachment_id": 27349, "tags": [], "bug_id": 51616, "text": "Created attachment 27349\nProgram to create a file with an auto filter.\n\nI create a HSSFWorkbook with a sheet. I want to specify that each of the column headings be in an auto-filter. (I would do this manually in Excel by Selecting Row 1, Data -> Filter -> Auto Filter). I issue the code to set the auto filter.\n\nWhen I open the resulting XLS file using Excel 2003, the new file validation plugin provides the error message:\nOffice File Validation detected a problem while trying to open this file. Opening it may be dangerous.\n\nIf I ignore the error, and open the document anyway, the filter is valid.\n\nIf I rebuild the file and don't include the filter in the new version, it opens without warning message by Excel.\n\nTherefore, there's something that POI is doing with auto filters that the Microsoft Plugin does not like.\n\n(If I do a save as in Excel with the filter and save the document, when I reopen it, the filter is still there and there is no warning).\n\nI have attached a demo program to create a document in XLS and XLSX format. The XLS document makes Excel 2003 complain. The XLSX document opens fine in 2003.", "count": 0, "id": 148391, "time": "2011-08-04T19:22:03Z", "creator": "robert_kish@yahoo.com", "creation_time": "2011-08-04T19:22:03Z", "is_private": false}, {"count": 1, "tags": [], "creator": "robert_kish@yahoo.com", "text": "Created attachment 27350\nUpdated program to create file with auto filter and HSSFListener record dumps.\n\nI have a program that implements HSSFListener to produce a dump of the records. \n\ntest1 dumped.txt contains file with a filter.\ntest1x dumped.txt contains file with a filter, after Excel did a save as.\n\ntest2 dumped.txt contains file without a filter.\ntest2x dumped.txt contains file without a filter, after Excel did a save as.\n\nPerhaps comparing test1 dumped.txt vs test2 dumped.txt will show all that POI does when setting auto filter.\n\nPerhaps comparing test1 dumped.txt vs test1x dumped.txt will show what Excel does to rewrite a POI document with the same content. The closer that POI comes to creating this type of document, the more likely it is that Excel's plugin won't complain about the POI document on open.", "id": 148393, "time": "2011-08-04T19:50:06Z", "bug_id": 51616, "creation_time": "2011-08-04T19:50:06Z", "is_private": false, "attachment_id": 27350}, {"count": 2, "tags": [], "bug_id": 51616, "attachment_id": null, "id": 148397, "creation_time": "2011-08-05T07:33:40Z", "time": "2011-08-05T07:33:40Z", "creator": "yegor@dinom.ru", "text": "A similar issue has been recently reported and fixed:\nhttps://issues.apache.org/bugzilla/show_bug.cgi?id=51481\n\nIs the problem reproducible with the latest build from trunk? \n\nYegor\n\n(In reply to comment #1)\n> Created attachment 27350 [details]\n> Updated program to create file with auto filter and HSSFListener record dumps.\n> \n> I have a program that implements HSSFListener to produce a dump of the records. \n> \n> test1 dumped.txt contains file with a filter.\n> test1x dumped.txt contains file with a filter, after Excel did a save as.\n> \n> test2 dumped.txt contains file without a filter.\n> test2x dumped.txt contains file without a filter, after Excel did a save as.\n> \n> Perhaps comparing test1 dumped.txt vs test2 dumped.txt will show all that POI\n> does when setting auto filter.\n> \n> Perhaps comparing test1 dumped.txt vs test1x dumped.txt will show what Excel\n> does to rewrite a POI document with the same content. The closer that POI comes\n> to creating this type of document, the more likely it is that Excel's plugin\n> won't complain about the POI document on open.", "is_private": false}, {"count": 3, "tags": [], "text": "(In reply to comment #2)\n> A similar issue has been recently reported and fixed:\n> https://issues.apache.org/bugzilla/show_bug.cgi?id=51481\n> \n> Is the problem reproducible with the latest build from trunk? \n> \n> Yegor\n\n\nI hadn't considered trying the trunk. I learned how to download and compile it today. The issue has been corrected. Please close this ticket then.\n\nThanks.", "attachment_id": null, "id": 148510, "creation_time": "2011-08-09T15:52:46Z", "time": "2011-08-09T15:52:46Z", "creator": "robert_kish@yahoo.com", "bug_id": 51616, "is_private": false}]