[{"count": 0, "tags": [], "text": "Child process infinite loop / 100% CPU under heavy load\n\nThe process is stuck inside read()\n\nTrace:\n\n#0 0x0000003adf20cc8b in read () from /lib64/libpthread.so.0\n#1 0x0000000000565c47 in ap_mpm_pod_check (pod=<value optimized out>) at pod.c:54\n#2 0x0000000000563d81 in child_main (child_num_arg=<value optimized out>) at worker.c:1258\n#3 0x0000000000563f21 in make_child (s=0x37efa28, slot=2) at worker.c:1341\n#4 0x0000000000563fc5 in startup_children (number_to_start=3) at worker.c:1375\n#5 0x0000000000564ce2 in ap_mpm_run (_pconf=0x37e6138, plog=<value optimized out>,\ns=0x37efa28) at worker.c:1742\n#6 0x0000000000412f77 in main (argc=1, argv=0x7fff6ef369b8) at main.c:740\n\nSystem is a CentOS release 5.5 (Final) (gcc 4.1.2, glibc 2.5, kernel 2.6.18)\n\nMachine is a dual Dual-Core AMD Opteron(tm) Processor 2214 HE (4 cores)\n\nServer version: Apache/2.2.16 (Unix)\nServer built:   Mar 25 2011 14:45:51\n\nCompiled with CFLAGS=\"-Wall -Wextra -O2 -s -march=opteron -mtune=opteron\"\n\n./configure --with-mpm=worker --disable-charset-lite --disable-include --disable-env --disable-status --disable-autoindex --disable-asis --disable-cgi --disable-negotiation --disable-imagemap --disable-actions --disable-userdir --disable-alias --disable-so --enable-deflate --enable-headers --with-included-apr\n\nWorker config is the following:\n\n<IfModule worker.c>\n  ThreadLimit         300\n  StartServers        5\n  MaxClients          512\n  MinSpareThreads     50\n  MaxSpareThreads     100\n  ThreadsPerChild     32\n  MaxRequestsPerChild 0\n  MaxMemFree              500000\n</IfModule>", "attachment_id": null, "bug_id": 50974, "id": 145267, "time": "2011-03-25T14:54:32Z", "creator": "danielm@buscape-inc.com", "creation_time": "2011-03-25T14:54:32Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 50974, "is_private": false, "text": "that thread isn't looping, try to find something more suspect in \"thread apply all bt\"", "id": 145269, "time": "2011-03-25T15:11:02Z", "creator": "covener@gmail.com", "creation_time": "2011-03-25T15:11:02Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 50974, "is_private": false, "text": "Hmmm, \"thread apply all bt\" helped me find a loop inside another thread I was not seeing. Thanks.", "id": 145271, "time": "2011-03-25T17:11:58Z", "creator": "danielm@buscape-inc.com", "creation_time": "2011-03-25T17:11:58Z", "attachment_id": null}]