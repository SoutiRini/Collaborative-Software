[{"count": 0, "tags": [], "bug_id": 58510, "is_private": false, "id": 185816, "attachment_id": 33190, "creator": "samir.hadzic.pro@gmail.com", "creation_time": "2015-10-20T15:02:55Z", "time": "2015-10-20T15:02:55Z", "text": "Created attachment 33190\nThe file which is causing the exception.\n\nI have a Excel 2010 file with only one cell that have a comment on it (added with a right-click on the cell).\n\nIf I copy the cell into the clipBoard (with right-click \"copy\") and then paste into my application which find the Excel format in the clipboard and extract the content.\n\nThe content is then given to a HSSFWorkbook : \nnew HSSFWorkbook(new ByteArrayInputStream(((ByteBuffer) clipboard.getContent(excelFormat)).array()));\n\nIf I have no comment, everything is fine, otherwise I have this Exception : \n\"java.lang.RuntimeException: Unexpected record type (org.apache.poi.hssf.record.NoteRecord)\n\tat org.apache.poi.hssf.record.aggregates.RowRecordsAggregate.<init>(RowRecordsAggregate.java:97)\n\tat org.apache.poi.hssf.model.InternalSheet.<init>(InternalSheet.java:217)\n\tat org.apache.poi.hssf.model.InternalSheet.createSheet(InternalSheet.java:156)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:354)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:400)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:381)\"\n\nThe file is in attachment."}, {"count": 1, "tags": [], "bug_id": 58510, "attachment_id": null, "id": 185817, "time": "2015-10-20T17:04:36Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-10-20T17:04:36Z", "is_private": false, "text": "As this is a xlsx-file, the correct class to use is XSSFWorkbook, HSSFWorkbook is for the older binary format (.xls) and won't be able to read this file."}, {"count": 2, "tags": [], "text": "Actually I've tried with XSSFWorkbook but it is not working.\n\nWhen I copy the cell into the clipboard, some formats are available. I used to get the \"Biff8\" format and it was working fine.\n\nNow this is a Excel 2010 file, and apparently XSSFWorkbook is not able to open any of these format including Biff8.\n\nFormats available when copying (XML Spreadsheet, text/rtf, cf5, cf4,cf129, Biff5 \n, Biff12, text/plain, Link,text/html, Biff8, Object Descriptor, Csv, Link Source Descriptor)\n\nI have the exception : \"org.apache.poi.POIXMLException: org.apache.poi.openxml4j.exceptions.InvalidFormatException: Package should contain a content type part [M1.13]\"", "is_private": false, "bug_id": 58510, "id": 185819, "time": "2015-10-21T09:41:08Z", "creator": "samir.hadzic.pro@gmail.com", "creation_time": "2015-10-21T09:41:08Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 58510, "attachment_id": null, "is_private": false, "id": 185831, "time": "2015-10-21T19:42:04Z", "creator": "onealj@apache.org", "creation_time": "2015-10-21T19:42:04Z", "text": "XSSFWorkbook can only open xlsx and xlsm files. HSSF can only open xls files. POI cannot read other formats such as RTF, CSV, XML, BIFF5, or BIFF12.\n\nIf you do not know the format of the workbook, but you know it is xslx/m or xls, you can use WorkbookFactory.create. If you need something that works with RTF and other formats, check out Apache Tika--though this project was designed to give a text representation of a document (useful for search engines), and might not meet your needs."}, {"count": 4, "tags": [], "bug_id": 58510, "attachment_id": null, "id": 185841, "time": "2015-10-22T06:30:34Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-10-22T06:30:34Z", "is_private": false, "text": "The file that you attached is an XLSX file. If you try to unzip it, you see the XML-Files that make up the newer XML-based format. Therefore only XSSFWorkbook will be able to read the file. \n\nI also quickly tried it and I could read the file without any issue.\n\nIf you still have issues working with the file, then please send a question with you code-snippet to the user-list, as this is the best place to discuss about how to use poi."}]