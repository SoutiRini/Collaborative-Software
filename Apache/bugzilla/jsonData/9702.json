[{"count": 0, "tags": [], "text": "Would it be possible to add StartTLS or SSL support to JNDIRealm? In theory, \nit should be relatively simple. For SSL support, you would just need to add a \nline similar to the following.\n\nh.put(Context.SECURITY_PROTOCOL, \"ssl\");\n\nFor StartTLS, you would just need something like the following.\n\nLdapContext lc = new InitialLdapContext(h, null);\n\t\t\t\nStartTlsResponse stlsr = (StartTlsResponse)lc.extendedOperation(new \nStartTlsRequest());\n\t\t\t\nstlsr.negotiate();\n\nAnd then, maybe add an attribute that you can put in your server.xml similar \nto what you have for the HTTP connector like the following.\n\nsecure=\"true\"", "is_private": false, "id": 17419, "creator": "jemiller@uchicago.edu", "time": "2002-06-07T20:00:36Z", "bug_id": 9702, "creation_time": "2002-06-07T20:00:36Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 9702, "text": "I think I have a fix for this. I have the SSL part at least (not StartTLS). \nBasically, it just adds a \"secure\" attribute. It defaults to false. If it is \nset to true, it enables SSL (modelled after the way the HTTPConnector works).\n\n<Realm className=\"org.apache.catalina.realm.JNDIRealm\"\n\tdebug=\"99\"\n\tconnectionURL=\"ldap://myldapserver:636\"\n\tsecure=\"true\"\n\tuserPattern=\"uid={0}, ou=People, dc=mydc\"\n\tuserRoleName=\"objectClass\"/>\n\nHere's the diff for it. I could probably add in StartTLS support as well. The \nonly thing that I'm unsure of is what to name the attribute so that it's clear \nto users. Maybe I could have it check a \"protocol\" attribute like the \nHTTPConnector does and if it's set to \"tls\" use StartTLS, and if it's set \nto \"ssl\" use SSL? Currently, the StartTLS implementation in JSSE has a hang \nbug that occurs with most LDAP servers, so, it may be better to wait on \nputting that in.\n\nIf this looks OK, can someone put these changes in for me?\n\nIndex: JNDIRealm.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-tomcat-\n4.0/catalina/src/share/org/apache/catalina/realm/JNDIRealm.java,v\nretrieving revision 1.8\ndiff -r1.8 JNDIRealm.java\n322a323,326\n> \t/**\n> \t * The secure connection flag.\n> \t */\n> \tprotected boolean secure = false;\n422a427,437\n> \t/**\n> \t * Set the secure connection flag.\n> \t *\n> \t * @param secure The new secure connection flag\n> \t */\n> \tpublic void setSecure(boolean secure) \n> \t{\n> \n> \t\tthis.secure = secure;\n> \n> \t}\n741c756,766\n<     /**\n---\n> \t/**\n> \t * Return the secure connection flag.  Default value is \"false\".\n> \t */\n> \tpublic boolean getSecure() \n> \t{\n> \n> \t\treturn (this.secure);\n> \n> \t}\n> \n> \t/**\n1296a1322,1323\n> \t\tif (secure == true)\n> \t\t\tenv.put(Context.SECURITY_PROTOCOL, \"ssl\");\n", "id": 17830, "attachment_id": null, "creator": "jemiller@uchicago.edu", "creation_time": "2002-06-14T23:27:33Z", "time": "2002-06-14T23:27:33Z", "is_private": false}, {"count": 2, "tags": [], "text": "Can someone add this fix for me?\n", "attachment_id": null, "id": 20374, "creator": "jemiller@uchicago.edu", "time": "2002-07-29T17:24:19Z", "bug_id": 9702, "creation_time": "2002-07-29T17:24:19Z", "is_private": false}, {"count": 3, "tags": [], "text": "Can someone please add this?\n", "attachment_id": null, "id": 24564, "creator": "jemiller@uchicago.edu", "time": "2002-10-15T17:21:01Z", "bug_id": 9702, "creation_time": "2002-10-15T17:21:01Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 9702, "text": "Enhancement added.  ", "id": 26117, "attachment_id": null, "creator": "amyroh@apache.org", "creation_time": "2002-11-12T01:18:23Z", "time": "2002-11-12T01:18:23Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 9702, "attachment_id": null, "id": 69058, "time": "2004-12-29T15:03:50Z", "creator": "mrw@wanadoo.nl", "creation_time": "2004-12-29T15:03:50Z", "is_private": false, "text": "What is the status of StartTLS support?"}]