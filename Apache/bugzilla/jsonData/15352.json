[{"count": 0, "tags": [], "bug_id": 15352, "text": "I found this bug while using Tomcat 4.0.6 LE JDK 1.4 on Windows 2000 and \nSolaris Sparc with JDK 1.4.1_01.\n\nI am getting the following Security violation when I try to access my web \napplication that has a servlet that accesses HttpServletRequest.getParameter\n(\"currentPage\") and this is what is throwing the exception.\n\njava.security.AccessControlException: access denied\n(java.lang.RuntimePermission accessClassInPackage.org.apache.catalina.util)\n        at\njava.security.AccessControlContext.checkPermission(AccessControlContext.java\n:272)\n        at\njava.security.AccessController.checkPermission(AccessController.java:399)\n        at\njava.lang.SecurityManager.checkPermission(SecurityManager.java:545)\n        at\njava.lang.SecurityManager.checkPackageAccess(SecurityManager.java:1501)\n        at\norg.apache.catalina.loader.StandardClassLoader.loadClass(StandardClassLoader\n.java:1056)\n        at\norg.apache.catalina.loader.StandardClassLoader.loadClass(StandardClassLoader\n.java:992)\n        at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:313)\n        at\norg.apache.catalina.connector.HttpRequestBase.parseParameters(HttpRequestBas\ne.java:615)\n        at\norg.apache.catalina.connector.HttpRequestBase.getParameter(HttpRequestBase.j\nava:691)\n        at\norg.apache.catalina.connector.RequestFacade.getParameter(RequestFacade.java:\n160)\n        at com.clickndone.billerdirect.BDRouter.doPost(BDRouter.java:141)\n        at com.clickndone.billerdirect.BDRouter.doGet(BDRouter.java:106)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:740)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Application\nFilterChain.java:247)\n        at\norg.apache.catalina.core.ApplicationFilterChain.access$000(ApplicationFilter\nChain.java:98)\n        at\norg.apache.catalina.core.ApplicationFilterChain$1.run(ApplicationFilterChain\n.java:176)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterCh\nain.java:172)\n        at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.ja\nva:243)\n        at\norg.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:5\n66)\n        at\norg.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:472)\n        at\norg.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n        at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.ja\nva:190)\n        at\norg.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:5\n66)\n        at\norg.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:472)\n        at\norg.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n        at\norg.apache.catalina.core.StandardContext.invoke(StandardContext.java:2347)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:180\n)\n        at\norg.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:5\n66)\n        at\norg.apache.catalina.valves.ErrorDispatcherValve.invoke(ErrorDispatcherValve.\njava:170)\n        at\norg.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:5\n64)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:170\n)\n        at\norg.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:5\n64)\n        at\norg.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:468)\n        at\norg.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:5\n64)\n        at\norg.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:472)\n        at\norg.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java\n:174)\n        at\norg.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:5\n66)\n        at\norg.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:472)\n        at\norg.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n        at\norg.apache.catalina.connector.http.HttpProcessor.process(HttpProcessor.java:\n1027)\n        at\norg.apache.catalina.connector.http.HttpProcessor.run(HttpProcessor.java:1125\n)\n        at java.lang.Thread.run(Thread.java:484)\n\n\nI have granted the following extra permissions:\n\ngrant { \n    permission java.net.SocketPermission \"LDP2KSEN0066:1024-65535\",\n\"connect, resolve\"; \n\n    permission java.util.PropertyPermission \"https.proxyHost\", \"write\";\n    permission java.util.PropertyPermission \"https.proxyPort\", \"write\";\n    permission java.util.PropertyPermission \"java.security.policy\", \"write\";\n    permission java.util.PropertyPermission \"propertiesDirectory\", \"read\"; \n    \n    permission java.lang.RuntimePermission \"getClassLoader\";\n\n    permission java.io.FilePermission \"C:\\\\Program\nFiles\\\\Click-n-DoneServerSuite\\\\common\\\\properties\\\\-\", \"read, write\";\n    permission java.io.FilePermission \"C:\\\\Program\nFiles\\\\Click-n-DoneServerSuite\\\\WebApplications\\\\BillerListWebApp\\\\CNDBiller\nList.txt\", \"read, write\";\n    \n    permission java.io.FilePermission \"C:\\\\Program\nFiles\\\\Click-n-DoneServerSuite\\\\logs\\\\-\", \"read, write\";\n    permission java.io.FilePermission \"C:\\\\Tomcat_JDK1.3.1\\\\-\", \"read\";     \n};\n\nIf I access another web application (which has only JSPs), there is no problem. \nAlso after that if I access the first web-app also, there is no problem.  \nI also have no problem if I use Tomcat 4.0.2 LE JDK 1.4.\n\nSolution:\n\nI received help from Jeanfrancois Arcand [jfarcand@apache.org].\nI added the following permissions to catalina.policy in the section that grants \npermissions to all web applications.\n\n  // Required for sevlets and JSP's\n  permission \njava.lang.RuntimePermission \"accessClassInPackage.org.apache.catalina.util\"; \n  permission \njava.lang.RuntimePermission \"accessClassInPackage.org.apache.catalina.util.*\";\n  permission \njava.lang.RuntimePermission \"defineClassInPackage.org.apache.catalina.util\";\n  permission \njava.lang.RuntimePermission \"defineClassInPackage.org.apache.catalina.util.*\";\n  \nThis solved the problem.", "id": 27797, "time": "2002-12-13T13:36:33Z", "creator": "gshaikh@mobius.com", "creation_time": "2002-12-13T13:36:33Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "markt@apache.org", "is_private": false, "id": 53072, "attachment_id": null, "bug_id": 15352, "creation_time": "2004-02-26T23:06:43Z", "time": "2004-02-26T23:06:43Z", "text": "These permissions were added to catalina.policy in September 2002."}]