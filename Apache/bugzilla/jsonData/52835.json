[{"count": 0, "tags": [], "bug_id": 52835, "is_private": false, "id": 154556, "creation_time": "2012-03-06T04:27:53Z", "time": "2012-03-06T04:27:53Z", "creator": "zjuwufan@gmail.com", "text": "Given following shared string table,\n\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n<sst xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\"/>\n\nXSSF won't work.\n\nIt seems that we assumed that there would be 'count' and 'uniqCount' in the xml.\n\nHowever if there is no 'count' and 'uniqCount', the excel file cannot be handled successfully.\n\nFile attached.", "attachment_id": null}, {"count": 1, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "is_private": false, "id": 154562, "time": "2012-03-06T11:02:11Z", "bug_id": 52835, "creation_time": "2012-03-06T11:02:11Z", "text": "You forgot to attach the file.\n\nYegor"}, {"count": 2, "attachment_id": null, "creator": "zjuwufan@gmail.com", "is_private": false, "id": 154563, "time": "2012-03-06T12:18:40Z", "bug_id": 52835, "creation_time": "2012-03-06T12:18:40Z", "tags": [], "text": "The file is about 5MB in size, I failed to upload it. Any other way to share it with you?"}, {"text": "Please got the link by following link.\n\nhttp://dl.dropbox.com/u/29681633/cant_upload.xlsx", "tags": [], "bug_id": 52835, "attachment_id": null, "count": 3, "id": 154564, "time": "2012-03-06T12:26:14Z", "creator": "zjuwufan@gmail.com", "creation_time": "2012-03-06T12:26:14Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 52835, "text": "How was this file generated?", "id": 154573, "time": "2012-03-06T15:30:38Z", "creator": "apache@gagravarr.org", "creation_time": "2012-03-06T15:30:38Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 52835, "is_private": false, "text": "We are building product based on POI. Our user is trying to using the attached file, but failed.\n\nThe source is unknown. Do you think it's an issue?", "id": 154574, "time": "2012-03-06T15:54:35Z", "creator": "zjuwufan@gmail.com", "creation_time": "2012-03-06T15:54:35Z", "attachment_id": null}, {"text": "(In reply to comment #0)\n> Given following shared string table,\n> \n> <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n> <sst xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\"/>\n> \n> XSSF won't work.\n> \n\n\nPlease explain what is wrong with XSSF: does it throw an exception or returns wrong data or what? \n\nThe latest build from trunk can read the referenced file, navigate over data and save it back to file. I don't see anything wrong on the POI side.\n\nYegor", "tags": [], "bug_id": 52835, "is_private": false, "count": 6, "id": 154579, "time": "2012-03-06T18:19:50Z", "creator": "yegor@dinom.ru", "creation_time": "2012-03-06T18:19:50Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 52835, "is_private": false, "text": "An exception was thrown with following code.\n\nimport java.io.IOException;\nimport org.apache.poi.openxml4j.exceptions.InvalidFormatException;\nimport org.apache.poi.openxml4j.opc.OPCPackage;\nimport org.apache.poi.openxml4j.opc.PackageAccess;\nimport org.apache.poi.xssf.eventusermodel.ReadOnlySharedStringsTable;\nimport org.xml.sax.SAXException;\n\n\npublic class Test {\n\tpublic static void main(String[] args)\n\t{\n\t\ttry {\n\t\t\tOPCPackage pkg = OPCPackage.open(\"cant_upload.xlsx\", PackageAccess.READ);\n\t\t\tReadOnlySharedStringsTable table = new ReadOnlySharedStringsTable(pkg);\n\t\t} catch (InvalidFormatException e) {\n\t\t\t// TODO Auto-generated catch block\n\t\t\te.printStackTrace();\n\t\t} catch (IOException e) {\n\t\t\t// TODO Auto-generated catch block\n\t\t\te.printStackTrace();\n\t\t} catch (SAXException e) {\n\t\t\t// TODO Auto-generated catch block\n\t\t\te.printStackTrace();\n\t\t}\n\t\t\n\t}\n}", "id": 154600, "time": "2012-03-07T02:21:38Z", "creator": "zjuwufan@gmail.com", "creation_time": "2012-03-07T02:21:38Z", "attachment_id": null}, {"count": 8, "attachment_id": null, "creator": "zjuwufan@gmail.com", "is_private": false, "id": 154601, "time": "2012-03-07T02:26:32Z", "bug_id": 52835, "creation_time": "2012-03-07T02:26:32Z", "tags": [], "text": "Callstack looks like this,\n\nat java.lang.Integer.parseInt(Unknown Source)\n\tat java.lang.Integer.parseInt(Unknown Source)\n\tat org.apache.poi.xssf.eventusermodel.ReadOnlySharedStringsTable.startElement(ReadOnlySharedStringsTable.java:190)\n\tat com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startElement(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.parsers.AbstractXMLDocumentParser.emptyElement(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.impl.dtd.XMLDTDValidator.emptyElement(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$ContentDriver.scanRootElementHook(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$PrologDriver.next(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown Source)\n\tat com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(Unknown Source)\n\tat org.apache.poi.xssf.eventusermodel.ReadOnlySharedStringsTable.readFrom(ReadOnlySharedStringsTable.java:141)\n\tat org.apache.poi.xssf.eventusermodel.ReadOnlySharedStringsTable.<init>(ReadOnlySharedStringsTable.java:110)"}, {"count": 9, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "is_private": false, "id": 154791, "time": "2012-03-11T07:21:39Z", "bug_id": 52835, "creation_time": "2012-03-11T07:21:39Z", "text": "I relaxed this constraint in r1299338.\n\nWith this fix POI's eventusermodel supports parsing SST with missing Count and UniqueCount attributes. Please try the latest build from trunk.\n\nYegor"}]