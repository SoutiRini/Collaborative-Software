[{"text": "Index: java/org/apache/tomcat/util/http/res/LocalStrings.properties\n===================================================================\n--- java/org/apache/tomcat/util/http/res/LocalStrings.properties        (revision 1365543)\n+++ java/org/apache/tomcat/util/http/res/LocalStrings.properties        (working copy)\n@@ -65,6 +65,7 @@\n sc.428=Precondition Required\n sc.429=Too Many Requests\n sc.431=Request Header Fields Too Large\n+sc.451=Unavailable For Legal Reasons\n sc.500=Internal Server Error\n sc.501=Not Implemented\n sc.502=Bad Gateway\n\n\nSubmitting as enhancement instead of committing in case anyone has an objection.", "tags": [], "bug_id": 53602, "attachment_id": null, "count": 0, "id": 160900, "time": "2012-07-25T12:08:14Z", "creator": "funkman@apache.org", "creation_time": "2012-07-25T12:08:14Z", "is_private": false}, {"count": 1, "tags": [], "creator": "knst.kolinko@gmail.com", "attachment_id": null, "id": 160902, "time": "2012-07-25T12:37:41Z", "bug_id": 53602, "creation_time": "2012-07-25T12:37:41Z", "is_private": false, "text": "Link to versions of the proposal to add this new status code to HTTP\nin IETF document tracking tool:\n\nhttps://datatracker.ietf.org/doc/draft-tbray-http-legally-restricted-status/history/\n\nThe current version of the document is \"01\".\n\n\nI do not mind adding the new status code, but the comment in the LocalStrings.properties file says that the codes come from IANA page,\nhttp://www.iana.org/assignments/http-status-codes/http-status-codes.xml\n\nEither a comment should be added on where the code comes from, or we can wait until a proper RFC is issued and IANA page is updated with the new code."}, {"text": "OK to add for me. The IANA link I added to the comments wasn't meant to police other status code additions but instead to be useful for future checks. So Tim, you might want to adjust that comment as you see fit.\n\nThere are two places with HTTP status codes:\n\n    tomcat/trunk/java/org/apache/catalina/valves/LocalStrings.properties\n    tomcat/trunk/java/org/apache/tomcat/util/http/res/LocalStrings.properties\n\nYou might want to add the new one to the other list as well.\n\nRegards,\n\nRainer", "tags": [], "bug_id": 53602, "attachment_id": null, "count": 2, "id": 160903, "time": "2012-07-25T13:42:28Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2012-07-25T13:42:28Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 53602, "attachment_id": null, "text": "Wait.\n\nWhy add a status code that hasn't been approved yet?\n\nThe spec might go nowhere. Or it might be approved, but with a different status code.", "id": 160915, "time": "2012-07-26T06:41:00Z", "creator": "julian.reschke@gmx.de", "creation_time": "2012-07-26T06:41:00Z", "is_private": false}, {"count": 4, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 170069, "time": "2013-09-12T14:42:26Z", "bug_id": 53602, "creation_time": "2013-09-12T14:42:26Z", "is_private": false, "text": "This (and any other new codes) can be added once they are approved."}, {"text": "(In reply to Mark Thomas from comment #4)\n> This (and any other new codes) can be added once they are approved.\n\n+1\n\nAny webapp that wants to use code 451 (amusing code, eh?) with a response message can manually set the message until such time as Tomcat supports it (due to standards approval).", "tags": [], "bug_id": 53602, "attachment_id": null, "count": 5, "id": 170093, "time": "2013-09-13T14:19:11Z", "creator": "chris@christopherschultz.net", "creation_time": "2013-09-13T14:19:11Z", "is_private": false}, {"text": "Changing from RESOLVED LATER to REOPENED\nand moving from Tomcat 7 to Tomcat 9.\n\n(In reply to Konstantin Kolinko from comment #1)\n> I do not mind adding the new status code, but the comment in the\n> LocalStrings.properties file says that the codes come from IANA page,\n> http://www.iana.org/assignments/http-status-codes/http-status-codes.xml\n> \n> Either a comment should be added on where the code comes from, or we can\n> wait until a proper RFC is issued and IANA page is updated with the new code.\n\nThe IANA page has been updated and now lists the code 451 as assigned and links to the following draft.\n\nThe draft linked from IANA page has a different name,\nhttps://datatracker.ietf.org/doc/draft-ietf-httpbis-legally-restricted-status/\n\nIts History page says that it has been approved on 2015-12-21.\n\nApparently it has not been published as an RFC yet, but it is going to become one.\n\n\nA blog post and Wikipedia:\nhttps://www.mnot.net/blog/2015/12/18/451\nhttps://en.wikipedia.org/wiki/HTTP_451", "tags": [], "bug_id": 53602, "attachment_id": null, "count": 6, "id": 187108, "time": "2015-12-24T05:36:05Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2015-12-24T05:36:05Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 53602, "attachment_id": null, "text": "Additional info. The RFC draft\n\nhttps://datatracker.ietf.org/doc/draft-ietf-httpbis-legally-restricted-status/?include_text=1\n\nsays:\n\n   Responses using this status code SHOULD include an explanation, in\n   the response body, of the details of the legal demand: the party\n   making it, the applicable legislation or regulation, and what classes\n   of person and resource it applies to.  For example:\n\n   HTTP/1.1 451 Unavailable For Legal Reasons\n   Link: <https://spqr.example.org/legislatione>; rel=\"blocked-by\"\n   Content-Type: text/html\n\n   <html>\n    <head><title>Unavailable For Legal Reasons</title></head>\n    <body>\n     <h1>Unavailable For Legal Reasons</h1>\n     <p>This request may not be serviced in the Roman Province\n     of Judea due to the Lex Julia Majestatis, which disallows\n     access to resources hosted on servers deemed to be\n     operated by the People's Front of Judea.</p>\n    </body>\n   </html>\n\n\nAnd furthermore:\n\n   As noted above, when an attempt to access a resource fails with\n   status 451, the entity blocking access might or might not be the\n   origin server.  There are a variety of entities in the resource-\n   access path which could choose to deny access, for example ISPs,\n   cache providers, and DNS servers.\n\n   It is useful, when legal blockages occur, to be able to identify the\n   entities actually implementing the blocking.\n\n   When an entity blocks access to a resource and returns status 451, it\n   SHOULD include a \"Link\" HTTP header field [RFC5988] whose value is a\n   URI reference [RFC3986] identifying itself.  When used for this\n   purpose, the \"Link\" header field MUST have a \"rel\" parameter whose\n   value is \"blocked-by\".\n\n   The intent is that the header be used to identify the entity actually\n   implementing blockage, not any other entity mandating it.  A human\n   readable response body, as discussed above, is the appropriate\n   location for discussion of administrative and policy issues.\n\nJust in case anyone is interested in more support than simply adding status code and reason phrase.", "id": 188305, "time": "2016-02-09T15:09:04Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2016-02-09T15:09:04Z", "is_private": false}, {"count": 8, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 195836, "time": "2017-01-03T20:19:30Z", "bug_id": 53602, "creation_time": "2017-01-03T20:19:30Z", "is_private": false, "text": "Fixed in:\n- trunk for 9.0.0.M16 onwards\n- 8.5.x for 8.5.10 onwards\n- 8.0.x for 8.0.40 onwards\n- 7.0.x for 7.0.74 onwards"}]