[{"count": 0, "tags": [], "creator": "silvano_lutri@it.ibm.com", "attachment_id": null, "id": 146402, "time": "2011-05-18T09:32:44Z", "bug_id": 51216, "creation_time": "2011-05-18T09:32:44Z", "is_private": false, "text": "I run a .sh script using sudo that invokes Ant. It copies file and run chmod on them.\nWhen it arrives to the chmod task it hangs.\n\nHere a subset of my Ant script:\n-----------------------------------------------------------------------------\n<project name=\"CustomizeSQLScripts\" default=\"everything\" basedir=\".\">\n\t<description>\n\t\tThis build file is used to customize the sql scripts used to create the database\n\t</description>\n\n    <property name=\"src\" location=\".\"/>\n\n    <target name=\"createDBtools_DB2\" description=\"The target to create in the temp dir the structure of the DB tools when using DB2\">\n        <mkdir dir=\"${TWSTEMPDIR}/scripts\"/>\n        <copy file=\"${DBSETUPSCRIPT}\" todir=\"${TWSTEMPDIR}/scripts\" overwrite=\"true\"/>\n        <mkdir dir=\"${TWSTEMPDIR}/sql\"/>\n        <chmod dir=\"${TWSTEMPDIR}/scripts\" perm=\"755\" includes=\"**/*\"/>\n        <chmod dir=\"${TWSTEMPDIR}/sql\" perm=\"755\" includes=\"**/*\"/>\n    </target>\n\n    <target name=\"customize_migratedb_root_sh\" description=\"The target to customize the launching script used to migrate the database on Unix\">\n        <filter token=\"DB2LOCALADMINUSER\" value=\"${DB2LOCALADMINUSER}\"/>\n        <filter token=\"TWSTEMPDIR\" value=\"${TWSTEMPDIR}\"/>\n        <copy tofile=\"${TWSTEMPDIR}/scripts/migratedb_root.sh\" filtering=\"true\" overwrite=\"true\">\n            <fileset dir=\"${src}\">\n                <filename name=\"_migratedb_root.sh\"/>\n            </fileset>\n        </copy>\n        <copy file=\"dbupgrade.sh\" todir=\"${TWSTEMPDIR}/scripts\" overwrite=\"true\"/>\n        <copy file=\"dbmigrate.sh\" todir=\"${TWSTEMPDIR}/scripts\" overwrite=\"true\"/>\n        <chmod file=\"${TWSTEMPDIR}/scripts/migratedb_root.sh\" perm=\"755\"/>\n        <chmod file=\"${TWSTEMPDIR}/scripts/dbupgrade.sh\" perm=\"755\"/>\n        <chmod file=\"${TWSTEMPDIR}/scripts/dbmigrate.sh\" perm=\"755\"/>\n    </target>\n\n\n    <target name=\"everything\"\n\t\tdepends=\"createDBtools_DB2,\n                 customize_migratedb_root_sh\"\n\t\tdescription=\"The default target\">\n    </target>\n\n</project>\n\n\nAnd here the output of Ant executed in debug mode:\n----------------------------------------------------------------------------\n > sudo ./commandToRun.sh                                  \n\n                                                                         \n\n               Apache Ant version 1.6.2 compiled on July 16 2004         \n\n                                                                         \n\n               Buildfile:                                                \n\n               /software/TWS/8.5.1/TWS/AIX/./../AIX/tws_tools/customizeS \n\n               QLScripts4upgrade84.xml                                   \n\n                                                                         \n\n               Detected Java version: 1.4 in:                            \n\n               /tmp/istemp3538996112160829/_bundledJRE_                  \n\n                                                                         \n\n               Detected OS: AIX                                          \n\n                                                                         \n\n               parsing buildfile                                         \n\n               /software/TWS/8.5.1/TWS/AIX/tws_tools/customizeSQLScripts \n\n               4upgrade84.xml with URI =                                 \n\n               file:///software/TWS/8.5.1/TWS/AIX/tws_tools/customizeSQL \n\n               Scripts4upgrade84.xml                                     \n\n                                                                         \n\n               Project base dir set to:                                  \n\n               /software/TWS/8.5.1/TWS/AIX/tws_tools                     \n\n                                                                         \n\n               Build sequence for target `everything' is                 \n\n               [detectCurrentOSFamily, defineOSSpecificPlatformFlag,     \n\n               define_db_use, define_db2Win, define_db2Unix,             \n\n               define_oracleWin, define_oracleUnix, createDBtools_DB2,   \n\n               createDBtools_Oracle, customize_migratedb_root_bat,       \n\n               customize_migratedb_root_oracle_bat,                      \n\n               customize_migratedb_root_sh,                              \n\n               customize_migratedb_root_oracle_sh, customizeSQL,         \n\n               customizeOracleSQL, chmodSqlDir, chmodSqlStdedDir,        \n\n               everything]                                               \n\n                                                                         \n\n               Complete build sequence is [detectCurrentOSFamily,        \n\n               defineOSSpecificPlatformFlag, define_db_use,              \n\n               define_db2Win, define_db2Unix, define_oracleWin,          \n\n               define_oracleUnix, createDBtools_DB2,                     \n\n               createDBtools_Oracle, customize_migratedb_root_bat,       \n\n               customize_migratedb_root_oracle_bat,                      \n\n               customize_migratedb_root_sh,                              \n\n               customize_migratedb_root_oracle_sh, customizeSQL,         \n\n               customizeOracleSQL, chmodSqlDir, chmodSqlStdedDir,        \n\n               everything, ]                                             \n\n                                                                         \n\n                                                                         \n\n                                                                         \n\n               detectCurrentOSFamily:                                    \n\n                                                                         \n\n                                                                         \n\n                                                                         \n\n               defineOSSpecificPlatformFlag:                             \n\n                                                                         \n\n                                                                         \n\n                                                                         \n\n               define_db_use:                                            \n\n                                                                         \n\n                                                                         \n\n                                                                         \n\n               define_db2Win:                                            \n\n                                                                         \n\n               Property ${isWindows} has not been set                    \n\n                                                                         \n\n                                                                         \n\n                                                                         \n\n               define_db2Unix:                                           \n\n                                                                         \n\n                                                                         \n\n                                                                         \n\n               define_oracleWin:                                         \n\n                                                                         \n\n               Property ${isWindows} has not been set                    \n\n                                                                         \n\n               Property ${DB_ORACLE} has not been set                    \n\n                                                                         \n\n                                                                         \n\n                                                                         \n\n               define_oracleUnix:                                        \n\n                                                                         \n\n               Property ${DB_ORACLE} has not been set                    \n\n                                                                         \n\n                                                                         \n\n                                                                         \n\n               createDBtools_DB2:                                        \n\n                                                                         \n\n                    [copy] Copying 1 file to /tmp/TWA/tws851/scripts     \n\n                                                                         \n\n                    [copy] Copying                                       \n\n               /software/TWS/8.5.1/TWS/AIX/tws_tools/dbmigrate.sh to     \n\n               /tmp/TWA/tws851/scripts/dbmigrate.sh                      \n\n                                                                         \n\n                   [chmod] Current OS is AIX                             \n\n                                                                         \n\n                   [chmod] Executing 'chmod' with arguments:             \n\n                                                                         \n\n                   [chmod] '755'                                         \n\n                                                                         \n\n                   [chmod] '/tmp/TWA/tws851/scripts/dbmigrate.sh'        \n\n                                                                         \n\n                   [chmod] '/tmp/TWA/tws851/scripts/dbupgrade.sh'        \n\n                                                                         \n\n                   [chmod] '/tmp/TWA/tws851/scripts/migratedb_root.sh'   \n\n                                                                         \n\n                   [chmod]                                               \n\n                                                                         \n\n                   [chmod] The ' characters around the executable and    \n\n               arguments are                                             \n\n                                                                         \n\n                   [chmod] not part of the command.                      \n--------------------------------------------------------------------------\nAfter this the script hangs."}, {"count": 1, "attachment_id": null, "creator": "silvano_lutri@it.ibm.com", "text": "Anyone took a look to this?", "id": 150757, "time": "2011-10-19T11:33:10Z", "bug_id": 51216, "creation_time": "2011-10-19T11:33:10Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "text": "Do you have a minimal test case? Thread dump?", "is_private": false, "bug_id": 51216, "id": 152930, "time": "2012-01-19T14:34:19Z", "creator": "jglick@apache.org", "creation_time": "2012-01-19T14:34:19Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "silvano_lutri@it.ibm.com", "text": "Hello and thanks for the update.\nI would like to underline that the problem is reproduced only on one specific machine, and that I solved it changing the task from <chmod> to the native\n<exec executable=\"chmod\">.\nOn that machine also a small build.xml file that includes only one\ntarget with only one copy file and the chmod of the same file is hanging\n(at the chmod). The Ant task is executed via sudo.\n\nI don't have a thread dump of the problem.\nCould the problem be related to some specific configuration of the AIX machine?\n\nSilvano", "id": 153092, "time": "2012-01-24T09:46:42Z", "bug_id": 51216, "creation_time": "2012-01-24T09:46:42Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "jglick@apache.org", "text": "Sounds likely to be OS-specific.", "id": 153100, "attachment_id": null, "bug_id": 51216, "creation_time": "2012-01-24T12:23:10Z", "time": "2012-01-24T12:23:10Z", "is_private": false}]