[{"count": 0, "attachment_id": 32755, "bug_id": 57949, "is_private": false, "id": 183103, "time": "2015-05-25T13:47:40Z", "creator": "ghetolay@gmail.com", "creation_time": "2015-05-25T13:47:40Z", "tags": [], "text": "Created attachment 32755\npatch\n\nHi,\n\nI've created a new environment variable in order to test for an extended key usage into a certificate. Like clientAuth on a client certificate authentication for instance. This variable can then be used on a Require directive as follow : \n\nRequire expr %{SSL_CLIENT_EXT_KEYUSAGE_clientAuth} == \"true\"\n\nFormat of the variable name is as follow : \n\nSSL_{CLIENT|SERVER}_EXT_KEYUSAGE_purpose \n\nWhere purpose is either a shortname ( serverAuth, clientAuth etc...) or an oid. Shortname are case insensitive and '.' on oid must be replace with '_'.\nHere is some valid examples : \n\nSSL_CLIENT_EXT_KEYUSAGE_clientAuth \nSSL_SERVER_EXT_KEYUSAGE_SERVERAUTH\nSSL_CLIENT_EXT_KEYUSAGE_1_3_6_1_5_5_7_3_2\n\nWe may improve the comparison of oid by checking each number one by one instead of converting both var (replace '_' by '.') and obj (convert into char*) and do a strcmp. But I'm not sure if openssl offers another way to get oid other than OBJ_obj2txt(). \n\nWe may also add the export of all the purpose as variable when +StdEnvVars is set on SSLOptions.\n\nPlease feel free to give me any feedback about code, patch, documentation etc..."}]