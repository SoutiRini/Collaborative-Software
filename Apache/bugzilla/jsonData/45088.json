[{"count": 0, "tags": [], "bug_id": 45088, "text": "Created attachment 22024\ntest.ppt\n\nAm using a pre-release version of scratchpad (although I think it also happens with previous versions)\n\nUsing version poi-scratchpad-3.1-beta2-20080526\n\nCalling changeTextInRichTextRun renders the output presentation corrupt. Have tried to open with Microsoft Office Powerpoint 2003 and 2007. The reason I'm trying to use rich text runs, is to prevent the formating of the text being erased, which is happening when I call setText on the TextRun. Here's the code...\n\n    public static void main(String[] args) {\n\tdoPowerpoint();\n    }\n\n    private static void doPowerpoint() {\n\ttry {\n\t    SlideShow ppt = new SlideShow(new HSLFSlideShow(\"./src/main/resources/test.ppt\"));\n\t    Slide[] slides = ppt.getSlides();\n\t    for (int i = 0; i < slides.length; i++) {\n\t\tSystem.out.println(\"checking slide \" + i);\n\t\tTextRun[] text = slides[i].getTextRuns();\n\n\t\touter: for (int j = 0; j < text.length; j++) {\n\t\t    System.out.println(\" checking text \" + j);\n\t\t    RichTextRun[] richText = text[j].getRichTextRuns();\n\t\t    for (int k = 0; k < richText.length; k++) {\n\t\t\tSystem.out.println(\"  checking rich text \" + k);\n\t\t\tString sText = richText[k].getText();\n\t\t\tif (sText != null && sText.contains(\"[SYSDATE]\")) {\n\t\t\t    String replacedText = sText.replace(\"[SYSDATE]\", \"REPLACED_DATE_WITH_A_LONG_ONE\");\n\t\t\t    text[j].changeTextInRichTextRun(richText[k], replacedText);\n\t\t\t    text[j].ensureStyleAtomPresent();\n\t\t\t    System.out.println(\"replaced date!\" + richText[k].getRawText());\n\t\t\t    continue outer;\n\t\t\t}\n\t\t    }\n\t\t}\n\t    }\n\t    writeFile(ppt);\n\n\t} catch (Exception e) {\n\t    e.printStackTrace();\n\t    System.out.println(\"Problem with slide show \" + e.getMessage());\n\t}\n    }\n    \n    private static void writeFile(SlideShow slideshow) throws FileNotFoundException, IOException {\n\tFileOutputStream fos = null;\n\ttry {\n\t    File outputFile = new File(\"output.ppt\");\n\t    fos = new FileOutputStream(outputFile);\n\t    slideshow.write(fos);\n\t} finally {\n\t    if (fos != null) {\n\t\tfos.close();\n\t\tfos = null;\n\t    }\n\t}\n    }", "id": 117080, "time": "2008-05-28T06:47:36Z", "creator": "des.kenny@globoforce.com", "creation_time": "2008-05-28T06:47:36Z", "is_private": false, "attachment_id": 22024}, {"count": 1, "tags": [], "bug_id": 45088, "text": "From poi-user:\n\nCheck setting style when '\\n' needs to be the last\ncharacter in the first RichTextRun. It seems to be a related bug.\n\n        SlideShow ppt = new SlideShow();\n                        \n        Slide s = ppt.createSlide();\n        TextBox tb = new TextBox();\n        TextRun tr = tb.createTextRun();\n                        \n        tb.setAnchor(new Rectangle(10,10,500,20));\n        \n        tr.getRichTextRuns()[0].setText(\"hello\\n\");\n        tr.getRichTextRuns()[0].setFontName(\"Calibri\");\n        tr.getRichTextRuns()[0].setFontSize(12);\n        \n        RichTextRun rtr = tr.appendText(\"world\");\n        rtr.setFontName(\"Times New Roman\");\n        rtr.setFontSize(12);\n                \n        s.addShape(tb);\n        \n        FileOutputStream out = new FileOutputStream(\"report/slideshow.ppt\");\n        ppt.write(out);\n        out.close();", "id": 117320, "time": "2008-06-03T23:12:42Z", "creator": "yegor@dinom.ru", "creation_time": "2008-06-03T23:12:42Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "kiwiwings@apache.org", "text": "Nothing to be changed ... anymore.\nI've added a testcase documenting the new handling via r1711845", "id": 186144, "time": "2015-11-01T19:42:58Z", "bug_id": 45088, "creation_time": "2015-11-01T19:42:58Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "kiwiwings@apache.org", "attachment_id": null, "text": "*** Bug 47494 has been marked as a duplicate of this bug. ***", "id": 186146, "time": "2015-11-01T19:44:54Z", "bug_id": 45088, "creation_time": "2015-11-01T19:44:54Z", "is_private": false}, {"count": 4, "attachment_id": null, "bug_id": 45088, "text": "*** Bug 51800 has been marked as a duplicate of this bug. ***", "id": 186148, "time": "2015-11-01T19:54:46Z", "creator": "kiwiwings@apache.org", "creation_time": "2015-11-01T19:54:46Z", "tags": [], "is_private": false}]