[{"count": 0, "tags": [], "creator": "picard09@hotmail.com", "attachment_id": 31314, "id": 173050, "time": "2014-02-15T09:51:45Z", "bug_id": 56140, "creation_time": "2014-02-15T09:51:45Z", "is_private": false, "text": "Created attachment 31314\nExample file from website (with other package)\n\n1. Take your example from the website (see file attached). \n2. Use -xls as parameter. \n3. Change to sheet duplicates\n4. go to cell A2\n5. look at the conditional formula: it says: =Z\u00c4HLENWENN($A$2:$A$11;A3)>1\n\nWhat did i expect?\nLook at the code: it says\n\n  ConditionalFormattingRule rule1 = sheetCF.createConditionalFormattingRule(\"COUNTIF($A$2:$A$11,A2)>1\");\n\nSo, I expected the formula to refer to cell A2 instead of A3!\n\nThis occurs with various formulas some how randomly (e.g. I tried E3 and got I5, or O3 and I got AC5)\n\nPlease check and confirm."}, {"count": 1, "tags": [], "bug_id": 56140, "attachment_id": 31315, "is_private": false, "id": 173051, "time": "2014-02-15T09:53:00Z", "creator": "picard09@hotmail.com", "creation_time": "2014-02-15T09:53:00Z", "text": "Created attachment 31315\ncreated xls"}, {"count": 2, "tags": [], "bug_id": 56140, "attachment_id": null, "is_private": false, "id": 177500, "time": "2014-09-01T22:33:47Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2014-09-01T22:33:47Z", "text": "I tried to debug this, as far as I see we create the correct structures for the PtgRef object according to the MS-XLS spec, however also OpenOffice loads the conditional format incorrectly for this case.\n\nI also saw that OpenOffice creates a PtgRefN, which has offsets instead of relative/absolute coordinates, something which POI seems to totally ignore and handle equal to PtgRef for now! However this does not explain the issue we are seeing here, at least as far as I see."}]