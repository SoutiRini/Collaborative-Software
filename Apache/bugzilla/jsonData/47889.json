[{"count": 0, "tags": [], "creator": "jeff@approximatrix.com", "attachment_id": 24303, "id": 130596, "time": "2009-09-22T19:01:29Z", "bug_id": 47889, "creation_time": "2009-09-22T19:01:29Z", "is_private": false, "text": "Created attachment 24303\nProblematic worksheet\n\nWhen loading the example worksheet (see attached) using POI 3.5beta6, a call to\ngetStringCellValue results in a number formal exception for cell A1 (first row,\nfirst column).  This cell contains the letter 'a' only.  While the worksheet is\ncreated with Gnumeric, it does load properly in Gnumeric and OpenOffice.\n\nThe following is the exception:\n\njava.lang.NumberFormatException: For input string: \"a\"\n    at\njava.lang.NumberFormatException.forInputString(NumberFormatException.java:65)\n    at java.lang.Integer.parseInt(Integer.java:481)\n    at java.lang.Integer.parseInt(Integer.java:514)\n    at\norg.apache.poi.xssf.usermodel.XSSFCell.getRichStringCellValue(XSSFCell.java:257)\n    at\norg.apache.poi.xssf.usermodel.XSSFCell.getStringCellValue(XSSFCell.java:225)\n...\n\nThe call on line 225 seems to suggest that the cell is identified as containing\na string."}, {"count": 1, "tags": [], "bug_id": 47889, "text": "Also tested the attached worksheet under Microsoft Office Excel 2007.  File seems to open fine there as well.", "id": 130604, "time": "2009-09-23T04:12:32Z", "creator": "jeff@approximatrix.com", "creation_time": "2009-09-23T04:12:32Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "id": 130692, "time": "2009-09-26T04:05:23Z", "bug_id": 47889, "creation_time": "2009-09-26T04:05:23Z", "is_private": false, "text": "Quite an interesting case. \n\nFirstly, Gnumeric seems to store strings in cells with type=\"str\" which according to the spec means \"cached formula result\". Both Excel and OpenOffice tolerate it and detect such cells as of type 'string' even if the actual formula is not assigned. I fixed POI to tolerate such worksheets too. \n\nThe second problem is that workbooks created by Gnumeric  don't contain any defined styles, that is, styles.xml is present but it is empty. This can crop up in many places as cell.getCellStyle() is supposed to return a not-null value. \nI made sure that XSSFCell.toString() works - there is a call of getCellStyle() which resulted in exception.  \n\nThe fix was committed in r819106\n\nRegards,\nYegor"}]