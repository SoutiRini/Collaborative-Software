[{"count": 0, "tags": [], "bug_id": 28755, "is_private": false, "text": "The code -\n    cell.setCellFormula(\"right(\\'hello\\', 5)\");\n[The formula is, of course, incorrect - it should be \" and not '; but the poi \ncode, seeing the ', checked if it was a sheet name in a cell reference and gave \nan error]\n\ngives an error -\njava.lang.StringIndexOutOfBoundsException: String index out of range: 0\n\tat java.lang.String.charAt(Unknown Source)\n\tat org.apache.poi.hssf.util.CellReference.<init>(CellReference.java:44)\n\tat org.apache.poi.hssf.record.formula.ReferencePtg.<init>\n(ReferencePtg.java:50)\n\tat org.apache.poi.hssf.model.FormulaParser.Ident(FormulaParser.java:291)\n\tat org.apache.poi.hssf.model.FormulaParser.Factor\n(FormulaParser.java:474)\n\tat org.apache.poi.hssf.model.FormulaParser.Term(FormulaParser.java:548)\n\tat org.apache.poi.hssf.model.FormulaParser.Expression\n(FormulaParser.java:596)\n\tat org.apache.poi.hssf.model.FormulaParser.Arguments\n(FormulaParser.java:443)\n\tat org.apache.poi.hssf.model.FormulaParser.function\n(FormulaParser.java:315)\n\tat org.apache.poi.hssf.model.FormulaParser.Ident(FormulaParser.java:265)\n\tat org.apache.poi.hssf.model.FormulaParser.Factor\n(FormulaParser.java:474)\n\tat org.apache.poi.hssf.model.FormulaParser.Term(FormulaParser.java:548)\n\tat org.apache.poi.hssf.model.FormulaParser.Expression\n(FormulaParser.java:596)\n\tat org.apache.poi.hssf.model.FormulaParser.parse(FormulaParser.java:700)\n\tat org.apache.poi.hssf.usermodel.HSSFCell.setCellFormula\n(HSSFCell.java:678)\n\tat emr.test.Test.setSecondRow(Test.java:85)\n\tat emr.test.Test.main(Test.java:116)\nException in thread \"main\"", "id": 56778, "time": "2004-05-03T23:05:28Z", "creator": "new_connie@hotmail.com", "creation_time": "2004-05-03T23:05:28Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 28755, "attachment_id": null, "id": 92596, "time": "2006-08-28T03:51:31Z", "creator": "jheight@apache.org", "creation_time": "2006-08-28T03:51:31Z", "is_private": false, "text": "Will now throw IllegalArgumentException.\n\nFixed in SVN.\n\nJason"}]