[{"count": 0, "tags": [], "bug_id": 49612, "is_private": false, "id": 138505, "attachment_id": null, "creator": "ranvijayps@gmail.com", "creation_time": "2010-07-19T01:03:04Z", "time": "2010-07-19T01:03:04Z", "text": "hi,\n    I have facing an issue in reading excel sheets though poi.\n\nwithin sheet1 lets A8 is denoted by some_name.when i try to read\nthis as 'sheet1'!some_name within sheet2 in any cell then this \n\ncell type changes to \n\norg.apache.poi.hssf.record.formula.eval.NameXEval and value \n\nreturn is null\n\nwhile 'sheet1'!A8 work fine and in this case the type of cell is \n\norg.apache.poi.hssf.record.formula.eval.NumberEval\n\n\ndue this all the formulas are getting fail which has \n\n'sheet1'!some_name. and throws exceltion \nUnexcepted eval type \n\n(org.apache.poi.hssf.record.formula.eval.NameXEval)\n\ncan you plz, help me \n\nThanks\nranvijay"}, {"count": 1, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "id": 138542, "time": "2010-07-20T06:46:01Z", "bug_id": 49612, "creation_time": "2010-07-20T06:46:01Z", "is_private": false, "text": "It would be helpful for us to diagnose the problem if you attach a workbook and sample code that demonstrate the behavior - ideally a failing junit test. \n\nYegor"}, {"count": 2, "tags": [], "text": "(In reply to comment #1)\n> It would be helpful for us to diagnose the problem if you attach a workbook and\n> sample code that demonstrate the behavior - ideally a failing junit test. \n> \n> Yegor\n\nhi Yegor,\n\n  this is output i have got on console.I am attaching  the Excel file\n  in this excel file cell value at location [0,2] ( 0 base indexing) use formula\n  SUM(BOB+JIM) gives right value 30.but at location [0,3] which uses formula \n  SUM('named-cell-in-formula-test.xls'!BOB+'named-cell-in-formula-test.xls'!JIM)\n  is not excuting. as it throws following error\n\njava class code::\n\n\npackage test;\n\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.IOException;\n\nimport org.apache.poi.hssf.record.formula.eval.BoolEval;\nimport org.apache.poi.hssf.record.formula.eval.NameXEval;\nimport org.apache.poi.hssf.record.formula.eval.NumberEval;\nimport org.apache.poi.hssf.record.formula.eval.StringEval;\nimport org.apache.poi.hssf.record.formula.eval.ValueEval;\nimport org.apache.poi.hssf.usermodel.HSSFCell;\nimport org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator;\nimport org.apache.poi.hssf.usermodel.HSSFRow;\nimport org.apache.poi.hssf.usermodel.HSSFSheet;\nimport org.apache.poi.hssf.usermodel.HSSFWorkbook;\nimport org.apache.poi.ss.formula.IStabilityClassifier;\nimport org.apache.poi.ss.formula.eval.forked.ForkedEvaluator;\n\n\n/**\n * Testing POI's use of Named Cells.\n * \n * @author bsneade\n */\npublic class NamedCellTest {\n\n\tpublic static void main(final String[] args) {\n\t\ttry {\n\t\t\t// load up the spreadsheet\t\t\t\n\tString path=\"C:\\\\test\\\\named-cell-in-formula-test.xls\";\n\n\t\t\tfinal HSSFWorkbook wb = new HSSFWorkbook(new FileInputStream(new File(path)));\t\t\t\t\n\t\t\t//HSSFFormulaEvaluator.evaluateAllFormulaCells(wb);\t\n\t\t\tHSSFSheet sheet1 = wb.getSheet(\"sheet1\");\n\t\t\tString val2=getCellValue(wb, sheet1, 0, 2);\n\t\t\tSystem.out.println(\"[0,2]::\"+val2);\t\t\t\n\t\t\tString val4=getCellValue(wb, sheet1, 0, 3);\n\t\t\tSystem.out.println(\"[0,3]::\"+val4);\n\t\t\t\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t\t\n\t}\n\t\npublic static String getCellValue(HSSFWorkbook wb, HSSFSheet sheet,\n\t\t\tint rowNr, int colNr) {\n\t\tString value = null;\n\t\tForkedEvaluator fEval = ForkedEvaluator.create(wb,\n\t\t\t\tIStabilityClassifier.TOTALLY_IMMUTABLE, null);\n\t\tHSSFRow row = sheet.getRow(rowNr);\n\t\tif (row != null) {\n\t\t\tHSSFCell cell = row.getCell(colNr);\n\t\t\t\n\t     if (cell != null) {\n\t\t\t\tswitch (cell.getCellType()) {\n\n\t\tcase HSSFCell.CELL_TYPE_STRING:\n\t\t\tvalue = cell.getRichStringCellValue().getString();\n\t\t\t\t\tbreak;\n\t\tcase HSSFCell.CELL_TYPE_NUMERIC:\n\t\t\tvalue = Double.toString(cell.getNumericCellValue());\n\t\t\t\t\tbreak;\n\t\tcase HSSFCell.CELL_TYPE_BOOLEAN:\n\t\t\tvalue = Boolean.toString(cell.getBooleanCellValue());\n\t\t\t\t\tbreak;\n\t\tcase HSSFCell.CELL_TYPE_FORMULA:\n\t\t\t\t\t\nValueEval vEval=(ValueEval)fEval.evaluate(sheet.getSheetName(),rowNr,colNr);\t\t\t\t\t\n   if (vEval instanceof BoolEval) {\n\t\tvalue = ((BoolEval) vEval).getStringValue();\n\t\t} else if (vEval instanceof NumberEval) {\n\t\t  value = ((NumberEval) vEval).getStringValue();\n\t\t} else if (vEval instanceof StringEval) {\n\t\t  value = ((StringEval) vEval).getStringValue();\n\t\t\t\t\t}\t\t\t\t\n\t\t\t\t\tbreak;\t\t\t\t\t\n\t\t\t\t    default:\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t}\n\t\n}\n\n\n\n\n[0,2]::30\n\nException in thread \"main\" java.lang.RuntimeException: Unexpected arg eval type (org.apache.poi.hssf.record.formula.eval.NameXEval)\n\tat org.apache.poi.hssf.record.formula.eval.OperandResolver.coerceValueToDouble(OperandResolver.java:218)\n\tat org.apache.poi.hssf.record.formula.eval.TwoOperandNumericOperation.singleOperandEvaluate(TwoOperandNumericOperation.java:30)\n\tat org.apache.poi.hssf.record.formula.eval.TwoOperandNumericOperation.evaluate(TwoOperandNumericOperation.java:35)\n\tat org.apache.poi.hssf.record.formula.functions.Fixed2ArgFunction.evaluate(Fixed2ArgFunction.java:33)\n\tat org.apache.poi.ss.formula.OperationEvaluatorFactory.evaluate(OperationEvaluatorFactory.java:119)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateFormula(WorkbookEvaluator.java:437)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateAny(WorkbookEvaluator.java:260)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluate(WorkbookEvaluator.java:206)\n\tat org.apache.poi.ss.formula.eval.forked.ForkedEvaluator.evaluate(ForkedEvaluator.java:119)\n\tat test.NamedCellTest.getCellValue(NamedCellTest.java:68)\n\tat test.NamedCellTest.main(NamedCellTest.java:37)\n\n\nThanks\nRanvijay", "attachment_id": null, "id": 138649, "creator": "ranvijayps@gmail.com", "time": "2010-07-23T06:19:14Z", "bug_id": 49612, "creation_time": "2010-07-23T06:19:14Z", "is_private": false}, {"count": 3, "tags": [], "text": "Created attachment 25797\nexcel file for", "attachment_id": 25797, "bug_id": 49612, "id": 138650, "time": "2010-07-23T06:20:43Z", "creator": "ranvijayps@gmail.com", "creation_time": "2010-07-23T06:20:43Z", "is_private": false}, {"count": 4, "attachment_id": null, "creator": "yegor@dinom.ru", "is_private": false, "id": 138667, "time": "2010-07-24T07:39:39Z", "bug_id": 49612, "creation_time": "2010-07-24T07:39:39Z", "tags": [], "text": "Thanks for the additional information. \n\nI confirmed the problem and added failing unit test. Please wait, I hope it will be fixed soon.\n\nYegor"}, {"count": 5, "attachment_id": null, "creator": "ranvijayps@gmail.com", "is_private": false, "id": 138720, "time": "2010-07-29T00:16:54Z", "bug_id": 49612, "creation_time": "2010-07-29T00:16:54Z", "tags": [], "text": "(In reply to comment #4)\n> Thanks for the additional information. \n> \n> I confirmed the problem and added failing unit test. Please wait, I hope it\n> will be fixed soon.\n> \n> Yegor\n\nhi Yegor,\n            Is there any updates regarding my issue.\n\n\nThanks\nRanviyay"}, {"count": 6, "tags": [], "bug_id": 49612, "attachment_id": null, "is_private": false, "id": 138722, "time": "2010-07-29T02:36:24Z", "creator": "yegor@dinom.ru", "creation_time": "2010-07-29T02:36:24Z", "text": "Name evaluation across workbooks is not supported by POI. Josh Micich, the developer who wrote most of the evaluation code confirmed that and and I have to resolve this bug report as \"wontfix\". \n\nThe syntax SUM('file1.xls'!BOB+'file2.xls'!JIM) means that BOB and JIM are  external names and evaluator needs to open file1.xls and file2.xls to evaluate them and this is not supported.  \n\nYegor"}, {"count": 7, "attachment_id": null, "creator": "ranvijayps@gmail.com", "is_private": false, "id": 138731, "time": "2010-07-29T07:10:02Z", "bug_id": 49612, "creation_time": "2010-07-29T07:10:02Z", "tags": [], "text": "(In reply to comment #6)\n> Name evaluation across workbooks is not supported by POI. Josh Micich, the\n> developer who wrote most of the evaluation code confirmed that and and I have\n> to resolve this bug report as \"wontfix\". \n> \n> The syntax SUM('file1.xls'!BOB+'file2.xls'!JIM) means that BOB and JIM are \n> external names and evaluator needs to open file1.xls and file2.xls to evaluate\n> them and this is not supported.  \n> \n> Yegor\n\nhi Yegor,\n          Thanks for reply,\n          I understand that external names are not supported by POI as you\n          mentioned.but same error also occur in the same .xls file for two\n          different sheets.\n              lets say two sheets are sheet1 and sheet2 and excel file is\n          file1.xls.lets there are two named defined name1 and name2 in sheet1\n\n          now when i am trying to use SUM('sheet1'!name1+'sheet1'!name2)\n          in sheet2 for the same excel file file1.xls,then same exception\n          which i mentioned previously comes.\n        \n          Can You plz, confirmed me that this is supported by POI or not\n\nThanks\nRanvijay"}, {"count": 8, "tags": [], "bug_id": 49612, "attachment_id": null, "text": "I will tell for sure if you attach a sample file and java code demonstrating that evaluation of SUM('sheet1'!name1+'sheet1'!name2) does not work. \n\nYegor\n\n> hi Yegor,\n>           Thanks for reply,\n>           I understand that external names are not supported by POI as you\n>           mentioned.but same error also occur in the same .xls file for two\n>           different sheets.\n>               lets say two sheets are sheet1 and sheet2 and excel file is\n>           file1.xls.lets there are two named defined name1 and name2 in sheet1\n> \n>           now when i am trying to use SUM('sheet1'!name1+'sheet1'!name2)\n>           in sheet2 for the same excel file file1.xls,then same exception\n>           which i mentioned previously comes.\n> \n>           Can You plz, confirmed me that this is supported by POI or not\n> \n> Thanks\n> Ranvijay", "id": 138732, "time": "2010-07-29T07:21:01Z", "creator": "yegor@dinom.ru", "creation_time": "2010-07-29T07:21:01Z", "is_private": false}]