[{"count": 0, "tags": [], "creator": "ishii@infoteria.com", "attachment_id": 28749, "is_private": false, "id": 158922, "time": "2012-05-09T09:55:16Z", "bug_id": 53207, "creation_time": "2012-05-09T09:55:16Z", "text": "Created attachment 28749\nfiles for test input\n\n[attachment : files.zip]\nok.xlsx : D1-D12 has formula\nng.xlsx : D1-D12 has shared formula\n\nA result file[result_ng.xlsx] has break formula.\nOpen and Rescue by Excel, cells[D11-D12] formula is gone.\n\nThe setCellFormula method can not clear formula like this.\n(*Exclude the case where only D1 is cleared.)\n----------------------------------------------------\n<sheetData>\n ..\n <c r=\"D1\" s=\"2\">\n  <f t=\"shared\" ref=\"D1:D12\" si=\"0\">B1*C1</f>\n ..\n----------------------------------------------------\n\nTest code.\n\npublic static void test() {\n  formulaTest(\"ok.xlsx\");\n  formulaTest(\"ng.xlsx\");\n}\n\npublic static void formulaTest(String file) {\n  ConditionalFormattingTest test = new ConditionalFormattingTest(file);\n  test.init();\n  XSSFSheet sheet = (XSSFSheet)test.getSheet(0);\t\t\n  for (int i=0; i<10; i++) {\n    sheet.getRow(i).getCell(3).setCellFormula(null);\n  }\t\t\n  test.writeBook(\"result_\" + file);\n}"}]