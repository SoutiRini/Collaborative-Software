[{"count": 0, "tags": [], "creator": "juustunagu@hotmail.com", "attachment_id": null, "text": "Using RewriteRule in virtualhost with VirtualDocumentRoot causes File Not Found error on url that matches that rule.\n\nI have 2 vhosts blocks - for trunk and for branches. Conf:\n\n-- conf start --\n<VirtualHost *:80>\n    ServerName example.com\n\n    DocumentRoot /srv/www/trunk\n\n    RewriteEngine On\n    RewriteRule ^/a/_(.+)$ /a/rew-$1\n</VirtualHost>\n\n<VirtualHost *:80>\n    # get the server name from the Host: header\n    UseCanonicalName Off\n\n    ServerAlias *.example.com\n\n    VirtualDocumentRoot /srv/www/branches/%1\n\n    RewriteEngine On\n    RewriteRule ^/a/_(.+)$ /a/rew-$1\n</VirtualHost>\n-- conf end --\n\nExpected Results:\nhttp://foo.example.com/a/_foo.txt maps to http://foo.example.com/a/rew-foo.txt\n\nActual Result:\n404 File Not Found\n\n\nBUT!\n\nThis works (not using VirtualDocumentRoot):\nhttp://example.com/a/_foo.txt maps to http://example.com/a/rew-foo.txt\n\nThis also works (change in 2nd vhost block):\n...\nRewriteRule ^/a/_(.+)$ /a/rew-$1 [R]\n...\nhttp://example.com/a/_foo.txt is redirected to http://example.com/a/rew-foo.txt\n\n\nPlatform:\n$ cat /etc/SuSE-release\nSUSE Linux Enterprise Server 10 (x86_64)\nVERSION = 10\nPATCHLEVEL = 2\n\n$ uname -a\nLinux XXX 2.6.27.45-0.1-xen #1 SMP Tue May 11 15:36:17 EEST 2010 x86_64 x86_64 x86_64 GNU/Linux", "id": 138787, "time": "2010-07-31T16:22:59Z", "bug_id": 49682, "creation_time": "2010-07-31T16:22:59Z", "is_private": false}, {"count": 1, "tags": [], "creator": "juustunagu@hotmail.com", "attachment_id": null, "id": 138789, "time": "2010-07-31T16:25:32Z", "bug_id": 49682, "creation_time": "2010-07-31T16:25:32Z", "is_private": false, "text": "Made a mistake in BUT.... :) URLs should have been foo.example.com\n\nThis also works (change in 2nd vhost block):\n...\nRewriteRule ^/a/_(.+)$ /a/rew-$1 [R]\n...\nhttp://foo.example.com/a/_foo.txt is redirected to http://foo.example.com/a/rew-foo.txt"}, {"count": 2, "tags": [], "creator": "covener@gmail.com", "attachment_id": null, "text": "Use the PT flag in virtualhost context if you want modules like mod_vhost_alias to have a chance to work on the changed URL.  Further discussion at users@httpd.apache.org.", "id": 138790, "time": "2010-07-31T18:31:20Z", "bug_id": 49682, "creation_time": "2010-07-31T18:31:20Z", "is_private": false}]