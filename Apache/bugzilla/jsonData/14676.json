[{"count": 0, "tags": [], "bug_id": 14676, "attachment_id": null, "id": 26556, "time": "2002-11-19T12:55:00Z", "creator": "admin@ter-net.com", "creation_time": "2002-11-19T12:55:00Z", "is_private": false, "text": "Linux kernel 2.4.19\nSituation:\n   httpd kompiled with keys: --with-mpm=perchild --enable-mods-shared=all\n \nat the httpd.conf defined (in additional to default):\n<IfModule perchild.c>\nNumServers           5\nStartThreads         10\nMinSpareThreads      5\nMaxSpareThreads     10\nMaxThreadsPerChild  2000\nMaxRequestsPerChild 1000\nChildPerUserID 1000 100 2\nChildPerUserID 1001 100 2\n</IfModule>\n\nNameVirtualHost *\n\n<VirtualHost *>\n    AssignUserId 1000 100\n    ServerAdmin webmaster@dummy-host.example.com\n    DocumentRoot /var/home/boris/www/\n    ServerName boris.hosts\n    ErrorLog logs/dummy-host.example.com-error_log\n    CustomLog logs/dummy-host.example.com-access_log common\n</VirtualHost>\n\n<VirtualHost *>\n    AssignUserId 1001 100\n    ServerAdmin webmaster@dummy-host.example.com\n    DocumentRoot /var/home/soloma/www/\n    ServerName soloma.hosts\n    ErrorLog logs/dummy-host.example.com-error_log\n    CustomLog logs/dummy-host.example.com-access_log common\n</VirtualHost>\n\n\nAfter apachectl start appears a number of httpd processes:\n$ps aux\nroot       136  /usr/local/apache2/bin/httpd -k start\nnobody     143  /usr/local/apache2/bin/httpd -k start\nboris      144  /usr/local/apache2/bin/httpd -k start\nboris      145  /usr/local/apache2/bin/httpd -k start\nboris      146  /usr/local/apache2/bin/httpd -k start\nsoloma     147  /usr/local/apache2/bin/httpd -k start\nsoloma     148  /usr/local/apache2/bin/httpd -k start\nboris      149  /usr/local/apache2/bin/httpd -k start\nboris      150  /usr/local/apache2/bin/httpd -k start\nsoloma     151  /usr/local/apache2/bin/httpd -k start\nsoloma     152  /usr/local/apache2/bin/httpd -k start\nsoloma     153  /usr/local/apache2/bin/httpd -k start\nboris      154  /usr/local/apache2/bin/httpd -k start\nboris      155  /usr/local/apache2/bin/httpd -k start\nsoloma     156  /usr/local/apache2/bin/httpd -k start\nsoloma     157  /usr/local/apache2/bin/httpd -k start\nboris      158  /usr/local/apache2/bin/httpd -k start\nboris      159  /usr/local/apache2/bin/httpd -k start\nsoloma     160  /usr/local/apache2/bin/httpd -k start\nsoloma     161  /usr/local/apache2/bin/httpd -k start\nboris      162  /usr/local/apache2/bin/httpd -k start\nboris      163  /usr/local/apache2/bin/httpd -k start\nsoloma     164  /usr/local/apache2/bin/httpd -k start\nsoloma     165  /usr/local/apache2/bin/httpd -k start\nboris      166  /usr/local/apache2/bin/httpd -k start\nsoloma     167  /usr/local/apache2/bin/httpd -k start\n\n(boris has uid 1000, soloma 1001).\n \nAfter that virtual hosts soloma.hosts and boris.hosts works unstable:\nSome times (but rarely) both hosts work;\nSome times work only one host, second host not response to client and nothing\nwrites to the logs.\n\nIf I remove one host from httpd.conf, the second host work properly."}, {"count": 1, "tags": [], "bug_id": 14676, "attachment_id": 3890, "is_private": false, "id": 26559, "time": "2002-11-19T12:57:20Z", "creator": "admin@ter-net.com", "creation_time": "2002-11-19T12:57:20Z", "text": "Created attachment 3890\nmy apache configuration file"}, {"count": 2, "tags": [], "bug_id": 14676, "attachment_id": null, "text": "a word to the wise:\n\nperchild is not considered production ready...  there probably isn't any use in\nusing it yet unless you are willing to do some debugging\n\nYou definitely want to use the fixes since 2.0.43, which you can find here:\n\nhttp://cvs.apache.org/viewcvs.cgi/httpd-2.0/server/mpm/experimental/perchild/perchild.c\n", "id": 26620, "time": "2002-11-19T23:35:52Z", "creator": "trawick@apache.org", "creation_time": "2002-11-19T23:35:52Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 14676, "attachment_id": null, "is_private": false, "id": 26770, "time": "2002-11-22T10:16:22Z", "creator": "admin@ter-net.com", "creation_time": "2002-11-22T10:16:22Z", "text": "I think that I found the reason of this bug. \nIn function pass_request message write to the destination socket throw sendmsg\nAPI and on my linux box client receive nothing. \nIf I use send API at this place, it works."}, {"count": 4, "tags": [], "bug_id": 14676, "attachment_id": null, "id": 26875, "time": "2002-11-23T18:19:51Z", "creator": "trawick@apache.org", "creation_time": "2002-11-23T18:19:51Z", "is_private": false, "text": "Thanks for experimenting.\n\nA critical bug was fixed in that function after 2.0.43.  Other critical bugs\nelsewhere in perchild were fixed as well.\n\nPlease download the latest perchild.c from\n\nhttp://cvs.apache.org/viewcvs.cgi/httpd-2.0/server/mpm/experimental/perchild/perchild.c\n\nand see if that resolves this problem.\n\nIt sounds exactly like the symptom which was reported to be fixed by\na previous commit.  The sendmsg() was definitely busted.  If it doesn't resolve\nthe problem, please reopen this PR.\n\nThanks!\n"}, {"count": 5, "tags": [], "text": "Nothing is change. With the same configuration (and AcceptMutex  fcntl) the\nfirst host in ChildPerUserID definition work right, the second host receive\nnothing (wait infinitely).\n\nIn log:\n[debug] perchild.c(1790): Determining if request should be passed. Child Num: 0,\nSD: 10, sd from table: 10, hostname from server: soloma.hosts\n[debug] perchild.c(1790): Determining if request should be passed. Child Num: 0,\nSD: 8, sd from table: 10, hostname from server: boris.hosts\n[debug] perchild.c(1799): Passing request.\n[debug] perchild.c(1655): passing request to another child.  Vhost: boris.hosts,\nchild 0 9\n[debug] perchild.c(1707): Writing message to 9, passing sd:  28\n[debug] perchild.c(1717): Writing message succeeded 39\n\nnetstat -a:\ntcp        1      0 192.168.0.100:www       192.168.0.2:2918        CLOSE_WAIT\n\nI think that the reason is the using of sendmsg API.", "is_private": false, "id": 26931, "creator": "admin@ter-net.com", "time": "2002-11-25T11:48:56Z", "bug_id": 14676, "creation_time": "2002-11-25T11:48:56Z", "attachment_id": null}, {"count": 6, "tags": [], "text": "Isn't this a duplicate of bug #12187?\n", "is_private": false, "bug_id": 14676, "id": 29131, "time": "2003-01-10T15:41:46Z", "creator": "jvb@prairienet.org", "creation_time": "2003-01-10T15:41:46Z", "attachment_id": null}, {"count": 7, "tags": [], "creator": "sputnick@gmx.net", "text": "I have the exact same problem, similar configuration, with Apache 2.0.47\n(Debian). Only one host mentioned in the ChildPerUserID directives (usually the\nfirst?) seems to work. Trying to connect to any of the other virtual hosts\nyields no response whatsoever.\n\nError log shows something like that:\n\nDetermining if request should be passed. Child Num: 1, SD: 24, sd from table:\n12, hostname from server: supervision.de\nPassing request.\npassing request to another child.  Vhost: www.supervision.de, child 1 25\nWriting message to 25, passing sd:  30\nWriting message succeeded 46\n\nAccess log is empty.", "id": 46295, "time": "2003-10-26T16:03:55Z", "bug_id": 14676, "creation_time": "2003-10-26T16:03:55Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "text": "The perchild MPM is not supported, and not under any development.\n\nThe 'Metux' MPM is being developed outside of mainline apache, and might provide a viable alternative:\nhttp://www.metux.de/mpm/\n", "is_private": false, "id": 62678, "creator": "chip@force-elite.com", "time": "2004-08-30T01:43:10Z", "bug_id": 14676, "creation_time": "2004-08-30T01:43:10Z", "attachment_id": null}]