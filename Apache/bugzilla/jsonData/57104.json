[{"count": 0, "tags": [], "text": "I am trying to read from a Microsoft Excel 97-2003 Worksheet. There is no problem opening the file using Microsoft Excel or Open Office. poi can read the file once the file is opened and saved again in the same format. But i cannot implement this practice for each file I encounter. I cannot attach the problematic file because it has client information. Please help me with this.\n\nThe error I get is as follows:\n\norg.apache.poi.hssf.record.RecordInputStream$LeftoverDataException: Initialisation of record 0x5B left 1 bytes remaining still to be read.\n        at org.apache.poi.hssf.record.RecordInputStream.hasNextRecord(RecordInputStream.java:156)\n        at org.apache.poi.hssf.record.RecordFactoryInputStream.nextRecord(RecordFactoryInputStream.java:231)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:480)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:301)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:264)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:199)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:342)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:323)", "is_private": false, "bug_id": 57104, "id": 178528, "time": "2014-10-17T07:21:27Z", "creator": "simolidesai@gmail.com", "creation_time": "2014-10-17T07:21:27Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "Any chance of the file that shows the problem, so we can look at why POI isn't knowing to read the whole record's data?", "is_private": false, "bug_id": 57104, "id": 178530, "time": "2014-10-17T08:32:23Z", "creator": "apache@gagravarr.org", "creation_time": "2014-10-17T08:32:23Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 57104, "is_private": false, "text": "Created attachment 32119\nProblematic file\n\nI found one more file with that gets me a similar error. I have attached it for you.\n\nIt throws the same LeftoverDataException.\n\nThe error goes like this:\n\n\nException in thread \"main\" org.apache.poi.hssf.record.RecordInputStream$LeftoverDataException: Initialisation of record 0x31 left 22 bytes remaining still to be read.\n        at org.apache.poi.hssf.record.RecordInputStream.hasNextRecord(RecordInputStream.java:156)\n        at org.apache.poi.hssf.record.RecordFactoryInputStream.nextRecord(RecordFactoryInputStream.java:231)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:480)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:301)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:264)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:199)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:342)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:323)", "id": 178537, "time": "2014-10-17T12:07:08Z", "creator": "simolidesai@gmail.com", "creation_time": "2014-10-17T12:07:08Z", "attachment_id": 32119}, {"count": 3, "tags": [], "bug_id": 57104, "attachment_id": null, "id": 178543, "time": "2014-10-17T13:42:49Z", "creator": "apache@gagravarr.org", "creation_time": "2014-10-17T13:42:49Z", "is_private": false, "text": "We need one file per problematic record type + bytes remaining combination. While the exceptions look similar, the fix for each will be totally different\n\nSo, we need one for your \"record type 0x5b + 1 byte remaining\" case, and one for your \"record type 0x31 + 22 bytes remaining\" case"}, {"count": 4, "tags": [], "bug_id": 57104, "attachment_id": null, "id": 178614, "creation_time": "2014-10-20T07:49:09Z", "time": "2014-10-20T07:49:09Z", "creator": "simolidesai@gmail.com", "text": "I cannot provide you with the file for the other exception I get for record 0x5B left 1 bytes. Please use the file I have attached previously for the following error. It is fine if you look into this error and ignore the previous one because of lack of information.\n\nException in thread \"main\" org.apache.poi.hssf.record.RecordInputStream$LeftoverDataException: Initialisation of record 0x31 left 22 bytes remaining still to be read.\n        at org.apache.poi.hssf.record.RecordInputStream.hasNextRecord(RecordInputStream.java:156)\n        at org.apache.poi.hssf.record.RecordFactoryInputStream.nextRecord(RecordFactoryInputStream.java:231)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:480)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:301)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:264)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:199)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:342)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:323)", "is_private": false}, {"count": 5, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "is_private": false, "id": 179041, "time": "2014-11-10T21:14:06Z", "bug_id": 57104, "creation_time": "2014-11-10T21:14:06Z", "text": "I tried to debug this, but when looking this up in the spec POI parses the record correctly and it looks like this file is slightly off-standard and Excel somehow ignores the additional content. \n\nDev-Info: There are multiple [FONT] records which additional 22 bytes each. POI seems to exactly follow the spec for FontRecord at \"2.4.122 Font\", but somehow all the FONT-entries in this XLS file have 22 additional bytes. The value of the first set of additional bytes is \"13, 00, 01, 00, 00, 58, 01, 00, 00, 59, 5F, 29, 3F, 5F, 29, 3B, 5F, 28, 40, 5F, 29, 00\".\n\nSimoli, how exactly are these files produced? Via Excel or some other software that automatically produces them?"}, {"count": 6, "tags": [], "creator": "simolidesai@gmail.com", "text": "Hi Dominik,\n\nIt must be a third party software that generates these files.\n\nBy the way, the 22 bytes for FontRecord... can these be skipped?\n\nThere is this other library i used instead of POI because I had to get on with my work, however I donot rely upon it completely. It parsed my file good. No data fields were missing, it threw me an error message. That is all.", "id": 179098, "time": "2014-11-14T06:18:12Z", "bug_id": 57104, "creation_time": "2014-11-14T06:18:12Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "creator": "dominik.stadler@gmx.at", "text": "BTW, this sounds quite similar to bug #57093", "id": 183664, "time": "2015-06-20T15:40:02Z", "bug_id": 57104, "creation_time": "2015-06-20T15:40:02Z", "is_private": false, "attachment_id": null}]