[{"count": 0, "tags": [], "bug_id": 56635, "attachment_id": 31722, "is_private": false, "id": 175852, "time": "2014-06-17T14:14:17Z", "creator": "buehlmann@phys.ethz.ch", "creation_time": "2014-06-17T14:14:17Z", "text": "Created attachment 31722\nxls file to examine\n\nThe method getLastCellNum for (excel) row 20 returns the correct value (9). Removing the cell 20:j, shifting cells left, the method getLastCellNum returns 31 instead of 1\n\n\nUse the following code to test:\n\nimport java.io.File;\nimport java.io.IOException;\n\nimport org.apache.poi.openxml4j.exceptions.InvalidFormatException;\nimport org.apache.poi.ss.usermodel.Cell;\nimport org.apache.poi.ss.usermodel.Row;\nimport org.apache.poi.ss.usermodel.Sheet;\nimport org.apache.poi.ss.usermodel.Workbook;\nimport org.apache.poi.ss.usermodel.WorkbookFactory;\n\n/**\n * \n */\n\n/**\n * @author simonbue\n *\n */\npublic class CellCount {\n\n\t\n\tpublic CellCount(){\n\t\tFile excelFile = new File(\"c:/temp/ETH_template.xls\");\n\t\tWorkbook wb = null;\n\t\ttry {\n\t\t\twb = WorkbookFactory.create(excelFile);\n\t\t} catch (InvalidFormatException e) {\n\t\t\t// TODO Auto-generated catch block\n\t\t\te.printStackTrace();\n\t\t} catch (IOException e) {\n\t\t\t// TODO Auto-generated catch block\n\t\t\te.printStackTrace();\n\t\t}\n\t\tSheet sheet = wb.getSheet(\"samplelist\");\n\t\tRow row = sheet.getRow(19);\n\t\t short minColIx = row.getFirstCellNum();\n\t\t short maxColIx = row.getLastCellNum();\n\t\t for(short colIx=minColIx; colIx<maxColIx; colIx++) {\n\t\t   Cell cell = row.getCell(colIx);\n\t\t   if(cell == null) {\n\t\t\t System.out.println(\"Cell \" + colIx + \" is null\");\n\t\t     continue;\n\t\t   }\n\t\t\t System.out.println(\"Cell type \" + colIx + \" is \" + cell.getCellType());\t\t   \n\t\t }\n\t}\n\t\n\t/**\n\t * @param args\n\t */\n\tpublic static void main (String[] args) \n\t{\n\t\tnew CellCount();\n\n\t}\n\n}"}, {"count": 1, "tags": [], "text": "Created attachment 31723\nTest Application", "is_private": false, "id": 175853, "creator": "buehlmann@phys.ethz.ch", "time": "2014-06-17T14:15:56Z", "bug_id": 56635, "creation_time": "2014-06-17T14:15:56Z", "attachment_id": 31723}, {"count": 2, "attachment_id": null, "creator": "apache@gagravarr.org", "is_private": false, "id": 175857, "time": "2014-06-17T21:01:11Z", "bug_id": 56635, "creation_time": "2014-06-17T21:01:11Z", "tags": [], "text": "POI just reports the value that Excel has stored in the file, Excel doesn't always do the \"sensible\" thing especially when it comes to styled but un-used cells. Not really a lot that POI can do if Excel puts slightly duff info in the file, sorry"}, {"count": 3, "tags": [], "bug_id": 56635, "is_private": false, "id": 175859, "creation_time": "2014-06-18T05:37:06Z", "time": "2014-06-18T05:37:06Z", "creator": "buehlmann@phys.ethz.ch", "text": "So this means that I have to find my own solution. Might it be possible to mention this in the documentation as I think this can also confuse others.", "attachment_id": null}]