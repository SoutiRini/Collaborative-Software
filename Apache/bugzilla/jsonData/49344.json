[{"count": 0, "tags": [], "bug_id": 49344, "attachment_id": null, "id": 137138, "time": "2010-05-26T08:33:19Z", "creator": "antoni.mylka@aduna-software.com", "creation_time": "2010-05-26T08:33:19Z", "is_private": false, "text": "With the current trunk (rev948199) I get two build failures. Both of them are related to the patch applied in rev942809 as described in issue 49066. I work on a Polish Locale. I had other problems with this, but this time it's weird. build.xml seems to set the locale to en_US via junit.properties (which is a good idea) but I still can't build POI.\n\nThe NumberFormatTests.xlsx seems to fail on row 333. The value of the cell A333 in the \"Tests\" sheet is unreadable in an English version of Excel 2010beta. This is the only cell in the A column that produces a #VALUE!. All other values in the A column are visible correctly in Excel and pass in java code.\n\nThe NumberFormatApproxTests.xlsx is much worse. When I open it in Excel, almost all values in the A column of the \"Tests\" sheet show a #VALUE! error. Only cells which show an actual value are: A40, A41, A96, A97, A136, A137, A176, A177, A216, A217. I get a failure in row 7: expected 120000.0 but was 100000.0. \n\nHow should I approach debugging this?\n\n     [java] 1) testNumberFormat(org.apache.poi.ss.format.TestCellFormatPart)junit.framework.ComparisonFailure: format \"org.apache.poi.ss.format.CellFormatPart@511e0a\" expected:<....14...> but was:<...,,14,159.3,...>\n     [java] \tat org.apache.poi.ss.format.CellFormatTestBase$CellValue.equivalent(CellFormatTestBase.java:74)\n     [java] \tat org.apache.poi.ss.format.CellFormatTestBase.tryColor(CellFormatTestBase.java:228)\n     [java] \tat org.apache.poi.ss.format.CellFormatTestBase.tryFormat(CellFormatTestBase.java:201)\n     [java] \tat org.apache.poi.ss.format.CellFormatTestBase.runFormatTests(CellFormatTestBase.java:109)\n     [java] \tat org.apache.poi.ss.format.TestCellFormatPart.testNumberFormat(TestCellFormatPart.java:50)\n     [java] \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n     [java] \tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n     [java] \tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n     [java] \tat org.apache.poi.util.OOXMLLite.build(OOXMLLite.java:103)\n     [java] \tat org.apache.poi.util.OOXMLLite.main(OOXMLLite.java:78)\n     [java] 2) testNumberApproxFormat(org.apache.poi.ss.format.TestCellFormatPart)junit.framework.AssertionFailedError: format \"org.apache.poi.ss.format.CellFormatPart@8be9ef\",|1.2|e|5| ~= |1,2.1|e|5| expected:<120000.0> but was:<100000.0>\n     [java] \tat org.apache.poi.ss.format.TestCellFormatPart$3.equivalent(TestCellFormatPart.java:70)\n     [java] \tat org.apache.poi.ss.format.CellFormatTestBase.tryColor(CellFormatTestBase.java:228)\n     [java] \tat org.apache.poi.ss.format.CellFormatTestBase.tryFormat(CellFormatTestBase.java:201)\n     [java] \tat org.apache.poi.ss.format.CellFormatTestBase.runFormatTests(CellFormatTestBase.java:109)\n     [java] \tat org.apache.poi.ss.format.TestCellFormatPart.testNumberApproxFormat(TestCellFormatPart.java:58)\n     [java] \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n     [java] \tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n     [java] \tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n     [java] \tat org.apache.poi.util.OOXMLLite.build(OOXMLLite.java:103)\n     [java] \tat org.apache.poi.util.OOXMLLite.main(OOXMLLite.java:78)"}, {"count": 1, "tags": [], "bug_id": 49344, "attachment_id": null, "id": 137143, "time": "2010-05-26T09:48:09Z", "creator": "yegor@dinom.ru", "creation_time": "2010-05-26T09:48:09Z", "is_private": false, "text": "Can you run Ant in the debug mode:\n\n\"ant -debug ...\"\n\nAre there warnings or errors? \n\nTry to replace the reference to syspropertyset with explicit definition, that is,\n\nreplace\n            <syspropertyset refid=\"junit.properties\"/>\n\nwith\n\n            <sysproperty name=\"user.language\" value=\"en\"/>\n            <sysproperty name=\"user.country\" value=\"US\"/>\n            <sysproperty name=\"POI.testdata.path\" value=\"test-data\"/>\n            <sysproperty name=\"java.awt.headless\" value=\"true\"/>\n\nWhat version of Ant are you running?  I'm on Ant 1.7.1 and tests against English and Russian locales pass OK to me.\n\nYegor"}, {"count": 2, "tags": [], "creator": "antoni.mylka@aduna-software.com", "attachment_id": null, "is_private": false, "id": 137155, "time": "2010-05-26T13:24:02Z", "bug_id": 49344, "creation_time": "2010-05-26T13:24:02Z", "text": "I reran the build with -debug and found the following lines in the output.\n\nOverride ignored for property \"user.language\"\nOverride ignored for property \"user.country\"\n\nI have no idea who or what sets those properties.\n\nant -Duser.language=en -Duser.country=US dist\n\nworks for me now.\n\nThanks.\n\nAs far as I'm concerned this issue may be closed. It may be a quirk of my environment. I can live with the workaround.\n\nI take the liberty of marking this as invalid. \n\nSorry for the hassle."}]