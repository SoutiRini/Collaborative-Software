[{"count": 0, "tags": [], "text": "In HSSF, the formula evaluator passes around a hsss.model.Workbook for 2 purposes:\n - resolving cross-sheet references (Ref3dPtg and Area3dPtg)\n - resolving named ranges and non-built-in functions (NamePtg and NameXPtg)\n\nA common interface could be introduced to represent this functionality.  In HSSF, the concrete class hssf.model.Workbook could implement this interface.  In XSSF, perhaps an adapter wrapping XSSFWorkbook could be written.  Maybe an adapter in both places.", "attachment_id": null, "bug_id": 44762, "id": 115350, "time": "2008-04-06T13:49:43Z", "creator": "josh@apache.org", "creation_time": "2008-04-06T13:49:43Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 44762, "text": "I have a feeling that HSSFWorkbook / XSSFWorkbook (and hence ss.usermodel.Workbook) will already do the named range stuff for us, so that ought to be an easy change\n\nIs the sheet lookup actually the \"get sheet from external sheet number/ref\" stuff? If so, I think we could probably put that onto ss.usermodel.Workbook, and have HSSFWorkbook delegate that onto the model.Workbook\n\nI'll have a go at tweaking shortly", "id": 115364, "time": "2008-04-07T03:34:59Z", "creator": "apache@gagravarr.org", "creation_time": "2008-04-07T03:34:59Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 44762, "text": "I've updated trunk to use hssf.usermodel.HSSFWorkbook, and then applied the same thing to the branch, switched to ss.usermodel.Workbook\n\nAll the tests now pass, but there is one rather icky method I've had to put onto ss.usermodel.Workbook:\n  public String resolveNameXText(int refIndex, int definedNameIndex)\n\nWe'll want to replace that with something better, once someone can figure out what it does!", "id": 115629, "time": "2008-04-16T03:40:53Z", "creator": "apache@gagravarr.org", "creation_time": "2008-04-16T03:40:53Z", "is_private": false, "attachment_id": null}]