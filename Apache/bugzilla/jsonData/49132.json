[{"count": 0, "attachment_id": null, "bug_id": 49132, "is_private": false, "id": 136192, "time": "2010-04-16T01:52:57Z", "creator": "alvins1982@hotmail.com", "creation_time": "2010-04-16T01:52:57Z", "tags": [], "text": "Simple web-app test to lookup the environment context is throwing an exception - below code is taken from tomcat 6/7 docs - 2nd line throws a NameNotFound Exception 'comp' not found.\n\n// Obtain our environment naming context\nContext initCtx = new InitialContext();\nContext envCtx = (Context) initCtx.lookup(\"java:comp/env\");"}, {"count": 1, "tags": [], "text": "There are unit tests that cover this (they pass) and I also tested this explicitly without any issue. Looks like a configuration/environment issue. Please use the users list if you require further assistance.", "attachment_id": null, "id": 136197, "creator": "markt@apache.org", "time": "2010-04-16T08:27:20Z", "bug_id": 49132, "creation_time": "2010-04-16T08:27:20Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 49132, "attachment_id": 25331, "is_private": false, "id": 136312, "time": "2010-04-22T06:29:01Z", "creator": "alvins1982@hotmail.com", "creation_time": "2010-04-22T06:29:01Z", "text": "Created attachment 25331\nWebapp test src"}, {"count": 3, "tags": [], "bug_id": 49132, "attachment_id": 25332, "is_private": false, "id": 136313, "time": "2010-04-22T06:31:03Z", "creator": "alvins1982@hotmail.com", "creation_time": "2010-04-22T06:31:03Z", "text": "Created attachment 25332\nTest war file showing issue"}, {"count": 4, "tags": [], "bug_id": 49132, "attachment_id": null, "is_private": false, "id": 136314, "time": "2010-04-22T06:31:32Z", "creator": "markt@apache.org", "creation_time": "2010-04-22T06:31:32Z", "text": "Possible timing issue with listener events and JNDI init"}, {"count": 5, "tags": [], "creator": "markt@apache.org", "is_private": false, "text": "This has been fixed in 7.0.x and will be included in 7.0.0 onwards.", "id": 136368, "time": "2010-04-23T18:21:22Z", "bug_id": 49132, "creation_time": "2010-04-23T18:21:22Z", "attachment_id": null}, {"count": 6, "tags": [], "creator": "bugzilla@pidster.com", "is_private": false, "id": 136371, "creation_time": "2010-04-23T21:45:22Z", "time": "2010-04-23T21:45:22Z", "bug_id": 49132, "text": "(In reply to comment #5)\n> This has been fixed in 7.0.x and will be included in 7.0.0 onwards.\n\nI think this fix breaks Realms. I built Tomcat from trunk after this fix but it refuses to start up. \n\nIt looks like the call to getGlobalNamingContext() fails to start the problem. It would have logged \"Exception looking up UserDatabase under key UserDatabase\", but instead throws NPE because the containerLog field is null when UserDatabaseRealm.startInternal() is called.", "attachment_id": null}, {"count": 7, "tags": [], "text": "> It looks like the call to getGlobalNamingContext() fails to start the problem.\n\nBy which, I mean: \"... fails, which causes the main issue\".", "attachment_id": null, "id": 136372, "creator": "bugzilla@pidster.com", "time": "2010-04-24T06:37:17Z", "bug_id": 49132, "creation_time": "2010-04-24T06:37:17Z", "is_private": false}, {"count": 8, "attachment_id": null, "bug_id": 49132, "is_private": false, "id": 136373, "time": "2010-04-24T07:31:34Z", "creator": "bugzilla@pidster.com", "creation_time": "2010-04-24T07:31:34Z", "tags": [], "text": "(In reply to comment #7)\n> > It looks like the call to getGlobalNamingContext() fails to start the problem.\n> \n> By which, I mean: \"... fails, which causes the main issue\".\n\nLifeCycle.CONFIGURE_START_EVENT is currently only fired in StandardContext.java, previously the GlobalResources were initialised by a LifeCycle.START_EVENT in Catalina.java.\n\nAlso, I can't find a LifeCycle.AFTER_STOP_EVENT being fired anywhere."}, {"count": 9, "attachment_id": 25343, "bug_id": 49132, "is_private": false, "id": 136374, "time": "2010-04-24T11:35:29Z", "creator": "bugzilla@pidster.com", "creation_time": "2010-04-24T11:35:29Z", "tags": [], "text": "Created attachment 25343\nFires additional lifecycle event to ensure global resources are started"}, {"count": 10, "tags": [], "text": "Yep. My bad. Sorry about that.\n\nI fixed it by firing the stop/start configure events from StandardServer.\n\nRe LifeCycle.AFTER_STOP_EVENT, it is triggered by LifecycleBase.setState(LifecycleState.STOPPED) which will fire the event (LifeCycle.AFTER_STOP_EVENT) associated with a transition to that state.", "is_private": false, "bug_id": 49132, "id": 136382, "time": "2010-04-24T15:23:56Z", "creator": "markt@apache.org", "creation_time": "2010-04-24T15:23:56Z", "attachment_id": null}]