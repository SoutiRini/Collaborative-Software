[{"count": 0, "tags": [], "creator": "asvaza@gmail.com", "attachment_id": 30940, "text": "Created attachment 30940\nCorrect output\n\nDCC32 compiler for some lines uses single CR as line separator and for some lines LF. Until 1.8.3 output redirected to file was identical to original one, but since this version CR ones are removed from output so output file contains long lines. IMHO problem is related to 50507 fix.\n\n\n  <macrodef name=\"dcc32\">\n    <attribute name=\"file\" />\n    <attribute name=\"filebase\" />\n    <attribute name=\"switches\" default=\"\" />\n    <attribute name=\"subdir\" default=\"\" />\n    <attribute name=\"show\" default=\"true\" />\n    <sequential>\n      <delete>\n        <fileset dir=\"${logdir}\" includes=\"_cmp_@{file}.*,_err_@{file}.*\" />\n      </delete>\n\n      <echo>Compile: @{subdir}@{file}</echo>\n      <move file=\"@{filebase}.cfg\" tofile=\"@{filebase}.cfg.backup\" failonerror=\"false\"/>\n      <exec executable=\"${delphihome}\\bin\\dcc32.exe\" dir=\"@{subdir}\" failonerror=\"true\"\n          output=\"${logdir}\\_cmp_@{file}.log\" append=\"true\">\n        <arg value=\"@{file}\" />\n        <arg line=\"-B -E&quot;.&quot; -LE&quot;.&quot; -LN&quot;.&quot; -Z&quot;.&quot; -A -H -W -GD -cg -O -I\" />\n        <arg line=\"-$A+,B-,C+,D+,E-,F-,G+,H+,I+,J-,K-,L+,M-,N+,O-,P+,Q+,R-,S-,T-,U-,V-,W-,X+,Y+,Z1\" />\n        <arg line=\"${dcc32_lib}\" />\n        <arg line=\"-$M16384,1048576 -K$00400000\" />\n        <arg line=\"-N&quot;${dcudir}&quot;\" />\n        <arg line=\"@{switches}\" />\n      </exec>\n    </sequential>\n  </macrodef>", "id": 170668, "time": "2013-10-18T09:59:07Z", "bug_id": 55667, "creation_time": "2013-10-18T09:59:07Z", "is_private": false}, {"count": 1, "tags": [], "creator": "asvaza@gmail.com", "attachment_id": 30941, "text": "Created attachment 30941\nWrong output - ANT 1.8.3", "id": 170669, "time": "2013-10-18T10:00:35Z", "bug_id": 55667, "creation_time": "2013-10-18T10:00:35Z", "is_private": false}, {"count": 2, "tags": [], "creator": "asvaza@gmail.com", "attachment_id": null, "id": 170670, "creation_time": "2013-10-18T10:05:34Z", "time": "2013-10-18T10:05:34Z", "bug_id": 55667, "text": "Problem reproduced ANT 1.9.2", "is_private": false}, {"count": 3, "tags": [], "creator": "asvaza@gmail.com", "attachment_id": null, "text": "I found ugly workaround by normalizing newline characters before output reaches ANT level using cygwin tools mac2unix.exe and unix2dos.exe like\n\ncmd /c \"dcc32.exe all params | mac2unix | unix2dos\"\n\n<macrodef name=\"dcc32\">\n  <attribute name=\"file\" />\n  <attribute name=\"filebase\" />\n  <attribute name=\"switches\" default=\"\" />\n  <attribute name=\"subdir\" default=\"\" />\n  <attribute name=\"show\" default=\"true\" />\n  <sequential>\n    <delete>\n      <fileset dir=\"${logdir}\" includes=\"_cmp_@{file}.*,_err_@{file}.*\" />\n    </delete>\n\n    <echo>Compile: @{subdir}@{file}</echo>\n    <move file=\"@{filebase}.cfg\" tofile=\"@{filebase}.cfg.backup\" failonerror=\"false\"/>\n    <exec executable=\"cmd\" dir=\"@{subdir}\" failonerror=\"true\"\n        output=\"${logdir}\\_cmp_@{file}.log\" append=\"true\">\n      <arg line=\"/C &quot;${delphihome}\\bin\\dcc32.exe @{file} -B -E&quot;.&quot; -LE&quot;.&quot; -LN&quot;.&quot; -Z&quot;.&quot; -A -H -W -GD -cg -O -I -$A+,B-,C+,D+,E-,F-,G+,H+,I+,J-,K-,L+,M-,N+,O-,P+,Q+,R-,S-,T-,U-,V-,W-,X+,Y+,Z1 ${dcc32_lib} -$M16384,1048576 -K$00400000 -N&quot;${dcudir}&quot; @{switches} | D:\\cygwin\\bin\\mac2unix.exe | D:\\cygwin\\bin\\unix2dos.exe&quot;\" />\n    </exec>\n  </sequential>\n</macrodef>", "id": 170908, "time": "2013-10-29T14:19:16Z", "bug_id": 55667, "creation_time": "2013-10-29T14:19:16Z", "is_private": false}, {"count": 4, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "text": "You should be able to use a redirector in <exec> and <fixcrlf> inside your outputfilterchain.\n\nI don't think there is a reasonable way to \"fix\" Ant's end of line detection here so using fixcrlf to turn linefeeds into something useful seems the best choice to me.", "id": 171980, "time": "2013-12-31T13:43:46Z", "bug_id": 55667, "creation_time": "2013-12-31T13:43:46Z", "is_private": false}, {"count": 5, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "text": "redirector now has a binaryOutput attribute which when set to true prevents Ant from splitting the output into lines.\n\nsvn revision 1573617", "id": 173592, "time": "2014-03-03T17:12:41Z", "bug_id": 55667, "creation_time": "2014-03-03T17:12:41Z", "is_private": false}, {"count": 6, "tags": [], "creator": "asvaza@gmail.com", "attachment_id": null, "text": "(In reply to Stefan Bodewig from comment #5)\n> redirector now has a binaryOutput attribute which when set to true prevents\n> Ant from splitting the output into lines.\n\nSolution works well. Tested ANT 1.9.2 with patch applied. Thank you!", "id": 173605, "time": "2014-03-03T20:32:57Z", "bug_id": 55667, "creation_time": "2014-03-03T20:32:57Z", "is_private": false}]