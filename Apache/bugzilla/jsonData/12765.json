[{"count": 0, "attachment_id": null, "bug_id": 12765, "text": "I have written for my own use a couple of enhancements to <ftp> i would like to\nsee integrated into ant distribution.\nI have added \"rmdir\" and \"deltree\" actions.\n\"rmdir\" makes, well, what it says, removes from the remote server all the\ndirectories matched by the filesets.\n\"deltree\" is a pseudo action that is internally exploded in a \"delete\" and \n\"rmdir\" action using the same filesets.\nMore explanations are given in the updated documentation.\nPatches are included.\nI couldn't use cvs diff, because i'm behind a firewall and cannot access your\ncvs server. I used GNU diff -u to produce patches files.", "id": 23016, "time": "2002-09-18T11:43:58Z", "creator": "gabriele.garuglieri@infoblu.it", "creation_time": "2002-09-18T11:43:58Z", "tags": [], "is_private": false}, {"text": "Created attachment 3112\n\"rmdir\" action patch", "tags": [], "bug_id": 12765, "is_private": false, "count": 1, "id": 23022, "time": "2002-09-18T12:26:46Z", "creator": "gabriele.garuglieri@infoblu.it", "creation_time": "2002-09-18T12:26:46Z", "attachment_id": 3112}, {"count": 2, "tags": [], "bug_id": 12765, "is_private": false, "text": "Created attachment 3113\n\"rmdir\" action patch", "id": 23023, "time": "2002-09-18T12:27:48Z", "creator": "gabriele.garuglieri@infoblu.it", "creation_time": "2002-09-18T12:27:48Z", "attachment_id": 3113}, {"text": "Created attachment 3114\n\"deltree\" action patch", "tags": [], "bug_id": 12765, "is_private": false, "count": 3, "id": 23024, "time": "2002-09-18T12:28:23Z", "creator": "gabriele.garuglieri@infoblu.it", "creation_time": "2002-09-18T12:28:23Z", "attachment_id": 3114}, {"count": 4, "tags": [], "creator": "gabriele.garuglieri@infoblu.it", "attachment_id": 3115, "id": 23025, "time": "2002-09-18T12:28:44Z", "bug_id": 12765, "creation_time": "2002-09-18T12:28:44Z", "is_private": false, "text": "Created attachment 3115\n\"deltree\" action patch"}, {"count": 5, "tags": [], "bug_id": 12765, "attachment_id": null, "is_private": false, "id": 23026, "time": "2002-09-18T12:43:34Z", "creator": "gabriele.garuglieri@infoblu.it", "creation_time": "2002-09-18T12:43:34Z", "text": "Patch for \"rmdir\" action:\nattachment 3112 : patch for \njakarta-ant-1.5\\src\\main\\org\\apache\\tools\\ant\\taskdefs\\optional\\net\\FTP.java\nattachment 3113 : patch for jakarta-ant-1.5\\docs\\manual\\OptionalTasks\\ftp.html\n\nPatch for \"deltree\" action (need previous patch as prerequisite):\nattachment 3114 : patch for\njakarta-ant-1.5\\src\\main\\org\\apache\\tools\\ant\\taskdefs\\optional\\net\\FTP.java\nattachment 3115 : patch for jakarta-ant-1.5\\docs\\manual\\OptionalTasks\\ftp.html\n\nPls let me know if you plan to include this into ant distribution since i'd like\nto implement some production procedures based on this behaviour."}, {"count": 6, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 23253, "time": "2002-09-23T16:01:09Z", "bug_id": 12765, "creation_time": "2002-09-23T16:01:09Z", "is_private": false, "text": "I've committed the first part but am reluctant on the second as it changes the\npublished API of this task (and there already is at least one user written\nsubtask of this I am aware of).\n\ncan you rework the patch to preserve transferFiles(FTPClient, FileSet)?"}, {"count": 7, "attachment_id": null, "bug_id": 12765, "text": "Well, Stefan, you are rigth. I don't like it myself the way i implemented it.\nIt was a quick and dirty work.\nI thought of a different way, and i'll try to implement it when i get some new\nspare time, but i'd like an advice.\nDo you think is better to keep the \"deltree\" action that doesn't correspond to\nany real FTP command or adding an attribute, like deltree=\"true/false\", to\n\"delete\" and \"rmdir\" to say: when true don't limit yourself to files or dirs but\ndelete everything selected by the filesets? I would prefer the second way, but\ni'll stick with your decision.\n\nOne more thing, i have implemented a couple more attributes:\n\"purgeRemoteAfterSend\" that together with \"send\" action, i use to maintain in\nsync local an remote directories, in the sense that everything that was not\nselected for send is deleted from remote server, so i end with specular local\nand remote trees.\n\"dryrun\" that just simulate execution without doing anything. When used with\nverbose it produce a complete report of what it would have done. I find it very\nuseful expecially when deleting or removing to test filesets patterns.\nThey work for me but the code is not yet clean enough for a submission.\nDo you think you may be intererested in this?\n\nThanks,  Gabriele.", "id": 23283, "time": "2002-09-24T06:12:23Z", "creator": "gabriele.garuglieri@infoblu.it", "creation_time": "2002-09-24T06:12:23Z", "tags": [], "is_private": false}, {"text": "Well, if we follow the attribute route you line out, we could also simply drop\nrmdir again and tell delete to work on files, directories or both of them.\n\nFor your second option I would never use ftp for this, but simply rely on rsync,\nwhich even works over ssh.\n\nI haven't tried, but maybe using a <present> selector with the delete action works\nhere (so you'd end up writing two <ftp>s in your build file).", "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "count": 8, "id": 23360, "time": "2002-09-25T14:17:55Z", "bug_id": 12765, "creation_time": "2002-09-25T14:17:55Z", "is_private": false}]