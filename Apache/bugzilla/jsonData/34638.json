[{"count": 0, "tags": [], "creator": "brett@3sp.com", "attachment_id": null, "id": 74149, "time": "2005-04-26T22:33:27Z", "bug_id": 34638, "creation_time": "2005-04-26T22:33:27Z", "is_private": false, "text": "When using the javac task with the GCJ compiler, the boot classpath is always\nprovided to GCJ, regardless of the value of the 'includeJavaRuntime' attribute. \n\nThis seems to prevent gcj from being able to use its default classpath (i.e.\nusing libgcj classes only).\n\nTrying to compile to a native executable using the following task ..\n\n-- SNIP\n\n    <target name=\"compile\" depends=\"clean\">\n        <mkdir dir=\"${build.out.classes}\"/>\n        <mkdir dir=\"${build.out.exe}\"/>\n        <javac classpathref=\"flipper.classpath\" includeJavaRuntime=\"no\"        \n                includeAntRuntime=\"yes\" compiler=\"gcj\" \n                destdir=\"${build.out.classes}\">\n            <src path=\"${build.src}\"/>\n            <include name=\"**/*.java\" />\n            <compilerarg line=\"-march=i386 --main=org.tanktarta.flipper.Flipper\n-lgtkjava-${javagnome.gtk.version} -lgnomejava-${javagnome.gnome.version}\n-lgladejava-${javagnome.gnome.version} -lgconfjava-${javagnome.gnome.version} -o\n${build.out.exe}/flipper\"/>\n        </javac>\n    </target>\n\n-- SNIP\n\nResults in the following error ...\n\n-- SNIP\n\n[javac] java/lang/Object.java:0: fatal error: the `java.lang.Object' that was\nfound in `/opt/java/j2sdk1.4.2_05/jre/lib/rt.jar' didn't have the special\nzero-length `gnu.gcj.gcj-compiled' attribute.  This generally means that your\nclasspath is incorrectly set.  Use `info gcj \"Input Options\"' to see the info\npage describing how to set the classpath\n    [javac] compilation terminated.\n\n-- SNIP"}, {"count": 1, "attachment_id": null, "creator": "bodewig@apache.org", "text": "The workaround for Ant 1.6.3beta1 (and earlier) is to explicitly specify a\nbootclasspath (use some random directory that doesn't contain any classes, so it\nwon't hurt).\n\nFixed for 1.6.3.", "id": 74164, "time": "2005-04-27T11:46:29Z", "bug_id": 34638, "creation_time": "2005-04-27T11:46:29Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 34638, "attachment_id": null, "id": 80569, "time": "2005-09-28T22:19:30Z", "creator": "dickelbeck@yahoo.com", "creation_time": "2005-09-28T22:19:30Z", "is_private": false, "text": "This seems to have crept back in 1.6.5.\n\nWorse yet, the described work around does not work either.\n\nThis for gcj compiler."}, {"count": 3, "tags": [], "creator": "dickelbeck@yahoo.com", "attachment_id": null, "id": 80570, "time": "2005-09-28T22:25:02Z", "bug_id": 34638, "creation_time": "2005-09-28T22:25:02Z", "is_private": false, "text": "To test this, I create a shell script named \"gcj\" in the current directory.\n\n!/bin/sh\necho $0 $@\n\n-------\nthen run ant as follows:\n\n$ PATH=.:$PATH ant\n\nand you will see the exact command line for all of gcj"}, {"count": 4, "attachment_id": null, "bug_id": 34638, "is_private": false, "id": 82416, "time": "2005-11-12T16:27:48Z", "creator": "brett@3sp.com", "creation_time": "2005-11-12T16:27:48Z", "tags": [], "text": "I have some more info on this. It seems the problem stems from\norg.apache.tools.ant.types.Path.addExtdirs(Path extdirs). It tests whether null\nis being passed and if so then adds then value of the system property\n'java.ext.dirs' (which includes the Java Runtime path!)\n\nAdding the attribute extdirs=\"/home/ZZZZZZ\" in the same manner as the previous\nwork-around solves the problem.\n\n"}, {"count": 5, "attachment_id": null, "bug_id": 34638, "is_private": false, "id": 82417, "time": "2005-11-12T16:59:15Z", "creator": "brett@3sp.com", "creation_time": "2005-11-12T16:59:15Z", "tags": [], "text": "We have just discovered that includeAntRuntime=\"no\" must also be included for\nthis to work. I havn't investigated the reasons for this any further."}, {"count": 6, "tags": [], "text": "explicitly excluded extdirs if they haven't been specified, added a note about includeAntRuntime.\n\nsvn rev 675842", "is_private": false, "id": 118537, "creation_time": "2008-07-11T00:01:38Z", "time": "2008-07-11T00:01:38Z", "creator": "bodewig@apache.org", "bug_id": 34638, "attachment_id": null}]