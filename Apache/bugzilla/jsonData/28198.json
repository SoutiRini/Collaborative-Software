[{"count": 0, "tags": [], "bug_id": 28198, "attachment_id": null, "text": "POSTed data is not send to handler when use \"Action\" and \"AddHandler\". When I\nadd use the CGIWrap as handler of CGI, and regist it with \"Action\" and\n\"AddHandler\" statement.\n\nI wrote following into httpd.conf\n\n   AddHandler cgi-wrapper .cgi\n   ScriptAlias /.cgiwrapDir/ /usr/lib/cgiwrap/\n   Action cgi-wrapper /.cgiwrapDir/cgiwrap\n\nAnd I wrote a CGI program it recieve data sent by POST method. The environment\nvariable CONTENT_LENGTH was set correctory, but the CGI program cannot read any\nof data from its stdin.\n\nI traced mod_actions.c and mod_cgi.c. I found the variable r->read_length is not\nzero when above condition.", "id": 55283, "time": "2004-04-05T08:12:14Z", "creator": "masaru@turbolinux.co.jp", "creation_time": "2004-04-05T08:12:14Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 28198, "text": "I changed internal_internal_redirect() as following.\n\n--- src/main/http_request.c.internal-redirect   2004-04-05 16:53:23.000000000 +0900\n+++ src/main/http_request.c     2004-04-05 17:00:00.000000000 +0900\n@@ -1411,7 +1411,9 @@\n     new->no_cache        = r->no_cache;\n     new->expecting_100  = r->expecting_100;\n     new->no_local_copy   = r->no_local_copy;\n-    new->read_length     = r->read_length;     /* We can only read it once */\n+    if (new->method_number != M_POST) {\n+       new->read_length     = r->read_length;     /* We can only read it once */\n+    }\n     new->vlist_validator = r->vlist_validator;\n #ifdef CHARSET_EBCDIC /* @@@ Is this correct? When is it used? */\n     new->ebcdic.conv_out= r->ebcdic.conv_out;\n", "id": 55285, "time": "2004-04-05T08:14:03Z", "creator": "masaru@turbolinux.co.jp", "creation_time": "2004-04-05T08:14:03Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "masaru@turbolinux.co.jp", "attachment_id": null, "is_private": false, "id": 55290, "time": "2004-04-05T08:44:42Z", "bug_id": 28198, "creation_time": "2004-04-05T08:44:42Z", "text": "I had mistake, that patch doesn't fix this problem."}, {"count": 3, "tags": [], "bug_id": 28198, "attachment_id": null, "id": 55308, "time": "2004-04-05T13:18:43Z", "creator": "masaru@turbolinux.co.jp", "creation_time": "2004-04-05T13:18:43Z", "is_private": false, "text": "This problem is from mod_bandwidth-2.0.3. Here is backtrace-log of it.\n\n\n#0  0x08061196 in ap_discard_request_body ()\n#1  0x4077babf in handle_bw () from /usr/libexec/apache/mod_bandwidth.so\n#2  0x080538c3 in ap_invoke_handler ()\n#3  0x08063c5d in process_request_internal ()\n#4  0x08063cbd in ap_process_request ()\n#5  0x0805cfe5 in child_main ()\n#6  0x0805d208 in make_child ()\n#7  0x0805d281 in startup_children ()\n#8  0x0805d7e9 in standalone_main ()\n#9  0x0805df60 in main ()\n#10 0x400d73d8 in __libc_start_main () from /lib/libc.so.6\n\nThe handle_bw() of mod_bandwidth eats POSTed data. So mod_cgi cannot get it.\n\nPlease change the resolution of this bug ."}, {"count": 4, "tags": [], "creator": "slive@apache.org", "attachment_id": null, "is_private": false, "id": 55322, "time": "2004-04-05T14:45:37Z", "bug_id": 28198, "creation_time": "2004-04-05T14:45:37Z", "text": "Thanks for letting us know the resolution."}]