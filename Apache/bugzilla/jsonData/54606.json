[{"count": 0, "tags": [], "creator": "antoine@apache.org", "attachment_id": null, "id": 165469, "time": "2013-02-25T02:12:55Z", "bug_id": 54606, "creation_time": "2013-02-25T02:12:55Z", "is_private": false, "text": "Looking at the \"Core Trunk (Linux)\" build configuration of Ant done on TeamCity under http://teamcity.jetbrains.com/viewLog.html?buildId=77704 3 tests are failing.\nThese tests are core/nested-text-test.xml (testNumericEntities) and taskdefs/echo-test.xml (testUTF16Encoding and testUTF8Encoding).\n\ntestNumericEntities is echoing a string containing the a unlaut followed by the trademark sign and asserting that the log does indeed contain these signs. The string is entered as XML entities.\n\nI noticed by looking in detail at the build log that the system property file.encoding is set in this failing build to ANSI_X3.4-1968 which is a synonym for ASCII.\n\nThe same problem is reproducible on MacOS using JDK 1.7 (build 1.7.0_04-ea-b17 most probably because this JDK 1.7 build also defaults to an ASCII encoding.\n\nAnt did not have this bug back in Ant 1.7.1 and that the bug was introduced in Ant 1.8.0.\n\nRunning the following snipped :\n<target name=\"target2\">\n<delete file=\"abc.txt\" quiet=\"true\"/>\n<echo file=\"abc.txt\" encoding=\"UTF-8\" message=\"&#xe4;&#169;\">\n</echo>\n</target>\nis enough to illustrate the bug. Under Ant 1.7.1 the expected content \u00e4\u00a9 is output in \"abc.txt\""}, {"count": 1, "tags": [], "text": "I am looking at ResourceUtils.copyResource as a place where the bug could be.", "is_private": false, "bug_id": 54606, "id": 165470, "time": "2013-02-25T02:19:15Z", "creator": "antoine@apache.org", "creation_time": "2013-02-25T02:19:15Z", "attachment_id": null}]