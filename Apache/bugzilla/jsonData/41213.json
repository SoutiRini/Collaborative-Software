[{"count": 0, "tags": [], "creator": "jrn2005@cs.st-andrews.ac.uk", "text": "I have a web application which users first access through a static login page.\nThey then enter a username and password, and are redirected to a servlet, which\ncreates a session, sets whether they have authenticated successfully in that\nsession, and redirects them on to the next page:\n\nresponse.sendRedirect(response.encodeRedirectURL(url));\n\nThis worked fine in Tomcat versions up to 5.5.17, however having just installed\n5.5.20 on our development server, I now get a 404 error instead of the page.\nRemoving the \";jsessionid=...\" from the URL does work correctly (giving either a\n403 if the user is not logged in, or has cookies disabled, or the correct page\nif they're logged in and have cookies for the session system to use instead):\n\nhttps://bowmore.cs.st-andrews.ac.uk/finesse/Resources.do\n\nAt a guess, looking at the change log, \"Improve handling of the ';' character in\nthe URL so that it is now allowed if properly %xx encoded. (remm)\" is somehow\nrelated, but that's just a guess.\n\nTested using JDK 1.5_10, from Firefox 3.0 Alpha 1, Safari 2.0.4 and Lynx 2.8.5.", "id": 97084, "time": "2006-12-19T08:27:21Z", "bug_id": 41213, "creation_time": "2006-12-19T08:27:21Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "remm@apache.org", "text": "This works for me. Tested with Tomcat 6.0.", "id": 97122, "time": "2006-12-20T06:40:57Z", "bug_id": 41213, "creation_time": "2006-12-20T06:40:57Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "jrn2005@cs.st-andrews.ac.uk", "text": "I've created test accounts on the development and live systems:\n\nUsername: bug41213\nPassword: tomcat\n\nDev: https://bowmore.cs.st-andrews.ac.uk/finesse/\nLive: https://finesse.ac.uk/\n\nThe development version is running on Tomcat 5.5.20, the live version on 5.5.15\n(but we were doing testing on 5.5.17 on the development server, until recently,\nand that worked fine). As of now, they're both running exactly the same code.\n\nTo test, go to both sites, ensure cookies are disabled, and log in with the\nusername and password given. The development site should give an error, while\nthe live version should give you a fairly empty resources page.\n", "id": 97127, "time": "2006-12-20T08:25:49Z", "bug_id": 41213, "creation_time": "2006-12-20T08:25:49Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 41213, "is_private": false, "id": 97144, "creation_time": "2006-12-21T02:29:05Z", "time": "2006-12-21T02:29:05Z", "creator": "rm@moosauer.de", "text": "Hi,\n\nthis is not necessarily a tomcat bug.\nPlease evaluate this behavior with the examples shipped with tomcat.\nI suppose, this will work. If not: Report is as a bug with a minimal test \ncase!\nElse:\n- Trace your request processing (you use struts?) \n- Check if any front-end-servers (apache, load balancers) are interfering\n\nWe see, that your application is not working. But without any insight to \nsource code nothing can be done.\nYou have to create a mini-application which reproduces the error.\nQuite possible, you find an error in your own code.\nOr you can track it down to a tomcat error, then provide your test case with \nsources here.\n\nGood luck\nR.", "attachment_id": null}, {"count": 4, "tags": [], "creator": "jrn2005@cs.st-andrews.ac.uk", "attachment_id": null, "id": 97154, "time": "2006-12-21T06:06:22Z", "bug_id": 41213, "creation_time": "2006-12-21T06:06:22Z", "is_private": false, "text": "Will produce a test case next, but in the meantime good suggestion with the\nfront-end server. Turns out this only shows up when using mod_jk to pass\nconnections from the Apache server. Connecting directly to the server, or via\nApache set up for proxying, works fine. Proxy version up at:\n\nhttps://bowmore.cs.st-andrews.ac.uk/finesse-proxy/\n\nif you're interested. Off to produce a test case next.\n"}, {"count": 5, "tags": [], "creator": "jrn2005@cs.st-andrews.ac.uk", "text": "Created attachment 19298\nTest case\n\nTest case. Designed by compiled and deployed using ant... requires that\n\"catalina.home\" and \"javacc.home\" properties are set in a build.properties\neither in the current user's home directory, or the current directory. To\ncompile and deploy, type \"ant deploy\".\n\nCan be seen on a live system at https://bowmore.cs.st-andrews.ac.uk/bug41213/", "id": 97155, "time": "2006-12-21T06:31:57Z", "bug_id": 41213, "creation_time": "2006-12-21T06:31:57Z", "is_private": false, "attachment_id": 19298}, {"count": 6, "tags": [], "bug_id": 41213, "is_private": false, "text": "Hi,\n\nI tried a URL encoded session id with mod_jk/1.2.20 and Apache 2.0.58 and it did\nwork. I believe the decoding already happens inside apache, before passing the\nrequest to mod_jk, and it should work with older versions too. Please increase\nyour JkLogLevel to debug and compare the result on a URL encoded request with\nthe following log output:\n\n[Fri Dec 22 09:54:08 2006] [13973:63840] [debug]\nmap_uri_to_worker::jk_uri_worker_map.c (569): Removing Session path\n';jsessionid=5A83896B1E0B44C6FEB0E912C5EEF25A.w-1' URI '/session.jsp'\n[Fri Dec 22 09:54:08 2006] [13973:63840] [debug]\nmap_uri_to_worker::jk_uri_worker_map.c (575): Attempting to map URI\n'/session.jsp;jsessionid=5A83896B1E0B44C6FEB0E912C5EEF25A.w-1' from 6 maps\n[Fri Dec 22 09:54:08 2006] [13973:63840] [debug]\nmap_uri_to_worker::jk_uri_worker_map.c (587): Attempting to map context URI\n'/jsp-examples/*=lb' source 'worker definition'\n[Fri Dec 22 09:54:08 2006] [13973:63840] [debug]\nmap_uri_to_worker::jk_uri_worker_map.c (587): Attempting to map context URI\n'/modjk/*=w-1' source 'worker definition'\n[Fri Dec 22 09:54:08 2006] [13973:63840] [debug]\nmap_uri_to_worker::jk_uri_worker_map.c (587): Attempting to map context URI\n'/jsp-examples=lb' source 'worker definition'\n[Fri Dec 22 09:54:08 2006] [13973:63840] [debug]\nmap_uri_to_worker::jk_uri_worker_map.c (587): Attempting to map context URI\n'/jkstatus2=status2' source 'worker definition'\n[Fri Dec 22 09:54:08 2006] [13973:63840] [debug]\nmap_uri_to_worker::jk_uri_worker_map.c (587): Attempting to map context URI\n'/*.jsp=lb' source 'worker definition'\n[Fri Dec 22 09:54:08 2006] [13973:63840] [debug]\nmap_uri_to_worker::jk_uri_worker_map.c (602): Found a wildchar match '/*.jsp=lb'\n[Fri Dec 22 09:54:08 2006] [13973:63840] [debug] jk_handler::mod_jk.c (1999):\nInto handler jakarta-servlet worker=lb r->proxyreq=0\n[Fri Dec 22 09:54:08 2006] [13973:63840] [debug]\nwc_get_worker_for_name::jk_worker.c (114): found a worker lb\n[Fri Dec 22 09:54:08 2006] [13973:63840] [debug] wc_maintain::jk_worker.c (321):\nMaintaining worker w-1\n[Fri Dec 22 09:54:08 2006] [13973:63840] [debug] wc_maintain::jk_worker.c (321):\nMaintaining worker lb\n[Fri Dec 22 09:54:08 2006] [13973:63840] [debug]\nmaintain_workers::jk_lb_worker.c (509): decay with 2^2\n[Fri Dec 22 09:54:08 2006] [13973:63840] [debug]\nwc_get_name_for_type::jk_worker.c (290): Found worker type 'lb'\n[Fri Dec 22 09:54:08 2006] [13973:63840] [debug] init_ws_service::mod_jk.c\n(584): Service protocol=HTTP/1.1 method=GET host=(null) addr=127.0.0.1\nname=localhost port=8080 auth=(null) user=(null) laddr=127.0.0.1 raddr=127.0.0.1\n[Fri Dec 22 09:54:08 2006] [13973:63840] [debug] service::jk_lb_worker.c (840):\nservice sticky_session=1 id='5A83896B1E0B44C6FEB0E912C5EEF25A.w-1'\n[Fri Dec 22 09:54:08 2006] [13973:63840] [debug] service::jk_lb_worker.c (860):\nservice worker=w-2 route=w-2\n\nIf you think, it's a mod_jk bug, we need the relevant parts of your web serer\nconfig, your mod_jk config and the version and platform information.\n\n", "id": 97182, "time": "2006-12-22T01:36:09Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2006-12-22T01:36:09Z", "attachment_id": null}]