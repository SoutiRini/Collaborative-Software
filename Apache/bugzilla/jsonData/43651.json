[{"count": 0, "tags": [], "bug_id": 43651, "attachment_id": null, "text": "I use FOP in a stand alone application (Eclipse RCP) for Export (PDF, PS) AND\nPrint (direct awt print) from the same fop-sources. One and the same FopFactory\nis used per application run.\n\nThe AWT-Print renderer is set up by:\n\nPrintRenderer renderer = new PrintRenderer(printerJob);\nrenderer.setUserAgent(userAgent);\nuserAgent.setRendererOverride(renderer);\n\nEach transformation type (print or export) works for its own.\nDoing an export followed by a print transformation (or the way around) of the\nsame source results in a NullPointerExeption for each Image. Please see the\nstack trace below.\n\nIn other words:\nIf you start with an export you can always do a successfull export, but never an\nawt-print.\nIf you start with an awt-print you can always do a successfull awt-print but\nnever an export.\n\nManually clearing the ImageCache solves the problem.\nAs the API of org.apache.fop.image.ImageFactory.clearCaches() points out, this\nmust be an issue.\n\nThe URLs does not change between the fop-runs.\nIts protocol is OSGI-specific and shouldn't be the source\nof the problem. Similar URLs work perfect in all other parts of the application\nand with clearing the ImageCache too.\n\n\nStack trace following:\n\n\n\n\n18.10.2007 17:30:49 org.apache.fop.image.JpegImageIOImage loadBitmap\nSCHWERWIEGEND: Error while loading image: null\njava.lang.NullPointerException\n\tat org.apache.fop.image.JpegImageIOImage.loadBitmap(JpegImageIOImage.java:64)\n\tat org.apache.fop.image.AbstractFopImage.load(AbstractFopImage.java:169)\n\tat org.apache.fop.render.java2d.Java2DRenderer.drawImage(Java2DRenderer.java:926)\n\tat\norg.apache.fop.render.AbstractPathOrientedRenderer.drawImage(AbstractPathOrientedRenderer.java:678)\n\tat org.apache.fop.render.java2d.Java2DRenderer.renderImage(Java2DRenderer.java:882)\n\tat org.apache.fop.render.AbstractRenderer.renderViewport(AbstractRenderer.java:748)\n\tat\norg.apache.fop.render.AbstractPathOrientedRenderer.renderViewport(AbstractPathOrientedRenderer.java:541)\n\tat\norg.apache.fop.render.AbstractRenderer.renderInlineArea(AbstractRenderer.java:631)\n\tat org.apache.fop.render.AbstractRenderer.renderLineArea(AbstractRenderer.java:606)\n\tat org.apache.fop.render.AbstractRenderer.renderBlocks(AbstractRenderer.java:532)\n\tat org.apache.fop.render.AbstractRenderer.renderBlock(AbstractRenderer.java:582)\n\tat org.apache.fop.render.AbstractRenderer.renderBlocks(AbstractRenderer.java:522)\n\tat org.apache.fop.render.AbstractRenderer.renderFlow(AbstractRenderer.java:427)\n\tat\norg.apache.fop.render.AbstractRenderer.renderMainReference(AbstractRenderer.java:406)\n\tat\norg.apache.fop.render.AbstractRenderer.renderBodyRegion(AbstractRenderer.java:340)\n\tat\norg.apache.fop.render.AbstractRenderer.renderRegionViewport(AbstractRenderer.java:285)\n\tat\norg.apache.fop.render.AbstractRenderer.renderPageAreas(AbstractRenderer.java:258)\n\tat org.apache.fop.render.java2d.Java2DRenderer.print(Java2DRenderer.java:991)\n\tat sun.print.RasterPrinterJob.printPage(Unknown Source)\n\tat sun.print.RasterPrinterJob.print(Unknown Source)\n\tat sun.print.RasterPrinterJob.print(Unknown Source)\n\tat org.apache.fop.render.print.PrintRenderer.stopRenderer(PrintRenderer.java:143)\n\tat org.apache.fop.area.RenderPagesModel.endDocument(RenderPagesModel.java:245)\n\tat org.apache.fop.area.AreaTreeHandler.endDocument(AreaTreeHandler.java:283)\n\tat org.apache.fop.fo.FOTreeBuilder.endDocument(FOTreeBuilder.java:171)\n\tat\norg.apache.xalan.transformer.TransformerIdentityImpl.endDocument(TransformerIdentityImpl.java:962)\n\tat org.apache.xerces.parsers.AbstractSAXParser.endDocument(Unknown Source)\n\tat org.apache.xerces.impl.XMLDocumentScannerImpl.endEntity(Unknown Source)\n\tat org.apache.xerces.impl.XMLEntityManager.endEntity(Unknown Source)\n\tat org.apache.xerces.impl.XMLEntityScanner.load(Unknown Source)\n\tat org.apache.xerces.impl.XMLEntityScanner.skipSpaces(Unknown Source)\n\tat\norg.apache.xerces.impl.XMLDocumentScannerImpl$TrailingMiscDispatcher.dispatch(Unknown\nSource)\n\tat org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown\nSource)\n\tat org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n\tat org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n\tat org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\n\tat org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)\n\tat\norg.apache.xalan.transformer.TransformerIdentityImpl.transform(TransformerIdentityImpl.java:484)\n\tat de.tragwerk.xtrn.fop.internal.FopPrintJob.run(FopPrintJob.java:111)\n\tat org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)\n18.10.2007 17:30:49 org.apache.fop.render.java2d.Java2DRenderer drawImage\nWARNUNG: Loading of bitmap failed: bundleentry://706/xsl/Anordnung.jpg\n18.10.2007 17:30:49 org.apache.fop.image.JpegImageIOImage loadBitmap", "id": 109465, "time": "2007-10-18T08:54:11Z", "creator": "spacehorst@gmail.com", "creation_time": "2007-10-18T08:54:11Z", "is_private": false}, {"count": 1, "tags": [], "text": "additional information:\n\nfor a successful workaround you must clear the cache BEFORE starting a\ntransformation.", "attachment_id": null, "id": 109470, "creator": "spacehorst@gmail.com", "time": "2007-10-18T10:57:36Z", "bug_id": 43651, "creation_time": "2007-10-18T10:57:36Z", "is_private": false}, {"count": 2, "tags": [], "creator": "mhilpert@gmx.de", "text": "With FOP 0.95 I also have a problem with the image cache: when I run a second document with the same SVG image file name but different image content, the subsequent documents always use the first image.\n\nClearing the image cache via org.apache.fop.image.ImageFactory.clearCaches()  doesn't work anymore as FOP 0.95 doesn't have this class/method.\n\n(This also disables multi-threading of FOP document generations.)\n\nHow can I clear the image cache in FOP 0.95? The FAQ (http://xmlgraphics.apache.org/fop/faq.html) doesn't tell also.)", "id": 121710, "attachment_id": null, "bug_id": 43651, "creation_time": "2008-10-21T02:15:11Z", "time": "2008-10-21T02:15:11Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 43651, "text": "Please upgrade to FOP 0.95 where this problem should be solved by the introduction of the new image loader framework.", "id": 121716, "time": "2008-10-21T03:07:37Z", "creator": "jeremias@apache.org", "creation_time": "2008-10-21T03:07:37Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 43651, "attachment_id": null, "id": 121739, "time": "2008-10-21T10:39:54Z", "creator": "spacehorst@gmail.com", "creation_time": "2008-10-21T10:39:54Z", "is_private": false, "text": "(In reply to comment #3)\n> Please upgrade to FOP 0.95 where this problem should be solved by the\n> introduction of the new image loader framework.\n> \n\nverified in the scope of comment #0\nnot sure if M.T.'s request is solved\n\nSebastian\n\n"}, {"count": 5, "tags": [], "bug_id": 43651, "text": "(In reply to comment #4)\n> (In reply to comment #3)\n> > Please upgrade to FOP 0.95 where this problem should be solved by the\n> > introduction of the new image loader framework.\n> > \n> \n> verified in the scope of comment #0\n\nThanks for the feedback!\n\n> not sure if M.T.'s request is solved\n\nThat is being addressed as part of Bug #46048.\n\n> \n> Sebastian\n> \n\n", "id": 121749, "attachment_id": null, "creator": "jeremias@apache.org", "creation_time": "2008-10-21T14:26:44Z", "time": "2008-10-21T14:26:44Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 43651, "text": "batch transition to closed remaining pre-FOP1.0 resolved bugs", "id": 156660, "time": "2012-04-01T13:51:03Z", "creator": "gadams@apache.org", "creation_time": "2012-04-01T13:51:03Z", "is_private": false, "attachment_id": null}]