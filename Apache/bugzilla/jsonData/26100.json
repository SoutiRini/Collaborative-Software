[{"attachment_id": null, "tags": [], "bug_id": 26100, "is_private": false, "count": 0, "id": 50478, "time": "2004-01-13T15:31:48Z", "creator": "jun.zuo@mscsoftware.com", "creation_time": "2004-01-13T15:31:48Z", "text": "In version 2.0 (2.0-RC2) but not 1.5.1, if a cell contains an IF statement that \nhas a message longer than 127 characters, the following error occurs:\n\njava.lang.reflect.InvocationTargetException: \njava.lang.IllegalArgumentException: Illegal length\n\tat org.apache.poi.util.StringUtil.getFromUnicode(StringUtil.java:170)\n\tat org.apache.poi.hssf.record.formula.StringPtg.<init>\n(StringPtg.java:92)\n\tat org.apache.poi.hssf.record.formula.Ptg.createPtg(Ptg.java:272)\n\tat org.apache.poi.hssf.record.FormulaRecord.getParsedExpressionTokens\n(FormulaRecord.java:181)\n\tat org.apache.poi.hssf.record.FormulaRecord.fillFields\n(FormulaRecord.java:157)\n\tat org.apache.poi.hssf.record.Record.fillFields(Record.java:127)\n\tat org.apache.poi.hssf.record.Record.<init>(Record.java:92)\n\tat org.apache.poi.hssf.record.FormulaRecord.<init>\n(FormulaRecord.java:122)\n\tat java.lang.reflect.Constructor.newInstance(Native Method)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java:257)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java:193)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:207)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:254)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:235)"}, {"attachment_id": null, "tags": [], "bug_id": 26100, "is_private": false, "count": 1, "id": 50479, "time": "2004-01-13T15:38:43Z", "creator": "avik@apache.org", "creation_time": "2004-01-13T15:38:43Z", "text": "I vaguely remember there was a good reason for this limitation in POI .. I\nthought excel had issues with long strings in formulas in some situations.. You\nare trying to read an existing excel file, i presume??\n\nIs it possible for you to attach the file to this bug? What version of Excel did\nu save the file with?"}, {"count": 2, "tags": [], "creator": "jun.zuo@mscsoftware.com", "text": "Created attachment 9937\nSample Excel file (version Excel 2000)", "id": 50484, "time": "2004-01-13T16:11:29Z", "bug_id": 26100, "creation_time": "2004-01-13T16:11:29Z", "is_private": false, "attachment_id": 9937}, {"count": 3, "tags": [], "bug_id": 26100, "attachment_id": null, "text": "With the attached Excel, the error is:\n\njava.lang.reflect.InvocationTargetException: \njava.lang.StringIndexOutOfBoundsException: length must be >= 0\n\tat java.lang.String.<init>(Unknown Source)\n\tat java.lang.String.<init>(Unknown Source)\n\tat org.apache.poi.util.StringUtil.getFromCompressedUnicode\n(StringUtil.java:212)\n\tat org.apache.poi.hssf.record.formula.StringPtg.<init>\n(StringPtg.java:94)\n\tat org.apache.poi.hssf.record.formula.Ptg.createPtg(Ptg.java:272)\n\tat org.apache.poi.hssf.record.FormulaRecord.getParsedExpressionTokens\n(FormulaRecord.java:181)\n\tat org.apache.poi.hssf.record.FormulaRecord.fillFields\n(FormulaRecord.java:157)\n\tat org.apache.poi.hssf.record.Record.fillFields(Record.java:127)\n\tat org.apache.poi.hssf.record.Record.<init>(Record.java:92)\n\tat org.apache.poi.hssf.record.FormulaRecord.<init>\n(FormulaRecord.java:122)\n\tat java.lang.reflect.Constructor.newInstance(Native Method)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java:257)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java:193)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:207)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:254)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:235)\n\t", "id": 50486, "time": "2004-01-13T16:13:15Z", "creator": "jun.zuo@mscsoftware.com", "creation_time": "2004-01-13T16:13:15Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 26100, "attachment_id": null, "is_private": false, "id": 75117, "time": "2005-05-20T12:11:36Z", "creator": "avik@apache.org", "creation_time": "2005-05-20T12:11:36Z", "text": "*** Bug 26894 has been marked as a duplicate of this bug. ***"}, {"attachment_id": null, "tags": [], "bug_id": 26100, "text": "Works as of 12Jan2007, Testcase added. \nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=41366", "count": 5, "id": 98101, "time": "2007-01-16T01:34:03Z", "creator": "avik@apache.org", "creation_time": "2007-01-16T01:34:03Z", "is_private": false}]