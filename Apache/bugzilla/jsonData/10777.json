[{"count": 0, "attachment_id": null, "bug_id": 10777, "is_private": false, "id": 19483, "time": "2002-07-13T19:55:57Z", "creator": "sergeikozello@mail.ru", "creation_time": "2002-07-13T19:55:57Z", "tags": [], "text": "While saving sheet I want that current country will be set automatically \ndepending on locale."}, {"count": 1, "attachment_id": null, "bug_id": 10777, "is_private": false, "id": 19484, "time": "2002-07-13T20:00:29Z", "creator": "sergeikozello@mail.ru", "creation_time": "2002-07-13T20:00:29Z", "tags": [], "text": "The locale depending code has been added but just for Russian.\nAs more contributers from different country can find out the code for their \ncurrent country property, they can add more locale-dependent code.\n\nIndex: src/java/org/apache/poi/hssf/model/Workbook.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-\npoi/src/java/org/apache/poi/hssf/model/Workbook.java,v\nretrieving revision 1.10\ndiff -r1.10 Workbook.java\n62a63\n> import java.util.Locale;\n408a410\n>     \n418c420,425\n<     public void setSheetName(int sheetnum, String sheetname) {\n---\n>     // for compartibility\n>     public void setSheetName(int sheetnum, String sheetname ) {\n>         setSheetName( sheetnum, sheetname, (byte)0 );\n>     }\n>     \n>     public void setSheetName(int sheetnum, String sheetname, short encoding ) \n{\n420,423c427,431\n<         (( BoundSheetRecord ) boundsheets.get(sheetnum))\n<         .setSheetname(sheetname);\n<         (( BoundSheetRecord ) boundsheets.get(sheetnum))\n<         .setSheetnameLength(( byte ) sheetname.length());\n---\n>         \n>         BoundSheetRecord sheet = (BoundSheetRecord)boundsheets.get( \nsheetnum );\n>         sheet.setSheetname(sheetname);\n>         sheet.setSheetnameLength( (byte)sheetname.length() );\n> \t\tsheet.setCompressedUnicodeFlag( (byte)encoding );\n1581c1589,1590\n<      * Creates the Country record with the default and current country set to \n1\n---\n>      * Creates the Country record with the default country set to 1\n>      * and current country set to 7 in case of russian locale (\"ru_RU\") and 1 \notherwise\n1591c1600,1608\n<         retval.setCurrentCountry(( short ) 1);\n---\n>         \n>         // from Russia with love ;)\n>         if ( Locale.getDefault().toString().equals( \"ru_RU\" ) ) {\n> \t        retval.setCurrentCountry(( short ) 7);\n>         }\n>         else {\n> \t        retval.setCurrentCountry(( short ) 1);\n>         }\n>         \n"}, {"count": 2, "tags": [], "text": "Please resubmit this as an attachment (click \"create a new attachment\" above). \nI can't apply patches that I cut and paste from the browser, they always are\ngarbled.  \nSorry.  (not trying to be pedantic, I just can't make it work)\n\nThanks,\n\n-Andy", "attachment_id": null, "bug_id": 10777, "id": 19525, "time": "2002-07-15T02:18:24Z", "creator": "poi-support@buni.org", "creation_time": "2002-07-15T02:18:24Z", "is_private": false}, {"count": 3, "tags": [], "creator": "poi-support@buni.org", "attachment_id": null, "id": 19923, "time": "2002-07-21T13:11:56Z", "bug_id": 10777, "creation_time": "2002-07-21T13:11:56Z", "is_private": false, "text": "\n\n*** This bug has been marked as a duplicate of 10548 ***"}]