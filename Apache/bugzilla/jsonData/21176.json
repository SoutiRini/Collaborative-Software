[{"count": 0, "tags": [], "text": "I experiment frequent memory leaks using servlets with Tomcat.\n\nAs a simple test, i wrote this servlet:\n\nimport java.io.*;\nimport java.util.* ;\n\nimport javax.servlet.*;\nimport javax.servlet.http.*;\n\npublic class TestServlet extends HttpServlet {\n\n  int liCount = 0 ;\n    \n  public void doGet(HttpServletRequest request, HttpServletResponse response) \nthrows ServletException {\n\n    try  {\n    \tRuntime lRuntime = Runtime.getRuntime();\n\n    \tStringBuffer lOut = new StringBuffer();\n    \tlOut.append(\"Loop,\") ;\n    \tlOut.append((++liCount)) ;\n    \tlOut.append(\",Total,\") ;\n    \tlOut.append(lRuntime.totalMemory()) ;\n    \tlOut.append(\",Used,\") ;\n    \tlOut.append(lRuntime.totalMemory() - lRuntime.freeMemory()) ;\n    \tlOut.append(\",Free,\") ;\n    \tlOut.append(lRuntime.freeMemory()) ;  \n        \n    \tSystem.out.println(lOut.toString());\n    } catch (Exception ex)  {\n    }\n    \n  }  \n\n}\n\nExamining the results, you can easily find out that memory usage keeps growing \nconstantly.\n\nMemory usage starts from 18.528.360 and, after about 10.000 iterations reaches \n32.509.816\n\nThanks", "is_private": false, "id": 39623, "creator": "stefano.bertini@plangroup.it", "time": "2003-06-30T07:30:21Z", "bug_id": 21176, "creation_time": "2003-06-30T07:30:21Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 21176, "attachment_id": null, "text": "And after some time, GC will occur, freeing memory. Please do not file that kind\nof report, post on tomcat-user instead.", "id": 39626, "time": "2003-06-30T08:18:27Z", "creator": "remm@apache.org", "creation_time": "2003-06-30T08:18:27Z", "is_private": false}, {"count": 2, "tags": [], "text": "I know what GC is !!!\n\nIf you examine the results, you see that GC occours about every 70-80 calls to \nthe servlet. \n\nThe problem is that even after every GC, the memory usage is higher than the \none of the previous GC...\n\n", "attachment_id": null, "bug_id": 21176, "id": 39628, "time": "2003-06-30T08:24:12Z", "creator": "stefano.bertini@plangroup.it", "creation_time": "2003-06-30T08:24:12Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 21176, "attachment_id": null, "text": "Please post on tc-user to investigate this, as many people will be able to give\nyou detailed comments and tips. Please do not reopen this bug.", "id": 39629, "time": "2003-06-30T09:00:42Z", "creator": "remm@apache.org", "creation_time": "2003-06-30T09:00:42Z", "is_private": false}]