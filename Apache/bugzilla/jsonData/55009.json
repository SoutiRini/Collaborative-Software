[{"count": 0, "tags": [], "bug_id": 55009, "attachment_id": null, "text": "there is two question:\n\n1. Manually create a ShapeGroup  in slide, and the ShapeGroup contains a TextBox. If the TextBox includes chinese character in it. When extract the ppt using POI, the TextRun of TextBox is null, and the text in TextBox will also null.\n\n2. I use POI create PPT includes a ShapeGroup, the  ShapeGroup has some TextBoxs in it. Then using POI to parse the ppt, the TextRun of TextBox in ShapeGroup is null.\n\nThanks very much, I really confused. \nI am eager for your reply.\nThanks in advance.", "id": 167370, "time": "2013-05-23T09:38:25Z", "creator": "zlfdtc1983@126.com", "creation_time": "2013-05-23T09:38:25Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 55009, "attachment_id": null, "text": "I have solved this problem. the class TextShape has some problem. Function getTextRun() is as follows:\n\npublic TextRun getTextRun(){\n        if (null == this._txtrun) initTextRun();\n        if (null == this._txtrun && null != this._txtbox) {\n        \tTextHeaderAtom    tha = null; \n        \tTextBytesAtom     tba = null;\n        \tStyleTextPropAtom sta = null;\n        \tRecord[] childRecords = this._txtbox.getChildRecords();\n        \tfor (Record r : childRecords) {\n        \t\tif (r instanceof TextHeaderAtom) {\n        \t\t\ttha = (TextHeaderAtom) r;\n\t\t\t\t} else if (r instanceof TextBytesAtom) {\n\t\t\t\t\ttba = (TextBytesAtom) r;\n\t\t\t\t} else if (r instanceof StyleTextPropAtom) {\n\t\t\t\t\tsta = (StyleTextPropAtom) r;\n\t\t\t\t}\n        \t}\n        \tif (null != tba) {\n        \t\tthis._txtrun = new TextRun(tha, tba, sta);\n        \t}\n         }\n         return _txtrun;\n     }\nbut sometimes the text is not TextBytesAtom but TextCharsAtom. And TextRun has two construct function. in this case, we should use another construct function.\nRewrite it as:\n\npublic TextRun getTextRun() {\n    \t// TODO Auto-generated method stub\n    \tif (null == this._txtrun) initTextRun();\n        if (null == this._txtrun && null != this._txtbox) {\n        \tTextHeaderAtom    tha = null; \n        \tTextBytesAtom     tba = null;\n        \tStyleTextPropAtom sta = null;\n        \tTextCharsAtom    tca = null;\n        \tRecord[] childRecords = this._txtbox.getChildRecords();\n        \tfor (Record r : childRecords) {\n        \t\tif (r instanceof TextHeaderAtom) {\n        \t\t\ttha = (TextHeaderAtom) r;\n\t\t\t\t} else if (r instanceof TextBytesAtom) {\n\t\t\t\t\ttba = (TextBytesAtom) r;\n\t\t\t\t} else if (r instanceof StyleTextPropAtom) {\n\t\t\t\t\tsta = (StyleTextPropAtom) r;\n\t\t\t\t}else if (r instanceof TextCharsAtom) {\n\t\t\t\t\ttca = (TextCharsAtom) r;\n\t\t\t\t}\n        \t}\n        \tif (null != tba) {\n        \t\tthis._txtrun = new TextRun(tha, tba, sta);\n        \t}else if (null != tca) {\n        \t\tthis._txtrun = new TextRun(tha, tca, sta);\n\t\t\t}\n         }\n         return _txtrun;\n    }\n}", "id": 167429, "time": "2013-05-27T08:32:41Z", "creator": "zlfdtc1983@126.com", "creation_time": "2013-05-27T08:32:41Z", "is_private": false}]