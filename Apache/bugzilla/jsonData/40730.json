[{"count": 0, "tags": [], "bug_id": 40730, "is_private": false, "text": "... which in turn is called by the Coyote InternalOutputBuffer.  Reported on the\ndev@tomcat mailing list by j.random.programmer (email addressed scratched) on\nOctober 20th 2006.  Email pasted below.\n\nHi:\n\nI'm getting these at random, tomcat version: 5.5.20\n\nThese looks like a serious coding bug (there should\nnever\nbe ArrayIndexOutOfBoundsExceptions), but it's not\nclear\nwhether this bug exists in the JDK or in the tomcat\ncode.\n\n\n# java -version\njava version \"1.5.0_06\"\nJava(TM) 2 Runtime Environment, Standard Edition\n(build 1.5.0_06-112)\nJava HotSpot(TM) Client VM (build 1.5.0_06-64, mixed\nmode, sharing)\n\n\nBest regards,\n--j\n----------------Crash Error ------------------------\n\njava.lang.ArrayIndexOutOfBoundsException\n       at java.lang.System.arraycopy(Native Method)\n       at\norg.apache.coyote.http11.InternalOutputBuffer.write(InternalOutputBuffer.java:689)\n       at\norg.apache.coyote.http11.InternalOutputBuffer.sendStatus(InternalOutputBuffer.java:428)\n       at\norg.apache.coyote.http11.Http11Processor.prepareResponse(Http11Processor.java:1604)\n       at\norg.apache.coyote.http11.Http11Processor.action(Http11Processor.java:962)\n       at\norg.apache.coyote.Response.action(Response.java:180)\n       at\norg.apache.coyote.http11.InternalOutputBuffer.doWrite(InternalOutputBuffer.java:572)\n       at\norg.apache.coyote.Response.doWrite(Response.java:559)\n       at\norg.apache.catalina.connector.OutputBuffer.realWriteBytes(OutputBuffer.java:361)\n       at\norg.apache.tomcat.util.buf.ByteChunk.append(ByteChunk.java:324)\n       at\norg.apache.tomcat.util.buf.IntermediateOutputStream.write(C2BConverter.java:235)\n       at\nsun.nio.cs.StreamEncoder$CharsetSE.writeBytes(StreamEncoder.java:336)\n       at\nsun.nio.cs.StreamEncoder$CharsetSE.implFlushBuffer(StreamEncoder.java:404)\n       at\nsun.nio.cs.StreamEncoder$CharsetSE.implFlush(StreamEncoder.java:408)\n       at\nsun.nio.cs.StreamEncoder.flush(StreamEncoder.java:152)\n       at\njava.io.OutputStreamWriter.flush(OutputStreamWriter.java:213)\n       at\norg.apache.tomcat.util.buf.WriteConvertor.flush(C2BConverter.java:184)\n       at\norg.apache.tomcat.util.buf.C2BConverter.flushBuffer(C2BConverter.java:127)\n       at\norg.apache.catalina.connector.OutputBuffer.realWriteChars(OutputBuffer.java:536)\n       at\norg.apache.tomcat.util.buf.CharChunk.flushBuffer(CharChunk.java:439)\n       at\norg.apache.catalina.connector.OutputBuffer.close(OutputBuffer.java:268)\n       at\norg.apache.catalina.connector.Response.finishResponse(Response.java:476)\n       at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:151)\n       at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:869)\n       at\norg.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:664)\n       at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)\n       at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)\n       at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n       at java.lang.Thread.run(Thread.java:613)\nOct 10, 2006 7:02:28 PM\norg.apache.coyote.http11.Http11Processor process\nSEVERE: Error finishing response\njava.lang.ArrayIndexOutOfBoundsException\n       at java.lang.System.arraycopy(Native Method)\n       at\norg.apache.coyote.http11.InternalOutputBuffer.write(InternalOutputBuffer.java:689)\n       at\norg.apache.coyote.http11.InternalOutputBuffer.sendStatus(InternalOutputBuffer.java:428)\n       at\norg.apache.coyote.http11.Http11Processor.prepareResponse(Http11Processor.java:1604)\n       at\norg.apache.coyote.http11.Http11Processor.action(Http11Processor.java:962)\n       at\norg.apache.coyote.Response.action(Response.java:180)\n       at\norg.apache.coyote.http11.InternalOutputBuffer.endRequest(InternalOutputBuffer.java:388)\n       at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:906)\n       at\norg.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:664)\n       at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)\n       at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)\n       at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n       at java.lang.Thread.run(Thread.java:613)", "id": 94732, "time": "2006-10-11T13:21:16Z", "creator": "yoavs@computer.org", "creation_time": "2006-10-11T13:21:16Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "id": 94740, "time": "2006-10-11T14:10:59Z", "bug_id": 40730, "creation_time": "2006-10-11T14:10:59Z", "is_private": false, "text": "No idea what he's doing. Probably a Java 2D issue or similar.\n\n*** This bug has been marked as a duplicate of 40719 ***"}]