[{"count": 0, "tags": [], "text": "It would be of great help if ant's run classpath could be extended\ndynamically while it is already running in order to automatically\nadd lacking libs whose location is (solely) given in the context\nof a given project. E.g. the jar cotaining a specific JDBC driver.\nAt least the addition of a classpath parameter (as for taskdef) to the\nantcall task would be very usefull. \n\nAt the moment it is only possible to extend the classpath (more or less) statically on the command line by means of the \"-lib\" option or by\ninjecting the required libs into the lib directory located under ant's\nhome dir. The latter approach would (usually) result in a modified default\ninstallation which may cause troubles or at least establishes\ncustomized ant installations.\n\nI tried to solve the problem with ant's existing means which results\nin a somehow cumbersome script that isn't completely generic\nsince it cotains an os dependency. The sniffet from my trial looks\nas follows:\n\n  <target name=\"needsdriverlib\">\n    <sql\n      driver=\"${driver}\"\n      url=\"${url}\"\n      userid=\"${userid}\"\n      password=\"${password}\"\n    >\n      select * from cat\n    </sql>\n  </target>\n\n  <target name=\"ensuresdriverlib\">\n    <!-- extension .bat depends on os windows -->\n    <exec executable=\"ant.bat\" spawn=\"false\">\n      <arg value=\"-lib\"/>\n      <arg value=\"${lib.dir}/jdbc/jars\"/>\n      <arg value=\"needsdriverlib\"/>\n    </exec>\n  </target>\n\n\nHopefully you found this request worth to be considered\nin a future version.\nThanks.", "attachment_id": null, "id": 81636, "creator": "meinc@web.de", "time": "2005-10-24T17:04:59Z", "bug_id": 37223, "creation_time": "2005-10-24T17:04:59Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 37223, "attachment_id": null, "is_private": false, "id": 81639, "time": "2005-10-24T17:28:44Z", "creator": "meinc@web.de", "creation_time": "2005-10-24T17:28:44Z", "text": "Maybe the provided example that uses the sql task was not the best choice\nto demonstrate the problem since this task allows either the specification\nof a classpath attribute or element. However the point is, that this\nis not a common feature of any task. E.g. it lacks for\n\n- script\n- junit\n- ..."}, {"count": 2, "tags": [], "bug_id": 37223, "attachment_id": null, "is_private": false, "id": 81646, "time": "2005-10-24T17:58:14Z", "creator": "stevel@apache.org", "creation_time": "2005-10-24T17:58:14Z", "text": "1. you actually have a directory ${user.home}/.ant/lib that can also be used to\nhost stuff, for per-user customisation.\n\n2. all attempts to do dynamic classpath patching in ant have stumbled up against\nthe IDE problem; IDE-hosted ant is a very different beast and we dont want to\nbreak it by patching IDE-managed classpaths. \n\nI fear that static classpaths are an architectural feature of ant that are very\nhard to fix. You can try redefining tasks with a new classpath and see what\nhappens, though you may need to pull the relevant optional jar from the shared\ndir first. "}, {"count": 3, "tags": [], "text": "I know the ${user.home}/.ant/lib option. However this is per user not per project.\nMaybe another solution which could help a bit would be to scan a third\nlocation, e.g. a subdirectory below the the project homedir such as ${basedir}/.ant/lib.\n\nBy the wy this request for extension has nothing to do with IDEs. Rather\ni would like to have a mean to extend a standard ant installation with\nproject specific jars. E.g. if I write an ant script that requires the\ngroovy libs to be installed, I could ship them together with the project\nand inject them in case they are not already found on the classpath\n(by testing for existance of a ceratin class). So the only requirement\nwould be to have a working ant installation. That should be all.\nAnd typing ant on the command line should do the rest.\n\nWithout such means, the only way I see to solve the problem is to write\na bootstrap target that injects the required libs into ants home lib\nor user lib. Calls itself again does what it should do and than ...\nshould it always delete the injected libs (hmmm we need to keep track of already existant libs) and finally what's about performance.\n\nHope I made it more clear and there is still a chance for consideration of this request.", "is_private": false, "id": 81726, "creator": "meinc@web.de", "time": "2005-10-25T21:56:09Z", "bug_id": 37223, "creation_time": "2005-10-25T21:56:09Z", "attachment_id": null}, {"count": 4, "text": "Maybe \nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=28228\ncan help you.\nThis feature is proposed for Ant 1.7.\nTake a look at \nhttp://jtools.org/ant-classloadertask/\nfor the most recent ('external-task') version of this feature.\nCheers\nRainer", "creator": "rainer@noacks.net", "is_private": false, "id": 81732, "time": "2005-10-25T23:36:43Z", "bug_id": 37223, "creation_time": "2005-10-25T23:36:43Z", "tags": [], "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 37223, "attachment_id": null, "id": 81770, "time": "2005-10-26T15:31:11Z", "creator": "j_a_fernandez@yahoo.com", "creation_time": "2005-10-26T15:31:11Z", "is_private": false, "text": "Have you thought about using -lib option of ANT? you could either provide a \nscript that calls ANT with this aditional parameter, or setting ANT_OPTS \nenvironment variable so it passes this argument.\n\nYou will get the same effect as you want.\n"}, {"count": 6, "tags": [], "bug_id": 37223, "attachment_id": null, "id": 81780, "time": "2005-10-26T17:59:36Z", "creator": "meinc@web.de", "creation_time": "2005-10-26T17:59:36Z", "is_private": false, "text": "(In reply to comment #4)\n> Maybe \n> http://issues.apache.org/bugzilla/show_bug.cgi?id=28228\n> can help you.\n> This feature is proposed for Ant 1.7.\n> Take a look at \n> http://jtools.org/ant-classloadertask/\n> for the most recent ('external-task') version of this feature.\n> Cheers\n> Rainer\n\n\nThank you for this hint. Looks like it is what I'm looking for.\nDo you know something about the availability of Ant 1.7?"}, {"count": 7, "tags": [], "text": "(In reply to comment #5)\n> Have you thought about using -lib option of ANT? you could either provide a \n> script that calls ANT with this aditional parameter, or setting ANT_OPTS \n> environment variable so it passes this argument.\n> \n> You will get the same effect as you want.\n> \n\nGood proposal! However, I knew about them and was not satisfied since\nboth solutions add an additional level of indirection.\nWe are used to have one single environment setup for all projects and not one\nper project. This environment setup solely points/sets the JAVA_HOME\nand ANT_HOME and finally starts a clean command line shell or dosbox.\nUp from there developers/testers/managers(!) switch to the appropriate\nproject directory and just type ant which should do the rest.\n\nHowever, until all projects share the same libraries the usage of the\nANT_OPTS would be reasonable (i.e. as a third environment variable to be set).", "attachment_id": null, "id": 81781, "creator": "meinc@web.de", "time": "2005-10-26T18:11:26Z", "bug_id": 37223, "creation_time": "2005-10-26T18:11:26Z", "is_private": false}, {"count": 8, "tags": [], "text": "More or less a duplicat of\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=28228\n\nThanks to Rainer Noack for pointing me to this issue.\n\nHowever may be it would be worth to consider a third (fixed) location\nfor looking up thirdparty libraries, e.g. ${basedir}/.ant/lib\n\n\n*** This bug has been marked as a duplicate of 28228 ***", "is_private": false, "id": 81892, "creator": "meinc@web.de", "time": "2005-10-28T14:54:24Z", "bug_id": 37223, "creation_time": "2005-10-28T14:54:24Z", "attachment_id": null}]