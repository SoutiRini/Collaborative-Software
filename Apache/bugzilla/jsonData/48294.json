[{"count": 0, "attachment_id": 24625, "bug_id": 48294, "text": "Created attachment 24625\nRun this file; a spreadsheet with the problem is dumped to stdout.\n\nIf you call setSheetOrder() on sheets on a workbook with inter-sheet references (e.g., a formula like ='Sheet 2'!A3 on Sheet 1), the references can be broken. The attached Java file shows how to reproduce the bug.\n\nTested with POI 3.5-FINAL (poi-bin-3.5-FINAL-20090928.tar.gz) on Debian with this Java:\n\njava version \"1.6.0_16\"\nJava(TM) SE Runtime Environment (build 1.6.0_16-b01)\nJava HotSpot(TM) Server VM (build 14.2-b01, mixed mode)\n\nAnd OpenOffice.org 3.1.1.\n\nResolution: I avoided the bug by creating all sheets at once in the order in which they would stay in the final file. An easy workaround would be to add a sentence to the documentation of setSheetOrder() warning the user that it may break references.", "id": 132361, "time": "2009-11-26T10:41:10Z", "creator": "asf-bugzilla@barillari.org", "creation_time": "2009-11-26T10:41:10Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "antti.koskimaki@joinex.com", "text": "Still present (3.8b4). Work-around gives me headache, final sheet-order isn't always known early enough.", "id": 147586, "time": "2011-06-29T04:55:03Z", "bug_id": 48294, "creation_time": "2011-06-29T04:55:03Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "yegor@dinom.ru", "text": "Fixed in r1142219\n\nsetSheetOrder() now updates cell formulas, defined names and formulas in conditional formatting. Same rules are involved in Sheet.shiftRows. \n\nFormulas in data validations aren't updated, but this will require much more technical efforts. I'm leaving this out for the future.\n\nYegor", "id": 147701, "time": "2011-07-02T13:28:32Z", "bug_id": 48294, "creation_time": "2011-07-02T13:28:32Z", "is_private": false, "attachment_id": null}]