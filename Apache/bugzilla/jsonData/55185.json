[{"count": 0, "tags": [], "creator": "srousseau@sodifrance.fr", "attachment_id": null, "id": 168234, "time": "2013-07-02T15:18:21Z", "bug_id": 55185, "creation_time": "2013-07-02T15:18:21Z", "is_private": false, "text": "With POI 3.9, I'm faces the same problem as reported in bug id #27405\n\nHere is the code :\n        HSSFWorkbook book = new HSSFWorkbook();\n        HSSFSheet sheet2 = book.createSheet(\"ma feuille\");\n\n        HSSFRow row = sheet2.createRow(0);\n        HSSFCell cell = null;\n\n        cell = row.createCell(0);\n        cell.setCellValue(10);\n\n        cell = row.createCell(1);\n        cell.setCellValue(20);\n\n        cell = row.createCell(2);\n        cell.setCellValue(30);\n\n        cell = row.createCell(3);\n        cell.setCellType(HSSFCell.CELL_TYPE_FORMULA);\n        cell.setCellFormula(\"IF(AND(ISNUMBER(A1),ISNUMBER(B1)),(A1*B1)/(1000),\\\"toto\\\")\");\n\nWhere I open the workbook, I see \"toto\" in cell. Then I just click in the formula for cell A3 and enter. Then it works\n\nStephane"}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 168235, "time": "2013-07-02T15:38:39Z", "bug_id": 55185, "creation_time": "2013-07-02T15:38:39Z", "is_private": false, "text": "After changing a formula, you must trigger a recalculation to ensure the cached value is correctly stored/set in the file\n\nSee http://poi.apache.org/spreadsheet/eval.html for instructions on how to do this"}, {"count": 2, "tags": [], "creator": "srousseau@sodifrance.fr", "attachment_id": null, "id": 168237, "time": "2013-07-02T15:58:40Z", "bug_id": 55185, "creation_time": "2013-07-02T15:58:40Z", "is_private": false, "text": "(In reply to Nick Burch from comment #1)\n> After changing a formula, you must trigger a recalculation to ensure the\n> cached value is correctly stored/set in the file\n> \n> See http://poi.apache.org/spreadsheet/eval.html for instructions on how to\n> do this\n\nGreat!!\n It works with HSSFFormulaEvaluator.evaluateAllFormulaCells(myWorkBook).\n\nI upgrade from POI 3.0 to POI 3.9 and I didn't need to call this code. So I didn't know about \"Formula Evaluation\".\n\nThanks a lot !\n\nStephane"}, {"count": 3, "tags": [], "bug_id": 55185, "text": "(In reply to srousseau from comment #2)\n> (In reply to Nick Burch from comment #1)\n> > After changing a formula, you must trigger a recalculation to ensure the\n> > cached value is correctly stored/set in the file\n> > \n> > See http://poi.apache.org/spreadsheet/eval.html for instructions on how to\n> > do this\n> \n> Great!!\n>  It works with HSSFFormulaEvaluator.evaluateAllFormulaCells(myWorkBook).\n> \n> I upgrade from POI 3.0 to POI 3.9 and I didn't need to call this code. So I\n> didn't know about \"Formula Evaluation\".\n> \n> Thanks a lot !\n> \n> Stephane\n\nHello,\n\nI dont't know what I've changed since last Tuesday but I doesn't work anymore. I now see \"toto\" as result.\nI'm using HSSFFormulaEvaluator.evaluateAllFormulaCells(book.getWorkbook()); and book.getWorkbook().setForceFormulaRecalculation(true); but the cell value is not refreshed. But I can see the call to evaluateFormulaCell for each formula cell.\n\nIn excel, I have to click in the cell to refresh the cell value as in the beginning.\n\nI run Excel 2010 with HSSFWorkbook.\n\nSo, if anybody has idea ...\n\nRegards\n\nSt\u00e9phane Rousseau", "id": 168404, "time": "2013-07-09T09:28:35Z", "creator": "srousseau@sodifrance.fr", "creation_time": "2013-07-09T09:28:35Z", "is_private": false, "attachment_id": null}]