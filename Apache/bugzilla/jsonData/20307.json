[{"count": 0, "tags": [], "creator": "eglass1@attbi.com", "attachment_id": null, "text": "Setting the content length causes Tomcat to ignore subsequent status changes.  \nAs an example:\n\nimport java.io.*;\nimport javax.servlet.http.*;\n\npublic class Test extends HttpServlet {\n    protected void doGet(HttpServletRequest request,\n            HttpServletResponse response) throws IOException {\n        response.setContentLength(0);\n        response.setStatus(HttpServletResponse.SC_UNAUTHORIZED);\n        response.flushBuffer();\n    }\n}\n\nThis results in a response code of 200 (OK) rather than 401 (Unauthorized).  \nDoing:\n\nresponse.setStatus(HttpServletResponse.SC_UNAUTHORIZED);\nresponse.setContentLength(0);\n\nresults in the correct response code being sent.", "id": 37928, "time": "2003-05-28T16:42:58Z", "bug_id": 20307, "creation_time": "2003-05-28T16:42:58Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 20307, "attachment_id": null, "id": 38035, "time": "2003-05-30T10:17:33Z", "creator": "remm@apache.org", "creation_time": "2003-05-30T10:17:33Z", "is_private": false, "text": "It took me about 15 minutes to figure out what was going on.\n\nThe response is considered committed as soon as the amount of bytes specified in\nthe content length has been written. Since the content length is 0, the response\nis considered committed as soon you call response.setContentLength(0). Since you\ncan't change the status after the response has been committed, that's why you\nget a 200 status back.\n\nThis spec seems a bit weird in that case."}]