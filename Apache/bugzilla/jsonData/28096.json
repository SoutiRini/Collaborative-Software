[{"count": 0, "tags": [], "bug_id": 28096, "attachment_id": null, "text": "When upgrading from 1.5.4 to 1.6.1 found an undocumented change in the optional \ntask jjtree. This task now needs the outputdirectory specified otherwise the \ngenerated code appears in directory where ant ran from (location of build.xml).\n\n1.5.4 version that does not work on 1.6.1\n    <jjtree\n      target=\"${gkdd_root}/com/kwiz/kdCore/util/expression/ExpressionParser.jjt\"\n      javacchome=\"${anttask_root}\"/>\n\n1.6.1 version that works on 1.6.1\n<jjtree\n   target=\"${gkdd_root}/com/kwiz/kdCore/util/expression/ExpressionParser.jjt\"\n   outputdirectory=\"${gkdd_root}/com/kwiz/kdCore/util/expression\"\n   javacchome=\"${anttask_root}\"/>", "id": 54977, "time": "2004-03-31T17:09:19Z", "creator": "ecattanach@thinkanalytics.com", "creation_time": "2004-03-31T17:09:19Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 28096, "attachment_id": null, "id": 54985, "time": "2004-03-31T17:38:53Z", "creator": "javadotant@shadowland.demon.nl", "creation_time": "2004-03-31T17:38:53Z", "is_private": false, "text": "See jjtree.html documentation parapgraph: Comparison output locations between\ncommand line JJTree and different Ant taskdef versions.\n\nTable row 2 + 3."}, {"count": 2, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "text": "I remeber that Jene Jesper and I had this discussion when the new jjtree code went\nin and he told me that the old task would have used the current working directory\nif outputdirectory was missing.  Where does the output end up for you in Ant 1.5.4?\n\nThe new behavior is documented, wrong as it may be.", "id": 55299, "time": "2004-04-05T12:26:49Z", "bug_id": 28096, "creation_time": "2004-04-05T12:26:49Z", "is_private": false}, {"text": "In 1.5.4 the output is placed into the same directory as the .jjt file if the \noutputdirectory is NOT specified. This directory is specified as the \noutputdirectory attribute within 1.6.1", "tags": [], "bug_id": 28096, "is_private": false, "count": 3, "id": 55320, "time": "2004-04-05T14:31:20Z", "creator": "ecattanach@thinkanalytics.com", "creation_time": "2004-04-05T14:31:20Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "javadotant@shadowland.demon.nl", "text": "Are you referring to this dicussion ?\n\nStefan,\n\nSee javadoc for method validateOutputFile:\n    * When running JJTree from an Ant taskdesk the -OUTPUT_DIRECTORY must\n    * always be set. But when -OUTPUT_DIRECTORY is set, -OUTPUT_FILE is\n    * handled as if relative of this -OUTPUT_DIRECTORY. Thus when the\n    * -OUTPUT_FILE is absolute or contains a drive letter we have a problem.\n\nThus when the outputdirectory is supplied the outputfile is no longer treated as\nan absolute path but relative to that outputdirectory, and therefore starting\nthe outputfile with an / or \\ is kind of ignored.\nAt the moment I'm working on a patch that transforms the absolute outputfile to\nan relative outputfile for the default outputdirectory (project basedirectory)\nwhen the outputdirectory is not supplied.\nLeaving a drive letter as the only problem. But the because when JavaCC is run\nfrom the commandline with an outputdirectory and and outputfile (containing a\ndrive letter) this will result in a file of the form <outputdirectory>/<drive\nletter>: which is empty. Thus always blocking a drive letter in the outputfile\nis justified imho.\n\nI will attach the patch in bugzilla today or tomorrow,\n\n         Jene.\n\nStefan Bodewig wrote:\n\n>\n> ------------------------------------------------------------------------\n>\n> Subject:\n> DO NOT REPLY [Bug 21526] - Enhancement JavaCC, JJTree and JJDoc [update]\n> From:\n> bugzilla@apache.org\n> Date:\n> 29 Jul 2003 14:48:05 -0000\n> To:\n> dev@ant.apache.org\n>\n>\n> DO NOT REPLY TO THIS EMAIL, BUT PLEASE POST YOUR BUG RELATED COMMENTS THROUGH\nTHE WEB INTERFACE AVAILABLE AT\n> <http://nagoya.apache.org/bugzilla/show_bug.cgi?id=21526>.\n> ANY REPLY MADE TO THIS MESSAGE WILL NOT BE COLLECTED AND INSERTED IN THE BUG\nDATABASE.\n>\n> http://nagoya.apache.org/bugzilla/show_bug.cgi?id=21526\n>\n> Enhancement JavaCC, JJTree and JJDoc [update]\n>\n>\n>\n>\n>\n> ------- Additional Comments From bodewig@apache.org  2003-07-29 14:48 -------\n> Some questions\n>\n> +        if ((outputDirectory == null)\n> +            && (outputFile.startsWith(\"/\") || outputFile.startsWith(\"\\\\\")))\n> +        {\n> +            throw new BuildException(\"Absolute path in 'outputfile' not\n> supported: \" + outputFile);\n> +        }\n>\n> _*only if outputdirectory has not been set?  I.e. absolute paths are supported\n> if it has been set?\n> *_\n> +            throw new BuildException(\"Drive letter in 'outputfile' not\n> supported: \" + outputFile);\n>\n> Is this a general limitation of jjtree?\n>\n>  \n>\n>> Maybe this table could be attached to jjtree.html ?\n>>   \n>\n>\n> Of course it can, if you send a patch\n>\n> Stefan\n>\n> ---------------------------------------------------------------------\n> To unsubscribe, e-mail: dev-unsubscribe@ant.apache.org\n> For additional commands, e-mail: dev-help@ant.apache.org\n>\n>  ", "id": 55335, "time": "2004-04-05T16:51:02Z", "bug_id": 28096, "creation_time": "2004-04-05T16:51:02Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 28096, "attachment_id": null, "text": "When I added the missing option:\n     private static final String OUTPUT_FILE       = \"OUTPUT_FILE\";\n\nI compared the command line action of jjtree itself and I tried to make the\ntaskdef behave in the same way as the command line usage. \n\nThis led to breaking the behavior of Ant 1.5.3 when no outputdirectory is specified.\n\nLooking at the problem at hand the default directory used by the taskdef is\nprobably a better choice than the directory used by the command line jjtree.\n\nI could create a patch that makes 1.6 behave the same way as 1.5.3 ?", "id": 55336, "time": "2004-04-05T17:12:24Z", "creator": "javadotant@shadowland.demon.nl", "creation_time": "2004-04-05T17:12:24Z", "is_private": false}, {"count": 6, "attachment_id": null, "bug_id": 28096, "text": "Yes, so my memory was failing on me.\n\nGiven that the current behavior is documented, I'm a bit reluctant to revert the\nchange.", "id": 55387, "time": "2004-04-06T12:40:05Z", "creator": "bodewig@apache.org", "creation_time": "2004-04-06T12:40:05Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "creator": "javadotant@shadowland.demon.nl", "attachment_id": null, "text": "When you have decided what to do just let me know through this bug. Because I\nwill be monitoring the developer mailing for javacc bugs anyway.", "id": 55421, "time": "2004-04-06T20:20:52Z", "bug_id": 28096, "creation_time": "2004-04-06T20:20:52Z", "is_private": false}, {"count": 8, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "text": "Yes, it may be a regression of some kind, but a documented one.  We shouldn't fix\nit with a new regression IMHO.  Let's stick with what we have.", "id": 72392, "time": "2005-03-14T16:40:21Z", "bug_id": 28096, "creation_time": "2005-03-14T16:40:21Z", "is_private": false}]