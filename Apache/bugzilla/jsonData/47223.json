[{"count": 0, "tags": [], "text": "Created attachment 23695\nUse LinkedList instead of ArrayList in org.apache.jorphan.math.StatCalculator\n\nJMeter slows to a crawl and eventually becomes completely unresponsive as it accumulates samples using the Aggregate Report.\n\nThe issue appears to be that the StatCalculator uses an ArrayList to store the samples and inserts them within the list to keep the list sorted.  ArrayList has O(n) performance for insertions at arbitary locations in the array (n is the current size of the list).  This means that over the entire JMeter run performance of JMeter with an AggregateReport is at least O(n-squared).\n\nChanging the ArrayList to a LinkedList significantly improves the performance.  Although a LinkedList is still O(n) for sorted insertions (and for operations such as reading the median and 90% values), the constants for these operations are significantly lower than that of inserting into an ArrayList (probably because the LinkedList never needs to copy the whole array in order to insert an item).\n\nAfter this change JMeter becomes usable for collecting tens of thousands of samples, whereas before it would bring my system to a complete halt.\n\nI've attached a small patch to the bug that changes the ArrayList into a LinkedList in StatCalculator.", "attachment_id": 23695, "bug_id": 47223, "id": 127191, "time": "2009-05-19T15:38:20Z", "creator": "jared@sulem.co.uk", "creation_time": "2009-05-19T15:38:20Z", "is_private": false}, {"count": 1, "tags": [], "creator": "sebb@apache.org", "text": "Thanks for the report and patch. Fixed in SVN:\n\nURL: http://svn.apache.org/viewvc?rev=805481&view=rev\nLog:\nBug 47223 - Slow Aggregate Report Performance (StatCalculator)", "id": 129776, "attachment_id": null, "bug_id": 47223, "creation_time": "2009-08-18T09:23:40Z", "time": "2009-08-18T09:23:40Z", "is_private": false}]