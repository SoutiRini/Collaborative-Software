[{"count": 0, "tags": [], "creator": "mlistwan@gmail.com", "is_private": false, "text": "Created attachment 22525\nupp_sign.xml is the signature and out.xml signed xml\n\nThere is a problem with verification of signatures having a ds:Reference to an xml file with with <?xml-stylesheet?> with XPath transform. As you create the same signature referencing a modified document by omitting <?xml-stylesheet?> the signature verification succeeds.\n\nI had to solve the problem and had come to conclusion that there is a bug in org.apache.xml.security.signature.XMLSignatureInput. The source of the problem is a line this._subNode=doc.getDocumentElement(); in void convertToNodes(). Assigning only root element removes xml-stylesheet. Changing the line to: this._subNode=doc; seems to fix it.\n\nAttached out.zip has two files that show the situation.", "id": 120358, "time": "2008-09-04T07:20:33Z", "bug_id": 45744, "creation_time": "2008-09-04T07:20:33Z", "attachment_id": 22525}, {"count": 1, "tags": [], "bug_id": 45744, "text": "\nDo you have a test-case for this issue?\n\nColm.", "id": 128048, "time": "2009-06-18T04:52:20Z", "creator": "coheigea@apache.org", "creation_time": "2009-06-18T04:52:20Z", "is_private": false, "attachment_id": null}, {"text": "Created attachment 23828\nverification\n\nAttachment verifies the pair (upp_sign.xml and out.xml). As the line is \"this._subNode=doc.getDocumentElement();\" verification of reference out.xml fails. With \"this._subNode=doc\" verification succeeds.\n\nSignature was created with third party library. It caused an inconsistency that made me look for this bug.", "tags": [], "bug_id": 45744, "is_private": false, "count": 2, "id": 128050, "time": "2009-06-18T06:42:38Z", "creator": "mlistwan@gmail.com", "creation_time": "2009-06-18T06:42:38Z", "attachment_id": 23828}, {"count": 3, "tags": [], "bug_id": 45744, "text": "\nThanks Michael. I'll create a patch including a test-case for this issue. Do you have any objections to me adding the test code and signature files to the project?\n\nColm.", "id": 128059, "time": "2009-06-18T08:48:59Z", "creator": "coheigea@apache.org", "creation_time": "2009-06-18T08:48:59Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 45744, "text": "I have no objections.", "id": 128068, "time": "2009-06-18T13:12:12Z", "creator": "mlistwan@gmail.com", "creation_time": "2009-06-18T13:12:12Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "coheigea@apache.org", "text": "Created attachment 23832\nA patch for this issue\n\n\nSee attached for a patch for this issue. It includes the suggested fix to XMLSignatureInput, as well as a unit test that's derived from the submitted test-case.\n\nColm.", "id": 128079, "time": "2009-06-19T04:12:41Z", "bug_id": 45744, "creation_time": "2009-06-19T04:12:41Z", "is_private": false, "attachment_id": 23832}, {"count": 6, "tags": [], "creator": "coheigea@apache.org", "attachment_id": null, "text": "\nPatch applied.\n\nColm.", "id": 128719, "time": "2009-07-10T06:32:03Z", "bug_id": 45744, "creation_time": "2009-07-10T06:32:03Z", "is_private": false}]