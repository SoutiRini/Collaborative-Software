[{"count": 0, "tags": [], "bug_id": 47450, "attachment_id": null, "text": "Add apache as a generic service on a Windows 2008 server enterprise x64 failover cluster. \n\nWhen started from the services MMC there is no problem, however when run by bringing the service online in the failover cluster management it fails.\n\nIn the event viewer apache churns out the usage statement, there is nothing in Apaches own log directory.\n\nI have tried ensuring the installation path is short with no spaces (I read a mail post and the conclusion seemed to be that this could be the issue) however it made no difference.\n\nI replaced the httpd.exe with a simple program that just wrote all the arguments to a file, the arguments were identical in both cases:\n\nC:\\BT\\Apache2.2\\bin\\httpd.exe\n-k\nrunservice\n\nI turned off UAC which had no effect. I have also looked at the code to try and see anything obvious in that area but haven't spotted anything.. I'm assuming there's some difference in the access rights or environment or similar that is causing the issue.", "id": 128393, "time": "2009-06-29T08:30:28Z", "creator": "twillis@bottomline.com", "creation_time": "2009-06-29T08:30:28Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 47450, "attachment_id": null, "text": "I have now reproduced this on 32 bit 2008 server enterprise failover cluster which makes it more urgent", "id": 128661, "time": "2009-07-09T04:18:56Z", "creator": "twillis@bottomline.com", "creation_time": "2009-07-09T04:18:56Z", "is_private": false}, {"count": 2, "attachment_id": null, "creator": "twillis@bottomline.com", "text": "raised to blocker as we can not test on cluster", "id": 128663, "time": "2009-07-09T04:19:58Z", "bug_id": 47450, "creation_time": "2009-07-09T04:19:58Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "creator": "thomas.toft@mitsubishi-paper.com", "text": "I now do also have this problem with apache on failover cluster on Windows Server 2008 64 bit.\nDo or did you run the apache service as 'local system'?\n\nMy apache version is: \n2.2.14 (Win32). \n\nMy Windows version is: \nWindows Server (R) 2008 Enterprise, Build 6002, Service Pack 2", "id": 134924, "time": "2010-02-26T16:05:25Z", "bug_id": 47450, "creation_time": "2010-02-26T16:05:25Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 47450, "attachment_id": null, "text": "This is a 2008 R2 MSCS bug where startup parameters are misinterpreted. Contact MS for support.  \n\nRemoving the startup parameters may provide relief:\n\n Cluster res \"$servicename\" /priv startupparameters=\"\"", "id": 134925, "time": "2010-02-26T16:10:54Z", "creator": "covener@gmail.com", "creation_time": "2010-02-26T16:10:54Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 47450, "text": "(In reply to comment #4)\n> This is a 2008 R2 MSCS bug where startup parameters are misinterpreted. Contact\n> MS for support.  \n> \n> Removing the startup parameters may provide relief:\n> \n>  Cluster res \"$servicename\" /priv startupparameters=\"\"\n\nI'm not sure how this can be the case, I replaced httpd with my own exe and my exe was passed the correct startup parameters? Can you give me a bit more detail on where the misinterpretation happens?", "id": 134926, "attachment_id": null, "creator": "twillis@bottomline.com", "creation_time": "2010-02-26T16:51:00Z", "time": "2010-02-26T16:51:00Z", "is_private": false}, {"count": 6, "tags": [], "creator": "covener@gmail.com", "text": "You'll have to take  it up with MS, perhaps your bug is different. If the service starts from \"net\" or services.msc, there's really no other resolution possible.", "id": 134945, "time": "2010-02-28T11:13:25Z", "bug_id": 47450, "creation_time": "2010-02-28T11:13:25Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 47450, "attachment_id": null, "text": "Eric, can you shed some light on what parameters the failover manager is passing?  Pointer to the bug or API?\n\nIf this is a Win32 API change, we might be able to work around it.", "id": 134948, "time": "2010-02-28T19:03:11Z", "creator": "wrowe@apache.org", "creation_time": "2010-02-28T19:03:11Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 47450, "attachment_id": null, "id": 134951, "time": "2010-02-28T21:44:22Z", "creator": "covener@gmail.com", "creation_time": "2010-02-28T21:44:22Z", "is_private": false, "text": "Sorry, I only know third-hand that support for MSCS owned up to it being a bug on their end, and that the snippet in comment 4 was the circumvention for short-term relief (although seemingly only an option when you install into the compiled-in serverroot?). I don't even have an environment to play with it in."}, {"count": 9, "tags": [], "bug_id": 47450, "attachment_id": null, "text": "We've experienced this issue too, \nand found some strange workaround (just if somemone is interested):\n\nWhen using the \"Cluster Wizard\" from W2K8,\nthe Generic service is added with Startup parameters \n\"<part of the startup path>\" -k runservice \n\nErasing the Parameter-string in the wizard (see comment #4) did not work\nfor us, but erasing it and replacing by exactly one blank did the trick.\n\nBizzarre, but true (w2K8 64Bit Cluster)", "id": 136435, "time": "2010-04-27T06:37:15Z", "creator": "mattp@web.de", "creation_time": "2010-04-27T06:37:15Z", "is_private": false}, {"count": 10, "tags": [], "bug_id": 47450, "attachment_id": null, "text": "(In reply to comment #9)\n> for us, but erasing it and replacing by exactly one blank did the trick.\n...this seems to be due to the fact that if you just erase the string,\n...ClusterManager GUI puts it's default back in again. Putting in a \"blank\" avoids this. BTW: The parameters are picked up from the definition on the *local* definition of the services alright.", "id": 136451, "time": "2010-04-27T11:26:16Z", "creator": "mattp@web.de", "creation_time": "2010-04-27T11:26:16Z", "is_private": false}, {"count": 11, "tags": [], "bug_id": 47450, "text": "I do not have any Cluster commands available and I believe I do not have cluster services on our 64-bit Server 2008.\n\nI had the same issue.  I could not change my DocumentRoot.  Using Process Explorer I figured that \"-k runservice\" executed the following command,\n\n\"C:\\Program Files (x86)\\Apache Software Foundation\\Apache2.2\\bin\\httpd.exe\" -d \"C:/Program Files (x86)/Apache Software Foundation/Apache2.2\"\n\n(I saw the -f option with a path to httpd.conf originally as well).\n\nI suspected that Apache configuration parser could not handle brackets after seeing a suggestion to symlink the server directory to a simple path,\n\n http://jamesmcdonald.id.au/it-tips/32-bit-apache-on-windows-error\n\n http://www.thoughtlabs.com/2011/03/25/how-to-set-up-apache-on-windows-7-to-support-facebook-secure-browsing/\n\nSo I created a directory symlink and changed all references to the \"(x86)\" directory in configuration files with \"c:/apache\".\n\n c:\n cd \\\n mklink /d apache \"c:\\Program Files (x86)\\Apache Software Foundation\\Apache2.2\"\n\nThen I stopped the service and restarted it again.\n\n C:\\apache\\conf>..\\bin\\httpd.exe -k start\n\nThis time I could see my own DocumentRoot taking its place in the browser after cleaning its cache.\n\nNB: I did not realize that \"-k uninstall\" followed by \"-k install\" will erase my crafted configuration files.  The logs\\install.log file showed me how httpd.exe copied original files on top of my modifications.  So I learned to save configuration files away from the Apache directories.", "id": 148153, "attachment_id": null, "creator": "ilatypov@infradead.org", "creation_time": "2011-07-26T03:53:31Z", "time": "2011-07-26T03:53:31Z", "is_private": false}, {"count": 12, "text": "(Forgot to mention that running httpd.exe as a regular process with the -f option pointing to the configuration file worked without the symlink and without any changes to directory names in configuration files).", "bug_id": 47450, "attachment_id": null, "id": 148154, "time": "2011-07-26T03:56:46Z", "creator": "ilatypov@infradead.org", "creation_time": "2011-07-26T03:56:46Z", "tags": [], "is_private": false}, {"count": 13, "tags": [], "bug_id": 47450, "attachment_id": null, "text": "(In reply to comment #11)\n> I do not have any Cluster commands available and I believe I do not have\n> cluster services on our 64-bit Server 2008.\n> \n> I had the same issue.  I could not change my DocumentRoot.  Using Process\n> Explorer I figured that \"-k runservice\" executed the following command,\n\nThis does not seem to be related to the current problem report.", "id": 148172, "time": "2011-07-26T10:59:28Z", "creator": "covener@gmail.com", "creation_time": "2011-07-26T10:59:28Z", "is_private": false}, {"count": 14, "tags": [], "bug_id": 47450, "attachment_id": null, "id": 148187, "time": "2011-07-26T17:05:14Z", "creator": "wrowe@apache.org", "creation_time": "2011-07-26T17:05:14Z", "is_private": false, "text": "The cluster server fails to replicate the service's registry entries.\n\nThe arguments from the startservice command are mauled by the cluster server\nmanagement tool.  There are no plans at this time to work around this undocumented\n\"feature\".  See Eric's comment #4 above."}]