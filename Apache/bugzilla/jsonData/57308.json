[{"count": 0, "attachment_id": null, "bug_id": 57308, "is_private": false, "id": 179504, "time": "2014-12-04T13:04:24Z", "creator": "sebb@apache.org", "creation_time": "2014-12-04T13:04:24Z", "tags": [], "text": "Most of Tomcat uses File.separator, but there are a few instances of System.getProperty(\"file.separator\")\n\nThe two can be different, but still allow the JVM to start up.\nI found the following worked:\n\njava -Dfile.separator=/xyz\n\nfor Unix or the equivalent \\xyz on Windows.\n\nUsing a different first character does not work - the JVM usually throws an exception as it cannot find some required files if the sep. is incorrect.\n\nIt looks like only the first character of the property is used by the JVM. However, this is not done by the application code I have seen, which means that there could be a discrepancy between the two methods.\n\nFile.separator has the additional benefit that it is not subject to a privilege check."}, {"count": 1, "tags": [], "creator": "markt@apache.org", "is_private": false, "text": "I have a patch for trunk [1] that I'll commit once svn writes are available again. Then I'll look at back-ports.\n\n[1] https://github.com/markt-asf/tomcat/commit/0744a45a939311cc0ac0981a6922e4afd1e2e7d4", "id": 179505, "time": "2014-12-04T13:32:33Z", "bug_id": 57308, "creation_time": "2014-12-04T13:32:33Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 57308, "attachment_id": null, "id": 179509, "time": "2014-12-04T13:57:04Z", "creator": "sebb@apache.org", "creation_time": "2014-12-04T13:57:04Z", "is_private": false, "text": "(In reply to Mark Thomas from comment #1)\n> I have a patch for trunk [1] that I'll commit once svn writes are available\n> again. Then I'll look at back-ports.\n> \n> [1]\n> https://github.com/markt-asf/tomcat/commit/\n> 0744a45a939311cc0ac0981a6922e4afd1e2e7d4\n\nThat would fix the instances I found."}, {"count": 3, "tags": [], "bug_id": 57308, "attachment_id": null, "text": "It looks like the same applies to \"path.separator\" and File.pathSeparator.\n\ni.e. changing the property causes issues for startup, and only the first char is used by Java.\n\nIf so, here are the instances I found in trunk:\n\njava/org/apache/jasper/compiler/AntCompiler.java:        String sep = System.getProperty(\"path.separator\");\njava/org/apache/jasper/compiler/JspRuntimeContext.java:        String sep = System.getProperty(\"path.separator\");\njava/org/apache/tomcat/jni/Library.java:                String sep = System.getProperty(\"path.separator\");\ntest/org/apache/juli/TestClassLoaderLogManager.java:                        + System.getProperty(\"path.separator\")\ntest/org/apache/juli/TestClassLoaderLogManager.java:                        + System.getProperty(\"path.separator\") + \"baz\",\ntest/org/apache/juli/TestClassLoaderLogManager.java:        Assert.assertEquals(\"${}\" + System.getProperty(\"path.separator\"),", "id": 179510, "time": "2014-12-04T14:14:17Z", "creator": "sebb@apache.org", "creation_time": "2014-12-04T14:14:17Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 57308, "attachment_id": null, "id": 179539, "time": "2014-12-05T15:34:26Z", "creator": "markt@apache.org", "creation_time": "2014-12-05T15:34:26Z", "is_private": false, "text": "Fixed in trunk, 8.0.x (for 8.0.16 onwards) and 7.0.x (for 7.0.58 onwards)."}]