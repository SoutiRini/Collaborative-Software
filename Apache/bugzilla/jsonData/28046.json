[{"count": 0, "tags": [], "text": "If ant is started from the same directory that includes any JAR files, those JAR\nfiles are automatically added to the CLASSPATH. This means that any task cannot\nthen alter or delete those JARs as they are classed as being in use.\n\nI think that the default should be to not include any unspecified JAR files.\nAlso, the documentation should be updated to include this gotcha.\n\nI can confirm that no other process has a handle to the JARs in question which\nonly leaves ant. In addition, I can delete them using the Windows Explorer.", "is_private": false, "id": 54871, "creator": "nsydenham@yahoo.co.uk", "time": "2004-03-30T12:38:26Z", "bug_id": 28046, "creation_time": "2004-03-30T12:38:26Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 28046, "is_private": false, "count": 1, "id": 54872, "time": "2004-03-30T12:48:27Z", "creator": "mbenson@apache.org", "creation_time": "2004-03-30T12:48:27Z", "text": "What is the value of your CLASSPATH environment variable just prior to Ant \ninvocation?"}, {"count": 2, "tags": [], "bug_id": 28046, "attachment_id": null, "id": 54873, "time": "2004-03-30T12:58:14Z", "creator": "nsydenham@yahoo.co.uk", "creation_time": "2004-03-30T12:58:14Z", "is_private": false, "text": "It is blank"}, {"count": 3, "tags": [], "creator": "nsydenham@yahoo.co.uk", "attachment_id": null, "id": 54874, "creation_time": "2004-03-30T13:05:27Z", "time": "2004-03-30T13:05:27Z", "bug_id": 28046, "text": "Try running this twice:\n\n<project name=\"JARTest\" default=\"jar\">\n\t<target name=\"jar\" description=\"Create and delete JAR\">\n\t\t<jar destfile=\"test.jar\" basedir=\".\" update=\"true\" includes=\"build.xml\"/>\n\t</target>\n</project>\n\nThe second time you will get an error: D:\\tmp\\build.xml:3: Unable to rename old\nfile (D:\\tmp\\test.jar) to temporary file\n\nRemoving the basedir attribute seems to allow it to work.", "is_private": false}, {"count": 4, "tags": [], "creator": "mbenson@apache.org", "attachment_id": null, "id": 54879, "creation_time": "2004-03-30T14:43:30Z", "time": "2004-03-30T14:43:30Z", "bug_id": 28046, "text": "Uh, maybe the problem has to do with the fact that you are trying to add the \njar to itself... by calling the jar \"test.jar\" you are specifying that it lives \nin the Project's ${basedir} which is defaulted to \".\" due to its absence as an \nattribute of <project>.  You set the basedir attribute of your <jar> task \nto \".\" as well.  So while there could be such a problem as that described by \nthis bug report, that doesn't do it for me in the way of evidence.  I am \nthankful that you encountered problems trying this example, to be quite \nhonest.  :)", "is_private": false}, {"count": 5, "tags": [], "creator": "mbenson@apache.org", "attachment_id": null, "id": 54880, "creation_time": "2004-03-30T14:44:38Z", "time": "2004-03-30T14:44:38Z", "bug_id": 28046, "text": "Oh, wait... I missed your includes=\"build.xml\" so maybe that's not a problem \nhere after all... hmmm...", "is_private": false}, {"count": 6, "tags": [], "text": "I just tried your example with no problems...", "is_private": false, "id": 54881, "creator": "mbenson@apache.org", "time": "2004-03-30T14:47:12Z", "bug_id": 28046, "creation_time": "2004-03-30T14:47:12Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 28046, "attachment_id": null, "is_private": false, "id": 54884, "time": "2004-03-30T17:11:49Z", "creator": "nsydenham@yahoo.co.uk", "creation_time": "2004-03-30T17:11:49Z", "text": "The problem only occurs if you run ant from the same directory as the build.xml\nfile."}, {"count": 8, "tags": [], "text": "But that's what I did.  I'm running Win2K and I've tested this with 1.6.0 and \nCVS HEAD.  I doubt I would see a difference on 1.6.1.  :(", "is_private": false, "id": 54892, "creator": "mbenson@apache.org", "time": "2004-03-30T18:49:38Z", "bug_id": 28046, "creation_time": "2004-03-30T18:49:38Z", "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 28046, "attachment_id": null, "id": 54938, "time": "2004-03-31T08:50:33Z", "creator": "stevel@apache.org", "creation_time": "2004-03-31T08:50:33Z", "is_private": false, "text": "Nick. Do one thing for me: \n\necho %CLASSPATH%\n\nand paste in the results. \n\nI could see this behaviour if the classpath included \".\". I know you say it is\nblank, but I just want to make extra sure. \n\nThen do one more thing: ant -diagnostics\n\nagain, paste in the results.\n\nta,\n\nsteve"}, {"count": 10, "tags": [], "bug_id": 28046, "attachment_id": null, "id": 54971, "time": "2004-03-31T15:52:28Z", "creator": "nsydenham@yahoo.co.uk", "creation_time": "2004-03-31T15:52:28Z", "is_private": false, "text": "Slight confusion on my part here. My CLASSPATH env var wasn't set by me, but\nthere is an inherited system CLASSPATH which includes .\nRemoving the . fixes the problem.\n\nHowever....\n\nStandard Java behaviour doesn't include a JAR file unless it is explicitly\nincluded in the CLASSPATH so why is ant? When I run ant with the diagnostics\nflag I can see that it has added test.jar as d:\\tmp\\.\\test.jar to the\njava.class.path env variable. I would therefore still class this as a bug."}, {"attachment_id": null, "tags": [], "bug_id": 28046, "is_private": false, "count": 11, "id": 54997, "time": "2004-03-31T21:20:39Z", "creator": "mbenson@apache.org", "creation_time": "2004-03-31T21:20:39Z", "text": "I agree this is a good way to confuse people.  Looking for input from Antoine \nand esp. Conor since they appear to be the respective fathers of passing \nCLASSPATH via \"-lib\" and \"-lib\" searching directories.  Any suggestions, guys?"}, {"count": 12, "tags": [], "text": "I agree with the original poster.  I hit this behavior today as well and it\nbroke our build system.\n\nWe have targets to build JARs from a compiled source tree - the JAR output is\nplaced in the same directory as our build file. We also have targets to run an\napp (for developers) from the compiled source tree.  \n\nAfter upgrading to ant 1.6, this system breaks -- the run target now pulls\nclasses from the JAR files, much to the confusion of many.  I finally found the\nnew, one-line description in the manual stating that 'all elements of env. var.\nCLASSPATH are passed as -lib arguments to ant' -- thus they are scanned for JAR\nfiles.\n\nThis is very inconsistent with Java's standard behavior regarding CLASSPATH...", "is_private": false, "id": 63034, "creator": "heydowns@borg.com", "time": "2004-09-03T13:57:41Z", "bug_id": 28046, "creation_time": "2004-09-03T13:57:41Z", "attachment_id": null}, {"count": 13, "tags": [], "bug_id": 28046, "attachment_id": null, "id": 63115, "time": "2004-09-06T09:24:35Z", "creator": "peterreilly@apache.org", "creation_time": "2004-09-06T09:24:35Z", "is_private": false, "text": "This is fixed now in cvs see:\nhttp://marc.theaimsgroup.com/?t=109422652300005&r=1&w=2\nfor a discussion on the subject."}, {"count": 14, "tags": [], "bug_id": 28046, "attachment_id": null, "is_private": false, "id": 63712, "time": "2004-09-17T08:08:52Z", "creator": "peterreilly@apache.org", "creation_time": "2004-09-17T08:08:52Z", "text": "*** Bug 26108 has been marked as a duplicate of this bug. ***"}, {"attachment_id": null, "tags": [], "bug_id": 28046, "is_private": false, "count": 15, "id": 71495, "time": "2005-02-24T21:51:08Z", "creator": "overholt@redhat.com", "creation_time": "2005-02-24T21:51:08Z", "text": "With -lib changed to -cp, I'm getting:\n\n$ ant\nUnknown argument: -cp\n\nThis is on Fedora Core rawhide (what will become Fedora Core 4).  There are some\nslight differences between your current CVS head script and what we have, but\nthis is what it's actually trying to execute:\n\nexec \"/usr/lib/jvm/java/bin/java\" -classpath\n\"/usr/share/java/ant.jar:/usr/share/java/ant-launcher.jar:/usr/share/java/jaxp_parser_impl.jar:/usr/share/java/xml-commons-apis.jar:/usr/share/java/antlr.jar:/usr/share/java/ant/ant-antlr.jar:/usr/share/java/bcel.jar:/usr/share/java/ant/ant-apache-bcel.jar:/usr/share/java/log4j.jar:/usr/share/java/ant/ant-apache-log4j.jar:/usr/share/java/oro.jar:/usr/share/java/ant/ant-apache-oro.jar:/usr/share/java/regexp.jar:/usr/share/java/ant/ant-apache-regexp.jar:/usr/share/java/xml-commons-resolver.jar:/usr/share/java/ant/ant-apache-resolver.jar:/usr/share/java/jakarta-commons-logging.jar:/usr/share/java/ant/ant-commons-logging.jar:/usr/share/java/jdepend.jar:/usr/share/java/ant/ant-jdepend.jar:/usr/share/java/ant/ant-jmf.jar:/usr/share/java/junit.jar:/usr/share/java/ant/ant-junit.jar:/usr/share/java/ant/ant-nodeps.jar:/usr/share/java/ant/ant-swing.jar:/usr/share/java/jaxp_transform_impl.jar:/usr/share/java/ant/ant-trax.jar:/usr/lib/jvm/java/lib/tools.jar\"\n-Dant.home=\"/usr/share/ant\" -Dant.library.dir=\"/usr/share/ant/lib\"\norg.apache.tools.ant.launch.Launcher -cp \"\"\n\nMaybe it's something specific to me?  Does anyone else have a similar problem on\nLinux?  It happens both with IBM's JVM and java-gcj-compat.  I have no\n$CLASSPATH.  I'm going to reopen, but feel free to close again if I'm being stupid."}, {"count": 16, "tags": [], "bug_id": 28046, "attachment_id": null, "id": 71506, "time": "2005-02-25T10:22:12Z", "creator": "peterreilly@apache.org", "creation_time": "2005-02-25T10:22:12Z", "is_private": false, "text": "It is fixed in cvs, this has not been released yet.\n -cp is understood by the Launcher.java "}, {"count": 17, "tags": [], "creator": "mybugzillaacc@lycos.com", "attachment_id": null, "id": 76781, "creation_time": "2005-06-29T01:42:47Z", "time": "2005-06-29T01:42:47Z", "bug_id": 28046, "text": "This previously reported problem has appeared again with apache ant 1.6.5 and Mac OS X 10.4.1.  When \none goes back to apache ant 1.6.2 with Mac OS X 10.4.1, this problem goes away.", "is_private": false}, {"count": 18, "tags": [], "text": "Please confirm this by running ant -diagnostics\nalso one can see the contents of the classpath\nby running the script:\n<project default=\"show\">\n  <target name=\"show\">\n    <echo>classpath is ${java.class.path}</echo>\n  </target>\n</project>\n", "is_private": false, "id": 76795, "creator": "peterreilly@apache.org", "time": "2005-06-29T10:37:26Z", "bug_id": 28046, "creation_time": "2005-06-29T10:37:26Z", "attachment_id": null}, {"count": 19, "tags": [], "text": "(In reply to comment #15)\n> With -lib changed to -cp, I'm getting:\n> \n> $ ant\n> Unknown argument: -cp\n\nI had the same problem using Fedora Core 4.\nIf you are using Linux and you have an older version of Ant installed with an\nRPM package check /etc/ant.conf.\n \nTry also to run so that Ant will not read the /etc/ant.conf file:\nant --noconfig -version", "is_private": false, "id": 82614, "creator": "paolo.castagna@hp.com", "time": "2005-11-17T11:41:10Z", "bug_id": 28046, "creation_time": "2005-11-17T11:41:10Z", "attachment_id": null}, {"count": 20, "tags": [], "text": "no complaints after a year since they were requested = FIXED", "is_private": false, "id": 90689, "creator": "mbenson@apache.org", "time": "2006-06-27T21:19:24Z", "bug_id": 28046, "creation_time": "2006-06-27T21:19:24Z", "attachment_id": null}]