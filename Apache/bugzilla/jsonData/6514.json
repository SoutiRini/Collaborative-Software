[{"count": 0, "text": "When redefining a datatype it should check if the class name in the new\ndefinition is the same as the class name in the previous definition. Just the\nsame as when a task is redefined.\n\nHere is a simple patch, where the changes are copyied from the code that defines\na task:\n\nIndex: src/main/org/apache/tools/ant/Project.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-ant/src/main/org/apache/tools/ant/Project.java,v\nretrieving revision 1.93\ndiff -c -r1.93 Project.java\n*** src/main/org/apache/tools/ant/Project.java  2 Feb 2002 12:52:00 -0000      1.93\n--- src/main/org/apache/tools/ant/Project.java  18 Feb 2002 01:16:22 -0000\n***************\n*** 659,667 ****\n       * @param typeClass full datatype classname     \n       */\n      public void addDataTypeDefinition(String typeName, Class typeClass) {\n!         if (null != dataClassDefinitions.get(typeName)) {\n!             log(\"Trying to override old definition of datatype \"+typeName, \n!                 MSG_WARN);\n          }\n  \n          String msg = \" +User datatype: \" + typeName + \"     \" +\ntypeClass.getName();\n--- 659,675 ----\n       * @param typeClass full datatype classname     \n       */\n      public void addDataTypeDefinition(String typeName, Class typeClass) {\n!         Class old = (Class)dataClassDefinitions.get(typeName);\n!         if (null != old) {\n!             if (old.equals(typeClass)) {\n!                 log(\"Ignoring override for datatype \" + typeName \n!                     + \", it is already defined by the same class.\", \n!                     MSG_VERBOSE);\n!                 return;\n!             } else {\n!                 log(\"Trying to override old definition of datatype \"+typeName, \n!                     MSG_WARN);\n!             }\n          }\n  \n          String msg = \" +User datatype: \" + typeName + \"     \" +\ntypeClass.getName();", "creator": "pkr@netnord.dk", "is_private": false, "id": 10839, "time": "2002-02-18T01:19:34Z", "bug_id": 6514, "creation_time": "2002-02-18T01:19:34Z", "tags": [], "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 6514, "attachment_id": null, "id": 10891, "time": "2002-02-19T13:09:37Z", "creator": "bodewig@apache.org", "creation_time": "2002-02-19T13:09:37Z", "is_private": false, "text": "Thanks, nightly build 2002-02-20 contains your patch."}]