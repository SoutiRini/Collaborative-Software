[{"count": 0, "text": "After clearing a XSSFCell formula with setCellformula(null), if this cell is used in another cell in other sheet, Excel claims \"unreadable content\" because of the change. In the other hand, if it isn't used in other place, everything goes fine.", "bug_id": 57861, "is_private": false, "id": 182651, "time": "2015-04-27T13:23:57Z", "creator": "thorsen83@hotmail.com", "creation_time": "2015-04-27T13:23:57Z", "tags": [], "attachment_id": null}, {"count": 1, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "text": "Not sure if I understand completely what you are trying to do, but it is probably not a good idea to \"re-use\" objects across rows/sheets as they have links internally. Especially if you remove objects they should usually not be used any more after that. \n\nIf you think this is still a valid bug, then please post some code, preferably in self-sufficient unit-test form so we can try to comment on it and/or reproduce it locally.", "id": 182655, "time": "2015-04-27T14:09:05Z", "bug_id": 57861, "creation_time": "2015-04-27T14:09:05Z", "is_private": false}, {"count": 2, "tags": [], "creator": "thorsen83@hotmail.com", "attachment_id": 32689, "id": 182660, "time": "2015-04-27T15:30:27Z", "bug_id": 57861, "creation_time": "2015-04-27T15:30:27Z", "is_private": false, "text": "Created attachment 32689\nTemplate used to create the graph"}, {"count": 3, "tags": [], "bug_id": 57861, "is_private": false, "id": 182661, "attachment_id": 32690, "creator": "thorsen83@hotmail.com", "creation_time": "2015-04-27T15:31:10Z", "time": "2015-04-27T15:31:10Z", "text": "Created attachment 32690\nTemplate used to create the graph"}, {"count": 4, "tags": [], "creator": "thorsen83@hotmail.com", "is_private": false, "text": "The use case is a basic xlsx file with two sheets, one for data the other for a graph. This xlsx file is used as a template, so everytime the app is asked to generate a new graph it reads the template, sets cell values and evaluates formula cells in order to generate the graph. Finally, the data sheet is hid and the graph sheet selected as active and thus the app is able to send it to printer and only get the generated graph.\nIn the data sheet, we have a final column with formulae that sometimes we want to override with database-generated values and that's why we need to clear the formulae. Those values or formulae are being used in the graph sheet and there is where we're experiencing this bug. If we remove the graph sheet, Excel doesn't have the unreadable content problem otherwise has.\n\nCode used:\n\nXSSFCell cell;\n\n[...]\ncell.setCellFormula(null);\ncell.setCellValue(value);\n[...]\nXSSFFormulaEvaluator.evaluateAllFormulaCells(workbook);\nworkbook.setSheetHidden(workbook.getSheetIndex(dataSheet), true);\nworkbook.setActiveSheet(workbook.getSheetIndex(graphSheet));", "id": 182662, "time": "2015-04-27T15:37:24Z", "bug_id": 57861, "creation_time": "2015-04-27T15:37:24Z", "attachment_id": null}]