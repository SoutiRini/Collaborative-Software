[{"count": 0, "tags": [], "text": "_Every_ time stopping or restarting apache following error is in the log:\n\n(70007)The timeout specified has expired: apr_pollset_poll: (listen)\n\nThe context is the following:\n\n[Sat Jun 02 14:59:40 2007] [error] (70007)The timeout specified has expired:\napr_pollset_poll: (listen)\n[Sat Jun 02 14:59:42 2007] [notice] SIGHUP received.  Attempting to restart\n[Sat Jun 02 14:59:42 2007] [notice] Digest: generating secret for digest\nauthentication ...\n[Sat Jun 02 14:59:42 2007] [notice] Digest: done\n[Sat Jun 02 14:59:44 2007] [notice] Apache/2.2.4 (Unix) mod_ssl/2.2.4\nOpenSSL/0.9.8d configured -- resuming normal operations\n\n\nThe bug also in 2.2.3 occurs. Other versions are not tested.", "is_private": false, "bug_id": 42580, "id": 104053, "time": "2007-06-04T14:59:54Z", "creator": "kevin.richter@uni-hildesheim.de", "creation_time": "2007-06-04T14:59:54Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "What MPM are you using?", "is_private": false, "id": 104093, "creation_time": "2007-06-05T12:46:34Z", "time": "2007-06-05T12:46:34Z", "creator": "rpluem@apache.org", "bug_id": 42580, "attachment_id": null}, {"count": 2, "attachment_id": null, "creator": "kevin.richter@uni-hildesheim.de", "is_private": false, "id": 104094, "time": "2007-06-05T13:05:47Z", "bug_id": 42580, "creation_time": "2007-06-05T13:05:47Z", "tags": [], "text": "Worker\n\nThat might be the problem. Ive got running a 2.2.3 with prefork. There are no\nproblems.\n\nAnd Ive got a 2.2.4 and a 2.2.3 with worker where these apr problems occur."}, {"count": 3, "tags": [], "text": "Sorry, I am new to Bugzilla. Do I have to check the \"reassign\" checkbox like I\ndo now?\nMy answer to your question is 11 days old.\nOr isnt there a solution for the problem?", "is_private": false, "id": 104460, "creation_time": "2007-06-16T07:31:39Z", "time": "2007-06-16T07:31:39Z", "creator": "kevin.richter@uni-hildesheim.de", "bug_id": 42580, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 42580, "attachment_id": null, "id": 104465, "creation_time": "2007-06-16T09:25:35Z", "time": "2007-06-16T09:25:35Z", "creator": "rpluem@apache.org", "text": "(In reply to comment #3)\n> Sorry, I am new to Bugzilla. Do I have to check the \"reassign\" checkbox like I\n> do now?\n\nNo, you don't need to. You are doing it perfectly.\n\n> My answer to your question is 11 days old.\n\nThanks for that.\n\n> Or isnt there a solution for the problem?\n\nIt is lack of time :-). Sofar nobody had some time to dig into it.\nFeel free to bug us here from time to time if you see no progress.", "is_private": false}, {"count": 5, "tags": [], "creator": "kevin.richter@uni-hildesheim.de", "attachment_id": null, "id": 104466, "time": "2007-06-16T14:05:19Z", "bug_id": 42580, "creation_time": "2007-06-16T14:05:19Z", "is_private": false, "text": "Ok, thanks. No problem.\n\nPerhaps I can help i bit. I have examined the situation. Here the results:\n\nThe apr problem only occurs, when the Apache runs in a Solaris Zone. When it\nruns in the global context (means: not in a zone), the apache restart does NOT\ncause an APR_TIMEUP.\n\nIs it right, that the error is from srclib/apr/poll/unix/poll.c from line 253?\nAnd the causing function is the poll(..) system call?\n\n\"man poll\" under Solaris says the same as the source code:\n\nRETURN VALUES\n     Upon  successful  completion,  a   non-negative   value   is\n     returned.  A  positive  value  indicates the total number of\n     file descriptors that  has  been  selected  (that  is,  file\n     descriptors  for  which  the  revents member is non-zero). A\n     value of 0 indicates that the call timed  out  and  no  file\n     descriptors have been selected. Upon failure, -1 is returned\n     and errno is set to indicate the error.\n\n\nPerhaps its not possible to execute poll(..) in a Solaris zone?\nOr there is a missing device in /dev/?\n"}, {"count": 6, "tags": [], "text": "(In reply to comment #5)\n\n> The apr problem only occurs, when the Apache runs in a Solaris Zone. When it\n> runs in the global context (means: not in a zone), the apache restart does NOT\n> cause an APR_TIMEUP.\n\nThis is an interesting information.\n\n> \n> Is it right, that the error is from srclib/apr/poll/unix/poll.c from line 253?\n\nAs you are using zones I suppose that you are running on Solaris 10. So I guess\nthat you have port support there and you should be rather in line 291 of port.c\nin the same directory. You can check if you have port support by checking if\nHAVE_PORT_CREATE is defined in srclib/apr/include/arch/unix/apr_private.h\n\n> And the causing function is the poll(..) system call?\n\nI think it is rather port_getn.\n\n> \n> \"man poll\" under Solaris says the same as the source code:\n> \n> RETURN VALUES\n>      Upon  successful  completion,  a   non-negative   value   is\n>      returned.  A  positive  value  indicates the total number of\n>      file descriptors that  has  been  selected  (that  is,  file\n>      descriptors  for  which  the  revents member is non-zero). A\n>      value of 0 indicates that the call timed  out  and  no  file\n>      descriptors have been selected. Upon failure, -1 is returned\n>      and errno is set to indicate the error.\n> \n> \n> Perhaps its not possible to execute poll(..) in a Solaris zone?\n> Or there is a missing device in /dev/?\n\nI don't think that this is the case. If you wouldn't be able to use this system\ncall httpd would not work at all. I suppose that it has something to do with the\nrestart logic itself. What happens (error message wise) if you\n\n1. Stop httpd\n2. do a gracefull restart\n3. do a graceful shutdown\n\nin your zone.\n\n\n> ", "is_private": false, "id": 104467, "creation_time": "2007-06-16T15:28:37Z", "time": "2007-06-16T15:28:37Z", "creator": "rpluem@apache.org", "bug_id": 42580, "attachment_id": null}, {"text": "> As you are using zones I suppose that you are running on Solaris 10. \n\nYes, thats right. Solaris 10 for sparc architecture - and not for x86.\n\n\n> So I guess\n> that you have port support there and you should be rather in line 291 of port.c\n> in the same directory. You can check if you have port support by checking if\n> HAVE_PORT_CREATE is defined in srclib/apr/include/arch/unix/apr_private.h\n\nYes, it is defined there.\n\nSince September 2006 there is a patch for two port_getn problems:\n6374407 port_getn does not dissociate fd when it reports an event on it\n6402576 Sometimes port_getn() never returns indicating that a socket has become\nwritable\n\nDont know either if the patch was applied on this server nor if it is possible\nthat is has something to do with the APR_TIMEUP problem.\n\n\n> I don't think that this is the case. If you wouldn't be able to use this system\n> call httpd would not work at all. I suppose that it has something to do with the\n> restart logic itself. What happens (error message wise) if you\n> \n> 1. Stop httpd\n> 2. do a gracefull restart\n> 3. do a graceful shutdown\n> \n> in your zone.\n\nThe error occurs in each case (of the three).\n\n", "tags": [], "bug_id": 42580, "is_private": false, "count": 7, "id": 104471, "time": "2007-06-17T07:16:52Z", "creator": "kevin.richter@uni-hildesheim.de", "creation_time": "2007-06-17T07:16:52Z", "attachment_id": null}, {"count": 8, "attachment_id": null, "creator": "kevin.richter@uni-hildesheim.de", "is_private": false, "id": 104655, "time": "2007-06-23T08:14:16Z", "bug_id": 42580, "creation_time": "2007-06-23T08:14:16Z", "tags": [], "text": "Sorry, I was wrong. Today I have seen that the APR_TIMEUP also occurs in the\nglobal context / global zone :-(\n\nAnd not only one timeup per restart... how you can see... \n\n[Sat Jun 23 13:01:30 2007] [error] (70007)The timeout specified has expired:\napr_pollset_poll: (listen)\n[Sat Jun 23 13:01:31 2007] [notice] SIGHUP received.  Attempting to restart\n[Sat Jun 23 13:01:31 2007] [notice] Apache/2.2.4 (Unix) configured -- resuming\nnormal operations\n[Sat Jun 23 13:01:32 2007] [error] (70007)The timeout specified has expired:\napr_pollset_poll: (listen)\n[Sat Jun 23 13:01:39 2007] [error] (70007)The timeout specified has expired:\napr_pollset_poll: (listen)\n[Sat Jun 23 13:01:40 2007] [error] (70007)The timeout specified has expired:\napr_pollset_poll: (listen)\n[Sat Jun 23 13:01:41 2007] [error] (70007)The timeout specified has expired:\napr_pollset_poll: (listen)\n[Sat Jun 23 13:06:31 2007] [error] (70007)The timeout specified has expired:\napr_pollset_poll: (listen)\n\n\nAny ideas how I can help?\nCan I debug this issue?\n"}, {"count": 9, "tags": [], "creator": "kevin.richter@uni-hildesheim.de", "attachment_id": null, "id": 104951, "time": "2007-06-30T08:37:17Z", "bug_id": 42580, "creation_time": "2007-06-30T08:37:17Z", "is_private": false, "text": "Ok, the second time I was wrong. But now i have got the problem! :)\n\nI accuse a second Listen directive! \n(Doesnt matter if in the global context or in a zone.)\n\nFor example:\nListen 192.168.1.7:80\nListen 192.168.1.7:81\n-> The APR_TIMEUP happens when restarting, stopping, ...\n\nListen 192.168.1.7:80\n-> No APR_TIMEUP\n\nOmitting the IP and using Listen *:80 and Listen *:81 didnt solve the problem.\nThe APR_TIMEUP occurs.\n\n\nPlease help :)\n\n"}, {"count": 10, "tags": [], "creator": "pooleb@gmail.com", "attachment_id": null, "is_private": false, "id": 111313, "time": "2007-11-30T13:23:34Z", "bug_id": 42580, "creation_time": "2007-11-30T13:23:34Z", "text": "Hello,\n\nI can also reproduce this error on my Solaris 10 servers with a recent build of\nApache 2.2.6. Whenever I run a graceful restart, I see the same apr_timeout\nmessage in the log file. Perhaps more importantly, this SOMETIMES seems to be\nleaving behind children processes that shouldn't still be running after a\ngraceful restart. Sometimes it leaves one child process, sometimes it leaves 5.\n\nFor example, on a completely idle server, here is a ps list after numerous\ngraceful restarts in a row:\n\n$ ps -ef | grep http\nwebservd 19097 18781   0 16:10:01 ?           0:00\n/usr/local/apache-2.2.6/bin/httpd -k start\n    root 18781 12143   1 16:02:28 ?           0:04\n/usr/local/apache-2.2.6/bin/httpd -k start\nwebservd 18868 18781   0 16:03:53 ?           0:00\n/usr/local/apache-2.2.6/bin/httpd -k start\nwebservd 19095 18781   0 16:10:01 ?           0:00\n/usr/local/apache-2.2.6/bin/httpd -k start\nwebservd 19099 18781   0 16:10:01 ?           0:00\n/usr/local/apache-2.2.6/bin/httpd -k start\nwebservd 19096 18781   0 16:10:01 ?           0:00\n/usr/local/apache-2.2.6/bin/httpd -k start\nwebservd 19098 18781   0 16:10:01 ?           0:00\n/usr/local/apache-2.2.6/bin/httpd -k start\nwebservd 19072 18781   0 16:08:59 ?           0:00\n/usr/local/apache-2.2.6/bin/httpd -k start\n\nThere were no client requests made to this daemon during this period as it is a\ncompletely idle test box and yet there are consistently processes (19072, 18868\nin this example) that are not exiting as I would expect them to. A truss of one\nof the hung up processes is sticking in port_getn:\n\n$ truss -p 18868\nport_getn(19, 0x00224298, 2, 1, 0x00000000) (sleeping...)\n\nThe log file showing the restarts and errors in the log during this period is below:\n\n[Fri Nov 30 16:02:27 2007] [notice] Digest: generating secret for digest\nauthentication ...\n[Fri Nov 30 16:02:27 2007] [notice] Digest: done\n[Fri Nov 30 16:02:27 2007] [notice] Apache/2.2.6 (Unix) mod_ssl/2.2.6\nOpenSSL/0.9.8g configured -- resuming normal operations\n[Fri Nov 30 16:02:33 2007] [notice] Graceful restart requested, doing restart\n[Fri Nov 30 16:02:33 2007] [notice] Digest: generating secret for digest\nauthentication ...\n[Fri Nov 30 16:02:33 2007] [notice] Digest: done\n[Fri Nov 30 16:02:33 2007] [notice] Apache/2.2.6 (Unix) mod_ssl/2.2.6\nOpenSSL/0.9.8g configured -- resuming normal operations\n[Fri Nov 30 16:02:58 2007] [notice] Graceful restart requested, doing restart\n[Fri Nov 30 16:02:58 2007] [error] (70007)The timeout specified has expired:\napr_pollset_poll: (listen)\n[Fri Nov 30 16:02:59 2007] [notice] Digest: generating secret for digest\nauthentication ...\n[Fri Nov 30 16:02:59 2007] [notice] Digest: done\n[Fri Nov 30 16:02:59 2007] [notice] Apache/2.2.6 (Unix) mod_ssl/2.2.6\nOpenSSL/0.9.8g configured -- resuming normal operations\n[Fri Nov 30 16:03:31 2007] [notice] Graceful restart requested, doing restart\n[Fri Nov 30 16:03:31 2007] [error] (70007)The timeout specified has expired:\napr_pollset_poll: (listen)\n[Fri Nov 30 16:03:31 2007] [error] (70007)The timeout specified has expired:\napr_pollset_poll: (listen)\n[Fri Nov 30 16:03:31 2007] [notice] Digest: generating secret for digest\nauthentication ...\n[Fri Nov 30 16:03:31 2007] [notice] Digest: done\n[Fri Nov 30 16:03:31 2007] [notice] Apache/2.2.6 (Unix) mod_ssl/2.2.6\nOpenSSL/0.9.8g configured -- resuming normal operations\n[Fri Nov 30 16:03:34 2007] [notice] Graceful restart requested, doing restart\n[Fri Nov 30 16:03:34 2007] [error] (70007)The timeout specified has expired:\napr_pollset_poll: (listen)\n[Fri Nov 30 16:03:34 2007] [error] (70007)The timeout specified has expired:\napr_pollset_poll: (listen)\n[Fri Nov 30 16:03:34 2007] [error] (70007)The timeout specified has expired:\napr_pollset_poll: (listen)\n[Fri Nov 30 16:03:34 2007] [notice] Digest: generating secret for digest\nauthentication ...\n[Fri Nov 30 16:03:34 2007] [notice] Digest: done\n[Fri Nov 30 16:03:34 2007] [notice] Apache/2.2.6 (Unix) mod_ssl/2.2.6\nOpenSSL/0.9.8g configured -- resuming normal operations\n[Fri Nov 30 16:03:52 2007] [notice] Graceful restart requested, doing restart\n[Fri Nov 30 16:03:52 2007] [error] (70007)The timeout specified has expired:\napr_pollset_poll: (listen)\n[Fri Nov 30 16:03:52 2007] [notice] Digest: generating secret for digest\nauthentication ...\n[Fri Nov 30 16:03:52 2007] [notice] Digest: done\n[Fri Nov 30 16:03:52 2007] [notice] Apache/2.2.6 (Unix) mod_ssl/2.2.6\nOpenSSL/0.9.8g configured -- resuming normal operations\n[Fri Nov 30 16:04:02 2007] [notice] Graceful restart requested, doing restart\n[Fri Nov 30 16:04:02 2007] [error] (70007)The timeout specified has expired:\napr_pollset_poll: (listen)\n[Fri Nov 30 16:04:02 2007] [notice] Digest: generating secret for digest\nauthentication ...\n[Fri Nov 30 16:04:02 2007] [notice] Digest: done\n[Fri Nov 30 16:04:03 2007] [notice] Apache/2.2.6 (Unix) mod_ssl/2.2.6\nOpenSSL/0.9.8g configured -- resuming normal operations\n[Fri Nov 30 16:08:58 2007] [notice] Graceful restart requested, doing restart\n[Fri Nov 30 16:08:58 2007] [error] (70007)The timeout specified has expired:\napr_pollset_poll: (listen)\n[Fri Nov 30 16:08:58 2007] [notice] Digest: generating secret for digest\nauthentication ...\n[Fri Nov 30 16:08:58 2007] [notice] Digest: done\n[Fri Nov 30 16:08:58 2007] [notice] Apache/2.2.6 (Unix) mod_ssl/2.2.6\nOpenSSL/0.9.8g configured -- resuming normal operations\n[Fri Nov 30 16:10:00 2007] [notice] Graceful restart requested, doing restart\n[Fri Nov 30 16:10:00 2007] [error] (70007)The timeout specified has expired:\napr_pollset_poll: (listen)\n[Fri Nov 30 16:10:00 2007] [error] (70007)The timeout specified has expired:\napr_pollset_poll: (listen)\n[Fri Nov 30 16:10:00 2007] [notice] Digest: generating secret for digest\nauthentication ...\n[Fri Nov 30 16:10:00 2007] [notice] Digest: done\n[Fri Nov 30 16:10:00 2007] [notice] Apache/2.2.6 (Unix) mod_ssl/2.2.6\nOpenSSL/0.9.8g configured -- resuming normal operations\n\n\nSome info about my config.. Server is on Solaris 10/sparc recently patched with\nthe 10/31/2007 Recommended patch cluster. Following modules are loaded:\ncore_module (static), mpm_prefork_module (static), http_module (static),\nso_module (static), alias_module (shared), authn_default_module (shared),\nauthn_file_module (shared), authz_default_module (shared), authz_host_module\n(shared), auth_basic_module (shared), auth_digest_module (shared),\ndeflate_module (shared), dir_module (shared), dumpio_module (shared),\nheaders_module (shared), include_module (shared), log_config_module (shared),\nlogio_module (shared), mime_module (shared), proxy_module (shared),\nproxy_ajp_module (shared), proxy_balancer_module (shared), proxy_http_module\n(shared), rewrite_module (shared), setenvif_module (shared), ssl_module\n(shared), vhost_alias_module (shared)\n\n/usr/local/apache-2.2.6/bin/httpd -V\nServer version: Apache/2.2.6 (Unix)\nServer built:   Nov 27 2007 18:40:30\nServer's Module Magic Number: 20051115:5\nServer loaded:  APR 1.2.11, APR-Util 1.2.10\nCompiled using: APR 1.2.11, APR-Util 1.2.10\nArchitecture:   32-bit\nServer MPM:     Prefork\n  threaded:     no\n    forked:     yes (variable process count)\nServer compiled with....\n -D APACHE_MPM_DIR=\"server/mpm/prefork\"\n -D APR_HAS_SENDFILE\n -D APR_HAS_MMAP\n -D APR_HAVE_IPV6 (IPv4-mapped addresses enabled)\n -D APR_USE_FCNTL_SERIALIZE\n -D APR_USE_PTHREAD_SERIALIZE\n -D SINGLE_LISTEN_UNSERIALIZED_ACCEPT\n -D APR_HAS_OTHER_CHILD\n -D AP_HAVE_RELIABLE_PIPED_LOGS\n -D DYNAMIC_MODULE_LIMIT=128\n -D HTTPD_ROOT=\"/usr/local/apache-2.2.6\"\n -D SUEXEC_BIN=\"/usr/local/apache-2.2.6/bin/suexec\"\n -D DEFAULT_PIDLOG=\"logs/httpd.pid\"\n -D DEFAULT_SCOREBOARD=\"logs/apache_runtime_status\"\n -D DEFAULT_LOCKFILE=\"logs/accept.lock\"\n -D DEFAULT_ERRORLOG=\"logs/error_log\"\n -D AP_TYPES_CONFIG_FILE=\"conf/mime.types\"\n -D SERVER_CONFIG_FILE=\"conf/httpd.conf\"\n\nHappy to assist with debugging this but I'm not sure what needs to be looked at\nand don't really have the time to go spelunking into it all by my lonesome.\nAnyone care to assist?"}, {"count": 11, "tags": [], "text": "Tested 2.0.61 on the same machine with similar options and do not see this\nproblem. Updated version to 2.2.6 in the bug report.", "is_private": false, "bug_id": 42580, "id": 111381, "time": "2007-12-03T15:10:40Z", "creator": "pooleb@gmail.com", "creation_time": "2007-12-03T15:10:40Z", "attachment_id": null}, {"count": 12, "tags": [], "bug_id": 42580, "is_private": false, "id": 113248, "creation_time": "2008-01-28T19:08:20Z", "time": "2008-01-28T19:08:20Z", "creator": "basant.kukreja@sun.com", "text": "I also saw the similar behavior in open solaris (snv_79).\n\nhttpd.conf contains :\nListen 192.168.21.1:80\nListen 192.168.22.1:80\n\nIn error log, I observed : \n[Mon Jan 28 18:10:48 2008] [notice] Apache/2.2.6 (Unix) configured -- resuming\nnormal operations\n[Mon Jan 28 18:10:49 2008] [error] (70007)The timeout specified has expired:\napr_pollset_poll: (listen)\n\n", "attachment_id": null}, {"count": 13, "attachment_id": 21511, "creator": "basant.kukreja@sun.com", "is_private": false, "id": 113645, "time": "2008-02-11T14:47:05Z", "bug_id": 42580, "creation_time": "2008-02-11T14:47:05Z", "tags": [], "text": "Created attachment 21511\nPatch\n\nWhen I had the following settings :\n\nListen 192.168.21.1:81\nListen 192.168.22.1:81\n\n<IfModule worker.c>\nListenBackLog\t  50000\nStartServers\t     2\nThreadLimit\t   5\nThreadsPerChild    5\nMinSpareThreads    1\nMaxSpareThreads    1\nThreadsPerChild    5\nMaxClients\t  10\nMaxRequestsPerChild  0\n</IfModule>\n\nI was getting the following error in my error log\n[Mon Feb 11 13:33:52 2008] [error] (70007)The timeout specified has expired:\napr_pollset_poll : (listen)\n\nOn debugging, I found out that the listener thread calls port_getn to listen\nfor new connections, it was getting SIGHUP signal. This was confirmed by truss\noutput.\n\n5541/1: \tread(6, 0xFFFFFD7FFFDFF38B, 1)\t(sleeping...)\n5541/7: \tlwp_park(0x00000000, 0) \t(sleeping...)\n5541/6: \tlwp_park(0x00000000, 0) \t(sleeping...)\n5541/5: \tlwp_park(0x00000000, 0) \t(sleeping...)\n5541/4: \tlwp_park(0x00000000, 0) \t(sleeping...)\n5541/3: \tlwp_park(0x00000000, 0) \t(sleeping...)\n5541/8: \tport_getn(12, 0x00539D30, 2, 1, 0x00000000) (sleeping...)\n5543/1: \tread(6, 0xFFFFFD7FFFDFF38B, 1)\t(sleeping...)\n5543/3: \tlwp_park(0x00000000, 0) \t(sleeping...)\n5543/4: \tlwp_park(0x00000000, 0) \t(sleeping...)\n5543/5: \tlwp_park(0x00000000, 0) \t(sleeping...)\n5543/6: \tlwp_park(0x00000000, 0) \t(sleeping...)\n5543/7: \tlwp_park(0x00000000, 0) \t(sleeping...)\n5543/8: \tfcntl(11, F_SETLKW, 0xFFFFFD7FFF241E10) (sleeping...)\n5539/1: \tpollsys(0xFFFFFD7FFFDFF2E0, 0, 0xFFFFFD7FFFDFF3A0, 0x00000000)\n= 0\n5539/1: \twrite(7, \" !\", 1)\t\t\t\t= 1\n5541/1: \tread(6, \" !\", 1)\t\t\t\t= 1\n5541/1: \tlwp_wait(2, 0xFFFFFD7FFFDFF31C) \t\t= 0\n5541/1: \tlwp_kill(8, SIGHUP)\t\t\t\t= 0\n5541/1: \tlwp_kill(8, SIG#0)\t\t\t\t= 0\n5541/8: \t    Received signal #1, SIGHUP, in port_getn() [caught]\n5541/8: \t      siginfo: SIGHUP pid=5541 uid=101 code=-1\n5541/8: \tport_getn(12, 0x00539D30, 2, 1, 0x00000000)\tErr#4 EINTR\n5541/8: \tlwp_sigmask(SIG_SETMASK, 0xFFBEE007, 0x0000FFF7) = 0xFFBFFEFF\n[0x0000FFFF]\n\nNote that 5541/8 is the listener thread and 5541/1 was sending the SIGHUP\nsignal.\n\nI further debugged why one of my process is dieing. Then I found out that\nin worker.c, in perform_idle_server_maintenance function, \n\n    if (idle_thread_count > max_spare_threads) {\n\t/* Kill off one child */\n\tap_mpm_pod_signal(pod, TRUE);\n\tidle_spawn_rate = 1;\n\t..\nFrom debugging, I found out that idle_thread_count was set to 10 and\nmax_spare_threads was set to 6.  Hence the first thread was sending SIGHUP\nsignal to kill the process.\n\nIf I increase the MaxSpareThreads to 10 then this error disappeared because in\nthat case, worker process didn't try to kill himself.\n<IfModule worker.c>\nListenBackLog\t  50000\nStartServers\t     2\nThreadLimit\t   5\nThreadsPerChild    5\nMinSpareThreads    1\nMaxSpareThreads    10\nThreadsPerChild    5\nMaxClients\t  10\nMaxRequestsPerChild  0\n</IfModule>\n\nThe error message is misleading and it may or may not appear. It depends on the\n\ntiming. If listener thread has been reached to the point when it is blocked\nwith port_getn then we get this error. It seems to me that server wanted to\ndeliberately kill one of the child process.\n\nCasue of the problem is that apr_pollset_poll function doesn't differentiate\nthe EINTR and ETIME.  apr_pollset_poll contains ...\n\tif (errno == ETIME || errno == EINTR) {\n\t    rv = APR_TIMEUP;\n\t}\n\nIn worker.c, we do expect EINTR to be normal as shown below :\n-------------- worker.c --------------------------\n\t\trv = apr_pollset_poll(pollset, -1, &numdesc, &pdesc);\n\t\tif (rv != APR_SUCCESS) {\n\t\t    if (APR_STATUS_IS_EINTR(rv)) {\n\t\t\tcontinue;\n\t\t    }\n--------------------------------------------------\n\nIf we allow EINTR as a known error and return APR_EINTR as given in suggested\npatch then this error disappeared."}, {"count": 14, "tags": [], "creator": "jorton@redhat.com", "attachment_id": null, "is_private": false, "id": 113654, "time": "2008-02-12T02:02:26Z", "bug_id": 42580, "creation_time": "2008-02-12T02:02:26Z", "text": "So this is an APR bug.  I've no idea why the Solaris port pollset code would map\nEINTR to APR_ETIMEUP; can you post that patch to dev@apr to solicit feedback?"}, {"count": 15, "tags": [], "text": "I posted the patch to apr dev list.", "is_private": false, "id": 113662, "creation_time": "2008-02-12T11:58:24Z", "time": "2008-02-12T11:58:24Z", "creator": "basant.kukreja@sun.com", "bug_id": 42580, "attachment_id": null}, {"count": 16, "tags": [], "text": "Here is the link to the apr question which I posted :\nhttp://mail-archives.apache.org/mod_mbox/apr-dev/200802.mbox/browser\n", "is_private": false, "id": 113663, "creation_time": "2008-02-12T12:31:11Z", "time": "2008-02-12T12:31:11Z", "creator": "basant.kukreja@sun.com", "bug_id": 42580, "attachment_id": null}, {"count": 17, "tags": [], "creator": "basant.kukreja@sun.com", "attachment_id": 21513, "id": 113667, "time": "2008-02-12T13:38:12Z", "bug_id": 42580, "creation_time": "2008-02-12T13:38:12Z", "is_private": false, "text": "Created attachment 21513\nNew patch\n\nBased on the suggestion from Lucian Adrian Grijincu, I have updated the patch."}, {"text": "Now fixed in 1.2.x (for httpd) as well as trunk+1.3", "tags": [], "bug_id": 42580, "is_private": false, "count": 18, "id": 115598, "time": "2008-04-14T15:00:44Z", "creator": "nick@webthing.com", "creation_time": "2008-04-14T15:00:44Z", "attachment_id": null}]