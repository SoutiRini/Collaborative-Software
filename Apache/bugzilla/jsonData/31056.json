[{"count": 0, "tags": [], "bug_id": 31056, "attachment_id": null, "text": "The ConsoleAppender can be configured to log messages to Standard Out or\nStandard Error.\n\nBoth of these streams may be redirected using System.setErr and System.setOut.\n\nIn the current implementation, a Console appender stores a reference to it's\ndestination stream when it is initially configured and will continue to use that\nreference unless it is reconfigured. As a result, a ConsoleAppender will\ncontinue to log to the old stdout/stderr destination even after the system\nstream has been redirected.\n\nSince log4j may be automatically configured very early in the application\nlifecycle (in the case of my project, due to a call to Logger.getLogger in a\nstatic member initialization), it can be difficult or impossible to be sure that\nany necessary redirection takes place before log4j initialization.\n\nMy patch proposes a solution to this problem. The modified ConsoleAppender\noverrides the AppenderSkeleton.append( LoggingEvent ) method to verify that the\nsystem's stream has not changed since it was last configured. If it has changed,\nthe ConsoleAppender updates itself to use the new reference.", "id": 63071, "time": "2004-09-03T20:05:44Z", "creator": "erik@spectacle.ca", "creation_time": "2004-09-03T20:05:44Z", "is_private": false}, {"count": 1, "tags": [], "text": "Created attachment 12643\nPatch to ConsoleAppender.java", "attachment_id": 12643, "id": 63072, "creator": "erik@spectacle.ca", "time": "2004-09-03T20:07:14Z", "bug_id": 31056, "creation_time": "2004-09-03T20:07:14Z", "is_private": false}, {"count": 2, "tags": [], "text": "The patch was done against the version of ConsoleAppender.java included in the\nlog4j 1.2.8 distribution.", "attachment_id": null, "bug_id": 31056, "id": 63073, "time": "2004-09-03T20:08:25Z", "creator": "erik@spectacle.ca", "creation_time": "2004-09-03T20:08:25Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 31056, "text": "This bug causes lost output when log4j, ANT and JUnit are used to run tests.\n\nSince the ANT <junit> task captures System.out and System.err in its XML result\nfiles, the best way to keep the logging statements and test results together is\nto configure log4j to use the ConsoleAppender and write to System.out. \nUnfortunately, if the <junit> task is forked, System.out is reset after log4j is\nconfigured and the logging statements are not captured.\n\nThere appears to have been no activity on this bug sine Erik submitted it over\nsix months ago.  If someone could adopt this bug and apply Erik's patch, that\nwould be great.  If Erik's patch is in some way deficient, I'll volunteer to fix\nthe issues if I get reasonable assurance that the resulting patch will be applied.", "id": 72913, "time": "2005-03-28T01:13:16Z", "creator": "rdecampo@twcny.rr.com", "creation_time": "2005-03-28T01:13:16Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 31056, "text": "We have the some problem at the moment. A small workaround ist not to fork the\njunit task but that helps not allways. A better solution is to fix this problem.\nPlease fix it in next version. (I tried with 1.2.9)", "id": 74212, "time": "2005-04-28T10:49:42Z", "creator": "news@stevez.de", "creation_time": "2005-04-28T10:49:42Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "text": "\nWould it be possible to include a unit test with this patch?", "is_private": false, "id": 74280, "creator": "ceki@apache.org", "time": "2005-04-29T18:31:49Z", "bug_id": 31056, "creation_time": "2005-04-29T18:31:49Z", "attachment_id": null}, {"count": 6, "tags": [], "text": "I've committed v 1.24 of ConsoleAppender that addresses the issue by using nested implementations of \nOutputStream that redirect to the current value of System.out or System.err.  May want to back port to \n1.2 after review.", "attachment_id": null, "id": 74565, "creator": "carnold@apache.org", "time": "2005-05-07T18:58:11Z", "bug_id": 31056, "creation_time": "2005-05-07T18:58:11Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 31056, "attachment_id": null, "id": 76890, "creation_time": "2005-07-01T19:53:09Z", "time": "2005-07-01T19:53:09Z", "creator": "mwomack@apache.org", "text": "1.2.12 candidate\n\nReopened for 1.2.12 consideration.", "is_private": false}, {"count": 8, "tags": [], "bug_id": 31056, "attachment_id": null, "id": 76900, "time": "2005-07-01T20:34:31Z", "creator": "carnold@apache.org", "creation_time": "2005-07-01T20:34:31Z", "is_private": false, "text": "I'll accept back-porting to log4j 1.2.x branch."}, {"count": 9, "tags": [], "bug_id": 31056, "attachment_id": null, "text": "Back ported to 1.2 branch.", "id": 77309, "time": "2005-07-14T21:32:41Z", "creator": "carnold@apache.org", "creation_time": "2005-07-14T21:32:41Z", "is_private": false}, {"count": 10, "tags": [], "text": "Can we look at modifying this fix since it appears to cause #37122.  Maybe \nhave old behavior the default and the new behavior controlled by a new flag?  \nI think that maintaining functionality with JBoss in 1.2.X is pretty important.", "attachment_id": null, "bug_id": 31056, "id": 81287, "time": "2005-10-18T04:42:27Z", "creator": "mwomack@apache.org", "creation_time": "2005-10-18T04:42:27Z", "is_private": false}, {"count": 11, "tags": [], "bug_id": 31056, "attachment_id": null, "id": 81398, "time": "2005-10-19T17:52:56Z", "creator": "carnold@apache.org", "creation_time": "2005-10-19T17:52:56Z", "is_private": false, "text": "It should be fairly trivial, but I'm in the process of packing everything up since I have to be moved out on \nFriday 10/21/2005, but I can crank a quick one out in a few minutes.  Do you have a preference of \nfollowReassignment/cacheTarget/etc?\n\nOn a procedural front, I think it is undesirable to have a bug span releases.  I would prefer the do the \nmodification as part of bug 37122."}, {"count": 12, "tags": [], "text": "Fixed in SVN revision 326604 (trunk) and 326599 (v1_2-branch).  Added honorReassignment attribute to \nconfiguration with default value of false (1.2.12 behavior).  Reported as fix to 37122.", "attachment_id": null, "bug_id": 31056, "id": 81400, "time": "2005-10-19T18:45:32Z", "creator": "carnold@apache.org", "creation_time": "2005-10-19T18:45:32Z", "is_private": false}, {"count": 13, "attachment_id": null, "creator": "mwomack@apache.org", "text": "Closing in favor of tracking fix in 37122.", "id": 81404, "time": "2005-10-19T18:58:38Z", "bug_id": 31056, "creation_time": "2005-10-19T18:58:38Z", "tags": [], "is_private": false}, {"count": 14, "tags": [], "bug_id": 31056, "text": "*** Bug 32906 has been marked as a duplicate of this bug. ***", "id": 107070, "time": "2007-08-22T15:44:26Z", "creator": "carnold@apache.org", "creation_time": "2007-08-22T15:44:26Z", "is_private": false, "attachment_id": null}]