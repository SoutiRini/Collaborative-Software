[{"count": 0, "tags": [], "bug_id": 39324, "text": "Hi Nick\n\nIt seems something is wrong with RichTextRun class.\n\nsetBold or setItalic operations corrupt the underlying StyleTextPropAtom.\nTo see the problem run the attached TestShapes.testTextBoxWrite.\n\nThe problems is only with flag values (bold, italic, underline). \nIf I set only font size everything is OK. I save the file, read it again and see\nthe correct font size.\nBut if I call setBold or setItalic things go wrong and after save font\nsize = 0.\n\nI did work in the past. I guess you missed something after when\nrefactored this class lately.\n\nRegards, Yegor Kozlov", "id": 88163, "time": "2006-04-17T15:47:39Z", "creator": "yegor@dinom.ru", "creation_time": "2006-04-17T15:47:39Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 39324, "attachment_id": 18113, "id": 88165, "time": "2006-04-17T15:48:58Z", "creator": "yegor@dinom.ru", "creation_time": "2006-04-17T15:48:58Z", "is_private": false, "text": "Created attachment 18113\ntest case which demonstrates the bug"}, {"count": 2, "tags": [], "text": "Bah. There had been a bug in how the mask textprops wrote themselves out. I\nguess I didn't quite get it right when I tried to fix it :(", "attachment_id": null, "id": 88259, "creator": "apache@gagravarr.org", "time": "2006-04-19T10:00:31Z", "bug_id": 39324, "creation_time": "2006-04-19T10:00:31Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 39324, "attachment_id": null, "id": 88264, "time": "2006-04-19T11:42:21Z", "creator": "apache@gagravarr.org", "creation_time": "2006-04-19T11:42:21Z", "is_private": false, "text": "This is odd. I've just run your test, and it passes just fine for me....\n\nCan you do a svn update, then an ant clean, then try your test again? Quite odd\nthat it passes for me but not for you."}, {"count": 4, "attachment_id": null, "creator": "yegor@dinom.ru", "text": "(In reply to comment #3)\n> This is odd. I've just run your test, and it passes just fine for me....\n> \n> Can you do a svn update, then an ant clean, then try your test again? Quite odd\n> that it passes for me but not for you.\n\nthis is really odd!\nWhen I run tests  in IntelliJ Idea 4.0 I got errors! When I run them by ant they\npass! Probably something is wrong with my IDE. I need to investigate it in details.\n", "id": 88286, "time": "2006-04-19T15:54:54Z", "bug_id": 39324, "creation_time": "2006-04-19T15:54:54Z", "tags": [], "is_private": false}, {"count": 5, "attachment_id": null, "creator": "apache@gagravarr.org", "text": "I've had similar problems with Eclipse, when its idea of where to build class\nfiles to differred from ant's\n\nGlad it's all fixed though :)", "id": 88288, "time": "2006-04-19T16:19:47Z", "bug_id": 39324, "creation_time": "2006-04-19T16:19:47Z", "tags": [], "is_private": false}, {"count": 6, "attachment_id": null, "creator": "yegor@dinom.ru", "text": "Nick,\n\nIt seems the order in which tests are running is important. \n\nComment all tests in TestShapes but testTextBoxWrite, recompile, run and get\nthis error!\n\nIn our case JUnit first runs testTextBoxRead() and then testTextBoxWrite(). It\nlooks like\nthe first test affects the others!\n To make sure I created a standalone program with main() and confirmed that the\nerror exists.\n\nI attached the new test case.\n\nLook at the line 45:\nnew SlideShow(new HSLFSlideShow(filename));\n\nWith this line test succeeds. Comment it and the test fails! \n\nI debugged it a little bit. It seems some static initializes are not set properly.\nWhen test fails Variable subPropMasks in BitMaskTextProp.setSubValue\nis filled with 0, otherwise there are some values.\n\nPlease check it.\n\nYegor\n\n\n", "id": 88316, "time": "2006-04-20T12:42:25Z", "bug_id": 39324, "creation_time": "2006-04-20T12:42:25Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": 18146, "text": "Created attachment 18146\nTest which confirms that the problem exists\n\nForgot to mention:\n It fails in both cases: under Ant and in IntelliJ Idea.", "id": 88317, "time": "2006-04-20T12:44:36Z", "bug_id": 39324, "creation_time": "2006-04-20T12:44:36Z", "is_private": false}, {"count": 8, "attachment_id": null, "creator": "apache@gagravarr.org", "text": "Oww oww, this bug hurts my head....\n\nYou weren't resetting sl after the load, which wasn't helping. However, I've now\ngot my hands on the real data that gets written out for the StyleTextPropAtom,\nnow to figure out why it's not correct!", "id": 88351, "time": "2006-04-21T11:33:56Z", "bug_id": 39324, "creation_time": "2006-04-21T11:33:56Z", "tags": [], "is_private": false}, {"count": 9, "tags": [], "bug_id": 39324, "text": "OK, I've found two bugs (and a fault in the test....)\n\nFirstly, there was a bug with the flag type TextProps, when created from\nscratch, which was biting us. This should be fixed, and should allow everything\nto behave properly. Due to a clone, we were seeing different behaviour on the\nfirst call\n\nThen, there was the bug in the test (which has been committed, working)\n\nFinally, after adding new TextBoxes, they weren't being registered with the\nPPDrawing, so they weren't always being correctly updated on write out. That's\nbeen fixed.\n\nHopefully it now all works :)", "id": 88353, "time": "2006-04-21T13:47:08Z", "creator": "apache@gagravarr.org", "creation_time": "2006-04-21T13:47:08Z", "is_private": false, "attachment_id": null}]