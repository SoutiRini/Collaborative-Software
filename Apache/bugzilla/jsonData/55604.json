[{"attachment_id": 30890, "tags": [], "bug_id": 55604, "text": "Created attachment 30890\nPatch with fix about SprmBuffer problem\n\nWe had a issue when we tried to get the body content of a MS Word 97 file. We got this exception:\n\n.\n.\n\nCaused by: java.lang.ArrayIndexOutOfBoundsException\nat java.lang.System.arraycopy(Native Method)\nat org.apache.poi.hwpf.sprm.SprmBuffer.append(SprmBuffer.java:128)\nat org.apache.poi.hwpf.model.PAPBinTable.rebuild(PAPBinTable.java:293)\nat org.apache.poi.hwpf.model.PAPBinTable.rebuild(PAPBinTable.java:116)\nat org.apache.poi.hwpf.HWPFOldDocument.<init>(HWPFOldDocument.java:136)\nat org.apache.tika.parser.microsoft.WordExtractor.parseWord6(WordExtractor.java:437)\nat org.apache.tika.parser.microsoft.WordExtractor.parse(WordExtractor.java:79)\nat org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:186)\nat org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:161)\nat org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)\n... 15 more \n\nso We did a fix to avoid that exception, I am attaching a patch file with the fix.\n\nRegards", "count": 0, "id": 170315, "time": "2013-09-27T17:35:23Z", "creator": "wsolaligue@gmail.com", "creation_time": "2013-09-27T17:35:23Z", "is_private": false}, {"count": 1, "tags": [], "text": "Additionally, we tried again using POI 3.9, but it couldn't solve the issue.", "is_private": false, "id": 170316, "creator": "wsolaligue@gmail.com", "time": "2013-09-27T17:41:05Z", "bug_id": 55604, "creation_time": "2013-09-27T17:41:05Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 55604, "attachment_id": null, "text": "Closing this as there was no update for a very long time and the attached patch just catches and completely ignores any Exception thrown at this code-location. This is surely not a fix, not even a workaround, but a rough hack that might hide any type of problem at that point. \n\nPlease reopen this bug if this is still a problem for you and you can provide a fix that can be applied to the library.", "id": 192442, "time": "2016-07-17T09:44:00Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-07-17T09:44:00Z", "is_private": false}, {"count": 3, "tags": [], "creator": "sevaa@sprynet.com", "is_private": false, "text": "Same problem here, surfaced via Tika. The following file reproduces the behavior:\n\nhttps://dl.dropboxusercontent.com/u/92341073/Message%20to%20Eric%20Spooner.doc\n\nTika issue here: https://issues.apache.org/jira/browse/TIKA-2119", "id": 194444, "time": "2016-10-15T02:19:05Z", "bug_id": 55604, "creation_time": "2016-10-15T02:19:05Z", "attachment_id": null}]