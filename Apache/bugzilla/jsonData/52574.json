[{"count": 0, "tags": [], "creator": "gjungman@utilinc.com", "text": "The below code works in Excel 2007 (XSSF) but not in 2003 (HSSF).  Excel 2003 has header and footer margins.\n\nCode:\n        sheet.setMargin(Sheet.HeaderMargin, headerMargin);\n        sheet.setMargin(Sheet.FooterMargin, footerMargin);\n\nError Stack Trace:\n\n\njava.lang.IllegalArgumentException: Unknown margin constant:  4\n\n        at org.apache.poi.hssf.record.aggregates.PageSettingsBlock.getMarginRec(\n\nPageSettingsBlock.java:413)\n\n        at org.apache.poi.hssf.record.aggregates.PageSettingsBlock.setMargin(Pag\n\neSettingsBlock.java:442)\n\n        at org.apache.poi.hssf.usermodel.HSSFSheet.setMargin(HSSFSheet.java:1072\n\n)\n\n        at com.utilinc.planner.b2.b2ii.B2iiToExcel.toExcel(B2iiToExcel.java:1491", "id": 153346, "time": "2012-02-01T18:33:44Z", "bug_id": 52574, "creation_time": "2012-02-01T18:33:44Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 52574, "text": "Fixed in r1294181\n\nActually you could set header/footer margins in HSSF, but in a different manner:\n\n        sheet.getPrintSetup().setFooterMargin(margin);\nand\n        sheet.getPrintSetup().setHeaderMargin(margin);\n\nNow setMargin correctly handles all types, the same behavior as in XSSF.\n\nYegor", "id": 154287, "attachment_id": null, "creator": "yegor@dinom.ru", "creation_time": "2012-02-27T15:34:11Z", "time": "2012-02-27T15:34:11Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 52574, "text": "Thanks!!!!", "id": 154288, "attachment_id": null, "creator": "gjungman@utilinc.com", "creation_time": "2012-02-27T17:10:47Z", "time": "2012-02-27T17:10:47Z", "is_private": false}]