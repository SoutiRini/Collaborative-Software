[{"count": 0, "tags": [], "bug_id": 38451, "attachment_id": null, "is_private": false, "id": 85203, "time": "2006-01-30T17:27:30Z", "creator": "f.zeyda@tees.ac.uk", "creation_time": "2006-01-30T17:27:30Z", "text": "When using the html option the antlr task doesn't recognised whether the target \nis up-to-date and thus executes superfluous compilations.\n\nI have tracked down the bug to some extend in the source code, in essence the \nproblem is that the method getGeneratedFile() in class \norg.apache.ant.taskdefs.optional.ANTLR (line 348) only deduces the output File \ncorrectly if the generated file is a \".java\" file (which is not the case if the \nhtml option is specified). A fix to the particular problem is to replace line \n367:\n\nreturn new File(outputDirectory, generatedFileName + \".java\");\n--------------------------------------------------------------\n\nwith\n\nreturn new File(outputDirectory, generatedFileName + (html ? \".html\" : \".java\");\n--------------------------------------------------------------------------------\n\nin file ANTLR.java (directory src/main/org/apache/tools/ant/taskdefs/optional/)\n\nMoreover it might be desirable to investigate more thoroughly what types of \noutput files antlr can produce and under what conditions, and make sure their \nname is always guessed correctly in the getGeneratedFile() method.\n\nFrank Zeyda"}, {"count": 1, "tags": [], "bug_id": 38451, "attachment_id": null, "id": 85204, "time": "2006-01-30T17:30:19Z", "creator": "f.zeyda@tees.ac.uk", "creation_time": "2006-01-30T17:30:19Z", "is_private": false, "text": "When using the html option the antlr task doesn't recognised whether the target \nis up-to-date and thus executes superfluous compilations.\n\nI have tracked down the bug to some extend in the source code, in essence the \nproblem is that the method getGeneratedFile() in class \norg.apache.ant.taskdefs.optional.ANTLR (line 348) only deduces the output File \ncorrectly if the generated file is a \".java\" file (which is not the case if the \nhtml option is specified). A fix to the particular problem is to replace line \n367:\n\nreturn new File(outputDirectory, generatedFileName + \".java\");\n\nwith\n\nreturn new File(outputDirectory, generatedFileName + (html ? \".html\" : \".java\");\n\nin file ANTLR.java (directory src/main/org/apache/tools/ant/taskdefs/optional/)\n\nMoreover it might be desirable to investigate more thoroughly what types of \noutput files antlr can produce under what conditions, and make sure their name \nis always guessed correctly in the getGeneratedFile() method."}, {"count": 2, "tags": [], "bug_id": 38451, "is_private": false, "id": 85209, "attachment_id": null, "creator": "mbenson@apache.org", "creation_time": "2006-01-30T18:58:36Z", "time": "2006-01-30T18:58:36Z", "text": "This patch sounds reasonable... re investigation of the task's overall\ncorrectness, my personal opinion is that the task is overall very \"loose\" i.e. I\ncan't show you particular holes but it feels like they're everywhere.  Know that\nthere is some talk of a rewritten task to be hosted at antlr.org.  But since\nTerence is an XML opponent he's never had much personal investment in Ant.  :)"}, {"count": 3, "tags": [], "bug_id": 38451, "attachment_id": null, "id": 93365, "time": "2006-09-11T21:06:19Z", "creator": "peterreilly@apache.org", "creation_time": "2006-09-11T21:06:19Z", "is_private": false, "text": "Fixed in SVN, Thanks for the report."}]