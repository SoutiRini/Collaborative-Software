[{"count": 0, "tags": [], "bug_id": 61298, "text": "Code that worked in v3.15 doesn't work with v3.16 and v3.17beta. At runtime, I get an exception for\n\nnew PropertySet(dis)\n\nException in thread \"main\" java.lang.NoClassDefFoundError: org/apache/commons/collections4/bidimap/TreeBidiMap\n\tat org.apache.poi.hpsf.Section.<init>(Section.java:178)\n\tat org.apache.poi.hpsf.MutableSection.<init>(MutableSection.java:41)\n\tat org.apache.poi.hpsf.PropertySet.init(PropertySet.java:494)\n\tat org.apache.poi.hpsf.PropertySet.<init>(PropertySet.java:196)\n\tat documents.WordDoc.getDocMetadata(WordDoc.java:626)\n\tat documents.WordDoc.<init>(WordDoc.java:89)\n\tat documents.Scan.rhapsodyCheckFile(Scan.java:205)\n\tat documents.Scan.rhapsodyCheckFile(Scan.java:153)\n\tat documents.Scan.checkFile(Scan.java:625)\n\tat rhapsody.Overnight.checkFilesForFolder(Overnight.java:158)\n\tat documents.Scan.main(Scan.java:830)\nCaused by: java.lang.ClassNotFoundException: org.apache.commons.collections4.bidimap.TreeBidiMap\n\tat java.net.URLClassLoader$1.run(URLClassLoader.java:202)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:190)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:307)\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:248)\n\t... 11 more\n\n  public WordDoc(File file) throws IOException {\n    try {\n      try {\n        hdoc = new HWPFDocument(new FileInputStream(file));\n        getDocMetadata(file);\n// snip\n      } catch (IllegalArgumentException ex) {\n        if (!ex.getMessage().contains(\"Office 2007+ XML\")) {\n          Scan.reportError(0, file.getPath(), null, null, null, null, null, null, ex.getMessage(), null, null);\n          throw new IOException();\n        }\n  }\n\n  private void getDocMetadata(File file) throws IOException {\n    POIFSFileSystem poifs = new POIFSFileSystem(new FileInputStream(file));\n    DirectoryEntry dir = poifs.getRoot();\n    DocumentEntry siEntry = (DocumentEntry) dir.getEntry(SummaryInformation.DEFAULT_STREAM_NAME);\n    DocumentInputStream dis = new DocumentInputStream(siEntry);\n    try {\n      SummaryInformation si = new SummaryInformation(new PropertySet(dis));\n// snip\n    } catch (UnexpectedPropertySetTypeException ex) {\n    } catch (NoPropertySetStreamException ex) {\n    } catch (MarkUnsupportedException ex) {\n    } catch (UnsupportedEncodingException ex) {\n    }\n  }", "id": 199783, "time": "2017-07-14T00:37:08Z", "creator": "drifter.frank@gmail.com", "creation_time": "2017-07-14T00:37:08Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "onealj@apache.org", "attachment_id": null, "is_private": false, "id": 199784, "time": "2017-07-14T00:43:56Z", "bug_id": 61298, "creation_time": "2017-07-14T00:43:56Z", "text": "Note that Apache Commons Collection was added as a dependency recently.\n\nIn the changelog for POI 3.16 beta 2:\nhttps://poi.apache.org/changes.html#3.16-beta2\n\nDocumented as a dependency for the poi.jar artifact:\nhttps://poi.apache.org/overview.html#components"}]