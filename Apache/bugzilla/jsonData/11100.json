[{"text": "With the following scenario:\n\n<untar src=\"test/test.tar.gz\" compression=\"gzip\" dest=\"test\">\n  <patternset>\n    <exclude name=\"**/*.class\" />\n  </patternset>\n</untar>\n\nNo files are extracted.  To obtain the desired behavior, I must add a nested \n<include>:\n\n<untar src=\"test/test.tar.gz\" compression=\"gzip\" dest=\"test\">\n  <patternset>\n    <include name=\"**/**\" />\n    <exclude name=\"**/*.class\" />\n  </patternset>\n</untar>\n\nThe problem appears to be in Expand.extractFile().  Looks to me as though the \nsimplest fix would be change the first part of the method to something like \nthis:\n\nif (patternsets != null && patternsets.size() > 0) {\n  String name = entryName;\n  boolean included;\n  for (int v = 0; v < patternsets.size(); v++) {\n    included = true;\n    PatternSet p = (PatternSet) patternsets.elementAt(v);\n    String[] incls = p.getIncludePatterns(project);\n    if (incls != null) {\n      for (int w = 0; w < incls.length; w++) {\n        included = DirectoryScanner.match(incls[w], name);\n        if (included) break;\n      }\n    }\n    String[] excls = p.getExcludePatterns(project);\n    if (excls != null) {\n      for (int w = 0; w < excls.length; w++) {\n        included = !(DirectoryScanner.match(excls[w], name));\n        if (!included) break;\n      }\n    }\n  }\n  if (!included) {\n    //Do not process this file\n    return;\n  }\n}", "tags": [], "bug_id": 11100, "is_private": false, "count": 0, "id": 20080, "time": "2002-07-23T20:37:29Z", "creator": "mbenson@apache.org", "creation_time": "2002-07-23T20:37:29Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "umagesh@apache.org", "attachment_id": null, "id": 26747, "time": "2002-11-21T22:18:47Z", "bug_id": 11100, "creation_time": "2002-11-21T22:18:47Z", "is_private": false, "text": "Changes made in cvs.  Thanks!\n\nPlease supply patches using cvs diff -u in the future.\n\n"}, {"count": 2, "tags": [], "bug_id": 11100, "attachment_id": null, "is_private": false, "id": 30831, "time": "2003-02-06T17:25:05Z", "creator": "bodewig@apache.org", "creation_time": "2003-02-06T17:25:05Z", "text": "*** Bug 16529 has been marked as a duplicate of this bug. ***"}]