[{"count": 0, "tags": [], "bug_id": 56683, "attachment_id": null, "is_private": false, "id": 176116, "time": "2014-06-30T11:47:02Z", "creator": "ranju4u6@gmail.com", "creation_time": "2014-06-30T11:47:02Z", "text": "I am trying to execute a program in z/OS machine to write an Excel report. Due to size of the report, we are using SXSSFWorkbook to write the report.\n\nOne of the cells in the report is grey in color. So I have to apply Color to that cell. I used the following code to set the color.\n\nXSSFCellStyle cellStyle = (XSSFCellStyle) wb.createCellStyle();\nXSSFColor myColor = new XSSFColor(DatatypeConverter\n        .parseHexBinary(\"FFBFBFBF\")); //also tried the java.awt.Color\ncellStyle.setFillForegroundColor(myColor);\ncellStyle.setFillPattern(CellStyle.SOLID_FOREGROUND);\ncell.setCellStyle(cellStyle);\n\nBut for the report generated, this cell is dark in color. Out of curiosity, I checked the Styles.xml inside the Excel document. The following is what I found.\n\n<fill><patternFill patternType=\"solid\"><fgColor rgb=\"\u00e3\u00e3\u00e2\u00e3\u00e2\u00e3\u00e2\u00e3\"/></patternFill></fill>\nI tried to generate the same report in a Windows machine, and it gave me correct result.\n\n<fill><patternFill patternType=\"solid\"><fgColor rgb=\"FFBFBFBF\"/></patternFill>"}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 176118, "time": "2014-06-30T12:30:57Z", "bug_id": 56683, "creation_time": "2014-06-30T12:30:57Z", "is_private": false, "text": "The bad news is that this looks like it might be an xmlbeans bug\n\nAny chance you could add the xmlbeans generated source to your IDE, then step into the CTColor code in a debugger and see how it serialises the bytes into xml?\n\nSee http://poi.apache.org/faq.html#faq-N1012A for help on getting the source of the CT classes"}, {"count": 2, "tags": [], "creator": "ranju4u6@gmail.com", "text": "Not sure if the following update will fix it. need to try it out.\n\nUpdated writeTo() method of 'org.apache.poi.xssf.model.StylesTable'.\n\nChange: Added the following line \n\n             'DEFAULT_XML_OPTIONS.setCharacterEncoding(\"UTF-8\");'\n\n\n\t/**\n\t * Write this table out as XML.\n\t *\n\t * @param out The stream to write to.\n\t * @throws IOException if an error occurs while writing.\n\t */\n\tpublic void writeTo(OutputStream out) throws IOException {\n\t    //Setting default encoding to UTF-8\n\t    DEFAULT_XML_OPTIONS.setCharacterEncoding(\"UTF-8\");\n\t    \n\t\tXmlOptions options = new XmlOptions(DEFAULT_XML_OPTIONS);\n\nSince i dont have control over the z/os server, i have to wait till it get tested.\nIn the mean time, please let me know your thoughts on the same.", "id": 176418, "time": "2014-07-16T12:15:46Z", "bug_id": 56683, "creation_time": "2014-07-16T12:15:46Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "Default of UTF-8 set in r1613193.", "is_private": false, "bug_id": 56683, "id": 176670, "time": "2014-07-24T17:15:05Z", "creator": "apache@gagravarr.org", "creation_time": "2014-07-24T17:15:05Z", "attachment_id": null}]