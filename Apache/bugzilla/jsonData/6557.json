[{"count": 0, "tags": [], "bug_id": 6557, "attachment_id": null, "text": "when i post a requst by calling NPN_PostURLNotify(), ns plug-in api. \niis_redirect could not forward the request to tomcat\nthe problem i addressed was ns4.7x sends the request in seperate steps, eg.\n  1. send the http request header\n  2. send an 0x0d\n  3. send an 0x0a\n  4. send the request body\nbut iis_redirect only forward the first pieces, and tomcat will not get any \nrequest body data\n\nlooking for a fix for this issue", "id": 10922, "time": "2002-02-19T18:26:06Z", "creator": "shao@infraworks.com", "creation_time": "2002-02-19T18:26:06Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 6557, "text": "well, it was a netscape 4.7 issue. but the apache addon module of tomcat can \nhandle such case. i think the isapi_redirect should do so, right?", "id": 10925, "time": "2002-02-19T20:18:18Z", "creator": "shao@infraworks.com", "creation_time": "2002-02-19T20:18:18Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 6557, "text": "i changed the priority to high because iis nt service can not be stopped after \nsuch a 'post'\n", "id": 10927, "time": "2002-02-19T20:35:57Z", "creator": "shao@infraworks.com", "creation_time": "2002-02-19T20:35:57Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 6557, "text": "Created attachment 1222\ndump of data thru http", "id": 11031, "time": "2002-02-21T16:19:57Z", "creator": "shao@infraworks.com", "creation_time": "2002-02-21T16:19:57Z", "is_private": false, "attachment_id": 1222}, {"count": 4, "tags": [], "bug_id": 6557, "attachment_id": null, "id": 11033, "time": "2002-02-21T16:22:51Z", "creator": "shao@infraworks.com", "creation_time": "2002-02-21T16:22:51Z", "is_private": false, "text": "why does nobody response?????"}, {"count": 5, "tags": [], "bug_id": 6557, "text": "Changing it back to Tomcat3 since the data supplied is for Tomcat 3.3.\n\nBased on your attached data, please try Ajp13 and see if the problem is still\npresent there.  Ajp12 is deprecated in Tomcat 3.3 (i.e. bugs aren't likely to\nbe fixed) and isn't supported at all in Tomcat 4.x.\n", "id": 11047, "time": "2002-02-21T17:43:55Z", "creator": "Larry.Isaacs@sas.com", "creation_time": "2002-02-21T17:43:55Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 6557, "attachment_id": null, "id": 11137, "time": "2002-02-25T20:30:12Z", "creator": "shao@infraworks.com", "creation_time": "2002-02-25T20:30:12Z", "is_private": false, "text": "i tried ajp13 for both tomcat3 and tomcat4. it seems worse, even ie can not \nconnect to my servlet by calling both URLOpenStream()(an ie activex api) and \nNPN_PostURLNotify() (netscape plug api), which works fine with apache+tomcat.\ni send http requst with binary data in the body:\n\n000000  POST /InTether/s  50 4f 53 54 20 2f 49 6e  54 65 74 68 65 72 2f 73  \n000016  ervlet/FileExcha  65 72 76 6c 65 74 2f 46  69 6c 65 45 78 63 68 61  \n000032  ngeServer HTTP/1  6e 67 65 53 65 72 76 65  72 20 48 54 54 50 2f 31  \n000048  .1..Accept: */*.  2e 31 0d 0a 41 63 63 65  70 74 3a 20 2a 2f 2a 0d  \n000064  .Accept-Encoding  0a 41 63 63 65 70 74 2d  45 6e 63 6f 64 69 6e 67  \n000080  : gzip, deflate.  3a 20 67 7a 69 70 2c 20  64 65 66 6c 61 74 65 0d  \n000096  .User-Agent: Moz  0a 55 73 65 72 2d 41 67  65 6e 74 3a 20 4d 6f 7a  \n000112  illa/4.0 (compat  69 6c 6c 61 2f 34 2e 30  20 28 63 6f 6d 70 61 74  \n000128  ible; MSIE 6.0;   69 62 6c 65 3b 20 4d 53  49 45 20 36 2e 30 3b 20  \n000144  Windows NT 5.0;   57 69 6e 64 6f 77 73 20  4e 54 20 35 2e 30 3b 20  \n000160  InTetherAgent 0.  49 6e 54 65 74 68 65 72  41 67 65 6e 74 20 30 2e  \n000176  1/443e9c3c-7bb4-  31 2f 34 34 33 65 39 63  33 63 2d 37 62 62 34 2d  \n000192  4be8-9f79-656e21  34 62 65 38 2d 39 66 37  39 2d 36 35 36 65 32 31  \n000208  fff6f1)..Host: l  66 66 66 36 66 31 29 0d  0a 48 6f 73 74 3a 20 6c  \n000224  ocalhost:90..Con  6f 63 61 6c 68 6f 73 74  3a 39 30 0d 0a 43 6f 6e  \n000240  tent-Length: 4..  74 65 6e 74 2d 4c 65 6e  67 74 68 3a 20 34 0d 0a  \n000256  Connection: Keep  43 6f 6e 6e 65 63 74 69  6f 6e 3a 20 4b 65 65 70  \n000272  -Alive..Cache-Co  2d 41 6c 69 76 65 0d 0a  43 61 63 68 65 2d 43 6f  \n000288  ntrol: no-cache.  6e 74 72 6f 6c 3a 20 6e  6f 2d 63 61 63 68 65 0d  \n000304  .Cookie: JSESSIO  0a 43 6f 6f 6b 69 65 3a  20 4a 53 45 53 53 49 4f  \n000320  NID=97E25BFA89BD  4e 49 44 3d 39 37 45 32  35 42 46 41 38 39 42 44  \n000336  9B94AE94A9C65B8F  39 42 39 34 41 45 39 34  41 39 43 36 35 42 38 46  \n000352  0660........      30 36 36 30 0d 0a 0d 0a  ff ff ff ff \n\nbut i caught exception in servlet:\n\ninternal Server Error description server encountered an internal error \n(Internal Server Error) that prevented it from fulfilling this request\n\nand then IOException once i read from the request body\n\nthe following are the log message from isapi.log:\n\n[Mon Feb 25 14:25:43 2002]  [jk_isapi_plugin.c (657)]: HttpFilterProc started\n[Mon Feb 25 14:25:43 2002]  [jk_isapi_plugin.c (705)]: In HttpFilterProc \nVirtual Host redirection of /localhost:90/InTether/servlet/FileExchangeServer\n[Mon Feb 25 14:25:43 2002]  [jk_uri_worker_map.c (447)]: Into \njk_uri_worker_map_t::map_uri_to_worker\n[Mon Feb 25 14:25:43 2002]  [jk_uri_worker_map.c (464)]: Attempting to map \nURI '/localhost:90/InTether/servlet/FileExchangeServer'\n[Mon Feb 25 14:25:43 2002]  [jk_uri_worker_map.c (570)]: \njk_uri_worker_map_t::map_uri_to_worker, done without a match\n[Mon Feb 25 14:25:43 2002]  [jk_isapi_plugin.c (711)]: In HttpFilterProc test \nDefault redirection of /InTether/servlet/FileExchangeServer\n[Mon Feb 25 14:25:43 2002]  [jk_uri_worker_map.c (447)]: Into \njk_uri_worker_map_t::map_uri_to_worker\n[Mon Feb 25 14:25:43 2002]  [jk_uri_worker_map.c (464)]: Attempting to map \nURI '/InTether/servlet/FileExchangeServer'\n[Mon Feb 25 14:25:43 2002]  [jk_uri_worker_map.c (489)]: \njk_uri_worker_map_t::map_uri_to_worker, Found a context match ajp13 -\n> /InTether/\n[Mon Feb 25 14:25:43 2002]  [jk_isapi_plugin.c (721)]: HttpFilterProc \n[/InTether/servlet/FileExchangeServer] is a servlet url - should redirect to \najp13\n[Mon Feb 25 14:25:43 2002]  [jk_isapi_plugin.c (784)]: HttpFilterProc check if \n[/InTether/servlet/FileExchangeServer] is points to the web-inf directory\n[Mon Feb 25 14:25:43 2002]  [jk_isapi_plugin.c (824)]: HttpExtensionProc started\n[Mon Feb 25 14:25:43 2002]  [jk_worker.c (132)]: Into wc_get_worker_for_name \najp13\n[Mon Feb 25 14:25:43 2002]  [jk_worker.c (136)]: wc_get_worker_for_name, done  \nfound a worker\n[Mon Feb 25 14:25:43 2002]  [jk_isapi_plugin.c (860)]: HttpExtensionProc got a \nworker for name ajp13\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (1352)]: Into \njk_worker_t::get_endpoint\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (1075)]: Into \njk_endpoint_t::service\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (280)]: Into ajp_marshal_into_msgb\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (413)]: ajp_marshal_into_msgb - \nDone\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (612)]: sending to ajp13 #362\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (853)]: ajp_send_request 2: \nrequest body to send 4 - request body to resend 0\n[Mon Feb 25 14:25:43 2002]  [jk_isapi_plugin.c (510)]: Into \njk_ws_service_t::read\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (612)]: sending to ajp13 #10\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (698)]: received from ajp13 #3\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (612)]: sending to ajp13 #4\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (698)]: received from ajp13 #3\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (612)]: sending to ajp13 #4\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (698)]: received from ajp13 #3\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (612)]: sending to ajp13 #4\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (698)]: received from ajp13 #3\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (612)]: sending to ajp13 #4\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (698)]: received from ajp13 #3\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (612)]: sending to ajp13 #4\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (698)]: received from ajp13 #29\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (461)]: ajp_unmarshal_response: \nstatus = 500\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (466)]: ajp_unmarshal_response: \nNumber of headers is = 0\n[Mon Feb 25 14:25:43 2002]  [jk_isapi_plugin.c (428)]: Into \njk_ws_service_t::start_response\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (698)]: received from ajp13 #1028\n[Mon Feb 25 14:25:43 2002]  [jk_isapi_plugin.c (562)]: Into \njk_ws_service_t::write\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (698)]: received from ajp13 #1028\n[Mon Feb 25 14:25:43 2002]  [jk_isapi_plugin.c (562)]: Into \njk_ws_service_t::write\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (698)]: received from ajp13 #1028\n[Mon Feb 25 14:25:43 2002]  [jk_isapi_plugin.c (562)]: Into \njk_ws_service_t::write\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (698)]: received from ajp13 #155\n[Mon Feb 25 14:25:43 2002]  [jk_isapi_plugin.c (562)]: Into \njk_ws_service_t::write\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (698)]: received from ajp13 #2\n[Mon Feb 25 14:25:43 2002]  [jk_isapi_plugin.c (872)]: HttpExtensionProc service\n() returned OK\n[Mon Feb 25 14:25:43 2002]  [jk_ajp_common.c (1307)]: Into jk_endpoint_t::done\n"}, {"count": 7, "tags": [], "creator": "Larry.Isaacs@sas.com", "text": "I regret not having the time to look more into this, and need to LATER this\none relative to Tomcat 3.3.1.  I will try to address this in\njakarta-tomcat-connectors.  A test case that we can use to duplicate the\nproblem would be helpful.\n\n", "id": 12034, "attachment_id": null, "bug_id": 6557, "creation_time": "2002-03-20T00:21:16Z", "time": "2002-03-20T00:21:16Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 6557, "text": "this issue seems based on the description on http/1.0\nHTTP/1.0 can send \"a large amount\" of body data by doing a TCP reset, which \nmeans there are two or more tcp connections will be made. but http/1.1 allows \nto send the body data with the header which just like that in the case i posted.\nthe redirector should not always expect for another tcp connection for the body \ndata", "id": 13700, "time": "2002-04-15T22:25:57Z", "creator": "shao@infraworks.com", "creation_time": "2002-04-15T22:25:57Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 6557, "attachment_id": null, "text": "Test case:\nthe attachment is a ns4.x plugin. The npbasix.dll has to be copied into the \nsubdir \"Plugins\" under ns installation, check \"help->about plugins\" on ns to \nmake sure if it is ready:\napplication/x-basix-plugin          Basic Plugin\n \ntest.html is an example to launch the plugin when the html gets loaded. the \nplugin has two paramters:\nsurl is the servlet url that the plugin try to connect \nvalue is a integer value that the plugin try to send to the servlet\nOn the servlet side, the following code can be a test case:\nimport javax.servlet.*;\nimport javax.servlet.http.*;\nimport java.io.*;\nimport java.util.*;\nimport java.net.*;\n \npublic class testserv extends HttpServlet\n{\n static final int value_expected = -1;\n \n public void service(HttpServletRequest req, HttpServletResponse resp)\n  throws ServletException, java.io.IOException\n    {\n  ServletInputStream sis=req.getInputStream();\n  DataInput in = new DataInputStream(sis);\n \n  if (value_expected ==  in.readInt())\n  {\n   // bingo!!!\n  }\n  else\n  {\n   // oops\n  }\n }\n  \n public void init(ServletConfig servletConfig) throws ServletException\n    {\n  super.init(servletConfig);\n }\n}\n\nlet me suppose the servlet url is http://localhost:8080/test/testserv. edit \ntest.html and set surl=\"http://localhost:8080/test/testserv\". after that, open \ntest.html either from window explorer or from the tomcat, the standalone tomcat \ncan get into the \"bingo\".\nbut use ispai_redirector with iis, suppose the url is \nhttp://localhost:80/test/testserv now, tomcat throw EOFexception \nwhen \"in.readInt()\" gets called, there are no data in the stream at all.\n \n", "id": 17946, "time": "2002-06-17T23:20:16Z", "creator": "shao@infraworks.com", "creation_time": "2002-06-17T23:20:16Z", "is_private": false}, {"count": 10, "tags": [], "bug_id": 6557, "text": "Created attachment 2111\ntest case", "id": 17949, "time": "2002-06-17T23:23:51Z", "creator": "shao@infraworks.com", "creation_time": "2002-06-17T23:23:51Z", "is_private": false, "attachment_id": 2111}]