[{"count": 0, "tags": [], "bug_id": 42722, "attachment_id": null, "is_private": false, "id": 104629, "time": "2007-06-22T05:21:27Z", "creator": "m4341@abc.se", "creation_time": "2007-06-22T05:21:27Z", "text": "There is a potential NPE in CGIServlet, even if it's unlikely it may happen.\n\nThe following patch resolves this problem:\n\nIndex:\nF:/Workspace/Apache2/tomcat6/java/org/apache/catalina/servlets/CGIServlet.java\n===================================================================\n---\nF:/Workspace/Apache2/tomcat6/java/org/apache/catalina/servlets/CGIServlet.java\n(revision 548385)\n+++\nF:/Workspace/Apache2/tomcat6/java/org/apache/catalina/servlets/CGIServlet.java\n(working copy)\n@@ -1631,7 +1631,6 @@\n              * with major modifications by Martin Dengler\n              */\n             Runtime rt = null;\n-            InputStream cgiOutput = null;\n             BufferedReader commandsStdErr = null;\n             BufferedOutputStream commandsStdIn = null;\n             Process proc = null;\n@@ -1700,7 +1699,9 @@\n                     new HTTPHeaderInputStream(proc.getInputStream());\n                 BufferedReader cgiHeaderReader =\n                     new BufferedReader(new InputStreamReader(cgiHeaderStream));\n-            \n+\n+                InputStream cgiOutput = null;\n+\n                 while (isRunning) {\n                     try {\n                         //set headers\n@@ -1763,7 +1764,10 @@\n                 } //replacement for Process.waitFor()\n     \n                 // Close the output stream used\n-                cgiOutput.close();\n+                if (cgiOutput != null)\n+                {\n+                    cgiOutput.close();\n+                }\n             }\n             catch (IOException e){\n                 log (\"Caught exception \" + e);"}, {"count": 1, "attachment_id": null, "bug_id": 42722, "is_private": false, "id": 118498, "time": "2008-07-10T14:21:00Z", "creator": "markt@apache.org", "creation_time": "2008-07-10T14:21:00Z", "tags": [], "text": "Thanks for the patch. A version of it has been applied to trunk and proposed for 6.0.x"}, {"count": 2, "tags": [], "bug_id": 42722, "attachment_id": null, "id": 118499, "time": "2008-07-10T14:33:51Z", "creator": "wrowe@apache.org", "creation_time": "2008-07-10T14:33:51Z", "is_private": false, "text": "As Mark points out, this is a JAVA bug.  It's contingent on the Sun Java instsller\nto provide msvcr71.\n\nThis is *NOT* a system library (msvcrt.dll is).  In fact MS expects everyone who\nconsumes it to install it privately, which is why it's flagged as a redist.\n\nPlease, don't waste your time and ours by reopening."}, {"count": 3, "tags": [], "creator": "markt@apache.org", "is_private": false, "text": "Wrong bug Bill.", "id": 118500, "time": "2008-07-10T14:46:25Z", "bug_id": 42722, "creation_time": "2008-07-10T14:46:25Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 42722, "attachment_id": null, "id": 118501, "time": "2008-07-10T14:48:23Z", "creator": "wrowe@apache.org", "creation_time": "2008-07-10T14:48:23Z", "is_private": false, "text": "Glad this was reopened, and entirely unsure of what bugzilla or firefox just did to me :)\n\nThanks again Nils for this fix "}, {"count": 5, "tags": [], "bug_id": 42722, "attachment_id": null, "id": 121309, "time": "2008-10-08T06:57:38Z", "creator": "markt@apache.org", "creation_time": "2008-10-08T06:57:38Z", "is_private": false, "text": "This has been fixed in 6.0.x and is included in 6.0.18 onwards"}]