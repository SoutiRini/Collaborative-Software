[{"count": 0, "tags": [], "creator": "almighty@atlantis.wh2.tu-dresden.de", "attachment_id": null, "id": 31029, "time": "2003-02-10T18:27:19Z", "bug_id": 16937, "creation_time": "2003-02-10T18:27:19Z", "is_private": false, "text": "Hi all, \n \nI have just tried out md5 digest authentication and ran into a problem. Using Mozilla or \nInternet Explorer I was successful to log into the site, however using Opera (6.0.x or \n7.0) or Konqueror I was not. Konqui just said login had failed, Opera claimed it had \ndenied to send username and password since the domain of the auth requirement \ndidn't match the URL I had requested for (This was not the exact message but really \ncomes quite close).  \n \nFollowing there is the section from httpd.conf regarding the (to be) password \nprotected area: \n \n  Alias /intern d:/stuff/htdocs \n  <Directory \"d:/stuff/htdocs/milestone2/jBOSSstuff/en\"> \n    AuthType Digest \n    AuthName \"testingDgst\" \n    AuthDigestFile d:/Programme/Apache-1.3.27/conf/digest.pwd \n    Require user onlyme \n  </Directory> \n \nThis is the URL to be requested: \n/intern/milestone2/jBOSSstuff/en/index.html \n \nAs you can see - this is a Windows machine (NT in my case). From Konqueror's debug \noutput I could read the following (mind the domain): \n... \n\"HTTP/1.1 401 Authorization Required\" \n\"Date: Mon, 10 Feb 2003 16:47:24 GMT\" \n\"Server: Apache/1.3.27 (Win32) PHP/4.0.5\" \n\"WWW-Authenticate: Digest realm=\"testingDgst\", nonce=\"...\", algorithm=MD5, \ndomain=\"d:/stuff/htdocs/milestone2/jBOSSstuff/en\", qop=\"auth\"\" \n... \n \nAs you can see, Apache exposes the file system path of the protected directory. Of \ncourse it doesn't match the URL one requests when clicking on a link, so I understand \nwhy Opera complains. Besides I do not really want filesystem paths to be visible \noutside. \nIf I use the following configuration in httpd.conf everything works fine: \n \n  Alias /intern d:/stuff/htdocs \n  <Location \"/intern/milestone2/jBOSSstuff/en\"> \n    AuthType Digest \n    AuthName \"testingDgst\" \n    AuthDigestFile d:/Programme/Apache-1.3.27/conf/digest.pwd \n    Require user onlyme \n  </Location> \n \nKonqueror will then have the following in its debug output: \nHTTP/1.1 401 Authorization Required\" \n\"Date: Mon, 10 Feb 2003 16:47:24 GMT\" \n\"Server: Apache/1.3.27 (Win32) PHP/4.0.5\" \n\"WWW-Authenticate: Digest realm=\"testingDgst\", nonce=\"...\", algorithm=MD5, \ndomain=\"/intern/milestone2/jBOSSstuff/en\", qop=\"auth\"\" \n \nI hope someone could get the digest authentication to work together with the Directory \ndirective. \n \nThanks in advance, \n\tAndreas Leuner"}, {"count": 1, "tags": [], "creator": "nd@perlig.de", "attachment_id": null, "is_private": false, "id": 31045, "time": "2003-02-11T02:15:11Z", "bug_id": 16937, "creation_time": "2003-02-11T02:15:11Z", "text": "Well, it's a bug in the code that guesses the domain parameter. It relies on\nhaving unix paths (starting with slash).\nYou can work around it by using the AuthDigestDomain directive explicitely.\n(You should always use the AuthDigestDomain directive anyway)\n\nIt's fixed in 2.1 and proposed for backport.\n\nThanks for the report and thanks for using Apache!"}, {"count": 2, "tags": [], "creator": "almighty@atlantis.wh2.tu-dresden.de", "attachment_id": null, "id": 31057, "time": "2003-02-11T10:49:02Z", "bug_id": 16937, "creation_time": "2003-02-11T10:49:02Z", "is_private": false, "text": "Misfortunately the AuthDigestDomain directive is not recognized by Apache 1.3.x (only \nversion 2.0.x) \n \nI have also experimented a bit. I have now a Linux Apache 1.3.27 (compiled from \nsource) running. Authorisation works with configurations equivalent to both described \nconfigs in my original message. However there seems to be no domain parameter at \nall in the 401 response here (both configurations). I don't know if one has to be there - \nso I can live with my result. \nMaybe you could take this as a feature request ;-) \n \nBye, \n\tAndreas Leuner "}, {"count": 3, "tags": [], "text": "oh, it seems, we're talking about two different things.\nThere are two modules in 1.3 for digest authentication, mod_digest (deprecated)\nand the newer mod_auth_digest. The latter recognizes the AuthDigestDomain\ndirective and creates the described error (in Directory containers and if not set).\n\nI'd guess you have installed good ol' mod_digest under Linux, where the domain\nparameter will not be composed at all.", "attachment_id": null, "bug_id": 16937, "id": 31058, "time": "2003-02-11T11:26:14Z", "creator": "nd@perlig.de", "creation_time": "2003-02-11T11:26:14Z", "is_private": false}, {"count": 4, "tags": [], "text": "argh, you're right. I remember that I explicitly took mod_auth_digest for the windows \nserver. I must have slept when I set up Apache for Linux. I will try mod_auth_digest \nASAP. ", "attachment_id": null, "bug_id": 16937, "id": 31061, "time": "2003-02-11T11:38:31Z", "creator": "almighty@atlantis.wh2.tu-dresden.de", "creation_time": "2003-02-11T11:38:31Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 16937, "is_private": false, "id": 31064, "creation_time": "2003-02-11T12:32:56Z", "time": "2003-02-11T12:32:56Z", "creator": "almighty@atlantis.wh2.tu-dresden.de", "text": "Now I got it. I have recompiled my Apache including mod_digest_auth. \nRegarding the domain parameter the Linux version behaves wrong similar to the \nwindows version. If I use the <Directory> directive to configure the authentication the \ndomain parameter in the 401 response will be an _empty_ string. This confuses at \nleast Konqueror which keeps on loading forever. If I use <Location>, that parameter \nwill have the correct value. \nUsing the AuthDigestDomain directive indeed makes both <Directory> and <Location> \nwork (thanks for the correction). \n \nThanks for your help, \n\tAndreas Leuner ", "attachment_id": null}, {"count": 6, "tags": [], "creator": "nd@perlig.de", "attachment_id": null, "is_private": false, "id": 31226, "time": "2003-02-13T13:56:13Z", "bug_id": 16937, "creation_time": "2003-02-13T13:56:13Z", "text": "Well, I changed the fix by removing the domain guessing code entirely. Guessing\nhere seems totally bogus to me. (aside from the broken guessing code anyway).\n\nThe effect is then, if no AuthDigestDomain is specified, the domain attribute\nwill be omitted (which is the same as AuthDigestDomain /).\n\nIf nobody vetoes the change, it will hopefully be backported.\n\nThanks again."}, {"count": 7, "tags": [], "bug_id": 16937, "attachment_id": null, "text": "Fix will be available in the next release (1.3.28).", "id": 31350, "time": "2003-02-16T04:52:34Z", "creator": "nd@perlig.de", "creation_time": "2003-02-16T04:52:34Z", "is_private": false}]