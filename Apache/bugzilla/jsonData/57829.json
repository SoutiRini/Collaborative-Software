[{"count": 0, "tags": [], "creator": "brunohpg@gmail.com", "attachment_id": null, "text": "The method XWPFParagraph.removeRun(.) don't remove parameter XWPFRun from internal 'irun' list of XWPFParagraph.\n\nInsert methods puts XWPFRun in two lists: 'run' and 'irun'. Remove method must remove XWPFRun from both lists.\n\nAfter use \"XWPFParagraph.removeRun(.)\" method, methods like XWPFParagraph.getText() throws XmlValueDisconnectedException.\n\n----------------------------------------------\nSimple code to generate an error:\n\n        XWPFDocument doc = ...;\n\n        for (XWPFParagraph paragraph : doc.getParagraphs()) {\n            paragraph.removeRun(0);\n            System.out.println(paragraph.getText());\n        }\n\n----------------------------------------------\nThe patch (NOT TESTED!) can be:\nFrom:\n\n    public boolean removeRun(int pos){\n        if (pos >= 0 && pos < paragraph.sizeOfRArray()) {\n            getCTP().removeR(pos);\n            runs.remove(pos);\n            return true;\n        }\n        return false;\n    }\n\nTo:\n\n    public boolean removeRun(int pos){\n        if (pos >= 0 && pos < paragraph.sizeOfRArray()) {\n            getCTP().removeR(pos);\n            iruns.remove(runs.get(pos));\n            runs.remove(pos);\n            return true;\n        }\n        return false;\n    }\n----------------------------------------------\n\nYou can also check out if \"pos\" always corresponds to CTP.RArray index and 'run' list index.", "id": 182463, "time": "2015-04-17T21:47:26Z", "bug_id": 57829, "creation_time": "2015-04-17T21:47:26Z", "is_private": false}, {"count": 1, "tags": [], "text": "Thanks, fixed with unit test (based on your examples!) in r1675738.", "attachment_id": null, "id": 182603, "creation_time": "2015-04-24T01:29:38Z", "time": "2015-04-24T01:29:38Z", "creator": "apache@gagravarr.org", "bug_id": 57829, "is_private": false}]