[{"count": 0, "tags": [], "text": "Using various methods I cannot get a second sheet to retain its status as \nselected after saving it. Because I am not 100% sure that it's not me being \nstupid I am including a test case here (after all I am new to POI and not too \nexperienced in Java). I use Java 1.4.2_04 and POI-2.5-final on Windows XP Pro, \nand I open the resulting workbook in MS Excel 2002 SP-2. The test case follows \nafter \"---< cut\". Neither of the three selection methods included (one active \nand two others commented out) work for me.\n\n---< cut\nimport org.apache.poi.hssf.usermodel.HSSFWorkbook;\nimport org.apache.poi.hssf.usermodel.HSSFSheet;\nimport org.apache.poi.hssf.usermodel.HSSFFooter;\nimport org.apache.poi.hssf.usermodel.HSSFRow;\nimport org.apache.poi.hssf.usermodel.HSSFCell;\nimport java.io.FileOutputStream;\nimport java.io.FileNotFoundException;\nimport java.io.IOException;\n\n\npublic class PoiTest19 {\n\t\n\tpublic static void main(String[] args) {\n\t\tHSSFWorkbook workbook;\n\t\tHSSFSheet worksheet;\n\t\tHSSFFooter footer;\n\t\tHSSFRow row;\n\t\tHSSFCell cell;\n\t\t\n\t\tworkbook = new HSSFWorkbook();\n\t\tworksheet = workbook.createSheet(\"empty sheet\");\n\t\tworksheet = workbook.createSheet(\"sheet with rows\");\n\t\t\n\t\tfooter = worksheet.getFooter();\n\t\tfooter.setRight(\"Page \" + HSSFFooter.page() + \" of \" + \nHSSFFooter.numPages());\n\t\t\n\t\tfor (int i = 0; i < 134; i++) {\n\t\t\trow = worksheet.createRow(i);\n\t\t\tcell = row.createCell((short) 0);\n\t\t\tcell.setCellValue(i * 1000 + i * (i + 1));\n\t\t}\n\t\t\n\t\tworksheet.setSelected(true);\n\t\t// workbook.getSheetAt(1).setSelected(true);\n\t\t// workbook.getSheetAt(workbook.getSheetIndex(\"sheet with \nrows\")).setSelected(true);\n\t\t\n\t\ttry {\n\t\t\tFileOutputStream ausgabeDatei = new FileOutputStream\n(\"poi_test.xls\");\n\t\t\tworkbook.write(ausgabeDatei);\n\t\t\tausgabeDatei.close();\n\t\t}\n\t\tcatch(FileNotFoundException fnfE) {\n\t\t\tSystem.out.println(\"Datei nicht vorhanden!\");\n\t\t\tfnfE.printStackTrace();\n\t\t}\n\t\tcatch(IOException ioE) {\n\t\t\tSystem.out.println(\"Ein Ein-/Ausgabe-Fehler ist \naufgetreten!\");\n\t\t\tioE.printStackTrace();\n\t\t}\n\t}\n\t\n}", "is_private": false, "bug_id": 28328, "id": 55604, "time": "2004-04-10T09:16:11Z", "creator": "csage@capita.de", "creation_time": "2004-04-10T09:16:11Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 28328, "attachment_id": null, "id": 66455, "time": "2004-11-04T15:11:33Z", "creator": "jmroth@mtg.de", "creation_time": "2004-11-04T15:11:33Z", "is_private": false, "text": "I am having the same problem generating an excel file with 3 sheets via POI\n(poi-2.5-final-20040302.jar and Excel97 SR-2).\n\nWhen I store the file and open it with excel, the 3rd sheet is shown.\nNow I want to make sure, the 1st sheet (overview) shows up when the file is\nopened by someone.\nI tried the setSelected on the 1st sheet, but this only results in the tab for\nthe 1st sheet having white background, but the 2nd is shown to the user.\nI found, I'm not the only one experiencing this problem:\nhttp://java2.5341.com/msg/78833.html\n\nSo some people seem to be waiting for a solution. Thanks! "}, {"count": 2, "tags": [], "text": "I have the same problem.\nI have an excel file as template containing 12 sheets.\nThe default selected sheet is the first sheet (by the time the excel template \nwas saved).\nThe program will select the sheet of the month that was selected from the \nscreen.\n\nBelow is the code snippet:\n\nworkBook.getSheetAt(0).setSelected(false);\n//month is zero-based\nworkBook.getSheetAt(reportMonth).setSelected(true);\n\nI hope that this would be fixed.\nI am using poi-2.5.1-final-20040804.jar\nI also tried using poi-bin-3.0-alpha1-20050704 but still, it was not yet fixed.\n\n\nThank you very much!", "is_private": false, "bug_id": 28328, "id": 77885, "time": "2005-08-01T07:22:36Z", "creator": "nick.advincula@gmail.com", "creation_time": "2005-08-01T07:22:36Z", "attachment_id": null}, {"count": 3, "attachment_id": 15841, "creator": "amolweb@yahoo.com", "is_private": false, "id": 77911, "time": "2005-08-01T16:38:41Z", "bug_id": 28328, "creation_time": "2005-08-01T16:38:41Z", "tags": [], "text": "Created attachment 15841\nWindowOneRecord's selectedTab and displayedTab are made accessible via usermodel api\n\nHSSFSheet#setSelected(boolean) cause the \"tab selection\" in excel to be set -\nwhich simply means that the tab is seen as selected but the actual data could\nbe from a different tab (sheet).\n\nBiffViewer indicated that \"Sheet selection\" is actually controlled by\nWindowOneRecord.selectedTab.\n\nThis patch adds setter/getters for the WindowOneRecord in Workbook which is\nthen used by newly added usermodel method HSSFWorkbook#setSelectedTab(short) to\nset the selected sheet.\n(Similarly, although not directly related to this bug, setDisplayedTab was\nadded to HSSFWorkbook to allow setting the default displayed \"first\" tab in\nexcel)\n\nIt must be noted that to get the exact effect of selecting a sheet you would\n(after this patch) need to use:\n\n\n\nfor (...) { // cycle over all sheets in workbook\n  // causes previous selection to be deselected\n  sheet.setSelected(false);\n}\n\nsheet = workbook.getSheetAt(mySheetIndex);\n\n// show the tab as selected\nsheet.setSelected(true); \n\n// show the data frm selected sheet\nworkbook.setSelectedTab((short) mySheetIndex);"}, {"count": 4, "tags": [], "creator": "amolweb@yahoo.com", "attachment_id": 16182, "is_private": false, "id": 78939, "time": "2005-08-24T18:32:03Z", "bug_id": 28328, "creation_time": "2005-08-24T18:32:03Z", "text": "Created attachment 16182\nUpdated the patch file after recent changes for RICHTEXT\n\nThis patch has now been applied to CVS (previous patch file was not applied to\nCVS)\n\nBasically, same as previous patch file: changes in this patch file are only due\nto change of code in HSSFWorkbook and Workbook due to recent RICHTEXT changes."}, {"count": 5, "tags": [], "bug_id": 28328, "is_private": false, "id": 78952, "attachment_id": null, "creator": "jheight@apache.org", "creation_time": "2005-08-25T00:13:07Z", "time": "2005-08-25T00:13:07Z", "text": "Amol,\n\nIf the patch has been applied to CVS, can the bug be closed?\n\nJason"}, {"count": 6, "tags": [], "text": "Comment on attachment 16182\nUpdated the patch file after recent changes for RICHTEXT\n\nsend me this patch", "attachment_id": 16182, "id": 92417, "creation_time": "2006-08-22T16:09:04Z", "time": "2006-08-22T16:09:04Z", "creator": "ghamgui@it-conseil.com", "bug_id": 28328, "is_private": false}, {"count": 7, "tags": [], "text": "(In reply to comment #6)\n> (From update of attachment 16182 [edit])\n> send me this patch \n> \n\nVerified fixed in POI trunk and 3.0-alpha2.", "attachment_id": null, "id": 92420, "creation_time": "2006-08-22T17:20:53Z", "time": "2006-08-22T17:20:53Z", "creator": "amolweb@yahoo.com", "bug_id": 28328, "is_private": false}]