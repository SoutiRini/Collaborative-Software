[{"attachment_id": null, "tags": [], "bug_id": 9410, "text": "Service failing to read parameters supplied through \nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Apache2\\ImagePath \nregistry key.\nProblem is in registry.c file, method ap_registry_get_array. It used to read \nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Apache2\n\\Parameters\\ConfigArgs value, which in my case is empty. But original \nimplementation failing to recognize empty array and is returning array with \none empty element. This empty element is inserted into argument list before \nuser arguments during arguments rewriting. Becouse of that user arguments are \ngetting ignored.\n\nHere is simple patch:\n--- registry-old.c\tFri May 17 11:11:40 2002\n+++ registry.c\tSat May 25 05:21:54 2002\n@@ -266,26 +266,21 @@\n \t\t\t     pValue,        /* for value */\n \t\t\t     &nSize);\t/* for size of \"value\" */\n \n-        nSize = 1;    /* Element Count */\n-        tmp = pValue;\n-        while (tmp[0] || tmp[1])\n-        {\n-            if (!tmp[0])\n-                ++nSize;\n-            ++tmp;\n+        nSize = 0;    /* Element Count */\n+        for (tmp = pValue; *tmp; ++tmp) {\n+            ++nSize;\n+            while (*tmp) {\n+                ++tmp;\n+            }\n         }\n-    \n+\n         *parray = apr_array_make(p, nSize, sizeof(char *));\n-        tmp = pValue;\n-        newelem = (char **) apr_array_push(*parray);\n-        *newelem = tmp;\n-        while (tmp[0] || tmp[1])\n-        {\n-            if (!tmp[0]) {\n-                newelem = (char **) apr_array_push(*parray);\n-                *newelem = tmp + 1;\n+        for (tmp = pValue; *tmp; ++tmp) {\n+            newelem = (char **) apr_array_push(*parray);\n+            *newelem = tmp;\n+            while (*tmp) {\n+                ++tmp;\n             }\n-            ++tmp;\n         }\n     }", "count": 0, "id": 16695, "time": "2002-05-25T05:48:33Z", "creator": "vasiliy@gazooc.com", "creation_time": "2002-05-25T05:48:33Z", "is_private": false}, {"count": 1, "tags": [], "creator": "vasiliy@gazooc.com", "text": "Created attachment 1939\nBug fix", "id": 16696, "time": "2002-05-25T05:49:37Z", "bug_id": 9410, "creation_time": "2002-05-25T05:49:37Z", "is_private": false, "attachment_id": 1939}, {"count": 2, "tags": [], "creator": "wrowe@apache.org", "text": "\n  Applied, and further protected from unterminated or single null terminated\n  REG_MULTI_SZ data.  Thanks for your report and patch!", "id": 16711, "time": "2002-05-25T20:08:02Z", "bug_id": 9410, "creation_time": "2002-05-25T20:08:02Z", "is_private": false, "attachment_id": null}]