[{"count": 0, "tags": [], "text": "It appears that XSSFColor.hasTint() has an incorrect implementation. It checks to see if the RGB array is length 4 as the determining factor. But other methods in this class indicate that an length of 4 means the color has an *alpha* value.\n\nAs a concrete example, try creating a xlsx spreadsheet in Excel, with a color that has a tint value. The hasTint() method will return false, but the getTint() method returns a non-zero value.\n\nSo, I think hasTint() should just be renamed to hasAlpha() (and method's javadoc comment updated), and a new method created called hasTint(), with an implemention like below:\n\n    /**\n     * A boolean value indicating if the ctColor has alpha or not\n     */\n    public boolean hasAlpha() {\n        if (! ctColor.isSetRgb()) {\n            return false;\n        }\n        return ctColor.getRgb().length == 4;\n    }\n\n    /**\n     * A boolean value indicating if the ctColor has a tint or not\n     */\n    public boolean hasTint() {\n        return ctColor.getTint() != 0;\n    }", "is_private": false, "id": 189677, "creation_time": "2016-03-23T20:54:17Z", "time": "2016-03-23T20:54:17Z", "creator": "gubespam@gmail.com", "bug_id": 59224, "attachment_id": null}, {"count": 1, "tags": [], "text": "Should hasTint return false if tint is not set?\n\n    public boolean hasTint() {\n        if (!ctColor.isSetTint()) {\n            return false;\n        }\n        return ctColor.getTint() != 0;\n    }", "is_private": false, "id": 189695, "creation_time": "2016-03-24T06:43:01Z", "time": "2016-03-24T06:43:01Z", "creator": "onealj@apache.org", "bug_id": 59224, "attachment_id": null}, {"count": 2, "tags": [], "creator": "onealj@apache.org", "attachment_id": 33700, "id": 189696, "time": "2016-03-24T07:18:05Z", "bug_id": 59224, "creation_time": "2016-03-24T07:18:05Z", "is_private": false, "text": "Created attachment 33700\nchange hasTint, add hasAlpha and unit tests\n\nIs this all that needs to be modified?"}, {"count": 3, "tags": [], "text": "Applied in r1736469.", "is_private": false, "id": 189715, "creation_time": "2016-03-24T17:32:53Z", "time": "2016-03-24T17:32:53Z", "creator": "onealj@apache.org", "bug_id": 59224, "attachment_id": null}]