[{"count": 0, "tags": [], "creator": "zdenek.hrib@seznam.cz", "text": "If the following code is executed, subsequent calls to dataFormat.getFormat() \nwill cause all the formated cells to have the last requested format instead of \nthe format that was set on them in previous call to dataFormat.getFormat() \n\n\n        HSSFWorkbook wb = new HSSFWorkbook();\n        HSSFSheet sheet = wb.createSheet(\"new sheet\");\n\n        HSSFRow row = sheet.createRow((short)0);\n\n        short iFormat = 0;\n\n        HSSFDataFormat dataFormat = wb.createDataFormat(); \n\n        HSSFCell cell = row.createCell((short)0);\n        iFormat = dataFormat.getFormat(\"000000%\");\n        cell.getCellStyle().setDataFormat(iFormat);         \n        cell.setCellFormula(\"1/\"+ String.valueOf(iFormat));\n        //cell.setCellValue(\"1\");\n\n\n        //HSSFCell first_cell = cell;\n        \n        cell = row.createCell((short)1);\n        iFormat = dataFormat.getFormat(\"00000%\");\n        cell.getCellStyle().setDataFormat(iFormat);         \n        cell.setCellFormula(\"1/\"+ String.valueOf(iFormat));\n        //cell.setCellValue(\"1\");\n\n\n        cell = row.createCell((short)2);\n        iFormat = dataFormat.getFormat(\"0000%\");\n        cell.getCellStyle().setDataFormat(iFormat);         \n        cell.setCellFormula(\"1/\"+ String.valueOf(iFormat));\n        //cell.setCellValue(\"1\");\n\n        //iFormat = dataFormat.getFormat(\"000000%\");\n        //first_cell.getCellStyle().setDataFormat(iFormat);         \n\n\n        FileOutputStream fileOut = new FileOutputStream(\"workbook.xls\");\n        wb.write(fileOut);\n        fileOut.close();\n\n\nAlso using cell.setCellValue(\"1\") looks like it is not working as it will not \ncause the cell to effectivelly use any of the specified formats (set on the \ncell before or after call to cell.setCellValue()), but that is another story...\nTherefore in this example I am using cell.setCellFormula() with index number of \nthe format written into the sheet.\n\n\nIf the code\n\n        //HSSFCell first_cell = cell;\n         .\n         .\n         .\n        //iFormat = dataFormat.getFormat(\"000000%\");\n        //first_cell.getCellStyle().setDataFormat(iFormat);         \n\nyou will see format of all the touched cells set to 000000%.", "id": 88421, "time": "2006-04-24T12:27:42Z", "bug_id": 39392, "creation_time": "2006-04-24T12:27:42Z", "is_private": false, "attachment_id": null}, {"attachment_id": 18162, "tags": [], "bug_id": 39392, "text": "Created attachment 18162\nexample source", "count": 1, "id": 88422, "time": "2006-04-24T12:29:28Z", "creator": "zdenek.hrib@seznam.cz", "creation_time": "2006-04-24T12:29:28Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 39392, "attachment_id": 18163, "text": "Created attachment 18163\ncompile and run batch file", "id": 88423, "time": "2006-04-24T12:30:11Z", "creator": "zdenek.hrib@seznam.cz", "creation_time": "2006-04-24T12:30:11Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 39392, "is_private": false, "text": "Created attachment 18164\nexample result workbook file", "id": 88424, "time": "2006-04-24T12:31:49Z", "creator": "zdenek.hrib@seznam.cz", "creation_time": "2006-04-24T12:31:49Z", "attachment_id": 18164}, {"count": 4, "tags": [], "bug_id": 39392, "attachment_id": null, "text": "You are applying data format to the same cell style, that is why it affects all the cells. To apply per-cell format you need to create a style for each cell:\n\n        style = wb.createCellStyle();\n        style.setDataFormat(iFormat);\n        cell.setCellFormula(\"1/\"+ String.valueOf(iFormat));\n        cell.setCellStyle(style);\n\nYegor", "id": 126003, "time": "2009-04-04T06:19:13Z", "creator": "yegor@dinom.ru", "creation_time": "2009-04-04T06:19:13Z", "is_private": false}]