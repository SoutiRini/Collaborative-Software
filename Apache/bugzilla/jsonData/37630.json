[{"count": 0, "tags": [], "bug_id": 37630, "text": "when I open the attached file, i get the exception from the summary.\n\nstacktrace:\n\njava.lang.reflect.InvocationTargetException\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat\nsun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:274)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:243)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:157)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:183)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:152)\n\tat com.segue.scc.util.excel.MSExcelWriter.loadWorkbook(MSExcelWriter.java:66)\n\tat\ncom.segue.tm.common.entities.execution.util.ManualTestOfflineExecutor.write(ManualTestOfflineExecutor.java:47)\n\tat\ncom.segue.tm.common.entities.execution.util._TestManualTestOfflineExecutor.testWrite(_TestManualTestOfflineExecutor.java:36)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:324)\n\tat junit.framework.TestCase.runTest(TestCase.java:154)\n\tat junit.framework.TestCase.runBare(TestCase.java:127)\n\tat junit.framework.TestResult$1.protect(TestResult.java:106)\n\tat junit.framework.TestResult.runProtected(TestResult.java:124)\n\tat junit.framework.TestResult.run(TestResult.java:109)\n\tat junit.framework.TestCase.run(TestCase.java:118)\n\tat junit.framework.TestSuite.runTest(TestSuite.java:208)\n\tat junit.framework.TestSuite.run(TestSuite.java:203)\n\tat junit.textui.TestRunner.doRun(TestRunner.java:116)\n\tat com.intellij.rt.execution.junit2.IdeaJUnitAgent.doRun(IdeaJUnitAgent.java:57)\n\tat junit.textui.TestRunner.start(TestRunner.java:172)\n\tat\ncom.intellij.rt.execution.junit.TextTestRunner2.startRunnerWithArgs(TextTestRunner2.java:23)\n\tat\ncom.intellij.rt.execution.junit2.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:97)\n\tat com.intellij.rt.execution.junit2.JUnitStarter.main(JUnitStarter.java:31)\nCaused by: org.apache.poi.hssf.record.RecordFormatException:\njava.lang.UnsupportedOperationException: 60 (96)\n\tat\norg.apache.poi.hssf.record.NameRecord.getParsedExpressionTokens(NameRecord.java:789)\n\tat org.apache.poi.hssf.record.NameRecord.fillFields(NameRecord.java:757)\n\tat org.apache.poi.hssf.record.Record.<init>(Record.java:57)\n\tat org.apache.poi.hssf.record.NameRecord.<init>(NameRecord.java:143)\n\t... 29 more\n\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record\ninstance, the following exception occured: null\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:258)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:157)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:183)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:152)\n\tat com.segue.scc.util.excel.MSExcelWriter.loadWorkbook(MSExcelWriter.java:66)\n\tat\ncom.segue.tm.common.entities.execution.util.ManualTestOfflineExecutor.write(ManualTestOfflineExecutor.java:47)\n\tat\ncom.segue.tm.common.entities.execution.util._TestManualTestOfflineExecutor.testWrite(_TestManualTestOfflineExecutor.java:36)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat com.intellij.rt.execution.junit2.JUnitStarter.main(JUnitStarter.java:31)\n\n\nthis happens with 2.5.1-final and with the current cvs version.", "id": 82820, "time": "2005-11-24T15:29:07Z", "creator": "richts@gmx.at", "creation_time": "2005-11-24T15:29:07Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "richts@gmx.at", "attachment_id": 17034, "text": "Created attachment 17034\nthe excel file i use to reproduce the exception.", "id": 82821, "time": "2005-11-24T15:29:52Z", "bug_id": 37630, "creation_time": "2005-11-24T15:29:52Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 37630, "attachment_id": null, "id": 82857, "time": "2005-11-25T09:34:53Z", "creator": "richts@gmx.at", "creation_time": "2005-11-25T09:34:53Z", "is_private": false, "text": "I'm using the cvs version now, and changed Ptg.java, line around 190 to:\n\n            case MemErrPtg.sid :        // 0x27       These 3 values \n            case MemErrPtg.sid+0x20 :   // 0x47       documented in \n            case MemErrPtg.sid+0x40 :   // 0x67       openOffice.org doc.\n            case 0x60 :\n                retval = new MemErrPtg(in);\n\n                break;\n\n\ni don't know, what this means, but now i can read my excel file."}, {"count": 3, "tags": [], "creator": "jheight@apache.org", "text": "Fixed! Error caused by ArrayPtgs not being implemented.\n\nThey now are!\n\nFix available in SVN.\n\nJason", "id": 84842, "attachment_id": null, "bug_id": 37630, "creation_time": "2006-01-21T06:43:35Z", "time": "2006-01-21T06:43:35Z", "is_private": false}, {"count": 4, "tags": [], "creator": "nshashank1982@rediffmail.com", "text": "I am trying to read a excel which contains two drop down lists.\nI get the following error.\n\nException in thread \"main\" org.apache.poi.hssf.record.RecordFormatException: \nUnable to construct record instance\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java:191)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java:115)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:205)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:257)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:238)\n\tat excelFileReader.ParseExcel.main(ParseExcel.java:17)\nCaused by: java.lang.reflect.InvocationTargetException\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native \nMethod)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance\n(NativeConstructorAccessorImpl.java:39)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance\n(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:513)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java:179)\n\t... 5 more\nCaused by: org.apache.poi.hssf.record.RecordFormatException: \njava.lang.UnsupportedOperationException:  Unknown Ptg in Formula: 0x0 (0)\n\tat org.apache.poi.hssf.record.FormulaRecord.fillFields\n(FormulaRecord.java:109)\n\tat org.apache.poi.hssf.record.Record.<init>(Record.java:56)\n\tat org.apache.poi.hssf.record.FormulaRecord.<init>\n(FormulaRecord.java:89)\n\t... 10 more\nCaused by: java.lang.UnsupportedOperationException:  Unknown Ptg in Formula: \n0x0 (0)\n\tat org.apache.poi.hssf.record.formula.Ptg.createPtg(Ptg.java:357)\n\tat org.apache.poi.hssf.record.formula.Ptg.createParsedExpressionTokens\n(Ptg.java:98)\n\tat org.apache.poi.hssf.record.FormulaRecord.fillFields\n(FormulaRecord.java:107)\n\t... 12 more", "id": 103787, "time": "2007-05-29T14:13:32Z", "bug_id": 37630, "creation_time": "2007-05-29T14:13:32Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "josh@apache.org", "attachment_id": null, "text": "Original fix was in svn r370987.\n\nComment #4 seems to refer to a different problem.  Without an example file it is difficult to be sure if it has been fixed, but there has been much work with formulas since version 3.0.   If your workbook still fails to read with POI 3.5-beta4, please upload it to a new bugzilla entry.", "id": 122979, "time": "2008-12-01T23:37:00Z", "bug_id": 37630, "creation_time": "2008-12-01T23:37:00Z", "is_private": false}]