[{"count": 0, "tags": [], "creator": "gur@axismobile.com", "attachment_id": null, "id": 97362, "time": "2006-12-27T01:02:14Z", "bug_id": 41246, "creation_time": "2006-12-27T01:02:14Z", "is_private": false, "text": "Trying to instantiate a SlideShow with the attached file throws the following\nexception:\n\njava.lang.ArrayIndexOutOfBoundsException - 39\n      at org.apache.poi.util.LittleEndian.getInt(LittleEndian.java:140)\n      at\norg.apache.poi.hslf.record.StyleTextPropAtom.setParentTextSize(StyleTextPropAtom.java:259)\n      at org.apache.poi.hslf.model.TextRun.<init>(TextRun.java:95)\n      at org.apache.poi.hslf.model.TextRun.<init>(TextRun.java:72)\n      at org.apache.poi.hslf.model.Sheet.findTextRuns(Sheet.java:136)\n      at org.apache.poi.hslf.model.Slide.<init>(Slide.java:82)\n      at\norg.apache.poi.hslf.usermodel.SlideShow.buildSlidesAndNotes(SlideShow.java:444)\n      at org.apache.poi.hslf.usermodel.SlideShow.<init>(SlideShow.java:122)"}, {"count": 1, "text": "Created attachment 19307\nMS powerpoint file\n\nThis attached MS-PowerPoint presentation caused the exception", "bug_id": 41246, "is_private": false, "id": 97363, "time": "2006-12-27T01:03:42Z", "creator": "gur@axismobile.com", "creation_time": "2006-12-27T01:03:42Z", "tags": [], "attachment_id": 19307}, {"count": 2, "text": "The bug has the same origin as Bug 40143. \n\nRegards,\nYegor", "bug_id": 41246, "is_private": false, "id": 97876, "time": "2007-01-10T06:07:11Z", "creator": "yegor@dinom.ru", "creation_time": "2007-01-10T06:07:11Z", "tags": [], "attachment_id": null}, {"count": 3, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 98137, "time": "2007-01-16T07:54:01Z", "bug_id": 41246, "creation_time": "2007-01-16T07:54:01Z", "is_private": false, "text": "I think this problem has now been fixed, thanks to Yegor's new understanding\nof the ordering of TextProps in StyleTextPropAtom\n\nI can open your test powerpoint document without any exceptions, so I'm\nhoping this is now closed. If you still get problems, can you re-open with a new\nproblem file?\n"}, {"count": 4, "text": "Got this Exception (through Tika) (POI r1175705) :\n\njava.lang.ArrayIndexOutOfBoundsException: 16\n  at org.apache.poi.hslf.usermodel.SlideShow.buildSlidesAndNotes(SlideShow.java:405)\n  at org.apache.poi.hslf.usermodel.SlideShow.<init>(SlideShow.java:109)", "bug_id": 41246, "attachment_id": null, "id": 149947, "time": "2011-09-29T14:14:39Z", "creator": "pablo.queixalos@polyspot.com", "creation_time": "2011-09-29T14:14:39Z", "tags": [], "is_private": false}, {"count": 5, "text": "(In reply to comment #4)\n> Got this Exception (through Tika) (POI r1175705) :\n> \n> java.lang.ArrayIndexOutOfBoundsException: 16\n>   at\n> org.apache.poi.hslf.usermodel.SlideShow.buildSlidesAndNotes(SlideShow.java:405)\n>   at org.apache.poi.hslf.usermodel.SlideShow.<init>(SlideShow.java:109)\n\nAny chance you could post a file that shows the problem?", "bug_id": 41246, "attachment_id": null, "id": 149948, "time": "2011-09-29T14:16:57Z", "creator": "apache@gagravarr.org", "creation_time": "2011-09-29T14:16:57Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "bug_id": 41246, "attachment_id": 27635, "is_private": false, "id": 149949, "time": "2011-09-29T14:18:14Z", "creator": "pablo.queixalos@polyspot.com", "creation_time": "2011-09-29T14:18:14Z", "text": "Created attachment 27635\nThrows ArrayIndexOutOfBoundsException in SlideShow.buildSlidesAndNotes()"}, {"count": 7, "tags": [], "bug_id": 41246, "is_private": false, "text": "Found a TextHeaderAtom not followed by a TextBytesAtom or TextCharsAtom: Followed by 4002\nFound a TextHeaderAtom not followed by a TextBytesAtom or TextCharsAtom: Followed by 4002\nFound a TextHeaderAtom not followed by a TextBytesAtom or TextCharsAtom: Followed by 4002\nFound a TextHeaderAtom not followed by a TextBytesAtom or TextCharsAtom: Followed by 4002\nFound a TextHeaderAtom not followed by a TextBytesAtom or TextCharsAtom: Followed by 4002\nFound a TextHeaderAtom not followed by a TextBytesAtom or TextCharsAtom: Followed by 4002\n\nCaused by: java.lang.ArrayIndexOutOfBoundsException: 36\n\tat org.apache.poi.util.LittleEndian.getInt(LittleEndian.java:95)\n\tat org.apache.poi.hslf.record.StyleTextPropAtom.setParentTextSize(StyleTextPropAtom.java:319)\n\tat org.apache.poi.hslf.model.TextRun.<init>(TextRun.java:100)\n\tat org.apache.poi.hslf.model.TextRun.<init>(TextRun.java:77)\n\tat org.apache.poi.hslf.model.Sheet.findTextRuns(Sheet.java:175)\n\tat org.apache.poi.hslf.model.Sheet.findTextRuns(Sheet.java:132)\n\tat org.apache.poi.hslf.model.Slide.<init>(Slide.java:70)\n\tat org.apache.poi.hslf.usermodel.SlideShow.buildSlidesAndNotes(SlideShow.java:411)\n\tat org.apache.poi.hslf.usermodel.SlideShow.<init>(SlideShow.java:109)\n\tat com.open.common.ppt.ReportUtility.writePPTNew(ReportUtility.java:1689)\n\tat com.auchan.crs.service.report.templatemgt.ReportAjaxService.ajaxCreateReportNew(ReportAjaxService.java:716)\n\tat com.auchan.crs.view.action.report.templatemgt.ReportAjaxAction.ajaxCreateReportNew(ReportAjaxAction.java:789)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n\tat java.lang.reflect.Method.invoke(Unknown Source)\n\tat com.open.framework.view.DispatchAction.dispatchMethod(DispatchAction.java:264)\n\t... 26 more", "id": 151823, "time": "2011-11-28T07:53:59Z", "creator": "andy20050125@163.com", "creation_time": "2011-11-28T07:53:59Z", "attachment_id": null}, {"count": 8, "text": "I can't believe, this bug can living 4 years.\n:)\n\nPOI HSLF 3.8 dev", "bug_id": 41246, "is_private": false, "id": 151824, "time": "2011-11-28T07:56:26Z", "creator": "andy20050125@163.com", "creation_time": "2011-11-28T07:56:26Z", "tags": [], "attachment_id": null}, {"count": 9, "text": "(In reply to comment #5)\n> (In reply to comment #4)\n> > Got this Exception (through Tika) (POI r1175705) :\n> > \n> > java.lang.ArrayIndexOutOfBoundsException: 16\n> >   at\n> > org.apache.poi.hslf.usermodel.SlideShow.buildSlidesAndNotes(SlideShow.java:405)\n> >   at org.apache.poi.hslf.usermodel.SlideShow.<init>(SlideShow.java:109)\n> \n> Any chance you could post a file that shows the problem?\n\nI also have a file that gives similar errors in POI 3.8.  I can send it, but not onto a public forum, and I can't clean it up because if I make any changes to it, it no longer gives the error!\n\nIs there a way to send it to just a few people, and not have it be available to everyone?\n\njava.lang.ArrayIndexOutOfBoundsException: 60\n\tat org.apache.poi.util.LittleEndian.getInt(LittleEndian.java:163)\n\tat org.apache.poi.hslf.record.StyleTextPropAtom.setParentTextSize(StyleTextPropAtom.java:319)\n\tat org.apache.poi.hslf.model.TextRun.<init>(TextRun.java:100)\n\tat org.apache.poi.hslf.model.TextRun.<init>(TextRun.java:77)\n\tat org.apache.poi.hslf.model.Sheet.findTextRuns(Sheet.java:170)\n\tat org.apache.poi.hslf.model.Sheet.findTextRuns(Sheet.java:131)\n\tat org.apache.poi.hslf.model.Slide.<init>(Slide.java:70)\n\tat org.apache.poi.hslf.usermodel.SlideShow.buildSlidesAndNotes(SlideShow.java:411)\n\tat org.apache.poi.hslf.usermodel.SlideShow.<init>(SlideShow.java:109)", "bug_id": 41246, "attachment_id": null, "id": 157760, "time": "2012-04-09T23:03:04Z", "creator": "MaryAubaun@gmail.com", "creation_time": "2012-04-09T23:03:04Z", "tags": [], "is_private": false}, {"count": 10, "tags": [], "bug_id": 41246, "attachment_id": null, "is_private": false, "id": 157763, "time": "2012-04-10T00:06:50Z", "creator": "apache@gagravarr.org", "creation_time": "2012-04-10T00:06:50Z", "text": "Do the problem files pass the Binary File Format Validator? <http://poi.apache.org/faq.html#faq-N10109> And do you know how the files were generated?"}, {"count": 11, "tags": [], "creator": "MaryAubaun@gmail.com", "attachment_id": null, "id": 157772, "time": "2012-04-10T14:27:31Z", "bug_id": 41246, "creation_time": "2012-04-10T14:27:31Z", "is_private": false, "text": "(In reply to comment #10)\n> Do the problem files pass the Binary File Format Validator?\n> <http://poi.apache.org/faq.html#faq-N10109> And do you know how the files were\n> generated?\n\nThanks for the validator link, the file DOES pass the validator.  I can't tell how it was generated and suspect from an old version of PowerPoint."}, {"count": 12, "text": "Any chance that you could use the tools in org.apache.poi.hslf.dev to produce a hex dump of your StyleTextPropAtoms? Ideally just the problematic one (you might need to fetch all the records, and iterate through setting the text size until you find the one that breaks)\n\nHSLF seems to have an idea on the number of parts that make up the style, and it's running off the end part way through reading a style, so we need to get the hex dump to work out why", "bug_id": 41246, "is_private": false, "id": 157778, "time": "2012-04-10T15:13:05Z", "creator": "apache@gagravarr.org", "creation_time": "2012-04-10T15:13:05Z", "tags": [], "attachment_id": null}, {"count": 13, "tags": [], "bug_id": 41246, "attachment_id": null, "is_private": false, "id": 157825, "time": "2012-04-10T22:43:58Z", "creator": "MaryAubaun@gmail.com", "creation_time": "2012-04-10T22:43:58Z", "text": "(In reply to comment #12)\n> Any chance that you could use the tools in org.apache.poi.hslf.dev to produce a\n> hex dump of your StyleTextPropAtoms? Ideally just the problematic one (you\n> might need to fetch all the records, and iterate through setting the text size\n> until you find the one that breaks)\n> \n> HSLF seems to have an idea on the number of parts that make up the style, and\n> it's running off the end part way through reading a style, so we need to get\n> the hex dump to work out why\n\nI may be able to figure that out, though I would need more help.  And I suspect it would then involve a lot of back and forth after that.\n\nNick, can I send you the file instead?"}, {"count": 14, "tags": [], "bug_id": 41246, "is_private": false, "text": "(In reply to comment #13)\n> I may be able to figure that out, though I would need more help.  And I suspect\n> it would then involve a lot of back and forth after that.\n> \n> Nick, can I send you the file instead?\n\nI'm a bit busy at work at the moment (paying customers and all that!), so I won't have a chance to look at it soon, sorry. Once of the other POI developers may do though. Another option is just to run the problem code in a debugger, and use that to grab out the header and rawContents of the StyleTextPropAtom that blows up", "id": 157827, "time": "2012-04-10T23:32:56Z", "creator": "apache@gagravarr.org", "creation_time": "2012-04-10T23:32:56Z", "attachment_id": null}, {"count": 15, "text": "(In reply to comment #12)\n> I'm a bit busy at work at the moment (paying customers and all that!), so I\n> won't have a chance to look at it soon, sorry. Once of the other POI developers\n> may do though.\n\nThanks, Nick.  I will see if any other developer comments, and will send the file to them.  In the meantime, I will run it through debug and see what I can find.", "bug_id": 41246, "is_private": false, "id": 157990, "time": "2012-04-12T15:16:13Z", "creator": "MaryAubaun@gmail.com", "creation_time": "2012-04-12T15:16:13Z", "tags": [], "attachment_id": null}, {"count": 16, "tags": [], "bug_id": 41246, "attachment_id": null, "is_private": false, "id": 171949, "time": "2013-12-27T23:57:15Z", "creator": "kiwiwings@apache.org", "creation_time": "2013-12-27T23:57:15Z", "text": "fixed with SVN ver r1553760.\n\nThe problem was/is that there are note references in the SlideListWithText(Notes) with no corresponding note record, i.e. the references point beyond the last record. The fix simply puts null records in the notesRecords list.\nSo user code which uses such malformed files have to check for null notes -\nit might be nicer to generate default note entries, but as this seems to be rare legacy problem, I've skipped the implementation for that ...\n\nApart of that rewriting the files works."}]