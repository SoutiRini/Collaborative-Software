[{"count": 0, "tags": [], "creator": "marco@morca.de", "attachment_id": null, "text": "hi there, \n \ni think the patch of bugreport \nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=32330 is not correct. \njspc get an error if i compile jsp's with struts-el tags like \n<html-el:option>. \nfollowing stacktrace is coming: \n  [jasper2] SCHWERWIEGEND: MessageResourcesFactory.createFactory \n  [jasper2] java.lang.ClassNotFoundException: \norg.apache.struts.util.PropertyMessageResourcesFactory \n  [jasper2]     at java.net.URLClassLoader$1.run(URLClassLoader.java:199) \n  [jasper2]     at java.security.AccessController.doPrivileged(Native Method) \n  [jasper2]     at java.net.URLClassLoader.findClass(URLClassLoader.java:187) \n  [jasper2]     at java.lang.ClassLoader.loadClass(ClassLoader.java:289) \n  [jasper2]     at java.lang.ClassLoader.loadClass(ClassLoader.java:235) \n  [jasper2]     at \norg.apache.struts.util.RequestUtils.applicationClass(RequestUtils.java:117) \n  [jasper2]     at \norg.apache.struts.util.MessageResourcesFactory.createFactory(MessageResourcesFactory.java:148) \n  [jasper2]     at \norg.apache.struts.util.MessageResources.getMessageResources(MessageResources.java:493) \n  [jasper2]     at \norg.apache.struts.taglib.html.BaseHandlerTag.<clinit>(BaseHandlerTag.java:64) \n  [jasper2]     at java.lang.Class.forName0(Native Method) \n  [jasper2]     at java.lang.Class.forName(Class.java:141) \n  [jasper2]     at \norg.apache.strutsel.taglib.html.ELLinkTagBeanInfo.class$(ELLinkTagBeanInfo.java:46) \n  [jasper2]     at \norg.apache.strutsel.taglib.html.ELLinkTagBeanInfo.getPropertyDescriptors(ELLinkTagBeanInfo.java:46) \n  [jasper2]     at \njava.beans.Introspector.getTargetPropertyInfo(Introspector.java:459) \n  [jasper2]     at java.beans.Introspector.getBeanInfo(Introspector.java:372) \n  [jasper2]     at java.beans.Introspector.getBeanInfo(Introspector.java:144) \n  [jasper2]     at \norg.apache.jasper.compiler.Generator$TagHandlerInfo.<init>(Generator.java:3684) \n  [jasper2]     at \norg.apache.jasper.compiler.Generator$GenerateVisitor.getTagHandlerInfo(Generator.java:2102) \n  [jasper2]     at \norg.apache.jasper.compiler.Generator$GenerateVisitor.visit(Generator.java:1583) \n  [jasper2]     at \norg.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1441) \n  [jasper2]     at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163) \n  [jasper2]     at \norg.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2213) \n  [jasper2]     at \norg.apache.jasper.compiler.Generator$GenerateVisitor.visit(Generator.java:1689) \n  [jasper2]     at \norg.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1441) \n  [jasper2]     at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163) \n  [jasper2]     at \norg.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2213) \n  [jasper2]     at \norg.apache.jasper.compiler.Node$Visitor.visit(Node.java:2219) \n  [jasper2]     at org.apache.jasper.compiler.Node$Root.accept(Node.java:456) \n  [jasper2]     at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163) \n  [jasper2]     at \norg.apache.jasper.compiler.Generator.generate(Generator.java:3272) \n  [jasper2]     at \norg.apache.jasper.compiler.Compiler.generateJava(Compiler.java:244) \n  [jasper2]     at \norg.apache.jasper.compiler.Compiler.compile(Compiler.java:470) \n  [jasper2]     at org.apache.jasper.JspC.processFile(JspC.java:805) \n  [jasper2]     at org.apache.jasper.JspC.execute(JspC.java:938) \n... \nin the source code of Jspc.java the finaly-block in the processFile method for \nresetting the classloader is wrong there. because \nit resets the classloader after the first file was processed. and any other \njsp's, that uses \nthe struts-el-tags (for example <html-el:option...) can not be compiled. i \nthink the finaly-block belongs \nto the end of the execute-method with following change: \n        } finally { \n            if(originalClassLoader != null) { \n                Thread.currentThread().setContextClassLoader(originalClassLoader); \n                loader = null; // set to null!! \n            } \n        } \nwhere originalClassLoader is declared as instance variable as: \nprivate ClassLoader originalClassLoader = null; \n \nwhat's your opinion? \n \nmarco", "id": 70375, "time": "2005-02-02T15:44:32Z", "bug_id": 33358, "creation_time": "2005-02-02T15:44:32Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 33358, "attachment_id": null, "id": 70754, "time": "2005-02-10T15:10:09Z", "creator": "remm@apache.org", "creation_time": "2005-02-10T15:10:09Z", "is_private": false, "text": "The bug is actually a duplicate of bug 33373.\n\n*** This bug has been marked as a duplicate of 33373 ***"}]