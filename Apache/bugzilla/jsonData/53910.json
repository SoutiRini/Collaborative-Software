[{"count": 0, "tags": [], "bug_id": 53910, "text": "Created attachment 29401\nPatch\n\nUsing a clean build of httpd-2.4.3, I'm seeing the following behavior:\n\n * Make a collection\n * Get its ETag with PROPFIND Depth=0\n * Add an item to the collection\n * httpd reports a new ETag for the collection at this point\n * Attempt a MOVE of the collection to a new name, predicated with the OLD ETag, using an \"If\" header of </src/> ([\"ETag\"])\n * Expect a precondition failure error\n\nI get a proper 412 precondition failure if the source and destination are \"/src/\" and \"/dst/\", but if I use percent escapes in the URLs the MOVE spuriously succeeds (for example, if I use \"/s%20r%20c/\" and \"/d%20s%20t/\".\n\nI've you'd like to see or try specifically my case, I've submitted a patch to litmus <http://lists.manyfish.co.uk/pipermail/litmus/2012-September/000344.html>.\n\nA possible patch to fix the problem is attached -- when parsing the If header, make sure to unescape the URI in the If header. dav_validate_resource_state() compare a resource URI (which was already unescaped) with a dav_if_header's URI (which was not unescaped while parsing the If header).", "id": 162309, "attachment_id": 29401, "creator": "tjw@omnigroup.com", "creation_time": "2012-09-21T04:58:20Z", "time": "2012-09-21T04:58:20Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 53910, "is_private": false, "text": "Some notes:\n\nIt isn't necessary for the resource being moved to be a collection; it can be a plain file as well and the bug is the same.\nThe bug is still in trunk/2.5 r1470683, and the patch still fixes it there.\nThe bug is still in 2.4.4, and the patch still fixes it there.", "id": 166773, "time": "2013-04-23T01:17:52Z", "creator": "wiml@omnigroup.com", "creation_time": "2013-04-23T01:17:52Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 53910, "is_private": false, "id": 166788, "attachment_id": null, "creator": "minfrin@sharp.fm", "creation_time": "2013-04-23T13:16:54Z", "time": "2013-04-23T13:16:54Z", "text": "Patch applied in http://svn.apache.org/r1470940."}, {"count": 3, "attachment_id": null, "creator": "minfrin@sharp.fm", "is_private": false, "id": 166896, "time": "2013-04-27T19:09:59Z", "bug_id": 53910, "creation_time": "2013-04-27T19:09:59Z", "tags": [], "text": "Can you verify whether trunk works for you?\n\nProposed for backport to v2.4."}, {"count": 4, "attachment_id": null, "creator": "wiml@omnigroup.com", "is_private": false, "id": 166948, "time": "2013-04-30T00:24:52Z", "bug_id": 53910, "creation_time": "2013-04-30T00:24:52Z", "tags": [], "text": "The change in r1470940 doesn't quite work --- the the call to ap_unescape_url() was moved to after the computation of uri_len, which ended up leaving dav_if_header->uri_len inconsistent.\n\nI assume the reason was to do ap_getparents() before unescaping? Doing the unescaping after ap_getparents() but before computing uri_len works."}, {"count": 5, "tags": [], "creator": "minfrin@sharp.fm", "attachment_id": null, "id": 166961, "time": "2013-04-30T14:11:44Z", "bug_id": 53910, "creation_time": "2013-04-30T14:11:44Z", "is_private": false, "text": "Fixed in r1477530, backport proposal updated."}, {"count": 6, "tags": [], "bug_id": 53910, "is_private": false, "id": 167375, "attachment_id": null, "creator": "minfrin@sharp.fm", "creation_time": "2013-05-23T13:17:53Z", "time": "2013-05-23T13:17:53Z", "text": "Proposed for backport to v2.2."}, {"text": "Backported to v2.4.5.", "tags": [], "bug_id": 53910, "attachment_id": null, "count": 7, "id": 167424, "time": "2013-05-26T19:43:57Z", "creator": "minfrin@sharp.fm", "creation_time": "2013-05-26T19:43:57Z", "is_private": false}, {"count": 8, "attachment_id": null, "creator": "christophe.jaillet@wanadoo.fr", "text": "Fixed and released in 2.2.25 and 2.4.5", "id": 177263, "time": "2014-08-19T08:29:04Z", "bug_id": 53910, "creation_time": "2014-08-19T08:29:04Z", "tags": [], "is_private": false}]