[{"count": 0, "attachment_id": 25997, "bug_id": 49890, "is_private": false, "id": 139732, "time": "2010-09-07T09:17:54Z", "creator": "andrey.timofeyev@gmail.com", "creation_time": "2010-09-07T09:17:54Z", "tags": [], "text": "Created attachment 25997\nNioEndpoint.java and simple web application\n\nsometimes ,server's cpu reaches 100%,and keep 100% all the time,until restart\nthe server.\nReproduced with java versions: 1.6.0_07,  1.6.0_18, 1.6.0_21.\n\nIt is duplicate of issue: Bug 46373.\nIt seams that Jetty guys fixed that problem: http://jira.codehaus.org/browse/JETTY-937?focusedCommentId=168060&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel.\nI added some logging to NioEndpoint.java. With this logging we can see that selector.select(timeout) sometimes return zero keys on linux plutform. And it is never reproduced on windows platform.\n\nIn the attach: \nNioEndpoint.7z - patched NioEndpoint.java (with logging)\nweb.7z - simple web application. To reproduce jvm bug we should do several requests(we can just press F5 in browser and hold button) to web application."}, {"count": 1, "tags": [], "bug_id": 49890, "is_private": false, "text": "I've just spent a couple of hours hammering a Linux box with JMeter and have been unable to reproduce this. From reading the various links it looks like the latest JVM + latest Linux (I was using a fully patched Ubuntu 10.04 instance) should have fixed this.\n\nI'll look at adding some additional logging in Tomcat 7 in case this does still occur. I'm leaning toward leaving the Tomcat 6 code as is.", "id": 140367, "time": "2010-10-01T10:25:01Z", "creator": "markt@apache.org", "creation_time": "2010-10-01T10:25:01Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 49890, "is_private": false, "text": "Given that a) I can't reproduce this and b) everything I have read suggests this is fixed for kernel >= 2.6 and JVM >= 1.6.0u18 then I am going to close this as WONTFIX (since there isn't a won't provide a workaround) resolution.\n\nWhat I have done is added some logging to Tomcat 7 so if folks hit this bug with a kernel and jvm version where it is meant to be fixed, hopefully they will add some version info to this bug and re-open it.\n\nI'll note that without the ability to reproduce this, then fixing it is going to be very difficult.", "id": 140373, "time": "2010-10-01T10:59:15Z", "creator": "markt@apache.org", "creation_time": "2010-10-01T10:59:15Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "markt@apache.org", "text": "I've had to back out the logging as it was triggered very frequently on Windows and had a significant negative (orders of magnitude) performance impact during testing.\n\nIf this is reproducible with current jvm + current kernel then we'll take another look but my current understanding is with current jvm + current kernel this issue is resolved.", "id": 140387, "time": "2010-10-02T13:59:19Z", "bug_id": 49890, "creation_time": "2010-10-02T13:59:19Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 49890, "attachment_id": null, "text": "Hmmm.. very strange.\nDid you try to reproduce high CPU usage or just logging?\nAs i understand from many links, this isue is fixed partially. Sun fixed this issue several times. And as a result this issue reproduced more rare.\nBut i can reproduce logging on linux. \nAnd somtimes (one time a month) we get higth CPU usage.\nAnd people has the same problems e.g. (http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6403933).\nIt seams that Sun never vix this issue complitly.\n\nOur environment:\nKernel version: 2.6.28.2\nJava: 1.6.0_21", "id": 140424, "time": "2010-10-04T04:01:04Z", "creator": "andrey.timofeyev@gmail.com", "creation_time": "2010-10-04T04:01:04Z", "is_private": false}, {"count": 5, "tags": [], "text": "(In reply to comment #4)\n> Did you try to reproduce high CPU usage or just logging?\nBoth. I was unable to reproduce the high CPU usage.\n\n> But i can reproduce logging on linux.\nThe logging causes more problems than it fixes.\n\n> And somtimes (one time a month) we get higth CPU usage.\n> And people has the same problems e.g.\n> (http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6403933).\n> It seams that Sun never vix this issue complitly.\n\nWithout some additional information that enables some more targeted debug logging that gets us closer to a fix/workaround, this is going to remain WONTFIX.", "attachment_id": null, "id": 140427, "creator": "markt@apache.org", "time": "2010-10-04T05:34:03Z", "bug_id": 49890, "creation_time": "2010-10-04T05:34:03Z", "is_private": false}, {"count": 6, "tags": [], "text": "Thank you for your time.\nI'll try Tomcat 7 with Ubuntu 10.04.", "attachment_id": null, "id": 140445, "creator": "andrey.timofeyev@gmail.com", "time": "2010-10-04T10:42:58Z", "bug_id": 49890, "creation_time": "2010-10-04T10:42:58Z", "is_private": false}]