[{"count": 0, "tags": [], "bug_id": 53184, "text": "Created attachment 28717\nDate formatting code changes as well as improved coverage of test cases\n\nBoth FOP and XGC projects had an identical method which formatted dates. This patch looks to tidy up this code and have a single utility class which can be used in XGC and referenced by FOP.", "id": 158787, "time": "2012-05-03T14:23:23Z", "creator": "rmeyer@hotmail.co.uk", "creation_time": "2012-05-03T14:23:23Z", "is_private": false, "attachment_id": 28717}, {"count": 1, "attachment_id": null, "creator": "gadams@apache.org", "is_private": false, "id": 158790, "time": "2012-05-03T15:35:05Z", "bug_id": 53184, "creation_time": "2012-05-03T15:35:05Z", "tags": [], "text": "please file an ICLA per [1] and i'll apply the patch; thanks\n\n[1] http://www.apache.org/licenses/icla.txt"}, {"text": "Hi Robert, Glenn,\n\nICLA has been received by the Apache Secretary: http://people.apache.org/committer-index.html\n\nThanks,\n\nChris", "tags": [], "bug_id": 53184, "is_private": false, "count": 2, "id": 158825, "time": "2012-05-04T13:15:42Z", "creator": "bowditch_chris@hotmail.com", "creation_time": "2012-05-04T13:15:42Z", "attachment_id": null}, {"text": "Hi Glenn, Chris,\n\nI was just about to post the fact I received the e-mail, but Chris just got there before me. Please let me know if there is anything else you need from me.\n\nBest Regards,\n\nRobert Meyer", "tags": [], "bug_id": 53184, "is_private": false, "count": 3, "id": 158826, "time": "2012-05-04T13:22:27Z", "creator": "rmeyer@hotmail.co.uk", "creation_time": "2012-05-04T13:22:27Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 53184, "text": "(In reply to comment #3)\n> Hi Glenn, Chris,\n> \n> I was just about to post the fact I received the e-mail, but Chris just got\n> there before me. Please let me know if there is anything else you need from\n> me.\n> \n> Best Regards,\n> \n> Robert Meyer\n\ntest testDateFormattingISO8601 fails in the second assert below\n\nString s = XMPSchemaAdapter.formatISO8601Date(dt, TimeZone.getTimeZone(\"GMT\"));\nassertEquals(\"2008-02-07T15:11:07Z\", s);\nassertEquals(dt, DateFormatUtil.parseISO8601Date(s));\n\nwith the following output\n\nTestcase: testDateFormattingISO8601 took 0.01 sec\n        FAILED\nexpected:<Thu Feb 07 07:11:07 PST 2008> but was:<Thu Feb 07 15:11:07 PST 2008>\njunit.framework.AssertionFailedError: expected:<Thu Feb 07 07:11:07 PST 2008> but was:<Thu Feb 07 15:11:07 PST 2008>\n        at org.apache.xmlgraphics.util.DateFormatUtilTestCase.testDateFormattingISO8601(DateFormatUtilTestCase.java:45)\n\ni am running on MacOS X 10.6.8 and my current time zone is -8:00 (US/PDT)", "id": 158830, "time": "2012-05-04T16:13:22Z", "creator": "gadams@apache.org", "creation_time": "2012-05-04T16:13:22Z", "is_private": false, "attachment_id": null}, {"text": "I am running the build on my home Windows machine and am getting failing tests also, whereas the code was written, compiled and successfully passed the test suite on my work Linux PC. I have spent several hours on it this evening but have failed to identify and resolve the issue. I initially suspected that it was because the date being formatted in the string wasn't including the offset, but am still getting failing tests even with numerous changes and consulting the existing code. I will resume my investigation once I get back in the office which due to the bank holiday will now be Tuesday.", "tags": [], "bug_id": 53184, "is_private": false, "count": 5, "id": 158840, "time": "2012-05-05T00:28:45Z", "creator": "rmeyer@hotmail.co.uk", "creation_time": "2012-05-05T00:28:45Z", "attachment_id": null}, {"count": 6, "attachment_id": null, "creator": "vhennebert@gmail.com", "text": "Try changing line 144 of DateFormatUtil.java from:\nString dateFormat = (date.contains(\"Z\")) ? \"'Z'\" : \"Z\";\nto\nString dateFormat = (date.contains(\"Z\")) ? \"+0000\" : \"Z\";\n\nI suppose that contrary to Linux, Mac and Windows systems assume local time when no time zone information is present in the date to parse.\n\nHTH,\nVincent", "id": 158903, "time": "2012-05-08T09:58:18Z", "bug_id": 53184, "creation_time": "2012-05-08T09:58:18Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "bug_id": 53184, "is_private": false, "text": "(In reply to comment #6)\nSorry, managed to confuse myself. The pattern should always have a \"Z\" (unquoted), and the date to parse should be modified if it contains a 'Z'. In formatDateToParse:\n\nif (date.contains(\"Z\")) {\n    date = date.replace(\"Z\", \"+0000\");\n} else {\n    /* the current code */\n}\n\nSomething like that.\n\nVincent", "id": 158904, "time": "2012-05-08T13:18:44Z", "creator": "vhennebert@gmail.com", "creation_time": "2012-05-08T13:18:44Z", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 53184, "attachment_id": 28742, "text": "Created attachment 28742\nFix for existing patch code failing on Junit test\n\nThanks Vincent. After reading your first comment I came up with a near identical solution to your second comment and have now submitted this against the patch.", "id": 158906, "time": "2012-05-08T15:34:59Z", "creator": "rmeyer@hotmail.co.uk", "creation_time": "2012-05-08T15:34:59Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 53184, "is_private": false, "text": "I have now changed the bug state bakc to NEW from NEEDINFO", "id": 158921, "time": "2012-05-09T09:54:18Z", "creator": "rmeyer@hotmail.co.uk", "creation_time": "2012-05-09T09:54:18Z", "attachment_id": null}, {"count": 10, "attachment_id": null, "creator": "gadams@apache.org", "text": "patch applied at http://svn.apache.org/viewvc?rev=1336053&view=rev\n\nthanks Robert! please verify and close this bug if satisfied", "id": 158923, "time": "2012-05-09T10:14:28Z", "bug_id": 53184, "creation_time": "2012-05-09T10:14:28Z", "tags": [], "is_private": false}, {"count": 11, "tags": [], "bug_id": 53184, "attachment_id": null, "is_private": false, "id": 158925, "time": "2012-05-09T12:16:11Z", "creator": "gadams@apache.org", "creation_time": "2012-05-09T12:16:11Z", "text": "(In reply to comment #8)\n> Created attachment 28742 [details]\n> Fix for existing patch code failing on Junit test\n> \n> Thanks Vincent. After reading your first comment I came up with a near\n> identical solution to your second comment and have now submitted this\n> against the patch.\n\npossible problem: ISO/IEC 32000:2008 Section 7.9.4 (aka PDF 1.7) specifies\n\nA date shall be a text string of the form\n\n(D:YYYYMMDDHHmmSSOHH'mm)\n\nnote that there is no delimiter after the mm field of the GMT offset; i notice your code adds a delimiter"}, {"text": "Hi Glenn,\n\nThe code I submitted has not changed the output from the existing method as that also included a delimiter after the date:\n\n    //Taken from PDFInfo.java in FOP\n\n    protected String formatDateTime(Date time, TimeZone tz) {\n        ...\n            sb.append(Integer.toString(offsetMinutes));\n            sb.append('\\'');\n        ...\n    }\n\n\nReading Luis's comment on the existing patch I put submitted:\n\n\"Now, regarding the last ' after minutes, the third edition (1.4) spec says it\nshould be there while the 3200-1:2008 says it shouldn't... I had never noticed\nit until now....\"\n\nAfter talking to Vincent, he suggested that FOP follows PDF specification 1.4, but I am certainly willing to change the patch to meet the latest specification if required.", "tags": [], "bug_id": 53184, "is_private": false, "count": 12, "id": 158927, "time": "2012-05-09T13:25:03Z", "creator": "rmeyer@hotmail.co.uk", "creation_time": "2012-05-09T13:25:03Z", "attachment_id": null}, {"count": 13, "tags": [], "bug_id": 53184, "attachment_id": null, "is_private": false, "id": 158928, "time": "2012-05-09T13:34:03Z", "creator": "pascal.sancho@takoma.fr", "creation_time": "2012-05-09T13:34:03Z", "text": "(In reply to comment #12)\n> After talking to Vincent, he suggested that FOP follows PDF specification\n> 1.4, but I am certainly willing to change the patch to meet the latest\n> specification if required.\n\nNote that there is a new option config (see [1]):\n  renderer[@mime=\"application/pdf\"]/version\n\nThis should be taken into account if format is version dependent.\n\n[1] http://xmlgraphics.apache.org/fop/trunk/configuration.html#pdf-renderer"}, {"count": 14, "attachment_id": null, "creator": "rmeyer@hotmail.co.uk", "text": "> Note that there is a new option config (see [1]):\n>   renderer[@mime=\"application/pdf\"]/version\n> \n> This should be taken into account if format is version dependent.\n> \n> [1] http://xmlgraphics.apache.org/fop/trunk/configuration.html#pdf-renderer\n\nI agree with what you are both saying and it would be beneficial to implement such a change in the future. I will open a new ticket for this as I feel the current patch has fulfilled its original purpose.", "id": 158929, "time": "2012-05-09T15:05:03Z", "bug_id": 53184, "creation_time": "2012-05-09T15:05:03Z", "tags": [], "is_private": false}, {"count": 15, "tags": [], "bug_id": 53184, "attachment_id": null, "text": "I have verified the code and will now close the issue. A new ticket (53208) been created relating to support for PDF Reference 1.7.", "id": 158931, "time": "2012-05-09T15:31:21Z", "creator": "rmeyer@hotmail.co.uk", "creation_time": "2012-05-09T15:31:21Z", "is_private": false}, {"count": 16, "tags": [], "bug_id": 53184, "is_private": false, "text": "(In reply to comment #15)\n> I have verified the code and will now close the issue. A new ticket (53208)\n> been created relating to support for PDF Reference 1.7.\n\nsounds good", "id": 158932, "time": "2012-05-09T15:36:05Z", "creator": "gadams@apache.org", "creation_time": "2012-05-09T15:36:05Z", "attachment_id": null}]