[{"count": 0, "tags": [], "creator": "lianggt08@sei.pku.edu.cn", "text": "The fix revision 1171628 was aimed to remove an NPE bug on the  \"nameIdChunks \" in the method \"set7BitEncoding\" of the file \"/poi/trunk/src/scratchpad/src/org/apache/poi/hsmf/MAPIMessage.java\" , but it is incomplete. \nSince the \"nameIdChunks \" could be null during the run-time execution, its value should also be null-checked before being dereferenced in other methods. \n\nThe buggy code locations the same fix needs to be applied at are as bellows: \n \nLine 454 of the method \"has7BitEncodingStrings()\".\n\n\n\npublic boolean has7BitEncodingStrings() {\n      for(Chunk c : mainChunks.getAll()) {\n         if(c instanceof StringChunk) {\n            if( ((StringChunk)c).getType() == Types.ASCII_STRING ) {\n               return true;\n            }\n         }\n      }\n[Line 454]      for(Chunk c : nameIdChunks.getAll()) {\n         if(c instanceof StringChunk) {\n            if( ((StringChunk)c).getType() == Types.ASCII_STRING ) {\n               return true;\n            }\n         }\n      }\n      for(RecipientChunks rc : recipientChunks) {\n         for(Chunk c : rc.getAll()) {\n            if(c instanceof StringChunk) {\n               if( ((StringChunk)c).getType() == Types.ASCII_STRING ) {\n                  return true;\n               }\n            }\n         }\n      }\n      return false;\n   }", "id": 153773, "time": "2012-02-14T10:08:46Z", "bug_id": 52664, "creation_time": "2012-02-14T10:08:46Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 52664, "attachment_id": null, "text": "nameIdChunks seems to already be null checked:\n\n      if (nameIdChunks!=null) {\n         for(Chunk c : nameIdChunks.getAll()) {\n            if(c instanceof StringChunk) {\n                ((StringChunk)c).set7BitEncoding(charset);\n            }\n         }\n      }\n\nIs something else needed, or does this problem refer to an older version of POI?", "id": 153781, "time": "2012-02-14T12:58:22Z", "creator": "apache@gagravarr.org", "creation_time": "2012-02-14T12:58:22Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 52664, "text": "You have checked a wrong code location. Please check the line 454 of the method \"has7BitEncodingStrings\", not the method \"set7BitEncoding\". \n\n\nLine 454 of the method \"has7BitEncodingStrings()\".\n\n\n\npublic boolean has7BitEncodingStrings() {\n      for(Chunk c : mainChunks.getAll()) {\n         if(c instanceof StringChunk) {\n            if( ((StringChunk)c).getType() == Types.ASCII_STRING ) {\n               return true;\n            }\n         }\n      }\n[Line 454]      for(Chunk c : nameIdChunks.getAll()) {\n         if(c instanceof StringChunk) {\n            if( ((StringChunk)c).getType() == Types.ASCII_STRING ) {\n               return true;\n            }\n         }\n      }\n      for(RecipientChunks rc : recipientChunks) {\n         for(Chunk c : rc.getAll()) {\n            if(c instanceof StringChunk) {\n               if( ((StringChunk)c).getType() == Types.ASCII_STRING ) {\n                  return true;\n               }\n            }\n         }\n      }\n      return false;\n   }", "id": 153795, "attachment_id": null, "creator": "lianggt08@sei.pku.edu.cn", "creation_time": "2012-02-15T05:54:35Z", "time": "2012-02-15T05:54:35Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 52664, "text": "Thanks, fixed in r1244449.", "id": 153806, "attachment_id": null, "creator": "apache@gagravarr.org", "creation_time": "2012-02-15T11:47:21Z", "time": "2012-02-15T11:47:21Z", "is_private": false}]