[{"count": 0, "attachment_id": 25551, "bug_id": 49406, "is_private": false, "id": 137451, "time": "2010-06-08T13:59:07Z", "creator": "ef-lists@email.de", "creation_time": "2010-06-08T13:59:07Z", "tags": [], "text": "Created attachment 25551\nPatch for the bug described\n\nmod_fcgid may overwrite heap data in some rare cases.\n\nIn fcgid_bucket.c (Revision 816972 - current trunk):\nhttp://svn.apache.org/viewvc/httpd/mod_fcgid/trunk/modules/fcgid/fcgid_bucket.c?revision=816972&view=markup\n\nThe pointer arithmetic in line 99 should be bytewise but isn't. In the rare case that \"hasread\" is != 0, the heap gets trashed, causing at least segfaults.\n\nFound this by fuzzing."}, {"count": 1, "tags": [], "creator": "thijsputman@gmail.com", "attachment_id": null, "is_private": false, "id": 137521, "time": "2010-06-10T04:11:22Z", "bug_id": 49406, "creation_time": "2010-06-10T04:11:22Z", "text": "Could it be that I'm experiencing this issue in the wild?\n\nEver since upgrading to Apache 2.2.1.5 I'm experiencing an infrequent crash (one or two times a month) of the httpd process. Always exception code 0xc0000005 (access violation) in module mod_fcgid.so with fault offset 0x00004ac2.\n\nRunning Apache/2.2.15 (Win32) mod_ssl/2.2.15 OpenSSL/0.9.8o mod_fcgid/2.3.5 on Windows Server 2008 (x64)."}, {"count": 2, "tags": [], "creator": "wrowe@apache.org", "attachment_id": null, "is_private": false, "id": 137544, "time": "2010-06-10T10:59:32Z", "bug_id": 49406, "creation_time": "2010-06-10T10:59:32Z", "text": "Thijs, can you look at http://httpd.apache.org/dev/debugging.html - I recall that\nDr Watson is dropped so it might be necessary to install windbg to gather the\ncrash dump of your fault.  It's possible but also equally like to be another\nbug hiding in the code."}, {"count": 3, "tags": [], "bug_id": 49406, "text": "This issue was actually a stack overwrite instead of a heap overwrite, and was assigned CVE-2010-3872.\n\nIt was fixed in mod_fcgid 2.3.6", "id": 141894, "time": "2010-11-21T16:11:35Z", "creator": "trawick@apache.org", "creation_time": "2010-11-21T16:11:35Z", "is_private": false, "attachment_id": null}]