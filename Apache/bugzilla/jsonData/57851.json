[{"count": 0, "tags": [], "bug_id": 57851, "is_private": false, "id": 182593, "attachment_id": 32682, "creator": "losiu99@gazeta.pl", "creation_time": "2015-04-23T11:28:09Z", "time": "2015-04-23T11:28:09Z", "text": "Created attachment 32682\nProblematic file\n\nConstructor of NPOIFSFileSystem throws NPE when given an input stream to a file created by slightly modifying valid MSG file.\n\n@Test\npublic void shouldNotThrowNPE() throws IOException {\n    InputStream input = ClassLoader.getSystemResourceAsStream(\"corrupted.msg\");\n    new NPOIFSFileSystem(input);\n}\n\nResulting stack trace (removed JUnit frames):\n\njava.lang.NullPointerException\n\tat org.apache.poi.poifs.property.DirectoryProperty.addChild(DirectoryProperty.java:256)\n\tat org.apache.poi.poifs.property.PropertyTableBase.populatePropertyTree(PropertyTableBase.java:115)\n\tat org.apache.poi.poifs.property.PropertyTableBase.populatePropertyTree(PropertyTableBase.java:118)\n\tat org.apache.poi.poifs.property.PropertyTableBase.<init>(PropertyTableBase.java:63)\n\tat org.apache.poi.poifs.property.NPropertyTable.<init>(NPropertyTable.java:66)\n\tat org.apache.poi.poifs.filesystem.NPOIFSFileSystem.readCoreContents(NPOIFSFileSystem.java:416)\n\tat org.apache.poi.poifs.filesystem.NPOIFSFileSystem.<init>(NPOIFSFileSystem.java:324)\n\tat pl.edu.agh.seeker.extractor.mail.MsgExtractorTest.shouldNotThrowNPE(MsgExtractorTest.java:24)\n\nThe culprit seems to be org.apache.poi.poifs.property.PropertyFactory.convertToProperties, which adds null to the list of properties upon encountering unrecognized property type."}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "Thanks for the investigation and the small test file! Fixed in r1675702.", "id": 182600, "time": "2015-04-23T18:35:55Z", "bug_id": 57851, "creation_time": "2015-04-23T18:35:55Z", "is_private": false}]