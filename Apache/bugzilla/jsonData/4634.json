[{"count": 0, "attachment_id": null, "creator": "peterwlynch@yahoo.com", "is_private": false, "id": 7519, "time": "2001-11-04T13:12:59Z", "bug_id": 4634, "creation_time": "2001-11-04T13:12:59Z", "tags": [], "text": "Specifying a zero length string as the begin token and end token in a filterset \nused in a copy task will hang Ant.\n\nAdd the below xml to a build file, and add the appropriate files:\n\n<copy file=\"./test.file\"\n    tofile=\"./output\">\n    <filterset begintoken=\"\" endtoken=\"\">\n\t<filtersfile file=\"./test.properties\"/>\n    </filterset>\n</copy>\n\n\nAnt will reach this line:\n\nReading filters from /home/foo/test.properties\n     [copy] Copying 1 file to /home/foo\n     [copy] Copying /home/foo/test.file to /home/foo/output\n\nand then hang indefinitley.\n\nOne or both tokenmarkers can be set to \"\" to reproduce the bug.\n\n\nExpected behavior:\nI guess I was expecting Ant to not use the default @ token markers and instead \njust replace the token without using any markers to find it in the file.I'd \nprefer this than changing the behavior to use the default token markers if the \ntoken markers are zero length strings.\n\nThis gives flexibility in replacing tokens themselves:\n\n@TEST_TOKEN@ could be changed to @NEW_TEST_TOKEN@ for example.\n\n\nRegardless, Ant shouldn't hang. :-("}, {"count": 1, "tags": [], "creator": "peterwlynch@yahoo.com", "attachment_id": null, "id": 7520, "time": "2001-11-04T17:23:35Z", "bug_id": 4634, "creation_time": "2001-11-04T17:23:35Z", "is_private": false, "text": "So far I have determined that the replaceTokens method of the FilterSet type \nhas a bug relating to the way it handles indexOf looking for a token marker.\n\nIf the token is an empty string, then that will return zero from indexOf. The \nsame as if the begintoken marker was at the beginning of a line of text. \nChecking for index > -1 alone therefore will not suffice. :-(\n"}, {"count": 2, "tags": [], "bug_id": 4634, "is_private": false, "text": "The easiest solution is to prevent zero length begin and end tokens from being \nset...., don't know if that is what was intended or not.\n\nCorrection in the inital description: if the begintoken is set to something \nother than zero length, there is no hang. ( endless loop )", "id": 7524, "time": "2001-11-05T01:46:21Z", "creator": "peterwlynch@yahoo.com", "creation_time": "2001-11-05T01:46:21Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "is_private": false, "id": 7865, "time": "2001-11-13T07:11:18Z", "bug_id": 4634, "creation_time": "2001-11-13T07:11:18Z", "text": "I think it is intended behavior, that tokens must not be empty - even if it only\nwas for performance reasons.  Use <replace> in the case of no delimiters.\n\nNightly build 2001-11-14 will not allow empty tokens to be set."}]