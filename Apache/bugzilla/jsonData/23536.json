[{"count": 0, "tags": [], "text": "The problem is same bug 23269, but I have some addition fact to that bug.\nThis problem occures only when Tomcat installed to path with spaces\n(e.g. C:\\Program Files\\...).\nIn log I see, what javac.exe incorrectly understood\nthe absolute path to servlet generated from jsp page:\n2001-09-30 20:37:44 Error compiling file: D:\\Tom \ncat\\work\\Standalone\\localhost\\cocoon\\samples\\jsp\\/welcome_jsp.java     [javac] \nCompiling 1 source file\n    [javac] javac: invalid flag: D:\\Tom\n    [javac] Usage: javac <options> <source files>\n    [javac] where possible options include:\n    [javac]   -g                        Generate all debugging info\n...................................\nBut without Cocoon all ok!\n\nIf Tomcat installed to path without spaces - C:\\Tomcat\\.., for example, all ok.\n\nI partially analyzed source code of Tomcat 4.1.27 (last stable, not beta)\nand Cocoon and found next:\nin file org\\apache\\jasper\\compiler\\Compiler.java lines 317 .. 323:\n            if (ctxt.getOptions().getFork()) {\n                javac.execute();\n            } else {\n                synchronized(javacLock) {\n                    javac.execute();\n                }\n            }\n\nIn Cocoon the fork parameter setting ingnores, and always run block without\n'synchronized'.\nThen I commented fork analyze:\n        javac.setFork( false );\n         .....................\n\n                synchronized(javacLock) {\n                    javac.execute();\n                }\n\nRebuild jasper, install it, run - all Ok, without spaces in path and with them.\n\nI tryed to correct Cocoon 2.1.1 - in file \norg\\apache\\cocoon\\components\\jsp\\JSPEngineImpl.java\nwrite next:\n      synchronized ( lockObject )\n       {\n         jsp.service ( request, response );        // fail here!\n       }\n- No effect.\n\nIs this Jasper problem, or Cocoon, or Ant?\n\nIn Tomcat 4.0.4, which not use Ant for compilation, I don't\ndetect this error. But my application requires Tomcat 4.1.27.", "is_private": false, "id": 44920, "creator": "paveln@imail.dc.ukrtelecom.net", "time": "2003-10-01T05:01:25Z", "bug_id": 23536, "creation_time": "2003-10-01T05:01:25Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "joerg.heinicke@gmx.de", "is_private": false, "text": "I might be not that familiar with Java, but this description sounds a bit\ntangled up. So please correct me, if I'm wrong:\n\n1.\n> 2001-09-30 20:37:44 Error compiling file: D:\\Tom \n> cat\\work\\Standalone\\localhost\\cocoon\\samples\\jsp\\/welcome_jsp.java     [javac] \n> Compiling 1 source file\n>     [javac] javac: invalid flag: D:\\Tom\n>     [javac] Usage: javac <options> <source files>\n>     [javac] where possible options include:\n>     [javac]   -g                        Generate all debugging info\n> ...................................\n> But without Cocoon all ok!\n> \n> If Tomcat installed to path without spaces - C:\\Tomcat\\.., for example, all ok.\n\nYou said when using path without spaces everything is ok. But the above path IS\nwithout spaces. Or do you have it installed at \"C:\\Tom cat\" ???\n\n2. Forking. If Cocoon does not force Tomcat to fork for compiling the JSP, how\nshould this be bad, if Tomcat has both options? Ok, there could be a bug in\nTomcat when the JVM is not forked.\n\n3. Synchronized. As far as I know this is for serializing the block execution,\nso that it can't be executed parallelly. I simply guess that you aren't\nrequesting the JSP multiple times in parallel. So how should the synchronized\nhave any influence? Shell the JSP be compiled multiple times? Ok, there are\nincludes and forwards. More important: How should this be related to path names? \n\nAt the mentioned bug 23269 the reporter hasn't been providing the root cause for\nthe failure until now, so we can't do anything. At least the last time I tried\neverything was ok with the sample JSPs in Cocoon. I'm using Tomcat 4.1.24.\n\nJoerg", "id": 44921, "time": "2003-10-01T06:11:48Z", "bug_id": 23536, "creation_time": "2003-10-01T06:11:48Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 23536, "attachment_id": null, "text": "> Or do you have it installed at \"C:\\Tom cat\" ???\nNot in \"C:\\Tom cat\", but to standard catalog in Windows OS:\n\"C:\\Program Files\\...\", with spaces too.\n\nAbout forking. This is only fact. \nApplications without Cocoon works alwayls normally, independently from fork \nsetting. All problems only in Cocoon.\n\nSynchronize.\nMy application in development, so my browser is SINGLE (!!) client. But error \noccures. My JSP pages doesn't have any includes or forwards.\nI tryed leave Cocoon single web app, but no effect. I inserted debug output to \nJasper - paths ALWAYS absolute (with spaces)! In Cocoon and without it.\n\nI don't have Tomcat 4.1.24 - there is only 4.1.27 and 5 beta on there site.\n:((\n", "id": 44935, "time": "2003-10-01T10:12:23Z", "creator": "paveln@imail.dc.ukrtelecom.net", "creation_time": "2003-10-01T10:12:23Z", "is_private": false}, {"count": 3, "tags": [], "creator": "joerg.heinicke@gmx.de", "text": "1. directories\n> Not in \"C:\\Tom cat\", but to standard catalog in Windows OS:\n> \"C:\\Program Files\\...\", with spaces too.\n\nBut the error output above has the lines\n\n> 2001-09-30 20:37:44 Error compiling file: D:\\Tom \n> cat\\work\\Standalone\\localhost\\cocoon\\samples\\jsp\\/welcome_jsp.java     [javac] \n> Compiling 1 source file\n>     [javac] javac: invalid flag: D:\\Tom\n\nAt least Cocoon does not absolutize the paths *against the file system*. It\ngives the absolute paths *against the servlet context* to the JSP engine. The\nrest is Tomcat's work.\n\n\nCan anyone of the Tomcat guys jump in?\n\nJoerg", "id": 44937, "time": "2003-10-01T10:59:25Z", "bug_id": 23536, "creation_time": "2003-10-01T10:59:25Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "text": ">At least Cocoon does not absolutize the paths *against the file system*. It\n>gives the absolute paths *against the servlet context* to the JSP engine. The\n>rest is Tomcat's work.\n\nI agree, this is a Tomcat (jasper) problem. I will write about this to Tomcat's \nbugzilla.\nThanks.", "is_private": false, "id": 44939, "creator": "paveln@imail.dc.ukrtelecom.net", "time": "2003-10-01T11:34:28Z", "bug_id": 23536, "creation_time": "2003-10-01T11:34:28Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 23536, "text": "\"fork\" is configured in conf/web.xml in Tomcat.\n- \"true\": low resource leak inside the server VM (good in production).\n- \"false\": no command line generation bugs (maybe it's an Ant issue, but I don't\nthink you can make complex command lines work reliably on Windows), but good in\nproduction.\nObviously the best production setting is to precompile the JSPs.", "id": 44940, "attachment_id": null, "creator": "remm@apache.org", "creation_time": "2003-10-01T11:44:59Z", "time": "2003-10-01T11:44:59Z", "is_private": false}, {"count": 6, "attachment_id": null, "bug_id": 23536, "text": "resetting the assigner", "id": 44949, "time": "2003-10-01T13:22:59Z", "creator": "joerg.heinicke@gmx.de", "creation_time": "2003-10-01T13:22:59Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "bug_id": 23536, "text": "Please do not reopen the report.", "id": 44950, "attachment_id": null, "creator": "remm@apache.org", "creation_time": "2003-10-01T13:25:04Z", "time": "2003-10-01T13:25:04Z", "is_private": false}, {"count": 8, "attachment_id": null, "bug_id": 23536, "is_private": false, "id": 44951, "time": "2003-10-01T13:28:54Z", "creator": "joerg.heinicke@gmx.de", "creation_time": "2003-10-01T13:28:54Z", "tags": [], "text": "Sorry, but without reopening it's not possible to reset the assigner.\n\nTo the bug:\nWhy INVALID? The bug is especially about handling spaces in the path. I don't\nknow how valid the bug report is, but you should at least react on this issue.\n\nI'm away, it's now completely a Tomcat issue ;-)\n\nJoerg"}, {"count": 9, "tags": [], "text": "I reopened the bug.\nError occurs in Jasper/Ant.", "is_private": false, "id": 44976, "creator": "paveln@imail.dc.ukrtelecom.net", "time": "2003-10-02T04:56:43Z", "bug_id": 23536, "creation_time": "2003-10-02T04:56:43Z", "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 23536, "text": "Replace Ant in Tomcat catalogs to 1.6beta1+ - no error!", "id": 45072, "attachment_id": null, "creator": "paveln@imail.dc.ukrtelecom.net", "creation_time": "2003-10-04T09:33:28Z", "time": "2003-10-04T09:33:28Z", "is_private": false}]