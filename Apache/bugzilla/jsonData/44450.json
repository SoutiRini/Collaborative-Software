[{"count": 0, "tags": [], "bug_id": 44450, "text": "Also added a very basic implementation of LOOKUP and refactored much code in \nMATCH.\n\nTwo files added in 44403 were also added in this patch \nEvaluationException.java  OperandResolver.java.  The content is identical.\n\nOne file modified in 44449 (ValueRecordsAggregate.java) has a 'hack' of that \nsame bug-fix made in this patch.  The version from patch 44449 is much better.\n\nNew junit TestLookupFunctionsFromSpreadsheet and a dedicated test data \nspreadsheet were added to test specific behaviour of these test cases more \nthoroughly.", "id": 113870, "time": "2008-02-18T23:20:50Z", "creator": "josh@apache.org", "creation_time": "2008-02-18T23:20:50Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "josh@apache.org", "attachment_id": 21556, "text": "Created attachment 21556\nsvn diff of 8 modified files", "id": 113871, "time": "2008-02-18T23:25:17Z", "bug_id": 44450, "creation_time": "2008-02-18T23:25:17Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 44450, "text": "Created attachment 21557\ntar bz2 of 5 new files (2 identical to those added in patch 44403)", "id": 113872, "time": "2008-02-18T23:26:37Z", "creator": "josh@apache.org", "creation_time": "2008-02-18T23:26:37Z", "is_private": false, "attachment_id": 21557}, {"count": 3, "tags": [], "bug_id": 44450, "attachment_id": null, "id": 113961, "time": "2008-02-21T08:02:17Z", "creator": "apache@gagravarr.org", "creation_time": "2008-02-21T08:02:17Z", "is_private": false, "text": "This is blowing up for me, on test\norg.apache.poi.hssf.record.formula.functions.TestLookupFunctionsFromSpreadsheet\n\n    [junit] Testcase: testFunctionsFromTestSpreadsheet took 1.284 sec\n    [junit]     FAILED\n    [junit] 5 sheets(s) failed with 68 evaluation(s).  There were 0 successful\nsheets(s) and 1 function(s) without error\n    [junit] junit.framework.AssertionFailedError: 5 sheets(s) failed with 68\nevaluation(s).  There were 0 successful sheets(s) and 1 function(s) without error\n    [junit]     at\norg.apache.poi.hssf.record.formula.functions.TestLookupFunctionsFromSpreadsheet.testFunctionsFromTestSpreadsheet(TestLookupFunctionsFromSpreadsheet.java:216)\n\nI'll attach a svn diff so you can see what I have and haven't applied. Any\nchance you could spot what's gone wrong?"}, {"count": 4, "tags": [], "bug_id": 44450, "text": "Created attachment 21574\nSvn patch showing what was applied vs trunk when the tests failed", "id": 113962, "time": "2008-02-21T08:03:21Z", "creator": "apache@gagravarr.org", "creation_time": "2008-02-21T08:03:21Z", "is_private": false, "attachment_id": 21574}, {"count": 5, "tags": [], "bug_id": 44450, "attachment_id": null, "id": 113978, "time": "2008-02-21T12:58:09Z", "creator": "josh@apache.org", "creation_time": "2008-02-21T12:58:09Z", "is_private": false, "text": "On first inspection it looks like the edits for Vlookup.java and Hlookup.java \ndidn't make it through.  It is probably easier for me just to re-do this \npatch, since there were a lot of POI changes applied recently.\n\nWhile working on a future patch (regarding formula parsing) I found a better \nhome for the raw excel error codes stuff - HSSFErrorConstants.  For the re-do \nof this patch (44450) I re-worked the error code related stuff accordingly."}, {"count": 6, "tags": [], "creator": "josh@apache.org", "attachment_id": 21576, "text": "Created attachment 21576\nsvn diff of 9 changed files\n\n - Added implementation for HLOOKUP, VLOOKUP, and LOOKUP. Refactored Match to\nuse LookupUtils.\n - Found a better home for constants class ErrorEval.ErrorCode.  Merged\nfunctionality with HSSFErrorConstants.\tErrPtg updated.\n - Added javadoc on StringValueEval, and null check in StringEval constructor.", "id": 113979, "time": "2008-02-21T13:01:09Z", "bug_id": 44450, "creation_time": "2008-02-21T13:01:09Z", "is_private": false}, {"attachment_id": 21577, "tags": [], "bug_id": 44450, "text": "Created attachment 21577\ntar bz2 of 3 added files\n\nLookupUtils.java\nTestLookupFunctionsFromSpreadsheet.java\nLookupFunctionsTestCaseData.xls", "count": 7, "id": 113980, "time": "2008-02-21T13:02:27Z", "creator": "josh@apache.org", "creation_time": "2008-02-21T13:02:27Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 44450, "attachment_id": null, "id": 114011, "time": "2008-02-22T03:24:06Z", "creator": "apache@gagravarr.org", "creation_time": "2008-02-22T03:24:06Z", "is_private": false, "text": "Thanks, this new version applied nicely and tests all passed.\n\nI've committed it to svn trunk"}]