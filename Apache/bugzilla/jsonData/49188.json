[{"count": 0, "tags": [], "bug_id": 49188, "text": "Created a worksheet with more tham Short.MAX_VALUE rows and 3 columns.\nCalled HSSFSheet.autoSizeColumn on each of the three columns, which caused the exception below. Auto sizing works when number of rows is lower than Short.MAX_VALUE\n\njava.lang.ArrayIndexOutOfBoundsException: -32735\n\tat java.util.ArrayList.get(Unknown Source)\n\tat org.apache.poi.hssf.model.WorkbookRecordList.get(WorkbookRecordList.java:50)\n\tat org.apache.poi.hssf.model.Workbook.getExFormatAt(Workbook.java:787)\n\tat org.apache.poi.hssf.usermodel.HSSFCell.getCellStyle(HSSFCell.java:906)\n\tat org.apache.poi.hssf.usermodel.HSSFSheet.autoSizeColumn(HSSFSheet.java:1727)\n\tat org.apache.poi.hssf.usermodel.HSSFSheet.autoSizeColumn(HSSFSheet.java:1662)", "id": 136428, "time": "2010-04-27T03:04:01Z", "creator": "al@linova.de", "creation_time": "2010-04-27T03:04:01Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 49188, "text": "Please post sample code to reproduce the problem.\n\nThe following code works fine to me:\n\n    public static void main(String[] args) throws Exception {\n        HSSFWorkbook wb = new HSSFWorkbook();\n        HSSFSheet sh = wb.createSheet();\n        for (int i = 0; i < Short.MAX_VALUE + 5; i++) {\n            HSSFRow row = sh.createRow(i);\n            for (int j = 0; j < 3; j++) {\n                HSSFCell cell = row.createCell(j);\n                cell.setCellValue(\"cell[\" + i + \",\" + j + \"]\");\n            }\n        }\n        for (int j = 0; j < 5; j++) {\n            sh.autoSizeColumn(j);\n        }\n    }\n\nYegor", "id": 137032, "time": "2010-05-22T15:34:01Z", "creator": "yegor@dinom.ru", "creation_time": "2010-05-22T15:34:01Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 49188, "attachment_id": null, "id": 144128, "time": "2011-02-10T07:13:37Z", "creator": "b_mekewar@yahoo.com", "creation_time": "2011-02-10T07:13:37Z", "is_private": false, "text": "\nfollowing code is failing with same exception : \n\n\tpublic static void main(String[] args) throws Exception {\n        HSSFWorkbook wb = new HSSFWorkbook();\n        HSSFSheet sh = wb.createSheet();\n        for (int i = 0; i < 65535; i++) {\n            HSSFRow row = sh.createRow(i);\n            for (int j = 0; j < 3; j++) {\n            \tCellStyle cellStyle = wb.createCellStyle();\n            \tCreationHelper createHelper = wb.getCreationHelper();\n            \tcellStyle.setDataFormat(createHelper.createDataFormat().getFormat(\"m/d/yy h:mm\"));\n                HSSFCell cell = row.createCell(j);\n                cell.setCellStyle(cellStyle);\n                Date date = new Date();\n                cell.setCellValue(\"cell[\" + i + \",\" + j + \"]\");\n            }\n        }\n        for (int j = 0; j < 5; j++) {\n            sh.autoSizeColumn(j);\n        }\n        FileOutputStream fileOut;\n\t\ttry {\n\t\t\tfileOut = new FileOutputStream(\"workbook_MaxLimitTest4.xls\");\n\t\t\twb.write(fileOut);\n\t\t    fileOut.close();\n\t\t} catch (FileNotFoundException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t\tcatch (IOException ie) {\n\t\t\tie.printStackTrace();\n\t\t}\n\t\tSystem.out.println(\"Done\");\n    }"}, {"count": 3, "tags": [], "bug_id": 49188, "text": "The maximum number of cell styles in a workbook is 4000, see http://office.microsoft.com/en-us/excel-help/excel-specifications-and-limits-HP005199291.aspx\n\nCell Styles must be shared. Do not create per-cell, otherwise you will get a \u201cToo many styles\u201d error in Excel when opening your workbook. Think of Cell Styles like CSS and create them like that.\n\nhttp://poi.apache.org/faq.html#faq-N100EF\n\nYegor", "id": 144132, "time": "2011-02-10T08:43:53Z", "creator": "yegor@dinom.ru", "creation_time": "2011-02-10T08:43:53Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 49188, "attachment_id": null, "id": 144696, "time": "2011-03-03T03:57:48Z", "creator": "yegor@dinom.ru", "creation_time": "2011-03-03T03:57:48Z", "is_private": false, "text": "*** Bug 50853 has been marked as a duplicate of this bug. ***"}]