[{"count": 0, "tags": [], "bug_id": 52903, "text": "Created attachment 28462\nExample output file\n\nWhen shifting rows in an HSSF or XSSF worksheet, any hyperlink references are not shifted along with rows. In the example, if shift rows is commented out, the code works as expected placing a cell at 0,0 containing the word Google and a link to Google.  However, if shift-rows is applied, the output file contains the word Google in row 1 and the link in row 0 (see attached output file).\n\n\n\n        //create a workbook and add a sheet and row\n        XSSFWorkbook wb=new XSSFWorkbook();\n        CreationHelper createHelper = wb.getCreationHelper();\n        Sheet sh=wb.createSheet();\n        sh.createRow(0);\n        \n        //create a cell and add a hyperlink\n        Cell c=sh.getRow(0).createCell(0);\n        c.setCellValue(\"Google\");\n        Hyperlink link = createHelper.createHyperlink(Hyperlink.LINK_URL);\n        link.setAddress(new URL(\"http://www.google.com\").toString());\n        c.setHyperlink(link);\n        \n        //shift row by 1\n        sh.shiftRows(0, 0, 1);\n        \n        //write workbook\n        FileOutputStream fos=new FileOutputStream(\"shiftrowsexample.xlsx\");\n        wb.write(fos);\n        fos.close();", "id": 154883, "time": "2012-03-13T17:05:22Z", "creator": "cross22@llnl.gov", "creation_time": "2012-03-13T17:05:22Z", "is_private": false, "attachment_id": 28462}, {"count": 1, "tags": [], "bug_id": 52903, "text": "Just checked and this bug still exists in POI 3.8 release", "id": 157236, "time": "2012-04-05T23:07:30Z", "creator": "cross22@llnl.gov", "creation_time": "2012-04-05T23:07:30Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "text": "I find this issue on 3.12 and 3.13 beta 1.\nWho can fix it as soon as possible.", "attachment_id": null, "id": 184777, "creator": "smartsoul@126.com", "time": "2015-08-27T07:05:53Z", "bug_id": 52903, "creation_time": "2015-08-27T07:05:53Z", "is_private": false}, {"count": 3, "tags": [], "creator": "smartsoul@126.com", "text": "(In reply to Allen Gao from comment #2)\n> I find this issue on 3.12 and 3.13 beta 1.\n> Who can fix it as soon as possible.\n\nOK, it has been 3 years and nobody can fix it ?", "id": 184779, "attachment_id": null, "bug_id": 52903, "creation_time": "2015-08-27T07:07:08Z", "time": "2015-08-27T07:07:08Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 52903, "text": "Allen - those of us who work on POI are mostly volunteers donating our own time. If you are in a position to provide a patch - or at least a failing JUnit test - that will make it much more likely that one of us is able to look at this.", "id": 184781, "time": "2015-08-27T07:58:16Z", "creator": "dtn-asfbugs@corefiling.co.uk", "creation_time": "2015-08-27T07:58:16Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "text": "This has been fixed for the XSSF-side via bug 58557, marking this bug as HSSF now because of this.", "id": 186070, "time": "2015-10-29T08:43:23Z", "bug_id": 52903, "creation_time": "2015-10-29T08:43:23Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 52903, "attachment_id": 33293, "id": 186530, "time": "2015-11-24T22:49:44Z", "creator": "lyle.apachepoi@gmail.com", "creation_time": "2015-11-24T22:49:44Z", "is_private": false, "text": "Created attachment 33293\npatch to fix HSSF shiftrow hyperlink bug"}, {"count": 7, "tags": [], "creator": "lyle.apachepoi@gmail.com", "attachment_id": 33294, "text": "Created attachment 33294\ntest file", "id": 186531, "time": "2015-11-24T22:50:32Z", "bug_id": 52903, "creation_time": "2015-11-24T22:50:32Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 52903, "attachment_id": null, "id": 186638, "time": "2015-11-29T14:53:25Z", "creator": "onealj@apache.org", "creation_time": "2015-11-29T14:53:25Z", "is_private": false, "text": "Thanks for the patch, lyle!\n\nI moved the TestXSSFSheetShiftRows testBug46742_shiftHyperlinks test over to BaseTestSheetShiftRows so that the same test could be used on all Sheet implementations. I think this already-existing unit test is a superset of your test (attachment 33294), but we always appreciate it when contributors include a unit test to so we know exactly what's wrong, and we know when the problem is fixed.\n\nThe existing unit test caught one additional problem with HSSFSheet's shiftRows implementation, which is that HSSFHyperlinks weren't removed from rows that get overwritten/deleted.\n\nAdded in r1717069. Updated docs in r1717070."}]