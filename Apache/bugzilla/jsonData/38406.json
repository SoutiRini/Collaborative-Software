[{"attachment_id": null, "tags": [], "creator": "andy.mcbride@dsl.pipex.com", "text": "Current log4j trunk fails to build or run using jdk < 1.4\n\nThe following failures are reported building with jdk1.3.1:\n\nbuild.core:\n    [mkdir] Created dir: C:\\Java\\code\\jakarta\\logging-log4j-head-\ncvs\\dist\\classes\n    [javac] Compiling 265 source files to C:\\Java\\code\\jakarta\\logging-log4j-\nhead-cvs\\dist\\classes\n    [javac] C:\\Java\\code\\jakarta\\logging-log4j-head-\ncvs\\src\\java\\org\\apache\\log4j\\pattern\\NameAbbreviator.java:185: cannot resolve \nsymbol\n    [javac] symbol  : method lastIndexOf  (java.lang.String,int)\n    [javac] location: class java.lang.StringBuffer\n    [javac]         end = buf.lastIndexOf(\".\", end - 1);\n    [javac]                  ^\n    [javac] C:\\Java\\code\\jakarta\\logging-log4j-head-\ncvs\\src\\java\\org\\apache\\log4j\\pattern\\NameAbbreviator.java:231: cannot resolve \nsymbol\n    [javac] symbol  : method indexOf  (java.lang.String,int)\n    [javac] location: class java.lang.StringBuffer\n    [javac]       int nextDot = buf.indexOf(\".\", startPos);\n    [javac]                        ^\n    [javac] C:\\Java\\code\\jakarta\\logging-log4j-head-\ncvs\\src\\java\\org\\apache\\log4j\\rolling\\helper\\GZCompressAction.java:107: \nFileOutputStream(java\n.io.File,boolean) has private access in java.io.FileOutputStream\n    [javac]       FileOutputStream fos = new FileOutputStream(destination, \nfalse);\n    [javac]                              ^\n    [javac] 3 errors\n\n\n\nbuild.db:\n    [javac] Compiling 10 source files to C:\\Java\\code\\jakarta\\logging-log4j-\nhead-cvs\\dist\\classes\n    [javac] C:\\Java\\code\\jakarta\\logging-log4j-head-\ncvs\\src\\java\\org\\apache\\log4j\\db\\DBAppender.java:223: cannot resolve symbol\n    [javac] symbol  : method getGeneratedKeys  ()\n    [javac] location: interface java.sql.PreparedStatement\n    [javac]               rs = insertStatement.getGeneratedKeys();\n    [javac]                                   ^\n    [javac] C:\\Java\\code\\jakarta\\logging-log4j-head-\ncvs\\src\\java\\org\\apache\\log4j\\db\\dialect\\Util.java:101: cannot resolve symbol\n    [javac] symbol  : method supportsGetGeneratedKeys  ()\n    [javac] location: interface java.sql.DatabaseMetaData\n    [javac]       return meta.supportsGetGeneratedKeys();\n    [javac]                  ^\n    [javac] 2 errors\n\nI am attaching a patch for the core classes which are only calling new \nconvenience methods.  \n\nI don't know what should be done with the DB classes though, other than using \nreflection to call the methods where present and falling back to using the \nsqlDialect impl where not.", "count": 0, "id": 85071, "time": "2006-01-26T22:17:37Z", "bug_id": 38406, "creation_time": "2006-01-26T22:17:37Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 38406, "text": "Created attachment 17512\npatch removing jdk1.4 dependencies in core classes", "id": 85073, "time": "2006-01-26T22:19:26Z", "creator": "andy.mcbride@dsl.pipex.com", "creation_time": "2006-01-26T22:19:26Z", "is_private": false, "attachment_id": 17512}, {"count": 2, "tags": [], "creator": "carnold@apache.org", "text": "Suggested changes + DB fixes committed as rev 372655.", "id": 85076, "time": "2006-01-27T00:18:54Z", "bug_id": 38406, "creation_time": "2006-01-27T00:18:54Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 38406, "text": "Confirmed the changes allow the code to be compiled with jdk1.3.1\nand that the produced jar now works at runtime for a basic test case.\n\nUnfortunately I am not able to verify the runtime behaviour of the DBAppender \nbut the code changes look good to me.  \n\n \n\n", "id": 85077, "time": "2006-01-27T01:03:21Z", "creator": "andy.mcbride@dsl.pipex.com", "creation_time": "2006-01-27T01:03:21Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "carnold@apache.org", "text": "Had a few JDK 1.4 dependencies in tests.  Fixed in rev 372671.\n\nThe \"javadoc\" target in build.xml uses the \"-breakiterator\" option which was introduced in JDK 1.4.  I'll let \nMark deal with whether to remove it.\n\nI found it necessary to use -lib to put crimson.jar on the classpath during tests under JDK 1.3 to avoid \nClassNotFound exceptions for org.w3c.Node.  Like:\n\nant -lib /java/crimson-1.1.3/crimson.jar -lib /java/junit3.8.1/junit.jar -Dlib.home.dir=/java runAll\n\n", "id": 85080, "attachment_id": null, "bug_id": 38406, "creation_time": "2006-01-27T01:30:43Z", "time": "2006-01-27T01:30:43Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 38406, "text": "Thanks for the tip!\n\nI hope to be able to contribute more time to log4j test coverage soon.  ", "id": 85083, "time": "2006-01-27T02:33:31Z", "creator": "andy.mcbride@dsl.pipex.com", "creation_time": "2006-01-27T02:33:31Z", "is_private": false, "attachment_id": null}]