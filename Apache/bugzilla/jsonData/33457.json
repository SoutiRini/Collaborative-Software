[{"count": 0, "tags": [], "bug_id": 33457, "is_private": false, "text": "I keep seeing these errors in the jk log file:\n\n[Sat Feb 05 05:28:27 2005] [info]  ajp_done::jk_ajp_common.c (1947): could not\nfind empty cache slot from 1 for worker myUBC. Rise worker cachesize\n\n\nAfter poking around in the code for a bit I discovered that the \"1\" referred\nto the cache size. What I couldn't figure out is why it was \"1\" when httpd.conf\nhad:\n\nThreadLimit         250\nStartServers         1\nMaxClients          400\nMinSpareThreads     25\nMaxSpareThreads     75\nThreadsPerChild     100\nMaxRequestsPerChild  0\n\n\nAfter adding some log calls I discovered that the call to \njk_set_worker_def_cache_size() in jk_child_init() happens\nafter the call to ajp_init() which is why the cache size is 1.\n\nHere is the log file entries (including the extra ones I added):\n\n[Tue Feb 08 14:17:42 2005] [24646:1] [debug]\nuri_worker_map_open::jk_uri_worker_map.c (461): rule map size is 0\n[Tue Feb 08 14:17:42 2005] [24646:1] [debug] build_worker_map::jk_worker.c\n(196): creating worker myUBC\n[Tue Feb 08 14:17:42 2005] [24646:1] [debug] wc_create_worker::jk_worker.c\n(120): about to create instance myUBC of ajp13\n[Tue Feb 08 14:17:42 2005] [24646:1] [debug] wc_create_worker::jk_worker.c\n(133): about to validate and init myUBC\n[Tue Feb 08 14:17:42 2005] [24646:1] [debug] ajp_validate::jk_ajp_common.c\n(1721): worker myUBC contact is localhost:7090\n[Tue Feb 08 14:17:42 2005] [24646:1] [error] ajp_init::jk_ajp_common.c (1755):\najp_init\n[Tue Feb 08 14:17:42 2005] [24646:1] [error] ajp_init::jk_ajp_common.c (1758):\ndef cache size 1\n[Tue Feb 08 14:17:42 2005] [24646:1] [error] ajp_init::jk_ajp_common.c (1762):\nnew cache size 1\n...\n[Tue Feb 08 14:17:42 2005] [24646:1] [debug] ajp_init::jk_ajp_common.c (1856):\nsetting connection cache size to 1\n[Tue Feb 08 14:17:42 2005] [24646:1] [error] init::jk_ajp13_worker.c (53): init\n[Tue Feb 08 14:17:42 2005] [24646:1] [debug] build_worker_map::jk_worker.c\n(208): removing old myUBC worker \n[Tue Feb 08 14:17:44 2005] [24647:1] [debug]\nuri_worker_map_open::jk_uri_worker_map.c (461): rule map size is 0\n[Tue Feb 08 14:17:44 2005] [24647:1] [debug] build_worker_map::jk_worker.c\n(196): creating worker myUBC\n[Tue Feb 08 14:17:44 2005] [24647:1] [debug] wc_create_worker::jk_worker.c\n(120): about to create instance myUBC of ajp13\n[Tue Feb 08 14:17:44 2005] [24647:1] [debug] wc_create_worker::jk_worker.c\n(133): about to validate and init myUBC\n[Tue Feb 08 14:17:44 2005] [24647:1] [debug] ajp_validate::jk_ajp_common.c\n(1721): worker myUBC contact is localhost:7090\n[Tue Feb 08 14:17:44 2005] [24647:1] [error] ajp_init::jk_ajp_common.c (1755):\najp_init\n[Tue Feb 08 14:17:44 2005] [24647:1] [error] ajp_init::jk_ajp_common.c (1758):\ndef cache size 1\n[Tue Feb 08 14:17:44 2005] [24647:1] [error] ajp_init::jk_ajp_common.c (1762):\nnew cache size 1\n...\n[Tue Feb 08 14:17:44 2005] [24647:1] [debug] ajp_init::jk_ajp_common.c (1856):\nsetting connection cache size to 1\n[Tue Feb 08 14:17:44 2005] [24647:1] [error] init::jk_ajp13_worker.c (53): init\n[Tue Feb 08 14:17:44 2005] [24647:1] [debug] build_worker_map::jk_worker.c\n(208): removing old myUBC worker \n[Tue Feb 08 14:17:44 2005] [24649:1] [error] jk_child_init::mod_jk.c (2198):\nthread limit is 100\n[Tue Feb 08 14:17:44 2005] [24649:1] [debug] jk_child_init::mod_jk.c (2202):\nInitialized mod_jk/1.2.8\n[Tue Feb 08 14:17:44 2005] [24649:1] [error] jk_child_init::mod_jk.c (2203):\nCache size 100", "id": 70664, "time": "2005-02-08T23:51:13Z", "creator": "George.Lindholm@ubc.ca", "creation_time": "2005-02-08T23:51:13Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "Created attachment 14221\nhttpd.conf", "attachment_id": 14221, "bug_id": 33457, "id": 70665, "time": "2005-02-08T23:53:07Z", "creator": "George.Lindholm@ubc.ca", "creation_time": "2005-02-08T23:53:07Z", "is_private": false}, {"count": 2, "tags": [], "creator": "mturk@apache.org", "attachment_id": null, "is_private": false, "id": 70691, "time": "2005-02-09T08:41:28Z", "bug_id": 33457, "creation_time": "2005-02-09T08:41:28Z", "text": "Fixed in the CVS. Thanks for spotting that.\n\nThis is not a critical bug, because you can always\nset the cache size to a proper value inside\nworkers.properties for each worker.\n\n"}]