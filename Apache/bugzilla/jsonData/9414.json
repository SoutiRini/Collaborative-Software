[{"count": 0, "tags": [], "bug_id": 9414, "text": "Hi,\n\nI think the behavior of ant when exiting is undesirable.\n\nAfter ant has done its job successful it does a normal\nSystem.exit(0). Unfortunately there is a try/catch around it.\n\norg/apache/tools/ant/Main.java:start(..){\n...\n        try {\n            m.runBuild(coreLoader);\n            System.exit(0);\n        } catch (BuildException be) {\n            if (m.err != System.err) {\n                printMessage(be);\n            }\n            System.exit(1);\n        } catch (Throwable exc) {\n            exc.printStackTrace();\n            printMessage(exc);\n            System.exit(1);\n        } finally {\n...\n}\n\nI don't mind catching the BuildException around the runBuild(..),\nbut trapping the System.exit(0) is not so good, IMHO.\n\nHere is why.\n\nI invoke ant from an external program (a Java shell, CleSh) and of\ncourse have to prevent the exit using a security manager which \nthrows a SecurityException when ant tries to exit. Now instead of\nletting the external program handle the security exception, ant gets\nin the way and prints that silly stack trace which the jvm would by\ndefault print anyway if ant would have been started on its own.\n\nSo please don't catch the Throwable, or re-throw a catched \nSecurityException, or do the System.exit(0) outside the try block\nafterwards.\n\nMaybe I have overlooked a good reason why to catch everything.\n\n\nBtw, here is how I help myself for now. But it is a damn ugly workaround.\n\nThe security manager throws a special security exception which has\nprintStackTrace() overwritten and which throws another exception when\ninvoked. That way I get no stack trace and the second exception does not\nget catched by ant. Of course this might have nasty side effects for other\napplications.\n\nThanks very much,\n   Clemens", "id": 16701, "time": "2002-05-25T12:02:10Z", "creator": "clemens@kclee.com", "creation_time": "2002-05-25T12:02:10Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 9414, "attachment_id": null, "id": 17674, "time": "2002-06-12T15:07:41Z", "creator": "bodewig@apache.org", "creation_time": "2002-06-12T15:07:41Z", "is_private": false, "text": "I'm not sure about side-effects either, so I've patched the 1.6 branch (we are too\nclose to the 1.5 release IMHO)."}]