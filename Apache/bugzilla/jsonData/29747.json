[{"id": 59749, "tags": [], "bug_id": 29747, "is_private": false, "count": 0, "text": "When we create a workbook from existing Excel file and create a new sheet from \nthe work book, the \"setRepeatingRowsAndColumns\" method does not work. I have \nwrite a Junit test case to test it, and it is repeatable.\n\nThe Junit test is bellow:\n\n\n\npackage org.apache.poi.hssf.usermodel;\n\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.util.Iterator;\n\nimport junit.framework.TestCase;\n\nimport org.apache.poi.hssf.model.Workbook;\nimport org.apache.poi.hssf.record.BackupRecord;\nimport org.apache.poi.hssf.record.LabelSSTRecord;\nimport org.apache.poi.hssf.record.Record;\nimport org.apache.poi.hssf.record.aggregates.ValueRecordsAggregate;\nimport org.apache.poi.hssf.util.Region;\nimport org.apache.poi.poifs.filesystem.POIFSFileSystem;\n\n\npublic class TestWorkbook\n    extends TestCase\n{\n\n    /**\n     * Constructor TestWorkbook\n     *\n     * @param name\n     */\n\n    public TestWorkbook(String name)\n    {\n        super(name);\n    }\n\n    \n    /**\n     * Generate a file to visually/programmatically verify repeating rows and \ncols made it\n     */\n    public void testRepeatingColsRows() throws IOException\n    {\n      FileInputStream fis = new FileInputStream(new File\n(\"c://temp//myExistFile.xls\"));\t\t\n      HSSFWorkbook workbook = new HSSFWorkbook(fis);        \n\t\tHSSFSheet sheet = workbook.createSheet(\"Test Print \nTitles\");                \n\t\tString sheetName = workbook.getSheetName(0);\n\t     \n\t    HSSFRow row = sheet.createRow(0);\n\t    \n\t    HSSFCell cell = row.createCell((short)1);\n\t    cell.setCellValue(\"hi\");\n\t     \n\t     \n\t\tworkbook.setRepeatingRowsAndColumns(workbook.getSheetIndex\n(\"Test Print Titles\"), 0, 1, 0, 0); \n\t     \n\t\tFile file;// = File.createTempFile\n(\"testPrintTitles\",\".xls\");        \n                \n                file = new File(\"c://temp//mytest.xls\");\n\t     \n\t\tFileOutputStream fileOut = new FileOutputStream(file);\n\t\tworkbook.write(fileOut);\n\t\tfileOut.close();\n\t     \n\t\tassertTrue(\"file exists\",file.exists());\n\t     \n    \t\n    }\n  \n    \n    public static void main(String [] ignored_args)\n    {\n        String filename = System.getProperty(\"HSSF.testdata.path\");\n\n        // assume this is relative to basedir\n        if (filename == null)\n        {\n            System.setProperty(\n                \"HSSF.testdata.path\",\n                \"src/testcases/org/apache/poi/hssf/data\");\n        }\n        System.out\n            .println(\"Testing org.apache.poi.hssf.usermodel.HSSFWorkbook\");\n        junit.textui.TestRunner.run(TestWorkbook.class);\n    }\n}", "time": "2004-06-23T03:07:12Z", "creator": "michael_zjm@hotmail.com", "creation_time": "2004-06-23T03:07:12Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 29747, "attachment_id": null, "is_private": false, "id": 59934, "time": "2004-06-27T11:11:10Z", "creator": "glens@apache.org", "creation_time": "2004-06-27T11:11:10Z", "text": "Fixed.  Was result of not setting correct index record in the name record.  Was\nusing extern sheet index rather than actual sheet index."}]