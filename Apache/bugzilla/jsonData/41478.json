[{"count": 0, "tags": [], "text": "I have been playing with code that can format Excel numeric data using Excel\nnumber format strings. My implementation is by no means complete (if something\nexists already...), but during the course of vetting it I find that some of the\nformats built into the HSSFDataFormat are wrong, specifically:\n\n5, \"($#,##0_);($#,##0)\"\n6, \"($#,##0_);[Red]($#,##0)\"\n7, \"($#,##0.00);($#,##0.00)\"\n8, \"($#,##0.00_);[Red]($#,##0.00)\"\n0x25, \"(#,##0_);(#,##0)\"\n0x26, \"(#,##0_);[Red](#,##0)\"\n0x27, \"(#,##0.00_);(#,##0.00)\"\n0x28, \"(#,##0.00_);[Red](#,##0.00)\"\n\nAccording to the docs I can find (OpenOffice.org and playing with my copy of\nExcel:mac), it looks like all of these should start with _, not \"(\". Otherwise,\nthe \"(\" is very definitely going to be printed (if you cut and paste the above\nformats into Excel you will see this happening).", "is_private": false, "id": 98578, "creator": "dchristianson@farecast.com", "time": "2007-01-26T15:48:35Z", "bug_id": 41478, "creation_time": "2007-01-26T15:48:35Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "dq@mail.com", "text": "Created attachment 23155\nPlease apply the proposed patch \n\nPositive numbers should not be in parenthesis\nthe should all start with \"_(\" \n\n *       5, \"_($#,##0_);($#,##0)\"<br>\n *       6, \"_($#,##0_);[Red]($#,##0)\"<br>\n *       7, \"_($#,##0.00);($#,##0.00)\"<br>\n *       8, \"_($#,##0.00_);[Red]($#,##0.00)\"<br>\n *       0x25, \"_(#,##0_);(#,##0)\"<P>\n *       0x26, \"_(#,##0_);[Red](#,##0)\"<P>\n *       0x27, \"_(#,##0.00_);(#,##0.00)\"<P>\n *       0x28, \"_(#,##0.00_);[Red](#,##0.00)\"<P>\n\nThis is from MS Excel Help:\n\nTo create a space that is the width of a character in a number format, include an underscore, followed by the character. For example, when you follow an underscore with a right parenthesis, such as _), positive numbers line up correctly with negative numbers that are enclosed in parentheses.", "id": 124258, "time": "2009-01-21T21:43:22Z", "bug_id": 41478, "creation_time": "2009-01-21T21:43:22Z", "is_private": false, "attachment_id": 23155}, {"count": 2, "text": "The proposed patch does not fix the problem completely \nsince if I call the following method on a cell \n\nnew HSSFDataFormatter().formatCellValue(cell)\n\nand the cell is formatted say as format #7 =>  \"_($#,##0.00);($#,##0.00)\"  \nthe formatted number contains _ in front for example :   _$38\nwhile excel shows it correctly\n\n\n\n\n", "bug_id": 41478, "attachment_id": null, "id": 124260, "time": "2009-01-21T21:59:52Z", "creator": "dq@mail.com", "creation_time": "2009-01-21T21:59:52Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 41478, "attachment_id": null, "is_private": false, "id": 124261, "time": "2009-01-21T22:55:12Z", "creator": "dq@mail.com", "creation_time": "2009-01-21T22:55:12Z", "text": "since POI anyway does not do anything about \"creating a space that is the width of a character\", an easy fix could be to remove leading \"(\" instead of adding \"_\" the following way:\n\n5, \"$#,##0_);($#,##0)\"\n6, \"$#,##0_);[Red]($#,##0)\"\n7, \"$#,##0.00);($#,##0.00)\"\n8, \"$#,##0.00_);[Red]($#,##0.00)\"\n0x25, \"#,##0_);(#,##0)\"\n0x26, \"#,##0_);[Red](#,##0)\"\n0x27, \"#,##0.00_);(#,##0.00)\"\n0x28, \"#,##0.00_);[Red](#,##0.00)\"\n \n"}, {"count": 4, "attachment_id": null, "creator": "apache@gagravarr.org", "is_private": false, "id": 137356, "time": "2010-06-04T10:50:10Z", "bug_id": 41478, "creation_time": "2010-06-04T10:50:10Z", "tags": [], "text": "This bug references a very old version of POI. As no new comments have been added in a long time, and a lot of fixes for HSSFDataFormatter have been applied in the mean time, I'm assuming that this bug has now been fixed\n\nIf the bug still exists with the latest version of POI (3.7 beta 1 or later), please re-open the bug and add a comment indicating this, ideally also with a failing unit test"}]