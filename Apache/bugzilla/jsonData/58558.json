[{"count": 0, "tags": [], "creator": "barney2k7@gmail.com", "attachment_id": null, "id": 186005, "time": "2015-10-27T10:40:30Z", "bug_id": 58558, "creation_time": "2015-10-27T10:40:30Z", "is_private": false, "text": "If SXSSFCell.setCellValue(RichTextString) is called with 'null' as parameter, an NPE is thrown:\n\njava.lang.NullPointerException\n    at org.apache.poi.xssf.usermodel.XSSFRichTextString.length(XSSFRichTextString.java:328)\n    at org.apache.poi.xssf.streaming.SXSSFCell.setCellValue(SXSSFCell.java:232)\n    at ...\n\nThis seems to be a bug, as the javadoc of that method clearly states \"If value is null then we will change the cell to a Blank cell.\"\n\nOther Cell implementations (e.g. XSSFCell) correctly implement what javadoc promises."}, {"count": 1, "attachment_id": null, "creator": "dominik.stadler@gmx.at", "text": "This is fixed in POI 3.13 via Bug 58113 already, please update and try again.", "id": 186020, "time": "2015-10-27T16:09:58Z", "bug_id": 58558, "creation_time": "2015-10-27T16:09:58Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "barney2k7@gmail.com", "attachment_id": null, "text": "This is not a duplicate of Bug 58113: \n\nSXSSFCell.setCellValue(RichTextString) is still broken in 3.13\n\nBug 58113 only fixed SXSSFCell.setCellValue(String)\n\n\nPS: 3.13-FINAL isn't available in the Version Field of Bugzilla, you might want to add that", "id": 186052, "time": "2015-10-28T12:04:11Z", "bug_id": 58558, "creation_time": "2015-10-28T12:04:11Z", "is_private": false}, {"count": 3, "tags": [], "text": "Any chance you could write a short junit unit test that shows the problem still occurring? We can then use that to verify the fix, when done, and also to ensure that it doesn't get broken in the future\n\nAlso, missing versions added to bugzilla, thanks for reminding us!", "attachment_id": null, "bug_id": 58558, "id": 186053, "time": "2015-10-28T12:49:51Z", "creator": "apache@gagravarr.org", "creation_time": "2015-10-28T12:49:51Z", "is_private": false}, {"count": 4, "attachment_id": null, "creator": "barney2k7@gmail.com", "text": "Here's a test case that you can add to org.apache.poi.ss.usermodel.BaseTestCell:\n\n  /**\n   * Test case for 58558\n   */\n  @Test\n  public void testSetCellValueNullRichTextString() throws IOException {\n    Workbook wb = _testDataProvider.createWorkbook();\n    Sheet sheet = wb.createSheet();\n    Cell cell = sheet.createRow(0).createCell(0);\n\n    RichTextString str = null;\n    cell.setCellValue(str);\n    assertEquals(\"\", cell.getStringCellValue());\n\n    wb.close();\n  }\n\n\nIt fails with NPE for SXSSF, but works fine for XSSF and HSSF (all using poi 3.13 final release)", "id": 186057, "time": "2015-10-28T15:07:53Z", "bug_id": 58558, "creation_time": "2015-10-28T15:07:53Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 186064, "time": "2015-10-28T17:43:11Z", "bug_id": 58558, "creation_time": "2015-10-28T17:43:11Z", "is_private": false, "text": "Thanks for that. Fuller test case and a SXSSF fix added in r1711082."}]