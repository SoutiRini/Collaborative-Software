[{"count": 0, "tags": [], "text": "Create a page with an image on it. Set a link around that image to another page.\nPublish out the edited page and image, but not the page the link is to. Visit\nthe page under live and you'll get an exception.\n\nstacktracejava.util.EmptyStackException\n\tat org.apache.xml.utils.IntStack.peek(IntStack.java:127)\n\tat org.apache.xml.dtm.ref.sax2dtm.SAX2DTM.endElement(SAX2DTM.java:2034)\n\tat\norg.apache.xalan.transformer.TransformerHandlerImpl.endElement(TransformerHandlerImpl.java:524)\n\tat org.apache.cocoon.xml.AbstractXMLPipe.endElement(AbstractXMLPipe.java:112)\n\tat\norg.apache.cocoon.components.EnvironmentChanger.endElement(EnvironmentStack.java:148)\n\tat org.apache.cocoon.xml.AbstractXMLPipe.endElement(AbstractXMLPipe.java:112)\n\tat\norg.apache.cocoon.transformation.AbstractSAXTransformer.endElement(AbstractSAXTransformer.java:490)\n\tat\norg.apache.lenya.cms.cocoon.transformation.AbstractLinkTransformer.endElement(AbstractLinkTransformer.java:247)\n\tat org.apache.cocoon.xml.AbstractXMLPipe.endElement(AbstractXMLPipe.java:112)\n\tat\norg.apache.cocoon.transformation.AbstractSAXTransformer.endElement(AbstractSAXTransformer.java:490)\n\tat\norg.apache.lenya.cms.cocoon.transformation.MetaDataTransformer.endElement(MetaDataTransformer.java:210)", "is_private": false, "id": 113717, "creator": "rfrovarp@apache.org", "time": "2008-02-13T08:06:35Z", "bug_id": 44416, "creation_time": "2008-02-13T08:06:35Z", "attachment_id": null}, {"count": 1, "text": "Turns out problem is with the endElement sticking in an empty a tag as we only\nuse this.ignoreLinkElement there, which can be modified from the corresponding\nstart. I will look at using a stack to get around these problems.", "bug_id": 44416, "is_private": false, "id": 113798, "time": "2008-02-15T10:03:14Z", "creator": "rfrovarp@apache.org", "creation_time": "2008-02-15T10:03:14Z", "tags": [], "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 44416, "attachment_id": null, "id": 113837, "time": "2008-02-17T08:31:20Z", "creator": "rfrovarp@apache.org", "creation_time": "2008-02-17T08:31:20Z", "is_private": false, "text": "Fixed in 628508. Any class extending AbstractLinkTransformer and using\nignoreLinkElement also needs to set useIgnore = true so that its values will be\nstored and retrieved in the stack. That class would also need to make sure to\neither use AbstractLinkTransformer's startElement and endElement function or do\nits own manipulation of the stack."}]