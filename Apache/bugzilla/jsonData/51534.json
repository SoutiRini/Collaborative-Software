[{"count": 0, "tags": [], "creator": "tangchenhui007@qq.com", "is_private": false, "text": "Created attachment 27302\nThis is my test data.\n\nError occurs when I deal excel 2003 files with POI 3.8 beta 3.\n(btw: the file [ExceptionInInitializerError_Testdata.xls] is created by Ms Office 2003 directly.\nHowever, when I tried to open [ExceptionInInitializerError_Testdata.xls] and save it as another file, the bellow exception will not be throwed.\nThanks! ^-^\n\nThe exception is as bellow:\n============================================================================\nException in thread \"main\" java.lang.ExceptionInInitializerError\n\tat org.apache.poi.ss.formula.ptg.Ptg.createClassifiedPtg(Ptg.java:104)\n\tat org.apache.poi.ss.formula.ptg.Ptg.createPtg(Ptg.java:85)\n\tat org.apache.poi.ss.formula.ptg.Ptg.readTokens(Ptg.java:56)\n\tat org.apache.poi.ss.formula.Formula.getTokens(Formula.java:82)\n\tat org.apache.poi.hssf.record.FormulaRecord.getParsedExpression(FormulaRecord.java:311)\n\tat org.apache.poi.hssf.record.aggregates.FormulaRecordAggregate.handleMissingSharedFormulaRecord(FormulaRecordAggregate.java:95)\n\tat org.apache.poi.hssf.record.aggregates.FormulaRecordAggregate.<init>(FormulaRecordAggregate.java:75)\n\tat org.apache.poi.hssf.record.aggregates.ValueRecordsAggregate.construct(ValueRecordsAggregate.java:182)\n\tat org.apache.poi.hssf.record.aggregates.RowRecordsAggregate.<init>(RowRecordsAggregate.java:109)\n\tat org.apache.poi.hssf.model.InternalSheet.<init>(InternalSheet.java:207)\n\tat org.apache.poi.hssf.model.InternalSheet.createSheet(InternalSheet.java:162)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:309)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:260)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:204)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:340)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:321)\n\tat com.infobases.eltadoc2text.ReadFromFile.readTextFromExcelAndWriteToDB(ReadFromFile.java:128)\n\tat com.infobases.eltadoc2text.Doc2text.excel2Text(Doc2text.java:336)\n\tat com.infobases.eltadoc2text.Doc2text.Test_Dox(Doc2text.java:304)\n\tat com.infobases.eltadoc2text.Doc2text.main(Doc2text.java:63)\nCaused by: java.lang.RuntimeException: resource 'functionMetadata.txt' not found\n\tat org.apache.poi.ss.formula.function.FunctionMetadataReader.createRegistry(FunctionMetadataReader.java:58)\n\tat org.apache.poi.ss.formula.function.FunctionMetadataRegistry.getInstance(FunctionMetadataRegistry.java:46)\n\tat org.apache.poi.ss.formula.function.FunctionMetadataRegistry.lookupIndexByName(FunctionMetadataRegistry.java:75)\n\tat org.apache.poi.ss.formula.ptg.AbstractFunctionPtg.lookupIndex(AbstractFunctionPtg.java:144)\n\tat org.apache.poi.ss.formula.ptg.FuncVarPtg.create(FuncVarPtg.java:52)\n\tat org.apache.poi.ss.formula.ptg.FuncVarPtg.<clinit>(FuncVarPtg.java:35)\n\t... 20 more", "id": 148031, "time": "2011-07-20T11:40:53Z", "bug_id": 51534, "creation_time": "2011-07-20T11:40:53Z", "attachment_id": 27302}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "is_private": false, "text": "The key line is\n   java.lang.RuntimeException: resource 'functionMetadata.txt' not found\n\nI'm guessing you've tried to build your own copy of POI? It looks like you've missed out some of the key resources in the process though. You should use the Ant build script to generate your custom jars, as it knows about all the resources you need", "id": 148034, "time": "2011-07-20T11:48:53Z", "bug_id": 51534, "creation_time": "2011-07-20T11:48:53Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 51534, "text": "I'm tried to extract text from Excel 2003. I am not sure why my source should use the resource 'functionMetadata.txt' .\nBut when I tried to open and save the input file as another file, my source will not use the METADATA FILE 'functionMetadata.txt'.\nWhy this time I am not missed out some of the key resources in the process?\n\n\n(In reply to comment #1)\n> The key line is\n>    java.lang.RuntimeException: resource 'functionMetadata.txt' not found\n> I'm guessing you've tried to build your own copy of POI? It looks like you've\n> missed out some of the key resources in the process though. You should use the\n> Ant build script to generate your custom jars, as it knows about all the\n> resources you need", "count": 2, "id": 148035, "time": "2011-07-20T12:21:38Z", "creator": "tangchenhui007@qq.com", "creation_time": "2011-07-20T12:21:38Z", "is_private": false}, {"count": 3, "tags": [], "text": "Created attachment 27327\nfunctionMetadata.txt\n\nAs Nick Burch say, I've missed out some of the key resources in the process though. Then, I put the attachment which is named [functionMetadata.txt] in the directory of [org\\apache\\poi\\ss\\formula\\function], I have fixed this bug. ^-^\n\nThanks my team member:zhang", "is_private": false, "id": 148249, "creator": "tangchenhui007@hotmail.com", "time": "2011-07-28T13:34:23Z", "bug_id": 51534, "creation_time": "2011-07-28T13:34:23Z", "attachment_id": 27327}]