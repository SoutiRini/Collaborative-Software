[{"count": 0, "tags": [], "creator": "gking@iongrid.com", "is_private": false, "id": 146180, "creation_time": "2011-05-07T02:46:17Z", "time": "2011-05-07T02:46:17Z", "bug_id": 51165, "text": "Created attachment 26966\ngit-format-patch @ c7c0e8c implementing agile decryption\n\nCurrently (git-svn commit ID c7c0e8c) poifs.crypt generates a RuntimeException reading past the end of a buffer when presented with an OOXML document that was created with Agile encryption ([MS-OFFCRYPTO] 2.3.4.10), since both the header format and the encryption itself are significantly different from the ECMA-376 standard encryption.\n\nThis patch adds support for reading the encryption header and decrypting Agile encrypted documents and changes the Decryptor class into an abstract interface plus a factory so that different decryption implementations can be applied depending on the encryption header. The existing ECMA-compliant decryptor has been renamed EcmaDecryptor to reflect its proper usage.\n\nAdditionally, I've renamed the test classes since it appears that even after adding them to the top-level test suite they weren't being run since the test harness expects the class name to begin with \"Test.\"", "attachment_id": 26966}, {"attachment_id": null, "tags": [], "bug_id": 51165, "is_private": false, "count": 1, "id": 146245, "time": "2011-05-10T10:38:55Z", "creator": "max.valjanski@gmail.com", "creation_time": "2011-05-10T10:38:55Z", "text": "commited in r1101397, thank you"}, {"attachment_id": null, "tags": [], "bug_id": 51165, "is_private": false, "count": 2, "id": 146287, "time": "2011-05-12T22:11:34Z", "creator": "apache@gagravarr.org", "creation_time": "2011-05-12T22:11:34Z", "text": "One for the Maven gurus most likely - don't we need to add something to the main POI pom for this extra dependency?"}, {"count": 3, "attachment_id": null, "bug_id": 51165, "text": "add maven dependency in r1102603.\n\nMaybe it is better to copy Base64 implementation from Apache Commons to org.apache.poi.util? What do you think?", "id": 146293, "time": "2011-05-13T08:31:17Z", "creator": "max.valjanski@gmail.com", "creation_time": "2011-05-13T08:31:17Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "text": "I'm for copying Base64 to org.apache.poi.util. My goal is to avoid creating a dependency on another project without a strict need. Base64 is a small piece of code, should be stable over time and I think it is OK to maintain it independently as a part of POI.\n\nYegor\n.\n It is a small piece of code\n\n(In reply to comment #3)\n> add maven dependency in r1102603.\n> \n> Maybe it is better to copy Base64 implementation from Apache Commons to\n> org.apache.poi.util? What do you think?", "is_private": false, "id": 146297, "creator": "yegor@dinom.ru", "time": "2011-05-13T09:06:56Z", "bug_id": 51165, "creation_time": "2011-05-13T09:06:56Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 51165, "is_private": false, "count": 5, "id": 146298, "time": "2011-05-13T09:07:55Z", "creator": "apache@gagravarr.org", "creation_time": "2011-05-13T09:07:55Z", "text": "I'd looked at doing that, but as it isn't just the one class (looked to be at least half a dozen that are depended on by Base64), and given that commons codec is so small, it's probably simplest to just add it as a dependency"}]