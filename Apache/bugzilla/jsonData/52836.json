[{"count": 0, "tags": [], "bug_id": 52836, "text": "Created attachment 28424\nCode for reproduce the problem mentioned above\n\nHallo,\n\nI am not able to create a XSSFDrawing-Object. Each time I try to create one, I receive following error:\n\nException in thread \"main\" org.apache.poi.POIXMLException: org.apache.poi.openxml4j.exceptions.InvalidOperationException: A part with the name '/xl/drawings/drawing2.xml' already exists : Packages shall not contain equivalent part names and package implementers shall neither create nor recognize packages with equivalent part names. [M1.12]\n\tat org.apache.poi.POIXMLDocumentPart.createRelationship(POIXMLDocumentPart.java:260)\n\tat org.apache.poi.POIXMLDocumentPart.createRelationship(POIXMLDocumentPart.java:233)\n\tat org.apache.poi.xssf.usermodel.XSSFSheet.createDrawingPatriarch(XSSFSheet.java:402)\n\tat ExcelFileCreationWithPOI.main(ExcelFileCreationWithPOI.java:28)\nCaused by: org.apache.poi.openxml4j.exceptions.InvalidOperationException: A part with the name '/xl/drawings/drawing2.xml' already exists : Packages shall not contain equivalent part names and package implementers shall neither create nor recognize packages with equivalent part names. [M1.12]\n\tat org.apache.poi.openxml4j.opc.OPCPackage.createPart(OPCPackage.java:700)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.createPart(OPCPackage.java:664)\n\tat org.apache.poi.POIXMLDocumentPart.createRelationship(POIXMLDocumentPart.java:252)\n\t... 3 more\n\nHereby I attach the code, which I have used.\n\nPlease do notify me as soon as a solution is found.\n\nThanks im advance!\n\nRegards\n\nJimmy", "id": 154565, "time": "2012-03-06T13:30:07Z", "creator": "jchakkalakal@auel.de", "creation_time": "2012-03-06T13:30:07Z", "is_private": false, "attachment_id": 28424}, {"count": 1, "tags": [], "bug_id": 52836, "attachment_id": null, "is_private": false, "id": 154866, "time": "2012-03-13T07:16:11Z", "creator": "yegor@dinom.ru", "creation_time": "2012-03-13T07:16:11Z", "text": "Please attach the template that is used by your code snippet. \n\nYegor"}, {"count": 2, "tags": [], "bug_id": 52836, "is_private": false, "text": "Created attachment 28816\nTemplate used by me for the code", "id": 159215, "time": "2012-05-22T13:16:38Z", "creator": "jchakkalakal@auel.de", "creation_time": "2012-05-22T13:16:38Z", "attachment_id": 28816}, {"count": 3, "tags": [], "bug_id": 52836, "attachment_id": null, "is_private": false, "id": 159216, "time": "2012-05-22T13:17:53Z", "creator": "jchakkalakal@auel.de", "creation_time": "2012-05-22T13:17:53Z", "text": "Hallo Yegor,\n\nI am attached the template, that I have used in the code\n\nKind regards\n\nJimmy Chakkalakal"}, {"count": 4, "tags": [], "bug_id": 52836, "text": "Works for me with current trunk (3.13-beta1 + some more changes), so it seems to have been fixed at some point.", "id": 184946, "time": "2015-09-03T19:15:50Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-09-03T19:15:50Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 52836, "attachment_id": null, "text": "sorry, I was wrong, it still happens when I use the correct sample file.", "id": 184947, "time": "2015-09-03T19:19:09Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-09-03T19:19:09Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 52836, "is_private": false, "count": 6, "id": 185537, "time": "2015-09-29T13:44:16Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-09-29T13:44:16Z", "text": "The file seems to have some unused/leftover content in the internal XML/ZIP, there is a xl/drawings/drawing2.xml which is not used. If you open the file in Excel/LibreOffice and re-save it, POI can work with it as expected..."}, {"attachment_id": null, "tags": [], "bug_id": 52836, "text": "Attached is another sample file which leads to the same exception", "count": 7, "id": 187209, "time": "2015-12-29T15:22:52Z", "creator": "martin.studer@mirai-solutions.com", "creation_time": "2015-12-29T15:22:52Z", "is_private": false}, {"count": 8, "tags": [], "creator": "martin.studer@mirai-solutions.com", "attachment_id": 33383, "text": "Created attachment 33383\nAnother sample file which leads to the same exception", "id": 187210, "time": "2015-12-29T15:24:00Z", "bug_id": 52836, "creation_time": "2015-12-29T15:24:00Z", "is_private": false}, {"count": 9, "tags": [], "creator": "dominik.stadler@gmx.at", "text": "Created attachment 33553\nPotential patch for first error message\n\nI tried to have a go at this via the attached patch. If I simply try to avoid the error by forcefully removing the invalid part before creating the new one, creating a new sheet works, however when I try to clone the sheet, I get a different error: \n\norg.apache.poi.POIXMLException: org.apache.xmlbeans.XmlException: Element chartsheet@http://schemas.openxmlformats.org/spreadsheetml/2006/main is not a valid worksheet@http://schemas.openxmlformats.org/spreadsheetml/2006/main document or a valid substitution.\n\tat org.apache.poi.xssf.usermodel.XSSFSheet.read(XSSFSheet.java:174)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.cloneSheet(XSSFWorkbook.java:582)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.cloneSheet(XSSFWorkbook.java:1)\n\tat org.apache.poi.xssf.usermodel.TestXSSFBugs.test52836(TestXSSFBugs.java:2977)\nCaused by: org.apache.xmlbeans.XmlException: Element chartsheet@http://schemas.openxmlformats.org/spreadsheetml/2006/main is not a valid worksheet@http://schemas.openxmlformats.org/spreadsheetml/2006/main document or a valid substitution.\n\tat org.apache.xmlbeans.impl.store.Locale.autoTypeDocument(Locale.java:329)\n\tat org.apache.xmlbeans.impl.store.Locale.parseToXmlObject(Locale.java:1280)\n\tat org.apache.xmlbeans.impl.store.Locale.parseToXmlObject(Locale.java:1264)\n\tat org.apache.xmlbeans.impl.schema.SchemaTypeLoaderBase.parse(SchemaTypeLoaderBase.java:345)\n\tat org.apache.poi.POIXMLTypeLoader.parse(POIXMLTypeLoader.java:92)\n\tat org.openxmlformats.schemas.spreadsheetml.x2006.main.WorksheetDocument$Factory.parse(Unknown Source)\n\tat org.apache.poi.xssf.usermodel.XSSFSheet.read(XSSFSheet.java:172)\n\t... 26 more", "id": 188421, "time": "2016-02-14T21:12:21Z", "bug_id": 52836, "creation_time": "2016-02-14T21:12:21Z", "is_private": false, "attachment_id": 33553}, {"attachment_id": null, "tags": [], "creator": "tuyenivt@gmail.com", "text": "*** Bug 60255 has been marked as a duplicate of this bug. ***\nFixed in 3.16-beta1", "count": 10, "id": 194483, "time": "2016-10-18T01:34:46Z", "bug_id": 52836, "creation_time": "2016-10-18T01:34:46Z", "is_private": false}]