[{"count": 0, "text": "Begin - 1017658823492\njava.lang.IllegalArgumentException: Cannot store a duplicate value \n(\"???????????????\") in this Map\n        at net.sourceforge.poi.util.BinaryTree.insertValue(BinaryTree.java:1401)\n        at net.sourceforge.poi.util.BinaryTree.put(BinaryTree.java:1586)\n        at net.sourceforge.poi.hssf.record.SSTRecord.processString\n(SSTRecord.java:1003)\n        at net.sourceforge.poi.hssf.record.SSTRecord.manufactureStrings\n(SSTRecord.java:930)\n        at net.sourceforge.poi.hssf.record.SSTRecord.processContinueRecord\n(SSTRecord.java:632)\n        at net.sourceforge.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java:228)\n        at net.sourceforge.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:156)\n        at TestFrame.<init>(TestFrame.java:56)\n        at TestFrame.main(TestFrame.java:193)", "creator": "rlibin@hotmail.com", "attachment_id": null, "id": 12619, "time": "2002-04-01T11:02:40Z", "bug_id": 7655, "creation_time": "2002-04-01T11:02:40Z", "tags": [], "is_private": false}, {"count": 1, "text": "Please try using a CVS build.  I think this has been fixed.  The\nnet.sourceforge.x packages indicate this is 1.0.2 or an early development build\nfrom the old sourceforge site.", "creator": "poi-support@buni.org", "attachment_id": null, "id": 12622, "time": "2002-04-01T13:13:42Z", "bug_id": 7655, "creation_time": "2002-04-01T13:13:42Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 7655, "attachment_id": null, "is_private": false, "id": 12623, "time": "2002-04-01T13:33:14Z", "creator": "rlibin@hotmail.com", "creation_time": "2002-04-01T13:33:14Z", "text": "Same old exception :(\n\nException occurred during event dispatching:\njava.lang.IllegalArgumentException: Cannot store a duplicate value \n(\"???????????????\") in this Map\n        at org.apache.poi.util.BinaryTree.insertValue(BinaryTree.java:1395)\n        at org.apache.poi.util.BinaryTree.put(BinaryTree.java:1580)\n        at org.apache.poi.hssf.record.SSTRecord.processString\n(SSTRecord.java:1033)\n        at org.apache.poi.hssf.record.SSTRecord.manufactureStrings\n(SSTRecord.java:960)\n        at org.apache.poi.hssf.record.SSTRecord.processContinueRecord\n(SSTRecord.java:660)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java:176)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:140)\n        at TestFrame.openFile(TestFrame.java:64)\n"}, {"count": 3, "tags": [], "bug_id": 7655, "attachment_id": null, "is_private": false, "id": 14397, "time": "2002-04-23T05:41:18Z", "creator": "glens@apache.org", "creation_time": "2002-04-23T05:41:18Z", "text": "Are you able to post the XLS file that causes this problem?  Does it contain \nrich text cells?"}, {"count": 4, "tags": [], "creator": "poi-support@buni.org", "text": "perhaps for the moment we should kludge SST Record to notice duplicates and just\nreturn the original in the event of a Rich Text cell.  I have to say this is one\nfeature I may consider the absence of irritating enough to sneak into 1.5.1.", "id": 14426, "time": "2002-04-23T11:41:53Z", "bug_id": 7655, "creation_time": "2002-04-23T11:41:53Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 7655, "is_private": false, "text": "*** Bug 9448 has been marked as a duplicate of this bug. ***", "id": 16788, "time": "2002-05-27T20:46:32Z", "creator": "poi-support@buni.org", "creation_time": "2002-05-27T20:46:32Z", "attachment_id": null}, {"count": 6, "tags": [], "creator": "daniel@cheeseplant.org", "attachment_id": null, "id": 16794, "time": "2002-05-28T01:45:07Z", "bug_id": 7655, "creation_time": "2002-05-28T01:45:07Z", "is_private": false, "text": "Curiously enough although this appears to be a somewhat different problem than\nmy bug (9448), I discovered that copying a worksheet with lots of long and\nsimilar strings in it (and invoking Excel's lovely cut-off-at-255-character\nlogic - how quaint), I get one which will cause the duplicate value problem.\n\nAs for my bug, the sheet probably has all manner of fields in it, it's the\nresult of several years of accumulated data from a variety of sources, and while\nit contains essentially just lots of text, it's been cut and pasted in from all\nsorts of things so who knows what the formatting is.\n\nI've begun to suspect that there's more at work than just a flawed continuation\ndesign though, because some instrumented code running against a 700K or so\nspreadsheet came up with this:\n\nmanufactureStrings(index=18,size=8224)\nmanufactureStrings: Loop entry, remaining=8206\nHMM: char_count = 39\nsetupStringParameters()\nsetupStringParameters: Initial total = 81\nProcessing string...\nmanufactureStrings: Loop entry, remaining=8125\nHMM: char_count = 101\nsetupStringParameters()\nsetupStringParameters: Initial total = 104\nsetupStringParameters: Formatted run, total now = 103530\nsetupStringParameters: Extended, total now = 1946285934\nHMM: total len bytes 1946285934 remaining is 8125 exp 1946277809 count 101\n\nWhere the 'extended' data is actually several orders of magnitude larger than\nthe file that supposedly contains it.. so Somewhere either the record is getting\ncorrupted or mis-parsed, I dont know which 8-(.\n\nWhile I can't make my test data publically available, I will send something to\nGlen which can hopefully assist in hunting down the glitch(es)."}, {"count": 7, "tags": [], "creator": "poi-support@buni.org", "text": "Oh wow, maybe this one actually uses the ExtSSTRecord!  We never could find a\nsheet that actually used/needed this.  Question: This is all western version of\nExcel right?  (meaning a western european/US version of excel and/or western\neuropean/US language)", "id": 16795, "time": "2002-05-28T01:55:14Z", "bug_id": 7655, "creation_time": "2002-05-28T01:55:14Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "creator": "daniel@cheeseplant.org", "attachment_id": null, "text": "Yup. US English everywhere (Though there are a goodly number of european accents\nin there for good measure (in fact, whether you like it or not, excel seems to\ntake perverse pleasure in accenting Creme even when you dont want it to).\n", "id": 16796, "time": "2002-05-28T02:00:26Z", "bug_id": 7655, "creation_time": "2002-05-28T02:00:26Z", "is_private": false}, {"count": 9, "tags": [], "creator": "poi-support@buni.org", "attachment_id": null, "text": "Good that should work.  Can you do a org.apache.poi.hssf.dev.BiffViewer on it\nand see if the ExtSSTRecord looks like it actually has something that looks\nmeaningful in it?  It sounds like this stuff may be just the kind of jackpot we\nneed to track that record down!  (I'm still guessing, this may prove to just be\nmore Rich Text issues)", "id": 16798, "time": "2002-05-28T02:02:35Z", "bug_id": 7655, "creation_time": "2002-05-28T02:02:35Z", "is_private": false}, {"count": 10, "tags": [], "creator": "glens@apache.org", "text": "Oh oh... looks like I didn't know what I would be getting myself in for \nhere!  :-)", "id": 16799, "time": "2002-05-28T03:29:11Z", "bug_id": 7655, "creation_time": "2002-05-28T03:29:11Z", "is_private": false, "attachment_id": null}, {"count": 11, "tags": [], "bug_id": 7655, "attachment_id": null, "is_private": false, "id": 17474, "time": "2002-06-10T02:41:09Z", "creator": "glens@apache.org", "creation_time": "2002-06-10T02:41:09Z", "text": "Fixed in 1.5 branch and in trunk.  Should now correctly read rich text and\nextended text with no problems.  The offical release will be 1.5.1."}]