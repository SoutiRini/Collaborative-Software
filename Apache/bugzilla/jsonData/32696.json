[{"count": 0, "attachment_id": null, "bug_id": 32696, "text": "Hi,\n\n \n\nWe are having a strange behavior with Jakarta filter loaded in NT4.0 Enterprise \nEdition with IIS 4.0.\n\nAfter reproducing the steps the IIS service stops:\n\n\u201ctelnet (server) 80\n\nGET /WEB-INF./web.xml http/1.1\u201d\n\n \n\nThe output generated is:\n\n################################################################################\n########\n\nHTTP/1.1 403 Forbidden\n\nServer: Microsoft-IIS/4.0\n\nDate: Thu, 09 Dec 2004 23:34:29 GMT\n\n \n\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\"><HTML><HEAD><TITLE\n\n>Access forbidden!!</TITLE></HEAD><BODY><H1>Access forbidden!</H1><DL><DD>\n\n                                                                          You do\n\nn't have permission to access the requested object.It is either read-protected o\n\nr not readable by the server.</DL></DD></BODY></HTML>\n\n################################################################################\n########\n\n \n\nIn the event viewer is displayed (sounds correct):\n\n################################################################################\n########\n\nEmerg:  [jk_isapi_plugin.c (434)]: HttpFilterProc [/web-inf./web.xml] points to \nthe web-inf or meta-inf directory.\n\nSomebody try to hack into the site!!!\n\n################################################################################\n########\n\n \n\nIf Jakarta filter is not loaded there is no problem. We are using jakarta-\ntomcat-connectors jk 1.2.6 win32-IIS.\n\n \n\nRegards,\n\nHugo Mendon\u00e7a", "id": 68483, "time": "2004-12-14T16:39:16Z", "creator": "hugomendonca@gmail.com", "creation_time": "2004-12-14T16:39:16Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 32696, "text": "WEB-INF is protected folder.\n\nThe log file says:\nHttpFilterProc [/web-inf./web.xml] points to the web-inf or meta-inf directory.\nSomebody try to hack into the site!!!\n\nSo what's unclear?\n", "id": 68484, "time": "2004-12-14T16:43:21Z", "creator": "mturk@apache.org", "creation_time": "2004-12-14T16:43:21Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "hugomendonca@gmail.com", "attachment_id": null, "id": 68488, "time": "2004-12-14T17:25:18Z", "bug_id": 32696, "creation_time": "2004-12-14T17:25:18Z", "is_private": false, "text": "(In reply to comment #1)\n> WEB-INF is protected folder.\n> The log file says:\n> HttpFilterProc [/web-inf./web.xml] points to the web-inf or meta-inf \ndirectory.\n> Somebody try to hack into the site!!!\n> So what's unclear?\n\n\nLike i said clearly in the last thread \"IIS service stops\". That's the problem! \nImagine a have a Web Server and a Hacker. If the hacker tries to make \"GET /WEB-\nINF./web.xml http/1.1\" every 1 minute (or so), my Web Server will stop every \ntime, because IIS Stops.\n\nI know that WEB-INF is protected but that does not mean that he simply throws \ndown IIS everytime somebody tries to access it. It makes no sense at all!\n\nI believe this is not a normal behaviour. What's your opinion?\n\nTks.\n\n"}, {"count": 3, "tags": [], "creator": "mturk@apache.org", "attachment_id": null, "id": 68496, "time": "2004-12-14T19:56:55Z", "bug_id": 32696, "creation_time": "2004-12-14T19:56:55Z", "is_private": false, "text": "You are correct.\nThe IIS really shuts down.\nI'll fix that security hole ASAP.\n\n"}, {"count": 4, "tags": [], "text": "Fixed in the CVS.\nThe patch will be available for testing in beta-4 if released\nor at 1.2.8", "attachment_id": null, "bug_id": 32696, "id": 68500, "time": "2004-12-14T20:20:07Z", "creator": "mturk@apache.org", "creation_time": "2004-12-14T20:20:07Z", "is_private": false}, {"count": 5, "attachment_id": null, "bug_id": 32696, "is_private": false, "id": 68503, "time": "2004-12-14T20:35:28Z", "creator": "mturk@apache.org", "creation_time": "2004-12-14T20:35:28Z", "tags": [], "text": "Fixed in the CVS.\n"}, {"count": 6, "tags": [], "text": "(In reply to comment #5)\n> Fixed in the CVS.\n\nHi again.\n\nThank you very much for the correction of the bug.\n\nMeanwhile, is there any possibility for you to compile the code and send it to \nme? I'm very desperate because we'll have an inspection team looking at our \ncode (and bugs) tomorrow and i have no time to compile the entire project. I \nwould have even to install VC++, since i don't have it installed in my machine.\n\nSo, please, can you help me in this issue?\n\nMany thanks.\n\nHugo Mendon\u00e7a\n", "is_private": false, "id": 68583, "creator": "hugomendonca@gmail.com", "time": "2004-12-15T17:52:42Z", "bug_id": 32696, "creation_time": "2004-12-15T17:52:42Z", "attachment_id": null}, {"count": 7, "tags": [], "creator": "sizing.tw@yahoo.com.tw", "attachment_id": null, "text": "Finding: When the scanning tools guessed WEB-INF directory, the error message \nindicated that access to the directory was denied.  As a result, the error \nmessage confirmed the existence of this directory.\n\nTomcat response HTTP Status 404, while isapi_redirect.dll redirector responses \nAccess forbidden!...., which is HTTP Status 403.\n\nExample:\nhttp://localhost:8080/WEB-INF/\nReturn: HTTP Status 404 - /WEB-INF/\nThis is correct.\n\nhttp://localhost:80/WEB-INF/\nReturn: Access forbidden!\nYou don't have permission to access the requested object. It is either read-\nprotected or not readable by the server.\n\nThis should be 404, not 403.\n\nI have checked the code, jakarta-tomcat-connectors-1.2.8-\nsrc\\jk\\native\\isapi\\jk_isapi_plugin.c, at line 713, and it does response 403 \nHTTP Status.  I cannot find the place to change it from configuration file \nexcept re-compile this redirector.\n\nWhile directory listing is not strictly considered vulnerability, I suggest to \nresponse 404 HTTP Status to hide the directory, like Tomcat does now.\n\nI found a link http://jakarta.apache.org/tomcat/connectors-doc/howto/iis.html \nmentions something like this:\n\nProtecting the WEB-INF Directory \n...., this directory contains sensitive configurations data and Java classes \nand must be kept hidden from web users. Using the IIS management console it is \npossible to protect the WEB-INF directory from user access,.....\n\nTo avoid this need the redirector plugin automatically protects your WEB-INF \ndirectories by rejecting any request that contains WEB-INF in its URL-Path.\n\nI tried to configure IIS, but it looks like jk_isapi gets higher priority to \nhandle the request and always returns 403 status.  Without re-compile the \nprogram, how can I make IIS return 404 status?  Or maybe next release will do?\n\nRecommendation from Cert: When an unauthorized user attempts to access a \ndirectory, they should receive an error message that doesn't confirm the \nexistence of the directory.  Whether a user is trying to access a valid or \ninvalid directory, they should receive the same error message.\n\nMy system environment:\nWin 2K\nTomcat 4.1.31\nIIS 5\nJK-1.2.8 - isapi_redirect-1.2.8.dll binary version - 17 December\n\n\n", "id": 71726, "time": "2005-03-02T19:22:05Z", "bug_id": 32696, "creation_time": "2005-03-02T19:22:05Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 32696, "is_private": false, "count": 8, "id": 72577, "time": "2005-03-17T13:07:47Z", "creator": "mturk@apache.org", "creation_time": "2005-03-17T13:07:47Z", "text": "Fixed in the CVS for mod_jk.\nThanks for spotting that we did not follow the Servlet spec.\n\nMladen\n\n"}, {"count": 9, "tags": [], "creator": "jks@iname.com", "is_private": false, "text": "Where exactly in the spec does it say to return 404 instead of 403?", "id": 74291, "time": "2005-04-29T22:12:36Z", "bug_id": 32696, "creation_time": "2005-04-29T22:12:36Z", "attachment_id": null}]