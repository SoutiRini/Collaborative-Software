[{"count": 0, "tags": [], "text": "The methods:\nsetDx1(...)\nsetDx2(...)   \nsetDy1(...)\nsetDy2(...)\n\nhave no effect on XSSFClientAnchor.\nOn HSSFClientAnchor you can position/size a picture within the cell and it works, on XSSFClientAnchor it does not.\nI also tried the newest 3.8-beta2 and it also does not work.", "is_private": false, "id": 146198, "creation_time": "2011-05-09T08:20:45Z", "time": "2011-05-09T08:20:45Z", "creator": "at13@online.de", "bug_id": 51173, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 51173, "text": "Is the problem that the XML isn't changing, or that the expected effect in excel isn't seen? (These are two very different problems)", "id": 146215, "time": "2011-05-09T15:58:41Z", "creator": "apache@gagravarr.org", "creation_time": "2011-05-09T15:58:41Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "at13@online.de", "is_private": false, "id": 146237, "attachment_id": null, "bug_id": 51173, "creation_time": "2011-05-10T08:14:54Z", "time": "2011-05-10T08:14:54Z", "text": "Hello!\nI created two xlsx files one with calling the setdx... methods and one without. Then I opened these files as zip files and compared the sheet1.xml files in the folder xl/worksheets. Both of the sheet1.xml-files were exactly the same.\nSo if I did everything correct, it seems that the methods have no effect on the creating of the XML. I am not very familiar with the internal structure of the xslx files."}, {"count": 3, "tags": [], "bug_id": 51173, "text": "OK, these methods DOES have an effect. But the parameter values have to be much bigger in XSSFClientAnchor than in HSSFClientAnchor.\nI have not find out yet, how to calculate these values or what unit they have. \nThe JavaDoc only says e.g. for setDx1(int dx1):\n\"dx1 the x coordinate within the first cell\"\nbut not what unit the parameter has.\nIs there any documentation for that?\nSo I think there is no bug, so this bug entry can be closed?", "id": 146256, "time": "2011-05-11T06:38:35Z", "creator": "at13@online.de", "creation_time": "2011-05-11T06:38:35Z", "is_private": false, "attachment_id": null}, {"count": 4, "attachment_id": null, "bug_id": 51173, "is_private": false, "id": 146263, "time": "2011-05-11T10:00:02Z", "creator": "apache@gagravarr.org", "creation_time": "2011-05-11T10:00:02Z", "tags": [], "text": "Could you try creating a few files with HSSF with various dx/dy values, then open these in Excel, save as .xlsx, and see what the values were written as? That might give us a hint on the scaling factor different between the two formats"}, {"count": 5, "tags": [], "creator": "at13@online.de", "is_private": false, "text": "The secret is solved!\nYou have to calculate everything in pixels, the anchor-width and -height, the image-width and -height and with that the margin values (dx and dy).\nIn the setDx.../setDy... methods you have to multiply the dx/dy pixel-values with the constant XSSFShape.EMU_PER_PIXEL and voila, everything works!\nPleeeeeaaaase write JavaDocs for those secret things! I like the apache libraries and APIs very much and you guys make a great job, but documentation is very important for using the libraries.", "id": 146266, "time": "2011-05-11T13:53:55Z", "bug_id": 51173, "creation_time": "2011-05-11T13:53:55Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 51173, "is_private": false, "text": "Note added in r1102624, thanks for the investigations!", "id": 146301, "time": "2011-05-13T09:24:32Z", "creator": "apache@gagravarr.org", "creation_time": "2011-05-13T09:24:32Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 51173, "is_private": false, "text": "Hi Nick,\n\nI have same issue here. And I have tried every EMU value like XSSFShape.EMU_PER_PIXEL and multiplied it by 10 and 20, but it doesn't make an effect in converted sheet. Images are still coming at the edge of cell.\n\nBelow is the code, i am using write now:\n\nXSSFClientAnchor anchor = new XSSFClientAnchor(XSSFShape.EMU_PER_PIXEL*200,XSSFShape.EMU_PER_PIXEL*200,0,0,(short)col,row,(short)col1,row1);\n\nPlease suggest, if i did anything wrong.\n\nThanks,\nSaurav", "id": 168756, "time": "2013-07-24T11:18:05Z", "creator": "suman.saurav@aptaracorp.com", "creation_time": "2013-07-24T11:18:05Z", "attachment_id": null}, {"count": 8, "attachment_id": null, "bug_id": 51173, "text": "(In reply to suman saurav from comment #7)\n> Hi Nick,\n> \n> I have same issue here. And I have tried every EMU value like\n> XSSFShape.EMU_PER_PIXEL and multiplied it by 10 and 20, but it doesn't make\n> an effect in converted sheet. Images are still coming at the edge of cell.\n> \n> Below is the code, i am using write now:\n> \n> XSSFClientAnchor anchor = new\n> XSSFClientAnchor(XSSFShape.EMU_PER_PIXEL*200,XSSFShape.EMU_PER_PIXEL*200,0,0,\n> (short)col,row,(short)col1,row1);\n> \n> Please suggest, if i did anything wrong.\n> \n> Thanks,\n> Saurav\n\n\nThe real problem behind all these bug report seems to be in XSSFPicture.resize();\n\nIn here we find\n\n anchor.setCol2(col2);\n\n anchor.setDx1(0);  // !!\n\n\n anchor.setDx2(pref.getDx2());\n\n\n anchor.setRow2(row2);\n\n anchor.setDy1(0);  // !!\n\nIn other words calling resize discards any offsets you've set in your anchor.\n\nI've replaced the resize call with:\n\nPicture pic = drawing.createPicture(anchor, pictures.get(value));\nClientAnchor pref = pic.getPreferredSize();\nanchor.setDx2(pref.getDx2() + anchor.getDx1());\nanchor.setDy2(pref.getDy2() + anchor.getDy1());\n\nAnd it works as expected. Something slightly more complicated would be needed if the picture extended over more than one cell.\n\n\n anchor.setDy2(pref.getDy2());\n\nThis kills any offsets you set, and if you don't call resize your picture will probably collapse.\n\nThe resize source could be changed easily enough to preserver dx1 and dy1, and I don't imagine any existing code would break.", "id": 174214, "time": "2014-04-02T10:15:01Z", "creator": "Malcolm.McMahon@costcutter.com", "creation_time": "2014-04-02T10:15:01Z", "tags": [], "is_private": false}]