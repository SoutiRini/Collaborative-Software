[{"count": 0, "tags": [], "text": "Following code throws ClassCastException:\n\n1        HSSFWorkbook workbook = new HSSFWorkbook();\n2        HSSFSheet sheet = workbook.createSheet();\n3        HSSFRow row = sheet.createRow(0);\n4        HSSFCell cell = row.createCell((short) 0);\n5        cell.setCellFormula(\"SUM(1,2)\");\n6        cell.setCellValue(\"TEST\"); // EXCEPTION!!\n\nIt does not matter that the call to setCellValue sets String,\ndouble or boolean. ie the following at line 6 above causes\nthe same error:\n\n6        cell.setCellValue(true);\n6        cell.setCellValue(1);\n\nNotes:\nIn class HSSFCell,\nsetCellValue(..) methods do not call appropriate \nsetCellType(..) if the cell type is CELL_TYPE_FORMULA \n- which is apparently desired behaviour. \nBut before casting \"instanceof XYZRecord\" check is \nnot performed which causes casting of FormulaRecordAggregate\nto throw that exception.\n\nWorkaround:\n  Calling setCellType explicitly prior to setCellValue\ncan prevent the problem... (but it prevents setting\ninitial values for formula cells, which is what I\nwas attempting)", "is_private": false, "id": 76206, "creator": "amolweb@yahoo.com", "time": "2005-06-09T15:35:32Z", "bug_id": 35288, "creation_time": "2005-06-09T15:35:32Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 35288, "attachment_id": null, "id": 118525, "time": "2008-07-10T16:09:50Z", "creator": "apache@gagravarr.org", "creation_time": "2008-07-10T16:09:50Z", "is_private": false, "text": "I believe this is now correctly handled. Please re-open the bug if you still have the same problem with 3.1 final"}]