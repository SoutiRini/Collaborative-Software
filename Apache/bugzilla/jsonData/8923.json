[{"count": 0, "tags": [], "creator": "danrodney@hotmail.com", "is_private": false, "text": "We're writing a web application using JSP and Struts, and recently switched \nfrom Jetty to Tomcat 4.0.3..  A few of our Struts actions return XML to the \nuser rather than forwarding them to a JSP page.  The significant code looks \nlike this:\n\nOutputStream out = response.getOutputStream();\nwriteXMLTo(out);\nout.close();\n\nThis ran fine on Jetty, and it runs fine on Tomcat over clear HTTP, but over \nHTTPS on Tomcat, Internet Explorer (5.0, 5.5, and 6.0) pops up an error message \nsaying it can't download the file after the user chooses to open or save the \nfile.  We have debugging turned up to 99 on everything, but there's no message \nfrom Tomcat that anything is wrong.  What should we do?\n\nThis might be related to bug #7092... I wasn't sure they were the same problem, \nsince we're not using a WarpConnector, and we didn't get any stack traces.", "id": 15745, "time": "2002-05-08T22:13:23Z", "bug_id": 8923, "creation_time": "2002-05-08T22:13:23Z", "attachment_id": null}, {"count": 1, "attachment_id": null, "bug_id": 8923, "is_private": false, "id": 15750, "time": "2002-05-08T23:19:17Z", "creator": "remm@apache.org", "creation_time": "2002-05-08T23:19:17Z", "tags": [], "text": "The example servlets run fine over SSL, and they appear to be doing some very\nsimiliar operations (write data). You'll have to put together a simple servlet\n(easy to compile with no external dependencies) that shows the problem.\n\nCould you also test with Coyote HTTP/1.1 1.0b8 and/or Tomcat 4.1.0 to see if you\nalso get the problem ?"}, {"count": 2, "tags": [], "creator": "danrodney@hotmail.com", "is_private": false, "text": "I've done some more investigation...  the problem only occurs when we run the \nserver with a security constraint for the whole server.\n\nHere's the security constraint section from our web.xml:\n\n  <security-constraint>\n    <web-resource-collection>\n      <web-resource-name>\n  \t Troux Secure Area\n      </web-resource-name>\n      <url-pattern>/*</url-pattern>\n    </web-resource-collection>\n    <auth-constraint>\n      <role-name>trouxuser</role-name>\n    </auth-constraint>\n    <user-data-constraint>\n      <transport-guarantee>CONFIDENTIAL</transport-guarantee>\n    </user-data-constraint>\n  </security-constraint>\n\nWhen we run the server with this constraint, any Struts action which sets an \nunusual content type fails...  the user is prompted to open or save the file, \nbut then Internet Explorer says it can't download the file.  I'll attach an \nexample struts action that demonstrates this.  When we comment out the security \nconstraint, everything runs fine.\n\nAlso, when we run a simple servlet that does exactly the same thing (without \nusing Struts), it runs as expected if there's no security constraint, but if \nthere is a security constraint, Internet Explorer opens the response (even \nthough the response headers should tell it to send the file down to the user.)  \nI'll also attach a servlet demonstrating this.\n\nI've tried using Coyote connectors -- didn't help.  Where can we get Tomcat \n4.1.0?  I only see links to Tomcat 4.0.x from the Tomcat website.\n\nThanks for your help,  \nDan Rodney", "id": 15834, "time": "2002-05-09T18:46:34Z", "bug_id": 8923, "creation_time": "2002-05-09T18:46:34Z", "attachment_id": null}, {"attachment_id": 1824, "tags": [], "bug_id": 8923, "text": "Created attachment 1824\nExample struts action", "count": 3, "id": 15835, "time": "2002-05-09T18:48:26Z", "creator": "danrodney@hotmail.com", "creation_time": "2002-05-09T18:48:26Z", "is_private": false}, {"count": 4, "tags": [], "creator": "danrodney@hotmail.com", "is_private": false, "text": "Created attachment 1825\nExample servlet", "id": 15837, "time": "2002-05-09T18:49:48Z", "bug_id": 8923, "creation_time": "2002-05-09T18:49:48Z", "attachment_id": 1825}, {"count": 5, "tags": [], "creator": "danrodney@hotmail.com", "text": "I'm not sure if this is the same problem, but I found a similar bug here:\n\nhttp://www.apachelabs.org/tomcat-user/200203.mbox/%3c20020312152001.M87251-\n100000@icarus.apache.org%3e", "id": 15844, "time": "2002-05-09T19:27:58Z", "bug_id": 8923, "creation_time": "2002-05-09T19:27:58Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "creator": "danrodney@hotmail.com", "text": "I'm fairly certain this is the same as bug #6641.  However, since that bug \nnever really got fixed, I'm probably going to have to revert to Tomcat \n4.0.1...  I'd rather have a security hole than a broken web application!  (And \nswitching to only supporting Netscape is definitely NOT an option.)  If you \nhave any other suggestions on how I could deal with this, please let me know.\n\n*** This bug has been marked as a duplicate of 6641 ***", "id": 15845, "time": "2002-05-09T19:39:59Z", "bug_id": 8923, "creation_time": "2002-05-09T19:39:59Z", "is_private": false, "attachment_id": null}]