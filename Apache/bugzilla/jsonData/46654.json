[{"count": 0, "tags": [], "creator": "matthew.knl@gmail.com", "attachment_id": 23215, "id": 124615, "time": "2009-02-02T19:35:09Z", "bug_id": 46654, "creation_time": "2009-02-02T19:35:09Z", "is_private": false, "text": "Created attachment 23215\nTesting file\n\nI use following codes to open an Excel file, then call \"sheet.shiftRows\", but the output file cannot be opened by MS Excel. It prompted \"Unable to read file.\" error message.\n--\nHSSFWorkbook wb = new HSSFWorkbook(ExcelUtil.fixInputStream(new FileInputStream(\"unable_to_read_file.xls\")));\nHSSFSheet sheet = wb.getSheet(\"Other\");\nsheet.shiftRows(12, 165, 12, false, true);\nwb.write(new FileOutputStream(\"unable_to_read_file.output.xls\"));\n--\nPlease use the attached file for testing, thanks a lot!"}, {"count": 1, "tags": [], "creator": "josh@apache.org", "attachment_id": null, "id": 124673, "time": "2009-02-04T23:53:14Z", "bug_id": 46654, "creation_time": "2009-02-04T23:53:14Z", "is_private": false, "text": "Fixed in svn r741036 (and svn r741037 )\n\nThe example spreadsheet you supplied has incorrect values in RowRecord firstCol & lastCol.  Excel has no problem with those values being wrong, except when no cells are present.  POI wasn't properly updating these indexes the newly emptied row.  This problem has been fixed and a junit has been added.\n\nSome extra confusion was noticed regarding cell comments (HSSFComment).  It seems like the firstCol and lastCol fields of RowRecord need to take cell comments into account.  POI does not do this yet.  Some significant restructuring might be required to make that work properly."}]