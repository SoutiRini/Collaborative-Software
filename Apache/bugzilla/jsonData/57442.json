[{"count": 0, "tags": [], "bug_id": 57442, "attachment_id": null, "is_private": false, "id": 180294, "time": "2015-01-14T08:41:49Z", "creator": "dondellbatac@gmail.com", "creation_time": "2015-01-14T08:41:49Z", "text": "Hi,\n\nCan somebody help me out. I am a new user of POI and I am using it to extract pptx slides to PNG images, but something went wrong in one of my .pptx file that says Nullpointer. Below is the snippet of the code and full stacktrace.\n\nString path = \"D:\\\\GDrive\\\\Projects\\\\BWServer\\\\BWServer\\\\src\\\\powerpoint_recieved\";\n        FileInputStream is = new FileInputStream(path + \"\\\\snbu-20120924rev.pptx\");\n        XMLSlideShow ppt = new XMLSlideShow(is);\n        is.close();\n\n        double zoom = 1; // magnify it by 2\n        AffineTransform at = new AffineTransform();\n        at.setToScale(zoom, zoom);\n\n        Dimension pgsize = ppt.getPageSize();\n        XSLFSlide[] slide = ppt.getSlides();\n        int slideSize = slide.length;\n        for (int i = 0; i < slideSize; i++) {\n            System.out.println(\"slide-\" + (i + 1));\n            System.out.println(\"\" + slide[i].getTitle());\n\n            BufferedImage img = new BufferedImage((int) Math.ceil(pgsize.width * zoom), (int) Math.ceil(pgsize.height * zoom), BufferedImage.TYPE_INT_RGB);\n            Graphics2D graphics = img.createGraphics();\n            graphics.setTransform(at);\n            //clear the drawing area\n            graphics.setPaint(Color.white);\n            graphics.fill(new Rectangle2D.Float(0, 0, pgsize.width, pgsize.height));\n            // render\n            try {\n                // draw stuff\n                slide[i].draw(graphics);\n            } catch (NullPointerException ex) {\n                ex.printStackTrace();\n            }\n\n            FileOutputStream out = new FileOutputStream(path + \"\\\\sample\\\\slide-\" + (i + 1) + \".png\");\n            javax.imageio.ImageIO.write(img, \"png\", out);\n            out.close();\n\n            StringBuilder strNotesBuild = new StringBuilder();\n            try {\n                XSLFNotes mynotes = slide[i].getNotes();\n                for (XSLFShape shape : mynotes) {\n                    if (shape instanceof XSLFTextShape) {\n                        XSLFTextShape txShape = (XSLFTextShape) shape;\n                        for (XSLFTextParagraph xslfParagraph : txShape.getTextParagraphs()) {\n                            if (SlideNotesUtil.isString(xslfParagraph.getText()) == true) {\n//                                System.out.println(\"Slide \" + (i + 1) + \" Notes: \" + xslfParagraph.getText());\n                                strNotesBuild.append(xslfParagraph.getText()).append(\"\\n\");\n                            }\n                        }\n                        FileUtil.writeSlideNotesFile(path + \"\\\\sample\\\\slide-\" + (i + 1) + \".txt\", strNotesBuild);\n                    }\n                }\n            } catch (Exception e) {\n            }\n        }\n\nOUTPUT:\n\njava.lang.NullPointerException\n\tat org.apache.poi.xslf.usermodel.XSLFPictureShape.getBlipId(XSLFPictureShape.java:118)\n\tat org.apache.poi.xslf.usermodel.XSLFPictureShape.getPictureData(XSLFPictureShape.java:99)\n\tat org.apache.poi.xslf.usermodel.XSLFPictureShape.drawContent(XSLFPictureShape.java:124)\n\tat org.apache.poi.xslf.usermodel.RenderableShape.render(RenderableShape.java:540)\n\tat org.apache.poi.xslf.usermodel.XSLFSimpleShape.draw(XSLFSimpleShape.java:534)\n\tat org.apache.poi.xslf.usermodel.XSLFSheet.draw(XSLFSheet.java:506)\n\tat org.apache.poi.xslf.usermodel.XSLFSheet.draw(XSLFSheet.java:490)\n\tat org.apache.poi.xslf.usermodel.XSLFSheet.draw(XSLFSheet.java:490)\n\tat org.apache.poi.xslf.usermodel.XSLFSlide.draw(XSLFSlide.java:220)\n\tat ppttopng.PptToPng.main(PptToPng.java:55)"}, {"count": 1, "tags": [], "bug_id": 57442, "text": "Can you provide a sample file which shows this problem?", "id": 181413, "time": "2015-03-01T17:50:43Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-03-01T17:50:43Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "kiwiwings@apache.org", "text": "Closing this for now, as we haven't received the file causing this issue.\nPlease reopen when you have uploaded the file.", "count": 2, "id": 184367, "time": "2015-08-05T23:30:31Z", "bug_id": 57442, "creation_time": "2015-08-05T23:30:31Z", "is_private": false}]