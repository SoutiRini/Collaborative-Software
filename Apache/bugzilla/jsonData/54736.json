[{"count": 0, "tags": [], "bug_id": 54736, "attachment_id": 30087, "is_private": false, "id": 166059, "time": "2013-03-21T00:20:45Z", "creator": "trejkaz@trypticon.org", "creation_time": "2013-03-21T00:20:45Z", "text": "Created attachment 30087\ntest.ppt\n\nA test which we had for our own system started failing after updating to POI 3.9 (it was passing in POI 3.7.)\n\nThe PowerPoint file itself is the simplest file we have in our collection, so my assumption is that this is a wide-spread problem which could affect any file. Yet, in our own tests, this is the only file which is failing.\n\n    @Test\n    public void testSlideText() throws Exception {\n        File file = new File(\"test.ppt\");\n        SlideShow slideShow = new SlideShow(new HSLFSlideShow(new FileInputStream(file)));\n        Slide slide1 = slideShow.getSlides()[0];\n        TextRun[] textRuns = slide1.getTextRuns();\n        assertEquals(\"Expected 6 runs of text\", 6, textRuns.length);\n        assertEquals(\"Wrong text\", \"Example Powerpoint\", textRuns[0].getText());\n        assertEquals(\"Wrong text\", \"\\n\", textRuns[1].getText());\n        assertEquals(\"Wrong text\", \"text1\", textRuns[2].getText());\n        assertEquals(\"Wrong text\", \"text2\", textRuns[3].getText());\n        assertEquals(\"Wrong text\", \"text3\", textRuns[4].getText());\n        assertEquals(\"Wrong text\", \"text4\", textRuns[5].getText());\n    }\n\nLike our own internal test, this test also passes on 3.7 but fails on 3.9.\n\n(I posted this to the mailing list as well. No answer came back yet - the mail may have been swallowed - but I have since reproduced it in the absence of any of our own code and dug around for a bit. I can't find the missing text anywhere in the object tree.)"}, {"count": 1, "tags": [], "bug_id": 54736, "attachment_id": null, "is_private": false, "id": 166060, "time": "2013-03-21T00:35:42Z", "creator": "trejkaz@trypticon.org", "creation_time": "2013-03-21T00:35:42Z", "text": "I'm keen enough to get this fixed that I'm willing to apply a patch to my local copy of POI, but I'm not even sure where to start investigating it."}, {"text": "Can I please get someone to look at why this is happening and give me some pointers to where I can start looking to fix it? This is a pretty serious regression which makes POI 3.9 unusable in its current state. :/", "tags": [], "bug_id": 54736, "is_private": false, "count": 2, "id": 166867, "time": "2013-04-26T00:23:24Z", "creator": "trejkaz@trypticon.org", "creation_time": "2013-04-26T00:23:24Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 54736, "is_private": false, "id": 166879, "creation_time": "2013-04-26T18:53:15Z", "time": "2013-04-26T18:53:15Z", "creator": "philip.persad@gmail.com", "text": "Hi Trejkaz,\n\nI filed a similar bug regarding text in tables.  From my (limited) knowledge of .ppt data structures, I suspect that the root cause is the same.  I submitted a patch under the other ticket (Bug 54722) that fixes the problem for our use case.\n\nYou could give that a try to see if it also fixes your issue.  If nothing else, it may point you in the right direction.", "attachment_id": null}, {"count": 4, "tags": [], "text": "Confirmed. I'm not sure if this sheet had tables or not, but either way, that patch fixed it for me. Closing this one as a duplicate.\n\nThanks!\n\n*** This bug has been marked as a duplicate of bug 54722 ***", "is_private": false, "id": 166921, "creator": "trejkaz@trypticon.org", "time": "2013-04-28T23:53:51Z", "bug_id": 54736, "creation_time": "2013-04-28T23:53:51Z", "attachment_id": null}]