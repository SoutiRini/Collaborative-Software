[{"count": 0, "tags": [], "creator": "markuskeller@fastmail.fm", "attachment_id": null, "is_private": false, "id": 145706, "time": "2011-04-11T11:00:12Z", "bug_id": 51049, "creation_time": "2011-04-11T11:00:12Z", "text": "The <junit> task from Ant 1.7.1 produced XML files where the values <property> elements could contain newline characters, e.g.:\n\n    <property name=\"ant.core.lib\" value=\"C:\\e\\i\\I20110127-2034-3.7M5-clean\\plugins\\org.apache.ant_1.7.1.v20100518-1145\\lib\\ant.jar\" />\n    <property name=\"line.separator\" value=\"\n\" />\n\nThe <junitreport> converted this to HTML files where the value in the JavaScript had a single space instead of the line separator characters:\n\n        cur['line.separator'] = ' ';\n\nThis was valid JavaScript.\n\n\nWith Ant 1.8.2, the value in the XML got properly escaped:\n\n    <property name=\"ant.core.lib\" value=\"C:\\e\\i\\N20110407-2000\\plugins\\org.apache.ant_1.8.2.v20110117-1200\\lib\\ant.jar\" />\n    <property name=\"line.separator\" value=\"&#xd;&#xa;\" />\n\nBut now, the <junitreport> task creates JavaScript like this, which is invalid:\n\n        cur['line.separator'] = '\n\n';\n    \n        cur['os.arch'] = 'x86';\n\n=> There are 2 line separators in the HTML file. Should be something like:\n\n         cur['line.separator'] = '&#xd;&#xa;';"}, {"count": 1, "text": "Created attachment 26873\nHTML file with broken Properties link", "bug_id": 51049, "attachment_id": 26873, "id": 145707, "time": "2011-04-11T11:01:31Z", "creator": "markuskeller@fastmail.fm", "creation_time": "2011-04-11T11:01:31Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 51049, "attachment_id": null, "text": "It looks like the XSL stylesheets junit-frames.xsl and junit-noframes.xsl are not escaping newline characters in the javascript sections. I found this blog page that pretty much sums up the problem and remedy:\n\nhttp://zanstra.com/base/blog/xslt_string_escape\n\nSpecifically, the stylesheets should replace &#xd; with \\r and &#xa; with \\n. I'll attach a patch that involves updating the JS-escape template in the stylesheet shortly.", "id": 146336, "time": "2011-05-16T03:53:58Z", "creator": "acwwat@gmail.com", "creation_time": "2011-05-16T03:53:58Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 51049, "attachment_id": 27001, "id": 146337, "time": "2011-05-16T04:09:49Z", "creator": "acwwat@gmail.com", "creation_time": "2011-05-16T04:09:49Z", "is_private": false, "text": "Created attachment 27001\nPatch for escaping newline chars properly in junit report stylesheets\n\nThe xsl files to patch are in ant/src/etc and named the same as the diffs files respectively."}, {"count": 4, "text": "Ping. Could this go into 1.8.3?", "bug_id": 51049, "attachment_id": null, "id": 150958, "time": "2011-10-27T13:21:49Z", "creator": "markuskeller@fastmail.fm", "creation_time": "2011-10-27T13:21:49Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "creator": "jglick@apache.org", "attachment_id": null, "is_private": false, "id": 151345, "time": "2011-11-09T19:45:26Z", "bug_id": 51049, "creation_time": "2011-11-09T19:45:26Z", "text": "Committed revision 1199931. Please verify fix in a nightly build if you have a moment."}, {"count": 6, "tags": [], "bug_id": 51049, "is_private": false, "id": 152698, "attachment_id": null, "creator": "markuskeller@fastmail.fm", "creation_time": "2012-01-11T17:35:10Z", "time": "2012-01-11T17:35:10Z", "text": "Looks good, thanks. Sorry for the delay.\n\nTested with nightly build from https://builds.apache.org/view/A-F/view/Ant/job/Ant_JDK_1.4/486/artifact/trunk/build/lib/"}, {"count": 7, "tags": [], "bug_id": 51049, "attachment_id": null, "text": "*** Bug 55425 has been marked as a duplicate of this bug. ***", "id": 169490, "time": "2013-08-16T06:21:28Z", "creator": "bodewig@apache.org", "creation_time": "2013-08-16T06:21:28Z", "is_private": false}]