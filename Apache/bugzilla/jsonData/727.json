[{"count": 0, "tags": [], "text": "after some time Tomcat use nobody as database password.\nso he get no connection to the database. We use MySql as database", "is_private": false, "id": 876, "creator": "andre.gommlich@netkom.de", "time": "2001-02-27T05:28:22Z", "bug_id": 727, "creation_time": "2001-02-27T05:28:22Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 727, "text": "Please add more info on this bug.., log content, conf files, etc..\nLater we can reopen it but for now it works for me..or is fixed on 3.2.2 and up", "id": 902, "time": "2001-02-28T06:42:47Z", "creator": "craig.mcclanahan@sun.com", "creation_time": "2001-02-28T06:42:47Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "andre.gommlich@netkom.de", "is_private": false, "text": "here are additional information:\n snip of tomcat.log\n2001-03-01 05:04:19 - ContextManager: JDBCRealm: Auth ok, user=xyz\n2001-03-01 05:04:19 - ContextManager: JDBCRealm: Controled access for voigtt R\n( /port + /jsp/index.jsp + null) Ct (jsp\n(org.apache.jasper.servlet.JspServlet/null) )\n2001-03-01 05:04:19 - ContextManager: JDBCRealm: Auth ok, first role=app\n2001-03-01 05:04:20 - ContextManager: JDBCRealm: Authentication successful for \nuser xyz\n2001-03-01 05:04:20 - ContextManager: JDBCRealm: Auth ok, user=xyz\n2001-03-01 05:04:20 - ContextManager: JDBCRealm: Controled access for xyz R\n( /port + /jsp/inhalt.jsp + null) Ct (jsp\n(org.apache.jasper.servlet.JspServlet/null) )\n2001-03-01 05:04:20 - ContextManager: JDBCRealm: Auth ok, first role=app\n2001-03-02 07:11:24 - ContextManager: JDBCRealm: The database connection is \nnull or was found to be closed. Trying to re-open it.\n2001-03-02 07:11:24 - ContextManager: JDBCRealm: There was an SQLException \nwhile in authenticate: null\n2001-03-02 07:11:24 - ContextManager: JDBCRealm: SQLException: \njava.sql.SQLException: Invalid authorization specification: Access denied for \nuser: 'nobody@lx0004.de' (Using password: NO)\n2001-03-02 07:11:34 - ContextManager: JDBCRealm: The database connection is \nnull or was found to be closed. Trying to re-open it.\n2001-03-02 07:11:34 - ContextManager: JDBCRealm: There was an SQLException \nwhile in authenticate: xyz1\n2001-03-02 07:11:34 - ContextManager: JDBCRealm: SQLException: \njava.sql.SQLException: Invalid authorization specification: Access denied for \nuser: 'nobody@lx0004.de' (Using password: NO)\n2001-03-02 07:18:04 - ContextManager: JDBCRealm: The database connection is \nnull or was found to be closed. Trying to re-open it.\n2001-03-02 07:18:04 - ContextManager: JDBCRealm: There was an SQLException \nwhile in authenticate: null\n2001-03-02 07:18:04 - ContextManager: JDBCRealm: SQLException: \njava.sql.SQLException: Invalid authorization specification: Access denied for \nuser: 'nobody@lx0004.de' (Using password: NO)\n2001-03-02 07:18:14 - ContextManager: JDBCRealm: The database connection is \nnull or was found to be closed. Trying to re-open it.\n2001-03-02 07:18:14 - ContextManager: JDBCRealm: There was an SQLException \nwhile in authenticate: xyz1\n2001-03-02 07:18:14 - ContextManager: JDBCRealm: SQLException: \njava.sql.SQLException: Invalid authorization specification: Access denied for \nuser: 'nobody@lx0004.de' (Using password: NO)\n2001-03-02 08:06:00 - ContextManager: JDBCRealm: The database connection is \nnull or was found to be closed. Trying to re-open it.\n2001-03-02 08:06:00 - ContextManager: JDBCRealm: There was an SQLException \nwhile in authenticate: null\n2001-03-02 08:06:00 - ContextManager: JDBCRealm: SQLException: \njava.sql.SQLException: Invalid authorization specification: Access denied for \nuser: 'nobody@lx0004.de' (Using password: NO)\n2001-03-02 08:06:08 - ContextManager: JDBCRealm: The database connection is \nnull or was found to be closed. Trying to re-open it.\n2001-03-02 08:06:08 - ContextManager: JDBCRealm: There was an SQLException \nwhile in authenticate: xyz2\n2001-03-02 08:06:08 - ContextManager: JDBCRealm: SQLException: \njava.sql.SQLException: Invalid authorization specification: Access denied for \nuser: 'nobody@lx0004.de' (Using password: NO)\n2001-03-02 08:06:12 - ContextManager: JDBCRealm: The database connection is \nnull or was found to be closed. Trying to re-open it.\n2001-03-02 08:06:12 - ContextManager: JDBCRealm: There was an SQLException \nwhile in authenticate: xyz2\n2001-03-02 08:06:12 - ContextManager: JDBCRealm: SQLException: \njava.sql.SQLException: Invalid authorization specification: Access denied for \nuser: 'nobody@lx0004.de' (Using password: NO)\n2001-03-02 08:06:14 - ContextManager: JDBCRealm: The database connection is \nnull or was found to be closed. Trying to re-open it.\n2001-03-02 08:06:15 - ContextManager: JDBCRealm: There was an SQLException \nwhile in authenticate: xyz2\n2001-03-02 08:06:15 - ContextManager: JDBCRealm: SQLException: \njava.sql.SQLException: Invalid authorization specification: Access denied for \nuser: 'nobody@lx0004.de' (Using password: NO)\n\nend of snip\n\nsnip of server.xml\n\n<!--   MySQL User Realm -->\n        <RequestInterceptor\n                className=\"org.apache.tomcat.request.JDBCRealm\" debug=\"99\"\n                driverName=\"org.gjt.mm.mysql.Driver\"\n                connectionURL=\"jdbc:mysql://lx0004.de:3306/lanports\"\n                connectionName=\"mysqldb\"\n                connectionPassword=\"zre\"\n                userTable=\"users\"\n                userNameCol=\"user_name\"\n                userCredCol=\"user_pass\"\n                userRoleTable=\"user_roles\"\n                roleNameCol=\"role_name\"\n        />\nend of snip\n\n", "id": 930, "time": "2001-03-01T23:41:08Z", "bug_id": 727, "creation_time": "2001-03-01T23:41:08Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 727, "is_private": false, "count": 3, "id": 968, "time": "2001-03-05T01:44:13Z", "creator": "Nick.Holloway@pyrites.org.uk", "creation_time": "2001-03-05T01:44:13Z", "text": "Looking at the code, the version of JDBCRealm in 3.2.1 did not use the username \nand password when reopening a connection that becomes closed.\n\nThe current version of JDBCRealm does always use the specified username and \npassword, and so this should be fixed in the forthcoming 3.2.2."}, {"count": 4, "tags": [], "bug_id": 727, "attachment_id": null, "is_private": false, "id": 970, "time": "2001-03-05T01:47:15Z", "creator": "nacho@apache.org", "creation_time": "2001-03-05T01:47:15Z", "text": "Fixed on 3.2.2 and up.\nFixed on 3.3."}, {"count": 5, "tags": [], "creator": "edwin@finalist.com", "is_private": false, "text": "The problem is that MySQL closes the connection after a timeout (default=8 \nhours).\nWhen the JDBCRealm gets an exception, the connection is set to null. This will \nforce a reopen of the database.... \nBUT: the prepared statements are not set to null. This causes null-pointer \nexceptions. I modified the JDBCRealm class to set the prepared statements to \nnull whenever the connection is set to null. This fixes the problem (only minor \nproblem is that after the timeout, a user has to log on twice, because the \nfirst time, only the variables are reset).", "id": 3372, "time": "2001-07-03T08:33:27Z", "bug_id": 727, "creation_time": "2001-07-03T08:33:27Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 727, "attachment_id": null, "is_private": false, "id": 3373, "time": "2001-07-03T08:35:01Z", "creator": "edwin@finalist.com", "creation_time": "2001-07-03T08:35:01Z", "text": "The problem is that MySQL closes the connection after a timeout (default=8 \nhours).\nWhen the JDBCRealm gets an exception, the connection is set to null. This will \nforce a reopen of the database.... \nBUT: the prepared statements are not set to null. This causes null-pointer \nexceptions. I modified the JDBCRealm class to set the prepared statements to \nnull whenever the connection is set to null. This fixes the problem (only minor \nproblem is that after the timeout, a user has to log on twice, because the \nfirst time, only the variables are reset)."}, {"count": 7, "tags": [], "creator": "nacho@apache.org", "is_private": false, "id": 3456, "creation_time": "2001-07-06T13:54:38Z", "time": "2001-07-06T13:54:38Z", "bug_id": 727, "text": "\n\n*** This bug has been marked as a duplicate of 2149 ***", "attachment_id": null}]