[{"count": 0, "attachment_id": null, "creator": "datasurfer@gmail.com", "text": "package gabrieljones.poi;\n\nimport org.apache.poi.ss.usermodel.DataConsolidateFunction;\nimport org.apache.poi.ss.util.AreaReference;\nimport org.apache.poi.ss.util.CellReference;\nimport org.apache.poi.xssf.usermodel.XSSFPivotTable;\nimport org.apache.poi.xssf.usermodel.XSSFRow;\nimport org.apache.poi.xssf.usermodel.XSSFSheet;\nimport org.apache.poi.xssf.usermodel.XSSFWorkbook;\n\nimport java.io.FileOutputStream;\n\npublic class Main {\n\n    public static void main(String[] args) throws Exception {\n        XSSFWorkbook wb = new XSSFWorkbook();\n        XSSFSheet sheet = (XSSFSheet) wb.createSheet();\n\n        XSSFRow row1 = sheet.createRow(0);\n        row1.createCell(0).setCellValue(\"Names\");\n        row1.createCell(1).setCellValue(\"#\");\n        row1.createCell(2).setCellValue(\"Data\");\n        row1.createCell(3).setCellValue(\"Value\");\n        XSSFRow row2 = sheet.createRow(1);\n        row2.createCell(0).setCellValue(\"Jan\");\n        row2.createCell(1).setCellValue(10);\n        row2.createCell(2).setCellValue(\"Apa\");\n        row2.createCell(3).setCellValue(11.11);\n        XSSFRow row3 = sheet.createRow(2);\n        row3.createCell(0).setCellValue(\"Ben\");\n        row3.createCell(1).setCellValue(9);\n        row3.createCell(2).setCellValue(\"Bepa\");\n        row3.createCell(3).setCellValue(12.12);\n\n        XSSFPivotTable pivotTable = sheet.createPivotTable(new AreaReference(\"A1:D3\"), new CellReference(0,5));\n\n        pivotTable.addRowLabel(2);\n        pivotTable.addColumnLabel(DataConsolidateFunction.COUNT, 1);\n        pivotTable.addReportFilter(0); //This line renders the resulting xlsx file unreadable\n\n        wb.write(new FileOutputStream(\"reportFilter.xlsx\"));\n    }\n}", "id": 193554, "time": "2016-09-07T20:06:29Z", "bug_id": 60094, "creation_time": "2016-09-07T20:06:29Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 60094, "attachment_id": null, "text": "I also wrote out the workbook generated in the following test case.\n\nhttps://svn.apache.org/viewvc/poi/trunk/src/ooxml/testcases/org/apache/poi/xssf/usermodel/TestXSSFPivotTable.java?view=markup#l293\n\nIt was also unreadable to Excel 2010", "id": 193555, "time": "2016-09-07T20:31:06Z", "creator": "datasurfer@gmail.com", "creation_time": "2016-09-07T20:31:06Z", "is_private": false}, {"count": 2, "tags": [], "text": "Created attachment 34251\nreportFilter.xlsx\n\nLibreOffice 4.0.4.2 does not report any problems with the generated file.\n\nHowever, Excel 2013 reported:\n\"We found a problem with some content in 'reportFilter.xlsx'. Do you want us to try to recover as much as we can? If you trust the source of this workbook, click Yes.\"\n\n\"There is not enough memory available to create the PivotTable report. To make more memory available, try the following:\n* Reduce the number of column or row fields you include in the PivotTable report.\n* Close files or programs you aren't using.\"\n\n\"Repairs to 'reportFilter.xlsx'\"\nExcel was able to open the file by repairing or removing the unreadable content.\nRemoved Records: Style from /xl/workbook.xml part (Workbook)\"\n\nThe contents of workbook.xml are below:\n<workbook xmlns=\"...\">\n  <workbookPr date1904=\"false\"/>\n  <bookViews>\n    <workbookView activeTab=\"0\"/>\n  </bookViews>\n  <sheets>\n    <sheet name=\"Sheet0\" r:id=\"rId3\" sheetId=\"1\"/>\n  </sheets>\n  <pivotCaches>\n    <pivotCache cacheId=\"2\" r:id=\"rId4\"/>\n  </pivotCaches>\n</workbook>\n\nThere may also be something wrong with /xl/pivotTables/pivotTable1.xml", "attachment_id": 34251, "bug_id": 60094, "id": 193733, "time": "2016-09-14T22:59:49Z", "creator": "onealj@apache.org", "creation_time": "2016-09-14T22:59:49Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 60094, "attachment_id": 34256, "text": "Created attachment 34256\nreportFilter.xlsx created by hand in Excel 2013", "id": 193754, "time": "2016-09-15T20:56:47Z", "creator": "onealj@apache.org", "creation_time": "2016-09-15T20:56:47Z", "is_private": false}, {"count": 4, "attachment_id": 34257, "bug_id": 60094, "is_private": false, "id": 193755, "time": "2016-09-15T21:29:28Z", "creator": "onealj@apache.org", "creation_time": "2016-09-15T21:29:28Z", "tags": [], "text": "Created attachment 34257\nDiff of Apache POI-generated and Excel created reportFilter.xlsx"}]