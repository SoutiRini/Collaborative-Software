[{"count": 0, "tags": [], "bug_id": 46368, "attachment_id": null, "is_private": false, "id": 123194, "time": "2008-12-09T08:53:55Z", "creator": "TerryRPaul@gmail.com", "creation_time": "2008-12-09T08:53:55Z", "text": "If the length of a HSSFRichTextString object is > 32767, then a call to the length() method returns a negative value = 32767 - length.\n\nThough this isn't a big deal if it's expected behavior, it would be great to either change the method or update the Javadocs to specify this behavior."}, {"count": 1, "tags": [], "bug_id": 46368, "is_private": false, "text": "Almost certainly a short vs int issue\n\nCan you please upload a file that triggers this, so we have something to hand to write a unit test against?", "id": 123195, "time": "2008-12-09T08:56:54Z", "creator": "apache@gagravarr.org", "creation_time": "2008-12-09T08:56:54Z", "attachment_id": null}, {"count": 2, "attachment_id": 23006, "creator": "TerryRPaul@gmail.com", "is_private": false, "id": 123196, "time": "2008-12-09T09:12:16Z", "bug_id": 46368, "creation_time": "2008-12-09T09:12:16Z", "tags": [], "text": "Created attachment 23006\nContains string that exceeds max length of Excel cell.\n\nThe attached file contains the String that when loaded into an HSSFRichTextString causes the length() method to return a negative number."}, {"count": 3, "attachment_id": null, "creator": "TerryRPaul@gmail.com", "is_private": false, "id": 123197, "time": "2008-12-09T09:18:42Z", "bug_id": 46368, "creation_time": "2008-12-09T09:18:42Z", "tags": [], "text": "Uploaded an attachment containing a String longer than 32767 to assist in testing."}, {"count": 4, "attachment_id": null, "creator": "apache@gagravarr.org", "is_private": false, "id": 123200, "time": "2008-12-09T09:41:26Z", "bug_id": 46368, "creation_time": "2008-12-09T09:41:26Z", "tags": [], "text": "The attached file appears to be plain text, and not an excel file :(\n\nAny chance you could check your attachment, and re-upload?"}, {"count": 5, "tags": [], "text": "Actually, I found the bug when I was creating an Excel file from an XML file, from which this plain text was extracted.\n\nThe logic that lead to the discovery was reading the text from the XML file, creating an HSSFRichTextString object with the text, and then checking the length of that HSSFRichTextString before calling HSSFCell.setCellValue() to ensure it didn't exceed our max allowable length for a cell.\n\nApologies for not being more clear in my original description.", "attachment_id": null, "id": 123203, "creator": "TerryRPaul@gmail.com", "time": "2008-12-09T10:22:58Z", "bug_id": 46368, "creation_time": "2008-12-09T10:22:58Z", "is_private": false}, {"count": 6, "tags": [], "text": "Fixed in svn trunk, r724848\n", "is_private": false, "id": 123205, "creator": "apache@gagravarr.org", "time": "2008-12-09T11:37:37Z", "bug_id": 46368, "creation_time": "2008-12-09T11:37:37Z", "attachment_id": null}]