[{"count": 0, "tags": [], "bug_id": 45976, "is_private": false, "text": "Created attachment 22702\nlogs from example runs\n\nrunning a test with a couple of http-requests on e.g. 3 remote hosts ends up in a csv-result file that contains not all entries for the requests. The results from the host which finished first are complete, but all following results are lost.\n\nTo prove my assertion I did 2 runs (5 and 10 threads) of a test plan with 9-http-requests and inspected the logs (client-log, server-log and result-files are attached).\n\n1st run:\n9 requests x 5 user/threads = 45 samples per remote host expected\nstart/end from client-log:\njmeter.JMeter: Started remote host:  server-3 (1223557140659)\njmeter.JMeter: Started remote host:  server-2 (1223557140672)\njmeter.JMeter: Started remote host:  server-1 (1223557140719)\njmeter.JMeter: Finished remote host: server-1 (1223557162864)\njmeter.JMeter: Finished remote host: server-3 (1223557163090)\njmeter.JMeter: Finished remote host: server-2 (1223557163128)\ncsv contains 45 samples from server-1, 41 from server-2 and 41 from server-3\n\n2nd run:\n9 requests x 10 user/threads = 90 samples per remote host expected\njmeter.JMeter: Started remote host:  server-2 (1223558448230)\njmeter.JMeter: Started remote host:  server-3 (1223558448236)\njmeter.JMeter: Started remote host:  server-1 (1223558448243)\njmeter.JMeter: Finished remote host: server-3 (1223558491281)\njmeter.JMeter: Finished remote host: server-1 (1223558491458)\njmeter.JMeter: Finished remote host: server-2 (1223558491598)\ncsv contains 90 samples from server-3, 84 from server-1 and 86 from server-2", "id": 121346, "time": "2008-10-09T07:39:27Z", "creator": "frank.diedrich@tietoenator.com", "creation_time": "2008-10-09T07:39:27Z", "attachment_id": 22702}, {"count": 1, "tags": [], "creator": "sebb@apache.org", "text": "Were you running the client JMeter engine in non-GUI mode?\n\nIf so, what happens if you run in GUI mode? Do all the results get returned?", "id": 121348, "time": "2008-10-09T07:56:48Z", "bug_id": 45976, "creation_time": "2008-10-09T07:56:48Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "frank.diedrich@tietoenator.com", "text": ">Were you running the client JMeter engine in non-GUI mode?\n\nyes, the examples were taken from the engine in non-GUI mode\n\n>what happens if you run in GUI mode? Do all the results get returned?\n\nyes, all samples get returned\n\n", "id": 121356, "time": "2008-10-09T08:54:32Z", "bug_id": 45976, "creation_time": "2008-10-09T08:54:32Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "sebb@apache.org", "text": "OK, thanks.\n\nIt looks like non-GUI mode is exitting before all the samples have been processed.\n\nI'm not yet sure how that can happen.", "id": 121359, "time": "2008-10-09T09:03:54Z", "bug_id": 45976, "creation_time": "2008-10-09T09:03:54Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "sebb@apache.org", "text": "Further investigation shows that test is finising normally, but the file is being closed too early. [Also, the same problem can occur in GUI tests.]\n\nThe files are written by the ResultCollector class. Its testEnded() method checks the Set of hosts to see if there are any other tests running. However this check is faulty, because the Set of hosts is local to the class instance, and there will be one instance per remote server.\n\n==\n\nA work-round in the meantime is to ensure that there is a pause at the end of the test plan. The pause must be long enough to ensure that the last sample reaches the client before the first test completes.\n\nThe Test Action sampler can be used for this as it does not generate a sample.  If there is only one Thread Group in the test plan, then add a second thread group with one thread containing the Test Action sampler, and set the thread groups to run consecutively.\n\nThe bug only affects tests which run on multiple hosts at once.", "id": 121426, "time": "2008-10-10T13:26:56Z", "bug_id": 45976, "creation_time": "2008-10-10T13:26:56Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 45976, "text": "Fix committed to SVN trunk:\n\nURL: http://svn.apache.org/viewvc?rev=703603&view=rev\nLog:\nBug 45976 - incomplete result file when using remote testing with more than 1 server\n\nIf you want to try this out, nightly builds after r703603 will have the fix.", "count": 5, "id": 121429, "time": "2008-10-10T16:42:01Z", "creator": "sebb@apache.org", "creation_time": "2008-10-10T16:42:01Z", "is_private": false}]