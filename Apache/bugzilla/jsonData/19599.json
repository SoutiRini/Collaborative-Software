[{"count": 0, "tags": [], "bug_id": 19599, "attachment_id": null, "text": "This seems to be data-related...when I remove the cell containing \nthe \"C10...\", it works fine.\n\njava.lang.IllegalArgumentException: Cannot store a duplicate value (\"C10, C17, \nC19-20, C24, C35, C44, C55, C75, C84, C96, C99-105, C147, C150\") in this Map\n\tat org.apache.poi.util.BinaryTree.insertValue(BinaryTree.java:1395)\n\tat org.apache.poi.util.BinaryTree.put(BinaryTree.java:1580)\n\tat org.apache.poi.hssf.record.SSTRecord.processString\n(SSTRecord.java:1033)\n\tat org.apache.poi.hssf.record.SSTRecord.manufactureStrings\n(SSTRecord.java:960)\n\tat org.apache.poi.hssf.record.SSTRecord.processContinueRecord\n(SSTRecord.java:592)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java:210)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:140)\n\tat com.we.indentedbom.POIExample.main(POIExample.java:40)\n\n\nI'm trying to read the spreadsheet and it works fine except for the value I \nrefer to above.  Below is the code I'm using to walk the worksheet.\n\npublic class POIExample {\n\n    public static void main( String [] args ) {\n        try {\n        \tboolean DEBUG = true;\n\t\t\tString workbook = null;\n\t\t\tString xlateTemplate = null;\n        \tif (args != null)\n        \t{\n        \t\ttry\n        \t\t{\n\t\t\t\t\tworkbook = args[0];\n\t\t\t\t\txlateTemplate = args[1];\n\t\t\t\t\tSystem.out.println(\"workbook name: \" + \nworkbook + \"     xlateTemplate: \" + xlateTemplate);\n\t\t\t\t\t//POIFSFileSystem fs =\tnew \nPOIFSFileSystem(new FileInputStream(\"c:/workbook.xls\"));\n\t\t\t\t\tPOIFSFileSystem fs =\tnew \nPOIFSFileSystem(new FileInputStream(\"C:/orion/default-web-\napp/secure/plants/customerboms/filtronics.xls\"));\n\n\t\t\t\t\tHSSFWorkbook wb = new HSSFWorkbook(fs);\n\t\t\t\t\tHSSFSheet sheet = wb.getSheetAt(0);\n\n\t\t\t\t\t// Iterate over each row in the sheet\n\t\t\t\t\tIterator rows = sheet.rowIterator(); \n\t\t\t\t\twhile( rows.hasNext() ) \n\t\t\t\t\t{           \n\t\t\t\t\t\tHSSFRow row = (HSSFRow) \nrows.next();\n\t\t\t\t\t\tSystem.out.println( \"----------\n-----  Row #\" + row.getRowNum() );\n\t\t\t\t\t\tshort lastCell = \nrow.getLastCellNum();\n\t\t\t\t\t\tfor (short i=0;i<lastCell;i++) \n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttry\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tHSSFCell cell \n= row.getCell(i);\n\t\t\t\t\t\t\t\n\tSystem.out.println( \"Cell #\" + cell.getCellNum() );\n\t\t\t\t\t\t\t\tswitch ( \ncell.getCellType() ) {\n\t\t\t\t\t\t\t\t\tcase \nHSSFCell.CELL_TYPE_NUMERIC:\n\t\t\t\t\t\t\t\t\t\n\tSystem.out.println( \"Number: \" + cell.getNumericCellValue() );\n\t\t\t\t\t\t\t\t\t\n\tbreak;\n\t\t\t\t\t\t\t\t\tcase \nHSSFCell.CELL_TYPE_STRING: \n\t\t\t\t\t\t\t\t\t\n\tSystem.out.println( \"String: \" + cell.getStringCellValue().replace\n(',', '_') );\n\t\t\t\t\t\t\t\t\t\n\tbreak;\n\t\t\t\t\t\t\t\t\n\tdefault:\n\t\t\t\t\t\t\t\t\t\n\tif(DEBUG)\n\t\t\t\t\t\t\t\t\t\n\t{\n\t\t\t\t\t\t\t\t\t\n\t\t//System.out.println( \"unsuported sell type\" );\n\t\t\t\t\t\t\t\t\t\n\t}\n\t\t\t\t\t\t\t\t\t\n\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcatch\n(NullPointerException npe)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(DEBUG)\n\t\t\t\t\t\t\t\t\n\tSystem.out.println(\"Nullpointer Caught\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n    \n\t\t\t\t\t}\n        \t\t}\n        \t\tcatch(ArrayIndexOutOfBoundsException oob)\n        \t\t{\n        \t\t\tSystem.out.println(\"You must pass both the \nworkbook and the template file.\");\n\t\t\t\t\tSystem.err.println(\"You must pass both \nthe workbook and the template file.\");\n        \t\t\toob.printStackTrace();\n        \t\t}\n\t\t\t\t\n        \t}\n        \telse\n        \t{\n        \t\tSystem.err.println(\"you must pass the workbook name to \nbe formatted and teh temp\");\n        \t}\n        \t\n        \t\n            \n        } catch ( IOException ex ) {\n            ex.printStackTrace();\n        }\n    }\n    \n}", "id": 36594, "time": "2003-05-02T15:55:08Z", "creator": "b2n2zjm@yahoo.com", "creation_time": "2003-05-02T15:55:08Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 19599, "attachment_id": null, "id": 36762, "time": "2003-05-06T16:09:42Z", "creator": "avik@apache.org", "creation_time": "2003-05-06T16:09:42Z", "is_private": false, "text": "You need to attach a simple example workbook that exhibits this error. "}, {"count": 2, "tags": [], "bug_id": 19599, "attachment_id": 6238, "is_private": false, "id": 36768, "time": "2003-05-06T18:16:48Z", "creator": "b2n2zjm@yahoo.com", "creation_time": "2003-05-06T18:16:48Z", "text": "Created attachment 6238\nsource file that caused error...also found that it is an unsupported data cell_type"}, {"count": 3, "tags": [], "text": "Created attachment 6337\nthe input excel file", "is_private": false, "bug_id": 19599, "id": 37106, "time": "2003-05-13T04:55:01Z", "creator": "james.xu@alcatel-sbell.com.cn", "creation_time": "2003-05-13T04:55:01Z", "attachment_id": 6337}, {"count": 4, "tags": [], "bug_id": 19599, "attachment_id": null, "text": "I have this problem too,the error message is:\nCaused by: java.lang.IllegalArgumentException: Cannot store a duplicate value (\"\n\u017d\u0178\") in this Map\n        at org.apache.poi.util.BinaryTree.insertValue(BinaryTree.java:1395)\n        at org.apache.poi.util.BinaryTree.put(BinaryTree.java:1580)\n        at org.apache.poi.hssf.record.SSTRecord.processString(SSTRecord.java:103\n3)\n        at org.apache.poi.hssf.record.SSTRecord.manufactureStrings(SSTRecord.jav\na:960)\n        at org.apache.poi.hssf.record.SSTRecord.fillFields(SSTRecord.java:818)\n        at org.apache.poi.hssf.record.Record.fillFields(Record.java:142)\n        at org.apache.poi.hssf.record.Record.<init>(Record.java:104)\n        at org.apache.poi.hssf.record.SSTRecord.<init>(SSTRecord.java:161)\n        ... 11 more\nException in thread \"main\" org.apache.poi.hssf.record.RecordFormatException: Una\nble to construct record instance, the following exception occured: null\n        at org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.j\nava:259)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.\njava:184)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:1\n40)\n        at cn.com.asb.fsms.utility.xlsGenerator.FillTemplateforCity(xlsGenerator\n.java:189)\n        at cn.com.asb.fsms.report.ReportGenerator.GenerateCityReport(ReportGener\nator.java:463)\n        at cn.com.asb.fsms.report.ReportGenerator.Generator(ReportGenerator.java\n:176)\n        at cn.com.asb.fsms.report.ReportGenerator.main(ReportGenerator.java:305)\n\nPress any key to continue...\n\nThis is a chinese Excel file,and the bookwork include 2 sheets,each sheet have \na column filled \"\u017d\u0178\",and if I delete the columne \"\u017d\u0178\" in one sheet,it's ok!", "id": 37107, "time": "2003-05-13T04:56:46Z", "creator": "james.xu@alcatel-sbell.com.cn", "creation_time": "2003-05-13T04:56:46Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 19599, "attachment_id": null, "text": "Is this still a problem in 2.0-pre2", "id": 41390, "time": "2003-07-24T16:28:58Z", "creator": "poi-support@buni.org", "creation_time": "2003-07-24T16:28:58Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 19599, "attachment_id": null, "text": "Fixed in CVS. Testcase Added. Will go into 2.0RC1", "id": 46367, "time": "2003-10-28T11:00:23Z", "creator": "avik@apache.org", "creation_time": "2003-10-28T11:00:23Z", "is_private": false}]