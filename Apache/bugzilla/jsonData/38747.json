[{"count": 0, "attachment_id": null, "creator": "nandu.k@motorola.com", "is_private": false, "id": 86070, "time": "2006-02-22T06:37:08Z", "bug_id": 38747, "creation_time": "2006-02-22T06:37:08Z", "tags": [], "text": "The AntClassLoader continues to delegate to the parent classloader when \nretreiving resources via the getResource() or getResourceAsStream() APIs, even \nthough it blocks this delegation when loading classes. This inconsistency in \nretreiving resources and loading classes leads to issues where the Ant \ndistribution provides any service implementations using the Service API \n(specified in the JAR file specification : \nhttp://java.sun.com/j2se/1.4.2/docs/guide/jar/jar.html#Service%20Provider ). A \ngood example is the Xerces parser distributed with Ant. It uses the Services \nmechanism to indicate the parser implementation.\n\nThe problem arises, for example, when running a Java application that \ninstantiates a JAXP parser through an Ant java task. You would run into a \nParserConfigurationError unless you set fork to true on the java task, or \nincluded the xerces libraries in the <classpath> element for the java task. \n\nThe reason for this issues appears to be because the Ant classloader created \nfor the java task is running in isolated mode. However, it still does delegate \nto the parent classloader (the Ant coreloader) when attempting to retreive \nresources. When instantiating the parser factory, the JAXP implementation \nattempts to locate the right factory to instantiate by searching for (amongst \nother things), the resource META-INF/services/javax.xml.parsers.SAXParserFactory\n(DocumentBuilderFactory) in the classpath. This is available to the parent \ncoreloader from the xercesImpl.jar in ANT_HOME/lib, and is retreivable by the \nAntClassLoader even in the isolated mode. Next, it attempts to load the Factory \nclass, which it fails to do, because it cannot now delegate to the coreloader."}, {"count": 1, "tags": [], "bug_id": 38747, "text": "Fixed in SVN. ", "id": 93292, "time": "2006-09-09T21:20:35Z", "creator": "peterreilly@apache.org", "creation_time": "2006-09-09T21:20:35Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 38747, "text": "Reverting this for the moment as gump failed\n", "id": 94185, "time": "2006-09-27T22:15:02Z", "creator": "peterreilly@apache.org", "creation_time": "2006-09-27T22:15:02Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "applied the fix again, this time for getResource as\nwell", "is_private": false, "bug_id": 38747, "id": 94499, "time": "2006-10-04T14:28:47Z", "creator": "peterreilly@apache.org", "creation_time": "2006-10-04T14:28:47Z", "attachment_id": null}]