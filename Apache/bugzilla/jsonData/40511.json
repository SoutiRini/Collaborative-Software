[{"count": 0, "tags": [], "bug_id": 40511, "attachment_id": null, "id": 93580, "time": "2006-09-14T13:32:47Z", "creator": "peterreilly@apache.org", "creation_time": "2006-09-14T13:32:47Z", "is_private": false, "text": "This proposal is to add a new type definition to ant.\n\nThe def task is <componentdef>.\n\nThese are like normal types except:\n  1) they are only allowed in add[Configured](Class) contexts, they\n      cannot be used at the top level or task containers.\n  2) One can have a multiple number of definitions with\n      the same name. IH will pick the one that matches the\n      add() methods in the container class. If there are multiple\n      matches, - for example class that has add(Condition) and add(FileSelector)\n      presented with \"and\", IH will throw a buildexception for ambiguous. \n\nThe patch modifies IH and co. to lookup nested-element in tasks/types\nthat have add(X)-type methods, in a new mapping called restricted\ntypes (because they cannot use by themselves, only as nested element of\ndeclared tasks/types).\n\nUseage: in a antlib.xml or build.xml file:\n\n<componentdef name=\"add\"\n   classname=\"org.apache.tools.ant.taskdefs.condition.Add\"/>\n\n<componentdef name=\"add\"\n   classname=\"org.apache.tools.ant.types.selectors.AddSelector\"/>"}, {"count": 1, "tags": [], "bug_id": 40511, "attachment_id": 18863, "id": 93582, "time": "2006-09-14T13:34:04Z", "creator": "peterreilly@apache.org", "creation_time": "2006-09-14T13:34:04Z", "is_private": false, "text": "Created attachment 18863\nDiff file"}, {"count": 2, "tags": [], "bug_id": 40511, "attachment_id": 18864, "id": 93583, "time": "2006-09-14T13:35:28Z", "creator": "peterreilly@apache.org", "creation_time": "2006-09-14T13:35:28Z", "is_private": false, "text": "Created attachment 18864\nThe componentdef task"}, {"attachment_id": 18865, "tags": [], "creator": "peterreilly@apache.org", "is_private": false, "count": 3, "id": 93584, "time": "2006-09-14T13:36:20Z", "bug_id": 40511, "creation_time": "2006-09-14T13:36:20Z", "text": "Created attachment 18865\nsrc/main/org/apache/tools/ant/antlib.xml"}, {"count": 4, "tags": [], "creator": "peterreilly@apache.org", "attachment_id": null, "id": 93585, "creation_time": "2006-09-14T13:40:49Z", "time": "2006-09-14T13:40:49Z", "bug_id": 40511, "text": "Some discussions on the feature:\n\nhttp://marc.theaimsgroup.com/?t=115809515200003&r=1&w=2\nhttp://marc.theaimsgroup.com/?t=115814234100004&r=1&w=2\n\nToDo:\ntestcases, doc\n\nExample usage:\n<project default=\"cond\">\n  <target name=\"cond\">\n    <script language=\"beanshell\">\n      import org.apache.tools.ant.*;\n      import org.apache.tools.ant.taskdefs.condition.Condition;\n\n      public class TestCondition extends Task {\n          private Condition condition;\n          public void add(Condition c) {\n             if (condition != null) {\n                 throw new BuildException(\"Only one condition\");\n             }\n             this.condition = c;\n          }\n          public void execute() {\n             if (condition == null) {\n                 throw new BuildException(\"No condition to test\");\n             }\n             log(\"Condition is \" + condition.eval());\n          }\n      }\n      project.addTaskDefinition(\"testcondition\", TestCondition.class);\n    </script>\n    \n    <testcondition>\n      <equals arg1=\"a\" arg2=\"b\"/>\n    </testcondition>\n  </target>\n</project>\n", "is_private": false}, {"count": 5, "tags": [], "creator": "peterreilly@apache.org", "attachment_id": null, "id": 106956, "creation_time": "2007-08-21T02:42:35Z", "time": "2007-08-21T02:42:35Z", "bug_id": 40511, "text": "Committed.\n", "is_private": false}]