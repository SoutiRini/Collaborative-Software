[{"count": 0, "tags": [], "text": "Created attachment 32432\nFile to reproduce the issue\n\nSee the attached Excel file minimal.xlsx where cells E4:E6 are involved in a circular reference.\n\nThe cell type for the evaluated cell E6 is CELL_TYPE_ERROR. Trying to query  the error value yields an IllegalArgumentException \"Unknown error type: -60\".\n\nSee the following code to reproduce the issue:\n\nWorkbook wb = WorkbookFactory.create(new File(\"minimal.xlsx\"));\nFormulaEvaluator evaluator = wb.getCreationHelper().createFormulaEvaluator();\nevaluator.clearAllCachedResultValues();\nSheet sheet = wb.getSheet(\"Sheet1\");\nCell cell = sheet.getRow(5).getCell(4);\nCellValue value = evaluator.evaluate(cell);\n        \nSystem.out.println(value.getCellType() == Cell.CELL_TYPE_ERROR); // true\nCellUtils.getErrorMessage(value.getErrorValue()); // throws IllegalArgumentException: Unknown error type: -60", "is_private": false, "id": 180756, "creator": "martin.studer@mirai-solutions.com", "time": "2015-02-04T20:06:31Z", "bug_id": 57535, "creation_time": "2015-02-04T20:06:31Z", "attachment_id": 32432}, {"count": 1, "tags": [], "text": "It seems we had two sets of error constants, one with a few more in than the other\n\nAs of r1658190, I've made FormulaError be the main one, deprecated the other, cleaned up ErrorEval to use only FormulaError, and added a unit test based on your code which now passes!", "attachment_id": null, "id": 180852, "creator": "apache@gagravarr.org", "time": "2015-02-08T15:38:52Z", "bug_id": 57535, "creation_time": "2015-02-08T15:38:52Z", "is_private": false}]