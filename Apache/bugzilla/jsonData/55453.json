[{"count": 0, "tags": [], "bug_id": 55453, "attachment_id": null, "is_private": false, "id": 169591, "time": "2013-08-20T04:48:03Z", "creator": "dieter.paradeiser@a1telekom.at", "creation_time": "2013-08-20T04:48:03Z", "text": "When Status 304 is set to the Response, AJP send the Body to Apache2. In the HTTP-Connector there is a check against 304, see Method \"prepareResponse\" in Class org.apache.coyote.http11.AbstractHttp11Processor.\n\n304 with Body will corrupt Apache2, see Bug https://issues.apache.org/bugzilla/show_bug.cgi?id=23181"}, {"count": 1, "tags": [], "bug_id": 55453, "attachment_id": null, "is_private": false, "id": 169601, "time": "2013-08-20T15:07:45Z", "creator": "chris@christopherschultz.net", "creation_time": "2013-08-20T15:07:45Z", "text": "So you are saying that AbstractAjpProcessor.prepareResponse needs to have similar logic?\n\nUnder what conditions is a 304 response being sent along with a body? Is this a Tomcat problem (i.e. a situation where Tomcat itself generates a 304-response with a body) or is this a situation where a webapp can attempt to return a 304 response with a body and you want Tomcat to prevent it from doing so?\n\nRFC 2616 does use RFC-MUST-NOT language when referring to 304 responses: \"the response MUST NOT contain a message-body\"."}, {"count": 2, "tags": [], "bug_id": 55453, "attachment_id": null, "id": 169603, "creation_time": "2013-08-20T15:27:50Z", "time": "2013-08-20T15:27:50Z", "creator": "dieter.paradeiser@a1telekom.at", "text": "*) same logic, would be solve the problem ;o)\n**) ajp should also remove the body from response when status 304 is set\n*) its a webapp, jira from atlassian\n*) I know about the rfc, I also requested a bug for jira (atlassian-support)", "is_private": false}, {"count": 3, "tags": [], "bug_id": 55453, "text": "Thanks for the report.\n\nThis has been fixed in 7.0.x and trunk and will be included in 8.0.0-RC2 and 7.0.43 onwards.", "id": 169769, "attachment_id": null, "creator": "markt@apache.org", "creation_time": "2013-08-28T13:22:39Z", "time": "2013-08-28T13:22:39Z", "is_private": false}]