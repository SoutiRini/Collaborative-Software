[{"count": 0, "tags": [], "bug_id": 45418, "text": "Created attachment 22270\nTest program showing problem\n\nAttached is a simple test case that generates 4 cells\n\nCell B1 contains 2\nCell C1 contains 10\nCell D1 contains formula IF(B1=0,0,C1/B1)\nCell E1 contains forumula C1/B1\n\nRan this program with POI 3.0.2 and 3.1.\n\nWhen opened, cell D1 shows 5 when using POI 3.0.2, with 3.1 it shows #VALUE!.\n\nI have also tested with 2.5 and it seems to work.\n\n---\nFormulaTest.java\n---\n\npackage test;\n\nimport java.io.FileOutputStream;\n\nimport org.apache.poi.hssf.usermodel.HSSFCell;\nimport org.apache.poi.hssf.usermodel.HSSFRow;\nimport org.apache.poi.hssf.usermodel.HSSFSheet;\nimport org.apache.poi.hssf.usermodel.HSSFWorkbook;\n\n/**\n * A Writer which writes to XLS file wit the #VALUE! problem\n * \n */\npublic class FormulaTest {\n    \n    /**\n     * Creates a new demo.\n     */\n    public FormulaTest() {\n    }\n\n    public void write() throws Exception {\n        HSSFWorkbook wb = createTestWorkbook();\n        FileOutputStream out = new FileOutputStream(\"test.xls\");\n        wb.write(out);\n        out.close();\n    }\n\n    private HSSFWorkbook createTestWorkbook() throws Exception {\n\n        HSSFWorkbook wb = new HSSFWorkbook();\n        HSSFSheet sheet = wb.createSheet(\"Test Sheet\");\n\n        HSSFRow row, row2;\n        HSSFCell cell;\n\n        // Create a row and put some cells in it. Rows are 0 based.\n        row = sheet.createRow((short) 0);\n\n        // Create a cell\n        cell = row.createCell((short) 1);\n        cell.setCellValue(2);\n\n        cell = row.createCell((short) 2);\n        cell.setCellValue(10);\n        \n\n        cell = row.createCell((short) 3);\n\n        cell.setCellFormula(\"IF(B1=0,0,C1/B1)\");\n        \n        cell = row.createCell((short)4);\n\n        cell.setCellFormula(\"C1 / B1\");\n\n\n        return wb;\n    }\n\n    public static void main(String[] args) throws Exception {\n        FormulaTest w = new FormulaTest();\n        w.write();\n    }\n}", "id": 118750, "time": "2008-07-17T05:40:40Z", "creator": "john.mcteague@gmail.com", "creation_time": "2008-07-17T05:40:40Z", "is_private": false, "attachment_id": 22270}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "text": "Can you re-test with a recent svn checkout / nightly build? I think this might've been fixed already", "id": 118751, "time": "2008-07-17T05:45:02Z", "bug_id": 45418, "creation_time": "2008-07-17T05:45:02Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "text": "poi-3.2-alpha1-20080717.jar resolves the issue. Thanks. For reference, do you know the bug number this was fixed under?(In reply to comment #1)\n\n> Can you re-test with a recent svn checkout / nightly build? I think this\n> might've been fixed already\n> \n\n", "is_private": false, "id": 118754, "creator": "john.mcteague@gmail.com", "time": "2008-07-17T06:27:27Z", "bug_id": 45418, "creation_time": "2008-07-17T06:27:27Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "is_private": false, "id": 118755, "time": "2008-07-17T06:32:58Z", "bug_id": 45418, "creation_time": "2008-07-17T06:32:58Z", "text": "I think it might've been bug #45348, but I'll let Josh confirm as he did the fix"}, {"count": 4, "tags": [], "bug_id": 45418, "attachment_id": null, "text": "(In reply to comment #2)\n> poi-3.2-alpha1-20080717.jar resolves the issue. Thanks. For reference, do you\n> know the bug number this was fixed under?(In reply to comment #1)\n\nThis bug did not exist in 3.1-beta2. It was introduced in 3.1-final probably due to the fix for bug 45060.  As Nick indicated, this problem was probably fixed due to bug 45348.  I think that was the only RVA work done between beta2 and final.\n", "id": 118768, "time": "2008-07-17T12:05:45Z", "creator": "josh@apache.org", "creation_time": "2008-07-17T12:05:45Z", "is_private": false}]