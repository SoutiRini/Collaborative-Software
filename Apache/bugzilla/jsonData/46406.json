[{"count": 0, "tags": [], "text": "Created attachment 23030\nUpdated version of jk_isapi_plugin.c\n\nI have several hundred instances of Tomcat using the IIS ISAPI\nredirect filter. \nI updated to version 1.2.27 of the ISAPI_redirect.dll to use the new\nenvironment variables (JKISAPI_PATH, JKISAPI_NAME) so\nthat I don't have to edit each property file with full file paths.\nHowever, it appears the ISAPI filter gets confused sometimes\nwhen it gets reloaded multiple times and writes to log files of other instances on the same machine.\nSo, I would like to propose an enhancement to be able to have an\nisapi_redirect.properties file with relative file paths like the following: \n###############################################\n# Relative path to the log file for the ISAPI Redirector\nlog_file=isapi_redirect.log\n\n# Relative path to the workers.properties file\nworker_file=workers.properties\n\n# Relative path to the uriworkermap.properties file\nworker_mount_file=uriworkermap.properties\n###############################################\nAttached is a modified version of jk_isapi_plugin.c.\nThe additional lines added start at line number 2630.\nExisting line:\nok = ok && get_config_parameter(src, JK_LOG_FILE_TAG, log_file, sizeof(log_file));\nAdded lines after 2630:\n        if (ok && strrchr(log_file, '\\\\') == NULL) {\n            StringCbCopy(tmpbuf, MAX_PATH, log_file);\n            StringCbCopy(log_file, MAX_PATH, dll_file_path);\n\t    StringCbCat(log_file, MAX_PATH, \"\\\\\");\n\t    StringCbCat(log_file, MAX_PATH, tmpbuf);\n\t}\n\nExisting line:\nok = ok && get_config_parameter(src, JK_WORKER_FILE_TAG, worker_file, sizeof(worker_file));\nAdditional lines added after above line:\n        if (ok && strrchr(worker_file, '\\\\') == NULL) {\n\t    StringCbCopy(tmpbuf, MAX_PATH, worker_file);\n\t    StringCbCopy(worker_file, MAX_PATH, dll_file_path);\n\t    StringCbCat(worker_file, MAX_PATH, \"\\\\\");\n\t    StringCbCat(worker_file, MAX_PATH, tmpbuf);\n        }\nExisting line:\n    ok = ok && get_config_parameter(src, JK_MOUNT_FILE_TAG, worker_mount_file, sizeof(worker_mount_file));\nAdditional lines added after above line:\n\tif (ok && strrchr(worker_mount_file, '\\\\') == NULL) {\n\t    StringCbCopy(tmpbuf, MAX_PATH, worker_mount_file);\n\t    StringCbCopy(worker_mount_file, MAX_PATH, dll_file_path);\n\t    StringCbCat(worker_mount_file, MAX_PATH, \"\\\\\");\n\t    StringCbCat(worker_mount_file, MAX_PATH, tmpbuf);\n\t}", "is_private": false, "bug_id": 46406, "id": 123343, "time": "2008-12-16T05:50:07Z", "creator": "ealvarez@motionpoint.com", "creation_time": "2008-12-16T05:50:07Z", "attachment_id": 23030}, {"count": 1, "tags": [], "bug_id": 46406, "attachment_id": null, "id": 151286, "time": "2011-11-08T13:42:17Z", "creator": "mturk@apache.org", "creation_time": "2011-11-08T13:42:17Z", "is_private": false, "text": "Fixed in the trunk.\nI implemented a 'proper' relative path system which calculates\nrelative paths from the isapi_redirect.dll location using a\nstandard directory traversal notation (..\\..\\..)\n\nSo the things like\nworker_properties=..\\conf\\worker.properties\nshould work now."}]