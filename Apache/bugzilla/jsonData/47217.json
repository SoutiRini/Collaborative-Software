[{"count": 0, "tags": [], "bug_id": 47217, "attachment_id": null, "id": 127138, "time": "2009-05-18T20:14:47Z", "creator": "lam.duong@gmail.com", "creation_time": "2009-05-18T20:14:47Z", "is_private": false, "text": "Dear POI Dev team,\n\nCurrently, I have to edit the .doc file based on the template but after I added more text into the paragraph inside and outside of table in the .doc file but after the file is save by java code I cannot open it in MS Word editor.\n\nI am using the \"poi-scratchpad-3.2-FINAL-20081019.jar\", but I just copy the template to another file and I am able to open it fine.\n\nHere is my code:\nHWPFDocument doc = new HWPFDocument(new FileInputStream(request.getRealPath(\"/\")+\"/docs/filename.doc\"));\n            Range range = doc.getRange();           \n\n            for (int x = 0; x < range.numSections(); x++) {\n                Section section = range.getSection(x);\n                int numberOfParagraphs = section.numParagraphs(); \n                boolean inTable = false;\n                boolean rowStart = true;  \n                boolean prcessinrow = false;\n                Table table = null;\n                CharacterProperties prop = null;           \n\n                int pos = 0;\n                for (int paragraphIndex = 0; paragraphIndex < numberOfParagraphs; paragraphIndex++) {\n                    Paragraph paragraph = null;\n                    try {\n                        paragraph = section.getParagraph(paragraphIndex);\n                    }\n                    catch (Exception exception) {\n                        System.out.print(\"Ignore paragraph exception: \" + exception.toString());\n                    }\n                    if (paragraph != null) {\n                        if(paragraphIndex==7){\n                              if (bulletinForm.getBulletinDate()!=null){\n                                    prop = new CharacterProperties();           \n                                      prop.setBold(true);                                   \n                                      DateFormat formatMMDDYYYY = new SimpleDateFormat(\"MMMM dd, yyyy\");\n                                      String bullDate = formatMMDDYYYY.format(newDate);\n                                      paragraph.insertBefore(bullDate + \" Volume \"+bulletinForm.getBulletinVolume()+\", Number \"+bulletinForm.getBulletinNumber(), prop);\n                              }\n                        }\n                       \n                        if(paragraphIndex==19){\n                              if (bulletinForm.getBulletinDate()!=null){\n                                    prop = new CharacterProperties();           \n                                      prop.setBold(true);\n                                      prop.setFontSize(20);\n                                      DateFormat formatMMDDYYYY = new SimpleDateFormat(\"MMMM dd, yyyy\");\n                                      String bullDate = formatMMDDYYYY.format(newDate);\n                                      paragraph.insertAfter(bullDate, prop);\n                              }\n                        }\n                      \n                        if (paragraph.isInTable()) {                           \n                            System.out.print(\"is in table **\");\n                            pos++;\n                            if (!inTable) {\n                                inTable = true;\n                                rowStart = true;\n                            }\n                        } else {\n                            inTable = false;\n                            rowStart = false;\n                            table = null;\n                            pos = 0;\n                            System.out.print(\"End of Table\");\n                        }\n                        prop = new CharacterProperties();\n                        prop.setBold(true);\n                        if (inTable && !paragraph.isTableRowEnd()) {\n                            if(pos==7){\n                                paragraph.insertAfter(\"$1245,458\",prop);\n                            }else if(pos == 8){\n                                paragraph.insertAfter(\"$7657576.6565\",prop);\n                            }else if(pos == 9){\n                                paragraph.insertAfter(\"$9099976.6565\", prop);\n                            }else if(pos == 10){\n                                paragraph.insertAfter(\"10\");\n                            }\n                        }\n                    }   \n                }\n            }\n            // Write the result doc to output file\n            FileOutputStream fileOut = new FileOutputStream(request.getRealPath(\"/\")+\"/docs/filename1.doc\");\n            doc.write(fileOut);\n            fileOut.flush();\n            fileOut.close();\n\nPlease give me an advise.\n\nThanks and Regards,\nLam Duong"}, {"count": 1, "tags": [], "text": "Lam Duong,\n\nWe did some work around POI code related to Word tables. You need to check if problem is still reproducable using POI code from SVN trunk. If it is - please provide an example of filename.doc.\n\n--\nSergey.", "attachment_id": null, "id": 148113, "creator": "vlsergey@gmail.com", "time": "2011-07-24T18:45:44Z", "bug_id": 47217, "creation_time": "2011-07-24T18:45:44Z", "is_private": false}, {"count": 2, "tags": [], "text": "Also see this on Mac OS X, Windows 7, non-os specific", "attachment_id": null, "id": 179258, "creator": "james.velasco@int.com", "time": "2014-11-24T22:57:33Z", "bug_id": 47217, "creation_time": "2014-11-24T22:57:33Z", "is_private": false}, {"count": 3, "tags": [], "text": "Please disregard last comment, intended for Bug 56890", "attachment_id": null, "id": 179259, "creator": "james.velasco@int.com", "time": "2014-11-24T23:00:24Z", "bug_id": 47217, "creation_time": "2014-11-24T23:00:24Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 47217, "attachment_id": null, "text": "No update for years after request for testing with latest version of POI, therefore I am closing this as WORKSFORME for now, please reopen this bug with more information if this is still an issue for you.", "id": 191767, "time": "2016-06-18T05:52:42Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-06-18T05:52:42Z", "is_private": false}]