[{"count": 0, "tags": [], "bug_id": 55554, "attachment_id": null, "text": "I'm getting the following stack trace with Java 7 (but no with Java 8):\n\n\njava.lang.NoSuchMethodError: java.util.concurrent.ConcurrentHashMap.keySet()Ljava/util/concurrent/ConcurrentHashMap$KeySetView;\n        at org.apache.catalina.core.ApplicationContext.getInitParameterNames(ApplicationContext.java:319)\n        at org.apache.catalina.core.ApplicationContextFacade.getInitParameterNames(ApplicationContextFacade.java:368)\n        at org.springframework.web.context.support.WebApplicationContextUtils.registerEnvironmentBeans(WebApplicationContextUtils.java:201)\n        at org.springframework.web.context.support.AbstractRefreshableWebApplicationContext.postProcessBeanFactory(AbstractRefreshableWebApplicationContext.java:175)\n        at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:461)\n        at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:389)\n        at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:294)\n        at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:106)\n        at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4830)\n        at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5276)\n        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:726)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:702)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:698)\n        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:968)\n        at org.apache.catalina.startup.HostConfig$DeployWar.run(HostConfig.java:1742)\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)\n        at java.util.concurrent.FutureTask.run(FutureTask.java:166)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n        at java.lang.Thread.run(Thread.java:722)", "id": 170071, "time": "2013-09-12T16:49:10Z", "creator": "rstoyanchev@yahoo.com", "creation_time": "2013-09-12T16:49:10Z", "is_private": false}, {"count": 1, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 170072, "time": "2013-09-12T18:00:57Z", "bug_id": 55554, "creation_time": "2013-09-12T18:00:57Z", "is_private": false, "text": "java.util.concurrent.ConcurrentHashMap$KeySetView doesn't exist in Java 7. I'm not sure how but you appear to have a Java 8 artifact involved here. Whatever is going on, it is an environmental issue on your system."}, {"count": 2, "tags": [], "creator": "rstoyanchev@yahoo.com", "text": "Odd, because that is a JDK class and the issue occurs when I run with JDK 1.7.", "id": 170073, "time": "2013-09-12T18:37:38Z", "bug_id": 55554, "creation_time": "2013-09-12T18:37:38Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "chris@christopherschultz.net", "attachment_id": null, "id": 170075, "time": "2013-09-12T20:00:28Z", "bug_id": 55554, "creation_time": "2013-09-12T20:00:28Z", "is_private": false, "text": "Bug is INVALID, not FIXED.\n\nWhen you run in Java 7 mode, something must be terribly wrong, because it looks like it's trying to use a Java 8 class. That's what makes your environment broken. Try re-installing the JRE?"}, {"count": 4, "attachment_id": null, "bug_id": 55554, "text": "Just a quick note if anyone encounters it again: some rpm of tomcat are created recompiling tomcat and I let you guess what can happen in such a process: a JDK 8 can be used. Typically the one of Feb 22 has this manifest:\n\nManifest-Version: 1.0\nAnt-Version: Apache Ant 1.9.6\nCreated-By: 1.8.0_72-b15 (Oracle Corporation)\nSpecification-Title: Apache Tomcat\nSpecification-Version: 8.0\nSpecification-Vendor: Apache Software Foundation\nImplementation-Title: Apache Tomcat\nImplementation-Version: 8.0.32\nImplementation-Vendor: Apache Software Foundation\nX-Compile-Source-JDK: 1.7\nX-Compile-Target-JDK: 1.7\n\nWhich can justifies this error.", "id": 190476, "time": "2016-04-21T23:03:10Z", "creator": "rmannibucau@gmail.com", "creation_time": "2016-04-21T23:03:10Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "creator": "pablo.pazos@cabolabs.com", "attachment_id": null, "id": 195536, "time": "2016-12-18T08:14:30Z", "bug_id": 55554, "creation_time": "2016-12-18T08:14:30Z", "is_private": false, "text": "It was reported on many places that for Ubuntu 16.04 Tomcat7 was build with Java8 while the docs said that it should be compatible with Java7: http://tomcat.apache.org/whichversion.html \n\nThe issue is using Tomcat7 with Java7 on Unbuntu 16.04. IMO is a valid bug but was marked as invalid.\n\nThe build that doesn't work comes from the Ubuntu repos, so the issue might be on that version only. Ir was suggested to download the version directly from Apache and install it manually: http://stackoverflow.com/questions/38583495/getting-error-while-running-webservices-on-tomcat7-server-ubuntu-16-04-lts\n\nIs there any way to contact the people that made the build for Ubuntu 16.04?"}, {"count": 6, "tags": [], "bug_id": 55554, "attachment_id": null, "text": "Tomcat 7 should be built with Java 6 with only the WebSocket module built with Java 7.\n\nYou are best going though the Ubuntu community for issues with the Ubuntu packaging.", "id": 195537, "time": "2016-12-18T08:59:53Z", "creator": "markt@apache.org", "creation_time": "2016-12-18T08:59:53Z", "is_private": false}, {"count": 7, "tags": [], "creator": "ebourg@apache.org", "attachment_id": null, "id": 195538, "time": "2016-12-18T09:49:58Z", "bug_id": 55554, "creation_time": "2016-12-18T09:49:58Z", "is_private": false, "text": "A simple workaround would be to use the default JRE in Ubuntu 16.04 (OpenJDK 8) to run Tomcat.\n\nThe issue is that the tomcat package in Ubuntu (and Debian too) allows the use of Java 7, it should be restricted to Java 8+. I'll fix the issue in Debian, this will be automatically picked in Ubuntu 17.04."}, {"count": 8, "tags": [], "creator": "ebourg@apache.org", "text": "This issue has been fixed in the version 8.5.9-2 of the tomcat8 package in Debian Stretch. The tomcat8 package in Debian Jessie was built with Java 7 and is not affected.\n\nThe Ubuntu package is likely to be updated automatically before the release of Ubuntu 17.04. For the older releases this will require the intervention of an Ubuntu maintainer and an issue should be opened in Launchpad.", "id": 195567, "time": "2016-12-19T18:52:59Z", "bug_id": 55554, "creation_time": "2016-12-19T18:52:59Z", "is_private": false, "attachment_id": null}, {"count": 9, "attachment_id": null, "bug_id": 55554, "text": "FWIW I do not use Ubuntu packages for Tomcat. I download it from the Tomcat download page. So something there gave me a binary with the same or similar issue.", "id": 195568, "time": "2016-12-19T20:27:43Z", "creator": "rstoyanchev@yahoo.com", "creation_time": "2016-12-19T20:27:43Z", "tags": [], "is_private": false}]