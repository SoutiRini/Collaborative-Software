[{"count": 0, "tags": [], "bug_id": 41279, "text": "Synopsis: Apache 1.3.37 htpasswd buffer overflow vulnerability\nVersion: 1.3.37 (latest 1.3.xx)\n\nProduct\n=======\nApache htpasswd utility\n\n\nIssue\n=====\nA buffer overflow vilnerability has been found, it is dangerous only on\nenvironment where the binary is suid root.\n\nDetails\n=======\nIncorrect validation on the size of user input allows to copy a string, via\nstrcpy, to a fixed size buffer.\nFile: htpasswd.c, Line 421.\n\nSolution\n========\nApply this patch to htpasswd.c\n\n-----8<-----8<-----8<-----8<-----8<-----8<-----8<-----8<-----8<-----8<-----8<--\n\n  415,419c415,420\n  <       if (strlen(argv[i + 1]) > (sizeof(user) - 1)) {\n  <           fprintf(stderr, \"%s: username too long (>%lu)\\n\", argv[0],\n  <                   (unsigned long)(sizeof(user) - 1));\n  <           return ERR_OVERFLOW;\n  <       }\n  ---\n  >     }\n  >     if (strlen(argv[i + 1]) > (sizeof(user) - 1)) {\n  >       fprintf(stderr, \"%s: username too long (>%lu)\\n\", argv[0],\n  >       (unsigned long)(sizeof(user) - 1));\n  >       return ERR_OVERFLOW;\n  >\n--->8----->8----->8----->8----->8----->8----->8----->8----->8----->8----->8-----\n\nAffected Versions\n==================\n1.3.37 - http://www.apache.org/dist/httpd/apache_1.3.37.tar.gz\n\nNotes & References\n==================\nAnother similar bug was discovered by Luiz Fernando [1], Larry Cashdollar's\npatch also fixed the bug i'm posting, but it seems not to be applied on the\nlatest versions of apache 1.3.xx.\n\nMichael Engert submitted another patch[1] which also fixed this bug and filled\nout a bug report [1], but it wasn't applied.\n\nHave a look at Other posts[3][4] on this (and similar) issues.\n\n1 - http://archives.neohapsis.com/archives/fulldisclosure/2004-09/0547.html\n2 - http://issues.apache.org/bugzilla/show_bug.cgi?id=31975\n3 - http://seclists.org/bugtraq/2004/Oct/0359.html\n4 - http://www.security-express.com/archives/fulldisclosure/2004-10/1117.html\n\n\nCredits\n=======\nMatias S. Soler - gnuler [at] gmail [dot] com\nLuiz Fernando\nMichael Engert", "id": 97542, "time": "2007-01-02T12:13:32Z", "creator": "gnuler@gmail.com", "creation_time": "2007-01-02T12:13:32Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "mss@apache.org", "text": "Apache HTTP Server 1.3.x is not supported anymore and no bugs will be fixed in the old codebase (cf. <http://mail-archives.apache.org/mod_mbox/httpd-announce/201002.mbox/%3C20100203000334.GA19021@infiltrator.stdlib.net%3E>). Since this bug seems to affect only 1.3.x, I'm closing it as WONTFIX.\n\nIf this bug still affects you in a recent version (version 2.2.x or the upcoming version 2.4), please open a new bug.\n\nThank you for reporting the bug.", "id": 145156, "time": "2011-03-21T11:03:14Z", "bug_id": 41279, "creation_time": "2011-03-21T11:03:14Z", "is_private": false, "attachment_id": null}]