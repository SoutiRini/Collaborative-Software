[{"count": 0, "tags": [], "text": "Created attachment 34874\nDo not send Set-Cookie twice\n\nmod_session_cookie uses ap_cookie_write() with r->headers_out and r->err_headers_out. The former causes a Set-Cookie header to be added on successful requests, while the later causes a Set-Cookie header to always be added.\n\nAs a result, successful requests get a duplicated Set-Cookie header and it confuses some clients. The attached patch fixes that by using only r->err_headers_out, which as its name does not suggests, causes Set-Cookie to be always added, regardless of error status.", "attachment_id": 34874, "id": 197959, "creator": "manu@netbsd.org", "time": "2017-03-24T04:50:03Z", "bug_id": 60910, "creation_time": "2017-03-24T04:50:03Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 60910, "is_private": false, "count": 1, "id": 202426, "time": "2017-11-27T11:53:10Z", "creator": "toscano.luca@gmail.com", "creation_time": "2017-11-27T11:53:10Z", "text": "Hi! \n\nThanks a lot for the code patch. I am not super expert so this question might be obvious: is Set-Cookie supposed to be added always (even on error/redirects)? At a first glance I'd add the header only to r->headers_out.."}]