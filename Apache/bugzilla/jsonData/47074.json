[{"count": 0, "tags": [], "text": "Hi Iam trying to read excel file as per the program (downloaded  from internet, attached for reference here) But i am getting below error:\n\n\n\ngot '\u0005SummaryInformation' event for path '\\'.\ngot '\u0005DocumentSummaryInformation' event for path '\\'.\ngot 'Workbook' event for path '\\'.\n  trying DirectoryNode 'Root Entry'\nException in thread \"main\" java.lang.NoSuchMethodError: org.apache.poi.POIDocument.<init>(Lorg/apache/poi/poifs/filesystem/DirectoryNode;Lorg/apache/poi/poifs/filesystem/POIFSFileSystem;)V\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:225)\n\tat com.lehman.pcs.bcu.util.POIFSExtract$MyPOIFSReaderListener.processPOIFSReaderEvent(POIFSExtract.java:53)\n\tat org.apache.poi.poifs.eventfilesystem.POIFSReader.processProperties(POIFSReader.java:261)\n\tat org.apache.poi.poifs.eventfilesystem.POIFSReader.read(POIFSReader.java:97)\n\tat com.lehman.pcs.bcu.util.POIFSExtract.main(POIFSExtract.java:29)\n\n\nI am using jars of version as below :\n\npoi-3.1-FINAL.jar\npoi-scratchpad-3.0.1-FINAL.jar\npoi-contrib-3.1-FINAL.jar", "is_private": false, "id": 126434, "creation_time": "2009-04-22T07:18:13Z", "time": "2009-04-22T07:18:13Z", "creator": "kishore.kandrup@nomura.com", "bug_id": 47074, "attachment_id": null}, {"count": 1, "tags": [], "creator": "kishore.kandrup@nomura.com", "text": "The attached code is pasted below.\n\npackage com.lehman.pcs.bcu.util;\n\nimport java.io.File; \nimport java.io.FileInputStream; \nimport java.io.FileNotFoundException; \n\nimport org.apache.poi.hssf.record.RecordFormatException; \nimport org.apache.poi.hssf.usermodel.HSSFWorkbook; \nimport org.apache.poi.poifs.eventfilesystem.POIFSReader; \nimport org.apache.poi.poifs.eventfilesystem.POIFSReaderEvent; \nimport org.apache.poi.poifs.eventfilesystem.POIFSReaderListener; \nimport org.apache.poi.poifs.filesystem.DirectoryNode; \nimport org.apache.poi.poifs.filesystem.POIFSDocumentPath; \nimport org.apache.poi.poifs.filesystem.POIFSFileSystem; \n\npublic class POIFSExtract { \n\n    public static void main(String[] args) throws Exception { \n        //if (args == null || args.length < 1) \n            //throw new Exception(\"\\n->no input, no output<-\"); \n\n\n        String fileName1 = \"H:\\\\Kishor\\\\Research\\\\EmailWorkFlow\\\\Web_Server_Comparison.xls\";\n        POIFSFileSystem fs = new POIFSFileSystem(new \n        \t\tFileInputStream(fileName1)); \n\n        POIFSReader reader = new POIFSReader(); \n        reader.registerListener(new MyPOIFSReaderListener(fs)); \n        reader.read(new FileInputStream(fileName1)); \n    } \n\n    static class MyPOIFSReaderListener implements POIFSReaderListener { \n\n        private POIFSFileSystem fs; \n\n        public MyPOIFSReaderListener(POIFSFileSystem fs) { \n            this.fs = fs; \n        } \n\n        public void processPOIFSReaderEvent(POIFSReaderEvent event) { \n\n            String name = event.getName(); \n            POIFSDocumentPath path = event.getPath(); \n            System.out.println(\"got '\" + name + \"' event for path '\" + path \n            \t\t\t+ \"'.\"); \n\n            if (name.endsWith(\"Workbook\") || name.endsWith(\"WORKBOOK\")) { \n                try { \n                    DirectoryNode dir = resolveDir(fs, \n                    \t\tevent.getPath().toString()); // converting it to DirectoryNode \n                    System.out.println(\"  trying DirectoryNode '\" + \n                    \t\tdir.getName() + \"'\"); \n                    HSSFWorkbook wb = new HSSFWorkbook(dir, fs, true); \n                    //invoke HSSFWorkbook constructor passing this directory to it \n                    System.out.println(\"  !!! success: workbook with \" + \n                    \t\twb.getNumberOfSheets() + \" sheets.\"); \n                } \n                catch (RecordFormatException e) { \n                    // MS Graph charts are stored in \"Workbook\" stream too \n                    System.out.println(\"  skipping embedded MS Graph object!\"); \n                } \n                catch (Exception e) { \n                    System.out.println(\"  \" + e.getMessage()); \n                    throw new RuntimeException(e.getMessage()); \n                } \n            } \n        } \n\n        static DirectoryNode resolveDir(POIFSFileSystem filesystem, \n        \t\tString path) throws FileNotFoundException { \n            DirectoryNode dir = filesystem.getRoot(); \n\n            for (String token : path.split(\"\\\\\" + File.separator)) { \n                if (!token.equals(\"\") && !token.equals(File.separator)) \n                    dir = (DirectoryNode) dir.getEntry(token); \n            } \n\n            return dir; \n        } \n    } \n}", "id": 126435, "time": "2009-04-22T07:19:27Z", "bug_id": 47074, "creation_time": "2009-04-22T07:19:27Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "apache@gagravarr.org", "text": "You almost certainly have a different version of poi on your run classpath to your compile classpath. Please see the faq on the site for how to test which jars you're really running with.", "id": 126438, "time": "2009-04-22T07:26:57Z", "bug_id": 47074, "creation_time": "2009-04-22T07:26:57Z", "is_private": false, "attachment_id": null}]