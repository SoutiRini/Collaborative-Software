[{"count": 0, "tags": [], "bug_id": 51094, "text": "Created attachment 26916\nTest document\n\nWhen I'm trying to write a Word document it does not preserve an embedded entries. Attached test document. It's a Word document with another Word document embedded. Here is a code to reproduce the issue:\n\nString testdoc = \"881-test-embedded.doc\";\nString testdocout = \"out.doc\";\nPOIFSFileSystem fs = new POIFSFileSystem(new FileInputStream(new File(testdoc)));\n\nHWPFDocument doc = new HWPFDocument(fs);\nFileOutputStream out = new FileOutputStream(new File(testdocout));\ndoc.write(out);\nout.close();\n\nThe resulting file \"out.doc\" does not contain embedded document. Is this a bug or expected behavior?", "id": 145908, "time": "2011-04-20T09:35:02Z", "creator": "igor.rogov.35@gmail.com", "creation_time": "2011-04-20T09:35:02Z", "is_private": false, "attachment_id": 26916}, {"count": 1, "text": "Looking at the HWPF write code, I can see that there's nothing there to copy the embedded documents over\n\nShort term, the fix would be to do something similar to in HSSF, where we copy the extra entries over if a flag is set\n\nLonger term, if we switch it from POIFSFileSystem to NPOIFSFileSystem then we can just overwrite the word streams with the new data, and keep all the other ones, which'd probably be a cleaner fix", "creator": "apache@gagravarr.org", "attachment_id": null, "id": 145909, "time": "2011-04-20T10:14:13Z", "bug_id": 51094, "creation_time": "2011-04-20T10:14:13Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 51094, "attachment_id": null, "id": 145910, "time": "2011-04-20T10:16:15Z", "creator": "apache@gagravarr.org", "creation_time": "2011-04-20T10:16:15Z", "is_private": false, "text": "As a workaround for now, you could manually copy the ObjectPool over. A patch to do this properly (along with a unit test) would be very well received!"}, {"count": 3, "tags": [], "bug_id": 51094, "text": "Shall be fixed already, please check", "id": 151038, "time": "2011-10-30T00:08:11Z", "creator": "vlsergey@gmail.com", "creation_time": "2011-10-30T00:08:11Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "text": "No update for a long time, therefore I am closing this, please reopen with more information if this is still a problem for you.", "id": 188415, "time": "2016-02-14T18:42:53Z", "bug_id": 51094, "creation_time": "2016-02-14T18:42:53Z", "is_private": false}]