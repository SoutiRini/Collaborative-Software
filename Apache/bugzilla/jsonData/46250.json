[{"count": 0, "tags": [], "bug_id": 46250, "attachment_id": 22906, "id": 122680, "time": "2008-11-20T06:54:09Z", "creator": "hc69@gmx.net", "creation_time": "2008-11-20T06:54:09Z", "is_private": false, "text": "Created attachment 22906\nExcel with cloned sheet and image error\n\nThe Methode cloneSheet of the HSSFWorkbook-Object is not working well. If there are images in the original Sheet, the cloned Sheet has not a copy of this image. \nThere is a placeholder for this image place (red cross: The\npicture cannot be displayed\u0085) but nothing else.\n\n\nExample: \nHSSFWorkbook wb = new HSSFWorkbook(this.getClass().getClassLoader().getResourceAsStream(\"myfile.xls\"));\nwb.cloneSheet(0);"}, {"count": 1, "tags": [], "bug_id": 46250, "attachment_id": null, "id": 122885, "time": "2008-11-26T15:30:19Z", "creator": "josh@apache.org", "creation_time": "2008-11-26T15:30:19Z", "is_private": false, "text": "The bug is pretty easy to reproduce.  It seems like the solution may involve updating of some drawing IDs in the newly cloned records.\n\nAnother bug which may need to get fixed here is that BiffViewer crashes when the embedded image is bigger than one BIFF record."}, {"count": 2, "attachment_id": null, "creator": "markt@adaptiveplanning.com", "is_private": false, "id": 123645, "time": "2008-12-30T12:23:05Z", "bug_id": 46250, "creation_time": "2008-12-30T12:23:05Z", "tags": [], "text": "I'm looking at the source code in 3.5, and notice a cut-n-paste error which might be generating this issue (both of thse issues?):\n\nIn DrawingRecord.java, at the bottom, in the clone() function, the block:\n    \tif (contd != null) {\n\t    \tSystem.arraycopy(contd, 0, rec.contd, 0, contd.length);\n\t    \trec.contd = new byte[ contd.length ];\n    \t}\nshould be:\n    \tif (contd != null) {\n\t    \trec.contd = new byte[ contd.length ];\n\t    \tSystem.arraycopy(contd, 0, rec.contd, 0, contd.length);\n    \t}\n\nThe former would cause null pointer exceptions and broken drawing references in cloned workbooks/sheets, wouldn't it?\n"}, {"count": 3, "tags": [], "bug_id": 46250, "attachment_id": null, "id": 146935, "time": "2011-06-07T15:38:41Z", "creator": "niko-kris@hotmail.fr", "creation_time": "2011-06-07T15:38:41Z", "is_private": false, "text": "Did you find a solution to this problem?\nWe encounter the same issue since we migrated our environements on Excel 2007 (before we were on Excel 2003).\nOn the original sheet, the image shows up correctly but on the cloned sheets there is a red cross instead."}, {"count": 4, "tags": [], "bug_id": 46250, "attachment_id": null, "is_private": false, "id": 147943, "time": "2011-07-15T15:33:12Z", "creator": "matt.koch@turntree.com", "creation_time": "2011-07-15T15:33:12Z", "text": "This bug still exists in 3.7 and 3.8b - when you clone a sheet that has an image in it, it will copy it once. If you clone the sheet again or clone the cloned sheet the image does not appear and instead the X with error message previously reported by many does appear.\n\nWould be great if this could be fixed for the 3.8 release if anyone knows what is going on here!\n\nThanks\nMatt"}, {"count": 5, "tags": [], "text": "Should be fixed in r1148295\n\nPlease try with the\nlatest build from trunk. Daily builds can be downloaded from here:\nhttp://encore.torchbox.com/poi-cvs-build/\n\nYegor", "attachment_id": null, "id": 148001, "creation_time": "2011-07-19T12:22:26Z", "time": "2011-07-19T12:22:26Z", "creator": "yegor@dinom.ru", "bug_id": 46250, "is_private": false}, {"count": 6, "tags": [], "creator": "matt.koch@turntree.com", "attachment_id": null, "id": 148037, "time": "2011-07-20T15:20:48Z", "bug_id": 46250, "creation_time": "2011-07-20T15:20:48Z", "is_private": false, "text": "I just pulled poi-3.8-beta4-20110719.jar and reinitiated my classes and tried again and the first two cloned sheets have the original image in it, the next sheets have the error still."}, {"count": 7, "tags": [], "creator": "yegor@dinom.ru", "is_private": false, "text": "I committed the fix today and you've tried the yesterday's build. Try tomorrow or checkout from svn and build yourself.\n\nYegor", "id": 148038, "time": "2011-07-20T15:37:22Z", "bug_id": 46250, "creation_time": "2011-07-20T15:37:22Z", "attachment_id": null}, {"count": 8, "tags": [], "text": "I just tested with nightly jar from poi-3.8-beta4-20110722.jar\n\nand IT IS WORKING - woo hoo!  Thank you so much for the fix.  I am sure others will be happy as i see posts in various places about this issue.  I just did 175 clones of a master template worksheet and the image is in every one!!!\n\nThanks\nMatt", "attachment_id": null, "bug_id": 46250, "id": 148087, "time": "2011-07-22T15:25:42Z", "creator": "matt.koch@turntree.com", "creation_time": "2011-07-22T15:25:42Z", "is_private": false}, {"count": 9, "tags": [], "text": "poi-3.8-beta4-20110722 was working but the feature is broken once again somehow in the new release candidate today poi-bin-3.8-beta4-20110822.\n\nHopefully this fix can get integrated into the final 3.8 beta 4\n\nThanks\nMatt", "attachment_id": null, "id": 148627, "creator": "matt.koch@turntree.com", "time": "2011-08-16T02:08:57Z", "bug_id": 46250, "creation_time": "2011-08-16T02:08:57Z", "is_private": false}, {"count": 10, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "id": 148628, "time": "2011-08-16T07:28:24Z", "bug_id": 46250, "creation_time": "2011-08-16T07:28:24Z", "is_private": false, "text": "\n(In reply to comment #9)\n> poi-3.8-beta4-20110722 was working but the feature is broken once again somehow\n> in the new release candidate today poi-bin-3.8-beta4-20110822.\n> \n\nUnder what circumstances?  Cloning sheets with images is working fine to me, I've just checked against the attached file and a new file created in MS Office 2010. \n\nIf you are able top reproduce the bug, please attach the input file and Java code that we can use for testing.\n\nYegor"}, {"count": 11, "tags": [], "text": "I apologize but this bug is still fixed in the beta4 release candidate (20110822) it was still broken in 3.7 which was accidentally in my class path.", "is_private": false, "id": 148646, "creation_time": "2011-08-16T15:13:16Z", "time": "2011-08-16T15:13:16Z", "creator": "matt.koch@turntree.com", "bug_id": 46250, "attachment_id": null}, {"count": 12, "tags": [], "bug_id": 46250, "text": "Clonesheet is currently working with 3.8 final with an image in the original sheet being cloned.  When i installed the 3.9 build from 09/07/2012 (and one about a month ago) I am now getting an error when calling the cloneSheet function...\n\nwe use coldfusion and here is the stacktrace:\n\njava.lang.NullPointerException at org.apache.poi.hssf.usermodel.HSSFTextbox.cloneShape(HSSFTextbox.java:234) at org.apache.poi.hssf.usermodel.HSSFPatriarch.createPatriarch(HSSFPatriarch.java:88) at org.apache.poi.hssf.usermodel.HSSFSheet.cloneSheet(HSSFSheet.java:132) at org.apache.poi.hssf.usermodel.HSSFWorkbook.cloneSheet(HSSFWorkbook.java:682) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:597) at coldfusion.runtime.StructBean.invoke(StructBean.java:508) at coldfusion.runtime.CfJspPage._invoke(CfJspPage.java:2393) at \n\n\nThanks\nMatt", "id": 162026, "time": "2012-09-08T19:17:44Z", "creator": "matt.koch@turntree.com", "creation_time": "2012-09-08T19:17:44Z", "is_private": false, "attachment_id": null}, {"count": 13, "tags": [], "text": "Hi,\n\nCan you please produce a unit test that shows the problem and source xls file you try to clone(if you use existing one)?\n\nRegards, Evgeniy\n\n(In reply to comment #12)\n> Clonesheet is currently working with 3.8 final with an image in the original\n> sheet being cloned.  When i installed the 3.9 build from 09/07/2012 (and one\n> about a month ago) I am now getting an error when calling the cloneSheet\n> function...\n> \n> we use coldfusion and here is the stacktrace:\n> \n> java.lang.NullPointerException at\n> org.apache.poi.hssf.usermodel.HSSFTextbox.cloneShape(HSSFTextbox.java:234)\n> at\n> org.apache.poi.hssf.usermodel.HSSFPatriarch.createPatriarch(HSSFPatriarch.\n> java:88) at\n> org.apache.poi.hssf.usermodel.HSSFSheet.cloneSheet(HSSFSheet.java:132) at\n> org.apache.poi.hssf.usermodel.HSSFWorkbook.cloneSheet(HSSFWorkbook.java:682)\n> at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at\n> sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:\n> 39) at\n> sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.\n> java:25) at java.lang.reflect.Method.invoke(Method.java:597) at\n> coldfusion.runtime.StructBean.invoke(StructBean.java:508) at\n> coldfusion.runtime.CfJspPage._invoke(CfJspPage.java:2393) at \n> \n> \n> Thanks\n> Matt", "attachment_id": null, "bug_id": 46250, "id": 162027, "time": "2012-09-08T19:23:40Z", "creator": "superrubiroyd@gmail.com", "creation_time": "2012-09-08T19:23:40Z", "is_private": false}, {"count": 14, "tags": [], "bug_id": 46250, "attachment_id": null, "is_private": false, "id": 162034, "time": "2012-09-09T13:24:09Z", "creator": "superrubiroyd@gmail.com", "creation_time": "2012-09-09T13:24:09Z", "text": "This problem should be fixed in trunk.\n\nPlease try with a nightly build - see download links on http://poi.apache.org/\nor build yourself from SVN trunk, see http://poi.apache.org/subversion.html\n\nRegards, Evgeniy"}]