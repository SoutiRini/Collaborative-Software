[{"count": 0, "attachment_id": null, "bug_id": 3890, "text": "This patch fixes the problem.\n\nIndex: StandardContextMapper.java\n=========================================================\n==========\nRCS file: \n/home/cvs/jakarta-tomcat-4.0/catalina/src/share/org/apache/catalina/co\nre/StandardContextMapper.java,v\nretrieving revision 1.6\ndiff -u -r1.6 StandardContextMapper.java\n--- StandardContextMapper.java  2001/07/22 20:25:08     1.6\n+++ StandardContextMapper.java  2001/09/30 22:04:35\n@@ -259,19 +259,26 @@\n         if (wrapper == null) {\n             if (debug >= 2)\n                 context.log(\"  Trying extension match\");\n-            int slash = relativeURI.lastIndexOf('/');\n-            if (slash >= 0) {\n-                String last = relativeURI.substring(slash);\n-                int period = last.lastIndexOf('.');\n-                if (period >= 0) {\n-                    String pattern = \"*\" + last.substring(period);\n-                    name = context.findServletMapping(pattern);\n-                    if (name != null)\n-                        wrapper = (Wrapper) context.findChild(name);\n-                    if (wrapper != null) {\n-                        servletPath = relativeURI;\n+            int dot = relativeURI.indexOf('.');\n+            String dotToEnd = relativeURI.substring(dot);\n+            StringBuffer sb = new StringBuffer();\n+            for (int i=1; i<dotToEnd.length(); i++) {\n+                sb.append(dotToEnd.charAt(i));\n+                String pattern = \"*.\" + sb.toString();\n+                name = context.findServletMapping(pattern);\n+                if (name != null) {\n+                    wrapper = (Wrapper) context.findChild(name);\n+                }\n+                if (wrapper != null) {\n+                    int pathInfoStart = dot + i + 1;\n+                    servletPath = relativeURI.substring(0,pathInfoStart);\n+                    if (pathInfoStart < relativeURI.length()) {\n+                        pathInfo = relativeURI.substring(pathInfoStart);\n+                    } else {\n                         pathInfo = null;\n                     }\n+                    update = true;\n+                    break;\n                 }\n             }\n         }", "id": 6216, "time": "2001-09-30T15:07:55Z", "creator": "jon@latchkey.com", "creation_time": "2001-09-30T15:07:55Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "text": "The spec currently forbids doing this, as extension mapping only applies to the \nlast segment of the URI.", "is_private": false, "id": 6218, "creator": "remm@apache.org", "time": "2001-09-30T22:52:41Z", "bug_id": 3890, "creation_time": "2001-09-30T22:52:41Z", "attachment_id": null}]