[{"count": 0, "tags": [], "creator": "mlzhao@sina.com.cn", "attachment_id": null, "text": "Environment: W2k professional + Excel 2000 + POI 2.0pre1\nquestion 1: I copy a formula and paste it to a serial cells in a excel file in \nMS Excel. Then I read the pasted formulas to a String, the String is \"NO IDEA \nSHARED FORMULA EXP PTG\".\n\nquestion 2: After I modify one of the pasted formula to a number, and save the \nworkbook to another excel file, I open the file in MS Excel. All of the cells \nwhich reference the modified cell appeared #REF!. I'm not sure if it is the \nsame question as bug 15223, because after I get the latest code from CVS, \nthings not changed.", "id": 37969, "time": "2003-05-29T02:36:01Z", "bug_id": 20321, "creation_time": "2003-05-29T02:36:01Z", "is_private": false}, {"count": 1, "tags": [], "creator": "dmui@apache.org", "text": "if you can attach your spreadsheet we can take a further look at it.\n\nShared Formulas are not rendered at this time, that's why you get the \"SHARED\nFORMULA EXP PTG\".\n\nIf you want to avoid shared formulas, type the formulas without pasting them. \nShared formulas were tested by dragging the cell contents across.", "id": 37986, "attachment_id": null, "bug_id": 20321, "creation_time": "2003-05-29T16:45:14Z", "time": "2003-05-29T16:45:14Z", "is_private": false}, {"count": 2, "tags": [], "creator": "dmui@apache.org", "attachment_id": null, "text": "are you just trying to set the excel calculated value for the formula in your\ncode ?  or is there another reason you're setting the value.\n\nI haven't had a chance to completely investigate yet but it looks like when you\ndo that, you're wiping out the SharedFormulaRecord so the others that reference\nit doesn't work correctly.", "id": 38361, "time": "2003-06-04T15:09:32Z", "bug_id": 20321, "creation_time": "2003-06-04T15:09:32Z", "is_private": false}, {"count": 3, "tags": [], "creator": "dmui@apache.org", "is_private": false, "id": 38362, "attachment_id": 6630, "bug_id": 20321, "creation_time": "2003-06-04T15:10:27Z", "time": "2003-06-04T15:10:27Z", "text": "Created attachment 6630\nStarting Excel File"}, {"count": 4, "tags": [], "bug_id": 20321, "is_private": false, "text": "Created attachment 6631\nResulting Excel File", "id": 38363, "time": "2003-06-04T15:10:45Z", "creator": "dmui@apache.org", "creation_time": "2003-06-04T15:10:45Z", "attachment_id": 6631}, {"count": 5, "tags": [], "bug_id": 20321, "attachment_id": 6632, "id": 38364, "time": "2003-06-04T15:11:01Z", "creator": "dmui@apache.org", "creation_time": "2003-06-04T15:11:01Z", "is_private": false, "text": "Created attachment 6632\nCode"}, {"count": 6, "tags": [], "bug_id": 20321, "attachment_id": null, "text": "This problem arises when you try to read a cell that has a formula from auto-\nfill (selecting the cell with a formula and dragging across cells).", "id": 50646, "time": "2004-01-16T15:10:40Z", "creator": "jun.zuo@mscsoftware.com", "creation_time": "2004-01-16T15:10:40Z", "is_private": false}, {"count": 7, "tags": [], "text": "What's the status of this?", "is_private": false, "bug_id": 20321, "id": 73987, "time": "2005-04-22T16:17:05Z", "creator": "avik@apache.org", "creation_time": "2005-04-22T16:17:05Z", "attachment_id": null}, {"count": 8, "tags": [], "creator": "vani.narasimhan@nscorp.com", "text": "Created attachment 15330\ngetCellFormula() returns NO IDEA SHARED FORMULA EXP PTG\n\n The last column is a formula column in my attached excel sheet ,it is not\nbeing read by POI.\n    System.out.println(\"srcCell.getCellFormula() =\"+srcCell.getCellFormula());\n\treturns \"NO IDEA SHARED FORMULA EXP PTG\"\n\t\nIt fails in HSSFFormulaEvaluator at the following code block\n\n\t FormulaParser parser = new FormulaParser(srcCell.getCellFormula(),\nworkbook.getWorkbook());\n\t parser.parse(); //as parser expected an excel formula rather than a\nString\n\t\nCan anyone help me read the formula cell's value.\n\nThanks\nregards\nVani.", "id": 76138, "attachment_id": 15330, "bug_id": 20321, "creation_time": "2005-06-07T20:36:44Z", "time": "2005-06-07T20:36:44Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 20321, "attachment_id": null, "id": 79262, "time": "2005-09-01T09:51:25Z", "creator": "addy.bhardwaj@gmail.com", "creation_time": "2005-09-01T09:51:25Z", "is_private": false, "text": "How soon can we expect the resolution to \n\"Shared Formulas are not rendered at this time, that's why you get the \"SHARED\nFORMULA EXP PTG\".\"\n\nor its already released.\n\n- Is there a quick fix to excel without having to go and type the formulae again\n(manually)\n\n(In reply to comment #8)\n> Created an attachment (id=15330) [edit]\n> getCellFormula() returns NO IDEA SHARED FORMULA EXP PTG\n> \n>  The last column is a formula column in my attached excel sheet ,it is not\n> being read by POI.\n>     System.out.println(\"srcCell.getCellFormula() =\"+srcCell.getCellFormula());\n> \treturns \"NO IDEA SHARED FORMULA EXP PTG\"\n> \t\n> It fails in HSSFFormulaEvaluator at the following code block\n> \n> \t FormulaParser parser = new FormulaParser(srcCell.getCellFormula(),\n> workbook.getWorkbook());\n> \t parser.parse(); //as parser expected an excel formula rather than a\n> String\n> \t\n> Can anyone help me read the formula cell's value.\n> \n> Thanks\n> regards\n> Vani.\n\n(In reply to comment #8)\n> Created an attachment (id=15330) [edit]\n> getCellFormula() returns NO IDEA SHARED FORMULA EXP PTG\n> \n>  The last column is a formula column in my attached excel sheet ,it is not\n> being read by POI.\n>     System.out.println(\"srcCell.getCellFormula() =\"+srcCell.getCellFormula());\n> \treturns \"NO IDEA SHARED FORMULA EXP PTG\"\n> \t\n> It fails in HSSFFormulaEvaluator at the following code block\n> \n> \t FormulaParser parser = new FormulaParser(srcCell.getCellFormula(),\n> workbook.getWorkbook());\n> \t parser.parse(); //as parser expected an excel formula rather than a\n> String\n> \t\n> Can anyone help me read the formula cell's value.\n> \n> Thanks\n> regards\n> Vani.\n\n(In reply to comment #8)\n> Created an attachment (id=15330) [edit]\n> getCellFormula() returns NO IDEA SHARED FORMULA EXP PTG\n> \n>  The last column is a formula column in my attached excel sheet ,it is not\n> being read by POI.\n>     System.out.println(\"srcCell.getCellFormula() =\"+srcCell.getCellFormula());\n> \treturns \"NO IDEA SHARED FORMULA EXP PTG\"\n> \t\n> It fails in HSSFFormulaEvaluator at the following code block\n> \n> \t FormulaParser parser = new FormulaParser(srcCell.getCellFormula(),\n> workbook.getWorkbook());\n> \t parser.parse(); //as parser expected an excel formula rather than a\n> String\n> \t\n> Can anyone help me read the formula cell's value.\n> \n> Thanks\n> regards\n> Vani.\n\n"}, {"count": 10, "tags": [], "bug_id": 20321, "attachment_id": null, "id": 91182, "time": "2006-07-12T02:48:25Z", "creator": "trejkaz@trypticon.org", "creation_time": "2006-07-12T02:48:25Z", "is_private": false, "text": "*** Bug 36941 has been marked as a duplicate of this bug. ***"}, {"count": 11, "tags": [], "creator": "jheight@apache.org", "text": "Svn now converts Shared formulas to their non-shared equivalent, so this problem\nwill not occur. However, instead of returning NO IDEA SHARED FORMULA, the\ngetFormulaString calls for shared formauls Ptgs will now throw an exception\n(rather than confusing the issue with a string that will cause an exception to\nbe raised anyhow)\n\nJason", "id": 92568, "attachment_id": null, "bug_id": 20321, "creation_time": "2006-08-27T01:01:59Z", "time": "2006-08-27T01:01:59Z", "is_private": false}, {"count": 12, "tags": [], "bug_id": 20321, "attachment_id": null, "id": 135197, "time": "2010-03-09T14:36:06Z", "creator": "fabrizio.buonadonna@gmail.com", "creation_time": "2010-03-09T14:36:06Z", "is_private": false, "text": "Is this bug fixed?\nAnyone could help me?"}]