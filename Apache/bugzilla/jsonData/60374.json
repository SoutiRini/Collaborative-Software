[{"count": 0, "tags": [], "bug_id": 60374, "attachment_id": 34447, "id": 195002, "time": "2016-11-15T08:58:14Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-11-15T08:58:14Z", "is_private": false, "text": "Created attachment 34447\nSample file\n\nThe regression testing at http://people.apache.org/~centic/poi_regression/reportsAll/ shows the following for some files.\n\nIt seems the text-pieces in the files are stored as non-unicode, but the class PieceDescriptor sets unicode = true. If I set unicode = false manually there extracting text works for these documents as well.\n\n\n    public void testException() throws IOException, OpenXML4JException, XmlException {\n\t\tfinal POITextExtractor extractor = ExtractorFactory.createExtractor(POIDataSamples.getDocumentInstance().openResourceAsStream(\"cn.orthodox.www_divenbog_APRIL_30-APRIL.DOC\"));\n\n\t\t// Check it gives text without error\n\t\tSystem.out.println(extractor.getText());\n\n\t\textractor.close();\n\t}\n\n\n\njava.lang.IllegalArgumentException: Error creating Scratchpad Extractor\n\tat o.a.p.extractor.OLE2ExtractorFactory.createExtractor(OLE2ExtractorFactory.java:197)\n\tat o.a.p.extractor.OLE2ExtractorFactory.createExtractor(OLE2ExtractorFactory.java:119)\n\tat o.a.p.extractor.ExtractorFactory.createExtractor(ExtractorFactory.java:276)\n\tat o.a.p.extractor.ExtractorFactory.createExtractor(ExtractorFactory.java:129)\n\tat o.a.p.stress.AbstractFileHandler.handleExtractingInternal(AbstractFileHandler.java:81)\n\tat o.a.p.stress.AbstractFileHandler.handleExtracting(AbstractFileHandler.java:60)\n\tat org.dstadler.commoncrawl.FileHandlingRunnable.run(FileHandlingRunnable.java:62)\n\nCaused by: java.lang.reflect.InvocationTargetException\n\tat sun.reflect.GeneratedMethodAccessor4560.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat o.a.p.extractor.OLE2ExtractorFactory.createExtractor(OLE2ExtractorFactory.java:192)\n\t... 12 more\nCaused by: java.lang.ArrayIndexOutOfBoundsException\n\tat o.a.p.hwpf.model.TextPieceTable.(TextPieceTable.java:109)\n\tat o.a.p.hwpf.model.ComplexFileTable.(ComplexFileTable.java:70)\n\tat o.a.p.hwpf.HWPFOldDocument.(HWPFOldDocument.java:68)\n\tat o.a.p.hwpf.extractor.Word6Extractor.(Word6Extractor.java:74)\n\tat o.a.p.extractor.OLE2ScratchpadExtractorFactory.createExtractor(OLE2ScratchpadExtractorFactory.java:62)\n\t... 16 more"}, {"text": "This likely got fixed via bug 50955, the file now works fine, added a unit-test via r1798200.\n\n*** This bug has been marked as a duplicate of bug 50955 ***", "tags": [], "bug_id": 60374, "attachment_id": null, "count": 1, "id": 199120, "time": "2017-06-09T12:52:24Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2017-06-09T12:52:24Z", "is_private": false}]