[{"count": 0, "text": "Some times apache 2.2.6 segfault on url wich not in cache (for example): http://\nweb/manual/mod/mod_mime.html#removeoutputfilter\n\n<root@web:/usr/local/sbin> gdb httpd httpd.core\nGNU gdb 6.1.1 [FreeBSD]\nCopyright 2004 Free Software Foundation, Inc.\nGDB is free software, covered by the GNU General Public License, and you are\nwelcome to change it and/or distribute copies of it under certain conditions.\nType \"show copying\" to see the conditions.\nThere is absolutely no warranty for GDB.  Type \"show warranty\" for details.\nThis GDB was configured as \"i386-marcel-freebsd\"...\nCore was generated by `httpd'.\nProgram terminated with signal 11, Segmentation fault.\nReading symbols from /usr/local/lib/libpcre.so.0...done.\nLoaded symbols for /usr/local/lib/libpcre.so.0\nReading symbols from /usr/local/lib/libaprutil-1.so.2...done.\nLoaded symbols for /usr/local/lib/libaprutil-1.so.2\nReading symbols from /usr/local/lib/mysql/libmysqlclient_r.so.15...done.\nLoaded symbols for /usr/local/lib/mysql/libmysqlclient_r.so.15\nReading symbols from /lib/libm.so.4...done.\nLoaded symbols for /lib/libm.so.4\nReading symbols from /lib/libz.so.3...done.\nLoaded symbols for /lib/libz.so.3\nReading symbols from /usr/local/lib/libexpat.so.6...done.\nLoaded symbols for /usr/local/lib/libexpat.so.6\nReading symbols from /usr/local/lib/libiconv.so.3...done.\nLoaded symbols for /usr/local/lib/libiconv.so.3\nReading symbols from /usr/local/lib/libapr-1.so.2...done.\nLoaded symbols for /usr/local/lib/libapr-1.so.2\nReading symbols from /lib/libcrypt.so.3...done.\nLoaded symbols for /lib/libcrypt.so.3\nReading symbols from /lib/libpthread.so.2...done.\nLoaded symbols for /lib/libpthread.so.2\nReading symbols from /lib/libc.so.6...done.\nLoaded symbols for /lib/libc.so.6\nReading symbols from /usr/local/libexec/apache22/mod_dbd.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_dbd.so\nReading symbols from /usr/local/libexec/apache22/mod_authn_file.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_authn_file.so\nReading symbols from /usr/local/libexec/apache22/mod_authn_dbd.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_authn_dbd.so\nReading symbols from /usr/local/libexec/apache22/mod_authn_default.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_authn_default.so\nReading symbols from /usr/local/libexec/apache22/mod_authz_host.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_authz_host.so\nReading symbols from /usr/local/libexec/apache22/mod_authz_user.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_authz_user.so\nReading symbols from /usr/local/libexec/apache22/mod_authz_owner.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_authz_owner.so\nReading symbols from /usr/local/libexec/apache22/mod_authz_default.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_authz_default.so\nReading symbols from /usr/local/libexec/apache22/mod_auth_basic.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_auth_basic.so\nReading symbols from /usr/local/libexec/apache22/mod_file_cache.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_file_cache.so\nReading symbols from /usr/local/libexec/apache22/mod_cache.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_cache.so\nReading symbols from /usr/local/libexec/apache22/mod_disk_cache.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_disk_cache.so\nReading symbols from /usr/local/libexec/apache22/mod_mem_cache.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_mem_cache.so\nReading symbols from /usr/local/libexec/apache22/mod_include.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_include.so\nReading symbols from /usr/local/libexec/apache22/mod_filter.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_filter.so\nReading symbols from /usr/local/libexec/apache22/mod_charset_lite.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_charset_lite.so\nReading symbols from /usr/local/libexec/apache22/mod_deflate.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_deflate.so\nReading symbols from /usr/local/libexec/apache22/mod_log_config.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_log_config.so\nReading symbols from /usr/local/libexec/apache22/mod_env.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_env.so\nReading symbols from /usr/local/libexec/apache22/mod_mime_magic.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_mime_magic.so\nReading symbols from /usr/local/libexec/apache22/mod_cern_meta.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_cern_meta.so\nReading symbols from /usr/local/libexec/apache22/mod_expires.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_expires.so\nReading symbols from /usr/local/libexec/apache22/mod_headers.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_headers.so\nReading symbols from /usr/local/libexec/apache22/mod_unique_id.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_unique_id.so\nReading symbols from /usr/local/libexec/apache22/mod_setenvif.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_setenvif.so\nReading symbols from /usr/local/libexec/apache22/mod_ssl.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_ssl.so\nReading symbols from /usr/lib/libssl.so.4...done.\nLoaded symbols for /usr/lib/libssl.so.4\nReading symbols from /lib/libcrypto.so.4...done.\nLoaded symbols for /lib/libcrypto.so.4\nReading symbols from /usr/local/libexec/apache22/mod_mime.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_mime.so\nReading symbols from /usr/local/libexec/apache22/mod_autoindex.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_autoindex.so\nReading symbols from /usr/local/libexec/apache22/mod_suexec.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_suexec.so\nReading symbols from /usr/local/libexec/apache22/mod_cgi.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_cgi.so\nReading symbols from /usr/local/libexec/apache22/mod_negotiation.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_negotiation.so\nReading symbols from /usr/local/libexec/apache22/mod_dir.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_dir.so\nReading symbols from /usr/local/libexec/apache22/mod_actions.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_actions.so\nReading symbols from /usr/local/libexec/apache22/mod_speling.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_speling.so\nReading symbols from /usr/local/libexec/apache22/mod_alias.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_alias.so\nReading symbols from /usr/local/libexec/apache22/mod_rewrite.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_rewrite.so\nReading symbols from /usr/local/libexec/apache22/mod_fastcgi.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_fastcgi.so\nReading symbols from /usr/local/libexec/apache22/mod_rpaf.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_rpaf.so\nReading symbols from /libexec/ld-elf.so.1...done.\nLoaded symbols for /libexec/ld-elf.so.1\n#0  0x2852bad7 in cache_pq_remove (q=0x809d680, d=0x81f4d28) at \ncache_pqueue.c:185\n185     cache_pqueue.c: No such file or directory.\n        in cache_pqueue.c\n[New LWP 100211]\n\n\n\nhttpd-error.log:\n\n[Mon Oct 29 19:14:12 2007] [debug] mod_cache.c(131): Adding CACHE_SAVE filter \nfor /manual/mod/mod_mime.html\n[Mon Oct 29 19:14:12 2007] [debug] mod_cache.c(138): Adding CACHE_REMOVE_URL \nfilter for /manual/mod/mod_mime.html\n[Mon Oct 29 19:14:12 2007] [debug] mod_disk_cache.c(473): disk_cache: Recalled \ncached URL info header http://web:80/manual/mod/mod_mime.html.en?\n[Mon Oct 29 19:14:12 2007] [debug] mod_disk_cache.c(746): disk_cache: Recalled \nheaders for URL http://web:80/manual/mod/mod_mime.html.en?\n[Mon Oct 29 19:14:12 2007] [debug] cache_storage.c(272): Cached response for /\nmanual/mod/mod_mime.html.en isn't fresh.  Adding/replacing conditional request \nheaders.\n[Mon Oct 29 19:14:12 2007] [debug] mod_cache.c(131): Adding CACHE_SAVE filter \nfor /manual/mod/mod_mime.html.en\n[Mon Oct 29 19:14:12 2007] [debug] mod_cache.c(138): Adding CACHE_REMOVE_URL \nfilter for /manual/mod/mod_mime.html.en\n[Mon Oct 29 19:14:12 2007] [debug] mod_cache.c(528): cache: /manual/mod/\nmod_mime.html.en not cached. Reason: r->no_cache present\n[Mon Oct 29 19:14:13 2007] [notice] child pid 17428 exit signal Segmentation \nfault (11), possible coredump in /tmp/apache2-core\n\n\nhttpd-manual.conf:\n\n#\n# Provide access to the documentation on your server as\n#  http://yourserver.example.com/manual/\n# The documentation is always available at\n#  http://httpd.apache.org/docs/2.2/\n#\n# Required modules: mod_alias, mod_setenvif, mod_negotiation\n#\n\nAliasMatch ^/manual(?:/(?:de|en|es|fr|ja|ko|pt-br|ru))?(/.*)?$ \"/usr/local/\nshare/doc/apache22$1\"\n\n<Directory \"/usr/local/share/doc/apache22\">\n    Options Indexes\n    AllowOverride None\n    Order allow,deny\n    Allow from all\n\n    <Files *.html>\n        SetHandler type-map\n    </Files>\n\n    SetEnvIf Request_URI ^/manual/(de|en|es|fr|ja|ko|pt-br|ru)/ prefer-\nlanguage=$1\n    RedirectMatch 301 ^/manual(?:/(de|en|es|fr|ja|ko|pt-br|ru)){2,}(/.*)?$ /\nmanual/$1$2\n\n    LanguagePriority en de es fr ja ko pt-br ru\n    ForceLanguagePriority Prefer Fallback\n</Directory>\n\nhttpd-cache.conf\n\n#\n# Sample Cache Configuration\n#\n\n<IfModule mod_cache.c>\n#LoadModule disk_cache_module modules/mod_disk_cache.so\n# If you want to use mod_disk_cache instead of mod_mem_cache,\n# uncomment the line above and comment out the LoadModule line below.\n<IfModule mod_disk_cache.c>\nCacheRoot /var/cache\nCacheEnable disk /\nCacheDirLevels 5\nCacheDirLength 3\n</IfModule>\n\n<IfModule mod_mem_cache.c>\nCacheEnable mem /\nMCacheSize 2048\nMCacheMaxObjectCount 100\nMCacheMinObjectSize 1\nMCacheMaxObjectSize 1024\n</IfModule>\n\n# When acting as a proxy, don't cache the list of security updates\n# CacheDisable http://security.update.server/update-list/\n</IfModule>\n\n\nhttpd-vhost.conf:\n\nNameVirtualHost 192.168.1.3:8000\n\n#\n# VirtualHost example:\n# Almost any Apache directive may go into a VirtualHost container.\n# The first VirtualHost section is used for all requests that do not\n# match a ServerName or ServerAlias in any <VirtualHost> block.\n#\n\n<VirtualHost 192.168.1.3:8000>\n    DocumentRoot \"/usr/local/www/apache22/data\"\n    ServerName web\n\n    <Directory /usr/local/www/apache22/data>\n        Options +IncludesNoExec SymLinksIfOwnerMatch\n        AllowOverride All\n        Order allow,deny\n        Allow from all\n    </Directory>\n\n# Local access to the Apache HTTP Server Manual\nInclude etc/apache22/extra/httpd-manual.conf\n\n</VirtualHost>\n\nuname -a:\n\nFreeBSD web.server 6.3-PRERELEASE FreeBSD 6.3-PRERELEASE #19: Sun Oct 28 \n19:48:55 YEKT 2007     \nroot@home.bsd:/usr/obj/usr/src/sys/CUSTOM  i386", "bug_id": 43724, "attachment_id": null, "id": 109890, "time": "2007-10-29T08:24:12Z", "creator": "yarodin@gmail.com", "creation_time": "2007-10-29T08:24:12Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "text": "Can you please compile with --enable-debug and provide a full backtrace?\n(gdb -- bt full)", "attachment_id": null, "bug_id": 43724, "id": 110464, "time": "2007-11-12T18:58:08Z", "creator": "davi@apache.org", "creation_time": "2007-11-12T18:58:08Z", "is_private": false}, {"count": 2, "tags": [], "creator": "yarodin@gmail.com", "attachment_id": null, "is_private": false, "id": 110474, "time": "2007-11-13T04:52:20Z", "bug_id": 43724, "creation_time": "2007-11-13T04:52:20Z", "text": "Sorry for core dump for other url than at first report, but this segfault is \nappeared from time to time.\n\ngdb httpd httpd.core\nGNU gdb 6.1.1 [FreeBSD]\nCopyright 2004 Free Software Foundation, Inc.\nGDB is free software, covered by the GNU General Public License, and you are\nwelcome to change it and/or distribute copies of it under certain conditions.\nType \"show copying\" to see the conditions.\nThere is absolutely no warranty for GDB.  Type \"show warranty\" for details.\nThis GDB was configured as \"i386-marcel-freebsd\"...\nCore was generated by `httpd'.\nProgram terminated with signal 11, Segmentation fault.\nReading symbols from /usr/local/lib/libpcre.so.0...done.\nLoaded symbols for /usr/local/lib/libpcre.so.0\nReading symbols from /usr/local/lib/libaprutil-1.so.2...done.\nLoaded symbols for /usr/local/lib/libaprutil-1.so.2\nReading symbols from /usr/local/lib/mysql/libmysqlclient_r.so.15...done.\nLoaded symbols for /usr/local/lib/mysql/libmysqlclient_r.so.15\nReading symbols from /lib/libm.so.4...done.\nLoaded symbols for /lib/libm.so.4\nReading symbols from /lib/libz.so.3...done.\nLoaded symbols for /lib/libz.so.3\nReading symbols from /usr/local/lib/libexpat.so.6...done.\nLoaded symbols for /usr/local/lib/libexpat.so.6\nReading symbols from /usr/local/lib/libiconv.so.3...done.\nLoaded symbols for /usr/local/lib/libiconv.so.3\nReading symbols from /usr/local/lib/libapr-1.so.2...done.\nLoaded symbols for /usr/local/lib/libapr-1.so.2\nReading symbols from /lib/libcrypt.so.3...done.\nLoaded symbols for /lib/libcrypt.so.3\nReading symbols from /lib/libpthread.so.2...done.\nLoaded symbols for /lib/libpthread.so.2\nReading symbols from /lib/libc.so.6...done.\nLoaded symbols for /lib/libc.so.6\nReading symbols from /usr/local/libexec/apache22/mod_dbd.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_dbd.so\nReading symbols from /usr/local/libexec/apache22/mod_authn_file.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_authn_file.so\nReading symbols from /usr/local/libexec/apache22/mod_authn_dbd.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_authn_dbd.so\nReading symbols from /usr/local/libexec/apache22/mod_authn_default.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_authn_default.so\nReading symbols from /usr/local/libexec/apache22/mod_authz_host.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_authz_host.so\nReading symbols from /usr/local/libexec/apache22/mod_authz_user.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_authz_user.so\nReading symbols from /usr/local/libexec/apache22/mod_authz_owner.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_authz_owner.so\nReading symbols from /usr/local/libexec/apache22/mod_authz_default.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_authz_default.so\nReading symbols from /usr/local/libexec/apache22/mod_auth_basic.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_auth_basic.so\nReading symbols from /usr/local/libexec/apache22/mod_file_cache.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_file_cache.so\nReading symbols from /usr/local/libexec/apache22/mod_cache.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_cache.so\nReading symbols from /usr/local/libexec/apache22/mod_disk_cache.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_disk_cache.so\nReading symbols from /usr/local/libexec/apache22/mod_mem_cache.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_mem_cache.so\nReading symbols from /usr/local/libexec/apache22/mod_include.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_include.so\nReading symbols from /usr/local/libexec/apache22/mod_filter.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_filter.so\nReading symbols from /usr/local/libexec/apache22/mod_charset_lite.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_charset_lite.so\nReading symbols from /usr/local/libexec/apache22/mod_deflate.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_deflate.so\nReading symbols from /usr/local/libexec/apache22/mod_log_config.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_log_config.so\nReading symbols from /usr/local/libexec/apache22/mod_env.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_env.so\nReading symbols from /usr/local/libexec/apache22/mod_mime_magic.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_mime_magic.so\nReading symbols from /usr/local/libexec/apache22/mod_cern_meta.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_cern_meta.so\nReading symbols from /usr/local/libexec/apache22/mod_expires.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_expires.so\nReading symbols from /usr/local/libexec/apache22/mod_headers.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_headers.so\nReading symbols from /usr/local/libexec/apache22/mod_unique_id.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_unique_id.so\nReading symbols from /usr/local/libexec/apache22/mod_setenvif.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_setenvif.so\nReading symbols from /usr/local/libexec/apache22/mod_ssl.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_ssl.so\nReading symbols from /usr/lib/libssl.so.4...done.\nLoaded symbols for /usr/lib/libssl.so.4\nReading symbols from /lib/libcrypto.so.4...done.\nLoaded symbols for /lib/libcrypto.so.4\nReading symbols from /usr/local/libexec/apache22/mod_mime.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_mime.so\nReading symbols from /usr/local/libexec/apache22/mod_autoindex.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_autoindex.so\nReading symbols from /usr/local/libexec/apache22/mod_suexec.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_suexec.so\nReading symbols from /usr/local/libexec/apache22/mod_cgi.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_cgi.so\nReading symbols from /usr/local/libexec/apache22/mod_negotiation.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_negotiation.so\nReading symbols from /usr/local/libexec/apache22/mod_dir.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_dir.so\nReading symbols from /usr/local/libexec/apache22/mod_actions.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_actions.so\nReading symbols from /usr/local/libexec/apache22/mod_speling.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_speling.so\nReading symbols from /usr/local/libexec/apache22/mod_alias.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_alias.so\nReading symbols from /usr/local/libexec/apache22/mod_rewrite.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_rewrite.so\nReading symbols from /usr/local/libexec/apache22/mod_fastcgi.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_fastcgi.so\nReading symbols from /usr/local/libexec/apache22/mod_rpaf.so...done.\nLoaded symbols for /usr/local/libexec/apache22/mod_rpaf.so\nReading symbols from /libexec/ld-elf.so.1...done.\nLoaded symbols for /libexec/ld-elf.so.1\n#0  0x28537ad7 in cache_pq_remove (q=0x809d680, d=0x81fbd10) at \ncache_pqueue.c:185\n185     cache_pqueue.c: No such file or directory.\n        in cache_pqueue.c\n[New LWP 100180]\n(gdb) bt full\n#0  0x28537ad7 in cache_pq_remove (q=0x809d680, d=0x81fbd10) at \ncache_pqueue.c:185\n        posn = 136298008\n#1  0x285375ac in cache_remove (c=0x80ea600, entry=0x81fbd10) at \ncache_cache.c:157\n        entry_size = 136302632\n        rc = 676532916\n#2  0x285363b2 in remove_url (h=0x81fbd00, p=0x8208018) at mod_mem_cache.c:527\n        obj = (cache_object_t *) 0x81fbd10\n        cleanup = 0\n#3  0x2852add9 in cache_remove_url (cache=0x81fbc48, p=0x8208018) at \ncache_storage.c:51\n        list = (cache_provider_list *) 0x81fbc38\n        h = (cache_handle_t *) 0x81fbd00\n#4  0x2852a33a in cache_remove_url_filter (f=0x81fdb00, in=0x81fe1e0) at \nmod_cache.c:882\n        r = (request_rec *) 0x81fb200\n        cache = (cache_request_rec *) 0x81fbc48\n#5  0x0808281a in ap_pass_brigade (next=0x81fdb00, bb=0x81fe1e0) at \nutil_filter.c:526\n        e = (apr_bucket *) 0x81f2198\n#6  0x2852a35c in cache_remove_url_filter (f=0x82095b8, in=0x81fe1e0) at \nmod_cache.c:886\n        r = (request_rec *) 0x81fb200\n        cache = (cache_request_rec *) 0x82093f0\n#7  0x0808281a in ap_pass_brigade (next=0x82095b8, bb=0x81fe1e0) at \nutil_filter.c:526\n        e = (apr_bucket *) 0x81f2198\n#8  0x08088c54 in ap_http_outerror_filter (f=0x8208e30, b=0x81fe1e0) at \nhttp_filters.c:1391\n        r = (request_rec *) 0x81fb200\n        e = (apr_bucket *) 0x81fe1e4\n#9  0x0808281a in ap_pass_brigade (next=0x8208e30, bb=0x81fe1e0) at \nutil_filter.c:526\n        e = (apr_bucket *) 0x81f2198\n#10 0x08088513 in ap_http_header_filter (f=0x8208e18, b=0x81fdf40) at \nhttp_filters.c:1076\n        r = (request_rec *) 0x81fb200\n        c = (conn_rec *) 0x81ee108\n        clheader = 0x0\n        protocol = 0x80953a4 \"HTTP/1.1\"\n        e = (apr_bucket *) 0x81fdf44\n        b2 = (apr_bucket_brigade *) 0x81fe1e0\n        h = {pool = 0x8208018, bb = 0x81fe1e0}\n        ctx = (header_filter_ctx *) 0x0\n#11 0x0808281a in ap_pass_brigade (next=0x8208e18, bb=0x81fdf40) at \nutil_filter.c:526\n        e = (apr_bucket *) 0x81f2038\n#12 0x0806a490 in ap_content_length_filter (f=0x8208e00, b=0x81fdf40) at \nprotocol.c:1338\n        r = (request_rec *) 0x81fb200\n        ctx = (struct content_length_ctx *) 0x81fdf60\n        e = (apr_bucket *) 0x81f2038\n        eos = 1\n        eblock = APR_NONBLOCK_READ\n#13 0x0808281a in ap_pass_brigade (next=0x8208e00, bb=0x81fdf40) at \nutil_filter.c:526\n        e = (apr_bucket *) 0x81f2038\n#14 0x08089305 in ap_byterange_filter (f=0x8208de8, bb=0x81fdf40) at \nbyterange_filter.c:169\n        r = (request_rec *) 0x81fb200\n        c = (conn_rec *) 0x81ee108\n        ctx = (byterange_ctx *) 0x210\n        e = (apr_bucket *) 0x81f2038\n        bsend = (apr_bucket_brigade *) 0x807bdc3\n        range_start = 579150020440857252\n        range_end = 134843984\n        current = 0x0\n        clength = 0\n---Type <return> to continue, or q <return> to quit---\n        rv = -1077942576\n        found = 0\n        num_ranges = 672148632\n#15 0x0808281a in ap_pass_brigade (next=0x8208de8, bb=0x81fdf40) at \nutil_filter.c:526\n        e = (apr_bucket *) 0x81f2038\n#16 0x2852997a in cache_save_filter (f=0x81fdae8, in=0x81fdf40) at \nmod_cache.c:536\n        rv = 1\n        r = (request_rec *) 0x81fb200\n        cache = (cache_request_rec *) 0x81fbc48\n        conf = (cache_server_conf *) 0x80eeda8\n        cc_out = 0x0\n        cl = 0xf3c76180 <Address 0xf3c76180 out of bounds>\n        exps = 0x0\n        lastmods = 0x81fdeb0 \"Sat, 01 Sep 2007 12:19:34 GMT\"\n        dates = 0x283ce16c \"\\210@\\002\"\n        etag = 0x81fdef0 \"\\\"b6470f-f87-f3c76180;b64719-ac-4c23b600\\\"\"\n        exp = 0\n        date = 2899440114092474368\n        lastmod = 1188649174000000\n        now = 1194954391027742\n        size = 2899113957493041048\n        info = (cache_info *) 0x0\n        reason = 0x2852d3fa \"r->no_cache present\"\n        p = (apr_pool_t *) 0x8208018\n#17 0x0808281a in ap_pass_brigade (next=0x81fdae8, bb=0x81fdf40) at \nutil_filter.c:526\n        e = (apr_bucket *) 0x81f2038\n#18 0x0807112f in default_handler (r=0x81fb200) at core.c:3740\n        c = (conn_rec *) 0x81ee108\n        bb = (apr_bucket_brigade *) 0x81fdf40\n        e = (apr_bucket *) 0x81f2038\n        d = (core_dir_config *) 0x8209a88\n        errstatus = 304\n        fd = (apr_file_t *) 0x81fde28\n        status = 0\n        bld_content_md5 = 0\n#19 0x0807751a in ap_run_handler (r=0x81fb200) at config.c:157\n        pHook = (ap_LINK_handler_t *) 0x81ae508\n        n = 7\n        rv = -1\n#20 0x08077c99 in ap_invoke_handler (r=0x81fb200) at config.c:372\n        handler = 0x81834c0 \"text/html\"\n        p = 0x0\n        result = 0\n        old_handler = 0x0\n        ignore = 0x0\n#21 0x08086229 in ap_internal_redirect (new_uri=0x81fb1e0 \"/manual/ko/ssl/\nindex.html.en\", r=0x8208050) at http_request.c:477\n        new = (request_rec *) 0x81fb200\n        access_status = 0\n#22 0x286f320d in handle_map_file (r=0x8208050) at mod_negotiation.c:3080\n        neg = (negotiation_state *) 0x820d168\n        map = (apr_file_t *) 0x820eb30\n        best = (var_rec *) 0x820dd70\n        res = 0\n        udir = 0x81fb1b0 \"/manual/ko/ssl/\"\n        new_req = 0x81fb1e0 \"/manual/ko/ssl/index.html.en\"\n---Type <return> to continue, or q <return> to quit---\n#23 0x0807751a in ap_run_handler (r=0x8208050) at config.c:157\n        pHook = (ap_LINK_handler_t *) 0x81ae508\n        n = 2\n        rv = -1\n#24 0x08077c99 in ap_invoke_handler (r=0x8208050) at config.c:372\n        handler = 0x0\n        p = 0x0\n        result = 0\n        old_handler = 0x8159788 \"type-map\"\n        ignore = 0x0\n#25 0x080859ec in ap_process_request (r=0x8208050) at http_request.c:258\n        access_status = 0\n#26 0x08082dfc in ap_process_http_connection (c=0x81ee108) at http_core.c:184\n        r = (request_rec *) 0x8208050\n        csd = (apr_socket_t *) 0x0\n#27 0x0807ecce in ap_run_process_connection (c=0x81ee108) at connection.c:43\n        pHook = (ap_LINK_process_connection_t *) 0x81ae980\n        n = 0\n        rv = -2\n#28 0x0807f10c in ap_process_connection (c=0x81ee108, csd=0x81ee050) at \nconnection.c:178\n        rc = -2\n#29 0x0808afba in child_main (child_num_arg=1) at prefork.c:640\n        current_conn = (conn_rec *) 0x81ee108\n        csd = (void *) 0x81ee050\n        ptrans = (apr_pool_t *) 0x81ee018\n        allocator = (apr_allocator_t *) 0x81e9a80\n        status = 0\n        i = -1\n        lr = (ap_listen_rec *) 0x80ad998\n        pollset = (apr_pollset_t *) 0x81ec250\n        sbh = (ap_sb_handle_t *) 0x81ec248\n        bucket_alloc = (apr_bucket_alloc_t *) 0x81f2018\n        last_poll_idx = 1\n#30 0x0808b15a in make_child (s=0x80b0eb8, slot=1) at prefork.c:736\n        pid = 0\n#31 0x0808b1cd in startup_children (number_to_start=4) at prefork.c:754\n        i = 1\n#32 0x0808b5f5 in ap_mpm_run (_pconf=0x80af018, plog=0x80dd018, s=0x80b0eb8) at \nprefork.c:975\n        index = 134866176\n        remaining_children_to_start = 5\n        rv = 0\n#33 0x080623b7 in main (argc=2, argv=0xbfbfec20) at main.c:730\n        c = 68 'D'\n        configtestonly = 0\n        confname = 0x808d77d \"etc/apache22/httpd.conf\"\n        def_server_root = 0x808d795 \"/usr/local\"\n        temp_error_log = 0x0\n        error = 0x0\n        process = (process_rec *) 0x80ad098\n        server_conf = (server_rec *) 0x80b0eb8\n        pglobal = (apr_pool_t *) 0x80ad018\n        pconf = (apr_pool_t *) 0x80af018\n        plog = (apr_pool_t *) 0x80dd018\n        ptemp = (apr_pool_t *) 0x80e2018\n        pcommands = (apr_pool_t *) 0x80b1018\n---Type <return> to continue, or q <return> to quit---\n        opt = (apr_getopt_t *) 0x80b10b0\n        rv = 0\n        mod = (module **) 0x8097030\n        optarg = 0xbfbfed2c \"SSL\"\n        signal_server = (apr_OFN_ap_signal_server_t *) 0\n"}, {"count": 3, "tags": [], "creator": "pgollucci@apache.org", "attachment_id": null, "is_private": false, "id": 124169, "time": "2009-01-18T16:19:17Z", "bug_id": 43724, "creation_time": "2009-01-18T16:19:17Z", "text": "CC myself on FreeBSD related bugs"}, {"count": 4, "tags": [], "creator": "petr.sumbera@oracle.com", "attachment_id": null, "is_private": false, "id": 170752, "time": "2013-10-22T13:19:24Z", "bug_id": 43724, "creation_time": "2013-10-22T13:19:24Z", "text": "One of our customer see very similar problem with Apache 2.2.24 (64bit/intel/Worker-MPM).\n\nffff80ffbdb78a40 mod_mem_cache.so`cache_pq_remove+0x36()\nffff80ffbdb78a70 mod_mem_cache.so`cache_remove+0x2e()\nffff80ffbdb78aa0 mod_mem_cache.so`remove_url+0x5a()\nffff80ffbdb78ad0 mod_cache.so`cache_remove_url+0x87()\nffff80ffbdb78af0 mod_cache.so`cache_remove_url_filter+0x24()\nffff80ffbdb78d20 ap_http_header_filter+0xc71()\nffff80ffbdb78d90 ap_content_length_filter+0x204()\nffff80ffbdb78e40 ap_byterange_filter+0x692()\nffff80ffbdb78e70 ap_finalize_request_protocol+0x6d()\nffff80ffbdb78ec0 ap_process_request+0x334()\nffff80ffbdb78ef0 ap_process_http_connection+0x66()\nffff80ffbdb78f20 ap_process_connection+0xad()\nffff80ffbdb78fb0 worker_thread+0x1df()\nffff80ffbdb78fc0 libapr-1.so.0.3.9`dummy_worker+0xe()\nffff80ffbdb78fe0 libc.so.1`_thrp_setup+0xa5()\nffff80ffbdb78ff0 libc.so.1`_lwp_start()\n\nWorkaround is according them to disable mod_mem_cache."}, {"count": 5, "tags": [], "creator": "petr.sumbera@oracle.com", "attachment_id": null, "is_private": false, "id": 191972, "time": "2016-06-27T15:35:57Z", "bug_id": 43724, "creation_time": "2016-06-27T15:35:57Z", "text": "While looking closely at core file I see it's throwing segmentation fault at\n\n185    q->d[posn] = q->d[--q->size];\n\ncache_pq_remove+0x23:           movq   (%rbx),%rcx\ncache_pq_remove+0x26:           leaq   -0x1(%rcx),%rax\ncache_pq_remove+0x2a:           movq   %rax,(%rbx)\ncache_pq_remove+0x2d:           movq   0x30(%rbx),%rax\ncache_pq_remove+0x31:           movq   -0x8(%rax,%rcx,8),%rcx\ncache_pq_remove+0x36:           movq   %rcx,(%rax,%r12,8)   <===== here"}, {"count": 6, "tags": [], "text": "MCacheMaxObjectCount was set to 10099. But from core it seems that 'posn = q->get(d)' sets posn to 15151592.\n\nI can see also:\nq->size = 0\nq->avail = 10100\nq->step = 10100\n\nsize is zero. So shouldn't cache_pq_remove() start with something like:\n\nif (!q || q->size == 1)\nreturn NULL;\n\n?\n\nBTW this might be related to 2.2 only as cache_pqueue.c doesn't seem to be present in 2.4.", "attachment_id": null, "id": 192003, "creation_time": "2016-06-28T15:20:47Z", "time": "2016-06-28T15:20:47Z", "creator": "petr.sumbera@oracle.com", "bug_id": 43724, "is_private": false}, {"count": 7, "text": "Created attachment 33995\nDon't try to remove a replaced/missing entry\n\nPlease try this patch, cache_remove() shouldn't be called unconditionally here.", "bug_id": 43724, "is_private": false, "id": 192004, "time": "2016-06-28T16:10:11Z", "creator": "ylavic.dev@gmail.com", "creation_time": "2016-06-28T16:10:11Z", "tags": [], "attachment_id": 33995}, {"count": 8, "tags": [], "text": "I won't be able to test proposed fix as I cannot reproduce the issue. And since the customer is moving to version 2.4 I'm not sure he will do.", "attachment_id": null, "id": 192016, "creation_time": "2016-06-29T14:14:29Z", "time": "2016-06-29T14:14:29Z", "creator": "petr.sumbera@oracle.com", "bug_id": 43724, "is_private": false}]