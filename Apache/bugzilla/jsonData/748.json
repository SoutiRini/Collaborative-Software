[{"count": 0, "attachment_id": null, "bug_id": 748, "text": "This problem has been reported in tomcat-dev by Kazuhiro Kazama before.\nBut it doesn't seem to fix yet , I report again.\n\n----- begin of Kazama's report -----\nFrom: kazama@ingrid.org (Kazuhiro Kazama)\nSubject: Re: Bug Report #649\nDate: Fri, 22 Dec 2000 11:43:01 +0900\nMessage-ID: <20001222114301I.kazama@ingrid.org>\n> This bug may be system dependent. Would you describe your OS and its\n> release?\n\nI analyzed this problem in cooperation with JavaHouse-Brewers mailing\nlist (Java technical discussions in Japan) and found there are two\nbugs.\n\nThese bugs resembles ServletExec JSP source disclosure vulnerability\n(http://www.securityfocus.com/bid/1970) in situation.\n\n1, When you adds \"%20\" (in fact, URL encoded character or its\nsequences from %01 to %20) to an URL's end, Tomcat returns a JSP\nsource code instead of its result.\n\nWhen you uses mod_jk and delegates all HTTP requests under the\ndirectory specified by a \"JkMount\" directive to Tomcat, this bug comes\nout.\n\nExample:\n        http://localhost/examples/jsp/num/numguess.jsp%20\n\nWorkaround:\nApply an atached patch to your Tomcat 3.2.1. This patch removes extra\ntrim() which is remove U+0000 - U+0020 characters from an URL.\n\n2, When you adds '.' or \"%2E\" (= '.') to an URL's end, Apache server\n(not Tomcat) returns a JSP source code of JSP files.\n\nThis is a Windows bug and I confirmed it on Windows 98 and Windows\n2000. But a security measure is needed to Apache server.\n\nWhen you uses mod_jk on Windows and JSP files is accessible from your\napache server by adding an \"Alias\" directive, This bug comes out.\n\nExample:\n        http://localhost/examples/jsp/num/numguess.jsp.\n        http://localhost/examples/jsp/num/numguess.jsp%2E\n\nWorkaround:\nOn Windows platform, don't use \"Alias\" directive for mounting your Web\napplication directory. Tomcat generates \"mod_jk.conf-auto\" has \"Alias\"\ndirectives so that you should fix it on Windows.\n\nThis bug may be correctable but I have no time to fix Apache server. I\nhope someone will inform better solution.\n\nBy the way, these bugs don't happen on Tomcat & mod_jserv. But I don't\nthink that it is a good idea to use a mod_jserv module on Tomcat 3.2.1\nbecause this behavior may depend anothor mod_jserv bugs.\n\nKazuhiro Kazama (kazama@ingrid.org)             NTT Network Innovation \nLaboratories\n----- end of Kazama's report -----", "id": 903, "time": "2001-02-28T07:36:37Z", "creator": "kare@w4.dion.ne.jp", "creation_time": "2001-02-28T07:36:37Z", "tags": [], "is_private": false}, {"count": 1, "attachment_id": 28, "creator": "kare@w4.dion.ne.jp", "is_private": false, "id": 904, "time": "2001-02-28T07:40:53Z", "bug_id": 748, "creation_time": "2001-02-28T07:40:53Z", "tags": [], "text": "Created attachment 28\nPatch for Bug 748"}, {"count": 2, "attachment_id": null, "bug_id": 748, "text": "A variation of this bug seems to show itself when you telnet to the tomcat \nservers port, issue a GET and don't specify a protocol!\n\ntelnet 10.0.3.2\n8080                                                                            \n           \nTrying 10.0.3.2...\nConnected to 10.0.3.2.\nEscape character is '^]'.\nGET /examples/jsp/num/numguess.jsp\n\nHTTP/1.0 200 OK\nContent-Type: text/plain\nContent-Length: 1237\nLast-Modified: Fri, 16 Mar 2001 19:11:58 GMT\nServlet-Engine: Tomcat Web Server/3.2.1 (JSP 1.1; Servlet 2.2; Java 1.2.2; \nWindows 95 4.10 x86; java.vendor=Sun Microsystems Inc.)\n\n<!--\n  Copyright (c) 1999 The Apache Software Foundation.  All rights \n  reserved.\n\n  Number Guess Game\n  Written by Jason Hunter, CTO, K&A Software\n  http://www.servlets.com\n-->\n\n<%@ page import = \"num.NumberGuessBean\" %>\n\n<jsp:useBean id=\"numguess\" class=\"num.NumberGuessBean\" scope=\"session\"/>\n<jsp:setProperty name=\"numguess\" property=\"*\"/>\n\n<html>\n<head><title>Number Guess</title></head>\n<body bgcolor=\"white\">\n<font size=4>\n\n<% if (numguess.getSuccess()) { %>\n\n  Congratulations!  You got it.\n  And after just <%= numguess.getNumGuesses() %> tries.<p>\n\n  <% numguess.reset(); %>\n\n  Care to <a href=\"numguess.jsp\">try again</a>?\n\n<% } else if (numguess.getNumGuesses() == 0) { %>\n\n  Welcome to the Number Guess game.<p>\n\n  I'm thinking of a number between 1 and 100.<p>\n\n  <form method=get>\n  What's your guess? <input type=text name=guess>\n  <input type=submit value=\"Submit\">\n  </form>\n\n<% } else { %>\n\n  Good guess, but nope.  Try <b><%= numguess.getHint() %></b>.\n\n  You have made <%= numguess.getNumGuesses() %> guesses.<p>\n\n  I'm thinking of a number between 1 and 100.<p>\n\n  <form method=get>\n  What's your guess? <input type=text name=guess>\n  <input type=submit value=\"Submit\">\n  </form>\n\n<% } %>\n\n</font>\n</body>\n</html>\nConnection closed by foreign host.\n", "id": 1408, "time": "2001-03-19T17:20:29Z", "creator": "tomcatbug@positivemind.com", "creation_time": "2001-03-19T17:20:29Z", "tags": [], "is_private": false}, {"count": 3, "attachment_id": null, "bug_id": 748, "text": "Above HTTP 0.9(GET without specify protocol) problem was fixed Tomcat 3.2.2b1 & \nTomcat 3.3m1.\n", "id": 1432, "time": "2001-03-20T06:41:32Z", "creator": "kare@w4.dion.ne.jp", "creation_time": "2001-03-20T06:41:32Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 748, "attachment_id": null, "is_private": false, "id": 1474, "time": "2001-03-20T14:33:27Z", "creator": "marc.saegesser@apropos.com", "creation_time": "2001-03-20T14:33:27Z", "text": "As the last comment states this has been fixed in 3.2.2b1 and 3.3.  I'm not \nsure if the 4.0 fix has been applied yet so I'm leaving this open."}, {"count": 5, "tags": [], "creator": "cmanolache@yahoo.com", "is_private": false, "id": 5513, "attachment_id": null, "bug_id": 748, "creation_time": "2001-09-13T22:13:20Z", "time": "2001-09-13T22:13:20Z", "text": "Closing the bug, it has been fixed in all tomca versions."}]