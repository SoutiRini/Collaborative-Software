[{"count": 0, "tags": [], "bug_id": 58422, "attachment_id": null, "id": 185295, "time": "2015-09-16T14:04:55Z", "creator": "pal.ratikanta@gmail.com", "creation_time": "2015-09-16T14:04:55Z", "is_private": false, "text": "Hi,\nI want to add a image to Header of excel .As long I can see all the methods of \"org.apache.poi.ss.usermodel.HeaderFooter\" class is have string argument .How can I add image to header portion??\n\nCode:\n-------------------------------------------------------------------------------------\n\npublic static void main(String[] args) {\n\t\ttry {\n\t\t\tHeaderFooter vHead = null;\n\t\t\tint idx = 0;\n\t\t\tint idy = 0;\n\t\t\tCell vFirstCell = null;\n\t\t\tCell vLastCell = null;\n\t\t\tCell vCell = null;\n\t\t\tFileOutputStream fileOut = new FileOutputStream(\"poi-test.xlsx\");\n\t\t\tSXSSFWorkbook workbook = new SXSSFWorkbook(100);\n\t\t\tSXSSFSheet worksheet = (SXSSFSheet) workbook.createSheet(\"POI Worksheet\");\n\t\t\tvHead = worksheet.getHeader();\n\n\t\t\tInputStream my_banner_image = new FileInputStream(\"C:\\\\Users\\\\RATI\\\\Desktop\\\\rati.jpg\");\n\t\t\tbyte[] bytes = IOUtils.toByteArray(my_banner_image);\n\t\t\tint my_picture_id = workbook.addPicture(bytes, Workbook.PICTURE_TYPE_JPEG);\n\t\t\tmy_banner_image.close();\n\t\t\tCreationHelper helper = workbook.getCreationHelper();\n\t\t\tDrawing drawing = worksheet.createDrawingPatriarch();\n\t\t\tClientAnchor anchor = helper.createClientAnchor();\n\t\t\tPicture pict = drawing.createPicture(anchor, my_picture_id);\n\t\t\tvHead.setCenter(HSSFHeader.font(\"Times New Roman\", \"Bold\") + HSSFHeader.fontSize((short) 12) + \"Rati\");\n\t\t\tvHead.setRight(HSSFHeader.font(\"Times New Roman\", \"Bold\") + HSSFHeader.fontSize((short) 8) + \"&[Picture]\");\n\t\t\t\n\t\t\t// index from 0,0... cell A1 is cell(0,0)\n\t\t\tRow row1 = worksheet.createRow(idx++);\n\n\t\t\tvCell = row1.createCell(idy++);\n\t\t\tvFirstCell = vCell;\n\t\t\tvCell.setCellValue(\"NAME1\");\n\t\t\tvCell = row1.createCell(idy++);\n\t\t\tvCell.setCellValue(\"NAME2\");\n\t\t\tvCell = row1.createCell(idy++);\n\t\t\tvCell.setCellValue(\"NAME3\");\n\t\t\tvCell = row1.createCell(idy++);\n\t\t\tvCell.setCellValue(\"NAME4\");\n\t\t\tvCell = row1.createCell(idy++);\n\t\t\tvCell.setCellValue(\"NAME5\");\n\n\t\t\tidy = 0;\n\n\t\t\trow1 = worksheet.createRow(idx++);\n\n\t\t\tvCell = row1.createCell(idy++);\n\t\t\tvFirstCell = vCell;\n\t\t\tvCell.setCellValue(\"NAME1\");\n\t\t\tvCell = row1.createCell(idy++);\n\t\t\tvCell.setCellValue(\"NAME2\");\n\t\t\tvCell = row1.createCell(idy++);\n\t\t\tvCell.setCellValue(\"NAME3\");\n\t\t\tvCell = row1.createCell(idy++);\n\t\t\tvCell.setCellValue(\"NAME4\");\n\t\t\tvCell = row1.createCell(idy++);\n\t\t\tvCell.setCellValue(\"NAME5\");\n\n\t\t\tfor (int i = 0; i < 100; i++) {\n\n\t\t\t\trow1 = worksheet.createRow(idx++);\n\t\t\t\tidy = 0;\n\t\t\t\tfor (int j = 0; j < 5; j++) {\n\t\t\t\t\tvCell = row1.createCell(idy++);\n\t\t\t\t\tvCell.setCellValue(\"TEST--\" + i + \"--DATA--\" + j);\n\t\t\t\t\tvLastCell = vCell;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (int i = 0; i < 5; i++) {\n\t\t\t\t// worksheet.autoSizeColumn(i);\n\t\t\t}\n\n\t\t\tworksheet.setAutoFilter(new CellRangeAddress(1, 101, 0, 4));\n\t\t\tworkbook.write(fileOut);\n\t\t\tfileOut.flush();\n\t\t\tfileOut.close();\n\t\t} catch (FileNotFoundException e) {\n\t\t\te.printStackTrace();\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\n\t}"}, {"count": 1, "tags": [], "text": "You should post this question to the poi-user group [1]. The group is pretty active and you're more likely to get responses there for usage questions.\n\nWe usually only open bugs if we have figured out that POI is missing a feature or there's a bug in an existing feature.\n\nYou may also be interested at looking at some similar open bugs:\nbug 53309 - similar request for XSSFWorkbooks\nbug 46704 - similar request for HSSFWorkbooks\nbug 58237 - similar request for slideshow presentations\n\n[1] http://poi.apache.org/mailinglists.html", "attachment_id": null, "id": 185682, "creator": "onealj@apache.org", "time": "2015-10-07T10:12:06Z", "bug_id": 58422, "creation_time": "2015-10-07T10:12:06Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 58422, "attachment_id": null, "text": "I am closing this one as duplicate of the XSSF-related bug as we should be able to reuse an implementation for both XSSF and SXSSF and thus we should avoid two places for discussions about this.\n\n*** This bug has been marked as a duplicate of bug 53309 ***", "id": 186120, "time": "2015-10-30T18:03:52Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-10-30T18:03:52Z", "is_private": false}]