[{"count": 0, "tags": [], "text": "I have a bunch of xlsx file with this issue. Unfortunately these files are non-public and the moment I edit them using my Excel 2010 to remove the confidential info, the issue goes away. I am happy to email them to someone.\n\nThe exception thread is:\n\norg.apache.poi.EncryptedDocumentException: cipher algorithm not found\n\tat org.apache.poi.poifs.crypt.CipherAlgorithm.fromEcmaId(CipherAlgorithm.java:65)\n\tat org.apache.poi.poifs.crypt.standard.StandardEncryptionHeader.<init>(StandardEncryptionHeader.java:56)\n\tat org.apache.poi.poifs.crypt.standard.StandardEncryptionInfoBuilder.initialize(StandardEncryptionInfoBuilder.java:42)\n\tat org.apache.poi.poifs.crypt.EncryptionInfo.<init>(EncryptionInfo.java:72)\n\tat org.apache.poi.poifs.crypt.EncryptionInfo.<init>(EncryptionInfo.java:47)", "is_private": false, "bug_id": 57195, "id": 179018, "time": "2014-11-10T03:47:16Z", "creator": "bearbalu@hotmail.com", "creation_time": "2014-11-10T03:47:16Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "id": 179307, "time": "2014-11-26T19:59:54Z", "bug_id": 57195, "creation_time": "2014-11-26T19:59:54Z", "is_private": false, "text": "Unfortunately the code currently does not print out the details of which cipher the document uses, I have added this to the latest trunk version, so if you can grab the binaries from https://builds.apache.org/job/POI/lastSuccessfulBuild/artifact/build/dist/ (build is currently running), then we should see which exact cipher these documents use..."}, {"count": 2, "tags": [], "creator": "kiwiwings@apache.org", "text": "I have already uploaded a temporary patch for this - see https://issues.apache.org/bugzilla/show_bug.cgi?id=35897#c35\n\nI'm currently trying to get cryptoapi encryption to work.\nAs I also refactored the internals of the other crypto modules, I'll commit both when the cryptoapi impl. is ready.", "id": 179313, "time": "2014-11-26T21:44:20Z", "bug_id": 57195, "creation_time": "2014-11-26T21:44:20Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "kiwiwings@apache.org", "text": "Applied as part of r1647867\n\nLooking at the MS-OFFCRYPTO docs, I'm still a little bit puzzled, that there's a rc4 encryption [1], which is record based (see Biff8DecryptingStream) and the same term is used for a container based mode\n\n[1] http://msdn.microsoft.com/en-us/library/dd907466(v=office.12).aspx", "id": 180022, "time": "2014-12-25T02:01:43Z", "bug_id": 57195, "creation_time": "2014-12-25T02:01:43Z", "is_private": false, "attachment_id": null}]