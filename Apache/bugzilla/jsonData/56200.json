[{"count": 0, "text": "Created attachment 31355\nCode used for Debugging\n\nUsing the same code, I get different results between the 1.6.43x64 JRE and the 1.7.21x64 JRE.  With 1.6 JRE the spreadsheet formats as expected.  With 1.7 JRE, the created columns appear hidden.  I've tried with POI 3.8 and 3.10 Final.  The data is in the spreadsheet.  If I select all rows/columns and paste values to another sheet, I see the information entered.", "creator": "ktrykid@hotmail.com", "is_private": false, "id": 173542, "time": "2014-02-28T14:56:42Z", "bug_id": 56200, "creation_time": "2014-02-28T14:56:42Z", "tags": [], "attachment_id": 31355}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "is_private": false, "text": "Since you're using .xlsx, the file format is a zip of xml files. Any chance you could unzip the .xlsx files from 1.6 and 1.7, then compare them for differences?", "id": 173544, "time": "2014-02-28T15:05:37Z", "bug_id": 56200, "creation_time": "2014-02-28T15:05:37Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "ktrykid@hotmail.com", "attachment_id": null, "is_private": false, "id": 173545, "time": "2014-02-28T15:29:54Z", "bug_id": 56200, "creation_time": "2014-02-28T15:29:54Z", "text": "Unzipped and examined with a compare tool.  The main difference I see is the Width attribute under the \\xl\\worksheets\\sheet1.xml on the column tags.  I also note that if I comment out the sheet.autosizecolumn() that it shows up.  So somehow the font/data size is getting interpreted as zero?"}, {"count": 3, "tags": [], "text": "Are you certain you're using the same jars on both JVMs? http://poi.apache.org/faq.html#faq-N10006 has some code you can use to verify this", "is_private": false, "id": 173546, "creation_time": "2014-02-28T15:32:18Z", "time": "2014-02-28T15:32:18Z", "creator": "apache@gagravarr.org", "bug_id": 56200, "attachment_id": null}, {"count": 4, "tags": [], "creator": "ktrykid@hotmail.com", "attachment_id": null, "is_private": false, "id": 173547, "time": "2014-02-28T15:48:46Z", "bug_id": 56200, "creation_time": "2014-02-28T15:48:46Z", "text": "I'm pretty sure.  I've executed it different ways to isolate the cause.  I created executable JARs and that's where I first noticed the difference but I recreated it when I changed the JRE Library in Eclipse."}, {"count": 5, "text": "Confirmed.  Just added those lines and ran it with both JREs.  POI Jar paths are the same.  Results are different.", "creator": "ktrykid@hotmail.com", "is_private": false, "id": 173548, "time": "2014-02-28T15:55:41Z", "bug_id": 56200, "creation_time": "2014-02-28T15:55:41Z", "tags": [], "attachment_id": null}, {"count": 6, "tags": [], "creator": "ktrykid@hotmail.com", "text": "Here's the differences in the sheet1.xml files that I unzipped.\n\nJRE 1.6\n<cols>\n<col min=\"1\" max=\"1\" width=\"8.7265625\" customWidth=\"true\" bestFit=\"true\"/>\n<col min=\"2\" max=\"2\" width=\"13.703125\" customWidth=\"true\" bestFit=\"true\"/>\n<col min=\"3\" max=\"3\" width=\"20.859375\" customWidth=\"true\" bestFit=\"true\"/>\n</cols>\n\nJRE 1.7\n<cols>\n<col min=\"1\" max=\"1\" width=\"0.0\" customWidth=\"true\" bestFit=\"true\"/>\n<col min=\"2\" max=\"2\" width=\"0.0\" customWidth=\"true\" bestFit=\"true\"/>\n<col min=\"3\" max=\"3\" width=\"0.0\" customWidth=\"true\" bestFit=\"true\"/>\n</cols>", "id": 173550, "time": "2014-02-28T16:08:14Z", "bug_id": 56200, "creation_time": "2014-02-28T16:08:14Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "creator": "apache@gagravarr.org", "text": "Can you check what fonts both JVMs can see? (AWT should let you check the fonts installed + available to the JVM). I wonder if the 1.7 JVM is either missing a key font, or has a broken font file?", "id": 173551, "time": "2014-02-28T16:14:06Z", "bug_id": 56200, "creation_time": "2014-02-28T16:14:06Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 56200, "text": "Getting a list of the available Fonts appears identical in both JVMs.", "id": 173556, "time": "2014-02-28T18:08:28Z", "creator": "ktrykid@hotmail.com", "creation_time": "2014-02-28T18:08:28Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "creator": "ktrykid@hotmail.com", "is_private": false, "text": "I do believe it is Font related though.  I changed to cell_normal style to set the Font to \"Consolas\" and it formats it as desired.  Leaving it set to the default Font (which is \"Calibri\") seems to be the root of the problem.", "id": 173558, "time": "2014-02-28T20:36:34Z", "bug_id": 56200, "creation_time": "2014-02-28T20:36:34Z", "attachment_id": null}, {"count": 10, "tags": [], "creator": "awm@mbcli.com", "text": "autoSizeColumn has been causing issues with JAVA 7 since the very release of 1.7.0.  For some reason I remember you (Nick) saying that you had narrowed it down to a bug in Java libs.  I may have to go back to the archives and see if I can find that thread.", "id": 173569, "time": "2014-03-02T01:31:54Z", "bug_id": 56200, "creation_time": "2014-03-02T01:31:54Z", "is_private": false, "attachment_id": null}, {"count": 11, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "As mentioned on list, if someone could write a very small unit test based on that, which works on 6 but fails on 7, that'd be very helpful!\n\nPerhaps something that does:\n * new workbook\n * create some cells\n * sets some styles, fonts etc\n * autosizes two columns\n * saves\n * loads\n * checks column widths\n * asserts that simple columns are right (6 and 7 ok?)\n * asserts that some more complex ones are too (fails on 7?)\n\nThe simpler and more standalone it is, the better the chances someone will be able to reproduce + investigate + fix!", "id": 173680, "time": "2014-03-07T06:32:36Z", "bug_id": 56200, "creation_time": "2014-03-07T06:32:36Z", "is_private": false}, {"count": 12, "tags": [], "creator": "ole.tjensvold.johannessen@gmail.com", "attachment_id": null, "text": "https://bugs.openjdk.java.net/browse/JDK-8013716\n\ntry to upgrade your JDK", "id": 173789, "time": "2014-03-13T10:24:07Z", "bug_id": 56200, "creation_time": "2014-03-13T10:24:07Z", "is_private": false}, {"count": 13, "text": "Updating to 1.7.51 seems to resolve this issue.", "creator": "ktrykid@hotmail.com", "is_private": false, "id": 174328, "time": "2014-04-07T14:49:54Z", "bug_id": 56200, "creation_time": "2014-04-07T14:49:54Z", "tags": [], "attachment_id": null}]