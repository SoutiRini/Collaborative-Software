[{"count": 0, "tags": [], "bug_id": 50299, "is_private": false, "text": "java.lang.NullPointerException\n\tat org.apache.poi.xssf.model.ThemesTable.getThemeColor(ThemesTable.java:54)\n\tat org.apache.poi.xssf.usermodel.XSSFCellStyle.extractColorFromTheme(XSSFCellStyle.java:1454)\n\tat org.apache.poi.xssf.usermodel.XSSFCellStyle.getFillForegroundXSSFColor(XSSFCellStyle.java:481)\n\tat org.bbreak.excella.reports.ReportsTestUtil.getCellStyleString(ReportsTestUtil.java:593)", "id": 141819, "time": "2010-11-19T04:12:34Z", "creator": "yokoi@bbreak.co.jp", "creation_time": "2010-11-19T04:12:34Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "is_private": false, "id": 141825, "time": "2010-11-19T08:37:47Z", "bug_id": 50299, "creation_time": "2010-11-19T08:37:47Z", "text": "Please post the complete Java code to reproduce the problem. If your code\nrequires an .xls template then upload it too.\n\nYegor"}, {"count": 2, "tags": [], "creator": "yokoi@bbreak.co.jp", "attachment_id": 26317, "id": 141826, "time": "2010-11-19T09:14:41Z", "bug_id": 50299, "creation_time": "2010-11-19T09:14:41Z", "is_private": false, "text": "Created attachment 26317\nerror xlsx file"}, {"count": 3, "tags": [], "text": "Created attachment 26318\nerror java code", "attachment_id": 26318, "bug_id": 50299, "id": 141827, "time": "2010-11-19T09:15:16Z", "creator": "yokoi@bbreak.co.jp", "creation_time": "2010-11-19T09:15:16Z", "is_private": false}, {"count": 4, "text": "XSSFCellStyle.getFillForegroundXSSFColor() throws NPE when the cell background color is set from two first columns of the theme color palette (ie tints of white and black colors). \u0421TColor.getSrgbClr() in getThemeColor(int) method returns null for these colors. It's necessary return CTColor.getSysClr().getLastClr() in such cases.", "bug_id": 50299, "is_private": false, "id": 144305, "time": "2011-02-15T09:43:25Z", "creator": "andrei.astrouski@gmail.com", "creation_time": "2011-02-15T09:43:25Z", "tags": [], "attachment_id": null}, {"count": 5, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "is_private": false, "id": 144315, "time": "2011-02-15T11:49:27Z", "bug_id": 50299, "creation_time": "2011-02-15T11:49:27Z", "text": "Any chance you could work up a patch + unit test based on your findings?"}, {"count": 6, "tags": [], "bug_id": 50299, "attachment_id": 26665, "id": 144342, "time": "2011-02-16T07:09:56Z", "creator": "andrei.astrouski@gmail.com", "creation_time": "2011-02-16T07:09:56Z", "is_private": false, "text": "Created attachment 26665\nPatch"}, {"count": 7, "tags": [], "bug_id": 50299, "attachment_id": null, "id": 144411, "time": "2011-02-18T11:44:43Z", "creator": "apache@gagravarr.org", "creation_time": "2011-02-18T11:44:43Z", "is_private": false, "text": "Thanks for the patch and test\n\nI've applied the patch to svn in r1072053, and added the unit test too.\n\nHowever, one thing I'm not sure on is the values coming back. I added one extra bit to the test, which was to check the whites and blacks in the first sheet. They're coming back apparent the same though...\n\nAny chance you could take a look at the test in xssf.usermodel.TestBugs and see if you can spot why we're not seeing different values?"}, {"count": 8, "tags": [], "bug_id": 50299, "is_private": false, "text": "White and black colors are theme colors, not indexed, and getFillForegroundColor() method returns 0 (index) (as for all theme colors). And getFillBackgroundColor() returns 64 (default AUTOMATIC color index) for theme colors. So, it's not a bug.", "id": 144456, "time": "2011-02-21T13:00:44Z", "creator": "andrei.astrouski@gmail.com", "creation_time": "2011-02-21T13:00:44Z", "attachment_id": null}, {"count": 9, "tags": [], "creator": "andrei.astrouski@gmail.com", "text": "I found another problem - instead of pure white, Excel returns the black, and for black - white.\n\nSee fix patch in attachment.\n\nI also removed the Alpha for indexed colors from getRgb() as unnecessary (ctColor.getRgb() returns rgb only).", "id": 144457, "time": "2011-02-21T13:13:30Z", "bug_id": 50299, "creation_time": "2011-02-21T13:13:30Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "text": "Created attachment 26688\nXSSFColor patch", "attachment_id": 26688, "bug_id": 50299, "id": 144458, "time": "2011-02-21T13:14:48Z", "creator": "andrei.astrouski@gmail.com", "creation_time": "2011-02-21T13:14:48Z", "is_private": false}, {"count": 11, "tags": [], "creator": "apache@gagravarr.org", "text": "One snag - ctColor.getRGB() almost always returns 4 values, including the Alpha. It's only theme colours where you only get the 3, and in most cases one your construct yourself\n\nAfter trying a few things, the safest thing seemed to be to offer two methods, one which returns the RGB and one that returns ARGB (assuming that if it wasn't given, then the alpha if 0xFF). Hopefully that does the right thing?", "id": 144556, "attachment_id": null, "bug_id": 50299, "creation_time": "2011-02-25T16:22:12Z", "time": "2011-02-25T16:22:12Z", "is_private": false}, {"count": 12, "tags": [], "creator": "andrei.astrouski@gmail.com", "attachment_id": null, "is_private": false, "id": 144611, "time": "2011-02-28T10:15:09Z", "bug_id": 50299, "creation_time": "2011-02-28T10:15:09Z", "text": "I think this is a good solution"}]