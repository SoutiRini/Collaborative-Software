[{"count": 0, "tags": [], "creator": "matthew.knl@gmail.com", "attachment_id": null, "text": "I run following codes cannot get the cell formula from attached excel file.\n\nSheet sheet = wb.getSheet(\"Test\");\nfor(int i=1; i <= sheet.getLastRowNum(); i++)\n{\n\tRow row = sheet.getRow(i);\n\tCell cell = row.getCell(2);\n\tString formula = cell.getCellFormula();\n\tSystem.(\"formula: \" + formula);\n}\n\n--\nIt throws \"Not implemented yet\" exception, I know it means POI project team is working on it. But the formula of first row of the formula cells can be retrieved, is it possible I can get the other cell formula as well? I don't need to evaluate the formula, just the formula string is enough.\n\n\njava.lang.RuntimeException: Not implemented yet\n\tat org.apache.poi.xssf.usermodel.XSSFEvaluationWorkbook.getNameXPtg(XSSFEvaluationWorkbook.java:92)\n\tat org.apache.poi.ss.formula.FormulaParser.function(FormulaParser.java:541)\n\tat org.apache.poi.ss.formula.FormulaParser.parseFunctionReferenceOrName(FormulaParser.java:323)\n\tat org.apache.poi.ss.formula.FormulaParser.parseSimpleFactor(FormulaParser.java:724)\n\tat org.apache.poi.ss.formula.FormulaParser.percentFactor(FormulaParser.java:684)\n\tat org.apache.poi.ss.formula.FormulaParser.powerFactor(FormulaParser.java:671)\n\tat org.apache.poi.ss.formula.FormulaParser.Term(FormulaParser.java:973)\n\tat org.apache.poi.ss.formula.FormulaParser.additiveExpression(FormulaParser.java:1074)\n\tat org.apache.poi.ss.formula.FormulaParser.concatExpression(FormulaParser.java:1058)\n\tat org.apache.poi.ss.formula.FormulaParser.comparisonExpression(FormulaParser.java:1015)\n\tat org.apache.poi.ss.formula.FormulaParser.unionExpression(FormulaParser.java:994)\n\tat org.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:1116)\n\tat org.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:191)\n\tat org.apache.poi.xssf.usermodel.XSSFCell.convertSharedFormula(XSSFCell.java:352)\n\tat org.apache.poi.xssf.usermodel.XSSFCell.getCellFormula(XSSFCell.java:332)\n\tat com.dttn.excel.connector.TestPOI.printCellFormula(TestPOI.java:96)\n\tat com.dttn.excel.connector.TestPOI.main(TestPOI.java:71)\n\n--\n\nThanks!", "id": 124077, "time": "2009-01-15T00:42:02Z", "bug_id": 46537, "creation_time": "2009-01-15T00:42:02Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 46537, "text": "Created attachment 23128\nexcel file", "id": 124078, "time": "2009-01-15T00:42:34Z", "creator": "matthew.knl@gmail.com", "creation_time": "2009-01-15T00:42:34Z", "is_private": false, "attachment_id": 23128}, {"count": 2, "tags": [], "bug_id": 46537, "text": "What's the formula in that cell?\n\n(There's something odd about that formula which means xssf can't process it, but someone like Josh will need to know what the formula is to figure out how hard it'd be to implement)", "id": 124084, "time": "2009-01-15T03:23:37Z", "creator": "apache@gagravarr.org", "creation_time": "2009-01-15T03:23:37Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 46537, "attachment_id": null, "id": 124090, "time": "2009-01-15T05:52:27Z", "creator": "yegor@dinom.ru", "creation_time": "2009-01-15T05:52:27Z", "is_private": false, "text": "The sheet contains a shared formula with a user-defined VBA function. \n\nIn short, shared formula is a template. Excel stores it in the first cell of a group of cells, other cells just substitute column and row references as appropriate. \n\nIn your example the shared formula is used as follows:\n\nconcatstring(D2:M2) //the template formula is in C2\n\nconcatstring(D3:M3) //C3 does not contain a formula, instead it takes the shared formula from above and sets rownum=3\nconcatstring(D4:M4) //the same but for rownum=4\n....\n\nTo process shared formulas POI needs to parse them, update cell area arguments and convert the parsed expression back to String.  POI can do that for formulas with built-in Excel functions but not for custom VBA functions.\n\nRegards,\nYegor"}, {"count": 4, "tags": [], "creator": "matthew.knl@gmail.com", "attachment_id": null, "is_private": false, "id": 124111, "time": "2009-01-15T18:24:48Z", "bug_id": 46537, "creation_time": "2009-01-15T18:24:48Z", "text": "Is it later POI will support getting custom VBA function name? (no need to evaluate the formula result, just get the formula string only)\n"}, {"count": 5, "tags": [], "bug_id": 46537, "text": "(In reply to comment #4)\n> Is it later POI will support getting custom VBA function name? (no need to\n> evaluate the formula result, just get the formula string only)\n> \n\nI think yes, it will eventually, but I'm not sure how soon.\n\nYegor", "id": 124115, "time": "2009-01-15T23:06:51Z", "creator": "yegor@dinom.ru", "creation_time": "2009-01-15T23:06:51Z", "is_private": false, "attachment_id": null}]