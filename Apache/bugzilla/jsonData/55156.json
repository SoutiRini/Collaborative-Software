[{"count": 0, "tags": [], "creator": "greg.martyn@gmail.com", "attachment_id": null, "id": 168125, "time": "2013-06-28T20:02:56Z", "bug_id": 55156, "creation_time": "2013-06-28T20:02:56Z", "is_private": false, "text": "I'm using mod_cache's CacheQuickHandler.\n\nMy response header has \"Cache-Control: max-age=0, s-maxage=86400, public\", but my log shows \"Expires header already expired; not cacheable\". S-maxage should be overriding the expires header. (and the max-age cache-control directive)\n\nFull response headers:\nHTTP/1.1 200 OK\nDate: Fri, 28 Jun 2013 19:57:23 GMT\nServer: Apache/2.4.4 (Unix) OpenSSL/1.0.1e PHP/5.5.0\nX-Frame-Options: SAMEORIGIN\nX-Powered-By: PHP/5.5.0\nCache-Control: max-age=0, s-maxage=86400, public\nExpires: Fri, 28 Jun 2013 19:57:23 GMT\nVary: Accept-Encoding\nStrict-Transport-Security: max-age=16070400\nX-Cache: MISS from theshadestore.com\nTransfer-Encoding: chunked\nContent-Type: application/json"}, {"count": 1, "tags": [], "creator": "greg.martyn@gmail.com", "attachment_id": null, "text": "Someone else noticed this a while ago, but I don't see any open bug reports for it:\n\nhttps://mail-archives.apache.org/mod_mbox/httpd-users/200909.mbox/%3C4A9EB6E1.2080704@googlemail.com%3E", "id": 168126, "time": "2013-06-28T20:07:22Z", "bug_id": 55156, "creation_time": "2013-06-28T20:07:22Z", "is_private": false}, {"count": 2, "text": "Not tested, this just pretends Expires and max-age are not there if s-maxage is.\n\nhttp://people.apache.org/~covener/patches/PR55156.diff", "bug_id": 55156, "is_private": false, "id": 168127, "time": "2013-06-28T20:52:45Z", "creator": "covener@gmail.com", "creation_time": "2013-06-28T20:52:45Z", "tags": [], "attachment_id": null}, {"count": 3, "tags": [], "creator": "minfrin@sharp.fm", "attachment_id": null, "id": 168141, "time": "2013-06-30T12:21:48Z", "bug_id": 55156, "creation_time": "2013-06-30T12:21:48Z", "is_private": false, "text": "There has recently been a significant amount of work fixing RFC violations highlighted by the CoAdvisor test suite, I suspect this may already have been fixed:\n\nhttps://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.x/CHANGES\n\nWould it be possible to test v2.4.5-dev (failing that, trunk) and check whether it still shows this problem?"}, {"count": 4, "tags": [], "creator": "greg.martyn@gmail.com", "attachment_id": null, "id": 168212, "time": "2013-07-02T00:29:09Z", "bug_id": 55156, "creation_time": "2013-07-02T00:29:09Z", "is_private": false, "text": "I had some luck with Eric's patch, but that seemed to stop working once the cache was cleared. I was unable to get 2.4.x or trunk to return a cache hit."}, {"count": 5, "tags": [], "bug_id": 55156, "attachment_id": null, "is_private": false, "id": 168213, "time": "2013-07-02T00:31:23Z", "creator": "greg.martyn@gmail.com", "creation_time": "2013-07-02T00:31:23Z", "text": "After clearing the cache when using Eric's patch, it went back to \"Expires header already expired; not cacheable\". Before that it was reporting cache hits."}, {"count": 6, "tags": [], "creator": "greg.martyn@gmail.com", "attachment_id": 30518, "text": "Created attachment 30518\nDon't check the expiration time if the expiration header isn't set\n\nDon't validate the expiration time if the expiration header isn't set\n\nI also chose to set control.max_age_value to control.s_maxage_value (instead of 0) because the spec describes s-maxage as simply overriding max-age.", "id": 168214, "time": "2013-07-02T01:35:53Z", "bug_id": 55156, "creation_time": "2013-07-02T01:35:53Z", "is_private": false}, {"count": 7, "text": "I recently \"re-discovered\" this issue, here is what I had in my sandbox when I came to bugzilla:\n\nhttp://people.apache.org/~covener/patches/trunk-cache-smaxage_and_etag.diff\n\nThis hides looking at Expires when s-maxage or smaxage were set, and uses s-maxage over maxage when calculating the internal expiration time.", "bug_id": 55156, "is_private": false, "id": 186842, "time": "2015-12-07T23:30:58Z", "creator": "covener@gmail.com", "creation_time": "2015-12-07T23:30:58Z", "tags": [], "attachment_id": null}]