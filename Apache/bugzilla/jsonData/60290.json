[{"count": 0, "tags": [], "bug_id": 60290, "attachment_id": null, "is_private": false, "id": 194618, "time": "2016-10-21T12:17:02Z", "creator": "1983-01-06@gmx.net", "creation_time": "2016-10-21T12:17:02Z", "text": "Note: I have selected HP-UX because my problem is on HP-UX but this is probably the case on all Unix platforms with different compilers.\n\nMy configuration:\n\ntcnative 1.2.10:\n$ uname -a\nHP-UX blnn724x B.11.31 U ia64 HP-UX\n$ export CC=/opt/aCC/bin/aCC\n$ $CC --version\naCC: HP C/aC++ B3910B A.06.25.01 [May 17 2010]\n\n$ ./build/buildcheck.sh\nbuildconf: checking installation...\nbuildconf: python version 2.7.12 (ok)\nbuildconf: autoconf version 2.69 (ok)\nbuildconf: libtool version 2.4.6 (ok)\n\n$ /usr/local/apr/bin/apr-1-config --version\n1.5.1\n\n$./configure --with-ssl=/opt/openssl --with-apr=/usr/local/apr --with-java-home=/opt/java8 --prefix=/tmp/tcnative --libdir=/tmp/tcnative/lib/hpux32\n\n$ gmake\ngmake[1]: Entering directory '/tmp/tomcat-native-1.2.10-src/native'\n/bin/sh /usr/local/apr/build-1/libtool --silent --mode=compile cc -Ae +Z -mt  -O -I/usr/local/include -I/usr/contrib/X11R6/include -DHAVE_CONFIG_H  -DHPUX11 -D_REENTRANT -D_HPUX_SOURCE -D_LARGEFILE64_SOURCE  -O -I/usr/local/include -I/usr/contrib/X11R6/include -g -DHAVE_OPENSSL -I/tmp/tomcat-native-1.2.10-src/native/include -I/opt/java8/include -I/opt/java8/include/hpux -I/opt/openssl/include  -I/usr/local/apr/include/apr-1   -o src/address.lo -c src/address.c && touch src/address.lo\n(Bundled) cc: warning 922: \"-Ae\" is unsupported in the bundled compiler, ignored.\n(Bundled) cc: warning 922: \"-O\" is unsupported in the bundled compiler, ignored.\n(Bundled) cc: warning 922: \"-O\" is unsupported in the bundled compiler, ignored.\n(Bundled) cc: warning 922: \"-g\" is unsupported in the bundled compiler, ignored.\n/bin/sh /usr/local/apr/build-1/libtool --silent --mode=compile cc -Ae +Z -mt  -O -I/usr/local/include -I/usr/contrib/X11R6/include -DHAVE_CONFIG_H  -DHPUX11 -D_REENTRANT -D_HPUX_SOURCE -D_LARGEFILE64_SOURCE  -O -I/usr/local/include -I/usr/contrib/X11R6/include -g -DHAVE_OPENSSL -I/tmp/tomcat-native-1.2.10-src/native/include -I/opt/java8/include -I/opt/java8/include/hpux -I/opt/openssl/include  -I/usr/local/apr/include/apr-1   -o src/bb.lo -c src/bb.c && touch src/bb.lo\n(Bundled) cc: warning 922: \"-Ae\" is unsupported in the bundled compiler, ignored.\n(Bundled) cc: warning 922: \"-O\" is unsupported in the bundled compiler, ignored.\n(Bundled) cc: warning 922: \"-O\" is unsupported in the bundled compiler, ignored.\n(Bundled) cc: warning 922: \"-g\" is unsupported in the bundled compiler, ignored.\ned) cc: warning 922: \"-g\" is unsupported in the bundled compiler, ignored.\n...\n\nAs you can see, my CC is completely ignored and cc (bundled) is used by default. APR has been obtained from the HP-UX Porting Archive [1].\nThe reason for this is the apr-rules.mk copied to build/rules.mk which has CC=cc statically set defeats the CC set for configure.\n\nA possible fix is to store CC in CC_OLD, run AC_SUBST(INCLUDE_RULES) and compare both variables. Similar to APR_SETIFNULL.\n\n\n[1] http://hpux.connect.org.uk/hppd/hpux/Development/Libraries/apr-1.5.2/"}, {"count": 1, "tags": [], "bug_id": 60290, "attachment_id": null, "is_private": false, "id": 194650, "time": "2016-10-24T13:03:15Z", "creator": "1983-01-06@gmx.net", "creation_time": "2016-10-24T13:03:15Z", "text": "After further investigation this must be handled in Makefile.in. A simple fix:\n\nIndex: Makefile.in\n===================================================================\n--- Makefile.in (Revision 1766400)\n+++ Makefile.in (Arbeitskopie)\n@@ -21,6 +21,7 @@\n\n CFLAGS = @CFLAGS@\n CPPFLAGS = @CPPFLAGS@\n+CC_OLD = @CC@\n\n # gets substituted into some targets\n TCNATIVE_MAJOR_VERSION=@TCNATIVE_MAJOR_VERSION@\n@@ -47,6 +48,10 @@\n @INCLUDE_RULES@\n @INCLUDE_OUTPUTS@\n\n+ifneq ($(CC_OLD),$(CC))\n+       CC=$(CC_OLD)\n+endif\n+\n LINK          = $(LIBTOOL) $(LTFLAGS) --mode=link $(LT_LDFLAGS) $(COMPILE) -version-info $(TCNATIVE_LIBTOOL_VERSION) $(ALL_LDFLAGS) -o $@\n CLEAN_SUBDIRS = test"}, {"count": 2, "tags": [], "bug_id": 60290, "attachment_id": null, "is_private": false, "id": 200427, "time": "2017-08-23T17:45:42Z", "creator": "markt@apache.org", "creation_time": "2017-08-23T17:45:42Z", "text": "Thanks for the patch. This has been fixed for 1.2.13 onwards."}]