[{"count": 0, "tags": [], "bug_id": 13978, "text": "OOTB Tomcat 4.1.13 fails to start correctly with Xerces 2.2.0. There is some \nsort of XML parsing exception down deep in the Admin webapp's use of Struts. \nThe error does not happen when using Xerces 2.1.0.\n\n-----------------\n\nOct 25, 2002 9:46:07 AM org.apache.commons.modeler.Registry loadRegistry\nINFO: Loading registry information\nOct 25, 2002 9:46:07 AM org.apache.commons.modeler.Registry getRegistry\nINFO: Creating new Registry instance\nOct 25, 2002 9:46:07 AM org.apache.commons.modeler.Registry getServer\nINFO: Creating MBeanServer\nOct 25, 2002 9:46:08 AM org.apache.coyote.http11.Http11Protocol init\nINFO: Initializing Coyote HTTP/1.1 on port 8080\nStarting service Tomcat-Standalone\nApache Tomcat/4.1.13-LE-jdk14\nParse Fatal Error at line 551 column 44: The string \"--\" is not permitted \nwithin comments.\norg.xml.sax.SAXParseException: The string \"--\" is not permitted within comments.\n        at org.apache.xerces.util.ErrorHandlerWrapper.createSAXParseException\n(Unknown Source)\n        at org.apache.xerces.util.ErrorHandlerWrapper.fatalError(Unknown Source)\n        at org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)\n        at org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)\n        at org.apache.xerces.impl.XMLScanner.reportFatalError(Unknown Source)\n        at org.apache.xerces.impl.XMLScanner.scanComment(Unknown Source)\n        at org.apache.xerces.impl.XMLDTDScannerImpl.scanComment(Unknown Source)\n        at org.apache.xerces.impl.XMLDTDScannerImpl.scanDecls(Unknown Source)\n        at org.apache.xerces.impl.XMLDTDScannerImpl.scanDTDExternalSubset\n(Unknown Source)\n        at org.apache.xerces.impl.XMLDocumentScannerImpl$DTDDispatcher.dispatch\n(Unknown Source)\n        at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument\n(Unknown Source)\n        at org.apache.xerces.parsers.DTDConfiguration.parse(Unknown Source)\n        at org.apache.xerces.parsers.DTDConfiguration.parse(Unknown Source)\n        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\n        at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)\n        at javax.xml.parsers.SAXParser.parse(Unknown Source)\n        at javax.xml.parsers.SAXParser.parse(Unknown Source)\n        at org.apache.struts.digester.Digester.parse(Digester.java:755)\n        at org.apache.struts.action.ActionServlet.initServlet\n(ActionServlet.java:1434)\n        at org.apache.struts.action.ActionServlet.init(ActionServlet.java:474)\n        at org.apache.webapp.admin.ApplicationServlet.init\n(ApplicationServlet.java:152)\n        at javax.servlet.GenericServlet.init(GenericServlet.java:256)\n        at org.apache.catalina.core.StandardWrapper.loadServlet\n(StandardWrapper.java:934)\n        at org.apache.catalina.core.StandardWrapper.load\n(StandardWrapper.java:821)\n        at org.apache.catalina.core.StandardContext.loadOnStartup\n(StandardContext.java:3420)\n        at org.apache.catalina.core.StandardContext.start\n(StandardContext.java:3608)\n        at org.apache.catalina.core.ContainerBase.addChildInternal\n(ContainerBase.java:821)\n        at org.apache.catalina.core.ContainerBase.addChild\n(ContainerBase.java:807)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:579)\n        at org.apache.catalina.core.StandardHostDeployer.addChild\n(StandardHostDeployer.java:529)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke\n(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:324)\n        at org.apache.commons.beanutils.MethodUtils.invokeMethod\n(MethodUtils.java:228)\n        at org.apache.commons.digester.SetNextRule.end(SetNextRule.java:260)\n        at org.apache.commons.digester.Digester.endElement(Digester.java:1036)\n        at org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown \nSource)\n        at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanEndElement\n(Unknown Source)\n        at \norg.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.\ndispatch(Unknown Source)\n        at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument\n(Unknown Source)\n        at org.apache.xerces.parsers.DTDConfiguration.parse(Unknown Source)\n        at org.apache.xerces.parsers.DTDConfiguration.parse(Unknown Source)\n        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\n        at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)\n        at org.apache.commons.digester.Digester.parse(Digester.java:1514)\n        at org.apache.catalina.core.StandardHostDeployer.install\n(StandardHostDeployer.java:335)\n        at org.apache.catalina.core.StandardHost.install(StandardHost.java:803)\n        at org.apache.catalina.startup.HostConfig.deployDescriptors\n(HostConfig.java:452)\n        at org.apache.catalina.startup.HostConfig.deployApps\n(HostConfig.java:409)\n        at org.apache.catalina.startup.HostConfig.start(HostConfig.java:879)\n        at org.apache.catalina.startup.HostConfig.lifecycleEvent\n(HostConfig.java:368)\n        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent\n(LifecycleSupport.java:166)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1196)\n        at org.apache.catalina.core.StandardHost.start(StandardHost.java:738)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1188)\n        at org.apache.catalina.core.StandardEngine.start\n(StandardEngine.java:347)\n        at org.apache.catalina.core.StandardService.start\n(StandardService.java:497)\n        at org.apache.catalina.core.StandardServer.start\n(StandardServer.java:2189)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:512)\n        at org.apache.catalina.startup.Catalina.execute(Catalina.java:400)\n        at org.apache.catalina.startup.Catalina.process(Catalina.java:180)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke\n(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:324)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:203)\nOct 25, 2002 9:46:10 AM org.apache.coyote.http11.Http11Protocol start\nINFO: Starting Coyote HTTP/1.1 on port 8080\nOct 25, 2002 9:46:10 AM org.apache.jk.common.ChannelSocket init\nINFO: JK2: ajp13 listening on tcp port 8009\nOct 25, 2002 9:46:11 AM org.apache.jk.server.JkMain start\nINFO: Jk running ID=0 time=0/31  config=C:\\Program Files\\Apache Group\\Tomcat 4.1\n\\conf\\jk2.properties", "id": 25198, "time": "2002-10-25T15:54:34Z", "creator": "lkarpel@eloquent.com", "creation_time": "2002-10-25T15:54:34Z", "is_private": false, "attachment_id": null}, {"text": "It's a known problem with xerces 2.2.0 and struts 1.0.2 DTD.\nYou should use struts 1.1beta2 instead or stay with xerces 2.1.0.", "tags": [], "bug_id": 13978, "attachment_id": null, "count": 1, "id": 25199, "time": "2002-10-25T16:02:13Z", "creator": "hgomez@apache.org", "creation_time": "2002-10-25T16:02:13Z", "is_private": false}, {"count": 2, "tags": [], "creator": "lkarpel@eloquent.com", "attachment_id": null, "is_private": false, "id": 25200, "time": "2002-10-25T16:12:13Z", "bug_id": 13978, "creation_time": "2002-10-25T16:12:13Z", "text": "Henri ..\n\nI dont understand .. I dont 'use' Struts .. the admin webapp application \nshipped with Tomcat 4.1.13 does ..\n\nThis is a Tomcat 4.1.13 problem .. it ships Struts !\n\n\nAre you saying that Tomcat 4.1.13 does not support Xerces 2.2.0 .. if that is \nthe case shouldnt the Admin webapp package its own Xerces version for itself to \nuse ?"}, {"count": 3, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "is_private": false, "id": 25201, "time": "2002-10-25T16:20:37Z", "bug_id": 13978, "creation_time": "2002-10-25T16:20:37Z", "text": "No, sorry. Xerces 2.2 is broken."}, {"count": 4, "tags": [], "bug_id": 13978, "attachment_id": null, "id": 25203, "time": "2002-10-25T17:18:49Z", "creator": "lkarpel@eloquent.com", "creation_time": "2002-10-25T17:18:49Z", "is_private": false, "text": "Pretty terse reponse.\n\nCould you explain how it is broken? Could you point me to the bug report you \nhave filed? Do you know what the Xerces response to the issue will be?"}, {"count": 5, "tags": [], "creator": "jfarcand@apache.org", "attachment_id": null, "text": "We don't know yet why Xerces 2.2 is broken. There is a thread problems that\ncause the exception you are seeing.\n\n", "id": 25208, "time": "2002-10-25T22:07:56Z", "bug_id": 13978, "creation_time": "2002-10-25T22:07:56Z", "is_private": false}, {"count": 6, "tags": [], "creator": "jfarcand@apache.org", "attachment_id": null, "text": "Under ${catalina_home}/server/webapps/admin/WEB-INF/lib, replace struts.jar with\nthe version 1.1beta 2. This is only a workaround. You should use 2.1....", "id": 25211, "time": "2002-10-25T22:24:01Z", "bug_id": 13978, "creation_time": "2002-10-25T22:24:01Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 13978, "is_private": false, "text": "So .. are you saying that Struts 1.1beta 2 fixes a threading problem in Xerces \n2.2 .. am I missing something ?\n\nIs there anything in the release notes that says we shouldn't be using Xerces \n2.2 .. or should the Tomcat release be including the Struts beta version ?", "id": 25212, "time": "2002-10-25T22:39:16Z", "creator": "lkarpel@eloquent.com", "creation_time": "2002-10-25T22:39:16Z", "attachment_id": null}, {"text": "Yes, at least on my side, the thread problem does not occurs all the time. BUT I\nstill recommend you use Xerces 2.1.\n\nI'm currently working with the Xerces team and as you may be aware, thread\nproblem are difficult to solve. That's why it's taking time....\n\nUntil we know exactly what is the problem, there is no decision on which Strut\nversion we should include etc.", "tags": [], "bug_id": 13978, "attachment_id": null, "count": 8, "id": 25272, "time": "2002-10-28T15:09:18Z", "creator": "jfarcand@apache.org", "creation_time": "2002-10-28T15:09:18Z", "is_private": false}, {"count": 9, "tags": [], "creator": "lkarpel@eloquent.com", "attachment_id": null, "text": "FYI .. we use Xerces 2.2 in a highly multi-threaded environment and have no \nproblems whatsoever.", "id": 25277, "time": "2002-10-28T16:36:11Z", "bug_id": 13978, "creation_time": "2002-10-28T16:36:11Z", "is_private": false}]