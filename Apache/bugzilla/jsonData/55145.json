[{"count": 0, "tags": [], "creator": "najh.ru@gmail.com", "attachment_id": null, "text": "After executing the code\n\n    public static void main(String args[]) throws IOException {\n      //with #VALUE! error (1)\n      createExample(new FileOutputStream(\"1.xls\"), new HSSFWorkbook()); \n\n      //no error           (2)\n      createExample(new FileOutputStream(\"1.xlsx\"), new XSSFWorkbook());\n    }\n\n    private static void createExample(FileOutputStream file, Workbook wb) throws IOException {\n        Sheet sh = wb.createSheet(\"sheet\");\n        Row row = sh.createRow(0);\n        Cell cell1 = row.createCell(0);\n        cell1.setCellValue(100);\n        Cell cell2 = row.createCell(1);\n        cell2.setCellFormula(\"RANK(A1,(A1:A1),0)\");\n        wb.write(file);\n    }\n\n \nwe've got the following result for line (1)\nthe #VALUE! error in the generated excel file. \nThis error could be corrected manually if we position the cursor into the formula bar and press \"Enter\".\n\nFor line (2) there is no error.", "id": 168063, "time": "2013-06-26T10:52:26Z", "bug_id": 55145, "creation_time": "2013-06-26T10:52:26Z", "is_private": false}, {"count": 1, "tags": [], "text": "See http://poi.apache.org/spreadsheet/eval.html - you need to evaluate the formulas after setting them, to ensure the cached value is correctly set and available to excel.", "is_private": false, "id": 168064, "creation_time": "2013-06-26T10:59:19Z", "time": "2013-06-26T10:59:19Z", "creator": "apache@gagravarr.org", "bug_id": 55145, "attachment_id": null}]