[{"count": 0, "tags": [], "bug_id": 46991, "attachment_id": null, "id": 126072, "time": "2009-04-08T01:37:54Z", "creator": "huangfeng@tongtech.com", "creation_time": "2009-04-08T01:37:54Z", "is_private": false, "text": "use jk module\n\nsubmit some data with post method ,but  \"Bytes received\" always show zero\n\nsee source file ,JkCoyoteHandler.java ,in \"inovke\" method\n\n public int invoke( Msg msg, MsgContext ep )\n        throws IOException {\n        if( ep.isLogTimeEnabled() )\n            ep.setLong( MsgContext.TIMER_PRE_REQUEST, System.currentTimeMillis());\n\n        Request req=ep.getRequest();\n        Response res=req.getResponse();\n\n        if( log.isDebugEnabled() )\n            log.debug( \"Invoke \" + req + \" \" + res + \" \" + req.requestURI().toString());\n\n        res.setNote( epNote, ep );\n        ep.setStatus( MsgContext.JK_STATUS_HEAD );\n        RequestInfo rp = req.getRequestProcessor();\n        rp.setStage(Constants.STAGE_SERVICE);\n        try {\n            adapter.service( req, res );\n        } catch( Exception ex ) {\n            log.info(\"Error servicing request \" + req,ex);\n        }\n        if(ep.getStatus() != MsgContext.JK_STATUS_CLOSED) {\n            res.finish();\n        }\n      \n        req.recycle();         \n        req.updateCounters();   //see this line\n         res.recycle();\n        ep.recycle();\n        if( ep.getStatus() == MsgContext.JK_STATUS_ERROR ) {\n            return ERROR;\n        }\n        ep.setStatus( MsgContext.JK_STATUS_NEW );\n        rp.setStage(Constants.STAGE_KEEPALIVE);\n        return OK;\n    }\n\n the request object recycled,the \"byteRead\" property must be set to zero ,but at the next line ,begin to \"updateCounters\",this may be a bug"}, {"count": 1, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "text": "Thanks for the report. This has been fixed in trunk and proposed for 6.0.x", "id": 126096, "time": "2009-04-08T09:31:45Z", "bug_id": 46991, "creation_time": "2009-04-08T09:31:45Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 46991, "attachment_id": null, "text": "(In reply to comment #1)\n> Thanks for the report. This has been fixed in trunk and proposed for 6.0.x\n\nwhich version ? I use version 6.0.18,how can I get the fixed version?", "id": 126126, "time": "2009-04-08T19:10:15Z", "creator": "huangfeng@tongtech.com", "creation_time": "2009-04-08T19:10:15Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 46991, "attachment_id": null, "text": "It will probably be in 6.0.20 but that depends on a) it getting the 3 +1 votes to be back-ported and b) there being a 6.0.20 release. Given that 6.0.19 is still in progress 6.0.20 is likely to be some time away.\n\nAlternatively, you can build Tomcat from source with the patch. If you want to do that, the users list is the place to get help.", "id": 126133, "time": "2009-04-09T01:51:44Z", "creator": "markt@apache.org", "creation_time": "2009-04-09T01:51:44Z", "is_private": false}, {"count": 4, "tags": [], "text": "Thanks !", "attachment_id": null, "id": 126137, "creator": "huangfeng@tongtech.com", "time": "2009-04-09T02:11:27Z", "bug_id": 46991, "creation_time": "2009-04-09T02:11:27Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 46991, "text": "This has been fixed in 6.0.x and will be in 6.0.20 onwards.", "id": 126587, "time": "2009-04-28T06:23:35Z", "creator": "markt@apache.org", "creation_time": "2009-04-28T06:23:35Z", "is_private": false, "attachment_id": null}]