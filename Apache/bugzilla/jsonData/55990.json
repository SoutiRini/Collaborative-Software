[{"count": 0, "tags": [], "bug_id": 55990, "text": "http://svn.apache.org/viewvc?view=revision&revision=r1556102\ngoes a long way, but there is one case that it still does not fully cover:\n\nI.e., highly unexplainable why only one of the\nfollowing four work, instead of two:\n\n# while read; do cat ~jidanni/mediawiki/images/radioscanningtw/.htaccess; w3m -dump http://radioscanningtw.jidanni.org/images |grep radio.*:; echo ----------; done\n\nOrder Deny,Allow\nDeny from all\nAllow from env=!let_me_in\n[DIR]       radioscanningtw/ 2014-01-07 11:18    -\n----------\nOrder Deny,Allow\nDeny from all\nAllow from env=let_me_in\n----------\nSetEnv let_me_in 1\nOrder Deny,Allow\nDeny from all\nAllow from env=let_me_in\n----------\nSetEnv let_me_in 1\nOrder Deny,Allow\nDeny from all\nAllow from env=!let_me_in\n----------\n\nBrowsing the child directly with\nd=radioscanningtw.jidanni.org/images/radioscanningtw/; while read; do\ncat ~jidanni/$d/.htaccess; w3m -dump http://$d; echo -n ----------;\ndone\nshows the same 3/1 pattern.", "id": 172292, "attachment_id": null, "creator": "jidanni@jidanni.org", "creation_time": "2014-01-12T00:28:55Z", "time": "2014-01-12T00:28:55Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 55990, "text": "SetEnv sets variables well after authentication and access control has completed.   it is already documented as running relatively late in processing.\n\nI can't follow the 1/4 cases or 2/4 cases, but does the above explain why the results aren't as you expect?", "id": 172294, "attachment_id": null, "creator": "covener@gmail.com", "creation_time": "2014-01-12T01:19:19Z", "time": "2014-01-12T01:19:19Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 55990, "text": "Yes except for case 4.\nIn case 4 we find the startling results that SetEnv actually does get read,\nIF the following operator is \"=!\".", "id": 172310, "time": "2014-01-12T17:31:54Z", "creator": "jidanni@jidanni.org", "creation_time": "2014-01-12T17:31:54Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 55990, "attachment_id": null, "id": 172311, "time": "2014-01-12T19:39:06Z", "creator": "covener@gmail.com", "creation_time": "2014-01-12T19:39:06Z", "is_private": false, "text": "(In reply to Dan Jacobson from comment #2)\n> Yes except for case 4.\n> In case 4 we find the startling results that SetEnv actually does get read,\n> IF the following operator is \"=!\".\n\nI get the expected result, a subdirectory with:\n\n  SetEnv let_me_in\n  Order allow,deny\n  allow from env=!let_me_in\n\nDoes show up in the autoindex listing of its parent.  Same as if there was no SetEnv, and same as the more verbose deny,allow + deny from all."}, {"count": 4, "tags": [], "creator": "jidanni@jidanni.org", "attachment_id": null, "id": 172313, "time": "2014-01-12T20:38:24Z", "bug_id": 55990, "creation_time": "2014-01-12T20:38:24Z", "is_private": false, "text": "These are my results. Please test with these *exact* lines.\nNo need to look at the parent, just attempt to browse the directory itself.\nWith a .htaccess of\n\nOrder Deny,Allow\nDeny from all\nAllow from env=!let_me_in\n\nI can access its directory.\n\nNow even putting \"SetEnv let_me_in 1\" at the BOTTOM of the file,\n\nOrder Deny,Allow\nDeny from all\nAllow from env=!let_me_in\nSetEnv let_me_in 1\n\nresults in 403 Forbidden.\n\n**That proves in some cases, the SetEnv IS processed.**\n\nHowever not if we reverse the test, no matter how much we use it,\n\nSetEnv set_me_in 1\nOrder Deny,Allow\nDeny from all\nAllow from env=let_me_in\nSetEnv let_me_in 1\n\nas we already know.\n\n(Today testing with Apache 2.2.3.)"}, {"attachment_id": null, "tags": [], "bug_id": 55990, "text": "2.2.3 did not contain env=!foo. It's not mentioned in the changelog or in the compatibility support of the manual, but it looks like it was first relased in 2.2.10.\n\nWithout support for =!let_me_in this looks like an envvar named \"!let_me_in\" but I'm not even sure that fully explains your current problem.", "count": 5, "id": 172314, "time": "2014-01-12T21:04:09Z", "creator": "covener@gmail.com", "creation_time": "2014-01-12T21:04:09Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 55990, "text": "Yes, you are correct that it doesn't explain it, as I just tested with\nServer: Apache/2.4.7 (Debian)\nand got the same results! Therefore when you do figure out what is going on here, please document it (and mention where the changes can be found here)! Thanks.", "id": 172315, "time": "2014-01-12T23:53:29Z", "creator": "jidanni@jidanni.org", "creation_time": "2014-01-12T23:53:29Z", "is_private": false, "attachment_id": null}, {"count": 7, "text": "$ ${EDITOR}       abj.jidanni.org/images/abj/.htaccess\n$ HEAD -dP http://abj.jidanni.org/images/abj/\nis what I used to test.", "bug_id": 55990, "attachment_id": null, "id": 172316, "time": "2014-01-12T23:59:30Z", "creator": "jidanni@jidanni.org", "creation_time": "2014-01-12T23:59:30Z", "tags": [], "is_private": false}, {"count": 8, "text": "I see that this ticket is opened against version 2.4.7\n\nThe syntax used here (order deny,allow and so on) is deprecated in 2.4 so I'd expect that what we want to do is document the way that this is supposed to be done (See http://httpd.apache.org/docs/current/mod/mod_authz_core.html#requiredirectives ) rather than the old deprecated way.\n\nMeanwhile, I wonder if you could elaborate as to what exactly you'd like to see changed in the doc? Or is this a bug report regarding how the feature works?\n\nI'm having trouble understanding exactly what situation is happening. However, complicated scenarios, and the extremely limited nature of the Order directive, were major motivations in providing the new improved Require syntax, which makes all of this confusion a thing of the past.\n\nI'm closing this as fixed, because we've fixed it by providing better, unambiguous syntax for doing what you're trying to do here:\n\nSetEnv let_me_in\n<Directory \"/docroot\">\n    Require env let_me_in\n</Directory>", "bug_id": 55990, "attachment_id": null, "id": 182404, "time": "2015-04-15T20:18:04Z", "creator": "rbowen@apache.org", "creation_time": "2015-04-15T20:18:04Z", "tags": [], "is_private": false}, {"count": 9, "tags": [], "bug_id": 55990, "attachment_id": null, "text": "OK I'll take your word for it that this is all a thing of the past.", "id": 182504, "time": "2015-04-20T19:18:26Z", "creator": "jidanni@jidanni.org", "creation_time": "2015-04-20T19:18:26Z", "is_private": false}]