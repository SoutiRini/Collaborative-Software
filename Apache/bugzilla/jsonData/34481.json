[{"count": 0, "tags": [], "text": "I'm testing the load balancing worker. My setup is: 2 hosts running Debian Linux\n(Sarge), Debian stock install of apache2. Apache2 using prefork workers.\n\nI've got two such Linux boxes, my workers.properties is:\n\n-------------------------------------------\nworker.list=lb,status\n\nworker.status.type=status\n\nworker.node1.port=10900\nworker.node1.host=rhubarb\nworker.node1.type=ajp13\nworker.node1.disabled=true\n\nworker.node2.port=10900\nworker.node2.host=blueberry\nworker.node2.type=ajp13\n\nworker.lb.balance_workers=node1,node2\nworker.lb.type=lb\nworker.lb.sticky_session=true\n-------------------------------------------\n\nMy <VirtualHost> directive is:\n\n\n-------------------------------------------\n<VirtualHost *>\n        ServerName martin.rhubarb.salad.taglab.com\n        ServerAlias martin.rhubarb\n\n        JKMount         /*           lb\n        JKMount         /status      status\n</VirtualHost>\n------------------------------------------\n\n\n\nI start doing some requests to \"http://martin.rhubarb/test.jsp\" and it works\nfine, the test jsp prints out the session id and some trace output in the log.\nAll requests keep going to the same host. All is fine.\n\n-------------------------------------------\nI look at the http://martin.rhubarb/status page and I can see:\nnode1\tajp13\trhubarb:10900\t192.168.100.85:10900\tDisabled\t1\t1\t0\t0\t0 \t0 \t0\t \t \nnode2\tajp13\tblueberry:10900\t192.168.100.86:10900\tOK\t1\t1\t15\t0\t7.1K\t2.0K\t0\t \n-------------------------------------------\n\n\n\n\nIf I refresh the /status page too quickly (click reload before the previous page\nhas loaded), the status can often get reset:\n\n-------------------------------------------\nnode1\tajp13\trhubarb:10900\t192.168.100.85:10900\tDisabled\t1\t1\t0\t0\t 0 \t 0 \t0\t \t \nnode2\tajp13\tblueberry:10900\t192.168.100.86:10900\tOK\t1\t1\t0\t0\t0 \t0 \t0\t \t \n-------------------------------------------\n\nNot only that, but sometimes it starts showing the \"Disabled\" and \"OK\" states\ncompletely erratic reporting \"Disabled\" or \"OK\" on the wrong one. This looks\nlike a thread issue in the status worker since as far as I can tell the actual\nlb worker continues to work fine.\n\n\n\nDetails of how I installed mod_jk.so:\n\nI downloaded the source for the connectors 1.2.10. Compiled and installed it like.\n\n$ cd jk/native\n$ ./configure --with-apxs=/usr/bin/apxs2\n$ make\n$ cp apache-2.0/mod_jk.so /usr/lib/apache2/modules/", "attachment_id": null, "id": 73725, "creation_time": "2005-04-16T10:26:01Z", "time": "2005-04-16T10:26:01Z", "creator": "puckman@taglab.com", "bug_id": 34481, "is_private": false}, {"count": 1, "tags": [], "creator": "pr@objektpark.de", "attachment_id": null, "id": 73726, "time": "2005-04-16T10:34:29Z", "bug_id": 34481, "creation_time": "2005-04-16T10:34:29Z", "is_private": false, "text": "Give the --prefork-enabled flag a chance to disable all threading\ncode."}, {"text": "The --enable-prefork did not fix it, however I know noticed in the apache error log:\n\n[Sat Apr 16 09:44:39 2005] [emerg] No JkShmFile defined in httpd.conf.\nLoadBalancer will not function properly!\n\nConfiguring a global JkShmFile makes it start behave properly.", "tags": [], "creator": "puckman@taglab.com", "attachment_id": null, "count": 2, "id": 73728, "time": "2005-04-16T10:49:08Z", "bug_id": 34481, "creation_time": "2005-04-16T10:49:08Z", "is_private": false}]