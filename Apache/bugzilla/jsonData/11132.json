[{"count": 0, "tags": [], "bug_id": 11132, "is_private": false, "text": "When you generate a document with HSSF, and put in a trademark(ascii 153), \nMicrosoft Excel 2000 shows it as a tiny box(much like internet explorer).\n\nBut when you copy/paste it into ultraedit and copy/paste it back into excel, or \nsimply enter a trademark normally, it shows the Trademark just fine.\n\nSo I'm thinking this is a bug at file creation time.", "id": 20133, "time": "2002-07-24T15:27:29Z", "creator": "jorddims@hotmail.com", "creation_time": "2002-07-24T15:27:29Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 11132, "text": "\u2122 or ascii 0153 is not displayed properly in the Excel sheets I am creating \nwith POI. All that is displayed is the well known box.\n\nSo I tried the newest available version, but there were other bugs that \nhampered my work.\n\n/Thomas", "id": 20342, "time": "2002-07-29T06:52:01Z", "creator": "jorddims@hotmail.com", "creation_time": "2002-07-29T06:52:01Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "text": "There seems to be a problem when trying to read or insert Trademarks, \u2122, ascii \n0153. They only get shown as a square box, and this seems to be a bug. I tried \na couple of manual fixes, but nothing really seemed to do the trick.\n\nWhen you write or copy paste the Trademark into Excel, there are no problems, \nit is only when creating or reading with HSSF that this occurs.", "is_private": false, "bug_id": 11132, "id": 20343, "time": "2002-07-29T06:55:40Z", "creator": "jorddims@hotmail.com", "creation_time": "2002-07-29T06:55:40Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 11132, "text": "Ok, so the Comments are shown in the bottom of this page, so I didn't notice \nuntil I finished the third one. That makes me excentric, not stupid, right?", "id": 20344, "time": "2002-07-29T07:07:08Z", "creator": "jorddims@hotmail.com", "creation_time": "2002-07-29T07:07:08Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "text": "Can you do the equivilent (on your OS) of\n\"java org.apache.poi.hssf.dev.BiffViewer wrong.xls > output.foo\"\n\"java org.apache.poi.hssf.dev.BiffViewer right.xls > output2.foo\"\n\"diff output.foo output2.foo\"\n\nwhere wrong.xls = the HSSF generated file with the incorrect output\nand right.xls = the Excel generated file with the correct output.\n\nYou should do this on an otherwise blank sheet in the same cell to make the\noutput as close as possible.\n\nI suspect the characterset is different or something.\n\n-Andy\n", "is_private": false, "bug_id": 11132, "id": 20362, "time": "2002-07-29T13:41:58Z", "creator": "poi-support@buni.org", "creation_time": "2002-07-29T13:41:58Z", "attachment_id": null}, {"count": 5, "tags": [], "text": "Yeah I've done the equivalent of it with UltraEdit, and they ARE different. \nSo I tried to make a manual byte filter, where I simply write the \"correct\" \nbytes out(ServletOutputStream), but nothing helped, and I've tried alot of \nthings.\n\nSo I'm thinking something might be wrong with the cell-formatting.", "is_private": false, "bug_id": 11132, "id": 20370, "time": "2002-07-29T15:06:52Z", "creator": "jorddims@hotmail.com", "creation_time": "2002-07-29T15:06:52Z", "attachment_id": null}, {"count": 6, "tags": [], "creator": "jorddims@hotmail.com", "attachment_id": null, "text": "I've done a nasty hack now for writing the trademark, but it works.\n\nI use the following code:\n\nresponse.setContentType(\"application/vnd.ms-excel\");\nresponse.addHeader(\"Content-Disposition\", \"filename=\\\"wank.xls\\\"\");\nDataOutput output = new DataOutputStream( response.getOutputStream() );\nbyte[] bytes = buffer.toByteArray();\nresponse.setContentLength(bytes.length);\n\nwhere the buffer is a ByteArrayOutputStream, and I write bytes[] out in a for-\nloop. After looking, comparing and so on I found out that the tm is represented \nas the byte value -103.\nNormally the Hex representation(as seen in ultraedit) of a trademark is a \" \nfollowed by a !.\nA tm written with hssf is represented by a tm and a \".\".\nHere's an example from ultraedit:\n\nHSSF written:   ...99 00...\n\nEXCEL normally: ...22 21...\n\nwhat caused a great deal of confusion with me was the fact that the trademark \nis here written as hex 99(deci 153 which is the ascii value), and that 153 \ndoesn't occur in the outputstream. \n\nMaybe I'm stupid, but this is probably because I've forgotten all of my \nschooling through massive consumption of alcohol. I suppose it's because of \nbinary conversion:\n\n-103 = 01100111 (conversion)=> 10011000+1 = 10011001 = 153\n\nBut anyway, if I look at every single byte, and replace the value pattern 99 0 \nby 22 21, the tm's in EXCEL are displayed allright. I suppose all ascii \ncharacters between 129 and 159 will have this problem.\n\nIf there are questions as to what the hell I'm talking about, please don't \nhesitate to ask here, I'll get an e-mail about it... ", "id": 20397, "time": "2002-07-30T09:23:58Z", "bug_id": 11132, "creation_time": "2002-07-30T09:23:58Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 11132, "is_private": false, "text": "I've tested it and I can say for a fact that HSSF doesn't write ascii \ncharacters correctly between 129 and 159. Excel displays them in a false way.\n\nInstead of HSSF writing the hexidecimal value for e.g. 153, the value should be \nthe unicode value, e.g. not 99 00 but 22 21 for trademark.", "id": 20770, "time": "2002-08-08T06:55:30Z", "creator": "jorddims@hotmail.com", "creation_time": "2002-08-08T06:55:30Z", "attachment_id": null}, {"count": 8, "tags": [], "creator": "jorddims@hotmail.com", "attachment_id": null, "text": "Now when I substitute e.g. trademark with this value &#x2122; it works, writing \n\\u2122, which it states that you should on the POI website, does not work.\n\n/Tom", "id": 20772, "time": "2002-08-08T10:11:47Z", "bug_id": 11132, "creation_time": "2002-08-08T10:11:47Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 11132, "is_private": false, "text": "Created attachment 8328\nContains the code to read from an excel containing the map", "id": 44589, "time": "2003-09-24T14:06:41Z", "creator": "umaraja_y@yahoo.com", "creation_time": "2003-09-24T14:06:41Z", "attachment_id": 8328}, {"count": 10, "tags": [], "bug_id": 11132, "text": "the bug is resolved after 2.0-pre3. the code is working fine now.", "id": 46362, "time": "2003-10-28T09:46:01Z", "creator": "vikasmehrotra_2000@yahoo.com", "creation_time": "2003-10-28T09:46:01Z", "is_private": false, "attachment_id": null}]