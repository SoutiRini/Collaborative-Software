[{"count": 0, "tags": [], "bug_id": 53105, "attachment_id": 28640, "text": "Created attachment 28640\nSpreadsheet for use with the test case.\n\nOverview:\n\nSumming an entire row of an .xlsx gives an incorrect result.\n\nSteps to reproduce:\n\nCreate an .xlsx, fill an entire row with a value, say \"1\"\nInsert a formula to sum these cells, ie SUM(A1:XFD1)\nUsing POI, read the spreadsheet and evaluate the formula.\n\nExpected result: 16384.0.0, actual result: 256.0\n\nNB. Excel automatically rewrites the formula to:\n\nSUM(1:1)\n\nI'm not sure if this is the cause of the issue yet. The local fix applied for Bug 53101 doesn't resolve this one.\n\nExample test case:\n\nimport org.apache.poi.openxml4j.exceptions.InvalidFormatException;\nimport org.apache.poi.ss.usermodel.FormulaEvaluator;\nimport org.apache.poi.ss.usermodel.Workbook;\nimport org.apache.poi.ss.usermodel.WorkbookFactory;\nimport org.junit.Test;\n\nimport java.io.IOException;\nimport java.io.InputStream;\n\nimport static org.junit.Assert.assertEquals;\n\npublic class PoiEntireRowSumTest {\n\n  @Test\n  public void evaluateExcelAllColumnsUsingPoiApiOnly_expectCorrectEvaluation() {\n    // Arrange\n    InputStream inputStream = this.getClass().getResourceAsStream(\"/entire_row_sum_test.xlsx\");\n    Workbook workbook = null;\n    try {\n      workbook = WorkbookFactory.create(inputStream);\n    } catch (IOException e) {\n      e.printStackTrace();\n    } catch (InvalidFormatException e) {\n      e.printStackTrace();\n    } finally {\n      try {\n        inputStream.close();\n      } catch (IOException e) {\n        e.printStackTrace();\n      }\n    }\n\n    // Act\n    // evaluate SUM('Skye Lookup Input'!A4:XFD4), cells in range each contain \"1\"\n    FormulaEvaluator evaluator = workbook.getCreationHelper().createFormulaEvaluator();\n    double numericValue = evaluator.evaluate(workbook.getSheetAt(0).getRow(1).getCell(0)).getNumberValue();\n\n    // Assert\n    assertEquals(16384.0, numericValue, 0.0);\n  }\n\n}\n\nI've attached a spreadsheet for testing.", "id": 158190, "time": "2012-04-19T08:20:20Z", "creator": "malquitob@gmail.com", "creation_time": "2012-04-19T08:20:20Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 53105, "text": "Apologies once again for the typo; 16384.0.0 should read 16384.0 :embarrassed:", "count": 1, "id": 158191, "time": "2012-04-19T08:22:25Z", "creator": "malquitob@gmail.com", "creation_time": "2012-04-19T08:22:25Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 53105, "attachment_id": null, "text": "This actually works for me with the current trunk-version (3.13dev).", "id": 184948, "time": "2015-09-03T19:21:58Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-09-03T19:21:58Z", "is_private": false}]