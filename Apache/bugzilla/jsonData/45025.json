[{"count": 0, "tags": [], "bug_id": 45025, "is_private": false, "text": "When using setFormula in a HSSFCell with an inner VLOOKUP function as: \n\n    dailyCost.setCellFormula(\"VLOOKUP(\\\"\"+t.getRol()+\"\\\";'Tarifas venta personal'!$D$12:$E$30;2;false)\");\n        \nI receive the following exception:\n\norg.apache.poi.hssf.model.FormulaParser$FormulaParseException: Integer Expected\n\tat org.apache.poi.hssf.model.FormulaParser.expected(FormulaParser.java:137)\n\tat org.apache.poi.hssf.model.FormulaParser.parseNumber(FormulaParser.java:602)\n\tat org.apache.poi.hssf.model.FormulaParser.parseSimpleFactor(FormulaParser.java:569)\n\tat org.apache.poi.hssf.model.FormulaParser.percentFactor(FormulaParser.java:526)\n\tat org.apache.poi.hssf.model.FormulaParser.powerFactor(FormulaParser.java:513)\n\tat org.apache.poi.hssf.model.FormulaParser.Term(FormulaParser.java:727)\n\tat org.apache.poi.hssf.model.FormulaParser.additiveExpression(FormulaParser.java:805)\n\tat org.apache.poi.hssf.model.FormulaParser.concatExpression(FormulaParser.java:790)\n\tat org.apache.poi.hssf.model.FormulaParser.comparisonExpression(FormulaParser.java:747)\n\tat org.apache.poi.hssf.model.FormulaParser.Arguments(FormulaParser.java:503)\n\tat org.apache.poi.hssf.model.FormulaParser.function(FormulaParser.java:326)\n\tat org.apache.poi.hssf.model.FormulaParser.parseIdent(FormulaParser.java:236)\n\tat org.apache.poi.hssf.model.FormulaParser.parseSimpleFactor(FormulaParser.java:566)\n\tat org.apache.poi.hssf.model.FormulaParser.percentFactor(FormulaParser.java:526)\n\tat org.apache.poi.hssf.model.FormulaParser.powerFactor(FormulaParser.java:513)\n\tat org.apache.poi.hssf.model.FormulaParser.Term(FormulaParser.java:727)\n\tat org.apache.poi.hssf.model.FormulaParser.additiveExpression(FormulaParser.java:805)\n\tat org.apache.poi.hssf.model.FormulaParser.concatExpression(FormulaParser.java:790)\n\tat org.apache.poi.hssf.model.FormulaParser.comparisonExpression(FormulaParser.java:747)\n\tat org.apache.poi.hssf.model.FormulaParser.parse(FormulaParser.java:844)\n\tat org.apache.poi.hssf.usermodel.HSSFCell.setCellFormula(HSSFCell.java:641)\n\nThis problem doesn't happen in 3.0 final release, I'm trying to use 3.1 since I need VLOOKUP function working with a reference in the first argument instead of a literal.", "id": 116762, "time": "2008-05-17T13:12:17Z", "creator": "erudil@yahoo.com", "creation_time": "2008-05-17T13:12:17Z", "attachment_id": null}, {"count": 1, "attachment_id": null, "creator": "josh@apache.org", "text": "The main problem is use of semicolons (;) for argument separators when POI expects commas (,).  (Similar to first part of bug 45041).  I guess if comma is used as a decimal separator, something else is required to delimit arguments.  \n\nFor the moment, all POI can do is present a better error message.  Internationalization would require a big effort.\n\nI added a fix for this in svn r659455.  Now POI will give a message like:\nParse error near char 13 ';' in specified formula 'VLOOKUP(\"123\";'Tarifas venta personal'!$D$12:$E$30;2;false)'. Expected ',' or ')'\n\nAfter changing the semicolons to commas, POI seems to output a spreadsheet with a well encoded VLOOKUP formula.\n", "id": 116918, "time": "2008-05-23T00:06:33Z", "bug_id": 45025, "creation_time": "2008-05-23T00:06:33Z", "tags": [], "is_private": false}]