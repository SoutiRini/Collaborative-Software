[{"count": 0, "tags": [], "creator": "dennis@righthandmanager.com", "attachment_id": null, "text": "The attached spreadsheet has just one formula. It looks like this:\n\nD3+PriceDown\n\nwhere PriceDown is a Name. You get the following exception when using \nBiffViewer:\n\njava.lang.ArrayIndexOutOfBoundsException\n        at org.apache.poi.util.LittleEndian.getNumber(LittleEndian.java:557)\n        at org.apache.poi.util.LittleEndian.getShort(LittleEndian.java:90)\n        at org.apache.poi.hssf.record.formula.NamePtg.<init>(NamePtg.java:100)\n        at org.apache.poi.hssf.record.formula.Ptg.createPtg(Ptg.java:251)\n        at org.apache.poi.hssf.record.FormulaRecord.getParsedExpressionTokens(Fo\nrmulaRecord.java:171)\n        at org.apache.poi.hssf.record.FormulaRecord.fillFields(FormulaRecord.jav\na:147)\n        at org.apache.poi.hssf.record.Record.fillFields(Record.java:143)\n        at org.apache.poi.hssf.record.Record.<init>(Record.java:105)\n        at org.apache.poi.hssf.record.FormulaRecord.<init>(FormulaRecord.java:11\n8)\n        at org.apache.poi.hssf.dev.BiffViewer.createRecord(BiffViewer.java:550)\n        at org.apache.poi.hssf.dev.BiffViewer.createRecords(BiffViewer.java:158)\n\n        at org.apache.poi.hssf.dev.BiffViewer.run(BiffViewer.java:110)\n        at org.apache.poi.hssf.dev.BiffViewer.main(BiffViewer.java:687)\n\nIt seems to happen only when you mix non-named cell references with named ones. \nFor example, I tried formulae like C1+D1 and Name1:Name2 and they both parsed.", "id": 26114, "time": "2002-11-12T00:19:38Z", "bug_id": 14460, "creation_time": "2002-11-12T00:19:38Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 14460, "attachment_id": 3814, "id": 26115, "time": "2002-11-12T00:20:31Z", "creator": "dennis@righthandmanager.com", "creation_time": "2002-11-12T00:20:31Z", "is_private": false, "text": "Created attachment 3814\nMinimal XLS file that demonstrates the problem"}, {"count": 2, "tags": [], "bug_id": 14460, "text": "This is fixed in latest CVS, and also possibly in 2.0pre3. Added the xls file as\na testcase. (HEAD tho is hosed!)", "id": 45165, "time": "2003-10-06T17:33:17Z", "creator": "avik@apache.org", "creation_time": "2003-10-06T17:33:17Z", "is_private": false, "attachment_id": null}]