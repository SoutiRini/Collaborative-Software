[{"count": 0, "tags": [], "bug_id": 33027, "attachment_id": null, "is_private": false, "id": 69477, "time": "2005-01-10T12:22:19Z", "creator": "horombo@gmx.de", "creation_time": "2005-01-10T12:22:19Z", "text": "The 'if [ \"$1\" = \"-force\" ]' branch of the stop command doesn't give the started\nCatalina instance any time to shutdown normally, because immediately after\ntelling Catalina via socket to shutdown it kills the process the hard way.\nAdding a sleep with a reasonable delay gives the started Catalina instance time\nto shutdown cleanly.\n\nThe following code snippet adds this delay, a check whether Catalina is still\nrunning (perhaps there's no need to kill) and a removal of the pid file after\nall is done (no stale pid):\n\nif [ $FORCE -eq 1 ]; then\n  if [ ! -z \"$CATALINA_PID\" ]; then\n    sleep 3\n    if [ kill -0 `cat $CATALINA_PID` 2>/dev/null ]; then\n      echo \"Killing: `cat $CATALINA_PID`\"\n      kill -9 `cat $CATALINA_PID`\n    fi\n    rm -f $CATALINA_PID\n  fi\nfi"}, {"count": 1, "tags": [], "bug_id": 33027, "attachment_id": null, "id": 69607, "time": "2005-01-12T18:56:57Z", "creator": "horombo@gmx.de", "creation_time": "2005-01-12T18:56:57Z", "is_private": false, "text": "The brackets for kill -0 are wrong, it's supposed to be\n\nif kill -0 `cat $CATALINA_PID` 2>/dev/null; then\n    ...\nfi\n\nSorry - Christian"}, {"count": 2, "tags": [], "creator": "yoavs@computer.org", "is_private": false, "text": "-1, this is too specific a feature for you, have fun with your own custom \nscripts.", "id": 70333, "time": "2005-02-01T21:35:16Z", "bug_id": 33027, "creation_time": "2005-02-01T21:35:16Z", "attachment_id": null}]