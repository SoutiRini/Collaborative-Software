[{"count": 0, "tags": [], "bug_id": 29985, "text": "According to the 10.2 man pages, \"poll\" is depreciated (as of 10.2) and the header does not seem to \nexist at all in 10.3. However, the httpd-2.0.50 (sorry, not option for 50 above so I chose 49) configure \nscript does not detect this and, as a result, compiling srclib/apr/poll/unix/poll.c fails. If you \"undef \nHAVE_POLL\" just before it is first \"ifdef\"d everything seems to then compile fine :)\n\nJust for info, the configure script says this about poll:\nchecking for poll... yes\nchecking poll.h usability... no\nchecking poll.h presence... no\nchecking for poll.h... no\nchecking sys/poll.h usability... no\nchecking sys/poll.h presence... no\nchecking for sys/poll.h... no\nchecking for POLLIN in poll.h sys/poll.h... no\n\nbut it still defines HAVE_POLL", "id": 60321, "time": "2004-07-08T21:00:47Z", "creator": "r.s.goldsmith@far-blue.co.uk", "creation_time": "2004-07-08T21:00:47Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 29985, "text": "move to APR.", "id": 60323, "time": "2004-07-08T23:47:45Z", "creator": "chip@force-elite.com", "creation_time": "2004-07-08T23:47:45Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 29985, "attachment_id": null, "id": 60416, "time": "2004-07-10T23:19:24Z", "creator": "chip@force-elite.com", "creation_time": "2004-07-10T23:19:24Z", "is_private": false, "text": "Best that I can figure out is that poll.h was removed from 10.3.  Therefore,\npeople who upgraded from 10.2 -> 10.3 will still have the header, but any fresh\ninstalls will not.\n\nIt sounds like the function itself is still in their libc/kernel, but its public\nheader is gone.  As a side note, Darwin and OSX support KQueue, so in the future\nwe should be able to use these methods for higher performance instead of select().\n\nTo resolve this bug, I guess we need some more autoconf foo to disable poll() if\nit is not in any public headers?"}, {"text": "\n#warning \"poll() functionality for Mac OS X is implemented via an emulation\nlayer on top of select(), not in the kernel directly.  It is recommended that\nprograms running under OS X 10.3 prefer select() over poll().  Configure scripts\nshould look for the _POLL_EMUL_H_ define (instead of _POLL_H_ or _SYS_POLL_H_)\nand avoid implementations where poll is not implemented in the kernel.\"\n\nsolution: add a test to configure.in or poll.c and use select on OSX?", "tags": [], "bug_id": 29985, "attachment_id": null, "count": 3, "id": 60422, "time": "2004-07-11T00:07:44Z", "creator": "chip@force-elite.com", "creation_time": "2004-07-11T00:07:44Z", "is_private": false}, {"text": "The solution is to not define HAVE_POLL if neither poll.h nor sys/poll.h are\nfound (or define and use a new USE_POLL flag iff poll() is found along with\neither header).", "tags": [], "bug_id": 29985, "attachment_id": null, "count": 4, "id": 66929, "time": "2004-11-15T14:16:33Z", "creator": "jorton@redhat.com", "creation_time": "2004-11-15T14:16:33Z", "is_private": false}, {"count": 5, "tags": [], "creator": "chip@force-elite.com", "attachment_id": null, "text": "In APR 1.0  this is fixed because it will use KQueue.", "id": 66941, "time": "2004-11-15T19:56:04Z", "bug_id": 29985, "creation_time": "2004-11-15T19:56:04Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 29985, "text": "This is a build error in 0.9.4 though, so that doesn't help 0.9.x users.", "id": 66954, "time": "2004-11-15T21:21:08Z", "creator": "jorton@redhat.com", "creation_time": "2004-11-15T21:21:08Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 29985, "attachment_id": null, "id": 67901, "time": "2004-12-03T20:08:27Z", "creator": "carnold@houston.rr.com", "creation_time": "2004-12-03T20:08:27Z", "is_private": false, "text": "Running testpoll on the SVN head as of 3 Dec 2004 on a Power Mac Dual G5 running\nOS/X 10.3.6 would mostly fail, but sometimes pass.  On four successive manual\nruns, I got the following results:\n\n\n./testall -v testpoll\ntestpoll            : \nLine 362: expected <2>, but saw <1>                     \nLine 393: expected <0>, but saw <70007>                                        \nBus error\n./testall -v testpoll\ntestpoll            : SUCCESS\nAll tests passed.\n./testall -v testpoll\ntestpoll            : \nLine 361: expected <0>, but saw <70007>                 \nBus error\n./testall -v testpoll\ntestpoll            : \nLine 331: expected <0>, but saw <70007>                \nBus error\n./testall -v testpoll\ntestpoll            : SUCCESS\nAll tests passed.\n./testall -v testpoll\ntestpoll            : \nLine 331: expected <0>, but saw <70007>                 \nBus error\n\n\n"}, {"count": 8, "tags": [], "bug_id": 29985, "attachment_id": null, "id": 67903, "time": "2004-12-03T20:24:04Z", "creator": "chip@force-elite.com", "creation_time": "2004-12-03T20:24:04Z", "is_private": false, "text": "Which version of APR are you using?"}, {"count": 9, "tags": [], "bug_id": 29985, "attachment_id": null, "text": "Fixed for future releases.\n\nhttp://svn.apache.org/viewcvs?rev=178389&view=rev", "id": 75322, "time": "2005-05-25T08:27:43Z", "creator": "jorton@redhat.com", "creation_time": "2005-05-25T08:27:43Z", "is_private": false}, {"count": 10, "tags": [], "bug_id": 29985, "text": "The fix is not correct.  Poll was fixed in 10.4.0.\n\n10.2.0: In public headers, but broken.\n10.3.0: Not in public headers, available in C library, if you did an Upgrade\ninstall from 10.2 -> 10.3 you still had this header.  Still Broken.\n10.4.0: Added back in public headers, seems to work.", "id": 75324, "time": "2005-05-25T08:31:45Z", "creator": "chip@force-elite.com", "creation_time": "2005-05-25T08:31:45Z", "is_private": false, "attachment_id": null}, {"count": 11, "tags": [], "bug_id": 29985, "attachment_id": null, "id": 75759, "time": "2005-06-01T23:21:54Z", "creator": "jorton@redhat.com", "creation_time": "2005-06-01T23:21:54Z", "is_private": false, "text": "Final verdict is to leave it off."}]