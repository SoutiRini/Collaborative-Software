[{"count": 0, "tags": [], "text": "I get the following issue with the following record when parsing with ExcelExtractor:\n\norg.apache.poi.hssf.record.RecordInputStream$LeftoverDataException: Initialisation of record 0x850 left 3060 bytes remaining still to be read.\n\tat org.apache.poi.hssf.record.RecordInputStream.hasNextRecord(RecordInputStream.java:124)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:402)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:277)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:202)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:184)\n\nBiffViewer gives me the following error when dealing with the spreadsheet in question:\n\n     [java] Offset=0x000359F4(219636) recno=9202 sid=0x08C9 size=0x0018(24)\n     [java] [UNKNOWNRECORD] (0x8C9)\n     [java]   rawData=[C9, 08, 00, 00, 00, 00, 00, 00, 00, 00, 00, 00, 00, 00, 00, 00, 00, 00, 01, 00, 00, 00, 00, 00]\n     [java] [/UNKNOWNRECORD]\n     [java] \n     [java] org.apache.poi.hssf.record.RecordFormatException: Not enough data (0) to read requested (6) bytes\n     [java]     at org.apache.poi.hssf.record.RecordInputStream.checkRecordPosition(RecordInputStream.java:185)\n     [java]     at org.apache.poi.hssf.record.RecordInputStream.readFully(RecordInputStream.java:250)\n     [java]     at org.apache.poi.hssf.record.RecordInputStream.readFully(RecordInputStream.java:246)\n     [java]     at org.apache.poi.hssf.record.chart.ChartEndObjectRecord.<init>(ChartEndObjectRecord.java:44)\n     [java]     at org.apache.poi.hssf.dev.BiffViewer.createRecord(BiffViewer.java:248)\n     [java]     at org.apache.poi.hssf.dev.BiffViewer.createRecords(BiffViewer.java:84)\n     [java]     at org.apache.poi.hssf.dev.BiffViewer.main(BiffViewer.java:398)\n     [java]     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n     [java]     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n     [java]     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:2", "is_private": false, "bug_id": 47247, "id": 127305, "time": "2009-05-22T11:06:54Z", "creator": "jonathan.holloway@gmail.com", "creation_time": "2009-05-22T11:06:54Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 47247, "attachment_id": null, "id": 127313, "time": "2009-05-22T12:07:48Z", "creator": "josh@apache.org", "creation_time": "2009-05-22T12:07:48Z", "is_private": false, "text": "These are problems with the recently added chart records.  \nI am not sure why you get a different error from BiffViewer (because it seems\nto interpret the same set of records as RecordFactory).  Both errors look\nlegitimate, and this suggests a third problem as to why BiffViewer behaves\ndifferently.\n\n\nAs far as ChartEndObjectRecord is concerned, it looks like some apps don't\nwrite the 'unused' field.  It would be interesting to know whether Excel\nre-adds it.\nI can't see any obvious problem with ChartFRTInfoRecord, so we'll probably need\nsome sample data.\n\nCould you either upload the spreadsheet in question, or give the hex dump of\nthese two offending records?\n\nYou can get the dump by changing the constructors of ChartFRTInfoRecord and\nChartEndObjectRecord(:\n\n// change the parameter declaration from 'in' to 'inOrig'\n// add this code at the top of the method\nbyte[] data = inOrig.readRemainder();\nLittleEndianInput in = new LittleEndianByteArrayInputStream(data);\n\n// add this code at the bottom \nif (in.available()>0) {\n    System.err.println(\"leftover data reading \" + getClass().getName());\n    System.err.println(HexDump.toHex(data, 16));\n}\n\n// also change param type to CFRTID constructor ( like svn r777660 )"}, {"count": 2, "text": "Created attachment 23906\nA .xls that causes the exception\n\nA .xls that causes the stated exception. It contains a worksheet with some numbers and a chart to graph them. It was created with Microsoft Excel 2004 for Mac Version 11.5.5 (090512).", "creator": "prescindor@gmail.com", "attachment_id": 23906, "id": 128413, "time": "2009-06-29T20:38:06Z", "bug_id": 47247, "creation_time": "2009-06-29T20:38:06Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 47247, "attachment_id": null, "is_private": false, "id": 128414, "time": "2009-06-29T20:40:30Z", "creator": "prescindor@gmail.com", "creation_time": "2009-06-29T20:40:30Z", "text": "I have attached a .xls that causes the stated exception. It contains a worksheet with some numbers and a chart to graph them. It was created with Microsoft Excel 2004 for Mac Version 11.5.5 (090512)."}, {"count": 4, "tags": [], "bug_id": 47247, "attachment_id": null, "id": 169150, "time": "2013-08-05T20:05:19Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2013-08-05T20:05:19Z", "is_private": false, "text": "Still reproducible with current POI 3.10beta1 with the following code:\n\n       POITextExtractor extractor = ExtractorFactory.createExtractor(POIDataSamples.getSpreadSheetInstance().getFile(\"47247.xls\"));"}, {"count": 5, "text": "If someone wanted to spend some time on this bug, you'd want to start by using a debugger to identify the problematic record, and the few preceding it (especially if there are continue records). Then, check the file format doc, and ensure that all the options / optional parts / reserved parts / variable length parts are handled by the problem record, and the few before it. \n\nAlso, check with the file format validator if the record structure is correct, and see if loading the file in excel and doing a save-as trims the record?", "creator": "apache@gagravarr.org", "attachment_id": null, "id": 169177, "time": "2013-08-06T11:44:39Z", "bug_id": 47247, "creation_time": "2013-08-06T11:44:39Z", "tags": [], "is_private": false}, {"count": 6, "text": "0x850 is a ChartFRTInfoRecord, during opening the file, it reads 20 bytes from the stream, but POI thinks there should be 3080 read, thus 3060 bytes still remain.\n\nReading and saving the file in LibreOffice makes it readable fine, however the resulting file is completely different when looking at it with BiffViewer.", "creator": "dominik.stadler@gmx.at", "attachment_id": null, "id": 170859, "time": "2013-10-27T09:15:55Z", "bug_id": 47247, "creation_time": "2013-10-27T09:15:55Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "bug_id": 47247, "attachment_id": null, "id": 179481, "time": "2014-12-03T14:00:40Z", "creator": "spt@recommind.com", "creation_time": "2014-12-03T14:00:40Z", "is_private": false, "text": "Still reproducible with current poi-3.11-beta3-20141111 and attached file."}]