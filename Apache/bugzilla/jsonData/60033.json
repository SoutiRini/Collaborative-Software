[{"count": 0, "tags": [], "creator": "kineolyan@gmail.com", "attachment_id": null, "id": 193283, "time": "2016-08-23T14:09:01Z", "bug_id": 60033, "creation_time": "2016-08-23T14:09:01Z", "is_private": false, "text": "Running tomcat 8.5.4 on a maven project with various jars, I ended up with a lot of errors like:\n> WARNING: Failed to scan [file:/home/olivier/maven/repo/net/sf/jung/jung-graph-impl/2.0.1/jung-api-2.0.1.jar] from classloader hierarchy\n> java.io.FileNotFoundException: /home/olivier/maven/repo/net/sf/jung/jung-graph-impl/2.0.1/jung-api-2.0.1.jar (No such file or directory)\n> ... (stacktrace)\n\nAfter some debugging, I discovered that it occurs for jars having a Manifest file with a non-empty Class-Path attribute.\n\nFor example, jung-graph-impl-2.0.1.jar MANIFEST defines Class-Path as:\n> Class-Path: jung-api-2.0.1.jar collections-generic-4.01.jar\nWith that, the code (org.apache.tomcat.util.scan.StandardJarScanner#processManifest) tries to load the jars as if located in the same directory, resulting in requests for /home/olivier/maven/repo/net/sf/jung/jung-graph-impl/2.0.1/jung-api-2.0.1.jar, which does not exist.\nIndeed, following maven guidelines, it is located in /home/olivier/maven/repo/net/sf/jung/jung-api/2.0.1/jung-api-2.0.1.jar.\n\nAs I am not familiar with MANIFEST, I don't know if the error comeo from a badly defined MANIFEST, or if the manifest can reference jars outside this jar.\n\nIf Issue 59961 was complete, I could have skipped Manifest, as I don't need them.\n\nThanks for the reply"}, {"count": 1, "tags": [], "text": "(In reply to Olivier Peyrusse from comment #0)\n\n> As I am not familiar with MANIFEST, I don't know if the error comeo from a\n> badly defined MANIFEST, or if the manifest can reference jars outside this\n> jar.\n\nIt is generally a good idea to do a little research before raising a bug. [1] would have been informative.\n\nBug 59961 does look as if it would be useful to you. Patches (attached to that bug) welcome.\n\n[1] https://docs.oracle.com/javase/8/docs/technotes/guides/jar/jar.html#classpath", "attachment_id": null, "bug_id": 60033, "id": 193284, "time": "2016-08-23T14:15:46Z", "creator": "markt@apache.org", "creation_time": "2016-08-23T14:15:46Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 60033, "is_private": false, "text": "(In reply to Mark Thomas from comment #1)\n> Bug 59961 does look as if it would be useful to you. Patches (attached to\n> that bug) welcome.\nAs stated by my comment, I read that task for improvement, but saw no attachement. As suggested by the comment, I was also investigating the usage of JarScanFilter.\n\nHowever, I have another question for you. Does the Manifest processing works for Tomcat in its embedded version ?\nWhen my issue occurs, the server I have was created by instanciated a Tomcat class (https://tomcat.apache.org/tomcat-8.0-doc/api/org/apache/catalina/startup/Tomcat.html), as well as no web.xml but instead WebAppInitializer class.\n\nIn its application version, a WAR is loaded, containing in the lib folder all jars. Thus, looking for jars referenced by the Manifest in the same folder as the jar itself seems logical.\nThis is different in my case, where the server is created from the main method, because the classpath of the program is made from several locations.\n\nIf I reuse my example with jung-graph, it gives me:\nE.g. java -cp /home/olivier/maven/repo/net/sf/jung/jung-api/2.0.1/jung-api-2.0.1.jar;/home/olivier/maven/repo/net/sf/jung/jung-graph-impl/2.0.1/jung-graph-impl-2.0.1.jar MyMainClass\n\nIn this case, jung-api-2.0.1.jar is indeed in the classpath, but not in the same folder as jung-graph-impl-2.0.1.jar.\n\nMaybe I am misusing the Tomcat class, but I heavily looked for a documentation or tutorial on how to use it, and found very few.\n\nRegards", "id": 193287, "time": "2016-08-23T17:54:38Z", "creator": "kineolyan@gmail.com", "creation_time": "2016-08-23T17:54:38Z", "attachment_id": null}, {"count": 3, "tags": [], "text": "Marking the issue as reopened to get an answer on my latest question.\nOtherwise, I think the issue is skipped.\n\nRegards", "is_private": false, "id": 193341, "creator": "kineolyan@gmail.com", "time": "2016-08-26T08:31:03Z", "bug_id": 60033, "creation_time": "2016-08-26T08:31:03Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 60033, "attachment_id": null, "id": 193342, "time": "2016-08-26T10:02:11Z", "creator": "markt@apache.org", "creation_time": "2016-08-26T10:02:11Z", "is_private": false, "text": "Bugzilla is not a support forum. Use the users mailing list."}]