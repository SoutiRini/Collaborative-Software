[{"count": 0, "tags": [], "creator": "prunge@onaustralia.com.au", "attachment_id": 22597, "id": 120727, "creation_time": "2008-09-17T17:15:11Z", "time": "2008-09-17T17:15:11Z", "bug_id": 45829, "text": "Created attachment 22597\nTest PNG image with zero DPI\n\nPOI version 3.1-FINAL-20080629.\n\nWhen calling HSSFPicture.resize() for a PNG image that does not specify a DPI (DPI width and height is zero), HSSFPicture.getImageDimension() method fails with ArithmeticException (/ by zero).\n\nIt seems that in getResolution() the HorizontalPixelSize and VerticalPixelSize image metadata elements have values of zero if DPI is set to zero in PNG files.  While this might indicate a problem with the PNG file, failing with / by zero error is not appropriate as other software can happily load and display these files.  It would be more appropriate to either fall back to DPI defaults (96 DPI) rather than returning zeroes from this method or have special handling in getImageDimension() so that DPI is not used if it is zero.\n\nStack trace:\njava.lang.ArithmeticException: / by zero\n\tat org.apache.poi.hssf.usermodel.HSSFPicture.getImageDimension(HSSFPicture.java:238)\n\tat org.apache.poi.hssf.usermodel.HSSFPicture.getPreferredSize(HSSFPicture.java:120)\n\tat org.apache.poi.hssf.usermodel.HSSFPicture.resize(HSSFPicture.java:97)\n\t...", "is_private": false}, {"count": 1, "tags": [], "text": "Created attachment 22598\nPatch for HSSFPicture.java", "is_private": false, "id": 120728, "creator": "prunge@onaustralia.com.au", "time": "2008-09-17T17:37:42Z", "bug_id": 45829, "creation_time": "2008-09-17T17:37:42Z", "attachment_id": 22598}, {"count": 2, "tags": [], "bug_id": 45829, "attachment_id": null, "id": 120729, "time": "2008-09-17T17:38:48Z", "creator": "prunge@onaustralia.com.au", "creation_time": "2008-09-17T17:38:48Z", "is_private": false, "text": "Created patch for HSSFPicture.java against\ntrunk/src/java/org/apache/poi/hssf/usermodel/HSSFPicture.java.\n\nAdded zero checking in getImageDimension() before division and using defaults\nif zero is found.\n"}, {"count": 3, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "id": 120734, "creation_time": "2008-09-18T03:28:44Z", "time": "2008-09-18T03:28:44Z", "bug_id": 45829, "text": "Fixed in r696622\n\nYegor", "is_private": false}]