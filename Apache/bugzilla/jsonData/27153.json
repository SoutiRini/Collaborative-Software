[{"count": 0, "tags": [], "bug_id": 27153, "is_private": false, "id": 52785, "attachment_id": null, "creator": "timw@mediatel.co.uk", "creation_time": "2004-02-23T11:27:29Z", "time": "2004-02-23T11:27:29Z", "text": "I have noticed a bug with POI 2.0 final release when dealing with excel sheets\nthat contain images and involving resizing columns on which the image spans.\n\nI set the graphics properties to be independent of the cell's size and position.\nWhich causes the object to stay at its size even if I resize the column. This\ndoes not work with HSSF. The graphic is being resized to column width but the\nproperties remain unchanged.\n\nI have included a simple program example of this. This involves taking an excel\ndocument as a template (ImageResizeExampleTemplate.xls) that contains an image\nin the top left corner. The program takes this excel document template (it looks\nfor it on the root of your class path) and alters the 'A' column width to be\nmuch wider than in the original. Finally the program creates a new excel\ndocument (ImageResizeExampleOutput.xls) with the modified work book object."}, {"count": 1, "tags": [], "creator": "timw@mediatel.co.uk", "text": "Created attachment 10487\nThe template XLS file that contains an image in the top left corner", "id": 52786, "time": "2004-02-23T11:30:25Z", "bug_id": 27153, "creation_time": "2004-02-23T11:30:25Z", "is_private": false, "attachment_id": 10487}, {"count": 2, "tags": [], "bug_id": 27153, "is_private": false, "id": 52787, "attachment_id": 10488, "creator": "timw@mediatel.co.uk", "creation_time": "2004-02-23T11:52:04Z", "time": "2004-02-23T11:52:04Z", "text": "Created attachment 10488\nThe source code of the example"}, {"count": 3, "tags": [], "creator": "timw@mediatel.co.uk", "text": "Created attachment 10489\nThe compiled version of the test program", "id": 52788, "time": "2004-02-23T11:52:59Z", "bug_id": 27153, "creation_time": "2004-02-23T11:52:59Z", "is_private": false, "attachment_id": 10489}, {"count": 4, "tags": [], "text": "This bug still exists in poi 3.0.2.\nWhen I add an image and I resize one column or one row contained by its anchor, the image gets stretched.\nThe same problem occurs of course if I call sheet.autoSizeColumn(col);\n\nThe anchor type seems to be ignored. I can put whatever value to the anchor type, I get the same result.\nanchor.setAnchorType(3); // 3=no resize/move", "is_private": false, "id": 114804, "creator": "lpoublan@triloggroup.com", "time": "2008-03-20T02:34:11Z", "bug_id": 27153, "creation_time": "2008-03-20T02:34:11Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 27153, "attachment_id": null, "text": "Anchor type is not ignored. \n\nWhen you resize a column POI just updates the corresponding COLINFO record. No extra actions/calculations are performed. \nAs opposed to it, on column resize Excel recomputes anchors of all pictures with anchor.type=2 so that they have the original dimensions.\n\nI don't think POI should work this way and recompute anchors behind the scene. Probably we will add an explicit method HSSFSheet.updateAnchors() to do that. \nImplementing such a method right now is somewhat difficult because the HSSF drawing layer is mainly oriented on creating new drawings. The support for reading/modifying existing drawings is not very good. \n\nYegor", "id": 114823, "time": "2008-03-20T12:08:10Z", "creator": "yegor@dinom.ru", "creation_time": "2008-03-20T12:08:10Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 27153, "is_private": false, "id": 114843, "attachment_id": null, "creator": "lpoublan@triloggroup.com", "creation_time": "2008-03-21T01:26:20Z", "time": "2008-03-21T01:26:20Z", "text": "Thank you for your quick answer.\nHowever, I think something should be done for the following case:\nif I create a picture on a patriarch and call resize() on it, the resizing is correct ONLY IF the rows/columns have the default height/width.\nIf the columns/rows width/height have been changed (before calling resize()), the resize does not set the image to its original size (proportions are modified).\nI understand that changing cols/rows sizes after can alter images size, but I think HSSFPicture.resize() should always resize the image correctly.\n\n"}, {"count": 7, "tags": [], "bug_id": 27153, "attachment_id": null, "text": "You are right about HSSFPicture.resize(). It doesn't take into account resized columns. I will see how it can be adjusted to work in all cases. \n\nPlease keep in mind that HSSFPicture.resize() makes two important assumptions: \n\n - default font is Arial 10pt. Usually it is so but if user goes to Excel options and selects a different font the result is unpredictable\n - display is 96 dpi. In most cases it is so but if you have a different setting you will see a stretched image even it looks fine at 96 dpi. \n\nYegor", "id": 114845, "time": "2008-03-21T04:27:30Z", "creator": "yegor@dinom.ru", "creation_time": "2008-03-21T04:27:30Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 27153, "text": "Will you reopen that bug or open a new bug for that?\n\nLaurent", "id": 114978, "attachment_id": null, "creator": "lpoublan@triloggroup.com", "creation_time": "2008-03-26T04:02:25Z", "time": "2008-03-26T04:02:25Z", "is_private": false}, {"count": 9, "tags": [], "creator": "yegor@dinom.ru", "text": "Thanks for reminding. I opened a new bug.\n\nYegor", "id": 115032, "time": "2008-03-27T09:34:32Z", "bug_id": 27153, "creation_time": "2008-03-27T09:34:32Z", "is_private": false, "attachment_id": null}]