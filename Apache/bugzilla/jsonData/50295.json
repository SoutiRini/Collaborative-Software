[{"count": 0, "tags": [], "bug_id": 50295, "attachment_id": 26314, "id": 141809, "time": "2010-11-18T17:43:57Z", "creator": "dlsmith@users.sourceforge.net", "creation_time": "2010-11-18T17:43:57Z", "is_private": false, "text": "Created attachment 26314\nBug fix\n\nI'm running Ubuntu 10.10 on a MacBook Pro with a shared HFS+ partition (so I can see files under both OS X and Ubuntu).  When I try to use FileSets pointing to files on the HFS+ partition, the sets appear empty.  For example:\n\n<project name=\"ant-bug\" default=\"test\">\n  <property name=\"dir\" value=\".\"/> <!-- default to \".\" -->\n  <target name=\"test\">\n    <fileset id=\"files\" dir=\"${dir}\" includes=\"*\"/>\n    <property name=\"filenames\" refid=\"files\"/>\n    <echo message=\"Files in ${dir}: ${filenames}\"/>\n  </target>\n</project>\n\nIf this script appears in build.xml in the current directory, its output depends on whether the current directory is on the HFS+ partition or the system ext4 partition.\n\nI found another user observing this problem in a mailing list post, but without any resolution: <http://mail-archives.apache.org/mod_mbox/ant-user/200908.mbox/%3c1250181030.8090.27.camel@iggy%3e>\n\nI've tracked the problem to a bug in the java.io.File API as implemented by OpenJDK.  Rather than returning \"null\" from File.list(), it returns an empty array.  I've submitted a bug report to OpenJDK.\n\nIn the mean time (and for backwards compatibility with broken JDKs), the attached simple patch will prevent the bug from having an impact on Ant users."}, {"count": 1, "tags": [], "bug_id": 50295, "text": "svn revision 1036905 contains an initial fix and svn revision 1036906 refines it\nso that isFile is only called on empty directories on VMs without the bug.\nUnfortunately isFile doesn't come for free.\n\nIt would be good if you could link to your OpenJDK bug report.\n\nThanks for analyzing the problem and providing the patch!", "id": 141834, "time": "2010-11-19T10:50:34Z", "creator": "bodewig@apache.org", "creation_time": "2010-11-19T10:50:34Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "dlsmith@users.sourceforge.net", "attachment_id": null, "text": "In informal discussions with an OpenJDK developer, we decided that java.io.File was reacting correctly to bad information provided by the underlying system.  So I created a Ubuntu bug report:\n\n<https://bugs.launchpad.net/ubuntu/+source/hfsplus/+bug/680174>", "id": 141938, "time": "2010-11-22T16:25:54Z", "bug_id": 50295, "creation_time": "2010-11-22T16:25:54Z", "is_private": false}]