[{"count": 0, "attachment_id": null, "bug_id": 38479, "text": "When uploading a gif image in BXE i get the following error, seems like\nlenya is using awt routines to determine the image size (just a guess of \nthe blue), that would imply a running X-Server on Unix (or atleast a headless\nX-Server) which is not that cool on a server machine..\n\n/usr/lib/j2sdk1.4.2_09/jre/lib/i386/libawt.so: libXp.so.6: cannot open shared\nobject file: No such file or directory\n\njava.lang.UnsatisfiedLinkError: /usr/lib/j2sdk1.4.2_09/jre/lib/i386/libawt.so:\nlibXp.so.6: cannot open shared object file: No such file or directory\n\tat java.lang.ClassLoader$NativeLibrary.load(Native Method)\n\tat java.lang.ClassLoader.loadLibrary0(ClassLoader.java:1586)\n\tat java.lang.ClassLoader.loadLibrary(ClassLoader.java:1503)\n\tat java.lang.Runtime.loadLibrary0(Runtime.java:788)\n\tat java.lang.System.loadLibrary(System.java:834)\n\tat sun.security.action.LoadLibraryAction.run(LoadLibraryAction.java:50)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat java.awt.image.ColorModel.loadLibraries(ColorModel.java:188)\n\tat java.awt.image.ColorModel.<clinit>(ColorModel.java:196)\n\tat javax.imageio.ImageTypeSpecifier$Packed.<init>(ImageTypeSpecifier.java:275)\n\tat javax.imageio.ImageTypeSpecifier.createPacked(ImageTypeSpecifier.java:327)\n\tat javax.imageio.ImageTypeSpecifier.<clinit>(ImageTypeSpecifier.java:63)\n\tat\ncom.sun.imageio.plugins.gif.GIFImageReader.getImageTypes(GIFImageReader.java:240)\n\tat com.sun.imageio.plugins.gif.GIFImageReader.read(GIFImageReader.java:962)\n\tat javax.imageio.ImageIO.read(ImageIO.java:1384)\n\tat javax.imageio.ImageIO.read(ImageIO.java:1306)\n\tat\norg.apache.lenya.cms.publication.DefaultResourcesManager.addResource(DefaultResourcesManager.java:147)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:324)\n\tat\norg.apache.avalon.excalibur.component.ComponentProxyGenerator$ComponentInvocationHandler.invoke(ComponentProxyGenerator.java:143)\n\tat $Proxy25.addResource(Unknown Source)\n\tat org.apache.lenya.cms.site.usecases.Assets.addAsset(Assets.java:164)\n\tat org.apache.lenya.cms.site.usecases.Assets.addAsset(Assets.java:144)\n\tat org.apache.lenya.cms.site.usecases.Assets.doExecute(Assets.java:90)\n\tat org.apache.lenya.cms.usecase.AbstractUsecase.execute(AbstractUsecase.java:260)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:324)\n\tat\norg.apache.avalon.excalibur.component.ComponentProxyGenerator$ComponentInvocationHandler.invoke(ComponentProxyGenerator.java:143)\n\tat $Proxy22.execute(Unknown Source)\n\tat\norg.apache.lenya.cms.usecase.UsecaseInvokerImpl.invoke(UsecaseInvokerImpl.java:68)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:324)\n\tat\norg.apache.avalon.excalibur.component.ComponentProxyGenerator$ComponentInvocationHandler.invoke(ComponentProxyGenerator.java:143)\n\tat $Proxy30.invoke(Unknown Source)\n\tat org.apache.lenya.cms.editors.InsertAsset.advance(InsertAsset.java:90)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:324)\n\tat\norg.apache.avalon.excalibur.component.ComponentProxyGenerator$ComponentInvocationHandler.invoke(ComponentProxyGenerator.java:143)\n\tat $Proxy22.advance(Unknown Source)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:324)\n\tat org.mozilla.javascript.NativeJavaMethod.call(NativeJavaMethod.java:230)\n\tat org.mozilla.javascript.ScriptRuntime.call(ScriptRuntime.java:1244)\n\tat\norg.mozilla.javascript.continuations.ContinuationInterpreter.interpret(ContinuationInterpreter.java:1134)\n\tat\norg.mozilla.javascript.continuations.ContinuationInterpreter.interpret(ContinuationInterpreter.java:190)\n\tat\norg.mozilla.javascript.continuations.ContinuationInterpreter.interpret(ContinuationInterpreter.java:138)\n\tat\norg.mozilla.javascript.continuations.InterpretedFunctionImpl.call(InterpretedFunctionImpl.java:121)\n\tat org.mozilla.javascript.ScriptRuntime.call(ScriptRuntime.java:1244)\n\tat org.mozilla.javascript.ScriptableObject.callMethod(ScriptableObject.java:1591)\n\tat\norg.apache.cocoon.components.flow.javascript.fom.FOM_JavaScriptInterpreter.handleContinuation(FOM_JavaScriptInterpreter.java:852)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.CallFunctionNode.invoke(CallFunctionNode.java:123)\n\tat\norg.apache.cocoon.components.treeprocessor.AbstractParentProcessingNode.invokeNodes(AbstractParentProcessingNode.java:46)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.MatchNode.invoke(MatchNode.java:107)\n\tat\norg.apache.cocoon.components.treeprocessor.AbstractParentProcessingNode.invokeNodes(AbstractParentProcessingNode.java:68)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.PipelineNode.invoke(PipelineNode.java:142)\n\tat\norg.apache.cocoon.components.treeprocessor.AbstractParentProcessingNode.invokeNodes(AbstractParentProcessingNode.java:68)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.PipelinesNode.invoke(PipelinesNode.java:92)\n\tat\norg.apache.cocoon.components.treeprocessor.ConcreteTreeProcessor.process(ConcreteTreeProcessor.java:234)\n\tat\norg.apache.cocoon.components.treeprocessor.ConcreteTreeProcessor.process(ConcreteTreeProcessor.java:176)\n\tat\norg.apache.cocoon.components.treeprocessor.TreeProcessor.process(TreeProcessor.java:248)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.MountNode.invoke(MountNode.java:117)\n\tat\norg.apache.cocoon.components.treeprocessor.AbstractParentProcessingNode.invokeNodes(AbstractParentProcessingNode.java:46)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.MatchNode.invoke(MatchNode.java:107)\n\tat\norg.apache.cocoon.components.treeprocessor.AbstractParentProcessingNode.invokeNodes(AbstractParentProcessingNode.java:68)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.PipelineNode.invoke(PipelineNode.java:142)\n\tat\norg.apache.cocoon.components.treeprocessor.AbstractParentProcessingNode.invokeNodes(AbstractParentProcessingNode.java:68)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.PipelinesNode.invoke(PipelinesNode.java:92)\n\tat\norg.apache.cocoon.components.treeprocessor.ConcreteTreeProcessor.process(ConcreteTreeProcessor.java:234)\n\tat\norg.apache.cocoon.components.treeprocessor.ConcreteTreeProcessor.process(ConcreteTreeProcessor.java:176)\n\tat\norg.apache.cocoon.components.treeprocessor.TreeProcessor.process(TreeProcessor.java:248)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.MountNode.invoke(MountNode.java:117)\n\tat\norg.apache.cocoon.components.treeprocessor.AbstractParentProcessingNode.invokeNodes(AbstractParentProcessingNode.java:46)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.PreparableMatchNode.invoke(PreparableMatchNode.java:130)\n\tat\norg.apache.cocoon.components.treeprocessor.AbstractParentProcessingNode.invokeNodes(AbstractParentProcessingNode.java:68)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.PipelineNode.invoke(PipelineNode.java:142)\n\tat\norg.apache.cocoon.components.treeprocessor.AbstractParentProcessingNode.invokeNodes(AbstractParentProcessingNode.java:68)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.PipelinesNode.invoke(PipelinesNode.java:92)\n\tat\norg.apache.cocoon.components.treeprocessor.ConcreteTreeProcessor.process(ConcreteTreeProcessor.java:234)\n\tat\norg.apache.cocoon.components.treeprocessor.ConcreteTreeProcessor.process(ConcreteTreeProcessor.java:176)\n\tat\norg.apache.cocoon.components.treeprocessor.TreeProcessor.process(TreeProcessor.java:248)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.MountNode.invoke(MountNode.java:117)\n\tat\norg.apache.cocoon.components.treeprocessor.AbstractParentProcessingNode.invokeNodes(AbstractParentProcessingNode.java:46)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.ActTypeNode.invoke(ActTypeNode.java:138)\n\tat\norg.apache.cocoon.components.treeprocessor.AbstractParentProcessingNode.invokeNodes(AbstractParentProcessingNode.java:46)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.PreparableMatchNode.invoke(PreparableMatchNode.java:130)\n\tat\norg.apache.cocoon.components.treeprocessor.AbstractParentProcessingNode.invokeNodes(AbstractParentProcessingNode.java:68)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.PipelineNode.invoke(PipelineNode.java:142)\n\tat\norg.apache.cocoon.components.treeprocessor.AbstractParentProcessingNode.invokeNodes(AbstractParentProcessingNode.java:68)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.PipelinesNode.invoke(PipelinesNode.java:92)\n\tat\norg.apache.cocoon.components.treeprocessor.ConcreteTreeProcessor.process(ConcreteTreeProcessor.java:234)\n\tat\norg.apache.cocoon.components.treeprocessor.ConcreteTreeProcessor.process(ConcreteTreeProcessor.java:176)\n\tat\norg.apache.cocoon.components.treeprocessor.TreeProcessor.process(TreeProcessor.java:248)\n\tat org.apache.cocoon.Cocoon.process(Cocoon.java:679)\n\tat org.apache.cocoon.servlet.CocoonServlet.service(CocoonServlet.java:1153)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:689)\n\tat org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:427)\n\tat\norg.mortbay.jetty.servlet.WebApplicationHandler.dispatch(WebApplicationHandler.java:475)\n\tat org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:567)\n\tat org.mortbay.http.HttpContext.handle(HttpContext.java:1565)\n\tat\norg.mortbay.jetty.servlet.WebApplicationContext.handle(WebApplicationContext.java:635)\n\tat org.mortbay.http.HttpContext.handle(HttpContext.java:1517)\n\tat org.mortbay.jetty.plus.PlusWebAppContext.handle(PlusWebAppContext.java:158)\n\tat org.mortbay.http.HttpServer.service(HttpServer.java:954)\n\tat org.mortbay.http.HttpConnection.service(HttpConnection.java:814)\n\tat org.mortbay.http.HttpConnection.handleNext(HttpConnection.java:981)\n\tat org.mortbay.http.HttpConnection.handle(HttpConnection.java:831)\n\tat org.mortbay.http.SocketListener.handleConnection(SocketListener.java:244)\n\tat org.mortbay.util.ThreadedServer.handle(ThreadedServer.java:357)\n\tat org.mortbay.util.ThreadPool$PoolThread.run(ThreadPool.java:534)", "id": 85312, "time": "2006-02-01T17:18:34Z", "creator": "gregor.imboden@wyona.com", "creation_time": "2006-02-01T17:18:34Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 38479, "attachment_id": null, "id": 85336, "time": "2006-02-02T11:11:59Z", "creator": "jwkaltz@apache.org", "creation_time": "2006-02-02T11:11:59Z", "is_private": false, "text": "> java.lang.UnsatisfiedLinkError: /usr/lib/j2sdk1.4.2_09/jre/lib/i386/libawt.so:\n> ...\n> at javax.imageio.ImageIO.read(ImageIO.java:1306)\n> ...\n>\norg.apache.lenya.cms.publication.DefaultResourcesManager.addResource(DefaultResourcesManager.java:147)\n\nThe \"DefaultResourcesManager\" uses ImageIO to determine image width and height,\nto automagically add this to the resource's meta-data\n\nThis fails when the machine has no graphical environment installed.\n\nMaybe a solution in this case is to catch the error and not set the meta-data,\nor set it to unknown ?"}, {"count": 2, "tags": [], "bug_id": 38479, "attachment_id": null, "id": 85340, "time": "2006-02-02T14:01:09Z", "creator": "josias.thoeny@wyona.org", "creation_time": "2006-02-02T14:01:09Z", "is_private": false, "text": "IIRC Cocoon's ImageUtils class can determine width/height of images without\nusing awt, but it only works for JPEG and GIF.\nPerhaps it could be used as a fallback?"}, {"count": 3, "tags": [], "bug_id": 38479, "attachment_id": null, "id": 86409, "time": "2006-03-02T16:49:04Z", "creator": "josias.thoeny@wyona.org", "creation_time": "2006-03-02T16:49:04Z", "is_private": false, "text": "We could try the following java option:\n-Djava.awt.headless=true "}, {"count": 4, "tags": [], "creator": "renaud.richardet@wyona.com", "attachment_id": null, "id": 94535, "time": "2006-10-05T10:51:45Z", "bug_id": 38479, "creation_time": "2006-10-05T10:51:45Z", "is_private": false, "text": "*** Bug 40685 has been marked as a duplicate of this bug. ***"}, {"count": 5, "tags": [], "bug_id": 38479, "attachment_id": null, "id": 103222, "time": "2007-05-15T02:54:04Z", "creator": "thorsten@apache.org", "creation_time": "2007-05-15T02:54:04Z", "is_private": false, "text": "I close this bug since we have in lenya.sh:\n\nif [ \"$JAVA_OPTIONS\" = \"\" ] ; then\n  JAVA_OPTIONS='-Xms32M -Xmx512M -Djava.awt.headless=true'\nfi\n\nwhich should address the issue. I could not verify it, since I do not have a\nheadless machine."}]