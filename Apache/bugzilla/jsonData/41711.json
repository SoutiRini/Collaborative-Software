[{"text": "At the moment when constructing a CurrentUserAtom, a\nCorruptPowerPointFileException is thrown when the atom is of the incorrect\nlength.  Problem is, this document may not be corrupt, but may instead come from\na different version of PowerPoint.\n\nI would suggest throwing a WrongPowerPointVersionException exception, or\nsimilar, if the length is incorrect or if the magic number is not matched.", "tags": [], "bug_id": 41711, "is_private": false, "count": 0, "id": 99826, "time": "2007-02-26T19:12:59Z", "creator": "trejkaz@trypticon.org", "creation_time": "2007-02-26T19:12:59Z", "attachment_id": null}, {"count": 1, "attachment_id": null, "creator": "apache@gagravarr.org", "text": "I think we should only through something like WrongPowerPointVersionException if\nwe can detect that. Most of the cases I've seen with broken CurrentUserAtoms\nreally have been corrupt files.\n\nIf you can upload a sample file from an older version of PPT with a short\nCurrentUserAtom, I'll look at detecting that and returning a more useful exception.", "id": 99935, "time": "2007-03-01T07:40:10Z", "bug_id": 41711, "creation_time": "2007-03-01T07:40:10Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "trejkaz@trypticon.org", "text": "The way we currently detect if the PowerPoint document is of the form HSLF\nsupports, is to open the CurrentUserAtom and look for the magic number.  If it\nisn't there, then we consider that it isn't of the right version, and so far\nthat's been good enough since Office was able to open the remaining ones.", "id": 99954, "time": "2007-03-01T20:08:28Z", "bug_id": 41711, "creation_time": "2007-03-01T20:08:28Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "trejkaz@trypticon.org", "text": "Created attachment 19655\nExample PowerPoint 95 document", "id": 99957, "time": "2007-03-01T20:36:41Z", "bug_id": 41711, "creation_time": "2007-03-01T20:36:41Z", "is_private": false, "attachment_id": 19655}, {"text": "I've added OldPowerPointFormatException, which CurrentUserAtom will now throw if it detects a ppt95 file", "tags": [], "bug_id": 41711, "is_private": false, "count": 4, "id": 127059, "time": "2009-05-16T13:51:47Z", "creator": "apache@gagravarr.org", "creation_time": "2009-05-16T13:51:47Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 41711, "attachment_id": null, "text": "Noting that this works for our test data, including all the ones we didn't attach.", "id": 131505, "time": "2009-10-29T16:18:44Z", "creator": "trejkaz@trypticon.org", "creation_time": "2009-10-29T16:18:44Z", "is_private": false}]