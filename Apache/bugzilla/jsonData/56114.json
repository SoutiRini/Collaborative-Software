[{"count": 0, "tags": [], "text": "The method setAsActiveCell doesn't set the focus on the cell.\n\nIf you open Excel, it shows another cell (e.g. A1).\n\nThere's no difference between creating a new workbook and reading an existing xls file. The method doesn't set the cell active or it does but Excel ignores the selection?\n\nSimple Test case with a new workbook:\n\nWorkbook wb = new HSSFWorkbook();\nSheet sh = wb.createSheet();\n\nsh.createRow(0);\nsh.createRow(1);\nsh.createRow(2);\nsh.createRow(3);\n\nCell cell = sh.getRow(1).createCell(3);\nsh.getRow(3).createCell(3);\n\ncell.setAsActiveCell();\n\nFileOutputStream fos = new FileOutputStream(\"C:\\\\test.xls\");\n\nwb.write(fos);\n\nfos.close();\n\t\t\n//FileViewer.open(\"C:\\\\test.xls\");\n\nwb = WorkbookFactory.create(new File(\"C:\\\\test.xls\"));\nwb.getSheetAt(0).getRow(3).getCell(3).setAsActiveCell();\n\t\t\nfos = new FileOutputStream(\"C:\\\\test2.xls\");\n\nwb.write(fos);\n\nfos.close();\n\t\t\n//FileViewer.open(\"C:\\\\test2.xls\");\n\n\nAbove code works if you use new XSSFWorkbook() and \"xlsx\" as extension.", "is_private": false, "id": 172928, "creator": "rene.jahn@sibvisions.com", "time": "2014-02-06T17:08:05Z", "bug_id": 56114, "creation_time": "2014-02-06T17:08:05Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 56114, "attachment_id": null, "is_private": false, "id": 173850, "time": "2014-03-15T17:00:45Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2014-03-15T17:00:45Z", "text": "I tried this with LibreOffice, it did display the active cell correctly. I did not have a MS Excel available. \n\nThis was with the latest trunk version, \n\nI have added a unit-test for this at TestHSSFCell.testActiveCellBug56114() with r1577901.\n\nPlease retry this with the latest version and re-open if it still does not work for you."}, {"count": 2, "tags": [], "text": "Did a test with nightly build: poi-3.11-beta1-20140316.jar\n\nThe problem still exists. Works with XSSF but not with HSSF.", "is_private": false, "id": 173868, "creator": "rene.jahn@sibvisions.com", "time": "2014-03-17T11:39:47Z", "bug_id": 56114, "creation_time": "2014-03-17T11:39:47Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 56114, "attachment_id": null, "id": 175804, "time": "2014-06-13T14:56:02Z", "creator": "apache@gagravarr.org", "creation_time": "2014-06-13T14:56:02Z", "is_private": false, "text": "For someone who this affects, any chance you could:\n * Fire up Excel, and create a simple workbook, with a cell set as active (wb1)\n * Load that in POI, and save without making changes (wb2)\n * Load that in POI, change the active cell, save (wb3)\n * Load that in Excel, change the active cell, save (wb4)\n\nThen, use tools like hssf.dev.BiffViewer to see what record(s) Excel is using for the active cell, and what options / values on those records, and what POI is doing differently.\n\nThere will be some small differences between the files normally, which hopefully diffing things like wb1 and wb2 will allow excluding of, it's the parts around the active cell that need narrowing down to fix"}, {"count": 4, "tags": [], "creator": "rene.jahn@sibvisions.com", "text": "Created attachment 32136\nTest files\n\nwb1.xls (created with Excel)\n\nwb2.xls (read with POI, written with POI)\nwb1_wb3.xls (wb1 was the base for wb3) (read with POI, written with POI)\nwb2_wb3.xls (wb2 was the base for wb3) (read with POI, written with POI)\n\nwb2_wb3_wb4.xls (wb2_wb3 was the base for wb4) (created with Excel)", "id": 178672, "time": "2014-10-22T11:17:27Z", "bug_id": 56114, "creation_time": "2014-10-22T11:17:27Z", "is_private": false, "attachment_id": 32136}, {"count": 5, "tags": [], "creator": "rene.jahn@sibvisions.com", "attachment_id": null, "id": 178673, "time": "2014-10-22T11:18:02Z", "bug_id": 56114, "creation_time": "2014-10-22T11:18:02Z", "is_private": false, "text": "Tests files are attached."}, {"attachment_id": null, "tags": [], "creator": "vadimproga@gmail.com", "text": "The poi-3.15 has the same bug.\n\n If you take the two xls-files created by excel that differ only in activeCell and re-save them by poi, the hssf.dev.BiffViewer shows no differences between files, but excel opens new-created files with the original cell location.", "count": 6, "id": 195674, "time": "2016-12-28T07:14:41Z", "bug_id": 56114, "creation_time": "2016-12-28T07:14:41Z", "is_private": false}]