[{"count": 0, "tags": [], "creator": "llian@microstrat.com", "text": "Created attachment 28468\nsample document and screen shot related to this issue\n\nWhen adding custom properties to a Microsoft Office Word 97 - 2003 document, the properties are not displayed within office Word but visible with the Windows Explorer. Custom means the properties displayed on the \"Custom\" tab in the documents properties.\n\nThis used to be working perfectly in poi3.8.beta4. the issue is happening after upgrading to poi3.8.beta5.\n\nHere is the piece of code we are using to adding custom properties,\nFile doc1 = new File(\"test.dpc\");\n\t\tPOIFSFileSystem poifs = new POIFSFileSystem(new FileInputStream(doc1));\n\t\tDirectoryEntry dir = poifs.getRoot();\n\t\tDocumentEntry siEntry = (DocumentEntry) dir.getEntry(SummaryInformation.DEFAULT_STREAM_NAME);\n\t\tDocumentEntry dsiEntry = (DocumentEntry) dir.getEntry(DocumentSummaryInformation.DEFAULT_STREAM_NAME);\n\n\t\tDocumentInputStream dis = new DocumentInputStream(siEntry);\n\t\tPropertySet ps = new PropertySet(dis);\n\t\tSummaryInformation si = new SummaryInformation(ps);\n\t\tdis = new DocumentInputStream(dsiEntry);\n\t\tps = new PropertySet(dis);\n\t\tDocumentSummaryInformation dsi = new    DocumentSummaryInformation(ps);\n\t\tCustomProperties customProperties = dsi.getCustomProperties();\n\t\tif (customProperties == null)\n\t\t\tcustomProperties = new CustomProperties();\n\t\tcustomProperties.put(\"doc_repo_id\", \"123456789\");\n\n\t\t// Save as our custom properties\n\t\tdsi.setCustomProperties(customProperties);\n\t\tsi.write(dir, siEntry.getName());\n\t\tdsi.write(dir, dsiEntry.getName());\n\n\t\tFile output = new File(\"C:\\\\tempoutput.doc\");\n\t\tOutputStream out = new FileOutputStream(output);\n\t\tpoifs.writeFilesystem(out);\n\t\tout.close();\n\nAttached \"Test write custom properties.doc\", \n\"properties invisible from office.PNG\" and \"properties visible from Windows Explorer.PNG\" to show this issue.\n\nSame issue for excel document too refer to \"Test write custom properties2.xls\".\n\nIt seems the issue applies to all Microsoft Office Word 97 - 2003 document only.\nWe tested Word format docx which is Office 2007 and Office 2010 and it worked.\n\nRead more: http://www.differencebetween.com/difference-between-doc-and-vs-docx-in-microsoft-word/#ixzz1p8xFycgr\n\n\nThis issue is critical because our office component is heavily using custom properties to integrate with other application.", "id": 154920, "time": "2012-03-15T01:12:20Z", "bug_id": 52912, "creation_time": "2012-03-15T01:12:20Z", "is_private": false, "attachment_id": 28468}, {"count": 1, "tags": [], "bug_id": 52912, "attachment_id": null, "text": "Can you please try with the latest build from trunk? There have been fixes in HPFS recently. \n\nYegor", "id": 154924, "time": "2012-03-15T08:25:53Z", "creator": "yegor@dinom.ru", "creation_time": "2012-03-15T08:25:53Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 52912, "attachment_id": null, "text": "I tried with the latest build from trunk (poi-3.9-beta1) and it worked fine. \n\nThanks!\n\nLeon", "id": 155241, "time": "2012-03-22T18:06:31Z", "creator": "llian@microstrat.com", "creation_time": "2012-03-22T18:06:31Z", "is_private": false}]