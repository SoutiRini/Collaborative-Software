[{"count": 0, "tags": [], "bug_id": 38723, "is_private": false, "text": "Reproduce:\n- edit a document with BXE\n- save&exit\n- the changes are not reflected on the document\n\nThanks for a hint, Renaud", "id": 85966, "time": "2006-02-20T18:58:32Z", "creator": "renaud.richardet@wyona.com", "creation_time": "2006-02-20T18:58:32Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 38723, "is_private": false, "text": "Page is most likely being cached by your browser, try refreshing.  We should set\nthe cache control for the authoring area to not cache.  I have noticed this too\nsince the last modified date was formated properly.  This is good for the live\narea, not so good for authoring.", "id": 85967, "time": "2006-02-20T19:02:23Z", "creator": "dhc4z@virginia.edu", "creation_time": "2006-02-20T19:02:23Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 38723, "is_private": false, "id": 85983, "creation_time": "2006-02-20T22:48:34Z", "time": "2006-02-20T22:48:34Z", "creator": "renaud.richardet@wyona.com", "text": "Thanks Doug,\n\nThis is a caching problem indeed (refreshing the page did the trick). BTW\nOneform works without refreshing.\n\nIt is very strange, because I cannot reproduce this bug every time...\n\n> We should set the cache control for the authoring area to not cache.\nYes, makes sense. I am not sure where to do that, so that it affects the\nauthoring area only. I guess you are thinking about the publication sitemap,\nbecause all pipelines in the sitemap.xmap of the BXE module are of type noncaching. ", "attachment_id": null}, {"count": 3, "tags": [], "creator": "dhc4z@virginia.edu", "attachment_id": null, "id": 85986, "creation_time": "2006-02-20T23:22:21Z", "time": "2006-02-20T23:22:21Z", "bug_id": 38723, "text": "(In reply to comment #2)\n> Thanks Doug,\n> \n> This is a caching problem indeed (refreshing the page did the trick). BTW\n> Oneform works without refreshing.\n> \n> It is very strange, because I cannot reproduce this bug every time...\n> \n> > We should set the cache control for the authoring area to not cache.\n> Yes, makes sense. I am not sure where to do that, so that it affects the\n> authoring area only. I guess you are thinking about the publication sitemap,\n> because all pipelines in the sitemap.xmap of the BXE module are of type\nnoncaching. \n\nCaching needs to be disabled in the response headers or in the <head> for\ndocuments accessed in the authoring area.  I don't believe that the sitemaps are\ncaching, just the browser (client side caching).", "is_private": false}, {"count": 4, "tags": [], "bug_id": 38723, "text": "Isn't it already done within the publication sitemap?         \n <map:act type=\"set-header\">\n   <map:parameter name=\"Last-Modified\"\nvalue=\"{date-iso8601-rfc822:{page-envelope:document-lastmodified}}\" />\n", "id": 86062, "time": "2006-02-22T01:17:28Z", "creator": "renaud.richardet@wyona.com", "creation_time": "2006-02-22T01:17:28Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 38723, "is_private": false, "id": 86065, "creation_time": "2006-02-22T03:27:03Z", "time": "2006-02-22T03:27:03Z", "creator": "dhc4z@virginia.edu", "text": "(In reply to comment #4)\n> Isn't it already done within the publication sitemap?         \n>  <map:act type=\"set-header\">\n>    <map:parameter name=\"Last-Modified\"\n> value=\"{date-iso8601-rfc822:{page-envelope:document-lastmodified}}\" />\n> \n\nactually, I think that the addition of this header (correct formatting) is when\nI started to notice the browser caching.  Anyway, I added a Cache-Control:\nno-cache header to documents served from the authoring area (default pub\nsitemap).  It seems to have resolved my caching problems, please test ;)", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 38723, "text": "Found out now that a web browser calculates an expiry-time for a web page, using\nthe last modified date (if present). If a document has not expired, the browser\nwill not reload it from the server.\n(See http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html)\n\nThe heuristic algorithm is something like\nexpires = now + (date header - last modified header) / 10\n\nThis explains why the problem started when the last modified header was set\ncorrectly, and also why it only happened sometimes (when the last-modified date\nwas \"old\").\n\nSo Doug's solution seems to be the right one, and it worked in my tests.\n\n", "id": 86071, "time": "2006-02-22T10:17:27Z", "creator": "josias.thoeny@wyona.org", "creation_time": "2006-02-22T10:17:27Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 38723, "is_private": false, "text": "what's the cleanest way to overcome this problem? my current approach is to add\nsome cache-control meta tags to src/webapp/lenya/xslt/menu/menu2xslt.xsl (see\nattached patch). i believe this is the correct way to do it.\n\nplease review and, if it's ok, apply asap, since the current situation is\nabsolutely mystifying to users :-D\n\n", "id": 89279, "time": "2006-05-19T08:34:51Z", "creator": "nettings@apache.org", "creation_time": "2006-05-19T08:34:51Z", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 38723, "text": "Created attachment 18322\ndisables browser and proxy caching in the authoring area, so that users see their changes immediately.", "id": 89286, "time": "2006-05-19T12:25:43Z", "creator": "nettings@apache.org", "creation_time": "2006-05-19T12:25:43Z", "is_private": false, "attachment_id": 18322}, {"count": 9, "tags": [], "bug_id": 38723, "text": "it appears that the meta tags for cache control will not disable caching in\nfirefox in all cases: when leaving an editor or creating a new document, the\nchanges are visible immediately, but when you submit or publish etc., the\nbrowser still caches and you don't see the current workflow state until after a\nreload.\n\ni suspect that if you select http 1.1 support, firefox expects 1.1 conformant\ncache-control headers.\n\nafter adding the following action to my publication sitemap, firefox no longer\ncaches:\n<map:act type=\"set-header\">\n  <map:parameter name=\"Cache-Control\" value=\"no-cache\" />\n</map:act>\n\nthe question is: where do i add this in a clean way? i tried to find a global\nsitemap matcher that handles all requests in the authoring area, but couldn't\nfind one. please help!\n", "id": 89454, "time": "2006-05-24T19:28:05Z", "creator": "nettings@apache.org", "creation_time": "2006-05-24T19:28:05Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "creator": "andreas@apache.org", "attachment_id": null, "text": "AFAIK there is no specific \"authoring\" pipeline. But you could use a\nParameterSelector to check for {page-envelope:area} and invoke the action only\nif the area is \"authoring\".", "id": 89889, "time": "2006-06-07T15:42:35Z", "bug_id": 38723, "creation_time": "2006-06-07T15:42:35Z", "is_private": false}, {"count": 11, "tags": [], "creator": "nettings@apache.org", "attachment_id": null, "id": 89895, "creation_time": "2006-06-07T16:27:29Z", "time": "2006-06-07T16:27:29Z", "bug_id": 38723, "text": "(In reply to comment #10)\n> AFAIK there is no specific \"authoring\" pipeline. But you could use a\n> ParameterSelector to check for {page-envelope:area} and invoke the action only\n> if the area is \"authoring\".\n\nsorry, it appears that this bug has been fixed a while ago:\nhttp://svn.apache.org/viewvc/lenya/trunk/src/pubs/default/sitemap.xmap?revision=379396&view=markup\ni had not synced my custom sitemap to the trunk...\nthis fix solves the problem for me. sorry for the noise.\n\nbtw: the fix is in a part of the pipeline that is actually specific to the\nauthoring area.", "is_private": false}, {"count": 12, "tags": [], "bug_id": 38723, "text": "(In reply to comment #11)\n\n[...]\n\n> btw: the fix is in a part of the pipeline that is actually specific to the\n> authoring area.\n\nYes, because it's applied to the default publication's sitemap. The fix won't\nwork in other publications, unless they use the default pub as a template :(", "id": 89930, "time": "2006-06-08T08:04:37Z", "creator": "andreas@apache.org", "creation_time": "2006-06-08T08:04:37Z", "is_private": false, "attachment_id": null}, {"count": 13, "tags": [], "creator": "nettings@apache.org", "attachment_id": null, "text": "(In reply to comment #12)\n> Yes, because it's applied to the default publication's sitemap. The fix won't\n> work in other publications, unless they use the default pub as a template :(\n\ntrue. we need to move more functionality out of the default template and into\nthe core, but i think for now the recommended practice should be to sync one's\ncustom sitemaps with the default one regularly, so as not to miss important\nfixes (which happened to me in the case of this bug). i have since taken to\nmaintaining my own sitemap as a diff against the default one.", "id": 89966, "time": "2006-06-08T17:27:48Z", "bug_id": 38723, "creation_time": "2006-06-08T17:27:48Z", "is_private": false}, {"count": 14, "tags": [], "bug_id": 38723, "text": "Renaming Lenya 1.4 to 2.0", "id": 105511, "time": "2007-07-16T01:58:58Z", "creator": "thorsten@apache.org", "creation_time": "2007-07-16T01:58:58Z", "is_private": false, "attachment_id": null}]