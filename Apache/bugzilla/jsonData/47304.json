[{"attachment_id": null, "tags": [], "bug_id": 47304, "text": "When using the following code to read the attached word document the text is not read correctly on macosx\n\nWordDocument wordDoc = new WordDocument(new FileInputStream(\"test.doc\"));\n\nStringWriter docTextWriter = new StringWriter();\nwordDoc.writeAllText(new PrintWriter(docTextWriter));\nwordDoc.writeAllText(writer);\ndocTextWriter.close();\n\nSystem.out.println(docTextWriter.toString());\n\n\nThe reason for this is that the  platform default encoding is used to read the document when the text found is not unicode while windows-1252 should be used\n\nHere's the offending code\n\nif(unicode)\n{\n ....\n}\nelse\n{\n   String sText = new String(_header, start, end-start);\n   out.write(sText);\n}\n\nOn windows the platform default encoding is windows-1252, on osx it's macroman\n\nTo fix this \n\n\nString sText = new String(_header, start, end-start);\n\nshould be changed to\n\nString sText = new String(_header, start, end-start, \"windows-1252\");", "count": 0, "id": 127575, "time": "2009-06-02T22:32:10Z", "creator": "jelmer@jteam.nl", "creation_time": "2009-06-02T22:32:10Z", "is_private": false}, {"count": 1, "tags": [], "creator": "jelmer@jteam.nl", "attachment_id": 23746, "id": 127576, "time": "2009-06-02T22:33:23Z", "bug_id": 47304, "creation_time": "2009-06-02T22:33:23Z", "is_private": false, "text": "Created attachment 23746\nexample"}, {"count": 2, "tags": [], "bug_id": 47304, "text": "I have applied the suggested fix with r1668367, although WordDocument is deprecated nowadays in favour of WordExtractor and HWPFDocument. WordExtractor handles this correctly already as far as I see.", "id": 181941, "time": "2015-03-22T13:34:06Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-03-22T13:34:06Z", "is_private": false, "attachment_id": null}]