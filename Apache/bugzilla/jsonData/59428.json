[{"count": 0, "tags": [], "creator": "ijuan.rm@gmail.com", "text": "I'm trying to create .xlsx documents with the Apache POI 3.14 library.\n\nThis is my Gradle config:\n\n(...)    \ndefaultConfig {\n            applicationId \"com.example.app\"\n            minSdkVersion 14\n            targetSdkVersion 19\n\n            multiDexEnabled true\n\n        }\n\n        buildTypes {\n            release {\n                minifyEnabled true\n                proguardFiles getDefaultProguardFile('proguard-android.txt')\n                proguardFile 'Path/app/proguard-rules.pro'\n            }\n        }\n    }\n\n    dependencies {\n        compile 'com.android.support:appcompat-v7:22.2.0'\n        compile 'com.android.support:multidex:1.0.1'\n        //compile files('libs/android-support-v13.jar')\n        compile files('libs/commons-io-2.4.jar')\n        compile files('libs/commons-net-3.3.jar')\n        compile files('libs/poi-3.14-20160307.jar')\n        compile files('libs/poi-ooxml-3.14-20160307.jar')\n        compile files('libs/poi-ooxml-schemas-3.14-20160307.jar')\n        compile files('libs/xmlbeans-2.6.0.jar')\n        compile files('libs/curvesapi-1.03.jar')\n        compile files('libs/commons-codec-1.10.jar')\n        compile files('libs/commons-logging-1.2.jar')\n        compile files('libs/junit-4.12.jar')\n        compile files('libs/log4j-1.2.17.jar')\n        compile 'com.roomorama:caldroid:2.3.1'\n\n    }\nWith the original xmlbeans library xmlbeans-2.6.0.jar I get this exception when I try to run APP\n\nError:Execution failed for task ':app:transformClassesWithJarMergingForDebug'.\n> com.android.build.api.transform.TransformException: java.util.zip.ZipException: duplicate entry: org/apache/xmlbeans/xml/stream/Location.class\nI've tried to remove the duplicated class with this method\n\n-Unzip the jar file. (Simply change .jar extension to .zip\n-This will remove the duplicate files.\n-Recreate the jar using jar cf xmlbeans.jar -C (path to unzipped folder) . (Mind it, there is a dot in the end of command)\n-Use this regenerated jar\nWhen I try to run the app with this recompiled .jar I get this warnings but even so it is launched to the device\n\n    Error:warning: Ignoring InnerClasses attribute for an anonymous inner class\n    Error:(org.apache.xmlbeans.impl.inst2xsd.RussianDollStrategy$1) that doesn't come with an\n    Error:associated EnclosingMethod attribute. This class was probably produced by a\n    Error:compiler that did not target the modern .class file format. The recommended\n    Error:solution is to recompile the class from source, using an up-to-date compiler\n    Error:and without specifying any \"-target\" type options. The consequence of ignoring\n    Error:this warning is that reflective operations on this class will incorrectly\n    Error:indicate that it is *not* an inner class.\n(...)\nThen when in my code try to do :\n\nXSSFWorkbook wb = new XSSFWorkbook();\nI get this exception and closes the app\n\n     Caused by: java.lang.NoClassDefFoundError: javax.xml.stream.XMLEventFactory\n    at org.apache.poi.openxml4j.opc.internal.marshallers.PackagePropertiesMarshaller.<clinit>(PackagePropertiesMarshaller.java:41)\n at org.apache.poi.openxml4j.opc.OPCPackage.init(OPCPackage.java:162) \n at org.apache.poi.openxml4j.opc.OPCPackage.<init>(OPCPackage.java:142) \n at org.apache.poi.openxml4j.opc.Package.<init>(Package.java:37) \n at org.apache.poi.openxml4j.opc.ZipPackage.<init>(ZipPackage.java:67) \n at org.apache.poi.openxml4j.opc.OPCPackage.create(OPCPackage.java:344) \n at org.apache.poi.xssf.usermodel.XSSFWorkbook.newPackage(XSSFWorkbook.java:453) \n at org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:226) \n at org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:218) \n at com.asde.armatest.persistency.AsyncExcelFile.doInBackground(AsyncExcelFile.java:285) \nWhat would be wrong?", "id": 190718, "time": "2016-05-04T10:10:15Z", "bug_id": 59428, "creation_time": "2016-05-04T10:10:15Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 59428, "text": "The same was posted at http://stackoverflow.com/questions/37023667/xml-beans-2-6-exception-with-excel-creation-on-android\n\nIt is a possible duplicate discussion of http://stackoverflow.com/questions/36596776/poi-duplicate-entry-org-apache-xmlbeans-xml-stream-bindigconfig-class \n\nWhich in turn links back to https://github.com/andruhon/android5xlsx as possible workaround and bug 59268 as the discussion in POI to avoid this problem.\n\nSo this bug is mostly not a problem of POI itself and there is ongoing discussion in another bug about a fix for XmlBeans, therefore I am closing this one as duplicate.\n\n*** This bug has been marked as a duplicate of bug 59268 ***", "id": 190723, "attachment_id": null, "creator": "dominik.stadler@gmx.at", "creation_time": "2016-05-04T14:54:54Z", "time": "2016-05-04T14:54:54Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 59428, "attachment_id": null, "is_private": false, "id": 190725, "time": "2016-05-04T16:10:45Z", "creator": "ijuan.rm@gmail.com", "creation_time": "2016-05-04T16:10:45Z", "text": "I've already tested this repo\nhttps://github.com/andruhon/android5xlsx\n\nWith different result but still with problems. If you want you could check my reported issue to this repo:\n\nhttps://github.com/andruhon/android5xlsx/issues/4\n\nThanks a lot"}]