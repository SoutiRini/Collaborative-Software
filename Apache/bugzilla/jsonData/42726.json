[{"count": 0, "text": "I downloaded poi-3.0-rc4 created a simple xls file using OpenOffice started\norg/apache/poi/hpsf/examples/CopyCompare passing the example xls on the command\nline. This resulted in jvm termination with java.lang.NegativeArraySizeException\n thrown from line 251 of VariantSupport.java\n\nRunning CopyCompare in the eclipse debugger I see that\norg/apache/poi/hwpf/usermodel/Section.java assigns a negative value to\nple.length and passes it to new Property which winds up in VariantSupport\nwhich in turn tries to size an array based on this negative value.\n\nStack Trace:\n\nException in thread \"main\" java.lang.NegativeArraySizeException\n\tat org.apache.poi.hpsf.VariantSupport.read(VariantSupport.java:251)\n\tat org.apache.poi.hpsf.Property.<init>(Property.java:163)\n\tat org.apache.poi.hpsf.Section.<init>(Section.java:281)\n\tat org.apache.poi.hpsf.PropertySet.init(PropertySet.java:454)\n\tat org.apache.poi.hpsf.PropertySet.<init>(PropertySet.java:249)\n\tat org.apache.poi.hpsf.PropertySetFactory.create(PropertySetFactory.java:61)\n\tat\norg.apache.poi.hpsf.examples.CopyCompare$CopyFile.processPOIFSReaderEvent(CopyCompare.java:359)\n\tat\norg.apache.poi.poifs.eventfilesystem.POIFSReader.processProperties(POIFSReader.java:261)\n\tat org.apache.poi.poifs.eventfilesystem.POIFSReader.read(POIFSReader.java:97)\n\tat org.apache.poi.hpsf.examples.CopyCompare.main(CopyCompare.java:139)", "bug_id": 42726, "is_private": false, "id": 104649, "time": "2007-06-22T20:31:41Z", "creator": "dherring@dherring.com", "creation_time": "2007-06-22T20:31:41Z", "tags": [], "attachment_id": null}, {"attachment_id": 20391, "tags": [], "creator": "dherring@dherring.com", "is_private": false, "count": 1, "id": 104650, "time": "2007-06-22T20:40:52Z", "bug_id": 42726, "creation_time": "2007-06-22T20:40:52Z", "text": "Created attachment 20391\nInput file\n\nThe file (bzipped) which caused the exception"}, {"count": 2, "tags": [], "text": "Will have a look at it.", "is_private": false, "bug_id": 42726, "id": 104651, "time": "2007-06-22T22:19:48Z", "creator": "klute@apache.org", "creation_time": "2007-06-22T22:19:48Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 42726, "attachment_id": null, "id": 104652, "time": "2007-06-23T00:54:13Z", "creator": "klute@apache.org", "creation_time": "2007-06-23T00:54:13Z", "is_private": false, "text": "The error is in the data: property set stream is larger than it claims to be. I\nadded a consistency check to the code base which throws an appropriate\nexception. If you generated your file with a recent OpenOffice.org release, you\nshould file a bug report for it."}, {"count": 4, "tags": [], "bug_id": 42726, "attachment_id": null, "id": 129814, "time": "2009-08-20T06:50:33Z", "creator": "yegor@dinom.ru", "creation_time": "2009-08-20T06:50:33Z", "is_private": false, "text": "\n\n*** This bug has been marked as a duplicate of bug 45583 ***"}]