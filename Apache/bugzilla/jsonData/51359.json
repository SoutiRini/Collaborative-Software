[{"count": 0, "tags": [], "text": "Created attachment 27147\nmod_win32_js_cgi_for_trunk\n\nRelated to this addition in Apache 2.2.18:\n  *) mod_win32: Added shebang check for '! so that .vbs scripts work as CGI.\n     Win32's cscript interpreter can only use a single quote as comment char.\n     [Guenter Knauf]\n\nI've also added handling for //! so that .js scripts work as CGI.", "is_private": false, "bug_id": 51359, "id": 147032, "time": "2011-06-11T15:48:31Z", "creator": "kmashint@yahoo.com", "creation_time": "2011-06-11T15:48:31Z", "attachment_id": 27147}, {"count": 1, "attachment_id": 27148, "bug_id": 51359, "text": "Created attachment 27148\nmod_win32_js_cgi_for_2_2_19", "id": 147033, "time": "2011-06-11T15:49:17Z", "creator": "kmashint@yahoo.com", "creation_time": "2011-06-11T15:49:17Z", "tags": [], "is_private": false}, {"count": 2, "attachment_id": 27149, "bug_id": 51359, "is_private": false, "id": 147034, "time": "2011-06-11T15:49:45Z", "creator": "kmashint@yahoo.com", "creation_time": "2011-06-11T15:49:45Z", "tags": [], "text": "Created attachment 27149\nmod_win32_js_cgi_for_trunk"}, {"count": 3, "tags": [], "creator": "kmashint@yahoo.com", "text": "I've tested with simple cgi-bin/test.js that works to launch the script with cscript.exe //nologo.\n\n//!cscript.exe //nologo\nWScript.Echo(\"Content-Type: text/plain\");\nWScript.Echo(\"\");\nWScript.Echo(\"Hello World!\");", "id": 147126, "time": "2011-06-15T04:28:15Z", "bug_id": 51359, "creation_time": "2011-06-15T04:28:15Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "eflash@gmx.net", "text": "You can now already run JScript code if you wrap it into a wsf file; f.e. create a testjs.wsf in cgi-bin folder with content:\n'!c:/windows/system32/cscript -nologo\n<job>\n<script language=\"JScript\">\n  WSH.Echo(\"Content-type: text/plain\\n\");\n  WSH.Echo(\"Hello world from \" + ScriptEngine() + \" !\");\n</script>\n</job>\n\nisnt this sufficient?", "id": 162333, "time": "2012-09-21T16:31:19Z", "bug_id": 51359, "creation_time": "2012-09-21T16:31:19Z", "is_private": false, "attachment_id": null}, {"count": 5, "attachment_id": 31833, "bug_id": 51359, "is_private": false, "id": 176531, "time": "2014-07-19T20:10:23Z", "creator": "kmashint@yahoo.com", "creation_time": "2014-07-19T20:10:23Z", "tags": [], "text": "Created attachment 31833\nI've added a patch for 2.5-HEAD."}, {"count": 6, "tags": [], "bug_id": 51359, "attachment_id": null, "is_private": false, "id": 176532, "time": "2014-07-19T20:24:41Z", "creator": "kmashint@yahoo.com", "creation_time": "2014-07-19T20:24:41Z", "text": "As to the use of  *.wsf, this does seems to work but is a bit awkward having Javascript within XML.  Also, allowing //! for JS files would allow for other *.js engines to run on other platforms, e.g. launching node x.js if desired.\n\nThat said, this hack does seem to work, having a trailing single-quote to appease JScript compilation while allowing for the vbscript style comment.\n\n'!c:/windows/system32/cscript -nologo test.js '\nWSH.Echo(\"Content-type: text/plain\\n\");\nWSH.Echo(\"Hello world from \" + ScriptEngine() + \" !\");\n\nGiven the dwindling support for older Windows Scripting, it's not a high priority and can be closed."}]