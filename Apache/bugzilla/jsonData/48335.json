[{"count": 0, "tags": [], "creator": "thibd@paygate.net", "text": "Dear all,\n\nMy application encrypt a document and then decrypt it. It works well in Windows system. When I deployed my app to Solaris, I got this error message: \n\njava.security.InvalidKeyException: Wrong format: RAW bytes needed\n        at com.sun.crypto.provider.SunJCE_f.a(DashoA13*..)\n        at com.sun.crypto.provider.SunJCE_f.a(DashoA13*..)\n        at com.sun.crypto.provider.AESCipher.engineInit(DashoA13*..)\n        at javax.crypto.Cipher.init(DashoA13*..)\n        at javax.crypto.Cipher.init(DashoA13*..)\n        at org.apache.xml.security.encryption.XMLCipher.decryptToByteArray(Unknown Source)\n        at org.apache.xml.security.encryption.XMLCipher.decryptElement(Unknown Source)\n        at org.apache.xml.security.encryption.XMLCipher.doFinal(Unknown Source)\n        at net.paygate.xml.XMLEncrypt.decrypt(Unknown Source)\n        at net.paygate.xml.hsm.XMLHSMSecure.decryptInHSM(Unknown Source)\n\n----------------------------------\nThis is the debug information:\n\n INFO [main] (?:?) - Logging in HSM\n297570 [main] INFO net.paygate.xml.hsm.HSM_Manager  - Logging in HSM\nDEBUG [main] (?:?) - Number of Slots: 1\n297572 [main] DEBUG net.paygate.xml.hsm.HSM_Manager  - Number of Slots: 1\nDEBUG [main] (?:?) - Slot: 1 Token Label: partition01\n297586 [main] DEBUG net.paygate.xml.hsm.HSM_Manager  - Slot: 1 Token Label: partition01\nDEBUG [main] (?:?) - Start decryption by HSM\n297602 [main] DEBUG net.paygate.xml.hsm.XMLHSMSecure  - Start decryption by HSM\nDEBUG [main] (?:?) - Getting key from HSM\n297604 [main] DEBUG net.paygate.util.PUtil  - Getting key from HSM\nDEBUG [main] (?:?) - Key alias: PayGate RSA Private Key\n297606 [main] DEBUG net.paygate.util.PUtil  - Key alias: PayGate RSA Private Key\nDEBUG [main] (?:?) - Start decryption\n297614 [main] DEBUG net.paygate.xml.XMLEncrypt  - Start decryption\nDEBUG [main] (?:?) - Getting XMLCipher for no transformation...\n297619 [main] DEBUG org.apache.xml.security.encryption.XMLCipher  - Getting XMLCipher for no transformation...\nDEBUG [main] (?:?) - Constructing XMLCipher...\n297621 [main] DEBUG org.apache.xml.security.encryption.XMLCipher  - Constructing XMLCipher...\nDEBUG [main] (?:?) - Initializing XMLCipher...\n297623 [main] DEBUG org.apache.xml.security.encryption.XMLCipher  - Initializing XMLCipher...\nDEBUG [main] (?:?) - opmode = DECRYPT_MODE\n297625 [main] DEBUG org.apache.xml.security.encryption.XMLCipher  - opmode = DECRYPT_MODE\nDEBUG [main] (?:?) - Processing source element...\n297627 [main] DEBUG org.apache.xml.security.encryption.XMLCipher  - Processing source element...\nDEBUG [main] (?:?) - Decrypting element...\n297630 [main] DEBUG org.apache.xml.security.encryption.XMLCipher  - Decrypting element...\nDEBUG [main] (?:?) - Decrypting to ByteArray...\n297632 [main] DEBUG org.apache.xml.security.encryption.XMLCipher  - Decrypting to ByteArray...\nDEBUG [main] (?:?) - setElement(\"ds:KeyInfo\", \"null\")\n297637 [main] DEBUG org.apache.xml.security.utils.ElementProxy  - setElement(\"ds:KeyInfo\", \"null\")\nDEBUG [main] (?:?) - Try org.apache.xml.security.keys.keyresolver.implementations.EncryptedKeyResolver\n297640 [main] DEBUG org.apache.xml.security.keys.KeyInfo  - Try org.apache.xml.security.keys.keyresolver.implementations.EncryptedKeyResolver\nDEBUG [main] (?:?) - EncryptedKeyResolver - Can I resolve xenc:EncryptedKey\n297642 [main] DEBUG org.apache.xml.security.keys.keyresolver.implementations.RSAKeyValueResolver  - EncryptedKeyResolver - Can I resolve xenc:EncryptedKey\nDEBUG [main] (?:?) - Passed an Encrypted Key\n297645 [main] DEBUG org.apache.xml.security.keys.keyresolver.implementations.RSAKeyValueResolver  - Passed an Encrypted Key\nDEBUG [main] (?:?) - Getting XMLCipher for no transformation...\n297647 [main] DEBUG org.apache.xml.security.encryption.XMLCipher  - Getting XMLCipher for no transformation...\nDEBUG [main] (?:?) - Constructing XMLCipher...\n297649 [main] DEBUG org.apache.xml.security.encryption.XMLCipher  - Constructing XMLCipher...\nDEBUG [main] (?:?) - Initializing XMLCipher...\n297652 [main] DEBUG org.apache.xml.security.encryption.XMLCipher  - Initializing XMLCipher...\nDEBUG [main] (?:?) - opmode = UNWRAP_MODE\n297654 [main] DEBUG org.apache.xml.security.encryption.XMLCipher  - opmode = UNWRAP_MODE\nDEBUG [main] (?:?) - Loading encrypted key...\n297657 [main] DEBUG org.apache.xml.security.encryption.XMLCipher  - Loading encrypted key...\nDEBUG [main] (?:?) - Decrypting key from previously loaded EncryptedKey...\n297661 [main] DEBUG org.apache.xml.security.encryption.XMLCipher  - Decrypting key from previously loaded EncryptedKey...\nDEBUG [main] (?:?) - Encrypted octets:\nGy3fFVo76owt0M1rg/2mLD1cD+TKLf9i1VMqU1cM+NVvbDqXuT47gyXUOyUXL5ujeaVWnu8yAw2T\nPAHgku+DWYP+bfzF4xzqw99gn6DFtMmt04yseHqXuG5DrbIb0Nwg44H5mmacSPeUMu2HVhIQMsKy\neJxBLE2PPRURiWIu6Rk=\n297663 [main] DEBUG org.apache.xml.security.encryption.XMLCipher  - Encrypted octets:\nGy3fFVo76owt0M1rg/2mLD1cD+TKLf9i1VMqU1cM+NVvbDqXuT47gyXUOyUXL5ujeaVWnu8yAw2T\nPAHgku+DWYP+bfzF4x**************\nDEBUG [main] (?:?) - Request for URI http://www.w3.org/2001/04/xmlenc#rsa-1_5\n297666 [main] DEBUG org.apache.xml.security.algorithms.JCEMapper  - Request for URI http://www.w3.org/2001/04/xmlenc#rsa-1_5\nDEBUG [main] (?:?) - JCE Algorithm = RSA/ECB/PKCS1Padding\n297669 [main] DEBUG org.apache.xml.security.encryption.XMLCipher  - JCE Algorithm = RSA/ECB/PKCS1Padding\nDEBUG [main] (?:?) - Decryption of key type http://www.w3.org/2001/04/xmlenc#aes128-cbc OK\n298093 [main] DEBUG org.apache.xml.security.encryption.XMLCipher  - Decryption of key type http://www.w3.org/2001/04/xmlenc#aes128-cbc OK\nDEBUG [main] (?:?) - I could find a secret key using the per-KeyInfo key resolvers\n298095 [main] DEBUG org.apache.xml.security.keys.KeyInfo  - I could find a secret key using the per-KeyInfo key resolvers\nDEBUG [main] (?:?) - Encrypted octets:\n47buYDgGAsM819iSd9CMJQNmNYpyOErWD+7UZ2IGexC4sETvuCqw7J3YOnTSMlz4CZQj1QXwx0nV\ngSvbaAYWzTZHHmGe9YIgmH+DNqd+rJJC2azLgkGyAlP71Ai1GGtTSxk6e6MRklv/BvbqxAgdVxvp\nSSsDUvhUHvePMbIfhwp64VtdiwmC4DE7N8GK********\n298098 [main] DEBUG org.apache.xml.security.encryption.XMLCipher  - Encrypted octets:\n47buYDgGAsM819iSd9CMJQNmNYpyOErWD+7UZ2IGexC4sETvuCqw7J3YOnTSMlz4CZQj1QXwx0nV\ngSvbaAYWzTZHHmGe9YIgmH+DNqd+rJJC2azL******\nDEBUG [main] (?:?) - Request for URI http://www.w3.org/2001/04/xmlenc#aes128-cbc\n298101 [main] DEBUG org.apache.xml.security.algorithms.JCEMapper  - Request for URI http://www.w3.org/2001/04/xmlenc#aes128-cbc\nERROR [main] (?:?) - org.apache.xml.security.encryption.XMLEncryptionException: Wrong format: RAW bytes needed\nOriginal Exception was java.security.InvalidKeyException: Wrong format: RAW bytes needed\n298115 [main] ERROR net.paygate.xml.hsm.XMLHSMSecure  - org.apache.xml.security.encryption.XMLEncryptionException: Wrong format: RAW bytes needed\nOriginal Exception was java.security.InvalidKeyException: Wrong format: RAW bytes needed\n------------------------------------\nI could not find solve this issue.\nCould you please give me some suggestions solve it?\n\nThank in advance!", "id": 132597, "time": "2009-12-02T22:41:55Z", "bug_id": 48335, "creation_time": "2009-12-02T22:41:55Z", "is_private": false, "attachment_id": null}]