[{"count": 0, "tags": [], "creator": "monkevic@gmail.com", "text": "Then open existing docx document as XWPFDocument, On onDocumentRead method  initFootnotes method dublicate existing Footnotes in document.\n\nHere is a sample code with comments where there is a duplication:\n\nprivate void initFootnotes() throws XmlException, IOException {\n       for(POIXMLDocumentPart p : getRelations()){\n          String relation = p.getPackageRelationship().getRelationshipType();\n          if (relation.equals(XWPFRelation.FOOTNOTE.getRelation())) {\n             FootnotesDocument footnotesDocument = FootnotesDocument.Factory.parse(p.getPackagePart().getInputStream());\n             this.footnotes = (XWPFFootnotes)p;\n             this.footnotes.onDocumentRead();      // THERE ARE WE ALREADY HAVE XWPFFootnotes WITH ALL DOCUMENT FOOTNOTES\n\n             for(CTFtnEdn ctFtnEdn : footnotesDocument.getFootnotes().getFootnoteList()) {\n                footnotes.addFootnote(ctFtnEdn);   // THERE ARE FOOTNOTES IS DUBLICATING\n             }\n          } else if (relation.equals(XWPFRelation.ENDNOTE.getRelation())){\n             EndnotesDocument endnotesDocument = EndnotesDocument.Factory.parse(p.getPackagePart().getInputStream());\n\n             for(CTFtnEdn ctFtnEdn : endnotesDocument.getEndnotes().getEndnoteList()) {\n                endnotes.put(ctFtnEdn.getId().intValue(), new XWPFFootnote(this, ctFtnEdn));\n             }\n          }\n       }\n    }", "id": 167690, "time": "2013-06-06T07:17:42Z", "bug_id": 55066, "creation_time": "2013-06-06T07:17:42Z", "is_private": false, "attachment_id": null}, {"count": 1, "attachment_id": null, "bug_id": 55066, "text": "Agreed.  I noticed this while working on https://issues.apache.org/bugzilla/show_bug.cgi?id=54849. I've fixed the footnote duplication in 54849. Once that is commited, this issue will be fixed.\n\nProbably better practice (on my part) to have started a separate issue as you've done here.  Thank you!", "id": 167694, "time": "2013-06-06T12:27:58Z", "creator": "tallison@mitre.org", "creation_time": "2013-06-06T12:27:58Z", "tags": [], "is_private": false}, {"count": 2, "attachment_id": 30465, "bug_id": 55066, "text": "Created attachment 30465\nSimple testcase\n\nTestcase to prove that this issue was fixed in a patch for another issue.", "id": 167920, "time": "2013-06-20T00:04:34Z", "creator": "tallison@mitre.org", "creation_time": "2013-06-20T00:04:34Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "creator": "tallison@mitre.org", "text": "Fixed in patch for 54849.  Testcase attached.  Thank you, Nick!", "id": 167921, "time": "2013-06-20T00:05:40Z", "bug_id": 55066, "creation_time": "2013-06-20T00:05:40Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "text": "Thanks for this test Tim! Patch applied (with minor tweaks - the bug number for a test normally goes in the javadocs or method name) in r1494962.", "is_private": false, "id": 167924, "creator": "apache@gagravarr.org", "time": "2013-06-20T12:51:38Z", "bug_id": 55066, "creation_time": "2013-06-20T12:51:38Z", "attachment_id": null}]