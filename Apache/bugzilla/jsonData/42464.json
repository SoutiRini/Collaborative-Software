[{"count": 0, "tags": [], "creator": "david.karr@wamu.net", "attachment_id": null, "id": 103392, "time": "2007-05-20T14:00:35Z", "bug_id": 42464, "creation_time": "2007-05-20T14:00:35Z", "is_private": false, "text": "I'm using v3.0-rc4.  I have a app that uses POI that I've been using to parse\nspreadsheets and generate data from.  I just got a new version of the\nspreadsheet with some innocuous changes, and it now fails with the exception\nthat follows this.  I would provide this spreadsheet in the bug, but it has\ncustomer data in it.  I would try to narrow down the test case, but I don't even\nknow what this exception means, so I'm not sure what to remove from the test case.\n\norg.apache.poi.hssf.record.RecordFormatException: Coding Error: Expected ExpPtg\nto be converted from Shared to Non-Shared Formula\n\tat org.apache.poi.hssf.record.formula.ExpPtg.toFormulaString(ExpPtg.java:78)\n\tat org.apache.poi.hssf.model.FormulaParser.toFormulaString(FormulaParser.java:886)\n\tat org.apache.poi.hssf.model.FormulaParser.toFormulaString(FormulaParser.java:868)\n\tat org.apache.poi.hssf.usermodel.HSSFCell.getCellFormula(HSSFCell.java:630)\n\tat\ncom.wamu.uia.riskrating.genmessages.GenRiskRatingMessageFiles.getCellValue(GenRiskRatingMessageFiles.java:1032)\n\tat\ncom.wamu.uia.riskrating.genmessages.GenRiskRatingMessageFiles.getCellValue(GenRiskRatingMessageFiles.java:1069)\n\tat\ncom.wamu.uia.riskrating.genmessages.GenRiskRatingMessageFiles.buildLoanData(GenRiskRatingMessageFiles.java:933)\n\tat\ncom.wamu.uia.riskrating.genmessages.GenRiskRatingMessageFiles.go(GenRiskRatingMessageFiles.java:356)\n\tat\ncom.wamu.uia.riskrating.genmessages.GenRiskRatingMessageFiles.main(GenRiskRatingMessageFiles.java:247)"}, {"count": 1, "tags": [], "creator": "david.karr@wamu.net", "attachment_id": 20222, "id": 103394, "time": "2007-05-20T15:19:01Z", "bug_id": 42464, "creation_time": "2007-05-20T15:19:01Z", "is_private": false, "text": "Created attachment 20222\nThis is a \"sanitized\" version of the spreadsheet that causes the problem"}, {"count": 2, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "Are you able to do another version of this spreadsheet that's almost the same,\nbut doesn't trigger the bug?\n\nIdeally, we want two very similar versions of the spreadsheet, one which\ntriggers the bug, and one that doesn't. That way, it'll be much easier for us to\nspot what area the change lies in, to narrow down what's wrong.", "id": 111692, "time": "2007-12-12T03:57:20Z", "bug_id": 42464, "creation_time": "2007-12-12T03:57:20Z", "is_private": false}, {"count": 3, "tags": [], "creator": "david.karr@wamu.net", "attachment_id": null, "is_private": false, "id": 111696, "time": "2007-12-12T06:38:32Z", "bug_id": 42464, "creation_time": "2007-12-12T06:38:32Z", "text": "It simply has to do with the number of columns.  If I remove columns one by one,\nit will get to a state where the bug doesn't occur.  It's been a while since\nI've looked at this, but I'm pretty sure it's only when accessing those \"wide\"\ncolumns that it happens.  Accessing the initial columns doesn't trigger the bug.\n If that's not enough info, I can try setting up this test case again and\ngenerate a sheet with the maximum number of columns that doesn't trigger the bug."}, {"count": 4, "text": "If you could knock out some columns until you have a sheet with n columns that\nworks, and n+1 columns that doesn't, then that'd be great.\n\n(We want to get the two sheets as similar as possible, but have one work\ncompletely, and the other not. Only having a sheet where some columns work and\nsome don't leaves a few more unknown variables than we'd like)", "bug_id": 42464, "attachment_id": null, "id": 111697, "time": "2007-12-12T06:44:55Z", "creator": "apache@gagravarr.org", "creation_time": "2007-12-12T06:44:55Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "bug_id": 42464, "attachment_id": 21265, "is_private": false, "id": 111721, "time": "2007-12-12T13:13:45Z", "creator": "david.karr@wamu.net", "creation_time": "2007-12-12T13:13:45Z", "text": "Created attachment 21265\nAnt-based test case that demonstrates both a \"good\" and \"bad\" spreadsheet\n\nThis test case does not include the poi jar files.  They have to be copied into\nthe \"lib\" directory, and then modify the \"build.properties\" file.  This\ninformation is echoed in the README.txt file in the zip file."}, {"count": 6, "tags": [], "text": "Finally fixed in trunk\n\nEventually tracked it down to the silliest of things - using a signed 8 bit\nvalue instead of an unsigned 8 bit value, so very long columns weren't being\nmatched to their shared formulas, as the shared formula ran to column -127...\n\nWith the signing issue fixed, we can parse the formula on both spreadsheets", "is_private": false, "id": 112654, "creator": "apache@gagravarr.org", "time": "2008-01-08T15:02:51Z", "bug_id": 42464, "creation_time": "2008-01-08T15:02:51Z", "attachment_id": null}]