[{"count": 0, "tags": [], "bug_id": 61297, "text": "Created attachment 35132\ngot this message: this error should NEVER happen!\n\nI was trying to copy some row of data from one part of sheet to another and then save it to another workbook and I got this error. As it said error should NEVER Happen I filed this report. Will see what I did wrong.\n\nrun:\nstart test\nnumber of sheets=1\nsheet=template_4_8_16\nrow= 0 27\nrow=3 no. cells=11 new= 26\n... copy rows\nrow=4 no. cells=11 new= 27\n... copy rows\nException in thread \"main\" org.apache.poi.openxml4j.exceptions.OpenXML4JRuntimeException: Rule M2.4 exception : this error should NEVER happen! If you can provide the triggering file, then please raise a bug at https://bz.apache.org/bugzilla/enter_bug.cgi?product=POI and attach the file that triggers it, thanks!\n\tat org.apache.poi.openxml4j.opc.internal.ContentTypeManager.getContentType(ContentTypeManager.java:340)\n\tat org.apache.poi.openxml4j.opc.internal.ContentTypeManager.removeContentType(ContentTypeManager.java:253)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.removePart(OPCPackage.java:1020)\n\tat org.apache.poi.openxml4j.opc.PackagePart.getOutputStream(PackagePart.java:519)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.commit(XSSFWorkbook.java:1826)\n\tat org.apache.poi.POIXMLDocumentPart.onSave(POIXMLDocumentPart.java:414)\n\tat org.apache.poi.POIXMLDocument.write(POIXMLDocument.java:242)\n\tat modelbacktest_excel.ModelBackTest_excel.main(ModelBackTest_excel.java:53)\nJava Result: 1", "id": 199776, "time": "2017-07-13T21:50:06Z", "creator": "ted.ji@wellsfargo.com", "creation_time": "2017-07-13T21:50:06Z", "is_private": false, "attachment_id": 35132}, {"count": 1, "tags": [], "bug_id": 61297, "text": "Hi Ted,\nCan you attach the Backtesting_template.xlsx file and confirm that you are using poi 3.16?", "id": 199777, "time": "2017-07-13T22:23:27Z", "creator": "fanningpj@yahoo.com", "creation_time": "2017-07-13T22:23:27Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 61297, "text": "Created attachment 35133\nExcel file causing problem\n\nI since fixed my typos but here the info.\n\nI am using poi-3.1.6-beta2 and I've attached the Excel file", "id": 199778, "attachment_id": 35133, "creator": "ted.ji@wellsfargo.com", "creation_time": "2017-07-13T22:27:22Z", "time": "2017-07-13T22:27:22Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 61297, "attachment_id": null, "id": 199779, "time": "2017-07-13T23:34:59Z", "creator": "onealj@apache.org", "creation_time": "2017-07-13T23:34:59Z", "is_private": false, "text": "Can you also include the code that produced this error message?\n\nThis Rule M2.4 occurs when you try to copy an XML bean from one workbook (DOM) to another."}, {"count": 4, "tags": [], "text": "Nevermind. Code is in attachment 35132.\n\nThe problem is that you're closing the pkg in a for loop and then closing it again at the exit.\n\nYou should only close the OPCPackage once,and after it's closed, the package and anything that relies on the package (such as the XSSFWorkbook) can no longer be used.", "is_private": false, "id": 199780, "creation_time": "2017-07-13T23:38:34Z", "time": "2017-07-13T23:38:34Z", "creator": "onealj@apache.org", "bug_id": 61297, "attachment_id": null}, {"count": 5, "tags": [], "text": "\n\n*** This bug has been marked as a duplicate of bug 59158 ***", "attachment_id": null, "id": 199781, "creator": "onealj@apache.org", "time": "2017-07-14T00:12:31Z", "bug_id": 61297, "creation_time": "2017-07-14T00:12:31Z", "is_private": false}]