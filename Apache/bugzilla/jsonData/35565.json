[{"count": 0, "tags": [], "bug_id": 35565, "attachment_id": null, "is_private": false, "id": 76841, "time": "2005-06-30T17:50:37Z", "creator": "szitya@yahoo.com", "creation_time": "2005-06-30T17:50:37Z", "text": "The following error occured\n  ---------------------------\n  Exception in thread main\n  java.lang.NullPointerException\n        at org.apache.poi.hssf.model.Sheet.getNumColumnBreaks(Sheet.java:2721)\n  ---------------------------\n\nin the following code\n\n  ---------------------------\n  import java.io.FileInputStream;\n  import java.io.IOException;\n\n  import org.apache.poi.hssf.usermodel.HSSFSheet;\n  import org.apache.poi.hssf.usermodel.HSSFWorkbook;\n  import org.apache.poi.poifs.filesystem.POIFSFileSystem;\n\n  public class GridSetError  {\n    public GridSetError( String fileName ) {\n\n      System.out.println( \"fileName : \" + fileName );\n      try {\n        POIFSFileSystem pfs = new POIFSFileSystem( new FileInputStream( fileName\n) );\n        HSSFWorkbook sourceWorkbook = new HSSFWorkbook( pfs );\n        HSSFSheet sourceSheet = sourceWorkbook.getSheetAt( 0 );\n        System.out.println( sourceSheet.getColumnBreaks() );\n      }\n      catch( IOException ioE ) {}\n    }\n\n    public static void main(String[] args) {\n      if( args.length > 0 ) {\n        GridSetError gridSetError = new GridSetError( args[0] );\n      }\n    }\n  }\n  ---------------------------\n\nSource XLS DOES NOT contain [VERTICALPAGEBREAK] record.\n\nI think, Sheet.getNumColumnBreaks() ( and Sheet.getNumRowBreaks() ) should first\ntest if Sheet.colBreaks (and Sheet.rowBreaks) is not null and if it is, then\nreturn 0 to HSSFSheet.getColumnBreaks() which would then return empty short[] to\nthe caller. This would not result in exception."}, {"count": 1, "tags": [], "bug_id": 35565, "attachment_id": null, "is_private": false, "id": 76842, "time": "2005-06-30T17:53:02Z", "creator": "avik@apache.org", "creation_time": "2005-06-30T17:53:02Z", "text": "Could you please attach a (stripped down) copy of the sheet that is causing you\nthis problem?"}, {"count": 2, "tags": [], "bug_id": 35565, "attachment_id": 15564, "id": 76843, "time": "2005-06-30T18:05:43Z", "creator": "szitya@yahoo.com", "creation_time": "2005-06-30T18:05:43Z", "is_private": false, "text": "Created attachment 15564\nTest Excel file"}, {"count": 3, "tags": [], "text": "Works as of 12Jan2007, Testcase added. \nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=41366", "attachment_id": null, "bug_id": 35565, "id": 98111, "time": "2007-01-16T01:43:16Z", "creator": "avik@apache.org", "creation_time": "2007-01-16T01:43:16Z", "is_private": false}]