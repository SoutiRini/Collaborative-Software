[{"count": 0, "tags": [], "bug_id": 55036, "attachment_id": 30350, "text": "Created attachment 30350\nnew function DEc2Hex with testcases\n\nnew function DEc2Hex with testcases", "id": 167538, "time": "2013-05-31T17:23:24Z", "creator": "cedric.walter@gmail.com", "creation_time": "2013-05-31T17:23:24Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 55036, "attachment_id": null, "text": "Thanks for the patch, applied in r1488729\n\nI had to revert FunctionMetadataReader.java because it contained a debug code specific for your local environment:\n \n\n \tpublic static FunctionMetadataRegistry createRegistry() {\n-\t\tInputStream is = FunctionMetadataReader.class.getResourceAsStream(METADATA_FILE_NAME);\n+        InputStream is = null;\n+        try {\n+            is = new FileInputStream(\"C:\\\\innoveo\\\\workspace\\\\apache-poi-complexwildcard\\\\poi\\\\src\\\\resources\\\\main\\\\org\\\\apache\\\\poi\\\\ss\\\\formula\\\\function\\\\functionMetadata.txt\");\n+        } catch (FileNotFoundException e) {\n+            e.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.\n+        }\n+        //FunctionMetadataReader.class.getResourceAsStream(METADATA_FILE_NAME);\n \t\tif (is == null) {\n \t\t\tthrow new RuntimeException(\"resource '\" + METADATA_FILE_NAME + \"' not found\");\n\nYegor", "id": 167578, "time": "2013-06-02T15:15:55Z", "creator": "yegor@dinom.ru", "creation_time": "2013-06-02T15:15:55Z", "is_private": false}, {"count": 2, "tags": [], "creator": "yegor@dinom.ru", "text": "\nThere is some work to do\n.\nDec2Hex is a function from the Excel Analysis Toolpack . It needs to implement FreeRefFunction and be registered in org.apache.poi.ss.formula.atp.AnalysisToolPak. Otherwise the formula evaluator will not find it. \n\nWhat you need to do:\n\n(1) Declare Dec2Hex as implementing FreeRefFunction . There is one method to implement and you need to simply delegate it to the existing implementation:\n\n    public ValueEval evaluate(ValueEval[] args, OperationEvaluationContext ec) {\n        if (args.length != 2) {\n            return ErrorEval.VALUE_INVALID;\n        }\n        return evaluate(ec.getRowIndex(), ec.getColumnIndex(), args[0], args[1]);    \n    }\n\n(2) register Dec2Hex  in AnalysisToolPack, see how other functions are registered and follow the pattern.\n\n(3) Provide a test(s) that evaluate functions from a real excel file. Attach the modified test workbook to this bug report.\n\nYegor", "id": 167579, "time": "2013-06-02T15:51:14Z", "bug_id": 55036, "creation_time": "2013-06-02T15:51:14Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "Created attachment 30373\nTests Dec2Hex() as loaded from a test data spreadsheet", "attachment_id": 30373, "bug_id": 55036, "id": 167594, "time": "2013-06-02T21:27:05Z", "creator": "cedric.walter@gmail.com", "creation_time": "2013-06-02T21:27:05Z", "is_private": false}, {"count": 4, "tags": [], "text": "Created attachment 30374\nDEC2HEX_2.patch + test loader from spreadsheet\n\nfound also a bug while doing integration tests in excel (negative integer), now solved", "is_private": false, "bug_id": 55036, "id": 167595, "time": "2013-06-02T21:28:55Z", "creator": "cedric.walter@gmail.com", "creation_time": "2013-06-02T21:28:55Z", "attachment_id": 30374}, {"count": 5, "tags": [], "text": "merged in 1531395", "attachment_id": null, "bug_id": 55036, "id": 170576, "time": "2013-10-11T19:16:57Z", "creator": "cedric.walter@gmail.com", "creation_time": "2013-10-11T19:16:57Z", "is_private": false}]