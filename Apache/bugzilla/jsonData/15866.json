[{"count": 0, "tags": [], "bug_id": 15866, "attachment_id": null, "id": 28977, "creation_time": "2003-01-07T21:55:20Z", "time": "2003-01-07T21:55:20Z", "creator": "coad@measurement-factory.com", "text": "Looks like a possible RFC 2616 MUST violation. \nApache caches a truncated response (which it MAY)\nbut does not treat it as partial (which it MUST).\n\nSee attached trace for details and ways to reproduce.\n\nTest case IDs in the trace link to human-oriented test case\ndescription and RFC quotes, if available.", "is_private": false}, {"count": 1, "tags": [], "bug_id": 15866, "text": "Created attachment 4362\ntest case trace", "id": 28978, "time": "2003-01-07T21:55:50Z", "creator": "coad@measurement-factory.com", "creation_time": "2003-01-07T21:55:50Z", "is_private": false, "attachment_id": 4362}, {"count": 2, "tags": [], "bug_id": 15866, "text": "FYI: This violation still exists in httpd-2.0.54.\n", "id": 76000, "time": "2005-06-04T00:40:25Z", "creator": "coad@measurement-factory.com", "creation_time": "2005-06-04T00:40:25Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "This one doesn't have an easy solution.  The problem is that mod_proxy currently\nhas no way to tell mod_cache if a response terminated abnormally.  We could add\nsome code in mod_cache, to make sure Content-Length matches that actual length,\nand invalidate the cache at that point.\n\nThe root of the problem is that the request effectively becomes non-cachable(or\nat least, requiring re-validation), at the last possible moment, long after we\ndecided to cache the object.", "attachment_id": null, "bug_id": 15866, "id": 76012, "time": "2005-06-04T01:44:45Z", "creator": "chip@force-elite.com", "creation_time": "2005-06-04T01:44:45Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 15866, "attachment_id": null, "id": 76078, "time": "2005-06-06T17:40:35Z", "creator": "coad@measurement-factory.com", "creation_time": "2005-06-06T17:40:35Z", "is_private": false, "text": "Yes, adding code to invalidate cache entries when Content-Length\nmismatches that actual length will remove this violation and may\nimprove cache robustness overall. IIRC, Squid does something like\nthat.\n\nA \"proper\" (but much more difficult) fix is to support caching of\npartial responses. Very few caches are capable of that. However,\nthe first step would still be the detection of a partial response,\njust like in the simple solution above. Thus, that code will not\nbe wasted.\n\n"}, {"count": 5, "tags": [], "creator": "wrowe@apache.org", "text": "*** Bug 32735 has been marked as a duplicate of this bug. ***", "id": 112340, "attachment_id": null, "bug_id": 15866, "creation_time": "2007-12-30T23:14:12Z", "time": "2007-12-30T23:14:12Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 15866, "attachment_id": 24306, "text": "Created attachment 24306\nTrunk patch to not cache responses whose length doesn't match the Content-length header\n\nHere's a trunk patch.  It checks the length of the response after caching it, and if it doesn't match the Content-Length header, then drops the cache entry.", "id": 130606, "time": "2009-09-23T06:40:13Z", "creator": "poirier@pobox.com", "creation_time": "2009-09-23T06:40:13Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 15866, "text": "Committed to trunk, r818492", "id": 130639, "attachment_id": null, "creator": "poirier@pobox.com", "creation_time": "2009-09-24T07:26:46Z", "time": "2009-09-24T07:26:46Z", "is_private": false}, {"count": 8, "tags": [], "text": "Can this be proposed for backport to Apache 2.2?", "attachment_id": null, "id": 130730, "creator": "phil.pickett@springsource.com", "time": "2009-09-28T16:31:31Z", "bug_id": 15866, "creation_time": "2009-09-28T16:31:31Z", "is_private": false}, {"count": 9, "tags": [], "creator": "poirier@pobox.com", "attachment_id": null, "text": "I'm working on an alternative fix based on helpful suggestions on the development list.  Once we have something that everybody is happy with, I'll propose for backport.", "id": 130741, "time": "2009-09-29T05:32:22Z", "bug_id": 15866, "creation_time": "2009-09-29T05:32:22Z", "is_private": false}, {"count": 10, "tags": [], "bug_id": 15866, "attachment_id": null, "text": "Backed out r818492 which blocked all caching of incomplete responses.\nCommitted r821763 which specifically blocks caching of incomplete\nresponses in mod_disk_cache.  This leaves the flexibility for other\ncache implementations to implement caching of incomplete responses\ncorrectly (per RFC 2616).  This is all in trunk.", "id": 130884, "time": "2009-10-05T05:16:09Z", "creator": "poirier@pobox.com", "creation_time": "2009-10-05T05:16:09Z", "is_private": false}, {"count": 11, "tags": [], "creator": "minfrin@sharp.fm", "text": "Closing as fixed in trunk, which will soon be released as v2.4.", "id": 144218, "time": "2011-02-12T08:13:39Z", "bug_id": 15866, "creation_time": "2011-02-12T08:13:39Z", "is_private": false, "attachment_id": null}]