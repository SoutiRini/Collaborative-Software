[{"count": 0, "tags": [], "creator": "evernat@free.fr", "attachment_id": null, "text": "The problem was documented here\nwww.mail-archive.com/poi-user@jakarta.apache.org/msg01251.html and \"Andy\"\nrequested for a patch.\n\nMy own context (by the way quite common) for the pb is :\n- An applet (or a JavaWebStart client application) should by signed with a\ncertificate and jarsigner to read system property (the JVM \"sandbox\"). iText,\nSwing Look And Feels and all external libraries are not signed and need not\nhopefully to be signed (except poi).\n\n- My app is a JavaWebStart app (but the pb will certainly be the same with an\napplet). My app's jar is signed. The poi's jar (2.5) is not signed (and it is\nreferenced in a JWS extension jnlp). The pb can be reproduced in JRE 1.4.2_01\nand in JRE 1.5.0 beta.\n\n- The exception is (JVM security restriction) :\njava.security.AccessControlException: access denied\n(java.util.PropertyPermission user.name read)\n\tat java.security.AccessControlContext.checkPermission(Unknown Source)\n\tat java.security.AccessController.checkPermission(Unknown Source)\n\tat java.lang.SecurityManager.checkPermission(Unknown Source)\n\tat java.lang.SecurityManager.checkPropertyAccess(Unknown Source)\n\tat java.lang.System.getProperty(Unknown Source)\n\tat org.apache.poi.hssf.model.Workbook.createWriteAccess(Workbook.java:807)\n\tat org.apache.poi.hssf.model.Workbook.createWorkbook(Workbook.java:232)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:126)\n\n\nIn the initial message above, Andrew requested for a patch, here it is :\n\nWorkBook\nprotected Record createWriteAccess() {\n        WriteAccessRecord retval = new WriteAccessRecord();\n\n        try {\n                retval.setUsername(System.getProperty(\"user.name\"));\n        } catch (java.security.AccessControlException e) {\n                // AccessControlException can occur in a restricted context\n                // (client applet/jws application or restricted security server)\n                retval.setUsername(\"POI\");\n        }\n        return retval;\n    }\n\nDon't hesitate to mail me if needed.", "id": 62439, "time": "2004-08-24T22:38:24Z", "bug_id": 30836, "creation_time": "2004-08-24T22:38:24Z", "is_private": false}, {"count": 1, "tags": [], "text": "Patch applied to HEAD branch.  Thanks.", "is_private": false, "id": 63788, "creator": "glens@apache.org", "time": "2004-09-19T01:40:02Z", "bug_id": 30836, "creation_time": "2004-09-19T01:40:02Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 30836, "attachment_id": null, "is_private": false, "id": 73901, "time": "2005-04-21T15:10:01Z", "creator": "avik@apache.org", "creation_time": "2005-04-21T15:10:01Z", "text": "*** Bug 32386 has been marked as a duplicate of this bug. ***"}]