[{"count": 0, "tags": [], "creator": "kenny_grimm@stchome.com", "attachment_id": null, "is_private": false, "id": 65527, "time": "2004-10-22T18:09:31Z", "bug_id": 31853, "creation_time": "2004-10-22T18:09:31Z", "text": "Using the jstl/fmt tag can cause \"java.lang.IllegalStateException: Response is\nalready committed!\" on Oracle(9|10)iAS.  I believe that the stack trace provided\n(see below) indicates that this is due to a fmt:formatDate which is attempting\nto setLocale after the response buffer has already been written.  This probably\nonly occurs when the buffer size reaches it's limit before this code is\nencountered.  It looks like FormatDateSuport.java calls\nSetLocaleSupport.java:getFormattingLocale which then calls setResponseLocale.\n\nMy question / concern is whether there is a way to keep it from attempting to\nset the locale since this cannot be done once the response has begun.  Is there\na reason that it must do this and if so is there a workaround?\n\nat\ncom.evermind.server.http.EvermindHttpServletResponse.setLocale(EvermindHttpServletResponse.java:1808)\n\tat\norg.apache.taglibs.standard.tag.common.fmt.SetLocaleSupport.setResponseLocale(SetLocaleSupport.java:234)\n\tat\norg.apache.taglibs.standard.tag.common.fmt.SetLocaleSupport.getFormattingLocale(SetLocaleSupport.java:314)\n\tat\norg.apache.taglibs.standard.tag.common.fmt.FormatDateSupport.doEndTag(FormatDateSupport.java:148)\n\tat _jsp_page._jspService(_jsp_page.java:4518)"}, {"count": 1, "tags": [], "bug_id": 31853, "text": "A colleague of mine just run into this same problem - same tag, same stack\ntrace, but different line in the fmt tag implementation, probably because of a\ndifferent version:\n\njava.lang.IllegalStateException: Response is already committed!\n    at com.evermind[Oracle Application Server Containers for J2EE\n10g\n(9.0.4.0.0)].server.http.EvermindHttpServletResponse.setLocale(EvermindH\nttpServletResponse.java:1808)\n    at\norg.apache.taglibs.standard.tag.common.fmt.SetLocaleSupport.setResponseL\nocale(SetLocaleSupport.java:200)\n...\n...\n\nIs this fixed in one of the newer version?  Does anyone know if this is a known\nOracle app server/servlet engine bug?", "id": 66613, "time": "2004-11-08T21:51:59Z", "creator": "otis@apache.org", "creation_time": "2004-11-08T21:51:59Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 31853, "is_private": false, "text": "I would say that after the source examination, the MessageSupport calls( for no\napparent reason) SetLocaleSupport.setLocale. That is what causing the exception\ndue to the server's behaviour i.e. commiting response when it wants (and I'm not\npointing fingers here).\n\nTwo things could be done:\n1. Do not call the SetLocaleSupport as it is not the right place to set Locale\non the response.\nAnd/Or\n2. Check if the response has been committed b4 setting locale (in SetLocaleSupport)\n\n", "id": 74780, "time": "2005-05-12T10:48:41Z", "creator": "viktor.levine@lycos.com", "creation_time": "2005-05-12T10:48:41Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 31853, "text": "I'm having the same problem, but am not explicitly making any calls to set the\nlocale. Here's the code that caused the exception...\n\n<fmt:formatDate value=\"${myBean.myDate}\" />\n\nAnd the exception...\n\njava.lang.IllegalStateException: Response is already committed!\n  at com.evermind[Oracle Application Server Containers for J2EE 10g\n(9.0.4.0.0)].server.http.EvermindHttpServletResponse.setLocale(EvermindHttpServletResponse.java:1808)\n  at\norg.apache.taglibs.standard.tag.common.fmt.SetLocaleSupport.setResponseLocale(SetLocaleSupport.java:234)\n  at\norg.apache.taglibs.standard.tag.common.fmt.SetLocaleSupport.getFormattingLocale(SetLocaleSupport.java:314)\n  at\norg.apache.taglibs.standard.tag.common.fmt.FormatDateSupport.doEndTag(FormatDateSupport.java:148)\n  at _MyJsp._jspService(_MyJsp.java:870)", "id": 76356, "time": "2005-06-13T23:16:27Z", "creator": "michael.flanakin@getindigo.com", "creation_time": "2005-06-13T23:16:27Z", "is_private": false, "attachment_id": null}, {"count": 4, "attachment_id": null, "creator": "bayard@apache.org", "is_private": false, "id": 97381, "time": "2006-12-27T15:07:09Z", "bug_id": 31853, "creation_time": "2006-12-27T15:07:09Z", "tags": [], "text": "Looking around, this looks like an interesting issue that has been resolved as\nINVALID:\n\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=19408\n\nIt looks like the same problem, but in this case for Tomcat 4. The comment from\nPierre appears to imply it's a problem with the container, and I'm guessing the\nsame would apply to the container in Oracle. \n\nThis seems like a WONTFIX."}, {"count": 5, "tags": [], "creator": "bayard@apache.org", "attachment_id": null, "is_private": false, "id": 97601, "time": "2007-01-03T16:06:54Z", "bug_id": 31853, "creation_time": "2007-01-03T16:06:54Z", "text": "Looks like the bug is in the container, marking WONTFIX."}]