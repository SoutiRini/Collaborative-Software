[{"count": 0, "tags": [], "creator": "apache-bug-db@web-startup.co.uk", "attachment_id": null, "text": "It appears that <include-prelude> is ignored in a web.xml with 2.3 DTD headers, \neven though that tag was not introduced until 2.4.  Should use of this tag \nprior to v2.4 cause an exception to be thrown?\n\nI reinstalled 5.0.27 from scratch (on Win2k / JDK 1.4.2_05).\n\nI then added a simple webapp called \"test\" by adding these three files under\nthe webapps folder:\ntest\\index.jsp\ntest\\prelude.jspf\ntest\\WEB-INF\\web.xml\n\nThe file contents are as follows (I know that the jsps contain incomplete\nHTML but they suffice to keep the example simple).\n\n--index.jsp--\n==========================\n<p>This is index.jsp</p>\n==========================\n\n--prelude.jspf--\n==========================\n<p>This is prelude.jspf</p>\n==========================\n\n--web.xml--\n==========================\n<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\n<!DOCTYPE web-app\n     PUBLIC \"-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN\"\n    \"http://java.sun.com/dtd/web-app_2_3.dtd\">\n<web-app>\n\t<jsp-config>\n\t\t<jsp-property-group>\n\t\t\t<url-pattern>*.jsp</url-pattern>\n\t\t\t<include-prelude>prelude.jspf</include-prelude>\n\t\t</jsp-property-group>\n\t</jsp-config>\n</web-app>\n==========================\n\nNote that the web.xml above uses the 2.3 DTD.  I made no other changes to the \nstandard installation.\n\nI then started tomcat (I already have it installed as a service).  I then\naccessed http://localhost:8080/test/ using IE6.  This displayed the file\nindex.jsp. The browser showed just the text \"This is index.jsp\".  In other\nwords, no text from prelude.jspf was included even though this is configured\nin web.xml.  No errors were logged in any of the logfiles.\n\nAs a check, I then stopped tomcat and edited web.xml to give it the 2.4\nheaders, deleted all the files from the work directory, then restarted\ntomcat and ctrl-F5'd IE to force-reload the page.  This time, the text from\nprelude.jspf was included in index.jsp, and no errors were logged.\n\nSo, as far as I can tell, it seems that the <include-prelude> tag is being\nsilently ignored when placed in a 2.3 web.xml, but no errors are being\nthrown.", "id": 64987, "time": "2004-10-12T14:41:21Z", "bug_id": 31670, "creation_time": "2004-10-12T14:41:21Z", "is_private": false}, {"count": 1, "tags": [], "creator": "yoavs@computer.org", "attachment_id": null, "text": "Because the Servlet Specification (v2.3, to which this DTD issue applies) \ndoesn't require containers to validate the web.xml, we ignore unknown \nelements.  It's the author's responsibility to validate their own web.xml and \nuse the version of the spec (2.3, 2.4, etc.) they want.  If you feel like \nsubmitting an enhancement patch to Tomcat which will validate web.xml, go ahead \n(in a separate Bugzilla issue most likely), but this by itself is not a bug \nthat's going to be addressed I think.", "id": 65661, "time": "2004-10-25T18:41:29Z", "bug_id": 31670, "creation_time": "2004-10-25T18:41:29Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 31670, "text": "Thanks Yoav, I understand the logic of that.  Point taken re use of XML \nvalidators.  Also your fix to my other reported bug (#31671) will make this \nissue less likely to occur.\n\nAlthough TC is not required to validate XML, it seems to do some validation, \nbecause it often rejects other errors in web.xml, such as missed or mismatched \nclosing tags, missed angle brackets, servlet class not found etc.  This is why \nI was surprised that it did not complain about the specific issue I reported.  \nIs there a simple rule that explains why Tomcat rejects some web.xml errors but \nnot others?  If so then maybe including this in docs somewhere might help \npeople understand more clearly what web.xml errors TC will report on, versus \nthose it will ignore....?", "id": 65671, "time": "2004-10-25T19:41:26Z", "creator": "apache-bug-db@web-startup.co.uk", "creation_time": "2004-10-25T19:41:26Z", "is_private": false, "attachment_id": null}]