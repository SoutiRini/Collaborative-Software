[{"count": 0, "tags": [], "creator": "rfrovarp@apache.org", "attachment_id": null, "text": "LenyaVersion (src/java/org/apache/lenya/cms/workflow/LenyaVersion.java) and\nVersionImpl\n(src/modules-core/workflow/java/src/org/apache/lenya/workflow/impl/VersionImpl.java)\nare identical. LenyaVersion is used in\nsrc/java/org/apache/lenya/cms/workflow/DocumentWorkflowable.java and VersionImpl\nis used in\nsrc/modules-core/workflow/java/src/org/apache/lenya/workflow/impl/WorkflowEngineImpl.java.\nLenyaVersion or VersionImpl should be removed before the code freeze.", "id": 101878, "time": "2007-04-18T07:50:48Z", "bug_id": 42161, "creation_time": "2007-04-18T07:50:48Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "andreas@apache.org", "text": "That's not trivial (unless I'm missing an obvious solution). Since it doesn't\nimply any functional problems, I'd say we defer it to 1.4.1.", "count": 1, "id": 102291, "time": "2007-04-25T02:37:27Z", "bug_id": 42161, "creation_time": "2007-04-25T02:37:27Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 42161, "text": "can you explain what makes this duplication necessary?\ni can see how the core should not depend on a module, but i'm not sure about the\ndetails.\nwould moving the DocumentWorkflowable into a module help?\nwhile we're at it: what other functionality should be modularized before 1.4?\nshould we maybe get rid of the old \"core\" entirely?", "id": 102298, "time": "2007-04-25T03:45:49Z", "creator": "nettings@apache.org", "creation_time": "2007-04-25T03:45:49Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "rfrovarp@apache.org", "attachment_id": 20037, "text": "Created attachment 20037\nRemoves VersionImpl\n\nThis patch causes the code to use LenyaVersion instead of VersionImpl. Builds\nand runs fine.", "id": 102317, "time": "2007-04-25T06:26:39Z", "bug_id": 42161, "creation_time": "2007-04-25T06:26:39Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 42161, "attachment_id": null, "text": "I'm not caught up enough to understand what exactly the src/java tree is. I\nfigure the modules should be able to depend on it. My patch is based on that\nassumption. Alternatively, instead of removing a file that others may be using.\nHave VersionImpl extend LenyaVersion and wipe out VersionImpl's code. This will\npreserve the file, the methods presented, and operation while making any further\nupdates happen in one place. This might be the preferred route to get this into\nthe 1.4.0 release.", "id": 102320, "time": "2007-04-25T06:31:16Z", "creator": "rfrovarp@apache.org", "creation_time": "2007-04-25T06:31:16Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 42161, "attachment_id": null, "id": 102322, "time": "2007-04-25T06:36:15Z", "creator": "andreas@apache.org", "creation_time": "2007-04-25T06:36:15Z", "is_private": false, "text": "Thanks for the patch!\n\nBut there's a little problem (which is the reason why I didn't make this change\nyet):\n\n+++\nsrc/modules-core/workflow/java/src/org/apache/lenya/workflow/impl/WorkflowEngineImpl.java\n(working copy)\n@@ -20,6 +20,7 @@\n import java.util.ArrayList;\n import java.util.List;\n \n+import org.apache.lenya.cms.workflow.LenyaVersion;\n\n\nThe code in org.apache.lenya.workflow is meant to be generic for SoC reasons,\ni.e. it shouldn't know anything about the CMS. That's why it shouldn't import\nanything from o.a.l.cms.workflow.\n\nIMO a clean solution would be to use an abstract factory to generate version\nobjects. The o.a.l.workflow package uses\n\n  versionFactory.createVersion(...)\n\nThe o.a.l.cms.workflow package provides an implementation which generates\nLenyaVersion objects.\n"}, {"count": 6, "tags": [], "bug_id": 42161, "text": "hmm. i see your point, but code duplication is the far greater evil imnsho.\nhow about taking richard's patch with a loud comment on how it should eventually\nbe refactored, and a low-priority enhancement bug?\n", "id": 102324, "time": "2007-04-25T06:46:04Z", "creator": "nettings@apache.org", "creation_time": "2007-04-25T06:46:04Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 42161, "text": "(In reply to comment #6)\n> hmm. i see your point, but code duplication is the far greater evil imnsho.\n\nCode duplication is not really evil. Knowledge duplication is, but IMO this is\nnot the case here.\n\n> how about taking richard's patch with a loud comment on how it should\n> eventually be refactored, and a low-priority enhancement bug?\n\nI'd rather take the time to implement a factory, or think of a better approach.\n", "id": 102325, "time": "2007-04-25T06:49:41Z", "creator": "andreas@apache.org", "creation_time": "2007-04-25T06:49:41Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "creator": "rfrovarp@apache.org", "attachment_id": null, "text": "Thanks for explaining. My confusion came from the fact that both files import\no.a.l.workflow.Version which is under the same file tree as\no.a.l.cms.workflow.LenyaVersion. While there might be a separation of code in\nconcept, I didn't see it reflected on the file system.", "id": 102326, "time": "2007-04-25T06:51:09Z", "bug_id": 42161, "creation_time": "2007-04-25T06:51:09Z", "is_private": false}]