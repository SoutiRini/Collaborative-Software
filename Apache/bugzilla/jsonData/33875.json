[{"count": 0, "tags": [], "bug_id": 33875, "attachment_id": null, "text": "Apache(1.3.33) process (libhttpd.ep) occasionally hangs on calling int_malloc. \nThe hanging process usually consumes around 45% CPU.\n\nAn strace of the process returns no infomation.\n\nA gdb backtrace reveals the following:\n\n(gdb) backtrace\n#0  0x009a9b26 in _int_malloc () from /lib/tls/libc.so.6\n#1  0x009a8e9d in malloc () from /lib/tls/libc.so.6\n#2  0x007516b6 in lmatcher () from /usr/local/apache_1.3.33/libexec/libhttpd.so\n#3  0x00753616 in regexec () from /usr/local/apache_1.3.33/libexec/libhttpd.so\n#4  0x0073fdef in ap_regexec () \nfrom /usr/local/apache_1.3.33/libexec/libhttpd.so\n#5  0x0070c25f in apply_rewrite_cond () \nfrom /usr/local/apache_1.3.33/libexec/libhttpd.so\n#6  0x0070b77c in apply_rewrite_rule () \nfrom /usr/local/apache_1.3.33/libexec/libhttpd.so\n#7  0x0070b20e in apply_rewrite_list () \nfrom /usr/local/apache_1.3.33/libexec/libhttpd.so\n#8  0x0070a131 in hook_uri2file () \nfrom /usr/local/apache_1.3.33/libexec/libhttpd.so\n#9  0x0072675e in run_method () \nfrom /usr/local/apache_1.3.33/libexec/libhttpd.so\n#10 0x007267d1 in ap_translate_name () \nfrom /usr/local/apache_1.3.33/libexec/libhttpd.so\n#11 0x0073d691 in process_request_internal () \nfrom /usr/local/apache_1.3.33/libexec/libhttpd.so\n#12 0x0073db71 in ap_process_request () \nfrom /usr/local/apache_1.3.33/libexec/libhttpd.so\n#13 0x00734352 in child_main () \nfrom /usr/local/apache_1.3.33/libexec/libhttpd.so\n#14 0x007345dd in make_child () \nfrom /usr/local/apache_1.3.33/libexec/libhttpd.so\n#15 0x00734958 in perform_idle_server_maintenance () \nfrom /usr/local/apache_1.3.33/libexec/libhttpd.so\n#16 0x00735020 in standalone_main () \nfrom /usr/local/apache_1.3.33/libexec/libhttpd.so\n#17 0x007356ad in ap_main () from /usr/local/apache_1.3.33/libexec/libhttpd.so\n#18 0x0804870b in main ()\n\nInitially thought it due to apache being comiled against tls libraries instead \nof the usual ones in /lib.\n\nbut the problem still occured after recompiling agaisnt the non thread-safe \nlibraries (from /lib). Again hanging on int_malloc.\n\nAt the point of failure there is approx 1.8g of memory available to the \napplication.\n\nhave tried exaclty the same apache/php(4.3.10) install on a redhat 7.3 \nvalhalla and apache has yet to produce the same error.\n\nCan't reproduce the problem as it seems to only occure randomly (but usually \nwhen the server is under load).\n\n\n\nHere's some server info:\n\n[root@portal6 root]# uname -a\nLinux portal6 2.4.21-27.ELsmp #1 SMP Wed Dec 1 21:50:31 EST 2004 i686 athlon \ni386 GNU/Linux\n[root@portal6 root]# cat /etc/issue.net\nRed Hat Enterprise Linux ES release 3 (Taroon Update 4)\nKernel \\r on an \\m\n[root@portal6 root]# ldd /usr/local/apache/libexec/libhttpd.ep\n        libhttpd.so => not found\n        libm.so.6 => /lib/tls/libm.so.6 (0x00cbe000)\n        libcrypt.so.1 => /lib/libcrypt.so.1 (0x00a2b000)\n        libgdbm.so.2 => /usr/lib/libgdbm.so.2 (0x00593000)\n        libexpat.so.0 => /usr/local/lib/libexpat.so.0 (0x004d1000)\n        libdl.so.2 => /lib/libdl.so.2 (0x00743000)\n        libc.so.6 => /lib/tls/libc.so.6 (0x00d34000)\n        /lib/ld-linux.so.2 => /lib/ld-linux.so.2 (0x0082d000", "id": 71898, "time": "2005-03-07T12:22:17Z", "creator": "billy.barker@gmail.com", "creation_time": "2005-03-07T12:22:17Z", "is_private": false}, {"count": 1, "tags": [], "creator": "billy.barker@gmail.com", "attachment_id": null, "id": 39777, "time": "2005-03-22T14:32:40Z", "bug_id": 33875, "creation_time": "2005-03-22T14:32:40Z", "is_private": false, "text": "Upped severity to try and get a response. Sorry."}, {"count": 2, "tags": [], "bug_id": 33875, "attachment_id": null, "id": 39771, "time": "2005-03-22T14:36:19Z", "creator": "jorton@redhat.com", "creation_time": "2005-03-22T14:36:19Z", "is_private": false, "text": "Not sure if you answered the questions when filed in that other bugzilla database:\n\nHave you tried running with\n\nexport MALLOC_CHECK_=2\n\nin the environment? This will enable more malloc checking.  Also have you tried\na build without SHARED_CORE?"}, {"count": 3, "tags": [], "creator": "billy.barker@gmail.com", "text": "I've been running httpd on all the servers with _MALLOC_CHECK=2. Unfortunately \nno debug information is produced when the process stalls. ", "id": 72985, "time": "2005-03-29T16:28:34Z", "bug_id": 33875, "creation_time": "2005-03-29T16:28:34Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "bugzilla@simguy.net", "attachment_id": null, "text": "I am seeing this problem as well on the CentOS 3.5 platform, which is the same\npackages as RHES 3 (Update 5) with Apache 1.3.33  Same behavior with same\nbacktrace minus the rewrite conditions.\n\nstrace show no output, gdb has a backtrace, but I lost it.\n\nI'm just posting to cofirm for the moment.  I'll post my backtrace as well next\ntime it occurs as I've set MALLOC_CHECK_=2 just now.", "id": 77808, "time": "2005-07-29T01:43:55Z", "bug_id": 33875, "creation_time": "2005-07-29T01:43:55Z", "is_private": false}, {"count": 5, "tags": [], "creator": "mss@apache.org", "attachment_id": null, "id": 145130, "time": "2011-03-21T10:31:15Z", "bug_id": 33875, "creation_time": "2011-03-21T10:31:15Z", "is_private": false, "text": "Apache HTTP Server 1.3.x is not supported anymore and no bugs will be fixed in the old codebase (cf. <http://mail-archives.apache.org/mod_mbox/httpd-announce/201002.mbox/%3C20100203000334.GA19021@infiltrator.stdlib.net%3E>). Since this bug seems to affect only 1.3.x, I'm closing it as WONTFIX.\n\nIf this bug still affects you in a recent version (version 2.2.x or the upcoming version 2.4), please open a new bug.\n\nThank you for reporting the bug."}]