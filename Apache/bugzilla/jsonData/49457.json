[{"count": 0, "tags": [], "bug_id": 49457, "attachment_id": null, "id": 137716, "time": "2010-06-17T12:11:04Z", "creator": "eduard.dudar@gmail.com", "creation_time": "2010-06-17T12:11:04Z", "is_private": false, "text": "Exception fails when we try to write HSSF workbook: \"org.apache.poi.ss.formula.FormulaParseException: Parse error near char 7 ';' in specified formula 'SUM(D19;D23)'. Expected ',' or ')'\". When I made proposed change and replaced 'SUM(D19;D23)' with 'SUM(D19,D23)' exception disappeared. However, 'SUM(D19;D23)' is valid formula in Excel and 'SUM(D19,D23)' is not.\n\nComplete stacktrace is here:\n\torg.apache.poi.ss.formula.FormulaParser.expected(FormulaParser.java:217)\n\torg.apache.poi.ss.formula.FormulaParser.Arguments(FormulaParser.java:1049)\n\torg.apache.poi.ss.formula.FormulaParser.function(FormulaParser.java:929)\n\torg.apache.poi.ss.formula.FormulaParser.parseNonRange(FormulaParser.java:551)\n\torg.apache.poi.ss.formula.FormulaParser.parseRangeable(FormulaParser.java:423)\n\torg.apache.poi.ss.formula.FormulaParser.parseRangeExpression(FormulaParser.java:266)\n\torg.apache.poi.ss.formula.FormulaParser.parseSimpleFactor(FormulaParser.java:1112)\n\torg.apache.poi.ss.formula.FormulaParser.percentFactor(FormulaParser.java:1072)\n\torg.apache.poi.ss.formula.FormulaParser.powerFactor(FormulaParser.java:1059)\n\torg.apache.poi.ss.formula.FormulaParser.Term(FormulaParser.java:1410)\n\torg.apache.poi.ss.formula.FormulaParser.additiveExpression(FormulaParser.java:1510)\n\torg.apache.poi.ss.formula.FormulaParser.concatExpression(FormulaParser.java:1494)\n\torg.apache.poi.ss.formula.FormulaParser.comparisonExpression(FormulaParser.java:1451)\n\torg.apache.poi.ss.formula.FormulaParser.unionExpression(FormulaParser.java:1431)\n\torg.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:1552)\n\torg.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:174)\n\torg.apache.poi.hssf.model.HSSFFormulaParser.parse(HSSFFormulaParser.java:72)\n\torg.apache.poi.hssf.usermodel.HSSFCell.setCellFormula(HSSFCell.java:588)"}, {"count": 1, "tags": [], "bug_id": 49457, "text": "Excel encodes formulas into a representation independent of the characters visible in the human readable formula.  In some regions, Excel displays (and parses) commas for argument delimiters, and in others, semicolons.  POI currently does not support internationalisation for formula rendering/parsing, and  effectively uses a default region of 'United States'.\n\nThe work around is simple - use comma instead of semicolon (as you mentioned already).  Unfortunately, there will be small differences between the way POI and Excel render/parse formulas in your region.\n\nContributions are always welcome.  To fix this will involve changes to the FormulaParser class.  You'd need to deal with more than just the argument delimiter: the decimal separator, and array element delimiter are probably also region specific.  I am not sure what other elements of Excel formulas are region specific.\n\n*** This bug has been marked as a duplicate of bug 45909 ***", "id": 137722, "time": "2010-06-17T13:50:53Z", "creator": "josh@apache.org", "creation_time": "2010-06-17T13:50:53Z", "is_private": false, "attachment_id": null}]