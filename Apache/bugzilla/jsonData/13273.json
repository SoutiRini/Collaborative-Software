[{"count": 0, "tags": [], "bug_id": 13273, "attachment_id": null, "text": "Using org.apache.tools.ant.util.depend.bcel.FullAnalyzer does not add correct\ndependencies for classes included in method signatures. \n\nexample:\n\nSystem.out.println(\"My class: \" + MyClass.class);\n\nMyClass will not be included in the dependency list, even though it is required\nat runtime.\n\nThe problem is actually in o.a.t.a.u.d.DependencyVisitor\n\nI've added a test to ClassFileSetTest to check for this.\n\nJesse", "id": 23878, "time": "2002-10-04T03:41:44Z", "creator": "jesse@cryptocard.com", "creation_time": "2002-10-04T03:41:44Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 13273, "attachment_id": 3344, "id": 23879, "time": "2002-10-04T03:42:38Z", "creator": "jesse@cryptocard.com", "creation_time": "2002-10-04T03:42:38Z", "is_private": false, "text": "Created attachment 3344\nTarball with patches and 1 new file"}, {"count": 2, "tags": [], "text": "Created attachment 3345\nNew patch set with cleaner changes in DependencyVisitor", "is_private": false, "bug_id": 13273, "id": 23880, "time": "2002-10-04T04:13:13Z", "creator": "jesse@cryptocard.com", "creation_time": "2002-10-04T04:13:13Z", "attachment_id": 3345}, {"count": 3, "tags": [], "text": "Created attachment 3387\nOops, fix an off by one typo.", "is_private": false, "bug_id": 13273, "id": 24110, "time": "2002-10-08T02:02:08Z", "creator": "jesse@cryptocard.com", "creation_time": "2002-10-08T02:02:08Z", "attachment_id": 3387}, {"count": 4, "tags": [], "text": "I've made a slightly different adjustment to the dependency visitor which should\npick up even more uses of MyClass.class. The change picks up the contruction of\nthe .class reference. Your patch and the change I made are potentially compiler\nspecific - I'm still investigating other compilers - in that it relies on the\nname the compiler gives to the static class reference.\n\nAnyway, I've committed the testcases and verified that the patch works. Could\nyou test please?", "is_private": false, "bug_id": 13273, "id": 28113, "time": "2002-12-20T13:58:48Z", "creator": "conor@apache.org", "creation_time": "2002-12-20T13:58:48Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 13273, "attachment_id": null, "id": 30519, "time": "2003-02-02T18:18:48Z", "creator": "jesse@cryptocard.com", "creation_time": "2003-02-02T18:18:48Z", "is_private": false, "text": "Sorry for the delay in testing\n\nWhats the reason for this code? (line 128 of DependencyVisitor.java)\n\nint index = classname.lastIndexOf(\".\");\nif (index != -1) {\n    classname = classname.substring(0, index) + \"$\" + \n                     classname.substring(index + 1);\n    addClass(classname);\n}\n\nIt causes the dependency list to have 2 entries for each class.\npackage1.Class1  <-- correct\npackage1$Class1  <-- incorrect\n\nAfter removing the above code, only the correct entries are added to the\ndependency list.\n\nJesse"}, {"count": 6, "tags": [], "creator": "conor@apache.org", "attachment_id": null, "text": "That code is because I can't distinguish between the class\n\npackage1.Class1\n\nand the innerclass Class1 of package1 which is rendered package1$Class1\n\nBy putting both in, it should pick up the actual one. \n\nPerhaps it is not needed?", "id": 31000, "time": "2003-02-10T13:06:10Z", "bug_id": 13273, "creation_time": "2003-02-10T13:06:10Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 13273, "is_private": false, "id": 31098, "attachment_id": null, "creator": "jesse@cryptocard.com", "creation_time": "2003-02-12T05:47:56Z", "time": "2003-02-12T05:47:56Z", "text": "Ok, I've got a way to distinguish between com.company.Class and\ncom.company.Class$Inner\n\nAccording to the spec package names can only be lower case acsii, so we can\ncheck for upper case on the second last segment of the the class name.\n\ncom.company.Class = 'company' start with lower case, so it's not an inner class\ncom.company.Class$Inner - 'Class' starts with upper case, so it's an inner class.\n\nI've added another test to ClassFileTest to check for this.\n\nThe code that caught this bug (Genjar) also works with the new changes.\n\nJesse"}, {"count": 8, "tags": [], "bug_id": 13273, "text": "Created attachment 4820\nPatch and new files for test case", "id": 31099, "time": "2003-02-12T05:49:15Z", "creator": "jesse@cryptocard.com", "creation_time": "2003-02-12T05:49:15Z", "is_private": false, "attachment_id": 4820}, {"count": 9, "tags": [], "bug_id": 13273, "attachment_id": null, "id": 35155, "time": "2003-04-15T03:37:19Z", "creator": "jesse@cryptocard.com", "creation_time": "2003-04-15T03:37:19Z", "is_private": false, "text": "Fixed in CVS"}]