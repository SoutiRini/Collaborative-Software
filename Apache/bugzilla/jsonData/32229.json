[{"count": 0, "tags": [], "bug_id": 32229, "text": "I have some problems with ~userdir suexec.\n\nApache build parameters:\n\n./configure \\\n    --with-mpm=prefork \\\n    --enable-so \\\n    --enable-suexec \\\n    --with-suexec-caller=nobody \\\n    --with-suexec-userdir=public_html \\\n    --with-suexec-docroot=/web/vhosting \\\n    --with-suexec-uidmin=100 \\\n    --with-suexec-gidmin=100 \\\n    --with-suexec-safepath=\"/bin:/usr/bin:/usr/local/bin\" \\\n    --enable-ssl \\\n    --enable-rewrite \\\n    --enable-charset-lite\n\nScriptAlias for user:\n\nScriptAlias /~luthien/cgi-bin/ /web/users/luthien/public_html/cgi-bin/\n\nWhen I place CGI script test.cgi to ~luthien/public_html/cgi-bin/, and try to \nopen URL http://site/~luthien/cgi-bin/test.cgi, Apache runs test.cgi with \nnobody/nogroup permissions, and writes nothing to suexec_log. But with these \nsettings:\n\n<Directory /web/users/luthien/public_html>\nAddHandler cgi-script .cgi\nOptions ExecCGI\n</Directory>\n\nand test.cgi moved to public_html, Apache runs CGI with user's permissions, as \nit should be, and logs this to suexec_log. If I remove ScriptAlias from \nconfiguration, and move test.cgi back to cgi-bin, Apache runs it as \nnobody/nogroup again. Is it my mistake or a bug ? Apache 1.3 handles such \nsituation with ScriptAlias correctly (I've just upgraded from Apache 1.3 to \nApache2). I also have some virtual hosts with SuexecUserGroup directive, and it \nworks correctly.\n\nSome details about server configuration:\n\nSuexec -V output:\n\n# ./suexec -V\n -D AP_DOC_ROOT=\"/web/vhosting\"\n -D AP_GID_MIN=100\n -D AP_HTTPD_USER=\"nobody\"\n -D AP_LOG_EXEC=\"/usr/local/apache2/logs/suexec_log\"\n -D AP_SAFE_PATH=\"/bin:/usr/bin:/usr/local/bin\"\n -D AP_UID_MIN=100\n -D AP_USERDIR_SUFFIX=\"public_html\"\n\nA piece of httpd.conf:\n\n[...]\nServerRoot \"/usr/local/apache2\"\nUser  nobody\nGroup nobody\nServerAdmin noc@vsi.ru\nServerName www.vsi.ru\nUseCanonicalName Off\nDocumentRoot /web/vhosting/www.vsi.ru\nScriptAlias /cgi-bin/ /web/vhosting/www.vsi.ru/cgi-bin/\n<Directory \"/web/users\">\n    Options        IncludesNOEXEC\n    AllowOverride  AuthConfig FileInfo Indexes Limit\n    XBitHack       On\n    Order          Allow,Deny\n    Allow          From All\n    php_admin_flag engine off\n</Directory>\n<Directory \"/web/vhosting/www.vsi.ru\">\n    AllowOverride   All\n    php_admin_value open_basedir /web/vhosting/www.vsi.ru/\n    php_admin_flag  safe_mode off\n</Directory>\nInclude conf/vhosts.conf\nInclude conf/vusers.conf\nUserDir public_html\n\nA piece of vusers.conf:\n\n# For ~luthien\nScriptAlias /~luthien/cgi-bin/ /web/users/luthien/public_html/cgi-bin/", "id": 66873, "time": "2004-11-14T09:24:43Z", "creator": "oleg@vsi.ru", "creation_time": "2004-11-14T09:24:43Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "oleg@vsi.ru", "text": "Sorry, this is my mistake. It seems to ScriptAlias URLs with ~user not handled \nby mod_suexec because they are not handled by mod_userdir.\n", "id": 66904, "time": "2004-11-15T08:48:38Z", "bug_id": 32229, "creation_time": "2004-11-15T08:48:38Z", "is_private": false, "attachment_id": null}]