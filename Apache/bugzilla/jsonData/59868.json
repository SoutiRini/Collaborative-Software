[{"count": 0, "tags": [], "text": "I have configured my Connector to listen to address=\"127.0.0.1\" only. Single hostname for this is \"localhost\". Though, the HTMLManager displays in Server Information my regular host name and the IP address of the second NIC (VirtualBox Host-Only Adapter).\n\nCode:\n        try {\n            InetAddress address = InetAddress.getLocalHost();\n            args[6] = address.getHostName();\n            args[7] = address.getHostAddress();\n        } catch (UnknownHostException e) {\n            args[6] = \"-\";\n            args[7] = \"-\";\n        }\n\nI would expect to display the information this Connector and Host is accepting, remove this information altogether or document that this information does not reflect configuration (docs/html-manager-howto.html#Server_Information).", "is_private": false, "id": 192421, "creation_time": "2016-07-16T11:43:05Z", "time": "2016-07-16T11:43:05Z", "creator": "1983-01-06@gmx.net", "bug_id": 59868, "attachment_id": null}, {"count": 1, "attachment_id": null, "bug_id": 59868, "text": "This section is information on the server, so this looks fine to me.", "id": 192483, "time": "2016-07-18T10:19:32Z", "creator": "remm@apache.org", "creation_time": "2016-07-18T10:19:32Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 59868, "is_private": false, "id": 192486, "attachment_id": null, "creator": "1983-01-06@gmx.net", "creation_time": "2016-07-18T10:50:26Z", "time": "2016-07-18T10:50:26Z", "text": "I would html-manager-howto.html#Server_Information at least expect to say that. No more, no less."}, {"count": 3, "attachment_id": null, "bug_id": 59868, "text": "I do not understand why you are unwilling to add two sentences to the docs about this. This is not rocket science.", "id": 192489, "time": "2016-07-18T12:44:34Z", "creator": "1983-01-06@gmx.net", "creation_time": "2016-07-18T12:44:34Z", "tags": [], "is_private": false}, {"count": 4, "attachment_id": null, "bug_id": 59868, "text": "(In reply to Michael Osipov from comment #0)\n> I have configured my Connector to listen to address=\"127.0.0.1\" only. Single\n> hostname for this is \"localhost\". Though, the HTMLManager displays in Server\n> Information my regular host name and the IP address of the second NIC\n> (VirtualBox Host-Only Adapter).\n>\n> Code:\n>         try {\n>             InetAddress address = InetAddress.getLocalHost();\n>             args[6] = address.getHostName();\n>             args[7] = address.getHostAddress();\n>         } catch (UnknownHostException e) {\n>             args[6] = \"-\";\n>             args[7] = \"-\";\n>         }\n> \n> I would expect to display the information this Connector and Host is\n> accepting, remove this information altogether or document that this\n> information does not reflect configuration\n> (docs/html-manager-howto.html#Server_Information).\n\nYeah, InetAddress.getLocaleHost() doesn't behave the way that most people would expect. Most people would expect it to grab the \"localhost\" IP address and use that. It doesn't.\n\nInstead, it asks the OS what the hostname of the current machine is, then uses that. So if your hostname is \"erasmus\", then InetAddress.getLocalHost will return that name + its IP address even if you have bound the connector to 127.0.0.1.\n\nNote that there is no relationship whatsoever between your <Connector> and InetAddress.getLocaLhost. InetAddress has no idea you are running Tomcat or using a Connector or that your connector is bound to 127.0.0.1.\n\nI'll have a look at this because, as you say, it's quite surprising.\n\nUnfortunately, most servers will be configured to listen to 0.0.0.0 (all interfaces) and then ... we're back to using InetAddress.getLocalHost to figure out what our \"host name\" is.", "id": 192495, "time": "2016-07-18T16:55:16Z", "creator": "chris@christopherschultz.net", "creation_time": "2016-07-18T16:55:16Z", "tags": [], "is_private": false}, {"count": 5, "attachment_id": null, "bug_id": 59868, "text": "(In reply to Christopher Schultz from comment #4)\n> (In reply to Michael Osipov from comment #0)\n> > I have configured my Connector to listen to address=\"127.0.0.1\" only. Single\n> > hostname for this is \"localhost\". Though, the HTMLManager displays in Server\n> > Information my regular host name and the IP address of the second NIC\n> > (VirtualBox Host-Only Adapter).\n> >\n> > Code:\n> >         try {\n> >             InetAddress address = InetAddress.getLocalHost();\n> >             args[6] = address.getHostName();\n> >             args[7] = address.getHostAddress();\n> >         } catch (UnknownHostException e) {\n> >             args[6] = \"-\";\n> >             args[7] = \"-\";\n> >         }\n> > \n> > I would expect to display the information this Connector and Host is\n> > accepting, remove this information altogether or document that this\n> > information does not reflect configuration\n> > (docs/html-manager-howto.html#Server_Information).\n> \n> Yeah, InetAddress.getLocaleHost() doesn't behave the way that most people\n> would expect. Most people would expect it to grab the \"localhost\" IP address\n> and use that. It doesn't.\n> \n> Instead, it asks the OS what the hostname of the current machine is, then\n> uses that. So if your hostname is \"erasmus\", then InetAddress.getLocalHost\n> will return that name + its IP address even if you have bound the connector\n> to 127.0.0.1.\n> \n> Note that there is no relationship whatsoever between your <Connector> and\n> InetAddress.getLocaLhost. InetAddress has no idea you are running Tomcat or\n> using a Connector or that your connector is bound to 127.0.0.1.\n> \n> I'll have a look at this because, as you say, it's quite surprising.\n> \n> Unfortunately, most servers will be configured to listen to 0.0.0.0 (all\n> interfaces) and then ... we're back to using InetAddress.getLocalHost to\n> figure out what our \"host name\" is.\n\nI am aware of this. That's the reason I am reporting this. The information displayed is misleading. I would at least expect the docs to be updated or this information removed.", "id": 192500, "time": "2016-07-18T19:43:31Z", "creator": "1983-01-06@gmx.net", "creation_time": "2016-07-18T19:43:31Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "creator": "remm@apache.org", "text": "(In reply to Christopher Schultz from comment #4)\n> Instead, it asks the OS what the hostname of the current machine is, then\n> uses that. So if your hostname is \"erasmus\", then InetAddress.getLocalHost\n> will return that name + its IP address even if you have bound the connector\n> to 127.0.0.1.\n\nThis is a manager webapp, and it is a section on server information, so it should display the server host name, not the particular connector information. This sounds really intuitive to me, it is like that in all admin webapps I've seen so far. So I will have to veto the proposed change for the time being and I also don't see the point of documenting it (server host name means the server host name ... ok, nice).", "id": 192502, "time": "2016-07-18T20:35:26Z", "bug_id": 59868, "creation_time": "2016-07-18T20:35:26Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 59868, "text": "(In reply to Remy Maucherat from comment #6)\n> (In reply to Christopher Schultz from comment #4)\n> > Instead, it asks the OS what the hostname of the current machine is, then\n> > uses that. So if your hostname is \"erasmus\", then InetAddress.getLocalHost\n> > will return that name + its IP address even if you have bound the connector\n> > to 127.0.0.1.\n> \n> This is a manager webapp, and it is a section on server information, so it\n> should display the server host name, not the particular connector\n> information. This sounds really intuitive to me, it is like that in all\n> admin webapps I've seen so far. So I will have to veto the proposed change\n> for the time being and I also don't see the point of documenting it (server\n> host name means the server host name ... ok, nice).\n\nThe funny thing is, I do not even see my machines host address by the address of my VirtuaBox Host-Only device which has a higher priority for some reason:\n\nC:\\Users\\mosipov>route print\n===========================================================================\nSchnittstellenliste\n  8...0a 00 27 00 00 08 ......VirtualBox Host-Only Ethernet Adapter\n  4...d0 50 99 93 d7 0e ......Intel(R) Ethernet Connection (2) I219-V\n  1...........................Software Loopback Interface 1\n  6...00 00 00 00 00 00 00 e0 Microsoft ISATAP Adapter\n  7...00 00 00 00 00 00 00 e0 Teredo Tunneling Pseudo-Interface\n  3...00 00 00 00 00 00 00 e0 Microsoft ISATAP Adapter #2\n===========================================================================", "id": 192503, "attachment_id": null, "creator": "1983-01-06@gmx.net", "creation_time": "2016-07-18T20:39:44Z", "time": "2016-07-18T20:39:44Z", "is_private": false}, {"count": 8, "attachment_id": null, "bug_id": 59868, "text": "(In reply to Remy Maucherat from comment #6)\n> (In reply to Christopher Schultz from comment #4)\n> > Instead, it asks the OS what the hostname of the current machine is, then\n> > uses that. So if your hostname is \"erasmus\", then InetAddress.getLocalHost\n> > will return that name + its IP address even if you have bound the connector\n> > to 127.0.0.1.\n> \n> This is a manager webapp, and it is a section on server information, so it\n> should display the server host name, not the particular connector\n> information. This sounds really intuitive to me, it is like that in all\n> admin webapps I've seen so far.\n\n\n> So I will have to veto the proposed change for the time being and I\n> also don't see the point of documenting it (server host name means\n> the server host name ... ok, nice).\n\nWhat proposed change? I merely re-opened this issue because there is a reasonable request from the community for clarification.", "id": 192506, "time": "2016-07-18T22:22:34Z", "creator": "chris@christopherschultz.net", "creation_time": "2016-07-18T22:22:34Z", "tags": [], "is_private": false}, {"count": 9, "tags": [], "text": "I wasn't fine with changing the output to something like request.getLocalName(). I am fine with a clarification but it did seem intuitive enough at this point.", "is_private": false, "id": 192517, "creation_time": "2016-07-19T08:07:53Z", "time": "2016-07-19T08:07:53Z", "creator": "remm@apache.org", "bug_id": 59868, "attachment_id": null}, {"count": 10, "attachment_id": null, "bug_id": 59868, "is_private": false, "id": 192824, "time": "2016-08-02T15:42:26Z", "creator": "markt@apache.org", "creation_time": "2016-08-02T15:42:26Z", "tags": [], "text": "I've added some clarifications for the docs in:\n9.0.x for 9.0.0.M10 onwards\n8.5.x for 8.5.5. onwards\n8.0.x for 8.0.37 onwards\n7.0.x for 7.0.71 onwards"}]