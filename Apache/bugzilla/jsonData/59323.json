[{"count": 0, "tags": [], "bug_id": 59323, "attachment_id": 33761, "text": "Created attachment 33761\nSample doc to reproduce the issue\n\nWhen trying to process the document having bookmarks using POI, we get the following exception and the sample file is also attached to reproduce the issue.\n\nCODE :\n\nimport org.apache.poi.hwpf.HWPFDocument;\nimport org.apache.poi.hwpf.HWPFDocumentCore;\nimport org.apache.poi.hwpf.converter.WordToHtmlConverter;\nimport org.w3c.dom.Document;\n\nimport javax.xml.parsers.DocumentBuilderFactory;\nimport java.io.File;\nimport java.io.FileInputStream;\n\npublic class PoiIssues {\n\n    public static void main(String[] args) throws Exception {\n        File file = new File(\"C:\\\\test_wonders_of_world.doc\");\n        FileInputStream fileInputStream = new FileInputStream(file);\n        Document document = DocumentBuilderFactory.newInstance().newDocumentBuilder().newDocument();\n        WordToHtmlConverter wordToHtmlConverter = new WordToHtmlConverter(document);\n        HWPFDocumentCore hwpfDocumentCore = new HWPFDocument(HWPFDocumentCore.verifyAndBuildPOIFS(fileInputStream));\n        wordToHtmlConverter.processDocument(hwpfDocumentCore);\n        System.out.println(document.toString());\n        System.out.println(\"Process Complete\");\n    }\n}\n \nEXCEPTION : \n\nException in thread \"main\" java.lang.IllegalArgumentException: The end (117) must not be before the start (175)\n\tat org.apache.poi.hwpf.usermodel.Range.sanityCheckStartEnd(Range.java:213)\n\tat org.apache.poi.hwpf.usermodel.Range.<init>(Range.java:175)\n\tat org.apache.poi.hwpf.converter.AbstractWordConverter$2.<init>(AbstractWordConverter.java:411)\n\tat org.apache.poi.hwpf.converter.AbstractWordConverter.processCharacters(AbstractWordConverter.java:410)\n\tat org.apache.poi.hwpf.converter.WordToHtmlConverter.processParagraph(WordToHtmlConverter.java:576)\n\tat org.apache.poi.hwpf.converter.AbstractWordConverter.processParagraphes(AbstractWordConverter.java:1111)\n\tat org.apache.poi.hwpf.converter.WordToHtmlConverter.processSingleSection(WordToHtmlConverter.java:608)\n\tat org.apache.poi.hwpf.converter.AbstractWordConverter.processDocument(AbstractWordConverter.java:721)\n\tat PoiIssues.main(PoiIssues.java:20)", "id": 190249, "time": "2016-04-14T15:55:55Z", "creator": "adityagaitonde@gmail.com", "creation_time": "2016-04-14T15:55:55Z", "is_private": false}]