[{"count": 0, "tags": [], "bug_id": 54907, "attachment_id": 30241, "text": "Created attachment 30241\nThe attached excel file for these issue has a external links\n\nJust as simple test, I used POI to read the xlsx file and then immediately write it out without any modification.  \nAfter writing with POI the xlsx file is unreadable by MS Excel 2010: \nExcel found unreadable content in 'xxx.xlsx'. Do you want to recover the contents of this workbook?\n\nThis is most likely happening because that the external links in workbook contain U+3000 \"IDEOGRAPHIC SPACE\" character (commonly called a 'full-width space').\n\n\u203b how to create external links in excel\n Define a name by using the New Name dialog box\n 1.On the Formulas tab, in the Defined Names group, click Define Name.\n 2.In the New Name dialog box, in the Name box, type the name.\n 3.To specify the scope of the name, select Workbook.\n 4.In the Refers to box, type the cell reference of External Excel file.\n   ex)='D:\\[1\u3000test.xlsx]Sheet1'!$A$2\n\nThis is the code I used: \n\n/////////////////////////////////\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\n\nimport org.apache.poi.ss.usermodel.Workbook;\nimport org.apache.poi.ss.usermodel.WorkbookFactory;\n\npublic class ExternalLinkTest {\n\n\tpublic static void main(String[] args) {\n\n\t\tWorkbook workBook = null;\n\t\ttry {\n\t\t\tworkBook = WorkbookFactory\n\t\t\t    .create(new FileInputStream(\"externalLink.xlsx\"));\n\n\t\t\tFileOutputStream fileOut;\n\t\t\tfileOut = new FileOutputStream(\"output_externalLink.xlsx\");\n\t\t\tworkBook.write(fileOut);\n\t\t\tfileOut.close();\n\t\t} catch (Exception e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n}\n/////////////////////////////////", "id": 166950, "time": "2013-04-30T06:53:33Z", "creator": "hongzune@gmail.com", "creation_time": "2013-04-30T06:53:33Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 54907, "is_private": false, "id": 166951, "attachment_id": 30242, "creator": "hongzune@gmail.com", "creation_time": "2013-04-30T06:55:11Z", "time": "2013-04-30T06:55:11Z", "text": "Created attachment 30242\nThe file which produces Unreadable content error"}, {"count": 2, "tags": [], "bug_id": 54907, "is_private": false, "id": 167415, "attachment_id": null, "creator": "dominik.stadler@gmx.at", "creation_time": "2013-05-25T14:52:57Z", "time": "2013-05-25T14:52:57Z", "text": "POI itself can read the file back in, however in the .xlsx file that is generated by POI, the file under /xl/externalLinks/_rels/externalLink1.xml.rels is missing completely in the resulting file."}]