[{"count": 0, "tags": [], "bug_id": 47076, "is_private": false, "id": 126439, "creation_time": "2009-04-22T07:30:45Z", "time": "2009-04-22T07:30:45Z", "creator": "kishore.kandrup@nomura.com", "text": "Hi,\n\n I am using jars of version as below :\n\npoi-3.1-FINAL.jar\npoi-scratchpad-3.0.1-FINAL.jar\npoi-contrib-3.1-FINAL.jar\n\nI am getting bwelow error(The java code is pasted at the bottom) :\n\n\nCore POI 11 came from file:/H:/Kishor/bcu/lib/poi-scratchpad-3.0.1-FINAL.jar!/org/apache/poi/POIDocument.class\nCreate FS 11 and Filename is  H:\\Kishor\\Research\\EmailWorkFlow\\Web_Server_Comparison.xls\nINPUT IS java.io.FileInputStream@19efb05\nAfter fs IS org.apache.poi.poifs.filesystem.POIFSFileSystem@133796\nException in thread \"main\" java.lang.NoSuchMethodError: org.apache.poi.POIDocument.<init>(Lorg/apache/poi/poifs/filesystem/DirectoryNode;Lorg/apache/poi/poifs/filesystem/POIFSFileSystem;)V\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:225)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:169)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:151)\n\tat com.lehman.pcs.bcu.util.ExtractImage.main(ExtractImage.java:48)\n\n\nThe java code is :\n\n\npackage com.lehman.pcs.bcu.util;\n\nimport java.io.BufferedInputStream;\nimport java.io.FileInputStream;\nimport java.io.InputStream;\nimport java.net.URL;\nimport java.util.Iterator;\nimport java.util.List;\n\nimport org.apache.poi.hssf.extractor.ExcelExtractor;\nimport org.apache.poi.hssf.usermodel.HSSFObjectData;\nimport org.apache.poi.hssf.usermodel.HSSFPictureData;\nimport org.apache.poi.hssf.usermodel.HSSFWorkbook;\nimport org.apache.poi.poifs.filesystem.POIFSFileSystem;\n\npublic class ExtractImage {\n\n\t/**\n\t * @param args\n\t */\n\tpublic static void main(String[] args) throws Exception {\n\t\t// TODO Auto-generated method stub\n\t\t\n//\t\tClassLoader classloader = org.apache.poi.poifs.filesystem.POIFSFileSystem.class.getClassLoader(); \n//\t\tURL res = classloader.getResource(\"org/apache/poi/poifs/filesystem/POIFSFileSystem.class\"); \n//\t\tString st = res.getPath(); \n//\t\tSystem.out.println(\"Core POI came from \" + st);\n\t\t\n\t\t\n\t\tClassLoader classloader = org.apache.poi.POIDocument.class.getClassLoader(); \n\t\tURL res = classloader.getResource(\"org/apache/poi/POIDocument.class\"); \n\t\tString st = res.getPath(); \n\t\tSystem.out.println(\"Core POI 11 came from \" + st);\n\t\t\n        String fileName = \"H:\\\\Kishor\\\\Research\\\\EmailWorkFlow\\\\Web_Server_Comparison.xls\";\n   \t \tSystem.out.println(\"Create FS 11 and Filename is  \"+ fileName);\n   \t \tInputStream input = ExtractImage.class.getResourceAsStream(fileName);\n//   \t \tFileInputStream fin = new FileInputStream(fileName);\n//\t\t// create a new\torg.apache.poi.poifs.filesystem.Filesystem\n//\t\tBufferedInputStream bis = new BufferedInputStream(fin);\n//\t\tPOIFSFileSystem poifs = new POIFSFileSystem(bis);\n//\t\t\n//\t\t//HSSFWorkbook wb = new HSSFWorkbook(poifs);\n   \t \tinput = new FileInputStream(fileName);\n   \t \tSystem.out.println(\"INPUT IS \" + input);\n        POIFSFileSystem fs = new POIFSFileSystem(input); \n        System.out.println(\"After fs IS \" + fs);\n\t\t HSSFWorkbook wb = new HSSFWorkbook(fs);\t\n\t\t System.out.println(\"After WB \" + wb);\n\t\t \n\t\t //ExcelExtractor ee = new ExcelExtractor(wb);\n\t\t //ee.getSummaryInformation().\n\t\t \n\t\t List list = wb.getAllEmbeddedObjects();\n\t\t \n\t\t Iterator it = list.iterator();\n\t\t \n\t\t while (it.hasNext())\n\t\t {\n\t\t\t HSSFObjectData hObj = (HSSFObjectData) it.next();\n\t\t\t System.out.println(\"Ho.String \" + hObj.toString());\n\t\t }\n\t\t \n\t\t List picList = wb.getAllPictures();\n\t\t Iterator it1 = picList.iterator();\n\t\t \n\t\t while (it1.hasNext())\n\t\t {\n\t\t\t while (it1.hasNext())\n\t\t\t {\n\t\t\t\t HSSFPictureData hd = (HSSFPictureData) it1.next();\n\t\t\t\t System.out.println(\"HD.String \" + hd.toString());\n\t\t\t }\n\t\t\t \n\t\t }\n\t\t //\n\t\t\n\t}\n\n}", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 47076, "is_private": false, "text": "You cannot mix versions of POI:\n\npoi-3.1-FINAL.jar\npoi-scratchpad-3.0.1-FINAL.jar\npoi-contrib-3.1-FINAL.jar\n\n\nWhy are submitting the same bug a second time?", "id": 126441, "time": "2009-04-22T07:34:05Z", "creator": "dfisher@jmlafferty.com", "creation_time": "2009-04-22T07:34:05Z", "attachment_id": null}]