[{"count": 0, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "attachment_id": null, "id": 152515, "time": "2012-01-01T21:59:41Z", "bug_id": 52409, "creation_time": "2012-01-01T21:59:41Z", "is_private": false, "text": "Concerns r1210141\n\nIs it regular that HttpSamplerBase#errorResult modifies the parameter SampleResult instead of creating one ?\n- For example, in downloadPageResources in case of HTMLParseException, res.addSubResult(errorResult(e, res)); will add a SubResult that is the same as ParentResult.\n- In same method, same issue if ClassCastException occurs\n- Same in cas of TimeoutException\n- Same issue in resultProcessing"}, {"count": 1, "tags": [], "text": "The idea of the method was to simplify setting up all the required fields.\n\nMost samplers start by creating an empty sampleResult; if the sample fails, this needs to be populated with the error details.\n\nThe way it is used in downloadPageResources is incorrect; that should create a new result first.\n\nIt was probably a mistake for the method to return the sampleResult, but changing this might cause user code to break.\n\nPerhaps there need to be two new methods:\n- createErrorResult, which returns a SampleResult\n- setUpErrorResult, which populates an existing SampleResult and returns void.\n\nIn the meantime, I will fix the incorrect calls where the method is used to create a sub-result.", "is_private": false, "id": 152591, "creator": "sebb@apache.org", "time": "2012-01-05T12:49:30Z", "bug_id": 52409, "creation_time": "2012-01-05T12:49:30Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 52409, "is_private": false, "text": "Note: an alternative solution would be to always create a new SampleResult from the passed-in parameter, but that seems rather wasteful, and would change the class in some cases.", "id": 152593, "time": "2012-01-05T13:17:52Z", "creator": "sebb@apache.org", "creation_time": "2012-01-05T13:17:52Z", "attachment_id": null}, {"count": 3, "tags": [], "text": "(In reply to comment #2)\n> Note: an alternative solution would be to always create a new SampleResult from\n\nCorrection: that should be HTTPSampleResult\n\n> the passed-in parameter, but that seems rather wasteful, and would change the\n> class in some cases.\n\nCorrection: would not change the class, unless HTTPSampleResult is ever sub-classed.", "attachment_id": null, "id": 152594, "creator": "sebb@apache.org", "time": "2012-01-05T13:24:07Z", "bug_id": 52409, "creation_time": "2012-01-05T13:24:07Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 52409, "is_private": false, "text": "Added fix for incorrect subsample calls:\n\nURL: http://svn.apache.org/viewvc?rev=1227584&view=rev\nLog:\nBug 52409 - HttpSamplerBase#errorResult modifies sampleResult passed as parameter;\nfix code which assumes that a new instance is created (i.e. when adding a sub-sample)\n\nModified:\n   jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/sampler/HTTPSamplerBase.java\n   jmeter/trunk/xdocs/changes.xml\n\nLeaving open for now, in case there are any other needed changes.", "id": 152596, "time": "2012-01-05T13:51:42Z", "creator": "sebb@apache.org", "creation_time": "2012-01-05T13:51:42Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 52409, "attachment_id": null, "text": "I close issue as it seems ok for me.", "id": 152987, "time": "2012-01-20T22:25:20Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2012-01-20T22:25:20Z", "is_private": false}]