[{"count": 0, "tags": [], "text": "There is a Classpath Problem with the LogerFactory when trying to use the JK2\nConnector. The Exception occurs on startup \n\nEither one gets a NullPointerExeption  export JAVA_OPTS=\"-Xmx64M -Xss512k\n-Xbootclasspath/a:/opt/jakarta-tomcat-4.1.18-LE-jdk14/common/lib/commons-logging-api.jar:/opt/jakarta-tomcat-4.1.18-LE-jdk14/server/lib/commons-logging.jar\"\nandi@ibh03:/opt/jakarta-tomcat-4.1.18-LE-jdk14/bin> catalina.sh run\nUsing CATALINA_BASE:   /opt/jakarta-tomcat-4.1.18-LE-jdk14\nUsing CATALINA_HOME:   /opt/jakarta-tomcat-4.1.18-LE-jdk14\nUsing CATALINA_TMPDIR: /opt/jakarta-tomcat-4.1.18-LE-jdk14/temp\nUsing JAVA_HOME:       /usr/lib/java\norg.apache.commons.logging.LogConfigurationException: java.lang.NullPointerException\n        at org.apache.commons.logging.LogFactory.newFactory(LogFactory.java:558)\n        at org.apache.commons.logging.LogFactory.getFactory(LogFactory.java:355)\n        at org.apache.commons.logging.LogFactory.getLog(LogFactory.java:409)\n        at org.apache.commons.digester.Digester.<init>(Digester.java:345)\n        at\norg.apache.catalina.startup.Catalina.createStartDigester(Catalina.java:280)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:441)\n        at org.apache.catalina.startup.Catalina.execute(Catalina.java:400)\n        at org.apache.catalina.startup.Catalina.process(Catalina.java:180)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:324)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:203)\nCaused by: java.lang.NullPointerException\n        at org.apache.commons.logging.LogFactory.newFactory(LogFactory.java:543)\n        ... 12 more\n\nor if the common-loging*.jar files are not added to the BootClasspath and \nleft in their default directories (common/lib resp. server/lib) one gets:\n[Loaded org.apache.jk.apr.AprImpl from\n/opt/jakarta-tomcat-4.1.18-LE-jdk14/bin/tomcat-jni.jar]\n13.02.2003 16:38:45 org.apache.jk.server.JkMain newHandler\nSERVE: Can't create apr\njava.lang.NoClassDefFoundError: org/apache/commons/logging/LogFactory\n        at org.apache.jk.apr.AprImpl.<clinit>(AprImpl.java:340)\n        at java.lang.Class.forName0(Native Method)\n        at java.lang.Class.forName(Class.java:140)\n        at org.apache.jk.server.JkMain.newHandler(JkMain.java:556)\n        at org.apache.jk.server.JkMain.start(JkMain.java:341)\n        at org.apache.jk.server.JkCoyoteHandler.start(JkCoyoteHandler.java:169)\n        at\norg.apache.coyote.tomcat4.CoyoteConnector.start(CoyoteConnector.java:1056)\n        at org.apache.catalina.core.StandardService.start(StandardService.java:506)\n        at org.apache.catalina.core.StandardServer.start(StandardServer.java:2189)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:512)\n        at org.apache.catalina.startup.Catalina.execute(Catalina.java:400)\n        at org.apache.catalina.startup.Catalina.process(Catalina.java:180)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:324)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:203)\n\nIf one creates a verbose output of what happens in the last case ( the\nClassNotFoundException) one finds the following: \n----\n...\n[Loaded org.apache.commons.digester.SetRootRule]\n[Loaded org.apache.commons.digester.FactoryCreateRule]\n[Loaded org.apache.commons.digester.CallParamRule]\n[Loaded org.apache.commons.digester.CallMethodRule]\n[Loaded org.apache.commons.digester.BeanPropertySetterRule]\n[Loaded org.apache.commons.digester.Rules]\n[Loaded org.apache.commons.digester.SetNextRule]\n[Loaded org.apache.commons.digester.SetPropertiesRule]\n[Loaded org.apache.commons.digester.ObjectCreateRule]\n[Loaded org.apache.commons.collections.ArrayStack]\n[Loaded org.apache.commons.logging.LogFactory]\n[Loaded org.apache.commons.logging.LogConfigurationException]\n...\nApache Tomcat/4.1.18-LE-jdk14\n[Loaded org.apache.catalina.core.StandardEngineMapper]\n[Loaded org.apache.catalina.valves.ErrorReportValve]\n[Loaded java.io.StringWriter from /usr/local/j2sdk1.4.1_01/jre/lib/rt.jar]\n[Loaded sun.reflect.GeneratedConstructorAccessor7]\n[Loaded org.apache.catalina.valves.ErrorDispatcherValve]\n[Loaded javax.servlet.ServletRequest]\n[Loaded javax.servlet.ServletResponse]\n[Loaded org.apache.catalina.core.StandardHostMapper]\n[Dynamic-linking native method java.io.FileOutputStream.openAppend ... JNI]\n[Loaded org.apache.jk.apr.AprImpl from\n/opt/jakarta-tomcat-4.1.18-LE-jdk14/bin/tomcat-jni.jar]\n13.02.2003 16:38:45 org.apache.jk.server.JkMain newHandler\nSERVE: Can't create apr\njava.lang.NoClassDefFoundError: org/apache/commons/logging/LogFactory\n        at org.apache.jk.apr.AprImpl.<clinit>(AprImpl.java:340)\n        at java.lang.Class.forName0(Native Method)\n...\n----\n\nThe Class LogFactory was allready found when used by the Digester if it comes to\nloading the AprImpl class suddenly the LogerFactroy can't be found any longer.\n\nThe used java version is: java full version \"1.4.1_01-b01\"\n\nOperating System: Linux version 2.4.10-4GB (root@ibh03) (gcc version 2.95.3\n20010315 (SuSE)) #1 Sam Feb 16 15:05:16 CET 2002\n\nSomething similar happens when trying to use the current released version\nof log4j. Putting log4j.jar into the common/lib directory gives a\nNullPointerException putting it into $JAVA_HOME/jre/lib/ext gives the\nClassNotFoundException from above.", "attachment_id": null, "id": 31248, "creation_time": "2003-02-13T17:19:09Z", "time": "2003-02-13T17:19:09Z", "creator": "hiltenkamp@web.de", "bug_id": 17051, "is_private": false}, {"count": 1, "tags": [], "text": "Created attachment 4860\nMy server.xml", "is_private": false, "id": 31249, "creation_time": "2003-02-13T17:20:29Z", "time": "2003-02-13T17:20:29Z", "creator": "hiltenkamp@web.de", "bug_id": 17051, "attachment_id": 4860}, {"count": 2, "tags": [], "text": "Created attachment 4861\ncomplete verbose of the java environment with ClassNotFoundException", "is_private": false, "bug_id": 17051, "id": 31250, "time": "2003-02-13T17:21:48Z", "creator": "hiltenkamp@web.de", "creation_time": "2003-02-13T17:21:48Z", "attachment_id": 4861}, {"count": 3, "tags": [], "bug_id": 17051, "is_private": false, "id": 31251, "attachment_id": null, "creator": "remm@apache.org", "creation_time": "2003-02-13T17:22:50Z", "time": "2003-02-13T17:22:50Z", "text": "At least the second error has been fixed in 4.1.20. I think the first one may be\nrelated."}, {"count": 4, "tags": [], "bug_id": 17051, "is_private": false, "text": "This still happens for me with tomcat 4.1.24 on MacOS X.   Same exact error.", "id": 39616, "time": "2003-06-30T02:10:19Z", "creator": "ballen@sunflower.com", "creation_time": "2003-06-30T02:10:19Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 69829, "time": "2005-01-19T00:00:41Z", "bug_id": 17051, "creation_time": "2005-01-19T00:00:41Z", "is_private": false, "text": "JK2 is deprecated.\nhttp://jakarta.apache.org/tomcat/connectors-doc/news/20041100.html#20041115.1"}]