[{"count": 0, "tags": [], "creator": "stephen.bell@cedar.com", "text": "Could you have a look at this? Create a legit jar file, say build.jar, in the\ncurrent directory on Windows NT4, then process a build file like this:\n\n<project default=\"clean\">\n<target name=\"clean\">\n<delete>\n<fileset dir=\".\" includes=\"build.jar\"/>\n</delete>\n</target>\n</project>\n\nThe delete fails. I looked at this with filemon, and I suspect that build.jar is\nopen at the time the delete happens. Worked OK at 1.5.4.", "id": 50492, "time": "2004-01-13T21:28:12Z", "bug_id": 26108, "creation_time": "2004-01-13T21:28:12Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "jan@materne.de", "text": "I extended your buildfile for tests:\n\n<project default=\"clean\">\n    <target name=\"create\">\n        <jar destfile=\"build.jar\" includes=\"build.xml\"/>\n    </target>\n\n    <target name=\"clean\">\n        <echo>Using ${ant.version}</echo>\n        <delete>\n            <fileset dir=\".\" includes=\"build.jar\"/>\n        </delete>\n    </target>\n</project>\n\n\nAnd tried that with several Ant versions (one ant invocation for creating and \nanother one for deleting):\n\nclean:\n     [echo] Using Apache Ant version 1.7alpha compiled on November 18 2003\n   [delete] Deleting 1 files from C:\\temp\\xxx\n\nBUILD SUCCESSFUL\n\nclean:\n     [echo] Using Apache Ant version 1.5.4 compiled on August 12 2003\n   [delete] Deleting 1 files from C:\\temp\\xxx\n\nBUILD SUCCESSFUL\n\nclean:\n     [echo] Using Apache Ant version 1.6beta2 compiled on October 16 2003\n   [delete] Deleting 1 files from C:\\temp\\xxx\n\nBUILD SUCCESSFUL\n\nclean:\n     [echo] Using Apache Ant version 1.6beta3 compiled on December 5 2003\n   [delete] Deleting 1 files from C:\\temp\\xxx\n\nBUILD SUCCESSFUL\n\nclean:\n     [echo] Using Apache Ant version 1.6.0 compiled on December 18 2003\n   [delete] Deleting 1 files from C:\\temp\\xxx\n\nBUILD SUCCESSFUL\n\n \n\nMmmh ... oh: I\u00b4m working on a W2K computer. So someone has to test that against \na NT4. Don\u00b4t know if I\u00b4ll find one ...", "id": 50526, "time": "2004-01-14T07:16:27Z", "bug_id": 26108, "creation_time": "2004-01-14T07:16:27Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 26108, "text": "That's a shame; I hoped it would recreate easily. Here's a run with your build\nfile on a Win 2K box. (I've tried not under Cygwin and with more conventional\nJDK on Win NT, with the same result, so I don't think that's anything to do with\nit.)\n\n$ ant -verbose clean\nApache Ant version 1.6.0 compiled on December 18 2003\nBuildfile: build.xml\nDetected Java version: 1.3 in: f:\\WebSphere\\AppServer\\java\\jre\nDetected OS: Windows 2000\nparsing buildfile f:\\temp\\vtemp\\build.xml with URI = file:///F:/temp/vtemp/build.xml\nProject base dir set to: F:\\temp\\vtemp\nBuild sequence for target `clean' is [clean]\nComplete build sequence is [clean, create, ]\n\nclean:\n     [echo] Using Apache Ant version 1.6.0 compiled on December 18 2003\n   [delete] Deleting 1 files from F:\\temp\\vtemp\n   [delete] Deleting F:\\temp\\vtemp\\build.jar\n\nBUILD FAILED\nF:\\temp\\vtemp\\build.xml:8: Unable to delete file F:\\temp\\vtemp\\build.jar\n\tat org.apache.tools.ant.taskdefs.Delete.removeFiles(Delete.java:651)\n\tat org.apache.tools.ant.taskdefs.Delete.execute(Delete.java:540)\n\tat org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:306)\n\tat org.apache.tools.ant.Task.perform(Task.java:401)\n\tat org.apache.tools.ant.Target.execute(Target.java:338)\n\tat org.apache.tools.ant.Target.performTasks(Target.java:365)\n\tat org.apache.tools.ant.Project.executeTarget(Project.java:1237)\n\tat org.apache.tools.ant.Project.executeTargets(Project.java:1094)\n\tat org.apache.tools.ant.Main.runBuild(Main.java:669)\n\tat org.apache.tools.ant.Main.startAnt(Main.java:220)\n\tat org.apache.tools.ant.launch.Launcher.run(Launcher.java:215)\n\tat org.apache.tools.ant.launch.Launcher.main(Launcher.java:90)\n\nTotal time: 3 seconds\n\ndb2admin@CARBON /cygdrive/f/temp/vtemp\n$ ", "count": 2, "id": 50565, "time": "2004-01-14T19:12:13Z", "creator": "stephen.bell@cedar.com", "creation_time": "2004-01-14T19:12:13Z", "is_private": false}, {"count": 3, "tags": [], "creator": "stephen.bell@cedar.com", "text": "Found out something a bit more pertinent, I think. My CLASSPATH was starting\nwith \".\". Don't know why I thought that was a good idea. Still, I don't think\nthe failure happened with 1.5.4.", "id": 50610, "time": "2004-01-15T20:01:42Z", "bug_id": 26108, "creation_time": "2004-01-15T20:01:42Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "stephen.bell@cedar.com", "attachment_id": null, "id": 50704, "time": "2004-01-18T23:59:49Z", "bug_id": 26108, "creation_time": "2004-01-18T23:59:49Z", "is_private": false, "text": "Yes, checked and it doesn't happen with 1.5.4. My very inexpert suggestion is\nthat it's to do with ant now being invoked via\norg.apache.tools.ant.launch.Launcher, constructing a ClassLoader which hangs on\nto a handle to the file I want to delete.\n\nAnyhow, no big deal, as I don't need \".\" in my classpath anyway."}, {"count": 5, "tags": [], "bug_id": 26108, "attachment_id": null, "text": "This may not sound very common, but I use the same ant to build the jars that\nare in the ant -lib <dir> in 1.6, so when I try to delete them, it fails.\n\nThe problem is that I cannot change the ant script/env to remove the -lib ONLY\nwhen I am building those jars. \n\nI am just asking for a File.deleteOnExit() option for <delete>.\n\n(this may not be the bug to post this, but sounds like the problem you had is\nrelated.)", "id": 52218, "time": "2004-02-13T01:09:26Z", "creator": "mariano@fuegolabs.com", "creation_time": "2004-02-13T01:09:26Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 26108, "attachment_id": null, "text": "This affects the Log4j build and is very reproduceable using Ant-1.6.0 and\n1.6.1.  Works fine with Ant-1.5.3-1.  When trying to run \"ant chainsaw\",\nexisting log4j.jar and chainsaw.jar files are deleted and recreated before\nrunning chainsaw (a log viewer utility).  The build fails on the deletes of the\njars.\n\nTo test this out, follow instructions here:\nhttp://logging.apache.org/log4j/docs/chainsaw.html\n\nSpecifically, download the \"install-chainsaw.xml\" which will download\ndependencies (jakarta-oro) and grab the log4j CVS.  Then cd into the\n\"logging-logj\" module and type \"ant chainsaw\".  The first time it will work\nsince the jar files won't have existed yet.  All subsequent times it fails to\ndelete the jars and breaks the build.\n\nNote:  I do have a \".\" in my system classpath.  I haven't tried removing it.  Is\nit really the problem though?  Jars don't get added to the classpath unless\nabsolutely specified.  They don't get put in the classpath simply by being in a\ndirectory in the classpath.\n\nAnyway, it would be great if this could be fixed.\n\nJake", "id": 53243, "time": "2004-03-01T03:37:22Z", "creator": "hoju@visi.com", "creation_time": "2004-03-01T03:37:22Z", "is_private": false}, {"count": 7, "tags": [], "creator": "antbugzilla.3.josh@spamgourmet.com", "attachment_id": null, "id": 53690, "time": "2004-03-09T00:23:25Z", "bug_id": 26108, "creation_time": "2004-03-09T00:23:25Z", "is_private": false, "text": "maybe not directly related, but I was building jar files into a directory that I\nhad used in a \"path\" tag, and was unable to delete them until I specifically\nexcluded the files from the path.\n\nbefore:\n  <path id=\"mypath\">\n    <fileset dir=\"${lib.dir}\">\n      <include name=\"*.jar\"/>\n    </fileset>\n  </path>\n\nafter:\n  <path id=\"mypath\">\n    <fileset dir=\"${lib.dir}\">\n      <include name=\"*.jar\"/>\n      <exclude name=\"fileIWantToDelete.jar\"/>\n    </fileset>\n  </path>"}, {"count": 8, "attachment_id": null, "creator": "horst@scheruga.net", "text": "I cannot delete any jar file with ant 1.6.2\nNo problem with 1.5.4\n\nUses following simple build file\n<project name=\"ci\" default=\"make\">\n\n    <property name=\"JarFile\" value=\"plot.jar\"/>\n\n    <!-- ClassPath Definition -->\n    <property name=\"build.sysclasspath\" value=\"ignore\"/>\n\n    <target name=\"jar\">\n        <delete file=\"${JarFile}\"/>\n    </target>\n\n</project>\n\nIt seems to depend on the System Classpath.\nIf the directory where the jar file exists is set in the CLASSPATH it fails.\n", "id": 54288, "time": "2004-03-19T21:52:21Z", "bug_id": 26108, "creation_time": "2004-03-19T21:52:21Z", "tags": [], "is_private": false}, {"count": 9, "tags": [], "creator": "nj2dx@yahoo.com", "text": "*** Bug 29066 has been marked as a duplicate of this bug. ***", "id": 57620, "time": "2004-05-18T17:28:19Z", "bug_id": 26108, "creation_time": "2004-05-18T17:28:19Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 26108, "attachment_id": null, "text": "Just wanted to add that I have seen this same issue in versions 1.6.0 and later \n(I also tested 1.6.1 and 1.6.2) and I am on Windows XP.  I removed the \".\" from \nmy system CLASSPATH and it resolved it for me as well.  Ant 1.5.4 worked fine \nwith the \".\" in the CLASSPATH.  I only seem to have a problem deleting .jar \nfiles, in one of my tests I called my file something else and it seemed to be \ndeleted fine.", "id": 63677, "time": "2004-09-16T20:13:51Z", "creator": "denisemahar@hotmail.com", "creation_time": "2004-09-16T20:13:51Z", "is_private": false}, {"count": 11, "tags": [], "bug_id": 26108, "attachment_id": null, "text": "Opps, I forgot to mark this as a duplicate.\n\n*** This bug has been marked as a duplicate of 28046 ***", "id": 63711, "time": "2004-09-17T08:08:50Z", "creator": "peterreilly@apache.org", "creation_time": "2004-09-17T08:08:50Z", "is_private": false}]