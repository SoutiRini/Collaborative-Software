[{"count": 0, "tags": [], "bug_id": 51143, "attachment_id": 26949, "id": 146079, "time": "2011-05-03T09:28:42Z", "creator": "f.degrigny@wyniwyg.com", "creation_time": "2011-05-03T09:28:42Z", "is_private": false, "text": "Created attachment 26949\nfiles that reproduce the bug\n\nThe following exception occurs when a tryinf to resave workbook containing a name area with characters with accent (like french ones) in its name and a comment OR no accent in the name but one in the comment.\n(the following case : characters with accent in the name and no comment, works well)\n\nException in thread \"main\" java.lang.RuntimeException: Buffer overrun\n\tat org.apache.poi.util.LittleEndianByteArrayOutputStream.checkPosition(LittleEndianByteArrayOutputStream.java:51)\n\tat org.apache.poi.util.LittleEndianByteArrayOutputStream.write(LittleEndianByteArrayOutputStream.java:88)\n\tat org.apache.poi.hssf.record.NameCommentRecord.serialize(NameCommentRecord.java:68)\n\tat org.apache.poi.hssf.record.StandardRecord.serialize(StandardRecord.java:41)\n\tat org.apache.poi.hssf.model.InternalWorkbook.serialize(InternalWorkbook.java:1036)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.getBytes(HSSFWorkbook.java:1246)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.write(HSSFWorkbook.java:1149)\n\nJava code : just open the test file and resave it with POI."}, {"count": 1, "tags": [], "bug_id": 51143, "text": "The write logic was incorrect for non US-ASCII strings (read logic was fine). Fixed in r1099313.", "id": 146096, "time": "2011-05-04T03:11:35Z", "creator": "apache@gagravarr.org", "creation_time": "2011-05-04T03:11:35Z", "is_private": false, "attachment_id": null}]