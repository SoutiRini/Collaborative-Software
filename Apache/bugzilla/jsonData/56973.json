[{"count": 0, "tags": [], "bug_id": 56973, "is_private": false, "id": 177779, "attachment_id": null, "creator": "nanaifeng@gmail.com", "creation_time": "2014-09-12T02:22:53Z", "time": "2014-09-12T02:22:53Z", "text": "Use the SXSSFWorkbook to produce a xlsx file,But use the usermode XSSF read nothing;\nxlsx write code:\nSXSSFWorkbook wb = new SXSSFWorkbook(100);\nSheet sh = wb.createSheet();\nfor(int rownum = 0; rownum < 1000; rownum++){\n    Row row = sh.createRow(rownum);\n    for(int cellnum = 0; cellnum < 10; cellnum++){\n        Cell cell = row.createCell(cellnum);\n        cell.setCellValue(\"test\");\n    }\n\n}\nFileOutputStream out = new FileOutputStream(\"/temp/sxssf.xlsx\");\nwb.write(out);\nout.close();\n// dispose of temporary files backing this workbook on disk\nwb.dispose();\n\nxlsx read code:\nOPCPackage pkg = OPCPackage.open(filename);\nXSSFReader r = new XSSFReader(pkg);\nReadOnlySharedStringsTable sst = new ReadOnlySharedStringsTable(pkg);\nXMLReader parser =                XMLReaderFactory.createXMLReader();//\"org.apache.xerces.parsers.SAXParser\");\n        handler = new SheetHandler(sst);\n        parser.setContentHandler(handler);\n        InputStream sheet2 = r.getSheet(\"rId1\");\n        InputSource sheetSource = new InputSource(sheet2);\n        parser.parse(sheetSource);\n        sheet2.close();"}, {"count": 1, "tags": [], "bug_id": 56973, "text": "The cell contents in the xlsx files poi generated, is not a string table index, but a real inline string;\nso I use the code as bellow can read the xlsx contents;\nin the handler's startElement(){\n   ....\n   if(\"s\".equals(cellType) || \"inlineStr\".equals(cellType)){\n        nextIsString = true;\n   } else {\n        nextIsString = false;\n   }\n   ....\n}\n\nendElement(){\n   ....\n   if(\"s\".equals(cellType)){\n       int index = Integer.parseInt(lastString);\n       lastString = new XSSFRichTextString(sst.getEntryAt(index)).toString();\n   } else if(\"inlineStr\".equals(cellType)){\n       System.out.println(\"inline stirng:\" + lastString);\n   }\n   ....\n}", "id": 178133, "attachment_id": null, "creator": "nanaifeng@gmail.com", "creation_time": "2014-09-27T09:30:56Z", "time": "2014-09-27T09:30:56Z", "is_private": false}]