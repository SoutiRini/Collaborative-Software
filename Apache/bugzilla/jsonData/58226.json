[{"count": 0, "tags": [], "bug_id": 58226, "attachment_id": 32983, "id": 184418, "time": "2015-08-08T06:18:55Z", "creator": "greyhat@live.in", "creation_time": "2015-08-08T06:18:55Z", "is_private": false, "text": "Created attachment 32983\nHove over the link and see the payload\n\nSetup Details : Apache/2.4.12 (Win32) OpenSSL/1.0.1m PHP/5.6.11\n\nRequest to server:\n\nGET /not_existing_link HTTP/1.1\nHost: localhost\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:39.0) Gecko/20100101 Firefox/39.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: javascript:alert(1)//452bce05\nCookie: _ga=GA1.1.1225409471.1439004440; _gat=1\nConnection: keep-alive\n\nWhen we send the above request to the server, the script in the referer header (Referer: javascript:alert(1)//452bce05) gets embedded in the error page.\n\nThis gets executed when the user clicks on the link.(Image attached)\n\nThe same can be used for SELF XSS.\n\nRecommendation: Convert respective characters from the referer header into their HTML entities."}, {"count": 1, "tags": [], "creator": "ildar.aim@gmail.com", "attachment_id": null, "text": "I have the same issue for \n\naim-server[~/tmp/deti_dohtur]$ httpd -M  \nLoaded Modules:\n core_module (static)\n so_module (static)\n http_module (static)\n authz_core_module (shared)\n access_compat_module (shared)\n socache_shmcb_module (shared)\n include_module (shared)\n mime_module (shared)\n log_config_module (shared)\n env_module (shared)\n headers_module (shared)\n setenvif_module (shared)\n ssl_module (shared)\n mpm_event_module (shared)\n unixd_module (shared)\n autoindex_module (shared)\n suexec_module (shared)\n negotiation_module (shared)\n dir_module (shared)\n actions_module (shared)\n userdir_module (shared)\n alias_module (shared)\n rewrite_module (shared)\n fastcgi_module (shared)\naim-server[~/tmp/deti_dohtur]$ httpd -V\nServer version: Apache/2.4.25 (Unix)\nServer built:   May 21 2017 22:05:06\nServer's Module Magic Number: 20120211:67\nServer loaded:  APR 1.5.2, APR-UTIL 1.5.4\nCompiled using: APR 1.5.2, APR-UTIL 1.5.4\nArchitecture:   64-bit\nServer MPM:     event\n  threaded:     yes (fixed thread count)\n    forked:     yes (variable process count)\nServer compiled with....\n -D APR_HAS_SENDFILE\n -D APR_HAS_MMAP\n -D APR_HAVE_IPV6 (IPv4-mapped addresses enabled)\n -D APR_USE_SYSVSEM_SERIALIZE\n -D APR_USE_PTHREAD_SERIALIZE\n -D SINGLE_LISTEN_UNSERIALIZED_ACCEPT\n -D APR_HAS_OTHER_CHILD\n -D AP_HAVE_RELIABLE_PIPED_LOGS\n -D DYNAMIC_MODULE_LIMIT=256\n -D HTTPD_ROOT=\"/etc/httpd\"\n -D SUEXEC_BIN=\"/usr/bin/suexec\"\n -D DEFAULT_PIDLOG=\"/run/httpd/httpd.pid\"\n -D DEFAULT_SCOREBOARD=\"logs/apache_runtime_status\"\n -D DEFAULT_ERRORLOG=\"logs/error_log\"\n -D AP_TYPES_CONFIG_FILE=\"conf/mime.types\"\n -D SERVER_CONFIG_FILE=\"conf/httpd.conf\"\naim-server[~/tmp/deti_dohtur]$ httpd -l\nCompiled in modules:\n  core.c\n  mod_so.c\n  http_core.c\naim-server[~/tmp/deti_dohtur]$ uname -a\nLinux aim-server.crtdev.local 4.11.3-1-ARCH #1 SMP PREEMPT Sun May 28 10:40:17 CEST 2017 x86_64 GNU/Linux\naim-server[~/tmp/deti_dohtur]$", "id": 199196, "time": "2017-06-14T16:28:25Z", "bug_id": 58226, "creation_time": "2017-06-14T16:28:25Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "ildar.aim@gmail.com", "is_private": false, "count": 2, "id": 199197, "time": "2017-06-14T16:33:33Z", "bug_id": 58226, "creation_time": "2017-06-14T16:33:33Z", "text": "It seems you have to change the templates likes \n/usr/share/httpd/error/HTTP_NOT_FOUND.html.var\nsanitize the HTTP_REFERER variable"}]