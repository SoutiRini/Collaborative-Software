[{"count": 0, "tags": [], "creator": "gjjagadeesh@gmail.com", "is_private": false, "id": 170525, "creation_time": "2013-10-10T00:19:23Z", "time": "2013-10-10T00:19:23Z", "bug_id": 55644, "text": "I generated one excel file using below program.\nWhen I open excel in Office 2010, then column selected for autoSizeColumn is hiding.\nIf I remove the autoSizecolumn, then it works normally.\n\npublic class Automation \n{\n\n\tpublic static void main(String[] args) \n\t{\n\n\t\tXSSFWorkbook workbook = new XSSFWorkbook();\n\t\tXSSFSheet sheet = workbook.createSheet(\"students\");\n\t\t  XSSFRow row = sheet.createRow(1);\n\t\t  XSSFCell cell = row.createCell(1);\n\t\t  cell.setCellValue(\"sandeepzzzzzzzzzzzzzzzzzzzzzzzzz\");\n\t\t  sheet.autoSizeColumn(1);\n\t\t  \n\t\ttry\n\t\t{\n\t\t\tFileOutputStream fileOut = new FileOutputStream(\"workbook.xlsx\");\n\t\t\tworkbook.write(fileOut);\n\t\t\tfileOut.close();\n\t\t}catch(Exception e)\n\t\t{\n\t\t\t\n\t\t}\n\n\n\t}\n\n}", "attachment_id": null}, {"count": 1, "attachment_id": null, "creator": "apache@gagravarr.org", "text": "Is the column hidden, or just set to a zero width?", "id": 170526, "time": "2013-10-10T06:55:38Z", "bug_id": 55644, "creation_time": "2013-10-10T06:55:38Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 55644, "is_private": false, "text": "Column is hiding.\nAfter I select the columns and Right click -> Unhide, then I'm able to see the result.\n\n(In reply to Nick Burch from comment #1)\n> Is the column hidden, or just set to a zero width?", "id": 170552, "time": "2013-10-10T19:48:23Z", "creator": "gjjagadeesh@gmail.com", "creation_time": "2013-10-10T19:48:23Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 55644, "text": "I'm getting the same behavior using Excel 2013 and poi 3.9\nIf you set a numeric value (even as a String) then the column is auto-sized correctly, for example:\ncell.setCellValue(\"12345678987654321\");", "id": 171125, "attachment_id": null, "creator": "mymiscmail0@gmail.com", "creation_time": "2013-11-07T16:20:35Z", "time": "2013-11-07T16:20:35Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 55644, "text": "I am seeing the same behavior with JDK 1.6.0_45.", "id": 171952, "time": "2013-12-28T20:12:35Z", "creator": "jcrawford@leaseaccelerator.com", "creation_time": "2013-12-28T20:12:35Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 55644, "is_private": false, "text": "Tried with latest trunk and OpenOffice/LibreOffice, but could not reproduce, will try on Windows with Excel as well.", "id": 171965, "time": "2013-12-30T19:47:50Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2013-12-30T19:47:50Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 55644, "attachment_id": null, "id": 173393, "time": "2014-02-20T10:23:59Z", "creator": "dirk.dittert@googlemail.com", "creation_time": "2014-02-20T10:23:59Z", "is_private": false, "text": "I have seen this behavior with POI-3.9 as well. Updating to POI-3.10 has resolved this issue for me.\n\nThe columns are not hidden but just have no width. The trick is to select all columns and then choose Show (last entry of context menu) to make them visible again."}, {"count": 7, "tags": [], "bug_id": 55644, "is_private": false, "text": "I tried it with Excel 2013, the column is autosized correctly when using POI 3.11-beta2/trunk.\n\nTherefore I am resolving this for now, please reopen with detailed version information if you still see this problem with recent versions of POI.", "id": 177496, "time": "2014-09-01T14:11:00Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2014-09-01T14:11:00Z", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 55644, "text": "Hi,\n\nI never succeded to reproduce on a dev environment however this seems to always happen on some customers production environment using POI 3.9 and with different JVM versions.\n\nI found a Stack Overflow topic that seems to be related to this bug (stackoverflow.com/a/14389179/1069454)\n\n\nIs there a known list of steps/conditions required to reproduce this issue?\n\nCould you also please clarify if the issue was reproduced at some point and fixed in 3.11 or if it was never reproduced by POI team. From the status (WORKSFORME) I guess it was never reproduced by POI team right?", "id": 177809, "time": "2014-09-12T12:31:40Z", "creator": "sebastien.arod@gmail.com", "creation_time": "2014-09-12T12:31:40Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 55644, "is_private": false, "id": 177858, "creation_time": "2014-09-14T14:22:30Z", "time": "2014-09-14T14:22:30Z", "creator": "sebastien.arod@gmail.com", "text": "I was able to reproduce the problem using poi 3.9.0, 3.10 and 3.11-beta2 on windows 7 with oracle jre 7u21. \n\nThis works fine with jre 7u67 on windows 7.\n\nI was not able to reproduce on ubuntu with oracle jre 7u21.", "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 55644, "is_private": false, "id": 177862, "creation_time": "2014-09-14T19:26:11Z", "time": "2014-09-14T19:26:11Z", "creator": "sebastien.arod@gmail.com", "text": "Debugging shows that using oracle jre 7u21 layout.getBounds().getWidth() returns 0 in org.apache.poi.ss.util.SheetUtil.getCellWidth(Cell, int, DataFormatter, boolean)\n\nThis may be related to this jdk bug https://bugs.openjdk.java.net/browse/JDK-8013716.\n\n\nThe problem can be mitigated by detecting when auto sizing fails and using a minimal width:\n\nsheet.autoSizeColumn(0)\nif (sheet.getColumnWidth(0) == 0) {\n  // autosize failed use MIN_WIDTH\n  sheet.setColumnWidth(0, MIN_WIDTH);\n}", "attachment_id": null}, {"count": 11, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 177875, "creation_time": "2014-09-15T10:09:44Z", "time": "2014-09-15T10:09:44Z", "bug_id": 55644, "text": "Upgrading to a non-broken JVM is probably the right fix here!", "is_private": false}, {"count": 12, "tags": [], "bug_id": 55644, "text": "I also think that we rather should require an recently patched version of Java, therefore closing this WONTFIX for now. There are many security related and many bug fixes in those newer patchlevels, so upgrading is generally a good idea.", "id": 180908, "time": "2015-02-10T16:09:53Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-02-10T16:09:53Z", "is_private": false, "attachment_id": null}]