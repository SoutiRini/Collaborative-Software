[{"count": 0, "attachment_id": null, "bug_id": 7973, "text": "I've spent several days researching this problem and have had no luck, so I'm \nassuming this is a bug:\n\nConfiguration:\n\nApache 1.3.22 with mod_ssl and mod_webapp sitting in front of Tomcat 4.03. SSL \nand mod_webApp seem to be set-up correctly as I can access the entire web \napplication via https. The problem arises when I set the user-data-constraint \nfor any of my resources to CONFIDENTIAL. When I do that, I get a null pointer \nexception whenever I try to access my webapp.\n\nServer.xml is configured with one connector: WarpConnector:\n\n<Service name=\"Tomcat-Apache\">\n\n     <Connector className=\"org.apache.catalina.connector.warp.WarpConnector\"\n     port=\"8181\" minProcessors=\"2\" maxProcessors=\"5\"\n     enableLookups=\"true\"\n     acceptCount=\"10\" redirectPort=\"443\" debug=\"9\"/>\n\n    <!-- Replace \"localhost\" with what your Apache \"ServerName\" is set to -->\n    <Engine className=\"org.apache.catalina.connector.warp.WarpEngine\"\n     name=\"develop.streetmail.com\" debug=\"9\" appBase=\"webapps\">\n\n      <!-- Global logger unless overridden at lower levels -->\n      <Logger className=\"org.apache.catalina.logger.FileLogger\"\n              prefix=\"apache_log.\" suffix=\".txt\"\n              timestamp=\"true\"/>\n\n      <!-- Because this Realm is here, an instance will be shared globally -->\n<!--\n      <Realm className=\"org.apache.catalina.realm.MemoryRealm\" />\n-->\n\n      <!-- Replace the above Realm with one of the following to get a Realm\n           stored in a database and accessed via JDBC -->\n      <Realm  className=\"org.apache.catalina.realm.JDBCRealm\" debug=\"99\"\n             driverName=\"org.gjt.mm.mysql.Driver\"\n          connectionURL=\"jdbc:mysql://citation.streetmail.com:3306/streetmail\"\n         connectionName=\"nobody\"\n     connectionPassword=\"Uf0&lt;*&gt;\"\n              userTable=\"Users\" userNameCol=\"LogIn\" userCredCol=\"TTPass\"\n          userRoleTable=\"UserRoles\" roleNameCol=\"UserType\"\n                 digest=\"MD5\" />\n    </Engine>\n  </Service>\n\nHere is an example of how my web resources are protected from web.xml:\n\n    <security-constraint>\n      <display-name>Query Security Constraint</display-name>\n      <web-resource-collection>\n         <web-resource-name>Create Query protected area</web-resource-name>\n\t <!-- Define the context-relative URL(s) to be protected -->\n         <url-pattern>/query/*</url-pattern>\n      </web-resource-collection>\n      <auth-constraint>\n         <!-- Anyone with one of the listed roles may access this area -->\n         <role-name>QUERY</role-name>\n         <role-name>RESERVE</role-name>\n         <role-name>SUBSCRIBE</role-name>\n      </auth-constraint>\n\n      <!-- Comment out when running on box with no SSL support -->\n      <user-data-constraint>\n          <transport-guarantee>CONFIDENTIAL</transport-guarantee>\n      </user-data-constraint>\n    </security-constraint>\n\n    <!-- Default login configuration uses form-based authentication -->\n    <login-config>\n      <auth-method>FORM</auth-method>\n      <realm-name>Targeting and Tracking</realm-name>\n      <form-login-config>\n        <form-login-page>/login</form-login-page>\n        <form-error-page>/login_error</form-error-page>\n      </form-login-config>\n    </login-config>\n\n\nLastly, here is the exception:\n\n2002-04-11 11:39:59 WarpEngine[develop.streetmail.com]: Mapping request\n2002-04-11 11:39:59 WarpHost[develop.streetmail.com]: Mapping request for Host\n2002-04-11 11:39:59 [org.apache.catalina.connector.warp.WarpRequestHandler]\njava.lang.NullPointerException\n        at org.apache.catalina.authenticator.AuthenticatorBase.checkUserData\n(AuthenticatorBase.java:702)\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke\n(AuthenticatorBase.java:491)\n        at org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:564)\n        at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n        at org.apache.catalina.core.StandardContext.invoke\n(StandardContext.java:2343)\n        at org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:180)\n        at org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:566)\n        at org.apache.catalina.valves.ErrorDispatcherValve.invoke\n(ErrorDispatcherValve.java:170)\n        at org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:564)\n        at org.apache.catalina.valves.ErrorReportValve.invoke\n(ErrorReportValve.java:170)\n        at org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:564)\n        at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n        at org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:174)\n        at org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:566)\n        at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n        at org.apache.catalina.connector.warp.WarpRequestHandler.handle\n(WarpRequestHandler.java:217)\n        at org.apache.catalina.connector.warp.WarpConnection.run\n(WarpConnection.java:194)\n        at java.lang.Thread.run(Thread.java:484)\n\n2002-04-11 11:40:00 [org.apache.catalina.connector.warp.WarpConnector] \nConnection from localhost/127.0.0.1:44824 t\no localhost/127.0.0.1:8181\n2002-04-11 11:40:00 \n[org.apache.catalina.connector.warp.WarpConfigurationHandler] Filter mappings \n(0)\n2002-04-11 11:40:00 \n[org.apache.catalina.connector.warp.WarpConfigurationHandler] Filter mappings \n(0)\n2002-04-11 11:40:00 [org.apache.catalina.connector.warp.WarpConnector] \nConnection from localhost/127.0.0.1:44825 t\no localhost/127.0.0.1:8181\n2002-04-11 11:40:00 \n[org.apache.catalina.connector.warp.WarpConfigurationHandler] Filter mappings \n(0)\n2002-04-11 11:40:00 \n[org.apache.catalina.connector.warp.WarpConfigurationHandler] Filter mappings \n(0)\n\n\nIf I look at the code where the exception is happening, it appears as though \nthe request object is returning null instead of a Connector:\n\n        // Initialize variables we need to determine the appropriate action\n        HttpServletRequest hrequest =\n            (HttpServletRequest) request.getRequest();\n        HttpServletResponse hresponse =\n            (HttpServletResponse) response.getResponse();\n        int redirectPort = request.getConnector().getRedirectPort();", "id": 13264, "time": "2002-04-11T16:40:36Z", "creator": "rich@streetmail.com", "creation_time": "2002-04-11T16:40:36Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "jfclere@gmail.com", "is_private": false, "text": "Try the with the lastest cvs it should be fixed.", "id": 14406, "time": "2002-04-23T07:50:11Z", "bug_id": 7973, "creation_time": "2002-04-23T07:50:11Z", "attachment_id": null}]