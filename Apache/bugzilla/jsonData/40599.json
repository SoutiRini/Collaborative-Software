[{"count": 0, "tags": [], "bug_id": 40599, "attachment_id": null, "id": 94069, "time": "2006-09-25T09:16:58Z", "creator": "mbrueck@gmx.net", "creation_time": "2006-09-25T09:16:58Z", "is_private": false, "text": "I use a php script that does the NTLM challenge. Unfortunately this only works\nwith Firefox (1.5.0.7). No IE (from 5.0 to 6.0) works - after the final request,\nthe page will not show up.\n\nI enclosed some whireshark headers:\n\nNo.     Time        Source                Destination           Protocol Info\n      2 0.453037    192.168.0.25          192.168.0.202         TCP      1499 >\nhttp [SYN] Seq=0 Len=0 MSS=1460\n      3 0.448680    192.168.0.202         192.168.0.25          TCP      http >\n1499 [SYN, ACK] Seq=0 Ack=1 Win=5840 Len=0 MSS=1460\n      4 0.448735    192.168.0.25          192.168.0.202         TCP      1499 >\nhttp [ACK] Seq=1 Ack=1 Win=65535 [TCP CHECKSUM INCORRECT] Len=0\n      5 0.453533    192.168.0.25          192.168.0.202         HTTP     GET\n/bp/index.php HTTP/1.1\n      6 0.449109    192.168.0.202         192.168.0.25          TCP      http >\n1499 [ACK] Seq=1 Ack=373 Win=6432 Len=0\n      7 0.450580    192.168.0.202         192.168.0.25          HTTP    \nHTTP/1.1 401 Unauthorized\n      8 0.455151    192.168.0.202         192.168.0.25          TCP      http >\n1499 [FIN, ACK] Seq=226 Ack=373 Win=6432 Len=0\n      9 0.455177    192.168.0.25          192.168.0.202         TCP      1499 >\nhttp [ACK] Seq=373 Ack=227 Win=65310 [TCP CHECKSUM INCORRECT] Len=0\n     10 0.455479    192.168.0.25          192.168.0.202         TCP      1499 >\nhttp [FIN, ACK] Seq=373 Ack=227 Win=65310 [TCP CHECKSUM INCORRECT] Len=0\n     11 0.451032    192.168.0.202         192.168.0.25          TCP      http >\n1499 [ACK] Seq=227 Ack=374 Win=6432 Len=0\n     12 0.456433    192.168.0.25          192.168.0.202         TCP      1500 >\nhttp [SYN] Seq=0 Len=0 MSS=1460\n     13 0.456523    192.168.0.202         192.168.0.25          TCP      http >\n1500 [SYN, ACK] Seq=0 Ack=1 Win=5840 Len=0 MSS=1460\n     14 0.456541    192.168.0.25          192.168.0.202         TCP      1500 >\nhttp [ACK] Seq=1 Ack=1 Win=65535 [TCP CHECKSUM INCORRECT] Len=0\n     15 0.452194    192.168.0.25          192.168.0.202         HTTP     GET\n/bp/index.php HTTP/1.1, NTLMSSP_NEGOTIATE\n     16 0.456795    192.168.0.202         192.168.0.25          TCP      http >\n1500 [ACK] Seq=1 Ack=459 Win=6432 Len=0\n     17 0.453824    192.168.0.202         192.168.0.25          HTTP    \nHTTP/1.1 401 Unauthorized, NTLMSSP_CHALLENGE\n     18 0.454348    192.168.0.25          192.168.0.202         HTTP     GET\n/bp/index.php HTTP/1.1, NTLMSSP_AUTH, User: BEG\\mb\n     19 0.480430    192.168.0.202         192.168.0.25          TCP      http >\n1500 [FIN, ACK] Seq=283 Ack=1037 Win=7514 Len=0\n     20 0.480469    192.168.0.25          192.168.0.202         TCP      1500 >\nhttp [ACK] Seq=1037 Ack=284 Win=65253 [TCP CHECKSUM INCORRECT] Len=0\n     21 0.485137    192.168.0.25          192.168.0.202         TCP      1500 >\nhttp [FIN, ACK] Seq=1037 Ack=284 Win=65253 [TCP CHECKSUM INCORRECT] Len=0\n     22 0.481855    192.168.0.202         192.168.0.25          TCP      http >\n1500 [ACK] Seq=284 Ack=1038 Win=7514 Len=0\n\nThat is where the Internet Explorer stops. Interestingly, Firefox goes further:\n\nNo.     Time        Source                Destination           Protocol Info\n      5 4.303368    192.168.0.25          192.168.0.202         TCP      1501 >\nhttp [SYN] Seq=0 Len=0 MSS=1460\n      6 4.307940    192.168.0.202         192.168.0.25          TCP      http >\n1501 [SYN, ACK] Seq=0 Ack=1 Win=5840 Len=0 MSS=1460\n      7 4.307982    192.168.0.25          192.168.0.202         TCP      1501 >\nhttp [ACK] Seq=1 Ack=1 Win=65535 [TCP CHECKSUM INCORRECT] Len=0\n      8 4.303671    192.168.0.25          192.168.0.202         HTTP     GET\n/bp/index.php HTTP/1.1\n      9 4.308207    192.168.0.202         192.168.0.25          TCP      http >\n1501 [ACK] Seq=1 Ack=524 Win=6432 Len=0\n     10 4.332528    192.168.0.202         192.168.0.25          HTTP    \nHTTP/1.1 401 Unauthorized\n     11 4.337226    192.168.0.25          192.168.0.202         TCP      1501 >\nhttp [FIN, ACK] Seq=524 Ack=226 Win=65310 [TCP CHECKSUM INCORRECT] Len=0\n     12 4.343153    192.168.0.202         192.168.0.25          TCP      http >\n1501 [FIN, ACK] Seq=226 Ack=525 Win=6432 Len=0\n     13 4.343168    192.168.0.25          192.168.0.202         TCP      1501 >\nhttp [ACK] Seq=525 Ack=227 Win=65310 [TCP CHECKSUM INCORRECT] Len=0\n     14 4.362033    192.168.0.25          192.168.0.202         TCP      1502 >\nhttp [SYN] Seq=0 Len=0 MSS=1460\n     15 4.362141    192.168.0.202         192.168.0.25          TCP      http >\n1502 [SYN, ACK] Seq=0 Ack=1 Win=5840 Len=0 MSS=1460\n     16 4.362157    192.168.0.25          192.168.0.202         TCP      1502 >\nhttp [ACK] Seq=1 Ack=1 Win=65535 [TCP CHECKSUM INCORRECT] Len=0\n     17 4.366744    192.168.0.25          192.168.0.202         HTTP     GET\n/bp/index.php HTTP/1.1, NTLMSSP_NEGOTIATE\n     18 4.362387    192.168.0.202         192.168.0.25          TCP      http >\n1502 [ACK] Seq=1 Ack=610 Win=6699 Len=0\n     19 4.364125    192.168.0.202         192.168.0.25          HTTP    \nHTTP/1.1 401 Unauthorized, NTLMSSP_CHALLENGE\n     20 4.368641    192.168.0.202         192.168.0.25          TCP      http >\n1502 [FIN, ACK] Seq=283 Ack=610 Win=6699 Len=0\n     21 4.368660    192.168.0.25          192.168.0.202         TCP      1502 >\nhttp [ACK] Seq=610 Ack=284 Win=65253 [TCP CHECKSUM INCORRECT] Len=0\n     22 4.377823    192.168.0.25          192.168.0.202         HTTP     GET\n/bp/index.php HTTP/1.1, NTLMSSP_AUTH, User: BEG\\mb\n     23 4.377979    192.168.0.25          192.168.0.202         TCP      1502 >\nhttp [FIN, ACK] Seq=1339 Ack=284 Win=65253 [TCP CHECKSUM INCORRECT] Len=0\n     24 4.373596    192.168.0.202         192.168.0.25          TCP      http >\n1502 [ACK] Seq=284 Ack=1340 Win=8019 Len=0\n     25 4.373921    192.168.0.25          192.168.0.202         TCP      1503 >\nhttp [SYN] Seq=0 Len=0 MSS=1460\n     26 4.374004    192.168.0.202         192.168.0.25          TCP      http >\n1503 [SYN, ACK] Seq=0 Ack=1 Win=5840 Len=0 MSS=1460\n     27 4.374018    192.168.0.25          192.168.0.202         TCP      1503 >\nhttp [ACK] Seq=1 Ack=1 Win=65535 [TCP CHECKSUM INCORRECT] Len=0\n     28 4.378558    192.168.0.25          192.168.0.202         HTTP     GET\n/bp/index.php HTTP/1.1, NTLMSSP_AUTH, User: B\\m\n     29 4.374200    192.168.0.202         192.168.0.25          TCP      http >\n1503 [ACK] Seq=1 Ack=730 Win=7290 Len=0\n     30 4.427499    192.168.0.202         192.168.0.25          HTTP    \nHTTP/1.1 302 Found (text/html)\n     31 4.427626    192.168.0.202         192.168.0.25          TCP      http >\n1503 [FIN, ACK] Seq=646 Ack=730 Win=7290 Len=0\n     32 4.427657    192.168.0.25          192.168.0.202         TCP      1503 >\nhttp [ACK] Seq=730 Ack=647 Win=64890 [TCP CHECKSUM INCORRECT] Len=0\n     33 4.441356    192.168.0.25          192.168.0.202         TCP      1504 >\nhttp [SYN] Seq=0 Len=0 MSS=1460\n     34 4.441411    192.168.0.25          192.168.0.202         TCP      1503 >\nhttp [FIN, ACK] Seq=730 Ack=647 Win=64890 [TCP CHECKSUM INCORRECT] Len=0\n     35 4.437001    192.168.0.202         192.168.0.25          TCP      http >\n1504 [SYN, ACK] Seq=0 Ack=1 Win=5840 Len=0 MSS=1460\n     36 4.437032    192.168.0.25          192.168.0.202         TCP      1504 >\nhttp [ACK] Seq=1 Ack=1 Win=65535 [TCP CHECKSUM INCORRECT] Len=0\n     37 4.437048    192.168.0.202         192.168.0.25          TCP      http >\n1503 [ACK] Seq=647 Ack=731 Win=7290 Len=0\n     38 4.441631    192.168.0.25          192.168.0.202         HTTP     GET\n/bp/newpage.php HTTP/1.1\n     39 4.437267    192.168.0.202         192.168.0.25          TCP      http >\n1504 [ACK] Seq=1 Ack=526 Win=6432 Len=0\n\nNote packet 28 - why is the request retransmitted?\n\nI know that NTLM is not a priority but I hope you will find a solution!\n\nBest Regards\n\nMarco"}, {"count": 1, "tags": [], "bug_id": 40599, "text": "I do not understand what this has to do with httpd. As far as I understand you\nimplement NTLM in your own php code. So where is the bug in httpd?", "id": 94072, "time": "2006-09-25T09:56:18Z", "creator": "rpluem@apache.org", "creation_time": "2006-09-25T09:56:18Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "mbrueck@gmx.net", "text": "I am sorry that I did not explain enough:\n\nthe third \"get\" request does not open index.php ! I tried to debug the\nntlm-headers sent, but the script is not invoked despite the \"get\".\nIs this correct???\n\nSince I thought no use asking Microsoft I tried here.\n\nBest Regards\n\nMarco\n\n\n\n", "id": 94081, "attachment_id": null, "bug_id": 40599, "creation_time": "2006-09-25T12:22:43Z", "time": "2006-09-25T12:22:43Z", "is_private": false}, {"count": 3, "tags": [], "creator": "rpluem@apache.org", "attachment_id": null, "text": "(In reply to comment #2)\n> I am sorry that I did not explain enough:\n> \n> the third \"get\" request does not open index.php ! I tried to debug the\n> ntlm-headers sent, but the script is not invoked despite the \"get\".\n\nWhich 3rd GET are you talking about? The one with NTLMSSP_AUTH set?\nIf this really does not execute your PHP script please check the error log of\nhttpd and of PHP for any messages. Currently I still do not see a bug in httpd\nhere. Maybe the error logs return something useful.", "id": 94467, "time": "2006-10-04T02:13:14Z", "bug_id": 40599, "creation_time": "2006-10-04T02:13:14Z", "is_private": false}, {"count": 4, "tags": [], "text": "This is my access_log (no error reported):\n\n192.168.0.25 - - [04/Oct/2006:11:28:06 +0200] \"GET /bp/index.php HTTP/1.1\" 401 -\n\"-\" \"Mozilla/5.0 (Windows; U; Windows NT 5.1; de; rv:1.8.0.7) Gecko/20060909\nFirefox/1.5.0.7\"\n192.168.0.25 - - [04/Oct/2006:11:28:06 +0200] \"GET /bp/index.php HTTP/1.1\" 401 -\n\"-\" \"Mozilla/5.0 (Windows; U; Windows NT 5.1; de; rv:1.8.0.7) Gecko/20060909\nFirefox/1.5.0.7\"\n192.168.0.25 - - [04/Oct/2006:11:28:06 +0200] \"GET /bp/index.php HTTP/1.1\" 200\n426 \"-\" \"Mozilla/5.0 (Windows; U; Windows NT 5.1; de; rv:1.8.0.7) Gecko/20060909\nFirefox/1.5.0.7\"\n192.168.0.25 - - [04/Oct/2006:11:29:47 +0200] \"GET /bp/index.php HTTP/1.1\" 401 -\n\"-\" \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727;\n.NET CLR 1.1.4322)\"\n192.168.0.25 - - [04/Oct/2006:11:29:47 +0200] \"GET /bp/index.php HTTP/1.1\" 401 -\n\"-\" \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727;\n.NET CLR 1.1.4322)\"\n\nYou are right, the 3rd GET is the one with NTLMSSP_AUTH set. Shouldn't it appear\nin the access_log? You can see, with Firefox it works...\nBoth httpd and php report no error, I will try to increase the level of reporting!\nbest regards\nMarco\n\n", "is_private": false, "bug_id": 40599, "id": 94468, "time": "2006-10-04T02:37:12Z", "creator": "mbrueck@gmx.net", "creation_time": "2006-10-04T02:37:12Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 40599, "text": "I set up a 2.0.54 on a SuSE-box. There the script works as expected (3 GETs with\nIE). Since this seems to be a Fedora 4 !?! specific httpd problem, I close the\nbug . Thanks for your help so far!\nBest regards\nMarco", "id": 94469, "time": "2006-10-04T03:33:23Z", "creator": "mbrueck@gmx.net", "creation_time": "2006-10-04T03:33:23Z", "is_private": false, "attachment_id": null}]