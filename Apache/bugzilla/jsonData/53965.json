[{"count": 0, "tags": [], "bug_id": 53965, "attachment_id": null, "id": 162563, "time": "2012-10-04T13:55:02Z", "creator": "sowen@cs.manchester.ac.uk", "creation_time": "2012-10-04T13:55:02Z", "is_private": false, "text": "I've encountered a problem using custom Data Validations with XSSF sheets. Adding the validation seems to work OK, but afterwards when I try getValidations I get an XmlValueOutOfRangeException (full stack trace below). The contents of the validation formula doesn't seem to matter, and things seem to work correctly if I load a xlsx workbook containing custom validations and then try to access them. Here is some simplified example code that demonstrates the problem:\n\n        XSSFWorkbook wb = new XSSFWorkbook();\n        XSSFSheet sheet = wb.createSheet();\n        sheet.getDataValidations();    //<-- works\n\n        //create the cell that will have the validation applied\n        sheet.createRow(0).createCell(0);\n\n        DataValidationHelper dataValidationHelper = sheet.getDataValidationHelper();\n        DataValidationConstraint constraint = dataValidationHelper.createCustomConstraint(\"SUM($A$1:$A$1) <= 3500\");\n        CellRangeAddressList addressList = new CellRangeAddressList(0, 0, 0, 0);\n        DataValidation validation = dataValidationHelper.createValidation(constraint, addressList);\n        sheet.addValidationData(validation);\n\n        sheet.getDataValidations();    //<-- raised XmlValueOutOfRangeException\n\nI also have the same problem when operating on an exisiting workbook that contains sheets and cells, I've just simplified the code above."}, {"count": 1, "tags": [], "text": "Fixed in r1396650\n\nYegor", "is_private": false, "id": 162668, "creator": "yegor@dinom.ru", "time": "2012-10-10T15:42:25Z", "bug_id": 53965, "creation_time": "2012-10-10T15:42:25Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 53965, "attachment_id": null, "id": 162719, "time": "2012-10-12T15:04:34Z", "creator": "sowen@cs.manchester.ac.uk", "creation_time": "2012-10-12T15:04:34Z", "is_private": false, "text": "Trying the nightly build (20121011), I can confirm that this is now fixed. Thanks Yegor."}]