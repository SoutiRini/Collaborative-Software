[{"count": 0, "tags": [], "bug_id": 57425, "text": "In Tomcat versions prior to 7.0.35, the servlet context attribute \"javax.servlet.context.orderedLibs\" has a null value (a fix was added to Tomcat in https://issues.apache.org/bugzilla/show_bug.cgi?id=54391). \n\nWhen context replication is not used, the StandardContext.setAttribute method checks for and handles a null value by invoking StandardContext.removeAttribute. However, when context replication is enabled the null value is passed to ConcurrentHashMap.put which throws a NullPointerException. This causes the context to fail startup.", "id": 180221, "time": "2015-01-07T20:25:34Z", "creator": "jlandin@gmail.com", "creation_time": "2015-01-07T20:25:34Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 57425, "attachment_id": null, "text": "This work item is to make ReplicatedContext behave the way StandardContext does for null values.", "id": 180222, "time": "2015-01-07T20:28:22Z", "creator": "jlandin@gmail.com", "creation_time": "2015-01-07T20:28:22Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 57425, "is_private": false, "text": "Created attachment 32358\nDon't add orderedLibs attribute if it is null\n\nThe attached patch is for tomcat 8. But the same logic would apply to tomcat 7. The file in tomcat 7 is named java/org/apache/catalina/deploy/WebXml.java. It applies cleanly for trunk.\n\nThe idea is to not store the attribute, if it is null, since getAttribute will give a null value, if the attribute is not present and the replicated context fails, if the concurrent hashmap gets a null as a value or a key.\n\nIf noone objects, I will apply the patch.", "id": 180231, "time": "2015-01-08T18:57:16Z", "creator": "felix.schumacher@internetallee.de", "creation_time": "2015-01-08T18:57:16Z", "attachment_id": 32358}, {"count": 3, "tags": [], "bug_id": 57425, "is_private": false, "text": "I'd suggest that this is fixing the symptom rather than the root cause.\n\nI think it would be better to replicate the correct handling of setAttribute(String,null) (which is to remove the attribute) in ReplicatedContext.ReplApplContext", "id": 180232, "time": "2015-01-08T20:53:10Z", "creator": "markt@apache.org", "creation_time": "2015-01-08T20:53:10Z", "attachment_id": null}, {"count": 4, "attachment_id": 32363, "bug_id": 57425, "is_private": false, "id": 180257, "time": "2015-01-11T13:26:19Z", "creator": "felix.schumacher@internetallee.de", "creation_time": "2015-01-11T13:26:19Z", "tags": [], "text": "Created attachment 32363\nDon't add context attribute if it is null\n\nDon't add a context attribute if its value or name is null.\n\nFor the test case the bugfix 57431 will have to be applied."}, {"count": 5, "attachment_id": null, "bug_id": 57425, "is_private": false, "id": 180286, "time": "2015-01-13T20:05:47Z", "creator": "felix.schumacher@internetallee.de", "creation_time": "2015-01-13T20:05:47Z", "tags": [], "text": "Included in trunk (r1651120, r1651280). Will be included in 8.0.18 (r1651421, r1651422) and tomcat 7.0.58 (r1651439, r1651446)."}, {"count": 6, "tags": [], "creator": "jlandin@gmail.com", "is_private": false, "text": "Looks good. Thanks for the quick attention on this.", "id": 180287, "time": "2015-01-13T20:13:31Z", "bug_id": 57425, "creation_time": "2015-01-13T20:13:31Z", "attachment_id": null}]