[{"count": 0, "tags": [], "text": "On TIKA-2134, Seva Alekseyev submitted an example xlsx file that triggers an NPE when a shape is missing from the file.\n\nExcel appears to silently ignore shape relationships that don't include the file.  \n\nCaused by: java.lang.NullPointerException\n\tat org.apache.poi.xssf.usermodel.XSSFDrawing.<init>(XSSFDrawing.java:89)\n\tat org.apache.poi.xssf.usermodel.XSSFDrawing.<init>(XSSFDrawing.java:97)\n\tat org.apache.poi.xssf.eventusermodel.XSSFReader$SheetIterator.getShapes(XSSFReader.java:322)\n\tat org.apache.tika.parser.microsoft.ooxml.XSSFExcelExtractorDecorator.buildXHTML(XSSFExcelExtractorDecorator.java:162)", "attachment_id": null, "id": 196054, "creator": "tallison@mitre.org", "time": "2017-01-13T13:40:38Z", "bug_id": 60584, "creation_time": "2017-01-13T13:40:38Z", "is_private": false}, {"count": 1, "tags": [], "text": "Any objections if we add a null check in getShapes()\n\n                  PackagePart drawingsPart = sheetPkg.getPackage().getPart(drawingsName);\n                  if (drawingsPart == null) {\n                      //parts can go missing; Excel ignores them silently -- TIKA-2134/POI 60584\n                      continue;\n                  }", "is_private": false, "bug_id": 60584, "id": 196055, "time": "2017-01-13T13:41:23Z", "creator": "tallison@mitre.org", "creation_time": "2017-01-13T13:41:23Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 60584, "is_private": false, "text": "Looks fine to me. Is this a rare cases that would warrant a log.info or log.warn level entry?", "id": 196061, "time": "2017-01-13T17:35:22Z", "creator": "onealj@apache.org", "creation_time": "2017-01-13T17:35:22Z", "attachment_id": null}, {"count": 3, "tags": [], "text": "Thank you, Javen.  Added logging: warn.\n\nr1778664", "is_private": false, "bug_id": 60584, "id": 196064, "time": "2017-01-13T20:55:36Z", "creator": "tallison@mitre.org", "creation_time": "2017-01-13T20:55:36Z", "attachment_id": null}]