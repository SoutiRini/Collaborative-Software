[{"count": 0, "tags": [], "text": "OS is Redhat 7.1.  (Included is a note from craigmcc below so please read the \nwhole description)\n\nStart the tomcat server with an unexpanded web application war file (we'll call \nit bobo.war for this example) in webapps.  The tomcat server will expand it and \nadd a context as it should.  \n\nRemove the bobo.war file and its expanded directory from webapps.  Put the same \nbobo.war file into webapps, then first remove the context through the manager, \nthen install it again, through the manager, i.e... call:\n\nhttp://172.16.3.245/manager/remove?path=/bobo\nhttp://172.16.3.245/manager/install?path=/bobo&war=jar:file:/www/tomcat/jakarta-\ntomcat-4.0.1/webapps/bobo.war!/\n\nThis *should* work the first time and report no errors.  Do it again:\n\nRemove the bobo.war file and its expanded directory from webapps.  Put the same \nbobo.war file into webapps, then first remove the context through the manager, \nthen install it again, through the manager, i.e... call:\n\nhttp://172.16.3.245/manager/remove?path=/bobo\nhttp://172.16.3.245/manager/install?path=/bobo&war=jar:file:/www/tomcat/jakarta-\ntomcat-4.0.1/webapps/bobo.war!/\n\nThe install command will return with \nFAIL - Encountered exception java.lang.IllegalStateException: zip file closed\n\nI noticed this note from craigmcc while searching the web:\n--------------------------------------------------------------------------\ncraigmcc    00/10/04 18:31:06\n\nModified:    catalina/src/share/org/apache/catalina/core\n                        StandardHost.java\nLog:\nAdd a FIXME note.  The JarURLConnection mechanism seems to cache instances\nof JarFile -- even after you close them!  This prevents you from\nundeploying an application, replacing the JAR file, and redeploying the\napplication :-(.  I cannot seem to find a workaround for this at the\nmoment.\n  \nRevision  Changes    Path\n1.4       +15 -6     jakarta-tomcat-\n4.0/catalina/src/share/org/apache/catalina/core/StandardHost.java\n\n...\n\n-        jarFile.close();\n+        jarFile.close();        // FIXME - doesn't remove from cache!!!\n--------------------------------------------------------------------------\n\nIn the tomcat 4.0.1 final source package, I see that the line with the FIXME \ncomment is still there.  The issue he describes...\n\"This prevents you from undeploying an application, replacing the JAR file, and \nredeploying the application\"  \n...is the issue I am having.\n\nThanks!", "attachment_id": null, "id": 8785, "creator": "peteclark3@yahoo.com", "time": "2001-12-11T12:19:27Z", "bug_id": 5364, "creation_time": "2001-12-11T12:19:27Z", "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 5364, "is_private": false, "id": 8966, "time": "2001-12-17T01:35:14Z", "creator": "remm@apache.org", "creation_time": "2001-12-17T01:35:14Z", "tags": [], "text": "As stated by Craig and others (me included), the JDK has some issues with\nreading updated zip files. That causes problems here, and that also causes\nproblems for class reloading (when you update a JAR in /WEB-INF/lib).\nUnfortunately, it seems it can't be fixed unless the JDK is fixed (or we use an\nalternate library to read the zip), at which point it should start working. I\ndon't know if it would work better with an IBM JDK."}]