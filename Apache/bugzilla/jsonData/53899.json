[{"count": 0, "tags": [], "bug_id": 53899, "attachment_id": null, "text": "In modules/ssl/ssl_engine_init.c, the use of SSL_OP_ALL actually disables the openssl feature that works around CVE-2011-3389 (the \"BEAST\").\n\nPlease change:\n  SSL_CTX_set_options(ctx, SSL_OP_ALL);\nto\n  SSL_CTX_set_options(ctx, SSL_OP_ALL & ~SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS);", "id": 162278, "time": "2012-09-19T06:59:31Z", "creator": "me@joejulian.name", "creation_time": "2012-09-19T06:59:31Z", "is_private": false}, {"count": 1, "tags": [], "creator": "sf@sfritsch.de", "attachment_id": null, "id": 162535, "time": "2012-10-03T08:19:45Z", "bug_id": 53899, "creation_time": "2012-10-03T08:19:45Z", "is_private": false, "text": "It is my understanding that the BEAST work around needs to be enabled on the client to have any effect. So for httpd, this is only a problem with outgoing https proxy connections. Correct?"}, {"count": 2, "text": "Created attachment 30476\npatch specifically for 2.4.4\n\nThis patch is a patch for the 2.4.4 code tree. It does not include a documentation update.", "bug_id": 53899, "attachment_id": 30476, "id": 167982, "time": "2013-06-23T23:08:58Z", "creator": "michaelm12-asfbugzilla@aquaorange.net", "creation_time": "2013-06-23T23:08:58Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 53899, "text": "Created attachment 30477\n2.5-dev patch for code only", "id": 167983, "time": "2013-06-23T23:09:24Z", "creator": "michaelm12-asfbugzilla@aquaorange.net", "creation_time": "2013-06-23T23:09:24Z", "is_private": false, "attachment_id": 30477}, {"count": 4, "tags": [], "bug_id": 53899, "attachment_id": 30478, "text": "Created attachment 30478\npatch for 2.5-dev including a documentation update", "id": 167985, "time": "2013-06-23T23:09:57Z", "creator": "michaelm12-asfbugzilla@aquaorange.net", "creation_time": "2013-06-23T23:09:57Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 53899, "attachment_id": null, "text": "Note - the three patches are the same code. The 2.5-dev code only one applied against 2.5-dev, 2.4.4 and 2.2.24 successfully.\n\nI did not test the documentation one against anything but 2.5-dev.", "id": 167986, "time": "2013-06-23T23:11:01Z", "creator": "michaelm12-asfbugzilla@aquaorange.net", "creation_time": "2013-06-23T23:11:01Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 53899, "text": "As I understand it, BEAST itself is client based and as such the server can only mitigate the attack by offering ciphers which are not vulnerable (ie non-CBC ciphers).\n\nThat said - given how beast works, by getting the client to send specific data and seeing the cipher text, I would imagine that it could be theoretically possible to send requests to a server constructed in such a way that returned packets could be used to do much the same this as BEAST does for outgoing data and packets.\n\nRegardless of BEAST or not, I have created the attached patch which can be applied to 2.5-dev, 2.4.4, 2.2.24 which creates a new option \"SSLEnableEmptyFragments\". This option allows one to remove the \"SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS\" flag from SSL_OP_ALL.\n\nPlease consider this patch for inclusion into the tree. \n\nThe usual caveats apply - OpenSSL indicate there might be compatibility issues with some clients... but hey :)", "id": 167987, "time": "2013-06-23T23:12:34Z", "creator": "michaelm12-asfbugzilla@aquaorange.net", "creation_time": "2013-06-23T23:12:34Z", "is_private": false, "attachment_id": null}]