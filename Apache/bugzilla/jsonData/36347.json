[{"count": 0, "tags": [], "bug_id": 36347, "text": "The <exec> task takes a dir attribute to set the working directory of the\nexecuting program. This dir attribute is ignored on my Solaris 8 (sparc) system\nif the dir attribute is the same as the current working directory and the build\nscript is not in the current working directory.\n\nExample:\n/tmp/build.xml\n/tmp/foo -- current working directory\n/tmp/bar -- arbitrary directory\n\nbuild.xml contains:\n<project basedir=\".\" default=\"all\" name=\"ExecTest\">\n    <target name=\"all\">\n        <exec dir=\"/tmp/foo\" executable=\"/usr/bin/pwd\" />\n    </target>\n</project>\n\nFrom /tmp/foo, run: ant -f ../build.xml\nBuildfile: ../build.xml\n\nall:\n     [exec] /tmp\n\nBUILD SUCCESSFUL\nTotal time: 0 seconds\n\nChange to /tmp/bar and run the same program and you see the expected behavior.\nBuildfile: ../build.xml\n\nall:\n     [exec] /tmp/foo\n\nBUILD SUCCESSFUL\nTotal time: 0 seconds\n\nIt also works if you are in the same directory as the build file. I tested this\non Solaris, Linux, and Windows, and Solaris is the only platform where I see\nthis problem.", "id": 78951, "time": "2005-08-24T23:25:13Z", "creator": "moobob42@yahoo.com", "creation_time": "2005-08-24T23:25:13Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 36347, "attachment_id": null, "text": "Can I follow this up with a couple of questions\n\n1. what version of Java? v1.2 or something newer\n\n2. what happens if you set vmlauncher=\"false\" in the <exec> call\n\n#2 tells ant to switch to a shell script to set the dir, instead of using the\nJRE. Its there for pre-1.3 java, but it could help isolate this problem to the\nJVM itself, or to ant.", "id": 91235, "time": "2006-07-12T21:52:26Z", "creator": "stevel@apache.org", "creation_time": "2006-07-12T21:52:26Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 36347, "text": "(In reply to comment #1)\n> Can I follow this up with a couple of questions\n> \n> 1. what version of Java? v1.2 or something newer\n\nSun's Java:\njava version \"1.2.2\"\nSolaris VM (build Solaris_JDK_1.2.2_10, native threads, sunwjit)\n\nI noticed that I get the correct behavior if I use a 5.0 JRE, but see answer to\nnext question:\njava version \"1.5.0_01\"\nJava(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_01-b08)\nJava HotSpot(TM) Server VM (build 1.5.0_01-b08, mixed mode)\n\n> 2. what happens if you set vmlauncher=\"false\" in the <exec> call\n\nWith the 1.2 JRE, no change in behavior. I get the wrong result either way.\n\nWith the 5.0 JRE, I get the wrong result if I use vmlauncher=\"false\" but the\ncorrect result if I leave it out or set it to true.", "id": 91330, "time": "2006-07-15T00:11:28Z", "creator": "moobob42@yahoo.com", "creation_time": "2006-07-15T00:11:28Z", "is_private": false, "attachment_id": null}, {"count": 3, "attachment_id": null, "bug_id": 36347, "is_private": false, "id": 91337, "time": "2006-07-15T20:55:01Z", "creator": "stevel@apache.org", "creation_time": "2006-07-15T20:55:01Z", "tags": [], "text": "OK. that narrows the problem down a lot. the v1.2 was the first clue. From 1.2\nto 1.3 ant changed how it execs, because you finally got to be able to specify\nthe current dir in exec(). For 1.2, if you specify a new directory, ant runs a\nshell script, but you only get that script run in java1.3+ if you set\nvmlauncher=false.\n\nnot much of one, stripping off the apache copyright it is 8 lines.\n#! /bin/sh\n# Args: DIR command\ncd \"$1\"\nCMD=\"$2\"\nshift\nshift\nexec \"$CMD\" \"$@\"\n\nTry testing it on the command line\nantRun / ls\nand \nantRun /etc ls passwd\nto see that it is working.\n\n\nRenamed bug for more specificness. There's and no way in Execute.java to allow\ncallers to select a different helper script (like antRun.pl).\n\nThinking of this, there is one workaround. Move $ANT_HOME/bin/antRun and replace\nit with antRun.pl. You may need to patch the #! path at the top of that file to\npoint to your Perl system, and make the script exectable."}]