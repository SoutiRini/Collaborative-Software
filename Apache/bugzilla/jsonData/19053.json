[{"count": 0, "tags": [], "bug_id": 19053, "text": "when i try to open a excel file,throw this:\n\njava.lang.ClassCastException: org.apache.poi.hssf.record.LabelRecord\n\tat java.util.TreeMap.compare(TreeMap.java:1081)\n\tat java.util.TreeMap.getEntry(TreeMap.java:341)\n\tat java.util.TreeMap.get(TreeMap.java:260)\n\tat \norg.apache.poi.hssf.record.aggregates.ValueRecordsAggregate.insertCell\n(ValueRecordsAggregate.java:92)\n\tat org.apache.poi.hssf.record.aggregates.ValueRecordsAggregate.construct\n(ValueRecordsAggregate.java:151)\n\tat org.apache.poi.hssf.model.Sheet.createSheet(Sheet.java:206)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.(HSSFWorkbook.java:149)\n\nmy code:\n      String filename = \"D:\\\\study\\\\testexcel\\\\testbook.xls\";\n      FileInputStream finStream = new FileInputStream(filename);\n      POIFSFileSystem fs = new POIFSFileSystem(finStream);\n      HSSFWorkbook wb = new HSSFWorkbook(fs);//now has a Exception", "id": 35295, "time": "2003-04-16T06:42:11Z", "creator": "weitang@263.net", "creation_time": "2003-04-16T06:42:11Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "avik@apache.org", "attachment_id": null, "text": "Interesting. Can you attach a simple sheet that displays this problem?", "id": 35305, "time": "2003-04-16T09:14:10Z", "bug_id": 19053, "creation_time": "2003-04-16T09:14:10Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 19053, "is_private": false, "text": "information asked for but not provided", "id": 41373, "time": "2003-07-24T16:12:21Z", "creator": "poi-support@buni.org", "creation_time": "2003-07-24T16:12:21Z", "attachment_id": null}, {"count": 3, "attachment_id": null, "bug_id": 19053, "is_private": false, "id": 55041, "time": "2004-04-01T12:27:57Z", "creator": "perry.tew@cibavision.novartis.com", "creation_time": "2004-04-01T12:27:57Z", "tags": [], "text": "I can reproduce this error using the 2.5 final binary distribution.\nHere is my stack trace.  I will also attach the file that is causing the error,\nhowever Bugzilla keeps timing out on my during the file upload.\n\nThis error is strange, because my end user that created this file typcially\nnever has problems uploading the spreadsheet and all of the sudden the same\nspreadsheet is broken.  It opens fine in MS Excel.\n\nI wasn't sure if I should \"Reopen\" this bug or mark it as \"Verified\".  If I've\nchosen the wrong thing, forgive me.  I'm not very familar with Bugzilla yet.\n\nThanks for your help!!  I really appreciate it.\n\nTest Case:\npackage com.novartis.cibavision.websupport.excel;\n\nimport junit.framework.TestCase;\nimport java.io.*;\nimport org.apache.poi.hssf.usermodel.*;\nimport org.apache.poi.poifs.filesystem.POIFSFileSystem;\n\nimport java.net.URL;\n\npublic class TestClassCastException extends TestCase{\n\n\tpublic TestClassCastException( String name ){ super( name ); }\n\n\tpublic void testClassCastException_Bare() throws Exception{\n\n\t\tString testData =\n\"com/novartis/cibavision/websupport/excel/test_labelrecord_error.xls\";\n\t\tURL xlsURL = this.getClass().getClassLoader().getResource( testData );\n\t\tHSSFWorkbook workbook = new HSSFWorkbook(new\nBufferedInputStream(xlsURL.openStream()));\n\t\tHSSFSheet sheet = workbook.getSheet(\"Calls\");\n\t}\n\n}\n\n\n\nStack Trace:\nTestsuite: com.novartis.cibavision.websupport.excel.TestClassCastException\nTests run: 1, Failures: 0, Errors: 1, Time elapsed: 1.259 sec\n\nTestcase: testClassCastException_Bare took 1.25 sec\n        Caused an ERROR\norg.apache.poi.hssf.record.LabelRecord\njava.lang.ClassCastException: org.apache.poi.hssf.record.LabelRecord\n        at java.util.TreeMap.compare(TreeMap.java:1047)\n        at java.util.TreeMap.put(TreeMap.java:449)\n        at\norg.apache.poi.hssf.record.aggregates.ValueRecordsAggregate.insertCell(ValueRecordsAggregate.java:65)\n        at\norg.apache.poi.hssf.record.aggregates.ValueRecordsAggregate.construct(ValueRecordsAggregate.java:130)\n        at org.apache.poi.hssf.model.Sheet.createSheet(Sheet.java:192)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:174)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:212)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:193)\n        at\ncom.novartis.cibavision.websupport.excel.TestClassCastException.testClassCastException_Bare(Unknown\nSource)\n\n\n\n\n\n"}, {"count": 4, "tags": [], "bug_id": 19053, "is_private": false, "text": "I still cannot get the file upload to work.  Is there anyone I can E-mail the\nexcel sheet to that can then upload it into Bugzilla?  It's probably the\nfilewall I'm behind or something.\n\nThanks!\nPerry Tew", "id": 55044, "time": "2004-04-01T12:34:29Z", "creator": "perry.tew@cibavision.novartis.com", "creation_time": "2004-04-01T12:34:29Z", "attachment_id": null}, {"count": 5, "attachment_id": 11082, "creator": "perry.tew@cibavision.novartis.com", "is_private": false, "id": 55061, "time": "2004-04-01T15:20:49Z", "bug_id": 19053, "creation_time": "2004-04-01T15:20:49Z", "tags": [], "text": "Created attachment 11082\nExcel spreadsheet that causes java.lang.ClassCastException: org.apache.poi.hssf.record.LabelRecord"}, {"count": 6, "tags": [], "bug_id": 19053, "attachment_id": null, "text": "I found a small spreadsheet (less than 10 lines) that is causing the same error.\n Avik, you're right.  It was the size of the file that will preventing the upload.\n\n", "id": 55062, "time": "2004-04-01T15:21:42Z", "creator": "perry.tew@cibavision.novartis.com", "creation_time": "2004-04-01T15:21:42Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 19053, "is_private": false, "text": "*** Bug 28126 has been marked as a duplicate of this bug. ***", "id": 55149, "time": "2004-04-02T12:05:22Z", "creator": "avik@apache.org", "creation_time": "2004-04-02T12:05:22Z", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 19053, "attachment_id": 11132, "text": "Created attachment 11132\nJust another test worksheet.", "id": 55286, "time": "2004-04-05T08:17:34Z", "creator": "julmadrid@ya.com", "creation_time": "2004-04-05T08:17:34Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 19053, "text": "Well, Speaking about side effects, I can find that convert Label Records \nincreases number of records in woorkbook due to sst table. So you must set the \ninitial record offset prior to convert the Label Records. Otherwise, the \napplication could fall into an infinite loop due to the lost of BOF Records.\n", "id": 55288, "time": "2004-04-05T08:39:37Z", "creator": "julmadrid@ya.com", "creation_time": "2004-04-05T08:39:37Z", "is_private": false, "attachment_id": null}, {"count": 10, "attachment_id": null, "creator": "avik@apache.org", "is_private": false, "id": 60076, "time": "2004-07-01T07:42:31Z", "bug_id": 19053, "creation_time": "2004-07-01T07:42:31Z", "tags": [], "text": "For the record, the files attached by Perry Tew fail to open since they are\nsaved by Pocket Excel on an iPAQ. Apparently, Pocket Excel saves in Excel95\nformat, while POI of course handles Excel97+. Workaround is to re-save the file\nin desktop excel. \n\nHavent looked at the attachement filed by Julio Madrid, so dunno if it is the\nsame problem. Will find out.."}, {"count": 11, "attachment_id": null, "creator": "avik@apache.org", "is_private": false, "id": 60077, "time": "2004-07-01T07:44:47Z", "bug_id": 19053, "creation_time": "2004-07-01T07:44:47Z", "tags": [], "text": "Sorry.. even Julio's file is, of course, created on an handheld. see duplicate\nbug 28126 for details. "}, {"count": 12, "tags": [], "creator": "avik@apache.org", "attachment_id": 12043, "text": "Created attachment 12043\nPatch by  John Thorhauer (jthorhauer at phoenixcolor.com)", "id": 60205, "time": "2004-07-06T18:37:42Z", "bug_id": 19053, "creation_time": "2004-07-06T18:37:42Z", "is_private": false}, {"count": 13, "tags": [], "bug_id": 19053, "is_private": false, "text": "Err should this patch be applied or not?\n\nJason", "id": 65162, "time": "2004-10-14T22:17:11Z", "creator": "jheight@apache.org", "creation_time": "2004-10-14T22:17:11Z", "attachment_id": null}, {"count": 14, "attachment_id": null, "bug_id": 19053, "is_private": false, "id": 65210, "time": "2004-10-15T22:21:56Z", "creator": "dmui@apache.org", "creation_time": "2004-10-15T22:21:56Z", "tags": [], "text": "does your recent SST fix address this (very cool btw)?  saw that mentioned\nsomewhere :)"}, {"count": 15, "tags": [], "bug_id": 19053, "is_private": false, "text": "Nope. Had a look at the patch and the idea seems reasonable, although i will\nprobably change how it works slightly.\n\nDoes anyone recall why this patch, which basically takes a LabelRecord and\nconverts it to a LabelSSTRecord, was no applied??? Otherwise i think that i will\napply it.", "id": 65257, "time": "2004-10-17T22:23:19Z", "creator": "jheight@apache.org", "creation_time": "2004-10-17T22:23:19Z", "attachment_id": null}, {"count": 16, "tags": [], "bug_id": 19053, "is_private": false, "text": "Ok had a bit more of a look and the patch was applied. Its just that it doesnt\nnow work.\n\nWill work on it.", "id": 65271, "time": "2004-10-18T04:19:22Z", "creator": "jheight@apache.org", "creation_time": "2004-10-18T04:19:22Z", "attachment_id": null}, {"count": 17, "tags": [], "bug_id": 19053, "is_private": false, "text": "Created attachment 14475\nA fix based on John Thorhauer's patch.\n\nI've tested it on the 2 spreadsheets previously attached and have been using a\nversion that includes this patch for several months now, so (at least for my\nuses), it seems to be correct. Still, someone with *real* knowledge of HSSF\nshould probably look at it before comitting ...", "id": 72296, "time": "2005-03-13T08:55:43Z", "creator": "youval_b@yahoo.com", "creation_time": "2005-03-13T08:55:43Z", "attachment_id": 14475}, {"count": 18, "attachment_id": null, "bug_id": 19053, "is_private": false, "id": 79035, "time": "2005-08-26T05:41:01Z", "creator": "jheight@apache.org", "creation_time": "2005-08-26T05:41:01Z", "tags": [], "text": "Patch applied to CVS."}, {"count": 19, "tags": [], "bug_id": 19053, "text": "*** Bug 40460 has been marked as a duplicate of this bug. ***", "id": 116283, "time": "2008-05-05T20:18:32Z", "creator": "josh@apache.org", "creation_time": "2008-05-05T20:18:32Z", "is_private": false, "attachment_id": null}]