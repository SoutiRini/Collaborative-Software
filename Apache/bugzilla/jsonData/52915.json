[{"count": 0, "text": "I am trying to read and excel file which consist of 600 plus records it is working fine on a 1 mbps line but when i switch the same application to 56 kpbs line i am getting the following message \n\n\nMar 15, 2012 12:12:32 PM org.apache.catalina.core.AprLifecycleListener init\nINFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: C:\\Program Files\\Java\\jdk1.7.0_03\\bin;C:\\Windows\\Sun\\Java\\bin;C:\\Windows\\system32;C:\\Windows; C:\\Program Files\\Java\\jdk1.7.0_03/bin;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;.\nMar 15, 2012 12:12:32 PM org.apache.tomcat.util.digester.SetPropertiesRule begin\nWARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'source' to 'org.eclipse.jst.jee.server:TestWebProjects' did not find a matching property.\nMar 15, 2012 12:12:32 PM org.apache.tomcat.util.digester.SetPropertiesRule begin\nWARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'source' to 'org.eclipse.jst.jee.server:ePariksha' did not find a matching property.\nMar 15, 2012 12:12:33 PM org.apache.coyote.AbstractProtocol init\nINFO: Initializing ProtocolHandler [\"http-bio-8080\"]\nMar 15, 2012 12:12:33 PM org.apache.coyote.AbstractProtocol init\nINFO: Initializing ProtocolHandler [\"ajp-bio-8009\"]\nMar 15, 2012 12:12:33 PM org.apache.catalina.startup.Catalina load\nINFO: Initialization processed in 461 ms\nMar 15, 2012 12:12:33 PM org.apache.catalina.core.StandardService startInternal\nINFO: Starting service Catalina\nMar 15, 2012 12:12:33 PM org.apache.catalina.core.StandardEngine startInternal\nINFO: Starting Servlet Engine: Apache Tomcat/7.0.26\nMar 15, 2012 12:12:33 PM org.apache.catalina.loader.WebappClassLoader validateJarFile\nINFO: validateJarFile(F:\\Sherin_Projects\\.metadata\\.plugins\\org.eclipse.wst.server.core\\tmp0\\wtpwebapps\\TestWebProjects\\WEB-INF\\lib\\servlet-api.jar) - jar not loaded. See Servlet Spec 2.3, section 9.7.2. Offending class: javax/servlet/Servlet.class\nMar 15, 2012 12:12:33 PM org.apache.coyote.AbstractProtocol start\nINFO: Starting ProtocolHandler [\"http-bio-8080\"]\nMar 15, 2012 12:12:33 PM org.apache.coyote.AbstractProtocol start\nINFO: Starting ProtocolHandler [\"ajp-bio-8009\"]\nMar 15, 2012 12:12:33 PM org.apache.catalina.startup.Catalina start\nINFO: Server startup in 577 ms\ntest\nMar 15, 2012 1:46:40 PM org.apache.catalina.core.ApplicationContext log\nSEVERE: FileUploadServlet: Error encountered while parsing the request\norg.apache.commons.fileupload.FileUploadBase$IOFileUploadException: Processing of multipart/form-data request failed. Stream ended unexpectedly\n\tat org.apache.commons.fileupload.FileUploadBase.parseRequest(FileUploadBase.java:367)\n\tat org.apache.commons.fileupload.servlet.ServletFileUpload.parseRequest(ServletFileUpload.java:126)\n\tat com.acts.sherin.FileUploadServlet.doPost(FileUploadServlet.java:93)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:641)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:224)\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)\n\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)\n\tat org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\n\tat org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:987)\n\tat org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579)\n\tat org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n\tat java.lang.Thread.run(Thread.java:722)\nCaused by: org.apache.commons.fileupload.MultipartStream$MalformedStreamException: Stream ended unexpectedly\n\tat org.apache.commons.fileupload.MultipartStream$ItemInputStream.makeAvailable(MultipartStream.java:983)\n\tat org.apache.commons.fileupload.MultipartStream$ItemInputStream.read(MultipartStream.java:887)\n\tat java.io.InputStream.read(InputStream.java:101)\n\tat org.apache.commons.fileupload.util.Streams.copy(Streams.java:94)\n\tat org.apache.commons.fileupload.util.Streams.copy(Streams.java:64)\n\tat org.apache.commons.fileupload.FileUploadBase.parseRequest(FileUploadBase.java:362)\n\t... 20 more\n\njava.io.IOException: block[ 319 ] already removed - does your POIFS have circular or duplicate block references?\n\tat org.apache.poi.poifs.storage.BlockListImpl.remove(BlockListImpl.java:89)\n\tat org.apache.poi.poifs.storage.RawDataBlockList.remove(RawDataBlockList.java:32)\n\tat org.apache.poi.poifs.storage.BlockAllocationTableReader.fetchBlocks(BlockAllocationTableReader.java:191)\n\tat org.apache.poi.poifs.storage.BlockListImpl.fetchBlocks(BlockListImpl.java:123)\n\tat org.apache.poi.poifs.storage.RawDataBlockList.fetchBlocks(RawDataBlockList.java:32)\n\tat org.apache.poi.poifs.storage.SmallBlockTableReader.getSmallDocumentBlocks(SmallBlockTableReader.java:50)\n\tat org.apache.poi.poifs.filesystem.POIFSFileSystem.<init>(POIFSFileSystem.java:176)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:317)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:298)\n\tat com.acts.sherin.FileValidation.validate(FileValidation.java:34)\n\tat com.acts.sherin.FileUploadServlet.doPost(FileUploadServlet.java:136)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:641)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:224)\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)\n\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)\n\tat org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\n\tat org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:987)\n\tat org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579)\n\tat org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n\tat java.lang.Thread.run(Thread.java:722)\nMar 15, 2012 1:49:16 PM org.apache.catalina.core.ApplicationDispatcher invoke\nSEVERE: Servlet.service() for servlet ReadExcelFile threw exception\njava.io.IOException: block[ 319 ] already removed - does your POIFS have circular or duplicate block references?\n\tat org.apache.poi.poifs.storage.BlockListImpl.remove(BlockListImpl.java:89)\n\tat org.apache.poi.poifs.storage.RawDataBlockList.remove(RawDataBlockList.java:32)\n\tat org.apache.poi.poifs.storage.BlockAllocationTableReader.fetchBlocks(BlockAllocationTableReader.java:191)\n\tat org.apache.poi.poifs.storage.BlockListImpl.fetchBlocks(BlockListImpl.java:123)\n\tat org.apache.poi.poifs.storage.RawDataBlockList.fetchBlocks(RawDataBlockList.java:32)\n\tat org.apache.poi.poifs.storage.SmallBlockTableReader.getSmallDocumentBlocks(SmallBlockTableReader.java:50)\n\tat org.apache.poi.poifs.filesystem.POIFSFileSystem.<init>(POIFSFileSystem.java:176)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:317)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:298)\n\tat com.acts.sherin.ReadExcelFile.doPost(ReadExcelFile.java:79)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:641)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n\tat org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)\n\tat org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:471)\n\tat org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:402)\n\tat org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:329)\n\tat com.acts.sherin.FileUploadServlet.doPost(FileUploadServlet.java:150)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:641)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:224)\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)\n\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)\n\tat org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\n\tat org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:987)\n\tat org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579)\n\tat org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n\tat java.lang.Thread.run(Thread.java:722)\n\ntest\nMar 15, 2012 1:49:16 PM org.apache.catalina.core.ApplicationContext log\nSEVERE: FileUploadServlet: Error encountered while uploading file\njava.io.IOException: block[ 319 ] already removed - does your POIFS have circular or duplicate block references?\n\tat org.apache.poi.poifs.storage.BlockListImpl.remove(BlockListImpl.java:89)\n\tat org.apache.poi.poifs.storage.RawDataBlockList.remove(RawDataBlockList.java:32)\n\tat org.apache.poi.poifs.storage.BlockAllocationTableReader.fetchBlocks(BlockAllocationTableReader.java:191)\n\tat org.apache.poi.poifs.storage.BlockListImpl.fetchBlocks(BlockListImpl.java:123)\n\tat org.apache.poi.poifs.storage.RawDataBlockList.fetchBlocks(RawDataBlockList.java:32)\n\tat org.apache.poi.poifs.storage.SmallBlockTableReader.getSmallDocumentBlocks(SmallBlockTableReader.java:50)\n\tat org.apache.poi.poifs.filesystem.POIFSFileSystem.<init>(POIFSFileSystem.java:176)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:317)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:298)\n\tat com.acts.sherin.ReadExcelFile.doPost(ReadExcelFile.java:79)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:641)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n\tat org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)\n\tat org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:471)\n\tat org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:402)\n\tat org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:329)\n\tat com.acts.sherin.FileUploadServlet.doPost(FileUploadServlet.java:150)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:641)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:224)\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)\n\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)\n\tat org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\n\tat org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:987)\n\tat org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579)\n\tat org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n\tat java.lang.Thread.run(Thread.java:722)", "bug_id": 52915, "is_private": false, "id": 154926, "time": "2012-03-15T08:55:37Z", "creator": "sherin.matheew@gmail.com", "creation_time": "2012-03-15T08:55:37Z", "tags": [], "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 52915, "attachment_id": null, "id": 154931, "time": "2012-03-15T09:24:03Z", "creator": "yegor@dinom.ru", "creation_time": "2012-03-15T09:24:03Z", "is_private": false, "text": "Which version of POI? Please try the latest POI-3.8-beta5, there have been many updates in POIFS in recent months.\n\nIf the bug is still there, please upload then file that causes the exception.\n\nYegor"}, {"count": 2, "attachment_id": null, "creator": "apache@gagravarr.org", "is_private": false, "id": 154943, "time": "2012-03-15T16:50:43Z", "bug_id": 52915, "creation_time": "2012-03-15T16:50:43Z", "tags": [], "text": "I'd suggest you try switching to NPOIFS and a recent release (eg 3.8 beta 5). NPOIFS copes with problematic files a bit better than the old POIFS does."}, {"count": 3, "tags": [], "bug_id": 52915, "attachment_id": null, "is_private": false, "id": 155255, "time": "2012-03-23T07:03:07Z", "creator": "sherin.matheew@gmail.com", "creation_time": "2012-03-23T07:03:07Z", "text": "Yegor and Nick Thank you for your quick response i will check with the version you have specified and let you know the output soon"}, {"count": 4, "tags": [], "creator": "kiwiwings@apache.org", "is_private": false, "text": "I'm closing this now, as there was no response in the last two years.\nIt seems this problem was somehow releated to connection abortion on the webserver.\nIf you face that error again, please add an attachment for us to reproduce the problem", "id": 174744, "time": "2014-04-21T14:04:20Z", "bug_id": 52915, "creation_time": "2014-04-21T14:04:20Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 52915, "attachment_id": null, "id": 184383, "time": "2015-08-06T13:59:40Z", "creator": "gmoirod@gmail.com", "creation_time": "2015-08-06T13:59:40Z", "is_private": false, "text": "Just in case somebody searches for the same error :\nI suddenly had this error whereas everything was fine during a period. The problem was the Maven filtering : Maven filtered my Excel file and corrupted it.\nExcluding Excel files from Maven filtering did the job !"}]