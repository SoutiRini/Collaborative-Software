[{"count": 0, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "id": 189926, "time": "2016-04-04T07:27:30Z", "bug_id": 59268, "creation_time": "2016-04-04T07:27:30Z", "is_private": false, "text": "We have a number of issues with the current version of xmlbeans, but unfortunately the project is not maintained any more. We should try to do a non-maintainer fix-upload from the attic. Let's start discussing this.\n\nInformation about attic non-maintainer uploads:\n* Discussion should be started on the general-mailing list: general@attic.apache.org, http://mail-archives.apache.org/mod_mbox/attic-general/\n* Page for XMLBeans: http://attic.apache.org/projects/xmlbeans.html\n* JIRA: https://issues.apache.org/jira/browse/ATTIC/?selectedTab=com.atlassian.jira.jira-projects-plugin:summary-panel\n\nCurrent issues with the XMLBeans jar:\n\n* It contains duplicate classes which causes issues on Android, see e.g. https://github.com/andruhon/android5xlsx\n* It includes classes from package javax which causes issues in Application servers, see e.g. http://stackoverflow.com/questions/18507605/caused-by-java-lang-linkageerror-loader-constraint-violation-when-resolving-m/36396611#36396611"}, {"count": 1, "tags": [], "bug_id": 59268, "is_private": false, "text": "Comment from Nick in bug #59195: \"Maybe we could get together with Tika and Lucene, and ask the Attic PMC to let us put together a 2.6.1 release with the packaging fix and some others, if someone fancies spending a little bit of time to lead that?\"", "id": 189927, "time": "2016-04-04T07:29:17Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-04-04T07:29:17Z", "attachment_id": null}, {"count": 2, "tags": [], "text": "Bonus points for looking at the following locking issue as well: http://apache-poi.1045710.n5.nabble.com/Alternative-Replacement-for-xmlbeans-tt5722053.html", "is_private": false, "bug_id": 59268, "id": 189929, "time": "2016-04-04T08:00:51Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-04-04T08:00:51Z", "attachment_id": null}, {"count": 3, "tags": [], "text": "Another thing that we can look at: bug 55149 - \"Usage of XmlBeans triggers \"clearThreadLocalMap\" warnings\"", "is_private": false, "bug_id": 59268, "id": 189930, "time": "2016-04-04T08:02:32Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-04-04T08:02:32Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 59268, "is_private": false, "text": "there are a few commits on trunk after 2.6.0 that might be interesting here:\n\n* https://github.com/apache/xmlbeans/commit/4e918d97a03f6aa4355a4580933dca9bf23e80a0\n* https://github.com/apache/xmlbeans/commit/0d66e61968149809030bce123ea7a0ef58bccb83\n* https://github.com/apache/xmlbeans/commit/511d8ae119a7a0cc0d822e5997df1ffad3fe7677\n* https://github.com/apache/xmlbeans/commit/6cd06c9c9e0174190b593de7dec372d5cc123305", "id": 190197, "time": "2016-04-12T19:26:43Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-04-12T19:26:43Z", "attachment_id": null}, {"count": 5, "tags": [], "text": "The javax... classes are actually included via the stax-api dependency of XMLBeans. This one should probably simply be removed together with depending on Java 6 or higher.", "attachment_id": null, "bug_id": 59268, "id": 190296, "time": "2016-04-15T16:14:13Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-04-15T16:14:13Z", "is_private": false}, {"count": 6, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "is_private": false, "id": 190724, "time": "2016-05-04T14:54:55Z", "bug_id": 59268, "creation_time": "2016-05-04T14:54:55Z", "text": "*** Bug 59428 has been marked as a duplicate of this bug. ***"}, {"attachment_id": null, "tags": [], "creator": "dominik.stadler@gmx.at", "text": "*** Bug 59195 has been marked as a duplicate of this bug. ***", "count": 7, "id": 193084, "time": "2016-08-13T20:45:42Z", "bug_id": 59268, "creation_time": "2016-08-13T20:45:42Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "dominik.stadler@gmx.at", "text": "We also see some bugs related to Unicode handling inside XmlBeans, these are also candidates for this effort, see e.g. bug 54084.", "count": 8, "id": 198919, "time": "2017-05-27T21:01:40Z", "bug_id": 59268, "creation_time": "2017-05-27T21:01:40Z", "is_private": false}, {"count": 9, "tags": [], "text": "I had a little trouble building xmlbeans so I made some small changes and committed them to https://github.com/pjfanning/xmlbeans.", "is_private": false, "bug_id": 59268, "id": 199048, "time": "2017-06-04T12:24:28Z", "creator": "fanningpj@yahoo.com", "creation_time": "2017-06-04T12:24:28Z", "attachment_id": null}, {"count": 10, "tags": [], "text": "I made a change on a fork that I have of xmlbeans and it allows the testBug54084Unicode to pass (https://github.com/pjfanning/xmlbeans/commit/b4dda3837421835b7a378c4ab83ce48a4c49fe59).\n\nI have other branches on the xmlbeans fork where I go further and start removing Piccolo parser, the JSR173 classes and the deprecated code supporting XMLInputStream). These changes break 2 CDATA xmlbeans unit tests but this doesn't seem to adversely affect the poi usage. They can probably be fixed without too much effort.\nThe removal of the Piccolo parser would allow some tidy up in POI code (as it has some workarounds to avoid using Piccolo).", "is_private": false, "bug_id": 59268, "id": 199058, "time": "2017-06-04T23:45:26Z", "creator": "fanningpj@yahoo.com", "creation_time": "2017-06-04T23:45:26Z", "attachment_id": null}, {"count": 11, "tags": [], "text": "Do we think it would be possible to issue an xmlbeans patch based on the changes I've made in github?\nThe longer term solution is probably to replace xmlbeans.", "is_private": false, "bug_id": 59268, "id": 199375, "time": "2017-06-24T09:25:45Z", "creator": "fanningpj@yahoo.com", "creation_time": "2017-06-24T09:25:45Z", "attachment_id": null}, {"count": 12, "tags": [], "creator": "fanningpj@yahoo.com", "attachment_id": null, "id": 199493, "time": "2017-06-29T18:22:42Z", "bug_id": 59268, "creation_time": "2017-06-29T18:22:42Z", "is_private": false, "text": "I have published a patched version of xmlbeans to Maven Central.\ncom.github.pjfanning:xmlbeans:2.6.1\n\nI have a sample that shows the patched jar in action at https://github.com/pjfanning/poi-xmlbeans-patch-test"}, {"count": 13, "tags": [], "text": "It'd be good to go through the xmlbeans bugzilla, and see if there are any other bug fix patches there that'd be worth including in a fix release.\n\n(Not to mention the duplicated classes in the 2.6.0 binary jar that ought to be solved by a fresh build!)", "is_private": false, "bug_id": 59268, "id": 199499, "time": "2017-06-29T21:53:30Z", "creator": "apache@gagravarr.org", "creation_time": "2017-06-29T21:53:30Z", "attachment_id": null}, {"count": 14, "tags": [], "creator": "fanningpj@yahoo.com", "attachment_id": null, "is_private": false, "id": 199500, "time": "2017-06-29T22:44:51Z", "bug_id": 59268, "creation_time": "2017-06-29T22:44:51Z", "text": "My jar has the https://issues.apache.org/jira/browse/XMLBEANS-499 issue with duplicate ReferenceResolver classes. I'll see if I can work out what in the xmlbeans build is causing this."}, {"count": 15, "tags": [], "bug_id": 59268, "attachment_id": null, "text": "I added a fix for the duplicate classes in https://github.com/pjfanning/xmlbeans - I will publish a 2.6.2 jar in the coming days if there are no other xmlbeans issues to fix.\n\nFeel free to highlight any issues from XMLBeans in the issue tracker for the github fork.\nhttps://issues.apache.org/jira/browse/XMLBEANS-513?jql=project%20%3D%20XMLBEANS%20AND%20status%20in%20(Open%2C%20%22In%20Progress%22)", "id": 199502, "time": "2017-06-29T23:32:24Z", "creator": "fanningpj@yahoo.com", "creation_time": "2017-06-29T23:32:24Z", "is_private": false}, {"count": 16, "tags": [], "text": "Thanks for the work, I have tested it a bit and so far it looks quite good. \n\nOne thing we could try is to remove the stax-api dependency from the Maven deployment, I don't think this is still necessary with Java 6 or newer.\n\nAs far as I see the other most pressing items are in place now and I would rather release a first piece instead of adding more aggressive stuff, we can always do this later in a second release. \n\nShould we start discussion on general@attic.apache.org on required next steps for publishing an official bugfix-release of xmlbeans?\n\nIn fact with your release on Maven Central we could even technically switch to this without a release from the attic, but it would probably require some due diligence on licensing of the additional patches, ...", "is_private": false, "bug_id": 59268, "id": 199515, "time": "2017-06-30T21:06:49Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2017-06-30T21:06:49Z", "attachment_id": null}, {"count": 17, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "is_private": false, "id": 199517, "time": "2017-06-30T21:17:21Z", "bug_id": 59268, "creation_time": "2017-06-30T21:17:21Z", "text": "I think best practice would be to speak with the Attic PMC about this"}, {"count": 18, "tags": [], "text": "I agree that getting an official apache xmlbeans patch done is preferable to having people use my forked jar. This jar solves some issues with writing XSSF workbooks that have unicode surrogate chars.\n\nI have found a related issue in the SXSSF code base. https://bz.apache.org/bugzilla/show_bug.cgi?id=61246 This means that for writing SXSSF workbooks, users affected by the unicode surrogate chars issues will need the fork xmlbeans jar and the latest POI code (or 3.17 beta2 when it is released).", "is_private": false, "bug_id": 59268, "id": 199536, "time": "2017-07-03T19:34:36Z", "creator": "fanningpj@yahoo.com", "creation_time": "2017-07-03T19:34:36Z", "attachment_id": null}, {"count": 19, "tags": [], "text": "*** Bug 61494 has been marked as a duplicate of this bug. ***", "is_private": false, "bug_id": 59268, "id": 201048, "time": "2017-09-21T16:10:10Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2017-09-21T16:10:10Z", "attachment_id": null}, {"count": 20, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "id": 201050, "time": "2017-09-21T16:11:47Z", "bug_id": 59268, "creation_time": "2017-09-21T16:11:47Z", "is_private": false, "text": "*** Bug 58247 has been marked as a duplicate of this bug. ***"}, {"count": 21, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "is_private": false, "id": 201052, "time": "2017-09-21T16:13:25Z", "bug_id": 59268, "creation_time": "2017-09-21T16:13:25Z", "text": "*** Bug 54084 has been marked as a duplicate of this bug. ***"}, {"count": 22, "tags": [], "text": "I think the more appropriate course of action would be to remove xmlbeans as a dependency.  The project was terminated over 4 years ago.", "is_private": false, "bug_id": 59268, "id": 202722, "time": "2017-12-11T18:37:10Z", "creator": "scott.coldwell@hrworx.com", "creation_time": "2017-12-11T18:37:10Z", "attachment_id": null}, {"count": 23, "tags": [], "bug_id": 59268, "attachment_id": null, "text": "(In reply to Scott Coldwell from comment #22)\n> I think the more appropriate course of action would be to remove xmlbeans as\n> a dependency.  The project was terminated over 4 years ago.\n\nRemoving XMLBeans is probably something like 3-6 months of work, and would have the added disadvantage of probably breaking something like half of all the POI examples for XLSX / PPTX / DOCX on the internet, and probably most of the big projects which make deep/custom use of POI for XLSX/PPTX/DOCX processing....\n\nThe first step, for which volunteers are very very much welcome(!) is to locate all the places in your favourite bit of POI (eg XSSF) that leak the CT* xmlbeans objects, search public examples / github projects / mailing lists etc to see how those beans are used, ensure we have a proper Usermodel wrapper for doing the same thing \"properly\", then deprecate that CT accessor. Once everything that's commonly done via the low-level xmlbeans classes in other people's code can be done cleanly with proper POI classes, we can get people to migrate, then we're in a position to swap out the POI innards to use something else. \n\nIt's quite a lot of work though, which is why more volunteers are needed to help drive it! :)", "id": 202723, "time": "2017-12-11T19:07:28Z", "creator": "apache@gagravarr.org", "creation_time": "2017-12-11T19:07:28Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "gwoolsey@apache.org", "text": "Another complication is that none of the replacement technologies that have been discussed so far can handle the arbitrary XML allowed as \"extensions\" in the OOXML spec. One benefit of XMLBeans is that it keeps the raw XML around and returns any properties/attributes present when asked.  That way POI can \"pass through\" unknown content while allowing access to all known content in a file.  This is used quite often by downstream projects, especially ones that start with custom \"template\" files containing bits like OLE components, custom Office extensions, VBA macros, complex pivot tables, etc. and fill in live data on the fly.  \n\nIn the spec this is handled by referencing additional namespaces on the fly by URL. Any replacement in POI would need to allow similar retention of unknown XML elements and content.  This completely breaks systems like JAXB, which needs all possible namespaces and how they fit together to be defined up front.  There is no dynamic model building or class loading.", "count": 24, "id": 202743, "time": "2017-12-12T17:07:55Z", "bug_id": 59268, "creation_time": "2017-12-12T17:07:55Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "fanningpj@yahoo.com", "text": "I found some other projects based on POI, that have some usage of spreadsheetml classes. I raised issues in these projects.\nhttps://github.com/norbert-radyk/spoiwo/issues/28\nhttps://github.com/monitorjbl/excel-streaming-reader/issues/125", "count": 25, "id": 202791, "time": "2017-12-15T09:24:38Z", "bug_id": 59268, "creation_time": "2017-12-15T09:24:38Z", "is_private": false}, {"count": 26, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "id": 202906, "time": "2017-12-24T11:41:29Z", "bug_id": 59268, "creation_time": "2017-12-24T11:41:29Z", "is_private": false, "text": "*** Bug 61921 has been marked as a duplicate of this bug. ***"}, {"count": 27, "tags": [], "text": "*** Bug 61988 has been marked as a duplicate of this bug. ***", "is_private": false, "bug_id": 59268, "id": 203211, "time": "2018-01-10T18:13:50Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2018-01-10T18:13:50Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "fanningpj@yahoo.com", "text": "*** Bug 62004 has been marked as a duplicate of this bug. ***", "count": 28, "id": 203296, "time": "2018-01-16T10:19:27Z", "bug_id": 59268, "creation_time": "2018-01-16T10:19:27Z", "is_private": false}]