[{"count": 0, "tags": [], "bug_id": 51703, "text": "I have seen POI failing to read several spreadsheets, with the following stack trace:\n\nCaused by: java.lang.IllegalArgumentException: Start index must be less than end index.\nat org.apache.poi.hssf.usermodel.HSSFRichTextString.applyFont(HSSFRichTextString.java:139)\nat org.apache.poi.hssf.record.TextObjectRecord.processFontRuns(TextObjectRecord.java:157)\nat org.apache.poi.hssf.record.TextObjectRecord.<init>(TextObjectRecord.java:133)\nat sun.reflect.GeneratedConstructorAccessor45.newInstance(Unknown Source)\nat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)\nat java.lang.reflect.Constructor.newInstance(Unknown Source)\nat org.apache.poi.hssf.record.RecordFactory$ReflectionConstructorRecordCreator.create(RecordFactory.java:57)\n... 20 more \n\nDebugging it, it looks like there's a text record which has a font applied, where the length of the text string is 42 characters (in one of the examples), but the index for where to apply the font is 60.  The cases I've seen this being a problem all seem related to a floating graphic containing a formatted string only, but I don't know if that's definitely the cause of it as I haven't been able to reproduce this in a simple spreadsheet that I've created myself.\n\nI'm afraid the spreadsheets I have that produce this problem can't be provided as they contain confidential data.", "id": 148749, "time": "2011-08-22T13:02:08Z", "creator": "jan.stette@gmail.com", "creation_time": "2011-08-22T13:02:08Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 148766, "time": "2011-08-22T16:41:35Z", "bug_id": 51703, "creation_time": "2011-08-22T16:41:35Z", "is_private": false, "text": "Can you try running the Microsoft Binary File Format validator tool against one of your problematic files, and see if that declares them to be spec-valid or not?"}, {"count": 2, "tags": [], "text": "I tried the Microsoft validator program as suggested, and these spreadsheets all fail with a message referring to the \"DSF\" record (http://msdn.microsoft.com/en-us/library/638F5C45-2742-4681-9304-C9E2E46A52A9).  So I guess that POI is not to blame?", "attachment_id": null, "id": 148837, "creator": "jan.stette@gmail.com", "time": "2011-08-26T08:43:43Z", "bug_id": 51703, "creation_time": "2011-08-26T08:43:43Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 51703, "text": "(In reply to comment #2)\n> I tried the Microsoft validator program as suggested, and these spreadsheets\n> all fail with a message referring to the \"DSF\" record\n\nWithout the files we can't say for certain, but hat would certainly seem to indicate that the file wasn't produced by office, and instead by a third party program which doesn't follow the spec.", "id": 148838, "time": "2011-08-26T09:26:33Z", "creator": "apache@gagravarr.org", "creation_time": "2011-08-26T09:26:33Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 51703, "attachment_id": null, "id": 183220, "time": "2015-05-31T21:55:41Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-05-31T21:55:41Z", "is_private": false, "text": "Discussion indicates that the problem is outside of POI here, therefore I am closing this as WORKSFORME for now."}]