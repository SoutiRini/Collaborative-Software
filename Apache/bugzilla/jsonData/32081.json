[{"attachment_id": null, "tags": [], "creator": "alexis.oconnor@oucs.ox.ac.uk", "is_private": false, "count": 0, "id": 66520, "time": "2004-11-05T13:02:43Z", "bug_id": 32081, "creation_time": "2004-11-05T13:02:43Z", "text": "A distribution as-is will not run with a JRE. This is because wrapper scripts\nlook  for executables associated with a JDK such as jdb etc, as well as java.\nThese occur in the files $CATALINA_HOME/bin/setclasspath.bat and\n$CATALINA_HOME/bin/setclasspath.sh. The following patches alter these scripts in\nthe following way:\n\n1) they only look for the required files associated with a JRE, e.g. java.\n2) if not found, the message has been changed to say that JAVA_HOME should point\nto a JDK or a JRE.\n\nHere is a patch for $CATALINA_HOME/bin/setclasspath.bat:\n\n--- setclasspath.bat\tFri Oct 29 20:13:00 2004\n+++ setclasspath2.bat\tFri Nov  5 10:57:56 2004\n@@ -12,13 +12,11 @@\n :gotJavaHome\n if not exist \"%JAVA_HOME%\\bin\\java.exe\" goto noJavaHome\n if not exist \"%JAVA_HOME%\\bin\\javaw.exe\" goto noJavaHome\n-if not exist \"%JAVA_HOME%\\bin\\jdb.exe\" goto noJavaHome\n-if not exist \"%JAVA_HOME%\\bin\\javac.exe\" goto noJavaHome\n goto okJavaHome\n :noJavaHome\n echo The JAVA_HOME environment variable is not defined correctly\n echo This environment variable is needed to run this program\n-echo NB: JAVA_HOME should point to a JDK not a JRE\n+echo NB: JAVA_HOME should point to a JDK or a JRE\n goto exit\n :okJavaHome\n \n@@ -55,3 +53,4 @@\n exit /b 1\n \n :end\n+\n\nHere is a patch for $CATALINA_HOME/bin/setclasspath.sh\n\n--- setclasspath.sh\tFri Oct 29 20:13:00 2004\n+++ setclasspath2.sh\tFri Nov  5 12:22:55 2004\n@@ -18,10 +18,10 @@\n     exit 1\n   fi\n else\n-  if [ ! -x \"$JAVA_HOME\"/bin/java -o ! -x \"$JAVA_HOME\"/bin/jdb -o ! -x\n\"$JAVA_HOME\"/bin/javac ]; then\n+  if [ ! -x \"$JAVA_HOME\"/bin/java ]; then\n     echo \"The JAVA_HOME environment variable is not defined correctly\"\n     echo \"This environment variable is needed to run this program\"\n-    echo \"NB: JAVA_HOME should point to a JDK not a JRE\"\n+    echo \"NB: JAVA_HOME should point to a JDK or a JRE\"\n     exit 1\n   fi\n fi\n@@ -59,3 +59,4 @@\n   _RUNJDB=\"$JAVA_HOME\"/bin/jdb\n fi\n _RUNJAVAC=\"$JAVA_HOME\"/bin/javac\n+"}, {"count": 1, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "id": 66521, "time": "2004-11-05T13:19:56Z", "bug_id": 32081, "creation_time": "2004-11-05T13:19:56Z", "is_private": false, "text": "I sort of agree with the bug report, but not really with the solution.\nAFAIK, most other programs which use JAVA_HOME expect a JDK, and some of the\nfeatures of the scripts also use the JDK (ex: jdb).\nThe fact that Tomcat fully works with the JRE is used for the Windows installer,\nand stuff like that, but in the scripts it is a problem IMO."}, {"count": 2, "tags": [], "bug_id": 32081, "attachment_id": null, "text": "*** Bug 32669 has been marked as a duplicate of this bug. ***", "id": 68384, "time": "2004-12-13T17:36:34Z", "creator": "yoavs@computer.org", "creation_time": "2004-12-13T17:36:34Z", "is_private": false}, {"count": 3, "tags": [], "creator": "bsouther@fwdco.com", "attachment_id": null, "is_private": false, "id": 68597, "time": "2004-12-15T23:29:39Z", "bug_id": 32081, "creation_time": "2004-12-15T23:29:39Z", "text": ">I sort of agree with the bug report, but not really with the solution.\n>AFAIK, most other programs which use JAVA_HOME expect a JDK,\n\nWhat about looking for JRE_HOME if JAVA_HOME is not found?"}, {"count": 4, "tags": [], "bug_id": 32081, "attachment_id": null, "text": "*** Bug 32793 has been marked as a duplicate of this bug. ***", "id": 69027, "time": "2004-12-28T03:32:48Z", "creator": "bsouther@fwdco.com", "creation_time": "2004-12-28T03:32:48Z", "is_private": false}, {"count": 5, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "id": 69168, "time": "2005-01-03T17:51:10Z", "bug_id": 32081, "creation_time": "2005-01-03T17:51:10Z", "is_private": false, "text": "Using a second JRE_HOME (initialized to JAVA_HOME if blank) for the \"base\"\nfeatures of the scripts is indeed a possibility."}, {"count": 6, "tags": [], "creator": "bsouther@fwdco.com", "attachment_id": null, "id": 69222, "time": "2005-01-05T03:38:49Z", "bug_id": 32081, "creation_time": "2005-01-05T03:38:49Z", "is_private": false, "text": "> Using a second JRE_HOME (initialized to JAVA_HOME if blank) for the \n> \"base\" features of the scripts is indeed a possibility.\n\nIn the event that both are set, which should it prefer?\nIf JRE_HOME, should it fail when the 'debug' arg is present, even if JAVA_HOME set?\n\nI've got rough drafts of the bash scripts running with the JRE on FC2 now."}, {"count": 7, "tags": [], "bug_id": 32081, "attachment_id": 13961, "text": "Created attachment 13961\nupdate setclasspath.sh to run with JRE\n\nTested on FC3", "id": 69463, "time": "2005-01-10T02:48:33Z", "creator": "bsouther@fwdco.com", "creation_time": "2005-01-10T02:48:33Z", "is_private": false}, {"attachment_id": 13962, "tags": [], "creator": "bsouther@fwdco.com", "text": "Created attachment 13962\nupdate catalina.sh to run with JRE\n\nTested on FC3", "count": 8, "id": 69464, "time": "2005-01-10T02:49:18Z", "bug_id": 32081, "creation_time": "2005-01-10T02:49:18Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 32081, "attachment_id": null, "id": 69497, "time": "2005-01-10T17:55:10Z", "creator": "remm@apache.org", "creation_time": "2005-01-10T17:55:10Z", "is_private": false, "text": "I would like to resolve this issue in the next build (5.5.7).\n\nI have some questions:\n- [ -n \"$JRE_HOME\" ] && JAVA_HOME=`cygpath --unix \"$JRE_HOME\"` doesn't seem\nright to me; shouldn't it be [ -n \"$JRE_HOME\" ] && JRE_HOME=`cygpath --unix\n\"$JRE_HOME\"` ?\n- you attached the wrong diff for setclasspath.sh, can you fix it ?\n- can you remove the debug stuff from your catalina.sh patch ? ;)"}, {"count": 10, "tags": [], "bug_id": 32081, "attachment_id": 13967, "text": "Created attachment 13967\nPatches for catalina.sh and setclasspath.sh\n\nYes to all questions and sorry about the sloppiness.", "id": 69501, "time": "2005-01-10T18:51:54Z", "creator": "bsouther@fwdco.com", "creation_time": "2005-01-10T18:51:54Z", "is_private": false}, {"count": 11, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "id": 69502, "time": "2005-01-10T19:22:02Z", "bug_id": 32081, "creation_time": "2005-01-10T19:22:02Z", "is_private": false, "text": "That looks good. Thanks.\n\nI'm adding back the #!/bin/sh at the beginning of catalina.sh, though. Any\nreason why it's removed ?\n\nI'm leaving the bug open for Windows, but I really don't care about the problem\n(most users of the batch scripts on Windows will be developers, which means they\nhave the JDK)."}, {"count": 12, "tags": [], "text": "> I'm adding back the #!/bin/sh at the beginning of catalina.sh, though. Any\n> reason why it's removed ?\nNo, it should be there.\n\n> I'm leaving the bug open for Windows, but I really don't care about the problem\n> (most users of the batch scripts on Windows will be developers, which means they\n> have the JDK).\nI'll do the same for the batch scripts to keep them consistent with the shell\nscripts.\n\nThank you\n-Ben", "is_private": false, "bug_id": 32081, "id": 69503, "time": "2005-01-10T19:30:10Z", "creator": "bsouther@fwdco.com", "creation_time": "2005-01-10T19:30:10Z", "attachment_id": null}, {"count": 13, "tags": [], "bug_id": 32081, "attachment_id": null, "id": 81691, "time": "2005-10-25T11:56:58Z", "creator": "lasitha.n@gmail.com", "creation_time": "2005-10-25T11:56:58Z", "is_private": false, "text": "On starting the tomcat server the following error message is displayed\n\"The system cannot find the file \n-Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager.\""}, {"count": 14, "tags": [], "creator": "yoavs@computer.org", "text": "Ben, any luck putting together the same type of patch for the Windows batch\nscripts?  If you have it, I'll gladly look at / apply it.\n\nLas, besides not being able to reproduce what you're claiming, I'm not sure it's\nrelated to this specific Bugzilla issue.  I'd try asking on the\nusers@tomcat.apache.org list if I were you.", "id": 82662, "time": "2005-11-18T16:46:23Z", "bug_id": 32081, "creation_time": "2005-11-18T16:46:23Z", "is_private": false, "attachment_id": null}, {"count": 15, "tags": [], "creator": "Keith@Apache.org", "attachment_id": null, "is_private": false, "id": 83462, "time": "2005-12-08T22:45:06Z", "bug_id": 32081, "creation_time": "2005-12-08T22:45:06Z", "text": "ported the patch to the win32 scripts"}, {"count": 16, "tags": [], "bug_id": 32081, "attachment_id": null, "text": "Just faced this problem today in the 5.5.14 release. When will this patch be added? ", "id": 84239, "time": "2006-01-04T23:57:28Z", "creator": "christian.rueedi@gmail.com", "creation_time": "2006-01-04T23:57:28Z", "is_private": false}, {"count": 17, "tags": [], "creator": "yoavs@computer.org", "attachment_id": null, "id": 84437, "time": "2006-01-10T17:03:41Z", "bug_id": 32081, "creation_time": "2006-01-10T17:03:41Z", "is_private": false, "text": "Look at the very first item on the 5.5.15 (not 5.5.14 ;)) change log."}, {"count": 18, "tags": [], "text": "*** Bug 38967 has been marked as a duplicate of this bug. ***", "attachment_id": null, "bug_id": 32081, "id": 86813, "time": "2006-03-14T21:22:41Z", "creator": "Keith@Apache.org", "creation_time": "2006-03-14T21:22:41Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "markt@apache.org", "text": "*** Bug 36663 has been marked as a duplicate of this bug. ***", "count": 19, "id": 94621, "time": "2006-10-07T14:13:59Z", "bug_id": 32081, "creation_time": "2006-10-07T14:13:59Z", "is_private": false}]