[{"count": 0, "tags": [], "text": "I am using Poi latest final 3.8 version to fix this issue.but still i am getting the fallowing exception.\n\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance \n        at org.apache.poi.hssf.record.RecordFactory$ReflectionRecordCreator.create(RecordFactory.java:64) \n        at org.apache.poi.hssf.record.RecordFactory.createSingleRecord(RecordFactory.java:263) \n        at org.apache.poi.hssf.record.RecordFactoryInputStream.readNextRecord(RecordFactoryInputStream.java:270) \n        at org.apache.poi.hssf.record.RecordFactoryInputStream.nextRecord(RecordFactoryInputStream.java:236) \n        at org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:377) \n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:275) \n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:200) \n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:316) \n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:297) \n        at com.alstom.hpr.manager.excel.impl.type.XlsImport.importFile(XlsImport.java:40) \n        at com.alstom.hpr.manager.excel.impl.BaseExcelManagement.importFile(BaseExcelManagement.java:89) \n        at com.alstom.hpr.struts.imports.ImportFinUnitDataAction.importFile(ImportFinUnitDataAction.java:190) \n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) \n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) \n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) \n        at java.lang.reflect.Method.invoke(Method.java:597) \n        at org.apache.struts.actions.DispatchAction.dispatchMethod(DispatchAction.java:280) \n        at org.apache.struts.actions.DispatchAction.execute(DispatchAction.java:216) \n        at org.apache.struts.action.RequestProcessor.processActionPerform(RequestProcessor.java:484) \n        at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:274) \n        at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1482) \n        at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:525) \n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:637) \n        at com.alstom.fwk.servlet.StrutsServlet.service(StrutsServlet.java:95) \n        at com.alstom.hpr.servlet.HprStrutsServlet.service(HprStrutsServlet.java:98) \n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717) \n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290) \n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) \n        at com.alstom.fwk.servlet.filter.SimConnectionFilter.doFilter(SimConnectionFilter.java:47) \n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235) \n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) \n        at com.alstom.fwk.servlet.filter.LoggerFilter.doFilter(LoggerFilter.java:71) \n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235) \n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) \n        at com.alstom.fwk.servlet.filter.CharacterEncodingFilter.doFilter(CharacterEncodingFilter.java:121) \n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235) \n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) \n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233) \n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191) \n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127) \n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) \n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) \n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298) \n        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:852) \n        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588) \n        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489) \n        at java.lang.Thread.run(Thread.java:662) \nCaused by: org.apache.poi.hssf.record.RecordFormatException: Not enough data (0) to read requested (6) bytes \n        at org.apache.poi.hssf.record.RecordInputStream.checkRecordPosition(RecordInputStream.java:215) \n        at org.apache.poi.hssf.record.RecordInputStream.readFully(RecordInputStream.java:278) \n        at org.apache.poi.hssf.record.RecordInputStream.readFully(RecordInputStream.java:274) \n        at org.apache.poi.hssf.record.chart.ChartEndBlockRecord.<init>(ChartEndBlockRecord.java:44) \n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) \n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39) \n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27) \n        at java.lang.reflect.Constructor.newInstance(Constructor.java:513) \n        at org.apache.poi.hssf.record.RecordFactory$ReflectionRecordCreator.create(RecordFactory.java:56) \n        ... 46 more \n\n\nCode i have written is\ni am getting the inputstream from the FormFile of struts request \nHSSFWorkbook wb = new HSSFWorkbook(is); \n\n\ni'd appreciate developer's comments on whether this is indeed a bug and not some rudeness on the part of my own code,please", "is_private": false, "id": 159172, "creator": "csekhar406@gmail.com", "time": "2012-05-18T19:04:37Z", "bug_id": 53264, "creation_time": "2012-05-18T19:04:37Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "Without either the file or some investigations by yourself, we've not enough to go on...\n\nIf you can't share the file, please identify the offending record and post the raw bytes of it. If possible, please then also compare the POI parsing of it to what the spec details, and try to identify the reason why POI is expecting more data than is present (it might be that a field is actually optional for example)", "attachment_id": null, "bug_id": 53264, "id": 159213, "time": "2012-05-22T11:58:03Z", "creator": "apache@gagravarr.org", "creation_time": "2012-05-22T11:58:03Z", "is_private": false}, {"count": 2, "tags": [], "creator": "csekhar406@gmail.com", "text": "The file you are trying to attach is 4922 kilobytes (KB) in size. Attachments cannot be more than 1000 KB. \nWe recommend that you store your attachment elsewhere and then paste the URL to this file on the attachment creation page in the appropriate text field. \nAlternately, if your attachment is an image, you could convert it to a compressible format like JPG or PNG and try again.\n\n\nI am getting the following when i am trying to add the file to bugzila.Can you provide any mail id so that i can send the attachment to the mail.", "id": 159746, "time": "2012-06-06T07:45:13Z", "bug_id": 53264, "creation_time": "2012-06-06T07:45:13Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 53264, "attachment_id": null, "id": 159747, "time": "2012-06-06T08:06:34Z", "creator": "yegor@dinom.ru", "creation_time": "2012-06-06T08:06:34Z", "is_private": false, "text": "Can you zip the file? \n\n(In reply to comment #2)\n> The file you are trying to attach is 4922 kilobytes (KB) in size.\n> Attachments cannot be more than 1000 KB. \n> We recommend that you store your attachment elsewhere and then paste the URL\n> to this file on the attachment creation page in the appropriate text field. \n> Alternately, if your attachment is an image, you could convert it to a\n> compressible format like JPG or PNG and try again.\n> \n> \n> I am getting the following when i am trying to add the file to bugzila.Can\n> you provide any mail id so that i can send the attachment to the mail."}, {"count": 4, "tags": [], "creator": "csekhar406@gmail.com", "text": "Created attachment 28902\nthe Sample file causing the problem", "id": 159804, "time": "2012-06-07T15:31:47Z", "bug_id": 53264, "creation_time": "2012-06-07T15:31:47Z", "is_private": false, "attachment_id": 28902}, {"count": 5, "tags": [], "bug_id": 53264, "attachment_id": null, "id": 159901, "time": "2012-06-12T04:22:34Z", "creator": "csekhar406@gmail.com", "creation_time": "2012-06-12T04:22:34Z", "is_private": false, "text": "Hi,\n\n\nCould you please let me know if any information needed from my end to fix this issue?\n\nWaiting for your Reply.\n\nThank You,"}, {"count": 6, "tags": [], "bug_id": 53264, "text": "We know from the stacktrace that the problem is probably with the ChartEndBlockRecord, but there's a tiny chance it might be a problem with the record before that\n\nIf you can, please try to (probably using a debugger) work out what the data is that's associated with the problematic record. Then, compare that with the Microsoft provided file format specification. Does the length match what the spec allows? Are there options in the record which cause variable length? If so, does POI handle them?", "id": 159921, "time": "2012-06-12T13:32:32Z", "creator": "apache@gagravarr.org", "creation_time": "2012-06-12T13:32:32Z", "is_private": false, "attachment_id": null}]