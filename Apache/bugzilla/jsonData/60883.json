[{"count": 0, "tags": [], "text": "Add a counterpart for __escapeHtml for XML too: __escapeXml\n\nSimple impl based off __escapeHtml:\n\n> import java.util.Collection;\n> import java.util.LinkedList;\n> import java.util.List;\n> \n> import org.apache.commons.lang3.StringEscapeUtils;\n> import org.apache.jmeter.engine.util.CompoundVariable;\n> import org.apache.jmeter.functions.AbstractFunction;\n> import org.apache.jmeter.functions.InvalidVariableException;\n> import org.apache.jmeter.samplers.SampleResult;\n> import org.apache.jmeter.samplers.Sampler;\n> \n> public class EscapeXml extends AbstractFunction {\n> \n> \tprivate static final List<String> desc = new LinkedList<String>();\n> \n> \tprivate static final String KEY = \"__escapeXml\"; //$NON-NLS-1$\n> \n> \tstatic {\n> \t\tdesc.add(\"Escape XML string\"); //$NON-NLS-1$\n> \t}\n> \n> \tprivate Object[] values;\n> \n> \tpublic EscapeXml() {\n> \t}\n> \n> \t/** {@inheritDoc} */\n> \t@Override\n> \tpublic String execute(SampleResult previousResult, Sampler currentSampler)\n> \t\t\tthrows InvalidVariableException {\n> \n> \t\tString rawString = ((CompoundVariable) values[0]).execute();\n> \t\treturn StringEscapeUtils.escapeXml10(rawString);\n> \n> \t}\n> \n> \t/** {@inheritDoc} */\n> \t@Override\n> \tpublic void setParameters(Collection<CompoundVariable> parameters)\n> \t\t\tthrows InvalidVariableException {\n> \t\tcheckParameterCount(parameters, 1);\n> \t\tvalues = parameters.toArray();\n> \t}\n> \n> \t/** {@inheritDoc} */\n> \t@Override\n> \tpublic String getReferenceKey() {\n> \t\treturn KEY;\n> \t}\n> \n> \t/** {@inheritDoc} */\n> \tpublic List<String> getArgumentDesc() {\n> \t\treturn desc;\n> \t}\n> }", "is_private": false, "id": 197753, "creator": "1983-01-06@gmx.net", "time": "2017-03-17T15:39:30Z", "bug_id": 60883, "creation_time": "2017-03-17T15:39:30Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "Hello Michael,\nThanks for your proposal.\nWould it be possible to provide a patch or a PR on our github :\n- https://github.com/apache/jmeter\n\nSee:\n- http://jmeter.apache.org/building.html\n\nThanks", "attachment_id": null, "id": 197754, "creator": "p.mouawad@ubik-ingenierie.com", "time": "2017-03-17T15:42:19Z", "bug_id": 60883, "creation_time": "2017-03-17T15:42:19Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 60883, "attachment_id": null, "is_private": false, "id": 197756, "time": "2017-03-17T16:52:44Z", "creator": "1983-01-06@gmx.net", "creation_time": "2017-03-17T16:52:44Z", "text": "(In reply to Philippe Mouawad from comment #1)\n> Hello Michael,\n> Thanks for your proposal.\n> Would it be possible to provide a patch or a PR on our github :\n> - https://github.com/apache/jmeter\n> \n> See:\n> - http://jmeter.apache.org/building.html\n\nThe patch is the least problem. The problem is this:\n\nhttps://github.com/apache/jmeter/blob/trunk/build.xml#L3052-L3065\n\nNon-Maven build, it requires direct Internet connection. I have to see how I can change this to use either our HTTP proxy or Nexus instance otherwise I won't be able to build anything at work. \"Setproxy Task\" should do it. You should consider taking this from tomcat https://github.com/apache/tomcat85/blob/trunk/build.xml#L2709-L2713\n\n...repo forked...PR pending..."}, {"count": 3, "tags": [], "text": "(In reply to Michael Osipov from comment #2)\n> (In reply to Philippe Mouawad from comment #1)\n> > Hello Michael,\n> > Thanks for your proposal.\n> > Would it be possible to provide a patch or a PR on our github :\n> > - https://github.com/apache/jmeter\n> > \n> > See:\n> > - http://jmeter.apache.org/building.html\n> \n> The patch is the least problem. The problem is this:\n> \n> https://github.com/apache/jmeter/blob/trunk/build.xml#L3052-L3065\n> \n> Non-Maven build, it requires direct Internet connection. I have to see how I\n> can change this to use either our HTTP proxy or Nexus instance otherwise I\n> won't be able to build anything at work. \"Setproxy Task\" should do it. You\n> should consider taking this from tomcat\n> https://github.com/apache/tomcat85/blob/trunk/build.xml#L2709-L2713\n\nGood idea\nWill you also contribute a patch for this :-) ?\nOr shall I do it ?\n\n> \n> ...repo forked...PR pending...", "attachment_id": null, "bug_id": 60883, "id": 197758, "time": "2017-03-17T17:35:23Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2017-03-17T17:35:23Z", "is_private": false}, {"count": 4, "tags": [], "creator": "1983-01-06@gmx.net", "text": "(In reply to Philippe Mouawad from comment #3)\n> (In reply to Michael Osipov from comment #2)\n> > (In reply to Philippe Mouawad from comment #1)\n> > > Hello Michael,\n> > > Thanks for your proposal.\n> > > Would it be possible to provide a patch or a PR on our github :\n> > > - https://github.com/apache/jmeter\n> > > \n> > > See:\n> > > - http://jmeter.apache.org/building.html\n> > \n> > The patch is the least problem. The problem is this:\n> > \n> > https://github.com/apache/jmeter/blob/trunk/build.xml#L3052-L3065\n> > \n> > Non-Maven build, it requires direct Internet connection. I have to see how I\n> > can change this to use either our HTTP proxy or Nexus instance otherwise I\n> > won't be able to build anything at work. \"Setproxy Task\" should do it. You\n> > should consider taking this from tomcat\n> > https://github.com/apache/tomcat85/blob/trunk/build.xml#L2709-L2713\n> \n> Good idea\n> Will you also contribute a patch for this :-) ?\n> Or shall I do it ?\n\nPlease go ahead and do it. My Ant foo has faded since Maven.\nI will focus on the PR.", "id": 197760, "time": "2017-03-17T18:34:41Z", "bug_id": 60883, "creation_time": "2017-03-17T18:34:41Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "text": "(In reply to Michael Osipov from comment #2)\n> (In reply to Philippe Mouawad from comment #1)\n> > Hello Michael,\n> > Thanks for your proposal.\n> > Would it be possible to provide a patch or a PR on our github :\n> > - https://github.com/apache/jmeter\n> > \n> > See:\n> > - http://jmeter.apache.org/building.html\n> \n> The patch is the least problem. The problem is this:\n> \n> https://github.com/apache/jmeter/blob/trunk/build.xml#L3052-L3065\n> \n> Non-Maven build, it requires direct Internet connection. I have to see how I\n> can change this to use either our HTTP proxy or Nexus instance otherwise I\n> won't be able to build anything at work. \"Setproxy Task\" should do it. You\n> should consider taking this from tomcat\n> https://github.com/apache/tomcat85/blob/trunk/build.xml#L2709-L2713\n> \n> ...repo forked...PR pending...\n\nJust add your nexus repo url as maven2.repo to build-local.properties.\n\nThat should be enough to use nexus as the source for the downloads.", "attachment_id": null, "id": 197761, "creator": "felix.schumacher@internetallee.de", "time": "2017-03-17T18:43:27Z", "bug_id": 60883, "creation_time": "2017-03-17T18:43:27Z", "is_private": false}, {"count": 6, "attachment_id": null, "bug_id": 60883, "is_private": false, "id": 197762, "time": "2017-03-17T19:25:11Z", "creator": "1983-01-06@gmx.net", "creation_time": "2017-03-17T19:25:11Z", "tags": [], "text": "(In reply to Felix Schumacher from comment #5)\n> (In reply to Michael Osipov from comment #2)\n> > (In reply to Philippe Mouawad from comment #1)\n> > > Hello Michael,\n> > > Thanks for your proposal.\n> > > Would it be possible to provide a patch or a PR on our github :\n> > > - https://github.com/apache/jmeter\n> > > \n> > > See:\n> > > - http://jmeter.apache.org/building.html\n> > \n> > The patch is the least problem. The problem is this:\n> > \n> > https://github.com/apache/jmeter/blob/trunk/build.xml#L3052-L3065\n> > \n> > Non-Maven build, it requires direct Internet connection. I have to see how I\n> > can change this to use either our HTTP proxy or Nexus instance otherwise I\n> > won't be able to build anything at work. \"Setproxy Task\" should do it. You\n> > should consider taking this from tomcat\n> > https://github.com/apache/tomcat85/blob/trunk/build.xml#L2709-L2713\n> > \n> > ...repo forked...PR pending...\n> \n> Just add your nexus repo url as maven2.repo to build-local.properties.\n> \n> That should be enough to use nexus as the source for the downloads.\n\nYes, this makes sense, but you still need to pass credentials for the <get> task. Can you add this to the build.xml?"}, {"count": 7, "tags": [], "creator": "felix.schumacher@internetallee.de", "attachment_id": null, "id": 197763, "time": "2017-03-17T19:40:55Z", "bug_id": 60883, "creation_time": "2017-03-17T19:40:55Z", "is_private": false, "text": "(In reply to Michael Osipov from comment #6)\n> (In reply to Felix Schumacher from comment #5)\n> > (In reply to Michael Osipov from comment #2)\n> > > (In reply to Philippe Mouawad from comment #1)\n> > > > Hello Michael,\n> > > > Thanks for your proposal.\n> > > > Would it be possible to provide a patch or a PR on our github :\n> > > > - https://github.com/apache/jmeter\n> > > > \n> > > > See:\n> > > > - http://jmeter.apache.org/building.html\n> > > \n> > > The patch is the least problem. The problem is this:\n> > > \n> > > https://github.com/apache/jmeter/blob/trunk/build.xml#L3052-L3065\n> > > \n> > > Non-Maven build, it requires direct Internet connection. I have to see how I\n> > > can change this to use either our HTTP proxy or Nexus instance otherwise I\n> > > won't be able to build anything at work. \"Setproxy Task\" should do it. You\n> > > should consider taking this from tomcat\n> > > https://github.com/apache/tomcat85/blob/trunk/build.xml#L2709-L2713\n> > > \n> > > ...repo forked...PR pending...\n> > \n> > Just add your nexus repo url as maven2.repo to build-local.properties.\n> > \n> > That should be enough to use nexus as the source for the downloads.\n> \n> Yes, this makes sense, but you still need to pass credentials for the <get>\n> task. Can you add this to the build.xml?\n\nIf your nexus is secured by password, than this will probably not work, but you could have a look at:\n\nhttps://bz.apache.org/bugzilla/show_bug.cgi?id=53709\n\nHope that helps."}, {"count": 8, "tags": [], "bug_id": 60883, "attachment_id": null, "id": 197766, "time": "2017-03-17T19:59:12Z", "creator": "1983-01-06@gmx.net", "creation_time": "2017-03-17T19:59:12Z", "is_private": false, "text": "(In reply to Felix Schumacher from comment #7)\n> (In reply to Michael Osipov from comment #6)\n> > (In reply to Felix Schumacher from comment #5)\n> > > (In reply to Michael Osipov from comment #2)\n> > > > (In reply to Philippe Mouawad from comment #1)\n> > > > > Hello Michael,\n> > > > > Thanks for your proposal.\n> > > > > Would it be possible to provide a patch or a PR on our github :\n> > > > > - https://github.com/apache/jmeter\n> > > > > \n> > > > > See:\n> > > > > - http://jmeter.apache.org/building.html\n> > > > \n> > > > The patch is the least problem. The problem is this:\n> > > > \n> > > > https://github.com/apache/jmeter/blob/trunk/build.xml#L3052-L3065\n> > > > \n> > > > Non-Maven build, it requires direct Internet connection. I have to see how I\n> > > > can change this to use either our HTTP proxy or Nexus instance otherwise I\n> > > > won't be able to build anything at work. \"Setproxy Task\" should do it. You\n> > > > should consider taking this from tomcat\n> > > > https://github.com/apache/tomcat85/blob/trunk/build.xml#L2709-L2713\n> > > > \n> > > > ...repo forked...PR pending...\n> > > \n> > > Just add your nexus repo url as maven2.repo to build-local.properties.\n> > > \n> > > That should be enough to use nexus as the source for the downloads.\n> > \n> > Yes, this makes sense, but you still need to pass credentials for the <get>\n> > task. Can you add this to the build.xml?\n> \n> If your nexus is secured by password, than this will probably not work, but\n> you could have a look at:\n> \n> https://bz.apache.org/bugzilla/show_bug.cgi?id=53709\n\nGiven that Tomcat does the right thing in its build.xml and it works in our corporate environment, I really do not understand why 53709 was closed as invalid. This is truly an important thing for everything trying to contribute.\n\nBTW, this does its job:\n\n> diff --git a/build.xml b/build.xml\n> index 4ddd4513f..d68adb9e6 100644\n> --- a/build.xml\n> +++ b/build.xml\n> @@ -3054,7 +3054,8 @@ run JMeter unless all the JMeter jars are added.\n>      <echo message=\"Fetching: ${path}/${jar}\" level=\"info\"/>\n>      <get src=\"${loc}/${jar}\"\n>           dest=\"${build.dir}/${jar}\"\n> -         usetimestamp=\"false\" ignoreerrors=\"false\"/>\n> +         usetimestamp=\"false\" ignoreerrors=\"false\"\n> +         username=\"${nexus.username}\" password=\"${nexus.password}\"/>\n>      <antcall target=\"_checkMD5\">\n>        <param name=\"file\" value=\"${jar}\"/>\n>        <param name=\"path\" value=\"${build.dir}\"/>\n>"}, {"count": 9, "tags": [], "text": "I must correct myself, it doesn't. Checkstyle is downloaded from SF.net as an \u00dcber JAR.", "attachment_id": null, "id": 197767, "creator": "1983-01-06@gmx.net", "time": "2017-03-17T20:10:33Z", "bug_id": 60883, "creation_time": "2017-03-17T20:10:33Z", "is_private": false}, {"count": 10, "tags": [], "bug_id": 60883, "attachment_id": null, "is_private": false, "id": 197771, "time": "2017-03-17T20:50:18Z", "creator": "1983-01-06@gmx.net", "creation_time": "2017-03-17T20:50:18Z", "text": "OK, I have to take care of the patch at home next week. The tests don't pass at work because some of the require outbound, direct connection to the Internet like to 8.8.8.8 or HTTP Proxy Sampler to jmeter.apache.org."}, {"count": 11, "text": "(In reply to Michael Osipov from comment #9)\n> I must correct myself, it doesn't. Checkstyle is downloaded from SF.net as\n> an \u00dcber JAR.\n\nI think, that the discussion about ant ant proxy gets a bit out of control on this bug entry. So let us take it either to the dev list, or to 53709, where it is probably better suited.", "bug_id": 60883, "attachment_id": null, "id": 197772, "time": "2017-03-17T20:51:16Z", "creator": "felix.schumacher@internetallee.de", "creation_time": "2017-03-17T20:51:16Z", "tags": [], "is_private": false}, {"count": 12, "tags": [], "bug_id": 60883, "is_private": false, "text": "(In reply to Michael Osipov from comment #10)\n> OK, I have to take care of the patch at home next week. The tests don't pass\n> at work because some of the require outbound, direct connection to the\n> Internet like to 8.8.8.8 or HTTP Proxy Sampler to jmeter.apache.org.\n\nI think, those bugs could be reported on \nhttps://bz.apache.org/bugzilla/show_bug.cgi?id=60435\n\n(or discussed on dev mailing list)", "id": 197773, "time": "2017-03-17T20:53:33Z", "creator": "felix.schumacher@internetallee.de", "creation_time": "2017-03-17T20:53:33Z", "attachment_id": null}, {"count": 13, "attachment_id": null, "creator": "1983-01-06@gmx.net", "is_private": false, "id": 197779, "time": "2017-03-17T21:27:00Z", "bug_id": 60883, "creation_time": "2017-03-17T21:27:00Z", "tags": [], "text": "(In reply to Felix Schumacher from comment #12)\n> (In reply to Michael Osipov from comment #10)\n> > OK, I have to take care of the patch at home next week. The tests don't pass\n> > at work because some of the require outbound, direct connection to the\n> > Internet like to 8.8.8.8 or HTTP Proxy Sampler to jmeter.apache.org.\n> \n> I think, those bugs could be reported on \n> https://bz.apache.org/bugzilla/show_bug.cgi?id=60435\n> \n> (or discussed on dev mailing list)\n\nAlready did."}, {"count": 14, "tags": [], "text": "Created PR: https://github.com/apache/jmeter/pull/288", "is_private": false, "bug_id": 60883, "id": 198174, "time": "2017-04-05T13:50:41Z", "creator": "1983-01-06@gmx.net", "creation_time": "2017-04-05T13:50:41Z", "attachment_id": null}, {"count": 15, "tags": [], "bug_id": 60883, "attachment_id": null, "is_private": false, "id": 198199, "time": "2017-04-06T17:12:52Z", "creator": "felix.schumacher@internetallee.de", "creation_time": "2017-04-06T17:12:52Z", "text": "Thanks for your contribution.\n\nDate: Thu Apr  6 17:04:19 2017\nNew Revision: 1790429\n\nURL: http://svn.apache.org/viewvc?rev=1790429&view=rev\nLog:\nAdd ${__escapeXml()} function. Contributed by Michael Osipov (michaelo at apache.org)\n\nThis closes #288 on github.\n\nBugzilla Id: 60883\n\nModified:\n    jmeter/trunk/docs/changes.html\n    jmeter/trunk/docs/usermanual/functions.html\n    jmeter/trunk/src/core/org/apache/jmeter/resources/messages.properties\n    jmeter/trunk/src/core/org/apache/jmeter/resources/messages_fr.properties\n    jmeter/trunk/test/src/org/apache/jmeter/functions/TestSimpleFunctions.java\n    jmeter/trunk/xdocs/changes.xml\n    jmeter/trunk/xdocs/usermanual/functions.xml\n\nDate: Thu Apr  6 17:10:23 2017\nNew Revision: 1790432\n\nURL: http://svn.apache.org/viewvc?rev=1790432&view=rev\nLog:\nAdd the missing part of pr #288, which is the new function itself.\n\nContributed by Michael Osipov.\n\nBugzill Id: 60883\n\nAdded:\n    jmeter/trunk/src/functions/org/apache/jmeter/functions/EscapeXml.java"}]