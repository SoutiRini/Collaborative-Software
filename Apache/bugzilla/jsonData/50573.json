[{"count": 0, "tags": [], "creator": "mslish@arinc.com", "attachment_id": 26479, "is_private": false, "id": 143276, "time": "2011-01-11T16:55:31Z", "bug_id": 50573, "creation_time": "2011-01-11T16:55:31Z", "text": "Created attachment 26479\nAirport Flight Information\n\nI am trying to upload my Excel spreadsheet file that contains cell formatting such as a required date format of YYYY-MM-DD and required 3 character ISO airport code. I am using the CBSA API template for passenger information.\nThe spreadsheet will not open when I attempt the upload with the following error message:\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n        at org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:199)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:117)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:207)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:259)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:240)\n        at egovportalv2.SessionBean1.populateDBFromSpreadSheet(SessionBean1.java:1047)\n        at egovportalv2.upload_flight.button1_action(upload_flight.java:249)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at com.sun.el.parser.AstValue.invoke(AstValue.java:187)\n        at com.sun.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:297)\n        at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:77)\n        at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:91)\n        at com.sun.rave.web.ui.appbase.faces.ActionListenerImpl.processAction(ActionListenerImpl.java:91)\n        at javax.faces.component.UICommand.broadcast(UICommand.java:383)\n        at com.sun.webui.jsf.component.WebuiCommand.broadcast(WebuiCommand.java:160)\n        at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:447)\n        at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:752)\n        at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:97)\n        at com.sun.faces.lifecycle.LifecycleImpl.phase(LifecycleImpl.java:251)\n        at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:117)\n        at com.sun.faces.extensions.avatar.lifecycle.PartialTraversalLifecycle.execute(PartialTraversalLifecycle.java:94)\n        at javax.faces.webapp.FacesServlet.service(FacesServlet.java:244)\n        at org.apache.catalina.core.ApplicationFilterChain.servletService(ApplicationFilterChain.java:411)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:317)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:198)\n        at com.sun.webui.jsf.util.UploadFilter.doFilter(UploadFilter.java:370)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:198)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:288)\n        at org.apache.catalina.core.StandardContextValve.invokeInternal(StandardContextValve.java:271)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:202)\n        at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:632)\n        at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:577)\n        at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:94)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:206)\n        at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:632)\n        at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:577)\n        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:571)\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:1080)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:150)\n        at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:632)\n        at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:577)\n        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:571)\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:1080)\n        at org.apache.coyote.tomcat5.CoyoteAdapter.service(CoyoteAdapter.java:272)\n        at com.sun.enterprise.web.connector.grizzly.DefaultProcessorTask.invokeAdapter(DefaultProcessorTask.java:637)\n        at com.sun.enterprise.web.connector.grizzly.DefaultProcessorTask.doProcess(DefaultProcessorTask.java:568)\n        at com.sun.enterprise.web.connector.grizzly.DefaultProcessorTask.process(DefaultProcessorTask.java:813)\n        at com.sun.enterprise.web.connector.grizzly.DefaultReadTask.executeProcessorTask(DefaultReadTask.java:341)\n        at com.sun.enterprise.web.connector.grizzly.DefaultReadTask.doTask(DefaultReadTask.java:263)\n        at com.sun.enterprise.web.connector.grizzly.DefaultReadTask.doTask(DefaultReadTask.java:214)\n        at com.sun.enterprise.web.connector.grizzly.TaskBase.run(TaskBase.java:265)\n        at com.sun.enterprise.web.connector.grizzly.ssl.SSLWorkerThread.run(SSLWorkerThread.java:106)\nCaused by: java.lang.reflect.InvocationTargetException\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:513)\n        at org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:187)\n        ... 55 more\nCaused by: java.lang.UnsupportedOperationException:  Unknown Ptg in Formula: 0x2 (2)\n        at org.apache.poi.hssf.record.formula.Ptg.createPtg(Ptg.java:357)\n        at org.apache.poi.hssf.record.DVRecord.fillFields(DVRecord.java:201)\n        at org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n        at org.apache.poi.hssf.record.DVRecord.<init>(DVRecord.java:134)\n        ... 60 more\nFailed to open the Excel file :org.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\nI have attached my spreadsheet. What can I do to successfully upload my spreadsheet?"}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "It looks to be a problem with parsing the formula used by one of the Data Validation records. Any chance you could identify which is the problem formula? (You'll probably need to delete the validation entries one at a time until it works to spot which one it is).", "id": 143322, "time": "2011-01-13T07:13:04Z", "bug_id": 50573, "creation_time": "2011-01-13T07:13:04Z", "is_private": false}, {"count": 2, "attachment_id": 34057, "bug_id": 50573, "text": "Created attachment 34057\nunit test used to show that this passes\n\nThis works for me on the latest trunk builds. It was probably fixed a long time ago.", "id": 192521, "time": "2016-07-19T09:09:26Z", "creator": "onealj@apache.org", "creation_time": "2016-07-19T09:09:26Z", "tags": [], "is_private": false}]