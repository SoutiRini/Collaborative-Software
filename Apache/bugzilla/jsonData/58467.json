[{"count": 0, "tags": [], "bug_id": 58467, "attachment_id": null, "is_private": false, "id": 185542, "time": "2015-09-29T17:06:41Z", "creator": "stgrein@gmail.com", "creation_time": "2015-09-29T17:06:41Z", "text": "Apache 2.4.XX example which will produce a warning:\n\nRewriteRule ^/path/(foo|bar)/(.*)$ - [E=mypath:$1]\n<LocationMatch \"/path/(foo|bar)/.*\">\n\tSetOutputFilter proxy-html\n\tProxyHTMLInterp On\n\tProxyHTMLURLMap ^/a/path/to/change/(.*)$ /newpath/${mypath}/images/$1 ecRiLV\n</LocationMatch>\n\nThis is how the documentation of proxy_html is telling us to use environment variables.\n\nSyntax Check or Startup Warning will be the following:\n\n[Tue Sep 29 18:30:08.800644 2015] [core:warn] [pid 3114:tid 140660994774912] AH00111: Config variable ${mypath} is not defined\n\n\nIn my opinion the config should be written since Apache 2.4 like this as the notation of environmental variables has changed:\n\nRewriteRule ^/path/(foo|bar)/(.*)$ - [E=mypath:$1]\n<LocationMatch \"/path/(foo|bar)/.*\">\n\tSetOutputFilter proxy-html\n\tProxyHTMLInterp On\n\tProxyHTMLURLMap ^/a/path/to/change/(.*)$ /newpath/%{ENV:mypath}/images/$1 ecRiLV\n</LocationMatch>\n\nBut if I use it this way, the replacement of the variable is no longer working, it writes down the url encoded representation of it into the path: %25%7BENV%3Amypath%7D\n\nConclusion:\nEither the warning should be removed here or the way of noting variables should be changed to comply with Apache 2.4 environment variable notation style."}, {"count": 1, "attachment_id": null, "bug_id": 58467, "text": "Hi, \nIs there a work-around for this issue? \n\nThanks", "id": 190783, "time": "2016-05-09T14:46:27Z", "creator": "guido.raimondi@trs.it", "creation_time": "2016-05-09T14:46:27Z", "tags": [], "is_private": false}, {"count": 2, "text": "ProxyHTMLURLMap works if used with the for environment vars wrong ${varname} notation but produces the mentioned warnings. This is kind of a workaround.\n\nBut the notation ${varname} is only allowed for variables defined with Define or -D at startup, it is not valid for environmental variables so the apache warning under 2.4.x is correct.\n\nIf used with the %{ENV:varname} notation it does not work at all. So the module is using 2.2.x syntax under 2.4.x and therefore needs a bugfix.", "bug_id": 58467, "attachment_id": null, "id": 190784, "time": "2016-05-09T15:17:18Z", "creator": "stgrein@gmail.com", "creation_time": "2016-05-09T15:17:18Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "creator": "stgrein@gmail.com", "is_private": false, "text": "May I ask for an update? The bug is still in the 2.4 Code...", "id": 201710, "time": "2017-10-27T07:26:35Z", "bug_id": 58467, "creation_time": "2017-10-27T07:26:35Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "nick@webthing.com", "is_private": false, "text": "\n> May I ask for an update? The bug is still in the 2.4 Code...\n\nSorry, I've only just looked at this.  Looks like it would indeed be a Good Idea to change it: the mod_proxy_html syntax pre-dates the config variable changes that interact with it to produce the error.\n\nI'll have a think about this: your suggestion looks like a candidate fix, but maybe using the expression parser could add something more!", "id": 202813, "time": "2017-12-16T21:21:04Z", "bug_id": 58467, "creation_time": "2017-12-16T21:21:04Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "nick@webthing.com", "attachment_id": 35617, "id": 202815, "time": "2017-12-16T22:20:52Z", "bug_id": 58467, "creation_time": "2017-12-16T22:20:52Z", "is_private": false, "text": "Created attachment 35617\nCandidate fix\n\nDoes the attached patch do the job for you?"}]