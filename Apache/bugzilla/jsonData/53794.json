[{"count": 0, "tags": [], "text": "Hi,\n\nin my configuration, has as DirectoryIndex this parameter:\n - DirectoryIndex  index.html index.htm index.php\n\nIf in the root virtualhost Directory, I set a redirect via htaccess and are present more index file,\n\nRewite Rule:\n RewriteCond %{REQUEST_URI} !^/mysite\n RewriteRule ^(.*)$ site/$1 [L]\n\nFolder List:\n-rwxr-xr-x  1 18107657 users         1098 Aug 28 12:44 index.html\n-rwxr-xr-x  1 18107657 users         1094 Nov  5  2008 index.php\ndrwxr-xr-x 16 18107657 users         2048 Mar  7 21:27 mysite\n\nwhen start appling rule, it's also passed as DirectoryIndex say:\n ex: http://mysite/ is redirected to http://mysite/mysite/index.html\n\nbut in the folder if not exists, has a 404 error code.", "attachment_id": null, "bug_id": 53794, "id": 161804, "time": "2012-08-29T08:32:11Z", "creator": "christian.cioni@staff.aruba.it", "creation_time": "2012-08-29T08:32:11Z", "is_private": false}, {"count": 1, "tags": [], "text": "can you attach rewrite:trace8 logs?", "attachment_id": null, "bug_id": 53794, "id": 161807, "time": "2012-08-29T10:25:06Z", "creator": "covener@gmail.com", "creation_time": "2012-08-29T10:25:06Z", "is_private": false}, {"count": 2, "tags": [], "creator": "christian.cioni@staff.aruba.it", "attachment_id": null, "id": 161813, "time": "2012-08-29T12:38:28Z", "bug_id": 53794, "creation_time": "2012-08-29T12:38:28Z", "is_private": false, "text": "[rid#1ac22a0/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] strip per-dir prefix: /web/htdocs/www.arubaphpini.it/home/ -> \n[rid#1ac22a0/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] applying pattern '^(.*)$' to uri ''\n[rid#1ac22a0/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] RewriteCond: input='/' pattern='!^/joo5' => matched\n[rid#1ac22a0/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] rewrite '' -> 'joo5/'\n[rid#1ac22a0/initial] discarding query string\n[rid#1ac22a0/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] add per-dir prefix: joo5/ -> /web/htdocs/www.arubaphpini.it/home/joo5/\n[rid#1ac22a0/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] strip document_root prefix: /web/htdocs/www.arubaphpini.it/home/joo5/ -> /joo5/\n[rid#1ac22a0/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] internal redirect with /joo5/ [INTERNAL REDIRECT]\n[rid#1ada480/subreq] [perdir /web/htdocs/www.arubaphpini.it/home/] strip per-dir prefix: /web/htdocs/www.arubaphpini.it/home/index.html -> index.html\n[rid#1ada480/subreq] [perdir /web/htdocs/www.arubaphpini.it/home/] applying pattern '^(.*)$' to uri 'index.html'\n[rid#1ada480/subreq] [perdir /web/htdocs/www.arubaphpini.it/home/] RewriteCond: input='/index.html' pattern='!^/joo5' => matched\n[rid#1ada480/subreq] [perdir /web/htdocs/www.arubaphpini.it/home/] rewrite 'index.html' -> 'joo5/index.html'\n[rid#1ada480/subreq] discarding query string\n[rid#1ada480/subreq] [perdir /web/htdocs/www.arubaphpini.it/home/] add per-dir prefix: joo5/index.html -> /web/htdocs/www.arubaphpini.it/home/joo5/index.html\n[rid#1ada480/subreq] [perdir /web/htdocs/www.arubaphpini.it/home/] strip document_root prefix: /web/htdocs/www.arubaphpini.it/home/joo5/index.html -> /joo5/index.html\n[rid#1ada480/subreq] [perdir /web/htdocs/www.arubaphpini.it/home/] internal redirect with /joo5/index.html [INTERNAL REDIRECT]\n[rid#1ade6f0/initial/redir#1] [perdir /web/htdocs/www.arubaphpini.it/home/] strip per-dir prefix: /web/htdocs/www.arubaphpini.it/home/joo5/index.html -> joo5/index.html\n[rid#1ade6f0/initial/redir#1] [perdir /web/htdocs/www.arubaphpini.it/home/] applying pattern '^(.*)$' to uri 'joo5/index.html'\n[rid#1ade6f0/initial/redir#1] [perdir /web/htdocs/www.arubaphpini.it/home/] RewriteCond: input='/joo5/index.html' pattern='!^/joo5' => not-matched\n[rid#1ade6f0/initial/redir#1] [perdir /web/htdocs/www.arubaphpini.it/home/] pass through /web/htdocs/www.arubaphpini.it/home/joo5/index.html\n[rid#1ace420/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] strip per-dir prefix: /web/htdocs/www.arubaphpini.it/home/favicon.ico -> favicon.ico\n[rid#1ace420/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] applying pattern '^(.*)$' to uri 'favicon.ico'\n[rid#1ace420/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] RewriteCond: input='/favicon.ico' pattern='!^/joo5' => matched\n[rid#1ace420/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] rewrite 'favicon.ico' -> 'joo5/favicon.ico'\n[rid#1ace420/initial] discarding query string\n[rid#1ace420/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] add per-dir prefix: joo5/favicon.ico -> /web/htdocs/www.arubaphpini.it/home/joo5/favicon.ico\n[rid#1ace420/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] strip document_root prefix: /web/htdocs/www.arubaphpini.it/home/joo5/favicon.ico -> /joo5/favicon.ico\n[rid#1ace420/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] internal redirect with /joo5/favicon.ico [INTERNAL REDIRECT]\n[rid#1ae4de0/initial/redir#1] [perdir /web/htdocs/www.arubaphpini.it/home/] strip per-dir prefix: /web/htdocs/www.arubaphpini.it/home/joo5/favicon.ico -> joo5/favicon.ico\n[rid#1ae4de0/initial/redir#1] [perdir /web/htdocs/www.arubaphpini.it/home/] applying pattern '^(.*)$' to uri 'joo5/favicon.ico'\n[rid#1ae4de0/initial/redir#1] [perdir /web/htdocs/www.arubaphpini.it/home/] RewriteCond: input='/joo5/favicon.ico' pattern='!^/joo5' => not-matched\n[rid#1ae4de0/initial/redir#1] [perdir /web/htdocs/www.arubaphpini.it/home/] pass through /web/htdocs/www.arubaphpini.it/home/joo5/favicon.ico"}, {"count": 3, "tags": [], "creator": "christian.cioni@staff.aruba.it", "attachment_id": null, "id": 161814, "time": "2012-08-29T12:39:10Z", "bug_id": 53794, "creation_time": "2012-08-29T12:39:10Z", "is_private": false, "text": "[rid#1ac22a0/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] strip per-dir prefix: /web/htdocs/www.arubaphpini.it/home/ -> \n[rid#1ac22a0/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] applying pattern '^(.*)$' to uri ''\n[rid#1ac22a0/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] RewriteCond: input='/' pattern='!^/joo5' => matched\n[rid#1ac22a0/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] rewrite '' -> 'joo5/'\n[rid#1ac22a0/initial] discarding query string\n[rid#1ac22a0/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] add per-dir prefix: joo5/ -> /web/htdocs/www.arubaphpini.it/home/joo5/\n[rid#1ac22a0/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] strip document_root prefix: /web/htdocs/www.arubaphpini.it/home/joo5/ -> /joo5/\n[rid#1ac22a0/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] internal redirect with /joo5/ [INTERNAL REDIRECT]\n[rid#1ada480/subreq] [perdir /web/htdocs/www.arubaphpini.it/home/] strip per-dir prefix: /web/htdocs/www.arubaphpini.it/home/index.html -> index.html\n[rid#1ada480/subreq] [perdir /web/htdocs/www.arubaphpini.it/home/] applying pattern '^(.*)$' to uri 'index.html'\n[rid#1ada480/subreq] [perdir /web/htdocs/www.arubaphpini.it/home/] RewriteCond: input='/index.html' pattern='!^/joo5' => matched\n[rid#1ada480/subreq] [perdir /web/htdocs/www.arubaphpini.it/home/] rewrite 'index.html' -> 'joo5/index.html'\n[rid#1ada480/subreq] discarding query string\n[rid#1ada480/subreq] [perdir /web/htdocs/www.arubaphpini.it/home/] add per-dir prefix: joo5/index.html -> /web/htdocs/www.arubaphpini.it/home/joo5/index.html\n[rid#1ada480/subreq] [perdir /web/htdocs/www.arubaphpini.it/home/] strip document_root prefix: /web/htdocs/www.arubaphpini.it/home/joo5/index.html -> /joo5/index.html\n[rid#1ada480/subreq] [perdir /web/htdocs/www.arubaphpini.it/home/] internal redirect with /joo5/index.html [INTERNAL REDIRECT]\n[rid#1ade6f0/initial/redir#1] [perdir /web/htdocs/www.arubaphpini.it/home/] strip per-dir prefix: /web/htdocs/www.arubaphpini.it/home/joo5/index.html -> joo5/index.html\n[rid#1ade6f0/initial/redir#1] [perdir /web/htdocs/www.arubaphpini.it/home/] applying pattern '^(.*)$' to uri 'joo5/index.html'\n[rid#1ade6f0/initial/redir#1] [perdir /web/htdocs/www.arubaphpini.it/home/] RewriteCond: input='/joo5/index.html' pattern='!^/joo5' => not-matched\n[rid#1ade6f0/initial/redir#1] [perdir /web/htdocs/www.arubaphpini.it/home/] pass through /web/htdocs/www.arubaphpini.it/home/joo5/index.html\n[rid#1ace420/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] strip per-dir prefix: /web/htdocs/www.arubaphpini.it/home/favicon.ico -> favicon.ico\n[rid#1ace420/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] applying pattern '^(.*)$' to uri 'favicon.ico'\n[rid#1ace420/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] RewriteCond: input='/favicon.ico' pattern='!^/joo5' => matched\n[rid#1ace420/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] rewrite 'favicon.ico' -> 'joo5/favicon.ico'\n[rid#1ace420/initial] discarding query string\n[rid#1ace420/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] add per-dir prefix: joo5/favicon.ico -> /web/htdocs/www.arubaphpini.it/home/joo5/favicon.ico\n[rid#1ace420/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] strip document_root prefix: /web/htdocs/www.arubaphpini.it/home/joo5/favicon.ico -> /joo5/favicon.ico\n[rid#1ace420/initial] [perdir /web/htdocs/www.arubaphpini.it/home/] internal redirect with /joo5/favicon.ico [INTERNAL REDIRECT]\n[rid#1ae4de0/initial/redir#1] [perdir /web/htdocs/www.arubaphpini.it/home/] strip per-dir prefix: /web/htdocs/www.arubaphpini.it/home/joo5/favicon.ico -> joo5/favicon.ico\n[rid#1ae4de0/initial/redir#1] [perdir /web/htdocs/www.arubaphpini.it/home/] applying pattern '^(.*)$' to uri 'joo5/favicon.ico'\n[rid#1ae4de0/initial/redir#1] [perdir /web/htdocs/www.arubaphpini.it/home/] RewriteCond: input='/joo5/favicon.ico' pattern='!^/joo5' => not-matched\n[rid#1ae4de0/initial/redir#1] [perdir /web/htdocs/www.arubaphpini.it/home/] pass through /web/htdocs/www.arubaphpini.it/home/joo5/favicon.ico"}, {"count": 4, "attachment_id": null, "bug_id": 53794, "text": "In htaccess, you're implicitly matching against the filename that will be served, and mod_dir sets up the internal filename to point to the matching DirectoryIndex.\n\nYou'll have to account for this in your rules, by looking at REQUEST_URI or skipping subrequests w/ the [NS] flag.", "id": 161962, "time": "2012-09-05T11:40:13Z", "creator": "covener@gmail.com", "creation_time": "2012-09-05T11:40:13Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "creator": "christian.cioni@staff.aruba.it", "attachment_id": null, "is_private": false, "id": 162500, "time": "2012-10-02T10:35:15Z", "bug_id": 53794, "creation_time": "2012-10-02T10:35:15Z", "text": "Sorry but I do not understand! In Apache 2.2 the same configuration works properly.\n\nBut with Apache 2.4, priority is given to the DirectoryIndex than rewriting rules.\n\nAnother example:\n\nRewriteEngine On\n\nRewriteRule ^ securecode.png captcha / code.php [L]\n\nRewriteRule ^ (. *) \\ / ([0-9] *) \\ / (. *) $ Template.php? Param = $ 1 & page = $ 2 & other = $ 3 [L]\nRewriteRule ^ (. *) \\ / (Page =) ([0-9] *) $ template.php? Page = $ 1 & page = $ 3 [L]\nRewriteRule ^ (. *). Htm $ template.php? Page = $ 1 [QSA]\nRewriteRule ^ $ template.php [L]\n\nand I foder such an index.php file, the rewrite is not considered and you will see the contents of the file index.php\n\n[Tue Oct 02 12:03:47.206423 2012] [authz_core:debug] [pid 24027:tid 139640557938432] mod_authz_core.c(802): [client 46.37.0.11:16001] AH01626: authorization result of Require all granted: granted\n[Tue Oct 02 12:03:47.206465 2012] [authz_core:debug] [pid 24027:tid 139640557938432] mod_authz_core.c(802): [client 46.37.0.11:16001] AH01626: authorization result of <RequireAny>: granted\n[Tue Oct 02 12:03:47.207751 2012] [rewrite:trace3] [pid 24027:tid 139640557938432] mod_rewrite.c(467): [client 46.37.0.11:16001] 46.37.0.11 - - [www.rosinicornici.it/sid#1c117c0][rid#7f0070002970/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/ -> \n[Tue Oct 02 12:03:47.207772 2012] [rewrite:trace3] [pid 24027:tid 139640557938432] mod_rewrite.c(467): [client 46.37.0.11:16001] 46.37.0.11 - - [www.rosinicornici.it/sid#1c117c0][rid#7f0070002970/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^securecode.png' to uri ''\n[Tue Oct 02 12:03:47.207783 2012] [rewrite:trace3] [pid 24027:tid 139640557938432] mod_rewrite.c(467): [client 46.37.0.11:16001] 46.37.0.11 - - [www.rosinicornici.it/sid#1c117c0][rid#7f0070002970/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/ -> \n[Tue Oct 02 12:03:47.207792 2012] [rewrite:trace3] [pid 24027:tid 139640557938432] mod_rewrite.c(467): [client 46.37.0.11:16001] 46.37.0.11 - - [www.rosinicornici.it/sid#1c117c0][rid#7f0070002970/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^(.*)\\\\/([0-9]*)\\\\/(.*)$' to uri ''\n[Tue Oct 02 12:03:47.207801 2012] [rewrite:trace3] [pid 24027:tid 139640557938432] mod_rewrite.c(467): [client 46.37.0.11:16001] 46.37.0.11 - - [www.rosinicornici.it/sid#1c117c0][rid#7f0070002970/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/ -> \n[Tue Oct 02 12:03:47.207810 2012] [rewrite:trace3] [pid 24027:tid 139640557938432] mod_rewrite.c(467): [client 46.37.0.11:16001] 46.37.0.11 - - [www.rosinicornici.it/sid#1c117c0][rid#7f0070002970/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^(.*)\\\\/(page=)([0-9]*)$' to uri ''\n[Tue Oct 02 12:03:47.207818 2012] [rewrite:trace3] [pid 24027:tid 139640557938432] mod_rewrite.c(467): [client 46.37.0.11:16001] 46.37.0.11 - - [www.rosinicornici.it/sid#1c117c0][rid#7f0070002970/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/ -> \n[Tue Oct 02 12:03:47.207826 2012] [rewrite:trace3] [pid 24027:tid 139640557938432] mod_rewrite.c(467): [client 46.37.0.11:16001] 46.37.0.11 - - [www.rosinicornici.it/sid#1c117c0][rid#7f0070002970/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^(.*).htm$' to uri ''\n[Tue Oct 02 12:03:47.207835 2012] [rewrite:trace3] [pid 24027:tid 139640557938432] mod_rewrite.c(467): [client 46.37.0.11:16001] 46.37.0.11 - - [www.rosinicornici.it/sid#1c117c0][rid#7f0070002970/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/ -> \n[Tue Oct 02 12:03:47.207861 2012] [rewrite:trace3] [pid 24027:tid 139640557938432] mod_rewrite.c(467): [client 46.37.0.11:16001] 46.37.0.11 - - [www.rosinicornici.it/sid#1c117c0][rid#7f0070002970/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^$' to uri ''\n[Tue Oct 02 12:03:47.207874 2012] [rewrite:trace2] [pid 24027:tid 139640557938432] mod_rewrite.c(467): [client 46.37.0.11:16001] 46.37.0.11 - - [www.rosinicornici.it/sid#1c117c0][rid#7f0070002970/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] rewrite '' -> 'template.php'\n[Tue Oct 02 12:03:47.207884 2012] [rewrite:trace3] [pid 24027:tid 139640557938432] mod_rewrite.c(467): [client 46.37.0.11:16001] 46.37.0.11 - - [www.rosinicornici.it/sid#1c117c0][rid#7f0070002970/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] add per-dir prefix: template.php -> /web/htdocs/www.rosinicornici.it/home/template.php\n[Tue Oct 02 12:03:47.207899 2012] [rewrite:trace2] [pid 24027:tid 139640557938432] mod_rewrite.c(467): [client 46.37.0.11:16001] 46.37.0.11 - - [www.rosinicornici.it/sid#1c117c0][rid#7f0070002970/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] strip document_root prefix: /web/htdocs/www.rosinicornici.it/home/template.php -> /template.php\n[Tue Oct 02 12:03:47.207908 2012] [rewrite:trace1] [pid 24027:tid 139640557938432] mod_rewrite.c(467): [client 46.37.0.11:16001] 46.37.0.11 - - [www.rosinicornici.it/sid#1c117c0][rid#7f0070002970/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] internal redirect with /template.php [INTERNAL REDIRECT]\n\n\n\n\n\n\n\n\n\n\n\n\nsid#1c117c0][rid#7f0070028da0/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/ -> \nsid#1c117c0][rid#7f0070028da0/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^securecode.png' to uri ''\nsid#1c117c0][rid#7f0070028da0/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/ -> \nsid#1c117c0][rid#7f0070028da0/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^(.*)\\\\/([0-9]*)\\\\/(.*)$' to uri ''\nsid#1c117c0][rid#7f0070028da0/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/ -> \nsid#1c117c0][rid#7f0070028da0/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^(.*)\\\\/(page=)([0-9]*)$' to uri ''\nsid#1c117c0][rid#7f0070028da0/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/ -> \nsid#1c117c0][rid#7f0070028da0/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^(.*).htm$' to uri ''\nsid#1c117c0][rid#7f0070028da0/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/ -> \nsid#1c117c0][rid#7f0070028da0/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^$' to uri ''\nsid#1c117c0][rid#7f0070028da0/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] rewrite '' -> 'template.php'\nsid#1c117c0][rid#7f0070028da0/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] add per-dir prefix: template.php -> /web/htdocs/www.rosinicornici.it/home/template.php\nsid#1c117c0][rid#7f0070028da0/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] strip document_root prefix: /web/htdocs/www.rosinicornici.it/home/template.php -> /template.php\nsid#1c117c0][rid#7f0070028da0/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] internal redirect with /template.php [INTERNAL REDIRECT]\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/index.html -> index.html\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^securecode.png' to uri 'index.html'\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/index.html -> index.html\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^(.*)\\\\/([0-9]*)\\\\/(.*)$' to uri 'index.html'\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/index.html -> index.html\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^(.*)\\\\/(page=)([0-9]*)$' to uri 'index.html'\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/index.html -> index.html\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^(.*).htm$' to uri 'index.html'\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/index.html -> index.html\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^$' to uri 'index.html'\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] pass through /web/htdocs/www.rosinicornici.it/home/index.html\nsid#1c117c0][rid#7f0070020d60/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/index.htm -> index.htm\nsid#1c117c0][rid#7f0070020d60/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^securecode.png' to uri 'index.htm'\nsid#1c117c0][rid#7f0070020d60/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/index.htm -> index.htm\nsid#1c117c0][rid#7f0070020d60/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^(.*)\\\\/([0-9]*)\\\\/(.*)$' to uri 'index.htm'\nsid#1c117c0][rid#7f0070020d60/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/index.htm -> index.htm\nsid#1c117c0][rid#7f0070020d60/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^(.*)\\\\/(page=)([0-9]*)$' to uri 'index.htm'\nsid#1c117c0][rid#7f0070020d60/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/index.htm -> index.htm\nsid#1c117c0][rid#7f0070020d60/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^(.*).htm$' to uri 'index.htm'\nsid#1c117c0][rid#7f0070020d60/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] rewrite 'index.htm' -> 'template.php?pagina=index'\nsid#1c117c0][rid#7f0070020d60/subreq] split uri=template.php?pagina=index -> uri=template.php, args=pagina=index\nsid#1c117c0][rid#7f0070020d60/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] add per-dir prefix: template.php -> /web/htdocs/www.rosinicornici.it/home/template.php\nsid#1c117c0][rid#7f0070020d60/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/template.php -> template.php\nsid#1c117c0][rid#7f0070020d60/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^$' to uri 'template.php'\nsid#1c117c0][rid#7f0070020d60/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] strip document_root prefix: /web/htdocs/www.rosinicornici.it/home/template.php -> /template.php\nsid#1c117c0][rid#7f0070020d60/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] internal redirect with /template.php [INTERNAL REDIRECT]\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/index.php -> index.php\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^securecode.png' to uri 'index.php'\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/index.php -> index.php\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^(.*)\\\\/([0-9]*)\\\\/(.*)$' to uri 'index.php'\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/index.php -> index.php\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^(.*)\\\\/(page=)([0-9]*)$' to uri 'index.php'\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/index.php -> index.php\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^(.*).htm$' to uri 'index.php'\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/index.php -> index.php\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^$' to uri 'index.php'\nsid#1c117c0][rid#7f0070022d70/subreq] [perdir /web/htdocs/www.rosinicornici.it/home/] pass through /web/htdocs/www.rosinicornici.it/home/index.php\nsid#1c117c0][rid#7f0070004980/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/favicon.ico -> favicon.ico\nsid#1c117c0][rid#7f0070004980/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^securecode.png' to uri 'favicon.ico'\nsid#1c117c0][rid#7f0070004980/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/favicon.ico -> favicon.ico\nsid#1c117c0][rid#7f0070004980/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^(.*)\\\\/([0-9]*)\\\\/(.*)$' to uri 'favicon.ico'\nsid#1c117c0][rid#7f0070004980/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/favicon.ico -> favicon.ico\nsid#1c117c0][rid#7f0070004980/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^(.*)\\\\/(page=)([0-9]*)$' to uri 'favicon.ico'\nsid#1c117c0][rid#7f0070004980/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/favicon.ico -> favicon.ico\nsid#1c117c0][rid#7f0070004980/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^(.*).htm$' to uri 'favicon.ico'\nsid#1c117c0][rid#7f0070004980/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] strip per-dir prefix: /web/htdocs/www.rosinicornici.it/home/favicon.ico -> favicon.ico\nsid#1c117c0][rid#7f0070004980/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] applying pattern '^$' to uri 'favicon.ico'\nsid#1c117c0][rid#7f0070004980/initial] [perdir /web/htdocs/www.rosinicornici.it/home/] pass through /web/htdocs/www.rosinicornici.it/home/favicon.ico"}, {"count": 6, "tags": [], "creator": "koumes@centrum.cz", "attachment_id": null, "text": "I have the same problem with mod_rewrite + mod_dir (also similar bug https://issues.apache.org/bugzilla/show_bug.cgi?id=53929). A mod_dir call undesirable subrequest and override a previous rewrited URL.\n\n.htaccess:\n\nDirectoryIndex index1.html index2.html\n\nRewriteEngine On\nRewriteRule !\\.html$ /index3.html [L]\n\n\nURL: http://localhost/\n\nBad result (Apache 2.4.3, 2.4.4): index1.html or index2.html\nExpected result (Apache 2.2.22): index3.html\n\n\nRewritelog:\n\n[Sat Feb 23 19:46:28.683232 2013] [rewrite:trace3] [pid 28647:tid 140599957112576] mod_rewrite.c(468): [client 127.0.0.1:8813] 127.0.0.1 - - [localhost/sid\n#7fe007bdda60][rid#7fe007acc0a0/initial] [perdir /var/www/default/] strip per-dir prefix: /var/www/default/ -> \n[Sat Feb 23 19:46:28.683286 2013] [rewrite:trace3] [pid 28647:tid 140599957112576] mod_rewrite.c(468): [client 127.0.0.1:8813] 127.0.0.1 - - [localhost/sid#7fe007bdda60][rid#7fe007acc0a0/initial] [perdir /var/www/default/] applying pattern '\\\\.html$' to uri ''\n[Sat Feb 23 19:46:28.683307 2013] [rewrite:trace2] [pid 28647:tid 140599957112576] mod_rewrite.c(468): [client 127.0.0.1:8813] 127.0.0.1 - - [localhost/sid#7fe007bdda60][rid#7fe007acc0a0/initial] [perdir /var/www/default/] rewrite '' -> 'index3.html'\n[Sat Feb 23 19:46:28.683324 2013] [rewrite:trace3] [pid 28647:tid 140599957112576] mod_rewrite.c(468): [client 127.0.0.1:8813] 127.0.0.1 - - [localhost/sid#7fe007bdda60][rid#7fe007acc0a0/initial] [perdir /var/www/default/] add per-dir prefix: index3.html -> /var/www/default/index3.html\n[Sat Feb 23 19:46:28.683342 2013] [rewrite:trace2] [pid 28647:tid 140599957112576] mod_rewrite.c(468): [client 127.0.0.1:8813] 127.0.0.1 - - [localhost/sid#7fe007bdda60][rid#7fe007acc0a0/initial] [perdir /var/www/default/] strip document_root prefix: /var/www/default/index3.html -> /index3.html\n[Sat Feb 23 19:46:28.683351 2013] [rewrite:trace1] [pid 28647:tid 140599957112576] mod_rewrite.c(468): [client 127.0.0.1:8813] 127.0.0.1 - - [localhost/sid#7fe007bdda60][rid#7fe007acc0a0/initial] [perdir /var/www/default/] internal redirect with /index3.html [INTERNAL REDIRECT]\n[Sat Feb 23 19:46:28.683403 2013] [rewrite:trace3] [pid 28647:tid 140599957112576] mod_rewrite.c(468): [client 127.0.0.1:8813] 127.0.0.1 - - [localhost/sid#7fe007bdda60][rid#7fe007ac10a0/subreq] [perdir /var/www/default/] strip per-dir prefix: /var/www/default/index1.html -> index1.html\n[Sat Feb 23 19:46:28.683421 2013] [rewrite:trace3] [pid 28647:tid 140599957112576] mod_rewrite.c(468): [client 127.0.0.1:8813] 127.0.0.1 - - [localhost/sid#7fe007bdda60][rid#7fe007ac10a0/subreq] [perdir /var/www/default/] applying pattern '\\\\.html$' to uri 'index1.html'\n[Sat Feb 23 19:46:28.683432 2013] [rewrite:trace1] [pid 28647:tid 140599957112576] mod_rewrite.c(468): [client 127.0.0.1:8813] 127.0.0.1 - - [localhost/sid#7fe007bdda60][rid#7fe007ac10a0/subreq] [perdir /var/www/default/] pass through /var/www/default/index1.html\n[Sat Feb 23 19:46:28.683458 2013] [rewrite:trace3] [pid 28647:tid 140599957112576] mod_rewrite.c(468): [client 127.0.0.1:8813] 127.0.0.1 - - [localhost/sid#7fe007bdda60][rid#7fe007ac10a0/subreq] [perdir /var/www/default/] strip per-dir prefix: /var/www/default/index2.html -> index2.html\n[Sat Feb 23 19:46:28.683472 2013] [rewrite:trace3] [pid 28647:tid 140599957112576] mod_rewrite.c(468): [client 127.0.0.1:8813] 127.0.0.1 - - [localhost/sid#7fe007bdda60][rid#7fe007ac10a0/subreq] [perdir /var/www/default/] applying pattern '\\\\.html$' to uri 'index2.html'\n[Sat Feb 23 19:46:28.683487 2013] [rewrite:trace1] [pid 28647:tid 140599957112576] mod_rewrite.c(468): [client 127.0.0.1:8813] 127.0.0.1 - - [localhost/sid\n[Sat Feb 23 19:46:28.683487 2013] [rewrite:trace1] [pid 28647:tid 140599957112576] mod_rewrite.c(468): [client 127.0.0.1:8813] 127.0.0.1 - - [localhost/sid#7fe007bdda60][rid#7fe007ac10a0/subreq] [perdir /var/www/default/] pass through /var/www/default/index2.html", "id": 165453, "time": "2013-02-23T18:52:39Z", "bug_id": 53794, "creation_time": "2013-02-23T18:52:39Z", "is_private": false}, {"count": 7, "tags": [], "creator": "koumes@centrum.cz", "attachment_id": 29989, "text": "Created attachment 29989\nfirst revision of patch (53794 and 53929)", "id": 165475, "time": "2013-02-25T14:40:04Z", "bug_id": 53794, "creation_time": "2013-02-25T14:40:04Z", "is_private": false}, {"count": 8, "attachment_id": null, "bug_id": 53794, "text": "I discovered that bug is appeared in revision 233369 (http://svn.apache.org/viewvc?view=revision&revision=233369) and I am offering a patch. Please, review needed.", "id": 165476, "time": "2013-02-25T14:41:44Z", "creator": "koumes@centrum.cz", "creation_time": "2013-02-25T14:41:44Z", "tags": [], "is_private": false}, {"count": 9, "tags": [], "text": "Sorry this went unacknowledged. This issue was a regression in 2.4.x but was fixed in 2.4.8 with a pair of changes\n\n   *) mod_dir: Don't search for a DirectoryIndex or DirectorySlash on a URL\n     that was just rewritten by mod_rewrite. PR53929. [Eric Covener]\n\n   *) mod_dir: Add DirectoryCheckHandler to allow a 2.2-like behavior, skipping\n      execution when a handler is already set. PR53929. [Eric Covener]", "attachment_id": null, "bug_id": 53794, "id": 180330, "time": "2015-01-16T20:49:11Z", "creator": "covener@gmail.com", "creation_time": "2015-01-16T20:49:11Z", "is_private": false}]