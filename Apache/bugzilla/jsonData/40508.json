[{"count": 0, "tags": [], "text": "I got a exception as follow when copying sheet:\n\nCaused by: java.util.ConcurrentModificationException\njava.util.AbstractList$Itr.checkForComodification(AbstractList.java:449)\njava.util.AbstractList$Itr.next(AbstractList.java:420)\norg.apache.poi.hssf.record.ObjRecord.clone(ObjRecord.java:182)\norg.apache.poi.hssf.model.Sheet.cloneSheet(Sheet.java:320)\norg.apache.poi.hssf.usermodel.HSSFSheet.cloneSheet(HSSFSheet.java:114)\norg.apache.poi.hssf.usermodel.HSSFWorkbook.cloneSheet(HSSFWorkbook.java:337)\n snip\n\nIt is caused by a bug of \"clone\" method in the \"ObjRecord\" class.\n    public Object clone()\n    {\n        ObjRecord rec = new ObjRecord();\n        rec.subrecords = new ArrayList();\n\n        for ( Iterator iterator = subrecords.iterator(); iterator.hasNext(); )\n            subrecords.add(( (Record) iterator.next() ).clone()); \n\n        return rec;\n    }\n\n\"subrecords.add\" must be \"rec.subrecords.add\" in the \"for\" block. I got correct\nresult after modification.", "attachment_id": null, "id": 93569, "creator": "jajakarta@ytp.ne.jp", "time": "2006-09-14T09:05:03Z", "bug_id": 40508, "creation_time": "2006-09-14T09:05:03Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 40508, "text": "I dont want to add this patch without a testcase... seems risky to me. Could you\nplease supply a short testcase that triggers this bug? Thanks. ", "id": 98116, "attachment_id": null, "creator": "avik@apache.org", "creation_time": "2007-01-16T02:10:39Z", "time": "2007-01-16T02:10:39Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 40508, "is_private": false, "text": "Almost identical fix to bug 31092 (svn r353603)\n\n*** This bug has been marked as a duplicate of bug 31092 ***", "id": 116399, "time": "2008-05-08T22:24:07Z", "creator": "josh@apache.org", "creation_time": "2008-05-08T22:24:07Z", "attachment_id": null}]