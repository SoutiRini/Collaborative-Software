[{"count": 0, "tags": [], "creator": "stefan.proels@gmx.de", "text": "HSSFSheet.removeMergedRegion() throws an IndexOutOfBoundsException. The document\nI'm testing contains 2 merged regions. The following code is supposed to remove\nthem all. However, when trying to remove the second region it throw the\nexception. This is the test program:\n\n-----------------------------------\nimport java.io.*;\nimport org.apache.poi.poifs.filesystem.*;\nimport org.apache.poi.hssf.usermodel.*;\n\npublic class Test {\n\n  public static void main(String[] args)\n    throws Exception\n  {\n    FileInputStream in = new FileInputStream(\"example.xls\");\n    POIFSFileSystem fs = new POIFSFileSystem(in);\n    HSSFWorkbook wb = new HSSFWorkbook(fs);\n    HSSFSheet sheet = wb.getSheetAt(0);\n    int numRegions = sheet.getNumMergedRegions();\n    for (int i = 0; i < numRegions; i++) {\n      System.out.println(\"removing region \" + sheet.getMergedRegionAt(0));\n      sheet.removeMergedRegion(0);\n    }\n  }\n}\n-----------------------------------\n\nand here is what happens:\n\n-----------------------------------\nremoving region org.apache.poi.hssf.util.Region@3eca90\nremoving region org.apache.poi.hssf.util.Region@64dc11\nException in thread \"main\" java.lang.IndexOutOfBoundsException: Index: 95, Size: 36\n        at java.util.ArrayList.RangeCheck(ArrayList.java:508)\n        at java.util.ArrayList.remove(ArrayList.java:388)\n        at org.apache.poi.hssf.model.Sheet.removeMergedRegion(Sheet.java:342)\n        at\norg.apache.poi.hssf.usermodel.HSSFSheet.removeMergedRegion(HSSFSheet.java:502)\n        at Test.main(Test.java:17)\n-----------------------------------\n\nThe problem occured to me with POI versions 1.5.1 and 1.9.0.", "id": 31839, "time": "2003-02-24T07:17:32Z", "bug_id": 17329, "creation_time": "2003-02-24T07:17:32Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "stefan.proels@gmx.de", "is_private": false, "text": "Created attachment 4987\nExcel document for test case", "id": 31840, "time": "2003-02-24T07:21:48Z", "bug_id": 17329, "creation_time": "2003-02-24T07:21:48Z", "attachment_id": 4987}, {"count": 2, "tags": [], "bug_id": 17329, "attachment_id": null, "is_private": false, "id": 41348, "time": "2003-07-24T15:47:13Z", "creator": "poi-support@buni.org", "creation_time": "2003-07-24T15:47:13Z", "text": "IIRC this was fixed awhile ago... someone please verify.  (like whoever fixed it)"}, {"count": 3, "tags": [], "text": "yes i fixed it about 3 weeks ago, please verify with pre2", "is_private": false, "bug_id": 17329, "id": 41353, "time": "2003-07-24T15:52:01Z", "creator": "dmui@apache.org", "creation_time": "2003-07-24T15:52:01Z", "attachment_id": null}]