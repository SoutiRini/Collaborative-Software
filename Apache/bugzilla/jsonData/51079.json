[{"count": 0, "tags": [], "text": "Created attachment 26898\nmod_fcgid spawned CGI Process cannot impersonate user in order to access resources/database located in a remote machine in same windows workgroup\n\nProblem:\nmod_fcgid spawned CGI Process cannot impersonate windows user in order to access resources(e.g. database) located in a remote machine in same windows workgroup.\n\nRoot Cause:\n\"APR 1.4.2\" proc.c API does not implement Windows Impersonation by \nsecurity delegation.\n  \nSolution (implemented in patch):\nEnhanced APR 1.4.2 apr_procattr_user_set() functions to perform windows impersonation by Security delegation, added new APR API called apr_procattr_impersonation_level_set() that sets required windows impersonation level during apr_procattr_user_set() invocation.\nAnd new Fcgid options are implemented to utilize APR enhancements that enable access to remote resources using windows impersonation by Security delegation in Windows server class OS is implemented.\n\n\nMod_cgid Configuration enhancement details:\n\nTwo new Fcgid options as mentioned below are created:\n#\n# CGI process impersonation specific configuration\n#\n#     FcgidImpersonation   <On|Off>\n#                    \n#            On  ->  Impersonation is set to On. \n#                    Requires FcgidImpersonationCredentialProvider.\n#            Off ->  Impersonation is set to off. This is set by default. \n#\n#\n#\n#     FcgidImpersonationCredentialProvider  <module path> <entry point>\n#                       \n#            <module path> -> DLL/SO path that provides Username and password \n#                             for impersonation. Can be absolute or relative \n#                             path.\n#\n#            <entry point> -> Function name that provides Username and password.\n#\n#            Function prototype:\n#                  DWORD APIENTRY GetCredentials(\n#                                          IN OUT BYTE* pUtf8UserNameBuffer, \n#                                          IN OUT DWORD* pdwUserNameBufferLen, \n#                                          IN OUT BYTE* pUtf8PasswordBuffer, \n#                                          IN OUT DWORD* pdwPasswordBufferLen);\n#\n#\n#\n# Sample:\n#\n# FcgidImpersonation On\n# FcgidImpersonationCredentialProvider \"../modules/CredProv.dll\" GetCredentials", "is_private": false, "bug_id": 51079, "id": 145842, "time": "2011-04-18T20:39:01Z", "creator": "thangaraj@gmail.com", "creation_time": "2011-04-18T20:39:01Z", "attachment_id": 26898}, {"count": 1, "attachment_id": null, "bug_id": 51079, "text": "The obvious hesitation is storing a password value in the configuration.\n\nThe reason this and the User directive have not been supported in httpd\nis this fundamental weakness of the Windows security model, and that we\nhave not come up with any clever way to avoid it.", "id": 152941, "time": "2012-01-19T17:32:29Z", "creator": "wrowe@apache.org", "creation_time": "2012-01-19T17:32:29Z", "tags": [], "is_private": false}]