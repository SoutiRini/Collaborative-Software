[{"count": 0, "tags": [], "text": "connection_pool_timeout (or former recycle_timeout) is set to zero as default to\nkeep the number of AJP 13 connections low. However, many connections stay open,\nas the evaluation for closing seems to take place when the *next* requests\narrives. One should assume that \"zero\" means \"close right after the request\".\nFor me, the following patch works fine, but I am not sure enough to suggest it\nfor submission:\n\ndiff -cr tomcat-connectors-1.2.18-src/native/common/jk_ajp_common.c tomcat-conne\nctors-1.2.18-src.new/native/common/jk_ajp_common.c\n*** tomcat-connectors-1.2.18-src/native/common/jk_ajp_common.c  Tue Jul 18 09:19\n:27 2006\n--- tomcat-connectors-1.2.18-src.new/native/common/jk_ajp_common.c      Wed Sep\n13 15:42:09 2006\n***************\n*** 2081,2086 ****\n--- 2081,2089 ----\n          ajp_worker_t *w = p->worker;\n\n          JK_ENTER_CS(&w->cs, rc);\n+         if (p->worker != NULL && p->worker->cache_timeout == 0)\n+             p->reuse = JK_FALSE;\n+\n          if (rc) {\n              int i, sock = JK_INVALID_SOCKET;", "attachment_id": null, "id": 93518, "creator": "georg.zezschwitz@vodafone.com", "time": "2006-09-13T14:50:12Z", "bug_id": 40498, "creation_time": "2006-09-13T14:50:12Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 40498, "is_private": false, "count": 1, "id": 93597, "time": "2006-09-14T18:04:20Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2006-09-14T18:04:20Z", "text": "We will clarify documentation, that the default value \"0\" disables the timeout,\nnot the pooling.\n\nAlthough we could implement \"0\" as no pooling and \"-1\" as no timeout, this\ndramatically changes the pool behaviour for all existing configurations. As a\nconsequence we need to keep the meaning of the default value \"0\" the same.\n\nIf you need to really immediately close each connection after use, the upcoming\nversion 1.2.19 will include the new JkOption DisableReuse for Apache. You should\ncarefuly consider, if you really need this behaviour. It is very bad for\nperformance and usually not a good idea.\n"}]