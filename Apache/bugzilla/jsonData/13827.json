[{"count": 0, "text": "If I use tomcat 3.3.1 I end up with a JSESSIONID of \"zewmdq9u51.intlic1\" where\nintlic1 is the name of one of my load balanced workers.  However, if I use\ntomcat 4.1.12 or 4.0.6 I end up with a JSESSIONID of\n\"021F58EA1591E5AEADF594A74431E83E\" which has no .workername appended to it and\nthus never routes my session to the correct server.  The configs appended to the\nend of this bug report are using the RPM paths, but I've also tried with the\nstandard tarballs of 4.0.6 and 4.1.12 and duplicated the problem.  Here are the\nconfigs I'm using:\n\n-----\n\nmod_jk.conf:\n\nJkWorkersFile /etc/httpd/conf/workers.properties\nJkLogFile     /var/log/httpd/mod_jk.log\nJkLogLevel debug\n\nJkMount /*.jsp loadbalancer\nJkMount /*.do loadbalancer\nJkMount /licensemanager/* loadbalancer\n\n-----\n\nworkers.properties\n(using the RPM layout just change /var/tomcat4 to /var/tomcat3 and this file\nworks with tomcat 3.3.1)\n\nworkers.tomcat_home=/var/tomcat4\nworkers.java_home=/usr/java/j2sdk1.4.0_02\nps=/\n\nworker.list=loadbalancer\n\nworker.intlic1.port=8009\nworker.intlic1.host=10.4.4.10\nworker.intlic1.type=ajp13\nworker.intlic1.lbfactor=1\nworker.intlic1.local_worker=1\n\nworker.intlic2.port=8009\nworker.intlic2.host=10.4.4.11\nworker.intlic2.type=ajp13\nworker.intlic2.lbfactor=1\nworker.intlic2.local_worker=0\n\nworker.loadbalancer.type=lb\nworker.loadbalancer.balanced_workers=intlic1,intlic2\nworker.loadbalancer.local_worker_only=1\n\n-----\n\nserver.xml for tomcat 4.1.12\n(I've also tried using the coyote jk2 connector and still had the same results)\n\n<Server port=\"8005\" shutdown=\"SHUTDOWN\" debug=\"0\">\n  <Service name=\"Tomcat-Standalone\">\n    <Connector className=\"org.apache.catalina.connector.http.HttpConnector\"\n               port=\"8080\" minProcessors=\"5\" maxProcessors=\"75\"\n               enableLookups=\"true\" redirectPort=\"8443\"\n               acceptCount=\"10\" debug=\"0\" connectionTimeout=\"60000\"/>\n    <Connector className=\"org.apache.ajp.tomcat4.Ajp13Connector\"\n               port=\"8009\" minProcessors=\"5\" maxProcessors=\"75\"\n               acceptCount=\"10\" debug=\"0\"/>\n    <Engine name=\"Standalone\" defaultHost=\"intlic.togethersoft.net\" debug=\"0\">\n      <Logger className=\"org.apache.catalina.logger.FileLogger\"\n              prefix=\"catalina_log.\" suffix=\".txt\"\n              timestamp=\"true\"/>\n      <Realm className=\"org.apache.catalina.realm.MemoryRealm\" />\n      <Host name=\"intlic.togethersoft.net\" debug=\"0\" appBase=\"webapps\"\n       unpackWARs=\"true\" autoDeploy=\"true\">\n        <Valve className=\"org.apache.catalina.valves.AccessLogValve\"\n                 directory=\"logs\"  prefix=\"intlic.togethersoft.net_access_log.\"\nsuffix=\".txt\"\n                 pattern=\"common\"/>\n        <Logger className=\"org.apache.catalina.logger.FileLogger\"\n                 directory=\"logs\"  prefix=\"intlic.togethersoft.net_log.\"\nsuffix=\".txt\"\n                timestamp=\"true\"/>\n      </Host>\n    </Engine>\n  </Service>\n</Server>\n\n-----\n\nserver.xml for tomcat 3.3.1\n\n<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\n<Server>\n    <ContextManager workDir=\"/var/spool/tomcat3\" >\n        <LoaderInterceptor11  useApplicationLoader=\"true\" />\n        <TrustedLoader />\n        <LogSetter name=\"tc_log\" timestamps=\"true\"\n                   verbosityLevel=\"INFORMATION\"  />\n        <LogEvents enabled=\"false\" />\n        <ContextXmlReader config=\"conf/server.xml\" />\n        <ContextXmlReader config=\"conf/apps.xml\" />\n        <AutoDeploy source=\"/var/tomcat3/modules\" target=\"/var/tomcat3/modules\"\n                    redeploy=\"true\" />\n        <AutoWebApp dir=\"/var/tomcat3/modules\" host=\"DEFAULT\" trusted=\"true\"/>\n        <AutoDeploy source=\"/var/tomcat3/webapps\" target=\"/var/tomcat3/webapps\" />\n        <AutoWebApp dir=\"/var/tomcat3/webapps\" host=\"DEFAULT\" />\n        <PolicyLoader securityManagerClass=\"java.lang.SecurityManager\"\n                      policyFile=\"conf/tomcat.policy\" />\n        <SimpleMapper1 />\n        <SessionExpirer checkInterval=\"60\" />\n        <SessionIdGenerator randomClass=\"java.security.SecureRandom\"\n                            randomFile=\"/dev/urandom\" />\n        <LogSetter name=\"servlet_log\"\n                   timestamps=\"true\"\n                   verbosityLevel = \"INFORMATION\"\n                   path=\"/var/log/tomcat3/servlet-${yyyyMMdd}.log\"\n                   />\n        <LogSetter  name=\"JASPER_LOG\"\n                   timestamps=\"true\"\n                   path=\"/var/log/tomcat3/jasper-${yyyyMMdd}.log\"\n                   verbosityLevel = \"INFORMATION\"  />\n        <WebXmlReader validate=\"true\" />\n        <ErrorHandler showDebugInfo=\"true\" />\n        <WorkDirSetup cleanWorkDir=\"false\" />\n        <Jdk12Interceptor />\n        <InvokerInterceptor />\n        <JspInterceptor keepGenerated=\"true\"\n                        largeFile=\"false\"\n                        useJspServlet=\"false\"\n                        />\n        <StaticInterceptor listings=\"true\"\n                           useAcceptLanguage=\"true\"\n                           useCharset=\"locale\" />\n        <ReloadInterceptor fullReload=\"true\" />\n        <SimpleSessionStore maxActiveSessions=\"-1\" />\n        <AccessInterceptor />\n        <CredentialsInterceptor />\n        <SimpleRealm  filename=\"conf/users/global-users.xml\" />\n        <LoadOnStartupInterceptor />\n        <Servlet22Interceptor />\n        <DecodeInterceptor />\n        <SessionId cookiesFirst=\"true\" noCookies=\"false\" />\n        <ApacheConfig noRoot=\"true\" />\n        <IISConfig noRoot=\"true\" />\n        <NSConfig noRoot=\"true\" />\n        <Http10Connector   port=\"8080\"\n                           secure=\"false\"\n                           maxThreads=\"100\"\n                           maxSpareThreads=\"50\"\n                           minSpareThreads=\"10\" />\n        <JniConnector />\n        <Ajp12Connector address=\"127.0.0.1\" port=\"8007\"\nAjpidFile=\"/var/spool/tomcat3/ajp12.id\" />\n        <Ajp13Connector port=\"8009\" AjpidFile=\"/var/spool/tomcat3/ajp13.id\" />\n    </ContextManager>\n</Server>", "creator": "jcorley@togethersoft.com", "is_private": false, "id": 24961, "time": "2002-10-21T20:05:04Z", "bug_id": 13827, "creation_time": "2002-10-21T20:05:04Z", "tags": [], "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 13827, "text": "Hi Jason,\n\nDid you use the same mod_jk (ie the JK 1.2.0) against TC 3.3.1 and 4.x or\ndid you use the old mod_jk 1.1 which came from TC 3.3 ?\n\n", "id": 24975, "time": "2002-10-22T06:16:50Z", "creator": "hgomez@apache.org", "creation_time": "2002-10-22T06:16:50Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "is_private": false, "id": 24978, "time": "2002-10-22T07:58:36Z", "bug_id": 13827, "creation_time": "2002-10-22T07:58:36Z", "text": "This looks invalid. You need to set the \"jvmRoute\" attribute on the Engine element."}, {"attachment_id": null, "tags": [], "bug_id": 13827, "text": "Remy,\nThanks, that fixed it.  I guess I was too close to the problem to see the\nsolution.  I even went so far as dissecting mod_jk sources, and I can't program\n(yes it was an effort in futility).\nJason", "count": 3, "id": 24991, "time": "2002-10-22T13:45:11Z", "creator": "jcorley@togethersoft.com", "creation_time": "2002-10-22T13:45:11Z", "is_private": false}]