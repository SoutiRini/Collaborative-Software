[{"count": 0, "tags": [], "bug_id": 1415, "attachment_id": null, "text": "BUG:\nWhen scanning for child directories where the parent directory is excluded,\nDirectoryScanner does not return child directories (versions 1.2 and 1.3).\nThis used to work in version 1.1.\nFurthermore, if one calls getExcludedDirectories() or any of the methods\nthat calls slowScan(), a protected method, then getIncludeDirectories()\nreturns the child directories, so getIncludeDirectories() (versions 1.2 and 1.3)\nhas two possible different results/behaviors.\n\nSUGGESTION:\n1) Replace scan()(fast scan) with slowScan(), and only have one type of scan,\nor\n2) add method that explicitly sets type of scan (fast or slow),\nor\n3) make slowScan() a public method, so user can choose which scan to run.\nJust remember that if 2) or 3) is implemented, you should add a setter in\nMatchingTask to choose what type of scan() to run, and that \nit should default to slow scan to be backwards compatible with version 1.1.\n\n\nHere is a test program I wrote illustrating the problem:\n\nimport java.io.*;\nimport org.apache.tools.ant.*;\n\npublic class TestDirectoryScanner {\n\npublic static void main (String[] args){\n\n\t// setup test\n\tFile dir = new File (\"parent\");\n\tdir.mkdir();\n\tdir = new File (\"parent/child\");\n\tdir.mkdir();\n\tdir = new File (\"other\");\n\tdir.mkdir();\n\n\t// create directory scanner\n\tDirectoryScanner scanner = new DirectoryScanner();\n\tscanner.setBasedir (new File(\".\"));\n\tscanner.setExcludes (new String[]{ \"parent\" });\n\tscanner.scan();\n\n\tSystem.out.println (\"CALLING getIncludedDirectories()...\");\n\tString[] dirs = scanner.getIncludedDirectories();\n\tfor(int i = 0; i < dirs.length; i++) {\n\t\tSystem.out.println (\"    RETURNED DIR[\"+i+\"]: \" + dirs[i]);\n\t}\n\n\tscanner.getExcludedDirectories();\n\n\tSystem.out.println (\"CALLING getIncludedDirectories() AFTER CALLING \ngetExcludedDirectories()...\");\n\tdirs = scanner.getIncludedDirectories();\n\tfor(int i = 0; i < dirs.length; i++) {\n\t\tSystem.out.println (\"    RETURNED DIR[\"+i+\"]: \" + dirs[i]);\n\t}\n}\n\n}\n\nRun it from an empty directory, as it creates the directories needed\nfor the test.\n\n\nHere is the results for version 1.1:\n\nCALLING getIncludedDirectories()...\n    RETURNED DIR[0]: other\n    RETURNED DIR[1]: parent\\child\nCALLING getIncludedDirectories() AFTER CALLING getExcludedDirectories()...\n    RETURNED DIR[0]: other\n    RETURNED DIR[1]: parent\\child\n\n\nHere is the results for versions 1.2 and 1.3:\n\nCALLING getIncludedDirectories()...\n    RETURNED DIR[0]: other\nCALLING getIncludedDirectories() AFTER CALLING getExcludedDirectories()...\n    RETURNED DIR[0]: other\n    RETURNED DIR[1]: parent\\child", "id": 1935, "time": "2001-04-19T15:37:10Z", "creator": "James_Guido@homedepot.com", "creation_time": "2001-04-19T15:37:10Z", "is_private": false}, {"count": 1, "attachment_id": 100, "creator": "James_Guido@homedepot.com", "text": "Created attachment 100\nTest program Java source", "id": 1936, "time": "2001-04-19T15:39:03Z", "bug_id": 1415, "creation_time": "2001-04-19T15:39:03Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 1415, "attachment_id": null, "id": 3674, "time": "2001-07-12T06:03:20Z", "creator": "bodewig@apache.org", "creation_time": "2001-07-12T06:03:20Z", "is_private": false, "text": "fixed in nightly build for 2001-07-13"}]