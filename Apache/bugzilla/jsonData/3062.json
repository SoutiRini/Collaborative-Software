[{"count": 0, "tags": [], "bug_id": 3062, "attachment_id": null, "text": "If you put in a path with more than two dots under Windows platforms (e.g. \nhttp://localhost:8080/.../) the dots will expand to ../.. (the number of levels \nup is one less than the number of dots) and you are above the web root and can \naccess the whole hard disk. I've tested it under Windows 9x but not on any \nother platform (though it should occur under NT/2000). This patch to \norg/apache/catalina/servlets/DefaultServlet.java might fix it,\n\n931a932,934\n>       if (normalized.indexOf(\"...\") > -1)\n>         return null;\n>\n\nBut I haven't tested it a lot and it needs cleaning up.", "id": 4413, "time": "2001-08-09T10:39:18Z", "creator": "peter_c60@hotmail.com", "creation_time": "2001-08-09T10:39:18Z", "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 3062, "text": "Whoops, forgot the -u on diff. Here's the patch again:\n\n--- DefaultServlet.java.old Fri Jul 20 13:52:08 2001\n+++ DefaultServlet.java Thu Aug  9 18:32:28 2001\n@@ -929,6 +929,9 @@\n                normalized.substring(index + 3);\n        }\n\n+       if (normalized.indexOf(\"...\") > -1)\n+        return null;\n+\n        // Return the normalized path that we have completed\n        return (normalized);\n", "id": 4417, "time": "2001-08-09T11:03:10Z", "creator": "peter_c60@hotmail.com", "creation_time": "2001-08-09T11:03:10Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 3062, "is_private": false, "text": "Fixed in nightly build 20010810 (and in Tomcat 4.0-beta-7).\n\nHow do they let OS's that do this kind of thing out into the real world?  :-(\n", "id": 4418, "time": "2001-08-09T12:55:32Z", "creator": "craig.mcclanahan@sun.com", "creation_time": "2001-08-09T12:55:32Z", "attachment_id": null}]