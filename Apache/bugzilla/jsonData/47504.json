[{"count": 0, "tags": [], "bug_id": 47504, "attachment_id": 23953, "id": 128681, "time": "2009-07-09T16:21:14Z", "creator": "lnelson@llnl.gov", "creation_time": "2009-07-09T16:21:14Z", "is_private": false, "text": "Created attachment 23953\nsample workbook that POI 3.5-beta6 cannot open\n\nProblem:\n\nI created a simple xlsx file (Tried using both Excel 2008/Mac and 2007/Windows) by doing the following:\n1) Create new workbook\n2) Add a shape to workbook (Insert->Picture->Shape)\n3) Right-click the shape, select Hyperlink...\n4) Select \"Document\" (or \"Place in this Document\") as the link type\n5) Click \"Locate...\" choose \"Cell Reference\", then select a cell on a sheet\n6) Save file\n\n(I will attach this workbook to the bug)\n\nTry to read the xlsx file with POI (3.5-beta6), using the following code:\n\n     XSSFWorkbook wb = new XSSFWorkbook(\"test-hyperlink.xlsx\");\n\nGet the following exception:\n\nException in thread \"main\" org.apache.poi.POIXMLException: org.apache.poi.openxml4j.exceptions.InvalidFormatException: A segment shall not hold any characters other than pchar characters. [M1.6]\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:152)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:163)\n\tat org.apache.poi.util.TestLoad.main(TestLoad.java:49)\nCaused by: org.apache.poi.openxml4j.exceptions.InvalidFormatException: A segment shall not hold any characters other than pchar characters. [M1.6]\n\tat org.apache.poi.openxml4j.opc.PackagePartName.checkPCharCompliance(PackagePartName.java:370)\n\tat org.apache.poi.openxml4j.opc.PackagePartName.throwExceptionIfPartNameHaveInvalidSegments(PackagePartName.java:270)\n\tat org.apache.poi.openxml4j.opc.PackagePartName.throwExceptionIfInvalidPartUri(PackagePartName.java:185)\n\tat org.apache.poi.openxml4j.opc.PackagePartName.<init>(PackagePartName.java:83)\n\tat org.apache.poi.openxml4j.opc.PackagingURIHelper.createPartName(PackagingURIHelper.java:443)\n\tat org.apache.poi.POIXMLDocumentPart.read(POIXMLDocumentPart.java:234)\n\tat org.apache.poi.POIXMLDocumentPart.read(POIXMLDocumentPart.java:244)\n\tat org.apache.poi.POIXMLDocumentPart.read(POIXMLDocumentPart.java:244)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:150)\n\t... 2 more"}, {"count": 1, "tags": [], "creator": "yegor@dinom.ru", "is_private": false, "text": "Fixed in r793280\nPOI didn't properly process OPC packages containing relationships with targets starting with '#'.\n\nIn your case the problem was caused by a hyperlink relationship attached to the sheet drawing:\n\n  <Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\" Target=\"#Sheet1!A1\"/>\n\nThe '#' character indicates an internal target (e.g. cell region).  \n\nRegards,\nYegor", "id": 128761, "time": "2009-07-12T00:39:44Z", "bug_id": 47504, "creation_time": "2009-07-12T00:39:44Z", "attachment_id": null}]