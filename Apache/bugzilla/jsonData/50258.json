[{"count": 0, "attachment_id": 26284, "creator": "bugzilla@jabogo.de", "text": "Created attachment 26284\nCorrupted Rich Text XLSX\n\nExcel complains that the file created by the followin example is corrupted. Two fonts are applied to the string \"plain bold italic plain\" and the space before \"bold\" is removed. If you strip of the last five chars (\" plain\"), the file opens without a warning but the space between \"plain\" and \"bold\" is still missing.\n\nThe errors make the font aplying unusable for XSSF. The same test case with HSSF works fine.\n\n----------\n\nimport java.io.FileOutputStream;\nimport org.apache.poi.ss.usermodel.*;\nimport org.apache.poi.xssf.usermodel.XSSFWorkbook;\n\npublic class PoiRichTextBug\n{\n  public static void main(String[] args) throws Exception\n  {\n    Workbook workbook = new XSSFWorkbook();\n    Sheet sheet = workbook.createSheet();\n    Row row = sheet.createRow(0);\n    Cell cell = row.createCell(0);\n    RichTextString text = workbook.getCreationHelper().createRichTextString(\"plain bold italic plain\");\n    Font font = workbook.createFont();\n    font.setBoldweight(Font.BOLDWEIGHT_BOLD);\n    text.applyFont(6, 10, font);\n    font = workbook.createFont();\n    font.setItalic(true);\n    text.applyFont(11, 17, font);\n    cell.setCellValue(text);\n    workbook.write(new FileOutputStream(\"RichText.xlsx\"));\n  }\n}", "id": 141646, "time": "2010-11-11T17:53:43Z", "bug_id": 50258, "creation_time": "2010-11-11T17:53:43Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 50258, "text": "Could you please create the same document using excel? We can then compare the XML generated by POI, and the XML generated by excel, and hopefully spot what POI is doing wrong in your case.", "id": 141653, "time": "2010-11-12T06:02:28Z", "creator": "apache@gagravarr.org", "creation_time": "2010-11-12T06:02:28Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "bugzilla@jabogo.de", "attachment_id": 26291, "id": 141673, "time": "2010-11-12T11:50:01Z", "bug_id": 50258, "creation_time": "2010-11-12T11:50:01Z", "is_private": false, "text": "Created attachment 26291\nCorrupted file (generated by POI)"}, {"count": 3, "tags": [], "creator": "bugzilla@jabogo.de", "attachment_id": 26292, "id": 141674, "time": "2010-11-12T11:51:01Z", "bug_id": 50258, "creation_time": "2010-11-12T11:51:01Z", "is_private": false, "text": "Created attachment 26292\nValid file (generated by Excel 2010)"}, {"count": 4, "tags": [], "bug_id": 50258, "is_private": false, "text": "(In reply to comment #1)\n> Could you please create the same document using excel? We can then compare the\n> XML generated by POI, and the XML generated by excel, and hopefully spot what\n> POI is doing wrong in your case.\n\nThe two new attachments describe the test case. Hope this helps.", "id": 141675, "time": "2010-11-12T11:52:39Z", "creator": "bugzilla@jabogo.de", "creation_time": "2010-11-12T11:52:39Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "yegor@dinom.ru", "text": "Fixed in r1036599\n\nYegor", "id": 141802, "time": "2010-11-18T15:08:52Z", "bug_id": 50258, "creation_time": "2010-11-18T15:08:52Z", "is_private": false, "attachment_id": null}]