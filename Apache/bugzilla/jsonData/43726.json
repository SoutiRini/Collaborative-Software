[{"count": 0, "tags": [], "text": "Reproducible: yes\n---\nHow to reproduce: set JAVA_HOME to a 64bit JDK and start the tomcat\n\n---\nDescription:\nThe same tomcat version (5.5.25 from zip archive) runs under Linux when I use a\n64bit JDK, But under Windows it won't start.\nI am not sure if this is a bug or just not meant to run. (I didn't find the\nspecification regarding this issue)\n\n---\nExcerpt from the logs:\n\n[2007-10-29 18:00:14] [info] Procrun (2.0.3.0) started\n[2007-10-29 18:00:14] [info] Service Tomcat5 name Apache Tomcat\n[2007-10-29 18:00:14] [info] Service Tomcat5 installed\n[2007-10-29 18:00:14] [info] Procrun finished.\n[2007-10-29 18:00:14] [info] Procrun (2.0.3.0) started\n[2007-10-29 18:00:14] [info] Updating service...\n[2007-10-29 18:00:15] [info] Service Tomcat5 updated\n[2007-10-29 18:00:15] [info] Update service finished.\n[2007-10-29 18:00:15] [info] Procrun finished.\n[2007-10-29 18:00:15] [info] Procrun (2.0.3.0) started\n[2007-10-29 18:00:15] [info] Updating service...\n[2007-10-29 18:00:15] [info] Service Tomcat5 updated\n[2007-10-29 18:00:15] [info] Update service finished.\n[2007-10-29 18:00:15] [info] Procrun finished.\n[2007-10-29 18:00:26] [info] Procrun (2.0.3.0) started\n[2007-10-29 18:00:26] [info] Running Service...\n[2007-10-29 18:00:26] [info] Starting service...\n[2007-10-29 18:00:26] [174  javajni.c] [error] %1 is not a valid Win32 application.\n[2007-10-29 18:00:26] [986  prunsrv.c] [error] Failed creating java\nC:\\jdk1.5.0_11\\jre\\bin\\server\\jvm.dll\n[2007-10-29 18:00:26] [1260 prunsrv.c] [error] ServiceStart returned 1\n[2007-10-29 18:00:26] [info] Run service finished.\n[2007-10-29 18:00:26] [info] Procrun finished.", "is_private": false, "id": 109903, "creator": "Igor.Ebner.de.Carvalho@gmail.com", "time": "2007-10-29T10:07:02Z", "bug_id": 43726, "creation_time": "2007-10-29T10:07:02Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 109910, "time": "2007-10-29T10:17:16Z", "bug_id": 43726, "creation_time": "2007-10-29T10:17:16Z", "is_private": false, "text": "Running in 64-bit windows you need the 64-bit version of the service wrapper.\nYou  can get these from svn. I don't think they are included in the 5.5x distro\n\nhttps://svn.apache.org/repos/asf/tomcat/tc6.0.x/trunk/res/procrun/"}, {"count": 2, "tags": [], "bug_id": 43726, "attachment_id": null, "id": 109951, "time": "2007-10-30T07:24:03Z", "creator": "Igor.Ebner.de.Carvalho@gmail.com", "creation_time": "2007-10-30T07:24:03Z", "is_private": false, "text": "Ahh... I see... This is not a part of the tomcat itself but just the c part for\nthe windows services.\n\nI renamed the 64bit service wrapper to tomcat5(w).exe and it works fine for me.\nThanks a lot!\n"}, {"count": 3, "tags": [], "creator": "jeremym@nortel.com", "attachment_id": null, "text": "(In reply to comment #1)\n> Running in 64-bit windows you need the 64-bit version of the service wrapper.\n> You  can get these from svn. I don't think they are included in the 5.5x distro\n> \n> https://svn.apache.org/repos/asf/tomcat/tc6.0.x/trunk/res/procrun/\n\nRevisiting this issue... my scenario is slightly different. I have a 6.0.16 distribution. I went to the link you gave, went to the amd64 folder (I have Intel chip which I hear should be ok), downloaded, and replaced the tomcat6.exe and tomcat6w.exe. I do \"service.bat install\", but when I start the service in Services, it fails, and I get the following in jakarta_service log:\n\n[2008-06-19 14:34:17] [info] Procrun (2.0.4.0) started\n[2008-06-19 14:34:17] [info] Service Tomcat6 name Apache Tomcat\n[2008-06-19 14:34:17] [info] Service Tomcat6 installed\n[2008-06-19 14:34:17] [info] Procrun finished.\n[2008-06-19 14:34:17] [info] Procrun (2.0.4.0) started\n[2008-06-19 14:34:17] [info] Updating service...\n[2008-06-19 14:34:17] [info] Service Tomcat6 updated\n[2008-06-19 14:34:17] [info] Update service finished.\n[2008-06-19 14:34:17] [info] Procrun finished.\n[2008-06-19 14:34:17] [info] Procrun (2.0.4.0) started\n[2008-06-19 14:34:17] [info] Updating service...\n[2008-06-19 14:34:17] [info] Service Tomcat6 updated\n[2008-06-19 14:34:17] [info] Update service finished.\n[2008-06-19 14:34:17] [info] Procrun finished.\n[2008-06-19 14:34:59] [info] Procrun (2.0.4.0) started\n[2008-06-19 14:34:59] [info] Running Service...\n[2008-06-19 14:34:59] [info] Starting service...\n[2008-06-19 14:34:59] [174  javajni.c] [error] The specified module could not be found.\n[2008-06-19 14:34:59] [994  prunsrv.c] [error] Failed creating java \n[2008-06-19 14:34:59] [1269 prunsrv.c] [error] ServiceStart returned 1\n[2008-06-19 14:34:59] [info] Run service finished.\n[2008-06-19 14:34:59] [info] Procrun finished.\n\nThis similar to the errors I get when trying to start the distro, but there's the javajni.c error in addition. This is on Windows 2003 Server Standard x64 Edition SP2. ", "id": 117830, "time": "2008-06-19T12:50:28Z", "bug_id": 43726, "creation_time": "2008-06-19T12:50:28Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 43726, "attachment_id": null, "id": 117833, "time": "2008-06-19T13:32:01Z", "creator": "markt@apache.org", "creation_time": "2008-06-19T13:32:01Z", "is_private": false, "text": "I'm closing this as the 64-bit service wrapper works for the OP (comment #2). I'm closing this as invalid as there isn't actually a Tomcat bug here.\n\nThe error in comment #3 is a different one. See bug 41538 for a long explanation (my view is that this is a JVM issue - Sun disagrees) or for the quick fix copy msvcr71.dll from %JAVA_HOME%\\bin to %SYSTEM_ROOT%\\system32 or any other location on the path."}]