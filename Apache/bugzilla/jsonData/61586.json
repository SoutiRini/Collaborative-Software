[{"count": 0, "tags": [], "bug_id": 61586, "text": "Dear POI users\n\nI got a doc document which contains uncommon greek mu and registered symbol and tried to use characterRun.getSymbolChar() method to identify these two symbols.\nI have noticed however, characterRun.getSymbolChar() always returns the same character and such that I could not find a way to notice the different symbols.\n\nI looked at the CharacterRun.java and tried to print out\n_props.getXchSym() and found that this infact prints two different values for the greek mu and regiestered symbol, i.e. '-3987' and '3870'.\n\nI really don't know if I am doing right thing in that I could use\n_props.getXchSym() directly instead of using\ncharacterRun.getSymbolChar() method which returns (char)_props.getXchSym().\n\nTo make it work, I added one method next to\ncharacterRun.getSymbolChar()  in CharacterRun class that returns _props.getXchSym().\nWould you please take a look at this and could see if this could be added into CharacterRun class?\n\nI enclose a word document which contains those two symbols and a snippet for the new method I made to the CharacterRun class for your reference.\n\n\n\n  public int getSymbolCharacterAsitis()\n   {\n     if (isSymbol()) {\n         return _props.getXchSym();\n     } else\n       throw new IllegalStateException(\"Not a symbol CharacterRun\");\n   }\n\n\nMany thanks in advance\nTeresa", "id": 201305, "time": "2017-10-05T12:13:05Z", "creator": "teresa.kim@linguamatics.com", "creation_time": "2017-10-05T12:13:05Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "teresa.kim@linguamatics.com", "text": "Created attachment 35396\ngreek_mu_and_registered_text", "id": 201306, "attachment_id": 35396, "bug_id": 61586, "creation_time": "2017-10-05T12:13:41Z", "time": "2017-10-05T12:13:41Z", "is_private": false}, {"count": 2, "tags": [], "creator": "tallison@mitre.org", "attachment_id": null, "text": "Thank you for opening this and sharing a triggering document.  I'm trying to figure out how we're supposed to map from '-3987' to mu.  Anyone have an idea?", "id": 201310, "time": "2017-10-05T17:02:05Z", "bug_id": 61586, "creation_time": "2017-10-05T17:02:05Z", "is_private": false}, {"count": 3, "tags": [], "creator": "dominik.stadler@gmx.at", "text": "There are some known issues with some unicode characters, they may be solved by using a newer version of XMLBeans, see bug 59268 for details.\n\nCan you please try quickly with the test-version of XMLBeans from http://mvnrepository.com/artifact/com.github.pjfanning/xmlbeans so we know if your problem is fixed by this as well or if it is a different issue.", "id": 201318, "time": "2017-10-06T11:50:37Z", "bug_id": 61586, "creation_time": "2017-10-06T11:50:37Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "tallison@mitre.org", "text": "Thank you, Dominik.  This is in HWPF, not XWPF...no beans.", "id": 201320, "time": "2017-10-06T11:58:05Z", "bug_id": 61586, "creation_time": "2017-10-06T11:58:05Z", "is_private": false, "attachment_id": null}, {"count": 5, "attachment_id": null, "bug_id": 61586, "text": "Ah, sorry, my bad. I did take a closer look now: It works for me if I use getSymbolCharacter(), see the new unit-test that I added via r1811355. \n\nPlease let us know if this still does not work for you for some reason.", "id": 201326, "time": "2017-10-06T17:41:56Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2017-10-06T17:41:56Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "creator": "teresa.kim@linguamatics.com", "attachment_id": null, "text": "(In reply to Dominik Stadler from comment #5)\n> Ah, sorry, my bad. I did take a closer look now: It works for me if I use\n> getSymbolCharacter(), see the new unit-test that I added via r1811355. \n> \n> Please let us know if this still does not work for you for some reason.\n\nThanks Dominik\n\nYou're right that indeed getSymbolCharacter() works, my confusion was that I used System.out.println() method that getSymbolCharacter() prints out the same broken character for both symbols. Sorry for confusion", "id": 201351, "time": "2017-10-09T07:37:29Z", "bug_id": 61586, "creation_time": "2017-10-09T07:37:29Z", "is_private": false}]