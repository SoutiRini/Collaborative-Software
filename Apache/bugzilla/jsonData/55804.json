[{"count": 0, "attachment_id": null, "creator": "sachinkumar_in@yahoo.com", "is_private": false, "id": 171356, "time": "2013-11-20T19:23:11Z", "bug_id": 55804, "creation_time": "2013-11-20T19:23:11Z", "tags": [], "text": "In SpnegoAuthenticator, we check for request.getUserPrincipal() if it returns a prinicpal we do not do a fresh authentication. This happens even when the GSSCredential returned by GenericPrincipal has remainingLife time less than zero. This causes issues in delegating the credential as the credential is not valid any more.\n\nCan we add additional check to reauthenticate when the credental has expired and put GSSCredential in the same session?"}, {"count": 1, "tags": [], "text": "Would it be sufficient for your use case if request.getUserPrincipal() returned null if the GSSCredential had expired?", "attachment_id": null, "id": 171363, "creator": "markt@apache.org", "time": "2013-11-21T00:03:38Z", "bug_id": 55804, "creation_time": "2013-11-21T00:03:38Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 55804, "attachment_id": null, "text": "If request.getUserPrinicpal() returns null, then we go on reauthenticate and repopulates a new GSSCrential. However, when we reauthenticate the session also changes. I believe the session changes because changeSessionIdOnAuthentication is true by default, so the we have to reinitialize session(populate some objects just as in case of fresh login onto session) in our application.  Can we have request.getUserPrinicipal null and then when a session already exists not create a new session.", "id": 171409, "time": "2013-11-23T13:00:10Z", "creator": "sachinkumar_in@yahoo.com", "creation_time": "2013-11-23T13:00:10Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 55804, "text": "When the session ID is changed on authentication that is exactly what happens. The session object remains the same, just the ID changes. There should be no need to populate the session as it remains populated.\n\nIf you need to update some of your session attributes because the ID has changed, you can use an HttpSessionIdListener.\n\nOn this basis, it looks like having request.getUserPrincipal() return null if the GSSCredential has expired will be sufficient.", "id": 171466, "attachment_id": null, "creator": "markt@apache.org", "creation_time": "2013-11-27T17:21:51Z", "time": "2013-11-27T17:21:51Z", "is_private": false}, {"count": 4, "attachment_id": null, "creator": "sachinkumar_in@yahoo.com", "is_private": false, "id": 171500, "time": "2013-11-29T04:00:32Z", "bug_id": 55804, "creation_time": "2013-11-29T04:00:32Z", "tags": [], "text": "Sure thanks Mark. Can we have this fix soon?"}, {"count": 5, "text": "This has been fixed in trunk for 8.0.0-RC6 onwards and 7.0.x for 7.0.48 onwards.", "bug_id": 55804, "attachment_id": null, "id": 171504, "time": "2013-11-29T19:31:17Z", "creator": "markt@apache.org", "creation_time": "2013-11-29T19:31:17Z", "tags": [], "is_private": false}]