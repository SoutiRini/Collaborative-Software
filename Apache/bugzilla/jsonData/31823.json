[{"count": 0, "tags": [], "bug_id": 31823, "attachment_id": null, "is_private": false, "id": 65419, "time": "2004-10-21T08:43:02Z", "creator": "stefan.meier@gmail.com", "creation_time": "2004-10-21T08:43:02Z", "text": "When given the conditional rule\n\nRewriteCond ${REQUEST_URI} !-U\nRewriteRule ^/(.+) http://my.other.server/ [NS]\n\nmod_rewrite should route all failed (=nonexistent) URIs to my.other.server. In\nfact, mod_rewrite only checks for the syntax of the URI, but not for the\nexistence of the physical resource.\n\nPlease check the following patch and apply at your convenience.\n\n--- httpd-2.0/modules/mappers/mod_rewrite.c     12 Oct 2004 11:55:30 -0000 1.262\n+++ httpd-2.0/modules/mappers/mod_rewrite.c     21 Oct 2004 08:29:43 -0000\n@@ -3521,7 +3521,10 @@\n     case CONDPAT_LU_URL:\n         if (*input && subreq_ok(r)) {\n             rsub = ap_sub_req_lookup_uri(input, r, NULL);\n-            if (rsub->status < 400) {\n+            if (rsub->status < 400 &&\n+                /* double-check that file exists since default result is 200 */\n+                apr_stat(&sb, rsub->filename, APR_FINFO_MIN,\n+                         r->pool) == APR_SUCCESS) {\n                 rc = 1;\n             }\n             rewritelog((r, 5, NULL, \"RewriteCond URI (-U) check: \"\n\nThanks,\nStefan"}, {"count": 1, "tags": [], "creator": "nd@perlig.de", "attachment_id": null, "id": 65421, "time": "2004-10-21T09:38:00Z", "bug_id": 31823, "creation_time": "2004-10-21T09:38:00Z", "is_private": false, "text": "-U doesn't check if the handler would return 404 (it can't). It checks if it's\n*callable* (authentication ok etc). That's what's supposed to and what's documented."}]