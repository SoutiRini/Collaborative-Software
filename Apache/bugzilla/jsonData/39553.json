[{"count": 0, "tags": [], "creator": "marco.meyer@intradoemea.com", "attachment_id": null, "id": 89023, "time": "2006-05-11T08:17:50Z", "bug_id": 39553, "creation_time": "2006-05-11T08:17:50Z", "is_private": false, "text": "The RTFHandler crashes with a Nullpointer exception while processing following\nXSL-FO document. The same Code works for PDF very well.\n\n\nStacktrace:\n----------------\njava.lang.NullPointerException\n\tat org.apache.fop.render.rtf.RTFHandler.recurseFONode(RTFHandler.java:1588)\n\tat org.apache.fop.render.rtf.RTFHandler.recurseFONode(RTFHandler.java:1625)\n\tat org.apache.fop.render.rtf.RTFHandler.recurseFONode(RTFHandler.java:1625)\n\tat org.apache.fop.render.rtf.RTFHandler.recurseFONode(RTFHandler.java:1625)\n\tat org.apache.fop.render.rtf.RTFHandler.recurseFONode(RTFHandler.java:1625)\n\tat org.apache.fop.render.rtf.RTFHandler.recurseFONode(RTFHandler.java:1625)\n\tat org.apache.fop.render.rtf.RTFHandler.recurseFONode(RTFHandler.java:1583)\n\tat org.apache.fop.render.rtf.RTFHandler.endPageSequence(RTFHandler.java:233)\n\tat org.apache.fop.fo.pagination.PageSequence.endOfNode(PageSequence.java:147)\n\tat org.apache.fop.fo.FOTreeBuilder$MainFOHandler.endElement(FOTreeBuilder.java:358)\n\tat org.apache.fop.fo.FOTreeBuilder.endElement(FOTreeBuilder.java:193)\n\nCode bit\n-----------------------\n....\nFOUserAgent foUserAgent = fopFactory.newFOUserAgent();           \n            out = new FileOutputStream(pdf);\n            out = new BufferedOutputStream(out);          \n            Fop fop = fopFactory.newFop(MimeConstants.MIME_RTF, foUserAgent,\nout);           \n            TransformerFactory factory = TransformerFactory.newInstance();\n            Transformer transformer = factory.newTransformer();\n            Source src = new StreamSource(fo);\n            Result res = new SAXResult(fop.getDefaultHandler());          \n            transformer.transform(src, res);\n...\n\n\nXSL-FO\n----------\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<fo:root xmlns:fo=\"http://www.w3.org/1999/XSL/Format\"\nxmlns:fox=\"http://xml.apache.org/fop/extensions\">\n<fo:layout-master-set>\n<fo:page-sequence-master master-name=\"chapter-master\">\n<fo:repeatable-page-master-alternatives>\n<fo:conditional-page-master-reference master-reference=\"common-page\"\nodd-or-even=\"odd\" page-position=\"first\"/>\n<fo:conditional-page-master-reference master-reference=\"common-page\"\nodd-or-even=\"even\" page-position=\"first\"/>\n<fo:conditional-page-master-reference master-reference=\"common-page\"\nodd-or-even=\"odd\" page-position=\"rest\"/>\n<fo:conditional-page-master-reference master-reference=\"common-page\"\nodd-or-even=\"even\" page-position=\"rest\"/>\n</fo:repeatable-page-master-alternatives>\n</fo:page-sequence-master>\n<fo:simple-page-master page-width=\"21cm\" page-height=\"29.7cm\" margin-top=\"0cm\"\nmargin-bottom=\"0cm\" margin-left=\"0cm\" margin-right=\"0cm\" master-name=\"cover\">\n<fo:region-body margin-top=\"72pt\"/>\n<fo:region-before extent=\"15cm\"/>\n<fo:region-after extent=\"24pt\"/>\n<fo:region-end extent=\"10cm\"/>\n</fo:simple-page-master>\n<fo:simple-page-master page-width=\"51pc\" page-height=\"66pc\" margin-top=\"3pc\"\nmargin-bottom=\"3pc\" margin-left=\"6pc\" margin-right=\"6pc\" master-name=\"common-page\">\n<fo:region-body margin-top=\"12pt\" margin-bottom=\"36pt\"/>\n<fo:region-before extent=\"12pt\"/>\n<fo:region-after extent=\"24pt\"/>\n</fo:simple-page-master>\n</fo:layout-master-set>\n<fo:bookmark-tree>\n<fo:bookmark internal-destination=\"N20006\">\n<fo:bookmark-title>Total Traffic per Message Type</fo:bookmark-title>\n</fo:bookmark>\n</fo:bookmark-tree>\n<fo:page-sequence master-reference=\"cover\">\n<fo:static-content flow-name=\"xsl-region-before\">\n<fo:block margin-left=\"2cm\" margin-top=\"1cm\" text-align=\"left\">\n<fo:external-graphic content-width=\"70%\"\nsrc=\"file:///E:/workspace/XSL_FOP_Test/reports/topics/img/logo2.png\"/>\n</fo:block>\n</fo:static-content>\n<fo:static-content flow-name=\"xsl-region-after\">\n<fo:block line-height=\"normal\" font-weight=\"bold\" font-size=\"11pt\"\nmargin-top=\"1cm\">               \n            \u00a9 Copyright company</fo:block>\n</fo:static-content>\n<fo:static-content flow-name=\"xsl-region-end\">\n<fo:block text-align=\"left\" margin-left=\"1cm\">\n<fo:external-graphic content-width=\"100%\"\nsrc=\"file:///E:/workspace/XSL_FOP_Test/reports/topics/img/background.png\"/>\n</fo:block>\n</fo:static-content>\n<fo:flow flow-name=\"xsl-region-body\">\n<fo:block font-family=\"Helvetica\" text-align=\"left\">\n<fo:block line-height=\"140%\" font-weight=\"bold\" font-size=\"30pt\"/>\n<fo:block margin-bottom=\"1in\" line-height=\"140%\" font-weight=\"bold\"\nfont-size=\"24pt\"/>\n</fo:block>\n<fo:block padding=\"6pt\" font-family=\"Helvetica\" margin-top=\"10px\">\n<fo:block text-align=\"center\" margin-right=\"10cm\" margin-bottom=\"10px\"\nmargin-top=\"10px\" line-height=\"100%\" font-size=\"16pt\">\n<fo:block>\n<fo:external-graphic content-width=\"40%\"\nsrc=\"file:///E:/workspace/XSL_FOP_Test/reports/topics/img/logo.PNG\"/>\n</fo:block>\n<fo:block font-size=\"18pt\">SMS Inspector</fo:block>\n<fo:block>Report</fo:block>\n</fo:block>\n</fo:block>\n</fo:flow>\n</fo:page-sequence>\n<fo:page-sequence master-reference=\"cover\">\n<fo:flow flow-name=\"xsl-region-body\">\n<fo:block font-size=\"10pt\" text-indent=\"0em\" space-before=\"0.6em\"\nspace-after=\"0.6em\" text-align=\"center\" color=\"purple\"/>\n</fo:flow>\n</fo:page-sequence>\n<fo:page-sequence initial-page-number=\"1\" format=\"i\" master-reference=\"common-page\">\n<fo:static-content flow-name=\"xsl-region-before\">\n<fo:block line-height=\"8pt\" font-size=\"8pt\">Total Traffic per Message\nType</fo:block>\n</fo:static-content>\n<fo:static-content flow-name=\"xsl-region-after\">\n<fo:block font-family=\"Helvetica\" font-weight=\"bold\" font-size=\"10pt\"\ntext-align=\"center\">\n<fo:page-number/>\n</fo:block>\n</fo:static-content>\n<fo:flow flow-name=\"xsl-region-body\">\n<fo:block id=\"page1-1\" font-family=\"Helvetica\" font-size=\"10pt\" line-height=\"12pt\">\n<fo:block font-family=\"Helvetica\" text-align=\"left\">\n<fo:block>\n<fo:leader leader-length=\"2in\" rule-thickness=\"3pt\" leader-pattern=\"rule\"\ncolor=\"black\"/>\n</fo:block>\n<fo:block line-height=\"140%\" font-weight=\"bold\" font-size=\"20pt\">\n              Contents </fo:block>\n</fo:block>\n</fo:block>\n</fo:flow>\n</fo:page-sequence>\n<fo:page-sequence master-reference=\"chapter-master\">\n<fo:static-content flow-name=\"xsl-region-before\">\n<fo:block line-height=\"8pt\" font-size=\"8pt\">Total Traffic per Message\nType</fo:block>\n</fo:static-content>\n<fo:static-content flow-name=\"xsl-region-after\">\n<fo:block font-family=\"Helvetica\" font-weight=\"bold\" font-size=\"10pt\"\ntext-align=\"center\">\n<fo:page-number/>\n</fo:block>\n</fo:static-content>\n<fo:flow flow-name=\"xsl-region-body\">\n<fo:block break-before=\"page\" font-family=\"Helvetica\" font-size=\"10pt\"\ntext-align=\"left\">\n<fo:block>\n<fo:block break-before=\"page\" margin-top=\"0pc\" margin-bottom=\"1.4pc\"\nfont-size=\"16pt\" font-weight=\"bold\" padding-top=\"1.4pc\" id=\"N10011\">\n<fo:block border-right-width=\"0pt\" border-left-width=\"0pt\" line-height=\"100%\"\nborder-top-width=\"3pt\" border-top-color=\"black\">\n<fo:block id=\"N20006\"/>Total Traffic per Message Type</fo:block>\n</fo:block>\n<fo:block start-indent=\"72pt\" font-size=\"10pt\">\n<fo:block>\n<fo:table table-layout=\"fixed\" width=\"100%\" space-before=\"12pt\"\nspace-after=\"10pt\" background-color=\"white\" border-style=\"solid\"\nborder-width=\"1pt\" border-color=\"black\">\n<fo:table-header>\n<fo:table-row>\n<fo:table-cell border-style=\"solid\" border-width=\"1pt\" border-color=\"black\"\nfont-weight=\"bold\" text-align=\"center\" padding=\"2pt\" background-color=\"silver\"\nstart-indent=\"2pt\" column-number=\"1\">\n<fo:block>Report 1</fo:block>\n</fo:table-cell>\n</fo:table-row>\n</fo:table-header>\n<fo:table-body>\n<fo:table-row>\n<fo:table-cell border-style=\"solid\" border-width=\"1pt\" border-color=\"black\"\npadding=\"2pt\" background-color=\"#faf4fa\" start-indent=\"2pt\" column-number=\"1\">\n<fo:block>\n\t\t\t\t\t\t\tTotal Traffic over the report period.\n\t\t\t\t\t\t</fo:block>\n</fo:table-cell>\n</fo:table-row>\n<fo:table-row>\n<fo:table-cell border-style=\"solid\" border-width=\"1pt\" border-color=\"black\"\npadding=\"2pt\" background-color=\"#faf4fa\" start-indent=\"2pt\" column-number=\"1\">\n<fo:block>\n<fo:block font-size=\"10pt\" text-indent=\"0em\" space-before=\"0.6em\"\nspace-after=\"0.6em\">\n<fo:external-graphic\nsrc=\"url(file:///E:\\workspace\\GenericJobScheduler\\log\\img\\0hour_linechart.png)\"\ncontent-width=\"scale-to-fit\" width=\"100%\"/>\n</fo:block>\n</fo:block>\n</fo:table-cell>\n</fo:table-row>\n<fo:table-row>\n<fo:table-cell border-style=\"solid\" border-width=\"1pt\" border-color=\"black\"\npadding=\"2pt\" background-color=\"#faf4fa\" start-indent=\"2pt\" column-number=\"1\">\n<fo:block>\n<fo:block font-size=\"10pt\" text-indent=\"0em\" space-before=\"0em\" space-after=\"0.6em\">\n\t\t\t\t\t\t    Some Text\n\t\t\t\t\t\t\t<fo:block space-before=\"12pt\">\n<fo:table table-layout=\"fixed\" width=\"100%\" space-before=\"10pt\"\nspace-after=\"10pt\" background-color=\"white\" border-style=\"solid\"\nborder-width=\"1pt\" border-color=\"black\">\n<fo:table-column/>\n<fo:table-column/>\n<fo:table-column/>\n<fo:table-column/>\n<fo:table-column/>\n<fo:table-column/>\n<fo:table-body>\n<fo:table-row>\n<fo:table-cell border-style=\"solid\" border-width=\"1pt\" border-color=\"black\"\nfont-weight=\"bold\" text-align=\"center\" padding=\"2pt\" background-color=\"silver\"\nstart-indent=\"2pt\" column-number=\"1\">\n<fo:block font-size=\"10pt\">messageType</fo:block>\n</fo:table-cell>\n<fo:table-cell border-style=\"solid\" border-width=\"1pt\" border-color=\"black\"\nfont-weight=\"bold\" text-align=\"center\" padding=\"2pt\" background-color=\"silver\"\nstart-indent=\"2pt\" column-number=\"2\">\n<fo:block font-size=\"10pt\">year</fo:block>\n</fo:table-cell>\n<fo:table-cell border-style=\"solid\" border-width=\"1pt\" border-color=\"black\"\nfont-weight=\"bold\" text-align=\"center\" padding=\"2pt\" background-color=\"silver\"\nstart-indent=\"2pt\" column-number=\"3\">\n<fo:block font-size=\"10pt\">month</fo:block>\n</fo:table-cell>\n<fo:table-cell border-style=\"solid\" border-width=\"1pt\" border-color=\"black\"\nfont-weight=\"bold\" text-align=\"center\" padding=\"2pt\" background-color=\"silver\"\nstart-indent=\"2pt\" column-number=\"4\">\n<fo:block font-size=\"10pt\">day</fo:block>\n</fo:table-cell>\n<fo:table-cell border-style=\"solid\" border-width=\"1pt\" border-color=\"black\"\nfont-weight=\"bold\" text-align=\"center\" padding=\"2pt\" background-color=\"silver\"\nstart-indent=\"2pt\" column-number=\"5\">\n<fo:block font-size=\"10pt\">hour</fo:block>\n</fo:table-cell>\n<fo:table-cell border-style=\"solid\" border-width=\"1pt\" border-color=\"black\"\nfont-weight=\"bold\" text-align=\"center\" padding=\"2pt\" background-color=\"silver\"\nstart-indent=\"2pt\" column-number=\"6\">\n<fo:block font-size=\"10pt\">sumTotal</fo:block>\n</fo:table-cell>\n</fo:table-row>\n<fo:table-row>\n<fo:table-cell border-style=\"solid\" border-width=\"1pt\" border-color=\"black\"\npadding=\"2pt\" background-color=\"#fafafa\" start-indent=\"2pt\" column-number=\"1\">\n<fo:block font-size=\"9pt\">SRISM</fo:block>\n</fo:table-cell>\n<fo:table-cell border-style=\"solid\" border-width=\"1pt\" border-color=\"black\"\npadding=\"2pt\" background-color=\"#fafafa\" start-indent=\"2pt\" column-number=\"2\">\n<fo:block font-size=\"9pt\">2006</fo:block>\n</fo:table-cell>\n<fo:table-cell border-style=\"solid\" border-width=\"1pt\" border-color=\"black\"\npadding=\"2pt\" background-color=\"#fafafa\" start-indent=\"2pt\" column-number=\"3\">\n<fo:block font-size=\"9pt\">2</fo:block>\n</fo:table-cell>\n<fo:table-cell border-style=\"solid\" border-width=\"1pt\" border-color=\"black\"\npadding=\"2pt\" background-color=\"#fafafa\" start-indent=\"2pt\" column-number=\"4\">\n<fo:block font-size=\"9pt\">24</fo:block>\n</fo:table-cell>\n<fo:table-cell border-style=\"solid\" border-width=\"1pt\" border-color=\"black\"\npadding=\"2pt\" background-color=\"#fafafa\" start-indent=\"2pt\" column-number=\"5\">\n<fo:block font-size=\"9pt\">12</fo:block>\n</fo:table-cell>\n<fo:table-cell border-style=\"solid\" border-width=\"1pt\" border-color=\"black\"\npadding=\"2pt\" background-color=\"#fafafa\" start-indent=\"2pt\" column-number=\"6\">\n<fo:block font-size=\"9pt\">10698</fo:block>\n</fo:table-cell>\n</fo:table-row>\n</fo:table-body>\n</fo:table>\n</fo:block>\n</fo:block>\n</fo:block>\n</fo:table-cell>\n</fo:table-row>\n</fo:table-body>\n</fo:table>\n</fo:block>\n</fo:block>\n</fo:block>\n</fo:block>\n</fo:flow>\n</fo:page-sequence>\n</fo:root>"}, {"count": 1, "tags": [], "creator": "jeremias@apache.org", "text": "The NPE was ugly. I changed the whole thing so you at least get a file. Please\nnote that the RTF output does not support an implicit column setup. Please\nexplicitely define the table-column elements when you want to generate RTF output.\n\nhttp://svn.apache.org/viewvc?rev=407576&view=rev", "id": 89257, "time": "2006-05-18T15:55:52Z", "bug_id": 39553, "creation_time": "2006-05-18T15:55:52Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 39553, "attachment_id": null, "text": "batch transition pre-FOP1.0 resolved+fixed bugs to closed+fixed", "id": 155675, "time": "2012-04-01T06:35:07Z", "creator": "gadams@apache.org", "creation_time": "2012-04-01T06:35:07Z", "is_private": false}]