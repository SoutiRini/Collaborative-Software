[{"count": 0, "tags": [], "creator": "javornik.lists@gmail.com", "text": "Observed behavior:\nWhen a SXSSFWorkbook workbook is created from a template which is \"read-only\" (initiated with PackageAccess.READ mode OPCPackage), then writing that workbook to another file is failing.\n\nExpected behavior:\nSince the SXSSFWorkbook is written to another file - it should be possible to save it even when the template has been open in read only mode.\n\n\nStack trace:\nException in thread \"main\" org.apache.poi.openxml4j.exceptions.InvalidOperationException: Operation not allowed, document open in read only mode!\n        at org.apache.poi.openxml4j.opc.OPCPackage.throwExceptionIfReadOnly(OPCPackage.java:520)\n        at org.apache.poi.openxml4j.opc.OPCPackage.removePart(OPCPackage.java:943)\n        at org.apache.poi.openxml4j.opc.PackagePart.getOutputStream(PackagePart.java:522)\n        at org.apache.poi.xssf.usermodel.XSSFWorkbook.commit(XSSFWorkbook.java:1687)\n        at org.apache.poi.POIXMLDocumentPart.onSave(POIXMLDocumentPart.java:464)\n        at org.apache.poi.POIXMLDocument.write(POIXMLDocument.java:211)\n        at org.apache.poi.xssf.streaming.SXSSFWorkbook.write(SXSSFWorkbook.java:939)\n        at jvdemos.poi.PoiDemo.testPoi(PoiDemo.java:31)\n        at jvdemos.poi.PoiDemo.main(PoiDemo.java:47)\n\nCode:\n 20         OPCPackage pkg = OPCPackage.open(templateFilename, PackageAccess.READ);\n 21         XSSFWorkbook template = new XSSFWorkbook(pkg);\n 22         // pkg.revert();\n 23         // pkg.close();\n 24         // in.close();\n 25\n 26         SXSSFWorkbook workbook = new SXSSFWorkbook(template, 100);\n 28         fillData(workbook);\n 30         FileOutputStream out = new FileOutputStream(\"/tmp/out1.xlsx\");\n 31         workbook.write(out);\n 32         out.close();", "id": 193140, "time": "2016-08-16T21:52:54Z", "bug_id": 60010, "creation_time": "2016-08-16T21:52:54Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 60010, "text": "Can you try with a recent nightly build / build from svn / build from git / wait a few more days and try with POI 3.15 beta 3 when out? Only we've fixed some bugs around this sort of thing since 3.14 final, so it may already be solved", "count": 1, "id": 193141, "time": "2016-08-16T21:55:30Z", "creator": "apache@gagravarr.org", "creation_time": "2016-08-16T21:55:30Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 60010, "attachment_id": null, "text": "I just tried with the nightly build poi-bin-3.15-beta4-20160815.tar.gz - it fails too:\nException in thread \"main\" org.apache.poi.openxml4j.exceptions.InvalidOperationException: Operation not allowed, document open in read only mode!\n\tat org.apache.poi.openxml4j.opc.OPCPackage.throwExceptionIfReadOnly(OPCPackage.java:585)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.removePart(OPCPackage.java:1008)\n\tat org.apache.poi.openxml4j.opc.PackagePart.getOutputStream(PackagePart.java:521)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.commit(XSSFWorkbook.java:1765)\n\tat org.apache.poi.POIXMLDocumentPart.onSave(POIXMLDocumentPart.java:486)\n\tat org.apache.poi.POIXMLDocument.write(POIXMLDocument.java:236)\n\tat org.apache.poi.xssf.streaming.SXSSFWorkbook.write(SXSSFWorkbook.java:941)", "id": 193144, "time": "2016-08-16T22:20:29Z", "creator": "javornik.lists@gmail.com", "creation_time": "2016-08-16T22:20:29Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 60010, "is_private": false, "count": 3, "id": 193665, "time": "2016-09-12T23:12:25Z", "creator": "apache@gagravarr.org", "creation_time": "2016-09-12T23:12:25Z", "text": "Disabled unit test added to TestSXSSFWorkbook in r1760458. Because of the way that SXSSF sits on top of XSSF, it might not be a very quick fix. However, with any luck the changes needed for finishing in-place write support may solve this case too"}]