[{"count": 0, "tags": [], "text": "I get the following error trying to compile a JSP that uses certain JSTL XML \ntags (specifically, x:parse and x:transform work fine, everything else fails):\n\njava.lang.VerifyError: Cannot inherit from final class\n\tjava.lang.ClassLoader.defineClass0(Native Method)\n\tjava.lang.ClassLoader.defineClass(ClassLoader.java:502)\n\tjava.security.SecureClassLoader.defineClass(SecureClassLoader.java:123)\n\torg.apache.catalina.loader.WebappClassLoader.findClassInternal\n(WebappClassLoader.java:1677)\n\torg.apache.catalina.loader.WebappClassLoader.findClass\n(WebappClassLoader.java:900)\n\torg.apache.catalina.loader.WebappClassLoader.loadClass\n(WebappClassLoader.java:1350)\n\torg.apache.catalina.loader.WebappClassLoader.loadClass\n(WebappClassLoader.java:1230)\n\tjava.lang.ClassLoader.loadClassInternal(ClassLoader.java:315)\n\torg.apache.taglibs.standard.tag.common.xml.ExprSupport.doStartTag\n(ExprSupport.java:101)\n\torg.apache.jsp.jsp.test_jsp._jspx_meth_xstuff_out_0(test_jsp.java:137)\n\torg.apache.jsp.jsp.test_jsp._jspService(test_jsp.java:72)\n\torg.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:133)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:856)\n\torg.apache.jasper.servlet.JspServletWrapper.service\n(JspServletWrapper.java:311)\n\torg.apache.jasper.servlet.JspServlet.serviceJspFile\n(JspServlet.java:301)\n\torg.apache.jasper.servlet.JspServlet.service(JspServlet.java:248)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:856)\n\nSome sample JSP that causes the error is below:\n\n<%@ taglib uri=\"http://java.sun.com/jsp/jstl/core\" prefix=\"c\" %>\n<%@ taglib uri=\"http://java.sun.com/jsp/jstl/xml\" prefix=\"x\" %>\n<%@ page isELIgnored=\"false\" %>\n\n<c:import var=\"xmldata\" url=\"file:/C:/hipaa/work/xc/data/csa-complete.xml\" />\n<x:parse var=\"harold\" doc=\"${xmldata}\"/>\n<x:out select=\"$harold/policy/title\"/>\n\nI'm not 100% sure that this is a Jasper problem and not a JSTL bug, but it \nseemed more likely.", "attachment_id": null, "id": 53671, "creator": "andycirillo@yahoo.com", "time": "2004-03-08T18:42:33Z", "bug_id": 27521, "creation_time": "2004-03-08T18:42:33Z", "is_private": false}, {"count": 1, "tags": [], "creator": "kin-man.chung@sun.com", "attachment_id": null, "id": 53673, "time": "2004-03-08T19:47:50Z", "bug_id": 27521, "creation_time": "2004-03-08T19:47:50Z", "is_private": false, "text": "The stack trace shows the exception in class loading, from some tag\n<xstuff:out>.  Clearly not from the the test.  This is likely not a Jasper problem.\n\nPlease debug your own application, find help elsewhere if you can't.  In any\ncase, include the complete test case, in .war."}, {"count": 2, "text": "Created attachment 10709\ntestcase as a war file", "creator": "andycirillo@yahoo.com", "is_private": false, "id": 53674, "time": "2004-03-08T20:25:25Z", "bug_id": 27521, "creation_time": "2004-03-08T20:25:25Z", "tags": [], "attachment_id": 10709}, {"count": 3, "tags": [], "creator": "andycirillo@yahoo.com", "attachment_id": null, "text": "I apologize, I had changed the namespace from 'xstuff' to 'x' between the time \nthat I captured the stack trace and the time I pasted the test code.  You may \ninterpret 'xstuff:' in the output as equivalent to 'x:' in the jsp.  Anyway, I \nput the JSP and an xml file in a WAR, which has been attached.", "id": 53675, "time": "2004-03-08T20:29:26Z", "bug_id": 27521, "creation_time": "2004-03-08T20:29:26Z", "is_private": false}, {"count": 4, "tags": [], "text": "Addtnl Info:\nTomcat 5.0.19\nJDK 1.4.1_02\nappserv-jstl.jar is installed in tomcat's shared\\lib dir.", "attachment_id": null, "id": 53676, "creator": "andycirillo@yahoo.com", "time": "2004-03-08T20:40:17Z", "bug_id": 27521, "creation_time": "2004-03-08T20:40:17Z", "is_private": false}, {"count": 5, "tags": [], "creator": "andycirillo@yahoo.com", "attachment_id": null, "text": "OK, the problem was actually with JSTL and Xalan.  The version of Xalan that \nis bundled in rt.jar with Java 1.4.1_02 defines:\n\npublic final class VariableStack implements Cloneable { /***/ }\n\nwhereas the class XPath with JSTL 1.1 defines the inner class\n\nprotected class JstlVariableContext extends org.apache.xpath.VariableStack \n{ /***/ }\n\nhence the \"Cannot inherit from final class\" error.  The version of Xalan \nshipped with jstl.jar does not have the \"final\" modifier, but because Xalan is \nbundled with Java, you have to drop (the correct version of) Xalan.jar into \n<tomcat_home>/common/endorsed to get it to take.", "id": 53683, "time": "2004-03-08T21:48:28Z", "bug_id": 27521, "creation_time": "2004-03-08T21:48:28Z", "is_private": false}]