[{"count": 0, "attachment_id": 26026, "bug_id": 49931, "is_private": false, "id": 139874, "time": "2010-09-14T17:26:47Z", "creator": "willpower1024@gmail.com", "creation_time": "2010-09-14T17:26:47Z", "tags": [], "text": "Created attachment 26026\nExcel file to reproduce issue\n\nI'm using POI 3.7 beta 2\n\nWhen opening the attached Excel file with the following simple code:\n\nInputStream is = file.openInputStream();\ntry {\n    Workbook wb = WorkbookFactory.create(is);\n} catch (InvalidFormatException e) {\n} finally {\n    is.close();\n}\n\nthe following stack trace is thrown:\n\njava.lang.IllegalStateException\nat java.util.AbstractList$Itr.remove(AbstractList.java:356)\nat org.apache.poi.hssf.record.aggregates.PageSettingsBlock$1.visitRecord(PageSettingsBlock.java:666)\nat org.apache.poi.hssf.record.aggregates.CustomViewSettingsRecordAggregate.visitContainedRecords(CustomViewSettingsRecordAggregate.java:71)\nat org.apache.poi.hssf.record.aggregates.PageSettingsBlock.positionRecords(PageSettingsBlock.java:659)\nat org.apache.poi.hssf.model.InternalSheet.<init>(InternalSheet.java:230)\nat org.apache.poi.hssf.model.InternalSheet.createSheet(InternalSheet.java:162)\nat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:273)\nat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:187)\nat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:304)\nat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:285)\nat org.apache.poi.ss.usermodel.WorkbookFactory.create(WorkbookFactory.java:60)\n\n\nI cannot share the contents of the Excel file and so I removed it.  It is still reproducing though.\n\nThis Excel file can be opened up fine using POI 3.6 libraries"}, {"count": 1, "attachment_id": null, "bug_id": 49931, "text": "My mistake, this was a regression in 3.6.  It worked with 3.5 final", "id": 139875, "time": "2010-09-14T18:00:23Z", "creator": "willpower1024@gmail.com", "creation_time": "2010-09-14T18:00:23Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "is_private": false, "id": 139985, "time": "2010-09-20T12:01:44Z", "bug_id": 49931, "creation_time": "2010-09-20T12:01:44Z", "text": "Since 3.5 we now do more processing of page settings\n\nIt seems that in some situations though, when processing multiple page settings blocks on one sheet, we hit some sort of concurrency issues when re-ordering the records. Fixed in r998967, along with a unit test that shows we can read the file without errors."}]