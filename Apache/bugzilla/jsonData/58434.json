[{"count": 0, "tags": [], "bug_id": 58434, "attachment_id": null, "is_private": false, "id": 185375, "time": "2015-09-21T06:32:35Z", "creator": "antonio.malcolm@gmail.com", "creation_time": "2015-09-21T06:32:35Z", "text": "Building the tomcat-native library from source on a Linux distro with LibreSSL results in the following error during make:\n\nsrc/ssl.c: In function 'Java_org_apache_tomcat_jni_SSL_initialize':\nsrc/ssl.c:692:37: error: 'ENGINE_CTRL_CHIL_SET_FORKCHECK' undeclared (first use in this function)\n                     ENGINE_ctrl(ee, ENGINE_CTRL_CHIL_SET_FORKCHECK, 1, 0, 0);\n                                     ^\nsrc/ssl.c:692:37: note: each undeclared identifier is reported only once for each function it appears in\n/usr/local/server/src/tomcat-native-1.1.33-src/jni/native/build/rules.mk:206: recipe for target 'src/ssl.lo' failed\n\nSuggested fix: Check for LibreSSL, which doesn't have macro ENGINE_CTRL_CHIL_SET_FORKCHECK (or the chil engine, from researching the issue)\n\nIf it helps, this same issue was found with building Apache HTTPD and resolved:\nhttps://bz.apache.org/bugzilla/show_bug.cgi?id=57375\n\nThe committed fix can be found here:\nhttps://svn.apache.org/viewvc?view=revision&revision=1673900"}, {"text": "For the record, I don't think LibreSSL is currently supported.\n\nThat said, I for one think LibreSSL should *definitely* be supported.\n\nCan you give us some details about the build environment? Specifically, what version of LibreSSL?", "tags": [], "creator": "chris@christopherschultz.net", "attachment_id": null, "count": 1, "id": 185404, "time": "2015-09-21T23:57:54Z", "bug_id": 58434, "creation_time": "2015-09-21T23:57:54Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 58434, "attachment_id": null, "id": 185405, "creation_time": "2015-09-21T23:59:43Z", "time": "2015-09-21T23:59:43Z", "creator": "chris@christopherschultz.net", "text": "This looks like an easy enough bug to fix. I'd like to know what we're losing by not setting that particular check. Does anyone know off the top of their head what that flag does?\n\nIf not, I'll research it.", "is_private": false}, {"count": 3, "tags": [], "creator": "antonio.malcolm@gmail.com", "text": "Thanks for looking into this, Christopher.\n\nI'm building this on Void GNU/Linux x86_64, with LibreSSL version 2.2.3\nI'm building this against APR version 1.5.2 (which built without issue and works as expected with HTTPD).\n\nHere are my configure options for tomcat-native:\n\n./configure --prefix=/usr/local/server/lib/tomcat-native/v1.1.33 \\\n--sysconfdir=/etc/local/server/lib/tomcat-native/v1.1.33 \\\n--localstatedir=/var/local/server/lib/tomcat-native/v1.1.33/state/local \\\n--sharedstatedir=/var/local/server/lib/tomcat-native/v1.1.33/state/shared \\\n--with-apr=/usr/local/server/lib/apr/v1.5.2 \\\n--with-java-home=$JAVA_HOME \\\n--with-ssl=/usr\n\nI also tried --with-ssl=/usr/include, but the end result was the same (not that I thought it would make a difference- Apache products have been historically quite good at finding dependencies).\n\nThanks again!", "id": 185406, "time": "2015-09-22T00:16:13Z", "bug_id": 58434, "creation_time": "2015-09-22T00:16:13Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 58434, "attachment_id": null, "is_private": false, "id": 191588, "time": "2016-06-12T19:13:28Z", "creator": "antonio.malcolm@gmail.com", "creation_time": "2016-06-12T19:13:28Z", "text": "Hi,\nIs there any update to this issue?"}, {"count": 5, "tags": [], "bug_id": 58434, "attachment_id": null, "text": "Keep in mind that Tomcat Native requires OpenSSL 1.0.2 but LibreSSL has not fully implemented the 1.0.2 API.\n\nThe most obvious missing feature is that Java keystores cannot be used.", "id": 200426, "time": "2017-08-23T17:40:08Z", "creator": "markt@apache.org", "creation_time": "2017-08-23T17:40:08Z", "is_private": false}]