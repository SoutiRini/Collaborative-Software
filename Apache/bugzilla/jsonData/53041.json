[{"count": 0, "tags": [], "bug_id": 53041, "attachment_id": 28548, "text": "Created attachment 28548\nOutput of \"ant -version\", \"java -version\", \"ant -diagnostics\"\n\nEnvironment specs attached as one file, test code in another.\n\nWith 2 <sshexec> under <parallel> I was able to get one of them to produce an incorrect task label in the logs -- it looks like one of the <sshexec> is impersonating another.\n\nWith a minimum of 3 I was able to get one of them to abandon the impersonation ruse entirely and simply claim it was \"[parallel]\".  The test script includes up to 10 in parallel.  For extra comedy (tragedy?), turn the test script up to 10 and: \n\n$ ant -f sshexec-parallel-taskname.xml | sort\n\nIn the automation that we use, of which the test code is a microcosm, we rely upon correct task labels to be able to distinguish output from multiple sources.  If one is correct, the second looks like the first, and the third and successive all look like \"[parallel]\" then our logs are significantly less useful.\n\nIn our current version of the automation we use <exec> which calls a Perl program to set up environment variables and run ssh.  <exec> under <parallel> seems to behave properly in this respect.\n\nI have theories but as I don't know the code I can't really prove them.  I'll include them as food for thought:\n\n* <sshexec> isn't thread-safe with regards to the task label\n* JSch version 0.1.46 has thread safety problems\n\nAbout the attached file containing environment specs: Ant 1.8.3 from the canonical binary distribution, unpacked into /usr/local/apache-ant-1.8.3.  JSch version 0.1.46 in ${user.home}/.ant/lib.\n\nI don't know if this is a duplicate of #51845 but I will let those who know better make that determination.  I also don't know if it is a bug in Ant, the optional tasks, or JSch.  I do know that the behavior", "id": 157221, "time": "2012-04-05T17:30:45Z", "creator": "tmonroe@openlane.com", "creation_time": "2012-04-05T17:30:45Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 53041, "attachment_id": 28549, "text": "Created attachment 28549\nLog file with 2 <sshexec> under <parallel>", "id": 157222, "time": "2012-04-05T17:31:40Z", "creator": "tmonroe@openlane.com", "creation_time": "2012-04-05T17:31:40Z", "is_private": false}, {"count": 2, "tags": [], "creator": "tmonroe@openlane.com", "text": "Created attachment 28550\nLog file with 3 <sshexec> under <parallel>", "id": 157223, "time": "2012-04-05T17:32:11Z", "bug_id": 53041, "creation_time": "2012-04-05T17:32:11Z", "is_private": false, "attachment_id": 28550}, {"count": 3, "tags": [], "bug_id": 53041, "attachment_id": 28551, "text": "Created attachment 28551\nTest script which generated log files and demonstrates bug", "id": 157224, "time": "2012-04-05T17:32:44Z", "creator": "tmonroe@openlane.com", "creation_time": "2012-04-05T17:32:44Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 53041, "attachment_id": null, "text": "Finishing an unfinished thought...\n\n(In reply to comment #0)\n>   I do know that the behavior\n\n...is correct with regards to getting useful work done, but very undesirable in terms of figuring out what may have gone wrong from the log files.", "id": 157225, "time": "2012-04-05T17:38:44Z", "creator": "tmonroe@openlane.com", "creation_time": "2012-04-05T17:38:44Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 53041, "attachment_id": null, "text": "I tried a similar script with Parallel Ant (http://blog.codeaholics.org/parallel-ant/), letting ant execute targets based on the dependency graph, and the task name clobbering still occurs.  So <parallel> is no longer a suspect.", "id": 162496, "time": "2012-10-02T01:36:40Z", "creator": "tmonroe@openlane.com", "creation_time": "2012-10-02T01:36:40Z", "is_private": false}]