[{"count": 0, "attachment_id": null, "bug_id": 44456, "is_private": false, "id": 113921, "time": "2008-02-20T10:03:12Z", "creator": "giuseppe_piccoli@au-sdc.com", "creation_time": "2008-02-20T10:03:12Z", "tags": [], "text": "I need to view an .xsl file using apache poi libraries. \nMy .xsl files contain an empty row into the table \n\ne.g. (extract from the table)\n\n\na\ta\ta\na\ta\ta\na\ta\ta\n\t\t     <---- Empty row\na\ta\ta\na\ta\ta\na\ta\ta\n\n\nBut when I try to excecute the main method in the SViewerPanel.java with \nargumet the .xsl file, the application throw \nthe following Exception :\n\n\nException in thread \"main\" java.lang.NullPointerException\n\tat \norg.apache.poi.hssf.contrib.view.SVRowHeader$RowHeaderRenderer.getListCellRender\nerComponent(SVRowHeader.java:77)\n\tat javax.swing.plaf.basic.BasicListUI.updateLayoutState\n(BasicListUI.java:1148)\n\tat javax.swing.plaf.basic.BasicListUI.maybeUpdateLayoutState\n(BasicListUI.java:1098)\n\tat javax.swing.plaf.basic.BasicListUI.getPreferredSize\n(BasicListUI.java:281)\n\tat javax.swing.JComponent.getPreferredSize(JComponent.java:1275)\n\tat javax.swing.JList.getPreferredScrollableViewportSize(JList.java:1913)\n\tat javax.swing.ViewportLayout.preferredLayoutSize\n(ViewportLayout.java:72)\n\tat java.awt.Container.preferredSize(Container.java:1178)\n\tat java.awt.Container.getPreferredSize(Container.java:1162)\n\tat javax.swing.JComponent.getPreferredSize(JComponent.java:1277)\n\tat javax.swing.ScrollPaneLayout.layoutContainer\n(ScrollPaneLayout.java:717)\n\tat java.awt.Container.layout(Container.java:1020)\n\tat java.awt.Container.doLayout(Container.java:1010)\n\tat java.awt.Container.validateTree(Container.java:1092)\n\tat java.awt.Container.validateTree(Container.java:1099)\n\tat java.awt.Container.validateTree(Container.java:1099)\n\tat java.awt.Container.validateTree(Container.java:1099)\n\tat java.awt.Container.validateTree(Container.java:1099)\n\tat java.awt.Container.validateTree(Container.java:1099)\n\tat java.awt.Container.validateTree(Container.java:1099)\n\tat java.awt.Container.validate(Container.java:1067)\n\tat java.awt.Window.show(Window.java:461)\n\tat java.awt.Component.show(Component.java:1133)\n\tat java.awt.Component.setVisible(Component.java:1088)\n\tat org.apache.poi.hssf.contrib.view.SViewerPanel.main\n(SViewerPanel.java:287)\n\nMay you help me?"}, {"count": 1, "tags": [], "creator": "josh@apache.org", "attachment_id": null, "is_private": false, "id": 113926, "time": "2008-02-20T11:54:20Z", "bug_id": 44456, "creation_time": "2008-02-20T11:54:20Z", "text": "HSSFSheet.getRow(int) may return null if the row is missing.  This call \nappears to be on line 76 in the latest version.  I can't find a good \nexplanation for why your stacktrace says line 77.  If the NPE is really coming \nfrom 'd.height' (on line 77), then please ignore this posting.\n\nThis is the current code:\n      Dimension d = getPreferredSize();\n      int rowHeight = (int)sheet.getRow(index).getHeightInPoints();\n      d.height = rowHeight+extraHeight;\n\nI would propose this fix:\n      Dimension d = getPreferredSize();\n      HSSFRow row = sheet.getRow(index);\n      int rowHeight;\n      if(row == null) {\n    \t  rowHeight = (int)sheet.getDefaultRowHeightInPoints();\n      } else {\n    \t  rowHeight = (int)row.getHeightInPoints();\n      }\n      d.height = rowHeight+extraHeight;\n"}, {"count": 2, "tags": [], "bug_id": 44456, "attachment_id": 21571, "id": 113927, "time": "2008-02-20T11:56:15Z", "creator": "josh@apache.org", "creation_time": "2008-02-20T11:56:15Z", "is_private": false, "text": "Created attachment 21571\nsvn diff of one changed file"}, {"attachment_id": null, "tags": [], "creator": "giuseppe_piccoli@au-sdc.com", "is_private": false, "count": 3, "id": 113943, "time": "2008-02-20T23:23:43Z", "bug_id": 44456, "creation_time": "2008-02-20T23:23:43Z", "text": "(In reply to comment #1)\n> HSSFSheet.getRow(int) may return null if the row is missing.  This call \n> appears to be on line 76 in the latest version.  I can't find a good \n> explanation for why your stacktrace says line 77.  If the NPE is really \ncoming \n> from 'd.height' (on line 77), then please ignore this posting.\n> This is the current code:\n>       Dimension d = getPreferredSize();\n>       int rowHeight = (int)sheet.getRow(index).getHeightInPoints();\n>       d.height = rowHeight+extraHeight;\n> I would propose this fix:\n>       Dimension d = getPreferredSize();\n>       HSSFRow row = sheet.getRow(index);\n>       int rowHeight;\n>       if(row == null) {\n>     \t  rowHeight = (int)sheet.getDefaultRowHeightInPoints();\n>       } else {\n>     \t  rowHeight = (int)row.getHeightInPoints();\n>       }\n>       d.height = rowHeight+extraHeight;\n\nYes the correct row is 76, in my cut & paste I have attached the wrong \nStackTrace. Now I rewrite the correct StackTrace:\n\n\nException in thread \"main\" java.lang.NullPointerException\n\tat \norg.apache.poi.hssf.contrib.view.SVRowHeader$RowHeaderRenderer.getListCellRender\nerComponent(SVRowHeader.java:76)\n\tat javax.swing.plaf.basic.BasicListUI.updateLayoutState\n(BasicListUI.java:1148)\n\tat javax.swing.plaf.basic.BasicListUI.maybeUpdateLayoutState\n(BasicListUI.java:1098)\n\tat javax.swing.plaf.basic.BasicListUI.getPreferredSize\n(BasicListUI.java:281)\n\tat javax.swing.JComponent.getPreferredSize(JComponent.java:1275)\n\tat javax.swing.JList.getPreferredScrollableViewportSize(JList.java:1913)\n\tat javax.swing.ViewportLayout.preferredLayoutSize\n(ViewportLayout.java:72)\n\tat java.awt.Container.preferredSize(Container.java:1178)\n\tat java.awt.Container.getPreferredSize(Container.java:1162)\n\tat javax.swing.JComponent.getPreferredSize(JComponent.java:1277)\n\tat javax.swing.ScrollPaneLayout.layoutContainer\n(ScrollPaneLayout.java:717)\n\tat java.awt.Container.layout(Container.java:1020)\n\tat java.awt.Container.doLayout(Container.java:1010)\n\tat java.awt.Container.validateTree(Container.java:1092)\n\tat java.awt.Container.validateTree(Container.java:1099)\n\tat java.awt.Container.validateTree(Container.java:1099)\n\tat java.awt.Container.validateTree(Container.java:1099)\n\tat java.awt.Container.validateTree(Container.java:1099)\n\tat java.awt.Container.validateTree(Container.java:1099)\n\tat java.awt.Container.validateTree(Container.java:1099)\n\tat java.awt.Container.validate(Container.java:1067)\n\tat java.awt.Window.show(Window.java:461)\n\tat java.awt.Component.show(Component.java:1133)\n\tat java.awt.Component.setVisible(Component.java:1088)\n\tat org.apache.poi.hssf.contrib.view.SViewerPanel.main\n(SViewerPanel.java:287)\n"}, {"count": 4, "attachment_id": 21572, "bug_id": 44456, "is_private": false, "id": 113945, "time": "2008-02-21T00:36:41Z", "creator": "giuseppe_piccoli@au-sdc.com", "creation_time": "2008-02-21T00:36:41Z", "tags": [], "text": "Created attachment 21572\nsreenshot of the new problem.\n\nI have made changes described in your attachment (id=21571). Now the table is\ncorrectly displayed, but there's still a little bug: the last row doesn't have\na corresponding row number in the left enumeration column. I attach you a\nscreenshot of the problem. \nI have some questions, due to I'm a beginnes in submit an issue into a Bugzilla\nsystem: \n1) which version of libraries will have changes, when the issue will be\nresolved?\n2) what are the formal step that I do to completed this issue?\n\nThank you in advance."}, {"count": 5, "tags": [], "text": "3) In which version of the library the fix will be delivered? \nCan I include the fixed source code into my distribution, in respect with \nApache License?", "attachment_id": null, "bug_id": 44456, "id": 113946, "time": "2008-02-21T00:41:06Z", "creator": "giuseppe_piccoli@au-sdc.com", "creation_time": "2008-02-21T00:41:06Z", "is_private": false}, {"count": 6, "text": "Thanks for the patch Josh, looks just the job. Applied in svn.\n\nI've also fixed the missing row numbers problem, which was caused by calling\ngetPhysicalNumberOfRows when we meant to call getLastRowNumber. Now works fine\nwith the version in svn.\n\nGiuseppe - fixes are ASL licensed, so you're welcome to use them under the same\nterms as the rest of poi. They're in svn now, will be in tonight's nightly\nbuild, and will be included in the next release", "bug_id": 44456, "attachment_id": null, "id": 113952, "time": "2008-02-21T02:51:33Z", "creator": "apache@gagravarr.org", "creation_time": "2008-02-21T02:51:33Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "bug_id": 44456, "attachment_id": null, "id": 114017, "time": "2008-02-22T06:08:15Z", "creator": "giuseppe_piccoli@au-sdc.com", "creation_time": "2008-02-22T06:08:15Z", "is_private": false, "text": "I've tried to perform changes from getPhysicalNumberOfRows to getLastRowNum() \n(getLastRowNumber) in SViewerPanel.java and SVRowHeader.java classes, but the \nbug is still present. I have also noted that the table row was eliminated into \nthe .xls file."}, {"count": 8, "tags": [], "creator": "apache@gagravarr.org", "is_private": false, "text": "Please try with a svn checkout from trunk. \n\nIf the problem remains, please attach a problem excel file so we can test\nagainst that - all my sample files now work just fine.", "id": 114018, "time": "2008-02-22T06:11:11Z", "bug_id": 44456, "creation_time": "2008-02-22T06:11:11Z", "attachment_id": null}]