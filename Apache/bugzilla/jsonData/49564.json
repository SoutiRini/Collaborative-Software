[{"count": 0, "tags": [], "bug_id": 49564, "is_private": false, "text": "Created attachment 25722\nupload xlsx file for test\n\n@Test\n    public void testGetLockedFromXlsx(){\n\tXSSFWorkbook wb;\n\tXSSFSheet sheet;\n\tFileInputStream finput=null;\n\tFile file;\n\tString xlsSourceFile = \"c:\\\\testgetcellstyle.xlsx\";\n\tfile = new File(xlsSourceFile);\n\ttry {\n\t    finput = new FileInputStream(file);\n\t    wb = new XSSFWorkbook(finput);\n\t    sheet = wb.getSheetAt(0);\n\t    XSSFRow row = sheet.getRow(0);\n\t    XSSFCell cell = row.getCell(25);\n\t    XSSFCellStyle cellStyle = cell.getCellStyle();\n\t    assertTrue(cellStyle.getLocked());//CellStyle.getLocked() should will return true,But really return false\n\t} catch (FileNotFoundException e) {\n\t    e.printStackTrace();\n\t} catch (IOException e) {\n\t    e.printStackTrace();\n\t}finally{\n\t    try {\n\t\tfinput.close();\n\t    } catch (IOException e) {\n\t\te.printStackTrace();\n\t    }\n\t}\t\t\n    }", "id": 138231, "time": "2010-07-06T20:59:35Z", "creator": "longxibo@sina.com", "creation_time": "2010-07-06T20:59:35Z", "attachment_id": 25722}, {"count": 1, "attachment_id": 25723, "creator": "longxibo@sina.com", "text": "Created attachment 25723\nScreenshot for the cell property", "id": 138232, "time": "2010-07-06T21:05:05Z", "bug_id": 49564, "creation_time": "2010-07-06T21:05:05Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 49564, "attachment_id": null, "id": 138253, "time": "2010-07-07T09:47:00Z", "creator": "apache@gagravarr.org", "creation_time": "2010-07-07T09:47:00Z", "is_private": false, "text": "I'd suggest that you unzip the file (.xlsx is actually a zip file of xml files), and start poking around to see where the locked property is actually set. Maybe it's not in the usual place?"}, {"attachment_id": null, "tags": [], "creator": "longxibo@sina.com", "text": "(In reply to comment #2)\n> I'd suggest that you unzip the file (.xlsx is actually a zip file of xml\n> files), and start poking around to see where the locked property is actually\n> set. Maybe it's not in the usual place?\n\nWhere is locked property in xml file? I can't found locked property in any xml file.This property name is 'locked' or 'lock'?", "count": 3, "id": 138297, "time": "2010-07-09T04:54:26Z", "bug_id": 49564, "creation_time": "2010-07-09T04:54:26Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "apache@gagravarr.org", "text": "It could be in the cell styles file, or maybe in the sheet. I'd suggest you create two files, both with one cell, one locked and one not. Diff those to find out!", "count": 4, "id": 138298, "time": "2010-07-09T05:04:50Z", "bug_id": 49564, "creation_time": "2010-07-09T05:04:50Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 49564, "is_private": false, "text": "(In reply to comment #4)\n> It could be in the cell styles file, or maybe in the sheet. I'd suggest you\n> create two files, both with one cell, one locked and one not. Diff those to\n> find out!\n\nI change locked property and save file.Unzip two xlsx to diff directory.Compare two directory.I found style.xml have little diff. New style.xml add \"<protection locked=\"0\"/>\" String,But old style.xml not \"locked\" property at all!It is Strange! I upload two file to investigation for you.", "id": 138413, "time": "2010-07-14T03:57:00Z", "creator": "longxibo@sina.com", "creation_time": "2010-07-14T03:57:00Z", "attachment_id": null}, {"count": 6, "tags": [], "text": "Created attachment 25761\nlocked property is true", "attachment_id": 25761, "id": 138414, "creation_time": "2010-07-14T04:01:29Z", "time": "2010-07-14T04:01:29Z", "creator": "longxibo@sina.com", "bug_id": 49564, "is_private": false}, {"count": 7, "tags": [], "text": "Created attachment 25762\nlocked property is false", "attachment_id": 25762, "id": 138415, "creation_time": "2010-07-14T04:03:08Z", "time": "2010-07-14T04:03:08Z", "creator": "longxibo@sina.com", "bug_id": 49564, "is_private": false}, {"attachment_id": null, "tags": [], "creator": "alain.perry@gmail.com", "text": "I'm being bit by this bug as well: getLocked() works perfectly fine with HSSF, but returns false on locked cells with XSSF. It's quite a pity.", "count": 8, "id": 146686, "time": "2011-05-27T16:45:41Z", "bug_id": 49564, "creation_time": "2011-05-27T16:45:41Z", "is_private": false}, {"count": 9, "tags": [], "text": "I'm using poi-3.7-20101029 by the way.", "attachment_id": null, "id": 146687, "creation_time": "2011-05-27T16:46:47Z", "time": "2011-05-27T16:46:47Z", "creator": "alain.perry@gmail.com", "bug_id": 49564, "is_private": false}, {"count": 10, "attachment_id": null, "creator": "yegor@dinom.ru", "is_private": false, "id": 147459, "time": "2011-06-24T13:06:32Z", "bug_id": 49564, "creation_time": "2011-06-24T13:06:32Z", "tags": [], "text": "XSSFCellStyle.getLocked() returned false if the \"locked\" value was not set. The default value is true and I fixed it in  r1139288\n\n\nYegor"}]