[{"count": 0, "tags": [], "bug_id": 54754, "text": "Currently WebSocket endpoints are mapped via Servlet mappings, which does not appear to work if another Servlet is mapped with \"/\" or \"/*\". The root servlet mapping in particular is very commonly preferred over mapping by prefix (e.g. \"/app/*\") or by extension (\"/*.do\") in order to keep URLs meaningful and without any additional path segments or extension (see for example [1]).\n\nReplacing WsServlet with WsFilter would allow WebSocket endpoints to be mapped to specific paths without interfering with Servlet mappings.\n\n[1] http://stackoverflow.com/questions/2129876/using-spring-mapping-to-root-in-web-xml-static-resources-arent-found", "id": 166154, "time": "2013-03-26T13:46:43Z", "creator": "rstoyanchev@yahoo.com", "creation_time": "2013-03-26T13:46:43Z", "is_private": false, "attachment_id": null}, {"text": "What URIs are you mapping your web socket servlets to?", "tags": [], "creator": "markt@apache.org", "is_private": false, "count": 1, "id": 166158, "time": "2013-03-26T14:24:56Z", "bug_id": 54754, "creation_time": "2013-03-26T14:24:56Z", "attachment_id": null}, {"count": 2, "attachment_id": null, "creator": "rstoyanchev@yahoo.com", "is_private": false, "id": 166160, "time": "2013-03-26T14:44:03Z", "bug_id": 54754, "creation_time": "2013-03-26T14:44:03Z", "tags": [], "text": "The easiest way to reproduce is to add \"/\" Servlet to tomcat/trunk/webapps/examples/WEB-INF/web.xml after which websocket echo no longer works."}, {"count": 3, "tags": [], "bug_id": 54754, "attachment_id": null, "text": "Note that Spring MVC can delegate back to the \"default\" Servlet container servlet, if no mapping is found [1]. That said is there any downside to a WsFilter? Seems less obtrusive and FWIW the RI does that.\n\n[1] http://static.springsource.org/spring-framework/docs/current/spring-framework-reference/html/mvc.html#mvc-default-servlet-handler", "id": 166161, "time": "2013-03-26T14:47:55Z", "creator": "rstoyanchev@yahoo.com", "creation_time": "2013-03-26T14:47:55Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 54754, "text": "Hmm. That behavior isn't what I'd expect. Let me take a look to figure out what I am missing.\n\nMy only reluctance to switch to a filter is that it is more work and I have enough of that already. That said, if there are scenarios that simply can't be matched with a Servlet (and I suspect that there are once you start looking at URI templates of the form /{parma1}/... ) then there may be no choice but to switch to Filter.", "id": 166170, "time": "2013-03-26T21:24:05Z", "creator": "markt@apache.org", "creation_time": "2013-03-26T21:24:05Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 54754, "is_private": false, "text": "The only reason the examples fail is that by mapping a servlet to / you are overriding the default servlet that is used to serve the HTML files. If you change the files to have .jsp extensions (and change the links) you'll be able to access the pages. Alternatively, you could point a WebSocket client directly at the appropriate URL.\n\nI'll look into my own concerns regarding mapping and URI templates separately.", "id": 166171, "time": "2013-03-26T21:54:44Z", "creator": "markt@apache.org", "creation_time": "2013-03-26T21:54:44Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 54754, "attachment_id": null, "text": "OK that makes sense. Thanks!", "id": 166175, "time": "2013-03-27T00:51:46Z", "creator": "rstoyanchev@yahoo.com", "creation_time": "2013-03-27T00:51:46Z", "is_private": false}]