[{"count": 0, "attachment_id": null, "creator": "rolandlevy@web.de", "is_private": false, "id": 177971, "time": "2014-09-19T11:58:12Z", "bug_id": 56997, "creation_time": "2014-09-19T11:58:12Z", "tags": [], "text": "Setting the attribute npnHandler=\"org.apache.coyote.spdy.SpdyAprNpnHandler\" in an APR SSL connector fails to start.\n\nIt appears that the 1.1 branch of tcnative doesn't have any of the\nSSLExt.java/sslext.c methods at all: src/sslext.c does not even exist.\n\n\nSep 04, 2014 9:30:02 AM org.apache.catalina.core.AprLifecycleListener init\nINFO: Loaded APR based Apache Tomcat Native library 1.1.31 using APR version 1.3.9.\nSep 04, 2014 9:30:02 AM org.apache.catalina.core.AprLifecycleListener init\nINFO: APR capabilities: IPv6 [true], sendfile [true], accept filters [false], random [true].\n..\nSep 04, 2014 9:30:55 AM org.apache.coyote.AbstractProtocol start\nINFO: Starting ProtocolHandler [\"http-apr-xx.xx.xx.xx-443\"]\njava.lang.UnsatisfiedLinkError: org.apache.tomcat.jni.SSLExt.setNPN(J[BI)I\n        at org.apache.tomcat.jni.SSLExt.setNPN(Native Method)\n        at org.apache.tomcat.jni.SSLExt.setNPN(SSLExt.java:126)\n        at org.apache.coyote.spdy.SpdyAprNpnHandler.init(SpdyAprNpnHandler.java:76)\n        at org.apache.coyote.http11.Http11AprProtocol.start(Http11AprProtocol.java:211)\n        at org.apache.catalina.connector.Connector.startInternal(Connector.java:986)\n        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n        at org.apache.catalina.core.StandardService.startInternal(StandardService.java:458)\n        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n        at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:760)\n        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:625)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:606)\n        at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:351)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:485)\nSep 04, 2014 9:30:55 AM org.apache.coyote.spdy.SpdyAprNpnHandler init\nWARNING: SPDY/NPN not supported\n\nMachine info:\n\nRed Hat Enterprise Linux Server release 6.4 (Santiago)\nLinux xx.com 2.6.32-358.14.1.el6.x86_64 #1 SMP Mon Jun 17 15:54:20 EDT 2013 x86_64 x86_64\nx86_64 GNU/Linux\n\nJava version:\n\njava version \"1.7.0_51\"\nJava(TM) SE Runtime Environment (build 1.7.0_51-b13)\nJava HotSpot(TM) 64-Bit Server VM (build 24.51-b03, mixed mode)\n\n\nserver.xml configuration\n\n<Connector port=\"443\"\n           \t address=\"xx.xx.xx.xx\"\n             npnHandler=\"org.apache.coyote.spdy.SpdyAprNpnHandler\"\n             protocol=\"HTTP/1.1\"\n             SSLEnabled=\"true\"\n             maxThreads=\"150\"\n             scheme=\"https\"\n             secure=\"true\"\n             sslProtocol=\"TLS\"\n             SSLCertificateFile=\"/xx\" \n             SSLCertificateKeyFile=\"/xx\"\n             SSLCACertificateFile=\"/xx\"/>"}, {"count": 1, "attachment_id": null, "creator": "chris@christopherschultz.net", "is_private": false, "id": 177976, "time": "2014-09-19T17:21:24Z", "bug_id": 56997, "creation_time": "2014-09-19T17:21:24Z", "tags": [], "text": "For reference:\nhttp://markmail.org/message/lwf6vlmo3w463d57"}, {"count": 2, "tags": [], "text": "I'm not sure I'd called this a regression, since this code never made it into a release. The lack of synchronization between tcnative and Tomcat's Java code is certainly the issue, here.\n\nObviously not your fault ;)", "attachment_id": null, "id": 177977, "creator": "chris@christopherschultz.net", "time": "2014-09-19T17:22:36Z", "bug_id": 56997, "creation_time": "2014-09-19T17:22:36Z", "is_private": false}, {"count": 3, "tags": [], "text": "The revisions that include native/src/sslext.c are:\n\nr1240585\nr1292127\nr1292337\nr1299312\nr1409080\n\nI'll see what would be involved in back-porting those to the 1.1.x branch.", "attachment_id": null, "id": 177978, "creator": "chris@christopherschultz.net", "time": "2014-09-19T17:26:36Z", "bug_id": 56997, "creation_time": "2014-09-19T17:26:36Z", "is_private": false}, {"count": 4, "text": "Unfortunately, the first revision does not back-port cleanly and I'm not capable of determining what to do; the differences should probably be resolved by someone who knows whats going on in there.", "creator": "chris@christopherschultz.net", "attachment_id": null, "id": 177979, "time": "2014-09-19T17:41:16Z", "bug_id": 56997, "creation_time": "2014-09-19T17:41:16Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "bug_id": 56997, "attachment_id": null, "id": 177980, "time": "2014-09-19T18:23:23Z", "creator": "chris@christopherschultz.net", "creation_time": "2014-09-19T18:23:23Z", "is_private": false, "text": "http://markmail.org/thread/ljdfkerukxrufizc"}, {"count": 6, "attachment_id": null, "creator": "markt@apache.org", "is_private": false, "id": 183012, "time": "2015-05-18T17:46:11Z", "bug_id": 56997, "creation_time": "2015-05-18T17:46:11Z", "tags": [], "text": "SPDY support as implemented is no longer supported by any browser. HTTP/2 development is in progress."}]