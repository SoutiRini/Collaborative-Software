[{"count": 0, "tags": [], "bug_id": 37911, "attachment_id": null, "text": "The logic for deciding if a warning about the certificate CN not matching the\nserver name is incorrect for the case of wilcard certificates. (It incorrectly\ndrops into the normal test for a valid wildcard certificate)\n\nThe fix is:\n\n--- ssl_engine_init.c.sav       2005-12-09 16:36:21.000000000 +0000\n+++ ssl_engine_init.c   2005-12-14 18:23:01.360818339 +0000\n@@ -834,14 +836,16 @@\n     if (SSL_X509_getCN(ptemp, cert, &cn)) {\n         int fnm_flags = FNM_PERIOD|FNM_CASE_BLIND;\n \n-        if (apr_fnmatch_test(cn) &&\n-            (apr_fnmatch(cn, s->server_hostname,\n-                         fnm_flags) == FNM_NOMATCH))\n-        {\n-            ap_log_error(APLOG_MARK, APLOG_WARNING, 0, s,\n+        if (apr_fnmatch_test(cn))\n+               {\n+                       if (apr_fnmatch(cn, s->server_hostname,\n+                         fnm_flags) == FNM_NOMATCH)\n+                       {\n+                               ap_log_error(APLOG_MARK, APLOG_WARNING, 0, s,\n                          \"%s server certificate wildcard CommonName (CN) `%s' \"\n                          \"does NOT match server name!?\",\n                          ssl_asn1_keystr(type), cn);\n+                       }\n         }\n         else if (strNE(s->server_hostname, cn)) {\n             ap_log_error(APLOG_MARK, APLOG_WARNING, 0, s,", "id": 83660, "time": "2005-12-14T19:35:47Z", "creator": "apache@gagravarr.org", "creation_time": "2005-12-14T19:35:47Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 37911, "attachment_id": null, "text": "Thanks for the report and the patch.  This is checked in to the trunk:\n\nhttp://svn.apache.org/viewcvs.cgi?rev=378487&view=rev", "id": 85875, "time": "2006-02-17T12:44:47Z", "creator": "jorton@redhat.com", "creation_time": "2006-02-17T12:44:47Z", "is_private": false}, {"count": 2, "attachment_id": null, "creator": "issues.apache.org@dale.us", "text": "I'm still getting this with the Apache provided 2.0.59 binary build for win32\nwhen using a wildcard certificate.", "id": 104197, "time": "2007-06-08T07:11:12Z", "bug_id": 37911, "creation_time": "2007-06-08T07:11:12Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 37911, "attachment_id": null, "text": "The fix has not been been proposed for backport. If you feel this is\nimportant, try bringing it up on dev@httpd.apache.org", "id": 104257, "time": "2007-06-09T00:01:17Z", "creator": "davi@apache.org", "creation_time": "2007-06-09T00:01:17Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 37911, "attachment_id": null, "text": "Proposed for backport as r571936 (http://svn.apache.org/viewvc?rev=571936&view=rev).", "id": 107606, "time": "2007-09-02T03:00:50Z", "creator": "rpluem@apache.org", "creation_time": "2007-09-02T03:00:50Z", "is_private": false}, {"count": 5, "attachment_id": null, "creator": "rpluem@apache.org", "is_private": false, "id": 107703, "time": "2007-09-04T07:42:38Z", "bug_id": 37911, "creation_time": "2007-09-04T07:42:38Z", "tags": [], "text": "Backported to 2.2.x as r572630 (http://svn.apache.org/viewvc?rev=572630&view=rev)"}, {"count": 6, "tags": [], "bug_id": 37911, "attachment_id": null, "text": "*** Bug 43278 has been marked as a duplicate of this bug. ***", "id": 108349, "time": "2007-09-18T11:24:18Z", "creator": "jorton@redhat.com", "creation_time": "2007-09-18T11:24:18Z", "is_private": false}]