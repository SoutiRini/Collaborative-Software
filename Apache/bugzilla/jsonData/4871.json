[{"count": 0, "tags": [], "bug_id": 4871, "attachment_id": null, "id": 7917, "time": "2001-11-14T09:15:28Z", "creator": "john.giacomoni@colorado.edu", "creation_time": "2001-11-14T09:15:28Z", "is_private": false, "text": "the cvs task is lacking the ability to set the CVS_RSH field which makes it inconvenient to use the cvs task to checkout files from a cvs server with ssh.\n\nI'm including two patch files below, patched against the 1.4.1 distribution.\n\n--- cvs.html    Wed Nov 14 09:17:20 2001\n+++ cvs.html.new        Wed Nov 14 09:19:43 2001\n@@ -31,6 +31,11 @@\n     <td align=\"center\" valign=\"top\">No</td>\n   </tr>\n   <tr>\n+    <td valign=\"top\">cvsRsh</td>\n+    <td valign=\"top\">the CVS_RSH variable.</td>\n+    <td align=\"center\" valign=\"top\">No, default is &quot;rsh&quot;</td>\n+  </tr>\n+  <tr>\n     <td valign=\"top\">dest</td>\n     <td valign=\"top\">the directory where the checked out files should be placed.</td>\n     <td align=\"center\" valign=\"top\">No, default is project's basedir.</td>\n\n\n\n--- Cvs.java    Wed Nov 14 09:01:27 2001\n+++ Cvs.java.new        Wed Nov 14 09:22:01 2001\n@@ -77,6 +77,12 @@\n     private String cvsRoot;\n \n     /**\n+     * the CVS_RSH variable.\n+     */\n+\n+    private String cvsRsh = \"rsh\";\n+\n+    /**\n      * the package/module to check out.\n      */\n     private String pack;\n@@ -172,6 +178,13 @@\n             env.addVariable(var);\n         }\n \n+       {\n+           Environment.Variable var = new Environment.Variable();\n+           var.setKey(\"CVS_RSH\");\n+           var.setValue(cvsRsh);\n+           env.addVariable(var);\n+       }\n+\n         ExecuteStreamHandler streamhandler = null;\n         OutputStream outputstream = null;\n         OutputStream errorstream = null; \n@@ -242,6 +255,19 @@\n \n         this.cvsRoot = root;\n     }\n+\n+    public void setCvsRsh(String path) {\n+        // Check if empty cvsrsh => set it to rsh \n+        if (path != null) { \n+            if (path.trim().equals(\"\")) \n+                path = \"rsh\"; \n+        } else {\n+           path = \"rsh\";\n+       }\n+\n+        this.cvsRsh = path;\n+    }\n+\n \n     public void setPort(int port){\n         this.port = port;"}, {"count": 1, "tags": [], "text": "Hmm - wont this always set CVS_RSH environment variable ? Unfortunately that \nwould break a lot of installations. For instance I currently set CVS_RSH in my \nshell and I expect ant to use that and not overide it and I know that a few \nother people use this functionality.\n\nWould you consider resubmitting a patch that would only set CVS_RSH if it is \nspecified in task?\n", "is_private": false, "id": 7936, "creation_time": "2001-11-15T00:38:39Z", "time": "2001-11-15T00:38:39Z", "creator": "donaldp@apache.org", "bug_id": 4871, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 4871, "is_private": false, "text": "easily done.  here are the new patches.\n\n--- cvs.html.orig       Thu Nov 15 08:26:10 2001\n+++ cvs.html    Thu Nov 15 08:26:47 2001\n@@ -31,6 +31,11 @@\n     <td align=\"center\" valign=\"top\">No</td>\n   </tr>\n   <tr>\n+    <td valign=\"top\">cvsRsh</td>\n+    <td valign=\"top\">the CVS_RSH variable.</td>\n+    <td align=\"center\" valign=\"top\">No</td>\n+  </tr>\n+  <tr>\n     <td valign=\"top\">dest</td>\n     <td valign=\"top\">the directory where the checked out files should be\nplaced.</td>\n     <td align=\"center\" valign=\"top\">No, default is project's basedir.</td>\n\n\n\n\n--- Cvs.java.orig       Thu Nov 15 10:22:50 2001\n+++ Cvs.java    Thu Nov 15 10:22:52 2001\n@@ -77,6 +77,11 @@\n     private String cvsRoot;\n \n     /**\n+     * the CVS_RSH variable.\n+     */\n+    private String cvsRsh = null;\n+\n+    /**\n      * the package/module to check out.\n      */\n     private String pack;\n@@ -172,6 +177,13 @@\n             env.addVariable(var);\n         }\n \n+        if(cvsRsh!=null){\n+            Environment.Variable var = new Environment.Variable();\n+            var.setKey(\"CVS_RSH\");\n+            var.setValue(String.valueOf(cvsRsh));\n+            env.addVariable(var);\n+        }\n+\n         ExecuteStreamHandler streamhandler = null;\n         OutputStream outputstream = null;\n         OutputStream errorstream = null; \n@@ -241,6 +253,16 @@\n         } \n \n         this.cvsRoot = root;\n+    }\n+\n+    public void setCvsRsh(String rsh) {\n+        // Check if not real cvsrsh => set it to null\n+        if (rsh != null) {\n+            if (rsh.trim().equals(\"\"))\n+                rsh = null;\n+        }\n+\n+        this.cvsRsh = rsh;\n     }\n \n     public void setPort(int port){", "id": 7946, "time": "2001-11-15T09:27:22Z", "creator": "john.giacomoni@colorado.edu", "creation_time": "2001-11-15T09:27:22Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "donaldp@apache.org", "attachment_id": null, "id": 8049, "time": "2001-11-19T03:10:41Z", "bug_id": 4871, "creation_time": "2001-11-19T03:10:41Z", "is_private": false, "text": "Patch applied 19th, Nov, 2001. COuld you check out tomorrows nightly build (or \nupdate from CVS) and make sure it all works for you. Thanks!\n"}]