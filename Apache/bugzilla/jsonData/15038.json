[{"attachment_id": null, "tags": [], "bug_id": 15038, "text": "I'm getting the #VALUE! result in a spreadsheet from the following code:\n\nHSSFWorkbook wb = new HSSFWorkbook();\nHSSFSheet sheet = wb.createSheet(\"New Sheet\");\nHSSFRow row = sheet.createRow((short)0);\nHSSFCell cell1 = row.createCell((short)0);\ncell1.setCellValue(1);\nHSSFCell cell2 = row.createCell((short)1);\ncell2.setCellValue(2);\nHSSFCell cell3 = row.createCell((short)2);\ncell3.setCellValue(3);\nSheetReferences sRef = new SheetReferences();\nsRef.addSheetReference(\"First Sheet\", 0);\nHSSFCell cell4 = row.createCell((short)3);\ncell4.setCellType(HSSFCell.CELL_TYPE_FORMULA);\nPtg[] ref = new Ptg[5];\nref[0] = new AreaPtg(\"A1:B1\");\nref[1] = new IntPtg(\"1\");\nref[2] = new FuncVarPtg(\"LARGE\", (byte)2);\nref[3] = new ReferencePtg(\"C1\");\nref[4] = new AddPtg();\ncell4.setCellFormula(FormulaParser.toFormulaString(sRef, ref));\nFileOutputStream fileOut = new FileOutputStream(\"testWorkBook1.xls\");\nwb.write(fileOut);\nfileOut.close();\n\nHave also tried entering this straight into setCellFormula as \"LARGE(A1:B1,1)\n+C1\" returning the same effect.  Is LARGE an unsupported 'array formula' as \nspecified under formula support?", "count": 0, "id": 27369, "time": "2002-12-03T23:15:16Z", "creator": "greggarson@hotmail.com", "creation_time": "2002-12-03T23:15:16Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 15038, "is_private": false, "id": 41303, "attachment_id": null, "creator": "poi-support@buni.org", "creation_time": "2003-07-24T13:59:19Z", "time": "2003-07-24T13:59:19Z", "text": "Thats not how you use formulas."}]