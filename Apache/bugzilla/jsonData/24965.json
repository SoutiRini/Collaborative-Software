[{"count": 0, "tags": [], "bug_id": 24965, "text": "No answer on mailing list, so create the bug.\n\nWith the new 2.4 schema for servlets, there is not anymore a strict order for\nthe top level elements in the web.xml file\n\nSo we can declare a servlet and then its mapping, and then a new servlet with\nits mapping\nSomething like that :\n\n<servlet> ...servletA..</servlet>\n<servlet-mapping>..servletA...</servlet-mapping>\n<servlet> ...servletB..</servlet>\n<servlet-mapping>..servletB...</servlet-mapping>\n\n\nBut the mapping of a servlet can be declared before the declaration of the\nservlet element. (with 2.4 schema)\n\n<servlet-mapping>..servletA...</servlet-mapping>\n<servlet> ...servletA..</servlet>\n\n\n\nThe problem is that this is a valid XML but it fails during the deployment on \nTomcat 5.\nThis is due to the fact that during the XML parsing, when we add a servlet\nmapping, there is a check to see if the servlet exists.\n\nNote that the xml validation is turned on.\n\nThe problem come from the method addServletMapping() in\norg.apache.catalina.core.StandardContext class.\n\n// Validate the proposed mapping\n       if (findChild(name) == null)\n           throw new IllegalArgumentException\n               (sm.getString(\"standardContext.servletMap.name\", name));\n\nMaybe the check has to move to another place.\n\nAt runtime it gives this trace when deploying the war :\n\nContextConfig.applicationConfig : Parse error in application web.xml\njava.lang.IllegalArgumentException: Servlet mapping specifies an unknown servlet\nname Test\n        at\norg.apache.commons.digester.Digester.createSAXException(Digester.java:2540)\n        at\norg.apache.commons.digester.Digester.createSAXException(Digester.java:2566)\n        at org.apache.commons.digester.Digester.endElement(Digester.java:1061)\n        at org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)\n        at org.apache.xerces.impl.xs.XMLSchemaValidator.endElement(Unknown Source)\n        at\norg.apache.xerces.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown Source)\n        at\norg.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown\nSource)\n        at\norg.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)\n        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n        at org.apache.xerces.parsers.DTDConfiguration.parse(Unknown Source)\n        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\n        at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)\n        at org.apache.commons.digester.Digester.parse(Digester.java:1548)\n        at\norg.apache.catalina.startup.ContextConfig.applicationConfig(ContextConfig.java:305)\n        at org.apache.catalina.startup.ContextConfig.start(ContextConfig.java:748)\n        at\norg.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:257)\n        at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.ja", "id": 48071, "time": "2003-11-25T09:02:15Z", "creator": "florent.benoit@objectweb.org", "creation_time": "2003-11-25T09:02:15Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 24965, "attachment_id": null, "text": "Due to the algorithms used to initialize Catalina's mapper, this issue cannot\nand will not be fixed.", "id": 48078, "time": "2003-11-25T10:02:07Z", "creator": "remm@apache.org", "creation_time": "2003-11-25T10:02:07Z", "is_private": false}]