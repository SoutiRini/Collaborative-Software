[{"count": 0, "tags": [], "bug_id": 49111, "text": "Created attachment 25276\nJMS sampler for HornetQ2.0\n\nHere is the Debug message when I got Message with ID:21f54540-46ae-11df-b307-0016ec6d1bb6:8000000000000000 not found.\n\n2010/04/13 11:39:16 DEBUG - jmeter.control.GenericController: Calling next on: org.apache.jmeter.control.LoopController \n2010/04/13 11:39:16 DEBUG - jmeter.testelement.property.AbstractProperty: Running version, executing function \n2010/04/13 11:39:16 DEBUG - jmeter.protocol.jms.sampler.JMSSampler: Adding property [JMSCorrelationID=20100413-1139161] \n2010/04/13 11:39:16 DEBUG - jmeter.protocol.jms.sampler.Receiver: Received message, correlation id:20100413-1139161 \n2010/04/13 11:39:16 DEBUG - jmeter.protocol.jms.sampler.MessageAdmin: REQ_ID [ID:21f54540-46ae-11df-b307-0016ec6d1bb6:8000000000000000] \n2010/04/13 11:39:16 DEBUG - jmeter.protocol.jms.sampler.MessageAdmin: RPL_ID [ID:21f54540-46ae-11df-b307-0016ec6d1bb6:8000000000000000] for holder null \n2010/04/13 11:39:16 DEBUG - jmeter.protocol.jms.sampler.FixedQueueExecutor: wait for reply ID:21f54540-46ae-11df-b307-0016ec6d1bb6:8000000000000000 started on 1271129956238 \n2010/04/13 11:39:18 DEBUG - jmeter.protocol.jms.sampler.FixedQueueExecutor: done waiting for ID:21f54540-46ae-11df-b307-0016ec6d1bb6:8000000000000000 ended on 1271129958238 \n2010/04/13 11:39:18 DEBUG - jmeter.protocol.jms.sampler.MessageAdmin: GET_ID [ID:21f54540-46ae-11df-b307-0016ec6d1bb6:8000000000000000] for request=HornetQMessage[ID:21f54540-46ae-11df-b307-0016ec6d1bb6:8000000000000000]:PERSISTENT, reply=null \n2010/04/13 11:39:18 INFO  - jmeter.protocol.jms.sampler.MessageAdmin: Message with ID:21f54540-46ae-11df-b307-0016ec6d1bb6:8000000000000000 not found. \n2010/04/13 11:39:18 DEBUG - jmeter.protocol.jms.sampler.JMSSampler: No reply message received \n\nActually, I got this kind of error about 1-2 times in 10 during my testing, especially leave \"Use non-persistent delivery mode\" checkbox unchecked.\n\nIn Debug message, it shows \" RPL_ID [ID:21f54540-46ae-11df-b307-0016ec6d1bb6:8000000000000000] for holder null \" which means executing\n\nPlaceHolder holder = (PlaceHolder) table.get(id);\n\ntable return null of corresponding Request ID after checking the receiver.java and MessageAdmin.java source code.\n\nBTW,  after checking \"Use non-persistent delivery mode\" checkbox, this kind of error disappear. \n\nplease take a look at this issue, i am using HornetQ2.0 as JMS Queue, and take its example queue for testing. See attachment of my JMS P2P sampler.\nHope it helps!\nCheng Chi", "id": 136080, "time": "2010-04-13T02:38:44Z", "creator": "joychester@gmail.com", "creation_time": "2010-04-13T02:38:44Z", "is_private": false, "attachment_id": 25276}, {"count": 1, "tags": [], "bug_id": 49111, "text": "Here is Jboss HornetQ download link, i am using 2.0GA version:\nhttp://www.jboss.org/hornetq/downloads.html\nlet me know if anyone need me to help debugging or testing on your code changes.", "id": 136082, "time": "2010-04-13T02:56:36Z", "creator": "joychester@gmail.com", "creation_time": "2010-04-13T02:56:36Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 49111, "text": "There do seem to be some problems with the code:\n\n1) the details are stored in the table after the message has been sent, so it's possible for the response to arrive before the request details have been stored. \n\nThis is done because the message id is not available before the message has been sent.\n\nIf \"Use Request Message Id As Correlation Id\" is not selected, the request can be stored before the message is sent. But otherwise it may be difficult to fix.\n\n2) if \"Use Request Message Id As Correlation Id\" is selected, the receive code uses the Correlation Id, rather than using the message ID. This should be easier to fix, but there's no point if the bug above cannot be fixed.\n\n==\n\nI've not yet established why selecting non-persistent delivery mode should fix the problem, but perhaps it speeds up the return from the send method.", "id": 136417, "time": "2010-04-26T10:17:55Z", "creator": "sebb@apache.org", "creation_time": "2010-04-26T10:17:55Z", "is_private": false, "attachment_id": null}, {"count": 3, "text": "Hopefully now fixed:\n\nURL: http://svn.apache.org/viewvc?rev=938062&view=rev\nLog:\nBug 49111 - \"Message With ID Not Found\" Error on JMS P2P sampler.\nPartial fix (can still fail if \"Use Request Message Id As Correlation Id\" is selected)\n\nURL: http://svn.apache.org/viewvc?rev=938247&view=rev\nLog:\nBug 49111 - \"Message With ID Not Found\" Error on JMS P2P sampler.\nFixed rest of bug", "bug_id": 49111, "is_private": false, "id": 136424, "time": "2010-04-26T17:35:22Z", "creator": "sebb@apache.org", "creation_time": "2010-04-26T17:35:22Z", "tags": [], "attachment_id": null}, {"count": 4, "attachment_id": null, "creator": "joychester@gmail.com", "text": "Thanks Sebb! \nWill do the verification later.\n\nCheng Chi", "id": 136426, "time": "2010-04-26T23:43:02Z", "bug_id": 49111, "creation_time": "2010-04-26T23:43:02Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "bug_id": 49111, "attachment_id": null, "is_private": false, "id": 136587, "time": "2010-05-01T08:44:08Z", "creator": "sebb@apache.org", "creation_time": "2010-05-01T08:44:08Z", "text": "(In reply to comment #2)\n> \n> 2) if \"Use Request Message Id As Correlation Id\" is selected, the receive code\n> uses the Correlation Id, rather than using the message ID.\n\nI now think that the original code may have been correct - the remote client should be the one to set the reply Correlation Id from the request Message Id.\n\nHowever, this would not apply if the remote client is JMeter itself, as presumably is the case if the request queue is the same as the reply queue."}, {"count": 6, "attachment_id": null, "creator": "sebb@apache.org", "is_private": false, "id": 137917, "time": "2010-06-25T19:23:01Z", "bug_id": 49111, "creation_time": "2010-06-25T19:23:01Z", "tags": [], "text": "The JMS code has been overhauled, and correlation id matching is now fully configurable.\n\nIf the current nightly builds don't solve the problem, please re-open with details."}]