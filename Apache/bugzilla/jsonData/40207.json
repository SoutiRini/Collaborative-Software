[{"count": 0, "tags": [], "text": "We have a build structure with some nested calls from different build files\nto a target imported from a master build file.\n\nSomething changed from 1.6.5 so that BuildListener methods are called in\na different order breaking XmlLogger which depends on a \"targets\" Hashtable.\nThe hashCode() in Target only depends on the target name so nested calls\nto a target introduce problems with the XmlLogger Hashtable.\n\nTo reproduce use the attached build files and call:\n\nant -logger org.apache.tools.ant.XmlLogger -f buildtest2.xml\n\nThe build fails with an exception:\n\njava.lang.RuntimeException: Mismatch - popped element = target:1 finished task\nelement = task:antcall\n\nAlso attached are logfiles produced with Ant 1.6.5 and 1.7-alpha and the\nLog4jListener to illustrate the problem better.", "is_private": false, "bug_id": 40207, "id": 92017, "time": "2006-08-08T12:42:09Z", "creator": "chs@speldrich-it.de", "creation_time": "2006-08-08T12:42:09Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 40207, "text": "Created attachment 18686\nBuild files to reproduce the bug", "id": 92018, "time": "2006-08-08T12:43:56Z", "creator": "chs@speldrich-it.de", "creation_time": "2006-08-08T12:43:56Z", "is_private": false, "attachment_id": 18686}, {"count": 2, "tags": [], "bug_id": 40207, "attachment_id": 18687, "is_private": false, "id": 92019, "time": "2006-08-08T12:46:43Z", "creator": "chs@speldrich-it.de", "creation_time": "2006-08-08T12:46:43Z", "text": "Created attachment 18687\nLog4jListener log files created with Ant 1.6.5 and 1.7Alpha to illustrate the bug better"}, {"count": 3, "tags": [], "bug_id": 40207, "attachment_id": null, "is_private": false, "id": 92805, "time": "2006-08-31T16:12:31Z", "creator": "peterreilly@apache.org", "creation_time": "2006-08-31T16:12:31Z", "text": "The following buildfile also shows the problem:\n<project basedir=\".\" default=\"call-me\" name=\"1\">\n    \n    <target name=\"1\">\n\t<antcall target=\"2\"/>\n    </target>\n\n    <target name=\"2\" unless=\"ONCE\">\n        <property name=\"ONCE\" value=\"SET\"/>\n        <antcall target=\"1\"/>\n    </target>\n\n    <target name=\"call-me\">\n        <antcall target=\"1\" />\n    </target>\n</project>\n\nThe Target.java code adding the hash and equals method was\nchanged with the comment \"flip tests as the IDE was complaining\nthat we werent handing null tokens properly\" (stevel). I\ndo not think that they are needed, and as the above\nexample shows two target with same name and build file may\nexist at the same time - so the equals and hash should include\na test for the project instance - but it would be better to\njust remove the methods!\n\n\n"}, {"attachment_id": null, "tags": [], "creator": "peterreilly@apache.org", "is_private": false, "count": 4, "id": 92828, "time": "2006-08-31T21:40:08Z", "bug_id": 40207, "creation_time": "2006-08-31T21:40:08Z", "text": "Fixed in SVN,\nthanks for the bug report."}]