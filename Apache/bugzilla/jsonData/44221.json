[{"count": 0, "tags": [], "bug_id": 44221, "attachment_id": null, "text": "From Documentation of \"CheckCaseOnly Directive\": \"When set, this directive\nlimits the action of the spelling correction to lower/upper case changes. Other\npotential corrections are not performed.\"\n\nBut if I have e.g. the files \"foo.gif\" and \"foo.jpg\", a request on \"foo.bar\"\nstill returns a Multiple Choices page instead of a Not Found page even with\n\"CheckCaseOnly On\".\n\nProposed bug fix: Disable search for files with \"common basename\" if\nCheckCaseOnly is set to On.\n\nProposed alternative, even better bug fix: Make the WANT_BASENAME_MATCH\navailable as a configuration directive with context \"server config, virtual\nhost, directory, .htaccess\".\n\nThank you in advance", "id": 112798, "time": "2008-01-14T02:10:59Z", "creator": "perske@uni-muenster.de", "creation_time": "2008-01-14T02:10:59Z", "is_private": false}, {"attachment_id": 24165, "tags": [], "bug_id": 44221, "text": "Created attachment 24165\nJust make an else into else if... Simplest of fixes.\n\nDone.  This should fix the issue.", "count": 1, "id": 129936, "time": "2009-08-25T20:13:28Z", "creator": "rmackenzie@dccnet.com", "creation_time": "2009-08-25T20:13:28Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 44221, "text": "I just noticed that this problem is fixed in the current version, but still having status NEW.", "count": 2, "id": 137819, "time": "2010-06-22T10:33:48Z", "creator": "perske@uni-muenster.de", "creation_time": "2010-06-22T10:33:48Z", "is_private": false}, {"count": 3, "tags": [], "text": "I'm testing this on a apache 2.2.16 Unix fresh install but I'm still running into exact the same problems as submitted in 2008.\n\nIt's unexpected (and not wanted) behaviour when apache lists a few \"multiple choices\" (status code 300) when the checkCaseOnly directive is on!!\n\nI have this in my httpd.conf:\nCheckSpelling on\nCheckCaseOnly on\n\nfirst directive to use the mod_speling\nsecond directive to limit only to case corrections", "attachment_id": null, "bug_id": 44221, "id": 139032, "time": "2010-08-10T10:21:12Z", "creator": "bart.vandeputte@tvh.com", "creation_time": "2010-08-10T10:21:12Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 44221, "text": "I looked at code, nothing has been changed to address the issue. Rainer, not sure what you saw as being \"fixed\".\n\nMy patch would change what some are  used to, but bring it to what I consider expected behavior.", "count": 4, "id": 139039, "time": "2010-08-10T14:38:23Z", "creator": "rmackenzie@dccnet.com", "creation_time": "2010-08-10T14:38:23Z", "is_private": false}, {"count": 5, "tags": [], "creator": "perske@uni-muenster.de", "attachment_id": null, "id": 139046, "time": "2010-08-10T17:49:08Z", "bug_id": 44221, "creation_time": "2010-08-10T17:49:08Z", "is_private": false, "text": "If I remember correctly, Rob, I thought that your fix was an official one."}, {"count": 6, "tags": [], "creator": "jdavis@grantstream.com", "attachment_id": null, "id": 159835, "time": "2012-06-08T16:53:14Z", "bug_id": 44221, "creation_time": "2012-06-08T16:53:14Z", "is_private": false, "text": "I'm experiencing this issue in version 2.2.17.\n\nMy config:\n<IfModule mod_speling.c>\nCheckCaseOnly On\nCheckSpelling On\n</IfModule>\n\n\nExample:\n1. Navigate to non-existing resource - https://[URL]/js/jquery.ui.monthpicker.js\n\n2. Results in 300 Multiple Choices - Similar documents found with a single folder found -  /js/jQuery (common basename) \n\n\nI have reviewed the source of mod_speling.c from version 2.2.15 up to 2.3-trunk and there has been no change/patch implemented; all versions are affected.\n\nIf CheckCaseOnly was 'Off' I'd expect this result; however with it set to 'On' this is incorrect behavior and goes against what CheckCaseOnly implies.\n\nIn addition, I like Rainer's suggestion of making WANT_BASENAME_MATCH a configuration directive with support for context; as this would be a great addition to this module. It could be defaulted to On/true for backward compatibility and allow for those experiencing issues to set it accordingly."}, {"count": 7, "tags": [], "bug_id": 44221, "attachment_id": null, "id": 162421, "time": "2012-09-26T15:42:39Z", "creator": "web@bachsau.name", "creation_time": "2012-09-26T15:42:39Z", "is_private": false, "text": "I was just about filing a new bug report about this, when I found it was already discovered four years ago. Cmon, this should be really easy to fix, and it can also be considered a bit of security related, as it may lead to disclosure of information."}, {"count": 8, "tags": [], "creator": "christophe.jaillet@wanadoo.fr", "attachment_id": null, "id": 168723, "time": "2013-07-23T04:56:33Z", "bug_id": 44221, "creation_time": "2013-07-23T04:56:33Z", "is_private": false, "text": "Fixed in trunk r1505279.\n\n\nI will also propose a new option CheckBasenameMatch as suggested by Rainer Perske."}, {"count": 9, "tags": [], "bug_id": 44221, "attachment_id": null, "id": 174230, "time": "2014-04-02T20:33:24Z", "creator": "mmoreno@pobox.com", "creation_time": "2014-04-02T20:33:24Z", "is_private": false, "text": "I'm still seeing this problem in 2.2.22 on Ubuntu.  I don't see any mention of mod_speling fixes in the change log up through 2.2.27 with the last mention being back in 2.2.9.\n\nDid (or will) this patch make it into the 2.2 branch?  Or am I missing something?"}, {"count": 10, "tags": [], "bug_id": 44221, "attachment_id": null, "id": 174231, "time": "2014-04-02T20:59:31Z", "creator": "christophe.jaillet@wanadoo.fr", "creation_time": "2014-04-02T20:59:31Z", "is_private": false, "text": "It has been proposed to 2.4 but refused becasue it changed the default behaviour of the module, which is not what is expected on a stable branch.\n\nIt has not been proposed for backport for 2.2, but it would have been refused for the same reason.\n\nI have planned to rework the patch to avoid the change of default behaviour but have not done it yet.\n\n\nAnyway, I doubt it would be backported in 2.2, even reworked."}, {"count": 11, "tags": [], "creator": "rui.baptista.ml@gmail.com", "attachment_id": null, "is_private": false, "id": 176234, "time": "2014-07-05T16:07:30Z", "bug_id": 44221, "creation_time": "2014-07-05T16:07:30Z", "text": "To clarify the issue, it's expected that apache gives a \"Multiple Choices\" list with CheckCaseOnly directive on, if there is \"sOmE.file\" and \"SoMe.file\" in the same directory. I believe most people didn't expect a list with \"foo.gif\" and \"foo.jpg\" when requesting \"foo.bar\", but that's the current behaviour and the proposed patch breaks it.\n\nThe proposed alternative, make WANT_BASENAME_MATCH a configuration directive, is a better solution. It is a controversial option, and the only way to solve it and make everyone happy is let each one choose."}, {"count": 12, "tags": [], "creator": "apache@skopos.be", "attachment_id": 32307, "text": "Created attachment 32307\nMake \"WANT_BASENAME_MATCH\" configurable\n\nHere is a patch to add the proposed \"CheckBasenameMatch\" config directive.\n\nIt replaces the hard-coded WANT_BASENAME_MATCH and defaults to \"on\" so it maintains compatibility.\n\nNote that this patch is not compatible (and obsoletes/replaces) the one contributed by Rob on 2009-08-25. Setting \"CheckBasenameMatch\" to \"off\" will have the same effect.\n\nThe new patch is actually against 2.4.10 code but that shouldn't be an issue, I presume.\n\nI'm willing to provide a patch against the docs as well, if there is a reasonable chance that the source code patch will be accepted.", "id": 179862, "time": "2014-12-19T10:12:05Z", "bug_id": 44221, "creation_time": "2014-12-19T10:12:05Z", "is_private": false}, {"count": 13, "tags": [], "creator": "apache@skopos.be", "attachment_id": null, "is_private": false, "id": 180141, "time": "2015-01-04T15:15:23Z", "bug_id": 44221, "creation_time": "2015-01-04T15:15:23Z", "text": "As this bug is also present in 2.4.10, I changed the version number accordingly. It seems at 2.2.x there is nobody home anymore."}, {"count": 14, "tags": [], "creator": "dd0t@users.sourceforge.net", "is_private": false, "text": "The patch by apache@skopos.be seems to be totally adequate to fix this issue once and for all in a backwards compatible manner. Any reason why it hasn't been applied yet? The current behavior is simply broken and counterintuitive.", "id": 185781, "time": "2015-10-17T12:12:59Z", "bug_id": 44221, "creation_time": "2015-10-17T12:12:59Z", "attachment_id": null}, {"count": 15, "tags": [], "creator": "melezhik@gmail.com", "text": "Hi!\n\nOnce patch is applied the issue could be verified by this:\n\n( https://github.com/melezhik/apache-swat  - is easy way to verify some existed apache issues against your environment ).\n\nAt my environment tests suite fails ( which is expected ? )\n\nvagrant@Debian-jessie-amd64-netboot:~/my/apache-swat$ swat -t 44221\n/home/vagrant/.swat/.cache/9836/prove/44221/FOO.bar/00.GET.t ...\nok 1 - GET 127.0.0.1/44221/FOO.bar succeeded\n# http headers saved to /home/vagrant/.swat/.cache/9836/prove/xeu0b4EQHn.hdr\n# body saved to /home/vagrant/.swat/.cache/9836/prove/xeu0b4EQHn\nok 2 - output match '200 OK'\nok 3 - output match /Location: \\S+/\nok 4 - 'Location: http://127.0.0.1/44221/foo.bar' match 'foo.bar'\n1..4\nok\n/home/vagrant/.swat/.cache/9836/prove/44221/foo.html/00.GET.t ..\nok 1 - GET 127.0.0.1/44221/foo.html succeeded\n# http headers saved to /home/vagrant/.swat/.cache/9836/prove/ipywRk4nnn.hdr\n# body saved to /home/vagrant/.swat/.cache/9836/prove/ipywRk4nnn\nok 2 - output match /HTTP\\/(\\S+) (\\d+) \\S+/\nnot ok 3 - 'HTTP/1.1 300 Multiple Choices' match /404 /\n\n#   Failed test ''HTTP/1.1 300 Multiple Choices' match /404 /'\n#   at /usr/local/share/perl/5.20.2/swat.pm line 218.\nnot ok 4 - output match 'Not Found'\n\n#   Failed test 'output match 'Not Found''\n#   at /usr/local/share/perl/5.20.2/swat.pm line 218.\n1..4\n# Looks like you failed 2 tests of 4.\nDubious, test returned 2 (wstat 512, 0x200)\nFailed 2/4 subtests\n/home/vagrant/.swat/.cache/9836/prove/44221/foo.bar/00.GET.t ...\nok 1 - GET 127.0.0.1/44221/foo.bar succeeded\n# http headers saved to /home/vagrant/.swat/.cache/9836/prove/MuDUZpFoR3.hdr\n# body saved to /home/vagrant/.swat/.cache/9836/prove/MuDUZpFoR3\nok 2 - output match '200 OK'\n1..2\nok\n/home/vagrant/.swat/.cache/9836/prove/44221/foo.baz/00.GET.t ...\nok 1 - GET 127.0.0.1/44221/foo.baz succeeded\n# http headers saved to /home/vagrant/.swat/.cache/9836/prove/jLZttcgKYZ.hdr\n# body saved to /home/vagrant/.swat/.cache/9836/prove/jLZttcgKYZ\nok 2 - output match '200 OK'\n1..2\nok\n/home/vagrant/.swat/.cache/9836/prove/44221/foo.BAR/00.GET.t ...\nok 1 - GET 127.0.0.1/44221/foo.BAR succeeded\n# http headers saved to /home/vagrant/.swat/.cache/9836/prove/J91YGHyu9m.hdr\n# body saved to /home/vagrant/.swat/.cache/9836/prove/J91YGHyu9m\nok 2 - output match '200 OK'\nok 3 - output match /Location: \\S+/\nok 4 - 'Location: http://127.0.0.1/44221/foo.bar' match 'foo.bar'\n1..4\nok\n\nTest Summary Report\n-------------------\n/home/vagrant/.swat/.cache/9836/prove/44221/foo.html/00.GET.t (Wstat: 512 Tests: 4 Failed: 2)\n  Failed tests:  3-4\n  Non-zero exit status: 2\nFiles=5, Tests=16,  1 wallclock secs ( 0.03 usr  0.01 sys +  0.30 cusr  0.01 csys =  0.35 CPU)\nResult: FAIL\n\n\n\nMy apache build info:\n\n\nvagrant@Debian-jessie-amd64-netboot:~/my/apache-swat$ sudo ~/apache/bin/apachectl -V\nServer version: Apache/2.4.18 (Unix)\nServer built:   Jan 30 2016 10:17:37\nServer's Module Magic Number: 20120211:52\nServer loaded:  APR 1.5.1, APR-UTIL 1.5.4\nCompiled using: APR 1.5.1, APR-UTIL 1.5.4\nArchitecture:   64-bit\nServer MPM:     event\n  threaded:     yes (fixed thread count)\n    forked:     yes (variable process count)\nServer compiled with....\n -D APR_HAS_SENDFILE\n -D APR_HAS_MMAP\n -D APR_HAVE_IPV6 (IPv4-mapped addresses enabled)\n -D APR_USE_SYSVSEM_SERIALIZE\n -D APR_USE_PTHREAD_SERIALIZE\n -D SINGLE_LISTEN_UNSERIALIZED_ACCEPT\n -D APR_HAS_OTHER_CHILD\n -D AP_HAVE_RELIABLE_PIPED_LOGS\n -D DYNAMIC_MODULE_LIMIT=256\n -D HTTPD_ROOT=\"/home/vagrant/apache/\"\n -D SUEXEC_BIN=\"/home/vagrant/apache//bin/suexec\"\n -D DEFAULT_PIDLOG=\"logs/httpd.pid\"\n -D DEFAULT_SCOREBOARD=\"logs/apache_runtime_status\"\n -D DEFAULT_ERRORLOG=\"logs/error_log\"\n -D AP_TYPES_CONFIG_FILE=\"conf/mime.types\"\n -D SERVER_CONFIG_FILE=\"conf/httpd.conf\"", "id": 188099, "time": "2016-02-01T09:39:27Z", "bug_id": 44221, "creation_time": "2016-02-01T09:39:27Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 44221, "text": "(In reply to Rui Baptista from comment #11)\n> To clarify the issue, it's expected that apache gives a \"Multiple Choices\"\n> list with CheckCaseOnly directive on, if there is \"sOmE.file\" and\n> \"SoMe.file\" in the same directory. I believe most people didn't expect a\n> list with \"foo.gif\" and \"foo.jpg\" when requesting \"foo.bar\", but that's the\n> current behaviour and the proposed patch breaks it.\n\nCheckCaseOnly means check case ONLY. That's clearly what the directive's name says, and \".bar! is clearly not a capitalization of \".gif\" or \".jpg\", which means this is simply an ugly, security related bug, nothing else. In no way this can be expected behavior.", "count": 16, "id": 198225, "time": "2017-04-10T18:01:44Z", "creator": "web@bachsau.name", "creation_time": "2017-04-10T18:01:44Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 44221, "text": "Heh, I've been waiting 8 years for this patch to go through... I'm eternally hopeful, but Apache is unlikely to introduce a change that breaks existing behaviour, even if it does bring the code closer to expected.", "count": 17, "id": 198226, "time": "2017-04-10T18:09:25Z", "creator": "rmackenzie@dccnet.com", "creation_time": "2017-04-10T18:09:25Z", "is_private": false}, {"count": 18, "tags": [], "bug_id": 44221, "attachment_id": null, "text": "But there already is an option to achieve what it currently does: CheckCaseOnly = Off ! >>:[", "id": 198227, "time": "2017-04-10T19:07:41Z", "creator": "web@bachsau.name", "creation_time": "2017-04-10T19:07:41Z", "is_private": false}, {"count": 19, "tags": [], "creator": "web@bachsau.name", "attachment_id": null, "id": 198228, "time": "2017-04-10T19:09:59Z", "bug_id": 44221, "creation_time": "2017-04-10T19:09:59Z", "is_private": false, "text": "(In reply to Bachsau from comment #18)\n> But there already is an option to achieve what it currently does:\n> CheckCaseOnly = Off ! >>:[\n\nPS: Another way to fix this could be to split it up: mod_spelling and mod_casing"}, {"attachment_id": null, "tags": [], "bug_id": 44221, "text": "I'm also still waiting for that patch to land. I doubt it is not going because of any compatibility concerns. With the attached patch there simply shouldn't be any. It defaults to the old behavior and simply made the previous compile time option to get the correct behavior available to the user at runtime.", "count": 20, "id": 198295, "time": "2017-04-14T08:28:00Z", "creator": "dd0t@users.sourceforge.net", "creation_time": "2017-04-14T08:28:00Z", "is_private": false}]