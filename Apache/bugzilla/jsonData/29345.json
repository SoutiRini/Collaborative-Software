[{"count": 0, "tags": [], "bug_id": 29345, "attachment_id": null, "id": 58556, "time": "2004-06-02T15:17:32Z", "creator": "andpro77@gmx.net", "creation_time": "2004-06-02T15:17:32Z", "is_private": false, "text": "Using the org.apache.ajp.tomcat4.Ajp13Connector \nHttpServletRequest.getContentLength() returns 0 if no content-length header was \nset in the HTTP request due to chunked transfer-encoding. Actually it should \nreturn -1. Btw org.apache.coyote.tomcat4.CoyoteConnector does this right.\n\nIt works if one initialises contentLength to -1 instead of 0 in \norg.apache.tomcat.util.http.BaseRequest. However, this might not be the \nright/nice place to fix this bug. \n\nIn org.apache.ajp.RequestHandler there is the following code, which seems to \nsolve the problem but doesn't get called if no content-length header is set.\n\n                if (hId == SC_REQ_CONTENT_LENGTH) {\n                    // just read content-length header\n                    int contentLength = (vMB == null) ? -1 : vMB.getInt();\n                    req.setContentLength(contentLength);"}, {"count": 1, "tags": [], "bug_id": 29345, "attachment_id": null, "id": 58557, "time": "2004-06-02T15:23:05Z", "creator": "yoavs@computer.org", "creation_time": "2004-06-02T15:23:05Z", "is_private": false, "text": "The tomcat 4.1 branch is in maintenance mode: pretty much only security and \nshowstopper bugs will be fixed.  The connector code (which this is relevant to) \nwas changed after 4.1.29 to be the Coyote code that's the same as used in \ntomcat 5.0 releases.\n\nPlease at least upgrade to 4.1.30 (the latest stable 4.1 release) and retest.  \nIt would be even better if you could use 5.0 which is being actively developed \nand maintained.\n\nIf you do find the bug to still be present in 5.0, please file a bug report \nagainst Tomcat 5, leaving this item closed.  If you find the bug still present \nin 4.1.30, you may reopen this issue, but there's no guarantee it'll be fixed \nin the 4.1 branch."}, {"count": 2, "tags": [], "creator": "andpro77@gmx.net", "attachment_id": null, "text": "I checked it with Tomcat 4.1.30, which still has this bug. \nI did not test it with Tomcat 5.", "id": 58626, "time": "2004-06-03T12:10:42Z", "bug_id": 29345, "creation_time": "2004-06-03T12:10:42Z", "is_private": false}, {"count": 3, "tags": [], "creator": "funkman@joedog.org", "attachment_id": null, "text": "The org.apache.ajp.tomcat4.Ajp13Connector are out of support. Please use the\nCoyote connectors.", "id": 58627, "time": "2004-06-03T12:22:48Z", "bug_id": 29345, "creation_time": "2004-06-03T12:22:48Z", "is_private": false}]