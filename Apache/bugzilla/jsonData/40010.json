[{"count": 0, "attachment_id": null, "creator": "philippe.lang@attiksystem.ch", "is_private": false, "id": 91093, "time": "2006-07-11T05:47:33Z", "bug_id": 40010, "creation_time": "2006-07-11T05:47:33Z", "tags": [], "text": "Hi,\n\nEvery now and then, Apache 2.2.2 is suddenly unresponsive, and starts filling my\nhttpd-error.log with thousands of lines like:\n\n[Sat Jul 08 20:57:32 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sat Jul 08 20:57:33 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sat Jul 08 20:57:34 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sat Jul 08 20:57:35 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sat Jul 08 20:57:36 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sat Jul 08 20:57:37 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sat Jul 08 20:57:38 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sat Jul 08 20:57:39 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sat Jul 08 20:57:40 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n\nI'm running Apache in FreeBSD 6.0 RELEASE-p2 jails.\n\nRestarting Apache cures the problem for some time, until the problem appears\nagain. It is not that frequent, but the servers are not much loaded either."}, {"count": 1, "tags": [], "creator": "jorton@redhat.com", "attachment_id": null, "is_private": false, "id": 91128, "time": "2006-07-11T14:34:28Z", "bug_id": 40010, "creation_time": "2006-07-11T14:34:28Z", "text": "The warnings are just another symptom of whatever is causing the server to\nrefuse connections.  Are you using any firewalling rules on port 80?  \n\nOtherwise I would guess this would be some issue to do with the use of jails. \nDoes adding \"AcceptFilter http none\" make any difference?"}, {"count": 2, "attachment_id": null, "creator": "philippe.lang@attiksystem.ch", "is_private": false, "id": 91133, "time": "2006-07-11T15:00:34Z", "bug_id": 40010, "creation_time": "2006-07-11T15:00:34Z", "tags": [], "text": "(In reply to comment #1)\n> The warnings are just another symptom of whatever is causing the server to\n> refuse connections.  Are you using any firewalling rules on port 80?  \n> \n> Otherwise I would guess this would be some issue to do with the use of jails. \n> Does adding \"AcceptFilter http none\" make any difference?\n\nHi,\n\nThe server does not use any kind of firewall at all.\n\nI have tried the following, in the httpd.conf of 10 different jails:\n\n------------\n1. Commented out:\n#LoadModule ssl_module libexec/apache22/mod_ssl.so\n\n(I read someone else with the same kind of config and problem tried this\nsuccessfully.)\n\n------------\n2. Added:\nAcceptFilter http none\n\nSince I cannot reproduce the bug, I'll have to wait and see if these changes help.\n\n------------\n\n\nCheers,\n\nPhilippe Lang"}, {"count": 3, "tags": [], "bug_id": 40010, "is_private": false, "id": 91339, "creation_time": "2006-07-16T11:09:46Z", "time": "2006-07-16T11:09:46Z", "creator": "philippe.lang@attiksystem.ch", "text": "(In reply to comment #2)\n> (In reply to comment #1)\n> > The warnings are just another symptom of whatever is causing the server to\n> > refuse connections.  Are you using any firewalling rules on port 80?  \n> > \n> > Otherwise I would guess this would be some issue to do with the use of jails. \n> > Does adding \"AcceptFilter http none\" make any difference?\n> \n> Hi,\n> \n> The server does not use any kind of firewall at all.\n> \n> I have tried the following, in the httpd.conf of 10 different jails:\n> \n> ------------\n> 1. Commented out:\n> #LoadModule ssl_module libexec/apache22/mod_ssl.so\n> \n> (I read someone else with the same kind of config and problem tried this\n> successfully.)\n> \n> ------------\n> 2. Added:\n> AcceptFilter http none\n> \n> Since I cannot reproduce the bug, I'll have to wait and see if these changes help.\n> \n> ------------\n> \n> \n> Cheers,\n> \n> Philippe Lang\n\nHi,\n\nUnfortunately, the changes mentioned just before did not help. Apache 2.2.2 is\nfrozen again.\n\nHere is the log that show the freeze:\n\n--------------------------\n[Sat Jul 15 14:25:36 2006] [error] [client 66.147.238.238] File does not exist:\n/home/verticaldrape/www/data/adserver\n[Sat Jul 15 14:25:37 2006] [error] [client 66.147.238.238] File does not exist:\n/home/verticaldrape/www/data/phpAdsNew\n[Sat Jul 15 14:25:37 2006] [error] [client 66.147.238.238] File does not exist:\n/home/verticaldrape/www/data/phpadsnew\n[Sat Jul 15 14:25:37 2006] [error] [client 66.147.238.238] File does not exist:\n/home/verticaldrape/www/data/phpads\n[Sat Jul 15 14:25:37 2006] [error] [client 66.147.238.238] File does not exist:\n/home/verticaldrape/www/data/Ads\n[Sat Jul 15 14:25:38 2006] [error] [client 66.147.238.238] File does not exist:\n/home/verticaldrape/www/data/ads\n[Sat Jul 15 14:25:38 2006] [error] [client 66.147.238.238] script\n'/home/verticaldrape/www/data/xmlrpc.php' not found or unabl\ne to stat\n[Sat Jul 15 14:25:39 2006] [error] [client 66.147.238.238] File does not exist:\n/home/verticaldrape/www/data/xmlrpc\n[Sat Jul 15 14:25:39 2006] [error] [client 66.147.238.238] File does not exist:\n/home/verticaldrape/www/data/xmlsrv\n[Sat Jul 15 14:25:39 2006] [error] [client 66.147.238.238] File does not exist:\n/home/verticaldrape/www/data/blog\n[Sat Jul 15 14:25:39 2006] [error] [client 66.147.238.238] File does not exist:\n/home/verticaldrape/www/data/drupal\n[Sat Jul 15 14:25:40 2006] [error] [client 66.147.238.238] File does not exist:\n/home/verticaldrape/www/data/community\n[Sat Jul 15 14:25:40 2006] [error] [client 66.147.238.238] File does not exist:\n/home/verticaldrape/www/data/blogs\n[Sat Jul 15 14:25:40 2006] [error] [client 66.147.238.238] File does not exist:\n/home/verticaldrape/www/data/blogs\n[Sat Jul 15 14:25:40 2006] [error] [client 66.147.238.238] File does not exist:\n/home/verticaldrape/www/data/blog\n[Sat Jul 15 14:25:41 2006] [error] [client 66.147.238.238] File does not exist:\n/home/verticaldrape/www/data/blogtest\n[Sat Jul 15 14:25:41 2006] [error] [client 66.147.238.238] File does not exist:\n/home/verticaldrape/www/data/b2\n[Sat Jul 15 14:25:42 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sat Jul 15 14:25:43 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sat Jul 15 14:25:44 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sat Jul 15 14:25:45 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sat Jul 15 14:25:46 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sat Jul 15 14:25:47 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sat Jul 15 14:25:48 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sat Jul 15 14:25:49 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sat Jul 15 14:25:50 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sat Jul 15 14:25:51 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n\n[snip]\n\n[Sun Jul 16 04:50:10 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sun Jul 16 04:50:11 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sun Jul 16 04:50:12 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sun Jul 16 04:50:13 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sun Jul 16 04:50:14 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sun Jul 16 04:50:15 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sun Jul 16 04:50:16 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sun Jul 16 04:50:17 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sun Jul 16 04:50:18 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sun Jul 16 04:50:19 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sun Jul 16 04:50:20 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n[Sun Jul 16 04:50:21 2006] [warn] (61)Connection refused: connect to listener on\n0.0.0.0:80\n\n--------------------------\n\nWhile being scanned by a robot, apache suddenly crashes: it fills the log for a\nfew hours, and then dies. The web server is now completely unresponsive. A\ndeamon restart and everything runs fine again.\n\nAny idea what happens here?\n\n", "attachment_id": null}, {"count": 4, "tags": [], "creator": "andrew.tulloch@maximalls.com", "attachment_id": null, "is_private": false, "id": 93593, "time": "2006-09-14T14:52:02Z", "bug_id": 40010, "creation_time": "2006-09-14T14:52:02Z", "text": "It seems to be related it the Listen Directive and how jails handle the address\n0.0.0.0 (or not).\n\nDefault httpd.conf will have \"Listen 80\", which apache then for dummy\nconnections  (I think) tries connect to 0.0.0.0:80, this address is not remapped\nby FreeBSD's jail to the jail's IP and it just tries to connect to the base\nFreeBSD system and since you're not running apache there you get connection refused.\n\nI noticed these logs entries on a jail on a new server and could reproduce them\nhitting it with ab -n 1000 -c 100 http://servers/static-page.html\n\nIf you change the \"Listen 80\" directive to be \"Listen your.jail.ip:80\" The\nproblem seems to go away."}, {"count": 5, "attachment_id": null, "creator": "hades@svenskapolare.se", "is_private": false, "id": 96843, "time": "2006-12-12T13:36:17Z", "bug_id": 40010, "creation_time": "2006-12-12T13:36:17Z", "tags": [], "text": "(In reply to comment #4)\n> It seems to be related it the Listen Directive and how jails handle the address\n> 0.0.0.0 (or not).\n> \n> Default httpd.conf will have \"Listen 80\", which apache then for dummy\n> connections  (I think) tries connect to 0.0.0.0:80, this address is not remapped\n> by FreeBSD's jail to the jail's IP and it just tries to connect to the base\n> FreeBSD system and since you're not running apache there you get connection\nrefused.\n> \n> I noticed these logs entries on a jail on a new server and could reproduce them\n> hitting it with ab -n 1000 -c 100 http://servers/static-page.html\n> \n> If you change the \"Listen 80\" directive to be \"Listen your.jail.ip:80\" The\n> problem seems to go away.\n\nI have the exact same problem but I'm using Win2003 behind a router with a\nbuilt-in firewall. One or two times a day Apache get messed up and does not\nconnect to my MySQL server. I have to restart Apache, only Apache, in order to\nmake it work. This is getting pretty frustrating.. \n"}, {"count": 6, "attachment_id": null, "creator": "trawick@apache.org", "text": ">One or two times a day Apache get messed up and does not\n>connect to my MySQL server.\n\nSince your Apache is running on Windows, your issue isn't related to this PR. \nIf you think that an Apache bug is preventing something from connecting to your\nMySQL server, open a separate PR.  The only Apache feature which can connect to\nMySQL is   mod_dbd/mod_auth[nz]_dbd.  If it is a feature of a third-party module\nwhich has the problem, we can't be of any assistance here.", "id": 96868, "time": "2006-12-13T06:27:37Z", "bug_id": 40010, "creation_time": "2006-12-13T06:27:37Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "creator": "andrasd@gmail.com", "attachment_id": null, "is_private": false, "id": 97410, "time": "2006-12-28T08:28:32Z", "bug_id": 40010, "creation_time": "2006-12-28T08:28:32Z", "text": "I am having the same problem, every 2-3 days my httpd server just stops\nresponding. The error log has no info, the access log shows no suspicios\nactivity eighter.\nI had Listen 80 in my conf file and changed it to Listen m.y.i.p:80.\nI hope this will help resolve.\n\nP.S. 3 days ago I installed 2.2.3 and hoped this was a problem with 2.2.2 but\n2.2.3 did the same."}, {"count": 8, "tags": [], "creator": "philippe.lang@attiksystem.ch", "attachment_id": null, "is_private": false, "id": 97411, "time": "2006-12-28T08:32:07Z", "bug_id": 40010, "creation_time": "2006-12-28T08:32:07Z", "text": "(In reply to comment #4)\n> It seems to be related it the Listen Directive and how jails handle the address\n> 0.0.0.0 (or not).\n> \n> Default httpd.conf will have \"Listen 80\", which apache then for dummy\n> connections  (I think) tries connect to 0.0.0.0:80, this address is not remapped\n> by FreeBSD's jail to the jail's IP and it just tries to connect to the base\n> FreeBSD system and since you're not running apache there you get connection\nrefused.\n> \n> I noticed these logs entries on a jail on a new server and could reproduce them\n> hitting it with ab -n 1000 -c 100 http://servers/static-page.html\n> \n> If you change the \"Listen 80\" directive to be \"Listen your.jail.ip:80\" The\n> problem seems to go away.\n\nThe problem goes away, right. In FreeBSD jails, although only one single IP is\nvisible when issuing an ifconfig, you have to bind every server process to this\nspecific IP, not * or 0.0.0.0."}, {"count": 9, "tags": [], "bug_id": 40010, "attachment_id": null, "id": 97422, "creation_time": "2006-12-28T10:29:06Z", "time": "2006-12-28T10:29:06Z", "creator": "wrowe@apache.org", "text": "andras, don't hijaak bugs.  This one happens to be BSD specific.  Clue is - NEVER\nchange from someone else's OS to your OS.  And your error log doesn't correspond\nto the reporter's, so the flaw appears to be different.", "is_private": false}]