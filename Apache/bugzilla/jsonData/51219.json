[{"count": 0, "tags": [], "creator": "christian.roue@neolane.com", "text": "After last apr update on Debian 5&6 / i386 for CVE-2011-0419 we observed multiple of our apache servers running 100%+ CPU randomely.\n\nWe identified function going into an infinite loop to be  apr_fnmatch trying to match pattern '/*/WEB-INF/' against any non matching uri.\n\nThis pattern is matched due to following directive in our .conf:\n\n<Location \"/*/WEB-INF/\">\n  deny from all\n</Location> \n\nProblem was reproduced with Apache apr-1.4.4 recompiled from sources adding the extra testcase (testfnmatch.c):\n\n    {\"/*/WEB-INF/\", \"/wontmatch\",       FAIL},\n\nProblem daesn't exist in apr-1.3.12.\n\nDebian patch is apparently a back port of new code in 1.2/1.4 for Deb 5/6\n\nDebian patch info: http://packetstormsecurity.org/files/view/101435/dsa-2237-1.txt\n\nChris", "id": 146418, "time": "2011-05-18T13:07:04Z", "bug_id": 51219, "creation_time": "2011-05-18T13:07:04Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "christian.roue@neolane.com", "attachment_id": null, "id": 146454, "time": "2011-05-19T10:22:27Z", "bug_id": 51219, "creation_time": "2011-05-19T10:22:27Z", "is_private": false, "text": "Bug reported to debian:\nhttp://bugs.debian.org/cgi-bin/bugreport.cgi?bug=627182"}, {"count": 2, "tags": [], "bug_id": 51219, "attachment_id": null, "id": 146510, "time": "2011-05-21T07:06:15Z", "creator": "max@cxib.net", "creation_time": "2011-05-21T07:06:15Z", "is_private": false, "text": "Instead of changing the algorithm, it is better to add recursion limit and set 64 (not bigger). I see only one recursion call inside apr_fnmatch\n\n457 \twhile (apr_dir_read(&finfo, APR_FINFO_NAME, dir) == APR_SUCCESS) {\n458 \tif (apr_fnmatch(pattern, finfo.name, 0) == APR_SUCCESS) { \n\nso better limit this call, than change the algorithm."}, {"count": 3, "tags": [], "creator": "sf@sfritsch.de", "attachment_id": null, "id": 166121, "time": "2013-03-24T07:46:56Z", "bug_id": 51219, "creation_time": "2013-03-24T07:46:56Z", "is_private": false, "text": "This is fixed in 1.4.5"}]