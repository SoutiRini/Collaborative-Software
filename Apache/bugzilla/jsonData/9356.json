[{"count": 0, "attachment_id": null, "bug_id": 9356, "is_private": false, "id": 16596, "time": "2002-05-23T15:39:13Z", "creator": "avm3@cdc.gov", "creation_time": "2002-05-23T15:39:13Z", "tags": [], "text": " "}, {"count": 1, "tags": [], "bug_id": 9356, "attachment_id": null, "id": 16598, "time": "2002-05-23T15:49:43Z", "creator": "avm3@cdc.gov", "creation_time": "2002-05-23T15:49:43Z", "is_private": false, "text": "According to the servlet spec (2.3 Final)\n\n  getResourcePaths(String)\n  ...\n  Returns: a Set containing the directory listing, or null if there are no\n  resources in the web application whose path begins with the supplied path.\n\nHowever, Catalina returns an empty Set (rather than a null value) for\npaths that do not exist in the WAR.  Here is my test JSP page:\n\n<%!\n  public void checkPath(String path, ServletContext context, JspWriter out)\n    throws java.io.IOException {\n\n    out.println(\"CHECKING PATH: \" + path);\n    java.util.Set resources = context.getResourcePaths(path);\n    out.println(\"  Null return value? \" + (resources==null));\n\n    if (resources!=null) {\n      out.println(\"  EMPTY? \" + resources.isEmpty());\n      java.util.Iterator iter = resources.iterator();\n      while (iter.hasNext())\n        out.println(\"  \" + iter.next());\n    }\n    out.println();\n  }\n%>\n\n<pre>\n<%\n  checkPath(\"/\", application, out);\n  checkPath(\"/WEB-INF\", application, out);\n  checkPath(\"/WEB-INF/\", application, out);\n  checkPath(\"/ShOuLd_NoT_eXiST\", application, out);\n  checkPath(\"/ShOuLd_NoT_eXiST/\", application, out);\n%>\n</pre>\n\nAnd here is part of the sample output:\n\nCHECKING PATH: /WEB-INF/\n  Null return value? false\n  EMPTY? false\n  /WEB-INF//web.xml\n\nCHECKING PATH: /ShOuLd_NoT_eXiST\n  Null return value? false\n  EMPTY? true\n\nCHECKING PATH: /ShOuLd_NoT_eXiST/\n  Null return value? false\n  EMPTY? true\n\n\n\n"}, {"count": 2, "tags": [], "bug_id": 9356, "attachment_id": 2012, "id": 17177, "time": "2002-06-05T14:17:10Z", "creator": "bob@jadn.com", "creation_time": "2002-06-05T14:17:10Z", "is_private": false, "text": "Created attachment 2012\nPatch to ApplicationContextFacade.java to return null if no ResourcePaths exist (Per Servelet Spec)"}, {"count": 3, "tags": [], "text": "Created attachment 2013\nPatch to keep TldLocationsCache.java from throwing NullPointer when null comes back from getResourcePaths (Per Servlet Spec)", "attachment_id": 2013, "id": 17178, "creator": "bob@jadn.com", "time": "2002-06-05T14:18:55Z", "bug_id": 9356, "creation_time": "2002-06-05T14:18:55Z", "is_private": false}, {"count": 4, "attachment_id": null, "bug_id": 9356, "is_private": false, "id": 17179, "time": "2002-06-05T14:25:25Z", "creator": "bob@jadn.com", "creation_time": "2002-06-05T14:25:25Z", "tags": [], "text": "\nI agree with the poster, the Spec says null is what should be returned, not an\nempty Set.  I gave these patches a run through and the Examples are all working\nfine.  Is there any additional testing I should do to ensure this change isnt\ngoing to cause a fire elsewhere (something like a regression test suite - which\nmind you would be a pain in the ass to run all the time, but might save a\ndependent project some grief from a unintended side effect.)  \n\nThose doubts aside, can somebody commit these 2 small changes?\n\nCheers,\nbob@jadn.com\n"}, {"count": 5, "tags": [], "bug_id": 9356, "attachment_id": null, "id": 17188, "time": "2002-06-05T14:49:44Z", "creator": "avm3@cdc.gov", "creation_time": "2002-06-05T14:49:44Z", "is_private": false, "text": "Please see bug 9634 (this addes tests to watchdog for\nthe method ServletContext.getResourcePaths()).\n\nAlso see the patch I submitted in an accidentally duplicated\nbug 9629.  The patch in 9629 does the same thing as the one\nin this bug, plus a fix for bug 5603 (see notes in that bug 9629\nfor details).\n\nThanks for getting this fixed.\n"}, {"count": 6, "tags": [], "text": "This has now been fixed. The fix will be in 4.0.4, as well as 4.1.4.", "attachment_id": null, "id": 17246, "creator": "remm@apache.org", "time": "2002-06-06T00:18:30Z", "bug_id": 9356, "creation_time": "2002-06-06T00:18:30Z", "is_private": false}]