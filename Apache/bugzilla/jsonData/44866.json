[{"count": 0, "tags": [], "text": "We are creating the Excel report, Report gets open fine in case of Office sp2, but with office SP3 following msg gets when we open the excel report.\n\n     \" Damage to the file was so extensive that repairs were not possible.  Excel\nattempted to recover your formulas and values, but some data may have been\nlost or corrupted.\"\n\n    We can see all the data but the fonts, colors and formula vanished.\n\nTo create the report following steps are performed\n\n1.  Get the template to generate the template.\n\nfs = new POIFSFileSystem(new FileInputStream(servlet.getServletContext().getRealPath(\"/\") + tPath + \"//TestReport.xls\"));\n\n2. Create Work book\n \n   wb = new HSSFWorkbook(fs);\n\n3. HSSFSheet sheet = wb.getSheet(name);  \n    // name = here name of sheet present in template\n\n      HSSFRow row = sheet.getRow(4);\n\n     HSSFCell cell = row.getCell(4);\n\tif (cell == null) {\n\t    cell = row.createCell(4);\n\t}\n\t\t\t\t\n\tsetCell(cell, \"Data to print in report.\");\n\nand wb object is set in request attribute and use to open excel report.", "attachment_id": null, "id": 115830, "creator": "deepak.lokhande@gmail.com", "time": "2008-04-24T03:04:27Z", "bug_id": 44866, "creation_time": "2008-04-24T03:04:27Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 44866, "text": "I assume that 'wb' was written out to file, and *that* is the file that doesn't open properly in Excel.\n\nIt's likely that the 'template' file TestReport.xls has a lot to do with this bug (the snippets of java code you supplied look very normal).\n\nCould you please upload that file and some exact java code which produces this error?\n\nBTW if TestReport.xls was produced in another utility besides Excel (or in any case) it may help to re-save that file with Excel first before manipulating it with POI.", "id": 115859, "time": "2008-04-24T16:27:00Z", "creator": "josh@apache.org", "creation_time": "2008-04-24T16:27:00Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "d33nar@yahoo.co.uk", "text": "I can confirm that our users are reporting the same issue. I cannot post code snippets. Our application generates XLS output from scratch, without using a template file.\n\n\"Damage to the file was so extensive that repairs were not possible. Excel attempted to recover your formulas and values, but some data may have been\nlost or corrupted.\"\n\nThis behaviour is only seen with desktops where SP3 applied to Excel or specifically this excel patch \nhttp://www.microsoft.com/technet/security/Bulletin/MS08-014.mspx\n\nThe XLS files generated work fine with Excel versions without this patch.\n\n\nRegards\nDeenar Toraskar", "id": 115960, "time": "2008-04-28T07:07:19Z", "bug_id": 44866, "creation_time": "2008-04-28T07:07:19Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 44866, "is_private": false, "count": 3, "id": 115962, "time": "2008-04-28T07:22:16Z", "creator": "apache@gagravarr.org", "creation_time": "2008-04-28T07:22:16Z", "text": "Could someone please either post:\n* a file that will open on SP2 but not SP3\n* some code that generates the file that opens on SP2 but not on SP3\n\n(in either case, ideally the smallest code snippet/file that will trigger it)\n\nWithout that, we've no way to tell what's wrong. In the mean time though, you might be best of ringing up Microsoft tech support (support contracts ought to have some use...), and asking them what they broke in SP3!"}, {"count": 4, "tags": [], "creator": "d33nar@yahoo.co.uk", "attachment_id": null, "is_private": false, "id": 115964, "time": "2008-04-28T07:44:04Z", "bug_id": 44866, "creation_time": "2008-04-28T07:44:04Z", "text": "Update - This problem is fixed using 3.0.2-FINAL version of POI. We were previously using 3.0-FINAL version. No sure wether to mark it as resolved."}, {"count": 5, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "Good to know it's fixed", "id": 115965, "time": "2008-04-28T07:50:03Z", "bug_id": 44866, "creation_time": "2008-04-28T07:50:03Z", "is_private": false}]