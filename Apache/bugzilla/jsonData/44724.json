[{"count": 0, "tags": [], "bug_id": 44724, "text": "Created attachment 21750\nCGI script which outputs Russian text in UTF-8\n\nTomcat CGIServlet which is distributed with Tomcat performs undesirable conversion of CGI script output encoding.\n\nThis conversion is performed indirectly by the servlet (which passes data through a memory stream) and depends on character encoding environment variables (LANG/LC_ALL/...), at least on UNIX-like systems.\n\nSteps to reproduce:\n\n1. Install Tomcat \n2. Create a CGI script which outputs non-ascii7 data.\n3. Set up Tomcat for running CGI scripts (a la http://tomcat.apache.org/tomcat-6.0-doc/cgi-howto.html)\n4. Set up any single-byte language environment  (for example, say 'export LANG=C' in bash)\n5. Start Tomcat instance in that single-byte language environment\n6. Make a request to CGI script.\n\nAll non-ascii7 characters in the CGI output will be replaced with quotation marks.\n\nThis behaviour is different from any other CGI implementation and is unexpected by any \"normal\" user.", "id": 115180, "time": "2008-04-01T03:23:22Z", "creator": "zinal@primetver.ru", "creation_time": "2008-04-01T03:23:22Z", "is_private": false, "attachment_id": 21750}, {"count": 1, "tags": [], "bug_id": 44724, "is_private": false, "text": "Your test case works correctly for me.\n\nI can't work out what code you are looking at. Where is the conversion you refer to? The headers are read with a Reader but the body is just copied byte for byte from the input stream to the output stream.", "id": 115207, "time": "2008-04-01T14:54:10Z", "creator": "markt@apache.org", "creation_time": "2008-04-01T14:54:10Z", "attachment_id": null}, {"count": 2, "text": "The testcase seems to be working properly in Tomcat 6.0.16.\nThe problem described can be reproduced only with Tomcat 5.0 and 5.5 running Sun JRE 1.4.\n\nThanks to Mark Tomas for his help.", "creator": "zinal@primetver.ru", "is_private": false, "id": 115224, "time": "2008-04-01T23:48:53Z", "bug_id": 44724, "creation_time": "2008-04-01T23:48:53Z", "tags": [], "attachment_id": null}, {"count": 3, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "text": "Based on previous comment, re-opening and moving to TC5.", "id": 115225, "time": "2008-04-01T23:57:44Z", "bug_id": 44724, "creation_time": "2008-04-01T23:57:44Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 44724, "text": "I double-checked the issue in Tomcat 5.5.15. Still get quotation marks instead of letters.\n\nThis is a version.sh output:\n\nUsing CATALINA_BASE:   /home/zinal/tomcat\nUsing CATALINA_HOME:   /home/zinal/tomcat\nUsing CATALINA_TMPDIR: /home/zinal/temp\nUsing JRE_HOME:       /usr/java/jdk1.5.0_08\nServer version: Apache Tomcat/5.5.15\nServer built:   Jan 3 2006 10:12:35\nServer number:  5.5.15.0\nOS Name:        Linux\nOS Version:     2.6.13-15.15-smp\nArchitecture:   amd64\nJVM Version:    1.5.0_08-b03\nJVM Vendor:     Sun Microsystems Inc.\n\n> Thanks to Mark Tomas for his help.\nSorry for misspelled name. Mark Thomas, of course.\n", "count": 4, "id": 115242, "time": "2008-04-02T03:54:46Z", "creator": "zinal@primetver.ru", "creation_time": "2008-04-02T03:54:46Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 44724, "text": "This also works for me using the latest 5.5.x code from svn and I suspect it will also work with 5.5.26.", "count": 5, "id": 115340, "time": "2008-04-05T12:59:00Z", "creator": "markt@apache.org", "creation_time": "2008-04-05T12:59:00Z", "is_private": false}]