[{"count": 0, "text": "Created attachment 27541\nThe problematic spreadsheet\n\nI have a spreadsheet which has been created with Apache POI and edited in Excel. (See attached.) When I open it with POI and attempt to add a comment to the first sheet, I get the following error message:\n\n\torg.apache.poi.openxml4j.exceptions.InvalidOperationException: A part with the name '/xl/comments1.xml' already exists : Packages shall not contain equivalent part names and package implementers shall neither create nor recognize packages with equivalent part names. [M1.12]\n\nTested against 3.8-beta4, with the following code:\n\n    public static void bugtest() {\n        FileInputStream inp = null;\n        \n        try {\n            inp = new FileInputStream(new File(OUTPUT_FOLDER, \"comments-notworking.xlsx\"));\n            Workbook wb = WorkbookFactory.create(inp);\n            Sheet s = wb.getSheet(\"comments\");\n            Cell c = s.getRow(0).getCell(0);\n            \n            CreationHelper factory = wb.getCreationHelper();\n            Drawing drawing = s.createDrawingPatriarch();\n            \n            ClientAnchor anchor = factory.createClientAnchor();\n            anchor.setCol1(0);\n            anchor.setCol2(4);\n            anchor.setRow1(0);\n            anchor.setRow2(1);\n            \n            Comment excelComment = drawing.createCellComment(anchor);\n            excelComment.setString(factory.createRichTextString(\"I like this cell. It's my favourite.\"));\n            excelComment.setAuthor(\"Bob T. Fish\");\n            \n            c.setCellComment(excelComment);\n        }\n        catch (Exception e) {\n            e.printStackTrace();\n        }\n        finally {\n            try { inp.close(); }\n            catch (Exception e) {}\n        }\n    }", "bug_id": 51850, "attachment_id": 27541, "id": 149518, "time": "2011-09-20T11:03:57Z", "creator": "Alex.Panayotopoulos@vianet.co.uk", "creation_time": "2011-09-20T11:03:57Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 51850, "attachment_id": null, "is_private": false, "id": 149616, "time": "2011-09-22T10:38:31Z", "creator": "apache@gagravarr.org", "creation_time": "2011-09-22T10:38:31Z", "text": "Fixed in r1174048.\n\nWe try to give the new comments part the same ID as the sheet has, but if someone has already claimed that name then we just take the next available one"}]