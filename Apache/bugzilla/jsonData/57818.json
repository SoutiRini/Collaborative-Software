[{"count": 0, "tags": [], "creator": "ryan@marix.com", "text": "While opening a winmail.dat file I get a BufferUnderrunException.  The message is properly opened and displayed if forwarded to an outlook.com email address.  \n\nMy code is trivial:\n\nHMEFContentsExtractor ext = new HMEFContentsExtractor(tnefFile);\n\n\nI cannot include a sample file as it is confidential customer information, however, I can privately share samples for testing, I have hundreds.\n\n\nI have also tried and failed opening with these utilities:\n* http://www.freeutils.net/source/jtnef/ java library\n* http://tud.at/php/tnef/ online tnef extractor\n* http://www.winmail-dat.com/online.php online tnef extractor\n* http://github.com/verdammelt/tnef C utility on linux\n* http://www.joshjacob.com/mac-development/tnef.php OSX app\n* Forward to gmail.com email address\n\nI was thinking the winmail.dat file was corrupt until I sent to outlook.com and it worked perfectly.\n\n\n\n\nStack trace:\n\norg.apache.poi.util.LittleEndian$BufferUnderrunException: buffer underrun \n\tat org.apache.poi.util.LittleEndian.readUShort(LittleEndian.java:804) \n\tat org.apache.poi.hmef.attribute.TNEFAttribute.create(TNEFAttribute.java:61) \n\tat org.apache.poi.hmef.HMEFMessage.process(HMEFMessage.java:74) \n\tat org.apache.poi.hmef.HMEFMessage.process(HMEFMessage.java:98) \n\tat org.apache.poi.hmef.HMEFMessage.process(HMEFMessage.java:98) \n\tat org.apache.poi.hmef.HMEFMessage.process(HMEFMessage.java:98) \n\tat org.apache.poi.hmef.HMEFMessage.process(HMEFMessage.java:98) \n\tat org.apache.poi.hmef.HMEFMessage.process(HMEFMessage.java:98) \n\tat org.apache.poi.hmef.HMEFMessage.process(HMEFMessage.java:98) \n\tat org.apache.poi.hmef.HMEFMessage.process(HMEFMessage.java:98) \n\tat org.apache.poi.hmef.HMEFMessage.process(HMEFMessage.java:98) \n\tat org.apache.poi.hmef.HMEFMessage.<init>(HMEFMessage.java:63) \n\tat org.apache.poi.hmef.extractor.HMEFContentsExtractor.<init>(HMEFContentsExtractor.java:63) \n... my code", "id": 182399, "time": "2015-04-15T17:18:36Z", "bug_id": 57818, "creation_time": "2015-04-15T17:18:36Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "text": "I'd suggest attaching a debugger, and stepping through. Focus on the attributes just before it goes wrong, as well as the one it fails on - check if they look sensible, sizes and types are sensible, values read match the ones that outlook shows etc. That should help you identify if the problem is with the failing attribute, or if it's actually a problem with a preceeding one which wrecks the state", "is_private": false, "id": 182402, "creation_time": "2015-04-15T19:52:05Z", "time": "2015-04-15T19:52:05Z", "creator": "apache@gagravarr.org", "bug_id": 57818, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 57818, "is_private": false, "id": 189439, "creation_time": "2016-03-13T19:31:21Z", "time": "2016-03-13T19:31:21Z", "creator": "dominik.stadler@gmx.at", "text": "Unfortunately there is not much we can do without a sample file, therefore I am closing this for now, please reopen if you can provide a file.", "attachment_id": null}]