[{"count": 0, "tags": [], "bug_id": 25363, "is_private": false, "text": "When request attributes are sent by mod_jk from Apache to Tomcat5.0.16's Coyote\nAJP/1.3 handler, these attributes are not listed by request.getAttributeNames().\nThey are accesible when specificaly asked for them using request.getAttribute(),\nbut even after this they are not listed by request.getAttributeNames().\n\nSteps to reproduce:\n1) set up Apache with SSL support and mod_jk (or mod_jk2)\n2) enable sending SSL attributes in httpd.conf using\n\nLoadModule      jk_module               libexec/mod_jk1.2.5.so\nJkWorkersFile \"/etc/httpd/workers.properties\"\nJkLogFile \"/var/log/httpd/mod_jk.log\"\nJkLogLevel info\nJkOptions +ForwardKeySize +ForwardURIEscaped -ForwardDirectories\nJkExtractSSL On\nJkEnvVar SSL_PROTOCOL \"default\"\nJkEnvVar SSL_VERSION_INTERFACE \"default\"\nJkMount /mywebapp/* myworker\n<Location \"/mywebapp/*\">\n  SSLOptions +ExportCertData +StdEnvVars\n</Location>\n\n3) in Tomcat, in webapplication \"mywebapp\" create a JSP page with following code:\n\n <b>Enumerated request attributes:</b><br>\n <%java.util.Enumeration en1=request.getAttributeNames();\n   while(en1.hasMoreElements()) {\n    String name = (String)en1.nextElement();\n    out.println(name+\"=\"+request.getAttribute(name)+\"<br>\");\n   }%>\n <b>Asked request attributes:</b><br> \n javax.servlet.request.cipher_suite=<%=request.getAttribute(\"javax.servlet.request.cipher_suite\") %><br>\n javax.servlet.request.key_size=<%=request.getAttribute(\"javax.servlet.request.key_size\") %><br>\n javax.servlet.request.X509Certificate=<%=request.getAttribute(\"javax.servlet.request.X509Certificate\") %><br>\n javax.servlet.request.ssl_session=<%=request.getAttribute(\"javax.servlet.request.ssl_session\") %><br>\n SSL_PROTOCOL=<%=request.getAttribute(\"SSL_PROTOCOL\") %><br>\n SSL_VERSION_INTERFACE=${SSL_VERSION_INTERFACE}<br>\n <b>Again enumerated request attributes:</b><br>\n <%java.util.Enumeration en2=request.getAttributeNames();\n   while(en2.hasMoreElements()) {\n    String name = (String)en2.nextElement();\n    out.println(name+\"=\"+request.getAttribute(name)+\"<br>\");\n   }%>\n\n\n4) access the page from a webbrowser. The page will display:\n\nEnumerated request attributes:\nAsked request attributes:\n javax.servlet.request.cipher_suite=RC4-MD5\n javax.servlet.request.key_size=128\n javax.servlet.request.X509Certificate=[Ljava.security.cert.X509Certificate;@199197b\n javax.servlet.request.ssl_session=78DE7EA098961A94E2C37B410FEFCAEA4B2ACD8D8A15199AF52CED901083D870\n SSL_PROTOCOL=TLSv1\n SSL_VERSION_INTERFACE=mod_ssl/2.8.15\nAgain enumerated request attributes:\n javax.servlet.request.cipher_suite=RC4-MD5\n javax.servlet.request.key_size=128\n javax.servlet.request.X509Certificate=[Ljava.security.cert.X509Certificate;@199197b\n\n\nIt means, that some request attribute names  are listed after they were\nspecificaly asked, but not before, and not all of them.", "id": 48745, "time": "2003-12-09T17:04:17Z", "creator": "makub@ics.muni.cz", "creation_time": "2003-12-09T17:04:17Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 25363, "text": "Voting for a bug is stupid ;-) If you care, submit a patch (although I'd say it\nmay not be accepted, the issue is complex).\n\nI think this issue may be partially addressed (the parameter will show up in the\nlist), as I see something odd in the getParameter from TC 5 in the adaptor code.\nFor the rest, this may not be fixed; we'll see.", "id": 48750, "time": "2003-12-09T17:37:35Z", "creator": "remm@apache.org", "creation_time": "2003-12-09T17:37:35Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 25363, "attachment_id": null, "id": 51616, "time": "2004-02-02T20:05:08Z", "creator": "remm@apache.org", "creation_time": "2004-02-02T20:05:08Z", "is_private": false, "text": "The three standard SSL attributes will now be exposed through getAttributeNames\neven without calling getAttribute first. As a design decision, all other\nattributes coming from the native layer will not be exposed through\ngetAttributeNames. Please do nt reopen this report."}, {"count": 3, "tags": [], "bug_id": 25363, "attachment_id": null, "id": 53656, "time": "2004-03-08T12:49:43Z", "creator": "remm@apache.org", "creation_time": "2004-03-08T12:49:43Z", "is_private": false, "text": "*** Bug 27514 has been marked as a duplicate of this bug. ***"}]