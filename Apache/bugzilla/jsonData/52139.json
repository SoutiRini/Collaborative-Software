[{"count": 0, "tags": [], "creator": "ezyang@mit.edu", "text": "Right now Apache has two different behaviors with respect to an invalid DocumentRoot: if it's a VirtualHost, it only warns if the DocumentRoot is invalid; if it's not a VirtualHost, it will \"Syntax Error\" and bail out.\n\nI suggest that we should always warn if there is an invalid DocumentRoot, and never fail if it is invalid. This is handy if your DocumentRoot is, say, on a network mounted filesystem, which may not have come up by the time Apache runs (but will come up soon!)\n\nThe patch for this is very simple:\n\n--- server/core.c.bak\t2011-11-05 03:15:37.000000000 -0400\n+++ server/core.c\t2011-11-05 03:15:39.000000000 -0400\n@@ -1211,16 +1211,11 @@\n     if (apr_filepath_merge((char**)&conf->ap_document_root, NULL, arg,\n                            APR_FILEPATH_TRUENAME, cmd->pool) != APR_SUCCESS\n         || !ap_is_directory(cmd->pool, arg)) {\n-        if (cmd->server->is_virtual) {\n-            ap_log_perror(APLOG_MARK, APLOG_STARTUP, 0,\n-                          cmd->pool,\n-                          \"Warning: DocumentRoot [%s] does not exist\",\n-                          arg);\n-            conf->ap_document_root = arg;\n-        }\n-        else {\n-            return \"DocumentRoot must be a directory\";\n-        }\n+        ap_log_perror(APLOG_MARK, APLOG_STARTUP, 0,\n+                      cmd->pool,\n+                      \"Warning: DocumentRoot [%s] does not exist\",\n+                      arg);\n+        conf->ap_document_root = arg;\n     }\n     return NULL;\n }", "id": 151217, "time": "2011-11-05T07:15:58Z", "bug_id": 52139, "creation_time": "2011-11-05T07:15:58Z", "is_private": false, "attachment_id": null}]