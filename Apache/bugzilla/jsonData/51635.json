[{"count": 0, "tags": [], "bug_id": 51635, "text": "Created attachment 27362\nPatch file\n\nThis patch intends to provide improved performance for XSSFSheet#write by getting rid of XSSFSheet#ensureRowOrdering.\n\nThe general idea is to keep the underlying CTSheetData row array collection sorted all times (this idea was highlighted by Yegor Kozlov in http://apache-poi.1045710.n5.nabble.com/Performance-Question-with-CTSheetDataImpl-java-td2335065.html). This requires that methods XSSFSheet#createRow, XSSFSheet#removeRow and XSSFSheet#shiftRows manage the worksheet.getSheetData() row array collection correspondingly.\n\nThis patch also adapts one of the unit tests:\nTestXSSFSheet#testCreateRow\n\nThis test was checking that creating rows in reverse order actually keeps the rows inside worksheet.getSheetData() in the order they have been inserted. This has been changed to a test that actually checks that rows are kept in ascending order.", "id": 148492, "time": "2011-08-08T20:15:06Z", "creator": "martin.studer@mirai-solutions.com", "creation_time": "2011-08-08T20:15:06Z", "is_private": false, "attachment_id": 27362}, {"count": 1, "tags": [], "creator": "martin.studer@mirai-solutions.com", "attachment_id": 27363, "text": "Created attachment 27363\nPatch SVN diff", "id": 148493, "time": "2011-08-08T20:15:44Z", "bug_id": 51635, "creation_time": "2011-08-08T20:15:44Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 51635, "attachment_id": null, "id": 148528, "time": "2011-08-10T17:40:07Z", "creator": "yegor@dinom.ru", "creation_time": "2011-08-10T17:40:07Z", "is_private": false, "text": "Applied in r1156272.\n\nP.S. I realized that a similar fix can be applied to XSSFRow which needs to keep cells in sorted order too, see XSSFRow#onDocumentWrite. patches are welcome :)\n\nRegards,\nYegor"}]