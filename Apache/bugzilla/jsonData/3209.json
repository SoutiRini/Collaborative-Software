[{"count": 0, "text": "Tomcat does not destroy the servlet immediately if the UnavailableException\nindicates \"permanent\" unavailability.\n\nThe specs says\n\nIf a permanent unavailability is indicated by the UnavailableException, the\nservlet container must remove the servlet from service, call its destroy method,\nand release the servlet instance\n\nThe following is the code that can thow out a permanent UnavailableException:\n\n> -----------------------------------------------------------------------\n> package servlets.stdPos;\n> \n> import javax.servlet.*;\n> import javax.servlet.http.*;\n> import java.io.*;\n> \n> public class Test29 extends HttpServlet\n> {\n> \n>  public void init ( ServletConfig config )\n>   throws ServletException\n>  {\n>   super.init(config);\n>   System.out.println(\"I am init of Test29.<BR>\");\n> \n>  }\n> \n>  public void service ( HttpServletRequest req, HttpServletResponse resp\n> )\n>    throws ServletException,IOException\n>  {\n>   PrintWriter out = resp.getWriter();\n>   resp.setContentType(\"text/html\");\n> \n>   out.println(\" <HTML> \");\n>   out.println(\" <HEAD>\");\n>   out.println(\" <TITLE>Test29 servlet : Throwing UnavailabilityException\n> in service </TITLE> \");\n>   out.println(\" </HEAD> \");\n>   out.println(\" <BODY BGCOLOR=white> \");\n> \n>   out.println(\" <CENTER> \");\n>   out.println(\" <FONT COLOR=BLUE> \");\n>   out.println(\" <STRONG>Test Output</STRONG> \");\n>   out.println(\" </FONT> \");\n>   out.println(\" </CENTER> \");\n>   out.println(\" <HR> \");\n>   out.println(\" <TITLE>Test29 servlet : Throwing UnavailabilityException\n> in service </TITLE> \");\n>   out.println(\"Now i am throwing <b>UnavailableException</b> <BR> \");\n>   out.println(\" <HR> \");\n>   out.println(\" </BODY> \");\n>   out.println(\" </HTML> \" );\n>   out.flush();\n>   throw ( new UnavailableException(\"Unavailabale Exception in service of\n> Test29 \") );\n> \n>  }\n> \n>  public void destroy(  )\n>  {\n>   System.out.println(\"I am destroy method of Test29\");\n>   System.out.println(\"I should  be called whenever somebody try to\n> access the service method of this Servlet\");\n>  }\n> \n> \n> }\n>", "bug_id": 3209, "is_private": false, "id": 4694, "time": "2001-08-21T10:31:33Z", "creator": "jian.cai@sun.com", "creation_time": "2001-08-21T10:31:33Z", "tags": [], "attachment_id": null}, {"count": 1, "tags": [], "creator": "craig.mcclanahan@sun.com", "attachment_id": null, "text": "Fixed in nightly build 20010823.\n", "id": 4743, "time": "2001-08-22T14:31:32Z", "bug_id": 3209, "creation_time": "2001-08-22T14:31:32Z", "is_private": false}]