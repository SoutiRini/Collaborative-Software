[{"count": 0, "attachment_id": null, "creator": "somendra_99@yahoo.com", "is_private": false, "id": 54834, "time": "2004-03-29T20:06:20Z", "bug_id": 28031, "creation_time": "2004-03-29T20:06:20Z", "tags": [], "text": "I am trying to set a cell formula to =IF(ROUND(A2*B2*C2,2)>ROUND(B2*D2,2),ROUND\n(A2*B2*C2,2),ROUND(B2*D2,2))\nWhen the Excel workbook opens the value displayed is #Value!\nAny help would be appreciated,\nSomendra"}, {"count": 1, "tags": [], "creator": "josh@apache.org", "attachment_id": null, "id": 114590, "creation_time": "2008-03-13T08:52:57Z", "time": "2008-03-13T08:52:57Z", "bug_id": 28031, "text": "Looks like this was fixed a while ago.\nHere is a new junit test method just in case.\n\n    public void test_bug28031() {\n        HSSFWorkbook wb = new HSSFWorkbook();\n        HSSFSheet sheet = wb.createSheet();\n        wb.setSheetName(0, \"Sheet1\");\n        \n        HSSFRow row = sheet.createRow(0);\n        HSSFCell cell = row.createCell((short)0);\n        String formulaText = \"IF(ROUND(A2*B2*C2,2)>ROUND(B2*D2,2),ROUND(A2*B2*C2,2),ROUND(B2*D2,2))\";\n        cell.setCellFormula(formulaText);\n       \n        assertEquals(formulaText, cell.getCellFormula());\n        if(false) {\n            // this file can be inspected manually\n            try {\n                OutputStream os = new FileOutputStream(\"output28031.xls\");\n                wb.write(os);\n                os.close();\n            } catch (IOException e) {\n                throw new RuntimeException(e);\n            }\n        }\n    }\n\nTo be absolutely sure, I opened the file in Excel, and made sure the formula was correct there too.  I left that bit of the test disabled because I assume the rest of the test alone would have shown this bug.\n\n", "is_private": false}]