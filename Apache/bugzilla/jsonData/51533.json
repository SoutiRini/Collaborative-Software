[{"count": 0, "tags": [], "creator": "chris@agilabs.com", "text": "Changing sheet name on an Excel 2010 worksheet using XSSFWorksheet generates the following error during the XSSFormulaUtils.updateSheetName() method.\n\nNote:  'C' in first line was an unprintable character.\n\nParse error near char 0 'C' in specified formula ''. Expected cell ref or constant literal\n\tat org.apache.poi.ss.formula.FormulaParser.expected(FormulaParser.java:217)\n\tat org.apache.poi.ss.formula.FormulaParser.parseSimpleFactor(FormulaParser.java:1122)\n\tat org.apache.poi.ss.formula.FormulaParser.percentFactor(FormulaParser.java:1077)\n\tat org.apache.poi.ss.formula.FormulaParser.powerFactor(FormulaParser.java:1064)\n\tat org.apache.poi.ss.formula.FormulaParser.Term(FormulaParser.java:1424)\n\tat org.apache.poi.ss.formula.FormulaParser.additiveExpression(FormulaParser.java:1524)\n\tat org.apache.poi.ss.formula.FormulaParser.concatExpression(FormulaParser.java:1508)\n\tat org.apache.poi.ss.formula.FormulaParser.comparisonExpression(FormulaParser.java:1465)\n\tat org.apache.poi.ss.formula.FormulaParser.unionExpression(FormulaParser.java:1445)\n\tat org.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:1566)\n\tat org.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:174)\n\tat org.apache.poi.xssf.usermodel.helpers.XSSFFormulaUtils.updateFormula(XSSFFormulaUtils.java:125)\n\tat org.apache.poi.xssf.usermodel.helpers.XSSFFormulaUtils.updateSheetName(XSSFFormulaUtils.java:106)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.setSheetName(XSSFWorkbook.java:1130)\n\n\nThe XSSFFormulaUtils.updateFormula() method retrieves the string value of the cell's F-node (function), which returns a valid but empty string ('').  The NULL-check prior to attempting to parse the formula doesn't handle the empty string.  These empty F-node strings are generated on a shared formula cell.\n\nAn example of this cell is:\n\n<c r=\"E6\" s=\"22\">\n  <f t=\"shared\" si=\"0\" /> \n  <v>8</v> \n  </c>\n\nOther formula read and resolution methods correctly handle shared formula definitions.", "id": 148024, "time": "2011-07-20T01:23:59Z", "bug_id": 51533, "creation_time": "2011-07-20T01:23:59Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 51533, "text": "Fixed in r1148673, junit added. \n\nRegards,\nYegor", "id": 148029, "time": "2011-07-20T09:43:14Z", "creator": "yegor@dinom.ru", "creation_time": "2011-07-20T09:43:14Z", "is_private": false, "attachment_id": null}]