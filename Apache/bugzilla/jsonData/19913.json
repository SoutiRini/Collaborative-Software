[{"count": 0, "tags": [], "bug_id": 19913, "is_private": false, "text": "\"r->content_encoding\" should be checked to avoid compressing a compressed file,\nwhen an internal redirection occurs by mod_negotiation/mod_rewrite,\nor \"*.{html,txt,etc}.gz\" is requested directly.\n\n--- httpd-2.0/modules/filters/mod_deflate.c     Wed Mar 12 03:11:33 2003\n+++ httpd-2.0/modules/filters/mod_deflate.c     Wed May 14 14:55:40 2003\n@@ -340,6 +340,12 @@\n             encoding = apr_table_get(r->err_headers_out, \"Content-Encoding\");\n         }\n \n+        if (r->content_encoding) {\n+            encoding = encoding ? apr_pstrcat(r->pool, encoding, \",\",\n+                                              r->content_encoding, NULL)\n+                                : r->content_encoding;\n+        }\n+\n         if (encoding) {\n             const char *tmp = encoding;", "id": 37158, "time": "2003-05-14T07:09:22Z", "creator": "nazonazo@miobox.jp", "creation_time": "2003-05-14T07:09:22Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "Yes, you're right. I've just committed your patch and proposed it for backport\ninto the stable branch.\n\nThanks for your report and thanks for using Apache.", "attachment_id": null, "bug_id": 19913, "id": 37370, "time": "2003-05-16T23:16:00Z", "creator": "nd@perlig.de", "creation_time": "2003-05-16T23:16:00Z", "is_private": false}]