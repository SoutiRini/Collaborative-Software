[{"count": 0, "tags": [], "bug_id": 1607, "attachment_id": null, "text": "Some time between the release of 1.3 and current (5/3/2001) CVS, the 'tar' task\nhas changed behaviour. Let's say I want to tar up a 'src' directory:\n\nsrc/\nsrc/a.txt\nsrc/b.txt\n\nwith the following Ant build file:\n\n<?xml version=\"1.0\"?>\n<project name=\"tartest\" default=\"main\" basedir=\".\">\n  <target name=\"main\" description=\"Tar a directory\">\n    <tar tarfile=\"foo.tar\" basedir=\"src\"/>\n  </target>\n</project>\n\nHere's what happens:\n[jeff@kermit tartest]$\n/home/jeff/apache/jakarta/jakarta-ant/jakarta-ant-1.4alpha/bin/ant -version\nAnt version 1.4alpha compiled on May 3 2001\n[jeff@kermit tartest]$\n/home/jeff/apache/jakarta/jakarta-ant/jakarta-ant-1.4alpha/bin/ant\nBuildfile: build.xml\n\nmain:\n      [tar] Building tar: /home/jeff/tmp/ant/tartest/foo.tar\n\nBUILD SUCCESSFUL\n\nTotal time: 0 seconds\n[jeff@kermit tartest]$ \n[jeff@kermit tartest]$ tar tvf foo.tar \n-rw-r--r-- 0/0               0 2001-05-03 11:18:19 \n-rw-r--r-- 0/0              16 2001-05-03 11:12:06 a.txt\n-rw-r--r-- 0/0              16 2001-05-03 11:12:15 b.txt\n\n[jeff@kermit tartest]$ tar xvf foo.tar \n\ntar: : Cannot open: No such file or directory\na.txt\nb.txt\ntar: Error exit delayed from previous errors\n\n\nWhereas, If I do the same thing with Ant 1.3, it works:\n[jeff@kermit tartest]$ ant -version\nAnt version 1.3 compiled on March 2 2001\n[jeff@kermit tartest]$ ant\nBuildfile: build.xml\n\nmain:\n      [tar] Building tar: /home/jeff/tmp/ant/tartest/foo.tar\n\nBUILD SUCCESSFUL\n\nTotal time: 0 seconds\n[jeff@kermit tartest]$ tar xvf foo.tar  \na.txt\nb.txt\n\n\n(Actually, this is not the expected behaviour, as the command 'tar cvf foo.tar\nsrc/' would include the src/ dir in the tar, but anyway).\n\n\nA workaround is to explicitly list the directory to include and it's contents:\n\n[jeff@kermit tartest]$ cat build2.xml \n<?xml version=\"1.0\"?>\n<project name=\"tartest\" default=\"main\" basedir=\".\">\n\t<property name=\"src\" value=\"src\"/>\n\t<target name=\"main\" description=\"Tar a directory\">\n\t\t<tar tarfile=\"foo.tar\" basedir=\".\" includes=\"${src}/**\"/>\n\t</target>\n</project>\n[jeff@kermit tartest]$\n/home/jeff/apache/jakarta/jakarta-ant/jakarta-ant-1.4alpha/bin/ant -buildfile\nbuild2.xml \nBuildfile: build2.xml\n\nmain:\n      [tar] Building tar: /home/jeff/tmp/ant/tartest/foo.tar\n\nBUILD SUCCESSFUL\n[jeff@kermit tartest]$\n/home/jeff/apache/jakarta/jakarta-ant/jakarta-ant-1.4alpha/bin/ant -buildfile\nbuild2.xml \nBuildfile: build2.xml\n\nmain:\n      [tar] Building tar: /home/jeff/tmp/ant/tartest/foo.tar\n\nBUILD SUCCESSFUL\n\nTotal time: 0 seconds\n\n[jeff@kermit tartest]$ tar xvf foo.tar  \nsrc/\nsrc/a.txt\nsrc/b.txt\n\n\nThis may be related to bug 414\n(http://nagoya.apache.org/bugzilla/show_bug.cgi?id=414)\n\nThanks to those hardworking folks on ant-dev :)\n\n--Jeff", "id": 2214, "time": "2001-05-02T17:40:49Z", "creator": "jeff@socialchange.net.au", "creation_time": "2001-05-02T17:40:49Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 1607, "attachment_id": null, "is_private": false, "id": 2227, "time": "2001-05-03T05:30:20Z", "creator": "bodewig@apache.org", "creation_time": "2001-05-03T05:30:20Z", "text": "First of all, I could not reproduce this bug - but to be absolutely certain I've\ncommitted a patch (should be in the nightly of 2001-05-04) that ensures that we\nare never going to add \"\" to the archive."}, {"count": 2, "tags": [], "bug_id": 1607, "attachment_id": null, "id": 2249, "time": "2001-05-03T16:36:40Z", "creator": "jeff@socialchange.net.au", "creation_time": "2001-05-03T16:36:40Z", "is_private": false, "text": "Thanks Stefan! The patch you made fixes this for me too."}]