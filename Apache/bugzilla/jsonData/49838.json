[{"count": 0, "tags": [], "text": "I've confirmed this segmentation fault with a fresh build of 2.3.6-alpha, but initially discovered it when using a backport of mod_remoteip for 2.2.\n\nHere's the configure line I used for the 2.3.6-alpha build:\n\n./configure --with-included-apr --with-mpm=prefork\n\nTo reproduce after building from scratch, change the following in the stock httpd.conf:\n\n# Add these lines:\n<IfModule remoteip_module>\nRemoteIPHeader X-Client-IP\nRemoteIPInternalProxy 127.0.0.1\n</IfModule>\n\n# Allow override of \"Limit\" in htdocs\n<Directory \"/usr/local/apache2/htdocs\">\n    AllowOverride Limit\n</Directory>\n\n\nIn the docroot, create the .htaccess file:\n\n# The Allow/Deny can be any IP or subnet mask.  Removing the Allow/Deny\n# \"fixes\" the crash.  \"Allow from all\" won't crash either.\nOrder allow,deny\nAllow from 1.2.3.4\n\n\nStart up Apache, send it requests with \"X-Client-IP: 2.3.4.5\" (or whatever IP) in the request header, and watch the error log for segmentation faults.\n\nIn my testing, the crashes can sometimes be intermittent.  Freshly restarting Apache can help encourage segfaults when the bug is being \"stubborn\" to reproduce.", "is_private": false, "id": 139531, "creator": "voltara@gmail.com", "time": "2010-08-28T10:35:34Z", "bug_id": 49838, "creation_time": "2010-08-28T10:35:34Z", "attachment_id": null}, {"count": 1, "attachment_id": 25956, "bug_id": 49838, "text": "Created attachment 25956\nproposed bugfix\n\nFixes a bad memcpy in remoteip_modify_connection(), and adds some #error pragmas to two #ifdef REMOTEIP_OPTIMIZED blocks which (by visual inspection) have bit rot issues.", "id": 139532, "time": "2010-08-28T14:50:44Z", "creator": "voltara@gmail.com", "creation_time": "2010-08-28T14:50:44Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "text": "The segfault was fixed in r990745. The issues where you set the error pragmas have been fixed in r990746.", "is_private": false, "id": 139551, "creator": "rpluem@apache.org", "time": "2010-08-30T05:48:18Z", "bug_id": 49838, "creation_time": "2010-08-30T05:48:18Z", "attachment_id": null}]