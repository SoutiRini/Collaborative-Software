[{"count": 0, "tags": [], "creator": "bpinch@csc.com.au", "is_private": false, "text": "My initial symptoms were very similar to \nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=37006 ie \"pthread\" error \nwhen compiling under AIX 5.3 using gcc 3.3.2 This said gcc version too old, \nget a GCC for aix 5.3  from \nhttp://www-03.ibm.com/servers/aix/products/aixos/linux/ezinstall.html and \ninstall gcc, gcc plusplus, c++ libs and c++devel libs and then the errors are \ngone.....\n\nWhich I have, and after a make distclean, the _compilation_ under gcc worked \nbut I have an error I am unable to resolve with an undefined symbol with ld on \nAIX.\n\nMy compile/link/configure options for gcc/AIX 5.3 for a 64 bit compile are:-\n#CFLAGS=\"-maix64\"; export  CFLAGS; LDFLAGS=\"-maix64\"; export  LDFLAGS; \n#EXTRA_LDFLAGS_SHLIB=\"-b64\"; export  EXTRA_LDFLAGS_SHLIB; \n\nFor the archiving program (ar) I set the -Xany option in the *.tmpl files and \nagain in ./src/modules/standard/Makefile after  running ./configure\n\n#./configure --prefix=$PREFIX--enable-shared=max --enable-module=most --with-\nport=$PORT\n#make\n\nThe following is the error message without adding -bnoquiet to \nEXTRA_LDFLAGS_SHLIB.\n\nTarget \"default\" is up to date.\n<=== src/lib\n===> src/modules\n===> src/modules/standard\n        gcc -c  -I../../os/unix -I../../include   -DAIX=530 -U__STR__ -\nDAIX_BIND_PROCESSOR -DUSE_HSREGEX -maix64 `../../apaci` mod_so.c\n        rm -f libstandard.a\n        ar -Xany cr libstandard.a mod_so.o\n        ranlib libstandard.a\n        gcc -c  -I../../os/unix -I../../include   -DAIX=530 -U__STR__ -\nDAIX_BIND_PROCESSOR -DUSE_HSREGEX -maix64 `../../apaci` -fpic -DSHARED_MODULE \nmod_status.c && mv mod_status.o mod_status.lo\n        ld -H512 -T512 -bhalt:4 -bM:SRE -bnoentry -\nbI:../../support/httpd.exp  -bE:`echo mod_status.so|sed -e 's:\\.so$:.exp:'` -\nlc -b64 -o mod_status.so mod_status.lo\nld: 0711-317 ERROR: Undefined symbol: .__fixunssfdi\nld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more information.\nmake: The error code from the last command is 8.\n\n\nStop.\nmake: The error code from the last command is 1.\n<<\n\nwith loader option -bnoquiet\n\n>>\nILELIST: Number of previously inserted files processed: 2\n(ld): imports ../../support/httpd.exp\nIMPORTS: Symbols imported from import file ../../support/httpd.exp: 432\n(ld): exports mod_status.exp\nEXPORTS: Symbols exported: 1\n(ld): resolve\nRESOLVE: 195 of 3647 symbols were kept.\n(ld): addgl /usr/lib/glink64.o\nADDGL: Glink code added for 32 symbols.\n(ld): er full\nld: 0711-318 ERROR: Undefined symbols were found.\n        The following symbols are in error:\n Symbol                    Inpndx  TY CL Source-File(Object-File) OR Import-\nFile{Shared-object}\n                              RLD: Address  Section  Rld-type Referencing \nSymbol\n ------------------------------------------------------------------------------\n----------------\n .__fixunssfdi             [64]    ER PR mod_status.c(mod_status.lo)\n                                   0000240c .text    R_RBR    [100]   \n<.status_handler>\n                                   00002670 .text    R_RBR    [100]   \n<.status_handler>\nER: The return code is 8.\nmake: The error code from the last command is 8.\n<<\n\nAny suggestions/advice?\nBrian.", "id": 86295, "time": "2006-02-28T12:21:43Z", "bug_id": 38805, "creation_time": "2006-02-28T12:21:43Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "trawick@apache.org", "is_private": false, "text": "See http://people.apache.org/~trawick/apache13aix.html\n\nYou need to use the EXTRA_LDFLAGS_SHLIB to work around this gcc oddity.\n", "id": 86296, "time": "2006-02-28T12:30:12Z", "bug_id": 38805, "creation_time": "2006-02-28T12:30:12Z", "attachment_id": null}, {"count": 2, "tags": [], "text": "following the apache 1.3 on aix \nhttp://people.apache.org/~trawick/apache13aix.html note gave\n# find / -name \"libgcc.*\" -print\n./opt/freeware/lib/gcc-lib/powerpc-ibm-aix5.3.0.0/3.3.2/libgcc.a\n./opt/freeware/lib/gcc-lib/powerpc-ibm-aix5.3.0.0/3.3.2/ppc64/libgcc.a\n./opt/freeware/lib/gcc-lib/powerpc-ibm-aix5.3.0.0/3.3.2/pthread/libgcc.a\n./opt/freeware/lib/gcc-lib/powerpc-ibm-aix5.3.0.0/3.3.2/pthread/ppc64/libgcc.a\n\nSo somethings similar to the following were tried including just one -lgcc\n\n#EXTRA_LDFLAGS_SHLIB=\"-b64 -L/opt/freeware/lib/gcc-lib/powerpc-ibm-\naix5.3.0.0/3.3.2 -lgcc -L/opt/freeware/lib/gcc-lib/powerpc-ibm-\naix5.3.0.0/3.3.2/ppc64 -lgcc -L/opt/freeware/lib/gcc-lib/powerpc-ibm-\naix5.3.0.0/3.3.2/pthread -lgcc -L/opt/freeware/lib/gcc-lib/powerpc-ibm-\naix5.3.0.0/3.3.2/pthread/ppc64  -lgcc\"; export  EXTRA_LDFLAGS_SHLIB; echo \n$EXTRA_LDFLAGS_SHLIB\n\n\nThe ld error remained in that the symbol remained unresolved.\n\nHowever, adding to the still undefined symbol to __fixunssfdi (there was only \none) to src/support/httpd.exp as explained in \nhttp://people.apache.org/~trawick/apache13aix.html allowed apache to link and \nsubsequently start as a webserver.\n\nThanks\nBrian\n\n\n\n\n\n\n", "attachment_id": null, "bug_id": 38805, "id": 86429, "time": "2006-03-03T04:17:38Z", "creator": "bpinch@csc.com.au", "creation_time": "2006-03-03T04:17:38Z", "is_private": false}, {"count": 3, "tags": [], "text": "\n  Try the link flag --static-libgcc and report back if this works.\n  I'm unsure if this flag is libtool specific or generally applicable\n  to any gcc compilation.\n", "attachment_id": null, "bug_id": 38805, "id": 86430, "time": "2006-03-03T04:32:39Z", "creator": "wrowe@apache.org", "creation_time": "2006-03-03T04:32:39Z", "is_private": false}, {"count": 4, "tags": [], "text": "As a link option the following is not permitted\n\nEXTRA_LDFLAGS_SHLIB=\"-b64  -static-libgcc\"; export  EXTRA_LDFLAGS_SHLIB; echo \n$EXTRA_LDFLAGS_SHLIB\n\nAs a CFLAGS option it is apparently permitted\nCFLAGS=\"-maix64 -static-libgcc\"; export  CFLAGS; echo $CFLAGS\n\nBut it still came up with same error \n\nie Undefined symbol: .__fixunssfdi, still requiring adding to the apache \nsymbols file to allow to link edit.\n\nRegards\nBrian\n", "is_private": false, "id": 87001, "creator": "bpinch@csc.com.au", "time": "2006-03-19T13:18:40Z", "bug_id": 38805, "creation_time": "2006-03-19T13:18:40Z", "attachment_id": null}]