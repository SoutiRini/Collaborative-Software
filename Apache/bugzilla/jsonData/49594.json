[{"count": 0, "tags": [], "creator": "vlad.balan@gmail.com", "is_private": false, "text": "Hello,\n\nant 1.8.1.\n\nA) i'm getting \n\njava.lang.NullPointerException for the apply task when the attribute parallel=\"yes\" and a \"redirector\" sub-element is present.\nWith parallel=no and redirector present it works fine.\n\nB) what is the exepcted behaviour of a nested outputmapper in the redirector sub-element ( i.e. a per file output for the command) when parallel=yes (i.e. the command would be executed one time with the concatenated list of files at the end of the command)\nThe doc does not specifies this.\nThis is why i'm using a \"constant\" redirector by the means of the \"input\" attribute of the redirector element, rather than nesting any \"outputmapper\".\n\n\nThis is my file with \"cmd_files\" target:\n\n\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\n<project>\n\n\t<patternset id=\"slash\">\n\t\t<include name=\"test/\" />\n\t</patternset>\n\n\n\t<fileset id=\"filmeFiles\" dir=\"d:/kits\">\n\t\t<patternset refid=\"slash\" />\n\t</fileset>\n\n\t<target name=\"echo\">\n\t\t<echo>Content of filmeFiles: ${toString:filmeFiles}</echo>\n\t</target>\n\n\t<target name=\"cmd_files\" depends=\"echo\">\n\t\t<apply dir=\"d:/kits\" dest=\"d:/kits\" executable=\"cmd\" parallel=\"yes\" addsourcefile=\"yes\">\n\t\t\t<arg value=\"/c\">\n\t\t\t</arg>\n\t\t\t<arg value=\"echo\">\n\t\t\t</arg>\n\t\t\t<targetfile />\n\t\t\t<fileset refid=\"filmeFiles\">\n\t\t\t</fileset>\n\t\t\t<globmapper from=\"*.txt\" to=\"*_alfa.txt\" handledirsep=\"yes\" />\n\t\t\t<redirector output=\"d:\\kits\\test\\output\\all_out.txt\" append=\"yes\" />\n\t\t</apply>\n\t</target>\n\n</project>", "id": 138426, "time": "2010-07-14T16:15:35Z", "bug_id": 49594, "creation_time": "2010-07-14T16:15:35Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 49594, "attachment_id": null, "text": "when using parallel mode the redirector is instantiated once per \"batch\" of files\nthat get processed and null is passed in as a source file.", "id": 138919, "time": "2010-08-05T15:45:37Z", "creator": "bodewig@apache.org", "creation_time": "2010-08-05T15:45:37Z", "is_private": false}, {"count": 2, "text": "hello, thanks for the reply but what are you suggesting in fact?\nyou agree it is a bug?", "creator": "vlad.balan@gmail.com", "is_private": false, "id": 138920, "time": "2010-08-05T15:51:38Z", "bug_id": 49594, "creation_time": "2010-08-05T15:51:38Z", "tags": [], "attachment_id": null}, {"text": "It is a bug and I've fixed it locally - just running the full test suite right now.\n\nPassing in null as source file is not a bug, that was my answer to your question B.\n\nYou can work around the bug by setting maxparallel to a value > 0.", "tags": [], "creator": "bodewig@apache.org", "is_private": false, "count": 3, "id": 138925, "time": "2010-08-05T16:34:42Z", "bug_id": 49594, "creation_time": "2010-08-05T16:34:42Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "bodewig@apache.org", "is_private": false, "text": "behavior documented, bug fixed in svn revision 982773", "id": 138928, "time": "2010-08-05T16:46:02Z", "bug_id": 49594, "creation_time": "2010-08-05T16:46:02Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "vlad.balan@gmail.com", "text": "So A) is a bug but for B) i still don't understand how your replies relate to\nB).\nThe question B) is about the extepcted behaviour of a nested outputmapper in\nredirector when parallel=true. What would happen. Pls.put it another way for me to understand :)\n\n(by the way pls. what is the link to the freshly added doc)", "id": 138929, "time": "2010-08-05T16:49:58Z", "bug_id": 49594, "creation_time": "2010-08-05T16:49:58Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 49594, "text": "(In reply to comment #5)\n\n> The question B) is about the extepcted behaviour of a nested outputmapper in\n> redirector when parallel=true. What would happen.\n\nit depends on the mapper, just like it does for exec in general.  The manual\npage for exec says\n\n| Any file mapping is done using a null sourcefile; therefore not\n| all Mapper types will return results. When no results are\n| returned, redirection specifications will fall back to the task\n| level attributes.\n\nand the same is true for apply when parallel is true.\n\n> (by the way pls. what is the link to the freshly added doc)\n\nfollow the subversion revision link and you can see the changes.\nI haven't updated the online manual, the full page would\nbe http://svn.apache.org/viewvc/ant/core/trunk/docs/manual/Tasks/apply.html?revision=982773&view=co&pathrev=982773", "id": 138942, "attachment_id": null, "creator": "bodewig@apache.org", "creation_time": "2010-08-05T23:55:22Z", "time": "2010-08-05T23:55:22Z", "is_private": false}]