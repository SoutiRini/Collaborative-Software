[{"attachment_id": null, "tags": [], "bug_id": 43701, "text": "this is my NIO Connector configuration in server.xml \n<Connector acceptCount=\"100\" enableLookups=\"false\" port=\"80\"\nprotocol=\"org.apache.coyote.http11.Http11NioProtocol\" \n      acceptorThreadCount=\"2\" socket.bufferPool=\"-1\" connectionTimeout=\"60000\"\nmaxKeepAliveRequests=\"-1\" maxThreads=\"200\"\n      minSpareThreads=\"25\" redirectPort=\"8443\" />\n\nwhen I am starting my tomcat it is giving following error in the console several\ntime \nSEVERE: \njava.lang.NullPointerException\n\tat org.apache.tomcat.util.net.NioEndpoint.setSocketOptions(NioEndpoint.java:985)\n\tat org.apache.tomcat.util.net.NioEndpoint$Acceptor.run(NioEndpoint.java:1169)\n\tat java.lang.Thread.run(Thread.java:595)", "count": 0, "id": 109774, "time": "2007-10-26T03:01:21Z", "creator": "singh.prabhat@gmail.com", "creation_time": "2007-10-26T03:01:21Z", "is_private": false}, {"count": 1, "tags": [], "creator": "singh.prabhat@gmail.com", "text": "One more important thing I missed out .\nThe condition when this bug is comming is if there is any preexisting connection\nwhich is trying to connect to the server but server is down and when I start it\nagain it will give this error.", "id": 109776, "time": "2007-10-26T03:47:05Z", "bug_id": 43701, "creation_time": "2007-10-26T03:47:05Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 43701, "attachment_id": null, "text": "I've stumbled upon this bug too.\nLooks like it is being caused by the race condition between the main thread and \nthe newly created acceptor thread. I'm getting this error quite often on my \nCore 2 Duo/WinXP 32-bit/Java 6u02.\n\nI think that's what happens here:\n1) Acceptor thread is started at NioEndpoint:792;\n2) Main thread allocates the pollers array (initially filled with nulls) at \nNioEndpoint:796;\n3) Acceptor thread immediately catches an incoming connection and accesses the \nstill uninitialized pollers array (inside the setSocketOptions method called at \nNioEndpoint:1169).\n\nSeems that poller threads should be created before starting acceptors; also, \npoller-related fields shall be marked volatile.", "id": 109976, "time": "2007-10-30T14:22:41Z", "creator": "pzuev@naumen.ru", "creation_time": "2007-10-30T14:22:41Z", "is_private": false}, {"count": 3, "tags": [], "creator": "pzuev@naumen.ru", "attachment_id": null, "id": 109979, "time": "2007-10-30T14:29:38Z", "bug_id": 43701, "creation_time": "2007-10-30T14:29:38Z", "is_private": false, "text": "Http11AprProtocol has the same bug."}, {"count": 4, "tags": [], "bug_id": 43701, "attachment_id": null, "text": "Filip fixed this for 6.0.15 onwards. APR was fixed even earlier.", "id": 115579, "time": "2008-04-13T15:21:02Z", "creator": "markt@apache.org", "creation_time": "2008-04-13T15:21:02Z", "is_private": false}]