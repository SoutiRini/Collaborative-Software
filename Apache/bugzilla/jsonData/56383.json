[{"count": 0, "tags": [], "bug_id": 56383, "attachment_id": 31507, "id": 174442, "time": "2014-04-10T14:01:12Z", "creator": "thrain123@gmail.com", "creation_time": "2014-04-10T14:01:12Z", "is_private": false, "text": "Created attachment 31507\nPatch for ErrorReportValve\n\nWhen the default error valve returns its report it publishes the tomcat version and some other troubleshooting data. This of course breaks security standards at some companies and also is published as a item that needs to be remediated when hardening tomcat(OWASP - goo.gl/Zr9xso ). When using the OWASP solution of replacing the serverInfo.properties file it can and will break tools/code that uses that information. \n\nAttached is the proposed enhancement to be able switch options to show minimal information back.\n\nBy adding the below will only return a html page with only the status. No CSS or title\n<Valve className=\"org.apache.catalina.valves.ErrorReportValve\" showReport=\"false\" showServerInfo=\"false\" />\n\nCurrently, default is true for both so if users still want to see the current report nothing will have to change in there server.xml"}, {"count": 1, "tags": [], "creator": "knst.kolinko@gmail.com", "is_private": false, "id": 174457, "creation_time": "2014-04-10T16:57:28Z", "time": "2014-04-10T16:57:28Z", "bug_id": 56383, "text": "Comment on attachment 31507\nPatch for ErrorReportValve\n\n1. Add getter methods?\n\n2. Expose new attributes via JMX? \n(Update mbeans-descriptors.xml file in the same package)\n\n3. Documentation?\n\n(Update webapps/docs/config/valve.xml. A bit more work than usually, because ErrorReporValve is not documented there at all)", "attachment_id": 31507}, {"count": 2, "tags": [], "bug_id": 56383, "attachment_id": 31510, "id": 174462, "time": "2014-04-11T04:23:48Z", "creator": "thrain123@gmail.com", "creation_time": "2014-04-11T04:23:48Z", "is_private": false, "text": "Created attachment 31510\nPatch for ErrorReportValve_02\n\nAdded \n*Getter methods\n*Exposed new attributes via JMX? \n*Updated Documentation"}, {"count": 3, "tags": [], "bug_id": 56383, "attachment_id": 31529, "id": 174596, "time": "2014-04-15T14:19:54Z", "creator": "thrain123@gmail.com", "creation_time": "2014-04-15T14:19:54Z", "is_private": false, "text": "Created attachment 31529\nPatch for ErrorReportValve_03\n\nChanged the variables to protected from private"}, {"count": 4, "tags": [], "bug_id": 56383, "attachment_id": null, "id": 174805, "time": "2014-04-23T13:34:02Z", "creator": "thrain123@gmail.com", "creation_time": "2014-04-23T13:34:02Z", "is_private": false, "text": "Do i need to provide a patch for tomcat 6 and 8?"}, {"count": 5, "tags": [], "creator": "violetagg@apache.org", "attachment_id": null, "id": 174828, "creation_time": "2014-04-24T07:35:50Z", "time": "2014-04-24T07:35:50Z", "bug_id": 56383, "text": "Hi,\n\nI see that you are removing the CSS when showReport is false. Why is that?\n\nWhen showServerInfo is false you are removing the whole footer. Why is that? You can remove only the text so that the page stays with the same look and feel.\n\nRegards\nVioleta", "is_private": false}, {"count": 6, "tags": [], "creator": "thrain123@gmail.com", "is_private": false, "text": "My first patch did actually keep the css. However, after talking more with my team at work and looking at what the TomEE team has done(doesn't have css as well), it was determined if i left it you would then know its tomcat so you would still have a possible security issue.\n\nI just want to note you have to set both settings to false to remove the css. if you just disable the version you will see the css for the report part.", "id": 174855, "time": "2014-04-24T18:27:41Z", "bug_id": 56383, "creation_time": "2014-04-24T18:27:41Z", "attachment_id": null}, {"count": 7, "tags": [], "creator": "violetagg@apache.org", "attachment_id": null, "text": "Thanks for the report and the patch. This has been fixed in trunk for 8.0.6 and in 7.0.x for 7.0.54 onwards.", "id": 174873, "time": "2014-04-25T11:16:19Z", "bug_id": 56383, "creation_time": "2014-04-25T11:16:19Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 56383, "attachment_id": null, "id": 174906, "time": "2014-04-27T17:08:56Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2014-04-27T17:08:56Z", "is_private": false, "text": "When both showServerInfo and showReport are false, the generated HTML will have no <title> element. If I remember the specs correctly a <title> is required.\n\nA good alternative will be\n\nsb.append(smClient.getString(\"errorReportValve.statusHeader\",\n                String.valueOf(statusCode), message))\n\n// errorReportValve.statusHeader=HTTP Status {0} - {1}"}, {"count": 9, "tags": [], "bug_id": 56383, "attachment_id": null, "id": 174907, "time": "2014-04-27T18:19:32Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2014-04-27T18:19:32Z", "is_private": false, "text": "(In reply to Konstantin Kolinko from comment #8)\n\nFixed, will be in 8.0.6 and 7.0.54.\n\nI went with the standard title \"Error report\".\n\nWhen I tried repeating the header text in the title, it looked bad for 404 errors."}, {"count": 10, "tags": [], "text": "*** Bug 52751 has been marked as a duplicate of this bug. ***", "attachment_id": null, "id": 175108, "creator": "violetagg@apache.org", "time": "2014-05-08T11:32:27Z", "bug_id": 56383, "creation_time": "2014-05-08T11:32:27Z", "is_private": false}]