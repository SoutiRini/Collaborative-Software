[{"count": 0, "tags": [], "bug_id": 41407, "text": "I tried to config my webapp to authenticate user by CLIENT-CERT auth method.\n\nI verified my JAAS LoginModule by using \"BASIC\" to auth method and successfully \nauthenticated user login.\n\nAfter studying Tomcat 5.5.20 source, I found that the problem is caused by the \nRealmBase.java and JAASRealm.java.\n\nif CLIENT-CERT auth method is used, SSLAuthenticator will call the :\n\n  JAASRealm.authenticate(X509Certificate certs[])\n\nAs JAASRealm didn't override authenticate(X509Certificate certs[]), RealmBase's \nauthenticate will be used and it will only validate the certs and then call\ngetPrincipal(X509Certificate) and then getPrincipal(String) is being called to \nget the Principal. However, in JAASRealm, this function always return null.\n\nThat means Tomcat can't use JAASRealm with CLIENT-CERT auth method.\n\nThanks\nButler", "id": 98244, "time": "2007-01-18T18:33:49Z", "creator": "tears.the@gmail.com", "creation_time": "2007-01-18T18:33:49Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 41407, "text": "\nYou try to do authorization with client certs?\nI'm afraid this is not implemented tomcat's JAASRealm.\n\nI am sure it is possible to create an extended JAASRealm2 which is\nable to provide full JAAS functionality with client certs also.\nThe way to do it could be:\n1. Implement authenticate(X509Certificate certs[]) just like\n   the user/pwd-authenticate in JAASrealm.\n2. Add an appropriate CallbackHandler for the cert chain\n   to pass the certificates to the custom LoginModule.\n\nThe custom authorization stuff has to go to the LoginModule\nso the new JAASRealm2 should be finished.\n\nPlease let me know if you plan to implement it.", "id": 98259, "time": "2007-01-19T05:37:17Z", "creator": "rm@moosauer.de", "creation_time": "2007-01-19T05:37:17Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 41407, "text": "This has been fixed in trunk and proposed for 5.5.x and 6.0.x", "id": 119642, "time": "2008-08-09T07:36:19Z", "creator": "markt@apache.org", "creation_time": "2008-08-09T07:36:19Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 41407, "attachment_id": null, "text": "This has been committed for 6.0.x and will be in 6.0.19 onwards.", "id": 120416, "time": "2008-09-06T13:02:03Z", "creator": "markt@apache.org", "creation_time": "2008-09-06T13:02:03Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 41407, "attachment_id": null, "text": "This has been fixed in 5.5.x and will be included in 5.5.28 onwards.", "id": 125684, "time": "2009-03-22T10:03:44Z", "creator": "markt@apache.org", "creation_time": "2009-03-22T10:03:44Z", "is_private": false}]