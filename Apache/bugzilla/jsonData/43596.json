[{"count": 0, "tags": [], "text": "This patch adds new configuration directive named \"ChrootDir\".\nFor example: ChrootDir /var/www-chroot\n\nChroot is called before changing to the non-privileged user.\n. . . \n   if( NULL != unixd_config.chroot_dir ) {\n        if(geteuid()) {\n            ap_log_error(APLOG_MARK, APLOG_ALERT,errno,NULL,\n            \"Cannot chroot when not started as root\");\n            return -1;\n        }\n        if( chdir( unixd_config.chroot_dir ) != 0 ) {\n            ap_log_error(APLOG_MARK, APLOG_ALERT, errno,NULL,\n                  \"Can't chdir to %s\", unixd_config.chroot_dir);\n            return -1;\n        }\n        if( chroot( unixd_config.chroot_dir ) != 0 ) {\n            ap_log_error(APLOG_MARK, APLOG_ALERT, errno,NULL,\n                    \"Can't chroot to %s\", unixd_config.chroot_dir);\n            return -1;\n        }\n        if( chdir( \"/\" ) != 0 ) {\n            ap_log_error(APLOG_MARK, APLOG_ALERT, errno,NULL,\n                  \"Can't chdir to new root\");\n            return -1;\n        }\n    }\n\n. . . \n     setuid(unixd_config.user_id) == -1))\n. . . \n\nI use this patch from version 2.0.50 to 2.2.6 and have no problems.", "attachment_id": null, "bug_id": 43596, "id": 109229, "time": "2007-10-11T03:30:34Z", "creator": "mitko@banksoft-bg.com", "creation_time": "2007-10-11T03:30:34Z", "is_private": false}, {"count": 1, "tags": [], "text": "Created attachment 20957\nhttpd-2.2.6-chroot.patch", "attachment_id": 20957, "bug_id": 43596, "id": 109230, "time": "2007-10-11T03:31:39Z", "creator": "mitko@banksoft-bg.com", "creation_time": "2007-10-11T03:31:39Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 43596, "is_private": false, "text": "I wrote a similar patch but it has not been accepted (yet). Maybe people are \nnot that concerced about security as I am. I hope the best for your patch.", "id": 109324, "time": "2007-10-13T11:37:05Z", "creator": "csad3962@uibk.ac.at", "creation_time": "2007-10-13T11:37:05Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 43596, "is_private": false, "text": "Keep in mind http://it.slashdot.org/article.pl?sid=07/09/27/2256235\n\nIf you are submitting this as a security necessity, you are already off base.\n\nNot disputing that chroot is not useful, but it should not be viewed as any\nsecurity 'feature'.", "id": 109325, "time": "2007-10-13T12:25:17Z", "creator": "wrowe@apache.org", "creation_time": "2007-10-13T12:25:17Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "nick@webthing.com", "attachment_id": null, "id": 120461, "time": "2008-09-08T07:53:54Z", "bug_id": 43596, "creation_time": "2008-09-08T07:53:54Z", "is_private": false, "text": "*** Bug 42341 has been marked as a duplicate of this bug. ***"}, {"count": 5, "tags": [], "creator": "nick@webthing.com", "attachment_id": null, "is_private": false, "id": 120462, "time": "2008-09-08T07:56:28Z", "bug_id": 43596, "creation_time": "2008-09-08T07:56:28Z", "text": "in trunk, and in the pipeline for backport unless someone vetos it."}, {"count": 6, "tags": [], "bug_id": 43596, "attachment_id": null, "text": "I am really happy with the progress of this patch.\n\nActually, I do see chroot as a security feature. Of course it is only usefull with a non privileged user but anyone using apache as root does not show any sense for security.\n\nCombining this patch with a peruser-like mpm will additionally improve webserver security for virtual hosters enormously.", "id": 120480, "time": "2008-09-08T14:27:57Z", "creator": "csad3962@uibk.ac.at", "creation_time": "2008-09-08T14:27:57Z", "is_private": false}, {"count": 7, "tags": [], "text": "\"Actually, I do see chroot as a security feature\"\n\nI'm sorry, but please refer to the authors and maintainers\nof chroot() functionality... who expressly disclaim that this\nshould be interpreted as a security measure.", "is_private": false, "bug_id": 43596, "id": 120482, "time": "2008-09-08T16:17:58Z", "creator": "wrowe@apache.org", "creation_time": "2008-09-08T16:17:58Z", "attachment_id": null}, {"count": 8, "tags": [], "text": "Please read the whole story. It is about being able to escape from chroot as root. Even Alan Cox himself tells us, that it is only about this. As a normal user you do not have the right to use chroot at all. That is why using chroot in combination with a non-privileged user is and will ever be a security feature.\n\nWhy do so many server application support chroot? Do you think they have implemented support for chroot because it is only a \"nice to have\"-feature?\n\nMany people use third party php projects (like phpbb). Some of them have security flaws that could be prevented by using chroot. This would e.g. stop the spread of worms.\nUsing chroot it is not possible for an attacker to get any kind of remote shell access, because there is simply no shell in the chroot tree.\n\nOf course using chroot is not an excuse for not updating your software. But as e.g. grsec is neither an excuse, it is a method to give the system administrators time to update their software by preventing security flaws from being exploited.", "attachment_id": null, "bug_id": 43596, "id": 120497, "time": "2008-09-09T05:34:24Z", "creator": "csad3962@uibk.ac.at", "creation_time": "2008-09-09T05:34:24Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "rpluem@apache.org", "is_private": false, "count": 9, "id": 121561, "time": "2008-10-15T12:54:23Z", "bug_id": 43596, "creation_time": "2008-10-15T12:54:23Z", "text": "Backported to 2.2.10"}]