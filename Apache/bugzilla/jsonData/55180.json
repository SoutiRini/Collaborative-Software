[{"count": 0, "tags": [], "text": "I configured server.xml like this:\nconnectionTimeout=\"-1\" disableUploadTimeout=\"false\" connectionUploadTimeout=\"200\"\n(maybe it is stupid to configure like this,if connectionTimeout=-1,can i make disableUploadTimeout=false?).\nIt will cause :\n\njava.lang.IllegalArgumentException: timeout can't be negative\n\tat sun.nio.ch.SocketAdaptor.setSoTimeout(SocketAdaptor.java:361)\n\tat org.apache.coyote.http11.Http11NioProcessor.setSocketTimeout(Http11NioProcessor.java:251)\n......\nbecause of :\n      if (!disableUploadTimeout) {\n//endpoint.getSoTimeout()=-1.\n           setSocketTimeout(endpoint.getSoTimeout());\n       }\n\n~~~~~~~~~~~~~~~~~~~~~~~~~\nanother thing:\nif i configure connectionTimeout=\"0\". \nin NioBlockingSelector.read(ByteBuffer buf, NioChannel socket, long readTimeout),readTimeout = 0, in case socket.read(buf) == 0, it make timeout=true.\nif (readTimeout >= 0 && (keycount == 0))\n    timedout = (System.currentTimeMillis() - time) >= readTimeout;\nthen throw the SocketTimeoutException().\n\nthank you.", "is_private": false, "id": 168211, "creation_time": "2013-07-02T00:01:40Z", "time": "2013-07-02T00:01:40Z", "creator": "jmwmj208@163.com", "bug_id": 55180, "attachment_id": null}, {"count": 1, "attachment_id": 30519, "bug_id": 55180, "is_private": false, "id": 168215, "time": "2013-07-02T02:16:35Z", "creator": "thrain123@gmail.com", "creation_time": "2013-07-02T02:16:35Z", "tags": [], "text": "Created attachment 30519\nfix\n\nAttached the patch to fix the first issue. \n\nMight need to discuss why it was chose to make -1 the infiniti timeout. When in the socket class 0 is infiniti. I'm sure there is good reason. Just a thought."}, {"count": 2, "tags": [], "text": "Hi,\n\nThanks for the report and the patch. It was applied to trunk and 7.0.x and will be included in 7.0.42 onwards.\n\n\nFor the second problem you are facing Bug 55160. Instead of connectionUploadTimeout, connectionTimeout was set as readTimeout.\n\nRegards\nVioleta", "is_private": false, "id": 168216, "creation_time": "2013-07-02T07:39:48Z", "time": "2013-07-02T07:39:48Z", "creator": "violetagg@apache.org", "bug_id": 55180, "attachment_id": null}, {"count": 3, "tags": [], "text": "excuse me, I think the second problem is different from the bug 55160.\nbecause when connectionTimeout=\"0\" disableUploadTimeout=\"true\".\nit will always throw socketTimeoutException if read ==0 (socket.read(buf)).\nThank you very much for your fixing.", "is_private": false, "id": 168241, "creation_time": "2013-07-03T00:23:54Z", "time": "2013-07-03T00:23:54Z", "creator": "jmwmj208@163.com", "bug_id": 55180, "attachment_id": null}, {"count": 4, "tags": [], "text": "(In reply to Roger Wang from comment #3)\n> excuse me, I think the second problem is different from the bug 55160.\n> because when connectionTimeout=\"0\" disableUploadTimeout=\"true\".\n> it will always throw socketTimeoutException if read ==0 (socket.read(buf)).\n> Thank you very much for your fixing.\n\nPlease open a new bug for this particular problem.\n\nThanks\nVioleta", "is_private": false, "id": 168248, "creator": "violetagg@apache.org", "time": "2013-07-03T04:09:21Z", "bug_id": 55180, "creation_time": "2013-07-03T04:09:21Z", "attachment_id": null}]