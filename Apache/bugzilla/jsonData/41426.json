[{"count": 0, "tags": [], "text": "In my tests, FOP 0.93 dies with a ClassCastException in\norg.apache.fop.layoutmgr.FlowLayoutManager.getNextKnuthElements:\n\n21.01.2007 15:34:58 org.apache.fop.cli.Main startFOP\nSCHWERWIEGEND: Exception\njava.lang.ClassCastException\n\tat org.apache.fop.cli.InputHandler.transformTo(InputHandler.java:168)\n\tat org.apache.fop.cli.InputHandler.renderTo(InputHandler.java:115)\n\tat org.apache.fop.cli.Main.startFOP(Main.java:160)\n\tat org.apache.fop.cli.Main.main(Main.java:191)\n\n---------\n\njava.lang.ClassCastException\n\tat\norg.apache.fop.layoutmgr.FlowLayoutManager.getNextKnuthElements(FlowLayoutManager.java:76)\n\tat\norg.apache.fop.layoutmgr.PageSequenceLayoutManager$PageBreaker.getNextKnuthElements(PageSequenceLayoutManager.java:272)\n\tat\norg.apache.fop.layoutmgr.AbstractBreaker.getNextBlockList(AbstractBreaker.java:554)\n\tat\norg.apache.fop.layoutmgr.PageSequenceLayoutManager$PageBreaker.getNextBlockList(PageSequenceLayoutManager.java:264)\n\tat org.apache.fop.layoutmgr.AbstractBreaker.doLayout(AbstractBreaker.java:301)\n\tat org.apache.fop.layoutmgr.AbstractBreaker.doLayout(AbstractBreaker.java:263)\n\tat\norg.apache.fop.layoutmgr.PageSequenceLayoutManager.activateLayout(PageSequenceLayoutManager.java:157)\n\tat org.apache.fop.area.AreaTreeHandler.endPageSequence(AreaTreeHandler.java:385)\n\tat org.apache.fop.fo.pagination.PageSequence.endOfNode(PageSequence.java:148)\n\tat org.apache.fop.fo.FOTreeBuilder$MainFOHandler.endElement(FOTreeBuilder.java:378)\n\tat org.apache.fop.fo.FOTreeBuilder.endElement(FOTreeBuilder.java:194)\n\tat\norg.apache.xalan.transformer.TransformerIdentityImpl.endElement(TransformerIdentityImpl.java:1050)\n\tat org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)\n\tat org.apache.xerces.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown Source)\n\tat\norg.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown\nSource)\n\tat org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown\nSource)\n\tat org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n\tat org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n\tat org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\n\tat org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)\n\tat org.apache.xerces.jaxp.SAXParserImpl$JAXPSAXParser.parse(Unknown Source)\n\tat\norg.apache.xalan.transformer.TransformerIdentityImpl.transform(TransformerIdentityImpl.java:452)\n\tat org.apache.fop.cli.InputHandler.transformTo(InputHandler.java:165)\n\tat org.apache.fop.cli.InputHandler.renderTo(InputHandler.java:115)\n\tat org.apache.fop.cli.Main.startFOP(Main.java:160)\n\tat org.apache.fop.cli.Main.main(Main.java:191)\n\n(will attach test file)", "is_private": false, "id": 98317, "creator": "julian.reschke@gmx.de", "time": "2007-01-21T06:35:20Z", "bug_id": 41426, "creation_time": "2007-01-21T06:35:20Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 41426, "attachment_id": 19439, "id": 98318, "time": "2007-01-21T06:37:39Z", "creator": "julian.reschke@gmx.de", "creation_time": "2007-01-21T06:37:39Z", "is_private": false, "text": "Created attachment 19439\nTest case\n\nThis test input shows the bug, when run under JDK 1.4, producing PDF output."}, {"count": 2, "text": "I reported this problem with one of the fop examples\n(examples/fo/advanced/cid-fonts.fo) last week.  The following patch fix the\nexception.\n\n--- snip ---\n\nC:/workspace/fop/src/java/org/apache/fop/layoutmgr/FlowLayoutManager.java\n===================================================================\n---\nC:/workspace/fop/src/java/org/apache/fop/layoutmgr/FlowLayoutManager.java\n(revision 497065)\n+++\nC:/workspace/fop/src/java/org/apache/fop/layoutmgr/FlowLayoutManager.java\n(working copy)\n@@ -69,11 +69,11 @@\n         int flowBPD = (int) getCurrentPV().getBodyRegion().getBPD();\n\n         // currently active LM\n-        BlockLevelLayoutManager curLM;\n+        LayoutManager curLM;\n         LinkedList returnedList;\n         LinkedList returnList = new LinkedList();\n\n-        while ((curLM = ((BlockLevelLayoutManager) getChildLM())) !=\nnull) {\n+        while ((curLM = getChildLM()) != null) {\n             if (curLM instanceof InlineLevelLayoutManager) {\n                 log.error(\"inline area not allowed under flow -\nignoring\");\n                 curLM.setFinished(true);\n\n--- snip ---\n\nAdrian", "bug_id": 41426, "attachment_id": null, "id": 98320, "time": "2007-01-21T07:27:38Z", "creator": "fop-dev@cumiskey.com", "creation_time": "2007-01-21T07:27:38Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 41426, "attachment_id": null, "id": 98321, "time": "2007-01-21T07:34:08Z", "creator": "fop-dev@cumiskey.com", "creation_time": "2007-01-21T07:34:08Z", "is_private": false, "text": "I am new to the Apache FOP project and do not have commit rights yet so have\nreassiged this bug to owner."}, {"count": 4, "attachment_id": null, "bug_id": 41426, "text": "Patch applied. Thanks, Adrian!\nhttp://svn.apache.org/viewvc?view=rev&rev=498835\n\nPlease note that while Adrian's fix removes the ugly ClassCastException,\nfo:wrapper will still not fully work as expected. You can use it to set\ninheritable properties but setting an \"id\" attribute will not have the desired\neffect. It will simply be ignored. The test wrapper_block_id.xml shows this.\n\nSo, Julian, you will not be able to use fo:wrapper like you did in your example\nfile for now. Please use an empty fo:block instead.\n\nI'm not sure how best to solve the \"id\" problem. Maybe something with an LM\nchecking whether its parent is a wrapper. Suggestions welcome. Anyway, I'm\nclosing this bug as this was about the ClassCastException and we're rid of that.", "id": 98377, "time": "2007-01-22T14:42:42Z", "creator": "jeremias@apache.org", "creation_time": "2007-01-22T14:42:42Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "creator": "adelmelle@apache.org", "attachment_id": null, "text": "FYI: Adrian recently discovered that one of our examples generates SEVERE errors due to the usage of \nfo:wrapper as direct descendant of the fo:flow (= advanced/cid-fonts.fo)\n\nThe reason being the bare white-space node descendants of the wrapper --ultimately collapsed, that's \ntrue, but whitespace handling is done later...\n\nAs a workaround there, the usage of fo:wrapper could easily be avoided, I think, because it is merely used \nfor inherited properties... These might as well be specified on the fo:flow itself, and overridden only for \nthe trailing fo:table (which is not enclosed by the fo:wrapper), if necessary.", "id": 98406, "time": "2007-01-23T09:45:32Z", "bug_id": 41426, "creation_time": "2007-01-23T09:45:32Z", "is_private": false}, {"count": 6, "attachment_id": null, "bug_id": 41426, "text": "batch transition pre-FOP1.0 resolved+fixed bugs to closed+fixed", "id": 155972, "time": "2012-04-01T06:51:03Z", "creator": "gadams@apache.org", "creation_time": "2012-04-01T06:51:03Z", "tags": [], "is_private": false}]