[{"attachment_id": null, "tags": [], "bug_id": 5827, "text": "We are using HTTP POST command to open a stream and pass a few arguments \nbetween a client and a servlet. Our client uses Java's core \nDataOutputStream.writeInt to send the binary data (configuration parameters). \nThe servlet code is pretty straightforward - just create a DataInputStream and \nread out the values. Apparently, the integers are translated into different \nvalues.\n\nConsider the following:\nFrom TryServlet.java:\nvoid process (String method,\n                 HttpServletRequest req,\n                 HttpServletResponse res) throws ServletException, IOException {\n   try {\n      DataInputStream dis = new DataInputStream(req.getInputStream()); \t      \nint b;\n\n\t\twhile (true) {\n\t\t\t\t\n\t\t\tb = dis.readInt();\n\t\t\t/*b = ((dis.readByte() & 0xFF) << 24) | \n\t\t\t    ((dis.readByte() & 0xFF) << 16) |\n\t\t\t    ((dis.readByte() & 0xFF) << 8) |\n\t\t\t    (dis.readByte() & 0xFF);*/\n\n\t\t\t//b = dis.readByte();\n\n\n\t\t\tl++;\n\t\t\t//input += Integer.toBinaryString(b);\n\t\t\tinput += \"\" + b;\n\t\t}\n\t}\n\tcatch (Exception e) {\n\t\tSystem.out.println(\"Exception while reading input \" + e); \n\t}\n\tSystem.out.println(\"Received raw input of length \" + l + \" \\\"\" + input \n+ \"\\\"\");", "count": 0, "id": 9586, "time": "2002-01-13T03:49:29Z", "creator": "ekaplan@jacada.com", "creation_time": "2002-01-13T03:49:29Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 5827, "attachment_id": 998, "id": 9587, "time": "2002-01-13T03:56:31Z", "creator": "ekaplan@jacada.com", "creation_time": "2002-01-13T03:56:31Z", "is_private": false, "text": "Created attachment 998\nServlet + client code, and birmaps showing the problem."}, {"count": 2, "tags": [], "bug_id": 5827, "attachment_id": null, "id": 9589, "creation_time": "2002-01-13T07:47:43Z", "time": "2002-01-13T07:47:43Z", "creator": "remm@apache.org", "text": "I'm very sceptical about this bug report. Catalina does handle binaries\ncorrectly when doing block reads. I never used byte by byte reads, but there has\nbeen fixes to this, and the coded looks correct (it includes the needed &0xFF).\nOf course, I don't really know what DIS and DOS are doing.", "is_private": false}, {"count": 3, "tags": [], "creator": "tapik@buchtovi.cz", "attachment_id": null, "id": 9643, "time": "2002-01-15T00:47:08Z", "bug_id": 5827, "creation_time": "2002-01-15T00:47:08Z", "is_private": false, "text": "Could you describe the OS and JVM which you are using? Are you using the same JV for the \nclient and the server? It seems to be the JVM's cup of tee.\n"}, {"count": 4, "tags": [], "bug_id": 5827, "attachment_id": null, "text": "We are using NT for both client and server. We are running them on the same \nmachine. To verify that the problem was not Java oriented, I used another \nproduct - IBM's Webshere for the servlet. With Websphere this works fine, no \nproblem at all. Therefore I asserted that the problem was related to Tomcat \n4.01. Moreover, with previous versions of Tomcat this could NOT be reproduced.", "id": 9651, "time": "2002-01-15T04:23:59Z", "creator": "ekaplan@jacada.com", "creation_time": "2002-01-15T04:23:59Z", "is_private": false}, {"count": 5, "tags": [], "creator": "ekaplan@jacada.com", "attachment_id": null, "id": 9670, "time": "2002-01-15T11:08:45Z", "bug_id": 5827, "creation_time": "2002-01-15T11:08:45Z", "is_private": false, "text": "I would also like to provide you with some specific values. The JVM being used\nis Microsoft's class loader version 5.00.3309, and the platform is\nMicrosoft Windows NT 4.00.1381, IE 5 5.50.4134.0600\n\nPlease do look into this bug. I have provided all the examples needed to \nreconstruct, and am very interested in helping out here. Try to take it \nseriously, if you may.\n\n"}, {"count": 6, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "id": 10109, "time": "2002-01-31T10:25:23Z", "bug_id": 5827, "creation_time": "2002-01-31T10:25:23Z", "is_private": false, "text": "*** Bug 6141 has been marked as a duplicate of this bug. ***"}, {"attachment_id": null, "tags": [], "creator": "remm@apache.org", "is_private": false, "count": 7, "id": 11820, "time": "2002-03-14T23:53:25Z", "bug_id": 5827, "creation_time": "2002-03-14T23:53:25Z", "text": "I have tested the attached code with all the current versions of TC 4 (4.0.4-dev\nand HEAD with or without the new HTTP connector), and can't reproduce the problem.\nIs this still failing for you with the current code ?\n[Win2k / Sun JDK 1.4.0]"}]