[{"count": 0, "tags": [], "creator": "tallison@mitre.org", "attachment_id": 34530, "is_private": false, "id": 195522, "time": "2016-12-16T16:28:31Z", "bug_id": 60489, "creation_time": "2016-12-16T16:28:31Z", "text": "Created attachment 34530\ntriggering file\n\nOn TIKA-2208, David Pilato shared a .vsdx that includes a class we aren't including in our stripped down ooxml-schemas: com.microsoft.schemas.office.visio.x2012.main.ConnectsType\n\nLet's add that file to our unit tests to avoid ClassNotFoundException.\n\nAs a side note/question...I thought I remembered with xwpf, when a class wasn't found, we logged it but didn't throw a CNFE...am I remembering this correctly?\n\nIf this is the case, do we need to modify our vsdx code to handle this?"}, {"count": 1, "tags": [], "bug_id": 60489, "attachment_id": null, "id": 195523, "time": "2016-12-16T16:38:26Z", "creator": "onealj@apache.org", "creation_time": "2016-12-16T16:38:26Z", "is_private": false, "text": "If the full ooxml-schemas is used, is a CNFE thrown (making sure that the 2006 schemas are sufficient).\n\nJust add a unit test that includes ConnectsType and it will be included in poi-ooxml-schemas."}, {"count": 2, "tags": [], "creator": "tallison@mitre.org", "attachment_id": null, "text": "Y, adding the file to our unit tests fixes the problem.  Will commit shortly.  Thank you!\n\nLarger question though...am I remembering incorrectly that we used to handle missing beans via logging instead of allowing the CNFE?  In short, does this point to a need to modify our ooxml-visio parser...or do we carry on with the current procedure...adding triggering files as people complain?", "id": 195524, "time": "2016-12-16T16:42:20Z", "bug_id": 60489, "creation_time": "2016-12-16T16:42:20Z", "is_private": false}, {"count": 3, "tags": [], "creator": "tallison@mitre.org", "is_private": false, "text": "r1774638\n\nIf we need to modify our ooxml visio parser to log missing beans rather than throwing a CNFE, let's open a separate issue.", "id": 195525, "time": "2016-12-16T16:49:03Z", "bug_id": 60489, "creation_time": "2016-12-16T16:49:03Z", "attachment_id": null}, {"count": 4, "tags": [], "text": "Doh...resolve", "attachment_id": null, "id": 195526, "creator": "tallison@mitre.org", "time": "2016-12-16T16:49:19Z", "bug_id": 60489, "creation_time": "2016-12-16T16:49:19Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 60489, "attachment_id": null, "id": 197942, "time": "2017-03-23T16:57:05Z", "creator": "tallison@mitre.org", "creation_time": "2017-03-23T16:57:05Z", "is_private": false, "text": "Double, doh!\n\nNeeded to add @Test annotation to actually trigger the addition...\n\nr1788288"}]