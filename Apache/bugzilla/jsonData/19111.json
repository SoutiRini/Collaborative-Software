[{"count": 0, "tags": [], "creator": "andy@mediasurface.com", "attachment_id": null, "id": 35433, "time": "2003-04-17T15:39:16Z", "bug_id": 19111, "creation_time": "2003-04-17T15:39:16Z", "is_private": false, "text": "When Tomcat forwards to an error page, it seems to flush the output buffer even \nif the buffer is not full. If the page is less than about 8K, it works fine: \nthe error is thrown, Tomcat fowards to the error page, the buffer is not \nflushed, and the response is not committed.\n\nThe first JSP below sets the buffer size to 50k and then outputs 10000 \ncharacters. It then throws an error, which gets forwarded to the second JSP. By \nthe time the second JSP picks up, Tomcat has flushed the buffer.\n\nChange the value in the for loop to about 8000 and Tomcat is OK.\n\nSO it looks like Tomcat always flushes the output buffer at around 8k, rather \nthan the size of the buffer as set by response.setBufferSize().\n\n\n1.jsp:\n\n<%@ page errorPage=\"2.jsp\" %>\n\nTest committing/flushing\n\n<%\n        response.setBufferSize(50*1024);\n\n        for (int i=0; i<10000 ; i++)\n        {\n                out.print(\".\");\n        }\n         \n        if (true)\n        {        \n                log (\"About to throw. commited = \" + response.isCommitted());\n                throw new Exception();\n        }\n%>\n\n\n\n2.jsp:\n\n<%@ page isErrorPage=\"true\" %>\n\nIn error page\n<br>\ncommit = <%= response.isCommitted() %>"}, {"count": 1, "tags": [], "creator": "andy@mediasurface.com", "is_private": false, "text": "sorry, this is a duplicate of 19112...", "id": 35435, "time": "2003-04-17T15:51:43Z", "bug_id": 19111, "creation_time": "2003-04-17T15:51:43Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "andy@mediasurface.com", "is_private": false, "id": 35436, "attachment_id": null, "bug_id": 19111, "creation_time": "2003-04-17T15:52:20Z", "time": "2003-04-17T15:52:20Z", "text": "\n\n*** This bug has been marked as a duplicate of 19112 ***"}]