[{"count": 0, "tags": [], "bug_id": 8410, "attachment_id": null, "text": "When passing a string value to a jsp using the jsp:forward and jsp:param \nmethods, parameters can be overwritten or added. Also strings containing \ncertain characters are not processed properly.\n\nExample\n-------\nthispage.jsp:\nString message = \"somevalue&anotherkey=anothervalue\";\n\n<jsp:forward page=\"somepage.jsp\">\n  <jsp:param name=\"somekey\" value=\"<%=message%>\" />\n</jsp:forward>\n\nThe resulting java code in the work-folder is:\n\nString message = \"somevalue&anotherkey=anothervalue\";\nif (true) {\n  out.clear();\n  String _jspx_qfStr = \"\";\n  _jspx_qfStr = _jspx_qfStr + \"?somekey=\" +message;\n  pageContext.forward(\"somepage.jsp\" +  _jspx_qfStr);\n  return;\n}\n\nAs we can see, the variable message is simply appended to the GET-string \nwithout any kind of parsing, encoding or masking. In somepage.jsp we can now \naccess the parameter \"anotherkey\" with its value \"anothervalue\". This also \nleads to the problem that any string containing the characters \"=\" or \"&\" is \nnot passed properly. A string containing the \"=\" character (not following \na \"&\" character) results in the passed string evaluating to null.\nExample:\nsomevalue=anothervalue\nThis nulls the value of somekey.\nIf the string contains the \"&\" character (i.e. somevalue&anothervalue), the \nvalue of somekey is cut off at the \"&\". Even escaping the \"&\" character with \n&amp; doesn't work.\n\nHere comes the security risk. Assuming we know the names of the parameters and \nthe order they are passed in, it is possible to overwrite following parameters.\n\nExample:\nbug.jsp\n<%@ page language=\"java\" contentType=\"text/html\" %>\n\n<%\n    String message = request.getParameter(\"message\");\n%>\n<jsp:forward page=\"somepage.jsp\">\n    <jsp:param name=\"somekey\" value=\"<%=message%>\" />\n    <jsp:param name=\"athirdkey\" value=\"athirdvalue\" />\n</jsp:forward>\n\nsomepage.jsp now looks like this:\n<%@ page language=\"java\" contentType=\"text/html\" %>\n\n<%\n    String message = request.getParameter(\"somekey\");\n    String anothervalue = request.getParameter(\"anotherkey\");\n    String athirdvalue = request.getParameter(\"athirdkey\");\n    out.println(\"somekey=\"+message);\n    out.println(\"anotherkey=\"+anothervalue);\n    out.println(\"athirdkey=\"+athirdvalue);\n%>\n\nNow consider the following input for the parameter \"message\" going into \nbug.jsp:\nsomevalue&athirdkey=adifferentvalue\n\nThe output of somepage.jsp is now:\nsomekey=somevalue anotherkey=null athirdkey=adifferentvalue", "id": 14428, "time": "2002-04-23T12:30:13Z", "creator": "philip.moston@quinscape.de", "creation_time": "2002-04-23T12:30:13Z", "is_private": false}, {"count": 1, "tags": [], "creator": "kin-man.chung@sun.com", "attachment_id": null, "id": 15466, "time": "2002-05-04T01:32:00Z", "bug_id": 8410, "creation_time": "2002-05-04T01:32:00Z", "is_private": false, "text": "Fixed in jasper2."}]