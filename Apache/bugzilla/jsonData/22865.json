[{"count": 0, "tags": [], "bug_id": 22865, "attachment_id": null, "text": "Hello,\n\nI've got something like this in my ant files:\n\n<zip destfile=\"${plugin.directory}/doc.zip\" basedir=\"${plugin.directory}\n\\transform.out.ad\" whenempty=\"fail\">\n\t\t<exclude name=\"*.xml\"/>\n</zip>\n\nand a zip file is still being created although there is nothing in it.  I found \nsomething on the internet saying that Zip.setWhenempty() has changed its \nsignature from 1.3 to 1.4.  Is this attribute not fixed yet?\n\nIf so, please please fix this.\n\nThanks, Mandy\n\nhttp://ntu.tw.freebsd.org/FreeBSD/ports/local-distfiles/znerd/jakarta-ant-\n1.5.1/WHATSNEW", "id": 43570, "time": "2003-09-01T21:27:24Z", "creator": "mandy@ca.ibm.com", "creation_time": "2003-09-01T21:27:24Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 22865, "text": "There have been massive changes in the <zip> task between 1.5.1 and 1.5.3.\nWith Ant 1.5.4 I get\n\nBUILD FAILED\nfile:/tmp/foo.xml:4: Cannot create zip archive /tmp/foo.zip: no files were included.\n\nCould you please try Ant 1.5.4 and see whether the bug still exists for you?\nIt works for me.", "count": 1, "id": 43607, "time": "2003-09-02T14:24:32Z", "creator": "bodewig@apache.org", "creation_time": "2003-09-02T14:24:32Z", "is_private": false}, {"count": 2, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 44326, "time": "2003-09-19T07:52:25Z", "bug_id": 22865, "creation_time": "2003-09-19T07:52:25Z", "is_private": false, "text": "ping"}, {"count": 3, "tags": [], "creator": "mandy@ca.ibm.com", "text": "I haven't been able to test this yet but I will get around to it sometime over \nthe next few days.  (I think) I was using version 1.5.4 when I tried this last.", "id": 44340, "time": "2003-09-19T13:16:52Z", "bug_id": 22865, "creation_time": "2003-09-19T13:16:52Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 22865, "attachment_id": null, "id": 56855, "time": "2004-05-05T09:35:54Z", "creator": "pawanraj@elitecore.com", "creation_time": "2004-05-05T09:35:54Z", "is_private": false, "text": "i am using ant 1.6.1 whenempty attribute does not work. the code is\n\n   <target name=\"testzip-e\">\n     <zip destfile=\"tge.zip\" whenempty=\"skip\" basedir=\"coreear\" />\n   </target>\n\nAn empty zip file is created.\n"}, {"count": 5, "tags": [], "creator": "mandy@ca.ibm.com", "attachment_id": null, "is_private": false, "id": 57366, "time": "2004-05-13T15:07:51Z", "bug_id": 22865, "creation_time": "2004-05-13T15:07:51Z", "text": "Closing this bug report.  Doesn't seem to be a problem now.  Thanks, Mandy"}, {"count": 6, "tags": [], "text": "It is a bug, at least for the example\nthat pawanraj has shown.\n\nThe work-around for that example is:\n   <target name=\"testzip-e\">\n     <zip destfile=\"tge.zip\" whenempty=\"skip\" basedir=\"coreear\" includes =\"**/*\"/>\n   </target>\n\n", "attachment_id": null, "bug_id": 22865, "id": 57367, "time": "2004-05-13T15:15:27Z", "creator": "peter.reilly@corvil.com", "creation_time": "2004-05-13T15:15:27Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 22865, "attachment_id": null, "text": "If coreear is empty I get no zip.  Do you have a self-contained testcase?\n", "id": 58721, "time": "2004-06-04T09:58:11Z", "creator": "bodewig@apache.org", "creation_time": "2004-06-04T09:58:11Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "peter.reilly@corvil.com", "text": "Here is my test build.xml file\n<project default=\"e\">\n  <target name=\"e\">\n    <delete quiet=\"yes\" dir=\"empty\"/>\n    <mkdir dir=\"empty\"/>\n    <delete quiet=\"yes\" file=\"e.zip\"/>\n    <!-- this makes an empty e.zip file -->\n    <zip destfile=\"e.zip\"  whenempty=\"skip\" basedir=\"empty\" />\n  </target>\n  <target name=\"k\">\n    <delete quiet=\"yes\" dir=\"empty\"/>\n    <mkdir dir=\"empty\"/>\n    <delete quiet=\"yes\" file=\"e.zip\"/>\n    <!-- this correctly skips making the e.zip file -->\n    <zip destfile=\"e.zip\"  whenempty=\"skip\" basedir=\"empty\" includes=\"**/*\"/> \n  </target>\n</project>\n\nThe problem is the \"basedir\" attribute, this causes\nZip#grabResources() to return an entry.\n", "count": 8, "id": 58722, "time": "2004-06-04T10:12:19Z", "bug_id": 22865, "creation_time": "2004-06-04T10:12:19Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 22865, "attachment_id": null, "id": 58749, "time": "2004-06-04T13:00:03Z", "creator": "bodewig@apache.org", "creation_time": "2004-06-04T13:00:03Z", "is_private": false, "text": "I see.  **/* doesn't match \"\" while not having any includes pattern (i.e. having\n** as implicit includes pattern) does.  addResources later skips the \"\" name.\n\nUnfortunately the trivial fix to exclude \"\" in grabResources would conflict with\nprefix or fullpath attributes.  Hmm, grabResources has access to the FileSets as\nwell.  I'll look into it.\n"}, {"count": 10, "tags": [], "bug_id": 22865, "is_private": false, "text": "fixed in CVS.", "id": 58833, "time": "2004-06-07T12:30:04Z", "creator": "bodewig@apache.org", "creation_time": "2004-06-07T12:30:04Z", "attachment_id": null}]