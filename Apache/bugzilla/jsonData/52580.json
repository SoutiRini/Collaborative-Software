[{"count": 0, "tags": [], "bug_id": 52580, "attachment_id": null, "text": "I think this issue has the same root cause of bug 50293(javax.el.CompositeELResolver synchronization issue).\nWhen CompositeELResolver.getValue was called, sometimes it raised NullPointerException. Here is the stacktrace:\n\nCaused by: java.lang.NullPointerException\n        at javax.el.CompositeELResolver.getValue(CompositeELResolver.java:67)\n        at org.apache.myfaces.el.unified.resolver.FacesCompositeELResolver.getValue(FacesCompositeELResolver.java:142)\n        at javax.el.CompositeELResolver.getValue(CompositeELResolver.java:67)\n        at org.apache.el.parser.AstIdentifier.getValue(AstIdentifier.java:71)\n        at org.apache.el.parser.AstValue.getValue(AstValue.java:147)\n        at org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:189)\n        at org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate(PageContextImpl.java:985)\n        at jsp.portal.portal_jsp._jspService(portal_jsp.java:143)\nThe source code of javax.el.CompositeELResolver.getValue():\n @Override\n    public Object getValue(ELContext context, Object base, Object property)\n            throws NullPointerException, PropertyNotFoundException, ELException {\n        context.setPropertyResolved(false);\n        int sz = this.size;\n        Object result = null;\n        for (int i = 0; i < sz; i++) {\n            result = this.resolvers[i].getValue(context, base, property);--line 67\n            if (context.isPropertyResolved()) {\n                return result;\n            }\n        }\n        return null;\n    }\nSource code of org.apache.myfaces.el.unified.resolver.FacesCompositeELResolver.getValue is:\n    @Override\n    public Object getValue(final ELContext context, final Object base, final Object property)-131\n    {\n        final FacesContext facesContext = FacesContext.getCurrentInstance();-133\n        if (facesContext == null)\n        {\n            return null;\n        }\n        final Map<String, Object> requestMap = facesContext.getExternalContext().getRequestMap();\n        try\n        {\n            setScope(requestMap);\n            return super.getValue(context, base, property); -line 142\n        }\n        finally\n        {\n            unsetScope(requestMap);\n        }\n    }\nIt seems the resolvers[i] has been set to null yet. I don't visit the page concurrently, however, this exception still raise and it makes the page 500 error. \nDo we plan to fix this issue by add synchronize check or just as 50923's comment that from ELResolver spec it's not thread safe? This issue makes page unstable sometime and only restart tomcat to recover.\nThanks a lot.", "id": 153361, "time": "2012-02-02T11:17:58Z", "creator": "qiuyunzhong@hotmail.com", "creation_time": "2012-02-02T11:17:58Z", "is_private": false}, {"count": 1, "tags": [], "creator": "qiuyunzhong@hotmail.com", "text": "javax.el.CompositeELResolver resides in el-api.jar file. I use myfaces 1.2.9.", "id": 153362, "time": "2012-02-02T11:20:36Z", "bug_id": 52580, "creation_time": "2012-02-02T11:20:36Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 52580, "attachment_id": null, "is_private": false, "id": 153471, "time": "2012-02-05T19:18:05Z", "creator": "markt@apache.org", "creation_time": "2012-02-05T19:18:05Z", "text": "\n\n*** This bug has been marked as a duplicate of bug 50293 ***"}]