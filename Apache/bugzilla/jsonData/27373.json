[{"count": 0, "tags": [], "bug_id": 27373, "text": "This is actually an example in erik and my book; we should have regression\ntested it.\n\n1. Take a build file\n<project default=\"fail\">\n\t<target name=\"fail\">\n\t\t<echo message=\"Hola\" />\n\t</target>\n</project>\n\n2. run it with the listener:\nant -listener org.apache.tools.ant.listener.CommonsLoggingListener\n\n3. observer the failure\nBUILD FAILED\njava.lang.NullPointerException\n\tat org.apache.log4j.helpers.LogLog.error(LogLog.java:120)\n\tat org.apache.log4j.Category.callAppenders(Category.java:264)\n\tat org.apache.log4j.Category.forcedLog(Category.java:445)\n\tat org.apache.log4j.Category.info(Category.java:704)\n\tat org.apache.commons.logging.impl.Log4JCategoryLog.info(Log4JCategoryLog.java:148)\n\tat\norg.apache.tools.ant.listener.CommonsLoggingListener.realLog(CommonsLoggingListener.java:264)\n\tat\norg.apache.tools.ant.listener.CommonsLoggingListener.buildStarted(CommonsLoggingListener.java:103)\n\tat org.apache.tools.ant.Project.fireBuildStarted(Project.java:1781)\n\tat org.apache.tools.ant.Main.runBuild(Main.java:622)\n\tat org.apache.tools.ant.Main.startAnt(Main.java:188)\n\tat org.apache.tools.ant.launch.Launcher.run(Launcher.java:197)\n\tat org.apache.tools.ant.launch.Launcher.main(Launcher.java:56)\n\n4. Line #120 of LogLog is\n    System.err.println(ERR_PREFIX+msg);\nThe problem is that the system.err error is not defined yet. Which is odd, as\nthat is just what the setup code is meant to do;\n\nI am very confused by this, as I dont see on a look at the listener setup how we\ncan get a null system.err unless it is not assigned. We may want some extra\nhooks and checks in the listener to catch this null-value state before handing\noff to log4j, though a bug fix would be better.", "id": 53336, "time": "2004-03-02T17:14:58Z", "creator": "stevel@apache.org", "creation_time": "2004-03-02T17:14:58Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "peter.reilly@corvil.com", "text": "There is a difference between using a -logger and -listener.\nThe former may use a log file and the latter does not get this set.\nThe commons logger code assumes that it is passed the log stream in\nboth cases.\nThe fix is just to initialize the out and err streams in the commons\nlogger class.\nUpdated CommonsLoggingListener.", "count": 1, "id": 53913, "time": "2004-03-12T09:03:20Z", "bug_id": 27373, "creation_time": "2004-03-12T09:03:20Z", "is_private": false}]