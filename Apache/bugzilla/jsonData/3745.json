[{"count": 0, "tags": [], "text": "When a PUT request has no Content-Length header, tomcat \"hangs\"\non HttpServletRequest.getInputStream.read() as it will forever\nreturn 0 and never -1.\n\nThe comment in ServletInputStreamFacade (see extract below) indicates\nthat this can only happen in chunked encoding. This is a wrong assumpation\nas chunked encoding is only available in HTTP/1.1. In HTTP/1.0 the\nend of the message body can be indicated by closing the client side\nof the connection/socket. This is the behaviour working in Tomcat 3.2.x.\n\nReturning 0 results from the interplay between the following code extracts:\n\nIn Lines 233-235 of Http10Interceptor.java\n\n    public int doRead(byte[] b, int off, int len) throws IOException {\n\tif( available <= 0 )\n\t    return 0;\n\nIn ServletInputStreamFacade.java, lines 107-119:\n\tif (limit == -1) {\n\t    // Ask the adapter for more data. We are in the 'no content-length'\n\t    // case - i.e. chunked encoding ( acording to http spec CL is \nrequired\n\t    // for everything else.\n\t    int rd=reqA.doRead();\n\t    if( rd<0 ) {\n\t\tlimit=0; // no more bytes can be read.\n\t    } else {\n\t\tbytesRead++; // for statistics\n\t    }\n\t    return rd;\n\t}", "attachment_id": null, "bug_id": 3745, "id": 5816, "time": "2001-09-20T03:08:56Z", "creator": "stefan.eissing@greenbytes.de", "creation_time": "2001-09-20T03:08:56Z", "is_private": false}, {"count": 1, "tags": [], "text": "Fixed in 3.3, please check the next nightly.", "attachment_id": null, "id": 5922, "creator": "cmanolache@yahoo.com", "time": "2001-09-23T10:00:37Z", "bug_id": 3745, "creation_time": "2001-09-23T10:00:37Z", "is_private": false}]