[{"attachment_id": null, "tags": [], "bug_id": 56006, "is_private": false, "count": 0, "id": 172368, "time": "2014-01-14T16:49:22Z", "creator": "andresfr84@gmail.com", "creation_time": "2014-01-14T16:49:22Z", "text": "Hello,\n  first of all, sorry about my english. I hope someone could know if there is any problem with my code or it's a problem with poi library. I'm using poi 3.9.\n\nThe fact is this:\n\n1.- I read a file with XWPFDocument:\n\n     File docFile = null;\n                     docFile = new File(fileUrl);\n                     FileInputStream fis;\n                        try {\n                                fis = new FileInputStream(docFile.getAbsolutePath());\n                                XWPFDocument doc = new XWPFDocument(fis);\n\n2.- I do some operations, but I've tried the code withour any code here, so I'll pass.\n\n3.- I write the file into disk:\n\n       FileOutputStream out = new FileOutputStream(outFile);\n                                 doc.write(out);\n                                 out.close();\n\nThe size of the document get's changed, but this doesn't worry me. The problem is that after several modifications, the size of it are increased each time. At about 14 or 15 \"open-close\" iterations, the file stucks in this line:\n\n      XWPFDocument doc = new XWPFDocument(fis);\n\nIt takes 100% cpu and 100% of available Java memory, until out of memory error is thrown. I think poi modifies the internal structure adding some things to it. If I open the file with Word, and save it, it turns to the beginning state, all ok, but I need to get it modified automatically a lot of times."}, {"count": 1, "tags": [], "bug_id": 56006, "is_private": false, "text": "A .docx file is a zip of XML files in a certain structure\n\nCould you therefore unzip two files, one that works, and one that doesn't, and see where the main differences are?", "id": 172369, "time": "2014-01-14T16:56:00Z", "creator": "apache@gagravarr.org", "creation_time": "2014-01-14T16:56:00Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "andresfr84@gmail.com", "attachment_id": null, "is_private": false, "id": 172370, "time": "2014-01-14T17:01:50Z", "bug_id": 56006, "creation_time": "2014-01-14T17:01:50Z", "text": "(In reply to Nick Burch from comment #1)\n> A .docx file is a zip of XML files in a certain structure\n> \n> Could you therefore unzip two files, one that works, and one that doesn't,\n> and see where the main differences are?\n\nThank you for your comment. The first big difference I see is in the /word/footnotes.xml. The original one is 3KB and the 10th iteration has 561KB. Do you know how this happens?"}, {"attachment_id": 31204, "tags": [], "bug_id": 56006, "is_private": false, "count": 3, "id": 172371, "time": "2014-01-14T17:03:15Z", "creator": "andresfr84@gmail.com", "creation_time": "2014-01-14T17:03:15Z", "text": "Created attachment 31204\nFootnotes in first iteration"}, {"count": 4, "text": "Created attachment 31205\nFootnotes in 10th iteration", "bug_id": 56006, "is_private": false, "id": 172372, "time": "2014-01-14T17:03:55Z", "creator": "andresfr84@gmail.com", "creation_time": "2014-01-14T17:03:55Z", "tags": [], "attachment_id": 31205}, {"count": 5, "tags": [], "bug_id": 56006, "is_private": false, "text": "Before we look too much more, could you try with a recent nightly build of POI / a build of POI from a SVN checkout of trunk?", "id": 172373, "time": "2014-01-14T17:10:26Z", "creator": "apache@gagravarr.org", "creation_time": "2014-01-14T17:10:26Z", "attachment_id": null}, {"count": 6, "tags": [], "text": "I'll download 3.10.beta3 (20140111) and give it a try. I'll update you asap.", "is_private": false, "bug_id": 56006, "id": 172374, "time": "2014-01-14T17:23:39Z", "creator": "andresfr84@gmail.com", "creation_time": "2014-01-14T17:23:39Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 56006, "text": "I've tried with 3.10-beta3-20140110 (20140111 are failing to download) and it works perfect, I've run 30 iterations and size are not modified. In your page it says: \" These builds should not be used in production: they are only intended for use by developers to help with resolving bugs and evaluating new features. \". Shoud I wait until this are released or can I use this beta?", "id": 172375, "time": "2014-01-14T17:42:07Z", "creator": "andresfr84@gmail.com", "creation_time": "2014-01-14T17:42:07Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 56006, "attachment_id": null, "text": "Closing, based on being fixed in 3.10 final (which has been available for some months now)", "id": 176813, "time": "2014-07-31T16:23:52Z", "creator": "apache@gagravarr.org", "creation_time": "2014-07-31T16:23:52Z", "is_private": false}]