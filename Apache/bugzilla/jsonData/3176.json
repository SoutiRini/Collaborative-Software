[{"count": 0, "tags": [], "bug_id": 3176, "text": "If the last character in a tag attribute is a double-backslash ( '\\\\' ) then \nthe JSP to Java compiler does not convert that to a double backslash in the \nsetter and thus produces a Java servlet that fails to compile.  \n\nFor example, if I wish to set an attribute equal to \"\\x\\x\", I would create a \ntag that has an attribute like myattrib=\"\\\\x\\\\x\" -- and this works.  However, \nif I wish to create an attribute equal to \"\\x\\x\\\", I should be able to create a \ntag with an attribute like myattrib=\"\\\\x\\\\x\\\\\" -- but this fails with an \nexception when the Java is being compiled.  My exception looks like:\n\norg.apache.jasper.JasperException: Unable to compile D:\\apache\\jakarta-tomcat-\n3.3-b1\\work\\DEFAULT\\testapp\\t__st\\test\\testpage_6.java:1031: String not \nterminated at end of line.\n            _jspx_th_test_set_7.setValue(\"\\\\x\\\\x\\\");\n                                         \n\nTo me the offending code appears to be in the method: \n\norg.apache.jasper.compiler.quoteString(String s)\n\nSpecifically, the block of code:\n\n\t    if ( ch == '\\\\' && i+1 < len) {\n\t\tsb.append('\\\\');\n\t\tsb.append('\\\\');\n\t\tsb.append(s.charAt(++i));\n\t    } \n\ncauses the last character to be ignored as a potential escape character if the \nsecond to last character is a backslash.  This ignores the possibility that the \nlast character in the attribute is a character that needs to be escaped (e.g. \nbackslash, a double quote, etc.)\n\nI would think this is an easy fix except that I suspect there is some other \nreason why the code is skipping normal processing on the last character.\n\nWhomever works on this, feel free to e-mail me.\n\n-Bruce", "id": 4642, "time": "2001-08-20T07:40:49Z", "creator": "bruce@filgate.com", "creation_time": "2001-08-20T07:40:49Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "cmanolache@yahoo.com", "attachment_id": null, "text": "Fixed in 3.3, thanks for the report.", "id": 4847, "time": "2001-08-25T11:37:03Z", "bug_id": 3176, "creation_time": "2001-08-25T11:37:03Z", "is_private": false}]