[{"count": 0, "tags": [], "bug_id": 50942, "is_private": false, "id": 145064, "attachment_id": null, "creator": "murthy_bodapati@rediffmail.com", "creation_time": "2011-03-17T13:15:47Z", "time": "2011-03-17T13:15:47Z", "text": "We are using apache as a forward proxy and recently we migrated from apache2.2.4 to apache2.2.16.\n\nWe observed that apache2.2.16 is taking almost an extra 5x time to fetch the page when compared to apache2.2.4\n\nSteps to reproduce:\n\nConfiguring Apache \n\n1. Configure apache by the below command\n\n./configure --prefix=/usr/local/apache --enable-mods-shared=\"proxy_connect proxy_ftp proxy_http proxy status rewrite deflate\" --with-mpm=worker --with-included-apr\n\nmake install\n\n2. Set the parameter \"ProxyRequests = On\" and start the apache.\n\n3. Check the time taken to server the page by executing the below command\n\ncurl -o /dev/null -s -w %{time_total} -x <ServerName>:<Port> www.youtube.com\n\nWe see this dip in performance in apache2.2.6 also."}, {"count": 1, "tags": [], "text": "care to try this change, to back out one of the proxy fixes between 2.2.4 and 2.2.6?\n\nIndex: modules/proxy/proxy_util.c\n===================================================================\n--- modules/proxy/proxy_util.c\t(revision 1082598)\n+++ modules/proxy/proxy_util.c\t(working copy)\n@@ -1598,12 +1598,14 @@\n         }\n #endif\n \n+#if 0\n         rv = apr_socket_opt_set(*newsock, APR_TCP_NODELAY, 1);\n         if (rv != APR_SUCCESS && rv != APR_ENOTIMPL) {\n              ap_log_error(APLOG_MARK, APLOG_ERR, rv, s,\n                           \"apr_socket_opt_set(APR_TCP_NODELAY): \"\n                           \"Failed to set\");\n         }\n+#endif", "attachment_id": null, "id": 145065, "creator": "trawick@apache.org", "time": "2011-03-17T13:22:06Z", "bug_id": 50942, "creation_time": "2011-03-17T13:22:06Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 50942, "attachment_id": null, "text": "Hi I applied it, but still it is taking time.\n\nIn the error log, I see it spends 2 seconds for sending itself.\n\n[Thu Mar 17 23:18:12 2011] [debug] mod_proxy_http.c(1736): proxy: start body send\n[Thu Mar 17 23:18:14 2011] [debug] mod_proxy_http.c(1840): proxy: end body send", "id": 145066, "time": "2011-03-17T14:12:40Z", "creator": "murthy_bodapati@rediffmail.com", "creation_time": "2011-03-17T14:12:40Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 50942, "text": "thanks for trying that quickly", "id": 145070, "time": "2011-03-17T14:49:16Z", "creator": "trawick@apache.org", "creation_time": "2011-03-17T14:49:16Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "text": "We use apache as a forward proxy and want to migrate from 2.2.4 to 2.2.16. But could not take the migration step as 2.2.16 is very very slow in comparison to 2.2.4.", "is_private": false, "bug_id": 50942, "id": 145342, "time": "2011-03-28T05:06:20Z", "creator": "veda.chalasani@gmail.com", "creation_time": "2011-03-28T05:06:20Z", "attachment_id": null}]