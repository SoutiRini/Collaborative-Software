[{"attachment_id": null, "tags": [], "bug_id": 2137, "is_private": false, "count": 0, "id": 2888, "time": "2001-06-12T13:24:44Z", "creator": "jay_drummond@hotmail.com", "creation_time": "2001-06-12T13:24:44Z", "text": "VAJAntToolGUI properties are evaluated the first run but not thereafter.\n\nTo reproduce, \n\nCreate a task that updates a property. For example, a task that reports a \nrandom number each time it's run. I know this seems of little value but it's a \nsimple test case. \n\nHere\u2019s a simple build.xml file\n\n<project name=\"simple\" default=\"testReload\" basedir=\".\">\n    <target name=\"testReload\" description=\"qshow up\">\n        <taskdef name=\"makeRandom\" classname=\"com.test.RndNumber\"/>\n        <makeRandom randomProperty=\"rnd.number\"/>\n        <echo message=\"say number = ${rnd.number}\"/>\n    </target>\n</project>\n\nSee the end of this bug report for the Task code.\n\nLoad a build.xml file with the VAJ GUI tool. Build testReload. Note the rnd \nnumber is displayed. Click Build repeatedly.  \n\nIf you change the Message Level on the ANT GUI to debug. You'll see the \nproperty being set. See below:\n\ntestReload:\n[echo] say number = 3\nBUILD SUCCESSFUL\nTotal time: 0 seconds\n\ntestReload:\n[echo] say number = 3\nBUILD SUCCESSFUL\nTotal time: 0 seconds\n\n<<<<<<<<debug message level on here>>>>>>>\n\nBuild sequence for target `testReload' is [testReload]\nComplete build sequence is [testReload]\n +User task: makeRandom     com.test.RndNumber\nSetting project property: rnd.number -> 68\n[echo] say number = 3\nBUILD SUCCESSFUL\nTotal time: 0 seconds\n\n\n\n---- TASK CODE -----\n\npackage com.test;\n\nimport org.apache.tools.ant.*;\nimport org.apache.tools.ant.taskdefs.Execute;\nimport org.apache.tools.ant.taskdefs.LogStreamHandler;\nimport org.apache.tools.ant.types.Commandline;\n\nimport java.io.*;\nimport java.util.*;\n\n\n/**\n * Code to return the version number of a given project from the VAJ repository.\n * @author Jay P. Drummond (4/24/01 4:18:02 PM)\n */\npublic class RndNumber extends Task {\n\n\n\n\n\n\tprivate java.lang.String randomProperty;\n\n/**\n * Undocumented method.\n * <br>Added by Jay P. Drummond (6/12/01 3:45:58 PM)\n */\npublic RndNumber() {}\n\n\n/**\n * Undocumented method.\n * <br>Added by Jay P. Drummond (6/12/01 3:46:28 PM)\n */\npublic void execute() throws BuildException {\n\n\n\tRandom rnd = new Random();\n\n\tint val = (int) (rnd.nextDouble() * 255);\n\n\torg.apache.tools.ant.Project aProj = getProject();\n\tif (getRandomProperty() == null) {\n\t\tString msg = \"Must set randomProperty to a value.\";\n\t\tthrow new BuildException(msg, location);\n\t}\n\n\taProj.setProperty(getRandomProperty(), new Integer(val).toString());\n\n}\n\n\n/**\n * Undocumented method.\n * <br>Added by Jay P. Drummond (6/12/01 3:46:48 PM)\n * @return java.lang.String\n */\npublic java.lang.String getRandomProperty() {\n\treturn randomProperty;\n}\n\n\n/**\n * Undocumented method.\n * <br>Added by Jay P. Drummond (6/12/01 3:46:48 PM)\n * @param newRandomProperty java.lang.String\n */\npublic void setRandomProperty(java.lang.String newRandomProperty) {\n\trandomProperty = newRandomProperty;\n}\n}"}, {"attachment_id": null, "tags": [], "bug_id": 2137, "is_private": false, "count": 1, "id": 12052, "time": "2002-03-20T07:01:57Z", "creator": "sbailliez@apache.org", "creation_time": "2002-03-20T07:01:57Z", "text": "If you were able to send a patch for this task that would be nice because no \ncommitters actually use VAJ so that's kind of hard to evaluate. Thanks."}, {"attachment_id": null, "tags": [], "creator": "levylambert@tiscali-dsl.de", "text": "Jay,\nwhat you wrote in your bug report amounts to saying \"I have a problem with \nimmutable properties\"\nBut properties are immutable in ant.\nsee : http://ant.apache.org/manual/CoreTasks/property.html\nSo I will close this bug report as INVALID.\nFeel free to react if you feel my appreciation is wrong.\nCheers. Antoine", "count": 2, "id": 39147, "time": "2003-06-20T10:09:46Z", "bug_id": 2137, "creation_time": "2003-06-20T10:09:46Z", "is_private": false}]