[{"count": 0, "tags": [], "creator": "lubx@yahoo.com", "text": "After compile and deploy the application (myapp) to tomcat, trying to view the\nMail Session set-up in Admin, Admin throws exception.  \nIt doesn't happen at very first time to set up the Mail Session, after modify\nthe setting, or modifying the server context file, it will keep throwing the\nexception even undo  all changes in config file. \nThis bug could be repeated after following the fix of  bug #29255.\n\nException:\njavax.servlet.ServletException: Exception retrieving attribute 'mail.smtp.host'\n\torg.apache.jasper.runtime.PageContextImpl.doHandlePageException(PageContextImpl.java:825)\n\torg.apache.jasper.runtime.PageContextImpl.handlePageException(PageContextImpl.java:758)\n\tadmin.resources.listMailSessions_jsp._jspService(listMailSessions_jsp.java:431)\n\torg.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:94)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:810)\n\torg.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1069)\n\torg.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:455)\n\torg.apache.struts.action.RequestProcessor.process(RequestProcessor.java:279)\n\torg.apache.struts.action.ActionServlet.process(ActionServlet.java:1482)\n\torg.apache.struts.action.ActionServlet.doGet(ActionServlet.java:507)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:697)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:810)\n\torg.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1069)\n\torg.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:455)\n\torg.apache.struts.action.RequestProcessor.process(RequestProcessor.java:279)\n\torg.apache.struts.action.ActionServlet.process(ActionServlet.java:1482)\n\torg.apache.struts.action.ActionServlet.doGet(ActionServlet.java:507)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:697)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:810)\n\nRoot Cause:\n\njavax.servlet.jsp.JspException: Exception retrieving attribute 'mail.smtp.host'\n\torg.apache.webapp.admin.AttributeTag.doEndTag(AttributeTag.java:170)\n\tadmin.resources.listMailSessions_jsp._jspx_meth_controls_attribute_1(listMailSessions_jsp.java:761)\n\tadmin.resources.listMailSessions_jsp._jspService(listMailSessions_jsp.java:391)\n\torg.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:94)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:810)\n\torg.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1069)\n\torg.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:455)\n\torg.apache.struts.action.RequestProcessor.process(RequestProcessor.java:279)\n\torg.apache.struts.action.ActionServlet.process(ActionServlet.java:1482)\n\torg.apache.struts.action.ActionServlet.doGet(ActionServlet.java:507)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:697)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:810)\n\torg.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1069)\n\torg.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:455)\n\torg.apache.struts.action.RequestProcessor.process(RequestProcessor.java:279)\n\torg.apache.struts.action.ActionServlet.process(ActionServlet.java:1482)\n\torg.apache.struts.action.ActionServlet.doGet(ActionServlet.java:507)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:697)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:810)", "id": 60712, "attachment_id": null, "bug_id": 30155, "creation_time": "2004-07-16T17:47:09Z", "time": "2004-07-16T17:47:09Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 30155, "attachment_id": null, "text": "I can't reproduce.  Can you attach your config files?  From the exception, it\nlooks like your mail session resource is missing \"mail.smtp.host\" parameter.", "id": 60834, "time": "2004-07-19T21:36:15Z", "creator": "amyroh@apache.org", "creation_time": "2004-07-19T21:36:15Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 30155, "is_private": false, "text": "I actually removed the configuration regarding the mail session both in web.xml\nand context.xml. here goes the web.xml, context.xml and server.xml:\n\nweb.xml:\n\n<web-app>\n<!--  Omit other config  -->\n     <resource-ref>\n        <description>DB Connection</description>\n        <res-ref-name>jdbc/dsapp1</res-ref-name>\n        <res-type>javax.sql.DataSource</res-type>\n        <res-auth>Container</res-auth>\n    </resource-ref>\n<!--    <resource-ref>-->\n<!--        <description>mail</description>-->\n<!--        <res-ref-name>mail/Session_send</res-ref-name>-->\n<!--        <res-type>javax.mail.Session</res-type>-->\n<!--        <res-auth>Container</res-auth>-->\n<!--    </resource-ref>-->\n\n        <!-- The tomcat role -->\n    <security-role>\n        <description>Default Role for All Users</description>\n        <role-name>tomcat</role-name>\n    </security-role>\n</web-app>\n\ncontext.xml:\n\n<Context path=\"/dsapp1\" docBase=\"dsapp1\" debug=\"99\" reloadable=\"true\">\n    <Logger className=\"org.apache.catalina.logger.FileLogger\" \n        prefix=\"dsapp1_log.\" suffix=\".txt\" timestamp=\"true\"/>\n\n\n    <!-- NOTE: If you want to use a DataSourceRealm, the Resource must be a\n               global resource -->\n    <Realm className=\"org.apache.catalina.realm.JDBCRealm\" debug=\"99\"\n          driverName=\"com.mysql.jdbc.Driver\"\n      \nconnectionURL=\"jdbc:mysql://localhost/dsapp1?autoReconnect=true&amp;useUnicode=true&amp;characterEncoding=UTF-8\"\n      connectionName=\"test\" connectionPassword=\"test\"\n           userTable=\"app_user\" userNameCol=\"username\" userCredCol=\"password\"\n       userRoleTable=\"user_role\" roleNameCol=\"role_name\" />\n    <Resource name=\"jdbc/dsapp1\" auth=\"Container\" type=\"javax.sql.DataSource\"/>\n    <ResourceParams name=\"jdbc/dsapp1\">\n        <parameter>\n            <name>factory</name>\n            <value>org.apache.commons.dbcp.BasicDataSourceFactory</value>\n        </parameter>\n        <!-- Maximum number of dB connections in pool. Make sure you\n             configure your mysqld max_connections large enough to handle\n             all of your db connections. Set to 0 for no limit.\n             -->\n        <parameter>\n            <name>maxActive</name>\n            <value>100</value>\n        </parameter>\n<!-- Omit other config -->\n    </ResourceParams>\n    <!-- This is not working -->\n<!--    <Resource name=\"mail/Session\" auth=\"Container\"\ntype=\"javax.mail.Session\"/>-->\n<!--    <ResourceParams name=\"mail/Session\">-->\n<!--        <parameter>-->\n<!--            <name>mail.smtp.host</name>-->\n<!--            <value>localhost</value>-->\n<!--        </parameter>-->\n<!--    </ResourceParams>-->\n</Context>\n\nserver.xml:\n\n?xml version='1.0' encoding='utf-8'?>\n<Server>\n  <Listener className=\"org.apache.catalina.mbeans.ServerLifecycleListener\"/>\n  <Listener\nclassName=\"org.apache.catalina.mbeans.GlobalResourcesLifecycleListener\"/>\n  <GlobalNamingResources>\n    <Environment name=\"simpleValue\" type=\"java.lang.Integer\" value=\"30\"/>\n    <Resource auth=\"Container\" description=\"User database that can be updated\nand saved\" name=\"UserDatabase\" type=\"org.apache.catalina.UserDatabase\"/>\n    <Resource name=\"mail/Session_send\" type=\"javax.mail.Session\"/>\n    <ResourceParams name=\"UserDatabase\">\n      <parameter>\n        <name>factory</name>\n        <value>org.apache.catalina.users.MemoryUserDatabaseFactory</value>\n      </parameter>\n      <parameter>\n        <name>pathname</name>\n        <value>conf/tomcat-users.xml</value>\n      </parameter>\n    </ResourceParams>\n    <ResourceParams name=\"mail/Session_send\">\n      <parameter>\n        <name>mail.smtp.host</name>\n        <value>smtp.host.net</value>\n      </parameter>\n    </ResourceParams>\n  </GlobalNamingResources>\n <Service name=\"Catalina\">\n    <Connector acceptCount=\"100\" connectionTimeout=\"20000\"\ndisableUploadTimeout=\"true\" port=\"8080\" redirectPort=\"8443\">\n    </Connector>\n    <Connector port=\"8009\" protocol=\"AJP/1.3\"\nprotocolHandlerClassName=\"org.apache.jk.server.JkCoyoteHandler\" redirectPort=\"8443\">\n    </Connector>\n    <Engine defaultHost=\"localhost\" name=\"Catalina\">\n      <Host appBase=\"webapps\" name=\"localhost\">\n        <Logger className=\"org.apache.catalina.logger.FileLogger\"\nprefix=\"localhost_log.\" suffix=\".txt\" timestamp=\"true\"/>\n      </Host>\n      <Logger className=\"org.apache.catalina.logger.FileLogger\"\nprefix=\"catalina_log.\" suffix=\".txt\" timestamp=\"true\"/>\n      <Realm className=\"org.apache.catalina.realm.UserDatabaseRealm\"/>\n    </Engine>\n  </Service>\n</Server>\n\nthanks for your time\n\nbill", "id": 60892, "time": "2004-07-20T20:51:07Z", "creator": "lubx@yahoo.com", "creation_time": "2004-07-20T20:51:07Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 30155, "attachment_id": null, "text": "5.0.25 has a known issue with the naming-factory.jar missing the \njavax.mail.Session factory support.  Use 5.0.27.  I'm going to close this issue \nas I'm 99% sure this is the problem, but if I'm wrong feel free to reopen the \nissue and change the version from 5.0.25 to 5.0.27.  Thanks.", "id": 61241, "time": "2004-07-28T15:15:26Z", "creator": "yoavs@computer.org", "creation_time": "2004-07-28T15:15:26Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 30155, "is_private": false, "count": 4, "id": 90075, "time": "2006-06-11T22:59:55Z", "creator": "markt@apache.org", "creation_time": "2006-06-11T22:59:55Z", "text": "This has been re-opened but no additional comment provided. Closing again as\nfixed based on Yoav's last comment."}]