[{"count": 0, "tags": [], "bug_id": 22631, "text": "Apache2 crashes randomly but stays in memory and can not be killed from task \nmanager. Only reboot helps. Also this could happend on Apache restart/stop.\nIt seems that Apache kills \"child\" process but cant kill \"main\" apache process \n(when apache runs, in task manager it shows two apache processes) \nand nothing can kill it untill restart computer.\nI did clean install entire system, \nand installed Apache 2.0.47 without installing anything else (exept PHP, \nMySQL). Nothing helped, Apache2 most of the times \nrestarts/stops with no problem, but sometimes, stops responding.\n\nP.S. My Apache service runs under a user, not under \"SYSTEM\" user.\n\nP4\nWindowsXP Pro SP1\nApache 2.0.47 (no SSL, all default modules)\nPHP 4.3.3 RC2\nMySQL 4", "id": 43122, "time": "2003-08-21T18:50:09Z", "creator": "spam@come.no-ip.com", "creation_time": "2003-08-21T18:50:09Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "spam@come.no-ip.com", "text": "Just a little update.\nWhen Apache \"hangs\" like that, after about 10-15 min it's being reanimated by \nitself. (in services settings it set to restart Apache after crash)", "id": 45143, "time": "2003-10-06T11:13:31Z", "bug_id": 22631, "creation_time": "2003-10-06T11:13:31Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "text": "Can you reproduce the behaviour if running the service as \"SYSTEM\"?", "is_private": false, "id": 45678, "creator": "robert@profundis.se", "time": "2003-10-14T21:06:17Z", "bug_id": 22631, "creation_time": "2003-10-14T21:06:17Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "spam@come.no-ip.com", "attachment_id": null, "is_private": false, "id": 45679, "time": "2003-10-14T21:12:39Z", "bug_id": 22631, "creation_time": "2003-10-14T21:12:39Z", "text": "Yes, it does the same thing no metter under what user its running.\nOne time I thought that this could case of PHP 4.3.3, but I've tryed PHP 4.2.3 \nand it was doing the same thing.\n\nAnother thing, when it crashes, rotatelog.exe stays in memory as well, and when \nApache2 reanimated, it starts another set of rotatelog.exe (as I undertand it \nstarts one rotatelog.exe per each vdomain, that uses separate logs)"}, {"count": 4, "tags": [], "text": "(Note: I'm not an Apache developer, just lurking...)\n\nI've been running a few Apache installations on Windows XP for 2+ years without \nsuch issues. There is a problem in some PHP versions below 4.3.4, that kills \n(and restarts) Apache on concurrent requests. Can you reproduce it without \nloading php4_module? If so, it might be related to rotatelogs, so see if you \ncan make it go away by disabling it.\n\nA possible theory is that the random crashes is caused by PHP, and the restart \nhanging is caused by rotatelogs. See if you can confirm that.", "is_private": false, "id": 45693, "creator": "robert@profundis.se", "time": "2003-10-14T22:21:14Z", "bug_id": 22631, "creation_time": "2003-10-14T22:21:14Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 22631, "is_private": false, "text": "I don't suppose you're running McAfee Virusscan, by any chance? ", "id": 45694, "time": "2003-10-14T22:29:06Z", "creator": "jwoolley@apache.org", "creation_time": "2003-10-14T22:29:06Z", "attachment_id": null}, {"count": 6, "text": ">I've been running a few Apache installations on Windows XP for 2+ years \nwithout such issues.\n>There is a problem in some PHP versions below 4.3.4, that kills \n(and restarts) Apache on concurrent requests.\n\nthat's actualy what I was thinking, this usualy doesnt happend during opening a \npage, but at the beginning, when the request open the page being sent to \napache. I was suspicious, that this usualy happens, when many requests are \nbeing sent to apache in the same time.\n\n>Can you reproduce it without loading php4_module?\nwell, it's hard to tell, because as I mentioned above, it usualy happens on \nhight loaded server pereod...\nthe rotatelogs I started using just recently, and it has nothing to do with \napache crashes.\n\n>I don't suppose you're running McAfee Virusscan, by any chance?\nNo, I dont, I use NortonInternetSecurity with NortonAntivirus, but I'm sure it \ndoesnt affect anything, since I've tested apache2 on fresh windows installation \nwithout anything else installed.\n\nP.S. is PHP v4.3.4 is out???? :)", "bug_id": 22631, "is_private": false, "id": 45695, "time": "2003-10-14T22:33:50Z", "creator": "spam@come.no-ip.com", "creation_time": "2003-10-14T22:33:50Z", "tags": [], "attachment_id": null}, {"count": 7, "tags": [], "creator": "jwoolley@apache.org", "text": "Oh well, it was worth asking.  As for PHP, 4.3.4RC1 was released on Sept. 29 \naccording to http://www.php.net/, so I assume that's the latest rev. \n \nDo you get any interesting messages in the error log when it crashes?  What if \nyou set the LogLevel to DEBUG? ", "id": 45696, "time": "2003-10-14T22:38:35Z", "bug_id": 22631, "creation_time": "2003-10-14T22:38:35Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 22631, "is_private": false, "text": "> the rotatelogs I started using just recently, and it has nothing to do with\n> apache crashes.\n\nBut does it have to do with the hangups when it crashes/restarts?\n\n> P.S. is PHP v4.3.4 is out???? :)\n\nAs Cliff said RC1 one is out, but I meant that it was first fixed in the 4.3.4-\ndev version. See: http://bugs.php.net/bug.php?id=25570", "id": 45697, "time": "2003-10-14T22:53:48Z", "creator": "robert@profundis.se", "creation_time": "2003-10-14T22:53:48Z", "attachment_id": null}, {"count": 9, "tags": [], "creator": "spam@come.no-ip.com", "attachment_id": null, "is_private": false, "id": 45755, "time": "2003-10-15T17:36:49Z", "bug_id": 22631, "creation_time": "2003-10-15T17:36:49Z", "text": "> But does it have to do with the hangups when it crashes/restarts?\n\nIf u ment \"What does it have to do with...\" - answer: nothing, I just mentioned \nit, as its actualy become a big problem after all...\nIf u asked \"Does it have anything to do with...\" - answer: no, Apache2 crashes \nas much with rotatelogs.exe as without it.\n\n\nNow some good news: \nafter installing PHP v4.3.4RC1 my apache has been running for 24 hours so far \nwithout a single crash! with same load.\n\nnow question: how PHP can can cause apache die so hard, that even OS can not \nclean up the mess?\nI'm not a big programmer and dont understand how all this works...just curious."}, {"count": 10, "tags": [], "bug_id": 22631, "is_private": false, "text": "> now question: how PHP can can cause apache die so hard, that even OS can not\n> clean up the mess?\n\nApache on Windows runs in two processes; the main \"listener\" and the \"worker\".\nThe former takes care of housekeeping etc, while the latter does the actual\nserving. When crashing, it is almost always the latter, and the main process can\nspawn a new one. I don't know what caused your Apache to hang so long before\nspawning the new worker process, but I have a feeling it might be related to\nrotatelogs.\n\nI change the report's status to INVALID, as the main issue (crashing) was PHP\nrelated, although the hanging is yet unresolved. Feel free to re-open it.", "id": 46200, "time": "2003-10-24T04:52:43Z", "creator": "robert@profundis.se", "creation_time": "2003-10-24T04:52:43Z", "attachment_id": null}, {"count": 11, "tags": [], "text": "I've just witnessed the same thing under Windows 2003 with Apache 2.0.52. It\ngets worse and worse and worse until the current rotatelogs.exe processes can no\nlonger access the log files, resulting in Apache hanging and not restarting.", "is_private": false, "id": 64956, "creator": "joel@preacherboy.net", "time": "2004-10-12T01:25:03Z", "bug_id": 22631, "creation_time": "2004-10-12T01:25:03Z", "attachment_id": null}, {"count": 12, "tags": [], "text": "Opening bug.", "is_private": false, "id": 64957, "creator": "joel@preacherboy.net", "time": "2004-10-12T01:25:45Z", "bug_id": 22631, "creation_time": "2004-10-12T01:25:45Z", "attachment_id": null}, {"count": 13, "tags": [], "bug_id": 22631, "is_private": false, "text": "You can get Apache2 to crash by using PHP 5.0.2 as a module. More details are\navailable at:\n\nhttp://bugs.php.net/?id=30405", "id": 64958, "time": "2004-10-12T01:27:31Z", "creator": "joel@preacherboy.net", "creation_time": "2004-10-12T01:27:31Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 22631, "text": "Assigend to the PHP guys.", "count": 14, "id": 64972, "time": "2004-10-12T07:52:55Z", "creator": "nd@perlig.de", "creation_time": "2004-10-12T07:52:55Z", "is_private": false}, {"count": 15, "tags": [], "bug_id": 22631, "is_private": false, "text": "It might be good to clarify in the summary that this is a PHP issue [for those\nof us who could care less about PHP but care dearly for stability of the core on\nWindows].", "id": 64986, "time": "2004-10-12T14:15:23Z", "creator": "jessh@ptc.com", "creation_time": "2004-10-12T14:15:23Z", "attachment_id": null}]