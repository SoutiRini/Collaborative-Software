[{"count": 0, "tags": [], "text": "Nick,\n\nSomething is wrong with adding new slides.\nOperation works only if you add the first slide to an empty presentation.\n\nI attached the test cases.\n\n(1) This is the only case when it works. \n\n    public void testAddSlides1() throws Exception {\n        SlideShow ppt = new SlideShow();\n        assertTrue(ppt.getSlides().length == 0);\n        ppt.createSlide();\n        assertTrue(ppt.getSlides().length == 1);\n\n        //serialize and read again\n        ByteArrayOutputStream out = new ByteArrayOutputStream();\n        ppt.write(out);\n        out.close();\n\n        ppt = new SlideShow(new HSLFSlideShow(new\nByteArrayInputStream(out.toByteArray())));\n        assertTrue(ppt.getSlides().length == 1);\n    }\n\n\n\n\n(2)  The same as above but add 2 slides. The ppt is silently serialized but\nif you open it looks corrupted. Also number of slides is wrong.\n\n    public void testAddSlides2() throws Exception {\n        SlideShow ppt = new SlideShow(new HSLFSlideShow(dirname + \"/empty.ppt\"));\n        assertTrue(ppt.getSlides().length == 0);\n        ppt.createSlide();\n        assertTrue(ppt.getSlides().length == 1);\n        ppt.createSlide();\n        assertTrue(ppt.getSlides().length == 2);\n\n        //serialize and read again\n         ByteArrayOutputStream out = new ByteArrayOutputStream();\n        ppt.write(out);\n        out.close();\n\n        ppt = new SlideShow(new HSLFSlideShow(new\nByteArrayInputStream(out.toByteArray())));\n        assertTrue(ppt.getSlides().length == 2);\n    }\n\n(3) \n Adding slides to a ppt fails on serialization. Any tricks with PersistPtrHolder\nrequired? \n\n    public void testAddSlides3() throws Exception {\n        SlideShow ppt = new SlideShow(new HSLFSlideShow(dirname +\n\"/basic_test_ppt_file.ppt\"));\n        assertTrue(ppt.getSlides().length == 2);\n        ppt.createSlide();\n        assertTrue(ppt.getSlides().length == 3);\n\n        //serialize and read again\n         ByteArrayOutputStream out = new ByteArrayOutputStream();\n        ppt.write(out);\n        out.close();\n\n        ppt = new SlideShow(new HSLFSlideShow(new\nByteArrayInputStream(out.toByteArray())));\n        assertTrue(ppt.getSlides().length == 3);\n    }\n\nRegards, Yegor", "attachment_id": null, "id": 87214, "creator": "yegor@dinom.ru", "time": "2006-03-24T16:10:41Z", "bug_id": 39096, "creation_time": "2006-03-24T16:10:41Z", "is_private": false}, {"count": 1, "tags": [], "text": "Created attachment 17969\ntest case", "attachment_id": 17969, "bug_id": 39096, "id": 87215, "time": "2006-03-24T16:12:19Z", "creator": "yegor@dinom.ru", "creation_time": "2006-03-24T16:12:19Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 39096, "is_private": false, "count": 2, "id": 87219, "time": "2006-03-24T16:51:56Z", "creator": "apache@gagravarr.org", "creation_time": "2006-03-24T16:51:56Z", "text": "Bah, guess my changes to your code to make it easier to follow ended up breaking\nstuff :(\n\nCan you confirm that your test case does work on the code you submitted? If so,\nI'll need to compare your original code to my new stuff, and see what I broke\nwhen I tried to make it easier to understand....."}, {"count": 3, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "is_private": false, "id": 87287, "time": "2006-03-26T20:08:58Z", "bug_id": 39096, "creation_time": "2006-03-26T20:08:58Z", "text": "Should work now - had to make sure everything correctly updated internal views,\nand then tweak how the PersistPtrHandler stuff happened"}]