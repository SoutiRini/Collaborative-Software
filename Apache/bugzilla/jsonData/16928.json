[{"count": 0, "tags": [], "text": "When finishing up a build I can not delete JAR files.  No matter what order I \nput them in, it always fails.  This is with the most current build from the \nsite.", "attachment_id": null, "bug_id": 16928, "id": 31011, "time": "2003-02-10T15:26:39Z", "creator": "tgreening@yahoo.com", "creation_time": "2003-02-10T15:26:39Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 16928, "is_private": false, "id": 31025, "creation_time": "2003-02-10T18:00:53Z", "time": "2003-02-10T18:00:53Z", "creator": "stevel@apache.org", "text": "you are probably using them, somehow -forked <java> task, <Taskdef> import,\nsoemthing like that? Is this the case? What is the exact error message? \n\nAlso, can you delete them from the DOS command line? That shows if the OS thinks\nthey are in use.", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 16928, "attachment_id": null, "id": 31027, "time": "2003-02-10T18:22:27Z", "creator": "tgreening@yahoo.com", "creation_time": "2003-02-10T18:22:27Z", "is_private": false, "text": "I can delete the JAR files from the DOS command.\n\nHere is a snippet from the build.xml:\n\n\t<!--Previous to this I extract files (jar's and classes) from PVCS -->\n\t<target name=\"CreateZip\">\n        <zip zipfile=\"${currentBuild.dir}/framework.zip\">\n            <fileset dir=\"${extract.dir}\" includes=\"**/*.jar, **/*.doc,\"/>\n        </zip>\n    </target>\n\n    <!--\n++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++  \n-->\n    <!--  In the clean target, delete the extract directory (except jar files - \nproblem)-->\n    <!--\n++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++  \n-->\n    <target name=\"clean\">\n        <delete includeEmptyDirs=\"true\">\n            <fileset dir=\"${extract.dir}\">\n            </fileset>\n        </delete>\n    </target>\n\nI get the error on the delete command.  If I try the same command at the start \nof my build.xml (clean up from previous build), it works fine."}, {"count": 3, "tags": [], "bug_id": 16928, "attachment_id": null, "id": 31028, "creation_time": "2003-02-10T18:25:58Z", "time": "2003-02-10T18:25:58Z", "creator": "tgreening@yahoo.com", "text": "The exact error message is \"/build.xml:239: Unable to delete file foo.jar\"", "is_private": false}, {"count": 4, "tags": [], "text": "There has been an error in src/main/org/apache/tools/ant/taskdefs/Jar.java which has been \nintroduced in revision 1.59 on Fri Jan 17 12:30:44 2003 UTC and fixed with revision 1.61 Mon Feb 3 \n15:41:18 2003 UTC. The bug was in the method public void setDestFile(File jarFile) and left files \nlocked on Windows after having checked their manifest.\nI would advise you to download the \nlatest nightly build, and this problem should be gone.", "is_private": false, "id": 31033, "creator": "levylambert@tiscali-dsl.de", "time": "2003-02-10T19:32:44Z", "bug_id": 16928, "creation_time": "2003-02-10T19:32:44Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 16928, "attachment_id": null, "id": 31053, "time": "2003-02-11T09:38:43Z", "creator": "bodewig@apache.org", "creation_time": "2003-02-11T09:38:43Z", "is_private": false, "text": "I don't think Tony is running a nightly build.\n\nCan you <delete> foo.jar after checking it out from PVCS but before invoking\n<zip>?"}, {"count": 6, "tags": [], "text": "I can delete the file after checking it out of PVCS before invoking ANT.  I am \nchecking the files out of PVCS in the ANT script and verified that I can delete \nthe files after checking them out in the ANT script.  It allows me to delete \nall other files, except JAR files, in the script.  I have tried the newest \nnightly build and it fails there too.", "is_private": false, "bug_id": 16928, "id": 31071, "time": "2003-02-11T13:46:51Z", "creator": "tgreening@yahoo.com", "creation_time": "2003-02-11T13:46:51Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 16928, "is_private": false, "id": 31239, "creation_time": "2003-02-13T15:53:53Z", "time": "2003-02-13T15:53:53Z", "creator": "tgreening@yahoo.com", "text": "I have done more testing and found that I can clean these JAR files up the next \ntime I invoke the ANT script.  The first thing I do is delete the JAR files \nthat were there from the last build. \n\nSo I assume somehow these files are remaining locked by some process in Ant.  \nThe next time I run that lock is gone so I can delete them.", "attachment_id": null}, {"count": 8, "tags": [], "creator": "jan.vanlysebeth@sbs.vlaanderen.be", "attachment_id": null, "id": 31290, "time": "2003-02-14T12:50:51Z", "bug_id": 16928, "creation_time": "2003-02-14T12:50:51Z", "is_private": false, "text": "I have the same problem with current version (so I didn't test with nightly\nbuild). The project were I  encountered the \"deleteing jar file problem\" doesn't\nrun ant from command line, but starts ant from a java application. The\njavac-task used in my project needs a tools.jar in the classpath. I noticed that\nI can delete the jar-file with tools.jar from jdk1.2.2 and not with the one from\njdk1.3.1.\n"}, {"count": 9, "tags": [], "bug_id": 16928, "attachment_id": null, "id": 31329, "time": "2003-02-15T08:15:06Z", "creator": "conor@apache.org", "creation_time": "2003-02-15T08:15:06Z", "is_private": false, "text": "If the jars are used by the compiler, it is likely that the compiler has locked\nthe jars. I thing the 1.3 compiler is the most likely candidate here. It also\nhas a few memory leaks which suggest some objects (and jar locks) not being\ncleaned up. What about JDK 1.4? It has reduced the memory leaks, apparently, som\nmay also release locks on the jar.\n\nCan you confirm that you are using <javac> with these jars in the classpath? If\nso, can you try forking the <javac> (set fork=\"yes\") to see if that clears the\nproblem. If that doesn't let you delete the jars, try to narrow down which task\nor tasks cause the jars to lock.\n\nThanks"}, {"count": 10, "tags": [], "text": "I have narrowed it to a javac task.  When I issue that command within ANT using \nJDK 1.3, I can not delete and JAR file that was referenced by the code being \ncompiled.\n\nConor MacNeill had it right.  Setting the fork=\"yes\" kills this problem.\n\n", "attachment_id": null, "id": 31541, "creator": "tgreening@yahoo.com", "time": "2003-02-18T18:38:08Z", "bug_id": 16928, "creation_time": "2003-02-18T18:38:08Z", "is_private": false}, {"count": 11, "tags": [], "bug_id": 16928, "attachment_id": null, "is_private": false, "id": 31543, "time": "2003-02-18T19:28:43Z", "creator": "alexeys@inventigo.com", "creation_time": "2003-02-18T19:28:43Z", "text": "There is a note about a bug fixed in 1.3.1.07 - Sun now explicitly closes zip\nfiles in compiler."}, {"count": 12, "tags": [], "creator": "altumano@hot.ee", "attachment_id": null, "is_private": false, "id": 36018, "time": "2003-04-24T19:39:05Z", "bug_id": 16928, "creation_time": "2003-04-24T19:39:05Z", "text": "I have the same problem when using JDK 1.4, but JDK 1.4.1_02 works well.\nAnd fork=\"yes\" helps.\n\nThis problem is actually documented under <javac> task."}, {"count": 13, "tags": [], "bug_id": 16928, "is_private": false, "id": 70520, "creation_time": "2005-02-04T21:56:56Z", "time": "2005-02-04T21:56:56Z", "creator": "stevel@apache.org", "text": "Tom,\nJust adding something to this bugrep, which is Ant1.6.2 has a deleteonexit\nattribute for <delete>. This tells Ant to tell the JVM to delete these files\nwhen the JVM itself exits, if an immediate delete fails. If you still have your\nproblem, try this flag.", "attachment_id": null}]