[{"id": 3041, "tags": [], "creator": "ekyu@asgnet.psc.sc.edu", "attachment_id": null, "count": 0, "text": "I'm using the binary version of tomcat 3.2.2 and after setting the admin \napplication to trusted in the server.xml and added the admin user into tomcat-\nusers.xml, the admin application errored out with the following URL and error \nmessage when I'm trying to view all the contexts:\n\nhttp://quadstar.psc.sc.edu/admin/contextAdmin/contextAdmin.jsp?\nsubmit=View+All+Contexts&addContextPath=&addContextDocBase=&removeContextName=\n\nError: 500\nLocation: /admin/contextAdmin/contextAdmin.jsp\nInternal Servlet Error:\njavax.servlet.ServletException: URL contains encoded special chars.\n\tat java.lang.Exception.(Exception.java:44)\n\tat javax.servlet.ServletException.(ServletException.java:161)\n\tat org.apache.jasper.runtime.PageContextImpl.handlePageException\n(PageContextImpl.java:459)\n\tat \ncontextAdmin._0002fcontextAdmin_0002fcontextAdmin_0002ejspcontextAdmin_jsp_0._js\npService(_0002fcontextAdmin_0002fcontextAdmin_0002ejspcontextAdmin_jsp_0.java\n(Compiled Code))\n\tat org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:119)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat org.apache.jasper.servlet.JspServlet$JspCountedServlet.service\n(JspServlet.java:130)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat org.apache.jasper.servlet.JspServlet$JspServletWrapper.service\n(JspServlet.java:282)\n\tat org.apache.jasper.servlet.JspServlet.serviceJspFile\n(JspServlet.java:429)\n\tat org.apache.jasper.servlet.JspServlet.service(JspServlet.java:500)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat org.apache.tomcat.core.ServletWrapper.doService\n(ServletWrapper.java:405)\n\tat org.apache.tomcat.core.Handler.service(Handler.java:287)\n\tat org.apache.tomcat.core.ServletWrapper.service\n(ServletWrapper.java:372)\n\tat org.apache.tomcat.core.ContextManager.internalService\n(ContextManager.java:797)\n\tat org.apache.tomcat.core.ContextManager.service\n(ContextManager.java:743)\n\tat \norg.apache.tomcat.service.connector.Ajp12ConnectionHandler.processConnection\n(Ajp12ConnectionHandler.java:166)\n\tat org.apache.tomcat.service.TcpWorkerThread.runIt(PoolTcpEndpoint.java\n(Compiled Code))\n\tat org.apache.tomcat.util.ThreadPool$ControlRunnable.run\n(ThreadPool.java:501)\n\tat java.lang.Thread.run(Thread.java:498)\nRoot cause: \njava.lang.IllegalArgumentException: URL contains encoded special chars.\n\tat java.lang.Exception.(Exception.java:44)\n\tat java.lang.RuntimeException.(RuntimeException.java:49)\n\tat java.lang.IllegalArgumentException.(IllegalArgumentException.java:45)\n\tat org.apache.tomcat.util.RequestUtil.URLDecode(RequestUtil.java:317)\n\tat ContextAdmin.getContextInfo(ContextAdmin.java:76)\n\tat \ncontextAdmin._0002fcontextAdmin_0002fcontextAdmin_0002ejspcontextAdmin_jsp_0._js\npService(_0002fcontextAdmin_0002fcontextAdmin_0002ejspcontextAdmin_jsp_0.java\n(Compiled Code))\n\tat org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:119)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat org.apache.jasper.servlet.JspServlet$JspCountedServlet.service\n(JspServlet.java:130)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat org.apache.jasper.servlet.JspServlet$JspServletWrapper.service\n(JspServlet.java:282)\n\tat org.apache.jasper.servlet.JspServlet.serviceJspFile\n(JspServlet.java:429)\n\tat org.apache.jasper.servlet.JspServlet.service(JspServlet.java:500)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat org.apache.tomcat.core.ServletWrapper.doService\n(ServletWrapper.java:405)\n\tat org.apache.tomcat.core.Handler.service(Handler.java:287)\n\tat org.apache.tomcat.core.ServletWrapper.service\n(ServletWrapper.java:372)\n\tat org.apache.tomcat.core.ContextManager.internalService\n(ContextManager.java:797)\n\tat org.apache.tomcat.core.ContextManager.service\n(ContextManager.java:743)\n\tat \norg.apache.tomcat.service.connector.Ajp12ConnectionHandler.processConnection\n(Ajp12ConnectionHandler.java:166)\n\tat org.apache.tomcat.service.TcpWorkerThread.runIt(PoolTcpEndpoint.java\n(Compiled Code))\n\tat org.apache.tomcat.util.ThreadPool$ControlRunnable.run\n(ThreadPool.java:501)\n\tat java.lang.Thread.run(Thread.java:498)\n\nI have a feeling that has to do with the bug fix from 3.2.1 (3.2.1 admin app is \nworking) to 3.2.2 because in fact 3.2.2 has resolved a good bit of security fix \non parsing request URLS.", "time": "2001-06-18T10:47:21Z", "bug_id": 2219, "creation_time": "2001-06-18T10:47:21Z", "is_private": false}, {"count": 1, "tags": [], "creator": "cmanolache@yahoo.com", "is_private": false, "text": "The admin app seem to work fine in 3.3. If you can submit a patch for 3.2.2\nit might get into 3.2.3, but changing URLDecode is dangerous for security \n( the workaround should be in admin ).", "id": 3086, "time": "2001-06-19T22:14:11Z", "bug_id": 2219, "creation_time": "2001-06-19T22:14:11Z", "attachment_id": null}, {"count": 2, "attachment_id": null, "bug_id": 2219, "is_private": false, "id": 3120, "time": "2001-06-20T07:39:44Z", "creator": "ekyu@asgnet.psc.sc.edu", "creation_time": "2001-06-20T07:39:44Z", "tags": [], "text": "I agree with you changing the DecodeURL() is not a good idea. I've taken out the\ncalling of the DecodeURL() in the ContextAdmin.java and that seems to fix the\nproblem. Now that the question left is whether it is the proper behavior to\nthrow an exception when there is special character (containing %XX characters)\nin the URL when calling DecodeURL()."}]