[{"count": 0, "tags": [], "text": "Created attachment 25352\na spreadsheet with a single named range with a comment\n\nI am trying to read a spreadsheet created in excel 2007 and saved as an \"Excel 97-2003 Workbook\". Using the new UI for the name manager, I create a Name whose name is \"foobarName\" and whose comment is \"This is a comment\". POI claims that the comment for the name is blank. It should be noted that reading the xlsx file, POI correctly returns the comment.\n\nI have looked at the xls file produced by excel (attached) and noticed an unknown record (0x894). This seems to be the record intended to store the comment for names.\n\nThe current implementation of HSSFName#getComment uses the \"Description text\" field of the NAME record. Unfortunately I have no idea what \"Description text\" is supposed to contain and so I'm loathed to suggest simply ignoring this field in favour of the NAMECMT record.\n\nI am currently working on a patch for support of NAMECMT records but would like to know what the correct behaviour should be.", "is_private": false, "id": 136410, "creator": "aks@corefiling.co.uk", "time": "2010-04-26T06:25:29Z", "bug_id": 49185, "creation_time": "2010-04-26T06:25:29Z", "attachment_id": 25352}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "text": "I think NameCmt may be quite a new thing\n\nHSSFName is backed by a NameRecord (sid=0x18), which is called a \"Lbl\" in the newer Microsoft docs (page 323 in v20091214)\n\nHSSFName stores the comment in the DescriptionText field of NameRecord (field 15).\n\nInterestingly, the latest docs on Lbl says that the various extra length fields (eg the description) are reserved and must be zero, so clearly Microsoft have changed something at some point. This would explain why new files don't have comments in the same way\n\nI'd suggest you add support for the NameCmt record, and update HSSFName to check it if the description text on a NameRecord is of length zero", "id": 136411, "time": "2010-04-26T06:39:23Z", "bug_id": 49185, "creation_time": "2010-04-26T06:39:23Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 49185, "attachment_id": 25705, "text": "Created attachment 25705\npatch to support 'NameCommentRecord's\n\nThis patch parses and stores NameCommentRecord records and changes the implementation of HSSFName#getComment to use it's Description text and if that isn't available an associated NameCommentRecord.", "id": 138170, "time": "2010-07-05T09:52:31Z", "creator": "aks@corefiling.co.uk", "creation_time": "2010-07-05T09:52:31Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 49185, "attachment_id": 25706, "is_private": false, "id": 138171, "time": "2010-07-05T09:54:23Z", "creator": "aks@corefiling.co.uk", "creation_time": "2010-07-05T09:54:23Z", "text": "Created attachment 25706\ntest-data file for test added in previous patch\n\nA file for testing. This should be placed in test-data/spreadsheet"}, {"count": 4, "tags": [], "bug_id": 49185, "is_private": false, "text": "Thanks for this. Applied in r964845, along with some tweaks to make changes possible, and to support renaming names carrying their comments with them", "id": 138472, "time": "2010-07-16T12:03:51Z", "creator": "apache@gagravarr.org", "creation_time": "2010-07-16T12:03:51Z", "attachment_id": null}]