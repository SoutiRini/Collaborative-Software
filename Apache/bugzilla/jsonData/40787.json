[{"count": 0, "tags": [], "creator": "tobias.barth@web-arts.de", "attachment_id": null, "is_private": false, "id": 94932, "time": "2006-10-18T06:44:03Z", "bug_id": 40787, "creation_time": "2006-10-18T06:44:03Z", "text": "I got the error \"too many open files\" and \"too many open files in system\" after \nsome hours of load testing.\n\nOn SuSE 10.1 (PC Platform, 32Bit SMP), the most open file is \"/dev/random\", but \nin my SSL settings, I use the \"builtin\" random generator instead \nof \"/dev/random\".\n\ncurrently, after 15 hours of stress tests (JMeter on 2 machines with 40 threads \neach), I got 91 httpd processes running, with 23040 open files in the whole \nsystem, and 21552 of them being \"/dev/random\" used by \"httpd\" (prefork)-process:\n\nwww:/proc/sys/fs # cat file-nr\n23040   0       500000\nwww:/proc/sys/fs # ps ax|grep httpd|wc -l\n91\nwww:/proc/sys/fs # lsof |grep random|grep httpd|wc -l\n21552\nwww:/proc/sys/fs # rpm -q apache2\napache2-2.2.0-21.7\nwww:/proc/sys/fs #"}, {"count": 1, "tags": [], "bug_id": 40787, "text": "What SSL configuration is being used?", "id": 99857, "time": "2007-02-27T09:09:46Z", "creator": "jorton@redhat.com", "creation_time": "2007-02-27T09:09:46Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "dg@artegic.de", "is_private": false, "text": "Are you using PHP? There is an open error in the PHP bug database with some similarities in a Apache 2 \n/ PHP 5 runtime environment...it is still unclear if the error is caused by PHP or by mod_ssl / Apache.\n\nhttp://bugs.php.net/bug.php?id=43105\n\n\n(In reply to comment #0)\n> I got the error \"too many open files\" and \"too many open files in system\" after \n> some hours of load testing.\n> \n> On SuSE 10.1 (PC Platform, 32Bit SMP), the most open file is \"/dev/random\", but \n> in my SSL settings, I use the \"builtin\" random generator instead \n> of \"/dev/random\".\n> \n> currently, after 15 hours of stress tests (JMeter on 2 machines with 40 threads \n> each), I got 91 httpd processes running, with 23040 open files in the whole \n> system, and 21552 of them being \"/dev/random\" used by \"httpd\" (prefork)-process:\n> \n> www:/proc/sys/fs # cat file-nr\n> 23040   0       500000\n> www:/proc/sys/fs # ps ax|grep httpd|wc -l\n> 91\n> www:/proc/sys/fs # lsof |grep random|grep httpd|wc -l\n> 21552\n> www:/proc/sys/fs # rpm -q apache2\n> apache2-2.2.0-21.7\n> www:/proc/sys/fs #", "id": 112870, "time": "2008-01-15T07:05:21Z", "bug_id": 40787, "creation_time": "2008-01-15T07:05:21Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "sf@sfritsch.de", "is_private": false, "id": 148857, "creation_time": "2011-08-27T17:18:29Z", "time": "2011-08-27T17:18:29Z", "bug_id": 40787, "text": "I assume this was a PHP issue. Please reopen if it still happens with current httpd.", "attachment_id": null}]