[{"count": 0, "tags": [], "bug_id": 32216, "attachment_id": null, "text": "I have code to programmatically invoke Ant that uses the deprecated method\nconfigureProject and works fine:\n\nProject proj = new Project();\nproj.fireBuildStarted();\nproj.init();\n\ntry {\n     ProjectHelper.configureProject(proj, new File(\"build.xml\"));\n     proj.executeTarget(proj.getDefaultTarget());\n     proj.fireBuildFinished(null);\n    } catch (BuildException e) {\n     proj.fireBuildFinished(e);\n     throw e;\n  }\n\nI replaced the line:\nProjectHelper.configureProject(proj, new File(\"build.xml\"));\n\nwith the non-deprecated version:\nProjectHelper helper = ProjectHelper.getProjectHelper();\nhelper.parse(proj, new File(\"build.xml\"));\n\nThis worked fine until I had a build.xml file with an import statement in it.\ne.g.\n<project name=\"test\" default=\"test\">\n\t<import file=\"build2.xml\" />\n\t<target name=\"test\">\n\t\t<echo message=\"Hello World\" />\n\t</target>\n</project>\n\nThis caused the import task to throw a NullPointer exception in the execute method:\n\nC:\\ASCv2Workspace\\test\\build.xml:2: java.lang.NullPointerException\n\tat org.apache.tools.ant.Task.perform(Task.java:373)\n\tat org.apache.tools.ant.Target.execute(Target.java:341)\n\tat org.apache.tools.ant.helper.ProjectHelper2.parse(ProjectHelper2.java:133)\n\tat Test.main(Test.java:31)\n--- Nested Exception ---\njava.lang.NullPointerException\n\tat org.apache.tools.ant.taskdefs.ImportTask.execute(ImportTask.java:104)\n\tat org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:275)\n\tat org.apache.tools.ant.Task.perform(Task.java:364)\n\tat org.apache.tools.ant.Target.execute(Target.java:341)\n\tat org.apache.tools.ant.helper.ProjectHelper2.parse(ProjectHelper2.java:133)\n\tat Test.main(Test.java:31)\nException in thread \"main\" \n\nI checked, and the null pointer was thrown by:\n  Vector importStack = helper.getImportStack();\nbecause helper is null.  \n\nComparing the configureProject deprecated method and the parse method, it looks\nlike parse never sets the \"ant.projectHelper\" property.", "id": 66823, "time": "2004-11-12T22:53:06Z", "creator": "ngawor@us.ibm.com", "creation_time": "2004-11-12T22:53:06Z", "is_private": false}, {"text": "You need to set the reference \"ant.projectHelper\" as well.\nI have removed the \"deprecated\" tag for the static method.", "tags": [], "bug_id": 32216, "is_private": false, "count": 1, "id": 68394, "time": "2004-12-13T17:49:40Z", "creator": "peterreilly@apache.org", "creation_time": "2004-12-13T17:49:40Z", "attachment_id": null}]