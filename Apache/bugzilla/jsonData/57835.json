[{"count": 0, "tags": [], "bug_id": 57835, "attachment_id": 32666, "id": 182502, "time": "2015-04-20T17:58:04Z", "creator": "apire@sparklyvernis.com", "creation_time": "2015-04-20T17:58:04Z", "is_private": false, "text": "Created attachment 32666\nSlide Source and Destination (couple Printshots)\n\nHave a presentation with a chart and some notes.\n\nRunning the code below using the resources attached to this issue (src.pptx) generates the dst.pptx, such file is not being generated correctly, charts and notes are missing as shown in the attached pictures. The dst file can not be opened using powerpoint.\n\nPOI:\npoi-ooxml-3.11-20141221 (Latest stable as of today)\nJava:\njdk1.6.0_32 (32 bits)\n\n<TESTCODE>\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.io.OutputStream;\n\nimport org.apache.poi.xslf.usermodel.XMLSlideShow;\nimport org.apache.poi.xslf.usermodel.XSLFSlide;\nimport org.apache.poi.xslf.usermodel.XSLFSlideLayout;\nimport org.apache.poi.xslf.usermodel.XSLFSlideMaster;\n\npublic class POITest {\n\n\tpublic static void main(String[] args) {\n\t\ttry {\n\t\t\tString fnames[] = {\"src.pptx\"};\n\n\t\t\tOutputStream fos = new FileOutputStream(\"dst.pptx\");\n\t\t\tXMLSlideShow ppt_out = new XMLSlideShow();\n\n\t\t\tfor (String file : fnames) {\n\t\t\t\tFileInputStream fis = new FileInputStream(file);\n\t\t\t\tXMLSlideShow src = new XMLSlideShow(fis);\n\n\t\t\t\t\n\t            for(XSLFSlide srcSlide : src.getSlides()){ \n\t                XSLFSlide newSlide = ppt_out.createSlide(); \n\n\n\t                XSLFSlideLayout src_sl = srcSlide.getSlideLayout(); \n\t                XSLFSlideMaster src_sm = srcSlide.getSlideMaster(); \n\n\t                XSLFSlideLayout new_sl = newSlide.getSlideLayout(); \n\t                XSLFSlideMaster new_sm = newSlide.getSlideMaster(); \n\n\t                // copy source layout to the new layout \n\t                new_sl.importContent(src_sl); \n\t                // copy source master to the new master \n\t                new_sm.importContent(src_sm); \n\n\n\t                newSlide.importContent(srcSlide);\t                \n\t            } \t\t\t\t\n\t\t\t\t\n\t\t\t\tfis.close();\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tppt_out.write(fos);\n\t\t\tfos.close();\n\n\t\t} catch (IOException e) {\n\n\t\t}\n\t}\n\n}\n</TESTCODE>"}, {"count": 1, "tags": [], "bug_id": 57835, "attachment_id": null, "text": "I also experience this bug. \nIt seems POI succeeds in copying object, but fails in the type. \nCalling \"getShapeName\" results in the same name, but when trying to convert, here is what it says: \norg.apache.poi.POIXMLDocumentPart cannot be cast to org.apache.poi.xslf.usermodel.XSLFChart\norg.apache.poi.xslf.usermodel.XSLFPictureData cannot be cast to org.apache.poi.xslf.usermodel.XSLFChart\n\nGood news: the generated XML for the new chart object is the same as the original XML. \nThe relation ID is the same (in my case, \"rId2\"). \n\nHowever, when checking in relations file for the slide, \"rId2\" is not bound to a chart anymore, but to an image. \nAlso, some relations are simply missing. \n\nThis seems to be a bug about relationships.", "id": 187112, "time": "2015-12-24T10:41:44Z", "creator": "nicolas.cailloux@linkfluence.com", "creation_time": "2015-12-24T10:41:44Z", "is_private": false}, {"count": 2, "tags": [], "creator": "nicolas.cailloux@linkfluence.com", "text": "When digging in PPTX archive, the charts are not copied. I have as many charts in the new files than in the original one.", "id": 187113, "time": "2015-12-24T10:53:10Z", "bug_id": 57835, "creation_time": "2015-12-24T10:53:10Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "antonin.perrotaudet@orange.com", "text": "Encountering the exact same bug, that prevents me from using POI to generate power point presentations : I don't see how to *insert* graphs while building a presentation because of this bug.", "id": 198627, "time": "2017-05-02T09:15:07Z", "bug_id": 57835, "creation_time": "2017-05-02T09:15:07Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 57835, "attachment_id": null, "id": 200849, "time": "2017-09-13T17:31:18Z", "creator": "Alain.Bearez@cua.li", "creation_time": "2017-09-13T17:31:18Z", "is_private": false, "text": "A partial fix (only handling the charts) is available as pull request #68:\n\nhttps://github.com/apache/poi/pull/68\n\nHowever the changes are not focused in solving only this issue, but in preparing for a shared code base for charts handling."}]