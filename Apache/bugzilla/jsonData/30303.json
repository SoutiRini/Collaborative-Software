[{"count": 0, "tags": [], "creator": "angsuman@taragana.com", "attachment_id": null, "text": "Several word documents(probably all) created on Mac and opened for reading \nproperties on windows caused a UnsupportedEncodingException cp10000 in the line:\nvalue = new String(src, (int) first, l, codepageToEncoding(codepage));\n\nThat is because I think there is a parsing error in extracting the encoding. \nHowever the actual text looked ok. So my workaround was:\n\nvalue = new String(src, (int) first, l);\n                if(codepage != -1) {\n                    try {\n                        value = new String(src, (int) first, l, \ncodepageToEncoding(codepage));\n                    } catch(UnsupportedEncodingException ignore) {\n                        // The previous assignment is acceptable when the \nencoding is not supported\n                        // Want to throw a warning message here, but how?\n                    }\n                }\n\nLet me know if you need any sample documents to demonstrate the error. I have \nquite a few of them.", "id": 61078, "time": "2004-07-24T11:49:58Z", "bug_id": 30303, "creation_time": "2004-07-24T11:49:58Z", "is_private": false}, {"attachment_id": 12207, "tags": [], "bug_id": 30303, "is_private": false, "count": 1, "id": 61079, "time": "2004-07-24T11:51:37Z", "creator": "angsuman@taragana.com", "creation_time": "2004-07-24T11:51:37Z", "text": "Created attachment 12207\nSample Word document which crashes any attempt to read document properties"}, {"count": 2, "tags": [], "text": "Created attachment 12208\nModified source which has a fix/workaround for the defect", "is_private": false, "bug_id": 30303, "id": 61080, "time": "2004-07-24T11:54:02Z", "creator": "angsuman@taragana.com", "creation_time": "2004-07-24T11:54:02Z", "attachment_id": 12208}, {"count": 3, "tags": [], "text": "Hi Angsuman,\n\nI've run the Mac document you supplied as a testcase\nthrough the HWFP code which has had patch 30235 applied.\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=30235\n\nThis works fine, creating a working copy of the document.\nI know that some of the work that was done in creating\nthis patch fixed a number of bugs. As you rightly point out\nthe error is most probably due to a parsing error.\n\nCan you test you code with the above patch applied?\nIf it still doesn't work, can you please post an example\nof the calling line in your application code that will cause \nthe error so that I can take a look at it?\n\nMany thanks,\n             Piers\n\n", "attachment_id": null, "id": 61104, "creator": "piers.taylor@gossinteractive.com", "time": "2004-07-25T15:03:53Z", "bug_id": 30303, "creation_time": "2004-07-25T15:03:53Z", "is_private": false}, {"count": 4, "tags": [], "text": "Appologies everyone - I was logged in on my old account for which the email \naddress is invalid. Please use the email address associated with this account \nif you need to contact me.\n\nPiers", "is_private": false, "id": 61105, "creator": "apachedev@2vu.com", "time": "2004-07-25T15:13:30Z", "bug_id": 30303, "creation_time": "2004-07-25T15:13:30Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "angsuman@taragana.com", "is_private": false, "text": "The new version from CVS has the problem fixed (please see attachment below for\ndetails). Thanks Piers for the prompt response and resolution. Your immediate\nresponse was much much better than I getr from big companies where I pay tons\nfor the product :)\n\n\n------- Additional Comments From piers.taylor@gossinteractive.com  2004-07-25\n15:03 -------\nHi Angsuman,\n\nI've run the Mac document you supplied as a testcase\nthrough the HWFP code which has had patch 30235 applied.\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=30235\n\nThis works fine, creating a working copy of the document.\nI know that some of the work that was done in creating\nthis patch fixed a number of bugs. As you rightly point out\nthe error is most probably due to a parsing error.\n\nCan you test you code with the above patch applied?\nIf it still doesn't work, can you please post an example\nof the calling line in your application code that will cause \nthe error so that I can take a look at it?\n\nMany thanks,\n             Piers", "id": 61756, "time": "2004-08-10T15:35:39Z", "bug_id": 30303, "creation_time": "2004-08-10T15:35:39Z", "attachment_id": null}]