[{"count": 0, "attachment_id": 26210, "creator": "mashmk02@gmail.com", "text": "Created attachment 26210\npatch for AccessLogValve.java\n\nAccessLogValve.rotate() rename the existing log file to something else via JMX.\n\nIf you specify \"../log.txt\" for a new filename, the existing log file is renamed to \"<Tomcat boot directory>/../log.txt\".\nAnd, rotate() overwrite other existing files, if tomcat startup user has the write permission on those files.\n\nFor example...\n---\nTomcat install directory: /opt/tomcat6\nInstall & Startup user  : tomcat6\nSpecified new filename  : /opt/tomcat6/lib/catalina.jar\n---\nIf this is the case, the access log file overwrites catalina.jar.\n\nI attached the patch file.\n\nBest regards.", "id": 141024, "time": "2010-10-25T22:36:31Z", "bug_id": 50156, "creation_time": "2010-10-25T22:36:31Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "chuck.caldarale@unisys.com", "is_private": false, "text": "(In reply to comment #0)\n> If you specify \"../log.txt\" for a new filename, the existing log file is\n> renamed to \"<Tomcat boot directory>/../log.txt\".\n> And, rotate() overwrite other existing files, if tomcat startup user has the\n> write permission on those files.\n\nAnd has permission to use JMX to manipulate Tomcat, which can lead to all sorts of disastrous results if used unwisely.  If you have the privilege to modify the Tomcat configuration, you are expected to do so responsibly.\n\nNote also that your patch prevents anyone from moving the log file(s) to some directory other than the original - severely reducing flexibility.\n\n - Chuck", "id": 141026, "time": "2010-10-25T23:12:50Z", "bug_id": 50156, "creation_time": "2010-10-25T23:12:50Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 50156, "is_private": false, "text": "(In reply to comment #1)\n> (In reply to comment #0)\n> > If you specify \"../log.txt\" for a new filename, the existing log file is\n> > renamed to \"<Tomcat boot directory>/../log.txt\".\n> > And, rotate() overwrite other existing files, if tomcat startup user has the\n> > write permission on those files.\n> \n> And has permission to use JMX to manipulate Tomcat, which can lead to all sorts\n> of disastrous results if used unwisely.  If you have the privilege to modify\n> the Tomcat configuration, you are expected to do so responsibly.\n\nI agree, but a malicious user might do it. \nTherefore, I think that some kind of limitations are necessary. \n# restrict moving to some directory, or ignore the operation if the specified name exists.\n\n> \n> Note also that your patch prevents anyone from moving the log file(s) to some\n> directory other than the original - severely reducing flexibility.\n> \n>  - Chuck\n\nAn old patch was not correct. I will attach the patch.\n\nregards.", "id": 141035, "time": "2010-10-26T04:20:00Z", "creator": "mashmk02@gmail.com", "creation_time": "2010-10-26T04:20:00Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 50156, "is_private": false, "id": 141036, "creation_time": "2010-10-26T04:21:08Z", "time": "2010-10-26T04:21:08Z", "creator": "mashmk02@gmail.com", "text": "Created attachment 26214\npatch for AccessLogValve", "attachment_id": 26214}, {"count": 4, "tags": [], "bug_id": 50156, "text": "Malicious users shouldn't have access to the JMX interface. If they do, they can do far more damage than this.\n\nThere are legitimate use cases for over-writing an existing file and whilst there are alternative solutions for those use cases I don't see any reason to tie the hands of a system administrator unnecessarily.", "id": 141055, "time": "2010-10-26T08:44:50Z", "creator": "markt@apache.org", "creation_time": "2010-10-26T08:44:50Z", "is_private": false, "attachment_id": null}]