[{"count": 0, "text": "The documentation states that certificateKeyAlias is optional, and that \"If not specified, the first key read from the keystore will be used\". It seems that since r1713277, the default of this variable is set to \"tomcat\", which leads to the following exception if the name of the certificate is different:\n\n> java.lang.IllegalArgumentException: java.io.IOException: Alias name tomcat does not identify a key entry\n>     at org.apache.tomcat.util.net.AbstractJsseEndpoint.createSSLContext(AbstractJsseEndpoint.java:103)\n>     at org.apache.tomcat.util.net.AbstractJsseEndpoint.initialiseSsl(AbstractJsseEndpoint.java:81)", "bug_id": 59910, "attachment_id": null, "id": 192709, "time": "2016-07-29T09:08:31Z", "creator": "mike@normi.net", "creation_time": "2016-07-29T09:08:31Z", "tags": [], "is_private": false}, {"count": 1, "text": "Btw, this is with JSSE and a PFX certificate containing only one entry.", "bug_id": 59910, "attachment_id": null, "id": 192710, "time": "2016-07-29T09:13:38Z", "creator": "mike@normi.net", "creation_time": "2016-07-29T09:13:38Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 59910, "is_private": false, "id": 192808, "attachment_id": null, "creator": "remm@apache.org", "creation_time": "2016-08-02T12:50:35Z", "time": "2016-08-02T12:50:35Z", "text": "This was changed since it's a lot harder to do properly with OpenSSL and so it needs an alias name. For consistency, it could be best to keep the new default for both JSSE and OpenSSL, and fix the documentation."}, {"count": 3, "tags": [], "bug_id": 59910, "attachment_id": null, "is_private": false, "id": 192811, "time": "2016-08-02T13:15:28Z", "creator": "mike@normi.net", "creation_time": "2016-08-02T13:15:28Z", "text": "I wouldn't be too happy with that, as most people are not even aware of the fact that a PFX can contain multiple certificates and keys. And in that case it would probably be better to require the user to set a certificateKeyAlias, instead of relying on the default 'tomcat'."}, {"count": 4, "tags": [], "bug_id": 59910, "text": "Thanks for the feedback, but I disagree with that. All of our current examples and howtos use \"tomcat\" as key alias, and \"changeit\" as password (it is the hardcoded default, just like \"tomcat\" is hardcoded again - I think it used to be this way sometime in the past).", "id": 192812, "time": "2016-08-02T13:20:38Z", "creator": "remm@apache.org", "creation_time": "2016-08-02T13:20:38Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 59910, "is_private": false, "id": 192827, "attachment_id": null, "creator": "mike@normi.net", "creation_time": "2016-08-02T20:10:50Z", "time": "2016-08-02T20:10:50Z", "text": "That may be the case, but a PFX file almost always has a password, so people set the password. Nobody knows what the key alias is though (and nobody specifies the name when creating the PFX). This is just going from my experience with the sysadmins we work with, and maybe these sysadmins are to blame, but I think this new 'feature' (or more precisely, the removal of the automatic key alias detection feature) worsens the user experience.\n\nIf it's really difficult with OpenSSL, I can understand the change, but it's still a shame."}, {"count": 6, "tags": [], "bug_id": 59910, "text": "Ok, I experimented and the inconsistency seems acceptable and there's no hardcoding when not needed. It will be included in 9.0.0.M10 and 8.5.5.", "id": 192840, "time": "2016-08-02T23:18:33Z", "creator": "remm@apache.org", "creation_time": "2016-08-02T23:18:33Z", "is_private": false, "attachment_id": null}]