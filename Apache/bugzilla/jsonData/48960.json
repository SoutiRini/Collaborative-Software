[{"count": 0, "tags": [], "text": "The current configuration of the SSI module is \"All\" or \"None\". The \"ALL\" option will expose all the legacy Apache SSI directive (echo, printenv, if, exec, ...). As documented, allowing SSI will allow execution of arbitrary programs using the \"exec\". As a result, there is no safe way to expose sites/projects containing SSI directive, without taking a security risk, or reviewing of every file.\n\nThe \"exec\" directive, with the cmd option is a major risk. Even for Apache, you have the option to allowing the \"safe\" include (includeNoExec). The includeNoExec allow pages to be served, even when the content is not reviewed, or when users are allowed to upload content to the site.\n\nI have a big site which need to be converted into JSP. I would like to use the SSI servlet to allow for transition over time. The extra risk from ( from exec cmd) make it impossible to deploy the SSI.\n\nMy request: Modify the configuration of SSI as follow: By default, it will only allow \"safe\" directive (no exec cmd=...). This will eliminate the risk from arbitrary execution of commands (\"del *.*\"). It will also remove many potentail load problems. The cmd= should only be allowed using a directive like \"allowUnsafeExec\", which will default to false.\n\nI think that the change will make it easier to use the SSI feature, without exposing the server to big risk. The risk associated with the \"safer\" version of SSI is similar to the risk from running JSP pages.", "attachment_id": null, "id": 135535, "creator": "yair.lenga@citi.com", "time": "2010-03-22T16:37:48Z", "bug_id": 48960, "creation_time": "2010-03-22T16:37:48Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 48960, "is_private": false, "count": 1, "id": 135539, "time": "2010-03-22T17:11:06Z", "creator": "markt@apache.org", "creation_time": "2010-03-22T17:11:06Z", "text": "Patches for enhancements are always welcome"}, {"count": 2, "tags": [], "bug_id": 48960, "attachment_id": 25166, "is_private": false, "id": 135541, "time": "2010-03-22T18:06:18Z", "creator": "yair.lenga@citi.com", "creation_time": "2010-03-22T18:06:18Z", "text": "Created attachment 25166\nReplacement for  SSIServlet.java SSIProcessor.java SSIFilter.java\n\nAttached is a quick fix that adds 'allowExec' parameter to the SSI servlet and filter. I could not build the complete Tomcat tree - I'll be happy to test any patched version with this (or similar change).\n\nOverall < 50 lines of changes.\n\nBasic logic: remove the exec command from the SSIProcessor, unless the allow_exec is true."}, {"count": 3, "tags": [], "bug_id": 48960, "attachment_id": null, "id": 135542, "time": "2010-03-22T18:10:55Z", "creator": "yair.lenga@citi.com", "creation_time": "2010-03-22T18:10:55Z", "is_private": false, "text": "Will you take a patch for Tomcat 5.5 ?\n\nI'm using RedHat5, which has a Tomcat 5.5 bundled in. It's much easier to get a security upgrade installed, than to get a new version upgrade."}, {"count": 4, "tags": [], "bug_id": 48960, "attachment_id": null, "id": 138001, "time": "2010-06-29T12:45:54Z", "creator": "markt@apache.org", "creation_time": "2010-06-29T12:45:54Z", "is_private": false, "text": "*** Bug 49520 has been marked as a duplicate of this bug. ***"}, {"count": 5, "tags": [], "bug_id": 48960, "attachment_id": null, "id": 138304, "time": "2010-07-09T10:01:32Z", "creator": "yair.lenga@citi.com", "creation_time": "2010-07-09T10:01:32Z", "is_private": false, "text": "(In reply to comment #4)\n> *** Bug 49520 has been marked as a duplicate of this bug. ***\n\nMark,\n\nIs there anything I can do to speed up the inclusion of this change ? I've noticed it did not make it for 6.0.28, where few other CGI/SSI related changed were incorporated. I would love to use the SSI, but I can not use it because of the security reisk of the \"unsafe\" include/exec."}, {"attachment_id": null, "tags": [], "bug_id": 48960, "is_private": false, "count": 6, "id": 138305, "time": "2010-07-09T10:17:16Z", "creator": "markt@apache.org", "creation_time": "2010-07-09T10:17:16Z", "text": "Providing patches in diff -u format would help."}, {"count": 7, "tags": [], "creator": "yair.lenga@citi.com", "attachment_id": 25760, "text": "Created attachment 25760\nPatch to disable exec by default, new allowExec tag\n\nPatch for three files, created against 6.0.26-src", "id": 138406, "time": "2010-07-13T15:52:28Z", "bug_id": 48960, "creation_time": "2010-07-13T15:52:28Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 48960, "attachment_id": null, "id": 138407, "time": "2010-07-13T17:16:40Z", "creator": "markt@apache.org", "creation_time": "2010-07-13T17:16:40Z", "is_private": false, "text": "The diff is inverted and the patch is using tabs rather than spaces. I should eb able to work with that but you might need to fix it."}, {"count": 9, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "text": "In the end I used the patch a guide and write a new one. Some additional comments:\n- if you do an svn diff against a normal source tree patches usually apply cleanly\n- new features should be documented\n\nThe patch has been applied to truck and proposed for 6.0.x", "id": 138408, "time": "2010-07-13T17:38:55Z", "bug_id": 48960, "creation_time": "2010-07-13T17:38:55Z", "is_private": false}, {"count": 10, "tags": [], "creator": "yair.lenga@citi.com", "attachment_id": null, "text": "Mark,\n\nThanks for taking the change. I'll follow you suggestions regarding svn diff for the next time.\n\nDo I have to submit anything for the change to flow to 7.X ?\n\nYair", "id": 138409, "time": "2010-07-13T17:54:53Z", "bug_id": 48960, "creation_time": "2010-07-13T17:54:53Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 48960, "is_private": false, "count": 11, "id": 138410, "time": "2010-07-13T18:08:34Z", "creator": "markt@apache.org", "creation_time": "2010-07-13T18:08:34Z", "text": "Sorry truck should have been trunk and trunk == 7.0.x so it is already there."}, {"count": 12, "tags": [], "bug_id": 48960, "attachment_id": null, "id": 138455, "time": "2010-07-16T06:23:49Z", "creator": "markt@apache.org", "creation_time": "2010-07-16T06:23:49Z", "is_private": false, "text": "Fixed in 6.0.x and will be included in 6.0.29 onwards."}]