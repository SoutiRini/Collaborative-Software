[{"attachment_id": null, "tags": [], "bug_id": 39190, "is_private": false, "count": 0, "id": 87544, "time": "2006-04-03T20:31:01Z", "creator": "rnice@fraudscrub.com", "creation_time": "2006-04-03T20:31:01Z", "text": "See attached xls sheet, won't open. Stack trace below. Checked 2.5.1-final and\n3.0-alpha1-20050704\n\njava.lang.reflect.InvocationTargetException\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n        at\nsun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n        at\nsun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:494)\n        at\norg.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:237)\n        at\norg.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:160)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:183)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:152)\n        at test.main(test.java:10)\nCaused by: java.lang.IllegalArgumentException: Illegal length\n        at org.apache.poi.util.StringUtil.getFromUnicodeLE(StringUtil.java:70)\n        at org.apache.poi.hssf.record.FontRecord.fillFields(FontRecord.java:135)\n        at org.apache.poi.hssf.record.Record.fillFields(Record.java:90)\n        at org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n        at org.apache.poi.hssf.record.FontRecord.<init>(FontRecord.java:88)\n        ... 9 more\nException in thread \"main\" org.apache.poi.hssf.record.RecordFormatException:\nUnable to construct record instance, the following exception occured: null\n        at\norg.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:250)\n        at\norg.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:160)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:183)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:152)\n        at test.main(test.java:10)"}, {"attachment_id": 18021, "tags": [], "bug_id": 39190, "is_private": false, "count": 1, "id": 87545, "time": "2006-04-03T20:32:09Z", "creator": "rnice@fraudscrub.com", "creation_time": "2006-04-03T20:32:09Z", "text": "Created attachment 18021\nWorkbook that won't open\n\nThanks for your efforts."}, {"count": 2, "tags": [], "bug_id": 39190, "text": "Can you confirm that this file was written by excel in the first instance.\nDebugging it is Wierd, seems like the Font records are all screwed up.\n\nJason", "id": 92218, "attachment_id": null, "creator": "jheight@apache.org", "creation_time": "2006-08-15T03:25:39Z", "time": "2006-08-15T03:25:39Z", "is_private": false}, {"count": 3, "tags": [], "creator": "rnice@fraudscrub.com", "text": "(In reply to comment #2)\n> Can you confirm that this file was written by excel in the first instance.\n> Debugging it is Wierd, seems like the Font records are all screwed up.\n\nNo I can't. But it does open fine in Excel and OpenOffice.", "id": 92226, "time": "2006-08-15T14:44:22Z", "bug_id": 39190, "creation_time": "2006-08-15T14:44:22Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "text": "Agreed. And if i save in excel, the problem still exists. Wierd. Ill keep\nlooking into it but may be headed to the too hard basket.\n\nJason", "is_private": false, "bug_id": 39190, "id": 92281, "time": "2006-08-17T03:35:57Z", "creator": "jheight@apache.org", "creation_time": "2006-08-17T03:35:57Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "jheight@apache.org", "text": "*** Bug 34727 has been marked as a duplicate of this bug. ***", "id": 92574, "time": "2006-08-27T11:07:00Z", "bug_id": 39190, "creation_time": "2006-08-27T11:07:00Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 39190, "text": "What seems to be happening is there there are some illegal font records, these\nhave whacked out values for all of the fields including the length of the font\nname, so when we attempt to read the font name it barfs because it expects more\ncharacters than what are remaining in the FontRecord.\n\nAs indicated above this does open in excel, so there much be some trickery going\non here that we are not aware of, or excel simply ignores these whacked out records.\n\nDont know what to do yet.\n\nJason", "id": 92575, "attachment_id": null, "creator": "jheight@apache.org", "creation_time": "2006-08-27T11:10:17Z", "time": "2006-08-27T11:10:17Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 39190, "is_private": false, "count": 7, "id": 92579, "time": "2006-08-27T11:55:12Z", "creator": "jheight@apache.org", "creation_time": "2006-08-27T11:55:12Z", "text": "Refer to Bug 27548, the reason for this is that the workbook is encrypted.\n\nAt this point in time HSSF does not support handling of encrypted workbooks see FAQ.\n\nTo prevent this confusion (in regards to this exception stacktrace) i will throw\na RecordFormatException when we hit a FILEPASS record.\n\nJason\n\n*** This bug has been marked as a duplicate of 27548 ***"}, {"count": 8, "tags": [], "bug_id": 39190, "attachment_id": null, "text": "I don't understand. Are you saying that the workbook, or portions of it are\nencrypted? I don't need a password to open it, so is it that just parts of it\nare locked or something? Is there a suggested workaround to get it to skip any\nparts it can't read? Help!", "id": 92588, "time": "2006-08-27T14:53:52Z", "creator": "rnice@fraudscrub.com", "creation_time": "2006-08-27T14:53:52Z", "is_private": false}]