[{"count": 0, "tags": [], "creator": "gmillikan@t1shopper.com", "text": "When written to the log, cookies are URL encoded when using %{VARNAME}C. For example a cookie received in the request headers as \"cAsPuTNpqas,6rrgB7T-6kGQbf4\" becomes the following when written to the log, \"cAsPuTNpqas%2C6rrgB7T-6kGQbf4\"\n\nPlease update documentation at https://httpd.apache.org/docs/current/mod/mod_log_config.html", "id": 181430, "time": "2015-03-02T08:01:18Z", "bug_id": 57652, "creation_time": "2015-03-02T08:01:18Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "text": "Doesn't do that for me.  It should only escape quotes and unprintables.\n\n$ grep common built/conf/httpd.conf\n    LogFormat \"%a %h %l %u %t \\\"%r\\\" %>s %b %f %D %{foo}C\" common\n    CustomLog \"logs/access_log\" common\n\n$ wget -qS --header=\"Cookie: foo=bar,baz\" http://localhost/index.html -O-\n  HTTP/1.1 200 OK\n  Date: Mon, 02 Mar 2015 17:52:25 GMT\n  Server: Apache/2.5.0-dev (Unix) OpenSSL/1.0.1f\n  Last-Modified: Fri, 23 Jan 2015 17:26:26 GMT\n  ETag: \"0-50d5516994c52\"\n  Accept-Ranges: bytes\n  Content-Length: 0\n  Keep-Alive: timeout=5, max=100\n  Connection: Keep-Alive\n  Content-Type: text/html\n\n$ tail -1 built/logs/access_log \n127.0.0.1 127.0.0.1 - - [02/Mar/2015:17:52:25 +0000] \"GET /index.html HTTP/1.1\" 200 - /home/covener/public_html/index.html 306 bar,baz", "attachment_id": null, "bug_id": 57652, "id": 181444, "time": "2015-03-02T17:53:23Z", "creator": "covener@gmail.com", "creation_time": "2015-03-02T17:53:23Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 57652, "is_private": false, "text": "My bad.  This is not an Apache bug.  This is happening downstream in PHP or MySQL downstream.  Sorry for the trouble.  Confirmed everything is ok on Apache/2.2.29 per output below.  Nice debug script, thanks Eric.\n\n$ grep PHPSESSID /etc/httpd/conf/httpd.conf\n    LogFormat \"%h\\t%l\\t%u\\t%t\\t%r\\t%>s\\t%b\\t%{Referer}i\\t%{User-Agent}i\\t%{PHPSESSID}C\" combinedcookie\n\n$ wget --server-response --no-check-certificate --header=\"Cookie: PHPSESSID=pOoq97tCR5N,PWnoQMlIoLitbT0\" https://www.t1shopper.com/contactus/index.php\n\n--2015-03-03 05:12:38--  https://www.t1shopper.com/contactus/index.php\nHTTP request sent, awaiting response...\n  HTTP/1.1 200 OK\n  Date: Tue, 03 Mar 2015 05:12:38 GMT\n  Server: Apache\n  Expires: Thu, 19 Nov 1981 08:52:00 GMT\n  Vary: Accept-Encoding\n  Cache-Control: public\n  Connection: close\n  Content-Type: text/html\nLength: unspecified [text/html]\nSaving to: `index.php'\n\n$ cat /var/log/httpd/t1shopper_access_log | grep 127.0.0.1\n\n127.0.0.1       -       -       [03/Mar/2015:05:12:38 +0000]    GET /contactus/index.php HTTP/1.0       200     17532   -       Wget/1.11.4 Red Hat modified    pOoq97tCR5N,PWnoQMlIoLitbT0", "id": 181451, "time": "2015-03-03T05:24:18Z", "creator": "gmillikan@t1shopper.com", "creation_time": "2015-03-03T05:24:18Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "gmillikan@t1shopper.com", "text": "For posterity, this is PHP gotcha:\n\nPHP's popular setcookie() function URL-encodes the cookie when pushing it out to the client browser as the documentation says.  The corresponding function session_id() both reads the cookie from the HTTP request headers AND URL-decodes it.  The URL-decoding isn't mentioned in the PHP documentation.\n\nHappy session handling,\n\n--Geoff\n\nhttps://php.net/manual/en/function.setcookie.php\n\nhttps://php.net/manual/en/function.session-id.php", "id": 181453, "time": "2015-03-03T06:07:25Z", "bug_id": 57652, "creation_time": "2015-03-03T06:07:25Z", "is_private": false, "attachment_id": null}]