[{"count": 0, "tags": [], "creator": "dev@tomcat.apache.org", "text": "Hi there,\r\n    I encountered a problem when authenticate user by JdbcRealm.My work envirement is Linux7 + jdk1.3\r\nand Tomcat 3.2,I use freetds jdbc driver to connecting o ms sql database.The problem is --the first time I use Ie 5 to ask some jsp file(\"/run/index.jsp\",I have confiured /run/*.jsp for authentication) ,the authentication dialoge box is NOT appear like SimpleReam do,and the following is the message on the screen:\r\n////////////////////////////////\r\nat com.internetcds.jdbc.tds.PreparedStatement_base.setString(PreparedStatement_base.java:694)\r\n at org.apache.tomcat.request.JDBCRealm.authenticate(JDBCRealm.java:306)\r\n at org.apache.tomcat.request.JDBCRealm.authenticate(JDBCRealm.java:480)\r\n at org.apache.tomcat.core.ContextManager.doAuthenticate(ContextManager.java:837)\r\n at org.apache.tomcat.core.RequestImpl.getRemoteUser(RequestImpl.java:341)\r\n at org.apache.tomcat.request.JDBCRealm.authorize(JDBCRealm.java:501)\r\n at org.apache.tomcat.core.ContextManager.doAuthorize(ContextManager.java:855)\r\n at org.apache.tomcat.core.ContextManager.internalService(ContextManager.java:789)\r\n at org.apache.tomcat.core.ContextManager.service(ContextManager.java:743)\r\n at org.apache.tomcat.service.connector.Ajp12ConnectionHandler.processConnection(Ajp12ConnectionHandler.java:166)\r\n at org.apache.tomcat.service.TcpWorkerThread.runIt(PoolTcpEndpoint.java:416)\r\n at org.apache.tomcat.util.ThreadPool$ControlRunnable.run(ThreadPool.java:498)\r\n////////////////////////////////\r\nAnd the second time ,I used SimpleReam for authentication and typed \"test\",\"test\" as user name and password when authentication dialoge appears.Then I modified server.xml to authenticate user by JdbcReam.After shut down and restart tomcat(but keep Ie open),reload the jsp file,some times the page is correctly returned but sometimes the following message appear:\r\n///////////////////////////////////////////\r\n2000-12-18 10:01:34 - ContextManager: JDBCRealm: Controled access for test R( /r\r\nun + /wh_member_yhfk.jsp + null) Ct (jsp(org.apache.jasper.servlet.JspServlet/nu\r\nll) )\r\n2000-12-18 10:01:34 - Ctx( /run ): Exception in: R( /run + /wh_member_yhfk.jsp +\r\n null) - java.lang.NullPointerException\r\n        at com.internetcds.jdbc.tds.Tds.executeProcedure(Tds.java:2561)\r\n        at com.internetcds.jdbc.tds.PreparedStatement_base.executeCall(PreparedStatement_base.java:199)\r\n        at com.internetcds.jdbc.tds.PreparedStatement_base.execute(PreparedStatement_base.java:175)\r\n        at com.internetcds.jdbc.tds.PreparedStatement_base.executeQuery(PreparedStatement_base.java:320)\r\n        at org.apache.tomcat.request.JDBCRealm.getUserRoles(JDBCRealm.java:375)\r\n        at org.apache.tomcat.request.JDBCRealm.authorize(JDBCRealm.java:509)\r\n        at org.apache.tomcat.core.ContextManager.doAuthorize(ContextManager.java:855)\r\n        at org.apache.tomcat.core.ContextManager.internalService(ContextManager.java:789)\r\n        at org.apache.tomcat.core.ContextManager.service(ContextManager.java:743)\r\nat org.apache.tomcat.service.connector.Ajp12ConnectionHandler.processConnectionAjp12ConnectionHandler.java:166)\r\n        at org.apache.tomcat.service.TcpWorkerThread.runIt(PoolTcpEndpoint.java:416)\r\n        at org.apache.tomcat.util.ThreadPool$ControlRunnable.run(ThreadPool.java:498)\r\n        at java.lang.Thread.run(Thread.java:484)\r\n//////////////////////////////\r\nI have read the JdbcRealm.java,maybe you forgot verify whether the userName is null before database query(not just after the request.getRemoteUser() called)?\r\nIf you can inform me soon after finish the bug fixing,I will be very thankful.\r\nmail to :liuy@21bc.com\r\n \r\n ", "id": 313, "attachment_id": null, "bug_id": 337, "creation_time": "2000-12-18T01:30:18Z", "time": "2000-12-18T01:30:18Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 337, "text": "It's fixed for 3.2.2 up on CVS, you can go for nightly builds of 3.2.2,3.3 or \n4.0 to check if it's already fixed, ", "id": 530, "time": "2001-02-03T12:51:06Z", "creator": "craig.mcclanahan@sun.com", "creation_time": "2001-02-03T12:51:06Z", "is_private": false, "attachment_id": null}]