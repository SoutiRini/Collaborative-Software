[{"count": 0, "tags": [], "creator": "marklundberg@gmail.com", "attachment_id": 32576, "id": 181804, "time": "2015-03-16T14:18:27Z", "bug_id": 57715, "creation_time": "2015-03-16T14:18:27Z", "is_private": false, "text": "Created attachment 32576\nUnit test to demonstrate the problem and a fix to the RealmBase\n\nFinding security constraints can fail when HTTP methods are specified.  When HTTP methods are defined in the security constraints, the RealmBase.findSecurityConstraints() method can terminate early without adding a constraint to the results.\n\nA simple case that demonstrates this problem is to define security constraints such that the entire web site requires authentication.  Then add one additional constraint that allows the GET HTTP method for a specific URL to bypass authentication:\n\n    <!-- Restricted URLs that require authentication -->\n    <security-constraint>\n        <display-name>Authenticated Access</display-name>\n        <web-resource-collection>\n        <web-resource-name>Restricted Access</web-resource-name>\n            <url-pattern>/*</url-pattern>\n        </web-resource-collection>\n        <auth-constraint>\n            <!-- <auth-constraint> with the * role enforces authentication but not authorization -->\n            <role-name>*</role-name>\n        </auth-constraint>\n    </security-constraint>\n\n    <!-- URLs that do not require authentication -->\n    <security-constraint>\n        <display-name>Unauthenticated Public Access</display-name>\n        <web-resource-collection>\n            <!-- Public SOAP wsdl resources -->\n            <web-resource-name>PublicSOAPWsdlURLs</web-resource-name>\n            <url-pattern>/services/*</url-pattern>\n            <!-- SOAP wsdl requests use GET and are public. POST requests to these URLs require authentication -->\n            <http-method>GET</http-method>\n        </web-resource-collection>\n        <!-- No <auth-constraint> because these resources do not require authentication -->\n    </security-constraint>\n\nIf an HTTP POST request is sent to the /service/foo uri, the findSecurityConstraints() method matches the \u2018/service/*\u2019 URL and flags the search status as having found a match. However, when the HTTP method is examined it is found not to match and the security constraint is not added to the results. Even though the HTTP method didn\u2019t match, the search was still flagged as finding a match and the search is terminated, returning zero constraints. This allows the POST request to proceed without authentication.\n\nA patch is attached that includes a unit test to demonstrate the problem and a fix to the RealmBase."}, {"count": 1, "tags": [], "creator": "markt@apache.org", "text": "See the section in the servlet spec on uncovered HTTP methods.", "id": 181806, "time": "2015-03-16T14:52:50Z", "bug_id": 57715, "creation_time": "2015-03-16T14:52:50Z", "is_private": false, "attachment_id": null}]