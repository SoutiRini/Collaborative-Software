[{"count": 0, "tags": [], "bug_id": 46806, "attachment_id": null, "text": "Creating an XSSF Workbook with a cell formula that references a cell in a column that is greater than 255 causes an exception.\n\nIn org.apache.poi.ss.util.CellReference there is the constant:\n\nprivate static final String BIFF8_LAST_COLUMN = \"IV\";\n\nShould be some kind of switch depending on if the workbook is HSSF or XSSF to allow for references in columns > 255.\n\n\n\n\n\n\n\njava.lang.IllegalArgumentException: Unparsable formula 'SUM(F4:IW4)'\n\tat org.apache.poi.xssf.usermodel.XSSFCell.setCellFormula(XSSFCell.java:384)\n\tat org.vbn.hours.logic.ExcelReporter.exportTPDPlannedHoursReport(ExcelReporter.java:2751)\n\tat org.vbn.hours.logic.ExcelReporter.runReport(ExcelReporter.java:70)\n\tat org.vbn.hours.logic.VBNHoursController$1.doInBackground(VBNHoursController.java:61)\n\tat org.vbn.hours.logic.VBNHoursController$1.doInBackground(VBNHoursController.java:1)\n\tat javax.swing.SwingWorker$1.call(SwingWorker.java:278)\n\tat java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:138)\n\tat javax.swing.SwingWorker.run(SwingWorker.java:317)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n\tat java.lang.Thread.run(Thread.java:619)\nCaused by: org.apache.poi.ss.formula.FormulaParser$FormulaParseException: Specified named range 'IW4' does not exist in the current workbook.\n\tat org.apache.poi.ss.formula.FormulaParser.parseNameOrCellRef(FormulaParser.java:440)\n\tat org.apache.poi.ss.formula.FormulaParser.parseRangeExpression(FormulaParser.java:340)\n\tat org.apache.poi.ss.formula.FormulaParser.parseFunctionReferenceOrName(FormulaParser.java:332)\n\tat org.apache.poi.ss.formula.FormulaParser.parseSimpleFactor(FormulaParser.java:733)\n\tat org.apache.poi.ss.formula.FormulaParser.percentFactor(FormulaParser.java:693)\n\tat org.apache.poi.ss.formula.FormulaParser.powerFactor(FormulaParser.java:680)\n\tat org.apache.poi.ss.formula.FormulaParser.Term(FormulaParser.java:982)\n\tat org.apache.poi.ss.formula.FormulaParser.additiveExpression(FormulaParser.java:1083)\n\tat org.apache.poi.ss.formula.FormulaParser.concatExpression(FormulaParser.java:1067)\n\tat org.apache.poi.ss.formula.FormulaParser.comparisonExpression(FormulaParser.java:1024)\n\tat org.apache.poi.ss.formula.FormulaParser.Arguments(FormulaParser.java:665)\n\tat org.apache.poi.ss.formula.FormulaParser.function(FormulaParser.java:562)\n\tat org.apache.poi.ss.formula.FormulaParser.parseFunctionReferenceOrName(FormulaParser.java:324)\n\tat org.apache.poi.ss.formula.FormulaParser.parseSimpleFactor(FormulaParser.java:733)\n\tat org.apache.poi.ss.formula.FormulaParser.percentFactor(FormulaParser.java:693)\n\tat org.apache.poi.ss.formula.FormulaParser.powerFactor(FormulaParser.java:680)\n\tat org.apache.poi.ss.formula.FormulaParser.Term(FormulaParser.java:982)\n\tat org.apache.poi.ss.formula.FormulaParser.additiveExpression(FormulaParser.java:1083)\n\tat org.apache.poi.ss.formula.FormulaParser.concatExpression(FormulaParser.java:1067)\n\tat org.apache.poi.ss.formula.FormulaParser.comparisonExpression(FormulaParser.java:1024)\n\tat org.apache.poi.ss.formula.FormulaParser.unionExpression(FormulaParser.java:1003)\n\tat org.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:1125)\n\tat org.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:192)\n\tat org.apache.poi.xssf.usermodel.XSSFCell.setCellFormula(XSSFCell.java:381)\n\t... 11 more", "id": 125342, "time": "2009-03-05T11:48:05Z", "creator": "timvbn@gmail.com", "creation_time": "2009-03-05T11:48:05Z", "is_private": false}, {"count": 1, "tags": [], "creator": "timvbn@gmail.com", "attachment_id": null, "text": "Does anyone have a workaround for this?  I am trying to generate a calendar year of hours worked for all employees in our organization.  I need 365 columns for the days in the year and a SUM at the end.", "id": 125939, "time": "2009-04-01T16:19:45Z", "bug_id": 46806, "creation_time": "2009-04-01T16:19:45Z", "is_private": false}, {"count": 2, "attachment_id": null, "bug_id": 46806, "text": "(In reply to comment #0)\n> Creating an XSSF Workbook with a cell formula that references a cell in a\n> column that is greater than 255 causes an exception.\n> \n> In org.apache.poi.ss.util.CellReference there is the constant:\n> \n> private static final String BIFF8_LAST_COLUMN = \"IV\";\n> \n> Should be some kind of switch depending on if the workbook is HSSF or XSSF to\n> allow for references in columns > 255.\n\nYou're absolutely correct, but this change is is not a trivial one to make (there is an extensive tree of method calls to pass that parameter through).\nThis is something we intend to get done before 3.5-final release.\n\nAS far as I know there is no practical work-around.", "id": 125940, "time": "2009-04-01T17:49:05Z", "creator": "josh@apache.org", "creation_time": "2009-04-01T17:49:05Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "text": "The problem is being fixed. As Josh said, it's not trivial and will take some time. \n\nYegor\n\n(In reply to comment #1)\n> Does anyone have a workaround for this?  I am trying to generate a calendar\n> year of hours worked for all employees in our organization.  I need 365 columns\n> for the days in the year and a SUM at the end.", "id": 125945, "time": "2009-04-02T00:15:59Z", "bug_id": 46806, "creation_time": "2009-04-02T00:15:59Z", "is_private": false}, {"count": 4, "attachment_id": null, "creator": "yegor@dinom.ru", "text": "Fixed in r775701. \nFormulas in XSSF now support the \"Big Grid\" of 1 million rows and 16000 columns.\n\nRegards,\nYegor", "id": 127070, "time": "2009-05-17T09:41:06Z", "bug_id": 46806, "creation_time": "2009-05-17T09:41:06Z", "tags": [], "is_private": false}]