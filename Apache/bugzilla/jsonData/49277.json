[{"count": 0, "tags": [], "bug_id": 49277, "attachment_id": null, "text": "With the new variable introduced in 2.3 (trunk) SSL_SESSION_RESUMED, a basic point is missing: when a SSL_SESSION_ID is really new or is renegotiated, like in \n\nPrior SSL_SESSION_ID | Current SSL_SESSION_ID  | Status\n  -                  | AAAAAAAAAAAA            | Initial\nAAAAAAAAAAAA         | BBBBBBBBBBBB            | Renegotiated\nBBBBBBBBBBBB         | CCCCCCCCCCCC            | Renegotiated\nCCCCCCCCCCCC         | DDDDDDDDDDDD            | Renegotiated\n\nAchieve can be possible, once that the client send this information on SSL Client Hello, on Initial it don't send a SSL_SESSION_ID (Session ID lenght = 0), but on subsequent connections it send in Client Hello with the SessionID, until a renegotiation be force by the server (once that still valid for the client, but not for the server, because SSLSessionCacheTimeout), and this way creating a new SSL_SESSION_ID.\n\nThis can be very helpful in differentiating the first SSL_SESSION_ID from the new ones renegotiated, for a better logout control (to don't allow a user reuse a token/smartcard plugged on computer to gain access in the application after the user click on logout).", "id": 136813, "time": "2010-05-12T09:54:13Z", "creator": "klaubert@gmail.com", "creation_time": "2010-05-12T09:54:13Z", "is_private": false}, {"count": 1, "tags": [], "creator": "dclarke@blastwave.org", "is_private": false, "id": 174122, "creation_time": "2014-03-26T22:05:05Z", "time": "2014-03-26T22:05:05Z", "bug_id": 49277, "text": "\nI can confirm that with the latest rev of Apache and OpenSSL that the \nSSL_SESSION_ID data is blank on the initial connection where SSL_SESSION_RESUMED\nis equal to \"Initial\".\n\nThus : \n\nSERVER_SOFTWARE: Apache/2.4.9 (Unix) PHP/5.4.26 OpenSSL/1.0.1e\n\nSSL_SESSION_ID:\nSSL_SESSION_RESUMED: Initial\nSSL_VERSION_INTERFACE: mod_ssl/2.4.4\nSSL_VERSION_LIBRARY: OpenSSL/1.0.1e\n\nThis seems blatently wrong that the SESSION ID is blank given that section 7 ( page 26 ) of RFC 5246 states : \n\n The Handshake Protocol is responsible for negotiating a session,\n   which consists of the following items:\n\n   session identifier\n      An arbitrary byte sequence chosen by the server to identify an\n      active or resumable session state.\n\n\nOne would think that with TLS1.2 that the handshake process is complete in \norder to receive a page of data in a modern browser via https and therefore\nthe SSL_SESSION_ID is not blank.\n\nOther reasonable SSL environment variables are complete and look correct \nthus : \n\nSSL_CIPHER: DHE-RSA-AES256-SHA\nSSL_CIPHER_ALGKEYSIZE: 256\nSSL_CIPHER_EXPORT: false\nSSL_CIPHER_USEKEYSIZE: 256\nSSL_CLIENT_VERIFY: NONE\nSSL_COMPRESS_METHOD: NULL\nSSL_PROTOCOL: TLSv1.2\nSSL_SECURE_RENEG: true\nSSL_SERVER_A_KEY: rsaEncryption\nSSL_SERVER_A_SIG: sha1WithRSAEncryption\nSSL_SERVER_I_DN: CN=VeriSign Class 3 Extended Validation SSL CA,OU=Terms of use at https://www.verisign.com/rpa (c)06,OU=VeriSign Trust Network,O=VeriSign\\, Inc.,C=US\nSSL_SERVER_I_DN_C: US\nSSL_SERVER_I_DN_CN: VeriSign Class 3 Extended Validation SSL CA\nSSL_SERVER_I_DN_O: VeriSign, Inc.\nSSL_SERVER_I_DN_OU: VeriSign Trust Network\n\netc etc. \n\nSeems wrong that SSL_SESSION_ID is blank.\n\nDennis", "attachment_id": null}]