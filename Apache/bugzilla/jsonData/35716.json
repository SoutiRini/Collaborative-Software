[{"count": 0, "tags": [], "bug_id": 35716, "attachment_id": null, "id": 77255, "creation_time": "2005-07-13T15:02:50Z", "time": "2005-07-13T15:02:50Z", "creator": "amolweb@yahoo.com", "text": "Named range support has been implemented using the usermodel class HSSFName.\nHowever, currently when a named range is attempted to be created over a single\nthe behaviour is erroneous.\n\nTwo ways to create a named range over a single cel were attempted:\n\n1. using the string \"A1\"\n------------------------\nCalling HSSFName.setReference(\"Sheet1!A1\");\nthrows the following exception:\n\n   Failed with exception:\njava.lang.ArrayIndexOutOfBoundsException: 1\n\tat org.apache.poi.hssf.record.formula.Area3DPtg.setArea(Area3DPtg.java:247)\n\tat org.apache.poi.hssf.record.NameRecord.setAreaReference(NameRecord.java:713)\n\tat org.apache.poi.hssf.usermodel.HSSFName.setReference(HSSFName.java:125)\n\tat <someLineInUserCode/>\n\n\n2. using the string \"A1:A1\"\n---------------------------\nThis code does not throw RuntimeException, but it retrieves the cell A1 twice\nwhen the following code is used to retrieve the cell references:\n    int namedCellIdx = wb.getNameIndex(cellName);\n    HSSFName aNamedCell = wb.getNameAt(namedCellIdx);\n    AreaReference aref = new AreaReference(aNamedCell.getReference());\n    CellReference[] crefs = aref.getCells();\n    for (int i=0, iSize=crefs.length; i<iSize; i++) {\n        CellReference cref = crefs[i];\n        HSSFSheet s = wb.getSheet(cref.getSheetName());\n        HSSFRow r = sheet.getRow(cref.getRow());\n        HSSFCell c = r.getCell(cref.getCol());\n        String contents = c.getStringCellValue();\n    }\n\n\n\nExpected resolution:\n--------------------\nThere should be atleast one way to create a named range over a single cell :)", "is_private": false}, {"count": 1, "tags": [], "bug_id": 35716, "attachment_id": null, "id": 77257, "time": "2005-07-13T15:05:30Z", "creator": "avik@apache.org", "creation_time": "2005-07-13T15:05:30Z", "is_private": false, "text": "When creating a range as A1:A1, does excel behave as expected? If so, then I\nreckon all we need to fix is the edge case for AreaReference. "}, {"count": 2, "tags": [], "bug_id": 35716, "attachment_id": null, "id": 77259, "time": "2005-07-13T15:21:49Z", "creator": "amolweb@yahoo.com", "creation_time": "2005-07-13T15:21:49Z", "is_private": false, "text": "Actually, the code for the edge case of AreaReference was already in place in\nthe class org.apache.poi.hssf.record.NameRecord\n\nHowever, the condition used in org.apache.poi.hssf.util.RangeAddress#hasRange()\nwas incorrect, which is now fixed.\nTestcases that failed prior to the fix and passed after the fix have also been\nadded. Also, updated the quick-guide to include info on creating Named Ranges\n(since the question popped a couple of times on the mailing list)\n"}]