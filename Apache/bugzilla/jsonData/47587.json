[{"count": 0, "attachment_id": null, "bug_id": 47587, "is_private": false, "id": 129169, "time": "2009-07-27T07:15:15Z", "creator": "mark@pluton.nl", "creation_time": "2009-07-27T07:15:15Z", "tags": [], "text": "NOTE: I am using 2.3.4 r785646 (not available in the Version list)\n\nRecording a website that uses semicolons (';') to separate parameter values fails.\n\nThe firstline in the unproxied request is:\nGET /home/initial-pages/initial-pages/support?func=add;class=WebGUI::Asset::Post::Thread HTTP/1.1\n\nThe proxied version:\nGET /home/initial-pages/initial-pages/support?func=add%3Bclass%3DWebGUI%3A%3AAsset%3A%3APost%3A%3AThread HTTP/1.1\n\nNote how the semicolon, equals (and colon [1]) are encoded. This causes the recorded application to fail.\n\nThe original URL is perfectly valid according to RFC 3986 section 3.3 (near the end) http://tools.ietf.org/html/rfc3986#section-3.3 \n\nPart of the problem is that org.apache.jmeter.protocol.http.sampler.HTTPSamplerBase incorrectly assumes that ampersand ('&') is the only valid parameter separator (see http://www.w3.org/TR/1999/REC-html401-19991224/appendix/notes.html#h-B.2.2 )\n\nI am able to reproduce this problem with both Firefox (3.5) and IE (8).\nI used a WebGUI WRE with a default demo-domain for reproduction. Steps:\n0) Setup JMeter and browser with proxy for recording\n1) Login as admin (only user on a demo)\n2) Go to Initial Pages\n3) Select a forum (eg Support)\n4) Click Add\nExpected: Server returns page to add a message\nActual Result: Server returned the forum-list (due to failing to interpret the query string sent by the proxy)\n\nThe WebGUI WRE is available at http://www.webgui.org/download (Download WRE Binaries) with install instructions at http://www.webgui.org/community-wiki/wre-installation. Following those instructions should be enough to get the same demo-domain I used for reproducing this.\n\n1) Note that encoding the colon is not necessary in a query-part according to the definition in RFC 3986"}, {"count": 1, "tags": [], "text": "The sample GET request works fine for me with JMeter 2.3.4, except that it does not interpret \";\" as a parameter separator, so it generates the following parameter:\n\nfunc          add;class=WebGUI::Asset::Post::Thread\n\nwhere:\nEncode?         not selected\nInclude equals? selected\n\nI don't see any encoding of the parameters in the generated request.\n\nI can't easily install WebGUI.\n\nPlease can you run the Proxy recording again with the following debug enabled:\n\n# Enable Proxy request debug\nlog_level.jmeter.protocol.http.proxy.HttpRequestHdr=DEBUG\n\nYou can add this to the user.properties file.\n\nAttach the relevant part of the log and the generated JMX file to this issue.", "is_private": false, "id": 129213, "creator": "sebb@apache.org", "time": "2009-07-28T07:32:45Z", "bug_id": 47587, "creation_time": "2009-07-28T07:32:45Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 47587, "text": "I see two problems in your comment:\n1) The request should have two, not one, parameters:\nfunc    add\nclass   WebGUI::Asset::Post::Thread\n\n(note that WebGUI does support both '&' and ';' as parameter separators, but uses ';' when generating pages in conformance to the relevant W3C recommendations)\n\n2) The proxy records (and forwards) the request with encode enabled.\n\nSince recording as a single parameter with encode enabled, WebGUI receives only 1 parameter (the separator is encoded) and is unable to interpret the request correctly. This prevents recording subsequent steps, since the wrong page is returned.\n\nIf point 1 is fixed (recognizing ';' as a parameter-separator), point 2 is no problem anymore.\n\nI will add the detailed log, jmx (+ wireshark traces of proxied and unproxied communication).", "count": 2, "id": 129230, "time": "2009-07-28T23:54:17Z", "creator": "mark@pluton.nl", "creation_time": "2009-07-28T23:54:17Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 47587, "attachment_id": 24058, "text": "Created attachment 24058\nDetailed logging + jmx + wireshark\n\nI reproduced this again with\nlog_level.jmeter.protocol.http.proxy.HttpRequestHdr=DEBUG\nand attached the generated JMX and logfile\n\nI have also included two wireshark traces (unproxied and proxied), these were recorded separately, but used the exact same steps.\n\nA observation:\n1) An earlier GET using ';' as separator is recorded with encode disabled (http://192.168.1.190/home?op=auth;method=init ), while the offending GET is recorded with encode enabled", "id": 129232, "time": "2009-07-29T00:37:37Z", "creator": "mark@pluton.nl", "creation_time": "2009-07-29T00:37:37Z", "is_private": false}, {"count": 4, "tags": [], "text": "(In reply to comment #2)\n> I see two problems in your comment:\n> 1) The request should have two, not one, parameters:\n> func    add\n> class   WebGUI::Asset::Post::Thread\n\nYes, but the generated request looks identical provided Encode is offf.\n\n> (note that WebGUI does support both '&' and ';' as parameter separators, but\n> uses ';' when generating pages in conformance to the relevant W3C\n> recommendations)\n\nThis may not be supported by all server applications so this would have to be optional.\n \n> 2) The proxy records (and forwards) the request with encode enabled.\n\nIt works fine for me; it records without encode.\n\n> Since recording as a single parameter with encode enabled, WebGUI receives only\n> 1 parameter (the separator is encoded) and is unable to interpret the request\n> correctly. This prevents recording subsequent steps, since the wrong page is\n> returned.\n\nYes.\n \n> If point 1 is fixed (recognizing ';' as a parameter-separator), point 2 is no\n> problem anymore.\n\nSurely it's still a problem if encode is checked, because the : will be encoded?\n \n> I will add the detailed log, jmx (+ wireshark traces of proxied and unproxied\n> communication).\n\nThanks", "is_private": false, "id": 129238, "creator": "sebb@apache.org", "time": "2009-07-29T02:48:24Z", "bug_id": 47587, "creation_time": "2009-07-29T02:48:24Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "mark@pluton.nl", "text": "(In reply to comment #4)\n> Yes, but the generated request looks identical provided Encode is offf.\n\nTrue, except parametrization is slightly harder in those cases (although not relevant for this specific URL).\n\n> This may not be supported by all server applications so this would have to be\n> optional.\n\nAlso true, but the specification allows for it and there are applications that make use of it (as illustrated).\n\n> > 2) The proxy records (and forwards) the request with encode enabled.\n> \n> It works fine for me; it records without encode.\n\nSee my other comment with the attachment: when recording this specific request it is recorded with encode on.\n\n> Surely it's still a problem if encode is checked, because the : will be\n> encoded?\n\nI verified that manually, but WebGUI has no problems if only the colons are encoded (they are decoded when the parameters are retrieved in the application).\n\nAll in all, I think the easiest would be to get the Proxy / HTTPSamplerBase to (optionally?) recognize the ; as an alternative to the & in the query part.", "id": 129239, "time": "2009-07-29T03:00:35Z", "bug_id": 47587, "creation_time": "2009-07-29T03:00:35Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 47587, "text": "In the recorded test plan, there are only 3 samplers with parameters.\n\nThe first /home sampler has been recorded correctly, encode=off.\nThis is a GET.\n\nThe second /home sampler has also been recorded correctly, encode=off.\nThis is a POST, with Content-Encoding UTF-8.\n\nThe 3rd sampler with parameters, i.e. /home/initial-pages/initial-pages/support\nhas been recorded with encode=on which is incorrect.\nThis is a GET, with Content-Encoding UTF-8 - which also does not make sense for a GET.\n\nIt looks like the Proxy is not clearing all the sampler settings between samples.\nThat would explain why it worked for me, but not always for you.", "count": 6, "id": 129241, "time": "2009-07-29T03:34:56Z", "creator": "sebb@apache.org", "creation_time": "2009-07-29T03:34:56Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 47587, "text": "(In reply to comment #6)\n> It looks like the Proxy is not clearing all the sampler settings between\n> samples.\n> That would explain why it worked for me, but not always for you.\n\nFor now I have a workaround for the problem with recording:\nWhen I stop and start the proxy before/at the problem step(s), then I can continue with my steps.", "count": 7, "id": 129308, "time": "2009-07-31T00:18:00Z", "creator": "mark@pluton.nl", "creation_time": "2009-07-31T00:18:00Z", "is_private": false}, {"count": 8, "attachment_id": null, "bug_id": 47587, "is_private": false, "id": 196421, "time": "2017-01-25T20:24:17Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2017-01-25T20:24:17Z", "tags": [], "text": "Is this a frequent or edgy case ?\nShall we close this one ?"}]