[{"count": 0, "tags": [], "bug_id": 39790, "text": "The server crashes after receiving 2 SIGUSR1 within a very short timeframe. I\npersonally ran into this problem by using a logrotate script that sends SIGUSR1\nafter each individual logrotation.\n\nThe last lines in error_log are\n[Sat Jun 10 03:51:10 2006] [notice] SIGUSR1 received.  Doing graceful restart\n[Sat Jun 10 03:51:10 2006] [notice] Digest: generating secret for digest\nauthentication ...\n[Sat Jun 10 03:51:11 2006] [crit] (4)Interrupted system call: Digest: error\ngenerating secret: Interrupted system call\nConfiguration Failed\n\nThe problem seems to be located in apr_generate_random_bytes() which is called\nby mod_auth_digest.\n\nIt returns a failure on receiving a signal while reading from /dev/random.\nApplying the following patch should fix the problem:\n\ndiff --recursive httpd-2.0.58/srclib/apr/misc/unix/rand.c\nhttpd-2.0.58-fixed/srclib/apr/misc/unix/rand.c\n70c70,73\n<             return errnum;\n---\n>             if (errnum == EINTR)\n>                 fd = -1; /* force open() again if read() was interrupted */\n>             else\n>                 return errnum;", "id": 90108, "time": "2006-06-12T18:10:14Z", "creator": "redcube@gmx.de", "creation_time": "2006-06-12T18:10:14Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 39790, "attachment_id": null, "text": "I think I just ran into this problem.  error_log:\n\n[Sat Jul 29 03:10:01 2006] [notice] Digest: generating secret for digest\nauthentication ...\n[Sat Jul 29 03:10:01 2006] [notice] Digest: done\n[Sat Jul 29 03:10:01 2006] [notice] Apache configured -- resuming normal operations\n[Sat Jul 29 03:10:02 2006] [notice] Graceful restart requested, doing restart\n[Sat Jul 29 03:10:03 2006] [notice] Digest: generating secret for digest\nauthentication ...\n[Sat Jul 29 03:10:03 2006] [notice] Digest: done\n[Sat Jul 29 03:10:03 2006] [notice] Apache configured -- resuming normal operations\n[Sat Jul 29 03:10:05 2006] [notice] Graceful restart requested, doing restart\n[Sat Jul 29 03:10:05 2006] [notice] Digest: generating secret for digest\nauthentication ...\n[Sat Jul 29 03:10:05 2006] [notice] Digest: done\n[Sat Jul 29 03:10:06 2006] [notice] Apache configured -- resuming normal operations\n[Sat Jul 29 03:10:06 2006] [notice] Graceful restart requested, doing restart\n[Sat Jul 29 03:10:06 2006] [notice] Digest: generating secret for digest\nauthentication ...\n[Sat Jul 29 03:10:06 2006] [notice] Digest: done\n[Sat Jul 29 03:10:06 2006] [notice] Apache configured -- resuming normal operations\n[Sat Jul 29 03:10:06 2006] [notice] Graceful restart requested, doing restart\n[Sat Jul 29 03:10:06 2006] [notice] Digest: generating secret for digest\nauthentication ...\n[Sat Jul 29 03:10:06 2006] [crit] (4)Interrupted system call: Digest: error\ngenerating secret: Interrupted system call\nConfiguration Failed\n\nServer version: Apache/2.0.58", "id": 91711, "time": "2006-07-29T08:18:34Z", "creator": "victor.trac@gmail.com", "creation_time": "2006-07-29T08:18:34Z", "is_private": false}, {"count": 2, "tags": [], "creator": "pookey@pookey.co.uk", "text": "I also just got this problem - at 03:10 too - this is when my logs rotate, so\npreumably is caused by the 'reload' that logrotate does:\n\n/var/log/apache2/*log {\n  missingok\n  notifempty\n  sharedscripts\n  postrotate\n  /etc/init.d/apache2 reload > /dev/null 2>&1 || true\n  endscript\n}\n", "id": 98006, "time": "2007-01-12T09:18:09Z", "bug_id": 39790, "creation_time": "2007-01-12T09:18:09Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 39790, "attachment_id": null, "text": "This is a bug in apr_generate_random_bytes, it should handle EINTR.", "id": 98007, "time": "2007-01-12T09:23:42Z", "creator": "jorton@redhat.com", "creation_time": "2007-01-12T09:23:42Z", "is_private": false}, {"count": 4, "tags": [], "text": "Fixed on the trunk - thanks for the report.\n\nhttp://svn.apache.org/viewvc?view=rev&revision=553146", "attachment_id": null, "id": 105059, "creator": "jorton@redhat.com", "time": "2007-07-04T03:02:02Z", "bug_id": 39790, "creation_time": "2007-07-04T03:02:02Z", "is_private": false}]