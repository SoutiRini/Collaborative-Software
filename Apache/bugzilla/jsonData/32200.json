[{"count": 0, "tags": [], "creator": "sls@metopic.com", "attachment_id": null, "id": 66796, "time": "2004-11-12T15:25:45Z", "bug_id": 32200, "creation_time": "2004-11-12T15:25:45Z", "is_private": false, "text": "If you create a CBZip2OutputStream and immediately close it you get an \nArithmeticException.\n\nIf you create a CBZip2InputStream with no input you get a \nNullPointerException.  GZIPInputStream throws a EOFException which makes more \nsense.\n\nExample:\n\nimport org.apache.tools.bzip2.*;\nimport java.io.*;\n\npublic class AntBug {\n    public static void main(String[] args) {\n\ttry {\n\t    CBZip2InputStream cb =\n\t\tnew CBZip2InputStream(new ByteArrayInputStream(new byte[0]));\n\t    cb.close();\n\t} catch (Exception e) {\n\t    e.printStackTrace();\n\t}\n\ttry {\n\t    CBZip2OutputStream cb =\n\t\tnew CBZip2OutputStream(new ByteArrayOutputStream());\n\t    cb.close();\n\t} catch (Exception e) {\n\t    e.printStackTrace();\n\t}\n    }\n}\n\nProduces:\n\njava.lang.NullPointerException\n        at org.apache.tools.bzip2.CBZip2InputStream.bsR\n(CBZip2InputStream.java:285)\n        at org.apache.tools.bzip2.CBZip2InputStream.bsGetUChar\n(CBZip2InputStream.java:303)\n        at org.apache.tools.bzip2.CBZip2InputStream.initBlock\n(CBZip2InputStream.java:192)\n        at org.apache.tools.bzip2.CBZip2InputStream.<init>\n(CBZip2InputStream.java:140)\n        at AntBug.main(AntBug.java:7)\njava.lang.ArithmeticException: / by zero\n        at org.apache.tools.bzip2.CBZip2OutputStream.mainSort\n(CBZip2OutputStream.java:1135)\n        at org.apache.tools.bzip2.CBZip2OutputStream.doReversibleTransformation\n(CBZip2OutputStream.java:1347)\n        at org.apache.tools.bzip2.CBZip2OutputStream.endBlock\n(CBZip2OutputStream.java:438)\n        at org.apache.tools.bzip2.CBZip2OutputStream.close\n(CBZip2OutputStream.java:389)\n        at AntBug.main(AntBug.java:16)"}, {"count": 1, "tags": [], "text": "Created attachment 14374\nFixes and Unit test for CBZip2*\n\nThe unit test shows the behaviour, and the minor changes I've made allow the\ntests to pass, but I'm not confident about these changes not breaking anything\n(throwing an Exception that we didn't used to throw will probably be a BC\nissue)\n\n- removed trailing ; when found", "attachment_id": 14374, "bug_id": 32200, "id": 71601, "time": "2005-02-28T12:56:31Z", "creator": "kevin.jackson@it.fts-vn.com", "creation_time": "2005-02-28T12:56:31Z", "is_private": false}, {"id": 118739, "tags": [], "bug_id": 32200, "is_private": false, "count": 2, "text": "svn revision 677514", "time": "2008-07-17T00:01:57Z", "creator": "bodewig@apache.org", "creation_time": "2008-07-17T00:01:57Z", "attachment_id": null}]