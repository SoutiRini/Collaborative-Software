[{"count": 0, "attachment_id": null, "bug_id": 56363, "is_private": false, "id": 174362, "time": "2014-04-08T07:32:10Z", "creator": "mike@normi.net", "creation_time": "2014-04-08T07:32:10Z", "tags": [], "text": "The binary builds of Tomcat Native 1.1.24 - 1.1.29 have been compiled with an OpenSSL version vulnerable to Heartbleed, and are thus probably vulnerable. See http://www.openssl.org/news/secadv_20140407.txt and http://heartbleed.com/\n\nA new build using OpenSSL 1.0.1g would be very much appreciated."}, {"count": 1, "text": "Working on it.", "bug_id": 56363, "is_private": false, "id": 174393, "time": "2014-04-09T07:22:27Z", "creator": "mturk@apache.org", "creation_time": "2014-04-09T07:22:27Z", "tags": [], "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 56363, "attachment_id": null, "id": 174432, "time": "2014-04-10T07:00:20Z", "creator": "mturk@apache.org", "creation_time": "2014-04-10T07:00:20Z", "is_private": false, "text": "Update done and tested.\nWe'll start release process today or tomorrow and new version containing OpenSSL 1.0.1g will be available after VOTE finishes and we create ANN message.\n\nI'll close this issue when we send the ANN message."}, {"count": 3, "tags": [], "creator": "lhall@vocera.com", "attachment_id": null, "id": 174443, "time": "2014-04-10T14:17:30Z", "bug_id": 56363, "creation_time": "2014-04-10T14:17:30Z", "is_private": false, "text": "Is there any possibility that you could provide us with a copy of the updated Tomcat Native library now? My company has several affected servers and we have been struggling to build the library ourselves, but with no success."}, {"count": 4, "tags": [], "bug_id": 56363, "attachment_id": null, "is_private": false, "id": 174444, "time": "2014-04-10T14:48:23Z", "creator": "mike@normi.net", "creation_time": "2014-04-10T14:48:23Z", "text": "While I understand that the disclosure process of this bug has been far from optimal, and really appreciate all effort the maintainer(s) spend on this project, a turnaround time of 3 days for such a critical issue is not acceptable and currently forcing us to use the Java SSL implementation and BIO/NIO connectors.\n\nWould it, for future reference, be possible to document the Windows library build process better? We too have been struggling (and failing) to build the library ourselves, which has forced us to switch to the BIO connector due to the extreme severity of the issue."}, {"count": 5, "tags": [], "bug_id": 56363, "attachment_id": null, "is_private": false, "id": 174445, "time": "2014-04-10T14:53:25Z", "creator": "mike@normi.net", "creation_time": "2014-04-10T14:53:25Z", "text": "BTW, Luke, the intended release can be found at http://people.apache.org/~mturk/native/1.1.30/."}, {"count": 6, "tags": [], "text": "Thanks to Mladen for his effort on getting this out as fast as he has.\nThe ease with which this problem was addressable on the *NIX platforms leads me to ask if there is a better way of addressing the native libraries in the Windows world?  \nThe *NIX guys could just go get the latest OpenSSL version, install it, and restart their Tomcats, because the libraries are dynamically linked. However, the Windows version is statically linked, so we had to wait for Mladen to work his magic or try to do the build ourselves using minimal instructions.\nMy question is, what would be the downside to leaving the Windows version as a set of 2 or 3 dll files instead of statically linking them as they are now?", "is_private": false, "id": 174446, "creator": "Jeffrey.Janner@polydyne.com", "time": "2014-04-10T15:07:54Z", "bug_id": 56363, "creation_time": "2014-04-10T15:07:54Z", "attachment_id": null}, {"count": 7, "text": "(In reply to Mike Noordermeer from comment #4)\n\n1. The timing is unfortunate. There is a conference going on right now. Key people are there.\nhttp://www.apachecon.com/\n\nAlso this bug is where I learned this issue from. Thank you Mike for filing it.\n\n2. Nobody here works for Microsoft.\n\nProviding windows binaries is a courtesy and may stop at any random moment.\n\n> Would it, for future reference, be possible to document the Windows\n> library build process better?\n\n3. Documentation improvement patches are appreciated. You may submit one via bugzilla.\n\n(In reply to Jeffrey.Janner from comment #6)\n> However, the Windows version is statically linked, so we had to wait for\n> Mladen to work his magic or try to do the build ourselves using minimal\n> instructions.\n\n4. a) That would be a mess.  b) Somebody would still need to build OpenSSL for you. http://openssl.org/ provides source code only. See 2.", "creator": "knst.kolinko@gmail.com", "is_private": false, "id": 174448, "time": "2014-04-10T15:17:52Z", "bug_id": 56363, "creation_time": "2014-04-10T15:17:52Z", "tags": [], "attachment_id": null}, {"count": 8, "tags": [], "text": "(In reply to Konstantin Kolinko from comment #7)\n> 2. Nobody here works for Microsoft.\n> \n> Providing windows binaries is a courtesy and may stop at any random moment.\n\nThat's good to know, and may be something to mention on the site, so people don't build production infrastructure on it.\n\n> > Would it, for future reference, be possible to document the Windows\n> > library build process better?\n> \n> 3. Documentation improvement patches are appreciated. You may submit one via\n> bugzilla.\n\nI would love to improve the documentation, but at the moment it seems nobody knows how the Windows build works except for Mladen. See for instance this post of Mark Thomas: http://mail-archives.apache.org/mod_mbox/tomcat-dev/201205.mbox/%3C4FBA6DFC.4090502@apache.org%3E", "attachment_id": null, "bug_id": 56363, "id": 174449, "time": "2014-04-10T15:32:41Z", "creator": "mike@normi.net", "creation_time": "2014-04-10T15:32:41Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 56363, "attachment_id": null, "id": 174450, "time": "2014-04-10T15:48:22Z", "creator": "Jeffrey.Janner@polydyne.com", "creation_time": "2014-04-10T15:48:22Z", "is_private": false, "text": "(In reply to Konstantin Kolinko from comment #7)\n> (In reply to Jeffrey.Janner from comment #6)\n> > However, the Windows version is statically linked, so we had to wait for\n> > Mladen to work his magic or try to do the build ourselves using minimal\n> > instructions.\n> \n> 4. a) That would be a mess.  b) Somebody would still need to build OpenSSL\n> for you. http://openssl.org/ provides source code only. See 2.\n\nYep.  Luckily, that site has a link (http://www.openssl.org/related/binaries.html) to someone who provides binaries almost as fast as OpenSSL releases them.\nThat site is http://slproweb.com/products/Win32OpenSSL.html.\nI think in this case he and Mladen had versions available at about the same time, though we're still waiting on an \"approved\" release from the ASF.\nOverall, I'm generally OK getting the full suite from the ASF, its just would be nice to have alternatives."}, {"count": 10, "tags": [], "bug_id": 56363, "attachment_id": null, "id": 174451, "time": "2014-04-10T15:52:21Z", "creator": "mturk@apache.org", "creation_time": "2014-04-10T15:52:21Z", "is_private": false, "text": "I'll update the BUILDING with windows section since everyone are so concerned of my health :)\n\nIt's very simple. The biggest problem is compiling apr and openssl. OpenSSL needs to be patched to allow /MD with static lib (something I tried to convince openssl developers for years without luck). We have the patch in the source dist. Then you have to put apr and openssl include and lib files to some directory \nC:\\foo\\bar\\include\nC:\\foo\\bar\\lib\n\nThen execute:\nnmake -f NMAKEMakefile WITH_APR=C:\\foo\\bar WITH_OPENSSL=C:\\foo\\bar APR_DECLARE_STATIC=1 [ENABLE_OCSP=1]\n\nWhen building APR I also modify apr.hw and set  APR_HAVE_IPV6 to 1.\n\nThat's it. 10 minutes for all architectures on an average box.\nNote. Forget about IDE builds. They change the format of those .dsp, .vcproj whatever files with each version. Use nmake and command line. You'll need them to build openssl anyhow, so why not for all."}, {"count": 11, "tags": [], "text": "Is there a prediction on when this compile will be released?", "attachment_id": null, "bug_id": 56363, "id": 174508, "time": "2014-04-11T21:08:26Z", "creator": "gbollinger@chalexcorp.com", "creation_time": "2014-04-11T21:08:26Z", "is_private": false}, {"count": 12, "tags": [], "bug_id": 56363, "attachment_id": null, "is_private": false, "id": 174549, "time": "2014-04-14T09:26:43Z", "creator": "klemen.novak@mikrocop.com", "creation_time": "2014-04-14T09:26:43Z", "text": "Any news on the build for windows?"}, {"count": 13, "tags": [], "text": "Vote passed, ANN will follow after mirror sync. cca 24 hrs max", "attachment_id": null, "bug_id": 56363, "id": 174550, "time": "2014-04-14T09:32:44Z", "creator": "mturk@apache.org", "creation_time": "2014-04-14T09:32:44Z", "is_private": false}, {"count": 14, "tags": [], "bug_id": 56363, "attachment_id": null, "id": 174558, "time": "2014-04-14T19:53:47Z", "creator": "mturk@apache.org", "creation_time": "2014-04-14T19:53:47Z", "is_private": false, "text": "Binaries uploaded\nhttp://apache.org/dist/tomcat/tomcat-connectors/native/1.1.30/\nTook some time because of our own infrastructure Heartblead issues.\n\nI'll create ANN message tomorrow after mirrors sync with Apache server."}, {"count": 15, "text": "Just a note: r1587378 in trunk now requires tcnative 1.1.30, so Tomcat 8.0.6 will require tcnative 1.1.30 to start.", "creator": "chris@christopherschultz.net", "is_private": false, "id": 174566, "time": "2014-04-15T01:09:47Z", "bug_id": 56363, "creation_time": "2014-04-15T01:09:47Z", "tags": [], "attachment_id": null}, {"count": 16, "tags": [], "bug_id": 56363, "attachment_id": null, "id": 174619, "time": "2014-04-16T11:05:55Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2014-04-16T11:05:55Z", "is_private": false, "text": "(In reply to Mladen Turk from comment #14)\n> Binaries uploaded\n> http://apache.org/dist/tomcat/tomcat-connectors/native/1.1.30/\n\nThe correct download link is\nhttp://tomcat.apache.org/download-native.cgi\n\n(A policy is that we do not advertise direct links to the ASF server,\nbut suggest using the mirrors, as linked from the download page.)"}, {"count": 17, "tags": [], "bug_id": 56363, "attachment_id": null, "id": 174638, "time": "2014-04-16T15:18:26Z", "creator": "keithdavis@solidtechservice.com", "creation_time": "2014-04-16T15:18:26Z", "is_private": false, "text": "(In reply to Christopher Schultz from comment #15)\n> Just a note: r1587378 in trunk now requires tcnative 1.1.30, so Tomcat 8.0.6\n> will require tcnative 1.1.30 to start.\n\nPlease forgive my lack of understanding, but what am we are supposed to do to patch our servers? Build our own and then use this connector? What is the connector for?"}, {"count": 18, "tags": [], "text": "(In reply to Keith Davis from comment #17)\n> \n> Please forgive my lack of understanding, but what am we are supposed to do\n> to patch our servers? Build our own and then use this connector? What is the\n> connector for?\n\nBugzilla is not support forum. Please use tomcat users list instead", "is_private": false, "id": 174642, "creator": "mturk@apache.org", "time": "2014-04-16T15:43:47Z", "bug_id": 56363, "creation_time": "2014-04-16T15:43:47Z", "attachment_id": null}, {"count": 19, "tags": [], "bug_id": 56363, "attachment_id": null, "id": 175884, "time": "2014-06-19T02:14:50Z", "creator": "dgilles@opentext.com", "creation_time": "2014-06-19T02:14:50Z", "is_private": false, "text": "As a result of the latest OpenSSL vulnerability in 1.0.1g, I've been trying the build described here. However, the resulting .dll is always 200-300 KB (the build from April is ~1.5 MB), depending on which version of vc++ I use, and Tomcat cannot use it. Would you be able to provide a build with the latest OpenSSL 1.0.1h? Or more explicit instructions on completing the build on Windows?\n\n(In reply to Mladen Turk from comment #10)\n> I'll update the BUILDING with windows section since everyone are so\n> concerned of my health :)\n> \n> It's very simple. The biggest problem is compiling apr and openssl. OpenSSL\n> needs to be patched to allow /MD with static lib (something I tried to\n> convince openssl developers for years without luck). We have the patch in\n> the source dist. Then you have to put apr and openssl include and lib files\n> to some directory \n> C:\\foo\\bar\\include\n> C:\\foo\\bar\\lib\n> \n> Then execute:\n> nmake -f NMAKEMakefile WITH_APR=C:\\foo\\bar WITH_OPENSSL=C:\\foo\\bar\n> APR_DECLARE_STATIC=1 [ENABLE_OCSP=1]\n> \n> When building APR I also modify apr.hw and set  APR_HAVE_IPV6 to 1.\n> \n> That's it. 10 minutes for all architectures on an average box.\n> Note. Forget about IDE builds. They change the format of those .dsp, .vcproj\n> whatever files with each version. Use nmake and command line. You'll need\n> them to build openssl anyhow, so why not for all."}, {"count": 20, "tags": [], "text": "(In reply to Doug from comment #19)\n\nSee current thread \"Building tcnative on win32\",\n\"Building tcnative on win32 [progress!]\" on dev mailing list.\nhttp://tomcat.markmail.org/thread/ohhpa3k2kicyvjvy\n\nMaybe somebody could help there.", "is_private": false, "id": 175899, "creator": "knst.kolinko@gmail.com", "time": "2014-06-19T11:52:10Z", "bug_id": 56363, "creation_time": "2014-06-19T11:52:10Z", "attachment_id": null}, {"count": 21, "tags": [], "bug_id": 56363, "attachment_id": null, "id": 175902, "time": "2014-06-19T12:45:25Z", "creator": "chris@christopherschultz.net", "creation_time": "2014-06-19T12:45:25Z", "is_private": false, "text": "(In reply to Doug from comment #19)\n> As a result of the latest OpenSSL vulnerability in 1.0.1g, I've been trying\n> the build described here. However, the resulting .dll is always 200-300 KB\n> (the build from April is ~1.5 MB), depending on which version of vc++ I use,\n> and Tomcat cannot use it. Would you be able to provide a build with the\n> latest OpenSSL 1.0.1h? Or more explicit instructions on completing the build\n> on Windows?\n\nThe problem is likely that you are not building tcnative statically, but instead as a dynamically-linked DLL. For convenience, the Tomcat team provides a statically-linked tcnative which means it contains OpenSSL, APR, and tcnative. Note that, if a dynamically-linked DLL were distributed, no rebuild would be necessary to upgrade OpenSSL."}, {"count": 22, "text": "(In reply to Konstantin Kolinko from comment #20)\n> (In reply to Doug from comment #19)\n> \n> See current thread \"Building tcnative on win32\",\n> \"Building tcnative on win32 [progress!]\" on dev mailing list.\n> http://tomcat.markmail.org/thread/ohhpa3k2kicyvjvy\n> \n> Maybe somebody could help there.\n\nI'll post my current build script which has a few pre-requisites.", "creator": "chris@christopherschultz.net", "is_private": false, "id": 175903, "time": "2014-06-19T12:45:52Z", "bug_id": 56363, "creation_time": "2014-06-19T12:45:52Z", "tags": [], "attachment_id": null}, {"count": 23, "tags": [], "creator": "dgilles@opentext.com", "attachment_id": null, "id": 175933, "time": "2014-06-20T13:14:16Z", "bug_id": 56363, "creation_time": "2014-06-20T13:14:16Z", "is_private": false, "text": "(In reply to Christopher Schultz from comment #22)\n> (In reply to Konstantin Kolinko from comment #20)\n> > (In reply to Doug from comment #19)\n> > \n> > See current thread \"Building tcnative on win32\",\n> > \"Building tcnative on win32 [progress!]\" on dev mailing list.\n> > http://tomcat.markmail.org/thread/ohhpa3k2kicyvjvy\n> > \n> > Maybe somebody could help there.\n> \n> I'll post my current build script which has a few pre-requisites.\n\nThanks, I would really appreciate that!"}]