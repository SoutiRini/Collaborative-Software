[{"count": 0, "attachment_id": null, "bug_id": 37029, "text": "TLD Validator reports errors when it encounters the html \"param\" element.\n\nExample:\n<?xml version=\"1.0\"?>\n<html\n    xmlns:jsp=\"http://java.sun.com/JSP/Page\"\n    xmlns:jstlc=\"http://java.sun.com/jsp/jstl/core\"\n    xmlns:jstlf=\"http://java.sun.com/jsp/jstl/fmt\">\n\n    <jstlc:if test=\"${true}\">\n        <applet code=\"some.package.SomeApplet.class\" archive=\"applet.jar\"\nwidth=\"1\" height=\"1\">\n            <param name=\"tx\" value=\"${'blah'}\"/>\n        </applet>\n    </jstlc:if>\n</html>\n\ncauses the following error:\n\norg.apache.jasper.JasperException: <h3>Validation error messages from\nTagLibraryValidator for c</h3><p>4: Invalid use of \"param\" tag outside\nlegitimate parent tag</p><h3>Validation error messages from TagLibraryValidator\nfor fmt</h3><p>4: &lt;param&gt; outside &lt;message&gt;</p>\n\torg.apache.jasper.compiler.DefaultErrorHandler.jspError(DefaultErrorHandler.java:50)\n\torg.apache.jasper.compiler.ErrorDispatcher.dispatch(ErrorDispatcher.java:407)\n\torg.apache.jasper.compiler.ErrorDispatcher.jspError(ErrorDispatcher.java:72)\n\torg.apache.jasper.compiler.Validator.validateXmlView(Validator.java:1549)\n\torg.apache.jasper.compiler.Validator.validate(Validator.java:1495)\n\torg.apache.jasper.compiler.Compiler.generateJava(Compiler.java:157)\n\torg.apache.jasper.compiler.Compiler.compile(Compiler.java:286)\n\torg.apache.jasper.compiler.Compiler.compile(Compiler.java:267)\n\torg.apache.jasper.compiler.Compiler.compile(Compiler.java:255)\n\torg.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:556)\n\torg.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:293)\n\torg.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:291)\n\torg.apache.jasper.servlet.JspServlet.service(JspServlet.java:241)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:802)", "id": 81006, "time": "2005-10-11T21:23:13Z", "creator": "mihbor@wp.pl", "creation_time": "2005-10-11T21:23:13Z", "tags": [], "is_private": false}, {"count": 1, "attachment_id": null, "creator": "kschneider@gmail.com", "is_private": false, "id": 81008, "time": "2005-10-11T22:05:23Z", "bug_id": 37029, "creation_time": "2005-10-11T22:05:23Z", "tags": [], "text": "Try adding the XHTML namespace to the <html> element:\n\n<html\n    xmlns=\"http://www.w3.org/1999/xhtml\"\n    xmlns:jsp=\"http://java.sun.com/JSP/Page\"\n    xmlns:jstlc=\"http://java.sun.com/jsp/jstl/core\"\n    xmlns:jstlf=\"http://java.sun.com/jsp/jstl/fmt\">\n...\n"}, {"count": 2, "tags": [], "text": "The html <param> is being treated incorrectly as an <fmt:param> tag,\nbecause of this code in JstlBaseTLV:\n\n    protected boolean isTag(String tagUri,\n                            String tagLn,\n                            String matchUri,\n                            String matchLn) {\n        if (tagUri == null\n                || tagLn == null\n                || matchUri == null\n                || matchLn == null)\n            return false;\n\n        if (tagUri.length() > matchUri.length()) {\n            return (tagUri.startsWith(matchUri)\n                    && tagLn.equals(matchLn));\n        } else {\n            return (matchUri.startsWith(tagUri)\n                    && tagLn.equals(matchLn));\n        }\n\nIn the test case, isTag() is invoked with these args:\n\n  tagUri=\"\"\n  tagLn=\"param\"\n  matchUri=\"http://java.sun.com/jsp/jstl/fmt\"\n  matchLn=\"param\"\n\nwhich means the \"else\" will return TRUE, since any string starts with\nthe empty string!\n\nThe fix is to return FALSE if the \"tagUri\" param is NULL or the EMPTY\nstring, as shown in these diffs:\n\n--- JstlBaseTLV.java    8 Dec 2005 01:21:24 -0000\n+++ JstlBaseTLV.java    10 Dec 2005 00:01:32 -0000\n@@ -210,6 +210,7 @@\n                            String matchUri,\n                            String matchLn) {\n        if (tagUri == null\n+                || tagUri.length() == 0\n                || tagLn == null\n                || matchUri == null\n                || matchLn == null)", "is_private": false, "id": 83496, "creator": "jan.luehe@sun.com", "time": "2005-12-10T01:17:16Z", "bug_id": 37029, "creation_time": "2005-12-10T01:17:16Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 37029, "attachment_id": null, "is_private": false, "id": 83759, "time": "2005-12-17T21:05:11Z", "creator": "pierre.delisle@sun.com", "creation_time": "2005-12-17T21:05:11Z", "text": "Applied Jan's patch. Thanks Jan!"}]