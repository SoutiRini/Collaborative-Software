[{"count": 0, "tags": [], "creator": "gwoolsey@apache.org", "text": "Created attachment 35596\nsample workbook with cell styles without colors\n\nThe attached workbook, saved from Excel 2016, contains a cell style with a fill with a pattern but no background or foreground color.\n\nCurrently, POI will happily return an XSSFColor instance for this style's foreground and background color, with null for the CTColor field.  This will then lead to later NPEs in unexpected places, of course.\n\nSince this is a normal and valid way to construct fills, and probably other format features, I don't think just checking for a null constructor parameter and throwing an exception is sufficient.  We need to replace constructors that take a CTColor object directly with a factory method that can check the input and return null if needed instead of an invalid XSSFColor object.", "id": 202672, "time": "2017-12-09T19:38:02Z", "bug_id": 61882, "creation_time": "2017-12-09T19:38:02Z", "is_private": false, "attachment_id": 35596}, {"count": 1, "tags": [], "bug_id": 61882, "text": "My internal bug report appears to be against an older version of POI - I'm unable to reproduce this with a unit test making the same call as the error my user reported.\n\nHowever, I see we do have a lot of code where an inline null check or similar is done on the CTColor argument to decide whether to return null or create an XSSFColor instance.  That pattern is definitely safer as a factory, so I'll still investigate that.", "id": 202676, "attachment_id": null, "creator": "gwoolsey@apache.org", "creation_time": "2017-12-09T20:02:04Z", "time": "2017-12-09T20:02:04Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 61882, "attachment_id": null, "text": "added factory and deprecated CTColor based constructors in r1817796.", "id": 202720, "time": "2017-12-11T17:33:55Z", "creator": "gwoolsey@apache.org", "creation_time": "2017-12-11T17:33:55Z", "is_private": false}]