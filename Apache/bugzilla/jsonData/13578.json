[{"count": 0, "tags": [], "bug_id": 13578, "text": "Guys, you have offered a solution for 4.0.5, and ONLY IMPLICITLY for 4.1.12 \nfor the jsp disclosure bug: downloading a new web.xml file. We had to \nunsuccessfully try re-installing the server before we found out that the \nsolution doesn't really require that.\n\nMillions of people running other 4.x versions (exluding 4.0.6) have only 2 \nchoices:\n1) disable all non-custom-named servlets\n2) upgrade the server immediately\n\nWell, we couldn't upgrade just like that. We have some changes that need to be \nmade first (or perhaps there is another Unicode-related bug in 4.1.12).\n\nI suggest 2 solutions here, and very much hope that you list these as an \noption for non-4.0.5-4.0.6-4.1.12 users:\nA.\n1) download servlets-invoker.jar from 4.1.12 installation (will be attached at \na later message marked A.) (or equivalent) into $CATALINA_HOME/server/lib/.\n\n2) download http://jakarta.apache.org/builds/jakarta-tomcat-\n4.0/release/v4.0.5/bin/hotfix/13365.zip, unzip it, and put web.xml (will be \nattached at a later message marked A.) into \n$CATALINA_HOME/conf\n\nThis solution has none of my code. Although it did take a while to figure \nthings out. Totally trustworthy. It generates 404 error (Not Found) for all \nhacking requests.\n\nB. \n1) Putting web.xml modified by me that will be attached in later message \nmarked B. (or equivalent) into $CATALINA_HOME/conf/ folder. The only changes i \nmade to web.xml are:\n...\n<servlet>\n    <servlet-name>org.apache.catalina.servlets.DefaultServlet</servlet-name>\n    <servlet-class>org.apache.catalina.servlets.DefaultServlet</servlet-class>\n    <init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n    </init-param>\n    <init-param>\n      <param-name>listings</param-name>\n      <param-value>true</param-value>\n    </init-param>\n    <load-on-startup>1</load-on-startup>\n  </servlet>\n<!-- Name a dummy servlet, so that hacking requests can be forwarded to it -->\n  <servlet>\n    <servlet-name>AntiHacker</servlet-name>\n    <servlet-class>rs.security.SourceDisclosure</servlet-class>\n  </servlet>\n...\n<!-- Send hacking requests to this servlet and thus prevent source disclosure -\n->\n  <servlet-mapping>\n    <servlet-name>AntiHacker</servlet-name>\n    <url-pattern>/servlet/org.apache.catalina.servlets.DefaultServlet/*</url-\npattern>\n  </servlet-mapping>\n\n2) Optional: Putting SourceDisclosure.class will be attached in later message \nmarked B. (or equivalent) into WEB-INF/classes/rs/security/ folder of each \napplication. It has to be rs/security/ because that's how I compiled it. \nEquivalents can be made differently. It is optional: if it's not there in an \napplication, then no source will be shown, but instead a 503 (Service \nUnavailable) error message will pop up, which makes no harm to the server, and \nprevents the hacking. The class does nothing but printing \" All right, now we \ncan report the IP address of the criminal who's been hacking Java servers all \nover the Internet to the Interpol:  127.0.0.1\" :)\n\nBtw, it would very useful if the simplicity of such solution(s) was expressed \non a seeable place in Tomcat pages. It took quite a few hours to figure these \nthings out.\n\nThanks,\nr", "id": 24409, "time": "2002-10-13T06:57:00Z", "creator": "sabiq@purdue.edu", "creation_time": "2002-10-13T06:57:00Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 13578, "text": "Created attachment 3447\nA. 1)", "id": 24410, "time": "2002-10-13T07:01:33Z", "creator": "sabiq@purdue.edu", "creation_time": "2002-10-13T07:01:33Z", "is_private": false, "attachment_id": 3447}, {"count": 2, "tags": [], "bug_id": 13578, "attachment_id": 3448, "text": "Created attachment 3448\nA. 2)", "id": 24411, "time": "2002-10-13T07:03:39Z", "creator": "sabiq@purdue.edu", "creation_time": "2002-10-13T07:03:39Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 13578, "attachment_id": 3449, "id": 24412, "time": "2002-10-13T07:06:06Z", "creator": "sabiq@purdue.edu", "creation_time": "2002-10-13T07:06:06Z", "is_private": false, "text": "Created attachment 3449\nB. 1) (web.xml)"}, {"count": 4, "tags": [], "bug_id": 13578, "attachment_id": 3450, "id": 24413, "time": "2002-10-13T07:08:14Z", "creator": "sabiq@purdue.edu", "creation_time": "2002-10-13T07:08:14Z", "is_private": false, "text": "Created attachment 3450\nB. 2) (SourceDisclosure.class)"}, {"count": 5, "tags": [], "bug_id": 13578, "attachment_id": null, "id": 24414, "time": "2002-10-13T07:16:43Z", "creator": "sabiq@purdue.edu", "creation_time": "2002-10-13T07:16:43Z", "is_private": false, "text": "A. 1) file type is actually (application/x-java-archive). It's servlets-\ninvoker.jar from 4.1.12 install.\nA. 2) is web.xml from 4.0.5 fix mentioned above.\n\nI've tried all of these this on Tomcat 4.1.8. And assume that they will work \nwith all others, which is reasonable. If for some reason 4.0.x releases don't \nwork with solution A, until there is an official fix from Tomcat for them, \nsolution B will do just fine, as it doesn't require changing the archive.\n\nSorry for long messages,\nr"}, {"count": 6, "tags": [], "bug_id": 13578, "attachment_id": null, "id": 24415, "time": "2002-10-13T08:02:56Z", "creator": "sabiq@purdue.edu", "creation_time": "2002-10-13T08:02:56Z", "is_private": false, "text": "I have not observed the source disclosure bug in servlets. Am i correct in \nassuming that servlet source is safe?\n\nThanks,\nr"}, {"count": 7, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "is_private": false, "id": 24418, "time": "2002-10-13T14:04:30Z", "bug_id": 13578, "creation_time": "2002-10-13T14:04:30Z", "text": "I am sure you are willing to help, but:\n- we cannot provide all possible workarounds for a particular problem.\n- bugzilla is not a board or something like it. It is to report bugs, not to\noffer unsupported workarounds to publicized security issues."}, {"text": "This was a funny remark. Millions of people running Versions of Tomcat that \nare not 4.0.5, or 4.1.12, have to come with their own solutions to a bug in \nthe server.\nI took me 5 hours to figure out solution B, and another 1 hour for solution A. \nDo you suggest that everybody goes thru the same process, or that there is a \npatch offered that everybody can use?\n\nP.S. There are some dependencies that don't allow people to upgrade their \nserver overnight. All these people need a patch like this. Rejecting it means \npoor customer service at the least. Lucky Java hackers, they can still look \naround for struggling servers...", "tags": [], "creator": "sabiq@purdue.edu", "is_private": false, "count": 8, "id": 24424, "time": "2002-10-13T20:12:22Z", "bug_id": 13578, "creation_time": "2002-10-13T20:12:22Z", "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 13578, "attachment_id": null, "id": 24430, "time": "2002-10-13T20:37:47Z", "creator": "sabiq@purdue.edu", "creation_time": "2002-10-13T20:37:47Z", "is_private": false, "text": "Our server is now safe from jsp bug disclosure. And we run 4.1.8. Ciao hackers."}, {"count": 10, "tags": [], "bug_id": 13578, "text": "Sorry, but this has nothing to do in bugzilla, which is for reporting *BUGS*,\nnot unsupported workarounds for security holes. Please post this wherever it is\nappropriate (tomcat-user or something). This is not a judgement on the quality\nof your work, or the benefit or having additional workarounds to the security hole.", "id": 24444, "time": "2002-10-14T07:05:54Z", "creator": "remm@apache.org", "creation_time": "2002-10-14T07:05:54Z", "is_private": false, "attachment_id": null}]