[{"count": 0, "tags": [], "creator": "jan0michael@yahoo.com", "attachment_id": null, "id": 199217, "time": "2017-06-15T16:11:57Z", "bug_id": 61189, "creation_time": "2017-06-15T16:11:57Z", "is_private": false, "text": "org.apache.catalina.servlets.CGIServlet has a param 'passShellEnvironment'.\nIt would give more flexibility to allow for different environment variables per CGI.\n\nExamples:\n\n- set HOME and HTTP_HOME to the nextcloud directory\n- set SQWEBMAIL_MAXMSGSIZE for sqwebmail\n\n\nFor the sqwebmail example this could look for example like\n\n      <init-param>\n         <param-name>EnvironmentVariables</param-name>\n         <param-value>SQWEBMAIL_MAXARGSIZE=20000000|SQWEBMAIL_MAXATTSIZE=20000000|SQWEBMAIL_MAXMSGSIZE=20000000</param-value>\n      </init-param>\n\nI wrote my own CGI executor servlet for sqwebmail.\nAnd today I need environment variables for Nextcloud.\n\nI don't like to put them in /etc/init.d/tomcat or catalina.sh, because they may be lost after a Tomcat update."}, {"count": 1, "tags": [], "bug_id": 61189, "text": "> I don't like to put them in /etc/init.d/tomcat or catalina.sh, because they\n> may be lost after a Tomcat update.\n\nThe place for custom environment variables in Apache Tomcat is bin/setenv.sh.\nThis is documented in RUNNING.txt.\n\nhttp://tomcat.apache.org/tomcat-8.5-doc/RUNNING.txt", "id": 199243, "time": "2017-06-16T14:53:25Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2017-06-16T14:53:25Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "jan0michael@yahoo.com", "attachment_id": 35291, "id": 200661, "time": "2017-09-05T08:01:57Z", "bug_id": 61189, "creation_time": "2017-09-05T08:01:57Z", "is_private": false, "text": "Created attachment 35291\nAllow to configure CGI specific environment variables.\n\nThis patch makes configuration of additional environment variables similar to the configuration of executable-arg-1, executable-arg-2, and so on\n\n   <init-param>\n      <param-name>environment-variable-1</param-name>\n      <param-value>SQWEBMAIL_MAXARGSIZE=20000000</param-value>\n   </init-param>\n   <init-param>\n      <param-name>nvironment-variable-2</param-name>\n      <param-value>SQWEBMAIL_MAXATTSIZE=20000000</param-value>\n   </init-param>\n   <init-param>\n      <param-name>nvironment-variable-3</param-name>\n      <param-value>SQWEBMAIL_MAXMSGSIZE=20000000</param-value>\n   </init-param>"}, {"count": 3, "tags": [], "bug_id": 61189, "text": "I don't like the use of unique names that don't have any meaning, like `environment-variable-N`. Might I suggest one or the other of these schemes:\n\n    <init-param>\n      <param-name>environment-variables</param-name>\n      <param-value>\n        ENV_VAR_1=foo\n        ENV_VAR_2=bar\n        ...\n      </param-value>\n    </init-param>\n\nOr:\n\n    <init-param>\n        <param-name>environment-variable-ENV_VAR_1</param-name>\n        <param-value>foo</param-value>\n    </init-param>\n    <init-param>\n        <param-name>environment-variable-ENV_VAR_2</param-name>\n        <param-value>bar</param-value>\n    </init-param>\n    ...\n\n\nI think I'd prefer the former over the latter.\n\nSecond, I think it makes sense to strip whitespace from around the names and values of the environment variables. Basically, just add \".trim()\" to all of your .substring() calls. This will solve silly problems like people placing leading/trailing spaces around names/values/equal signs. XML allows a lot of optional whitespace, and some editors (and humans) like to be verbose.", "id": 200671, "time": "2017-09-05T15:09:43Z", "creator": "chris@christopherschultz.net", "creation_time": "2017-09-05T15:09:43Z", "is_private": false, "attachment_id": null}, {"count": 4, "attachment_id": 35296, "bug_id": 61189, "text": "Created attachment 35296\nAll variable declarations in one <param-value>.\n\nSo here is a patch, that would implement your first suggestion.\nBut, while implementing it, I thought of some inconveniences:\n\n- People may think: Oh, I can put whitespace here, so I will do that somewhere else too...\n\n(- It is impossible, to put a line break in the variable value, or to put white space at the beginning or the end of the variable value (its probably not used very often))\n\nI think I'd prefer your second suggestion...\nI'll create a patch for that one too.", "id": 200679, "time": "2017-09-05T19:52:51Z", "creator": "jan0michael@yahoo.com", "creation_time": "2017-09-05T19:52:51Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "bug_id": 61189, "text": "Created attachment 35297\nVariable name in <param-name>.\n\nThis patch implements your second suggestion.\nFor the moment it is my preferred one.\nIt also is the patch that adds the least number of lines of code :-)\n\nFirst and second patch would be fine for me too :-)", "id": 200680, "time": "2017-09-05T20:16:25Z", "creator": "jan0michael@yahoo.com", "creation_time": "2017-09-05T20:16:25Z", "is_private": false, "attachment_id": 35297}, {"count": 6, "attachment_id": null, "bug_id": 61189, "text": "Thanks for the patches. I like the second one too.\n\nFixed in:\n- trunk for 9.0.0.M27 onwards\n- 8.5.x for 8.5.21 onwards\n- 8.0.x for 8.0.47 onwards\n- 7.0.x for 7.0.82 onwards", "id": 200835, "time": "2017-09-12T20:25:42Z", "creator": "markt@apache.org", "creation_time": "2017-09-12T20:25:42Z", "tags": [], "is_private": false}]