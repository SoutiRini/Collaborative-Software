[{"count": 0, "attachment_id": null, "bug_id": 37268, "text": "When a mkdir task contains \"..\" as directory name, it will not be parsed\ncorrectly. Same thing as it happened with Bug #26765. The fix is similar: call\nthe FiltUtils.normalize() to make sure the path is parsed correctly. Patch included.\n\ndiff -Nurb apache-ant-1.6.5/src/main/org/apache/tools/ant/taskdefs/Mkdir.java\napache-ant-1.6.5-fixed/src/main/org/apache/tools/ant/taskdefs/Mkdir.java\n--- apache-ant-1.6.5/src/main/org/apache/tools/ant/taskdefs/Mkdir.java \n2005-06-02 15:19:58.000000000 +0200\n+++ apache-ant-1.6.5-fixed/src/main/org/apache/tools/ant/taskdefs/Mkdir.java   \n2005-10-27 15:26:50.000000000 +0200\n@@ -20,6 +20,7 @@\n import java.io.File;\n import org.apache.tools.ant.BuildException;\n import org.apache.tools.ant.Task;\n+import org.apache.tools.ant.util.FileUtils;\n\n /**\n  * Creates a given directory.\n@@ -34,6 +35,7 @@\n public class Mkdir extends Task {\n\n     private static final int MKDIR_RETRY_SLEEP_MILLIS = 10;\n+    private static final FileUtils fileUtils = FileUtils.getFileUtils();\n     /**\n      * our little directory\n      */\n@@ -48,6 +50,9 @@\n             throw new BuildException(\"dir attribute is required\", getLocation());\n         }\n\n+       // Normalize file name to make sure \"..\" are resolved correctly.\n+       dir = fileUtils.normalize(dir.getAbsolutePath());\n+\n         if (dir.isFile()) {\n             throw new BuildException(\"Unable to create directory as a file \"\n                                      + \"already exists with that name: \"", "id": 81819, "time": "2005-10-27T15:28:08Z", "creator": "l.guendogdu@feature-it.com", "creation_time": "2005-10-27T15:28:08Z", "tags": [], "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 37268, "is_private": false, "count": 1, "id": 85155, "time": "2006-01-28T15:45:07Z", "creator": "bodewig@apache.org", "creation_time": "2006-01-28T15:45:07Z", "text": "dir will already be normalized, this happens when Ant translates the string from\ndir=\"...\" to the File instance passed to setDir.\n\nI can't see any problem with\n\nstefan@www:~/ASF/ant/ant-HEAD> cat test.xml\n<project basedir=\"..\">\n  <mkdir dir=\"ant-HEAD/../../foo\"/>\n</project>\nstefan@www:~/ASF/ant/ant-HEAD> ant -f test.xml\nBuildfile: test.xml\n    [mkdir] Created dir: /home/stefan/ASF/foo\n\nBUILD SUCCESSFUL\nTotal time: 1 second\n"}]