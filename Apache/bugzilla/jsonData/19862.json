[{"count": 0, "tags": [], "bug_id": 19862, "attachment_id": null, "is_private": false, "id": 37081, "time": "2003-05-12T18:07:39Z", "creator": "lloydj@us.ibm.com", "creation_time": "2003-05-12T18:07:39Z", "text": "While processing an Excel file (available upon request) with HSSF, I got a run-\ntime exception in the method NameRecord.fillFields(). I looked at the code and \nfound a bug in line 658 of that method in the file NameRecord.java in version \n1.10.0. The code should be adding the length of the previous variable length \nfield to find the start of the current field. Instead it is adding the length \nof the current field. I changed the line as below to solve the problem. How do \nI get this change into the HSSF base?\n\n          //int start_of_description_text   = start_of_custom_menu_text + \nfield_8_length_description_text;\n\t    int start_of_description_text   = start_of_custom_menu_text + \nfield_7_length_custom_menu;\n\nThe exception occurs with some macros as below with the 1.10.0 developer \nrelease. \n\njava.lang.reflect.InvocationTargetException:\njava.lang.StringIndexOutOfBoundsException: String index out of range: 63\n        at java.lang.String.<init>(Unknown Source)\n        at java.lang.String.<init>(Unknown Source)\n        at\norg.apache.poi.hssf.record.NameRecord.fillFields(NameRecord.java:633)\n\n        at org.apache.poi.hssf.record.Record.fillFields(Record.java:143)\n        at org.apache.poi.hssf.record.Record.<init>(Record.java:105)\n        at\norg.apache.poi.hssf.record.NameRecord.<init>(NameRecord.java:121)\n        at java.lang.reflect.Constructor.newInstance(Native Method)\n        at\norg.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:254)\n        at\norg.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:192)\n        at\norg.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:187)\n        at\norg.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:234)\n        at\norg.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:215)\n        at\ncom.ibm.wps.odc.convert.sheet.ExcelReader.read(ExcelReader.java:118)"}, {"count": 1, "tags": [], "text": "Created attachment 6327\nThis file causes the exception when processed by HSSFWorkbook", "attachment_id": 6327, "id": 37082, "creator": "lloydj@us.ibm.com", "time": "2003-05-12T18:11:04Z", "bug_id": 19862, "creation_time": "2003-05-12T18:11:04Z", "is_private": false}, {"id": 37083, "tags": [], "bug_id": 19862, "is_private": false, "count": 2, "text": "Created attachment 6328\nPatch file made from 1.10.0 developer build", "time": "2003-05-12T18:12:35Z", "creator": "lloydj@us.ibm.com", "creation_time": "2003-05-12T18:12:35Z", "attachment_id": 6328}, {"count": 3, "tags": [], "bug_id": 19862, "attachment_id": null, "is_private": false, "id": 37385, "time": "2003-05-17T18:36:50Z", "creator": "dmui@apache.org", "creation_time": "2003-05-17T18:36:50Z", "text": "Committed 05/17/2003.\n\nThanks for the contribution, please verify.  Would highly appreciate test cases\nin the future to prevent this bug from resurfacing and speed patching along.\n\nThanks again!"}]