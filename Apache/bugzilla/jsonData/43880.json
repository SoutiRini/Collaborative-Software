[{"count": 0, "attachment_id": null, "bug_id": 43880, "is_private": false, "id": 110629, "time": "2007-11-16T02:46:08Z", "creator": "lenertj@hotmail.com", "creation_time": "2007-11-16T02:46:08Z", "tags": [], "text": "Every day I must restart apache (kill some threads) because some threads in \nstatus SENDING REPLY forever.\nApplication: httpd (with proxy balancer) + php (eaccelerator)\n\nExamples:\n\nstrace -p 10511\nfutex(0x2aaab183c2e0, FUTEX_WAIT, 2, NULL <unfinished ...>\n\ngdb httpd 10511\n#0  0x00002aaaab9a50a8 in __lll_mutex_lock_wait () from /lib64/libpthread.so.0\n#1  0x00007fff6596ee40 in ?? ()\n#2  0x00007fff6596ec90 in ?? ()\n#3  0x00002aaaab9a1cd7 in pthread_mutex_lock () from /lib64/libpthread.so.0\n#4  0x0000000000000010 in ?? ()\n#5  0x00002aaab3ee507c in ?? ()\n#6  0x0000000000000000 in ?? ()\n\n\nstrace -p 23562\nProcess 23562 attached - interrupt to quit\nfutex(0x2aaaabde9af8, FUTEX_WAIT, 2, NULL <unfinished ...>\n\ngdb httpd 23562\n#0  0x00002aaaabc8a468 in __lll_mutex_lock_wait () from /lib64/libc.so.6\n#1  0x00002aaaabde98a0 in lock () from /lib64/libc.so.6\n#2  0x00007fff6596f0d0 in ?? ()\n#3  0x00002aaaabc8ef41 in __nss_database_lookup () from /lib64/libc.so.6\n#4  0x00007fff6596ef8c in ?? ()\n#5  0x0000555555cf9be0 in ?? ()\n#6  0x000000006596efd0 in ?? ()\n#7  0x0000555555cf9be0 in ?? ()\n#8  0x00007fff6596f008 in ?? ()\n#9  0x0000555555cfb960 in ?? ()\n#10 0x0000000000000001 in ?? ()\n#11 0x00007fff6596f310 in ?? ()\n#12 0x00002aaab0649420 in zend_compile_file () \nfrom /etc/httpd/modules/libphp5.so\n#13 0x00007fff6596f310 in ?? ()\n#14 0x00002aaab7cd5b00 in ?? ()\n#15 0x00002aaab03b1646 in zend_parse_parameters () \nfrom /etc/httpd/modules/libphp5.so\n#16 0x0000555555cea9b8 in ?? ()\n#17 0x0000000000000000 in ?? ()\n\n\n\nstrace -p 21981\nfutex(0x2aaab183c2e0, FUTEX_WAIT, 2, NULL <unfinished ...>\n\n\ngdb httpd 21981\n#0  0x00002aaaab9a50a8 in __lll_mutex_lock_wait () from /lib64/libpthread.so.0\n#1  0x00007fff6596f280 in ?? ()\n#2  0x00007fff6596f0d0 in ?? ()\n#3  0x00002aaaab9a1cd7 in pthread_mutex_lock () from /lib64/libpthread.so.0\n#4  0x0000550655ed54a0 in ?? ()\n#5  0x0000555555ce6f98 in ?? ()\n#6  0x00002aaab7ce4428 in ?? ()\n#7  0x00007fff6596edc8 in ?? ()\n#8  0x00002aaaaaae8080 in ?? ()\n#9  0x0000555555ed6300 in ?? ()\n#10 0x0000555555ed63a8 in ?? ()\n#11 0x0000000000000001 in ?? ()\n#12 0x00002aaaaaafe6f0 in ?? ()\n#13 0x00002aaa0000003e in ?? ()\n#14 0x00007f066596efe0 in ?? ()\n#15 0x00002aaab0649420 in zend_compile_file () \nfrom /etc/httpd/modules/libphp5.so\n#16 0x00007fff65970120 in ?? ()\n#17 0x00002aaab95f7b28 in ?? ()\n#18 0x00002aaaaaae2548 in ?? ()\n#19 0x00002aaaaaaf22d0 in ?? ()\n#20 0x00002aaab173571f in _nss_files_gethostbyname2_r () \nfrom /lib64/libnss_files.so.2\n#21 0x00002aaaabc6828d in gaih_inet () from /lib64/libc.so.6\n#22 0x00002aaaabc68e43 in getaddrinfo () from /lib64/libc.so.6\n#23 0x00002aaab0378f4c in php_network_get_peer_name () \nfrom /etc/httpd/modules/libphp5.so\n#24 0x00002aaab0379611 in php_network_connect_socket_to_host () \nfrom /etc/httpd/modules/libphp5.so\n#25 0x00002aaab03869e7 in php_stream_generic_socket_factory () \nfrom /etc/httpd/modules/libphp5.so\n#26 0x00002aaab0260717 in zif_openssl_x509_export_to_file () \nfrom /etc/httpd/modules/libphp5.so\n#27 0x00002aaab037bb81 in _php_stream_set_option () \nfrom /etc/httpd/modules/libphp5.so\n#28 0x00002aaab0384e4b in php_stream_xport_connect () \nfrom /etc/httpd/modules/libphp5.so\n#29 0x00002aaab03851aa in _php_stream_xport_create () \nfrom /etc/httpd/modules/libphp5.so\n#30 0x00002aaab034ac5c in php_stream_url_wrap_http_ex () \nfrom /etc/httpd/modules/libphp5.so\n#31 0x00002aaab034cff5 in php_stream_url_wrap_http () \nfrom /etc/httpd/modules/libphp5.so\n#32 0x00002aaab037d4e4 in _php_stream_open_wrapper_ex () \nfrom /etc/httpd/modules/libphp5.so\n#33 0x00002aaab030ea06 in zif_file () from /etc/httpd/modules/libphp5.so\n#34 0x00002aaab03c75ed in zend_get_zval_ptr () \nfrom /etc/httpd/modules/libphp5.so\n#35 0x00002aaab03c577a in execute () from /etc/httpd/modules/libphp5.so\n#36 0x00002aaab03ca8a4 in zend_do_fcall () from /etc/httpd/modules/libphp5.so\n#37 0x00002aaab03c577a in execute () from /etc/httpd/modules/libphp5.so\n#38 0x00002aaab03aa0fe in zend_execute_scripts () \nfrom /etc/httpd/modules/libphp5.so\n#39 0x00002aaab036cab1 in php_execute_script () \nfrom /etc/httpd/modules/libphp5.so\n#40 0x00002aaab0431bba in zend_do_fcall () from /etc/httpd/modules/libphp5.so\n#41 0x000055555557cd63 in ap_run_handler (r=0x555555e9d988) \nat /usr/src/debug/httpd-2.2.6/server/config.c:157\n#42 0x000055555557d0c1 in ap_invoke_handler (r=0x555555e9d988) \nat /usr/src/debug/httpd-2.2.6/server/config.c:372\n#43 0x00005555555892d9 in ap_process_request (r=0x555555e9d988) \nat /usr/src/debug/httpd-2.2.6/modules/http/http_request.c:258\n#44 0x0000555555586c38 in ap_process_http_connection (c=0x555555dbc388) \nat /usr/src/debug/httpd-2.2.6/modules/http/http_core.c:184\n#45 0x00005555555834d9 in ap_run_process_connection (c=0x555555dbc388) \nat /usr/src/debug/httpd-2.2.6/server/connection.c:43\n#46 0x000055555558cd92 in child_main (child_num_arg=Variable \"child_num_arg\" \nis not available.\n) at /usr/src/debug/httpd-2.2.6/server/mpm/prefork/prefork.c:651\n#47 0x000055555558d01c in make_child (s=0x5555556b1a70, slot=171) \nat /usr/src/debug/httpd-2.2.6/server/mpm/prefork/prefork.c:747\n#48 0x000055555558d97b in ap_mpm_run (_pconf=Variable \"_pconf\" is not \navailable.\n) at /usr/src/debug/httpd-2.2.6/server/mpm/prefork/prefork.c:882\n#49 0x000055555556ba00 in main (argc=1, argv=0x7fff65977788) \nat /usr/src/debug/httpd-2.2.6/server/main.c:730"}, {"count": 1, "tags": [], "bug_id": 43880, "attachment_id": null, "text": "The traceback comes from deep within a third-party application, not Apache.", "id": 110632, "time": "2007-11-16T03:17:56Z", "creator": "nick@webthing.com", "creation_time": "2007-11-16T03:17:56Z", "is_private": false}]