[{"count": 0, "tags": [], "creator": "wilson@cbio.mskcc.org", "attachment_id": null, "id": 111617, "time": "2007-12-10T18:14:24Z", "bug_id": 44050, "creation_time": "2007-12-10T18:14:24Z", "is_private": false, "text": "I have implemented the TRIM function for formula cells.  In Excel TRIM is\ndefined as \"Removes all spaces from text except for single spaces between words.\".  \n\nI have also filled in the TRIM \"FORMULA\" and \"EXPECTED VALUE\" rows of the file\nsrc/scratchpad/testcases/org/apache/poi/hssf/data/FormulaEvalTestData.xls with\n15 test cases.  These test cases include passing TRIM a reference to a cell with\nan empty string, passing TRIM numbers, passing TRIM an area, and others.  All\ntests pass.\n\nI would like to implement more formula functions, so any feedback on this one\nwould be greatly appreciated.  I plan to try MID next."}, {"count": 1, "text": "Created attachment 21254\nGenerated using svn diff > FormulaTrimFunction.patch\n\nThis is a patch file, generated by running:\n\nsvn diff > FormulaTrimFunction.patch\n\nAfter I finished implementing the TRIM function.", "creator": "wilson@cbio.mskcc.org", "attachment_id": 21254, "id": 111618, "time": "2007-12-10T18:16:24Z", "bug_id": 44050, "creation_time": "2007-12-10T18:16:24Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "text": "Created attachment 21255\nContains the files I modified to implement and test the TRIM function.\n\nThis tar file contains two files that I modified to implement and test the TRIM\nformula function.  \n\nThe first file is:\n\nsrc/scratchpad/src/org/apache/poi/hssf/record/formula/functions/Trim.java\n\nThis is where the TRIM function is implemented.\n\nThe second file is:\n\nsrc/scratchpad/testcases/org/apache/poi/hssf/data/FormulaEvalTestData.xls\n\nI modified two rows in this file (rows 1392 and 1393), the \"FORMULA\" and\n\"EXPECTED VALUE\" rows for the trim function.  This row contains the test cases\nfor trim.  These tests run successfully and are run automatically when the ant\ntask \"test\" is executed.", "attachment_id": 21255, "id": 111619, "creator": "wilson@cbio.mskcc.org", "time": "2007-12-10T18:22:19Z", "bug_id": 44050, "creation_time": "2007-12-10T18:22:19Z", "is_private": false}, {"count": 3, "attachment_id": null, "bug_id": 44050, "is_private": false, "id": 111632, "time": "2007-12-11T05:05:26Z", "creator": "apache@gagravarr.org", "creation_time": "2007-12-11T05:05:26Z", "tags": [], "text": "Thanks, committed\n\nOne thing to note is that not all of the contents of FormulaEvalTestData.xls\nisn't checked automatically. Once your function is working, you need to list the\nrow number in\nsrc/scratchpad/testcases/org/apache/poi/hssf/record/formula/eval/TestEverything.java\n, and then it'll get tested for you (I've added the Trim row number)"}, {"count": 4, "tags": [], "text": "Thanks Nick.  Actually, I was wondering about the testing.  Trim was being tested in:\n\nsrc/scratchpad/testcases/org/apache/poi/hssf/record/formula/functions/TestEverything.java\n\nWhich appears to set up a new GenericFormulaTestCase for every function listed in \nFormulaEvalTestData.xls between rows 80 and 1481.  Row 80 marks the beginning of the Excel \nfunctions section.\n\nI know it was testing trim successfully because while developing I kept running:\n\nant -Dtestcase=org.apache.poi.hssf.record.formula.functions.TestEverything single-scratchpad-test\n\nWhich was failing on trim for a while.\n\nI was wondering why some functions are listed explicitly in the file you mentioned, \nsrc/scratchpad/testcases/org/apache/poi/hssf/record/formula/eval/TestEverything.java, when the \nsame test is run in \nsrc/scratchpad/testcases/org/apache/poi/hssf/record/formula/functions/TestEverything.java.  So far \nthe only overlaps are concatenate, int, trim and upper.  I suspect that TestEverything.java in the eval \npackage was meant only to test things like \"=B7<B8\" and not in fact the excel functions.\n\n(In reply to comment #3)\n> Thanks, committed\n> \n> One thing to note is that not all of the contents of FormulaEvalTestData.xls\n> isn't checked automatically. Once your function is working, you need to list the\n> row number in\n> src/scratchpad/testcases/org/apache/poi/hssf/record/formula/eval/TestEverything.java\n> , and then it'll get tested for you (I've added the Trim row number)\n\n\n", "attachment_id": null, "id": 111642, "creator": "wilson@cbio.mskcc.org", "time": "2007-12-11T10:21:28Z", "bug_id": 44050, "creation_time": "2007-12-11T10:21:28Z", "is_private": false}, {"count": 5, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 111690, "time": "2007-12-12T02:31:04Z", "bug_id": 44050, "creation_time": "2007-12-12T02:31:04Z", "is_private": false, "text": "Ah, you're right.\n\nI've added some comments on this to the top of the two test files, which will\nhopefully clear up this confusion for the next person!"}]