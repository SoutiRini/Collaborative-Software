[{"count": 0, "tags": [], "bug_id": 39913, "text": "(I posted this to the user list, but I do not feel compfortable\nthat a reply will be forth coming and I am under the gun on this.)\n\nWhen compiling apache 2.2 with:\n\n./configure     --prefix=/usr/local/apache\\\n                --includedir=/usr/local/include\\\n                --enable-so\\\n                --enable-module=expires\\\n                --enable-module=info\\\n                --enable-module=proxy\\\n                --enable-module=so\\\n                --enable-module=rewrite\\\n                --enable-module=auth_dbm\\\n                --enable-module=usertrack\\\n                --enable-module=log_agent\\\n                --enable-module=log_referer\\\n                --enable-module=auth_anon\\\n                --enable-layout=Apache\\\n                --with-ldap\\\n                --enable-ldap\\\n                --enable-authnz-ldap\\\n                --enable-dav\\\n                --enable-dav-lock\\\n                --enable-deflate\\\n                --enable--expires\\\n                --enable-headers\\\n                --enable-info\\\n                --enable-mime-magic\\\n                --enable-rewrite\\\n                --enable-unique-id\\\n                --enable-usertrack\\\n                --with-pmp-prefork\\\n                --enable-ssl\\\n                --with-ssl=/usr/local/lib/openssl-0.9.8b\\\n                --enable-mods-share=most\n\nI get the following error message:\n\nchecking whether to enable mod_ssl... checking dependencies\nchecking for SSL/TLS toolkit base... /usr/local/lib/openssl-0.9.8b\nchecking for OpenSSL version... checking openssl/opensslv.h usability... yes\nchecking openssl/opensslv.h presence... yes\nchecking for openssl/opensslv.h... yes\nchecking openssl/ssl.h usability... yes\nchecking openssl/ssl.h presence... yes\nchecking for openssl/ssl.h... yes\nOK\nchecking openssl/engine.h usability... yes\nchecking openssl/engine.h presence... yes\nchecking for openssl/engine.h... yes\nchecking for SSLeay_version in -lcrypto... yes\nchecking for SSL_CTX_new in -lssl... no\nchecking for ENGINE_init... yes\nchecking for ENGINE_load_builtin_engines... yes\nchecking for SSL_set_cert_store... no\nconfigure: error: ... Error, SSL/TLS libraries were missing or unusable\n\nUpon looking at the config.log file, I see:\n\nconfigure:14271: cc -xarch=v9 -xcode=pic32 -o conftest -xarch=v9 -xcode=pic32 -\nx\narch=v9 -xcode=pic32 -DSOLARIS2=10 -D_POSIX_PTHREAD_SEMANTICS -D_REENTRANT   -\nL/\nusr/local/lib -R/usr/local/lib -L/usr/local/lib/openssl-0.9.8b/lib conftest.c -\nl\ncrypto  -lm  -luuid -lsendfile -lrt -lsocket -lnsl  -lpthread >&5\n\"conftest.c\", line 84: warning: statement not reached\nUndefined                       first referenced\n symbol                             in file\nSSL_set_cert_store                  conftest.o\nld: fatal: Symbol referencing errors. No output written to conftest\n\nLooking at libssl.a, the only cert_store I see is:\n\n[139]   |         19112|           8|FUNC |GLOB |0    |2      \n|SSL_CTX_get_cert_store\n[140]   |         19144|          36|FUNC |GLOB |0    |2      \n|SSL_CTX_set_cert_store\n\nand that is in libssl.a, not libcrypto.a. It has the CTX part in there, but\nI see no reference to that in any C or header files. Note in the cc line above,\nthat libssl.a is not referred to, only libcrypto.a (-lcrypto). I feel confident\nthat I must have made a mistake somewhere along the line, just not sure where.\nI am on Solaris 10 with Sun C compiler 5.8. Thanks for any help!", "id": 90655, "time": "2006-06-27T18:14:59Z", "creator": "douglas@gpc.edu", "creation_time": "2006-06-27T18:14:59Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 39913, "attachment_id": null, "id": 92253, "time": "2006-08-16T12:52:43Z", "creator": "jorton@redhat.com", "creation_time": "2006-08-16T12:52:43Z", "is_private": false, "text": "The lack of SSL_set_cert_store is expected; the failure is for some other\nreason.  Please attach the config.log file produced by configure if you can\nstill reproduce this."}, {"count": 2, "tags": [], "creator": "ainfo@patteran.com", "attachment_id": null, "text": "I also ran into this problem.  I had my openssl-0.9.8d configured with zlib\nsupport.  When I built apache with this option I received the error mentioned\nabove.  if I rebuilt openssl with zlib disabled (the default) and then built\napache 2.2.3 everything woked great!  so the workaround for this bug is to\ndisable zlib support in openssl.", "id": 95433, "time": "2006-11-04T16:25:03Z", "bug_id": 39913, "creation_time": "2006-11-04T16:25:03Z", "is_private": false}, {"count": 3, "tags": [], "creator": "Brian.Orlick@gmail.com", "is_private": false, "text": "Created attachment 19171\nconfig.log after failure due to SSL_set_cert_store symbol not being found\n\nhttpd-2.2.3\nopenssl-0.9.8d\nBoth compiled from source.\nRunning config with \n./configure --enable-ssl --with-ssl=/usr/local/ssl --enable-modules=most\n--enable-mime-magic\n(as stated in the log itself)\nHowever, the error seems to be caused by earlier problems with undefined zlib\nsymbols. e.g.\n\n/usr/local/ssl/lib/libcrypto.a(c_zlib.o)(.text+0x60): In function\n`zlib_stateful_init':\n\nNot sure if zlib is installed on the system, so I'll be installing that and\nseeing after that.  I did compile OpenSSL with zlib support.  I will be\ncompiling zlib from support and seeing if that fixes it.\n\nAlso: http://www.zxid.org/apache.html references this same problem, and the\nauthor of that page indicates that removing the checks for the symbols allows\nthe compilation to succeed.", "id": 96175, "time": "2006-11-26T03:05:13Z", "bug_id": 39913, "creation_time": "2006-11-26T03:05:13Z", "attachment_id": 19171}, {"count": 4, "tags": [], "text": "It appears, in my case, zlib was previously installed, and the problem was that\nconfigure removes -lz from LIBS, but -lz must be included (and follow) -lcrypto\nin some cases when OpenSSL is compiled with zlib support.  This causes problems\nduring configure and actual compilation.\n\nRemoving the two lines that remove -lz from LIBS and set MOD_DEFLATE_LDADD\nalmost fixed the configure problems, but is probably suboptimal.  I don't know\nwhat side effects this might have on other systems.\n\nOne additional fix is that SSL_LIBS, when it has -lcrypto should have had -lz\nfollowing that if it is necessary.  It took me a bit of investigation as I wrote\nthis to discover that SSL_LIBS was set by including build/config_vars.mk -- I\nmanually fixed the support/Makefile which, in my case, was the only place that\nwas erroring out after that.\n\nIt'd be great if someone more knowledgable could make the corrections necessary\nto the configure script so this'll build flawlessly for everyone with a recent\nOpenSSL compiled with zlib.", "is_private": false, "bug_id": 39913, "id": 96181, "time": "2006-11-26T07:01:16Z", "creator": "Brian.Orlick@gmail.com", "creation_time": "2006-11-26T07:01:16Z", "attachment_id": null}, {"count": 5, "tags": [], "text": "Ah, thanks, that is basically the correct analysis.  The configure script should\nbe attempting to link against libcrypto using -lz too.", "is_private": false, "bug_id": 39913, "id": 96199, "time": "2006-11-27T02:17:15Z", "creator": "jorton@redhat.com", "creation_time": "2006-11-27T02:17:15Z", "attachment_id": null}, {"count": 6, "attachment_id": null, "creator": "davelee53@yahoo.com", "is_private": false, "id": 103050, "time": "2007-05-10T11:05:39Z", "bug_id": 39913, "creation_time": "2007-05-10T11:05:39Z", "tags": [], "text": "I got the same error. But maybe with different cause.\nAfter looking at the Apache2.2.3 config.log, I guess I had a mismatched C \ncompiler when building openssl and Apache.\nWhen building the openssl, I configured it to use ANSIC C, like this\nenv CC='/opt/ansic/bin/cc -Ae +DAportable +z' ./configure \\\n--with-ssl=/http/apache2/srclib/openssl/hp .........\nThe openssl config script however ignore this ANSIC C if detects a gcc is \ninstalled. So I wasn't aware it was using gcc.\nSo my workaround is either modify the openssl config script to ignore gcc or \nuninstall/rename gcc from the machine. I then passed this error."}, {"count": 7, "tags": [], "text": "Oops I forgot this bug is for Solaris. I had this issue on my HP-UX 11.11. So \nmy workaround may not apply to you.\n\n(In reply to comment #6)\n> I got the same error. But maybe with different cause.\n> After looking at the Apache2.2.3 config.log, I guess I had a mismatched C \n> compiler when building openssl and Apache.\n> When building the openssl, I configured it to use ANSIC C, like this\n> env CC='/opt/ansic/bin/cc -Ae +DAportable +z' ./configure \\\n> --with-ssl=/http/apache2/srclib/openssl/hp .........\n> The openssl config script however ignore this ANSIC C if detects a gcc is \n> installed. So I wasn't aware it was using gcc.\n> So my workaround is either modify the openssl config script to ignore gcc or \n> uninstall/rename gcc from the machine. I then passed this error.\n\n", "attachment_id": null, "id": 103051, "creation_time": "2007-05-10T11:10:31Z", "time": "2007-05-10T11:10:31Z", "creator": "davelee53@yahoo.com", "bug_id": 39913, "is_private": false}]