[{"count": 0, "tags": [], "creator": "paredes@aecom.yu.edu", "text": "Multiple auth failover [LDAP -> MySQL] does not work on apache 2.2.11\nA realm protected with LDAP alone works correctly:\n\n<directory>\nOptions FollowSymLinks\nAllowOverride None\nAuthType Basic\nAuthName \"LDAP\"\nAuthBasicProvider ldap\nAuthUserFile /dev/null\nAuthLDAPUrl \"ldap://ldap.server\"\nRequire valid-user\n</directory>\n\nA realm protected with MySQL alone works correctly:\n\nDBDriver mysql\nDBDParams \"host=localhost dbname=http_auth user=xxxxxx pass=xxxxxx\"\nDBDMIN 1\nDBDKEEP 2\nDBDMax 10\nDBDExptime 60\n\n<Directory \"/usr/local/apache2/htdocs/mysql\">\nOptions FollowSymLinks\nAllowOverride None\nAuthType Basic\nAuthName \"MySQL\"\nAuthBasicProvider dbd\nRequire valid-user\nAuthDBDUserPWQuery \"Select passwd FROM mysql_auth where username=%s\"\n</Directory>\n\nHowever, a realm with a fail-over from LDAP to MySQL does NOT work:\n\n<directory \"/usr/local/apache2/htdocs/ldap2mysql\">\nOptions FollowSymLinks\nAllowOverride None\nAuthType Basic\nAuthName \"LDAP-2-MySQL\"\nAuthBasicProvider ldap dbd\nAuthzLDAPAuthoritative off\nAuthDBDUserPWQuery \"Select passwd FROM mysql_auth where username=%s\"\nAuthLDAPUrl \"ldap://ldap.server\"\nRequire valid-user\n</directory>\n\nThe 1st auth provider is correctly executed if authentication is true.\nIf the 1st provider fails to authenticate it never fails-over to the 2nd provider.\n\nI've systematically swapped the order in which the provider appears, \nthe order of the directives inside the directory containers, \n& the order in which the modules are loaded.\n\n*** Interestingly, when the authproviders are file & ldap, or file & mysql, \nthe fail-over works as documented.\n\n*** The error logs [debug level] shows nothing remarkable.\n\n*** macpro, os-x 10.5.5, apache 2.2.11, mysql 5.1.30\n\n*** LDAP -> MYSQL fail-over has not worked in any of the 2.2.xx builds.\n\nRegards,\nWilliam Paredes\nDept of Education\nAlbert Einstein College of Medicine", "id": 124373, "time": "2009-01-26T10:23:03Z", "bug_id": 46608, "creation_time": "2009-01-26T10:23:03Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "covener@gmail.com", "attachment_id": null, "id": 124379, "time": "2009-01-26T15:41:06Z", "bug_id": 46608, "creation_time": "2009-01-26T15:41:06Z", "is_private": false, "text": "If LDAP can map the username to a DN, and the password is wrong, it won't try another authentication module -- authentication fails.  Is this your scenario?"}, {"count": 2, "tags": [], "bug_id": 46608, "attachment_id": null, "text": "(In reply to comment #0)\nThat is correct! After a username is found but an unknown password is issued authentication is not passed on to the next module [in our case - mysql].\n\nRegards,\nWilliam Paredes\n\n", "id": 124392, "time": "2009-01-27T05:54:27Z", "creator": "paredes@aecom.yu.edu", "creation_time": "2009-01-27T05:54:27Z", "is_private": false}, {"count": 3, "tags": [], "creator": "covener@gmail.com", "text": "changing to documentation as this is working as designed.  A password mismatch does not trigger trying the next provider.\n\nAuthBasicProvider doc needs something like:\n\nWhen multiple AuthBasicProviders are specified, the providers are consulted in order until one provider finds the userid in its respective repository.  This provider performs the password check, and access is forbidden if the password is incorrect.\n\n", "id": 124407, "time": "2009-01-27T13:54:15Z", "bug_id": 46608, "creation_time": "2009-01-27T13:54:15Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 46608, "attachment_id": null, "text": "Moving docs bugs to docs@httpd.a.o ownership.", "id": 141206, "time": "2010-10-29T11:06:45Z", "creator": "rbowen@apache.org", "creation_time": "2010-10-29T11:06:45Z", "is_private": false}, {"count": 5, "tags": [], "creator": "poirier@pobox.com", "attachment_id": null, "id": 141266, "time": "2010-10-30T15:50:31Z", "bug_id": 46608, "creation_time": "2010-10-30T15:50:31Z", "is_private": false, "text": "Appears to be fixed in trunk."}]