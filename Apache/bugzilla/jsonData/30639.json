[{"count": 0, "tags": [], "bug_id": 30639, "text": "We're using ant to compile jsps on an NFS mounted Solaris box.\n\nAfter the jsps are compiled we delete the temporary directory the jsps are in\nand this fails because JspC still has a FD open for a jsp file. we've determined\nthis by running truss on ant.\n\nBelow is the output from truss:\n\n.\n.\n.\n12944/1:\topen(\"/home/chris/SOLARIS/tomcat/webapps/secure/invalidLogin.jsp\",\nO_RDONLY|O_LARGEFILE) = 6\n12944/1:\tfstat64(6, 0xFFBFC198)\t\t\t\t= 0\n12944/1:\tstat64(\"/home/chris/SOLARIS/tomcat/webapps/secure/invalidLogin.jsp\",\n0xFFBFC380) = 0\n12944/1:\tstat64(\"/home/chris/SOLARIS/tomcat/webapps/secure/invalidLogin.jsp\",\n0xFFBFC440) = 0\n12944/1:\tstat64(\"/home/chris/SOLARIS/tomcat/webapps/secure/invalidLogin.jsp\",\n0xFFBFC470) = 0\n12944/1:\tstat64(\"/home/chris/SOLARIS/secure/WEB-INF/src\", 0xFFBFC388) = 0\n12944/1:\tstat64(\"/home/chris/SOLARIS/secure/WEB-INF/src/org/apache/jsp/secure\",\n0xFFBFC2F8) = 0\n12944/1:\nstat64(\"/home/chris/SOLARIS/secure/WEB-INF/src/org/apache/jsp/secure/invalidLogin_jsp.java\",\n0xFFBFC5A8) Err#2 ENOENT\n12944/1:\tstat64(\"/home/chris/SOLARIS/secure/WEB-INF/src/org/apache/jsp/secure\",\n0xFFBFC358) = 0\n12944/8:\tpoll(0xFBD7FD80, 0, 50)\t\t\t\t= 0\n12944/1:\nopen(\"/home/chris/SOLARIS/secure/WEB-INF/src/org/apache/jsp/secure/invalidLogin_jsp.java\",\nO_WRONLY|O_CREAT|O_TRUNC|O_LARGEFILE, 0666) = 7\n12944/1:\tfstat64(7, 0xFFBFC3A8)\t\t\t\t= 0\n12944/1:\tstat64(\"/home/chris/SOLARIS/tomcat/webapps/secure/invalidLogin.jsp\",\n0xFFBFBE90) = 0\n12944/1:\topen(\"/home/chris/SOLARIS/tomcat/webapps/secure/invalidLogin.jsp\",\nO_RDONLY|O_LARGEFILE) = 8\n12944/1:\tfstat64(8, 0xFFBFBD40)\t\t\t\t= 0\n12944/1:\tread(8, \" < ! - -   $ I d :   i n\".., 2048)\t= 471\n12944/1:\tclose(8)\t\t\t\t\t= 0\n.\n.\n.\n\nFD 6 is never closed.\n\nSo when ant tries to delete the directory containing the jsp files our NFS\nserver renames invalidLogin.jsp to .nfs3509. This was verified by snoop.\n\nOnce ant exits the .nfs go away and the directory can be removed.", "id": 61922, "time": "2004-08-12T23:29:27Z", "creator": "Chris.Dennis@invidi.com", "creation_time": "2004-08-12T23:29:27Z", "is_private": false, "attachment_id": null}, {"count": 1, "text": "Created attachment 12411\ntruss output", "creator": "Chris.Dennis@invidi.com", "is_private": false, "id": 61923, "time": "2004-08-12T23:30:26Z", "bug_id": 30639, "creation_time": "2004-08-12T23:30:26Z", "tags": [], "attachment_id": 12411}, {"count": 2, "attachment_id": null, "creator": "kin-man.chung@sun.com", "is_private": false, "id": 61974, "time": "2004-08-13T23:47:10Z", "bug_id": 30639, "creation_time": "2004-08-13T23:47:10Z", "tags": [], "text": "I've tried serveral jspc compilations Solaris with truss on, and the truss ouput\nlooks OK to me, i.e. all jsp files are closed properly.  There maybe problems\nwith .jspx files, which I'll look into further, but that does not apply to your\ncase.\n\nIf you still have problems, please give me a concrete test cases, with specific\ninstructions to reproduce them.  Thanks.\n\n"}, {"count": 3, "tags": [], "bug_id": 30639, "attachment_id": null, "id": 61976, "time": "2004-08-14T00:03:20Z", "creator": "Chris.Dennis@invidi.com", "creation_time": "2004-08-14T00:03:20Z", "is_private": false, "text": "I tried 5.0.27 and it seems to work. If I still have problems I'll try and post\na test case."}]