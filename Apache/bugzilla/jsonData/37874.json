[{"count": 0, "tags": [], "text": "Summary:\n\nA flaw in the imagemap processing module, mod_imap, in versions of Apache httpd\n1.3, 2.0 and 2.2 can in some circumstances cause the referer header to be output\nwithout being escaped in HTML.  This could allow an attacker who is able to\ninfluence the referer header the ability to do cross-site scripting attacks\nagainst sites using mod_imap in a vulnerable configuration.\n\nImpact: \n\nmoderate (http://httpd.apache.org/security/impact_levels.html)\n\nMitigation:\n\nThis flaw only affects sites using mod_imap with a map file that contains the\n\"referer\" directive.\n\nIn order to exploit this flaw the attacker would need to control the  referer\nheader and therefore would need to entice a victim to visit a URL under the\nattackers control.\n\nA sucessful cross-site scripting attack using this flaw would be limited to\ncertain browsers.  Firefox and Mozilla browsers for example already escape\nsuspect characters in a URL which blocks this from being exploited.\n\nSolution:\n\nThe attached patch ensures that the referer header in mod_imap is escaped and\ntherefore cannot be used as part of a cross-site scripting attack.\n\nWhere this patch cannot be used, a temporary solution is to remove the \"referer\"\ndirective from any map files.\n\nVerification:\n\nI was able to verify this by constructing a victim site with a vulnerable\nmod_imap configuration and by constructing a set of scripts on the attacker\nsite.  When the attackers site was visited using the Internet Explorer browser\nit was able to steal the users private cookies from the victim site.\n\nTimeline:\n\n20051101 CERT notification of flaw to security@apache.org\n20051102 ASF verification of flaw\n20051103 Assigned CVE-2005-3352 with proposed patches\n20051104 Contacted CERT asking for co-ordinated release and reporter info\n20051114 No response from CERT, contacted them again suggesting 20051118\n20051114 CERT said they would contact reporter\n20051212 No further response from CERT or reporter, made public", "attachment_id": null, "id": 83558, "creator": "mjc@apache.org", "time": "2005-12-12T17:23:25Z", "bug_id": 37874, "creation_time": "2005-12-12T17:23:25Z", "is_private": false}, {"count": 1, "tags": [], "creator": "mjc@apache.org", "is_private": false, "id": 83559, "creation_time": "2005-12-12T17:24:42Z", "time": "2005-12-12T17:24:42Z", "bug_id": 37874, "text": "Created attachment 17199\nPatch for apache-1.3 tree (ack fielding, jorton)", "attachment_id": 17199}, {"count": 2, "attachment_id": 17200, "bug_id": 37874, "text": "Created attachment 17200\nPatch for apache-2.0 tree (ack fielding, jorton)", "id": 83560, "time": "2005-12-12T17:25:14Z", "creator": "mjc@apache.org", "creation_time": "2005-12-12T17:25:14Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "text": "VU#299838 JPCERT#94453446 JVN#06045169", "is_private": false, "id": 83561, "creator": "mjc@apache.org", "time": "2005-12-12T17:26:33Z", "bug_id": 37874, "creation_time": "2005-12-12T17:26:33Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "jorton@redhat.com", "attachment_id": null, "text": "The fixes for this were committed a while back:\n\nhttp://svn.apache.org/viewcvs?rev=357161&view=rev (trunk)\nhttp://svn.apache.org/viewcvs?rev=356291&view=rev (2.2.x)\nhttp://svn.apache.org/viewcvs?rev=356278&view=rev (1.3.x)\nhttp://svn.apache.org/viewcvs?rev=356279&view=rev (2.0.x)\n", "id": 87755, "time": "2006-04-11T13:29:13Z", "bug_id": 37874, "creation_time": "2006-04-11T13:29:13Z", "is_private": false}]