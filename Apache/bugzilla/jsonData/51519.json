[{"count": 0, "attachment_id": null, "bug_id": 51519, "text": "rPh is show pronunciation of the data text.\nIt is hidden data from user point of view and not accurate.\nSo, it is confusing the extraction include rPh elements.\n\nThis is a sample of sharedStrings.xml.\n\n<si>\n   <t>\u5f79\u5272</t>  <!-- role  in English --> \n   <rPh sb=\"0\" eb=\"2\">\n      <t>\u30e4\u30af\u30ef\u30ea</t> <!-- Japanese phonic symbol called Katakana of role --> \n   </rPh>\n   <phoneticPr fontId=\"1\" /> \n</si>", "id": 147952, "time": "2011-07-17T05:29:03Z", "creator": "lovelylovelyflora@ab.auone-net.jp", "creation_time": "2011-07-17T05:29:03Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 51519, "attachment_id": null, "id": 147958, "time": "2011-07-17T16:08:23Z", "creator": "apache@gagravarr.org", "creation_time": "2011-07-17T16:08:23Z", "is_private": false, "text": "Maybe we should make it an option? Some people may want that data for their indexing?"}, {"count": 2, "tags": [], "bug_id": 51519, "text": "Created attachment 28092\nExample files used to reproduce InvocationTargetException", "id": 152323, "time": "2011-12-20T16:51:32Z", "creator": "mdlandon@gmail.com", "creation_time": "2011-12-20T16:51:32Z", "is_private": false, "attachment_id": 28092}, {"count": 3, "tags": [], "text": "Sorry, my attachment was for Bug #51158.", "is_private": false, "bug_id": 51519, "id": 152324, "time": "2011-12-20T16:53:31Z", "creator": "mdlandon@gmail.com", "creation_time": "2011-12-20T16:53:31Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "christopher.brady@oracle.com", "attachment_id": 31165, "text": "Created attachment 31165\nExample file to reproduce issue\n\nThis file can be used to reproduce the issue. If you open the file using Excel and then load the file using Apache POI (streaming event model), you can see that extra characters are loaded that are not visible when opened in Excel. \n\nA good description of the purpose of these extra characters can be found at:\n\nhttp://www.localizingjapan.com/blog/2011/02/13/sorting-in-japanese-%E2%80%94-an-unsolved-problem/", "id": 171967, "time": "2013-12-30T22:19:11Z", "bug_id": 51519, "creation_time": "2013-12-30T22:19:11Z", "is_private": false}, {"count": 5, "tags": [], "creator": "shaun.kalley@shaw.ca", "attachment_id": null, "text": "I'm also confronted by this issue.  If we set a goal of having XSSFEventBasedExcel produce output that is at parity with XSSFExcelExtractor, then the phonetic text should not be included in the output.  I'm attaching a patch that achieves that goal.", "id": 172944, "time": "2014-02-07T21:24:48Z", "bug_id": 51519, "creation_time": "2014-02-07T21:24:48Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 51519, "text": "Created attachment 31295\nPatch to ReadOnlySharedStringsTable to address this issue", "id": 172946, "time": "2014-02-07T21:27:08Z", "creator": "shaun.kalley@shaw.ca", "creation_time": "2014-02-07T21:27:08Z", "is_private": false, "attachment_id": 31295}, {"count": 7, "tags": [], "creator": "000.jai@gmail.com", "attachment_id": null, "text": "the fix is not available in the version 3.12 and 3.13 beta. Will it be available in 3.13? Shall i patch it in my deployment if the license permits?", "id": 185483, "time": "2015-09-25T13:36:21Z", "bug_id": 51519, "creation_time": "2015-09-25T13:36:21Z", "is_private": false}, {"count": 8, "attachment_id": null, "bug_id": 51519, "is_private": false, "id": 185485, "time": "2015-09-25T15:55:40Z", "creator": "onealj@apache.org", "creation_time": "2015-09-25T15:55:40Z", "tags": [], "text": "You may be familiar with some or all of the following.\n\nTo increases your chances of having your patch accepted into trunk, include unit tests that show the changed behavior is correct (fails on old code, passes on patched code). This is especially important for new public functions.\n\nUnit tests are located in /trunk/src/testcases (Office97 and version-agnostic unit tests) and /trunk/ooxml/src/testcases (Office 2007+ only). If your code change affects both Office 97 and 2007, try to find the base test so you don't need to write your unit test twice.\nIf you haven't tested your changes, you'll need to install ant, then from the command line run \"ant clean test\". Build success indicates no problem. If the test fails, you'll need to look at the output junit test results in build/test-results and build/ooxml-test-results.\n\n\nWhen you want to signal to committers that your patch is tested and ready for inclusion, prepend [PATCH] to the bug title and add PatchAvailable to keywords.\n\n\nSet up build environment, including ant: https://poi.apache.org/howtobuild.html\nSubmitting patches: https://poi.apache.org/guidelines.html#SubmittingPatches\n\nPOI 3.13 release candidate was made a few days ago, but it's likely your changes with corresponding unit tests can make it into POI 3.14. I expect 3.14 will be released in about 6 months, though the date depends on the status of outstanding features come release time."}, {"attachment_id": null, "tags": [], "creator": "dspiegs@dspiegs.com", "text": "Has this been built into any release?", "count": 9, "id": 191097, "time": "2016-05-19T18:38:07Z", "bug_id": 51519, "creation_time": "2016-05-19T18:38:07Z", "is_private": false}, {"count": 10, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "text": "As the state is NEW and not \"RESOLVED FIXED\" it is most probably not fixed yet.", "id": 191111, "time": "2016-05-19T18:51:42Z", "bug_id": 51519, "creation_time": "2016-05-19T18:51:42Z", "is_private": false}, {"count": 11, "attachment_id": null, "bug_id": 51519, "text": "The patch from comment has not been applied because it is missing unit tests. As Nick mentioned in comment 1, for backwards compatibility, we need to make rPh elements optionally available to users.", "id": 191125, "time": "2016-05-20T03:01:54Z", "creator": "onealj@apache.org", "creation_time": "2016-05-20T03:01:54Z", "tags": [], "is_private": false}, {"attachment_id": null, "tags": [], "creator": "dominik.stadler@gmx.at", "text": "Setting to NEEDINFO to indicate that some proper unit-tests would be good to verify the changes also into the future.", "count": 12, "id": 192441, "time": "2016-07-17T09:32:58Z", "bug_id": 51519, "creation_time": "2016-07-17T09:32:58Z", "is_private": false}, {"count": 13, "attachment_id": null, "bug_id": 51519, "text": "*** Bug 60481 has been marked as a duplicate of this bug. ***", "id": 195498, "time": "2016-12-14T21:23:22Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-12-14T21:23:22Z", "tags": [], "is_private": false}, {"count": 14, "tags": [], "creator": "tallison@mitre.org", "text": "I think I'll take this one as prep for .xlsb unless there are objections.", "id": 197500, "time": "2017-03-07T13:53:31Z", "bug_id": 51519, "creation_time": "2017-03-07T13:53:31Z", "is_private": false, "attachment_id": null}, {"count": 15, "tags": [], "bug_id": 51519, "attachment_id": 34805, "id": 197503, "time": "2017-03-07T14:58:19Z", "creator": "tallison@mitre.org", "creation_time": "2017-03-07T14:58:19Z", "is_private": false, "text": "Created attachment 34805\nInitial patch\n\nAny objections to adding a XSSFSharedString object that includes both the actual text and the phonetic runs?"}, {"count": 16, "tags": [], "bug_id": 51519, "attachment_id": null, "id": 197538, "time": "2017-03-08T13:43:02Z", "creator": "tallison@mitre.org", "creation_time": "2017-03-08T13:43:02Z", "is_private": false, "text": "Went with a new method rather than a new class to decrease the API surface.\n\nUsers can get the regular string at index i, and they can request the phonetic string at index i.\n\nThank you for sharing a test file!\n\nr1785965"}, {"count": 17, "tags": [], "bug_id": 51519, "attachment_id": null, "id": 197543, "time": "2017-03-08T16:29:12Z", "creator": "tallison@mitre.org", "creation_time": "2017-03-08T16:29:12Z", "is_private": false, "text": "For the full extraction workflow, we should enable including phonetic runs in the initializer of ReadOnlySharedTables, with default to be the legacy behavior (true).  We should also allow the user to set whether or not to include phonetic runs in the XSSFEventBasedExcelExtractor."}, {"count": 18, "tags": [], "text": "r1786021", "is_private": false, "bug_id": 51519, "id": 197544, "time": "2017-03-08T16:45:00Z", "creator": "tallison@mitre.org", "creation_time": "2017-03-08T16:45:00Z", "attachment_id": null}]