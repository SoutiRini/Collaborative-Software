[{"count": 0, "tags": [], "text": "For jars where only some of the packages are sealed, the code to extract the \nAttributes from the Manifest for that package is incorrect. \n \nOne result of this is that if the JAR as a whole is sealed but a particular \npackage in that JAR is not, the unsealed package throws a sealing violation. \n \nThe fault is in the \norg.apache.cataline.loader.WebappClassLoader.isPackageSealed method. The \n\"name\" attribute passed is in the format \"org.blah.blah\", whereas the \nattributes in the Manifest are stored against the key \"org/blah/blah/\". \n \nThis is easy to fix. Replace the first few lines of the method with: \n \n   protected boolean isPackageSealed(String name, Manifest man) \n   { \n*       StringBuffer buf = new StringBuffer(name); \n*       for (int i=0;i<buf.length();i++) { \n*           if (buf.charAt(i)=='.') buf.setCharAt(i,'/'); \n*       } \n*       buf.append('/'); \n*       Attributes attr = man.getAttributes(buf.toString()); \n        String sealed = null; \n        ... and so on. \n \nThis is tested with 4.1.29 and works fine.", "attachment_id": null, "id": 51050, "creator": "mike-bugzilla@big.faceless.org", "time": "2004-01-23T12:55:12Z", "bug_id": 26375, "creation_time": "2004-01-23T12:55:12Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 26375, "text": "This has been fixed in TC4 and TC5. Many thanks for providing the patch.", "id": 60116, "time": "2004-07-03T18:52:22Z", "creator": "markt@apache.org", "creation_time": "2004-07-03T18:52:22Z", "is_private": false, "attachment_id": null}]