[{"count": 0, "tags": [], "text": "We need to unset environment variables from RewriteRules. Attached is a patch against -trunk to do this. Example:\n\nConfiguration:\n\nRewriteEngine on\nLogLevel rewrite:trace5\nRewriteRule ^ - [E=pling:plong]\nRewriteRule ^ - [E=foo:boo,E=!pling]\n\nTest:\n\n$ GET http://localhost:8000/cgi-bin/printenv | egrep '(foo|pling)'\nfoo=\"boo\"\n\nLog:\n\n[Mon Jun 28 16:44:43.364112 2010] [trace2] [pid 516:tid 1153177920] mod_rewrite.c(447): [client 127.0.0.1:44518] 127.0.0.1 - - [localhost/sid#d5c9af8][rid#d6f4680/initial] init rewrite engine with requested uri /cgi-bin/printenv\\n\n[Mon Jun 28 16:44:43.364157 2010] [trace3] [pid 516:tid 1153177920] mod_rewrite.c(447): [client 127.0.0.1:44518] 127.0.0.1 - - [localhost/sid#d5c9af8][rid#d6f4680/initial] applying pattern '^' to uri '/cgi-bin/printenv'\\n\n[Mon Jun 28 16:44:43.364177 2010] [trace5] [pid 516:tid 1153177920] mod_rewrite.c(447): [client 127.0.0.1:44518] 127.0.0.1 - - [localhost/sid#d5c9af8][rid#d6f4680/initial] setting env variable 'pling' to 'plong'\\n\n[Mon Jun 28 16:44:43.364187 2010] [trace3] [pid 516:tid 1153177920] mod_rewrite.c(447): [client 127.0.0.1:44518] 127.0.0.1 - - [localhost/sid#d5c9af8][rid#d6f4680/initial] applying pattern '^' to uri '/cgi-bin/printenv'\\n\n[Mon Jun 28 16:44:43.364197 2010] [trace5] [pid 516:tid 1153177920] mod_rewrite.c(447): [client 127.0.0.1:44518] 127.0.0.1 - - [localhost/sid#d5c9af8][rid#d6f4680/initial] setting env variable 'foo' to 'boo'\\n\n[Mon Jun 28 16:44:43.364207 2010] [trace5] [pid 516:tid 1153177920] mod_rewrite.c(447): [client 127.0.0.1:44518] 127.0.0.1 - - [localhost/sid#d5c9af8][rid#d6f4680/initial] unsetting env variable 'pling'\\n\n[Mon Jun 28 16:44:43.364216 2010] [trace1] [pid 516:tid 1153177920] mod_rewrite.c(447): [client 127.0.0.1:44518] 127.0.0.1 - - [localhost/sid#d5c9af8][rid#d6f4680/initial] pass through /cgi-bin/printenv\\n\n\nObviously this'll be a problem for anyone who is setting environment variables with names starting with !. Hopefully this is uncommon.", "is_private": false, "id": 137948, "creator": "mark@markdrayton.info", "time": "2010-06-28T11:53:57Z", "bug_id": 49512, "creation_time": "2010-06-28T11:53:57Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 49512, "attachment_id": 25648, "text": "Created attachment 25648\nUnset env vars from RewriteRule", "id": 137949, "time": "2010-06-28T11:56:20Z", "creator": "mark@markdrayton.info", "creation_time": "2010-06-28T11:56:20Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 49512, "attachment_id": 25649, "is_private": false, "id": 137950, "time": "2010-06-28T12:23:55Z", "creator": "mark@markdrayton.info", "creation_time": "2010-06-28T12:23:55Z", "text": "Created attachment 25649\nUnset env vars from RewriteRule\n\nNew patch -- previous was reversed."}, {"count": 3, "tags": [], "creator": "sf@sfritsch.de", "attachment_id": null, "id": 142988, "creation_time": "2010-12-29T15:42:27Z", "time": "2010-12-29T15:42:27Z", "bug_id": 49512, "text": "Commited with some tweaks to trunk in r1053726", "is_private": false}, {"count": 4, "tags": [], "bug_id": 49512, "attachment_id": null, "id": 154240, "time": "2012-02-26T17:06:57Z", "creator": "sf@sfritsch.de", "creation_time": "2012-02-26T17:06:57Z", "is_private": false, "text": "fixed in 2.4.1 and 2.2.20"}]