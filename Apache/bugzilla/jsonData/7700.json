[{"count": 0, "tags": [], "creator": "kare@kare.uklinux.net", "is_private": false, "text": "When tomcat executes HttpServletRequest.encodeURL(String) it appends query\narguments before the URI anchor element. \nfor example:\n/foo.do;jsessionid=xxxxxx#anchor?args=val\nit should be\n/foo.do;jsessionid=xxxxxxx?args=val#anchor\nReferenced patch also removes deprecated HttpUtils code and replaces it with\nother Servlet API functionality. Patch also removes unnecessary imports and\ncleans up the code a bit.\nhttp://www.kare.uklinux.net/pub/tomcat-HttpResponseBase.patch\n\nCheers,\nkare@kare.uklinux.net", "id": 12722, "time": "2002-04-03T01:05:14Z", "bug_id": 7700, "creation_time": "2002-04-03T01:05:14Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "Same patch seems to be applicable for org.apache.coyote.tomcat4.CoyoteResponse.\n\nCheers,\nkare@kare.uklinux.net", "attachment_id": null, "bug_id": 7700, "id": 12724, "time": "2002-04-03T01:31:52Z", "creator": "kare@kare.uklinux.net", "creation_time": "2002-04-03T01:31:52Z", "is_private": false}, {"count": 2, "tags": [], "creator": "william.barker@wilshire.com", "attachment_id": null, "is_private": false, "id": 12726, "time": "2002-04-03T05:34:36Z", "bug_id": 7700, "creation_time": "2002-04-03T05:34:36Z", "text": "/foo.do;jsessionid=xxxxxx#anchor?args=val\nis correct.\n/foo.do;jsessionid=xxxxxxx?args=val#anchor\nmakes no sense at all."}, {"count": 3, "attachment_id": null, "creator": "kare@kare.uklinux.net", "is_private": false, "id": 12748, "time": "2002-04-03T13:53:56Z", "bug_id": 7700, "creation_time": "2002-04-03T13:53:56Z", "tags": [], "text": "According to RFC2396 (URI) it is broken and it doesn't currently work with\nMozilla 0.9.4 (Linux) and with WAP devices. However, with the patch applied, it\nworks with Mozilla/Linux combination.\nOr is my interpretation of RFC wrong?\n\nCheers,\nkare@kare.uklinux.net"}, {"count": 4, "attachment_id": null, "creator": "kare@kare.uklinux.net", "text": "An example for those who still are suspicious\n\nhttp://jakarta.apache.org/site/news.html#0322.1\n\nhttp://jakarta.apache.org/site/news.html?foo=bar#0322.1\n\n! http://jakarta.apache.org/site/news.html#0322.1?foo=bar", "id": 12761, "time": "2002-04-03T15:08:33Z", "bug_id": 7700, "creation_time": "2002-04-03T15:08:33Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "text": "It has nothing to do with the RFC.  Tomcat is simply putting the bits back on \nin the same order that it took them off.  If they are coming out in the wrong \norder, then they came in in the wrong order.\n\n", "attachment_id": null, "bug_id": 7700, "id": 12782, "time": "2002-04-03T20:19:23Z", "creator": "william.barker@wilshire.com", "creation_time": "2002-04-03T20:19:23Z", "is_private": false}, {"count": 6, "tags": [], "text": "Maybe my summary is a bit misleading, but I think there is something wrong\nwith the implementation of HttpServletResponse.encodeURL(String) method.\n\nCopy/Paste from o.a.c.connector.HttpResponseBase.toEncoded(String,String)\n        sb.append(anchor);\n        sb.append(query);\n        return (sb.toString());\nIt appends the anchor before query string, which is against the RFC. This is\nwhat the referenced patch fixes (among other things). It also affects\nencodeRedirectURL method HttpServletResponse as both methods in both\nimplementations use the toEncoded method.\n\nSame problems are introduced in the Coyote implementation of\nHttpServletResponse \nCheers,\nkare@kare.uklinux.net", "is_private": false, "bug_id": 7700, "id": 12831, "time": "2002-04-04T22:07:23Z", "creator": "kare@kare.uklinux.net", "creation_time": "2002-04-04T22:07:23Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 7700, "attachment_id": null, "id": 12876, "time": "2002-04-05T18:06:51Z", "creator": "Larry.Isaacs@sas.com", "creation_time": "2002-04-05T18:06:51Z", "is_private": false, "text": "To elaborate on Bill's point.  If the anchor correctly follows the query,\nthen the anchor travels to the rewritten URL via the query.  No anchor will\nbe detected because is was removed as part of the query.  Only if there\nis no query will an achor be detected.  Thus the order doesn't matter except\nthat the current code recreates the same order in the original URL.  This means\nthat if someone incorrectly put the anchor in front of the query string, it\nwill still be in front of the query string in the rewritten URL.  I agree\nwith Bill that this is preferable to \"fixing\" the URL."}, {"count": 8, "tags": [], "text": "*** Bug 7771 has been marked as a duplicate of this bug. ***", "is_private": false, "bug_id": 7700, "id": 12879, "time": "2002-04-05T18:41:17Z", "creator": "remm@apache.org", "creation_time": "2002-04-05T18:41:17Z", "attachment_id": null}]