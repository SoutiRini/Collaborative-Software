[{"count": 0, "tags": [], "creator": "nick.giles@ontology.com", "attachment_id": null, "id": 124771, "time": "2009-02-11T01:35:09Z", "bug_id": 46692, "creation_time": "2009-02-11T01:35:09Z", "is_private": false, "text": "It appears that the result of boolean formulae is being inverted when calculated. The following test case currently fails:\n\n    public void testBooleanFunctions() {\n        HSSFWorkbook workbook = new HSSFWorkbook();\n        HSSFSheet sheet = workbook.createSheet(\"test\");\n        HSSFRow row = sheet.createRow(0);\n\n        HSSFFormulaEvaluator evaluator = new HSSFFormulaEvaluator(workbook);\n\n        HSSFCell cell = row.createCell(0);\n\n        cell.setCellFormula(\"AND(TRUE,TRUE)\");\n        evaluator.evaluateFormulaCell(cell);\n        assertEquals(\"Should get correct boolean value\", true, cell.getBooleanCellValue());\n\n        cell = row.createCell(1);\n        cell.setCellFormula(\"AND(TRUE,FALSE)\");\n        evaluator.evaluateFormulaCell(cell);\n        assertEquals(\"Should get correct boolean value\", false, cell.getBooleanCellValue());\n\n    }\n\nIt appears there is a mismatch in org.apache.poi.hssf.record.FormulaRecord.SpecialCachedValue between the logic of createCachedBoolean and getBooleanValue\n\npublic static SpecialCachedValue createCachedBoolean(boolean b) {\n  return create(BOOLEAN, b ? 0 : 1);\n}\n\npublic boolean getBooleanValue() {\n ...\n return getDataValue() != 0;\n}"}, {"count": 1, "tags": [], "text": "Thanks for the detailed bug report.  This typo was spotted during the work on bug 46479 , and fixed in svn r731715 .  There were a few extra bugs found and fixed at the same time.  Junits were added for all fixed bugs but only the original bug is described in the bugzilla record. The bug you describe here (inverted conditinal operator) is identified by this junit:\nTestFormulaRecord.testCachedValue_bug46479().\n\n\nThis fix made it into the recent release, 3.5-beta5.\n", "attachment_id": null, "id": 124779, "creation_time": "2009-02-11T10:20:12Z", "time": "2009-02-11T10:20:12Z", "creator": "josh@apache.org", "bug_id": 46692, "is_private": false}]