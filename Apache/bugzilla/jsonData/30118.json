[{"count": 0, "tags": [], "creator": "montesa@unizar.es", "attachment_id": null, "id": 60634, "time": "2004-07-15T11:47:19Z", "bug_id": 30118, "creation_time": "2004-07-15T11:47:19Z", "is_private": false, "text": "I'm using mod_rewrite to pass jsp/servlet/html files from Apache to Tomcat, but \nno others files like php, css, js,... Apache y Tomcat servers are in diferent \nmachines.\n\nMy httpd.conf (\"machine:80\" is apache server and \"othermachine:8080\" is tomcat \nserver):\n\nPort 80\nServerName machine\nDirectoryIndex index.html index.php\n\nRewriteEngine on\nRewriteLog /etc/httpd/logs/rewrite_log\nRewriteLogLevel 2\nRewriteRule ^/(.+)\\.jsp$ http://othermachine:8080/$1.jsp [P,L]\nRewriteRule ^/(.*)servlet/(.+)$ http://othermachine:8080/$1servlet/$2 [P,L]\nRewriteRule ^/(.+)\\.(html|htm)$ http://othermachine:8080/$1.$2 [P,L]\n\nIn Apache 1.3.29, when I run \"http://machine\" (without index.html) works OK!!!\n\nThe rewrite_log file:\n\n[rid#2188628/initial] (2) init rewrite engine with requested uri /\n[rid#2188628/initial] (1) pass through /\n[rid#218a640/subreq] (2) init rewrite engine with requested uri /index.html\n[rid#218a640/subreq] (1) pass through /index.html\n[rid#2189b80/initial/redir#1] (2) init rewrite engine with requested \nuri /index.html\n[rid#2189b80/initial/redir#1] (2) rewrite /index.html -> \nhttp://othermachine:8080/index.html\n[rid#2189b80/initial/redir#1] (2) forcing proxy-throughput with \nhttp://othermachine:8080/index.html\n[rid#2189b80/initial/redir#1] (1) go-ahead with proxy request \nproxy:http://othermachine:8080/index.html [OK]\n[rid#21936b0/initial] (2) init rewrite engine with requested \nuri /noticia/xml/A00.xml\n[rid#21936b0/initial] (1) pass through /noticia/xml/A00.xml\n....\n\nBut, in Apache 2.0.50 (with the same httpd.conf), when I run \"http://machine\" \n(without index.html) dont works!!!\n\nThe rewrite_log file:\n\n[rid#a99540/initial] (2) init rewrite engine with requested uri /\n[rid#a99540/initial] (1) pass through /\n[rid#a9b5c8/subreq] (2) init rewrite engine with requested uri /index.html\n[rid#a9b5c8/subreq] (1) pass through /index.html\n[rid#a9d5d0/initial] (2) init rewrite engine with requested \nuri /img/bienvenido.gif\n[rid#a9d5d0/initial] (1) pass through /img/bienvenido.gif\n....\n\nThen default index.html (DirectoryIndex) no pass to Tomcat :-(\n\nWhy? Its works fine in Apache 1.3.29!!!\n\nThanks in advance!!!"}, {"count": 1, "text": "Looks like I have problems with the same bug. I used the following\nrewrite on apache 1.3:\n\nRewriteCond %{HTTP_ACCEPT} application/xhtml\\+xml\nRewriteCond %{REQUEST_URI} \\.html$\nRewriteCond %{THE_REQUEST} HTTP/1\\.1\nRewriteRule .* - \"[T=application/xhtml+xml; charset=iso-8859-1]\"\n\nthis should change the mediatype of .html-files to application/xhtml+xml\nif browser says that it supports application/xhtml+xml. This rewrite\nworked just fine on apache 1.3 but now on apache 2.0.50 I have\nproblems with indexes.\n\nIf I request for:\n\nhttp://appro.mit.jyu.fi/2004/syksy/www/\n\nI get text/html\n\nbut if I try:\n\nhttp://appro.mit.jyu.fi/2004/syksy/www/index.html\n\nI get application/xhtml+xml\n\nThis looks like a real bug.", "bug_id": 30118, "attachment_id": null, "id": 62584, "time": "2004-08-27T13:45:26Z", "creator": "tjlahton@mit.jyu.fi", "creation_time": "2004-08-27T13:45:26Z", "tags": [], "is_private": false}, {"count": 2, "text": "After a few debug, and comment out this line in mod_rewrite\n         if (r->main != NULL &&\n             (p->flags & RULEFLAG_IGNOREONSUBREQ ||\n-             p->flags & RULEFLAG_PROXY          ||\n              p->flags & RULEFLAG_FORCEREDIRECT    )) {\nAnd enable rewrite_log, I'v find\nit's send it to mod_proxy, but mod_proxy refuse to deal with it, will debug \ntomorrow.\nthe log is\n61.51.104.223 - - [23/Dec/2004:01:18:39 +0800] [www.panda123.cn/sid#8154230]\n[rid#81af140/subreq] (2) init rewrite engine with requested uri /index.php\n61.51.104.223 - - [23/Dec/2004:01:18:39 +0800] [www.panda123.cn/sid#8154230]\n[rid#81af140/subreq] (2) rewrite /index.php -> \nhttp://www.panda123.cn:8080/index.php\n61.51.104.223 - - [23/Dec/2004:01:18:39 +0800] [www.panda123.cn/sid#8154230]\n[rid#81af140/subreq] (1) go-ahead with proxy request \nproxy:http://www.panda123.cn:8080/index.php [OK]\n\nthe worked request is\n\n61.51.104.223 - - [23/Dec/2004:00:32:20 +0800] [www.panda123.cn/sid#8154230]\n[rid#81ab130/initial] (2) init rewrite engine with requested uri /index.php\n61.51.104.223 - - [23/Dec/2004:00:32:20 +0800] [www.panda123.cn/sid#8154230]\n[rid#81ab130/initial] (2) rewrite /index.php -> \nhttp://www.panda123.cn:8080/index.php\n61.51.104.223 - - [23/Dec/2004:00:32:20 +0800] [www.panda123.cn/sid#8154230]\n[rid#81ab130/initial] (2) forcing proxy-throughput with \nhttp://www.panda123.cn:8080/index.php\n61.51.104.223 - - [23/Dec/2004:00:32:20 +0800] [www.panda123.cn/sid#8154230]\n[rid#81ab130/initial] (1) go-ahead with proxy request \nproxy:http://www.panda123.cn:8080/index.php [OK]\n", "bug_id": 30118, "is_private": false, "id": 68810, "time": "2004-12-22T18:38:04Z", "creator": "bash99@163.com", "creation_time": "2004-12-22T18:38:04Z", "tags": [], "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 30118, "attachment_id": null, "id": 68814, "time": "2004-12-22T18:48:34Z", "creator": "nd@perlig.de", "creation_time": "2004-12-22T18:48:34Z", "is_private": false, "text": "The problem is another one (with DirectoryIndex itself). Anyway, the proxy issue\nwas already addressed in 2.1."}, {"attachment_id": null, "tags": [], "creator": "bash99@163.com", "text": "(In reply to comment #3)\n> The problem is another one (with DirectoryIndex itself). Anyway, the proxy \nissue\n> was already addressed in 2.1.\n\nWill it be backport to 2.0.x?\n2.0.52 and newest snapshot(httpd-2.0.x_20041222115406.tar.gz)\nstill have this problem.\n\nOr Does 2.1 is stable enough to use in a static/cgi/mod_proxy/rewrite\nonly site?", "count": 4, "id": 68888, "time": "2004-12-23T05:59:27Z", "bug_id": 30118, "creation_time": "2004-12-23T05:59:27Z", "is_private": false}]