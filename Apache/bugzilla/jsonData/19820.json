[{"count": 0, "tags": [], "bug_id": 19820, "attachment_id": null, "is_private": false, "id": 37020, "time": "2003-05-10T10:42:40Z", "creator": "timothy.arnold@becta.org.uk", "creation_time": "2003-05-10T10:42:40Z", "text": "When trying to authenticate using mod_auth_ldap in Apache 2.0.45 it causes the \nchild pid to die and returns a signal bus error (10) in the error_log\n\n[Fri May 09 15:57:54 2003] [notice] child pid 1402 exit signal Bus error (10)\n[Fri May 09 15:57:54 2003] [notice] child pid 1401 exit signal Bus error (10)\n\nFor informational purposes, the build process was as follows:\n\n1. Installed Solaris 8 and added recommended patch cluster (v.19)\n2. Built BerkeleyDB 4.1.25 using the following commands\n\n$ cd db-4.1.25/build_unix\n$ ../dist/configure\n$ make\n$ make install\n\n3. I then built openldap 2.1.17\n$ cd openldap-2.1.17\n$ CPPFLAGS=\"-I/usr/local/BerkeleyDB.4.1/include\" LDFALGS=\"-\nL/usr/local/BerkeleyDB.4.1/lib\" ./configure --prefix=/usr/local/openldap-2.1.17\n$ make\n$ make install\n\n4. I built apache_2.0.45 using the following configure commands:\n\n./configure \\\n--prefix=/usr/local/apache_2.0.45 \\\n--with-mpm=worker \\\n--enable-dav=static \\\n--enable-dav_fs=static \\\n--with-ldap=yes \\\n--with-ldap-include=/usr/local/openldap-2.1.17/include \\\n--with-ldap-lib=/usr/local/openldap-2.1.17/lib \\\n--enable-ldap=static \\\n--enable-auth_ldap=static \\\n\nOnce I have successfully built apache, I use the following virtual host:\n\n<VirtualHost *:8080>\n        ServerAdmin admin@ngfl.gov.uk\n        DocumentRoot /usr/local/apache/htdocs\n        ServerName testserver.mydomain.com\n\n                \n        <Directory /usr/local/apache/htdocs>\n\n        Options FollowSymLinks Indexes\n        AuthName \"test mendeleev\"\n        AuthType Basic\n        \n        AuthLDAPEnabled On\n        AuthLDAPURL ldap://doesntexist.ngfl.gov.uk/o=ngfl?uid?one\n        AuthLDAPAuthoritative On\n\n        require valid-user\n        </Directory>\n</VirtualHost>\n\n\nWhen I try to access the page, it will display the standard login box and when \ni enter in any details it will return the signal bus error.\n\nI have tried the above on Redhat Linux 9 and it works fine. It would appear to \nbe a problem in Solaris 8.\n\nI am more than willing to run debug if someone can tell me how (im not a \ndeveloper!)\n\nThanks,\nTim."}, {"count": 1, "tags": [], "creator": "trawick@apache.org", "attachment_id": null, "id": 37021, "time": "2003-05-10T12:27:12Z", "bug_id": 19820, "creation_time": "2003-05-10T12:27:12Z", "is_private": false, "text": "Can you get a coredump and backtrace?\n\nAssuming you're starting Apache as root, here is the normal mumbo-jumbo on Solaris:\n1) use Apache CoredumpDirectory directive to point to directory that web user id\ncan write to\n2) use Solaris coreadm command to allow setuid programs to write coredumps\n3) recreate problem, then use Solaris pstack command against coredump to get\nbacktraces, then post the backtraces to the PR\n\nThanks!"}, {"count": 2, "tags": [], "bug_id": 19820, "attachment_id": null, "is_private": false, "id": 37052, "time": "2003-05-12T08:27:47Z", "creator": "timothy.arnold@becta.org.uk", "creation_time": "2003-05-12T08:27:47Z", "text": "Hi,\n\nHere is the backtrace you have requested. The process ID 1780 matches the signal bus \nerror reported in the apache logs.\n\nhth\nTim.\n\ncore 'core' of 1780:\t/usr/local/apache_2.0.45/bin/httpd -k start\n-----------------  lwp# 4 / thread# 6  --------------------\n 0002a384 util_ald_create_cache (bd400, 29cc0, 29cd4, 29a70, 29b80, fe8058d4) + \n180\n 0002a894 util_ald_create_caches (c9840, 1577f8, 11e398, fef20398, 11e368, bb000) + \n28\n 00029318 util_ldap_cache_checkuserid (0, 11e2d8, 1, 157840, 0, 157848) + 468\n 0002b2c8 mod_auth_ldap_check_user_id (fe805a34, 8f800, ffffdfe8, 2, 1, 159e60) + \n190\n 0008353c ap_process_request_internal (19c4e8, 0, ffffffff, fee70020, fee70020, 0) + 340\n 00039b48 ap_process_request (19c4e8, b9800, 4, 19c4e8, 1905f0, a1f28) + e0\n 00034bc0 ap_process_http_connection (190598, 15a118, bafb0, 1, 34ac8, 1) + f8\n 0007791c ap_process_connection (190598, 0, 1904b8, 1, 190590, 15db68) + f0\n 0006ab70 worker_thread (190598, 1, bb400, bb400, ba000, bb400) + 228\n ff2542d0 dummy_worker (11fe10, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (11fe10, 0, 0, 0, 0, 0) + 40\n-----------------  lwp# 1 / thread# 1  --------------------\n ff01e52c _read    (1, 69cb4, 0, fef1e000, 69c00, 110c65) + c\n 00069490 child_main (b8800, 69064, fef1ef98, 0, 0, fef1efb8) + 3a4\n 0006859c make_child (0, 0, 6, fee70020, 0, 0) + 84\n 0006800c ap_mpm_run (b8800, 103a50, bb400, c8518, 7c, 1c8) + 424\n 00070ce0 main     (c39d0, c5958, ffbefa0c, bb060, 0, 0) + 878\n 00027708 _start   (0, 0, 0, 0, 0, 0) + 5c\n-----------------  lwp# 2 / thread# 2  --------------------\n ff01ea6c _signotifywait (fef1e000, ff245ec0, ffbef6ec, 8e5fc04, 0, ff3e7d60) + 8\n fef02030 thr_yield (0, 0, 0, 0, 0, 0) + 8c\n-----------------  lwp# 3 / thread# 30  --------------------\n ff01bd40 _so_accept (fc407bec, c3d40, 18e408, 0, 11fd10, 11000) + 8\n 00086ec4 unixd_accept (fc407c64, c3cd8, 18e408, 7ffffffe, 0, b8c00) + 10\n 0006a3c8 listener_thread (c3cd8, 0, 4c00, 86eb4, 0, bb400) + 16c\n ff2542d0 dummy_worker (120110, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (120110, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 3  --------------------\n feefddbc _reap_wait (fef229e0, 20520, 0, fef1e000, 0, 0) + 38\n feefdb14 _reaper  (fef1ee30, fef24740, fef229e0, fef1ee08, 1, fe401000) + 38\n fef0b728 _thread_start (0, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 4  --------------------\n fef0b6e0 _restorefsr (11fb10, 0, 0, 0, 0, 0) + 8\n--------------------------  thread# 5  --------------------\n feef826c cond_wait (fe909d70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, fee70020, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fe909c8c, fe909c88, 0, 18e518, 15bb60) + a0\n 0006aa18 worker_thread (b8800, 0, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (11fdf0, feee5d10, 1, fef2ad8c, 0, 2) + c\n fef0b728 _thread_start (11fdf0, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 7  --------------------\n feef826c cond_wait (fe705d70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fe705c8c, fe705c88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, 2, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (11fe30, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (11fe30, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 8  --------------------\n feef826c cond_wait (fe603d70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fe603c8c, fe603c88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, 3, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (11fe50, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (11fe50, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 9  --------------------\n feef826c cond_wait (fe501d70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fe501c8c, fe501c88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, 4, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (11fe70, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (11fe70, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 10  --------------------\n feef826c cond_wait (fe00fd70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fe00fc8c, fe00fc88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, 5, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (11fe90, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (11fe90, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 11  --------------------\n feef826c cond_wait (fdf0dd70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fdf0dc8c, fdf0dc88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, 6, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (11feb0, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (11feb0, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 12  --------------------\n feef826c cond_wait (fde0bd70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fde0bc8c, fde0bc88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, 7, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (11fed0, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (11fed0, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 13  --------------------\n feef826c cond_wait (fdd09d70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fdd09c8c, fdd09c88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, 8, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (11fef0, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (11fef0, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 14  --------------------\n feef826c cond_wait (fdc07d70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fdc07c8c, fdc07c88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, 9, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (11ff10, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (11ff10, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 15  --------------------\n feef826c cond_wait (fdb05d70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fdb05c8c, fdb05c88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, a, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (11ff30, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (11ff30, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 16  --------------------\n feef826c cond_wait (fda03d70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fda03c8c, fda03c88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, b, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (11ff50, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (11ff50, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 17  --------------------\n feef826c cond_wait (fd901d70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fd901c8c, fd901c88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, c, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (11ff70, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (11ff70, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 18  --------------------\n feef826c cond_wait (fd40fd70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fd40fc8c, fd40fc88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, d, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (11ff90, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (11ff90, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 19  --------------------\n feef826c cond_wait (fd30dd70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fd30dc8c, fd30dc88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, e, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (11ffb0, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (11ffb0, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 20  --------------------\n feef826c cond_wait (fd20bd70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fd20bc8c, fd20bc88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, f, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (11ffd0, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (11ffd0, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 21  --------------------\n feef826c cond_wait (fd109d70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fd109c8c, fd109c88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, 10, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (11fff0, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (11fff0, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 22  --------------------\n feef826c cond_wait (fd007d70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fd007c8c, fd007c88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, 11, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (120010, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (120010, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 23  --------------------\n feef826c cond_wait (fcf05d70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fcf05c8c, fcf05c88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, 12, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (120030, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (120030, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 24  --------------------\n feef826c cond_wait (fce03d70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fce03c8c, fce03c88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, 13, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (120050, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (120050, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 25  --------------------\n feef826c cond_wait (fcd01d70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fcd01c8c, fcd01c88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, 14, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (120070, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (120070, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 26  --------------------\n feef826c cond_wait (fc80fd70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fc80fc8c, fc80fc88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, 15, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (120090, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (120090, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 27  --------------------\n feef826c cond_wait (fc70dd70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fc70dc8c, fc70dc88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, 16, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (1200b0, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (1200b0, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 28  --------------------\n feef826c cond_wait (fc60bd70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fc60bc8c, fc60bc88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, 17, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (1200d0, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (1200d0, 0, 0, 0, 0, 0) + 40\n--------------------------  thread# 29  --------------------\n feef826c cond_wait (fc509d70, 0, 0, fef1e000, 0, 11fb50) + 13c\n feef8110 pthread_cond_wait (11fb90, 11fb50, 0, 11fb50, 0, 0) + 8\n 0006adb4 ap_queue_pop (11fb30, fc509c8c, fc509c88, 0, 0, 0) + a0\n 0006aa18 worker_thread (b8800, 18, bb400, bb400, ba000, bb400) + d0\n ff2542d0 dummy_worker (1200f0, feee5d10, 0, 5, 1, fe401000) + c\n fef0b728 _thread_start (1200f0, 0, 0, 0, 0, 0) + 40\n"}, {"count": 3, "text": "I have tested the same server configuration and it returns the same on Solaris \n9. I have successfully built and used the same configuration on Redhat Linux v9 \nand works fine.", "bug_id": 19820, "attachment_id": null, "id": 37175, "time": "2003-05-14T12:35:55Z", "creator": "timothy.arnold@becta.org.uk", "creation_time": "2003-05-14T12:35:55Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 19820, "attachment_id": null, "text": "util_ldap_cache_mgr.c is buggy:\n\nreturn (void *)apr_rmm_addr_get(util_ldap_rmm, apr_rmm_calloc(util_ldap_rmm, size));\n\nneeds to check for apr_rmm_calloc returning 0 when the shm segment is full,\nlikewise in the _strdup case.  The LDAP caching code is likely to die horribly\nonce the cache fills up.\n", "id": 37331, "time": "2003-05-16T15:28:54Z", "creator": "joe@manyfish.co.uk", "creation_time": "2003-05-16T15:28:54Z", "is_private": false}, {"count": 5, "tags": [], "creator": "erik@codefaktor.de", "attachment_id": null, "id": 37351, "time": "2003-05-16T17:59:38Z", "bug_id": 19820, "creation_time": "2003-05-16T17:59:38Z", "is_private": false, "text": "\n\n*** This bug has been marked as a duplicate of 18756 ***"}]