[{"count": 0, "tags": [], "creator": "josh@apache.org", "text": "There are probably many bugs here.\n\n\nOne bug is when the formulas involve references: Example of how to reproduce: create a spreadsheet with a data validation: (Allow=\"Decimal\", Data=\"between\", Minimum=\"=B1\", Maximum=\"=C1\").  POI *seems* to read the spreadsheet OK, but crashes while trying to re-serialise this spreadsheet.\n\nThe attachment from bug 44710 won't re-open in Excel after being re-serialised by POI. (https://issues.apache.org/bugzilla/attachment.cgi?id=21739)\n\nThe sample file referred to by TestBugs.test44593() (i.e. 44593.xls) also causes Excel to report errors/data loss after being re-written by POI.\n\n\nSome DATAVALIDATION encoding errors cause Excel(2007) to crash completely.", "id": 115213, "attachment_id": null, "bug_id": 44735, "creation_time": "2008-04-01T16:49:06Z", "time": "2008-04-01T16:49:06Z", "is_private": false}, {"count": 1, "tags": [], "text": "Could you please re-test with POI 3.1 FINAL, and let us know if the problem is now fixed? There have been some improvements in this area", "is_private": false, "id": 118515, "creator": "apache@gagravarr.org", "time": "2008-07-10T15:53:17Z", "bug_id": 44735, "creation_time": "2008-07-10T15:53:17Z", "attachment_id": null}, {"count": 2, "tags": [], "text": "Retested OK with POI 3.6\n\nThere seems to have been two bugs that needed fixing.\n\nThe first bug fix was with bug 44792 (svn r646666).  This error was observable the with file from bug 44710 (attachment id=21739) - Failure during re-reading of CRNRecord:\n\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\t...\nCaused by: java.lang.ArrayIndexOutOfBoundsException\n\tat org.apache.poi.hssf.record.RecordInputStream.checkRecordPosition(RecordInputStream.java:132)\n\tat org.apache.poi.hssf.record.RecordInputStream.readByte(RecordInputStream.java:140)\n\tat org.apache.poi.hssf.record.constant.ConstantValueParser.readAConstantValue(ConstantValueParser.java:58)\n\tat org.apache.poi.hssf.record.constant.ConstantValueParser.parse(ConstantValueParser.java:52)\n\tat org.apache.poi.hssf.record.CRNRecord.fillFields(CRNRecord.java:62)\n\tat org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n\tat org.apache.poi.hssf.record.CRNRecord.<init>(CRNRecord.java:43)\n\t...\n\n\n\nThe second bug was fixed with bug 44921 (svn r652934 + svn r652936).  This was observable with an example file produced as described - POI failed to serialize the DVRecord:\njava.lang.RuntimeException: Coding Error: This method should never be called. This ptg should be converted\n\tat org.apache.poi.hssf.record.formula.RefNVPtg.writeBytes(RefNVPtg.java:50)\n\tat org.apache.poi.hssf.record.DVRecord.serialize(DVRecord.java:462)\n\tat org.apache.poi.hssf.model.Sheet.serialize(Sheet.java:830)", "is_private": false, "bug_id": 44735, "id": 133254, "time": "2009-12-31T12:36:58Z", "creator": "josh@apache.org", "creation_time": "2009-12-31T12:36:58Z", "attachment_id": null}]