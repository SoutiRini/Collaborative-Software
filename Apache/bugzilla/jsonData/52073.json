[{"count": 0, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "text": "Related to 51919.\nCurrently for each download of resources, HttpSamplerBase will create a pool of Threads, do download and shutdown pool.\nThis results in lots of costly creations/destruction of Threads.\nIt would be better to create Pool once for Thread Group and make Samplers reuse it (as proposed by sebb)", "id": 150867, "time": "2011-10-23T21:02:59Z", "bug_id": 52073, "creation_time": "2011-10-23T21:02:59Z", "is_private": false, "attachment_id": null}, {"attachment_id": 31959, "tags": [], "bug_id": 52073, "is_private": false, "count": 1, "id": 177499, "time": "2014-09-01T19:15:32Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2014-09-01T19:15:32Z", "text": "Created attachment 31959\nBROKEN PATCH to illustrate dev list discussion"}, {"count": 2, "tags": [], "bug_id": 52073, "attachment_id": null, "text": "PR https://github.com/apache/jmeter/pull/132\n\nPlease test and review carefully\n\nA shared thread pool is used for all the parallel downloads.\nA throttle mechanism is used per user to ensure the max concurrent\ndownloads setting is not exceeded.\nA new parameter httpsampler.parallel_download_thread_keepalive_inseconds\nis used to set the thread TTL when idle (default 60s).\nthe parameter httpsampler.await_termination_timeout is not used anymore\nand has been removed.\n\nTODO : ResourcesDownloader#shrink should be called at the end of a test\nto accelerate the release of the thread pool idle threads (not\nmandatory)", "id": 188614, "time": "2016-02-19T16:05:10Z", "creator": "benoit.wiart@gmail.com", "creation_time": "2016-02-19T16:05:10Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 52073, "is_private": false, "count": 3, "id": 188647, "time": "2016-02-21T19:54:51Z", "creator": "benoit.wiart@gmail.com", "creation_time": "2016-02-21T19:54:51Z", "text": "I've closed the PR as it's hard to have both Bug 59034 and this one.\nI will retry after the jmeter 3.0 release"}, {"attachment_id": 33580, "tags": [], "bug_id": 52073, "text": "Created attachment 33580\npatch\n\nattach the pr 132 as patch", "count": 4, "id": 188648, "time": "2016-02-21T19:57:52Z", "creator": "benoit.wiart@gmail.com", "creation_time": "2016-02-21T19:57:52Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 52073, "text": "PR https://github.com/apache/jmeter/pull/155\n\nBack dans les bacs \u00e0 chaque attaque, contact !\n\nnew version of the PR which should play nicely with Bug 59034.\nthe cache manager is now correctly shared between the threads of a given user.\n\nDescription :\n\nEmbedded Resources concurrent download : Improve performances\nby avoiding shutdown of ThreadPoolExecutor at each sample.\n\nA shared thread pool is used for all the parallel downloads.\nA throttle mechanism is used per user to ensure the max concurrent\ndownloads setting is not exceeded.\nA new parameter httpsampler.parallel_download_thread_keepalive_inseconds\nis used to set the thread TTL when idle (default 60s).\nthe parameter httpsampler.await_termination_timeout is not used anymore\nand has been removed.\n\nTODO : ResourcesDownloader#shrink should be called at the end of a test\nto accelerate the release of the thread pool idle threads (not\nmandatory)\n\nthe httpclient is shared between the threads of a given virtual user.\nthe cache is shared between the threads of a given virtual user.", "count": 5, "id": 189085, "time": "2016-03-04T08:32:35Z", "creator": "benoit.wiart@gmail.com", "creation_time": "2016-03-04T08:32:35Z", "is_private": false}, {"count": 6, "tags": [], "text": "Created attachment 33651\nBenchmark test plan", "is_private": false, "id": 189279, "creator": "p.mouawad@ubik-ingenierie.com", "time": "2016-03-08T22:49:20Z", "bug_id": 52073, "creation_time": "2016-03-08T22:49:20Z", "attachment_id": 33651}, {"attachment_id": null, "tags": [], "bug_id": 52073, "is_private": false, "count": 7, "id": 189280, "time": "2016-03-08T22:50:48Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2016-03-08T22:50:48Z", "text": "Hello,\nI benchmarked the PR 155 by Benoit W.(that he updated this evening), the gain of Throughtput with 15 threads is 1.65 bigger than the throughput without it.\n\nI will be commiting it tomorrow, unless there is opposition.\n\nRegards\n\nBenchmark conditions:\n- Tomcat with session timeout 1 minute\n- Keepalive on connector: 2s\n\n    <Connector port=\"8080\" protocol=\"HTTP/1.1\"\n               connectionTimeout=\"20000\"\n               enableLookups=\"false\"\n               keepAliveTimeout=\"2000\"\n               minSpareThreads=\"50\"\n               acceptorThreadCount=\"2\"\n               compression=\"off\"\n               redirectPort=\"8443\" />\n\n- Log level to WARN\n\nJMeter in Non GUI mode:\n-server -Xms1024m -Xmx1024m -XX:+UseG1GC -XX:MaxGCPauseMillis=200 -Xss256k -Dcom.sun.management.jmxremote.port=3333 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false  -XX:+UseThreadPriorities -XX:ThreadPriorityPolicy=42  -verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+PrintGCTimeStamps -XX:+PrintGCDetails -XX:+PrintGCApplicationConcurrentTime -XX:+PrintGCApplicationStoppedTime -XX:+PrintTenuringDistribution -XX:+PrintGCDetails -XX:+PrintHeapAtGC -XX:+PrintGCCause  -Xloggc:/data/jmeter/verbose-3.0.log -Djava.net.preferIPv4Stack=true -Djava.net.preferIPv6Addresses=false"}, {"count": 8, "tags": [], "bug_id": 52073, "attachment_id": null, "is_private": false, "id": 189300, "time": "2016-03-09T12:26:27Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2016-03-09T12:26:27Z", "text": "Author: pmouawad\nDate: Wed Mar  9 12:23:31 2016\nNew Revision: 1734228\n\nURL: http://svn.apache.org/viewvc?rev=1734228&view=rev\nLog:\n[Bug 52073] Embedded Resources Parallel download : Improve performances by avoiding shutdown of ThreadPoolExecutor at each sample\nBased on PR by Benoit Wiart + the addition (blame me) of JMeterPoolingClientConnectionManager  (see mailing list mail I will send)\nBugzilla Id: 52073\n\nAdded:\n    jmeter/trunk/src/protocol/http/org/apache/http/\n    jmeter/trunk/src/protocol/http/org/apache/http/impl/\n    jmeter/trunk/src/protocol/http/org/apache/http/impl/conn/\n    jmeter/trunk/src/protocol/http/org/apache/http/impl/conn/JMeterPoolingClientConnectionManager.java   (with props)\n    jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/sampler/ResourcesDownloader.java   (with props)\nModified:\n    jmeter/trunk/bin/jmeter.properties\n    jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/control/CacheManager.java\n    jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/sampler/HTTPHC4Impl.java\n    jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/sampler/HTTPSamplerBase.java\n    jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/sampler/MeasuringConnectionManager.java\n    jmeter/trunk/xdocs/changes.xml"}, {"count": 9, "tags": [], "creator": "felix.schumacher@internetallee.de", "attachment_id": null, "id": 189571, "creation_time": "2016-03-18T09:35:23Z", "time": "2016-03-18T09:35:23Z", "bug_id": 52073, "text": "Date: Fri Mar 18 09:25:58 2016\nNew Revision: 1735560\n\nURL: http://svn.apache.org/viewvc?rev=1735560&view=rev\nLog:\nFollowup to r17734228. No need for temporary variable. Return CacheManager directly.\n\nBugzilla Id: 52073\n\nModified:\n    jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/control/CacheManager.java", "is_private": false}]