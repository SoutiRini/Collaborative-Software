[{"count": 0, "tags": [], "bug_id": 59327, "attachment_id": 33764, "id": 190257, "time": "2016-04-14T17:57:44Z", "creator": "pelymtown@gmail.com", "creation_time": "2016-04-14T17:57:44Z", "is_private": false, "text": "Created attachment 33764\nVersion of XSLFTableCellclass with fixed version text direction getter/setter methods.\n\nTrying to set direction of a text inside a table cell by using setTextDirection() method on the cell has no effect as text direction does not change. Try the following code to reproduce the issue:\n\nimport java.awt.Rectangle;\nimport java.io.File;\nimport java.io.FileOutputStream;\n\nimport org.apache.poi.sl.usermodel.TextShape.TextDirection;\nimport org.apache.poi.xslf.usermodel.XMLSlideShow;\nimport org.apache.poi.xslf.usermodel.XSLFSlide;\nimport org.apache.poi.xslf.usermodel.XSLFTable;\nimport org.apache.poi.xslf.usermodel.XSLFTableCell;\nimport org.apache.poi.xslf.usermodel.XSLFTableRow;\nimport org.apache.poi.xslf.usermodel.XSLFTextParagraph;\nimport org.apache.poi.xslf.usermodel.XSLFTextRun;\n\n\npublic class TextDirectionTest {\n\n\tpublic static void main(String[] args) throws Exception {\n        String outputFilePath = args[0];\n\n        XMLSlideShow ppt = new XMLSlideShow(); \n\t\tXSLFSlide slide = ppt.createSlide();\n\n\t\tXSLFTable tbl = slide.createTable();\n        tbl.setAnchor(new Rectangle(50, 50, 200, 200));\n\t\tXSLFTableRow tr = tbl.addRow();\n\n\t\tXSLFTableCell cell = tr.addCell();\n\t\tXSLFTextParagraph p = cell.addNewTextParagraph();\n        XSLFTextRun r = p.addNewTextRun();\n        r.setText(\"Cell #1 vertical text\");\n        \n        cell.setTextDirection(TextDirection.VERTICAL);\n\t    \n\t\tFileOutputStream fos = new FileOutputStream(new File(outputFilePath));\n\t\tppt.write(fos);\n\t\tppt.close();\n\t\tfos.close();\n\t}\n\n}\n\nWhen the file produced by the above code is opened the direction of text is still horizontal.\n\nThe issue can also be reproduced in v3.11 (where it was originally discovered).\n\nIn order to address the problem, default implementation(s) of text direction getter/setter methods (from XSLFTextShape) need to be overridden in XSLFTableCell class as demonstrated in the attached code."}, {"count": 1, "attachment_id": null, "bug_id": 59327, "is_private": false, "id": 190739, "time": "2016-05-04T22:29:18Z", "creator": "kiwiwings@apache.org", "creation_time": "2016-05-04T22:29:18Z", "tags": [], "text": "Applied/fixed with r1742338\n- added test\n- added support for hslf"}]