[{"count": 0, "tags": [], "text": "I use an ant makefile to compile a set of classes. Everything compiles but the\njavah line breaks the code with Java 1.4.2. The Java 1.4.1 works fine.\n\nThis bug has been flagged as solved in 1.5.4 but I still have the error \nmessage as well as with the 1.6 beta version.\n\nHere is the excerpt that breaks the ant compile:\n<target name=\"header\" depends=\"compile\">\n<javah classpath=\"${outputDir}\" destdir=\"${cSrcDir}\"\n    force=\"yes\">\n<class name=\"se.lth.cs.carsim.LinkGrammarAPI\" />\n</javah>\n</target>\n\n\nClassArgument.name=se.lth.cs.carsim.LinkGrammarAPI\njava.lang.NoSuchMethodError: com.sun.tools.javah.Main.<init>\n([Ljava/lang/String;)V\n        at org.apache.tools.ant.taskdefs.optional.Javah.doClassicCompile\n(Javah.java:348)\n        at org.apache.tools.ant.taskdefs.optional.Javah.execute(Javah.java:318)\n        at org.apache.tools.ant.Task.perform(Task.java:319)\n        at org.apache.tools.ant.Target.execute(Target.java:309)\n        at org.apache.tools.ant.Target.performTasks(Target.java:336)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1306)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1250)\n        at org.apache.tools.ant.module.run.TargetExecutor.run\n(TargetExecutor.java:331)\n        at org.netbeans.core.execution.RunClassThread.run\n(RunClassThread.java:118)\nBUILD FAILED", "is_private": false, "id": 45369, "creator": "Pierre.Nugues@cs.lth.se", "time": "2003-10-10T14:27:27Z", "bug_id": 23726, "creation_time": "2003-10-10T14:27:27Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 23726, "text": "There must be an older version of Ant in your classpath somewhere.\n\nLine 348 of Ant 1.6beta is a try statement followed by the reflection code needed\nto work with JDK 1.4.2.", "count": 1, "id": 45371, "time": "2003-10-10T14:34:00Z", "creator": "bodewig@apache.org", "creation_time": "2003-10-10T14:34:00Z", "is_private": false}, {"count": 2, "tags": [], "creator": "ddevienne@lgc.com", "attachment_id": null, "text": "Indeed I think, sine with the config below, I test a smarter <javah> I'm \ndevelopping that uses internally <javah>, and everything works fine. --DD\n\nP:\\com_lgc\\9.0.5\\gocad\\Landmark\\JgOcad>java -version\njava version \"1.4.2\"\nJava(TM) 2 Runtime Environment, Standard Edition (build 1.4.2-b28)\nJava HotSpot(TM) Client VM (build 1.4.2-b28, mixed mode)\n\nP:\\com_lgc\\9.0.5\\gocad\\Landmark\\JgOcad>%BUILDTOOLS%\\ant\\bin\\ant -version\nApache Ant version 1.6beta compiled on September 30 2003\nP:\\com_lgc\\9.0.5\\gocad\\Landmark\\JgOcad>", "id": 45372, "time": "2003-10-10T14:41:14Z", "bug_id": 23726, "creation_time": "2003-10-10T14:41:14Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 23726, "attachment_id": null, "is_private": false, "id": 45376, "time": "2003-10-10T15:10:56Z", "creator": "Pierre.Nugues@cs.lth.se", "creation_time": "2003-10-10T15:10:56Z", "text": "> There must be an older version of Ant in your classpath somewhere.\n> Line 348 of Ant 1.6beta is a try statement followed by the reflection \n> code needed to work with JDK 1.4.2.\nI removed the other version of ant I had and it still does not work. It produces\nthe same error.\nI paste the complete buildfile.\n\nPierre\n--\n\n<project name=\"LinkGrammar\" default=\"all\" basedir=\".\">\t \n\n\n\n <target name=\"all\" depends=\"compile_core, compile_swedish, compile_oldenglish,\n\n                             compile_french, compile_newenglish, \n\n\t\t\t     compile_newswedish\"/>\n\n\n\n <target name=\"init\">\n\n    <property name=\"sourceDir\" value=\"src\" />\n\n    <property name=\"templateDir\" value=\"template\"/>\n\n    <property name=\"autogenDir\" value=\"../autogenerator\"/>\n\n    <property name=\"outputDir\" value=\"classes\" />\n\n    <property name=\"linkGrammarDir\" value=\"../link-4.1\" />\n\n    <property name=\"cSrcDir\" value=\"../link-4.1/src\" />\n\n    <property name=\"classes\" value=\"classes/se/lth/cs\" />\n\n    <property name=\"runDir\" value=\"../run\" />\n\n  </target>\n\n  \n\n  <target name=\"template\" depends=\"init\">\n\n    <delete dir=\"${templateDir}\"/>\n\n    <delete dir=\"${outputDir}\"/>\n\n    <mkdir dir=\"${templateDir}\"/>\n\n    <mkdir dir=\"${outputDir}\"/>\n\n    <java jar=\"${autogenDir}/autogenerator.jar\" failonerror=\"true\" fork=\"true\">\n\n      <arg line=\"-file template.xml -dtddest ${runDir} -javadest ${templateDir}\"/>\n\n    </java>\n\n    <javac srcdir=\"${templateDir}\" destdir=\"${outputDir}\">\n\n      <classpath>\n\n        <pathelement location=\"${autogenDir}/autogenerator.jar\"/>\n\n      </classpath>\n\n    </javac>\n\n    <jar destfile=\"${runDir}/template.jar\" basedir=\"${outputDir}\"/>\n\n  </target>\n\n\n\n  <target name=\"compile_core\" depends=\"init\">\n\n    <delete dir=\"${outputDir}\"/>\n\n    <mkdir dir=\"${outputDir}\"/>\n\n    <javac srcdir=\"${sourceDir}\" destdir=\"${outputDir}\">\n\n\t<classpath>\n\n          <pathelement location=\".\"/>\n\n\t  <pathelement location=\"../xerces/xercesImpl.jar\"/>   \t\n\n          <pathelement location=\"${autogenDir}/autogenerator.jar\"/>\n\n        </classpath>\n\n\t<include name=\"se/lth/cs/carsimgui/**\"/>\n\n    </javac>\n\n    <jar destfile=\"${runDir}/carsim.jar\" basedir=\"${outputDir}\" >\n\n     <manifest>\n\n      <attribute name=\"Main-Class\" value=\"se/lth/cs/carsimgui/CarSim\"/>\n\n      <attribute name=\"Class-Path\" value=\". ../vrml/vrml97.jar\n../wordnetjni/java/jar/wnjn.jar ../xerces/xercesImpl.jar\n../xerces/xmlParserAPIs.jar ${autogenDir}/autogenerator.jar ./template.jar\"/>\n\n     </manifest>\n\n    </jar>\n\n  </target>\n\n\n\n  <target name=\"compile_oldenglish\" depends=\"init\">\n\n    <delete dir=\"${outputDir}\"/>\n\n    <mkdir dir=\"${outputDir}\"/>\n\n    <javac srcdir=\"${sourceDir}\" destdir=\"${outputDir}\">\n\n\t<classpath>\n\n          <pathelement location=\".\"/>\n\n\t  <pathelement location=\"../wordnetjni/java/classes\"/>\n\n\t  <pathelement location=\"../xerces/xercesImpl.jar\"/>\n\n        </classpath>\n\n\t<include name=\"se/lth/cs/carsim/**\"/>\n\n\t<include name=\"se/lth/cs/carsim/collision/**\"/>\n\n    </javac>\n\n    <javah classpath=\"${outputDir}\" destdir=\"${cSrcDir}\" force=\"yes\">\n\n        <class name=\"se.lth.cs.carsim.LinkGrammarAPI\" />\n\n    </javah>\n\n    <jar destfile=\"${runDir}/carsim_oldenglish.jar\" basedir=\"${outputDir}\">\n\n     <manifest>\n\n      <attribute name=\"Module-Name\" value=\"English\"/>\n\n      <attribute name=\"Extract-Class\" value=\"se.lth.cs.carsim.Dispatch\"/>\n\n      <attribute name=\"Extract-Method\" value=\"extractInformationToXML\"/>\n\n     </manifest>\n\n    </jar>\n\n  </target>\n\n\n\n  <target name=\"compile_swedish\" depends=\"init\">\n\n    <delete dir=\"${outputDir}\"/>\n\n    <mkdir dir=\"${outputDir}\"/>\n\n    <javac srcdir=\"${sourceDir}\" destdir=\"${outputDir}\">\n\n\t<classpath>\n\n\t  <pathelement location=\".\"/>\n\n\t  <pathelement location=\"../xerces/xercesImpl.jar\"/>\n\n        </classpath>\n\n\t<include name=\"se/lth/cs/carsimnlpsv/**\"/>\n\n    </javac>\n\n    <jar destfile=\"${runDir}/carsim_swedish.jar\" basedir=\"${outputDir}\">\n\n     <manifest>\n\n      <attribute name=\"Module-Name\" value=\"Swedish\"/>\n\n      <attribute name=\"Extract-Class\" value=\"se.lth.cs.carsimnlpsv.Dispatch\"/>\n\n      <attribute name=\"Extract-Method\" value=\"extractInformationToXML\"/>\n\n     </manifest>\n\n    </jar>\n\n  </target>\n\n\n\n  <target name=\"compile_newenglish\" depends=\"template\">\n\n    <delete dir=\"${outputDir}\"/>\n\n    <mkdir dir=\"${outputDir}\"/>\n\n    <javac srcdir=\"${sourceDir}\" destdir=\"${outputDir}\">\n\n\t<classpath>\n\n\t  <pathelement location=\".\"/>\n\n\t  <pathelement location=\"${runDir}/template.jar\"/>\n\n\t  <pathelement location=\"../wordnetjni/java/classes\"/>\n\n        </classpath>\n\n\t<include name=\"se/lth/cs/carsimnlpen/**\"/>\n\n    </javac>\n\n    <jar destfile=\"${runDir}/carsim_newenglish.jar\" basedir=\"${outputDir}\">\n\n     <manifest>\n\n      <attribute name=\"Module-Name\" value=\"New English\"/>\n\n      <attribute name=\"Extract-Class\"\nvalue=\"se.lth.cs.carsimnlpen.EnglishExtracter\"/>\n\n      <attribute name=\"Extract-Method\" value=\"extractInformationToXML\"/>\n\n     </manifest>\n\n    </jar>\n\n  </target>\n\n\n\n  <target name=\"compile_newswedish\" depends=\"template\">\n\n    <delete dir=\"${outputDir}\"/>\n\n    <mkdir dir=\"${outputDir}\"/>\n\n    <javac srcdir=\"${sourceDir}\" destdir=\"${outputDir}\">\n\n\t<classpath>\n\n\t  <pathelement location=\".\"/>\n\n\t  <pathelement location=\"${runDir}/template.jar\"/>\n\n        </classpath>\n\n\t<include name=\"se/lth/cs/carsimnlpsv2/**\"/>\n\n    </javac>\n\n    <jar destfile=\"${runDir}/carsim_newswedish.jar\" basedir=\"${outputDir}\">\n\n     <manifest>\n\n      <attribute name=\"Module-Name\" value=\"New Swedish\"/>\n\n      <attribute name=\"Extract-Class\"\nvalue=\"se.lth.cs.carsimnlpsv2.SwedishExtracter\"/>\n\n      <attribute name=\"Extract-Method\" value=\"extractInformationToXML\"/>\n\n     </manifest>\n\n    </jar>\n\n  </target>\n\n\n\n  <target name=\"compile_french\" depends=\"init\">\n\n    <delete dir=\"${outputDir}\"/>\n\n    <mkdir dir=\"${outputDir}\"/>\n\n    <javac srcdir=\"${sourceDir}\" destdir=\"${outputDir}\">\n\n\t<classpath>\n\n\t  <pathelement location=\".\"/>\n\n        </classpath>\n\n\t<include name=\"se/lth/cs/carsimnlpfr/**\"/>\n\n    </javac>\n\n    <jar destfile=\"${runDir}/carsim_french.jar\" basedir=\"${outputDir}\">\n\n     <manifest>\n\n      <attribute name=\"Module-Name\" value=\"French\"/>\n\n      <attribute name=\"Extract-Class\" value=\"se.lth.cs.carsimnlpfr.Dispatch\"/>\n\n      <attribute name=\"Extract-Method\" value=\"extractInformationToXML\"/>\n\n     </manifest>\n\n    </jar>\n\n  </target>\n\n  \n\n  <!-- This section is to add a fast build feature -->\n\n\n\n  <target name=\"fastCompile\" depends=\"init\">\n\n    <javac srcdir=\"${sourceDir}\" destdir=\"${outputDir}\">\n\n\t<classpath>\n\n        \t<pathelement location=\".\"/>\n\n\t\t<pathelement location=\"../log4j/jakarta-log4j-1.2.6/dist/lib/log4j-1.2.6.jar\"/>\n\n\t\t<pathelement location=\"../wordnetjni/java/classes\"/>\n\n\t    \t<pathelement location=\"../xerces/xercesImpl.jar\"/>   \t\n\n        </classpath> \t\n\n\n\n        <include name=\"se/lth/cs/carsim/**\"/>\n\n\t<include name=\"se/lth/cs/carsim/collision/**\"/>\n\n        <include name=\"se/lth/cs/carsimgui/**\"/>\n\n        <include name=\"se/lth/cs/carsimnlpfr/**\"/>\n\n\n\n    </javac>\n\n  </target>\n\n  \n\n  <target name=\"fastBuild\" depends=\"fastCompile\">\n\n  \t<copy todir=\"${runDir}\" overwrite=\"yes\">\n\n      <fileset dir=\"${outputDir}\" />\n\n    </copy>\n\n  </target>\n\n    \n\n</project>"}, {"count": 4, "tags": [], "bug_id": 23726, "text": "I use NetBean as IDE and I discovered that it uses internally an older version\nof Ant 1.5.1\n\nSorry,\nPierre", "id": 45380, "time": "2003-10-10T15:41:58Z", "creator": "Pierre.Nugues@cs.lth.se", "creation_time": "2003-10-10T15:41:58Z", "is_private": false, "attachment_id": null}]