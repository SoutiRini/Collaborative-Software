[{"count": 0, "tags": [], "bug_id": 50178, "attachment_id": null, "id": 141146, "time": "2010-10-29T01:20:58Z", "creator": "plynch@apache.org", "creation_time": "2010-10-29T01:20:58Z", "is_private": false, "text": "1. Add a Header Manager as a direct child of a thread group. ( use case is test plan with multiple thread groups, each requiring diffferent headers.)\n2. If multiple threads for thread group loop forever, each test iteration concats the Header manager's name to the previous name as part of merging header name/values. See line 315 of HeaderManager.java (scm 915405 )\n\nThis apparently is done to track that header manager's were merged. Problem is when cycling test iterations, this string keeps growing and growing forever - as long as the loop. Then you see crazy long log messages from line 666 (evil!) in HttpSamplerBase.java \n\nGiven that the actual merge operation itself is logged, please remove the name concatenation during the merge operation so that there is no internal leak of memory for the HeaderManager name. Not doing this will eventually result in JMeter running out of memory allocating strings."}, {"count": 1, "tags": [], "text": "Note: the merge function was added as part of Bug 45479", "is_private": false, "id": 141154, "creator": "sebb@apache.org", "time": "2010-10-29T07:45:00Z", "bug_id": 50178, "creation_time": "2010-10-29T07:45:00Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 50178, "attachment_id": null, "id": 141253, "time": "2010-10-29T19:53:08Z", "creator": "sebb@apache.org", "creation_time": "2010-10-29T19:53:08Z", "is_private": false, "text": "The problem is really that the Header Manager sampler entry is not reset before the HMs are merged. Fixing this allows the updated name to work OK.\n\nAdded to SVN:\n\n\nURL: http://svn.apache.org/viewvc?rev=1028948&view=rev\nLog:\nBug 50178 - HeaderManager added as child of Thread Group can create concatenated HeaderManager names and OutOfMemoryException\n\nModified:\n   jakarta/jmeter/trunk/src/core/org/apache/jmeter/testelement/AbstractTestElement.java\n   jakarta/jmeter/trunk/src/core/org/apache/jmeter/testelement/TestElement.java\n   jakarta/jmeter/trunk/src/core/org/apache/jmeter/threads/TestCompiler.java\n   jakarta/jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/sampler/HTTPSamplerBase.java\n   jakarta/jmeter/trunk/xdocs/changes.xml\n\n\nThanks for the bug report."}]