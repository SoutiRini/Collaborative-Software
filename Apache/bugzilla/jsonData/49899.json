[{"count": 0, "tags": [], "bug_id": 49899, "text": "Created attachment 26004\nPatch\n\nIssue\nWhen logging large messages (SOAP messages in my case), the two Layout classes show up as a key contributor to memory pressure. Given a log entry size of say 1 megabyte, EnhancedPatternLayout.format will resize the StringBuffer from 16 to 33, 67, 135, ... creating a lot of unnecessary garbage along the way.\nEven worse, PatternLayout holds on to that StringBuffer in a field, and doesn't allow the its contents to be gc'ed until the next invocation.\n\nProposed fix. \n* If the message argument is a String, use its length to preallocate the StringBuffer to reduce the chance of resizing.\n* For PatternLayout, get rid of the StringBuffer field and allocate a new one each time, which is what EnhancedPatternLayout.format does, too\n\nPatch attached", "id": 139764, "time": "2010-09-08T11:30:32Z", "creator": "sreich@mac.com", "creation_time": "2010-09-08T11:30:32Z", "is_private": false, "attachment_id": 26004}]