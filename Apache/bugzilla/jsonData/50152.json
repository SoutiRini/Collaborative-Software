[{"count": 0, "tags": [], "creator": "phanquochien@gmail.com", "attachment_id": null, "is_private": false, "id": 141008, "time": "2010-10-25T12:41:22Z", "bug_id": 50152, "creation_time": "2010-10-25T12:41:22Z", "text": "Hi!\nI'm interesting compile apache httpd 2.2.17 on my centos5 x64.When I try use mpm=worker it raised error. See detail below:\n\nMy configure:\n ./configure --prefix=/usr/local/apache --with-mpm=worker --enable-deflate --enable-reqtimeout --enable-headers --enable-rewrite --enable-so --enable-vhost-alias --enable-suexec --with-suexec-docroot=/home\nAnd make proccess:\n\n\nmake[1]: Entering directory `/usr/local/src/httpd-2.2.17'\n/usr/local/apache/build/libtool --silent --mode=compile gcc -g -O2 -pthread    -DLINUX=2 -D_REENTRANT -D_GNU_SOURCE    -I/usr/local/src/httpd-2.2.17/srclib/pcre -I. -I/usr/local/src/httpd-2.2.17/os/unix -I/usr/local/src/httpd-2.2.17/server/mpm/worker -I/usr/local/src/httpd-2.2.17/modules/http -I/usr/local/src/httpd-2.2.17/modules/filters -I/usr/local/src/httpd-2.2.17/modules/proxy -I/usr/local/src/httpd-2.2.17/include -I/usr/local/src/httpd-2.2.17/modules/generators -I/usr/local/src/httpd-2.2.17/modules/mappers -I/usr/local/src/httpd-2.2.17/modules/database -I/usr/local/apache/include -I/usr/local/src/httpd-2.2.17/modules/proxy/../generators -I/usr/local/src/httpd-2.2.17/modules/ssl -I/usr/local/src/httpd-2.2.17/modules/dav/main  -prefer-non-pic -static -c modules.c && touch modules.lo\ngcc -g -O2 -pthread    -DLINUX=2 -D_REENTRANT -D_GNU_SOURCE    -I/usr/local/src/httpd-2.2.17/srclib/pcre -I. -I/usr/local/src/httpd-2.2.17/os/unix -I/usr/local/src/httpd-2.2.17/server/mpm/worker -I/usr/local/src/httpd-2.2.17/modules/http -I/usr/local/src/httpd-2.2.17/modules/filters -I/usr/local/src/httpd-2.2.17/modules/proxy -I/usr/local/src/httpd-2.2.17/include -I/usr/local/src/httpd-2.2.17/modules/generators -I/usr/local/src/httpd-2.2.17/modules/mappers -I/usr/local/src/httpd-2.2.17/modules/database -I/usr/local/apache/include -I/usr/local/src/httpd-2.2.17/modules/proxy/../generators -I/usr/local/src/httpd-2.2.17/modules/ssl -I/usr/local/src/httpd-2.2.17/modules/dav/main  -c /usr/local/src/httpd-2.2.17/server/buildmark.c\n/usr/local/apache/build/libtool --silent --mode=link gcc -g -O2 -pthread        -o httpd  modules.lo buildmark.o -export-dynamic server/libmain.la modules/aaa/libmod_authn_file.la modules/aaa/libmod_authn_default.la modules/aaa/libmod_authz_host.la modules/aaa/libmod_authz_groupfile.la modules/aaa/libmod_authz_user.la modules/aaa/libmod_authz_default.la modules/aaa/libmod_auth_basic.la modules/filters/libmod_reqtimeout.la modules/filters/libmod_include.la modules/filters/libmod_filter.la modules/filters/libmod_deflate.la modules/loggers/libmod_log_config.la modules/metadata/libmod_env.la modules/metadata/libmod_headers.la modules/metadata/libmod_setenvif.la modules/metadata/libmod_version.la modules/http/libmod_http.la modules/http/libmod_mime.la modules/generators/libmod_status.la modules/generators/libmod_autoindex.la modules/generators/libmod_asis.la modules/generators/libmod_suexec.la modules/generators/libmod_cgid.la modules/mappers/libmod_vhost_alias.la modules/mappers/libmod_negotiation.la modules/mappers/libmod_dir.la modules/mappers/libmod_actions.la modules/mappers/libmod_userdir.la modules/mappers/libmod_alias.la modules/mappers/libmod_rewrite.la modules/mappers/libmod_so.la server/mpm/worker/libworker.la os/unix/libos.la -lm /usr/local/src/httpd-2.2.17/srclib/pcre/libpcre.la /usr/local/apache/lib/libaprutil-1.la -lexpat /usr/local/apache/lib/libapr-1.la -luuid -lrt -lcrypt -lpthread -ldl\nserver/mpm/worker/.libs/libworker.a(worker.o): In function `child_main':\n/usr/local/src/httpd-2.2.17/server/mpm/worker/worker.c:1203: undefined reference to `ap_thread_stacksize'\ncollect2: ld returned 1 exit status\nmake[1]: *** [httpd] Error 1\nmake[1]: Leaving directory `/usr/local/src/httpd-2.2.17'\nmake: *** [all-recursive] Error 1\n-bash-3.2#"}, {"count": 1, "tags": [], "creator": "rainer.jung@kippdata.de", "attachment_id": null, "is_private": false, "id": 141053, "time": "2010-10-26T08:09:44Z", "bug_id": 50152, "creation_time": "2010-10-26T08:09:44Z", "text": "The symbol should be in libmain.a. I describe the steps how it gets there and you can check step by step, where we have lost it.\n\nFirst the symbol should be im mpm_common.o. You should find the file inside your build tree in server/mpm_common.o. To verify, whether the symbol is in there, you can type\n\n% nm server/mpm_common.o | grep ap_thread_stacksize\n0000000000000020 B ap_thread_stacksize\n\nIf it is not, please provide the result of that command and also the line in your make output, that contain \"mpm_common\". It should be similar to:\n\n/usr/local/src/httpd-2.2.17/srclib/apr/libtool --silent --mode=compile gcc -pthread -DLINUX=2 -D_REENTRANT -D_GNU_SOURCE   -I/usr/local/src/httpd-2.2.17/srclib/pcre -I. -I/usr/local/src/httpd-2.2.17/os/unix -I/usr/local/src/httpd-2.2.17/server/mpm/worker ...  -prefer-non-pic -static -c mpm_common.c && touch mpm_common.lo\n\n\n\nNow when linking libmain.a, the symbol should become part of that:\n\n% nm ./server/.libs/libmain.a|grep ap_thread_stacksize\n0000000000000020 B ap_thread_stacksize\n\nThe make output for linking libmain was:\n\n/usr/local/src/httpd-2.2.17/srclib/apr/libtool --silent --mode=link gcc -pthread -I/usr/local/src/httpd-2.2.17/srclib/pcre      -o libmain.la -static  test_char.h config.lo log.lo main.lo vhost.lo util.lo util_script.lo util_md5.lo util_cfgtree.lo util_ebcdic.lo util_time.lo connection.lo listen.lo mpm_common.lo util_charset.lo util_debug.lo util_xml.lo util_filter.lo util_pcre.lo exports.lo scoreboard.lo error_bucket.lo protocol.lo core.lo request.lo provider.lo eoc_bucket.lo core_filters.lo\n\nand you can see the mpm_common.lo.\n\nWhen looking closer at your make output snippet, I suspect that you have a confusion between the contents of /usr/local/apache/include and the include files provided by your 2.2.17 source in /usr/local/src/httpd-2.2.17. Furthermore I wonder why libtool in /usr/local/apache/build/libtool is being used and apr and apr-util in /usr/local/apache/lib.\n\nYou might want to temporarily remove your whole /usr/local/apache to build the new version without any dependencies to your old one."}, {"count": 2, "tags": [], "creator": "phanquochien@gmail.com", "attachment_id": null, "is_private": false, "id": 141060, "time": "2010-10-26T09:34:11Z", "bug_id": 50152, "creation_time": "2010-10-26T09:34:11Z", "text": "Problem has been resolved by using \"make clean\" and make again!\nThanks anyone help!"}, {"count": 3, "tags": [], "creator": "trawick@apache.org", "attachment_id": null, "is_private": false, "id": 141061, "time": "2010-10-26T11:04:13Z", "bug_id": 50152, "creation_time": "2010-10-26T11:04:13Z", "text": "not a bug"}]