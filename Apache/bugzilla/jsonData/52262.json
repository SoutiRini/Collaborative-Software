[{"count": 0, "tags": [], "bug_id": 52262, "text": "Created attachment 28001\nMulti-embedded test Word document\n\nThis bug was introduced during changes submitted in revision 1190347.\n\nBug was discovered using daily builds of TIKA and POI. Tika exposes the bug using a call to getMasterSheet() for an unused variable (bug submitted to Tika too for the unused variable.)\n\nEssentially the return types of the getMasterSheet() accidentally changed between revisions.  Return type for getMasterSheet() changed to XSLFSlideLayout from XSLFSlideMaster.  Patch changes the returned value back to waht it was prior, leaving the newly added @override specification.\n\nPatch file and example multi-embedded word document example used with a Tika based RecursiveMetadataParser included.\n\nStack Trace:\nERROR LogFaultActivity org.apache.poi.xslf.usermodel.XSLFSlide.getMasterSheet()Lorg/apache/poi/xslf/usermodel/XSLFSlideMaster;\njava.lang.NoSuchMethodError: org.apache.poi.xslf.usermodel.XSLFSlide.getMasterSheet()Lorg/apache/poi/xslf/usermodel/XSLFSlideMaster;\n\tat org.apache.tika.parser.microsoft.ooxml.XSLFPowerPointExtractorDecorator.buildXHTML(XSLFPowerPointExtractorDecorator.java:81)\n\tat org.apache.tika.parser.microsoft.ooxml.AbstractOOXMLExtractor.getXHTML(AbstractOOXMLExtractor.java:110)\n\tat org.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:97)\n\tat org.apache.tika.parser.microsoft.ooxml.OOXMLParser.parse(OOXMLParser.java:69)\n\tat org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)\n\tat org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)\n\tat org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:120)\n\tat org.apache.tika.parser.ParserDecorator.parse(ParserDecorator.java:91)\n\tat com.eastportanalytics.services.textextract.TikaTextExtractionService$RecursiveMetadataParser.parse(TikaTextExtractionService.java:364)\n\tat org.apache.tika.parser.DelegatingParser.parse(DelegatingParser.java:72)\n\tat org.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded(ParsingEmbeddedDocumentExtractor.java:109)\n\tat org.apache.tika.parser.microsoft.ooxml.AbstractOOXMLExtractor.handleEmbeddedFile(AbstractOOXMLExtractor.java:228)\n\tat org.apache.tika.parser.microsoft.ooxml.AbstractOOXMLExtractor.handleEmbeddedParts(AbstractOOXMLExtractor.java:148)\n\tat org.apache.tika.parser.microsoft.ooxml.AbstractOOXMLExtractor.getXHTML(AbstractOOXMLExtractor.java:113)\n\tat org.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:97)\n\tat org.apache.tika.parser.microsoft.ooxml.OOXMLParser.parse(OOXMLParser.java:69)\n\tat org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)\n\tat org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)\n\tat org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:120)\n\tat org.apache.tika.parser.ParserDecorator.parse(ParserDecorator.java:91)\n\tat com.eastportanalytics.services.textextract.TikaTextExtractionService$RecursiveMetadataParser.parse(TikaTextExtractionService.java:364)", "id": 151865, "time": "2011-11-29T16:54:41Z", "creator": "rpi_alum@yahoo.com", "creation_time": "2011-11-29T16:54:41Z", "is_private": false, "attachment_id": 28001}, {"count": 1, "tags": [], "bug_id": 52262, "text": "Created attachment 28002\nPatch file with changes\n\nPatch for the XSLFSlide.java file", "id": 151866, "time": "2011-11-29T16:58:15Z", "creator": "rpi_alum@yahoo.com", "creation_time": "2011-11-29T16:58:15Z", "is_private": false, "attachment_id": 28002}, {"count": 2, "tags": [], "text": "TIKA bug #795 opened for issue as well.", "is_private": false, "bug_id": 52262, "id": 151867, "time": "2011-11-29T17:25:20Z", "creator": "rpi_alum@yahoo.com", "creation_time": "2011-11-29T17:25:20Z", "attachment_id": null}, {"count": 3, "text": "It was an intentional change. Master sheet of a slide is slide layout and master of a slide layout is slide master. To be clear, my change reflects the sheet hierarchy in the .pptx format:\n\nslide.xml <-- slideLayout.xml <-- slideMaster.xml\n\nThe immediate fix on the Tika side is to use XSLFSlide.getSlideMaster() instead of XSLFSlide.getMasterSheet(). With this change everything should compile and run. \n\nMeanwhile, I'm going to rework Tika's XSLFPowerPointExtractorDecorator - most of the logic can be simplified and written in a much nicer form.\n\nYegor\n\n(In reply to comment #2)\n> TIKA bug #795 opened for issue as well.", "bug_id": 52262, "attachment_id": null, "id": 151873, "time": "2011-11-30T13:35:53Z", "creator": "yegor@dinom.ru", "creation_time": "2011-11-30T13:35:53Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "creator": "rpi_alum@yahoo.com", "attachment_id": null, "is_private": false, "id": 151874, "time": "2011-11-30T13:47:33Z", "bug_id": 52262, "creation_time": "2011-11-30T13:47:33Z", "text": "Sounds good,  Thanks Yegor.\n\nNick has already added the patch to TIKA-700 yesterday using that additional method, I missed it when I was looking at it yesterday.   After seeing his patch I began to suspect that the change was done on-purpose and for a reason.  I'll update the status to resolved and not it as an invalid bug.\n\nThanks again... keep up the great work!!"}]