[{"count": 0, "tags": [], "creator": "kleindienst@grid-it.at", "text": "Created attachment 26918\nModified java file with bug fixed\n\nOverview\n\nThe calculation of image width and height in the class\n  XSSFPicture\nof the package\n  org.apache.poi.xssf.usermodel\nhas a bug:\n\nIf an image fits into one cell (in the second or one of the following columns), the width calculation leads to wrong results, because cw is taken from the next column, which is not relevant in that case:\n  double cw = getColumnWidthInPixels(col2 + 1);\nA quick and dirty solution would be to check, if the last column (col2) is the same as the first and calculate the dx2 accordingly:\n  if (col2 == anchor.getCol1()) {\n     = (int) (EMU_PER_PIXEL * scaledWidth);\n  }\nSame for image height.\n\n\nSteps to Reproduce\n\nJust ad an image to a an XLSX which fits into one cell (using the XSSF model).\n\n\nBuild Date & Platform\n\npoi-3.7-20101029 on Windows\n\n\nAttachment\n\nThe java file with the corrections is attached. (However, there might be a better way to solve this.)", "id": 145919, "time": "2011-04-21T02:03:42Z", "bug_id": 51098, "creation_time": "2011-04-21T02:03:42Z", "is_private": false, "attachment_id": 26918}, {"count": 1, "tags": [], "bug_id": 51098, "attachment_id": null, "id": 146689, "time": "2011-05-27T18:46:30Z", "creator": "yegor@dinom.ru", "creation_time": "2011-05-27T18:46:30Z", "is_private": false, "text": "Fixed in r1128422\n\nYegor"}]