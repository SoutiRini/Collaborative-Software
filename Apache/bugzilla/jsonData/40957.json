[{"count": 0, "tags": [], "bug_id": 40957, "attachment_id": null, "id": 95769, "time": "2006-11-13T08:44:00Z", "creator": "peterbacik@inmail.sk", "creation_time": "2006-11-13T08:44:00Z", "is_private": false, "text": "If a client sends a SOAP request with wrong signature (values of the ds:... \nelements are missing), a NullPointerException is thrown in ElementProxy class.\n\nRequest:\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\n\txmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n\txmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n\t<soapenv:Header>\n\t\t<ds:Signature xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\">\n\t\t\t<ds:SignedInfo \nxmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\">\n\t\t\t\t<ds:CanonicalizationMethod\n\t\t\t\t\n\tAlgorithm=\"http://www.w3.org/TR/2001/REC-xml-c14n-20010315\"\n\t\t\t\t\n\txmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"/>\n\t\t\t\t<ds:SignatureMethod \nAlgorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\"\n\t\t\t\t\n\txmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"/>\n\t\t\t\t<ds:Reference URI=\"#Body\" \nxmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\">\n\t\t\t\t\t<ds:Transforms \nxmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\">\n\t\t\t\t\t\t<ds:Transform\n\t\t\t\t\t\t\n\tAlgorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"\n\t\t\t\t\t\t\n\txmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"/>\n\t\t\t\t\t\t<ds:Transform\n\t\t\t\t\t\t\n\tAlgorithm=\"http://www.w3.org/TR/2001/REC-xml-c14n-\n20010315#WithComments\"\n\t\t\t\t\t\t\n\txmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"/>\n\t\t\t\t\t</ds:Transforms>\n\t\t\t\t\t<ds:DigestMethod \nAlgorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"\n\t\t\t\t\t\n\txmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"/>\n\t\t\t\t\t<ds:DigestValue/>\n\t\t\t\t</ds:Reference>\n\t\t\t</ds:SignedInfo>\n\t\t\t<ds:SignatureValue/>\n\t\t\t<ds:KeyInfo \nxmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\">\n\t\t\t\t<ds:X509Data>\n\t\t\t\t\t<ds:X509Certificate/>\n\t\t\t\t</ds:X509Data>\n\t\t\t\t<ds:KeyValue>\n\t\t\t\t\t<ds:RSAKeyValue>\n\t\t\t\t\t\t<ds:Modulus/>\n\t\t\t\t\t\t<ds:Exponent/>\n\t\t\t\t\t</ds:RSAKeyValue>\n\t\t\t\t</ds:KeyValue>\n\t\t\t</ds:KeyInfo>\n\t\t</ds:Signature>\n\t</soapenv:Header>\n\t<soapenv:Body Id=\"Body\">\n\t\t...\n\t</soapenv:Body>\n</soapenv:Envelope>\n\nStack trace:\njava.lang.NullPointerException\n\tat org.apache.xml.security.utils.ElementProxy.getBytesFromTextChild\n(ElementProxy.java:423)\n\tat \norg.apache.xml.security.keys.content.x509.XMLX509Certificate.getCertificateByte\ns(XMLX509Certificate.java:99)\n\tat \norg.apache.xml.security.keys.content.x509.XMLX509Certificate.getX509Certificate\n(XMLX509Certificate.java:111)\n\tat \norg.apache.xml.security.keys.keyresolver.implementations.X509CertificateResolve\nr.engineResolveX509Certificate(X509CertificateResolver.java:149)\n\tat \norg.apache.xml.security.keys.keyresolver.KeyResolver.resolveX509Certificate\n(KeyResolver.java:239)\n\tat \norg.apache.xml.security.keys.KeyInfo.getX509CertificateFromStaticResolvers\n(KeyInfo.java:900)\n\tat org.apache.xml.security.keys.KeyInfo.getX509Certificate\n(KeyInfo.java:859)"}, {"count": 1, "attachment_id": null, "bug_id": 40957, "is_private": false, "id": 99391, "time": "2007-02-14T12:28:17Z", "creator": "sean.mullan@oracle.com", "creation_time": "2007-02-14T12:28:17Z", "tags": [], "text": "I don't really think this is a bug. The example signature is not\nvalid according to the xmldsig schema. In this case, I think throwing \nan NPE is ok. The application should validate the soap message using \na schema/DTD prior to validating the signature to make sure it is in\ncorrect form. "}, {"count": 2, "attachment_id": null, "bug_id": 40957, "is_private": false, "id": 108401, "time": "2007-09-19T12:24:06Z", "creator": "sean.mullan@oracle.com", "creation_time": "2007-09-19T12:24:06Z", "tags": [], "text": "Closing old bugs."}]