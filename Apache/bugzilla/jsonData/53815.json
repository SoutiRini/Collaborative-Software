[{"count": 0, "tags": [], "bug_id": 53815, "attachment_id": null, "id": 161892, "time": "2012-09-02T12:58:19Z", "creator": "sebb@apache.org", "creation_time": "2012-09-02T12:58:19Z", "is_private": false, "text": "FileServer needs to be synchronised to provide thread-safety.\n\nHowever, the synchronisation is applied at instance level.\nThis is unnecessary for at least part of the time.\n\nThe files Map is mostly read, not written, so could be protected using read/write locks. A Concurrent Map would not be sufficient here, as the updates need exclusive access.\n\nAccess to a single FileEntry instance would still need to be single-threaded to prevent problems when sharing a file across multiple threads.\n\nMaking such changes should improve performance by reducing lock waits."}]