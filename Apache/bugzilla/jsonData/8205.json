[{"count": 0, "tags": [], "bug_id": 8205, "attachment_id": null, "is_private": false, "id": 13849, "time": "2002-04-17T13:37:28Z", "creator": "gary.mullenschultz@kingland.com", "creation_time": "2002-04-17T13:37:28Z", "text": "I am running on Tomcat 4.0.3, using the standalone server.\n\nWe do multiple redirects in our server, across Tomcat instances.  We are\nencountering failure in the following scenario.\n\nLet's say we have two Tomcat instances: A on port 81, and B on port 82.  A\ncontains one JSP in the root webapp: SendRedirect.jsp.  B contains two JSPs\nin the root webapp: ReceiveAndSendRedirect.jsp and ReceiveRedirect.jsp.  The\nsource is as follows:\n\nSendRedirect.jsp:\n<%\nresponse.sendRedirect(\"http://127.0.0.1:82//ReceiveAndSendRedirect.jsp\");\n%>\n\n\nReceiveAndSendRedirect.jsp:\n<%\nresponse.sendRedirect(\"ReceiveRedirect.jsp\");\n%>\n\nReceiveRedirect.jsp:\n<html><body>\nThis is ReceiveRedirect!\n</body></html>\n\nWhat ends up happening is that the sendRedirect method inside\nReceiveAndSendRedirect.jsp builds a URL that looks like this:\nhttp://127.0.0.1:81//ReceiveRedirect.jsp\n\nThere *is* no ReceiveRedirect.jsp on instance A (port 81), and a 404\nresults.\n\nIn debug mode, a call to request.getPort() inside ReceiveAndSendRedirect.jsp\nreturns 81; given that it's a redirect (not a forward), I would have thought\nit would return 82 (the port of the \"current\" server).\n\nAny ideas?  Am I just confused?  If so, how can I easily do this multiple\nredirection (it gets invoked when our security code kicks in).\n\nThanks, Gary Mullen-Schultz, Kingland Systems"}, {"count": 1, "tags": [], "text": "Very interesting ! It is a bug in IE (I assume you're using IE). With Mozilla,\nit works fine.\nThe problem is that the host header sent by IE is incorrect when doing the\nredirect to ReceiveAndSendRedirect.jsp (it is Host: 127.0.0.1:81, although it\nshould be Host: 127.0.0.1:82). \"Fixing\" it (by using our socket's port, for\nexample) violates the HTTP spec, and creates lots of other problems.", "attachment_id": null, "bug_id": 8205, "id": 13873, "time": "2002-04-17T16:53:20Z", "creator": "remm@apache.org", "creation_time": "2002-04-17T16:53:20Z", "is_private": false}]