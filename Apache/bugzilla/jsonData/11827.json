[{"count": 0, "tags": [], "bug_id": 11827, "attachment_id": null, "id": 21279, "time": "2002-08-19T17:22:19Z", "creator": "gary.j.robertson@jpmorgan.com", "creation_time": "2002-08-19T17:22:19Z", "is_private": false, "text": "I'm having some problems using the SUMIF() formula - if I generate a cell\nusing it and then open the workbook in Excel 97 (or 2000)\nthe displayed cell value is #VALUE!. However, if I look at the contents of\nthe cell, the formula appears to be set correctly, and if I double-click\non the cell, or hit the function button followed by OK, the cell then\nrecalculates correctly.\n\nI should have said that if I do a manual recalculation  within Excel (\ntools | options | calculation | manual, F9) the cell is still not\nupdated - I have to double click on it as described below.\n\nI'm using 1.7-dev and JDK 1.3.1 with Excel 97. \n\nAttachments are:\npoi.xls, poi.out - xls and BiffViewer from POI\nhand1.xls, hand1.out - xls and BiffViewer after loading into Excel 97 and \nsaving unchanged\nhand2.xls, hand2.out - xls and BiffViewer after loading hand1.xls, double-\nclicking on formula and resaving.\n\ndiff between hand1.out and hand2.out:\n\n$ diff hand1.out hand2.out\n1687c1687\n<     .value           = NaN\n---\n>     .value           = 0.0\n1702c1702\n< 00000000 45 00 00 01 00 00 C0 00 C0\n---\n> 00000000 25 00 00 01 00 00 C0 00 C0\n1717c1717\n< 00000000 45 00 00 01 00 01 C0 01 C0\n---\n> 00000000 25 00 00 01 00 01 C0 01 C0\n\nIn context:\n\n============================================\nOffset 0xa41 (2625)\nrecordid = 0x6, size =47\n[FORMULA]\n    .row       = 2\n    .column    = 3\n    .xf              = f\n    .value           = 0.0\n    .options         = 0\n    .zero            = -52428800\n    .expressionlength= 25\n    .numptgsinarray  = 4\nFormula 0=AreaPtg\nfirstRow = 0\nlastRow  = 1\nfirstCol = 0\nlastCol  = 0\nfirstColRowRel= true\nlastColRowRel = true\nfirstColRel   = true\nlastColRel    = true\n\n00000000 25 00 00 01 00 00 C0 00 C0                      %........\n\nFormula 1=org.apache.poi.hssf.record.formula.IntPtg@60be38\n00000000 1E B8 0B                                        ...\n\nFormula 2=AreaPtg\nfirstRow = 0\nlastRow  = 1\nfirstCol = 1\nlastCol  = 1\nfirstColRowRel= true\nlastColRowRel = true\nfirstColRel   = true\nlastColRel    = true\n\n00000000 25 00 00 01 00 01 C0 01 C0                      %........\n\nFormula 3=<FunctionPtg>\n   field_1_num_args=3\n      name         =SUMIF\n   field_2_fnc_index=345\n</FunctionPtg>\n00000000 42 03 59 01                                     B.Y.\n\n[/FORMULA]\n\n============================================"}, {"count": 1, "tags": [], "bug_id": 11827, "is_private": false, "text": "Created attachment 2759\nGeneration from POI", "id": 21281, "time": "2002-08-19T17:25:21Z", "creator": "gary.j.robertson@jpmorgan.com", "creation_time": "2002-08-19T17:25:21Z", "attachment_id": 2759}, {"count": 2, "tags": [], "bug_id": 11827, "attachment_id": 2760, "id": 21282, "time": "2002-08-19T17:25:47Z", "creator": "gary.j.robertson@jpmorgan.com", "creation_time": "2002-08-19T17:25:47Z", "is_private": false, "text": "Created attachment 2760\nGeneration from POI"}, {"count": 3, "tags": [], "text": "Created attachment 2761\nAter saving unchanged in Excel 97", "is_private": false, "bug_id": 11827, "id": 21283, "time": "2002-08-19T17:26:49Z", "creator": "gary.j.robertson@jpmorgan.com", "creation_time": "2002-08-19T17:26:49Z", "attachment_id": 2761}, {"attachment_id": 2762, "tags": [], "bug_id": 11827, "text": "Created attachment 2762\nAfter double clicking on formula in hand1.xls and saving.", "count": 4, "id": 21284, "time": "2002-08-19T17:27:18Z", "creator": "gary.j.robertson@jpmorgan.com", "creation_time": "2002-08-19T17:27:18Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 11827, "attachment_id": 2763, "id": 21285, "time": "2002-08-19T17:27:56Z", "creator": "gary.j.robertson@jpmorgan.com", "creation_time": "2002-08-19T17:27:56Z", "is_private": false, "text": "Created attachment 2763\nBiffView of poi.xls"}, {"count": 6, "tags": [], "bug_id": 11827, "attachment_id": 2764, "id": 21286, "time": "2002-08-19T17:28:15Z", "creator": "gary.j.robertson@jpmorgan.com", "creation_time": "2002-08-19T17:28:15Z", "is_private": false, "text": "Created attachment 2764\nBiffView of hand1.xls"}, {"count": 7, "tags": [], "text": "Created attachment 2765\nBiffView of hand2.xls", "attachment_id": 2765, "id": 21287, "creator": "gary.j.robertson@jpmorgan.com", "time": "2002-08-19T17:28:35Z", "bug_id": 11827, "creation_time": "2002-08-19T17:28:35Z", "is_private": false}, {"count": 8, "tags": [], "text": "attach_id 2759 added in error - ignore!", "is_private": false, "bug_id": 11827, "id": 21289, "time": "2002-08-19T17:30:40Z", "creator": "gary.j.robertson@jpmorgan.com", "creation_time": "2002-08-19T17:30:40Z", "attachment_id": null}, {"count": 9, "tags": [], "text": "Created attachment 3718\nPatch: Changed VALUE/REF token on SUMIF()", "is_private": false, "id": 25650, "creator": "gary.j.robertson@jpmorgan.com", "time": "2002-11-04T22:59:25Z", "bug_id": 11827, "creation_time": "2002-11-04T22:59:25Z", "attachment_id": 3718}]