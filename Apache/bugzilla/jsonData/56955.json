[{"count": 0, "attachment_id": 31996, "bug_id": 56955, "is_private": false, "id": 177724, "time": "2014-09-11T06:59:59Z", "creator": "hzhang9@ebay.com", "creation_time": "2014-09-11T06:59:59Z", "tags": [], "text": "Created attachment 31996\npatch\n\n\u201corg.apache.tomcat.util.bcel.classfile.ClassParser\u201d parse \".class\" file to an Object.\nActually, many information in the \".class\" is useless. Including: version, fields, methods.\n\nSkip these information can speed up the startup of tomcat. Add a switch named \"isSkip\", and modify the parse as following.\n\n /****************** Read headers ********************************/\n      // Check magic tag of class file\n      readID();\n      // Get compiler version\n      if(!isSkip) readVersion();\n      else skipVersion();\n      /****************** Read constant pool and related **************/\n      // Read constant pool entries\n      readConstantPool();\n      // Get class information\n      readClassInfo();\n      // Get interface information, i.e., implemented interfaces\n      readInterfaces();\n      /****************** Read class fields and methods ***************/\n      // Read class fields, i.e., the variables of the class\n      if(!isSkip) readFields();\n      else skipFields();\n      // Read class methods, i.e., the functions in the class\n      if(!isSkip) readMethods();\n      else skipMethods();\n      // Read class attributes\n      readAttributes();"}, {"count": 1, "tags": [], "text": "Created attachment 31997\ntest case", "attachment_id": 31997, "id": 177725, "creator": "hzhang9@ebay.com", "time": "2014-09-11T07:01:37Z", "bug_id": 56955, "creation_time": "2014-09-11T07:01:37Z", "is_private": false}, {"count": 2, "tags": [], "text": "Benefit (got by test case in the attachment):\n\n=====lots of jar files=====\nNormal: 551\nSkip: 453\n=====few jar files=====\nNormal: 88\nSkip: 65\n\nnotice: \n1.Skip version calls before original version in the test case, so the performance should be better.\n2.It works more efficient in large projects.", "attachment_id": null, "bug_id": 56955, "id": 177726, "time": "2014-09-11T07:08:02Z", "creator": "hzhang9@ebay.com", "creation_time": "2014-09-11T07:08:02Z", "is_private": false}, {"count": 3, "tags": [], "creator": "markt@apache.org", "is_private": false, "text": "Several comments.\n\nA number of these changes have already been made in 8.0.x and can be back-ported. svn revisions to back-port are therefore preferred to new patches.\n\nThere is no need to make skipping optional. The information is either required (in which case we keep it) or not (in which case we dump it).\n\nUnless a bug is specific to a major release, patches should always be against tomcat/trunk in svn and will be back-ported to the version the bug was opened against.\n\nThis bug report prompted me to review (again) what information we keep in BCEL and I have removed a largish chunk that isn't covered by this patch.\n\nI'll take another look at the class parser next.", "id": 177732, "time": "2014-09-11T09:04:41Z", "bug_id": 56955, "creation_time": "2014-09-11T09:04:41Z", "attachment_id": null}, {"count": 4, "attachment_id": null, "bug_id": 56955, "is_private": false, "id": 177739, "time": "2014-09-11T10:33:06Z", "creator": "markt@apache.org", "creation_time": "2014-09-11T10:33:06Z", "tags": [], "text": "Some further comments:\n\nThe patch should address a single concern. Most of the provided patch has nothing to do with this bug report.\n\nThere are a lot of changes that appear to undo previous clean-up.\n\nI recommend testing with tomcat/trunk (currently the 8.0.x development branch). A lot more changes have been made to that branch that haven't yet been backported to 7.0.x."}, {"count": 5, "tags": [], "bug_id": 56955, "attachment_id": 32009, "text": "Created attachment 32009\npatch", "id": 177784, "time": "2014-09-12T05:20:32Z", "creator": "hzhang9@ebay.com", "creation_time": "2014-09-12T05:20:32Z", "is_private": false}, {"count": 6, "tags": [], "creator": "markt@apache.org", "is_private": false, "text": "If you continue to ignore the comments you are given then this issue is going to get closed as WONTFIX.\n\nYour first patch was 117k and full of irrelevant changes. The second attempt is worse at 130k.\n\nStarting at the beginning of the patch:\n1. The first chunk changes restores an svn keyword the Tomcat team previously removed. This change has nothing to do with this issue and should not be in this patch.\n\n2. The second chunk reverts a fix to a constant name the Tomcat team previously fixed and removes some code necessary for Java 8 support. This change has nothing to do with this issue and should not be in this patch. Further this change breaks Java 8 support.\n\n3. The third chunk makes further changes that have nothing to do with this issue and further breaks Java 8 support.\n\nAnd so on.\n\nTo repeat:\n- Patches should be against http://svn.apache.org/viewvc/tomcat/trunk/\n- If you'd like to propose changes to back port form there to tc7.0.x/trunk then provide some revision numbers.", "id": 177786, "time": "2014-09-12T07:52:59Z", "bug_id": 56955, "creation_time": "2014-09-12T07:52:59Z", "attachment_id": null}, {"count": 7, "attachment_id": null, "bug_id": 56955, "is_private": false, "id": 177789, "time": "2014-09-12T08:39:15Z", "creator": "hzhang9@ebay.com", "creation_time": "2014-09-12T08:39:15Z", "tags": [], "text": "Sorry for any inconvenience. I am now reviewing my code."}, {"count": 8, "tags": [], "creator": "markt@apache.org", "is_private": false, "text": "Numerous BCEL changes have been back-ported from trunk for the next 7.0.x release including ones that cover this report.\n\nThe new code will be in 7.0.56 onwards.", "id": 177813, "time": "2014-09-12T13:26:20Z", "bug_id": 56955, "creation_time": "2014-09-12T13:26:20Z", "attachment_id": null}]