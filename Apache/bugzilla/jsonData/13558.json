[{"count": 0, "tags": [], "bug_id": 13558, "text": "I am running:\n\nSolaris 8 108528-16\ngcc 3.2\nGNU make 3.80\n\nI have tried many versions of Apache 2.0.38 - 2.0.43 and get the same error.\nI have retrieved all builds from apache.org.\nConfigure works fine. The problem occurs running make: \n(below is a snip from the log)\n...\n...\n...\nMaking all in locks/unix\n/bin/bash /export/home/packages/httpd-2.0.43/srclib/apr/libtool --silent --\nmode=compile gcc -g -O2 -pthreads   -DHAVE_CONFIG_H -DSOLARIS2=8 -\nD_POSIX_PTHREAD_SEMANTICS -D_REENTRANT   -I../../include -I../../include/arch -\nI../../include/arch/unix  -c thread_mutex.c && touch thread_mutex.lo\n/bin/bash /export/home/packages/httpd-2.0.43/srclib/apr/libtool --silent --\nmode=compile gcc -g -O2 -pthreads   -DHAVE_CONFIG_H -DSOLARIS2=8 -\nD_POSIX_PTHREAD_SEMANTICS -D_REENTRANT   -I../../include -I../../include/arch -\nI../../include/arch/unix  -c thread_rwlock.c && touch thread_rwlock.lo\nIn file included from thread_rwlock.c:55:\n../../include/arch/unix/thread_rwlock.h:74: parse error \nbefore \"pthread_rwlock_t\"\n../../include/arch/unix/thread_rwlock.h:74: warning: no semicolon at end of \nstruct or union\nthread_rwlock.c: In function `thread_rwlock_cleanup':\nthread_rwlock.c:67: dereferencing pointer to incomplete type\nthread_rwlock.c:68: dereferencing pointer to incomplete type\nthread_rwlock.c: In function `apr_thread_rwlock_create':\nthread_rwlock.c:84: sizeof applied to an incomplete type\nthread_rwlock.c:84: sizeof applied to an incomplete type\nthread_rwlock.c:90: dereferencing pointer to incomplete type\nthread_rwlock.c:91: dereferencing pointer to incomplete type\nthread_rwlock.c:91: `pthread_rwlock_t' undeclared (first use in this function)\nthread_rwlock.c:91: (Each undeclared identifier is reported only once\nthread_rwlock.c:91: for each function it appears in.)\nthread_rwlock.c:91: parse error before ')' token\nthread_rwlock.c:94: dereferencing pointer to incomplete type\nthread_rwlock.c:98: dereferencing pointer to incomplete type\nthread_rwlock.c:106: dereferencing pointer to incomplete type\nthread_rwlock.c: In function `apr_thread_rwlock_rdlock':\nthread_rwlock.c:118: dereferencing pointer to incomplete type\nthread_rwlock.c: In function `apr_thread_rwlock_tryrdlock':\nthread_rwlock.c:131: dereferencing pointer to incomplete type\nthread_rwlock.c: In function `apr_thread_rwlock_wrlock':\nthread_rwlock.c:147: dereferencing pointer to incomplete type\nthread_rwlock.c: In function `apr_thread_rwlock_trywrlock':\nthread_rwlock.c:160: dereferencing pointer to incomplete type\nthread_rwlock.c: In function `apr_thread_rwlock_unlock':\nthread_rwlock.c:176: dereferencing pointer to incomplete type\nthread_rwlock.c: In function `apr_thread_rwlock_destroy':\nthread_rwlock.c:189: dereferencing pointer to incomplete type\nthread_rwlock.c: In function `apr_thread_rwlock_pool_get':\nthread_rwlock.c:234: dereferencing pointer to incomplete type\n*** Error code 1\nmake: Fatal error: Command failed for target `thread_rwlock.lo'\nCurrent working directory /export/home/packages/httpd-\n2.0.43/srclib/apr/locks/unix\n*** Error code 1\nmake: Fatal error: Command failed for target `all-recursive'\nCurrent working directory /export/home/packages/httpd-\n2.0.43/srclib/apr/locks/unix\n*** Error code 1\nmake: Fatal error: Command failed for target `all-recursive'\nCurrent working directory /export/home/packages/httpd-2.0.43/srclib/apr\n*** Error code 1\nmake: Fatal error: Command failed for target `all-recursive'\nCurrent working directory /export/home/packages/httpd-2.0.43/srclib\n*** Error code 1\nmake: Fatal error: Command failed for target `all-recursive'\n\n------------------------------------------------------------- \n\nIt seems to me that either the build is missing .h files or there\nis an error in the thread_rwlock.c file.\n\nHere is a listing of the files currently in that directory:\nIt has been the same in all of the builds I have tried.\n\n/export/home/packages/httpd-2.0.43/srclib/apr/locks/unix\n\ndrwxr-xr-x   3 1134     1134         512 Oct  7 09:56 .\ndrwxr-xr-x   7 1134     1134         512 Oct  3 01:43 ..\ndrwxr-xr-x   2 root     other        512 Oct  7 09:56 .libs\n-rw-r--r--   1 root     other        489 Oct  7 09:22 Makefile\n-rw-r--r--   1 1134     1134         340 Apr 21 21:24 Makefile.in\n-rw-r--r--   1 1134     1134        6497 May  8 09:30 global_mutex.c\n-rw-r--r--   1 1134     1134       29047 Jun 30 00:04 proc_mutex.c\n-rw-r--r--   1 1134     1134        5827 Jun 30 00:04 thread_cond.c\n-rw-r--r--   1 1134     1134        6972 Jul 30 13:06 thread_mutex.c\n-rw-r--r--   1 root     other      42012 Oct  7 09:56 thread_mutex.lo\n-rw-r--r--   1 root     other      41848 Oct  7 09:56 thread_mutex.o\n-rw-r--r--   1 1134     1134        6910 Mar 13  2002 thread_rwlock.c\n\nI can email the entire log if needed.\nI appreciate any help.\n\nJohn Murphy", "id": 24376, "time": "2002-10-11T23:21:17Z", "creator": "murf@optonline.net", "creation_time": "2002-10-11T23:21:17Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "trawick@apache.org", "attachment_id": null, "text": "It appears that something is screwed up with pthread.h on your system (the one \nthat gcc uses, not necessarily /usr/include/pthread.h).\n\nYou will likely need to play with it (put #error here and there) to see\nwhy the definition of pthread_rwlock_t is not being picked up.\n\nWhat is the value of APR_HAVE_PTHREAD_H (srclib/apr/include/apr.h)?\n", "id": 24377, "time": "2002-10-11T23:34:01Z", "bug_id": 13558, "creation_time": "2002-10-11T23:34:01Z", "is_private": false}, {"count": 2, "tags": [], "creator": "murf@optonline.net", "attachment_id": null, "text": "Here is some more info:\n\nThe vaule of APR_HAVE_PTHREAD_H = 1\npthread.h version is 1.29", "id": 24387, "time": "2002-10-12T03:27:39Z", "bug_id": 13558, "creation_time": "2002-10-12T03:27:39Z", "is_private": false}, {"count": 3, "tags": [], "creator": "trawick@apache.org", "attachment_id": null, "text": "on my solaris 8, the system version of pthread.h (/usr/include/pthread.h) is \n1.3.29 but gcc is using\n\n/usr/local/lib/gcc-lib/sparc-sun-solaris2.8/3.1/include/pthread.h\n\nwhich is 1.3.28 passed through fixincludes\n\nI guess whoever installed gcc on the box I'm using had a pre-packaged version \nof gcc that was built on a system with 1.3.28.\n\nFWIW, it looks like pthread.h includes sys/types.h which is where \npthread_rwlock_t is defined.\n\nFor my gcc 3.1 installation, sys/types.h is\n\n/usr/local/lib/gcc-lib/sparc-sun-solaris2.8/3.1/include/sys/types.h\n\nSorry, but I don't have any other ideas of what to look for.  If it\nwere me I'd play with the header files used by gcc until I figured out\nwhy the definition of pthread_rwlock_t wasn't getting picked up.\n\n", "id": 24471, "time": "2002-10-14T14:26:00Z", "bug_id": 13558, "creation_time": "2002-10-14T14:26:00Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 13558, "attachment_id": null, "id": 26637, "time": "2002-11-20T12:00:36Z", "creator": "trawick@apache.org", "creation_time": "2002-11-20T12:00:36Z", "is_private": false, "text": "submitter seems to have lost interest\n\nthis is surely a system/compiler setup problem anyway\n"}]