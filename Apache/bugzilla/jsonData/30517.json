[{"count": 0, "tags": [], "creator": "bluemoon@xs4all.nl", "is_private": false, "id": 61663, "creation_time": "2004-08-07T07:46:10Z", "time": "2004-08-07T07:46:10Z", "bug_id": 30517, "text": "1.There is some dead code in SignJar.java\n  In the method 'isSigned(File file)' there is the code :\n  if (null == alias) {\n      Enumeration entries = jarFile.entries();\n      while (entries.hasMoreElements()) {\n         String name = ((ZipEntry) entries.nextElement()).getName();\n         if (name.startsWith(SIG_START) && name.endsWith(SIG_END)) {\n              return true;\n         }\n     }\n     return false;\n   } \n \n   The 'alias' variable is a required attribute and can never be null at\n   this point. the code in the if statement is never executed and can be\n   removed.\n\n2. The detection of a file that is signed looks for the file \n   SIG_START + alias.toUpperCase() + SIG_END\n\n   it would be nice if the attribute 'internalsf' is set and 'sigfile'\n   is NOT set then : Set the attribute 'sigfile' to \"SIG_START + \n   alias.toUpperCase() + SIG_END\"", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 30517, "is_private": false, "id": 61664, "attachment_id": null, "creator": "bluemoon@xs4all.nl", "creation_time": "2004-08-07T08:23:14Z", "time": "2004-08-07T08:23:14Z", "text": "\nI was mistaken at point 2 !\nIf jarsigner is ordered to -internalsf it will create a sigfile\ndepending on the 'alias'. \n\nfrom the docs :\nIf no -sigfile option appears on the command line, the base file name for the\n.SF and .DSA files will be the first 8 characters of the alias name specified on\nthe command line, all converted to upper case.\n\nI had a alias name of 9 characters !! So the check in isSigned didn't work.\n\nPlease change code in 'ifSigned(File file)' to :\n   String entryName = SIG_START + alias.substring(0, 8).toUpperCase() + SIG_END;\n   return jarFile.getEntry(entryName) != null;\n\n\n"}, {"count": 2, "tags": [], "bug_id": 30517, "attachment_id": null, "text": "At least for JDK 1.4.2 the jarsigner tool does NOT convert the alias to upper \ncase, so if your alias contained any lowercase characters the isSigned test \nincorrectly returns false.\n", "id": 64690, "time": "2004-10-06T14:33:09Z", "creator": "mthornton@optrak.co.uk", "creation_time": "2004-10-06T14:33:09Z", "is_private": false}, {"count": 3, "tags": [], "creator": "bodewig@apache.org", "is_private": false, "text": "Hmm, Solaris/Linux version of J2SDK jarsigner tool docs say\n\nIf no -sigfile option appears on the command line, the base file name for the .SF\nand .DSA files will be the first 8 characters of the alias name specified on the\ncommand line, all converted to upper case. If the alias name has fewer than 8\ncharacters, the full alias name is used. If the alias name contains any characters\nthat are not allowed in a signature file name, each such character is converted to\nan underscore (\"_\") character in forming the file name. Legal characters include\nletters, digits, underscores, and hyphens.\n\n", "id": 66532, "time": "2004-11-05T15:47:56Z", "bug_id": 30517, "creation_time": "2004-11-05T15:47:56Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "bodewig@apache.org", "text": "Hmm, Solaris/Linux version of J2SDK jarsigner tool docs say\n\nIf no -sigfile option appears on the command line, the base file name for the .SF\nand .DSA files will be the first 8 characters of the alias name specified on the\ncommand line, all converted to upper case. If the alias name has fewer than 8\ncharacters, the full alias name is used. If the alias name contains any characters\nthat are not allowed in a signature file name, each such character is converted to\nan underscore (\"_\") character in forming the file name. Legal characters include\nletters, digits, underscores, and hyphens.\n\nThe Windows version says the same, BTW.\n\nMark, you didn't by any chance use WinZIP to check the file name case, did you?\n<http://ant.apache.org/faq.html#winzip-lies>", "id": 66533, "time": "2004-11-05T15:50:56Z", "bug_id": 30517, "creation_time": "2004-11-05T15:50:56Z", "is_private": false, "attachment_id": null}, {"count": 5, "attachment_id": null, "bug_id": 30517, "is_private": false, "id": 66549, "time": "2004-11-05T17:08:00Z", "creator": "apache@numerixtechnology.de", "creation_time": "2004-11-05T17:08:00Z", "tags": [], "text": "I don't think the change suggested by Kees Kuip\nString entryName = SIG_START + alias.substring(0, 8).toUpperCase() + SIG_END;\nis sufficient: The jar file might have been signed with -sigfile in which case\nthe base name of the SF file could be longer than 8 characters.\nYou need to check both for\nSIG_START + alias.substring(0, 8).toUpperCase() + SIG_END\nand \nSIG_START + alias.toUpperCase() + SIG_END;\n"}, {"count": 6, "tags": [], "bug_id": 30517, "text": "CVS HEAD now contains an <issigned> condition which should implement the test\ncorrectly - and <signjar> now uses this condition internally.\n\nCould you please download a nightly build of Ant of 2004-11-23 or later and try\nwhether the problem has been fixed by it?\n", "id": 67331, "attachment_id": null, "creator": "bodewig@apache.org", "creation_time": "2004-11-22T12:45:26Z", "time": "2004-11-22T12:45:26Z", "is_private": false}, {"count": 7, "tags": [], "text": "please reopen if the problem persists with Ant's next release.", "is_private": false, "id": 72217, "creator": "bodewig@apache.org", "time": "2005-03-11T17:16:31Z", "bug_id": 30517, "creation_time": "2005-03-11T17:16:31Z", "attachment_id": null}]