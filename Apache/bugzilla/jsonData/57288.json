[{"count": 0, "tags": [], "bug_id": 57288, "text": "I use POI read a excel template file, then fill in some data, saved.\nThen use jacob to SaveAs this excel file to pdf.\n\nExcel file only have date from A column to P column.\n\nBefore POI touch the excel file, jacob can SaveAs this excel property. Only fetch A~P column.\n\nAfter POI touch the excel file, jacob SaveAs fetch A~AC column which P ~ AC have not any data. This effect the context display in the left of pdf , the mostly is space on the right.", "id": 179377, "time": "2014-11-30T05:03:22Z", "creator": "chengongmo@gmail.com", "creation_time": "2014-11-30T05:03:22Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 57288, "text": "Can you share the file and some code that shows the problem?", "id": 179378, "time": "2014-11-30T06:50:54Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2014-11-30T06:50:54Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 57288, "text": "Created attachment 32242\nBefore POI Touch\n\nBefore POI Touch, Use jacob or directly use Microsoft Excel SaveAs , The result is same  refer this attach 'Before POI Touch'", "id": 179385, "time": "2014-12-01T02:14:05Z", "creator": "chengongmo@gmail.com", "creation_time": "2014-12-01T02:14:05Z", "is_private": false, "attachment_id": 32242}, {"count": 3, "tags": [], "bug_id": 57288, "text": "Created attachment 32243\nAfter POI Touch\n\nAfter POI touch , use jacob and Microsoft Excel do SaveAs to pdf , the result is same as this attchement . 'After POI Touch'", "id": 179386, "time": "2014-12-01T02:15:38Z", "creator": "chengongmo@gmail.com", "creation_time": "2014-12-01T02:15:38Z", "is_private": false, "attachment_id": 32243}, {"count": 4, "attachment_id": null, "bug_id": 57288, "text": "1. Below is the code, attach is before and after this code do SaveAs to pdf's result.\n\n\npublic static void generateReport( String reportFile, List<ExampleVO> voList) {\n\n\t\tInputStream in = null;\n\t\tFileOutputStream out = null;\n\t\ttry {\n\t\t\tin = Report.class.getResourceAsStream(\"/template.xls\");\n\t\t\tWorkbook workbook = WorkbookFactory.create(in);\n\t\t\tSheet sheet = workbook.getSheetAt(0);\n\t\t\tint rowNum ;\n\t\t\tif (null != voList) {\n\t\t\t\trowNum = 12;\n\t\t\t\tint sn = 1;\n\t\t\t\tfor (ExampleVO vo : voList) {\n\t\t\t\t\tint colNum = 2;\n\t\t\t\t\trow = sheet.createRow(rowNum++);\n\t\t\t\t\trow.createCell(colNum++).setCellValue(sn++);\n\t\t\t\t\trow.createCell(colNum++).setCellValue(vo.getAt()); // replace value to same for security\n\t\t\t\t\trow.createCell(colNum++).setCellValue(vo.getAt());\n\t\t\t\t\trow.createCell(colNum++).setCellValue(vo.getAt());\n\t\t\t\t\trow.createCell(colNum++).setCellValue(vo.getAt());\n\t\t\t\t\trow.createCell(colNum++).setCellValue(vo.getAt());\n\t\t\t\t\trow.createCell(colNum++).setCellValue(vo.getAt());\n\t\t\t\t\trow.createCell(colNum++).setCellValue(vo.getAt());\n\t\t\t\t\trow.createCell(colNum++).setCellValue(vo.getAt());\n\t\t\t\t\trow.createCell(colNum++).setCellValue(vo.getAt());\n\t\t\t\t\trow.createCell(colNum++).setCellValue(vo.getAt());\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tCellStyle cellStyle = workbook.createCellStyle();  \n\t\t\t\tcellStyle.setBorderBottom(CellStyle.BORDER_THIN);  \n\t\t\t\tcellStyle.setBorderLeft(CellStyle.BORDER_THIN);\n\t\t\t\tcellStyle.setBorderTop(CellStyle.BORDER_THIN);\n\t\t\t\tcellStyle.setBorderRight(CellStyle.BORDER_THIN);\n\t\t\t\tfor(int i = 12; i< rowNum; i++){\n\t\t\t\t\tfor(int j = 1; j< 16; j++){\n\t\t\t\t\t\tCell cell = sheet.getRow(i).getCell(j);\n\t\t\t\t\t\tif(null==cell){\n\t\t\t\t\t\t\tcell = sheet.getRow(i).createCell(j);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.setCellStyle(cellStyle);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tFile f = new File(reportFile);\n\t\t\tFileUtil.createFile(f);\n\t\t\tout = new FileOutputStream(f);\n\t\t\t//workbook.setPrintArea(0, \"$A$1:$Q$\" + rowNum);\n\t\t\tlogger.info(row.getLastCellNum()+\"\");\n\t\t\tworkbook.write(out);\n\t\t\tout.close();\n\t\t\tin.close();\n\t\t} catch (FileNotFoundException e) {\n\t\t\tlogger.error(\"File  XXX Not Found!\", e);\n\t\t} catch (IOException e) {\n\t\t\tlogger.error(e.getMessage(), e);\n\t\t} catch (InvalidFormatException e) {\n\t\t\tlogger.error(\"Template report file XXX invalid format\", e);\n\t\t}\n\n\t}", "id": 179387, "time": "2014-12-01T02:17:13Z", "creator": "chengongmo@gmail.com", "creation_time": "2014-12-01T02:17:13Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "bug_id": 57288, "text": "1.Confirm  is POI's problem, i use Java Excel API , works fine!\n\npublic static void generateAmSch001Report(String buName, String reportFile, List<ExampleVO> voList) {\n\t\tFile srcFile = new File(\"template.xls\");\n\t\tFile destFile = new File(\"destFile.xls\");\n\t\ttry {\n\t\t\tWorkbook wb = Workbook.getWorkbook(srcFile);\n\t\t\tWritableWorkbook wwb = Workbook.createWorkbook(destFile, wb); \n\t\t\tWritableSheet wws = wwb.getSheet(0);\n\t\t\tint rowNum = 9;\n\t\t\tif (null != voList) {\n\t\t\t\trowNum = 12;\n\t\t\t\tint sn = 1;\n\t\t\t\tWritableCellFormat wcs = new WritableCellFormat();\n\t\t\t\twcs.setBorder(jxl.format.Border.ALL, jxl.format.BorderLineStyle.THIN);\n\t\t\t\tfor (ExampleVO vo : voList) {\n\t\t\t\t\tint colNum = 1;\n\t\t\t\t\tlabel = new Label(colNum++, rowNum,  \"\", wcs);\n\t\t\t\t\twws.addCell(label);\n\t\t\t\t\tlabel = new Label(colNum++, rowNum,  sn + \"\", wcs);\n\t\t\t\t\twws.addCell(label);\n\t\t\t\t\tlabel = new Label(colNum++, rowNum,  vo.getAt(), wcs);\n\t\t\t\t\twws.addCell(label);\n\t\t\t\t\tlabel = new Label(colNum++, rowNum,  vo.getAt(), wcs);\n\t\t\t\t\twws.addCell(label);\n\t\t\t\t\tlabel = new Label(colNum++, rowNum,  vo.getAt(), wcs);\n\t\t\t\t\twws.addCell(label);\n\t\t\t\t\tlabel = new Label(colNum++, rowNum,  vo.getAt(), wcs);\n\t\t\t\t\twws.addCell(label);\n\t\t\t\t\tlabel = new Label(colNum++, rowNum,  vo.getAt(), wcs);\n\t\t\t\t\twws.addCell(label);\n\t\t\t\t\tlabel = new Label(colNum++, rowNum,  vo.getAt(), wcs);\n\t\t\t\t\twws.addCell(label);\n\t\t\t\t\tlabel = new Label(colNum++, rowNum,  vo.getAt(), wcs);\n\t\t\t\t\twws.addCell(label);\n\t\t\t\t\tlabel = new Label(colNum++, rowNum,  vo.getAt(), wcs);\n\t\t\t\t\twws.addCell(label);\n\t\t\t\t\tlabel = new Label(colNum++, rowNum,  vo.getAt(), wcs);\n\t\t\t\t\twws.addCell(label);\n\t\t\t\t\tlabel = new Label(colNum++, rowNum,  vo.getAt(), wcs);\n\t\t\t\t\twws.addCell(label);\n\t\t\t\t\tlabel = new Label(colNum++, rowNum,  \"\", wcs);\n\t\t\t\t\twws.addCell(label);\n\t\t\t\t\tlabel = new Label(colNum++, rowNum,  \"\", wcs);\n\t\t\t\t\twws.addCell(label);\n\t\t\t\t\trowNum++;\n\t\t\t\t\tsn++;\n\t\t\t\t}\n\t\t\t}\n\t\t\twwb.write(); \n\t\t\twwb.close();\n\t\t\twb.close();\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t} catch (RowsExceededException e) {\n\t\t\te.printStackTrace();\n\t\t} catch (WriteException e) {\n\t\t\te.printStackTrace();\n\t\t} catch (BiffException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}", "id": 179391, "time": "2014-12-01T06:25:19Z", "creator": "chengongmo@gmail.com", "creation_time": "2014-12-01T06:25:19Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "creator": "chengongmo@gmail.com", "attachment_id": 32244, "id": 179392, "time": "2014-12-01T06:49:16Z", "bug_id": 57288, "creation_time": "2014-12-01T06:49:16Z", "is_private": false, "text": "Created attachment 32244\nThe Reason\n\nI found the reason, because the row is too many,\nif only a few row , the result is fine!\n\nSo how to config?"}, {"id": 179393, "tags": [], "bug_id": 57288, "attachment_id": null, "count": 7, "text": "if too many rows , the Java Excel API also not function porperty.\n\nSo should be Excel's problem.", "time": "2014-12-01T06:50:26Z", "creator": "chengongmo@gmail.com", "creation_time": "2014-12-01T06:50:26Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 57288, "text": "iExcel.ActiveWorkbook.WorkSheets.Item[1].PageSetup.PrintArea = \"\"\niExcel.ActiveWorkbook.WorkSheets.Item[1].PageSetup.Zoom = false\niExcel.ActiveWorkbook.WorkSheets.Item[1].PageSetup.ScaleWithDocHeaderFooter = true\niExcel.ActiveWorkbook.WorkSheets.Item[1].PageSetup.PrintQuality = 600\niExcel.ActiveWorkbook.WorkSheets.Item[1].PageSetup.PaperSize = 8 //xlPaperA3\niExcel.ActiveWorkbook.WorkSheets.Item[1].PageSetup.Orientation = 2//xlLandscape\niExcel.ActiveWorkbook.WorkSheets.Item[1].PageSetup.FitToPagesWide = 1\niExcel.ActiveWorkbook.WorkSheets.Item[1].PageSetup.FitToPagesTall = 99\n\nIn .Net , Setting above parameter is ok , so this is not a problem.", "id": 179394, "time": "2014-12-01T06:57:59Z", "creator": "chengongmo@gmail.com", "creation_time": "2014-12-01T06:57:59Z", "is_private": false, "attachment_id": null}]