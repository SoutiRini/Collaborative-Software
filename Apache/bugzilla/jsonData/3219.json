[{"count": 0, "tags": [], "bug_id": 3219, "attachment_id": null, "text": "The pvcs does not create folders if they do not exist resulting in an error \nfrom pvcs get command.", "id": 4715, "time": "2001-08-22T01:06:40Z", "creator": "jvr@nykredit.dk", "creation_time": "2001-08-22T01:06:40Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 3219, "attachment_id": null, "text": "I believe this is the cause of the problem and the solution:\n\nThe createFolders(File) method in Pvcs.java needs to also recognise and process \nlines (in Windows) that use a drive mapping rather than a UNC name.\n\ne.g.\n\n\"V:\\SML PVCS Projects D to G\\archives\\eGI\\Implementation\\Iteration2\n\\Java\\startup\\BatchTestHarness\\DummyBatchManager.java-arc\n(c:\\Development_Build\\Implementation\\Java\\startup\\BatchTestHarness\\DummyBatchMan\nager.java)\"\n\nSo the section of code that decides whether to continue processing the line \nshould look something like this:\n\n            if(line.startsWith(\"\\\"\\\\\") ||\n               line.startsWith(\"\\\"/\") ||\n               (line.length() > 3 &&\n                line.startsWith(\"\\\"\") &&\n                Character.isLetter(line.charAt(1)) &&\n                String.valueOf(line.charAt(2)).equals(\":\") &&\n                String.valueOf(line.charAt(3)).equals(\"\\\\\")\n                )) {\n\nI compiled this code and put it into my copy of the jakarta-ant-1.4-\noptional.jar and all the required directories were created before the GETs were \nperformed.", "id": 5077, "time": "2001-09-03T22:53:13Z", "creator": "david.corbett@suncorpmetway.com.au", "creation_time": "2001-09-03T22:53:13Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 3219, "attachment_id": null, "is_private": false, "id": 7721, "time": "2001-11-09T08:05:07Z", "creator": "bodewig@apache.org", "creation_time": "2001-11-09T08:05:07Z", "text": "*** Bug 4743 has been marked as a duplicate of this bug. ***"}, {"count": 3, "tags": [], "creator": "bodewig@apache.org", "text": "*** Bug 4346 has been marked as a duplicate of this bug. ***", "id": 7723, "time": "2001-11-09T08:06:58Z", "bug_id": 3219, "creation_time": "2001-11-09T08:06:58Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 3219, "is_private": false, "text": "The tip pvcs.java includes a similar change, and a number of others.  It didn't\nget into 1.4.1", "id": 8032, "time": "2001-11-18T06:45:26Z", "creator": "snewton@io.com", "creation_time": "2001-11-18T06:45:26Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 8885, "time": "2001-12-13T01:13:33Z", "bug_id": 3219, "creation_time": "2001-12-13T01:13:33Z", "is_private": false, "text": "Could somebody of the original bug reports please try a recent nightly build\n(after 2001-09-07) and close this bug if it indeed has been fixed (no PVCS to \ntry, sorry)."}, {"count": 6, "tags": [], "bug_id": 3219, "attachment_id": null, "id": 10889, "time": "2002-02-19T12:55:06Z", "creator": "bodewig@apache.org", "creation_time": "2002-02-19T12:55:06Z", "is_private": false, "text": "I assume the problem has been fixed in CVS, please reopen the bug if I'm wrong."}, {"count": 7, "tags": [], "bug_id": 3219, "text": "I am using 1.5alpha and the problem still exists.\n\n<target name=\"get_latest_source\" depends=\"create_dirs\">\n   <pvcs repository=\"Q:/rep/loc\" pvcsproject=\"/prj/myprj\" rid=\"jtrust\"/> \n</target>\n\n[pvcs] get: error, \"c:/dev/prj/myprj/com/company\" is not a directory.\nfor each file", "id": 11030, "time": "2002-02-21T16:16:43Z", "creator": "jtrust@ctpartners.com", "creation_time": "2002-02-21T16:16:43Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 3219, "attachment_id": null, "id": 11039, "time": "2002-02-21T16:33:21Z", "creator": "doug.scurr@retek.com", "creation_time": "2002-02-21T16:33:21Z", "is_private": false, "text": "We are using 1.4.1 & the problem stills exists? Looks like someone said it's in \n1.5 too.....anyone know how to get around this problem? Is there a patch \navailable for 1.4.1??"}, {"count": 9, "tags": [], "creator": "shartman@webconclave.com", "text": "Created attachment 1661\nupdated pvcs.java to correctly create folders", "id": 14329, "time": "2002-04-22T16:45:47Z", "bug_id": 3219, "creation_time": "2002-04-22T16:45:47Z", "is_private": false, "attachment_id": 1661}, {"count": 10, "tags": [], "bug_id": 3219, "attachment_id": null, "text": "Attached is a new pvcs.java file, which corrected the problem with fetching \nthe folder structure of the pvcs projects.", "id": 14331, "time": "2002-04-22T16:47:58Z", "creator": "shartman@webconclave.com", "creation_time": "2002-04-22T16:47:58Z", "is_private": false}, {"count": 11, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 14400, "time": "2002-04-23T06:54:48Z", "bug_id": 3219, "creation_time": "2002-04-23T06:54:48Z", "is_private": false, "text": "Shane, I've just downloaded you new Pvcs.java and compared it to the one in\ncurrent Ant's CVS.  There are some differences in white space (no big deal) and\nthe license header is missing from your version (no big deal either).\n\nApart from that, I found exactly two differences, but maybe I've not been looking\nhard enough:\n\n(1) The if statement around line 249 in your code.  I'm not familiar with\nPVCS at all, but too me it looks as if you had just disabled the linestart\nattribute of the task and replaced it by an accept all drive letters policy.\nHow does that fix the problem?  Why can't we keep the linestart attribute?\nWe probably should document it though 8-)\n\n(2) The very last line that is non blank and not a closing brace.  You use -arc\nwhile the current CVS version uses _arc.  This reverts part of a patch by Steve\nNewton that was thought to address this bug here.\n\n"}, {"count": 12, "tags": [], "creator": "shartman@webconclave.com", "text": "Stefan,\n The things I added were the if statement with the linestart that was suggested \nby David C. the reason for this is when PVCS is installed in Windows it is \naccess through a drive letter not a mount point and needs to understand what is \npasses in. The other part that was changed as you pointed out was the _arc to -\narc, the reason for this was because all the items that are checked in to a the \nrespository have a -arc extension. This maybe different with PVCS and the UNIX \nenvironment, I do not have access to that to test.", "id": 14449, "time": "2002-04-23T13:47:55Z", "bug_id": 3219, "creation_time": "2002-04-23T13:47:55Z", "is_private": false, "attachment_id": null}, {"count": 13, "tags": [], "creator": "amezick@edgil.com", "text": "Example output from ant -v when this happens:\n     [pvcs] Creating folders\n     [pvcs] Considering \"\"V:\\Guidestar\\archives\\batchconfig\\GifSFLMailBatchJob.p\nroperties-arc(S:\\GuideStar\\PVCS\\batchconfig\\GifSFLMailBatchJob.properties)\"\"\n     [pvcs] Skipped \"\"V:\\Guidestar\\archives\\batchconfig\\GifSFLMailBatchJob.prope\nrties-arc(S:\\GuideStar\\PVCS\\batchconfig\\GifSFLMailBatchJob.properties)\"\"\n     [pvcs] Getting files\n     [pvcs] Executing get -Y -rLatest @S:\\\\pvcs_ant_-261753747147982289.log\n     [pvcs] PVCS Version Manager (get) v6.7.10 (Build 915) for Windows NT/80x86\n     [pvcs] Copyright 1985-2001 MERANT.  All rights reserved.\n     [pvcs] get: error, \"S:/GuideStar/PVCS/batchconfig\" is not a directory.\n     [pvcs] get: error, \"S:/GuideStar/PVCS/batchconfig\" is not a directory.", "id": 16492, "time": "2002-05-21T18:44:40Z", "bug_id": 3219, "creation_time": "2002-05-21T18:44:40Z", "is_private": false, "attachment_id": null}, {"count": 14, "tags": [], "bug_id": 3219, "attachment_id": null, "id": 16499, "time": "2002-05-21T19:26:11Z", "creator": "amezick@edgil.com", "creation_time": "2002-05-21T19:26:11Z", "is_private": false, "text": "My version also uses -arc"}, {"count": 15, "tags": [], "creator": "snewton@io.com", "text": "Check out the filenameFormat attribute of the task.  Many shops use -arc, some\nuse _arc, and others use a different format altogether.  Rather than thrashing\nback and forth about it, we should strive retain backwards compatibility and\nencourage the use of filenameFormat for shops (like mine) that use something\ndifferent.\n", "id": 17211, "time": "2002-06-05T18:59:37Z", "bug_id": 3219, "creation_time": "2002-06-05T18:59:37Z", "is_private": false, "attachment_id": null}, {"count": 16, "tags": [], "bug_id": 3219, "attachment_id": null, "id": 17647, "time": "2002-06-12T12:02:05Z", "creator": "bodewig@apache.org", "creation_time": "2002-06-12T12:02:05Z", "is_private": false, "text": "OK, I'm still trying to understand all this (without knowing anything about PVCS,\nmind you).\n\nIf you go and set the linestart attribute to \"&quot;S:\" and the filenameformat\nto \"{0}-arc({1})\" it is going to work for Angus.  Jason would need Q instead of\nS and David needs C - right?\n\nI've added description for these two attributes to the documentation, they read:\n\nfilenameformat\n  The format of your folder names in a\n  format suitable for java.text.MessageFormat.\n  Index 1 of the format will be used as the file name.\n  Defaults to {0}_arc({1}).\n\nlinestart\n  What a valid return value from PVCS looks like\n  when it describes a file.  Defaults to &quot;P:.\n  If you are not using an UNC name for your repository and the\n  drive letter P is incorrect for your setup, you may\n  need to change this value, UNC names will always be\n  accepted.\n\nDoes that make any sense?"}, {"count": 17, "tags": [], "creator": "bodewig@apache.org", "text": "I'll also change the default for filenameformat to the old version (with - instead\nof _) to be backwards compatible with Ant 1.4.1.", "id": 17659, "time": "2002-06-12T13:41:05Z", "bug_id": 3219, "creation_time": "2002-06-12T13:41:05Z", "is_private": false, "attachment_id": null}, {"count": 18, "tags": [], "creator": "snewton@io.com", "text": "To clarify for Stefan: the pvcs task has 2 steps for a checkout 1) it asks pvcs\nfor a list of all the files in a project, 2) is iterates through the results and\ndoes a GET for each one.*  The results of step 1) are lines the look like this\n(for me):\n\n\"P:\\pvcs\\develop\\dev_db\\archives\\Custom Shared Components\\Java\\SIC\\framework\\lib\n\\turbine-pool.jar_v(C:\\safti\\lib\\turbine-pool.jar)\" \n\nplus some other gunk.\n\nthe two things that can vary are the initial 1 or 2 characters of a line,\noriginally just / or \\\\ but I added in the ability to recognize any string with\nthe linestart attribute and set it to \"P, which in xml is &quot;P.  The archive\nsuffix at my company is _v, but the original code had it as _arc, the default\nwhich is retained for backwards compatiblity, and some people use -arc.  So the\nfilenameFormat is {0}_arc({1}) and MessageFormat uses that to parse the lines above.\n\nSo in otherwords, the default is:\n\nP:\\path\\to\\archive_arc(workfile\\path)\n\nand the slashes can be either forward or backward, it's irrelevant.\n\nIf your repository is on a drive other than P:, change lineStart.  If your\nrepository suffix is something other than _arc, change filenameFormat.\n\nClear as mud?\n\n*Don't ask me why pvcs is this way.  I use it, but it's by far the clunkiest\nversion control system I've ever used.", "id": 17669, "time": "2002-06-12T14:42:05Z", "bug_id": 3219, "creation_time": "2002-06-12T14:42:05Z", "is_private": false, "attachment_id": null}, {"count": 19, "tags": [], "bug_id": 3219, "attachment_id": null, "id": 18706, "time": "2002-06-28T07:32:15Z", "creator": "bodewig@apache.org", "creation_time": "2002-06-28T07:32:15Z", "is_private": false, "text": "*** Bug 10289 has been marked as a duplicate of this bug. ***"}, {"count": 20, "tags": [], "bug_id": 3219, "attachment_id": 2241, "text": "Created attachment 2241\njavadoc patch to explain filenameFormat and lineStart properties", "id": 18878, "time": "2002-07-02T20:13:53Z", "creator": "snewton@io.com", "creation_time": "2002-07-02T20:13:53Z", "is_private": false}, {"count": 21, "tags": [], "bug_id": 3219, "attachment_id": null, "id": 19003, "time": "2002-07-04T11:39:45Z", "creator": "bodewig@apache.org", "creation_time": "2002-07-04T11:39:45Z", "is_private": false, "text": "OK, I think we can close this now and tell people to use the two (now properly\ndocumented) attributes of the task."}, {"count": 22, "tags": [], "bug_id": 3219, "attachment_id": null, "text": "*** Bug 10676 has been marked as a duplicate of this bug. ***", "id": 19311, "time": "2002-07-11T09:48:39Z", "creator": "bodewig@apache.org", "creation_time": "2002-07-11T09:48:39Z", "is_private": false}, {"count": 23, "tags": [], "bug_id": 3219, "text": "The way, you solved this problem now, looks for me as a kind of workaround.\n\nThe thing with the endings (-arc, -v, _arc, ....) seems to be ok for me, \nbecause these are parameter to be set once for the project database(s).\n\nBut the detection of the windows/dos-style path in the string should be done \nautomatic in the way David Corbett described it (on 2001-09-03), so I do not \nhave to create two build.xml files, because two people have mapped the \nfilesystem for the project database to different drive letters.\n\nFor backward compatibility the parameter linestart could be kept.\n", "id": 19315, "attachment_id": null, "creator": "joerg.friebel@retail-sc.com", "creation_time": "2002-07-11T11:59:54Z", "time": "2002-07-11T11:59:54Z", "is_private": false}, {"count": 24, "tags": [], "bug_id": 3219, "attachment_id": null, "id": 20591, "time": "2002-08-02T02:54:14Z", "creator": "david.corbett@suncorpmetway.com.au", "creation_time": "2002-08-02T02:54:14Z", "is_private": false, "text": "The line.startsWith(getLineStart()) check that has been introduced to the \ncreateFolders(File) method does not work when the PVCS project has some \narchives defined with an uppercase drive letter mapping (e.g. \"V:) and some \narchives that have been created with a lowercase drive mapping (e.g. \"v:).\n\nIn this case if the linestart parameter for the Pvcs task is set\nto \"V: (linestart=\"&quot;V:\") in the build file, then any archives that have \nbeen created using the lowercase drive mapping v: will return false for \nline.startsWith(getLineStart()) as startsWith is case sensitive. This of course\nmeans that folders for these archives will not be created but folders for \narchives created using the uppercase V: drive mapping will be created.\n\nI have this exact scenario occurring for the PVCS projects with which I work.\n\nTo fix this problem, either this checking should be made case insensitive or \nthe code should be changed to something like my original posting on 2001-09-03 \nwhereby it only checks to see that the line has a drive letter at the start and \ndoes not matter if it is upper or lowercase and does not matter what drive \nletter is used (see comments by Jorg Friebel on 2002-07-11)."}, {"count": 25, "attachment_id": null, "bug_id": 3219, "text": "I have no problem with making the change to accept paths with any alpha followed\nby a colon.  It's really a cleaner solution than lineStart.  Would this change\naffect backwards compatibility with the default of P:?", "id": 20614, "time": "2002-08-02T15:21:48Z", "creator": "snewton@io.com", "creation_time": "2002-08-02T15:21:48Z", "tags": [], "is_private": false}, {"count": 26, "attachment_id": null, "bug_id": 3219, "is_private": false, "id": 20666, "time": "2002-08-05T18:48:01Z", "creator": "roberta_yusba@tesseract.com", "creation_time": "2002-08-05T18:48:01Z", "tags": [], "text": "I got the fix for 1.4 months ago, and managed to get an optional.jar with the \nnew pvcs.class in it - but now I have 1.5 and the problem is back!  So I'm \nhaving to do the extract with 1.4 and the build with 1.5 (to get the new \nsourcepath property of javac).  It would be better to have the not-so-perfect \nfix in 1.5 than to have it as it was before the fix...no?  :-)\nthanks for the work you guys do,\nRoberta\n\n"}, {"count": 27, "tags": [], "bug_id": 3219, "is_private": false, "text": "Just now got around to testing this.  The patch submitted by Shane Hartman on\n2002-04-22 works well and is a better solution to the filename recognition than\nlineStart.  Perhaps the only changed I'd make is to move all the code for doing\nthe various tests from the beginning of createFolders into a separate method\nthat returns a boolean.  It makes createFolders cleaner and it opens up the\npossibility of using that logic for other kinds of pvcs tasks.", "id": 23002, "time": "2002-09-17T19:56:19Z", "creator": "snewton@io.com", "creation_time": "2002-09-17T19:56:19Z", "attachment_id": null}, {"count": 28, "tags": [], "creator": "snewton@io.com", "text": "*** Bug 15917 has been marked as a duplicate of this bug. ***", "id": 29079, "time": "2003-01-09T17:00:27Z", "bug_id": 3219, "creation_time": "2003-01-09T17:00:27Z", "is_private": false, "attachment_id": null}, {"count": 29, "tags": [], "creator": "conor@apache.org", "text": "I've committed Shane Hartman's changes. I'm going to close this as fixed. Can\nyou all please test the next nightly build and let me know if there is still an\nissue.\n\nI've marked this as a 1.6 bug but I'll probably be able to merge to 1.5.2 as well.", "id": 29580, "time": "2003-01-17T02:21:21Z", "bug_id": 3219, "creation_time": "2003-01-17T02:21:21Z", "is_private": false, "attachment_id": null}, {"count": 30, "tags": [], "bug_id": 3219, "is_private": false, "id": 29617, "attachment_id": null, "creator": "snewton@io.com", "creation_time": "2003-01-17T16:28:54Z", "time": "2003-01-17T16:28:54Z", "text": "Works great for me!"}, {"count": 31, "tags": [], "bug_id": 3219, "attachment_id": null, "text": "Will be available in 1.5.2", "id": 29702, "time": "2003-01-20T12:43:34Z", "creator": "conor@apache.org", "creation_time": "2003-01-20T12:43:34Z", "is_private": false}]