[{"count": 0, "tags": [], "bug_id": 49183, "text": "There is a lone \"eval\" towards the end of setclasspath.sh:\n\nif [ ! -x \"$BASEDIR\"/bin/setclasspath.sh ]; then\n  if $os400; then\n    # -x will Only work on the os400 if the files are:\n    # 1. owned by the user\n    # 2. owned by the PRIMARY group of the user\n    # this will not work if the user belongs in secondary groups\n    eval\n  else\n\nThe \"eval\" line looks a bit odd.\n\nAlso, surely the setclasspath.sh file does not have to be executable (though of course it may be) so would it not be just as effective to check if the file is present? That might avoid the need to check for os400.", "id": 136393, "time": "2010-04-24T21:57:24Z", "creator": "sebb@apache.org", "creation_time": "2010-04-24T21:57:24Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 49183, "text": "See the svn history for why. Since someone who has access to os400 provided the patch and I don't have access to that OS to test any changes, I am not going to second guess them because something looks 'odd'.\n\n\"If it ain't broke, don't fix it.\"", "id": 136396, "time": "2010-04-25T08:40:15Z", "creator": "markt@apache.org", "creation_time": "2010-04-25T08:40:15Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "sebb@apache.org", "attachment_id": null, "is_private": false, "id": 136401, "time": "2010-04-25T10:15:21Z", "bug_id": 49183, "creation_time": "2010-04-25T10:15:21Z", "text": "I've had a look at the svn history for the file in Tomcat7 and Tomcat6 - in both cases the file was added with the code already there.\n\nHowever, I eventually found the change, which was:\n\nr303487 17/11/04 yoavs Bugzilla 31132: better -x/-r handling for OS/400 in startup scripts.\n\nNow the text of the bug does NOT include the eval, whereas the patch does.\nSo it looks to me as if the eval is probably spurious.\n\nIn any case, I think it would be helpful to provide a link to the Bugzilla issue in case the question comes up again later. \n\nThe existing comment is incomplete, because -r is also affected by the same problem.\n\nDocn patch to follow."}, {"count": 3, "tags": [], "bug_id": 49183, "attachment_id": null, "text": "The alone \"eval\" makes perfect sense to me.\nIt is a noop operation that is needed there to be between 'then' and 'else'.\nSee e.g. the ':' operation aka colon in POSIX shell:\nhttp://www.opengroup.org/onlinepubs/009695399/utilities/colon.html\n\ncatalina.sh and tool-wrapper.sh do a check for \"-r setclasspath.sh\", so we can do the same here, though I doubt that this difference is of any practical importance.", "id": 136403, "time": "2010-04-25T23:07:58Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2010-04-25T23:07:58Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 49183, "text": "As per Konstantin's comment, the eval is required.\n\n-x rather than -r is bug 12056 / r303035.", "id": 136408, "time": "2010-04-26T04:53:04Z", "creator": "markt@apache.org", "creation_time": "2010-04-26T04:53:04Z", "is_private": false, "attachment_id": null}]