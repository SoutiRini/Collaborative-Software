[{"count": 0, "tags": [], "bug_id": 46122, "is_private": false, "text": "Created attachment 22790\nThe .ppt file that causes all this mess\n\nHello I'm currently using Apache POI HSLF to convert in application to convert flowchart Powerpoint files (.ppt) into .png image files. It works ok, normally, without arrows usually, but I found a new crash while converting a .ppt file.\nI have no idea why this is happening.\n\nThe sentence that throws NullPointerException is:\n/* Code Start */\nFileInputStream is = new FileInputStream(\"greenpe.ppt\");\nSlideShow ppt = new SlideShow (is);\nis.close();\nDimension pgsize = ppt.getPageSize();\nSlide[] slide = ppt.getSlides();\nfor (int i = 0; i < slide.length; i++) { \n   BufferedImage img = new BufferedImage(pgsize.width, pgsize.height, BufferedImage.TYPE_INT_RGB);\n   Graphics2D graphics = img.createGraphics();\n   graphics.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);\n   graphics.setRenderingHint(RenderingHints.KEY_RENDERING, RenderingHints.VALUE_RENDER_QUALITY);\n   graphics.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BICUBIC);\n   graphics.setRenderingHint(RenderingHints.KEY_FRACTIONALMETRICS, RenderingHints.VALUE_FRACTIONALMETRICS_ON);\n   graphics.setPaint(Color.white);\n   graphics.fill(new Rectangle2D.Float(0, 0, pgsize.width, pgsize.height));\n\n   Slide s = slide[i];\n   \n   try   {\t\n       s.draw(graphics);\n   } catch (NullPointerException e) {\n       e.printStackTrace;\n   }\n/* Code Finish */\n\n\nThis is the stack trace:\nStackTrace: java.lang.NullPointerException\n\tat org.apache.poi.hslf.model.Picture.getEscherBSERecord(Picture.java:200)\n\tat org.apache.poi.hslf.model.Picture.getPictureData(Picture.java:180)\n\tat org.apache.poi.hslf.model.Picture.draw(Picture.java:265)\n\tat org.apache.poi.hslf.model.ShapeGroup.draw(ShapeGroup.java:280)\n\tat org.apache.poi.hslf.model.Slide.draw(Slide.java:431)\n\tat ... (...MyComponent.java:381)\n\n\nAny idea? Thanks", "id": 122001, "time": "2008-10-29T11:43:27Z", "creator": "greenpe@gmail.com", "creation_time": "2008-10-29T11:43:27Z", "attachment_id": 22790}, {"count": 1, "tags": [], "bug_id": 46122, "is_private": false, "text": "Fixed in r710114\n\nOne of the shapes has type=Picture but the reference to picture data is invalid. I fixed Picture.draw to skip rendering of such \"invalid\" pictures. \n\nYegor ", "id": 122147, "time": "2008-11-03T09:57:47Z", "creator": "yegor@dinom.ru", "creation_time": "2008-11-03T09:57:47Z", "attachment_id": null}]