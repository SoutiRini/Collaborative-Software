[{"count": 0, "tags": [], "bug_id": 33640, "attachment_id": null, "text": "If a HttpServletRequestWrapper overrides the getServletPath() method to return\nit's own value, a RequestDispatcher.forward will forward to that resource, even\nwhen obtaining the RequestDispatcher with getRequestDispatcher(String). I\nbelieve the servlet spec says that it should forward to the resource specified\nin getRequestDispatcher.\n\nThis also occurs on the latest Tomcat 4 - should I open a bug there too?", "id": 71202, "time": "2005-02-18T18:05:21Z", "creator": "mtraum@yahoo.com", "creation_time": "2005-02-18T18:05:21Z", "is_private": false}, {"count": 1, "attachment_id": 14316, "bug_id": 33640, "text": "Created attachment 14316\nSimple war file displaying the problem", "id": 71203, "time": "2005-02-18T18:06:42Z", "creator": "mtraum@yahoo.com", "creation_time": "2005-02-18T18:06:42Z", "tags": [], "is_private": false}, {"count": 2, "text": "Please explain the problem better.", "bug_id": 33640, "attachment_id": null, "id": 71205, "time": "2005-02-18T18:09:09Z", "creator": "remm@apache.org", "creation_time": "2005-02-18T18:09:09Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 33640, "text": "I'm not sure how to describe it better. Will the attached .war file (a very\nsimple application made to display this problem) not suffice?", "id": 71207, "time": "2005-02-18T18:12:49Z", "creator": "mtraum@yahoo.com", "creation_time": "2005-02-18T18:12:49Z", "is_private": false, "attachment_id": null}, {"count": 4, "text": "Cool, but I think it happens because the request, which is mapped to the Jasper\nservlet (*.jsp) will look at the servlet path to decide which JSP to serve.\nSince your wrapper will still be at the top of the wrapper \"stack\" after the\nforward as per the spec (this is so that wrapping is actually useful), the path\nspecified in the wrapper will be used.", "bug_id": 33640, "attachment_id": null, "id": 71211, "time": "2005-02-18T18:21:13Z", "creator": "remm@apache.org", "creation_time": "2005-02-18T18:21:13Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "id": 71212, "time": "2005-02-18T18:21:40Z", "bug_id": 33640, "creation_time": "2005-02-18T18:21:40Z", "is_private": false, "text": "The case is much simpler than what I though, so it is enough."}, {"count": 6, "text": "But SRV.14.2.8 states:\nServletContext.getRequestDispatcher(String)\n\"Returns a RequestDispatcher object that acts as a wrapper for the resource\nlocated at the given path. A RequestDispatcher object can be used to forward a\nrequest to the resource or to include the resource in a response. The resource\ncan be dynamic or static.\"\n\nDoesn't that state the it should forward to the String specified in\ngetRequestDispatcher(String)?\n\nAlso, SRV.14.2.5 states:\nRequestDispatcher.forward(ServletRequest, ServletResponse)\n\"For a RequestDispatcher obtained via getRequestDispatcher(), the ServletRequest\nobject has its path elements and parameters adjusted to match the path of the\ntarget resource.\"\n\nAre you saying there's a conflict elsewhere in the spec?\n", "bug_id": 33640, "attachment_id": null, "id": 71214, "time": "2005-02-18T18:38:38Z", "creator": "mtraum@yahoo.com", "creation_time": "2005-02-18T18:38:38Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "bug_id": 33640, "text": "I suggest you read my answer.\n\nHere it is another way:\n- /uri.jsp maps to Jasper *.jsp\n- Request is fowarded to the JSP servlet\n- Your wrapper is the top of the wrapper stack (will be called first by Jasper)\n- The main Jasper servlet uses getServletPath to determine which JSP it should send\n\nWorkaround: precompile (this maps your individual JSPs as servlets, and avoids\nJasper).\n\nPlease do not reopen the report, or I'll close the report again without any\nfurther comments.", "id": 71215, "time": "2005-02-18T18:53:21Z", "creator": "remm@apache.org", "creation_time": "2005-02-18T18:53:21Z", "is_private": false, "attachment_id": null}]