[{"count": 0, "tags": [], "bug_id": 60288, "text": "Created attachment 34395\nTest Case\n\nThis was found through adding 2000 images to a sheet via org.apache.poi.xssf.usermodel.XSSFWorkbook#addPicture(byte[], int).  This isn't the only path to findExistingRelation so there's likely more ways to hit this issue. Attached is a test case which exercises this path.\n\nThe source of the quadratic slowdown comes from the defensive copy we do in org.apache.poi.openxml4j.opc.PackagePart#getRelationships. In findExistingRelation we iterate over this copy, and for each element we end up incurring another defensive copy via getRelatedPart->isRelationshipExists.\n\nI can't see a clear reason why org.apache.poi.openxml4j.opc.PackagePart#isRelationshipExists should create a copy of _relationships, since we're not leaking them - just returning a boolean. Using the field directly solves my issue and won't have any functional impact as we're not filtering at this stage.", "id": 194605, "time": "2016-10-21T06:23:57Z", "creator": "tim.helmstedt@trademark.vision", "creation_time": "2016-10-21T06:23:57Z", "is_private": false, "attachment_id": 34395}, {"text": "Fixed in https://github.com/apache/poi/pull/38 not sure the usual way to get commit access.", "tags": [], "bug_id": 60288, "attachment_id": null, "count": 1, "id": 194607, "time": "2016-10-21T06:32:25Z", "creator": "tim.helmstedt@trademark.vision", "creation_time": "2016-10-21T06:32:25Z", "is_private": false}, {"count": 2, "tags": [], "creator": "onealj@apache.org", "attachment_id": null, "id": 194610, "time": "2016-10-21T07:35:46Z", "bug_id": 60288, "creation_time": "2016-10-21T07:35:46Z", "is_private": false, "text": "Thanks for finding this performance inefficiency and submitting a patch. Applied in r1765935. These changes will be included in 3.16 beta 1.\n\nPull requests are fine.[1]\n\n[1] https://poi.apache.org/guidelines.html#SubmittingPatches"}]