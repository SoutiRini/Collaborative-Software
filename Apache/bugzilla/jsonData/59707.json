[{"count": 0, "tags": [], "creator": "rbidet@ribics.fr", "text": "Hi all,\n\nFirst of all, many thanks for this amazing library.\n\nI'm trying to create a new line in a cell by reading a file.\nI've implemented the sample https://poi.apache.org/spreadsheet/quick-guide.html#NewLinesInCells that works fine.\n\nI've modified the code in order to read an external file with the same content, and the \\n is written in the file instead of having a new line.\n\n{code}\n    public static void readTextFile() {\n        BufferedReader br = null;\n        ;\n        try {\n            br = new BufferedReader(new FileReader(\"C:/tmp/toto.txt\"));\n            String fileLine = \"\";\n            String excelFileName = \"C:/tmp/Test.xlsx\";// name of excel file\n\n            String sheetName = \"Sheet1\";// name of sheet\n\n            XSSFWorkbook wb = new XSSFWorkbook();\n            XSSFSheet sheet = wb.createSheet(sheetName);\n            while ((fileLine = br.readLine()) != null) {\n                System.out.println(fileLine);\n                Row row = sheet.createRow(2);\n                Cell cell = row.createCell(2);\n                cell.setCellValue(fileLine);\n                // to enable newlines you need set a cell styles with wrap=true\n                CellStyle cs = wb.createCellStyle();\n                cs.setWrapText(true);\n                cell.setCellStyle(cs);\n\n            }\n            FileOutputStream fileOut = new FileOutputStream(excelFileName);\n\n            // write this workbook to an Outputstream.\n            wb.write(fileOut);\n            fileOut.flush();\n            fileOut.close();\n            br.close();\n        } catch (IOException ioe) {\n            ioe.getMessage();\n        }\n    }\n{code}\n\nMy file contains only :\nUse \\n with word wrap on to create a new line\n\nI've tried with new XSSFRichTextString(fileLine), but the \\n is still present in the xlsx file.\n\nDo i miss something ? Is it a bug ?\n\nThank you in advance for your replies and/or correction.\n\nRich.", "id": 191676, "time": "2016-06-15T13:48:30Z", "bug_id": 59707, "creation_time": "2016-06-15T13:48:30Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "text": "Can you attach the toto.txt-file?", "is_private": false, "bug_id": 59707, "id": 192637, "time": "2016-07-26T05:40:27Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-07-26T05:40:27Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 59707, "is_private": false, "id": 193088, "creation_time": "2016-08-13T21:03:31Z", "time": "2016-08-13T21:03:31Z", "creator": "dominik.stadler@gmx.at", "text": "No update on the question and I don't think we would be handling a literal \\n as newline anywhere in POI.\n\nIf this is still a problem for you then please reopen this bug with some more information, ideally a self-contained unit-test that shows the problem that you are facing.", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 59707, "is_private": false, "text": "Created attachment 34159\ntest file\n\nThe test file i've used.", "id": 193172, "time": "2016-08-18T13:42:04Z", "creator": "rbidet@ribics.fr", "creation_time": "2016-08-18T13:42:04Z", "attachment_id": 34159}, {"count": 4, "tags": [], "text": "Hi Dominik, \n\nSorry for the delay, i was on holidays.\n\nI've attached my test file (toto.txt).\nI'm a bit surprised about your last response \"I don't think we would be handling a literal \\n as newline anywhere in POI.\"\n\nIt's part of the sample https://poi.apache.org/spreadsheet/quick-guide.html#NewLinesInCells\n\nLet me know if i can help or need further details.\nRich.", "attachment_id": null, "bug_id": 59707, "id": 193173, "time": "2016-08-18T13:46:38Z", "creator": "rbidet@ribics.fr", "creation_time": "2016-08-18T13:46:38Z", "is_private": false}, {"count": 5, "tags": [], "creator": "markbrdsly@tiscali.co.uk", "attachment_id": null, "id": 193178, "time": "2016-08-18T15:43:35Z", "bug_id": 59707, "creation_time": "2016-08-18T15:43:35Z", "is_private": false, "text": "The \\n sequence is an escape sequence that is interpreted to mean a new line when it - the escape sequence - a[pears in a Java string. The example in the Quick Guide uses Java to create the sheet/row/cell and populate it. I suspect this is not what you are doing, rather you are reading from an existing file and attempting to modify it.\n\nAm I correct in assuming that you have a test file that you have created using Excel? Further, that this file contains a cell into which you have written the string? If that is correct, then you never will see a new line. To create a new line in a cell using Excel itself then you need to press and hold down the Alt key and then press the enter key."}, {"count": 6, "tags": [], "creator": "rbidet@ribics.fr", "attachment_id": null, "id": 193180, "time": "2016-08-18T15:47:59Z", "bug_id": 59707, "creation_time": "2016-08-18T15:47:59Z", "is_private": false, "text": "Hi Mark,\n\nMy testFile is a just a plain text file containing the same string that the sample.\n\nIf i use :\nCell cell = row.createCell(2);\ncell.setCellValue(\"Use \\n with word wrap on to create a new line\");\n\n=> This create"}, {"count": 7, "attachment_id": null, "creator": "rbidet@ribics.fr", "is_private": false, "id": 193181, "time": "2016-08-18T15:50:39Z", "bug_id": 59707, "creation_time": "2016-08-18T15:50:39Z", "tags": [], "text": "[...] This create a new line.\n\nIf i'm using the same thing but via a BufferedReader, it doesn't create the new line, that correspond to the ALT+Enter combination key.\n\nSorry for the 2 comments, i submitted the first too quickly.\n\nThank for helping."}, {"count": 8, "tags": [], "text": "(In reply to Mark B from comment #5)\n> The \\n sequence is an escape sequence that is interpreted to mean a new line\n> when it - the escape sequence - a[pears in a Java string. The example in the\n> Quick Guide uses Java to create the sheet/row/cell and populate it. I\n> suspect this is not what you are doing, rather you are reading from an\n> existing file and attempting to modify it.\n> \n> Am I correct in assuming that you have a test file that you have created\n> using Excel? Further, that this file contains a cell into which you have\n> written the string? If that is correct, then you never will see a new line.\n> To create a new line in a cell using Excel itself then you need to press and\n> hold down the Alt key and then press the enter key.\n\nIn addition, my test file wasn't created with Excel but via the POI library :\n XSSFWorkbook wb = new XSSFWorkbook();\n XSSFSheet sheet = wb.createSheet(sheetName);\n\nSo it's a brand new one, and i'm trying to create a cell (via the POI library), and to populate this cell with the content of a plain text file.\nIt works great, except for the lines that contains \\n\nThe cell.setCellValue(fileLine); write the \\n instead of creating a new line.", "attachment_id": null, "bug_id": 59707, "id": 193182, "time": "2016-08-18T15:57:28Z", "creator": "rbidet@ribics.fr", "creation_time": "2016-08-18T15:57:28Z", "is_private": false}, {"count": 9, "tags": [], "text": "I suspect that you will need to escape the backslash character in that case. Rather than \"Use \\n with word wrap on to create a new line\" your text file will need to contain \"Use \\\\n with word wrap on to create a new line\". Not certain on this one but I suspect that is the solution to the problem.", "is_private": false, "bug_id": 59707, "id": 193184, "time": "2016-08-18T16:25:46Z", "creator": "markbrdsly@tiscali.co.uk", "creation_time": "2016-08-18T16:25:46Z", "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 59707, "attachment_id": null, "id": 193186, "creation_time": "2016-08-18T18:30:21Z", "time": "2016-08-18T18:30:21Z", "creator": "dominik.stadler@gmx.at", "text": "The \\n is a Java thing which only works in Strings that are embedded in code, not if you put it into a text-file which you read in via some sort of Reader/InputStream. The only way to have a newline inserted here is to actually put a newline into the textfile, so try to make the file look as follows and it should work:\n\n---- cut here -------\nUse \n with word wrap on to create a new line\n---- cut here -------", "is_private": false}]