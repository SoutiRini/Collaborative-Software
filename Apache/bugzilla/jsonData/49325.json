[{"count": 0, "tags": [], "bug_id": 49325, "attachment_id": 25468, "is_private": false, "id": 136999, "time": "2010-05-20T16:21:39Z", "creator": "teds.mailing.lists@gmail.com", "creation_time": "2010-05-20T16:21:39Z", "text": "Created attachment 25468\nA simple spreadsheet containing three rows and two columns.\n\nWhen attempting to open an .xlsx file running on the Websphere 6.1 JDK, the poi-bin-3.6-20091214 distribution results in the following exception. No exception is generated when running on jre_1.5.0_11.\n\nAs a workaround, replacing poi-ooxml-schemas-3.6-20091214.jar with ooxml-schemas-1.0.jar downloaded from http://mirrors.ibiblio.org/pub/mirrors/maven2//org/apache/poi/ooxml-schemas/1.0/ resolved the issue.\n\nIt has been suggested by Dave Fisher (per http://article.gmane.org/gmane.comp.jakarta.poi.user/14509) to include the org.openxmlformats.schemas.spreadsheetml.x2006.main.CTPhoneticRun in the poi-ooxml-schemas jar.\n\nSample .xlsx file is attached.  A sample program follows:\n\n\nimport java.io.File;\nimport java.io.FileInputStream;\n\nimport org.apache.poi.ss.usermodel.WorkbookFactory;\n\n/**\n * Demonstrates a bug using poi-bin-3.6-20091214 with Websphere 6.1 JDK:\n *  java.lang.NoClassDefFoundError: org.openxmlformats.schemas.spreadsheetml.x2006.main.CTPhoneticRun\n *  \n *  Per Dave Fisher: (http://article.gmane.org/gmane.comp.jakarta.poi.user/14509)\n *    The poi-ooxml-schemas jar is a cut-down version of ooxml-schemas-1.0.jar - the full schemas are about 13 MB.\n *    Replace poi-ooxml-schemas in your classpath with ooxml-schemas-1.0.jar. \n */\npublic final class Main {\n    static final String XLSX_PATH = \"C:/simple.xlsx\";\n    \n    public static void main(String[] args) throws Exception {\n        final File xlsx = new File(XLSX_PATH); \n        WorkbookFactory.create(new FileInputStream(xlsx));\n        System.out.println(\"okay!\");\n    }\n}\n\n\n\nException in thread \"main\" org.apache.poi.POIXMLException: java.lang.reflect.InvocationTargetException\n\tat org.apache.poi.xssf.usermodel.XSSFFactory.createDocumentPart(XSSFFactory.java:61)\n\tat org.apache.poi.POIXMLDocumentPart.read(POIXMLDocumentPart.java:256)\n\tat org.apache.poi.POIXMLDocument.load(POIXMLDocument.java:196)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:172)\n\tat org.apache.poi.ss.usermodel.WorkbookFactory.create(WorkbookFactory.java:63)\n\tat Main.main(Main.java:20)\nCaused by: java.lang.reflect.InvocationTargetException\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:67)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:521)\n\tat org.apache.poi.xssf.usermodel.XSSFFactory.createDocumentPart(XSSFFactory.java:59)\n\t... 5 more\nCaused by: java.lang.NoClassDefFoundError: org.openxmlformats.schemas.spreadsheetml.x2006.main.CTPhoneticRun\n\tat java.lang.J9VMInternals.verifyImpl(Native Method)\n\tat java.lang.J9VMInternals.verify(J9VMInternals.java:59)\n\tat java.lang.J9VMInternals.initialize(J9VMInternals.java:120)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:67)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:521)\n\tat org.apache.xmlbeans.impl.schema.SchemaTypeImpl.createUnattachedNode(SchemaTypeImpl.java:1859)\n\tat org.apache.xmlbeans.impl.schema.SchemaTypeImpl.createElementType(SchemaTypeImpl.java:1021)\n\tat org.apache.xmlbeans.impl.values.XmlObjectBase.create_element_user(XmlObjectBase.java:893)\n\tat org.apache.xmlbeans.impl.store.Xobj.getUser(Xobj.java:1657)\n\tat org.apache.xmlbeans.impl.store.Xobj.find_all_element_users(Xobj.java:2080)\n\tat org.openxmlformats.schemas.spreadsheetml.x2006.main.impl.CTSstImpl.getSiArray(Unknown Source)\n\tat org.apache.poi.xssf.model.SharedStringsTable.readFrom(SharedStringsTable.java:113)\n\tat org.apache.poi.xssf.model.SharedStringsTable.<init>(SharedStringsTable.java:97)\n\t... 10 more"}, {"count": 1, "tags": [], "text": "Fixed in r947312\n\nI included your sample in the POI test suite. It ensures that the build procedure includes needed classes from the full ooxml-schemas.jar.\n\nYegor", "attachment_id": null, "id": 137030, "creator": "yegor@dinom.ru", "time": "2010-05-22T12:16:03Z", "bug_id": 49325, "creation_time": "2010-05-22T12:16:03Z", "is_private": false}]