[{"count": 0, "tags": [], "bug_id": 61503, "text": "I believe that the fix for https://bz.apache.org/bugzilla/show_bug.cgi?id=60940 has introduced a regression. When a JSF-based application is run from a war archive (either using unpackWARs=false or Tomcat embedded in an executable war with Spring Boot) the application will fail to start if it depends on H2. The failure occurs because H2's jar file does not contain a META-INF/ directory entry; it only contains entries for the two files beneath the directory. This leads to a FileNotFoundException when calling getJarFile() on the connection to the URL for the resource:\n\nCaused by: java.io.FileNotFoundException: JAR entry META-INF/ not found in /var/folders/zq/v6xkr2696kv05jbf3bddt9680000gn/T/jar_cache4058734571815148022.tmp\n\tat sun.net.www.protocol.jar.JarURLConnection.connect(JarURLConnection.java:142) ~[na:1.8.0_141]\n\tat sun.net.www.protocol.jar.JarURLConnection.getJarFile(JarURLConnection.java:89) ~[na:1.8.0_141]\n\tat com.sun.faces.facelets.util.Classpath.search(Classpath.java:145) ~[jsf-impl-2.2.7.jar!/:2.2.7]\n\tat com.sun.faces.facelets.util.Classpath.search(Classpath.java:109) ~[jsf-impl-2.2.7.jar!/:2.2.7]\n\tat com.sun.faces.config.configprovider.MetaInfFacesConfigResourceProvider.loadURLs(MetaInfFacesConfigResourceProvider.java:164) ~[jsf-impl-2.2.7.jar!/:2.2.7]\n\tat com.sun.faces.config.configprovider.MetaInfFacesConfigResourceProvider.getResources(MetaInfFacesConfigResourceProvider.java:108) ~[jsf-impl-2.2.7.jar!/:2.2.7]\n\t... 15 common frames omitted\n\nA sample application that reproduces the problem is available in this Spring Boot issue: https://github.com/spring-projects/spring-boot/issues/10232", "id": 200750, "time": "2017-09-08T11:49:58Z", "creator": "awilkinson@pivotal.io", "creation_time": "2017-09-08T11:49:58Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 200774, "time": "2017-09-08T16:52:22Z", "bug_id": 61503, "creation_time": "2017-09-08T16:52:22Z", "is_private": false, "text": "This would be easier to investigate with a WAR I could deploy in a standard Tomcat instance but when I try that with the provided sample it appears no initialization occurs. I haven't (yet) dug into why."}, {"count": 2, "tags": [], "bug_id": 61503, "attachment_id": null, "id": 200775, "time": "2017-09-08T16:55:35Z", "creator": "awilkinson@pivotal.io", "creation_time": "2017-09-08T16:55:35Z", "is_private": false, "text": "I think I understand the problem well enough to create a much simpler sample that reproduces the problem. Let me know if that would be useful and I'll see what I can manage."}, {"count": 3, "tags": [], "creator": "markt@apache.org", "text": "Thanks. Let me get back to you on that offer.", "id": 200779, "time": "2017-09-08T18:40:25Z", "bug_id": 61503, "creation_time": "2017-09-08T18:40:25Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 61503, "attachment_id": null, "id": 200832, "time": "2017-09-12T19:47:43Z", "creator": "markt@apache.org", "creation_time": "2017-09-12T19:47:43Z", "is_private": false, "text": "Fixed in:\n- trunk for 9.0.0.M27 onwards\n- 8.5.x for 8.5.21 onwards\n- 8.0.x for 8.0.47 onwards"}]