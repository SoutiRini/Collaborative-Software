[{"count": 0, "text": "Hello !\nWe have some segfaults with apache 2.2.22\n\nhere is some debug\n\nCore was generated by `/usr/sbin/httpd -k start -DSSL'.\nProgram terminated with signal 6, Aborted.\n#0  0x00007f5d94c9d165 in raise () from /lib/libc.so.6\n(gdb) bt full\n#0  0x00007f5d94c9d165 in raise () from /lib/libc.so.6\nNo symbol table info available.\n#1  0x00007f5d94c9ff70 in abort () from /lib/libc.so.6\nNo symbol table info available.\n#2  0x000000000044be0f in ap_log_assert (szExp=0x4d00cf \"preg != NULL\", szFile=0x4d00c0 \"mod_setenvif.c\", nLine=176) at log.c:882\n        time_str = \"Thu May 24 02:14:19 2012\"\n#3  0x00000000004617c5 in is_header_regex (cmd=0x7f5d5d67fb30, mconfig=<value optimized out>, fname=0x4d00dc \"User-Agent\", args=\n    0x2686ca23 \"gzip-only-text/html\") at mod_setenvif.c:176\n        preg = 0x0\n#4  add_setenvif_core (cmd=0x7f5d5d67fb30, mconfig=<value optimized out>, fname=0x4d00dc \"User-Agent\", args=0x2686ca23 \"gzip-only-text/html\")\n    at mod_setenvif.c:355\n        regex = 0x269ba530 \"^Mozilla/4\"\n        simple_pattern = <value optimized out>\n        feature = <value optimized out>\n        sconf = <value optimized out>\n        new = 0x269ba0d0\n        var = <value optimized out>\n        i = <value optimized out>\n        beenhere = <value optimized out>\n        icase = 0\n#5  0x00000000004482ee in invoke_cmd (cmd=0x4d04b0, parms=0x7f5d5d67fb30, mconfig=0x269ba0a8, args=0x2686ca18 \"^Mozilla/4 gzip-only-text/html\") at config.c:757\n        w = <value optimized out>\n        w2 = <value optimized out>\n        w3 = <value optimized out>\n        errmsg = <value optimized out>\n#6  0x00000000004485a2 in ap_walk_config_sub (current=0x2686c9d8, parms=0x7f5d5d67fb30, section_vector=0x26877ce8) at config.c:1163\n        dir_config = 0x0\n        cmd = 0xe53\n        ml = <value optimized out>\n        dir = <value optimized out>\n#7  ap_walk_config (current=0x2686c9d8, parms=0x7f5d5d67fb30, section_vector=0x26877ce8) at config.c:1196\n        errmsg = <value optimized out>\n        oldconfig = 0x0\n#8  0x0000000000449514 in ap_parse_htaccess (result=<value optimized out>, r=0x26d9d1b0, override=31, override_opts=255, d=<value optimized out>, access_name=\n    0x3431359 \"\") at config.c:1827\n        errmsg = 0x0\n        temptree = 0x2686c9d8\n        f = 0x26868928\n        parms = {info = 0x0, override = 31, limited = -1, limited_xmethods = 0x0, xlimited = 0x0, config_file = 0x26868928, directive = 0x2686c9d8, pool =\n    0x26d9d138, temp_pool = 0x26d9d138, server = 0x17277920, path = 0x268677e0 \"/home/ajsit80/domains/futbolbezbarier.org/public_html/\", cmd = 0x4d04b0,\n          context = 0x26877ce8, err_directive = 0x2661b0d8, override_opts = 255}\n        filename = 0x26867828 \"/home/ajsit80/domains/futbolbezbarier.org/public_html/.htaccess\"\n        cache = <value optimized out>\n        dc = 0x26877ce8\n        status = <value optimized out>\n#9  0x00000000004439de in ap_directory_walk (r=0x26d9d1b0) at request.c:879\n        htaccess_conf = 0x0\n        res = <value optimized out>\n---Type <return> to continue, or q <return> to quit---\n        seg_name = 0x26867162 \"public_html/\"\n        temp_slash = 1\n        opts = {opts = 98 'b', add = 34 '\"', remove = 129 '\\201', override = 31 '\\037', override_opts = 255 '\\377'}\n        thisinfo = {pool = 0x26d9d138, valid = 7598960, protection = 1877, filetype = APR_DIR, user = 2047, group = 2049, inode = 78228062, device = 2069,\n          nlink = 8, size = 4096, csize = 4096, atime = 1331206990000000, mtime = 1332176119000000, ctime = 1332176119000000, fname =\n    0x26867138 \"/home/ajsit80/domains/futbolbezbarier.org/public_html/\", name = 0x26d9e0a0 \"\\270\\356\\331&\", filehand = 0x26d9d1b0}\n        save_path_info = <value optimized out>\n        matches = 0\n        last_walk = 0x268670a0\n        this_dir = <value optimized out>\n        seg = 6\n        sec_idx = 8\n        filename_len = 54\n        now_merged = 0x26867248\n        sconf = 0x1d23e710\n        num_sec = 9\n        cache = <value optimized out>\n        entry_dir = 0x268670d0 \"/home/ajsit80/domains/futbolbezbarier.org/public_html/test/wp-content/themes/colorway/css/\"\n        rv = <value optimized out>\n#10 0x0000000000440709 in core_map_to_storage (r=0xe53) at core.c:3634\n        access_status = <value optimized out>\n#11 0x0000000000442090 in ap_run_map_to_storage (r=0x26d9d1b0) at request.c:69\n        n = 5\n        rv = 0\n#12 0x00000000004440e8 in ap_process_request_internal (r=0x26d9d1b0) at request.c:150\n        file_req = 0\n        access_status = 0\n#13 0x0000000000491298 in ap_process_request (r=0x26d9d1b0) at http_request.c:280\n        access_status = 0\n#14 0x000000000048e210 in ap_process_http_connection (c=0x2685bc78) at http_core.c:190\n        r = 0x26d9d1b0\n        csd = 0x0\n#15 0x000000000044e540 in ap_run_process_connection (c=0x2685bc78) at connection.c:43\n        n = 1\n        rv = 0\n#16 0x00000000004c22c7 in process_socket (thd=<value optimized out>, dummy=<value optimized out>) at worker.c:544\n        current_conn = <value optimized out>\n        conn_id = <value optimized out>\n        csd = 18762\n        sbh = 0x2685bc70\n#17 worker_thread (thd=<value optimized out>, dummy=<value optimized out>) at worker.c:894\n        process_slot = 0\n        thread_slot = 101\n        csd = 0x2685ba60\n        bucket_alloc = <value optimized out>\n        last_ptrans = <value optimized out>\n        ptrans = 0x2685b9d8\n        rv = <value optimized out>\n---Type <return> to continue, or q <return> to quit---\n        is_idle = <value optimized out>\n#18 0x00007f5d951d68ba in start_thread () from /lib/libpthread.so.0\nNo symbol table info available.\n#19 0x00007f5d94d3a02d in clone () from /lib/libc.so.6\nNo symbol table info available.\n#20 0x0000000000000000 in ?? ()\nNo symbol table info available.\n(gdb) x/8i $pc\n0x7f5d94c9d165 <raise+53>:      cmp    $0xfffffffffffff000,%rax\n0x7f5d94c9d16b <raise+59>:      ja     0x7f5d94c9d182 <raise+82>\n0x7f5d94c9d16d <raise+61>:      repz retq\n0x7f5d94c9d16f <raise+63>:      nop\n0x7f5d94c9d170 <raise+64>:      test   %eax,%eax\n0x7f5d94c9d172 <raise+66>:      jg     0x7f5d94c9d155 <raise+37>\n0x7f5d94c9d174 <raise+68>:      test   $0x7fffffff,%eax\n0x7f5d94c9d179 <raise+73>:      jne    0x7f5d94c9d192 <raise+98>\n(gdb) x/8x $sp\n0x7f5d5d67f658: 0x94c9ff70      0x00007f5d      0x004d00cf      0x00000000\n0x7f5d5d67f668: 0x5d67f7b0      0x00007f5d      0x000000b0      0x00000000\n(gdb) info reg\nrax            0x0      0\nrbx            0x4d00c0 5046464\nrcx            0xffffffffffffffff       -1\nrdx            0x6      6\nrsi            0xfd5    4053\nrdi            0xe53    3667\nrbp            0x4d00cf 0x4d00cf\nrsp            0x7f5d5d67f658   0x7f5d5d67f658\nr8             0x0      0\nr9             0x0      0\nr10            0x8      8\nr11            0x206    518\nr12            0x7f5d5d67f7b0   140038975780784\nr13            0xb0     176\nr14            0x0      0\nr15            0x269ba530       647734576\nrip            0x7f5d94c9d165   0x7f5d94c9d165 <raise+53>\neflags         0x206    [ PF IF ]\ncs             0x33     51\nss             0x2b     43\nds             0x0      0\nes             0x0      0\nfs             0x0      0\ngs             0x0      0\nfctrl          0x37f    895\nfstat          0x0      0\nftag           0xffff   65535\nfiseg          0x0      0\nfioff          0x0      0\nfoseg          0x0      0\nfooff          0x0      0\nfop            0x0      0\nmxcsr          0x1fa0   [ PE IM DM ZM OM UM PM ]\n\nI think this is problem also with deflate settings\nwe have the following settings\n\n<Location />\n# Insert filter\nSetOutputFilter DEFLATE\n\n# Netscape 4.x has some problems...\nBrowserMatch ^Mozilla/4 gzip-only-text/html\n\n# Netscape 4.06-4.08 have some more problems\nBrowserMatch ^Mozilla/4\\.0[678] no-gzip\n\n# MSIE masquerades as Netscape, but it is fine\nBrowserMatch \\bMSIE !no-gzip !gzip-only-text/html\n\n# Don't compress images and other uncompressible content\nSetEnvIfNoCase Request_URI \\\n \\.(?:gif|jpe?g|png|rar|zip|exe|mov|tgz|tar.gz|wmv|pdf|mp3|swf|flv|avi|ogg|webm|ogv)$ no-gzip dont-vary\n\n# Make sure proxies don't deliver the wrong content\nHeader append Vary User-Agent env=!dont-vary\n</Location>\n\nRegards,\nPiotr", "bug_id": 53284, "is_private": false, "id": 159278, "time": "2012-05-24T00:32:22Z", "creator": "pio@rdl.pl", "creation_time": "2012-05-24T00:32:22Z", "tags": [], "attachment_id": null}, {"count": 1, "attachment_id": null, "creator": "sf@sfritsch.de", "text": "Is your system short of memory? I can't imagine how this assertion can be triggered except if out of memory.", "id": 159360, "time": "2012-05-27T20:52:01Z", "bug_id": 53284, "creation_time": "2012-05-27T20:52:01Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "text": "It may be problem with memory because we have ulimit -v 8388608 in start scripts to avoid server crash due to another bug \n\nhttps://issues.apache.org/bugzilla/show_bug.cgi?id=53290\n\nThis segfault may be related to that bug when apache start using all memory reserverd for it \n\nPiotr", "attachment_id": null, "id": 159363, "creator": "pio@rdl.pl", "time": "2012-05-27T21:52:18Z", "bug_id": 53284, "creation_time": "2012-05-27T21:52:18Z", "is_private": false}, {"count": 3, "tags": [], "creator": "sf@sfritsch.de", "attachment_id": null, "id": 159365, "time": "2012-05-27T22:12:19Z", "bug_id": 53284, "creation_time": "2012-05-27T22:12:19Z", "is_private": false, "text": "It is normal and intended behavior for 2.2 to segfault if memory allocation fails. This won't be changed.\n\n2.4 should abort with a logged error message if out of memory. r1343109 adds the error handling for this particular code path (compiling a regular expression)."}]