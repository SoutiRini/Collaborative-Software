[{"count": 0, "attachment_id": null, "bug_id": 47341, "is_private": false, "id": 127775, "time": "2009-06-09T17:45:01Z", "creator": "brendonm@bbtechltd.com", "creation_time": "2009-06-09T17:45:01Z", "tags": [], "text": "I have built a custom Java server application that is used to host multiple websites, some of which currently use FOP-0.20.5 for PDF generation. However, I would like to start using FOP-0.95 for a new site i'm building, and have encountered a problem:\n\njava.lang.ClassCastException: org.apache.fop.fo.UnknownXMLObj\nat org.apache.fop.fo.FOTreeBuilder$MainFOHandler.startElement(FOTreeBuilder.java:281)\nat org.apache.fop.fo.FOTreeBuilder.startElement(FOTreeBuilder.java:163)\nat org.apache.xalan.transformer.TransformerIdentityImpl.startElement(TransformerIdentityImpl.java:1072)\nat org.apache.xerces.parsers.AbstractSAXParser.startElement(Unknown Source)\nat org.apache.xerces.impl.XMLNSDocumentScannerImpl.scanStartElement(Unknown Source)\nat org.apache.xerces.impl.XMLNSDocumentScannerImpl$NSContentDispatcher.scanRootElementHook(Unknown Source)\nat org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown Source)\nat org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)\nat org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\nat org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\nat org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\nat org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)\nat org.apache.xalan.transformer.TransformerIdentityImpl.transform(TransformerIdentityImpl.java:484)\n\nI think this has something to do with the ClassLoader setup, because the PDF file generates without any issues on all FOP versions when I try to generate it from a simple Java application.\n\nSo I did some more research, and created a new test java application which loads a bunch of jar files into a special ClassLoader object, loads a Runnable class from the ClassLoader with Class.forName(), and then executes it.\n\nI then wrote a simple Runnable object for both FOP-0.20.5 and FOP-0.95 and built them into different jar files with the intention to keep them separate and ensure they belong to the same ClassLoader as the associated FOP libraries.\n\nNow for the test:\nFOP-0.20.5: PDF generated without any problems.\nFOP-0.95: Failure. Same error as above.\n\nHas anyone else encountered this sort of problem?\n\nIf there is no solution for this then it looks like I will be restricted to only one version of FOP for each server, and will be forced to load all the libraries in the java command line. If this is the case, I have a LOT of old xsl-fo files to rewrite to comply with FOP-0.95! :("}, {"count": 1, "tags": [], "creator": "gadams@apache.org", "attachment_id": null, "text": "resetting severity from major to normal pending further review", "id": 157269, "time": "2012-04-07T01:37:13Z", "bug_id": 47341, "creation_time": "2012-04-07T01:37:13Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 47341, "attachment_id": null, "text": "resetting P2 open bugs to P3 pending further review", "id": 157593, "time": "2012-04-07T01:45:03Z", "creator": "gadams@apache.org", "creation_time": "2012-04-07T01:45:03Z", "is_private": false}]