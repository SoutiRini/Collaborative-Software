[{"count": 0, "tags": [], "text": "java.lang.ArrayIndexOutOfBoundsException: -2\n        at org.apache.poi.ss.formula.FormulaCellCacheEntrySet.addInternal(FormulaCellCacheEntrySet.java:83)\n        at org.apache.poi.ss.formula.FormulaCellCacheEntrySet.add(FormulaCellCacheEntrySet.java:72)\n        at org.apache.poi.ss.formula.CellCacheEntry.addConsumingCell(CellCacheEntry.java:85)\n        at org.apache.poi.ss.formula.FormulaCellCacheEntry.changeConsumingCells(FormulaCellCacheEntry.java:80)\n        at org.apache.poi.ss.formula.FormulaCellCacheEntry.setSensitiveInputCells(FormulaCellCacheEntry.java:60)\n        at org.apache.poi.ss.formula.FormulaCellCacheEntry.updateFormulaResult(FormulaCellCacheEntry.java:109)\n        at org.apache.poi.ss.formula.CellEvaluationFrame.updateFormulaResult(CellEvaluationFrame.java:75)\n        at org.apache.poi.ss.formula.EvaluationTracker.updateCacheResult(EvaluationTracker.java:94)\n        at org.apache.poi.ss.formula.WorkbookEvaluator.evaluateAny(WorkbookEvaluator.java:286)\n        at org.apache.poi.ss.formula.WorkbookEvaluator.evaluate(WorkbookEvaluator.java:221)\n        at org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluateFormulaCellValue(HSSFFormulaEvaluator.java:320)\n        at org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluate(HSSFFormulaEvaluator.java:182)\n\nAppears to occur randomly when calling HSSFFormulaEvaluator.evaluate(Cell cell) more than once on the same cell.\n\nLooking at the FormulaCellCacheEntrySet.java:83:\n\n\tint startIx = cce.hashCode() % arr.length;\n\tfor(int i=startIx; i<arr.length; i++) {\n\t\nstartIx could be negative hence the ArrayIndexOutOfBoundsException\n\nWorkaround: call HSSFFormulaEvaluator.clearAllCachedResultValues() before invoking evaluate on the same cell although suspect there would still be issues in a multithreaded environment.", "is_private": false, "id": 146664, "creator": "amountney@cnsonline.net", "time": "2011-05-26T16:58:36Z", "bug_id": 51273, "creation_time": "2011-05-26T16:58:36Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 51273, "text": "Should be fixed in r1128268 - looks like there was a missing Math.abs\n\nNote however that if you're updating cells after having done one calculation, you do need to tell the formula evaluator so it can tweak its cache.", "id": 146674, "time": "2011-05-27T11:46:37Z", "creator": "apache@gagravarr.org", "creation_time": "2011-05-27T11:46:37Z", "is_private": false, "attachment_id": null}]