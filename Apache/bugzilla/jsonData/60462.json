[{"count": 0, "tags": [], "text": "Created attachment 34513\nexample workbook\n\nThe attached spreadsheet originally created with an earlier Excel, but recently modified, has a fill foreground set for A1 on 'mixed' sheet.\n\nfrom sheet1.xml:\n\n<c r=\"A1\" s=\"2\" t=\"s\">\n\nfrom styles.xml\n\nHere is xf #2:\n\n\t\t<xf numFmtId=\"0\" fontId=\"4\" fillId=\"43\" borderId=\"0\" xfId=\"0\" applyFont=\"1\" applyFill=\"1\" applyProtection=\"1\">\n\t\t\t<protection hidden=\"1\"/>\n\t\t</xf>\n\n\nHere is fill #43:\n\n\t\t\t<patternFill patternType=\"solid\">\n\t\t\t\t<fgColor indexed=\"8\"/>\n\t\t\t\t<bgColor indexed=\"64\"/>\n\t\t\t</patternFill>\n\nand here are the first 8 indexedColors:\n\n\t<colors>\n\t\t<indexedColors>\n\t\t\t<rgbColor rgb=\"00000000\"/>\n\t\t\t<rgbColor rgb=\"00FFFFFF\"/>\n\t\t\t<rgbColor rgb=\"00FF0000\"/>\n\t\t\t<rgbColor rgb=\"0000FF00\"/>\n\t\t\t<rgbColor rgb=\"000000FF\"/>\n\t\t\t<rgbColor rgb=\"00FFFF00\"/>\n\t\t\t<rgbColor rgb=\"00FF00FF\"/>\n\t\t\t<rgbColor rgb=\"0000FFFF\"/>\n\t\t\t<rgbColor rgb=\"00FF00FF\"/>\n\nThe correct color here is 00FF00FF (magenta), and that is what any version of excel shows when reading this wb. However, using getFillForegroundColor() on XSSFCellFill returns '00000000' because it simply looks it up in the indexedColors enum. But that enum only describes the default indexedColors. If indexedColors is stored in the wb, those should be used during extraction", "attachment_id": 34513, "bug_id": 60462, "id": 195434, "time": "2016-12-09T21:21:33Z", "creator": "bknippen@abinitio.com", "creation_time": "2016-12-09T21:21:33Z", "is_private": false}, {"count": 1, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "text": "It seems support for this is completely absent currently, i.e. the CTIndexedColors item is not read in StylesTable at all, currently a fixed set of indexed colors is used in ExtendedColor.getRGBOrARGB().\n\nSo the first step is likely to add support for these to class StylesTable so that we read a custom list of indexed colors and then adjust the places where the mapping from indexed colors to RGB should take place.\n\nPatches welcome!", "id": 195796, "time": "2017-01-02T20:46:35Z", "bug_id": 60462, "creation_time": "2017-01-02T20:46:35Z", "is_private": false}]