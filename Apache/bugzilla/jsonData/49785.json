[{"count": 0, "tags": [], "creator": "felix.schumacher@internetallee.de", "attachment_id": 25916, "is_private": false, "id": 139252, "time": "2010-08-19T13:04:06Z", "bug_id": 49785, "creation_time": "2010-08-19T13:04:06Z", "text": "Created attachment 25916\nInitialContextFactory which produces TLS enabled LdapContext instances\n\nTo enable TLS for LDAP inside JNDIRealm one has to either patch JNDIRealm directly and introduce another state variable to hold TLS-state - and thus make introduction of pooling harder, or use a factory which produces TLS enabled DirContext instances.\n\nSuch a factory is attached. It can be configured by specifying a contextFactory in JNDIRealm config:\n &lt;Realm\n   ...\n   contextFactory=\"org.apache.catalina.realm.LdapTlsContextFactory\"\n   ...\n   /&gt;\n\nI think it would be a good idea to add a parameter startTLS to JNDIRealm, which would automatically use the above TLS-ContextFactory. If wanted, I could supply a patch.\n\n(the patch is against tomcat 6.0.x trunk, but I think it will apply fine to trunk too)"}, {"count": 1, "tags": [], "creator": "rainer.jung@kippdata.de", "attachment_id": null, "is_private": false, "id": 139263, "time": "2010-08-19T18:11:37Z", "bug_id": 49785, "creation_time": "2010-08-19T18:11:37Z", "text": "See also http://wiki.apache.org/tomcat/JNDI_startTLs_HowTo"}, {"attachment_id": null, "tags": [], "creator": "chris@christopherschultz.net", "text": "The default connection factory is com.sun.jndi.ldap.LdapCtxFactory which claims to support both SSL and STARTTLS: http://docs.oracle.com/javase/1.4.2/docs/guide/jndi/jndi-ldap.html#SSL\n\nAm I missing something?", "count": 2, "id": 161201, "time": "2012-08-09T18:31:29Z", "bug_id": 49785, "creation_time": "2012-08-09T18:31:29Z", "is_private": false}, {"attachment_id": 32448, "tags": [], "creator": "felix.schumacher@internetallee.de", "text": "Created attachment 32448\nEnable starttls for JNDIRealm\n\nI integrated the functionality into JNDIRealm. There is no documentation yet and I am not sure, whether I should include the HostnameVerifier as an enum. I will extend the method, so that I can use the given string for construction of one.\n\nI will commit the code together with documentation to trunk if noone objects.", "count": 3, "id": 180926, "time": "2015-02-10T22:05:16Z", "bug_id": 49785, "creation_time": "2015-02-10T22:05:16Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 49785, "attachment_id": 32465, "id": 181015, "time": "2015-02-12T20:43:18Z", "creator": "felix.schumacher@internetallee.de", "creation_time": "2015-02-12T20:43:18Z", "is_private": false, "text": "Created attachment 32465\nEnable starttls for JNDIRealm\n\nBasically the same as the last patch, but now with documentation and the possibility to specify a SSLSocketFactory."}, {"count": 5, "tags": [], "creator": "felix.schumacher@internetallee.de", "attachment_id": null, "text": "(In reply to Christopher Schultz from comment #2)\n> The default connection factory is com.sun.jndi.ldap.LdapCtxFactory which\n> claims to support both SSL and STARTTLS:\n> http://docs.oracle.com/javase/1.4.2/docs/guide/jndi/jndi-ldap.html#SSL\n> \n> Am I missing something?\n\nSSL is used automatically, when ldaps:// is specified as the protocol, but for StartTLS you have to code a little bit to enable it.", "id": 181016, "time": "2015-02-12T20:44:24Z", "bug_id": 49785, "creation_time": "2015-02-12T20:44:24Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "chris@christopherschultz.net", "is_private": false, "count": 6, "id": 181054, "time": "2015-02-13T17:17:06Z", "bug_id": 49785, "creation_time": "2015-02-13T17:17:06Z", "text": "(In reply to Felix Schumacher from comment #5)\n>\n> SSL is used automatically, when ldaps:// is specified as the protocol, but\n> for StartTLS you have to code a little bit to enable it.\n\nAah, yes: I think of TLS as secure-transport, and I often forget about STARTTLS. I'm updating the description to be more clear."}, {"count": 7, "tags": [], "bug_id": 49785, "is_private": false, "text": "Fixed in trunk and tomcat 8.0.x for 8.0.21 onwards.", "id": 181183, "time": "2015-02-19T18:55:53Z", "creator": "felix.schumacher@internetallee.de", "creation_time": "2015-02-19T18:55:53Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "felix.schumacher@internetallee.de", "is_private": false, "count": 8, "id": 181237, "time": "2015-02-21T13:14:50Z", "bug_id": 49785, "creation_time": "2015-02-21T13:14:50Z", "text": "Will be included in tomcat 7.0.60"}]