[{"count": 0, "tags": [], "creator": "kimono.outfit.am@gmail.com", "is_private": false, "text": "Created attachment 34118\njmx for reproduction\n\nCache Manager does not update expires date when response code is 304.\n\nIf server sends new Expires header with 304, JMeter should not send this request until expired when \"Use Cache-Control/Expires header\" option is checked.\n\nThis is because cacheable response code is limited to 2xx range in isCacheable method(CacheManager.java).\n\nTo reproduce with Apache HTTP Server 2.4:\nAdd settings below to httpd.conf and run attached jmx.\n----\nLoadModule expires_module modules/mod_expires.so\n<IfModule expires_module>\nExpiresActive On\nExpiresDefault \"access plus 5 seconds\"\n</IfModule>\n----\n\nExpected result:\n3rd request of attached jmx should not be sent.", "id": 192967, "time": "2016-08-09T15:27:33Z", "bug_id": 59962, "creation_time": "2016-08-09T15:27:33Z", "attachment_id": 34118}, {"count": 1, "tags": [], "bug_id": 59962, "is_private": false, "id": 193039, "creation_time": "2016-08-11T19:30:05Z", "time": "2016-08-11T19:30:05Z", "creator": "p.mouawad@ubik-ingenierie.com", "text": "Hello,\nThanks for report.\nCould you set Filename in your View Results Tree and save all fields to XML format, run your test and send the output ?\n\nAn alternative would be to write a Test method in TestCacheManagerBase.\n\nI am not sure to understand.\n\n1/ First request is sent, and says to cache access + 5 seconds\n2/ Your timer runs for 6 seconds, so second request should get a 200, not a 304 \n3/ And yes the 3rd request should come from cache. So I don't understand your note on \"This is because cacheable response code is limited to 2xx range in isCacheable method(CacheManager.java).\"\n\n\nThanks", "attachment_id": null}, {"count": 2, "tags": [], "creator": "kimono.outfit.am@gmail.com", "attachment_id": 34155, "id": 193136, "time": "2016-08-16T08:03:55Z", "bug_id": 59962, "creation_time": "2016-08-16T08:03:55Z", "is_private": false, "text": "Created attachment 34155\nrsult xml file\n\nThanks for your reply.\n\nDetail of expected result is below.\n\n1.1st request is sent, and server returns 200 response with expires date \"access plus 5 seconds\".\n2.After 6 seconds(timer), 2nd request is sent, and server returns 304 response with new expires date \"access plus 5 seconds\".\n3.After 3 seconds(timer), 3rd request should not be sent because cache is not expired."}, {"count": 3, "attachment_id": null, "bug_id": 59962, "text": "I wrote a simple test method for TestCacheManagerBase.\n\n----\n    @Test\n    public void testExpiresBug59962() throws Exception {\n        this.cacheManager.setUseExpires(true);\n        this.cacheManager.testIterationStart(null);\n        assertNull(\"Should not find entry\", getThreadCacheEntry(LOCAL_HOST));\n        assertFalse(\"Should not find valid entry\", this.cacheManager.inCache(url));\n        long start = System.currentTimeMillis();\n        setExpires(makeDate(new Date(start + 2000)));\n        cacheResultWithGivenCode(\"304\");\n        assertNotNull(\"Should find entry\", getThreadCacheEntry(LOCAL_HOST));\n        assertTrue(\"Should find valid entry\", this.cacheManager.inCache(url));\n        sleepTill(start + 2010);\n        assertNotNull(\"Should find entry\", getThreadCacheEntry(LOCAL_HOST));\n        assertFalse(\"Should not find valid entry\", this.cacheManager.inCache(url));\n    }\n----", "id": 193261, "time": "2016-08-22T12:46:17Z", "creator": "kimono.outfit.am@gmail.com", "creation_time": "2016-08-22T12:46:17Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 59962, "attachment_id": null, "is_private": false, "id": 193488, "time": "2016-09-03T22:15:58Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2016-09-03T22:15:58Z", "text": "Author: pmouawad\nDate: Sat Sep  3 22:15:03 2016\nNew Revision: 1759137\n\nURL: http://svn.apache.org/viewvc?rev=1759137&view=rev\nLog:\nBug 59962 - Cache Manager does not update expires date when response code is 304.\nBugzilla Id: 59962\n\nModified:\n    jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/control/CacheManager.java\n    jmeter/trunk/test/src/org/apache/jmeter/protocol/http/control/TestCacheManagerBase.java\n    jmeter/trunk/xdocs/changes.xml"}]