[{"count": 0, "tags": [], "creator": "huxin0124@yahoo.com.cn", "text": "Dear all,\nI use poi-bin-3.0.1-FINAL-20070705.\nI found a strange thing that I load an xls file and export to another file \nwithout any operate, the new file formula can't calculate itself, but after i \ndouble click the formula cell, the value appeared.\nmy code:\n\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\n\nimport org.apache.poi.hssf.usermodel.HSSFCell;\nimport org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator;\nimport org.apache.poi.hssf.usermodel.HSSFRow;\nimport org.apache.poi.hssf.usermodel.HSSFSheet;\nimport org.apache.poi.hssf.usermodel.HSSFWorkbook;\n\npublic class ExcelTest\n{\n\n\t/**\n\t * @param args\n\t */\n\tpublic static void main(String[] args)\n\t{\n\t\ttry\n\t\t{\n\t\t\tFileInputStream fis = new FileInputStream(new File\n(\"123.xls\"));\n\t\t\tHSSFWorkbook wb = new HSSFWorkbook(fis);\n\t\t\tfis.close();\n\t\t\t\n\t\t\tHSSFSheet sheet = wb.getSheetAt(0);\n\t\t\tHSSFRow row0 = sheet.getRow(0);\n\t\t\tHSSFRow row1 = sheet.getRow(1);\n\t\t\tHSSFRow row2 = sheet.getRow(2);\n\t\t\t\n\t\t\tshort col1 = 0;\n\t\t\tHSSFCell cell1 = row1.getCell(col1);\n\t\t\tcell1.setCellValue(14.1);\n\t\t\tHSSFCell cell2 = row2.getCell(col1);\n\t\t\tcell2.setCellValue(16.1);\n\t\t\t\n\t\t\tFileOutputStream fos = new FileOutputStream(new File\n(\"1234.xls\"));\n\t\t\twb.write(fos);\n\t\t\tfos.close();\n\t\t}\n\t\tcatch(Exception e)\n\t\t{\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n}\nthank you all!\np.s. my excel version is 2003.", "id": 111877, "time": "2007-12-18T18:12:22Z", "bug_id": 44098, "creation_time": "2007-12-18T18:12:22Z", "is_private": false, "attachment_id": null}, {"count": 1, "attachment_id": null, "bug_id": 44098, "text": "With POI 3.x, you can evaluate the formulas yourself, to have them re-calculate\nto match changes in your spreadsheet\n\nSee http://poi.apache.org/hssf/eval.html", "id": 111982, "time": "2007-12-21T04:21:59Z", "creator": "apache@gagravarr.org", "creation_time": "2007-12-21T04:21:59Z", "tags": [], "is_private": false}]