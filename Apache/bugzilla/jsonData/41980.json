[{"count": 0, "tags": [], "creator": "shukla.shankar.ravi@gmail.com", "text": "It appears that log4j stop updating log file as new log entries are not \nreflected in log file and \"Modified\" time is not update in Windows explorer or \nif using java code.\n\nIn reality if application containing log4j is restarted, log entries for non-\nresponding period will be back. So fact is log file does not reflect entries \nfor the some period, instead it copy log entries in some buffer to be copied \nlater in log file.\n\nTried version log4j-1.2.8 and log4j-1.2.14 with same result.\n\n<appender name=\"testlogger\" class=\"org.apache.log4j.DailyRollingFileAppender\">\n        <param name=\"File\" value=\"C:\\\\Program \nFiles\\\\NCR\\\\Testing\\\\testlogger.log\"/>\n        <param name=\"DatePattern\" value=\"'.'dd\"/>\n        <layout class=\"org.apache.log4j.PatternLayout\">\n         \t<param name=\"ConversionPattern\" value=\"%d{ISO8601} (%p) %m%n\"/>\n\t</layout>\n\t<filter class=\"com.ncr.tvi.logger.TVILevelRangeFilter\">\n\t\t<!-- param name=\"LevelMin\" value=\"TRACE_0\"/ -->\n\t\t<param name=\"LevelMin\" value=\"TRACE_0\"/>\n\t\t<param name=\"LevelMax\" value=\"FATAL\"/>\n\t</filter>\n    </appender>", "id": 101147, "time": "2007-03-29T03:00:07Z", "bug_id": 41980, "creation_time": "2007-03-29T03:00:07Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "carnold@apache.org", "text": "Sorry can't understand problem description and can't reproduce since you are using a custom filter.  \nMarking as NEEDINFO.", "id": 107113, "time": "2007-08-22T20:04:25Z", "bug_id": 41980, "creation_time": "2007-08-22T20:04:25Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 41980, "attachment_id": null, "text": "Issue is same even if custom filter is removed.The same issue is there with 3 \napplications.\n\nDailyRollingFileAppender is used to create log file.\nLog file is update every minute by application.\nLog file content is updated correctly but time stamp is showing inconsistent \nresult.\ne.g: \n1. Time stamp(Today, September 10, 2007, 11:24:53 AM) is not changed even if \nlog file contents are changed most of the time.\n2. Assuming at Today, September 10, 2007, 11:20:53 AM there where 1000 line of \nlog entries and at Today, September 10, 2007, 11:30:53 AM 1000 more lines are \nadded in the log file.\n3. Log entries will be reflected correctly but time stamp for log file is \ninconsistent( Still it will show Today, September 10, 2007, 11:20:53 AM)\n\nThanks\nRavi\n\n(In reply to comment #0)\n> It appears that log4j stop updating log file as new log entries are not \n> reflected in log file and \"Modified\" time is not update in Windows explorer \nor \n> if using java code.\n> In reality if application containing log4j is restarted, log entries for non-\n> responding period will be back. So fact is log file does not reflect entries \n> for the some period, instead it copy log entries in some buffer to be copied \n> later in log file.\n> Tried version log4j-1.2.8 and log4j-1.2.14 with same result.\n> <appender name=\"testlogger\" \nclass=\"org.apache.log4j.DailyRollingFileAppender\">\n>         <param name=\"File\" value=\"C:\\\\Program \n> Files\\\\NCR\\\\Testing\\\\testlogger.log\"/>\n>         <param name=\"DatePattern\" value=\"'.'dd\"/>\n>         <layout class=\"org.apache.log4j.PatternLayout\">\n>          \t<param name=\"ConversionPattern\" value=\"%d{ISO8601} (%p) %m%n\"/>\n> \t</layout>\n> \t<filter class=\"com.ncr.tvi.logger.TVILevelRangeFilter\">\n> \t\t<!-- param name=\"LevelMin\" value=\"TRACE_0\"/ -->\n> \t\t<param name=\"LevelMin\" value=\"TRACE_0\"/>\n> \t\t<param name=\"LevelMax\" value=\"FATAL\"/>\n> \t</filter>\n>     </appender>\n\n(In reply to comment #1)\n> Sorry can't understand problem description and can't reproduce since you are \nusing a custom filter.  \n> Marking as NEEDINFO.\n\n", "id": 107937, "time": "2007-09-09T23:24:57Z", "creator": "shukla.shankar.ravi@gmail.com", "creation_time": "2007-09-09T23:24:57Z", "is_private": false}, {"count": 3, "attachment_id": null, "bug_id": 41980, "text": "I also have difficulties of understanding your wording.  If the log file keeps getting new entries but the modification date in Windows Explorer does not change, then it is a Windows issue.  If the log file for some reason does not change at all even if log messages are written steadily and the logging application works as expected, it could be that the automatic flushing of the buffers after each write has been disabled.\n\nCan you create a small program with a log4j file which shows this behaviour, and attach it to this bug?\n\nIn the meantime I would suggest marking this bug NEEDINFO.", "id": 118163, "time": "2008-07-01T15:21:57Z", "creator": "thorbjoern@gmail.com", "creation_time": "2008-07-01T15:21:57Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 41980, "attachment_id": null, "id": 119691, "time": "2008-08-11T13:13:03Z", "creator": "weiping.tech@gmail.com", "creation_time": "2008-08-11T13:13:03Z", "is_private": false, "text": "I also have the same problem, below is info to reproduce. It doesn't happen\nin (SunOS 5.10 Generic_118833-36 sun4v sparc SUNW,Sun-Fire-T200)\n\n1. Environment\n  Running platform: Windows XP Professional 5.1.2600 SP2 Build 2600\n  Java: Java HotSpot(TM) Client VM (build 1.5.0_13-b05, mixed mode)\n  Log4J: log4j-1.2.15\n\n2. Test driver\npackage test;\nimport org.apache.log4j.Logger;\npublic class LogFileTester extends Thread {\n\tprivate Logger logger = null;\n\tprivate LogFileTester() {\n\t\tlogger = Logger.getLogger( LogFileTester.class );\n\t}\n\tpublic static void main( String[] args ) {\n\t\tThread testThread = new LogFileTester();\n\t\ttestThread.start();\n\t}\n\tpublic void run() {\n\t\tString msg = null;\n\t\tint cnt = 0;\n\t\twhile( cnt < 120 ) {  // Loop 10 minutes\n\t\t\ttry {\n\t\t\t\tmsg = \"[LogFileTester.run] cnt=\" + cnt++;\n\t\t\t\tSystem.out.println( msg );\n\t\t\t\tlogger.debug( msg );\t// The log file is updated, but \"Modified Date\" timestamp doesn't change!!\n\t\t\t\tsleep( 5000 );\t\t\t// Sleep 5 seconds\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t}\n\t}\n}\n\n3. Log4j configuration file\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE log4j:configuration SYSTEM \"log4j.dtd\">\n<log4j:configuration xmlns:log4j=\"http://jakarta.apache.org/log4j/\" debug=\"false\">\n   <appender name=\"FILE\" class=\"org.apache.log4j.DailyRollingFileAppender\"> \n      <param name=\"File\" value=\"log4j.log\"/>\n      <param name=\"Append\" value=\"false\"/>\n      <layout class=\"org.apache.log4j.PatternLayout\">\n         <param name=\"ConversionPattern\" value=\"%d %-5p [%c] %m%n\"/>\n      </layout>\n   </appender>\n   <appender name=\"CONSOLE\" class=\"org.apache.log4j.ConsoleAppender\">\n      <param name=\"Target\" value=\"System.out\"/>\n      <param name=\"Threshold\" value=\"ERROR\"/>\n      <layout class=\"org.apache.log4j.PatternLayout\">\n         <!-- The default pattern: Date Priority [Category] Message\\n -->\n         <param name=\"ConversionPattern\" value=\"%d{ABSOLUTE} %-5p [%c{1}] %m%n\"/>\n      </layout>\n   </appender>\n   <root>\n      <priority value=\"DEBUG\" />\n      <appender-ref ref=\"CONSOLE\"/>\n      <appender-ref ref=\"FILE\"/>\n   </root>\n</log4j:configuration>\n\n"}, {"count": 5, "tags": [], "bug_id": 41980, "text": "Once the test driver thread stops, the log file's timestamp does got updated.\n", "id": 119692, "time": "2008-08-11T13:18:22Z", "creator": "weiping.tech@gmail.com", "creation_time": "2008-08-11T13:18:22Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 41980, "attachment_id": null, "text": "From http://msdn.microsoft.com/en-us/library/ms724290(VS.85).aspx:\n\nTimestamps are updated at various times and for various reasons. The only guarantee about a file timestamp is that the file time is correctly reflected when the handle that makes the change is closed.\n\nThe current log file is kept continually open which means that there is no guarantee that the last modified time would reflect the last write to the file.\n\nThis doesn't appear to be a bug.", "id": 119693, "time": "2008-08-11T13:32:05Z", "creator": "carnold@apache.org", "creation_time": "2008-08-11T13:32:05Z", "is_private": false}, {"count": 7, "text": "I agree.\n\nIf the contents of the log file is updated as expected then log4j is working as it should.  It is up to the operating system to update metadata like the modified time of the file.  Question is whether the JVM \"File\" can nudge Windows to update this field?\n\n", "bug_id": 41980, "attachment_id": null, "id": 119706, "time": "2008-08-12T04:01:46Z", "creator": "thorbjoern@gmail.com", "creation_time": "2008-08-12T04:01:46Z", "tags": [], "is_private": false}]