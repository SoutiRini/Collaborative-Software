[{"count": 0, "attachment_id": null, "creator": "laurent.faillie@st.com", "text": "Hello,\n\nI running on an HP-UX 11.11 712 box, and I have compiled apache 2.2.4 with GCC.\nI have took mod_dbd.c from truck due to several bugs in the version provided w/\n2.2.4.\n\nI'm authenticating my users against a PostgreSQL database w/ following directives :\n\nAuthType Basic\nAuthName \"mariage\"\nAuthBasicProvider dbd\nRequire valid-user\nAuthDBDUserPWQuery \"select passwd from test.comptes where id = %s\"\n\nUnfortunately, I have to enter 4 or 5 time my username password before being\naccepted by apache. In error.log, I got many \n[Mon Jun 25 12:08:28 2007] [error] [client 164.129.228.100] user myuser :\n authentication failure for \"/~laurent/\": Password Mismatch\n\nIt's not a problem of password as I typed exactly the same one (copy/past), and\nevery time I'm restarting apache, the password is asked another 4 or 5 time\nbefore being accepted.\n\nI can spend some time for debugging if needed, but I duno where to start.\n\nBest regards,\n\nLaurent", "id": 104676, "time": "2007-06-25T05:43:49Z", "bug_id": 42732, "creation_time": "2007-06-25T05:43:49Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 42732, "attachment_id": null, "id": 104680, "time": "2007-06-25T06:21:50Z", "creator": "tony@pc-tony.com", "creation_time": "2007-06-25T06:21:50Z", "is_private": false, "text": "Laurent, \n\nThis is not the place to obtain support for your issues.  Rather go to\n\"http://httpd.apache.org/docs/2.2/faq/\" and use opne of those methods to get\nsome help.  This forum is for the reporting of bugs in the product.  If indeed\nthere is a bug found, please come back here an re-open this issue.\n\nThanks,\nTony\n"}, {"count": 2, "tags": [], "creator": "laurent.faillie@st.com", "text": "It's not a misconfiguration but really a bug : I did several tests and generated\nsome log on the database.\n\nwhen the password is rejected, Apache did initiated the connection but the query\ndidn't run.\n\nDEBUG:  bind <unnamed> to authn_dbd_1\nDEBUG:  StartTransactionCommand\nDEBUG:  StartTransaction\nDEBUG:  name: unnamed; blockState:       DEFAULT; state: INPROGR, xid/subid/cid:\n3116/1/0, nestlvl: 1, children: <>\nLOG:  execute authn_dbd_1: PREPARE authn_dbd_1 (varchar) AS select passwd from\ntest.comptes where id = $1\nDETAIL:  parameters: $1 = 'Test'\nDEBUG:  CommitTransactionCommand\nDEBUG:  CommitTransaction\nDEBUG:  name: unnamed; blockState:       STARTED; state: INPROGR, xid/subid/cid:\n3116/1/1, nestlvl: 1, children: <>\n\nWhen the password is accepted, Apache initiate the connection and then a query\nis issued on the database.\n\nDEBUG:  bind <unnamed> to authn_dbd_1\nDEBUG:  StartTransactionCommand\nDEBUG:  StartTransaction\nDEBUG:  name: unnamed; blockState:       DEFAULT; state: INPROGR, xid/subid/cid:\n3120/1/0, nestlvl: 1, children: <>\nLOG:  execute authn_dbd_1: PREPARE authn_dbd_1 (varchar) AS select passwd from\ntest.comptes where id = $1\nDETAIL:  parameters: $1 = 'Test'\nDEBUG:  CommitTransactionCommand\nDEBUG:  CommitTransaction\nDEBUG:  name: unnamed; blockState:       STARTED; state: INPROGR, xid/subid/cid:\n3120/1/1, nestlvl: 1, children: <>\nDEBUG:  bind <unnamed> to authn_dbd_1\nDEBUG:  StartTransactionCommand\nDEBUG:  StartTransaction\nDEBUG:  name: unnamed; blockState:       DEFAULT; state: INPROGR, xid/subid/cid:\n3121/1/0, nestlvl: 1, children: <>\nLOG:  execute authn_dbd_1: PREPARE authn_dbd_1 (varchar) AS select passwd from\ntest.comptes where id = $1\nDETAIL:  parameters: $1 = 'Test'\nDEBUG:  CommitTransactionCommand\nDEBUG:  CommitTransaction\nDEBUG:  name: unnamed; blockState:       STARTED; state: INPROGR, xid/subid/cid:\n3121/1/1, nestlvl: 1, children: <>\nDEBUG:  bind <unnamed> to authn_dbd_1\nDEBUG:  StartTransactionCommand\nDEBUG:  StartTransaction\nDEBUG:  name: unnamed; blockState:       DEFAULT; state: INPROGR, xid/subid/cid:\n3122/1/0, nestlvl: 1, children: <>\nLOG:  execute authn_dbd_1: PREPARE authn_dbd_1 (varchar) AS select passwd from\ntest.comptes where id = $1\nDETAIL:  parameters: $1 = 'Test'\nDEBUG:  CommitTransactionCommand\nDEBUG:  CommitTransaction\nDEBUG:  name: unnamed; blockState:       STARTED; state: INPROGR, xid/subid/cid:\n3122/1/1, nestlvl: 1, children: <>\nDEBUG:  bind <unnamed> to authn_dbd_1\nDEBUG:  StartTransactionCommand\nDEBUG:  StartTransaction\nDEBUG:  name: unnamed; blockState:       DEFAULT; state: INPROGR, xid/subid/cid:\n3123/1/0, nestlvl: 1, children: <>\nLOG:  execute authn_dbd_1: PREPARE authn_dbd_1 (varchar) AS select passwd from\ntest.comptes where id = $1\nDETAIL:  parameters: $1 = 'Test'\nDEBUG:  CommitTransactionCommand\nDEBUG:  CommitTransaction\nDEBUG:  name: unnamed; blockState:       STARTED; state: INPROGR, xid/subid/cid:\n3123/1/1, nestlvl: 1, children: <>\nDEBUG:  bind <unnamed> to authn_dbd_1\nDEBUG:  StartTransactionCommand\nDEBUG:  StartTransaction\nDEBUG:  name: unnamed; blockState:       DEFAULT; state: INPROGR, xid/subid/cid:\n3124/1/0, nestlvl: 1, children: <>\nLOG:  execute authn_dbd_1: PREPARE authn_dbd_1 (varchar) AS select passwd from\ntest.comptes where id = $1\nDETAIL:  parameters: $1 = 'Test'\nDEBUG:  CommitTransactionCommand\nDEBUG:  CommitTransaction\nDEBUG:  name: unnamed; blockState:       STARTED; state: INPROGR, xid/subid/cid:\n3124/1/1, nestlvl: 1, children: <>\nLOG:  connection received: host=[local]\nDEBUG:  forked new backend, pid=18697 socket=7\nLOG:  connection authorized: user=www database=www\nDEBUG:  postgres child[18697]: starting with (\nDEBUG:  \tpostgres\nDEBUG:  \t-v196608\nDEBUG:  \t-y\nDEBUG:  \twww\nDEBUG:  )\nDEBUG:  InitPostgres\nDEBUG:  StartTransaction\nDEBUG:  name: unnamed; blockState:       DEFAULT; state: INPROGR, xid/subid/cid:\n3125/1/0, nestlvl: 1, children: <>\nDEBUG:  CommitTransaction\nDEBUG:  name: unnamed; blockState:       STARTED; state: INPROGR, xid/subid/cid:\n3125/1/0, nestlvl: 1, children: <>\nDEBUG:  StartTransactionCommand\nDEBUG:  StartTransaction\nDEBUG:  name: unnamed; blockState:       DEFAULT; state: INPROGR, xid/subid/cid:\n3126/1/0, nestlvl: 1, children: <>\nLOG:  statement: SELECT *, TO_CHAR(expiration, 'YYYYMMDD') AS expiration FROM\nhebergement.site WHERE id='Test';\nDEBUG:  parse tree:\nDETAIL:  {QUERY :commandType 1 :querySource 0 :canSetTag true :utilityStmt <>\n\t:resultRelation 0 :into <> :intoOptions <> :intoOnCommit 0 :intoTableSpaceName ...\n\nAccording to PostgreSQL log, it seems the connection hasn't a \"working\" status\n(expired ?), and this time, apache is doing several attempts, all failing and\nfinally create a new connection and do the query, successfully this time.\n\nBest regards,\n\nLaurent\n", "id": 105084, "time": "2007-07-05T04:58:31Z", "bug_id": 42732, "creation_time": "2007-07-05T04:58:31Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 42732, "text": "Hi Laurent,\n\nI fixed my 2.2.4 dbd authn problems by using the mod_dbd.c from trunk.  See this\nmessage:\n\nhttp://article.gmane.org/gmane.comp.apache.devel/31168\n\nRegards, Phil.\n", "id": 107280, "time": "2007-08-27T04:25:16Z", "creator": "spam_from_apache_bugzilla@chezphil.org", "creation_time": "2007-08-27T04:25:16Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "laurent.faillie@st.com", "attachment_id": null, "id": 108332, "time": "2007-09-18T06:37:30Z", "bug_id": 42732, "creation_time": "2007-09-18T06:37:30Z", "is_private": false, "text": "Sorry for my silence (I was in paternity leave ;-D).\n\nI compiled this patch but I'm not able anymore to restart 2.2.4 (nothing related\nto this patch, httpd crash at startup on my system depending on my configuration\nsetting).\n\nAnyway, I've installed 2.2.6 and the problem is still here. Can I test this\npatch w/ 2.2.6 ?\n\nBye\n\nLaurent\n"}]