[{"count": 0, "tags": [], "creator": "peter.schlaf@web.de", "text": "2 PCs with httpd-2.0.55 running and https enabled (OS SLES9). The first one is\nthe \"real\" webserver with all the documents (HTML-pages, etc), the other\nwebserver is configured as a reverse proxy which gets all the data from the\n\"real\" webserver.\n\nWith a browser I can access both webservers and everything seems to be OK.\n\nThe problem: \nWhen I get a form (method=\"post\") through the reverse proxy and send it back,\nsome of the \"post\"ed data dont reach the \"real\" webserver.\nIt seems to happen always if the total amount of posted data is larger than 8\nkbytes.\n\nWhen I get a form from the \"real\" webserver directly and send it back there is\nno loss of data (at any amount).\n\nThe \"real\" webserver and the reverse proxy are talking via https to each other.\nSwitching to http does not solve the problem.\n\nWhen _both_ webservers are switched to http the problem has disappeared, but\nthis is not really a solution for me.\n\nDowngrading the reverse proxy to httpd-2.0.54 (both webservers with https,\n\"real\" webserver stays with httpd-2.0.55) solved the problem. \n\nDuring all tries I left the httpd.conf and ssl.conf unchanged (exception:\nProxyPass and ProxyPassReverse for http/https switching of course)\n\nReverse proxy configuration:\n<IfModule mod_proxy.c>\n    SSLProxyEngine       on\n    ProxyRequests        off\n    ProxyPass            /  https://10.34.56.78/\n    ProxyPassReverse     /  https://10.34.56.78/\n</IFModule>", "id": 81325, "time": "2005-10-18T15:37:56Z", "bug_id": 37145, "creation_time": "2005-10-18T15:37:56Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "rpluem@apache.org", "text": "Thanks for the report. Some questions:\n1. Could you please attach an errorlog for a problematic POST request with\nLogLevel set to debug?\n2. You say that some of the data posted gets lost when the posted data is larger\nthan 8k. Can you specify how much data gets lost (e.g. Does everything beyond\nthe first 8k get lost or are only the last 8k missing or something else)?", "id": 81349, "time": "2005-10-18T21:38:18Z", "bug_id": 37145, "creation_time": "2005-10-18T21:38:18Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "rpluem@apache.org", "text": "Please enable also mod_dumpio on the reverse proxy,\nset\n\nDumpIOInput On\n\nin your configuration and attach the output for a faulty POST request (contained\nin errorlog file).", "id": 81350, "time": "2005-10-18T22:08:56Z", "bug_id": 37145, "creation_time": "2005-10-18T22:08:56Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "After a short discussion on IRC with William A. Rowe, Jr. (a.k.a. wrowe,\nOtherBill), he additionally proposed to add the following patch to your reverse\n proxy and check if the problem is gone then:\nhttp://people.apache.org/~wrowe/httpd-2.0-proto-timeout.patch", "attachment_id": null, "id": 81352, "creator": "rpluem@apache.org", "time": "2005-10-18T23:44:51Z", "bug_id": 37145, "creation_time": "2005-10-18T23:44:51Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 37145, "attachment_id": null, "is_private": false, "id": 81361, "time": "2005-10-19T03:00:47Z", "creator": "rpluem@apache.org", "creation_time": "2005-10-19T03:00:47Z", "text": "As of now I guess you can wait with answering my questions / adding OtherBills\npatch. I already have an idea what the reason is and need to discuss this with\nthe other developers on the dev list."}, {"count": 5, "tags": [], "bug_id": 37145, "attachment_id": null, "is_private": false, "id": 81367, "time": "2005-10-19T10:15:23Z", "creator": "peter.schlaf@web.de", "creation_time": "2005-10-19T10:15:23Z", "text": "The patch was applied and didn't solve the problem.\n\nIn a form with a lot of <input type=\"hidden\" ..> lines only the _last_ approx. 8\nkbytes reach the \"real\" webserver (visible by dumping the $_POST hash in the\n\"action\" PHP-script). All data posted before are lost.\n\nUsing the form content <input type=\"file\" ..> I can only upload files smaller\nthan 7660 bytes. Otherwise I get an error-message of the \"action\"-script\ncomplaining about missing parameters."}, {"attachment_id": 16743, "tags": [], "bug_id": 37145, "is_private": false, "count": 6, "id": 81369, "time": "2005-10-19T11:07:51Z", "creator": "rpluem@apache.org", "creation_time": "2005-10-19T11:07:51Z", "text": "Created attachment 16743\nPatch against 2.0.55\n\nCould you please give the attached patch a try (on the reverse proxy)? I have\nnot finished my discussion on possible sideeffects with other developers, so\nthe patch might be subject to change. But it would be helpful to know if it\nfixes your problem."}, {"count": 7, "tags": [], "creator": "peter.schlaf@web.de", "text": "Your attached patch solved the problem. :-)\n\nThank you very much!", "id": 81370, "time": "2005-10-19T11:21:26Z", "bug_id": 37145, "creation_time": "2005-10-19T11:21:26Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "text": "Created attachment 16744\nFix 3 addtional occurences. Patch against 2.0.55\n\nCan you please also test the following extended patch? Meanwhile I identified 3\nothers positions in the proxy code path which can cause this kind of trouble.\nWould be nice if you can give it a try too :-)", "attachment_id": 16744, "id": 81371, "creator": "rpluem@apache.org", "time": "2005-10-19T12:29:01Z", "bug_id": 37145, "creation_time": "2005-10-19T12:29:01Z", "is_private": false}, {"count": 9, "attachment_id": null, "creator": "peter.schlaf@web.de", "text": "(In reply to comment #8)\n> Fix 3 addtional occurences. Patch against 2.0.55\n\nThis patch is working fine either. The reverse proxy performs perfectly. No loss\nof data anymore.", "id": 81379, "time": "2005-10-19T13:07:43Z", "bug_id": 37145, "creation_time": "2005-10-19T13:07:43Z", "tags": [], "is_private": false}, {"count": 10, "tags": [], "text": "Thanks for the fast feedback.", "attachment_id": null, "id": 81380, "creator": "rpluem@apache.org", "time": "2005-10-19T14:22:37Z", "bug_id": 37145, "creation_time": "2005-10-19T14:22:37Z", "is_private": false}, {"count": 11, "tags": [], "bug_id": 37145, "attachment_id": null, "is_private": false, "id": 81659, "time": "2005-10-24T19:31:20Z", "creator": "jumper99@gmx.de", "creation_time": "2005-10-24T19:31:20Z", "text": "(In reply to comment #10)\n> Thanks for the fast feedback.\n\nJFYI, this patch is also working fine with Outlook Web Access on IIS6 as proxied\nmachine."}, {"count": 12, "tags": [], "creator": "rpluem@apache.org", "attachment_id": null, "id": 81664, "time": "2005-10-24T20:41:34Z", "bug_id": 37145, "creation_time": "2005-10-24T20:41:34Z", "is_private": false, "text": "Meanwhile the patch was commited to trunk (r327590):\nhttp://svn.apache.org/viewcvs?rev=327590&view=rev \n\nTo 2.2.x (r327592):\nhttp://svn.apache.org/viewcvs?rev=327592&view=rev\n\nand proposed for backport to 2.0.x:\nhttp://svn.apache.org/viewcvs?rev=327597&view=rev"}, {"count": 13, "attachment_id": null, "creator": "baptiste.desprez@polytechnique.fr", "text": "*** Bug 37251 has been marked as a duplicate of this bug. ***", "id": 81764, "time": "2005-10-26T13:15:29Z", "bug_id": 37145, "creation_time": "2005-10-26T13:15:29Z", "tags": [], "is_private": false}, {"count": 14, "tags": [], "bug_id": 37145, "attachment_id": null, "is_private": false, "id": 82739, "time": "2005-11-22T22:06:21Z", "creator": "rpluem@apache.org", "creation_time": "2005-11-22T22:06:21Z", "text": "*** Bug 37421 has been marked as a duplicate of this bug. ***"}, {"count": 15, "tags": [], "bug_id": 37145, "text": "*** Bug 37739 has been marked as a duplicate of this bug. ***", "id": 83368, "time": "2005-12-07T12:21:39Z", "creator": "marco.casavecchia@comune.ancona.it", "creation_time": "2005-12-07T12:21:39Z", "is_private": false, "attachment_id": null}, {"count": 16, "tags": [], "bug_id": 37145, "text": "*** Bug 38141 has been marked as a duplicate of this bug. ***", "id": 84280, "time": "2006-01-05T21:10:42Z", "creator": "rpluem@apache.org", "creation_time": "2006-01-05T21:10:42Z", "is_private": false, "attachment_id": null}, {"count": 17, "tags": [], "bug_id": 37145, "attachment_id": null, "is_private": false, "id": 84760, "time": "2006-01-19T00:44:23Z", "creator": "lswick@spikesource.com", "creation_time": "2006-01-19T00:44:23Z", "text": "\nAny timeframe on when 2.0.56 will be out with the patch in it?\n\nLorinda"}, {"count": 18, "tags": [], "text": "The patch has been backported to 2.0.x r372046\n(http://svn.apache.org/viewcvs?rev=372046&view=rev) and will be part of 2.0.56.\nFor the status of 2.0.56 please have a look at\nhttp://svn.apache.org/viewcvs.cgi/httpd/httpd/branches/2.0.x/STATUS?view=markup.", "attachment_id": null, "id": 85405, "creator": "rpluem@apache.org", "time": "2006-02-04T11:20:45Z", "bug_id": 37145, "creation_time": "2006-02-04T11:20:45Z", "is_private": false}, {"count": 19, "tags": [], "bug_id": 37145, "text": "*** Bug 38837 has been marked as a duplicate of this bug. ***", "id": 86455, "time": "2006-03-03T15:14:41Z", "creator": "rpluem@apache.org", "creation_time": "2006-03-03T15:14:41Z", "is_private": false, "attachment_id": null}, {"count": 20, "attachment_id": null, "creator": "rpluem@apache.org", "text": "*** Bug 38974 has been marked as a duplicate of this bug. ***", "id": 86834, "time": "2006-03-15T09:09:49Z", "bug_id": 37145, "creation_time": "2006-03-15T09:09:49Z", "tags": [], "is_private": false}, {"count": 21, "tags": [], "bug_id": 37145, "text": "*** Bug 39274 has been marked as a duplicate of this bug. ***", "id": 87806, "time": "2006-04-11T22:22:37Z", "creator": "rpluem@apache.org", "creation_time": "2006-04-11T22:22:37Z", "is_private": false, "attachment_id": null}, {"count": 22, "attachment_id": null, "creator": "nick@webthing.com", "text": "*** Bug 38505 has been marked as a duplicate of this bug. ***", "id": 88893, "time": "2006-05-08T00:28:22Z", "bug_id": 37145, "creation_time": "2006-05-08T00:28:22Z", "tags": [], "is_private": false}, {"count": 23, "tags": [], "creator": "asg1290@yahoo.com", "text": "I am still seeing these errors on 2.0.58 & 2.2.2 using mod_proxy for a reverse\nproxy for RPC over HTTP and Exchange.  Downgrading to 2.0.54 fixes the problem,\nmaybe there are still some other occurences besides the ones patched here that\nhave not been fixed?  I also tried this on 2.2.2 and it didn't work either.\n\n[Tue Jun 27 18:08:08 2006] [error] (70014)End of file found: proxy: prefetch\nrequest body failed to 10.2.181.53 from 15.235.153.107 ()\n[Tue Jun 27 19:07:46 2006] [error] (104)Connection reset by peer: proxy:\nprefetch request body failed to 10.2.181.53 from 10.2.181.18 ()\n", "id": 90748, "time": "2006-06-29T00:30:22Z", "bug_id": 37145, "creation_time": "2006-06-29T00:30:22Z", "is_private": false, "attachment_id": null}, {"count": 24, "tags": [], "bug_id": 37145, "is_private": false, "text": "Sorry, but currently I do not see a relation to this bug. Your error messages\nindicate that the connection to the client broke during reading the POST request\nbody. This bug is about POST request bodies passed to the backend server getting\ncorrupted.", "id": 90754, "time": "2006-06-29T09:34:57Z", "creator": "rpluem@apache.org", "creation_time": "2006-06-29T09:34:57Z", "attachment_id": null}]