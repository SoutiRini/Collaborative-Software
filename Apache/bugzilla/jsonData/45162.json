[{"count": 0, "tags": [], "creator": "gaorongfu@gmail.com", "attachment_id": null, "id": 117488, "time": "2008-06-08T18:48:33Z", "bug_id": 45162, "creation_time": "2008-06-08T18:48:33Z", "is_private": false, "text": "data validation can't use operator 'between', or a exception was thrown when called the constructor HSSFWorkbook(new FileInputStream(\".....\")), and file load failure.\nthis bug appears even when loading a excel document writen by poi api,or  loading one writen by ms excel 2003.\nthe exception is:\n\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n        at org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:199)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:117)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:207)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:259)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:240)\n        at org.apache.jsp.crm.downloadTemplate_jsp._jspService(downloadTemplate_jsp.java:191)\n        at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:133)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:856)\n        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:311)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:301)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:248)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:856)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:284)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:204)\n        at tlz.filter.AccessControl.doFilter(AccessControl.java:102)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:233)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:204)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:256)\n        at org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:151)\n        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:563)\n        at org.apache.catalina.core.StandardContextValve.invokeInternal(StandardContextValve.java:245)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:199)\n        at org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:151)\n        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:563)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:195)\n        at org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:151)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:164)\n        at org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:149)\n        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:563)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:156)\n        at org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:151)\n        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:563)\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:972)\n\n        at org.apache.coyote.tomcat5.CoyoteAdapter.service(CoyoteAdapter.java:209)\n        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:781)\n        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:549)\n        at org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:589)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:666)\n        at java.lang.Thread.run(Thread.java:536)\nCaused by: java.lang.reflect.InvocationTargetException\n        at sun.reflect.GeneratedConstructorAccessor27.newInstance(Unknown Source)\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:274)\n        at org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:187)\n        ... 38 more\nCaused by: java.lang.ArrayIndexOutOfBoundsException\n        at org.apache.poi.hssf.record.RecordInputStream.checkRecordPosition(RecordInputStream.java:132)\n        at org.apache.poi.hssf.record.RecordInputStream.readShort(RecordInputStream.java:152)\n        at org.apache.poi.hssf.util.HSSFCellRangeAddress.fillFields(HSSFCellRangeAddress.java:77)\n        at org.apache.poi.hssf.util.HSSFCellRangeAddress.<init>(HSSFCellRangeAddress.java:65)\n        at org.apache.poi.hssf.record.DVRecord.fillFields(DVRecord.java:207)\n        at org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n        at org.apache.poi.hssf.record.DVRecord.<init>(DVRecord.java:134)\n        ... 42 more"}, {"count": 1, "tags": [], "text": "This looks a lot like bug 44710.\n\nPlease re-test with latest svn trunk / nightly build (e.g. http://encore.torchbox.com/poi-svn-build/poi-3.1-beta3-20080620.jar)\n\nIf the problem persists, re-open this bugzilla.", "is_private": false, "id": 117849, "creation_time": "2008-06-20T01:09:36Z", "time": "2008-06-20T01:09:36Z", "creator": "josh@apache.org", "bug_id": 45162, "attachment_id": null}]