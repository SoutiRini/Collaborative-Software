[{"count": 0, "tags": [], "creator": "roberto.manicardi@gmail.com", "is_private": false, "id": 129351, "attachment_id": 24073, "bug_id": 47616, "creation_time": "2009-07-31T07:55:24Z", "time": "2009-07-31T07:55:24Z", "text": "Created attachment 24073\nThe original XLSX file\n\nHi,\n\nI've tried the new tool to import XML into XSLSX files using the Custom XML mapping and I found a problem.\n\nIf you load an XSLS file, import data from XML and then save the XLSX back to file, the xmlMaps.xml part becomes corrupted.\n\nI've attached two XLSX file to show the problem.\n\nIf you open the original xmlMaps.xml file it looks like this:\n\n<Schema \n   ID=\"Schema13\" \n   Namespace=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\">\n   \n  <xsd:schema \n    targetNamespace=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\"\n    elementFormDefault=\"qualified\"\n    xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\"  \n    xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\">\n\n\nwhile the file saved from POI looks like this:\n\n<Schema \n   ID=\"Schema13\" \n   Namespace=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\">\n   <xsd:schema \n      targetNamespace=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\"\n      elementFormDefault=\"qualified\" \n      xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\">\n\n\nIt seems that the xmlns attribute of the inner xsd:schema element is removed by XMLBeans (I don't know if it's not saved or not readed from the original file)."}, {"count": 1, "text": "Created attachment 24074\nThe file modified by POI", "bug_id": 47616, "is_private": false, "id": 129352, "time": "2009-07-31T07:55:47Z", "creator": "roberto.manicardi@gmail.com", "creation_time": "2009-07-31T07:55:47Z", "tags": [], "attachment_id": 24074}, {"count": 2, "tags": [], "bug_id": 47616, "attachment_id": null, "text": "Roberto,\n\nplease post a complete example how to reproduce the problem - I don't quite understand what is wrong. \n\nLoad / Save of the attached file works OK. \nI tried to apply the code from TestXSSFImportFromXML.testMultiTable() to the attached file and it produced a valid xlsx output.\n\nBasically, you need to tell XmlBeans that you are saving a file with additional namespaces. A good example how to do it is XSSFDrawing.commit().\n\nYegor", "id": 129680, "time": "2009-08-13T10:49:51Z", "creator": "yegor@dinom.ru", "creation_time": "2009-08-13T10:49:51Z", "is_private": false}, {"count": 3, "tags": [], "creator": "dominik.stadler@gmx.at", "text": "No update since a long time and the bug is not reproducible, therefore closing this WORKSFORME for now, please post more information if you still think there is a bug.", "id": 183944, "attachment_id": null, "bug_id": 47616, "creation_time": "2015-07-07T20:04:50Z", "time": "2015-07-07T20:04:50Z", "is_private": false}]