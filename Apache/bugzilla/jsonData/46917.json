[{"count": 0, "text": "With some of my XLS input files I get a LeftoverDataException like this:\n\nException in thread \"main\" org.apache.poi.hssf.record.RecordInputStream$LeftoverDataException: Initialisation of record 0xB6 left 6 bytes remaining still to be read.\n        at org.apache.poi.hssf.record.RecordInputStream.hasNextRecord(RecordInputStream.java:124)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:367)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:277)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:202)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:184)\n        at ExcelExtractor.openWorkbook(ExcelExtractor.java:668)\n\nI tried with the latest update from svn from March 26.\n\nThere is no such exception opening the XLS file with POI3.1\n\nThe data file itself is confidential. What could I do to help debug this.\n\n\nRegards,\nAxel.", "creator": "axel.roeslein@googlemail.com", "is_private": false, "id": 125802, "time": "2009-03-26T03:53:16Z", "bug_id": 46917, "creation_time": "2009-03-26T03:53:16Z", "tags": [], "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 46917, "attachment_id": null, "is_private": false, "id": 125806, "time": "2009-03-26T05:04:39Z", "creator": "apache@gagravarr.org", "creation_time": "2009-03-26T05:04:39Z", "text": "Can you identify the bit of the file in question, then send us the BiffViewer output for that record + the ones either side, and the POIFSViewer binary data for the record?\n\nThat'll let us re-create the record problem without needing the whole file"}, {"count": 2, "tags": [], "text": "BiffViewer itself warns while reading in the file in question\n\n\n~/work/poi35svn > java -cp build/classes org.apache.poi.hssf.dev.BiffViewer /tmp/t.xls > /tmp/t.biff\norg.apache.poi.hssf.record.RecordInputStream$LeftoverDataException: Initialisation of record 0xB6 left 6 bytes remaining still to be read.\n        at org.apache.poi.hssf.record.RecordInputStream.hasNextRecord(RecordInputStream.java:124)\n        at org.apache.poi.hssf.dev.BiffViewer.createRecords(BiffViewer.java:70)\n        at org.apache.poi.hssf.dev.BiffViewer.main(BiffViewer.java:398)\nDiscarding 6 bytes and continuing\norg.apache.poi.hssf.record.RecordInputStream$LeftoverDataException: Initialisation of record 0xB6 left 12 bytes remaining still to be read.\n        at org.apache.poi.hssf.record.RecordInputStream.hasNextRecord(RecordInputStream.java:124)\n        at org.apache.poi.hssf.dev.BiffViewer.createRecords(BiffViewer.java:70)\n        at org.apache.poi.hssf.dev.BiffViewer.main(BiffViewer.java:398)\nDiscarding 12 bytes and continuing\n\n\nThis is probably the interesting extract:\n\n\nOffset=0x000313ED(201709) recno=7107 sid=0x00D7 size=0x0044(68)\n[DBCELL]\n    .rowoffset = 0x00003960\n    .cell_0 = 0x0000\n    .cell_1 = 0x026C\n    .cell_2 = 0x0030\n    .cell_3 = 0x0024\n    .cell_4 = 0x0018\n    .cell_5 = 0x0136\n    .cell_6 = 0x00C2\n    .cell_7 = 0x0298\n    .cell_8 = 0x0262\n    .cell_9 = 0x025A\n    .cell_10 = 0x025A\n    .cell_11 = 0x0266\n    .cell_12 = 0x026D\n    .cell_13 = 0x00B6\n    .cell_14 = 0x00C2\n    .cell_15 = 0x0298\n    .cell_16 = 0x0262\n    .cell_17 = 0x0260\n    .cell_18 = 0x0268\n    .cell_19 = 0x0258\n    .cell_20 = 0x026D\n    .cell_21 = 0x00B6\n    .cell_22 = 0x028D\n    .cell_23 = 0x00B6\n    .cell_24 = 0x00B6\n    .cell_25 = 0x0136\n    .cell_26 = 0x00C2\n    .cell_27 = 0x029E\n    .cell_28 = 0x0268\n    .cell_29 = 0x0260\n    .cell_30 = 0x0260\n    .cell_31 = 0x026C\n    .cell_32 = 0x026D\n[/DBCELL]\n\n\n\nOffset=0x0001EB58(125784) recno=4247 sid=0x00B4 size=0x0002(2)\n[SXIVD] (0xB4)\n  rawData=[FE, FF]\n[/SXIVD]\n\n[SXPI]\n    .isxvi      =0x0005\n    .isxvd      =0x7FFD\n    .idObj      =0x0001\n[/SXPI]\n\nOffset=0x0001EB5E(125790) recno=4248 sid=0x00B6 size=0x000C(12)\nOffset=0x0001EB6E(125806) recno=4249 sid=0x00C5 size=0x0036(54)\n[SXDI]\n  .isxvdData = 0x0006\n  .iiftab = 0x0000\n  .df = 0x0000\n  .isxvd = 0x0000\n  .isxvi = 0x0000\n  .ifmt = 0x0004\n[/SXDI]\n\n\nOffset=0x000207DC(133084) recno=4564 sid=0x00B4 size=0x0002(2)\n[SXIVD] (0xB4)\n  rawData=[FE, FF]\n[/SXIVD]\n\nOffset=0x000207E2(133090) recno=4565 sid=0x00B6 size=0x0006(6)\n[SXPI]\n    .isxvi      =0x0002\n    .isxvd      =0x7FFD\n    .idObj      =0x0001\n[/SXPI]\n\nOffset=0x000207EC(133100) recno=4566 sid=0x00C5 size=0x0036(54)\n[SXDI]\n  .isxvdData = 0x0006\n  .iiftab = 0x0000\n  .df = 0x0000\n  .isxvd = 0x0000\n  .isxvi = 0x0000\n  .ifmt = 0x0004\n[/SXDI]\n\n\nOffset=0x000208BB(133307) recno=4571 sid=0x00C5 size=0x001B(27)\n[SXDI]\n  .isxvdData = 0x000B\n  .iiftab = 0x0000\n  .df = 0x0000\n  .isxvd = 0x0000\n  .isxvi = 0x0000\n  .ifmt = 0x0004\n[/SXDI]\n\nOffset=0x000208DA(133338) recno=4572 sid=0x00B5 size=0x00B6(182)\n[SXLI] (0xB5)\n  rawData=[00, 00, 00, 00, 03, 00, 00, 00, 03, 00, 00, 00, 0B, 00, 01, 00, 00, 00, 03, 00, 00, 00, 03, 00, 01, 00, 03, 00, 01, 00, 00, 00, 03, 00, 00, 00, 03, 00, 02, 00, 05, 00, 01, 00, 00, 00, 03, 00, 00, 00, 03, 00, 03, 00, 0D, 00, 01, 00, 00, 00, 03, 00, 00, 00, 03, 00, 04, 00, 0F, 00, 01, 00, 00, 00, 03, 00, 00, 00, 03, 00, 05, 00, 0A, 00, 01, 00, 00, 00, 03, 00, 00, 00, 03, 00, 06, 00, 01, 00, 01, 00, 00, 00, 03, 00, 00, 00, 03, 00, 07, 00, 04, 00, 01, 00, 00, 00, 03, 00, 00, 00, 03, 00, 08, 00, 00, 00, 01, 00, 00, 00, 03, 00, 00, 00, 03, 00, 09, 00, 08, 00, 01, 00, 00, 00, 03, 00, 00, 00, 03, 00, 0A, 00, 09, 00, 00, 00, 01, 00, 01, 00, 00, 42, 03, 00, 0A, 00, 09, 00, 00, 00, 0D, 00, 01, 00, 00, 4A, 00, 00, 00, 00, 00, 00]\n[/SXLI]\n\nOffset=0x00020994(133524) recno=4573 sid=0x00B5 size=0x003C(60)\n[SXLI] (0xB5)\n  rawData=[00, 00, 00, 00, 01, 00, 00, 10, 00, 00, 00, 00, 00, 00, 01, 00, 02, 10, 01, 00, 00, 00, 00, 00, 01, 00, 04, 10, 02, 00, 00, 00, 00, 00, 01, 00, 06, 10, 03, 00, 00, 00, 00, 00, 01, 00, 08, 10, 04, 00, 00, 00, 00, 00, 01, 00, 0A, 10, 05, 00]\n[/SXLI]\n\n\nOffset=0x0002218B(139659) recno=4845 sid=0x00B4 size=0x0002(2)\n[SXIVD] (0xB4)\n  rawData=[FE, FF]\n[/SXIVD]\n\nOffset=0x00022191(139665) recno=4846 sid=0x00B6 size=0x0006(6)\n[SXPI]\n    .isxvi      =0x0002\n    .isxvd      =0x7FFD\n    .idObj      =0x0001\n[/SXPI]\n\nOffset=0x0002219B(139675) recno=4847 sid=0x00C5 size=0x0036(54)\n[SXDI]\n  .isxvdData = 0x0006\n  .iiftab = 0x0000\n  .df = 0x0000\n  .isxvd = 0x0000\n  .isxvi = 0x0000\n  .ifmt = 0x0004\n[/SXDI]\n\n\nOffset=0x00025261(152161) recno=5352 sid=0x00B4 size=0x0002(2)\n[SXIVD] (0xB4)\n  rawData=[FE, FF]\n[/SXIVD]\n\nOffset=0x00025267(152167) recno=5353 sid=0x00B6 size=0x0006(6)\n[SXPI]\n    .isxvi      =0x0002\n    .isxvd      =0x7FFD\n    .idObj      =0x0001\n[/SXPI]\n\nOffset=0x00025271(152177) recno=5354 sid=0x00C5 size=0x0036(54)\n[SXDI]\n  .isxvdData = 0x0006\n  .iiftab = 0x0000\n  .df = 0x0000\n  .isxvd = 0x0000\n  .isxvi = 0x0000\n  .ifmt = 0x0004\n[/SXDI]\n\n\nOffset=0x000382CB(230091) recno=8083 sid=0x00B4 size=0x0002(2)\n[SXIVD] (0xB4)\n  rawData=[FE, FF]\n[/SXIVD]\n\n[SXPI]\n    .isxvi      =0x0002\n    .isxvd      =0x7FFD\n    .idObj      =0x0001\n[/SXPI]\n\nOffset=0x000382D1(230097) recno=8084 sid=0x00B6 size=0x0012(18)\nOffset=0x000382E7(230119) recno=8085 sid=0x00C5 size=0x0036(54)\n[SXDI]\n  .isxvdData = 0x0006\n  .iiftab = 0x0000\n  .df = 0x0000\n  .isxvd = 0x0000\n  .isxvi = 0x0000\n  .ifmt = 0x0004\n[/SXDI]\n\n\nI cannot send the output from POIFSViewer as this would show confidential data.\n\n\nRegards,\nAxel.", "is_private": false, "id": 125810, "creator": "axel.roeslein@googlemail.com", "time": "2009-03-26T05:42:20Z", "bug_id": 46917, "creation_time": "2009-03-26T05:42:20Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 46917, "attachment_id": null, "is_private": false, "id": 125817, "time": "2009-03-26T08:27:02Z", "creator": "apache@gagravarr.org", "creation_time": "2009-03-26T08:27:02Z", "text": "Please use biffviewer / eclipse + breakpoint to identify the record in question, then upload the bit of POIFSViewer output for the area around that record. That way, we can re-create the problem record(s) to test with, without needing the whole spreadsheet"}, {"attachment_id": null, "tags": [], "bug_id": 46917, "text": "I just read the MS documentation for SXPI(0x00B6) more closely and it says that the 2 ushort fields of SXPI may be repeated for each field that is showing in the page area.  This seems to agree with the observations here of 6 and 12  bytes left over.\n\nPageItemRecord needs fixing (this was added only recently in 3.5-beta5)", "count": 4, "id": 125822, "time": "2009-03-26T09:59:29Z", "creator": "josh@apache.org", "creation_time": "2009-03-26T09:59:29Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 46917, "text": "Fixed in svn r758770\n\njunit added \n\nsvn.apache.org is *really* slow right now", "count": 5, "id": 125825, "time": "2009-03-26T10:43:37Z", "creator": "josh@apache.org", "creation_time": "2009-03-26T10:43:37Z", "is_private": false}]