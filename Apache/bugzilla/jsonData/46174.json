[{"attachment_id": null, "tags": [], "bug_id": 46174, "is_private": false, "count": 0, "id": 122327, "time": "2008-11-09T23:00:29Z", "creator": "gauravsworld@gmail.com", "creation_time": "2008-11-09T23:00:29Z", "text": "The following snippet of code works perfectly in 3.1 but does not work in 3.2-FINAL. The code below is supposed to create a named reference to a cell but doesn't do so.\n\nHSSFWorkbook wb = new HSSFWorkbook();\nHSSFSheet sheet = wb.createSheet(\"sheet\");\nsheet.createRow(0).createCell(0).setCellValue(\"abcd\");\nHSSFName name = wb.createName();\nname.setNameName(\"HOLAHOLAHOLAH\");\nname.setReference(\"sheet!A1\");\nFileOutputStream fileOut = new FileOutputStream(\"t.xls\");\nwb.write(fileOut);\nfileOut.close();\n\nThere is no mention in the changelog if there was a change to named references so I assume this is an unintended change and hence a bug.\n\nP.S. 3.2-FINAL does not appear in the version selection list above so I chose 3.2-dev instead."}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "text": "Any chance you could upload the output files from 3.1 and 3.2, so we can do a quick diff and see what's different with them?", "id": 122330, "time": "2008-11-10T01:42:41Z", "bug_id": 46174, "creation_time": "2008-11-10T01:42:41Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 46174, "attachment_id": 22848, "id": 122337, "time": "2008-11-10T06:00:34Z", "creator": "gauravsworld@gmail.com", "creation_time": "2008-11-10T06:00:34Z", "is_private": false, "text": "Created attachment 22848\nExcel generated using 3.1-FINAL"}, {"count": 3, "text": "Created attachment 22849\nExcel generated using 3.2-FINAL", "bug_id": 46174, "is_private": false, "id": 122338, "time": "2008-11-10T06:01:08Z", "creator": "gauravsworld@gmail.com", "creation_time": "2008-11-10T06:01:08Z", "tags": [], "attachment_id": 22849}, {"attachment_id": null, "tags": [], "bug_id": 46174, "text": "(In reply to comment #1)\n> Any chance you could upload the output files from 3.1 and 3.2, so we can do a\n> quick diff and see what's different with them?\n> \n\nThe sheets are attached. Also, my excel version is 2003 (11.8105.8107) SP2.\n", "count": 4, "id": 122339, "time": "2008-11-10T06:02:59Z", "creator": "gauravsworld@gmail.com", "creation_time": "2008-11-10T06:02:59Z", "is_private": false}, {"count": 5, "tags": [], "creator": "apache@gagravarr.org", "text": "I'm seeing the named range defined in both of your files\n\nThe only difference I can spot is that the 3.1 version uses the $A$1 form of reference, and 3.2 uses A1 (so absolute vs relative). However, both seem fine otherwise", "id": 122344, "time": "2008-11-10T09:56:40Z", "bug_id": 46174, "creation_time": "2008-11-10T09:56:40Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "gauravsworld@gmail.com", "is_private": false, "count": 6, "id": 122358, "time": "2008-11-10T21:29:44Z", "bug_id": 46174, "creation_time": "2008-11-10T21:29:44Z", "text": "After some more debugging, it appears that the named reference is available to me in POI and I can access it elsewhere in the sheet. But for whatever reason excel doesn't show the reference in the box on the top left corner when I click on the cell A1. Can you see this reference in excel nick? What version of excel are you using?"}, {"count": 7, "tags": [], "bug_id": 46174, "text": "I'm using Excel 2003 (11.8231.8221) SP3, and that sees the named range just fine in both files\n\nI think Josh might be investigating the $A$1 vs A1 thing", "id": 122367, "time": "2008-11-11T03:55:03Z", "creator": "apache@gagravarr.org", "creation_time": "2008-11-11T03:55:03Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 46174, "attachment_id": null, "text": "Fixed in svn r713909\n\nJunit added.\n\nThe problem was that NameRecord had its own reference parsing logic that didn't distinguish between relative and absolute cell references.  The easiest fix was to replace this logic with the common formula parsing logic which has much greater coverage of Excel formula syntax.  This has the benefit of allowing POI to support defined names with any general formula.\n\nI renamed(deprecated) the get/setReference methods because the name is misleading.  Now you can use get/setFormula to the same effect.\n\nUnfortunately, the formula parser does not support the union operator yet, so there has been a slight regression in functionality.  For example, hssfName.setFormula(\"Sheet1!A1:B2,Sheet1!C3:D4\") will fail at the moment.  I'm not sure if this functionality is of a high priority.", "id": 122450, "time": "2008-11-13T18:32:42Z", "creator": "josh@apache.org", "creation_time": "2008-11-13T18:32:42Z", "is_private": false}, {"count": 9, "tags": [], "text": "*** Bug 30714 has been marked as a duplicate of this bug. ***", "attachment_id": null, "bug_id": 46174, "id": 126352, "time": "2009-04-18T02:12:50Z", "creator": "yegor@dinom.ru", "creation_time": "2009-04-18T02:12:50Z", "is_private": false}]