[{"count": 0, "tags": [], "creator": "superrubiroyd@gmail.com", "text": "One of drawbacks of the current implementation is limited support for Excel drawing layer: HSSF can create new drawings from scratch but cannot modify existing ones. \n\nThis drawback is frequently reported on the mailing lists and the fix is in high demand.", "id": 155441, "time": "2012-03-31T14:46:40Z", "bug_id": 53010, "creation_time": "2012-03-31T14:46:40Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "text": "Created attachment 28861\nimproved work with continue records in drawing layer, added new tests\n\nAdded such improvements:\n1. new tests which verify that POI HSSF module correctly reads drawing data, build correctly tree from escher records and serialize it into correct byte array.\n2. Fixed bug with twice read continue records", "is_private": false, "bug_id": 53010, "id": 159523, "time": "2012-05-30T12:25:38Z", "creator": "superrubiroyd@gmail.com", "creation_time": "2012-05-30T12:25:38Z", "attachment_id": 28861}, {"count": 2, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "text": "Applied in r1344621\n\nYegor", "id": 159550, "time": "2012-05-31T09:47:40Z", "bug_id": 53010, "creation_time": "2012-05-31T09:47:40Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 53010, "text": "Created attachment 28877\nimproved work with continue records in drawing layer, added new tests", "id": 159658, "time": "2012-06-03T21:13:46Z", "creator": "superrubiroyd@gmail.com", "creation_time": "2012-06-03T21:13:46Z", "is_private": false, "attachment_id": 28877}, {"count": 4, "tags": [], "creator": "superrubiroyd@gmail.com", "text": "Created attachment 28878\nfile with NoteRecords", "id": 159659, "time": "2012-06-03T21:15:38Z", "bug_id": 53010, "creation_time": "2012-06-03T21:15:38Z", "is_private": false, "attachment_id": 28878}, {"count": 5, "attachment_id": 28879, "creator": "superrubiroyd@gmail.com", "text": "Created attachment 28879\nfile for test with new records sequence\n\nHSSF realization could read drawing layer only in such sequence:\nDrawingRecord\nObjRecord | TextObjRecord\n...\nDrawingRecord\nObjRecord | TextObjRecord\n\nXls files can contain such sequence:\nDrawingRecord\nContinueRecord\n...\nContinueRecord\nObjRecord | TextObjectRecord\n.....\nContinueRecord\n ...\nContinueRecord\nObjRecord | TextObjectRecord \n\nFixed in uploaded patch", "id": 159660, "time": "2012-06-03T21:17:54Z", "bug_id": 53010, "creation_time": "2012-06-03T21:17:54Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "bug_id": 53010, "is_private": false, "text": "Applied in r1345858\n\nYegor\n\n(In reply to comment #3)\n> Created attachment 28877 [details]\n> improved work with continue records in drawing layer, added new tests", "id": 159667, "time": "2012-06-04T08:09:16Z", "creator": "yegor@dinom.ru", "creation_time": "2012-06-04T08:09:16Z", "attachment_id": null}, {"count": 7, "attachment_id": null, "creator": "markbrdsly@tiscali.co.uk", "text": "Not so sure that this is an error but it certainly could be a problem with the javadoc for the XSSFWorkbook/OPCPackage classes.\n\nHad a quick play with the code this morning and read the full stacktrace produced when the exception is thrown. The source of the exception is the write method of the workbook - or one of the methods it calls - and it appears to be caused by the fact that the OPCPackage is no longer available when the workbook is being written out. If the call to the close() method of the OPCPackage instance if moved to follow the write() method of the workbook, then the exception is not thrown.\n\nSo, it seems that if a workbook is cretade from an instance of the OPCPackage class, the OPCPacakge instance must not be disposed of until after the workbook has been written. This change the the code, removed the problem completely;\n\norg.apache.poi.openxml4j.opc.OPCPackage opc = \n   org.apache.poi.openxml4j.opc.OPCPackage.open(filename);\norg.apache.poi.xssf.usermodel.XSSFWorkbook wb =\n   new org.apache.poi.xssf.usermodel.XSSFWorkbook(opc);\njava.io.FileOutputStream fileOut = new java.io.FileOutputStream(filename);\nwb.write(fileOut);\nopc.close();\nfileOut.close();  \n\nPerhaps documenting this in the javadoc for the workbook and OPCPackage classes would be sufficient.\n\nMark B", "id": 160977, "time": "2012-07-29T11:02:15Z", "bug_id": 53010, "creation_time": "2012-07-29T11:02:15Z", "tags": [], "is_private": false}, {"count": 8, "tags": [], "bug_id": 53010, "is_private": false, "text": "Please ignore the above. Posted to the wrong bug listing, it should have been 53613. Off to correct this now, sorry.\n\nMark B", "id": 160978, "time": "2012-07-29T11:03:40Z", "creator": "markbrdsly@tiscali.co.uk", "creation_time": "2012-07-29T11:03:40Z", "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 53010, "text": "GSoC project is complete.\nAll related tickets are resolved and all changes are committed to the trunk.\n\nWith best regards,\nEvgeniy Berlog", "id": 161597, "time": "2012-08-21T21:08:01Z", "creator": "superrubiroyd@gmail.com", "creation_time": "2012-08-21T21:08:01Z", "is_private": false, "attachment_id": null}]