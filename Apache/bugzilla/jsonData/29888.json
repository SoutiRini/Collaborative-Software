[{"count": 0, "tags": [], "creator": "jesse.demmel@openwave.com", "attachment_id": null, "id": 60100, "time": "2004-07-02T18:41:44Z", "bug_id": 29888, "creation_time": "2004-07-02T18:41:44Z", "is_private": false, "text": "I am building my own task and wanted to wrap FileSet so that I could use \nthem.  In doing so, I found that fileset.toString() will not return the \nexpected result (includedfile1;includedfile2) when the fileset is a reference.\n\nRelevant sections of my build.xml:\n\n<fileset id=\"jutil.3p.jars\" dir=\"${3rdparty.base}\">\n      <include name=\"webmethods/${GLUE_V}/jars/GLUE-STD.jar\" />\n      <include name=\"sun/jmx/${JMX_V}/jars/jmxri.jar\" />   \n</fileset>\n\n<!-- target to run mytask... -->\n   <target name=\"do-mytask\" description=\"task I made.\">\n      <taskdef name=\"mytask\" classname=\"MyTask\" />\n      <mytask>\n         <fileset refid=\"jutil.3p.jars\"/>\n      </mytask>\n   </target>\n\nRelevant code for mytask:\n\nimport org.apache.tools.ant.types.FileSet;\nimport org.apache.tools.ant.DirectoryScanner;\nimport java.io.File;\npublic class MyTask extends Task \n{\n    private FileSet fileset;\n  \n    public void addConfiguredFileset ( FileSet fs )\n    {\n        fileset = fs;\n    }\n    public void execute () throws BuildException\n    {\n        try\n        {\n            String[] myfiles = fileset.toString();\n            // Expected result of myfiles.length == 2, instead it's 1\n            // with the value of the String being the reference.\n\n            // The workaround\n            DirectoryScanner ds = fileset.getDirectoryScanner(getProject());\n            String[] jars = ds.getIncludedFiles();\n        }\n        catch( Exception e)\n        {\n            throw new BuildException( \"Exception caught: \" + e.toString());\n        }\n        \n    }\n\nThe toString() just needs to check isReference() first... I don't think this \nis a big deal, but it is a bug... the workaround is pretty easy too."}, {"count": 1, "attachment_id": null, "creator": "peterreilly@apache.org", "text": "the toString() returns a list of files as a string for debug\npurposes (for example for Project#log()). It does actually use the two lines you\ndescribe to get those files.\n\nThe method you decribe as a workaround is actually the\ncorrect method to use FileSet to retrieve the list\nof files in the fileset.\n\nMarking this as works for me - I tested the task\nwith a reference and it gives the correct (but odd - with ';' rather\nthan ':' as the path separator) result.", "id": 64158, "time": "2004-09-24T09:21:15Z", "bug_id": 29888, "creation_time": "2004-09-24T09:21:15Z", "tags": [], "is_private": false}]