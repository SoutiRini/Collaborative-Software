[{"count": 0, "tags": [], "bug_id": 38396, "is_private": false, "text": "I have a formula in an Excel file , something like that :\n   =30.000.000 / 100\nIn my code i evaluate formula with HSSFFormulaEvaluator, but the result\nevaluated is 3, not 30.000\nSo, i tested over and over again and i observe that a number used in a formula\nmust be smaller than 9.999.999 to have a corect evaluation.\nBut i think that is a too small limit. Maybe you can fix that bug.\n\nThank You!", "id": 85038, "time": "2006-01-26T09:10:45Z", "creator": "tudorionut13@yahoo.com", "creation_time": "2006-01-26T09:10:45Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 38396, "text": "I have tried with the exact same values (=30,000,000/100) and Formula is\nevaluated correctly to 300,000. I have tried it with POI-3.0-alpha1-2005-07-04.\n\nCould you attach the xls and code-snip that demonstrates this bug?", "id": 85612, "time": "2006-02-08T21:41:34Z", "creator": "amolweb@yahoo.com", "creation_time": "2006-02-08T21:41:34Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 38396, "text": "Created attachment 17628\nExcel File", "id": 85638, "time": "2006-02-09T16:39:06Z", "creator": "tudorionut13@yahoo.com", "creation_time": "2006-02-09T16:39:06Z", "is_private": false, "attachment_id": 17628}, {"count": 3, "tags": [], "bug_id": 38396, "text": "Created attachment 17629\nJava File", "id": 85639, "time": "2006-02-09T16:39:22Z", "creator": "tudorionut13@yahoo.com", "creation_time": "2006-02-09T16:39:22Z", "is_private": false, "attachment_id": 17629}, {"count": 4, "tags": [], "bug_id": 38396, "is_private": false, "text": "Take a look. \nThank you!", "id": 85640, "time": "2006-02-09T16:40:14Z", "creator": "tudorionut13@yahoo.com", "creation_time": "2006-02-09T16:40:14Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 38396, "attachment_id": null, "text": "The code I used to test had a bug :) \n\nSo yes, this is a bug in the current implementation. However after some\ndebugging it seems like excel stores large numbers (in formula strings) with the\nexponential notation. Thus 30000000/100 is stored as 3.0E7/100.\nApparently, FormulaParser cannot handle this and it simply returns a Ptg array\nof size 1 containing the NumberPtg with numeric value \"3.0\" instead of Ptg array\nof size 3 containing NumberPtg, DividePtg and NumberPtg\n\n", "id": 85710, "time": "2006-02-11T20:17:07Z", "creator": "amolweb@yahoo.com", "creation_time": "2006-02-11T20:17:07Z", "is_private": false}, {"count": 6, "tags": [], "text": "See my comment on 30248 bug :\n \" Yes, you cannot parse number greater than 10.000.000. \nI have a formula , something like : =10.000.000/10 and HSSFFormulaEvaluator\nevaluateCell method return 1 after the evaluation. \nSo i try to see how looks the string from that cell with HSSFCell\ngetCellFormula() method, and the result was : 1.0E7/100 .\nYou cannot do nothing! :( \"\n\nBut, if u do a method that search the string for \"E\" character and replace it \nwith  a power of 10 and then evaluate corectly the formula i think that would \nbe fine.", "is_private": false, "id": 85725, "creator": "tudorionut13@yahoo.com", "time": "2006-02-12T11:07:10Z", "bug_id": 38396, "creation_time": "2006-02-12T11:07:10Z", "attachment_id": null}, {"count": 7, "tags": [], "text": "Thank you for your solution. You're doing a really good job!", "is_private": false, "bug_id": 38396, "id": 88716, "time": "2006-05-02T12:41:52Z", "creator": "tudorionut13@yahoo.com", "creation_time": "2006-05-02T12:41:52Z", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 38396, "is_private": false, "text": "Created attachment 18403\nPatch for enabling parsing number strings in exponential notation \n\nPatch contains testcases and bug fix to the formula parser to allow parsing of\nnumbers in exponential notation (required for very large numbers).\n\nBug fix: FormulaParser.GetNum() updated to check for the presence of 'E' char\nin the number and append appropriate number of '0' chars to the token string\nbefore returning it.", "id": 89777, "time": "2006-06-05T14:33:22Z", "creator": "amolweb@yahoo.com", "creation_time": "2006-06-05T14:33:22Z", "attachment_id": 18403}, {"count": 9, "tags": [], "creator": "amolweb@yahoo.com", "attachment_id": 18405, "text": "Created attachment 18405\nCorrects deficiencies in previously submitted patch\n\nPrevious patch would fail for numbers in exp notation where the mantissa is not\na whole number; and also for cases where the exponent was negative. Both these\nproblems are fixed in the latest patch. Corresponding test cases have been\nadded.\n\nAlso fixes an issue with the cell.setCellFormula(..) not updating the\nunderlying value correctly.", "id": 89786, "time": "2006-06-05T16:57:24Z", "bug_id": 38396, "creation_time": "2006-06-05T16:57:24Z", "is_private": false}]