[{"count": 0, "attachment_id": null, "creator": "jim.peters@eds.com", "text": "I searched the archives for this but did not find a bug describing my \nproblem.  The problem is murkier - A Excel 2000 file from my customer receives \nthe error.  If I save the file with my Excel for Office 2003, the file works \ncorrectly.\n\nCode here, standard:\nString sFName = (TEMP_FILES_DIR + File.separatorChar + (String)valIn.get\n(\"TEMP_DOCUMNT_FILE_NM\"));\nsFName = sFName.replace(File.separatorChar, '/');\n\t\t\t\nFileInputStream fis = null;\nFile fileToWrite = new File(sFName);\nfis = new FileInputStream(fileToWrite);\n\t\t\t\nPOIFSFileSystem fs = new POIFSFileSystem(fis);\nHSSFWorkbook wb = new HSSFWorkbook(fs);  //Exception thrown here\nHSSFSheet sheet = wb.getSheetAt(0);\n\nHere's the Exception:\n08:31:40,271 INFO  [STDOUT] java.lang.reflect.InvocationTargetException\n08:31:40,271 INFO  [STDOUT] \tat \nsun.reflect.GeneratedConstructorAccessor34.newInstance(Unknown Source)\n08:31:40,271 INFO  [STDOUT] \tat \nsun.reflect.DelegatingConstructorAccessorImpl.newInstance\n(DelegatingConstructorAccessorImpl.java:27)\n08:31:40,271 INFO  [STDOUT] \tat java.lang.reflect.Constructor.newInstance\n(Constructor.java:274)\n08:31:40,271 INFO  [STDOUT] \tat \norg.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:224)\n08:31:40,271 INFO  [STDOUT] \tat \norg.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:160)\n08:31:40,271 INFO  [STDOUT] \tat \norg.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:163)\n08:31:40,271 INFO  [STDOUT] \tat \norg.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:130)\n08:31:40,271 INFO  [STDOUT] \tat \nSupplierPartUpload.SupplierPartUpload.renderPage(SupplierPartUpload.java:143)\n08:31:40,281 INFO  [STDOUT] \tat SupplierPartUpload.SupplierPartUpload.doPost\n(SupplierPartUpload.java:94)\n08:31:40,281 INFO  [STDOUT] \tat javax.servlet.http.HttpServlet.service\n(HttpServlet.java:768)\n08:31:40,281 INFO  [STDOUT] \tat javax.servlet.http.HttpServlet.service\n(HttpServlet.java:861)\n08:31:40,281 INFO  [STDOUT] \tat \norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java:237)\n08:31:40,281 INFO  [STDOUT] \tat \norg.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java:157)\n08:31:40,281 INFO  [STDOUT] \tat \norg.apache.catalina.core.ApplicationDispatcher.invoke\n(ApplicationDispatcher.java:704)\n08:31:40,281 INFO  [STDOUT] \tat \norg.apache.catalina.core.ApplicationDispatcher.doInclude\n(ApplicationDispatcher.java:590)\n08:31:40,281 INFO  [STDOUT] \tat \norg.apache.catalina.core.ApplicationDispatcher.include\n(ApplicationDispatcher.java:510)\n08:31:40,281 INFO  [STDOUT] \tat POS.POS.doPost(POS.java:116)\n08:31:40,281 INFO  [STDOUT] \tat javax.servlet.http.HttpServlet.service\n(HttpServlet.java:768)\n08:31:40,281 INFO  [STDOUT] \tat javax.servlet.http.HttpServlet.service\n(HttpServlet.java:861)\n08:31:40,281 INFO  [STDOUT] \tat \norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java:237)\n08:31:40,291 INFO  [STDOUT] \tat \norg.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java:157)\n08:31:40,291 INFO  [STDOUT] \tat \norg.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter\n(ReplyHeaderFilter.java:75)\n08:31:40,291 INFO  [STDOUT] \tat \norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java:186)\n08:31:40,291 INFO  [STDOUT] \tat \norg.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java:157)\n08:31:40,291 INFO  [STDOUT] \tat \norg.apache.catalina.core.StandardWrapperValve.invoke\n(StandardWrapperValve.java:214)\n08:31:40,291 INFO  [STDOUT] \tat \norg.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:104)\n08:31:40,291 INFO  [STDOUT] \tat \norg.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)\n08:31:40,291 INFO  [STDOUT] \tat \norg.apache.catalina.core.StandardContextValve.invokeInternal\n(StandardContextValve.java:198)\n08:31:40,291 INFO  [STDOUT] \tat \norg.apache.catalina.core.StandardContextValve.invoke\n(StandardContextValve.java:152)\n08:31:40,291 INFO  [STDOUT] \tat \norg.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:104)\n08:31:40,301 INFO  [STDOUT] \tat \norg.jboss.web.tomcat.security.CustomPrincipalValve.invoke\n(CustomPrincipalValve.java:66)\n08:31:40,301 INFO  [STDOUT] \tat \norg.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:102)\n08:31:40,301 INFO  [STDOUT] \tat \norg.jboss.web.tomcat.security.SecurityAssociationValve.invoke\n(SecurityAssociationValve.java:158)\n08:31:40,301 INFO  [STDOUT] \tat \norg.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:102)\n08:31:40,301 INFO  [STDOUT] \tat \norg.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)\n08:31:40,301 INFO  [STDOUT] \tat \norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:137)\n08:31:40,301 INFO  [STDOUT] \tat \norg.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:104)\n08:31:40,301 INFO  [STDOUT] \tat \norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:118)\n08:31:40,301 INFO  [STDOUT] \tat \norg.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:102)\n08:31:40,301 INFO  [STDOUT] \tat \norg.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)\n08:31:40,301 INFO  [STDOUT] \tat \norg.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:109)\n08:31:40,311 INFO  [STDOUT] \tat \norg.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:104)\n08:31:40,311 INFO  [STDOUT] \tat \norg.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)\n08:31:40,311 INFO  [STDOUT] \tat \norg.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:929)\n08:31:40,311 INFO  [STDOUT] \tat \norg.apache.coyote.tomcat5.CoyoteAdapter.service(CoyoteAdapter.java:160)\n08:31:40,311 INFO  [STDOUT] \tat \norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:799)\n08:31:40,311 INFO  [STDOUT] \tat \norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnecti\non(Http11Protocol.java:705)\n08:31:40,311 INFO  [STDOUT] \tat \norg.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:577)\n08:31:40,311 INFO  [STDOUT] \tat \norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:683)\n08:31:40,311 INFO  [STDOUT] \tat java.lang.Thread.run(Thread.java:534)\n08:31:40,321 INFO  [STDOUT] Caused by: java.lang.ArrayIndexOutOfBoundsException\n08:31:40,321 INFO  [STDOUT] \tat java.lang.System.arraycopy(Native Method)\n08:31:40,321 INFO  [STDOUT] \tat \norg.apache.poi.hssf.record.UnknownRecord.<init>(UnknownRecord.java:62)\n08:31:40,321 INFO  [STDOUT] \tat \norg.apache.poi.hssf.record.SubRecord.createSubRecord(SubRecord.java:57)\n08:31:40,321 INFO  [STDOUT] \tat \norg.apache.poi.hssf.record.ObjRecord.fillFields(ObjRecord.java:99)\n08:31:40,321 INFO  [STDOUT] \tat org.apache.poi.hssf.record.Record.fillFields\n(Record.java:90)\n08:31:40,321 INFO  [STDOUT] \tat org.apache.poi.hssf.record.Record.<init>\n(Record.java:55)\n08:31:40,321 INFO  [STDOUT] \tat org.apache.poi.hssf.record.ObjRecord.<init>\n(ObjRecord.java:61)\n08:31:40,321 INFO  [STDOUT] \t... 50 more", "id": 69637, "time": "2005-01-13T16:43:52Z", "bug_id": 33082, "creation_time": "2005-01-13T16:43:52Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "jim.peters@eds.com", "attachment_id": 13997, "text": "Created attachment 13997\nHere's the offending .xls", "id": 69644, "time": "2005-01-13T19:03:39Z", "bug_id": 33082, "creation_time": "2005-01-13T19:03:39Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 33082, "attachment_id": null, "id": 71435, "time": "2005-02-23T22:47:15Z", "creator": "jim.joyce@amp.com", "creation_time": "2005-02-23T22:47:15Z", "is_private": false, "text": "(In reply to comment #0)\n> I searched the archives for this but did not find a bug describing my \n> problem.  The problem is murkier - A Excel 2000 file from my customer \nreceives \n\nI can reproduce this at will with a template file I was given to work with. If \nthe file is saved with any sheet having a cell selected with a \"pull-down\", it \nwill fail exactly as this BUG describes.\n\nIf I take the same file (without changing the format) and ensure that NO sheet \nhas a cell selected which contains a \"pull-down\" menu, it can be sucessfully \nread."}, {"count": 3, "attachment_id": null, "creator": "avik@apache.org", "text": "*** Bug 34575 has been marked as a duplicate of this bug. ***", "id": 73990, "time": "2005-04-22T17:08:15Z", "bug_id": 33082, "creation_time": "2005-04-22T17:08:15Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "creator": "avik@apache.org", "attachment_id": null, "text": "This is now fixed in CVS! Please verify, on latest CVS or a release after today.", "id": 74361, "time": "2005-05-03T15:30:51Z", "bug_id": 33082, "creation_time": "2005-05-03T15:30:51Z", "is_private": false}]