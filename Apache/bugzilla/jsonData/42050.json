[{"count": 0, "tags": [], "bug_id": 42050, "attachment_id": null, "text": "The live tab under authoring doesn't honor proxy settings. This is causing mixed\ncontent errors in browser due to the page being loaded from HTTPS and portions\nof the content (css for example) being loaded from HTTP.", "id": 101432, "time": "2007-04-04T11:00:22Z", "creator": "rfrovarp@apache.org", "creation_time": "2007-04-04T11:00:22Z", "is_private": false}, {"count": 1, "tags": [], "text": "proxying does not work at all for me.\nmany parts of the lenya pipelines do not honor the proxy settings - notably the\nstyling and javascript of the GUI.\n\ni'm setting this to blocker, because SSL proxying support is mandatory for\nprofessional deployments, and HTTP proxying is needed to clean up the URLs -\n\"<pubname>/live\" is not acceptable for most real-world installations.\n", "attachment_id": null, "bug_id": 42050, "id": 102892, "time": "2007-05-07T05:02:40Z", "creator": "nettings@apache.org", "creation_time": "2007-05-07T05:02:40Z", "is_private": false}, {"count": 2, "tags": [], "text": "Created attachment 20139\nthe output of default/authoring/index.html with proxying enabled\n\nthis is the output of the default publication with the following proxy\nsettings:\n<proxies>\n  <proxy area=\"live\" ssl=\"true\" \nurl=\"https://stackingdwarves.net/cms/default/live\"/>\n  <proxy area=\"live\" ssl=\"false\" \nurl=\"http://stackingdwarves.net/cms/default/live\"/>\n  <proxy area=\"authoring\" ssl=\"true\" \nurl=\"https://stackingdwarves.net/cms/default/authoring\"/>\n  <proxy area=\"authoring\" ssl=\"false\" \nurl=\"http://stackingdwarves.net/cms/default/authoring\"/>\n</proxies>\n\nthe request URL was \"https://stackingdwarves.net/cms/default/index.html\".\n\nthe following issues arise:\n\n* the lenya GUI does not honor proxying (see stylesheet and javascript links in\nheader and tab links in <div id=\"lenya-menus\"/>\n* the language selector creates absolute URLs that are not properly rewritten\n* same for the search module\n* links in content area sometimes miss the \"https\" (but not always!)", "is_private": false, "bug_id": 42050, "id": 102894, "time": "2007-05-07T05:15:20Z", "creator": "nettings@apache.org", "creation_time": "2007-05-07T05:15:20Z", "attachment_id": 20139}, {"count": 3, "tags": [], "bug_id": 42050, "attachment_id": null, "text": "Here's what I have, which is working with the exception of the live tab.\nHowever, I don't have any other use for SSL on this host other than Lenya\nediting. I tried to use a subdirectory under SSL so I could use it for other\nthings and that didn't work at all.\n\nIn the publication.xml files:\n\n<proxy area=\"live\" ssl=\"false\" url=\"http://publication.us\"/>\n<proxy area=\"authoring\" ssl=\"false\" url=\"https://myhost.edu/williston/authoring\"/>\n\nThe Apache config file for publication.us:\n\nProxyRequests Off \nRewriteEngine On\nRewriteRule ^/edit https://myhost.edu/williston/ [R]\nRewriteRule ^/$ index.html [R]  \nRewriteRule ^/williston/live/(.*)$ $1 [R,L] \nRewriteRule ^/(.*) http://myhost.edu:8890/williston/live/$1 [P]\nProxyPassReverse / http://myhost.edu:8890/\n\nIn the Apache config file for SSL:\n\nProxyRequests Off\nRewriteEngine On\nRewriteLog logs/test.rewrite.log\nRewriteLogLevel 0\nRewriteRule ^/([^/\\.]+)$ $1/ [R]\nRewriteRule ^/([^/\\.]+)/$ https://myhost.edu/$1/authoring/index.htm l [R,L]\nRewriteRule ^/(.*) http://myhost.edu:8890/$1 [P,L]\nProxyPassReverse / http://myhost.edu:8890/\n", "id": 102913, "time": "2007-05-07T09:38:48Z", "creator": "rfrovarp@apache.org", "creation_time": "2007-05-07T09:38:48Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 42050, "attachment_id": null, "text": "(In reply to comment #3)\n> <proxy area=\"authoring\" ssl=\"false\" url=\"https://myhost.edu/williston/authoring\"/>\n\nssl=false and a https uri. it looks like you want to bypass something. but does\nit make any difference?\n\nregarding the live proxy, have you succeeded in hiding the <pubname>/live part?\nfor the visible urls, i can make it to work by rewriting ^/(.*) to\n/<pubname>/live/$1, but i also need to match /lenya and /module first, otherwise\nstuff will break...\n", "id": 103008, "time": "2007-05-09T09:27:38Z", "creator": "nettings@apache.org", "creation_time": "2007-05-09T09:27:38Z", "is_private": false}, {"count": 5, "attachment_id": null, "creator": "rfrovarp@apache.org", "text": "(In reply to comment #4)\n> regarding the live proxy, have you succeeded in hiding the <pubname>/live part?\n> for the visible urls, i can make it to work by rewriting ^/(.*) to\n> /<pubname>/live/$1, but i also need to match /lenya and /module first, otherwise\n> stuff will break...\n> \n\nI see what you're talking about now. We're not using the SVG module or the\nlanguage selector. Our publications at the moment are very simple and don't need\nanything from /lenya or /module (in live). Those would have to be matched first. \n\nSo yes, I've hidden <pubname>/live, but I'm only doing basic publications, which\ndoes make it a lot easier.", "id": 103009, "time": "2007-05-09T09:57:02Z", "bug_id": 42050, "creation_time": "2007-05-09T09:57:02Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "text": "Created attachment 20170\nAdd option for relative URLs to UuidToUrlTransformer\n\nTo enable relative URLs, change the transformer configuration:\n\n    <map:transformer name=\"uuid2url\" ...>\n      <urls type=\"relative\"/>\n    </map:transformer>", "is_private": false, "bug_id": 42050, "id": 103080, "time": "2007-05-11T03:59:24Z", "creator": "andreas@apache.org", "creation_time": "2007-05-11T03:59:24Z", "attachment_id": 20170}, {"count": 7, "attachment_id": null, "creator": "andreas@apache.org", "is_private": false, "id": 103220, "time": "2007-05-15T01:48:44Z", "bug_id": 42050, "creation_time": "2007-05-15T01:48:44Z", "tags": [], "text": "(In reply to comment #6)\n> Created an attachment (id=20170) [edit]\n> Add option for relative URLs to UuidToUrlTransformer\n\nCaution, relative URLs are not compatible with the WYSIWYG editors (URL/UUID\ntransformation). The transformer has to be parameterized."}, {"count": 8, "tags": [], "creator": "andreas@apache.org", "attachment_id": 20201, "id": 103221, "time": "2007-05-15T02:28:31Z", "bug_id": 42050, "creation_time": "2007-05-15T02:28:31Z", "is_private": false, "text": "Created attachment 20201\nAdd config+param option for relative URLs to UuidToUrlTransformer"}, {"count": 9, "attachment_id": null, "creator": "thorsten@apache.org", "text": "First of all I am not using proxy ATM so I am shooting in the dark. \n\n(In reply to comment #2)\n> Created an attachment (id=20139) [edit]\n> the output of default/authoring/index.html with proxying enabled\n> \n> this is the output of the default publication with the following proxy\n> settings:\n> <proxies>\n>   <proxy area=\"live\" ssl=\"true\" \n> url=\"https://stackingdwarves.net/cms/default/live\"/>\n>   <proxy area=\"live\" ssl=\"false\" \n> url=\"http://stackingdwarves.net/cms/default/live\"/>\n>   <proxy area=\"authoring\" ssl=\"true\" \n> url=\"https://stackingdwarves.net/cms/default/authoring\"/>\n>   <proxy area=\"authoring\" ssl=\"false\" \n> url=\"http://stackingdwarves.net/cms/default/authoring\"/>\n> </proxies>\n> \n> the request URL was \"https://stackingdwarves.net/cms/default/index.html\".\n> \n> the following issues arise:\n> \n> * the lenya GUI does not honor proxying (see stylesheet and javascript links in\n> header and tab links in <div id=\"lenya-menus\"/>\n\nRegarding css and javascript did you follow\nhttp://lenya.apache.org/docs/1_2_x/components/deployment/proxying.html\n\n# RewriteRules for css and images\n     RewriteRule      ^/lenya/sandbox/(.*)/images/(.*)$\nhttp://cms.live.ch:8080/lenya/sandbox/$1/images/$2 [L]\n     RewriteRule      ^/(.*\\.css$) http://cms.live.ch:8080/$1  [L]\n\n     RewriteRule      ^/(lenya/[^/]+)/(.*)$   http://cms.live.ch:8080/$1/live/$2\n [P,L]\n\nThat may bring some of the css back. I reckon js is quite the same.\n\nThe problem is all the stuff that is not pub specific as e.g.\n/lenya/menu/images/lenya-logo.gif or /modules/languageselector/flag-es-13.png\ndoes not get rewritten from the <proxy/> tags.\n\nAdding a RewriteRules like\nRewriteRule      ^/lenya/(.*)$ http://cms.live.ch:8080/lenya/$1\nRewriteRule      ^/modules/(.*)$ http://cms.live.ch:8080/modules/$1\nshould bring back another big part that seems to be broken.\n\nHowever still the question why sometimes the rewrite miss the \"https\".\n\nCan somebody test whether the ^/lenya and ^/modules is bringing back some more\nresources.", "id": 103259, "time": "2007-05-16T07:13:20Z", "bug_id": 42050, "creation_time": "2007-05-16T07:13:20Z", "tags": [], "is_private": false}, {"count": 10, "tags": [], "text": "I tried the patch from andreas and there are still some issues.\n\nI am atm looking at the xsl:\n<link rel=\"stylesheet\"\nhref=\"{$contextPath}/{$pubId}/modules/homepage/css/homepage.css\" type=\"text/css\"/>\n\nwhich did not get rewritten:\n<link type=\"text/css\" href=\"/default/modules/homepage/css/homepage.css\"\nrel=\"stylesheet\" />\n\nHowever we actually include it two times where the pagee2xhtml is using\n <link rel=\"stylesheet\" href=\"{$root}/css/{$document-type}.css\" type=\"text/css\"/>\n\nwhere <!-- {context-prefix}/{publication-id}/{area} -->\n  <xsl:param name=\"root\"/>\n\nMeaning the proxy rewritting is working fine if we follow:\n{context-prefix}/{publication-id}/{area}\n\nIt is indeed failing if not use as the above.\n", "is_private": false, "bug_id": 42050, "id": 103481, "time": "2007-05-22T01:25:28Z", "creator": "thorsten@apache.org", "creation_time": "2007-05-22T01:25:28Z", "attachment_id": null}, {"count": 11, "tags": [], "text": "I am ATM trying to fix each part of the aggregation and doing the search stuff.\n\nTo debug I added:\n<map:match pattern=\"authoring/navigation-element/*/*/*/*/*/**\">\n        <map:generate src=\"cocoon://modules/sitetree/{1}/{2}/{3}/{4}/{5}/{6}.xml\"/>\n        <map:transform type=\"uuid2url\"/>\n        <map:serialize type=\"xml\"/>\n      </map:match>\n\nI found out that in UuidToUrlTransformer the following prevents the rewrite.\nWhere I think the comment is not correct since e.g. forms @action would hardly\never use a lenyadoc: in the link. Further why the comment about:\n // don't rewrite /{pub}/modules/... \u00bf?\n\n /*\n                             * This is legacy code. It rewrites links to\n                             * non-document images (in resources/shared). These\n                             * images shouldn't be referenced in documents since\n                             * this violates the separation between content and\n                             * layout.\n                             */\n                            String prefix = \"/\" +\nthis.currentDocument.getPublication().getId()\n                                    + \"/\";\n                            if (linkUrl.startsWith(prefix)) {\n                                String pubUrl = linkUrl.substring(prefix.length());\n                                String area = pubUrl.split(\"/\")[0];\n                                \n                                // don't rewrite /{pub}/modules/...\n                                if (area.equals(Publication.AUTHORING_AREA)) {\n                                    String areaUrl =\npubUrl.substring(area.length());\n                                    String newUrl = this.contextPath + prefix\n                                            + this.currentDocument.getArea() +\nareaUrl;\n                                    setAttribute(newAttrs, attributeNames[i],\nnewUrl);\n                                }\n                            }", "attachment_id": null, "bug_id": 42050, "id": 103491, "time": "2007-05-22T02:43:46Z", "creator": "thorsten@apache.org", "creation_time": "2007-05-22T02:43:46Z", "is_private": false}, {"count": 12, "tags": [], "creator": "andreas@apache.org", "attachment_id": null, "id": 103493, "time": "2007-05-22T02:54:05Z", "bug_id": 42050, "creation_time": "2007-05-22T02:54:05Z", "is_private": false, "text": "(In reply to comment #11)\n> I am ATM trying to fix each part of the aggregation\n\nI'd suggest that we don't include URLs in the navigation elements, but use\nUUID-based links and leave the rewriting to the UuidToUrlTransformer at the end\nof the presentation pipeline. I have a patch in my sandbox, but it needs a bit\nmore testing."}, {"count": 13, "tags": [], "bug_id": 42050, "attachment_id": null, "text": "I am ATM writing a simple ProxyTransformer for testing. \n\nIMO the whole issue is quite simple to solve if we assume that we need to\nrewrite all links that starts with \"/\" to the proxy url. \n\nFurthermore the whole proxy per area is suboptimal. IMO the live area should be\nnot prefixed and the rest just will replace \"/\" with\n\"https://stackingdwarves.net/cms/{$pub}\" if no pub is defined in the first part\nafter \"/\" but e.g. /lenya or /module it would be just rewritten with the first part.\n\nAnyway I will attach what I come up with shortly.", "id": 103494, "time": "2007-05-22T03:06:31Z", "creator": "thorsten@apache.org", "creation_time": "2007-05-22T03:06:31Z", "is_private": false}, {"count": 14, "tags": [], "text": "Created attachment 20240\nUse lenya-document:uuid URLs for navigation elements in sitetree module\n\nThis patch changes the syntax of navigation element calls, so custom sitemaps\nhave to be updated.", "attachment_id": 20240, "bug_id": 42050, "id": 103498, "time": "2007-05-22T04:58:59Z", "creator": "andreas@apache.org", "creation_time": "2007-05-22T04:58:59Z", "is_private": false}, {"count": 15, "tags": [], "text": "How about adding an option for relative URLs to the BaseUrlModule as well?\nIt could for instance return \"../..\" for the request URL \"/foo/bar/baz\".", "attachment_id": null, "bug_id": 42050, "id": 103499, "time": "2007-05-22T05:00:36Z", "creator": "andreas@apache.org", "creation_time": "2007-05-22T05:00:36Z", "is_private": false}, {"count": 16, "attachment_id": null, "creator": "andreas@apache.org", "is_private": false, "id": 103500, "time": "2007-05-22T05:03:51Z", "bug_id": 42050, "creation_time": "2007-05-22T05:03:51Z", "tags": [], "text": "(In reply to comment #11)\n> Further why the comment about:\n>  // don't rewrite /{pub}/modules/... \u00bf?\n\nThat's because of bug 42140."}, {"count": 17, "tags": [], "bug_id": 42050, "attachment_id": null, "text": "(In reply to comment #14)\n> Created an attachment (id=20240) [edit]\n> Use lenya-document:uuid URLs for navigation elements in sitetree module\n> \n> This patch changes the syntax of navigation element calls, so custom sitemaps\n> have to be updated.\n\nBTW, the patch attaches a uuid2url.extension parameter with the document's\nnative extension (e.g., .zip) to the lenya-document URL. You might want to\nchange this if you'd like the links to end with .html.", "id": 103501, "time": "2007-05-22T05:42:39Z", "creator": "andreas@apache.org", "creation_time": "2007-05-22T05:42:39Z", "is_private": false}, {"count": 18, "tags": [], "text": "Created attachment 20241\nproxyTransformer version 1\n\nThis is the first version of the proxy transformer. \n\nThe open issues are still the following cases:\na) <link type=\"text/css\" href=\"/default/modules/homepage/css/homepage.css\"\nrel=\"stylesheet\" /> - Using pub but not a valid area\nb) <a href=\"/index.html\"><span>Apache Lenya Homepage</span></a> - the menu\nlinks which should point to the website IMO anyway\nc) <img alt=\"he\" src=\"/modules/languageselector/flag-he-13.png\" /> and <script\nsrc=\"/lenya/menu/menu.js\" type=\"text/javascript\"> </script> - point to the\nabsolute root.\n\na) and c) can be solved introducing a global proxy url. \nMeaning something like:\n<proxies url=\"https://www.host.com/lenya/\">\n\nWill now test the patch from andreas.", "is_private": false, "bug_id": 42050, "id": 103504, "time": "2007-05-22T07:46:34Z", "creator": "thorsten@apache.org", "creation_time": "2007-05-22T07:46:34Z", "attachment_id": 20241}, {"count": 19, "tags": [], "bug_id": 42050, "attachment_id": null, "text": "+    try {\n+      area = factory.getFromURL(linkUrl).getArea();\n+    } catch (RuntimeException e) {\n+      getLogger().warn(\"global link\");\n+    }\n\nWe shouldn't use exceptions for flow control ... :)\nYou can use factory.isDocument(linkUrl) instead.", "id": 103533, "time": "2007-05-23T01:36:18Z", "creator": "andreas@apache.org", "creation_time": "2007-05-23T01:36:18Z", "is_private": false}, {"count": 20, "tags": [], "text": "Created attachment 20246\nAggregate patch from all other with version 2 of the proxyTransformer", "is_private": false, "bug_id": 42050, "id": 103538, "time": "2007-05-23T03:35:34Z", "creator": "thorsten@apache.org", "creation_time": "2007-05-23T03:35:34Z", "attachment_id": 20246}, {"count": 21, "tags": [], "bug_id": 42050, "attachment_id": 20268, "text": "Created attachment 20268\nversion 3 fixing error when no proxy config is used", "id": 103617, "time": "2007-05-24T05:52:06Z", "creator": "thorsten@apache.org", "creation_time": "2007-05-24T05:52:06Z", "is_private": false}, {"count": 22, "tags": [], "text": "For the sake of a static export, it should be possible to render all internal\nlinks as relative URLs.", "is_private": false, "bug_id": 42050, "id": 103662, "time": "2007-05-25T01:03:11Z", "creator": "andreas@apache.org", "creation_time": "2007-05-25T01:03:11Z", "attachment_id": null}, {"count": 23, "attachment_id": null, "creator": "andreas@apache.org", "text": "(In reply to comment #18)\n\n> The open issues are still the following cases:\n> b) <a href=\"/index.html\"><span>Apache Lenya Homepage</span></a> - the menu\n> links which should point to the website IMO anyway\n\nI changed the link to point to the website. The \"About Lenya\" page is now a\nusecase and therefore independent from proxying.", "id": 103663, "time": "2007-05-25T01:54:27Z", "bug_id": 42050, "creation_time": "2007-05-25T01:54:27Z", "tags": [], "is_private": false}, {"count": 24, "tags": [], "creator": "andreas@apache.org", "text": "Maybe we should move the option for relative paths from the UuidToUrlTransformer\nto the ProxyTransformer.", "id": 103664, "time": "2007-05-25T01:57:24Z", "bug_id": 42050, "creation_time": "2007-05-25T01:57:24Z", "is_private": false, "attachment_id": null}, {"count": 25, "attachment_id": null, "creator": "andreas@apache.org", "is_private": false, "id": 103665, "time": "2007-05-25T02:00:15Z", "bug_id": 42050, "creation_time": "2007-05-25T02:00:15Z", "tags": [], "text": "BTW, a major problem is that the ProxyTransformer can't handle URLs in CSS. We could\n\n- transform the CSS to XML\n- apply the ProxyTransformer (instead of the XSLT we use now)\n- convert them back to CSS"}, {"count": 26, "tags": [], "bug_id": 42050, "attachment_id": null, "text": "(In reply to comment #25)\n> BTW, a major problem is that the ProxyTransformer can't handle URLs in CSS. We\ncould\n> \n> - transform the CSS to XML\n> - apply the ProxyTransformer (instead of the XSLT we use now)\n> - convert them back to CSS\n\ni'd rather we mandate the use of <foo>.xml instead of foo.css in all cases. then\nwe can add the proxying stuff to the stylesheet that currently handles <root/>\nand friends. i think all our users should use that mechanism. even if it is not\nused, it won't be a performance issue, because both browsers and cocoon are very\ngood at caching those things that change rarely.\nlet's add some docs to the effect that \"if you want to proxy, make sure you put\nall your css through the xml grinder...\"", "id": 103721, "time": "2007-05-26T18:44:51Z", "creator": "nettings@apache.org", "creation_time": "2007-05-26T18:44:51Z", "is_private": false}, {"count": 27, "tags": [], "bug_id": 42050, "is_private": false, "text": "Created attachment 20280\nPatch for docu explaining the global rewrite url\n\nFor all links that are not pointing to a document the global proxy rule \n<proxies ssl=\"false\" root=\"http://www.host.com/no-ssl/\">\nis applied. \n\nFor example a link such as /modules/myModule/somePath/some.thing will be\nrewritten to \"http://www.host.com/no-ssl/modules/myModule/somePath/some.thing\".\n\n\nIn short \"/\" will be replaced with \"{proxies/@root}\".", "id": 103736, "time": "2007-05-28T01:02:40Z", "creator": "thorsten@apache.org", "creation_time": "2007-05-28T01:02:40Z", "attachment_id": 20280}, {"count": 28, "tags": [], "creator": "thorsten@apache.org", "attachment_id": null, "is_private": false, "id": 103737, "time": "2007-05-28T01:24:21Z", "bug_id": 42050, "creation_time": "2007-05-28T01:24:21Z", "text": "(In reply to comment #25)\n> BTW, a major problem is that the ProxyTransformer can't handle URLs in CSS. We\ncould\n> \n> - transform the CSS to XML\n> - apply the ProxyTransformer (instead of the XSLT we use now)\n> - convert them back to CSS\n\nyes.\n\nWe could copy the forrest approach for this\n<map:transform type=\"pattern\" src=\"chaperon/grammars/link.xlex\"/>\n<map:transform src=\"chaperon/stylesheets/pattern2link.xsl\"/>\n\nhttp://svn.apache.org/viewvc/forrest/trunk/main/webapp/resources/chaperon/\n\nWhere the first will search for patterns we want to replace. The link.xlex can\nbe directly reused. The second will need some changes. \n\nNeed to look into this."}, {"count": 29, "tags": [], "creator": "thorsten@apache.org", "attachment_id": 20282, "id": 103754, "time": "2007-05-28T09:06:53Z", "bug_id": 42050, "creation_time": "2007-05-28T09:06:53Z", "is_private": false, "text": "Created attachment 20282\nVersion 4 of the all in one\n\nThe patch brings rewritting of the css via chaperon. Includes a fix in the\nproxyTransformer if the resource is no document. \n\nOne thing that I do not like is that one need to implement \n<map:resource name=\"proxy-css\"> in all sitemaps that is calling the resource.\nSeems that the map:resources are not inheritable. :("}, {"count": 30, "tags": [], "creator": "thorsten@apache.org", "attachment_id": null, "id": 104181, "time": "2007-06-07T23:38:02Z", "bug_id": 42050, "creation_time": "2007-06-07T23:38:02Z", "is_private": false, "text": "I commited the Version 4 of the patches WITHOUT \n- UuidToUrlTransformer.java\n- sitetree2nav.xsl\n\nSince they partly seems to be applied to trunk already.\n\nPlease test and close this bug if it is working."}, {"count": 31, "tags": [], "bug_id": 42050, "attachment_id": null, "text": "localhost:8888/lenya/css/menu.css doesn't load in the default publication. Error\nindicates it is treating /lenya as a publication:\n\nThe configuration file\n[/home/rfrovarp/asf/lenya-1.4.x/build/lenya/webapp/lenya/pubs/lenya/config/publication.xml]\ndoes not exist! \n\nlocalhost:8888/lenya/css/boxes.css also shows the same error. /modules seems to\nbe working.", "id": 104295, "time": "2007-06-11T07:28:16Z", "creator": "rfrovarp@apache.org", "creation_time": "2007-06-11T07:28:16Z", "is_private": false}, {"count": 32, "tags": [], "bug_id": 42050, "is_private": false, "text": "The proxy-css resource in lenya.xmap assumes that the call goes to a publication:\n\n<map:parameter name=\"root\"\nvalue=\"{base-url:{page-envelope:publication-id}:{page-envelope:area}:false}\"/>\n", "id": 104330, "time": "2007-06-12T02:27:20Z", "creator": "andreas@apache.org", "creation_time": "2007-06-12T02:27:20Z", "attachment_id": null}, {"count": 33, "tags": [], "bug_id": 42050, "attachment_id": null, "text": "IIUC the ProxyTransformer doesn't handle non-publication URLs either ...", "id": 104331, "time": "2007-06-12T02:32:16Z", "creator": "andreas@apache.org", "creation_time": "2007-06-12T02:32:16Z", "is_private": false}, {"count": 34, "tags": [], "bug_id": 42050, "attachment_id": null, "text": "(In reply to comment #32)\n> The proxy-css resource in lenya.xmap assumes that the call goes to a publication:\n> \n> <map:parameter name=\"root\"\n> value=\"{base-url:{page-envelope:publication-id}:{page-envelope:area}:false}\"/>\n> \n\n<map:transform src=\"fallback://lenya/resources/css/css.xsl\">\n          <map:parameter name=\"contextprefix\" value=\"{request:contextPath}\"/>\n          <map:parameter name=\"root\"\n           \nvalue=\"{base-url:{page-envelope:publication-id}:{page-envelope:area}:false}\"/>\n        </map:transform>\n\nThat is not proxy specific but css.xsl. Maybe the best if the base-url returns\n\"\" instead of throwing an exception.\n\n", "id": 104334, "time": "2007-06-12T05:38:08Z", "creator": "thorsten@apache.org", "creation_time": "2007-06-12T05:38:08Z", "is_private": false}, {"count": 35, "tags": [], "creator": "thorsten@apache.org", "attachment_id": null, "id": 104335, "time": "2007-06-12T05:39:35Z", "bug_id": 42050, "creation_time": "2007-06-12T05:39:35Z", "is_private": false, "text": "(In reply to comment #33)\n> IIUC the ProxyTransformer doesn't handle non-publication URLs either ...\n\nIt did! But ATM it is not anymore and I have no clue why "}, {"count": 36, "tags": [], "text": "Strange, if I uncomment the root parameter in lenya.xmap, I end up with an empty\nmenu.css. The Chaperon parser doesn't produce anything.", "attachment_id": null, "bug_id": 42050, "id": 104336, "time": "2007-06-12T06:55:30Z", "creator": "andreas@apache.org", "creation_time": "2007-06-12T06:55:30Z", "is_private": false}, {"count": 37, "tags": [], "creator": "andreas@apache.org", "attachment_id": null, "id": 104341, "time": "2007-06-12T07:52:15Z", "bug_id": 42050, "creation_time": "2007-06-12T07:52:15Z", "is_private": false, "text": "In my working copy the PatternTransformer seems to fail if the input is plain text."}, {"count": 38, "tags": [], "bug_id": 42050, "attachment_id": null, "text": "The css.xsl doesn't strip the <css> now, but wraps the CSS in chaperon text\nelements (revision 546516).", "id": 104342, "time": "2007-06-12T07:57:26Z", "creator": "andreas@apache.org", "creation_time": "2007-06-12T07:57:26Z", "is_private": false}, {"count": 39, "tags": [], "bug_id": 42050, "is_private": false, "text": "The uuid2url and proxy transformers are now complementing each other. I did\nquite a lot of testing on Tomcat, but not with a real proxy setting.", "id": 104371, "time": "2007-06-13T08:22:34Z", "creator": "andreas@apache.org", "creation_time": "2007-06-13T08:22:34Z", "attachment_id": null}, {"count": 40, "tags": [], "creator": "andreas@apache.org", "attachment_id": null, "is_private": false, "id": 104393, "time": "2007-06-14T03:56:08Z", "bug_id": 42050, "creation_time": "2007-06-14T03:56:08Z", "text": "I have configured Apache 2.2.4 with mod_proxy on my local machine and did some\ntesting without SSL. I also added a little tutorial how to setup the test\nenvironment.\n\nWith Jetty everything looks good. But when I use Tomcat, I get \"The session\ndoesn't contain the identity\" when I try to log in."}, {"count": 41, "tags": [], "bug_id": 42050, "attachment_id": null, "text": "A major problem with the \"global proxy\" approach are requests to\npublication-based module URLs. If they need authorization, the requests hit the\nlogin screen. This occurs for instance with the TinyMCE JavaScript requests like\n\nhttp://lenya.example.com/default/modules/tinymce/javascript/tiny_config.js\n\nMaking these URLs accessible by the world is certainly out of the question.", "id": 104423, "time": "2007-06-15T02:46:00Z", "creator": "andreas@apache.org", "creation_time": "2007-06-15T02:46:00Z", "is_private": false}, {"count": 42, "tags": [], "creator": "andreas@apache.org", "text": "(In reply to comment #41)\n> A major problem with the \"global proxy\" approach are requests to\n> publication-based module URLs. If they need authorization, the requests hit the\n> login screen.\n\nA workaround is to use the same proxy server for both publication-specific and\nglobal resources, but this would mask the \"lenya/...\" and \"modules/...\" URL spaces.\n\n", "id": 104424, "time": "2007-06-15T02:54:55Z", "bug_id": 42050, "creation_time": "2007-06-15T02:54:55Z", "is_private": false, "attachment_id": null}, {"count": 43, "tags": [], "text": "Non-SSL proxying works quite well now. Has to be tested with SSL yet.", "is_private": false, "bug_id": 42050, "id": 104679, "time": "2007-06-25T06:12:05Z", "creator": "andreas@apache.org", "creation_time": "2007-06-25T06:12:05Z", "attachment_id": null}, {"count": 44, "tags": [], "creator": "andreas@apache.org", "attachment_id": null, "id": 105657, "time": "2007-07-16T04:03:17Z", "bug_id": 42050, "creation_time": "2007-07-16T04:03:17Z", "is_private": false, "text": "I tested it with SSL and mod_proxy_ajp. If the problems still occur, please reopen."}]