[{"count": 0, "tags": [], "text": "Created attachment 32810\nsni status code patch for 2.4.x\n\nHTTP/2 clients will aggressively reuse TLS connections when certificates have matching alt names or wildcards and hosts resolve to the same IP address.\n\nmod_ssl is refusing sich requests with status 400. HTTP/2 introduced the new 421 (Misdirected Request) which clients will recognize and have them open a new connection with correct SNI name for it.\n\nIf the 400 behaviour is left unchanged, h2 clients will fail connections to vhosts where another connection already exists (and certs allow reuse).", "attachment_id": 32810, "bug_id": 58026, "id": 183468, "time": "2015-06-11T15:26:33Z", "creator": "stefan@eissing.org", "creation_time": "2015-06-11T15:26:33Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 58026, "attachment_id": null, "is_private": false, "id": 183469, "time": "2015-06-11T15:34:29Z", "creator": "ylavic.dev@gmail.com", "creation_time": "2015-06-11T15:34:29Z", "text": "The patch looks good, though I'm not sure httpd should close/drop the connection after returning 421.\nCan't the client still reuse it for further requests for the same host?"}, {"count": 2, "tags": [], "text": "No that I think of it, you are right. The close conn part needs to be dropped.", "attachment_id": null, "bug_id": 58026, "id": 183470, "time": "2015-06-11T15:36:15Z", "creator": "stefan@eissing.org", "creation_time": "2015-06-11T15:36:15Z", "is_private": false}, {"count": 3, "tags": [], "creator": "stefan@eissing.org", "text": "Created attachment 32812\nv2 of 421 Misdirected Request patch\n\nversion2 by removing the connection_close definition", "id": 183478, "attachment_id": 32812, "bug_id": 58026, "creation_time": "2015-06-12T10:24:46Z", "time": "2015-06-12T10:24:46Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 58026, "attachment_id": null, "id": 183481, "creation_time": "2015-06-12T12:07:12Z", "time": "2015-06-12T12:07:12Z", "creator": "ylavic.dev@gmail.com", "text": "Committed in r1685069.\n\nThis will still return 400 for the first request on the connection, thus HTTP/1 clients should probably not be affected, and HTTP/2 ones should also do the right thing for it...", "is_private": false}, {"count": 5, "tags": [], "text": "Resolved in 2.4.17", "attachment_id": null, "id": 187505, "creator": "stefan@eissing.org", "time": "2016-01-08T16:20:39Z", "bug_id": 58026, "creation_time": "2016-01-08T16:20:39Z", "is_private": false}]