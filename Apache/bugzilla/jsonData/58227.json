[{"count": 0, "tags": [], "bug_id": 58227, "attachment_id": null, "id": 184425, "time": "2015-08-09T20:43:22Z", "creator": "nirzohar@hotmail.com", "creation_time": "2015-08-09T20:43:22Z", "is_private": false, "text": "If you'll go in the Excel application, and click on \"Recalculate All\", it will evaluate all formulas and Data Tables at the workbook. But if you'll run FormulaEvaluator.evaluateAll() (from Java code) it's calculate only formulas without Data Tables.\n\nI was looking for alternative solution to run and calculate Data Table, cannot find any.\n\nThanks"}, {"count": 1, "tags": [], "bug_id": 58227, "text": "Currently, the Formula Evaluator only iterates over sheets, rows and cells\n\nAny chance you could create a very small test file with a data table in it along with some regular formulas, and a junit test case that tweaks some values in the spreadsheet and table, then does a recalculate, and finally asserts the updated values? That should pass for the sheets, but fail for the data table, but will be a good start for an eventual fix", "id": 184429, "time": "2015-08-10T06:01:11Z", "creator": "apache@gagravarr.org", "creation_time": "2015-08-10T06:01:11Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "text": "Created attachment 32986\nExcel file with example", "attachment_id": 32986, "id": 184450, "creator": "nirzohar@hotmail.com", "time": "2015-08-10T13:56:48Z", "bug_id": 58227, "creation_time": "2015-08-10T13:56:48Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 58227, "attachment_id": 32987, "id": 184451, "creation_time": "2015-08-10T13:57:48Z", "time": "2015-08-10T13:57:48Z", "creator": "nirzohar@hotmail.com", "text": "Created attachment 32987\nJava file example", "is_private": false}, {"count": 4, "tags": [], "bug_id": 58227, "attachment_id": null, "id": 184452, "time": "2015-08-10T14:03:16Z", "creator": "nirzohar@hotmail.com", "creation_time": "2015-08-10T14:03:16Z", "is_private": false, "text": "The attached excel file contains data table (M4:P52).\nIf you'll change the input 3 for the data table, and run \"Recalculate All\", you'll see the values in the data tables changes. (Only after click on recalculate all).\n\nThe same logic in the attached java file. I change the 3rd input (cell C4), and recalculate all cells, but data tables values do not effected.\n\nNote, I use private method evaluateAllCells which run over all cells and calculate the formula. I use this method since FormulaEvaluator.evaluateAll() throw an exception.\n\nThanks"}, {"count": 5, "tags": [], "bug_id": 58227, "attachment_id": null, "id": 184453, "time": "2015-08-10T14:04:33Z", "creator": "apache@gagravarr.org", "creation_time": "2015-08-10T14:04:33Z", "is_private": false, "text": "Thanks for that. However, the test java program doesn't seem to be doing any checks on the data table part, on the main sheet part. Any chance you could add that check in too?"}, {"count": 6, "tags": [], "bug_id": 58227, "attachment_id": null, "id": 184458, "time": "2015-08-10T19:40:44Z", "creator": "nirzohar@hotmail.com", "creation_time": "2015-08-10T19:40:44Z", "is_private": false, "text": "The java program (line 42) get the value from M4 cell. This value should be updated after recalculate with data table.\n\nTo manually simulate this, open the file with excel, change the value in cell C4. Look at the value at M4 (just random cell in the data table), this value in cell M4 will be change only after you'll run \"recalculate all\".\n\nThe java app do the same logic.\n\nThanks"}]