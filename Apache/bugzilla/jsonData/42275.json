[{"count": 0, "tags": [], "bug_id": 42275, "attachment_id": null, "id": 102545, "time": "2007-04-27T04:41:45Z", "creator": "stevel@apache.org", "creation_time": "2007-04-27T04:41:45Z", "is_private": false, "text": "This is from Ant User...someone is running ant in their own bat file, with a\nclasspath containing entries like \n \\\\PC03\\jclasses\\lib\\ant-1.7.0.jar\non the classpath.\n\nAnt is failing while trying to create the URI of the file\njava.lang.IllegalArgumentException: URI has an authority component\n       at java.io.File.<init>(Unknown Source)\n       at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n       at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)\n       at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)\n       at java.lang.reflect.Constructor.newInstance(Unknown Source)\n       at org.apache.tools.ant.launch.Locator.fromURI(Locator.java:165)\n       at org.apache.tools.ant.launch.Locator.getResourceSource(Locator.java:119)\n       at org.apache.tools.ant.launch.Locator.getClassSource(Locator.java:90)\n       at org.apache.tools.ant.Project.setAntLib(Project.java:313)\n       at org.apache.tools.ant.Project.initProperties(Project.java:309)\n       at org.apache.tools.ant.Project.init(Project.java:295)\n       at org.apache.tools.ant.Main.runBuild(Main.java:663)\n       at org.apache.tools.ant.Main.startAnt(Main.java:199)\n       at org.apache.tools.ant.Main.start(Main.java:161)\n       at org.apache.tools.ant.Main.main(Main.java:250)"}, {"attachment_id": null, "tags": [], "bug_id": 42275, "text": "This is related to Java bug\nhttp://bugs.sun.com/bugdatabase/view_bug.do?bug_id=5086147\n\nnew File(file1.toURI().toString()) fails if file1 is a network file.\n\nthis is seemingly fixed in Java1.6, though I can still get our (new) test to\nfail on java1.6", "count": 1, "id": 102548, "time": "2007-04-27T05:43:11Z", "creator": "stevel@apache.org", "creation_time": "2007-04-27T05:43:11Z", "is_private": false}, {"count": 2, "text": "*** Bug 42422 has been marked as a duplicate of this bug. ***", "bug_id": 42275, "attachment_id": null, "id": 103229, "time": "2007-05-15T05:10:57Z", "creator": "stevel@apache.org", "creation_time": "2007-05-15T05:10:57Z", "tags": [], "is_private": false}, {"id": 103519, "tags": [], "bug_id": 42275, "attachment_id": null, "count": 3, "text": "Believe this is fixed in Ant1.7.1; re-open if this is not the case.", "time": "2007-05-22T13:44:54Z", "creator": "stevel@apache.org", "creation_time": "2007-05-22T13:44:54Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 42275, "text": "doing \\\\somesystem\\ant\\bin\\ant -version \n-using 2/14/08 nightly (1.8.0alpha)\n\njava.lang.ClassNotFoundException: org.apache.tools.ant.Main\n        at java.net.URLClassLoader$1.run(Unknown Source)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at java.net.URLClassLoader.findClass(Unknown Source)\n        at java.lang.ClassLoader.loadClass(Unknown Source)\n        at java.lang.ClassLoader.loadClass(Unknown Source)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:255)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:104)", "count": 4, "id": 113759, "time": "2008-02-14T13:34:50Z", "creator": "ron.saito@hp.com", "creation_time": "2008-02-14T13:34:50Z", "is_private": false}, {"count": 5, "attachment_id": null, "bug_id": 42275, "is_private": false, "id": 113852, "time": "2008-02-18T03:09:01Z", "creator": "stevel@apache.org", "creation_time": "2008-02-18T03:09:01Z", "tags": [], "text": "...yes, I can confirm this too.\n\nC:\\Documents and Settings\\slo>\\\\morzine\\slo\\Java\\Apache\\ant\\bin\\ant.bat  -version\njava.lang.ClassNotFoundException: org.apache.tools.ant.Main\n        at java.net.URLClassLoader$1.run(Unknown Source)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at java.net.URLClassLoader.findClass(Unknown Source)\n        at java.lang.ClassLoader.loadClass(Unknown Source)\n        at java.lang.ClassLoader.loadClass(Unknown Source)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:255)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:104)\n\n-debug, -verbose, -diagnostics options don't get a look in"}, {"id": 101184, "tags": [], "bug_id": 42275, "attachment_id": null, "count": 6, "text": "A bit more logging on failures and we see what is going on :\n\nC:\\>\\\\morzine\\slo\\Java\\Apache\\ant\\bin\\ant.bat\nUnable to locate tools.jar. Expected to find it in C:\\Java\\lib\\tools.jar\nFailed to locateorg.apache.tools.ant.Main\nant.home\\\\morzine\\slo\\Java\\Apache\\ant\\bin\\..\nClasspath: \\\\morzine\\slo\\Java\\Apache\\ant\\bin\\..\\lib\\ant-launcher.jar\nLauncher JAR: C:\\morzine\\slo\\Java\\Apache\\ant\\lib\\ant-launcher.jar\nlauncher Directory: C:\\morzine\\slo\\Java\\Apache\\ant\\lib\nC:\\>\n\nWe are failing to correctly determine the path to the launcher JAR, and hence to\nANT_HOME", "time": "2008-02-26T06:29:03Z", "creator": "stevel@apache.org", "creation_time": "2008-02-26T06:29:03Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 42275, "text": "More logging shows that the URL is being correct\nC:\\>\\\\morzine\\slo\\Java\\Apache\\ant\\bin\\ant.bat\norg/apache/tools/ant/launch/Launcher.class is in jar:file://morzine/slo/Java/Apa\nche/ant/lib/ant-launcher.jar!/org/apache/tools/ant/launch/Launcher.class\n\nThis puts the bug in fromURIJava13", "id": 100968, "time": "2008-02-26T06:34:03Z", "creator": "stevel@apache.org", "creation_time": "2008-02-26T06:34:03Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 42275, "text": "Fixed in Ant1.8; leave it to kevin to see if he wants to add it to ant 1.7", "count": 8, "id": 99019, "time": "2008-02-26T07:56:54Z", "creator": "stevel@apache.org", "creation_time": "2008-02-26T07:56:54Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 42275, "text": "*** Bug 45846 has been marked as a duplicate of this bug. ***", "id": 120984, "time": "2008-09-25T06:47:32Z", "creator": "bodewig@apache.org", "creation_time": "2008-09-25T06:47:32Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 42275, "attachment_id": null, "text": "An apparently related bug: using a basic <import> in a project located on a UNC share works in 1.7.0 and 1.8 dev but not in 1.7.1. See\n\nhttp://www.netbeans.org/nonav/issues/show_bug.cgi?id=146948\n\nfor details. SVN logs confusingly has two entries for this bug:\n\n------------------------------------------------------------------------\nr631263 | stevel | 2008-02-26 10:52:51 -0500 (Tue, 26 Feb 2008) | 1 line\n\nBug 42275 running ant off a network share can cause Ant to fail\n------------------------------------------------------------------------\nr533082 | stevel | 2007-04-27 08:45:53 -0400 (Fri, 27 Apr 2007) | 9 lines\n\nBug 42275: ant doesnt run from a network share, because of an error when trying to work out where we loaded from.\n\n1. this exception is still raised, but caught and causes ant to skip setting ant.lib.\n\n2. we now have a test class for Locator\n\n3. I've split out the java1.3 support and made it public, so we can test it separately. \n\nOne of the tests is failing, showing the problem is still there. We need to decide what to do about it (ignore, switch to java1.3 code...)\n------------------------------------------------------------------------\n", "id": 121101, "time": "2008-09-30T11:03:05Z", "creator": "jglick@apache.org", "creation_time": "2008-09-30T11:03:05Z", "is_private": false}, {"count": 11, "tags": [], "bug_id": 42275, "text": "I fixed the import issue in 1.7.1 (as reported in Bug 45846) by using dirname to get the base path of the importing file, e.g. \n\n<dirname property=\"masterbuild.basedir\" file=\"${ant.file.masterbuild}\"/>\n<import file=\"${masterbuild.basedir}/build-utils.xml\"/>\n\nThis shows that the dirname task at least can work where things are on the file system.\n\nHTH\n", "id": 121107, "time": "2008-09-30T14:12:13Z", "creator": "miles.daffin@morganstanley.com", "creation_time": "2008-09-30T14:12:13Z", "is_private": false, "attachment_id": null}, {"count": 12, "tags": [], "creator": "jglick@apache.org", "attachment_id": null, "id": 121127, "time": "2008-10-01T09:07:15Z", "bug_id": 42275, "creation_time": "2008-10-01T09:07:15Z", "is_private": false, "text": "The minimal fix for the UNC import problem in Ant 1.7.1 (which I think should be merged to a 1.7.2 if one is created, since this is a serious regression), borrowed from SVN r631263:\n\nIndex: src/main/org/apache/tools/ant/launch/Locator.java\n===================================================================\n--- src/main/org/apache/tools/ant/launch/Locator.java\t(revision 700534)\n+++ src/main/org/apache/tools/ant/launch/Locator.java\t(working copy)\n@@ -275,7 +275,8 @@\n             path = decodeUri(uri);\n             String cwd = System.getProperty(\"user.dir\");\n             int posi = cwd.indexOf(\":\");\n-            if ((posi > 0) && path.startsWith(File.separator)) {\n+            if ((posi > 0) && path.startsWith(File.separator)\n+                    /* #42275: UNC */ && !path.startsWith(\"\\\\\\\\\")) {\n                path = cwd.substring(0, posi + 1) + path;\n             }\n         } catch (UnsupportedEncodingException exc) {\n"}, {"attachment_id": null, "tags": [], "bug_id": 42275, "text": "the fix svn revision is 42275", "count": 13, "id": 121520, "time": "2008-10-14T23:59:58Z", "creator": "bodewig@apache.org", "creation_time": "2008-10-14T23:59:58Z", "is_private": false}, {"count": 14, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 121523, "time": "2008-10-15T01:23:45Z", "bug_id": 42275, "creation_time": "2008-10-15T01:23:45Z", "is_private": false, "text": "sorry, 631263\n\nhttp://svn.eu.apache.org/viewvc?view=rev&revision=631263"}, {"count": 15, "attachment_id": null, "bug_id": 42275, "is_private": false, "id": 122267, "time": "2008-11-06T19:17:24Z", "creator": "jglick@apache.org", "creation_time": "2008-11-06T19:17:24Z", "tags": [], "text": "FYI - for NetBeans 6.5 we are just shipping the Locator.java minipatch shown above."}]