[{"count": 0, "tags": [], "creator": "geetha.munees@gmail.com", "attachment_id": null, "id": 124714, "time": "2009-02-08T07:24:45Z", "bug_id": 46673, "creation_time": "2009-02-08T07:24:45Z", "is_private": false, "text": "Thanks for giving this product to us.\n\nIn my project, i want to convert the xls(or xlsx file) into CSV file.\n\nI dont know how to get the formated value from the cell\n\n   1. If the numeric cell have \"$12,000\" (With format) but i get only the value (12000).  \n   2. If the Date cell \"12-May\" but i get only number (23455).\n\nI missed some thing in code.so plz anybody help me. how to get the formatted value from the cell.\n\nHere my code:\n\n    WorkbookFactory wbFact = new WorkbookFactory();\n    Workbook wbs = wbFact.create(new FileInputStream(file));\n    int noOfSheets = wbs.getNumberOfSheets();\n    FormulaEvaluator evaluator = wbs.getCreationHelper().createFormulaEvaluator();\n    String csvString = \"\";   \n    Sheet sheet = wbs.getSheetAt(sheetNo); \n    boolean isFirstRow = true;\n    for (Iterator rit = sheet.rowIterator(); rit.hasNext(); )\n    {\n      if(!isFirstRow)\n      {\n        csvString += \"\\r\\n\";\n      }\n      Row row = (Row)rit.next();\n      boolean isFirstCell = true;\n      for (Iterator cit = row.cellIterator(); cit.hasNext(); )\n      {\n        if(!isFirstCell)\n        {\n          csvString += \",\";\n        }\n        Cell cell = (Cell)cit.next();\n        String val = \"\";\n        switch (cell.getCellType())\n        {\n          case Cell.CELL_TYPE_BOOLEAN:\n              val = String.valueOf(cell.getBooleanCellValue());\n              break;\n          case Cell.CELL_TYPE_NUMERIC:\n              val = String.valueOf(cell.getNumericCellValue());\n              break;\n          case Cell.CELL_TYPE_STRING:\n              val = String.valueOf(cell.getStringCellValue());\n              break;\n          case Cell.CELL_TYPE_BLANK:\n              break;\n          case Cell.CELL_TYPE_ERROR:\n              break;\n          case Cell.CELL_TYPE_FORMULA:\n              val = evaluator.evaluate(cell).formatAsString();\n              break;\n        }\n        csvString += \"\\\"\" + val + \"\\\"\";\n        isFirstCell = false;\n      }\n      isFirstRow = false;\n    }\n    return csvString;   \n  }"}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 124716, "time": "2009-02-08T10:48:03Z", "bug_id": 46673, "creation_time": "2009-02-08T10:48:03Z", "is_private": false, "text": "Firstly, please do not use bugzilla for use questions, use the mailing list for that. Bugzilla is only for bugs\n\nSecondly, look at the various HSSF formatter classes, as by default poi returns the raw values stored in the file"}]