[{"count": 0, "tags": [], "creator": "webmaster33@bigfoot.com", "attachment_id": null, "id": 44788, "time": "2003-09-28T04:53:53Z", "bug_id": 23460, "creation_time": "2003-09-28T04:53:53Z", "is_private": false, "text": "It seems, that mod_rewrite use all lowercase URLs under Windows.\nThe typed URL was:\nhttp://www.site.com/Computers/Printers/page=2/order=d/sort=1\n\nI used the following Rewrite rules in .htaccess:\nRewriteEngine on\nRewriteCond   %{HTTP_HOST}                 ^www\\.site\\.com$\nRewriteRule ^(.*)/cat/(.*)page([0-9]+)[/]?(.*)$   /script.cgi?cat=$1&page=$3\nRewriteRule ^(.*)/order(a|d)[/]?(.*)$     /script.cgi?%{QUERY_STRING}&order=$2\nRewriteRule ^(.*)/sort([0-9]+)[/]?(.*)$   /script.cgi?%{QUERY_STRING}&sort=$2\nRewriteRule ^/script.cgi(.*)$     /cgi-bin/script.cgi?%{QUERY_STRING} [L]\n\nBut in rewrite_log.txt appears:\n(2) [per-dir c:/path/] rewrite computers/printers/page=2/order=d/sort=1 ->\n/script.cgi?cat=computers/printers&page=2&order=d&sort=1\n\n\nI searched bugzilla, docs, faqs, asked IRC channels, but I did not find any\nissues about this problem/behaviour.\n\nI have disabled mod_spelling module, so that can not cause the lowercase URL\nissue in rewrite engine. I don't know other feature, what is URL case related, \nand is enabled or used in my server config.\n\n\nIt may happen that mod_rewrite is treating URLs are all lowercase because of\nWindows FAT32 file system. \nScripts should always get the correct case URL input, because if not, some\nspecific scripts will fail.\n\nBest regards,\nWebmaster33"}, {"count": 1, "tags": [], "bug_id": 23460, "attachment_id": null, "text": "mod_rewrite doesn't modify the case without advice (aka RewriteMap). My first\nguess is, that this is a browser/proxy problem. Did you try another one or\ntelnetting to the server?", "id": 44814, "time": "2003-09-29T06:58:32Z", "creator": "nd@perlig.de", "creation_time": "2003-09-29T06:58:32Z", "is_private": false}, {"count": 2, "tags": [], "creator": "webmaster33@bigfoot.com", "text": "BTW: there is a mistake in the example, however that does not affect the problem:\nThe typed URL should be for the current rewrite rule:\nhttp://www.site.com/Computers/Printers/page2/orderd/sort1\n\nAnd in rewrite_log.txt appears:\n(2) [per-dir c:/path/] rewrite computers/printers/page2/orderd/sort1 ->\n/script.cgi?cat=computers/printers&page=2&order=d&sort=1\n\n>My first guess is, that this is a browser/proxy problem.\nIt can not be a browser problem. I tried with both Mozilla and IE.\n\nAlso tried the telnetting now. The response is:\nHTTP/1.1 200 OK\nDate: Mon, 29 Sep 2003 12:54:22 GMT\nServer: Apache/1.3.27 (Win32)\nConnection: close\nContent-Type: text/html; charset=iso-8859-2\n\nBut the \"Computers/Printers\" category parameter, appears to get passed as all\nlowercase to the cgi script, as: \"computers/printers\"\n\nI have only these modules loaded:\nLoadModule rewrite_module modules/mod_rewrite.so\n# module order\nClearModuleList\nAddModule mod_env.c\nAddModule mod_log_config.c\nAddModule mod_mime.c\nAddModule mod_negotiation.c\nAddModule mod_include.c\nAddModule mod_autoindex.c\nAddModule mod_dir.c\nAddModule mod_isapi.c\nAddModule mod_cgi.c\nAddModule mod_asis.c\nAddModule mod_imap.c\nAddModule mod_actions.c\nAddModule mod_userdir.c\nAddModule mod_alias.c\nAddModule mod_rewrite.c\nAddModule mod_access.c\nAddModule mod_auth.c\nAddModule mod_so.c\nAddModule mod_setenvif.c\n\nShould I try another Apache version?\nI can not imagine what causes that mod_rewrite uses lowercase URLs. The [NC]\nflag is not used.\nThe only possibility would be, that mod_rewrite converts URLs to lowercase under\nWindows/FAT32. And that would be a bug.\n\nAny idea?", "id": 44835, "time": "2003-09-29T13:14:16Z", "bug_id": 23460, "creation_time": "2003-09-29T13:14:16Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "webmaster33@bigfoot.com", "text": "Now I'm sure it's not a config problem.\nThe problem also appears on Apache v1.3.28.\n\nI would try to make clear the problem.\nTest URL:\nhttp://www.site.com/Computers/Printers/Cables/index.html\n\nUsing following rewrite rule I would like to use some part of the URL as input\ninto a script:\nRewriteEngine on\nRewriteRule ^(/.*)/index.html$   /script.cgi?cat=$1\n\nThe problem is, that $1 will be not \"Computers/Printers/Cables\", but\n\"computers/Printers/Cables\".\nThe script input needs the category name in correct case, doesn't matter if we\nuse Unix or Windows.\n\n\nBut in rewrite_log.txt appears:\n(3) [per-dir z:/dir/] add path-info postfix: z:/dir/computers ->\nz:/dir/computers/Printers/Cables/index.html\n(3) [per-dir z:/dir/] strip per-dir prefix:\nz:/dir/computers/Printers/Cables/index.html -> computers/Printers/Cables/index.html\n(3) [per-dir z:/dir/] applying pattern '^(.*)/index.html$' to uri\n'computers/Printers/Cables/index.html'\n(2) [per-dir z:/dir/] rewrite computers/Printers/Cables/index.html ->\n/script.cgi?&cat=computers/Printers/Cables\n(3) split uri=/script.cgi?&cat=computers/Printers/Cables -> uri=/script.cgi,\nargs=&cat=computers/Printers/Cables\n(1) [per-dir z:/dir/] internal redirect with /script.cgi [INTERNAL REDIRECT]\n(3) [per-dir z:/dir/] strip per-dir prefix: z:/dir/script.cgi -> script.cgi\n(3) [per-dir z:/dir/] applying pattern '^(.*)/index.html$' to uri 'script.cgi'\n(1) [per-dir z:/dir/] pass through z:/dir/script.cgi\n\nIs that normal?\n\"computers/Printers/Cables\" is inserted with $1, and not the expected\n\"Computers/Printers/Cables\".\n\nI know, it may be related to the Windows's case insensitive filesystem, however\nthe rewrite feature is wrong that way. Script inputs are case sensitive on all\nsystems, so mod_rewrite should be also case sensitive. Windows understands both\nlowercase and uppercase paths, so paths with correct case from mod_rewrite are\ntreated well at system level.\n\nI think the bug is at \"add path-info postfix\" action, since the base dir is not\n\"z:/dir\" as would expected, but \"z:/dir/computers\".\n\nBest regards,\nWebmaster33\n(using Apache v1.3.28)", "id": 45448, "time": "2003-10-12T21:20:54Z", "bug_id": 23460, "creation_time": "2003-10-12T21:20:54Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "nd@perlig.de", "text": "It must be somewhere else. The path-info adding is correct, if z:/dir exists.\nCan you attach your whole configuration? Or better can you break down the \nproblem to a minimal configuration?\n\nIf you don't want to publish your httpd.conf you mail it me privately as well.\n\nThanks.", "id": 45449, "time": "2003-10-12T21:37:46Z", "bug_id": 23460, "creation_time": "2003-10-12T21:37:46Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 23460, "attachment_id": null, "text": "Better sending privately. Thanks!", "id": 45451, "time": "2003-10-12T21:40:37Z", "creator": "webmaster33@bigfoot.com", "creation_time": "2003-10-12T21:40:37Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 23460, "attachment_id": null, "text": "Received, thanks. I'm digging into it tomorrow (it's quite late here :)", "id": 45453, "time": "2003-10-12T22:03:12Z", "creator": "nd@perlig.de", "creation_time": "2003-10-12T22:03:12Z", "is_private": false}, {"count": 7, "attachment_id": null, "bug_id": 23460, "text": "  This is resolved in Apache 2.0 - Apache 1.3 simply lowercased the filenames\n  to 'canonicalize' them to their \"one true name\".  Yes this was very hackish,\n  but that's the Apache 1.3 on Windows solution - an interesting and clever hack.\n\n  Apache 2.0 was written from the ground up - and this was taken into account.\n  The file's *true names* are used in Apache 2.0 (as stored on disk as their\n  long file names.)  Also the \"one true name\", this takes a few more cpu/disk\n  cycles but is more reliable and doesn't cause the sorts of problems you are\n  encountering.\n\n  Please upgrade to 2.0 to resolve your issue.", "id": 45466, "time": "2003-10-13T07:54:03Z", "creator": "wrowe@apache.org", "creation_time": "2003-10-13T07:54:03Z", "tags": [], "is_private": false}, {"count": 8, "tags": [], "bug_id": 23460, "attachment_id": null, "text": "Yes, I upgraded to 2.0, and it works fine now. \nThanks!\n\n\n>Apache 1.3 simply lowercased the filenames\n>to 'canonicalize' them to their \"one true name\"\nHowever I think, that this should be still fixed in v1.3.x.\n\nUnfortunately not the filename (or not just) was lowercased, but the path itself\nin the \"add path-info postfix\" phase.\nI think the base path is detected incorrectly: \"z:/dir/computers\" instead \"z:/dir\".\nThe \"/computers\" string should belong to post part.\n\nOpinion?\n\nBTW: Why does it need to lowercase anything, when the FAT16-32 is case\ninsensitive? If the URL part of the path is kept with original case, the Windows\nwill still accept it.", "id": 45548, "time": "2003-10-13T17:17:26Z", "creator": "webmaster33@bigfoot.com", "creation_time": "2003-10-13T17:17:26Z", "is_private": false}, {"count": 9, "tags": [], "creator": "webmaster33@bigfoot.com", "text": "Was this bug really fixed in v1.3.x?", "id": 58093, "time": "2004-05-25T21:23:56Z", "bug_id": 23460, "creation_time": "2004-05-25T21:23:56Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 23460, "attachment_id": null, "text": "Nope.\n\n(a) it's not a bug in mod_rewrite\n(b) it's fixed 2.0. As said, 1.3 will stay as is.\n\nPerhaps it should have better been resolved to wontfix...", "id": 58094, "time": "2004-05-25T21:30:03Z", "creator": "nd@perlig.de", "creation_time": "2004-05-25T21:30:03Z", "is_private": false}, {"count": 11, "tags": [], "creator": "webmaster33@bigfoot.com", "attachment_id": null, "id": 58095, "time": "2004-05-25T21:46:09Z", "bug_id": 23460, "creation_time": "2004-05-25T21:46:09Z", "is_private": false, "text": ">(a) it's not a bug in mod_rewrite\n\nIf not a bug in mod_rewrite, then bug in Apache. Doesn't change the fact, that\nv1.3.x is not working correctly.\n\n\n>(b) it's fixed 2.0. As said, 1.3 will stay as is.\n\nI'm glad, that it's fixed in 2.0, but it still should be fixed in 1.3.x.\n\n\nI found a fix in 1.3.13, which seems interesting:\n\"  *) Add case_preserved_filename field to the request_rec structure.\n     On systems with case insensitive file systems (Windows, OS/2, etc.), \n     r->filename is case canonicalized (folded to either lower or upper \n     case, depending on the specific system) to accomodate file access\n     checking. case_preserved_filename is the same as r->filename \n     except case is preserved. There is at least one instance where Apache \n     needs access to the case preserved filename: Java class files published \n     with WebDAV need to preserve filename case to make the Java compiler \n     happy. [Bill Stoddard]\"\nIsn't it something that may help current issue?\n\nAnyway, until it's not fixed in 1.3.x, I'm reopening the bug. Sorry."}, {"count": 12, "tags": [], "bug_id": 23460, "attachment_id": null, "text": "Patches welcome ;-)", "id": 58096, "time": "2004-05-25T21:53:29Z", "creator": "nd@perlig.de", "creation_time": "2004-05-25T21:53:29Z", "is_private": false}, {"count": 13, "tags": [], "creator": "wrowe@apache.org", "text": "Whoops.  Ok, this has simply got to be marked won'tfix.\n\nAs I said 15 months ago - it is simply NOT possible to straighten this\nout in Apache 1.3/Win32.  Nothing has changed, or will change, in that\nanswer.  If you don't like the behavior (certainly I don't :-) then\nupgrade to 2.0.\n\n\n\n\n", "id": 70531, "time": "2005-02-05T02:33:37Z", "bug_id": 23460, "creation_time": "2005-02-05T02:33:37Z", "is_private": false, "attachment_id": null}, {"count": 14, "tags": [], "bug_id": 23460, "attachment_id": null, "text": "*** Bug 47393 has been marked as a duplicate of this bug. ***", "id": 128129, "time": "2009-06-21T15:31:54Z", "creator": "bobsiegen@googlemail.com", "creation_time": "2009-06-21T15:31:54Z", "is_private": false}]