[{"count": 0, "text": "Created attachment 24011\nTemplate\n\nHi,\n\nI prove this code and the result is a corrupted xls file.\n\n        HSSFWorkbook wb=null;\n\t\tFile plantilla = new File(\"/plantillas/PlantillaPrueba.xls\");\n        try {\n\t\t\tFileInputStream is=new FileInputStream(plantilla);\n\t\t\twb = new HSSFWorkbook(is);\n\n        \n\t        HSSFSheet hoja = wb.getSheetAt(1);\n\t        int i = 11;\n\t\t\tint j = hoja.getLastRowNum();\n\t        int num = 10;\n\t        hoja.shiftRows(i, j, num);\n\t\n\t        File resp = new File(\"/plantillas/prueba.xls\");    \n\n\t    \tOutputStream fileOut = new FileOutputStream(resp);\n\t    \twb.write(fileOut);\n\t    \tfileOut.flush();\n\t\t\tfileOut.close();\n\t\t\tis.close();\n\t\t} catch (IOException e) {\n\t\t\t// TODO Auto-generated catch block\n\t\t\te.printStackTrace();\n\t\t}\n\nI think that the problem ocurred when shiftrows is called, because when I comment this line the xls is obtained well formed.\n\nIn the attachment file you can ontain the template file use for the example.\n\nthanks.", "bug_id": 47553, "attachment_id": 24011, "id": 129013, "time": "2009-07-21T02:59:04Z", "creator": "antonio.APG@gmail.com", "creation_time": "2009-07-21T02:59:04Z", "tags": [], "is_private": false}, {"count": 1, "attachment_id": 24019, "bug_id": 47553, "text": "Created attachment 24019\nxls obtained when it is opened an error message appears", "id": 129033, "time": "2009-07-22T00:06:11Z", "creator": "antonio.APG@gmail.com", "creation_time": "2009-07-22T00:06:11Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 47553, "text": "I tested version 3.5 of POI and works fine, the only problem I have is that my application has to work on java1.4 :S", "id": 129114, "time": "2009-07-24T05:48:36Z", "creator": "antonio.APG@gmail.com", "creation_time": "2009-07-24T05:48:36Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "yegor@dinom.ru", "text": "I confirmed that your test works with current trunk, so there is nothing to fix.\n\nPOI 3.5+ requires JDK 1.5. If you need to run it on 1.4, try to use RetroWeaver: \nhttp://retroweaver.sourceforge.net/\n\nThis tool transforms Java class files compiled by a 1.5 compiler into version 1.4 class files which can then be run on any 1.4 virtual machine.\n\nYegor", "id": 129145, "time": "2009-07-25T04:09:38Z", "bug_id": 47553, "creation_time": "2009-07-25T04:09:38Z", "is_private": false, "attachment_id": null}]