[{"count": 0, "tags": [], "bug_id": 49886, "attachment_id": 25993, "id": 139720, "time": "2010-09-06T10:29:30Z", "creator": "efouche.externe@pagesjaunes.fr", "creation_time": "2010-09-06T10:29:30Z", "is_private": false, "text": "Created attachment 25993\nPathconvert test case\n\nHi\n\nEnvironnement:\nWindows XP and 2008\nJava Sun-1.6.0_14\nANT-1.7.1, migrating to 1.8.1\n\nI work on a project that create a standalone java application. \nTo reduces modication of the startup shell script, we define the application's classpath using a MANIFEST-only JAR containing the appropriate \"Class-Path\" entry. \nThis MANIFEST is created by ANT with the following code using the pathconvert task\n\n<pathconvert targetos=\"unix\" property=\"classpath.in.manifest\" refid=\"cp.classpath.in.manifest\" pathsep=\" \">\n   <compositemapper>\n      <mapper type=\"glob\" from=\"${lib1.location}\" to=\"file:///${lib1.mapped.location}\"/>\n      <mapper type=\"glob\" from=\"${lib2.location}\" to=\".\"/>\n   </compositemapper>\n</pathconvert>\n<jar jarfile=\"${jar.file}\">\n   <manifest>\n      <attribute name=\"Built-By\" value=\"${user.name}\"/>\n      <attribute name=\"Class-Path\" value=\"${classpath.in.manifest}\"/>\n   </manifest>\n</jar>\n\nWith ANT-1.7.1 runtime, this generates the expected MANIFEST in the jar.\n\nExemple [truncated]:\nClass-Path: file:///e:/toto/libs/antlr-2.7.6/antlr-2.7.6.jar file:///e\n :/toto/libs/apache-log4j-1.2.15/log4j-1.2.15.jar file:///e:/toto/libs\n /aspectj-1.6.2/aspectjrt.jar file:///e:/toto/libs/aspectj-1.6.2/aspec\n tjweaver.jar file:///e:/toto/libs/c3p0/c3p0-0.9.1.2.jar \n\nUsing ANT-1.8.1 runtime, ${classpath.in.manifest} is evaluated to the empty string.\n\nThe workaroud is to use nested <map> elements of pathconvert, but is it the intended behaviour for nested <mapper> ?\n\nAttached test case requires:\nANT-1.7.1 & 1.8.1 binary distribution\nUpdate of the schell script to point to the correct installation directories\n\nOutput is written to \"ant171.log\" and \"ant181.log\" in ${basedir}\n\n\nRegards"}, {"count": 1, "tags": [], "creator": "bodewig@apache.org", "text": "I think you will find the change is because we fixed bug 46506\n\nIf you append a * at the end of your from and to patterns things should\nworks consistently with Ant 1.7.1 and 1.8.1.\n\nThis is documented in 1.8.0's \"Changes that could break older environments\"\nsection.", "id": 140020, "time": "2010-09-21T10:52:48Z", "bug_id": 49886, "creation_time": "2010-09-21T10:52:48Z", "is_private": false, "attachment_id": null}]