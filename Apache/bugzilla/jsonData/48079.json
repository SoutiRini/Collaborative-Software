[{"attachment_id": null, "tags": [], "creator": "michael.ramirez@apollogrp.edu", "is_private": false, "count": 0, "id": 131470, "time": "2009-10-28T11:32:10Z", "bug_id": 48079, "creation_time": "2009-10-28T11:32:10Z", "text": "This seems to be a repeat of Bug 45322, which was fixed for POI 3.2.  This is now happening in 3.5-FINAL.\n\nI'm getting the same outofboundsexception when performing an autoSizeColumn on columns whose data format returns -1."}, {"count": 1, "tags": [], "text": "Can you attach a file and sample code to reproduce the problem? 3.5-FINAL works fine for the file attached to Bug 45322. \n\nYegor", "attachment_id": null, "id": 131472, "creation_time": "2009-10-28T12:01:58Z", "time": "2009-10-28T12:01:58Z", "creator": "yegor@dinom.ru", "bug_id": 48079, "is_private": false}, {"count": 2, "tags": [], "bug_id": 48079, "attachment_id": 24439, "id": 131473, "time": "2009-10-28T12:18:53Z", "creator": "michael.ramirez@apollogrp.edu", "creation_time": "2009-10-28T12:18:53Z", "is_private": false, "text": "Created attachment 24439\nXLSServlet.java generates spreadsheet data."}, {"count": 3, "tags": [], "creator": "michael.ramirez@apollogrp.edu", "is_private": false, "id": 131474, "attachment_id": null, "bug_id": 48079, "creation_time": "2009-10-28T12:19:32Z", "time": "2009-10-28T12:19:32Z", "text": "Attached code.  Unable to generate a file because it fails on autoSizeColumn."}, {"count": 4, "tags": [], "text": "FYI: The following line of code was added to bypass the exception:\n\nif ( null != row.getCell(i) && null != row.getCell(i).getCellStyle() && row.getCell(i).getCellStyle().getDataFormat() > -1 )\n\nWith that line removed, the exception occurs at:\n\nsheet.autoSizeColumn((short)i);", "attachment_id": null, "id": 131476, "creation_time": "2009-10-28T12:26:17Z", "time": "2009-10-28T12:26:17Z", "creator": "michael.ramirez@apollogrp.edu", "bug_id": 48079, "is_private": false}, {"count": 5, "tags": [], "bug_id": 48079, "attachment_id": null, "text": "If you attempt to use org.apache.poi.hssf.usermodel.HSSFSheet and method autosizecolumn(int) on a column after setting more than 32767 cells then ArrayOutOfBoundsException is thrown.\n\nI found this while accessing java via ColdFusion, i doubt you'll want my source code! \n\nThis major bug is still present in version 3.7.", "id": 141308, "time": "2010-11-01T12:30:39Z", "creator": "neil.pugh@pancentric.com", "creation_time": "2010-11-01T12:30:39Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 48079, "attachment_id": null, "id": 144418, "time": "2011-02-18T13:03:50Z", "creator": "apache@gagravarr.org", "creation_time": "2011-02-18T13:03:50Z", "is_private": false, "text": "In r1072093 I have added a test which shows we can size columns with very large (>32767) numbers of rows without error. So, looks like this bug is no longer present."}]