[{"count": 0, "tags": [], "creator": "lamchiomeng78@gmail.com", "is_private": false, "text": "Created attachment 34004\nThis file contains the codes of the two class I run that triggers the Rule M2.4 exception\n\nThe error message Rule M2.4 exception : this error should NEVER happen! is still being triggered despite many duplicate reports. This time it's on POI v3.14.\n\nKindly run the codes as per attached.", "id": 192100, "time": "2016-07-04T10:46:58Z", "bug_id": 59793, "creation_time": "2016-07-04T10:46:58Z", "attachment_id": 34004}, {"count": 1, "tags": [], "bug_id": 59793, "attachment_id": 34004, "id": 192102, "time": "2016-07-04T10:59:34Z", "creator": "lamchiomeng78@gmail.com", "creation_time": "2016-07-04T10:59:34Z", "is_private": false, "text": "Comment on attachment 34004\nThis file contains the codes of the two class I run that triggers the Rule M2.4 exception\n\nThe excel file was created, but it's corrupted and cannot be opened by Excel"}, {"count": 2, "tags": [], "bug_id": 59793, "attachment_id": null, "is_private": false, "id": 192103, "time": "2016-07-04T11:05:43Z", "creator": "kiwiwings@apache.org", "creation_time": "2016-07-04T11:05:43Z", "text": "Can you try to close your FileOutputStream?\n\nso instead of:\n  workbook.write(new FileOutputStream(\"c:\\\\Test Data\\\\write.xlsx\"));\n  workbook.close();\n\ndo:\n  FileOutputStream fos = new FileOutputStream(\"c:\\\\Test Data\\\\write.xlsx\")\n  workbook.write(fos);\n  fos.close();\n  workbook.close();\n\nOf course this assumes, that your initial write.xlsx is valid ...\n\nIf this doesn't work, please attach the write.xlsx (if this is the failing file ...)"}, {"count": 3, "tags": [], "text": "Hi Andreas,\n\nThank you so much for your prompt reply. I have tried your method as per the following: \n\nIt seems working now, except for the part in the If condition. I have replace the method you mentioned, and it's still giving me the RUle M2.4 exception. I suspect that it could be the closing of the FileOutputstream.\n\nI'll test on it first, and will write again if I face any issues or need your advice.\n\nThanks again for all your help !", "attachment_id": null, "id": 192106, "creator": "lamchiomeng78@gmail.com", "time": "2016-07-04T12:09:19Z", "bug_id": 59793, "creation_time": "2016-07-04T12:09:19Z", "is_private": false}, {"count": 4, "tags": [], "text": "As far as I see the code loads a file \"write.xlsx\", without this the code likely will not be very useful, or? Can you attach it as well and describe how it was biult (by which application, version, ...)\n\nAlso please try some more to provide a real reproducer that actually compiles, your code still contains references to \"login\", which is commented out so a developer who would like to take a look will first need to make the code compilable/runnable, which is bad. Ideally you remove as many lines of code as possible, to make the code as small as possible. Also commented out code confuses, so remove this as well if possible.", "attachment_id": null, "id": 192412, "creator": "dominik.stadler@gmx.at", "time": "2016-07-15T18:43:17Z", "bug_id": 59793, "creation_time": "2016-07-15T18:43:17Z", "is_private": false}, {"count": 5, "attachment_id": null, "bug_id": 59793, "is_private": false, "id": 192571, "time": "2016-07-22T12:49:33Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-07-22T12:49:33Z", "tags": [], "text": "Please reopen this bug if you can provide some more information here, currently there is not much we can do without the actual file that triggers this."}]