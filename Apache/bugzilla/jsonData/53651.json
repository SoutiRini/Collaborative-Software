[{"count": 0, "tags": [], "creator": "david.newcomb@bigsoft.co.uk", "attachment_id": null, "is_private": false, "id": 161090, "time": "2012-08-03T16:46:02Z", "bug_id": 53651, "creation_time": "2012-08-03T16:46:02Z", "text": "The documentation for failonstatus (http://httpd.apache.org/docs/2.4/mod/mod_proxy.html) states that the behaviour will be the same as other worker errors and this is not the case.\n===\n\nPlatform: Apache 2.4.2 on CentOS under VirtualBox\n\nApache mod_proxy & mod_proxy_balancer with 2 IIS boxes running a .net application. When application is not running but IIS is, then IIS (correctly) returns 500 error code responses for requests directed at the application.\n\nIf I switch off IIS so Apache can't connect mod_proxy_balancer (or something) puts the other machine into error state and automatically retries another worker.\nIf I switch IIS back on so that it starts returning 500 error statuses the failonstatus detects the failure and places the worker machine into error state however it throws that failure back up the call stack to the client so that the client gets proxy error from apache.\n\nThe documentation for failonstatus (http://httpd.apache.org/docs/2.4/mod/mod_proxy.html) states that the behaviour will be the same as other worker errors and this is not the case.\n\nMy config ( but it's pretty standard ...and it's a test environment! ):\n\nProxyRequests Off\n<Proxy *>\n        Order deny,allow\n        Allow from all\n</Proxy>\n\n<Proxy balancer://qtube>\n        # 500 Internel server error\n        # 501 Not implemented ( need to throw back to client )\n        # 502 Bad Gateway. The proxy server received an invalid response from an upstream server\n        # 503 Service unavailable\n\n        ProxySet lbmethod=byrequests failonstatus=500,502,503\n\n        BalancerMember http://10.165.250.201:80/mydir connectiontimeout=1 timeout=5 retry=30\n        BalancerMember http://10.165.250.206:80/mydir connectiontimeout=1 timeout=5 retry=30\n\n        Order deny,allow\n        Allow from all\n\n</Proxy>\n\n<Location /mydir>\n        ProxyPass balancer://qtube\n        ProxyPassReverse balancer://qtube\n        Order allow,deny\n        Allow from all\n</Location>\n\n<Location /balancer-manager>\n        SetHandler balancer-manager\n\n        Order deny,allow\n        Allow from all\n</Location>"}, {"count": 1, "tags": [], "creator": "david.newcomb@bigsoft.co.uk", "attachment_id": null, "text": "Thought I'd include as someone else has asked pretty much the same thing in the mailing list.  Daniel Ruggeri says not possible at the moment but he'd like to do it when he gets time!\n\nhttp://mail-archives.apache.org/mod_mbox/httpd-users/201206.mbox/%3C4FDFAA65.8090007@primary.net%3E\n\nIt would appear that is no way to do this so perhaps you could update the documentation to say that even though the worker goes into error state the request is not retried as it would have been for a connection error.\n\nThen can you make this a feature request.", "id": 161114, "time": "2012-08-06T13:58:30Z", "bug_id": 53651, "creation_time": "2012-08-06T13:58:30Z", "is_private": false}]