[{"count": 0, "tags": [], "bug_id": 56556, "attachment_id": null, "text": "It tooks 4-5 minutes for 3K columns.\n\npublic class Excel2007ColumnSize extends TestCase {\n\n    int TOTAL_COL = 3000;\n    short WDITH = 15 * 255;\n\n    public void testSetColumnSize() {\n        Workbook wb = new XSSFWorkbook();\n        Sheet st = wb.createSheet();\n        Row row = st.createRow(0);\n        System.out.println(\"1: \" + System.currentTimeMillis());\n        for (int i = 0; i < TOTAL_COL; i++) {\n            st.setColumnWidth(i, WDITH);\n        }\n        System.out.println(\"2: \" + System.currentTimeMillis());\n    }\n}", "id": 175412, "time": "2014-05-23T08:51:06Z", "creator": "xiao.xj@bigfoot.com", "creation_time": "2014-05-23T08:51:06Z", "is_private": false}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "Any chance you could use a profiler to work out where the time goes within that ColumnHelper method?", "id": 175415, "time": "2014-05-23T10:57:46Z", "bug_id": 56556, "creation_time": "2014-05-23T10:57:46Z", "is_private": false}, {"count": 2, "tags": [], "creator": "xiao.xj@bigfoot.com", "text": "Created attachment 31656\nprofiler run time\n\npoi_runtime.xml", "id": 175424, "time": "2014-05-23T16:32:26Z", "bug_id": 56556, "creation_time": "2014-05-23T16:32:26Z", "is_private": false, "attachment_id": 31656}, {"count": 3, "tags": [], "creator": "xiao.xj@bigfoot.com", "is_private": false, "id": 175425, "creation_time": "2014-05-23T16:34:07Z", "time": "2014-05-23T16:34:07Z", "bug_id": 56556, "text": "Comment on attachment 31656\nprofiler run time\n\nI am not performance expert, I tried to use netbeans profiler and got the report attached , most time is spend on \norg.apache.xmlbeans.impl.store.Locale.count(org.apache.xmlbeans.impl.store.Xobj, javax.xml.namespace.QName, org.apache.xmlbeans.QNameSet)\n\norg.apache.xmlbeans.impl.store.Xobj.find_element_user(javax.xml.namespace.QName, int)", "attachment_id": 31656}, {"count": 4, "tags": [], "bug_id": 56556, "attachment_id": 31657, "is_private": false, "id": 175426, "time": "2014-05-23T16:37:58Z", "creator": "xiao.xj@bigfoot.com", "creation_time": "2014-05-23T16:37:58Z", "text": "Created attachment 31657\ncall stack"}, {"count": 5, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 175636, "time": "2014-06-04T15:58:23Z", "bug_id": 56556, "creation_time": "2014-06-04T15:58:23Z", "is_private": false, "text": "I've made a change in r1600319, which I think should help. Any chance you could do a build from svn / get a nightly build after that, and see if it has made it better?"}, {"count": 6, "tags": [], "bug_id": 56556, "attachment_id": null, "is_private": false, "id": 175647, "time": "2014-06-05T03:44:25Z", "creator": "xiao.xj@bigfoot.com", "creation_time": "2014-06-05T03:44:25Z", "text": "Thanks a lot, it is much better now,the time drops to 2 seconds from 4-5 minutes using the same test case."}]