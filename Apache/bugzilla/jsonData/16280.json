[{"count": 0, "tags": [], "bug_id": 16280, "attachment_id": null, "is_private": false, "id": 29745, "time": "2003-01-21T00:16:09Z", "creator": "elmattador@hotmail.com", "creation_time": "2003-01-21T00:16:09Z", "text": "When close() is called on TelnetAppender a java.net.SocketException will always\nbe thrown in the run() method of inner class SocketHandler.  This forces the\nerror log: \"LogLog.error(\"Encountered error while in SocketHandler loop.\", e);\"\non line 166 to be executed, thus logging information that frightens my sysadmin.\n\nThe close() method needs to set the 'done' flag to true immediately, then send a\nfinal client socket connection to TelnetAppender to consume the last waiting\nserverSocket.accept(), before closing the serverSocket.  Ir just get rid of the\nlog statement."}, {"count": 1, "attachment_id": 4500, "bug_id": 16280, "is_private": false, "id": 29749, "time": "2003-01-21T01:13:59Z", "creator": "elmattador@hotmail.com", "creation_time": "2003-01-21T01:13:59Z", "tags": [], "text": "Created attachment 4500\nAll changes are inside of the finalize() method."}, {"count": 2, "tags": [], "text": "Can you please attached your patch in diff -u format, assuming it's still \napplicable and you still care?  Thanks.", "attachment_id": null, "id": 68370, "creator": "yoavs@computer.org", "time": "2004-12-13T17:05:37Z", "bug_id": 16280, "creation_time": "2004-12-13T17:05:37Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 16280, "attachment_id": null, "id": 41532, "time": "2005-03-22T09:43:03Z", "creator": "brownf@mail.co.stanislaus.ca.us", "creation_time": "2005-03-22T09:43:03Z", "is_private": false, "text": "(In reply to comment #2)\n> Can you please attached your patch in diff -u format, assuming it's still \n> applicable and you still care?  Thanks.\n\nMaybe I can help.  I downloaded revision 1.17 of TelnetAppender and compared it\nto Matt's revision (which was probably derived from a much earlier revision). \nApart from many minor and/or unrelated differences throughout, it came down to\nsome significant differences in send() and finalize().  Matt said his changes\nwere all in finalize(), so the changes in send() are probably due to some other\nrevision(s).\n\nWhat that leaves you with is...\n1. the following code to be inserted at the very beginning of finalize():\n\n      done = true; //break out of while loop as soon as last accept() is received.\n      try {\n\t//Sends final client socket to initiate close\n\tSocket lastSocket = new Socket(\"localhost\", getPort());\n\tlastSocket.close();\n      } catch(Exception exception){\n      }\n\n2. removing (or not) this single stmt at the end of finalize():\n     done = true;\n\n\nI know this isn't a diff file, but maybe it'll suffice :) "}, {"count": 4, "tags": [], "bug_id": 16280, "attachment_id": null, "id": 95721, "time": "2006-11-12T05:28:40Z", "creator": "kay.abendroth@raxion.net", "creation_time": "2006-11-12T05:28:40Z", "is_private": false, "text": "Matt, does this bug still appear in version 1.2.14?\nIf so, please update your patch file please and make it an unified diff.\n\nBug should be closed in the next weeks otherwise."}, {"count": 5, "attachment_id": null, "bug_id": 16280, "is_private": false, "id": 98621, "time": "2007-01-28T00:20:44Z", "creator": "genman@noderunner.net", "creation_time": "2007-01-28T00:20:44Z", "tags": [], "text": "\nIgnore the user's patch, it's rubbish.\n\nThe issue is that:\n\n        try {\n          Socket newClient = serverSocket.accept();\n...\n        } catch (Exception e) {\n          getLogger().error(\"Encountered error while in SocketHandler loop.\", e);\n        }\n\nwhen serverSocket.close() is called, an exception is thrown (naturally).  This\nexception should be ignored.\n\nThis is fixed in SVN trunk."}, {"count": 6, "tags": [], "text": "Committed by eross against log4j/trunk in rev 500753.\n\nNot sure that test is run by tests/build.xml.  Patch, after review, should be considered for backporting to \nlog4j 1.2.", "is_private": false, "bug_id": 16280, "id": 98795, "time": "2007-01-30T14:55:52Z", "creator": "carnold@apache.org", "creation_time": "2007-01-30T14:55:52Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 16280, "attachment_id": null, "id": 107041, "time": "2007-08-22T10:33:21Z", "creator": "carnold@apache.org", "creation_time": "2007-08-22T10:33:21Z", "is_private": false, "text": "Variation of Elias's patch committed against log4j 1.2 branch in rev 568709."}]