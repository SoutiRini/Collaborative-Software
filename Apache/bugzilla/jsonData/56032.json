[{"count": 0, "tags": [], "bug_id": 56032, "attachment_id": null, "is_private": false, "id": 172486, "time": "2014-01-19T10:56:23Z", "creator": "kenneth.gendron@gmail.com", "creation_time": "2014-01-19T10:56:23Z", "text": "When an interrupted thread uses the basic or asynchronous remote of a session to write, the underlying channel is closed (this is as expected); however, the onClose method of the associated endpoint is not called.  This can lead the server into believing the session is still active.  The only way I have gotten around it is to delegate the write methods to6 a thread that can't possibly be interrupted."}, {"count": 1, "tags": [], "creator": "markt@apache.org", "text": "Do you have some unit tests or some sample code to demonstrate the problem?", "id": 172569, "time": "2014-01-20T20:59:35Z", "bug_id": 56032, "creation_time": "2014-01-20T20:59:35Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 56032, "attachment_id": null, "is_private": false, "id": 172575, "time": "2014-01-20T21:49:50Z", "creator": "markt@apache.org", "creation_time": "2014-01-20T21:49:50Z", "text": "I've been looking at the WebSocket code and (by tweaking a unit tests an using a few break points) I can create a situation where the server times out trying to write a WebSocket message to the client. The behavior in this case should be the same as if the thread waiting for the write to complete was interrupted.\n\nI see the onError() call to the Endpoint but the connection is not closed. That does not seem right to me. Generally any call to onError() should be followed by the closure of the session unless we are sure that the situation is recoverable (and the nature of the protocol is that it almost certainly is not recoverable).\n\nThere are a few things I still want to check but I should be in a position to apply the fix for this tomorrow."}, {"count": 3, "attachment_id": null, "bug_id": 56032, "is_private": false, "id": 172602, "time": "2014-01-21T19:25:50Z", "creator": "kenneth.gendron@gmail.com", "creation_time": "2014-01-21T19:25:50Z", "tags": [], "text": "Thank you very much."}, {"count": 4, "tags": [], "creator": "markt@apache.org", "text": "This has been fixed in 8.0.x for 8.0.0 onwards and in 7.0.x for 7.0.51 onwards.", "id": 172603, "time": "2014-01-21T19:54:34Z", "bug_id": 56032, "creation_time": "2014-01-21T19:54:34Z", "is_private": false, "attachment_id": null}]