[{"count": 0, "tags": [], "bug_id": 59764, "attachment_id": 33992, "text": "Created attachment 33992\nSmall sample application demonstrating this bug\n\nI attached a small sample to demonstrate this bug.\n\nI have a tomcat servlet container with a connector defined to use UTF-8 as the default character encoding:\n\n<Connector port=\"8080\" protocol=\"HTTP/1.1\" connectionTimeout=\"120000\" redirectPort=\"8443\" URIEncoding=\"UTF-8\" compression=\"on\" compressableMimeType=\"text/html,text/xml,text/plain,text/javascript,text/css,text/json,application/json,application/javascript\" compressionMinSize=\"2048\"/>\n\nFor requests which contain both URL and form paramters, e.g.:\n\nRequest URL: http://localhost:8084/EncodingBug/EchoParamsServlet?getParam=All%20the%20way%20to%20San%20Jos%C3%A9!\nRequest Method:POST\nForm Data: postParam=All+the+way+to+San+Jos%C3%A9!\n\nPost parameters are not parsed using UTF-8 encoding even though this is specified in the request and in the server.xml, so non English characters become garbled. (e.g.: \"All the way to San Jos\u00e9!\" -> \"All the way to San Jos\u00c3\u00a9!\")", "id": 191975, "time": "2016-06-27T17:11:01Z", "creator": "tofarr@gmail.com", "creation_time": "2016-06-27T17:11:01Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 59764, "attachment_id": null, "text": "Hi,\n\nI have tested with tomcat 8.0.30 the attached war using these curl requests\n\ncurl -i -X POST -d postParam=All+the+way+to+San+Jos%C3%A9!  http://localhost:8080/EncodingBug/EchoParamsServlet?getParam=All%20the%20way%20to%20San%20Jos%C3%A9\n\nthe response is not correct\n\nHTTP/1.1 200 OK\nServer: Apache-Coyote/1.1\nContent-Type: text/plain;charset=UTF-8\nContent-Length: 74\nDate: Tue, 28 Jun 2016 08:09:36 GMT\n\ngetParam: All the way to San Jos\u00e9\npostParam: All the way to San Jos\u00c3\u00a9!\n\n\nSame request but with charset specified returns null instead of the invalid string\n\ncurl -i -X POST -H \"Content-Type: text/html; charset=UTF-8\" -d postParam=All+the+way+to+San+Jos%C3%A9!  http://localhost:8080/EncodingBug/EchoParamsServlet?getParam=All%20the%20way%20to%20San%20Jos%C3%A9\n\nHTTP/1.1 200 OK\nServer: Apache-Coyote/1.1\nContent-Type: text/plain;charset=UTF-8\nContent-Length: 51\nDate: Tue, 28 Jun 2016 08:16:17 GMT\n\ngetParam: All the way to San Jos\u00e9\npostParam: null", "id": 191990, "time": "2016-06-28T08:32:55Z", "creator": "vrablik@gmail.com", "creation_time": "2016-06-28T08:32:55Z", "is_private": false}, {"count": 2, "tags": [], "creator": "vrablik@gmail.com", "text": "\nMy env is\nubuntu linux with locales set this way:\n\nLC_PAPER=en_US.UTF-8\nLC_ADDRESS=cs_CZ.UTF-8\nLC_MONETARY=en_US.UTF-8\nLC_NUMERIC=en_US.UTF-8\nLC_TELEPHONE=cs_CZ.UTF-8\nLC_IDENTIFICATION=cs_CZ.UTF-8\nLANG=en_US.UTF-8\nLC_MEASUREMENT=en_US.UTF-8\nLC_TIME=en_US.UTF-8\nLC_NAME=cs_CZ.UTF-8", "id": 191991, "time": "2016-06-28T08:35:18Z", "bug_id": 59764, "creation_time": "2016-06-28T08:35:18Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "vrablik@gmail.com", "attachment_id": null, "id": 191993, "time": "2016-06-28T08:59:48Z", "bug_id": 59764, "creation_time": "2016-06-28T08:59:48Z", "is_private": false, "text": "I have tested with tomcat 7.0.70 and tomcat 9 M8\nthe results are same\n\nand I have uncommented setCharacterEncodingFilter  filter definition using 8.0.30 no luck"}, {"count": 4, "tags": [], "creator": "markt@apache.org", "text": "There is no bug here.\n\nPlease read this:\nhttp://wiki.apache.org/tomcat/FAQ/CharacterEncoding\n\nand if you still have questions please use the Tomcat users' mailing list.", "id": 191999, "time": "2016-06-28T11:17:21Z", "bug_id": 59764, "creation_time": "2016-06-28T11:17:21Z", "is_private": false, "attachment_id": null}]