[{"count": 0, "tags": [], "bug_id": 36345, "attachment_id": null, "text": "Hi,\n\nI am getting File error: Data may have been lost while opening an excel file. \nMy java code gets the file from db, which is put in by another application in \nVB. The VB team keeps on adding lots of formulae to the sheet, when webapp \nreads, the POI doesn't understand all of them and throws above error. \n\nEven though I debug with eclipse, I am unable to figure out which record teh \nPOI doesn't understand. The data is chunks of byte arrays and all numbers in \nhex. I tried using biffViwer, it generated lots of unknown records, how do I \nread these numbers to figure out which record is corrupt. How do i read \nrecordid below ? How do I know which records or values are bad for POI ?? \n\n-----UNKNOWN----------------------------------\nOffset 0xa8 (168)\nrecordid = 0x13d, size = 28\n[TABID]\n    .elements        = 14\n    .element_0       = 41\n    .element_1       = 39\n    .element_2       = 176\n    .element_3       = 37\n    .element_4       = 223\n    .element_5       = 10\n    .element_6       = 217\n    .element_7       = 145\n    .element_8       = 215\n    .element_9       = 216\n    .element_10       = 224\n    .element_11       = 221\n    .element_12       = 222\n    .element_13       = 218\n[/TABID]\n\n-----UNKNOWN----------------------------------\n\nThanks for your time,\nSujatha.", "id": 78946, "time": "2005-08-24T22:07:12Z", "creator": "sujatha_pasam@yahoo.com", "creation_time": "2005-08-24T22:07:12Z", "is_private": false}, {"count": 1, "tags": [], "creator": "jheight@apache.org", "attachment_id": null, "id": 78953, "time": "2005-08-25T00:18:25Z", "bug_id": 36345, "creation_time": "2005-08-25T00:18:25Z", "is_private": false, "text": "Sujatha,\n\nCan you please download the latest code from CVS, there are a number of changes\nto how the records are read and on the whole it seems like it has fixed a number\nof corruption issues as well.\n\nIf that code still reports an error, please attach a sample spreadsheet to this\nbug that cant be read by HSSF.\n\nJason"}, {"count": 2, "tags": [], "text": "Hi Jason,\n\nThanks for the reply. The excel file was re-written by VB team by reviewing all \nthe macros and formulae. The POI is now able to read this file. So the problem \nis solved for now ... but may occur again, in which case I will send you the \nfile. \n\nTx, \nSujatha\n\n\n(In reply to comment #0)\n> Hi,\n> I am getting File error: Data may have been lost while opening an excel file. \n> My java code gets the file from db, which is put in by another application in \n> VB. The VB team keeps on adding lots of formulae to the sheet, when webapp \n> reads, the POI doesn't understand all of them and throws above error. \n> Even though I debug with eclipse, I am unable to figure out which record teh \n> POI doesn't understand. The data is chunks of byte arrays and all numbers in \n> hex. I tried using biffViwer, it generated lots of unknown records, how do I \n> read these numbers to figure out which record is corrupt. How do i read \n> recordid below ? How do I know which records or values are bad for POI ?? \n> -----UNKNOWN----------------------------------\n> Offset 0xa8 (168)\n> recordid = 0x13d, size = 28\n> [TABID]\n>     .elements        = 14\n>     .element_0       = 41\n>     .element_1       = 39\n>     .element_2       = 176\n>     .element_3       = 37\n>     .element_4       = 223\n>     .element_5       = 10\n>     .element_6       = 217\n>     .element_7       = 145\n>     .element_8       = 215\n>     .element_9       = 216\n>     .element_10       = 224\n>     .element_11       = 221\n>     .element_12       = 222\n>     .element_13       = 218\n> [/TABID]\n> -----UNKNOWN----------------------------------\n> Thanks for your time,\n> Sujatha.\n\n", "attachment_id": null, "bug_id": 36345, "id": 79746, "time": "2005-09-09T22:53:23Z", "creator": "sujatha_pasam@yahoo.com", "creation_time": "2005-09-09T22:53:23Z", "is_private": false}, {"count": 3, "tags": [], "creator": "jheight@apache.org", "text": "As indicated CVS/SVN has fixed the issue. Still working hard to fix all\nocorruption issues.\n\nJason", "id": 84146, "time": "2006-01-03T08:36:42Z", "bug_id": 36345, "creation_time": "2006-01-03T08:36:42Z", "is_private": false, "attachment_id": null}]