[{"count": 0, "tags": [], "bug_id": 44844, "text": "Using poi-3.0.2-FINAL-20080204\n\nfull stack trace:\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n        at org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:199)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:117)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:207)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:148)\n        at com.centrivision.ifc.util.ExcelSheetParser.parseWorkshopExcelSheet(ExcelSheetParser.java:86)\n        at com.centrivision.ifc.webapp.action.XLSUploadController.onSubmit(XLSUploadController.java:88)\n        at org.springframework.web.servlet.mvc.SimpleFormController.processFormSubmission(SimpleFormController.java:258)\n        at com.centrivision.ifc.webapp.action.BaseFormController.processFormSubmission(BaseFormController.java:138)\n        at com.centrivision.ifc.webapp.action.XLSUploadController.processFormSubmission(XLSUploadController.java:52)\n        at org.springframework.web.servlet.mvc.AbstractFormController.handleRequestInternal(AbstractFormController.java:259)\n        at org.springframework.web.servlet.mvc.AbstractController.handleRequest(AbstractController.java:139)\n        at org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter.handle(SimpleControllerHandlerAdapter.java:44)\n        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:717)\n        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:658)\n        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:392)\n        at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:357)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:709)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:237)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:157)\n        at com.opensymphony.module.sitemesh.filter.PageFilter.parsePage(PageFilter.java:118)\n        at com.opensymphony.module.sitemesh.filter.PageFilter.doFilter(PageFilter.java:52)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:186)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:157)\n        at org.tuckey.web.filters.urlrewrite.UrlRewriteFilter.doFilter(UrlRewriteFilter.java:738)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:186)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:157)\n        at com.centrivision.ifc.webapp.filter.GZIPFilter.doFilterInternal(GZIPFilter.java:42)\n        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:186)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:157)\n        at org.displaytag.filter.ResponseOverrideFilter.doFilter(ResponseOverrideFilter.java:125)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:186)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:157)\n        at com.opensymphony.clickstream.ClickstreamFilter.doFilter(ClickstreamFilter.java:42)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:186)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:157)\n        at org.springframework.orm.hibernate3.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:174)\n        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:186)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:157)\n        at org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:292)\n        at org.acegisecurity.intercept.web.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:108)\n        at org.acegisecurity.intercept.web.SecurityEnforcementFilter.doFilter(SecurityEnforcementFilter.java:197)\n        at org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:303)\n        at org.acegisecurity.providers.anonymous.AnonymousProcessingFilter.doFilter(AnonymousProcessingFilter.java:143)\n        at org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:303)\n        at org.acegisecurity.ui.rememberme.RememberMeProcessingFilter.doFilter(RememberMeProcessingFilter.java:154)\n        at org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:303)\n        at org.acegisecurity.wrapper.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:50)\n        at org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:303)\n        at org.acegisecurity.ui.AbstractProcessingFilter.doFilter(AbstractProcessingFilter.java:246)\n        at org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:303)\n        at org.acegisecurity.context.HttpSessionContextIntegrationFilter.doFilter(HttpSessionContextIntegrationFilter.java:220)\n        at org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:303)\n        at org.acegisecurity.util.FilterChainProxy.doFilter(FilterChainProxy.java:173)\n        at org.acegisecurity.util.FilterToBeanProxy.doFilter(FilterToBeanProxy.java:120)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:186)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:157)\n        at com.centrivision.ifc.webapp.filter.LocaleFilter.doFilterInternal(LocaleFilter.java:49)\n        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:186)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:157)\n        at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:75)\n        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:186)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:157)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:214)\n        at org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:104)\n        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)\n        at org.apache.catalina.core.StandardContextValve.invokeInternal(StandardContextValve.java:198)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:152)\n        at org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:104)\n        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:137)\n        at org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:104)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:118)\n        at org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:102)\n        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n        at org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:104)\n        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:929)\n        at org.apache.coyote.tomcat5.CoyoteAdapter.service(CoyoteAdapter.java:160)\n        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:799)\n        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:705)\n        at org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:577)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:683)\n        at java.lang.Thread.run(Thread.java:619)\nCaused by: java.lang.reflect.InvocationTargetException\n        at sun.reflect.GeneratedConstructorAccessor172.newInstance(Unknown Source)\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:513)\n        at org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:187)\n        ... 88 more\nCaused by: org.apache.poi.hssf.record.RecordFormatException: Error reading bytes\n        at org.apache.poi.hssf.record.RecordInputStream.nextRecord(RecordInputStream.java:115)\n        at org.apache.poi.hssf.record.ObjRecord.fillFields(ObjRecord.java:85)\n        at org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n        at org.apache.poi.hssf.record.ObjRecord.<init>(ObjRecord.java:60)\n        ... 92 more\nCaused by: org.apache.poi.util.LittleEndian$BufferUnderrunException: buffer underrun\n        at org.apache.poi.util.LittleEndian.readFromStream(LittleEndian.java:472)\n        at org.apache.poi.util.LittleEndian.readShort(LittleEndian.java:404)\n        at org.apache.poi.hssf.record.RecordInputStream.nextRecord(RecordInputStream.java:113)\n        ... 95 more", "id": 115729, "time": "2008-04-21T03:36:12Z", "creator": "ahamza@centrivision.com", "creation_time": "2008-04-21T03:36:12Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 44844, "attachment_id": null, "text": "If you could find a copy of the offending file and attach it, that would make this bug much easier to fix.\n\nJust from reading the code, it looks like the sub-record stream had exactly one byte left when it needed two.  There is some suggestion in the comments that a 'continue' record may occur, and that POI does not support this yet, but it is really hard to tell what's going on without an example XLS file.", "id": 115749, "time": "2008-04-21T10:26:07Z", "creator": "josh@apache.org", "creation_time": "2008-04-21T10:26:07Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 44844, "attachment_id": 21843, "id": 115763, "time": "2008-04-22T02:32:53Z", "creator": "ahamza@centrivision.com", "creation_time": "2008-04-22T02:32:53Z", "is_private": false, "text": "Created attachment 21843\nSample XLS file\n\nthats the XLS file template which couses the exception. its not the exact file, its just a template."}, {"count": 3, "tags": [], "text": "Please find attached the XLS file template the couses the problem.\nThere's something i noticed. the error occurs when the XLS file is in the average of maybe 1.5 MB of size. i think its a buffering issue.\nhope that might help", "attachment_id": null, "bug_id": 44844, "id": 115764, "time": "2008-04-22T02:36:02Z", "creator": "ahamza@centrivision.com", "creation_time": "2008-04-22T02:36:02Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 44844, "attachment_id": null, "id": 115775, "time": "2008-04-22T11:18:21Z", "creator": "josh@apache.org", "creation_time": "2008-04-22T11:18:21Z", "is_private": false, "text": "(In reply to comment #3)\n> Please find attached the XLS file template the causes the problem.\n> There's something i noticed. the error occurs when the XLS file is in the\n> average of maybe 1.5 MB of size. i think its a buffering issue.\n> hope that might help\n> \n\nI'm sorry, but it's not apparent how this 'template' is supposed to be used to create an offending file.  It looks like some sort of manual data entry tool, and 1.5 MB would be a lot of data to enter :(.  Another issue is that there seems to be a bug in VBA code (Module1::fillParticipantsList() - the variable 'Flag' is undefined). The password protection (FYI in the clear at offset 16DDE etc) doesn't help either.\n\nCould you just upload any example created by the template that reproduces the bug? \n\n"}, {"count": 5, "tags": [], "bug_id": 44844, "attachment_id": null, "id": 128440, "time": "2009-06-30T06:40:48Z", "creator": "joern@muehlencord.de", "creation_time": "2009-06-30T06:40:48Z", "is_private": false, "text": "Works for me with POI 3.2"}, {"attachment_id": null, "tags": [], "bug_id": 44844, "is_private": false, "count": 6, "id": 128915, "time": "2009-07-16T09:10:02Z", "creator": "joern@muehlencord.de", "creation_time": "2009-07-16T09:10:02Z", "text": "Works for me with POI 3.2"}]