[{"count": 0, "text": "Created attachment 32100\nMS Excel 2007 created .xls file\n\nI have created an .xls file using Microsoft Excel 2007. The file contains a cell with:\n\nBackground color: RGB(215, 228, 188)\nFont color: RGB(0, 128, 128)\n\nas can be seen in the Custom Colors dialog in the Excel. I tried to read the background and foreground colors as shown below:\n\npublic class ColorTest2007 {\n\t\n\tpublic static void main(String arg[]) throws Exception\n\t{\n\t\tFile f = new File(\"david2.xls\");\n\t\tFileInputStream fis = new FileInputStream(f);\n\t\tHSSFWorkbook workbook = new HSSFWorkbook(fis);\n\t\t\n\t\tHSSFSheet sheet = workbook.getSheet(\"Sheet1\");\n\t\tHSSFRow row = sheet.getRow(0);\n\t\tHSSFCell cell = row.getCell(0);\n\t\t\n\t\tHSSFColor bgColor = cell.getCellStyle().getFillBackgroundColorColor();\n\t\tSystem.out.println(bgColor.getTriplet()[0]+\", \"+bgColor.getTriplet()[1]+\", \"+bgColor.getTriplet()[2]);\n\n\t\tHSSFColor fontColor = cell.getCellStyle().getFillForegroundColorColor();\n\t\tSystem.out.println(fontColor.getTriplet()[0]+\", \"+fontColor.getTriplet()[1]+\", \"+fontColor.getTriplet()[2]);\n\t}\n}\n\nwhich resulted in:\n\n0, 0, 0\n247, 244, 239\n\nI have also tried to use the cell.getCellStyle().getFillBackgroundColor() and tried to retrieve the color from the custom color palette. But that also did not return the colors seen in Excel.\n\nI am attaching the david2.xls file. This definitely looks like a bug unless the reading of the color from xls file created using MS Excel 2007 is unsupported. Please let me know if there is any other way to retrieve the correct color values.", "bug_id": 57074, "is_private": false, "id": 178375, "time": "2014-10-09T23:48:40Z", "creator": "chandran.poorna@gmail.com", "creation_time": "2014-10-09T23:48:40Z", "tags": [], "attachment_id": 32100}, {"count": 1, "tags": [], "bug_id": 57074, "attachment_id": null, "text": "3.9 is a little old, can you re-try with 3.11 beta 2?", "id": 178376, "time": "2014-10-10T09:40:16Z", "creator": "apache@gagravarr.org", "creation_time": "2014-10-10T09:40:16Z", "is_private": false}, {"count": 2, "text": "I get the same result with 3.11-beta2 as well. \n\noutput for the given code:\n\n0, 0, 0\n247, 244, 239", "bug_id": 57074, "is_private": false, "id": 178381, "time": "2014-10-10T16:10:18Z", "creator": "chandran.poorna@gmail.com", "creation_time": "2014-10-10T16:10:18Z", "tags": [], "attachment_id": null}, {"count": 3, "tags": [], "creator": "dominik.stadler@gmx.at", "text": "When I open the file in LibreOffice and actually type into the cell, it is actually using gray text on background, which is what POI is returning, e.g. background 0, 0, 0 and foreground some high values in all three, are you sure the file is set up with correct color for this cell?", "id": 179043, "time": "2014-11-10T21:32:38Z", "bug_id": 57074, "creation_time": "2014-11-10T21:32:38Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "chandran.poorna@gmail.com", "text": "Yes, I have just checked it with LibreOffice. The foreground and background colors are different with MS Excel 2007 with the same document. \n\nI don't see this issue with document created with MS Excel 2003. Only when I create a .xls file with MS Excel 2007. XLS file created with MS Excel 2007 is by default in compatibility mode and that's when the problem is.\n\nI will attach a screenshot of the attached document opened with MS Excel 2007.\n\nTo summarize, the colors are different when the attached document is opened with Apache OpenOffice or LibreOffice from MS Excel 2007.", "id": 179171, "time": "2014-11-18T15:26:44Z", "bug_id": 57074, "creation_time": "2014-11-18T15:26:44Z", "is_private": false, "attachment_id": null}, {"count": 5, "attachment_id": 32212, "bug_id": 57074, "is_private": false, "id": 179172, "time": "2014-11-18T15:27:26Z", "creator": "chandran.poorna@gmail.com", "creation_time": "2014-11-18T15:27:26Z", "tags": [], "text": "Created attachment 32212\nopened with MS Excel 2007"}, {"count": 6, "tags": [], "bug_id": 57074, "attachment_id": 32352, "id": 180209, "time": "2015-01-07T14:10:24Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-01-07T14:10:24Z", "is_private": false, "text": "Created attachment 32352\nScreenshot of the Excel output when saving the fail in 1997-2003 format\n\nFYI, when I try to save the Excel file as \"1997-2003\" I get the compatibility warning as shown in the screenshot. I suppose this is related to what we see here, seems POI does not yet read those newer colors/styles (and LibreOffice has similar limitations)."}, {"count": 7, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "id": 180210, "time": "2015-01-07T14:16:33Z", "bug_id": 57074, "creation_time": "2015-01-07T14:16:33Z", "is_private": false, "text": "There is now a reproducing unit test for this in class TestUnfixedBugs."}]