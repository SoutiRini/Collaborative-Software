[{"count": 0, "tags": [], "text": "This is a follow-up to 45602 (Add Java API for MS Publisher .pub files).\n\nBasically, we need to be able to stream text data out of pub files and have enough API hooks to control its chunking.\n\nRight now, HPBFDocument doesn't support the NIO version of the POI file system which makes it load the whole document into memory.\n\nText extraction is done from the QuillContents object (probably needs to examine the other parts like Main, Escher etc - subject of another ticket). QuillContents currently reads the whole document input stream into a single byte buffer, then makes sense of it and splits it into bits, then picks out the text and hyperlink bits.\n\nFor streaming, we'd want a way to not load everything at once but:\na. emit bits as they're encountered\nb. make their contents streamable/chunkable, since a single bit may contain a lot of text data\n\nI've attempted to implement this but came across exceptions in NDocumentInputStream - subject of another ticket.\n\nAdditionally, this functionality would ideally cover Publisher 2010 files which I don't believe it does - subject of another ticket.", "attachment_id": null, "bug_id": 51317, "id": 146836, "time": "2011-06-03T17:33:27Z", "creator": "dgoldenberg@attivio.com", "creation_time": "2011-06-03T17:33:27Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 51317, "is_private": false, "count": 1, "id": 181963, "time": "2015-03-22T19:27:18Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-03-22T19:27:18Z", "text": "There is basic text extracting provided via PublisherTextExtractor, more support like chunking, streaming, ... is likely not being added unless someone can provide patches that add this."}]