[{"count": 0, "tags": [], "bug_id": 54318, "text": "I used POI (HSSF) for many years to export tables to excel. Since the update to POI 3.8, I have a bug by formatting the cells of the table in Excel.\n\nEnvironment:\nWindows XP; Excel 2002, SP3; \n\nThe problem:\nWhen I create a table, open it in Excel und click at the thousand separator, the cell gets a \u2018$\u2019-Character in front of the number (formatted as currency). \nNext, when I click on the button currency, Excel format the cell with the thousands separator. \nI get this problem with the SXSSF-libraries as well as with the HSSF-libraries.\n\nReason:\nThe order of the predefined formats in the class BuiltinFormats (package: org.apache.poi.ss.usermodel) has changed.\n\n3.8 (wrong)\nputFormat(m, 0x29, \"_(\\\"$\\\"* #,##0_);_(\\\"$\\\"* (#,##0);_(\\\"$\\\"* \\\"-\\\"_);_(@_)\");\nputFormat(m, 0x2a, \"_(* #,##0_);_(* (#,##0);_(* \\\"-\\\"_);_(@_)\");\nputFormat(m, 0x2b, \"_(\\\"$\\\"* #,##0.00_);_(\\\"$\\\"* (#,##0.00);_(\\\"$\\\"* \\\"-\\\"??_);_(@_)\");\nputFormat(m, 0x2c, \"_(* #,##0.00_);_(* (#,##0.00);_(* \\\"-\\\"??_);_(@_)\");\n\t\t\n3.7 (right)\nputFormat(m, 0x29, \"_(*#,##0_);_(*(#,##0);_(* \\\"-\\\"_);_(@_)\");\nputFormat(m, 0x2a, \"_($*#,##0_);_($*(#,##0);_($* \\\"-\\\"_);_(@_)\");\nputFormat(m, 0x2b, \"_(*#,##0.00_);_(*(#,##0.00);_(*\\\"-\\\"??_);_(@_)\");\nputFormat(m, 0x2c, \"_($*#,##0.00_);_($*(#,##0.00);_($*\\\"-\\\"??_);_(@_)\");", "id": 164128, "time": "2012-12-17T10:36:30Z", "creator": "mathias@sroke.de", "creation_time": "2012-12-17T10:36:30Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 54318, "attachment_id": null, "text": "http://support.microsoft.com/kb/147942 claims to be the canonical, corrected list of the built in formats. \n\nIt does look like BuiltinFormats doesn't match the corrected list, so probably it needs changing. (My hunch is someone updated based on the list somewhere that featured the mistake mentioned in the kb article)", "id": 167817, "time": "2013-06-14T12:50:14Z", "creator": "apache@gagravarr.org", "creation_time": "2013-06-14T12:50:14Z", "is_private": false}, {"count": 2, "tags": [], "text": "*** Bug 55730 has been marked as a duplicate of this bug. ***", "attachment_id": null, "id": 174804, "creator": "seebass@gmx.ch", "time": "2014-04-23T13:29:43Z", "bug_id": 54318, "creation_time": "2014-04-23T13:29:43Z", "is_private": false}]