[{"count": 0, "tags": [], "bug_id": 5560, "text": "Hi. I don't know if this kind of stuff should be done in here, but here it is.\n\nWe use tomcat to serve our portal, and lots of unnecesary white space are \nserved to the browser (line feeds, tabs, spaces), which increases size of pages \nand thus makes site slow on modems.\n\nI modified org.apache.jasper.compiler.CharDataMapper.generateChunk (and \nMappedCharDataMapper.generateChunk) to remove them at Jasper compilation time. \nThe new method looks like:\n\n\n\tprivate void generateChunk(ServletWriter writer, int from, int to)\n\t{\n\t\t// Generate the char data:\n\t\tint limit;\n\t\tint lastChar;\n\t\tStringBuffer sb;\n\t\t\n\t\tsb = new StringBuffer();\n\t\tlimit = chars.length;\n\t\tlastChar = 0;\n\t\tfor (int i = 0; i < limit; i++)\n\t\t{\n\t\t\tint ch = chars[i];\n\t\t\tswitch (ch)\n\t\t\t{\n\t\t\t\tcase '\"' :\n\t\t\t\t\tsb.append(\"\\\\\\\"\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase '\\\\' :\n\t\t\t\t\tsb.append(\"\\\\\\\\\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase '\\r' :\n\t\t\t\t\tch = '\\n';\n\t\t\t\tcase '\\n' :\n\t\t\t\t\tif ( '\\n' != lastChar )\n\t\t\t\t\t{\n\t\t\t\t\t\tsb.append(\"\\\\r\\\\n\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase ' ' :\n\t\t\t\t\tif ( ! isBlank(lastChar) )\n\t\t\t\t\t{\n\t\t\t\t\t\tsb.append(\" \");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase '\\t' :\n\t\t\t\t\tif ( ! isBlank(lastChar) )\n\t\t\t\t\t{\n\t\t\t\t\t\tsb.append(\"\\\\t\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\tdefault :\n\t\t\t\t\tsb.append((char) ch);\n\t\t\t}\n\t\t\t\n\t\t\tlastChar = ch;\n\t\t}\n\n\t\tif ( 0 < sb.length() )\n\t\t{\n\t\t\twriter.indent();\n\t\t\twriter.print(\"out.write(\\\"\");\n\t\t\twriter.print(sb.toString());\n\t\t\twriter.print(\"\\\");\\n\");\n\t\t}\n\t}\n\n\tprotected static boolean isBlank(int ch)\n\t{\n\t\treturn (' ' == ch) || ('\\t' == ch) || ('\\n' == ch);\n\t}\n\n\nThis reduces our page sizes by 3-4K\n\nJust to let you know\n\nThks", "id": 9131, "time": "2001-12-21T10:49:49Z", "creator": "cesarbv@hotmail.com", "creation_time": "2001-12-21T10:49:49Z", "is_private": false, "attachment_id": null}, {"count": 1, "attachment_id": null, "bug_id": 5560, "is_private": false, "id": 9824, "time": "2002-01-23T22:46:17Z", "creator": "Larry.Isaacs@sas.com", "creation_time": "2002-01-23T22:46:17Z", "tags": [], "text": "Both of the JSP 1.1 and JSP 1.2 spec specify that the white space is\npreserved.  Since Tomcat 3.x is a reference implementation of the JSP 1.1\nspec, it is not allowed to remove the whitespace.  You are welcome to\ncustomize your version to do this, though."}]