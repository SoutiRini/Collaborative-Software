[{"count": 0, "tags": [], "bug_id": 52285, "attachment_id": 28026, "is_private": false, "id": 151976, "time": "2011-12-05T12:48:05Z", "creator": "fabian.lange@codecentric.de", "creation_time": "2011-12-05T12:48:05Z", "text": "Created attachment 28026\npatch tar.gz and xml file\n\nWord sometimes adds smart tags to text entered by the user.\n\nThey might be simle, like this:\n\t\t\t<w:smartTag w:uri=\"urn:schemas-microsoft-com:office:smarttags\"\n\t\t\t\tw:element=\"country-region\">\n\t\t\t\t<w:r>\n\t\t\t\t\t<w:rPr>\n\t\t\t\t\t\t<w:lang w:val=\"en-US\" />\n\t\t\t\t\t</w:rPr>\n\t\t\t\t\t<w:t>India</w:t>\n\t\t\t\t</w:r>\n\t\t\t</w:smartTag>\n\nor even nested:\n\n\t\t\t<w:smartTag w:uri=\"urn:schemas-microsoft-com:office:smarttags\"\n\t\t\t\tw:element=\"PersonName\">\n\t\t\t\t<w:smartTag w:uri=\"urn:schemas:contacts\" w:element=\"GivenName\">\n\t\t\t\t\t<w:r>\n\t\t\t\t\t\t<w:rPr>\n\t\t\t\t\t\t\t<w:lang w:val=\"en-US\" />\n\t\t\t\t\t\t</w:rPr>\n\t\t\t\t\t\t<w:t>Marilyn</w:t>\n\t\t\t\t\t</w:r>\n\t\t\t\t</w:smartTag>\n\t\t\t\t<w:r>\n\t\t\t\t\t<w:rPr>\n\t\t\t\t\t\t<w:lang w:val=\"en-US\" />\n\t\t\t\t\t</w:rPr>\n\t\t\t\t\t<w:t xml:space=\"preserve\"> </w:t>\n\t\t\t\t</w:r>\n\t\t\t\t<w:smartTag w:uri=\"urn:schemas:contacts\" w:element=\"Sn\">\n\t\t\t\t\t<w:r>\n\t\t\t\t\t\t<w:rPr>\n\t\t\t\t\t\t\t<w:lang w:val=\"en-US\" />\n\t\t\t\t\t\t</w:rPr>\n\t\t\t\t\t\t<w:t>Monroe</w:t>\n\t\t\t\t\t</w:r>\n\t\t\t\t</w:smartTag>\n\t\t\t</w:smartTag>\n\nThe previous implementation for a paragraph simply ignores instances of CTSmartTagRun.\nMy proposed patch introduces recusrive parsing for CTSmartTagRun. \nI did consider making all tags recursive, but this failed other tests. I think this might be an option for further improvement.\n\nThis makes test cases checking for smart tags pass and fixes two issues in Tika.\n\nMy implementation does discard the information from the smart tag.\n\nPatch also contains minor cleanup of the mixed tab/spacing in this class, and removed a duplicate document!= null check."}, {"count": 1, "tags": [], "bug_id": 52285, "attachment_id": null, "is_private": false, "id": 151995, "time": "2011-12-06T04:31:57Z", "creator": "apache@gagravarr.org", "creation_time": "2011-12-06T04:31:57Z", "text": "Thanks for this, applied (with a few little tweaks) in r1210774.\n\n(For future reference, it might be better to avoid trying to reformat the rest of the code, as it makes the reviewing a bit harder. We should really standardise, but not always in a feature patch!)"}]