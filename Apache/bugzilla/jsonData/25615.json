[{"count": 0, "tags": [], "creator": "juergen.link1@gmx.de", "is_private": false, "id": 49308, "creation_time": "2003-12-18T08:43:17Z", "time": "2003-12-18T08:43:17Z", "bug_id": 25615, "text": "We use a custom Realm (MyRealm) with a custom Principal Class MyPrincipal.\nMyPrincipal extends org.apache.catalina.realm.GenericPrincipal and additionally\nimplements a custom Interface MyId.\nThus, we placed myJar.jar (the jar containing both classes) in the server/lib \ndirectory.\nThe authentication works, the WebApp call to request.getUserPrincipal() returns \nan object that is of class MyPrincipal (confirmed via \nmyPrincipalInstance.getClass() ).\nWe then try to cast myPrincipalInstance to the Interface MyId which causes\na class cast exception.\nExploring the error reveals that the WebApp class loader could not load the \nclass org.apache.catalina.realm.GenericPrincipal .\nWe tried the following workarounds:\n1. Modify the class MyPrincipal not to extend \norg.apache.catalina.realm.GenericPrincipal, but implement the two interfaces \njava.security.Principal und MyId -> this causes a complete failure of Tomcat's \nauthentication.\n2. Place the jar myJar.jar in the common/lib dir -> Tomcat isn't able to load \nthe class MyRealm on startup.\n\nI assume custom Principal are supposed to work in Tomcat.\nAm I doing wrong?", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 25615, "attachment_id": null, "id": 49318, "time": "2003-12-18T12:07:20Z", "creator": "funkman@joedog.org", "creation_time": "2003-12-18T12:07:20Z", "is_private": false, "text": "Please follow up with tomcat-user for more detail if needed\n\nGenericPrincipal lives in the server's classloader. Webapps do not have access\nto any of the classes in the server classloader. To allow access, you can add\nthe attribute privileged=\"true\" to your Context declaration - but this does open\nsecurity holes since it allows the webapp to access catalina internals.\n"}, {"count": 2, "tags": [], "creator": "juergen.link1@gmx.de", "attachment_id": null, "text": "Well, as I understand I'm encouraged to implement the interface Principal in a \ncustom class. Is Tomcat allowing me to do so? I mean - does Tomcat rely on \nGenericPrincipal?", "id": 49320, "time": "2003-12-18T12:33:33Z", "bug_id": 25615, "creation_time": "2003-12-18T12:33:33Z", "is_private": false}]