[{"count": 0, "tags": [], "creator": "yokoi@bbreak.co.jp", "attachment_id": null, "is_private": false, "id": 126425, "time": "2009-04-21T23:24:09Z", "bug_id": 47071, "creation_time": "2009-04-21T23:24:09Z", "text": "This is with 3.5 beta 5.\n\nin org.apache.poi.ss.usermodel.DateUtil.isADateFormat()\n\nThe following regular expression is used for the judgment whether CellStyle.getDataFormatString() is a Date format or not. \n fs.matches(\"^[yYmMdDhHsS\\\\-/,. :]+[ampAMP/]*$\") // line 239\n\nHowever, For instance, the following marks are generally prepared as a built-in format in the Japanese version Excel, which are NOT recognized as Date format.  \n\u3000yyyy\"\u5e74\"m\"\u6708\";@\n\u3000m\"\u6708\"d\"\u65e5\";@\n\nI think that you should check it by the regular expression after removing the part enclosed with \"\" so that localized format can be recognized as Date format.\n\nlike this\n-------------\n    // And '\"any\"' into ''\n    while( fs.contains(\"\\\"\")){\n        int beginIdx = fs.indexOf(\"\\\"\");\n        if( beginIdx == -1){\n            break;\n        }\n        int endIdx = fs.indexOf( \"\\\"\", beginIdx + 1);\n        if( endIdx == -1){\n            break;\n        }\n        fs = fs.replaceFirst( fs.substring( beginIdx, endIdx + 1),\"\");\n    }"}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "is_private": false, "id": 126428, "time": "2009-04-22T03:04:44Z", "bug_id": 47071, "creation_time": "2009-04-22T03:04:44Z", "text": "Any chance you could upload a sample file with one of the problem formatting rules, and a failing unit test?"}, {"attachment_id": 23527, "tags": [], "bug_id": 47071, "is_private": false, "count": 2, "id": 126429, "time": "2009-04-22T03:35:17Z", "creator": "yokoi@bbreak.co.jp", "creation_time": "2009-04-22T03:35:17Z", "text": "Created attachment 23527\nThe format of A-1 and A-2 cells is Japanese Date format.\n\nThe format of A-1 and A-2 cells is Japanese Date format."}]