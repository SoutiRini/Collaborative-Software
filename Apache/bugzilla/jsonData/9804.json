[{"count": 0, "tags": [], "creator": "nicolas.socheleau@bitflash.com", "is_private": false, "id": 17653, "attachment_id": null, "bug_id": 9804, "creation_time": "2002-06-12T12:22:37Z", "time": "2002-06-12T12:22:37Z", "text": "When the XMLScanner is used with an imcomplete CDATA_SECTION ( example : \"<!\n[CDATA[ hello \" ), then it enters an infinite loop. The end of file is not \nproperly detected in 'nextInCDATASection' where the loop is waiting for the \nfirst closing tag ']'\n\nHere is the location :\n\norg.apache.batik.xml.XMLScanner : line 915\n\n    /**\n     * Returns the next lexical unit in the context of a CDATA section.\n     */\n    protected int nextInCDATASection() throws IOException, XMLException {\n\tif (cdataEndRead) {\n\t    cdataEndRead = false;\n\t    context = CONTENT_CONTEXT;\n\t    return LexicalUnits.SECTION_END;\n\t}\n\t\n\twhile (current != -1) {\n>\t    while (current != ']') {\n>\t\tnextChar();\n>\t    }\n\t    if (current != -1) {\n\t\tnextChar();\n\t\tif (current == ']') {\n\t\t    nextChar();\n\t\t    if (current == '>') {\n\t\t\tbreak;\n\t\t    }\n\t\t}\n\t    }\n\t}\n\tif (current == -1) {\n\t    throw createXMLException(\"unexpected.eof\");\n\t}\n\tnextChar();\n\tcdataEndRead = true;\n\treturn LexicalUnits.CHARACTER_DATA;\n    }\n\n\nI believe it should also check on the end of file :\n>\t    while ((current != ']') && (current != -1)){\n>\t\tnextChar();\n>\t    }"}]