[{"count": 0, "tags": [], "bug_id": 34021, "is_private": false, "text": "I'm trying to set a cell formula using method HSSFCell.setCellFormula(String).\n\nThe FormulaParser fails parsing these formulas:\ncell.setCellFormula(\"Test.Sheet!A1\");\ncell.setCellFormula(\"Sheet 1!A1\");\n\nWhen I remove all blanks and dots from the referenced sheet name everything\nworks fine.\n\nHere's the stack trace:\n\njava.lang.StringIndexOutOfBoundsException: String index out of range: 0\n\tat java.lang.String.charAt(String.java:444)\n\tat org.apache.poi.hssf.util.CellReference.<init>(CellReference.java:44)\n\tat org.apache.poi.hssf.record.formula.ReferencePtg.<init>(ReferencePtg.java:50)\n\tat org.apache.poi.hssf.model.FormulaParser.Ident(FormulaParser.java:291)\n\tat org.apache.poi.hssf.model.FormulaParser.Factor(FormulaParser.java:474)\n\tat org.apache.poi.hssf.model.FormulaParser.Term(FormulaParser.java:548)\n\tat org.apache.poi.hssf.model.FormulaParser.Expression(FormulaParser.java:596)\n\tat org.apache.poi.hssf.model.FormulaParser.parse(FormulaParser.java:700)\n\tat org.apache.poi.hssf.usermodel.HSSFCell.setCellFormula(HSSFCell.java:678)", "id": 72456, "time": "2005-03-15T19:01:03Z", "creator": "thomas.herre@abosco.com", "creation_time": "2005-03-15T19:01:03Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "avik@apache.org", "attachment_id": null, "is_private": false, "id": 73973, "time": "2005-04-22T13:39:14Z", "bug_id": 34021, "creation_time": "2005-04-22T13:39:14Z", "text": "Can someone confirm that excel accepts sheet names with dots and spaces. I'll\nfix this then. "}, {"count": 2, "tags": [], "creator": "amolweb@yahoo.com", "attachment_id": null, "id": 73983, "time": "2005-04-22T14:42:24Z", "bug_id": 34021, "creation_time": "2005-04-22T14:42:24Z", "is_private": false, "text": "(In reply to comment #1)\n> Can someone confirm that excel accepts sheet names with dots and spaces. I'll\n> fix this then. \n\nThis does not appear to be a bug. The line in bug report:\n          cell.setCellFormula(\"Sheet 1!A1\");\nis incorrect. It should be:\n          cell.setCellFormula(\"'Sheet 1'!A1\");\n(Use single quotes around sheet name containing spaces/dots, thats how excel\ndoes it anyway) If you dont use single quotes in formula, even excel complains\nand throws up :)\n\nFollowing is example of code that works:\n\npublic static void main(String[] args) {\n HSSFWorkbook sb = new HSSFWorkbook();\n HSSFSheet sheet = sb.createSheet(\"Sheet a.1\");\n sheet = sb.createSheet();\n sheet.createRow(1).createCell((short) 2).setCellFormula(\"'Sheet a.1'!A1\");\n sb.write(new FileOutputStream(\"/somedir/test34021.xls\"));\n // close the FileOutputStream...\n}\n\n"}, {"count": 3, "attachment_id": null, "bug_id": 34021, "is_private": false, "id": 73985, "time": "2005-04-22T15:11:27Z", "creator": "avik@apache.org", "creation_time": "2005-04-22T15:11:27Z", "tags": [], "text": "Added a testcase in TestFormulas. Works fine. \n\nthanks Amol. "}]