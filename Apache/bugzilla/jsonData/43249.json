[{"count": 0, "tags": [], "bug_id": 43249, "text": "Error:\nauth_ldap authenticate: user myself authentication failed; URI /test/ [LDAP:\nldap_simple_bind_s() failed][Can't connect to the LDAP server]\n\nMy config:\nAuthLDAPUrl \"ldap://1.2.3.4:389/ou=group,dc=xyz,dc=de?uid?one\" NONE\n\nReason:\nFile srclib/apr-util/ldap/apr_ldap_init.c\nRow 149, Function apr_ldap_init\n\n[snip]\n#if APR_HAS_LDAPSSL_INIT\n    *ldap = ldapssl_init(hostname, portno, 0);\n#elif APR_HAS_LDAP_SSLINIT\n    *ldap = ldap_sslinit((char *)hostname, portno, 0);\n#else\n    *ldap = ldap_init((char *)hostname, portno);\n#endif\n[/snip]\n\nIt uses ldapssl_init to open an SSL-less connection. What the hell? ;-)\n\nMy change is:\n\n[snip]\n#if APR_HAS_LDAPSSL_INIT\n//    *ldap = ldapssl_init(hostname, portno, 0);\n    *ldap = ldap_init((char *)hostname, portno);\n#elif APR_HAS_LDAP_SSLINIT\n    *ldap = ldap_sslinit((char *)hostname, portno, 0);\n#else\n    *ldap = ldap_init((char *)hostname, portno);\n#endif\n[/snip]\n\nEverything works :)", "id": 107462, "time": "2007-08-30T03:58:37Z", "creator": "kevin.richter@uni-hildesheim.de", "creation_time": "2007-08-30T03:58:37Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 43249, "is_private": false, "id": 107474, "creation_time": "2007-08-30T08:12:39Z", "time": "2007-08-30T08:12:39Z", "creator": "bnicholes@apache.org", "text": "There is something else going on in your environment.  ldapssl_init() doesn't \nactually create a connection or talk over SSL to an ldap server.  It just \nprepares the client connection handle to allow an SSL connections if \nnecessary.  The resulting handle could be used to make a non-ssl connection or \nan ssl connection. In fact ldapssl_init(..., 0) is functionally equivalent to \nldap_init(...).  If Solaris requires some additional special handling, then \nthat would need to be identified and handled separately.  SSL is one of the \nareas that is very different between SDKs. ", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 43249, "text": "I dont think, that my environment is weird.\nIts a fresh Solaris 10 install with all latest patch clusters.\n\nMy configure command is:\n./configure --prefix=/opt/local/app/apache-2.2.4 --enable-mods-shared=most\n--enable-so --with-mpm=worker --enable-nonportable-atomics --disable-userdir\n--disable-authn-dbd --disable-authn-dbm --disable-authz-dbm\n--disable-authnz-ldap --disable-status --disable-dbd --disable-dav\n--disable-dav-fs --disable-dav-lock --disable-cgi --enable-cgid\n--enable-unique-id --enable-suexec --with-suexec-caller=webservd\n--with-suexec-docroot=/data/web --with-suexec-uidmin=100\n--with-suexec-gidmin=100 --with-suexec-logfile=/data/logs/suexec_log\n--enable-ssl --enable-authnz-ldap --enable-ldap --with-ldap-lib=/usr/lib\n--with-ldap-include=/usr/include --with-ldap=yes --with-ssl=/opt/local\n--enable-proxy --enable-proxy-http\n\nThe SUN LDAP packages\nSUNWhea\nSUNWlldap\nare installed.\nNo OpenLDAP and no SFW LDAP (like SFWoldap).\n\n$ ls -l /usr/include/*ldap*\n-rw-r--r--   1 root     bin        56030 Jan 21  2005 /usr/include/ldap.h\n\n$ ls -l /usr/lib/*ldap*\nlrwxrwxrwx   1 root     root          12 Feb 13  2007 /usr/lib/libldap.so ->\nlibldap.so.5\n-rwxr-xr-x   1 root     bin       214076 Jan 23  2005 /usr/lib/libldap.so.4\n-rwxr-xr-x   1 root     bin       367208 Jan 24  2007 /usr/lib/libldap.so.5\nlrwxrwxrwx   1 root     root          13 Feb 13  2007 /usr/lib/libsldap.so ->\nlibsldap.so.1\n-rwxr-xr-x   1 root     bin       233416 Jan 24  2007 /usr/lib/libsldap.so.1\n-rw-r--r--   1 root     bin        18479 Jan 22  2005 /usr/lib/llib-lldap\n-rw-r--r--   1 root     bin        78630 May 29 06:03 /usr/lib/llib-lldap.ln\n-rw-r--r--   1 root     bin         3490 Jan 22  2005 /usr/lib/llib-lsldap\n-rw-r--r--   1 root     bin        86080 May 29 06:04 /usr/lib/llib-lsldap.ln\n-rwxr-xr-x   1 root     bin       116764 May 29 20:49 /usr/lib/nss_ldap.so.1\n\n/usr/lib/ldap:\ntotal 388\n-r-xr-xr-x   1 root     bin       131282 Nov  7  2006 idsconfig\n-r-xr-xr-x   1 root     bin        50532 Jan 23  2005 ldap_cachemgr\n\n\nHow I said, there is nothing weird.\nI would laugh if any other user can use the .htaccess authorization against LDAP\nwithout SSL with these SUN LDAP libs without a patch.\n\nAnd in fact I dont know if the ldapssl_init(..., 0) and ldap_init(...) are\nreally equivalent in the SUN LDAP implementation. But I dont think so, otherwise\nboth versions should work.\n\n", "id": 107487, "time": "2007-08-30T12:26:52Z", "creator": "kevin.richter@uni-hildesheim.de", "creation_time": "2007-08-30T12:26:52Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 43249, "is_private": false, "text": "The LDAP functionality has been tested with OpenLDAP, Novell LDAP and Netscape \nLDAP SDKs.  To my knowledge, no real testing or integration has been done \nagainst the SUN LDAP SDK.  As I mentioned before, SSL is one of those tricky \nparts that usually functions differently between SDKs.  I would expect that \nsomebody who knows a lot more about the SUN LDAP SDK than I do, needs to work \nup and submit some patches so that it works correctly and doesn't break the \nother platforms.", "id": 107490, "time": "2007-08-30T13:25:42Z", "creator": "bnicholes@apache.org", "creation_time": "2007-08-30T13:25:42Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 43249, "is_private": false, "text": "Is this in fact the same underlying bug as PR 42682?\n\nIn other words, does your fix to that bug deal with this one too?  You've posted another fix to the same line of code here.", "id": 131986, "time": "2009-11-15T15:31:10Z", "creator": "nick@webthing.com", "creation_time": "2009-11-15T15:31:10Z", "attachment_id": null}]