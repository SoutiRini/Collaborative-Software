[{"count": 0, "tags": [], "bug_id": 54367, "attachment_id": null, "id": 164341, "time": "2013-01-02T23:18:19Z", "creator": "wiml@omnigroup.com", "creation_time": "2013-01-02T23:18:19Z", "is_private": false, "text": "The DAV PUT method returns the location of the newly created resource in the Location: header of the response (RFC2616 14.30; RFC4918 13.1). However, Apache does not quote the contents of the newly created path segments when constructing the new Location: URL (RFC3986 2.4). This means that the response can be incorrect if the underlying resource name contains octet-sequences that are significant in URLs (such as \"#\" or \"?\") or in the HTTP protocol (such as CRLF) or both (whitespace, etc).\n\nHere's an example of a request and response using httpd 2.4.3 on an OS X machine (httpd 2.2.x has the same behavior):\n\nRequest:\n\nPUT /pdav/test%23file HTTP/1.1\nContent-Length: 8\nHost: localhost\n\nHello!\n\nResponse:\n\nHTTP/1.1 201 Created\nDate: Wed, 02 Jan 2013 22:40:00 GMT\nServer: Apache/2.4.3 (Unix) OpenSSL/1.0.0j\nLocation: http://localhost/pdav/test#file\nContent-Length: 71\nContent-Type: text/html; charset=ISO-8859-1\n\n<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\n<html><head>\n<title>Connection closed by foreign host.\n\n\nThe file is correctly created in the filesystem as \"test#file\", but the Location: header in the response is incorrect.\n\nPUTting to a URL such as \".../davcoll/foo%0A%0DBar:%20blahblah\" may be a way to perform a response splitting attack (a la http://jeremiahgrossman.blogspot.com/2007/07/http-response-splitting-revelations.html )."}, {"count": 1, "tags": [], "bug_id": 54367, "text": "See also <https://issues.apache.org/bugzilla/show_bug.cgi?id=54611>, which seems like a more general case of Location headers not doing proper URI encoding.", "id": 165495, "time": "2013-02-26T19:10:52Z", "creator": "tjw@omnigroup.com", "creation_time": "2013-02-26T19:10:52Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 54367, "attachment_id": null, "is_private": false, "id": 166772, "time": "2013-04-23T00:49:41Z", "creator": "wiml@omnigroup.com", "creation_time": "2013-04-23T00:49:41Z", "text": "In trunk/2.5 r1470683, Apache simply doesn't return a Location: header for PUTs any more (sigh), but the problem still happens for eg MKCOL. \n\n\n% curl -ik -X MKCOL 'http://localhost:9080/wiml/foo%0D%0Aoo'\nHTTP/1.1 201 Created\nDate: Tue, 23 Apr 2013 00:48:10 GMT\nServer: Apache/2.5.0-dev (Unix) OpenSSL/1.0.1c\nLocation: http://localhost:9080/wiml/foo\noo\nContent-Length: 71\nContent-Type: text/html; charset=ISO-8859-1"}, {"count": 3, "tags": [], "creator": "minfrin@sharp.fm", "attachment_id": null, "text": "Can you verify whether the patch applied from 54611 fixes this?", "id": 166897, "time": "2013-04-27T19:39:50Z", "bug_id": 54367, "creation_time": "2013-04-27T19:39:50Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 54367, "is_private": false, "text": "Yes 54611 resolved this.", "id": 169335, "time": "2013-08-10T02:37:42Z", "creator": "ben@reser.org", "creation_time": "2013-08-10T02:37:42Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 54367, "attachment_id": null, "is_private": false, "id": 181214, "time": "2015-02-20T13:49:57Z", "creator": "Juergen.Mertens@SoftwareAG.com", "creation_time": "2015-02-20T13:49:57Z", "text": "The problem still exists under Debian 8 (Apache 2.4.10-8).\nSo I think 54611 fix was not fixing this one"}, {"count": 6, "tags": [], "bug_id": 54367, "attachment_id": null, "is_private": false, "id": 181625, "time": "2015-03-10T02:38:12Z", "creator": "wiml@omnigroup.com", "creation_time": "2015-03-10T02:38:12Z", "text": "(In reply to Juergen Mertens from comment #5)\n\nI just ran the 'curl' test above against a bunch of recent httpd releases and it appears to be fixed in 2.4.6 and later (working: 2.4.6, 2.4.7, 2.4.9, 2.4.10, 2.4.12, 2.4.13-dev (r1665231), and 2.5.0-dev (r1665385); not working: 2.4.2, 2.4.4); methods MKCOL and PUT; on OSX 10.9.5.\n\n(I did notice that the bug you can see in my earlier report where the response is truncated after the \"<title>\" is also fixed as of 2.4.12!)\n\n\nCan you give more information on what request you're sending and what you're receiving back from the server?"}]