[{"count": 0, "tags": [], "creator": "breese@grandcentral.com", "attachment_id": null, "text": "I have two build.xml files. One is a master build file which simply calls other\nbuild files. In one of my sub-build files I am calling:\n\n<target name=\"foo\">\n<exec on=\"Linux,SunOS\" executable=\"deploy.sh\">\n</target>\n\nThis deploy.sh simply appends several text files together into a new file.\n\ndeploy.sh properties:\n-r-xr-xr-x    1 breese   breese        619 Mar  8 15:49 deploy.sh\n\nWhen I build this target locally (from the sub-build file's working directory),\nit works fine. However when I build it through the use of an <ant> task in an\nexternal build.xml, it fails. Here is what it gives me:\n\nFrom master build.xml:\n<target name=\"dist\">\n  <ant dir=\"../../web/build\" target=\"foo\">\n</target>\n\nOutput from running 'ant dist':\n...\n[exec] Result: -1\n...\n\ndeploy.sh contents:\n\n#\n# create a consolidated rvw file\n#\ncat ../foo.rvw > classes/deploy.rvw\ncat ../bar.rvw >> classes/deploy.rvw\ncat ../baz.rvw >> classes/deploy.rvw\ncat ../../foo2.rvw >> classes/deploy.rvw\n\n#\n# create the index.html file with a date and time stamp\ncat ../jhtml/indexhead.html > ../jhtml/index.html\ncat ../jhtml/indexview.html >> ../jhtml/index.html\ndate >> ../jhtml/index.html\ncat ../jhtml/indextail.html >> ../jhtml/index.html", "id": 1085, "time": "2001-03-08T17:09:09Z", "bug_id": 911, "creation_time": "2001-03-08T17:09:09Z", "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 911, "text": "Just to confirm ... we are experiencing this same behaviour as well .. glad to\nsee that someone else is having the same problem.\n\nmain build file:\n\n    <target name=\"test-util\" depends=\"config\">\n        <ant dir=\"src/brivo/core/\" target=\"test-util\" />\n    </target>\n\ncore build file:\n\n    <target name=\"test-util\" depends=\"util\">\n\n        <exec dir=\"${CLASSESDIR}\" failonerror=\"yes\" executable=\"${JAVACMD}\">\n            <arg line=\"-cp ${CLASSESDIR}:${CP} brivo.core.util.tests.UtilTests\"\n/>\n        </exec>\n\n    </target>\n\nYields ...\n\nBUILD FAILED\n\n/home/max/BigBird/src/brivo/core/build.xml:195: Exec returned: 255\n\nTotal time: 10 seconds     ", "id": 1751, "time": "2001-04-05T08:10:38Z", "creator": "max@webwizarddesign.com", "creation_time": "2001-04-05T08:10:38Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "text": "My investigations on this same problem were as follows:\n- <exec> tasks when run under ANT 1.2 do NOT exhibit this failure\n- <exec> tasks executed by ANT 1.3 on UNIX platforms exhibit this failure under \n  the following circumstances:\n  + The current working directory of the user (i.e., user.dir system \n    property) when ANT is started is different from the value used for \n    the \"execution\" directory for the <exec> task (i.e., \"dir\" attribute\n    of <exec> command).\n  + When the \"dir\" attribute is not supplied in the <exec> tag, the \"execution\"\n    directory is defaulted to the directory where the buildfile (i.e.,\n    build.xml) containing the <exec> task resides (this would satisfy the\n    first point if the buildfile was in a directory other than the user's\n    current working directory where he started ANT).\n\nThese observations led me to the Execute.java source file where I realized that\nONLY in the case where the user's current working directory is DIFFERENT from\nthe requested command \"execution\" directory will ANT use a provided OS-\nspecified script (antRun.bat for Win9X and antRun for UNIX) to accomplish the\nexecution of the command.\n\nWhen I compared the difference between the antRun UNIX script for ANT 1.2 and \nANT 1.3, I found something very interesting. The ANT 1.3 script for UNIX had \nDOS end-of-line characters (^M) embedded in the file. Well..., knowing that\nUNIX and DOS don't get along in this area, I removed the DOS artifacts and\neverything started working just fine.\n\nI was unable to locate the antRun script in the Jarkarta CVS Repository that\nwas a part of the ANT 1.2 build. I could only find the version (only one version\nexists) for the ANT 1.3 build. Strangely enough though, when I downloaded the \nsource for antRun from CVS, I didn't notice the script source having any \nembedded DOS artifacts.  I'm not sure where they got introduced at, but they\nwere there when I downloaded and installed the ANT 1.3 binary bundle.\n\nMaybe someone can confirm that their installation has the same problem with the \nantRun script and then a developer could look into how they may have been\nintroduced into the release TAR files.\n\nI hope this is really the solution to the problems described by this Bug.", "attachment_id": null, "bug_id": 911, "id": 3210, "time": "2001-06-22T12:28:03Z", "creator": "mark.patton@level3.com", "creation_time": "2001-06-22T12:28:03Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 911, "text": "I've got exactly the same behavior... And since I find this bug very annoying \n(my complete automated build doesn't work :) it might need some further \ninvestigation!!!\n\n<exec dir=\"${basedir}\" executable=\"bla\"/>\n\nworks if {basedir} is the same as the directory where ant was started\n\nNOT if {basedir} is NOT the same as the directory where ant was started!", "id": 3440, "time": "2001-07-06T05:08:09Z", "creator": "jakarta@arendsen.net", "creation_time": "2001-07-06T05:08:09Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 4203, "time": "2001-08-01T02:56:14Z", "bug_id": 911, "creation_time": "2001-08-01T02:56:14Z", "is_private": false, "text": "could you please confirm that the bug persists after you have removed any stray\ncariage return characters from ANT_HOME/bin/antRun.sh?\n\nOtherwise we can close this report as a duplicate of bug 837 (which is supposed\nto be fixed with the next release)."}, {"count": 5, "tags": [], "creator": "conor@apache.org", "attachment_id": null, "id": 4376, "time": "2001-08-08T08:47:22Z", "bug_id": 911, "creation_time": "2001-08-08T08:47:22Z", "is_private": false, "text": "I assume this was the issue. Haven't heard to the contrary so closing."}, {"count": 6, "tags": [], "bug_id": 911, "attachment_id": null, "id": 4381, "time": "2001-08-08T09:40:03Z", "creator": "jakarta@arendsen.net", "creation_time": "2001-08-08T09:40:03Z", "is_private": false, "text": "Yeah, it was the issue... Sorry for not replying... Thanx,\n\nAlef"}]