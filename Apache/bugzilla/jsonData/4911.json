[{"count": 0, "tags": [], "bug_id": 4911, "attachment_id": null, "text": "Tried various workarounds and could not get single quotes to output as part of \nan argument for the exec task.\n\nI wanted to use awk and no matter what I  did, the ' came out as \"\n\nExamples:\n<exec os=\"SunOS\" executable=\"awk\" outputproperty=\"host.address\">\n<arg line=\"'NR == 2 { print $NF }'\" />\n</exec>\n\n<exec os=\"SunOS\" executable=\"nslookup\" outputproperty=\"host.address\">\n<arg value=\"${host.name}\" />\n<arg line=\"| awk 'NR == 2 { print $NF }'\" />\n</exec>\n\nawk commands require single quotes. How can I do this other than write a \nwrapper script.\n\nThe above always outputs awk \"NR == 2 { print $NF }\" which the shell does not \nlike.", "id": 7976, "time": "2001-11-16T01:18:12Z", "creator": "peterwlynch@yahoo.com", "creation_time": "2001-11-16T01:18:12Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 4911, "attachment_id": null, "text": "Added a testcase (commented) to CVS about Commandline. (testAwkCommand)\n\nI'm not confortable with the magic behind the command line quoting here and the \npossible breaks that can arise, so I will let Stefan take a look at it.", "id": 8015, "time": "2001-11-16T15:40:38Z", "creator": "sbailliez@apache.org", "creation_time": "2001-11-16T15:40:38Z", "is_private": false}, {"count": 2, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 8667, "time": "2001-12-06T07:47:07Z", "bug_id": 4911, "creation_time": "2001-12-06T07:47:07Z", "is_private": false, "text": "There is nothing really wrong here, except that you shouldn't be using line\nbut value.\n\nI start to think that we better should remove (or strongly rewrite) the -debug\noutput of <exec> as it is extremely misleading.  Ant doesn't use the shell at\nall to invoke a command, so no quotes are needed at all and the debug line\nis something very different from the command that gets actually executed.\n\nI run on Redhat 7.2 Linux here and it has some strange version of nslookup, if I\nrun nslookup by hand I get:\n\n[bodewig@bodewig jakarta-ant]$ nslookup -silent www.apache.org\nServer:\n\t195.94.90.10\nAddress:\n195.94.90.10#53\n\nNon-authoritative answer:\nName:\nwww.apache.org\nAddress: 64.125.133.20\n\nI will now use two exec tasks and couple them (so I don't need to run a shell)\nusing a poor man's pipe, read a temporary file.  The build file I use is\n\n  <project default=\"default\">\n    <target name=\"default\">\n      <exec executable=\"nslookup\" output=\"tmp.out\">\n        <arg line=\"-silent www.apache.org\" />\n      </exec>\n      <exec executable=\"awk\">\n        <arg value=\"NR == 2 { print $$NF }\" />\n        <arg value=\"tmp.out\" />\n      </exec>\n      <delete file=\"tmp.out\" />\n    </target>\n  </project>\n\nYou see, no quotes at all - awk will get the program as a single argument\n(because I use value instead of line).  The result is\n\ndefault:\n     [exec] 195.94.90.10#53\n   [delete] Deleting: /tmp/tmp.out\n\nBUILD SUCCESSFUL\n"}, {"count": 3, "tags": [], "bug_id": 4911, "attachment_id": null, "text": "The first to lines of the nslookup result have been garbled, but you probably\nget the idea anyway.\n\nNote that I had to double the $ sign as it gets some special treatment by Ant.", "id": 8668, "time": "2001-12-06T07:59:29Z", "creator": "bodewig@apache.org", "creation_time": "2001-12-06T07:59:29Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 4911, "attachment_id": null, "text": "Back again...\n\nOk I tried what you suggested on Windows 2000 Pro running cygwin of course.\nIt does not work exactly. I continue try all forms of doing awk single quotes \nand all I get is double.\n\n------------- Begin Ant Target -----------------\n<!-- =============== HOST ADDRESS ================ -->\n        <exec os=\"HP-UX,SunOS,Linux\" executable=\"nslookup\"\n            output=\".host.address\">\n            <arg line=\"${host.name}\" />\n        </exec>\n        <exec os=\"Windows NT,Windows 2000\" executable=\"ipconfig\"\n            output=\".host.address\"/>\n        <condition property=\"awkspot\" value=\"6\">\n            <or>\n                <equals arg1=\"${os.name}\" arg2=\"Windows NT\" />\n                <equals arg1=\"${os.name}\" arg2=\"Windows 2000\" />\n                <equals arg1=\"${os.name}\" arg2=\"HP-UX\" />\n            </or>\n        </condition>\n        <condition property=\"awkspot\" value=\"5\">\n            <or>\n                <equals arg1=\"${os.name}\" arg2=\"SunOS\" />\n                <equals arg1=\"${os.name}\" arg2=\"Linux\" />\n            </or>\n        </condition>\n        <exec executable=\"awk\" outputproperty=\"host.address\">\n            <arg value=\"NR == ${awkspot} { print $$NF }\"/>\n            <arg value=\".host.address\"/>\n        </exec>\n        <delete file=\".host.address\"/>\n\n------------- End Ant Target -----------------\n\n\n\nHere is my debug output:\n--------------- Begin debug ---------------\nconfigure-install-prepare:\n     [exec] Current OS is Windows 2000\n     [exec] id -gn\n     [exec] Output redirected to ByteArray\nExecute:Java13CommandLauncher: id -gn\nSetting project property: user.group -> Administrators\n     [exec] Current OS is Windows 2000\n     [exec] This OS, Windows 2000 was not found in the specified list of valid \nOSes: SunOS\n     [exec] Current OS is Windows 2000\n     [exec] hostname\n     [exec] Output redirected to ByteArray\nExecute:Java13CommandLauncher: hostname\nSetting project property: host.name -> plynch-wsc\n     [exec] Current OS is Windows 2000\n     [exec] This OS, Windows 2000 was not found in the specified list of valid \nOSes: HP-UX,SunOS,Linux\n     [exec] Current OS is Windows 2000\n     [exec] ipconfig\n     [exec] Output redirected to \nD:\\cygwin\\home\\plynch\\dev\\appiant\\inunison\\.host.address\nExecute:Java13CommandLauncher: ipconfig\nSetting project property: awkspot -> 6\n     [exec] Current OS is Windows 2000\n     [exec] awk \"NR == 6 { print $NF }\" .host.address\n     [exec] Output redirected to ByteArray\nExecute:Java13CommandLauncher: awk \"NR == 6 { print $NF }\" .host.address\nSetting project property: host.address -> \n   [delete] Deleting: D:\\cygwin\\home\\plynch\\dev\\appiant\\inunison\\.host.address \n\n----------- End debug -------------------\nAt the line \"Execute:Java13CommandLauncher: awk \"NR == 6 { print \n$NF }\" .host.address\" , I get a message from windows about the 16bit dos \nsubsystem ( see screenshot )\n\nThe above does work fine on Solaris though.\n\nI am going to try to update my cygwin binaries to see if that helps.\n\nThis problem seems so simple from the outside....I disagree that this is not a \nbug ( the single quote thing )\n\nIf the debug output is different from what actually gets executed, where can I \nfind what gets executed?\n\n\n", "id": 11956, "time": "2002-03-18T19:55:51Z", "creator": "peterwlynch@yahoo.com", "creation_time": "2002-03-18T19:55:51Z", "is_private": false}, {"count": 5, "tags": [], "creator": "peterwlynch@yahoo.com", "attachment_id": null, "id": 11959, "time": "2002-03-18T20:44:28Z", "bug_id": 4911, "creation_time": "2002-03-18T20:44:28Z", "is_private": false, "text": "Ok traced the problem of my hack to the fact cygwin uses gawk not awk. Changed \nthe exec to gawk and things work fine. Thanks for the workaround.\n\n\n"}, {"text": "(Closed with WORKSFORME, but should be WORKSFORGAWK :)", "tags": [], "creator": "holtdl@yahoo.com", "attachment_id": null, "count": 6, "id": 12987, "time": "2002-04-08T06:53:18Z", "bug_id": 4911, "creation_time": "2002-04-08T06:53:18Z", "is_private": false}]