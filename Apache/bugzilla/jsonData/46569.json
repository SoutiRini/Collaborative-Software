[{"count": 0, "tags": [], "creator": "poojapk_30@yahoo.co.in", "text": "Created attachment 23146\nsample program to demonstrate issue\n\nI am creating and excel worksheet , the width of whose columns may vary. There is an image on the top row - anchores to one of the last columns of the sheet. \nWhen the width of the column containing the image is very wide (say 1000 pixels), the image is reversed and placed on the column before the column where the image is anchored. A sample program to demonstrate the issue is attached.", "id": 124216, "time": "2009-01-20T20:58:05Z", "bug_id": 46569, "creation_time": "2009-01-20T20:58:05Z", "is_private": false, "attachment_id": 23146}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 124224, "time": "2009-01-21T03:06:28Z", "bug_id": 46569, "creation_time": "2009-01-21T03:06:28Z", "is_private": false, "text": "I haven't looked into this at all, but I wonder if it might be a signed vs unsiged 16 bit integer issue. That'd be my first hunch on where to investigate"}, {"count": 2, "tags": [], "bug_id": 46569, "attachment_id": null, "text": "Your sample programs uses unresolved ReportWriterHelper.convertPixelsToCharacters and ReportWriterHelper.convertPixelsToPoints. Please re-attach an isolated test case. \nAlso attach the image you are using for the header. \n\nYegor", "id": 124584, "time": "2009-02-02T07:20:35Z", "creator": "yegor@dinom.ru", "creation_time": "2009-02-02T07:20:35Z", "is_private": false}, {"count": 3, "tags": [], "creator": "poojapk_30@yahoo.co.in", "attachment_id": 23231, "id": 124670, "time": "2009-02-04T23:06:43Z", "bug_id": 46569, "creation_time": "2009-02-04T23:06:43Z", "is_private": false, "text": "Created attachment 23231\nupdated standalone sample junit to demonstrate the problem"}, {"count": 4, "tags": [], "bug_id": 46569, "attachment_id": 23232, "text": "Created attachment 23232\nImage used by sample program\n\nPlease update the path of the image file on line 91 of the sample program to point to this image file.", "id": 124671, "time": "2009-02-04T23:09:48Z", "creator": "poojapk_30@yahoo.co.in", "creation_time": "2009-02-04T23:09:48Z", "is_private": false}, {"count": 5, "tags": [], "creator": "poojapk_30@yahoo.co.in", "text": "The standalone junit to demonstrate the issue and the image file used are uploaded. \nPlease update file path in line 91 of sample program to point to the image file attached.\nIf you comment line 46 where the width of the column is set to a very large value, the excel generated has the image placed properly. Uncomment it and the image in the excel is reversed.", "id": 124672, "time": "2009-02-04T23:14:03Z", "bug_id": 46569, "creation_time": "2009-02-04T23:14:03Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 46569, "attachment_id": null, "text": "Nick's supposition is right, it is a signed vs unsiged 16 bit integer issue.\n\n1. The following fragment (lines 64-66) is wrong:\n\n                float cellWidth = convertPixelsToCharacters(columnWidths[c] * 256f);\n\n                sheet.setColumnWidth((short) (columnIndex), (short) cellWidth);\n\nIf cellWidth > Short.MAX_VALUE then the casting to short produces a negative value.\n\n2. setColumnWidth / getColumnWidth with short arguments are deprecated. \nUse\nsetColumnWidth(int columnIndex, int width) \nand \nint getColumnWidth(int columnIndex) \n\nIn particular, getColumnWidth(short columnIndex)  return a short value. If column width measured in 1/256th units is in the interval [32767, 65536] \nthen this method returns a negative value which is evidently incorrect.\n\n3. The maximum column width for an individual cell in Excel is 255 characters. I changed the code to throw IllegalArgumentException if this limit is exceeded.\n\nRegards,\nYegor\n", "id": 124698, "time": "2009-02-06T10:40:37Z", "creator": "yegor@dinom.ru", "creation_time": "2009-02-06T10:40:37Z", "is_private": false}, {"count": 7, "tags": [], "creator": "josh@apache.org", "text": "(In reply to comment #6)\n> ...\n> 3. The maximum column width for an individual cell in Excel is 255 characters.\n> I changed the code to throw IllegalArgumentException if this limit is exceeded.\n> ...\n\nsvn r741678", "id": 124702, "time": "2009-02-06T18:07:07Z", "bug_id": 46569, "creation_time": "2009-02-06T18:07:07Z", "is_private": false, "attachment_id": null}]