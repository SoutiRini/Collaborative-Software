[{"count": 0, "tags": [], "creator": "arunnandu@yahoo.com", "is_private": false, "id": 40050, "attachment_id": null, "bug_id": 21365, "creation_time": "2003-07-07T10:31:34Z", "time": "2003-07-07T10:31:34Z", "text": "The following is a pseudo code style PL/SQL block. When stored in a file and \nrun using sql task on oracle. the sp becomes invalid (status) as the sql task \nhas an issue.\n\ncreate or replace sp_add( a int )\n\nas\n\nbegin \n\nif a > 10 then\n   a := 10 -- this comment is just to replicate issues.\nend if\n\nreturn a + 100;\n\nend;\n\nThe problem is in SQLExec.java Line 454 onwards is\n\n            sql += \" \" + line;\n            sql = sql.trim(); /// GOTCHA HERE....REMOVES NEWLINE added below.\n            \n            // SQL defines \"--\" as a comment to EOL\n            // and in Oracle it may contain a hint\n            // so we cannot just remove it, instead we must end it\n            if (line.indexOf(\"--\") >= 0) {\n                sql += \"\\n\"; /// THIS WOULD HAVE ADDED THE NEWLINE\n            }\n\nApparently, there is a line.trim() already being done earlier in the while \nloop, so I dont think a sql.trim() is required here...\n\nThanks And Regards\nArun N Kumar"}, {"count": 1, "tags": [], "creator": "antoine@apache.org", "is_private": false, "id": 40481, "attachment_id": null, "bug_id": 21365, "creation_time": "2003-07-11T15:51:28Z", "time": "2003-07-11T15:51:28Z", "text": "In ant 1.6alpha, there is a keepformat attribute for the SQL task which solves \nyour problem.\n\n*** This bug has been marked as a duplicate of 10719 ***"}]