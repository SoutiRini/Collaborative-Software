[{"count": 0, "tags": [], "creator": "rcasa@bluewin.ch", "attachment_id": null, "text": "I configure a Data Source with the Administration webapp, the \"Data Source URL\" \nfield contains the special character &, for example:\n\njdbc:sybase:Tds:host.domain:4100/db?APPLICATIONNAME=Tomcat&HOSTNAME=myserver\n\nI save and commit changes, all is well.\n\nWhen I try to restart Tomcat, it will not start, there is an exception while \nparsing server.xml:\n\nCatalina.start: org.xml.sax.SAXParseException: Next character must be \";\" \nterminating reference to entity \"HOSTNAME\".\n....\n\nThe problem is that the data source's url resource parameter's value is stored \nliterally in server.xml (the & character is not escaped to &amp;) which makes \nit invalid XML.\n\nserver.xml:\n\n<ResourceParams name=\"myDataSource\">\n  ...\n  <parameter>\n    <name>url</name>\n    <value>jdbc:sybase:Tds:host.domain:4100/db?\nAPPLICATIONNAME=Tomcat&HOSTNAME=myserver</value>\n  </parameter>\n  ...\n</ResourceParams>", "id": 28821, "time": "2003-01-02T13:13:54Z", "bug_id": 15762, "creation_time": "2003-01-02T13:13:54Z", "is_private": false}, {"count": 1, "tags": [], "creator": "rcasa@bluewin.ch", "attachment_id": 4320, "is_private": false, "id": 28823, "time": "2003-01-02T13:35:04Z", "bug_id": 15762, "creation_time": "2003-01-02T13:35:04Z", "text": "Created attachment 4320\npatch to org.apache.catalina.core.StandardServer to escape resource parameter values in storeNamingResources"}, {"count": 2, "tags": [], "bug_id": 15762, "attachment_id": null, "id": 28827, "creation_time": "2003-01-02T17:16:20Z", "time": "2003-01-02T17:16:20Z", "creator": "craig.mcclanahan@sun.com", "text": "The server.xml file is an XML document, and therefore you must obey the syntax\nand semantic rules of XML.  Using a plain \"&\" character in XML does not conform,\nso your server.xml file is broken.\n\nIf you want to include a URL that includes an ampersand, you need to do the\nusual XML escape for it (&amp;) instead.  For example:\n\njdbc:sybase:Tds:host.domain:4100/db?APPLICATIONNAME=Tomcat&amp;HOSTNAME=myserver\n\n", "is_private": false}, {"count": 3, "tags": [], "bug_id": 15762, "attachment_id": null, "id": 28832, "time": "2003-01-02T22:59:26Z", "creator": "rcasa@bluewin.ch", "creation_time": "2003-01-02T22:59:26Z", "is_private": false, "text": "That is correct if I modify server.xml directly.  However this happens when I \nuse the Tomcat Administration webapp.\nEven if I use \"&amp;\" in server.xml, the next time I change something using the \nAdministration webapp, server.xml is rewritten with a plain \"&\" character \ninstead, and Tomcat fails on the next restart.\nI really think this is a bug in the code that writes out server.xml."}, {"count": 4, "tags": [], "creator": "amyroh@apache.org", "attachment_id": null, "text": "I was able to reproduce this problem of admin changing \"&amp;\" back to \nplain '&' character.", "id": 28835, "time": "2003-01-03T02:13:58Z", "bug_id": 15762, "creation_time": "2003-01-03T02:13:58Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 15762, "attachment_id": null, "id": 28836, "time": "2003-01-03T02:14:26Z", "creator": "amyroh@apache.org", "creation_time": "2003-01-03T02:14:26Z", "is_private": false, "text": "Fixed in cvs.  Should be available in the next release."}]