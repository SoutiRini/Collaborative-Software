[{"count": 0, "tags": [], "bug_id": 56129, "attachment_id": null, "id": 173002, "time": "2014-02-12T14:22:18Z", "creator": "elivingt@gmail.com", "creation_time": "2014-02-12T14:22:18Z", "is_private": false, "text": "setSheetHidden() does not work on the first sheet, it works fine on other sheets.\n\n\n\n\n\nWorkbook wb = new XSSFWorkbook();\nwb.createSheet(\"first\");\nwb.createSheet(\"second\");\nwb.createSheet(\"third\");\n\nwb.setSheetHidden(0, true);  // this does not work\nwb.setSheetHidden(1, true);  // this works\n\nfileOut = new FileOutputStream(\"workbook.xlsx\");\nwb.write(fileOut);\nfileOut.close();"}, {"attachment_id": null, "tags": [], "bug_id": 56129, "is_private": false, "count": 1, "id": 173003, "time": "2014-02-12T14:24:12Z", "creator": "elivingt@gmail.com", "creation_time": "2014-02-12T14:24:12Z", "text": "Looking at the ctSheet after the call I see that it is set as \"hidden\"."}, {"count": 2, "tags": [], "text": "First up, any chance you could re-test with the new POI 3.10 final?\n\nSecondly, are you able to produce 3 files:\n * POI produced, sheet 0 hidden\n * POI produced, sheet 1 hidden\n * Excel produced, sheet 0 hidden\n?\n\nThirdly, could either you, or someone else, unzip the three .xlsx files (which are zips of xml), and then compare where and what gets set around hidden sheets, to see if we can identify what POI's doing wrong?", "is_private": false, "id": 173004, "creator": "apache@gagravarr.org", "time": "2014-02-12T14:29:01Z", "bug_id": 56129, "creation_time": "2014-02-12T14:29:01Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "elivingt@gmail.com", "attachment_id": 31302, "text": "Created attachment 31302\nfirst sheet hidden saved by Excel  (works fine)", "id": 173005, "time": "2014-02-12T15:40:02Z", "bug_id": 56129, "creation_time": "2014-02-12T15:40:02Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 56129, "attachment_id": 31303, "id": 173006, "time": "2014-02-12T15:40:46Z", "creator": "elivingt@gmail.com", "creation_time": "2014-02-12T15:40:46Z", "is_private": false, "text": "Created attachment 31303\nsecond sheet hidden, saved by poi 3.10  (works fine)"}, {"count": 5, "tags": [], "text": "Created attachment 31304\nfirst sheet hidden, saved by poi 3.10 (Does not work, sheet is visible)", "is_private": false, "id": 173007, "creator": "elivingt@gmail.com", "time": "2014-02-12T15:41:48Z", "bug_id": 56129, "creation_time": "2014-02-12T15:41:48Z", "attachment_id": 31304}, {"count": 6, "tags": [], "bug_id": 56129, "attachment_id": null, "id": 173008, "time": "2014-02-12T15:58:10Z", "creator": "elivingt@gmail.com", "creation_time": "2014-02-12T15:58:10Z", "is_private": false, "text": "Looked at inside the zipped xlsx and mystery solved.\nProblem is that the active sheet cannot be hidden.\n\nWhen changing the code to:\n\nwb.setActiveSheet(1);\nwb.setSheetHidden(0, true);\n\nThe first sheet is hidden correctly.\n\nI still thinks this is a bug but not as critical as before"}, {"count": 7, "tags": [], "bug_id": 56129, "attachment_id": null, "id": 173009, "time": "2014-02-12T16:03:21Z", "creator": "apache@gagravarr.org", "creation_time": "2014-02-12T16:03:21Z", "is_private": false, "text": "Any chance you could propose a tweak to the setSheetHidden javadocs to add the note about active sheets? That should hopefully help someone in your situation in future!"}, {"count": 8, "tags": [], "bug_id": 56129, "attachment_id": null, "is_private": false, "id": 185196, "time": "2015-09-13T19:34:47Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-09-13T19:34:47Z", "text": "I have now updated the javadoc for the relevant methods in Workbook, XSSFWorkbook and SXSSFWorkbook via r1702805. For now we will not perform more checks here as the spec seems to allow these settings and Excel just interprets them this way currently."}]