[{"count": 0, "tags": [], "creator": "rpi_alum@yahoo.com", "attachment_id": 27616, "text": "Created attachment 27616\nPatch for issue\n\nSome message files appear to have additional information for charset when dealing with some US-ASCII types.\n\nPatch attached, looks for an occurrence of a semicolon and substrings the string if present.  NOTE: won't work if a valid charset encoding for a string can contain semicolons as a valid option.  Other option could be to modify Pattern used to produce charsets.\n\nActual m.group(1) string returned from Content-Type: \"US-ASCII; format=flowed; delsp=yes\"\n\nUnable to attach sample file due to sensitive nature.\n\nException Message Stack Trace: POI-3.8-beta4\n\n\nBaseTextExtractionService - Unexpected RuntimeException from org.apache.tika.parser.microsoft.OfficeParser@2ddd595d\norg.apache.tika.exception.TikaException: Unexpected RuntimeException from org.apache.tika.parser.microsoft.OfficeParser@2ddd595d\n\nCaused by: java.lang.RuntimeException: Encoding not found - US-ASCII; format=flowed\n\tat org.apache.poi.hsmf.datatypes.StringChunk.parseAs7BitData(StringChunk.java:155)\n\tat org.apache.poi.hsmf.datatypes.StringChunk.parseString(StringChunk.java:86)\n\tat org.apache.poi.hsmf.datatypes.StringChunk.set7BitEncoding(StringChunk.java:74)\n\tat org.apache.poi.hsmf.MAPIMessage.set7BitEncoding(MAPIMessage.java:413)\n\tat org.apache.poi.hsmf.MAPIMessage.guess7BitEncoding(MAPIMessage.java:373)\n\tat org.apache.tika.parser.microsoft.OutlookExtractor.parse(OutlookExtractor.java:73)\n\tat org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:219)\n\tat org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)\n\t... 49 more\nCaused by: java.io.UnsupportedEncodingException: US-ASCII; format=flowed\n\tat java.lang.StringCoding.decode(StringCoding.java:170)\n\tat java.lang.String.<init>(String.java:443)\n\tat java.lang.String.<init>(String.java:515)\n\tat org.apache.poi.hsmf.datatypes.StringChunk.parseAs7BitData(StringChunk.java:153)\n\t... 56 more", "id": 149866, "time": "2011-09-27T23:36:02Z", "bug_id": 51901, "creation_time": "2011-09-27T23:36:02Z", "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 51901, "text": "Thanx. I updated regular expression that searches for charset in revision r1176780.", "id": 149884, "time": "2011-09-28T08:20:21Z", "creator": "max.valjanski@gmail.com", "creation_time": "2011-09-28T08:20:21Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "text": "Thanks for the quick fix,  I tested it and confirmed it works against the files I was having an issue with.\n\n(In reply to comment #1)\n> Thanx. I updated regular expression that searches for charset in revision\n> r1176780.", "attachment_id": null, "bug_id": 51901, "id": 150097, "time": "2011-10-03T19:26:02Z", "creator": "rpi_alum@yahoo.com", "creation_time": "2011-10-03T19:26:02Z", "is_private": false}]