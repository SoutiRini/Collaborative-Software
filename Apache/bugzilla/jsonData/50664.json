[{"count": 0, "tags": [], "creator": "balusc@gmail.com", "attachment_id": null, "text": "The issue is described in this Stackoverflow question: http://stackoverflow.com/questions/4790589/sqlexception-w-tomcat-7-0-jdbc-connection-pool-and-mysql\n\nSummarized, in a situation where Spring is been used to manage the `org.apache.tomcat.jdbc.pool.DataSource`, the JDBC driver class is not found, even though it was placed in `${catalina.home}/lib`. The Tomcat JDBC throws the following exception:\n\njava.sql.SQLException: \"com.mysql.jdbc.Driver\"\n    at org.apache.tomcat.jdbc.pool.PooledConnection.connectUsingDriver(PooledConnection.java:243)\n    at org.apache.tomcat.jdbc.pool.PooledConnection.connect(PooledConnection.java:176)\n\nThe source code of `PooledConnection` learns me that it is attempting to load the driver by the same classloader as the `PooledConnection` class itself is been loaded. This should rather have been the thread context classloader as follows.\n\ndriver = (java.sql.Driver) Class.forName(poolProperties.getDriverClassName(),\n    true, Thread.currentThread().getContextClassLoader()).newInstance();", "id": 143690, "time": "2011-01-26T23:27:06Z", "bug_id": 50664, "creation_time": "2011-01-26T23:27:06Z", "is_private": false}, {"count": 1, "tags": [], "creator": "balusc@gmail.com", "text": "Reject this. The problem is caused by misconfiguration in Spring.\n\nBut still, it may be safer to grab the classloader from the thread context.", "id": 143734, "time": "2011-01-27T16:13:41Z", "bug_id": 50664, "creation_time": "2011-01-27T16:13:41Z", "is_private": false, "attachment_id": null}, {"count": 2, "attachment_id": null, "bug_id": 50664, "text": "I am in favor of using the context's WebappClassLoader when configuring a JNDI DataSource defined in context.xml.", "id": 143735, "time": "2011-01-27T16:44:21Z", "creator": "chris@christopherschultz.net", "creation_time": "2011-01-27T16:44:21Z", "tags": [], "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 50664, "is_private": false, "count": 3, "id": 143738, "time": "2011-01-27T17:08:04Z", "creator": "fhanik@apache.org", "creation_time": "2011-01-27T17:08:04Z", "text": "(In reply to comment #2)\n> I am in favor of using the context's WebappClassLoader when configuring a JNDI\n> DataSource defined in context.xml.\n\nYes, but this can cause problems when you use a global data source"}, {"count": 4, "tags": [], "text": "(In reply to comment #2)\n> I am in favor of using the context's WebappClassLoader when configuring a JNDI\n> DataSource defined in context.xml.\n\nNote, that context.xml is being read before WebappClassLoader is started.", "is_private": false, "id": 143739, "creation_time": "2011-01-27T17:14:01Z", "time": "2011-01-27T17:14:01Z", "creator": "knst.kolinko@gmail.com", "bug_id": 50664, "attachment_id": null}]