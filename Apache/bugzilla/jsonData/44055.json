[{"count": 0, "tags": [], "bug_id": 44055, "attachment_id": null, "text": "I\u2019ve been using  org.apache.poi.hsmf.MAPIMessage to handle reading the contents\nof Outlook MSG files and I noticed that for some reason there was no accessor\nmethod for getting at the \u201cFROM\u201d field.\n\nI\u2019m not sure if this was omitted for a reason but its absence seemed strange so\nI decided to try and add it.\n\nI gleaned from the HSMF javadoc that the various fields in a MSG file can be\nidentified by looking for OLE nodes with the following name\n\n__substg1.0_<chunk_id><chunk_type>\n\nWhere <chunk_type> is an arbitrary HEX code indicating what data type the\nproperty has and <chunk_id> is an arbitrary HEX code that identifies each property.\n\nI did some searching through some sample MSG files and narrowed down the FROM\nfield to one of the following two chunk Ids:  0x0042 or 0x0C1A\nBoth seemed to work equally well in the files I tested on.\n\nThis patch contains the following changes:\n\n-\tAdded \u201cdisplayFromChunk\u201d to instance to org.apache.poi.hsmf.datatypes.Chunks\n-\tAdded \u201cgetDispalyFrom\u201d accessor method to org.apache.poi.hsmf.MAPIMessage\n-\tAdded a method to org.apache.poi.hsmf.model.TestBlankFileRead to test reading\nthe \u201cFROM\u201d field\n-\tAdded a method to org.apache.poi.hsmf.model.TestSimpleFileRead to test reading\nthe \u201cFROM\u201d field\n\nI also added an overloaded constructor to MAPIMessage that takes in an\nInputStream (as opposed to just a file name).  This change had nothing to do\nwith the accessing the \u201cFROM\u201d field but was useful for the interface I was\nimplementing and didn\u2019t seem to cost anything in terms of extra complexity in\nthe code.", "id": 111637, "time": "2007-12-11T08:02:16Z", "creator": "mike.taylor@bpsserver.com", "creation_time": "2007-12-11T08:02:16Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 44055, "is_private": false, "id": 111638, "attachment_id": 21257, "creator": "mike.taylor@bpsserver.com", "creation_time": "2007-12-11T08:04:07Z", "time": "2007-12-11T08:04:07Z", "text": "Created attachment 21257\nPatch to add access to the FROM field of an Outlook MSG file\n\n-\tAdded \u201cdisplayFromChunk\u201d to instance to\norg.apache.poi.hsmf.datatypes.Chunks\n-\tAdded \u201cgetDispalyFrom\u201d accessor method to\norg.apache.poi.hsmf.MAPIMessage\n-\tAdded a method to org.apache.poi.hsmf.model.TestBlankFileRead to test\nreading the \u201cFROM\u201d field\n-\tAdded a method to org.apache.poi.hsmf.model.TestSimpleFileRead to test\nreading the \u201cFROM\u201d field"}, {"count": 2, "tags": [], "bug_id": 44055, "is_private": false, "id": 111760, "attachment_id": null, "creator": "apache@gagravarr.org", "creation_time": "2007-12-13T06:57:46Z", "time": "2007-12-13T06:57:46Z", "text": "Thanks for this. We'll wait on Travis (who wrote the existing outlook code) to\ncheck it over before committing."}, {"count": 3, "tags": [], "bug_id": 44055, "attachment_id": null, "text": "Thanks for this, committed", "id": 111980, "time": "2007-12-21T04:16:55Z", "creator": "apache@gagravarr.org", "creation_time": "2007-12-21T04:16:55Z", "is_private": false}]