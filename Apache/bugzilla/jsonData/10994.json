[{"count": 0, "tags": [], "bug_id": 10994, "is_private": false, "text": "FTP chmod from Windows to UNIX-style environment does not work. Verbose output \nof the execution of this task shows ant attempting to chmod remote files using \nWindows style separator (\"\\\") instead of the UNIX-style (\"/\") separator. I \nnoticed a potential problem in the optional task FTP.java file, which I will \ncover at the bottom of this message. Here is stripped down ant script which I \ncan use to duplicate the problem. Note that you must be executing from Windows \nto the target environment requiring \"/\" separators.\n\nEXAMPLE SCRIPT:\n<target name=\"chmod\">\n    <ftp action=\"chmod\"\n        server=\"${remote.server}\"\n        remotedir=\"${target.dir}\"\n        userid=\"${remote.username}\"\n        password=\"${remote.password}\"\n        separator=\"/\"\n        chmod=\"775\"\n    >\n        <fileset>\n            <include name=\"**/*\"/>\n        </fileset>\n    </ftp>\n</target>\n\nLooking in FTP.java source, I noticed recursive FTP.FTPDirectoryScanner.scandir\n() method implements hard-coded File.separator as path separator, where I would \nhave expected the FTP instance attribute remoteFileSep (which I set in script) \nto be used instead. Obviously, since I am executing the script on Windows, the \nFile.separator will be Windows style, but we are doing our directory scan for \nremote platform. As an interim solution I replaced the File.separator \noccurances w/ remoteFileSep, and it works. Of course, I don't feel good about \nthis because I don't know if I'm breaking something else, but it seems like \nscandir() is only used against remote platform.\n\nA possibly separate, but related bug: following ftp \"put/send\" script does not \nwork for same reason; that is, verbose output shows windows separators for \nchmod on remote machine. The interim fix above did not fix this.\n\nEXAMPLE SCRIPT:\n<target>\n    <ftp server=\"${remote.server}\"\n        remotedir=\"${target.dir}\"\n        userid=\"${remote.username}\"\n        password=\"${remote.password}\"\n        binary=\"no\"\n        action=\"put\"\n        chmod=\"775\"\n        verbose=\"yes\"\n        depends=\"no\"\n        ignoreNoncriticalErrors=\"true\"\n    >\n        <fileset dir=\"${deploy.dir}\">\n            <!-- xfer these files in ascii -->\n            <include name=\"**/CHILDCARE.webapp\"/>\n            <include name=\"**/version.txt\"/>\n            <include name=\"**/gass.properties\"/>\n            <include name=\"**/user.profiles\"/>\n        </fileset>\n    </ftp>\n</target>", "id": 19871, "time": "2002-07-19T19:51:22Z", "creator": "cmcfarland@onebox.com", "creation_time": "2002-07-19T19:51:22Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "sbailliez@apache.org", "attachment_id": null, "text": "\n\n*** This bug has been marked as a duplicate of 11044 ***", "id": 21131, "time": "2002-08-15T22:14:23Z", "bug_id": 10994, "creation_time": "2002-08-15T22:14:23Z", "is_private": false}]