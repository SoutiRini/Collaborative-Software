[{"count": 0, "tags": [], "creator": "kasala.asha@gmail.com", "attachment_id": null, "text": "In the code below the cell gets corrupted when we call setCellStyle on it after calling cloneStyleFrom and setBorderBottom.In the generated file right click on the cell to which the style was applied to notice that the \"Format cells \" dialog doesnot come up.\n\n  import org.apache.poi.hssf.usermodel.*;\n  import org.apache.poi.ss.usermodel.*;\n\n   import java.io.FileOutputStream;\n   import java.io.IOException;\n\n  /**\n    * Demonstrates how to create borders around cells.\n    *\n   * @author Glen Stampoultzis (glens at apache.org)\n    */\n   public class Borders\n  \t  {\n      public static void main(String[] args)\n          throws IOException\n  \t      {\n          HSSFWorkbook wb = new HSSFWorkbook();\n          HSSFSheet sheet = wb.createSheet(\"new sheet\");\n\n          // Create a row and put some cells in it. Rows are 0 based.\n          HSSFRow row = sheet.createRow((short) 1);\n\n          // Create a cell and put a value in it.\n          HSSFCell cell = row.createCell((short) 1);\n          cell.setCellValue(4);\n\n          CellStyle def = cell.getCellStyle();\n          // Style the cell with borders all around.\n          HSSFCellStyle style = wb.createCellStyle();\n          style.cloneStyleFrom(def);\n          style.setBorderBottom(HSSFCellStyle.BORDER_THIN);\n\n          cell.setCellStyle(style);\n\n          // Write the output to a file\n          FileOutputStream fileOut = new FileOutputStream(\"workbook.xls\");\n          wb.write(fileOut);\n          fileOut.close();\n      }\n  }", "id": 166868, "time": "2013-04-26T07:00:32Z", "bug_id": 54894, "creation_time": "2013-04-26T07:00:32Z", "is_private": false}, {"count": 1, "tags": [], "creator": "dominik.stadler@gmx.at", "text": "Still happens in current version of Excel, does not happen in OpenOffice, BiffViewer shows the following diff:\n\n--- \n+++ \n@@ -1246,28 +1246,28 @@\n     .alignmentoptions= 20\n           .alignment = 0\n           .wraptext  = false\n           .valignment= 2\n           .justlast  = 0\n           .rotation  = 0\n-    .indentionoptions= 0\n+    .indentionoptions= 2000\n           .indent    = 0\n           .shrinktoft= false\n           .mergecells= false\n           .readngordr= 0\n           .formatflag= false\n           .fontflag  = false\n           .prntalgnmt= false\n-          .borderflag= false\n+          .borderflag= true\n           .paternflag= false\n           .celloption= false\n-    .borderoptns     = 0\n+    .borderoptns     = 1000\n           .lftln     = 0\n           .rgtln     = 0\n           .topln     = 0\n-          .btmln     = 0\n+          .btmln     = 1\n     .paleteoptns     = 0\n           .leftborder= 0\n           .rghtborder= 0\n           .diag      = 0\n     .paleteoptn2     = 0\n           .topborder = 0\n@@ -1542,13 +1542,13 @@\n [/ROW]\n \n Offset=0x00000651(1617) recno=92 sid=0x0203 size=0x000E(14)\n [NUMBER]\n     .row    = 0x0001\n     .col    = 0x0001\n-    .xfindex= 0x000F\n+    .xfindex= 0x0015\n   .value= 4\n [/NUMBER]\n \n Offset=0x00000663(1635) recno=93 sid=0x00D7 size=0x0006(6)\n [DBCELL]\n     .rowoffset = 0x00000026", "id": 169706, "time": "2013-08-26T11:51:07Z", "bug_id": 54894, "creation_time": "2013-08-26T11:51:07Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "dominik.stadler@gmx.at", "text": "I could not reproduce this with latest POI-trunk and Excel in Office 365, so I assume it is either fixed in POI now or it was a bug in Excel itself which is fixed there in later versions of Excel.", "id": 180909, "time": "2015-02-10T16:13:31Z", "bug_id": 54894, "creation_time": "2015-02-10T16:13:31Z", "is_private": false, "attachment_id": null}]