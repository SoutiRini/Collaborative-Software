[{"count": 0, "tags": [], "creator": "daniel_asfbugzilla@danielstephens.com", "text": "I have an XLS file which has been produced by Microsoft Excel 2007 saving in\ncompatibility mode that cannot be loaded by either 3.0-FINAL and 3.0.1-FINAL.\n(It's also worth noting that the file confuses jxl as well, but figuring out how\nto stop that from crashing was far easier). The presence of \"Should not see this\nexception\" leads me to believe that there's a bug lurking within POI.\n\nException in thread \"main\" org.apache.poi.hssf.record.RecordFormatException:\nRecords should handle ContinueRecord internally. Should not see this exception\n        at\norg.apache.poi.hssf.eventusermodel.HSSFEventFactory.genericProcessEvents(HSSFEventFactory.java:195)\n        at\norg.apache.poi.hssf.eventusermodel.HSSFEventFactory.processEvents(HSSFEventFactory.java:102)\n\nI'll try and attach the problem spreadsheet (narrowed down as much as possible)\nand/or a biffdump from it, if I fail it's available via email request.\n\n(I'm using the POI builds from the maven repository, with sun a variety of Sun\n1.4.2 JVM's)", "id": 105226, "time": "2007-07-09T14:09:34Z", "bug_id": 42844, "creation_time": "2007-07-09T14:09:34Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "text": "Created attachment 20482\nXLS file which causes POI to fail with internal error\n\nThis is a minimal file that causes the internal error in POI.\n\nThe problem may well be related to AutoFilter since turning that off causes it\nto no longer fail.", "is_private": false, "id": 105227, "creator": "daniel_asfbugzilla@danielstephens.com", "time": "2007-07-09T14:21:50Z", "bug_id": 42844, "creation_time": "2007-07-09T14:21:50Z", "attachment_id": 20482}, {"count": 2, "tags": [], "text": "I also encountered such problem. But in my excel file, even if I close\nAutoFilter, it still exists. After I check the source codes, I find that in\nprocessEvents, there is no place to deal with ContinueRecord in event model. Not\nlike user model, it deals with ContinueRecords in RecordFactory.CreateRecords.\nSo I guess it may miss some handler codes here. Otherwise, if the\nRecordInputStream contains ContinueRecords, it will surely invoke such kind of\nexception.", "is_private": false, "id": 106412, "creator": "fudanxd@gmail.com", "time": "2007-08-06T15:18:15Z", "bug_id": 42844, "creation_time": "2007-08-06T15:18:15Z", "attachment_id": null}, {"count": 3, "tags": [], "text": "This should now be fixed in svn. As suggested, ContinueRecord special cases\nsimilar to in RecordFactory have been added", "is_private": false, "id": 107178, "creator": "apache@gagravarr.org", "time": "2007-08-23T11:22:59Z", "bug_id": 42844, "creation_time": "2007-08-23T11:22:59Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 42844, "text": "The fix for this bug does not account for all error cases.  I am attaching a\ndocument for which the code fails.  I found that the problem with this document\nis the print area defined.  If you unset the print area, POI parses this\ndocument correctly.  Also, if you re-set the print area to something like 2\ncells, POI parses the document fine.  I stepped through the POI code using the\ndebugger and found the error occurs on a Continue Record that occurs after an\nUnknown Record with sid 77.", "id": 108033, "time": "2007-09-11T10:14:22Z", "creator": "swaziruddin@gmail.com", "creation_time": "2007-09-11T10:14:22Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 42844, "text": "Created attachment 20790\nExcel file with print area that causes RecordFormatException", "id": 108034, "time": "2007-09-11T10:15:25Z", "creator": "swaziruddin@gmail.com", "creation_time": "2007-09-11T10:15:25Z", "is_private": false, "attachment_id": 20790}, {"count": 6, "tags": [], "text": "I see what's missing.\nWe borrowed the code from RecordFactory.CreateRecords but forgot to handle\nunknown records that happen to be continued.\n\nIn RecordFactory.CreateRecords this piece of code looks as follows:\n\n  if (lastRecord instanceof UnknownRecord) {\n    //Gracefully handle records that we dont know about,\n    //that happen to be continued\n    records.add(record);\n  } else \n    throw new RecordFormatException(\"Unhandled Continue Record\");\n  }\n\n\nIn HSSFEventFactory it should be like this:\n\n  if (rec instanceof UnknownRecord) {\n     ;//silently skip records we don't know about\n  } else {\n    throw new RecordFormatException(\"Records should handle ContinueRecord\ninternally. Should not see this exception\");\n  }\n\nWith this change it works without complains. I included the provided excel file\nin the unit test. \n\nRegards,\nYegor\n", "is_private": false, "id": 108166, "creator": "yegor@dinom.ru", "time": "2007-09-13T12:11:43Z", "bug_id": 42844, "creation_time": "2007-09-13T12:11:43Z", "attachment_id": null}, {"count": 7, "tags": [], "text": "Created attachment 21824\nFailed excel file", "attachment_id": 21824, "id": 115659, "creator": "skostyukevich@gmail.com", "time": "2008-04-17T04:13:07Z", "bug_id": 42844, "creation_time": "2008-04-17T04:13:07Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 42844, "attachment_id": null, "text": "Fails on poi-bin-3.0.2-FINAL-20080204.zip event", "id": 115660, "time": "2008-04-17T04:15:03Z", "creator": "skostyukevich@gmail.com", "creation_time": "2008-04-17T04:15:03Z", "is_private": false}, {"count": 9, "attachment_id": null, "creator": "apache@gagravarr.org", "text": "Could you please try with 3.1 beta 1 (should be hitting the mirrors tomorrow or the day after), and see if that fixes it for you? I think it should do, but please re-open the bug if not.", "id": 115926, "time": "2008-04-27T11:03:51Z", "bug_id": 42844, "creation_time": "2008-04-27T11:03:51Z", "tags": [], "is_private": false}]