[{"count": 0, "tags": [], "creator": "chip@force-elite.com", "attachment_id": null, "is_private": false, "id": 137879, "time": "2010-06-25T02:21:57Z", "bug_id": 49498, "creation_time": "2010-06-25T02:21:57Z", "text": "'crashing' configuration:\n\nSSLCipherSuite ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL\nSSLProtocol all -SSLv2\nSSLSessionCache        \"shmcb:/opt/httpd/logs/ssl_scache(512000)\"\nSSLSessionCacheTimeout  300\nSSLStaplingCache \"dbm:/opt/httpd/logs/stapling_cache\"\n\n<VirtualHost *:443>\n  ServerName local.example.com\n\n  SSLEngine on\n  SSLUseStapling on\n  SSLCertificateFile    /opt/httpd/conf/exmaple.crt\n  SSLCertificateKeyFile /opt/httpd/conf/example.key\n  SSLCertificateChainFile /opt/httpd/conf/gd_intermediate.crt\n\n</VirtualHost>\n\n\nMoving SSLUseStapling on to the GLOBAL scope is a workaround to the crash.\n\nThe bug is in the initialization of global mutex for stapling, if SSL Stapling is only enabled inside a vhost, the mutex is not initialized, and on the first attempt to call the OCSP stapling callback, the server will crash."}, {"count": 1, "tags": [], "bug_id": 49498, "attachment_id": null, "text": "Fixed in r1023821", "id": 140800, "time": "2010-10-18T10:48:05Z", "creator": "steve@openssl.org", "creation_time": "2010-10-18T10:48:05Z", "is_private": false}, {"count": 2, "tags": [], "creator": "rob@comodo.com", "attachment_id": null, "is_private": false, "id": 140853, "time": "2010-10-20T07:51:45Z", "bug_id": 49498, "creation_time": "2010-10-20T07:51:45Z", "text": "Thanks Steve.  I ran into this problem the other day and I can confirm that r1023821 fixes it for me.\n\nHowever, I did spot some warnings when compiling httpd 2.3-HEAD against both OpenSSL 1.0.0a and OpenSSL CVS-HEAD (but not when compiling against a recent OpenSSL 0.9.x).  I just added bug 50121 and proposed a patch.\n\nA quick question, if I may:\nCould \"SSLUseStapling\" be changed to \"SSLDisableStapling\", so that Stapling is enabled by default (rather than disabled by default)?\n\nAlso, I hear that there's an approximately zero chance of Stapling being backported to httpd-2.2.x.  I think that this is a shame."}, {"count": 3, "tags": [], "creator": "asfbugz@velox.ch", "attachment_id": null, "text": "Fixed as per comment 1.", "id": 149726, "time": "2011-09-25T16:02:25Z", "bug_id": 49498, "creation_time": "2011-09-25T16:02:25Z", "is_private": false}]