[{"count": 0, "tags": [], "creator": "felix.yang@oracle.com", "attachment_id": null, "id": 192390, "time": "2016-07-15T06:03:18Z", "bug_id": 59860, "creation_time": "2016-07-15T06:03:18Z", "is_private": false, "text": "org.apache.tools.ant.taskdefs.rmic.SunRmic.java tries to instance sun.rmi.rmic.Main. But because of JDK 9 changes for modularization (project Jigsaw), sun.rmi.rmic.Main is not visible by default. It has been refactored into a system module named jdk.rmic and package sun.rmi.rmic is not exported.\n\nSee http://hg.openjdk.java.net/jdk9/dev/jdk/file/4729dcda8ea8/src/jdk.rmic/share/classes/module-info.java\n\nSo tests in RmicAdvancedTest will fail with ClassNotFoundException. This can be workaround by specify following arguments to java\n\"-addmods jdk.rmic -XaddExports:jdk.rmic/sun.rmi.rmic=ALL-UNNAMED\"\nor \n\"-addmods ALL-SYSTEM -XaddExports:jdk.rmic/sun.rmi.rmic=ALL-UNNAMED\"\n\nThese Jigsaw changes are not finalized. The workaround above can be changed later."}, {"count": 1, "tags": [], "bug_id": 59860, "attachment_id": null, "text": "The test failing is only a symptom, the rmic task itself won't work unless you add the workarounds when starting Ant.\n\nApart from skipping the test when running on JDK9+ the proper fix probably is to make \"forking\" the default implementation on JDK9+ and document that \"sun\" won't work for JDK9+. And probably detect a constellation like this at runtime and provide a useful error message.", "id": 192589, "time": "2016-07-24T05:40:34Z", "creator": "bodewig@apache.org", "creation_time": "2016-07-24T05:40:34Z", "is_private": false}, {"count": 2, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 192599, "time": "2016-07-24T11:18:42Z", "bug_id": 59860, "creation_time": "2016-07-24T11:18:42Z", "is_private": false, "text": "Felix, is there some special handling of com.sun.tools.javac.Main expected or will <javac> be broken soon as well?"}, {"count": 3, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 192624, "time": "2016-07-25T14:23:55Z", "bug_id": 59860, "creation_time": "2016-07-25T14:23:55Z", "is_private": false, "text": "Fixed with git commit fdfebe8\n\nnote that rmic -Xnew causes strange error messages and still fails (I'm sure I've reported this every time I tested any jdk9 build).\n\nI'm worried about \"com.sun.tools.javac.Main\" used in <javac> and \"com.sun.tools.javah.oldjavah.Main\" used in <javah> - in particular since we don't seem to have a decent test coverage for the later."}, {"count": 4, "tags": [], "creator": "felix.yang@oracle.com", "text": "For the issue of \"rmic -Xnew\", please refer to following two bugs:\n1. https://bugs.openjdk.java.net/browse/JDK-8129341\nIt commented \"The -Xnew option was never documented and was never supported. Any dependencies on -Xnew should be removed. Closing this as Not an Issue.\"\n\n2. Remove rmic -Xnew, https://bugs.openjdk.java.net/browse/JDK-8146299", "id": 192679, "time": "2016-07-28T01:21:07Z", "bug_id": 59860, "creation_time": "2016-07-28T01:21:07Z", "is_private": false, "attachment_id": null}, {"count": 5, "attachment_id": null, "bug_id": 59860, "text": "Thank you Felix, I've opened Bug 59906 to track this.", "id": 192681, "time": "2016-07-28T05:43:53Z", "creator": "bodewig@apache.org", "creation_time": "2016-07-28T05:43:53Z", "tags": [], "is_private": false}]