[{"count": 0, "tags": [], "bug_id": 36851, "text": "File names which contain multi-byte characters are not handled properly by the\nsupporting classes of Ant's <tar> Task.  These classes treat characters as\nbytes, which is not a valid assumption for non-ASCII characters (e.g. Japanese,\nKorean, Chinese, etc.).  This problem was first noticed against the 1.5.4\nrelease, but I've determined that it exists in today's HEAD, and has probably\nexisted since Stefano/Conor first added this code.\n\n\nSteps to reproduce:\n===================\n1. Create a file whose name contains Japanese characters, encoded as UTF-8.\n2. Invoke the <tar> task on that file, either programmatically or via a\nbuild.xml file, using the GNU tar long file names extension longfile=\"gnu\".\n\n\nObserved behavior:\n==================\nYou're greated with the error message:\n\nProblem creating TAR: request to write '125' bytes exceeds size in header of\n'104' bytes\n\nRe-running Ant with -verbose/-debug will produce the following stack trace\n(using Ant 1.5.4):\n\n--- Nested Exception ---\njava.io.IOException: request to write '125' bytes exceeds size in header of\n'104' bytes\n        at org.apache.tools.tar.TarOutputStream.write(TarOutputStream.java:274)\n        at org.apache.tools.tar.TarOutputStream.write(TarOutputStream.java:256)\n        at\norg.apache.tools.tar.TarOutputStream.putNextEntry(TarOutputStream.java:184)\n        at org.apache.tools.ant.taskdefs.Tar.tarFile(Tar.java:410)\n        at org.apache.tools.ant.taskdefs.Tar.execute(Tar.java:322)\n\n(I'll attach a patch against HEAD which shows a couple of the problem areas, but\nis untested.)\n\n\nExpected behavior:\n==================\nAs with GNU tar, archiving and unpacking of this data should be handled without\nerror.\n\n\nCurrent work-around:\n====================\nFork gtar from Ant.", "id": 80575, "time": "2005-09-29T01:00:26Z", "creator": "dlr@apache.org", "creation_time": "2005-09-29T01:00:26Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 36851, "attachment_id": 16547, "id": 80576, "time": "2005-09-29T01:06:58Z", "creator": "dlr@apache.org", "creation_time": "2005-09-29T01:06:58Z", "is_private": false, "text": "Created attachment 16547\nTweaks illustrating a couple of the problem areas\n\nMuch like the file name used in TarEntry.writeEntryHeader(), the userId,\ngroupId, linkName, magic, userName, and groupName may need similar adjustments\nto avoid possible erroneous one-to-one mappings from their characters to bytes.\n\n\nThis patch assumes that the getBytes() call will use a character encoding like\nUTF-8, and that the file names are using the same encoding.  This assumption\nwill likely often be false for the use case described by this issue."}, {"count": 2, "tags": [], "bug_id": 36851, "attachment_id": null, "id": 120667, "creation_time": "2008-09-16T03:04:13Z", "time": "2008-09-16T03:04:13Z", "creator": "bodewig@apache.org", "text": "*** Bug 41455 has been marked as a duplicate of this bug. ***", "is_private": false}, {"count": 3, "tags": [], "bug_id": 36851, "text": "With svn revision 1350857 the infrastructure for proper handling of encoding is there, the task doesn't use it, though.\n\nThe only real way to handle characters other than ASCII is to use PAX extension headers (which explicitly use UTF-8), any other approach is non-portable or will only work if filename-encoding of source and target machine match.", "id": 160052, "time": "2012-06-17T05:14:26Z", "creator": "bodewig@apache.org", "creation_time": "2012-06-17T05:14:26Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 36851, "attachment_id": null, "id": 183498, "time": "2015-06-13T02:38:00Z", "creator": "nestynasab@gmail.com", "creation_time": "2015-06-13T02:38:00Z", "is_private": false, "text": "I think you need to try this Long Path Tool in this situation. I hope that it helps."}, {"count": 5, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "text": "Good that ernesto commented, so I was reminded of the ticket :-)\n\nAnt 1.9.5 finally added a proper encoding attribute to tar, untar, tarfileset.", "id": 183504, "time": "2015-06-13T03:42:10Z", "bug_id": 36851, "creation_time": "2015-06-13T03:42:10Z", "is_private": false}]