[{"count": 0, "tags": [], "text": "Currently, OCSP Stapling is disabled by default.  To enable it, the \"SSLUseStapling On\" directive must be added to the config, along with another directive that enables an OCSP Stapling Cache.\n\nOCSP Stapling benefits pretty much everyone:\n  - End-users: Improved privacy and faster SSL/TLS handshakes, because the client software does not need to contact a third-party OCSP Responder to get the current status of the end-entity certificate.\n  - CAs: Decreased load, bandwidth requirements and cost for operating an OCSP Responder infrastructure.\n  - Websites: No direct benefits, but they often care about their end-users' interests.\n\nMy concern is that many webmasters will not add the necessary config directives to enable OCSP Stapling, even though there is no downside to enabling it.  I imagine that many webmasters have probably never even heard of OCSP Stapling!\n\nTherefore, I propose that mod_ssl should enable OCSP Stapling by default, without any config directives needing to be specified.  (Aside: this would match the behaviour of IIS 7.x on Windows Vista/2008 Server and newer).\n\nThe OCSP Stapling Cache would need to be created automatically with some sensible default values.", "attachment_id": null, "bug_id": 50740, "id": 144080, "time": "2011-02-09T04:13:09Z", "creator": "rob@comodo.com", "creation_time": "2011-02-09T04:13:09Z", "is_private": false}, {"count": 1, "tags": [], "creator": "rob@comodo.com", "attachment_id": null, "is_private": false, "id": 144081, "time": "2011-02-09T04:17:29Z", "bug_id": 50740, "creation_time": "2011-02-09T04:17:29Z", "text": "Opinions stated on httpd-dev:\n\nSteve Henson wrote (on 22nd Dec 2010):\n\"...the code hasn't been tested extensively 'in the field' so there may be problems that have yet to be uncovered.\nMy personal opinion would be to, at least initially, require an explicit directive to enable it and leave the option in future to have it enabled by default.\"\n\nIgor Gali\u0107 replied (on 24th Dec 2010):\n\"If we want to see more extensive testing in the field, then this is the right time to make 'On' the default.\""}, {"count": 2, "tags": [], "creator": "jorton@redhat.com", "is_private": false, "text": "Does it work?   Does the caching work?  I'd like to see results of people testing the code in anger before inflicting it on the masses.", "id": 144083, "time": "2011-02-09T04:26:16Z", "bug_id": 50740, "creation_time": "2011-02-09T04:26:16Z", "attachment_id": null}, {"count": 3, "attachment_id": null, "creator": "rob@comodo.com", "is_private": false, "id": 144088, "time": "2011-02-09T04:47:00Z", "bug_id": 50740, "creation_time": "2011-02-09T04:47:00Z", "tags": [], "text": "(In reply to comment #2)\n> I'd like to see results of people testing the code in anger before inflicting\n> it on the masses.\n\nDon't \"the masses\" generally avoid development branches (such as 2.3.x)?"}, {"count": 4, "attachment_id": null, "creator": "koichi.sugimoto@globalsign.co.jp", "is_private": false, "id": 146909, "time": "2011-06-07T02:54:31Z", "bug_id": 50740, "creation_time": "2011-06-07T02:54:31Z", "tags": [], "text": "I've now been investigating if the stapling correctry works.\nThe build successfully conpleted and the apache process invoked without error.\nBut when I access to the apache via IE8 and firefox 3.5, no OCSP request comes from the apache.\n\nThe browser's behaviour:\nIE8 directly requests to the OCSP responder.\nFirefox shows \"Invalid OCSP signing certificate in OCSP response.\" and stops the connection.\n\nThe following is my environment:\nThe version of the apache is httpd-2.3.12-beta.\nThe openssl version is 1.0.0.\nThe OS is CentOS 5.\n\nThe corresponding configuration has the following fields:\nSSLStaplingCache dbm:/tmp/staples\nSSLUseStapling on\nSSLCACertificateFile \"/usr/local/apache_ocsp/conf/server-ca.crt\"\n\n\nThe following error log was generated by the apache:\n[Mon Jun 06 19:01:50.275314 2011] [ssl:error] [pid 17404:tid 3075525520] stapling_check_response: response times invalid\n[Mon Jun 06 19:01:50.275376 2011] [ssl:error] [pid 17404:tid 3075525520] stapling_renew_response: error in retreived response!\n[Mon Jun 06 19:01:50.275394 2011] [ssl:error] [pid 17404:tid 3075525520] stapling_cache_response: OCSP response session store error!\n[Mon Jun 06 19:01:50.275404 2011] [ssl:error] [pid 17404:tid 3075525520] stapling_renew_response: error caching response!\n\nAfter that I've adjusted the machine time, but nothing changed.\n\nIs there any code fix required ?\nOr some additional setting ?"}, {"count": 5, "attachment_id": null, "bug_id": 50740, "text": "(In reply to comment #4)\n> I've now been investigating if the stapling correctry works.\n> The build successfully conpleted and the apache process invoked without error.\n> But when I access to the apache via IE8 and firefox 3.5, no OCSP request comes\n> from the apache.\n> \n> The browser's behaviour:\n> IE8 directly requests to the OCSP responder.\n\nWhat version of Windows are you using?\nIE8 on XP doesn't support OCSP Stapling.\n\n> Firefox shows \"Invalid OCSP signing certificate in OCSP response.\" and stops\n> the connection.\n\nNo version of Firefox supports OCSP Stapling yet.\n\n<snip>\n> The following error log was generated by the apache:\n> [Mon Jun 06 19:01:50.275314 2011] [ssl:error] [pid 17404:tid 3075525520]\n> stapling_check_response: response times invalid\n\nI wonder if the \"response times invalid\" error from Apache and the \"Invalid OCSP signing certificate\" error from Firefox are related.\n\nHas your OCSP Signing Certificate expired, by any chance?\n\nIs your httpd-2.3.12-beta server publicly accessible?", "id": 146992, "time": "2011-06-09T12:18:05Z", "creator": "rob@comodo.com", "creation_time": "2011-06-09T12:18:05Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "bug_id": 50740, "text": "(In reply to comment #5)\n> What version of Windows are you using?\n> IE8 on XP doesn't support OCSP Stapling.\n\nIE8 on Windows7 I used.\n\n> > Firefox shows \"Invalid OCSP signing certificate in OCSP response.\" and stops\n> > the connection.\n> No version of Firefox supports OCSP Stapling yet.\n\nOK.\nI see.\n\n> > The following error log was generated by the apache:\n> > [Mon Jun 06 19:01:50.275314 2011] [ssl:error] [pid 17404:tid 3075525520]\n> > stapling_check_response: response times invalid\n> I wonder if the \"response times invalid\" error from Apache and the \"Invalid\n> OCSP signing certificate\" error from Firefox are related.\n> Has your OCSP Signing Certificate expired, by any chance?\n> Is your httpd-2.3.12-beta server publicly accessible?\n\nSorry, my server is at local.\nI'm sure that the certificate is valid.\nBut my ocsp responder is integrated type.\n  http://www.ietf.org/id/draft-ietf-pkix-rfc2560bis-03.txt\n\nDoes the apache support this type of ocsp responder?\nThe following is the dump of my ocsp response:\n\nE:\\Public>openssl asn1parse -in resp.der -inform der -offset 30\n    0:d=0  hl=4 l=2297 cons: SEQUENCE\n    4:d=1  hl=3 l= 168 cons: SEQUENCE\n    7:d=2  hl=2 l=  22 cons: cont [ 2 ]\n    9:d=3  hl=2 l=  20 prim: OCTET STRING      [HEX DUMP]:98B84D5851AC6AC878CEF3\n6D603630F42F376AC6\n   31:d=2  hl=2 l=  15 prim: GENERALIZEDTIME   :20300610125444Z\n   48:d=2  hl=2 l=  88 cons: SEQUENCE\n   50:d=3  hl=2 l=  86 cons: SEQUENCE\n   52:d=4  hl=2 l=  65 cons: SEQUENCE\n   54:d=5  hl=2 l=   9 cons: SEQUENCE\n   56:d=6  hl=2 l=   5 prim: OBJECT            :sha1\n   63:d=6  hl=2 l=   0 prim: NULL\n   65:d=5  hl=2 l=  20 prim: OCTET STRING      [HEX DUMP]:45C673D23D1D36BF2BC964\nCEDEEAF31633815019\n   87:d=5  hl=2 l=  20 prim: OCTET STRING      [HEX DUMP]:98B84D5851AC6AC878CEF3\n6D603630F42F376AC6\n  109:d=5  hl=2 l=   8 prim: INTEGER           :233EBDF465BFE99F\n  119:d=4  hl=2 l=   0 prim: cont [ 0 ]\n  121:d=4  hl=2 l=  15 prim: GENERALIZEDTIME   :20300610125444Z\n  138:d=2  hl=2 l=  35 cons: cont [ 1 ]\n  140:d=3  hl=2 l=  33 cons: SEQUENCE\n  142:d=4  hl=2 l=  31 cons: SEQUENCE\n  144:d=5  hl=2 l=   9 prim: OBJECT            :OCSP Nonce\n  155:d=5  hl=2 l=  18 prim: OCTET STRING      [HEX DUMP]:0410C4CC2C3B761AB9D2AB\nEB781E9D5A23C1\n  175:d=1  hl=2 l=  13 cons: SEQUENCE\n  177:d=2  hl=2 l=   9 prim: OBJECT            :sha1WithRSAEncryption\n  188:d=2  hl=2 l=   0 prim: NULL\n  190:d=1  hl=4 l= 257 prim: BIT STRING\n  451:d=1  hl=4 l=1846 cons: cont [ 0 ]\n  455:d=2  hl=4 l=1842 cons: SEQUENCE\n  459:d=3  hl=4 l= 984 cons: SEQUENCE\n  463:d=4  hl=4 l= 704 cons: SEQUENCE\n  467:d=5  hl=2 l=   3 cons: cont [ 0 ]\n  469:d=6  hl=2 l=   1 prim: INTEGER           :02\n  472:d=5  hl=2 l=   8 prim: INTEGER           :583314EC6A82AAEF\n  482:d=5  hl=2 l=  13 cons: SEQUENCE\n  484:d=6  hl=2 l=   9 prim: OBJECT            :sha1WithRSAEncryption\n  495:d=6  hl=2 l=   0 prim: NULL\n  497:d=5  hl=2 l=  71 cons: SEQUENCE\n  499:d=6  hl=2 l=  20 cons: SET\n  501:d=7  hl=2 l=  18 cons: SEQUENCE\n  503:d=8  hl=2 l=   3 prim: OBJECT            :commonName\n  508:d=8  hl=2 l=  11 prim: PRINTABLESTRING   :TestRootCA1\n  521:d=6  hl=2 l=  13 cons: SET\n  523:d=7  hl=2 l=  11 cons: SEQUENCE\n  525:d=8  hl=2 l=   3 prim: OBJECT            :organizationalUnitName\n  530:d=8  hl=2 l=   4 prim: PRINTABLESTRING   :Test\n  536:d=6  hl=2 l=  19 cons: SET\n  538:d=7  hl=2 l=  17 cons: SEQUENCE\n  540:d=8  hl=2 l=   3 prim: OBJECT            :organizationName\n  545:d=8  hl=2 l=  10 prim: PRINTABLESTRING   :GlobalSign\n  557:d=6  hl=2 l=  11 cons: SET\n  559:d=7  hl=2 l=   9 cons: SEQUENCE\n  561:d=8  hl=2 l=   3 prim: OBJECT            :countryName\n  566:d=8  hl=2 l=   2 prim: PRINTABLESTRING   :JP\n  570:d=5  hl=2 l=  30 cons: SEQUENCE\n  572:d=6  hl=2 l=  13 prim: UTCTIME           :080422084249Z\n  587:d=6  hl=2 l=  13 prim: UTCTIME           :130421084249Z\n  602:d=5  hl=2 l=  78 cons: SEQUENCE\n  604:d=6  hl=2 l=  27 cons: SET\n  606:d=7  hl=2 l=  25 cons: SEQUENCE\n  608:d=8  hl=2 l=   3 prim: OBJECT            :commonName\n  613:d=8  hl=2 l=  18 prim: PRINTABLESTRING   :TestSubordinateCA1\n  633:d=6  hl=2 l=  13 cons: SET\n  635:d=7  hl=2 l=  11 cons: SEQUENCE\n  637:d=8  hl=2 l=   3 prim: OBJECT            :organizationalUnitName\n  642:d=8  hl=2 l=   4 prim: PRINTABLESTRING   :Test\n  648:d=6  hl=2 l=  19 cons: SET\n  650:d=7  hl=2 l=  17 cons: SEQUENCE\n  652:d=8  hl=2 l=   3 prim: OBJECT            :organizationName\n  657:d=8  hl=2 l=  10 prim: PRINTABLESTRING   :GlobalSign\n  669:d=6  hl=2 l=  11 cons: SET\n  671:d=7  hl=2 l=   9 cons: SEQUENCE\n  673:d=8  hl=2 l=   3 prim: OBJECT            :countryName\n  678:d=8  hl=2 l=   2 prim: PRINTABLESTRING   :JP\n  682:d=5  hl=4 l= 290 cons: SEQUENCE\n  686:d=6  hl=2 l=  13 cons: SEQUENCE\n  688:d=7  hl=2 l=   9 prim: OBJECT            :rsaEncryption\n  699:d=7  hl=2 l=   0 prim: NULL\n  701:d=6  hl=4 l= 271 prim: BIT STRING\n  976:d=5  hl=3 l= 192 cons: cont [ 3 ]\n  979:d=6  hl=3 l= 189 cons: SEQUENCE\n  982:d=7  hl=2 l=  29 cons: SEQUENCE\n  984:d=8  hl=2 l=   3 prim: OBJECT            :X509v3 Subject Key Identifier\n  989:d=8  hl=2 l=  22 prim: OCTET STRING      [HEX DUMP]:041498B84D5851AC6AC878\nCEF36D603630F42F376AC6\n 1013:d=7  hl=2 l=  18 cons: SEQUENCE\n 1015:d=8  hl=2 l=   3 prim: OBJECT            :X509v3 Basic Constraints\n 1020:d=8  hl=2 l=   1 prim: BOOLEAN           :255\n 1023:d=8  hl=2 l=   8 prim: OCTET STRING      [HEX DUMP]:30060101FF020100\n 1033:d=7  hl=2 l=  31 cons: SEQUENCE\n 1035:d=8  hl=2 l=   3 prim: OBJECT            :X509v3 Authority Key Identifier\n 1040:d=8  hl=2 l=  24 prim: OCTET STRING      [HEX DUMP]:30168014ABF0A26A74DD4F\n49AF8E2A3CBBA2C89BECBA39A1\n 1066:d=7  hl=2 l=  17 cons: SEQUENCE\n 1068:d=8  hl=2 l=   3 prim: OBJECT            :X509v3 Certificate Policies\n 1073:d=8  hl=2 l=  10 prim: OCTET STRING      [HEX DUMP]:300830060604551D2000\n 1085:d=7  hl=2 l=  68 cons: SEQUENCE\n 1087:d=8  hl=2 l=   3 prim: OBJECT            :X509v3 CRL Distribution Points\n 1092:d=8  hl=2 l=  61 prim: OCTET STRING      [HEX DUMP]:303B3039A037A035863368\n7474703A2F2F67737465636831302E676C6F62616C7369676E2E636F6D2F63726C732F5465737452\n6F6F744341312E63726C\n 1155:d=7  hl=2 l=  14 cons: SEQUENCE\n 1157:d=8  hl=2 l=   3 prim: OBJECT            :X509v3 Key Usage\n 1162:d=8  hl=2 l=   1 prim: BOOLEAN           :255\n 1165:d=8  hl=2 l=   4 prim: OCTET STRING      [HEX DUMP]:03020106\n 1171:d=4  hl=2 l=  13 cons: SEQUENCE\n 1173:d=5  hl=2 l=   9 prim: OBJECT            :sha1WithRSAEncryption\n 1184:d=5  hl=2 l=   0 prim: NULL\n 1186:d=4  hl=4 l= 257 prim: BIT STRING\n 1447:d=3  hl=4 l= 850 cons: SEQUENCE\n 1451:d=4  hl=4 l= 570 cons: SEQUENCE\n 1455:d=5  hl=2 l=   3 cons: cont [ 0 ]\n 1457:d=6  hl=2 l=   1 prim: INTEGER           :02\n 1460:d=5  hl=2 l=   8 prim: INTEGER           :10E30DFE5E06C68A\n 1470:d=5  hl=2 l=  13 cons: SEQUENCE\n 1472:d=6  hl=2 l=   9 prim: OBJECT            :sha1WithRSAEncryption\n 1483:d=6  hl=2 l=   0 prim: NULL\n 1485:d=5  hl=2 l=  71 cons: SEQUENCE\n 1487:d=6  hl=2 l=  20 cons: SET\n 1489:d=7  hl=2 l=  18 cons: SEQUENCE\n 1491:d=8  hl=2 l=   3 prim: OBJECT            :commonName\n 1496:d=8  hl=2 l=  11 prim: PRINTABLESTRING   :TestRootCA1\n 1509:d=6  hl=2 l=  13 cons: SET\n 1511:d=7  hl=2 l=  11 cons: SEQUENCE\n 1513:d=8  hl=2 l=   3 prim: OBJECT            :organizationalUnitName\n 1518:d=8  hl=2 l=   4 prim: PRINTABLESTRING   :Test\n 1524:d=6  hl=2 l=  19 cons: SET\n 1526:d=7  hl=2 l=  17 cons: SEQUENCE\n 1528:d=8  hl=2 l=   3 prim: OBJECT            :organizationName\n 1533:d=8  hl=2 l=  10 prim: PRINTABLESTRING   :GlobalSign\n 1545:d=6  hl=2 l=  11 cons: SET\n 1547:d=7  hl=2 l=   9 cons: SEQUENCE\n 1549:d=8  hl=2 l=   3 prim: OBJECT            :countryName\n 1554:d=8  hl=2 l=   2 prim: PRINTABLESTRING   :JP\n 1558:d=5  hl=2 l=  30 cons: SEQUENCE\n 1560:d=6  hl=2 l=  13 prim: UTCTIME           :080422083552Z\n 1575:d=6  hl=2 l=  13 prim: UTCTIME           :180420083552Z\n 1590:d=5  hl=2 l=  71 cons: SEQUENCE\n 1592:d=6  hl=2 l=  20 cons: SET\n 1594:d=7  hl=2 l=  18 cons: SEQUENCE\n 1596:d=8  hl=2 l=   3 prim: OBJECT            :commonName\n 1601:d=8  hl=2 l=  11 prim: PRINTABLESTRING   :TestRootCA1\n 1614:d=6  hl=2 l=  13 cons: SET\n 1616:d=7  hl=2 l=  11 cons: SEQUENCE\n 1618:d=8  hl=2 l=   3 prim: OBJECT            :organizationalUnitName\n 1623:d=8  hl=2 l=   4 prim: PRINTABLESTRING   :Test\n 1629:d=6  hl=2 l=  19 cons: SET\n 1631:d=7  hl=2 l=  17 cons: SEQUENCE\n 1633:d=8  hl=2 l=   3 prim: OBJECT            :organizationName\n 1638:d=8  hl=2 l=  10 prim: PRINTABLESTRING   :GlobalSign\n 1650:d=6  hl=2 l=  11 cons: SET\n 1652:d=7  hl=2 l=   9 cons: SEQUENCE\n 1654:d=8  hl=2 l=   3 prim: OBJECT            :countryName\n 1659:d=8  hl=2 l=   2 prim: PRINTABLESTRING   :JP\n 1663:d=5  hl=4 l= 290 cons: SEQUENCE\n 1667:d=6  hl=2 l=  13 cons: SEQUENCE\n 1669:d=7  hl=2 l=   9 prim: OBJECT            :rsaEncryption\n 1680:d=7  hl=2 l=   0 prim: NULL\n 1682:d=6  hl=4 l= 271 prim: BIT STRING\n 1957:d=5  hl=2 l=  66 cons: cont [ 3 ]\n 1959:d=6  hl=2 l=  64 cons: SEQUENCE\n 1961:d=7  hl=2 l=  29 cons: SEQUENCE\n 1963:d=8  hl=2 l=   3 prim: OBJECT            :X509v3 Subject Key Identifier\n 1968:d=8  hl=2 l=  22 prim: OCTET STRING      [HEX DUMP]:0414ABF0A26A74DD4F49AF\n8E2A3CBBA2C89BECBA39A1\n 1992:d=7  hl=2 l=  15 cons: SEQUENCE\n 1994:d=8  hl=2 l=   3 prim: OBJECT            :X509v3 Basic Constraints\n 1999:d=8  hl=2 l=   1 prim: BOOLEAN           :255\n 2002:d=8  hl=2 l=   5 prim: OCTET STRING      [HEX DUMP]:30030101FF\n 2009:d=7  hl=2 l=  14 cons: SEQUENCE\n 2011:d=8  hl=2 l=   3 prim: OBJECT            :X509v3 Key Usage\n 2016:d=8  hl=2 l=   1 prim: BOOLEAN           :255\n 2019:d=8  hl=2 l=   4 prim: OCTET STRING      [HEX DUMP]:03020106\n 2025:d=4  hl=2 l=  13 cons: SEQUENCE\n 2027:d=5  hl=2 l=   9 prim: OBJECT            :sha1WithRSAEncryption\n 2038:d=5  hl=2 l=   0 prim: NULL\n 2040:d=4  hl=4 l= 257 prim: BIT STRING", "id": 147016, "time": "2011-06-10T13:10:40Z", "creator": "koichi.sugimoto@globalsign.co.jp", "creation_time": "2011-06-10T13:10:40Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "creator": "rob@comodo.com", "attachment_id": null, "text": "(In reply to comment #6)\n<snip>\n> Sorry, my server is at local.\n> I'm sure that the certificate is valid.\n> But my ocsp responder is integrated type.\n>   http://www.ietf.org/id/draft-ietf-pkix-rfc2560bis-03.txt\n> \n> Does the apache support this type of ocsp responder?\n\nApache shouldn't have any problems with \"integrated\" Responders.\n\n> The following is the dump of my ocsp response:\n\nLet's reduce bugspam and discuss this via email.", "id": 147046, "time": "2011-06-13T09:04:18Z", "bug_id": 50740, "creation_time": "2011-06-13T09:04:18Z", "is_private": false}, {"count": 8, "tags": [], "text": "(In reply to comment #2)\n> Does it work?   Does the caching work?  I'd like to see results of people\n> testing the code in anger before inflicting it on the masses.\n\nComodo have setup a test server with OCSP stapling enabled:\nhttps://httpd-2.3-dev.comodoca.com\n\nAll seems well.  IE and Opera connect without displaying any warnings.\n\nTo confirm that Opera actually recognizes and uses the stapled OCSP Response, I edited my /etc/hosts file to block access to the OCSP Responder (ocsp.comodoca.com).  Navigating to the URL above proceeded without error, whereas navigating to a different server that doesn't have OCSP stapling enabled caused Opera to complain that the OCSP Responder was unreachable.\n\nOur OCSP Responder software is an in-house Apache C module.", "attachment_id": null, "bug_id": 50740, "id": 147048, "time": "2011-06-13T09:37:51Z", "creator": "rob@comodo.com", "creation_time": "2011-06-13T09:37:51Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 50740, "attachment_id": null, "id": 147230, "time": "2011-06-17T13:44:26Z", "creator": "jorton@redhat.com", "creation_time": "2011-06-17T13:44:26Z", "is_private": false, "text": "We perhaps need some more logging with the \"response times invalid\" error path.  Could you please keep further diagnosis of this problem in a public forum (either here or dev@ or users@) so we can all follow along, or at least report progress?\n\nThanks to both of you for reporting the results of testing so far!"}, {"count": 10, "tags": [], "text": "Hello Sirs,\n\nI've investigated with Opera 11.11, IE9 and Chrome 12.0.\nThe OCSP responder is deginated type (see below).\n  http://tools.ietf.org/id/draft-cooper-pkix-rfc2560bis-00.txt\nAnd the OCSP responder is configured to reply only ocsp signing certificate.\n\nIE9 and Opera 11.11 seems to be work correctly with apache 2.3.12-bata.\nBut Chrome 12.0 requests directly to the OCSP responder, even if apache replies ocsp response as certificate status.\nI do not know whether it is Chrome's bug or some interoperability problem.\n\nNote that the size of ocsp response is > 1K, therefore, we cannot use socache-dbm (it's too small to chache the ocsp response).\n\nWe have to check with other types of ocsp responders.\n\n\nRegards,\nKoichi Sugimoto.", "attachment_id": null, "bug_id": 50740, "id": 147462, "time": "2011-06-24T13:47:26Z", "creator": "koichi.sugimoto@globalsign.co.jp", "creation_time": "2011-06-24T13:47:26Z", "is_private": false}, {"count": 11, "attachment_id": null, "creator": "rob@comodo.com", "is_private": false, "id": 147463, "time": "2011-06-24T14:03:14Z", "bug_id": 50740, "creation_time": "2011-06-24T14:03:14Z", "tags": [], "text": "(In reply to comment #10)\n<snip>\n> But Chrome 12.0 requests directly to the OCSP responder, even if apache replies\n> ocsp response as certificate status.\n> I do not know whether it is Chrome's bug or some interoperability problem.\n\nI suspect that this is an issue with Chrome.  Last I heard, support for OCSP Stapling in Chrome is somewhat patchy and untested.  See https://bugzilla.mozilla.org/show_bug.cgi?id=360420#c16"}, {"count": 12, "tags": [], "text": "Hello Rob,\n\nIt may not be a simple bug with Chrome.\nI also investigated with IIS7.\nIn this case, Chrome works well.\nWe have to see the difference of IIS and apache more deeply.\n\nRegards,\nKoichi Sugimoto.", "attachment_id": null, "bug_id": 50740, "id": 147720, "time": "2011-07-04T10:53:48Z", "creator": "koichi.sugimoto@globalsign.co.jp", "creation_time": "2011-07-04T10:53:48Z", "is_private": false}, {"count": 13, "tags": [], "text": "Hello Rob,\n\nYou are right.\nIt seems to be a Chrome's bug.\nI observed the network packets with Wireshark.\nThen, the difference is to send the CA certificate that issued the OCSP signing certificate.\nIf the ocsp response does not include the CA certificate in it, then, Chrome sends ocsp request directry to the OCSP responder.\nIt was no relation to IIS.\n\n\nRegards,\nKoichi Sugimoto.", "attachment_id": null, "bug_id": 50740, "id": 147739, "time": "2011-07-05T09:36:53Z", "creator": "koichi.sugimoto@globalsign.co.jp", "creation_time": "2011-07-05T09:36:53Z", "is_private": false}, {"count": 14, "attachment_id": null, "creator": "rob@comodo.com", "text": "(In reply to comment #13)\n> Hello Rob,\n> \n> You are right.\n> It seems to be a Chrome's bug.\n\nHi Koichi.  In that case, I suggest you file a bug report here:\nhttps://code.google.com/p/chromium/issues/entry\n\nHave you completed your testing of the OCSP Stapling code in httpd 2.3.x?  Are you satisfied that it works OK?", "id": 147881, "time": "2011-07-12T10:14:12Z", "bug_id": 50740, "creation_time": "2011-07-12T10:14:12Z", "tags": [], "is_private": false}, {"count": 15, "tags": [], "text": "(a)\nI've installed Apache 2.3.14-beta with OCSP stapling enabled at:\n\nhttps://kuix.de:5143/ - good certificate\nhttps://kuix.de:5144/ - revoked certificate\n\nThanks to StartCom for providing me with free certificates, and also for providing a free revocation service.\n\n\n(b)\nNote to other CAs, (as inspired by Gerv's and Joe's recommendation to test against additional CA vendors):\n\nI'm willing to install additional certificates - good and revoked - at additional ports on my server.\n\nIf you operate a CA trusted by Firefox, your certificates include AIA OCSP, and you would like to contribute one good and one revoked certificate to me for free, please get in contact with me, and I will send you two CSRs for domain/hostname kuix.de\n\n\n(c)\nI've started to enhance the NSS client tools [1] to request, retrieve and dump OCSP stapling information.\n\nMy test against (a) was successful.\n\n\n(d)\nI've performed initial testing using Firefox, based on a work-in-progress patch [2] that implement OCSP stapling in the NSS library.\n\nMy test against (a) was successful.\n\n\n(e)\nI've also tested using \"openssl s_client -status ...\" but I assume this is the same test that was performed while developing OCSP stapling support for Apache.\n\n\nKai\n\n\n[1] https://bugzilla.mozilla.org/show_bug.cgi?id=700701\n[2] https://bugzilla.mozilla.org/show_bug.cgi?id=360420", "attachment_id": null, "bug_id": 50740, "id": 151298, "time": "2011-11-08T19:04:45Z", "creator": "kaie@kuix.de", "creation_time": "2011-11-08T19:04:45Z", "is_private": false}, {"count": 16, "tags": [], "creator": "kaie@kuix.de", "is_private": false, "text": "While I said, my tests worked fine, let me provide some more details.\n\nI'm using this configuration:\n  SSLStaplingCache \"shmcb:/home/bpache/local/logs/stapling_scache(512000)\"\nbut I don't see any corresponding file created.\n\nIs this expected?\nDo I need to manually initialize it?\n\n\nSometimes an OCSP server will reply with \"try later\", and Apache will send this status to clients. Maybe that's not helpful, and Apache should rather skip sending OCSP information.\n\nI think Apache should cache the most recent successful OCSP information it has retrieved, and save it across server restarts.\nI saw that Apache stapled a good response, and after restarting the server, it stapled a \"try later\" response.\nThis might mean that caching is not yet working, or that my configuration is incorrect.\n\n\nQuestion: How often will Apache refresh the OCSP information?", "id": 151299, "time": "2011-11-08T19:12:44Z", "bug_id": 50740, "creation_time": "2011-11-08T19:12:44Z", "attachment_id": null}, {"count": 17, "tags": [], "creator": "jorton@redhat.com", "attachment_id": null, "text": "Thanks a lot Kai!\n\nYes, if you use shmcb: for the shared cache it is expected that file will not exist in the filesystem; the filename is used merely as a unique key for the shared memory segment.\n\nThe OCSP response will be renewed whenever it expires from the cache, which should follow the setting of:\n\nhttp://httpd.apache.org/docs/2.3/mod/mod_ssl.html#sslsessioncachetimeout\nhttp://httpd.apache.org/docs/2.3/mod/mod_ssl.html#sslstaplingerrorcachetimeout\n\nIf you set:\n\nhttp://httpd.apache.org/docs/2.3/mod/mod_ssl.html#sslstaplingreturnrespondererrors\n\nto \"off\", it should not send staple the \"try later\" responses, if I am understanding things correctly.\n\nWe don't have any caching across restarts; I'm not sure whether the utility of that is worth the extra complexity; fetching a new OCSP response should be cheap anyway.  Perhaps we could have a way to populate the cache at startup, or else, fail.", "id": 151563, "time": "2011-11-16T16:06:54Z", "bug_id": 50740, "creation_time": "2011-11-16T16:06:54Z", "is_private": false}, {"count": 18, "tags": [], "creator": "kaie@kuix.de", "attachment_id": null, "text": "> If you set:\n> \n> http://httpd.apache.org/docs/2.3/mod/mod_ssl.html#sslstaplingreturnrespondererrors\n> \n> to \"off\", it should not send staple the \"try later\" responses, if I am\n> understanding things correctly.\n\n\nThanks.\n\nThis doesn't seem to work as intended. I set it of \"off\", both at the global level (near the \"Listen\" statement), and also inside the VirtualHost section. Still, I sometimes get the \"tryLater\" answer (as reported by openssl s_client).\n\n\nBeside, I wonder if the default value of SSLStaplingReturnResponderErrors should rather be \"off\"?\n\nClients might refuse to consider stapled errors anyway, because there is the risk that a MITM staples an error response together with a hacker server cert, trying to stop the client from getting a newer status.\n\nI think stapling makes most sense for \"good and fresh\" OCSP information, and clients should attempt to fetch fresh information on their own, whenever it's not yet available.\n\n\n> We don't have any caching across restarts; I'm not sure whether the utility of\n> that is worth the extra complexity; fetching a new OCSP response should be\n> cheap anyway.  Perhaps we could have a way to populate the cache at startup, or\n> else, fail.\n\n\nI understand that caching is simple for servers that run only a single SSL server - but I also understand that the configuration options of Apache are flexible, and allow any number of SSL ports - which creates complexity.\n\nThe current behaviour should be OK for the initial release of OCSP stapling by default.\n\nHowever, it would be very helpful to find a way to save the OCSP information across restarts.\n\nOne great benefit of OCSP stapling is that it can relax the dependency on the uptime of OCSP responder servers.\n\nClients might eventually decide that \"fresh and good\" OCSP information is mandatory, even as a default setting in browsers.\n\nBeing able to cache the recent OCSP information on the server side would be highly desired, in order to avoid server unavailability caused by OCSP servers being temporarily unresponsive.", "id": 151830, "time": "2011-11-28T14:15:09Z", "bug_id": 50740, "creation_time": "2011-11-28T14:15:09Z", "is_private": false}, {"count": 19, "tags": [], "bug_id": 50740, "text": "The Importance of this bug/enhancement needs to be elevated.  It has been over three years since this was submitted. Current statistics from NetCraft show that 98% of Apache boxes do not use stapling, whereas 98% of Microsoft boxes use stapling. The differentiator is whether stapling is on or off by default--IIS uses OCSP stapling by default. From a policy perspective, OCSP Stapling is superior for privacy-enhancing and performance reasons because clients do not have to seek a response from a third party - it comes directly from the server, which is why it is also a more efficient mechanism. Also, all major browser platforms support stapling, it is provided in mod-ssl, and because of these reasons, the number of demands for OCSP stapling \"out-of-the-box\" are likely to grow substantially over the next several months.", "id": 176176, "time": "2014-07-02T20:23:17Z", "creator": "ben@digicert.com", "creation_time": "2014-07-02T20:23:17Z", "is_private": false, "attachment_id": null}, {"count": 20, "tags": [], "creator": "trawick@apache.org", "attachment_id": null, "is_private": false, "id": 183087, "time": "2015-05-23T13:02:24Z", "bug_id": 50740, "creation_time": "2015-05-23T13:02:24Z", "text": "Enabling OCSP Stapling by default in a generally available release was vetoed with the following justification:\n\n\"The fundamental objection I have to enabling stapling by default in our\nGA releases is that it would enable a \"phoning home\" feature (to the\nCA's OCSP responders) as a side effect of configuring a certificate.\nThis is a setting I consider unacceptable for software published by the\nApache HTTP Server project - the default must be opt-in, not opt-out.\"\n\n(From message http://mail-archives.apache.org/mod_mbox/httpd-dev/201411.mbox/%3C5454A244.6070006%40velox.ch%3E)\n\nThis concern is not going to be resolved in a Bugzilla issue, so I'm closing it as WONTFIX.  The dev@httpd.apache.org mailing list is the proper venue if further clarification or other discussion is desired."}]