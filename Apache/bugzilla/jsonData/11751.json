[{"count": 0, "tags": [], "creator": "apache@t-b-o-h.com", "attachment_id": null, "is_private": false, "id": 21138, "time": "2002-08-15T23:07:11Z", "bug_id": 11751, "creation_time": "2002-08-15T23:07:11Z", "text": "We seem to be getting log entries showing a result code of 200 that we do not\nunderstand. The log entries look like :\n\n195.130.88.40 - danny [14/Aug/2002:05:08:46 -0400] \"GET /dmr/htpasswd HTTP/1.0\" \n200 -\n200.46.109.82 - danny [14/Aug/2002:05:13:44 -0400] \"GET /dmr/htpasswd HTTP/1.0\" \n200 -\n\n153.96.67.2 - danny [14/Aug/2002:05:19:07 -0400] \"GET /dmr/[no%20URL] HTTP/1.0\" \n200 -\n153.96.67.2 - danny [14/Aug/2002:05:19:08 -0400] \"GET /dmr/[no%20URL] HTTP/1.0\" \n200 -\n\n\n209.26.225.2 - danny [14/Aug/2002:05:04:24 -0400] \"HEAD /ccbill/members/dmr/.htp\nasswd HTTP/1.0\" 200 -\n\n\n211.21.25.34 - skippy [14/Aug/2002:06:00:16 -0400] \"HEAD /dmr/htpasswd HTTP/1.0\"\n 200 -\n64.70.191.13 - 7135980 [14/Aug/2002:06:00:18 -0400] \"HEAD /dmr/htpasswd HTTP/1.0\n\" 200 -\n213.121.166.94 - danny [14/Aug/2002:05:04:24 -0400] \"HEAD /ccbill/members/dmr/.h\ntpasswd.ass HTTP/1.0\" 200 -\n200.211.71.3 - danny [14/Aug/2002:05:09:29 -0400] \"GET /dmr/htpasswd HTTP/1.0\" 2\n00 -\n216.120.184.82 - danny [14/Aug/2002:05:15:09 -0400] \"GET /dmr/htpasswd HTTP/1.1\"\n 200 -\n153.96.67.2 - danny [14/Aug/2002:05:18:55 -0400] \"GET /dmr/htpasswd HTTP/1.0\" 20\n0 -\n153.96.67.2 - danny [14/Aug/2002:05:18:56 -0400] \"GET /dmr/htpasswd HTTP/1.0\" 20\n0 -\n153.96.67.2 - danny [14/Aug/2002:05:18:56 -0400] \"GET /dmr/htpasswd HTTP/1.0\" 20\n0 -\n\n153.96.67.2 - danny [14/Aug/2002:05:19:09 -0400] \"GET /dmr/[no%20URL] HTTP/1.0\" \n200 -\n153.96.67.2 - danny [14/Aug/2002:05:19:09 -0400] \"GET /dmr/[no%20URL] HTTP/1.0\" \n200 -\n63.90.161.200 - lunarguy [15/Aug/2002:17:39:58 -0400] \"GET /dmr/add-passwd.cgi\nHTTP/1.0\" 200 -\n63.90.161.200 - lunarguy [15/Aug/2002:17:39:58 -0400] \"GET /dmr/.passwrd\nHTTP/1.0\" 200 -\n63.90.161.200 - lunarguy [15/Aug/2002:17:39:58 -0400] \"GET /dmr/expire.mydu\nHTTP/1.0\" 200 -\n63.90.161.200 - lunarguy [15/Aug/2002:17:39:59 -0400] \"GET /dmr/add-passwd.cgi\nHTTP/1.0\" 200 -\n63.90.161.200 - lunarguy [15/Aug/2002:17:39:59 -0400] \"GET /dmr/signups.LHAM\nHTTP/1.0\" 200 -\n63.90.161.200 - lunarguy [15/Aug/2002:17:39:59 -0400] \"GET /dmr/secure HTTP/1.0\"\n200 -\n63.90.161.200 - lunarguy [15/Aug/2002:17:39:59 -0400] \"GET /dmr/ccbill-local.cgi\nHTTP/1.0\" 200 -\n63.90.161.200 - lunarguy [15/Aug/2002:17:39:59 -0400] \"GET /dmr/add-passwd.cgi\nHTTP/1.0\" 200 -\n63.90.161.200 - lunarguy [15/Aug/2002:17:39:59 -0400] \"GET /dmr/.dbusers.db\nHTTP/1.0\" 200 -\n63.90.161.200 - lunarguy [15/Aug/2002:17:41:30 -0400] \"GET /dmr HTTP/1.0\" 200 -\n63.90.161.200 - lunarguy [15/Aug/2002:17:41:30 -0400] \"GET /dmr HTTP/1.0\" 200 -\n663.90.161.200 - lunarguy [15/Aug/2002:17:39:58 -0400] \"GET /dmr/signups.LHAM\nHTT\nP/1.0\" 200 -\n63.90.161.200 - lunarguy [15/Aug/2002:17:39:58 -0400] \"GET /dmr/ccbill-local.cgi\n HTTP/1.0\" 200 -\n63.90.161.200 - lunarguy [15/Aug/2002:17:39:58 -0400] \"GET /dmr/.passwrd HTTP/1.\n0\" 200 -\n63.90.161.200 - lunarguy [15/Aug/2002:17:39:58 -0400] \"GET /dmr/secure HTTP/1.0\"\n 200 -\n63.90.161.200 - lunarguy [15/Aug/2002:17:39:58 -0400] \"GET /dmr/ccbill-local.cgi\n HTTP/1.0\" 200 -\n63.90.161.200 - lunarguy [15/Aug/2002:17:39:58 -0400] \"GET /dmr/signups.LHAM HTT\nP/1.0\" 200 -\n63.90.161.200 - lunarguy [15/Aug/2002:17:39:58 -0400] \"GET /dmr/expire.mydu HTTP\n/1.0\" 200 -\n63.90.161.200 - lunarguy [15/Aug/2002:17:39:58 -0400] \"GET /dmr/.dbusers.db HTTP\n/1.0\" 200 -\n63.90.161.200 - lunarguy [15/Aug/2002:17:39:58 -0400] \"GET /dmr/signups.LHAM HTT\nP/1.0\" 200 -\n63.90.161.200 - lunarguy [15/Aug/2002:17:39:58 -0400] \"GET /dmr/secure HTTP/1.0\"\n 200 -\n63.90.161.200 - lunarguy [15/Aug/2002:17:41:30 -0400] \"GET /dmr HTTP/1.0\" 200 -\n\n\nNow, this wouldn't be so bad, EXCEPT.....\n\n1) There is an .htaccess file in the /dmr directory that is :\nAuthType Basic\nAuthName \"Members Area\"\nAuthUserFile /dev/null\nAuthGroupFile /dev/null\n<Limit GET POST>\nrequire valid-user\n</Limit>\n\n2) Given that, how did it log a userid?\n\n3) The files referenced also do not exist.\n\n4) The file size for them all is \"-\", which means \"unknown\", no?\n\nGiven all this, how did these entries get logged?"}, {"count": 1, "tags": [], "creator": "slive@apache.org", "attachment_id": null, "id": 21163, "time": "2002-08-16T14:21:05Z", "bug_id": 11751, "creation_time": "2002-08-16T14:21:05Z", "is_private": false, "text": "You may have uncovered a small bug, but the configuration you are using\nis completely wrong.  Where is apache supposed to get usernames/passwords\nif you set AuthUserFile to /dev/null?  And you also shouldn't be using the\n<Limit> and </Limit> lines.\n\nStill, I would think apache should be returning 500 or 403 in a situation\nwhere there is a \"require valid-user\" but the password file can't be read.\nBut what response is actually going to the client?  Can you replicate\nthis yourself?"}, {"count": 2, "tags": [], "creator": "apache@t-b-o-h.com", "attachment_id": null, "is_private": false, "id": 21224, "time": "2002-08-18T14:08:35Z", "bug_id": 11751, "creation_time": "2002-08-18T14:08:35Z", "text": "The point of setting the AuthUserFile to /dev/null is we NEVER, EVER, EVER want\nanyone to be able to see it. Short of moving it out of the document root for the\nVH (Which is possible, but isn't practical in all cases we've run into) we were\nunder the impression that if we set the AuthUserFile to /dev/null that it would\nnever allow anyone access ever. The information kept in this directory should\nnever be seen via a browser at any time. We run a passworded website, and\nrecently there have been hundreds of passwords getting out and we can't figure\nout why. Since the password file is in the dmr directory, we put a special \nSetEnvIf that will log all accesses that have \"dmr\" in it to make sure that\nsomeone wasn't either getting directly into the directory somehow (We felt that\nwas impossible with the AuthUserFile being /dev/null) or that someone was\ninvoking a CGI that they passed the path to the file to and it was giving up the\ninformation. \n\nAs for the <Limit> lines, what are they doing that is undesireable? Should\n\"require valid-user\" just be on its own and it won't matter what the request? I\ndidn't think it was an issue.\n\nWe wouldn't mind a 500 at all. A 403 works too. I would think though, possibly,\nthat it IS getting a response... a NULL maybe encrypts to something that some\nother stuff specially crafted crypts to??? \n\nAs for what the client sees, we don't know. All the people doing this are trying\nto hack into the site, so for us to contact them is a tad difficult. I've tried\nto replicate this a few hundred times, but I always get a 401 for the same URL\nsince I can't figure out a password that is to an id that isn't in the file. :) \nCould it be cached if it came from another hit to an area where the realm was\nthe same?? Problem with that theory, however, is \"danny\" was not a valid id to\nthe other section, and I never checked on lunarguy. \nStill, I would think apache should be returning 500 or 403 in a situation\nwhere there is a \"require valid-user\" but the password file can't be read.\nBut what response is actually going to the client?  Can you replicate\nthis yourself?"}, {"count": 3, "attachment_id": null, "bug_id": 11751, "is_private": false, "id": 21236, "time": "2002-08-18T19:57:50Z", "creator": "wrowe@apache.org", "creation_time": "2002-08-18T19:57:50Z", "tags": [], "text": "\n  Did you indicate Satisfy all ???\n\n  A better way to exclude all content in a given scope is;\n\n<Directory \"/no/peek/at/this\">\n    Order deny,allow\n    Deny from all\n</Directory>\n\n  Short and to the point"}, {"count": 4, "tags": [], "creator": "apache@t-b-o-h.com", "attachment_id": null, "is_private": false, "id": 21274, "time": "2002-08-19T15:48:59Z", "bug_id": 11751, "creation_time": "2002-08-19T15:48:59Z", "text": "Ok, thanks, will change the .htaccesses, but barring that, why has the rest of\nit all happened? Why the 200? Why on files that don't exist? Why no length of\nfile?"}, {"count": 5, "tags": [], "creator": "slive@apache.org", "attachment_id": null, "id": 21280, "time": "2002-08-19T17:22:45Z", "bug_id": 11751, "creation_time": "2002-08-19T17:22:45Z", "is_private": false, "text": "The thing is, the robot that is trying to break into your site is probably\nmaking a very peculiar request.  Without seeing all the details of what\nit is doing, it is difficult to figure out why apache would react this way.\nIn other words, if we can't recreate it, we can't fix it.\n\nI'll leave the bug open for a little while to see if anyone has any luck\nrecreating this."}, {"count": 6, "tags": [], "text": "How do you propose I capture it? What log setting do I need to use to capture\nwhat is necessary? Its not happening every second of every day. It has not\nhappened since the \"lunarguy\" had it last. \n\nIf you have any suggestions what to do, I'd appreciate it. I guess with all the\ncontridictions I don't know what to do to craft a proper request. Any leads is\nappreciated so I can attempt to do this. We do not know if it is being used to\ncomprimise the security of the site.", "is_private": false, "bug_id": 11751, "id": 21347, "time": "2002-08-20T01:34:17Z", "creator": "apache@t-b-o-h.com", "creation_time": "2002-08-20T01:34:17Z", "attachment_id": null}, {"count": 7, "tags": [], "creator": "apache@t-b-o-h.com", "attachment_id": null, "is_private": false, "id": 21348, "time": "2002-08-20T02:12:13Z", "bug_id": 11751, "creation_time": "2002-08-20T02:12:13Z", "text": "Can you also let me know what is wrong with the original .htaccess that might\ncause it to not operate as intended? I'd like to explain to people why its not\nacceptable, how someone could get past it. Thanks"}, {"count": 8, "tags": [], "creator": "slive@apache.org", "attachment_id": null, "is_private": false, "id": 21383, "time": "2002-08-20T14:19:25Z", "bug_id": 11751, "creation_time": "2002-08-20T14:19:25Z", "text": "The thing is, you haven't shown any evidence that security was compromised.\nAll you've shown is some log lines where we can't explain the status code.\nIt very well could be the wrong status code getting logged, but we can't tell\nif we can't recreate it.\n\nAs far as how to see what is actually being transmitted, the only way is to put\nsome kind of sniffer on the wire.  But this is probably not something you want\nto do unless you can isolate exactly when the requests are coming in.\n\nSorry I don't have a better suggestion."}, {"count": 9, "attachment_id": null, "bug_id": 11751, "is_private": false, "id": 31563, "time": "2003-02-19T04:17:10Z", "creator": "nd@perlig.de", "creation_time": "2003-02-19T04:17:10Z", "tags": [], "text": "I consider this a configuration issues. Looks like a script or something that\nsends Content-length: 0. Feel free to reopen this bug if there are further\nissues that may help to find a better resolution.\n\nThanks for using Apache!"}]