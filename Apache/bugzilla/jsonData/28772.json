[{"count": 0, "text": "The attached Excel file , which I believe is generated by Microsoft Access \ncauses the following Exception when trying to create a workbook. The POI \nversion this was tried with is 2.0 and 2.5 Final 20040302. The code fragment is:\nis = new FileInputStream(filepath); // String representing pathname of xls file\nPOIFSFileSystem fs = new POIFSFileSystem(is);\nHSSFWorkbook wb = new HSSFWorkbook(fs);\n\njava.lang.reflect.InvocationTargetException\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance\n(NativeConstructorAccessorImpl.java:39)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance\n(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:274)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java:224)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java:160)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:165)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\nCaused by: java.lang.ArrayIndexOutOfBoundsException\n\tat org.apache.poi.util.LittleEndian.getNumber(LittleEndian.java:491)\n\tat org.apache.poi.util.LittleEndian.getInt(LittleEndian.java:139)\n\tat org.apache.poi.hssf.record.BOFRecord.fillFields(BOFRecord.java:133)\n\tat org.apache.poi.hssf.record.Record.fillFields(Record.java:90)\n\tat org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n\tat org.apache.poi.hssf.record.BOFRecord.<init>(BOFRecord.java:98)", "creator": "dmccon1957@yahoo.com", "attachment_id": null, "id": 56827, "time": "2004-05-04T17:50:23Z", "bug_id": 28772, "creation_time": "2004-05-04T17:50:23Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 28772, "attachment_id": 11426, "is_private": false, "id": 56828, "time": "2004-05-04T17:55:43Z", "creator": "dmccon1957@yahoo.com", "creation_time": "2004-05-04T17:55:43Z", "text": "Created attachment 11426\nExcel file"}, {"count": 2, "tags": [], "bug_id": 28772, "text": "testcase in UnfixedBugs. similar to bug 34575", "id": 75131, "time": "2005-05-20T13:45:56Z", "creator": "avik@apache.org", "creation_time": "2005-05-20T13:45:56Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "This looks like a simple case of writing a bad record (95 format record?) either\nthat or we read it wrong....", "is_private": false, "id": 77733, "creator": "poi-support@buni.org", "time": "2005-07-27T22:20:47Z", "bug_id": 28772, "creation_time": "2005-07-27T22:20:47Z", "attachment_id": null}, {"attachment_id": 15801, "tags": [], "bug_id": 28772, "is_private": false, "count": 4, "id": 77734, "time": "2005-07-27T23:00:29Z", "creator": "amolweb@yahoo.com", "creation_time": "2005-07-27T23:00:29Z", "text": "Created attachment 15801\nPatch for fixing the runtimeerror caused by the xls attached to this bugreport\n\nAndy is probably right. However since a runtime exception is caused, is it a\nBadThing to let it happen? \n\nThe attached patch attempts to fix the runtime exception by setting default\nvalues in case the array runs out of data in fillFields(..). The patch was\ntested on the previous attachement to this issue (attachment#11426) and was\nfound to be working. It seemed to work for both load and save file. \n\nAlso passed the previously broken test in usermodel/TestUnfixedBugs"}, {"attachment_id": null, "tags": [], "bug_id": 28772, "text": "I'm -1 on that until its confirmed that the record is a Biff8 record.  If it is\na Biff 7 or previous we should throw an exception and say \"Not a valid Excel 97+\nfile\" -- Someone needs to do a org.apache.poi.hssf.dev.BiffViewer to check\n(probably after commenting the thing out of the RecordFactory to get the hex\ndump) out what all is different.  We shouldn't punt on correctly reading the\nrecord and just \"make it work\"...we need to read it correctly.  Its okay to\nwrite something different.", "count": 5, "id": 77736, "time": "2005-07-28T04:25:04Z", "creator": "poi-support@buni.org", "creation_time": "2005-07-28T04:25:04Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 28772, "is_private": false, "count": 6, "id": 77810, "time": "2005-07-29T04:12:04Z", "creator": "jheight@apache.org", "creation_time": "2005-07-29T04:12:04Z", "text": "Yup this is a BIFF 5/7 file and not a BIFF 8. The BOF record is 12 bytes. A BIFF\n8 BOF record should be 20 bytes.\n\nJason"}]