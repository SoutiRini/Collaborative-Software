[{"count": 0, "tags": [], "creator": "rahul.kr.sharma29@gmail.com", "attachment_id": null, "text": "Hi I am trying to create a template file(with .potx file name extension) and using the template as base wants to create pptx file.\nI am trying to create template file using a image file as background of slide but the generated potx file doesn't have any background image, file has been created with blank slide. I used the bellow Code:\n\npublic class CreateTemplate {\n    public static void main(String[] args) throws Exception {\n        String imgPathStr = System.getProperty(\"user.dir\") + \"/src/resources/images/TestSameChnl_001_t.jpg\";\n        File imgFile = new File(imgPathStr);\n        File potxFile = new File(System.getProperty(\"user.dir\") + \"/src/resources/Examples/layout_v0.potx\");\n        FileOutputStream out = new FileOutputStream(potxFile);\n\n        XMLSlideShow ppt = new XMLSlideShow();\n        //creating a slide in it \n        XSLFSlide slide = ppt.createSlide();\n\n        byte[] rawData = getRawBytesFromFile(imgPathStr); // some code to read raw bytes from image file\n        ImageInputStream iis = ImageIO.createImageInputStream(new ByteArrayInputStream(rawData));\n        BufferedImage img = ImageIO.read(iis);\n\n        Dimension dimension = ppt.getPageSize();\n//        XSLFShape[] shapes = slide.getShapes();\n//        BufferedImage img = new BufferedImage(dimension.width, dimension.height, BufferedImage.TYPE_INT_RGB);\n        Graphics2D graphics = img.createGraphics();\n//        graphics.setPaint(f);\n        graphics.fill(new Rectangle2D.Float(0, 0, dimension.width, dimension.height));\n        slide.draw(graphics);//getBackground().setLineColor(Color.GREEN);//tFillColor(Color.GREEN);//draw(graphics);\n        ppt.write(out);\n        System.out.println(\"image added successfully\");\n        out.close();        \n    }    \n    private static byte[] getRawBytesFromFile(String path) throws FileNotFoundException, IOException {\n        byte[] image;\n        File file = new File(path);\n        image = new byte[(int)file.length()];\n\n        FileInputStream fileInputStream = new FileInputStream(file);\n        fileInputStream.read(image);\n\n        return image;\n    }\n} \n\nAfter creating potx file I am trying to create pptx file using potx file and used the bellow Java code:\n\n\n\nimport java.awt.image.BufferedImage;\nimport java.io.ByteArrayInputStream;\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileNotFoundException;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.text.DecimalFormat;\nimport javax.imageio.ImageIO;\nimport javax.imageio.stream.ImageInputStream;\nimport org.apache.poi.sl.usermodel.PictureData;\nimport org.apache.poi.xslf.usermodel.XMLSlideShow;\nimport org.apache.poi.xslf.usermodel.XSLFPictureData;\nimport org.apache.poi.xslf.usermodel.XSLFSlide;\n\n/**\n *\n * @author rahul.sharma\n */\npublic class PPTWithPotx_Template_Example {\n\n    static DecimalFormat df_time = new DecimalFormat(\"0.####\");\n    \n    public static void main(String[] args) throws Exception{\n        File imgFile = new File(System.getProperty(\"user.dir\")+\"/src/resources/images/TestSameChnl_001_t.jpg\");\n        File potx_File = new File(System.getProperty(\"user.dir\") + \"/src/resources/Examples/layout_v0.potx\" );\n        File pptx_File = new File(System.getProperty(\"user.dir\") + \"/src/resources/Examples/PPTWithTemplate.pptx\" );\n        \n        File movieFile = new File(System.getProperty(\"user.dir\") + \"/src/resources/movie/Dummy.mp4\");\n        \n        FileInputStream ins = new FileInputStream(potx_File);\n        FileOutputStream out = new FileOutputStream(pptx_File);\n        XMLSlideShow ppt = new XMLSlideShow(ins);\n        XSLFSlide slide = ppt.createSlide();\n        byte[] rawData = getRawBytesFromFile(imgFile.getAbsolutePath()); // some code to read raw bytes from image file\n        ImageInputStream iis = ImageIO.createImageInputStream(new ByteArrayInputStream(rawData));\n        BufferedImage img = ImageIO.read(iis);\n        XSLFPictureData pictureData = ppt.addPicture(rawData, PictureData.PictureType.JPEG);\n        ppt.write(out);\n        out.close();\n    }\n    \n    private static byte[] getRawBytesFromFile(String path) throws FileNotFoundException, IOException {\n\n        byte[] image;\n        File file = new File(path);\n        image = new byte[(int)file.length()];\n\n        FileInputStream fileInputStream = new FileInputStream(file);\n        fileInputStream.read(image);\n\n        return image;\n    }\n    \n}\n\nPlease help me to generate pots file and then from potx to ppt.\nThanks in advance.\n\nThanks & Regards\nRahul Kumar Sharma.", "id": 188756, "time": "2016-02-24T10:25:32Z", "bug_id": 59061, "creation_time": "2016-02-24T10:25:32Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 59061, "text": "Hi I want to create power-point presentation using power-point-template(which may be already exists or may be generated by poi.) for creating power point template file which have a background image in the slides, I write the following code which creates template file which opens in open-office but giving error to opening in Microsoft-power-point.\n\nThe Code is \n\n\nprivate static void generatePOTX() throws IOException, FileNotFoundException {\n     String imgPathStr = System.getProperty(\"user.dir\") + \"/src/resources/images/TestSameChnl_001_t.jpeg\";\n     File imgFile = new File(imgPathStr);\n     File potxFile = new File(System.getProperty(\"user.dir\") + \"/src/resources/Examples/layout.potx\");\n     FileOutputStream out = new FileOutputStream(potxFile);\n     HSLFSlideShow ppt = new HSLFSlideShow();\n     HSLFSlide slide = ppt.createSlide();\n     slide.setFollowMasterBackground(false);\n     HSLFFill fill = slide.getBackground().getFill();\n     HSLFPictureData pd = ppt.addPicture(imgFile,    PictureData.PictureType.JPEG);\n     fill.setFillType(HSLFFill.FILL_PICTURE);\n     fill.setPictureData(pd);  \n     ppt.write(out);\n     out.close();\n}\n\n\nAfter that I tried to create a PPT file using the generated POTX file but But it's giving error. I am trying bellow code for this. And the code is\n\n\nprivate static void GeneratePPTXUsingPOTX() throws FileNotFoundException, IOException {\n        File imgFile = new File(System.getProperty(\"user.dir\")+\"/src/resources/images/TestSameChnl_001_t.jpeg\");\n        File potx_File = new File(System.getProperty(\"user.dir\") + \"/src/resources/Examples/layout.potx\" );\n        File pptx_File = new File(System.getProperty(\"user.dir\") + \"/src/resources/Examples/PPTWithTemplate.pptx\" );\n        File movieFile = new File(System.getProperty(\"user.dir\") + \"/src/resources/movie/Dummy.mp4\");\n        FileInputStream ins = new FileInputStream(potx_File);\n        FileOutputStream out = new FileOutputStream(pptx_File);\n\n        HSLFSlideShow ppt = new HSLFSlideShow(ins);\n        List<HSLFSlide> slideList = ppt.getSlides();\n        int movieIdx = ppt.addMovie(movieFile.getAbsolutePath(), MovieShape.MOVIE_MPEG);\n        HSLFPictureData pictureData = ppt.addPicture(imgFile, PictureData.PictureType.JPEG);\n        MovieShape shape = new MovieShape(movieIdx, pictureData);\n        shape.setAnchor(new java.awt.Rectangle(300,225,420,280));\n        slideList.get(0).addShape(shape);\n        shape.setAutoPlay(true);\n        ppt.write(out);\n        out.close();\n    }\n\nAnd the exception which is coming is as fallows:\n\njava.lang.NullPointerException at org.apache.poi.hslf.usermodel.HSLFPictureShape.afterInsert(HSLFPictureShape.java:185) at org.apache.poi.hslf.usermodel.HSLFSheet.addShape(HSLFSheet.java:189)\n\n\n\nI used this code on poi-3.13-20150929.jar as well as poi-3.14-beta1-20151223.jar the latest one and both have the same result.\n\nPlease suggest me what should I do.\n\n\nThanks", "id": 188826, "time": "2016-02-26T08:15:01Z", "creator": "rahul.kr.sharma29@gmail.com", "creation_time": "2016-02-26T08:15:01Z", "is_private": false, "attachment_id": null}]