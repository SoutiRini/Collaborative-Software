[{"count": 0, "attachment_id": null, "bug_id": 52384, "text": "Create a simple servlet with \n\nprotected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n    request.getParameterMap();\n}\n\nStart Tomcat under Eclipse, or force logging level for class org.apache.tomcat.util.http.Parameters to be \"DEBUG\"\nCall the servlet with parameter which has no value set, e.g.\n\nhttp://localhost:8080/mywebapp/myservlet?parameterWithotValue\n\n(so only the \"parameterWithotValue\" should be in the result of request.getParameterMap())\n\nenjoy exception:\n\njava.lang.ArrayIndexOutOfBoundsException\n\tat java.lang.System.arraycopy(Native Method)\n\tat org.apache.tomcat.util.buf.ByteChunk.append(ByteChunk.java:334)\n\tat org.apache.tomcat.util.http.Parameters.processParameters(Parameters.java:347)\n\tat org.apache.tomcat.util.http.Parameters.processParameters(Parameters.java:425)\n\tat org.apache.tomcat.util.http.Parameters.handleQueryParameters(Parameters.java:189)\n\tat org.apache.catalina.connector.Request.parseParameters(Request.java:2993)\n\tat org.apache.catalina.connector.Request.getParameterNames(Request.java:1185)\n\tat org.apache.catalina.connector.Request.getParameterMap(Request.java:1164)\n\tat org.apache.catalina.connector.RequestFacade.getParameterMap(RequestFacade.java:444)\n\tat ru.agapemoda.servlet.ImageServlet.doGet(ImageServlet.java:47)\n             ......................................................\n\tat java.lang.Thread.run(Thread.java:662)\n\nNote: when logging level is \"SEVERE\", the troublesome code in org.apache.tomcat.util.http.Parameters.processParameters(Parameters.java:347) \n\n            if (log.isDebugEnabled()) {\n                try {\n                    origName.append(bytes, nameStart, nameEnd - nameStart);\n                    origValue.append(bytes, valueStart, valueEnd - valueStart);\n                } catch (IOException ioe) {\n                    // Should never happen...\n                    log.error(sm.getString(\"parameters.copyFail\"), ioe);\n                }\n            }\n\nis not executed and parameter is being parsed successfully. Should be parsed successfully with log level = \"DEBUG\" as well.", "id": 152395, "time": "2011-12-24T18:16:23Z", "creator": "spamcollector@yandex.ru", "creation_time": "2011-12-24T18:16:23Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 52384, "attachment_id": null, "is_private": false, "id": 152401, "time": "2011-12-25T23:40:17Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2011-12-25T23:40:17Z", "text": "Fixed in 7.0 and will be in 7.0.24.\n\nThe issue also affects 6.0.35 and not yet released code in 5.5.x branch.\nProposed for 6.0 and 5.5."}, {"count": 2, "tags": [], "bug_id": 52384, "attachment_id": null, "text": "Fixed in 5.5 with r1228191 and will be in 5.5.35.\nJust noting that the issue was in not-yet-released code. It does not affect any released 5.5 versions.", "id": 152611, "time": "2012-01-06T14:15:27Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2012-01-06T14:15:27Z", "is_private": false}, {"count": 3, "tags": [], "text": "Fixed in 6.0 with r1229027 and will be in 6.0.36.", "attachment_id": null, "bug_id": 52384, "id": 152631, "time": "2012-01-09T04:54:29Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2012-01-09T04:54:29Z", "is_private": false}]