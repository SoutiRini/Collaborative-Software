[{"count": 0, "tags": [], "bug_id": 11460, "attachment_id": null, "text": "I was running FreeBSD 4.6-RELEASE on one of my machines, with Apache 2.0.39.\nIt worked flawlesly until recently, when I had upgraded my system do 4.6-STABLE\n(cvsupped Aug the 1th). I've noticed that from time to time one of the httpd\nprocesses starts consuming all CPU power; lsof'ing such process showed that\nit is not any kind of script, but just a normal request for some .zip file.\nThen I ran truss on it. Here's the result:\n\nwritev(0x14,0x0,0x0)                             = 0 (0x0)\nwritev(0x14,0x0,0x0)                             = 0 (0x0)\nwritev(0x14,0x0,0x0)                             = 0 (0x0)\nwritev(0x14,0x0,0x0)                             = 0 (0x0)\nwritev(0x14,0x0,0x0)                             = 0 (0x0)\n\n... and so on, like in some kind of infinite loop. writev() should return\namount of written bytes.. in this case, writev() fails somehow to write\nanything (socket died?), but httpd seems to loop forever trying to send\nsomething.\n\nI do not handle .zip files in any special way, so I think it's rather a\ncoincidence that it gets on them.. or maybe just becouse they tend to be big.\nI thought it may be a problem with some libraries, so I recompiled Apache - \nbut it does not help in any way. The intriguing thing is that I cannot\nreproduce the bug - I ran 'ab' with 20 concurrent connections and 100k requests\n(for big .zip files) and it worked smoothly. I'm not sure what are the\nrequired contidions for that.\n\nI gcore'd the running httpd (it does not SEGV; it just runs). It's avalaible\nfor download here:\n\nhttp://violent.dream.vg/stuff/smieci/httpd.core\n\ngdb httpd httpd.core didn't reveal anything particulary interesting.\nJust:\n\n#0  0x28256d08 in writev () from /usr/lib/libc.so.4\n\nWhich is what I already knew. I have log level set do \"debug\", but there's\nnothing special in error log - just the usufal stuff, like \"socket not\nconnected\"..", "id": 20645, "time": "2002-08-04T23:01:57Z", "creator": "winfried@303.krakow.pl", "creation_time": "2002-08-04T23:01:57Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 11460, "attachment_id": null, "is_private": false, "id": 20646, "time": "2002-08-04T23:05:19Z", "creator": "winfried@303.krakow.pl", "creation_time": "2002-08-04T23:05:19Z", "text": "Oh, one more thing - Apache is fully responsive all the time.\nThe CPU-consuming httpd process handles signals as it should - it\nnormally quits on -TERM."}, {"count": 2, "attachment_id": null, "bug_id": 11460, "is_private": false, "id": 24702, "time": "2002-10-17T02:34:26Z", "creator": "slive@apache.org", "creation_time": "2002-10-17T02:34:26Z", "tags": [], "text": "[This is a mass bug update.]\nThis bug reports a problem in an older version of Apache 2.\nCould you please update to the most recent version and see\nif you can reproduce this problem.  If the bug still exists,\nplease update the bug with the latest version number.  If \nthe bug no longer exists, please close the bug report.\n\nSorry for this impersonal response, but we get many more bug\nreports than our volunteers can keep up with.\nThanks for using Apache!"}, {"count": 3, "tags": [], "text": "This has been fixed as of Apache 2.0.40", "is_private": false, "id": 24781, "creator": "winfried@303.krakow.pl", "time": "2002-10-17T13:51:46Z", "bug_id": 11460, "creation_time": "2002-10-17T13:51:46Z", "attachment_id": null}]