[{"attachment_id": null, "tags": [], "creator": "wfelipe@gmail.com", "is_private": false, "count": 0, "id": 80797, "time": "2005-10-05T15:57:05Z", "bug_id": 36937, "creation_time": "2005-10-05T15:57:05Z", "text": "our environment:\n\nSetEnvIfNoCase Referer ^http://host validreferer\n\n<Directory />\n      Order deny,allow\n      Deny from all\n      Allow from env=validreferer\n</Directory>\n\nif the object is not cached, using mod_cache and mod_mem_cache, it's returned\n403, however, if the object is already cached, it does not respect mod_access\nand the object is served right away.\n\nexample below\n\n- first request, invalid referer\nGET /probe.gif HTTP/1.0\nHost: host\nReferer: http://invalidhost\n\nHTTP/1.1 403 Forbidden\nDate: Wed, 05 Oct 2005 13:47:24 GMT\nServer: Apache/2.0.54 (Unix)\nConnection: close\nContent-Type: text/html; charset=iso-8859-1\n\n- second request, valid referer\nGET /algo.gif HTTP/1.0\nHost: host\nReferer: http://host\n\nHTTP/1.1 200 OK\nDate: Wed, 05 Oct 2005 13:52:40 GMT\nServer: Apache/2.0.54 (Unix)\nLast-Modified: Wed, 05 Oct 2005 13:52:37 GMT\nETag: \"31-402621f003340\"\nAccept-Ranges: bytes\nContent-Length: 49\nCache-Control: max-age=315360000\nExpires: Sat, 03 Oct 2015 13:52:40 GMT\nConnection: close\nContent-Type: image/gif\n\n- third request, invalid referer\nGET /algo.gif HTTP/1.0\nHost: host\nReferer: http://invalidhost\n\nHTTP/1.1 200 OK\nDate: Wed, 05 Oct 2005 13:54:27 GMT\nServer: Apache/2.0.54 (Unix)\nContent-Type: text/plain; charset=ISO-8859-1\nLast-Modified: Wed, 05 Oct 2005 13:54:20 GMT\nETag: \"31-402622523db00\"\nAccept-Ranges: bytes\nContent-Length: 49\nCache-Control: max-age=315360000\nExpires: Sat, 03 Oct 2015 13:54:22 GMT\nAge: 4\nConnection: close\n\nmod_cache configuration:\nCacheEnable             mem /\nCacheDefaultExpire      21600\nCacheMaxExpire          21600\nCacheIgnoreCacheControl On\nCacheIgnoreNoLastMod    On\nCacheDisable            /nocache\nMCacheSize              262144\nMCacheMaxObjectCount    4096\nMCacheMinObjectSize     1 \nMCacheMaxObjectSize     100000\nMCacheRemovalAlgorithm  LRU\n\nI already tried to change mod_access and mod_cache load order, but with no results"}, {"count": 1, "tags": [], "creator": "wfelipe@gmail.com", "attachment_id": null, "id": 80905, "time": "2005-10-07T17:10:34Z", "bug_id": 36937, "creation_time": "2005-10-07T17:10:34Z", "is_private": false, "text": "it doesn't happen to apache 2.0.52"}, {"count": 2, "tags": [], "text": "This behaviour has not been documented, pending a complete fix.", "is_private": false, "bug_id": 36937, "id": 81926, "time": "2005-10-29T12:14:46Z", "creator": "colm@apache.org", "creation_time": "2005-10-29T12:14:46Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 36937, "is_private": false, "text": "This behaviour has now been documented, rather.", "id": 81928, "time": "2005-10-29T15:47:44Z", "creator": "colm@apache.org", "creation_time": "2005-10-29T15:47:44Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "chip@force-elite.com", "attachment_id": null, "id": 83299, "time": "2005-12-06T08:05:38Z", "bug_id": 36937, "creation_time": "2005-12-06T08:05:38Z", "is_private": false, "text": "Ongoing issue, even in trunk.  I don't like the pure documentation fix."}, {"attachment_id": null, "tags": [], "creator": "slive@apache.org", "is_private": false, "count": 5, "id": 108768, "time": "2007-09-28T10:21:57Z", "bug_id": 36937, "creation_time": "2007-09-28T10:21:57Z", "text": "*** Bug 42508 has been marked as a duplicate of this bug. ***"}, {"count": 6, "tags": [], "text": "Unable to reproduce this in 2.3-trunk\nPlease provide any more information that may help in reproducing this problem\n\n\nconfig:\n\nSetEnvIfNoCase Referer ^http://host validreferer\n\n<Directory />\n      Order deny,allow\n      Deny from all\n      Allow from env=validreferer\n</Directory>\n\nCacheEnable             mem /\nCacheDefaultExpire      21600\nCacheMaxExpire          21600\nCacheIgnoreCacheControl On\nCacheIgnoreNoLastMod    On\nCacheDisable            /nocache\nMCacheSize              262144\nMCacheMaxObjectCount    4096\nMCacheMinObjectSize     1\nMCacheMaxObjectSize     100000\nMCacheRemovalAlgorithm  LRU\n\n\n\n|telnet localhost 8080\nTrying 127.0.0.1...\nConnected to localhost.\nEscape character is '^]'.\nGET /index.html HTTP/1.0\nHost: host\nReferer: http://invalidhost\n\nHTTP/1.1 403 Forbidden\nDate: Thu, 29 May 2008 12:16:33 GMT\nServer: Apache/2.3.0-dev (Unix)\nContent-Length: 212\nConnection: close\nContent-Type: text/html; charset=iso-8859-1\n\n<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\n<html><head>\n<title>403 Forbidden</title>\n</head><body>\n<h1>Forbidden</h1>\n<p>You don't have permission to access /index.html\non this server.</p>\n</body></html>\nConnection to localhost closed by foreign host.\nzsh: exit 1     telnet localhost 8080\n|telnet localhost 8080\nTrying 127.0.0.1...\nConnected to localhost.\nEscape character is '^]'.\nGET /index.html HTTP/1.0\nHost: host\nReferer: http://host\n\nHTTP/1.1 200 OK\nDate: Thu, 29 May 2008 12:16:39 GMT\nServer: Apache/2.3.0-dev (Unix)\nLast-Modified: Mon, 26 May 2008 09:34:35 GMT\nETag: \"4044f-2d-44e1ee33920c0\"\nAccept-Ranges: bytes\nContent-Length: 45\nConnection: close\nContent-Type: text/html\n\n<html><body><h1>It works!</h1></body></html>\nConnection to localhost closed by foreign host.\nzsh: exit 1     telnet localhost 8080\n|telnet localhost 8080\nTrying 127.0.0.1...\nConnected to localhost.\nEscape character is '^]'.\nGET /index.html HTTP/1.0\nHost: host\nReferer: http://invalidhost\n\nHTTP/1.1 403 Forbidden\nDate: Thu, 29 May 2008 12:16:54 GMT\nServer: Apache/2.3.0-dev (Unix)\nContent-Length: 212\nConnection: close\nContent-Type: text/html; charset=iso-8859-1\n\n<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\n<html><head>\n<title>403 Forbidden</title>\n</head><body>\n<h1>Forbidden</h1>\n<p>You don't have permission to access /index.html\non this server.</p>\n</body></html>\nConnection to localhost closed by foreign host.\nzsh: exit 1     telnet localhost 8080\n\nError Log: (debug)\n\n[Thu May 29 17:46:16 2008] [notice] Apache/2.3.0-dev (Unix) configured -- resuming normal operations\n[Thu May 29 17:46:16 2008] [info] Server built: May 29 2008 16:41:38\n[Thu May 29 17:46:16 2008] [debug] prefork.c(960): AcceptMutex: fcntl (default: fcntl)\n[Thu May 29 17:46:33 2008] [debug] mod_cache.c(129): Adding CACHE_SAVE filter for /index.html\n[Thu May 29 17:46:33 2008] [debug] mod_cache.c(136): Adding CACHE_REMOVE_URL filter for /index.html\n[Thu May 29 17:46:33 2008] [error] [client 127.0.0.1] client denied by server configuration: /space/store/apache.26.May/install/htdocs/index.html, referer: http://invalidhost\n[Thu May 29 17:46:40 2008] [debug] mod_cache.c(129): Adding CACHE_SAVE filter for /index.html\n[Thu May 29 17:46:40 2008] [debug] mod_cache.c(136): Adding CACHE_REMOVE_URL filter for /index.html\n[Thu May 29 17:46:40 2008] [error] [client 127.0.0.1] no authorization providers configured, referer: http://host\n[Thu May 29 17:46:40 2008] [debug] mod_cache.c(637): cache: Caching url: /index.html\n[Thu May 29 17:46:40 2008] [debug] mod_cache.c(643): cache: Removing CACHE_REMOVE_URL filter.\n[Thu May 29 17:46:40 2008] [info] mem_cache: Cached url: http://host:80/index.html?\n[Thu May 29 17:46:54 2008] [debug] mod_cache.c(129): Adding CACHE_SAVE filter for /index.html\n[Thu May 29 17:46:54 2008] [debug] mod_cache.c(136): Adding CACHE_REMOVE_URL filter for /index.html\n[Thu May 29 17:46:54 2008] [error] [client 127.0.0.1] client denied by server configuration: /space/store/apache.26.May/install/htdocs/index.html, referer: http://invalidhost\n\n\nAccess Log:\n\n127.0.0.1 - - [29/May/2008:17:46:33 +0530] \"GET /index.html HTTP/1.0\" 403 212\n127.0.0.1 - - [29/May/2008:17:46:39 +0530] \"GET /index.html HTTP/1.0\" 200 45\n127.0.0.1 - - [29/May/2008:17:46:54 +0530] \"GET /index.html HTTP/1.0\" 403 212\n", "is_private": false, "bug_id": 36937, "id": 117114, "time": "2008-05-29T05:45:20Z", "creator": "rahul.g.nair@gmail.com", "creation_time": "2008-05-29T05:45:20Z", "attachment_id": null}, {"count": 7, "tags": [], "creator": "rpluem@apache.org", "attachment_id": null, "id": 117116, "time": "2008-05-29T06:11:46Z", "bug_id": 36937, "creation_time": "2008-05-29T06:11:46Z", "is_private": false, "text": "This is a known and well documented issue with mod_cache that IMHO won't change any time soon."}]