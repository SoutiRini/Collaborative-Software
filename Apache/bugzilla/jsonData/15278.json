[{"count": 0, "tags": [], "bug_id": 15278, "attachment_id": null, "id": 27661, "time": "2002-12-11T16:38:22Z", "creator": "joakim.strom@excosoft.se", "creation_time": "2002-12-11T16:38:22Z", "is_private": false, "text": "Bugfix that solves this problem:\nData uploaded from a client occasionally gets corrupted\nby the isapi_redirector2 filter, if the length of the\ndata exceeds approximately 56k bytes.\n\nA word of warning is appropriate here: The fix is in the\ncommon part of jk2 but I have only tested on IIS, where\nit does the job.\n\nThe fix is from v. 1.27 of jk/native2/common/jk_requtil.c\n\n\n\n\n--- jk/native2/common/jk_requtil.c.orig\t2002-12-11 16:52:47.000000000 +0100\n+++ jk/native2/common/jk_requtil.c\t2002-12-11 17:04:30.000000000 +0100\n@@ -434,7 +434,8 @@\n                          unsigned  len)\n {\n     unsigned rdlen = 0;\n-    unsigned padded_len = len;\n+    unsigned padded_len = len;\n+\tlong content_read = s->content_read; /* save input value */\n \n     if (s->is_chunked && s->no_more_chunks) {\n \treturn 0;\n@@ -453,8 +454,9 @@\n         unsigned this_time = 0;\n         if(s->read(env, s, buf + rdlen, len - rdlen, &this_time)) {\n             return -1;\n-        }\n-\n+        }\n+\t\ts->content_read += this_time; /* make sure content_read always \ngets incremented */\n+\t\t\n         if(0 == this_time) {\n \t    if (s->is_chunked) {\n \t\ts->no_more_chunks = 1; /* read no more */\n@@ -462,7 +464,8 @@\n             break;\n         }\n         rdlen += this_time;\n-    }\n+    }\n+\ts->content_read = content_read; /* reset */\n \n     return (int)rdlen;\n }"}, {"count": 1, "tags": [], "bug_id": 15278, "text": "Created attachment 4128\nPatch from v. 1.27 of jk_requtil.c", "id": 27662, "time": "2002-12-11T16:41:08Z", "creator": "joakim.strom@excosoft.se", "creation_time": "2002-12-11T16:41:08Z", "is_private": false, "attachment_id": 4128}, {"count": 2, "tags": [], "creator": "cmanolache@yahoo.com", "is_private": false, "id": 27672, "creation_time": "2002-12-11T18:17:17Z", "time": "2002-12-11T18:17:17Z", "bug_id": 15278, "text": "It seems the content_read is just mirroring rdlen ( it should have\nexactly the same value in all cases ).\nSo the change is actually: s->content_read = rdlen \n\nI think it would be better to make this change in the caller of\nreadFully ( msg_ajp_appendFromServer ).\n\nHowever the caller has: s->content_read += len.\n\nI have a feeling there is something wrong with the patch.  ", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 15278, "attachment_id": null, "id": 27674, "time": "2002-12-11T19:03:15Z", "creator": "joakim.strom@excosoft.se", "creation_time": "2002-12-11T19:03:15Z", "is_private": false, "text": "Response to Costin Manolache:\nI agree this is not the most elegant solution, you are right\nthat incrementing s->content_read is obviously originally intended\nto be the responsibility of the caller. But with the current design\nthat does not work.\n\nThere is a loop in readFully(), and if that loop runs\nmore than once, the caller never gets the chance to update\ns->content_read between the calls to s->read(). In some cases\nthis caused jk2_service_iis_read() to copy some data twice--the\ncondition for this is if\n\n(long)lpEcb->cbAvailable - s->content_read > 0\n\nSo I made sure the value of s->content_read is right even if\nseveral calls are made from readFully(), then reset the value\nbefore exiting that function to make sure it does not get\nincremented twice.\n\nIn my original post I mentioned that it would perhaps be a good\nidea for somebody to make a more neat solution--sorry, that fell\naway from the actual bug post. But I have tested on a range of\nfiles sent through the connector, found no problems, and it solved\nthe original bug.\n"}, {"count": 4, "tags": [], "creator": "whp@uboot.com", "is_private": false, "id": 35067, "creation_time": "2003-04-12T19:56:56Z", "time": "2003-04-12T19:56:56Z", "bug_id": 15278, "text": "*** Bug 18753 has been marked as a duplicate of this bug. ***", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 15278, "text": "*** Bug 18568 has been marked as a duplicate of this bug. ***", "id": 35069, "time": "2003-04-12T22:39:45Z", "creator": "nacho@apache.org", "creation_time": "2003-04-12T22:39:45Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 15278, "attachment_id": null, "id": 39721, "time": "2003-07-01T03:40:52Z", "creator": "sgabriel@brainfuse.com", "creation_time": "2003-07-01T03:40:52Z", "is_private": false, "text": "*** Bug 20376 has been marked as a duplicate of this bug. ***"}, {"count": 7, "tags": [], "bug_id": 15278, "attachment_id": null, "text": "What the current status of this bug ?\n\nIt seems there is something wrong between 16bits (IIS ?) and 32bits (Unix).\n\nPointers welcome", "id": 52939, "time": "2004-02-25T15:45:47Z", "creator": "hgomez@apache.org", "creation_time": "2004-02-25T15:45:47Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 15278, "attachment_id": null, "id": 53178, "time": "2004-02-28T08:23:21Z", "creator": "mturk@apache.org", "creation_time": "2004-02-28T08:23:21Z", "is_private": false, "text": "Fixed in the CVS.\nThe current implementation is total rewrite of service->read.\nIt works for me (200K+ post data), so do not reopen this bug unless the\ntest case is provided.\nThe only thing I didn't test is when using _very_ slow connections, meaning\nthat the client is unable to provide 8192 bytes of data withing 60 second\ninterval. But IMO that's not the problem of this connector."}, {"count": 9, "tags": [], "bug_id": 15278, "attachment_id": null, "id": 53572, "time": "2004-03-07T06:37:38Z", "creator": "zsy@xminfoport.com", "creation_time": "2004-03-07T06:37:38Z", "is_private": false, "text": "Today I checkout the source from cvs. and the version of jk_requtil.c is 1.31, \nbut i found that the patch not available. and source code is:\n\nint jk2_requtil_readFully(jk_env_t *env, jk_ws_service_t *s,\n                         unsigned char *buf,\n                         unsigned  len)\n{\n    unsigned rdlen = 0;\n    unsigned padded_len = len;\n\n    if (s->is_chunked && s->no_more_chunks) {\n\treturn 0;\n    }\n    if (s->is_chunked) {\n        /* Corner case: buf must be large enough to hold next\n         * chunk size (if we're on or near a chunk border).\n         * Pad the length to a reasonable value, otherwise the\n         * read fails and the remaining chunks are tossed.\n         */\n        padded_len = (len < CHUNK_BUFFER_PAD) ?\n            len : len - CHUNK_BUFFER_PAD;\n    }\n\n    while(rdlen < padded_len) {\n        unsigned this_time = 0;\n        if(s->read(env, s, buf + rdlen, len - rdlen, &this_time)) {\n            return -1;\n        }\n\n        if(0 == this_time) {\n\t    if (s->is_chunked) {\n\t\ts->no_more_chunks = 1; /* read no more */\n\t    }\n            break;\n        }\n        rdlen += this_time;\n    }\n\n    return (int)rdlen;\n}\n\ncould anybody told me why?\n\nand could anybody teach me how to get the newer isapi_redirector2.dll?\ni compile the src code. but it report so many error to me. i've download libary \nAPR, apr-util, apr-iconv, pcre.\n\nso could anybody teach me? thak u very much"}, {"count": 10, "tags": [], "creator": "zsy@xminfoport.com", "is_private": false, "text": "this bug is still available in cvs", "id": 53644, "time": "2004-03-08T08:51:22Z", "bug_id": 15278, "creation_time": "2004-03-08T08:51:22Z", "attachment_id": null}, {"count": 11, "tags": [], "bug_id": 15278, "attachment_id": null, "id": 53649, "time": "2004-03-08T10:00:21Z", "creator": "mturk@apache.org", "creation_time": "2004-03-08T10:00:21Z", "is_private": false, "text": "Is the bug available or the current CVS HEAD still misbehaves?\nAs I said, unless you provide the test case, do not reopen the bug.\nI have heavily tested the new implementation, and it works for me.\nPlease provide at least your environment specs like OS, Tomcat, etc...\n"}, {"count": 12, "tags": [], "text": "I've been struggling with this as well.  Got this problem setting up redirector \nin IIS using current release.  Saw that it was supposed to be fixed in CVS so I \nbuilt a new .dll from full export of current CVS Head (as of 9 Mar 2004) using \ncurrent MS Platform SDK and VS 6.0 SP5 with srclib from httpd-2.0.48.\n\nInstalled this on a Win2k3 Server with IIS 5.0 with latest MS patches.\n\nConnected it to a Tomcat 4.1.29 server running as a service on same box.\n\nCreated an examples-test.war from Tomcat examples.\n\nWent to Tomcat Web Application Manager, ie. http:/<server>/manager/html.  \n(NOTE:  Make sure the IIS virtual directory that points to your DLL only has \nAnonymous security checked in it's directory properties... otherwise, you can't \nauthenticate with TC) \n\nUsed the examples-test.war in the \"Upload a WAR file to install\" section of the \nmanager.\n\nReceived the error:  \n\nFAIL - Install Upload Failed, Exception: Processing of multipart/form-data \nrequest failed. Stream ended unexpectedly\n\nRepeated process going directly to Tomcat's HTTP connector, works fine.\n\nDuplicated the problem with an NT 4.0/IIS 4.0 pointing to Tomcat 4.1.29 install \non an XP Pro box (running as service).\n", "attachment_id": null, "id": 53897, "creator": "monroe@dukece.com", "time": "2004-03-11T21:21:33Z", "bug_id": 15278, "creation_time": "2004-03-11T21:21:33Z", "is_private": false}, {"count": 13, "tags": [], "creator": "mturk@apache.org", "attachment_id": null, "is_private": false, "id": 53915, "time": "2004-03-12T09:08:00Z", "bug_id": 15278, "creation_time": "2004-03-12T09:08:00Z", "text": "Testest on 5.0.19/WIN XP Pro:\nDeploy -> Select WAR file to upload:\nBrowse -> selected struct-documentation.war (4094103 bytes)\nCouple of seconds, and it passes smoothly. The war is uploaded and deployed.\nAnd it works all the time, for any file sizes from 4k to mutimegabyte ones.\n\nSo can you check that with TC5?\nAlso can you give some detailed jk2.log, Setting Alternate file logger and \nlevel to debug for workerEnv and channel.socket.\n\nAlso you might consider attaching your isapi_redirector2.dll that you've built.\n"}, {"count": 14, "tags": [], "text": "Created attachment 10766\njk2 log of problem with debug turned on in WorkerEnv and channel", "attachment_id": 10766, "id": 53934, "creator": "monroe@dukece.com", "time": "2004-03-12T17:38:47Z", "bug_id": 15278, "creation_time": "2004-03-12T17:38:47Z", "is_private": false}, {"count": 15, "tags": [], "creator": "monroe@dukece.com", "attachment_id": 10767, "is_private": false, "id": 53935, "time": "2004-03-12T17:39:42Z", "bug_id": 15278, "creation_time": "2004-03-12T17:39:42Z", "text": "Created attachment 10767\nTomcat exception log to match JK2 log"}, {"count": 16, "tags": [], "creator": "monroe@dukece.com", "attachment_id": 10768, "text": "Created attachment 10768\nMy compiled version of the isapi_redirector2.dll", "id": 53936, "time": "2004-03-12T17:41:08Z", "bug_id": 15278, "creation_time": "2004-03-12T17:41:08Z", "is_private": false}, {"count": 17, "tags": [], "bug_id": 15278, "attachment_id": null, "id": 53937, "time": "2004-03-12T17:45:44Z", "creator": "monroe@dukece.com", "creation_time": "2004-03-12T17:45:44Z", "is_private": false, "text": "Need to find a machine to set up Tomcat 5.0 for testing.. ACC Tourney may delay \nthis..lol\n\nIn case it's needed for use with the JK2 debug attachment:  The war file I was \ntesting with was 174,597 bytes.\n\nFWIW, The isapi_redirector2.dll was compiled under WinXP Pro."}, {"count": 18, "tags": [], "creator": "mturk@apache.org", "is_private": false, "id": 53938, "creation_time": "2004-03-12T19:57:51Z", "time": "2004-03-12T19:57:51Z", "bug_id": 15278, "text": "Well, I've tried your dll and it works on my side with TC5.\nI'll try to test this with 4.1.30 to see if this works.\n", "attachment_id": null}, {"count": 19, "tags": [], "bug_id": 15278, "text": "Apache Tomcat/4.1.30-LE-jdk14 JVM 1.4.2_03-b02 Windows XP 5.1 x86\nIt works even with your dll.\nThere are very strange lines in your jk2.log\nThey shuld mosly be:\n... jk_ws_service_t::read buffer readed 8186 ...\nYou are getting much random read values from 162 bytes to 8K.\nDo you have slow line?", "id": 53939, "time": "2004-03-12T20:14:17Z", "creator": "mturk@apache.org", "creation_time": "2004-03-12T20:14:17Z", "is_private": false, "attachment_id": null}, {"count": 20, "tags": [], "bug_id": 15278, "text": "tomcat-5.0.19/Windows 2000 SP4/j2sdk1.4.2_03/G Monroe's DLL/IIS 5.0\nstill have this bug.\nand I use LAN to upload file. so my line not a slow line.\n", "id": 53993, "time": "2004-03-15T06:31:06Z", "creator": "zsy@xminfoport.com", "creation_time": "2004-03-15T06:31:06Z", "is_private": false, "attachment_id": null}, {"count": 21, "tags": [], "creator": "mturk@apache.org", "is_private": false, "text": "\nHi, can you guys test with the provided current isapi_redirector2.dll\nCan be downloaded from:\nhttp://www.apache.org/~mturk/isapi_redirector2.zip\n\nIt includes the most recent bug fix, but have no idea why that worked on my \nsite.", "id": 53994, "time": "2004-03-15T08:34:17Z", "bug_id": 15278, "creation_time": "2004-03-15T08:34:17Z", "attachment_id": null}, {"count": 22, "tags": [], "bug_id": 15278, "text": "Tried Mladen's DLL with mixed success.  I installed his redirector and the \nincluded MSVCRT71.dll on an NT Server IIS installation and a Win2k Server IIS \ninstallation. All of them running on a switched 100Mb network.  Upload requests \nto these came from an external PC. \n\nThe NT setup pointed to an external Win2k machine that could run either Tomcat \n4.1.29 or 5.1.19.  \n\nThe Win2k setup was connected to Tomcat 4.1.29 running on the same machine. \n(Some other work going on this machine prevented me from point it to a 5.0 \nsetup).\n\nThe Win2k set up worked once I updated the System32 directory to have the \nmsvcrt71.dll.\n\nThe NT set up failed at all times.\n\nSo, the questions are:\n\n1) What's different about your compile process/code base? ('Cause I know the \nsecurity guys are going to ask where the code came from/can we compile it...)\n\n2) Where did that version of MSVCRT come from? (same security issue..).\n\n3) Does the NT failure really matter? (we've got some legacy stuff we're \nrunning that's being phased out which is why I need to test on it.)", "id": 54032, "time": "2004-03-15T19:02:01Z", "creator": "monroe@dukece.com", "creation_time": "2004-03-15T19:02:01Z", "is_private": false, "attachment_id": null}, {"count": 23, "tags": [], "creator": "hgomez@apache.org", "attachment_id": null, "text": "Thanks to use tomcat-dev for this kind of dev settings", "id": 54053, "time": "2004-03-16T09:06:56Z", "bug_id": 15278, "creation_time": "2004-03-16T09:06:56Z", "is_private": false}, {"count": 24, "tags": [], "bug_id": 15278, "attachment_id": null, "id": 54417, "time": "2004-03-22T19:49:33Z", "creator": "abraham@onproject.com", "creation_time": "2004-03-22T19:49:33Z", "is_private": false, "text": "I was unable to get this working on Two Win2k machines fully patched.  If this \nmakes a difference, my original jk2 connector install was done using \nhttp://www.shiftomat.com/opensource/.\n\nI tested the file found at http://www.apache.org/~mturk/isapi_redirector2.zip\n and repeatedly was able to generate the upload failure messages with files \nover 50k in size via IIS.  \n\n"}, {"count": 25, "tags": [], "creator": "abraham@onproject.com", "attachment_id": null, "is_private": false, "id": 54418, "time": "2004-03-22T19:52:22Z", "bug_id": 15278, "creation_time": "2004-03-22T19:52:22Z", "text": "Sorry -- one last comment:  My tests were done using:\n\n- Win2k\n- IIS v5\n- j2sdk1.4.203\n- Tomcat v5018 and v5019\n\n"}, {"count": 26, "tags": [], "creator": "mturk@apache.org", "attachment_id": null, "is_private": false, "id": 54419, "time": "2004-03-22T20:23:27Z", "bug_id": 15278, "creation_time": "2004-03-22T20:23:27Z", "text": "It works perfectly on my side.\nEvent tried the pervesions like uploading from vmware vitual machine.\nSo, I suggest that you wait until we release 2.0.4.\nWith official binaries, we'll have some comon test ground.\n"}, {"count": 27, "tags": [], "creator": "sgabriel@brainfuse.com", "is_private": false, "id": 55204, "creation_time": "2004-04-02T23:26:35Z", "time": "2004-04-02T23:26:35Z", "bug_id": 15278, "text": "Just wanted to add to this bug that it is still there and there is no doubt. \nThe problem is it doesn't happen all the time. I had two different clients \nusing Windows XP and IE 6 latest service packs and patches installed on both. \nWhen I try to upload files from my machine which has the same configuration it \nworks for me. \nI had JK 1 as well as JK2 installed on the server so after I start getting \nthese error messages I went to IIS and revert back to use the old DLL, I know \nthat this steps work because i have tried it before. Then went back to these \nmachines that were always having troubles and guess what it worked. The \nversion that I tested was the same version that was published in this bug. ", "attachment_id": null}, {"count": 28, "tags": [], "bug_id": 15278, "attachment_id": null, "id": 55206, "time": "2004-04-02T23:31:19Z", "creator": "sgabriel@brainfuse.com", "creation_time": "2004-04-02T23:31:19Z", "is_private": false, "text": "Just wanted to add, that the test on the previous post was done on both IIS \n5.0 on a W2K Sp4 and IIS 6.0 on a W2K3 server. The test failed on both cases \nwhen using JK2."}, {"count": 29, "tags": [], "creator": "mturk@apache.org", "attachment_id": null, "is_private": false, "id": 55217, "time": "2004-04-03T05:59:07Z", "bug_id": 15278, "creation_time": "2004-04-03T05:59:07Z", "text": "Ok,\nYou've convince me.\nIf I build a fixed binary will you be willing to test?\nSince I cannot reproduce the bug the testing will be on your side of the wire.\nAlso the future correspondance should go trough standard TC dev list.\nPlease subscribe if not."}, {"count": 30, "tags": [], "creator": "sgabriel@brainfuse.com", "attachment_id": null, "text": "Yes i will be willing to help with the test. I can install the version on the \ndev server which is IIS 5.0 with TC 5.0 and W2K and use these same machines to \ndo the test.\n\nAs of the email issue, I am subscribed but i get way too many emails i can't \nread them all. the bug report is very good because I am cc ed and i get the \nemail in my inbox rather than the TC folder.\n", "id": 55218, "time": "2004-04-03T06:28:14Z", "bug_id": 15278, "creation_time": "2004-04-03T06:28:14Z", "is_private": false}, {"count": 31, "tags": [], "creator": "mturk@apache.org", "attachment_id": null, "text": "There is a binary build at:\nhttp://jakarta.apache.org/~mturk/isapi_redirector2.zip\nor you can build from CVS.\n\nIt includes the latest fixes that IMO should resolve the issue.\nWaiting for the test results :)\n\nIn case that the bug is still present;\nThe best would be that you put following in your config to enable DEBUG and \nfile logging.\nI'm interested in the jk_ws_service_t::read lines.\n\n\n[logger]\ninfo=Native logger\nlevel=DEBUG\n\n[logger.file:0]\nlevel=DEBUG\nfile=${serverRoot}/logs/jk2.log\n \n....\n\n[workerEnv:]\ninfo=Global server options\ntiming=1\ndebug=0\nlogger=logger.file:0 \n\n...\n\n[uri:/manager/*]\ninfo=Manager Application.\ncontext=/manager\ndebug=10\n", "id": 55306, "time": "2004-04-05T12:55:58Z", "bug_id": 15278, "creation_time": "2004-04-05T12:55:58Z", "is_private": false}, {"count": 32, "tags": [], "bug_id": 15278, "attachment_id": null, "id": 55416, "time": "2004-04-06T17:20:52Z", "creator": "goakham@hgn.ca", "creation_time": "2004-04-06T17:20:52Z", "is_private": false, "text": "Hi Mladen,\n\nThat build seems to work for me; thanks for posting it!\nThe systems I tested it with were:\n\n-w2k machines\n-IIS v5.xxx\n-Tomcat 4.1.29\n-J2sdk 1.4.2_03 (and 1.4.2_01, I believe)\n\nCheers,\n\nGeoff\n"}, {"count": 33, "tags": [], "creator": "karl@xk72.com", "attachment_id": null, "text": "Successful test:\n\nIIS 5\nWindows 2000 Server\nTomcat 4.1.29\nJDK 1.4.1_02\nIsapi redirector from: http://jakarta.apache.org/~mturk/isapi_redirector2.zip\n\nThe current 2.0.4 release of isapi_redirector2 did NOT work.", "id": 57580, "time": "2004-05-18T04:44:14Z", "bug_id": 15278, "creation_time": "2004-05-18T04:44:14Z", "is_private": false}, {"count": 34, "tags": [], "bug_id": 15278, "attachment_id": null, "id": 58585, "time": "2004-06-02T21:31:56Z", "creator": "adamrabung@hotmail.com", "creation_time": "2004-06-02T21:31:56Z", "is_private": false, "text": "Successful test:\n\nIIS 5\nWindows 2000 Server\nTomcat 5.0.25\nJDK 1.4.2_04\nIsapi redirector from: http://jakarta.apache.org/~mturk/isapi_redirector2.zip\n\nThe current release of isapi_redirector2 distributed with tomcat 5.0 did NOT work."}, {"count": 35, "tags": [], "bug_id": 15278, "text": "I have tested the version posted \nhttp://jakarta.apache.org/~mturk/isapi_redirector2.zip\nand it works fine, tried it from the machines that was working before and it \nworks now.\nConfiguration \nWin 2000 SP4 \nIIS \nJDK 1.4.2_03\n", "id": 58640, "time": "2004-06-03T14:38:18Z", "creator": "sgabriel@brainfuse.com", "creation_time": "2004-06-03T14:38:18Z", "is_private": false, "attachment_id": null}, {"count": 36, "tags": [], "creator": "andya@apache.org", "is_private": false, "text": "Does anyone know whether this bug really is fixed? I've got a client who's\nhaving a problem with the IIS redirector that sounds exactly like this bug. I\nhad him try the redirector attached above and the problem persists.\n\nNo problem with Tomcat directly on 8080 so it seems likely that it's happening\nsomewhere inside the redirector.", "id": 60156, "time": "2004-07-05T13:51:25Z", "bug_id": 15278, "creation_time": "2004-07-05T13:51:25Z", "attachment_id": null}, {"count": 37, "tags": [], "bug_id": 15278, "attachment_id": null, "id": 61302, "time": "2004-07-29T12:32:19Z", "creator": "alex_ked@hotmail.com", "creation_time": "2004-07-29T12:32:19Z", "is_private": false, "text": "I have this bug on the following server:\nWindows Server 2003\nIIS 6.0\nTomcat 4.1.30\nJDK 1.4.2.05\n\nI installed the latest version of isapi_redirector2.dll (225,280 bytes). It \nworks fine but I could not upload files bigger than 50k. I'm trying to upload \nfiles via dial-up connection (56 Kbit/sec) and via fast channel (up to 1 \nMbit/sec). At the same time I can upload any files when I do it locally on the \nserver.\nYou may use link http://216.122.144.202/test.jsp to reproduce the problem.\n\nLet me know what kind of debug info you need to fix the bug. Thank you.\n"}, {"count": 38, "tags": [], "bug_id": 15278, "attachment_id": null, "text": "This has been fixed in CVS as is clear from the comments above. There has not, \nas yet, been a formal JK2 release that includes this fix.\n\nThe successful tests were performed with a build from CVS \n(http://jakarta.apache.org/~mturk/isapi_redirector2.zip)\n\nSites using the last release 2.0.4 will still experience this bug.\n\nPlease do not re-open this bug report.", "id": 61325, "time": "2004-07-29T19:33:08Z", "creator": "markt@apache.org", "creation_time": "2004-07-29T19:33:08Z", "is_private": false}, {"count": 39, "tags": [], "bug_id": 15278, "text": "More info on the problem. I see in the postings that some are not able to \nreproduce the error. We have a situation where people that have a high speed on \ntheir network is able to upload files just fine. People on slower lines can \nupload most of the time and people on slow lines cannot upload at all.\n\nI applied the Isapi redirector from: \nhttp://jakarta.apache.org/~mturk/isapi_redirector2.zip\n\nNow all users can upload no matter what connection they have.\nI was happy with the patch until I started getting reports like this:\n\n2004-11-18 10:59:51 StandardWrapperValve[jsp]: Servlet.service() for servlet \njsp threw exception\njava.io.IOException: Stream closed\n\tat org.apache.jasper.runtime.BodyContentImpl.ensureOpen\n(BodyContentImpl.java:576)\n\tat org.apache.jasper.runtime.BodyContentImpl.write\n(BodyContentImpl.java:140)\n\tat org.apache.jasper.runtime.BodyContentImpl.write\n(BodyContentImpl.java:157)\n\tat org.apache.jsp.indexuf_jsp._jspService(indexuf_jsp.java:1775)\n\tat org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:94)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:810)\n\tat org.apache.jasper.servlet.JspServletWrapper.service\n(JspServletWrapper.java:298)\n\tat org.apache.jasper.servlet.JspServlet.serviceJspFile\n(JspServlet.java:292)\n\tat org.apache.jasper.servlet.JspServlet.service(JspServlet.java:236)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:810)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java:237)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java:157)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke\n(StandardWrapperValve.java:214)\n\tat org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:104)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:520)\n\tat org.apache.catalina.core.StandardContextValve.invokeInternal\n(StandardContextValve.java:198)\n\tat org.apache.catalina.core.StandardContextValve.invoke\n(StandardContextValve.java:152)\n\tat org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:104)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:520)\n\tat org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:137)\n\tat org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:104)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke\n(ErrorReportValve.java:117)\n\tat org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:102)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:520)\n\tat org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:109)\n\tat org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:104)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:520)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:929)\n\tat org.apache.coyote.tomcat5.CoyoteAdapter.service\n(CoyoteAdapter.java:160)\n\tat org.apache.jk.server.JkCoyoteHandler.invoke(JkCoyoteHandler.java:296)\n\tat org.apache.jk.common.HandlerRequest.invoke(HandlerRequest.java:372)\n\tat org.apache.jk.common.ChannelSocket.invoke(ChannelSocket.java:694)\n\tat org.apache.jk.common.ChannelSocket.processConnection\n(ChannelSocket.java:626)\n\tat org.apache.jk.common.SocketConnection.runIt(ChannelSocket.java:807)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:644)\n\tat java.lang.Thread.run(Thread.java:595)\n\n\nI started getting these errors when the load on the server grew in the morning \nafter I applied the patch.\n\nI have the following config:\nIIS 6 (win2003)\nTomcat 5.0.25\njava SDK 1.5 RC\nIsapi redirector from: http://jakarta.apache.org/~mturk/isapi_redirector2.zip\n\n", "id": 67123, "time": "2004-11-18T11:17:35Z", "creator": "terchris2@hotmail.com", "creation_time": "2004-11-18T11:17:35Z", "is_private": false, "attachment_id": null}, {"count": 40, "tags": [], "bug_id": 15278, "text": "As your comments state, this bug is fixed. If you have identified another \nissue, please open a new bug report.", "id": 67189, "time": "2004-11-18T23:53:34Z", "creator": "markt@apache.org", "creation_time": "2004-11-18T23:53:34Z", "is_private": false, "attachment_id": null}, {"count": 41, "tags": [], "bug_id": 15278, "attachment_id": null, "id": 67292, "time": "2004-11-21T12:36:51Z", "creator": "terchris2@hotmail.com", "creation_time": "2004-11-21T12:36:51Z", "is_private": false, "text": "(In reply to comment #40)\n> As your comments state, this bug is fixed. If you have identified another \n> issue, please open a new bug report.\nOK. I did not create another bug because the way this bug is fixed has created \nanother bug. \n"}, {"count": 42, "tags": [], "bug_id": 15278, "attachment_id": null, "id": 89987, "time": "2006-06-09T08:57:33Z", "creator": "tibetoine@gmail.com", "creation_time": "2006-06-09T08:57:33Z", "is_private": false, "text": "Hello, i'm trying to fix this bug too... \n\nI still have the exception : \norg.apache.commons.fileupload.FileUploadException: Processing of\nmultipart/form-data request failed. Stream ended unexpectedly\n\nCan you explain what we have to do to fix the bug. I just replaced the\nisapi_redirector2.dll in the tomcat\\bin folder. Was that the correct method? \n\nPlease help "}, {"count": 43, "tags": [], "creator": "tibetoine@gmail.com", "attachment_id": null, "text": "Hello, i'm trying to fix this bug too... \n\nI still have the exception : \norg.apache.commons.fileupload.FileUploadException: Processing of\nmultipart/form-data request failed. Stream ended unexpectedly\n\nCan you explain what we have to do to fix the bug. I just replaced the\nisapi_redirector2.dll in the tomcat\\bin folder. Was that the correct method? \n\nPlease help ", "id": 89988, "time": "2006-06-09T08:57:51Z", "bug_id": 15278, "creation_time": "2006-06-09T08:57:51Z", "is_private": false}, {"count": 44, "tags": [], "bug_id": 15278, "attachment_id": null, "id": 89999, "time": "2006-06-09T11:30:32Z", "creator": "markt@apache.org", "creation_time": "2006-06-09T11:30:32Z", "is_private": false, "text": "JK2 is no longer supported.\n\nPlease see http://tomcat.apache.org/tomcat-4.1-doc/config/connectors.html for an\nup to date list of supported connectors"}, {"count": 45, "tags": [], "bug_id": 15278, "attachment_id": null, "id": 90000, "time": "2006-06-09T12:19:51Z", "creator": "tibetoine@gmail.com", "creation_time": "2006-06-09T12:19:51Z", "is_private": false, "text": "You're right, my company still use it, and has to use it.\n\nIs it still possible de patch it ? Or not ? I know the problem is quite old\n(2004) maybe someone remembers how to do ? \n\nIf you could help it's would be great"}, {"count": 46, "tags": [], "bug_id": 15278, "text": "The fact that you or your company used mod_jk2 does not\nmean that it will be moved from deprecated status.\nYou have the source code, so feel free to maintain it by\nyourself.\n\nPlease do not reopen this case.", "id": 90028, "time": "2006-06-09T20:55:05Z", "creator": "mturk@apache.org", "creation_time": "2006-06-09T20:55:05Z", "is_private": false, "attachment_id": null}]