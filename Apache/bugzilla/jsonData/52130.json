[{"count": 0, "tags": [], "bug_id": 52130, "attachment_id": 27891, "id": 151155, "time": "2011-11-03T16:54:24Z", "creator": "ag@4js.com", "creation_time": "2011-11-03T16:54:24Z", "is_private": false, "text": "Created attachment 27891\nUnit test to reproduce the problem\n\nTest number 3 of the attached unit test fails for i=2 (SXSSF). The attached patch fixes the problem."}, {"count": 1, "tags": [], "creator": "ag@4js.com", "is_private": false, "text": "Created attachment 27892\nPatch fixing the problem", "id": 151156, "time": "2011-11-03T16:55:26Z", "bug_id": 52130, "creation_time": "2011-11-03T16:55:26Z", "attachment_id": 27892}, {"count": 2, "tags": [], "bug_id": 52130, "attachment_id": 27896, "id": 151192, "time": "2011-11-04T14:30:27Z", "creator": "ag@4js.com", "creation_time": "2011-11-04T14:30:27Z", "is_private": false, "text": "Created attachment 27896\nUpdated version of the unit test (use this one instead of attachment 27891)"}, {"count": 3, "tags": [], "bug_id": 52130, "is_private": false, "id": 151258, "attachment_id": null, "creator": "yegor@dinom.ru", "creation_time": "2011-11-07T09:55:09Z", "time": "2011-11-07T09:55:09Z", "text": "Alex,\n\nThe provided unit test does not demonstrate the problem. I'm testing with trunk and all tests pass. \nHowever, I was able to reproduce a NPE by setting a null string in a blank cell: \n\n    public void test4()\n    {\n        Cell[] cells=new Cell[] {new HSSFWorkbook().createSheet(\"test\").createRow(0).createCell(0),\n                                 new XSSFWorkbook().createSheet(\"test\").createRow(0).createCell(0),\n                                 new SXSSFWorkbook().createSheet(\"test\").createRow(0).createCell(0)};\n        for(int i=0;i<cells.length;i++)\n        {\n            cells[i].setCellValue((String)null);\n            assertEquals(\"i=\"+i,\"\",cells[i].getStringCellValue());\n        }\n    }\n\nThis test indeed fails for i=2 and the provided patch fixes it. Was it your case? \n\nYegor"}, {"count": 4, "tags": [], "bug_id": 52130, "text": "Sorry,\nyou are right. The issue was fixed in build 1124698. Calling convertCellValueToString() in SXSSFCell.setType() fixes the issue. Apparently I mixed up versions when testing.\nAlex", "id": 151261, "time": "2011-11-07T11:08:55Z", "creator": "ag@4js.com", "creation_time": "2011-11-07T11:08:55Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 52130, "attachment_id": null, "id": 151262, "time": "2011-11-07T11:14:34Z", "creator": "yegor@dinom.ru", "creation_time": "2011-11-07T11:14:34Z", "is_private": false, "text": "No problem. I'm resolving the issue as \"fixed\"\n\nYegor"}]