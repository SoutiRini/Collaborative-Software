[{"count": 0, "tags": [], "bug_id": 43116, "attachment_id": null, "text": "I crafted a test Excel document in Excel 2003, putting embedded Word and\nPowerPoint objects inside it.\n\nI didn't expect it to handle these, but what it did was much worse than my\nexpectations. :-)\n\nTest code and file will be attached in a minute, results in the following exception.\n\njava.lang.NegativeArraySizeException\n\tat org.apache.poi.ddf.UnknownEscherRecord.fillFields(UnknownEscherRecord.java:76)\n\tat\norg.apache.poi.ddf.EscherContainerRecord.fillFields(EscherContainerRecord.java:56)\n\tat\norg.apache.poi.ddf.EscherContainerRecord.fillFields(EscherContainerRecord.java:56)\n\tat\norg.apache.poi.hssf.record.AbstractEscherHolderRecord.convertToEscherRecords(AbstractEscherHolderRecord.java:101)\n\tat\norg.apache.poi.hssf.record.AbstractEscherHolderRecord.decode(AbstractEscherHolderRecord.java:293)\n\tat\norg.apache.poi.hssf.usermodel.HSSFWorkbook.getAllPictures(HSSFWorkbook.java:1337)", "id": 106726, "time": "2007-08-13T22:50:47Z", "creator": "trejkaz@trypticon.org", "creation_time": "2007-08-13T22:50:47Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 43116, "attachment_id": 20659, "id": 106727, "time": "2007-08-13T22:51:11Z", "creator": "trejkaz@trypticon.org", "creation_time": "2007-08-13T22:51:11Z", "is_private": false, "text": "Created attachment 20659\nTest.java"}, {"count": 2, "tags": [], "bug_id": 43116, "attachment_id": 20660, "id": 106728, "time": "2007-08-13T22:51:34Z", "creator": "trejkaz@trypticon.org", "creation_time": "2007-08-13T22:51:34Z", "is_private": false, "text": "Created attachment 20660\nole2-embedding.xls"}, {"count": 3, "tags": [], "bug_id": 43116, "attachment_id": 20662, "id": 106768, "time": "2007-08-14T18:26:32Z", "creator": "trejkaz@trypticon.org", "creation_time": "2007-08-14T18:26:32Z", "is_private": false, "text": "Created attachment 20662\nProposed fix\n\nCode in EscherBlipRecord.getRecordSize() was saying that the length of the\nrecord was the length of the blip data plus 4, but the header size is actually\n8.\n\nFixed by using the actual HEADER_SIZE constant.  File now at least parses as\nexpected."}, {"count": 4, "tags": [], "text": "Thanks, patch applied, and tests added", "is_private": false, "id": 106790, "creator": "apache@gagravarr.org", "time": "2007-08-15T07:40:04Z", "bug_id": 43116, "creation_time": "2007-08-15T07:40:04Z", "attachment_id": null}]