[{"count": 0, "tags": [], "creator": "rafaa.wang@gmail.com", "is_private": false, "id": 138963, "creation_time": "2010-08-06T21:52:37Z", "time": "2010-08-06T21:52:37Z", "bug_id": 49721, "text": "I put a jsp file in a jar file and test whether tomcat 7 supports it by viewing it from the browser and failed.", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 49721, "attachment_id": null, "is_private": false, "id": 138989, "time": "2010-08-09T06:01:22Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2010-08-09T06:01:22Z", "text": "Probably your jar does not have a META-INF/web-fragment.xml file and thus is skipped.\n\nYou can look at jar files in webapp-3.0-fragments test webapp for a working example,\nhttp://svn.apache.org/repos/asf/tomcat/trunk/test/webapp-3.0-fragments/WEB-INF/lib/"}, {"count": 2, "tags": [], "bug_id": 49721, "attachment_id": null, "is_private": false, "id": 138993, "time": "2010-08-09T09:48:40Z", "creator": "Larry.Isaacs@sas.com", "creation_time": "2010-08-09T09:48:40Z", "text": "Hi Konstantin,\n\nDuring my work on the Tomcat support in Eclipse Web Tools, the only requirement I found in the Servlet 3.0 spec for static resources in a jar was that they be found under \"META-INF/resources\" in the jar.  I didn't see any requirement that the jar be a web-fragment.\n\nWang,\n\nSince this behavior is only defined for Servlet 3.0 web applications, if your project has a web.xml, make sure it is a Servlet 3.0 web.xml in addition to making sure the JSP is in the \"META-INF/resources\" folder of the jar.  A quick test shows this working for me for Tomcat 7.0.0 and 7.0.2 (currently under vote).\n\nCheers,\nLarry"}, {"count": 3, "text": "(In reply to comment #2)\n> Hi Konstantin,\n> \n> During my work on the Tomcat support in Eclipse Web Tools, the only requirement\n> I found in the Servlet 3.0 spec for static resources in a jar was that they be\n> found under \"META-INF/resources\" in the jar.  I didn't see any requirement that\n> the jar be a web-fragment.\n> \n> Wang,\n> \n> Since this behavior is only defined for Servlet 3.0 web applications, if your\n> project has a web.xml, make sure it is a Servlet 3.0 web.xml in addition to\n> making sure the JSP is in the \"META-INF/resources\" folder of the jar.  A quick\n> test shows this working for me for Tomcat 7.0.0 and 7.0.2 (currently under\n> vote).\n> \n> Cheers,\n> Larry\n\nHi, Larry\n\nI also test an very simple case where there are only one jar file in the lib, it runs well. But when there are more than one jar files, it fails.\n\nI attach the two war files and please help to verify.\n\nThanks!", "creator": "rafaa.wang@gmail.com", "attachment_id": null, "id": 139008, "time": "2010-08-09T21:18:41Z", "bug_id": 49721, "creation_time": "2010-08-09T21:18:41Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "text": "Created attachment 25867\nthe war file with more than one jar files", "attachment_id": 25867, "bug_id": 49721, "id": 139009, "time": "2010-08-09T21:21:21Z", "creator": "rafaa.wang@gmail.com", "creation_time": "2010-08-09T21:21:21Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 49721, "attachment_id": 25868, "id": 139010, "time": "2010-08-09T21:22:19Z", "creator": "rafaa.wang@gmail.com", "creation_time": "2010-08-09T21:22:19Z", "is_private": false, "text": "Created attachment 25868\nthe war file with only one jar file"}, {"count": 6, "tags": [], "bug_id": 49721, "is_private": false, "id": 139034, "attachment_id": null, "creator": "Larry.Isaacs@sas.com", "creation_time": "2010-08-10T11:13:54Z", "time": "2010-08-10T11:13:54Z", "text": "I believe the problem is in step 8 in the ContextConfig.webConfig() method.  Based on my read of the Servlet 3.0 spec (section 4.6 only says JAR and states order is undefined), the \"processResourceJARs(orderedFragments)\" should be \"processResourceJARs(fragments)\" instead.\n\nWang,\n\nBecause your web.xml specifies an <absolute-ordering>, jars which do not have a web-fragment.xml will not appear in the orderedFragments list and won't be scanned for static resources.  Adding a web-fragment.xml as Konstatin suggests would work around the problem for now, assuming the <absolute-ordering> can't be removed.\n\nLarry"}, {"count": 7, "tags": [], "bug_id": 49721, "attachment_id": null, "is_private": false, "id": 139389, "time": "2010-08-23T15:40:12Z", "creator": "markt@apache.org", "creation_time": "2010-08-23T15:40:12Z", "text": "That's what I get for trying to force an order to get consistent behaviour.\n\nLarry's analysis is spot on.\n\nI have fixed this in trunk and it will be included in 7.0.3 onwards. The order enforced now is: ordered JARs in fragment order then all remaining JARs in random order."}]