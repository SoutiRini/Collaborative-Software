[{"count": 0, "tags": [], "bug_id": 49864, "is_private": false, "id": 139624, "creation_time": "2010-09-02T12:17:30Z", "time": "2010-09-02T12:17:30Z", "creator": "forum@flr.at", "text": "Can you please add the following change to the changelog:\n\nSomewhere between 2.5.1-FINAL and 3.0-FINAL in org.apache.poi.hssf.usermodel.HSSFRow the method getLastCellNum changed from \n\"get the number of the last cell contained in this row.\"\nto\n\"Gets the index of the last cell contained in this row PLUS ONE.\"\n\nThis is IMHO one of the most important changes between 2.5.1 and 3.x because it breaks existing functionality (and it took me lots of time to find this unmentioned change during upgrading as 3.2 produces only an NPE when accessing nonexistent cells...)\n\nThank you very much!", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 49864, "attachment_id": null, "id": 139721, "time": "2010-09-06T11:25:25Z", "creator": "apache@gagravarr.org", "creation_time": "2010-09-06T11:25:25Z", "is_private": false, "text": "It's so long since POI 2.5.x that I can't remember for sure... However I seem to recall that there was a bug and some files returned the last cell index plus one, and some the last index. This was fixed to always be plus one.\n\nSomeone else might be able to confirm or deny this though?\n\nOtherwise, you may find the iterators (introduced in 3.5) much easier to work with, see http://poi.apache.org/spreadsheet/quick-guide.html#Iterator"}, {"count": 2, "tags": [], "text": "if you compare the javadocs of getLastCellNum() of\nhttp://archive.apache.org/dist/jakarta/poi/release/bin/poi-bin-2.5.1-final-20040804.zip\nand\nhttp://archive.apache.org/dist/jakarta/poi/release/bin/poi-bin-3.0-FINAL-20070503.zip\n\nat this position:\n\npoi-bin-2.5.1-final-20040804.zip/docs/apidocs/org/apache/poi/hssf/usermodel/HSSFRow.html\nwith\npoi-bin-3.2-FINAL-20081019.zip/poi-3.2-FINAL/docs/apidocs/org/apache/poi/hssf/usermodel/HSSFRow.html\n\nyou can see there was a change.\n\n\nThanks for the iterator hint, I'll take a look at it.", "attachment_id": null, "id": 139762, "creator": "forum@flr.at", "time": "2010-09-08T10:58:06Z", "bug_id": 49864, "creation_time": "2010-09-08T10:58:06Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 49864, "attachment_id": null, "text": "The \"plus one\" change was made intentionally, the main goal was to make lastCellNum the standard upper bound when iterating over cells:\n\n      int minColIx = row.getFirstCellNum();\n      int maxColIx = row.getLastCellNum();\n      for(int colIx = minColIx; colIx < maxColIx; colIx++) {\n        Cell cell = row.getCell(colIx);\n        //... do something with cell\n      }\n\nIt might had broke the code written for POI 2.5.1, but on the other hand it prevented incorrect usages of lastCellNum  in 'for' loops which seemed more important at that time.\n\nYegor\n\n(In reply to comment #2)\n> if you compare the javadocs of getLastCellNum() of\n> http://archive.apache.org/dist/jakarta/poi/release/bin/poi-bin-2.5.1-final-20040804.zip\n> and\n> http://archive.apache.org/dist/jakarta/poi/release/bin/poi-bin-3.0-FINAL-20070503.zip\n> \n> at this position:\n> \n> poi-bin-2.5.1-final-20040804.zip/docs/apidocs/org/apache/poi/hssf/usermodel/HSSFRow.html\n> with\n> poi-bin-3.2-FINAL-20081019.zip/poi-3.2-FINAL/docs/apidocs/org/apache/poi/hssf/usermodel/HSSFRow.html\n> \n> you can see there was a change.\n> \n> \n> Thanks for the iterator hint, I'll take a look at it.", "id": 147442, "time": "2011-06-24T09:57:43Z", "creator": "yegor@dinom.ru", "creation_time": "2011-06-24T09:57:43Z", "is_private": false}]