[{"count": 0, "tags": [], "text": "The problem is this. \n\nI make assyncrniuos reqests to server and I obtain a list of html div elemnts. \nIn a call back method I render this divs in pages. \n\nI try to test my application with jmeter. I check the option 'Retrieve All \nEmbeded Resources from HTML Pages' for make request to my resources. \n\nNothing hapened. I change all the parsers in jmeter.properties. I think the \nproblem is the way i define the image using CSS - 'background:url'. or is \nbecause mai responce is not a xhtml valid, just a list of div's. \n\nAn example of some html div response: \n\n<div class=\"graph\" style=\"width:275px;height:166px;background:url\n('/ews/ewsGetImage.act?id=1160139636046-\ndistributionByDevice&imageType=DISTRIBUTION_GRAPHIC') no-repeat ;\"  ></div>", "is_private": false, "bug_id": 40696, "id": 94585, "time": "2006-10-06T06:56:14Z", "creator": "colaru@gmail.com", "creation_time": "2006-10-06T06:56:14Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 40696, "attachment_id": null, "id": 99849, "time": "2007-02-27T05:59:16Z", "creator": "alf@i100.no", "creation_time": "2007-02-27T05:59:16Z", "is_private": false, "text": "The problem is not that the response is not valid xhtml.\n\nThe reason is that the parser that parses the response and looks for embedded\nresources, does not look for constructs like <anytag\nstyle=\"background:url('someurl')\"/>.\n\nI am not sure if the parser should look for such embedded resources. If the\nstylesheet file references any resources, those will not be downloaded by\njmeter, because jmeter only downloads any stylesheet files referenced, it does\nnot parse the downloaded stylesheet files and then download all resources\nreferenced by the stylesheet file.\n\nSo if there should be no difference between resources mentioned inside\nstylesheet files and resouces mentioned in inline style of the actual document,\nthen I think this bug should be closed as \"invalid\".\n\nIf you want resources mentioned in inline styling of the document, then the\nfollowing code could be added to the bottom of the \"parseNodes\" method of the\n\"HtmlParserHTMLParser\" seems to do the work :\n\n            String styleTagStr = tag.getAttribute(\"STYLE\");\n            if(styleTagStr != null) {\n                PatternCompiler compiler = new Perl5Compiler();\n                PatternMatcher matcher = new Perl5Matcher();\n                Pattern pattern = null;\n                PatternMatcherInput input = null;\n                try {\n                    pattern = compiler.compile(\"URL\\\\(('|\\\")(.*)('|\\\")\\\\)\", \n                        Perl5Compiler.CASE_INSENSITIVE_MASK |\nPerl5Compiler.SINGLELINE_MASK | Perl5Compiler.READ_ONLY_MASK);\n                    input = new PatternMatcherInput(styleTagStr);\n                    while (matcher.contains(input, pattern)) {\n                        MatchResult match = matcher.getMatch();\n                        // The value is in the second group\n                        String styleUrl = match.group(2);\n                        urls.addURL(styleUrl, baseUrl.url);\n                    }\n                } catch (MalformedPatternException mpe) {\n                    log.warn(\"Malformed pattern for getting url of style\nattribute of a tag\");\n                }\n            }            \n"}, {"count": 2, "tags": [], "bug_id": 40696, "attachment_id": null, "id": 99851, "time": "2007-02-27T07:14:17Z", "creator": "sebb@apache.org", "creation_time": "2007-02-27T07:14:17Z", "is_private": false, "text": "Agreed that JMeter should not parse the content of CSS files when looking for \nembedded resources. [This could be quite tricky, as the CSS file can contain \ndefinitions that are not used.]\n\nHowever, if the background image is part of a style attribute in the HTML page \nitself, then it seems sensible to treat this the same as other background \nimages.\n\nI'll see about adding this.\n\nNote: there are two related issues: bug 40933 and bug 40945."}, {"count": 3, "tags": [], "bug_id": 40696, "attachment_id": null, "is_private": false, "id": 99996, "time": "2007-03-03T03:30:47Z", "creator": "sebb@apache.org", "creation_time": "2007-03-03T03:30:47Z", "text": "Now fixed in SVN. \n\nIt will be in the next release and the next nightly build at:\n\nhttp://people.apache.org/builds/jakarta-jmeter/nightly/"}]