[{"count": 0, "tags": [], "bug_id": 35486, "attachment_id": null, "id": 76661, "time": "2005-06-23T17:51:25Z", "creator": "c.dupuis@type3.com", "creation_time": "2005-06-23T17:51:25Z", "is_private": false, "text": "When opening a file with POIFSFileSystem fs = new POIFSFileSystem(fis);\nif this file have a size not modulus 0x200 then an exception occured.\n\nIt's seem that old Ole Document can have this size for example : 539 990 bytes\n(0x83D56).\n\nIf the file is re save with new softwar, then the size is : 603 136 bytes (0x93400)\n\nI have done a patch in RawDataBlock\n        _data = new byte[ POIFSConstants.BIG_BLOCK_SIZE ];\n        int count = IOUtils.readFully(stream, _data);\n\n        if (count == -1)\n        {\n            _eof = true;\n        }\n        else if (count != POIFSConstants.BIG_BLOCK_SIZE)\n        {\n            String type = \" byte\" + ((count == 1) ? (\"\")\n                                                  : (\"s\"));\n/*\n            throw new IOException(\"Unable to read entire block; \" + count\n                                  + type + \" read; expected \"\n                                  + POIFSConstants.BIG_BLOCK_SIZE + \" bytes\");\n                                  */\n                                 System.err.println(\"Unable to read entire\nblock; \" + count\n                                 + type + \" read; expected \"\n                                 + POIFSConstants.BIG_BLOCK_SIZE + \" bytes\"\n);\n        }\n        else\n        {\n            _eof = false;\n        }"}, {"count": 1, "tags": [], "text": "I'm thinking this has to be a really old document that doesn't conform to the \ncurrent model for OLE documents. Under the current model, documents have to be \nwritten in blocks and the block size is a power of 2. The only block size that \nwould make sense for the document cited is *2 bytes*, which would be extremely \ninefficient.", "attachment_id": null, "bug_id": 35486, "id": 76732, "time": "2005-06-27T14:47:17Z", "creator": "marc.johnson@sas.com", "creation_time": "2005-06-27T14:47:17Z", "is_private": false}]