[{"text": "Since r1448831 (7.0.39) tools.jar is no longer mentioned in jarsToSkip\n\nSteps to reproduce\n1. Use Eclipse IDE, version for JavaEE developers.\nI am using 3.7.2 (Indigo SR2) here.\n\n2. Configure it to use a JDK.\n\n3. Configure a new Server from Tomcat 7.0.39\nIn Java EE perspective, go to Servers view, right-click, choose \"New -> Server\" from context menu.\n\n4. Examine launch configuration of the server.\nIn Servers view click on the server instance. A new page opens in Editor area. Click on \"Open launch configuration\" link there. Go to \"Classpath\" tab.\n\nNote that the following JARs are in the classpath:\n* bootstrap.jar\n* tomcat-juli.jar\n* tools.jar\n\n5. Deploy a web application on this server and start it.\nIf you have configured logging (with -Djava.util.logging.config.file in the same launch configuration dialog), you may see complaints that there are no TLDs in tools.jar.\n\n\n02-Apr-2013 18:24:39.637 INFO [main] org.apache.catalina.core.StandardEngine.startInternal Starting Servlet Engine: Apache Tomcat/7.0.39\n(...)\n02-Apr-2013 23:08:54.355 FINE [tc-http-2] org.apache.jasper.compiler.TldLocationsCache.tldScanJar No TLD files were found in [file:/C:/Program%20Files/Java/jdk1.6.0_43/lib/tools.jar]. Consider adding the JAR to the tomcat.util.scan.DefaultJarScanner.jarsToSkip or org.apache.catalina.startup.TldConfig.jarsToSkip property in CATALINA_BASE/conf/catalina.properties file.\n\n\n\nThere are two ways to fix this\na) add \"tools.jar\" to jarsToSkip property\nb) do not scan jars in classpath.\n\n\nIn r1448831 in StandardJarScanner.java this b) would be\nreplace\n  stopLoader = ClassLoader.getSystemClassLoader().getParent();\nwith\n  stopLoader = ClassLoader.getSystemClassLoader();\n\nI see a problem with such a change, though.\n\nI think that there is no need to scan SystemClassLoader's classpath when Tomcat is launched via Bootstrap class.\n\nI think that we have to scan SystemClassLoader's classpath when launched in embedded mode via Tomcat class. Is is because it does not set up classloaders hierarchy like it is done by Bootstrap.", "tags": [], "bug_id": 54791, "is_private": false, "count": 0, "id": 166339, "time": "2013-04-02T20:08:28Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2013-04-02T20:08:28Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 54791, "attachment_id": null, "id": 166665, "creation_time": "2013-04-16T22:19:29Z", "time": "2013-04-16T22:19:29Z", "creator": "markt@apache.org", "text": "Why is tools.jar on the classpath in the first place?", "is_private": false}, {"count": 2, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 166830, "time": "2013-04-24T20:08:02Z", "bug_id": 54791, "creation_time": "2013-04-24T20:08:02Z", "is_private": false, "text": "I'm very tempted to say that if Eclipse wants to add tools.jar to the classpath then Eclipse should be adding tools.jar to jarsToSkip as well and resolve this as INVALID.\n\nThat said, Eclipse is widely enough used that adding tools.jar back to the default jarsToSkip is probably the better option."}, {"count": 3, "tags": [], "bug_id": 54791, "attachment_id": null, "text": "(In reply to comment #1)\n> Why is tools.jar on the classpath in the first place?\n\nI guess they are following some old docs.\n(Or is there anyone who actually uses JDK compiler with Jasper?)\n\nIn our Tomcat 8 documentation \"tools.jar\" is mentioned on two pages, \njasper-howto.html\nwindows-service-howto.html\n\n(The later one should probably be corrected).\n\n> That said, Eclipse is widely enough used that adding tools.jar back to the\n> default jarsToSkip is probably the better option.\n\nAgreed.", "id": 166832, "time": "2013-04-24T20:16:43Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2013-04-24T20:16:43Z", "is_private": false}, {"count": 4, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "is_private": false, "id": 166833, "time": "2013-04-24T20:17:24Z", "bug_id": 54791, "creation_time": "2013-04-24T20:17:24Z", "text": "Fixed in trunk and 7.0.x and will be included in 7.0.40 onwards."}]