[{"count": 0, "tags": [], "bug_id": 55555, "attachment_id": 30835, "text": "Created attachment 30835\nThe java file to reproduce the problem\n\nHi,\n\nI have a very strange problem with cells on which I want to have:\n1) a colored background pattern\n2) a border\n\nI've just created a java class to reproduce the problem. First you can execute it and you will get a XSLX file in which there will be some cells (25x25). These cells have all a colored background pattern.\n\nNow, in the java class, let's set boolean _DRAW_BORDER to true, compile and execute. In the result file, you will now see that some cells have a border. In these cells the background pattern is ok, but not the color which is now black.\n\nThis can be reproduced with POI1.9 and POI3.10b.\n\nThanks", "id": 170090, "time": "2013-09-13T13:26:08Z", "creator": "gguillaud@cegid.com", "creation_time": "2013-09-13T13:26:08Z", "is_private": false}, {"count": 1, "tags": [], "text": "Created attachment 30836\nThe result file with some bordered cells", "attachment_id": 30836, "bug_id": 55555, "id": 170091, "time": "2013-09-13T13:27:33Z", "creator": "gguillaud@cegid.com", "creation_time": "2013-09-13T13:27:33Z", "is_private": false}, {"count": 2, "tags": [], "text": "I have the same problem using POI 3.10-beta2", "is_private": false, "id": 170227, "creator": "gguillaud@cegid.com", "time": "2013-09-23T14:30:27Z", "bug_id": 55555, "creation_time": "2013-09-23T14:30:27Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 55555, "attachment_id": null, "id": 173012, "time": "2014-02-12T17:04:48Z", "creator": "gguillaud@cegid.com", "creation_time": "2014-02-12T17:04:48Z", "is_private": false, "text": "I still have the same issue using POI 3.10 final\nI was hoping it would have been fixed. Will it be fix in POI 4.0 ?\nPlease answer me, I must say something to my applications's users ..."}, {"count": 4, "tags": [], "text": "If you recreate the file in Excel, unzip the POI .xlsx and the Excel .xlsx, then compare the various xml files (especially style ones), how do they differ?", "attachment_id": null, "bug_id": 55555, "id": 173013, "time": "2014-02-12T17:11:02Z", "creator": "apache@gagravarr.org", "creation_time": "2014-02-12T17:11:02Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 55555, "attachment_id": 31309, "is_private": false, "id": 173026, "time": "2014-02-13T15:36:13Z", "creator": "gguillaud@cegid.com", "creation_time": "2014-02-13T15:36:13Z", "text": "Created attachment 31309\nsample file generated using POI"}, {"count": 6, "tags": [], "bug_id": 55555, "attachment_id": 31310, "text": "Created attachment 31310\nSame sample file got from Excel", "id": 173027, "time": "2014-02-13T15:36:45Z", "creator": "gguillaud@cegid.com", "creation_time": "2014-02-13T15:36:45Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 55555, "attachment_id": null, "is_private": false, "id": 173028, "time": "2014-02-13T15:40:13Z", "creator": "gguillaud@cegid.com", "creation_time": "2014-02-13T15:40:13Z", "text": "Hi Nick,\nI've just uploaded the 2 XSLX files. There are a lot of differences between them. I do not understand everything, what I see is that the xl/styles.xml is bigger in the \"from POI\" than in the \"From Excel\".\n\nIf you want to reproduce the problem, I've already uploaded a Java source file which can do that.\n\nRegards\nGilles"}, {"count": 8, "tags": [], "bug_id": 55555, "attachment_id": null, "id": 174267, "time": "2014-04-04T07:28:39Z", "creator": "gguillaud@cegid.com", "creation_time": "2014-04-04T07:28:39Z", "is_private": false, "text": "Hi Nick, do you have any idea when this issue will be resolved ? Will it be in 3.11 final ? If it is not, I'll have to forget POI and choose another solution :-(\nRegards\nGilles"}, {"count": 9, "tags": [], "bug_id": 55555, "attachment_id": null, "id": 174268, "time": "2014-04-04T08:45:08Z", "creator": "apache@gagravarr.org", "creation_time": "2014-04-04T08:45:08Z", "is_private": false, "text": "(In reply to Gilles from comment #8)\n> Hi Nick, do you have any idea when this issue will be resolved ?\n\nIt'll be fixed when someone (be they a POI committer, or a community member) decides it's enough of a problem for them to sit down and write a patch...\n\nIf this bug matters to you, I'd suggest you join the dev list, and ask for advice on how to debug this style of problem"}, {"count": 10, "tags": [], "bug_id": 55555, "attachment_id": null, "id": 174270, "time": "2014-04-04T10:29:18Z", "creator": "gguillaud@cegid.com", "creation_time": "2014-04-04T10:29:18Z", "is_private": false, "text": "Ok Nick, I understand. Thank you for your answer.\nRegards\nGilles"}, {"count": 11, "tags": [], "bug_id": 55555, "attachment_id": null, "text": "Gilles,\n\nAny chance you could trim your Excel files and Java test code down to the bare minimum needed to reproduce the problem? It would make diffing the Excel files easier to figure out what's going on.\n\nIf not, this bug will probably get closed as not reproducible.", "id": 189994, "time": "2016-04-06T04:02:48Z", "creator": "onealj@apache.org", "creation_time": "2016-04-06T04:02:48Z", "is_private": false}, {"count": 12, "tags": [], "bug_id": 55555, "attachment_id": null, "is_private": false, "id": 190021, "time": "2016-04-06T15:50:49Z", "creator": "jmarkmurph@yahoo.com", "creation_time": "2016-04-06T15:50:49Z", "text": "This may be easier to fix once #58787 is complete."}, {"count": 13, "tags": [], "bug_id": 55555, "attachment_id": null, "text": "This bug might be able to be simplified into something with unrecognized attributed by CellUtil.getFormatProperties, which means searching for a matching style in the cell style table returns an imperfect match.", "id": 191736, "time": "2016-06-17T09:24:45Z", "creator": "onealj@apache.org", "creation_time": "2016-06-17T09:24:45Z", "is_private": false}, {"count": 14, "tags": [], "bug_id": 55555, "attachment_id": null, "is_private": false, "id": 192245, "time": "2016-07-08T15:47:52Z", "creator": "xgzaaa@gmail.com", "creation_time": "2016-07-08T15:47:52Z", "text": "Added a pull request on GitHub with a fix of this bug: https://github.com/apache/poi/pull/33\n\nI have tested this issue after applying this fix using a java file attached by Gilles. It solves the problem.\n\nFix description:\nCellUtil was setting background color BEFORE setting foreground and fill pattern. And HSSFCellStyle.setFillBackgroundColor javadoc says that background color should be set AFTER setting fill pattern and foreground."}, {"count": 15, "tags": [], "text": "I'm sorry. It fixes only similar HSSF issue. Just a half of a problem.", "is_private": false, "id": 192252, "creator": "xgzaaa@gmail.com", "time": "2016-07-08T18:27:11Z", "bug_id": 55555, "creation_time": "2016-07-08T18:27:11Z", "attachment_id": null}, {"count": 16, "tags": [], "bug_id": 55555, "attachment_id": null, "is_private": false, "id": 192253, "time": "2016-07-08T18:46:07Z", "creator": "onealj@apache.org", "creation_time": "2016-07-08T18:46:07Z", "text": "Applied pull request from comment 14 in r1751955 with corresponding unit test."}]