[{"count": 0, "tags": [], "text": "I just compiled 2.0.48 with mod_proxy included.  I have two httpd's already\nrunning, listening to different ports, and all config files test Syntax OK.  The\nfirst two are running fine:\n\n# cat /usr/local/apache2/logs/httpd.hawk.pid\n4157\n# ps ax | grep 'httpd' | grep 'hawk'\n 4157 ?        S      0:00 bin/httpd -f conf/httpd.conf.hawk\n 4158 ?        S      0:00 bin/httpd -f conf/httpd.conf.hawk\n 4159 ?        S      0:00 bin/httpd -f conf/httpd.conf.hawk\n 4160 ?        S      0:00 bin/httpd -f conf/httpd.conf.hawk\n 4191 ?        S      0:00 bin/httpd -f conf/httpd.conf.hawk\n 4192 ?        S      0:00 bin/httpd -f conf/httpd.conf.hawk\n\n# cat /usr/local/apache2/logs/httpd.immuno.pid \n4143\n# ps ax | grep 'httpd' | grep 'immuno'\n 4143 ?        S      0:00 bin/httpd -f conf/httpd.conf.immuno\n 4144 ?        S      0:00 bin/httpd -f conf/httpd.conf.immuno\n 4249 ?        S      0:00 bin/httpd -f conf/httpd.conf.immuno\n\nNow trying to run a third so that I can proxypass to it from the first one.\nWhen I run httpd with my custom config file, I do not get any errors on the\ncommmand-line, but this shows up in the error log:\n\n[Mon Jan 19 15:19:22 2004] [emerg] (28)No space left on device: Couldn't create\naccept lock\n\nApache did create the lock file (which is specified in the config file and is on\na local filesystem), and it's exactly the same as the other two:\n\n# dir /usr/local/apache2/logs/\ntotal 24\ndrwxr-sr-x    2 root     root         4096 Jan 19 15:19 ./\ndrwxr-sr-x   15 root     root         4096 Jan 19 14:00 ../\n-rw-r--r--    1 root     root            5 Jan 19 14:59 httpd.hawk.pid\n-rw-r--r--    1 root     root            5 Jan 19 14:58 httpd.immuno.pid\n-rw-r--r--    1 root     root            5 Jan 19 15:19 httpd.wss.pid\n\nBut this instance of Apache is not running:\n\n# cat /usr/local/apache2/logs/httpd.wss.pid    \n4396\n# ps ax | grep 'httpd' | grep 'wss'\n\nThis problem may be in the mod_proxy component; I'm no expert in this.\n\nI've plenty of space in this filesystem:\n# df -h .\nFilesystem            Size  Used Avail Use% Mounted on\n/dev/hda10             37G   27G  9.0G  75% /\n\nMy kernel:\n# uname -a\nLinux badass.jedihawk.net 2.4.16 #1 SMP Tue Feb 19 09:53:17 PST 2002 i686 unknown\n# uptime\n  3:51pm  up 477 days,  6:39, 34 users,  load average: 0.14, 0.12, 0.21\n\nHope this helps.\nPlease email me if I've left out anything: jedihawk@mail.com", "is_private": false, "id": 50794, "creator": "jedihawk@mail.com", "time": "2004-01-20T00:03:30Z", "bug_id": 26265, "creation_time": "2004-01-20T00:03:30Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "The default accept mutex mechanism on linux is sysvsem. Seems you're running out\nof semaphores.\nYou should consider to use another mechanism, see AcceptMutex directive.\n\nI'm marking it invalid for now. Feel free to reopen the report if there are\nfurther issues.", "is_private": false, "id": 51306, "creator": "nd@perlig.de", "time": "2004-01-28T18:53:15Z", "bug_id": 26265, "creation_time": "2004-01-28T18:53:15Z", "attachment_id": null}, {"count": 2, "tags": [], "text": "I had similar problem on Gentoo linux right now. I was facing weird problems\nwith mod_python last weeks. Time to time mod_python runs in 'restricted mode'.\nOnce I have realized the poblem appears fortunately reproducibly with some tiny\ntest code I had. The code was in python and was using cElementTree module.\n\nThe error generated by python was:\n\nIOError: file() constructor not accessible in restricted mode \n\nI've emailed Fredrik Lundh, and ofr the sake of the archive I'm attaching what\nI wrote. I was using apache-2.0.54-r7 (and 2.0.54-r11), mod_python-3.1.3-r1 (and\n3.1.4), celementtree-1.0 (and celementtree-1.0.2), elementtree-1.2:\n\nHi Fredrik,\n some definitely the problem is with cElementTree. When I use\nElementTree isntead, the problem goes away. It manifests with\napache holding lots of semaphores and I believe why I saw using\nstrace one of the apache processes not willing to exit on apache\nshutdown doing this:\n\nProcess 6424 attached - interrupt to quit\nselect(0, NULL, NULL, NULL, {0, 74000}) = 0 (Timeout)\nwaitpid(-1, 0xbffffb30, WNOHANG|WSTOPPED) = 0\nselect(0, NULL, NULL, NULL, {1, 0})     = 0 (Timeout)\nwaitpid(-1, 0xbffffb30, WNOHANG|WSTOPPED) = 0\nselect(0, NULL, NULL, NULL, {1, 0})     = 0 (Timeout)\nwaitpid(-1, 0xbffffb30, WNOHANG|WSTOPPED) = 0\nselect(0, NULL, NULL, NULL, {1, 0})     = 0 (Timeout)\n\n\nI recompiled apache to make sure the problem is not in there\nand turned on debug log, but I couldn't restart apache anylonger.\nActually, I could not shut it down. I killed the threads with -9\nbut I couldn't start it either, and found these errors:\n\n[Sun Jul 03 00:47:09 2005] [info] mod_unique_id: using ip addr 195.113.57.20\n[Sun Jul 03 00:47:10 2005] [info] Init: Initializing OpenSSL library\n[Sun Jul 03 00:47:10 2005] [info] Init: Seeding PRNG with 512 bytes of entropy\n[Sun Jul 03 00:47:10 2005] [info] Init: Generating temporary RSA private keys\n(512/1024 bits)\n[Sun Jul 03 00:47:10 2005] [info] Init: Generating temporary DH parameters\n(512/1024 bits)\n[Sun Jul 03 00:47:10 2005] [info] Init: Initializing (virtual) servers for SSL\n[Sun Jul 03 00:47:10 2005] [info] Server: Apache/2.0.54, Interface:\nmod_ssl/2.0.54, Library: OpenSSL/0.9.7g\n[Sun Jul 03 00:47:10 2005] [info] mod_unique_id: using ip addr 195.113.57.20\n[Sun Jul 03 00:47:11 2005] [notice] mod_python: Creating 32 session mutexes\nbased on 16 max processes and 2 max threads.\n[Sun Jul 03 00:47:11 2005] [error] (28)No space left on device: mod_python:\nFailed to create global mutex 0 of 32 (/tmp/mpmtx293580).\nConfiguration Failed\n\nThe machine had gigabytes of diskspace so that wasn't the problem.\n\nLuckily I found this page http://www2.goldfisch.at/knowledge/224\nso I've managed to kill those semaphores hanging around without machine\nreboot.\n\nI could start apache again and replace all cElementTree uses with\nElementTree in my program. And then it was clear. Just to be sure\nI've compiled/installed cElementTree-1.0.2 but that did not help,\nnor downgrade back to cElementTree-1.0. Based on that \"goldfisch\"\nwebpage I think problem might be some memleak causing apache being\nthe parent process not to exit? Is this scenario possible?\nMartin ", "is_private": false, "id": 76933, "creation_time": "2005-07-03T03:15:01Z", "time": "2005-07-03T03:15:01Z", "creator": "mmokrejs@ribosome.natur.cuni.cz", "bug_id": 26265, "attachment_id": null}]