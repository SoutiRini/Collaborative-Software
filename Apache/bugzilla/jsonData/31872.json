[{"count": 0, "tags": [], "bug_id": 31872, "text": "When running mod_deflate, downloading ZIP and MSI files (by clicking on a URL \nwhich points to the file, eg http://www.mysite.com/test.zip) results in \ncorrupted files. It appears to be OK for very small files but files over 1M \nseem to fail consistently. The problem does not occur in 2.0.47 and talk on \nthe web suggests this fault appeared in 2.0.48 or 2.0.49. \n\nThe file size of downloaded file is incorrect (a bit too large) and a quick \nlook at the file internals it appears all lines of the file are prepended with \nsome garbage (50-100 characters). Removing this extra data still results in a \ncorrupt file (which is considerably smaller than the source file).", "id": 65627, "time": "2004-10-25T02:56:25Z", "creator": "paul@ensigma.com.au", "creation_time": "2004-10-25T02:56:25Z", "is_private": false, "attachment_id": null}, {"count": 1, "attachment_id": null, "bug_id": 31872, "text": "Please provide an example.  If you can put a zip file on your server at two\nURLs, one served correctly as-is and the other corrupted, we can try and\nreproduce your problem.\n\nHow are we supposed to fix it if we can't reproduce it?  My crystal ball isn't\nthat good.", "id": 65635, "time": "2004-10-25T08:06:54Z", "creator": "nick@webthing.com", "creation_time": "2004-10-25T08:06:54Z", "tags": [], "is_private": false}, {"count": 2, "attachment_id": null, "bug_id": 31872, "text": "Whilst I take your point - I suspect any attempt to replicate the bug would \nhave been successful. I have tested it on 4 separate servers and all showed \nthe bug but unfortunately none of them are open to the world. As you might \nimagine I didn't really want to break my live server. Anyhoo, I have a testing \nweb server running 2.0.50 so I have made that live.\n\n  http://www.ensigma.com.au/test.zip\n\nwill be compressed by mod_deflate and consequently corrupted.\n\n  http://www.ensigma.com.au/test.zup \n\nhas been specifically excluded from compression and so (when renamed to \na .ZIP) it will contain an uncorrupted version of test.zip (which is some \nsuitably sized PostgreSQL documentation.\n\nAs an aside I am changing ISPs on Oct 27 and so my website may disappear for a \nshort period. If you hit it during this downtime then please don't give up - \nit will be back soon :-)", "id": 65674, "time": "2004-10-25T23:41:35Z", "creator": "paul@ensigma.com.au", "creation_time": "2004-10-25T23:41:35Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 31872, "is_private": false, "text": "Well, early morning on the 26th I got no response from that server.  Now on the\n28th I get a 404 from both those URLs.", "id": 65888, "time": "2004-10-28T09:26:53Z", "creator": "nick@webthing.com", "creation_time": "2004-10-28T09:26:53Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 31872, "is_private": false, "text": "Alas my server has been cactus - the \"probably about 40 minutes and definitely \nno more than two hours\" downtime I was told would occur in changing ISPs \nturned into 12 hours plus the time for the domain redelegation to propogate. \nIt should all be OK now. Sorry for any inconvenience :-(", "id": 65891, "time": "2004-10-28T11:11:23Z", "creator": "paul@ensigma.com.au", "creation_time": "2004-10-28T11:11:23Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 31872, "text": "Your test.zip arrives correctly:\n$ unzip test.zip\nArchive:  test.zip\n  inflating: PostgreSQL/reference-7.2-A4.pdf\n  inflating: PostgreSQL/programmer-7.2-A4.pdf\n  inflating: PostgreSQL/developer-7.2-A4.pdf\n  inflating: PostgreSQL/admin-7.2-A4.pdf\n\nof course, since zip is already compressed, running it through mod_deflate is an\nexpensive operation for very little or no gain, so it's dumb to do it.  But it's\nworking correctly on your server.\n\nI expect your browser just isn't designed to deal with re-gzipped zip.", "id": 65893, "time": "2004-10-28T12:13:32Z", "creator": "nick@webthing.com", "creation_time": "2004-10-28T12:13:32Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 31872, "is_private": false, "text": "Good point - I should have tried another browser to rule that out - in \nhindsight it seems obvious that my first reaction should have been to try and \nblame Microsoft! Perhaps you should reintroduce the code which stopped a ZIP \nbeing zipped because my site ran fine with 2.0.48 and was broken with 2.0.52. \nThanks for your help.", "id": 65950, "time": "2004-10-28T22:22:34Z", "creator": "paul@ensigma.com.au", "creation_time": "2004-10-28T22:22:34Z", "attachment_id": null}]