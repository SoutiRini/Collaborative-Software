[{"attachment_id": null, "tags": [], "bug_id": 38106, "is_private": false, "count": 0, "id": 84151, "time": "2006-01-03T12:01:29Z", "creator": "a_cogito@yahoo.fr", "creation_time": "2006-01-03T12:01:29Z", "text": "This task fails when more than one file is specified and the xsl/xml document\ndoesn't contains the schemaLocation.\n\nexample:\n\n<xmlvalidate failonerror=\"yes\" lenient=\"no\" warn=\"yes\">\n<attribute name=\"http://xml.org/sax/features/validation\" value=\"true\"/>\n<attribute name=\"http://apache.org/xml/features/validation/schema\"  value=\"true\"/>\n<attribute name=\"http://xml.org/sax/features/namespaces\" value=\"true\"/>\n<property\nname=\"http://apache.org/xml/properties/schema/external-schemaLocation\"\nvalue=\"http://www.w3.org/1999/XSL/Transform\nhttp://www.w3.org/2005/02/schema-for-xslt20.xsd\"/>\n<fileset dir=\"xsl-no-schemaLocation\" includes=\"*.xsl\"/>\n</xmlvalidate>\n\nYou can find the <property> documentation here:\nhttp://xerces.apache.org/xerces-j/properties.html\n\nHas said in this doc:\n\"The XML Schema Recommendation explicitly states that the inclusion of\nschemaLocation/ noNamespaceSchemaLocation attributes is only a hint(...)\"\n\nThe W3C doc about this: http://www.w3.org/TR/xmlschema-1/#xsi_schemaLocation\n\"2.6.3 xsi:schemaLocation, xsi:noNamespaceSchemaLocation\nThe xsi:schemaLocation and xsi:noNamespaceSchemaLocation attributes can be used\nin a document to provide hints as to the physical location of schema documents\nwhich may be used for \u00b7assessment\u00b7. See How schema definitions are located on\nthe Web (\u00a74.3.2) for details on the use of these attributes.\"\n\n\nIn my case, I have a lot of xsl with no schemaLocation specified.\nI can't add the schemaLocation to all those files, so I need to specify the xsd\n location from \"outside\" (aka in the ant file).\n\nI'll provide a showcase as an attachement of this bug."}, {"count": 1, "tags": [], "bug_id": 38106, "attachment_id": 17312, "text": "Created attachment 17312\nbuild file and sample files", "id": 84152, "time": "2006-01-03T12:02:56Z", "creator": "a_cogito@yahoo.fr", "creation_time": "2006-01-03T12:02:56Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 38106, "attachment_id": null, "text": "After further investigations, I found a patch but I not sure it's a xerces bug\nor functionnality ?!\n\nSomehow the properties set on the XMLReader are lost after the first parse on\nthe first file of fileset?!\n\nAccording to the javadoc:\nhttp://xerces.apache.org/xerces-j/apiDocs/org/xml/sax/XMLReader.html#setProperty(java.lang.String,%20java.lang.Object)\n\n\"Some property values may be immutable or mutable only in specific contexts,\nsuch as before, during, or after a parse.\"\n\nThis could mean anything and it's contrary !\n\nMy solution is to set the properties every time we try do parse().\nSince it's just setting values in a hashmap it's not time consuming.\n\nsee attached svn-patch.", "id": 84157, "time": "2006-01-03T15:21:38Z", "creator": "a_cogito@yahoo.fr", "creation_time": "2006-01-03T15:21:38Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 38106, "attachment_id": 17313, "text": "Created attachment 17313\nset parser properties just before parse method", "id": 84158, "time": "2006-01-03T15:22:32Z", "creator": "a_cogito@yahoo.fr", "creation_time": "2006-01-03T15:22:32Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 38106, "is_private": false, "count": 4, "id": 84192, "time": "2006-01-03T22:27:51Z", "creator": "stevel@apache.org", "creation_time": "2006-01-03T22:27:51Z", "text": "This should already be fixed in the SVN_HEAD version of Ant. please grab a copy\nand see if the problem is fixed. There are gump tests that do bulk\n<schemavalidate>, so I strongly believe it is fixed.\n\nI think we actually do it less efficiently, by creating a new parser instance\neach time, so it may give a performance boost to code"}, {"count": 5, "text": "yes it does work with the SVN trunk :)\n\nThanks.\nThe performance issue is not a problem for me right now.\n\nFeel free to close this bug or change it's status ;)", "creator": "a_cogito@yahoo.fr", "is_private": false, "id": 84212, "time": "2006-01-04T16:55:42Z", "bug_id": 38106, "creation_time": "2006-01-04T16:55:42Z", "tags": [], "attachment_id": null}, {"count": 6, "tags": [], "creator": "bodewig@apache.org", "is_private": false, "text": "http://svn.apache.org/viewcvs.cgi?rev=278246&view=rev", "id": 85154, "time": "2006-01-28T15:32:43Z", "bug_id": 38106, "creation_time": "2006-01-28T15:32:43Z", "attachment_id": null}]