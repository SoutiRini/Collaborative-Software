[{"count": 0, "tags": [], "bug_id": 35940, "attachment_id": null, "is_private": false, "id": 77849, "time": "2005-07-30T17:44:12Z", "creator": "mm@arcus.com.au", "creation_time": "2005-07-30T17:44:12Z", "text": "Had a first go at using 1.0dev as replacement for 0.20.5 and noticed a few\nproblems with my sample:\n\n1. Everything seems to be rendered in Times Roman font although the specified\nfont selection is \"Verdana, Arial, Helvetica, sans-serif\"\n2. A line is broken when it doesn't needed to, i.e. the text \"Victorian Land\nIndex Property Address Search Result\" is broken into two lines although there is\nplenty of space to have it on one line\n3. There is extra space between table rows, i.e. between the text mentioned\nabove and the date/time line is an empty line in the pdf when it shouldn't be.\n\nI'll attached sample fo and pdfs."}, {"count": 1, "tags": [], "text": "Created attachment 15826\nThe sample FO file", "is_private": false, "id": 77850, "creator": "mm@arcus.com.au", "time": "2005-07-30T17:45:03Z", "bug_id": 35940, "creation_time": "2005-07-30T17:45:03Z", "attachment_id": 15826}, {"count": 2, "tags": [], "creator": "mm@arcus.com.au", "attachment_id": 15827, "text": "Created attachment 15827\nThe PDF as generated with 1.0dev", "id": 77851, "time": "2005-07-30T17:45:58Z", "bug_id": 35940, "creation_time": "2005-07-30T17:45:58Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 35940, "attachment_id": 15828, "id": 77852, "time": "2005-07-30T17:46:39Z", "creator": "mm@arcus.com.au", "creation_time": "2005-07-30T17:46:39Z", "is_private": false, "text": "Created attachment 15828\nThe PDF as generated with 0.20.5"}, {"count": 4, "tags": [], "bug_id": 35940, "attachment_id": null, "is_private": false, "id": 77854, "time": "2005-07-30T18:26:02Z", "creator": "jeremias@apache.org", "creation_time": "2005-07-30T18:26:02Z", "text": "Initial analysis:\n\n(In reply to comment #0)\n> Had a first go at using 1.0dev as replacement for 0.20.5 and noticed a few\n> problems with my sample:\n> \n> 1. Everything seems to be rendered in Times Roman font although the specified\n> font selection is \"Verdana, Arial, Helvetica, sans-serif\"\n\nAs 0.20.5, the trunk code doesn't support the comma-separated font lists, yet.\nIt doesn't even see the \"Helvetica\" or \"sans-serif\" entries. It falls back to\nthe default which seems to have been changed to \"serif\".\n\n> 2. A line is broken when it doesn't needed to, i.e. the text \"Victorian Land\n> Index Property Address Search Result\" is broken into two lines although there is\n> plenty of space to have it on one line\n\nInteresting. Only seems to happen for text-align=\"center\". It doesn't happen\nwith \"start\" or \"justify\". Need to investigate that more closely.\n\n> 3. There is extra space between table rows, i.e. between the text mentioned\n> above and the date/time line is an empty line in the pdf when it shouldn't be.\n\nSame problem. Problem is only present with text-align=\"center\".\n\n> I'll attached sample fo and pdfs.\n\nNote to self: Create a layout engine testcase for this."}, {"count": 5, "tags": [], "bug_id": 35940, "attachment_id": null, "id": 77929, "time": "2005-08-02T12:00:52Z", "creator": "lfurini@cs.unibo.it", "creation_time": "2005-08-02T12:00:52Z", "is_private": false, "text": "It seems that this happens, in particular, when the centered text is much \nshorter than the available width: for example, it is enough to add a 2cm start-\n and end-indent to the first block to have its text placed in a single line.\n\nNote that the 1.0 dev version creates *3* lines for that block: one \nwith \"Victorian Land Index Property Address\", the second with \"Search Result\" \nand a third empty (or so it seems) line.\n\nI think this could have something to do with the restarting mechanism in the \nbreaking algorithm.\n\nI'll try and have a closer look at what happens during the line breaking of \nthis block."}, {"count": 6, "tags": [], "bug_id": 35940, "attachment_id": null, "id": 78698, "time": "2005-08-19T14:08:28Z", "creator": "lfurini@cs.unibo.it", "creation_time": "2005-08-19T14:08:28Z", "is_private": false, "text": "I have finally found where the problem lies:\n\n1) in the sample file there is a trailing space at the end of the centered text\n\n2) the sequence of elements created for a space inside centered text is glue - \npenalty - glue - box - penalty - glue\n\n3) the method LineLayoutManager.endSequence() removes penalty and glue \nelements at the end of the sequence, before adding the final elements; thus, \nthe LineLM removes only the two last elements in the sub-sequence representing \na space, leaving the other 4 elements and corrupting the resulting sequence\n\nSo, the bug could be either in 1 (there should not be a trailing space) or 3 \n(elements removal should be more sophisticated), or maybe in both.\n\nAs white space handling is not a code section I know very well, I'm going to \nfix the endSequence() method. :-)\n"}, {"count": 7, "tags": [], "bug_id": 35940, "is_private": false, "text": "(In reply to comment #6)\n> I have finally found where the problem lies:\n> 1) in the sample file there is a trailing space at the end of the centered \ntext\n\n...because the linefeed after \"Result\" is converted into a space character, \nAFAICT. This is because of the default values for linefeed-treatment and \nwhitespace-treatment (both handled inside fo.flow.Block.handleWhiteSpace() \nduring refinement). \n\n> 2) the sequence of elements created for a space inside centered text is \nglue - \n> penalty - glue - box - penalty - glue\n> 3) the method LineLayoutManager.endSequence() removes penalty and glue \n> elements at the end of the sequence, before adding the final elements; thus, \n> the LineLM removes only the two last elements in the sub-sequence \nrepresenting \n> a space, leaving the other 4 elements and corrupting the resulting sequence\n> So, the bug could be either in 1 (there should not be a trailing space) \n\nNo, I don't think so. I think this is white-space-collapse specified to kick \nin during area tree generation.\n\n> or 3 \n> (elements removal should be more sophisticated), or maybe in both.\n\nOnly 3 IMO.\n\n> As white space handling is not a code section I know very well, I'm going to \n> fix the endSequence() method. :-)\n\nNot the reason I'd have chosen, but I think it's the right place to fix it. :-)\n\nI know white space handling pretty well by now and the linefeed that is \nconverted to a space in this case seems to be correct. It seems like white-\nspace-collapse is the thing that is not working properly. I've also found \nsomething else earlier about leading spaces when white-space cannot collapse. \nI haven't fixed that problem, yet, but it's another story anyway. At any rate, \nwe need good test cases to check for all the combinations. But I don't know if \nthe layout engine facility is good enough to check for all the details that \ncome into play here.", "id": 78707, "time": "2005-08-19T15:53:03Z", "creator": "jeremias@apache.org", "creation_time": "2005-08-19T15:53:03Z", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 35940, "is_private": false, "text": "Fixed, thanks for signalling this bug!", "id": 78982, "time": "2005-08-25T14:20:44Z", "creator": "lfurini@cs.unibo.it", "creation_time": "2005-08-25T14:20:44Z", "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 35940, "attachment_id": null, "is_private": false, "id": 155823, "time": "2012-04-01T06:43:18Z", "creator": "gadams@apache.org", "creation_time": "2012-04-01T06:43:18Z", "text": "batch transition pre-FOP1.0 resolved+fixed bugs to closed+fixed"}]