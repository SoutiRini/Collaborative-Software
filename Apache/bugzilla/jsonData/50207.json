[{"count": 0, "tags": [], "text": "This is reproducible using the the default chat example (ie: ChatServlet, /examples/jsp/chat) and the following additional changes:\n\n1) Enabled Http11Nio in conf/server.xml:\n\n    <Connector \n        address=\"0.0.0.0\" \n        port=\"8080\" \n        protocol=\"org.apache.coyote.http11.Http11NioProtocol\"\n        connectionTimeout=\"20000\" \n        enableLookups=\"false\"\n        acceptCount=\"100\"\n        disableUploadTimeout=\"true\"\n        maxThreads=\"15\"\n        minSpareThreads=\"15\"\n        maxSpareThreads=\"15\"\n        RECYCLE_FACADES=\"true\"/>\n\n2) Enabled the comet valve in conf/context.xml:\n\n  <Valve className=\"org.apache.catalina.valves.CometConnectionManagerValve\" />\n\nThe problem is CometEvent.EventType.ERROR (and subtype TIMEOUT) and CometEvent.EventType.END are never being fired.\n\nThis can be confirmed in the logs; the messages for these events are never printed.  This worked on Tomcat 6.0.29.\n\nAs an aside, what is the most complete/robust way to do async IO in tomcat 7 today, Servlet 3.0 or CometProcessor?", "is_private": false, "bug_id": 50207, "id": 141366, "time": "2010-11-03T14:52:32Z", "creator": "jnorris10@gmail.com", "creation_time": "2010-11-03T14:52:32Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 50207, "attachment_id": null, "id": 141491, "time": "2010-11-05T12:27:36Z", "creator": "jnorris10@gmail.com", "creation_time": "2010-11-05T12:27:36Z", "is_private": false, "text": "Note: timeouts are fired correctly (Tomcat 7.0.4) when the servlet 3.0 API is used instead (ie: javax.servlet.AsyncListener.onTimeout())."}, {"count": 2, "tags": [], "bug_id": 50207, "attachment_id": null, "id": 141948, "time": "2010-11-23T11:59:24Z", "creator": "markt@apache.org", "creation_time": "2010-11-23T11:59:24Z", "is_private": false, "text": "Thanks for the report.\n\nThis has been fixed in 7.0.x and will be included in 7.0.5 onwards."}]