[{"count": 0, "tags": [], "bug_id": 48852, "text": "I'm getting this exception trying to open a .xls excel file.  If I save the file as a new file, the new file opens properly.  This file opens fine with POI 3.0.\n\nI would attach the file but I'm not sure if the content can be shared.  If you really need it then I can find out.\n\norg.apache.poi.hssf.record.RecordFormatException: Duplicate PageSettingsBlock record (sid=0x89c)\n\tat org.apache.poi.hssf.record.aggregates.PageSettingsBlock.checkNotPresent(PageSettingsBlock.java:227)\n\tat org.apache.poi.hssf.record.aggregates.PageSettingsBlock.readARecord(PageSettingsBlock.java:215)\n\tat org.apache.poi.hssf.record.aggregates.PageSettingsBlock.addLateRecords(PageSettingsBlock.java:639)\n\tat org.apache.poi.hssf.model.Sheet.<init>(Sheet.java:222)\n\tat org.apache.poi.hssf.model.Sheet.createSheet(Sheet.java:158)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:287)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:201)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:317)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:298)\n\tat org.apache.poi.ss.usermodel.WorkbookFactory.create(WorkbookFactory.java:60)", "id": 135037, "time": "2010-03-04T02:27:04Z", "creator": "bzane@tomsawyer.com", "creation_time": "2010-03-04T02:27:04Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 48852, "is_private": false, "count": 1, "id": 135087, "time": "2010-03-05T15:37:29Z", "creator": "jtm@mostlyharmless.dk", "creation_time": "2010-03-05T15:37:29Z", "text": "I am seeing this as well, but is currently not able to produce a file that generates the error (the file that causes this is company confidential :-()."}, {"count": 2, "tags": [], "creator": "lex.a@free.fr", "attachment_id": null, "text": "Here : http://www.dirinformatique.com/TELEBUDGET/ you can download (\"T\u00e9l\u00e9charger\") some XLS files that don't work with POI 3.6.\n\nI have the same error with these files:\n\norg.apache.poi.hssf.record.RecordFormatException: Duplicate PageSettingsBlock record (sid=0x89c) VM: 1.6.0_17@http://java.sun.com/ at org.apache.poi.hssf.record.aggregates.PageSettingsBlock.checkNotPresent(PageSettingsBlock.java:227) at org.apache.poi.hssf.record.aggregates.PageSettingsBlock.readARecord(PageSettingsBlock.java:215) at org.apache.poi.hssf.record.aggregates.PageSettingsBlock.addLateRecords(PageSettingsBlock.java:639) at org.apache.poi.hssf.model.Sheet.(Sheet.java:222) at org.apache.poi.hssf.model.Sheet.createSheet(Sheet.java:158) at org.apache.poi.hssf.usermodel.HSSFWorkbook.(HSSFWorkbook.java:287) at org.apache.poi.hssf.usermodel.HSSFWorkbook.(HSSFWorkbook.java:201) at org.apache.poi.hssf.usermodel.HSSFWorkbook.(HSSFWorkbook.java:183) at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39) at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27) at java.lang.reflect.Constructor.newInstance(Constructor.java:513)", "id": 135181, "time": "2010-03-09T08:40:15Z", "bug_id": 48852, "creation_time": "2010-03-09T08:40:15Z", "is_private": false}, {"count": 3, "tags": [], "text": "The problem was fixed in r892468 in Dec 2009. It was after POI-3.6, so you need to download the latest nightly build to try the fix. \n\nAll \"T\u00e9l\u00e9charger\" files are opened OK with POI trunk.\n\nNightly builds can be downloaded from http://encore.torchbox.com/poi-cvs-build/\n\nYegor\n\n*** This bug has been marked as a duplicate of bug 48026 ***", "is_private": false, "id": 135341, "creator": "yegor@dinom.ru", "time": "2010-03-15T06:32:17Z", "bug_id": 48852, "creation_time": "2010-03-15T06:32:17Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "gavr145@gmail.com", "is_private": false, "text": "I'm trying to use the most recent snapshots, as you suggested (with 3.6 I'm getting the exception even after re-saving the file).\nHaving downloaded and after putting into the classpath:\n \npoi-3.7-SNAPSHOT-20100415.jar\npoi-ooxml-3.7-SNAPSHOT-20100415.jar\npoi-contrib-3.7-SNAPSHOT-20100416.jar\n\nI was getting exceptions (ClassNotFound) and also had to put into the classpath:\n\npoi-ooxml-schemas-3.7-SNAPSHOT-20100415.jar\nxmlbeans-2.3.0.jar\ndom4j-1.6.1.jar\n\nNow I'm getting Exception with any file, I'm trying to open (even simple Excel 97): \n\norg.apache.poi.POIXMLException: org.apache.poi.openxml4j.exceptions.InvalidFormatException: Package should contain a content type part [M1.13]\n\tat org.apache.poi.util.PackageHelper.open(PackageHelper.java:41)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:176)\n\tat org.is.jxlpoi.JXLPOIWorkbook.getWorkbook(JXLPOIWorkbook.java:29)\n\nDo you have a suggestion?\n(for a particular snapshot, later than r892468, to use)\n\nthanks\nvasili", "id": 136199, "time": "2010-04-16T10:29:44Z", "bug_id": 48852, "creation_time": "2010-04-16T10:29:44Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 48852, "is_private": false, "count": 5, "id": 136203, "time": "2010-04-16T11:08:38Z", "creator": "gavr145@gmail.com", "creation_time": "2010-04-16T11:08:38Z", "text": "sorry, here is the end of StackTrace:\n\n\nCaused by: org.apache.poi.openxml4j.exceptions.InvalidFormatException: Package should contain a content type part [M1.13]\n\tat org.apache.poi.openxml4j.opc.ZipPackage.getPartsImpl(ZipPackage.java:147)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.getParts(OPCPackage.java:588)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.open(OPCPackage.java:222)\n\tat org.apache.poi.util.PackageHelper.open(PackageHelper.java:39)\n\t... 21 more"}, {"count": 6, "tags": [], "creator": "gavr145@gmail.com", "is_private": false, "text": "Also tried less recent snapshots - getting the same problem/exception...\nPlease, help!", "id": 136207, "time": "2010-04-16T13:40:53Z", "bug_id": 48852, "creation_time": "2010-04-16T13:40:53Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 48852, "attachment_id": null, "is_private": false, "id": 136245, "time": "2010-04-19T10:58:45Z", "creator": "gavr145@gmail.com", "creation_time": "2010-04-19T10:58:45Z", "text": "Please, disregard my message.\nI've started to use WorkbookFactory and now it is fine.\n(I'm using the most recent snapshot)."}]