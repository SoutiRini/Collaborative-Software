[{"count": 0, "tags": [], "creator": "mirko@raner.ws", "attachment_id": null, "id": 73559, "time": "2005-04-12T03:11:38Z", "bug_id": 34411, "creation_time": "2005-04-12T03:11:38Z", "is_private": false, "text": "The init() method of a custom task that I am working on apparently gets called\ntwice. This is probably not intended and the specification does not state that\nthis would be the case.\n\nWhen looking at the source code of UnknownElement.java and ComponentHelper.java\nI get the impression that this behavior still exists in the current HEAD stream.\nUnknownElement.makeObject(...) initially calls\nComponentHelper.createComponent(...) to create a new task or type.\nComponentHelper.createComponent(...), in turn, calls Task.init() and adds the\nnew task. However, at the end of method UnknownElement.makeObject(...) there is\nanother invocation of Task.init(), which calls the init() method of the task for\nthe second time.\n\nI hope I'm not misunderstanding or overlooking something here; I would expect\nthat other custom Ant tasks would have stumbled over this problem before, so I'm\nsomewhat surprised to be the first person to report this problem. Still, the\nproblems that I am encountering with my own task and a look at the current CVS\n(UnknownElement rev. 1.88, ComponentHelper rev. 1.52) suggests that this is\nwhat's happening."}, {"count": 1, "tags": [], "creator": "ddevienne@lgc.com", "attachment_id": null, "is_private": false, "id": 73568, "time": "2005-04-12T16:15:40Z", "bug_id": 34411, "creation_time": "2005-04-12T16:15:40Z", "text": "My bad. I stumbled on that one also, and didn't report it. I was in a hurry, \nand then forgot. I just worked around it in my code. It was the first time the \ndouble init() call created a bug for me. Usually I don't have an init(), or it \ndoesn't add things to a list as in this case. Double creation of a var is \nwasteful but usually benign, while double add to a list was a bug. --DD\n\n  public void init()\n              throws BuildException {\n    // necessary, since init() is called twice!\n    if (_implicit == null) {\n      // Configure and add the implicit folder\n      _implicit = new Folder();\n      ...\n    }\n  }"}, {"count": 2, "tags": [], "creator": "mbenson@apache.org", "attachment_id": null, "id": 73570, "time": "2005-04-12T17:05:03Z", "bug_id": 34411, "creation_time": "2005-04-12T17:05:03Z", "is_private": false, "text": "Since init is called by UE both explicitly and via a call to\nComponentHelper.createComponent() in the same method, I think we can and should\nremove the explicit call from UE.makeObject()."}, {"count": 3, "tags": [], "creator": "mbenson@apache.org", "attachment_id": null, "id": 73572, "time": "2005-04-12T17:12:15Z", "bug_id": 34411, "creation_time": "2005-04-12T17:12:15Z", "is_private": false, "text": "ah, to refine that assessment:  UE should call init only if its result is not\nthe same Object created by the ComponentHelper."}, {"count": 4, "tags": [], "creator": "mbenson@apache.org", "attachment_id": null, "id": 73575, "time": "2005-04-12T19:21:27Z", "bug_id": 34411, "creation_time": "2005-04-12T19:21:27Z", "is_private": false, "text": "Please verify this is fixed in CVS HEAD.\n\nThanks"}, {"count": 5, "tags": [], "creator": "mirko@raner.ws", "attachment_id": null, "id": 75392, "time": "2005-05-26T00:16:13Z", "bug_id": 34411, "creation_time": "2005-05-26T00:16:13Z", "is_private": false, "text": "I just downloaded the nightly snapshot 20050525161200, and the problem is fixed\nin that build.\n"}, {"count": 6, "attachment_id": null, "bug_id": 34411, "is_private": false, "id": 75396, "time": "2005-05-26T00:26:47Z", "creator": "mbenson@apache.org", "creation_time": "2005-05-26T00:26:47Z", "tags": [], "text": "Thanks!"}]