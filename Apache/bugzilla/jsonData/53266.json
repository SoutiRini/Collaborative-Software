[{"count": 0, "tags": [], "text": "When using a ServletContainerInitializer with a HandlesTypes annotation if any of the classes specified in the HandlesTypes annotation are not available due to a missing jar file catalina will crash with a \"java.lang.ArrayStoreException: sun.reflect.annotation.TypeNotPresentExceptionProxy\".\n\nCaused by: java.lang.ArrayStoreException: sun.reflect.annotation.TypeNotPresentExceptionProxy\n\tat sun.reflect.annotation.AnnotationParser.parseClassArray(AnnotationParser.java:653)\n\tat sun.reflect.annotation.AnnotationParser.parseArray(AnnotationParser.java:460)\n\tat sun.reflect.annotation.AnnotationParser.parseMemberValue(AnnotationParser.java:286)\n\tat sun.reflect.annotation.AnnotationParser.parseAnnotation(AnnotationParser.java:222)\n\tat sun.reflect.annotation.AnnotationParser.parseAnnotations2(AnnotationParser.java:69)\n\tat sun.reflect.annotation.AnnotationParser.parseAnnotations(AnnotationParser.java:52)\n\tat java.lang.Class.initAnnotationsIfNecessary(Class.java:3070)\n\tat java.lang.Class.getAnnotation(Class.java:3029)\n\tat org.apache.catalina.startup.ContextConfig.processServletContainerInitializers(ContextConfig.java:1546)\n\tat org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1222)\n\tat org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:855)\n\tat org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:345)\n\tat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n\tat org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)\n\tat org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5161)\n\tat org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n\t... 7 more\n\nLine where exception is thrown: \"HandlesTypes ht = sci.getClass().getAnnotation(HandlesTypes.class);\"", "attachment_id": null, "bug_id": 53266, "id": 159184, "time": "2012-05-20T14:32:34Z", "creator": "kevin@roseassociation.com", "creation_time": "2012-05-20T14:32:34Z", "is_private": false}, {"count": 1, "tags": [], "text": "Would you expect anything else to happen?", "attachment_id": null, "bug_id": 53266, "id": 159202, "time": "2012-05-21T20:15:46Z", "creator": "chris@christopherschultz.net", "creation_time": "2012-05-21T20:15:46Z", "is_private": false}, {"count": 2, "tags": [], "creator": "kevin@roseassociation.com", "is_private": false, "text": "I would like to see tomcat gracefully shutdown with an error message prudent to the reason instead of an ArrayStoreException.\n\nAs it is possible for any library to contain a ServlerContainerInitializer if for any reason a need dependency in any library is missing this is possible to occur.", "id": 159206, "time": "2012-05-22T03:09:36Z", "bug_id": 53266, "creation_time": "2012-05-22T03:09:36Z", "attachment_id": null}, {"count": 3, "tags": [], "text": "Note the spec requires that the web application is permitted to start in this case.\n\nThis has been fixed in trunk and 7.0.x and will be included in 7.0.28 onwards.", "attachment_id": null, "bug_id": 53266, "id": 159895, "time": "2012-06-11T21:00:24Z", "creator": "markt@apache.org", "creation_time": "2012-06-11T21:00:24Z", "is_private": false}]