[{"count": 0, "tags": [], "bug_id": 42239, "text": "I've recently tried to verify a signature from the austrian citizen\nsecurity card (www.buergerkarte.at), which uses ECDSA-singatures.\n\n  Unfortunately, the code in SignatureECDSA.java passes the\nSignatureValue directly to the JCE-provider. However, the ECDSA\nxml-security spec at ftp://ftp.rfc-editor.org/in-notes/rfc4050.txt\nstates, that the ECDSA SignatureValue is a concatenation of the raw\nBigIntegers. This is in line with the semantics of SignatureValue for\nconventional DSA signatures (SignatureDSA.java), where the\nSignatureValue is converted to the ASN1 representation used by the JCE\nprovider.\n\n  The attached patch adopts the procedure of converting the\nSignatureValue to ASN.1 for the ECDSA algorithm. With this patch\napplied to xmlsec-1.4.0 I can verify the signatures of my austrian card.\n(An example is attached)\n\n  Regards,\n\n    Wolfgang", "id": 102318, "time": "2007-04-25T06:27:37Z", "creator": "wolfgang.glas@iteg.at", "creation_time": "2007-04-25T06:27:37Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "wolfgang.glas@iteg.at", "attachment_id": 20038, "text": "Created attachment 20038\nPatch to the ECDSA signature algoithm implementation.", "id": 102319, "time": "2007-04-25T06:28:40Z", "bug_id": 42239, "creation_time": "2007-04-25T06:28:40Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 42239, "text": "Created attachment 20039\nA sample signature from the suatrin citizen card.", "id": 102321, "time": "2007-04-25T06:31:40Z", "creator": "wolfgang.glas@iteg.at", "creation_time": "2007-04-25T06:31:40Z", "is_private": false, "attachment_id": 20039}, {"count": 3, "tags": [], "creator": "raul-info@r-bg.com", "text": "For me is ok to add this to 1.4.1 release, what other people think?", "id": 102328, "time": "2007-04-25T06:56:19Z", "bug_id": 42239, "creation_time": "2007-04-25T06:56:19Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 42239, "text": "Applying this patch for 1.4.1 would be a great favor to me.\n\nTIA, Wolfgang", "count": 4, "id": 102398, "time": "2007-04-25T12:54:18Z", "creator": "wolfgang.glas@iteg.at", "creation_time": "2007-04-25T12:54:18Z", "is_private": false}, {"count": 5, "tags": [], "creator": "raul-info@r-bg.com", "attachment_id": null, "text": "Can you recreate the patch with svn diff, or eclipse patch. It is the only thing\nleft for the release.\n\nRegards,\n\nRaul", "id": 102738, "time": "2007-05-02T03:10:22Z", "bug_id": 42239, "creation_time": "2007-05-02T03:10:22Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 42239, "attachment_id": null, "id": 102740, "time": "2007-05-02T04:03:43Z", "creator": "wolfgang.glas@iteg.at", "creation_time": "2007-05-02T04:03:43Z", "is_private": false, "text": "My original patch appiels well againt the current svn tree using 'patch -p0 xx' \nfrom the project's root diretory (the directory where build.xml resides...)\n\nHowever, I will attach the output of 'svn diff' of the current svn with my \npatch applied"}, {"attachment_id": 20087, "tags": [], "bug_id": 42239, "is_private": false, "count": 7, "id": 102741, "time": "2007-05-02T04:05:10Z", "creator": "wolfgang.glas@iteg.at", "creation_time": "2007-05-02T04:05:10Z", "text": "Created attachment 20087\noutput of svn diff for my proposed patch."}, {"count": 8, "tags": [], "bug_id": 42239, "attachment_id": null, "id": 102743, "time": "2007-05-02T05:16:50Z", "creator": "raul-info@r-bg.com", "creation_time": "2007-05-02T05:16:50Z", "is_private": false, "text": "Thanks last patch works. One last think can you send a junit test case that\nstress the new code. If you don't do this I don't know how long it will keep\nworking.\n\nRegards,\n\nRaul\n"}, {"count": 9, "tags": [], "text": "The problem with generating a junit test is, that the signature attached to \nthis issuse uses complex xpointer references with namespaces.\n\nURI=\"#xmlns(etsi=http://uri.etsi.org/01903/v1.1.1%23)%20xpointer(<some_xpath_expression>)\"\n\nI've implemented an xpointer resolver, which is capable of resolving such \nthings, but this resolver relies on java 1.5's XPath API plus schema \nvalidation, which makes the thing not suitable for a junit test (schema lookup \nthrough http, test woll only run in java-1.5...).\n\nThe only thing I can do is to generate a signature with xmlsec in a way, that \nit maybe resolved by the austrian security layer implementation. I've already \ncontacted the guys a IAIK.at for receiving an official testvector, but the \nstaff hasn't been very cooperative at this point.", "attachment_id": null, "bug_id": 42239, "id": 102776, "time": "2007-05-02T11:36:50Z", "creator": "wolfgang.glas@iteg.at", "creation_time": "2007-05-02T11:36:50Z", "is_private": false}, {"count": 10, "tags": [], "bug_id": 42239, "text": "Created attachment 20117\npatch for making ECDSA aware of varaible keylengths.\n\nThis patch make the new ECDSA signaturevalue conversion aware of multiple\nkeylength as discovered by the junit test, which will follow.", "id": 102813, "time": "2007-05-03T05:34:44Z", "creator": "wolfgang.glas@iteg.at", "creation_time": "2007-05-03T05:34:44Z", "is_private": false, "attachment_id": 20117}, {"count": 11, "tags": [], "creator": "wolfgang.glas@iteg.at", "attachment_id": 20118, "text": "Created attachment 20118\nJUnit tests for ECDSA.\n\nThese junit tests test the interopaerability of the ECDSA signature with a\ntestvector from the austrian security card from www.buergerkarte.at as well as\nthe consistency of the ECDSA implementation.\n\nPlease note, that the third test fails with bouncycastle 129. I had to upgrade\nto the current bouncycastle (136) in order to get the interoperability test\nworking.", "id": 102814, "time": "2007-05-03T05:37:24Z", "bug_id": 42239, "creation_time": "2007-05-03T05:37:24Z", "is_private": false}, {"count": 12, "tags": [], "bug_id": 42239, "text": "I just recognized, that the variable keylength patch as well as the junit tets\nhas not yet been checkinto the svn tree of the xml security project.\n\nRaul, would it be possible to do so ?\n\nTIA, Wolfgang\n", "id": 104154, "time": "2007-06-06T14:03:48Z", "creator": "wolfgang.glas@iteg.at", "creation_time": "2007-06-06T14:03:48Z", "is_private": false, "attachment_id": null}, {"count": 13, "tags": [], "creator": "drunix@gmx.de", "attachment_id": null, "text": "I've tried the xpointer resolver for generating signatures for the german\nbanking interface EBICS which uses #xpointer(//*[@authenticate='true']) to sign\nall elements with this attribute. Unfortunately, signing fails because\nCanonicalizerBase.canonicalizeXPathNodeSet strips away subnodes because\nisVisibleDO returns 0 for subnodes of nodes in the xpathnodeset.", "id": 107011, "time": "2007-08-22T00:52:45Z", "bug_id": 42239, "creation_time": "2007-08-22T00:52:45Z", "is_private": false}, {"count": 14, "tags": [], "text": "Well, how is the XPointer resolver related to this issue ?\nSupposedly you should post XPointer issues to\n\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=42599\n\nRegards,\n\n  Wolfgang", "attachment_id": null, "id": 107016, "creator": "wolfgang.glas@iteg.at", "time": "2007-08-22T01:59:32Z", "bug_id": 42239, "creation_time": "2007-08-22T01:59:32Z", "is_private": false}, {"count": 15, "tags": [], "creator": "drunix@gmx.de", "attachment_id": null, "text": "I gzuess you are right that it fits better into issue 42599. \nThe reason I posted it here was that this is where you published the resolver\nthat triggered this bug. I will add a comment to 42599.\n\nThanks\nChristian", "id": 107020, "time": "2007-08-22T02:19:42Z", "bug_id": 42239, "creation_time": "2007-08-22T02:19:42Z", "is_private": false}, {"count": 16, "tags": [], "creator": "sean.mullan@oracle.com", "attachment_id": null, "id": 111963, "time": "2007-12-20T13:34:18Z", "bug_id": 42239, "creation_time": "2007-12-20T13:34:18Z", "is_private": false, "text": "Wolfgang,\n\nI'm working on integrating this patch. I have an issue with the test. I'd rather\nit didn't depend on the BouncyCastle APIs to generate a certificate and EC\nkeypair. This seems easy to workaround, instead you can read them from a\nkeystore file which will contain the private key and X.509 certificate. Is this\nsomething you can change for me?\n\nThanks,\nSean"}, {"count": 17, "tags": [], "creator": "coheigea@apache.org", "attachment_id": 23914, "text": "Created attachment 23914\nA patch (zip file) for this issue\n\n\nSee the attached patch which we can apply to close this issue. It's a reworked version of the previous attachment \"20118 - JUnit tests for ECDSA\". Instead of explicitly using BouncyCastle API's to create an ECDSA keypair each time the test is run, I used the code to write the keypair out to a keystore, and then commented the BouncyCastle code out.\n\nThe test tries to load the BouncyCastle provider via reflection, if it fails then the tests just return without an error, as to run the tests we need to have BouncyCastle installed to provide ECDSA support.\n\nThe patch is a zip file consisting of the actual patch, and the keystore which should be placed in data\\org\\apache\\xml\\security\\samples\\input.\n\nNote that this patch also needs attachment number \"20117 - patch for making ECDSA aware of varaible keylengths\" that is attached to this issue but was never applied.\n\nSean, can you take a look at the license at the top of the ResourceResolver implementation in the patch to make sure it's ok?\n\nColm.", "id": 128442, "time": "2009-06-30T08:17:27Z", "bug_id": 42239, "creation_time": "2009-06-30T08:17:27Z", "is_private": false}, {"count": 18, "tags": [], "text": "(In reply to comment #17)\n\n> Sean, can you take a look at the license at the top of the ResourceResolver\n> implementation in the patch to make sure it's ok?\n\nAre you referring to this? :\n\n+/***********************************************************\n+ * $Id: XPointerResourceResolver.java 52 2007-04-07 19:45:06Z wglas $\n+ *\n+ * Tapestry support for the austrian security card layer.\n+ *\n+ * Copyright (C) 2007 ev-i Informationstechnologie GmbH\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ * Created: Apr 6, 2007\n+ *\n+ * Author: wglas\n+ *\n+ ***********************************************************/\n\nI don't think this is acceptable. See http://www.apache.org/legal/src-headers.html#headers for more information. It specifically states:\n\n\"Each source file should include the following license header -- note that there should be no copyright notice in the header\"\n\nFirst the standard disclaimer : IANAL.\nI think the easiest thing to do is ask Wolfgang whether he really needs to include their own copyright (implying ownership) of this code. If they do, then I think we need to have a CLA in place.\n\nIn any case, I think this copyright issue will delay getting this fix into 1.4.3.", "is_private": false, "bug_id": 42239, "id": 128726, "time": "2009-07-10T07:41:46Z", "creator": "sean.mullan@oracle.com", "creation_time": "2009-07-10T07:41:46Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 42239, "text": "Hi all,\n\n  The header of the mentioned file was incidentially generated from another project. (tapestry integration of austrian secutiy card layer.)\n\n  The code is under the apache license 2.0 and I'm happy if the code will be integrated into xmlsec-1.4.3 ;-)\n\n  Feel free to drop the copyright and adapt the header to the requirements of http://www.apache.org/legal/src-headers.html#headers\n\n  Thanks for working with my code,\n\n    Wolfgang", "count": 19, "id": 128727, "time": "2009-07-10T07:50:09Z", "creator": "wolfgang.glas@iteg.at", "creation_time": "2009-07-10T07:50:09Z", "is_private": false}, {"count": 20, "tags": [], "creator": "sean.mullan@oracle.com", "attachment_id": null, "text": "(In reply to comment #19)\n> Hi all,\n> \n>   The header of the mentioned file was incidentially generated from another\n> project. (tapestry integration of austrian secutiy card layer.)\n> \n>   The code is under the apache license 2.0 and I'm happy if the code will be\n> integrated into xmlsec-1.4.3 ;-)\n> \n>   Feel free to drop the copyright and adapt the header to the requirements of\n> http://www.apache.org/legal/src-headers.html#headers\n> \n>   Thanks for working with my code,\n> \n>     Wolfgang\n\nThanks for the quick reply Wolfgang. I read this to mean that you aren't claiming ownership of the code (no copyright), is that right? If so, Colm, I think this means we can keep the 2.0 notice, and just replace the copyright with the ASF copyright and not the notice in http://www.apache.org/legal/src-headers.html#headers.\n\nNote: it may be the case the the existing copyright is ok and doesn't require a CLA because it is specified within an Apache 2.0 license. However, I'm not really sure and would want to check with legal first. So if we can just remove the non-Apache copyright and replace it with an Apache copyright that seems like the quickest solution.\n\nThanks,\nSean", "id": 128736, "time": "2009-07-10T11:00:42Z", "bug_id": 42239, "creation_time": "2009-07-10T11:00:42Z", "is_private": false}, {"count": 21, "tags": [], "bug_id": 42239, "text": "\nPatch applied.\n\nColm.", "id": 128828, "time": "2009-07-14T04:38:48Z", "creator": "coheigea@apache.org", "creation_time": "2009-07-14T04:38:48Z", "is_private": false, "attachment_id": null}]