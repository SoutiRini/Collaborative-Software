[{"count": 0, "attachment_id": null, "creator": "t.rickal@iop.de", "text": "I' am trying to upgrade from Tomcat 3.2.3/ Apache 1.3.19 to Tomcat\n4.0.1/ Apache 1.3.19 on Linux.\n\nAll the urls in the jsps of my application are rewritten by a\nUrlTag. The UrlTag Class takes the url between the tags and rewrites\nit if necessary.\n\nIt works with Tomcat 4.0.1 if the url is placed in the jsp file\nstatically. It works not if the url is get by using the \"get\"-method\nof a bean.\n\nWith Tomcat 3.2.3 it worked fine in both cases. So I think it could by a bug.\n\nHere is an example:\n\n### example.jsp ###\n\n<A href=\"<myLib:url><%= myBean.getURL() %></myLib:url>\">text</A>\n\n\n### output Tomcat 3.2.3 (right) ###\n\n<A href=\"http://localhost/target.jsp\">text</A>\n\n\n### output Tomcat 4.0.1 (wrong) ###\n\n<A href=\"<%= myBean.getURL() %>\">text</A>\n\n\n### example.tld ###\n\n<tag>\n  <name>url</name>\n  <tagclass>de.iop.webrun.shared.taglib.UrlTag</tagclass>\n  <bodycontent>tagdependent</bodycontent>\n  <info>rewrite url</info>\n</tag>\n\n\n### UrlTag-Code ###\n\nimport javax.servlet.http.HttpServletResponse;\nimport javax.servlet.jsp.tagext.*;\nimport javax.servlet.jsp.*;\nimport java.io.IOException;\n\npublic class UrlTag extends BodyTagSupport\n{\n  public int doAfterBody() throws JspException\n  {\n    BodyContent bodyContent = getBodyContent();\n    String baseURL          = bodyContent.getString();\n    bodyContent.clearBody();\n    try\n    {\n      HttpServletResponse response = (HttpServletResponse)\n      pageContext.getResponse();\n      String encodedURL = response.encodeURL(baseURL);\n      this.getPreviousOut().print(encodedURL);\n    }\n    catch(IOException e)\n    {\n      throw new JspTagException(\"I/O exception \" + e.getMessage());\n    }\n    return SKIP_BODY;\n  }\n}", "id": 7973, "time": "2001-11-16T00:46:54Z", "bug_id": 4910, "creation_time": "2001-11-16T00:46:54Z", "tags": [], "is_private": false}, {"count": 1, "attachment_id": null, "creator": "pr@webapp.de", "text": "Hey I thing it is a bug in tomcat 3.2.x\n!\n\nWhen you declare at tag \n <bodycontent>tagdependent</bodycontent> the jsp engine\ndon't interpret the body. The Body is text for your tag handler.\n\nwith <bodycontent>JSP</bodycontent> jasper interpreter the body before\nyour get the content.\n\nI hope with the description change your urltag work\nPeter\n", "id": 7977, "time": "2001-11-16T02:01:37Z", "bug_id": 4910, "creation_time": "2001-11-16T02:01:37Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "t.rickal@iop.de", "attachment_id": null, "id": 7983, "creation_time": "2001-11-16T02:48:49Z", "time": "2001-11-16T02:48:49Z", "bug_id": 4910, "text": "Hi Peter,\n\nit works! Thank you.\n\nThomas", "is_private": false}]