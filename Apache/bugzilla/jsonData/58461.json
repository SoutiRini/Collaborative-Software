[{"count": 0, "tags": [], "creator": "privat4@hoelle-online.de", "is_private": false, "id": 185500, "attachment_id": 33149, "bug_id": 58461, "creation_time": "2015-09-26T16:53:22Z", "time": "2015-09-26T16:53:22Z", "text": "Created attachment 33149\nFull test case; creates a file first per HSSF, then per XSSF to show the different Excel behaviour\n\n1. Applying default column style by Sheet.setDefaultColumnStyle\n2. Adding new Cell; but don't set an explicit cell style\n\n==> the default column style seems to be not applied if opening the file with MS Excel 2010.\n\n* Notes:\na) This works if using a HSSFWorkbook.\nb) Strange: LibreOffice 4.3.7.2 displays the file as expected.\nc) Maybe Bug 51037 deals with the same problem, but the description there is to imprecise to reproduce it.\n\n* Code snippet:\n  Workbook workbook = new XSSFWorkbook();\n  Sheet sheet = workbook.createSheet();\n\n  // Set default column style to user formatted time & yellow background\n  CellStyle style = workbook.createCellStyle();\n  style.setDataFormat(workbook.createDataFormat().getFormat(\"hh:mm:ss\"));\n  style.setFillForegroundColor(IndexedColors.YELLOW.getIndex());\n  style.setFillPattern(CellStyle.SOLID_FOREGROUND);\n  sheet.setDefaultColumnStyle(0, style);\n\n  // Create one cell; cell contains actual date & time ...\n  Row row = sheet.createRow(0);\n  row.createCell(0).setCellValue(Calendar.getInstance());\n\n* Results when viewing with MS Excel 2010:\nThe HSSF-file shows all cells - including the filled one - with yellow background and formatted as time.\nIn the XSSF-file the filled cell has neither a background color nor a cell format; the other cells of the column are formatted correctly.\n\nFull test case appended; creates a file per HSSF & XSSF to show the differences of Excel behaviour."}, {"count": 1, "tags": [], "bug_id": 58461, "attachment_id": null, "id": 185564, "creation_time": "2015-09-30T12:11:18Z", "time": "2015-09-30T12:11:18Z", "creator": "dominik.stadler@gmx.at", "text": "I'll close this as duplicate of bug 51037 and comment some information from this bug there to not loose it.\n\n*** This bug has been marked as a duplicate of bug 51037 ***", "is_private": false}]