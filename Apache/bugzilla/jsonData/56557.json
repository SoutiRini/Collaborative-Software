[{"count": 0, "tags": [], "text": "Created attachment 31653\ntestfile with chart sheet\n\nWith SXSSFWorkbook the stored file gets corrupted if it contains a \"chart sheet\". \n\nThis very simple code snippet reproduces the error:\n\n<..>\n  Workbook wb = WorkbookFactory.create(new File(\"in.xlsx\"));\n\t\t\n  // Using streaming XSSFWorkbook makes the output file invalid\n  wb = new SXSSFWorkbook(((XSSFWorkbook) wb));\n\t    \n  FileOutputStream out = new FileOutputStream(\"out.xlsx\");\n  wb.write(out);\n  out.close();\n<..>\n\nI have attached an empty excel-file with two empty sheets, one normal sheet and one chart sheet, which can be used test.\n\nThis is similar to the Bug 49472, which was present in ealier versions.", "is_private": false, "id": 175417, "creator": "jonas.berglin@easit.com", "time": "2014-05-23T11:28:42Z", "bug_id": 56557, "creation_time": "2014-05-23T11:28:42Z", "attachment_id": 31653}, {"count": 1, "tags": [], "text": "Same problem in my project.\nI checked the corrupted file by unzip it,and I found some useful imformation.\nThe xml file under xl\\chartsheets had an additionnal elememt named <sheetData>,which should not exist in a type of chartsheet.\nI think this is a bug .\n\nmy poi version is 3.14", "is_private": false, "id": 199210, "creator": "maligang1@huawei.com", "time": "2017-06-15T09:49:56Z", "bug_id": 56557, "creation_time": "2017-06-15T09:49:56Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "maligang1@huawei.com", "text": "Same problem in my project.\nI checked the corrupted file by unzip it,and I found some useful imformation.\nThe xml file under xl\\chartsheets had an additionnal elememt named <sheetData>,which should not exist in a type of chartsheet.\nI think this is a bug .\n\nmy poi version is 3.14", "id": 199215, "time": "2017-06-15T12:51:09Z", "bug_id": 56557, "creation_time": "2017-06-15T12:51:09Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "apache@gagravarr.org", "is_private": false, "text": "Both 3.10 and 3.14 are somewhat old now, I'd suggest you try upgrading", "id": 199216, "time": "2017-06-15T13:00:33Z", "bug_id": 56557, "creation_time": "2017-06-15T13:00:33Z", "attachment_id": null}, {"count": 4, "tags": [], "text": "3.16 is (In reply to Nick Burch from comment #3)\n> Both 3.10 and 3.14 are somewhat old now, I'd suggest you try upgrading\n\ntried 3.16 , same problem occur.", "is_private": false, "id": 199225, "creator": "maligang1@huawei.com", "time": "2017-06-16T02:06:25Z", "bug_id": 56557, "creation_time": "2017-06-16T02:06:25Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "maligang1@huawei.com", "text": "I have modified the method\norg.apache.poi.xssf.streaming.SXSSFWorkbook.injectData(File, OutputStream)\nat line 354.\n\n---\nif(xSheet!=null)\n->\nif(xSheet!=null && !(xSheet instanceof XSSFChartSheet))\n---\n\nSince there is no <sheetData> in a chartsheet, XSSFChartSheet should not take this if branch.(copyStreamAndInjectWorksheet(is,zos,xis) process the field <sheetData>)\n\n\nThe trick works fine in my case.", "id": 199229, "time": "2017-06-16T09:24:53Z", "bug_id": 56557, "creation_time": "2017-06-16T09:24:53Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "creator": "dominik.stadler@gmx.at", "text": "Applied now on trunk via r1798913\n\nThe following in a test-case also showed the problem via some invalid XML structure that was produced.\n\n        Workbook wbBack = XSSFTestDataSamples.writeOutAndReadBack(wb);\n        assertNotNull(wbBack);\n        wbBack.close();", "id": 199233, "time": "2017-06-16T12:00:00Z", "bug_id": 56557, "creation_time": "2017-06-16T12:00:00Z", "is_private": false, "attachment_id": null}, {"count": 7, "attachment_id": null, "bug_id": 56557, "text": "Improved the unit test in r1799304", "id": 199288, "time": "2017-06-20T06:09:48Z", "creator": "onealj@apache.org", "creation_time": "2017-06-20T06:09:48Z", "tags": [], "is_private": false}, {"count": 8, "tags": [], "creator": "dominik.stadler@gmx.at", "text": "Thanks for fixing this, it should have been \"readOnly: true\"...", "id": 199293, "time": "2017-06-20T14:02:36Z", "bug_id": 56557, "creation_time": "2017-06-20T14:02:36Z", "is_private": false, "attachment_id": null}]