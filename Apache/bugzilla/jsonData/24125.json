[{"count": 0, "tags": [], "creator": "hsapache@online.de", "is_private": false, "text": "Hello!\n\nCells in Excel 2000 (German) formated as Currency are recognized as dates.\nIn Excel they look like \"7,00\u20ac\" and \"$7,00\".\n\nstyle.getDataFormat() returns 171 (ab) and 172 (ac) for these cells so \nisInternalDateFormat(..) returns true.\n\nIs it possible to determin with HSSF how the cells look like in Excel?\n\nGreetings from Germany\n\n    Holger\n\nP.S. Here are the fields for HSSFCell and HSSFCell.getCellStyle() of \ncell \"$7,00\". Hope this information helps debugging:\n\n---- HSSFCell ------\norg.apache.poi.hssf.usermodel.HSSFCell [java.lang.Object]\ncellNum = 1\ncellType = 0\ncellStyle :- org.apache.poi.hssf.usermodel.HSSFCellStyle@ae525c\ncellValue = 7.0\nstringValue :- null\nbooleanValue = false\nerrorValue = 0\nencoding = 0\nbook :- org.apache.poi.hssf.model.Workbook@15f5985\nsheet :- org.apache.poi.hssf.model.Sheet@ee568c\nrow = 2\nrecord :- [NUMBER]\n    .row            = 2\n    .col            = 1\n    .xfindex        = 1f\n    .value          = 7.0\n[/NUMBER]\n\n---- HSSFCell.getCellStyle() ------\norg.apache.poi.hssf.usermodel.HSSFCellStyle [java.lang.Object]\nformat :- [EXTENDEDFORMAT]\n CELL_RECORD_TYPE\n    .fontindex       = 0\n    .formatindex     = ac\n    .celloptions     = 1\n          .islocked  = true\n          .ishidden  = false\n          .recordtype= 0\n          .parentidx = 0\n    .alignmentoptions= 20\n          .alignment = 0\n          .wraptext  = false\n          .valignment= 2\n          .justlast  = 0\n          .rotation  = 0\n    .indentionoptions= 400\n          .indent    = 0\n          .shrinktoft= false\n          .mergecells= false\n          .readngordr= 0\n          .formatflag= true\n          .fontflag  = false\n          .prntalgnmt= false\n          .borderflag= false\n          .paternflag= false\n          .celloption= false\n    .borderoptns     = 0\n          .lftln     = 0\n          .rgtln     = 0\n          .topln     = 0\n          .btmln     = 0\n    .paleteoptns     = 0\n          .leftborder= 0\n          .rghtborder= 0\n          .diag      = 0\n    .paleteoptn2     = 0\n          .topborder = 0\n          .botmborder= 0\n          .adtldiag  = 0\n          .diaglnstyl= 0\n          .fillpattrn= 0\n    .fillpaloptn     = 20c0\n          .foreground= 40\n          .background= 41\n[/EXTENDEDFORMAT]\n\nindex = 31\nfontindex = 0\n\n----- style.getDataFormat() -----\n style.getDataFormat(): 172", "id": 46288, "time": "2003-10-26T02:20:03Z", "bug_id": 24125, "creation_time": "2003-10-26T02:20:03Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "Also appears to be a problem with percentage formats in Excel 2002 \n(10.2614.3311 to be precise):\n\nPercentage formats are as follows (according to number of decimal places):\n\n0 = 9 (09)\n1 = 164 (a4)\n2 = 10 (0a)\n3 = 167 (a7)\n4 = 168 (a8)\n5 = 169 (a9)\n6 = 170 (aa)\n7 = 171 (ab)\n8 = 176 (b0)\n9 = 177 (b1)\n10 = 172 (ac)\n11 = 173 (ad)\n12 = 180 (b4)\n13 = 181 (b5)\n14 = 182 (b6)\n15 = 178 (b2)\n16 = 183 (b7)\n17 = 184 (b8)\n18 = 185 (b9)\n19 = 186 (ba)\n20 = 174 (ae)\n21 = 187 (bb)\n22 = 188 (bc)\n23 = 189 (bd)\n24 = 190 (be)\n25 = 179 (b3)\n26 = 191 (bf)\n27 = 192 (c0)\n28 = 193 (c1)\n29 = 194 (c2)\n30 = 175 (af)\n\n\nThe switch statement in isInternalDateFormat(int format) (from HSSFDateUtil rev \n1.6) contains the following:\n\n// Additional internal date formats found by inspection\n// Using Excel v.X 10.1.0 (Mac)\ncase 0xa4:\ncase 0xa5:\ncase 0xa6:\ncase 0xa7:\ncase 0xa8:\ncase 0xa9:\ncase 0xaa:\ncase 0xab:\ncase 0xac:\ncase 0xad:\n\nSo with Excel 2002 percentage formats with 1, 3, 4, 5, 6, 7, 10 and 11 decimal \npoints appear to get treated as dates.", "attachment_id": null, "id": 48475, "creator": "christopher.cope@logicacmg.com", "time": "2003-12-04T11:38:45Z", "bug_id": 24125, "creation_time": "2003-12-04T11:38:45Z", "is_private": false}, {"count": 2, "tags": [], "creator": "avik@apache.org", "is_private": false, "text": "Fixed. both branch and head. This was due to an addition in bug 14375, which has\nbeen revered. ", "id": 49931, "time": "2004-01-01T09:02:34Z", "bug_id": 24125, "creation_time": "2004-01-01T09:02:34Z", "attachment_id": null}]