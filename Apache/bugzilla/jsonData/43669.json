[{"count": 0, "tags": [], "creator": "mailmur@yahoo.com", "is_private": false, "text": "Tomcat 5.5.x:\nhttp://svn.apache.org/repos/asf/tomcat/container/tc5.5.x/catalina/src/share/org/apache/catalina/core/ApplicationDispatcher.java\n  private void unwrapRequest(State state) {\n    ...continue...\n    // Advance to the next request in the chain\n    previous = current;\n    current = ((ServletRequestWrapper) current).getRequest(); // !! CAST ERROR\n    ...continue...\n  }\n\nException is thrown when request is forwarded:\n  \"com.outerrim.servlet.OfflineHttpServletRequest cannot be cast to \n   javax.servlet.ServletRequestWrapper\"\n\nThis is my offlineHttpServletRequest and Response classes:\n  public class OfflineHttpServletRequest implements HttpServletRequest { ... }\n  public class OfflineHttpServletResponse implements HttpServletResponse { ... }\n\nThey provide me a way to call servlet urls without the real webclient requests.\nThis is used in a background thread, that must trigger \"dispatcher.forward(req,\nres)\" method call.\n   RequestDispatcher dispatcher = ctx.getRequestDispatcher(url);\n   dispatcher.forward(offReq, offRes);\n\nClasses work fine in Tomcat5.0.x releases. \n\nIs it really a new requirement, that customized classes must inherit\nServletRequestWrapper/ServletResponseWrapper classes?", "id": 109523, "time": "2007-10-21T13:36:09Z", "bug_id": 43669, "creation_time": "2007-10-21T13:36:09Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 43669, "attachment_id": null, "id": 109524, "time": "2007-10-21T13:46:47Z", "creator": "mailmur@yahoo.com", "creation_time": "2007-10-21T13:46:47Z", "is_private": false, "text": "\n\n*** This bug has been marked as a duplicate of 39417 ***"}, {"count": 2, "tags": [], "text": "And to comment what happened to my forward.request. Yes, it worked fine and went\nto the destination webapplication url. But then applicationdispatcher tries to\nroll back to the caller, it fails due to a ClassCastException.", "is_private": false, "id": 109526, "creator": "mailmur@yahoo.com", "time": "2007-10-21T13:52:10Z", "bug_id": 43669, "creation_time": "2007-10-21T13:52:10Z", "attachment_id": null}]