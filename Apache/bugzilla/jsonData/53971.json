[{"count": 0, "tags": [], "creator": "jfclere@gmail.com", "attachment_id": null, "id": 162586, "time": "2012-10-05T13:35:58Z", "bug_id": 53971, "creation_time": "2012-10-05T13:35:58Z", "is_private": false, "text": "when using address=\"::\" on windoze (XP) the shutdown contains the message:\n+++\n$ tail -f logs/catalina.2012-10-05.log\nOct 5, 2012 12:14:48 PM org.apache.coyote.ajp.AjpAprProtocol pause\nINFO: Pausing Coyote AJP/1.3 on ajp-8009\nOct 5, 2012 12:14:49 PM org.apache.catalina.core.StandardService stop\nINFO: Stopping service Catalina\nOct 5, 2012 12:14:49 PM org.apache.coyote.http11.Http11AprProtocol destroy\nINFO: Stopping Coyote HTTP/1.1 on http-0%3A0%3A0%3A0%3A0%3A0%3A0%3A0-8080\nOct 5, 2012 12:15:00 PM org.apache.tomcat.util.net.AprEndpoint stop\nWARNING: Acceptor thread [http-0%3A0%3A0%3A0%3A0%3A0%3A0%3A0-8080-Acceptor-0] failed to unlock. Forcing hard socket shutdown.\nOct 5, 2012 12:15:00 PM org.apache.coyote.ajp.AjpAprProtocol destroy\nINFO: Stopping Coyote AJP/1.3 on ajp-8009\n+++\nOf course it takes 10 seconds to shutdown."}, {"count": 1, "tags": [], "text": "That the unlock accept with IPv6 brings a bunch of problems and that is not easy to fix. We have a JIRA https://issues.jboss.org/browse/AS7-3834 that contains the tries we did to fix the stuff but it seems there isn't an easy way.\n\nNot that on windows XP you need address=\"::\" to listen on both IPv4 and IPv6. It is probably the same on windows 2008 but I have checked it yet.", "attachment_id": null, "bug_id": 53971, "id": 162587, "time": "2012-10-05T13:54:19Z", "creator": "jfclere@gmail.com", "creation_time": "2012-10-05T13:54:19Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 53971, "attachment_id": null, "id": 181500, "time": "2015-03-04T13:22:42Z", "creator": "markt@apache.org", "creation_time": "2015-03-04T13:22:42Z", "is_private": false, "text": "I been doing a little svn archeology as well as reviewing the comments on the JBoss issue tracker. The summary of that seems to be:\n\n- The root cause is a JVM bug\n- That bug in fixed in the latest available Java 6 and Java 7 releases (not Java 5)\n- The workaround is a timeout during unlock accept (which is what Tomcat 6 already does)\n\nTherefore, I see nothing for Tomcat to do here."}, {"count": 3, "tags": [], "bug_id": 53971, "text": "I've encountered this recently and it seems that this is still an issue unfortunately. I can reproduce the problem with tomcat 7.0.70 and 8.0.36 using tcnative 1.2.7 on oracle java 1.7.0u80 and 1.8.0u92 (current latest releases). The OS is Windows Server 2012.\n\nMy reproduction steps are just to add 'address=\"::\"' to the connector, ensure that tcnative is in use, then start and shutdown tomcat. I get the warning every time and a longer-than-normal shutdown. Can we look into this issue again?", "id": 192400, "time": "2016-07-15T13:26:43Z", "creator": "csutherl@apache.org", "creation_time": "2016-07-15T13:26:43Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "text": "(In reply to Coty Sutherland from comment #3)\n> I've encountered this recently and it seems that this is still an issue\n> unfortunately. I can reproduce the problem with tomcat 7.0.70 and 8.0.36\n> using tcnative 1.2.7 on oracle java 1.7.0u80 and 1.8.0u92 (current latest\n> releases). The OS is Windows Server 2012.\n> \n> My reproduction steps are just to add 'address=\"::\"' to the connector,\n> ensure that tcnative is in use, then start and shutdown tomcat. I get the\n> warning every time and a longer-than-normal shutdown. Can we look into this\n> issue again?\n\nYou are conflating two separate issues. The original issue was a JVM bug as described in comment #2. You are seeing a separate APR/native bug.", "id": 195293, "time": "2016-11-29T20:09:40Z", "bug_id": 53971, "creation_time": "2016-11-29T20:09:40Z", "is_private": false}, {"count": 5, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 195299, "time": "2016-11-29T22:07:35Z", "bug_id": 53971, "creation_time": "2016-11-29T22:07:35Z", "is_private": false, "text": "Re-closing as INVALID since this is a JVM bug.\n\n(I have a fix for the separate APR issue ready to commit shortly)"}]