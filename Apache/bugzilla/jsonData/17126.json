[{"count": 0, "attachment_id": null, "bug_id": 17126, "text": "Hello,\n\nI request a minor enhancement.\n(I can't use english well,please read with patience...Can you understand my \nsummary?)\n\nFont and CellStyle records are managed in Workbook object,and used Flyweight \npattern.\nIf two cell's attribute(cell style and font) are all same,we must set same \nobject at both cell to avoid generating invalid Workbook,because attribute \nobject's number is over a limit.\nBut it is not convenience for users.(and for some commiters?  because many \nreport about it is submitted to ML repeatedly... )\nPlease implement cell's attributes like this(or on some better idea.I don't \nknow the implementation deeply:) ),\n\n1.HSSFCell#setCellStyle(HSSFCellStyle) causes like String#intern(String).If \nthere are already registered a object that has same attributes,instead of \nregistering parameter object,the cell use the object already regeistered as the \ncell's attribute.\n\n2.HSSFCell#getCellStyle() returns, not raw attribute object's reference,but a \nshallow copy of it,to make users disable to change the cell's style attribute \ndirectly.\n\n3.and other some implementation for it.\n\nThank you for reading.", "id": 31429, "time": "2003-02-17T12:30:37Z", "creator": "kamoshida.toshiaki@future.co.jp", "creation_time": "2003-02-17T12:30:37Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 17126, "text": "Hi.  Your English is just fine.  I have though about this and I think it's a\ngood idea and it should be possible to implement something like this.  I don't\npersonally have time to pick this one up at the moment but hopefully another\ndeveloper might be able to look into it.", "id": 31430, "time": "2003-02-17T12:52:19Z", "creator": "glens@apache.org", "creation_time": "2003-02-17T12:52:19Z", "is_private": false, "attachment_id": null}, {"count": 2, "attachment_id": null, "bug_id": 17126, "text": "No it shouldn't be done.  The reason being is you can manage groups of cells's\nstyle.  Excel behaves in this way.  We should however throw an exception if\nsomeone creates too many of them.", "id": 31438, "time": "2003-02-17T13:59:08Z", "creator": "poi-support@buni.org", "creation_time": "2003-02-17T13:59:08Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 17126, "attachment_id": null, "text": "I made a system to manage this:\n\nAn ExcelDocument that behaves like HSSFWorkbook but\n   - uses Hashmaps to store created HSSFFont and HSSFCellStyle\n   - don't return any HSSFCellStyle\n\nAn ExcelFormat that contains the same data as HSSFFont and HSSFCellStyle\n\nAn ExcelFormatKey that contains a HSSFCellStyle\n\nWhen a developper want to create a style for a cell, he uses ExcelFormat.\nWhen he want's to apply it on a cell he has to use the ExcelFormatKey \ncorresponding to it.\nHe gets ExcelFormatKeys through ExcelDocument that checks if HSSFFont and \nHSSFCellStyle exists, if not a single HSSCellStyle or both HSSFFont and \nHSSFCellStyle are created.\n\nThe developper doesn't the see the \"POI\" objects.\nIt is slower, but it is easer not to store all the existing HSSFFont and \nHSSFCellStyle.\n\nPerhaps this way of solution could help you\n\nQuestion : Is there any forum where we can discuss about poi? ", "id": 31583, "time": "2003-02-19T10:59:34Z", "creator": "gr_nico@hotmail.com", "creation_time": "2003-02-19T10:59:34Z", "is_private": false}, {"count": 4, "attachment_id": null, "bug_id": 17126, "text": "There's a mailing list. Just send an e-mail to poi-dev-help@jakarta.apache.org\nand see what happens.", "id": 31586, "time": "2003-02-19T11:59:01Z", "creator": "klute@apache.org", "creation_time": "2003-02-19T11:59:01Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "creator": "gr_nico@hotmail.com", "text": "I tried to send a mail to this adress but I received :\n\n\"Hi! This is the ezmlm program. I'm managing the\npoi-dev@jakarta.apache.org mailing list.\n\nI'm working for my owner, who can be reached\nat poi-dev-owner@jakarta.apache.org.\n\nThis is a generic help message. The message I received wasn't sent to\nany of my command addresses.\"\n", "id": 31593, "time": "2003-02-19T13:35:04Z", "bug_id": 17126, "creation_time": "2003-02-19T13:35:04Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 17126, "text": "Yes! Just keep on reading that e-mail and you'll see what you are looking for.", "id": 31595, "attachment_id": null, "creator": "klute@apache.org", "creation_time": "2003-02-19T14:08:49Z", "time": "2003-02-19T14:08:49Z", "is_private": false}, {"count": 7, "tags": [], "text": "Ok, my fault : I thought of help on POI and not help on using poi's list :-(\nSorry,", "attachment_id": null, "bug_id": 17126, "id": 31607, "time": "2003-02-19T14:50:51Z", "creator": "gr_nico@hotmail.com", "creation_time": "2003-02-19T14:50:51Z", "is_private": false}, {"count": 8, "tags": [], "text": "Hello,\n\nNow I'm making a Wrapper Library of POI in my business.\nIn my library I made a management system of font and cell's style attribute.\n\nIn my library there are workbook,sheet,font,cell's style and etc classes,\nand user can freely create instance of font and cell's style,and set it to\neach cell object.Thease classes are not related to POI's classes.\n\nAnd when user call serialize method of it,my library create a HSSFWorkbook,\nand other POI's objects as the model of my library.And in this turn,my library \ndo like this,\n\n1.Collect each cell's style and font.\n2.Check duplication of thease objects and dispose duplicated one.\n3.Create HSSFFont and HSSFCellStyle object based on this adjusted collection.\n4.Set it to each HSSFCell.\n\nI feel,if usermodel package behave like this(User neet not to understand low \nlayer architecture of POI and neet not to manage thease attributes on user's \nresponsibility),we can use POI more easily.\n\nOf course,the policy of POI usermodel is already exist and it can't permit this\nplan,I feel it is a reasonable decision and I will respect it.\n\nTo tell the fact, I feel troublesome to implement the system in my library, and \nif POI support this part, it make me more easily :)\n\nThanks.", "attachment_id": null, "bug_id": 17126, "id": 31656, "time": "2003-02-20T08:10:54Z", "creator": "kamoshida.toshiaki@future.co.jp", "creation_time": "2003-02-20T08:10:54Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 17126, "attachment_id": null, "text": "Good idea. I had the same problems as yours!\n\nBut I have a few questions for you :\n   Are you able to represent easily with your own model: merged regions, ... ?\n   How long does it take to serialize a file containing 10,000.00 rows and 7 \ncolumns on each row ?", "id": 31657, "time": "2003-02-20T08:25:41Z", "creator": "gr_nico@hotmail.com", "creation_time": "2003-02-20T08:25:41Z", "is_private": false}, {"count": 10, "tags": [], "bug_id": 17126, "attachment_id": null, "text": "can you like, join the mail list?   Secondly, I'm pretty sure this already\nexists in the contrib module.  Talk on the mail list, not bugzilla.", "id": 31669, "time": "2003-02-20T12:58:36Z", "creator": "poi-support@buni.org", "creation_time": "2003-02-20T12:58:36Z", "is_private": false}, {"count": 11, "tags": [], "creator": "kamoshida.toshiaki@future.co.jp", "attachment_id": 5155, "id": 32440, "time": "2003-03-05T06:44:34Z", "bug_id": 17126, "creation_time": "2003-03-05T06:44:34Z", "is_private": false, "text": "Created attachment 5155\nInput Excel File for the Testcase. Name \"Input.xls\""}, {"count": 12, "tags": [], "bug_id": 17126, "attachment_id": 5156, "id": 32441, "time": "2003-03-05T06:45:54Z", "creator": "kamoshida.toshiaki@future.co.jp", "creation_time": "2003-03-05T06:45:54Z", "is_private": false, "text": "Created attachment 5156\nTestcase for see this problem."}, {"count": 13, "tags": [], "bug_id": 17126, "attachment_id": null, "text": "Sorry, I made a confuse about this problem.\nI submitted a simple testcase to see this problem.\nIn \"Input.xls\",Cell A1 and A2 in the sheet \"Test\" has same attribute about \ncell's style.And In the testcase source is simply do\n\n1.Load \"Input.xls\"\n2.Get HSSFCellStyle about Cell A1.\n3.Call HSSFCellStyle#setBorderBottom() ande change style attribute A1's cell.\n4.Save as\"Output.xls\"\n\nAnd checking \"Output.xls\",Both A1 and A2 Cell's style is changed.\nIt is correct behavior under the structure like now,but user may feel it is bug \nor not convinience.\nWhat do you think about it?\n\nThank you.\n", "id": 32442, "time": "2003-03-05T06:53:44Z", "creator": "kamoshida.toshiaki@future.co.jp", "creation_time": "2003-03-05T06:53:44Z", "is_private": false}, {"count": 14, "tags": [], "creator": "kamoshida.toshiaki@future.co.jp", "text": "Sorry, not \"A1 and A2\",but \"A1 and B1\".", "id": 32444, "time": "2003-03-05T06:58:46Z", "bug_id": 17126, "creation_time": "2003-03-05T06:58:46Z", "is_private": false, "attachment_id": null}, {"count": 15, "attachment_id": null, "bug_id": 17126, "text": "-1 On removing the abillity to have duplicate cell styles.  -1 on putting\nanything in the core API which allows people to thoughtlessly iterate throw A\nLIST of cell styles so that they complain later on how slow HSSF is when they\nmisuse this for thousands of operations.  +1 on an acceptable utility class\nhowever I'm pretty sure that there is one in the contrib module.  If it isn't\nPattern-correct, thats certainly not my itch, but patches are welcome.\n\nMaking HSSF fit into your conceptualization of what the file format is, thats\nyour job (the application developer).  We're mapping what it ACTUALLY is, which\nis that two equal in appearence but actually different styles can and often do\nget written to the file.  Changing one of the visually equal styles changes a\ngroup of cell styles.  This is used by one of my clients and I'd be HARD pressed\nto disable this feature just for convienence.  Come up with a solution that\npreserves the behavior and submit a patch.  If its unspoken ineffieciency or is\ncomplex (such as iterating through a list over and over) then please patch\nagainst the contrib module.\n\nNote that on the whole I try to keep the API easy to use but I don't like\ncluttering it with convienience functions at this stage.  Once all hard problems\n(formulas, graphing, embedded graphics, memory, io-mapping) are solved then\nwe'll talk.  However I don't want to clutter the core API with a lot of bells\nand whistles that WE have to maintain until then.  (Thats what contrib is for)\n\nI'm closing this bug and putting it as invalid.  MOVE THIS ONTO THE DISCUSSION\nLISTS.  If you're having trouble posting to the disucssion list (aimed at\ngr_nico), perhaps you should consider reading directions (hint: subscribe).\n\nToshiaki, I think you'll get along great in the POI community and I look forward\nto continuing this discussion on the developer list.", "id": 34099, "time": "2003-03-29T00:33:16Z", "creator": "poi-support@buni.org", "creation_time": "2003-03-29T00:33:16Z", "tags": [], "is_private": false}]