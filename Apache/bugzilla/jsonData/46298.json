[{"count": 0, "tags": [], "creator": "owen.jacobson@grimoire.ca", "attachment_id": 22949, "is_private": false, "id": 122860, "time": "2008-11-25T23:25:56Z", "bug_id": 46298, "creation_time": "2008-11-25T23:25:56Z", "text": "Created attachment 22949\nCheck returned connection for null in JDBCRealm.open()\n\nPer the Driver.connect(String, Properties) docs:\n\n> The driver should return \"null\" if it realizes it is the wrong kind of driver to connect to the given URL.\n\nI ran into this when I fat-fingered the JDBC URL's prefix (jdbc:msql: instead of jdbc:mysql: with the MySQL driver).  The offending code calls Driver.connect and immediately calls setAutoCommit(false) on the resulting driver without checking that the connect returned a connection.\n\nI've attached a patch based from TOMCAT_6_0_18 that addresses the issue."}, {"count": 1, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "is_private": false, "id": 123569, "time": "2008-12-28T15:49:35Z", "bug_id": 46298, "creation_time": "2008-12-28T15:49:35Z", "text": "Thanks for the patch. I have applied a variation to trunk and will propose it for 6.0.x\nThe changes I made were:\n- test dbConnection for null rather than driver (which is always non-null)\n- use the StringManager to provide i18n for the exception message"}, {"count": 2, "tags": [], "bug_id": 46298, "attachment_id": null, "text": "Thanks for catching the typo in the patch! Clearly, I fat-finger a lot of things.  I18n is also a nice touch.\n", "id": 123576, "time": "2008-12-28T17:06:48Z", "creator": "owen.jacobson@grimoire.ca", "creation_time": "2008-12-28T17:06:48Z", "is_private": false}, {"count": 3, "tags": [], "creator": "markt@apache.org", "text": "This has been fixed in 6.0.x and will be included in 6.0.19 onwards.", "id": 124055, "time": "2009-01-14T15:58:50Z", "bug_id": 46298, "creation_time": "2009-01-14T15:58:50Z", "is_private": false, "attachment_id": null}]