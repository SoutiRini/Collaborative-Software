[{"count": 0, "tags": [], "bug_id": 38973, "attachment_id": null, "text": "In the code below from extractFile method of Expand.jar I made the changes for \nthe fix.  Search for ERROR and you will find the changes in two places.\n\n\n                PatternSet p = (PatternSet) patternsets.elementAt(v);\n                String[] incls = p.getIncludePatterns(getProject());\n                if (incls == null || incls.length == 0) {\n                    // no include pattern implicitly means includes=\"**\"\n                    incls = new String[] {\"**\"};\n                }\n\n                for (int w = 0; w < incls.length; w++) {\n                    String pattern = incls[w].replace('/', File.separatorChar)\n                        .replace('\\\\', File.separatorChar);\n                    if (pattern.endsWith(File.separator)) {\n                        pattern += \"**\";\n                    }\n\n                    included = SelectorUtils.matchPath(pattern, name);\n                    if (included) {\n                        break;\n                    }\n                }\n\n                if (!included) {\n                    break; ERROR ----> Should be Continue!, because if not \nfound it should continue at the tope of the loop.\n                }\n\n\n                String[] excls = p.getExcludePatterns(getProject());\n                if (excls != null) {\n                    for (int w = 0; w < excls.length; w++) {\n                        String pattern = excls[w]\n                            .replace('/', File.separatorChar)\n                            .replace('\\\\', File.separatorChar);\n                        if (pattern.endsWith(File.separator)) {\n                            pattern += \"**\";\n                        }\n                        included = !(SelectorUtils.matchPath(pattern, name));\n                        if (!included) {\n                            break;\n                        }\n                    }\n                }\nERROR -----> these three lines should be added - so that we don't search \nthrough the other patterns if it matches the first one.\n                if (included) {                \n                     break;                 \n                }\nERROR ---->Done Adding\n\n            }\n            if (!included) {\n                //Do not process this file\n                return;\n            }\n        }", "id": 86827, "time": "2006-03-15T01:42:53Z", "creator": "vijayvani@gmail.com", "creation_time": "2006-03-15T01:42:53Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 38973, "attachment_id": null, "text": "Could you describe the behaviour of the bug and demonstrate with a build file\nand JUnit tests to prove that the changes in the code you described are correct?\n\nIt's also more useful if you provide a diff (svn diff - see the svn help) of the\nsource as it's more readable than the approach that you have chosen.  We can\nalso apply diffs directly to our code using patch which makes the process of\nincorporating contributions a little smoother.\n\nThanks for taking the time to look at the code, but please demonstrate the bug\nwith a build file and a JUnit test that reproduces the failure.\n\nKev", "id": 86828, "time": "2006-03-15T02:14:59Z", "creator": "kevin.jackson@it.fts-vn.com", "creation_time": "2006-03-15T02:14:59Z", "is_private": false}, {"count": 2, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 88653, "time": "2006-04-29T14:27:22Z", "bug_id": 38973, "creation_time": "2006-04-29T14:27:22Z", "is_private": false, "text": "I think Vijay is correct with his first change, but wrong on the second.\n\nCurrently the code would only extract files that are matched by all patternsets\ninstead of at least one (that's what all the other tasks do) - this is the first\nchange.\n\nIn the second loop we do want to check against all patterns as long as the entry\ndoesn't match one of the excludes.\n\nI'll add a testcase or two and change it."}, {"count": 3, "tags": [], "text": "OK, the first change would have created problems with files that were included in\none and excluded in the second patternset.\n\nI went ahead and simply merged all patternsets before applying patterns.", "attachment_id": null, "bug_id": 38973, "id": 88658, "time": "2006-04-29T14:57:19Z", "creator": "bodewig@apache.org", "creation_time": "2006-04-29T14:57:19Z", "is_private": false}]