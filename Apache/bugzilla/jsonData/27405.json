[{"count": 0, "tags": [], "text": "isnumber(), isblank(), istext(), all evaluate correctly when used in cell \nformulas on their own. However if they are placed in if statements, ( if( \nisnumber(a1),a1,a2) for example) the result is always false (i.e. the second \nterm).\n\nThis is still the case in version 2.5\n\nThe following code fragment illustrates the problem, creating sheet with 4 \ncells, B1 & B2 initially set to 1 and 999, and B5 & B6 containing isnumber\n(b1), and if(isnumber(b1), b1, b2) respectively.\n\nB5 always reflects the state of b1, but b6 always shows the value in b2. \nEditing the formula in excel \"fixes\" the problem.\n\n    HSSFWorkbook wb = new HSSFWorkbook( );\n    HSSFSheet sheet = wb.createSheet(\"input\");\n    // input row 0\n    HSSFRow row = sheet.createRow((short)0);\n    HSSFCell cell=row.createCell((short)0);\n    cell = row.createCell((short) 1);\n    cell.setCellValue(1);\n    // input row 1\n    row = sheet.createRow((short)1);\n    cell = row.createCell((short)1);\n    cell.setCellValue(999);\n\n    int rno = 4;\n    row = sheet.createRow(rno);\n    cell = row.createCell((short)1);\n    cell.setCellFormula(\"isnumber(b1)\");\n    cell = row.createCell((short)3);\n    cell.setCellFormula(\"IF(ISNUMBER(b1),b1,b2)\");\n\n    try{\n      FileOutputStream fileOut = new FileOutputStream(\"c:\\\\workbook.xls\");\n      wb.write(fileOut);\n      }\n    catch (IOException e) {System.err.println(\"Error in write \nxl: \"+e.getMessage()); }", "is_private": false, "bug_id": 27405, "id": 53375, "time": "2004-03-03T11:39:06Z", "creator": "irb@pimsconsulting.com", "creation_time": "2004-03-03T11:39:06Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 27405, "attachment_id": null, "id": 58762, "time": "2004-06-04T15:25:27Z", "creator": "adammara@msn.com", "creation_time": "2004-06-04T15:25:27Z", "is_private": false, "text": "I added the patch described in bug report 24925 and it fixed this problem."}, {"count": 2, "tags": [], "bug_id": 27405, "attachment_id": null, "is_private": false, "id": 116276, "time": "2008-05-05T19:25:54Z", "creator": "josh@apache.org", "creation_time": "2008-05-05T19:25:54Z", "text": "Adam's fix (for bug 24925) probably did the trick.\nVerified OK from 2.5.1 onwards."}]