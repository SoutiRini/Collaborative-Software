[{"count": 0, "tags": [], "creator": "subhrajlahiri@gmail.com", "is_private": false, "id": 195159, "attachment_id": 34468, "bug_id": 60406, "creation_time": "2016-11-23T06:38:42Z", "time": "2016-11-23T06:38:42Z", "text": "Created attachment 34468\nAdded the output snapshot which validates the bug.\n\nDescription:\n============\nI am using Apache POI library to extract images from a word(docx) file. The issue that I am facing is regarding extension(image type) extraction and is described as follows:\n   * I am getting wrong extension for images(embedded via insert object from insert tab).\n   * When the image is embedded via drag and drop then the extension is perfectly extracted\n\nSteps to reproduce :\n====================\n1. Create a docx file with two images embedded to it.\n   a. Embed first image (assume it to be 1.jpeg) via (Insert Tab -> Insert Object -> Create from file -> Add object).\n   b. Embed second image (assume it to be 2.png) via drag and dropping in the word file.\n\n2. Create a java program which accepts the file created and processes the file and extracts the image file and shows the \"image type\" and \"name\" in the console.\n\nExpected Result:\n=================\n5 => //Document.PICTURE_TYPE_JPEG = 5\nimage1.jpeg\n6 => //Document.PICTURE_TYPE_PNG = 6\nimage2.png\n\nCurrent Result:\n================\n2 => //Document.PICTURE_TYPE_EMF = 2\nimage1.emf\n6 => //Document.PICTURE_TYPE_PNG = 6\nimage2.png\n\n\nCode used for extracting the image information:\n================================================\n\nInputStream content = null;   \ncontent = new BufferedInputStream(new FileInputStream(filePath));\nXWPFDocument doc = new XWPFDocument(content);\nList<XWPFPictureData> pics = doc.getAllPictures();\nfor(XWPFPictureData pic : pics)\n{\n     System.out.println(pic.getPictureType());\n     System.out.println(pic.getFileName());\n}"}]