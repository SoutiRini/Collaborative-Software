[{"count": 0, "tags": [], "creator": "oded@cyota.com", "attachment_id": null, "text": "Excel is corrupted when I try adding HYPERLINK formulas with long urls.\nThe code is:\n\n  col1.setCellType(HSSFCell.CELL_TYPE_FORMULA);                        \n  String formula = \"HYPERLINK(\\\"\" +  url + \"\\\"\" + \")\";\n  col1.setCellFormula(formula);                                    \n\nThis creats a corrupt Excel for the url:\nhttp://www.fundacioncondor.org.ar/sitio/modules/My_eGallery/public/wamu/index.p\nhp?MfcISAPICommand=VerifyFPP&UsingSSL=1&login=&pass=\n\nFor a the URL:\nwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\nwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\nI got the following Exception:\n\njava.lang.ArrayIndexOutOfBoundsException: 2378\n\tat org.apache.poi.util.StringUtil.putCompressedUnicode\n(StringUtil.java:196)\n\tat org.apache.poi.hssf.record.formula.StringPtg.writeBytes\n(StringPtg.java:97)\n\tat org.apache.poi.hssf.record.FormulaRecord.serializePtgs\n(FormulaRecord.java:407)\n\tat org.apache.poi.hssf.record.FormulaRecord.serialize\n(FormulaRecord.java:361)\n\tat \norg.apache.poi.hssf.record.aggregates.FormulaRecordAggregate.serialize\n(FormulaRecordAggregate.java:84)\n\tat \norg.apache.poi.hssf.record.aggregates.ValueRecordsAggregate.serialize\n(ValueRecordsAggregate.java:153)\n\tat org.apache.poi.hssf.model.Sheet.serialize(Sheet.java:815)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.getBytes\n(HSSFWorkbook.java:794)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.write\n(HSSFWorkbook.java:732)\n\tat cyota.fraudaction.util.AOLDailyResultSender.main\n(AOLDailyResultSender.java:98)\n\n\n\nOther than that it's super. Great job!\n\nOded", "id": 68927, "time": "2004-12-23T15:14:20Z", "bug_id": 32830, "creation_time": "2004-12-23T15:14:20Z", "is_private": false}, {"count": 1, "text": "Retested OK in 3.1-beta1.\n\nArrayIndexOutOfBoundsException reproducible in 2.5.1\n\nThis bug seems to have been fixed in 3.0.\n", "creator": "josh@apache.org", "attachment_id": null, "id": 116459, "time": "2008-05-10T19:16:03Z", "bug_id": 32830, "creation_time": "2008-05-10T19:16:03Z", "tags": [], "is_private": false}]