[{"count": 0, "tags": [], "creator": "onealj@apache.org", "text": "Created attachment 31941\nzip file containing excel files used to reproduce the bugs, table1.xml and diffs\n\nSteps to reproduce:\nIn Excel:\n1. add data to a sheet in a blank workbook\n2. Select the range and make it a table (Excel > Insert > Tables > Table)\n3. Insert a new column in the middle of the table.\n4. Save the workbook as OOXML format\n\nIn POI:\n5. Open, save, and close the workbook:\n    String input_filename = \"Excel_does_not_find_unreadable_content.xlsx\";\n    String output_filename = \"Excel_finds_unreadable_content.xlsx\";\n    Workbook wb = WorkbookFactory.create(FileInputStream(input_filename));\n    wb.write(FileOutputStream(File(output_filename)));\n\nIn Excel:\n6. Open workbook. Excel dialog: \"Excel found unreadable content in <filename.xlsx>. Do you want to recover the contents of this workbook. If you trust the source of this workbook, click Yes.\"", "id": 177362, "time": "2014-08-26T02:29:38Z", "bug_id": 56886, "creation_time": "2014-08-26T02:29:38Z", "is_private": false, "attachment_id": 31941}, {"count": 1, "text": "It appears that updateHeaders, which is called when the table is written out via writeTo(OutputStream), incorrectly updates the tableColumn names.\nThis occurs because the order of the columns (column index relative to the first column) is not necessarily the same as the tableColumn.id.\n\n--- \"a/Q:\\\\ABDT\\\\s1d1\\\\c band tables\\\\bug\\\\table1 (table column inserted after table was created - before POI).xml\"\t\n+++ \"b/Q:\\\\ABDT\\\\s1d1\\\\c band tables\\\\bug\\\\table1 (table column inserted after table was created - after POI).xml\"\n     <tableColumns count=\"4\">\n         <tableColumn id=\"1\" name=\"City\"/>\n-        <tableColumn id=\"4\" name=\"Population\"/>\n-        <tableColumn id=\"2\" name=\"Latitude\"/>\n-        <tableColumn id=\"3\" name=\"Longitude\"/>\n+        <tableColumn id=\"4\" name=\"Longitude\"/>\n+        <tableColumn id=\"2\" name=\"Population\"/>\n+        <tableColumn id=\"3\" name=\"Latitude\"/>\n     </tableColumns>", "bug_id": 56886, "is_private": false, "id": 177363, "time": "2014-08-26T02:33:08Z", "creator": "onealj@apache.org", "creation_time": "2014-08-26T02:33:08Z", "tags": [], "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 56886, "is_private": false, "id": 181476, "attachment_id": null, "creator": "dominik.stadler@gmx.at", "creation_time": "2015-03-03T19:58:31Z", "time": "2015-03-03T19:58:31Z", "text": "I tried this with latest 3.12-beta1 and could not reproduce it. Can you check if this was in fact fixed since 3.10 was released?"}, {"count": 3, "text": "I was unable to reproduce this bug in POI 3.11-final and 3.12-beta1, so it's safe to assume that some change made between 3.10-final and 3.11-final resolved this issue.\n\nCommits that may have resolved this problem\n* r1596624 bug 56274 Correct SXSSF writing of tables when creating from a template\n* r1564050 bug 55923 Xml data export leads to a NPE when sorting output data\n* bug56814 Switch from dom4j to JAXP\n* update Apache XMLBeans to 2.6.0\n* r1621209 bug 26730 Fix exporting XML if schema contains ref-elements\n\nThis bug can be closed.", "bug_id": 56886, "attachment_id": null, "id": 181559, "time": "2015-03-06T19:44:19Z", "creator": "onealj@apache.org", "creation_time": "2015-03-06T19:44:19Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "creator": "dominik.stadler@gmx.at", "text": "Ok, thanks for testing, I am closing this issue as resolved based on test-results reported in the previous comment.", "id": 181593, "time": "2015-03-08T19:47:08Z", "bug_id": 56886, "creation_time": "2015-03-08T19:47:08Z", "is_private": false, "attachment_id": null}]