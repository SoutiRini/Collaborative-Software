[{"count": 0, "tags": [], "text": "In domain.xml:\n\n<nodestore classname=\"com.wow.framework.security.slide.UserStore\">\n    <parameter name=\"wibble\">wibble...</parameter>\n</nodestore>\n\nThis is deployed in the WAR, along with the domain.xml config, and the setup for the servlets.  \nHowever, the classloader cannot find it, for some bizarre reason, even though it did find and load the \ndomain configuration correctly.\n\nThe problem appears to be that when the core JARs are in ${tomcat}/shared/lib, for example, and not in \nthe WEB-INF, it uses the classloader associated with the class, and not that associated with the servlet \nloading the configuration in the first place; hence, replacement stores cannot be loaded.\n\nCan this be changed, please, so that the servlet's classloader is set on the domain object before the \nconfiguration is loaded, and that config loading uses the domain's manual classloader to do this?", "attachment_id": null, "bug_id": 30694, "id": 62035, "time": "2004-08-16T12:30:28Z", "creator": "gblock@ctoforaday.com", "creation_time": "2004-08-16T12:30:28Z", "is_private": false}, {"count": 1, "tags": [], "creator": "gblock@ctoforaday.com", "attachment_id": null, "id": 62036, "time": "2004-08-16T12:31:48Z", "bug_id": 30694, "creation_time": "2004-08-16T12:31:48Z", "is_private": false, "text": "(basically, I don't necessarily want to enforce a requirement to put all slide jars into the WAR; and \nhaving the config load class files from an appropriate classloader would be helpful)"}, {"count": 2, "text": "I agree that classloading in Tomcat is a pain. IIRC the reason that the slide\njars must be in shared/lib is the that the Slide Realm otherwise cannot be\nloaded. I remember that using Tomcat 4.1.x along with the JAAS LoginModule for\nauthentication all the slide jars could be in the web application context. But I\nhave heard reports that this is no longer the case with Tomcat 5. Making a long\nstory short, I doubt there is a solution to your problem, apart from putting\nyour jars alongside the slide jars in shared/lib.", "bug_id": 30694, "is_private": false, "id": 62037, "time": "2004-08-16T12:55:30Z", "creator": "unico@hippo.nl", "creation_time": "2004-08-16T12:55:30Z", "tags": [], "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 30694, "attachment_id": null, "id": 62038, "time": "2004-08-16T13:10:05Z", "creator": "gblock@ctoforaday.com", "creation_time": "2004-08-16T13:10:05Z", "is_private": false, "text": "Ahh, but see, that won't help:\n\nBecause Domain.xml is using self.getClass().getClassLoader(), it will fail to find things *in the war* - \nspecifically, it will fail to find my own, WAR-contained Nodestore.\n\nI'm more than happy to put the wars into the shared/lib directory - but doing so immediately makes it \nimpossible to use a custom nodestore, because domain is loading them with the wrong classloader.\n\nWhat should happen is that the servlet should set, on Domain, the classloader from the WAR; then, \nDomain and its subcomponents should always use a getClassLoader() method on the Domain object to \nget the appropriate classloader for loading nodestores.\n\nThat would then just magically work.  Basically, get/setClassLoader() on Domain, with the default being \nDomain.class.getClassLoader(), but with the WebdavServlet calling setClassLoader() before loading the \ndomain configuration."}, {"count": 4, "text": "Assuming it's possible, I concur.", "bug_id": 30694, "is_private": false, "id": 64559, "time": "2004-10-04T12:14:26Z", "creator": "gblock@ctoforaday.com", "creation_time": "2004-10-04T12:14:26Z", "tags": [], "attachment_id": null}, {"count": 5, "tags": [], "creator": "gblock@ctoforaday.com", "attachment_id": null, "id": 69519, "time": "2005-01-11T11:12:58Z", "bug_id": 30694, "creation_time": "2005-01-11T11:12:58Z", "is_private": false, "text": "Any chance of this change to the servlet/domain pair being made for 2.2 or 2.1 bugfix?"}, {"count": 6, "tags": [], "creator": "masonjm@apache.org", "attachment_id": null, "is_private": false, "id": 69661, "time": "2005-01-14T05:37:22Z", "bug_id": 30694, "creation_time": "2005-01-14T05:37:22Z", "text": "Can you post a patch? If it works we can add it to 2.2."}, {"count": 7, "tags": [], "creator": "gblock@ctoforaday.com", "attachment_id": null, "is_private": false, "id": 69798, "time": "2005-01-18T12:27:44Z", "bug_id": 30694, "creation_time": "2005-01-18T12:27:44Z", "text": "I'll prep a set of changes as soon as 2.2 dev becomes stable enough to start testing the service on."}]