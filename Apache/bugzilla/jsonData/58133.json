[{"count": 0, "tags": [], "bug_id": 58133, "attachment_id": null, "text": "Using trunk of today (latest commit 2f8aa558b344f5e891e99cd020a0305d9a6e8e62), opening in Word 2010 a docx encrypted using POI gives the prompt:\n\n\"This file may have been tampered with or corrupted and the contents should not be trusted.  Do you wish to continue opening this file?\"\n\nThis is the first time I've tried doing this, so I'm not sure whether this is a regression or not.\n\nCode to repro:\n\n         POIFSFileSystem fs = new POIFSFileSystem();\n         EncryptionInfo info = new EncryptionInfo(EncryptionMode.agile);\n\n         Encryptor enc = info.getEncryptor();\n         enc.confirmPassword(\"foobaa\");\n\n         OPCPackage opc = OPCPackage.open(new File(inputfilepath), PackageAccess.READ_WRITE);\n         OutputStream os = enc.getDataStream(fs);\n         opc.save(os);\n         opc.close();\n\n         FileOutputStream fos = new FileOutputStream(new File(outputfilepath));\n         fs.writeFilesystem(fos);\n         fos.close();   \n\nInput a simple hello world docx (I created one in Word 2010).", "id": 184009, "time": "2015-07-13T11:07:43Z", "creator": "jason@plutext.org", "creation_time": "2015-07-13T11:07:43Z", "is_private": false}, {"count": 1, "tags": [], "text": "I guess this error was introduced by r1647867\n\nI'm onto it ...", "attachment_id": null, "id": 184016, "creator": "kiwiwings@apache.org", "time": "2015-07-13T21:27:40Z", "bug_id": 58133, "creation_time": "2015-07-13T21:27:40Z", "is_private": false}, {"count": 2, "tags": [], "text": "fixed with r1690837\n\nActually this was only a test, if anyone uses the encryption code (facepalm)\nThis bug was introduced right after 3.11 final came out and affected the\nchecksum calculation.\n\nPlease confirm it, as I currently have only Libre Office, Excel Viewer (can't process agile encryption, only standard encryption) and Word Viewer available...", "attachment_id": null, "id": 184017, "creator": "kiwiwings@apache.org", "time": "2015-07-13T22:55:04Z", "bug_id": 58133, "creation_time": "2015-07-13T22:55:04Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 58133, "attachment_id": null, "text": "Fix confirmed. Thank you!", "id": 184018, "time": "2015-07-14T00:14:16Z", "creator": "jason@plutext.org", "creation_time": "2015-07-14T00:14:16Z", "is_private": false}]