[{"count": 0, "tags": [], "bug_id": 55385, "text": "execute the code:\n\n      Workbook workbook = new XSSFWorkbook();\n        Sheet createSheet = workbook.createSheet();\n        Row row = createSheet.createRow(0);\n        Cell cell = row.createCell(0);\n        CellStyle cellStyle = workbook.createCellStyle();\n\n\n        Font createFont = workbook.createFont();\n         createFont.setBoldweight((short)300);\n\n        cellStyle.setFont(createFont);\n        cell.setCellStyle(cellStyle);\n\n\t\tshort fontIndex = cell.getCellStyle().getFontIndex();\n\t\tFont fontAt = workbook.getFontAt(fontIndex);\n\t\tSystem.out.println(fontAt.getBoldweight());\n\nthe boldweight can't be set to 300. due to :\n\n    public short getBoldweight()\n    {\n        return getBold() ? BOLDWEIGHT_BOLD : BOLDWEIGHT_NORMAL;\n    }\n\n\n\n\norg.apache.poi.xssf.usermodel.XSSFFont.getBoldweight()\nis 400 or 700 only. if so, why provide the setBoldweight() to set any short value?", "id": 169289, "time": "2013-08-08T01:06:07Z", "creator": "fujian1115@gmail.com", "creation_time": "2013-08-08T01:06:07Z", "is_private": false, "attachment_id": null}, {"count": 1, "text": "at the sometime, HSSFFont's set/get boldweight is right,", "creator": "fujian1115@gmail.com", "is_private": false, "id": 169290, "time": "2013-08-08T01:07:28Z", "bug_id": 55385, "creation_time": "2013-08-08T01:07:28Z", "tags": [], "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 55385, "attachment_id": null, "id": 189992, "time": "2016-04-06T02:48:00Z", "creator": "onealj@apache.org", "creation_time": "2016-04-06T02:48:00Z", "is_private": false, "text": "Looking at XSSFFont.setBoldweight(short boldweight), it looks like getBoldweight and setBoldweight were never intended to be used with literals--only the Font.BOLDWEIGHT_NORMAL and Font.BOLDWEIGHT_BOLD constants. [1]\n\nYour example can be simplified to:\nWorkbook wb = new XSSFWorkbook();\nFont font = wb.createFont();\nshort weight = 314;\nassumeTrue(weight != Font.BOLDWEIGHT_NORMAL);\nassumeTrue(weight != Font.BOLDWEIGHT_BOLD);\nfont.setBoldweight(weight);\nassertEquals(weight, font.getBoldweight);\n\nThe XSSFFont never stores the requested boldweight.\nIf the OOXML format allows specifying a numeric weight in addition to a boolean bold/not-bold value, then this is a bug in POI.\n\nFrom what I can make out in the 2006 OOXML schema, custom font weights are not part of the standard.\n\nsml-styles.xsd:\n  <xsd:complexType name=\"CT_Font\">\n    <xsd:choice maxOccurs=\"unbounded\">\n      ...\n      <xsd:element name=\"b\" type=\"CT_BooleanProperty\" minOccurs=\"0\" maxOccurs=\"1\">\n        <xsd:annotation>\n          <xsd:documentation>Bold</xsd:documentation>\n        </xsd:annotation>\n      </xsd:element>\n      ...\n    </xsd:choice>\n  </xsd:complexType>\n\nA note should be added to XSSFFont.get/setBoldweight javadocs that only the named constants will work.\n\n[1] https://svn.apache.org/viewvc/poi/trunk/src/ooxml/java/org/apache/poi/xssf/usermodel/XSSFFont.java?revision=1701134&view=markup#l300"}, {"count": 3, "tags": [], "bug_id": 55385, "text": "Created attachment 33730\nJavadocs fixes for XSSFFont", "id": 189993, "time": "2016-04-06T03:27:51Z", "creator": "onealj@apache.org", "creation_time": "2016-04-06T03:27:51Z", "is_private": false, "attachment_id": 33730}, {"count": 4, "tags": [], "bug_id": 55385, "attachment_id": null, "text": "Or deprecate setBoldweight.", "id": 191667, "time": "2016-06-15T10:53:13Z", "creator": "onealj@apache.org", "creation_time": "2016-06-15T10:53:13Z", "is_private": false}, {"count": 5, "tags": [], "creator": "onealj@apache.org", "attachment_id": null, "text": "Are there any real usecases for using get/setBoldweight(short) when get/setBold(boolean) exists? I don't think Excel OOXML schema supports non-boolean bold values.\nAre there any objections to deprecating get/setBoldweight?", "id": 191708, "time": "2016-06-16T06:18:10Z", "bug_id": 55385, "creation_time": "2016-06-16T06:18:10Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 55385, "text": "Applied deprecation warning in r1748658.", "id": 191709, "time": "2016-06-16T06:53:05Z", "creator": "onealj@apache.org", "creation_time": "2016-06-16T06:53:05Z", "is_private": false, "attachment_id": null}]