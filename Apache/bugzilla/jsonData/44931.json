[{"count": 0, "attachment_id": null, "bug_id": 44931, "text": "Hi,\n\nwhen Apache Bench is used with the -g option (\"output a gnuplot file\"), the second colon is named \"seconds\". But it contains data of type apr_time_t, which is the \"number of microseconds since 00:00:00 january 1, 1970 UTC\" (according to [http://apr.apache.org/docs/apr/0.9/group__apr__time.html#gdb4bde16055748190eae190c55aa02bb]). Moreover, there is a comment at the begining of ab.c indicating \"seconds\" instead of \"microseconds\" too.\n\nI propose the following patch:\n\n*** ab.c\t2008-05-05 08:21:52.000000000 +0200\n--- ab.c.orig\t2008-05-05 08:21:00.000000000 +0200\n***************\n*** 239,245 ****\n  \n  struct data {\n      int read;              /* number of bytes read */\n!     apr_time_t starttime;  /* start time of connection in microseconds since\n                              * Jan. 1, 1970 */\n      apr_interval_time_t waittime;   /* Between writing request and reading\n                                       * response */\n--- 239,245 ----\n  \n  struct data {\n      int read;              /* number of bytes read */\n!     apr_time_t starttime;  /* start time of connection in seconds since\n                              * Jan. 1, 1970 */\n      apr_interval_time_t waittime;   /* Between writing request and reading\n                                       * response */\n***************\n*** 844,850 ****\n                  perror(\"Cannot open gnuplot output file\");\n                  exit(1);\n              }\n!             fprintf(out, \"starttime\\tmicroseconds\\tctime\\tdtime\\tttime\\twait\\n\");\n              for (i = 0; i < requests; i++) {\n                  apr_time_t diff = stats[i].time - stats[i].ctime;\n  \n--- 844,850 ----\n                  perror(\"Cannot open gnuplot output file\");\n                  exit(1);\n              }\n!             fprintf(out, \"starttime\\tseconds\\tctime\\tdtime\\tttime\\twait\\n\");\n              for (i = 0; i < requests; i++) {\n                  apr_time_t diff = stats[i].time - stats[i].ctime;\n\nRegards,\nGabriel Kerneis", "id": 116231, "time": "2008-05-04T23:31:44Z", "creator": "gabriel+apache@kerneis.info", "creation_time": "2008-05-04T23:31:44Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 44931, "attachment_id": null, "is_private": false, "id": 116451, "time": "2008-05-10T17:41:47Z", "creator": "fielding@apache.org", "creation_time": "2008-05-10T17:41:47Z", "text": "Fixed in r655214 of trunk.\n\nI was fixing other errors when I found this inconsistency with ab\nas distributed with httpd 1.3.x.  I restored the old output and then\nfound your PR today while looking for related errors.\n\nIt might make more sense for ab to consistently output milliseconds\nin fractional form (making full use of the microsecond resolution),\nbut that would be an enhancement.\n"}, {"count": 2, "tags": [], "text": "Backported to 2.2.x as r660576 (http://svn.apache.org/viewvc?rev=660576&view=rev).", "is_private": false, "id": 117059, "creator": "rpluem@apache.org", "time": "2008-05-27T15:14:37Z", "bug_id": 44931, "creation_time": "2008-05-27T15:14:37Z", "attachment_id": null}]