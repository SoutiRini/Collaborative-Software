[{"count": 0, "tags": [], "bug_id": 10943, "attachment_id": null, "text": "I would like to modify a workbook including a sheet with an chart on it.\nTrying to do this I always running into trouble. Modifying a workbook\nwithout a chart in it works without problems. \n\nSometimes the error occurs when I would like to open the Workbook (file \nworkbook.xls)\n\njava.lang.NullPointerException\n\tat org.apache.poi.hssf.usermodel.HSSFSheet.setPropertiesFromSheet\n(HSSFSheet.java:171)\n\tat org.apache.poi.hssf.usermodel.HSSFSheet.<init>(HSSFSheet.java:134)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:154)\n\tat net.gedas.ecu.servlet.util.FehlerAuswertung1Helper.main\n(FehlerAuswertung1Helper.java:131)\n\nSometimes it occurs when I would like to write the workbook back to the file \nFehlerAuswertung1.xls:\n\njava.lang.ArrayIndexOutOfBoundsException\n\tat org.apache.poi.util.LittleEndian.putNumber(LittleEndian.java:550)\n\tat org.apache.poi.util.LittleEndian.putShort(LittleEndian.java:242)\n\tat org.apache.poi.hssf.record.SelectionRecord.serialize\n(SelectionRecord.java:261)\n\tat org.apache.poi.hssf.model.Sheet.serialize(Sheet.java:584)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.getBytes\n(HSSFWorkbook.java:513)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.write\n(HSSFWorkbook.java:465)\n\tat net.gedas.ecu.servlet.util.FehlerAuswertung1Helper.main\n(FehlerAuswertung1Helper.java:163)\n\nI have run the file with the charts against Biffviewer and there are unknown\nrecords in it. Whatever this means :-(\n\nOn the POI-homepage I have found the following description:\n\n\"You can not currently create charts. This is planned for the 2.0 release.\nYou can however create a chart in Excel, modify the chart data values using\nHSSF and write a new spreadsheet out. This is possible because POI attempts\nto keep existing records intact as far as possible.\"\n\nIn my opinion this is exactly what I want to do! Why does it not work? \n\nKind regards,\n\nArne Clau\u00df", "id": 19759, "time": "2002-07-18T12:13:14Z", "creator": "arne.clauss@gedas.de", "creation_time": "2002-07-18T12:13:14Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 10943, "attachment_id": 2394, "is_private": false, "id": 19760, "time": "2002-07-18T12:15:19Z", "creator": "arne.clauss@gedas.de", "creation_time": "2002-07-18T12:15:19Z", "text": "Created attachment 2394\nFile which isn't working on my comp"}, {"count": 2, "tags": [], "text": "Please check \n\n-- Glen", "attachment_id": null, "id": 19878, "creator": "glens@apache.org", "time": "2002-07-20T07:50:50Z", "bug_id": 10943, "creation_time": "2002-07-20T07:50:50Z", "is_private": false}, {"count": 3, "tags": [], "creator": "arne.clauss@gedas.de", "attachment_id": null, "text": "Hello Glen!\n\nThe part with the workbook.xls is working very fine now. The second error with \nthe file FehlerAuswertung1.xls is still present! \n\nIn the first file file (workbook.xls) the chart is a seperate sheet, whereas in \nthe second file (FehlerAuswertung1.xls) the chart is a part of a table sheet.\n\nThanks a lot for your work until now,\n\nRegards,\n\nArne", "id": 19952, "time": "2002-07-22T07:21:04Z", "bug_id": 10943, "creation_time": "2002-07-22T07:21:04Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 10943, "attachment_id": 2433, "id": 19954, "time": "2002-07-22T07:23:47Z", "creator": "arne.clauss@gedas.de", "creation_time": "2002-07-22T07:23:47Z", "is_private": false, "text": "Created attachment 2433\nFile with a chart included in a table sheet"}, {"count": 5, "tags": [], "creator": "glens@apache.org", "attachment_id": null, "text": "Somehow I missed that second attachment altogether!  Sorry about that.  I'll\ntake a look when I next have some Poi time.", "id": 19956, "time": "2002-07-22T07:25:53Z", "bug_id": 10943, "creation_time": "2002-07-22T07:25:53Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 10943, "text": "Looks this may be a tough one to fix.  It appears to be related to the formula's\nyou're including in the sheet.  The are actually creating a STRING record that\nPoi currently doesn't handle.\n\nWill continue looking into a solution for this problem.", "id": 20327, "time": "2002-07-28T12:50:44Z", "creator": "glens@apache.org", "creation_time": "2002-07-28T12:50:44Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "text": "Okay... I think I've fixed the chart handling... \n\nBUT...\n\nThe attached spreadsheet includes a VBA macro somewhere (use poi browser to see \nit) and since this is not supported yet we have a problem.  I believe Andy is \ndoing some work for this so either wait for that or remove your VBA macro and \ngive it a shot.\n\nI will be committing the changes sometime in the next 24 hours (hopefully).\n\n\n", "attachment_id": null, "id": 21357, "creator": "glens@apache.org", "time": "2002-08-20T07:49:25Z", "bug_id": 10943, "creation_time": "2002-08-20T07:49:25Z", "is_private": false}]