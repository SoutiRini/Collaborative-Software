[{"count": 0, "tags": [], "bug_id": 27541, "attachment_id": null, "id": 53724, "time": "2004-03-09T15:18:53Z", "creator": "bloritsch@apache.org", "creation_time": "2004-03-09T15:18:53Z", "is_private": false, "text": "Java 1.5 has JAXP classes just like Java 1.4, however, JUnitReport cannot run\nbecause it cannot find Xalan.  The message I get is:\n\n\nBUILD FAILED\nfile:f:/d-haven.org/dojo/build.xml:62: Could not find xalan2 nor xalan1 in the\nclasspath. Check http://xml.apache.org/xalan-j\n\nI will upgrade 1.6.1, but this seems to be an ugly issue.  If the problem\npersists, I will update this bug."}, {"count": 1, "tags": [], "bug_id": 27541, "is_private": false, "id": 53726, "attachment_id": null, "creator": "bloritsch@apache.org", "creation_time": "2004-03-09T15:26:55Z", "time": "2004-03-09T15:26:55Z", "text": "Still a problem in Version 1.6.1"}, {"count": 2, "tags": [], "bug_id": 27541, "attachment_id": null, "id": 53728, "time": "2004-03-09T15:31:41Z", "creator": "bloritsch@apache.org", "creation_time": "2004-03-09T15:31:41Z", "is_private": false, "text": "If I explicitly add the Xalan Jars to the ANT/lib  directory, then it works. \nAny reason you can't just use whatever is in the JDK?"}, {"count": 3, "tags": [], "creator": "bloritsch@apache.org", "is_private": false, "text": "I spoke too soon:\n\nHere is the stack trace from JunitReport:\n\n[junitreport] Using Xalan version: Xalan Java 2.6.0\n\nBUILD FAILED\njava.lang.ExceptionInInitializerError\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1224)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1063)\n        at org.apache.tools.ant.Main.runBuild(Main.java:632)\n        at org.apache.tools.ant.Main.startAnt(Main.java:183)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:197)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:56)\nCaused by: java.lang.ExceptionInInitializerError\n        at org.apache.xml.serializer.ToStream.<init>(ToStream.java:112)\n        at org.apache.xml.serializer.ToHTMLStream.<init>(ToHTMLStream.java:557)\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstruct\norAccessorImpl.java:39)\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingC\nonstructorAccessorImpl.java:27)\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:415)\n        at java.lang.Class.newInstance0(Class.java:322)\n        at java.lang.Class.newInstance(Class.java:275)\n        at org.apache.xml.serializer.SerializerFactory.getSerializer(SerializerF\nactory.java:91)\n        at org.apache.xalan.transformer.TransformerImpl.createSerializationHandl\ner(TransformerImpl.java:1097)\n        at org.apache.xalan.transformer.TransformerImpl.createSerializationHandl\ner(TransformerImpl.java:981)\n        at org.apache.xalan.transformer.TransformerImpl.transform(TransformerImp\nl.java:1187)\n        at org.apache.xalan.transformer.TransformerImpl.transform(TransformerImp\nl.java:1170)\n        at org.apache.tools.ant.taskdefs.optional.junit.Xalan2Executor.execute(X\nalan2Executor.java:45)\n        at org.apache.tools.ant.taskdefs.optional.junit.AggregateTransformer.tra\nnsform(AggregateTransformer.java:147)\n        at org.apache.tools.ant.taskdefs.optional.junit.XMLResultAggregator.exec\nute(XMLResultAggregator.java:136)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:269)\n        at org.apache.tools.ant.Task.perform(Task.java:364)\n        at org.apache.tools.ant.Target.execute(Target.java:301)\n        at org.apache.tools.ant.Target.performTasks(Target.java:328)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1215)\n        ... 5 more\nCaused by: java.lang.NumberFormatException: For input string: \"be found at http:\n//www.iana.org/assignments/character-sets\"\n        at java.lang.NumberFormatException.forInputString(NumberFormatException.\njava:48)\n        at java.lang.Integer.parseInt(Integer.java:446)\n        at java.lang.Integer.valueOf(Integer.java:525)\n        at java.lang.Integer.decode(Integer.java:903)\n        at org.apache.xml.serializer.Encodings.loadEncodingInfo(Encodings.java:3\n93)\n        at org.apache.xml.serializer.Encodings.<clinit>(Encodings.java:429)\n        ... 26 more\n--- Nested Exception ---\njava.lang.ExceptionInInitializerError\n        at org.apache.xml.serializer.ToStream.<init>(ToStream.java:112)\n        at org.apache.xml.serializer.ToHTMLStream.<init>(ToHTMLStream.java:557)\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstruct\norAccessorImpl.java:39)\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingC\nonstructorAccessorImpl.java:27)\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:415)\n        at java.lang.Class.newInstance0(Class.java:322)\n        at java.lang.Class.newInstance(Class.java:275)\n        at org.apache.xml.serializer.SerializerFactory.getSerializer(SerializerF\nactory.java:91)\n        at org.apache.xalan.transformer.TransformerImpl.createSerializationHandl\ner(TransformerImpl.java:1097)\n        at org.apache.xalan.transformer.TransformerImpl.createSerializationHandl\ner(TransformerImpl.java:981)\n        at org.apache.xalan.transformer.TransformerImpl.transform(TransformerImp\nl.java:1187)\n        at org.apache.xalan.transformer.TransformerImpl.transform(TransformerImp\nl.java:1170)\n        at org.apache.tools.ant.taskdefs.optional.junit.Xalan2Executor.execute(X\nalan2Executor.java:45)\n        at org.apache.tools.ant.taskdefs.optional.junit.AggregateTransformer.tra\nnsform(AggregateTransformer.java:147)\n        at org.apache.tools.ant.taskdefs.optional.junit.XMLResultAggregator.exec\nute(XMLResultAggregator.java:136)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:269)\n        at org.apache.tools.ant.Task.perform(Task.java:364)\n        at org.apache.tools.ant.Target.execute(Target.java:301)\n        at org.apache.tools.ant.Target.performTasks(Target.java:328)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1215)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1063)\n        at org.apache.tools.ant.Main.runBuild(Main.java:632)\n        at org.apache.tools.ant.Main.startAnt(Main.java:183)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:197)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:56)\nCaused by: java.lang.NumberFormatException: For input string: \"be found at http:\n//www.iana.org/assignments/character-sets\"\n        at java.lang.NumberFormatException.forInputString(NumberFormatException.\njava:48)\n        at java.lang.Integer.parseInt(Integer.java:446)\n        at java.lang.Integer.valueOf(Integer.java:525)\n        at java.lang.Integer.decode(Integer.java:903)\n        at org.apache.xml.serializer.Encodings.loadEncodingInfo(Encodings.java:3\n93)\n        at org.apache.xml.serializer.Encodings.<clinit>(Encodings.java:429)\n        ... 26 more", "id": 53729, "time": "2004-03-09T15:34:27Z", "bug_id": 27541, "creation_time": "2004-03-09T15:34:27Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "bodewig@apache.org", "is_private": false, "text": "As to why it doesn't work without explicit Xalan jars, Sun has repackaged Xalan,\npartly into com/sun/org/apache/xalan, but that doesn't look complete either.\n\nAnt is using reflection to find org.apache.xalan.processor.XSLProcessorVersion\nand that fails.\n\nI can't comment on the second part (NumberFormatException) but vaguely recall that\nI've seen something like this in a different bvug report before - sorry, no more\ndetails.", "id": 53730, "time": "2004-03-09T15:42:26Z", "bug_id": 27541, "creation_time": "2004-03-09T15:42:26Z", "attachment_id": null}, {"id": 58540, "tags": [], "creator": "bodewig@apache.org", "is_private": false, "count": 5, "text": "I've just retried to work on this with JDK 1.5 beta2, I've patched the build file\nand <junitreport> to accept JDK 1.5 as executor - and will commit the changes\nto CVS HEAD shortly - but it still doesn't work.\n\nThe stylesheet we use for junitreport uses Xalan redirect extensions and I fail\nto locate them in JDK1.5, so running <junitreport> fails with\n\n> Errors while applying transformations: java.lang.RuntimeException: Unrecognized\n> XSLTC extension 'org.apache.xalan.lib.Redirect:write'\n\nIt requires is way more than my working XSLT knowledge to come up with a fix\nhere, I'm afraid.", "time": "2004-06-02T11:56:24Z", "bug_id": 27541, "creation_time": "2004-06-02T11:56:24Z", "attachment_id": null}, {"count": 6, "tags": [], "text": "http://java.sun.com/j2se/1.5.0/compatibility.html#4959783 seems to be the relevant\npiece.  In short, JDK 1.5 does not ship with Xalan, as far as Ant is concerned.\n\nWe'll probably need an XSLTC implementation of our junitreport stylesheets.", "attachment_id": null, "bug_id": 27541, "id": 58541, "time": "2004-06-02T12:06:19Z", "creator": "bodewig@apache.org", "creation_time": "2004-06-02T12:06:19Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 27541, "attachment_id": null, "id": 58550, "time": "2004-06-02T14:32:28Z", "creator": "ddevienne@lgc.com", "creation_time": "2004-06-02T14:32:28Z", "is_private": false, "text": "Well, I had a quick look at the XSL 2.0 spec, and they do have a <xsl:result-\ndocument> element which allows outputting to several documents, so no need to \nrely on extensions theoretically. (Where I'm confused is how XSL 2.0 relates to \nXSL 1.1 which also has output to mutliple documents. No mention I could see in \nthe spec!). Does XSLTC support <xsl:result-document> already?\n\nSo theoretically (again), we could apply a small transformation to the \nstylesheet itself to make it XSL 2.0 compatible, although rewritting the \nstylesheet for XSL 2.0 is another options. I worry about maintenance if we \nduplicate it though.\n\nJDK 1.5 is such a big leap (of faith?)... One wonders if it hasn't too many new \nthings. --DD"}, {"count": 8, "tags": [], "bug_id": 27541, "attachment_id": null, "id": 58590, "time": "2004-06-02T23:13:19Z", "creator": "sbailliez@apache.org", "creation_time": "2004-06-02T23:13:19Z", "is_private": false, "text": "Xalan is a XSLT 1.0 implementation and does not support XSLT 2.0 xsl:result-\ndocument (Saxon 7.x does).\n\nAbout XSLTC, I did a quick hack and I'm having a look but...it looks like I \nneed to upgrade to 2GB of memory before getting some results from it. The \nmemory usage is absolutely massive.\n\nRunning w/ JDK 1.5B1 (xalan 2.5.2) it jumps straight to 420MB and and I'm \ntransforming a 32.3KB xml...I'm running out of memory (only have a 512MB \nlaptop) about 60s later while it takes less than a second to perform the \ntransformation with JDK 1.4 and endorsed Xalan 2.6.0 (w and w/o xsltc)\n\nRunning 1.5B1 with Xalan 2.6.0 gives the exception mentionned above (which was \nmentionned in PR 28920 for the Xalan project but closed w/o investigations)\n\nAs for the stylesheet, it is a matter of changing the namespace declaration \n(but it should probably fail now with xalan 1 - no more used in a sane world \nthough - ) to xmlns:redirect=\"http://xalan.apache.org/xalan/redirect\"\n\nNothing committed yet of course.\n"}, {"count": 9, "tags": [], "bug_id": 27541, "is_private": false, "id": 58591, "attachment_id": null, "creator": "sbailliez@apache.org", "creation_time": "2004-06-03T00:24:07Z", "time": "2004-06-03T00:24:07Z", "text": "Ok I found what is the root cause of the exception in Xalan.\nThat's a bug in JDK 1.5B1 for java.util.Properties as they completely rewrote \nit and a comment is only considered if it is a newline, in our case, the \ncomment ends up as a property.\n\nI could not check for B2 but it does work fine for JDK 1.4 of course.\n\nFor a quick'n dirty fix for JDK 1.5:\nIn xalan.jar extract the file org/apache/xml/serializer/Encoding.properties\nYou will notice that the last line is\n# can be found at http://www.iana.org/assignments/character-sets\nAdd an extra line feed at the end of this line.\n\nRun your JVM 1.5 with system property:\n-Dorg.apache.xalan.serialize.encodings=file://my/path/to/Encodings.properties\n"}, {"count": 10, "attachment_id": null, "bug_id": 27541, "is_private": false, "id": 58597, "time": "2004-06-03T08:25:47Z", "creator": "bodewig@apache.org", "creation_time": "2004-06-03T08:25:47Z", "tags": [], "text": "I've just checked with the Xalan/Xerces combo from CVS HEAD that Gump places on my\ndisk and it seems to work for either 1.5B1 and 1.5B2 on Linux.\n\nI'm glad you are chiming in Stephane.\n\nMy first approach was to really simply change the namespace URI but I was afraid of\nbreaking Xalan1.  Maybe we should duplicate the styles and use different defaults\nfor Xalan1?\n\nDo you know whether all Xalan-J 2 versions support\nhttp://xalan.apache.org/xalan/redirect\ninstead of the Java class name?"}, {"count": 11, "attachment_id": null, "bug_id": 27541, "is_private": false, "id": 58610, "time": "2004-06-03T09:53:06Z", "creator": "sbailliez@apache.org", "creation_time": "2004-06-03T09:53:06Z", "tags": [], "text": "Just downloaded JDK1.5B2 and the java.util.Properties bug is fixed.\n\nMy current fix is a bit more complicated as I'm looking in order of preference \nfor:\n\n- (Xalan 2 XSLTC) org.apache.xalan.xsltc.ProcessorVersion\n- (XSLTC JDK 1.5) com.sun.org.apache.xalan.internal.xsltc.ProcessorVersion\n- (Xalan 2) org.apache.xalan.processor.XSLProcessorVersion\n- (Xalan 1) org.apache.xalan.xslt.XSLProcessorVersion\n\nThis is a bit brain dead for now as the version information could not be \nrelated at all to the default|selected transformer but it normally means you \ndo have a transformer available so I will have to look for something a bit \nmore solid for identification now that we have a half dozen of xalan \ntransformer factories flying around...\n\nAs for the namespace I have no idea, sorry.\n\nDo you think we should still keep backward compatibility for Xalan 1 ? As you \nsaw last time, it was already difficult to get our hands on Xalan1 archive and \nMyriam had to dig into archived CDs to send us a version. Considering that \nJAXP is now very widespread, it would be acceptable...but of course it is \nalways possible to duplicate and do some magic stylesheet pickup depending on \nthe processor."}, {"count": 12, "attachment_id": null, "bug_id": 27541, "is_private": false, "id": 58623, "time": "2004-06-03T11:15:51Z", "creator": "bodewig@apache.org", "creation_time": "2004-06-03T11:15:51Z", "tags": [], "text": "I'm not sure whether we might want to place Xalan2 in front of XSLTC given your\nexperience with it.  Otherwise I'm fine with the approach.\n\nAs for Xalan-1 support.  I vaguely recall that it doesn't really work today either,\nbut if we could at least keep the current functionality I'd prefer that.  No strong\nfeelings, though.\n"}, {"count": 13, "attachment_id": null, "bug_id": 27541, "is_private": false, "id": 59872, "time": "2004-06-25T13:53:52Z", "creator": "bodewig@apache.org", "creation_time": "2004-06-25T13:53:52Z", "tags": [], "text": "Fixed in CVS HEAD and the 1.6 branch.\n\nBerin, if you have any chance to build Ant from source and run it against your test\nwith JDK 1.5, that would be great.\n"}, {"count": 14, "tags": [], "creator": "stevel@apache.org", "is_private": false, "id": 63116, "attachment_id": null, "bug_id": 27541, "creation_time": "2004-09-06T09:40:05Z", "time": "2004-09-06T09:40:05Z", "text": "I am opening this again, as gump on java1.5 shows it is still not working.\n\nsee:\nhttp://brutus.apache.org/gump/jdk15/smartfrog/smartfrog-tasks-test/gump_work/build_smartfrog_smartfrog-tasks-test.html\nfor an example, We are getting the fault\n\"javax.xml.transform.TransformerFactoryConfigurationError: Provider\norg.apache.xalan.processor.TransformerFactoryImpl not found\"\n\nfrom our macro:\n    <macrodef name=\"sf-test-report\">\n      <attribute name=\"data\"/>\n      <attribute name=\"reports\"/>\n      <attribute name=\"failed\"/>\n      <sequential>\n        <junitreport todir=\"@{data}\">\n          <fileset dir=\"@{data}\">\n            <include name=\"TEST-*.xml\"/>\n          </fileset>\n          <report format=\"frames\" todir=\"@{reports}\"/>\n        </junitreport>\n        <fail if=\"@{failed}\">Unit tests failed see @{reports}</fail>\n      </sequential>\n    </macrodef>\n\nNow, the tests are failing, which may complicate the process, but I dont expect\nto see exception errors. We should be able to unit test this BTW, just create a\nsample output.xml file and junit over it to make sure all is well."}, {"count": 15, "tags": [], "creator": "bodewig@apache.org", "is_private": false, "text": "Steve, as I already said on the list, the problem is the Gump setup in your case.\n\nYou include Apache's xml-apis.jar which is configured to use Xalan as its default\nTransformerFactory.  Since you don't include xalan as well, the task fails.\n\nYou should either remove xml-apis (by saying ids=\"parser\" in the <depend> element\nfor Xerces) or add Xalan.\n", "id": 64411, "time": "2004-09-30T13:21:06Z", "bug_id": 27541, "creation_time": "2004-09-30T13:21:06Z", "attachment_id": null}, {"count": 16, "tags": [], "bug_id": 27541, "is_private": false, "id": 66518, "attachment_id": null, "creator": "bodewig@apache.org", "creation_time": "2004-11-05T12:27:32Z", "time": "2004-11-05T12:27:32Z", "text": "OK, closing it again, I'm very sure the problem doesn't exist, at least not in\nits original form, anymore.\n\nIt's the second bullet in <http://stefanbodewig.blogger.de/stories/167334/#XSLTC>"}, {"count": 17, "tags": [], "creator": "bodewig@apache.org", "is_private": false, "text": "(In reply to comment #16)\n\n> It's the second bullet in <http://stefanbodewig.blogger.de/stories/167334/#XSLTC>\n\nmoved to <http://stefan.samaflost.de/blog/2004/10/29#XSLTC>", "id": 76160, "time": "2005-06-08T14:30:07Z", "bug_id": 27541, "creation_time": "2005-06-08T14:30:07Z", "attachment_id": null}]