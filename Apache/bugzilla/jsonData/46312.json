[{"count": 0, "tags": [], "text": "Created attachment 22964\nexcel template I start on\n\nTrying to create an outlined excel spreadsheet I got the following exception. With the 3.1-FINAL everything work fine.\n\nConsider that:\n1) I start from an existing template (attached);\n2) I need to report sum on top, then I used sheet.setRowSumsBelow(false) and sheet.setAlternativeExpression(false), but, by comment those lines the problem still occurs.\n\nCaused by: java.lang.IllegalArgumentException: Specified rowIndex 30 is outside the allowable range (0..30)\n\tat org.apache.poi.hssf.record.aggregates.ValueRecordsAggregate.removeAllCellsValuesForRow(ValueRecordsAggregate.java:111)\n\tat org.apache.poi.hssf.record.aggregates.RowRecordsAggregate.removeRow(RowRecordsAggregate.java:120)\n\tat org.apache.poi.hssf.model.Sheet.addRow(Sheet.java:677)\n\tat org.apache.poi.hssf.usermodel.HSSFSheet.addRow(HSSFSheet.java:303)\n\tat org.apache.poi.hssf.usermodel.HSSFSheet.createRow(HSSFSheet.java:206)\n\tat it.mef.scai.shared.poiutils.ExcelUtil.inserisciValore(ExcelUtil.java:393)\n\tat it.mef.scai.paf.service.printexport.impl.GestioneFabbisogniExcelRenderServiceImpl.renderElement(GestioneFabbisogniExcelRenderServiceImpl.java:116)\n\tat it.mef.scai.paf.service.printexport.impl.GestioneFabbisogniExcelRenderServiceImpl.renderElement(GestioneFabbisogniExcelRenderServiceImpl.java:133)\n\tat it.mef.scai.paf.service.printexport.impl.GestioneFabbisogniExcelRenderServiceImpl.renderElement(GestioneFabbisogniExcelRenderServiceImpl.java:133)\n\tat it.mef.scai.paf.service.printexport.impl.GestioneFabbisogniExcelRenderServiceImpl.renderElement(GestioneFabbisogniExcelRenderServiceImpl.java:133)\n\tat it.mef.scai.paf.service.printexport.impl.GestioneFabbisogniExcelRenderServiceImpl.renderElement(GestioneFabbisogniExcelRenderServiceImpl.java:133)\n\tat it.mef.scai.paf.service.printexport.impl.ExcelTreeViewRenderServiceImpl.renderExcelTreeView(ExcelTreeViewRenderServiceImpl.java:58)\n\t... 78 more", "attachment_id": 22964, "id": 122931, "creator": "emilio.dolce@gmail.com", "time": "2008-11-29T15:39:22Z", "bug_id": 46312, "creation_time": "2008-11-29T15:39:22Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 46312, "attachment_id": 22965, "id": 122932, "time": "2008-11-29T15:40:41Z", "creator": "emilio.dolce@gmail.com", "creation_time": "2008-11-29T15:40:41Z", "is_private": false, "text": "Created attachment 22965\nabstract base excel render service impl"}, {"count": 2, "tags": [], "bug_id": 46312, "attachment_id": 22966, "id": 122933, "time": "2008-11-29T15:41:12Z", "creator": "emilio.dolce@gmail.com", "creation_time": "2008-11-29T15:41:12Z", "is_private": false, "text": "Created attachment 22966\nconcrete excel export class"}, {"count": 3, "tags": [], "bug_id": 46312, "text": "Created attachment 22967\nGeneral purpose utilities.", "id": 122934, "time": "2008-11-29T15:42:45Z", "creator": "emilio.dolce@gmail.com", "creation_time": "2008-11-29T15:42:45Z", "is_private": false, "attachment_id": 22967}, {"count": 4, "tags": [], "bug_id": 46312, "attachment_id": null, "id": 122963, "time": "2008-12-01T12:06:10Z", "creator": "josh@apache.org", "creation_time": "2008-12-01T12:06:10Z", "is_private": false, "text": "Fixed in svn r722206.\n\nNext time can you try to simplify your example code that you upload.  This bug can actually be shown with just 4 lines of code:\n\nHSSFWorkbook wb = new HSSFWorkbook();\nHSSFSheet sheet = wb.createSheet();\nHSSFRow row = sheet.createRow(30);\nrow = sheet.createRow(30);  // << throws IllegalArgumentException\n\n\n--\nAdding a cell to the row before the second call to createRow() makes the bug go away.  So your code must have been creating rows multiple times before adding cells.  In any case, POI supports this usage now."}]