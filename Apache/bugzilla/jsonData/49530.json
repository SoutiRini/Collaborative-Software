[{"count": 0, "tags": [], "bug_id": 49530, "attachment_id": 25669, "text": "Created attachment 25669\nApplication that show the behavior\n\nApparently a web application context is not correctly stopped when shutting down Tomcat 7.0.0. I noticed that the destroy() method of a Servlet that's loaded on startup was not called, and put together a test case (see attached files). \n\nThe test servlet writes to System.out on init() and destroy(), the output on init appears in logs/catalina.out, but no output on destroy. From what I  understand of the attached log, the context isn't stopped at all.\n\nSteps to reproduce:\n1. copy attached startupServlet.war to webapps\n2. start Tomcat, then \"StartTestServlet.init\" appears in catalina.out\n3. stop Tomcat\n\nActual Result:\nno output appears in logs/catalina.out\n\nExpected Result:\n\"StartTestServlet.destroy\" appears in catalina.out\ncatalina.log shows evidence of context /startupServlet being stopped\n\n\nFWIW:\njava -version:\njava version \"1.6.0_20\"\nJava(TM) SE Runtime Environment (build 1.6.0_20-b02)\nJava HotSpot(TM) 64-Bit Server VM (build 16.3-b01, mixed mode)\n\nuname -a\nLinux <hostname> 2.6.32-22-generic #36-Ubuntu SMP Thu Jun 3 19:31:57 UTC 2010 x86_64 GNU/Linux", "id": 138033, "time": "2010-06-30T10:08:43Z", "creator": "rainer.frey+tomcat@inxmail.de", "creation_time": "2010-06-30T10:08:43Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 49530, "attachment_id": 25670, "is_private": false, "id": 138034, "time": "2010-06-30T10:10:24Z", "creator": "rainer.frey+tomcat@inxmail.de", "creation_time": "2010-06-30T10:10:24Z", "text": "Created attachment 25670\nSource code of the test servlet"}, {"count": 2, "tags": [], "bug_id": 49530, "attachment_id": 25671, "id": 138035, "time": "2010-06-30T10:12:25Z", "creator": "rainer.frey+tomcat@inxmail.de", "creation_time": "2010-06-30T10:12:25Z", "is_private": false, "text": "Created attachment 25671\nLog file with LifecycleBase logger on FINE level"}, {"count": 3, "tags": [], "bug_id": 49530, "attachment_id": null, "is_private": false, "id": 138093, "time": "2010-07-02T14:05:51Z", "creator": "markt@apache.org", "creation_time": "2010-07-02T14:05:51Z", "text": "Thanks for the report and test case.\n\nThis has been fixed in trunk and will be included in 7.0.1 onwards."}, {"count": 4, "tags": [], "bug_id": 49530, "attachment_id": null, "is_private": false, "id": 139559, "time": "2010-08-30T08:38:19Z", "creator": "markt@apache.org", "creation_time": "2010-08-30T08:38:19Z", "text": "*** Bug 49846 has been marked as a duplicate of this bug. ***"}]