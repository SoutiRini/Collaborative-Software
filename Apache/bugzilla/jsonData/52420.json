[{"count": 0, "tags": [], "bug_id": 52420, "attachment_id": null, "is_private": false, "id": 152565, "time": "2012-01-04T11:18:11Z", "creator": "sachin.gorade@gmail.com", "creation_time": "2012-01-04T11:18:11Z", "text": "While running Apache POI on android with simple application I found that AbstractWordUtils class throws NullPointerException in compactChildNodesR method.\nThis is due to -\n\n while ( child2.getChildNodes().getLength() > 0 )\n  child1.appendChild( child2.getFirstChild() );\n// following line causes NullPointerException\n child2.getParentNode().removeChild( child2 );\n i--;\n\nI think a check should be there before removing this child. After adding a check my simple application is able to convert doc files to html on Android platform.\n\nFollowing is the code change that I have done -\n\n while ( child2.getChildNodes().getLength() > 0 )\n  child1.appendChild( child2.getFirstChild() );\n if(child2.getParentNode()!=null){\n  child2.getParentNode().removeChild( child2 );\n  i--;\n }"}, {"count": 1, "tags": [], "text": "Sachin,\n\nCould you please provide an example file, that produces an exception?\n\nSergey", "attachment_id": null, "id": 163199, "creator": "vlsergey@gmail.com", "time": "2012-11-05T15:53:14Z", "bug_id": 52420, "creation_time": "2012-11-05T15:53:14Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 52420, "attachment_id": 31043, "is_private": false, "id": 171213, "time": "2013-11-14T12:05:37Z", "creator": "yanis.biziuk@gmail.com", "creation_time": "2013-11-14T12:05:37Z", "text": "Created attachment 31043\nWith this file you can reproduce exception\n\nWith this file you can reproduce exception\n\n11-14 13:25:53.108: WARN/System.err(8630): Caused by: java.lang.NullPointerException\n11-14 13:25:53.108: WARN/System.err(8630): at org.apache.poi.hwpf.converter.AbstractWordUtils.compactChildNodesR(AbstractWordUtils.java:146)\n11-14 13:25:53.108: WARN/System.err(8630): at org.apache.poi.hwpf.converter.WordToHtmlUtils.compactSpans(WordToHtmlUtils.java:238)\n11-14 13:25:53.108: WARN/System.err(8630): at org.apache.poi.hwpf.converter.WordToHtmlConverter.processParagraph(WordToHtmlConverter.java:596)\n11-14 13:25:53.108: WARN/System.err(8630): at org.apache.poi.hwpf.converter.AbstractWordConverter.processParagraphes(AbstractWordConverter.java:1113)\n11-14 13:25:53.108: WARN/System.err(8630): at org.apache.poi.hwpf.converter.WordToHtmlConverter.processSingleSection(WordToHtmlConverter.java:617)\n11-14 13:25:53.108: WARN/System.err(8630): at org.apache.poi.hwpf.converter.AbstractWordConverter.processDocument(AbstractWordConverter.java:722)\n\nthis code will solve this error\n\n<code>\nif(child2.getParentNode()!=null){\n                child2.getParentNode().removeChild( child2 );\n                i--;\n            }\n</code>\n\nbut converted html not contains all data from doc file (other bug?)"}, {"count": 3, "tags": [], "bug_id": 52420, "attachment_id": 31044, "id": 171219, "time": "2013-11-14T14:48:08Z", "creator": "yanis.biziuk@gmail.com", "creation_time": "2013-11-14T14:48:08Z", "is_private": false, "text": "Created attachment 31044\npatch\n\nPatch to fix this error."}, {"count": 4, "tags": [], "text": "I have tried to reproduce the issue that you reported, but couldn't, see r1649147 for the related test-case that I added.\n\nCan you please retry this with the latest version of POI and if you still see the problem provide some more information, ideally via a self-contained unit-test?\n\nAlso I could not find any text not contained in the resulting document, which exact part was missing for you? Maybe this is fixed via some other changes in the meanttime...", "is_private": false, "bug_id": 52420, "id": 180131, "time": "2015-01-02T22:40:39Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-01-02T22:40:39Z", "attachment_id": null}, {"count": 5, "tags": [], "text": "Could not reproduce and no update for some time, therefore closing this as WORKSFORME.", "is_private": false, "bug_id": 52420, "id": 191768, "time": "2016-06-18T05:55:10Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-06-18T05:55:10Z", "attachment_id": null}]