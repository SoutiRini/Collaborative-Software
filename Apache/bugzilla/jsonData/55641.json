[{"count": 0, "tags": [], "bug_id": 55641, "attachment_id": null, "id": 170503, "time": "2013-10-09T12:18:58Z", "creator": "apachebugs@insaner.com", "creation_time": "2013-10-09T12:18:58Z", "is_private": false, "text": "In trying to do some SSI stuff I added a line to my parsed file that suddenly caused html tags to show up. I narrowed it down to this minimal test case (just the following, single line in the file to be parsed):\n\n<b></b>( the )\n\nYou will notice that the tags show up (I'm on Apache/2.2.22 (Fedora), by the way). However, if you do:\n\n<b></b>(the )\n\nor \n\n<b></b>( the)\n\nor \n\n<b></b>( xthe )\n\nor \n\n<b></b>( thex )\n\n(etc..) the file is served properly.\n\nOther combinations that trigger this bug include anything else in the brackets as long as the \"the\" is surrounded by space:\n\n<b></b> (tested on Apache/2.2.22 (Fedora) to give the results below)\n\nwhich was the original triggering text.\n\nstrange, huh?\n\n\n-- \n-insaner\nhttp://www.insaner.com"}, {"count": 1, "tags": [], "bug_id": 55641, "attachment_id": null, "id": 170504, "time": "2013-10-09T12:34:09Z", "creator": "covener@gmail.com", "creation_time": "2013-10-09T12:34:09Z", "is_private": false, "text": "are you using mod_mime_magic? What's the content-type if you serve the include file directly, and what is its filename?"}, {"count": 2, "tags": [], "bug_id": 55641, "is_private": false, "id": 170506, "attachment_id": null, "creator": "apachebugs@insaner.com", "creation_time": "2013-10-09T13:03:57Z", "time": "2013-10-09T13:03:57Z", "text": "Hi Eric,\n\nI made a few copies of the file and renamed its extensions, here are the results:\n\nthebug.ssi     - text/plain\nthebug.insert  - text/plain\nthebug.shtml   - text/plain\nthebug.html    - text/html\n\nI have it set so that it will parse all files, in case that makes a difference.\n\n# apachectl -t -D DUMP_MODULES|grep mime\nSyntax OK\n mime_magic_module (shared)\n mime_module (shared)"}, {"count": 3, "attachment_id": null, "bug_id": 55641, "is_private": false, "id": 170819, "time": "2013-10-24T20:56:48Z", "creator": "mike.rumph@oracle.com", "creation_time": "2013-10-24T20:56:48Z", "tags": [], "text": "Hello insaner,\n\nI have been trying to duplicate this without success.\nWhat SSI directives are you using?\n\nThanks,\n\nMike Rumph"}, {"count": 4, "tags": [], "bug_id": 55641, "attachment_id": 30966, "text": "Created attachment 30966\nseveral parsed files which are served differently", "id": 170828, "time": "2013-10-25T06:55:27Z", "creator": "apachebugs@insaner.com", "creation_time": "2013-10-25T06:55:27Z", "is_private": false}, {"count": 5, "tags": [], "creator": "apachebugs@insaner.com", "attachment_id": null, "is_private": false, "id": 170829, "time": "2013-10-25T07:06:21Z", "bug_id": 55641, "creation_time": "2013-10-25T07:06:21Z", "text": "(In reply to Mike Rumph from comment #3)\n\n> I have been trying to duplicate this without success.\n> What SSI directives are you using?\n\nhi Mike, thanks for looking into this, I have attached a zip file that you can extract and view the \"thebug_all.html\"\n\nwhen the bug is triggered, you will notice that the first two iframes (the .parse files) show up differently, the first being served as plain text (so you can see that html tags) and the second is fine (no html tags seen, due to the word \"the\" not being surrounded by spaces on both sides)\n\nI tried this on another server (debian 7.1, I am running fedora 14 here) and I too was unable to trigger the bug there.. though both servers have the same .htaccess files at the root and relative levels. I don't know if I will be able to check the apache config files to compare them, but I will try and see what I can do. Both are running apache 2.2.22. \n\nlet me know if this is enough info for you to trigger it on your side, or what other info you need (and how I can obtain it)"}, {"count": 6, "tags": [], "text": "Okay, the material is a different setup then what I was trying.\n\nUsing your samples I was able to view the webpage.\nBut the first two iframes display identically for me.\nOnly the .shtml and .ssi appear as plain text.\n\nI was using a Directory block in conf/httpd.conf instead of a .htaccess file,\nbut the results should have been the same.\n\nThere must be something else that is different in your configuration.\n\nThere might be something strange in your conf/magic file.\n\nI will need to do some research to see what else might cause the difference you are seeing.\n\nTake care,\n\nMike Rumph", "attachment_id": null, "id": 170855, "creator": "mike.rumph@oracle.com", "time": "2013-10-26T16:45:47Z", "bug_id": 55641, "creation_time": "2013-10-26T16:45:47Z", "is_private": false}, {"count": 7, "tags": [], "creator": "apachebugs@insaner.com", "attachment_id": null, "id": 170856, "time": "2013-10-26T17:12:57Z", "bug_id": 55641, "creation_time": "2013-10-26T17:12:57Z", "is_private": false, "text": "hi Mike, I just got the output of apachectl -M for the remote server I mentioned, and it does not have the \n mime_magic_module (shared)\nloaded (among other differences), whereas my local one (where the bug appears) does. Hopefully that helps.. how would I go about checking what is wrong with my mime magic file or the module itself? What would break if I disable the module to test locally?"}, {"count": 8, "tags": [], "bug_id": 55641, "attachment_id": null, "id": 170911, "creation_time": "2013-10-29T14:51:12Z", "time": "2013-10-29T14:51:12Z", "creator": "mike.rumph@oracle.com", "text": "Hello insaner,\n\nI am now able to reproduce the problem.\n\nI had to uncomment the following line in conf/httpd.conf:\n\nMimeMagicFile conf/magic\n\nI now see the same results you are seeing.\n\nI will now try to figure out why this is happening.\n\nTake care,\n\nMike Rumph", "is_private": false}, {"count": 9, "tags": [], "bug_id": 55641, "attachment_id": null, "id": 170912, "time": "2013-10-29T15:11:16Z", "creator": "apachebugs@insaner.com", "creation_time": "2013-10-29T15:11:16Z", "is_private": false, "text": "excellent, thanks!"}, {"count": 10, "text": "Okay, I did a little research.\n\nBelieve it or not, the behavior you are seeing appears to be working as intended.\n\nSee line 326 in modules/metadata/mod_mime_magic.c:\n\n- http://svn.apache.org/viewvc/httpd/httpd/branches/2.2.x/modules/metadata/mod_mime_magic.c?view=markup \n\n322 \t{\n323 \t    \"The\", L_ENG\n324 \t},\n325 \t{\n326 \t    \"the\", L_ENG\n327 \t},\n\nWhen \"The\" or \"the\" appear as tokens in a file, that file is considered English text and is marked as type \"text/plain\".\nYour other samples \"<b></b>(the )\" or \"<b></b>( the)\" keep \"the\" from being recognized as a token.\n\nSo \"<b></b>( the )\" is considered English text.\n\nEven more interesting are the following cases:\n\nEnglish:\n<h1></h1>( the )\n\nHTML:\n<h1> </h1>( the )\n\nEnglish:\n<b> </b>( the )\n\nThe httpd trunk version of mod_mime_magic.c appears to have the same code.\n\nThanks,\n\nMike Rumph", "bug_id": 55641, "attachment_id": null, "id": 170916, "time": "2013-10-29T19:35:30Z", "creator": "mike.rumph@oracle.com", "creation_time": "2013-10-29T19:35:30Z", "tags": [], "is_private": false}, {"count": 11, "text": "hmm.. strange.. so the solution is to \"disable mod_mime_magic\"? as in, this isnt a \"bug\" its a \"feature\"?", "bug_id": 55641, "attachment_id": null, "id": 170917, "time": "2013-10-29T19:48:20Z", "creator": "apachebugs@insaner.com", "creation_time": "2013-10-29T19:48:20Z", "tags": [], "is_private": false}, {"count": 12, "text": "You can configure a mime type for static resources to avoid mod_mime_magic having to guess from the content (which is expensive and may be surprising).", "creator": "trawick@apache.org", "attachment_id": null, "id": 170918, "time": "2013-10-29T19:53:46Z", "bug_id": 55641, "creation_time": "2013-10-29T19:53:46Z", "tags": [], "is_private": false}, {"count": 13, "tags": [], "bug_id": 55641, "attachment_id": null, "id": 170920, "time": "2013-10-29T20:17:21Z", "creator": "mike.rumph@oracle.com", "creation_time": "2013-10-29T20:17:21Z", "is_private": false, "text": "Here is one more point that I forgot to mention.\n\nIf you add the following line to your .htaccess file,\nall of your examples will be treated as HTML:\n\nAddType text/html .parsed\n\nThanks,\n\nMike Rumph"}, {"count": 14, "tags": [], "bug_id": 55641, "attachment_id": null, "is_private": false, "id": 170921, "time": "2013-10-29T20:40:25Z", "creator": "apachebugs@insaner.com", "creation_time": "2013-10-29T20:40:25Z", "text": "\n> If you add the following line to your .htaccess file,\n> all of your examples will be treated as HTML:\n> \n> AddType text/html .parsed\n\n\nahh, thats good to know.. thanks for that\n\nJeff, is that what you meant in your comment?"}, {"count": 15, "tags": [], "bug_id": 55641, "attachment_id": null, "is_private": false, "id": 170922, "time": "2013-10-29T20:42:14Z", "creator": "trawick@apache.org", "creation_time": "2013-10-29T20:42:14Z", "text": ">Jeff, is that what you meant in your comment?\nyes"}, {"count": 16, "tags": [], "creator": "mike.rumph@oracle.com", "attachment_id": null, "is_private": false, "id": 170932, "time": "2013-10-30T14:29:11Z", "bug_id": 55641, "creation_time": "2013-10-30T14:29:11Z", "text": "Hello insaner,\n\nSince the problem has been identified and the code appears to be working as designed and an alternate approach has been recommended, I've set the status to resolved without code change.\n\nPlease, feel free to reopen.\n\nThanks,\n\nMike Rumph"}]