[{"attachment_id": 24842, "tags": [], "creator": "anh.n.phung@gmail.com", "text": "Created attachment 24842\nxlsx that generate the error\n\nCaused by: java.lang.RuntimeException: Not implemented yet\n\tat org.apache.poi.xssf.usermodel.XSSFEvaluationWorkbook.getNameXPtg(XSSFEvaluationWorkbook.java:93)\n\tat org.apache.poi.ss.formula.FormulaParser.function(FormulaParser.java:930)\n\tat org.apache.poi.ss.formula.FormulaParser.parseNonRange(FormulaParser.java:570)\n\tat org.apache.poi.ss.formula.FormulaParser.parseRangeable(FormulaParser.java:442)\n\tat org.apache.poi.ss.formula.FormulaParser.parseRangeExpression(FormulaParser.java:285)\n\tat org.apache.poi.ss.formula.FormulaParser.parseSimpleFactor(FormulaParser.java:1131)\n\tat org.apache.poi.ss.formula.FormulaParser.percentFactor(FormulaParser.java:1091)\n\tat org.apache.poi.ss.formula.FormulaParser.powerFactor(FormulaParser.java:1078)\n\tat org.apache.poi.ss.formula.FormulaParser.Term(FormulaParser.java:1400)\n\tat org.apache.poi.ss.formula.FormulaParser.additiveExpression(FormulaParser.java:1500)\n\tat org.apache.poi.ss.formula.FormulaParser.concatExpression(FormulaParser.java:1484)\n\tat org.apache.poi.ss.formula.FormulaParser.comparisonExpression(FormulaParser.java:1441)\n\tat org.apache.poi.ss.formula.FormulaParser.Arguments(FormulaParser.java:1063)\n\tat org.apache.poi.ss.formula.FormulaParser.function(FormulaParser.java:948)\n\tat org.apache.poi.ss.formula.FormulaParser.parseNonRange(FormulaParser.java:570)\n\tat org.apache.poi.ss.formula.FormulaParser.parseRangeable(FormulaParser.java:530)\n\tat org.apache.poi.ss.formula.FormulaParser.parseRangeExpression(FormulaParser.java:285)\n\tat org.apache.poi.ss.formula.FormulaParser.parseSimpleFactor(FormulaParser.java:1131)\n\tat org.apache.poi.ss.formula.FormulaParser.percentFactor(FormulaParser.java:1091)\n\tat org.apache.poi.ss.formula.FormulaParser.powerFactor(FormulaParser.java:1078)\n\tat org.apache.poi.ss.formula.FormulaParser.Term(FormulaParser.java:1400)\n\tat org.apache.poi.ss.formula.FormulaParser.additiveExpression(FormulaParser.java:1500)\n\tat org.apache.poi.ss.formula.FormulaParser.concatExpression(FormulaParser.java:1484)\n\tat org.apache.poi.ss.formula.FormulaParser.comparisonExpression(FormulaParser.java:1441)\n\tat org.apache.poi.ss.formula.FormulaParser.unionExpression(FormulaParser.java:1421)\n\tat org.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:1542)\n\tat org.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:193)\n\tat org.apache.poi.xssf.usermodel.XSSFEvaluationWorkbook.getFormulaTokens(XSSFEvaluationWorkbook.java:134)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateAny(WorkbookEvaluator.java:255)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluate(WorkbookEvaluator.java:203)\n\tat org.apache.poi.xssf.usermodel.XSSFFormulaEvaluator.evaluateFormulaCellValue(XSSFFormulaEvaluator.java:252)\n\tat org.apache.poi.xssf.usermodel.XSSFFormulaEvaluator.evaluateFormulaCell(XSSFFormulaEvaluator.java:145)\n\tat org.apache.poi.xssf.usermodel.XSSFFormulaEvaluator.evaluateAllFormulaCells(XSSFFormulaEvaluator.java:242)\n\t... 12 more", "count": 0, "id": 133586, "time": "2010-01-13T12:38:53Z", "bug_id": 48539, "creation_time": "2010-01-13T12:38:53Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 48539, "is_private": false, "id": 134706, "creation_time": "2010-02-19T19:58:08Z", "time": "2010-02-19T19:58:08Z", "creator": "anh.n.phung@gmail.com", "text": "Same file produces following error in 3.6\n------\nException in thread \"Thread-5\" java.lang.NoClassDefFoundError: Could not\ninitialize class org.openxmlformats.schemas.spreadsheetml.x2006.main.CTDxfs\n        at\norg.openxmlformats.schemas.spreadsheetml.x2006.main.CTDxfs$Factory.newInstance(Unknown\nSource)\n        at org.apache.poi.xssf.model.StylesTable.writeTo(StylesTable.java:362)\n        at org.apache.poi.xssf.model.StylesTable.commit(StylesTable.java:377)\n        at\norg.apache.poi.POIXMLDocumentPart.onSave(POIXMLDocumentPart.java:177)\n        at\norg.apache.poi.POIXMLDocumentPart.onSave(POIXMLDocumentPart.java:181)\n        at org.apache.poi.POIXMLDocument.write(POIXMLDocument.java:214)", "attachment_id": null}, {"count": 2, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "When you got the class not found exception, were you using the full ooxml schemas jar, or just the poi-ooxml-schemas small one?\n\nIf the latter, please re-try with the full one. If that helps, we'll need a unit test that uses the class in question, so that the \"what should I put in the small jar\" processor knows that things use it!", "id": 134707, "time": "2010-02-19T20:41:58Z", "bug_id": 48539, "creation_time": "2010-02-19T20:41:58Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 48539, "is_private": false, "id": 134708, "creation_time": "2010-02-19T20:56:08Z", "time": "2010-02-19T20:56:08Z", "creator": "anh.n.phung@gmail.com", "text": "I used poi-ooxml-schemas-3.6-20091214.jar and the other jars downloaded with 3.6.  Switching back to using the 3.5FINAL, the class is there.\n\nI might have some time to look at this problem and others I encountered. What is the best place to start.  Most of the problems I have is related to the newer xlsx format.", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 48539, "attachment_id": null, "id": 137152, "time": "2010-05-26T11:22:07Z", "creator": "apache@gagravarr.org", "creation_time": "2010-05-26T11:22:07Z", "is_private": false, "text": "I can confirm that this problem is still present in head\n\nThe problem formula seems to be:\n  IF(B6= (ROUNDUP(B6,0) + ROUNDDOWN(B6,0))/2, MROUND(B6,2),ROUND(B6,0))\n\nI have added a disabled unit test to TestXSSFBugs for this, which can be enabled once the bug is fixed\n\nJosh - probably one for you though, as it seems to be quite deep in the bowels of the XSSF Formula Evaluator that it's failing"}, {"count": 5, "tags": [], "bug_id": 48539, "text": "POI prior to 3.8-alpha did not support evaluation of functions from the Excel Analysis Toolpack (ATP). The ATP functions are now supported and evaluation of the entire workbook completes with two errors:\n\nNot Implemented: MROUND \nNot Implemented: VAR\n\n\nYegor", "id": 142576, "time": "2010-12-10T11:43:22Z", "creator": "yegor@dinom.ru", "creation_time": "2010-12-10T11:43:22Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 48539, "is_private": false, "text": "MROUND and VAR were added in r1044642. Now the attached workbook evaluates OK.\n\nTry the latest build from trunk. Daily builds can be downloaded form here:\nhttp://encore.torchbox.com/poi-cvs-build/\n\n\nYegor", "id": 142588, "time": "2010-12-11T07:43:05Z", "creator": "yegor@dinom.ru", "creation_time": "2010-12-11T07:43:05Z", "attachment_id": null}]