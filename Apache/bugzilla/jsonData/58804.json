[{"count": 0, "tags": [], "bug_id": 58804, "text": "Created attachment 33405\nInput file with 12 test pictures\n\nIf a document contains a number of images with \"Layout\" options different from \"Inline with text\", they are missing from the output document.\n\nAttached is a document with 12 sample images with different layouts :\n- First row has 3 images \"Inline with text\". They are kept after save\n- Second and third row have images with different text alignments Square, Tight, Through, Top/Bottom, Behind and In front of text. These are lost after save.\n- Fourth row has the same images as first row. They are kept after save.\n\nThe Java code to reproduce the error only needs to open the file and save it, without modifications :\n        HWPFDocument doc = new HWPFDocument(new FileInputStream(inFile));\n        FileOutputStream fos = new FileOutputStream(outFile);\n        doc.write(fos);\n        fos.close();", "id": 187391, "time": "2016-01-05T09:04:36Z", "creator": "thomas.schwery@gmail.com", "creation_time": "2016-01-05T09:04:36Z", "is_private": false, "attachment_id": 33405}, {"count": 1, "tags": [], "text": "Created attachment 33406\nInput file with a single picture\n\nThe image is also lost if it is alone in the document.", "attachment_id": 33406, "id": 187392, "creator": "thomas.schwery@gmail.com", "time": "2016-01-05T09:06:31Z", "bug_id": 58804, "creation_time": "2016-01-05T09:06:31Z", "is_private": false}, {"count": 2, "tags": [], "text": "The following testcase illustrates the problem :\n\n    public void testImageCountLayout() throws Exception {\n        HWPFDocument docA = HWPFTestDataSamples.openSampleFile(\"Bug58804-picture_single.doc\");\n\n        ByteArrayOutputStream out = new ByteArrayOutputStream();\n        docA.write(out);\n        out.close();\n\n        HWPFDocument docB = new HWPFDocument(new ByteArrayInputStream(out.toByteArray()));\n\n        assertNotNull(docA.getPicturesTable());\n        assertNotNull(docB.getPicturesTable());\n\n        PicturesTable picA = docA.getPicturesTable();\n        PicturesTable picB = docB.getPicturesTable();\n\n        List<Picture> picturesA = picA.getAllPictures();\n        List<Picture> picturesB = picB.getAllPictures();\n\n        assertEquals(1, picturesA.size());\n        assertEquals(1, picturesB.size());\n    }\n\nIn this case, the test fails because picturesB is empty where it should be 1.", "attachment_id": null, "bug_id": 58804, "id": 187825, "time": "2016-01-19T15:15:52Z", "creator": "thomas.schwery@gmail.com", "creation_time": "2016-01-19T15:15:52Z", "is_private": false}, {"count": 3, "text": "I tried to take a look, but could not dig deep enough here, there is however now an ignored unit test in TestPictures as of r1726681 which reproduces this problem.", "creator": "dominik.stadler@gmx.at", "is_private": false, "id": 187959, "time": "2016-01-25T20:21:56Z", "bug_id": 58804, "creation_time": "2016-01-25T20:21:56Z", "tags": [], "attachment_id": null}]