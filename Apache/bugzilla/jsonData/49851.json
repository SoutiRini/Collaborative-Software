[{"count": 0, "tags": [], "bug_id": 49851, "attachment_id": null, "id": 139580, "time": "2010-08-31T13:18:32Z", "creator": "vadim.tsing@snapon.com", "creation_time": "2010-08-31T13:18:32Z", "is_private": false, "text": "The issue was discovered in version 1.1.20 of Tomcat Native libraries while trying to use Registry class on Windows XP.\nUnlike other methods, deleteKey() and deleteValue() do not initialize parameters that are passed to Windows APIs.\nTypical initialization of string parameters consists of \n\nTCN_ALLOC_WSTRING(name);\n...\nTCN_INIT_WSTRING(name);\n...\nTCN_FREE_WSTRING(name);\n\nHowever, the two methods listed above do not call TCN_INIT_WSTRING. Without this, the Windows API SHDeleteKeyW() is called with a null (0) parameter that causes Windows registry corruption. In my case (before issue was diagnosed) it resulted in the need to re-install Windows (twice) :-(."}]