[{"count": 0, "tags": [], "creator": "frolovskij@gmail.com", "attachment_id": null, "text": "When inserting two consecutive character runs with different properties (the first one is bold and the second is not) it results in them having the same properties (both are normal).\n\nI've tried the following code with poi 3.8-20120326 and 3.9-beta1-20120628.\n\nThe expected results is \"<b>[Bold]</b>[Normal]\", but the actual result is \"[Bold][Normal]\".\n\nimport org.apache.poi.hwpf.HWPFDocument;\nimport org.apache.poi.hwpf.usermodel.*;\nimport java.io.*;\n\npublic class Main {\n    public static void main(String[] args) throws IOException {\n        final HWPFDocument doc = new HWPFDocument(new FileInputStream(\"empty.dot\"));\n\n        final Range range = doc.getRange();\n        final CharacterRun cr1 = range.insertAfter(\"[Bold]\");\n        cr1.setBold(true);\n\n        final CharacterRun cr2 = cr1.insertAfter(\"[Normal]\");\n        cr2.setBold(false);\n\n        doc.write(new FileOutputStream(\"output.doc\"));\n    }\n}", "id": 160558, "time": "2012-07-10T10:34:07Z", "bug_id": 53528, "creation_time": "2012-07-10T10:34:07Z", "is_private": false}, {"count": 1, "tags": [], "creator": "stroghov@gmail.com", "attachment_id": null, "is_private": false, "id": 181780, "time": "2015-03-15T14:19:57Z", "bug_id": 53528, "creation_time": "2015-03-15T14:19:57Z", "text": "Confirm the issue still exists in:\n\n    <dependency>\n      <groupId>org.apache.poi</groupId>\n      <artifactId>poi-scratchpad</artifactId>\n      <version>3.11</version>\n    </dependency>\n\nHave changed the example to see what each CharacterRun is:\n\nimport org.apache.poi.hwpf.HWPFDocument;\nimport org.apache.poi.hwpf.usermodel.*;\nimport java.io.*;\n\npublic class WordWriter {\n    public static void main(String[] args) throws IOException {\n        final HWPFDocument doc = new HWPFDocument(new FileInputStream(\"empty.dot\"));\n\n        final Range range = doc.getRange();\n        \n        final CharacterRun cr1 = range.insertAfter(\"[Bold]\");\n        cr1.setBold(true);\n        System.out.println(cr1.text());\n\n        final CharacterRun cr2 = cr1.insertAfter(\"[Normal]\");\n        cr2.setBold(false);\n        System.out.println(cr2.text());\n\n        doc.write(new FileOutputStream(\"output.doc\"));\n    }\n}\n\nIt shows:\n[Bold]\n[Bold][Normal]\n\nIt seems insertAfter returns the resulting string. The question is how to reference the string that was just inserted.\n\nWould be pleased if anyone tells me how to insert two text fragments with different formatting in HWPF."}]