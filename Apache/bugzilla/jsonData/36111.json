[{"attachment_id": null, "tags": [], "bug_id": 36111, "is_private": false, "count": 0, "id": 78326, "time": "2005-08-10T10:12:17Z", "creator": "sven.billen@gmail.com", "creation_time": "2005-08-10T10:12:17Z", "text": "When adding custom properties to a MS Word 2000 document, the properties are not\ndisplayed within Word nor the Windows Explorer. Custom means the properties\ndisplayed on the \"Custom\" tab in the documents properties.\n\nComparing properties created with MS Word to HPFS with the\nReadCustomPropertySets demo results in some differences shown below.\n\nHPFS created properties:\n\nProperty set stream \"\\\u0005DocumentSummaryInformation\":\n(Section 0 does not differ)\n\n Section 1:\n      Format ID: 00000000 D5 CD D5 02 2E 9C 10 1B 93 97 08 00 2B 2C F9 AE\n............+,..\n\n      No. of properties: 3\n      Property ID: 0, type: 0, value: {2=info}\n      Property ID: 1, type: 2, value: 1252\n      Property ID: 2, type: 30, value: Hello World\n\n\nMS Word created properties:\n\nProperty set stream \"\\\u0005DocumentSummaryInformation\":\n\n   Section 1:\n      Format ID: 00000000 D5 CD D5 05 2E 9C 10 1B 93 97 08 00 2B 2C F9 AE\n............+,..\n\n      No. of properties: 4\n      Property ID: 0, type: 0, value: {2=info}\n      Property ID: 1, type: 2, value: 65001\n      Property ID: -2147483648, type: 19, value: [B@b6ece5\n      Property ID: 2, type: 30, value: Hello World\n\nThis only occurs if the document has never had any custom properties before.\n\nSample documents can be found under\n\nhttp://www.mathematik.uni-marburg.de/~billen/hpfsSample.zip\n\nFor more information see the thread \"Problem adding custom information to\ndocuments\" on the POI users mailinglist."}, {"count": 1, "tags": [], "creator": "daniel.andefors@technia.com", "attachment_id": null, "is_private": false, "id": 78366, "time": "2005-08-10T17:41:17Z", "bug_id": 36111, "creation_time": "2005-08-10T17:41:17Z", "text": "The Format ID of the second section is wrong."}, {"attachment_id": null, "tags": [], "bug_id": 36111, "is_private": false, "count": 2, "id": 78440, "time": "2005-08-12T09:23:50Z", "creator": "sven.billen@gmail.com", "creation_time": "2005-08-12T09:23:50Z", "text": "(In reply to comment #1)\n> The Format ID of the second section is wrong.\n\nThis ID is created by MS Word. Therefore it should not be wrong.\nWhat would be the right ID for that section?"}, {"count": 3, "tags": [], "text": "What I meant was that the Format ID of the second section within the\nDocumentSummaryInformation property set stream in the file edited with HPSF is\nwrong. I'm not sure exactly how you are using the HPSF API but if you can fix\nyour code to use the correct Format ID for this section I'm sure your trouble\nwill go away.", "attachment_id": null, "bug_id": 36111, "id": 78444, "time": "2005-08-12T14:13:24Z", "creator": "daniel.andefors@technia.com", "creation_time": "2005-08-12T14:13:24Z", "is_private": false}, {"count": 4, "tags": [], "creator": "sven.billen@gmail.com", "attachment_id": null, "is_private": false, "id": 78492, "time": "2005-08-15T09:39:30Z", "bug_id": 36111, "creation_time": "2005-08-15T09:39:30Z", "text": "hmm ... I've set the ID to SectionIDMap.DOCUMENT_SUMMARY_INFORMATION_ID. I just\ntook a look at the source of org.apache.poi.hpsf.wellknown.SectionIDMap and saw\nthat DOCUMENT_SUMMARY_INFORMATION_ID has the wrong value. I changed\nDOCUMENT_SUMMARY_INFORMATION_ID[3] to 0x05 and everything worked fine.\nThanks for that hint.\n"}, {"count": 5, "tags": [], "text": "I added the format ID of the second DocumentSummaryInformation stream to\norg.apache.poi.hpsf.wellknown.SectionIDMap in a way that\nDOCUMENT_SUMMARY_INFORMATION_ID is no longer a byte[] but a byte[][] instead\nwith DOCUMENT_SUMMARY_INFORMATION_ID[0] being the format ID of the first section\nand DOCUMENT_SUMMARY_INFORMATION_ID[1] being the format ID of the second section.\n\nBeware that this is an incompatible change and will break applications that use\nDOCUMENT_SUMMARY_INFORMATION_ID. All uses of DOCUMENT_SUMMARY_INFORMATION_ID\nmust be replaced my DOCUMENT_SUMMARY_INFORMATION_ID[0].\n\nHowever, I won't submit this change not right now but together with some more\nchanges I have on my schedule.", "is_private": false, "id": 85397, "creator": "klute@apache.org", "time": "2006-02-04T00:03:06Z", "bug_id": 36111, "creation_time": "2006-02-04T00:03:06Z", "attachment_id": null}]