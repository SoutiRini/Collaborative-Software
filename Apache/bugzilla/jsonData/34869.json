[{"count": 0, "tags": [], "bug_id": 34869, "attachment_id": null, "text": "I am running Apache 2.0.46 under RHEL3 with the latest up2date patches.\n\nIntermittently, I will have problems with files and directories created by\napache from both PHP and mod_perl applications (our custom apps, and RT in\nparticular) where the directories and/or files will wind up with (typically)\nzero modes (0000).  The applications in question seem to be doing the right\nthing in setting explicit modes on files/dirs that are created, and normal\nexhibit expected behaviour.  But intermittently this problem will recur without\nany other accompanying events.  It also seems to clear up on its own without my\nintervention, although I have to chmod files that have already been created.\n\nA developer I'm working with who is developing under a fairly different\nenvironment (OSX, PHP5, Apache 2.0.52) who experiences the same problem with PHP\nsession files in /tmp winding up, again intermittently, with 0000 modes.\n\nSo the commonality here seems to be Apache 2.  I haven't been able to to\ncorrelate this with any other log events.  \n\nI am going to create a simple PHP program that will create files and dirs\nthrough apache and have it run itself regularly via cron and see what happens in\nterms of the modes.", "id": 74727, "time": "2005-05-11T18:05:45Z", "creator": "bws@briansp.com", "creation_time": "2005-05-11T18:05:45Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 34869, "is_private": false, "text": "SELinux is not enabled on my system.", "id": 74730, "time": "2005-05-11T18:14:41Z", "creator": "bws@briansp.com", "creation_time": "2005-05-11T18:14:41Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "jorton@redhat.com", "text": "You should report this to bugzilla.redhat.com since you're using vendor-patched\npackages.\n\nBut it sounds a lot like some module or script is setting the umask badly.   I\ndoubt there is a bug in httpd itself here.  This needs to be narrowed down to a\nspecific issue with a specific module, first.", "id": 74777, "time": "2005-05-12T09:00:33Z", "bug_id": 34869, "creation_time": "2005-05-12T09:00:33Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "bws@briansp.com", "attachment_id": 15020, "text": "Created attachment 15020\nPHP Test Script that exercises this issue\n\nThis is the test script that I wrote that exercises the problem over time.", "id": 74844, "time": "2005-05-13T15:13:13Z", "bug_id": 34869, "creation_time": "2005-05-13T15:13:13Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 34869, "attachment_id": null, "is_private": false, "id": 74845, "time": "2005-05-13T15:15:22Z", "creator": "bws@briansp.com", "creation_time": "2005-05-13T15:15:22Z", "text": "So this script should produce the same results every time you would think, right?\n\nIt doesn't.  Looking at the permissions of the files in creates in\n/tmp/apachetest I see:\n\n474524    4 -rw-r--r--   1 apache   apache         30 May 13 04:31\n./20050513/043150.test\n474525    4 -rw-r--r--   1 apache   apache         30 May 13 04:46\n./20050513/044650.test\n474526    4 -rw-r--r--   1 apache   apache         30 May 13 05:01\n./20050513/050150.test\n474527    4 ----------   1 apache   apache         30 May 13 05:16\n./20050513/051651.test\n474528    4 ----------   1 apache   apache         30 May 13 05:30\n./20050513/053000.test\n474529    4 -rw-r--r--   1 apache   apache         30 May 13 05:31\n./20050513/053150.test\n474530    4 -rw-r--r--   1 apache   apache         30 May 13 05:46\n./20050513/054651.test\n474531    4 -rw-r--r--   1 apache   apache         30 May 13 06:01\n./20050513/060150.test\n474532    4 ----------   1 apache   apache         30 May 13 06:16\n./20050513/061651.test\n474533    4 ----------   1 apache   apache         30 May 13 06:29\n./20050513/062959.test\n474534    4 -rw-r--r--   1 apache   apache         30 May 13 06:31\n./20050513/063150.test\n\nSome files have mode 0644, some have 0000.\n\nI will report this to the Redhat folks.  I didn't realize that the Apache2\ndistribution in that release was considered nonstandard.\n\nBut I can't see how this can be blamed on my application code, since I can\nexercise the failure mode in a very simple test program."}, {"count": 5, "tags": [], "creator": "bws@briansp.com", "attachment_id": null, "id": 74847, "time": "2005-05-13T15:34:20Z", "bug_id": 34869, "creation_time": "2005-05-13T15:34:20Z", "is_private": false, "text": "(In reply to comment #4)\n \n> I will report this to the Redhat folks.  I didn't realize that the Apache2\n> distribution in that release was considered nonstandard.\n\nReported as bug 157648 at bugzilla.redhat.com.\nhttps://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=157648"}]