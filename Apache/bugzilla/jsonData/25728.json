[{"count": 0, "tags": [], "bug_id": 25728, "attachment_id": null, "text": "I have a question concerning the \"apachectl graceful\" command.\n\nEvery time the gracefull command is issued via command line, I get a Virtual\nMemory footprint of 1448 K more than the last time for the parent httpd process.\n\nIs there some sort of memory leak in the built apache? I did not see this\nbehaviour in 1.3.27.\n\nI'm having a hard time narrowing down what seems to be two separate bugs (one in\napache and one in php).\n\nThis apache error and a php file descriptor error.\n\nAfter about 3 days I start seeing php pages with the error:\nfailed to open stream: too many open files in Unknown on line 0\n\nAnd in the error logs:\nToo many open files: file permissions deny server access\n\nI think something is eating in to the file descriptor limit for an open process\nby not closing file handles (probably php) but not sure if it is compounded by this.\n\nCan anyone else reproduce this? I tried on another xserve we have that never ran\napache and it does the same thing.\n\nI'm running apache 1.3.28 on an xserve OS 10.3.1. XSERVE Dual 1 GHz G4; Mac OS X\n(10.3.x); 1GB DDR SDRAM\n\nI am also including the ps output before and after an apachectl graceful. Is\nthere some other info I should supply that can help?\n\nThanks. \n\nRay A. \n\n\n-----------------------\n[xserve01:/Users/admin] admin# ps aux | grep http\nroot   3784   0.3  0.4    42700   4220  ??  Ss    8:59AM   0:00.17 /usr/sbin/httpd\nwww    3789   0.0  0.0    42700    324  ??  S     9:00AM   0:00.00 /usr/sbin/httpd\nroot   3791   0.0  0.0    18172    344 std  S+    9:00AM   0:00.00 grep http\n[xserve01:/Users/admin] admin# apachectl graceful\n/usr/sbin/apachectl graceful: httpd gracefully restarted\n[xserve01:/Users/admin] admin# ps aux | grep http\nroot   3784   0.0  0.5    44148   5612  ??  Ss    8:59AM   0:00.40 /usr/sbin/httpd\nwww    3800   0.0  0.0    44148    320  ??  S     9:00AM   0:00.01 /usr/sbin/httpd\nwww    3801   0.0  0.0    44148    320  ??  S     9:00AM   0:00.00 /usr/sbin/httpd\nroot   3803   0.0  0.0    18172    348 std  S+    9:00AM   0:00.01 grep http\n[xserve01:/Users/admin] admin# apachectl graceful\n/usr/sbin/apachectl graceful: httpd gracefully restarted\n[xserve01:/Users/admin] admin# ps aux | grep http\nroot   3784   0.0  0.7    45596   7012  ??  Ss    8:59AM   0:00.62 /usr/sbin/httpd\nwww    3811   0.0  0.0    45596    316  ??  S     9:00AM   0:00.00 /usr/sbin/httpd\nwww    3812   0.0  0.0    45596    320  ??  S     9:00AM   0:00.00 /usr/sbin/httpd\nroot   3814   0.0  0.0     8860    172 std  R+    9:00AM   0:00.00 grep http\n[xserve01:/Users/admin] admin#", "id": 49609, "time": "2003-12-23T15:02:59Z", "creator": "aspeitia@sells.com", "creation_time": "2003-12-23T15:02:59Z", "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 25728, "text": "I also encountered this problem. Apache with php and many modules. However I\nthink it's bug of ona of PHP modules. I will check for it later.\nTha leak also shows up on restart SIGHUP (not just graceful restart by SIGUSR1)", "id": 54494, "time": "2004-03-23T17:25:42Z", "creator": "uhlar@fantomas.sk", "creation_time": "2004-03-23T17:25:42Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 25728, "attachment_id": null, "id": 54502, "time": "2004-03-23T20:30:52Z", "creator": "aspeitia@sells.com", "creation_time": "2004-03-23T20:30:52Z", "is_private": false, "text": "Is there something else I can try, besides making test cases for each built\nmodule in php.\n\nI'm not very good at tracking memory leaks, but if you know of some utility I\ncan run against apache I could try.\n\nThanks for the sanity check.\n\nRay A."}]