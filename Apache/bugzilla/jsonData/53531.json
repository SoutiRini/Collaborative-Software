[{"count": 0, "tags": [], "creator": "chris@christopherschultz.net", "is_private": false, "text": "http://markmail.org/message/fvyxksx7muk3icr4\n\no.a.c.startup.ExpandWar.expand() calls File.mkdirs on line 165 and does not check the return value. If the call fails, a subsequent attempt to create a new FileOutputStream for a file in the (failed-to-create) directory results in a FileNotFoundException with the whole filename as the message. Here is an example from the above tomcat-user original post:\n\nSEVERE: Exception fixing docBase: {0}\n    java.io.FileNotFoundException:\n/home/surgnet/public_html/sample/META-INF/MANIFEST.MF (No such file or\ndirectory)\n            at java.io.FileOutputStream.open(Native Method)\n            at java.io.FileOutputStream.<init>(FileOutputStream.java:194)\n            at java.io.FileOutputStream.<init>(FileOutputStream.java:145)\n            at org.apache.catalina.startup.ExpandWar.expand(ExpandWar.java:457)\n            at org.apache.catalina.startup.ExpandWar.expand(ExpandWar.java:173)\n\nThis is confusing to users because the real issue has been hidden: the inability to create the parent directory for the file.\n\nThe analogous code in the current trunk is:\n\n                    if (!parent.mkdirs() && !parent.isDirectory()) {\n                        throw new IOException(\n                                sm.getString(\"expandWar.createFailed\", parent));\n                    }\n\nI believe this is the correct approach, which should be adopted for Tomcat 5.5.", "id": 160575, "time": "2012-07-11T01:42:02Z", "bug_id": 53531, "creation_time": "2012-07-11T01:42:02Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "Created attachment 29045\nPatch against current 5.5.x trunk (r1359975)", "attachment_id": 29045, "bug_id": 53531, "id": 160576, "time": "2012-07-11T01:49:12Z", "creator": "chris@christopherschultz.net", "creation_time": "2012-07-11T01:49:12Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 53531, "text": "This bug exists in Tomcat 6.0.x, so I'm re-assigning since it's a bit more relevant. The fix can be thought of as a back-port, then, I guess.", "id": 160578, "time": "2012-07-11T02:01:52Z", "creator": "chris@christopherschultz.net", "creation_time": "2012-07-11T02:01:52Z", "is_private": false, "attachment_id": null}, {"count": 3, "attachment_id": 29050, "bug_id": 53531, "text": "Created attachment 29050\nPatch for 6.0.x against r1359053", "id": 160593, "time": "2012-07-11T19:36:07Z", "creator": "chris@christopherschultz.net", "creation_time": "2012-07-11T19:36:07Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 53531, "text": "Comment on attachment 29045\nPatch against current 5.5.x trunk (r1359975)\n\nPatch is obsolete: patch proposed for 6.0.x.", "id": 160594, "time": "2012-07-11T19:41:17Z", "creator": "chris@christopherschultz.net", "creation_time": "2012-07-11T19:41:17Z", "is_private": false, "attachment_id": 29045}, {"count": 5, "attachment_id": null, "bug_id": 53531, "text": "Fixed in 6.0.x. Will be included in 6.0.36.", "id": 161200, "time": "2012-08-09T18:18:07Z", "creator": "chris@christopherschultz.net", "creation_time": "2012-08-09T18:18:07Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "creator": "knst.kolinko@gmail.com", "attachment_id": 29212, "is_private": false, "id": 161270, "time": "2012-08-11T19:18:03Z", "bug_id": 53531, "creation_time": "2012-08-11T19:18:03Z", "text": "Created attachment 29212\n2012-08-11_tc55_53531.patch\n\nPatch for Tomcat 5.5.\n\nIncludes a fix for missing message argument in ContextConfig.init(). That is where the thrown IOException is caught and logged."}, {"count": 7, "tags": [], "bug_id": 53531, "text": "Fixed in 5.5.x and will be included in 5.5.36 onwards.", "id": 162483, "time": "2012-10-01T08:25:05Z", "creator": "markt@apache.org", "creation_time": "2012-10-01T08:25:05Z", "is_private": false, "attachment_id": null}]