[{"count": 0, "tags": [], "bug_id": 53997, "text": "When LDAP sampler includes an AND (&) operator in the LDAP filter, this filter value is echoed in the XML response data. \n\nThe ampersand character is not escaped in the xml. \n\nIn the XML the filter will appear in its original form:\n(&(sn=smith)(givenName=dave))\n\nThen, attempts to process the response data as XML (XPath assertions, extractors, etc) fail to parse the XML and generate errors. \n\nAs a workaround, I use a jruby postprocessor:\nres = $prev.getResponseDataAsString()\nres.gsub!(\"&\",\"&amp;\")#the ampersand breaks the xml so encode it\n$prev.setResponseData(res,\"utf-8\")\n\nPre Correction\n<searchfilter>(&(objectclass=x-commonProfile)(sn=Millerp)(givenName=Markp)(x-emailAddress1=26e7b5b3@yopmail.com))</searchfilter>\n\nPost Correction\n<searchfilter>(&amp;(objectclass=x-commonProfile)(sn=Millerp)(givenName=Markp)(x-emailAddress1=26e7b5b3@yopmail.com))</searchfilter>\n\nOnce corrected, other XML based operations are successful. \n\nConsidering that the character is valid and predictable in the LDAP context, I consider this a bug (even though the workaround is fairly trivial).", "id": 162720, "time": "2012-10-12T17:06:55Z", "creator": "mark.o.miller@gmail.com", "creation_time": "2012-10-12T17:06:55Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 53997, "text": "Thanks for report.\nFixed in trunk.\n\n\nURL: http://svn.apache.org/viewvc?rev=1397875&view=rev\nLog:\nLDAP Extended Request: Escape ampersand (&), left angle bracket (<) and right angle bracket (>) in search filter tag in XML response data\nBugzilla Id: 53997\n\nModified:\n    jmeter/trunk/src/protocol/ldap/org/apache/jmeter/protocol/ldap/sampler/LDAPExtSampler.java\n    jmeter/trunk/xdocs/changes.xml", "id": 162727, "time": "2012-10-13T16:12:37Z", "creator": "milamber@apache.org", "creation_time": "2012-10-13T16:12:37Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 53997, "attachment_id": null, "id": 162728, "time": "2012-10-13T16:13:30Z", "creator": "milamber@apache.org", "creation_time": "2012-10-13T16:13:30Z", "is_private": false, "text": "\n\nFor reference:\nhttp://www.w3.org/TR/2000/REC-xml-20001006#syntax"}, {"count": 3, "tags": [], "bug_id": 53997, "text": "Thanks Philippe!\n\nURL: http://svn.apache.org/viewvc?rev=1397905&view=rev\nLog:\nBetter way\nLDAP Extended Request: Escape ampersand (&), left angle bracket (<) and right angle bracket (>) in search filter tag in XML response data\nBugzilla Id: 53997\n\nModified:\n    jmeter/trunk/src/protocol/ldap/org/apache/jmeter/protocol/ldap/sampler/LDAPExtSampler.java", "id": 162729, "time": "2012-10-13T17:23:34Z", "creator": "milamber@apache.org", "creation_time": "2012-10-13T17:23:34Z", "is_private": false, "attachment_id": null}]