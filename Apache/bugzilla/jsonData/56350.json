[{"count": 0, "tags": [], "text": "Created attachment 31477\nthe template word Document used in program.\n\nI am trying to execute the code below\n\nvar doc = new XWPFDocument(OPCPackage.open((\"D:\\\\template.docx\")));\n\nfor ( p in doc.getParagraphs()) {\n  for ( r in p.getRuns()) {\n    var text = r.toString();\n    print(text)\n    if (text.contains(\"$ClaimNumber\")) {\n      text = text.replace(\"$ClaimNumber\", claimRes.ClaimNumber);\n      r.setText(text,0);\n    }\n   if (text.contains(\"$NoOfExposures\")) {\n      text = text.replace(\"$NoOfExposures\", claimRes.Exposures.length);\n      r.setText(text,0);\n    }\n  }\n}\n\ntry {\n  outStream = new FileOutputStream(\"D:\\\\templateoutput.docx\");\n} catch (e : FileNotFoundException ) {\n  e.printStackTrace();\n}\n\ntry {\n  doc.write(outStream);\n  print(\"File updated successfully\")\n  outStream.close();\n} catch (e : FileNotFoundException ) {\n  e.printStackTrace();\n} catch (e :IOException ) {\n  e.printStackTrace();\n}\n\nThe output is \n\nThe Claim Number is $\nClaimNumber\nThere are $\nNoOfExposures\n Exposures\nFile updated successfully\n\nIt can be clearly seen that the problem is with the XWPFRun which is reading it in a way that is not expected. I am trying to replace $ClaimNumber with the actual Claim Number.\nSince the Run is behaving in an unexpected manner the $ and the word ClaimNumber is separated in to two runs which in turn fails to be replace in the output.\nAlso if you look at the document its pretty simple and straight forward and looking at it I can see that the entire Paragraph is in the Same format.\nWhich would make me assume that the Run is also in the same format. However looking at the output it is not so. Please let me know how to resolve this.\n\nPS : \nThe above code is a Gosu Code.\nHowever its easily convertible to Java and the variable ClaimRes usages can also be replaced with any text", "is_private": false, "id": 174284, "creator": "navaneethster@gmail.com", "time": "2014-04-04T20:01:47Z", "bug_id": 56350, "creation_time": "2014-04-04T20:01:47Z", "attachment_id": 31477}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 174308, "time": "2014-04-05T16:34:11Z", "bug_id": 56350, "creation_time": "2014-04-05T16:34:11Z", "is_private": false, "text": "That's not a bug in Apache POI, that's just a quirk of how word writes the file. For some reason, Word has decided that the $ and the rest of your text have/had/may-have-had different formatting, so split them into two runs\n\nYou'll need to tweak your logic to detect and cope with the case when the search text spans several runs, then decide which run to replace in and which to delete"}]