[{"count": 0, "tags": [], "creator": "tonyg@guadagnoconsulting.com", "text": "Created attachment 30901\nvirtual host debug log\n\nhi, i was using AuthnProviderAlias in 2.2.24 without issue, when i moved up to 2.4.6, the config would not work.\n\nConfig\n\nLDAPVerifyServerCert off\nLDAPTrustedMode SSL\n<AuthnProviderAlias ldap ldapUEDC1>\n\tAuthLDAPURL \"ldaps://uedc1.company.com/DC=company,DC=com?sAMAccountName?sub?(objectClass=*)\" SSL\n\tAuthLDAPBindDN \"CN=ldap Lookup,OU=Service Accounts,OU=Ultra Users,DC=company,DC=com\"\n\tAuthLDAPBindPassword pw\n</AuthnProviderAlias>\n\n<AuthnProviderAlias ldap ldapUEDC2>\n\tAuthLDAPURL \"ldaps://uedc2.company.com/DC=company,DC=com?sAMAccountName?sub?(objectClass=*)\" SSL\n\tAuthLDAPBindDN \"CN=ldap Lookup,OU=Service Accounts,OU=Ultra Users,DC=company,DC=com\"\n\tAuthLDAPBindPassword pw\n</AuthnProviderAlias>\n\n\n<VirtualHost 172.30.0.10:443>\n\tServerAdmin ueadmin@company.com\n\tDocumentRoot \"d:\\websites\\svn\"\n\tServerName FLSoftware.company.com\n\n\tCookieTracking On\n\tCookieDomain .FLSoftware.company.com\n\tCookieExpires \"10 years\"\n\tCookieName FLSoftwareSession\n\tCookieStyle Cookie\n\n\tErrorLog d:/logs/apache/FLSoftware-Error.log\n\tCustomLog d:/logs/weblogs/FLSoftware/FLSoftware-Apache-%Y-%m-%d.log combined\n\tDirectoryIndex index.txt\n\tLDAPTrustedMode SSL\n\t<Location /svn>\n\t\tAuthBasicProvider ldapUEDC1 ldapUEDC2\n\t\tAuthtype Basic\n\t\tAuthzLDAPAuthoritative on\n\t\tAuthname \"SubVersion\"\n\t\tRequire valid-user\n\n\t\tSetOutputFilter DEFLATE\n\n\t\tDAV svn\n\t\tSVNParentPath d:/SVNRepo\n\t\tSVNPathAuthz on\n\t\tSVNIndexXSLT \"/svnindex.xml\"\n\t\tAuthzSVNAccessFile d:/SvnRepo/svn_dir_access.conf\n\n\t</Location>\n\t<Directory \"d:/websites/svn\">\n\t\tDavGenericLockDB \"D:/SVNRepo/ApacheLocks\"\n\t\tAllowOverride None\n\t\tOrder allow,deny\n\t\tAllow from all\n\t</Directory>\nSSLEngine on\nSSLCipherSuite ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL\nSSLProtocol all -SSLv2\nSSLCipherSuite HIGH:MEDIUM:!ADH:!RC4\n<FilesMatch \"\\.(cgi|shtml|phtml|php)$\">\n    SSLOptions +StdEnvVars\n</FilesMatch>\nBrowserMatch \".*MSIE.*\" \\\n         nokeepalive ssl-unclean-shutdown \\\n         downgrade-1.0 force-response-1.0\n\n</VirtualHost>\n\n\n\nerror when on 2.4.6\n[Wed Oct 02 14:54:25.160786 2013] [auth_basic:error] [pid 3288:tid 956] [client 172.30.2.149:9950] AH01618: user tonyg not found: /svn/Auracle\n\n\nsee full debug log attached", "id": 170397, "time": "2013-10-02T20:10:14Z", "bug_id": 55622, "creation_time": "2013-10-02T20:10:14Z", "is_private": false, "attachment_id": 30901}, {"count": 1, "tags": [], "bug_id": 55622, "text": "Using this feature in our Subversion Edge installation. I'm about to upgrade to the latest version, but are not able because of this bug", "id": 171217, "time": "2013-11-14T13:11:11Z", "creator": "jarle.jacobsen@gmail.com", "creation_time": "2013-11-14T13:11:11Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "geir.engebakken@edb.com", "text": "The same applies to us, we need to setup several LDAP hosts to authenticate, and we cannot upgrade to latest SVN Edge due to this bug.", "id": 171420, "time": "2013-11-23T17:27:28Z", "bug_id": 55622, "creation_time": "2013-11-23T17:27:28Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 55622, "text": "out of curiosity, does it help if you remove \"AuthZLDAPAuthoritative\" which is probably unnecessary now anyway?  I think there is a quirk that will make it cause harm (actually any directive from mod_authnz_ldap in the same context as the provider is used).\n\nIf you can confirm, I can try to fix it, although AuthZLDAPAuthoritative is not really needed there are other directives that cna get in the way.", "id": 171422, "time": "2013-11-23T18:19:52Z", "creator": "covener@gmail.com", "creation_time": "2013-11-23T18:19:52Z", "is_private": false, "attachment_id": null}, {"count": 4, "text": "We dont use AuthZLDAPAuthoritative in our config, and it doesnt work for us either.", "bug_id": 55622, "is_private": false, "id": 171436, "time": "2013-11-25T09:11:19Z", "creator": "geir.engebakken@edb.com", "creation_time": "2013-11-25T09:11:19Z", "tags": [], "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 55622, "text": "Thanks Geir, no other mod_authnz_ldap directives inside the block that has AuthBasicProvider?", "count": 5, "id": 171438, "time": "2013-11-25T12:59:11Z", "creator": "covener@gmail.com", "creation_time": "2013-11-25T12:59:11Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 55622, "text": "I got it working in my Subversion Edge installation. I copied the svn_viewvc_httpd.conf file and modified the httpd.conf file to use my version instead. In the copied version I added the following before the <Location /> element:\n\n<AuthnProviderAlias file csvn-file-users>\n  AuthUserFile \"C:\\csvn\\data/conf/svn_auth_file\"\n</AuthnProviderAlias>\n\n<AuthnProviderAlias ldap ldap-users>\n  AuthLDAPUrl \"ldaps://DomainDnsZones.eu.mycompany.com/DC=eu,DC=mycompany,DC=com?sAMAccountName?sub?(&(objectCategory=user)(|(memberOf=CN=CMS Users Local,OU=Security Groups,OU=Groups,OU=Norway,OU=TEAD,DC=eu,DC=mycompany,DC=com)(memberOf=CN=CMS Users Global,OU=Security Groups,OU=Groups,OU=Norway,OU=TEAD,DC=eu,DC=mycompany,DC=com)))\" \"SSL\"\n\n  AuthLDAPBindDN \"CN=someUser,OU=System Accounts,OU=Norway,OU=TEAD,DC=eu,DC=mycompany,DC=com\"\n  AuthLDAPBindPassword \"MyPassword\"\n\n</AuthnProviderAlias>\n\n<AuthnProviderAlias ldap ldap-users-india>\n  AuthLDAPUrl \"ldaps://apdc02.ap.mycompany.com/DC=ap,DC=mycompany,DC=com?sAMAccountName?sub?(&(objectCategory=user)(memberOf=CN=SG IZZ IFZ CMS Users Global,OU=Security Groups,OU=Groups,OU=India,OU=TEAD,DC=ap,DC=mycompany,DC=com))\" \"SSL\"\n\n  AuthLDAPBindDN \"CN=someUser,OU=System Accounts,OU=Norway,OU=TEAD,DC=eu,DC=mycompany,DC=com\"\n  AuthLDAPBindPassword \"MyPassword\"\n\n</AuthnProviderAlias>\n\n\n\nThe Location element for root is modified to look like this:\n\n# Apache will issue sub_req for PATH_INFO on ScriptAlias which\n# gives a spurious error message. Setting auth at root level to avoid clogging logs.\n<Location />\n  AuthType Basic\n  AuthName \"CollabNet Subversion Repository\"\n  AuthBasicProvider csvn-file-users ldap-users ldap-users-india\n  LDAPReferrals Off\n\n  Require valid-user\n</Location>\n\n\nI'm using Subversion Edge 4.0.3 with Apache Http Server 2.4.6. I already had the server configured for LDAP and File auth so the required modules was already included in the conf files.", "count": 6, "id": 171446, "time": "2013-11-26T09:47:55Z", "creator": "jarle.jacobsen@gmail.com", "creation_time": "2013-11-26T09:47:55Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 55622, "is_private": false, "text": "I observe the same problem with Apache 2.4.6-3 (Debian sid). Actually documentation (http://httpd.apache.org/docs/2.4/mod/mod_authn_core.html) says that this functionality should be provided by mod_authn_core.\n\nConfiguration test passes OK, but AuthnProviderAlias has no effect: LDAP module is not activated, no requests are sent to server, Apache logs \"AH01618: user NNN not found\".", "id": 171753, "time": "2013-12-15T14:16:16Z", "creator": "dma_k@mail.ru", "creation_time": "2013-12-15T14:16:16Z", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 55622, "text": "This configuration works for me when a user only belongs in one of ldap1 or ldap2:\n\n<AuthnProviderAlias ldap ldap1>\nAuthLDAPUrl ldap://bluepages.ibm.com/ou=bluepages,o=ibm.com?mail?sub?\n</AuthnProviderAlias>\n\n<AuthnProviderAlias ldap ldap2>\nAuthLDAPURL ldap://goku.raleigh.ibm.com/o=apache,c=US?cn?sub?\n</AuthnProviderAlias>\n\n<Location />\nAuthType basic\nAuthName whatever\nAuthBasicProvider ldap1 ldap2\nrequire valid-user\n</location>", "id": 171754, "time": "2013-12-15T15:30:31Z", "creator": "covener@gmail.com", "creation_time": "2013-12-15T15:30:31Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "creator": "geir.engebakken@evry.com", "attachment_id": null, "is_private": false, "id": 171790, "time": "2013-12-17T13:58:59Z", "bug_id": 55622, "creation_time": "2013-12-17T13:58:59Z", "text": "Our users are defined in both ADs, but disabled in one of them, so we need to use a filter. It worked before in 2.2, but cannot get it to work in Apache 2.4.6\n\n<AuthnProviderAlias ldap ldap-users>\n  AuthLDAPUrl \"ldap://*******:3268/DC=***,DC=***?sAMAccountName?sub?(!(userAccountControl:1.2.840.113556.1.4.803:=2))\"\n  AuthLDAPBindDN \"************************\"\n  AuthLDAPBindPassword \"**********\"\n</AuthnProviderAlias>\n\n<AuthnProviderAlias ldap ldap-corp1>\n  AuthLDAPUrl \"ldap://*********:3268/?sAMAccountName?sub?(!(userAccountControl:1.2.840.113556.1.4.803:=2))\"\n  AuthLDAPBindDN \"************************\"\n  AuthLDAPBindPassword \"**********\"\n</AuthnProviderAlias>"}, {"count": 10, "tags": [], "bug_id": 55622, "text": "(In reply to Geir Engebakken from comment #9)\n> Our users are defined in both ADs, but disabled in one of them, so we need\n> to use a filter. It worked before in 2.2, but cannot get it to work in\n> Apache 2.4.6\n> \n> <AuthnProviderAlias ldap ldap-users>\n>   AuthLDAPUrl\n> \"ldap://*******:3268/DC=***,DC=***?sAMAccountName?sub?(!(userAccountControl:\n> 1.2.840.113556.1.4.803:=2))\"\n>   AuthLDAPBindDN \"************************\"\n>   AuthLDAPBindPassword \"**********\"\n> </AuthnProviderAlias>\n> \n> <AuthnProviderAlias ldap ldap-corp1>\n>   AuthLDAPUrl\n> \"ldap://*********:3268/?sAMAccountName?sub?(!(userAccountControl:1.2.840.\n> 113556.1.4.803:=2))\"\n>   AuthLDAPBindDN \"************************\"\n>   AuthLDAPBindPassword \"**********\"\n> </AuthnProviderAlias>\n\nCan you generate LogLevel trace8 for the request?", "id": 171791, "time": "2013-12-17T14:13:05Z", "creator": "covener@gmail.com", "creation_time": "2013-12-17T14:13:05Z", "is_private": false, "attachment_id": null}, {"count": 11, "text": "I have something similar.\n\n<AuthnProviderAlias ldap thing1>\n        AuthLDAPBindDN ldapshp@thing1.int\n        AuthLDAPBindPassword password\n        AuthLDAPURL \"ldap://dc.thing1.int/OU=THING Team BBU,DC=thing1,DC=int?sAMAccountName?sub?(objectClass=user)\"\n</AuthnProviderAlias>\n<AuthnProviderAlias ldap thing2>\n        AuthLDAPBindDN ldapshp@thing2.int\n        AuthLDAPBindPassword password\n        AuthLDAPURL \"ldap://dcdlm.thing2.int/OU=THING Team DLM,DC=thing2,DC=int?sAMAccountName?sub?(objectClass=user)\"\n</AuthnProviderAlias>\n<VirtualHost 10.10.1.32:80>\n        ServerName athena.thing.int\n        DocumentRoot /var/www/html/athena.thing.int\n        <Directory /var/www/html/athena.thing.int>\n                AuthBasicProvider thing1 thing2\n                AuthType Basic\n                AuthName \"User\"\n                Require valid-user\n        </Directory>\n</VirtualHost>\n\nIf I put LogLevel trace8 in httpd.conf ( instead of LogLevel warn ) I get this:\n\n[root@athena conf.d]# /etc/init.d/httpd restart\nStopping httpd:                                            [  OK  ]\nStarting httpd: [Fri Jan 03 02:40:21.541073 2014] [core:trace3] [pid 14187] core.c(3035): Setting LogLevel for all modules to trace8\n                                                           [  OK  ]\n\nHowever, if I put LogLevel trace8 in at the top of conf.d/thing.int.conf ( pasted above )\n\n[root@athena conf.d]# /etc/init.d/httpd restart\nStopping httpd:                                            [  OK  ]\nStarting httpd: [Fri Jan 03 02:45:20.299802 2014] [core:trace3] [pid 14460] core.c(3035): Setting LogLevel for all modules to trace8\n[Fri Jan 03 02:45:20.299952 2014] [authnz_ldap:trace1] [pid 14460] mod_authnz_ldap.c(1424): auth_ldap url parse: `ldap://dc.thing1.int/OU=THING Team BBU,DC=thing1,DC=int?sAMAccountName?sub?(objectClass=user)', Host: dc.thing1.int, Port: 389, DN: OU=THING Team BBU,DC=thing1,DC=int, attrib: sAMAccountName, scope: subtree, filter: (objectClass=user), connection mode: not using SSL\n[Fri Jan 03 02:45:20.299978 2014] [authnz_ldap:trace1] [pid 14460] mod_authnz_ldap.c(1424): auth_ldap url parse: `ldap://dcdlm.thing2.int/OU=THING Team DLM,DC=thing2,DC=int?sAMAccountName?sub?(objectClass=user)', Host: dcdlm.thing2.int, Port: 389, DN: OU=THING Team DLM,DC=thing2,DC=int, attrib: sAMAccountName, scope: subtree, filter: (objectClass=user), connection mode: not using SSL\n[Fri Jan 03 02:45:20.300684 2014] [core:trace3] [pid 14460] core.c(3035): Setting LogLevel for all modules to trace8\n                                                           [  OK  ]\n\n[Fri Jan 03 02:45:20.303593 2014] [suexec:notice] [pid 14460] AH01232: suEXEC mechanism enabled (wrapper: /usr/sbin/suexec)\n[Fri Jan 03 02:45:20.336602 2014] [auth_digest:notice] [pid 14461] AH01757: generating secret for digest authentication ...\n[Fri Jan 03 02:45:20.336715 2014] [auth_digest:debug] [pid 14461] mod_auth_digest.c(250): AH01759: done\n[Fri Jan 03 02:45:20.337296 2014] [ldap:debug] [pid 14461] util_ldap.c(2939): AH01316: LDAP merging Shared Cache conf: shm=0x7f0cd7617b90 rmm=0x7f0cd7617be8 for VHOST: athena.thing.int\n[Fri Jan 03 02:45:20.338093 2014] [ldap:info] [pid 14461] AH01318: APR LDAP: Built with OpenLDAP LDAP SDK\n[Fri Jan 03 02:45:20.338150 2014] [ldap:info] [pid 14461] AH01319: LDAP: SSL support available\n[Fri Jan 03 02:45:20.364323 2014] [core:trace4] [pid 14461] mpm_common.c(530): mpm child 14463 (gen 0/slot 0) started\n[Fri Jan 03 02:45:20.365746 2014] [core:trace4] [pid 14461] mpm_common.c(530): mpm child 14464 (gen 0/slot 1) started\n[Fri Jan 03 02:45:20.367057 2014] [core:trace4] [pid 14461] mpm_common.c(530): mpm child 14465 (gen 0/slot 2) started\n[Fri Jan 03 02:45:20.368319 2014] [core:trace4] [pid 14461] mpm_common.c(530): mpm child 14466 (gen 0/slot 3) started\n[Fri Jan 03 02:45:20.369630 2014] [core:trace4] [pid 14461] mpm_common.c(530): mpm child 14467 (gen 0/slot 4) started\n[Fri Jan 03 02:45:20.369703 2014] [mpm_prefork:notice] [pid 14461] AH00163: Apache/2.4.7 (Unix) PHP/5.5.7 configured -- resuming normal operations\n[Fri Jan 03 02:45:20.369737 2014] [mpm_prefork:info] [pid 14461] AH00164: Server built: Jan  2 2014 23:36:19\n[Fri Jan 03 02:45:20.369811 2014] [core:notice] [pid 14461] AH00094: Command line: '/usr/sbin/httpd'\n[Fri Jan 03 02:45:20.369855 2014] [mpm_prefork:debug] [pid 14461] prefork.c(995): AH00165: Accept mutex: sysvsem (default: sysvsem)\n[Fri Jan 03 02:48:49.312603 2014] [core:trace5] [pid 14463] protocol.c(618): [client 10.10.9.90:40681] Request received from client: GET / HTTP/1.1\n[Fri Jan 03 02:48:49.312813 2014] [http:trace4] [pid 14463] http_request.c(301): [client 10.10.9.90:40681] Headers received from client:\n[Fri Jan 03 02:48:49.312831 2014] [http:trace4] [pid 14463] http_request.c(305): [client 10.10.9.90:40681]   Host: athena.thing.int\n[Fri Jan 03 02:48:49.312843 2014] [http:trace4] [pid 14463] http_request.c(305): [client 10.10.9.90:40681]   Connection: keep-alive\n[Fri Jan 03 02:48:49.312853 2014] [http:trace4] [pid 14463] http_request.c(305): [client 10.10.9.90:40681]   Cache-Control: max-age=0\n[Fri Jan 03 02:48:49.312863 2014] [http:trace4] [pid 14463] http_request.c(305): [client 10.10.9.90:40681]   Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\n[Fri Jan 03 02:48:49.312873 2014] [http:trace4] [pid 14463] http_request.c(305): [client 10.10.9.90:40681]   User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36\n[Fri Jan 03 02:48:49.312884 2014] [http:trace4] [pid 14463] http_request.c(305): [client 10.10.9.90:40681]   DNT: 1\n[Fri Jan 03 02:48:49.312894 2014] [http:trace4] [pid 14463] http_request.c(305): [client 10.10.9.90:40681]   Accept-Encoding: gzip,deflate,sdch\n[Fri Jan 03 02:48:49.312903 2014] [http:trace4] [pid 14463] http_request.c(305): [client 10.10.9.90:40681]   Accept-Language: en-US,en;q=0.8,ro;q=0.6\n[Fri Jan 03 02:48:49.312913 2014] [http:trace4] [pid 14463] http_request.c(305): [client 10.10.9.90:40681]   If-None-Match: \\\\\"0-4eed4a25d923d\\\\\"\n[Fri Jan 03 02:48:49.312923 2014] [http:trace4] [pid 14463] http_request.c(305): [client 10.10.9.90:40681]   If-Modified-Since: Tue, 31 Dec 2013 13:35:31 GMT\n[Fri Jan 03 02:48:49.313063 2014] [authz_core:debug] [pid 14463] mod_authz_core.c(802): [client 10.10.9.90:40681] AH01626: authorization result of Require valid-user : denied (no authenticated user yet)\n[Fri Jan 03 02:48:49.313081 2014] [authz_core:debug] [pid 14463] mod_authz_core.c(802): [client 10.10.9.90:40681] AH01626: authorization result of <RequireAny>: denied (no authenticated user yet)\n[Fri Jan 03 02:48:49.313101 2014] [core:trace3] [pid 14463] request.c(116): [client 10.10.9.90:40681] auth phase 'check user' gave status 401: /\n[Fri Jan 03 02:48:49.313182 2014] [http:trace3] [pid 14463] http_filters.c(977): [client 10.10.9.90:40681] Response sent with status 401, headers:\n[Fri Jan 03 02:48:49.313198 2014] [http:trace5] [pid 14463] http_filters.c(984): [client 10.10.9.90:40681]   Date: Fri, 03 Jan 2014 00:48:49 GMT\n[Fri Jan 03 02:48:49.313208 2014] [http:trace5] [pid 14463] http_filters.c(987): [client 10.10.9.90:40681]   Server: Apache\n[Fri Jan 03 02:48:49.313220 2014] [http:trace4] [pid 14463] http_filters.c(806): [client 10.10.9.90:40681]   WWW-Authenticate: Basic realm=\\\\\"User\\\\\"\n[Fri Jan 03 02:48:49.313231 2014] [http:trace4] [pid 14463] http_filters.c(806): [client 10.10.9.90:40681]   Content-Length: 381\n[Fri Jan 03 02:48:49.313259 2014] [http:trace4] [pid 14463] http_filters.c(806): [client 10.10.9.90:40681]   Connection: close\n[Fri Jan 03 02:48:49.313268 2014] [http:trace4] [pid 14463] http_filters.c(806): [client 10.10.9.90:40681]   Content-Type: text/html; charset=iso-8859-1\n[Fri Jan 03 02:48:49.313296 2014] [core:trace6] [pid 14463] core_filters.c(527): [client 10.10.9.90:40681] core_output_filter: flushing because of FLUSH bucket\n[Fri Jan 03 02:48:49.313383 2014] [core:trace6] [pid 14463] core_filters.c(527): [client 10.10.9.90:40681] core_output_filter: flushing because of FLUSH bucket\n[Fri Jan 03 02:48:49.546826 2014] [core:trace4] [pid 14461] mpm_common.c(530): mpm child 14468 (gen 0/slot 5) started\n[Fri Jan 03 02:48:58.449614 2014] [core:trace5] [pid 14464] protocol.c(618): [client 10.10.9.90:40682] Request received from client: GET / HTTP/1.1\n[Fri Jan 03 02:48:58.449807 2014] [http:trace4] [pid 14464] http_request.c(301): [client 10.10.9.90:40682] Headers received from client:\n[Fri Jan 03 02:48:58.449824 2014] [http:trace4] [pid 14464] http_request.c(305): [client 10.10.9.90:40682]   Host: athena.thing.int\n[Fri Jan 03 02:48:58.449834 2014] [http:trace4] [pid 14464] http_request.c(305): [client 10.10.9.90:40682]   Connection: keep-alive\n[Fri Jan 03 02:48:58.449843 2014] [http:trace4] [pid 14464] http_request.c(305): [client 10.10.9.90:40682]   Cache-Control: max-age=0\n[Fri Jan 03 02:48:58.449851 2014] [http:trace4] [pid 14464] http_request.c(305): [client 10.10.9.90:40682]   Authorization: Basic dGVzdDp0ZXN0MTIz\n[Fri Jan 03 02:48:58.449860 2014] [http:trace4] [pid 14464] http_request.c(305): [client 10.10.9.90:40682]   Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\n[Fri Jan 03 02:48:58.449869 2014] [http:trace4] [pid 14464] http_request.c(305): [client 10.10.9.90:40682]   User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36\n[Fri Jan 03 02:48:58.449878 2014] [http:trace4] [pid 14464] http_request.c(305): [client 10.10.9.90:40682]   DNT: 1\n[Fri Jan 03 02:48:58.449887 2014] [http:trace4] [pid 14464] http_request.c(305): [client 10.10.9.90:40682]   Accept-Encoding: gzip,deflate,sdch\n[Fri Jan 03 02:48:58.449895 2014] [http:trace4] [pid 14464] http_request.c(305): [client 10.10.9.90:40682]   Accept-Language: en-US,en;q=0.8,ro;q=0.6\n[Fri Jan 03 02:48:58.449904 2014] [http:trace4] [pid 14464] http_request.c(305): [client 10.10.9.90:40682]   If-None-Match: \\\\\"0-4eed4a25d923d\\\\\"\n[Fri Jan 03 02:48:58.449913 2014] [http:trace4] [pid 14464] http_request.c(305): [client 10.10.9.90:40682]   If-Modified-Since: Tue, 31 Dec 2013 13:35:31 GMT\n[Fri Jan 03 02:48:58.450047 2014] [authz_core:debug] [pid 14464] mod_authz_core.c(802): [client 10.10.9.90:40682] AH01626: authorization result of Require valid-user : denied (no authenticated user yet)\n[Fri Jan 03 02:48:58.450064 2014] [authz_core:debug] [pid 14464] mod_authz_core.c(802): [client 10.10.9.90:40682] AH01626: authorization result of <RequireAny>: denied (no authenticated user yet)\n[Fri Jan 03 02:48:58.450087 2014] [auth_basic:error] [pid 14464] [client 10.10.9.90:40682] AH01618: user test not found: /\n[Fri Jan 03 02:48:58.450102 2014] [core:trace3] [pid 14464] request.c(116): [client 10.10.9.90:40682] auth phase 'check user' gave status 401: /\n[Fri Jan 03 02:48:58.450179 2014] [http:trace3] [pid 14464] http_filters.c(977): [client 10.10.9.90:40682] Response sent with status 401, headers:\n[Fri Jan 03 02:48:58.450193 2014] [http:trace5] [pid 14464] http_filters.c(984): [client 10.10.9.90:40682]   Date: Fri, 03 Jan 2014 00:48:58 GMT\n[Fri Jan 03 02:48:58.450202 2014] [http:trace5] [pid 14464] http_filters.c(987): [client 10.10.9.90:40682]   Server: Apache\n[Fri Jan 03 02:48:58.450213 2014] [http:trace4] [pid 14464] http_filters.c(806): [client 10.10.9.90:40682]   WWW-Authenticate: Basic realm=\\\\\"User\\\\\"\n[Fri Jan 03 02:48:58.450223 2014] [http:trace4] [pid 14464] http_filters.c(806): [client 10.10.9.90:40682]   Content-Length: 381\n[Fri Jan 03 02:48:58.450231 2014] [http:trace4] [pid 14464] http_filters.c(806): [client 10.10.9.90:40682]   Connection: close\n[Fri Jan 03 02:48:58.450260 2014] [http:trace4] [pid 14464] http_filters.c(806): [client 10.10.9.90:40682]   Content-Type: text/html; charset=iso-8859-1\n[Fri Jan 03 02:48:58.450287 2014] [core:trace6] [pid 14464] core_filters.c(527): [client 10.10.9.90:40682] core_output_filter: flushing because of FLUSH bucket\n[Fri Jan 03 02:48:58.450375 2014] [core:trace6] [pid 14464] core_filters.c(527): [client 10.10.9.90:40682] core_output_filter: flushing because of FLUSH bucket\n\nMaybe this guy has some insight: \nhttp://stackoverflow.com/questions/18874062/can-authnprovideralias-ldap-work-with-apache2-4-x", "bug_id": 55622, "is_private": false, "id": 172045, "time": "2014-01-03T00:57:21Z", "creator": "adrian.sandu@asandu.eu", "creation_time": "2014-01-03T00:57:21Z", "tags": [], "attachment_id": null}, {"count": 12, "tags": [], "creator": "covener@gmail.com", "attachment_id": null, "text": "Thanks Adrian, as basic as this sounds, does your symptom go away if you define and use your providers in either the same vhost or all in the base configuration?\n\nFor me, moving the usage into a VH broke my testcase, which meshes with the initial analysis in stack overflow (where the poster there finds a NULL returned, emphasis on per-server module config in authn_core, and lack of a merge function)", "id": 172047, "time": "2014-01-03T01:36:53Z", "bug_id": 55622, "creation_time": "2014-01-03T01:36:53Z", "is_private": false}, {"count": 13, "tags": [], "creator": "covener@gmail.com", "attachment_id": null, "text": "(In reply to Eric Covener from comment #12)\n> Thanks Adrian, as basic as this sounds, does your symptom go away if you\n> define and use your providers in either the same vhost or all in the base\n> configuration?\n> \n> For me, moving the usage into a VH broke my testcase, which meshes with the\n> initial analysis in stack overflow (where the poster there finds a NULL\n> returned, emphasis on per-server module config in authn_core, and lack of a\n> merge function)\n\nironically, it's not specific to LDAP.", "id": 172048, "time": "2014-01-03T01:39:32Z", "bug_id": 55622, "creation_time": "2014-01-03T01:39:32Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 55622, "text": "(In reply to Eric Covener from comment #13)\n> (In reply to Eric Covener from comment #12)\n> > Thanks Adrian, as basic as this sounds, does your symptom go away if you\n> > define and use your providers in either the same vhost or all in the base\n> > configuration?\n> > \n> > For me, moving the usage into a VH broke my testcase, which meshes with the\n> > initial analysis in stack overflow (where the poster there finds a NULL\n> > returned, emphasis on per-server module config in authn_core, and lack of a\n> > merge function)\n> \n> ironically, it's not specific to LDAP.\n\nThe final magic piece of the puzzle -- this worked in 2.2 because <authaliasprovider> was by itself in a module, but now it shares a module with AuthType, which causes a per-server config to always be created when you use a provider.", "count": 14, "id": 172049, "time": "2014-01-03T01:52:14Z", "creator": "covener@gmail.com", "creation_time": "2014-01-03T01:52:14Z", "is_private": false}, {"count": 15, "tags": [], "bug_id": 55622, "text": "http://svn.apache.org/r1554995 if anyone affected can give it a try.", "id": 172050, "time": "2014-01-03T01:59:47Z", "creator": "covener@gmail.com", "creation_time": "2014-01-03T01:59:47Z", "is_private": false, "attachment_id": null}, {"count": 16, "tags": [], "bug_id": 55622, "text": "Seems that if I put the <Directory> container with the auth outside of the <VirtualHost> directive .. it works ! :) Thanks for pointing that out ..", "id": 172056, "time": "2014-01-03T11:19:37Z", "creator": "adrian.sandu@asandu.eu", "creation_time": "2014-01-03T11:19:37Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "adrian.sandu@asandu.eu", "text": "Tried the patch on 2.4.7, works as a charm.\n\nNow .. to post a bug on 2.2 mod_authnz_ldap not doing its job with mod alias ( only the 1st provider uses the bind, the others fail ( tcpdump is saying that a successfull bind must be done before the search operation ).\n\n\nThe exact same configuration should work on 2.2 but it doesn't :|", "count": 17, "id": 172057, "time": "2014-01-03T12:03:38Z", "bug_id": 55622, "creation_time": "2014-01-03T12:03:38Z", "is_private": false}, {"count": 18, "tags": [], "bug_id": 55622, "attachment_id": null, "text": "*** Bug 56203 has been marked as a duplicate of this bug. ***", "id": 173568, "time": "2014-03-01T00:55:29Z", "creator": "covener@gmail.com", "creation_time": "2014-03-01T00:55:29Z", "is_private": false}, {"count": 19, "tags": [], "bug_id": 55622, "is_private": false, "text": "Setting [reported] version back to 2.4.7.", "id": 174589, "time": "2014-04-15T12:24:27Z", "creator": "covener@gmail.com", "creation_time": "2014-04-15T12:24:27Z", "attachment_id": null}]