[{"count": 0, "tags": [], "text": "Steps:\n\n1. Configure a Origin server to send documents that will expire in 5 seconds \n(Just to get the problem soon).\n\nExpiresActive On\nExpiresDefault \"now plus 5 seconds\"\n\n2. Configure a Proxy server to cache requests.\n3. Send a query like \n\nGET http://164.99.152.95/srini.txt HTTP/1.1\nHOST: 164.99.152.95\nConnection: Keep-Alive\n\nto the Proxy server, to get srini.txt from Origin server\n\n4. It returns the document from Origin server.Also caches that.\n\n\nHTTP/1.1 200 OK\nDate: Wed, 09 Jul 2003 07:41:59 GMT\nServer: Apache/2.0.46 (Win32)\nCache-Control: max-age=5, no-transform\nExpires: Wed, 09 Jul 2003 07:50:17 GMT\nLast-Modified: Mon, 07 Jul 2003 11:27:52 GMT\nETag: \"1bbad-25-65a0c418\"\nAccept-Ranges: bytes\nContent-Length: 37\nContent-Type: text/plain\nVia: 1.1 164.99.152.95\n\n\u00a6\u00b2 \u00a1\u00a4\u00a1\u00e3&#8729; \u00a1\u00a4\u00a1\u00d4\u00a1\u00d6\u00a1\u00a4\u00a6\u00b2\u00a1\u00de \u00a1\u00c9\u00a6\u00d2\u00a6\u00a8\u00a1\u00c0\u00a1\u00d4 \u00a1\u00dc\u00a6\u00d0HI HOW ARE YOU\n\n5. Give the Same query again after (10 seconds, allow the cache to become \nstale). The apache dumps core.\n\n\nThe scenario is that it re-validates what is there in the Cache.\nI tried it on Netware it abends(Netware core dump). But from the attachment of \ndefect #15869, attachment#(id=7167), it happens on unix as well. The scenario \nis also same. It revalidates the cache in that defect also and dumps.\n\nStack Trace of Netware:\nStack: --A9E8B230  ?\n       B504B3AF  (PROXY.NLM|(Code Start)+3AF)\n       --00000000  ?\n       -B504F000  (PROXY.NLM|(Data Start)+0)\n       --00000006  ?\n       --00000001  ?\n       --A9E8B230  ?\n       B42D1414  (APACHE2.NLM|APACHE2@ap_run_fixups+34)\n       --A9E8B230  ?\n       --00000000  ?\n       --B4F831D0  (EXPIRES.NLM|_LibCPostlude+391B)\n       --00000000  ?\n       --A9E8B230  ?\n       B42D1C18  (APACHE2.NLM|APACHE2@ap_process_request_internal+2F8)\n       --A9E8B230  ?\n       --00000001  ?\n       --A9E8B230  ?\n       --A9E8B230  ?\n       B42B062A  (APACHE2.NLM|ap_process_request+1A)\n       --A9E8B230  ?\n       --B4F83298  (EXPIRES.NLM|_LibCPostlude+39E3)\n       B42AC5A2  (APACHE2.NLM|APACHE2@ap_bucket_error_create+3C2)\n\nFor unix trace, please see the defect#15869, attachment id (id=7168).\n\nI was able to see this on 2.0.45 as well as 2.0.46. Dont know about any \nprevious or next release.", "attachment_id": null, "bug_id": 21430, "id": 40249, "time": "2003-07-09T08:39:03Z", "creator": "sragavan@novell.com", "creation_time": "2003-07-09T08:39:03Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 21430, "attachment_id": 7235, "id": 40419, "time": "2003-07-11T05:28:13Z", "creator": "sragavan@novell.com", "creation_time": "2003-07-11T05:28:13Z", "is_private": false, "text": "Created attachment 7235\nRead my additional comments."}, {"count": 2, "attachment_id": 7236, "bug_id": 21430, "is_private": false, "id": 40420, "time": "2003-07-11T05:29:29Z", "creator": "sragavan@novell.com", "creation_time": "2003-07-11T05:29:29Z", "tags": [], "text": "Created attachment 7236\nFix is attached. Read the additional comments."}, {"count": 3, "tags": [], "text": "This will make the server work. But really cant say this is the Ultimate fix. I \ncouldnt fully understand that info object that was getting used. But the server \nis working properly. If this is not the fix, then atleast could some one else \ncan know what is the problem. The info->filename is nowhere read and is NULL. \nBut over writes into r->filename, what is written by proxy_detect \nlike \"proxy:http://1.1.1.1/abc.txt\" to NULL. Thats what the problem is.\n\n\n", "is_private": false, "bug_id": 21430, "id": 40421, "time": "2003-07-11T05:32:42Z", "creator": "sragavan@novell.com", "creation_time": "2003-07-11T05:32:42Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "minfrin@sharp.fm", "text": "This is not a proxy bug, but a cache bug. Reassigning...", "id": 57872, "attachment_id": null, "bug_id": 21430, "creation_time": "2004-05-21T21:11:29Z", "time": "2004-05-21T21:11:29Z", "is_private": false}, {"count": 5, "tags": [], "creator": "chip@force-elite.com", "text": "Is this fixed with all the recent cache changes to mod_cache*?\n\nIs this Netware specific or can anyone on other platforms reproduce it and get a more useful backtrace?", "id": 62686, "time": "2004-08-30T02:04:57Z", "bug_id": 21430, "creation_time": "2004-08-30T02:04:57Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "creator": "chip@force-elite.com", "text": "Need info if this still happens with modern versions of mod_cache.", "id": 75879, "time": "2005-06-03T01:37:21Z", "bug_id": 21430, "creation_time": "2005-06-03T01:37:21Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "creator": "nick@webthing.com", "text": "No reply to Paul's request for info", "id": 109087, "time": "2007-10-07T17:03:58Z", "bug_id": 21430, "creation_time": "2007-10-07T17:03:58Z", "is_private": false, "attachment_id": null}]