[{"count": 0, "tags": [], "creator": "krishna.kunderu@tcs.com", "attachment_id": null, "text": "During Deploying of our application in the application server (OC4J of Oracle)\nwe are getting some exception, while the application is getting deployed without any issue. Below is the stack trace for the same.\n\nAt the first instance I feel like some concurrent issue in bcel happening for the applications on application server. It could be that current version of bcel (5.1) I am using is not thread safe.\n\nI am not sure whether this is already an identified bug, if so please let me know in which version of bcel, is this fixed?\n\njava.lang.InstantiationException: org.apache.bcel.classfile.ClassFormatException: Invalid method signature: (ILoracle/sql/STR\nUCT;)V\n        at oracle.j2ee.connector.proxy.BCELProxyFactory.createProxy(BCELProxyFactory.java:382)\n        at oracle.j2ee.connector.proxy.BCELProxyFactory.getProxy(BCELProxyFactory.java:141)\n        at oracle.oc4j.sql.proxy.SQLBCELProxyFactory.getProxy(SQLBCELProxyFactory.java:47)\n        at oracle.j2ee.connector.proxy.AbstractProxy.oc4j_getProxyForReturnedObject(AbstractProxy.java:105)\n        at oracle_jdbc_driver_T4CConnection_Proxy.prepareCall()\n        at com.hubinterface.helper.DbHelper.isSwitchOn(DbHelper.java:440)\n        at com.hubinterface.helper.DbHelper.sendToDatabaseEoi(DbHelper.java:486)\n        at com.hubinterface.helper.SubmitOrderAction.processRequest_EOI(SubmitOrderAction.java:478)\n        at com.hubinterface.mq.MQMessageListener.run(MQMessageListener.java:29)\n        at java.lang.Thread.run(Unknown Source)\nCaused by: org.apache.bcel.classfile.ClassFormatException: Invalid method signature: (ILoracle/sql/STRUCT;)V\n        at org.apache.bcel.generic.Type.getArgumentTypes(Type.java:224)\n        at oracle.oc4j.sql.proxy.SQLBCELProxyBuilder.buildMethod(SQLBCELProxyBuilder.java:171)\n        at oracle.j2ee.connector.proxy.BCELProxyFactory.addInterfaceMethods(BCELProxyFactory.java:550)\n        at oracle.j2ee.connector.proxy.BCELProxyFactory.addMethods(BCELProxyFactory.java:522)\n        at oracle.j2ee.connector.proxy.BCELProxyFactory.createProxy(BCELProxyFactory.java:370)\n        ... 9 more\n\n\nAlso sometimes when some concurrent requests are coming into our application which is deployed on OC4J Application server, at some point in the code the\nfollowing exception is happening\n\n2008-09-24 05:00:45,386|ERROR|sendToDatabaseSuspendResumeEoi Database error when placing order: org.apache.bcel.classfile.ClassFormatException: Invalid method signature: ava/lang/String;Ljava/lang/String;)V\n2008-09-24 05:00:45,402|ERROR|processRequest_EOI Problem accessing R1OSS: Database error when placing order (java.sql.SQLExce\nption: org.apache.bcel.classfile.ClassFormatException: Invalid method signature: ava/lang/String;Ljava/lang/String;)V)\n2008-09-24 05:00:45,402|ERROR|processRequest_EOI Problem accessing R1OSS calling dbvalidateexceptions api: Database error whe\nn placing order (java.sql.SQLException: org.apache.bcel.classfile.ClassFormatException: Invalid method signature: ava/lang/St\nring;Ljava/lang/String;)V)", "id": 121016, "time": "2008-09-26T05:09:49Z", "bug_id": 45897, "creation_time": "2008-09-26T05:09:49Z", "is_private": false}, {"count": 1, "tags": [], "creator": "dbrosius@apache.org", "attachment_id": null, "is_private": false, "id": 121019, "time": "2008-09-26T06:46:10Z", "bug_id": 45897, "creation_time": "2008-09-26T06:46:10Z", "text": "BCEL is not perported to be thread safe, it's up to you to enforce that."}, {"count": 2, "attachment_id": null, "creator": "krishna.kunderu@tcs.com", "is_private": false, "id": 121049, "time": "2008-09-28T22:02:54Z", "bug_id": 45897, "creation_time": "2008-09-28T22:02:54Z", "tags": [], "text": "Could you please suggest how to make BCEL to be thread safe, directly in our application, we are not using anywhere the BCEL related stuff. Internally I suppose these classes would be called. Could you please suggest where exactly we can fix this issue."}, {"count": 3, "tags": [], "creator": "dbrosius@apache.org", "attachment_id": null, "is_private": false, "id": 121050, "time": "2008-09-28T22:17:40Z", "bug_id": 45897, "creation_time": "2008-09-28T22:17:40Z", "text": "I would think you would need to add synchronization in the method \n\ncom.hubinterface.helper.DbHelper.sendToDatabaseEoi\n\nand other methods/classes that also use\n\noracle.j2ee.connector.proxy.AbstractProxy\n\n\nOr you could file a bug with oracle if you believe oracle should be providing this synchronization. I'm not familiar with OC4J to be of help in this regard.\n\n\nHaving said all that, i'm going on your assertion that it is a synchronization issue. I'm not convinced that is the case.\n\nIt seems odd to me that it says the signature in question is\n\n(ILoracle/sql/STR\nUCT;)V\n\n\nPerhaps this is just a forum post issue, but that signature should not be split over two lines, and must be\n\n(ILoracle/sql/STRUCT;)V\n\nIf you are seeing the two lines as well in your logs, i'd think that is more likely your problem.\n"}, {"count": 4, "tags": [], "bug_id": 45897, "attachment_id": null, "id": 121052, "creation_time": "2008-09-28T23:39:17Z", "time": "2008-09-28T23:39:17Z", "creator": "krishna.kunderu@tcs.com", "text": "Yes, as you said it's copy paste error in the forum post. Actually the error came as you pointed out (ILoracle/sql/STRUCT;)V\n\nI will try having the Synchronized method and I will post same issue to Oracle OC4J community as well. Thanks for the help.", "is_private": false}, {"count": 5, "tags": [], "bug_id": 45897, "is_private": false, "text": "Workaround for oc4j is to use a native-data-source which is documented at\nhttp://www.oracle.com/technology/tech/java/oc4j/1013/how_to/how-to-datasource/doc/how-to-datasource.html\n\nI used factory-class=\"oracle.jdbc.pool.OracleDataSource\"", "id": 135863, "time": "2010-04-03T13:19:23Z", "creator": "nphadnis@gmail.com", "creation_time": "2010-04-03T13:19:23Z", "attachment_id": null}]