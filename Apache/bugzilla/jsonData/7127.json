[{"count": 0, "tags": [], "text": "In Tomcat 4.0.3, it appears that servlets are prevented from using cookies of \ntheir own, i.e. use any cookies in addition to JSESSIONID\n\nThe JSESSIONID cookie seems to be added to the response header after the \nservlet has finished execution and seems to overwrite/delete all cookies added \nby a servlet using the response.addCookie() method.\n\nThis worked fine in Tomcat 3 and is preventing me from moving to Tomcat 4.\n\n- Ivar Wold", "attachment_id": null, "id": 11806, "creation_time": "2002-03-14T18:07:50Z", "time": "2002-03-14T18:07:50Z", "creator": "ivar@ivarwold.com", "bug_id": 7127, "is_private": false}, {"count": 1, "tags": [], "bug_id": 7127, "attachment_id": null, "id": 11807, "time": "2002-03-14T18:12:31Z", "creator": "remm@apache.org", "creation_time": "2002-03-14T18:12:31Z", "is_private": false, "text": "The 'cookie' example does that, and does work fine for me. There are also tests\nin the test suites (tester and Watchdog). If it still doesn't work for you,\nplease submit a test case which would demonstrate the bug."}, {"count": 2, "tags": [], "bug_id": 7127, "attachment_id": 1351, "id": 11812, "time": "2002-03-14T21:55:37Z", "creator": "ivar@ivarwold.com", "creation_time": "2002-03-14T21:55:37Z", "is_private": false, "text": "Created attachment 1351\nJSP file which fails on Tomcat 4, but works on Tomcat 3"}, {"count": 3, "tags": [], "bug_id": 7127, "text": "I have attached a JSP file, which I put together to illustrate the problem. \nThis program causes an exception in Tomcat 4, but works fine on Tomcat 3. In my \noriginal encounter with the problem, I did not get this exception, but I \nsuspect that the new problem and the old one may be related. I will attach the \nexception stack trace in a moment.\n\n- Ivar Wold\n", "id": 11813, "time": "2002-03-14T22:01:46Z", "creator": "ivar@ivarwold.com", "creation_time": "2002-03-14T22:01:46Z", "is_private": false, "attachment_id": null}, {"count": 4, "attachment_id": null, "creator": "ivar@ivarwold.com", "is_private": false, "id": 11814, "time": "2002-03-14T22:05:21Z", "bug_id": 7127, "creation_time": "2002-03-14T22:05:21Z", "tags": [], "text": "Stack trace for the previously reported problem.\n\nThis happens on the first access to a newly created Tomcat instance\n\n\njava.lang.NullPointerException\n\tat org.apache.jsp.cookie$jsp._jspService(cookie$jsp.java:67)\n\tat org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:107)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat org.apache.jasper.servlet.JspServlet$JspServletWrapper.service\n(JspServlet.java:202)\n\tat org.apache.jasper.servlet.JspServlet.serviceJspFile\n(JspServlet.java:382)\n\tat org.apache.jasper.servlet.JspServlet.service(JspServlet.java:474)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java:247)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java:193)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke\n(StandardWrapperValve.java:243)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:566)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat org.apache.catalina.core.StandardContextValve.invoke\n(StandardContextValve.java:190)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:566)\n\tat org.apache.catalina.valves.CertificatesValve.invoke\n(CertificatesValve.java:246)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:564)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat org.apache.catalina.core.StandardContext.invoke\n(StandardContext.java:2347)\n\tat org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:180)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:566)\n\tat org.apache.catalina.valves.ErrorDispatcherValve.invoke\n(ErrorDispatcherValve.java:170)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:564)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke\n(ErrorReportValve.java:170)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:564)\n\tat org.apache.catalina.valves.AccessLogValve.invoke\n(AccessLogValve.java:468)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:564)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:174)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:566)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat org.apache.catalina.connector.http.HttpProcessor.process\n(HttpProcessor.java:1017)\n\tat org.apache.catalina.connector.http.HttpProcessor.run\n(HttpProcessor.java:1115)\n\tat java.lang.Thread.run(Thread.java:536)\n\n"}, {"count": 5, "tags": [], "text": "Never mind. The code did not check for a null cookie array!!! My fault. I am \nstill seeing the original problem, though. I'll investigate further.\n\n- Ivar Wold", "is_private": false, "id": 11815, "creator": "ivar@ivarwold.com", "time": "2002-03-14T22:14:34Z", "bug_id": 7127, "creation_time": "2002-03-14T22:14:34Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 7127, "attachment_id": null, "id": 11819, "time": "2002-03-14T23:18:00Z", "creator": "remm@apache.org", "creation_time": "2002-03-14T23:18:00Z", "is_private": false, "text": "Your example does work with the current Tomcat code (4.0.4-dev, HEAD). I can't\nfind any real difference between your code and the CookieServlet example, so I\nthink it should also work with 4.0.3.\n\nNote: If you are not using Tomcat standalone, and are using a native web\nconnector, you MUST specify it in the bug report."}]