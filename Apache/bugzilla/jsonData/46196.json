[{"count": 0, "tags": [], "creator": "ch_raghu_nath@yahoo.com", "attachment_id": null, "text": "I am using the below code to convert the single ppt to png slide. But it is taking around 10 seconds for each slide. which will create a huge performance problem.\n\nHere I am giving some background on this issue. \n I am developing the application which will create a ppt slides to jpg. So here User will upload the ppt. But when ppt contains around 10 slides it is taking around 100 sec which is huge impact on my application response.\n\nPlease solve this issue. Thanks in advance.\n\nPlease let me know if you have any other code which will resolve this issue.\n\n********************************************************************************\npackage com.hsbc.servlet;\n\nimport java.awt.Color;\nimport java.awt.Dimension;\nimport java.awt.Graphics2D;\nimport java.awt.RenderingHints;\nimport java.awt.geom.Rectangle2D;\nimport java.awt.image.BufferedImage;\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.util.Date;\n\nimport javax.imageio.ImageIO;\n\nimport org.apache.poi.hslf.model.Slide;\nimport org.apache.poi.hslf.usermodel.SlideShow;\n\npublic class PPT2PNG {\n\n    public static void main(String args[]) throws Exception {\n\n       System.out.println(\"Start time:\"+new Date());\n        int slidenum = 3;\n        float scale = 1;\n        String file = \"WebContent/ppts/RIM-94100.ppt\";\n        \n        FileInputStream is = new FileInputStream(file);\n        SlideShow ppt = new SlideShow(is);\n        is.close();\n\n        Dimension pgsize = ppt.getPageSize();\n        int width = (int)(pgsize.width*scale);\n        int height = (int)(pgsize.height*scale);\n\n        Slide[] slide = ppt.getSlides();\n        for (int i = 0; i < slide.length; i++) {\n            if (slidenum != -1 && slidenum != (i+1)) continue;\n\n            String title = slide[i].getTitle();\n            System.out.println(\"Rendering slide \"+slide[i].getSlideNumber() + (title == null ? \"\" : \": \" + title));\n\n            BufferedImage img = new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);\n            Graphics2D graphics = img.createGraphics();\n            graphics.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);\n            graphics.setRenderingHint(RenderingHints.KEY_RENDERING, RenderingHints.VALUE_RENDER_QUALITY);\n            graphics.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BICUBIC);\n            graphics.setRenderingHint(RenderingHints.KEY_FRACTIONALMETRICS, RenderingHints.VALUE_FRACTIONALMETRICS_ON);\n\n            graphics.setPaint(Color.white);\n            graphics.fill(new Rectangle2D.Float(0, 0, width, height));\n\n            graphics.scale((double)width/pgsize.width, (double)height/pgsize.height);\n\n            slide[i].draw(graphics);\n\n            String fname = file.replaceAll(\"\\\\.ppt\", \"-\" + (i+1) + \".png\");\n            FileOutputStream out = new FileOutputStream(fname);\n            ImageIO.write(img, \"png\", out);\n            out.close();\n        }\n        System.out.println(\"End Time:\"+new Date());\n    }\n}", "id": 122409, "time": "2008-11-12T06:49:56Z", "bug_id": 46196, "creation_time": "2008-11-12T06:49:56Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 46196, "attachment_id": null, "id": 122536, "time": "2008-11-16T05:47:32Z", "creator": "yegor@dinom.ru", "creation_time": "2008-11-16T05:47:32Z", "is_private": false, "text": "What is your hardware configuration? How much memory do you allocate for JVM?\n\nCan you upload a sample ppt that demonstrate the performance issue?\n\nYegor"}, {"count": 2, "tags": [], "bug_id": 46196, "attachment_id": 22918, "id": 122758, "time": "2008-11-23T20:28:49Z", "creator": "ch_raghu_nath@yahoo.com", "creation_time": "2008-11-23T20:28:49Z", "is_private": false, "text": "Created attachment 22918\nSample ppt to convert them into jpeg/png"}, {"count": 3, "tags": [], "bug_id": 46196, "text": "Here I am sending my Hardware configuration:\n\nCPU : Intel core2 duo processor @ 2.33GHz\nRAM : 2GB\nHard Drive has 40GB Free space\n\nI am using RAD 7.0.0.2 to run this application.\n\nI have allocated the maximum amount of memory to JVM by specifying the max parameters.\n\nThanks in advance.", "id": 122759, "time": "2008-11-23T20:32:51Z", "creator": "ch_raghu_nath@yahoo.com", "creation_time": "2008-11-23T20:32:51Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 46196, "text": "Is there any update on this issue?\n", "count": 4, "id": 123312, "time": "2008-12-15T04:38:14Z", "creator": "ch_raghu_nath@yahoo.com", "creation_time": "2008-12-15T04:38:14Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 46196, "attachment_id": null, "id": 123345, "time": "2008-12-16T07:49:00Z", "creator": "yegor@dinom.ru", "creation_time": "2008-12-16T07:49:00Z", "is_private": false, "text": "(In reply to comment #4)\n> Is there any update on this issue?\n> \n\nnot yet."}, {"count": 6, "tags": [], "bug_id": 46196, "text": "Using the latest version of POI  (3.11-beta2) and the current version of PPT2PNG from the examples area, all 4 slides together are converted in less than 3 seconds, so it seems this was improved greatly since the bug was reported.\n\nTherefore I am closing this as WORKSFORME for now, please reopen if this still takes a long time for you with the latest version of POI.", "id": 177478, "time": "2014-08-31T20:37:11Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2014-08-31T20:37:11Z", "is_private": false, "attachment_id": null}]