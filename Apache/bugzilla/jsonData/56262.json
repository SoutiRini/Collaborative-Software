[{"count": 0, "tags": [], "bug_id": 56262, "is_private": false, "text": "Attempting to use \"ab\" with cookies that are greater than 2048 characters causes ab to hang.  I'm attempting to use \"ab\" against an openstack installation and it appears that the cookie is getting truncated, and the connection to the web server then hangs.\n\nReproduce as such:\n\nhorizonhost=$1\nusername=$2\npassword=$3\n\nurl=http://$horizonhost\n\ntmpfile=`mktemp /tmp/horizonXXXXXX`\ncookies=`mktemp /tmp/cookiesXXXXXX`\ncookies2=`mktemp /tmp/cookies2XXXXXX`\nresults=`mktemp /tmp/resultsXXXXXX`\npostfile=`mktemp /tmp/postfileXXXXXX`\n\nwget --save-headers --keep-session-cookies --save-cookies=$cookies -q -O - $url > $tmpfile\n\nregion=`grep 'name=\"region\" value=' $tmpfile  | awk -F\\\" '{ print $6 }' | sed -e 's/:/%3A/g' -e 's,/,%2F,g'`\n\ntoken=`grep csrfmiddlewaretoken $tmpfile | sed \"s/.*value='\\(.*\\)'.*/\\1/g\"`\n\necho \"csrfmiddlewaretoken=$token&region=$region&username=$username&password=$password\" > $postfile\n\nwget --save-headers -q -O - --load-cookies=$cookies --keep-session-cookies --save-cookies=$cookies2 --post-data=\"csrfmiddlewaretoken=$token&region=$region&username=$username&password=$password\" $url/dashboard/auth/login/ > $results\n\n============\n\nAt this point, attempt to use ab as such:\n\nab -v4 -n 1 -H 'Cookie: sessionid=< place the sessionid from $cookies2 here, including double quotes>; csrftoken=< place the csrftoken from $cookies2>' $url/dashboard/admin/\n\nand note that the cookie is not fully getting sent.\n\nI've attempted increasing the hardcoded value in ab.c for:\n\nchar _request[2048];\n\nand this seems to get me slightly further in that I see the initial 200 OK from the server, however, somewhere else (perhaps in the apr libraries?) something is truncating the reply back from the server, and subsequent cookies are malformed.", "id": 173819, "time": "2014-03-14T15:07:12Z", "creator": "kambiz@redhat.com", "creation_time": "2014-03-14T15:07:12Z", "attachment_id": null}]