[{"count": 0, "tags": [], "creator": "murali.n@comakeit.com", "attachment_id": 29089, "text": "Created attachment 29089\nPOI XWPFDocument Exception screenshot.\n\nHi Poi, \n\nI have downloaded the poi-3.8 version and gathered all the .jar files and used the ikvmc.exe (7.1.4532.2) to generate the .net dll. I have used the below command to generate the poi.dll \n\n>ikvmc.exe commons-logging-1.1.jar dom4j-1.6.1.jar junit-3.8.1.jar log4j-1.2.13.jar poi-3.8-20120326.jar poi-ooxml-3.8-20120326.jar poi-ooxml-schemas-3.8-20120326.jar poi-scratchpad-3.8-20120326.jar stax-api-1.0.1.jar xmlbeans-2.3.0.jar -out:poi.dll \n\nAfter the poi.dll is generated i have reffered the dll in my .net solution and tried the below code to parse a word document(.docx). \n\nXWPFDocument document = new XWPFDocument(OPCPackage.open(fileName)); \nPOIXMLProperties.CoreProperties coreProperties = document.getProperties().getCoreProperties(); \n\nIt is giving me the below exception. \n at org.apache.poi.openxml4j.opc.internal.ContentTypeManager..ctor(InputStream in, OPCPackage pkg) \n   at org.apache.poi.openxml4j.opc.internal.ZipContentTypeManager..ctor(InputStream in, OPCPackage pkg) \n   at org.apache.poi.openxml4j.opc.ZipPackage.getPartsImpl() \n   at org.apache.poi.openxml4j.opc.OPCPackage.getParts() \n   at org.apache.poi.openxml4j.opc.OPCPackage.open(String path, PackageAccess access) \n   at org.apache.poi.openxml4j.opc.OPCPackage.open(String path) \n   at NPOITestProject.Ole2Document.Ole2DocumentMessageParser.ParseFile(String fileName) in D:\\Murali\\Temp\\NPOITestProject\\NPOITestProject\\Ole2Document\\Ole2DocumentMessageParser.cs:line 24 \n   at NPOITestProject.Program.Main(String[] args) in D:\\Murali\\Temp\\NPOITestProject\\NPOITestProject\\Program.cs:line 44 \n   at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args) \n   at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args) \n   at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly() \n   at System.Threading.ThreadHelper.ThreadStart_Context(Object state) \n   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx) \n   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state) \n   at System.Threading.ThreadHelper.ThreadStart() \n\nPlease explain to me am i doing any thing wrong. Please don't confuse with my project name i mean Ole2DocumentParser.cs i am simply using a word document (.docx) for parsing.\n\nThanks & Regards, \nN.Murali Krishna.", "id": 160758, "time": "2012-07-20T12:31:46Z", "bug_id": 53576, "creation_time": "2012-07-20T12:31:46Z", "is_private": false}, {"count": 1, "text": "Could this be .net related? If you run the same code in pure java, does that work?", "bug_id": 53576, "attachment_id": null, "id": 160759, "time": "2012-07-20T14:05:28Z", "creator": "apache@gagravarr.org", "creation_time": "2012-07-20T14:05:28Z", "tags": [], "is_private": false}, {"count": 2, "text": "Hi Nick,\n\nAs i am a .NET devloper i am using the POI as mentioned in the issue description. Since i does not know how to work with Java could you please assign this to some of your team member and ask them whether this work correctly or not.\n\nThanks & Regards,\nN.Murali Krishna.", "creator": "murali.n@comakeit.com", "attachment_id": null, "id": 160805, "time": "2012-07-23T04:26:54Z", "bug_id": 53576, "creation_time": "2012-07-23T04:26:54Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "id": 160817, "time": "2012-07-23T07:05:51Z", "bug_id": 53576, "creation_time": "2012-07-23T07:05:51Z", "is_private": false, "text": "POI is Java project and we only accept bug reports reproducible in Java, not in .NET and other POI derivatives. \n\nTo run a simple Java test you don't need to be a Java expert, just install JDK, compile and run the following simple code (it is actually what you are running in NET):\n\nclass Test {\n\n  public static void main(String[] args){\n    XWPFDocument document = new XWPFDocument(OPCPackage.open(args[0])); \n    POIXMLProperties.CoreProperties coreProperties =   \n      document.getProperties().getCoreProperties(); \n  }\n}\n\nIf you still can reproduce the problem, please upload a sample .docx file so that we reproduce it on our side."}, {"count": 4, "tags": [], "text": "Hi,\n\nI'm using 3.9 with Eclipse Juno to read Excel files and get the same problem. It works with Eclipse but not in jar files in the Appian Environment.\n\n\nfileName=\"C:\\\\myfold\\\\test2.xlsx\";\nlog(\"file \" + fileName );\nFile file = new File(fileName);\nOPCPackage opcPackage;\nXSSFWorkbook myWorkbook = null;\nopcPackage = OPCPackage.open(file);\nmyWorkbook=new XSSFWorkbook(opcPackage); <== Exception\nopcPackage.close();\n\n\norg.apache.poi.openxml4j.exceptions.InvalidFormatException: Can't read content types part !\n\tat org.apache.poi.openxml4j.opc.internal.ContentTypeManager.<init>(ContentTypeManager.java:107)\n\tat org.apache.poi.openxml4j.opc.internal.ZipContentTypeManager.<init>(ZipContentTypeManager.java:56)\n\tat org.apache.poi.openxml4j.opc.ZipPackage.getPartsImpl(ZipPackage.java:167)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.getParts(OPCPackage.java:662)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.open(OPCPackage.java:248)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.open(OPCPackage.java:200)\n\tat com.solypse.etde.SolImportExcel.ReadFile(SolImportExcel.java:186)\n\tat com.solypse.etde.SolImportExcel.run(SolImportExcel.java:104)", "attachment_id": null, "bug_id": 53576, "id": 165405, "time": "2013-02-20T14:27:43Z", "creator": "bugzilla@noetika.com", "creation_time": "2013-02-20T14:27:43Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 53576, "text": "Without a sample we cannot do much about this here, please reopen this bug with a sample-file if this is still a problem for you with a recent version of POI.", "id": 191587, "time": "2016-06-12T18:30:28Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-06-12T18:30:28Z", "is_private": false, "attachment_id": null}]