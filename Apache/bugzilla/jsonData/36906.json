[{"count": 0, "tags": [], "bug_id": 36906, "attachment_id": null, "id": 80732, "time": "2005-10-04T09:56:50Z", "creator": "jansen@hbz-nrw.de", "creation_time": "2005-10-04T09:56:50Z", "is_private": false, "text": "Given this config\n  <Proxy balancer://mycluster>\n    BalancerMember \"http://10.1.2.10:4321/Test\" retry=10 loadfactor=1\n    BalancerMember \"http://10.1.2.11:4321/Test\" retry=10 loadfactor=1\n  </Proxy>\n  ProxyPass /Test balancer://mycluster lbmethod=byrequests\non host mybalancer.local.org\nWith /Test on the internal servers (_not_ Apache) being a stub wich is a case\nsensitive starting point for requests (either POST or GET with QUERY_STRING) on\nan special application.\n\nWhen trying to access\nhttp://mybalancer.local.org/Test\nthe internal servers are balanced/proxied but the request arriving at them has\nbeen rewritten to \"/test/\"!!"}, {"count": 1, "tags": [], "bug_id": 36906, "attachment_id": 16777, "is_private": false, "id": 81552, "time": "2005-10-22T00:07:08Z", "creator": "rpluem@apache.org", "creation_time": "2005-10-22T00:07:08Z", "text": "Created attachment 16777\nPatch against trunk\n\nCould you please give the attached patch a try? It should fix your problem."}, {"count": 2, "tags": [], "bug_id": 36906, "attachment_id": null, "text": "Nope, only partially:\nThe case of the leading \"T\" is no longer changed to lower case, but the trailing\nslash is still appended. The internal application does not handle that. It\nexpects to see \"/Test\", not \"/Test/\".", "id": 81648, "time": "2005-10-24T18:04:16Z", "creator": "jansen@hbz-nrw.de", "creation_time": "2005-10-24T18:04:16Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 36906, "attachment_id": null, "id": 81663, "time": "2005-10-24T20:31:50Z", "creator": "rpluem@apache.org", "creation_time": "2005-10-24T20:31:50Z", "is_private": false, "text": "This problem is caused by a configuration flaw on your side. Please use the\nfollowing configuration instead:\n\n<Proxy balancer://mycluster>\n    BalancerMember \"http://10.1.2.10:4321\" retry=10 loadfactor=1\n    BalancerMember \"http://10.1.2.11:4321\" retry=10 loadfactor=1\n</Proxy>\nProxyPass /Test balancer://mycluster/Test lbmethod=byrequests"}, {"count": 4, "tags": [], "bug_id": 36906, "attachment_id": null, "is_private": false, "id": 81688, "time": "2005-10-25T10:27:18Z", "creator": "jansen@hbz-nrw.de", "creation_time": "2005-10-25T10:27:18Z", "text": "That does not seem sensible to me - and it also does not work.\nUsing your config my backend servers see only \"/\" as URL.\n\nAnd if you were right I believe I could not do sth. like this - which would be a\nmajor drawback in my eyes:\n\n<Proxy balancer://mycluster>\n    BalancerMember \"http://10.1.2.10:4321/Test1\" retry=10 loadfactor=1\n    BalancerMember \"http://10.1.2.11:4321/Path/to/Test2\" retry=10 loadfactor=1\n</Proxy>\nProxyPass /MyTest balancer://mycluster/Test lbmethod=byrequests\n\nCorrect me if I\u00b4m wrong..."}, {"count": 5, "tags": [], "creator": "jansen@hbz-nrw.de", "attachment_id": null, "is_private": false, "id": 81723, "time": "2005-10-25T18:41:29Z", "bug_id": 36906, "creation_time": "2005-10-25T18:41:29Z", "text": "Have to correct myself: the config you proposed _does_ work. Should\u00b4ve been more\naccurate when testing it....\n\nThe second part of my comment, however, still applies: if things work like you\nsay one cannot have different paths on the backend servers. Sometimes this would\ncome in very handy. \nOn the other hand: if things work like you say, the majority of cases should be\ncovered.\n\nPerhaps the docs could be enhanced to better describe the way the configuration\nworks. Adding the path to the BalancerMember parameter seemed quite natural to\nme since the port to be used on the respective backend is given there - so why\nnot the path also?!\n\nAnyway: thanks for your effort and thanks for mod_proxy_balancer: it is a\npowerfull enrichment for the httpd!\n"}, {"count": 6, "tags": [], "bug_id": 36906, "attachment_id": null, "text": "Ok, you got me :-). Of course your second comment is completely valid and it\ndoes not seem to be logical why your configuration does not work, but mine does.\nSo I try to explain what happens:\n\nThe right side of a ProxyPass side will be normalized. Your configuration\ncontains the URL balancer://mycluster. This gets normalized to\nbalancer://mycluster/ which is correct, as the URL should consist of\n<scheme>://<host><uri>. If uri is empty it is assumed to be \"/\".\nOn the other hand when creating the final proxy URL from a balancer member the\napproach is:\n\n<balancer member><uri of right side of ProxyPass><path after left side of\nProxyPass in request>\n\nIn your case this means e.g.\n\nhttp://10.1.2.11:4321/Test (balancer member) + \"/\" (uri of right side of\nProxyPass) + \"\" (path after left side of ProxyPass in request) =\nhttp://10.1.2.11:4321/Test/.\n\nIn general this approach is fine and correct. But it makes the following\nconfigurations impossible in cases where Test1 and Test2 cannot handle the\ntrailing /:\n\n  <Proxy balancer://mycluster>\n    BalancerMember \"http://10.1.2.10:4321/Test1\" retry=10 loadfactor=1\n    BalancerMember \"http://10.1.2.11:4321/Test2\" retry=10 loadfactor=1\n  </Proxy>\n  ProxyPass /Test balancer://mycluster lbmethod=byrequests\n\nBut after a first glance to the code make this work and keep all other cases\nworking seem to get complicated. So I will\n\n- Mark this bug as fixed close (as your problem is fixed with the patch and the\nadjusted configuration)\n- Try to get the patch in 2.1.9\n- Keep this in mind and have a look when I have time. I will update this PR once\nI find a solution for this.", "id": 81725, "time": "2005-10-25T21:15:34Z", "creator": "rpluem@apache.org", "creation_time": "2005-10-25T21:15:34Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 36906, "attachment_id": null, "text": "Committed to trunk (r328463):\nhttp://svn.apache.org/viewcvs?rev=328463&view=rev\n\nCommitted to 2.2.x branch (r328465):\nhttp://svn.apache.org/viewcvs?rev=328465&view=rev", "id": 81727, "time": "2005-10-25T22:06:37Z", "creator": "rpluem@apache.org", "creation_time": "2005-10-25T22:06:37Z", "is_private": false}, {"count": 8, "tags": [], "creator": "wrowe@apache.org", "attachment_id": null, "is_private": false, "id": 135502, "time": "2010-03-22T06:00:12Z", "bug_id": 36906, "creation_time": "2010-03-22T06:00:12Z", "text": "Reclassed to delete a version"}]