[{"count": 0, "tags": [], "creator": "matsuhashi@quick.co.jp", "attachment_id": null, "text": "Version: Tomcat 4.1.27, also checked Tomcat5.0.7 where I found the same problem \nexisting.\nComponent: javax.servlet.jsp.JspWriter ?\nPlatform: Windows2000\nJVM: JDK1.4.1_01\nWebServer: Coyote\n\nI made the following JSP code. Please note that this is a \"JSP Document\" (in \nXML syntax of JSP1.2).\n-----------------------------------------------------------------------------\n<?xml version=\"1.0\" encoding=\"iso-8859-1\"?>\n<jsp:root\n\t\txmlns=\"http://www.w3.org/1999/xhtml\"\n\txmlns:jsp=\"http://java.sun.com/JSP/Page\"\t\n\tversion=\"1.2\">\n\t\n<jsp:directive.page contentType=\"text/html; charset=iso-8859-1\" \npageEncoding=\"iso-8859-1\"/>\t\n\n<html>\n\t<head>\n\t</head>\n\t<body> \n\n\t<!--\tColumn1,Row1\t   -->\n\t\t<span style=\"position:absolute; top:85; left:10;\" class=\"NAME\" \nid=\"lxip:Quote(0,0)\">Column1,Row1</span>\n\t\t<span style=\"position:absolute; top:85; left:140;\" class=\"DPP\" \nid=\"lxip:Quote(0,1)\"></span>\n\t\t<span style=\"position:absolute; top:85; left:265;\" class=\"DYWP\" \nid=\"lxip:Quote(0,2)\"></span>\n\n\t<!--\tColumn1,Row2\t   -->\n\t\t<span style=\"position:absolute; top:135; left:10;\" class=\"NAME\" \nid=\"lxip:Quote(1,0)\">Column1,Row2</span>\n\t\t<span style=\"position:absolute; top:135; left:140;\" class=\"DPP\" \nid=\"lxip:Quote(1,1)\"></span>\n\t\t<span style=\"position:absolute; top:135; left:265;\" \nclass=\"DYWP\" id=\"lxip:Quote(1,2)\"></span>\n\n\t\n\t<!--\tbackground Flash\t-->\n\t\t<object classid=\"clsid:359A84C9-2427-4407-8A03-AC10720CF0F2\">\n\t\t\t<param name=\"Date\" value=\"WJP0/,mm/dd\"/>\n\t\t\t<param name=\"Time\" value=\"WJP0/,hh:mm\"/>\n\t\t</object>\n\t</body>\n</html>\n-----------------------------------------------------------------------------\n\nWhen I make query from browser to the URL of this JSP, Tomcat responded with \nthe following result.\n-----------------------------------------------------------------------------\n\n<html>\n<head/>\n<body>\n<span style=\"position:absolute; top:85; left:10;\" class=\"NAME\" id=\"lxip:Quote\n(0,0)\">Column1,Row1</span>\n<span style=\"position:absolute; top:85; left:140;\" class=\"DPP\" id=\"lxip:Quote\n(0,1)\"/>\n<span style=\"position:absolute; top:85; left:265;\" class=\"DYWP\" id=\"lxip:Quote\n(0,2)\"/>\n<span style=\"position:absolute; top:135; left:140;\" class=\"DPP\" id=\"lxip:Quote\n(1,1)\"/>\n<span style=\"position:absolute; top:135; left:265;\" class=\"DYWP\" id=\"lxip:Quote\n(1,2)\"/></body>\n<object classid=\"clsid:359A84C9-2427-4407-8A03-AC10720CF0F2\">\n  <param name=\"Date\" value=\"WJP0/,mm/dd\"/>\n  <param name=\"Time\" value=\"WJP0/,hh:mm\"/>\n</object>\n<span style=\"position:absolute; top:135; left:10;\" class=\"NAME\" id=\"lxip:Quote\n(1,0)\">Column1,Row2</span>\n</body>\n</html>\n-----------------------------------------------------------------------------\n\nPlease note that\n(1)the end tag of \"body\" (</body>) appears twice. Why?\n(2)a span tag appears in the place where it should not. Why?\n\nI tried to find what is the exact condition of this to happen, and found the \nfollowing three points to note.\n\n(a)If you change the JSP code into JSP syntax, rather than XML syntax, then the \nproblem disapperes. I copy&paste the JSP sytax version for convenient \nreproduction:\n-----------------------------------------------------------------------------\n<%@ page contentType=\"text/html; charset=iso-8859-1\" pageEncoding=\"iso-8859-1\" %\n>\n<html>\n\t<head>\n\t</head>\n\t<body>\n\n\t<!--\tColumn1,Row1\t   -->\n\t\t<span style=\"position:absolute; top:85; left:10;\" class=\"NAME\" \nid=\"lxip:Quote(0,0)\">Column1,Row1</span>\n\t\t<span style=\"position:absolute; top:85; left:140;\" class=\"DPP\" \nid=\"lxip:Quote(0,1)\"></span>\n\t\t<span style=\"position:absolute; top:85; left:265;\" class=\"DYWP\" \nid=\"lxip:Quote(0,2)\"></span>\n\n\t<!--\tColumn1,Row2\t   -->\n\t\t<span style=\"position:absolute; top:135; left:10;\" class=\"NAME\" \nid=\"lxip:Quote(1,0)\">Column1,Row2</span>\n\t\t<span style=\"position:absolute; top:135; left:140;\" class=\"DPP\" \nid=\"lxip:Quote(1,1)\"></span>\n\t\t<span style=\"position:absolute; top:135; left:265;\" \nclass=\"DYWP\" id=\"lxip:Quote(1,2)\"></span>\n\n\t<object classid=\"clsid:359A84C9-2427-4407-8A03-AC10720CF0F2\">\n\t\t\t<param name=\"Date\" value=\"WJP0/,mm/dd\"/>\n\t\t\t<param name=\"Time\" value=\"WJP0/,hh:mm\"/>\n\t\t</object>\n\t</body>\n</html>\n-----------------------------------------------------------------------------\n\n\n\n(b)If you keep this in XML syntax, but change as follows (see the contentType \nassignment), then the problem also disappears. \n-----------------------------------------------------------------------------\n<!-- <jsp:directive.page contentType=\"text/html; charset=iso-8859-1\" \npageEncoding=\"iso-8859-1\"/> -->\n<jsp:directive.page contentType=\"text/xml; charset=iso-8859-1\" \npageEncoding=\"iso-8859-1\"/>\n----------------------------------------------------------------------------- \n\n\n\n\n(c)I checked the .java source code which is generated by the Jasper with the \nsource JSP Document. Curiously enough, the .java code looks OK. In other words,\nthe .java soruce code looks *NOT* outputting \"</body>\" tag twice! \n\n\n\nBecause of the point (c), I presumed the JspWriter implementation of Tomcat \nshould have some problem.", "id": 43151, "time": "2003-08-22T09:12:02Z", "bug_id": 22652, "creation_time": "2003-08-22T09:12:02Z", "is_private": false}, {"count": 1, "tags": [], "creator": "medthomas@ntlworld.com", "attachment_id": null, "text": "I have tested this with the latest TC4 and TC5 code. I had to add a \n</jsp:root> ending tag to your example to get it to work but once I had it \nworked as expected. There was no extra </body> tag and all the <span> tags \nwere correctly located.\n\nI am therefore closing this bug report as WORKSFORME.", "id": 43913, "time": "2003-09-09T20:36:30Z", "bug_id": 22652, "creation_time": "2003-09-09T20:36:30Z", "is_private": false}]