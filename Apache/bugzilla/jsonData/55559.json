[{"count": 0, "tags": [], "bug_id": 55559, "attachment_id": 30841, "is_private": false, "id": 170104, "time": "2013-09-14T22:16:08Z", "creator": "outsider404@gazeta.pl", "creation_time": "2013-09-14T22:16:08Z", "text": "Created attachment 30841\nPatch\n\nDataSourceRealm may use global or local JNDI registry to look for resources, but UserDatabaseRealm can use only global resources.\n\nTomcat has implemented authentication users agains XML file, and I wanted to use that feature for my application. The problem is that thr file with users must be registered in global Tomcat configuration file, but I wanted to have the file managed by application, not a server.\n\nThen I modified a class UserDatabaseRealm in similar manner as DataSourceRealm is implemented. I also updated a documentation. Class MBeanUtils is modified to avoid error on shutdown.\n\nPatch is constructed against revision 93bcdde55f62c6598f0dde9de2a575705e6b5abb (origin/trunk)\n\nI could attach application for patch verification, but it seems to me that only one attachement is allowed. However, main idea is allow the following configuration in application META-INF/context.xml file:\n\n<Context>\n \n  <Resource name=\"MyUserDatabase\" auth=\"Container\"\n    type=\"org.apache.catalina.UserDatabase\" description=\"User database that can be updated and saved\"\n    factory=\"org.apache.catalina.users.MemoryUserDatabaseFactory\"\n    pathname=\"conf/example-users.xml\" />\n  <Realm className=\"org.apache.catalina.realm.UserDatabaseRealm\"\n    resourceName=\"MyUserDatabase\" localDataSource=\"true\"/>\n\n</Context>"}, {"text": "Created attachment 30842\nsample XML file with user definition", "tags": [], "bug_id": 55559, "is_private": false, "count": 1, "id": 170105, "time": "2013-09-14T22:17:47Z", "creator": "outsider404@gazeta.pl", "creation_time": "2013-09-14T22:17:47Z", "attachment_id": 30842}, {"count": 2, "tags": [], "bug_id": 55559, "attachment_id": 30843, "is_private": false, "id": 170106, "time": "2013-09-14T22:18:46Z", "creator": "outsider404@gazeta.pl", "creation_time": "2013-09-14T22:18:46Z", "text": "Created attachment 30843\nsample application"}, {"count": 3, "tags": [], "text": "Proposed test:\n1. Copy the sample XML file to $(TOMCAT)/conf directory and name it example-users.xml\n2. Deploy sample application and try to open.\n\nIf everything is OK, browser ask you for username and password and only q/qq will be accepted, as defined is sample XML file", "is_private": false, "id": 170107, "creator": "outsider404@gazeta.pl", "time": "2013-09-14T22:21:18Z", "bug_id": 55559, "creation_time": "2013-09-14T22:21:18Z", "attachment_id": null}]