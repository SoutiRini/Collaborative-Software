[{"count": 0, "tags": [], "bug_id": 6374, "is_private": false, "text": "Hi,\n I downloaded the 4.02 and installed on my machine(Windows 2000) and I copied \nan existing web-app(JSP application) from 4.0 directory. When I tried to run \nthis JSP application, I got following exception: \nI checked the xerces.jar in the common path and find there is \nonly:/org/w3c/dom/ranges package.\n Hope you can fix this problem soon.\n\nKenny Yang\n\n\ntype Exception report\n\nmessage Internal Server Error\n\ndescription The server encountered an internal error (Internal Server Error) \nthat prevented it from fulfilling this request.\n\nexception \n\njavax.servlet.ServletException: Servlet.init() for servlet jsp threw exception\n\tat org.apache.catalina.core.StandardWrapper.loadServlet\n(StandardWrapper.java:935)\n\tat org.apache.catalina.core.StandardWrapper.allocate\n(StandardWrapper.java:653)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke\n(StandardWrapperValve.java:214)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:566)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat org.apache.catalina.core.StandardContextValve.invoke\n(StandardContextValve.java:190)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:566)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat org.apache.catalina.core.StandardContext.invoke\n(StandardContext.java:2343)\n\tat org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:180)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:566)\n\tat org.apache.catalina.valves.ErrorDispatcherValve.invoke\n(ErrorDispatcherValve.java:170)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:564)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke\n(ErrorReportValve.java:170)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:564)\n\tat org.apache.catalina.valves.AccessLogValve.invoke\n(AccessLogValve.java:468)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:564)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:174)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:566)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat org.apache.catalina.connector.http.HttpProcessor.process\n(HttpProcessor.java:1012)\n\tat org.apache.catalina.connector.http.HttpProcessor.run\n(HttpProcessor.java:1107)\n\tat java.lang.Thread.run(Thread.java:484)\n\n\nroot cause \n\njava.lang.NoClassDefFoundError: org/w3c/dom/range/Range\n\tat java.lang.Class.forName0(Native Method)\n\tat java.lang.Class.forName(Class.java:120)\n\tat org.apache.xerces.parsers.DOMParser.setDocumentClassName\n(DOMParser.java:501)\n\tat org.apache.xerces.parsers.DOMParser.(DOMParser.java:232)\n\tat org.apache.xerces.jaxp.DocumentBuilderImpl.\n(DocumentBuilderImpl.java:48)\n\tat org.apache.xerces.jaxp.DocumentBuilderFactoryImpl.newDocumentBuilder\n(DocumentBuilderFactoryImpl.java:37)\n\tat org.apache.jasper.parser.ParserUtils.parseXMLDocument\n(ParserUtils.java:197)\n\tat org.apache.jasper.compiler.TldLocationsCache.processWebDotXml\n(TldLocationsCache.java:165)\n\tat org.apache.jasper.compiler.TldLocationsCache.\n(TldLocationsCache.java:138)\n\tat org.apache.jasper.EmbededServletOptions.\n(EmbededServletOptions.java:345)\n\tat org.apache.jasper.servlet.JspServlet.init(JspServlet.java:266)\n\tat org.apache.catalina.core.StandardWrapper.loadServlet\n(StandardWrapper.java:916)\n\tat org.apache.catalina.core.StandardWrapper.allocate\n(StandardWrapper.java:653)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke\n(StandardWrapperValve.java:214)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:566)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat org.apache.catalina.core.StandardContextValve.invoke\n(StandardContextValve.java:190)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:566)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat org.apache.catalina.core.StandardContext.invoke\n(StandardContext.java:2343)\n\tat org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:180)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:566)\n\tat org.apache.catalina.valves.ErrorDispatcherValve.invoke\n(ErrorDispatcherValve.java:170)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:564)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke\n(ErrorReportValve.java:170)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:564)\n\tat org.apache.catalina.valves.AccessLogValve.invoke\n(AccessLogValve.java:468)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:564)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:174)\n\tat org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java:566)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat org.apache.catalina.connector.http.HttpProcessor.process\n(HttpProcessor.java:1012)\n\tat org.apache.catalina.connector.http.HttpProcessor.run\n(HttpProcessor.java:1107)\n\tat java.lang.Thread.run(Thread.java:484)", "id": 10555, "time": "2002-02-11T19:52:09Z", "creator": "kenny.j.yang@mail.sprint.com", "creation_time": "2002-02-11T19:52:09Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 6374, "text": "Please see the answer I posted on tomcat-user:\n\n<quote>\n4.0.2 now tries to implement the requirement of preventing to load a shared\nlibrary from the webapp loader. Unfortunately, the feature is not smart\nenough at the moment, and will filter out any DOM or SAX related class.\n\nTo fix it, move the DOM classes in 'lib' or 'common/lib'.\n</quote>\n\nI'll try to address this soon, by refactoring the triggers, and allowing the\nuser to configure them (which will be the best implementation I can think of of\nwhat the spec requires).", "id": 10621, "time": "2002-02-12T23:54:18Z", "creator": "remm@apache.org", "creation_time": "2002-02-12T23:54:18Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "hoju@visi.com", "text": "I can confirm that this is happening.  However, it is not happening in 4.0.2-\nb2, only in 4.0.2 Final.  I changed the version to reflect that.  I also figure \nthat the Component is Catalina, so I made that change.\n\nI work on a project called Barracuda hosted at http://barracuda.enhydra.org/.  \nIt uses xmlc which contains XML and DOM classes that are pretty dated.  For \nthis reason, we always put the xmlc.jar in the WEB-INF/lib directory.  This \nworks great in Tomcat 3.3 and 4.xx up to 4.0.2-b2.  In 4.0.2 Final, we are now \nseeing the reported error.\n\nI have also seen a number of error reports from others:\n\nhttp://www.apachelabs.org/tomcat-user/200202.mbox/%\n3c24946BD18054D4119BE200D0B73E87778D5F50@BOROMIR%3e\n\nHere's one reporting Cocoon breaking in 4.0.2:\n\nhttp://www.apachelabs.org/tomcat-user/200202.mbox/%3c009301c1b3e9$4f6e5ff0\n$6501a8c0@apache.org%3e\n\nIf this is a \"feature\", I can't belieive that a feature that didn't exist in \n4.0.2-b2 was released without another beta.  Please fix this sooner \nthan \"Later\"!\n\nJake", "id": 10625, "time": "2002-02-13T00:07:52Z", "bug_id": 6374, "creation_time": "2002-02-13T00:07:52Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "remm@apache.org", "text": "Yes, I know it doesn't happen with b2. There were other more insidious problems\nwith using a XML parser in a webapp repository (see 6248, and many messages on\ntomcat-user).\nIt will force the XML base classes (and their subpackages, unfortunately, that's\nwhere the bug is) to be loaded from one of the parent shared classloader.\n\nI've put a fix already in CVS in both branches (the base XML classes won't be\nloaded to avoid the classcasts, but all the subpackages will). It is not\npossible, and is actually forbidden by the servlet spec, to load those classes\nfrom the webapp repositories.\n\nLATER means that I'd like to implement a better mechanism to fully implement the\nspec requirements (although it will need some special configuration by the user\nto define which libraries it has installed). This probably will stay in the HEAD\nbranch, so the resolution of the bug may not be the right one.", "id": 10627, "time": "2002-02-13T01:44:10Z", "bug_id": 6374, "creation_time": "2002-02-13T01:44:10Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "text": "This problem has been fixed in both branches (4.0 and HEAD). The classloader\nwill now match the exact package name.", "id": 10628, "time": "2002-02-13T01:51:01Z", "bug_id": 6374, "creation_time": "2002-02-13T01:51:01Z", "is_private": false}, {"count": 5, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "text": "*** Bug 6449 has been marked as a duplicate of this bug. ***", "id": 10678, "time": "2002-02-14T06:06:34Z", "bug_id": 6374, "creation_time": "2002-02-14T06:06:34Z", "is_private": false}, {"count": 6, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "text": "*** Bug 6556 has been marked as a duplicate of this bug. ***", "id": 10917, "time": "2002-02-19T17:42:12Z", "bug_id": 6374, "creation_time": "2002-02-19T17:42:12Z", "is_private": false}, {"count": 7, "tags": [], "creator": "remm@apache.org", "text": "*** Bug 6656 has been marked as a duplicate of this bug. ***", "id": 11118, "time": "2002-02-25T16:53:59Z", "bug_id": 6374, "creation_time": "2002-02-25T16:53:59Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 6374, "text": "The method WebappClassLoader.validate blocks out the loading of any classes\nbelonging to javax.xml.* as well as a few other XML related packages in the\nwebapps/lib and webapp/classes directory.  This makes it impossible for a\nspecific web application to use its own XML classes.  Also, it makes it\nimpossible for applications to do XSL transformation using javax.xml.transform.*\nclasses.  (We are using xalan for this).  The work around would be putting the\njar files in common/lib, but this is not ideal and prevents each webapp from\nhaving its own XML handling classes.\n\n", "id": 11120, "time": "2002-02-25T17:05:28Z", "creator": "lei@audiumcorp.com", "creation_time": "2002-02-25T17:05:28Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 6374, "is_private": false, "text": "Please try to read the previous comments for this bug report. Thanks.", "id": 11121, "time": "2002-02-25T17:07:49Z", "creator": "remm@apache.org", "creation_time": "2002-02-25T17:07:49Z", "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 6374, "is_private": false, "text": "*** Bug 6663 has been marked as a duplicate of this bug. ***", "id": 11149, "time": "2002-02-26T00:36:21Z", "creator": "remm@apache.org", "creation_time": "2002-02-26T00:36:21Z", "attachment_id": null}, {"count": 11, "tags": [], "bug_id": 6374, "text": "\nJust tried Catalina 4.0.3 with Cocoon CVS. If Xerces/Xalan/xml-apis JAR files \nare copied under common/lib, the result is ClassCastException:\n\njava.lang.ClassCastException: \norg.apache.xerces.parsers.StandardParserConfiguration\n\tat org.xml.sax.helpers.XMLReaderFactory.createXMLReader(Unknown Source)\n\tat org.xml.sax.helpers.XMLReaderFactory.createXMLReader(Unknown Source)\n\tat \norg.apache.cocoon.components.language.markup.AbstractMarkupLanguage.generateCode\n(AbstractMarkupLanguage.java:377)\n\tat \norg.apache.cocoon.components.language.generator.ProgramGeneratorImpl.generateRes\nource(ProgramGeneratorImpl.java:369)\n\tat \norg.apache.cocoon.components.language.generator.ProgramGeneratorImpl.createResou\nrce(ProgramGeneratorImpl.java:331)\n\tat \norg.apache.cocoon.components.language.generator.ProgramGeneratorImpl.load\n(ProgramGeneratorImpl.java:294)\n\tat org.apache.cocoon.sitemap.Handler.run(Handler.java:270)\n\tat java.lang.Thread.run(Thread.java:484)\n\nAnd messages in the console:\n\nSAX2 driver class org.apache.xerces.parsers.SAXParser does not implement \nXMLReader\nSAX2 driver class org.apache.xerces.parsers.SAXParser does not implement \nXMLReader\n\nThis seems as ClassLoader issues to me.\n\n\nIf mentioned files are removed from the WEB-INF of the Cocoon webapp, this \nprevents Cocoon from compiling its sitemap (Java compiler requires these files):\n\norg.apache.cocoon.ProcessingException: Language Exception: \norg.apache.cocoon.components.language.LanguageException: Error compiling \nsitemap_xmap:\nLine 5081, column 49:  error while loading class org.xml.sax.ContentHandler: \njava.io.IOException: file org\\xml\\sax\\ContentHandler.class not found\nLine 0, column 0: \n1 error\n\n", "id": 11381, "time": "2002-03-02T16:57:33Z", "creator": "vgritsenko@apache.org", "creation_time": "2002-03-02T16:57:33Z", "is_private": false, "attachment_id": null}, {"count": 12, "tags": [], "bug_id": 6374, "is_private": false, "text": "Work around ClassLoading issues for Cocoon under Tomcat 4.0.3:\n\n1. Move xalan/xerces/xml-apis/batik from cocoon/WEB-INF/lib to the \ntomcat/common/lib\n2. Add extra-classpath parameter to the cocoon/WEB-INF/web.xml:\n    <init-param>\n      <param-name>extra-classpath</param-name>\n      <param-value>C:\\Apache\\jakarta-tomcat-4.0.3\\common\\lib\\xalan-\n2.3.1.jar;C:\\Apache\\jakarta-tomcat-4.0.3\\common\\lib\\xercesImpl-\n2.0.0.jar;C:\\Apache\\jakarta-tomcat-4.0.3\\common\\lib\\xml-\napis.jar;C:\\Apache\\jakarta-tomcat-4.0.3\\common\\lib\\batik-libs-1.1.1.jar</param-\nvalue>\n    </init-param>\n", "id": 11384, "time": "2002-03-02T18:25:59Z", "creator": "vgritsenko@apache.org", "creation_time": "2002-03-02T18:25:59Z", "attachment_id": null}, {"count": 13, "tags": [], "bug_id": 6374, "text": "Why did you reopen this bug ? It isn't the same issue at all. Please file a new \nbug.\nAlso, TC 4.0.3 is 100% identical to 4.0.2 for Cocoon.", "id": 11385, "time": "2002-03-02T18:54:12Z", "creator": "remm@apache.org", "creation_time": "2002-03-02T18:54:12Z", "is_private": false, "attachment_id": null}, {"count": 14, "tags": [], "bug_id": 6374, "text": "*** Bug 6948 has been marked as a duplicate of this bug. ***", "id": 11536, "time": "2002-03-07T08:19:09Z", "creator": "remm@apache.org", "creation_time": "2002-03-07T08:19:09Z", "is_private": false, "attachment_id": null}, {"count": 15, "tags": [], "bug_id": 6374, "is_private": false, "text": "Kenny,\nThe fix (as far as I can tell) is in 4.04b1.", "id": 11550, "time": "2002-03-07T14:22:31Z", "creator": "brett.knights@tanner.com", "creation_time": "2002-03-07T14:22:31Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 6374, "is_private": false, "count": 16, "id": 11578, "time": "2002-03-08T16:33:31Z", "creator": "remm@apache.org", "creation_time": "2002-03-08T16:33:31Z", "text": "*** Bug 6977 has been marked as a duplicate of this bug. ***"}, {"count": 17, "tags": [], "bug_id": 6374, "is_private": false, "text": "*** Bug 6640 has been marked as a duplicate of this bug. ***", "id": 11834, "time": "2002-03-15T06:41:54Z", "creator": "remm@apache.org", "creation_time": "2002-03-15T06:41:54Z", "attachment_id": null}, {"count": 18, "tags": [], "bug_id": 6374, "is_private": false, "text": "*** Bug 7717 has been marked as a duplicate of this bug. ***", "id": 12754, "time": "2002-04-03T14:26:33Z", "creator": "remm@apache.org", "creation_time": "2002-04-03T14:26:33Z", "attachment_id": null}, {"count": 19, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "text": "*** Bug 8020 has been marked as a duplicate of this bug. ***", "id": 13378, "time": "2002-04-12T15:00:16Z", "bug_id": 6374, "creation_time": "2002-04-12T15:00:16Z", "is_private": false}, {"count": 20, "tags": [], "bug_id": 6374, "text": "Please provide details on the proper work arounds for Tomcat 4.0.3 Final \nand Cocoon 2.0.2 in the Cocoon Installation Document.\n\nThis is an anoying little bug and I can't seem to get around it due to \nconflicting installation instructions.\n\n", "id": 14090, "time": "2002-04-19T20:54:22Z", "creator": "bmichael@goldparrot.com", "creation_time": "2002-04-19T20:54:22Z", "is_private": false, "attachment_id": null}, {"count": 21, "tags": [], "bug_id": 6374, "text": "*** Bug 8622 has been marked as a duplicate of this bug. ***", "id": 15049, "time": "2002-04-29T15:14:33Z", "creator": "remm@apache.org", "creation_time": "2002-04-29T15:14:33Z", "is_private": false, "attachment_id": null}, {"count": 22, "tags": [], "bug_id": 6374, "text": "*** Bug 9360 has been marked as a duplicate of this bug. ***", "id": 16617, "time": "2002-05-24T00:23:28Z", "creator": "remm@apache.org", "creation_time": "2002-05-24T00:23:28Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 6374, "is_private": false, "count": 23, "id": 16623, "time": "2002-05-24T06:34:19Z", "creator": "remm@apache.org", "creation_time": "2002-05-24T06:34:19Z", "text": "*** Bug 9371 has been marked as a duplicate of this bug. ***"}, {"count": 24, "tags": [], "bug_id": 6374, "is_private": false, "text": "Dear Remy,\n\nBy reading these comments, it seems that the problem is fixed. But I still \nencounter exactly the same problem in tomcat 4.03. Would you mind to tell me \nwhat to do so that I could load the class \"org.w3c.dom.range.Range\"?\n\nThanks.\n", "id": 16624, "time": "2002-05-24T06:48:13Z", "creator": "chung_po_loi@hotmail.com", "creation_time": "2002-05-24T06:48:13Z", "attachment_id": null}, {"count": 25, "tags": [], "bug_id": 6374, "text": "4.0.4b3 works ootb.", "id": 16626, "time": "2002-05-24T07:48:41Z", "creator": "morrijr@apache.org", "creation_time": "2002-05-24T07:48:41Z", "is_private": false, "attachment_id": null}]