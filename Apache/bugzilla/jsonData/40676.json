[{"count": 0, "attachment_id": null, "bug_id": 40676, "text": "graphics as png files (total files size about 2 Mb) are expanded to some bitmap?\nrepresentation in pdf leading to a massive increase in file size (from 0.6 Mb\nusing version 2 to 10 Mb using version 0.92).\n\nIs there some way of specifying that compressed graphics should be used in the pdf.\n\n(The graphics are actually math equations - fairly complicated with integrals\netc, and some simple graphs of functions like normal distribution. About 30 of\neach, so quite a lot of work to change representation ;-) Is there some other\nworkaround?  vector format?)", "id": 94470, "time": "2006-10-04T03:44:48Z", "creator": "PBRISTOW@hetp.u-net.com", "creation_time": "2006-10-04T03:44:48Z", "tags": [], "is_private": false}, {"attachment_id": null, "tags": [], "creator": "jeremias@apache.org", "is_private": false, "count": 1, "id": 94496, "time": "2006-10-04T14:17:54Z", "bug_id": 40676, "creation_time": "2006-10-04T14:17:54Z", "text": "PNG images are currently decompressed, normalized to RGBA (32bit) and then\nrecompressed for PDF. Of course, that's suboptimal.\n\nYes, it's theoretically possible to embed the compressed PNG data directly in\nthe PDF. This is something that is on my task list for the next three months as\npart of a general redesign of the image adapter package which is also\nresponsible for the implicit conversion to RGBA of the image.\n\nWork-arounds for you: Yes, please try a vector format, preferably SVG because we\ncan handle this natively. Your equations will look much nicer."}, {"count": 2, "tags": [], "bug_id": 40676, "attachment_id": null, "id": 94689, "time": "2006-10-10T09:36:42Z", "creator": "PBRISTOW@hetp.u-net.com", "creation_time": "2006-10-10T09:36:42Z", "is_private": false, "text": "Thanks for helpful comment and promises ;-) But meanwhile:  Do you any\nrecommendations on MathML to SVG conversion.  A quick Google turns up some tools\nbut some seem not to work well yet.\n\nWe also have a problem with simple x y graphs to show simple functions as\ncoloured curves, for example normal distribution 'bell' curve.  Do you have\nsuggestions for doing these (from tables of data as decimal digits).\n\nThanks\n\nPaul\n"}, {"attachment_id": null, "tags": [], "bug_id": 40676, "text": "We use JEuclid.\nSee the FO extension in examples/mathml", "count": 3, "id": 94707, "time": "2006-10-11T01:12:12Z", "creator": "jeremias@apache.org", "creation_time": "2006-10-11T01:12:12Z", "is_private": false}, {"count": 4, "tags": [], "creator": "gadams@apache.org", "attachment_id": null, "text": "resetting P2 open bugs to P3 pending further review", "id": 157476, "time": "2012-04-07T01:43:32Z", "bug_id": 40676, "creation_time": "2012-04-07T01:43:32Z", "is_private": false}, {"count": 5, "tags": [], "creator": "gadams@apache.org", "attachment_id": null, "text": "change status from ASSIGNED to NEW for consistency", "id": 157914, "time": "2012-04-11T06:17:49Z", "bug_id": 40676, "creation_time": "2012-04-11T06:17:49Z", "is_private": false}, {"count": 6, "tags": [], "creator": "lmpmbernardo@gmail.com", "attachment_id": 28771, "text": "Created attachment 28771\noutput PDF of test case after fix", "id": 159019, "time": "2012-05-13T22:05:42Z", "bug_id": 40676, "creation_time": "2012-05-13T22:05:42Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 40676, "text": "sorry, above attachment, 28771, is for bug 40699. stupid bugzilla...", "id": 159021, "time": "2012-05-13T22:10:28Z", "creator": "lmpmbernardo@gmail.com", "creation_time": "2012-05-13T22:10:28Z", "is_private": false, "attachment_id": null}, {"attachment_id": 28929, "tags": [], "creator": "lmpmbernardo@gmail.com", "is_private": false, "count": 8, "id": 159947, "time": "2012-06-13T13:06:12Z", "bug_id": 40676, "creation_time": "2012-06-13T13:06:12Z", "text": "Created attachment 28929\npatch\n\nthis patch includes new image handlers for PNG for PDF and PS output. these image handlers can handle the raw IDAT chunk and lead to smaller files.\n\nto use these handlers the ImageLoaderRawPNG needs to be enabled in the fop.xconf file."}, {"count": 9, "tags": [], "text": "Created attachment 28930\ntest examples\n\nthe attachment includes a test.fo file, some test images, a fop.xconf, and PDF and PS output of the test file. note that the image loader in the fop.xconf needs to be enabled/disabled.", "attachment_id": 28930, "id": 159948, "creator": "lmpmbernardo@gmail.com", "time": "2012-06-13T13:13:18Z", "bug_id": 40676, "creation_time": "2012-06-13T13:13:18Z", "is_private": false}, {"count": 10, "tags": [], "text": "Created attachment 28932\nanother example\n\nthis example uses a larger image to better show the differences in file size of the resulting PDF.", "is_private": false, "id": 159956, "creator": "lmpmbernardo@gmail.com", "time": "2012-06-13T15:02:04Z", "bug_id": 40676, "creation_time": "2012-06-13T15:02:04Z", "attachment_id": 28932}, {"count": 11, "tags": [], "bug_id": 40676, "attachment_id": null, "id": 160017, "time": "2012-06-15T03:00:32Z", "creator": "gadams@apache.org", "creation_time": "2012-06-15T03:00:32Z", "is_private": false, "text": "patch applied at http://svn.apache.org/viewvc?rev=1350455&view=rev\n\nthanks luis and matthias!\n\nluis, please provide an additional patch (against this rev) that fixes the 13 findbugs warnings you introduced (I fixed the 2 checkstyle warnings introduced); also update the relevant documentation to describe the configuration/use of these features\n\nin the mean time, I will transition this bug to NEEDINFO"}, {"attachment_id": 28944, "tags": [], "bug_id": 40676, "text": "Created attachment 28944\npatch for findbugs\n\nfixes/ignores findbugs", "count": 12, "id": 160027, "time": "2012-06-15T11:42:58Z", "creator": "lmpmbernardo@gmail.com", "creation_time": "2012-06-15T11:42:58Z", "is_private": false}, {"count": 13, "tags": [], "bug_id": 40676, "text": "Wiki updated: http://wiki.apache.org/xmlgraphics-fop/HowTo/ImageLoaderRawPNG", "id": 160030, "time": "2012-06-15T14:18:32Z", "creator": "lmpmbernardo@gmail.com", "creation_time": "2012-06-15T14:18:32Z", "is_private": false, "attachment_id": null}, {"count": 14, "tags": [], "creator": "gadams@apache.org", "attachment_id": null, "text": "findbugs fix patch applied at http://svn.apache.org/viewvc?rev=1350790&view=rev\n\nthanks luis! please review and close if satisfied", "id": 160036, "time": "2012-06-15T20:45:14Z", "bug_id": 40676, "creation_time": "2012-06-15T20:45:14Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "gadams@apache.org", "is_private": false, "count": 15, "id": 160038, "time": "2012-06-15T21:53:27Z", "bug_id": 40676, "creation_time": "2012-06-15T21:53:27Z", "text": "(In reply to comment #13)\n> Wiki updated: http://wiki.apache.org/xmlgraphics-fop/HowTo/ImageLoaderRawPNG\n\nyou may also want to update [1] and [2]\n\n[1] http://xmlgraphics.apache.org/fop/trunk/graphics.html#png\n[2] http://xmlgraphics.apache.org/fop/trunk/configuration.html#image-loading\n\nfor example, adding info to [1] about the new codecs, and adding info to [2] about negative penalties"}, {"count": 16, "tags": [], "creator": "lmpmbernardo@gmail.com", "attachment_id": 28950, "text": "Created attachment 28950\npatch for documentation\n\nI was not aware the web pages content was part of the source too... The patch updates the documentation.", "id": 160061, "time": "2012-06-17T06:39:40Z", "bug_id": 40676, "creation_time": "2012-06-17T06:39:40Z", "is_private": false}, {"count": 17, "tags": [], "creator": "gadams@apache.org", "attachment_id": null, "text": "(In reply to comment #16)\n> Created attachment 28950 [details]\n> patch for documentation\n> \n> I was not aware the web pages content was part of the source too... The\n> patch updates the documentation.\n\nApplied final docs patch at http://svn.apache.org/viewvc?rev=1351540&view=rev.\n\nThanks luis! Please close this bug when you finish review.", "id": 160087, "time": "2012-06-19T00:21:02Z", "bug_id": 40676, "creation_time": "2012-06-19T00:21:02Z", "is_private": false}, {"id": 160213, "tags": [], "creator": "lmpmbernardo@gmail.com", "is_private": false, "count": 18, "text": "Created attachment 28988\npatch to disallow multiple image filters\n\nAdobe Reader fails to display the submitted examples when the raw png image loader is used, even though they seem valid according to the spec, and are correctly displayed by evince, ghostscript and Preview (Mac OS X PDF viewer). The Adobe Reader issue only happens if the filter flate is turned on and seems to be due to the fact that Adobe Reader may not like more than one filter applied to an image. Multiple filters applied to a stream are valid, but are also used by PDF malware exploits (like zip bombs). I suspect this is the reason why Adobe Reader does not like them.\n\nThe patch fixes this problem by only using one image filter even when the default flate filter is turned on.", "time": "2012-06-24T14:11:00Z", "bug_id": 40676, "creation_time": "2012-06-24T14:11:00Z", "attachment_id": 28988}, {"count": 19, "tags": [], "bug_id": 40676, "text": "Created attachment 28989\nupdate to previous test examples", "id": 160214, "time": "2012-06-24T14:13:17Z", "creator": "lmpmbernardo@gmail.com", "creation_time": "2012-06-24T14:13:17Z", "is_private": false, "attachment_id": 28989}, {"attachment_id": 28990, "tags": [], "creator": "lmpmbernardo@gmail.com", "is_private": false, "count": 20, "id": 160215, "time": "2012-06-24T14:14:34Z", "bug_id": 40676, "creation_time": "2012-06-24T14:14:34Z", "text": "Created attachment 28990\nupdate to previous example"}, {"count": 21, "tags": [], "bug_id": 40676, "attachment_id": null, "id": 160217, "time": "2012-06-24T18:12:26Z", "creator": "gadams@apache.org", "creation_time": "2012-06-24T18:12:26Z", "is_private": false, "text": "(In reply to comment #18)\n> Created attachment 28988 [details]\n> patch to disallow multiple image filters\n> \n> Adobe Reader fails to display the submitted examples when the raw png image\n> loader is used, even though they seem valid according to the spec, and are\n> correctly displayed by evince, ghostscript and Preview (Mac OS X PDF\n> viewer). The Adobe Reader issue only happens if the filter flate is turned\n> on and seems to be due to the fact that Adobe Reader may not like more than\n> one filter applied to an image. Multiple filters applied to a stream are\n> valid, but are also used by PDF malware exploits (like zip bombs). I suspect\n> this is the reason why Adobe Reader does not like them.\n> \n> The patch fixes this problem by only using one image filter even when the\n> default flate filter is turned on.\n\npatch applied at http://svn.apache.org/viewvc?rev=1353303&view=rev\n\nthanks luis!"}, {"id": 160218, "tags": [], "creator": "gadams@apache.org", "is_private": false, "count": 22, "text": "(In reply to comment #19)\n> Created attachment 28989 [details]\n> update to previous test examples\n\nnot sure what to do with these... do you wish to commit to trunk somewhere? if so, you need to organize into standard test cases, etc", "time": "2012-06-24T18:13:18Z", "bug_id": 40676, "creation_time": "2012-06-24T18:13:18Z", "attachment_id": null}, {"count": 23, "tags": [], "bug_id": 40676, "attachment_id": null, "id": 160221, "time": "2012-06-24T22:22:11Z", "creator": "lmpmbernardo@gmail.com", "creation_time": "2012-06-24T22:22:11Z", "is_private": false, "text": "no, the idea was never to make these part of the source. they are just provided to show what type of png images are currently supported by the new png image loader, and that the resulting output files are smaller."}, {"count": 24, "tags": [], "bug_id": 40676, "attachment_id": null, "id": 160222, "time": "2012-06-24T23:40:02Z", "creator": "gadams@apache.org", "creation_time": "2012-06-24T23:40:02Z", "is_private": false, "text": "(In reply to comment #23)\n> no, the idea was never to make these part of the source. they are just\n> provided to show what type of png images are currently supported by the new\n> png image loader, and that the resulting output files are smaller.\n\nok, if you don't think any additional test cases are useful for this bug, then please close this when you're ready"}, {"count": 25, "tags": [], "bug_id": 40676, "text": "Created attachment 29132\nsupport for sRGB and iCCP chunks\n\nthis new patch improves the previous one and adds support to color spaces to the PDFImageHandlerRawPNG.", "id": 160970, "time": "2012-07-28T23:42:15Z", "creator": "lmpmbernardo@gmail.com", "creation_time": "2012-07-28T23:42:15Z", "is_private": false, "attachment_id": 29132}, {"id": 160971, "tags": [], "creator": "lmpmbernardo@gmail.com", "is_private": false, "count": 26, "text": "Created attachment 29133\nexample with ICC profiles", "time": "2012-07-28T23:45:59Z", "bug_id": 40676, "creation_time": "2012-07-28T23:45:59Z", "attachment_id": 29133}, {"count": 27, "tags": [], "bug_id": 40676, "text": "Created attachment 29134\nexample images with ICC profiles", "id": 160972, "time": "2012-07-28T23:47:06Z", "creator": "lmpmbernardo@gmail.com", "creation_time": "2012-07-28T23:47:06Z", "is_private": false, "attachment_id": 29134}, {"count": 28, "tags": [], "bug_id": 40676, "text": "Created attachment 29135\nexample with sRGB profile (sRGB chunk)", "id": 160973, "time": "2012-07-28T23:48:47Z", "creator": "lmpmbernardo@gmail.com", "creation_time": "2012-07-28T23:48:47Z", "is_private": false, "attachment_id": 29135}, {"count": 29, "tags": [], "creator": "lmpmbernardo@gmail.com", "attachment_id": 29136, "text": "Created attachment 29136\nexample images with sRGB chunk", "id": 160974, "time": "2012-07-28T23:49:55Z", "bug_id": 40676, "creation_time": "2012-07-28T23:49:55Z", "is_private": false}, {"count": 30, "tags": [], "text": "Although file size increase is now solved, I am reopening this issue as a reminder to apply patches starting with attachment 29132. \n\nThose new patches perform better, and they also solve issue 51149.", "is_private": false, "id": 162617, "creator": "ognjen.d.blagojevic@gmail.com", "time": "2012-10-08T07:44:53Z", "bug_id": 40676, "creation_time": "2012-10-08T07:44:53Z", "attachment_id": null}, {"count": 31, "tags": [], "text": "applied patch 29132 with changes: http://svn.apache.org/viewvc?view=revision&revision=1400536", "is_private": false, "id": 162844, "creator": "lmpmbernardo@gmail.com", "time": "2012-10-20T23:53:38Z", "bug_id": 40676, "creation_time": "2012-10-20T23:53:38Z", "attachment_id": null}]