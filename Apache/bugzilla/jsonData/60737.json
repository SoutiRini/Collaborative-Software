[{"count": 0, "tags": [], "bug_id": 60737, "attachment_id": null, "text": "interface SheetContentsHandler inside XSSFSheetXMLHandler class should have an endSheet method, which should be called from the :\n\npublic void endElement(String uri, String localName, String qName)\n            throws SAXException {\n\nmethod's \"switch\" modified as follows:\n...\n } else if (\"sheetData\".equals(localName)) {\n            // Handle any \"missing\" cells which had comments attached\n            checkForEmptyCellComments(EmptyCellCommentsCheckType.END_OF_SHEET_DATA);\n            output.endSheet();\n        }\n...\n\nThis is is useful when the sheet finished processing, and you need to do something with the sheet data yet available.", "id": 197056, "time": "2017-02-16T08:20:46Z", "creator": "zakim2000@yahoo.com", "creation_time": "2017-02-16T08:20:46Z", "is_private": false}, {"count": 1, "tags": [], "creator": "onealj@apache.org", "text": "Created attachment 34758\nThe patch described by comment 0", "id": 197057, "time": "2017-02-16T09:33:24Z", "bug_id": 60737, "creation_time": "2017-02-16T09:33:24Z", "is_private": false, "attachment_id": 34758}, {"count": 2, "tags": [], "bug_id": 60737, "attachment_id": null, "text": "src/ooxml/java/org/apache/poi/xssf/extractor/XSSFEventBasedExcelExtractor.java does not compile with the patch from comment 1.\nThe following error is given:\nXSSFEventBasedExcelExtractor.SheetTextExtractor is not abstract and does not override abstract method endSheet() in SheetContentsHandler\n\nCould you submit a tested patch that hopefully also includes an update to the documentation, a poi-examples file, or a unit test so that we understand how endSheet() is used and what it's supposed to do? The title of this bug comment 0 is a bit vague on the need to have this new feature.", "id": 197058, "time": "2017-02-16T09:37:12Z", "creator": "onealj@apache.org", "creation_time": "2017-02-16T09:37:12Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 60737, "attachment_id": null, "text": "(In reply to Javen O'Neal from comment #2)\n> The title of this bug comment 0\ncorrection: The title of this bug and comment 0", "id": 197059, "time": "2017-02-16T09:37:54Z", "creator": "onealj@apache.org", "creation_time": "2017-02-16T09:37:54Z", "is_private": false}, {"count": 4, "tags": [], "creator": "zakim2000@yahoo.com", "text": "Created attachment 34759\npatched XSSFEventBasedExcelExtractor\n\nThe missing file patched.", "id": 197071, "time": "2017-02-16T14:48:23Z", "bug_id": 60737, "creation_time": "2017-02-16T14:48:23Z", "is_private": false, "attachment_id": 34759}, {"count": 5, "tags": [], "creator": "zakim2000@yahoo.com", "attachment_id": null, "id": 197072, "time": "2017-02-16T14:48:51Z", "bug_id": 60737, "creation_time": "2017-02-16T14:48:51Z", "is_private": false, "text": "Attached the missing file."}, {"count": 6, "tags": [], "text": "(In reply to zakim from comment #4)\n> Created attachment 34759 [details]\n> patched XSSFEventBasedExcelExtractor\n> \n> The missing file patched.\nPlease submit patches generated by \"svn diff\", \"git-svn diff\" or \"ant -f patch.xml\" [1]\nEntire files are difficult to review and commit because other changes may be made to that file after you attached it.\n\nAdditionally, I am unclear how this contribution will help POI. Adding a method that does nothing may be a source of confusion for people reading or maintaining the code. If your intent is to have POI define a method that you plan on overriding in your own code, how do you plan on using that? Could someone else override this inner class without modifying POI source code?\nIf so, perhaps this change is worthy of example code or documentation so that others know how to override endSheet().\n\n[1] https://poi.apache.org/guidelines.html#Submitting+Patches", "attachment_id": null, "id": 197094, "creation_time": "2017-02-17T04:29:59Z", "time": "2017-02-17T04:29:59Z", "creator": "onealj@apache.org", "bug_id": 60737, "is_private": false}, {"count": 7, "tags": [], "creator": "zakim2000@yahoo.com", "attachment_id": null, "id": 197110, "time": "2017-02-17T09:48:59Z", "bug_id": 60737, "creation_time": "2017-02-17T09:48:59Z", "is_private": false, "text": "The file shows the changes added to the existing file, compared to poi version 3.15-FINAL as stated in the version field.\nI havent checked out the entire project to send only the differences.\nIt was only a suggestion to make poi more usable which means in my opinion: \na more usable framework should be easy to use, with less coding.\nIf you need to write ten classes using the poi framework then you better write the whole function without using poi."}, {"count": 8, "tags": [], "bug_id": 60737, "attachment_id": 34762, "text": "Created attachment 34762\nThe patch corresponding to attachment 34759 against the code from 3.15-final\n\n(In reply to zakim from comment #7)\n> The file shows the changes added to the existing file, compared to poi version > 3.15-FINAL as stated in the version field.\nThe version field is sometimes updated when an unfixed bug is still present in a later build, so it's better to explicitly state in a comment what the base rev for a file is. Even better is to submit a patch, which includes the rev if the patch was generated by Subversion.\nIt's probably a good idea to check out trunk anyways so that you can open the project in Eclipse or other IDE, make your changes, and know immediately whether there are compile-time errors with your changes.\n\n> I haven't checked out the entire project to send only the differences.\nYou can perform a sparse svn checkout of POI if you don't want to wait the 10 minutes it takes to check out the trunk or one of the release tags. You could also save the original file and modified file and use any diffing program to generate a patch file (Linux/Mac: diff, Windows: TortoiseSVN, TortoiseGit)\n\n> It was only a suggestion to make poi more usable which means in my opinion: \n> a more usable framework should be easy to use, with less coding.\n> If you need to write ten classes using the poi framework then you better\n> write the whole function without using poi.\nThis is the part that I am confused about. How does the addition of an empty endSheet() method make it easier for someone to use POI? Did I correctly receive your patch file? Was there really only an addition of 3 lines?\n\nThe only other references I see to endSheet within the POI source code and website is in BigGridDemo. Is this the inspiration for this bug?\n\nI am genuinely interested in trying to make POI easier for people to use, but I'm not convinced that the contributions so far accomplish that. Am I missing some other files that have some useful behavior when the endSheet() event is reached?", "id": 197113, "time": "2017-02-17T10:26:31Z", "creator": "onealj@apache.org", "creation_time": "2017-02-17T10:26:31Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 60737, "attachment_id": null, "text": "Never mind, forget about it.\nIt's not the BigGridDemo, I've never seen that demo.\n\nYou can simply press the Diff button near the Attachment on the bugzilla site and you can see the difference. I was referring to the officially relase in the maven repo.\nIf you release another version with 3.15.Final name, then you have a big problem and the diff won't help either, because your versions will be messed up.\nIf I knew that a suggestion is so hard to accomplish, I would never start this.\nThis is a feature request I've asked for, not a bug.\nI've encountered this, when I was overwriting the following interface: XSSFSheetXMLHandler.SheetContentsHandler. I was saving the rows read from the xlsx file by group(1 save from multiple rows) and needed to save the last group at the end of the sheet without passing the data outside the overridden interface.", "id": 197115, "time": "2017-02-17T11:23:23Z", "creator": "zakim2000@yahoo.com", "creation_time": "2017-02-17T11:23:23Z", "is_private": false}, {"count": 10, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "id": 201097, "time": "2017-09-23T07:42:57Z", "bug_id": 60737, "creation_time": "2017-09-23T07:42:57Z", "is_private": false, "text": "Applied via r1809371, thanks for the suggestion."}]