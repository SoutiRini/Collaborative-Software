[{"count": 0, "tags": [], "bug_id": 45494, "is_private": false, "id": 119085, "attachment_id": null, "creator": "mi+apache@aldan.algebra.com", "creation_time": "2008-07-28T14:22:15Z", "time": "2008-07-28T14:22:15Z", "text": "I built apr-1.3.2 fresh on Solaris-10. Using the following configure:\n\nenv CC=cc CFLAGS=\"-xarch=v9b -fast\" CXXFLAGS=\"-xarch=v9b -fast\" ./configure --with-sendfile --with-devrandom --prefix=/apps/foo\n\nThe build completed cleanly, but two of the tests failed:\n\n[...]\ntestsleep           : SUCCESS\ntestshm             : SUCCESS\ntestsock            : FAILED 1 of 8\ntestsockets         : FAILED 1 of 7\ntestsockopt         : SUCCESS\nteststr             : SUCCESS\nteststrnatcmp       : SUCCESS\ntesttable           : SUCCESS\ntesttemp            : SUCCESS\ntestthread          : SUCCESS\ntesttime            : SUCCESS\ntestud              : SUCCESS\ntestuser            : SUCCESS\ntestvsn             : SUCCESS\nFailed Tests            Total   Fail    Failed %\n===================================================\ntestsock                    8      1     12.50%\ntestsockets                 7      1     14.29%\n*** Error code 1\n\nPlease, advise. Thanks!"}, {"count": 1, "tags": [], "creator": "bojan@rexursive.com", "attachment_id": null, "id": 119634, "time": "2008-08-08T22:09:27Z", "bug_id": 45494, "creation_time": "2008-08-08T22:09:27Z", "is_private": false, "text": "I'm not a Solaris guy, but I kinda remember problems with these tests when no IPv6 interfaces were configured on the machine. Do you have IPv6 configured on this system?"}, {"count": 2, "tags": [], "creator": "mi+apache@aldan.algebra.com", "text": "No, there are no IPv6 interfaces. Here is the output of \"ifconfig -a\":\n\nlo0: flags=2001000849<UP,LOOPBACK,RUNNING,MULTICAST,IPv4,VIRTUAL> mtu 8232 index 1\n        inet 127.0.0.1 netmask ff000000 \nce0: flags=1000843<UP,BROADCAST,RUNNING,MULTICAST,IPv4> mtu 1500 index 2\n        inet 10.77.11.220 netmask ffffff00 broadcast 10.77.11.255\n", "id": 119665, "time": "2008-08-10T21:10:25Z", "bug_id": 45494, "creation_time": "2008-08-10T21:10:25Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "Thats likely the reason why it fails. Create an ipv6 loopback interface and things should work:\nifconfig lo0 inet6 plumb\nifconfig lo0 inet6 ::1 up", "is_private": false, "bug_id": 45494, "id": 119668, "time": "2008-08-10T23:52:20Z", "creator": "rpluem@apache.org", "creation_time": "2008-08-10T23:52:20Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 45494, "is_private": false, "id": 119679, "attachment_id": null, "creator": "rainer.jung@kippdata.de", "creation_time": "2008-08-11T06:23:30Z", "time": "2008-08-11T06:23:30Z", "text": "If you run \"testall -v\" in the test sub directory, you will get additional information concerning the failure reason.\n\nThe failure of testsock should be fixed by now, see\n\nhttp://svn.apache.org/viewvc?rev=684617&view=rev\n\nHere the test case was not really valid.\n\nThe failure of testsockets was reproducible here and fixed by R\u00fcdiger's recommendation on how to configure an IPv6 interface with address ::1."}, {"count": 5, "tags": [], "bug_id": 45494, "text": "Here are the two tests' verbose output:\n\ntestsock            : |Line 92: Problem getting http service (2): No such file or directory\n\n|Line 290: Cannot test if connect completes synchronously\nFAILED 1 of 8\ntestsockets         : /Line 131: Could not bind socket (126): Cannot assign requested address\n\n-Line 185: Condition is false, but expected true\nFAILED 1 of 7\n", "id": 119686, "time": "2008-08-11T08:34:50Z", "creator": "mi+apache@aldan.algebra.com", "creation_time": "2008-08-11T08:34:50Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "text": "Closing. The problem with http service was fixed and the failure related to IPv6 can be avoided by configuring an IPv6 interface on the system.", "is_private": false, "id": 119696, "creator": "bojan@rexursive.com", "time": "2008-08-11T16:50:04Z", "bug_id": 45494, "creation_time": "2008-08-11T16:50:04Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 45494, "text": "With all due respect, having IPv6 configured should not be a requirement for the test's passing. In fact, having /any/ networking configured should not be a requirement.\n\nIf IPv6 (or v4) is not set up, the test should detect that and skip quietly -- without a false negative.\n\nIf the tests are known to give false alarms, a real alarm will be mistaken for a false one -- arp is the foundation of many software packages, it better be /squeaky/ clean :-)", "id": 119715, "time": "2008-08-12T07:27:53Z", "creator": "mi+apache@aldan.algebra.com", "creation_time": "2008-08-12T07:27:53Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 45494, "is_private": false, "id": 119717, "attachment_id": null, "creator": "bojan@rexursive.com", "creation_time": "2008-08-12T07:39:03Z", "time": "2008-08-12T07:39:03Z", "text": "All right, fair enough. I changed the name of the bug to reflect what's still broken."}, {"count": 9, "tags": [], "bug_id": 45494, "attachment_id": null, "id": 119723, "time": "2008-08-12T09:31:50Z", "creator": "wrowe@apache.org", "creation_time": "2008-08-12T09:31:50Z", "is_private": false, "text": "Sorry, but re-closing.\n\nIF IPV6 networking is not installed, the tests /are/ clean.\n\nIf IPv6 interfaces are not configured for an IPv6 machine, the tests\nrightfully fail.  This is true because such a misconfigured system would\nnot perform these unit tests, and therefore (under your suggestion) may\nprovide a false positive for success where the code may be faulty.\n"}, {"attachment_id": null, "tags": [], "bug_id": 45494, "text": "Absence of IPv6 is NOT a misconfiguration... Neither is the lack of IPv4.\n\nThe test's status in this case should be \"SKIPPED\". \"FAILURE\" is worse, as it raises a false alarm. A \"SUCCESS\" would be misleading (false positive), but not as bad.\n\nIf adding the third state (\"SKIPPED\") requires changes to the entire test-harness -- please, rename/reclassify this bug.\n\nBut the simple rule should be: \"run `make check' after building\". If you want people to do this, the tests should not raise false alarms, even if their coverage may sometimes be incomplete -- is it ever, really?\n\nNobody will blame you for NOT testing IPv6 on a machine, that does not have it, but FAILING a test of a piece, that's not enabled on a system, is ridiculous.", "count": 10, "id": 119730, "time": "2008-08-12T09:40:30Z", "creator": "mi+apache@aldan.algebra.com", "creation_time": "2008-08-12T09:40:30Z", "is_private": false}, {"count": 11, "tags": [], "creator": "wrowe@apache.org", "attachment_id": null, "id": 119735, "time": "2008-08-12T10:06:22Z", "bug_id": 45494, "creation_time": "2008-08-12T10:06:22Z", "is_private": false, "text": "You are missing the point, you installed IPv6 on this machine.  You did not\nconfigure an interface.\n\nEither; 1) install IPv4 layer only, and you have nothing more to do, or...\n2) install an IPv6 loopback device, to complete the installation of IPv6.\n\nIf you build for IPv6, the ./testall cannot report success without validating\ncertain exception conditions which vary from platform to platform, and as-yet\nundiscovered flaws on future platform/releases.\n\nIf you want to have an apr which doesn't test or validate ipv6, you can do so;\n\n  ./configure --disable-ipv6\n\nIf you are concerned that IPv6 networking components are installed by Solaris 10\nwithout configuring a loopback endpoint, contact Sun.\n\nIf you are concerned that we should pass these tests for IPv6 in spite of this\nmisconfiguration, it would stand to reason that we would have to give a pass to\nany misconfigured IPv4-only machine as well.  The purpose of the test suite is\nto validate all enabled apr interfaces, so the first half of this bug report\nwas 'FIXED', the second half (and current title) is INVALID."}, {"count": 12, "tags": [], "creator": "mi+apache@aldan.algebra.com", "text": "= you installed IPv6 on this machine.  You did not configure an interface.\n\nI did not install anything on this machine -- it came from Sun preinstalled with the standard Solaris 10. Having a configured IPv6, when there is no use for it is a waste, so I agree with Sun, that it is useless to enabled it.\n\nThe test should not have reported a failure. It should've SKIPPED.\n\n= ./configure --disable-ipv6\n\nYeah, that's a work-around. Except I may wish to -- some day -- be able to use it with IPv6 too. Telling me, that a test was SKIPPED because IPv6 is not currently in use on the testing machine, is Ok.\n\nTelling me, the test FAILED is bogus...\n\nThis is all patently obvious, I might add... Even IF the machine is misconfigured, the test should not \"FAIL\", because there is nothing wrong with the build.", "id": 119737, "time": "2008-08-12T10:13:09Z", "bug_id": 45494, "creation_time": "2008-08-12T10:13:09Z", "is_private": false, "attachment_id": null}, {"count": 13, "tags": [], "bug_id": 45494, "text": "Still a problem... Solaris 10, building apr-1.4.6:\n\ntestatomic          :  SUCCESS\ntestdir             :  SUCCESS\ntestdso             :  SUCCESS\ntestdup             :  SUCCESS\ntestenv             :  SUCCESS\ntestfile            :  SUCCESS\ntestfilecopy        :  SUCCESS\ntestfileinfo        :  SUCCESS\ntestflock           :  SUCCESS\ntestfmt             :  SUCCESS\ntestfnmatch         :  SUCCESS\ntestargs            :  SUCCESS\ntesthash            :  SUCCESS\ntestipsub           :  SUCCESS\ntestlock            :  SUCCESS\ntestcond            :  SUCCESS\ntestlfs             :  SUCCESS\ntestmmap            :  SUCCESS\ntestnames           :  SUCCESS\ntestoc              :  SUCCESS\ntestpath            :  SUCCESS\ntestpipe            :  SUCCESS\ntestpoll            :  SUCCESS\ntestpools           :  SUCCESS\ntestproc            :  SUCCESS\ntestprocmutex       :  \nSUCCESS\ntestrand            :  SUCCESS\ntestsleep           :  SUCCESS\ntestshm             :  SUCCESS\ntestsock            :  SUCCESS\ntestsockets         :  FAILED 1 of 7\ntestsockopt         :  SUCCESS\nteststr             :  SUCCESS\nteststrnatcmp       :  SUCCESS\ntesttable           :  SUCCESS\ntesttemp            :  SUCCESS\ntestthread          :  SUCCESS\ntesttime            :  SUCCESS\ntestud              :  SUCCESS\ntestuser            :  SUCCESS\ntestvsn             :  SUCCESS\nFailed Tests            Total   Fail    Failed %\n===================================================\ntestsockets                 7      1     14.29%\n\nRehashing this 4-year old argument, that the build-machine does not have an IPv6 interface should not cause the test to fail. The test's verdict may be \"skipped\", but it should not be a \"fail\".\n\nUsing the ``--disable-ipv6'' switch wish configure may be a work-around for some, but not for all -- the machine(s), where the compiled binaries will be used may well have/need IPv6 interfaces.", "id": 155295, "time": "2012-03-26T21:25:42Z", "creator": "mi+apache@aldan.algebra.com", "creation_time": "2012-03-26T21:25:42Z", "is_private": false, "attachment_id": null}]