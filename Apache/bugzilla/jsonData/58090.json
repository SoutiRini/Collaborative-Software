[{"count": 0, "tags": [], "text": "Created attachment 32871\nTrying to parse the attached XLSX file\n\nRunning the standalone application to process the email attachments ( XLS/XLSX/Word) in multi threaded environment. Following error is thrown while parsing the XLSX file using the following piece of code. PArsing comes to an halt and do not allow to process other XLSX files. It works only after the application restart. Appreciate if you could provide a solution for this at the earliest.( Attached the XLSX file )\n\n XSSFWorkbook workBook = new XSSFWorkbook(new FileInputStream(inputFile.getPath()));\n    try{\n     XSSFFormulaEvaluator.evaluateAllFormulaCells(workBook);\n    }catch(RuntimeException e){\n     LOG.debug(\"Exception occurred while evealating formulas\");\n    }\n    sheetsNum=workBook.getNumberOfSheets();\n    return sheetsNum;\n\n\n\norg.apache.poi.openxml4j.exceptions.InvalidFormatException: Can't read content types part !\n        at org.apache.poi.util.PackageHelper.open(PackageHelper.java:41)\n        at org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:204)\n        at com.highradius.caa.agents.DynamicRemittanceExcelAgent.getNumberOfSheets(DynamicRemittanceExcelAgent.java:427)\n        at com.highradius.caa.agents.DynamicRemittanceExcelAgent.parseRemittance(DynamicRemittanceExcelAgent.java:156)\n        at com.highradius.caa.syndication.framework.EmailAttachmentsParserAgent.run(EmailAttachmentsParserAgent.java:230)\n        at com.scraper.CashAppAgentProcessorAction.run(CashAppAgentProcessorAction.java:136)\n        at com.scraper.ScheduledAgentLauncher.immediatelyLaunchScheduledAgent(ScheduledAgentLauncher.java:266)\n        at com.scraper.WrapperAgentAction.run(WrapperAgentAction.java:172)\n        at sun.reflect.GeneratedMethodAccessor2565.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:601)\n        at org.springframework.util.MethodInvoker.invoke(MethodInvoker.java:273)\n        at org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean$MethodInvokingJob.executeInternal(MethodInvokingJobDetailFactoryBean.java:264)\n        at org.springframework.scheduling.quartz.QuartzJobBean.execute(QuartzJobBean.java:86)\n        at org.quartz.core.JobRunShell.run(JobRunShell.java:202)\n        at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:529)\nCaused by: org.apache.poi.openxml4j.exceptions.InvalidFormatException: Can't read content types part !\n        at org.apache.poi.openxml4j.opc.internal.ContentTypeManager.<init>(ContentTypeManager.java:107)\n        at org.apache.poi.openxml4j.opc.internal.ZipContentTypeManager.<init>(ZipContentTypeManager.java:56)\n        at org.apache.poi.openxml4j.opc.ZipPackage.getPartsImpl(ZipPackage.java:167)\n        at org.apache.poi.openxml4j.opc.OPCPackage.getParts(OPCPackage.java:662)\n        at org.apache.poi.openxml4j.opc.OPCPackage.open(OPCPackage.java:269)\n        at org.apache.poi.util.PackageHelper.open(PackageHelper.java:39)", "attachment_id": 32871, "id": 183828, "creator": "yanamala1@gmail.com", "time": "2015-07-01T11:19:06Z", "bug_id": 58090, "creation_time": "2015-07-01T11:19:06Z", "is_private": false}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "text": "3.9 is a little old these days, any chance you could re-test with a more modern version, eg 3.12 final?", "id": 183829, "time": "2015-07-01T11:35:26Z", "bug_id": 58090, "creation_time": "2015-07-01T11:35:26Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 58090, "text": "Tried this with latest POI 3.12 and opening the file worked fine there, please reopen with some more information if you still see this problem with a more up-to-date version of POI.", "id": 183948, "time": "2015-07-07T20:29:56Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-07-07T20:29:56Z", "is_private": false, "attachment_id": null}]