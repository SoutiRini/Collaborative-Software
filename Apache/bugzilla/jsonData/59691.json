[{"count": 0, "tags": [], "bug_id": 59691, "attachment_id": null, "id": 191594, "time": "2016-06-13T10:02:51Z", "creator": "amit.pande@veritas.com", "creation_time": "2016-06-13T10:02:51Z", "is_private": false, "text": "<Service name=\"catalina\">\n\n    <Engine defaultHost=\"localhost\" name=\"Catalina_NetBackup_Web_Services\" startStopThreads=\"0\">\n\n      <Host appBase=\"webapps\" autoDeploy=\"false\" name=\"localhost\" startStopThreads=\"0\" unpackWARs=\"true\">\n\n\n\t<Context path=\"/xyz\" reloadable=\"true\" override=\"false\">\n\t\t\t <Valve allow=\"127\\.\\d+\\.\\d+\\.\\d+|::1|0:0:0:0:0:0:0:1\" className=\"org.apache.catalina.valves.RemoteAddrValve\" denyStatus=\"404\"/>\n\t\t\t <Valve allow=\"localhost\" className=\"org.apache.catalina.valves.RemoteHostValve\" denyStatus=\"404\"/>\n\t\t</Context>\n\n</Host>\n</Engine>\n\n</Service>\n\n\n\nIf I have the nested context element defined as above, in catalina.out I don't see following Info logs.\n\n13-Jun-2016 15:21:28.641 INFO [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Deploying web application directory C:\\Program Files\\xyz\\abc\\wmc\\def\\webapps\\ROOT\n13-Jun-2016 15:21:28.668 INFO [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Deployment of web application directory C:\\Program Files\\xyz\\abc\\def\\webserver\\webapps\\ROOT has finished in 27 ms\n\n\nWe deploy multiple applications so it's important for us to get the deployment time for each of the web application. \n\n\nThe above log statements are seen once the context element is removed from above configuration."}, {"count": 1, "tags": [], "bug_id": 59691, "text": "That's because the webapp is not deployed by the Tomcat deployer (= HostConfig) in that case.", "id": 191595, "time": "2016-06-13T11:11:20Z", "creator": "remm@apache.org", "creation_time": "2016-06-13T11:11:20Z", "is_private": false, "attachment_id": null}, {"count": 2, "attachment_id": null, "bug_id": 59691, "text": "Aren't there any work-arounds ?\n\nIt looks odd NOT to have any solution to this. \n\nDid I miss something while controlling access to some web apps from only localhost ?\n\nIs there any other way to configure the remote address valves without losing the deployment logs ?", "id": 191596, "time": "2016-06-13T11:15:42Z", "creator": "amit.pande@veritas.com", "creation_time": "2016-06-13T11:15:42Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "text": "That's a lot of questions that should go to the user mailing list.\nYes, you can put this configuration inside the webapp itself rather than defining your webapp statically in server.xml.", "is_private": false, "bug_id": 59691, "id": 191597, "time": "2016-06-13T11:33:33Z", "creator": "remm@apache.org", "creation_time": "2016-06-13T11:33:33Z", "attachment_id": null}, {"count": 4, "attachment_id": null, "creator": "amit.pande@veritas.com", "is_private": false, "id": 191598, "time": "2016-06-13T11:41:20Z", "bug_id": 59691, "creation_time": "2016-06-13T11:41:20Z", "tags": [], "text": "Thanks for putting this to a mailing list. \n\n\nHad thought of putting the address/ip valve configuration to each of the web app's META-INF/context.xml.\n\nHowever, we are using Spring based Java configuration (no XMls) , so probably did not investigate much on how this can be achieved."}]