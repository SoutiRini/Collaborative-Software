[{"count": 0, "tags": [], "creator": "Anton.Cherepanov@ecm-consulting.ru", "attachment_id": 29319, "id": 161920, "time": "2012-09-03T11:17:34Z", "bug_id": 53819, "creation_time": "2012-09-03T11:17:34Z", "is_private": false, "text": "Created attachment 29319\nTest file\n\nFileInputStream is = new FileInputStream(fileName);\n            m_book = WorkbookFactory.create(is);\n\nThe simple programe code fales with error:\n\n\norg.apache.poi.POIXMLException: java.lang.reflect.InvocationTargetException\n\tat org.apache.poi.xssf.usermodel.XSSFFactory.createDocumentPart(XSSFFactory.java:62)\n\tat org.apache.poi.POIXMLDocumentPart.read(POIXMLDocumentPart.java:403)\n\tat org.apache.poi.POIXMLDocumentPart.read(POIXMLDocumentPart.java:408)\n\tat org.apache.poi.POIXMLDocument.load(POIXMLDocument.java:155)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:183)\n\tat org.apache.poi.ss.usermodel.WorkbookFactory.create(WorkbookFactory.java:73)\n\tat ru.otr.core.Document.<init>(Document.java:21)\n\tat ru.otr.EnergyLoader.main(EnergyLoader.java:175)\nCaused by: java.lang.reflect.InvocationTargetException\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)\n\tat java.lang.reflect.Constructor.newInstance(Unknown Source)\n\tat org.apache.poi.xssf.usermodel.XSSFFactory.createDocumentPart(XSSFFactory.java:60)\n\t... 7 more\nCaused by: org.apache.xmlbeans.XmlException: error: duplicate attribute 'o:relid'\n\tat org.apache.xmlbeans.impl.store.Locale$SaxLoader.load(Locale.java:3511)\n\tat org.apache.xmlbeans.impl.store.Locale.parseToXmlObject(Locale.java:1277)\n\tat org.apache.xmlbeans.impl.store.Locale.parseToXmlObject(Locale.java:1264)\n\tat org.apache.xmlbeans.impl.schema.SchemaTypeLoaderBase.parse(SchemaTypeLoaderBase.java:345)\n\tat org.apache.xmlbeans.XmlObject$Factory.parse(XmlObject.java:688)\n\tat org.apache.poi.xssf.usermodel.XSSFVMLDrawing.read(XSSFVMLDrawing.java:107)\n\tat org.apache.poi.xssf.usermodel.XSSFVMLDrawing.<init>(XSSFVMLDrawing.java:102)\n\t... 12 more\nCaused by: org.xml.sax.SAXParseException: duplicate attribute 'o:relid'\n\tat org.apache.xmlbeans.impl.piccolo.xml.Piccolo.reportFatalError(Piccolo.java:1038)\n\tat org.apache.xmlbeans.impl.piccolo.xml.Piccolo.parse(Piccolo.java:723)\n\tat org.apache.xmlbeans.impl.store.Locale$SaxLoader.load(Locale.java:3479)\n\t... 18 more"}, {"count": 1, "attachment_id": null, "bug_id": 53819, "text": "The stack trace tells that the file contains invalid xml. I checked the attached file and it is indeed so: \n/xl/drawings/vmlDrawing1.vml contains duplicate attributes which is not allowed,\nhave a look at the following fragemnt:\n\n  <v:fill o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\"\n   o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\"\n   o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\"\n   o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\"\n   o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\"\n\n\nI don't see a problem with POI here. What is the origin of this file? Make sure that this application writes correct XML. \n\nYegor", "id": 161923, "time": "2012-09-03T12:12:49Z", "creator": "yegor@dinom.ru", "creation_time": "2012-09-03T12:12:49Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 53819, "attachment_id": null, "text": "Hi. Yegor.\n\nThank you for your comment.\nThis file in attachment is originally created with Microsoft Excel (Ver: 14.0.6123.5001 32-bit)\n\nAnton.\n\n\n\n(In reply to comment #1)\n> The stack trace tells that the file contains invalid xml. I checked the\n> attached file and it is indeed so: \n> /xl/drawings/vmlDrawing1.vml contains duplicate attributes which is not\n> allowed,\n> have a look at the following fragemnt:\n> \n>   <v:fill o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\"\n> o:relid=\"rId1\"\n>    o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\"\n>    o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\"\n>    o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\"\n>    o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\"\n> \n> \n> I don't see a problem with POI here. What is the origin of this file? Make\n> sure that this application writes correct XML. \n> \n> Yegor", "id": 161925, "time": "2012-09-03T13:59:45Z", "creator": "Anton.Cherepanov@ecm-consulting.ru", "creation_time": "2012-09-03T13:59:45Z", "is_private": false}, {"count": 3, "attachment_id": null, "bug_id": 53819, "text": "POI follows the OOXML spec which requires all package parts to be well-formed XML. If a part is malformed then it is a bug (or a weird feature) of MS Office. \n\nPOI works with XML via XmlBeans and its Piccolo parser does not allow duplicate attributes.\n\nI appears that it is a general behavior:\n - Xerces (the standard XML parser from JDK) cannot parse it either\n - Chrome browser can't parse it\n -  msxml.dll (Windows-wide XML parser) cannot parse it. \n\nSo I don't see a problem with POI here. \n\nYegor\n\n(In reply to comment #2)\n> Hi. Yegor.\n> \n> Thank you for your comment.\n> This file in attachment is originally created with Microsoft Excel (Ver:\n> 14.0.6123.5001 32-bit)\n> \n> Anton.\n> \n> \n> \n> (In reply to comment #1)\n> > The stack trace tells that the file contains invalid xml. I checked the\n> > attached file and it is indeed so: \n> > /xl/drawings/vmlDrawing1.vml contains duplicate attributes which is not\n> > allowed,\n> > have a look at the following fragemnt:\n> > \n> >   <v:fill o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\"\n> > o:relid=\"rId1\"\n> >    o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\"\n> >    o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\"\n> >    o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\"\n> >    o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\" o:relid=\"rId1\"\n> > \n> > \n> > I don't see a problem with POI here. What is the origin of this file? Make\n> > sure that this application writes correct XML. \n> > \n> > Yegor", "id": 161938, "time": "2012-09-04T13:48:33Z", "creator": "yegor@dinom.ru", "creation_time": "2012-09-04T13:48:33Z", "tags": [], "is_private": false}]