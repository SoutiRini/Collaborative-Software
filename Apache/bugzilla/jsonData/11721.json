[{"count": 0, "tags": [], "creator": "zsola@indextools.com", "text": "Hi\n\nI use  POI 1.7. We'd need to generate an Excel Workbook with an\nundefined no. of sheets. All sheets should use the same template.\nI can't seem to find a method that allows me to make a copy of a\nsheet (incl. content) and insert it into an existing workbook.\n\nAlso, I tried to open a template workbook with 80 sheets and delete\nthe sheets that are not needed. I can successfully read the file,\nwrite all sheets properties to consol and save it without any\nmodifications, however, when I try to open it Excel 97 says\n\"an error occurs while initializin VBA libraries(2)\".\n\nThanks for your help in advance\n\nIstvan", "id": 21084, "time": "2002-08-15T13:37:13Z", "bug_id": 11721, "creation_time": "2002-08-15T13:37:13Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "text": "OK Id like to take responsibility for this one. (At least the clone sheet \nportion of it).\n\nI did a quick hack and could clone a sheet just by maintaining references to \nthe record objects, of course this meant that if the records on one sheet were \nchanged the other did also ;-)\n\nSo what I would like to do is to include a clone method for any records that \nare passed into a Sheet. It would be similar to the following code:\n\n\u00a0\u00a0\u00a0 public Object clone() {\n\u00a0\u00a0\u00a0\u00a0\u00a0 IndexRecord rec = new IndexRecord();\n\u00a0\u00a0\u00a0\u00a0\u00a0 rec.field_1_zero = field_1_zero;\n\u00a0\u00a0\u00a0\u00a0\u00a0 rec.field_2_first_row = field_2_first_row;\n\u00a0\u00a0\u00a0\u00a0\u00a0 rec.field_3_last_row_add1 = field_3_last_row_add1;\n\u00a0\u00a0\u00a0\u00a0\u00a0 rec.field_4_zero = field_4_zero;\n\u00a0\u00a0\u00a0\u00a0\u00a0 rec.field_5_dbcells = new IntList();\n\u00a0\u00a0\u00a0\u00a0\u00a0 rec.field_5_dbcells.addAll(field_5_db_cells);\n\u00a0\u00a0\u00a0\u00a0\u00a0 return rec;\n\u00a0\u00a0\u00a0 }\n\nIs that the best/easiest way to clone a record, It looks like it to me.\n\nThe problem lies with the code that has been automatically generated. I will \nignore the automatically generated records at the moment but in due course \nsomeone may need to update the code that generated these to provide a deep \nclone method.\n\nThanks\nJason\n\n", "is_private": false, "id": 22002, "creator": "jheight@apache.org", "time": "2002-08-29T22:37:08Z", "bug_id": 11721, "creation_time": "2002-08-29T22:37:08Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "jheight@apache.org", "is_private": false, "id": 22152, "creation_time": "2002-09-03T10:52:18Z", "time": "2002-09-03T10:52:18Z", "bug_id": 11721, "text": "Created attachment 2900\nPatch to add clone support for sheets", "attachment_id": 2900}, {"count": 3, "tags": [], "text": "Ok i have attached a patch that provided clone support for sheets. I havent\nimplemented clone methods for ALL records (but on the simple sheets that i tried\nit didnt fail). I think that i have the most of them but graphing records will\nNOT have clone implemented since these records are automatically generated. I\ndont know what to do about these, are these Glen's resposibility???\n\nIt is very easy to implement the clone methods. I feel a bit of a loozer for\nadding myself to the list of authors for so many files, for such little changes...\n\nJason Height", "is_private": false, "bug_id": 11721, "id": 22153, "time": "2002-09-03T10:56:02Z", "creator": "jheight@apache.org", "creation_time": "2002-09-03T10:56:02Z", "attachment_id": null}, {"count": 4, "attachment_id": null, "bug_id": 11721, "is_private": false, "id": 22154, "time": "2002-09-03T11:28:52Z", "creator": "glens@apache.org", "creation_time": "2002-09-03T11:28:52Z", "tags": [], "text": "Anyones free to modify the record generator.  Don't let me stop you.  If you'd\nrather I do it I'd be happy to... I just have extremely thin bandwidth at the\nmoment as I'm working a day job and a night job so I can't give any timeframes\nfor getting it done."}, {"count": 5, "attachment_id": null, "bug_id": 11721, "is_private": false, "id": 22166, "time": "2002-09-03T14:13:14Z", "creator": "poi-support@buni.org", "creation_time": "2002-09-03T14:13:14Z", "tags": [], "text": "don't feel bad about adding your name to all those files!  It helps POI and you\nwhen your name is added.  (At least I think it does).. .  I'll look at\nthis/apply this *soon*.  (Sorry I didn't look at it before really...  I couldn't\nget the attachment out and patched/etc...  Here I can."}, {"count": 6, "tags": [], "text": "Created attachment 2910\nPatch that add the clone support to graphing records and the record generator", "is_private": false, "bug_id": 11721, "id": 22220, "time": "2002-09-04T04:05:06Z", "creator": "jheight@apache.org", "creation_time": "2002-09-04T04:05:06Z", "attachment_id": 2910}, {"count": 7, "tags": [], "creator": "jheight@apache.org", "text": "Both patches need to be applied. The first patch is for the majority of records,\nthe second patch is only for the graphing records and the record generator.\n\nJason", "id": 22221, "time": "2002-09-04T04:06:34Z", "bug_id": 11721, "creation_time": "2002-09-04T04:06:34Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 11721, "text": "It failed...  The EqualPtg I understand cause I just added that...but I'm at a\nloss as far as the textobjectrecord error.\n\n\ncompile:\nCompiling project core with Java 1.4, debug on, optimize off, deprecation on\nCompiling 282 source files to\n/mnt/u03/home/andyext/jakarta/formula/jakarta-poi/build/classes\n/mnt/u03/home/andyext/jakarta/formula/jakarta-poi/build/java/org/apache/poi/hssf/record/formula/EqualPtg.java:72:\norg.apache.poi.hssf.record.formula.EqualPtg should be declared abstract; it does\nnot define clone() in org.apache.poi.hssf.record.formula.Ptg\npublic class EqualPtg\n       ^\n/mnt/u03/home/andyext/jakarta/formula/jakarta-poi/build/java/org/apache/poi/hssf/record/RecordFactory.java:112:\ncannot resolve symbol\nsymbol  : class TextObjectRecord  \nlocation: class org.apache.poi.hssf.record.RecordFactory\n                PaletteRecord.class, StringRecord.class, TextObjectRecord.class\n                                                         ^\n/mnt/u03/home/andyext/jakarta/formula/jakarta-poi/build/java/org/apache/poi/hssf/record/RecordFactory.java:143:\ncannot resolve symbol\nsymbol  : class TextObjectRecord  \nlocation: class org.apache.poi.hssf.record.RecordFactory\n                PaletteRecord.class, StringRecord.class, TextObjectRecord.class\n                                                         ^\n3 errors\n\nBUILD FAILED\n/mnt/u03/home/andyext/jakarta/formula/jakarta-poi/tools/cents/centipede.cent/xbuild.xml:28:\nCompile failed; see the compiler error output for details.\n\n", "id": 22303, "time": "2002-09-05T00:17:46Z", "creator": "poi-support@buni.org", "creation_time": "2002-09-05T00:17:46Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 11721, "text": "Dang!\n\nI accidentently left in my refernces to the text object record which i have \nbeen experimenting with. I went through the patch and deleted some references \nbut didnt catch them all.\n\nIs it easier for you to edit the RecordFactory and remove the references or for \nme to resubmit the patches?\n\nJason", "id": 22304, "time": "2002-09-05T00:21:13Z", "creator": "jheight@apache.org", "creation_time": "2002-09-05T00:21:13Z", "is_private": false, "attachment_id": null}, {"count": 10, "attachment_id": null, "bug_id": 11721, "is_private": false, "id": 22305, "time": "2002-09-05T00:27:37Z", "creator": "poi-support@buni.org", "creation_time": "2002-09-05T00:27:37Z", "tags": [], "text": "It failed...  The EqualPtg I understand cause I just added that...but I'm at a\nloss as far as the textobjectrecord error.\n\nIt looks like this patch added it.  I fixed both things the EqualPtg returns a\nnew one, and dropped the textobjectrecord from the recordfactory (assuming thats\nyour next patch ;-) )\n\npatch applied. please crosscheck.\n\ncompile:\nCompiling project core with Java 1.4, debug on, optimize off, deprecation on\nCompiling 282 source files to\n/mnt/u03/home/andyext/jakarta/formula/jakarta-poi/build/classes\n/mnt/u03/home/andyext/jakarta/formula/jakarta-poi/build/java/org/apache/poi/hssf/record/formula/EqualPtg.java:72:\norg.apache.poi.hssf.record.formula.EqualPtg should be declared abstract; it does\nnot define clone() in org.apache.poi.hssf.record.formula.Ptg\npublic class EqualPtg\n       ^\n/mnt/u03/home/andyext/jakarta/formula/jakarta-poi/build/java/org/apache/poi/hssf/record/RecordFactory.java:112:\ncannot resolve symbol\nsymbol  : class TextObjectRecord  \nlocation: class org.apache.poi.hssf.record.RecordFactory\n                PaletteRecord.class, StringRecord.class, TextObjectRecord.class\n                                                         ^\n/mnt/u03/home/andyext/jakarta/formula/jakarta-poi/build/java/org/apache/poi/hssf/record/RecordFactory.java:143:\ncannot resolve symbol\nsymbol  : class TextObjectRecord  \nlocation: class org.apache.poi.hssf.record.RecordFactory\n                PaletteRecord.class, StringRecord.class, TextObjectRecord.class\n                                                         ^\n3 errors\n\nBUILD FAILED\n/mnt/u03/home/andyext/jakarta/formula/jakarta-poi/tools/cents/centipede.cent/xbuild.xml:28:\nCompile failed; see the compiler error output for details."}, {"attachment_id": null, "tags": [], "creator": "jheight@apache.org", "text": "YES my patch would have removed those references to the TextObjectRecord. \n\nI have cross checked and it is OK.\n\nJason", "count": 11, "id": 22307, "time": "2002-09-05T01:06:09Z", "bug_id": 11721, "creation_time": "2002-09-05T01:06:09Z", "is_private": false}]