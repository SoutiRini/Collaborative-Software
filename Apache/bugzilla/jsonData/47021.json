[{"count": 0, "attachment_id": null, "bug_id": 47021, "is_private": false, "id": 126210, "time": "2009-04-14T01:31:13Z", "creator": "kaigai@ak.jp.nec.com", "creation_time": "2009-04-14T01:31:13Z", "tags": [], "text": "We intend to execute web-applications under the restrictive privileges (necessary minimum, if possible) to prevent system resources are unexpectedly accessed using buggy web-applications.\n\nThe new MPM (security) spawns a one-time process for each connection, and it gives third-party modules a chance to assign individual privileges prior to invocation of content handlers.\n\nThe existing MPM reuses a process or thread to handle multiple requests more than once. It gives us benefit from the perspective of performance, but it also gives us a headache issue. Some of enhanced security mechanism (such as SELinux) does not allow processes to revert its privileges, even if it is dynamically changed, so it means we cannot reuse a process which already handled a request at least.\n\nThe mod_selinux is a proof of concept. It assigns individual security context (privileges in SELinux) based on the result of http-authentication, prior to the invocation of web-application but after the authentication.\n\nThe MPM is implemented based on the prefork with a bit of hacks.\n\n- httpd-mpm_security-copied.090414.patch\n  It is just a copy from prefork/ to security/.\n- httpd-mpm_security-modified.090414.patch\n  It is a differences from the original prefork.\n- httpd-mod_selinux.090414.patch\n  It is the implementation of mod_selinux module"}, {"count": 1, "attachment_id": 23484, "bug_id": 47021, "text": "Created attachment 23484\nJust a copy from prefork to security", "id": 126211, "time": "2009-04-14T01:31:58Z", "creator": "kaigai@ak.jp.nec.com", "creation_time": "2009-04-14T01:31:58Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "kaigai@ak.jp.nec.com", "attachment_id": 23485, "is_private": false, "id": 126212, "time": "2009-04-14T01:32:32Z", "bug_id": 47021, "creation_time": "2009-04-14T01:32:32Z", "text": "Created attachment 23485\nDifferences from the original prefork"}, {"count": 3, "tags": [], "bug_id": 47021, "is_private": false, "text": "Created attachment 23486\nA module to assign SELinux's security context", "id": 126213, "time": "2009-04-14T01:33:27Z", "creator": "kaigai@ak.jp.nec.com", "creation_time": "2009-04-14T01:33:27Z", "attachment_id": 23486}, {"count": 4, "tags": [], "bug_id": 47021, "attachment_id": null, "text": "Any chance mod_selinux could assign privileges based on virtual-host, instead of (or in-addition to) http-authentication ?\n\nThat would make it very interesting for for web-hosting, where you can give guest_t logins to your users, and only let them edit/see their own virtual-host's DocumentRoot both for ssh-sessjons and web-sessions.", "id": 126216, "time": "2009-04-14T02:07:03Z", "creator": "janfrode@tanso.net", "creation_time": "2009-04-14T02:07:03Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 47021, "is_private": false, "text": "(In reply to comment #4)\n> Any chance mod_selinux could assign privileges based on virtual-host, instead\n> of (or in-addition to) http-authentication ?\n\nThe mod_selinux.so provide the following two configuration parameters:\n- selinuxConfigFile\n It specifies the filename which defines associations between\n http-authentication and domain/range of SELinux.\n\n- selinuxDefaultDomain\n It specifies the fallback domain/range of SELinux, when we have no\n configuration file or no matched entry.\n\nIf you put only selinuxDefaultDomain within virtual host definition,\nit means we can assign a certain security context per virtual host.\n\n> That would make it very interesting for for web-hosting, where you can give\n> guest_t logins to your users, and only let them edit/see their own\n> virtual-host's DocumentRoot both for ssh-sessjons and web-sessions.\n\nI also think it is worthful and interesting use-case.\n(Needless to say, it also need some reworks for security policy.)", "id": 126229, "time": "2009-04-14T07:00:30Z", "creator": "kaigai@ak.jp.nec.com", "creation_time": "2009-04-14T07:00:30Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 47021, "attachment_id": null, "text": "It can be achieved in another approach.\n\nSee the mod_selinux.so at:\n  http://code.google.com/p/sepgsql/wiki/Apache_SELinux_plus", "id": 127540, "time": "2009-06-01T16:34:58Z", "creator": "kaigai@ak.jp.nec.com", "creation_time": "2009-06-01T16:34:58Z", "is_private": false}]