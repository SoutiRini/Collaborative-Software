[{"count": 0, "attachment_id": 21940, "bug_id": 44958, "text": "Created attachment 21940\nExcel Spreadsheet Containing Data Tables\n\nUsing the HSSFWorkbook(InputStream) constructor with the attached excel spreadsheet (containing data tables) yields:\n\nWARN. Unread 170 bytes of record 0x1b8\nException in thread \"main\" org.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:208)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:126)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:226)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:168)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:278)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:259)\n\tat HSSFTest.main(HSSFTest.java:29)\nCaused by: java.lang.reflect.InvocationTargetException\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:494)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:196)\n\t... 6 more\nCaused by: org.apache.poi.hssf.record.RecordFormatException: java.lang.UnsupportedOperationException:  Unknown Ptg in Formula: 0x2 (2)\n\tat org.apache.poi.hssf.record.FormulaRecord.fillFields(FormulaRecord.java:109)\n\tat org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n\tat org.apache.poi.hssf.record.FormulaRecord.<init>(FormulaRecord.java:89)\n\t... 11 more\nCaused by: java.lang.UnsupportedOperationException:  Unknown Ptg in Formula: 0x2 (2)\n\tat org.apache.poi.hssf.record.formula.Ptg.createPtg(Ptg.java:361)\n\tat org.apache.poi.hssf.record.formula.Ptg.createParsedExpressionTokens(Ptg.java:98)\n\tat org.apache.poi.hssf.record.FormulaRecord.fillFields(FormulaRecord.java:107)\n\t... 13 more\n\n\n\n\nI found this as well:\n\nptgTbl - data table (ptg = 0x02)\n  This ptg indicates a data table.  It only occurs in a FORMULA record,\n  never in an ARRAY or NAME record.  When ptgTbl occurs in a formula,\n  it is the only token in the formula.  This indicates that the cell\n  containing the formula is an interior cell in a data table; the table\n  description is found in a TABLE record. Rows and columns which\n  contain input values to be substituted in the table do not contain\n  ptgTbl.\n\n  The token value for ptgTbl consists of the row and column of the\n  upper left corner of the table's interior.\n\n  Offset  Name    Size Contents\n  ------  ----    ---- --------\n  0   rwFirst  2  row number of upper left corner\n  2   colFirst 1  column number of upper left corner", "id": 116406, "time": "2008-05-08T23:44:51Z", "creator": "brandon@enspire.com", "creation_time": "2008-05-08T23:44:51Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 44958, "attachment_id": null, "id": 118598, "time": "2008-07-13T05:38:30Z", "creator": "apache@gagravarr.org", "creation_time": "2008-07-13T05:38:30Z", "is_private": false, "text": "I've added support for the ptg, and some basic support for the TableRecord, to svn trunk.\n\nHowever, there's no support yet for tables or arrays in the formula parser, or for tieing table records and formula records together in the usermodel, so you won't be able to do that much with these formulas yet"}, {"count": 2, "tags": [], "bug_id": 44958, "attachment_id": null, "id": 120233, "time": "2008-08-30T21:52:55Z", "creator": "josh@apache.org", "creation_time": "2008-08-30T21:52:55Z", "is_private": false, "text": "Some more progress as of svn r690636.\n\nPOI now does round trip re-serialization of workbooks with ArrayRecords and/or TableRecords without introducing errors.\n\nHowever, POI is still not able to create/edit Array or Table formulas. \n"}]