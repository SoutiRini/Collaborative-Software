[{"count": 0, "tags": [], "creator": "apache.org@spam.ennes.nl", "text": "Created attachment 25512\nExample script\n\nRunning the same script file twice, only with different character set in the shell environment leads to different results:\n\n$ LANG=en_GB.utf8 jmeter -n -t embedded-encoding.jmx -l embedded-encoding-utf8.jtl\n\n<httpSample t=\"338\" lt=\"308\" ts=\"1275556867434\" s=\"true\" lb=\"http://www.rnw.nl/data/files/imagecache/list/images/lead/teaser%20Pygmalion%20\u00a9%20Julietta%20Cervantes.jpg\" rc=\"200\" rm=\"OK\" tn=\"Thread Group 1-1\" dt=\"bin\" by=\"6868\"/>\n\n$ LANG=en_GB.iso-8859-1 jmeter -n -t embedded-encoding.jmx -l embedded-encoding-iso88591.jtl\n\n<httpSample t=\"954\" lt=\"0\" ts=\"1275556913357\" s=\"false\" lb=\"http://www.rnw.nl/data/files/imagecache/list/images/lead/teaser%20Pygmalion%20\ufffd\ufffd%20Julietta%20Cervantes.jpg\" rc=\"404\" rm=\"Not Found\" tn=\"Thread Group 1-1\" dt=\"text\" by=\"0\"/>\n\n(Note the encoding of the copyright sign)\n\nIt seems that the URLs of the downloaded embedded resources are constructed using the shell's environment. I would expect the containing/parent page character set should be used instead.\n\nScripts and results are attached...", "id": 137293, "time": "2010-06-03T05:27:57Z", "bug_id": 49374, "creation_time": "2010-06-03T05:27:57Z", "is_private": false, "attachment_id": 25512}, {"count": 1, "tags": [], "bug_id": 49374, "attachment_id": 25513, "id": 137294, "time": "2010-06-03T05:28:43Z", "creator": "apache.org@spam.ennes.nl", "creation_time": "2010-06-03T05:28:43Z", "is_private": false, "text": "Created attachment 25513\nOutput UTF-8"}, {"count": 2, "tags": [], "text": "Created attachment 25514\nOutput ISO-8859-1", "attachment_id": 25514, "bug_id": 49374, "id": 137295, "time": "2010-06-03T05:29:14Z", "creator": "apache.org@spam.ennes.nl", "creation_time": "2010-06-03T05:29:14Z", "is_private": false}, {"count": 3, "tags": [], "text": "I don't get the same problem, but it looks like the page has probably changed.\n\nIf you get the same problem with another page, please save the original page contents using the Save Response to File Listener, and attach that here.", "attachment_id": null, "bug_id": 49374, "id": 137375, "time": "2010-06-05T18:03:21Z", "creator": "sebb@apache.org", "creation_time": "2010-06-05T18:03:21Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 49374, "attachment_id": 25532, "text": "Created attachment 25532\nContent ISO-8859-1\n\nThat seems to lead to identical files for both charsets. (So, I'm only attaching one)", "id": 137378, "time": "2010-06-06T07:36:03Z", "creator": "apache.org@spam.ennes.nl", "creation_time": "2010-06-06T07:36:03Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 49374, "attachment_id": null, "text": "Sorry, forgot to mention that currently it can be reproduced by changing the path in the script to:\n\nhttp://www.rnw.nl/english/rnw_fp?page=3\n\nAnd at some point this will go to page=4 etc...", "id": 137379, "time": "2010-06-06T07:37:43Z", "creator": "apache.org@spam.ennes.nl", "creation_time": "2010-06-06T07:37:43Z", "is_private": false}, {"count": 6, "attachment_id": null, "bug_id": 49374, "is_private": false, "id": 137380, "time": "2010-06-06T08:37:00Z", "creator": "sebb@apache.org", "creation_time": "2010-06-06T08:37:00Z", "tags": [], "text": "Using page=3 loads the image OK for me when I use file.encoding=iso-8859-1, although the request display and JTL output is not correct.\n\nIf I use file.encoding=iso (invalid) then JMeter 2.3.4 does fail to load the page.\n\nCan you provide the first few lines of the jmeter.log files, upto at least\njmeter.JMeter: JMeterHome ?"}, {"count": 7, "tags": [], "bug_id": 49374, "text": "Running with:\n\n$ LANG=en_GB.UTF-8 jmeter\n\n2010/06/06 14:41:32 INFO  - jmeter.util.JMeterUtils: Setting Locale to en_GB \n2010/06/06 14:41:32 INFO  - jmeter.JMeter: Copyright (c) 1998-2009 The Apache Software Foundation \n2010/06/06 14:41:32 INFO  - jmeter.JMeter: Version 2.3.4 \n2010/06/06 14:41:32 INFO  - jmeter.JMeter: java.version=1.6.0_18 \n2010/06/06 14:41:32 INFO  - jmeter.JMeter: java.vm.name=OpenJDK 64-Bit Server VM \n2010/06/06 14:41:32 INFO  - jmeter.JMeter: os.name=Linux \n2010/06/06 14:41:32 INFO  - jmeter.JMeter: os.arch=amd64 \n2010/06/06 14:41:32 INFO  - jmeter.JMeter: os.version=2.6.32-22-generic \n2010/06/06 14:41:32 INFO  - jmeter.JMeter: file.encoding=UTF-8 \n2010/06/06 14:41:32 INFO  - jmeter.JMeter: Default Locale=English (United Kingdom) \n2010/06/06 14:41:32 INFO  - jmeter.JMeter: JMeter  Locale=English (United Kingdom) \n2010/06/06 14:41:32 INFO  - jmeter.JMeter: JMeterHome=/usr/share/jmeter \n\nAnd both of:\n$ LANG=en_GB.ISO-8859-1 jmeter\n$ LANG=iso-8859-1 jmeter\n\ngive:\n2010/06/06 14:43:12 INFO  - jmeter.util.JMeterUtils: Setting Locale to en_US \n2010/06/06 14:43:12 INFO  - jmeter.JMeter: Copyright (c) 1998-2009 The Apache Software Foundation \n2010/06/06 14:43:12 INFO  - jmeter.JMeter: Version 2.3.4 \n2010/06/06 14:43:12 INFO  - jmeter.JMeter: java.version=1.6.0_18 \n2010/06/06 14:43:12 INFO  - jmeter.JMeter: java.vm.name=OpenJDK 64-Bit Server VM \n2010/06/06 14:43:12 INFO  - jmeter.JMeter: os.name=Linux \n2010/06/06 14:43:12 INFO  - jmeter.JMeter: os.arch=amd64 \n2010/06/06 14:43:12 INFO  - jmeter.JMeter: os.version=2.6.32-22-generic \n2010/06/06 14:43:12 INFO  - jmeter.JMeter: file.encoding=ANSI_X3.4-1968 \n2010/06/06 14:43:12 INFO  - jmeter.JMeter: Default Locale=English (United States) \n2010/06/06 14:43:12 INFO  - jmeter.JMeter: JMeter  Locale=English (United States) \n2010/06/06 14:43:12 INFO  - jmeter.JMeter: JMeterHome=/usr/share/jmeter", "id": 137381, "time": "2010-06-06T09:47:21Z", "creator": "apache.org@spam.ennes.nl", "creation_time": "2010-06-06T09:47:21Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 49374, "attachment_id": null, "id": 152444, "time": "2011-12-28T14:02:53Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2011-12-28T14:02:53Z", "is_private": false, "text": "Issue is in HtmlParserHTMLParser#getEmbeddedResourceURLs in following code:\nString contents = new String(html); \n\nUsing this code, file.encoding of platform is used instead of page encoding.\n\n\nBy the way, to reproduce issue , I just put :\n-Dfile.encoding=ANSI_X3.4-1968 \n\nI don't reproduce it by changing LANG variable because it does not lead to same encoding as bug reporter's one."}, {"count": 9, "attachment_id": null, "bug_id": 49374, "text": "Should we use:\nSampleResult#getDataEncoding ?\nAnd if null, default to \"sampleresult.default.encoding\" jmeter property ?", "id": 152445, "time": "2011-12-28T14:07:51Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2011-12-28T14:07:51Z", "tags": [], "is_private": false}, {"count": 10, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "attachment_id": null, "id": 152446, "creation_time": "2011-12-28T14:34:37Z", "time": "2011-12-28T14:34:37Z", "bug_id": 49374, "text": "Date: Wed Dec 28 14:33:41 2011\nNew Revision: 1225193\n\nURL: http://svn.apache.org/viewvc?rev=1225193&view=rev\nLog:\nBug 49374 - Encoding of embedded element URLs depend on the file.encoding property\nNow using SampleResult#getDataEncodingWithDefault() to avoid relying on file.encoding of the JVM.\nModified HTMLParserTestFile_2.xml to take into account the impact of encoding change.\n\nModified:\n   jmeter/trunk/bin/testfiles/HTMLParserTestFile_2.xml\n   jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/parser/HTMLParser.java\n   jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/parser/HtmlParserHTMLParser.java\n   jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/parser/JTidyHTMLParser.java\n   jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/parser/RegexpHTMLParser.java\n   jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/sampler/HTTPSamplerBase.java\n   jmeter/trunk/test/src/org/apache/jmeter/protocol/http/parser/TestHTMLParser.java\n   jmeter/trunk/xdocs/changes.xml", "is_private": false}]