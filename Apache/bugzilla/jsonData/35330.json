[{"count": 0, "tags": [], "text": "When allowing Options in <Directory>, and setting Options in the .htaccess, server complains that Options isn't allowed.  This bug seems to be around since the AllowOverrideOpt patch BugID#29310: http://issues.apache.org/bugzilla/show_bug.cgi?id=29310  Following patch fixes the problem, but AllowOverride concerns security; through audit around handling of opts->override, opts->override_opts is requested.  ==== Example:   httpd.conf: <Directory /usr/local/www> \tAllowOverride All </Directory>  /usr/local/www/.htaccess: Options +ExecCGI  error_log output: [Sun Jun 12 03:38:23 2005] [alert] [client ::1] /usr/local/www/.htaccess: Option ExecCGI not allowed here   ==== PATCH: diff -aru httpd-2.1.3-beta.orig/server/request.c httpd-2.1.3-beta/server/request.c --- httpd-2.1.3-beta.orig/server/request.c\tFri Feb 11 21:00:41 2005 +++ httpd-2.1.3-beta/server/request.c\tSun Jun 12 06:10:35 2005 @@ -443,10 +443,26 @@          opts->remove = this_dir->opts_remove;      }   +#if 0      if (!(this_dir->override & OR_UNSET)) {          opts->override = this_dir->override;      }      if (!(this_dir->override_opts & OR_UNSET)) { +/* this is wrong; + * 1) ->override_opts will take OPT_* masks, not OR_* + * 2) Resetting current ->override_opts (effective AllowOverride Options=....) + *    should occur when AllowOveride (both w or w/o Options) was specified  + *    for this dir. + *    Not saying Options in AllowOverride shouldn't mean to  + *    preserve and propagate the Options= setting. + * Because of this, \"<Directory>AllowOverride All\" still says + * Options in .htaccess not allowed. + */ +        opts->override_opts = this_dir->override_opts; +    } +#endif +    if (!(this_dir->override & OR_UNSET)) { +        opts->override = this_dir->override;          opts->override_opts = this_dir->override_opts;      }  }", "is_private": false, "id": 76310, "creator": "kabe@sra-tohoku.co.jp", "time": "2005-06-12T00:13:00Z", "bug_id": 35330, "creation_time": "2005-06-12T00:13:00Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 35330, "text": "*** Bug 35329 has been marked as a duplicate of this bug. ***", "id": 76312, "attachment_id": null, "creator": "kabe@sra-tohoku.co.jp", "creation_time": "2005-06-12T00:16:56Z", "time": "2005-06-12T00:16:56Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 35330, "attachment_id": null, "text": "We now have a 'regression' severity in Bugzilla. Removed the keyword. ", "id": 80129, "time": "2005-09-19T21:47:51Z", "creator": "sander@temme.net", "creation_time": "2005-09-19T21:47:51Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 35330, "text": "Thanks a lot for the patch (attaching it might have avoided the line-wrapping ;).\nThis has been applied for 2.1.8.\n\nhttp://svn.apache.org/viewcvs?rev=291125&view=rev", "id": 80378, "time": "2005-09-23T16:29:46Z", "creator": "jorton@redhat.com", "creation_time": "2005-09-23T16:29:46Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 35330, "text": "Reclassed to delete a version", "id": 135500, "attachment_id": null, "creator": "wrowe@apache.org", "creation_time": "2010-03-22T05:58:45Z", "time": "2010-03-22T05:58:45Z", "is_private": false}]