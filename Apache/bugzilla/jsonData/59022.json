[{"count": 0, "tags": [], "bug_id": 59022, "text": "Hello all,\n\nI'm running HTTPd 2.4.18 with mod_http2 and the nghttp2/1.7.1-DEV library and I don't see out/in bytes in my access log.\n\nExample:\n91.xx.xx.xx - - [17/Feb/2016:19:30:51 +0100] \"GET /dl/video.mp4 HTTP/2\" 200 0 \"-\" \"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/48.0.2564.103 Safari/537.36\"\n\nExpected:\n91.xx.xx.xx - - [17/Feb/2016:19:30:51 +0100] \"GET /dl/video.mp4 HTTP/2\" 200 1487172116 \"-\" \"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/48.0.2564.103 Safari/537.36\"\n\nI'm using mod_logio's %O and %I to get the actual bytes sent and received and using HTTP/2 over SSL. \nHTTPd is build by me from source running on Debian 8.\n\nConfigure command:\n./configure \\\n        --with-libxml2 \\\n        --enable-so \\\n        --enable-dav \\\n        --enable-dav-fs \\\n        --enable-dav-lock \\\n        --enable-suexec \\\n        --enable-deflate \\\n        --enable-unique-id \\\n        --enable-mods-static=most \\\n        --enable-mpms-shared=all \\\n        --enable-reqtimeout \\\n        --with-mpm=event \\\n        --with-included-apr \\\n        --with-pcre=/usr/bin/pcre-config \\\n        --enable-logio \\\n        --enable-ssl \\\n        --with-ssl=/usr/local \\\n        --enable-rewrite \\\n        --enable-proxy \\\n        --enable-expires \\\n        --enable-headers \\\n        --enable-mpms-shared=all \\\n        --disable-cgi \\\n        --disable-cgid \\\n        --enable-mime-magic \\\n        --enable-http2\n\nPlease let me know if you need more information.\n\nRegards,\nDaan", "id": 188525, "time": "2016-02-17T20:54:49Z", "creator": "daan@vgis.nl", "creation_time": "2016-02-17T20:54:49Z", "is_private": false, "attachment_id": null}, {"count": 1, "attachment_id": null, "bug_id": 59022, "is_private": false, "id": 188526, "time": "2016-02-17T20:56:35Z", "creator": "daan@vgis.nl", "creation_time": "2016-02-17T20:56:35Z", "tags": [], "text": "Forgot to say that I can retrieve the file without issues and the response headers are correct:\n\naccept-ranges:bytes\ncontent-length:1456061558\ncontent-type:video/mp4\ndate:Wed, 17 Feb 2016 20:37:57 GMT\netag:\"56c9bc76-52bfb4b8ef900\"\nlast-modified:Wed, 17 Feb 2016 18:19:48 GMT\nserver:Apache\nstatus:200"}, {"count": 2, "tags": [], "bug_id": 59022, "attachment_id": null, "text": "Daan, you are correct. That issue has been identified in the meantime and a fix is available from the modules github page (https://github.com/icing/mod_h2) which lets you build a replacement module using an installed 2.4.18 apxs.\n\nThis will also make it into the next 2.4.x release, but has not landed in the subversion 2.4.x branch yet due to other dependencies.\n\nHope this works for you. Stefan", "id": 188954, "time": "2016-02-29T12:03:26Z", "creator": "stefan@eissing.org", "creation_time": "2016-02-29T12:03:26Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 59022, "attachment_id": null, "text": "Hello Stefan,\n\nThanks for the follow up!\n\nI've rebuild httpd 2.4.18 without mod_h[ttp]2 support and build mod_h[ttp]2 shared using the httpd 2.4.18 apxs but I still have empty bytes.\nI used the master branch from that git repo. Am I missing something? I don't see any commits regarding this issue.\n\nInfo:\n# strings /usr/local/httpd24/modules/mod_http2.so | grep mod_http2_version -B1\n1.2.6\n  \"mod_http2_version\": \"%s\",\n\n# /usr/local/httpd24/bin/apachectl -M | grep http2\n http2_module (shared)\n\n\nAccess logs (IPv4/6):\n85.X.X.X - - [29/Feb/2016:14:09:10 +0100] \"GET /wp-content/plugins/youtube-live-stream-auto-embed/assets/css/youtube-live-style.css HTTP/2\" 200 0 \"-\" \"curl/7.47.1\"\n2001:X:X:X:X - - [29/Feb/2016:14:09:21 +0100] \"GET /wp-content/plugins/youtube-live-stream-auto-embed/assets/css/youtube-live-style.css HTTP/2\" 200 0 \"-\" \"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/48.0.2564.109 Safari/537.36\"\n\nThanks!\n\nDaan", "id": 188959, "time": "2016-02-29T13:13:44Z", "creator": "daan@vgis.nl", "creation_time": "2016-02-29T13:13:44Z", "is_private": false}, {"count": 4, "attachment_id": null, "bug_id": 59022, "text": "Ah, my bad. That fix was done only in httpd trunk and did not make it into the github version - until now.\n\nIf you pull master again, you should get the fix. Hope this works for you and sorry about the confusion.", "id": 188962, "time": "2016-02-29T13:35:38Z", "creator": "stefan@eissing.org", "creation_time": "2016-02-29T13:35:38Z", "tags": [], "is_private": false}, {"count": 5, "attachment_id": null, "bug_id": 59022, "text": "Thanks! Works perfect:\n\n85.X.X.X - - [29/Feb/2016:14:46:10 +0100] \"GET /wp-content/plugins/youtube-live-stream-auto-embed/assets/css/youtube-live-style.css HTTP/2\" 200 610 \"-\" \"curl/7.47.1\"\n2001:X:X:X:X - - [29/Feb/2016:14:47:25 +0100] \"GET /wp-content/plugins/youtube-live-stream-auto-embed/assets/css/youtube-live-style.css HTTP/2\" 200 610 \"-\" \"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/48.0.2564.109 Safari/537.36\"\n\n# strings /usr/local/httpd24/modules/mod_http2.so | grep mod_http2_version -B1\n1.2.7\n  \"mod_http2_version\": \"%s\",\n\nI'll mark this as resolved, thanks for your support!", "id": 188964, "time": "2016-02-29T13:53:21Z", "creator": "daan@vgis.nl", "creation_time": "2016-02-29T13:53:21Z", "tags": [], "is_private": false}]