[{"count": 0, "attachment_id": null, "creator": "johnjaylward@yahoo.com", "text": "java.lang.NullPointerException\n\n    at java.lang.String.<init>(String.java:83) at\n\norg.apache.poi.hssf.usermodel.HSSFSheet.autoSizeColumn(HSSFSheet.java:1468)\n\n    at", "id": 112883, "time": "2008-01-15T10:45:44Z", "bug_id": 44246, "creation_time": "2008-01-15T10:45:44Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "text": "Could you upload the problem xls file? \n\nYegor", "is_private": false, "bug_id": 44246, "id": 112893, "time": "2008-01-15T23:03:22Z", "creator": "yegor@dinom.ru", "creation_time": "2008-01-15T23:03:22Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 44246, "is_private": false, "id": 112909, "creation_time": "2008-01-16T06:12:03Z", "time": "2008-01-16T06:12:03Z", "creator": "johnjaylward@yahoo.com", "text": "no, it contains client financial data. I'm not sure I could anonymize it without\nchanging the result. I think the problem may be that some of the data that is\npulled back is null valued, and I'm setting that to the xls cell, but I'm unsure.", "attachment_id": null}, {"count": 3, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "is_private": false, "id": 112910, "time": "2008-01-16T06:50:35Z", "bug_id": 44246, "creation_time": "2008-01-16T06:50:35Z", "text": "Unfortunately, without the excel file, it's going to be pretty difficult for us\nto fix, and certainly almost impossible to write tests so we can be sure we\ndon't regress the issue at a later date\n\nIf you load the file up in poi, save it, and load it up again, do you still get\nthe same null pointer? If so, you could just try running through changing all\nthe strings to one value, and all the numbers to another, and checking that\nstill gives the problem"}, {"count": 4, "tags": [], "bug_id": 44246, "text": "1. Please try the latest POI-3.0.2-BETA2. \n2. If the error persists, provide the full stack trace. In the latest version of\nPOI HSSFSheet.autoSizeColumn starts at line 1632 so I can't even see where it is\nhappening.\n3. Is anything special about your xls? Is it Excel-generated or imported from\nOpenOffice? Give us any possible hints. \n\nRegards,\nYegor  \n\n", "id": 112911, "time": "2008-01-16T07:12:07Z", "creator": "yegor@dinom.ru", "creation_time": "2008-01-16T07:12:07Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "text": "1. I can try this, but not sure how soon to get you results. I'll do it asap\n2. I'm using POI-3.0.1FINAL, you should have a tag in the source control you can\nuse to match against the file.\n3. The XLS file is 100% generated using POI, and is not saved to disk until all\nprocessing is finished.", "is_private": false, "bug_id": 44246, "id": 112912, "time": "2008-01-16T08:16:44Z", "creator": "johnjaylward@yahoo.com", "creation_time": "2008-01-16T08:16:44Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 44246, "is_private": false, "id": 112913, "creation_time": "2008-01-16T08:29:44Z", "time": "2008-01-16T08:29:44Z", "creator": "johnjaylward@yahoo.com", "text": "ok, ran with beta 2, same result different line number, although it still\ndoesn't match the one you said the function starts at:\n\njava.lang.NullPointerException\n        at java.lang.String.<init>(String.java:83)\n        at\norg.apache.poi.hssf.usermodel.HSSFSheet.autoSizeColumn(HSSFSheet.java:1625)\n        at\ncom.cicat.bedrock.billing.actions.CustomerInvoiceRegister.createSubSheet(CustomerInvoiceRegister.java:301)\n        at\ncom.cicat.bedrock.billing.actions.CustomerInvoiceRegister.doCreateDataFile(CustomerInvoiceRegister.java:535)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:79)\n        at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:618)\n        at\ncom.opensymphony.xwork.DefaultActionInvocation.invokeAction(DefaultActionInvocation.java:358)\n        at\ncom.opensymphony.xwork.DefaultActionInvocation.invokeActionOnly(DefaultActionInvocation.java:218)\n        at\ncom.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:192)\n        at\ncom.opensymphony.xwork.interceptor.DefaultWorkflowInterceptor.doIntercept(DefaultWorkflowInterceptor.java:175)\n        at\ncom.opensymphony.xwork.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:86)\n        at\ncom.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:190)\n        at\ncom.opensymphony.xwork.validator.ValidationInterceptor.doIntercept(ValidationInterceptor.java:115)\n        at\ncom.opensymphony.xwork.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:86)\n        at\ncom.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:190)\n        at\ncom.cicat.bedrock.core.actions.interceptors.HibernateSession.executeInTransaction(HibernateSession.java:96)\n        at\ncom.cicat.bedrock.core.actions.interceptors.HibernateSession.intercept(HibernateSession.java:151)\n        at\ncom.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:190)\n        at\ncom.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:31)\n        at\ncom.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:190)\n        at\ncom.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:31)\n        at\ncom.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:190)\n        at\ncom.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:31)\n        at\ncom.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:190)\n        at\ncom.opensymphony.webwork.interceptor.FileUploadInterceptor.intercept(FileUploadInterceptor.java:174)\n        at\ncom.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:190)\n        at\ncom.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:31)\n        at\ncom.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:190)\n        at\ncom.opensymphony.webwork.interceptor.debugging.DebuggingInterceptor.intercept(DebuggingInterceptor.java:169)\n        at\ncom.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:190)\n        at\ncom.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:31)\n        at\ncom.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:190)\n        at\ncom.opensymphony.xwork.interceptor.I18nInterceptor.intercept(I18nInterceptor.java:151)\n        at\ncom.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:190)\n        at\ncom.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:31)\n        at\ncom.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:190)\n        at\ncom.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:31)\n        at\ncom.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:190)\n        at\ncom.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:31)\n        at\ncom.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:190)\n        at\ncom.opensymphony.xwork.interceptor.ExceptionMappingInterceptor.intercept(ExceptionMappingInterceptor.java:186)\n        at\ncom.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:190)\n        at\ncom.cicat.bedrock.core.actions.interceptors.CheckLoggedIn.intercept(CheckLoggedIn.java:55)\n        at\ncom.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:190)\n        at\ncom.opensymphony.xwork.DefaultActionProxy.execute(DefaultActionProxy.java:116)\n        at\ncom.opensymphony.webwork.dispatcher.DispatcherUtils.serviceAction(DispatcherUtils.java:273)\n        at\ncom.opensymphony.webwork.dispatcher.ServletDispatcher.service(ServletDispatcher.java:111)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:269)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n        at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\n        at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:174)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:117)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:108)\n        at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:151)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:874)\n        at\norg.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:665)\n        at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:528)\n        at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:81)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:689)\n        at java.lang.Thread.run(Thread.java:810)\n", "attachment_id": null}, {"count": 7, "tags": [], "text": "(In reply to comment #2)\n> I think the problem may be that some of the data that is\n> pulled back is null valued, and I'm setting that to the xls cell, but I'm unsure.\n\nre-looking at my code, I do not set a value for a cell in which my returned DB\ndata is null or an empty string. So it's possible that some cell data in the\nmiddle of a column is in an unset state. i.e.\n\nRow# | Column 1\n1    | test val\n2    |\n3    | test val3\n\nwhere row 2 column 1 has not called cell.setCellValue() before calling\nsheet.autoSizeColumn()\n", "is_private": false, "bug_id": 44246, "id": 112914, "time": "2008-01-16T08:40:13Z", "creator": "johnjaylward@yahoo.com", "creation_time": "2008-01-16T08:40:13Z", "attachment_id": null}, {"count": 8, "tags": [], "text": "I added a check to prevent NPE. \nTry the latest build. You can download it from \nhttp://encore.torchbox.com/poi-svn-build/\n\nRegards,\nYegor", "is_private": false, "bug_id": 44246, "id": 113005, "time": "2008-01-19T06:29:58Z", "creator": "yegor@dinom.ru", "creation_time": "2008-01-19T06:29:58Z", "attachment_id": null}]