[{"count": 0, "tags": [], "text": "I tested this in a unproxied setup using builtin jetty\n\nsite-tab: \n\n- copy document\n-\npaste to itself\n\nNo response from lenya (dead lock...?)\n\nI did NOT try to reproduce this\non the zones server.", "attachment_id": null, "bug_id": 44005, "id": 111321, "time": "2007-12-01T07:06:21Z", "creator": "ragaller@apache.org", "creation_time": "2007-12-01T07:06:21Z", "is_private": false}, {"count": 1, "tags": [], "text": "Created attachment 21221\nStacktrace of problem", "attachment_id": 21221, "bug_id": 44005, "id": 111368, "time": "2007-12-03T07:45:37Z", "creator": "rfrovarp@apache.org", "creation_time": "2007-12-03T07:45:37Z", "is_private": false}, {"count": 2, "tags": [], "text": "It's not a deadlock. It's infinite recursion. DocumentManagerImpl.copyAll is\nwhere it happens.\n\n1) Copy & Paste /concepts\n2) copyAll copies /concepts to /concepts/concepts\n3) copyAll checks children of concepts, which now has concepts as a child\n4) copyAll calls copyAll with /concepts/concepts as source.\n5) Goto 2, but deeper and with more children\n\n", "attachment_id": null, "bug_id": 44005, "id": 111371, "time": "2007-12-03T08:05:12Z", "creator": "rfrovarp@apache.org", "creation_time": "2007-12-03T08:05:12Z", "is_private": false}, {"count": 3, "tags": [], "creator": "rfrovarp@apache.org", "is_private": false, "text": "Made it so that a copied document can't be pasted to itself in r600585. It needs\nthe German translation of the error message I added. ", "id": 111372, "time": "2007-12-03T08:24:37Z", "bug_id": 44005, "creation_time": "2007-12-03T08:24:37Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "andreas@apache.org", "attachment_id": null, "is_private": false, "id": 111373, "time": "2007-12-03T08:39:05Z", "bug_id": 44005, "creation_time": "2007-12-03T08:39:05Z", "text": "(In reply to comment #3)\n> Made it so that a copied document can't be pasted to itself in r600585. It needs\n> the German translation of the error message I added. \n\nDone."}, {"count": 5, "tags": [], "creator": "andreas@apache.org", "attachment_id": null, "is_private": false, "id": 111550, "time": "2007-12-07T13:56:09Z", "bug_id": 44005, "creation_time": "2007-12-07T13:56:09Z", "text": "The problem still occurs if you paste to a child in the own subtree."}, {"count": 6, "tags": [], "creator": "ragaller@apache.org", "attachment_id": null, "is_private": false, "id": 111570, "time": "2007-12-08T02:50:50Z", "bug_id": 44005, "creation_time": "2007-12-08T02:50:50Z", "text": "Confirmed here - copy paste to the own subtree is a relatively common action.\nTo only way to recover I know is a restart of jetty - so this bug is quite serious, I think. "}, {"count": 7, "tags": [], "creator": "ragaller@apache.org", "is_private": false, "text": "Just noticed that by pasting to the subtree of the cut out document the infinite recursion not only blocks the current request but actually creates a very high number of child documents.\n\nI consider this bug a blocker for a 2.0 release.\n\n", "id": 111571, "time": "2007-12-08T02:59:29Z", "bug_id": 44005, "creation_time": "2007-12-08T02:59:29Z", "attachment_id": null}, {"count": 8, "tags": [], "creator": "ragaller@apache.org", "is_private": false, "text": "A workaround for the problem for now would be to block the paste action for pasting in a document's own subtree after copy - see patch. \n\nI think pasting a document to itself or to the own subtree after copy (not after cut) is a legitimate action and should be made possible for 2.0.1.", "id": 111572, "time": "2007-12-08T04:13:41Z", "bug_id": 44005, "creation_time": "2007-12-08T04:13:41Z", "attachment_id": null}, {"count": 9, "attachment_id": 21250, "bug_id": 44005, "is_private": false, "id": 111573, "time": "2007-12-08T04:15:08Z", "creator": "ragaller@apache.org", "creation_time": "2007-12-08T04:15:08Z", "tags": [], "text": "Created attachment 21250\n[PATCH] - disables paste in a documents own subtree."}, {"count": 10, "tags": [], "text": "Fixed in revision 602869.\n\nI didn't apply the patch, but used iteration instead of recursion to avoid the\nerror without disallowing to copy a document to the own subtree.", "is_private": false, "id": 111599, "creator": "andreas@apache.org", "time": "2007-12-10T03:44:13Z", "bug_id": 44005, "creation_time": "2007-12-10T03:44:13Z", "attachment_id": null}]