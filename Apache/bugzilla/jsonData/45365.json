[{"count": 0, "tags": [], "bug_id": 45365, "is_private": false, "text": "Created attachment 22235\nSheet causing Malformed exponential pattern error when converted to csv\n\nUsing v3.1 (20080629) and the code:\nhttp://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/hssf/eventusermodel/examples/XLS2CSVmra.java\nI am converting many excel workbooks each with many (50+ sheets). For one particular workbook I get an exception, java.lang.IllegalArgumentException with message:\nMalformed exponential pattern \"0.00E+00\". Looking at the workbook in question there seems nothing obvious. Looking at XLS2CSVmra.java, it fails on the line in the porocess() method: \nfactory.processWorkbookEvents(request, fs);\nI went though all 84 sheets and narrowed it down to the problem sheet (see attached poi.xls). I can't see what the problem is on this sheet, but it gives the Malformed exponential pattern error every time", "id": 118396, "time": "2008-07-08T12:17:31Z", "creator": "osssoftware@gmail.com", "creation_time": "2008-07-08T12:17:31Z", "attachment_id": 22235}, {"count": 1, "tags": [], "bug_id": 45365, "text": "More crazy excel formatting rules, that java's decimal format doesn't like\n\nFixed in svn trunk", "id": 118490, "time": "2008-07-10T11:41:16Z", "creator": "apache@gagravarr.org", "creation_time": "2008-07-10T11:41:16Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "osssoftware@gmail.com", "attachment_id": 22303, "text": "Created attachment 22303\nSpfreadsheet where defect reoccurs\n\ntested with poi-3.2-alpha1-20080717.jar and defect reoccurred for this attached spreadsheet", "id": 118931, "time": "2008-07-23T04:20:16Z", "bug_id": 45365, "creation_time": "2008-07-23T04:20:16Z", "is_private": false}, {"count": 3, "tags": [], "creator": "osssoftware@gmail.com", "attachment_id": 22390, "text": "Created attachment 22390\nCustomised XLS2CSVmra used to create problem\n\nChanges to downloaded XLS2CSVmra are all wrapped with // TC ADDED. Aside from a package rename the only other changes are confined to some class variable additions & processRecord which use BoundSheetRecord/BOFRecord to output the sheetnames to the csv file.", "id": 119452, "time": "2008-08-05T16:37:57Z", "bug_id": 45365, "creation_time": "2008-08-05T16:37:57Z", "is_private": false}, {"count": 4, "text": "Your version of XLS2CSVmra is quite old, as it isn't using formatListener.formatNumberDateCell to do the number conversion\n\nUpdate to a newer version of XLS2CSVmra and you should be fine", "bug_id": 45365, "attachment_id": null, "id": 119516, "time": "2008-08-06T10:52:59Z", "creator": "apache@gagravarr.org", "creation_time": "2008-08-06T10:52:59Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "bug_id": 45365, "is_private": false, "text": "Confirmation that updating XLS2CSVmra fixed this issue", "id": 120139, "time": "2008-08-27T06:10:58Z", "creator": "osssoftware@gmail.com", "creation_time": "2008-08-27T06:10:58Z", "attachment_id": null}]