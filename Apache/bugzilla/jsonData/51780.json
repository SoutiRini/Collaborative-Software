[{"count": 0, "tags": [], "creator": "seba@xyz.de", "attachment_id": 27465, "id": 149062, "time": "2011-09-07T09:37:08Z", "bug_id": 51780, "creation_time": "2011-09-07T09:37:08Z", "is_private": false, "text": "Created attachment 27465\nWith this patch I am able to change the mimetype.\n\nI can't found a solution with the unmodified poi code for the following problem.\n\nIt should be possible to convert the following templates:\n\n\".dotx\" to \".docx\"\n\".dotm\" to \".docm\"\n\".xltx\" to \"xlsx\"\n\".xltm\" to \".xlsm\"\n\".potx\" to \".pptx\"\n\".potm\" to \".pptm\"\n\n\nI am able to do this after installing the attached patch.\n\nUsage:\nOPCPackage pack = new ZipPackage(stream, PackageAccess.READ_WRITE);\nif (pack != null) {\n  pack.getParts();\n  ArrayList<PackagePart> list = pack.getPartsByContentType(oldContentType);\n  for (PackagePart packagePart : list) {\n    if (packagePart.getContentType().equals(oldContentType)) {\n      PackagePartName partName = packagePart.getPartName();\n      pack.getContenTypeManager().addContentType(partName, newContentType);\n    }\n  }\n  ByteArrayOutputStream outputStream = new ByteArrayOutputStream(1024);\n  pack.save(outputStream);\n  //TODO save as file with the new file extention\n}\n\nPlease include this patch for the next version or implement an other nicer way to change the contenttype."}, {"text": "Replacement of content types supported in r1294998. \n\nThere is a new method  OPCPackage.replaceContentType(String oldType, String newType) that does the job. \n\nUsage:\n \nOPCPackage pkg = OPCPackage.open(new FileInputStream(\"macro-workbook.xlsm\"));\npkg.replaceContentType(\n  \"application/vnd.ms-excel.sheet.macroEnabled.main+xml\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\");\n\n\n  FileOutputStream out = new FileOutputStream(\"workbook.xlsx\");\n  pkg.save(out);\n  out.close();\n\nYegor", "tags": [], "bug_id": 51780, "attachment_id": null, "count": 1, "id": 154350, "time": "2012-02-29T07:55:06Z", "creator": "yegor@dinom.ru", "creation_time": "2012-02-29T07:55:06Z", "is_private": false}]