[{"count": 0, "tags": [], "bug_id": 34993, "text": "I think this behavior violates the Servlet spec (see below).  If I'm reading it\nright, Class-Path entries in the MANIFEST.MF files for *both* WAR files and JAR\nfiles in the WEB-INF/lib must cause the container to reject the application.\n\nFrom http://jakarta.apache.org/tomcat/tomcat-5.0-doc/changelog.html\nUnder 5.0.6: \n\n\"Tomcat will now ignore a non existent classpath JAR (remm)\"\n\nFrom servlet-2_4-fr-spec.pdf, 9.7.1:\n\n\"The application developer depending on such an extension or extensions must\nprovide a META-INF/MANIFEST.MF entry in the WAR file listing all extensions\nneeded by theWAR. The format of the manifest entry should follow standard JAR\nmanifest format. During deployment of the Web application, the Web container\nmust make the correct versions of the extensions available to the application\nfollowing the rules defined by the Optional Package Versioning mechanism (http:/\n/java.sun.com/j2se/1.4/docs/guide/extensions/).\"\n\n\"Web containers must also be able to recognize declared dependencies\nexpressed in the manifest entry of any of the library JARs under the WEB-INF/lib\nentry in a WAR.\"\n\n\"If a Web container is not able to satisfy the dependencies declared in this\nmanner, it should reject the application with an informative error message.\"\n\n-----\n\nI found the bug when Tomcat logged a ClassNotFoundException for a class that is\nfound in a jar listed in the Class-Path entry for my WAR's manifest.  This jar\nshould have been placed in the TC_HOME\\shared\\lib directory, but was overlooked\nand not copied there.  It would be helpful if Tomcat rejected the WAR with an\ninformative error message so that the administrator quickly realized that the\nenvironment was not configured properly.", "id": 75155, "time": "2005-05-20T21:22:00Z", "creator": "timshadel@pobox.com", "creation_time": "2005-05-20T21:22:00Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 34993, "text": "You are confusing regular classpath entries with extensions, which is not\ndeclared the same thing (extension means you want one library with a certain\nversion or up, it's much more robust than a pointer to a JAR). The servlet spec\ndoes mandate checking for extensions, but obviously you should never be using a\nClass-Path entry.\n\nPlease do not reopen the report.", "id": 75711, "time": "2005-06-01T11:38:02Z", "creator": "remm@apache.org", "creation_time": "2005-06-01T11:38:02Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "timshadel@pobox.com", "attachment_id": null, "is_private": false, "id": 75987, "time": "2005-06-03T19:34:07Z", "bug_id": 34993, "creation_time": "2005-06-03T19:34:07Z", "text": "Thanks.  I confused\n\nhttp://java.sun.com/j2se/1.4.2/docs/guide/extensions/spec.html#bundled\n\nwith\n\nhttp://java.sun.com/j2se/1.4.2/docs/guide/extensions/versioning.html\n\nNow I get the errors I expected:\n\nINFO: Deploying web application archive test-cp.war\nJun 3, 2005 10:31:22 AM org.apache.catalina.util.ExtensionValidator\nvalidateManifestResources\nINFO: ExtensionValidator[/test-cp][Web Application Manifest]: Required extension\n\"com.example.testcp\" not found.\nJun 3, 2005 10:31:22 AM org.apache.catalina.util.ExtensionValidator\nvalidateManifestResources\nINFO: ExtensionValidator[/test-cp]: Failure to find 1 required extension(s).\n\nThanks again!"}]