[{"count": 0, "tags": [], "bug_id": 10789, "attachment_id": null, "id": 19506, "time": "2002-07-14T17:56:55Z", "creator": "miesfeld@acm.org", "creation_time": "2002-07-14T17:56:55Z", "is_private": false, "text": "Using Apache 2.0.39 and Tomcat 4.1.7 with the mod_jk2 connector on Windows \nXP.  With the DirectoryIndex set to index.jsp when I go to a directory that \ncontains index.jsp, it is not served, but if I type in /index.jsp explicitly, \nit is served.\n\nRelevant lines from files.\n\nFrom jk2.log: \n\n(1) Below you can see that, at 09:57:31, when the URI of '/' is made, a \nrequest follows for /index.jsp - which is matched but for some reason never \ngets sent on to mod_jk.handler().\n\n(2) When the request is made for /index.jsp explicitly, at 09:58:41, the \nextension match /index.jsp is again made and this time it does get sent on to \nmod_jk.handler().\n\n[Sun Jul 14 09:56:13 2002] (error ) [jk_logger_file.c (171)]  Initializing log \nfile G:/Apache32/Apache2/logs/jk2.log\n[Sun Jul 14 09:56:16 2002] (error ) [jk_logger_file.c (171)]  Initializing log \nfile G:/Apache32/Apache2/logs/jk2.log\n[Sun Jul 14 09:56:18 2002] (error ) [jk_logger_file.c (171)]  Initializing log \nfile G:/Apache32/Apache2/logs/jk2.log\n[Sun Jul 14 09:56:18 2002] ( info ) [jk_uriMap.c (339)]  uriMap.init() set \ndefault host\n[Sun Jul 14 09:56:18 2002] ( info ) [jk_uriMap.c (353)]  uriMap.init() loaded \nhost (null)\n[Sun Jul 14 09:56:18 2002] ( info ) [jk_uriMap.c (147)]  uriMap.addUriEnv() / \n(null) /\n[Sun Jul 14 09:56:18 2002] ( info ) [jk_uriMap.c (404)]  uriMap.init() Create \ndefault context / ( for default host )\n[Sun Jul 14 09:56:18 2002] ( info ) [jk_uriMap.c (427)]  uriMap.init() loaded \ncontext (null) / 678658 642818 63e740\n[Sun Jul 14 09:56:18 2002] ( info ) [jk_uriMap.c (445)]  uriMap.init() \nprocessing mappings\n[Sun Jul 14 09:56:18 2002] ( info ) [jk_uriEnv.c (314)]  uriEnv.init() suffix \nmapping / .jsp=ajp13:XXX.XXX.XX.XX:8009 was added\n[Sun Jul 14 09:56:18 2002] ( info ) [jk_uriEnv.c (358)]  uriEnv.init()  \nuri:/*.jsp  host=(null)  uri=/*.jsp type=2 ctx=(null) prefix=/ suffix=jsp\n[Sun Jul 14 09:56:18 2002] ( info ) [jk_workerEnv.c (403)]  workerEnv.init() \nok G:/Apache32/Apache2/conf/workers2.properties\n[Sun Jul 14 09:56:18 2002] ( info ) [mod_jk2.c (506)]  mod_jk child init 1 -1\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (565)]  uriMap.mapUri() \n(null) /                    <---------- 1\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (577)]  uriMap.mapUri() found \nhost (null)\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (602)]  uriMap.mapUri() found \nctx /\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (683)]  uriMap.mapUri() no \nmatch found\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (565)]  uriMap.mapUri() \n(null) /index.jsp\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (577)]  uriMap.mapUri() found \nhost (null)\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (602)]  uriMap.mapUri() found \nctx /\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (214)]  uriMap.mapUri() \nsuffix match jsp\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (639)]  uriMap.mapUri() \nextension match /index.jsp ajp13:XXX.XXX.XX.XX:8009   <------------ 1\n[Sun Jul 14 09:57:31 2002] ( info ) [mod_jk2.c (699)]  mod_jk.translate(): \nuriMap /index.jsp ajp13:XXX.XXX.XX.XX:8009 65e6a8   <------------ 1\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (565)]  uriMap.mapUri() \n(null) /index.html                                    <------------ 1\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (577)]  uriMap.mapUri() found \nhost (null)\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (602)]  uriMap.mapUri() found \nctx /\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (683)]  uriMap.mapUri() no \nmatch found\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (565)]  uriMap.mapUri() \n(null) /error/HTTP_FORBIDDEN.html.var\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (577)]  uriMap.mapUri() found \nhost (null)\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (602)]  uriMap.mapUri() found \nctx /\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (683)]  uriMap.mapUri() no \nmatch found\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (565)]  uriMap.mapUri() \n(null) /error/include/top.html\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (577)]  uriMap.mapUri() found \nhost (null)\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (602)]  uriMap.mapUri() found \nctx /\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (683)]  uriMap.mapUri() no \nmatch found\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (565)]  uriMap.mapUri() \n(null) /error/include/bottom.html\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (577)]  uriMap.mapUri() found \nhost (null)\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (602)]  uriMap.mapUri() found \nctx /\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (683)]  uriMap.mapUri() no \nmatch found\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (565)]  uriMap.mapUri() \n(null) /error/contact.html.var\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (577)]  uriMap.mapUri() found \nhost (null)\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (602)]  uriMap.mapUri() found \nctx /\n[Sun Jul 14 09:57:31 2002] ( info ) [jk_uriMap.c (683)]  uriMap.mapUri() no \nmatch found\n[Sun Jul 14 09:58:41 2002] ( info ) [jk_uriMap.c (565)]  uriMap.mapUri() \n(null) /index.jsp           <------------ 2\n[Sun Jul 14 09:58:41 2002] ( info ) [jk_uriMap.c (577)]  uriMap.mapUri() found \nhost (null)\n[Sun Jul 14 09:58:41 2002] ( info ) [jk_uriMap.c (602)]  uriMap.mapUri() found \nctx /\n[Sun Jul 14 09:58:41 2002] ( info ) [jk_uriMap.c (214)]  uriMap.mapUri() \nsuffix match jsp\n[Sun Jul 14 09:58:41 2002] ( info ) [jk_uriMap.c (639)]  uriMap.mapUri() \nextension match /index.jsp ajp13:XXX.XXX.XX.XX:8009   <------------ 2\n[Sun Jul 14 09:58:41 2002] ( info ) [mod_jk2.c (699)]  mod_jk.translate(): \nuriMap /index.jsp ajp13:XXX.XXX.XX.XX:8009 65e6a8   <------------ 2\n[Sun Jul 14 09:58:41 2002] ( info ) [mod_jk2.c (587)]  mod_jk.handler() \nserving /*.jsp with 65e6a8 65e610 XXX.XXX.XX.XX:8009   <------------ 2\n[Sun Jul 14 09:58:41 2002] ( info ) [mod_jk2.c (597)]  mod_jk.handler(): new \nrpool 663730                                      <------------ 2\n[Sun Jul 14 09:58:41 2002] ( info ) [jk_service_apache2.c (367)]  service.init\n() Can't find child in scoreboard 4000\n[Sun Jul 14 09:58:41 2002] ( info ) [jk_requtil.c (703)]  serialize.request() \nserialized /index.jsp\n[Sun Jul 14 09:58:41 2002] ( info ) [jk_workerEnv.c (430)]  workerEnv.dispatch\n() Calling 4 sendHeaders\n\nFrom httpd.conf:\n\n<IfModule mod_dir.c>\n  DirectoryIndex index.jsp index.html\n</IfModule>\n\nFrom workers2.properties\n\n[workerEnv:]\ninfo=Global server options\ntiming=1\ndebug=9\n# Default Native Logger (apache2 or win32 )\n# can be overriden to a file logger, useful\n# when tracing win32 related issues\nlogger=logger.file:0\n\n[channel.socket:XXX.XXX.XX.XX:8009]\ninfo=Ajp13 forwarding over socket\ndebug=0\ntomcatId=XXX.XXX.XX.XX:8009\n\n[status:]\ninfo=Status worker, displays runtime informations\n\n# define the worker\n[ajp13:XXX.XXX.XX.XX:8009]\nchannel=channel.socket:XXX.XXX.XX.XX:8009\ndebug=0\n\n# Uri mappings:\n\n[uri:/jkstatus/*]\ninfo=Display status information and checks the config file for changes.\ngroup=status:\n\n[uri:/*.jsp]\ninfo=Extension mapping\nworker=ajp13:XXX.XXX.XX.XX:8009\ndebug=9"}, {"count": 1, "tags": [], "bug_id": 10789, "attachment_id": null, "text": "Inserting some fprintf statements into mod_jk2 to show the sequence of hook \ninvocations, I see that the problem is that jk2_handler is not getting invoked \nuntil too late in the process when the request is a directory.  I assume this \nis because of the mod_dir processing, but I do not really know anything about \nthe Apache internals.\n\nIn the below trace, the sequence is http://XXX.XXX.XX.XX/  <---- 1 and then \nturn around and request http://XXX.XXX.XX.XX/index.jsp <---- 2 explictly. \n\nG:\\Apache32\\Apache2\\bin>apache -X\njk2_post_config( )     ENTER\njk2_post_config( )     ENTER\njk2_child_init( )      ENTER\njk2_translate( )       ENTER                       <------- 1\n  Unparsed uri: /                                  \n  Return DECLINED\njk2_map_to_storage( )  ENTER\n  Unparsed uri: /\n  Return DECLINED\njk2_translate( )       ENTER\n  Unparsed uri: /index.html\n  Return DECLINED\njk2_map_to_storage( )  ENTER\n  Unparsed uri: /index.html\n  Return DECLINED\njk2_translate( )       ENTER                       <------- 1\n  Unparsed uri: /index.jsp\n  Return OK\njk2_map_to_storage( )  ENTER                       <------- 1\n  Unparsed uri: /index.jsp\n  Return OK                    <--- If jk2_handler were now invoked ..\njk2_translate( )       ENTER\n  Unparsed uri: /error/HTTP_FORBIDDEN.html.var\n  Return DECLINED\njk2_map_to_storage( )  ENTER\n  Unparsed uri: /error/HTTP_FORBIDDEN.html.var\n  Return DECLINED\njk2_translate( )       ENTER\n  Unparsed uri: /error/include/top.html\n  Return DECLINED\njk2_map_to_storage( )  ENTER\n  Unparsed uri: /error/include/top.html\n  Return DECLINED\njk2_handler( )         ENTER                       <------- 1\n  Unparsed uri: /error/include/top.html\n  Return DECLINED\njk2_translate( )       ENTER\n  Unparsed uri: /error/include/bottom.html\n  Return DECLINED\njk2_map_to_storage( )  ENTER\n  Unparsed uri: /error/include/bottom.html\n  Return DECLINED\njk2_handler( )         ENTER\n  Unparsed uri: /error/include/bottom.html\n  Return DECLINED\njk2_translate( )       ENTER\n  Unparsed uri: /error/include/../contact.html.var\n  Return DECLINED\njk2_map_to_storage( )  ENTER\n  Unparsed uri: /error/include/../contact.html.var\n  Return DECLINED\njk2_translate( )       ENTER                       <------- 2\n  Unparsed uri: /index.jsp                         \n  Return OK\njk2_map_to_storage( )  ENTER                       <------- 2\n  Unparsed uri: /index.jsp\n  Return OK\njk2_handler( )         ENTER                       <------- 2\n  Unparsed uri: /index.jsp\n  Return OK\n", "id": 19562, "time": "2002-07-15T16:02:36Z", "creator": "miesfeld@acm.org", "creation_time": "2002-07-15T16:02:36Z", "is_private": false}, {"count": 2, "tags": [], "creator": "bojan@rexursive.com", "attachment_id": null, "id": 19662, "time": "2002-07-17T05:32:49Z", "bug_id": 10789, "creation_time": "2002-07-17T05:32:49Z", "is_private": false, "text": "From mod_jk2.c, function jk2_handler, line 536:\n\n-------------------------------\nif(uriEnv==NULL || strcmp(r->handler,JK_HANDLER)!= 0 )\n      return DECLINED;\n-------------------------------\n\nwhich kind of boils down to the same thing as in bug 9913, except this is for\nmod_jk2, as compared to mod_jk.\n\nI guess this fix here would be (following the logic of 9913 fix):\n\n-------------------------------\nif(uriEnv==NULL ||\n   (strcmp(r->handler,JK_HANDLER) &&\n    strcmp(r->handler,DIR_MAGIC_TYPE)))\n      return DECLINED;\n-------------------------------\n\nBojan"}, {"count": 3, "tags": [], "creator": "bojan@rexursive.com", "text": "Mark, please give the fix a good bashing. It's now in CVS.\n\nBojan", "id": 19664, "time": "2002-07-17T06:00:50Z", "bug_id": 10789, "creation_time": "2002-07-17T06:00:50Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "text": "Bojan,\n\nI checked out jakarta-tomcat-connectors and built mod_jk2, and I still get the \nsame problem.\n\nIf I go to http://my.numeric.ip/ or http://my.numeric.ip/tomcat/examples/ I \nget the same message:\n\nAccess forbidden!\n\nYou don't have permission to access the requested directory. There is either \nno index document or the directory is read-protected. \n\nIf you think this is a server error, please contact the webmaster \n\nError 403\n204.210.44.99 \n07/17/02 06:40:56 \n\nBoth of the directories do have an index document, index.jsp.\n\nI have looked at mod_dir.c and this is what I think is happening.  (Forgive me \nif I don't use all the proper terms, I do not know Apache that well.)\n\nA request for a directory comes in, mod_dir looks at it and then loops through \nthe files listed in the DirectoryIndex directive, initating a sub-request for \neach file in turn.\n\nWhen mod_dir tries index.jsp, both the ap_hook_translate_name and the \nap_hook_map_to_storage hooks in mod_jk2 get invoked - but the ap_hook_handler \nhook does *not* get invoked.\n\nIn my specific case, I see that ap_hook_handler does get invoked, later, when \nthe error pages start getting served.  By then it is too late.\n\nIt seems to me something needs to happen to drop mod_dir out of its loop when \nindex.jsp is seen to exist and have the mod_jk2 ap_hook_handler invoked.\n\nJUST FOR FUN, after line 712 in mod_jk2.c, which is in the map to storage \nhook, I added this line:\n\n  r->finfo.filetype = APR_REG;\n\nfinfo.filetype of APR_REG being one of the things that mod_dir is looking \nfor.  When I do, I see the error message displayed in the browser is changed \nto say I can not access the requested *object*, rather than requested \n*directory*.  This makes me think I am sort of on the right track\n\nAccess forbidden!\n\nYou don't have permission to access the requested object. It is either read-\nprotected or not readable by the server. \n\nIf you think this is a server error, please contact the webmaster \n\nError 403\n204.210.44.99 \n07/17/02 06:57:57 \n\nI do not know either Apache or mod_jk to take this any farther.", "attachment_id": null, "id": 19679, "creator": "miesfeld@acm.org", "time": "2002-07-17T14:17:10Z", "bug_id": 10789, "creation_time": "2002-07-17T14:17:10Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 10789, "text": "I have reverted the fix for mod_jk2 until I can investigate more. The fix for\nmod_jk does work OK, I can confirm that.\n\nBojan", "id": 19728, "time": "2002-07-17T22:50:16Z", "creator": "bojan@rexursive.com", "creation_time": "2002-07-17T22:50:16Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 10789, "attachment_id": null, "text": "The reason that this fix:\n\n-------------------------------\nif(uriEnv==NULL ||\n   (strcmp(r->handler,JK_HANDLER) &&\n    strcmp(r->handler,DIR_MAGIC_TYPE)))\n      return DECLINED;\n-------------------------------\n\ndoesn't work for mod_jk2 is that when jk2_handler is invoked in the sequence, \nuriEnv is NULL.\n\nThis is a hack that actually fixes the specific request for a directory, but I \ndo not have any idea what other effects it might have, and I do not propose it \nas a fix.  I am just putting it here to maybe give someone an idea.\n\nIn mod_jk2 about line 715, within the jk2_map_to_storage() function, you have \nthese lines:\n\n  jk_uriEnv_t *uriEnv=ap_get_module_config( r->request_config, &jk2_module );\n\n  if( uriEnv != NULL ) {\n      r->filename = (char *)apr_filename_of_pathname(r->uri);\n\nPlacing this code following the above (within the if statement) works:\n\n  if (r->main != NULL && strcmp(r->main->handler, DIR_MAGIC_TYPE) == 0) {\n    /* This is a sub-request and the main request was for a directory\n       entry - assume we are here because of mod_dir processing:\n         set the main request record request config to uriEnv\n         set the main request handler to JK_HANDLER */\n    ap_set_module_config(r->main->request_config, &jk2_module, uriEnv );\n    r->main->handler=JK_HANDLER;\n\nThe following trace of http://my.numeric.isp/, without the hack, shows that \njk2_translate and jk2_map_to_storage are actually working with the request_rec \nof a sub-request and that when jk2_handler is finally invoked it is working \nwith the original request_rec.\n\nG:\\Apache32\\Apache2\\bin>apache -X\njk2_post_config( )            ENTER\njk2_post_config( )            ENTER\njk2_child_init( )             ENTER\njk2_translate( )              ENTER\n  Unparsed uri:               /\n  request_rec:                009CB990\n  request_rec->main:          00000000\n  request_rec->prev:          00000000\n  request_rec->next:          00000000\n  Return DECLINED\njk2_map_to_storage( )         ENTER\n  Unparsed uri:               /\n  request_rec:                009CB990\n  Return DECLINED\njk2_translate( )              ENTER\n  Unparsed uri:               /index.html\n  request_rec:                009D19A8\n  request_rec->main:          009CB990\n  request_rec->prev:          00000000\n  request_rec->next:          00000000\n  request_rec->main->handler: httpd/unix-directory\n  Return DECLINED\njk2_map_to_storage( )         ENTER\n  Unparsed uri:               /index.html\n  request_rec:                009D19A8\n  Return DECLINED\njk2_translate( )              ENTER\n  Unparsed uri:               /index.jsp\n  request_rec:                009D19A8\n  request_rec->main:          009CB990\n  request_rec->prev:          00000000\n  request_rec->next:          00000000\n  request_rec->main->handler: httpd/unix-directory\n  Return OK\njk2_map_to_storage( )         ENTER\n  Unparsed uri:               /index.jsp\n  request_rec:                009D19A8\n  Return OK\njk2_translate( )              ENTER\n  Unparsed uri:               /error/HTTP_FORBIDDEN.html.var\n  request_rec:                009CCDC8\n  request_rec->main:          00000000\n  request_rec->prev:          009CB990\n  request_rec->next:          00000000\n  Return DECLINED\njk2_map_to_storage( )         ENTER\n  Unparsed uri:               /error/HTTP_FORBIDDEN.html.var\n  request_rec:                009CCDC8\n  Return DECLINED\njk2_translate( )              ENTER\n  Unparsed uri:               /error/include/top.html\n  request_rec:                009D99C8\n  request_rec->main:          009CCDC8\n  request_rec->prev:          00000000\n  request_rec->next:          00000000\n  request_rec->main->handler: type-map\n  Return DECLINED\njk2_map_to_storage( )         ENTER\n  Unparsed uri:               /error/include/top.html\n  request_rec:                009D99C8\n  Return DECLINED\njk2_handler( )                ENTER\n  Unparsed uri:               /error/include/top.html\n  request_rec:                009D99C8\n  uriEnv:                     00000000\n  Return DECLINED\njk2_translate( )              ENTER\n  Unparsed uri:               /error/include/bottom.html\n  request_rec:                009D99C8\n  request_rec->main:          009CCDC8\n  request_rec->prev:          00000000\n  request_rec->next:          00000000\n  request_rec->main->handler: type-map\n  Return DECLINED\njk2_map_to_storage( )         ENTER\n  Unparsed uri:               /error/include/bottom.html\n  request_rec:                009D99C8\n  Return DECLINED\njk2_handler( )                ENTER\n  Unparsed uri:               /error/include/bottom.html\n  request_rec:                009D99C8\n  uriEnv:                     00000000\n  Return DECLINED\njk2_translate( )              ENTER\n  Unparsed uri:               /error/include/../contact.html.var\n  request_rec:                009DBA50\n  request_rec->main:          009D99C8\n  request_rec->prev:          00000000\n  request_rec->next:          00000000\n  request_rec->main->handler: text/html\n  Return DECLINED\njk2_map_to_storage( )         ENTER\n  Unparsed uri:               /error/include/../contact.html.var\n  request_rec:                009DBA50\n  Return DECLINED\n\nThe following trace with the hack included shows that it works:\n\nG:\\Apache32\\Apache2\\bin>apache -X\njk2_post_config( )            ENTER\njk2_post_config( )            ENTER\njk2_child_init( )             ENTER\njk2_translate( )              ENTER\n  Unparsed uri:               /\n  request_rec:                009CB990\n  request_rec->main:          00000000\n  request_rec->prev:          00000000\n  request_rec->next:          00000000\n  Return DECLINED\njk2_map_to_storage( )         ENTER\n  Unparsed uri:               /\n  request_rec:                009CB990\n  Return DECLINED\njk2_translate( )              ENTER\n  Unparsed uri:               /index.html\n  request_rec:                009D19A8\n  request_rec->main:          009CB990\n  request_rec->prev:          00000000\n  request_rec->next:          00000000\n  request_rec->main->handler: httpd/unix-directory\n  Return DECLINED\njk2_map_to_storage( )         ENTER\n  Unparsed uri:               /index.html\n  request_rec:                009D19A8\n  Return DECLINED\njk2_translate( )              ENTER\n  Unparsed uri:               /index.jsp\n  request_rec:                009D19A8\n  request_rec->main:          009CB990\n  request_rec->prev:          00000000\n  request_rec->next:          00000000\n  request_rec->main->handler: httpd/unix-directory\n  Return OK\njk2_map_to_storage( )         ENTER\n  Unparsed uri:               /index.jsp\n  request_rec:                009D19A8\n    Set r->main->request_config == uriEnv\n        r->main->handler        == JK_HANDLER.\n  request_rec->filename:       index.jsp\n  request_rec->finfo.filetype: 0\n  Return OK\njk2_handler( )                ENTER\n  Unparsed uri:               /\n  request_rec:                009CB990\n  uriEnv:                     0096A6D0\n  Return OK\njk2_translate( )              ENTER\n  Unparsed uri:               /index.jsp\n  request_rec:                009CB990\n  request_rec->main:          00000000\n  request_rec->prev:          00000000\n  request_rec->next:          00000000\n  Return OK\njk2_map_to_storage( )         ENTER\n  Unparsed uri:               /index.jsp\n  request_rec:                009CB990\n  Return OK\njk2_handler( )                ENTER\n  Unparsed uri:               /index.jsp\n  request_rec:                009CB990\n  uriEnv:                     0096A6D0\n  Return OK\n\n", "id": 19734, "time": "2002-07-18T00:57:29Z", "creator": "miesfeld@acm.org", "creation_time": "2002-07-18T00:57:29Z", "is_private": false}, {"count": 7, "attachment_id": null, "creator": "bojan@rexursive.com", "text": "Cool. I have no idea what implications that will have since I'm not a mod_jk2\nuser. So, I'll leave it up to mod_jk2 people to commit this time.\n\nBojan", "id": 19740, "time": "2002-07-18T03:24:20Z", "bug_id": 10789, "creation_time": "2002-07-18T03:24:20Z", "tags": [], "is_private": false}, {"count": 8, "tags": [], "creator": "mturk@apache.org", "attachment_id": null, "id": 19778, "time": "2002-07-18T15:19:01Z", "bug_id": 10789, "creation_time": "2002-07-18T15:19:01Z", "is_private": false, "text": "Fixed!\nMT."}, {"count": 9, "tags": [], "bug_id": 10789, "attachment_id": null, "id": 19886, "time": "2002-07-20T12:30:43Z", "creator": "bojan@rexursive.com", "creation_time": "2002-07-20T12:30:43Z", "is_private": false, "text": "Reopen to change the fix."}, {"count": 10, "tags": [], "bug_id": 10789, "attachment_id": null, "id": 19887, "creation_time": "2002-07-20T12:37:17Z", "time": "2002-07-20T12:37:17Z", "creator": "bojan@rexursive.com", "text": "I have applied the change similar to the one for bug 9913.\n\nMark, could you please download and check it out.\n\nMladen, Costin, could you please verify that I didn't do something extremely\nstupid in there. I'm really just beginning to understand how Apache 2 works...\n\nBojan", "is_private": false}, {"count": 11, "tags": [], "bug_id": 10789, "text": "Bojan,\n\nI tested your last fix and it works, for me, on directory requests that are \nimmediately under my document root.  But it does not work on directories that \nI have aliased.  I think you need just one more tweak to get the real absolute \nfile name.\n\nHere is some info:\n\nExample of an alias I have in httpd.conf\n\n  Alias /tomcat  \"G:/Apache32/src/jakarta-tomcat-4.1.7.base/webapps\"\n\nHere is some print out while requesting http://my.numeric.ip/ , then \nrequesting http://my.numeric.ip/tomcat/examples/  :\n\njk2_translate( )              ENTER\n  Unparsed uri:               /\n  \n.....\n\nfixup_dir( )    ENTER\n   ...\n  ap_sub_reg_lookup_uri( )  after\n    status:     200\n    filetype:   1\n    file name: E:/InetPub/dfxsys.com/index.jsp\n    uri:       /index.jsp\n  Return OK\n  \nAnd my index.jsp displays properly.\n\njk2_translate( )              ENTER\n  Unparsed uri:               /tomcat/examples/\n  \n...\n\nfixup_dir( )    ENTER\n  Unparsed uri:      /tomcat/examples/index.html\n  ...\n  ap_sub_reg_lookup_uri( )  after\n    status:     200\n    filetype:   0\n    file name: G:/Apache32/src/jakarta-tomcat-\n4.1.7.base/webapps/examples/index.html\n    uri:       /tomcat/examples/index.html\n   \n  ...\n  ap_sub_reg_lookup_uri( )  after\n    status:     200\n    filetype:   0\n    file name: E:/InetPub/dfxsys.com/tomcat/examples/index.jsp\n    uri:       /tomcat/examples/index.jsp\n  Return DECLINED (passed on through) \n  \nAnd I get a: \n\nAccess forbidden!\nYou don't have permission to access the requested directory. There is either \nno index document or the directory is read-protected. \n\nin the browser window.\n\nNote in the above that /tomcat/examples/index.html was *correctly* mapped to \nthe proper place in the file system, but there is no index.html file.\n\nIt looks to me that you just need something to get the alias processing right.", "id": 19893, "time": "2002-07-20T16:11:09Z", "creator": "miesfeld@acm.org", "creation_time": "2002-07-20T16:11:09Z", "is_private": false, "attachment_id": null}, {"count": 12, "tags": [], "bug_id": 10789, "text": "Mark, I have made some changes to mod_jk, not mod_jk2. You might want to take\nthose changes and try them with your aliases. Please note that URI will be left\nunchanged, so your instance of Tomcat needs to know about it. The alias\nprocessing only covers files on the file system, it doesn't involve changing the\nURI's.\n\nI won't commit anything to mod_jk2 since there have been major objections from\nother commiters about the code.\n\nBojan", "id": 19936, "time": "2002-07-21T22:49:04Z", "creator": "bojan@rexursive.com", "creation_time": "2002-07-21T22:49:04Z", "is_private": false, "attachment_id": null}, {"count": 13, "tags": [], "bug_id": 10789, "text": "Mark, could you please give it another go. The new code is in, but since I'm not\nmod_jk2 user, I can't really tell if it's good or not.\n\nThis time physical files, including aliases, and requests to default files not\nspecified in DirectoryIndex should be covered.\n\nBojan", "id": 20023, "attachment_id": null, "creator": "bojan@rexursive.com", "creation_time": "2002-07-23T02:20:41Z", "time": "2002-07-23T02:20:41Z", "is_private": false}, {"count": 14, "tags": [], "bug_id": 10789, "text": "Bojan,\n\nI rebuilt mod_jk2 using your latest additions.  It does not seem to work for \nmod_jk2.\n\nWhat happens is, my index.jsp gets displayed in the browser window, but \nwithout the \"jsp\" part.  I.e., the index.jsp for the tomcat examples has this \nmarkup in it:  <%= application.getServerInfo() %> that puts \"Apache \nTomcat/4.1\" in the center of the page just to the right of the tomcat logo.  \nWhen I go to the directory, this is left blank.  When I go directory to \nindex.jsp it is served correctly.  The log shows that the page does not go \nthrough mod_jk2, when I go to the directory.\n\nHere is some output from the quick test I did.\n\nListing 1 is from the mod_jk2 log: going to httpd://204.210.44.99/ and then \nhttpd://204.210.44.99/tomcat/examples/\n\nListing 2 is from the log and then going to:  httpd://204.210.44.99/index.jsp \nand then :  httpd://204.210.44.99/tomcat/examples/index.jsp\n\nListing 3 is some parts of my httpd.conf\n\nListing 4 is what I think is relevant from workers2.properties\n\nListing 1:\n- - - - - - - - - -\n\n[Tue Jul 23 07:35:27 2002] (error ) [jk_logger_file.c (171)]  Initializing log \nfile G:/Apache32/Apache2/logs/jk2.log\n[Tue Jul 23 07:35:29 2002] (error ) [jk_logger_file.c (171)]  Initializing log \nfile G:/Apache32/Apache2/logs/jk2.log\n[Tue Jul 23 07:35:29 2002] (error ) [jk_logger_file.c (171)]  Initializing log \nfile G:/Apache32/Apache2/logs/jk2.log\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_workerEnv.c (381)]  workerEnv.init() \ncreate default worker lb:lb\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriMap.c (339)]  uriMap.init() set \ndefault host\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriMap.c (353)]  uriMap.init() loaded \nhost (null)\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriMap.c (147)]  uriMap.addUriEnv() / \n(null) /\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriMap.c (404)]  uriMap.init() Create \ndefault context / ( for default host )\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriMap.c (427)]  uriMap.init() loaded \ncontext (null) /taza.net 678658 642858 63e740\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriMap.c (427)]  uriMap.init() loaded \ncontext (null) /tomcat/examples 678658 642858 63e740\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriMap.c (427)]  uriMap.init() loaded \ncontext (null) /admin 678658 642858 63e740\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriMap.c (427)]  uriMap.init() loaded \ncontext (null) / 678658 642858 63e740\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriMap.c (445)]  uriMap.init() \nprocessing mappings\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriEnv.c (339)]  uriEnv.init() prefix \nmapping /jkstatus=status:\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriEnv.c (358)]  uriEnv.init()  \nuri:/jkstatus/*  host=(null)  uri=/jkstatus/* type=1 ctx=(null) \nprefix=/jkstatus suffix=(null)\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriEnv.c (314)]  uriEnv.init() suffix \nmapping / .jsp=ajp13:204.210.44.99:8009 was added\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriEnv.c (358)]  uriEnv.init()  \nuri:/*.jsp  host=(null)  uri=/*.jsp type=2 ctx=(null) prefix=/ suffix=jsp\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriEnv.c (339)]  uriEnv.init() prefix \nmapping /servlet=ajp13:204.210.44.99:8009\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriEnv.c (358)]  uriEnv.init()  \nuri:/servlet/*  host=(null)  uri=/servlet/* type=1 ctx=(null) prefix=/servlet \nsuffix=(null)\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriEnv.c (339)]  uriEnv.init() prefix \nmapping /pages=ajp13:204.210.44.99:8009\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriEnv.c (358)]  uriEnv.init()  \nuri:/pages/*  host=(null)  uri=/pages/* type=1 ctx=(null) prefix=/pages suffix=\n(null)\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriEnv.c (263)]  uriEnv.init() context \nmapping /taza.net=ajp13:204.210.44.99:8009 \n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriEnv.c (263)]  uriEnv.init() context \nmapping /tomcat/examples=ajp13:204.210.44.99:8009 \n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriEnv.c (263)]  uriEnv.init() context \nmapping /admin=ajp13:204.210.44.99:8009 \n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriEnv.c (339)]  uriEnv.init() prefix \nmapping /admin=ajp13:204.210.44.99:8009\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriEnv.c (358)]  uriEnv.init()  \nuri:/admin/*  host=(null)  uri=/admin/* type=1 ctx=(null) prefix=/admin suffix=\n(null)\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriEnv.c (339)]  uriEnv.init() prefix \nmapping /manager=ajp13:204.210.44.99:8009\n[Tue Jul 23 07:35:29 2002] (debug ) [jk_uriEnv.c (358)]  uriEnv.init()  \nuri:/manager/*  host=(null)  uri=/manager/* type=1 ctx=/manager \nprefix=/manager suffix=(null)\n[Tue Jul 23 07:35:29 2002] ( info ) [jk_workerEnv.c (403)]  workerEnv.init() \nok G:/Apache32/Apache2/conf/workers2.properties\n[Tue Jul 23 07:35:29 2002] ( info ) [mod_jk2.c (506)]  mod_jk child init 1 -1\n[Tue Jul 23 07:36:58 2002] (debug ) [jk_uriMap.c (565)]  uriMap.mapUri() \n(null) /\n[Tue Jul 23 07:36:58 2002] (debug ) [jk_uriMap.c (577)]  uriMap.mapUri() found \nhost (null)\n[Tue Jul 23 07:36:58 2002] (debug ) [jk_uriMap.c (602)]  uriMap.mapUri() found \nctx /\n[Tue Jul 23 07:36:58 2002] (debug ) [jk_uriMap.c (683)]  uriMap.mapUri() no \nmatch found\n[Tue Jul 23 07:36:58 2002] (debug ) [jk_uriMap.c (565)]  uriMap.mapUri() \n(null) /index.html\n[Tue Jul 23 07:36:58 2002] (debug ) [jk_uriMap.c (577)]  uriMap.mapUri() found \nhost (null)\n[Tue Jul 23 07:36:58 2002] (debug ) [jk_uriMap.c (602)]  uriMap.mapUri() found \nctx /\n[Tue Jul 23 07:36:58 2002] (debug ) [jk_uriMap.c (683)]  uriMap.mapUri() no \nmatch found\n[Tue Jul 23 07:36:58 2002] (debug ) [jk_uriMap.c (565)]  uriMap.mapUri() \n(null) /index.jsp\n[Tue Jul 23 07:36:58 2002] (debug ) [jk_uriMap.c (577)]  uriMap.mapUri() found \nhost (null)\n[Tue Jul 23 07:36:58 2002] (debug ) [jk_uriMap.c (602)]  uriMap.mapUri() found \nctx /\n[Tue Jul 23 07:36:58 2002] (debug ) [jk_uriMap.c (214)]  uriMap.mapUri() \nsuffix match jsp\n[Tue Jul 23 07:36:58 2002] (debug ) [jk_uriMap.c (639)]  uriMap.mapUri() \nextension match /index.jsp ajp13:204.210.44.99:8009\n[Tue Jul 23 07:36:58 2002] (debug ) [mod_jk2.c (711)]  mod_jk.translate(): \nuriMap /index.jsp ajp13:204.210.44.99:8009 654680\n[Tue Jul 23 07:37:13 2002] (debug ) [jk_uriMap.c (565)]  uriMap.mapUri() \n(null) /tomcat/examples/\n[Tue Jul 23 07:37:13 2002] (debug ) [jk_uriMap.c (577)]  uriMap.mapUri() found \nhost (null)\n[Tue Jul 23 07:37:13 2002] (debug ) [jk_uriMap.c (602)]  uriMap.mapUri() found \nctx /tomcat/examples\n[Tue Jul 23 07:37:13 2002] (debug ) [jk_uriMap.c (683)]  uriMap.mapUri() no \nmatch found\n[Tue Jul 23 07:37:13 2002] (debug ) [jk_uriMap.c (565)]  uriMap.mapUri() \n(null) /tomcat/examples/index.html\n[Tue Jul 23 07:37:13 2002] (debug ) [jk_uriMap.c (577)]  uriMap.mapUri() found \nhost (null)\n[Tue Jul 23 07:37:13 2002] (debug ) [jk_uriMap.c (602)]  uriMap.mapUri() found \nctx /tomcat/examples\n[Tue Jul 23 07:37:13 2002] (debug ) [jk_uriMap.c (683)]  uriMap.mapUri() no \nmatch found\n[Tue Jul 23 07:37:13 2002] (debug ) [jk_uriMap.c (565)]  uriMap.mapUri() \n(null) /tomcat/examples/index.jsp\n[Tue Jul 23 07:37:13 2002] (debug ) [jk_uriMap.c (577)]  uriMap.mapUri() found \nhost (null)\n[Tue Jul 23 07:37:13 2002] (debug ) [jk_uriMap.c (602)]  uriMap.mapUri() found \nctx /tomcat/examples\n[Tue Jul 23 07:37:13 2002] (debug ) [jk_uriMap.c (214)]  uriMap.mapUri() \nsuffix match jsp\n[Tue Jul 23 07:37:13 2002] (debug ) [jk_uriMap.c (639)]  uriMap.mapUri() \nextension match /tomcat/examples/index.jsp ajp13:204.210.44.99:8009\n[Tue Jul 23 07:37:32 2002] (debug ) [jk_workerEnv.c (140)]  destroy worker \najp13:204.210.44.99:8009\n[Tue Jul 23 07:37:32 2002] (debug ) [jk_worker_ajp13.c (794)]  ajp13.destroy() \nclosed 0 cached endpoints\n[Tue Jul 23 07:37:32 2002] (debug ) [jk_workerEnv.c (140)]  destroy worker \nstatus:\n[Tue Jul 23 07:37:32 2002] (debug ) [jk_workerEnv.c (140)]  destroy worker \nlb:lb\n[Tue Jul 23 07:37:32 2002] (debug ) [jk_workerEnv.c (147)]  workerEnv.close() \ndone 3\n\nListing 2:\n- - - - - - - - - \n[Tue Jul 23 07:42:18 2002] (error ) [jk_logger_file.c (171)]  Initializing log \nfile G:/Apache32/Apache2/logs/jk2.log\n[Tue Jul 23 07:42:21 2002] (error ) [jk_logger_file.c (171)]  Initializing log \nfile G:/Apache32/Apache2/logs/jk2.log\n[Tue Jul 23 07:42:21 2002] (error ) [jk_logger_file.c (171)]  Initializing log \nfile G:/Apache32/Apache2/logs/jk2.log\n[Tue Jul 23 07:42:21 2002] (debug ) [jk_workerEnv.c (381)]  workerEnv.init() \ncreate default worker lb:lb\n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriMap.c (339)]  uriMap.init() set \ndefault host\n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriMap.c (353)]  uriMap.init() loaded \nhost (null)\n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriMap.c (147)]  uriMap.addUriEnv() / \n(null) /\n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriMap.c (404)]  uriMap.init() Create \ndefault context / ( for default host )\n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriMap.c (427)]  uriMap.init() loaded \ncontext (null) /taza.net 678658 642858 63e740\n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriMap.c (427)]  uriMap.init() loaded \ncontext (null) /tomcat/examples 678658 642858 63e740\n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriMap.c (427)]  uriMap.init() loaded \ncontext (null) /admin 678658 642858 63e740\n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriMap.c (427)]  uriMap.init() loaded \ncontext (null) / 678658 642858 63e740\n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriMap.c (445)]  uriMap.init() \nprocessing mappings\n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriEnv.c (339)]  uriEnv.init() prefix \nmapping /jkstatus=status:\n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriEnv.c (358)]  uriEnv.init()  \nuri:/jkstatus/*  host=(null)  uri=/jkstatus/* type=1 ctx=(null) \nprefix=/jkstatus suffix=(null)\n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriEnv.c (314)]  uriEnv.init() suffix \nmapping / .jsp=ajp13:204.210.44.99:8009 was added\n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriEnv.c (358)]  uriEnv.init()  \nuri:/*.jsp  host=(null)  uri=/*.jsp type=2 ctx=(null) prefix=/ suffix=jsp\n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriEnv.c (339)]  uriEnv.init() prefix \nmapping /servlet=ajp13:204.210.44.99:8009\n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriEnv.c (358)]  uriEnv.init()  \nuri:/servlet/*  host=(null)  uri=/servlet/* type=1 ctx=(null) prefix=/servlet \nsuffix=(null)\n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriEnv.c (339)]  uriEnv.init() prefix \nmapping /pages=ajp13:204.210.44.99:8009\n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriEnv.c (358)]  uriEnv.init()  \nuri:/pages/*  host=(null)  uri=/pages/* type=1 ctx=(null) prefix=/pages suffix=\n(null)\n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriEnv.c (263)]  uriEnv.init() context \nmapping /taza.net=ajp13:204.210.44.99:8009 \n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriEnv.c (263)]  uriEnv.init() context \nmapping /tomcat/examples=ajp13:204.210.44.99:8009 \n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriEnv.c (263)]  uriEnv.init() context \nmapping /admin=ajp13:204.210.44.99:8009 \n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriEnv.c (339)]  uriEnv.init() prefix \nmapping /admin=ajp13:204.210.44.99:8009\n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriEnv.c (358)]  uriEnv.init()  \nuri:/admin/*  host=(null)  uri=/admin/* type=1 ctx=(null) prefix=/admin suffix=\n(null)\n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriEnv.c (339)]  uriEnv.init() prefix \nmapping /manager=ajp13:204.210.44.99:8009\n[Tue Jul 23 07:42:22 2002] (debug ) [jk_uriEnv.c (358)]  uriEnv.init()  \nuri:/manager/*  host=(null)  uri=/manager/* type=1 ctx=/manager \nprefix=/manager suffix=(null)\n[Tue Jul 23 07:42:22 2002] ( info ) [jk_workerEnv.c (403)]  workerEnv.init() \nok G:/Apache32/Apache2/conf/workers2.properties\n[Tue Jul 23 07:42:22 2002] ( info ) [mod_jk2.c (506)]  mod_jk child init 1 -1\n[Tue Jul 23 07:43:39 2002] (debug ) [jk_uriMap.c (565)]  uriMap.mapUri() \n(null) /index.jsp\n[Tue Jul 23 07:43:39 2002] (debug ) [jk_uriMap.c (577)]  uriMap.mapUri() found \nhost (null)\n[Tue Jul 23 07:43:39 2002] (debug ) [jk_uriMap.c (602)]  uriMap.mapUri() found \nctx /\n[Tue Jul 23 07:43:39 2002] (debug ) [jk_uriMap.c (214)]  uriMap.mapUri() \nsuffix match jsp\n[Tue Jul 23 07:43:39 2002] (debug ) [jk_uriMap.c (639)]  uriMap.mapUri() \nextension match /index.jsp ajp13:204.210.44.99:8009\n[Tue Jul 23 07:43:39 2002] (debug ) [mod_jk2.c (711)]  mod_jk.translate(): \nuriMap /index.jsp ajp13:204.210.44.99:8009 654680\n[Tue Jul 23 07:43:39 2002] (debug ) [mod_jk2.c (599)]  mod_jk.handler() \nserving /*.jsp with 654680 6545e8 204.210.44.99:8009\n[Tue Jul 23 07:43:39 2002] (debug ) [mod_jk2.c (609)]  mod_jk.handler(): new \nrpool 659708\n[Tue Jul 23 07:43:39 2002] ( info ) [jk_service_apache2.c (367)]  service.init\n() Can't find child in scoreboard 2624\n[Tue Jul 23 07:43:39 2002] (debug ) [jk_requtil.c (703)]  serialize.request() \nserialized /index.jsp\n[Tue Jul 23 07:43:40 2002] (debug ) [jk_workerEnv.c (430)]  workerEnv.dispatch\n() Calling 4 sendHeaders\n[Tue Jul 23 07:43:40 2002] (debug ) [jk_handler_response.c (155)]  \nhandler.response() Header[0] [Content-Type] = [text/html;ISO-8859-1]\n[Tue Jul 23 07:43:40 2002] (debug ) [jk_handler_response.c (155)]  \nhandler.response() Header[1] [Set-Cookie] = \n[JSESSIONID=EEFA3E265DCE1EFAF5A690B67170EFD8; Path=/]\n[Tue Jul 23 07:43:40 2002] (debug ) [jk_handler_response.c (172)]  \nhandler.response(): status=200 headers=2\n[Tue Jul 23 07:43:40 2002] (debug ) [jk_service_apache2.c (129)]  service.head\n() 200 2 0x668618\n[Tue Jul 23 07:43:40 2002] (debug ) [jk_service_apache2.c (140)]  service.head\n() Content-Type: text/html;ISO-8859-1 0 2\n[Tue Jul 23 07:43:40 2002] (debug ) [jk_service_apache2.c (140)]  service.head\n() Set-Cookie: JSESSIONID=EEFA3E265DCE1EFAF5A690B67170EFD8; Path=/ 1 2\n[Tue Jul 23 07:43:40 2002] (debug ) [jk_workerEnv.c (430)]  workerEnv.dispatch\n() Calling 3 sendChunk\n[Tue Jul 23 07:43:40 2002] (debug ) [jk_workerEnv.c (430)]  workerEnv.dispatch\n() Calling 5 endResponse\n[Tue Jul 23 07:44:04 2002] (debug ) [jk_uriMap.c (565)]  uriMap.mapUri() \n(null) /tomcat/examples/index.jsp\n[Tue Jul 23 07:44:04 2002] (debug ) [jk_uriMap.c (577)]  uriMap.mapUri() found \nhost (null)\n[Tue Jul 23 07:44:04 2002] (debug ) [jk_uriMap.c (602)]  uriMap.mapUri() found \nctx /tomcat/examples\n[Tue Jul 23 07:44:04 2002] (debug ) [jk_uriMap.c (214)]  uriMap.mapUri() \nsuffix match jsp\n[Tue Jul 23 07:44:04 2002] (debug ) [jk_uriMap.c (639)]  uriMap.mapUri() \nextension match /tomcat/examples/index.jsp ajp13:204.210.44.99:8009\n[Tue Jul 23 07:44:04 2002] (debug ) [jk_workerEnv.c (430)]  workerEnv.dispatch\n() Calling 4 sendHeaders\n[Tue Jul 23 07:44:04 2002] (debug ) [jk_workerEnv.c (430)]  workerEnv.dispatch\n() Calling 3 sendChunk\n[Tue Jul 23 07:44:04 2002] (debug ) [jk_workerEnv.c (430)]  workerEnv.dispatch\n() Calling 3 sendChunk\n[Tue Jul 23 07:44:04 2002] (debug ) [jk_workerEnv.c (430)]  workerEnv.dispatch\n() Calling 3 sendChunk\n[Tue Jul 23 07:44:04 2002] (debug ) [jk_workerEnv.c (430)]  workerEnv.dispatch\n() Calling 5 endResponse\n[Tue Jul 23 07:44:19 2002] (debug ) [jk_workerEnv.c (140)]  destroy worker \najp13:204.210.44.99:8009\n[Tue Jul 23 07:44:19 2002] (debug ) [jk_worker_ajp13.c (794)]  ajp13.destroy() \nclosed 1 cached endpoints\n[Tue Jul 23 07:44:19 2002] (debug ) [jk_workerEnv.c (140)]  destroy worker \nstatus:\n[Tue Jul 23 07:44:19 2002] (debug ) [jk_workerEnv.c (140)]  destroy worker \nlb:lb\n[Tue Jul 23 07:44:19 2002] (debug ) [jk_workerEnv.c (147)]  workerEnv.close() \ndone 3\n\n\nListing 3:\n- - - - - - - - - - - - \n# This should be changed to whatever you set DocumentRoot to.\n#\n<Directory \"E:/InetPub/dfxsys.com\">\n    Options None\n    AllowOverride None\n    Order allow,deny\n    Allow from all\n</Directory>\n\n...\n\n<IfModule mod_dir.c>\n  DirectoryIndex index.html index.jsp\n</IfModule>\n\n...\n\nAlias /tomcat    \"G:/Apache32/src/jakarta-tomcat-4.1.7.base/webapps\"\n\n\nListing 4:\n- - - - - - - - - - \n# Uri mappings:\n\n[uri:/jkstatus/*]\ninfo=Display status information and checks the config file for changes.\ncontex=/jkstatus\ngroup=status:\ndebug=9\n\n# dfxsys.com\n[uri:/*.jsp]\ninfo=Extension mapping\nworker=ajp13:204.210.44.99:8009\ndebug=9\n\n[uri:/servlet/*]\ninfo=Extension mapping\nworker=ajp13:204.210.44.99:8009\ndebug=9\n\n# Tomcat standard examples\n[uri:/tomcat/examples]\ninfo=  ???\ncontext=/tomcat/examples\nworker=ajp13:204.210.44.99:8009\ndebug=9\n\n[uri:/tomcat/examples/*.jsp]\ninfo=Extension mapping\nworker=ajp13:204.210.44.99:8009\ndebug=0\n\n[uri:/tomcat/examples/servlet/*]\ninfo=Prefix mapping\nworker=ajp13:204.210.44.99:8009\ndebug=0\n\n[uri:/tomcat/examples/SendMailServlet]\ninfo=Need this mapping for the send mail example to work\nworker=ajp13:204.210.44.99:8009\ndebug=0\n", "id": 20058, "attachment_id": null, "creator": "miesfeld@acm.org", "creation_time": "2002-07-23T15:06:57Z", "time": "2002-07-23T15:06:57Z", "is_private": false}, {"count": 15, "tags": [], "creator": "bojan@rexursive.com", "attachment_id": null, "id": 20093, "time": "2002-07-24T00:48:37Z", "bug_id": 10789, "creation_time": "2002-07-24T00:48:37Z", "is_private": false, "text": "Mark, I've just commited the version that I actually tested, so it should work :-)\n\nDirectoryIndex will work if the physical file is present. DIR_MAGIC_TYPE is not\nused any more in mod_jk2 since no requests are made to it with handler set to\nthat value. I cannot say why at this point, but this part really behaves in a\ntotally different way than mod_jk 1.2.0.\n\nLet me know what your findings are.\n\nBojan"}, {"count": 16, "tags": [], "bug_id": 10789, "text": "Bojan,\n\nI just rebuilt mod_jk2 with the latest sources.  My 'quick' test shows it to \nbe working.  Both some directories directly under my Apache document root and \nsome of my aliased directories are having the index.jsp file picked up and \nserved.  This evening I will try to test it a little more thoroughly.", "id": 20128, "time": "2002-07-24T13:29:31Z", "creator": "miesfeld@acm.org", "creation_time": "2002-07-24T13:29:31Z", "is_private": false, "attachment_id": null}, {"count": 17, "tags": [], "text": "Please reopen if there are any more problems related to this.\n\nBojan", "attachment_id": null, "id": 20740, "creator": "bojan@rexursive.com", "time": "2002-08-07T07:53:20Z", "bug_id": 10789, "creation_time": "2002-08-07T07:53:20Z", "is_private": false}, {"count": 18, "tags": [], "bug_id": 10789, "attachment_id": null, "id": 30500, "creation_time": "2003-02-02T12:04:07Z", "time": "2003-02-02T12:04:07Z", "creator": "ivanfm@users.sourceforge.net", "text": "I'm using Apache 1.3.27 on RedHat Linux.\nconnectors 2.0.2 with Tomcat 4.1.18\n\nSame problem happens.\n\nApparently the fix was made only for apache 2.0 not for 1.3.\n\nThis can be solved also ?\n\n", "is_private": false}, {"count": 19, "tags": [], "text": "From memory, I think this works with mod_jk 1.2 for both version of Apache. You\ncan try using that instead. Don't know much about mod_jk 2.x, so someone else\nwill have to do this for 1.3. Also, don't use 1.3 any more :-)\n\nBojan", "attachment_id": null, "id": 30522, "creator": "bojan@rexursive.com", "time": "2003-02-02T22:45:21Z", "bug_id": 10789, "creation_time": "2003-02-02T22:45:21Z", "is_private": false}, {"count": 20, "tags": [], "bug_id": 10789, "text": "Using 1.2.2 worked fine.\nwill be good to put something like this in any place on the docs\n\n\"Use only mod_jk 1.2 for Apache 1.3, with jk 2.x not all features will work\"\n\nThanks", "id": 32146, "attachment_id": null, "creator": "ivanfm@users.sourceforge.net", "creation_time": "2003-02-28T12:20:22Z", "time": "2003-02-28T12:20:22Z", "is_private": false}, {"count": 21, "tags": [], "bug_id": 10789, "attachment_id": null, "id": 53126, "time": "2004-02-27T13:58:28Z", "creator": "hgomez@apache.org", "creation_time": "2004-02-27T13:58:28Z", "is_private": false, "text": "Seems to works with the latest jk2 in CVS..."}]