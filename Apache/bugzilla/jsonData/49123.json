[{"count": 0, "tags": [], "text": "Created attachment 25299\nPatch for trunk and/or 2.2.x branch\n\nmod_proxy_ajp only sends the client's SSL certificate to the AJP server. The client's chain (intermediate certificates) are not sent. This is not a problem with self-signed certificates or certificates directly signed by the root CA certificate. However, there's a large number of certificates signed by an intermediate CA certificate, where this is a significant problem: A servlet will not have the possibility to validate the client certificate on its own.\n\nmod_jk was patched back in 2007 to allow sending all of the SSL chain certificates, but mod_proxy_ajp was not updated at the same time (See https://issues.apache.org/bugzilla/show_bug.cgi?id=39636).  In 2008, Mladen Turk mentioned he was planning to add such support to mod_proxy_ajp (See http://www.mail-archive.com/dev@httpd.apache.org/msg41676.html), but it does not look like that ever happened.\n\nSo, I'm attaching a patch which implements this functionality.\n\nIn mod_jk, this was implemented as an option that was disabled by default.  As mod_proxy_ajp does not currently have any options, I decided to skip the option and just enable this by default in mod_proxy_ajp.  I don't believe this will cause any compatibility problems, but I have not thoroughly tested this with old versions of Tomcat/Jetty/etc.  However, I will continue to do testing, and if I find compatibility problems, I will add an option to mod_proxy_ajp to control this behavior.", "attachment_id": 25299, "bug_id": 49123, "id": 136154, "time": "2010-04-14T13:48:29Z", "creator": "apache-bugzilla@PaulSD.com", "creation_time": "2010-04-14T13:48:29Z", "is_private": false}, {"text": "So it didn't take much testing to determine that this cannot be enabled by default, even when used with the latest Tomcat.  A long certificate chain can easily exceed the size of the default AJP packet buffer in Tomcat, requiring a configuration change in Tomcat 5.5.20 or later, and simply breaking older versions of Tomcat.  I will add an option to control this behavior and disable it by default, and add documentation to explain the Tomcat configuration changes needed before enabling it.", "tags": [], "bug_id": 49123, "attachment_id": null, "count": 1, "id": 136183, "time": "2010-04-15T07:16:04Z", "creator": "apache-bugzilla@PaulSD.com", "creation_time": "2010-04-15T07:16:04Z", "is_private": false}, {"count": 2, "tags": [], "creator": "apache-bugzilla@PaulSD.com", "text": "Created attachment 25310\nPatch for trunk and/or 2.2.x branch\n\nAttaching an updated patch which includes a new ProxyAJPForwardSSLCertChain directive (disabled by default) and updated documentation.", "id": 136202, "time": "2010-04-16T11:00:39Z", "bug_id": 49123, "creation_time": "2010-04-16T11:00:39Z", "is_private": false, "attachment_id": 25310}, {"count": 3, "tags": [], "creator": "apache-bugzilla@PaulSD.com", "text": "Created attachment 25311\nPatch for trunk and/or 2.2.x branch\n\nOops, had some typos in that last patch.", "id": 136204, "time": "2010-04-16T11:45:35Z", "bug_id": 49123, "creation_time": "2010-04-16T11:45:35Z", "is_private": false, "attachment_id": 25311}, {"count": 4, "tags": [], "bug_id": 49123, "attachment_id": 25433, "is_private": false, "id": 136828, "time": "2010-05-12T18:44:11Z", "creator": "apache-bugzilla@PaulSD.com", "creation_time": "2010-05-12T18:44:11Z", "text": "Created attachment 25433\nPatch for trunk and/or 2.2.x branch\n\nAdded some extra logging statements to help troubleshooting."}, {"count": 5, "tags": [], "creator": "apache-bugzilla@PaulSD.com", "attachment_id": 25540, "id": 137414, "time": "2010-06-07T12:32:45Z", "bug_id": 49123, "creation_time": "2010-06-07T12:32:45Z", "is_private": false, "text": "Created attachment 25540\nPatch for trunk\n\nUpdated patch to apply cleanly against the current trunk (the same patch can no longer be used for both trunk and the 2.2.x branch)"}, {"count": 6, "tags": [], "bug_id": 49123, "is_private": false, "text": "As mentioned in the documentation included in the patch, note that support for processing of intermediate certificates is only available in Tomcat 5.5.28+ and 6.0.21+ (earlier versions will simply ignore the intermediate certificates in the AJP request ; see https://issues.apache.org/bugzilla/show_bug.cgi?id=37869 and https://issues.apache.org/bugzilla/show_bug.cgi?id=39637 for details).", "id": 150881, "time": "2011-10-24T21:42:27Z", "creator": "apache-bugzilla@PaulSD.com", "creation_time": "2011-10-24T21:42:27Z", "attachment_id": null}, {"count": 7, "tags": [], "creator": "tarno6@gmail.com", "attachment_id": null, "id": 183174, "time": "2015-05-28T22:56:46Z", "bug_id": 49123, "creation_time": "2015-05-28T22:56:46Z", "is_private": false, "text": "Any chance of this getting merged?"}]