[{"count": 0, "tags": [], "creator": "jason@redfish.net", "attachment_id": null, "is_private": false, "id": 186754, "time": "2015-12-02T23:41:37Z", "bug_id": 58682, "creation_time": "2015-12-02T23:41:37Z", "text": "Delete appears to use suboptimal logic to determine whether it can delete a symbolic link.\n\nIf the path is specified with the \"file\" attribute, the task checks for existence and then checks to see whether the entity referenced by the path is a directory. Unfortunately, it uses the file.isDirectory() call, which will return true if the path is a link which *points* to a directory. The task then fails with \"cannot be removed using the file attribute\" error message.\n\nIf the path is specified with the \"dir\" attribute, the task happily deletes the symbolic link, but first deletes everything under the directory *pointed to* by the symbolic link, which is not usually what the developer intended...\n\nThe fix is for the \"file\" case to use Files.isSymbolicLink() to determine whether the entity is a symbolic link, and use the regular delete() call to delete it... and just it!"}, {"count": 1, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "text": "The behavior if the dir attribute is well documented and won't be changed - the usual backwards compatibilty argument applies.\n\nCurrent Ant is bound to support Java5, unless a vote changes this (not that I'd presonally oppose it) the Files class is way out of reach.", "id": 186941, "time": "2015-12-14T17:50:52Z", "bug_id": 58682, "creation_time": "2015-12-14T17:50:52Z", "is_private": false}, {"count": 2, "tags": [], "creator": "jason@redfish.net", "text": "If Files.isSymbolicLink() is not available, then linkiness can be determined from whether the derived path is equal to the absolute path.\n\nIf neither the \"file\" attribute nor the \"dir\" attribute is appropriate for this purpose, then humbly suggest that a \"link\" attribute specify its path. Then, a regular File.delete() call could be used, which would fail if the path turns out to be a directory. (Its linkiness can be optionally determined as above.)\n\nIMHO deleting links to directories should be possible somehow.", "id": 186951, "time": "2015-12-14T22:41:34Z", "bug_id": 58682, "creation_time": "2015-12-14T22:41:34Z", "is_private": false, "attachment_id": null}, {"count": 3, "attachment_id": null, "bug_id": 58682, "is_private": false, "id": 186954, "time": "2015-12-15T05:20:45Z", "creator": "bodewig@apache.org", "creation_time": "2015-12-15T05:20:45Z", "tags": [], "text": "org.apache.tools.ant.util.SymbolicLinkUtils#isSymbolicLink does what you suggest :-)\n\nYou can remove the symlink itself:\n\n$ ls -l\ntotal 8\ndrwxrwxr-x 2 stefanb stefanb 4096 Dez 15 06:14 a\n-rw-rw-r-- 1 stefanb stefanb  123 Dez 15 06:17 build.xml\nlrwxrwxrwx 1 stefanb stefanb    1 Dez 15 06:18 c -> a\n$ cat build.xml \n<project>\n  <delete removeNotFollowedSymlinks=\"true\">\n    <fileset dir=\"c\" followsymlinks=\"false\"/>\n  </delete>\n</project>\n$ ant\nBuildfile: /tmp/58682/build.xml\n\nBUILD SUCCESSFUL\nTotal time: 0 seconds\n$ ls -l\ntotal 8\ndrwxrwxr-x 2 stefanb stefanb 4096 Dez 15 06:14 a\n-rw-rw-r-- 1 stefanb stefanb  123 Dez 15 06:17 build.xml"}, {"count": 4, "tags": [], "bug_id": 58682, "text": "Thanks so much for the response. This solution is perfectly fine :-)", "id": 187228, "time": "2015-12-29T19:20:15Z", "creator": "jason@redfish.net", "creation_time": "2015-12-29T19:20:15Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "text": "Stefans solution was accepted so I close this entry.", "is_private": false, "bug_id": 58682, "id": 187269, "time": "2015-12-30T19:39:54Z", "creator": "jan@materne.de", "creation_time": "2015-12-30T19:39:54Z", "attachment_id": null}]