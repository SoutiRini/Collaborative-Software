[{"count": 0, "tags": [], "creator": "jorge.soria@tietotech.no", "attachment_id": null, "id": 21585, "time": "2002-08-23T11:09:34Z", "bug_id": 11966, "creation_time": "2002-08-23T11:09:34Z", "is_private": false, "text": "If the database field for the user's password contains a NULL, this class produses the following \nerror:\n\njava.lang.NullPointerException\n\tat \norg.apache.catalina.realm.JDBCRealm.authenticate(JDBCRealm.java:379)\n\tat \norg.apache.catalina.realm.JDBCRealm.authenticate(JDBCRealm.java:326)\n\tat \norg.apache.catalina.authenticator.FormAuthenticator.authenticate(FormAuthenticator.java:263)\n\tat \norg.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:462)\n\tat \norg.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:564)\n\tat \norg.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:472)\n\tat \norg.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat \norg.apache.catalina.core.StandardContext.invoke(StandardContext.java:2343)\n\tat \norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:180)\n\tat \norg.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:566)\n\tat \norg.apache.catalina.valves.ErrorDispatcherValve.invoke(ErrorDispatcherValve.java:170)\n\tat \norg.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:564)\n\tat \norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:170)\n\tat \norg.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:564)\n\tat \norg.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:468)\n\tat \norg.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:564)\n\tat \norg.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:472)\n\tat \norg.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat \norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:174)\n\tat \norg.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:566)\n\tat \norg.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:472)\n\tat \norg.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n\tat \norg.apache.catalina.connector.http.HttpProcessor.process(HttpProcessor.java:1012)\n\tat \norg.apache.catalina.connector.http.HttpProcessor.run(HttpProcessor.java:1107)\n\tat \njava.lang.Thread.run(Unknown Source)"}, {"count": 1, "attachment_id": null, "bug_id": 11966, "text": "The problem is in JDBCRealm.java.   The problem is that the Password String is \ntrimmed before testing for null.   The patch is as follows\n\n--- C:/modules/apache.org/jakarta-tomcat-\n4.0/catalina/src/share/org/apache/catalina/realm/JDBCRealm.java\t9 Jun 2002 \n02:19:43 -0000\t1.21\n+++ C:/modules/apache.org/jakarta-tomcat-\n4.0/catalina/src/share/org/apache/catalina/realm/JDBCRealm.java\t23 Aug 2002 \n12:35:19 -0000\n@@ -444,12 +444,13 @@\n         PreparedStatement stmt = credentials(dbConnection, username);\n         ResultSet rs = stmt.executeQuery();\n         while (rs.next()) {\n-            dbCredentials = rs.getString(1).trim();\n+            dbCredentials = rs.getString(1);\n         }\n         rs.close();\n         if (dbCredentials == null) {\n             return (null);\n         }\n+        dbCredentials.trim(); //cannot trim until we test for null\n \n         // Validate the user's credentials\n         boolean validated = false;\n", "id": 21591, "time": "2002-08-23T12:38:44Z", "creator": "andrewconrad@iname.com", "creation_time": "2002-08-23T12:38:44Z", "tags": [], "is_private": false}, {"count": 2, "attachment_id": 2813, "bug_id": 11966, "text": "Created attachment 2813\nDiff file for JDBCRealm.java", "id": 21594, "time": "2002-08-23T12:42:37Z", "creator": "andrewconrad@iname.com", "creation_time": "2002-08-23T12:42:37Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 11966, "attachment_id": null, "is_private": false, "id": 42305, "time": "2003-08-07T01:11:49Z", "creator": "funkman@joedog.org", "creation_time": "2003-08-07T01:11:49Z", "text": "\n\n*** This bug has been marked as a duplicate of 7116 ***"}]