[{"count": 0, "tags": [], "bug_id": 7492, "attachment_id": null, "is_private": false, "id": 12349, "time": "2002-03-26T17:55:12Z", "creator": "yuriy.ryabikov@yessoftware.com", "creation_time": "2002-03-26T17:55:12Z", "text": "-begin----httpd.conf-----\n\n<Directory \"C:/Program Files/Apache Group/Apache/htdocs\">\n    Options Indexes FollowSymLinks\n    AllowOverride All\nRewriteEngine on\nRewriteRule ^(.*)$ $1/%{REMOTE_ADDR}\nRewriteRule ^(.*)$ ${AntiLeech:$1|/leech2.html}\n    Order allow,deny\n    Allow from all\n</Directory>\n\n<VirtualHost *:87>\n     ServerAdmin webmaster@localhost\n     DocumentRoot \"C:/Program Files/Apache Group/Apache/htdocs\"\n     ServerName localhost\n\nRewriteEngine on\nRewriteMap AntiLeech prg:C:/PROGRA~1/APACHE~1/APACHE/HTDOCS/1.pl\nRewriteLog \"C:/PROGRA~1/APACHE~1/APACHE/HTDOCS/rewrite.log\"\nRewriteLogLevel 9\n</VirtualHost>\n\n\n--end-----httpd.conf-----\n\n-begin----rewrite.log-----\n10.1.1.2 - - [26/Mar/2002:19:52:15 +0200] [localhost/sid#8d7ab8]\n[rid#96d640/initial] (2) init rewrite engine with requested uri /fgdfgdf\n10.1.1.2 - - [26/Mar/2002:19:52:15 +0200] [localhost/sid#8d7ab8]\n[rid#96d640/initial] (1) pass through /fgdfgdf\n10.1.1.2 - - [26/Mar/2002:19:52:15 +0200] [localhost/sid#8d7ab8]\n[rid#96d640/initial] (3) [per-dir c:/program files/apache group/apache/htdocs/] \nstrip per-dir prefix: c:/program files/apache group/apache/htdocs/fgdfgdf -> \nfgdfgdf\n10.1.1.2 - - [26/Mar/2002:19:52:15 +0200] [localhost/sid#8d7ab8]\n[rid#96d640/initial] (3) [per-dir c:/program files/apache group/apache/htdocs/] \napplying pattern '^(.*)$' to uri 'fgdfgdf'\n10.1.1.2 - - [26/Mar/2002:19:52:15 +0200] [localhost/sid#8d7ab8]\n[rid#96d640/initial] (2) [per-dir c:/program files/apache group/apache/htdocs/] \nrewrite fgdfgdf -> fgdfgdf/10.1.1.2\n10.1.1.2 - - [26/Mar/2002:19:52:15 +0200] [localhost/sid#8d7ab8]\n[rid#96d640/initial] (3) [per-dir c:/program files/apache group/apache/htdocs/] \nadd per-dir prefix: fgdfgdf/10.1.1.2 -> c:/program files/apache \ngroup/apache/htdocs/fgdfgdf/10.1.1.2\n10.1.1.2 - - [26/Mar/2002:19:52:15 +0200] [localhost/sid#8d7ab8]\n[rid#96d640/initial] (3) [per-dir c:/program files/apache group/apache/htdocs/] \nadd per-dir prefix: c:/program files/apache \ngroup/apache/htdocs/fgdfgdf/10.1.1.2 -> c:/program files/apache \ngroup/apache/htdocs/c:/program files/apache group/apache/htdocs/fgdfgdf/10.1.1.2\n10.1.1.2 - - [26/Mar/2002:19:52:15 +0200] [localhost/sid#8d7ab8]\n[rid#96d640/initial] (3) [per-dir c:/program files/apache group/apache/htdocs/] \nstrip per-dir prefix: c:/program files/apache group/apache/htdocs/c:/program \nfiles/apache group/apache/htdocs/fgdfgdf/10.1.1.2 -> c:/program files/apache \ngroup/apache/htdocs/fgdfgdf/10.1.1.2\n10.1.1.2 - - [26/Mar/2002:19:52:15 +0200] [localhost/sid#8d7ab8]\n[rid#96d640/initial] (3) [per-dir c:/program files/apache group/apache/htdocs/] \napplying pattern '^(.*)$' to uri 'c:/program files/apache \ngroup/apache/htdocs/fgdfgdf/10.1.1.2'\n10.1.1.2 - - [26/Mar/2002:19:52:15 +0200] [localhost/sid#8d7ab8]\n[rid#96d640/initial] (5) map lookup OK: map=AntiLeech key=$1 -> val=\n10.1.1.2 - - [26/Mar/2002:19:52:15 +0200] [localhost/sid#8d7ab8]\n[rid#96d640/initial] (2) [per-dir c:/program files/apache group/apache/htdocs/] \nrewrite c:/program files/apache group/apache/htdocs/fgdfgdf/10.1.1.2 -> \n10.1.1.2 - - [26/Mar/2002:19:52:15 +0200] [localhost/sid#8d7ab8]\n[rid#96d640/initial] (3) [per-dir c:/program files/apache group/apache/htdocs/] \nadd per-dir prefix:  -> c:/program files/apache group/apache/htdocs/\n10.1.1.2 - - [26/Mar/2002:19:52:15 +0200] [localhost/sid#8d7ab8]\n[rid#96d640/initial] (3) [per-dir c:/program files/apache group/apache/htdocs/] \nadd per-dir prefix: c:/program files/apache group/apache/htdocs/ -> c:/program \nfiles/apache group/apache/htdocs/c:/program files/apache group/apache/htdocs/\n--end-----rewrite.log-----"}, {"count": 1, "tags": [], "creator": "slive@apache.org", "attachment_id": null, "id": 12363, "time": "2002-03-26T22:14:07Z", "bug_id": 7492, "creation_time": "2002-03-26T22:14:07Z", "is_private": false, "text": "Could you please describe the exact problem you are experiencing?  Is it the \nfact that the key is not getting substituted properly in the RewriteMap?\n\nYou obviously have problems with the per-dir prefix getting added more than\nonce, but that is because you aren't using RewriteBase like you should be.\nOr alternatively, you should not place the RewriteRules inside a\n<Directory> section."}, {"count": 2, "tags": [], "creator": "yuriy.ryabikov@yessoftware.com", "text": "Created attachment 1431\nhttpd.conf", "id": 12376, "time": "2002-03-27T07:54:16Z", "bug_id": 7492, "creation_time": "2002-03-27T07:54:16Z", "is_private": false, "attachment_id": 1431}, {"count": 3, "tags": [], "bug_id": 7492, "attachment_id": 1432, "id": 12377, "time": "2002-03-27T07:54:53Z", "creator": "yuriy.ryabikov@yessoftware.com", "creation_time": "2002-03-27T07:54:53Z", "is_private": false, "text": "Created attachment 1432\nrewrite.log"}, {"count": 4, "tags": [], "bug_id": 7492, "attachment_id": 1433, "text": "Created attachment 1433\nperl CGI", "id": 12378, "time": "2002-03-27T07:55:35Z", "creator": "yuriy.ryabikov@yessoftware.com", "creation_time": "2002-03-27T07:55:35Z", "is_private": false}, {"count": 5, "text": "Joshua,\n\nThank you for reply.\nPlease take a look at the line from rewrite log:\n  map lookup OK: map=AntiLeech key=$1 -> val=\n1. back-reference to pattern does is not resolved to URI as it should be,\nwhen used within rewrite-map reference\n  RewriteRule ^(.*)$ ${AntiLeech:$1|/leech2.html}\n2. rewrite map program does not receive any input, as it's evident from empty\nperl log, which I forgot to mention, and turned off buffering in attached perl\nscript.\n3. This bug is exposed only under Win32. Under UNIX RewriteMap works ok,\nall vars are subsituted, and per-dir prefix is added only once (latter may be\nbecause of slightly different directory layout, but that's another issue. BTW,\nRewriteBase does not help).\n\n", "bug_id": 7492, "attachment_id": null, "id": 12380, "time": "2002-03-27T08:22:30Z", "creator": "yuriy.ryabikov@yessoftware.com", "creation_time": "2002-03-27T08:22:30Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "creator": "slive@apache.org", "is_private": false, "text": "OK.  I'm not sure if prg: rewritemaps have ever worked in win32.  I'm\nupdating the summary to better direct attention.", "id": 12389, "time": "2002-03-27T15:03:50Z", "bug_id": 7492, "creation_time": "2002-03-27T15:03:50Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 7492, "is_private": false, "text": "May be will fixed in next version? ^)", "id": 12394, "time": "2002-03-27T15:07:23Z", "creator": "yuriy.ryabikov@yessoftware.com", "creation_time": "2002-03-27T15:07:23Z", "attachment_id": null}, {"count": 8, "text": "This bug is difficult to address in Apache 1.3.x.  Not impossible, but\ndifficult.  As guessed, this has never worked in the 1.3 series.\n\nApache 2.0.x introduced new APIs for determining fully qualified path\nnames.  Mod_rewrite in Apache 2.0 was updated in v. 1.84 to accept \nany rooted path (based on the filesystem convention, e.g. c:/foo for \nwin32, or foo/bar:bleh for Netware.)\n\nhttp://cvs.apache.org/viewcvs/httpd-2.0/modules/mappers/mod_rewrite.c.diff?r1=1.83&r2=1.84&diff_format=h\n\nThere may also be thread saftey problems with the rewrite cache,\nintroduced in Apache 2.0's v. 1.83, that would need backporting.\n\nhttp://cvs.apache.org/viewcvs/httpd-2.0/modules/mappers/mod_rewrite.c.diff?r1=1.82&r2=1.83&diff_format=h\n\nFinally, it seems that ap_pstrcat is still being used to merge paths\nin 1.3 and 2.0.  This should be fixed in 2.0 to use apr_filepath_merge,\nand there was a similar API in 1.3.\n\nSo this can be fixed, but someone needs to take the time to write and\ntest the fixes.  I'd entertain applying a patch that was well thought out.\n\n", "bug_id": 7492, "attachment_id": null, "id": 14076, "time": "2002-04-19T18:47:48Z", "creator": "wrowe@apache.org", "creation_time": "2002-04-19T18:47:48Z", "tags": [], "is_private": false}, {"count": 9, "tags": [], "bug_id": 7492, "attachment_id": null, "text": "\n  Patch applied, this report will be resolved in 1.3.26.  Thread saftey of\n  the rewrite cache remains an issue, creating a new incident for tracking\n  thread saftey.", "id": 14334, "time": "2002-04-22T17:11:20Z", "creator": "wrowe@apache.org", "creation_time": "2002-04-22T17:11:20Z", "is_private": false}, {"count": 10, "tags": [], "bug_id": 7492, "text": "\n  Make that, fixed in the forthcoming 1.3.25.", "id": 14339, "time": "2002-04-22T17:41:55Z", "creator": "wrowe@apache.org", "creation_time": "2002-04-22T17:41:55Z", "is_private": false, "attachment_id": null}, {"count": 11, "text": "*** Bug 8424 has been marked as a duplicate of this bug. ***", "bug_id": 7492, "attachment_id": null, "id": 24262, "time": "2002-10-10T11:17:07Z", "creator": "trawick@apache.org", "creation_time": "2002-10-10T11:17:07Z", "tags": [], "is_private": false}, {"count": 12, "tags": [], "creator": "bugzilla@zipfly.de", "text": "I stepped into this bug, too. Then I found this bug report, downloaded Apache\n1.3.27, but I still have the same problem! \n\nMy .htaccess:\n\nRewriteEngine On\nRewriteRule ^vpserve.php - [L]\nRewriteRule ^(.*) vpserve.php \n\nThe resulting rewrite log:\n\n127.0.0.1 - - [30/Mar/2003:16:11:11 +0200]\n[vp.savignano.local/sid#5d82c8][rid#682450/initial] (3) [per-dir\nc:/themen/sss/htdocs/_tests/vistapoint/] add path-info postfix:\nc:/themen/sss/htdocs/_tests/vistapoint -> c:/themen/sss/htdocs/_tests/vistapoint/\n127.0.0.1 - - [30/Mar/2003:16:11:11 +0200]\n[vp.savignano.local/sid#5d82c8][rid#682450/initial] (3) [per-dir\nc:/themen/sss/htdocs/_tests/vistapoint/] strip per-dir prefix:\nc:/themen/sss/htdocs/_tests/vistapoint/ -> \n127.0.0.1 - - [30/Mar/2003:16:11:11 +0200]\n[vp.savignano.local/sid#5d82c8][rid#682450/initial] (3) [per-dir\nc:/themen/sss/htdocs/_tests/vistapoint/] applying pattern '^vpserve.php' to uri ''\n127.0.0.1 - - [30/Mar/2003:16:11:11 +0200]\n[vp.savignano.local/sid#5d82c8][rid#682450/initial] (3) [per-dir\nc:/themen/sss/htdocs/_tests/vistapoint/] add path-info postfix:\nc:/themen/sss/htdocs/_tests/vistapoint -> c:/themen/sss/htdocs/_tests/vistapoint/\n127.0.0.1 - - [30/Mar/2003:16:11:11 +0200]\n[vp.savignano.local/sid#5d82c8][rid#682450/initial] (3) [per-dir\nc:/themen/sss/htdocs/_tests/vistapoint/] strip per-dir prefix:\nc:/themen/sss/htdocs/_tests/vistapoint/ -> \n127.0.0.1 - - [30/Mar/2003:16:11:11 +0200]\n[vp.savignano.local/sid#5d82c8][rid#682450/initial] (3) [per-dir\nc:/themen/sss/htdocs/_tests/vistapoint/] applying pattern '^(.*)' to uri ''\n127.0.0.1 - - [30/Mar/2003:16:11:11 +0200]\n[vp.savignano.local/sid#5d82c8][rid#682450/initial] (2) [per-dir\nc:/themen/sss/htdocs/_tests/vistapoint/] rewrite  -> vpserve.php\n127.0.0.1 - - [30/Mar/2003:16:11:11 +0200]\n[vp.savignano.local/sid#5d82c8][rid#682450/initial] (3) [per-dir\nc:/themen/sss/htdocs/_tests/vistapoint/] add per-dir prefix: vpserve.php ->\nc:/themen/sss/htdocs/_tests/vistapoint/vpserve.php\n127.0.0.1 - - [30/Mar/2003:16:11:11 +0200]\n[vp.savignano.local/sid#5d82c8][rid#682450/initial] (3) [per-dir\nc:/themen/sss/htdocs/_tests/vistapoint/] add per-dir prefix:\nc:/themen/sss/htdocs/_tests/vistapoint/vpserve.php ->\nc:/themen/sss/htdocs/_tests/vistapoint/c:/themen/sss/htdocs/_tests/vistapoint/vpserve.php\n\nFor some reason, the directroy preix is still added twice.\n\nI re-opened the bug, but a work-around hint would be helpful as well.", "id": 34129, "time": "2003-03-30T14:30:31Z", "bug_id": 7492, "creation_time": "2003-03-30T14:30:31Z", "is_private": false, "attachment_id": null}, {"count": 13, "text": "Sorry, I missed the fact that the modules were changed from .dll to .so in some\nversion, and did not update the httpd.conf accordingly.\n\nI discovered this a few minutes ago and corrected the mistake. Now it works\nflawlessly.\n\nMea culpa!", "bug_id": 7492, "attachment_id": null, "id": 34134, "time": "2003-03-30T19:37:21Z", "creator": "bugzilla@zipfly.de", "creation_time": "2003-03-30T19:37:21Z", "tags": [], "is_private": false}]