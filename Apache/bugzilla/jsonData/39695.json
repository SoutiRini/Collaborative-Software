[{"count": 0, "tags": [], "creator": "jeff@drost.com", "attachment_id": null, "id": 89624, "time": "2006-05-31T20:43:51Z", "bug_id": 39695, "creation_time": "2006-05-31T20:43:51Z", "is_private": false, "text": "I have tried both the release at http://people.apache.org/~tcurdt/bcel/rc2/ , as\nwell as a build from head (410655).  I see the same ClassFormatError with both.\n\nI get this error when running a JRat test case.  This project and the test case\nis avalible on sourceforge (http://sourceforge.net/projects/jrat) - or I can\nprovide it directly.  The test case uses BCEL to isntrument a class and then\ntries to execute methods various methods on it.\n\nsee org.shiftone.jrat.test.InjectorTestCase\n\n\njava.lang.ClassFormatError: LVTT entry for 'local' in class file\norg/shiftone/jrat/test/dummy/CrashTestDummy does not match any LVT entry\n\tat java.lang.ClassLoader.defineClass1(Native Method)\n\tat java.lang.ClassLoader.defineClass(ClassLoader.java:620)\n\tat java.lang.ClassLoader.defineClass(ClassLoader.java:465)\n\tat org.shiftone.jrat.test.TestClassLoader.loadClass(TestClassLoader.java:36)\n\tat org.shiftone.jrat.test.InjectorTestCase.setUp(InjectorTestCase.java:52)\n\tat com.intellij.rt.execution.junit2.JUnitStarter.main(JUnitStarter.java:32)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat com.intellij.rt.execution.application.AppMain.main(AppMain.java:90)"}, {"count": 1, "tags": [], "bug_id": 39695, "attachment_id": null, "is_private": false, "id": 89625, "time": "2006-05-31T20:55:24Z", "creator": "jeff@drost.com", "creation_time": "2006-05-31T20:55:24Z", "text": "Compiling with -g:lines,source fixes the problem however this is not an\nacceptable option for me since a user may want to profile code that they didn't\nwrite or have the source for."}, {"count": 2, "tags": [], "bug_id": 39695, "text": "fair enough ...could you provide a patch? With some luck it could then still make it into 5.2", "id": 89627, "attachment_id": null, "creator": "tcurdt@apache.org", "creation_time": "2006-06-01T00:25:02Z", "time": "2006-06-01T00:25:02Z", "is_private": false}, {"count": 3, "tags": [], "creator": "johann.uhrmann@xpecto.com", "attachment_id": null, "id": 95316, "time": "2006-11-02T00:10:28Z", "bug_id": 39695, "creation_time": "2006-11-02T00:10:28Z", "is_private": false, "text": "Changed the severity to \"critical\" because it renders BCEL useless on Java5 or\nnewer."}, {"text": "What's the status here? Did you try with trunk? Would be great if you could\nattach the testcase.", "tags": [], "bug_id": 39695, "is_private": false, "count": 4, "id": 100255, "time": "2007-03-10T07:36:00Z", "creator": "tcurdt@apache.org", "creation_time": "2007-03-10T07:36:00Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 39695, "is_private": false, "id": 101069, "attachment_id": null, "creator": "erik@jpox.org", "creation_time": "2007-03-27T15:18:08Z", "time": "2007-03-27T15:18:08Z", "text": "Just tried with HEAD and does not work\n\njava.lang.ClassFormatError: LVTT entry for 'employees' in class file"}, {"count": 6, "tags": [], "bug_id": 39695, "attachment_id": null, "text": "The classes I'm using against trunk HEAD. Hope this helps\n\nclass Department implements java.io.Serializable\n{\n    private Collection<Employee> employees;\n\n    public Collection<Employee> getEmployees()\n    {\n        return employees;\n    }\n    public void setEmployees(Collection<Employee> employees)\n    {\n        this.employees = employees;\n    }\n\n}\n\nclass Employee implements java.io.Serializable\n{\n    private String name;\n}", "id": 101070, "time": "2007-03-27T15:22:07Z", "creator": "erik@jpox.org", "creation_time": "2007-03-27T15:22:07Z", "is_private": false}, {"count": 7, "tags": [], "creator": "erik@jpox.org", "attachment_id": 19834, "id": 101122, "time": "2007-03-28T11:41:30Z", "bug_id": 39695, "creation_time": "2007-03-28T11:41:30Z", "is_private": false, "text": "Created attachment 19834\ncopying the LVTT entries from method to MethodGen\n\nThis patch fixes this issue to me.\n\nThe fix is with copying the LVTT entries from method to MethodGen.\n\nIn addition, a cosmetic change in the MethodGen.toString method to output the\nsignature attributes, same as Method.toString does."}, {"count": 8, "tags": [], "bug_id": 39695, "is_private": false, "id": 101126, "attachment_id": null, "creator": "erik@jpox.org", "creation_time": "2007-03-28T11:59:58Z", "time": "2007-03-28T11:59:58Z", "text": "I forgot to say that the patch attached (2007-03-28 11:41), fix the case where a\nsetter having a generic argument is bytecode modified using BCEL. I dont know if\nthere are other cases. The patch works for me, for several classes and several\nscenarios.\n\n    public void setEmployees(Collection<Employee> employees)\n    {\n        this.employees = employees;\n    }\n"}, {"count": 9, "tags": [], "creator": "tcurdt@apache.org", "attachment_id": null, "id": 101301, "time": "2007-04-01T07:59:17Z", "bug_id": 39695, "creation_time": "2007-04-01T07:59:17Z", "is_private": false, "text": "Thanks! Applied!"}]