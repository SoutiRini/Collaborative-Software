[{"count": 0, "tags": [], "creator": "mrlal_tvm@yahoo.com", "attachment_id": null, "text": "This file gets opened in '2.5.1-final' but wont open in 'poi-3.0.2-FINAL'.\n\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:199)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:117)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:207)\n\tat TestUserHome.main(TestUserHome.java:29)\nCaused by: java.lang.reflect.InvocationTargetException\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:494)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:187)\n\t... 3 more\nCaused by: java.lang.ArrayIndexOutOfBoundsException\n\tat org.apache.poi.hssf.record.RecordInputStream.checkRecordPosition(RecordInputStream.java:132)\n\tat org.apache.poi.hssf.record.RecordInputStream.readShort(RecordInputStream.java:152)\n\tat org.apache.poi.hssf.util.HSSFCellRangeAddress.fillFields(HSSFCellRangeAddress.java:77)\n\tat org.apache.poi.hssf.util.HSSFCellRangeAddress.<init>(HSSFCellRangeAddress.java:65)\n\tat org.apache.poi.hssf.record.DVRecord.fillFields(DVRecord.java:208)\n\tat org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n\tat org.apache.poi.hssf.record.DVRecord.<init>(DVRecord.java:134)\n\t... 8 more", "id": 115123, "time": "2008-03-31T00:09:13Z", "bug_id": 44710, "creation_time": "2008-03-31T00:09:13Z", "is_private": false}, {"count": 1, "text": "Created attachment 21739\nExcel File", "bug_id": 44710, "is_private": false, "id": 115124, "time": "2008-03-31T00:10:03Z", "creator": "mrlal_tvm@yahoo.com", "creation_time": "2008-03-31T00:10:03Z", "tags": [], "attachment_id": 21739}, {"count": 2, "tags": [], "text": "Have you tried with a recent svn checkout / nightly build? There have been some fixes to DVRecord since 3.0.2\n\nYou can get a nightly build from http://encore.torchbox.com/poi-svn-build/", "attachment_id": null, "id": 115139, "creator": "apache@gagravarr.org", "time": "2008-03-31T07:08:54Z", "bug_id": 44710, "creation_time": "2008-03-31T07:08:54Z", "is_private": false}, {"count": 3, "tags": [], "text": "Thanks for your comments.\n\nToday I tried with the latest build (ie  poi-source-3.1-alpha1-20080330.zip 30-Mar-2008 05:32 2.0M )\n\nNow the following error is thrown.\n\nWARNING: POIFS is closing the supplied input stream of type (java.io.BufferedInputStream) which supports mark/reset.  This will be a problem for the caller if the stream will still be used.  If that is the case the caller should wrap the input stream to avoid this close logic.  This warning is only temporary and will not be present in future versions of POI.\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:206)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:124)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:204)\n\tat TestUserHome.main(TestUserHome.java:29)\nCaused by: java.lang.reflect.InvocationTargetException\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:494)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:194)\n\t... 3 more\nCaused by: java.lang.ArrayIndexOutOfBoundsException\n\tat org.apache.poi.hssf.record.RecordInputStream.checkRecordPosition(RecordInputStream.java:132)\n\tat org.apache.poi.hssf.record.RecordInputStream.readShort(RecordInputStream.java:152)\n\tat org.apache.poi.hssf.util.HSSFCellRangeAddress.fillFields(HSSFCellRangeAddress.java:80)\n\tat org.apache.poi.hssf.util.HSSFCellRangeAddress.<init>(HSSFCellRangeAddress.java:70)\n\tat org.apache.poi.hssf.record.DVRecord.fillFields(DVRecord.java:207)\n\tat org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n\tat org.apache.poi.hssf.record.DVRecord.<init>(DVRecord.java:134)\n\t... 8 more\n", "attachment_id": null, "id": 115178, "creator": "mrlal_tvm@yahoo.com", "time": "2008-03-31T23:08:30Z", "bug_id": 44710, "creation_time": "2008-03-31T23:08:30Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 44710, "attachment_id": null, "id": 115179, "time": "2008-03-31T23:09:54Z", "creator": "mrlal_tvm@yahoo.com", "creation_time": "2008-03-31T23:09:54Z", "is_private": false, "text": "Sorry this is the ERROR.\n\nWARNING: POIFS is closing the supplied input stream of type (java.io.BufferedInputStream) which supports mark/reset.  This will be a problem for the caller if the stream will still be used.  If that is the case the caller should wrap the input stream to avoid this close logic.  This warning is only temporary and will not be present in future versions of POI.\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:206)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:124)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:204)\n\tat TestUserHome.main(TestUserHome.java:29)\nCaused by: java.lang.reflect.InvocationTargetException\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:494)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:194)\n\t... 3 more\nCaused by: java.lang.UnsupportedOperationException:  Unknown Ptg in Formula: 0xffffffff (-1)\n\tat org.apache.poi.hssf.record.formula.Ptg.createPtg(Ptg.java:361)\n\tat org.apache.poi.hssf.record.DVRecord.fillFields(DVRecord.java:201)\n\tat org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n\tat org.apache.poi.hssf.record.DVRecord.<init>(DVRecord.java:134)\n\t... 8 more\n"}, {"count": 5, "tags": [], "bug_id": 44710, "text": "Fixed in svn r643654.\n\nThere was an incorrect call to input stream skip() in DVRecord.fillFields(RecordInputStream).  I have not written a junit for this because there seems to be many other things wrong with DVRecord.\n\nI have closed this bug because this specific problem should not occur anymore. With the patch, HSSFWorkbook.<init>(InputStream) completes OK now.  \n\nHowever, if you need to re-write the spreadsheet back to an XLS file, you are likely to encounter more bugs.  I have opened bug 44735 to track all of those problems.", "id": 115215, "time": "2008-04-01T16:58:54Z", "creator": "josh@apache.org", "creation_time": "2008-04-01T16:58:54Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "creator": "josh@apache.org", "text": "*** Bug 44951 has been marked as a duplicate of this bug. ***", "id": 116369, "time": "2008-05-07T19:33:13Z", "bug_id": 44710, "creation_time": "2008-05-07T19:33:13Z", "is_private": false, "attachment_id": null}]