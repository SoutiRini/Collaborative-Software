[{"count": 0, "tags": [], "bug_id": 57482, "attachment_id": 32390, "is_private": false, "id": 180466, "time": "2015-01-22T08:31:25Z", "creator": "isaokk3@gmail.com", "creation_time": "2015-01-22T08:31:25Z", "text": "Created attachment 32390\nNumeric value only Excel (xlsx) and Unit test\n\nI got the following stack trace when creaing XSSFWorkbook with PackageAccess.READ:\n\nUnstructured_Data_0,0: org.apache.poi.POIXMLException: org.apache.poi.openxml4j.exceptions.InvalidOperationException: Operation not allowed, document open in read only mode!\n    at org.apache.poi.POIXMLDocumentPart.createRelationship(POIXMLDocumentPart.java:370)\n    at org.apache.poi.POIXMLDocumentPart.createRelationship(POIXMLDocumentPart.java:330)\n    at org.apache.poi.xssf.usermodel.XSSFWorkbook.onDocumentRead(XSSFWorkbook.java:274)\n    at org.apache.poi.POIXMLDocument.load(POIXMLDocument.java:159)\n    at org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:186)\n   ...\n\nMy code is like below.\n   XSSFWorkbook workbook = new XSSFWorkbook(OPCPackage.open(file.getAbsolutePath(), PackageAccess.READ));\n\nIt usually works fine; however the above exception occurs when reading some Excel (xlsx) files. I found similar bug reports such as 55948 and 56675, but unfortunately they are not fixed yet.\n\nAs a result of my investigation, I recognized this issue occurs when reading an xlsx file that contains only numeric data. In this case there is no shared string table, POI tries to create a new part named \"/xl/sharedStrings.xml\" and then throws the exception.\nIt seems a POI logic issue. It should be allowed even if PackageAccess.READ is specified."}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 180475, "time": "2015-01-22T11:46:14Z", "bug_id": 57482, "creation_time": "2015-01-22T11:46:14Z", "is_private": false, "text": "Thanks for this\n\nI've slightly re-worked your unit test, and added it in r1653814.\n\nNow to fix it..."}, {"count": 2, "tags": [], "bug_id": 57482, "attachment_id": null, "id": 180476, "time": "2015-01-22T12:18:06Z", "creator": "apache@gagravarr.org", "creation_time": "2015-01-22T12:18:06Z", "is_private": false, "text": "Should be fixed as of r1653825 - in read only mode we now create an empty unbound shared strings table or styles table to get through the reading calls which might use them\n\n(Unbound is fine, as writing out isn't supported from a read-only package)\n\nThanks for your help!"}, {"count": 3, "attachment_id": null, "creator": "dominik.stadler@gmx.at", "is_private": false, "id": 180483, "time": "2015-01-22T15:02:34Z", "bug_id": 57482, "creation_time": "2015-01-22T15:02:34Z", "tags": [], "text": "*** Bug 56675 has been marked as a duplicate of this bug. ***"}, {"count": 4, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "id": 180485, "time": "2015-01-22T15:04:09Z", "bug_id": 57482, "creation_time": "2015-01-22T15:04:09Z", "is_private": false, "text": "*** Bug 55948 has been marked as a duplicate of this bug. ***"}]