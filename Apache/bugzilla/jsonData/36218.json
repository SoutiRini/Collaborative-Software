[{"attachment_id": null, "tags": [], "creator": "dirk.dekok@lostboys.nl", "text": "when using clustering the Principal seems not to be replicated correctly\nIt seems to be linked to the UserDatabaseRealm, using a o.a.c.users.MemoryUser \nprincipal instead of a GenericPrincipal\n\nsee:\nhttp://www.mail-archive.com/tomcat-dev@jakarta.apache.org/msg74250.html", "count": 0, "id": 78566, "time": "2005-08-17T11:32:45Z", "bug_id": 36218, "creation_time": "2005-08-17T11:32:45Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 36218, "attachment_id": null, "id": 78570, "time": "2005-08-17T12:46:28Z", "creator": "pr@objektpark.de", "creation_time": "2005-08-17T12:46:28Z", "is_private": false, "text": "Now the UserDatabaseRealm also create GenericPrincipal class\nand at my test cases with basic login config at web.xml it works.\n\nOK, the set userPrincipal from GenericPrincipal are not transfered and this can\nbe a problem. \n\nPlease, can you checkout the last tomcat cvs head and test the fix?\n\nThanks\nPeter"}, {"attachment_id": null, "tags": [], "creator": "dirk.dekok@lostboys.nl", "text": "I tested it with the MemoryRealm settings using tomcat-users.xml for data of \nusers, and the fix works. This with FORM authentication.\n\nhowever,\nwe would like to use our custom JAAS login module. For this we programmed a \nmodule, and added 2 Principals to the config for user and role. These classes \nextend java.security.Principal. And this does not work yet.\n\nI think it has to do with the method  createPrincipal(String username, Subject \nsubject) in org.apache.catalina.realm.JAASRealm. All the other real \nimplementations deal with GenericPrincipal, while here java.security.Principal \nis used.\n\n", "count": 2, "id": 78642, "time": "2005-08-18T18:09:04Z", "bug_id": 36218, "creation_time": "2005-08-18T18:09:04Z", "is_private": false}, {"count": 3, "tags": [], "creator": "pr@objektpark.de", "attachment_id": null, "text": "Hmm,\n\nthe JAASRealm.createPrincipal return a GenericPrincipal\ns. L.509\n        // Return the resulting Principal for our authenticated user\n        return new GenericPrincipal(this, username, null, roles, userPrincipal);\n\nCan you better discribe your failure szenario?", "id": 78797, "time": "2005-08-22T11:21:37Z", "bug_id": 36218, "creation_time": "2005-08-22T11:21:37Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "dirk.dekok@lostboys.nl", "text": "it seems I was looking at (and using) the 5.5.9 stable source code, not the \n5.5.10 HEAD. You are correct, this looks better.  Let me do a new CVS checkout, \nbuild  and test\n\nthis was my error message:\n\n107 55946 ERROR session.DeltaRequest  - DeltaManager only support \nGenericPrincipal. Your realm used principal class \ncom.lostboys.playground.common.security.UserPrincipal.\n\n\nand our UserPrincipal extends java.security.Principal\n\n\n\n(In reply to comment #3)\n> Hmm,\n> the JAASRealm.createPrincipal return a GenericPrincipal\n> s. L.509\n>         // Return the resulting Principal for our authenticated user\n>         return new GenericPrincipal(this, username, null, roles, \nuserPrincipal);\n> Can you better discribe your failure szenario?\n\n", "count": 4, "id": 78803, "time": "2005-08-22T11:52:06Z", "bug_id": 36218, "creation_time": "2005-08-22T11:52:06Z", "is_private": false}, {"count": 5, "text": "*** Bug 34647 has been marked as a duplicate of this bug. ***", "bug_id": 36218, "attachment_id": null, "id": 81454, "time": "2005-10-20T08:41:35Z", "creator": "pr@objektpark.de", "creation_time": "2005-10-20T08:41:35Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "creator": "pr@objektpark.de", "attachment_id": null, "is_private": false, "id": 81455, "time": "2005-10-20T08:45:14Z", "bug_id": 36218, "creation_time": "2005-10-20T08:45:14Z", "text": "Currently we don\u00b4t support serialization from custom principals!\nI hope we can suppport this in a future release.\n\nMany thanx for your help\nPeter\n"}]