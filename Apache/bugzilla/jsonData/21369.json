[{"count": 0, "tags": [], "bug_id": 21369, "attachment_id": null, "id": 40062, "time": "2003-07-07T12:50:18Z", "creator": "kevinj@develop.com", "creation_time": "2003-07-07T12:50:18Z", "is_private": false, "text": "Sorry ahead of time if this is slightly wooly. I have a web app that I deploy in\nexpanded form to Tomcat 5.0.3 and it works fine. I'm also testing this app using\nCactus, for this I create a WAR file and deploy that. I have a server.xml file\nthat looks like this\n\n<Server port=\"8885\" shutdown=\"SHUTDOWN\" debug=\"0\">\n\n    <Listener className=\"org.apache.catalina.mbeans.ServerLifecycleListener\"\n        debug=\"0\"/>\n    <Listener\nclassName=\"org.apache.catalina.mbeans.GlobalResourcesLifecycleListener\"\n        debug=\"0\"/>\n\n    <Service name=\"Catalina\">\n\n        <Connector className=\"org.apache.coyote.tomcat5.CoyoteConnector\"\n                   port=\"@test.port@\" minProcessors=\"5\" maxProcessors=\"100\"\n                   enableLookups=\"true\" redirectPort=\"8443\" acceptCount=\"100\"\n                   debug=\"0\" connectionTimeout=\"20000\"\n                   disableUploadTimeout=\"true\" />\n\n        <Engine name=\"Catalina\" defaultHost=\"localhost\" debug=\"0\">\n\n            <Realm className=\"org.apache.catalina.realm.MemoryRealm\"/>\n\n            <Host name=\"localhost\" debug=\"0\" appBase=\"webapps\" unpackWARs=\"true\">\n                <Context path=\"/blog\" docBase=\"blog.war\" debug=\"0\">\n                    <!--Logger\nclassName=\"org.apache.catalina.logger.SystemOutLogger\"\n                        timestamp=\"true\"/-->\n                    <Resource name=\"jdbc/blog\" auth=\"Container\"\ntype=\"javax.sql.DataSource\"/>\n                    <ResourceParams name=\"jdbc/blog\">\n                        <parameter>\n                            <name>username</name>\n                            <value>admin</value>\n                        </parameter>\n                        <parameter>\n                            <name>password</name>\n                            <value></value>\n                        </parameter>\n                        <parameter>\n                            <name>driverClassName</name>\n                            <value>com.mysql.jdbc.Driver</value>\n                        </parameter>\n                        <parameter>\n                            <name>url</name>\n                            <value>jdbc:mysql://localhost/TestCourseBlog</value>\n                        </parameter>\n                    </ResourceParams>\n                </Context>\n            </Host>\n\n        </Engine>\n\n    </Service>\n\n</Server>\n\nAnd when the app is run I get the following error\n\n     [java] 07-Jul-2003 13:45:06 org.apache.catalina.core.StandardContext start\n     [java] SEVERE: Error reading tld listeners\njava.lang.IllegalArgumentException: Invalid TLD resource path /WEB-INF/lib/as\npectjrt-1.0.5.jar\n     [java] java.lang.IllegalArgumentException: Invalid TLD resource path\n/WEB-INF/lib/aspectjrt-1.0.5.jar\n     [java]     at\norg.apache.catalina.startup.TldConfig.tldScanJar(TldConfig.java:442)\n     [java]     at org.apache.catalina.startup.TldConfig.execute(TldConfig.java:228)\n     [java]     at\norg.apache.catalina.core.StandardContext.start(StandardContext.java:4037)\n     [java]     at\norg.apache.catalina.core.ContainerBase.start(ContainerBase.java:1127)\n     [java]     at\norg.apache.catalina.core.StandardHost.start(StandardHost.java:795)\n     [java]     at\norg.apache.catalina.core.ContainerBase.start(ContainerBase.java:1127)\n     [java]     at\norg.apache.catalina.core.StandardEngine.start(StandardEngine.java:502)\n     [java]     at\norg.apache.catalina.core.StandardService.start(StandardService.java:519)\n     [java]     at\norg.apache.catalina.core.StandardServer.start(StandardServer.java:2312)\n     [java]     at org.apache.catalina.startup.Catalina.start(Catalina.java:577)\n     [java]     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n     [java]     at\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n     [java]     at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n     [java]     at java.lang.reflect.Method.invoke(Method.java:324)\n     [java]     at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:297)\n     [java]     at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:394)\n\nwhere aspectjrt-1.0.5.jar is the first jar in the jar file.\n\nIf I expand the app and run it it is fine so the aspectj JAR file is not the\nissue. If I run this under 5.0.2 then it works fine so it looks like 5.0.3 is\nmistaking this JAR as a TLD listener."}, {"count": 1, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "is_private": false, "id": 40067, "time": "2003-07-07T13:41:57Z", "bug_id": 21369, "creation_time": "2003-07-07T13:41:57Z", "text": "I am very sorry, but this clearly work for me. If you think your reports sound\nphony, don't worry, I have felt the same for some time ;-)\nPlease attach a ready to run test case if you'd like to reopen this.\n"}, {"count": 2, "tags": [], "bug_id": 21369, "text": "Hmmm,\n\nwell it clearly doesn't work for me :)\n\nThis is easy to reproduce. \n\nI took the jsp-examples directory and zipped it up as jsp-ex.zip, then added a\njar to the WEB-INF/lib directory (any non JSP/Servlet related JAR will do). I\nrenamed the zip calling it jsp-ex.war and copied it into webapps. I then create\na context in conf/catalina/localhost (called jsp-ex.xml which obviously doesn't\nmatter) which looks like this\n\n<Context path=\"/jsp-ex\" docBase=\"jsp-ex.war\" debug=\"0\">\n</Context>\n\n\nnotice the docbase is the war file. \n\nI change nothing else so unpackWars is true and autoDeploy is true. Start tomcat\n5.0.3 and I get the TLD exception.\n\nIf I remove the context file the war is expanded and works fine.\n\nIf I point the docbase at jsp-ex then the war isn't expanded and I get other\nerrors (I believe this is another bug but war/context management is so unusual I\n wasn't convinced)\n\nThis all works OK in 5.0.2", "id": 40070, "time": "2003-07-07T14:09:32Z", "creator": "kevinj@develop.com", "creation_time": "2003-07-07T14:09:32Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "text": "There is no value in specifying docBase=\"jsp-ex.war\" or even the docBase at all\nanymore (no matter what you do, the WAR will be expanded according to\nunpackWARs). Remove the setting.\nI believe this has been fixed post 5.0.3. See revision 1.16 and 1.17 of HostConfig.", "id": 40076, "time": "2003-07-07T14:51:10Z", "bug_id": 21369, "creation_time": "2003-07-07T14:51:10Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 21369, "attachment_id": null, "id": 40080, "time": "2003-07-07T15:09:07Z", "creator": "kevinj@develop.com", "creation_time": "2003-07-07T15:09:07Z", "is_private": false, "text": "Thanks,\n\nis there a nightly available or do I need to grab the CVS bits?"}, {"count": 5, "tags": [], "bug_id": 21369, "attachment_id": null, "text": "You should get that from CVS (sorry). I'll do a quick test anyway, just to be sure.", "id": 40096, "time": "2003-07-07T20:08:29Z", "creator": "remm@apache.org", "creation_time": "2003-07-07T20:08:29Z", "is_private": false}]