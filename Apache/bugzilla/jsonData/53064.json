[{"count": 0, "tags": [], "bug_id": 53064, "attachment_id": null, "text": "According to the mod_lua documentation, there should be a function called r:parsebody, which parses the POST data and converts it into a Lua table, but I have yet to actually find this function declared inside the mod_lua code.\n\nWith 2.4, adding this functionality should be pretty straightforward: \n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* r:parsebody() returning a lua table */\nstatic int req_parsebody(lua_State *L)\n{\n    apr_array_header_t          *fields;\n    int                         i;\n    apr_table_entry_t           *e = 0;\n    request_rec *r = ap_lua_check_request_rec(L, 1);\n    lua_newtable(L);\n    lua_newtable(L);            /* [table, table] */\n    ap_parse_form_data(r, NULL, &fields, -1, MAX_STRING_LEN); /* Maybe increase this value? */\n    e = (apr_table_entry_t *) fields->elts;\n    for(i = 0; i < fields->nelts; i++) {\n        req_aprtable2luatable_cb(L, e[i].key, e[i].val);\n    }\n    return 2;                   /* [table<string, string>, table<string, array<string>>] */\n}\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n\n(The function would also have to be declared in ap_lua_load_request_lmodule)\n\nI hope this little snippet will at least give some food for thought, and I hope that the issue can be resolved at some point in time, as we clearly need more Lua in the world.", "id": 157947, "time": "2012-04-11T16:41:00Z", "creator": "humbedooh@apache.org", "creation_time": "2012-04-11T16:41:00Z", "is_private": false}, {"count": 1, "tags": [], "creator": "covener@gmail.com", "attachment_id": null, "id": 157948, "time": "2012-04-11T16:50:12Z", "bug_id": 53064, "creation_time": "2012-04-11T16:50:12Z", "is_private": false, "text": "IMO mod_lua enhancement or doc defect -- setting to enhancement"}, {"count": 2, "tags": [], "bug_id": 53064, "attachment_id": 28968, "text": "Created attachment 28968\nPatch for adding the parsebody function\n\nThis patch adds the parsebody function to the Lua environment, so scripts can access POST data from requests.", "id": 160128, "time": "2012-06-20T11:06:30Z", "creator": "humbedooh@apache.org", "creation_time": "2012-06-20T11:06:30Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 53064, "attachment_id": null, "text": "Added the function to trunk, r1352047", "id": 160129, "time": "2012-06-20T11:28:19Z", "creator": "humbedooh@apache.org", "creation_time": "2012-06-20T11:28:19Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 53064, "attachment_id": null, "text": "Applied in r1365539 to 2.4.x.\nReleased with 2.4.3.", "id": 161582, "time": "2012-08-21T16:12:56Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2012-08-21T16:12:56Z", "is_private": false}]