[{"count": 0, "tags": [], "bug_id": 58504, "text": "Created attachment 33186\npatch against trunk\n\nWhen the following environment set, maintenance process skipped occasionally.\nThis behavior is 1.2.41 only.\n * worker.maintain=30\n * JkWatchdogInterval  30\n\nI analyze of follows.\nIn case of JK_TRUE, maintenance is performed in maintain_workers().\n\nif \"jk_shmem.hdr-> h.data.maintain_time = trigger\", JK_FALSE is returned.\nBut it should be returned JK_TRUE.\n\n---jk_shm.c\n    872 int jk_shm_check_maintain(time_t trigger)\n    :\n    881     if (jk_shmem.hdr->h.data.maintain_time < trigger) {\n    882         jk_shmem.hdr->h.data.maintain_time = time(NULL);\n    883         rv = JK_TRUE;\n    884     }\n    :\n    886     return rv;\n---\n\nI made patch against trunk.\n\n======================================\n--- jk_shm.c    (revision 1702073)\n+++ jk_shm.c    (working copy)\n@@ -878,7 +878,7 @@\n         JK_ATOMIC_DECREMENT(&(jk_shmem.hdr->h.data.maintain_checking));\n         return rv;\n     }\n-    if (jk_shmem.hdr->h.data.maintain_time < trigger) {\n+    if (jk_shmem.hdr->h.data.maintain_time <= trigger) {\n         jk_shmem.hdr->h.data.maintain_time = time(NULL);\n         rv = JK_TRUE;\n     }", "id": 185789, "time": "2015-10-19T07:40:03Z", "creator": "shimizuhiroto123@gmail.com", "creation_time": "2015-10-19T07:40:03Z", "is_private": false, "attachment_id": 33186}, {"attachment_id": null, "tags": [], "bug_id": 58504, "is_private": false, "count": 1, "id": 193758, "time": "2016-09-16T08:42:39Z", "creator": "markt@apache.org", "creation_time": "2016-09-16T08:42:39Z", "text": "Thanks for the analysis and the patch. The patch has been applied to trunk and will be included in 1.2.42 onwards."}]