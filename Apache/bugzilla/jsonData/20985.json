[{"count": 0, "tags": [], "bug_id": 20985, "attachment_id": null, "id": 39230, "time": "2003-06-21T13:32:47Z", "creator": "toraneko@kun.ne.jp", "creation_time": "2003-06-21T13:32:47Z", "is_private": false, "text": "Current SMTPAppender don't support charset. So, we can't use other than US\nISO-8859-1 Character. This patch help to set charset for SMTPAppender and\nimprove internationalization support.\n\nHere is a patch for 1.2.8. If you are intested in it,  please take it.\n\n\n\n--- src/java/org/apache/log4j/net/SMTPAppender.java.orig        2003-06-22 06:22\n:16.000000000 +0900\n+++ src/java/org/apache/log4j/net/SMTPAppender.java     2003-06-22 06:49:10.0000\n00000 +0900\n@@ -47,11 +47,12 @@\n   private String from;\n   private String subject;\n   private String smtpHost;\n+  private String charset = \"ISO-8859-1\";\n   private int bufferSize = 512;\n   private boolean locationInfo = false;\n \n   protected CyclicBuffer cb = new CyclicBuffer(bufferSize);\n-  protected Message msg;\n+  protected MimeMessage msg;\n\n   protected TriggeringEventEvaluator evaluator;\n \n@@ -98,7 +99,7 @@\n \n        msg.setRecipients(Message.RecipientType.TO, parseAddress(to));\n        if(subject != null)\n-        msg.setSubject(subject);\n+        msg.setSubject(subject, charset);\n      } catch(MessagingException e) {\n        LogLog.error(\"Could not activate SMTPAppender options.\", e );\n      }\n@@ -229,7 +230,7 @@\n       t = layout.getFooter();\n       if(t != null)\n        sbuf.append(t);\n-      part.setContent(sbuf.toString(), layout.getContentType());\n+      part.setContent(sbuf.toString(), layout.getContentType() + \";charset=\" + \ncharset);\n \n       Multipart mp = new MimeMultipart();\n       mp.addBodyPart(part);\n@@ -375,6 +376,22 @@\n   boolean getLocationInfo() {\n     return locationInfo;\n   }\n+\n+  /**\n+   * Set charset for other than ASCII character.\n+   */\n+  public\n+  void setCharset(String charset) {\n+    this.charset = charset;\n+  }\n+\n+  /**\n+   * Set charset for other than ASCII character.\n+   */\n+  public\n+  String getCharset() {\n+    return charset;\n+  }\n }\n \n class DefaultEvaluator implements TriggeringEventEvaluator {"}, {"count": 1, "attachment_id": null, "bug_id": 20985, "text": "Patch applied, thank you.", "id": 68494, "time": "2004-12-14T19:47:44Z", "creator": "yoavs@computer.org", "creation_time": "2004-12-14T19:47:44Z", "tags": [], "is_private": false}]