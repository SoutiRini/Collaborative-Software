[{"count": 0, "tags": [], "text": "I am really struggling with this issue with no clue of how to narrow down that \nwhether the issue is in my environment / my build process / or my custom \nmodule / or is it a Bug for HP UX 11i environment:- \n\nI am bit new to HP UX still tried the following :\nBuild the Apache 2.0 as follows:\n$ ./configure --enable-rule=SHARED_CORE --enable-module=so   --\nprefix=/path/to/install\nInstall Apache:\n$ make\n$ make install\nThen I am building my module with the Apache 2.0 apxs utility with the command:\n$ /path/to/install/bin/apxs -I/parent/of/path/to/openssl/include -o \nmyModuleApache.so -c *.c\nInstall my module as folows:\n$ /path/to/install/bin/apxs -i -a -n myModule myModuleApache.so\n\nNOW START\n$ httpd \nSyntax error on line 233 \nof /home1/saurabhs/vivek/apache2Install/conf/httpd.conf: \nCannot load /home1/saurabhs/vivek/apache2Install/modules/myModuleApache.so into \nserver: Unresolved external \n\nThis error doesn't indicate which symbol its not able to locate... \nHave following options tried: \n$ ldd myModuleApache.so\n        /usr/lib/libc.2 =>      /usr/lib/libc.2\n        /usr/lib/libdld.2 =>    /usr/lib/libdld.2\n        /usr/lib/libc.2 =>      /usr/lib/libc.2\nBUT THE FOLLOWING GIVES ISSUES:\n$ ldd -r myModuleApache.so \n/usr/lib/libc.2 => /usr/lib/libc.2 \n/usr/lib/libdld.2 => /usr/lib/libdld.2 \n/usr/lib/libc.2 => /usr/lib/libc.2 \nsymbol not found: apr_bucket_type_eos (myModuleApache.so) \nsymbol not found: ap_hook_child_init (myModuleApache.so) \nsymbol not found: ap_hook_handler (myModuleApache.so) \nsymbol not found: ap_hook_translate_name (myModuleApache.so) \nsymbol not found: ap_hook_fixups (myModuleApache.so) \nsymbol not found: apr_pool_cleanup_register (myModuleApache.so) \nsymbol not found: apr_palloc (myModuleApache.so) \nsymbol not found: ap_log_error (myModuleApache.so) \nsymbol not found: ap_get_server_name (myModuleApache.so) \nsymbol not found: apr_table_get (myModuleApache.so) \nsymbol not found: ap_get_remote_host (myModuleApache.so) \nsymbol not found: ap_get_server_port (myModuleApache.so) \nsymbol not found: ap_run_http_method (myModuleApache.so) \nsymbol not found: apr_table_elts (myModuleApache.so) \nsymbol not found: apr_brigade_create (myModuleApache.so) \nsymbol not found: ap_get_brigade (myModuleApache.so) \nsymbol not found: apr_brigade_destroy (myModuleApache.so) \nsymbol not found: apr_brigade_flatten (myModuleApache.so) \nsymbol not found: ap_rwrite (myModuleApache.so) \nsymbol not found: ap_rflush (myModuleApache.so) \nsymbol not found: apr_pstrdup (myModuleApache.so) \nsymbol not found: apr_pstrcat (myModuleApache.so) \nsymbol not found: apr_table_add (myModuleApache.so) \nsymbol not found: apr_table_set (myModuleApache.so) \nsymbol not found: ap_os_escape_path (myModuleApache.so) \nsymbol not found: ap_construct_url (myModuleApache.so) \nsymbol not found: apr_table_setn (myModuleApache.so) \n\nAnd \n$ chatr myModuleApache.so \nmyModuleApache.so: \nshared library \nshared library dynamic path search: \nSHLIB_PATH enabled second \nembedded path enabled first /home1/saurabhs/vivek/apache2Install/modules \ninternal name: \nmyModuleApache.sl \nshared library list: \ndynamic /usr/lib/libc.2 \nshared vtable support disabled \nstatic branch prediction disabled \nexecutable from stack: D (default) \nkernel assisted branch prediction enabled \nlazy swap allocation disabled \ntext segment locking disabled \ndata segment locking disabled \nthird quadrant private data space disabled \nfourth quadrant private data space disabled \ndata page size: D (default) \ninstruction page size: D (default) \n\nTried running pxdb debugger but no success, tried with lot of CFLAGS  / \nSHLIB_PATH settings but with no success.\n\nAny indication of how to debug this problem or what is actually the issue would \nbe of great help. Thanks...\n\nMoreover any pointers on how to build this stuff without DSO on APACHE2.0 as \nthere is no entry as was in Apache 1.3 (AddModule \nmodules/myModule/myModuleApache.o in Configuration) then $ ./configure --\nprefix=/usr/local/apache $ make $ make install does rest. But corresponding \nflags settings in Apache 2.0 for this is not clear to me from the documentation.", "attachment_id": null, "id": 74498, "creator": "vivekg@noida.hcltech.com", "time": "2005-05-05T19:50:44Z", "bug_id": 34767, "creation_time": "2005-05-05T19:50:44Z", "is_private": false}, {"count": 1, "tags": [], "text": "tweak srclib/apr/dso/unix/dso.c to pass BIND_VERBOSE flag to shl_load() and see\nif that helps debug the problem\n\nchange\n   shl_t os_handle = shl_load(path, BIND_IMMEDIATE, 0L)\nto \n      shl_t os_handle = shl_load(path, BIND_IMMEDIATE|BIND_VERBOSE, 0L)\n\nthen make && make install and try to start again\n", "is_private": false, "id": 74506, "creator": "trawick@apache.org", "time": "2005-05-06T02:03:54Z", "bug_id": 34767, "creation_time": "2005-05-06T02:03:54Z", "attachment_id": null}, {"id": 74527, "tags": [], "bug_id": 34767, "is_private": false, "count": 2, "text": "First of all I don't have words to thank for this as now atleast I am able to \nsee a better error indication rather than just a blunt message.\nAs suggested I tried with the changes, and now it indicates that some symbol \nnot found and I am using it. But what can I do to resolve this issue as I \nsuspect this to be a environment/build issue and not a issue of the code. And \nthe same module works fine with apache 2.0 on Linux 3.0 and Solaris 9. Please \nsuggest what could be the cause of the same or how can I go about resolving \nthis issue.\n\n$ ../bin/apachectl start\n/usr/lib/dld.sl: Unresolved symbol: htons (code)  \nfrom /home1/saurabhs/Apache/latest/modules/myModuleApache.so\nSyntax error on line 232 of /home1/saurabhs/Apache/latest/conf/httpd.conf:\nCannot load /home1/saurabhs/Apache/latest/modules/myModuleApache.so into \nserver: Unresolved external\n\n$ ldd -r myModuleApache.so\n        /usr/local/lib/libgcc_s.sl =>   /usr/local/lib/libgcc_s.sl\n        /usr/lib/libc.2 =>      /usr/lib/libc.2\n        /usr/lib/libdld.2 =>    /usr/lib/libdld.2\n        /usr/lib/libc.2 =>      /usr/lib/libc.2\n        /usr/lib/libc.2 =>      /usr/lib/libc.2\n        symbol not found: _end  (/usr/lib/libc.2)\n        symbol not found: _SYSTEM_ID    (/usr/lib/libc.2)\n        symbol not found: htons (myModuleApache.so)\n        symbol not found: __dld_loc     (/usr/lib/libdld.2)\n        symbol not found: ap_log_error  (myModuleApache.so)\n        symbol not found: apr_palloc    (myModuleApache.so)\n        symbol not found: apr_table_get (myModuleApache.so)\n        symbol not found: apr_pstrcat   (myModuleApache.so)\n        symbol not found: apr_table_set (myModuleApache.so)\n        symbol not found: apr_brigade_destroy   (myModuleApache.so)\n        symbol not found: apr_table_elts        (myModuleApache.so)\n        symbol not found: ap_hook_child_init    (myModuleApache.so)\n        symbol not found: ap_get_server_port    (myModuleApache.so)\n        symbol not found: ap_get_remote_host    (myModuleApache.so)\n        symbol not found: ap_get_server_name    (myModuleApache.so)\n        symbol not found: apr_pool_cleanup_register     (myModuleApache.so)\n        symbol not found: ap_hook_fixups        (myModuleApache.so)\n        symbol not found: ap_hook_translate_name        (myModuleApache.so)\n        symbol not found: ap_hook_handler       (myModuleApache.so)\n        symbol not found: ap_run_http_method    (myModuleApache.so)\n        symbol not found: apr_brigade_create    (myModuleApache.so)\n        symbol not found: ap_construct_url      (myModuleApache.so)\n        symbol not found: apr_table_setn        (myModuleApache.so)\n        symbol not found: ap_os_escape_path     (myModuleApache.so)\n        symbol not found: apr_table_add (myModuleApache.so)\n        symbol not found: apr_pstrdup   (myModuleApache.so)\n        symbol not found: ap_rflush     (myModuleApache.so)\n        symbol not found: ap_rwrite     (myModuleApache.so)\n        symbol not found: apr_brigade_flatten   (myModuleApache.so)\n        symbol not found: ap_get_brigade        (myModuleApache.so)\n        symbol not found: pthread_mutex_unlock  (/usr/local/lib/libgcc_s.sl)\n        symbol not found: pthread_mutex_lock    (/usr/local/lib/libgcc_s.sl)\n        symbol not found: pthread_setspecific   (/usr/local/lib/libgcc_s.sl)\n        symbol not found: pthread_getspecific   (/usr/local/lib/libgcc_s.sl)\n        symbol not found: pthread_key_create    (/usr/local/lib/libgcc_s.sl)\n        symbol not found: pthread_once  (/usr/local/lib/libgcc_s.sl)\n        symbol not found: _SYSTEM_ID    (/usr/lib/libc.2)\n        symbol not found: _SYSTEM_ID    (/usr/lib/libc.2)\n", "time": "2005-05-06T14:23:51Z", "creator": "vivekg@noida.hcltech.com", "creation_time": "2005-05-06T14:23:51Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 34767, "is_private": false, "text": "htons() is an easy one.  htons and friends are macros on many systems, and you\ncan get link or load errors like this if you don't include the proper system\nheader file.\n\nIf you do this in your module:\n\n#define APR_WANT_BYTEFUNC\n#include \"apr_want.h\"\n\nThen APR should \"know\" what header file to include on your system to obtain the\ndefinition.  This would need to be done in all source files that reference htons().\n\n(This is likely <netdb.h>, but either use the APR mechanism or grep\n/usr/include/* yourself ;) )", "id": 74535, "time": "2005-05-06T17:00:41Z", "creator": "trawick@apache.org", "creation_time": "2005-05-06T17:00:41Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "vivekg@noida.hcltech.com", "attachment_id": null, "id": 74562, "time": "2005-05-07T15:52:12Z", "bug_id": 34767, "creation_time": "2005-05-07T15:52:12Z", "is_private": false, "text": "A triumphal success, an ecstatic delight, three cheers to Jeff for this...\nFollowing the APR include mechanism, the issue dissapeared and the server was \nfinally started as if there were no issues ever on it ;-). Thanks!!!\n\nAny inputs on this part:-\nMoreover any pointers on how to build this stuff without DSO on APACHE2.0 as \nthere is nothing like AddModule \nmodules/myModule/myModuleApache.o in Configuration in Apache 1.3. Earlier just \nafter this we used to $ ./configure --prefix=/usr/local/apache then $ make then \n$ make install does rest. But corresponding flags settings in Apache 2.0 for \nthis are not very clear to me from the documentation."}, {"count": 5, "attachment_id": null, "bug_id": 34767, "text": "End user module problems -> Not a bug in HTTPD itself.", "id": 75941, "time": "2005-06-03T04:39:16Z", "creator": "chip@force-elite.com", "creation_time": "2005-06-03T04:39:16Z", "tags": [], "is_private": false}]