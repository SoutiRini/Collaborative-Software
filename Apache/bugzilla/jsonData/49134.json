[{"count": 0, "tags": [], "bug_id": 49134, "attachment_id": 25306, "is_private": false, "id": 136194, "time": "2010-04-16T05:32:43Z", "creator": "mguillemot@yahoo.fr", "creation_time": "2010-04-16T05:32:43Z", "text": "Created attachment 25306\nUnit test illustrating the problem\n\nServer.stop() should unregister all MBeans registered by Tomcat but it is not the case.\n\nIt has side effects when starting a new Server as some Tomcat components like MapperListener components rely on what they find in the MBeanServer and try to work with objects that don't exist anymore (like Host for MapperListener)\n\nProvided unit test shows a part of the problem (in fact the helper class Tomcat should be improved to register all MBeans just like a \"normal\" Tomcat distribution).\n\nA workaround consists in cleaning up the JMX tree from all Catalina objects once server.stop() has been called.\n\nFor info: it seems that such a problem has already been reported: bug #47046"}, {"count": 1, "tags": [], "bug_id": 49134, "is_private": false, "id": 136195, "attachment_id": null, "creator": "mguillemot@yahoo.fr", "creation_time": "2010-04-16T05:33:11Z", "time": "2010-04-16T05:33:11Z", "text": "For info: same problem exists with Tomcat 6"}, {"count": 2, "tags": [], "bug_id": 49134, "text": "The unit test highlights issues when the default domain name of Catalina is not used.\n\nThis should get addresses in the wider clean up that is planned for MBean registration as part of the next stage of Lifecycle refactoring.", "id": 136384, "attachment_id": null, "creator": "markt@apache.org", "creation_time": "2010-04-24T15:29:49Z", "time": "2010-04-24T15:29:49Z", "is_private": false}, {"count": 3, "tags": [], "text": "I'm about half way through the MBean/Lifecycle re-factoring and this issue is now fixed. I tweaked the provided unit test a little to:\n- ensure there are no Cataina mbeans\n- a sufficient number of Tomcat MBeans (20) get created\n- that all the Tomcat MBeans get cleaned up on tomcat.destroy()\n\nClean-up is not expected on a stop() as components may get re-started.", "is_private": false, "id": 136614, "creator": "markt@apache.org", "time": "2010-05-03T18:22:43Z", "bug_id": 49134, "creation_time": "2010-05-03T18:22:43Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 49134, "attachment_id": null, "is_private": false, "id": 170428, "time": "2013-10-05T16:35:47Z", "creator": "gael.lalire@laposte.net", "creation_time": "2013-10-05T16:35:47Z", "text": "With tomcat 7.0.42 Catalina.stop() doesn't unregister all MBeans registered by Catalina.start() for example :\n- Catalina:type=Realm,realmPath=/realm0/realm0\n- Catalina:type=RequestProcessor*\n\nAs there is no Catalina.destroy() what should I do ?"}, {"count": 5, "tags": [], "bug_id": 49134, "is_private": false, "id": 170442, "attachment_id": null, "creator": "markt@apache.org", "creation_time": "2013-10-05T22:57:30Z", "time": "2013-10-05T22:57:30Z", "text": "I've fixed the realm MBean issues in 7.0.x and 8.0.x (the CombinedRealm wasn't destroying nested Realms). I'll look at the RequestProcessor MBeans next."}, {"count": 6, "tags": [], "text": "I can't reproduce the RequestProcessor issue. Please provide the simplest possible test case to reproduce - ideally as a patch to the existing unit test. See http://svn.apache.org/r1529546 and http://svn.apache.org/r1529549 for some examples of extending that test case.", "is_private": false, "id": 170443, "creator": "markt@apache.org", "time": "2013-10-05T23:19:53Z", "bug_id": 49134, "creation_time": "2013-10-05T23:19:53Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 49134, "text": "A month has gone by with no further information provided. The issue I could repeat has been fixed in trunk and 7.0.x so I am resolving this as fixed.", "id": 171075, "attachment_id": null, "creator": "markt@apache.org", "creation_time": "2013-11-05T23:51:05Z", "time": "2013-11-05T23:51:05Z", "is_private": false}]