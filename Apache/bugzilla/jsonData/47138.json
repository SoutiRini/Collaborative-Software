[{"count": 0, "tags": [], "bug_id": 47138, "text": "Created attachment 23591\npatch for ~2.2.11\n\nImproperly shared resources?\n\n While shutting down a debug version of apache on a windows server 2003 with debug MSDev libraries,  the underlying os libraries were complaining about the double free of a block of memory.   \n \n  It appears that when ap_proxy_add_worker_to_balancer(apr_pool_t *pool, proxy_balancer *balancer, proxy_worker *worker) is called it uses memcpy to duplicate the proxy worker but doesn't do anything to change the cleanup routines or to make it's own copy of allocated resources like the pool and possibly the semaphore.  This results in two proxy workers structures each pointing to the same pool and semaphore.  \n \n  During cleanup the original worker and the balancer worker each free their pool (which is the same pool), resulting in the pool being placed in the pool free list twice, now when the memory is freed there will be a double free of the memory representing the pool.\n \nMy patch for the issue is attached.", "id": 126704, "attachment_id": 23591, "creator": "dbuss@novell.com", "creation_time": "2009-05-01T15:27:16Z", "time": "2009-05-01T15:27:16Z", "is_private": false}]