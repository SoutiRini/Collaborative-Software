[{"count": 0, "tags": [], "bug_id": 61728, "attachment_id": 35497, "text": "Created attachment 35497\nI use this file to add cells with comments\n\nI am using Apache POI 3.17 to create cell comments.\n\nI have a need to add cell comments to XSSF sheets.\n\nI have tried the code, suggested in POI FAQ. But my cell comments have  transparent background.\n\nThe code is reproduced below.\n\nprotected void setCellComment(Cell cell, String message) {\n    Drawing drawing = cell.getSheet().createDrawingPatriarch();\n    CreationHelper factory = cell.getSheet().getWorkbook()\n            .getCreationHelper();\n    // When the comment box is visible, have it show in a 1x3 space\n    ClientAnchor anchor = factory.createClientAnchor();\n    anchor.setCol1(cell.getColumnIndex());\n    anchor.setCol2(cell.getColumnIndex() + 1);\n    anchor.setRow1(cell.getRowIndex());\n    anchor.setRow2(cell.getRowIndex() + 1);\n    anchor.setDx1(100);\n    anchor.setDx2(100);\n    anchor.setDy1(100);\n    anchor.setDy2(100);\n\n    // Create the comment and set the text+author\n    Comment comment = drawing.createCellComment(anchor);\n    RichTextString str = factory.createRichTextString(message);\n    comment.setString(str);\n    comment.setAuthor(\"Apache POI\");\n    // Assign the comment to the cell\n    cell.setCellComment(comment);\n}\nHow can I change the background to a yellow background?\n\nNOTE: If one edits the apache-poi created comment in Excel, then it will appear with a yellow background temporarily. However if one tries to format this comment to change the background from within Excel, then one can't. (The Color and Lines menu does not appear)", "id": 201945, "time": "2017-11-06T13:18:24Z", "creator": "c0ff75@gmail.com", "creation_time": "2017-11-06T13:18:24Z", "is_private": false}, {"count": 1, "tags": [], "creator": "onealj@apache.org", "attachment_id": null, "id": 201948, "time": "2017-11-06T16:33:17Z", "bug_id": 61728, "creation_time": "2017-11-06T16:33:17Z", "is_private": false, "text": "What version of Excel are you using?"}, {"text": "Created attachment 35498\nExample of generated file with transparent comments", "tags": [], "bug_id": 61728, "attachment_id": 35498, "count": 2, "id": 201949, "time": "2017-11-06T16:36:51Z", "creator": "c0ff75@gmail.com", "creation_time": "2017-11-06T16:36:51Z", "is_private": false}, {"count": 3, "attachment_id": null, "bug_id": 61728, "text": "(In reply to Javen O'Neal from comment #1)\n> What version of Excel are you using?\n\nExcel 2013. I attached generated file with example of transparent comments.", "id": 201950, "time": "2017-11-06T16:56:03Z", "creator": "c0ff75@gmail.com", "creation_time": "2017-11-06T16:56:03Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 61728, "is_private": false, "text": "I added the first comment using Excel and the other one was already in comment-example.xlsm. The first comment appears as black text on a yellow background while the other one appears as black text on a transparent background.\n\n   <comment ref=\"B178\" authorId=\"1\">\n        <text>\n            <r>\n                <rPr>\n                    <b/>\n                    <sz val=\"10\"/>\n                    <color indexed=\"81\"/>\n                    <rFont val=\"Calibri\"/>\n                </rPr>\n                <t>xxx123xxx</t>\n            </r>\n            <r>\n                <rPr>\n                    <sz val=\"10\"/>\n                    <color indexed=\"81\"/>\n                    <rFont val=\"Calibri\"/>\n                </rPr>\n                <t xml:space=\"preserve\">\n                </t>\n            </r>\n        </text>\n    </comment>\n    <comment ref=\"B191\" authorId=\"0\">\n        <text>\n            <r>\n                <rPr>\n                    <sz val=\"11\"/>\n                    <color theme=\"1\"/>\n                    <rFont val=\"Calibri\"/>\n                    <family val=\"2\"/>\n                    <charset val=\"204\"/>\n                    <scheme val=\"minor\"/>\n                </rPr>\n                <t>\u0421\u0442\u0440\u0430\u043d\u0430 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u044f, \u0433\u0434\u0435 \u0442\u043e\u0432\u0430\u0440 \u0431\u044b\u043b \u0438\u0437\u0433\u043e\u0442\u043e\u0432\u043b\u0435\u043d \u0438\u043b\u0438 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u043d. \u041f\u0440\u0438\u043c\u0435\u0440 \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f: \u0421\u0434\u0435\u043b\u0430\u043d\u043e \u0432 \u0413\u0435\u0440\u043c\u0430\u043d\u0438\u0438. \u0414\u0430\u043d\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u0443\u043f\u0430\u043a\u043e\u0432\u043a\u0435 \u0442\u043e\u0432\u0430\u0440\u0430.</t>\n            </r>\n        </text>\n    </comment>", "id": 201951, "time": "2017-11-06T18:01:34Z", "creator": "fanningpj@yahoo.com", "creation_time": "2017-11-06T18:01:34Z", "attachment_id": null}]