[{"count": 0, "tags": [], "bug_id": 59228, "attachment_id": null, "text": "The <ant>/<antcall> does not preserve the exit status specified in a <fail> task when the application exits. Below is a simple test case that illustrates the problem:\n\n<project name=\"build\" default=\"t1\">\n\t<target name=\"t1\">\n\t\t<antcall target=\"t2\" />\n\t</target>\n\t<target name=\"t2\">\n\t\t<fail message=\"Failing with a 2\" status=\"2\" />\n\t</target>\n</project>\n\nThe expectation is that when Ant exits, the error code (%ERRORLEVEL% on Windows, $? on UNIX) should be 2. However the observed result is that the error code is set to 1 instead.\n\nAt the code level, this is because ProjectHelper.addLocationToBuildException(BuildException, Location) always throws a new BuildException regardless of whether the original exception is an ExitStatusException. The proposed solution is to check whether the original exception is an ExitStatusException, and if so, throw a new ExitStatusException with the status code from the original ExceptionStatusException.\n\nRefer to my pull request on Github for a proposed implementation. If the original patch submission method is preferred, let me know and I can do that too.", "id": 189692, "time": "2016-03-24T03:09:03Z", "creator": "acwwat@gmail.com", "creation_time": "2016-03-24T03:09:03Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 59228, "is_private": false, "text": "Thanks a lot Anthony, I've applied your PR.", "id": 189725, "time": "2016-03-25T17:08:04Z", "creator": "bodewig@apache.org", "creation_time": "2016-03-25T17:08:04Z", "attachment_id": null}]