[{"count": 0, "tags": [], "creator": "mxlehma@qwest.com", "attachment_id": null, "is_private": false, "id": 33386, "time": "2003-03-18T23:35:40Z", "bug_id": 18128, "creation_time": "2003-03-18T23:35:40Z", "text": "I am trying to use the srcfileset within a dependset where the includes contain \nabsolute paths to the actual files.  This doesn't work with srcfileset.  Here \nis an excerpt from the build.xml file:\n\n        <dependset>\n            <srcfileset dir=\"/\" includes=\"D:/config/env/build.properties\" />\n            <targetfileset dir=\"${build.ejb}\" includes=\"${messageTempFile}\" />\n        </dependset>\n\nThe build never recognizes changes to the build.properties file so it never \nrebuilds the target.  The following will work:\n\n        <dependset>\n            <srcfileset dir=\"/\" includes=\"config/env/build.properties\" />\n            <targetfileset dir=\"${build.ejb}\" includes=\"${messageTempFile}\" />\n        </dependset>\n\nAs well as using srcfilelist instead.  Here the absolute path works:\n\n        <dependset>\n            <srcfilelist dir=\"/\" files=\"D:/config/env/build.properties\" />\n            <targetfileset dir=\"${build.ejb}\" includes=\"${messageTempFile}\" />\n        </dependset>\n\nThis causes a problem for me because I was really trying to reuse a patternset, \nas follows:\n            <srcfileset dir=\"/\">\n                <patternset refid=\"tokenFilterFiles\" />\n            </srcfileset>\n\nwhere the patternset contained absolute paths.\n\nI tested it out on 1.5.2 as well as the latest 1.6alpha from 3-18-2003, and the \nproblem exists in both."}, {"count": 1, "attachment_id": null, "bug_id": 18128, "text": "It looks like the same behavior can be found in fileset.", "id": 33388, "time": "2003-03-18T23:46:31Z", "creator": "mxlehma@qwest.com", "creation_time": "2003-03-18T23:46:31Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "text": "Does it work if you use dir=\"D:/\" instead?", "attachment_id": null, "id": 33399, "creator": "bodewig@apache.org", "time": "2003-03-19T07:18:22Z", "bug_id": 18128, "creation_time": "2003-03-19T07:18:22Z", "is_private": false}, {"count": 3, "tags": [], "creator": "mxlehma@qwest.com", "attachment_id": null, "is_private": false, "id": 33449, "time": "2003-03-19T14:17:18Z", "bug_id": 18128, "creation_time": "2003-03-19T14:17:18Z", "text": "dir=\"D:/\" does not work either, but that wouldn't help me because I need to be \nable to use the build.xml file on a unix box also."}, {"count": 4, "tags": [], "text": "OK, next try - and even a Unix friendly one.  Although I wonder how\nincludes=\"D:/config/env/build.properties\" is going to work on Unix 8-)\n\ndir=\"/\" includes=\"/config/env/build.properties\"?\n\ni.e. leave off the drive letter from you patternset's patterns.", "attachment_id": null, "bug_id": 18128, "id": 33450, "time": "2003-03-19T14:27:52Z", "creator": "bodewig@apache.org", "creation_time": "2003-03-19T14:27:52Z", "is_private": false}, {"count": 5, "tags": [], "creator": "mxlehma@qwest.com", "attachment_id": null, "is_private": false, "id": 33469, "time": "2003-03-19T17:00:43Z", "bug_id": 18128, "creation_time": "2003-03-19T17:00:43Z", "text": "I had already tried this, but I tried it again just to be sure, and no that \ndoesn't work either.\n\nThe filename is actually created as an enviroment variable which is passed into \na property using the location parameter, which creates an absolute path to the \nfile location, if the env variable is relative.\n\n        <property name=\"buildPropsFile\" \nlocation=\"${localEnv.BUILD_PROPS_FILE}\" />\n\nThen I was trying to use it as follows:\n        <dependset>\n            <srcfileset dir=\"/\" includes=\"${buildPropsFile}\" />\n            <targetfileset dir=\"${build.ejb}\" includes=\"${messageTempFile}\" />\n        </dependset>\n\nSo the filename is really system independent.  I reported the problem without \nthe property setting because it is easier to test that way.\n\n                <include name=\"${buildPropsFile}\" />\n"}, {"count": 6, "tags": [], "creator": "peter.reilly@corvil.com", "is_private": false, "text": "You may like try outofdate in ant-contrib cvs HEAD:\n\n<outofdate>\n   <sourcefiles path=\"${buildPropsFile}\"/>\n   <targetfiles path=\"${build.ejb}/${messageTempFile}\"/>\n   <sequential>\n       <delete file=\"${build.ejb}/${messageTempFile}\"/>\n   </sequential>\n</outofdate>\n\nI haven't tested this on Win, but it should work.\n", "id": 33472, "time": "2003-03-19T17:17:33Z", "bug_id": 18128, "creation_time": "2003-03-19T17:17:33Z", "attachment_id": null}, {"count": 7, "tags": [], "text": "Yikes!\nthat should be:\n\n<outofdate>\n   <sourcefiles path=\"${buildPropsFile}\"/>\n   <targetfiles path=\"${build.ejb}/${messageTempFile}\"/>\n   <sequential>\n       <delete quite=\"yes\" file=\"${build.ejb}/${messageTempFile}\"/>\n   </sequential>\n</outofdate>", "attachment_id": null, "id": 33473, "creation_time": "2003-03-19T17:20:50Z", "time": "2003-03-19T17:20:50Z", "creator": "peter.reilly@corvil.com", "bug_id": 18128, "is_private": false}, {"count": 8, "tags": [], "text": "I have just tried an experiment on my dos box:\n<project name=\"fileset\" default=\"t\">\n    <target name=\"t\">\n        <mkdir dir=\"e:\\test\"/>\n        <touch file=\"e:\\test\\a.b\"/>\n        <fileset id=\"f1\" dir=\"e:/\" includes=\"test\\a.b\"/>\n        <pathconvert targetos=\"windows\" property=\"p1\" refid=\"f1\"/>\n        <echo message=\"p1 is ${p1}\"/>\n        <fileset id=\"f2\" dir=\"e:\\\" includes=\"\\test\\a.b\"/>\n        <pathconvert targetos=\"windows\" property=\"p2\" refid=\"f2\"/>\n        <echo message=\"p2 is ${p2}\"/>\n        <fileset id=\"f3\" dir=\"e:\" includes=\"\\test\\a.b\"/>\n        <pathconvert targetos=\"windows\" property=\"p3\" refid=\"f3\"/>\n        <echo message=\"p3 is ${p3}\"/>\n        <fileset id=\"f4\" dir=\"e:\" includes=\"test\\a.b\"/>\n        <pathconvert targetos=\"windows\" property=\"p4\" refid=\"f4\"/>\n        <echo message=\"p4 is ${p4}\"/>\n    </target>\n</project>\nThis gives the following result:\n\nBuildfile: c:\\cygwin\\home\\peter\\learning\\fileset\\build.xml\n\nt:\np1 is E:\\test\\a.b\np2 is \np3 is \np4 is E:\\test\\a.b\n\nThe manual page on fileset contains the following:\n\n\"FileSets are groups of files. These files can be found in a directory tree\nstarting in a base directory\"\n\nAs windows has muliple roots and one can only specify one root to a fileset,\nI can conclude that is it impossible to use fileset in the manner you are\ntrying to use it. Fileset in this case is working as defined and this report\nis not a bug - but maybe is an enhancement request.\n", "attachment_id": null, "id": 33498, "creator": "peter.reilly@corvil.com", "time": "2003-03-19T22:44:47Z", "bug_id": 18128, "creation_time": "2003-03-19T22:44:47Z", "is_private": false}, {"count": 9, "tags": [], "creator": "mxlehma@qwest.com", "attachment_id": null, "is_private": false, "id": 33512, "time": "2003-03-20T03:05:46Z", "bug_id": 18128, "creation_time": "2003-03-20T03:05:46Z", "text": "Then why does the following work for srcfilelist:\n\n        <dependset>\n            <srcfilelist dir=\"/\" files=\"D:/config/env/build.properties\" />\n            <targetfileset dir=\"${build.ejb}\" includes=\"${messageTempFile}\" />\n        </dependset>\n\nI would think that the handling for the directory would be done the same way.  \nThe advantage of using srcfileset over srcfilelist is that if the file doesn't \nexist, then it is not used.  I have been able to do what I need with the \nsrcfilelist, but I am forced to create several additional targets to \nconditionally generate a filelist with only those files that exist.\n\nThe danger of srcfilelist and srcfileset handling the absolute filenames \ndifferently, is that without running ant in verbose mode and specifically \ntesting a change to the src file, you would never know that the dependency was \nnot there.\n"}, {"count": 10, "tags": [], "text": "OK, we know that filesets as they are right now have problems with absolute paths\nand especially with multi-route systems.  There have been several proposals to\nfix - making dir optional and assume all includes are absolute paths if it is\nnot present, for example - but none has been implemented yet.\n\nI'm surprised that I'm unable to find a report that would qualify as duplicate of\nthis one.\n\nI'm not quite sure why leaving the drive letter of isn't working on Windows, but\nthen again I'm not sure when drive letters get added and/or removed by\ngetAbsolutePath and similar operations.\n\nMichael, you have a workaround for now and it is pretty unlikely that we are\ngoing to get this fixed before Ant 1.6.  I'm changing the title and the severity,\nhope this is OK for you.", "attachment_id": null, "id": 33525, "creator": "bodewig@apache.org", "time": "2003-03-20T08:49:17Z", "bug_id": 18128, "creation_time": "2003-03-20T08:49:17Z", "is_private": false}, {"count": 11, "tags": [], "creator": "mxlehma@qwest.com", "attachment_id": null, "is_private": false, "id": 37441, "time": "2003-05-19T16:48:14Z", "bug_id": 18128, "creation_time": "2003-05-19T16:48:14Z", "text": "The new 1.5.3 version breaks my workaround.  I can no longer use srcfilelist as \nfollows:\n\n        <dependset>\n            <srcfilelist dir=\"/\" files=\"D:/config/env/build.properties\" />\n            <targetfileset dir=\"${build.ejb}\" includes=\"${messageTempFile}\" />\n        </dependset>\n\nSo my compiles build everything all the time because ant thinks the file \ndoesn't exist.\n\nI like the proposed option of making dir optional.  Another possibility is to \ntreat files as an absolute path if dir=\"\".  Or, implement both options.  If \nthis does get implemented, just make sure it is implemented for fileset, \nfilelist, srcfileset, srcfilelist, and any other set or list operations that \nwork the same way.\n"}, {"count": 12, "tags": [], "bug_id": 18128, "text": "Created attachment 7531\nproposed patch", "id": 41579, "time": "2003-07-27T00:34:55Z", "creator": "sign_up@brondsema.net", "creation_time": "2003-07-27T00:34:55Z", "is_private": false, "attachment_id": 7531}, {"count": 13, "tags": [], "bug_id": 18128, "attachment_id": null, "id": 41580, "time": "2003-07-27T00:37:00Z", "creator": "sign_up@brondsema.net", "creation_time": "2003-07-27T00:37:00Z", "is_private": false, "text": "I just attached a patch.  Since it modifies DirectoryScanner, this could have an \nimpact on other tasks too (hopefully only for the better).  It tested \nsuccessfully against my own test-case and also on a bootstrap and build of ant \nitself."}, {"count": 14, "tags": [], "bug_id": 18128, "text": "Created attachment 7532\nupdated patch", "id": 41581, "time": "2003-07-27T00:41:30Z", "creator": "sign_up@brondsema.net", "creation_time": "2003-07-27T00:41:30Z", "is_private": false, "attachment_id": 7532}, {"count": 15, "tags": [], "bug_id": 18128, "attachment_id": null, "id": 45503, "time": "2003-10-13T13:32:16Z", "creator": "bodewig@apache.org", "creation_time": "2003-10-13T13:32:16Z", "is_private": false, "text": "*** Bug 23758 has been marked as a duplicate of this bug. ***"}, {"count": 16, "tags": [], "bug_id": 18128, "attachment_id": null, "id": 72561, "time": "2005-03-17T09:23:06Z", "creator": "bodewig@apache.org", "creation_time": "2005-03-17T09:23:06Z", "is_private": false, "text": "giving this back to the public, will hopefully be fixed via FileCollections planned\nfor Ant 1.7."}, {"count": 17, "tags": [], "bug_id": 18128, "attachment_id": null, "id": 73834, "time": "2005-04-19T20:58:16Z", "creator": "jglick@apache.org", "creation_time": "2005-04-19T20:58:16Z", "is_private": false, "text": "*** Bug 34500 has been marked as a duplicate of this bug. ***"}, {"count": 18, "tags": [], "bug_id": 18128, "text": "to follow up:  FileCollections have been expanded into ResourceCollections.  The\n<files> resource collection allows sets of absolute filenames.  This bug is\nspecific to the dependset task and I will rename accordingly.", "id": 75426, "time": "2005-05-26T18:37:09Z", "creator": "mbenson@apache.org", "creation_time": "2005-05-26T18:37:09Z", "is_private": false, "attachment_id": null}, {"count": 19, "tags": [], "creator": "mbenson@apache.org", "is_private": false, "text": "*** Bug 20635 has been marked as a duplicate of this bug. ***", "id": 75660, "time": "2005-05-31T17:35:47Z", "bug_id": 18128, "creation_time": "2005-05-31T17:35:47Z", "attachment_id": null}, {"count": 20, "tags": [], "text": "fixed in 1.7 (HEAD)", "attachment_id": null, "id": 87778, "creation_time": "2006-04-11T19:55:05Z", "time": "2006-04-11T19:55:05Z", "creator": "mbenson@apache.org", "bug_id": 18128, "is_private": false}]