[{"count": 0, "tags": [], "bug_id": 27451, "text": "JspC, unlike the Jasper2 runtime, won't detect changes to a compile-time include\nand recompile the parent jsp.\n\nIn my testing environment I keep the generated *_jsp.java files around so I\ndon't have to recompile every jsp every time.\n\nIn nearly all JSP files in my webapp I have the following compile time\ninclude:\n\n<%@ include file=\"main.jsp\"%>\n\nThe file main.jsp includes class methods and creates objects that are common to\nnearly all of my JSP pages.\n\nI am using ant 1.5.3 with the following task segment in my build file:\n\n<jspc destdir=\"${jspc.src.jsp.dir}\" \n      webinc=\"${jspc.base.dir}/fragment.xml\" \n      package=\"jsp\" \n      compiler=\"jasper41\">\n  <classpath>\n    <fileset dir=\"${publish.common.lib.dir}\">\n      <include name=\"ant.jar\"/>\n      <include name=\"jasper-compiler.jar\"/>\n      <include name=\"jasper-runtime.jar\"/>\n      <include name=\"servlet.jar\"/>\n    </fileset>\n    <pathelement path=\"${build.dir}\"/>\n  </classpath>\n  <webapp basedir=\"${deploy.dir}\"/>\n</jspc>\n\n\nI even tried calling JSPC directly using the task fragment described in\nthe Tomcat 4.1 documentation\n(http://jakarta.apache.org/tomcat/tomcat-4.1-doc/jasper-howto.html):\n\n  <taskdef classname=\"org.apache.jasper.JspC\" name=\"jasper2\" > \n    <classpath id=\"jspc.classpath\"> \n      <pathelement location=\"${java.home}/../lib/tools.jar\"/> \n      <fileset dir=\"${tomcat.server.lib.dir}\"> \n        <include name=\"*.jar\"/> \n      </fileset> \n      <fileset dir=\"${publish.common.lib.dir}\"> \n        <include name=\"*.jar\"/> \n      </fileset> \n    </classpath> \n  </taskdef> \n\n  <jasper2 \n           validateXml=\"false\" \n           package=\"jsp\"\n           uriroot=\"${deploy.dir}\" \n           webXmlFragment=\"${jspc.base.dir}/fragment.xml\" \n           outputDir=\"${jspc.src.jsp.dir}\" />\n\n\nBoth of these produce the same results, the main.jsp file gets compiled and none\nof the .jsp files that include it get compiled.", "id": 53456, "time": "2004-03-04T19:29:32Z", "creator": "nathanc@tni.com", "creation_time": "2004-03-04T19:29:32Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "kin-man.chung@sun.com", "text": "Jasper keeps track of included static file dependencies of a JSP page by loading\nthe servlet of this page, and invoking its getDependents() method.  JSPC does\nnot currently do such loading, hence it cannot detect changes to included files.\n\nI think it's acceptable to have to remove the generated files before invoking\nJSPC.  Sorry.", "id": 53458, "time": "2004-03-04T20:20:25Z", "bug_id": 27451, "creation_time": "2004-03-04T20:20:25Z", "is_private": false, "attachment_id": null}]