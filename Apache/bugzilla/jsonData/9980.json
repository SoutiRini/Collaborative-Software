[{"count": 0, "tags": [], "creator": "steve5m@yahoo.com", "text": "I have a custom error page, which at the top has\n<%@ page isErrorPage=\"true\" %>\n\nGiven this declaration, when my error page is called\n(because I configured it as the error page for all errors\nin web.xml)\nit should be able to use the built-in variable called 'exception'\naccording to the Servlet 2.2/2.3 spec.\nHowever, in all of my testing so far, this 'exception' varaiable\nturns out to be null -- same code run on Tomcat 3.3.1 never has this\nproblem, and I see no reason for this object to be null (unless the\npage was called where there really is no exception, but I make sure\none was thrown).  Anyway, this bug pretty much prevents me from having\nmy custom error page.", "id": 18025, "time": "2002-06-19T06:06:45Z", "bug_id": 9980, "creation_time": "2002-06-19T06:06:45Z", "is_private": false, "attachment_id": null}, {"count": 1, "attachment_id": null, "bug_id": 9980, "text": "P.S. I'm using Java SDK 1.4.0_01", "id": 18027, "time": "2002-06-19T06:27:26Z", "creator": "steve5m@yahoo.com", "creation_time": "2002-06-19T06:27:26Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 9980, "attachment_id": null, "text": "I don't understand why it doesn't work. The error page is only invoked when \nthere is an exception (assuming you didn't set it for status codes also), which \nis retrieved using a getAttribute method call (attribute name \nis \"javax.servlet.error.exception\"). Then the attribute is correctly passed in \nthe request dispatcher to your error page.\n\nThere are also test cases for that functionality (very similar use cases) in \nthe tester and Watchdog.\n\nIf it still doesn't work for you, please provide a complete test case.", "id": 18056, "time": "2002-06-19T11:42:49Z", "creator": "remm@apache.org", "creation_time": "2002-06-19T11:42:49Z", "is_private": false}, {"count": 3, "attachment_id": 2132, "bug_id": 9980, "text": "Created attachment 2132\nwar file that provides a test app", "id": 18106, "time": "2002-06-19T22:22:40Z", "creator": "steve5m@yahoo.com", "creation_time": "2002-06-19T22:22:40Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 9980, "is_private": false, "id": 18107, "creation_time": "2002-06-19T22:28:16Z", "time": "2002-06-19T22:28:16Z", "creator": "steve5m@yahoo.com", "text": "Did some more testing to identify more specific case that this bug happens:\nFirst, let me explain in general terms:\nThe bug only happens when an exception is thrown\nfrom a full Servlet (not a JSP).\nIn this case, in the custom defined JSP error page (assume there is one)\nthe implicit variable called 'exception'\n(see p39 and p51 of JSP 1.2 specification) is null.\nIt should be the same thing as request.getAttribute(\"javax.servlet.error.exception\")\nbut it is not -- the obvious workaround is to check for null in the error\npage and then use the attribute if the variable is null, nevertheless, this\nis still a bug.\n\nIf you want to look at code, I have attached a war file.\nOnce you start Tomcat with this war in place, go to\nhttp://<host>:<port>/test_app/servlet/time?crash=true\nThis servlet, when given that query string, will throw an exception,\nwhich because of the web.xml file is handled by the error_very_simple.jsp\npage. Note the page checks for the 'exception' object being null\nand prints out a message when it is.\nNote also, if you go to the /test_app/throw_exception.jsp page,\nthis problem does not occur (only occurs when source of exception is a servlet).\nThanks for your time!", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 9980, "attachment_id": null, "is_private": false, "id": 18109, "time": "2002-06-19T23:34:30Z", "creator": "fraro70@cajvc.com", "creation_time": "2002-06-19T23:34:30Z", "text": "Isn't this the right behaviour ?\nAs per the jsp1.2 specs , the attribute used for JSP errors \nis \u201cjavax.servlet.jsp.jspException\u201d, which is set when there is an error in  \nJSP page.(You are free to set it yourself in a servlet)\n\nFor a configured error page , the request should contain the exception using \nattribute \"javax.servlet.error.exception\". I'm guessing thats why there's no \nexception object in your error page.\nIf this is the case though, wonder how it all worked on Tomcat 3.3.1 ?\nUnless I'm completely wrong .."}, {"attachment_id": null, "tags": [], "bug_id": 9980, "is_private": false, "count": 6, "id": 18111, "time": "2002-06-20T00:26:33Z", "creator": "steve5m@yahoo.com", "creation_time": "2002-06-20T00:26:33Z", "text": "The spec actually seems unclear to me -- it makes it clear than if\nan exception happens in a JSP, the 'exception' variable should be set\nand the attribute \"javax.servlet.jsp.jspException\" should also be set\n(and I assume these two would be the same thing)\n- but it doesn't seem to make a statement about whether or not the\n'exception' variable should still be set if the exception is from\nnon-JSP code (servlet or from a class that JSP calls).\nIt seems to me that it should - this makes it easier to write an error page\nbecause generally I don't care where the exception came from (JSP or servlet)\nI just want to work with it - nice if I only have to look one place for it.\n\nResults of some more testing (just the facts of what actually happens):\nTomcat 3.3.1:\n   Exception thrown by JSP:\n      exception object is null: false\n      jspException object is null: false\n      servletException object is null: true\n\n   Exception thrown by servlet:\n      exception object is null: false\n      jspException object is null: false\n      servletException object is null: true\n\nTomcat 4.0.4:\n   Exception thrown by JSP:\n     exception object is null: false\n     jspException object is null: false\n     servletException object is null: false\n\n   Exception thrown by servlet:\n      exception object is null: true\n      jspException object is null: true\n      servletException object is null: false\n\n-- This data shows that Tomcat 3.3.1 and 4.0.4 behave somewhat differently,\nbut I'm not sure which is really the behavior mandated by the Servlet/JSP\nspec.\n"}, {"count": 7, "tags": [], "creator": "steve5m@yahoo.com", "text": "Created attachment 2133\nrevised war file (error page prints more info)", "id": 18113, "time": "2002-06-20T00:28:45Z", "bug_id": 9980, "creation_time": "2002-06-20T00:28:45Z", "is_private": false, "attachment_id": 2133}, {"count": 8, "tags": [], "text": "Having reviewed the specs, I do not believe that there is anything in Tomcat's \nbehaviour that breaches the spec. If you feel that more clarity is required in \nthe specs then please send your comments to servletapi-feedback@eng.sun.com \nand/or jsp-spec-comments@eng.sun.com  ", "attachment_id": null, "bug_id": 9980, "id": 49612, "time": "2003-12-23T15:33:33Z", "creator": "medthomas@ntlworld.com", "creation_time": "2003-12-23T15:33:33Z", "is_private": false}]