[{"count": 0, "tags": [], "bug_id": 45201, "attachment_id": null, "is_private": false, "id": 117667, "time": "2008-06-13T10:10:47Z", "creator": "khsohel@gmail.com", "creation_time": "2008-06-13T10:10:47Z", "text": "I have a blank excel sheet having some macro and command button\nembadded in that. I have written a program using HSSF API to fill some\ndata in this sheet and create cell comment.\n\nNow the problem is when execute this program the command button\ngetting removed from the excel sheet.\n\nPlease find the code i am using :\n\nHSSFPatriarch patr = sheet.createDrawingPatriarch();//This method is\nresponsible for removing command button\n\nHSSFComment comment1 = patr.createComment(new HSSFClientAnchor(2, 2,\n2, 2, (short)4, 2, (short) 6, 5));\n       comment1.setString(new HSSFRichTextString(\"We can set comments in POI\"));\n                               comment1.setAuthor(\"Apache Software Foundation\");\n                               comment1.setRow(2);\n\n                               comment1.setColumn((short)2);\n\n\nPlease help me if you have any solutions or is there any way i can\ncreate a command button and assign a macro fucntion to it, in excel\nsheet using java program"}, {"count": 1, "tags": [], "text": "It's not a bug.\n\nThe 'patriarch' object owns all the drawing elements in the workbook. MS Office drawings, comments, and buttons are all drawing elements.\n\nWhen you call \n\nsheet.createDrawingPatriarch();\n\nyou are creating a new patriarch object (and therefore removing the one that contained your button).\n\nMaybe you want to call\n\nsheet.getDrawingPatriarch();\n\nBut that method is not completely implemented, because all the types of Escher records that could be components of the patriarch are not completely understood. In particular, I don't think POI yet understands how to associate form elements with macros.\n", "is_private": false, "id": 117669, "creator": "zalewski@optonline.net", "time": "2008-06-13T11:25:44Z", "bug_id": 45201, "creation_time": "2008-06-13T11:25:44Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 45201, "attachment_id": null, "id": 117677, "time": "2008-06-13T13:10:41Z", "creator": "khsohel@gmail.com", "creation_time": "2008-06-13T13:10:41Z", "is_private": false, "text": "Hi Michael,\n\nThanks for the comment.\nSo does it means as of now i can not achieve this by using POI.   \n\ncan anybody suggest some other option to achieve the same.\n\nThanks,\nSohel\n\n(In reply to comment #1)\n> It's not a bug.\n> \n> The 'patriarch' object owns all the drawing elements in the workbook. MS Office\n> drawings, comments, and buttons are all drawing elements.\n> \n> When you call \n> \n> sheet.createDrawingPatriarch();\n> \n> you are creating a new patriarch object (and therefore removing the one that\n> contained your button).\n> \n> Maybe you want to call\n> \n> sheet.getDrawingPatriarch();\n> \n> But that method is not completely implemented, because all the types of Escher\n> records that could be components of the patriarch are not completely\n> understood. In particular, I don't think POI yet understands how to associate\n> form elements with macros.\n> \n\n"}, {"count": 3, "text": "At this time, it's not possible to get at the existing patriach, so you can't add a comment without ditching the old one\n\nFor now, you should create as many comments as you want at the same time as adding the command. Then, in POI, move those comments to where you need them, and add the text you need.", "creator": "apache@gagravarr.org", "is_private": false, "id": 118518, "time": "2008-07-10T16:01:43Z", "bug_id": 45201, "creation_time": "2008-07-10T16:01:43Z", "tags": [], "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 45201, "attachment_id": null, "id": 118529, "time": "2008-07-10T16:20:13Z", "creator": "khsohel@gmail.com", "creation_time": "2008-07-10T16:20:13Z", "is_private": false, "text": "Hi Nick,\n\nI am using a excel template which already has some command button embaded in it. these command buttons are used to execute some macro functions.\n\nanyway i can not assign a macro function to a command button. so i can not create the above mentioned template using POI.\n\nOne udpate I have achieved the similar functionality using SmartXL APIs.\n\n\n\n"}]