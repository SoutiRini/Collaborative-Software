[{"count": 0, "tags": [], "text": "I have recently upgrade to j2sdk 1.4 and tomcat 4.03\n\nI have now noticed the following stack trace occours fairly often.\nI had the same problem with previous version of tomcat 4.0. \nI have tried using jsk1.3, which seems to remove the problem, however, i do \nneed to migrate to jdk1.4.\n\nThe stack trace is as follows\n\njava.lang.IllegalStateException: Current state = FLUSHED, new state = CODING_END\n        at java.nio.charset.CharsetEncoder.throwIllegalStateException\n(CharsetEncoder.java:933)\n        at java.nio.charset.CharsetEncoder.encode(CharsetEncoder.java:529)\n        at sun.nio.cs.StreamEncoder$CharsetSE.flushLeftoverChar\n(StreamEncoder.java:356)\n        at sun.nio.cs.StreamEncoder$CharsetSE.implClose(StreamEncoder.java:413)\n        at sun.nio.cs.StreamEncoder.close(StreamEncoder.java:158)\n        at java.io.OutputStreamWriter.close(OutputStreamWriter.java:222)\n        at java.io.PrintWriter.close(PrintWriter.java:137)\n        at org.apache.catalina.connector.ResponseBase.finishResponse\n(ResponseBase.java:482)\n        at org.apache.catalina.connector.HttpResponseBase.finishResponse\n(HttpResponseBase.java:236)\n        at org.apache.catalina.connector.http.HttpResponseImpl.finishResponse\n(HttpResponseImpl.java:288)\n        at org.apache.catalina.connector.http.HttpProcessor.process\n(HttpProcessor.java:1039)\n        at org.apache.catalina.connector.http.HttpProcessor.run\n(HttpProcessor.java:1107)\n        at java.lang.Thread.run(Thread.java:536)\n\nIt does not appear to cause any major problems, however i have not seen what \nhappens to the web pages when this does happen.", "attachment_id": null, "id": 12382, "creation_time": "2002-03-27T12:44:30Z", "time": "2002-03-27T12:44:30Z", "creator": "gavin.stevenson@kcom.com", "bug_id": 7511, "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 7511, "is_private": false, "id": 12398, "time": "2002-03-27T16:01:52Z", "creator": "remm@apache.org", "creation_time": "2002-03-27T16:01:52Z", "tags": [], "text": "Coyote fixes it, but this will not be fixed in the old HTTP connector."}]