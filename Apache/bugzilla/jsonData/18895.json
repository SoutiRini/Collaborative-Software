[{"text": "I try to make a SSL-Connection in a Servlet by using the HttpsURLConnection in\nJava 1.4.1. But when I use the following code I get a ClassCastException. \n\nimport java.net.*;\nimport javax.net.ssl.*;\n...\nURL url = new URL(\"https://localhost/index.jsp\");\nHttpsURLConnection conn = (HttpsURLConnection) url.openConnection();\n...\n\nI think the problem is caused by the\nSystem.setProperty(\"java.protocol.handler.pkgs\", value) command in your class\norg.apache.jk.server.JkMain in method initHTTPSUrls(). It sets this property to\n\"com.sun.net.ssl.internal.www.protocol\" when the property contains null etc. \nThis property is necessary when you are using the JSSE with Java < 1.4.\n\nWhen I comment the Jk2-Connector in the Server.xml out, my code works well.", "tags": [], "bug_id": 18895, "is_private": false, "count": 0, "id": 34859, "time": "2003-04-10T11:04:57Z", "creator": "ralph.stricker@web.de", "creation_time": "2003-04-10T11:04:57Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 18895, "attachment_id": null, "is_private": false, "id": 39162, "time": "2003-06-20T13:09:32Z", "creator": "troy.poppe@eia.doe.gov", "creation_time": "2003-06-20T13:09:32Z", "text": "This also appears in jakarta-tomcat-4.1.24-LE-jdk14"}, {"text": "If you want to keep on using the Jk2-Connector, simply add a line to the jsp, \nxsp(cocoon) or in your application code that reads:\n\nSystem.setProperty(\"java.protocol.handler.pkgs\", \"\"). This overrides the \nsetting set by the Jk2-Connector and you get your \njavax.net.ssl.HttpsURLConnection.\n\nGeorg.", "tags": [], "bug_id": 18895, "is_private": false, "count": 2, "id": 44017, "time": "2003-09-11T07:08:40Z", "creator": "gvs@medaptus.com", "creation_time": "2003-09-11T07:08:40Z", "attachment_id": null}, {"count": 3, "attachment_id": null, "bug_id": 18895, "text": "Urm, err, this has been fixed for a while now.", "id": 44018, "time": "2003-09-11T07:23:43Z", "creator": "william.barker@wilshire.com", "creation_time": "2003-09-11T07:23:43Z", "tags": [], "is_private": false}, {"count": 4, "attachment_id": 8177, "creator": "gvs@medaptus.com", "text": "Created attachment 8177\nShows the type of connections returned by the servlet container.", "id": 44085, "time": "2003-09-12T05:45:32Z", "bug_id": 18895, "creation_time": "2003-09-12T05:45:32Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "bug_id": 18895, "attachment_id": null, "is_private": false, "id": 44086, "time": "2003-09-12T05:46:16Z", "creator": "gvs@medaptus.com", "creation_time": "2003-09-12T05:46:16Z", "text": "Could you note in which version this got fixed? I am running 4.1.27, which \nstill has this issue. It caused serious havoc because of the problem. If you \nwant to test it, just start tomcat and drop the attached jsp into a context \nthat handles JSPs, execute it and see the results. \n\nThen add \n\nSystem.setProperty(\"java.protocol.handler.pkgs\", \"\")\n\nbefore the first statement of the jsp, and \"uhm, err\" whoa, we got ourselves \njavax.net.ssl.HttpsURLConnection ."}, {"count": 6, "tags": [], "bug_id": 18895, "is_private": false, "id": 44087, "creation_time": "2003-09-12T06:26:21Z", "time": "2003-09-12T06:26:21Z", "creator": "william.barker@wilshire.com", "text": "It seems that since at least 4.1.25, Tomcat has stopped \ninitializing \"java.protocol.handler.pkgs\". ", "attachment_id": null}]