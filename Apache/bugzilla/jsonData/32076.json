[{"count": 0, "tags": [], "creator": "ash_sha_21@yahoo.com", "text": "I am trying to biff view one file and it threw the following exception.\n\n\njava.io.IOException: block[ 0 ] already removed\n\tat org.apache.poi.poifs.storage.BlockListImpl.remove\n(BlockListImpl.java:96)\n\tat org.apache.poi.poifs.storage.BlockAllocationTableReader.fetchBlocks\n(BlockAllocationTableReader.java:190)\n\tat org.apache.poi.poifs.storage.BlockListImpl.fetchBlocks\n(BlockListImpl.java:128)\n\tat org.apache.poi.poifs.filesystem.POIFSFileSystem.processProperties\n(POIFSFileSystem.java:405)\n\tat org.apache.poi.poifs.filesystem.POIFSFileSystem.<init>\n(POIFSFileSystem.java:102)\n\tat org.apache.poi.hssf.dev.BiffViewer.run(BiffViewer.java:70)\n\tat org.apache.poi.hssf.dev.BiffViewer.main(BiffViewer.java:652)", "id": 66498, "time": "2004-11-05T04:42:34Z", "bug_id": 32076, "creation_time": "2004-11-05T04:42:34Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 32076, "attachment_id": 13334, "id": 66499, "time": "2004-11-05T04:45:02Z", "creator": "ash_sha_21@yahoo.com", "creation_time": "2004-11-05T04:45:02Z", "is_private": false, "text": "Created attachment 13334\ninput file for biff view."}, {"count": 2, "tags": [], "creator": "ash_sha_21@yahoo.com", "text": "guys , i could resolve this problem by putting a hack .Tell me if it is a \nvalid solution\n\n but my assumption that i have resoved the problem as per bug#31979  is \nresolved is wrong..:(\n\nIn POIFSFileSystem.java In processProperties method\n\nI added a check for size\n              if(size > 0) {\n                \n\n                if (property.shouldUseSmallBlocks())\n                {\n                    document =\n                        new POIFSDocument(name, small_blocks\n                            .fetchBlocks(startBlock), size);\n                }\n                else\n                {\n                    document =\n                        new POIFSDocument(name,\n                                          big_blocks.fetchBlocks(startBlock),\n                                          size);\n                }\n                \n                parent.createDocument(document);\n                }", "id": 66601, "time": "2004-11-08T05:48:19Z", "bug_id": 32076, "creation_time": "2004-11-08T05:48:19Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "avik@apache.org", "attachment_id": null, "text": "Does this file open correctly in Excel? How is this file produced? \n\nWe need to be careful about changes to POIFileSystem, since it might have wider\nrepurcussions. At the very least, we need a testcase demonstrating the error and\nthe fix. \n\nAlso I dont understand your reference to bug 31979. Does this patch fix that\none? Lets discuss this on the dev lists... bugzilla is rotten to have a\nconversation on.", "id": 67146, "time": "2004-11-18T16:21:45Z", "bug_id": 32076, "creation_time": "2004-11-18T16:21:45Z", "is_private": false}, {"count": 4, "attachment_id": null, "bug_id": 32076, "text": "Please try with the latest release and see if this is still trouble. If so then please provide the smallest file that recreates the problem and describe how it was created.", "id": 123596, "time": "2008-12-29T14:48:04Z", "creator": "dfisher@jmlafferty.com", "creation_time": "2008-12-29T14:48:04Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "POIFS has had a number of fixes since this bug was opened. As nothing more has been heard in many years, assuming this has now been fixed", "id": 137546, "time": "2010-06-10T11:13:55Z", "bug_id": 32076, "creation_time": "2010-06-10T11:13:55Z", "is_private": false}]