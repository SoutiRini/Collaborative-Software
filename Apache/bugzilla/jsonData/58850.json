[{"count": 0, "tags": [], "bug_id": 58850, "attachment_id": null, "is_private": false, "id": 187611, "time": "2016-01-13T11:02:49Z", "creator": "luk-ry@web.de", "creation_time": "2016-01-13T11:02:49Z", "text": "I just opened and saved a docx file like this:\n\nFile infile = new File(\"test.docx\");\nXWPFDocument xdoc = null;\nFileInputStream fis = new FileInputStream(infile);\nxdoc = new XWPFDocument(OPCPackage.open(fis));\n\nFileOutputStream outstr = new FileOutputStream(new File(\"bug.docx\"));\nxdoc.write(outstr);\noutstr.close();\n\nThis document contained a table, which was set to borderless. After opening the exported bug.docx, i noticed, that the above code added a border to the table.\n\nI looked into the document.xml, which contained the following:\n\ntest.docx\n\n<w:tbl>\n\t<w:tblPr>\n\t\t<w:tblStyle w:val=\"Basic\"/>\n\t\t<w:tblpPr w:horzAnchor=\"page\" w:leftFromText=\"142\" w:rightFromText=\"142\" w:tblpX=\"1702\" w:tblpY=\"937\" w:vertAnchor=\"page\"/>\n\t\t<w:tblW w:type=\"auto\" w:w=\"0\"/>\n\t\t<w:tblLayout w:type=\"fixed\"/>\n\t\t<w:tblLook w:firstColumn=\"1\" w:firstRow=\"1\" w:lastColumn=\"0\" w:lastRow=\"0\" w:noHBand=\"0\" w:noVBand=\"1\" w:val=\"04A0\"/>\n\t</w:tblPr>\n\t<w:tblGrid>\n\t\t<w:gridCol w:w=\"6804\"/>\n\t</w:tblGrid>\n\t...\n</w:tbl>\n\nThere were some standard values added:\nbug.docx\n\n<w:tbl>\n\t<w:tblPr>\n\t\t<w:tblStyle w:val=\"Basic\"/>\n\t\t<w:tblpPr w:horzAnchor=\"page\" w:leftFromText=\"142\" w:rightFromText=\"142\" w:tblpX=\"1702\" w:tblpY=\"937\" w:vertAnchor=\"page\"/>\n\t\t<w:tblW w:type=\"auto\" w:w=\"0\"/>\n\t\t<w:tblLayout w:type=\"fixed\"/>\n\t\t<w:tblLook w:firstColumn=\"1\" w:firstRow=\"1\" w:lastColumn=\"0\" w:lastRow=\"0\" w:noHBand=\"0\" w:noVBand=\"1\" w:val=\"04A0\"/>\n\t</w:tblPr>\n\t<w:tblPr>\n\t\t<w:tblW w:type=\"auto\" w:w=\"0\"/>\n\t\t<w:tblBorders>\n\t\t\t<w:top w:val=\"single\"/>\n\t\t\t<w:left w:val=\"single\"/>\n\t\t\t<w:bottom w:val=\"single\"/>\n\t\t\t<w:right w:val=\"single\"/>\n\t\t\t<w:insideH w:val=\"single\"/>\n\t\t\t<w:insideV w:val=\"single\"/>\n\t\t</w:tblBorders>\n\t</w:tblPr>\n\t<w:tblGrid>\n\t\t<w:gridCol w:w=\"6804\"/>\n\t</w:tblGrid>\n\t...\n</w:tbl>\n\nThis problem is caused by the createEmptyTable method inside the XWPFTable. I think this method shouldnt be called in this case."}, {"count": 1, "tags": [], "creator": "dominik.stadler@gmx.at", "is_private": false, "text": "Can you attach the original and the failing document? XWPFTable.createEmptyTable() is only called if there are no rows in the table, is this the case here?", "id": 189803, "time": "2016-03-29T19:25:51Z", "bug_id": 58850, "creation_time": "2016-03-29T19:25:51Z", "attachment_id": null}]