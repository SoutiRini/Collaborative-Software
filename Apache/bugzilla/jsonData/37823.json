[{"count": 0, "tags": [], "creator": "jfut@featia.net", "attachment_id": null, "text": "Hi,\n\nI have just ccompiled 2.2.0. The openssl library linked is different between \nhttpd and mod_ssl.\n\n./configure \\\n--enable-mods-shared=all \\\n--enable-ssl\nmake\n\n# ldd ./.libs/httpd\n        ...\n        libssl.so.4 => /lib/libssl.so.4 (0x003c0000)\n        libcrypto.so.4 => /lib/libcrypto.so.4 (0x001e8000)\n        ...\nThese libraries are included in the RPM package (0.9.7a, CentOS 4.2).\n\n# ldd ./modules/ssl/.libs/mod_ssl.so\n        libssl.so.0.9.8 => /usr/lib/libssl.so.0.9.8 (0x00bb1000)\n        libcrypto.so.0.9.8 => /usr/lib/libcrypto.so.0.9.8 (0x00cdd000)\n        ...\nThese libraries were installed by using the source code (0.9.8a).\n\n# ServerToken\nServer: Apache/2.2.0 (Unix) mod_ssl/2.2.0 OpenSSL/0.9.7a\n\nThis seems to be a problem in EXTRA_LIBS and SSL_LIBS.\nI patched the configure file so that httpd and mod_ssl link same library.\n\n# diff -urN configure.orig configure\n--- configure.orig      2005-12-08 03:31:18.000000000 +0900\n+++ configure   2005-12-08 03:31:47.000000000 +0900\n@@ -20277,6 +20277,7 @@\n   echo \"  restoring LIBS to \\\"$LIBS\\\"\"\n   echo \"  setting EXTRA_LIBS to \\\"$EXTRA_LIBS\\\"\"\n fi\n+EXTRA_LIBS=\"$EXTRA_LIBS \\$(SSL_LIBS)\"\n\n\n# ServerToken with pache\nServer: Apache/2.2.0 (Unix) mod_ssl/2.2.0 OpenSSL/0.9.8a", "id": 83383, "time": "2005-12-07T20:44:52Z", "bug_id": 37823, "creation_time": "2005-12-07T20:44:52Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 37823, "attachment_id": null, "text": "marking as a build bug; leaving it to someone who groks autofoo to take any \nfurther. ", "id": 83396, "time": "2005-12-07T23:46:52Z", "creator": "nick@webthing.com", "creation_time": "2005-12-07T23:46:52Z", "is_private": false}, {"count": 2, "tags": [], "creator": "jorton@redhat.com", "text": "Can you attach the config.log produced by the build?", "id": 83400, "time": "2005-12-08T00:30:40Z", "bug_id": 37823, "creation_time": "2005-12-08T00:30:40Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 37823, "attachment_id": null, "id": 83401, "time": "2005-12-08T00:33:21Z", "creator": "jorton@redhat.com", "creation_time": "2005-12-08T00:33:21Z", "is_private": false, "text": "(and the entire output of \"make clean; make\", ideally - use the bugzilla\n\"attachment\" feature!)"}, {"count": 4, "tags": [], "text": "Created attachment 17176\nthe config.log produced by the build", "is_private": false, "id": 83403, "creator": "jfut@featia.net", "time": "2005-12-08T03:56:14Z", "bug_id": 37823, "creation_time": "2005-12-08T03:56:14Z", "attachment_id": 17176}, {"count": 5, "tags": [], "bug_id": 37823, "attachment_id": 17177, "text": "Created attachment 17177\nthe output of \"make clean > make.log ; make >> make.log\"\n\nmod_ssl use EXTRA_LIBS and SSL_LIBS(-lssl -lcrypto), but httpd use only\nEXTRA_LIBS.", "id": 83404, "time": "2005-12-08T04:10:05Z", "creator": "jfut@featia.net", "creation_time": "2005-12-08T04:10:05Z", "is_private": false}, {"count": 6, "tags": [], "text": "Did that patch actually make a difference?\n\nhttpd is not being linked directly against OpenSSL.  It is picking up a\ndependency via one of the dependencies of libapr/libaprutil, I'd guess.  Output\nof \"ldd -v httpd\" might be useful.  If you could attach the complete output of\nthe unpatched configure run too that might help.\n\nMix-and-matching versions of OpenSSL like this is really doomed to failure. \nHave you relinked the system OpenLDAP/Postresq/MySQL/etc.etc against 0.9.8a?", "is_private": false, "bug_id": 37823, "id": 83407, "time": "2005-12-08T09:49:13Z", "creator": "jorton@redhat.com", "creation_time": "2005-12-08T09:49:13Z", "attachment_id": null}, {"count": 7, "tags": [], "creator": "jfut@featia.net", "attachment_id": null, "text": "Yes, that patch make a difference in ServerToken information.\nBefore: Server: Apache/2.2.0 (Unix) mod_ssl/2.2.0 OpenSSL/0.9.7a\nAfter:  Server: Apache/2.2.0 (Unix) mod_ssl/2.2.0 OpenSSL/0.9.8a\n\nI understand that httpd is not being linked directly against OpenSSL.\nHowever, ServerToken information actually depends on httpd linked against \nOpenSSL version, not mod_ssl.so.\n\nWhen I installed by compiling the source code, OpenLDAP/MySQL and Apache 2.0.55 \n(same configuration) linked against 0.9.8a.\n\n[root httpd-2.0.55]# ldd ./.libs/httpd\n        libz.so.1 => /usr/lib/libz.so.1 (0x00d56000)\n*       libssl.so.0.9.8 => /usr/lib/libssl.so.0.9.8 (0x0044a000)\n*       libcrypto.so.0.9.8 => /usr/lib/libcrypto.so.0.9.8 (0x00332000)\n        libaprutil-0.so.0 => not found\n        libldap-2.2.so.7 => /usr/lib/libldap-2.2.so.7 (0x0012f000)\n        liblber-2.2.so.7 => /usr/lib/liblber-2.2.so.7 (0x00162000)\n        libgdbm.so.2 => /usr/lib/libgdbm.so.2 (0x00df5000)\n        libdb-4.2.so => /lib/tls/i686/libdb-4.2.so (0x0016e000)\n        libexpat.so.0 => /usr/lib/libexpat.so.0 (0x00db1000)\n        libapr-0.so.0 => not found\n        librt.so.1 => /lib/tls/librt.so.1 (0x00111000)\n        libm.so.6 => /lib/tls/libm.so.6 (0x00d31000)\n        libcrypt.so.1 => /lib/libcrypt.so.1 (0x0023c000)\n        libnsl.so.1 => /lib/libnsl.so.1 (0x0026a000)\n        libpthread.so.0 => /lib/tls/libpthread.so.0 (0x00d68000)\n        libdl.so.2 => /lib/libdl.so.2 (0x00d2b000)\n        libc.so.6 => /lib/tls/libc.so.6 (0x00bff000)\n        libresolv.so.2 => /lib/libresolv.so.2 (0x00d9c000)\n        libsasl2.so.2 => /usr/lib/libsasl2.so.2 (0x00280000)\n        libssl.so.4 => /lib/libssl.so.4 (0x00294000)\n        libcrypto.so.4 => /lib/libcrypto.so.4 (0x00482000)\n        /lib/ld-linux.so.2 (0x00be6000)\n        libgssapi_krb5.so.2 => /usr/lib/libgssapi_krb5.so.2 (0x002c8000)\n        libkrb5.so.3 => /usr/lib/libkrb5.so.3 (0x0056b000)\n        libcom_err.so.2 => /lib/libcom_err.so.2 (0x00d7c000)\n        libk5crypto.so.3 => /usr/lib/libk5crypto.so.3 (0x002dc000)\n\n[root openldap-2.3.11]# ldd ./servers/slapd/slapd\n        libdb-4.2.so => /lib/tls/i686/libdb-4.2.so (0x00c97000)\n        libpthread.so.0 => /lib/tls/libpthread.so.0 (0x00d9b000)\n        libsasl2.so.2 => /usr/lib/libsasl2.so.2 (0x00111000)\n        libdl.so.2 => /lib/libdl.so.2 (0x00125000)\n        libcrypt.so.1 => /lib/libcrypt.so.1 (0x069af000)\n*       libssl.so.0.9.8 => /usr/lib/libssl.so.0.9.8 (0x00580000)\n*       libcrypto.so.0.9.8 => /usr/lib/libcrypto.so.0.9.8 (0x00129000)\n        libresolv.so.2 => /lib/libresolv.so.2 (0x00de5000)\n        libc.so.6 => /lib/tls/libc.so.6 (0x00b6b000)\n        /lib/ld-linux.so.2 (0x00b52000)\n", "id": 83411, "time": "2005-12-08T10:29:54Z", "bug_id": 37823, "creation_time": "2005-12-08T10:29:54Z", "is_private": false}]