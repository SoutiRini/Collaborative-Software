[{"count": 0, "tags": [], "creator": "call_raghava@yahoo.com", "is_private": false, "id": 47155, "creation_time": "2003-11-11T01:27:15Z", "time": "2003-11-11T01:27:15Z", "bug_id": 24593, "text": "I'm using jakarta-tomcat-4.1.24\nWhen I browse to my http page, I want the user to be redirected to my https \npage, like:\nhttp://localhost/index.jsp should be redirected to https://localhost/index.jsp \nand from then on it should continue to use HTTPS.\n\nIn this regard, I changed my server.xml and web.xml as follows...\n\nserver.xml\n----------\n<!-- Define a non-SSL HTTP/1.1 Connector on port 8080 -->\n    <Connector className=\"org.apache.catalina.connector.http.HttpConnector\"\n               address=\"localhost\" port=\"80\" minProcessors=\"5\" \nmaxProcessors=\"75\"\n               enableLookups=\"true\" redirectPort=\"443\"\n\t       useURIValidationHack=\"false\" disableUploadTimeout=\"true\"\n               acceptCount=\"10\" debug=\"0\" connectionTimeout=\"60000\"/>\n\n<!-- Define an SSL HTTP/1.1 Connector on port 8443 -->\n \n    <Connector className=\"org.apache.catalina.connector.http.HttpConnector\"\n               address=\"localhost\" port=\"443\" minProcessors=\"5\" \nmaxProcessors=\"75\"\n               enableLookups=\"true\"\n\t       useURIValidationHack=\"false\" disableUploadTimeout=\"true\"\n\t       acceptCount=\"10\" debug=\"0\" scheme=\"https\" secure=\"true\">\n      <Factory className=\"org.apache.catalina.net.SSLServerSocketFactory\"\n\t       keystoreFile=\"C:/certificates/server.p12\"\n\t       keystorePass=\"nasdadbaskukndssdfkslfsdf\"\n\t       keystoreType=\"pkcs12-def\"\n               clientAuth=\"false\" protocol=\"TLS\"/>\n    </Connector>\n\nweb.xml\n-------\n<security-constraint>\n\t<web-resource-collection>\n\t\t<web-resource-name>loginRequired</web-resource-name>\n\t\t<url-pattern>/ip/*</url-pattern>\n\t</web-resource-collection>\n\t<auth-constraint>\n\t\t<role-name>admin</role-name>\n\t</auth-constraint>\n  </security-constraint>\n\n  <security-constraint>\n\t<web-resource-collection>\n\t\t<web-resource-name>SSL login</web-resource-name>\n\t\t<url-pattern>/log_on.jsp</url-pattern>\n\t</web-resource-collection>\n\t<user-data-constraint>\n\t\t<description>Secured</description>\n\t\t<transport-guarantee>CONFIDENTIAL</transport-guarantee>\n\t</user-data-constraint>\n  </security-constraint>\n\n  <login-config>\n\t<auth-method>FORM</auth-method>\n\t<form-login-config>\n\t\t<form-login-page>/log_on.jsp</form-login-page>\n\t\t<form-error-page>/error.jsp</form-error-page>\n\t</form-login-config>\n  </login-config>\n\nBut, when I browse to http://localhost/index.jsp, it still uses HTTP.\nCan you suggest me the right way to do it.", "attachment_id": null}, {"count": 1, "tags": [], "text": "The Servlet Spec is very clear that the login-page is not subject to security-\nconstraints.\n\nIn log_in.jsp try:\n  <form method=\"POST\" action=\"https://<%= request.getServerName() %><%= \nrequest.getContextPath() %>/j_security_check\">\n\nYou could also try following-up on tomcat-user for additional tips.", "attachment_id": null, "id": 47162, "creation_time": "2003-11-11T04:10:51Z", "time": "2003-11-11T04:10:51Z", "creator": "william.barker@wilshire.com", "bug_id": 24593, "is_private": false}]