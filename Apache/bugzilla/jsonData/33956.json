[{"count": 0, "tags": [], "bug_id": 33956, "is_private": false, "text": "Not sure if this is a bug or intended behaviour but its causing me some \ntrouble. I have a target defined as below:\n<target name=\"something\" if=\"some.prop\" depends=\"someothertarget\" />\n\nNow, it appears that the depends target gets executed irrespective of \nwhether 'some.prop' is present or not. I was expecting that if 'some.prop' is \nnot available, then target 'something' would not get executed and since it \ndepends on 'someothertarget', even 'someothertarget' should not get executed. \nBut this isnt the case.\n\nWhy should a dependancy get executed if the main target is not going to be \nexecuted anyways due to the absence of the property?\nOr am I missing something?", "id": 72177, "time": "2005-03-11T07:34:55Z", "creator": "aps_jobs_aps@yahoo.com", "creation_time": "2005-03-11T07:34:55Z", "attachment_id": null}, {"count": 1, "text": "The order is:\n1. execute dependend targets\n2. check if and unless clause\n3. execute the target regarding to step 2\n\nThis is because you can do some checks in an earlier target which then sets the \nflag. E.g.\n\n<target name=\"adminDoes.check\">\n    <input addproperty=\"answer\" message=\"Do you have admin privileges?\"/>\n    <condition property=\"isAdmin\">\n        <equals arg1=\"${answer}\" arg2=\"yes\"/>\n    </condition>\n</target>\n\n<target name=\"adminDoes\" depends=\"adminDoes.check\" if=\"isAdmin\">\n    <echo>Hello Admin</echo>\n</target>\n\n\nSee also manual \"Using Ant > Targets\"", "bug_id": 33956, "is_private": false, "id": 72178, "time": "2005-03-11T08:02:58Z", "creator": "jan@materne.de", "creation_time": "2005-03-11T08:02:58Z", "tags": [], "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 33956, "attachment_id": null, "text": "(In reply to comment #1)\n> The order is:\n> 1. execute dependend targets\n> 2. check if and unless clause\n> 3. execute the target regarding to step 2\n> This is because you can do some checks in an earlier target which then sets \nthe \n> flag. E.g.\n> <target name=\"adminDoes.check\">\n>     <input addproperty=\"answer\" message=\"Do you have admin privileges?\"/>\n>     <condition property=\"isAdmin\">\n>         <equals arg1=\"${answer}\" arg2=\"yes\"/>\n>     </condition>\n> </target>\n> <target name=\"adminDoes\" depends=\"adminDoes.check\" if=\"isAdmin\">\n>     <echo>Hello Admin</echo>\n> </target>\n> See also manual \"Using Ant > Targets\"\n\n\nThanks for your response. Yes, I understand this is one scenario. Here's is my \nscenario. I am trying to reduce the number of antcalls in a huge project by \nusing depends to evaluate performance.\n\n<target name=\"1\" if=\"condition1\" depends=\"2,3,4\"/>\n<target name=\"2\" if=\"condition1\" />\n<target name=\"3\" if=\"condition1\" />\n\n<target name=\"4\" if=\"condition1 + condition2\" />\n\nNow, target 4 needs condition 1 as well as condition 2. To achieve this, I \nwould have to make target 4 depend on some other target that merges condition 1 \nand condition 2 and then execute it?? Is that the only option?", "id": 72192, "time": "2005-03-11T11:59:46Z", "creator": "aps_jobs_aps@yahoo.com", "creation_time": "2005-03-11T11:59:46Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 33956, "attachment_id": null, "text": "If your structure was working before with antcalls it may prove to be more\nbeneficial to you to keep depends/if/unless target attributes mostly as-is and\nconvert your antcalls to macro invocations.  The main reason to \"try and reduce\nthe number of antcalls\" is to avoid the cost in memory and time incurred in\ncreating the new project instance that goes along with an antcall.  Macrodefs\nachieve this.", "id": 72210, "time": "2005-03-11T16:51:46Z", "creator": "mbenson@apache.org", "creation_time": "2005-03-11T16:51:46Z", "is_private": false}, {"count": 4, "tags": [], "creator": "aps_jobs_aps@yahoo.com", "attachment_id": null, "is_private": false, "id": 72297, "time": "2005-03-13T10:00:13Z", "bug_id": 33956, "creation_time": "2005-03-13T10:00:13Z", "text": "(In reply to comment #3)\n> If your structure was working before with antcalls it may prove to be more\n> beneficial to you to keep depends/if/unless target attributes mostly as-is \nand\n> convert your antcalls to macro invocations.  The main reason to \"try and \nreduce\n> the number of antcalls\" is to avoid the cost in memory and time incurred in\n> creating the new project instance that goes along with an antcall.  Macrodefs\n> achieve this.\n\n\nI have used macrodefs in place of antcalls in many places to improve \nperformance. But it doesnt work quite well in the scenario that I have \ndescribed. Even, if I make targets 2, 3 and 4 as macrodefs and invoke them \nfrom 1, I still want 4 (which is now a macrodef and not a target) to be \nexecuted conditionally. And macrodefs do not support conditions and there \nbegins the problem. Effectively I am looking at something like this..\n\n<target name=\"1\" if=\"condition1\" >\n\n <macro 2 />\n <macro 3 />\n <!-- <macro 4 if=\"condition2\" />\n\n</target>"}, {"count": 5, "text": "<target name=\"-1\" if=\"condition1\" >\n  <macro 2 />\n  <macro 3 />\n  <condition property=\"condition2\">\n    <... />\n  </condition>\n</target>\n<target name=\"4\" if=\"condition2\">\n  <... />\n</target>\n<target name=\"1\" depends=\"-1,4\" />", "bug_id": 33956, "is_private": false, "id": 72451, "time": "2005-03-15T16:14:32Z", "creator": "mbenson@apache.org", "creation_time": "2005-03-15T16:14:32Z", "tags": [], "attachment_id": null}]