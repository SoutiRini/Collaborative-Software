[{"count": 0, "tags": [], "creator": "luke1410@gmx.de", "text": "running nmake -f Makefile.win (OS: Win10 64-bit, VS 2015 CE Update 2) raises the following error:\n\"The system cannot find the path specified.\"\n\nand incorrectly sets the ARCH to Win32 Release instead of x64 Release.\n\nAs far as I can tell the issue is in Makefile.win ln 49 where $(SystemRoot) is specified, while according to the nmake documentation, environment variables are converted to uppercase letters. [1]\n\nReplacing $(SystemRoot) with $(SYSTEMROOT) resolves the issue for me here.\n\n[1] https://msdn.microsoft.com/en-us/library/99at5bh3.aspx", "id": 191619, "time": "2016-06-13T23:14:59Z", "bug_id": 59698, "creation_time": "2016-06-13T23:14:59Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "luke1410@gmx.de", "text": "Note: This issue then results in the following linker error due to the target and source platform mismatch:\n\n.\\Release\\apr_atomic.obj : fatal error LNK1112: module machine type 'x64' conflicts with target machine type 'X86'\nNMAKE : fatal error U1077: '\"E:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\amd64\\link.exe\"' : return code '0x458'\nStop.\nNMAKE : fatal error U1077: '\"E:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN\\amd64\\nmake.exe\"' : return code '0x2'\nStop.", "id": 191620, "time": "2016-06-13T23:22:32Z", "bug_id": 59698, "creation_time": "2016-06-13T23:22:32Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 59698, "attachment_id": 33947, "text": "Created attachment 33947\npatch for Makefile.win", "id": 191622, "time": "2016-06-13T23:30:55Z", "creator": "luke1410@gmx.de", "creation_time": "2016-06-13T23:30:55Z", "is_private": false}, {"count": 3, "tags": [], "creator": "luke1410@gmx.de", "text": "Created attachment 33988\npatch to correct test/makefile.win\n\nThere's another part of the issue. Trying to run the Makefile.win in test directly (rather than indirectly through the main Makefile.win) will trigger the same error, and if only the first patch is applied, would fail with some error (since it then points to the incorrect directory for the library file).\n\nHence, the second patch corrects the same issue in test/Makefile.win.", "id": 191955, "time": "2016-06-26T23:09:40Z", "bug_id": 59698, "creation_time": "2016-06-26T23:09:40Z", "is_private": false, "attachment_id": 33988}]