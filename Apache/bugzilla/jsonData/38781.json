[{"count": 0, "tags": [], "bug_id": 38781, "attachment_id": null, "text": "I think ant works incorrectly when processing xslt, particullary the charset of\noutput file IS NOT windows-1251\n\nant build.xml\n=============\n  <xslt in=\"source.xml\" out=\"out.xml\" style=\"style.xslt\">\n    <outputproperty name=\"method\" value=\"html\"/>\n    <outputproperty name=\"encoding\" value=\"Windows-1251\" /> \n  </xslt>\n=============\n\nsource.xml\n=============\n<?xml version=\"1.0\" encoding=\"windows-1251\" ?>\n<ur-document>\n\u00c4\u00ee\u00ea\u00f3\u00ec\u00e5\u00ed\u00f2\n</ur-document>\n=============\n\nstyle.xslt\n=============\n<?xml version='1.0' encoding='windows-1251'?>\n<xsl:stylesheet xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" version=\"1.0\">\n<xsl:output method=\"html\" version=\"4.0\" encoding=\"windows-1251\" indent=\"yes\" />\n<xsl:param name=\"lang\" select=\"'rus'\" />\n<xsl:template match=\"/ur-document\">\n\t<html> \n\t <title>\n\t  \u00cd\u00e0\u00e7\u00e2\u00e0\u00ed\u00e8\u00e5 : <xsl:value-of select=\".\"/>\n\t </title>\n\t</html>\n</xsl:template>\n</xsl:stylesheet>\n=============", "id": 86207, "time": "2006-02-24T20:31:59Z", "creator": "master_temp@tut.by", "creation_time": "2006-02-24T20:31:59Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 38781, "text": "The output is in UTF-8.", "id": 86208, "time": "2006-02-24T20:48:22Z", "creator": "alexeys@inventigo.com", "creation_time": "2006-02-24T20:48:22Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "alexeys@inventigo.com", "attachment_id": null, "id": 86209, "time": "2006-02-24T20:56:41Z", "bug_id": 38781, "creation_time": "2006-02-24T20:56:41Z", "is_private": false, "text": "Actually Unicode. Try replacing \"Windows-1251\" with a bogus value and you will\nsee: [xslt] Warning: encoding \"aaa\" not supported, using UTF-8. The resulting\nfile is in correct Windows-1251 encoding, but valid Windows-1251 characters are\nencoded additionally. The output should work fine in the current form, if file\nsize is not an issue."}, {"count": 3, "tags": [], "creator": "master_temp@tut.by", "attachment_id": null, "id": 86210, "time": "2006-02-24T21:23:22Z", "bug_id": 38781, "creation_time": "2006-02-24T21:23:22Z", "is_private": false, "text": "(In reply to comment #2)\n> Actually Unicode. Try replacing \"Windows-1251\" with a bogus value and you will\n> see: [xslt] Warning: encoding \"aaa\" not supported, using UTF-8. The resulting\n> file is in correct Windows-1251 encoding, but valid Windows-1251 characters are\n> encoded additionally. The output should work fine in the current form, if file\n> size is not an issue.\n\nOk. Many thanks. But how can I (In reply to comment #2)\n> Actually Unicode. Try replacing \"Windows-1251\" with a bogus value and you will\n> see: [xslt] Warning: encoding \"aaa\" not supported, using UTF-8. The resulting\n> file is in correct Windows-1251 encoding, but valid Windows-1251 characters are\n> encoded additionally. The output should work fine in the current form, if file\n> size is not an issue.\n\n\nThank you. But how can I reach the behavior on jdk1.4 when output is \"windows-1251\"?"}, {"count": 4, "tags": [], "bug_id": 38781, "attachment_id": null, "text": "I do not think there is anything can be done in ANT. It is up to XSLT library to\nencode output. Why not to use UTF-8?", "id": 86211, "time": "2006-02-24T21:26:54Z", "creator": "alexeys@inventigo.com", "creation_time": "2006-02-24T21:26:54Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 38781, "attachment_id": null, "text": "If this problem only arises in java1.5, then it is probably due to the XSLT\nengine that ships with java1.5. Try adding Xalan to your ant lib directory and\nseeing what you can do to explicitly ask for it, if it is not picked up\nautomatically.", "id": 86231, "time": "2006-02-25T19:09:38Z", "creator": "stevel@apache.org", "creation_time": "2006-02-25T19:09:38Z", "is_private": false}, {"count": 6, "tags": [], "creator": "master_temp@tut.by", "attachment_id": null, "id": 86232, "time": "2006-02-25T19:58:29Z", "bug_id": 38781, "creation_time": "2006-02-25T19:58:29Z", "is_private": false, "text": "(In reply to comment #5)\nI put xalan.jar to ants lib directory, but output file didn't changed. \n(paremeter processor=\"xalan\" - is deprecated in ant 1.6.5)"}, {"count": 7, "tags": [], "creator": "stevel@apache.org", "attachment_id": null, "id": 90870, "time": "2006-07-04T20:41:00Z", "bug_id": 38781, "creation_time": "2006-07-04T20:41:00Z", "is_private": false, "text": "DMoL, in reply to comment #6, try setting the factory instead, with\n\n<factory name=\"org.apache.xalan.processor.TransformerFactoryImpl\"/>\n\nthis forces xalan into action, not xsltc. Let us know what happens."}, {"count": 8, "tags": [], "bug_id": 38781, "attachment_id": null, "text": "(In reply to comment #7)\n> DMoL, in reply to comment #6, try setting the factory instead, with\n> <factory name=\"org.apache.xalan.processor.TransformerFactoryImpl\"/>\n> this forces xalan into action, not xsltc. Let us know what happens.\n\nI have changed build.xml to this, but output still the same (incorrect, not cp-1251)\n\t <xslt in=\"source.xml\" out=\"out.xml\" style=\"style.xslt\">\n\t    <factory name=\"org.apache.xalan.processor.TransformerFactoryImpl\"/>\n\t  </xslt>", "id": 90917, "time": "2006-07-05T17:07:10Z", "creator": "master_temp@tut.by", "creation_time": "2006-07-05T17:07:10Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 38781, "attachment_id": null, "text": "you don't need to specify any factory and not fiddle with ant/lib, you should install the latest version of Xalan using the endorsed standards override mechanism[1].\n\nJDK 1.5's XSLT engine is seriously broken and you'll be happy to have it replaced.\n\nNot an Ant bug anyway.\n\n[1] http://xml.apache.org/xalan-j/faq.html#faq-N100EF", "id": 122785, "time": "2008-11-24T08:20:26Z", "creator": "bodewig@apache.org", "creation_time": "2008-11-24T08:20:26Z", "is_private": false}]