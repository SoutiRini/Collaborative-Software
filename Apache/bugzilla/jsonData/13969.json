[{"count": 0, "tags": [], "creator": "boris@folgmann.de", "attachment_id": null, "is_private": false, "id": 25189, "time": "2002-10-25T11:30:36Z", "bug_id": 13969, "creation_time": "2002-10-25T11:30:36Z", "text": "A DESCRIPTION OF THE PROBLEM :\nThe ':' characted is not encoded properly by encodeURL() or\nredirectURL(). In fact it seems to confuse the method a lot.\n\n\nSTEPS TO FOLLOW TO REPRODUCE THE PROBLEM :\n1. Try this inside a JSP:\n<%\nresponse.sendRedirect(response.encodeRedirectURL(\"bug.jsp?ready=Saturday\n04:30\")); %>\n\n2. Load the page in your browser\n3. See the totally wrong encoded URL in the adress field\n\nEXPECTED VERSUS ACTUAL BEHAVIOR :\nThe above URL should be encoded to:\nhttp://localhost:8081/bug.jsp?ready=Saturday%2004%3A30\n\nIn fact it's encoded to:\nhttp://localhost:8081/bug.jsp?ready=saturday%2004:?ready=Saturday%2004:30\n\nRESULTING PROBLEMS:\nWith this more or less destroyed URL the redirect or an <a href=\"\"> don't work\nif an : is passed through a CGI parameter. Problems get even worse, if you have\nto rely on the sessionid in the URL.\n\n\nREPRODUCIBILITY :\nThis bug can be reproduced always.\n\nTry this demo.jsp:\n<%@page contentType=\"text/html\"%>\n<% response.sendRedirect(response.encodeRedirectURL(\"bug.jsp?ready=Saturday\n04:30\")); %>\n\nJDK:\njava version \"1.4.1\"\nJava(TM) 2 Runtime Environment, Standard Edition (build 1.4.1-b21)\nJava HotSpot(TM) Client VM (build 1.4.1-b21, mixed mode)\nJava 2 Enterprise Edition version 1.3.1, build 1.3.1-b17\n\nOPERATING SYSTEM:\nRed Hat Linux release 8.0 (Psyche)\nLinux 2.4.18-17.8.0 #1 Tue Oct 8 13:51:08 EDT 2002 i686 i686 i386 GNU/Linux\nglibc-2.2.93-5"}, {"count": 1, "tags": [], "bug_id": 13969, "attachment_id": null, "id": 25190, "creation_time": "2002-10-25T11:41:32Z", "time": "2002-10-25T11:41:32Z", "creator": "boris@folgmann.de", "text": "Similar problem in encoding %.\nPlease check every possible characters!\n", "is_private": false}, {"count": 2, "attachment_id": null, "bug_id": 13969, "is_private": false, "id": 26492, "time": "2002-11-18T16:43:19Z", "creator": "Brian.Ewins@btinternet.com", "creation_time": "2002-11-18T16:43:19Z", "tags": [], "text": "':' and '%' are reserved characters in the URL spec\n(http://www.w3.org/Addressing/rfc1738.txt, see section 5). You need to URL\nencoded them, or you'll get either a MalformedURLException or undefined behaviour.\n\nIt seems probably you've misunderstood the meaning of encodeURL(). This doesn't\nURL-encode a string (yes it does sound similar :) ) It adds the session id if\nyou're using URL rewriting to maintain sessions. See\nhttp://jakarta.apache.org/tomcat/tomcat-4.0-doc/servletapi/javax/servlet/http/HttpServletResponse.html#encodeURL(java.lang.String)\n\n\nThe correct way to write your code would be:\n <%\nresponse.sendRedirect(response.encodeRedirectURL(\"bug.jsp?ready=\"+java.net.URLEncoder.encode(\"Saturday\n04:30\"))); %>\n\nthis is JDK 1.3, in JDK 1.4, URLEncoder.encode(String) is deprecated and you\nneed to specify the charset for encoding:\n<%\nresponse.sendRedirect(response.encodeRedirectURL(\"bug.jsp?ready=\"+java.net.URLEncoder.encode(\"Saturday\n04:30\",\"UTF8\"))); %>\n"}]