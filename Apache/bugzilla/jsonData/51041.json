[{"count": 0, "tags": [], "bug_id": 51041, "is_private": false, "text": "HI, \n    I found a problem when i set a formula in a cell.\n    I set some cell's value , and export it , like this.\n    Cell A1 's value is int(1), cell B1's value is int(2), and a fomula in cell C1 is \"=sum(A1+B1)\".\n   When i export this excel file, i find the formula can't calculate right. It shows \"#VALUE!\".\n\n    Then i found something for this problem.\n    In the last case, poi parsed the formula and the result of tokens was :\n    1. RefPtg  ptgclass (Ptg.CLASS_REF)         A1\n    2. RefPtg  ptgclass (Ptg.CLASS_REF)         B1\n    3. AddPtg                                                 +\n    4. FunVarPtg                                           SUM\n    The excel show it can't work when doing the add action.\n    And if i parsed the formula \"=A1+B1\", the result of tokens was :\n    1. RefPtg  ptgclass (Ptg.CLASS_VALUE)    A1\n    2. RefPtg  ptgclass (Ptg.CLASS_VALUE)    B1\n    3. AddPtg                                                 +\n    and it calculate right;\n\n    so i guess maybe excel only can do add action when the two ptg's ptgclass is Ptg.CLASS_VALUE.\n\n    Sorry for my poor english.", "id": 145630, "time": "2011-04-08T00:45:44Z", "creator": "liyt0915@gmail.com", "creation_time": "2011-04-08T00:45:44Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "text": "You are aware that you need to use the FormulaEvaluator to calculate the cached formula value? That needs to be done after changing any formulas, and before saving the file. Otherwise you'll get the behaviour you describe of #VALUE! in excel, until you trigger the recalculation\n\nCan you confirm if you're doing a formula evaluation?", "id": 145639, "time": "2011-04-08T07:08:23Z", "bug_id": 51041, "creation_time": "2011-04-08T07:08:23Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 51041, "attachment_id": null, "text": "No response on the question in the previous comment, therefore closing this as WORKSFORME now. Please reopen the bug with more information if this is still a problem for you.", "id": 183219, "time": "2015-05-31T21:49:20Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-05-31T21:49:20Z", "is_private": false}]