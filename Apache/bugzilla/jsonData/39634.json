[{"count": 0, "tags": [], "bug_id": 39634, "attachment_id": null, "id": 89365, "time": "2006-05-22T23:22:02Z", "creator": "inordinateck@yahoo.com", "creation_time": "2006-05-22T23:22:02Z", "is_private": false, "text": "Here's the stack trace:\n\njava.lang.ArrayIndexOutOfBoundsException: 60\n        at\norg.apache.poi.hssf.record.aggregates.ValueRecordsAggregate.rowHasCells(ValueRecordsAggregate.java:195)\n        at org.apache.poi.hssf.model.Sheet.getSize(Sheet.java:2112)\n        at\norg.apache.poi.hssf.usermodel.HSSFWorkbook.getBytes(HSSFWorkbook.java:920)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.write(HSSFWorkbook.java:875)\n\n\nIssue seems to be lines 193-194 in\norg.apache.poi.hssf.record.aggregates.ValueRecordsAggregate (SVN 408776):\n\n    \tif (row > records.length)\n    \t\treturn false;\n\nWhich seems like it should be\n\n    \tif (row >= records.length)\n    \t\treturn false;\n\nThat's just a quick guess, from a very cursory look at the code."}, {"count": 1, "tags": [], "bug_id": 39634, "attachment_id": null, "id": 89366, "time": "2006-05-22T23:23:45Z", "creator": "inordinateck@yahoo.com", "creation_time": "2006-05-22T23:23:45Z", "is_private": false, "text": "actually, fixing that threw more null pointers.  Seems a bit odd, since I've run\nthis code hundreds of times before with no trouble.  In any case, the problems I\nran into after the first fix all had to do with the MyIterator inner class in\nthe same ValueRecordsAggregator class.  I'll attach a diff that seems to have\nresolved the problem."}, {"count": 2, "tags": [], "creator": "inordinateck@yahoo.com", "attachment_id": 18331, "text": "Created attachment 18331\nValueRecordsAggregate.java svn diff", "id": 89367, "time": "2006-05-22T23:27:47Z", "bug_id": 39634, "creation_time": "2006-05-22T23:27:47Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 39634, "attachment_id": null, "id": 92216, "time": "2006-08-15T01:24:51Z", "creator": "jheight@apache.org", "creation_time": "2006-08-15T01:24:51Z", "is_private": false, "text": "I am very reluctant to apply this patch without further investigation. Can you\nprovide a sample piece of code or an excel workbook which when written out\ndisplays  the error.\n\nI have never come across this, and since i wrote that piece of code would like\nto feel confident that it is the problem ;-) (rather than another related piece\nof code)\n\nJason"}, {"count": 4, "tags": [], "creator": "inordinateck@yahoo.com", "attachment_id": null, "is_private": false, "id": 92217, "time": "2006-08-15T02:44:19Z", "bug_id": 39634, "creation_time": "2006-08-15T02:44:19Z", "text": "Your request makes perfect sense, I wish I was prudent enough to include the\ntest case back when I filed it.  I've been running the patched code in\nproduction now for close to three months, and I can't recall exactly what was\ncausing it.  I'll have to do some digging around- I'll get back to you..."}, {"count": 5, "tags": [], "text": "I also have this problem.  The patch from CK seems to correct it.  Thanks.\n\nI'll attach an excel workbook which when written leads to the error.  I used the\n sample code below for testing.\n\nChris\n\n\nimport java.io.*;\nimport org.apache.poi.hssf.usermodel.HSSFWorkbook;\nimport org.apache.poi.poifs.filesystem.POIFSFileSystem;\n\npublic class ExcelTest\n{\n    public static void main(String[] args) throws Exception\n    {\n\tInputStream inputStream = new FileInputStream(new File(args[0]));\n\tOutputStream outputStream = new FileOutputStream(new File(args[1]));\n\tPOIFSFileSystem fileSystem = new POIFSFileSystem(inputStream);\n\tHSSFWorkbook workbook = new HSSFWorkbook(fileSystem);\n\tworkbook.write(outputStream);\n    }\n}\n", "is_private": false, "id": 96846, "creator": "chris@siterra.com", "time": "2006-12-12T15:15:12Z", "bug_id": 39634, "creation_time": "2006-12-12T15:15:12Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 39634, "attachment_id": 19251, "id": 96847, "time": "2006-12-12T15:18:24Z", "creator": "chris@siterra.com", "creation_time": "2006-12-12T15:18:24Z", "is_private": false, "text": "Created attachment 19251\nSample Excel Workbook which leads to error when written."}, {"count": 7, "tags": [], "bug_id": 39634, "attachment_id": null, "id": 116741, "time": "2008-05-17T06:27:59Z", "creator": "yegor@dinom.ru", "creation_time": "2008-05-17T06:27:59Z", "is_private": false, "text": "The problem seems to be fixed in poi-3.1-beta2.\n\nYegor"}]