[{"count": 0, "tags": [], "bug_id": 49431, "attachment_id": 25590, "id": 137591, "time": "2010-06-12T07:28:22Z", "creator": "vinodsridhar1981@gmail.com", "creation_time": "2010-06-12T07:28:22Z", "is_private": false, "text": "Created attachment 25590\nThe snoop behaviour when apache xmlrpc http client is used\n\nI have configured the server.xml to have the following configuration\n\n <Connector port=\"11030\" protocol=\"HTTP/1.1\" \n               connectionTimeout=\"60000\" maxThreads=\"150\" \n               maxKeepAliveRequests=\"-1\"\n               redirectPort=\"11033\" />\n\n\nUsing apache xmlrpc client scenario\n-------------------------------------\nI am having  a apache xmlrpc servlet running on Tomcat which responds for the apache xmlrpc client .I could see the following HTTP Post is happening\n\nPOST /VoucherUsage HTTP/1.1\nContent-Type: text/xml\nUser-Agent: Apache XML RPC 3.0 (Jakarta Commons httpclient Transport)\nAuthorization: Basic dnM6dnM=\nHost: 147.128.136.46:11030\nContent-Length: 503\n\nwhen i see the messages in packet sniffer.I see the tomcat is intitating a TCP FIN to terminate connections from the client.\n\nUsing jmeter client scenario\n-----------------------------\nI also tested the same scenario using jmeter client .When keep-alive is set it is working fine.Here the tomcat is not intiating the TCP FIN.The difference i found is that it sends a Connection header with keep-alive message.\n\nPOST /VoucherUsage HTTP/1.1\nConnection: keep-alive\nUser-Agent: AIR Server/2.0/1.0\nauthorization: Basic ZXJpY3Nzb246ZXJpY3Nzb24xMjM=\nHost: 147.128.136.46:11030\nContent-Length: 997\nContent-Type: text/xml; charset=utf-8\n \nTomcat in HTTP/1.1 is not providing keep-alive by default without the Connection header.Please fix this"}, {"count": 1, "tags": [], "creator": "markt@apache.org", "text": "The attached trace clearly shows the commons httpclient has not been configured for keep-alive since it creates a new connection for each request.", "id": 137601, "time": "2010-06-13T16:20:53Z", "bug_id": 49431, "creation_time": "2010-06-13T16:20:53Z", "is_private": false, "attachment_id": null}]