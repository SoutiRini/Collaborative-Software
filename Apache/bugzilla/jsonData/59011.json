[{"count": 0, "tags": [], "bug_id": 59011, "attachment_id": 33561, "id": 188467, "time": "2016-02-16T12:59:08Z", "creator": "rudrajit.basu@gmail.com", "creation_time": "2016-02-16T12:59:08Z", "is_private": false, "text": "Created attachment 33561\nThis file is saved in open office as xlsx file and was saved in the web application itself, where I got the inputstream to pass to apache poi xssfworkbook constructor.\n\nwhile uploading xlsx file from the servlet path of tomcat i.e. the file is saved in the application itself. The file input stream was taken from the path file and was loaded. The exception occurred.\n\norg.apache.poi.openxml4j.exceptions.OpenXML4JRuntimeException: Rule M2.4 exception : this error should NEVER happen! Please raise a bug at https://bz.apache.org/bugzilla/enter_bug.cgi?product=POI and attach a file that triggers it, thanks!\n\tat org.apache.poi.openxml4j.opc.internal.ContentTypeManager.getContentType(ContentTypeManager.java:343)\n\tat org.apache.poi.openxml4j.opc.internal.ContentTypeManager.removeContentType(ContentTypeManager.java:256)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.removePart(OPCPackage.java:943)\n\tat org.apache.poi.openxml4j.opc.PackagePart.getOutputStream(PackagePart.java:522)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.commit(XSSFWorkbook.java:1678)\n\tat org.apache.poi.POIXMLDocumentPart.onSave(POIXMLDocumentPart.java:341)\n\tat org.apache.poi.POIXMLDocument.write(POIXMLDocument.java:206)\n\tat billing.monthlyTimeSheetReport.TimesheetReportAction.startProcessing(TimesheetReportAction.java:245)\n\tat billing.monthlyTimeSheetReport.TimesheetReportAction.execute(TimesheetReportAction.java:74)\n\tat org.apache.struts.action.RequestProcessor.processActionPerform(RequestProcessor.java:484)\n\tat org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:274)\n\tat org.apache.struts.action.ActionServlet.process(ActionServlet.java:1482)\n\tat org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:525)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:643)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:723)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n\tat org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n\tat org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)\n\tat org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)\n\tat webprompt.application.RequestValidator.doFilter(RequestValidator.java:87)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)\n\tat org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:861)\n\tat org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:606)\n\tat org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)\n\tat java.lang.Thread.run(Thread.java:745)\n\nThe uploaded file is in the attachment. This file is saved in open office as xlsx file and was saved in the web application itself, where I got the inputstream to pass to apache poi xssfworkbook constructor.\n\nThanks in advance."}, {"count": 1, "tags": [], "bug_id": 59011, "text": "I have made a mistake in reporting the issue ,the reason because of which the exception \"org.apache.poi.openxml4j.exceptions.OpenXML4JRuntimeException: Rule M2.4 exception : this error should NEVER happen! Please raise a bug at https://bz.apache.org/bugzilla/enter_bug.cgi?product=POI and attach a file that triggers it, thanks!\" is occurring when I am loading a filled xlsx file as Xssfworkbook and then I have edited on the same file and then when I am trying to write the outputstream from the Xssfworkbook instance I am getting this error.", "id": 188490, "time": "2016-02-17T06:34:54Z", "creator": "rudrajit.basu@gmail.com", "creation_time": "2016-02-17T06:34:54Z", "is_private": false, "attachment_id": null}, {"count": 2, "attachment_id": null, "bug_id": 59011, "text": "I was getting this exception as I had closed the XSSFWorkbook instance object and then I was trying to write the outputstream from the same instance.", "id": 188491, "time": "2016-02-17T07:39:24Z", "creator": "rudrajit.basu@gmail.com", "creation_time": "2016-02-17T07:39:24Z", "tags": [], "is_private": false}]