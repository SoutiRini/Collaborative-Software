[{"count": 0, "tags": [], "bug_id": 48832, "attachment_id": null, "text": "I try to add meta data via SummaryInfo:\n\n-----------\nworkbook.createInformationProperties();\n            final SummaryInformation si = workbook.getSummaryInformation();\n            if (si != null) {\n                for (final Map.Entry<String, Object> e : summaryInfo.entrySet()) {\n                    final String k = e.getKey().toLowerCase();\n                    final Object o = e.getValue();\n                    if (k != null && o != null) {\n                        if (\"author\".equals(k)) {\n                            si.setLastAuthor(si.getAuthor());\n                            si.setAuthor(o.toString());\n                        } else if (\"appName\".equals(k)) {\n                            si.setApplicationName(o.toString());\n                        } else if (\"comments\".equals(k)) {\n                            si.setComments(o.toString());\n                        } else if (\"creationDate\".equals(k) && o instanceof Date) {\n                            si.setCreateDateTime((Date) o);\n                        } else if (\"keywords\".equals(k)) {\n                            si.setKeywords(o.toString());\n                        } else if (\"keywords\".equals(k)) {\n                            si.setKeywords(o.toString());\n                        } else if (\"subject\".equals(k)) {\n                            si.setSubject(o.toString());\n                        } else if (\"title\".equals(k)) {\n                            si.setTitle(o.toString());\n                        }\n                    }//else: entry unavailable\n                }//next input summaryInfo\n            }//else: SummaryInformation unavailable\n----------------------\n\nbut when I save the workbook (via workbook.write(fos) ), I get this NPE:\n\n----------------\n    org.apache.poi.hpsf.HPSFRuntimeException\n    \tat org.apache.poi.hpsf.MutableSection.getSize(MutableSection.java:328)\n    \tat org.apache.poi.hpsf.MutablePropertySet.write(MutablePropertySet.java:230)\n    \tat org.apache.poi.POIDocument.writePropertySet(POIDocument.java:209)\n    \tat org.apache.poi.POIDocument.writeProperties(POIDocument.java:184)\n    \tat org.apache.poi.hssf.usermodel.HSSFWorkbook.write(HSSFWorkbook.java:1169)\n        ...\n    Caused by:\n    java.lang.NullPointerException\n    \tat org.apache.poi.hpsf.VariantSupport.write(VariantSupport.java:503)\n    \tat org.apache.poi.hpsf.MutableProperty.write(MutableProperty.java:116)\n    \tat org.apache.poi.hpsf.MutableSection.write(MutableSection.java:459)\n    \tat org.apache.poi.hpsf.MutableSection.calcSize(MutableSection.java:348)\n    \tat org.apache.poi.hpsf.MutableSection.getSize(MutableSection.java:319)\n    \tat org.apache.poi.hpsf.MutablePropertySet.write(MutablePropertySet.java:230)\n    \tat org.apache.poi.POIDocument.writePropertySet(POIDocument.java:209)\n    \tat org.apache.poi.POIDocument.writeProperties(POIDocument.java:184)\n    \tat org.apache.poi.hssf.usermodel.HSSFWorkbook.write(HSSFWorkbook.java:1169)\n        ...\n---------------------", "id": 134969, "time": "2010-03-01T14:44:07Z", "creator": "mhilpert@gmx.de", "creation_time": "2010-03-01T14:44:07Z", "is_private": false}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "is_private": false, "text": "I'm unable to replicate this.\n\nI've added a new unit test which shows that you can create a document with no properties, add them in, save and reload, change some more, and all works fine with no errors:\n   org.apache.poi.hpsf.basic.TestHPSFBugs\n\nI'd suggest you take a look at that to see how to work with properties. If you're still having problems, please create a failing unit test and upload that", "id": 137150, "time": "2010-05-26T11:12:56Z", "bug_id": 48832, "creation_time": "2010-05-26T11:12:56Z", "attachment_id": null}]