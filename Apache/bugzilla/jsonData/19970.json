[{"count": 0, "tags": [], "bug_id": 19970, "attachment_id": null, "text": "If a JDBC datasource is used as a JNDI resource and a servlet tried to get a\nconnection via this datasource , the servlet does not get executed and it hangs.\nThere is no output on the console either.\nAttached is a war file that has the test servlet.\n\nThe url is :\n/jdbctest/DBConnServlet\n\nThese are the settings that are needed:\nserver.xml\n\nunder <GlobalNamingResources > element\n<Resource name=\"jdbc/WorkflowAppDb\" scope=\"Shareable\" type=\"javax.sql.DataSource\" />\n   <ResourceParams name=\"jdbc/WorkflowAppDb\">\n     <parameter>\n               <name>validationQuery</name>\n               <value></value>\n     </parameter>\n     <parameter>\n               <name>username</name>\n               <value>PBPUBLIC</value>\n     </parameter>\n     <parameter>\n               <name>maxWait</name>\n               <value>5000</value>\n     </parameter>\n     <parameter>\n               <name>maxActive</name>\n               <value>4</value>\n     </parameter>\n     <parameter>\n               <name>password</name>\n               <value>PBPUBLIC</value>\n     </parameter>\n     <parameter>\n               <name>url</name>\n               <value>jdbc:pointbase:server://localhost/WorkflowAppDb</value>\n     </parameter>\n     <parameter>\n               <name>driverClassName</name>\n               <value>com.pointbase.jdbc.jdbcUniversalDriver</value>\n     </parameter>\n     <parameter>\n               <name>maxIdle</name>\n               <value>2</value>\n     </parameter>\n   </ResourceParams>\n\n\n---------------------\n\nAdd this entry for context in the Host\n\n----------------------\n<Context className=\"org.apache.catalina.core.StandardContext\" cachingAllowed=\"true\"\ncharsetMapperClass=\"org.apache.catalina.util.CharsetMapper\" cookies=\"true\" crossCont\next=\"false\" debug=\"0\" displayName=\"S1WS\" docBase=\"/Test/jwsdp12/scf/webapps/jdbctest\n\" mapperClass=\"org.apache.catalina.core.StandardContextMapper\" path=\"/jdbctest\" priv\nileged=\"false\" reloadable=\"false\" useNaming=\"true\" wrapperClass=\"org.apache.catalina\n.core.StandardWrapper\" >\n\n<ResourceLink global=\"jdbc/WorkflowAppDb\" name=\"jdbc/WorkflowAppDb\" type=\"java.sql.D\nataSource\"/>\n</Context>\n\n-----------------------------\n\n\nYou would also need to create a database in the Pointbase installation\nDB Name : WorkflowAppDb\nUserName : PBPUBLIC\nPasssword: PBPUBLIC", "id": 37282, "time": "2003-05-15T20:15:36Z", "creator": "prasad.subramanian@sun.com", "creation_time": "2003-05-15T20:15:36Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 19970, "text": "Created attachment 6371\nThis is the war file that contains the test case and sources", "id": 37283, "time": "2003-05-15T20:16:49Z", "creator": "prasad.subramanian@sun.com", "creation_time": "2003-05-15T20:16:49Z", "is_private": false, "attachment_id": 6371}, {"count": 2, "tags": [], "text": "I think you are CCing those bug reports for every time there's a release ... The\nproblem is with Pointbase and DBCP, not Tomcat (I'd say the problem is with\nPointbase, though ;-) ). Please do not reopen this report.", "is_private": false, "id": 37284, "creator": "remm@apache.org", "time": "2003-05-15T20:37:46Z", "bug_id": 19970, "creation_time": "2003-05-15T20:37:46Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "amyroh@apache.org", "text": "I'll try it with MySQL and see if the problem still exists.  If then, the\nproblem is with PointBase.  :-)", "id": 37285, "time": "2003-05-15T20:48:46Z", "bug_id": 19970, "creation_time": "2003-05-15T20:48:46Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "remm@apache.org", "text": "IMO don't bother, I remember the extact same bug being filed during WSPACK 1.0\ntesting.", "id": 37286, "time": "2003-05-15T20:59:27Z", "bug_id": 19970, "creation_time": "2003-05-15T20:59:27Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "prasad.subramanian@sun.com", "is_private": false, "text": "Created attachment 6374\nNew test case\n\nHere are the URLS:\n\n/jdbctest/DBConnServlet?getConn=true - For getting the connection\n\n/jdbctest/DBConnServlet?getConn=false - For getting the datasource alone", "id": 37287, "time": "2003-05-15T20:59:42Z", "bug_id": 19970, "creation_time": "2003-05-15T20:59:42Z", "attachment_id": 6374}, {"count": 6, "tags": [], "creator": "amyroh@apache.org", "is_private": false, "text": "I have tested with MySQL and the connection hangs as well.  It returns non-null\nDataSource when we do ctx.lookup.  However, the connection doesn't go through. \nI'm thinking it's a bug in DBCP?  I've been told this used to work in TC4 though\nand we're using the same DBCP.", "id": 37291, "time": "2003-05-15T23:21:35Z", "bug_id": 19970, "creation_time": "2003-05-15T23:21:35Z", "attachment_id": null}]