[{"count": 0, "attachment_id": null, "bug_id": 50834, "is_private": false, "id": 144572, "time": "2011-02-26T05:24:00Z", "creator": "kumarachal@gmail.com", "creation_time": "2011-02-26T05:24:00Z", "tags": [], "text": "While load testing mod_proxy/worker mpm with 500 concurrent streams, we see a core dump. This is easily reproducible.\n\n1. Do 500 concurrent wgets and maintain the load. During the load, go to the content serves (apaches) and killall httpd. We see the following core dump\n\n(gdb) bt full\n#0  0x0000003ac00306f7 in kill () from /lib64/libc.so.6\nNo symbol table info available.\n#1  <signal handler called>\nNo symbol table info available.\n#2  0x00002aaca7a2db89 in apr_brigade_cleanup (data=<value optimized out>) at buckets/apr_brigade.c:44\n        b = (apr_bucket_brigade *) 0x0\n#3  0x00002aaca7c5b09d in run_cleanups (cref=0x1a99c068) at memory/unix/apr_pools.c:2308\n        c = (cleanup_t *) 0x0\n#4  0x00002aaca7c5bb0e in apr_pool_destroy (pool=0x1a99c048) at memory/unix/apr_pools.c:779\n        active = <value optimized out>\n        allocator = <value optimized out>\n#5  0x000000000046d09d in ap_process_http_connection (c=0x1a980208) at http_core.c:199\n        r = (request_rec *) 0x1a99c0c0\n        csd = (apr_socket_t *) 0x0\n#6  0x000000000043fb22 in ap_run_process_connection (c=0x1a980208) at connection.c:43\n        n = 0\n        rv = 0\n#7  0x000000000048b094 in worker_thread (thd=0x1a7066f0, dummy=<value optimized out>) at worker.c:544\n        process_slot = 8\n        thread_slot = 1\n        csd = (apr_socket_t *) 0x1a97fff0\n        bucket_alloc = (apr_bucket_alloc_t *) 0x1a981f78\n        last_ptrans = <value optimized out>\n        ptrans = (apr_pool_t *) 0x1a97ff68\n        rv = <value optimized out>\n        is_idle = <value optimized out>\n#8  0x0000003ac08064a7 in start_thread () from /lib64/libpthread.so.0\nNo symbol table info available.\n#9  0x0000003ac00d3c2d in clone () from /lib64/libc.so.6\nNo symbol table info available.\n\n\nApache has been configured with mod_proxy and worker mpm. The configuration is:\n\nServerLimit 24\nThreadLimit 64\n\n# worker MPM\n# StartServers: initial number of server processes to start\n# MaxClients: maximum number of simultaneous client connections\n# MinSpareThreads: minimum number of worker threads which are kept spare\n# MaxSpareThreads: maximum number of worker threads which are kept spare\n# ThreadsPerChild: constant number of worker threads in each server process\n# MaxRequestsPerChild: maximum number of requests a server process serves\n<IfModule mpm_worker_module>\n    StartServers         16\n    MaxClients           1536\n    MinSpareThreads      512\n    MaxSpareThreads      1024\n    ThreadsPerChild      64\n    MaxRequestsPerChild   0\n</IfModule>\n\n\nWhenev"}, {"count": 1, "tags": [], "text": "Hi guys, some more information:\n\nThis bug is not reproducible with 2.2.14 but happens easily with 2.2.15 and above 2.2.* versions.", "attachment_id": null, "id": 144811, "creator": "kumarachal@gmail.com", "time": "2011-03-07T16:48:14Z", "bug_id": 50834, "creation_time": "2011-03-07T16:48:14Z", "is_private": false}, {"count": 2, "tags": [], "text": "it seems that it is happening because of the changes made in rev 916627", "attachment_id": null, "id": 144853, "creator": "kumarachal@gmail.com", "time": "2011-03-09T06:15:02Z", "bug_id": 50834, "creation_time": "2011-03-09T06:15:02Z", "is_private": false}, {"count": 3, "attachment_id": null, "bug_id": 50834, "is_private": false, "id": 144946, "time": "2011-03-11T15:17:48Z", "creator": "kumarachal@gmail.com", "creation_time": "2011-03-11T15:17:48Z", "tags": [], "text": "Hi all,\n\n\nWe reverted the changes made in apache r827514 (http://svn.apache.org/viewvc?view=revision&revision=827514).\nThis was leading to segfaults on unexpeted origin server shutdown when all threads were busy in worker MPM. The configuration was 24 child processes each having 64 threads.\n\n\n/****\n\n* Return APR_EOF if request body is shorter than the length announced by the\n  client.\n\nPR: 33098\nSubmitted by: Stefan Fritsch <sf sfritsch.de>\n\n****/\n\nAchal"}, {"count": 4, "tags": [], "text": "test with 50335 changes if still affected; maybe this PR is a good hint for triggering 50335.\n\n*** This bug has been marked as a duplicate of bug 50335 ***", "attachment_id": null, "id": 172498, "creator": "covener@gmail.com", "time": "2014-01-19T19:28:33Z", "bug_id": 50834, "creation_time": "2014-01-19T19:28:33Z", "is_private": false}]