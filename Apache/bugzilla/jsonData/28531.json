[{"count": 0, "tags": [], "bug_id": 28531, "attachment_id": null, "id": 56231, "time": "2004-04-22T08:46:01Z", "creator": "erwin.leubaz@advancedsilicon.com", "creation_time": "2004-04-22T08:46:01Z", "is_private": false, "text": "Hello,\n\nInstall httpd-2.1.0-pre3.tar.gz on SuSE 9.0 because I need dav-lock for \nsubversion.\nBut ldap authentification don't run well.\n\nfrom http://www.apache.org/~striker/httpd-2.1.0-pre3/httpd-2.1.0-pre3.tar.gz\n\nCompilation OK with db-4.1.25 and neon-0.24.5:\n\nApr\n\n./configure --prefix=/export/subversion/test && make && make install\n\nApr-Util\n\n./configure --prefix=/export/subversion/test --with-\napr=/export/subversion/test/bin/apr-config --with-berkeley-\ndb=/export/subversion/test --with-ldap --with-expat=/usr --with-iconv=/usr --\nwith-gdbm=/usr --with-ndbm && make && make install\n\nHttpd\n\n./configure --prefix=/export/subversion/test --enable-mods-shared=all --enable-\nso --enable-dav --enable-dav-fs --enable-dav-lock --enable-ldap --enable-auth-\nldap --with-apr=/export/subversion/test/bin/apr-config --with-apr-\nutil=/export/subversion/test/bin/apu-config --with-berkeley-\ndb=/export/subversion/test --enable-file-cache --enable-mem-cache --enable-\ncache --enable-disk-cache --enable-ssl --enable-deflate && make depend && make \n&& make install\n\nhttpd.conf with : \n\n+\n\nLDAPSharedCacheSize 200000\nLDAPCacheEntries 1024\nLDAPCacheTTL 600\nLDAPOpCacheEntries 1024\nLDAPOpCacheTTL 600\n\n<Location /ldap-status>\n\nSetHandler ldap-status\nOrder deny,allow\nDeny from all\nAllow from yourdomain.example.com #modified with correct value on 2.0.48\nAuthLDAPEnabled on\nAuthLDAPURL ldap://127.0.0.1/dc=example,dc=com?uid?one #modified with correct \nvalue on 2.0.48\nAuthLDAPAuthoritative on\nrequire valid-user\n\n</Location> \n\nthe result after login prompt is a page like this:\n\nInternal Server Error\nThe server encountered an internal error or misconfiguration and was unable to \ncomplete your request.\n\nPlease contact the server administrator, you@example.com and inform them of the \ntime the error occurred, and anything you might have done that may have caused \nthe error.\n\nMore information about this error may be available in the server error log.\n\n\n--------------------------------------------------------------------------------\n\nApache/2.1.0-dev (Unix) DAV/2 Server at 10.0.0.1 Port 80\n\nand logs are :\n\n[Thu Apr 22 09:44:02 2004] [notice] LDAP: Built with OpenLDAP LDAP SDK\n[Thu Apr 22 09:44:02 2004] [notice] LDAP: SSL support available\n[Thu Apr 22 09:44:02 2004] [info] mod_unique_id: using ip addr XX.XX.XX.XX\n[Thu Apr 22 09:44:03 2004] [notice] Digest: generating secret for digest \nauthentication ...\n[Thu Apr 22 09:44:03 2004] [notice] Digest: done\n[Thu Apr 22 09:44:03 2004] [notice] LDAP: Built with OpenLDAP LDAP SDK\n[Thu Apr 22 09:44:03 2004] [notice] LDAP: SSL support available\n[Thu Apr 22 09:44:03 2004] [info] mod_unique_id: using ip addr XX.XX.XX.XX\n[Thu Apr 22 09:44:04 2004] [notice] Apache/2.1.0-dev (Unix) DAV/2 configured -- \nresuming normal operations\n[Thu Apr 22 09:44:04 2004] [info] Server built: Apr 22 2004 09:30:19\n[Thu Apr 22 09:44:04 2004] [debug] prefork.c(992): AcceptMutex: sysvsem \n(default: sysvsem)\n[Thu Apr 22 09:44:04 2004] [debug] util_ldap.c(1104): [21033] ldap cache init: \nSuccess\n[Thu Apr 22 09:44:04 2004] [debug] util_ldap.c(1104): [21037] ldap cache init: \nSuccess\n[Thu Apr 22 09:44:04 2004] [debug] util_ldap.c(1104): [21034] ldap cache init: \nSuccess\n[Thu Apr 22 09:44:04 2004] [debug] util_ldap.c(1104): [21035] ldap cache init: \nSuccess\n[Thu Apr 22 09:44:04 2004] [debug] util_ldap.c(1104): [21036] ldap cache init: \nSuccess\n[Thu Apr 22 09:44:36 2004] [debug] util_ldap.c(1104): [21043] ldap cache init: \nSuccess\n[Thu Apr 22 09:44:39 2004] [error] Internal error: pcfg_openfile() called with \nNULL filename\n[Thu Apr 22 09:44:39 2004] [error] [client 10.0.0.27] (9)Bad file descriptor: \nCould not open password file: (null)\n\nTell me if you need some others informations.\n\nHope that can help you to continue your grat job with apache.\n\nRegard's\n\nErwin"}, {"count": 1, "tags": [], "bug_id": 28531, "is_private": false, "text": "try to disable the ldap caching.\n\nIt would also be helpful to have a GDB backtrace.  For information on how to do\nthis, please see http://httpd.apache.org/dev/debugging.html\n\n-Paul Querna\n\n", "id": 56963, "time": "2004-05-06T23:47:50Z", "creator": "chip@force-elite.com", "creation_time": "2004-05-06T23:47:50Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 28531, "attachment_id": null, "id": 56988, "time": "2004-05-07T13:02:49Z", "creator": "erwin.leubaz@advancedsilicon.com", "creation_time": "2004-05-07T13:02:49Z", "is_private": false, "text": "Hello Paul,\n\nBut were disable the ldap caching !!!\n\nThanks\n\nErwin"}, {"count": 3, "tags": [], "creator": "minfrin@sharp.fm", "text": "The message \"(9)Bad file descriptor: \nCould not open password file: (null)\" is being thrown by mod_authn_file.\n\nPlease check your configuration - you've enabled mod_authn_file somewhere, which\nis causing this error.\n", "id": 57771, "time": "2004-05-21T02:00:13Z", "bug_id": 28531, "creation_time": "2004-05-21T02:00:13Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 28531, "attachment_id": null, "is_private": false, "id": 57781, "time": "2004-05-21T08:11:30Z", "creator": "erwin.leubaz@advancedsilicon.com", "creation_time": "2004-05-21T08:11:30Z", "text": "Correct, I have enabled mod_authn_file.\n\nBut if I remove it, the error become :\n\nconfiguration error:  couldn't perform authentication. AuthType not set!: /ldap-\nstatus\n\nAnd if I change the configuration like this :\n\n<Location /ldap-status>\n\nSetHandler ldap-status\nOrder deny,allow\nDeny from all\nAuthType Basic\nAuthName \"Test Ldap\"\nAllow from yourdomain.example.com #modified with correct value on 2.0.48\nAuthLDAPEnabled on\nAuthLDAPURL ldap://127.0.0.1/dc=example,dc=com?uid?one #modified with correct \nvalue on 2.0.48\nAuthLDAPAuthoritative on\nrequire valid-user\n\n</Location>\n\nI receive :\n\nNo Authn provider configured\n\nIs this always a mistake in the configuration ?\nOr could you give me a example with the minimum modules to load and a \n<Location> \nexample\n</Location>\n\nThat I reproduce a correct environement.\n\nThanks in advance.\n\nRegards\n "}, {"count": 5, "tags": [], "bug_id": 28531, "is_private": false, "id": 57825, "creation_time": "2004-05-21T15:58:11Z", "time": "2004-05-21T15:58:11Z", "creator": "minfrin@sharp.fm", "text": "The mod_auth_* modules were overhauled in v2.1 to separate them into mod_authn\nmodules and mod_authz modules, however this was not done to mod_auth_ldap.\n\nAs a result, I have a feeling mod_auth_ldap isn't playing nicely in\ncollaboration with the new mod_authn stuff. The best place to continue the\ndiscussion on this would be the dev@httpd.apache.org mailing list, as you're\nmore likely to get answers from the people who did the mod_authn overhaul.\n", "attachment_id": null}]