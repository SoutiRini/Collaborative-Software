[{"attachment_id": null, "tags": [], "creator": "sairampareek@gmail.com", "is_private": false, "count": 0, "id": 163675, "time": "2012-11-27T10:06:03Z", "bug_id": 54211, "creation_time": "2012-11-27T10:06:03Z", "text": "I have a 6.33 MB size xlsx file which i m trying to read. One file is read successfully but when I try to read multiple (4) files concurrently I m getting \"outofmemory: java heap space\".\n\nIs there any workaround for this.\n\nOPCPackage pkg = OPCPackage.open(fileNameOnDisk, PackageAccess.READ);\n//here the error is thrown\nReadOnlySharedStringsTable sst = new ReadOnlySharedStringsTable(pkg);\nXSSFReader r = new XSSFReader(pkg);\nXMLReader parser = XMLReaderFactory.createXMLReader(\"org.apache.xerces.parsers.SAXParser\");\n\n\njava.lang.OutOfMemoryError: Java heap space\n\tat java.util.Arrays.copyOfRange(Arrays.java:3209)\n\tat java.lang.String.<init>(String.java:215)\n\tat java.lang.StringBuffer.toString(StringBuffer.java:585)\n\tat org.apache.poi.xssf.eventusermodel.ReadOnlySharedStringsTable.endElement(ReadOnlySharedStringsTable.java:211)\n\tat org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)\n\tat org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanEndElement(Unknown Source)\n\tat org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown Source)\n\tat org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)\n\tat org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n\tat org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n\tat org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\n\tat org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)\n\tat org.apache.xerces.jaxp.SAXParserImpl$JAXPSAXParser.parse(Unknown Source)\n\tat org.apache.poi.xssf.eventusermodel.ReadOnlySharedStringsTable.readFrom(ReadOnlySharedStringsTable.java:143)\n\tat org.apache.poi.xssf.eventusermodel.ReadOnlySharedStringsTable.<init>(ReadOnlySharedStringsTable.java:112)"}, {"count": 1, "tags": [], "bug_id": 54211, "attachment_id": null, "text": "You need to increase your heap size, the default JVM heap is very small\n\nIf you really can't do that, you'll need to process the shared strings table differently. The code you're using buffers the shared strings table into memory for quick access when processing the slides. It's not usually too big, but it can be a noticable part of the file size. If you can't hold it all in ram, you'll need to process it in a streaming manner and store the id -> string lookup elsewhere (eg on disk, on another box in a KV store / cache) for use when handling the sheets", "id": 163677, "time": "2012-11-27T11:54:53Z", "creator": "apache@gagravarr.org", "creation_time": "2012-11-27T11:54:53Z", "is_private": false}]