[{"count": 0, "tags": [], "bug_id": 45682, "text": "HSSFWorkbook cloneSheet fails for sheets containing conditional formattings. \n\nReproduced with 3.1-FINAL-20080629 as well as with latest devel from svn (3.2-aplha1) 20080825. Seems to introduced with conditional formating changes, as sheets are cloned correctly with 3.0.2-FINAL-20080204. Stack-trace from latest SVN.\n\n\nException in thread \"main\" java.lang.RuntimeException: The class org.apache.poi.hssf.record.aggregates.CFRecordsAggregate needs to define a clone method\n\tat org.apache.poi.hssf.record.Record.clone(Record.java:135)\n\tat org.apache.poi.hssf.model.Sheet$RecordCloner.visitRecord(Sheet.java:355)\n\tat org.apache.poi.hssf.record.aggregates.ConditionalFormattingTable.visitContainedRecords(ConditionalFormattingTable.java:56)\n\tat org.apache.poi.hssf.model.Sheet.cloneSheet(Sheet.java:371)\n\tat org.apache.poi.hssf.usermodel.HSSFSheet.cloneSheet(HSSFSheet.java:127)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.cloneSheet(HSSFWorkbook.java:672)", "id": 120054, "time": "2008-08-25T00:26:41Z", "creator": "antti.koskimaki@joinex.com", "creation_time": "2008-08-25T00:26:41Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 45682, "text": "Fixed in svn r688655\n\njunit added\n", "id": 120057, "time": "2008-08-25T01:33:18Z", "creator": "josh@apache.org", "creation_time": "2008-08-25T01:33:18Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "text": "Thanks. Verified that mentioned bug got fixed. \n\nBut at the same time my POI-created conditional formats broke between r688654 and r688655. Excel says \"file error, data may have been lost\" when opening and all POI-generated conditional formats are missing. This doesn't depend on cloning.", "attachment_id": null, "bug_id": 45682, "id": 120063, "time": "2008-08-25T04:02:45Z", "creator": "antti.koskimaki@joinex.com", "creation_time": "2008-08-25T04:02:45Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 45682, "attachment_id": null, "is_private": false, "id": 120079, "time": "2008-08-25T12:01:19Z", "creator": "josh@apache.org", "creation_time": "2008-08-25T12:01:19Z", "text": "(In reply to comment #2)\n> \n> But at the same time my POI-created conditional formats broke between r688654\n> and r688655. Excel says \"file error, data may have been lost\" when opening and\n> all POI-generated conditional formats are missing.\n\nFixed in svn r688825.\n\nCFHeaderRecord wasn't being properly updated with the number of rules.  junit added to cover this logic too."}]