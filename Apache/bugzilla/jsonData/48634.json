[{"count": 0, "tags": [], "bug_id": 48634, "attachment_id": null, "text": "I'm using JPEGTranscoder in a webapp.\n\nI call the LRUCache.setsize at init of my webapp. It flushed the LRUCache.used list and set the LRUCache.maxsize variable to 0. The LRUCache.free list remains at 50 (which it initizialed by TileCache) which is in my opinion not logic.\n\nThe LRUCache.add method test the size of the LRUCache.free list to cache new item to the LRUCache.used list.\n\nThe LRUCache.used list grows up to 50. The LRUCache.setSize method is not able to flush the LRUCache.used list because there is if statement (inferior strict) on the maxsize (at 0) value against the new size (at 0).\n\nIf think a workaround would be to call LRUCache.setSized twice, the first with value > 50 and the second with 0", "id": 133986, "time": "2010-01-28T00:27:02Z", "creator": "nithril@gmail.com", "creation_time": "2010-01-28T00:27:02Z", "is_private": false}, {"count": 1, "tags": [], "creator": "helder.magalhaes@gmail.com", "attachment_id": null, "text": "(In reply to comment #0)\n> The LRUCache.used list grows up to 50. The LRUCache.setSize method is not able\n> to flush the LRUCache.used list because there is if statement (inferior strict)\n> on the maxsize (at 0) value against the new size (at 0).\n> \n> If think a workaround would be to call LRUCache.setSized twice, the first with\n> value > 50 and the second with 0\n\nCould you help checking whether this issue is still present in the current trunk code [1]?\n\nIf the issue is still present, as you seem to have enough knowledge on how to fix it, I'd invite you to attach a patch into this bug report. That would definitely help towards getting the bug fixed in the next release! :-)\n\nBTW: I have little knowledge regarding this code: Thomas [2] is probably the person which can actually provide valuable feedback on this issue. I'm trying to put things moving in the meantime, though. ;-)\n\nThanks,\n Helder\n\n[1] http://xmlgraphics.apache.org/batik/download.cgi#Subversion+repository\n[2] http://xmlgraphics.apache.org/batik/contributors.html#expertise", "id": 133994, "time": "2010-01-28T06:16:35Z", "bug_id": 48634, "creation_time": "2010-01-28T06:16:35Z", "is_private": false}, {"count": 2, "tags": [], "creator": "helder.magalhaes@gmail.com", "attachment_id": null, "text": "Just noticed this was first discussed/reported in the mailing list. The issue's URL now points at the thread. :-)", "id": 133995, "time": "2010-01-28T06:22:14Z", "bug_id": 48634, "creation_time": "2010-01-28T06:22:14Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 48634, "attachment_id": null, "is_private": false, "id": 134017, "time": "2010-01-29T04:57:18Z", "creator": "nithril@gmail.com", "creation_time": "2010-01-29T04:57:18Z", "text": "(In reply to comment #1)\n> (In reply to comment #0)\n> > The LRUCache.used list grows up to 50. The LRUCache.setSize method is not able\n> > to flush the LRUCache.used list because there is if statement (inferior strict)\n> > on the maxsize (at 0) value against the new size (at 0).\n> > \n> > If think a workaround would be to call LRUCache.setSized twice, the first with\n> > value > 50 and the second with 0\n> \n> Could you help checking whether this issue is still present in the current\n> trunk code [1]?\n> \n> If the issue is still present, as you seem to have enough knowledge on how to\n> fix it, I'd invite you to attach a patch into this bug report. That would\n> definitely help towards getting the bug fixed in the next release! :-)\n\n\nI will post a patch. Does a test cover the LRUCache class ?"}, {"count": 4, "tags": [], "bug_id": 48634, "attachment_id": null, "text": "(In reply to comment #3)\n> I will post a patch.\n\nGreat! Thanks for considering a contribution. :-)\n\n\n> Does a test cover the LRUCache class ?\n\nA quick find-in-files didn't show up anything related so I guess not. Of course if you can make up one (intuitively, to be setup in \"test-resources/org/apache/batik/ext/awt/image/rendered\") I guess that would be valuable. ;-)\n\n\nCheers,\n Helder", "id": 134021, "time": "2010-01-29T06:07:09Z", "creator": "helder.magalhaes@gmail.com", "creation_time": "2010-01-29T06:07:09Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 48634, "attachment_id": 24911, "is_private": false, "id": 134079, "time": "2010-01-31T12:56:21Z", "creator": "nithril@gmail.com", "creation_time": "2010-01-31T12:56:21Z", "text": "Created attachment 24911\nCorrect the setSize and the add methods"}, {"count": 6, "tags": [], "text": "Here is the patch. I hope the format is correct.\n\n\nThe complete regard test do not run correctly because of an exception :\nError while running test suite : Cannot build Test instance of class : . Got exception of class : java.lang.IllegalArgumentException with messages test-references/../../beSuite/rendering-orderGr-BE-01.svg and stack trace : java.lang.IllegalArgumentException: test-references/../../beSuite/rendering-orderGr-BE-01.svg\n        at org.apache.batik.test.svg.AbstractRenderingAccuracyTest.resolveURL(Un\nknown Source)", "attachment_id": null, "id": 134080, "creator": "nithril@gmail.com", "time": "2010-01-31T12:57:23Z", "bug_id": 48634, "creation_time": "2010-01-31T12:57:23Z", "is_private": false}, {"count": 7, "tags": [], "text": "Hi nithril,\n\n>           What    |Removed                     |Added\n> ----------------------------------------------------------------------------\n>             Status|NEW                         |RESOLVED\n>         Resolution|                            |FIXED\n\nWhy did you mark the issue as fixed? The path didn't get commit yet! ;-) Or am I missing something...?\n\nI was hoping Thomas could take a glance at this, because I really can't even give valuable feedback to the patch.", "attachment_id": null, "id": 134171, "creator": "helder.magalhaes@gmail.com", "time": "2010-02-03T02:09:56Z", "bug_id": 48634, "creation_time": "2010-02-03T02:09:56Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 48634, "attachment_id": null, "text": "(In reply to comment #7)\n> Hi nithril,\n> \n> >           What    |Removed                     |Added\n> > ----------------------------------------------------------------------------\n> >             Status|NEW                         |RESOLVED\n> >         Resolution|                            |FIXED\n> \n> Why did you mark the issue as fixed? The path didn't get commit yet! ;-) Or am\n> I missing something...?\n> \n> I was hoping Thomas could take a glance at this, because I really can't even\n> give valuable feedback to the patch.\n\n\n(In reply to comment #7)\n> Hi nithril,\n> \n> >           What    |Removed                     |Added\n> > ----------------------------------------------------------------------------\n> >             Status|NEW                         |RESOLVED\n> >         Resolution|                            |FIXED\n> \n> Why did you mark the issue as fixed? The path didn't get commit yet! ;-) Or am\n> I missing something...?\n> \n> I was hoping Thomas could take a glance at this, because I really can't even\n> give valuable feedback to the patch.\n\nSorry I do not know the workflow... :)\n\nI thought I need to mark it resolved and after somebody verfied the resolution and closed the issue\n\nI made a mistake, VCS need to be updated before.", "id": 134174, "time": "2010-02-03T03:56:28Z", "creator": "nithril@gmail.com", "creation_time": "2010-02-03T03:56:28Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 48634, "text": "(In reply to comment #8)\n> Sorry I do not know the workflow... :)\n> \n> I thought I need to mark it resolved and after somebody verfied the resolution\n> and closed the issue\n> \n> I made a mistake, VCS need to be updated before.\n\nExactly [1]! ;-)\n\nLet's hold for some extra feedback (possibly from Thomas) in order to proceed. :-)\n\n\n[1] https://issues.apache.org/bugzilla/page.cgi?id=fields.html#status", "id": 134177, "time": "2010-02-03T04:16:21Z", "creator": "helder.magalhaes@gmail.com", "creation_time": "2010-02-03T04:16:21Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 48634, "attachment_id": null, "is_private": false, "id": 134253, "time": "2010-02-05T02:57:57Z", "creator": "deweese@apache.org", "creation_time": "2010-02-05T02:57:57Z", "text": "(In reply to comment #5)\n> Created an attachment (id=24911) [details]\n> Correct the setSize and the add methods\n\n   Can you fix the patch so that it doesn't include changes in indention?\nThe only changes in a patch should be the real code changes.  Also can\nI suggest that you drop 'free' nodes in preference to 'used' nodes\nwhen setting the size?\n\n   I took a look at the new regard test and it looks pretty good.\n\n   Also do you have an Apache Contributors License on file?\n       http://www.apache.org/licenses/icla.txt"}, {"count": 11, "tags": [], "bug_id": 48634, "attachment_id": null, "text": "(In reply to comment #10)\n> (In reply to comment #5)\n> > Created an attachment (id=24911) [details] [details]\n> > Correct the setSize and the add methods\n> \n>    Can you fix the patch so that it doesn't include changes in indention?\n> The only changes in a patch should be the real code changes.  Also can\n> I suggest that you drop 'free' nodes in preference to 'used' nodes\n> when setting the size?\n> \n>    I took a look at the new regard test and it looks pretty good.\n> \n>    Also do you have an Apache Contributors License on file?\n>        http://www.apache.org/licenses/icla.txt\n\n\nI will fix the patch and implement your suggestion.\n\nI have send today the CLA by fax.", "id": 134386, "time": "2010-02-09T23:59:58Z", "creator": "nithril@gmail.com", "creation_time": "2010-02-09T23:59:58Z", "is_private": false}, {"count": 12, "tags": [], "bug_id": 48634, "attachment_id": 24990, "is_private": false, "id": 134524, "time": "2010-02-15T17:32:59Z", "creator": "nithril@gmail.com", "creation_time": "2010-02-15T17:32:59Z", "text": "Created attachment 24990\nPatch on LRUCache\n\nMy IDE automaticaly right trim lines. The patch contains trim modification for regard.xml with the new test.\n\nIf there is any new modifications to do, please ask me"}, {"count": 13, "tags": [], "bug_id": 48634, "attachment_id": null, "id": 134527, "time": "2010-02-15T17:59:46Z", "creator": "helder.magalhaes@gmail.com", "creation_time": "2010-02-15T17:59:46Z", "is_private": false, "text": "(In reply to comment #12)\n> My IDE automaticaly right trim lines. The patch contains trim modification for\n> regard.xml with the new test.\n\nI still noticed a few whitespace modification but they now point only towards trimmed trailing spaces, which I believe to be good. :-)\n\n\n> If there is any new modifications to do, please ask me\n\nWithout a deep idea on what's involved, I did notice a few small things:\n\n1. typo: \"inconsistant\" (should be \"inconsistent\", found in properties file and related source code. ;-)\n\n2. Whitespace issues found in \"sources/org/apache/batik/ext/awt/image/rendered/LRUCache.java\": The file seems to be using 8 spaces for indenting instead of the usual 4 spaces. This is somehow inconsistent with the framework but, IMHO, should be fixed maybe in a follow-up commit and *not* as part of this patch. :-)\n\n\nI've also fixed the bug title and bug keywords for grammar and to reflect the availability of a patch. ;-)"}, {"count": 14, "tags": [], "creator": "helder.magalhaes@gmail.com", "text": "(In reply to comment #11)\n> I have send today the CLA by fax.\n\nAlso, I just noticed \"Nicolas LABROT\" listed in the \"Unlisted CLAs\" [1] so, whenever this patch is ready... :-)\n\n\n[1] http://people.apache.org/~jim/committers.html", "id": 134528, "time": "2010-02-15T18:03:09Z", "bug_id": 48634, "creation_time": "2010-02-15T18:03:09Z", "is_private": false, "attachment_id": null}, {"count": 15, "tags": [], "bug_id": 48634, "attachment_id": null, "text": "(In reply to comment #13)\n> (In reply to comment #12)\n> > My IDE automaticaly right trim lines. The patch contains trim modification for\n> > regard.xml with the new test.\n> \n> I still noticed a few whitespace modification but they now point only towards\n> trimmed trailing spaces, which I believe to be good. :-)\n> \n> \n> > If there is any new modifications to do, please ask me\n> \n> Without a deep idea on what's involved, I did notice a few small things:\n> \n> 1. typo: \"inconsistant\" (should be \"inconsistent\", found in properties file and\n> related source code. ;-)\n> \n> 2. Whitespace issues found in\n> \"sources/org/apache/batik/ext/awt/image/rendered/LRUCache.java\": The file seems\n> to be using 8 spaces for indenting instead of the usual 4 spaces. This is\n> somehow inconsistent with the framework but, IMHO, should be fixed maybe in a\n> follow-up commit and *not* as part of this patch. :-)\n> \n\nFunny because I reconfigure my IDE to reformat the code with 8 spaces like the original file ;)\n\n\n> \n> I've also fixed the bug title and bug keywords for grammar and to reflect the\n> availability of a patch. ;-)\n\n\nThank you ;)", "id": 134530, "time": "2010-02-15T18:54:09Z", "creator": "nithril@gmail.com", "creation_time": "2010-02-15T18:54:09Z", "is_private": false}]