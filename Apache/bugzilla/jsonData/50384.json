[{"count": 0, "attachment_id": null, "bug_id": 50384, "is_private": false, "id": 142200, "time": "2010-11-30T09:46:35Z", "creator": "contact.aniket@gmail.com", "creation_time": "2010-11-30T09:46:35Z", "tags": [], "text": "Code : \ncell.setCellFormula(formulaValue);\ncell.setCellType(Cell.CELL_TYPE_FORMULA);\n\nformualValues not working :\n=+(SUBTOTAL(109,(INDIRECT(ADDRESS(ROW()+2,COLUMN())):INDIRECT(ADDRESS(ROW()+1000,COLUMN())))))\n\n=IF(ISBLANK('Export Data'!B3),\"\",IF(LEFT('Export Data'!B3,3)=\"%%%\",\"\",VALUE(TRIM(CLEAN('Export Data'!B3)))))"}, {"count": 1, "tags": [], "text": "Are you remembering to re-calculate the formula values after changing the formula?\nhttp://poi.apache.org/spreadsheet/eval.html", "attachment_id": null, "bug_id": 50384, "id": 142202, "time": "2010-11-30T09:54:58Z", "creator": "apache@gagravarr.org", "creation_time": "2010-11-30T09:54:58Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 50384, "attachment_id": null, "id": 142203, "time": "2010-11-30T10:32:26Z", "creator": "yegor@dinom.ru", "creation_time": "2010-11-30T10:32:26Z", "is_private": false, "text": "Please post the full code to reproduce the problem, ideally a junit test case. If your code requires a template then attach it too. \n\nYegor"}, {"count": 3, "tags": [], "creator": "contact.aniket@gmail.com", "attachment_id": null, "is_private": false, "id": 142235, "time": "2010-12-01T01:41:30Z", "bug_id": 50384, "creation_time": "2010-12-01T01:41:30Z", "text": "Thanks all for your kind reply. :)\nI tried to use FormulaEvaluator.evaluateInCell(Cell cell);\nBut it throws Not Implemented Yet exception.\n\nStack trace :\norg.apache.poi.ss.formula.eval.NotImplementedException: Error evaluating cell 'Pivot Data'!B2\nat org.apache.poi.ss.formula.WorkbookEvaluator.addExceptionInfo(WorkbookEvaluator.java:321)\nat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateAny(WorkbookEvaluator.java:288)\nat org.apache.poi.ss.formula.WorkbookEvaluator.evaluate(WorkbookEvaluator.java:221)\nat org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluateFormulaCellValue(HSSFFormulaEvaluator.java:320)\nat org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluateInCell(HSSFFormulaEvaluator.java:240)\nat org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluateInCell(HSSFFormulaEvaluator.java:46)\n\n\nBut when I click on the cell on the excel file and press enter formula gets evaluated. And for other simpler formulas I am not evaluating so excel does it itself but in case of the above mentioned formulas it is giving #VALUE! error on the excel file.\n\n@Yegor : Our code is simple we do not do any manipulation with the formulas. We save the formulas and it's coordinate and later just populate them on the excel sheet :\n\n for (ExcelCoordinate formulaCoordinate : formulaCoordinates) {\n      try {\n        Sheet sheet = workbook.getSheetAt(formulaCoordinate.getSheet());\n        if(sheet == null) {\n          continue;\n        }\n        if(sheet.getSheetName().equals(\"Pivot Data\") && !isCloned) {\n          workbook.cloneSheet(formulaCoordinate.getSheet());\n          isCloned = true;\n        }\n        Row row = sheet.getRow(formulaCoordinate.getRow());\n        if(row == null) {\n          continue;\n        }\n        Cell cell = ExportUtil.getCell(row, formulaCoordinate.getColumn());\n        if(cell == null) {\n          continue;\n        }\n        cell.setCellFormula(formulaCoordinate.getName());\n        cell.setCellType(Cell.CELL_TYPE_FORMULA);\n        //Cell evalutedCell = evaluator.evaluateInCell(cell);        \t\n      }\n\nAlso if possible help me out with how can I stop this #VALUE! error and let Excel do it's calcualtion.\n\nPlease Help!!!"}, {"count": 4, "tags": [], "creator": "contact.aniket@gmail.com", "attachment_id": null, "is_private": false, "id": 142287, "time": "2010-12-02T01:23:54Z", "bug_id": 50384, "creation_time": "2010-12-02T01:23:54Z", "text": "Really Sorry!!!For being so impatient. Can someone just confirm that if it is a bug then in which release this will be resolved. Also it will be great help if there can be some workaround for now?\n-- \nThanks,\nAniket"}, {"count": 5, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "is_private": false, "id": 142295, "time": "2010-12-02T06:47:32Z", "bug_id": 50384, "creation_time": "2010-12-02T06:47:32Z", "text": "Are you able to create a simple test for this? Ideally this would be a standalone unit test that creates a sheet, populates it with the formula, tries and fails to evaluate the formula. Failing that, an excel file with only a few cells populated, one of which holds the formula that you can't get evaluated?\n\nEvaluation ought to work for most standard formula expressions, if there's a bug then we'll need more details to identify why + fix."}, {"count": 6, "tags": [], "bug_id": 50384, "is_private": false, "id": 143456, "creation_time": "2011-01-19T00:35:09Z", "time": "2011-01-19T00:35:09Z", "creator": "contact.aniket@gmail.com", "text": "I have introduced two new excel function that were not implemented yet in POI. The functions are CLEAN and ADDRESS. I have submitted a Zip file that contains all the new files as well as the changed files. Kindly do the review so that I can check-in the files.\n\nThanks,\nAniket", "attachment_id": null}, {"count": 7, "attachment_id": null, "creator": "yegor@dinom.ru", "is_private": false, "id": 143468, "time": "2011-01-19T07:32:08Z", "bug_id": 50384, "creation_time": "2011-01-19T07:32:08Z", "tags": [], "text": "Support for CLEAN and ADDRESS was committed in r1060788\n\nYegor\n\n*** This bug has been marked as a duplicate of bug 50607 ***"}]