[{"count": 0, "tags": [], "text": "I got the following stacktrace when I used Tika in a DOCX->TXT conversion:\n\nCaused by: org.apache.tika.exception.TikaException: Unexpected RuntimeException from org.apache.tika.parser.microsoft.OfficeParser@3507568d\n\tat org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:282)\n\tat org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)\n\t... 16 more\nCaused by: java.lang.NullPointerException\n\tat org.apache.poi.hwpf.usermodel.Picture.getRawContent(Picture.java:422)\n\tat org.apache.poi.hwpf.usermodel.Picture.fillImageContent(Picture.java:131)\n\tat org.apache.poi.hwpf.usermodel.Picture.getContent(Picture.java:286)\n\tat org.apache.tika.parser.microsoft.WordExtractor.handlePictureCharacterRun(WordExtractor.java:609)\n\tat org.apache.tika.parser.microsoft.WordExtractor.handleSpecialCharacterRuns(WordExtractor.java:517)\n\tat org.apache.tika.parser.microsoft.WordExtractor.handleParagraph(WordExtractor.java:346)\n\tat org.apache.tika.parser.microsoft.WordExtractor.handleParagraph(WordExtractor.java:273)\n\tat org.apache.tika.parser.microsoft.WordExtractor.parse(WordExtractor.java:179)\n\tat org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:169)\n\tat org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:130)\n\tat org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)\n\t... 22 more", "attachment_id": null, "id": 195509, "creator": "jspinsanti@gmail.com", "time": "2016-12-15T19:26:06Z", "bug_id": 60484, "creation_time": "2016-12-15T19:26:06Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 60484, "attachment_id": null, "id": 195793, "time": "2017-01-02T19:40:13Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2017-01-02T19:40:13Z", "is_private": false, "text": "Can you provide a sample-file so we can reproduce the error and ensure it stays fixed via a unit-test?"}, {"count": 2, "tags": [], "creator": "jspinsanti@gmail.com", "attachment_id": 34575, "id": 195794, "time": "2017-01-02T19:51:54Z", "bug_id": 60484, "creation_time": "2017-01-02T19:51:54Z", "is_private": false, "text": "Created attachment 34575\nNPE to reproduce the bug"}, {"count": 3, "tags": [], "creator": "onealj@apache.org", "attachment_id": null, "id": 195811, "time": "2017-01-03T04:39:08Z", "bug_id": 60484, "creation_time": "2017-01-03T04:39:08Z", "is_private": false, "text": "Thanks for attaching a problematic document.\n\nI was able to reproduce the NPE with your attachment by adding the doc file to test-data/document and using TestWordToConverterSuite.java.\nSince this is just an NPE and it looks like the submitted file may have some personal information in it, I don't think we need to include this file in our unit test corpus.\n\n> Testcase: testHtml[88: /home/onealj/Downloads/poi/trunk/test-data/document/../document/60484.doc] took 0.063 sec\n>         Caused an ERROR\n> null\n> java.lang.NullPointerException\n>   at org.apache.poi.hwpf.usermodel.Picture.getRawContent(Picture.java:424)\n>   at org.apache.poi.hwpf.usermodel.Picture.fillImageContent(Picture.java:133)\n>   at org.apache.poi.hwpf.usermodel.Picture.<init>(Picture.java:124)\n>   at org.apache.poi.hwpf.model.PicturesTable.extractPicture(PicturesTable.java:162)\n>   at org.apache.poi.hwpf.converter.AbstractWordConverter.processCharacters(AbstractWordConverter.java:489)\n>   at org.apache.poi.hwpf.converter.AbstractWordConverter.processField(AbstractWordConverter.java:906)\n>   at org.apache.poi.hwpf.converter.AbstractWordConverter.processCharacters(AbstractWordConverter.java:430)\n>   at org.apache.poi.hwpf.converter.WordToHtmlConverter.processParagraph(WordToHtmlConverter.java:576)\n>   at org.apache.poi.hwpf.converter.AbstractWordConverter.processParagraphes(AbstractWordConverter.java:1113)\n>   at org.apache.poi.hwpf.converter.WordToHtmlConverter.processTable(WordToHtmlConverter.java:683)\n>   at org.apache.poi.hwpf.converter.AbstractWordConverter.processParagraphes(AbstractWordConverter.java:1075)\n>   at org.apache.poi.hwpf.converter.WordToHtmlConverter.processSingleSection(WordToHtmlConverter.java:608)\n>   at org.apache.poi.hwpf.converter.AbstractWordConverter.processDocument(AbstractWordConverter.java:721)\n>   at org.apache.poi.hwpf.converter.TestWordToConverterSuite.testHtml(TestWordToConverterSuite.java:112)\n\nsame error for testText and testFO.\n\nNPE caused by getBlipRecord returning null. [1]\n> ( (EscherBSERecord) escherRecord ).getBlipRecord().getPicturedata();\n\nI changed this in r1777063 to return byte[0] if getBlipRecord() returns null.\n\n[1] https://svn.apache.org/viewvc/poi/trunk/src/scratchpad/src/org/apache/poi/hwpf/usermodel/Picture.java?revision=1751007&view=markup#l402"}]