[{"count": 0, "tags": [], "bug_id": 22533, "is_private": false, "text": "The following bug reports are associated with Security Manager issues:\n\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=6323 and\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=11459\n\nI have written an patch / contribution to add permission handling to the code\nrun inside the Java and JUnit tasks via a common permissions type.\n\nThe reason no specific permission task has been made with in there nested the\nJUnit or Java task is that the tasks may need permissions that the code run by\nthese tasks may not have.\n\nManual testing has been performed under JDK 1.4.2 and automated test cases have\nbeen added.\n\nThe build of dist-lite and test is verified to succeed under JDK 1.4.2\nThe new and modified test cases have been verified to succeed under JDK 1.2.2.\n(Lots of Failures/Errors there in base!)", "id": 42947, "time": "2003-08-18T21:36:55Z", "creator": "jkf@apache.org", "creation_time": "2003-08-18T21:36:55Z", "attachment_id": null}, {"attachment_id": 7881, "tags": [], "creator": "jkf@apache.org", "is_private": false, "count": 1, "id": 42948, "time": "2003-08-18T21:38:08Z", "bug_id": 22533, "creation_time": "2003-08-18T21:38:08Z", "text": "Created attachment 7881\nPatch to introduce the permissions type and its use from Java and JUnit"}, {"count": 2, "tags": [], "bug_id": 22533, "is_private": false, "text": "The attachment 08/18/03 21:38 is a tar.gz file created with ant -file patch.xml", "id": 42949, "time": "2003-08-18T21:50:05Z", "creator": "jkf@apache.org", "creation_time": "2003-08-18T21:50:05Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 22533, "text": "Sweet. One question: is there an easy way to use this to turn failonerror\nhandling on in nonforked mode? Do you have to revoke the exit right?", "id": 42954, "time": "2003-08-18T22:49:53Z", "creator": "stevel@apache.org", "creation_time": "2003-08-18T22:49:53Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 22533, "text": "Well, the default permissions granted do not include the exitVM one,\n(The default granted ones are the same as those granted in the standard\ndistribution of jdk 1.4)\nso a plain nested <permissions/> would do as can be seen in the JavaTest.\nIf i.e. files are manipulated in the code subject to permissions one would need\nto  grant that permission.\nAnd if one wishes the ant build to stop at an Ssytem.exit() one would need:\nto <grant class=\"java.lang.RuntimePermission\" name=\"exitVM\"/> \nor leave out <permissions/> entirely.\nTo permit everyting except for exitVM:\n<permissions>\n    <grant  class=\"java.security.AllPermission\"/>\n    <revoke class==\"java.lang.RuntimePermission\" name=\"exitVM\"/>\n</permissions>\n\n", "id": 42964, "time": "2003-08-19T06:19:47Z", "creator": "jkf@apache.org", "creation_time": "2003-08-19T06:19:47Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "antoine@apache.org", "attachment_id": null, "is_private": false, "id": 43377, "time": "2003-08-27T14:28:29Z", "bug_id": 22533, "creation_time": "2003-08-27T14:28:29Z", "text": "Patch committed without changes, thanks Martijn.\n\n\nAntoine"}, {"count": 6, "tags": [], "bug_id": 22533, "text": "Created attachment 7972\nset permissions when failonerror=true and fork=false (request of Steve Loughran)", "id": 43398, "time": "2003-08-27T19:37:36Z", "creator": "antoine@apache.org", "creation_time": "2003-08-27T19:37:36Z", "is_private": false, "attachment_id": 7972}, {"count": 7, "text": "I have prepared the code to set permissions if failonerror=\"true\" and fork=\"false\".\nI will commit it tomorrow afternoon unless there are comments.", "creator": "antoine@apache.org", "is_private": false, "id": 43399, "time": "2003-08-27T19:38:56Z", "bug_id": 22533, "creation_time": "2003-08-27T19:38:56Z", "tags": [], "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 22533, "text": "Code changes committed to set permissions appropriate to fail the builds when\nfailonerror=\"true\", no permissions have been explicitly given, and a java\ninvocation exits with a failing status.", "id": 43428, "time": "2003-08-28T13:53:09Z", "creator": "antoine@apache.org", "creation_time": "2003-08-28T13:53:09Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 22533, "text": "There have been problems with the attempt to set special permissions to capture\nexit attempts as BuildException in the java task when failonerror=\"true\".", "count": 9, "id": 43471, "time": "2003-08-29T14:54:44Z", "creator": "antoine@apache.org", "creation_time": "2003-08-29T14:54:44Z", "is_private": false}, {"count": 10, "tags": [], "bug_id": 22533, "text": "Hi,\n\nWhat are the problems?\n\n(quote:\nThere have been problems with the attempt to set special permissions to capture\nexit attempts as BuildException in the java task when failonerror=\"true\".\n)\n\nFurthermore it seems funny to me to do something special in case failonerror is\nspecified as being true, but to do nothing in case failonerror is specified as\nbeing false.\n\nIf adding it silently I would grant java.security.AllPermission and only revoke\nthe java.lang.RuntimePermission exitVM one. The user is unaware that permissions\nare used and would probably assume everything is allowed.", "id": 43500, "time": "2003-08-30T21:19:16Z", "creator": "jkf@apache.org", "creation_time": "2003-08-30T21:19:16Z", "is_private": false, "attachment_id": null}, {"count": 11, "tags": [], "bug_id": 22533, "is_private": false, "text": "Created attachment 8019\nfix for Java task and Permissions", "id": 43544, "time": "2003-09-01T10:05:03Z", "creator": "antoine@apache.org", "creation_time": "2003-09-01T10:05:03Z", "attachment_id": 8019}, {"attachment_id": null, "tags": [], "bug_id": 22533, "text": "Symptom of the problem : gump build failing in bootstrap-ojb, where there is an\ninvocation of the java task with FailOnError=\"true\"\nThe problem was due to missing permission read for system property\nfile.encoding, then to missing permissions for file system operations.\n\nWhy do nothing special about permissions in the Java task when failonerror =\nfalse ? there is no need to do anything.\n\nWhy do something special about permissions when failonerror = \"true\" : so that\nnon zero exit statuses generate an exception which can be caught in the Java\ntask and so that the build can be failed (rather than terminated).\n", "count": 12, "id": 43545, "time": "2003-09-01T10:09:15Z", "creator": "antoine@apache.org", "creation_time": "2003-09-01T10:09:15Z", "is_private": false}]