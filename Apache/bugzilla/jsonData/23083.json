[{"count": 0, "tags": [], "creator": "wseguin@bigfoot.com", "text": "Rich Text is currently being stripped out, until it is fully supported. As \nsuch, the trailing formatting runs (immediately after the string chars) are \nskipped over to get to the start of the next string.\n\nHowever, when the formatting run is separated, either completely or partially \nfrom is preceding string characters, by being flowed over into a Continue \nrecord, the code will behave unpredictable. This is because the code expects a \nContinue record following a SST record to begin with a string, either a \ncontinuation of an unfinished string from the prior record, or a new string \nentirely. It does not handle the situation where the record starts with \nformatting run (and likely Extended chars would cause same prob).\n\nThe earliest release problem found is 1.5.1 (I didn't look any further back. \n2.0-pre3 also still has problem since SSTDeserializer virtually hasn't changed \nat all.", "id": 43989, "time": "2003-09-10T20:31:51Z", "bug_id": 23083, "creation_time": "2003-09-10T20:31:51Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 23083, "attachment_id": 8164, "is_private": false, "id": 44059, "time": "2003-09-11T19:04:32Z", "creator": "wseguin@bigfoot.com", "creation_time": "2003-09-11T19:04:32Z", "text": "Created attachment 8164\nTestcase: Excel file 1. Control case. Works."}, {"count": 2, "tags": [], "bug_id": 23083, "attachment_id": 8165, "text": "Created attachment 8165\nTestcase: Excel file 2. File fails on open (all formatting runs are in Continue record)", "id": 44060, "time": "2003-09-11T19:05:49Z", "creator": "wseguin@bigfoot.com", "creation_time": "2003-09-11T19:05:49Z", "is_private": false}, {"count": 3, "tags": [], "creator": "wseguin@bigfoot.com", "attachment_id": 8166, "id": 44061, "creation_time": "2003-09-11T19:07:27Z", "time": "2003-09-11T19:07:27Z", "bug_id": 23083, "text": "Created attachment 8166\nTestcase: Excel file 3. File fails to open. Some formatting run data in Continue record.", "is_private": false}, {"count": 4, "tags": [], "bug_id": 23083, "attachment_id": null, "text": "This is quite helpful.. just wanted some more details for the record\n\n1. These xls files are created using which version of excel. \n2. What are you trying to do in POI... ie, does it fail just on new\nHSSFWorkbook(..) ?\n\nThanks again", "id": 44062, "time": "2003-09-11T19:17:17Z", "creator": "avik@apache.org", "creation_time": "2003-09-11T19:17:17Z", "is_private": false}, {"count": 5, "attachment_id": null, "bug_id": 23083, "text": "Sure. Excel 2000 (9.0.3821 SR-1).\n\nTo observe problem, simple create a POIFSFileSystem from a stream from the \nExcel file and build a workbook with it. The error occurs when reading the \nrecords.\n\n\tPOIFSFileSystem fs = new POIFSFileSystem(stream);\n\tHSSFWorkbook workBook = new HSSFWorkbook(fs);\n\nThe first Excel file will work file (control case). The second doesn't error, \nbut if you look at the list of strings, you'll be missing the last one. The \nthird Excel file will throw a NegativeArraySizeException.", "id": 44064, "time": "2003-09-11T19:27:55Z", "creator": "wseguin@bigfoot.com", "creation_time": "2003-09-11T19:27:55Z", "tags": [], "is_private": false}, {"id": 44065, "tags": [], "creator": "poi-support@buni.org", "is_private": false, "count": 6, "text": "This bug has been on the todo list for about 2 years now.  Blame me for it.  I've never gotten a \ncustomer to fund the work and its not much but SuperLink will pay a $100 (US - you pay any \nbanking/shipping/transfer fees/paypal preferred) reward to the squasher of this bug/lack-of-\nfeature.  - Andy", "time": "2003-09-11T19:39:48Z", "bug_id": 23083, "creation_time": "2003-09-11T19:39:48Z", "attachment_id": null}, {"count": 7, "attachment_id": 8168, "bug_id": 23083, "text": "Created attachment 8168\nThis fixes the problem.Basically, it detects when the character part of the string is complete, and stores off the bytes to skip in the next Continue block to get to the start of the next string.", "id": 44066, "time": "2003-09-11T19:48:45Z", "creator": "wseguin@bigfoot.com", "creation_time": "2003-09-11T19:48:45Z", "tags": [], "is_private": false}, {"id": 44075, "tags": [], "creator": "poi-support@buni.org", "is_private": false, "count": 8, "text": "someone wrote to ask me whether I meant not crash or actually support RTF.  I meant actually \nsupport.  Consolation prize to whomever makes it not crash: $25.", "time": "2003-09-11T23:10:10Z", "bug_id": 23083, "creation_time": "2003-09-11T23:10:10Z", "attachment_id": null}, {"count": 9, "attachment_id": 8222, "bug_id": 23083, "is_private": false, "id": 44192, "time": "2003-09-15T00:40:13Z", "creator": "wseguin@bigfoot.com", "creation_time": "2003-09-15T00:40:13Z", "tags": [], "text": "Created attachment 8222\n[PATCH] Sorry, it just occurred to me that I hadn't put in the \"magic word\" with the fix. Here's a patch that addresses the crashing."}, {"count": 10, "tags": [], "bug_id": 23083, "attachment_id": null, "text": "Hey Andy,\n\nStill willing to fork out $100 for this! Sounds like a challenge. So far i can\ndecode a rich string...now to write it out again....\n\nJason\n\n", "id": 77819, "time": "2005-07-29T05:20:11Z", "creator": "jheight@apache.org", "creation_time": "2005-07-29T05:20:11Z", "is_private": false}, {"count": 11, "tags": [], "creator": "poi-support@buni.org", "text": "You get this working (read/write) -- you betcha.\n\n-andy", "id": 77829, "time": "2005-07-29T15:31:48Z", "bug_id": 23083, "creation_time": "2005-07-29T15:31:48Z", "is_private": false, "attachment_id": null}, {"count": 12, "tags": [], "creator": "jheight@apache.org", "text": "HEAD now supports rich text. Read and Write. Doesnt suport Extended text bytes,\nbut i have no idea what there are, and i havent got a spreadsheet file that\nuises them.\n\nPatches not applied cause they were just workarrounds.\n\nIm going to close this bug. Look forward to the prize!\n\nJason", "id": 78786, "time": "2005-08-22T05:41:53Z", "bug_id": 23083, "creation_time": "2005-08-22T05:41:53Z", "is_private": false, "attachment_id": null}]