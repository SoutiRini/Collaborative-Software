[{"count": 0, "tags": [], "bug_id": 40764, "attachment_id": null, "id": 94844, "time": "2006-10-16T06:23:09Z", "creator": "margol@beamartyr.net", "creation_time": "2006-10-16T06:23:09Z", "is_private": false, "text": "When making calls to apr_get_env on win32 platforms, if the given environment\nvariable exists, but has a zero-length value, the apr_get_env call should return\nAPR_SUCCESS with either an empty-string value or NULL.  APR_ENOENT should only\nbe returned if the requested environment variable does not exist in the\nenvironment.  Enclosed (will attach it to this bug) is a patch which fixes this\nbehavior."}, {"count": 1, "tags": [], "text": "Created attachment 19006\npatch to fix bug as described in report", "attachment_id": 19006, "bug_id": 40764, "id": 94845, "time": "2006-10-16T06:24:49Z", "creator": "margol@beamartyr.net", "creation_time": "2006-10-16T06:24:49Z", "is_private": false}, {"count": 2, "tags": [], "text": "Created attachment 19012\nupdated patch to fix bug as described in report\n\nGetEnvironmentVariableW/A doesn't set the LastError to 0 on success. \nTherefore, in some cases [example, requesting an existing variable immediately\nfollowing a request to a non-existant variable] we would incorrectly return\nENOENT following a successful call to GetEnvironmentVariable.  This updated\npatch explicitly resets the LastError value to 0 before calling\nGetEnvironmentVariable to avoid this issue.", "attachment_id": 19012, "id": 94885, "creator": "margol@beamartyr.net", "time": "2006-10-17T05:40:47Z", "bug_id": 40764, "creation_time": "2006-10-17T05:40:47Z", "is_private": false}, {"count": 3, "tags": [], "text": "Created attachment 19014\ntestcase for this bug", "attachment_id": 19014, "id": 94888, "creator": "margol@beamartyr.net", "time": "2006-10-17T06:54:11Z", "bug_id": 40764, "creation_time": "2006-10-17T06:54:11Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 40764, "attachment_id": null, "id": 95480, "time": "2006-11-06T07:29:42Z", "creator": "wrowe@apache.org", "creation_time": "2006-11-06T07:29:42Z", "is_private": false, "text": "You realize zero in this case means the the MS API isn't correctly\nrequisitioning the space for a trailing NULL on the empty string?\n\nI was going to ask if we can avoid the test for NULL and special\ncasing it, but apparently we would have to add the cycles to increment\nthe returned size by 1 (with or without a test) so the special case\nlooks as optimial as we can hope for.\n\nDid you have a chance to look at the unix behavior on any variety\nof unix platforms to see if there is at least a conformant subset?\nAt least the test will let users verify proper behavior, thank you \nfor that addition as well.\n"}, {"count": 5, "tags": [], "creator": "wrowe@apache.org", "attachment_id": null, "id": 95495, "time": "2006-11-06T13:07:25Z", "bug_id": 40764, "creation_time": "2006-11-06T13:07:25Z", "is_private": false, "text": "Applied in commit 471877 for apr 1.3.0/1.2.8/0.9.13, thank you for the patch.\n\nHad to massage your test case because TEST CASES MUST BE PLATFORM NEUTRAL :)"}, {"count": 6, "tags": [], "creator": "margol@beamartyr.net", "is_private": false, "text": "I don't have many UNIX boxes to play with it on...  I frankly don't even have\nmany different flavors of linux that I use these days (Debian, Ubuntu and\nMorphix - but that's all really just debian with different names). \n\nRegarding the test, I'm looking at the changes you made, and trying to figure\nout the reasoning (mainly so I can \"do it right the first time\" next time); I\nsee you separated the check for get/set from the check for del. I don't\nunderstand why that makes it more platform neutral than checking for all of them\ntogether.  I saw it as one subtest to check everything.  We've already\nascertained that get and/or set work as they should in previous tests; what are\nwe accomplishing by separating the checks?\n\nThanks for the feedback!", "id": 95567, "time": "2006-11-08T06:30:35Z", "bug_id": 40764, "creation_time": "2006-11-08T06:30:35Z", "attachment_id": null}, {"count": 7, "tags": [], "text": "Platform neutrality was primarilly in the 'name' of the test.  Although\nthe error was flagged on win32, we are really testing that emptyenv works\non any platform, not win32 specifically.\n\nThat subset get/set could be invoked, so we did, and drop out before\nwe get to 'delete'.  We hadn't ascertained that empty strings could be\nset, before.  Now we do.    Your test goes on to exercise things in \ninteresting ways which are useful, which is goodness, but unless you\npatch setenv to test for empty values, we don't want to lose an opportunity\nto test this scenario.\n\nIn any case - thank you again for your submission and marking this done :)\n", "attachment_id": null, "id": 95671, "creation_time": "2006-11-10T11:58:30Z", "time": "2006-11-10T11:58:30Z", "creator": "wrowe@apache.org", "bug_id": 40764, "is_private": false}]