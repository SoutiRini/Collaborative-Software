[{"count": 0, "tags": [], "bug_id": 44929, "attachment_id": null, "text": "The attached excel sheet will fail in release 3.0.2 final but worked well in 2.5.1 final.\n\nThe work around is to create a new spread sheet, and copy data from the existing spread sheet to the new one. Then the new one will not trigger the following exception.\n\n\norg.apache.poi.hpsf.IllegalPropertySetDataException: The property set claims to have a size of 16 bytes. However, it exceeds 16 bytes.\n        at org.apache.poi.hpsf.Section.<init>(Section.java:255)\n        at org.apache.poi.hpsf.PropertySet.init(PropertySet.java:454)\n        at org.apache.poi.hpsf.PropertySet.<init>(PropertySet.java:249)\n        at org.apache.poi.hpsf.PropertySetFactory.create(PropertySetFactory.java:61)\n        at org.apache.poi.POIDocument.getPropertySet(POIDocument.java:97)\n        at org.apache.poi.POIDocument.readProperties(POIDocument.java:74)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:171)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:259)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:240)\n        at com.lucidera.als.olap.xlloader.AlsXLOlapLoader.getWorkbook(AlsXLOlapLoader.java:209)\n        at com.lucidera.als.olap.xlloader.AlsXLOlapLoader.execute(AlsXLOlapLoader.java:121)\n        at com.lucidera.als.impl.AlsSessionImpl.executeActionOn(AlsSessionImpl.java:839)\n        at com.lucidera.als.impl.AlsSessionImpl.executeActionOn(AlsSessionImpl.java:818)\n        at com.lucidera.als.impl.AlsSessionImpl.importOlapObjectsFromXLS(AlsSessionImpl.java:557)\n        at com.lucidera.webservices.impl.design.DesignServicesBaseAPIImpl.importOLAPDefinition(DesignServicesBaseAPIImpl.java:561)\n        at com.lucidera.webservices.impl.design.DesignServicesBaseAPIImpl.importObjects(DesignServicesBaseAPIImpl.java:467)\n        at com.lucidera.webservices.impl.design.DesignServicesBaseAPIImpl.importObject(DesignServicesBaseAPIImpl.java:426)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:585)\n        at org.jboss.wsf.container.jboss40.DefaultInvocationHandler.invoke(DefaultInvocationHandler.java:101)\n        at org.jboss.ws.core.server.ServiceEndpointInvoker.invoke(ServiceEndpointInvoker.java:220)\n        at org.jboss.wsf.stack.jbws.RequestHandlerImpl.processRequest(RequestHandlerImpl.java:414)\n        at org.jboss.wsf.stack.jbws.RequestHandlerImpl.handleRequest(RequestHandlerImpl.java:273)\n        at org.jboss.wsf.stack.jbws.RequestHandlerImpl.doPost(RequestHandlerImpl.java:190)\n        at org.jboss.wsf.stack.jbws.RequestHandlerImpl.handleHttpRequest(RequestHandlerImpl.java:123)\n        at org.jboss.wsf.stack.jbws.EndpointServlet.service(EndpointServlet.java:84)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:810)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at org.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter(ReplyHeaderFilter.java:96)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:202)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)\n        at org.jboss.web.tomcat.security.SecurityAssociationValve.invoke(SecurityAssociationValve.java:175)\n        at org.jboss.web.tomcat.security.JaccContextValve.invoke(JaccContextValve.java:74)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\n        at org.apache.catalina.valves.FastCommonAccessLogValve.invoke(FastCommonAccessLogValve.java:495)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)\n        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:869)\n        at org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:664)\n        at org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)\n        at org.apache.tomcat.util.net.MasterSlaveWorkerThread.run(MasterSlaveWorkerThread.java:112)\n        at java.lang.Thread.run(Thread.java:595)", "id": 116187, "time": "2008-05-02T19:21:38Z", "creator": "etam@lucidera.com", "creation_time": "2008-05-02T19:21:38Z", "is_private": false}, {"count": 1, "attachment_id": 21909, "creator": "etam@lucidera.com", "text": "Created attachment 21909\nThe input file which will cause exception", "id": 116188, "time": "2008-05-02T19:22:36Z", "bug_id": 44929, "creation_time": "2008-05-02T19:22:36Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "klute@apache.org", "text": "As the exception's message clearly states, the error is in your file, not in the HPSF component.", "id": 116192, "time": "2008-05-02T22:10:24Z", "bug_id": 44929, "creation_time": "2008-05-02T22:10:24Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 44929, "text": "The same file works in release 2.5.1, and it is a legitimate Excel file.\n\nWe receive the exception after we migrated to 3.0.2.\n\nRe-open the bug so that there is more information. I believer there are other people having this problem.", "id": 116193, "time": "2008-05-02T23:29:58Z", "creator": "etam@lucidera.com", "creation_time": "2008-05-02T23:29:58Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 44929, "text": "Well, propably not quite so legitimate, because, as the exception\nmessage reveals, the property set size is not correct.\nIt means that HPSF added one more consistency check when reading\nproperty set streams.\n\nIf you care just about the document contents and not about the\nproperties, it should be possible to just ignore the exception.\n\n", "id": 116203, "time": "2008-05-03T09:04:38Z", "creator": "etam@lucidera.com", "creation_time": "2008-05-03T09:04:38Z", "is_private": false, "attachment_id": null}, {"count": 5, "attachment_id": null, "creator": "josh@apache.org", "text": "(In reply to comment #1)\n> The input file which will cause exception\n\nI tried attachment (id=21909) with various versions of POI (2.5.1, 3.0.2, 3.1-beta1, svn trunk) and found that it works on none.  The main problem is that it does not have a 'Workbook' directory entry, but instead has 'Book'.  As far as I can tell that makes it BIFF5 format, which POI does not support.\n\nIn POI 3.0.2 the error looks different (IllegalPropertySetDataException) because of the call to readProperties() from HSSFWorkbook.<init>(HSSFWorkbook.java:171).  This call was added after 2.5.1 but removed before 3.1-beta1.  I am not sure of the details but that change was made in bug 44491 (svn r633118).\n\nTo help a little with this bug, I made a change to HSSFWorkbook to give a clearer error message when attempting to read a prior BIFF version. This was applied in svn r653117.\n", "id": 116210, "time": "2008-05-03T12:59:38Z", "bug_id": 44929, "creation_time": "2008-05-03T12:59:38Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "bug_id": 44929, "attachment_id": 21916, "text": "Created attachment 21916\nStack traces for this bug on various recent POI versions\n\nNote - the failure on v2.5.1 is very similar to that of 3.1-beta1.", "id": 116211, "time": "2008-05-03T13:01:23Z", "creator": "josh@apache.org", "creation_time": "2008-05-03T13:01:23Z", "is_private": false}]