[{"count": 0, "text": "There was a discussion on dev@poi.apache.org about how to use formula evaluation, and I realized we're a little sparse on unit tests.\n\nI wrote a few unit tests and discovered that POI's formula evaluation of A1=1 when A1's value is TRUE (boolean cell type) is inconsistent with LibreOffice's formula evaluation implementation. For the formula \"IF(A1=1, B1, C1)\", all other data types for A1 are consistent with LibreOffice's evaluation of the formula.", "bug_id": 58591, "is_private": false, "id": 186280, "time": "2015-11-06T07:36:47Z", "creator": "onealj@apache.org", "creation_time": "2015-11-06T07:36:47Z", "tags": [], "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 58591, "is_private": false, "text": "Created attachment 33262\nformula evaluation unit tests\n\ntestIFEqualsFormulaEvaluation_Boolean currently fails with POI trunk (r1712907, 2015-11-05, post-POI 3.13, pre POI 3.14beta1)\nIt has been annotated with an @Ignore until this bug is resolved.", "id": 186281, "time": "2015-11-06T07:40:30Z", "creator": "onealj@apache.org", "creation_time": "2015-11-06T07:40:30Z", "attachment_id": 33262}, {"count": 2, "tags": [], "creator": "onealj@apache.org", "attachment_id": 33263, "id": 186284, "time": "2015-11-06T08:58:28Z", "bug_id": 58591, "creation_time": "2015-11-06T08:58:28Z", "is_private": false, "text": "Created attachment 33263\nformula evaluation unit tests\n\nI added in a few more tests:\nnumeric coerced to string\nstring coerced to numeric\nboolean simple (no IF statement)\nblank cell inverted with NOT (another failing case)\nblank cell inverted with NOT simple (no IF statement)"}, {"count": 3, "tags": [], "creator": "onealj@apache.org", "attachment_id": null, "is_private": false, "id": 186300, "time": "2015-11-07T04:10:20Z", "bug_id": 58591, "creation_time": "2015-11-07T04:10:20Z", "text": "All of these formulas can probably be reduced down to an equality test between different data types that can be coerced to the same data types then compared with regular boolean logic.\n\nThanks for Jason Tomforde for asking the question on user@[1] that triggered the finding of this bug.\n\nAdded these unit tests in r1713080, with @Ignore annotations applied to failing tests.\n\n[1] https://mail-archives.apache.org/mod_mbox/poi-user/201511.mbox/%3CSNT150-W744ED91F30ADE685B52EF4C5290%40phx.gbl%3E\nThread: http://thread.gmane.org/gmane.comp.jakarta.poi.user/21417"}]