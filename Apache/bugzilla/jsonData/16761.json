[{"count": 0, "tags": [], "bug_id": 16761, "text": "This bug appears when running the command apache -k install or apache -k config \nif there are CustomLog entries in the configuration that pipe to an external \nprogram (e.g. rotatelogs.exe). For each piping CustomLog, Apache creates the \ncorresponding process. Then the Apache process exits, leaving the logging \nprocesses alive, probably waiting for input on stdin (which will never come, \nsince the process isn't attached to a console).\n\nTo reproduce the bug, change the CustomLog line in the default httpd.conf to:\n\nCustomLog \"|/apache2/bin/rotatelogs.exe logs/access_%Y-%m-%d.log 86400 +60\" \ncombined\n\nThen execute apache -k install -f conf/httpd.conf. When the command is \nfinished, check the Task Manager (or a better tool, such as Process Explorer) \nfor a rotatelogs.exe process which must be killed manually.\n\nThis bug also appears with a simple test logger, so the bug is not specific to \nrotatelogs.exe.", "id": 30661, "time": "2003-02-04T15:58:50Z", "creator": "martin@jadestone.se", "creation_time": "2003-02-04T15:58:50Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 16761, "text": "I confirm this behavior with v2.0.44/Win2k. \nIt also leaves a hung process when service starts up and does not send to the\nstdin on the log processor. This behavior is with \"rotatelogs.exe\" or\n\"cronolog.exe\" So I don't think it is anything to do with the external programs\neither. \nIt does not have the problem with the ErrorLog directive. This works properly\npiped to an external program.\n", "id": 32745, "time": "2003-03-09T22:23:27Z", "creator": "sparker@parkerhome.org", "creation_time": "2003-03-09T22:23:27Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 16761, "attachment_id": null, "id": 32759, "time": "2003-03-10T04:04:51Z", "creator": "sparker@parkerhome.org", "creation_time": "2003-03-10T04:04:51Z", "is_private": false, "text": "v2.0.43 is not affected... compiled and tested on same system as 2.0.44."}, {"count": 3, "tags": [], "creator": "KGolomb@TradeCard.com", "attachment_id": 17630, "text": "Created attachment 17630\nPatch to fix Hanging pipe logger processes.\n\nIt looks like on Win32 of log.c the piped log always starts the piped process\nthru a cmd.exe shell.  Which seems to be the root of this hanging piped\nCustomLog / ErrorLog.  \n\nChanging the process creation from:\napr_procattr_cmdtype_set(procattr, APR_SHELLCMD_ENV)\t\t\t       \n\t   \nto: \napr_procattr_cmdtype_set(procattr, APR_PROGRAM_ENV)\t\t\t       \n\t   \n\nWill cause it to act the way it used and make it worrk correctly.\n\nCMD.exe will then only be utilize for .cmd and .bat loggers where it is\nnecessary.", "id": 85645, "time": "2006-02-09T17:37:01Z", "bug_id": 16761, "creation_time": "2006-02-09T17:37:01Z", "is_private": false}, {"count": 4, "tags": [], "creator": "liamr@umich.edu", "attachment_id": null, "text": "We've run into this problem on linux w/ httpd 2.2.x using ErrorLog - both with\nrotatelogs and cronolog. ", "id": 92268, "time": "2006-08-16T15:13:45Z", "bug_id": 16761, "creation_time": "2006-08-16T15:13:45Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 16761, "text": "The proposed patch seems to work for us on Apache 2.2.3.  \n", "id": 95263, "time": "2006-10-31T10:18:41Z", "creator": "toadie643@gmail.com", "creation_time": "2006-10-31T10:18:41Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 16761, "text": "(In reply to comment #4)\n> We've run into this problem on linux w/ httpd 2.2.x using ErrorLog - both with\n> rotatelogs and cronolog. \n\nHave you checked if your problem is solved by the patch for Bug 40651\n(http://svn.apache.org/viewvc?view=rev&revision=452431)?", "id": 95265, "time": "2006-10-31T11:32:00Z", "creator": "rpluem@apache.org", "creation_time": "2006-10-31T11:32:00Z", "is_private": false, "attachment_id": null}]