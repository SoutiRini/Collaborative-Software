[{"count": 0, "tags": [], "bug_id": 4545, "text": "Environment is httpd 1.3.22, built with mod_ssl 2.8.5. The only changes to \nhttpd.conf were to make the WebApp connection and WebAppDeploy of examples.\n\nIt looks like it's seg faulting on trying to get the ssl key size in \nmod_webapp.c, at rec->ssld->size = atoi(ssl_tmp). I suspect that \nSSL_CIPHER_USEKEYSIZE isn't in the environment, which is where ssl_temp has \njust been read from.", "id": 7374, "time": "2001-10-31T09:24:30Z", "creator": "steve.downey@netfolio.com", "creation_time": "2001-10-31T09:24:30Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 4545, "text": "*** Bug 4547 has been marked as a duplicate of this bug. ***", "id": 7382, "time": "2001-10-31T10:10:45Z", "creator": "pkhalife@dinmar.com", "creation_time": "2001-10-31T10:10:45Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "steve.downey@netfolio.com", "attachment_id": 742, "text": "Created attachment 742\npatch to use openssl api's for determining key length", "id": 7394, "time": "2001-10-31T12:04:41Z", "bug_id": 4545, "creation_time": "2001-10-31T12:04:41Z", "is_private": false}, {"count": 3, "attachment_id": null, "creator": "steve.downey@netfolio.com", "is_private": false, "id": 7395, "time": "2001-10-31T12:06:09Z", "bug_id": 4545, "creation_time": "2001-10-31T12:06:09Z", "tags": [], "text": "Traced this under the debugger.\nIt is this block of code:\n\n        ssl_temp = (char *)ap_table_get(\n            r->subprocess_env,\"SSL_CIPHER_USEKEYSIZE\");\n        req->ssld->size = atoi(ssl_temp);\n\nUnless SSLOptions +StdEnvVars is defined in httpd.conf, only UNIQUE_ID and \nHTTPS are in the subprocess environment. \n\nThese environment variables are really for CGI communication. What about \ninstead using the openssl apis for getting this information? It would mean \ncoupling with openssl, but with much lower overhead per request?\n\neg:\n\n ssl = ap_ctx_get(r->connection->client->ctx, \"ssl\");\n ssl_var_lookup_ssl_cipher_bits(ssl, &usekeysize, &algkeysize);\n\n\nstatic void ssl_var_lookup_ssl_cipher_bits(SSL *ssl, int *usekeysize, int \n*algkeysize)\n{\n    SSL_CIPHER *cipher;\n\n    *usekeysize = 0;\n    *algkeysize = 0;\n    if (ssl != NULL)\n        if ((cipher = SSL_get_current_cipher(ssl)) != NULL)\n            *usekeysize = SSL_CIPHER_get_bits(cipher, algkeysize);\n    return;\n}\n\nIt would probably mean mucking about with autoconf to get the correct openssl \nincludes, though.\n"}, {"count": 4, "tags": [], "bug_id": 4545, "attachment_id": 743, "id": 7396, "time": "2001-10-31T12:06:53Z", "creator": "steve.downey@netfolio.com", "creation_time": "2001-10-31T12:06:53Z", "is_private": false, "text": "Created attachment 743\npatch to use openssl api's for determining key length"}, {"count": 5, "tags": [], "bug_id": 4545, "text": "I have fixed it...", "id": 7418, "time": "2001-10-31T15:36:18Z", "creator": "jfclere@gmail.com", "creation_time": "2001-10-31T15:36:18Z", "is_private": false, "attachment_id": null}]