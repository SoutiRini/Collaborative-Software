[{"count": 0, "tags": [], "bug_id": 58468, "attachment_id": 33153, "text": "Created attachment 33153\nTest case + excel file\n\nEvaluation of DAYS function fails with message:\n\norg.apache.poi.ss.formula.FormulaParseException: Name '_xlfn.DAYS' is completely unknown in the current workbook\n\tat org.apache.poi.ss.formula.FormulaParser.function(FormulaParser.java:947)\n\tat org.apache.poi.ss.formula.FormulaParser.parseNonRange(FormulaParser.java:556)\n\tat org.apache.poi.ss.formula.FormulaParser.parseRangeable(FormulaParser.java:436)\n\tat org.apache.poi.ss.formula.FormulaParser.parseRangeExpression(FormulaParser.java:257)\n\tat org.apache.poi.ss.formula.FormulaParser.parseSimpleFactor(FormulaParser.java:1143)\n\tat org.apache.poi.ss.formula.FormulaParser.percentFactor(FormulaParser.java:1103)\n\tat org.apache.poi.ss.formula.FormulaParser.powerFactor(FormulaParser.java:1090)\n\tat org.apache.poi.ss.formula.FormulaParser.Term(FormulaParser.java:1450)\n\tat org.apache.poi.ss.formula.FormulaParser.additiveExpression(FormulaParser.java:1570)\n\tat org.apache.poi.ss.formula.FormulaParser.concatExpression(FormulaParser.java:1554)\n\tat org.apache.poi.ss.formula.FormulaParser.comparisonExpression(FormulaParser.java:1511)\n\tat org.apache.poi.ss.formula.FormulaParser.intersectionExpression(FormulaParser.java:1492)\n\tat org.apache.poi.ss.formula.FormulaParser.unionExpression(FormulaParser.java:1472)\n\tat org.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:1612)\n\tat org.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:153)\n\tat org.apache.poi.xssf.usermodel.XSSFEvaluationWorkbook.getFormulaTokens(XSSFEvaluationWorkbook.java:53)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateAny(WorkbookEvaluator.java:261)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluate(WorkbookEvaluator.java:205)\n\tat org.apache.poi.xssf.usermodel.BaseXSSFFormulaEvaluator.evaluateFormulaCellValue(BaseXSSFFormulaEvaluator.java:189)\n\tat org.apache.poi.xssf.usermodel.BaseXSSFFormulaEvaluator.doEvaluateInCell(BaseXSSFFormulaEvaluator.java:133)\n\tat org.apache.poi.xssf.usermodel.XSSFFormulaEvaluator.evaluateInCell(XSSFFormulaEvaluator.java:75)\n\tat org.apache.poi.xssf.usermodel.XSSFFormulaEvaluator.evaluateInCell(XSSFFormulaEvaluator.java:34)\n\tat it.matula.expimp.DatesTest.evaluateFormula(DatesTest.java:104)\n\tat it.matula.expimp.DatesTest.getStringCellValue(DatesTest.java:88)\n\tat it.matula.expimp.DatesTest.getCellContent(DatesTest.java:67)\n\tat it.matula.expimp.DatesTest.testDays(DatesTest.java:42)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n\tat java.lang.reflect.Method.invoke(Unknown Source)\n\tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)\n\tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\n\tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)\n\tat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)\n\tat org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)\n\tat org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)\n\tat org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)\n\tat org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)\n\tat org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)\n\tat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)\n\tat org.junit.runners.ParentRunner.run(ParentRunner.java:363)\n\tat org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)\n\tat org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)", "id": 185546, "time": "2015-09-29T18:20:46Z", "creator": "marek.matula@gmail.com", "creation_time": "2015-09-29T18:20:46Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 58468, "is_private": false, "id": 186779, "attachment_id": 33323, "creator": "onealj@apache.org", "creation_time": "2015-12-04T09:40:58Z", "time": "2015-12-04T09:40:58Z", "text": "Created attachment 33323\nDays function implementation\n\nOfficial documentation:\nhttps://support.office.com/en-us/article/DAYS-function-57740535-D549-4395-8728-0F07BFF0B9DF\n\nDays(DateTime endDate, DateTime startDate) -> returns the number of fractional days from startDate to endDate.\n\nI can't find the function code for DAYS in https://www.openoffice.org/sc/excelfileformat.pdf\nPerhaps this function was developed after BIFF8, in which case it would only be available in XSSFWorkbooks.\n\nThe attached Days function is missing unit tests."}]