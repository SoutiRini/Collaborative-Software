[{"count": 0, "tags": [], "bug_id": 41807, "text": "A public function in apr_dbd.c to register a dbd driver at runtime.\nThis could be called by the application, or by the driver itself from _init() or\nDllMain().\n\nAPU_DECLARE(apr_status_t) apr_dbd_set_driver(apr_pool_t *pool, const char *name,\n                                             const apr_dbd_driver_t *driver)\n{\n    apr_dbd_driver_t *prev = apr_hash_get(drivers, name, APR_HASH_KEY_STRING);\n    if (prev && (prev != driver)) {\n        return APR_EGENERAL;\n    }\n    apr_hash_set(drivers, name, APR_HASH_KEY_STRING, driver);\n    return APR_SUCCESS;\n}", "id": 100259, "attachment_id": null, "creator": "Tom.Donovan@acm.org", "creation_time": "2007-03-10T09:52:46Z", "time": "2007-03-10T09:52:46Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 41807, "text": "After a bit of testing, I found I forgot to lock the mutex and init the driver.\nApologies for posting the enhancement request too quickly.\n\nAPU_DECLARE(apr_status_t) apr_dbd_set_driver(apr_pool_t *pool, const char *name,\n                                             const apr_dbd_driver_t *driver)\n{\n    apr_dbd_driver_t *prev = apr_hash_get(drivers, name, APR_HASH_KEY_STRING);\n    if (prev && (prev != driver)) {\n        return APR_EGENERAL;\n    }\n    dbd_drivers_lock(mutex);\n    if (driver->init) {\n        driver->init(pool);\n    }\n    apr_hash_set(drivers, name, APR_HASH_KEY_STRING, driver);\n    dbd_drivers_unlock(mutex);\n    return APR_SUCCESS;\n}\n", "id": 100263, "time": "2007-03-10T13:49:20Z", "creator": "Tom.Donovan@acm.org", "creation_time": "2007-03-10T13:49:20Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 41807, "text": "The prerequisite for doing this kind of thing is to actually make the DBD driver\ninterface part of the public API, which hasn't been done yet; see:\n\nhttp://mail-archives.apache.org/mod_mbox/apr-dev/200703.mbox/%3c20070312140032.GB25675@redhat.com%3e", "id": 105064, "time": "2007-07-04T03:17:55Z", "creator": "jorton@redhat.com", "creation_time": "2007-07-04T03:17:55Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "Tom.Donovan@acm.org", "attachment_id": null, "is_private": false, "id": 123564, "time": "2008-12-28T06:58:34Z", "bug_id": 41807, "creation_time": "2008-12-28T06:58:34Z", "text": "No longer needed - closing"}]