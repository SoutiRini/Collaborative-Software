[{"count": 0, "tags": [], "bug_id": 31939, "attachment_id": null, "id": 65905, "time": "2004-10-28T14:35:04Z", "creator": "cgroenen@xebia.com", "creation_time": "2004-10-28T14:35:04Z", "is_private": false, "text": "When copying a file structure to a remote host, the scp task give the following\nerror:\n\nServer indicated an error: scp: protocol error: receiving a directory without -r.\n\nThe test was done with the following build.xml:\n<?xml version=\"1.0\"?>\n<project name=\"probeersels\" default=\"build\" basedir=\".\">\n\t\n\t<target name=\"probeer-scp\">\n\t\t<scp todir=\"user:psw@host:/some/dir\" trust=\"true\">\n\t\t\t<fileset dir=\"${basedir}/src\">\n\t\t\t    <include name=\"**/*.*\"/>\n\t\t\t</fileset>\n\t\t</scp>\n\t</target>\n\t\n\t<target name=\"build\">\n\t</target>\n</project>\n\nAnt version 1.6.2. Jsch version 0.1.17. OpenSSH 3.9 in Cygwin on the server\n(Win2003).\n\nThe solution is to change the line 116 in\norg.apache.tools.ant.taskdefs.optional.ssh.ScpToMessage (method\ndoMultipleTransfer()) to\n\n        Channel channel = openExecChannel(\"scp -d -t -r \" + remotePath);\n\n(Added the -r to the String starting with \"scp\"."}, {"count": 1, "tags": [], "creator": "Lars.Kinder@GMX.de", "attachment_id": 13485, "text": "Created attachment 13485\nThis package contains the fixed ScpToMessage.class\n\n1. ScpToMessage.java compiled with:\n\n$ANT_HOME/apache-ant-1.6.2-SourceDistribution/src/main>javac -classpath\n$ANT_HOME/lib/jsch-0.1.18.jar;$ANT_HOME/lib/ant-jsch.jar;$ANT_HOME/lib/ant.jar\norg/apache/tools/ant/taskdefs/optional/ssh/ScpToMessage.java\n\n2. ScpToMessage.class replaced in archive 'ant-jsch.jar' (include path\n'org/apache/tools/ant/taskdefs/optional/ssh')", "id": 67070, "time": "2004-11-17T20:42:07Z", "bug_id": 31939, "creation_time": "2004-11-17T20:42:07Z", "is_private": false}, {"count": 2, "tags": [], "text": "fixed in CVS, thanks.", "attachment_id": null, "id": 68759, "creation_time": "2004-12-21T14:42:20Z", "time": "2004-12-21T14:42:20Z", "creator": "bodewig@apache.org", "bug_id": 31939, "is_private": false}, {"count": 3, "tags": [], "creator": "mbenson@apache.org", "attachment_id": null, "id": 89056, "time": "2006-05-11T19:13:38Z", "bug_id": 31939, "creation_time": "2006-05-11T19:13:38Z", "is_private": false, "text": "*** Bug 39536 has been marked as a duplicate of this bug. ***"}]