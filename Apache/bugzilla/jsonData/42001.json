[{"count": 0, "tags": [], "bug_id": 42001, "is_private": false, "text": "I am using built in apr-util with ldap support and using built in linked lib \nfor ldap. I get this error when i use ldaps:// however the ldap:// is fine, pl \nhelp us how can i resolve this issue\n\nldap_set_option failed. Could not set LDAP_OPT_X_TLS to LDAP_OPT_X_TLS_HARD]\n[Can't contact LDA\nP server]\n\nI used following biniries to config http for ldap with ssl enable\n\n(a) apr-1.2.8.tar\n(b)apr-util-1.2.8.tar\n(c)openldap-2.3.34.tar\n(d)openssl-0.9.8e.tar\n(e)openldap-2.3.34.tar\n(f) httpd-2.2.4.tar", "id": 101253, "time": "2007-03-30T13:23:01Z", "creator": "v_sathyamurthy@hotmail.com", "creation_time": "2007-03-30T13:23:01Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 42001, "is_private": false, "text": "I can confirm this bug, using FreeBSD, openldap24, and otherwise similar circumstances.", "id": 134093, "time": "2010-02-01T05:09:18Z", "creator": "dak@csis.dk", "creation_time": "2010-02-01T05:09:18Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 42001, "attachment_id": null, "text": "can you confirm which SSL toolkit your ldap binaries are linked with via e.g ldd?", "id": 134094, "time": "2010-02-01T05:27:52Z", "creator": "covener@gmail.com", "creation_time": "2010-02-01T05:27:52Z", "is_private": false}, {"count": 3, "tags": [], "text": "(In reply to comment #2)\n> can you confirm which SSL toolkit your ldap binaries are linked with via e.g\n> ldd?\n\nAs the original submitter also said, everything here works perfectly as long as i remove the \"s\" from \"ldaps://\". \nThere is no timeout, the failures are immediate.\nSSL HTTP connections initiated TO the web server are fine too. \n\nI'm gonna try and see if it'll work with a newer openssl from ports, but here's what I've been using so far:\n\nopenldap-client-2.4.21 Open s\nIt's linked to the local libs, \n/usr/local/libexec/apache22/mod_ldap.so:\n\tlibldap-2.4.so.7 => /usr/local/lib/libldap-2.4.so.7 (0x800b0c000)\n\tlibssl.so.5 => /usr/lib/libssl.so.5 (0x800c4a000)\n\tlibcrypto.so.5 => /lib/libcrypto.so.5 (0x800d94000)\n\tliblber-2.4.so.7 => /usr/local/lib/liblber-2.4.so.7 (0x801026000)\n\tlibc.so.7 => /lib/libc.so.7 (0x800633000)\n\n7.0-RELEASE-p3 FreeBSD...\n# httpd -v \nServer version: Apache/2.2.14 (FreeBSD)\nServer built:   Feb  1 2010 15:06:58\n# pkg_info|grep ldap\nopenldap-client-2.4.21 Open source LDAP client implementation\n# openssl version\nOpenSSL 0.9.8e 23 Feb 2007\n\n\nrelevant snips from httpd.conf:\n#Load LDAP certificate\nLDAPTrustedGlobalCert CA_BASE64 /usr/local/etc/apache22/ldap_cert/<AD Hostname>.CA.pem\n\nAuthName \"Nagios Access\"\nAuthType Basic\nAuthBasicProvider ldap\nAuthzLDAPAuthoritative on\n\nAuthLDAPURL \"ldap://<hostname>:3268 <hostname>:3268/?sAMAccountName?sub?(objectClass=*)\"\n#AuthLDAPURL \"ldaps://<hostname>/?sAMAccountName?sub?(objectClass=*)\"\n#AuthLDAPURL \"ldaps://<hostname>:3269/?sAMAccountName?sub?(objectClass=*)\"\n\nAuthLDAPBindDN \"CN=<cn>,OU=<ou>,OU=<ou>,OU=<ou>,DC=<dc>,DC=<dc>\"\nAuthLDAPBindPassword <pass>\nRequire valid-user\n\n[Thu Feb 04 10:31:05 2010] [debug] mod_authnz_ldap.c(377): [client 192.168.64.101] [64980] auth_ldap authenticate: using URL ldaps://<hostname>/?sAMAccountName?sub?(objectClass=*), referer: https://nix01/side.html\n[Thu Feb 04 10:31:05 2010] [debug] mod_authnz_ldap.c(377): [client 192.168.64.101] [64980] auth_ldap authenticate: using URL ldaps://<hostname>/?sAMAccountName?sub?(objectClass=*), referer: https://nix01/side.html\n[Thu Feb 04 10:31:05 2010] [debug] mod_authnz_ldap.c(377): [client 192.168.64.101] [64980] auth_ldap authenticate: using URL ldaps://<hostname>/?sAMAccountName?sub?(objectClass=*), referer: https://nix01/side.html\n[Thu Feb 04 10:31:05 2010] [debug] mod_authnz_ldap.c(377): [client 192.168.64.101] [64980] auth_ldap authenticate: using URL ldaps://<hostname>/?sAMAccountName?sub?(objectClass=*), referer: https://nix01/side.html\n[Thu Feb 04 10:31:05 2010] [debug] mod_authnz_ldap.c(377): [client 192.168.64.101] [64980] auth_ldap authenticate: using URL ldaps://<hostname>/?sAMAccountName?sub?(objectClass=*), referer: https://nix01/side.html\n[Thu Feb 04 10:31:05 2010] [debug] mod_authnz_ldap.c(377): [client 192.168.64.101] [64980] auth_ldap authenticate: using URL ldaps://<hostname>/?sAMAccountName?sub?(objectClass=*), referer: https://nix01/side.html\n[Thu Feb 04 10:31:05 2010] [debug] mod_authnz_ldap.c(377): [client 192.168.64.101] [64980] auth_ldap authenticate: using URL ldaps://<hostname>/?sAMAccountName?sub?(objectClass=*), referer: https://nix01/side.html\n[Thu Feb 04 10:31:05 2010] [warn] [client 192.168.89.101] [64980] auth_ldap authenticate: user dak authentication failed; URI /nagios/cgi-bin/status.cgi [LDAP: ldap_simple_bind_s() failed][Can't contact LDAP server], referer: https://nix01/side.html", "attachment_id": null, "id": 134215, "creator": "dak@csis.dk", "time": "2010-02-04T01:44:07Z", "bug_id": 42001, "creation_time": "2010-02-04T01:44:07Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 42001, "attachment_id": null, "text": "Ok, now i've tried with OpenSSL 0.9.8e and it's still broken, exactly the same way as before.", "id": 134216, "time": "2010-02-04T04:10:31Z", "creator": "dak@csis.dk", "creation_time": "2010-02-04T04:10:31Z", "is_private": false}, {"count": 5, "tags": [], "text": "Oops, sorry, I meant to say OpenSSL 0.9.8l", "is_private": false, "id": 134217, "creator": "dak@csis.dk", "time": "2010-02-04T04:12:11Z", "bug_id": 42001, "creation_time": "2010-02-04T04:12:11Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 42001, "attachment_id": null, "id": 186298, "time": "2015-11-06T23:43:16Z", "creator": "aqqalukholm@gmail.com", "creation_time": "2015-11-06T23:43:16Z", "is_private": false, "text": "(In reply to Venkat S from comment #0)\n> I am using built in apr-util with ldap support and using built in linked lib \n> for ldap. I get this error when i use ldaps:// however the ldap:// is fine,\n> pl \n> help us how can i resolve this issue\n> \n> ldap_set_option failed. Could not set LDAP_OPT_X_TLS to LDAP_OPT_X_TLS_HARD]\n> [Can't contact LDA\n> P server]\n> \n> I used following biniries to config http for ldap with ssl enable\n> \n> (a) apr-1.2.8.tar\n> (b)apr-util-1.2.8.tar\n> (c)openldap-2.3.34.tar\n> (d)openssl-0.9.8e.tar\n> (e)openldap-2.3.34.tar\n> (f) httpd-2.2.4.tar\n\n(In reply to Daniel A. from comment #1)\n> I can confirm this bug, using FreeBSD, openldap24, and otherwise similar\n> circumstances.\n\n(In reply to Eric Covener from comment #2)\n> can you confirm which SSL toolkit your ldap binaries are linked with via e.g\n> ldd?\n\n(In reply to Daniel A. from comment #3)\n> (In reply to comment #2)\n> > can you confirm which SSL toolkit your ldap binaries are linked with via e.g\n> > ldd?\n> \n> As the original submitter also said, everything here works perfectly as long\n> as i remove the \"s\" from \"ldaps://\". \n> There is no timeout, the failures are immediate.\n> SSL HTTP connections initiated TO the web server are fine too. \n> \n> I'm gonna try and see if it'll work with a newer openssl from ports, but\n> here's what I've been using so far:\n> \n> openldap-client-2.4.21 Open s\n> It's linked to the local libs, \n> /usr/local/libexec/apache22/mod_ldap.so:\n> \tlibldap-2.4.so.7 => /usr/local/lib/libldap-2.4.so.7 (0x800b0c000)\n> \tlibssl.so.5 => /usr/lib/libssl.so.5 (0x800c4a000)\n> \tlibcrypto.so.5 => /lib/libcrypto.so.5 (0x800d94000)\n> \tliblber-2.4.so.7 => /usr/local/lib/liblber-2.4.so.7 (0x801026000)\n> \tlibc.so.7 => /lib/libc.so.7 (0x800633000)\n> \n> 7.0-RELEASE-p3 FreeBSD...\n> # httpd -v \n> Server version: Apache/2.2.14 (FreeBSD)\n> Server built:   Feb  1 2010 15:06:58\n> # pkg_info|grep ldap\n> openldap-client-2.4.21 Open source LDAP client implementation\n> # openssl version\n> OpenSSL 0.9.8e 23 Feb 2007\n> \n> \n> relevant snips from httpd.conf:\n> #Load LDAP certificate\n> LDAPTrustedGlobalCert CA_BASE64 /usr/local/etc/apache22/ldap_cert/<AD\n> Hostname>.CA.pem\n> \n> AuthName \"Nagios Access\"\n> AuthType Basic\n> AuthBasicProvider ldap\n> AuthzLDAPAuthoritative on\n> \n> AuthLDAPURL \"ldap://<hostname>:3268\n> <hostname>:3268/?sAMAccountName?sub?(objectClass=*)\"\n> #AuthLDAPURL \"ldaps://<hostname>/?sAMAccountName?sub?(objectClass=*)\"\n> #AuthLDAPURL \"ldaps://<hostname>:3269/?sAMAccountName?sub?(objectClass=*)\"\n> \n> AuthLDAPBindDN \"CN=<cn>,OU=<ou>,OU=<ou>,OU=<ou>,DC=<dc>,DC=<dc>\"\n> AuthLDAPBindPassword <pass>\n> Require valid-user\n> \n> [Thu Feb 04 10:31:05 2010] [debug] mod_authnz_ldap.c(377): [client\n> 192.168.64.101] [64980] auth_ldap authenticate: using URL\n> ldaps://<hostname>/?sAMAccountName?sub?(objectClass=*), referer:\n> https://nix01/side.html\n> [Thu Feb 04 10:31:05 2010] [debug] mod_authnz_ldap.c(377): [client\n> 192.168.64.101] [64980] auth_ldap authenticate: using URL\n> ldaps://<hostname>/?sAMAccountName?sub?(objectClass=*), referer:\n> https://nix01/side.html\n> [Thu Feb 04 10:31:05 2010] [debug] mod_authnz_ldap.c(377): [client\n> 192.168.64.101] [64980] auth_ldap authenticate: using URL\n> ldaps://<hostname>/?sAMAccountName?sub?(objectClass=*), referer:\n> https://nix01/side.html\n> [Thu Feb 04 10:31:05 2010] [debug] mod_authnz_ldap.c(377): [client\n> 192.168.64.101] [64980] auth_ldap authenticate: using URL\n> ldaps://<hostname>/?sAMAccountName?sub?(objectClass=*), referer:\n> https://nix01/side.html\n> [Thu Feb 04 10:31:05 2010] [debug] mod_authnz_ldap.c(377): [client\n> 192.168.64.101] [64980] auth_ldap authenticate: using URL\n> ldaps://<hostname>/?sAMAccountName?sub?(objectClass=*), referer:\n> https://nix01/side.html\n> [Thu Feb 04 10:31:05 2010] [debug] mod_authnz_ldap.c(377): [client\n> 192.168.64.101] [64980] auth_ldap authenticate: using URL\n> ldaps://<hostname>/?sAMAccountName?sub?(objectClass=*), referer:\n> https://nix01/side.html\n> [Thu Feb 04 10:31:05 2010] [debug] mod_authnz_ldap.c(377): [client\n> 192.168.64.101] [64980] auth_ldap authenticate: using URL\n> ldaps://<hostname>/?sAMAccountName?sub?(objectClass=*), referer:\n> https://nix01/side.html\n> [Thu Feb 04 10:31:05 2010] [warn] [client 192.168.89.101] [64980] auth_ldap\n> authenticate: user dak authentication failed; URI /nagios/cgi-bin/status.cgi\n> [LDAP: ldap_simple_bind_s() failed][Can't contact LDAP server], referer:\n> https://nix01/side.html\n\n(In reply to Daniel A. from comment #4)\n> Ok, now i've tried with OpenSSL 0.9.8e and it's still broken, exactly the\n> same way as before.\n\n(In reply to Daniel A. from comment #5)\n> Oops, sorry, I meant to say OpenSSL 0.9.8l"}]