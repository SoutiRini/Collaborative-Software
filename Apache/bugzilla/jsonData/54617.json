[{"count": 0, "tags": [], "creator": "dclarke@blastwave.org", "attachment_id": 29999, "text": "Created attachment 29999\nas seen on the xterm\n\nA new function ap_get_sload exists in server/util.c which receives a pointer\nto a parameter ld of type struct ap_sload_t, which is also new and defined\nin include/httpd.h thus : \n\n\n/**\n * @struct ap_sload_t\n * @brief  A structure to hold server load params\n */\ntypedef struct ap_sload_t ap_sload_t;\nstruct ap_sload_t {\n    /* percentage of process/threads ready/idle (0->100)*/\n    int idle;\n    /* percentage of process/threads busy (0->100) */\n    int busy;\n    /* total bytes served */\n    apr_off_t bytes_served;\n    /* total access count */\n    unsigned long access_count;\n};\n\n\nMy attempt to compile Apache 2.4.4 results in this syntax error : \n\n/usr/local/build/libtool --silent --mode=compile /opt/solarisstudio12.3/bin/cc -D_STDC_C99=    -errfmt=error -erroff=%none -errshort=full -xstrconst -xildoff -m64 -xmemalign=8s -xnolibmil -Xa -xcode=pic32 -xregs=no%appl -xlibmieee -mc -g -xs -ftrap=%none -Qy -xbuiltin=%none -xdebugformat=dwarf -xunroll=1 -xtarget=ultraT2 -xcache=8/16/4:4096/64/16    -DSOLARIS2=10 -D_REENTRANT  -I/usr/local/include -I/usr/local/ssl/include -D_TS_ERRNO -D_POSIX_PTHREAD_SEMANTICS -D_LARGEFILE64_SOURCE   -I. -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.001/os/unix -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.001/include -I/usr/local/include/apr-1 -I/usr/local/include -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.001/modules/aaa -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.001/modules/cache -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.001/modules/core -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.001/modules/database -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.001/modules/filters -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.001/modules/ldap -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.001/modules/loggers -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.001/modules/lua -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.001/modules/proxy -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.001/modules/session -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.001/modules/ssl -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.001/modules/test -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.001/server -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.001/modules/arch/unix -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.001/modules/dav/main -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.001/modules/generators -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.001/modules/mappers  -prefer-non-pic -static -c util.c && touch util.lo\n\"util.c\", line 2809: error: syntax error before or at: *\n\"util.c\", line 2818: error: undefined symbol: ld\n\"util.c\", line 2818: error: undefined struct/union member: idle\n\"util.c\", line 2818: error: left operand of \"->\" must be pointer to struct/union\n\"util.c\", line 2819: error: undefined struct/union member: busy\n\"util.c\", line 2819: error: left operand of \"->\" must be pointer to struct/union\n\"util.c\", line 2820: error: left operand of \"->\" must be pointer to struct/union\n\"util.c\", line 2821: error: left operand of \"->\" must be pointer to struct/union\n\"util.c\", line 2851: error: left operand of \"->\" must be pointer to struct/union\n\"util.c\", line 2852: error: left operand of \"->\" must be pointer to struct/union\n\"util.c\", line 2859: error: left operand of \"->\" must be pointer to struct/union\n\"util.c\", line 2860: error: left operand of \"->\" must be pointer to struct/union\n\"util.c\", line 2864: error: syntax error before or at: *\n\"util.c\", line 2867: error: undefined symbol: ld\n\"util.c\", line 2867: error: undefined struct/union member: loadavg\n\"util.c\", line 2867: error: left operand of \"->\" must be pointer to struct/union\n\"util.c\", line 2868: error: undefined struct/union member: loadavg5\n\"util.c\", line 2868: error: left operand of \"->\" must be pointer to struct/union\n\"util.c\", line 2869: error: undefined struct/union member: loadavg15\n\"util.c\", line 2869: error: left operand of \"->\" must be pointer to struct/union\ncc: acomp failed for util.c\ngmake[2]: *** [util.lo] Error 1\ngmake[2]: Leaving directory `/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.001/server'\ngmake[1]: *** [all-recursive] Error 1\ngmake[1]: Leaving directory `/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.001/server'\ngmake: *** [all-recursive] Error 1\n\n\nA quick diff between 2.4.3 and 2.4.4 on util.c shows : \n\n$ diff ../../httpd-2.4.3_SunOS5.10_sparcv9.001/server/util.c util.c\n64a65,67\n> #ifdef HAVE_SYS_LOADAVG_H\n> #include <sys/loadavg.h>\n> #endif\n65a69,70\n> #include \"ap_mpm.h\"\n> \n276,277c281,284\n< \n<     if (ap_regcomp(preg, pattern, cflags)) {\n---\n>     int err = ap_regcomp(preg, pattern, cflags);\n>     if (err) {\n>         if (err == AP_REG_ESPACE)\n>             ap_abort_on_oom();\n428c435\n<         if (vb->buf && vb->strlen == AP_VARBUF_UNKNOWN)\n---\n>         if (vb->strlen == AP_VARBUF_UNKNOWN)\n1095a1103\n>     apr_size_t new_len;\n1098a1107,1117\n>     if (vb->strlen == AP_VARBUF_UNKNOWN)\n>         vb->strlen = strlen(vb->buf);\n>     if (vb->avail - vb->strlen < 3) {\n>         new_len = vb->avail * 2;\n>         if (new_len > max_len)\n>             new_len = max_len;\n>         else if (new_len < 3)\n>             new_len = 3;\n>         ap_varbuf_grow(vb, new_len);\n>     }\n> \n1100d1118\n<         apr_size_t new_len;\n1942a1961,1972\n> AP_DECLARE(void) ap_bin2hex(const void *src, apr_size_t srclen, char *dest)\n> {\n>     const unsigned char *in = src;\n>     apr_size_t i;\n> \n>     for (i = 0; i < srclen; i++) {\n>         *dest++ = c2x_table[in[i] >> 4];\n>         *dest++ = c2x_table[in[i] & 0xf];\n>     }\n>     *dest = '\\0';\n> }\n> \n2585a2616,2617\n>     AP_DEBUG_ASSERT(vb->strlen == AP_VARBUF_UNKNOWN || vb->avail >= vb->strlen);\n> \n2704a2737,2738\n>         if (buf->strlen == AP_VARBUF_UNKNOWN)\n>             buf->strlen = strlen(buf->buf);\n2706,2707c2740\n<         vec[i].iov_len = (buf->strlen == AP_VARBUF_UNKNOWN) ? buf->avail\n<                                                             : buf->strlen;\n---\n>         vec[i].iov_len = buf->strlen;\n2773a2807,2887\n> }\n> \n> AP_DECLARE(void) ap_get_sload(ap_sload_t *ld)\n> {\n>     int i, j, server_limit, thread_limit;\n>     int ready = 0;\n>     int busy = 0;\n>     int total;\n>     ap_generation_t mpm_generation;\n> \n>     /* preload errored fields, we overwrite */\n>     ld->idle = -1;\n>     ld->busy = -1;\n>     ld->bytes_served = 0;\n>     ld->access_count = 0;\n> \n>     ap_mpm_query(AP_MPMQ_GENERATION, &mpm_generation);\n>     ap_mpm_query(AP_MPMQ_HARD_LIMIT_THREADS, &thread_limit);\n>     ap_mpm_query(AP_MPMQ_HARD_LIMIT_DAEMONS, &server_limit);\n> \n>     for (i = 0; i < server_limit; i++) {\n>         process_score *ps;\n>         ps = ap_get_scoreboard_process(i);\n> \n>         for (j = 0; j < thread_limit; j++) {\n>             int res;\n>             worker_score *ws = NULL;\n>             ws = &ap_scoreboard_image->servers[i][j];\n>             res = ws->status;\n> \n>             if (!ps->quiescing && ps->pid) {\n>                 if (res == SERVER_READY && ps->generation == mpm_generation) {\n>                     ready++;\n>                 }\n>                 else if (res != SERVER_DEAD &&\n>                          res != SERVER_STARTING && res != SERVER_IDLE_KILL &&\n>                          ps->generation == mpm_generation) {\n>                     busy++;\n>                 }   \n>             }\n> \n>             if (ap_extended_status && !ps->quiescing && ps->pid) {\n>                 if (ws->access_count != 0 \n>                     || (res != SERVER_READY && res != SERVER_DEAD)) {\n>                     ld->access_count += ws->access_count;\n>                     ld->bytes_served += ws->bytes_served;\n>                 }\n>             }\n>         }\n>     }\n>     total = busy + ready;\n>     if (total) {\n>         ld->idle = ready * 100 / total;\n>         ld->busy = busy * 100 / total;\n>     }\n> }\n> \n> AP_DECLARE(void) ap_get_loadavg(ap_loadavg_t *ld)\n> {\n>     /* preload errored fields, we overwrite */\n>     ld->loadavg = -1.0;\n>     ld->loadavg5 = -1.0;\n>     ld->loadavg15 = -1.0;\n> \n> #if HAVE_GETLOADAVG\n>     {\n>         double la[3];\n>         int num;\n> \n>         num = getloadavg(la, 3);\n>         if (num > 0) {\n>             ld->loadavg = (float)la[0];\n>         }\n>         if (num > 1) {\n>             ld->loadavg5 = (float)la[1];\n>         }\n>         if (num > 2) {\n>             ld->loadavg15 = (float)la[2];\n>         }\n>     }\n> #endif\n$ \n\nNot sure if anyone else has hit this but at the moment I can compile and run 2.4.3 on Solaris 10 with the Oracle Studio 12.3 compilers fine.  Apache HTTP 2.4.4 however stops with syntax error seen above.", "id": 165525, "time": "2013-02-28T01:17:48Z", "bug_id": 54617, "creation_time": "2013-02-28T01:17:48Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 54617, "attachment_id": null, "is_private": false, "id": 165528, "time": "2013-02-28T02:33:36Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2013-02-28T02:33:36Z", "text": "Could it be that there is another older httpd.h file somewhere in the include path, especially in /usr/local/include, so that the one needed to define ap_sload_t is shadowed?"}, {"count": 2, "tags": [], "bug_id": 54617, "attachment_id": null, "text": "Excellent observation by Rainer Jung.\n\nThere is a copy of httpd.h in /usr/local/include from the existing 2.4.3 \ninstall.  It conflicts with the version in the source tree and, certainly\ndoes lack the required typedef struct ap_loadavg_t.\n\n$ ls -lap /usr/local/include/httpd.h\n-rw-r--r--   1 root     root       76610 Feb 26 05:06 /usr/local/include/httpd.h\n\nNot too sure why it is owned by root but that is an install problem from\nthe previous version. \n\nfurthermore we have these header files to deal with :\n\n/usr/local/include/http_config.h\n/usr/local/include/http_connection.h\n/usr/local/include/http_core.h\n/usr/local/include/http_log.h\n/usr/local/include/http_main.h\n/usr/local/include/http_protocol.h\n/usr/local/include/http_request.h\n/usr/local/include/http_vhost.h\n\n\nThe solutions to this problem is, as root : \n\n# cd /usr/local \n# cp -p include/httpd.h include/httpd.h_backup_2.4.3\n# rm include/httpd.h\n\nThen go back to \"configure\" and start over as the uid/gid doing the compile of 2.4.4.\n\nThis then results in a good looking configure : \n\n$ pwd\n/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002\n$ env | sort > ../httpd-2.4.4_SunOS5.10_sparcv9.002.env\n$ ./configure --prefix=/usr/local --sysconfdir=/usr/local/www/conf \\\n> --localstatedir=/usr/local/www/var --datadir=/usr/local/www/data \\\n> --htmldir=/usr/local/www/docs --with-crypto \\\n> --enable-auth-digest --enable-so --enable-ratelimit --enable-include \\\n> --enable-logio --enable-expires --enable-ident --enable-usertrack \\\n> --enable-unique-id --enable-ssl --enable-privileges --enable-dav \\\n> --enable-info --enable-suexec --enable-cgid --enable-negotiation \\\n> --enable-imagemap --enable-rewrite --with-ssl=/usr/local/ssl \\\n> --enable-authn-dbd --enable-auth-form --enable-auth-digest \\\n> --enable-data --enable-ratelimit --enable-include \\\n> --enable-deflate --enable-log-debug --enable-log-forensic \\\n> --enable-session --enable-session-cookie --enable-session-crypto \\\n> --enable-unixd --enable-privileges \\\n> --with-pcre=/usr/local --with-z=/usr/local --with-libxml2=/usr/local \\\n> --enable-mpms-shared \nchecking for chosen layout... Apache\nchecking for working mkdir -p... yes\nchecking for grep that handles long lines and -e... /usr/xpg4/bin/grep\nchecking for egrep... /usr/xpg4/bin/grep -E\nchecking build system type... sparc-sun-solaris2.10\nchecking host system type... sparc-sun-solaris2.10\nchecking target system type... sparc-sun-solaris2.10\nconfigure: \nconfigure: Configuring Apache Portable Runtime library...\nconfigure: \nchecking for APR... yes\n  setting CPP to \"/opt/solarisstudio12.3/bin/cc -E\"\n  adding \"-DSOLARIS2=10\" to CPPFLAGS\n  adding \"-D_REENTRANT\" to CPPFLAGS\n  setting LDFLAGS to \" \"\nconfigure: \nconfigure: Configuring Apache Portable Runtime Utility library...\nconfigure: \nchecking for APR-util... yes\n  adding \"-L/usr/local/ssl/lib\" to LDFLAGS\n  adding \"-L/usr/local/lib\" to LDFLAGS\nchecking for gcc... /opt/solarisstudio12.3/bin/cc\nchecking whether the C compiler works... yes\nchecking for C compiler default output file name... a.out\nchecking for suffix of executables... \nchecking whether we are cross compiling... no\nchecking for suffix of object files... o\nchecking whether we are using the GNU C compiler... no\nchecking whether /opt/solarisstudio12.3/bin/cc accepts -g... yes\nchecking for /opt/solarisstudio12.3/bin/cc option to accept ISO C89... none needed\nchecking how to run the C preprocessor... /opt/solarisstudio12.3/bin/cc -E\nchecking for /opt/solarisstudio12.3/bin/cc option to accept ISO C99... -D_STDC_C99=\nchecking for pcre-config... /usr/local/bin/pcre-config\nconfigure: Using external PCRE library from /usr/local/bin/pcre-config\n  setting PCRE_INCLUDES to \"-I/usr/local/include\"\n  setting PCRE_LIBS to \"-L/usr/local/lib -R/usr/local/lib -lpcre\"\nconfigure: \nconfigure: Configuring Apache httpd...\nconfigure: \n  setting INCLUDES to \"-I.\"\n  adding \"-I$(top_srcdir)/os/$(OS_DIR)\" to INCLUDES\n  adding \"-I$(top_srcdir)/include\" to INCLUDES\n  adding \"-I/usr/local/include/apr-1\" to INCLUDES\n  adding \"-I/usr/local/ssl/include\" to INCLUDES\n  adding \"-I/usr/local/include\" to INCLUDES\nconfigure: \nconfigure: Applying OS-specific hints for httpd...\nconfigure: \n  forcing SINGLE_LISTEN_UNSERIALIZED_ACCEPT to \"1\"\n  forcing AP_NONBLOCK_WHEN_MULTI_LISTEN to \"1\"\nchecking for rm... /usr/xpg4/bin/rm\nchecking for pkg-config... /usr/bin/pkg-config\nchecking for rsync... no\nchecking for gawk... gawk\nchecking whether ln -s works... yes\nchecking for ranlib... ranlib\nchecking for lynx... no\nchecking for links... no\nchecking for elinks... no\nchecking for ANSI C header files... yes\nchecking for sys/types.h... yes\nchecking for sys/stat.h... yes\nchecking for stdlib.h... yes\nchecking for string.h... yes\nchecking for memory.h... yes\nchecking for strings.h... yes\nchecking for inttypes.h... yes\nchecking for stdint.h... yes\nchecking for unistd.h... yes\nchecking minix/config.h usability... no\nchecking minix/config.h presence... no\nchecking for minix/config.h... no\nchecking whether it is safe to define __EXTENSIONS__... yes\nchecking for library containing strerror... none required\nchecking for APR version 1.3.0 or later... yes\nchecking for APR-util version 1.3.0 or later... yes\nchecking if /opt/solarisstudio12.3/bin/cc -D_STDC_C99= -MM can create proper make dependencies... no\nchecking if /opt/solarisstudio12.3/bin/cc -D_STDC_C99= -M can create proper make dependencies... no\nchecking if /opt/solarisstudio12.3/bin/cc -E -MM can create proper make dependencies... no\nchecking if /opt/solarisstudio12.3/bin/cc -E -M can create proper make dependencies... no\nchecking if cpp -M can create proper make dependencies... no\nchecking for ANSI C header files... (cached) yes\nchecking for string.h... (cached) yes\nchecking limits.h usability... yes\nchecking limits.h presence... yes\nchecking for limits.h... yes\nchecking for unistd.h... (cached) yes\nchecking sys/socket.h usability... yes\nchecking sys/socket.h presence... yes\nchecking for sys/socket.h... yes\nchecking pwd.h usability... yes\nchecking pwd.h presence... yes\nchecking for pwd.h... yes\nchecking grp.h usability... yes\nchecking grp.h presence... yes\nchecking for grp.h... yes\nchecking for strings.h... (cached) yes\nchecking sys/prctl.h usability... no\nchecking sys/prctl.h presence... no\nchecking for sys/prctl.h... no\nchecking sys/processor.h usability... yes\nchecking sys/processor.h presence... yes\nchecking for sys/processor.h... yes\nchecking sys/sem.h usability... yes\nchecking sys/sem.h presence... yes\nchecking for sys/sem.h... yes\nchecking sys/sdt.h usability... yes\nchecking sys/sdt.h presence... yes\nchecking for sys/sdt.h... yes\nchecking sys/loadavg.h usability... yes\nchecking sys/loadavg.h presence... yes\nchecking for sys/loadavg.h... yes\nchecking for sys/wait.h that is POSIX.1 compatible... yes\nchecking for an ANSI C-conforming const... yes\nchecking for library containing sqrt... -lm\nchecking for library containing crypt... none required\nchecking for getpwnam... yes\nchecking for getgrnam... yes\nchecking for initgroups... yes\nchecking for bindprocessor... no\nchecking for prctl... no\nchecking for timegm... no\nchecking for getpgid... yes\nchecking for fopen64... no\nchecking for getloadavg... yes\nchecking for void pointer length... no\nchecking for gettid()... no\nchecking for tm_gmtoff in struct tm... no\nchecking whether to enable mod_authn_file... shared\nchecking whether to enable mod_authn_dbm... shared (most)\nchecking whether to enable mod_authn_anon... shared (most)\nchecking whether to enable mod_authn_dbd... shared\nchecking whether to enable mod_authn_socache... shared (most)\nchecking whether to enable mod_authn_core... shared\nchecking whether to enable mod_authz_host... shared\nchecking whether to enable mod_authz_groupfile... shared\nchecking whether to enable mod_authz_user... shared\nchecking whether to enable mod_authz_dbm... shared (most)\nchecking whether to enable mod_authz_owner... shared (most)\nchecking whether to enable mod_authz_dbd... shared (most)\nchecking whether to enable mod_authz_core... shared\nchecking whether to enable mod_authnz_ldap... checking dependencies\nchecking for ldap support in apr/apr-util... no\nconfigure: WARNING: apr/apr-util is compiled without ldap support\nchecking whether to enable mod_authnz_ldap... no (disabled)\nchecking whether to enable mod_access_compat... shared\nchecking whether to enable mod_auth_basic... shared\nchecking whether to enable mod_auth_form... shared\nchecking whether to enable mod_auth_digest... checking dependencies\nchecking whether to enable mod_auth_digest... shared\nchecking whether to enable mod_allowmethods... shared (most)\n  adding \"-I$(top_srcdir)/modules/aaa\" to INCLUDES\nchecking whether to enable mod_isapi... no\nchecking whether to enable mod_file_cache... shared (most)\nchecking whether to enable mod_cache... shared (most)\nchecking whether to enable mod_cache_disk... checking dependencies\nchecking whether to enable mod_cache_disk... shared (most)\nchecking whether to enable mod_socache_shmcb... shared (most)\nchecking whether to enable mod_socache_dbm... shared (most)\nchecking whether to enable mod_socache_memcache... shared (most)\nchecking whether to enable mod_socache_dc... no\n  adding \"-I$(top_srcdir)/modules/cache\" to INCLUDES\n  setting HTTPD_LDFLAGS to \"-export-dynamic\"\nchecking whether to enable mod_so... static\n  setting AP_LIBS to \"$(MOD_SO_LDADD)\"\nchecking whether to enable mod_watchdog... no\n  adding \"-I$(top_srcdir)/modules/core\" to INCLUDES\nchecking whether to enable mod_dbd... shared (most)\n  adding \"-I$(top_srcdir)/modules/database\" to INCLUDES\nchecking whether to enable mod_bucketeer... no\nchecking whether to enable mod_dumpio... shared (most)\nchecking whether to enable mod_echo... no\nchecking whether to enable mod_example_hooks... no\nchecking whether to enable mod_case_filter... no\nchecking whether to enable mod_case_filter_in... no\nchecking whether to enable mod_example_ipc... no\nchecking whether to enable mod_buffer... shared (most)\nchecking whether to enable mod_data... shared\nchecking whether to enable mod_ratelimit... shared\nchecking whether to enable mod_reqtimeout... shared\nchecking whether to enable mod_ext_filter... shared (most)\nchecking whether to enable mod_request... shared (most)\nchecking whether to enable mod_include... shared\nchecking whether to enable mod_filter... shared\nchecking whether to enable mod_reflector... no\nchecking whether to enable mod_substitute... shared (most)\nchecking whether to enable mod_sed... checking dependencies\n  setting MOD_SED_LDADD to \"-export-symbols-regex sed_module\"\nchecking whether to enable mod_sed... shared (most)\nchecking whether to enable mod_charset_lite... no\nchecking whether to enable mod_deflate... checking dependencies\n  setting MOD_INCLUDES to \"-I/usr/local/include\"\n  setting ap_zlib_ldflags to \"-L/usr/local/lib\"\n  adding \"-R/usr/local/lib\" to LDFLAGS\n  adding \"-R/usr/local/lib\" to ap_zlib_ldflags\n  setting LIBS to \"-lz\"\nchecking for zlib library... found\n  setting MOD_DEFLATE_LDADD to \"-L/usr/local/lib -R/usr/local/lib -lz\"\n  nulling LIBS\nchecking whether to enable mod_deflate... shared\nchecking whether to enable mod_xml2enc... no\nchecking whether to enable mod_proxy_html... no\n  adding \"-I$(top_srcdir)/modules/filters\" to INCLUDES\nchecking whether to enable mod_http... static\n  adding \"$(MOD_HTTP_LDADD)\" to AP_LIBS\nchecking whether to enable mod_mime... shared\nchecking whether to enable mod_ldap... checking dependencies\nchecking for ldap support in apr/apr-util... (cached) no\nconfigure: WARNING: apr/apr-util is compiled without ldap support\nchecking whether to enable mod_ldap... no (disabled)\n  adding \"-I$(top_srcdir)/modules/ldap\" to INCLUDES\nchecking whether to enable mod_log_config... shared\nchecking whether to enable mod_log_debug... shared\nchecking whether to enable mod_log_forensic... shared\n  adding \"-I$(top_builddir)/server\" to INCLUDES\nchecking whether to enable mod_logio... shared\n  adding \"-I$(top_srcdir)/modules/loggers\" to INCLUDES\nchecking whether to enable mod_lua... no\n  adding \"-I$(top_srcdir)/modules/lua\" to INCLUDES\nchecking whether to enable mod_env... shared\nchecking whether to enable mod_mime_magic... no\nchecking whether to enable mod_cern_meta... no\nchecking whether to enable mod_expires... shared\nchecking whether to enable mod_headers... shared\nchecking whether to enable mod_ident... shared\nchecking whether to enable mod_usertrack... checking dependencies\nchecking sys/times.h usability... yes\nchecking sys/times.h presence... yes\nchecking for sys/times.h... yes\nchecking for times... yes\nchecking whether to enable mod_usertrack... shared\nchecking whether to enable mod_unique_id... shared\nchecking whether to enable mod_setenvif... shared\nchecking whether to enable mod_version... shared\nchecking whether to enable mod_remoteip... shared (most)\nchecking whether to enable mod_proxy... shared (most)\nchecking whether to enable mod_proxy_connect... checking dependencies\nchecking whether to enable mod_proxy_connect... shared (most)\nchecking whether to enable mod_proxy_ftp... checking dependencies\nchecking whether to enable mod_proxy_ftp... shared (most)\nchecking whether to enable mod_proxy_http... checking dependencies\nchecking whether to enable mod_proxy_http... shared (most)\nchecking whether to enable mod_proxy_fcgi... checking dependencies\nchecking whether to enable mod_proxy_fcgi... shared (most)\nchecking whether to enable mod_proxy_scgi... checking dependencies\nchecking whether to enable mod_proxy_scgi... shared (most)\nchecking whether to enable mod_proxy_fdpass... no\nchecking whether to enable mod_proxy_ajp... checking dependencies\nchecking whether to enable mod_proxy_ajp... shared (most)\nchecking whether to enable mod_proxy_balancer... checking dependencies\nchecking whether to enable mod_proxy_balancer... shared (most)\nchecking whether to enable mod_proxy_express... checking dependencies\nchecking whether to enable mod_proxy_express... shared (most)\n  adding \"-I$(top_srcdir)/modules/proxy\" to INCLUDES\nchecking whether to enable mod_session... shared\nchecking whether to enable mod_session_cookie... checking dependencies\nchecking whether to enable mod_session_cookie... shared\nchecking whether to enable mod_session_crypto... checking dependencies\nchecking whether to enable mod_session_crypto... shared\nchecking whether to enable mod_session_dbd... checking dependencies\nchecking whether to enable mod_session_dbd... shared\n  adding \"-I$(top_srcdir)/modules/session\" to INCLUDES\nchecking whether to enable mod_slotmem_shm... shared (most)\nchecking whether to enable mod_slotmem_plain... no\nchecking whether to enable mod_ssl... checking dependencies\nchecking for OpenSSL... checking for user-provided OpenSSL base directory... /usr/local/ssl\n  setting MOD_CFLAGS to \"-I/usr/local/ssl/include  \"\n  setting ab_CFLAGS to \"-I/usr/local/ssl/include  \"\n  setting MOD_LDFLAGS to \"-L/usr/local/ssl/lib  \"\nchecking for OpenSSL version >= 0.9.7... OK\n  adding \"-lssl\" to MOD_LDFLAGS\n  adding \"-lcrypto\" to MOD_LDFLAGS\n  adding \"-lresolv\" to MOD_LDFLAGS\n  adding \"-luuid\" to MOD_LDFLAGS\n  adding \"-lsendfile\" to MOD_LDFLAGS\n  adding \"-lrt\" to MOD_LDFLAGS\n  adding \"-lsocket\" to MOD_LDFLAGS\n  adding \"-lnsl\" to MOD_LDFLAGS\n  adding \"-lpthread\" to MOD_LDFLAGS\n  setting LIBS to \"-lssl -lcrypto    -lresolv -luuid -lsendfile -lrt -lsocket -lnsl  -lpthread\"\n  forcing ab_LDFLAGS to \"-L/usr/local/ssl/lib   -lssl -lcrypto -lresolv -luuid -lsendfile -lrt -lsocket -lnsl -lpthread\"\nchecking openssl/engine.h usability... yes\nchecking openssl/engine.h presence... yes\nchecking for openssl/engine.h... yes\nchecking for SSLeay_version... yes\nchecking for SSL_CTX_new... yes\nchecking for ENGINE_init... yes\nchecking for ENGINE_load_builtin_engines... yes\nyes\n  setting MOD_SSL_LDADD to \"-export-symbols-regex ssl_module\"\nchecking whether to enable mod_ssl... shared\n  adding \"-I$(top_srcdir)/modules/ssl\" to INCLUDES\nchecking whether to enable mod_optional_hook_export... no\nchecking whether to enable mod_optional_hook_import... no\nchecking whether to enable mod_optional_fn_import... no\nchecking whether to enable mod_optional_fn_export... no\nchecking whether to enable mod_dialup... no\n  adding \"-I$(top_srcdir)/modules/test\" to INCLUDES\nchecking for target platform... unix\nchecking for rlim_t... yes\nchecking sys/time.h usability... yes\nchecking sys/time.h presence... yes\nchecking for sys/time.h... yes\nchecking sys/resource.h usability... yes\nchecking sys/resource.h presence... yes\nchecking for sys/resource.h... yes\nchecking for sys/sem.h... (cached) yes\nchecking sys/ipc.h usability... yes\nchecking sys/ipc.h presence... yes\nchecking for sys/ipc.h... yes\nchecking for setsid... yes\nchecking for killpg... yes\nchecking bstring.h usability... no\nchecking bstring.h presence... no\nchecking for bstring.h... no\nchecking for unistd.h... (cached) yes\nchecking for syslog... yes\nchecking for sys/times.h... (cached) yes\nchecking for times... (cached) yes\n  adding \"-I$(top_srcdir)/server\" to INCLUDES\nchecking whether APR supports thread-safe pollsets... checking for kqueue... no\nchecking for port_create... yes\nchecking for epoll_create... no\nyes\nchecking if event MPM supports this platform... yes\nchecking if mpmt_os2 MPM supports this platform... no\nchecking if prefork MPM supports this platform... yes\nchecking if WinNT MPM supports this platform... no\nchecking if worker MPM supports this platform... yes\nchecking whether to enable mod_lbmethod_byrequests... shared (most)\nchecking whether to enable mod_lbmethod_bytraffic... shared (most)\nchecking whether to enable mod_lbmethod_bybusyness... shared (most)\nchecking whether to enable mod_lbmethod_heartbeat... shared (most)\nchecking which MPM to use by default... event\nchecking for pthread_kill... yes\nchecking whether to enable mod_unixd... shared\nchecking whether to enable mod_privileges... checking dependencies\nchecking priv.h usability... yes\nchecking priv.h presence... yes\nchecking for priv.h... yes\nchecking whether to enable mod_privileges... shared\n  adding \"-I$(top_srcdir)/modules/arch/unix\" to INCLUDES\nchecking whether to enable mod_heartbeat... no\nchecking whether to enable mod_heartmonitor... no\nchecking whether to enable mod_dav... shared\n  adding \"-I$(top_srcdir)/modules/dav/main\" to INCLUDES\nchecking whether to enable mod_status... shared\nchecking whether to enable mod_autoindex... shared\nchecking whether to enable mod_asis... no\nchecking whether to enable mod_info... shared\nchecking whether to enable mod_suexec... checking dependencies\nchecking whether to enable mod_suexec... shared\nchecking whether to enable mod_cgid... checking dependencies\nchecking for Solaris patch 120664... yes\nchecking whether to enable mod_cgid... shared\nchecking whether to enable mod_cgi... no\n  adding \"-I$(top_srcdir)/modules/generators\" to INCLUDES\nchecking whether to enable mod_dav_fs... checking dependencies\nchecking whether to enable mod_dav_fs... shared (most)\nchecking whether to enable mod_dav_lock... no\nchecking for extra modules... none\nchecking whether to enable mod_vhost_alias... shared (most)\nchecking whether to enable mod_negotiation... shared\nchecking whether to enable mod_dir... shared\nchecking whether to enable mod_imagemap... shared\nchecking whether to enable mod_actions... shared (most)\nchecking whether to enable mod_speling... shared (most)\nchecking whether to enable mod_userdir... shared (most)\nchecking whether to enable mod_alias... shared\nchecking whether to enable mod_rewrite... shared\n  adding \"-I$(top_srcdir)/modules/mappers\" to INCLUDES\nconfigure: \nconfigure: Restore user-defined environment settings...\nconfigure: \n  restoring CPPFLAGS to \"-I/usr/local/include -I/usr/local/ssl/include -I/opt/mysql/mysql/include -D_TS_ERRNO -D_POSIX_PTHREAD_SEMANTICS -D_LARGEFILE64_SOURCE\"\n  setting EXTRA_CPPFLAGS to \" -DSOLARIS2=10 -D_REENTRANT\"\n  restoring CFLAGS to \"-errfmt=error -erroff=%none -errshort=full -xstrconst -xildoff -m64 -xmemalign=8s -xnolibmil -Xa -xcode=pic32 -xregs=no%appl -xlibmieee -mc -g -xs -ftrap=%none -Qy -xbuiltin=%none -xdebugformat=dwarf -xunroll=1 -xtarget=ultraT2 -xcache=8/16/4:4096/64/16\"\n  setting EXTRA_CFLAGS to \"\"\n  restoring CXXFLAGS to \"-dalign -erroff=%none -errtags=yes -ftrap=%none -g -xcode=pic32 -m64 -mc -xunroll=1 -xbuiltin=%none -xtarget=ultraT2 -xcache=8/16/4:4096/64/16 -xdepend=no -xnolibmopt -xlinkopt=0 -xnolibmil -xregs=no%appl -xs -D_POSIX_PTHREAD_SEMANTICS -D_LARGEFILE64_SOURCE -D_TS_ERRNO\"\n  setting EXTRA_CXXFLAGS to \"\"\n  restoring LDFLAGS to \"\"\n  setting EXTRA_LDFLAGS to \"  -L/usr/local/ssl/lib -L/usr/local/lib\"\n  restoring LIBS to \"\"\n  setting EXTRA_LIBS to \"\"\n  restoring INCLUDES to \"\"\n  setting EXTRA_INCLUDES to \"-I. -I$(top_srcdir)/os/$(OS_DIR) -I$(top_srcdir)/include -I/usr/local/include/apr-1 -I/usr/local/ssl/include -I/usr/local/include -I$(top_srcdir)/modules/aaa -I$(top_srcdir)/modules/cache -I$(top_srcdir)/modules/core -I$(top_srcdir)/modules/database -I$(top_srcdir)/modules/filters -I$(top_srcdir)/modules/ldap -I$(top_builddir)/server -I$(top_srcdir)/modules/loggers -I$(top_srcdir)/modules/lua -I$(top_srcdir)/modules/proxy -I$(top_srcdir)/modules/session -I$(top_srcdir)/modules/ssl -I$(top_srcdir)/modules/test -I$(top_srcdir)/server -I$(top_srcdir)/modules/arch/unix -I$(top_srcdir)/modules/dav/main -I$(top_srcdir)/modules/generators -I$(top_srcdir)/modules/mappers\"\nconfigure: \nconfigure: Construct makefiles and header files...\nconfigure: \nconfigure: creating config_vars.mk\nconfigure: creating ./config.status\ncreating modules/aaa/Makefile\ncreating modules/arch/win32/Makefile\ncreating modules/cache/Makefile\ncreating modules/core/Makefile\ncreating modules/database/Makefile\ncreating modules/debugging/Makefile\ncreating modules/echo/Makefile\ncreating modules/examples/Makefile\ncreating modules/experimental/Makefile\ncreating modules/filters/Makefile\ncreating modules/http/Makefile\ncreating modules/ldap/Makefile\ncreating modules/loggers/Makefile\ncreating modules/lua/Makefile\ncreating modules/metadata/Makefile\ncreating modules/proxy/Makefile\ncreating modules/session/Makefile\ncreating modules/slotmem/Makefile\ncreating modules/ssl/Makefile\ncreating modules/test/Makefile\ncreating os/unix/Makefile\ncreating modules/proxy/balancers/Makefile\ncreating server/mpm/Makefile\ncreating server/mpm/event/Makefile\ncreating modules/arch/unix/Makefile\ncreating modules/cluster/Makefile\ncreating modules/dav/main/Makefile\ncreating modules/generators/Makefile\ncreating modules/dav/fs/Makefile\ncreating modules/dav/lock/Makefile\ncreating modules/mappers/Makefile\ncreating Makefile\ncreating modules/Makefile\ncreating srclib/Makefile\ncreating os/Makefile\ncreating server/Makefile\ncreating support/Makefile\ncreating test/Makefile\nconfig.status: creating docs/conf/httpd.conf\nconfig.status: creating docs/conf/extra/httpd-autoindex.conf\nconfig.status: creating docs/conf/extra/httpd-dav.conf\nconfig.status: creating docs/conf/extra/httpd-default.conf\nconfig.status: creating docs/conf/extra/httpd-info.conf\nconfig.status: creating docs/conf/extra/httpd-languages.conf\nconfig.status: creating docs/conf/extra/httpd-manual.conf\nconfig.status: creating docs/conf/extra/httpd-mpm.conf\nconfig.status: creating docs/conf/extra/httpd-multilang-errordoc.conf\nconfig.status: creating docs/conf/extra/httpd-ssl.conf\nconfig.status: creating docs/conf/extra/httpd-userdir.conf\nconfig.status: creating docs/conf/extra/httpd-vhosts.conf\nconfig.status: creating docs/conf/extra/proxy-html.conf\nconfig.status: creating include/ap_config_layout.h\nconfig.status: creating support/apxs\nconfig.status: creating support/apachectl\nconfig.status: creating support/dbmmanage\nconfig.status: creating support/envvars-std\nconfig.status: creating support/log_server_status\nconfig.status: creating support/logresolve.pl\nconfig.status: creating support/phf_abuse_log.cgi\nconfig.status: creating support/split-logfile\nconfig.status: creating build/rules.mk\nconfig.status: creating build/pkg/pkginfo\nconfig.status: creating build/config_vars.sh\nconfig.status: creating include/ap_config_auto.h\nconfig.status: executing default commands\n$ \n\nThen GNU make continues for almost 5 minutes and we have a new problem : \n\n/usr/local/build-1/libtool --silent --mode=compile /opt/solarisstudio12.3/bin/cc -D_STDC_C99=    -errfmt=error -erroff=%none -errshort=full -xstrconst -xildoff -m64 -xmemalign=8s -xnolibmil -Xa -xcode=pic32 -xregs=no%appl -xlibmieee -mc -g -xs -ftrap=%none -Qy -xbuiltin=%none -xdebugformat=dwarf -xunroll=1 -xtarget=ultraT2 -xcache=8/16/4:4096/64/16    -DSOLARIS2=10 -D_REENTRANT  -I/usr/local/include -I/usr/local/ssl/include -I/opt/mysql/mysql/include -D_TS_ERRNO -D_POSIX_PTHREAD_SEMANTICS -D_LARGEFILE64_SOURCE   -I. -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/os/unix -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/include -I/usr/local/include/apr-1 -I/usr/local/ssl/include -I/usr/local/include -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/aaa -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/cache -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/core -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/database -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/filters -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/ldap -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/server -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/loggers -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/lua -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/proxy -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/session -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/ssl -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/test -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/server -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/arch/unix -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/dav/main -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/generators -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/mappers -prefer-pic -c ajp_utils.c && touch ajp_utils.slo\n/usr/local/build-1/libtool --silent --mode=link /opt/solarisstudio12.3/bin/cc -D_STDC_C99=    -errfmt=error -erroff=%none -errshort=full -xstrconst -xildoff -m64 -xmemalign=8s -xnolibmil -Xa -xcode=pic32 -xregs=no%appl -xlibmieee -mc -g -xs -ftrap=%none -Qy -xbuiltin=%none -xdebugformat=dwarf -xunroll=1 -xtarget=ultraT2 -xcache=8/16/4:4096/64/16   -L/usr/local/ssl/lib -L/usr/local/lib      -o mod_proxy_ajp.la -rpath /usr/local/modules -module -avoid-version  mod_proxy_ajp.lo ajp_header.lo ajp_link.lo ajp_msg.lo ajp_utils.lo \nld: warning: option -Q appears more than once, first setting taken\n/usr/local/build-1/libtool --silent --mode=compile /opt/solarisstudio12.3/bin/cc -D_STDC_C99=    -errfmt=error -erroff=%none -errshort=full -xstrconst -xildoff -m64 -xmemalign=8s -xnolibmil -Xa -xcode=pic32 -xregs=no%appl -xlibmieee -mc -g -xs -ftrap=%none -Qy -xbuiltin=%none -xdebugformat=dwarf -xunroll=1 -xtarget=ultraT2 -xcache=8/16/4:4096/64/16    -DSOLARIS2=10 -D_REENTRANT  -I/usr/local/include -I/usr/local/ssl/include -I/opt/mysql/mysql/include -D_TS_ERRNO -D_POSIX_PTHREAD_SEMANTICS -D_LARGEFILE64_SOURCE   -I. -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/os/unix -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/include -I/usr/local/include/apr-1 -I/usr/local/ssl/include -I/usr/local/include -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/aaa -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/cache -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/core -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/database -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/filters -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/ldap -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/server -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/loggers -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/lua -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/proxy -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/session -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/ssl -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/test -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/server -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/arch/unix -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/dav/main -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/generators -I/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/mappers -prefer-pic -c mod_proxy_balancer.c && touch mod_proxy_balancer.slo\n\"mod_proxy_balancer.c\", line 826: error: undefined struct/union member: fgrab\n\"mod_proxy_balancer.c\", line 826: error: function designator is not of function type\n\"mod_proxy_balancer.c\", line 826: warning: improper pointer/integer combination: op \"=\"\n\"mod_proxy_balancer.c\", line 874: error: undefined struct/union member: fgrab\n\"mod_proxy_balancer.c\", line 874: error: function designator is not of function type\n\"mod_proxy_balancer.c\", line 874: warning: improper pointer/integer combination: op \"=\"\n\"mod_proxy_balancer.c\", line 906: error: cannot recover from previous errors\ncc: acomp failed for mod_proxy_balancer.c\ngmake[4]: *** [mod_proxy_balancer.slo] Error 1\ngmake[4]: Leaving directory `/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/proxy'\ngmake[3]: *** [shared-build-recursive] Error 1\ngmake[3]: Leaving directory `/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules/proxy'\ngmake[2]: *** [shared-build-recursive] Error 1\ngmake[2]: Leaving directory `/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002/modules'\ngmake[1]: *** [shared-build-recursive] Error 1\ngmake[1]: Leaving directory `/usr/local/build/httpd-2.4.4_SunOS5.10_sparcv9.002'\ngmake: *** [all-recursive] Error 1\n\nI see \"mod_proxy_balancer.c\", line 826: error: undefined struct/union member: fgrab\n\n$ grep -n \"fgrab\" modules/proxy/mod_proxy_balancer.c\n826:                if ((rv = storage->fgrab(conf->bslot, index)) != APR_SUCCESS) {\n827:                    ap_log_error(APLOG_MARK, APLOG_EMERG, rv, s, APLOGNO(02408) \"balancer slotmem_fgrab failed\");\n874:                    if ((rv = storage->fgrab(balancer->wslot, index)) != APR_SUCCESS) {\n875:                        ap_log_error(APLOG_MARK, APLOG_EMERG, rv, s, APLOGNO(02409) \"worker slotmem_fgrab failed\");\n\nWell storage seems to be of type ap_slotmem_provider_t and it was initialized up in line 726 of modules/proxy/mod_proxy_balancer.c :\n\n    /*\n     * Get slotmem setups\n     */\n    storage = ap_lookup_provider(AP_SLOTMEM_PROVIDER_GROUP, \"shm\",\n                                 AP_SLOTMEM_PROVIDER_VERSION);\n\nThis data type is used in plenty of places : \n\n\n./include/ap_mmn.h\n./include/ap_slotmem.h\n./modules/cluster/mod_heartmonitor.c\n./modules/proxy/balancers/mod_lbmethod_heartbeat.c\n./modules/proxy/mod_proxy.h\n./modules/proxy/mod_proxy_balancer.c\n./modules/proxy/proxy_util.c\n./modules/slotmem/mod_slotmem_plain.c\n./modules/slotmem/mod_slotmem_shm.c\n\nThe type is defined in ./include/ap_slotmem.h so is there an \"fgrab\" in there ?\n\nstruct ap_slotmem_provider_t {\n    /*\n     * Name of the provider method\n     */\n    const char *name;\n.\n.\n. snip a pile of lines with nice comments and other such\n.\n\n    /**\n     * forced grab (or alloc) a slot associated with this item_id\n     * @param s ap_slotmem_instance_t to use.\n     * @param item_id to the specified slot id and marked as in-use\n     * @return APR_SUCCESS if all went well\n     */\n    apr_status_t (* fgrab)(ap_slotmem_instance_t *s, unsigned int item_id);\n};\n\ntypedef struct ap_slotmem_provider_t ap_slotmem_provider_t;\n\n\nIs this new to 2.4.4 ? \n\n$ diff ../httpd-2.4.3_SunOS5.10_sparcv9.001/include/ap_slotmem.h include/ap_slotmem.h\n64a65,67\n>  *\n>  * AP_SLOTMEM_TYPE_CLEARINUSE: If persisting, clear 'inuse' array before\n>  *    storing\n66,68c69,72\n< #define AP_SLOTMEM_TYPE_PERSIST   (1 << 0)\n< #define AP_SLOTMEM_TYPE_NOTMPSAFE (1 << 1)\n< #define AP_SLOTMEM_TYPE_PREGRAB   (1 << 2)\n---\n> #define AP_SLOTMEM_TYPE_PERSIST      (1 << 0)\n> #define AP_SLOTMEM_TYPE_NOTMPSAFE    (1 << 1)\n> #define AP_SLOTMEM_TYPE_PREGRAB      (1 << 2)\n> #define AP_SLOTMEM_TYPE_CLEARINUSE   (1 << 3)\n177a182,188\n>     /**\n>      * forced grab (or alloc) a slot associated with this item_id\n>      * @param s ap_slotmem_instance_t to use.\n>      * @param item_id to the specified slot id and marked as in-use\n>      * @return APR_SUCCESS if all went well\n>      */\n>     apr_status_t (* fgrab)(ap_slotmem_instance_t *s, unsigned int item_id);\n$ \n\n\nYes, it is new. \n\nDo I have more header files in /usr/local/include from the previous httpd instance ? \n\n$ find /usr/local/include -type f | xargs grep ap_slotmem_provider_t | cut -f1 -d\\: | sort -u \n/usr/local/include/ap_slotmem.h\n/usr/local/include/mod_proxy.h\n\n\nYes .. more of the same problem. \n\nI think perhaps there needs to be some way to tell my build process to look in the source directory FIRST before looking in /usr/local/include for headers or this will be a long frustrating process of falling on errors due to new changes.\n\nEven worse, is NOT falling on the new changes and not seeing some more subtle flaw in my resultant binaries because of older headers being used.", "id": 165529, "time": "2013-02-28T09:45:18Z", "creator": "dclarke@blastwave.org", "creation_time": "2013-02-28T09:45:18Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 54617, "text": "I agree we should make sure that our build process has the local include directory listed before any other ones. Looking at my own make output indicates, that the ordering is broken right now.", "id": 165549, "time": "2013-02-28T15:23:09Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2013-02-28T15:23:09Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 54617, "attachment_id": null, "is_private": false, "id": 165554, "time": "2013-02-28T21:13:27Z", "creator": "dclarke@blastwave.org", "creation_time": "2013-02-28T21:13:27Z", "text": "Perhaps we should re-name this bug as \"build system includes wrong headers\" \nor something similar. Really I can not see anything else needed than a re-order\n or better yet just put a -Ithis_source_path/include first.\n\nWhat I did as a work around was to do a find in the source tree for all\nfiles that end with .h and then delete those same filenames from the /usr/local/include directory tree.  A bit of a blunt tool approach but it worked. \n\nThen when I was finished the compile and the subsequent install everything\n\"just works\" as I expected. \n\nDennis"}, {"count": 5, "tags": [], "bug_id": 54617, "attachment_id": null, "is_private": false, "id": 174132, "time": "2014-03-27T15:27:02Z", "creator": "dclarke@blastwave.org", "creation_time": "2014-03-27T15:27:02Z", "text": "see https://issues.apache.org/bugzilla/show_bug.cgi?id=55789#c17\n\n Dennis Clarke 2014-03-26 04:36:15 UTC\n\nWell its long overdue to make my apologies and request this bug be closed \nand perhaps marked as \"user error\".  As Mike Rumph pointed out back on 2013-12-11 00:40:17 UTC that fault may be in CPPFLAGS which has \"-I/usr/local/include -I/usr/local/ssl/include\" as well as the reasonable \"-D_TS_ERRNO -D_POSIX_PTHREAD_SEMANTICS -D_LARGEFILE64_SOURCE\".\n\nThis explains the include order seen. \n\nI just built the most recent release all in one smooth pass with no errors\nat all :\n\n# /usr/local/bin/httpd -V \nServer version: Apache/2.4.9 (Unix)\nServer built:   Mar 26 2014 03:50:32\nServer's Module Magic Number: 20120211:31\nServer loaded:  APR 1.5.0, APR-UTIL 1.5.3\nCompiled using: APR 1.5.0, APR-UTIL 1.5.3\nArchitecture:   64-bit\nServer MPM:     event\n  threaded:     yes (fixed thread count)\n    forked:     yes (variable process count)\nServer compiled with....\n -D APR_HAS_SENDFILE\n -D APR_HAS_MMAP\n -D APR_USE_PROC_PTHREAD_SERIALIZE\n -D APR_USE_PTHREAD_SERIALIZE\n -D SINGLE_LISTEN_UNSERIALIZED_ACCEPT\n -D APR_HAS_OTHER_CHILD\n -D AP_HAVE_RELIABLE_PIPED_LOGS\n -D DYNAMIC_MODULE_LIMIT=256\n -D HTTPD_ROOT=\"/usr/local\"\n -D SUEXEC_BIN=\"/usr/local/bin/suexec\"\n -D DEFAULT_PIDLOG=\"www/var/logs/httpd.pid\"\n -D DEFAULT_SCOREBOARD=\"logs/apache_runtime_status\"\n -D DEFAULT_ERRORLOG=\"logs/error_log\"\n -D AP_TYPES_CONFIG_FILE=\"www/conf/mime.types\"\n -D SERVER_CONFIG_FILE=\"www/conf/httpd.conf\"\n\nruns like a charm. \n\nAll I need to do now is figure out why my initial SSL_SESSION_ID env var in cgi is blank despite having \"SSLOptions +StdEnvVars\" set. However that is another matter entirely. \n\nThanks for epic patience and endless support while I fumbled through this. \n\nI changed this to P4 trivial because I couldn't find P9 'user-error'.\n\nDennis"}, {"count": 6, "tags": [], "bug_id": 54617, "attachment_id": null, "text": "Thanks for reporting the configure error.\nThe bug is marked as invalid.", "id": 174150, "time": "2014-03-27T21:25:38Z", "creator": "ylavic.dev@gmail.com", "creation_time": "2014-03-27T21:25:38Z", "is_private": false}]