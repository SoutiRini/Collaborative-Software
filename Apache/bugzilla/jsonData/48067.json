[{"count": 0, "tags": [], "text": "With mod_fcgid-2.3.4 in Solaris, execution of addloadexample.awk during \"make install\" fails with error \"awk: syntax error near line 35\". Reason: normal Solaris awk (/usr/bin/awk) does not understand\n if ( ! /^[ \\t]*$/ ) print \"\";\nWorkaround: use nawk (/usr/bin/nawk) or /usr/xpg4/bin/awk\nPossible Patch:\n if ( $0 !~ /^[ \\t]*$/ ) print \"\";", "is_private": false, "bug_id": 48067, "id": 131423, "time": "2009-10-27T09:12:49Z", "creator": "strube@physik3.gwdg.de", "creation_time": "2009-10-27T09:12:49Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "trawick@apache.org", "attachment_id": null, "id": 131425, "time": "2009-10-27T09:23:23Z", "bug_id": 48067, "creation_time": "2009-10-27T09:23:23Z", "is_private": false, "text": "Which level of Solaris?"}, {"count": 2, "tags": [], "bug_id": 48067, "text": "Solaris 10 U7 (5/09). AFAIK, there is no newer patch for /usr/bin/awk.", "id": 131426, "time": "2009-10-27T09:31:46Z", "creator": "strube@physik3.gwdg.de", "creation_time": "2009-10-27T09:31:46Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "Thanks for the \"possible patch;\" it worked fine.  I also had to change the command-line invocation to accept the input file (httpd.conf) from stdin; if named on the command-line, Solaris awk processes it then waits on stdin.\n\nThe fix also goes into mod_ftp, which shares the build logic.", "is_private": false, "bug_id": 48067, "id": 131857, "time": "2009-11-10T16:54:09Z", "creator": "trawick@apache.org", "creation_time": "2009-11-10T16:54:09Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "strube@physik3.gwdg.de", "is_private": false, "text": "> if named on the command-line, Solaris awk processes it then waits on stdin.\n\nI have NEVER seen such a behaviour. This can only occur if a '-' follows the input-file name, such as \"awk ... inputfile -\"", "id": 131863, "time": "2009-11-11T00:28:56Z", "bug_id": 48067, "creation_time": "2009-11-11T00:28:56Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "trawick@apache.org", "is_private": false, "count": 5, "id": 131871, "time": "2009-11-11T04:11:06Z", "bug_id": 48067, "creation_time": "2009-11-11T04:11:06Z", "text": ">I have NEVER seen such a behaviour. This can only occur if a '-' follows the\ninput-file name, such as \"awk ... inputfile -\"\n\nYou're right; my explanation is incorrect.  I'll leave it at this:\n\nThis stalls on stdin\n\n/usr/bin/awk -f build/addloadexample.awk -v MODULE=fcgid infile >/dev/null\n\nbut this doesn't\n\n/usr/bin/awk -f build/addloadexample.awk infile >/dev/null\n\n(but that is missing the variable substitution)\n\nand neither does this\n\n/usr/bin/awk -f build/addloadexample.awk -v MODULE=fcgid < infile >/dev/null\n\nI'm not able to quickly find the root cause.  Moving \"-v MODULE=fcgid\" before the \"-f foo.awk\" yields a syntax error.\n\nI'm curious if you know the answer; perhaps there's a more correct invocation for Makefile.apxs.\n\n(This is with /usr/bin/awk on Solaris 10 U5 and OpenSolaris 2009.06.)"}, {"count": 6, "attachment_id": null, "bug_id": 48067, "text": "Solaris awk doesn't know the \"-v\" flag.\n\nOn Solaris nawk and /usr/xpg4/bin/awk can use \"-v\", but for the normal awk the syntax is simply \"myvar=myval\" without \"-v\".\n\nWild guess: \"-v\" is interpreted as \"-\" (read from stdin) and the \"v\" might get dropped.", "id": 131872, "time": "2009-11-11T05:17:45Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2009-11-11T05:17:45Z", "tags": [], "is_private": false}, {"count": 7, "attachment_id": null, "bug_id": 48067, "is_private": false, "id": 131873, "time": "2009-11-11T05:37:58Z", "creator": "strube@physik3.gwdg.de", "creation_time": "2009-11-11T05:37:58Z", "tags": [], "text": "> On Solaris nawk and /usr/xpg4/bin/awk can use \"-v\"\n\nYes, that's the reason. Moreover, with nawk the -v must precede the -f (or in-line 'program'), whereas with /usr/xpg4/bin/awk it can also follow these. /usr/bin/awk does not understand -v at all."}, {"count": 8, "tags": [], "creator": "trawick@apache.org", "is_private": false, "text": "A portable invocation which also avoids the confusion over -v with Solaris awk seems to be\n\nawk -f prog.awk VAR1=val1 VAR2=val2 <infile >outfile\n\n(and <infile can just be infile; it makes no difference)\n\nBut there is another aspect which doesn't work correctly but happens to generate a working config file:  the tolower($0) ~ /.../ in the script isn't matching, so the LoadModule is added in an unexpected place.\n\nSo we're back to the idea of finding a suitable awk.  Any issues with\n\nhttp://svn.apache.org/viewvc?view=revision&revision=834900\n\n?", "id": 131877, "time": "2009-11-11T07:15:01Z", "bug_id": 48067, "creation_time": "2009-11-11T07:15:01Z", "attachment_id": null}, {"count": 9, "tags": [], "creator": "strube@physik3.gwdg.de", "text": "/usr/bin/awk in Solaris does not understand tolower(), even though there is no error; it simply passes its argument unchanged. Only nawk and /usr/xpg4/bin/awk have a working tolower().\nThus the strategy to select the best awk with configure is right. However, /usr/xpg4/bin/awk should be explicitly mentioned in the search list before nawk.", "id": 131878, "time": "2009-11-11T07:35:03Z", "bug_id": 48067, "creation_time": "2009-11-11T07:35:03Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "text": ">/usr/xpg4/bin/awk should be explicitly mentioned in the search list before\nnawk\n\nnawk worked for me, but I see some notes on the web about a lack of toupper/tolower in the nawk of some Solaris versions\n\nfixed in r834923\n\nthanks!", "attachment_id": null, "id": 131880, "creator": "trawick@apache.org", "time": "2009-11-11T07:51:27Z", "bug_id": 48067, "creation_time": "2009-11-11T07:51:27Z", "is_private": false}]