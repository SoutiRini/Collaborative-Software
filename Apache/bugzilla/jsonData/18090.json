[{"attachment_id": null, "tags": [], "creator": "tanino.fe@pfu.fujitsu.com", "is_private": false, "count": 0, "id": 33321, "time": "2003-03-18T06:52:04Z", "bug_id": 18090, "creation_time": "2003-03-18T06:52:04Z", "text": "When the specified column is larger than the value of getFirstColumn by the \nloop of Sheet.getColumnWidth, an exact columninfo object is not returned.\n\n    public short getColumnWidth(short column)\n    {\n        short            retval = 0;\n        ColumnInfoRecord ci     = null;\n        int              k      = 0;\n\n        if (columnSizes != null)\n        {\n            for (k = 0; k < columnSizes.size(); k++)\n            {\n                ci = ( ColumnInfoRecord ) columnSizes.get(k);\n-               if ((ci.getFirstColumn() >= column)\n+               if ((ci.getFirstColumn() <= column)\n                        && (column <= ci.getLastColumn()))\n                {\n                    break;\n                }\n                ci = null;\n            }\n        }\n        if (ci != null)\n        {\n            retval = ci.getColumnWidth();\n        }\n        else\n        {\n            retval = defaultcolwidth.getColWidth();\n        }\n        return retval;\n    }"}, {"count": 1, "tags": [], "bug_id": 18090, "text": "Created attachment 5602\nI found same bug at org.apache.poi.hssf.model.Sheet#setColumn.So I submitt as a patch.", "id": 34307, "time": "2003-04-02T09:08:15Z", "creator": "kamoshida.toshiaki@future.co.jp", "creation_time": "2003-04-02T09:08:15Z", "is_private": false, "attachment_id": 5602}, {"attachment_id": null, "tags": [], "creator": "kamoshida.toshiaki@future.co.jp", "is_private": false, "count": 2, "id": 34308, "time": "2003-04-02T09:11:48Z", "bug_id": 18090, "creation_time": "2003-04-02T09:11:48Z", "text": "Sorry, not Sheet#setColumn() but Sheet#setColumnWidth()."}, {"count": 3, "attachment_id": null, "bug_id": 18090, "is_private": false, "id": 34311, "time": "2003-04-02T09:59:48Z", "creator": "kamoshida.toshiaki@future.co.jp", "creation_time": "2003-04-02T09:59:48Z", "tags": [], "text": "The bug Mr.Tanino reported is a simple bug,and I found same problem because of \nanother reason.\n\nWhen user changed plural column's width collectively and saved,the info about \nthe operation is exist only the first column's info.(I see the info by XML \nElement generated by MS OfficeXP.Maybe OLE2 file keep it with another sytle,but \nI don't know the spec deeply)\nSo,user can't get correct width about rest columns by Sheet#getColumnWidth()."}, {"count": 4, "tags": [], "text": "...Sorry,I didn't read org.apache.poi.hssf.record.ColumnInfoRecord.\nThe Logic I said is already implemented.\n...So,why a problem happen in my local env?hmm...", "attachment_id": null, "bug_id": 18090, "id": 34312, "time": "2003-04-02T10:10:41Z", "creator": "kamoshida.toshiaki@future.co.jp", "creation_time": "2003-04-02T10:10:41Z", "is_private": false}, {"count": 5, "tags": [], "text": "Very sorry,I tested POI without Mr.tanino's patch X(", "attachment_id": null, "id": 34318, "creation_time": "2003-04-02T11:21:54Z", "time": "2003-04-02T11:21:54Z", "creator": "kamoshida.toshiaki@future.co.jp", "bug_id": 18090, "is_private": false}, {"count": 6, "tags": [], "text": "Sorry, now I am confused. Which patch should i apply?", "is_private": false, "id": 34320, "creation_time": "2003-04-02T12:07:47Z", "time": "2003-04-02T12:07:47Z", "creator": "avik@apache.org", "bug_id": 18090, "attachment_id": null}, {"count": 7, "attachment_id": 5606, "bug_id": 18090, "text": "Created attachment 5606\nTestcase to find this problem", "id": 34345, "time": "2003-04-02T15:09:27Z", "creator": "kamoshida.toshiaki@future.co.jp", "creation_time": "2003-04-02T15:09:27Z", "tags": [], "is_private": false}, {"count": 8, "tags": [], "creator": "kamoshida.toshiaki@future.co.jp", "is_private": false, "text": "Because I am stupid,I am sorry to make you confused...X(\n\nThe attatchment I submitted is a copy of that Mr.Tanino wrote.\nTo fix org.apache.poi.hssf.model.Sheet#getColumnWidth(),please apply it.\nAnd I found same mistake in #setColumnWidth(),so in the patch I apply to\nfix it.\n\n\nBTW,\nNow I submitted a testcase testing #getColumnWidth() and #setColumnWidth().\nAnd I found a new problem with the testcase...\n\nBy the testcase,ColumnInfoRecord should be splited to 3 records,ColumnNo=5, and \nColumnNo=6,and ColumnNo=7~10. But now there is no implementation like so in \n#setColumnWidth().\nSo the last asserEquals() block in the testcase will throw a Error.", "id": 34349, "time": "2003-04-02T15:24:04Z", "bug_id": 18090, "creation_time": "2003-04-02T15:24:04Z", "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 18090, "attachment_id": 5614, "id": 34396, "time": "2003-04-03T04:12:31Z", "creator": "kamoshida.toshiaki@future.co.jp", "creation_time": "2003-04-03T04:12:31Z", "is_private": false, "text": "Created attachment 5614\nPATCH to fix the case like,a ColumnInfoRecord should be splited to 3 records"}, {"count": 10, "tags": [], "bug_id": 18090, "is_private": false, "text": "Committed.  Please cross check.  unit tests passed.", "id": 34929, "time": "2003-04-11T03:00:50Z", "creator": "poi-support@buni.org", "creation_time": "2003-04-11T03:00:50Z", "attachment_id": null}]