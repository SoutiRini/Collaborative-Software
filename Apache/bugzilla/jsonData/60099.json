[{"attachment_id": 34224, "tags": [], "bug_id": 60099, "text": "Created attachment 34224\nTest class\n\nWhen the StatementCache is searching for a matching PreparedStatement, the matching criteria do not take into account the scrollable type of result set, but only the sql query.\n\nIf we create a PreparedStatement with a FORWARD_ONLY result set type, and then we try to create another PreparedStatement with a SCROLL_INSENSITIVE type with the same query, then the cache will return the PreparedStatement created first(a FORWARD_ONLY statement), and any attempt to call the absolute method will throw a java.sql.SQLException: The 'absolute()' method is only allowed on scroll cursors.\n\nPlease find attached a Test Class that can help to reproduce the problem. To run this class you need to add derby-10.11, tomcat-jdbc-8.0.37 and tomcat-juli-8.0.37 to classpath. I am using jdk1.8.0_92 to compile and execute this test.\n\nP.S. The error only appears when creating a PreparedStatement instead of a Statement (by calling createStatement()).\n\nPlease tell me, if you need more informations.\n\nThanks for your help!\n\nFull StackTrace:\nException in thread \"main\" java.sql.SQLException: The 'absolute()' method is only allowed on scroll cursors.\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)\n\tat org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)\n\tat org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)\n\tat org.apache.derby.impl.jdbc.EmbedResultSet.checkScrollCursor(Unknown Source)\n\tat org.apache.derby.impl.jdbc.EmbedResultSet.absolute(Unknown Source)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.tomcat.jdbc.pool.interceptor.StatementDecoratorInterceptor$ResultSetProxy.invoke(StatementDecoratorInterceptor.java:307)\n\tat com.sun.proxy.$Proxy4.absolute(Unknown Source)\n\tat test.Test.testWithInsensitiveResultSet(Test.java:75)\n\tat test.Test.main(Test.java:18)\nCaused by: ERROR XJ061: The 'absolute()' method is only allowed on scroll cursors.\n\tat org.apache.derby.iapi.error.StandardException.newException(Unknown Source)\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.wrapArgsForTransportAcrossDRDA(Unknown Source)\n\t... 14 more", "count": 0, "id": 193567, "time": "2016-09-08T20:30:21Z", "creator": "mabbas85@gmail.com", "creation_time": "2016-09-08T20:30:21Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 60099, "text": "Thanks for the report.\nThe fix will be in :\n- 9.0.x for 9.0.0.M11 onwards\n- 8.5.x for 8.5.6 onwards\n- 8.0.x for 8.0.38 onwards\n- 7.0.x for 7.0.73 onwards", "id": 193745, "time": "2016-09-15T10:20:15Z", "creator": "kfujino@apache.org", "creation_time": "2016-09-15T10:20:15Z", "is_private": false, "attachment_id": null}]