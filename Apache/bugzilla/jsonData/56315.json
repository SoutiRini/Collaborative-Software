[{"count": 0, "tags": [], "bug_id": 56315, "attachment_id": 31438, "text": "Created attachment 31438\nSimple Java program and Excel sheet to reproduce the bug\n\nWhen running the attached code I get the following output:\nA1 numeric: 0.049999999999999975\nA3 numeric: 0.0\nA3 text: 0\nA3 formatted: 0\nA4 concatenated: test 0\n\nIf I open the spreadsheet in Excel it displays:\nA1: 0.05\nA3: 0.1\nA4: test 0.1\n\n\nThe ROUND function in cell A3 returns 0.0 in POI, while it returns 0.1 in Excel.\nI assume this is because of the problems with storing exact floating point numbers, but I really think POI and excel should return the same result.\n\nWhen the value is used in a CONCATENATE function in cell A4, the result from POI also differs from Excel.", "id": 174088, "time": "2014-03-25T22:21:18Z", "creator": "josteitv@pvv.ntnu.no", "creation_time": "2014-03-25T22:21:18Z", "is_private": false}, {"count": 1, "tags": [], "creator": "josteitv@pvv.ntnu.no", "text": "Created attachment 31453\n[PATCH] Patch against trunk to solve this bug\n\nI fixed this bug by using\n\nnew java.math.BigDecimal(NumberToTextConverter.toText(n))\n\ninstead of\n\njava.math.BigDecimal.valueOf(n)\n\nAll other unit tests goes green, so I assume this solution is ok.", "id": 174159, "time": "2014-03-28T12:22:53Z", "bug_id": 56315, "creation_time": "2014-03-28T12:22:53Z", "is_private": false, "attachment_id": 31453}, {"count": 2, "tags": [], "bug_id": 56315, "is_private": false, "text": "Created attachment 31454\nThe patch including unit test against excel spreadsheet\n\nI'm adding the patch and the tar.gz separately", "id": 174160, "time": "2014-03-28T12:30:25Z", "creator": "josteitv@pvv.ntnu.no", "creation_time": "2014-03-28T12:30:25Z", "attachment_id": 31454}, {"count": 3, "tags": [], "bug_id": 56315, "attachment_id": 31455, "is_private": false, "id": 174161, "time": "2014-03-28T12:31:14Z", "creator": "josteitv@pvv.ntnu.no", "creation_time": "2014-03-28T12:31:14Z", "text": "Created attachment 31455\nThe patch as text file\n\nI'm adding the patch and the tar.gz separately"}, {"count": 4, "tags": [], "text": "Thanks for the patch, this is applied with r1588538 with some additional testing in TestMathX.", "is_private": false, "id": 174711, "creator": "dominik.stadler@gmx.at", "time": "2014-04-18T18:22:26Z", "bug_id": 56315, "creation_time": "2014-04-18T18:22:26Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 56315, "attachment_id": null, "is_private": false, "id": 181760, "time": "2015-03-14T15:00:13Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-03-14T15:00:13Z", "text": "Why was this bug reopened? Please provide some useful explanation if you believe a bug is not fixed. \n\nBefore reopening bugs, please make sure to verify the problem with latest trunk builds (either from source or nightly snapshot builds) as fixes usually only become available as part of releases after quite some time."}]