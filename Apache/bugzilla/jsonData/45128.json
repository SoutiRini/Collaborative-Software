[{"count": 0, "tags": [], "text": "The conversion pattern M (method name) does not apply when using AsyncAppender.\nInstead of writing the method name it writes a question mark.\n\nThe class test:\n------------Start of class-----------------\npackage test;\n\nimport org.apache.log4j.*;\n\n\npublic class Log4JTest\n{\n   private static Logger sLogger = Logger.getLogger(Log4JTest.class);\n   public Log4JTest()\n   {\n   }\n\n   public void setString(String str) {\n      sLogger.debug(str);\n      System.out.println(\"s=\" + str);\n   }\n\n   public static void main(String[] args) {\n      Log4JTest log4JTest = new Log4JTest();\n      String x = \"Hello World\";\n      log4JTest.setString(x);\n\n   }\n}\n------------End of class-----------------\n\nThe log4j configuration:\n------------Start of configuration-----------------\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE log4j:configuration SYSTEM \"../conf/log4j.dtd\">\n<log4j:configuration debug=\"false\" xmlns:log4j='http://jakarta.apache.org/log4j/'>\n\n\t<!-- ************** -->\n\t<!-- * Appenders: * -->\n\t<!-- ************** -->\n\t<!-- Default -->\n\t<appender name=\"Console\" class=\"org.apache.log4j.ConsoleAppender\">\n\t\t<layout class=\"org.apache.log4j.PatternLayout\">\n      \t\t\t<param name=\"ConversionPattern\" value=\"%d{ISO8601} [%-5p] [%t] [%c{3}] [%x]: %m%n\"/>\n\t\t</layout>\n\t</appender>\n\n\t<appender name=\"LogFile\" class=\"org.apache.log4j.RollingFileAppender\">\n\t\t<param name=\"File\" value=\"../logs/default.log\"/>\n\t\t<param name=\"MaxFileSize\" value=\"1024KB\"/>\n\t\t<param name=\"MaxBackupIndex\" value=\"10\"/>\n\t\t<layout class=\"org.apache.log4j.PatternLayout\">\n\t\t\t<param name=\"ConversionPattern\" value=\"%d{ISO8601} [%-5p] [%t] [%c] [%x] [%M]: %m%n\"/>\n\t\t</layout>\n\t</appender>\n\n\t<appender name=\"AsyncConsole\" class=\"org.apache.log4j.AsyncAppender\">\n\t\t <appender-ref ref=\"Console\"/>\n\t</appender>\n\n\t<appender name=\"AsyncLogFile\" class=\"org.apache.log4j.AsyncAppender\">\n\t \t<appender-ref ref=\"LogFile\"/>\n\t</appender>\n\n\n\t<!-- Tests -->\n\t<appender name=\"ViasTestsLogFile\" class=\"org.apache.log4j.RollingFileAppender\">\n\t\t<param name=\"File\" value=\"../logs/tests.log\"/>\n\t\t<param name=\"MaxFileSize\" value=\"1024KB\"/>\n\t\t<param name=\"MaxBackupIndex\" value=\"10\"/>\n\t\t<layout class=\"org.apache.log4j.PatternLayout\">\n\t\t\t<param name=\"ConversionPattern\" value=\"%d{ISO8601} [%-5p] [%t] [%c] [%x] [%M]: %m%n\"/>\n\t\t</layout>\n\t</appender>\n\n\t<!-- Tests -->\n\t<appender name=\"AsyncViasTestsLogFile\" class=\"org.apache.log4j.AsyncAppender\">\n\t\t<appender-ref ref=\"ViasTestsLogFile\"/>\n\t</appender>\n\n\t<!-- *************** -->\n\t<!-- * Categories: * -->\n\t<!-- *************** -->\n\n\t<!-- Tests -->\n\t<category name=\"test\" additivity=\"false\">\n\t\t<priority value=\"debug\"/>\n\t\t<appender-ref ref=\"AsyncViasTestsLogFile\"/>\n\t</category>\n\n\t<!-- Default -->\n\t<root>\n\t\t<priority value =\"debug\"/>\n   \t\t<appender-ref ref=\"AsyncLogFile\"/>\n\t</root>\n</log4j:configuration>\n------------End of configuration-----------------", "is_private": false, "bug_id": 45128, "id": 117333, "time": "2008-06-04T04:30:35Z", "creator": "haim.sulam@gmail.com", "creation_time": "2008-06-04T04:30:35Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "haim.sulam@gmail.com", "attachment_id": null, "id": 117334, "time": "2008-06-04T04:39:37Z", "bug_id": 45128, "creation_time": "2008-06-04T04:39:37Z", "is_private": false, "text": "The log output:\n\n2008-06-04 14:24:45,211 [DEBUG] [main] [test.Log4JTest] [] [?]: Hello World\n"}, {"count": 2, "tags": [], "creator": "carnold@apache.org", "attachment_id": null, "id": 117346, "time": "2008-06-04T08:07:41Z", "bug_id": 45128, "creation_time": "2008-06-04T08:07:41Z", "is_private": false, "text": "That is as designed and documented, if you want to collect location information with an AsyncAppender, you must specify locationInfo as true, like:\n\n\n        <appender name=\"AsyncConsole\" class=\"org.apache.log4j.AsyncAppender\">\n                 <appender-ref ref=\"Console\"/>\n                  <param name=\"locationInfo\" value=\"true\"/>\n        </appender>\n\nCollecting location information is expensive and is generally only done on demand, but has to be done on the same thread as the original call."}]