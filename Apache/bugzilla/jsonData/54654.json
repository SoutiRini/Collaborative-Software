[{"count": 0, "tags": [], "creator": "CarlVolhard@web.de", "text": "I want to open read a workbook from a file and then safe it back to this file.\n\nWorkbook wb = WorkbookFactory.create(\"file.xlsx\");\nFileOutputStream fileOut = new FileOutputStream(\"file.xlsx\");\nwb.write(fileOut);\nfileOut.close();\n\nthrows:\nException in thread \"main\" org.apache.poi.POIXMLException: java.io.IOException: Can't obtain the input stream from /docProps/app.xml\n\tat org.apache.poi.POIXMLDocument.getProperties(POIXMLDocument.java:141)\n\tat org.apache.poi.POIXMLDocument.write(POIXMLDocument.java:177)\n\tat line wb.write(fileOut)\nCaused by: java.io.IOException: Can't obtain the input stream from /docProps/app.xml\n\tat org.apache.poi.openxml4j.opc.PackagePart.getInputStream(PackagePart.java:500)\n\tat org.apache.poi.POIXMLProperties.<init>(POIXMLProperties.java:75)\n\tat org.apache.poi.POIXMLDocument.getProperties(POIXMLDocument.java:139)\n\t... 2 more", "id": 165717, "time": "2013-03-08T11:50:56Z", "bug_id": 54654, "creation_time": "2013-03-08T11:50:56Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "text": "Windows is fussy about reading and writing to the same file, so that might be it. Does it work if you save to a different file name? Does it work if you try it on linux?", "is_private": false, "bug_id": 54654, "id": 165718, "time": "2013-03-08T12:12:21Z", "creator": "apache@gagravarr.org", "creation_time": "2013-03-08T12:12:21Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "CarlVolhard@web.de", "attachment_id": null, "id": 165772, "time": "2013-03-12T13:14:56Z", "bug_id": 54654, "creation_time": "2013-03-12T13:14:56Z", "is_private": false, "text": "Yes it works, if I take another filename. The program runs under windows, so i didn't try it on a linux system.\nIs using a different file for writing the recommended way? Then it should be descriped in the docs."}, {"count": 3, "tags": [], "creator": "apache@gagravarr.org", "text": "It's a standard restriction on windows, nothing POI specific. You'll either need to use a 2nd file, or close the original one before trying to write out to it. Or switch to an OS without the restrictions!", "id": 165773, "attachment_id": null, "bug_id": 54654, "creation_time": "2013-03-12T17:43:48Z", "time": "2013-03-12T17:43:48Z", "is_private": false}, {"count": 4, "tags": [], "text": "Shouldn't a Java program run on all OSs?\n\nCan you give me some example code for opening a workbook from an existing file and writing into to it on windows?\n\nThanks!", "is_private": false, "bug_id": 54654, "id": 165981, "time": "2013-03-19T08:14:56Z", "creator": "CarlVolhard@web.de", "creation_time": "2013-03-19T08:14:56Z", "attachment_id": null}, {"count": 5, "tags": [], "text": "Well written Java programs can run anywhere, but there remain a few platform specific ways you can shoot yourself in the foot...\n\nOn Windows, you either need to full close the input stream *before* trying to open it again for writing, or you need to write to another file.", "is_private": false, "bug_id": 54654, "id": 165987, "time": "2013-03-19T11:03:40Z", "creator": "apache@gagravarr.org", "creation_time": "2013-03-19T11:03:40Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 54654, "is_private": false, "text": "Thanks. Got it working.\nAn example for Windows in your HOWTO could be helpful.", "id": 166025, "time": "2013-03-20T09:28:53Z", "creator": "CarlVolhard@web.de", "creation_time": "2013-03-20T09:28:53Z", "attachment_id": null}, {"count": 7, "tags": [], "text": "Send in the text and we'll add it!", "is_private": false, "bug_id": 54654, "id": 166030, "time": "2013-03-20T11:17:55Z", "creator": "apache@gagravarr.org", "creation_time": "2013-03-20T11:17:55Z", "attachment_id": null}]