[{"count": 0, "attachment_id": null, "creator": "jrhodes@jernberg.com", "is_private": false, "id": 116612, "time": "2008-05-14T08:36:09Z", "bug_id": 44997, "creation_time": "2008-05-14T08:36:09Z", "tags": [], "text": "Placing a cell range in a formula results in a #VALUE! in the excel sheet if the range rows differ. For example,\n\n\"SUM(G22:G22)\" evaluates properly by summing the contents of cell G22\n\"SUM(G22:G28)\" results in a #VALUE! in the excel document.\n\nThis functionality worked fine as of poi-bin-3.0.1-FINAL-20070705, but does not work in poi-3.1-beta1.\n\nA sample code snippet that sets the formula contents can be found below:\n\n\nHSSFCellStyle summaryDataStyle = wb.createCellStyle();\nsummaryDataStyle.setAlignment(HSSFCellStyle.ALIGN_RIGHT);\nsummaryDataStyle.setFont(summaryItemFont);\nsummaryDataStyle.setDataFormat((short) 3);\n\n...\n\nHSSFCell currentCell = row.createCell((short)columnIndex++);\ncurrentCell.setCellStyle(summaryDataStyle);\t\t\t\tcurrentCell.setCellType(HSSFCell.CELL_TYPE_FORMULA);\t\t \t\tcurrentCell.setCellFormula(\"SUM(G\"+(previousItemStartRow+1)+\":G\"+row.getRowNum()+\")\");\n\nwhere previousItemStartRow is an int.\n\nVery strange that it evaluates correctly for a range that resolves to a single cell, but not for a real range of cells. Again, the EXACT same code works fine under the above 3.0 release."}, {"count": 1, "attachment_id": null, "creator": "jrhodes@jernberg.com", "text": "Note that SUM(G7,G8) Works fine as well", "id": 116613, "time": "2008-05-14T09:00:41Z", "bug_id": 44997, "creation_time": "2008-05-14T09:00:41Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "text": "Reproduced in 3.1-beta1\n\nThis problem was resolved in the follow-up fix for bug 44675 (svn r652994).\n\nYou can either use the latest svn trunk or wait for final 3.1 to get this fix.", "is_private": false, "bug_id": 44997, "id": 116615, "time": "2008-05-14T10:26:56Z", "creator": "josh@apache.org", "creation_time": "2008-05-14T10:26:56Z", "attachment_id": null}]