[{"count": 0, "tags": [], "bug_id": 56294, "attachment_id": null, "text": "I am trying to open a workbook in an XLSX format in order to parse it and retrieve certain elements from certain cells. The file is provided by a customer. Please find (a modified version of) the file attached. I am able to open the file directly in Excel, but not in POI.\n\nI'm running Java version jdk1.6.0_23 and have installed version 3.10 of the POI library package.\n\nWhen attempting to parse the file using \"org.apache.poi.xssf.usermodel.XSSFWorkbook\", Memory usage jumps from under 200KB to over 1.1GB. The CPU also jumps to 100% capacity.\n\nThe program then stalls and does not recover. The Debug window in Eclipse shows a large number (380) of Threads as \"Running\".\n\nI would really appreciate it if you could investigate the cause behind this issue.\n\nThanks in advance,\nEamonn.\n\nP.s. I looked at bug 55769, but we do not get any error message - Java just hangs...", "id": 173972, "time": "2014-03-20T12:17:33Z", "creator": "eamonny@thyme-it.ie", "creation_time": "2014-03-20T12:17:33Z", "is_private": false}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 173974, "time": "2014-03-20T13:11:00Z", "bug_id": 56294, "creation_time": "2014-03-20T13:11:00Z", "is_private": false, "text": "Can you try bumping up the heap size more, to see if that helps?\n\nCan you run the jvm so it reports when it does garbage collection, so you can see if the hang is due to terminal-GC or something else?\n\nIf you take a thread dump, what are the threads doing when it hangs?"}, {"count": 2, "text": "(In reply to Nick Burch from comment #1)\n> Can you try bumping up the heap size more, to see if that helps?\n> \n> Can you run the jvm so it reports when it does garbage collection, so you\n> can see if the hang is due to terminal-GC or something else?\n> \n> If you take a thread dump, what are the threads doing when it hangs?\n\nNick,\n\nThanks a million for your swift response. We increased the heap size and that allows us to process the file. So thanks for the suggestion. It is slow, but it gets there.\n\nThanks again,\nEamonn.", "bug_id": 56294, "is_private": false, "id": 174000, "time": "2014-03-21T16:51:40Z", "creator": "eamonny@thyme-it.ie", "creation_time": "2014-03-21T16:51:40Z", "tags": [], "attachment_id": null}, {"count": 3, "tags": [], "text": "OK, that's good. Next thing to check - is the problem with your code or file?\n\nThere's two example programs that can be used to check generation speed and reading speed, try using SSPerformanceTest to check how long to generate a simple file of your desired size. Next check if your program can load it quicker or not. Now, use XLSX2CSV to read both your file and your generated test file - how slow/quick, and are they about the same speed?", "attachment_id": null, "bug_id": 56294, "id": 174001, "time": "2014-03-21T17:07:26Z", "creator": "apache@gagravarr.org", "creation_time": "2014-03-21T17:07:26Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 56294, "attachment_id": null, "text": "Hi,\n\nWe encountered the same behavior, 25 MB file with 382K rows and 15 columns each.\n\nanything lower than that and we get OOM exception.\n\nWe are using POI-3.10-FINAL on JDK 7 with the latest patch.\n\nPlease advise.\n\nThank you,\nArik", "id": 174105, "time": "2014-03-26T13:39:19Z", "creator": "ariky@hp.com", "creation_time": "2014-03-26T13:39:19Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 56294, "attachment_id": null, "id": 174106, "time": "2014-03-26T13:52:17Z", "creator": "apache@gagravarr.org", "creation_time": "2014-03-26T13:52:17Z", "is_private": false, "text": "Have you tried following the suggestions/strategy from the FAQ entry \"I think POI is using too much memory! What can I do?\" ?\nhttp://poi.apache.org/faq.html#faq-N10109"}, {"count": 6, "tags": [], "creator": "kiwiwings@apache.org", "attachment_id": null, "id": 177561, "time": "2014-09-05T18:56:48Z", "bug_id": 56294, "creation_time": "2014-09-05T18:56:48Z", "is_private": false, "text": "There was no feedback over the last 5 month, so I'm closing this now.\nWe can re-open it later anyways ..."}]