[{"attachment_id": 22435, "tags": [], "creator": "dgoldenberg@attivio.com", "text": "Created attachment 22435\nSimple Word doc with headers and footers.\n\nThere are several issues with the header/footer extraction for Word as it is implemented now.\n\n1. The newly added methods are on WordExtractor as follows:\npublic String getHeaderText()\npublic String getFooterText()\n\nThese methods do not account for the use-case of headers/footers defined differently for odd vs. even pages in Word.\n\nI propose a different model:\n\nHWPFHeader header = extractor.getHeader();\nString oddHeader = header.getOddHeader();\nString evenHeader = header.getEvenHeader();\n\nHWPFFooter footer = extractor.getFooter();\nString oddFooter = footer.getOddFooter();\nString evenFooter = footer.getEvenFooter();\n\nThis will be adequate to the Word's model and in line with the model adopted in the Excel header/footer extraction code:\n\nHSSFHeader header = sheet.getHeader();\nString leftHeader = header.getLeft();\nString centerHeader = header.getCenter();\nString rightHeader = header.getRight();\n\n2. The second issue is macros. You can define macros in headers and footers and currently they show up in the extracted text. For example, in the attached file HeadersFooters2.doc, the Author field was used in the header, and the string \"AUTHOR\" gets returned. It would be great if the headers/footers would only return the actual text and never the macros, or if the methods had a boolean flag to strip off the macros.\n\nFor example, for the attached HeadersFooters2.doc, the following gets returned:\n\nHEADER GOES HERE. 8/12/2008 \u0013 AUTHOR \\* MERGEFORMAT \u0014Eric Roch\n\nIt would be great if the returned text was simply:\n\nHEADER GOES HERE. 8/12/2008 Eric Roch\n\nIn the interest of being generic, a flag for stripping off this extra markup is probably best.", "count": 0, "id": 119744, "time": "2008-08-12T11:13:21Z", "bug_id": 45622, "creation_time": "2008-08-12T11:13:21Z", "is_private": false}, {"attachment_id": 22436, "tags": [], "bug_id": 45622, "text": "Created attachment 22436\nWord doc with some macros used in its header.", "count": 1, "id": 119745, "time": "2008-08-12T11:15:01Z", "creator": "dgoldenberg@attivio.com", "creation_time": "2008-08-12T11:15:01Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "dgoldenberg@attivio.com", "is_private": false, "count": 2, "id": 119749, "time": "2008-08-12T11:59:26Z", "bug_id": 45622, "creation_time": "2008-08-12T11:59:26Z", "text": "Per Nick's comments -- found the HeaderStories object. We only need to look into the macros now. Disregard my comment about getHeaderText/getFooterText."}, {"count": 3, "tags": [], "text": "I've just added field (eg macro) stripping to HWPF. This is a static method on Range, Range.stripFields()\n\nIn addition, HeaderStores has an option to always strip out fields from text returned (off by default). With this turned on, the header given on your test document is as one would expect", "is_private": false, "bug_id": 45622, "id": 119753, "time": "2008-08-12T12:58:17Z", "creator": "apache@gagravarr.org", "creation_time": "2008-08-12T12:58:17Z", "attachment_id": null}]