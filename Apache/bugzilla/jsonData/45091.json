[{"count": 0, "tags": [], "bug_id": 45091, "text": "Created attachment 22027\nSample excel spreadsheet that causes problem\n\nI have created a new workbook using Excel 2000.  I pick a cell, say C3, and apply custom data validation to it using the following formula\n\n=UPPER(C3)=\"X\"\n\nso that users can only enter x into the cell.  I then saved the workbook.\n\nIf I then read in the workbook into an HSSFWorkbook and then save it again the formula changes to\n\n=UPPER(A1)=\"X\"\n\nIf the formula is changed to\n\n=UPPER($C$3)=\"X\" then the formula is not changed when the workbook is loaded into the HSSFWorkbook object.\n\nI have seen this bug with the latest beta 3 build of poi (poi-3.1-beta3-20080529).", "id": 117099, "time": "2008-05-29T01:26:31Z", "creator": "rscsea73@live.co.uk", "creation_time": "2008-05-29T01:26:31Z", "is_private": false, "attachment_id": 22027}, {"count": 1, "tags": [], "bug_id": 45091, "text": "More problems following on from bug 44921.  tRefNV is being re-written as tRefN.\nIt might be time to correct the class hierarchy of ReferncePtg and RefN~Ptg.", "id": 117138, "time": "2008-05-29T09:27:27Z", "creator": "josh@apache.org", "creation_time": "2008-05-29T09:27:27Z", "is_private": false, "attachment_id": null}, {"count": 2, "attachment_id": null, "bug_id": 45091, "text": "Fixed in svn r664220.\n\nThis involved significant restructuring of the Ptg class hierarchy for a few purposes:\n  - to stop instantiating superclasses\n  - to combine the subclasses that were distinguished by 'operand class' only.  That structure did not make sense in the presence of the Ptg.setClass() method.\n  - general clean-up of much dead/duplicated code.\nSome previous bugs (bug 44636, bug 44921) have also provided incentive for these changes.\n", "id": 117452, "time": "2008-06-06T18:08:06Z", "creator": "josh@apache.org", "creation_time": "2008-06-06T18:08:06Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "creator": "josh@apache.org", "attachment_id": null, "id": 117822, "time": "2008-06-19T09:23:02Z", "bug_id": 45091, "creation_time": "2008-06-19T09:23:02Z", "is_private": false, "text": "*** Bug 45233 has been marked as a duplicate of this bug. ***"}]