[{"count": 0, "tags": [], "text": "CommentsTable.getCTComment() always goes over all comments. Run time is O(n^2).\nIn large Excel file when checking if cell has warning a total time that spent in this method can take many minutes.\nBy keeping the table in Map<String, CTComment> where key is comment.getRef() the run time imporved dramatically.\nAlso in XSSFSheet.read() method inside condition \"if(p instanceof CommentsTable)\" there is no \"break\" which should stop unnecessary processing.", "attachment_id": null, "id": 137596, "creator": "alexkra@amdocs.com", "time": "2010-06-13T08:32:02Z", "bug_id": 49432, "creation_time": "2010-06-13T08:32:02Z", "is_private": false}, {"count": 1, "tags": [], "text": "We can't simply keep a map, we also need to take steps to keep it in sync as the comment references are updated, which means rippling up to the XSSFComment level\n\nI've implemented lazy caching in r954521, which should hopefully sort it for you.", "attachment_id": null, "id": 137623, "creator": "apache@gagravarr.org", "time": "2010-06-14T11:44:34Z", "bug_id": 49432, "creation_time": "2010-06-14T11:44:34Z", "is_private": false}]