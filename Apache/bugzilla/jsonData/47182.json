[{"count": 0, "tags": [], "bug_id": 47182, "attachment_id": null, "text": "I need the UserStyleName of a cell. But when i call getUserName(), it always returns null.\n\n\t// used version: poi-3.5-beta5, jdk1.6.0_04, excel 97\n\tFileInputStream input= new FileInputStream(filename);\n\tHSSFWorkbook worksheet= new HSSFWorkbook(input);\n\tHSSFSheet sheet = worksheet.getSheetAt(0);\n\tHSSFRow row = sheet.getRow(0);\n\tHSSFCell cellBeobachtung= row.getCell(0);\n\tHSSFCellStyle cellStyleBeobachtung= cellBeobachtung.getCellStyle();\n\tSystem.out.println(\"cellStyleBeobachtung, user name: \" + cellStyleBeobachtung.getUserStyleName());\n\n\nAfter putting some effort in it, I figured out, that the StyleRecord is correctly constructed (number 231 in the records array). But the xf reference number is 63 which is a dummy value, indicating that the reference is stored elsewhere:\n\n   OpenOffice, Microsoft Excel File Format, Chapter 2.5.13 Cell Attributes (BIFF2)\n   <snip>\n   If a real XF index greater than 62 is used, the XF index field always contains the value 63, and an\nIXFE record (\u279c5.62) occurs in front of a cell record. The IXFE record contains the correct index of the XF record.\n   <snip>\n\n\nThe method to get the appropriate UserStyleName has two problems. On the one hand it assumes that all StyleRecords follow directly after the ExtendenFormatRecords. But there are heaps of UnknownRecords in between the StyleRecords.\nOn the other hand are the xf reference numbers which have to treat the number 63 in a different way.\n\n\nFor my excel files, the values are stored in MulRKRecord, there the xf value is 63 (dummy value) and the rk value is 1083088896. Does anybody know what this rk value means. Can I navigate with this rk value to the StyleRecord?\n\n(I will attach the java source, excel file and 2 printscreens later, since my internet access is restricted at this place.)", "id": 126938, "time": "2009-05-11T06:45:07Z", "creator": "pinkOtter@gmx.ch", "creation_time": "2009-05-11T06:45:07Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 47182, "attachment_id": 23644, "text": "Created attachment 23644\nExcelBeobachtung.java - the source code", "id": 126945, "time": "2009-05-11T10:53:18Z", "creator": "pinkOtter@gmx.ch", "creation_time": "2009-05-11T10:53:18Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 47182, "attachment_id": 23645, "is_private": false, "id": 126946, "time": "2009-05-11T10:54:22Z", "creator": "pinkOtter@gmx.ch", "creation_time": "2009-05-11T10:54:22Z", "text": "Created attachment 23645\nexcel file"}, {"attachment_id": 23646, "tags": [], "bug_id": 47182, "text": "Created attachment 23646\nscreen shot from debugger\n\nThis screenshot shows the code snippet which fails to find the StyleRecord (with the name Beobachtung). The StyleRecord is selected in the variables view, it exists, but the method won't find it.", "count": 3, "id": 126947, "time": "2009-05-11T10:59:48Z", "creator": "pinkOtter@gmx.ch", "creation_time": "2009-05-11T10:59:48Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 47182, "attachment_id": null, "text": "In your case the user style is a parent of the cell style. The correct code to check UserStyleName is below:\n\n        HSSFCellStyle style = cell.getCellStyle();\n        if(style.getParentStyle() != null){\n            HSSFCellStyle  parentStyle = style.getParentStyle();\n            String styleName = parentStyle.getUserStyleName();\n        }\n\nYegor", "id": 147495, "time": "2011-06-25T13:07:01Z", "creator": "yegor@dinom.ru", "creation_time": "2011-06-25T13:07:01Z", "is_private": false}]