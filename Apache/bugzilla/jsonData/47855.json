[{"count": 0, "tags": [], "bug_id": 47855, "is_private": false, "id": 130470, "creation_time": "2009-09-16T17:33:18Z", "time": "2009-09-16T17:33:18Z", "creator": "kevinrmckee@hotmail.com", "text": "+++ This bug was initially created as a clone of Bug #47747 +++\n\nsince nobody in the community will respond to my comments in bug 47747, perhaps a new bug entry will warrant a reply?\n\nCreated an attachment (id=24176)\nThis zip contains the original and processed spreadsheets.\n\nI have tried version 3.5, 3.6 and 3.7.\n\nWhen trying to run the following code to go through a spreadsheet and update\nthe formula values, I get several errors (java.lang.RuntimeException: Shared\nFormula Conversion: Coding Error).  When I open the newly created spreadsheet,\nseveral cells have #REF issues.  I will attach the original and processed\nspreadsheets.\n\npublic static void RecalculateFormulas(String filename) throws\nFileNotFoundException, IOException\n    {   try{\n        FileInputStream fis = new FileInputStream(filename);\n        FileOutputStream out = new\nFileOutputStream(filename.replaceAll(\".xls\",\"temp.xls\"));\n        HSSFWorkbook wb = new HSSFWorkbook(fis); //or new\nXSSFWorkbook(\"/somepath/test.xls\")\n        FormulaEvaluator evaluator =\nwb.getCreationHelper().createFormulaEvaluator();\n        for(int sheetNum = 0; sheetNum < wb.getNumberOfSheets(); sheetNum++) {\n            org.apache.poi.ss.usermodel.Sheet sheet = wb.getSheetAt(sheetNum);\n            for(org.apache.poi.ss.usermodel.Row r : sheet) {\n                for(org.apache.poi.ss.usermodel.Cell c : r) {\n                    if(c.getCellType() ==\norg.apache.poi.ss.usermodel.Cell.CELL_TYPE_FORMULA) {\n                        try{evaluator.evaluateFormulaCell(c);}\n                        catch(Exception e)\n                        {System.out.println(e.toString());}\n                    }\n                }\n            }\n        }\n        wb.write(out);\n        out.close();\n        }\n        catch(Exception e)\n        {System.out.println(e.toString());\n        }\n    }", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 47855, "is_private": false, "id": 130472, "creation_time": "2009-09-16T20:11:01Z", "time": "2009-09-16T20:11:01Z", "creator": "dfisher@jmlafferty.com", "text": "I don't think you will help your cause by duplicating an issue. The original issue and offered patch was less than three weeks ago.\n\nYou might have noticed if you are subscribed to the dev list that core developers are applying patches in the last week. I think you would do better by asking a question as an email on the dev list.\n\nRegards,\nDave\n\n*** This bug has been marked as a duplicate of bug 47747 ***", "attachment_id": null}]