[{"count": 0, "attachment_id": null, "creator": "asf+paul@kungfoocoder.org", "is_private": false, "id": 199269, "time": "2017-06-18T20:42:34Z", "bug_id": 61196, "creation_time": "2017-06-18T20:42:34Z", "tags": [], "text": "Currently when using the classfileset task, it can fail with the following message:\n\norg.apache.bcel.classfile.ClassFormatException: Invalid byte tag in constant pool: 18\n\tat org.apache.bcel.classfile.Constant.readConstant(Constant.java:146)\n\tat org.apache.bcel.classfile.ConstantPool.<init>(ConstantPool.java:67)\n\tat org.apache.bcel.classfile.ClassParser.readConstantPool(ClassParser.java:222)\n\tat org.apache.bcel.classfile.ClassParser.parse(ClassParser.java:136)\n\tat org.apache.tools.ant.util.depend.bcel.FullAnalyzer.determineDependencies(FullAnalyzer.java:95)\n\tat org.apache.tools.ant.util.depend.AbstractAnalyzer.getClassDependencies(AbstractAnalyzer.java:99)\n\tat org.apache.tools.ant.types.optional.depend.DependScanner.scan(DependScanner.java:120)\n\tat org.apache.tools.ant.types.optional.depend.ClassfileSet.getDirectoryScanner(ClassfileSet.java:141)\n\tat org.apache.tools.ant.taskdefs.Zip.grabResources(Zip.java:1581)\n\tat org.apache.tools.ant.taskdefs.Zip.getResourcesToAdd(Zip.java:1320)\n\tat org.apache.tools.ant.taskdefs.Zip.getResourcesToAdd(Zip.java:1254)\n\tat org.apache.tools.ant.taskdefs.Jar.getResourcesToAdd(Jar.java:880)\n\tat org.apache.tools.ant.taskdefs.Zip.executeMain(Zip.java:640)\n\tat org.apache.tools.ant.taskdefs.Zip.execute(Zip.java:592)\n\tat org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:292)\n\tat sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)\n\tat org.apache.tools.ant.Task.perform(Task.java:348)\n\tat org.apache.tools.ant.Target.execute(Target.java:435)\n\tat org.apache.tools.ant.Target.performTasks(Target.java:456)\n\tat org.apache.tools.ant.Project.executeSortedTargets(Project.java:1393)\n\tat org.apache.tools.ant.Project.executeTarget(Project.java:1364)\n\tat org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n\tat org.apache.tools.ant.Project.executeTargets(Project.java:1248)\n\tat org.apache.tools.ant.Main.runBuild(Main.java:851)\n\tat org.apache.tools.ant.Main.startAnt(Main.java:235)\n\tat org.apache.tools.ant.launch.Launcher.run(Launcher.java:280)\n\tat org.apache.tools.ant.launch.Launcher.main(Launcher.java:109)\n\n\nThe root cause of the problem is that it doesn't know how to handle the INVOKEDYNAMIC tag, as support for this was added in 6.0, and ant still ships with BCEL 5.2.\n\nUpdating to BCEL 6.0 would likely solve this issue."}, {"text": "I've just updated the dependency to 6.0 in master.\n\nWe don't ship BCEL, so you must have installed it yourself. It should be possible to simply replace the BCEL jar without updating Ant itself.", "tags": [], "bug_id": 61196, "attachment_id": null, "count": 1, "id": 199965, "time": "2017-07-23T15:52:18Z", "creator": "bodewig@apache.org", "creation_time": "2017-07-23T15:52:18Z", "is_private": false}]