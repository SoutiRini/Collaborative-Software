[{"count": 0, "attachment_id": null, "bug_id": 43356, "is_private": false, "id": 108037, "time": "2007-09-11T11:42:39Z", "creator": "plynch@apache.org", "creation_time": "2007-09-11T11:42:39Z", "tags": [], "text": "This issue is virtually the same symptoms as http://issues.apache.org/bugzilla/\nshow_bug.cgi?id=27050 except that it is with \norg.apache.tomcat.util.net.NioEndpoint.java instead of JSSESocketFactory\n\n----\nThe docs state \"keystoreFile - Add this attribute if the keystore file you \ncreated is not in the default place that Tomcat expects (a file named .keystore \nin the user home directory under which Tomcat is running). You can specify an \nabsolute pathname, or a relative pathname that is resolved against the \n$CATALINA_BASE environment variable.\"\n\nRelative paths don't work though with NioConnector. Here is the problem code in \nNioEndPoint starting line 744:\n\n// Initialize SSL if needed\n        if (isSSLEnabled()) {\n            // Initialize SSL\n            char[] passphrase = getKeystorePass().toCharArray();\n\n            KeyStore ks = KeyStore.getInstance(getKeystoreType());\n            ks.load(new FileInputStream(getKeystoreFile()), passphrase);\n            KeyStore ts = KeyStore.getInstance(getKeystoreType());\n            ts.load(new FileInputStream(getKeystoreFile()), passphrase);\n\n\nAs you can see $CATALINA_BASE is not taken into account at all and therefore we \nget something like this on startup:\n\n[] 2007-09-11 14:38:20,828 ERROR \norg.apache.coyote.http11.Http11NioProtocol.start(168) | Error starting endpoint\njava.net.BindException: Address already in use: bind\n        at sun.nio.ch.Net.bind(Native Method)\n        at \nsun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:119)\n        at sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:59)\n        at org.apache.tomcat.util.net.NioEndpoint.init(NioEndpoint.java:731)\n        at org.apache.tomcat.util.net.NioEndpoint.start(NioEndpoint.java:779)\n        at \norg.apache.coyote.http11.Http11NioProtocol.start(Http11NioProtocol.java:166)\n        at org.apache.catalina.connector.Connector.start(Connector.java:1132)\n        at \norg.apache.catalina.core.StandardService.start(StandardService.java:531)\n        at \norg.apache.catalina.core.StandardServer.start(StandardServer.java:710)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:566)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at \nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at \nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:413)\n\n\nAlso I am curious why the keystoreFile is being used as the truststoreFile?\n\nAlso found this against version 6.0.13, not 6.0.9 ( although it may be in 6.0.9 \ntoo)."}, {"count": 1, "attachment_id": null, "bug_id": 43356, "is_private": false, "id": 108045, "time": "2007-09-11T20:42:20Z", "creator": "plynch@apache.org", "creation_time": "2007-09-11T20:42:20Z", "tags": [], "text": "Oops pasted wrong exception. Here is the correct one:\n\n-----\n[] 2007-09-11 14:38:19,406 ERROR \norg.apache.catalina.startup.Catalina.load(520) | Catalina.start\nLifecycleException:  Protocol handler initialization failed: \njava.io.FileNotFoundException: conf\\dev.keystore (The system cannot find the \npath specified)\n        at \norg.apache.catalina.connector.Connector.initialize(Connector.java:1061)\n        at \norg.apache.catalina.core.StandardService.initialize(StandardService.java:677)\n        at \norg.apache.catalina.core.StandardServer.initialize(StandardServer.java:792)\n        at org.apache.catalina.startup.Catalina.load(Catalina.java:518)\n        at org.apache.catalina.startup.Catalina.load(Catalina.java:538)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at \nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at \nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.apache.catalina.startup.Bootstrap.load(Bootstrap.java:260)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:412)"}, {"attachment_id": null, "tags": [], "bug_id": 43356, "is_private": false, "count": 2, "id": 108099, "time": "2007-09-12T17:13:49Z", "creator": "fhanik@apache.org", "creation_time": "2007-09-12T17:13:49Z", "text": "thanks for reporting it, I will get that taken care of"}, {"count": 3, "tags": [], "creator": "hauser@acm.org", "is_private": false, "text": "see also bug 27050 ", "id": 116480, "time": "2008-05-11T06:19:25Z", "bug_id": 43356, "creation_time": "2008-05-11T06:19:25Z", "attachment_id": null}]