[{"count": 0, "tags": [], "bug_id": 60440, "attachment_id": null, "text": "I have mod_dbd set up to talk to a PostgreSQL database. This works, albeit not doing anything useful:\n\nRewriteMap mymap \"dbd:SELECT %s\"\nRewriteRule ^/(.*)$ /${mymap:$1} [R]\n\nThis fails, indicating that every request failed SQL map lookup:\n\nRewriteMap myMap \"dbd:SELECT %s\"\nRewriteRule ^/(.*)$ /${myMap:$1} [R]\n\nThe documentation does not say that map names have to be all-lowercase, but it seems they do, at least in the dbd-PostgreSQL case.", "id": 195353, "time": "2016-12-04T23:43:44Z", "creator": "chead@chead.ca", "creation_time": "2016-12-04T23:43:44Z", "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 60440, "is_private": false, "id": 195521, "time": "2016-12-16T15:30:24Z", "creator": "rbowen@apache.org", "creation_time": "2016-12-16T15:30:24Z", "tags": [], "text": "Can you please provide all of the relevant/related log file entries go to along with this? Thanks."}, {"count": 2, "tags": [], "creator": "chead@chead.ca", "text": "Here are some log lines taken with rewrite:trace8 for a request to https://test.example.com/test.html (I anonymized the server name and my own client IP address, but nothing else has been changed) using an all-lowercase map, which succeeds (CURL indicates that a 302 is sent with the location /test.html, as expected):\n\n[Sat Dec 17 12:53:52.481799 2016] [rewrite:trace2] [pid 18625:tid 140248097462016] mod_rewrite.c(477): [client 123.123.123.123:42252] 123.123.123.123 - - [test.example.com/sid#a33370][rid#7f8df8012260/initial] init rewrite engine with requested uri /test.html\n[Sat Dec 17 12:53:52.481849 2016] [rewrite:trace3] [pid 18625:tid 140248097462016] mod_rewrite.c(477): [client 123.123.123.123:42252] 123.123.123.123 - - [test.example.com/sid#a33370][rid#7f8df8012260/initial] applying pattern '/(.*)$' to uri '/test.html'\n[Sat Dec 17 12:53:52.482238 2016] [rewrite:trace5] [pid 18625:tid 140248097462016] mod_rewrite.c(477): [client 123.123.123.123:42252] 123.123.123.123 - - [test.example.com/sid#a33370][rid#7f8df8012260/initial] SQL map lookup OK: map mymap key=test.html, val=test.html\n[Sat Dec 17 12:53:52.482262 2016] [rewrite:trace2] [pid 18625:tid 140248097462016] mod_rewrite.c(477): [client 123.123.123.123:42252] 123.123.123.123 - - [test.example.com/sid#a33370][rid#7f8df8012260/initial] rewrite '/test.html' -> '/test.html'\n[Sat Dec 17 12:53:52.482289 2016] [rewrite:trace2] [pid 18625:tid 140248097462016] mod_rewrite.c(477): [client 123.123.123.123:42252] 123.123.123.123 - - [test.example.com/sid#a33370][rid#7f8df8012260/initial] explicitly forcing redirect with https://test.example.com/test.html\n[Sat Dec 17 12:53:52.482305 2016] [rewrite:trace1] [pid 18625:tid 140248097462016] mod_rewrite.c(477): [client 123.123.123.123:42252] 123.123.123.123 - - [test.example.com/sid#a33370][rid#7f8df8012260/initial] escaping https://test.example.com/test.html for redirect\n[Sat Dec 17 12:53:52.482321 2016] [rewrite:trace1] [pid 18625:tid 140248097462016] mod_rewrite.c(477): [client 123.123.123.123:42252] 123.123.123.123 - - [test.example.com/sid#a33370][rid#7f8df8012260/initial] redirect to https://test.example.com/test.html [REDIRECT/302]\n\nHere are some log lines with mymap changed to myMap, which fails (CURL indicates that a 302 is sent but with location /):\n\n[Sat Dec 17 12:55:53.361498 2016] [rewrite:trace2] [pid 18735:tid 140247996299008] mod_rewrite.c(477): [client 123.123.123.123:42274] 123.123.123.123 - - [test.example.com/sid#a11140][rid#7f8df8012260/initial] init rewrite engine with requested uri /test.html\n[Sat Dec 17 12:55:53.361548 2016] [rewrite:trace3] [pid 18735:tid 140247996299008] mod_rewrite.c(477): [client 123.123.123.123:42274] 123.123.123.123 - - [test.example.com/sid#a11140][rid#7f8df8012260/initial] applying pattern '/(.*)$' to uri '/test.html'\n[Sat Dec 17 12:55:53.461887 2016] [rewrite:trace5] [pid 18735:tid 140247996299008] mod_rewrite.c(477): [client 123.123.123.123:42274] 123.123.123.123 - - [test.example.com/sid#a11140][rid#7f8df8012260/initial] SQL map lookup FAILED: map myMap key=test.html\n[Sat Dec 17 12:55:53.461907 2016] [rewrite:trace2] [pid 18735:tid 140247996299008] mod_rewrite.c(477): [client 123.123.123.123:42274] 123.123.123.123 - - [test.example.com/sid#a11140][rid#7f8df8012260/initial] rewrite '/test.html' -> '/'\n[Sat Dec 17 12:55:53.461923 2016] [rewrite:trace2] [pid 18735:tid 140247996299008] mod_rewrite.c(477): [client 123.123.123.123:42274] 123.123.123.123 - - [test.example.com/sid#a11140][rid#7f8df8012260/initial] explicitly forcing redirect with https://test.example.com/\n[Sat Dec 17 12:55:53.461938 2016] [rewrite:trace1] [pid 18735:tid 140247996299008] mod_rewrite.c(477): [client 123.123.123.123:42274] 123.123.123.123 - - [test.example.com/sid#a11140][rid#7f8df8012260/initial] escaping https://test.example.com/ for redirect\n[Sat Dec 17 12:55:53.461952 2016] [rewrite:trace1] [pid 18735:tid 140247996299008] mod_rewrite.c(477): [client 123.123.123.123:42274] 123.123.123.123 - - [test.example.com/sid#a11140][rid#7f8df8012260/initial] redirect to https://test.example.com/ [REDIRECT/302]\n\nHere is the contents of the relevant VirtualHost entry:\n\nServerAdmin webmaster@example.com\n\nDocumentRoot \"/var/www/test.example.com/htdocs\"\n<Directory /var/www/test.example.com/htdocs>\n        Require all granted\n</Directory>\n\nDBDriver pgsql\nDBDParams \"postgresql://apache@/mydb\"\n\nRewriteEngine on\nRewriteMap mymap \"dbd:SELECT %s\"\nRewriteRule \"/(.*)$\" /${mymap:$1} [R]\nLogLevel rewrite:trace8", "id": 195533, "time": "2016-12-17T20:59:59Z", "bug_id": 60440, "creation_time": "2016-12-17T20:59:59Z", "is_private": false, "attachment_id": null}]