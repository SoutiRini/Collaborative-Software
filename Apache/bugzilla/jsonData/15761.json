[{"count": 0, "tags": [], "text": "I searched the bug database but could not find a similar entry.\n\nMy problem is as follows:\n\nI am using FreeBSD 4.7. I compiled apache 2.0.43 out of the box (without\nany patches) with MPM set to 'prefork'. Compilation works and its also\nno problem to start the daemon.\n\nAfter that I run siege (I used 'ab' as well as a self-written tool with\nidentical results) on the apache. After 260 requests siege stopped working (it\nsleeped). I interrupted siege and tried it manually (telnet *.*.*.* 80\nGET /). apache still responded to my connection and it did also deliver\nthe / request. But it did not *close* the connection. I had to kill\nmy telnet session.\n\nMy next try was to compile apache as MPM worker. For this to work correctly\nI applied the patches of the apache 2.0.43 freebsd-port.\nBut the result is the very same. 260 requests are working then it stops\nclosing connections.", "is_private": false, "id": 28820, "creator": "tom@izb.net", "time": "2003-01-02T12:39:08Z", "bug_id": 15761, "creation_time": "2003-01-02T12:39:08Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "trawick@apache.org", "text": "For your prefork test, add --disable-threads to your configure invocation and\ntry again, then report back whether or not it is still a problem.\n\nmake distclean && ./configure --disable-threads --whatever-else && make && make\ninstall\n\nAnything thread-enabled with Apache or APR does not work reliably on FreeBSD.\n\nNote that www.apache.org runs on FreeBSD 4.7 24x7 with no reliability problems.\nBut it uses prefork MPM and --disable-threads.\n", "id": 30469, "time": "2003-02-01T13:52:05Z", "bug_id": 15761, "creation_time": "2003-02-01T13:52:05Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 15761, "attachment_id": null, "id": 30539, "time": "2003-02-03T08:32:39Z", "creator": "tom@izb.net", "creation_time": "2003-02-03T08:32:39Z", "is_private": false, "text": "In the meanwhile I found what has been the problem, and I can reproduce it:\n\nIn my config I had the following log-config entry:\n\nCustomLog |/usr/bin/ipwebcollect accounting\n\nThe script \"/usr/bin/ipwebcollect\" did not exist during my tries. In the error\nlog I found several (260 to be exact) entries that httpd could not find the program.\n\nIf I install the program or if I comment out the CustomLog line then the apache\nworks as expected.\n\nThis behavior could be re-produced with proforker and worker (it seems to be the\ngeneral behavior of apache, I think).\n\n\nTHe suggested fix would be to exit the httpd process if it cannot find a log\npipe program, or ot could just de-activate the log-pipe if it does not exist or\nis not executable.\n\n\nregards, Tom"}, {"count": 3, "tags": [], "text": "quick update:\nApache hangs once the pipe to the logger fills in each child process.\nApache 1.3 had the same problem, though something more helpful would be logged.\n\nSome small improvement has been committed, but some infrastructure (APR) changes\nare in the works to improve it beyond the way it worked in Apache 1.3.\n\none question for you:\nYou mentioned seeing the 260 error messages in the log.  I never saw messages in\nmy testing prior to some changes I committed a couple of days ago.  Can you\nupdate the PR with the text of those messages please?\n\nThanks!", "is_private": false, "bug_id": 15761, "id": 30815, "time": "2003-02-06T15:26:19Z", "creator": "trawick@apache.org", "creation_time": "2003-02-06T15:26:19Z", "attachment_id": null}, {"count": 4, "tags": [], "text": "Changes have been committed to Apache 2.1 (active development) to utilize new\nAPR features for finding process creation errors on Unix.  These changes keep\nApache from starting up if a piped log program doesn't exist or isn't executable.\n(There are some possible errors that are found out too late, but now they\nshould result in an error message.)\n\nI'll propose these changes for merging into Apache 2.0.x (stable tree).\n\nThanks for your report, and thanks for using Apache!\n", "is_private": false, "bug_id": 15761, "id": 31016, "time": "2003-02-10T16:33:24Z", "creator": "trawick@apache.org", "creation_time": "2003-02-10T16:33:24Z", "attachment_id": null}, {"count": 5, "tags": [], "text": "FYI...  the fix has been merged into the stable tree for\ninclusion in 2.0.45", "attachment_id": null, "id": 31322, "creator": "trawick@apache.org", "time": "2003-02-15T01:25:07Z", "bug_id": 15761, "creation_time": "2003-02-15T01:25:07Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 15761, "attachment_id": null, "id": 32648, "time": "2003-03-07T09:58:35Z", "creator": "lonewolf@greyskydesigns.com", "creation_time": "2003-03-07T09:58:35Z", "is_private": false, "text": "*** Bug 17764 has been marked as a duplicate of this bug. ***"}]