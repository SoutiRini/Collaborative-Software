[{"count": 0, "tags": [], "bug_id": 46944, "attachment_id": null, "id": 125905, "creation_time": "2009-03-31T07:05:08Z", "time": "2009-03-31T07:05:08Z", "creator": "criverapr@gmail.com", "text": "I get the following exception when trying to refresh all formulas on an excel sheet.  I've attached an excel sheet and a java file that produce the error.\n\n\njava.lang.RuntimeException: Error Value can only be 0,7,15,23,29,36 or 42. It cannot be -30\n\tat org.apache.poi.hssf.record.BoolErrRecord.setValue(BoolErrRecord.java:101)\n\tat org.apache.poi.hssf.usermodel.HSSFCell.setCellErrorValue(HSSFCell.java:750)\n\tat org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.setCellValue(HSSFFormulaEvaluator.java:222)\n\tat org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluateInCell(HSSFFormulaEvaluator.java:194)\n\tat com.tech_innovapr.poi.examples.UpdateFormulas.refreshWorkbookFormulas(UpdateFormulas.java:67)\n\tat com.tech_innovapr.poi.examples.UpdateFormulas.main(UpdateFormulas.java:25)", "is_private": false}, {"count": 1, "tags": [], "bug_id": 46944, "attachment_id": 23431, "id": 125906, "creation_time": "2009-03-31T07:06:02Z", "time": "2009-03-31T07:06:02Z", "creator": "criverapr@gmail.com", "text": "Created attachment 23431\nExcel and Java file to reproduce error", "is_private": false}, {"count": 2, "tags": [], "bug_id": 46944, "attachment_id": null, "id": 125918, "time": "2009-03-31T13:23:04Z", "creator": "criverapr@gmail.com", "creation_time": "2009-03-31T13:23:04Z", "is_private": false, "text": "(In reply to comment #0)\n> I get the following exception when trying to refresh all formulas on an excel\n> sheet.  I've attached an excel sheet and a java file that produce the error.\n> \n> \n> java.lang.RuntimeException: Error Value can only be 0,7,15,23,29,36 or 42. It\n> cannot be -30\n>     at\n> org.apache.poi.hssf.record.BoolErrRecord.setValue(BoolErrRecord.java:101)\n>     at\n> org.apache.poi.hssf.usermodel.HSSFCell.setCellErrorValue(HSSFCell.java:750)\n>     at\n> org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.setCellValue(HSSFFormulaEvaluator.java:222)\n>     at\n> org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluateInCell(HSSFFormulaEvaluator.java:194)\n>     at\n> com.tech_innovapr.poi.examples.UpdateFormulas.refreshWorkbookFormulas(UpdateFormulas.java:67)\n>     at\n> com.tech_innovapr.poi.examples.UpdateFormulas.main(UpdateFormulas.java:25)\n\nOk I found that this doesn't happen when I use the FormulaEvaluator.evaluateFormulaCell which should be the method used for refreshing the sheet formulas instead of the one I was using(FormulaEvaluator.evaluateInCell).  But I think the above error should be checked out anyways."}, {"count": 3, "tags": [], "bug_id": 46944, "attachment_id": null, "id": 125938, "time": "2009-04-01T13:37:41Z", "creator": "josh@apache.org", "creation_time": "2009-04-01T13:37:41Z", "is_private": false, "text": "The -30 code is caused by POI attempting to evaluate a function which has not been implemented.  Part of the problem is that the -30 error value can silently propagate around, masquerading as a genuine Excel error code. So using FormulaEvaluator.evaluateInCell() has probably not avoided the real problem. Since bug 46580 , POI has been improved to throw an exception explaining which function needs to be implemented.  \n\nIn the file you have uploaded, there are actually two functions that POI does not support yet: ADDRESS() and INDIRECT().  The implementation of ADDRESS() should be relatively straightforward. INDIRECT()  might be more complex because it involves invoking a formula parser on an arbitrary string value, during evaluation (something that hasn't been done in POI yet).\n\nSince you are using a combination of INDIRECT(ADDRESS(...)) it might be possible to replace this with OFFSET() (which POI *can* evaluate).\n\nI am marking this bug as 'LATER' in the hope that OFFSET() might do what you need. Please change the status if you can't find an acceptable work around.  As always, we are happy to receive patches from new contributors."}]