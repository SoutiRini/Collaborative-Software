[{"count": 0, "tags": [], "creator": "smear1@gmx.de", "attachment_id": 34971, "id": 198640, "time": "2017-05-03T13:40:05Z", "bug_id": 61063, "creation_time": "2017-05-03T13:40:05Z", "is_private": false, "text": "Created attachment 34971\nVery simple example with rank function\n\nWhen a cell contains a formula with an array of values, the evaluation of the cell is not completed and an exception is thrown.\n\nHere is an example formula: =RANK(A3;(B1;B4;B6);1) (Please see attachment)\n\nException in thread \"main\" java.lang.IllegalStateException: evaluation stack not empty\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateFormula(WorkbookEvaluator.java:539)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateAny(WorkbookEvaluator.java:290)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluate(WorkbookEvaluator.java:232)\n\tat org.apache.poi.xssf.usermodel.BaseXSSFFormulaEvaluator.evaluateFormulaCellValue(BaseXSSFFormulaEvaluator.java:65)\n\tat org.apache.poi.ss.formula.BaseFormulaEvaluator.evaluate(BaseFormulaEvaluator.java:101)"}, {"count": 1, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "id": 198852, "time": "2017-05-22T20:47:37Z", "bug_id": 61063, "creation_time": "2017-05-22T20:47:37Z", "is_private": false, "text": "Initial assessment: The list of values as 2nd argument is not supported right now and thus leads to this exception. We likely need some new handling of the resulting UnionPtgs in WorkbookEvaluator.evaluateFormula()"}, {"count": 2, "tags": [], "bug_id": 61063, "is_private": false, "id": 198866, "creation_time": "2017-05-23T22:14:11Z", "time": "2017-05-23T22:14:11Z", "creator": "dominik.stadler@gmx.at", "text": "This should be fixed in r1795963, there may be other functions where this is not yet fully supported, but I could not yet find a description of where else it is possible to specify a list of references, if you happen to find one, please open a separate bug so we can try to implement it there as well.", "attachment_id": null}]