[{"text": "It does not process \"classpathref\" either.\n\nI have 2 source trees - main sources and tests. I compile them to different\nlocations. So, my test classes depend on built before source classes.\n\nWhen I touch java files in main tree and rebuild main tree, <depend> task for\ntest classes does not delete expired files.\n\nOne more. I looked at unit tests for <depend> task. Actually, there is no\ncorrect test for testing of using \"classpath\" either \"classpathref\". The\nexisting one uses _the_same_path_ in attributes 'destdir' and 'classpathref' of\n<depend> task (depend.xml):\n\n      <path id=\"path.compile\">\n          <pathelement location=\"${classes.dir}\"/>\n      </path>\n  [skipped]\n      <depend srcdir=\"${tempsrc.dir}\" destdir=\"${classes.dir}\" \n              closure=\"yes\" dump=\"yes\"\n              classpathref=\"path.compile\"/>\n\nSo, the test is not correct.\n\n\nHere it is the main part of my ant script:\n\n\t<macrodef name=\"compile\">\n\t\t<attribute name=\"srcdir\" />\n\t\t<attribute name=\"destdir\"/>\n\t\t<attribute name=\"classpathref\"/>\n\t\t<sequential>\n\t\t\t<mkdir dir=\"@{destdir}\"/>\n\n\t\t\t<javac\n\t\t\t\tdebug=\"true\"\n\t\t\t\tsrcdir=\"@{srcdir}\"\n\t\t\t\tdestdir=\"@{destdir}\"\n\t\t\t\tclasspathref=\"@{classpathref}\"\n\t\t\t\tsource=\"1.4\"\n\t\t\t\tnowarn=\"on\"\n\t\t\t/>\n\t\t\t<copy todir=\"@{destdir}\" verbose=\"true\">\n\t\t\t\t<fileset dir=\"@{srcdir}\" casesensitive=\"yes\" includes=\"**/*.properties\"/>\n\t\t\t</copy>\n\n\t\t</sequential>\n\t</macrodef>\n\t<target name=\"simple_compile\">\n\t\t<property name=\"lib.dir\"     location=\"${basedir}/libs\"       />\n\t\t<property name=\"src.dir\"     location=\"${basedir}/src\"        />\n\t\t<property name=\"tst.dir\"     location=\"${basedir}/tst\"        />\n\t\t<property name=\"out.dir\"     location=\"${basedir}/OUTPUT\"     />\n\t\t<property name=\"classes.dir\" location=\"${out.dir}/javac/classes\"    />\n\t\t<property name=\"classes.tst\" location=\"${out.dir}/javac/classes.tst\"/>\n\n\t\t<path id=\"compile.classpath\">\n\t\t\t<fileset dir=\"${lib.dir}\" includes=\"*.jar\" />\n\t\t</path>\n\n\t\t<path id=\"tst.classpath\">\n\t\t\t<path refid=\"compile.classpath\"/>\n\t\t\t<fileset dir=\"${lib.dir}/tst\" includes=\"*.jar\" />\n\t\t\t<path location=\"${classes.dir}\" />\n\t\t</path>\n\t\t\n\t\t<depend\n\t\t\tsrcdir=\"${src.dir}\"\n\t\t\tdestdir=\"${classes.dir}\"\n\t\t\tclosure=\"yes\"\n\t\t/>\n\t\t\n\t\t<compile srcdir=\"${src.dir}\" destdir=\"${classes.dir}\"\nclasspathref=\"compile.classpath\" />\n\t\t\n\t\t<depend\n\t\t\tsrcdir=\"${tst.dir}\"\n\t\t\tdestdir=\"${classes.tst}\"\n\t\t\tclosure=\"yes\"\n\t\t\tclasspath=\"${classes.dir}\"\n\t\t/>\n\t\t\n\t\t<compile srcdir=\"${tst.dir}\" destdir=\"${classes.tst}\"\nclasspathref=\"tst.classpath\"/>\n\t</target>\n\nRegards,\nYaroslav Sokolov.", "tags": [], "creator": "yarick123@123mail.org", "attachment_id": null, "count": 0, "id": 78569, "time": "2005-08-17T12:41:01Z", "bug_id": 36220, "creation_time": "2005-08-17T12:41:01Z", "is_private": false}, {"count": 1, "tags": [], "text": "svn revision 723285 contains unit tests that use classpath - and they pass, so we must have fixed it sometime.", "attachment_id": null, "bug_id": 36220, "id": 123074, "time": "2008-12-04T02:47:06Z", "creator": "bodewig@apache.org", "creation_time": "2008-12-04T02:47:06Z", "is_private": false}, {"count": 2, "tags": [], "creator": "yarick123@123mail.org", "attachment_id": null, "id": 123075, "time": "2008-12-04T04:02:33Z", "bug_id": 36220, "creation_time": "2008-12-04T04:02:33Z", "is_private": false, "text": "I have looked at the tests. It seems, they are correct now."}]