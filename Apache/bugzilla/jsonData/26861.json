[{"count": 0, "tags": [], "text": "The coordinate system for the content of feImage filter primitives\nappears to be shifted to move the origin to the x,y values\nof the filter effects region. I can't find anything in the spec\nthat prescribes this, and the Adobe Viewer doesn't do it.\n\nThe description of the filter element (Section 15.3) states:\n\"If primitiveUnits=\"userSpaceOnUse\", any length values within the filter\ndefinitions represent values in the current user coordinate system in place\nat the time when the 'filter' element is referenced\".\nThe description of the feImage filter primitive (Section 15.18) states\nthat \"the current user coordinate system depends on the value of\nattribute primitiveUnits on the 'filter' element\".", "is_private": false, "bug_id": 26861, "id": 52129, "time": "2004-02-11T15:17:05Z", "creator": "fpahl@web.de", "creation_time": "2004-02-11T15:17:05Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 26861, "is_private": false, "id": 52131, "attachment_id": 10316, "creator": "fpahl@web.de", "creation_time": "2004-02-11T15:21:04Z", "time": "2004-02-11T15:21:04Z", "text": "Created attachment 10316\ndarker red square appears shifted, should overlap lighter square"}, {"count": 2, "tags": [], "bug_id": 26861, "attachment_id": 10317, "text": "Created attachment 10317\nbugs create art", "id": 52132, "time": "2004-02-11T15:22:52Z", "creator": "fpahl@web.de", "creation_time": "2004-02-11T15:22:52Z", "is_private": false}, {"count": 3, "tags": [], "creator": "deweese@apache.org", "text": "The translation comes because the specification\nstates that feImage works like either\nan image or use element both of which\nshift the referenced content's coordinate system\nso 0,0 is the x/y loc of the element.", "id": 52285, "time": "2004-02-15T02:06:28Z", "bug_id": 26861, "creation_time": "2004-02-15T02:06:28Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 26861, "text": "I agree, I hadn't taken that into account. Still, I feel the statements\nI quoted from the spec seem to say something different (since according\nto Section 4.1 a \"coordinate\" is also a \"length\"). Also I feel it would\nmake more sense that way -- a typical use of feImage would interact with\nthe element being filtered, and it would be annoying to always have to\nshift the contents back to make them line up with the userSpaceOnUse.\n(For instance if feImage and the element being filtered both contain\na <use> referring to the same shape.) It would be nearly impossible\nto use filterUnits=\"objectBoundingBox\" and primitiveUnits=\"userSpaceOnUse\",\nsince you'd have to figure out the upper left corner of the object bounding\nbox to predict where the contents of <feImage> will end up, unless you\nspecify \"x\" and \"y\" explicitly in the <feImage>, which would introduce\na new clipping that you may not want.\n\nThere's a clear semantic difference from <use>; for <use>, \"x\" and \"y\"\nare really \"dx\" and \"dy\"; their only meaning is the shift in the coordinate\nsystem they induce. For <filter>, the primary meaning of \"x\" and \"y\" is\nthat of the upper left corner of a clipping region -- shifting the origin\nto this corner would be like shifting the origin when you set a clipping\nrectangle.\n\nI've submitted a request for clarification of the spec to www-svg@w3.org;\nperhaps the bug should be left open until this is clarified?\n", "id": 52291, "time": "2004-02-15T09:28:39Z", "creator": "fpahl@web.de", "creation_time": "2004-02-15T09:28:39Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 26861, "attachment_id": null, "is_private": false, "id": 52301, "time": "2004-02-15T17:33:50Z", "creator": "deweese@apache.org", "creation_time": "2004-02-15T17:33:50Z", "text": "Your example ignores the possability of referencing content in\na 'defs' section or referencing a seperate document - what \ncoordinate system would you use there?\n\nI don't think your arguments about generality stand here\nas feImage already has to identify what element it is\npulling in so ensuring that the referenced element's\ncoordinate system is properly constructed shouldn't\nbe a big deal.\n\nFor consistency it really is important that feImage behave \nthis way.  This is how all the other SVG references work.\n\nFor me it is pretty clear that 'primitiveUnits' refers to \nthe coordinate system for x/y/width/height on the \nfilter primitive.\n\nIf the WG reverses early discussion on this topic then\nfeel free to reopen the bug with a pointer to the WG\nresolution."}, {"count": 6, "text": "Created attachment 10367\nexample of tag <use>d both in source graphic and in <feImage>", "bug_id": 26861, "is_private": false, "id": 52303, "time": "2004-02-15T18:32:11Z", "creator": "fpahl@web.de", "creation_time": "2004-02-15T18:32:11Z", "tags": [], "attachment_id": 10367}, {"count": 7, "tags": [], "creator": "fpahl@web.de", "text": "> Your example ignores the possability of referencing content in\n> a 'defs' section or referencing a seperate document - what \n> coordinate system would you use there?\n\nNo, in fact this is exactly the scenario I had in mind.\nConsider the file I just attached (note the difference\nbetween Batik and the Adobe Viewer). An element in a <defs>\nis <use>d both in the source graphics for the filter and\nin the element referenced by the <feImage>. It seems\ncounterintuitive that whenever I want to adjust the filter\neffects region (to reduce computational cost, or to keep\nthe tail of the gaussian blur from spilling into other\ncontent) I have to apply a compensating transform to\nthe \"green-circle\" element when it was perfectly aligned\nwith its reddish counterpart to begin with.\n\nYour comment seems to suggest that the referenced tag would be\nsomehow \"out of context\" and hence couldn't be taken from a <defs>;\nmy suggestion was not that radical; certainly it makes sense\nfor the <feImage> to be treated as a <use>, with the semantics\nfor coordinate systems that implies -- I'm merely suggesting\nthat the \"x\" and \"y\" attributes on the filter and the filter\nprimitive should have nothing to do with coordinate transforms,\nand that the \"x\" and \"y\" of the <use> equivalent should be 0.\n\n> I don't think your arguments about generality stand here\n> as feImage already has to identify what element it is\n> pulling in so ensuring that the referenced element's\n> coordinate system is properly constructed shouldn't\n> be a big deal.\n\nIt's not a matter of it not being properly constructed,\nbut rather of it being improperly deconstructed by the filter :-)\n\n> For consistency it really is important that feImage behave \n> this way.  This is how all the other SVG references work.\n\nI'm not proposing any deep changes about how SVG references work;\nI don't see anything inconsistent in distinguishing between the\nfilter's \"x\" and \"y\" attributes (which might have been called\n\"fx\" and \"fy\", say) and the implied \"x\" and \"y\" attributes of\nthe implied <use> element, which could be 0 just like they are\nif I don't specify them on an actual <use> element.\n\n> For me it is pretty clear that 'primitiveUnits' refers to the\n> coordinate system for x/y/width/height on the filter primitive.\n\nThere might be a misunderstanding -- I certainly agree with that\nstatement. \"primitiveUnits\" determines the coordinate system in\nwhich x/y/width/height on the filter primitive are specified.\nThat doesn't imply that x/y on the filter primitive need to be\nused as x/y on the <use>.\n", "id": 52306, "time": "2004-02-15T18:49:51Z", "bug_id": 26861, "creation_time": "2004-02-15T18:49:51Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "creator": "fpahl@web.de", "text": "Sorry, I meant to add a link to the draft for SVG 1.2:\nhttp://www.w3.org/TR/SVG12/#alpha-compositing\n", "id": 52686, "time": "2004-02-20T20:51:49Z", "bug_id": 26861, "creation_time": "2004-02-20T20:51:49Z", "is_private": false, "attachment_id": null}, {"text": "Oops, never mind the previous comment -- it was meant for another bug. Sorry.", "tags": [], "bug_id": 26861, "is_private": false, "count": 9, "id": 52688, "time": "2004-02-20T20:54:03Z", "creator": "fpahl@web.de", "creation_time": "2004-02-20T20:54:03Z", "attachment_id": null}]