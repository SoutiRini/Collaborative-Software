[{"count": 0, "tags": [], "bug_id": 58183, "attachment_id": null, "is_private": false, "id": 184192, "time": "2015-07-28T09:48:56Z", "creator": "indravardhans@gmail.com", "creation_time": "2015-07-28T09:48:56Z", "text": "We have noticed a persistent problem with JMeter. Threads continue to build past the ramp-up period.\n\nBelow are the logs for one group.\n$ grep \"Starting thread group number 1\" *.log\n2015/07/21 12:21:10 INFO  - jmeter.threads.ThreadGroup: Starting thread group number 1 threads 39 ramp-up 300 perThread 7692.3076 delayedStart=false \n\n$ grep \"Thread started: Group1\" *.log\n2015/07/21 12:21:13 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-1 \n2015/07/21 12:21:23 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-2 \n2015/07/21 12:21:33 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-3 \n2015/07/21 12:21:43 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-4 \n2015/07/21 12:21:53 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-5 \n2015/07/21 12:22:03 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-6 \n2015/07/21 12:22:13 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-7 \n2015/07/21 12:22:23 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-8 \n2015/07/21 12:22:32 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-9 \n2015/07/21 12:22:42 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-10 \n2015/07/21 12:22:52 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-11 \n2015/07/21 12:23:02 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-12 \n2015/07/21 12:23:12 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-13 \n2015/07/21 12:23:22 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-14 \n2015/07/21 12:23:31 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-15 \n2015/07/21 12:23:41 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-16 \n2015/07/21 12:23:51 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-17 \n2015/07/21 12:24:01 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-18 \n2015/07/21 12:24:11 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-19 \n2015/07/21 12:24:21 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-20 \n2015/07/21 12:24:30 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-21 \n2015/07/21 12:24:40 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-22 \n2015/07/21 12:24:50 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-23 \n2015/07/21 12:25:04 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-24 \n2015/07/21 12:25:10 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-25 \n2015/07/21 12:25:20 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-26 \n2015/07/21 12:25:30 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-27 \n2015/07/21 12:25:40 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-28 \n2015/07/21 12:25:50 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-29 \n2015/07/21 12:26:00 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-30 \n2015/07/21 12:26:10 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-31 \n2015/07/21 12:26:19 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-32 \n2015/07/21 12:26:29 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-33 \n2015/07/21 12:26:39 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-34 \n2015/07/21 12:26:49 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-35 \n2015/07/21 12:26:59 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-36 \n2015/07/21 12:27:09 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-37 \n2015/07/21 12:27:19 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-38 \n2015/07/21 12:27:29 INFO  - jmeter.threads.JMeterThread: Thread started: Group1 1-39 \n\n1) Here time between two threads is 10 seconds instead of 7692.3076(8 seconds if we use ceil).\n2) These threads are stared in loop. So total time taken to launch all threads will be Ramp time + loop time(time to makeThread). Please check blow source.\n\norg.apache.jmeter.threads.ThreadGroup#start()\nfinal int numThreads = getNumThreads();\n            final int perTthreadDelay = Math.round(((float) (getRampUp() * 1000) / (float) numThreads));\n            for (int i = 0; running && i < numThreads; i++) {\n                if (i > 0) {\n                    pause(perTthreadDelay); // ramp-up delay (except first)\n                }\n                if (usingScheduler && System.currentTimeMillis() > endtime) {\n                    break; // no point continuing beyond the end time\n                }\n                .\n                .\n                newThread.start();\n            }\n        }\n        \nWe can modify perThreadDelay for each iteration instead of fixed value.\n            final float rampUpOrg = (float) (getRampUp() * 1000);\n            final long currentTime = System.currentTimeMillis();\n            for (int i = 0; running && i < numThreads; i++) {\n                if (i > 0) {\n                \tfinal float elapsed = System.currentTimeMillis() - currentTime; \n                \tfinal int perThreadDelay = Math.round(((float) (rampUpOrg - elapsed) / (float) (numThreads - i)));\n                    pause(perThreadDelay); // ramp-up delay (except first)\n                }\n                .\n                .\n                newThread.start();\n            }\n        }"}, {"count": 1, "tags": [], "bug_id": 58183, "is_private": false, "text": "Bug validated.", "id": 184677, "time": "2015-08-21T12:35:55Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2015-08-21T12:35:55Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "stuart.kenworthy@bjss.com", "attachment_id": null, "id": 196956, "time": "2017-02-13T13:51:20Z", "bug_id": 58183, "creation_time": "2017-02-13T13:51:20Z", "is_private": false, "text": "Do we have any movement on this bug? My test rig is currently suffering heavily from this bug and https://bz.apache.org/bugzilla/show_bug.cgi?id=58182 which is impacting my ability to run multiple thread groups in a planned amount of time."}]