[{"attachment_id": null, "tags": [], "bug_id": 36416, "is_private": false, "count": 0, "id": 79165, "time": "2005-08-30T13:18:04Z", "creator": "dozean@gmx.de", "creation_time": "2005-08-30T13:18:04Z", "text": "I get the Exception ArrayIndexOutOfBounds by doing:\n\nPowerPointExtractor extractor = new PowerPointExtractor(\"file.ppt\");\nuse:\npoi-3.0-alpha1-20050830.jar\npoi-contrib-3.0-alpha1-20050830.jar and\npoi-scratchpad-3.0-alpha1-20050830.jar\n\nThe files which i try to extract are definitely not corrupt!\n\nException in thread \"main\" java.lang.ArrayIndexOutOfBoundsException: 8\n\tat org.apache.poi.util.HexDump.toHex(HexDump.java:406)\n\tat org.apache.poi.util.HexDump.toHex(HexDump.java:397)\n\tat\norg.apache.poi.hpsf.UnsupportedVariantTypeException.<init>(UnsupportedVariantTypeException.java:46)\n\tat\norg.apache.poi.hpsf.ReadingNotSupportedException.<init>(ReadingNotSupportedException.java:45)\n\tat org.apache.poi.hpsf.VariantSupport.read(VariantSupport.java:267)\n\tat org.apache.poi.hpsf.Property.<init>(Property.java:146)\n\tat org.apache.poi.hpsf.Section.<init>(Section.java:281)\n\tat org.apache.poi.hpsf.PropertySet.init(PropertySet.java:452)\n\tat org.apache.poi.hpsf.PropertySet.<init>(PropertySet.java:249)\n\tat org.apache.poi.hpsf.PropertySetFactory.create(PropertySetFactory.java:59)\n\tat org.apache.poi.hslf.HSLFSlideShow.getPropertySet(HSLFSlideShow.java:214)\n\tat org.apache.poi.hslf.HSLFSlideShow.readProperties(HSLFSlideShow.java:182)\n\tat org.apache.poi.hslf.HSLFSlideShow.<init>(HSLFSlideShow.java:105)\n\tat org.apache.poi.hslf.HSLFSlideShow.<init>(HSLFSlideShow.java:85)\n\tat org.apache.poi.hslf.HSLFSlideShow.<init>(HSLFSlideShow.java:72)\n\tat\norg.apache.poi.hslf.extractor.PowerPointExtractor.<init>(PowerPointExtractor.java:73)\n\tat TestIndex.Powerpoint.main(Powerpoint.java:23)"}, {"attachment_id": null, "tags": [], "bug_id": 36416, "text": "Can you please attach the powerpoint file that causes this? \n\n(The stack trace isn't enough to go on, because it's breaking deep in the bowels\nof HPSF, where things shouldn't be breaking)", "count": 1, "id": 79175, "time": "2005-08-30T14:14:00Z", "creator": "apache@gagravarr.org", "creation_time": "2005-08-30T14:14:00Z", "is_private": false}, {"attachment_id": 16253, "tags": [], "bug_id": 36416, "text": "Created attachment 16253\na test file\n\nThis is one of the files i try to parse!\nIt's a test file!", "count": 2, "id": 79177, "time": "2005-08-30T15:31:00Z", "creator": "dozean@gmx.de", "creation_time": "2005-08-30T15:31:00Z", "is_private": false}, {"count": 3, "tags": [], "text": "I've just tried to open your test file, and it worked flawlessly. No problems,\nno exceptions. A call to extractor.getText() correctly returns your test strings.\n\nI think you must have some older POI jar files kicking around on your classpath,\nand that's what's causing your issues.\n\nTry running the following program - it'll tell you exactly where you are picking\nup POI from:\n\nimport org.apache.poi.hslf.extractor.*;\npublic class TestWherePPT {\n\tpublic static void main(String[] args) throws Exception {\n\t\tClass extractorClass = PowerPointExtractor.class;\n\t\tClassLoader loader = extractorClass.getClassLoader();\n\t\tString extractorFrom =\nloader.getResource(\"org/apache/poi/hslf/extractor/PowerPointExtractor.class\").toString();\n\t\tString hpsfFrom =\nloader.getResource(\"org/apache/poi/hpsf/PropertySet.class\").toString();\n\t\tSystem.out.println(extractorFrom);\n\t\tSystem.out.println(hpsfFrom);\n\t}\n}\n\n\nUntil the output of both is just the new JAR files you downloaded, you'll have\nproblems!", "attachment_id": null, "id": 79368, "creator": "apache@gagravarr.org", "time": "2005-09-04T19:13:27Z", "bug_id": 36416, "creation_time": "2005-09-04T19:13:27Z", "is_private": false}, {"count": 4, "tags": [], "text": "I have the same problem with the 3.0-alpha1-20050704 jars\n\nHere's from where the classes are loaded:\n\njar:file:/C:/opt/eclipse-rc/eclipse/workspace/project/lib/textmining/poi-scratchpad-3.0-alpha1-20050704.jar!/org/apache/poi/hslf/extractor/PowerPointExtractor.class\njar:file:/C:/opt/eclipse-rc/eclipse/workspace/project/lib/textmining/poi-3.0-alpha1-20050704.jar!/org/apache/poi/hpsf/PropertySet.class\n", "is_private": false, "bug_id": 36416, "id": 81381, "time": "2005-10-19T15:31:21Z", "creator": "eric.meyer@quoininc.com", "creation_time": "2005-10-19T15:31:21Z", "attachment_id": null}, {"count": 5, "tags": [], "text": ">\njar:file:/C:/opt/eclipse-rc/eclipse/workspace/project/lib/textmining/poi-scratchpad-3.0-alpha1-20050704.jar!/org/apache/poi/hslf/extractor/PowerPointExtractor.class\n>\njar:file:/C:/opt/eclipse-rc/eclipse/workspace/project/lib/textmining/poi-3.0-alpha1-20050704.jar!/org/apache/poi/hpsf/PropertySet.class\n> \n\nThat's very odd, since you do have the right jar files to hand (unlike the\noriginal reporter, who was probably using 3.0-alpha1 scratchpad with 2.5 core).\n\nI think it must be a different problem you're facing. Could you please post the\nstack trace you get, along with the file that's giving you grief?", "is_private": false, "bug_id": 36416, "id": 81382, "time": "2005-10-19T15:52:56Z", "creator": "apache@gagravarr.org", "creation_time": "2005-10-19T15:52:56Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 36416, "is_private": false, "count": 6, "id": 81383, "time": "2005-10-19T15:56:53Z", "creator": "eric.meyer@quoininc.com", "creation_time": "2005-10-19T15:56:53Z", "text": "I just got the latest HEAD from CVS, and have the same exception:\n\njar:file:/C:/opt/eclipse-rc/eclipse/workspace/project/lib/textmining/poi-scratchpad-3.0-alpha1-20051019.jar!/org/apache/poi/hslf/extractor/PowerPointExtractor.class\njar:file:/C:/opt/eclipse-rc/eclipse/workspace/project/lib/textmining/poi-3.0-alpha1-20051019.jar!/org/apache/poi/hpsf/PropertySet.class\n"}, {"count": 7, "tags": [], "bug_id": 36416, "attachment_id": null, "text": "Here's the stack trace (building from the HEAD just minutes ago).\n\njava.lang.ArrayIndexOutOfBoundsException: 8\n\tat org.apache.poi.util.HexDump.toHex(HexDump.java:406)\n\tat org.apache.poi.util.HexDump.toHex(HexDump.java:397)\n\tat\norg.apache.poi.hpsf.UnsupportedVariantTypeException.<init>(UnsupportedVariantTypeException.java:46)\n\tat\norg.apache.poi.hpsf.ReadingNotSupportedException.<init>(ReadingNotSupportedException.java:45)\n\tat org.apache.poi.hpsf.VariantSupport.read(VariantSupport.java:267)\n\tat org.apache.poi.hpsf.Property.<init>(Property.java:146)\n\tat org.apache.poi.hpsf.Section.<init>(Section.java:281)\n\tat org.apache.poi.hpsf.PropertySet.init(PropertySet.java:452)\n\tat org.apache.poi.hpsf.PropertySet.<init>(PropertySet.java:249)\n\tat org.apache.poi.hpsf.PropertySetFactory.create(PropertySetFactory.java:59)\n\tat org.apache.poi.hslf.HSLFSlideShow.getPropertySet(HSLFSlideShow.java:214)\n\tat org.apache.poi.hslf.HSLFSlideShow.readProperties(HSLFSlideShow.java:182)\n\tat org.apache.poi.hslf.HSLFSlideShow.<init>(HSLFSlideShow.java:105)\n\tat org.apache.poi.hslf.HSLFSlideShow.<init>(HSLFSlideShow.java:85)\n\tat\norg.apache.poi.hslf.extractor.PowerPointExtractor.<init>(PowerPointExtractor.java:84)\n\tat\ncom.lek.extraction.PowerPointTextExtractor.getText(PowerPointTextExtractor.java:21)\n\tat\ncom.lek.extraction.TextExtractionTestCase.testPowerPointExtraction(TextExtractionTestCase.java:69)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:324)\n\tat junit.framework.TestCase.runTest(TestCase.java:154)\n\tat junit.framework.TestCase.runBare(TestCase.java:127)\n\tat junit.framework.TestResult$1.protect(TestResult.java:106)\n\tat junit.framework.TestResult.runProtected(TestResult.java:124)\n\tat junit.framework.TestResult.run(TestResult.java:109)\n\tat junit.framework.TestCase.run(TestCase.java:118)\n\tat junit.framework.TestSuite.runTest(TestSuite.java:208)\n\tat junit.framework.TestSuite.run(TestSuite.java:203)\n\tat\norg.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:478)\n\tat\norg.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:344)\n\tat\norg.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:196)\n\nLet me verify whether the original poster's file causes this same exception for me.", "id": 81384, "time": "2005-10-19T16:00:05Z", "creator": "eric.meyer@quoininc.com", "creation_time": "2005-10-19T16:00:05Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 36416, "text": "> Let me verify whether the original poster's file causes this same exception\nfor me.\n\nCan you also try with the sample files under\n/jakarta-poi/src/scratchpad/testcases/org/apache/poi/hslf/data/ ?\n\n(Those files work just fine for me on my workstation, and also on the nightly\nbuild box)", "count": 8, "id": 81386, "time": "2005-10-19T16:11:39Z", "creator": "apache@gagravarr.org", "creation_time": "2005-10-19T16:11:39Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 36416, "attachment_id": null, "text": "I resolved the problem - it was the order of the jars. Everything worked fine\nwhen I ran my test with Ant, but not in eclipse, so I moved the POI jars to the\nhead of the classpath.\n\nI'll attach my full classpath - perhaps that will give an indication of what\nother jar POI is interacting with.", "id": 81392, "time": "2005-10-19T17:01:18Z", "creator": "eric.meyer@quoininc.com", "creation_time": "2005-10-19T17:01:18Z", "is_private": false}, {"count": 10, "tags": [], "text": "Created attachment 16754\neclipse project class path\n\nIf you put the POI jars at the end of the classpath, then the error will occur.", "is_private": false, "id": 81393, "creator": "eric.meyer@quoininc.com", "time": "2005-10-19T17:02:55Z", "bug_id": 36416, "creation_time": "2005-10-19T17:02:55Z", "attachment_id": 16754}, {"count": 11, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 81394, "time": "2005-10-19T17:15:56Z", "bug_id": 36416, "creation_time": "2005-10-19T17:15:56Z", "is_private": false, "text": "> If you put the POI jars at the end of the classpath, then the error will occur.\n\nNone of those scream \"I contain old bits of POI\", but hey. Quite why Eclipse was\nclaiming it was going to get hpsf from the right jar, and then fail to, I don't\nknow. Isn't eclipse fun...\n\nNick"}]