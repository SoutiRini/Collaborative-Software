[{"count": 0, "tags": [], "creator": "christiaan.fluit@aduna-software.com", "attachment_id": null, "is_private": false, "id": 129645, "time": "2009-08-12T03:14:31Z", "bug_id": 47685, "creation_time": "2009-08-12T03:14:31Z", "text": "I have a couple of xls files that result in exceptions when I try to extract their text. POI 3.2-FINAL gives the following stacktrace:\n\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:186)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:328)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:271)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:196)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:178)\n\tat [proprietary code trace]\nCaused by: java.lang.ArrayIndexOutOfBoundsException\n\tat org.apache.poi.hssf.record.RecordInputStream.checkRecordPosition(RecordInputStream.java:142)\n\tat org.apache.poi.hssf.record.RecordInputStream.readByte(RecordInputStream.java:151)\n\tat org.apache.poi.hssf.record.MMSRecord.<init>(MMSRecord.java:46)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:513)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:184)\n\t... 25 common frames omitted\n\nPOI 3.5-beta5 gives this stacktrace:\n\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\tat org.apache.poi.hssf.record.RecordFactory$ReflectionRecordCreator.create(RecordFactory.java:71)\n\tat org.apache.poi.hssf.record.RecordFactory.createSingleRecord(RecordFactory.java:269)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:248)\n\tat org.apache.poi.hssf.eventusermodel.HSSFRecordStream.getNextRecord(HSSFRecordStream.java:162)\n\tat org.apache.poi.hssf.eventusermodel.HSSFRecordStream.nextRecord(HSSFRecordStream.java:93)\n\tat org.apache.poi.hssf.eventusermodel.HSSFEventFactory.genericProcessEvents(HSSFEventFactory.java:141)\n\tat org.apache.poi.hssf.eventusermodel.HSSFEventFactory.processEvents(HSSFEventFactory.java:98)\n\tat [proprietary code trace]\nCaused by: org.apache.poi.hssf.record.RecordFormatException: Not enough data (0) to read requested (1) bytes\n\tat org.apache.poi.hssf.record.RecordInputStream.checkRecordPosition(RecordInputStream.java:185)\n\tat org.apache.poi.hssf.record.RecordInputStream.readByte(RecordInputStream.java:193)\n\tat org.apache.poi.hssf.record.MMSRecord.<init>(MMSRecord.java:46)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:513)\n\tat org.apache.poi.hssf.record.RecordFactory$ReflectionRecordCreator.create(RecordFactory.java:63)\n\t... 12 more\n\nDue to the nature of these files, I cannot post them here, but I am willing to share them with developers looking into this bug."}, {"count": 1, "tags": [], "bug_id": 47685, "attachment_id": null, "id": 129656, "time": "2009-08-12T06:50:08Z", "creator": "apache@gagravarr.org", "creation_time": "2009-08-12T06:50:08Z", "is_private": false, "text": "Without the file I can only suggest you dig into the problematic record code (MMSRecord), compare that to the published microsoft docs and see if you can spot the issue\n\nAlso, it's worth opening the file in a new copy of office, and doing a \"save as\". If that file opens without issue, then a workaround is probably needed for whatever software wrote your file not quite according to the spec. If that doesn't help, then that looks more like a record bug in poi."}, {"count": 2, "tags": [], "bug_id": 47685, "attachment_id": null, "text": "I had the same problem with a file created in MS Excel. I could solve the problem by removing an image that was embedded over two cells.", "id": 131320, "time": "2009-10-23T02:04:22Z", "creator": "andi7860@gmx.de", "creation_time": "2009-10-23T02:04:22Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 47685, "attachment_id": null, "id": 136432, "time": "2010-04-27T05:30:47Z", "creator": "max.valjanski@gmail.com", "creation_time": "2010-04-27T05:30:47Z", "is_private": false, "text": "Fixed in r938372"}]