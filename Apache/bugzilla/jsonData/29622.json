[{"count": 0, "tags": [], "bug_id": 29622, "is_private": false, "text": "The HttpServletRequest.getAuthType() method always returns a null when SSL is\nused even if Client Auth is enabled and working.  According to the documentation\nthe constant HttpServletRequest.CLIENT_CERT_AUTH should be returned.\n\nThe actual Client Auth functionality works correctly only the authentication\nmechanism is not correctly reported to the Servlet through the getAuthType API.", "id": 59352, "time": "2004-06-16T19:26:08Z", "creator": "tague@minion.net", "creation_time": "2004-06-16T19:26:08Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 29622, "attachment_id": null, "is_private": false, "id": 59360, "time": "2004-06-16T20:16:55Z", "creator": "jan.luehe@sun.com", "creation_time": "2004-06-16T20:16:55Z", "text": "getAuth() returns CLIENT-CERT for me.\n\norg.apache.catalina.authenticator.SSLAuthenticator.authenticate() has this code\nbefore it returns:\n\n        // Authenticate the specified certificate chain\n        principal = context.getRealm().authenticate(certs);\n        if (principal == null) {\n            if (debug >= 1)\n                log(\"  Realm.authenticate() returned false\");\n            hres.sendError(HttpServletResponse.SC_UNAUTHORIZED,\n                           sm.getString(\"authenticator.unauthorized\"));\n            return (false);\n        }\n\n        // Cache the principal (if requested) and record this authentication\n        register(request, response, principal, Constants.CERT_METHOD,\n                 null, null); \n\nregister() sets the auth method (Constants.CERT_METHOD) on the request. Seems\nthat you're returning before register() is being called, ie, the subject DN in\nyour client's cert fails to be authenticated against the realm. In case you're\nusing the memory realm, did you add a <user> element with a username matching\nthe subject DN of your client cert to your tomcat-users.xml?"}]