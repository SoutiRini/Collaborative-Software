[{"count": 0, "attachment_id": null, "bug_id": 25163, "is_private": false, "id": 48419, "time": "2003-12-03T13:43:21Z", "creator": "jonny_dehertogh@yahoo.com", "creation_time": "2003-12-03T13:43:21Z", "tags": [], "text": "I have a textfile x.txt on a server:\nSunOS aserver 5.9 Generic_112233-08 sun4us sparc FJSV,GPUS\n\nI use gzip 1.3 (1999-12-21) to zip it. The file becomes x.txt.gz\n\nThrough FTP I download the file binary to my PC (Win 2000 Professional).\n\nI run in a task only the following:\n<unzip src=\"c:\\jtemp\\zipped\\x.txt.gz\" dest=\"c:\\jtemp\\unzipped\"/>\n\nWhen running only this task, I get:\n\nC:\\dvl.home\\prj\\ksz\\build.xml:223: Error while expanding \nC:\\jtemp\\zipped\\x.txt.gz\n        at org.apache.tools.ant.taskdefs.Expand.expandFile(Expand.java:169)\n        at org.apache.tools.ant.taskdefs.Expand.execute(Expand.java:133)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:302)\n        at org.apache.tools.ant.Task.perform(Task.java:401)\n        at org.apache.tools.ant.Target.execute(Target.java:338)\n        at org.apache.tools.ant.Target.performTasks(Target.java:365)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1237)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1094)\n        at org.apache.tools.ant.Main.runBuild(Main.java:669)\n        at org.apache.tools.ant.Main.startAnt(Main.java:220)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:215)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:90)\n--- Nested Exception ---\njava.io.IOException: Negative seek offset\n        at java.io.RandomAccessFile.seek(Native Method)\n        at org.apache.tools.zip.ZipFile.positionAtCentralDirectory\n(ZipFile.java:396)\n        at org.apache.tools.zip.ZipFile.populateFromCentralDirectory\n(ZipFile.java:274)\n        at org.apache.tools.zip.ZipFile.<init>(ZipFile.java:180)\n        at org.apache.tools.ant.taskdefs.Expand.expandFile(Expand.java:158)\n        at org.apache.tools.ant.taskdefs.Expand.execute(Expand.java:133)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:302)\n        at org.apache.tools.ant.Task.perform(Task.java:401)\n        at org.apache.tools.ant.Target.execute(Target.java:338)\n        at org.apache.tools.ant.Target.performTasks(Target.java:365)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1237)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1094)\n        at org.apache.tools.ant.Main.runBuild(Main.java:669)\n        at org.apache.tools.ant.Main.startAnt(Main.java:220)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:215)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:90)"}, {"count": 1, "attachment_id": null, "bug_id": 25163, "is_private": false, "id": 48420, "time": "2003-12-03T13:59:36Z", "creator": "jonny_dehertogh@yahoo.com", "creation_time": "2003-12-03T13:59:36Z", "tags": [], "text": "The task gunzip works well in this case but I my situation I can't use gunzip \nbecause I want to use filesets: all the .gz-files in my directory have to be \nuncompressed."}, {"count": 2, "tags": [], "creator": "peter.reilly@corvil.com", "attachment_id": null, "text": "This is not a bug.\nYou are using the incorrect uncompression method.\nYou need to use <gunzip> instead of <unzip>.\n<unzip> will think that this is a zip file and\nnot a gzip file.", "id": 48421, "time": "2003-12-03T14:07:44Z", "bug_id": 25163, "creation_time": "2003-12-03T14:07:44Z", "is_private": false}, {"count": 3, "tags": [], "creator": "peter.reilly@corvil.com", "attachment_id": null, "id": 48422, "time": "2003-12-03T14:18:48Z", "bug_id": 25163, "creation_time": "2003-12-03T14:18:48Z", "is_private": false, "text": "Ikkk.\nYou are right, the guzip task does not\ntake a fileset !\nAnd one cannot set the compression method for\nunzip or use the untar task.\n"}, {"count": 4, "attachment_id": null, "bug_id": 25163, "is_private": false, "id": 48423, "time": "2003-12-03T14:33:21Z", "creator": "peter.reilly@corvil.com", "creation_time": "2003-12-03T14:33:21Z", "tags": [], "text": "As a work-around (and when ant 1.6 beta3 comes out soon..)\nyou can use <for> from ant-contrib, (for is like foreach\nbut it uses macrodef instead of antcall so it is currently faster\nfor each iteration).\n<project default=\"u\" xmlns:ac=\"antlib:net.sf.antcontrib\">\n  <target name=\"u\">\n    <mkdir dir=\"unzipped\"/>\n    <ac:for param=\"file\">\n      <ac:path>\n        <ac:fileset dir=\"${basedir}\" includes=\"**/*.gz\"/>\n      </ac:path>\n      <ac:sequential>\n        <gunzip src=\"@{file}\" dest=\"unzipped\"/>\n      </ac:sequential>\n    </ac:for>\n  </target>\n</project>\n"}, {"count": 5, "tags": [], "creator": "jonny_dehertogh@yahoo.com", "attachment_id": null, "text": "Thanks for the quick answer. Quicker than the helpdesk of some paying \nsoftware ;-)\nBut what do I have to install to make it work ?\nI read and tried different things but it doesn't work. Probably I don't have \nenough knowledge of ant-contrib. But probably I am not alone and is it usefull \nto share it to others through these bug-comments...", "id": 48482, "time": "2003-12-04T13:40:32Z", "bug_id": 25163, "creation_time": "2003-12-04T13:40:32Z", "is_private": false}, {"count": 6, "tags": [], "text": "First for the <for> task, you need ant 1.6 beta3, just released.\nThen you need a cvs version of ant-contrib, or take the lastest\ngump compiled jar at http://gump.covalent.net/jars/latest/ant-contrib.\nPlace the ant-contrib.jar into the $ANT_HOME/lib directory.\nYou can then use the antlib namespace shortcut:\n<project xmlns:ac=\"antlib:net.sf.antcontrib\">\n  <ac:for ...>\n</project>\nor use a <taskdef resource=\"net/sf/antcontrib/antcontrib.properties\">\nor <typedef resource=\"net/sf/antcontrib/antlib.xml\"/> to access the\ntasks without using namespaces.", "is_private": false, "bug_id": 25163, "id": 48552, "time": "2003-12-05T08:56:08Z", "creator": "peter.reilly@corvil.com", "creation_time": "2003-12-05T08:56:08Z", "attachment_id": null}, {"count": 7, "attachment_id": null, "bug_id": 25163, "is_private": false, "id": 48560, "time": "2003-12-05T11:18:02Z", "creator": "jonny_dehertogh@yahoo.com", "creation_time": "2003-12-05T11:18:02Z", "tags": [], "text": "Hoera, it works !\n\nThanks a lot !!!"}]