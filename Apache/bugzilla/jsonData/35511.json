[{"count": 0, "tags": [], "bug_id": 35511, "attachment_id": null, "id": 76734, "time": "2005-06-27T15:18:39Z", "creator": "tuduyen.tran@custserv.com", "creation_time": "2005-06-27T15:18:39Z", "is_private": false, "text": "I am receiving a NullPointerException when I call Workbook.write().  The trace \nis below.  I've also attached the method in which I call write().\n\n\njava.lang.NullPointerException \n\n.at org.apache.poi.hssf.record.SSTSerializer.calculateUnicodeSize\n(SSTSerializer.\n\n.at org.apache.poi.hssf.record.SSTRecordSizeCalculator.getRecordSize\n(SSTRecordSi\n\n.at org.apache.poi.hssf.record.SSTRecord.getRecordSize(SSTRecord.java:499) \n\n.at org.apache.poi.hssf.model.Workbook.getSize(Workbook.java:756) \n\n.at org.apache.poi.hssf.usermodel.HSSFWorkbook.getBytes(HSSFWorkbook.java:768) \n\n.at org.apache.poi.hssf.usermodel.HSSFWorkbook.write(HSSFWorkbook.java:732) \n\n.at com.timeinc.tcs.compsub.admin.DisplayXLS.process(DisplayXLS.java:132) \n\n.at com.timeinc.tcs.compsub.admin.DisplayXLS.doGet(DisplayXLS.java:59) \n=============================================================================\n\npublic String process() throws IOException{\n\n    //System.out.println(\"***\"+props.SHEETNAME_RPT);\n\tFile temp = File.createTempFile(\"CSB\",\".xls\");\n\ttemp.deleteOnExit();\n\t   \t\n\ttry{\t\t\t\n\t\t\n\t\t// SET UP WORKBOOK AND SHEETS\n\t\twb = getTemplate();\n\t\tsetStyles();\n\t\tsetReportSheet(); \n\t\t\t\n\t\tsetReportHeaderSheet();\n\t\t\n\t\tsetInstructionSheet(); \n\t\tBufferedOutputStream bos = new BufferedOutputStream(new \nFileOutputStream(temp));\n\t\twb.write(bos);\t\n\t\tbos.flush();\n\t  \tbos.close();\n\t\t\n\t} catch (Exception e) {\n\t\te.printStackTrace(System.out);\t\n\t}\n\t\n\treturn temp.getCanonicalPath();\n}"}, {"count": 1, "tags": [], "text": "Apparently the calls in the stack trace no longer exist in the version in CVS\nHEAD. Specifically,\norg.apache.poi.hssf.record.SSTRecordSizeCalculator.getRecordSize() no longer has\na call to rg.apache.poi.hssf.record.SSTSerializer.calculateUnicodeSize(..). The\ncall existed in a previous version.\n\nCan you build from source and verify that the latest from CVS does not give the\nexception? ...or wait couple of days till the next release and test against that.\n", "attachment_id": null, "bug_id": 35511, "id": 76741, "time": "2005-06-27T18:55:44Z", "creator": "amolweb@yahoo.com", "creation_time": "2005-06-27T18:55:44Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 35511, "attachment_id": null, "text": "Wel this has been completely rewritten in HEAD. As amol suggested a new release\nis just arround the corner, or get the latest from CVS if you are game.\n\nJason", "id": 78954, "time": "2005-08-25T05:03:16Z", "creator": "jheight@apache.org", "creation_time": "2005-08-25T05:03:16Z", "is_private": false}]