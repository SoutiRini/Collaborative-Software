[{"count": 0, "tags": [], "text": "Under certain conditions, the default exception report is shown, instead\nof the location \nconfigured in the web.xml deployment descriptor.\n\nUnfortunately, the unit tests included \nwith the tester application in the Tomcat sources test for neither of the two conditions under \nwhich the error occurs:\n\n1) If the web.xml declares it wants to catch a subtype \nof\nServletException, like this:\n\n  <error-page>\n        <exception-\ntype>org.apache.tester.TesterServletException\n         </exception-type>\n        \n<location>/ErrorPage04</location>\n  </error-page>\n  \nand the exception is thrown from a \nservlet, like this:\n\n    throw new TesterServletException\n            (new \nTester2Exception(\"ErrorPage031 Threw Exception\"));\n\nthen we are not redirected to the \ngiven location, but the default Exception Report is shown instead.\n\nHowever, if the same \nexception is thrown from a JSP, like this\n\n<% if( true )\n    throw new \norg.apache.tester.TesterServletException(\n        new \norg.apache.tester.Tester2Exception(\"TesterPage031.jsp Threw \nException\"));\n%>\n\nthen we are redirected correctly.\n\n2) Conversely, if the web.xml \ndeclares it wants to catch an\nexception embedded in a ServletException, like this:\n\n    <error-\npage>\n        <exception-type>org.apache.tester.TesterException</exception-type>\n        \n<location>/ErrorPage04</location>\n    </error-page>\n\nand the exception is thrown from a \nJSP, like this\n\n<% if( true )\n    throw new javax.servlet.ServletException(\n        new \norg.apache.tester.TesterException(\"TesterPage03.jsp Threw Exception\"));\n%>\n\nthen \nwe are not redirected to the given location, but\nthe default Exception Report is shown \ninstead.\n\n\nAll this can be reproduced in the tester application:\n\nI have written \n- 2 Test \npages TesterPage03.jsp and TesterPage031.jsp\n- the classes \norg.apache.tester.Tester2Exception.java, \n   \norg.apache.tester.TesterServletException.java\n- a servlet \norg.apache.tester.ErrorPage031.java, \nand included the relevant configuration in the \nweb.xml. \n\nIs there any way for me to attach my code to this bug\nreport for you to use?\n\nI am \nusing JDK 1.3.1. The behavior is independent of whether the web.xml \nconforms to the web-\napp_2_3.dtd or the web-app_2_2.dtd\n\n-- Sebastian Millies", "attachment_id": null, "id": 25109, "creator": "s.millies@ids-scheer.de", "time": "2002-10-24T10:12:28Z", "bug_id": 13924, "creation_time": "2002-10-24T10:12:28Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 13924, "attachment_id": 3598, "id": 25113, "time": "2002-10-24T10:21:15Z", "creator": "s.millies@ids-scheer.de", "creation_time": "2002-10-24T10:21:15Z", "is_private": false, "text": "Created attachment 3598\nzip file containing code to reproduce bug 13924 in tester application"}, {"count": 2, "tags": [], "bug_id": 13924, "attachment_id": null, "id": 25322, "time": "2002-10-29T16:05:29Z", "creator": "s.millies@ids-scheer.de", "creation_time": "2002-10-29T16:05:29Z", "is_private": false, "text": "The problem with issue 2) may be that Tomcat wraps every exception thrown from a JSP in a \nJasperException (even ServletExceptions), but does not recurrsively unwrap them \nagain.\n\nWith regard to 1), it's beyond me why it should make a difference if the exception is \nthrown from a Servlet or a JSP.\n\n"}, {"count": 3, "tags": [], "bug_id": 13924, "is_private": false, "text": "This sounds a lot like what I reported a while back (not the wrapping thing, but\nthe servlet vs. JSP thing):\n\nhttp://nagoya.apache.org/bugzilla/show_bug.cgi?id=7371\n\nThere's another test case there. We are still using 4.0.1 so it still fails for\nme. I have no clue WHY it works when thrown from a JSP, but not from a servlet;\nit just doesnt :)\n\nHell, I'd be happy to start looking at the Tomcat source if someone wants to\nshove me in the right direction.", "id": 28946, "time": "2003-01-07T17:55:47Z", "creator": "jmurc5@hotmail.com", "creation_time": "2003-01-07T17:55:47Z", "attachment_id": null}, {"count": 4, "tags": [], "text": "throwing an exception subclassed from ServletException was working for me (going\nto my error-page) under Tomcat 4.0.3, from .jsps, servlets, and filters.  I am\nusing 4.1.18 and it is definitely not going to my error-page for errors thrown\nfrom servlets or filters.", "attachment_id": null, "id": 34649, "creator": "jleech@virtela.net", "time": "2003-04-07T22:24:47Z", "bug_id": 13924, "creation_time": "2003-04-07T22:24:47Z", "is_private": false}, {"count": 5, "text": "Checked my .jsps and under 4.1.18 even those aren't working.  Perhaps the\ndifference for me is that all my test cases are behind filters...  ", "bug_id": 13924, "is_private": false, "id": 34652, "time": "2003-04-07T22:54:32Z", "creator": "jleech@virtela.net", "creation_time": "2003-04-07T22:54:32Z", "tags": [], "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 13924, "attachment_id": null, "is_private": false, "id": 35422, "time": "2003-04-17T14:05:19Z", "creator": "carlo@nerdnet.nl", "creation_time": "2003-04-17T14:05:19Z", "text": "Please take a look at\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=19110"}, {"count": 7, "tags": [], "text": "2) Is invalid. The JSP.2.4.2 states\n<spec-quote>\nAny uncaught exceptions thrown in the body of the JSP page implementation \nclass result in the forwarding of the client request and uncaught exception to \nthe errorPage URL specified by the JSP page (or the implementation default \nbehavior, if none is specified).\n</spec-quote>\nThe implementation default behaviour for tomcat is to wrap it in a \norg.apache.jasper.JasperException\n\n1) Is a bug. I have a patch and will commit it shortly.", "attachment_id": null, "id": 55663, "creator": "markt@apache.org", "time": "2004-04-12T19:54:50Z", "bug_id": 13924, "creation_time": "2004-04-12T19:54:50Z", "is_private": false}, {"count": 8, "tags": [], "text": "I have committed a patch for the first issue to TC4 and TC5.", "is_private": false, "bug_id": 13924, "id": 55665, "time": "2004-04-12T20:33:29Z", "creator": "markt@apache.org", "creation_time": "2004-04-12T20:33:29Z", "attachment_id": null}, {"count": 9, "tags": [], "text": "Although 2) is technically invalid the current behaviour is rather annoying. I \nhave committed a change that will fix this in response to bug 19238.", "attachment_id": null, "id": 55783, "creator": "markt@apache.org", "time": "2004-04-14T19:37:55Z", "bug_id": 13924, "creation_time": "2004-04-14T19:37:55Z", "is_private": false}]