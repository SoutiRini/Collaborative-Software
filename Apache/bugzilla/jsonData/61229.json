[{"count": 0, "tags": [], "creator": "sanderhartogensis@gmail.com", "attachment_id": 35080, "is_private": false, "id": 199448, "time": "2017-06-27T12:20:54Z", "bug_id": 61229, "creation_time": "2017-06-27T12:20:54Z", "text": "Created attachment 35080\nwebapps webdav folder\n\nSee the attached test WebDAV folder (webdav.zip). If the WebDAV folder contains a file with an ampersand in the filename, you cannot access the folder at all with WebDAV. I can reproduce it with AnyClient from JSCAPE (in our own product we use jackrabbit for WebDAV access).\n\nFull repro steps:\n- JAVA_HOME is 1.8.0_121\n- Extract apache-tomcat-8.5.15.zip to a working folder.\n- In the webapps directory extract contents of webapps.zip (see attachment)\n- In apache-tomcat-8.5.15\\bin run: catalina.bat start\n- In AnyClient configure a new connection in Site Manager:\n-- Host: http://localhost:8080/webdav\n-- Protocol: WebDAV\n- Connect, click the refresh button, and notice the listing remains empty.\n- In a file manager go to webapps\\webdav and rename test&.txt to test.txt.\n- Get the directory listing again, and notice that it works now.\n\nI tried three Tomcat versions:\n8.5.15: has this bug\n8.5.14: works fine\n7.0.78: works fine\n\nNote that you see the problem only if you access the directory with a WebDAV client, getting the directory listing in a browser works fine."}, {"count": 1, "tags": [], "bug_id": 61229, "attachment_id": null, "text": "Thanks for the test case. I can repeat this locally.\n\nThe problem was triggered by r1792460. Since '&' is a legal character in a URI, it is no longer encoded. However, '&' is not  a legal character in XML so not encoding it triggers this issue.\n\nWorking on a patch now.", "id": 199495, "time": "2017-06-29T19:02:46Z", "creator": "markt@apache.org", "creation_time": "2017-06-29T19:02:46Z", "is_private": false}, {"count": 2, "tags": [], "creator": "markt@apache.org", "is_private": false, "text": "Fixed in:\n- trunk for 9.0.0.M23 onwards\n- 8.5.x for 8.5.17 onwards\n- 8.0.x for 8.0.46 onwards\n- 7.0.x for 7.0.80 onwards", "id": 199497, "time": "2017-06-29T20:22:57Z", "bug_id": 61229, "creation_time": "2017-06-29T20:22:57Z", "attachment_id": null}]