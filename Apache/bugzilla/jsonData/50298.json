[{"count": 0, "tags": [], "bug_id": 50298, "attachment_id": null, "is_private": false, "id": 141817, "time": "2010-11-19T02:56:00Z", "creator": "yokoi@bbreak.co.jp", "creation_time": "2010-11-19T02:56:00Z", "text": "version:poi-3.7-20101029.jar\n\nI made the book with five sheets.\nThe following error goes out when the first sheet remove and output. \n\n// remove first sheet\nworkbook.removeSheetAt( 0);\n\nIt is normally output if it doesn't remove sheet. (attached file). \n\n\nException in thread \"main\" org.bbreak.excella.core.exception.ExportException: java.lang.IllegalArgumentException: calculated end index (15392) is out of allowable range (15388..15390)\n\tat org.bbreak.excella.reports.exporter.XLSExporter.output(XLSExporter.java:77)\n\tat org.bbreak.excella.reports.exporter.ExcelExporter.output(ExcelExporter.java:79)\n\tat org.bbreak.excella.reports.exporter.ReportBookExporter.export(ReportBookExporter.java:96)\n\tat org.bbreak.excella.reports.processor.ReportProcessor.processBook(ReportProcessor.java:215)\n\tat org.bbreak.excella.reports.processor.ReportProcessor.process(ReportProcessor.java:110)\n\tat org.bbreak.excella.reports.samples.InvoiceReporter.main(InvoiceReporter.java:132)\nCaused by: java.lang.IllegalArgumentException: calculated end index (15392) is out of allowable range (15388..15390)\n\tat org.apache.poi.util.LittleEndianByteArrayOutputStream.<init>(LittleEndianByteArrayOutputStream.java:41)\n\tat org.apache.poi.hssf.record.StandardRecord.serialize(StandardRecord.java:38)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook$SheetRecordCollector.serialize(HSSFWorkbook.java:1209)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.getBytes(HSSFWorkbook.java:1258)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.write(HSSFWorkbook.java:1158)\n\tat org.bbreak.excella.core.util.PoiUtil.writeBook(PoiUtil.java:355)\n\tat org.bbreak.excella.reports.exporter.XLSExporter.output(XLSExporter.java:75)\n\t... 5 more"}, {"count": 1, "tags": [], "bug_id": 50298, "attachment_id": 26315, "is_private": false, "id": 141818, "time": "2010-11-19T03:02:10Z", "creator": "yokoi@bbreak.co.jp", "creation_time": "2010-11-19T03:02:10Z", "text": "Created attachment 26315\nnormally output file"}, {"text": "Please post the complete Java code to reproduce the problem. If your code requires an .xls template then upload it too.\n\nYegor", "tags": [], "creator": "yegor@dinom.ru", "is_private": false, "count": 2, "id": 141824, "time": "2010-11-19T08:36:39Z", "bug_id": 50298, "creation_time": "2010-11-19T08:36:39Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 50298, "text": "Created attachment 26319\nerror java code", "id": 141829, "attachment_id": 26319, "creator": "yokoi@bbreak.co.jp", "creation_time": "2010-11-19T10:00:41Z", "time": "2010-11-19T10:00:41Z", "is_private": false}, {"count": 4, "tags": [], "text": "Created attachment 26320\nerror xls file", "is_private": false, "id": 141830, "creator": "yokoi@bbreak.co.jp", "time": "2010-11-19T10:01:00Z", "bug_id": 50298, "creation_time": "2010-11-19T10:01:00Z", "attachment_id": 26320}, {"text": "The error java code and xls file attached.", "tags": [], "creator": "yokoi@bbreak.co.jp", "is_private": false, "count": 5, "id": 141831, "time": "2010-11-19T10:01:58Z", "bug_id": 50298, "creation_time": "2010-11-19T10:01:58Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 50298, "text": "This bug does not reproduce in version 3.6.", "id": 145768, "attachment_id": null, "creator": "hier.sur.apres.demain@gmail.com", "creation_time": "2011-04-13T23:17:47Z", "time": "2011-04-13T23:17:47Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 50298, "attachment_id": null, "is_private": false, "id": 169646, "time": "2013-08-21T22:22:01Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2013-08-21T22:22:01Z", "text": "We finally found the culprit here in the way the setSheetOrder() was handled internally. It missed to update some internal structures thus confusing the calculation of the serialization-sizes. Should be fixed in 3.10 in r1516313."}]