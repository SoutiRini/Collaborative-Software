[{"count": 0, "tags": [], "creator": "zjuwufan@gmail.com", "attachment_id": null, "is_private": false, "id": 140845, "time": "2010-10-19T23:37:37Z", "bug_id": 50119, "creation_time": "2010-10-19T23:37:37Z", "text": "I tried to traverse all the sheets in a xlsx file with this:\n\nXSSFReader.SheetIterator iter = (XSSFReader.SheetIterator) reader.getSheetsData();\nwhile (iter.hasNext())\n{\n    InputStream stream = iter.next();\n}\n\nWhen the xlsx file contains a chartsheet, a NullPointerException is thrown.\n\nI noticed there is a kindof inconsistence in XSSFReader.SheetIterator.\n\nIn the constructor of XSSFReader.SheetIterator only WORKSHEETs are added to the sheetMap.\n\nBut in XSSFReader.SheetIterator.next(), it is like this:\npublic InputStream next() {\n    ctSheet = sheetIterator.next();\n    String sheetId = ctSheet.getId();\n    try {\n        // if we have sheetId of ChartSheet, we will get nullpointer exception.\n\tPackagePart sheetPkg = sheetMap.get(sheetId);\n\treturn sheetPkg.getInputStream();\n    } catch(IOException e) {\n        throw new POIXMLException(e);\n    }\n}"}, {"count": 1, "tags": [], "creator": "zjuwufan@gmail.com", "attachment_id": 26185, "id": 140846, "time": "2010-10-20T01:21:17Z", "bug_id": 50119, "creation_time": "2010-10-20T01:21:17Z", "is_private": false, "text": "Created attachment 26185\nPatch to fix this issue."}, {"count": 2, "attachment_id": null, "creator": "apache@gagravarr.org", "is_private": false, "id": 140860, "time": "2010-10-20T11:14:55Z", "bug_id": 50119, "creation_time": "2010-10-20T11:14:55Z", "tags": [], "text": "Could you please upload a .xlsx file that triggers the problem? I'd like to get a unit test in for this, and none of the current chart .xlsx files seem to trigger it"}, {"count": 3, "tags": [], "creator": "zjuwufan@gmail.com", "attachment_id": 26188, "id": 140861, "time": "2010-10-20T11:45:28Z", "bug_id": 50119, "creation_time": "2010-10-20T11:45:28Z", "is_private": false, "text": "Created attachment 26188\nFile contains worksheet and chartsheet."}, {"count": 4, "tags": [], "creator": "zjuwufan@gmail.com", "is_private": false, "id": 140862, "attachment_id": null, "bug_id": 50119, "creation_time": "2010-10-20T11:50:22Z", "time": "2010-10-20T11:50:22Z", "text": ".xlsx file is attached.\n(In reply to comment #2)\n> Could you please upload a .xlsx file that triggers the problem? I'd like to get\n> a unit test in for this, and none of the current chart .xlsx files seem to\n> trigger it"}, {"count": 5, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 140863, "time": "2010-10-20T12:26:11Z", "bug_id": 50119, "creation_time": "2010-10-20T12:26:11Z", "is_private": false, "text": "Thanks, fixed in r1025630."}]