[{"count": 0, "tags": [], "bug_id": 30585, "text": "(Initially reported as SITIC Vulnerability Advisory SA04-001, redefined as bug \nafter discussion with ASF httpd security team)\n\nApache's mod_ssl module suffers from a format string bug when logging\ninformation about CRLs. If an administrator installs a malicious CRL file,\nthis bug can lead to the execution of arbitrary code.\n\nThe function ssl_callback_SSLVerify_CRL() in modules/ssl/ssl_engine_kernel.c\ncalls ap_log_error() with data from the CRL as the format string instead of\nusing the data as parameters, leading to a security breach.\n\nThis bug was discovered by Ulf Harnhammar for SITIC, Swedish IT \nIncident Centre.\n\nThe included patch \"issue1.patch\" is our attempt at correcting this issue:\n\n--- modules/ssl/ssl_engine_kernel.c\t2004-06-07 12:18:37.000000000 +0200\n+++ modules/ssl/ssl_engine_kernel.c.ulf\t2004-08-02 12:49:18.000000000 +0200\n@@ -1372,7 +1372,7 @@\n \n             BIO_free(bio);\n \n-            ap_log_error(APLOG_MARK, APLOG_DEBUG, 0, s, buff);\n+            ap_log_error(APLOG_MARK, APLOG_DEBUG, 0, s, \"%s\", buff);\n         }\n \n         /*", "id": 61805, "time": "2004-08-11T11:42:36Z", "creator": "sitic@pts.se", "creation_time": "2004-08-11T11:42:36Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 30585, "text": "Thanks for the report.  Should we credit Ulf Harnhammar for the fix in the\nCHANGES file?", "id": 61807, "time": "2004-08-11T11:57:17Z", "creator": "jorton@redhat.com", "creation_time": "2004-08-11T11:57:17Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "sitic@pts.se", "attachment_id": null, "text": "Please credit me/us as \"Ulf Harnhammar (SITIC)\".", "id": 61881, "time": "2004-08-12T13:06:24Z", "bug_id": 30585, "creation_time": "2004-08-12T13:06:24Z", "is_private": false}, {"count": 3, "tags": [], "creator": "jorton@redhat.com", "attachment_id": null, "text": "Thanks for the patch; this has been committed to HEAD:\n\nhttp://cvs.apache.org/viewcvs.cgi/httpd-2.0/modules/ssl/ssl_engine_kernel.c?r1=1.108&r2=1.109", "id": 62361, "time": "2004-08-23T20:20:33Z", "bug_id": 30585, "creation_time": "2004-08-23T20:20:33Z", "is_private": false}]