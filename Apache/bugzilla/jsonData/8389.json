[{"count": 0, "tags": [], "creator": "solomon@conceptshopping.com", "attachment_id": null, "is_private": false, "id": 14382, "time": "2002-04-23T01:16:08Z", "bug_id": 8389, "creation_time": "2002-04-23T01:16:08Z", "text": "Whenever somebody visits a page in https region of my server, (using\nbasic password authentication), one of the httpd processes on the server\ngoes into an infinite loop, pegged at 100% CPU.  I've tracked the problem down\nto the loop in ssl_io_input_getline at about line 704 in ssl_engine_io.c.\nIt appears that there are circumstances in which SSL_read on an ssl stream\ncan persistenly return 0.  The code in ssl_io_input_getline doesn't recognize\n0 as an error, so it just keeps trying, forever, in an infinite loop.\nI'm using openssl 0.9.6c.  The man page for SSL_read is--shall we say--\nchallenging, so I'm not sure whether this \"persistent 0\" behavior is a bug or\na feature, but it is quite repeatable in my setup.  When it occurs,\nSSL_get_error returns SSL_ERROR_ZERO_RETURN.\n\nFortunately, there's a one-line fix to ssl_io_input_getline:\n\n    while (tmplen > 0) {\n        status = ssl_io_input_read(ctx, buf + offset, &tmplen);\n\n        if (status != APR_SUCCESS) {\n            return status;\n        }\n\n        if (tmplen == 0) break;  /* <---- add this line */\n\n        *len += tmplen;\n\nI can't be sure this isn't simply plastering over some more serious problem,\nbut it seems to work for me.\n\nIf you need any additional info (version of solaris, httpd.conf file, phase\nof the moon ...) just ask."}, {"count": 1, "tags": [], "creator": "jerenkrantz@apache.org", "attachment_id": null, "text": "A similar fix was made by dougm into ssl_io_input_read to return APR_EOF when\nOpenSSL returns 0.  (This is one of the major gotchas we found right after\nreleasing 2.0.35.)\n\nThis fix is in modules/ssl/ssl_engine_io.c revision 1.73.  It will be included\nin the next release of Apache.\n\nThanks for using Apache!", "id": 14543, "time": "2002-04-23T22:23:58Z", "bug_id": 8389, "creation_time": "2002-04-23T22:23:58Z", "is_private": false}, {"count": 2, "text": "It would be nice if \"major gotchas\" were documented somewhere on the web\npage to save poor slobs like me from wasting a whole day tracking down\nthe bug only to be told \"oh yeah, we knew that\".", "bug_id": 8389, "attachment_id": null, "id": 14544, "time": "2002-04-23T22:28:20Z", "creator": "solomon@conceptshopping.com", "creation_time": "2002-04-23T22:28:20Z", "tags": [], "is_private": false}, {"text": "Well, sorry about that.\n\nThe best thing we can recommend is to search resolved bugs or download our\nlatest CVS snapshots.  Unfortunately, Bugzilla doesn't default to searching\nclosed bugs.\n\nWe are intending to do a 2.0.36 release in the next few days to address the PRs\nthat we have already fixed (and it's been a bunch).\n\nThanks for using Apache!", "tags": [], "bug_id": 8389, "attachment_id": null, "count": 3, "id": 14548, "time": "2002-04-23T22:33:01Z", "creator": "jerenkrantz@apache.org", "creation_time": "2002-04-23T22:33:01Z", "is_private": false}, {"count": 4, "tags": [], "creator": "jwoolley@apache.org", "attachment_id": null, "is_private": false, "id": 14552, "time": "2002-04-23T22:35:53Z", "bug_id": 8389, "creation_time": "2002-04-23T22:35:53Z", "text": "To add to what Justin said (since he and I were saying it at the same time and he beat me \nto it ;), if you suspect a bug, the best thing to do is always to check the CHANGES file \nin the development tree (http://cvs.apache.org/viewcvs.cgi/httpd-2.0/CHANGES)... that's \nour central repository of Things We've Fixed.  The STATUS file in that same directory is \nalso a good place to look, as it might mention known but outstanding issues. \n \nThanks...  "}, {"count": 5, "tags": [], "bug_id": 8389, "attachment_id": null, "text": "I did indeed search the bug database before launching into my own search\nof the source code.  I just tried again.  Keyword searches always come up empty.\nI finally tried searching all bugs involving mod_ssl in 2.0.35 in all states,\nand found out that my bug was a duplicate of 8165, which is listed as CLOSED\n(what's the difference between CLOSED and RESOLVED?)\n\nAs for searching http://cvs.apache.org/viewcvs.cgi/httpd-2.0/CHANGES ,\nI'm afraid that useless.  The CVS check-in message associated with the fix of\nthat bug is, in its entirety,\n\nPR: 7802\nObtained from:\nSubmitted by:\nReviewed by:\nfix compilation problem in ssl_engine_kernel.c\nif SSL_LIBRARY_VERSION >= 0x00907000", "id": 14557, "time": "2002-04-23T22:58:41Z", "creator": "solomon@conceptshopping.com", "creation_time": "2002-04-23T22:58:41Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 8389, "text": "Don't look at the commit log for CHANGES, look at the contents of CHANGES itself.  What I \nwas trying to get you to see was this in particular, though: \nhttp://cvs.apache.org/viewcvs.cgi/httpd-2.0/CHANGES.diff?r1=1.689&r2=1.690 \nWhen you go to http://cvs.apache.org/viewcvs.cgi/httpd-2.0/CHANGES, you have to click on \nthe version number of the most recent revision to see the file itself. \n \nThanks again. ", "id": 14562, "time": "2002-04-23T23:06:09Z", "creator": "jwoolley@apache.org", "creation_time": "2002-04-23T23:06:09Z", "is_private": false, "attachment_id": null}]