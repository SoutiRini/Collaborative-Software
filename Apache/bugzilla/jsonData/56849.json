[{"count": 0, "tags": [], "creator": "mjkim0324@hotmail.com", "is_private": false, "text": "Hi, \n\nI get a NPE in ClasspathUtils when calling ScriptMapper.mapFileName. \n\nHere is the test case. \n\nPublic void test1() throws Throwable {\n  SchemaValidate sv = new SchemaValidate();\n  sv.init();\n  Path path = sv.createClasspath();\n  ScriptMapper sm = new ScriptMapper();\n  sm.setClasspath(path);\n  sm.mapFileName(\"a\");\n}\n\nHere is the stack trace.\n1) test1(Test)java.lang.NullPointerException\n        at org.apache.tools.ant.util.ClasspathUtils$Delegate.getContextProject(ClasspathUtils.java:419)\n        at org.apache.tools.ant.util.ClasspathUtils$Delegate.getClassLoader(ClasspathUtils.java:411)\n        at org.apache.tools.ant.util.ScriptRunnerHelper.generateClassLoader(ScriptRunnerHelper.java:175)\n        at org.apache.tools.ant.util.ScriptRunnerHelper.getRunner(ScriptRunnerHelper.java:190)\n        at org.apache.tools.ant.util.ScriptRunnerHelper.getScriptRunner(ScriptRunnerHelper.java:55)\n        at org.apache.tools.ant.types.optional.AbstractScriptComponent.initScriptRunner(AbstractScriptComponent.java:107)\n        at org.apache.tools.ant.types.optional.ScriptMapper.mapFileName(ScriptMapper.java:81)\n        at Test.test1(Test.java:43)", "id": 177138, "time": "2014-08-13T14:48:05Z", "bug_id": 56849, "creation_time": "2014-08-13T14:48:05Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "mjkim0324@hotmail.com", "attachment_id": null, "text": "    private ClasspathUtils.Delegate getClassPathDelegate() {\n        if (cpDelegate == null) {\n            cpDelegate = ClasspathUtils.getDelegate(projectComponent);\n        }\n        return cpDelegate;\n    }\n\nIn ScriptRunnerHelper.getClassPathDelegate(), ProjectComponent is passed to create a Delegate object, but there is no checker that validates the status of ProjectComponent before passing. I think there should be a null checker for projectComponent like the null checker for cpDelegate.", "id": 177158, "time": "2014-08-14T08:46:17Z", "bug_id": 56849, "creation_time": "2014-08-14T08:46:17Z", "is_private": false}, {"count": 2, "tags": [], "text": "(In reply to Kim from comment #1)\n>     private ClasspathUtils.Delegate getClassPathDelegate() {\n>         if (cpDelegate == null) {\n>             cpDelegate = ClasspathUtils.getDelegate(projectComponent);\n>         }\n>         return cpDelegate;\n>     }\n> \n> In ScriptRunnerHelper.getClassPathDelegate(), ProjectComponent is passed to\n> create a Delegate object, but there is no checker that validates the status\n> of ProjectComponent before passing. I think there should be a null checker\n> for projectComponent like the null checker for cpDelegate.\n\nBy the way, getClassPathDelegate() is called during setClasspath(path)", "is_private": false, "id": 177160, "creator": "mjkim0324@hotmail.com", "time": "2014-08-14T08:49:01Z", "bug_id": 56849, "creation_time": "2014-08-14T08:49:01Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 56849, "attachment_id": null, "id": 177996, "time": "2014-09-21T09:20:31Z", "creator": "bodewig@apache.org", "creation_time": "2014-09-21T09:20:31Z", "is_private": false, "text": "This is not a supported way of using Ant's API.  git commit 13b0df1 will throw an IllegalStateException now"}]