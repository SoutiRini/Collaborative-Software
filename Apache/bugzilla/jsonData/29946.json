[{"count": 0, "tags": [], "bug_id": 29946, "attachment_id": null, "text": "Folks,\nThis is my first usage of bugzilla and I am not expirienced guy with it. I have \nwritten a new bug because I did not find something similar to this one.\n\nThe problem is based on incorrect generation XML reports for JUnit tests. I \nthink that problem based on multithread execution environment, I have started \nJUnitPerf test from Ant build and I've got a problem like this:\n  <testcase name=\"writeThread\" time=\"0.0\" time=\"0.0\"></testcase>\n  <testcase name=\"writeThread\" time=\"0.0\"></testcase>\n  <testcase name=\"readThread\"></testcase>\n  <testcase name=\"readThread\" time=\"0.0\"></testcase>\n\nthe time attribute is duplicated or omitted. CruiseControl cannot parse it \nworks with errors. \n\nI put into bug description body of JUnitPerf test ipmlementation below.\n\n/**\n * @author Victor S.\n */\npublic class DbIdStorageFactoryThreadSafeTestCase extends TestCase\n{\n\n    public DbIdStorageFactoryThreadSafeTestCase(String name)\n    {\n        super(name);\n    }\n\n    public static Test suite() {\n        TestSuite suite = new TestSuite();\n        DbIdStorageFactoryThreadSafeTestCase writeThread = new \nDbIdStorageFactoryThreadSafeTestCase(\"writeThread\");\n        DbIdStorageFactoryThreadSafeTestCase readThread = new \nDbIdStorageFactoryThreadSafeTestCase(\"readThread\");\n        suite.addTest(writeThread);\n        suite.addTest(readThread);\n        int CONCURENT_USERS = 10;\n        LoadTest loadTest = new LoadTest(suite, CONCURENT_USERS, 200);\n        loadTest.setEnforceTestAtomicity(true);\n        return loadTest;\n    }\n\n    public void writeThread()\n    {\n// do something, sleep(0)\n    }\n\n    public void readThread()\n    {\n// do something, sleep(0)\n    }\n\n}\n\nI did not work with ant-junit SRCs deeply neverthless I think that \norg.apache.tools.ant.taskdefs.optional.junit.XMLJUnitResultFormatter is not \nthread safe.\nI am ready to give more information about this issue.\nThank you.\nVictor S.\nEPAM, Lead Developer.", "id": 60226, "time": "2004-07-07T10:51:58Z", "creator": "shefbel@yahoo.com", "creation_time": "2004-07-07T10:51:58Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 29946, "attachment_id": null, "id": 63972, "creation_time": "2004-09-21T12:20:49Z", "time": "2004-09-21T12:20:49Z", "creator": "bodewig@apache.org", "text": "Are you sure about the version - since we fixed a thread-safety bug in Ant\nalmost three years ago.\n\nLooking through the code, the time attribute gets associated with the test via\nthe Test instance (i.e. the actual test being run).  I don't know how JUnitPerf\nworks, but maybe it is reusing the same test object in multiple threads?  This\nwould explain the output you see.", "is_private": false}, {"count": 2, "text": "probably more a JUnitPerf problem - or we'd need more info.", "bug_id": 29946, "is_private": false, "id": 118475, "time": "2008-07-10T08:19:26Z", "creator": "bodewig@apache.org", "creation_time": "2008-07-10T08:19:26Z", "tags": [], "attachment_id": null}]