[{"attachment_id": null, "tags": [], "bug_id": 32660, "is_private": false, "count": 0, "id": 68324, "time": "2004-12-12T21:03:31Z", "creator": "aaflatooni@yasna.com", "creation_time": "2004-12-12T21:03:31Z", "text": "Hi,\nThis could be a security bug.\n\nI am running apache and tomcat together. The Apache handles all the web \ntraffic and passes the JSP files to the Tomcat workers. I have this configured \nin the virtualhost.\n\nThis is done using the following configuration in the httpd.conf.\n\n<VirtualHost www.yasna.com:80>\n    ServerAdmin support@yasna.com\n    ServerName www.yasna.com\n    ServerAlias yasna.com\n    DocumentRoot /web/yasna\n    ErrorLog /web/yasna/logs/og-error_log\n    RewriteEngine On\n    ErrorDocument 500 /error/index.html\n    ErrorDocument 404 /error/notfound.html\n    CustomLog /web/yasna/logs/og-access_log combined\n        <Location \"/*.jsp\">\n                JkUriSet worker ajp13:localhost:8009\n        </Location>\n        <Location \"/servlet/*\">\n                JkUriSet worker ajp13:localhost:8009\n        </Location>\n</VirtualHost>\n\nEverything is fine when I access the site using the http://www.yasna.com and \nall the jsp files are returning proper (parsed) pages. \n\nBut if I access the site using the server alias http://yasna.com the jsp pages \non the root directory is returned properly only. The pages in the sub-\ndirectory returns the jsp code. To fix the problem I had to make modifications \nto the configuration and add the following lines:\n        <Location \"/*/*.jsp\">\n                JkUriSet worker ajp13:localhost:8009\n        </Location>\n        <Location \"/*/*/*.jsp\">\n                JkUriSet worker ajp13:localhost:8009\n        </Location>\nAnd this works for me, as I only have 2 levels of subdirectories.\nWith the updated configuration everything is working now, but this is a \nserious problem. \n\nPlease note that this problem exists only when I access the site using the \nserver alias. When I access the site using http://www.yasna.com all the jsp \nfiles in all the directories are parsed by tomcat and returned properly.\n\nAflatoon"}, {"count": 1, "tags": [], "creator": "aaflatooni@yasna.com", "attachment_id": null, "text": "I thought I should add a comment to clarify things:\nSo the following pages work properly\n\nhttp://www.yasna.com/test.jsp\nhttp://www.yasna.com/test/test.jsp\nhttp://yasna.com/test.jsp\n\nBut the following page doesn't work:\n\nhttp://yasna.com/test/test.jsp\n\nI get the jsp code and the page isn't parsed by Tomcat.\nPlease comment\nAflatoon", "id": 68325, "time": "2004-12-12T21:06:35Z", "bug_id": 32660, "creation_time": "2004-12-12T21:06:35Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 32660, "is_private": false, "count": 2, "id": 68330, "time": "2004-12-13T02:51:39Z", "creator": "nick@webthing.com", "creation_time": "2004-12-13T02:51:39Z", "text": "Please use a user support forum for configuration questions.  The <Location>\ndirective is working correctly; it just isn't what you should be using."}]