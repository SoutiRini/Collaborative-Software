[{"count": 0, "tags": [], "bug_id": 57151, "text": "Created attachment 32150\nThe patch (generated from SVN on the current revision)\n\nIn the current version of POI it is easy to generate merged cells in an XLSX document, that excel fails to read, if merged regions overlap or are of zero or negative size.\n\nMy patch is very simple, but helpful. It documents the constructor of CellRangeAddress, because to Java developers it is not obvious, that the end-index is included in the range. The common practice in Java API is that the end index is the index of the first not-included element.\n\nSecondly, it adds the check, that lastRow (lastCol) cannot be less than firstRow (firstCol). This check may cause minor backward incompatibility, but only in cases, when the generated output was already unreadable by Excel. Similar check was already implemented for the HSSF format, in InternalSheet.java, line 447 (addMergedRegion method). So it will not cause incompatibility here, the error will just be reported earlier.\n\nIt could be helpful to add overlap check, but this will be an more in-depth patch. HSSF format, unlike XSSF, seems to forgive this error: http://apache-poi.1045710.n5.nabble.com/XSSFSheet-addMergedRegion-giving-excel-error-td3389764.html", "id": 178771, "time": "2014-10-27T12:58:01Z", "creator": "a6537691@bofthew.com", "creation_time": "2014-10-27T12:58:01Z", "is_private": false, "attachment_id": 32150}, {"count": 1, "tags": [], "bug_id": 57151, "is_private": false, "text": "Thanks for the patch, applied via r1635389.\n\n\nI also added some more unit tests to verify the changes, would be nice if you can provide an accompanying unit-test as part of future patches.", "id": 178841, "time": "2014-10-30T07:51:31Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2014-10-30T07:51:31Z", "attachment_id": null}]