[{"attachment_id": 22081, "tags": [], "creator": "nmische@gmail.com", "text": "Created attachment 22081\nPatch for resizeToFitText\n\nTextShape.resizeToFitText() does not appear to properly size the TextShape. Take for example the following code:\n\nSlideShow ppt = new SlideShow();\nSlide slide = ppt.createSlide();\nTextBox title = slide.addTitle();\ntitle.setText(\"Title Line One\\nTitle Line Two\");\ntitle.resizeToFitText();\n\t    \n//save changes \nFileOutputStream out = new FileOutputStream(\"test.ppt\");\nppt.write(out);\nout.close();\n\nThe title TextBox created by this example is much wider than the text and is only the height of a single line, although the title has multiple lines of text. \n\nFrom my investigation there appear to be two issues with the size calculation. \n\nFirst, the text doesn't seem to properly split into lines. The existing code attempts to split on \\r but I've found it needs to split on \\n.\n\nSecond, the TextShape height is set to the highest line, not the cumulative height of all of the lines.\n\nI've attached a patch which in my testing seems to do a better job at sizing the TextShape.", "count": 0, "id": 117379, "time": "2008-06-05T07:42:59Z", "bug_id": 45140, "creation_time": "2008-06-05T07:42:59Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "yegor@dinom.ru", "text": "Thanks for the patch. It will be included in 3.1-final.\n\nRegards,\nYegor", "count": 1, "id": 117391, "time": "2008-06-05T09:16:08Z", "bug_id": 45140, "creation_time": "2008-06-05T09:16:08Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "yegor@dinom.ru", "text": "Patch applied in r664492. Thanks.\n\nYegor", "count": 2, "id": 117479, "time": "2008-06-08T05:32:56Z", "bug_id": 45140, "creation_time": "2008-06-08T05:32:56Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 45140, "attachment_id": 35038, "id": 199105, "time": "2017-06-08T14:52:14Z", "creator": "dictoon@gmail.com", "creation_time": "2017-06-08T14:52:14Z", "is_private": false, "text": "Created attachment 35038\nText overflowing its textbox"}, {"count": 4, "tags": [], "creator": "dictoon@gmail.com", "text": "It looks like this no longer works properly.\n\nThe following code results in the text overflowing the textbox:\n\nXSLFTextBox textBox = slide.createTextBox();\nXSLFTextParagraph paragraph = textBox.getTextParagraphs().get(0);\nXSLFTextRun textRun = paragraph.addNewTextRun();\ntextRun.setText(\"TRENDALERT | Summer trends for men.\\n T-shirts and shirts with tropical prints. Bomberjacks are still a musthave.\");\ntextBox.setAnchor(new Rectangle(left, top, width, 10000));\ntextBox.resizeToFitText();\n\nI've attached a screenshot of the text overflowing the textbox in PowerPoint 2016: https://bz.apache.org/bugzilla/attachment.cgi?id=35038", "id": 199106, "time": "2017-06-08T14:52:56Z", "bug_id": 45140, "creation_time": "2017-06-08T14:52:56Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 45140, "attachment_id": null, "text": "Ah, it appears that the bug was initially fixed in the HSLF API and not in the XSLF API, which we are using...", "id": 199109, "time": "2017-06-08T15:42:43Z", "creator": "dictoon@gmail.com", "creation_time": "2017-06-08T15:42:43Z", "is_private": false}]