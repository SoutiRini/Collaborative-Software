[{"count": 0, "text": "Content with \"Content-Encoding\" header, content is encoded.\nBut mod_deflate does not check it. It cause to encode content twice.\n\nThis problem is reproduceible by get encoded content via mod_proxy.\n\n\nFollowing is my trivial patch:\n------------------------------------------------------------\n--- mod_deflate.c\t17 May 2002 11:33:09 -0000\t1.5\n+++ mod_deflate.c\t17 May 2002 16:16:49 -0000\n@@ -274,4 +274,11 @@\n         }\n \n+        /* encoded yet? */\n+        accepts = apr_table_get(r->headers_out, \"Content-Encoding\");\n+        if (accepts) {\n+\n    ap_remove_output_filter(f);\n+\n    return ap_pass_brigade(f->next, bb);\n+\n}\n+\n         /* if they don't have the line, then they can't play */\n         accepts = apr_table_get(r->headers_in, \"Accept-Encoding\");\n------------------------------------------------------------\n\nWorkaround for existing environment:\n------------------------------------------------------------\n<IfModule mod_deflate.c>\n    SetEnvIf Content-Encoding \".*\" no-gzip\n</IfModule>\n------------------------------------------------------------\n\n\nThanks for read my broken English.", "creator": "kaz@asada.sytes.net", "is_private": false, "id": 16362, "time": "2002-05-18T13:35:35Z", "bug_id": 9222, "creation_time": "2002-05-18T13:35:35Z", "tags": [], "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 9222, "attachment_id": null, "id": 16393, "time": "2002-05-20T00:08:11Z", "creator": "ianh@apache.org", "creation_time": "2002-05-20T00:08:11Z", "is_private": false, "text": "fixed in current CVS tree\nThanks Kazuhisa."}]