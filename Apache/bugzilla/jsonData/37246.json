[{"count": 0, "tags": [], "bug_id": 37246, "attachment_id": null, "text": "Election method T is electing a worker depending on the amount of traffic to the workers. If we put a \nconstant load on the server using ab -c 150 -n 1000000 http://my.site/page.\n\nBy refreshing the jkstatus page a lot we're obvserving that this election method choses the same worker \nfor all requests for around a second or so, effectively having 150 long busy queue on one worker whilst \nthe others are at 0. In other words we're blitzing one worker with the whole load at a time.\n\nI can only speculate to why this is, but if for instance the traffic counters on the workers are only updated \nevery second, simply looking at those counters would elect the same worker for a second at a time.", "id": 81747, "time": "2005-10-26T08:14:49Z", "creator": "puckman@taglab.com", "creation_time": "2005-10-26T08:14:49Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "rainer.jung@kippdata.de", "text": "Which version of mod_jk and of apache?\nWhat is the average response time of /page? Is it around one second? Traffic\ncounters are only updated after the response is received from tomcat.\n\nHow does it look like after a minute or so. Does it correctly balance then?", "count": 1, "id": 81752, "time": "2005-10-26T09:08:17Z", "bug_id": 37246, "creation_time": "2005-10-26T09:08:17Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 37246, "attachment_id": null, "text": "Version is the latest release, 1.2.14 running on an apache2 in prefork mode.\n\nAverage response time of the page is about 3ms.\n\nI could observe this behaviour for a few minutes - didn't run it much longer.\nHow long would make a difference?", "id": 81849, "time": "2005-10-27T20:06:58Z", "creator": "puckman@taglab.com", "creation_time": "2005-10-27T20:06:58Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 37246, "attachment_id": null, "id": 86950, "time": "2006-03-17T09:09:50Z", "creator": "mturk@apache.org", "creation_time": "2006-03-17T09:09:50Z", "is_private": false, "text": "Fixed in the SVN.\nThe problem was caused because locking was improper.\nAnyhow for prefork the solution is to add\nworker.loadbalancer.lock=P\nSee:\nhttp://cvs.apache.org/viewcvs.cgi?rev=386277&view=rev"}]