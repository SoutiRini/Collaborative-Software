[{"count": 0, "tags": [], "creator": "tpelletier@affinnova.com", "attachment_id": null, "id": 147653, "creation_time": "2011-06-30T16:02:28Z", "time": "2011-06-30T16:02:28Z", "bug_id": 51455, "text": "What I would like to have is the ability from the HSSFComment class to set a background picture.  I know that your code preserves pictures if they are already there but I could not find a straight forward, or a not so straight forward way to set the background picture.\n\nIf there exists a convoluted way to pull-off setting the background picture of a comment, please let me know.\n\nTo add a background picture to a comment in Excel it's not straight forward, to the point where if you weren't walked through it, you probably wouldn't think it was possible. To add a background picture to a comment to a cell, right click on the boarder of the comment(not in the comment itself), select \"format comment...\", select the \"color and lines\" tab, click on the color pull-down, select \"fill effects\", select the picture tab, then you're finally at the dialog that will let you add a picture to the background of a comment.\n\nThanks for reading my bug and hopefully you'll get around to implemented it in the not too distant future.  This would make my product owners day, if I could problematically add a background picture to a comment", "is_private": false}, {"count": 1, "tags": [], "text": "This problem should be fixed in trunk.\n\nPlease try with a nightly build - see download links on http://poi.apache.org/\nor build yourself from SVN trunk, see http://poi.apache.org/subversion.html\n\nHere is an example of code you can use to set backgroung image of comment:\n\npublic class Test {\n\n    public static void main(String[] args) throws IOException {\n        Workbook workbook = new HSSFWorkbook();\n        Sheet sheetA = workbook.createSheet();\n\n        int idx = loadPicture(\"test.png\", (HSSFWorkbook) workbook);\n        HSSFPatriarch patriarch = (HSSFPatriarch) sheetA.createDrawingPatriarch();\n        HSSFComment comment = patriarch.createCellComment(new HSSFClientAnchor(0,0,0,0,(short)0,0,(short)10,10));\n        comment.setString(new HSSFRichTextString(\"HSSF POI comment background image\"));\n        comment.setBackgroundImage(idx);\n        FileOutputStream fos = new FileOutputStream(\"comment_backgroung_image.xls\");\n        workbook.write(fos);\n        fos.close();\n    }\n\n    private static int loadPicture( String path, HSSFWorkbook wb ) throws IOException\n    {\n        int pictureIndex;\n        FileInputStream fis = null;\n        ByteArrayOutputStream bos = null;\n        try\n        {\n            fis = new FileInputStream( path);\n            bos = new ByteArrayOutputStream( );\n            int c;\n            while ( (c = fis.read()) != -1)\n                bos.write( c );\n            pictureIndex = wb.addPicture( bos.toByteArray(), HSSFWorkbook.PICTURE_TYPE_PNG );\n        }\n        finally\n        {\n            if (fis != null)\n                fis.close();\n            if (bos != null)\n                bos.close();\n        }\n        return pictureIndex;\n    }\n}", "is_private": false, "id": 161290, "creator": "superrubiroyd@gmail.com", "time": "2012-08-12T11:30:01Z", "bug_id": 51455, "creation_time": "2012-08-12T11:30:01Z", "attachment_id": null}]