[{"count": 0, "attachment_id": null, "creator": "timw@mediatel.co.uk", "text": "I have been writing an Excel file generator that takes a template xls file and\nmodifies it to insert data. I have successfully been creating xls files working\nwith the 2.0 release but after I upgraded to the 2.5 release although the code\nstill executes without error but the xls that is generated can not be read by MS\nExcel or Open Office.\n\nI've been talking on the forum about this and various people have mentioned the\n Escher layer but even using templates that do not contain graphics still do not\nwork.\n\nWhen I tried to examine the 2.5 generated file with the biff viewer it errored\nwith the message:\n\n[WARNING] Unknown Ptg 0 (0)\n[WARNING] Unknown Ptg 0 (0)\n[WARNING] Unknown Ptg 0 (0)\njava.lang.NegativeArraySizeException\n       at\norg.apache.poi.hssf.dev.BiffViewer.createRecords(BiffViewer.java:147)\n       at org.apache.poi.hssf.dev.BiffViewer.run(BiffViewer.java:110)\n       at org.apache.poi.hssf.dev.BiffViewer.main(BiffViewer.java:693)/\n\n(I get the \"[WARNING] Unknown Ptg 0 (0)/\" messages with the 2.0 file as well so\nI don't think they have anything to with the problem.)\n\n\nDuring the development of my code I have had to make a small change to the POI\nreleases I have used. I'm pretty sure the changes I've made are not relevant to\nthis problem but for my code to successfully execute it requires my modified\nversion of the POI API. \n\nThe changes I have made are just to make the following classes implement the\n\"java.io.Serializable\" class:\n\norg.apache.poi.hssf.usermodel.HSSFCell\norg.apache.poi.hssf.usermodel.HSSFCellStyle\norg.apache.poi.hssf.record.Record \n\n(I've already submitted a bug report to include these changes in the next\nstandard release bugzill id 27333)\n\nI'll attach the following files to this bug report:\n\nPOI_2.0(tim).jar (my modified version of the POI 2.0 release);\nPOI_2.5(tim).jar (my modified version of the POI 2.5 release);\nCMSExcelGenerator.jar (the binaries of all my own required classes);\nClientPlanGenerator.java (the source code of my main class that manipulates the\nxls template);\nAllEncompassPlan.xls (my template excel file, no images, no macros!);\nClientPlanGenerator.properties (my log4j config file);\nlog4j-1.2.8.jar (log4j jar);\n\nPlease feel free to contact me if you need any other files (think they are all\nyou need) or to ask any questions regarding my code.\n\nMany Thanks,\n\nTim Wilkins", "id": 58614, "time": "2004-06-03T10:46:20Z", "bug_id": 29357, "creation_time": "2004-06-03T10:46:20Z", "tags": [], "is_private": false}, {"count": 1, "attachment_id": 11737, "creator": "timw@mediatel.co.uk", "is_private": false, "id": 58615, "time": "2004-06-03T10:56:50Z", "bug_id": 29357, "creation_time": "2004-06-03T10:56:50Z", "tags": [], "text": "Created attachment 11737\nmy log4j config file"}, {"count": 2, "tags": [], "bug_id": 29357, "text": "Created attachment 11738\nthe source code of my main class that manipulates the xls template", "id": 58616, "time": "2004-06-03T10:57:26Z", "creator": "timw@mediatel.co.uk", "creation_time": "2004-06-03T10:57:26Z", "is_private": false, "attachment_id": 11738}, {"count": 3, "attachment_id": 11739, "creator": "timw@mediatel.co.uk", "text": "Created attachment 11739\nthe source code of my main class that manipulates the xls template", "id": 58617, "time": "2004-06-03T10:59:39Z", "bug_id": 29357, "creation_time": "2004-06-03T10:59:39Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 29357, "text": "Created attachment 11740\nmy template excel file, no images, no macros!", "id": 58618, "time": "2004-06-03T11:00:43Z", "creator": "timw@mediatel.co.uk", "creation_time": "2004-06-03T11:00:43Z", "is_private": false, "attachment_id": 11740}, {"count": 5, "tags": [], "bug_id": 29357, "text": "Created attachment 11741\nthe binaries of all my own required classes", "id": 58619, "time": "2004-06-03T11:01:28Z", "creator": "timw@mediatel.co.uk", "creation_time": "2004-06-03T11:01:28Z", "is_private": false, "attachment_id": 11741}, {"count": 6, "attachment_id": 11742, "creator": "timw@mediatel.co.uk", "is_private": false, "id": 58620, "time": "2004-06-03T11:02:10Z", "bug_id": 29357, "creation_time": "2004-06-03T11:02:10Z", "tags": [], "text": "Created attachment 11742\nlog4j jar"}, {"count": 7, "tags": [], "creator": "timw@mediatel.co.uk", "attachment_id": 11743, "is_private": false, "id": 58621, "time": "2004-06-03T11:05:39Z", "bug_id": 29357, "creation_time": "2004-06-03T11:05:39Z", "text": "Created attachment 11743\nmy modified version of the POI 2.5 release"}, {"count": 8, "tags": [], "creator": "timw@mediatel.co.uk", "text": "Created attachment 11744\nmy modified version of the POI 2.0 release", "id": 58622, "attachment_id": 11744, "bug_id": 29357, "creation_time": "2004-06-03T11:07:33Z", "time": "2004-06-03T11:07:33Z", "is_private": false}, {"text": "Not sure what code was altered to fix this problem but I just checked out the\nREL_2_BRANCH of the 2.5 code and this bug has been fixed. \n\nThanks to all who have been bug fixing the 2.5 release! ", "tags": [], "bug_id": 29357, "is_private": false, "count": 9, "id": 60287, "time": "2004-07-08T10:15:24Z", "creator": "timw@mediatel.co.uk", "creation_time": "2004-07-08T10:15:24Z", "attachment_id": null}, {"count": 10, "tags": [], "creator": "avik@apache.org", "attachment_id": null, "is_private": false, "id": 60288, "time": "2004-07-08T10:19:21Z", "bug_id": 29357, "creation_time": "2004-07-08T10:19:21Z", "text": "If you checked out latest CVS on REL_2_BRANCH, yes, certain fixes were applied\nto it about two weeks ago for the re-write corruption issue. Thanks for testing\nand confirming on this bug. "}]