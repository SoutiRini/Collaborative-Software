[{"count": 0, "tags": [], "text": "I have a media server running on port 1755 using ICY protocols to inform the \nmedia client of the data stream it is going to recieve. I decided to use \nmod_proxy to proxypass to my backend server for users that are in enviroments \nthat block all ports except 80 and 443\n<location /muziK>\nProxyPass http://localhost:1755/\n</location>\nWhile testing I discovered that mod_proxy takes all data returned from the \nmedia server and considers it as content, ignoring my ICY headers, preappending \nits own headers to the data being returned to the requesting client.\nExample:\nHTTP/1.1 200 OK\nDate: Tue, 20 Sep 2005 14:42:45 GMT\nTransfer-Encoding: chunked\nContent-Type: text/plain\n\n\n10465\nICY 200 OK\nicy-notice1:MuziK stream server\nicy-notice2:Use winamp or media player to stream\nicy-genre:Mixed\nicy-name:test-song\nicy-url:www.example.com\nicy-metaint:8192\nicy-br:56\nConnection: close\nServer: 1.0 \nContent-type: application/ogg\nContent-length: 10354\nConnection: close\nMPEG data Stream MPEG data Stream MPEG data Stream\n\nA client recieving this data will consider all of the content as MPEG data.\nWith this data, the client is unable to determine the media, especially when the\nmedia is a mount or ogg and contains icy-br and icy-metaint. A client streaming \ndata with ICY metadata and not knowing of the header icy-metaint, will assume \nthe data is mpeg and it will play back, reproducing gliches.\nI know I can set or append headers in the location entry of my httpd.conf, but \nthat will only allow one type of media and not allow ICY metadata.\nIs there a way to turn off all headers produced by mod_proxy, including \nHTTP/1.1 200 OK ??? The backend server should decide if it is 200 OK or not, \nunless backend is not responding. And the backend server should be able to \npassively send its headers through. \n\nThis is reproducible in a win32 and linux configure apache/mod_proxy\n\nLet me know if there is a resolution for this.\nThanks\nALLAN", "attachment_id": null, "id": 80198, "creator": "admin@swicago.com", "time": "2005-09-20T18:30:01Z", "bug_id": 36737, "creation_time": "2005-09-20T18:30:01Z", "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 36737, "is_private": false, "id": 80204, "time": "2005-09-20T19:45:19Z", "creator": "nick@webthing.com", "creation_time": "2005-09-20T19:45:19Z", "tags": [], "text": "If your backend is responding \"ICY 200 OK\" to an HTTP request, then presumably \nit preceded that with protocol-negotiation (101/Upgrade)?  Or is it just \nbroken? \n \nIf that response is the whole story, then the proxy is correctly interpreting \nit as an HTTP/0.9 response and passing it through.  If you want us to believe \notherwise, please supply a URL that allows us to reproduce the problem. \n "}, {"count": 2, "attachment_id": null, "bug_id": 36737, "is_private": false, "id": 80205, "time": "2005-09-20T20:00:34Z", "creator": "admin@swicago.com", "creation_time": "2005-09-20T20:00:34Z", "tags": [], "text": "It doesn't matter if the backend server replies with HTTP/1.1 200 OK or with \nICY 200 OK. I have tested it with both and mod_proxy does not preserve headers \ncoming from back end server. \nIf my back end server sends Content-Type: audio/mpeg\napache mod_proxy will put my header as a part of content and write its own \nheader Content-Type: text/plain\n\nThere should be a way to tell mod_proxy not to do this and let the backend \nserver send the headers to the client. \\\nExample:\nHTTP/1.1 200 OK     or ICY 200 OK (doesn't make any difference)\nicy-notice1:MuziK stream server\nicy-notice2:Use winamp or media player to stream\nicy-genre:Mixed\nicy-name:test-song\nicy-url:www.example.com\nicy-metaint:8192\nicy-br:56\nConnection: close\nServer: 1.0 \nContent-type: application/ogg\nContent-length: 10354\nConnection: close\n\nmod_proxy in this case should not pass its own headers, instead be told that \nthe backend server will do this."}, {"count": 3, "tags": [], "bug_id": 36737, "attachment_id": null, "id": 80206, "time": "2005-09-20T20:22:07Z", "creator": "nick@webthing.com", "creation_time": "2005-09-20T20:22:07Z", "is_private": false, "text": "You STILL haven't supplied a URL to demonstrate the alleged bug.  Until and  \nunless you do so, I can only infer that either your config or your backend is  \nbroken. "}, {"count": 4, "tags": [], "bug_id": 36737, "text": "I suspect this is a major configuration bug, the configuration is non-trivial,\nand ICY isn't a registered HTTP method.\n\nClosing as a bug report, and direct you to the users@httpd.apache.org list where\nyou can find like-minded users looking for clever ways to accomplish this.  Hint,\nyou can force the ICY request type by adding it to the known methods list.", "id": 80208, "time": "2005-09-20T20:43:12Z", "creator": "wrowe@apache.org", "creation_time": "2005-09-20T20:43:12Z", "is_private": false, "attachment_id": null}]