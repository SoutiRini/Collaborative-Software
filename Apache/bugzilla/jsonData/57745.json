[{"count": 0, "tags": [], "bug_id": 57745, "text": "httpd exits 1 quickly after launch with no stderr when proxy_balancer_module (and proxy_module) is enabled.  This makes it extremely difficult to determine what the problem is.\n\nIn general, I'm trying to enable proxies and use proxy_balancer_module.  However, even though mod_proxy loads fine, whenever I uncomment loading mod_proxy_balancer.so, httpd exits with 1 and no stderr.\n\nBuilt from source:\n\napr-1.5.1\napr-util-1.5.4 --with-ldap\n\nhttpd-2.4.12:\n./configure --prefix=/usr/local/apache2 --enable-mods-shared=all --enable-ldap --enable-auth-ldap --enable-authnz-ldap --enable-ssl --with-ldap --with-apr=/usr/local/apr/bin/apr-1-config --with-apr-util=/usr/local/apr/bin/apu-1-config\n\nMostly using the default .conf, the extra module loading is in a different .conf under sites, reproduced below.\n\n\nServerRoot \"/usr/local/apache2\"\n\nListen 80\n\nLoadModule authn_file_module modules/mod_authn_file.so\nLoadModule authn_core_module modules/mod_authn_core.so\nLoadModule authz_host_module modules/mod_authz_host.so\nLoadModule authz_groupfile_module modules/mod_authz_groupfile.so\nLoadModule authz_user_module modules/mod_authz_user.so\nLoadModule authz_core_module modules/mod_authz_core.so\nLoadModule access_compat_module modules/mod_access_compat.so\nLoadModule auth_basic_module modules/mod_auth_basic.so\nLoadModule reqtimeout_module modules/mod_reqtimeout.so\nLoadModule filter_module modules/mod_filter.so\nLoadModule mime_module modules/mod_mime.so\nLoadModule log_config_module modules/mod_log_config.so\nLoadModule env_module modules/mod_env.so\nLoadModule headers_module modules/mod_headers.so\nLoadModule setenvif_module modules/mod_setenvif.so\nLoadModule version_module modules/mod_version.so\nLoadModule unixd_module modules/mod_unixd.so\nLoadModule status_module modules/mod_status.so\nLoadModule autoindex_module modules/mod_autoindex.so\nLoadModule dir_module modules/mod_dir.so\nLoadModule alias_module modules/mod_alias.so\n\n<IfModule unixd_module>\nUser daemon\nGroup daemon\n</IfModule>\n\nServerAdmin you@example.com\n\n<Directory />\n    AllowOverride none\n    Require all denied\n</Directory>\n\nDocumentRoot \"/usr/local/apache2/htdocs\"\n<Directory \"/usr/local/apache2/htdocs\">\n    Options Indexes FollowSymLinks\n    AllowOverride None\n    Require all granted\n</Directory>\n\n<IfModule dir_module>\n    DirectoryIndex index.html\n</IfModule>\n\n<Files \".ht*\">\n    Require all denied\n</Files>\n\nErrorLog \"logs/error_log\"\n\nLogLevel warn\n\n<IfModule log_config_module>\n    LogFormat \"%h %l %u %t \\\"%r\\\" %>s %b \\\"%{Referer}i\\\" \\\"%{User-Agent}i\\\"\" combined\n    LogFormat \"%h %l %u %t \\\"%r\\\" %>s %b\" common\n\n    <IfModule logio_module>\n      LogFormat \"%h %l %u %t \\\"%r\\\" %>s %b \\\"%{Referer}i\\\" \\\"%{User-Agent}i\\\" %I %O\" combinedio\n    </IfModule>\n\n    CustomLog \"logs/access_log\" common\n</IfModule>\n\n<IfModule alias_module>\n    ScriptAlias /cgi-bin/ \"/usr/local/apache2/cgi-bin/\"\n</IfModule>\n\n<IfModule cgid_module>\n</IfModule>\n\n<Directory \"/usr/local/apache2/cgi-bin\">\n    AllowOverride None\n    Options None\n    Require all granted\n</Directory>\n\n<IfModule mime_module>\n    TypesConfig conf/mime.types\n\n    AddType application/x-compress .Z\n    AddType application/x-gzip .gz .tgz\n</IfModule>\n\n<IfModule proxy_html_module>\nInclude conf/extra/proxy-html.conf\n</IfModule>\n\n<IfModule ssl_module>\nSSLRandomSeed startup builtin\nSSLRandomSeed connect builtin\n</IfModule>\n\nInclude /usr/local/apache2/conf/sites/*.conf\n\n\n\n### in sites/*.conf:\n\nListen 443\n\nLoadModule cgid_module modules/mod_cgid.so\nLoadModule authnz_ldap_module modules/mod_authnz_ldap.so\nLoadModule ldap_module modules/mod_ldap.so\n\nLoadModule ssl_module modules/mod_ssl.so\nLoadModule authn_socache_module modules/mod_authn_socache.so\nLoadModule socache_shmcb_module modules/mod_socache_shmcb.so\n\n#LoadModule proxy_html_module modules/mod_proxy_html.so\nLoadModule proxy_module modules/mod_proxy.so\n#LoadModule proxy_connect_module modules/mod_proxy_connect.so\n#LoadModule proxy_ftp_module modules/mod_proxy_ftp.so\nLoadModule proxy_http_module modules/mod_proxy_http.so\n#LoadModule proxy_fcgi_module modules/mod_proxy_fcgi.so\n#LoadModule proxy_scgi_module modules/mod_proxy_scgi.so\n#LoadModule proxy_fdpass_module modules/mod_proxy_fdpass.so\n#LoadModule proxy_wstunnel_module modules/mod_proxy_wstunnel.so\n#LoadModule proxy_ajp_module modules/mod_proxy_ajp.so\n#LoadModule proxy_express_module modules/mod_proxy_express.so\nLoadModule proxy_balancer_module modules/mod_proxy_balancer.so\nLoadModule lbmethod_byrequests_module modules/mod_lbmethod_byrequests.so\nLoadModule lbmethod_bytraffic_module modules/mod_lbmethod_bytraffic.so\nLoadModule lbmethod_bybusyness_module modules/mod_lbmethod_bybusyness.so\nLoadModule lbmethod_heartbeat_module modules/mod_lbmethod_heartbeat.so\n\n\n#LoadModule xml2enc_module modules/mod_xml2enc.so\n\n\nSSLSessionCache        \"shmcb:/usr/local/apache2/logs/ssl_scache(512000)\"\nSSLSessionCacheTimeout  300", "id": 182009, "time": "2015-03-23T20:05:00Z", "creator": "john@smadness.com", "creation_time": "2015-03-23T20:05:00Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "covener@gmail.com", "attachment_id": null, "text": "maybe the slotmem requirement?", "id": 182011, "time": "2015-03-23T20:16:40Z", "bug_id": 57745, "creation_time": "2015-03-23T20:16:40Z", "is_private": false}, {"count": 2, "tags": [], "creator": "john@smadness.com", "text": "Are you talking about https://bz.apache.org/bugzilla/show_bug.cgi?id=52841\n\nAlso, I should have included the debug output:\n\n% sudo /usr/local/apache2/bin/httpd -e debug -X\n[Mon Mar 23 12:58:19.743679 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module authn_file_module from /usr/local/apache2/modules/mod_authn_file.so\n[Mon Mar 23 12:58:19.744064 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module authn_core_module from /usr/local/apache2/modules/mod_authn_core.so\n[Mon Mar 23 12:58:19.744195 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module authz_host_module from /usr/local/apache2/modules/mod_authz_host.so\n[Mon Mar 23 12:58:19.744347 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module authz_groupfile_module from /usr/local/apache2/modules/mod_authz_groupfile.so\n[Mon Mar 23 12:58:19.744522 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module authz_user_module from /usr/local/apache2/modules/mod_authz_user.so\n[Mon Mar 23 12:58:19.744696 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module authz_core_module from /usr/local/apache2/modules/mod_authz_core.so\n[Mon Mar 23 12:58:19.744883 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module access_compat_module from /usr/local/apache2/modules/mod_access_compat.so\n[Mon Mar 23 12:58:19.745028 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module auth_basic_module from /usr/local/apache2/modules/mod_auth_basic.so\n[Mon Mar 23 12:58:19.745202 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module reqtimeout_module from /usr/local/apache2/modules/mod_reqtimeout.so\n[Mon Mar 23 12:58:19.745361 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module filter_module from /usr/local/apache2/modules/mod_filter.so\n[Mon Mar 23 12:58:19.745530 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module mime_module from /usr/local/apache2/modules/mod_mime.so\n[Mon Mar 23 12:58:19.745756 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module log_config_module from /usr/local/apache2/modules/mod_log_config.so\n[Mon Mar 23 12:58:19.745903 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module env_module from /usr/local/apache2/modules/mod_env.so\n[Mon Mar 23 12:58:19.746089 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module headers_module from /usr/local/apache2/modules/mod_headers.so\n[Mon Mar 23 12:58:19.746308 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module setenvif_module from /usr/local/apache2/modules/mod_setenvif.so\n[Mon Mar 23 12:58:19.746954 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module version_module from /usr/local/apache2/modules/mod_version.so\n[Mon Mar 23 12:58:19.747113 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module unixd_module from /usr/local/apache2/modules/mod_unixd.so\n[Mon Mar 23 12:58:19.747306 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module status_module from /usr/local/apache2/modules/mod_status.so\n[Mon Mar 23 12:58:19.747522 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module autoindex_module from /usr/local/apache2/modules/mod_autoindex.so\n[Mon Mar 23 12:58:19.747770 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module dir_module from /usr/local/apache2/modules/mod_dir.so\n[Mon Mar 23 12:58:19.748027 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module alias_module from /usr/local/apache2/modules/mod_alias.so\n[Mon Mar 23 12:58:19.749006 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module cgid_module from /usr/local/apache2/modules/mod_cgid.so\n[Mon Mar 23 12:58:19.751149 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module authnz_ldap_module from /usr/local/apache2/modules/mod_authnz_ldap.so\n[Mon Mar 23 12:58:19.751484 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module ldap_module from /usr/local/apache2/modules/mod_ldap.so\n[Mon Mar 23 12:58:19.751981 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module ssl_module from /usr/local/apache2/modules/mod_ssl.so\n[Mon Mar 23 12:58:19.752272 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module authn_socache_module from /usr/local/apache2/modules/mod_authn_socache.so\n[Mon Mar 23 12:58:19.752421 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module socache_shmcb_module from /usr/local/apache2/modules/mod_socache_shmcb.so\n[Mon Mar 23 12:58:19.752845 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module proxy_module from /usr/local/apache2/modules/mod_proxy.so\n[Mon Mar 23 12:58:19.753462 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module proxy_http_module from /usr/local/apache2/modules/mod_proxy_http.so\n[Mon Mar 23 12:58:19.754041 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module proxy_balancer_module from /usr/local/apache2/modules/mod_proxy_balancer.so\n[Mon Mar 23 12:58:19.754179 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module lbmethod_byrequests_module from /usr/local/apache2/modules/mod_lbmethod_byrequests.so\n[Mon Mar 23 12:58:19.754305 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module lbmethod_bytraffic_module from /usr/local/apache2/modules/mod_lbmethod_bytraffic.so\n[Mon Mar 23 12:58:19.754423 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module lbmethod_bybusyness_module from /usr/local/apache2/modules/mod_lbmethod_bybusyness.so\n[Mon Mar 23 12:58:19.754578 2015] [so:debug] [pid 94898:tid 140735259001616] mod_so.c(266): AH01575: loaded module lbmethod_heartbeat_module from /usr/local/apache2/modules/mod_lbmethod_heartbeat.so\n% echo $?\n1", "id": 182015, "attachment_id": null, "bug_id": 57745, "creation_time": "2015-03-23T20:24:56Z", "time": "2015-03-23T20:24:56Z", "is_private": false}, {"count": 3, "tags": [], "creator": "john@smadness.com", "attachment_id": null, "text": "Yes, adding in these two modules allows httpd to stay alive:\n\nLoadModule slotmem_shm_module modules/mod_slotmem_shm.so\nLoadModule slotmem_plain_module modules/mod_slotmem_plain.so\n\nIt would be great if a debug / error message could be added to this codepath.  I did not even see the message \"Failed to lookup provider 'shm' for 'slotmem': is mod_slotmem_shm loaded??\" in the debug log.", "id": 182016, "time": "2015-03-23T20:29:16Z", "bug_id": 57745, "creation_time": "2015-03-23T20:29:16Z", "is_private": false}, {"count": 4, "tags": [], "creator": "covener@gmail.com", "attachment_id": null, "text": "I'm not sue why you don't see it. Are you sure you're looking at the main/base error log? I see you didn't attach _any_ erorlog messages.", "id": 182070, "time": "2015-03-24T19:07:59Z", "bug_id": 57745, "creation_time": "2015-03-24T19:07:59Z", "is_private": false}, {"count": 5, "tags": [], "creator": "john@smadness.com", "text": "That's because there are no error log messages when I launch httpd.  When launching automatically through launchd (on Mac OS X) I modified the plist to spit stdout and stderr to a log.  Without including the slotmem modules, loading / starting the launchd plist does not output anything to the stdout or stderr log;  system log shows something like \"httpd exited with 1. Relaunching in 10s...\"\n\nWhen running through command line 'sudo httpd -e debug -X', I get some debug module output as pasted above, but no errors as far as I can see.  The individual sites' access and error logs are not populated at all, I'm assuming because httpd never loads fully before exiting.", "id": 182072, "attachment_id": null, "bug_id": 57745, "creation_time": "2015-03-24T20:34:04Z", "time": "2015-03-24T20:34:04Z", "is_private": false}, {"count": 6, "attachment_id": null, "bug_id": 57745, "text": ">  The individual sites' access and error logs are not populated at all\n\nRight, they shouldn't. But the globally defined errorlog should (and does) on other platforms.", "id": 182073, "time": "2015-03-24T20:39:55Z", "creator": "covener@gmail.com", "creation_time": "2015-03-24T20:39:55Z", "tags": [], "is_private": false}]