[{"count": 0, "tags": [], "creator": "upstreamnet@yahoo.com", "text": "Hi, I am pretty sure this is a bug, but maybe someone can point out something i\noverlooked.  many thanks, in advance,  for your help...\n\nI have a very simple java file 'PropTest.java' that prints out the\nvalue of the system property 'prop'.  When i run the test from the\ncommand line (using java command and -Dprop=somevalue), I see that the\nvalue that I set for 'prop' is indeed dumped out.\n\nBut when I set up a simple ant build.xml file to invoke the program\nvia the <java> task it appears that the value of the system property\nthat i set on the command line is not propagated... It seems that it\nis somehow swallowed and lost by ant.\n\nBelow you will find examples of the runs of the program via ant\nand via the 'java' command.\n\nBelow the run output you will find the source code for these very simple test cases.\n\n\nRUN OUTPUT\n-----------\n\n------------------------->>>> java -Dprop=blah  PropTest      #  INPUT,\ncorresponding output follows on next line\nproperty: blah\n\n\n------------------------->>>>>   ant -Dprop=blah  run         #  INPUT,\ncorresponding output follows on next line\nSearching for build.xml ...\nBuildfile:\n/home/cbedford/.hudson/jobs/cbedford.KMIGRATE.javaOnly.cbedford-linux.mygazoo.com.12753/workspace/kernel/platform/functionaltest/src/java/build.xml\n\nrun:\n     [echo]  dumping out value of property in ant, right before invoking java\ntask: blah\n     [java] property: null\n\nBUILD SUCCESSFUL\n\n------------------------->>>> ant -version                      #  INPUT,\ncorresponding output follows on next line\nApache Ant version 1.7.0 compiled on December 13 2006\n\n\n\n\nSOURCE CODE\n-----------\n\npublic class PropTest {\n    public static void main(String[] args) {\n        String propValue = System.getProperty(\"prop\");\n        System.out.println(\"property: \" + propValue );\n    }\n}\n\n\nbuild.xml\n---------\n<project name=\"demo\" default=\"run\" basedir=\".\" >\n  <path id=\"classpath.runjava\">\n            <path location=\"${basedir}\"/>\n  </path>\n\n    <target name=\"run\"  >\n      <echo level=\"info\" message=\" dumping out value of property in ant, right\nbefore invoking java task: ${prop}\"/>\n  <!--    tried fork=\"false\".. had no effect...\n      <java classname=\"PropTest\" fork=\"false\">\n   -->\n  <!--    tried it without clonevm, had no effect...\n      <java classname=\"PropTest\" fork=\"false\">\n   -->\n  <!--    tried it with clonevm=true, no fork specified...  had no effect.\n      <java classname=\"PropTest\" fork=\"false\">\n   -->\n\n      <java classname=\"PropTest\" clonevm=\"true\" fork=\"true\">\n          <classpath refid=\"classpath.runjava\"/>\n      </java>\n    </target>\n</project>\n\n\nRelevant Documentation:\n\n  http://ant.apache.org/manual/CoreTasks/java.html\n\n  Particularly relevant on this page is the text which reads:\n\n      clonevm   If set to true true, then all system properties and the\nbootclasspath of the forked Java Virtual Machine will be the\n      same as those of the Java VM running Ant. Default is \"false\" (ignored if\nfork is disabled). since Ant 1.7", "id": 113843, "time": "2008-02-17T16:33:07Z", "bug_id": 44444, "creation_time": "2008-02-17T16:33:07Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "text": "Hey... maybe this is not a bug.. Or at least i figured out a workaround....\n\nWorkaround is to use syspropertyset, as follows:\n\n<project name=\"demo\" default=\"run\" basedir=\".\" >\n  <path id=\"classpath.runjava\">\n            <path location=\"${basedir}\"/>\n  </path>\n\n    <target name=\"run\"  >\n      <echo level=\"info\" message=\" dumping out value of property in ant, right\nbefore invoking java task: ${prop}\"/>\n      <java classname=\"PropTest\" clonevm=\"true\" fork=\"true\">\n          <classpath refid=\"classpath.runjava\"/>\n          <syspropertyset>\n                  <propertyref builtin=\"commandline\"/>\n          </syspropertyset>\n      </java>\n    </target>\n</project>\n\n", "is_private": false, "id": 113844, "creator": "upstreamnet@yahoo.com", "time": "2008-02-17T17:30:19Z", "bug_id": 44444, "creation_time": "2008-02-17T17:30:19Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 44444, "attachment_id": null, "text": "ant -Dprop=x\ndoes *not* set a system property \"prop\", it sets\nthe ant property \"prop\".\n\nMarking this a NOTABUG, unless you have an objection.\nPeter", "id": 113891, "time": "2008-02-19T08:47:24Z", "creator": "peterreilly@apache.org", "creation_time": "2008-02-19T08:47:24Z", "is_private": false}]