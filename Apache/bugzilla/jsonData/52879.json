[{"count": 0, "tags": [], "creator": "astrange@ithinksw.com", "text": "I have a PHP script (run as fastcgi through php-fpm and mod_proxy_fcgi) which returns a Last-Modified header with no Status header.\n\nAt line 746:\nhttp://svn.apache.org/viewvc/httpd/httpd/tags/2.4.1/modules/proxy/mod_proxy_fcgi.c?revision=1243503&view=markup\n\nap_scan_script_header_err_brigade_ex returned HTTP_NOT_MODIFIED. This caused the 'status != OK' check to fail and it returned 200 with an empty body.\n\nSeems related to bug 38070.", "id": 154790, "time": "2012-03-11T06:26:16Z", "bug_id": 52879, "creation_time": "2012-03-11T06:26:16Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "sf@sfritsch.de", "attachment_id": null, "id": 158263, "time": "2012-04-21T17:52:35Z", "bug_id": 52879, "creation_time": "2012-04-21T17:52:35Z", "is_private": false, "text": "Can you please check if this patch fixes the problem?\n\nhttp://svn.apache.org/viewvc/httpd/httpd/trunk/modules/proxy/mod_proxy_fcgi.c?r1=1311172&r2=1311171&pathrev=1311172"}, {"count": 2, "tags": [], "text": "2.4.2 + that patch appears to work.", "attachment_id": null, "id": 158463, "creator": "astrange@ithinksw.com", "time": "2012-04-27T04:27:30Z", "bug_id": 52879, "creation_time": "2012-04-27T04:27:30Z", "is_private": false}, {"count": 3, "tags": [], "text": "Applied to 2.4.x in r1331416.\nReleased with 2.4.3.", "is_private": false, "id": 161593, "creator": "rainer.jung@kippdata.de", "time": "2012-08-21T16:36:56Z", "bug_id": 52879, "creation_time": "2012-08-21T16:36:56Z", "attachment_id": null}, {"count": 4, "tags": [], "text": "We have been chasing an issue with Apache 2.4.2 and found this bug report. We upgraded to 2.4.4. This change appears to partially fixed the issue in that upon a 304 response apache now returns content. However we are still seeing an error message logged in the following format - \"[proxy_fcgi:error] [pid 1226:tid 139673091413760] [client 10.1.2.1:58133] AH01070: Error parsing script headers\".\n\nUpon inspection of the code we think we can see that this message will be reported when ANYTHING but a 200 OK is generated. Ideally we dont want to see the error in our apache logs. Can someone investigate?", "attachment_id": null, "id": 166147, "creator": "dev@builderscrack.co.nz", "time": "2013-03-26T03:11:59Z", "bug_id": 52879, "creation_time": "2013-03-26T03:11:59Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 52879, "is_private": false, "text": "The patch r1331416 introduced a serious bug: \n\nIn the case described by the original poster (a PHP script run as fastcgi through php-fpm and mod_proxy_fcgi which returns a Last-Modified header with no Status header), Apache does indeed now return a 304 status (if a matching If-not-modified header is in the request) BUT the content of the php script is also sent. \n\nThis breaks the http protocol as described in rfc2616 section 10.3.5: \"The 304 response MUST NOT contain a message-body, and thus is always terminated by the first empty line after the header fields.\"\n\nThis cause us a serious problem when this kind of request is sent through our reverse proxy placed just in front of the backends. When the proxy receives this (invalid) 304 response, it immediately sends a 304 to the client and ignores the rest of the packet; but the next packets sent by the backend stay in the tcp stack (the proxy does not expect further content). The reverse proxy prepends these packets in the response to the next request routed to the same backend. This, of course, breaks our applications...\n\nCan someone suggests a patch we could test to fix this problem?", "id": 177542, "time": "2014-09-04T18:40:19Z", "creator": "spizella001@gmail.com", "creation_time": "2014-09-04T18:40:19Z", "attachment_id": null}, {"count": 6, "tags": [], "creator": "spizella001@gmail.com", "attachment_id": null, "id": 179038, "time": "2014-11-10T19:48:30Z", "bug_id": 52879, "creation_time": "2014-11-10T19:48:30Z", "is_private": false, "text": "Re-opened as Bug 57198"}, {"count": 7, "tags": [], "creator": "covener@gmail.com", "attachment_id": null, "id": 179514, "time": "2014-12-04T14:52:57Z", "bug_id": 52879, "creation_time": "2014-12-04T14:52:57Z", "is_private": false, "text": "marking fixed, followup in 57198"}]