[{"count": 0, "attachment_id": null, "bug_id": 8295, "text": "... since the ContextClassLoader isn't set properly at this point of time.\n\nScenario: One of our base classes uses the following code within a  static{} \ninitialisation block:\n\nclass CoreObject\n{\n   static{\n     loggingChannel = (LoggingChannel)Class.forName(loggingClassName, true, \n     Thread.currentThread().getContextClassLoader()).newInstance();\n   }\n}\n\nAn instance of this class is serialized as part of the session context. After \nrestart of Tomcat 4.03 we receive the following stacktrace:\n\njava.lang.ClassNotFoundException: de.gauss.base.logging.FileLoggingChannel\n        at \norg.apache.catalina.loader.StandardClassLoader.loadClass(StandardClassLoader.jav\na:1127)\n        at \norg.apache.catalina.loader.StandardClassLoader.loadClass(StandardClassLoader.jav\na:992)\n        at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:313)\n        at java.lang.Class.forName0(Native Method)\n        at java.lang.Class.forName(Class.java:195)\n        at de.gauss.base.CoreObject.<clinit>(CoreObject.java:101)\n        at java.io.ObjectStreamClass.hasStaticInitializer(Native Method)\n        at \njava.io.ObjectStreamClass.computeSerialVersionUID(ObjectStreamClass.java:923)\n        at java.io.ObjectStreamClass.access$200(ObjectStreamClass.java:46)\n        at java.io.ObjectStreamClass$2.run(ObjectStreamClass.java:420)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at java.io.ObjectStreamClass.init(ObjectStreamClass.java:401)\n        at java.io.ObjectStreamClass.lookupInternal(ObjectStreamClass.java:112)\n        at java.io.ObjectStreamClass.lookup(ObjectStreamClass.java:59)\n        at java.io.ObjectStreamClass.lookupInternal(ObjectStreamClass.java:88)\n        at java.io.ObjectStreamClass.lookup(ObjectStreamClass.java:59)\n        at java.io.ObjectStreamClass.lookupInternal(ObjectStreamClass.java:88)\n        at java.io.ObjectStreamClass.lookup(ObjectStreamClass.java:59)\n        at java.io.ObjectStreamClass.lookupInternal(ObjectStreamClass.java:88)\n        at java.io.ObjectStreamClass.lookup(ObjectStreamClass.java:59)\n        at java.io.ObjectStreamClass.lookupInternal(ObjectStreamClass.java:88)\n        at java.io.ObjectStreamClass.setClass(ObjectStreamClass.java:566)\n        at \njava.io.ObjectInputStream.inputClassDescriptor(ObjectInputStream.java:936)\n        at java.io.ObjectInputStream.readObject(ObjectInputStream.java:366)\n        at java.io.ObjectInputStream.readObject(ObjectInputStream.java:236)\n        at java.io.ObjectInputStream.inputObject(ObjectInputStream.java:1186)\n        at java.io.ObjectInputStream.readObject(ObjectInputStream.java:386)\n        at java.io.ObjectInputStream.readObject(ObjectInputStream.java:236)\n        at \norg.apache.catalina.session.StandardSession.readObject(StandardSession.java:1268\n)\n        at \norg.apache.catalina.session.StandardSession.readObjectData(StandardSession.java:\n810)\n        at \norg.apache.catalina.session.StandardManager.load(StandardManager.java:411)\n        at \norg.apache.catalina.session.StandardManager.start(StandardManager.java:617)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1104)\n        at \norg.apache.catalina.core.StandardContext.start(StandardContext.java:3345)\n        at \norg.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:785)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:454)\n        at org.apache.catalina.core.StandardHost.install(StandardHost.java:714)\n        at \norg.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:300)\n        at org.apache.catalina.startup.HostConfig.start(HostConfig.java:389)\n        at \norg.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:232)\n        at \norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.ja\nva:155)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1131)\n        at org.apache.catalina.core.StandardHost.start(StandardHost.java:614)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1123)\n        at \norg.apache.catalina.core.StandardEngine.start(StandardEngine.java:343)\n        at \norg.apache.catalina.core.StandardService.start(StandardService.java:388)\n        at \norg.apache.catalina.core.StandardServer.start(StandardServer.java:506)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:781)\n        at org.apache.catalina.startup.Catalina.execute(Catalina.java:681)\n        at org.apache.catalina.startup.Catalina.process(Catalina.java:179)\n        at java.lang.reflect.Method.invoke(Native Method)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:243)\n\nThis exception changes the way our classes behave. The only known workaround is \nto delete the SESSIONS.ser before we restart Tomcat.\nQ: Is there any switch to disable session persistence?\n\nThanks", "id": 14047, "time": "2002-04-19T12:34:24Z", "creator": "matthias.niessen@gaussvip.com", "creation_time": "2002-04-19T12:34:24Z", "tags": [], "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 8295, "text": "The startup / shutdown order has been fixed in the HEAD branch of the CVS, so\nthe CCL is set during manager start/stop (and the J2EE ENC is also available).\n\n*** This bug has been marked as a duplicate of 7850 ***", "id": 14424, "time": "2002-04-23T11:35:24Z", "creator": "remm@apache.org", "creation_time": "2002-04-23T11:35:24Z", "tags": [], "is_private": false}]