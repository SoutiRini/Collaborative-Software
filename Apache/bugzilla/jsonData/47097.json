[{"count": 0, "attachment_id": 23543, "creator": "Bruno.Harbulot@manchester.ac.uk", "is_private": false, "id": 126521, "time": "2009-04-26T06:45:38Z", "bug_id": 47097, "creation_time": "2009-04-26T06:45:38Z", "tags": [], "text": "Created attachment 23543\nMaven2 test-case\n\nIf the same instance of XMLSignature is used on the same thread for verifying after being used for signing, this exception occurs:\norg.apache.xml.security.signature.XMLSignatureException: object not initialized for verification \nIf the verification is done on a different thread, it works fine.\n\nI believe this is due to:\n\ndue to org.apache.xml.security.algorithms.SignatureAlgorithm#initializeAlgorithm(boolean):\n\n    private void initializeAlgorithm(boolean isForSigning)\n        throws XMLSignatureException {\n        if (_signatureAlgorithm!=null) {\n       return;\n        }\n        _signatureAlgorithm=isForSigning ? getInstanceForSigning(algorithmURI) :\n            getInstanceForVerify(algorithmURI);   \n    this._signatureAlgorithm\n            .engineGetContextFromElement(this._constructionElement);\n    }\n\n\nIf '_signatureAlgorithm' has already been initialised, even if it's not for the purpose intended for another use, it won't be initialised again. Commenting out the 'if' block solves the problem.\n\nI've noticed that there was an 'isForSigning' field commented out in revision 515521, which completely disappeared in revision 695520 (current one). I guess it might have been the original intent for this flag."}, {"count": 1, "tags": [], "text": "Fixed as suggested in HEAD. Thanks for the test case!", "attachment_id": null, "bug_id": 47097, "id": 126822, "time": "2009-05-06T14:29:11Z", "creator": "sean.mullan@oracle.com", "creation_time": "2009-05-06T14:29:11Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 47097, "is_private": false, "text": "*** Bug 44204 has been marked as a duplicate of this bug. ***", "id": 128045, "time": "2009-06-18T03:45:07Z", "creator": "coheigea@apache.org", "creation_time": "2009-06-18T03:45:07Z", "attachment_id": null}]