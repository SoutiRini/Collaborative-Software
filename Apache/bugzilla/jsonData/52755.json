[{"count": 0, "tags": [], "creator": "wdauchy@gmail.com", "attachment_id": null, "text": "I got a simple .htaccess file which makes apache2.4.1 segfault almost on every request. \n\n<IfModule mod_deflate.c>\n        SetOutputFilter DEFLATE\n        AddOutputFilterByType DEFLATE text/plain\n        AddOutputFilterByType DEFLATE text/xml\n        AddOutputFilterByType DEFLATE text/html\n        AddOutputFilterByType DEFLATE text/css\n        AddOutputFilterByType DEFLATE image/svg+xml\n        AddOutputFilterByType DEFLATE application/xhtml+xml\n        AddOutputFilterByType DEFLATE application/xml\n        AddOutputFilterByType DEFLATE application/rss+xml\n        AddOutputFilterByType DEFLATE application/atom_xml\n        AddOutputFilterByType DEFLATE application/x-javascript\n        AddOutputFilterByType DEFLATE application/x-httpd-php\n        AddOutputFilterByType DEFLATE application/x-httpd-fastphp\n        AddOutputFilterByType DEFLATE application/x-httpd-eruby   \n        SetEnvIfNoCase Request_URI \\.(?:gif|jpe?g|png)$ no-gzip dont-vary\n        SetEnvIfNoCase Request_URI \\.(?:exe|t?gz|zip|bz2|sit|rar)$ no-gzip dont-vary\n        SetEnvIfNoCase Request_URI \\.(?:pdf|avi|mov|mp3|mp4|rm)$ no-gzip dont-vary   \n        BrowserMatch ^Mozilla/4 gzip-only-text/html\n        BrowserMatch ^Mozilla/4\\.0[678] no-gzip\n        BrowserMatch \\bMSIE !no-gzip !gzip-only-text/html\n        Header append Vary User-Agent env=!dont-vary\n</IfModule>", "id": 154091, "time": "2012-02-23T21:53:07Z", "bug_id": 52755, "creation_time": "2012-02-23T21:53:07Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 52755, "attachment_id": null, "id": 154126, "time": "2012-02-24T20:50:09Z", "creator": "sf@sfritsch.de", "creation_time": "2012-02-24T20:50:09Z", "is_private": false, "text": "The crash is fixed in trunk by r1293405\n\nBut I have noticed that AddOutputFilterByType does not yet work properly if two different filters are added to the same type."}, {"count": 2, "tags": [], "creator": "wdauchy@gmail.com", "text": "Hi Stefan,\n\n(In reply to comment #1)\n> The crash is fixed in trunk by r1293405\n\nThank you very much for the quick answer and patch. I should have reported that earlier. I will test it as soon as possible and report the result.\n\n> But I have noticed that AddOutputFilterByType does not yet work properly if two\n> different filters are added to the same type.\n\nWhat do you mean by `does not yet work properly`? Is there already an open bug for that?\n\nRegards,\n-- \nWilliam", "id": 154129, "time": "2012-02-24T21:22:34Z", "bug_id": 52755, "creation_time": "2012-02-24T21:22:34Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 52755, "attachment_id": null, "text": "(In reply to comment #2)\n> I will test it as soon as possible and report the result.\n\nI successfully tested your patch and it fixes the issue reported. I'm therefore closing this bug but I'm still interested if you could give me more information about the issue you spotted (AddOutputFilterByType does not yet work properly if two different filters are added to the same type). Maybe there is an open bug for that?\n\nRegards,\n-- \nWilliam", "id": 154147, "time": "2012-02-25T16:30:29Z", "creator": "wdauchy@gmail.com", "creation_time": "2012-02-25T16:30:29Z", "is_private": false}, {"count": 4, "tags": [], "text": "Thanks for testing. But we leave PRs affecting a stable release open until they have been fixed in a stable release.\n\nThe other issue I have found is that if you have a config like\n\nAddOutputFilterByType DEFLATE    text/xml\nAddOutputFilterByType CASEFILTER text/xml\n\nthe second filter is not applied. There is no PR about this yet, but I have added a (failing) test case to our test suite, so we won't forget it.", "attachment_id": null, "bug_id": 52755, "id": 154152, "time": "2012-02-25T21:56:44Z", "creator": "sf@sfritsch.de", "creation_time": "2012-02-25T21:56:44Z", "is_private": false}, {"count": 5, "tags": [], "text": "*** Bug 52780 has been marked as a duplicate of this bug. ***", "attachment_id": null, "bug_id": 52755, "id": 154294, "time": "2012-02-27T18:38:57Z", "creator": "trawick@apache.org", "creation_time": "2012-02-27T18:38:57Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 52755, "text": "(In reply to comment #4)\n> The other issue I have found is that if you have a config like\n> \n> AddOutputFilterByType DEFLATE    text/xml\n> AddOutputFilterByType CASEFILTER text/xml\n> \n> the second filter is not applied. There is no PR about this yet, but I have\n> added a (failing) test case to our test suite, so we won't forget it.\n\nThis was a false alarm, there was just some confusion between text/xml and application/xml.", "id": 154839, "time": "2012-03-12T18:53:55Z", "creator": "sf@sfritsch.de", "creation_time": "2012-03-12T18:53:55Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "creator": "Jens.Schleusener@t-online.de", "text": "As an probably related observation I want to report segmentation faults on my server using httpd 2.4.1 (never seen for 2.2.22) that vanish applying the patched file mod_filter.c from httpd-2.4.x (subversion).\n\nHere a typical line in the error_log file (increasing LogLevel to \"debug\" didn't give more infos):\n [Fri Mar 16 13:03:16.980532 2012] [core:notice] [pid 9543:tid 3076671232] AH00052: child pid 9714 exit signal Segmentation fault (11)\n\nAfter many hours of cause studies I could break down this segmentation faults to the following szenario:\n\n1) I built httpd 2.4.1 via\n\n./configure --prefix=/usr/local/www/httpd2.4.1 --with-apr=/usr/local/www --with-apr-util=/usr/local/www --enable-rewrite --enable-deflate -enable-modules=few\nmake\nmake install\n\n2) I added at the end of the default configuration file httpd.conf the following lines:\n\nRewriteEngine On\nInclude conf/many_test_rewrite_rules.conf\n# Important: Without that Filter NO segfaults!\n<Location />\n  AddOutputFilterByType DEFLATE text/html text/plain text/xml application/javascript\n</Location>\n\n3) I created the test file conf/many_test_rewrite_rules.conf with many dummy \"Rewrite\"-rules for e.g. via the following script (in reality I use similar lines on my fossies.org server to handle moved/renamed software archives):\n\n#/bin/bash\nOUT=many_test_rewrite_rules.conf\nN0=10000\nN=1\nwhile [ \"$N\" -le \"$N0\" ]\ndo\n  echo \"RewriteRule ^/unix/privat/dummy-$N(.*)$ http://fossies.org/unix/misc/dummy-$N\\$1 [R=301,L]\"\n  let N=N+1\ndone >  \"$OUT\"\n\nNow accessing the default htdocs/index.html (avoiding caches)\nI have seen beginning segmentation faults for N0 values for e.g. of\n\n > 5503 (for Linux OpenSUSE 11.3, 2 MB memory)\nrespectively\n > 5130   using http://fossies.org:8081/ instead of http://fossies.org/ in the so \"larger\" test rules.\n\nOn a Linux OpenSUSE 11.4 system with 8 MB memory the required number of RewriteRule-lines were a little bit higher. I had also the impression that the number of builtin/used modules changes that values slightly.\n\nUnfortunately the hints in http://httpd.apache.org/dev/debugging.html didn't help me to get more detailed information or a core dump file. But since 2.4.2\nis probably coming soon and solving the described bug such infos seems no longer required.\n\nJens", "id": 154983, "time": "2012-03-16T13:50:23Z", "bug_id": 52755, "creation_time": "2012-03-16T13:50:23Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 52755, "text": "fixed in 2.4.2", "id": 158857, "time": "2012-05-06T07:29:31Z", "creator": "sf@sfritsch.de", "creation_time": "2012-05-06T07:29:31Z", "is_private": false, "attachment_id": null}]