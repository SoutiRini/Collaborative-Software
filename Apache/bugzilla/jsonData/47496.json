[{"count": 0, "tags": [], "bug_id": 47496, "attachment_id": null, "is_private": false, "id": 128631, "time": "2009-07-08T02:53:36Z", "creator": "andremoniy@gmail.com", "creation_time": "2009-07-08T02:53:36Z", "text": "There is very strange behavior. There are some doc-files in russian encoding which contain particularly only tables. When reading them, HWPF returns a half of document in the correct representation (each logical element in a appropriate paragraph... character run...), and the second half of document is represented in one paragraph and in the one character run. One of the effects of this behavior is incorrect work of the TableIterator which returns only one half of the all document's tables.\nThe debugging shows, that there are some strange breakthroughs in start<->end values, when reading Plex of CPs. Here are printout of debug info (derived from manually injected code lines in recompiled PlexOfCps class):\n1. Creating TextPieceTable (in ComplexFileTable analyzing):\n-----------------------------\nstart = 16474 size=448 sizeOfStruct=8\n-----------------------------\nStart -> 0 to end <-256\nStart -> 256 to end <-1280\nStart -> 1280 to end <-2048\nStart -> 2048 to end <-3072\nStart -> 3072 to end <-3840\nStart -> 3840 to end <-4864\n...\nStart -> 25856 to end <-26368\nStart -> 26368 to end <-27136\nStart -> 27136 to end <-27648\nStart -> 27648 to end <-28928\nStart -> 28928 to end <-29184\nStart -> 29184 to end <-58063 <--- !!! HERE !!!\n\n2. Creating PAPBinTable:\n-----------------------------\nstart = 7117 size=5020 sizeOfStruct=4\n-----------------------------\nStart -> 2048 to end <-2338\nStart -> 2338 to end <-2546\nStart -> 2546 to end <-2556\n...\nStart -> 59556 to end <-59694\nStart -> 59694 to end <-59708\nStart -> 59708 to end <-60402\nStart -> 60402 to end <-264814  <--- !!! HERE !!!\nStart -> 264814 to end <-264828\nStart -> 264828 to end <-265600\nStart -> 265600 to end <-265604\n...\nStart -> 320214 to end <-321000\nStart -> 321000 to end <-321936\nStart -> 321936 to end <-321950\n\n\nUnfortunately, I can't attach this document files because of private information containing in this files."}, {"count": 1, "tags": [], "bug_id": 47496, "attachment_id": 24031, "is_private": false, "id": 129109, "time": "2009-07-24T02:02:54Z", "creator": "weizihongjia@hotmail.com", "creation_time": "2009-07-24T02:02:54Z", "text": "Created attachment 24031\nnumber of paragraph is 16\n\nNumber of paragraph is 16 in this doc .\nHWPFDocument daDoc = new HWPFDocument(new FileInputStream(\"test.doc\"));\n\t\t\tRange wordRange = daDoc.getRange();\n\t\t\twordRange.numParagraphs()is 14\nA property claimed to start before zero, at -256! Resetting it to zero, and hoping for the best\npapformatteddiskpag_70=-256 -> 54 = true\nA property claimed to start before zero, at -256! Resetting it to zero, and hoping for the best\npapformatteddiskpag_70=54 -> 66 = true\npapformatteddiskpag_70=66 -> 67 = true\npapformatteddiskpag_70=67 -> 77 = true\npapformatteddiskpag_70=77 -> 81 = true\npapformatteddiskpag_70=81 -> 95 = true\npapformatteddiskpag_70=95 -> 113 = true\npapformatteddiskpag_70=113 -> 145 = true\npapformatteddiskpag_70=145 -> 173 = true\npapformatteddiskpag_70=173 -> 198 = true\npapformatteddiskpag_70=198 -> 217 = true\npapformatteddiskpag_70=217 -> 230 = true\npapformatteddiskpag_70=230 -> 243 = true\npapformatteddiskpag_70=243 -> 1052 = true   --here\npapformatteddiskpag_70=1052 -> 1078 = true\npapformatteddiskpag_70=1078 -> 1117 = true\nin the range method of findRange has List rpl parameter, size of rpl is 16.rpl[13]._cpStart=243;rpl[13]._cpEnd=1052;range._end=336.rpl[13]._cpEnd=1052>range._end=336;return 14."}, {"count": 2, "tags": [], "creator": "weizihongjia@hotmail.com", "attachment_id": null, "text": "This reasion is that address of TextPiece is logic sequence in TextPieceTable .But address of PAPBinTable or address of CHPBinTable is physical address ,this address is not always sequence .Address of PAPBinTable or address of CHPBinTable is out-of-correspondence position address of TextPiece.", "id": 129975, "time": "2009-08-27T01:18:26Z", "bug_id": 47496, "creation_time": "2009-08-27T01:18:26Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 47496, "attachment_id": null, "text": "anybody know how to fix the num of paragraph ?", "id": 130546, "time": "2009-09-20T17:56:04Z", "creator": "inthendsun@gmail.com", "creation_time": "2009-09-20T17:56:04Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 47496, "attachment_id": null, "id": 144558, "time": "2011-02-25T16:53:49Z", "creator": "apache@gagravarr.org", "creation_time": "2011-02-25T16:53:49Z", "is_private": false, "text": "I believe that the HWPF unicode related fixes in the last 18 months should have fixed these problems. Please re-open the bug if you're still hitting the issues with a recent nightly / 3.8 beta 1 (which is due out soon)."}]