[{"count": 0, "tags": [], "text": "Created attachment 35449\nThe errant spreadsheet...\n\nIn the attached spreadsheet, an attempt to fetch the conditional formatting for cell IRPPCalc!S12.\n\nThis is the code:\n\npublic class Main {\n    public static void main(String[] args) {\n            try {\n                Workbook wb = WorkbookFactory.create(new File(\"condfail.xlsx\"));\n                Sheet sheet = (wb.getSheet(\"IRPPCalc\"));\n                Row row = (sheet.getRow(11));\n                XSSFCell cell = (XSSFCell) row.getCell(18);\n                WorkbookEvaluatorProvider fe = (WorkbookEvaluatorProvider) wb.getCreationHelper().createFormulaEvaluator();\n                ConditionalFormattingEvaluator condfmt = new ConditionalFormattingEvaluator(wb, fe);\n                System.out.println(\">>>>\" + condfmt.getConditionalFormattingForCell(cell));\n            } catch(Exception e) {e.printStackTrace();};\n    }\n}\n\nThis is the resultant stack trace:\n\njava.lang.NullPointerException\n\tat java.util.Calendar.setTime(Calendar.java:1770)\n\tat org.apache.poi.ss.formula.functions.EDate.evaluate(EDate.java:49)\n\tat org.apache.poi.ss.formula.UserDefinedFunction.evaluate(UserDefinedFunction.java:61)\n\tat org.apache.poi.ss.formula.OperationEvaluatorFactory.evaluate(OperationEvaluatorFactory.java:129)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateFormula(WorkbookEvaluator.java:514)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateAny(WorkbookEvaluator.java:278)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateReference(WorkbookEvaluator.java:722)\n\tat org.apache.poi.ss.formula.SheetRefEvaluator.getEvalForCell(SheetRefEvaluator.java:48)\n\tat org.apache.poi.ss.formula.SheetRangeEvaluator.getEvalForCell(SheetRangeEvaluator.java:74)\n\tat org.apache.poi.ss.formula.LazyRefEval.getInnerValueEval(LazyRefEval.java:39)\n\tat org.apache.poi.ss.formula.eval.OperandResolver.chooseSingleElementFromRef(OperandResolver.java:179)\n\tat org.apache.poi.ss.formula.eval.OperandResolver.getSingleValue(OperandResolver.java:62)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.dereferenceResult(WorkbookEvaluator.java:589)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateFormula(WorkbookEvaluator.java:536)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateAny(WorkbookEvaluator.java:278)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateReference(WorkbookEvaluator.java:722)\n\tat org.apache.poi.ss.formula.SheetRefEvaluator.getEvalForCell(SheetRefEvaluator.java:48)\n\tat org.apache.poi.ss.formula.SheetRangeEvaluator.getEvalForCell(SheetRangeEvaluator.java:74)\n\tat org.apache.poi.ss.formula.LazyRefEval.getInnerValueEval(LazyRefEval.java:39)\n\tat org.apache.poi.ss.formula.eval.OperandResolver.chooseSingleElementFromRef(OperandResolver.java:179)\n\tat org.apache.poi.ss.formula.eval.OperandResolver.getSingleValue(OperandResolver.java:62)\n\tat org.apache.poi.ss.formula.eval.RelationalOperationEval.evaluate(RelationalOperationEval.java:65)\n\tat org.apache.poi.ss.formula.functions.Fixed2ArgFunction.evaluate(Fixed2ArgFunction.java:33)\n\tat org.apache.poi.ss.formula.OperationEvaluatorFactory.evaluate(OperationEvaluatorFactory.java:119)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateFormula(WorkbookEvaluator.java:514)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateAny(WorkbookEvaluator.java:278)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateReference(WorkbookEvaluator.java:722)\n\tat org.apache.poi.ss.formula.SheetRefEvaluator.getEvalForCell(SheetRefEvaluator.java:48)\n\tat org.apache.poi.ss.formula.SheetRangeEvaluator.getEvalForCell(SheetRangeEvaluator.java:74)\n\tat org.apache.poi.ss.formula.LazyRefEval.getInnerValueEval(LazyRefEval.java:39)\n\tat org.apache.poi.ss.formula.eval.OperandResolver.chooseSingleElementFromRef(OperandResolver.java:179)\n\tat org.apache.poi.ss.formula.eval.OperandResolver.getSingleValue(OperandResolver.java:62)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.dereferenceResult(WorkbookEvaluator.java:589)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateFormula(WorkbookEvaluator.java:536)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateAny(WorkbookEvaluator.java:278)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateReference(WorkbookEvaluator.java:722)\n\tat org.apache.poi.ss.formula.SheetRefEvaluator.getEvalForCell(SheetRefEvaluator.java:48)\n\tat org.apache.poi.ss.formula.SheetRangeEvaluator.getEvalForCell(SheetRangeEvaluator.java:74)\n\tat org.apache.poi.ss.formula.LazyRefEval.getInnerValueEval(LazyRefEval.java:39)\n\tat org.apache.poi.ss.formula.eval.OperandResolver.chooseSingleElementFromRef(OperandResolver.java:179)\n\tat org.apache.poi.ss.formula.eval.OperandResolver.getSingleValue(OperandResolver.java:62)\n\tat org.apache.poi.ss.formula.eval.RelationalOperationEval.evaluate(RelationalOperationEval.java:64)\n\tat org.apache.poi.ss.formula.functions.Fixed2ArgFunction.evaluate(Fixed2ArgFunction.java:33)\n\tat org.apache.poi.ss.formula.OperationEvaluatorFactory.evaluate(OperationEvaluatorFactory.java:119)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateFormula(WorkbookEvaluator.java:514)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateNameFormula(WorkbookEvaluator.java:711)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluate(WorkbookEvaluator.java:803)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluate(WorkbookEvaluator.java:772)\n\tat org.apache.poi.ss.formula.EvaluationConditionalFormatRule.checkFormula(EvaluationConditionalFormatRule.java:378)\n\tat org.apache.poi.ss.formula.EvaluationConditionalFormatRule.matches(EvaluationConditionalFormatRule.java:306)\n\tat org.apache.poi.ss.formula.ConditionalFormattingEvaluator.getConditionalFormattingForCell(ConditionalFormattingEvaluator.java:176)\n\tat org.apache.poi.ss.formula.ConditionalFormattingEvaluator.getConditionalFormattingForCell(ConditionalFormattingEvaluator.java:206)\n\tat com.fidnip.Main.main(Main.java:29)", "attachment_id": 35449, "id": 201598, "creator": "blake.watson@pnmac.com", "time": "2017-10-23T17:15:03Z", "bug_id": 61652, "creation_time": "2017-10-23T17:15:03Z", "is_private": false}, {"count": 1, "tags": [], "creator": "blake.watson@pnmac.com", "attachment_id": null, "text": "Sorry, that should've been a little clearer:\n\n\"In the attached spreadsheet, an attempt to fetch the conditional formatting for cell IRPPCalc!S12.\"\n\nshould be:\n\n\"In the attached spreadsheet, an attempt to fetch the conditional formatting for cell IRPPCalc!S12 results in a Null Pointer Error in the java.util.Calendar.setTime function.\"", "id": 201599, "time": "2017-10-23T17:16:38Z", "bug_id": 61652, "creation_time": "2017-10-23T17:16:38Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 61652, "text": "I tried to reproduce this, but could not, the evaluation of the rule works fine for me now, probably this was already fixed by some other change now. Please re-run your code with a recent nightly build to verify that it also works now for your.", "id": 202943, "time": "2017-12-28T11:28:18Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2017-12-28T11:28:18Z", "is_private": false, "attachment_id": null}]