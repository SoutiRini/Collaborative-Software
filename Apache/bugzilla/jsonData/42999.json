[{"count": 0, "tags": [], "bug_id": 42999, "text": "Hi folks!\n\nI have a problem positioning a picture inside a cell range. I use a code similar\nto this one:\n\nwb = new HSSFWorkbook();\nsheet = wb.createSheet(\"report\");\npatriarch = sheet.createDrawingPatriarch();\nloadPicture(picturePath);//custom method\t\t\t\npicData = getPictureBytes();\nindexPicture=wb.addPicture( picData, HSSFWorkbook.PICTURE_TYPE_JPEG );\n\t\t\nanchor = new HSSFClientAnchor( 500 , 0 , 300 , 255 ,(short)0,1,(short)1,3);\n\nanchor.setAnchorType( 0 );\npatriarch.createPicture(anchor, indexPicture);\n\nAnd then I save the workbook.\n\nThe problem is that when the anchor is created, the positioning is bad if the\ndx1 coordinate (500) is greater than the dx2 coordinate (300). The program will\nactualy put the patriarch having the start coordinate in the first cell equal to\n300, and the end coordinate in the last cell equal to 500. \n\nSo it looks like if dx1>dx2, the two coordinates will switch between them.\n\nI had some hard time trying to get around this, but I did not find a way. I also\ntried to create a new patriarch with the default constructor, and then to set\neach coordinate, row and column, but the result stays the same.\n\nShould I use some other way to add a picture?\n\nThanks in advance,\nBogdan", "id": 106050, "time": "2007-07-30T05:13:14Z", "creator": "virussu_ro@yahoo.com", "creation_time": "2007-07-30T05:13:14Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 42999, "text": "Hi,\n\nThe bug is in org.apache.poi.hssf.model.ConvertAnchor.\nThis object is responsible for converting HSSF anchors to the\ncorresponding low-level escher record.\n\nThere is an extra check which cause dx1 ans dx2 to be swapped if dx1>dx2:\n...\nanchor.setDx1( (short) Math.min(a.getDx1(), a.getDx2()) );\nanchor.setDy1( (short) Math.min(a.getDy1(), a.getDy2()) );\n...\n\nIt does make sense for child anchors - you can't have dx2>dx1 in a child anchor.\nFor client anchors it is extra and can be safely removed. I will commit the\npatch shortly.\n\nRegards,\nYegor", "id": 106053, "time": "2007-07-30T06:11:07Z", "creator": "yegor@dinom.ru", "creation_time": "2007-07-30T06:11:07Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 42999, "attachment_id": null, "id": 106305, "time": "2007-08-03T11:09:48Z", "creator": "yegor@dinom.ru", "creation_time": "2007-08-03T11:09:48Z", "is_private": false, "text": "Fixed"}, {"attachment_id": null, "tags": [], "bug_id": 42999, "text": "The same problem in AnchorHeight calculations in \norg.apache.poi.hssf.usermodel.HSSFClientAnchor\n\npublic float getAnchorHeightInPoints(HSSFSheet sheet )\n{\nint y1 = Math.min( getDy1(), getDy2() );\nint y2 = Math.max( getDy1(), getDy2() );\nint row1 = Math.min( getRow1(), getRow2() );\nint row2 = Math.max( getRow1(), getRow2() );\n...\n\nPlease, fix it in 3.0.2 release.", "count": 3, "id": 111504, "time": "2007-12-06T07:57:24Z", "creator": "ya_ro@mail.ru", "creation_time": "2007-12-06T07:57:24Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 42999, "text": "OK. The fix will go in 3.0.2 beta2.\n\nYegor", "id": 111509, "time": "2007-12-06T08:27:52Z", "creator": "yegor@dinom.ru", "creation_time": "2007-12-06T08:27:52Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "text": "Fixed\n\nYegor", "id": 112159, "time": "2007-12-24T01:51:52Z", "bug_id": 42999, "creation_time": "2007-12-24T01:51:52Z", "is_private": false}]