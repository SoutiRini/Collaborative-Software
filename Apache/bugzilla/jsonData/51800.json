[{"count": 0, "tags": [], "bug_id": 51800, "attachment_id": 27483, "text": "Created attachment 27483\ninput file\n\nI had written a code to replace text from a .ppt document\n\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.OutputStream;\n\nimport org.apache.poi.hslf.model.Slide;\nimport org.apache.poi.hslf.model.TextRun;\nimport org.apache.poi.hslf.usermodel.SlideShow;\n\npublic class PPTHandler2 {\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tInputStream inputStream = new FileInputStream(\"C:/simple.ppt\");\n\t\tOutputStream outputStream = new FileOutputStream(\"C:/simple_out.ppt\");\n\n\t\tSlideShow aSlideShow = new SlideShow(inputStream);\n\t\tSlide[] pptSlides = aSlideShow.getSlides();\n\t\t\n\t\tfor (Slide aSlide : pptSlides) \n\t\t{\n\t\t\tTextRun[] textRuns = aSlide.getTextRuns();\n\t\t\tfor (TextRun aTextRun : textRuns) \n\t\t\t{\n\t\t\t\t\tString inputText= aTextRun.getText();\n\t\t\t\t\taTextRun.setText(inputText+\"added\");\n\t\t\t}\n\t\t}\n\n\t\taSlideShow.write(outputStream);\n\t\tinputStream.close();\n\t\toutputStream.close();\n\t\t\n\t}\n}\n\nBut the output file is corrupted after operation. Where as, if I use the same text, aTextRun.setText(inputText), output file is fine.", "id": 149152, "time": "2011-09-11T13:25:00Z", "creator": "sanmoy@gmail.com", "creation_time": "2011-09-11T13:25:00Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 51800, "attachment_id": 27484, "text": "Created attachment 27484\noutput file\n\nwhile opening the output file, office showed error.\n\nTested with latest nightly build available 20110911", "id": 149153, "time": "2011-09-11T13:29:58Z", "creator": "sanmoy@gmail.com", "creation_time": "2011-09-11T13:29:58Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 51800, "attachment_id": 27582, "text": "Created attachment 27582\nlog file of microsoft binary file format validator\n\nI have run bffvalidator tool and log has been generated. But couldn't understand the reason behind the validation failure.", "id": 149719, "time": "2011-09-24T15:23:46Z", "creator": "sanmoy@gmail.com", "creation_time": "2011-09-24T15:23:46Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 51800, "attachment_id": null, "id": 149720, "time": "2011-09-24T16:46:45Z", "creator": "apache@gagravarr.org", "creation_time": "2011-09-24T16:46:45Z", "is_private": false, "text": "It looks like there's a problem with the value at 39057, the ULONG in the PFMasks. There is a link to the documentation covering that part, I'd suggest reading through that and comparing what it says should be there with what actually is. If need be, step up the types list reading about those"}, {"count": 4, "tags": [], "text": "(In reply to comment #3)\n> It looks like there's a problem with the value at 39057, the ULONG in the\n> PFMasks. There is a link to the documentation covering that part, I'd suggest\n> reading through that and comparing what it says should be there with what\n> actually is. If need be, step up the types list reading about those\n\nThanks for providing the pointers. \n\nAfter reading the documents and the exception report, I found the below points :\n\nchildId=\"27\", which means, the 27th field in the structure is failing validation. According to the msdn doc, the last 6 bits are reserved and must be 0 and must be ignored. If I convert the decimal data to binary, 89->1011001, it is clear that the fields are wrong. \n\nIs this conclusion correct? If so, please tell where to look in the code now..", "is_private": false, "id": 149724, "creator": "sanmoy@gmail.com", "time": "2011-09-25T05:05:08Z", "bug_id": 51800, "creation_time": "2011-09-25T05:05:08Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "apache@gagravarr.org", "text": "Take a look at the code for that record (I think it's StyleTextPropAtom) and see how it generates the value", "id": 149768, "time": "2011-09-26T15:43:13Z", "bug_id": 51800, "creation_time": "2011-09-26T15:43:13Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "text": "\n\n*** This bug has been marked as a duplicate of bug 45088 ***", "attachment_id": null, "bug_id": 51800, "id": 186147, "time": "2015-11-01T19:54:46Z", "creator": "kiwiwings@apache.org", "creation_time": "2015-11-01T19:54:46Z", "is_private": false}]