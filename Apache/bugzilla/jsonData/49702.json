[{"count": 0, "attachment_id": 25840, "creator": "antti.koskimaki@joinex.com", "is_private": false, "id": 138869, "time": "2010-08-04T03:46:28Z", "bug_id": 49702, "creation_time": "2010-08-04T03:46:28Z", "tags": [], "text": "Created attachment 25840\npatch for StylesTable to return size of correct (?) list\n\nXSSFWorkbook implementation of wb.getNumCellStyles returns incorrect value, usually just \"1\", while wb.getCellStyleAt() still finds all the styles (...before IndexOutOfBounds hits :)\n\nI inspected the code, and finally patched StylesTable to return size of different list, as shown in attached patch. Seems to work, although I would suggest that someone more familiar with XSSF internals checks through the code. I got quite confused about styleXfs vs. xfs..."}, {"count": 1, "attachment_id": null, "creator": "apache@gagravarr.org", "is_private": false, "id": 138881, "time": "2010-08-04T10:43:29Z", "bug_id": 49702, "creation_time": "2010-08-04T10:43:29Z", "tags": [], "text": "Thanks for investigating this\n\nSomething similar applied in r982269, along with unit tests which show that we correct get the right number of styles as they're added, and that we can't read off the end of the list any more"}]