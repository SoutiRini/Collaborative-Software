[{"count": 0, "tags": [], "bug_id": 13745, "text": "Xindice uses the reference implementation of XUpdate from xmldb.org.\n\nIn the org.xmldb.xupdate.lexus.commands package, especially in the\nCommandConstants class, static variables are used as temporaries,\nand for parameter passing between methods.\n\nExample (from CommandConstants.java):\n\n    /**\n     * Sets the contextNode which is to be updated and initializes the objects\n     * for each XUpdate operation.\n     * @param node the contextNode which is to be updated.\n     * @throws IllegalArgumentException if node is null.\n     */\n    public void setContextNode( Node node ) throws Exception {\n        if (node==null) {\n            throw new IllegalArgumentException( \"context node must not be \nnull !\" );\n        }\n        _contextNode = node;\n        \n        _command = new CommandObject[COMMAND_COUNT];\n        _command[0] = new RemoveCommand( _contextNode );\n        _command[1] = new RenameCommand( _contextNode );\n        _command[2] = new UpdateCommand( _contextNode );\n        _command[3] = new VariableCommand( _contextNode );\n        _command[4] = new AppendCommand( _contextNode );\n        _command[5] = new InsertBeforeCommand( _contextNode );\n        _command[6] = new InsertAfterCommand( _contextNode );\n    }\n\nIn the above, _contextNode is a static.\nThis case can easily be fixed (use the parameter node\ninstead of _contextNode when instantiating commands).\n\nThe code for processing the \"variables\"\nfeature uses the static _contextNode:\n\nExample (from InsertVariable.java):\n\n   /**\n     *\n     */\n    protected NodeList selectNewNodes( String query ) throws Exception {\n//long start = System.currentTimeMillis();\n        XPathQuery xpath = CommandObject.getXPath();\n        xpath.setQString( query );\n        XObject xResult = xpath.execute( CommandConstants._contextNode );\n        if (xResult.getType()!=XObject.CLASS_NODESET) {\n            throw new Exception( \"XPath leads not to a Node or NodeList !\" );\n        }\n        NodeList result = xResult.nodeset();\n//long end = System.currentTimeMillis() - start;\n//System.err.println(\"value-of select:\"+end);\n        return result;\n    }\n\nTherefore, until the XMLDB XUpdate implementation\nis fixed or replaced, Xindice cannot be condsidered\nthread-safe for XUpdate usage.\n\nNote that testing for problems from this sort\nof bug may be difficult. Code inspection is required.", "id": 24800, "attachment_id": null, "creator": "Terry.Rosenbaum@gmail.com", "creation_time": "2002-10-17T16:06:12Z", "time": "2002-10-17T16:06:12Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 13745, "is_private": false, "count": 1, "id": 38096, "time": "2003-05-30T23:59:50Z", "creator": "Kevin.Ross@iVerticalLeap.com", "creation_time": "2003-05-30T23:59:50Z", "text": "You bring up a good point.  You have already tried interacting with the xmldb \nlist correct?  If so, and there was no response (which seems to be the case), \nlets fix the problem in-house with the api, and submit patches to the xmldb \ngroup.  what do you think?"}, {"count": 2, "tags": [], "bug_id": 13745, "attachment_id": null, "is_private": false, "id": 38408, "time": "2003-06-05T06:44:52Z", "creator": "Terry.Rosenbaum@gmail.com", "creation_time": "2003-06-05T06:44:52Z", "text": "I did not take this up with xmldb mailing\nlist. I thought that xmldb was less active\nthan xindice. I see there is some life there\nthough, so I have posted this bug to the\nxupdate-dev@xmldb.org list."}, {"attachment_id": null, "tags": [], "bug_id": 13745, "text": "The only static thing left in current version of xupdate is:\n  public static TempTree tempTree = null;\n\nSo it is not thread safe yet.\n\nVadim\n", "count": 3, "id": 51899, "time": "2004-02-08T04:16:30Z", "creator": "vgritsenko@apache.org", "creation_time": "2004-02-08T04:16:30Z", "is_private": false}]