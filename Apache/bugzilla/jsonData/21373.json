[{"attachment_id": null, "tags": [], "creator": "rory@mungler.com", "text": "When using the CvsTagDiff task, if you specify package=\"some/cvs/package \nanother/cvs/package yet/another/package\" - ie space-separated package names \n(which is legal in CVS), the task fails with a StringIndexOutOfBounds exception.\n\nI enclose a patched version of the 1.5.3 source.\n\nCheers\n\nRory Sinclair", "count": 0, "id": 40069, "time": "2003-07-07T14:09:02Z", "bug_id": 21373, "creation_time": "2003-07-07T14:09:02Z", "is_private": false}, {"count": 1, "tags": [], "creator": "rory@mungler.com", "attachment_id": 7122, "text": "Created attachment 7122\nPatched version of the 1.5.3 source of CvsTagDiff.java", "id": 40071, "time": "2003-07-07T14:10:16Z", "bug_id": 21373, "creation_time": "2003-07-07T14:10:16Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 21373, "attachment_id": null, "id": 40072, "time": "2003-07-07T14:11:22Z", "creator": "rory@mungler.com", "creation_time": "2003-07-07T14:11:22Z", "is_private": false, "text": "PS The patch looks for the first index of '/' in the CVS rdiff output to remove \nthe 'File Modulename/' part from the start of the string.  I am unable to test \nthis under unix to check if the slash changes.  Can someone verify this?"}, {"count": 3, "tags": [], "bug_id": 21373, "attachment_id": 7214, "id": 40345, "time": "2003-07-10T14:32:03Z", "creator": "antoine@apache.org", "creation_time": "2003-07-10T14:32:03Z", "is_private": false, "text": "Created attachment 7214\nreal patch file against head revision of CvsTagDiff.java"}, {"count": 4, "tags": [], "bug_id": 21373, "text": "Created attachment 7215\noops, previous file was wrong; patch against head revision of CvsTagDiff.java", "id": 40347, "time": "2003-07-10T14:36:19Z", "creator": "antoine@apache.org", "creation_time": "2003-07-10T14:36:19Z", "is_private": false, "attachment_id": 7215}, {"attachment_id": null, "tags": [], "creator": "antoine@apache.org", "text": "there is a conceptual problem with this patch :\ncurrently, the cvstagdiff task supports only one CVS package at a time.\nThe schema of the xml is done for only one package.\nIt might be better to do the suggested modification with nested elements of the \ntype\n<package name=\"ant\" destfile=\"antdiff.xml\"/>\n<package name=\"jakarta-commons-sandbox\" destfile=\"jakarta-commons-sandboxdiff.\nxml\"/>\n...\nOtherwise the output xml will contain all the packages selected without break.\nHere is what the current ant manual says about cvstagdiff :\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<tagdiff startTag=\"ANT_14\" endTag=\"ANT_141\" \ncvsroot=\":pserver:anoncvs@cvs.apache.org:/home/cvspublic\" package=\"ant\">\n  <entry>\n    <file>\n      <name>src/main/org/apache/tools/ant/DirectoryScanner.java</name>\n      <revision>1.15.2.1</revision>\n      <prevrevision>1.15</prevrevision>\n    </file>\n  </entry>\n</tagdiff>\n\nRory, I would like your input on this.", "count": 5, "id": 40348, "time": "2003-07-10T14:41:08Z", "bug_id": 21373, "creation_time": "2003-07-10T14:41:08Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "rory@mungler.com", "text": "Well, the line returned by CVS actually has the top level (ie CVS) module in \nit, but CvsTagDiff.java removes it.  The line reads:\n\nFile Module/Package/Blah/Something.java changed from revision 1.2 to 1.2.1\n\nand CvsTagDiff.java removes the 'File Module/' part.  In the existing code, it \nuses the string length of the module name plus 5 plus 1 [ie \"File \nModule/\".length()], and my patch just removed everything up to and including \nthe first '/' so that it would do so for any module name length.\n\nThe code could be changed to only remove the module name if there is only one \npackage specified.  ie if multiple packages are specified, the results could \nspan multiple CVS modules, hence they should be returned.  This could cause \nproblems if any package names have spaces in them (ie how else are you going to \ntell multiple packages have been specified, if not by checking for spaces?).\n\nAlternatively, the code could be changed to always return the module name, but \nthis would probably break a few existing systems.  \n\nTherefore I propose a compromise - how about adding a boolean attribute to the \n<cvstagdiff> task to specify whether or not to return the module?  eg:\n\n<cvstagdiff package=\"Version2.0/Some/Directory Version3.0/Some/Other/Stuff\" \nreturnmodulenames=\"true\" .... />\n\nDefault it to false, hence existing code doesn't break.  Nice.\n\nWhat do you think?\n\nCheers\n\nRory\n", "count": 6, "id": 40358, "time": "2003-07-10T16:03:15Z", "bug_id": 21373, "creation_time": "2003-07-10T16:03:15Z", "is_private": false}, {"count": 7, "tags": [], "creator": "rory@mungler.com", "attachment_id": 7220, "text": "Created attachment 7220\nPatched v1.5.3 CvsTagDiff.java - sorry, i cant create patch files ;o)", "id": 40360, "time": "2003-07-10T16:23:27Z", "bug_id": 21373, "creation_time": "2003-07-10T16:23:27Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 21373, "attachment_id": null, "id": 40361, "time": "2003-07-10T16:41:24Z", "creator": "rory@mungler.com", "creation_time": "2003-07-10T16:41:24Z", "is_private": false, "text": "I just wanted to comment - i'm working on a project to automate our inhouse \nbuild process (for both full builds and patches) using xml description files of \nbuild packages, XSLTing them into Ant files, and then invoking them.  I had a \nnasty hack in place to find the module name for the CVS export commands I was \nexecuting from the output of the cvstagdiff.  After having put in the patch, \nand changing my xsl files to insert 'returnmodules=\"true\" in the cvstagdiff \ntask, it has made life MUCH easier and nicer, so I think this may be a feature \nothers would find useful - certainly for me, its much easier to have all \nchanges across multiple packages in one diff file, complete with the module \nname, as I can pass each line to the cvs export command directly.  \n\nDoing it this way still allows the user to diff one package at a time, but also \nallows a diff over multiple packages."}, {"count": 9, "tags": [], "text": "Could you download the head revision of ant and produce a patch (a real one) \nagainst it, this would help.", "attachment_id": null, "id": 41086, "creator": "antoine@apache.org", "time": "2003-07-21T15:37:57Z", "bug_id": 21373, "creation_time": "2003-07-21T15:37:57Z", "is_private": false}, {"count": 10, "tags": [], "creator": "antoine@apache.org", "attachment_id": null, "text": "Reassigning bug to dev@ant.apache.org, not a top priority for me at the moment.", "id": 41789, "time": "2003-07-30T15:37:42Z", "bug_id": 21373, "creation_time": "2003-07-30T15:37:42Z", "is_private": false}, {"count": 11, "tags": [], "bug_id": 21373, "attachment_id": null, "id": 46941, "time": "2003-11-06T20:40:58Z", "creator": "antoine@apache.org", "creation_time": "2003-11-06T20:40:58Z", "is_private": false, "text": "Problem fixed at the same time as the bug 22777."}]