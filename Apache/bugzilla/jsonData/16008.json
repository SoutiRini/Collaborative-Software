[{"count": 0, "attachment_id": null, "creator": "perlsite@mail.bg", "is_private": false, "id": 29210, "time": "2003-01-12T19:01:40Z", "bug_id": 16008, "creation_time": "2003-01-12T19:01:40Z", "tags": [], "text": "This issue happend with httpd-2.0 (all version I've tried) under Windows XP \nand Win98 and also located in some of ver. of 1.3, however Apache 1.3.24 and \n1.3.27 working fine! (under Unix/Linux no problems found!)\nNo special directives/modules are used.\nWhen I'm using Perl script (different Perl's distibutions I've tried: 5.6; \n5.8 -> ActivePerl and Perl+Apache+Openssl binary distribution) a problem \noccure using follow test field/scheme:\n1. I've hold total output in one variable (for example $a = '...large..data'; \nfor example 80kb - Perl handle these data correct!)\n2. Print data to browser: print $a... ofcource any headers are sent and \nso..on! This problem does not exists with in 1.3.24 and 1.3.27 but in all 2.x \nI've examed!\n3. Also I've tried to send data in small parts for example in blocks of 4kb \n(Also I've tried to play with buffered - non-buffered mode $|... but no \neffect!)\n4. When I've print small pages everything is ok!\n5. Surprice! When I've print large data in small blocks (1kb) and \"sleep\" \nafter every block in (0.3s) per block...Apache seem to handle output \ncorrectly!?\n6. Binry/non-binary (STDOUT) take's NO effect - problem still exists!\n7. The same effect occures in all tested browsers!\n\nEFFECT:\n1. Data printed in browser is damaged! Data contain \"strange\" charaters, html \ntags are damaged. Damages are random! Page can't be displayed correctly. Some \nof browser's try to refresh page in infinite loop (try to display page..and \nit \"notice\" that something wrong..and try to re-open page...IE can't \nstop..till I hit \"stop\" button).\n2. Strage.. when I'v print normal html page (large) everything's fine!\n3. When I've download file (via PERL script... also large file. It's NOT \ndamaged!) - Is it MIME-based problem?\n\nI've tried all my knowlages in Perl to handle this problem, but finnaly I've \nunderstand that this problem exists only in some Apache's version (I believe \nthat problem does not exists anymore in 1.3.27 destribution and will not be \navailable in next versions), but ver. 2.0.43 this problem still occure when \nI've print large amount of data (~60 kb or more). I believe that, this problem \nis critical to all 2.x Apaches under Windows.\nThank's for reading this bug issue."}, {"count": 1, "tags": [], "creator": "nd@perlig.de", "text": "Do you have some specific test case information in order to reproduce the problem\n(i.e. relevant config, sample script, sample data)?\n\nThanks!", "id": 29211, "time": "2003-01-12T19:22:53Z", "bug_id": 16008, "creation_time": "2003-01-12T19:22:53Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 16008, "text": "Created attachment 4400\nSimple Perl script and example \"html\" page that simulate error under Apache 2.0.43", "id": 29212, "attachment_id": 4400, "creator": "perlsite@mail.bg", "creation_time": "2003-01-12T19:48:42Z", "time": "2003-01-12T19:48:42Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 16008, "attachment_id": null, "text": "I have to post additional info about EFFECTS under point 2)\n\n>2. Strage.. when I'v print normal html page (large) everything's fine!\n\n - I've mean that everything is ok when I fetch that large html page WITHOUT \nPerl..ie http://some.com/large_page.html,\nbut when I've try to print..as it described in Bug issue this page become \ndamaged.\nOfcource these tests I've made with simple as possible script!\nplease take a look at \u00c0ttachment!\nNOTE: NS7 send as respond follow error message:\n\"www.site.com has sent an incorrect or unexpected message. Error Code:\n-12263\"", "id": 29213, "time": "2003-01-12T19:49:35Z", "creator": "perlsite@mail.bg", "creation_time": "2003-01-12T19:49:35Z", "is_private": false}, {"count": 4, "tags": [], "text": "If you need additional information (in case that you can't reproduce bug) I \ncould provided to you more info/data.\n\nI've hope that reports will be useful.\nRegards.", "is_private": false, "id": 29214, "creator": "perlsite@mail.bg", "time": "2003-01-12T20:06:14Z", "bug_id": 16008, "creation_time": "2003-01-12T20:06:14Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 16008, "text": "Created attachment 4401\nPerl script that produce BUG also with CGI downloads.", "id": 29215, "time": "2003-01-12T20:34:58Z", "creator": "perlsite@mail.bg", "creation_time": "2003-01-12T20:34:58Z", "is_private": false, "attachment_id": 4401}, {"count": 6, "tags": [], "creator": "perlsite@mail.bg", "is_private": false, "text": "Once again sorry...for 3. point (concerning download of large files)!\n\n I've made also tests with attached perl script (second attachment) and I've \nmade test with \"download\" script of large .tar.gz file (~ 350kb) but under \nApache 2.x familly the same BUG occure, so no MIME problem.\nBasically BUG occures always with all large data produced by CGI/Perl script.", "id": 29216, "time": "2003-01-12T20:36:18Z", "bug_id": 16008, "creation_time": "2003-01-12T20:36:18Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 16008, "attachment_id": null, "text": "hmm, strange.\nI've tested both of your attachments more or less extensive, but they work fine.\nSystem: Win2k, httpd-2.0.43, active perl 5.8 (beta; build 802).\n(don't have XP...)\n\nDo you have some special filters running? (server side, local proxy or something).\nCan anyone else reproduce the behaviour?\n\n(by the way: Content-Transfer-Encoding doesn't exist in HTTP and the use of\nContent-Disposition is not really recommended, see RFC 2616; 19.4.5 and 15.5)", "id": 29217, "time": "2003-01-12T21:40:23Z", "creator": "nd@perlig.de", "creation_time": "2003-01-12T21:40:23Z", "is_private": false}, {"count": 8, "tags": [], "text": "This problem probably is specific to XP but that is not quite right.\nUnder Win98 I'v install pure Apache2. Visual effect however was not as it \nunder XP, moreover work very \"quite\". I mean that it works quite smooth than \nXP. But time to time IE 4 get lost for 1-2 sec.. and when I saw Access log I \nsaw 4-5 queries in same seconds, i.e. IE 4 make couple of queies before result \npage to be satify (no images requested and other files requested.. only html \npage).\nAlso I've got and distribution: Perl+Apache+OpenSSL where the problem \nis \"perfect\" visable. I've tried the same scripts under HTTPS..and the look \nwas terrable.. (try it).\nHow I've wrote.. browser find that something with page is not ok and makes \nquery again and again till output page is ok.\nAt access.log I found a group of queries like these:\n\n192.168.10.46 - - [13/Jan/2003:00:40:06 +0200] \"GET /cgi-bin/example.pl \nHTTP/1.1\" 200 85974\n192.168.10.46 - - [13/Jan/2003:00:40:06 +0200] \"GET /cgi-bin/example.pl \nHTTP/1.1\" 200 85974\n192.168.10.46 - - [13/Jan/2003:00:40:06 +0200] \"GET /cgi-bin/example.pl \nHTTP/1.1\" 200 85974\n192.168.10.46 - - [13/Jan/2003:00:40:06 +0200] \"GET /cgi-bin/example.pl \nHTTP/1.1\" 200 85974\n\nWhich has the same time and file size!\n\nI found that Apache 2 + SSL this problem is more expressive (maybe because \nApache get slowdowned with encryption? and that takes affect to output, or \ncryped data are more sensive to errors? something like CRC?)\n\nAnyway.. I haven't any non-standard filters ot services.. (note that problem \nis specific only to Apache 2x). Under Apache 1.3.27 everthings fine! (with and \nwithout SSL). Probably I've test everything I could! Even I've tried to \nshutdown one by one all started services that I think that they may be related \nto this bug.\nMy test \"area\" properties:\n->Windows XP (Build 2600) Professional (without SP1)\n->IE 6.0.2600\n->Apache\n Server version: Apache/2.0.43\n Server built:   Dec 25 2002 18:12:51\n Server's Module Magic Number: 20020903:0\n Architecture:   32-bit\n->PERL\n ActivePerl Build 804\n Built under MSWin32\n Compiled at Dec 23 2002 22:46:33\n\nI suggest to procedure by follow way:\nstart example.pl and through 2sec..pres CTRL+R.. 10-15 times..and after that \nanalyse Access.log file and try to find couple queries in the same second.\nIf no success try this with second example (with .tar.gz always I get this \nproblem.. IE ask to \"save as\".. and when I click \"Save\".. it automaticaly \nclose windows..and download get lost).\n\nIf this not help, probably you will need XP. Anyway I will search these days \nto find other systems with XP and I will try this again.\n\nNote: I've lost some time to find the lower boundery, when Apache 2.x start \nproduce garbage output with(without) SSL support (mod_ssl and OpenSSL - latest \nversions). The actual minimal size of produced document should be about 40kb\n(50kb). So 95% of cases in that size Apache handle output correctly, but in 5% \nit force browser(IE) to refresh page, and next time almost in 95% Apache is \nable to send correct output. With 60kb(100kb) in 99.99% Apache produce damaged \noutput.\n\nBefore couple of months I've got the same problem (with prvious instalation of \nWindows XP and Perl 5.6) and that's why I've deleted Apache 2 and I've back to \n1.3 for my test purposes). Moreover in one PC magazine I've read one article \nfor Perl and Apache, so I've read that the author think that Apache 2 is not \nstable at this time and then I wrote a mail and ask him why (because I've got \nthis problem already) and he told me that CGI output is incorect at some \ncases... so yesterday I've downloaded 1.0.43 and I was very unpleasant to find \nthat Apache 2 still got the same problem, so I've decide to write  bug report).", "is_private": false, "id": 29219, "creator": "perlsite@mail.bg", "time": "2003-01-12T23:26:38Z", "bug_id": 16008, "creation_time": "2003-01-12T23:26:38Z", "attachment_id": null}, {"count": 9, "attachment_id": null, "bug_id": 16008, "is_private": false, "id": 29294, "time": "2003-01-13T19:41:18Z", "creator": "perlsite@mail.bg", "creation_time": "2003-01-13T19:41:18Z", "tags": [], "text": "The same were reproduced at another XP system."}, {"count": 10, "tags": [], "creator": "apachez@home.se", "text": "This bug have been seen earlier (and was limited to win xp). There is a buggy \ndll in xp which creates this behavior of damaging data larger than 64 kb when \ntransmitted over network. I dont remember the solution but there has been links \nto this issue at microsoft.com but they refer only to contact your local dealer \nor something in order to obtain the patch (search the bug database here at \napache.org to see the other threads regarding this). Hopefully this patch is \navailable in SP1 for winXP. So have you tried to install SP1 in order to see if \nthis solves your problems ?", "id": 29498, "time": "2003-01-16T07:21:17Z", "bug_id": 16008, "creation_time": "2003-01-16T07:21:17Z", "is_private": false, "attachment_id": null}, {"count": 11, "tags": [], "text": "afd.sys was the file I was thinking of.\n\nInformation can be found at these locations:\n\nhttp://support.microsoft.com/default.aspx?scid=kb;EN-US;q317949\nhttp://www.apache.org/dist/httpd/binaries/win32/README.html\nhttp://nagoya.apache.org/bugzilla/show_bug.cgi?id=9541 (and probably other \nbugreports but this was the one I found right now)\n", "is_private": false, "id": 29500, "creation_time": "2003-01-16T07:36:54Z", "time": "2003-01-16T07:36:54Z", "creator": "apachez@home.se", "bug_id": 16008, "attachment_id": null}, {"count": 12, "tags": [], "bug_id": 16008, "attachment_id": null, "is_private": false, "id": 29556, "time": "2003-01-16T17:37:57Z", "creator": "wrowe@apache.org", "creation_time": "2003-01-16T17:37:57Z", "text": "\n  This bug is clearly documented on the downloads page:\n\n  http://www.apache.org/dist/httpd/binaries/win32/\n\n  You must update to XP SP1 or obtain the afd.sys patch (which is very hard\n  to obtain now that it's included in SP1.)\n\n  If you experience the same problems once you've installed the update and\n  restarted the machine, please reopen this bug.\n"}, {"count": 13, "tags": [], "bug_id": 16008, "attachment_id": null, "is_private": false, "id": 29563, "time": "2003-01-16T18:24:43Z", "creator": "perlsite@mail.bg", "creation_time": "2003-01-16T18:24:43Z", "text": "Yes, that was.. afd.sys is all it needs. Thanks guys :-)"}]