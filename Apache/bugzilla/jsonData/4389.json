[{"count": 0, "tags": [], "bug_id": 4389, "attachment_id": null, "is_private": false, "id": 7093, "time": "2001-10-24T03:02:44Z", "creator": "paul_evenblij@nl.compuware.com", "creation_time": "2001-10-24T03:02:44Z", "text": "In Batik1.1rc3, the following piece of code generates incorrects SVG:\n\n ImageIcon image = new ImageIcon(\"class.gif\");\n svgGenerator.translate(40,40);\n svgGenerator.drawImage(image.getImage(), new AffineTransform(), null);\n\nIn the generated SVG, the translation is dropped, and the image is drawn at \nposition (0,0):\n\n <svg style=\"[blah]\" width=\"400\" height=\"200\">\n   <!--Generated by the Batik Graphics2D SVG Generator-->\n   <defs id=\"genericDefs\" />\n   <g>\n     <g>\n       <image width=\"16\" x=\"0\" height=\"16\" y=\"0\"\n        xlink:href=\"data:image/png;base64 [blah]\" />\n     </g>\n   </g>\n </svg>\n\n\nNote that in rc2, the generated code looked like this: \n \n <svg style=\"[blah]\" width=\"400\" height=\"200\">\n   <!--Generated by the Batik Graphics2D SVG Generator-->\n   <defs id=\"genericDefs\" />\n   <g>\n     <g transform=\"translate(40,40)\">\n       <image width=\"16\" x=\"0\" height=\"16\" y=\"0\"\n        xlink:href=\"data:image/png;base64 [blah]\" />\n     </g>\n   </g>\n </svg>\n\n\nOther drawImage() calls do not seem to suffer from this problem."}, {"attachment_id": 714, "tags": [], "bug_id": 4389, "is_private": false, "count": 1, "id": 7094, "time": "2001-10-24T03:04:29Z", "creator": "paul_evenblij@nl.compuware.com", "creation_time": "2001-10-24T03:04:29Z", "text": "Created attachment 714\nsource for reproduction"}, {"attachment_id": 715, "tags": [], "bug_id": 4389, "is_private": false, "count": 2, "id": 7095, "time": "2001-10-24T03:06:31Z", "creator": "paul_evenblij@nl.compuware.com", "creation_time": "2001-10-24T03:06:31Z", "text": "Created attachment 715\ntest result for Batik1.1rc2"}, {"count": 3, "tags": [], "text": "Created attachment 716\ntest result for Batik1.1rc3", "is_private": false, "bug_id": 4389, "id": 7096, "time": "2001-10-24T03:07:10Z", "creator": "paul_evenblij@nl.compuware.com", "creation_time": "2001-10-24T03:07:10Z", "attachment_id": 716}, {"count": 4, "text": "FIX:\nSmall oversight on my part. If a TransformElementStack with an identity \ntransform *on top* was converted to SVG, the non-identity element on top of the \npresentation stack was removed without being pushed back. Remedied this. See \npatch:\n\nIndex: SVGTransform.java\n===================================================================\nRCS file: \n/home/cvspublic/xml-batik/sources/org/apache/batik/svggen/SVGTransform.java,v\nretrieving revision 1.4\ndiff -u -r1.4 SVGTransform.java\n--- SVGTransform.java   2001/10/01 12:37:10     1.4\n+++ SVGTransform.java   2001/10/24 21:48:58\n@@ -147,6 +147,11 @@\n             element = (TransformStackElement) presentation.push(element);\n         }\n  \n+        // Push back the last element popped, if not null\n+        if(element != null) {\n+            presentation.push(element);\n+        }\n+ \n         //\n         // Transform presentation stack to SVG\n         //\n", "creator": "paul_evenblij@nl.compuware.com", "attachment_id": null, "id": 7140, "time": "2001-10-25T02:39:00Z", "bug_id": 4389, "creation_time": "2001-10-25T02:39:00Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "creator": "vincent.hardy@sun.com", "text": "See org.apache.batik.svggen.Bug4389.java. Regression test has been integrated\nin the regsvggen.xml test suite.", "id": 7821, "time": "2001-11-12T23:37:29Z", "bug_id": 4389, "creation_time": "2001-11-12T23:37:29Z", "is_private": false, "attachment_id": null}]