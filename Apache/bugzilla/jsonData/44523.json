[{"count": 0, "tags": [], "text": "I'd like to programmatically select a sheet with the following function:\n\ngetWorkbook().setSelectedTab((short)2);\n\nThe sheet with index 2 is displayed correctly but its \"sheet tab\" on the left bottom corner doesn't seem to be selected (actually no tab is selected...).\nA selected tab is usually displayed with a white background color.\n\nMichael", "is_private": false, "bug_id": 44523, "id": 114229, "time": "2008-03-04T02:57:40Z", "creator": "michael.hunziker@trivadis.com", "creation_time": "2008-03-04T02:57:40Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 114230, "time": "2008-03-04T03:01:23Z", "bug_id": 44523, "creation_time": "2008-03-04T03:01:23Z", "is_private": false, "text": "I'm guessing we're not setting all the records we need to then\n\nCan you upload three files:\n* the original file, with some other tab selected\n* the file with tab 2 selected by poi\n* the file with tab 2 selected by excel\n\nIdeally, could you also use biffviewer to spot the difference between them? Clearly one or two records aren't being updated that need to be, so we need to identify these records (by comparing the 3 files)"}, {"count": 2, "tags": [], "creator": "michael.hunziker@trivadis.com", "attachment_id": 21618, "is_private": false, "id": 114235, "time": "2008-03-04T04:07:06Z", "bug_id": 44523, "creation_time": "2008-03-04T04:07:06Z", "text": "Created attachment 21618\nOriginal File (Sheet 1 selected)"}, {"count": 3, "tags": [], "text": "Created attachment 21619\nPOI Outputfile (Sheet 3 displayed but tab not selected)\n\nFileOutputStream out = new FileOutputStream(\"test_hmi.xls\");\nInputStream input = RunImport.class.getResourceAsStream( \"simple.xls\" );\nPOIFSFileSystem fs = new POIFSFileSystem( input );\nHSSFWorkbook wb = new HSSFWorkbook(fs);\n            \n// Select last sheet\nwb.setSelectedTab((short)(wb.getNumberOfSheets()-1));\n\nwb.write(out);\nout.close();\n\n// Note that sheet 3 is displayed in the output file but its tab is not correctly selected (sheet 1 remains selected)", "attachment_id": 21619, "id": 114237, "creation_time": "2008-03-04T04:39:22Z", "time": "2008-03-04T04:39:22Z", "creator": "michael.hunziker@trivadis.com", "bug_id": 44523, "is_private": false}, {"count": 4, "tags": [], "creator": "michael.hunziker@trivadis.com", "attachment_id": 21621, "is_private": false, "id": 114239, "time": "2008-03-04T04:40:00Z", "bug_id": 44523, "creation_time": "2008-03-04T04:40:00Z", "text": "Created attachment 21621\nCorrect file (POI output should look like this)"}, {"attachment_id": null, "tags": [], "creator": "josh@apache.org", "is_private": false, "count": 5, "id": 116690, "time": "2008-05-15T16:35:58Z", "bug_id": 44523, "creation_time": "2008-05-15T16:35:58Z", "text": "Fixed in svn r656893\n\nLooks like some confusion between sheet selection and focus (starting in WINDOW2 record).\n\nAdded new method setActiveSheet(int) to HSSFWorkbook.\nChanged comment on selSelectedTab(int) to emphasise distinction from setActiveSheet\nAdded new method setSelectedTabs(int[]) for multiple tab(sheet) selection.\nAdded new methods / deprecated old methods with misleading names.\nAdded junit test cases.\n"}, {"count": 6, "tags": [], "creator": "dunumania@yahoo.co.in", "attachment_id": null, "is_private": false, "id": 130781, "time": "2009-10-01T12:57:37Z", "bug_id": 44523, "creation_time": "2009-10-01T12:57:37Z", "text": "I confirm, I am facing the same problem.\nIt's not fixed.\nIn same scenario, after copying a old workbook from then adding a sheet to it and saving it. And setting the new sheet as Active is not working.\n\nI tried below both ways.\t\t\t\n\nworkBook.setActiveSheet(workBook.getSheetIndex(workBook.getSheet(sheetName)));\n\t\t\tworkBook.setSelectedTab(workBook.getSheetIndex(workBook.getSheet(sheetName)));\n\nBut none is working.\n\n\nThanks\nShiva"}, {"count": 7, "text": "Neither this works too :(\n\nworkBook.setFirstVisibleTab(workBook.getSheetIndex(workBook.getSheet(sheetName)));", "bug_id": 44523, "attachment_id": null, "id": 130782, "time": "2009-10-01T13:12:28Z", "creator": "dunumania@yahoo.co.in", "creation_time": "2009-10-01T13:12:28Z", "tags": [], "is_private": false}, {"count": 8, "text": "Neither this works too :(\n\nworkBook.setFirstVisibleTab(workBook.getSheetIndex(workBook.getSheet(sheetName)));", "bug_id": 44523, "is_private": false, "id": 130783, "time": "2009-10-01T13:14:59Z", "creator": "dunumania@yahoo.co.in", "creation_time": "2009-10-01T13:14:59Z", "tags": [], "attachment_id": null}, {"count": 9, "tags": [], "text": "Created attachment 24337\nsample code re-testing bug fix\n\nThis code shows adding a new sheet to an existing workbook, and setting it both 'active' and 'selected'.\n\nMore extensive junits were added with the bug-fix in svn r657136 .", "is_private": false, "id": 130830, "creation_time": "2009-10-02T11:12:36Z", "time": "2009-10-02T11:12:36Z", "creator": "josh@apache.org", "bug_id": 44523, "attachment_id": 24337}, {"count": 10, "tags": [], "bug_id": 44523, "attachment_id": null, "text": "You haven't supplied enough details to make it clear what is going wrong, so it is difficult to guess what mistake you have made.\n\nPerhaps you are using POI 3.0 or earlier.  The fix was available from version 3.1 onwards.\n\nPerhaps you haven't read the javadoc properly.  Note - in the typical scenario both wb.setActiveSheet(ix) and wb.setSelectedTab(ix) need to be called.  It's not clear whether you tried this.  In any case you should have seen the proper effects of calling either method in isolation.\n\nPerhaps you've found some more complex use-case which re-creates the bug in version 3.1 or later.  If you are certain you have working code that calls both these methods and creates a workbook with the wrong sheet active or selected, please upload that example (like attachment (id=24337)) to demonstrate your assertion.", "id": 130831, "time": "2009-10-02T11:36:46Z", "creator": "josh@apache.org", "creation_time": "2009-10-02T11:36:46Z", "is_private": false}]