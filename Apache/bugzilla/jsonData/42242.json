[{"count": 0, "tags": [], "creator": "nettings@apache.org", "is_private": false, "id": 102337, "attachment_id": null, "bug_id": 42242, "creation_time": "2007-04-25T07:27:54Z", "time": "2007-04-25T07:27:54Z", "text": "two oddities wrt revisions:\n* in lenya.usecase=tab.revisions, click on revision N. the link points to N+1.\n* regardless of the revision you ask for, you always get the current one.\n\na quick grep through the code shows that the only time we actually evaluate the\n\"lenya.revision\" parameter is in global-sitemap.xmap, to determine whether to\ndisplay a menu (old revisions don't get one to keep the user from trying to edit\nthem).\nthere seem to be doctype-specific (uugh!) \"view-revision\" thingies, but i can't\ntell how they are supposed to work.\n\nwe should fix this for 1.4 unless it implies intrusive changes..."}, {"text": "(In reply to comment #0)\n> two oddities wrt revisions:\n> * in lenya.usecase=tab.revisions, click on revision N. the link points to N+1.\n\nThat's because it starts to count with 1, but the first revision doesn't have a\nbackup and therefore it is not in the list (see Revisions.java):\n\n    entries = this.rcml.getBackupEntries();\n\nWe could display the actual version numbers, but then the list would start with\n\"2\". Or maybe we could add a backup for the initial version (no idea why this\ndoesn't happen).", "tags": [], "bug_id": 42242, "is_private": false, "count": 1, "id": 102353, "time": "2007-04-25T08:21:32Z", "creator": "andreas@apache.org", "creation_time": "2007-04-25T08:21:32Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 42242, "text": "(In reply to comment #1)\n> That's because it starts to count with 1, but the first revision doesn't have\n> a backup and therefore it is not in the list (see Revisions.java):\n> \n>     entries = this.rcml.getBackupEntries();\n> \n> We could display the actual version numbers, but then the list would start with\n> \"2\". Or maybe we could add a backup for the initial version (no idea why this\n> doesn't happen).\n\nlet me get this straight: we have revisions, and each revision also has a backup\ncopy? why?\nand yes, if that is the case, we should have a backup for rev1 as well...\n\n", "id": 102358, "time": "2007-04-25T08:31:08Z", "creator": "nettings@apache.org", "creation_time": "2007-04-25T08:31:08Z", "is_private": false, "attachment_id": null}, {"count": 3, "attachment_id": null, "creator": "andreas@apache.org", "text": "(In reply to comment #2)\n\n> let me get this straight: we have revisions, and each revision also has a backup\n> copy?\n\nThe revision information is stored in the .rcml file. For a check-in revision it\nis optional if a backup shall be created.\n\n> why?\n\nActually I have no idea, it has been like that before I joined the project.\n\n> and yes, if that is the case, we should have a backup for rev1 as well...\n\nMaybe we should just make the backup mandatory (at least until we have\nincremental version storage).", "id": 102359, "time": "2007-04-25T08:35:14Z", "bug_id": 42242, "creation_time": "2007-04-25T08:35:14Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "creator": "andreas@apache.org", "attachment_id": null, "is_private": false, "id": 102361, "time": "2007-04-25T08:42:51Z", "bug_id": 42242, "creation_time": "2007-04-25T08:42:51Z", "text": "The DocumentSourceFactory doesn't include the rev parameter in the lenya:// URL."}, {"count": 5, "tags": [], "bug_id": 42242, "text": "This snippet has to be added to DocumentSourceFactory:\n\n            if (target.isRevisionSpecified()) {\n                if (queryString == null) {\n                    queryString = \"\";\n                }\n                queryString += \"rev=\" + target.getRevisionNumber();\n            }\n\nUnfortunately I have another overlapping patch pending (see bug 42237), so it's\nquite hard to create a real patch.", "id": 102364, "time": "2007-04-25T08:52:35Z", "creator": "andreas@apache.org", "creation_time": "2007-04-25T08:52:35Z", "is_private": false, "attachment_id": null}, {"count": 6, "attachment_id": null, "creator": "nettings@apache.org", "text": "can't really figure where that snippet belongs... but you can back out your\nother pending patch - it's filed safely in bugzilla and queued for 1.4.1, and a\nworkaround is in place.", "id": 102366, "time": "2007-04-25T08:59:37Z", "bug_id": 42242, "creation_time": "2007-04-25T08:59:37Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "bug_id": 42242, "is_private": false, "text": "(In reply to comment #0)\n> * regardless of the revision you ask for, you always get the current one.\n\nI applied the patch, so this aspect of the issue should be resolved.\n\nNevertheless I'm leaving this open since the revision numbering and backup\nhandling needs to be improved.", "id": 102446, "time": "2007-04-26T04:53:29Z", "creator": "andreas@apache.org", "creation_time": "2007-04-26T04:53:29Z", "attachment_id": null}, {"count": 8, "tags": [], "creator": "andreas@apache.org", "is_private": false, "id": 102447, "attachment_id": null, "bug_id": 42242, "creation_time": "2007-04-26T05:33:04Z", "time": "2007-04-26T05:33:04Z", "text": "Now the obsure fake check-in entry isn't added anymore, so the version numbers\nshould reflect the actual changes."}]