[{"count": 0, "tags": [], "bug_id": 37519, "is_private": false, "text": "I compiled and installed Apache 2.0.54 on Windows 2003. Started Apache. I can\nsee two processes running (one parent and one child). I have a developed a\nApache 2.0 module which is basically a plug-in which intercepts the request\nfirst, redirects to the authentication server and if enough credentials are met\nallows the request to go thru.\n\nI have a init routine where I do basic initialization steps. For some reason the\ninit is getting invoked twice per process. In all I have init getting executed 4\ntimes. This is messing up the logic and the process eventually is getting\nkilled. I am not having this problem with Apache on Solaris or RH AS 3.0. Only\non windows 2003 I see the problem.\n\nMy module snippet:\n\nmodule AP_MODULE_DECLARE_DATA my_module =\n {\n    STANDARD20_MODULE_STUFF,\n    create_rec,    \n    NULL,                       /* create per-server config structures */\n    NULL,                       /* merge per-server config structures */\n    NULL,                       /* command handlers */\n    test_handlers,                /* handlers */\n    register_hooks              /* register hooks */\n };\n\nstatic void register_hooks(apr_pool_t *p)\n{\n   ap_hook_post_config(init_invoke, NULL, NULL, APR_HOOK_LAST);\n}\n\nstatic int init_invoke(apr_pool_t *pconf, apr_pool_t *plog,\n                      apr_pool_t *ptemp, server_rec *server_ptr)\n{\n   // Initialization stuff.....\n}\n\n\nWhen I start Apache.exe, init_invoke() is getting caled 4 times (twice by each\nprocess). Why is init being invoked 4 times?", "id": 82545, "time": "2005-11-16T03:03:15Z", "creator": "madancr@gmail.com", "creation_time": "2005-11-16T03:03:15Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "trawick@apache.org", "attachment_id": null, "text": "Working as designed...  Can't be changed without breaking existing modules...\n\nPerhaps it could be documented somewhere though, such as in the post-config hook\ndocs in http_config.h.\n\n", "id": 82550, "time": "2005-11-16T03:57:04Z", "bug_id": 37519, "creation_time": "2005-11-16T03:57:04Z", "is_private": false}, {"count": 2, "tags": [], "creator": "madancr@gmail.com", "attachment_id": null, "text": "Is there anything that I need to know to fix the problem from my side? Like\nmodifying my module or making any config change in httpd.conf file so that the\ninit gets invoked only once per process?\n\n", "id": 82591, "time": "2005-11-16T21:01:15Z", "bug_id": 37519, "creation_time": "2005-11-16T21:01:15Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 37519, "is_private": false, "text": "You can attach a pointer to the process pool (s->process->pool) using\napr_pool_userdata_set to maintain state across the post_config calls.", "id": 91383, "time": "2006-07-18T12:26:26Z", "creator": "jorton@redhat.com", "creation_time": "2006-07-18T12:26:26Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "wrowe@apache.org", "attachment_id": null, "text": "Reclassed to delete a version", "id": 135505, "time": "2010-03-22T06:00:43Z", "bug_id": 37519, "creation_time": "2010-03-22T06:00:43Z", "is_private": false}, {"count": 5, "attachment_id": null, "creator": "wrowe@apache.org", "text": "Reclassed again to delete a version", "id": 151575, "time": "2011-11-16T22:37:31Z", "bug_id": 37519, "creation_time": "2011-11-16T22:37:31Z", "tags": [], "is_private": false}]