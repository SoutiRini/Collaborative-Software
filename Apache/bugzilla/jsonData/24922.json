[{"count": 0, "tags": [], "bug_id": 24922, "attachment_id": null, "text": "Hello.\nI'm trying to forward requests to remote ftp-server with simple htaccess\n(located in /ftp/ dir):\nRewriteEngine on\nRewriteRule (.*)\\.txt$ ftp://123.123.123.123/$1.txt [P]\n\nBut Apache (2.0.48) returns such error:\nProxy Error\nThe proxy server received an invalid response from an upstream server.\nThe proxy server could not handle the request GET /ftp/file.txt.\n\nReason: Could not connect to remote machine: (null) port 80\n\nI've tested same htaccess with http forward and it just works fine. In\nerror.log (debug mode) i'm getting such messages:\n\nproxy_ftp.c(824): proxy: FTP: serving URL ftp://123.123.123.123\nproxy_ftp.c(917): proxy: FTP: connecting ftp://123.123.123.123 to (null):80\nproxy_ftp.c(995): proxy: FTP: fam 2 socket created, trying to connect to\n0.0.0.0:80 ((null))...\n(OS 10049)The requested address is not valid in its context.  : proxy: FTP:\nattempt to connect to 0.0.0.0:80 ((null)) failed\n\nSome more info: i've tested it under FreeBSD and WinXP, got same result,\nalso if there's local ftp-server running (listening to 0.0.0.0, not\n127.0.0.1), then apache connects to it successfully.\nAlso, i've tried different URI schemes, because i think that module just cant \nparse it correctly, but no way..\nftp://123.123.123.123\nftp://123.123.123.123/\nftp://123.123.123.123:21\nftp://123.123.123.123:21/\nftp://anonymous:password@123.123.123.123\netc, all failed.\n\nAlso, i've tried to bind remote ftp with ProxyPass directive -- same result \n(and again -- binding http server was successful)\nPlease help, I don't like SQUID for some reasons and really would like to have \nftp-proxy with Apache running.\nThanks a lot in advance.", "id": 47939, "time": "2003-11-22T23:13:24Z", "creator": "kirill@1314.ru", "creation_time": "2003-11-22T23:13:24Z", "is_private": false}, {"count": 1, "tags": [], "text": "Today i've added desired IP directly into proxy_ftp.c and though now Apache \ntries to open desired IP, i'm getting segfault (11) just like in this bug:\nhttp://nagoya.apache.org/bugzilla/show_bug.cgi?id=14976\n\nSeems like it still not fixed in 2.0.48.\n", "attachment_id": null, "id": 47978, "creation_time": "2003-11-24T00:19:18Z", "time": "2003-11-24T00:19:18Z", "creator": "kirill@1314.ru", "bug_id": 24922, "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 24922, "is_private": false, "count": 2, "id": 48202, "time": "2003-11-26T21:57:30Z", "creator": "wrowe@apache.org", "creation_time": "2003-11-26T21:57:30Z", "text": "\n  Seriously doubt that this is an identical segfault, Kirill.  Why not attach\n  a backtrace of the crash dump?  And why would you complain about segfaults\n  in a modified module if you didn't post the patch you attempted to use???\n\n  Please, more details - we don't read minds and would love to look closer at\n  these issues :)\n"}, {"count": 3, "tags": [], "bug_id": 24922, "attachment_id": null, "id": 48248, "time": "2003-11-27T14:01:52Z", "creator": "kirill@1314.ru", "creation_time": "2003-11-27T14:01:52Z", "is_private": false, "text": "Sorry, never did things like that :) Here goes the backtrace: \n(gdb) bt\n#0  0x283572c6 in memcpy () from /usr/lib/libc.so.5\n#1  0x0000000c in ?? ()\n#2  0x28349d3f in strchr () from /usr/lib/libc.so.5\n#3  0x2834cad5 in __vfprintf () from /usr/lib/libc.so.5\n#4  0x2833cd35 in sprintf () from /usr/lib/libc.so.5\n#5  0x284ff596 in ap_proxy_ftp_handler () \nfrom /opt/apache/modules/mod_proxy_ftp.so\n#6  0x74662f2f in ?? ()\nCannot access memory at address 0x3a707466\n\nI'll try to collect more info tomorrow, but need to re-compile apache for that."}, {"count": 4, "text": "one more dump:\n(gdb) bt full\n#0  apr_palloc (pool=0x280d11d0, size=8) at apr_pools.c:640\n        active = (struct apr_memnode_t *) 0x280d2a80\n        node = (struct apr_memnode_t *) 0x2\n        mem = (void *) 0x0\n        free_index = 671945168\n(gdb)\n\n(after i've recompiled apache with -g option)", "creator": "kirill@1314.ru", "is_private": false, "id": 48284, "time": "2003-11-28T15:57:24Z", "bug_id": 24922, "creation_time": "2003-11-28T15:57:24Z", "tags": [], "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 24922, "attachment_id": 10892, "id": 54372, "time": "2004-03-22T10:39:56Z", "creator": "pterjan@linuxfr.org", "creation_time": "2004-03-22T10:39:56Z", "is_private": false, "text": "Created attachment 10892\nA quick patch that made reverse ftp work fine for me"}, {"count": 6, "tags": [], "text": "Patch applied to v2.1.0-dev, awaiting backport to v2.0", "attachment_id": null, "bug_id": 24922, "id": 57877, "time": "2004-05-21T22:09:01Z", "creator": "minfrin@sharp.fm", "creation_time": "2004-05-21T22:09:01Z", "is_private": false}, {"count": 7, "text": "committed to 2.0.51-dev\n\nthanks again for the patch!", "creator": "trawick@apache.org", "is_private": false, "id": 60111, "time": "2004-07-03T12:59:59Z", "bug_id": 24922, "creation_time": "2004-07-03T12:59:59Z", "tags": [], "attachment_id": null}]