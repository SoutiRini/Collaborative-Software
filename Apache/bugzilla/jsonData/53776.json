[{"text": "Hi,\n\nin order to support multi-tenancy applications, JDBCRealm should get more options:\nSee this logintable definition\n\nCREATE TABLE t_login \n    ( \n     id INTEGER NOT NULL,\n     tenant_id INTEGER NOT NULL,\n     loginname VARCHAR2 (50 CHAR) NOT NULL, \n     sha1hash VARCHAR2 (40 CHAR) NOT NULL, \n     lastlogin DATE, \n     CONSTRAINT PK_login PRIMARY KEY (id),\n     CONSTRAINT UC_login_tenant_loginname UNIQUE (tenant_id, loginname)\n    );\n\nIn order to make every loginname (e.g. \"admin\") available for every tenant, I need to include the tenant_id within the UC.\nFor JDBCRealm login, which does a select with \"WHERE loginname = j_username\", this means that it can get many rows as result. Obviously, this can't work out.\n\nSo in order have multitenancy support, the <Realm ... /> tag needs two new parameters, one \"tenantColumnName\" (no default, only used when included in tag) and one \"tenantId\", also with no default.", "tags": [], "creator": "blama@gmx.net", "is_private": false, "count": 0, "id": 161662, "time": "2012-08-24T13:19:23Z", "bug_id": 53776, "creation_time": "2012-08-24T13:19:23Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 53776, "text": "I forgot:\nPossible workaround for now:\n- Leave table DDL as it is\n- Create projection-view per tenant\n- Create empty schema per tenant\n- Grant select on correct view from main schema to each tenant\n- Use tenant-schema to handle login (also good practice from security perspective, as no data is known to Tomcat, Tomcat doesn't need to know)", "id": 161663, "time": "2012-08-24T13:28:48Z", "creator": "blama@gmx.net", "creation_time": "2012-08-24T13:28:48Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "knst.kolinko@gmail.com", "attachment_id": null, "id": 161665, "time": "2012-08-24T13:56:39Z", "bug_id": 53776, "creation_time": "2012-08-24T13:56:39Z", "is_private": false, "text": "I would not recommend to use JDBCRealm in productive configurations. The recommended replacement is DataSourceRealm.\n\n> - Create projection-view per tenant\n> - ...\n\nJust creating the VIEW is enough, as the table names are configurable. There is no need to create a separate schema per tenant."}, {"count": 3, "attachment_id": null, "bug_id": 53776, "is_private": false, "id": 167927, "time": "2013-06-20T14:30:03Z", "creator": "markt@apache.org", "creation_time": "2013-06-20T14:30:03Z", "tags": [], "text": "As per previous comment."}]