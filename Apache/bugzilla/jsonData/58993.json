[{"count": 0, "tags": [], "text": "Created attachment 33546\ndocx document contains RTL content\n\nI use \"paragraph.getCTP != null && paragraph.getCTP.isSetPPr && paragraph.getCTP.getPPr.isSetBidi\" to get the directional information for paragraphs. When HWPFDocument reads Arabic/Hebrew documents, I would expect that isSetBidi returns TRUE for the RTL paragraphs. However, it returns FALSE that represents \"LTR\" direction.", "is_private": false, "id": 188347, "creator": "yunan05404@gmail.com", "time": "2016-02-10T21:54:50Z", "bug_id": 58993, "creation_time": "2016-02-10T21:54:50Z", "attachment_id": 33546}, {"count": 1, "tags": [], "creator": "dominik.stadler@gmx.at", "text": "Also reported at http://stackoverflow.com/questions/35326966/extract-wrong-paragraph-direction-in-word-using-apache-poi-library", "id": 188362, "time": "2016-02-11T15:42:48Z", "bug_id": 58993, "creation_time": "2016-02-11T15:42:48Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 58993, "text": "At least with docx, I don't think this is a fault of POI, and I don't think we can fix it.  Once you hit getCTP(), you are out of the hands of POI and into the hands of beans.\n\nIf you look at the ECMA OOXML part 1 standard p. 312, you'll see exactly the same underlying xml that is in your docx, where the only indication is the presence of <rtl/> in both the pPr's rPr and each run's rPr. In short, there is no bidi element in the pPr.\n\nWhile I want your code to work, it looks like the way to get at whether a paragraph is basically rtl or whether a run is rtl _in your document_ (and the test document that I generated as well) is to check for the existence of rtl. \n\nFor a paragraph, if p.getCTP().getPPr().getRPr.getRtl() is null, then the paragraph is probably lrt; if it is not null, then check its value.  If its value is null, then the paragraph is basically LTR, otherwise, I imagine, follow whatever value it has.\n\nFor a run, if r.getRPr().getRtl() is null, then that run is ltr, if it is not null, then you should probably check its value, which may or may not be null.\n\n\n\n        InputStream is = new FileInputStream(f);\n        XWPFDocument doc = new XWPFDocument(is);\n        for (XWPFParagraph p : doc.getParagraphs()) {\n            if (p.getCTP() != null && p.getCTP().getPPr() != null) {\n                if (p.getCTP().getPPr().getRPr().getRtl() != null) {\n                    if (p.getCTP().getPPr().getRPr().getRtl().getVal() == null) {\n                        System.out.println(\"para: rtl\");\n                    } else {\n                        System.out.println(\"para: \" + p.getCTP().getPPr().getRPr().getRtl().getVal());\n                    }\n                } else {\n                    System.out.println(\"para: ltr\");\n                }\n            }\n            for (XWPFRun r : p.getRuns()) {\n                if (r.getCTR().getRPr() != null && r.getCTR().getRPr().getRtl() != null) {\n                    //probably rtl\n                    if (r.getCTR().getRPr().getRtl().getVal() == null) {\n                        System.out.println(\"run: rtl\");\n                    } else {\n                        System.out.println(\"run: \" +r.getCTR().getRPr().getRtl().getVal());\n                    }\n                } else {\n                    System.out.println(\"run: ltr\");\n                }\n            }\n        }", "id": 188373, "time": "2016-02-11T18:08:07Z", "creator": "tallison@mitre.org", "creation_time": "2016-02-11T18:08:07Z", "is_private": false, "attachment_id": null}]