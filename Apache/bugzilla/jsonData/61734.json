[{"count": 0, "tags": [], "bug_id": 61734, "text": "Created attachment 35501\nSource code to create the error\n\nHi,\n\nI am using POI 3.17 final to read an Excel Macro file (xlsm).\nThere is no error during reading of the file.\n\nAfterwards I read some sheets data and write this workbook back to file.\n(there is no error during writing to a file, too.)\n\nThe written file is now corrupt and Excel, start with Version 20007, must repair the file.\n\nMessage: Excel has found unreadable content in file XXX Do you like to repair the Workbook? (Sorry this may be not the original english message, because i use the german Version of Excel). \n\nExcel try to repair this file and remove some Content.\n\nSee attachment for examples. The BugDemo-OUT.xlsm file is corrupt.\n\nsource code to test is attached, too.\n\nThanks in advance for your help.\n\nRegards,\n\nUwe Herrmann", "id": 201966, "time": "2017-11-07T11:51:06Z", "creator": "Uwe.Herrmann@t-systems.com", "creation_time": "2017-11-07T11:51:06Z", "is_private": false, "attachment_id": 35501}, {"count": 1, "tags": [], "bug_id": 61734, "text": "Created attachment 35502\nOriginal Excel - file to create the error\n\nPlease use the source code and this file to create the erroneous file", "id": 201968, "time": "2017-11-07T12:55:33Z", "creator": "Uwe.Herrmann@t-systems.com", "creation_time": "2017-11-07T12:55:33Z", "is_private": false, "attachment_id": 35502}, {"count": 2, "tags": [], "bug_id": 61734, "text": "Created attachment 35503\nThe erroneous Excel file created by original file and source code\n\nThis file will be created by source code and original Excel Macro file", "id": 201969, "time": "2017-11-07T12:57:28Z", "creator": "Uwe.Herrmann@t-systems.com", "creation_time": "2017-11-07T12:57:28Z", "is_private": false, "attachment_id": 35503}, {"count": 3, "tags": [], "bug_id": 61734, "text": "As a workaround, if you're not modifying the Workbook, can you open it in read only more via the OPCPackage class?", "id": 201970, "time": "2017-11-07T16:24:23Z", "creator": "onealj@apache.org", "creation_time": "2017-11-07T16:24:23Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "Uwe.Herrmann@t-systems.com", "attachment_id": null, "text": "Dear Mr. Javen O'Neal,\n\nalas it is not possible for me.\nAs you can see in my appended source code \n(method speichereFormularVorlageDaten) , \ni need this to store an additional custom property in the excel macro file. \n\nOriginally, i use a ByteArrayInputStream to read the file by dint of application Server.\n\nThe problem seems to be the ListObject inside the Excel macro file.\nThis is an extension to a QueryTable - Object since Excel 2007. Since an update of Office, the QueryTable - Object will automatically changed to the ListObject.\nIt is not possible to reverse this automatically change anymore.\n\nUp to now i could not find the cause update.\n\nBest regards\n\nUwe Herrmann", "id": 201975, "time": "2017-11-08T08:07:17Z", "bug_id": 61734, "creation_time": "2017-11-08T08:07:17Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 61734, "is_private": false, "text": "Can you also attach the original file so we can re-run the test-case with it to reproduce the problem?", "id": 202934, "time": "2017-12-27T21:04:33Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2017-12-27T21:04:33Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 61734, "is_private": false, "text": "Dear Dominik Stadler,\n\nyou already find an attached file called BugDemo.xlsm to reproduce the error.\nThe error occurs after you rewrite the file with POI, as you can see by the first attachment. \n\nSee also Attachments Original Excel - file to create the error.\n\nThanks in advance for your help!\n\nRegards \n\nUwe Herrmann", "id": 203040, "time": "2018-01-03T11:32:22Z", "creator": "Uwe.Herrmann@t-systems.com", "creation_time": "2018-01-03T11:32:22Z", "attachment_id": null}]