[{"count": 0, "attachment_id": 27618, "bug_id": 51903, "is_private": false, "id": 149870, "time": "2011-09-28T01:49:12Z", "creator": "rpi_alum@yahoo.com", "creation_time": "2011-09-28T01:49:12Z", "tags": [], "text": "Created attachment 27618\nPatch for issue\n\nSporadic bug with some Word files (unable to submit sample due to sensitive nature of files). \n\nThe LittleEndian.getShort sometimes returns a length of -1, which causes a failure in subsequent getFromUnicodeLE() call.  Added a check for invalid length before proceeding.  Was last entry in my test file and having a null entries array value does not appear to cause any additional errors down-stream.\n\n\nStack Trace (POI version 3.8-beta4)\n\nCaused by: java.lang.IllegalArgumentException: Illegal length -1\n\tat org.apache.poi.util.StringUtil.getFromUnicodeLE(StringUtil.java:73)\n\tat org.apache.poi.hwpf.model.RevisionMarkAuthorTable.<init>(RevisionMarkAuthorTable.java:89)\n\tat org.apache.poi.hwpf.HWPFDocument.<init>(HWPFDocument.java:375)\n\tat org.apache.tika.parser.microsoft.WordExtractor.parse(WordExtractor.java:67)\n\tat org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:196)\n\tat org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)\n\t... 45 more"}, {"count": 1, "tags": [], "text": "I applied patch to SttbUtils and rewrite RevisionMarkAuthorTable to use it. Please, check with r1177644 or later.", "attachment_id": null, "id": 149976, "creator": "vlsergey@gmail.com", "time": "2011-09-30T13:20:02Z", "bug_id": 51903, "creation_time": "2011-09-30T13:20:02Z", "is_private": false}, {"count": 2, "attachment_id": null, "bug_id": 51903, "is_private": false, "id": 150095, "time": "2011-10-03T19:21:41Z", "creator": "rpi_alum@yahoo.com", "creation_time": "2011-10-03T19:21:41Z", "tags": [], "text": "That appears to have fixed it!!  I'll mark the Bug as resolved.  Thanks very much for your attention to this.\n\n\n\n(In reply to comment #1)\n> I applied patch to SttbUtils and rewrite RevisionMarkAuthorTable to use it.\n> Please, check with r1177644 or later."}]