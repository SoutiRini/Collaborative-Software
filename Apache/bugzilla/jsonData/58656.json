[{"count": 0, "tags": [], "bug_id": 58656, "text": "Created attachment 33300\nMS word file that raises an AIOOBE (poi v3.13-FINAL)\n\nHi, \n\nWe are trying to parse a number of MS Word documents using Tika v1.11 (POI v.3.13-FINAL), however an AIOOBE is raised when trying to parse the document attached. Even if the file is corrupted, shouldn't we get a different exception other than an \"Unexpected RuntimeException\" \n\nCould you please have a look at this?\n\nThanks,\nPanagiotis  \n\n\nStacktrace:\nCause: Unexpected RuntimeException from org.apache.tika.parser.microsoft.OfficeParser@6ebda34c\n  Cause: 128\nCaused by: java.lang.ArrayIndexOutOfBoundsException: 128\n        at org.apache.poi.util.LittleEndian.getShort(LittleEndian.java:224)\n        at org.apache.poi.util.ShortField.readFromBytes(ShortField.java:166)\n        at org.apache.poi.util.ShortField.<init>(ShortField.java:91)\n        at org.apache.poi.poifs.property.Property.<init>(Property.java:165)\n        at org.apache.poi.poifs.property.DirectoryProperty.<init>(DirectoryProperty.java:69)\n        at org.apache.poi.poifs.property.PropertyFactory.convertToProperties(PropertyFactory.java:79)\n        at org.apache.poi.poifs.property.NPropertyTable.buildProperties(NPropertyTable.java:110)\n        at org.apache.poi.poifs.property.NPropertyTable.<init>(NPropertyTable.java:66)\n        at org.apache.poi.poifs.filesystem.NPOIFSFileSystem.readCoreContents(NPOIFSFileSystem.java:416)\n        at org.apache.poi.poifs.filesystem.NPOIFSFileSystem.<init>(NPOIFSFileSystem.java:228)\n        at org.apache.poi.poifs.filesystem.NPOIFSFileSystem.<init>(NPOIFSFileSystem.java:164)\n        at org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:164)\n        at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:281)", "id": 186577, "time": "2015-11-26T15:02:45Z", "creator": "pmpailis@atypon.com", "creation_time": "2015-11-26T15:02:45Z", "is_private": false, "attachment_id": 33300}, {"count": 1, "tags": [], "bug_id": 58656, "attachment_id": null, "text": "Upon a quick look it looks like the data that we read tries to read a huge property-string where the actual byte-array with data is much smaller, so based on that it looks like the document is really incorrectly formatted. It also does not look too good when opened in LibreOffice, lots of giverish and no readable content as far as I can see.\n\nSo for now we only can try to improve the error message here with an additional check.", "id": 186825, "time": "2015-12-06T23:16:41Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-12-06T23:16:41Z", "is_private": false}]