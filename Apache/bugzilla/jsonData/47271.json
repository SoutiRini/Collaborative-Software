[{"count": 0, "tags": [], "creator": "adb@teamware.com", "attachment_id": null, "id": 127435, "time": "2009-05-27T00:34:12Z", "bug_id": 47271, "creation_time": "2009-05-27T00:34:12Z", "is_private": false, "text": "I have a document that gets stuck in createChp().  Debugging it reveals that in createChp() the baseIndex is the same as the input param, istd and the parentCHP is null, hence it loops approx 1021 times before it gives stack overflow.\n\nIs the solution \n\n       if(baseIndex != NIL_STYLE)\n       {\n           parentCHP = _styleDescriptions[baseIndex].getCHP();\n           if(parentCHP == null && baseIndex != istd)\n           {\n               createChp(baseIndex);\n               parentCHP = _styleDescriptions[baseIndex].getCHP();\n           }\n       }"}, {"count": 1, "tags": [], "creator": "adb@teamware.com", "attachment_id": null, "id": 127436, "time": "2009-05-27T00:58:34Z", "bug_id": 47271, "creation_time": "2009-05-27T00:58:34Z", "is_private": false, "text": "Of course it's not that solution... parentCHP cannot be null.\n\nThe offending StyleDescription is \"Footnote Reference\" and has the following attributes in the debugger.\n\n_baseLength = 10\n_bchUpe = 52\n_chp = null\n_infoShort = 38\n_infoShort2 = 370\n_infoShort3 = 369\n_infoShort4 = 0\n_istd = 0\nname = \"Footnote Reference\"\n_pap = null\n_upxs = IPX[1]\n\nAny ideas on how to fix this?"}, {"count": 2, "tags": [], "bug_id": 47271, "attachment_id": null, "text": "I would much rather have it throw an exception, so I can handle it, instead of recurse until it crashes the thread.", "id": 130066, "time": "2009-08-31T06:18:50Z", "creator": "wfreeman.at.nasa@gmail.com", "creation_time": "2009-08-31T06:18:50Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 47271, "attachment_id": null, "text": "Adding baseIndex != istd (as Antony mentioned) stops the infinite recursion. It throws a null exception later in uncompressCHP, since parentCHP is null, which is easier to handle--even though it doesn't successfully extract the text. \n\nI added this, which made it work for my purposes (text extraction only):\n          if(baseIndex != NIL_STYLE)\n          {\n\n              parentCHP = _styleDescriptions[baseIndex].getCHP();\n              if(parentCHP == null && baseIndex != istd)\n              {\n                  createChp(baseIndex);\n                  parentCHP = _styleDescriptions[baseIndex].getCHP();\n              }\n\n          }\n          if(parentCHP != null)\n          {\n             chp = (CharacterProperties)CharacterSprmUncompressor.uncompressCHP(parentCHP, chpx, 0);\n          }\n\nThanks for the useful library, by the way.", "id": 130070, "time": "2009-08-31T08:17:46Z", "creator": "wfreeman.at.nasa@gmail.com", "creation_time": "2009-08-31T08:17:46Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 47271, "attachment_id": null, "text": "Can someone please give me an update on this?  We get this problem in POI 3.6 and 3.7 on Linux and are are keen to understand if it is scheduled to be fixed in a particular release?\n\nThanks\n\n- Chris", "id": 138812, "time": "2010-08-02T06:42:11Z", "creator": "cbamford@mimecast.com", "creation_time": "2010-08-02T06:42:11Z", "is_private": false}, {"count": 5, "attachment_id": null, "creator": "apache@gagravarr.org", "text": "We need someone to figure out if the problem is caused by a bug in our chp decoding, or if it's correctly decoded by just not something we currently support.\n\nOnce we know that, we can decide if the suggested fix is OK to apply, or if we need to revist the chp decoding code to avoid getting into this situation in the first place\n\nHWPF currently lacks a pointman, so if this matters to you, please do investigate and report back!", "id": 138848, "time": "2010-08-03T12:21:17Z", "bug_id": 47271, "creation_time": "2010-08-03T12:21:17Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "bug_id": 47271, "attachment_id": null, "text": "From what I remember after looking at this issue, it is actually caused by a bad word document. The parent of the style was the same as the style, or something, so it would keep recursing into the child/parent style until it got an overflow. \n\nI have no idea how the word documents that gave us issues got into that state--I was going through and extracting text from thousands of documents and this error only happened on a handful (<20 out of 10k). The main issue for me was that it caused my entire web app to crash because of the recursion, so my quick fix resolved that and it's been working fine since.\n\nWes", "id": 139882, "time": "2010-09-15T12:48:03Z", "creator": "wfreeman.at.nasa@gmail.com", "creation_time": "2010-09-15T12:48:03Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 47271, "attachment_id": null, "text": "I think I've added a fix in r998625 that will hopefully switch the broken styles to be standalone.\n\nHowever, as no-one has uploaded a sample broken file, I can't be sure :/\n\nIf the problem still remains with the fix, please re-open the bug & upload a file for us to test against!", "id": 139953, "time": "2010-09-19T06:18:25Z", "creator": "apache@gagravarr.org", "creation_time": "2010-09-19T06:18:25Z", "is_private": false}]