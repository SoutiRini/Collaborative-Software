[{"count": 0, "tags": [], "creator": "mrogghe@blazent.com", "attachment_id": 27741, "text": "Created attachment 27741\nJava class and workbook to re-create error\n\nPOI-3.8-beta4.\nXSSF usermodel using SS usermodel interfaces.\n\nOriginal motivation is to clear the contents of worksheets and then repopulate the worksheet with other data.\n\n1.  After some other experiments, method I opted for was to delete the sheet and then recreate it (same name and same index).  This resulted in POI errors indicating the sheet index it was trying to use was out of range.  Stack trace:\nException in thread \"main\" java.lang.IllegalArgumentException: Sheet index (-1) is out of range (0..8)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.validateSheetIndex(XSSFWorkbook.java:945)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.getSheetName(XSSFWorkbook.java:792)\n\tat org.apache.poi.xssf.usermodel.XSSFEvaluationWorkbook.getSheetNameByExternSheet(XSSFEvaluationWorkbook.java:137)\n\tat org.apache.poi.xssf.usermodel.helpers.XSSFFormulaUtils$1.getSheetNameByExternSheet(XSSFFormulaUtils.java:81)\n\tat org.apache.poi.ss.formula.ptg.ExternSheetNameResolver.prependSheetName(ExternSheetNameResolver.java:42)\n\tat org.apache.poi.ss.formula.ptg.Ref3DPtg.toFormulaString(Ref3DPtg.java:91)\n\tat org.apache.poi.ss.formula.FormulaRenderer.toFormulaString(FormulaRenderer.java:92)\n\tat org.apache.poi.xssf.usermodel.helpers.XSSFFormulaUtils.updateFormula(XSSFFormulaUtils.java:126)\n\tat org.apache.poi.xssf.usermodel.helpers.XSSFFormulaUtils.updateSheetName(XSSFFormulaUtils.java:106)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.setSheetName(XSSFWorkbook.java:1177)\n\tat TestCreateSheet.main(TestCreateSheet.java:33)\n\nWorkaround:  At first I was using Workbook.createSheet() without passing a sheet name argument to it to create my new sheets.  When I switched that to the form passing in a sheet name this method works.  I recreated this error with the attached code and by creating a workbook with formulas that span sheets and are linked.  Sheet2 has a formula that depends on a formula from Sheet7 which in turn depends on a value on Sheet8.  This error did not occur when I had the same linked formula situation but on consecutive sheets (Sheet1 to Sheet2 to Sheet3).  This seems to be similar to Bug 46028.", "id": 150366, "time": "2011-10-08T19:55:34Z", "bug_id": 51998, "creation_time": "2011-10-08T19:55:34Z", "is_private": false}, {"count": 1, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "is_private": false, "id": 185535, "time": "2015-09-29T13:10:51Z", "bug_id": 51998, "creation_time": "2015-09-29T13:10:51Z", "text": "I verified that this works in the latest version of POI (3.13), it likely was fixed as part of other fixes. A unit test showing that it works now is added via r1705855."}]