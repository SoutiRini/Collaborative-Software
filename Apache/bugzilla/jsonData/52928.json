[{"count": 0, "tags": [], "bug_id": 52928, "attachment_id": null, "id": 154978, "time": "2012-03-16T11:45:49Z", "creator": "jim-apache@spudsoft.co.uk", "creation_time": "2012-03-16T11:45:49Z", "is_private": false, "text": "I need to convert java DateFormat patterns into Excel custom number formats.\nThis issue exists si that I can contribute what I end up with back to POI."}, {"count": 1, "tags": [], "bug_id": 52928, "attachment_id": 28479, "text": "Created attachment 28479\nExample Excel document generated from the proposed code\n\nThis is a zip file containing a number of Excel files each of which demonstrates a particular Date/Time format for all available locales for the Sun Windows JVM.", "id": 154981, "time": "2012-03-16T12:14:00Z", "creator": "jim-apache@spudsoft.co.uk", "creation_time": "2012-03-16T12:14:00Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 52928, "attachment_id": 28480, "is_private": false, "id": 154982, "time": "2012-03-16T12:15:33Z", "creator": "jim-apache@spudsoft.co.uk", "creation_time": "2012-03-16T12:15:33Z", "text": "Created attachment 28480\nClass file to convert from Java DateFormat to Excel custom number format"}, {"count": 3, "tags": [], "bug_id": 52928, "attachment_id": null, "text": "Very cool, applied in r1301923 with some tweaks, junit included.\n\nThe testing is tricky. We should not rely on our eyes , you simply don't see  all the discrepancies if you don't know the locale language. \n\nTo simplify testing I added two more columns: column D is the value returned by java.text.DateFormat and column E is a formula that returns TRUE if Excel formatted value in column C equals to its Java counterpart in column D.\n\nThe formula looks as follows:\nTEXT(C6,G6)=D6\n\nwhere C6 is date, not matter how it is formatted, excel takes the raw double value.\nG6 is the format applied to the cell style, e.g. [$-41C]yyyy-MM-dd;@\nand D6 is a string calculated in Java.\n\nWe expect that Excel and Java format equally and the formula in all rows will return TRUE. Unfortunately it is not so, but it is not a bug, rather MS Office and Java format locales slightly differently.  See attached example, not matched rows are marked in red. \n\nFor the future, please consider enhancing this utility to support bi-directional conversion:\n1. from java.text.DateFormat to Excel date pattern\nand the other way around\n2. from excel date pattern to java.text.DateFormat\n\nThe second option is important to properly format excel date cell as a string. \n\nRegards,\nYegor", "id": 154998, "time": "2012-03-17T12:39:35Z", "creator": "yegor@dinom.ru", "creation_time": "2012-03-17T12:39:35Z", "is_private": false}, {"count": 4, "tags": [], "creator": "yegor@dinom.ru", "text": "Created attachment 28483\nsample output with highlited diffs", "id": 154999, "time": "2012-03-17T13:03:55Z", "bug_id": 52928, "creation_time": "2012-03-17T13:03:55Z", "is_private": false, "attachment_id": 28483}]