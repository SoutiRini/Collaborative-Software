[{"count": 0, "tags": [], "bug_id": 8692, "text": "This patch makes the following changes in org.apache.poi.hpsf:\n\n1) Adds a new class Thumbnail.java to allow manipulation of \n   thumbnail images in Summary Information.\n2) Adds some Javadoc comments to Variant.VT_CF to describe the \n   Clipboard Format Variant\n3) Removes the UnsupportedOperationException from\n   SummaryInformation.getThumbnail()\n4) Modifies Propery.java to allow it to properly handle VT_CF variants\n5) Fixes the bad patch I submitted to remove the NCSA references. I didn't diff\n   with the -u option last time, my bad.\n\nThe new file Thumbnail.java will be attached in a .zip.\n\n- Drew\n*****CVS exited normally with code 1*****\n\n? Thumbnail.java\ncvs server: Diffing .\nIndex: DocumentSummaryInformation.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-\npoi/src/java/org/apache/poi/hpsf/DocumentSummaryInformation.java,v\nretrieving revision 1.2\ndiff -u -r1.2 DocumentSummaryInformation.java\n--- DocumentSummaryInformation.java\t30 Apr 2002 03:51:02 -0000\t1.2\n+++ DocumentSummaryInformation.java\t1 May 2002 06:10:40 -0000\n@@ -50,14 +50,6 @@\n  * individuals on behalf of the Apache Software Foundation.  For more\n  * information on the Apache Software Foundation, please see\n  * <http://www.apache.org/>.\n-*\n-* Portions of this software are based upon public domain software\n-* originally written at the National Center for Supercomputing Applications,\n-* University of Illinois, Urbana-Champaign.\n- *\n- * Portions of this software are based upon public domain software\n- * originally written at the National Center for Supercomputing Applications,\n- * University of Illinois, Urbana-Champaign.\n  */\n \n package org.apache.poi.hpsf;\nIndex: HPSFException.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-\npoi/src/java/org/apache/poi/hpsf/HPSFException.java,v\nretrieving revision 1.2\ndiff -u -r1.2 HPSFException.java\n--- HPSFException.java\t30 Apr 2002 03:51:02 -0000\t1.2\n+++ HPSFException.java\t1 May 2002 06:10:40 -0000\n@@ -50,14 +50,6 @@\n  * individuals on behalf of the Apache Software Foundation.  For more\n  * information on the Apache Software Foundation, please see\n  * <http://www.apache.org/>.\n-*\n-* Portions of this software are based upon public domain software\n-* originally written at the National Center for Supercomputing Applications,\n-* University of Illinois, Urbana-Champaign.\n- *\n- * Portions of this software are based upon public domain software\n- * originally written at the National Center for Supercomputing Applications,\n- * University of Illinois, Urbana-Champaign.\n  */\n \n package org.apache.poi.hpsf;\nIndex: HPSFRuntimeException.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-\npoi/src/java/org/apache/poi/hpsf/HPSFRuntimeException.java,v\nretrieving revision 1.2\ndiff -u -r1.2 HPSFRuntimeException.java\n--- HPSFRuntimeException.java\t30 Apr 2002 03:51:02 -0000\t1.2\n+++ HPSFRuntimeException.java\t1 May 2002 06:10:40 -0000\n@@ -50,14 +50,6 @@\n  * individuals on behalf of the Apache Software Foundation.  For more\n  * information on the Apache Software Foundation, please see\n  * <http://www.apache.org/>.\n-*\n-* Portions of this software are based upon public domain software\n-* originally written at the National Center for Supercomputing Applications,\n-* University of Illinois, Urbana-Champaign.\n- *\n- * Portions of this software are based upon public domain software\n- * originally written at the National Center for Supercomputing Applications,\n- * University of Illinois, Urbana-Champaign.\n  */\n \n package org.apache.poi.hpsf;\nIndex: MarkUnsupportedException.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-\npoi/src/java/org/apache/poi/hpsf/MarkUnsupportedException.java,v\nretrieving revision 1.2\ndiff -u -r1.2 MarkUnsupportedException.java\n--- MarkUnsupportedException.java\t30 Apr 2002 03:51:02 -0000\t1.2\n+++ MarkUnsupportedException.java\t1 May 2002 06:10:40 -0000\n@@ -50,14 +50,6 @@\n  * individuals on behalf of the Apache Software Foundation.  For more\n  * information on the Apache Software Foundation, please see\n  * <http://www.apache.org/>.\n-*\n-* Portions of this software are based upon public domain software\n-* originally written at the National Center for Supercomputing Applications,\n-* University of Illinois, Urbana-Champaign.\n- *\n- * Portions of this software are based upon public domain software\n- * originally written at the National Center for Supercomputing Applications,\n- * University of Illinois, Urbana-Champaign.\n  */\n \n package org.apache.poi.hpsf;\nIndex: NoPropertySetStreamException.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-\npoi/src/java/org/apache/poi/hpsf/NoPropertySetStreamException.java,v\nretrieving revision 1.2\ndiff -u -r1.2 NoPropertySetStreamException.java\n--- NoPropertySetStreamException.java\t30 Apr 2002 03:51:02 -0000\t1.2\n+++ NoPropertySetStreamException.java\t1 May 2002 06:10:40 -0000\n@@ -50,14 +50,6 @@\n  * individuals on behalf of the Apache Software Foundation.  For more\n  * information on the Apache Software Foundation, please see\n  * <http://www.apache.org/>.\n-*\n-* Portions of this software are based upon public domain software\n-* originally written at the National Center for Supercomputing Applications,\n-* University of Illinois, Urbana-Champaign.\n- *\n- * Portions of this software are based upon public domain software\n- * originally written at the National Center for Supercomputing Applications,\n- * University of Illinois, Urbana-Champaign.\n  */\n \n package org.apache.poi.hpsf;\nIndex: NoSingleSectionException.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-\npoi/src/java/org/apache/poi/hpsf/NoSingleSectionException.java,v\nretrieving revision 1.2\ndiff -u -r1.2 NoSingleSectionException.java\n--- NoSingleSectionException.java\t30 Apr 2002 03:51:02 -0000\t1.2\n+++ NoSingleSectionException.java\t1 May 2002 06:10:41 -0000\n@@ -50,14 +50,6 @@\n  * individuals on behalf of the Apache Software Foundation.  For more\n  * information on the Apache Software Foundation, please see\n  * <http://www.apache.org/>.\n-*\n-* Portions of this software are based upon public domain software\n-* originally written at the National Center for Supercomputing Applications,\n-* University of Illinois, Urbana-Champaign.\n- *\n- * Portions of this software are based upon public domain software\n- * originally written at the National Center for Supercomputing Applications,\n- * University of Illinois, Urbana-Champaign.\n  */\n \n package org.apache.poi.hpsf;\n\nIndex: Property.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-\npoi/src/java/org/apache/poi/hpsf/Property.java,v\nretrieving revision 1.2\ndiff -u -r1.2 Property.java\n--- Property.java\t30 Apr 2002 03:51:02 -0000\t1.2\n+++ Property.java\t1 May 2002 06:10:41 -0000\n@@ -89,6 +89,7 @@\n  * @see Variant\n  *\n  * @author Rainer Klute (klute@rainer-klute.de)\n+ * @author Drew Varner (Drew.Varner InAndAround sc.edu)\n  * @version $Id: Property.java,v 1.2 2002/04/30 03:51:02 acoliver Exp $\n  * @since 2002-02-09\n  */\n@@ -202,6 +203,23 @@\n                 while (src[last] == 0 && first <= last)\n                     last--;\n                 value = new String(src, first, last - first + 1);\n+                break;\n+            }\n+            case Variant.VT_CF:\n+            {\n+                // the first four bytes in src, from\n+                // src[offset] to src[offset + 3] contain\n+                // the DWord for VT_CF, so skip it, we don't\n+                // need it\n+\n+                // truncate the length of the return array by\n+                // a DWord length (4 bytes)\n+                length = length - DWord.LENGTH;\n+\n+                final byte[] v = new byte[length];\n+                for (int i = 0; i < length; i++)\n+                    v[i] = src[offset + i + DWord.LENGTH];\n+                value = v;\n                 break;\n             }\n             default:\nIndex: PropertySet.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-\npoi/src/java/org/apache/poi/hpsf/PropertySet.java,v\nretrieving revision 1.2\ndiff -u -r1.2 PropertySet.java\n--- PropertySet.java\t30 Apr 2002 03:51:02 -0000\t1.2\n+++ PropertySet.java\t1 May 2002 06:10:42 -0000\n@@ -50,14 +50,6 @@\n  * individuals on behalf of the Apache Software Foundation.  For more\n  * information on the Apache Software Foundation, please see\n  * <http://www.apache.org/>.\n-*\n-* Portions of this software are based upon public domain software\n-* originally written at the National Center for Supercomputing Applications,\n-* University of Illinois, Urbana-Champaign.\n- *\n- * Portions of this software are based upon public domain software\n- * originally written at the National Center for Supercomputing Applications,\n- * University of Illinois, Urbana-Champaign.\n  */\n \n package org.apache.poi.hpsf;\n@@ -385,7 +377,7 @@\n         offset += ClassID.LENGTH;\n         sectionCount = new DWord(src, offset).intValue();\n         offset += DWord.LENGTH;\n-        \n+\n         /* Read the sections, which are following the header. They\n          * start with an array of section descriptions. Each one\n          * consists of a format ID telling what the section contains\nIndex: PropertySetFactory.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-\npoi/src/java/org/apache/poi/hpsf/PropertySetFactory.java,v\nretrieving revision 1.2\ndiff -u -r1.2 PropertySetFactory.java\n--- PropertySetFactory.java\t30 Apr 2002 03:51:02 -0000\t1.2\n+++ PropertySetFactory.java\t1 May 2002 06:10:43 -0000\n@@ -50,14 +50,6 @@\n  * individuals on behalf of the Apache Software Foundation.  For more\n  * information on the Apache Software Foundation, please see\n  * <http://www.apache.org/>.\n-*\n-* Portions of this software are based upon public domain software\n-* originally written at the National Center for Supercomputing Applications,\n-* University of Illinois, Urbana-Champaign.\n- *\n- * Portions of this software are based upon public domain software\n- * originally written at the National Center for Supercomputing Applications,\n- * University of Illinois, Urbana-Champaign.\n  */\n \n package org.apache.poi.hpsf;\nIndex: Section.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-\npoi/src/java/org/apache/poi/hpsf/Section.java,v\nretrieving revision 1.2\ndiff -u -r1.2 Section.java\n--- Section.java\t30 Apr 2002 03:51:02 -0000\t1.2\n+++ Section.java\t1 May 2002 06:10:43 -0000\n@@ -50,14 +50,6 @@\n  * individuals on behalf of the Apache Software Foundation.  For more\n  * information on the Apache Software Foundation, please see\n  * <http://www.apache.org/>.\n-*\n-* Portions of this software are based upon public domain software\n-* originally written at the National Center for Supercomputing Applications,\n-* University of Illinois, Urbana-Champaign.\n- *\n- * Portions of this software are based upon public domain software\n- * originally written at the National Center for Supercomputing Applications,\n- * University of Illinois, Urbana-Champaign.\n  */\n \n package org.apache.poi.hpsf;\nIndex: SpecialPropertySet.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-\npoi/src/java/org/apache/poi/hpsf/SpecialPropertySet.java,v\nretrieving revision 1.2\ndiff -u -r1.2 SpecialPropertySet.java\n--- SpecialPropertySet.java\t30 Apr 2002 03:51:02 -0000\t1.2\n+++ SpecialPropertySet.java\t1 May 2002 06:10:44 -0000\n@@ -50,14 +50,6 @@\n  * individuals on behalf of the Apache Software Foundation.  For more\n  * information on the Apache Software Foundation, please see\n  * <http://www.apache.org/>.\n-*\n-* Portions of this software are based upon public domain software\n-* originally written at the National Center for Supercomputing Applications,\n-* University of Illinois, Urbana-Champaign.\n- *\n- * Portions of this software are based upon public domain software\n- * originally written at the National Center for Supercomputing Applications,\n- * University of Illinois, Urbana-Champaign.\n  */\n \n package org.apache.poi.hpsf;\nIndex: SummaryInformation.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-\npoi/src/java/org/apache/poi/hpsf/SummaryInformation.java,v\nretrieving revision 1.5\ndiff -u -r1.5 SummaryInformation.java\n--- SummaryInformation.java\t28 Apr 2002 06:39:55 -0000\t1.5\n+++ SummaryInformation.java\t1 May 2002 06:10:44 -0000\n@@ -276,8 +276,6 @@\n      */\n     public byte[] getThumbnail()\n     {\n-        if (true)\n-            throw new UnsupportedOperationException(\"FIXME\");\n         return (byte[]) getProperty(PropertyIDMap.PID_THUMBNAIL);\n     }\n \nIndex: UnexpectedPropertySetTypeException.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-\npoi/src/java/org/apache/poi/hpsf/UnexpectedPropertySetTypeException.java,v\nretrieving revision 1.2\ndiff -u -r1.2 UnexpectedPropertySetTypeException.java\n--- UnexpectedPropertySetTypeException.java\t30 Apr 2002 03:51:02 -0000\n\t1.2\n+++ UnexpectedPropertySetTypeException.java\t1 May 2002 06:10:45 -0000\n@@ -50,14 +50,6 @@\n  * individuals on behalf of the Apache Software Foundation.  For more\n  * information on the Apache Software Foundation, please see\n  * <http://www.apache.org/>.\n-*\n-* Portions of this software are based upon public domain software\n-* originally written at the National Center for Supercomputing Applications,\n-* University of Illinois, Urbana-Champaign.\n- *\n- * Portions of this software are based upon public domain software\n- * originally written at the National Center for Supercomputing Applications,\n- * University of Illinois, Urbana-Champaign.\n  */\n \n package org.apache.poi.hpsf;\nIndex: Util.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-poi/src/java/org/apache/poi/hpsf/Util.java,v\nretrieving revision 1.2\ndiff -u -r1.2 Util.java\n--- Util.java\t30 Apr 2002 03:51:02 -0000\t1.2\n+++ Util.java\t1 May 2002 06:10:45 -0000\n@@ -50,14 +50,6 @@\n  * individuals on behalf of the Apache Software Foundation.  For more\n  * information on the Apache Software Foundation, please see\n  * <http://www.apache.org/>.\n-*\n-* Portions of this software are based upon public domain software\n-* originally written at the National Center for Supercomputing Applications,\n-* University of Illinois, Urbana-Champaign.\n- *\n- * Portions of this software are based upon public domain software\n- * originally written at the National Center for Supercomputing Applications,\n- * University of Illinois, Urbana-Champaign.\n  */\n \n package org.apache.poi.hpsf;\nIndex: Variant.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-\npoi/src/java/org/apache/poi/hpsf/Variant.java,v\nretrieving revision 1.2\ndiff -u -r1.2 Variant.java\n--- Variant.java\t30 Apr 2002 03:51:02 -0000\t1.2\n+++ Variant.java\t1 May 2002 06:10:46 -0000\n@@ -50,14 +50,6 @@\n  * individuals on behalf of the Apache Software Foundation.  For more\n  * information on the Apache Software Foundation, please see\n  * <http://www.apache.org/>.\n-*\n-* Portions of this software are based upon public domain software\n-* originally written at the National Center for Supercomputing Applications,\n-* University of Illinois, Urbana-Champaign.\n- *\n- * Portions of this software are based upon public domain software\n- * originally written at the National Center for Supercomputing Applications,\n- * University of Illinois, Urbana-Champaign.\n  */\n \n package org.apache.poi.hpsf;\n@@ -307,9 +299,34 @@\n     public final static int VT_CF = 71;\n \n     /**\n-     * <p>[P] A Class ID. <span style=\"background-color:\n-     * #ffff00\">How long is this? How is it to be\n-     * interpreted?</span></p>\n+     * <p>[P] A Class ID.</p>\n+     * <p>It consists of a 32 bit unsigned integer indicating the size\n+     * of the structure, a 32 bit signed integer indicating (Clipboard\n+     * Format Tag) indicating the type of data that it contains, and\n+     * then a byte array containing the data.</p>\n+     *\n+     * <p>The valid Clipboard Format Tags are:\n+     * <ul>\n+     *     <li>{@link Thumbnail#CFTAG_WINDOWS}</li>\n+     *     <li>{@link Thumbnail#CFTAG_MACINTOSH}</li>\n+     *     <li>{@link Thumbnail#CFTAG_NODATA}</li>\n+     *     <li>{@link Thumbnail#CFTAG_FMTID}</li>\n+     * </ul></p>\n+     *\n+     * <p>\n+     * <pre>typedef struct  tagCLIPDATA {\n+     * // cbSize is the size of the buffer pointed to\n+     * // by pClipData, plus sizeof(ulClipFmt)\n+     * ULONG              cbSize;\n+     * long               ulClipFmt;\n+     * BYTE*              pClipData;\n+     * } CLIPDATA;</pre>\n+     * See\n+     * <a href=\"msdn.microsoft.com/library/en-us/com/stgrstrc_0uwk.asp\"\n+     *    target=\"_blank\">\n+     *   msdn.microsoft.com/library/en-us/com/stgrstrc_0uwk.asp\n+     * </a>\n+     * </p>\n      */\n     public final static int VT_CLSID = 72;\n \ncvs server: Diffing littleendian\ncvs server: Diffing wellknown\nIndex: wellknown/PropertyIDMap.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-\npoi/src/java/org/apache/poi/hpsf/wellknown/PropertyIDMap.java,v\nretrieving revision 1.2\ndiff -u -r1.2 PropertyIDMap.java\n--- wellknown/PropertyIDMap.java\t30 Apr 2002 03:51:03 -0000\t1.2\n+++ wellknown/PropertyIDMap.java\t1 May 2002 06:10:46 -0000\n@@ -50,14 +50,6 @@\n  * individuals on behalf of the Apache Software Foundation.  For more\n  * information on the Apache Software Foundation, please see\n  * <http://www.apache.org/>.\n-*\n-* Portions of this software are based upon public domain software\n-* originally written at the National Center for Supercomputing Applications,\n-* University of Illinois, Urbana-Champaign.\n- *\n- * Portions of this software are based upon public domain software\n- * originally written at the National Center for Supercomputing Applications,\n- * University of Illinois, Urbana-Champaign.\n  */\n \n package org.apache.poi.hpsf.wellknown;\n\nIndex: wellknown/SectionIDMap.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-\npoi/src/java/org/apache/poi/hpsf/wellknown/SectionIDMap.java,v\nretrieving revision 1.2\ndiff -u -r1.2 SectionIDMap.java\n--- wellknown/SectionIDMap.java\t30 Apr 2002 03:51:03 -0000\t1.2\n+++ wellknown/SectionIDMap.java\t1 May 2002 06:10:47 -0000\n@@ -50,14 +50,6 @@\n  * individuals on behalf of the Apache Software Foundation.  For more\n  * information on the Apache Software Foundation, please see\n  * <http://www.apache.org/>.\n-*\n-* Portions of this software are based upon public domain software\n-* originally written at the National Center for Supercomputing Applications,\n-* University of Illinois, Urbana-Champaign.\n- *\n- * Portions of this software are based upon public domain software\n- * originally written at the National Center for Supercomputing Applications,\n- * University of Illinois, Urbana-Champaign.\n  */\n \n package org.apache.poi.hpsf.wellknown;", "id": 15222, "time": "2002-05-01T06:23:37Z", "creator": "drew.varner@sc.edu", "creation_time": "2002-05-01T06:23:37Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 8692, "attachment_id": 1748, "text": "Created attachment 1748\nThe file Thumbnail.java, part of the patch", "id": 15223, "time": "2002-05-01T06:24:12Z", "creator": "drew.varner@sc.edu", "creation_time": "2002-05-01T06:24:12Z", "is_private": false}, {"count": 2, "attachment_id": null, "creator": "poi-support@buni.org", "is_private": false, "id": 15236, "time": "2002-05-01T12:17:32Z", "bug_id": 8692, "creation_time": "2002-05-01T12:17:32Z", "tags": [], "text": "Hi Drew, can you *attach* the patch part.  Its difficult to get valid patches by\ncut and paste.  Furthermore, can you diff -u again?  I've already applied your\nNCSA removal patch."}, {"count": 3, "tags": [], "bug_id": 8692, "text": "Actually Andy, the patch I gave you last time made things worse. I didn't use \nthe -u option on diff, so it added the notice about NCSA public domain software \na second time in the license comments. *oops*. Rainer has already applied my \npatch, closing this Bug.", "id": 15240, "time": "2002-05-01T14:19:50Z", "creator": "drew.varner@sc.edu", "creation_time": "2002-05-01T14:19:50Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 8692, "attachment_id": null, "id": 15242, "time": "2002-05-01T14:32:58Z", "creator": "poi-support@buni.org", "creation_time": "2002-05-01T14:32:58Z", "is_private": false, "text": "ouch.  sorry about that.  hehe... I guess we need unit tests for the comments ;-)"}]