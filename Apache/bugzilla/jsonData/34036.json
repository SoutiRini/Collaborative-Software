[{"attachment_id": null, "tags": [], "creator": "nags@bsg.co.uk", "text": "I am using the following environment:\n\n- IIS6 as the Webserver running on Windows 2003 server\n- isapi_redirect-1.2.8.dll as the binary\n\n\nI have the following settings in my uriworkermap.properties\nfile.\n\n/examples/*=worker1\n/developer/*=worker2\n/*=worker1\n\nWhat I had hoped to achieve was the following:\n\n- all requests that have a /examples in them are served by worker1\n- all requests that have a /developer in them are served by worker2\n- everything else is served by worker1.\n\nI have also tried this combination:\n\n/developer/*=worker2\n/*=worker1\n\n\nworker1 and worker 2 represent Tomcat 5.0.28 instances running on \nseparate machines.\n\n\nWhen I try this combination in the properties file the '/*' mapping\noverwrites everything else and no request reaches worker2.\n\nThe same was possible in the older JK2  connector. Because it is\nnow deprecated,we are moving to this version of JK and seem to have\nhit this problem.\n\nIs there a way around for this?\n\nMany thanks and Best Regards,\nNags.", "count": 0, "id": 72491, "time": "2005-03-16T15:56:08Z", "bug_id": 34036, "creation_time": "2005-03-16T15:56:08Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "cssmith4@yahoo.com", "text": "Nags,\nI also have issue using JK Connector 1.2.8 on Windows Server 2003 and Tomcat \n5.0.28 and JVM1.4.2_06.  \n\nIIS appears to redirect correctly from IIS Log Files.  This is not the case \nwith the JK Log Files.  I have attached a logical portion of the JK log files.\n\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] init_jk::jk_isapi_plugin.c \n(1040): Using registry.\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] init_jk::jk_isapi_plugin.c \n(1043): Using log file E:\\Program Files\\Apache Software Foundation\\Jakarta \nIsapi Redirector\\log\\isapi_redirect.log.\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] init_jk::jk_isapi_plugin.c \n(1044): Using log level 1.\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] init_jk::jk_isapi_plugin.c \n(1045): Using extension uri /jakarta/isapi_redirect.dll.\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] init_jk::jk_isapi_plugin.c \n(1046): Using worker file E:\\Program Files\\Apache Software Foundation\\Jakarta \nIsapi Redirector\\conf\\workers.properties.\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] init_jk::jk_isapi_plugin.c \n(1047): Using worker mount file E:\\Program Files\\Apache Software \nFoundation\\Jakarta Isapi Redirector\\conf\\uriworkermap.properties.\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] init_jk::jk_isapi_plugin.c \n(1049): Using uri select 0.\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] \nuri_worker_map_open::jk_uri_worker_map.c (461): rule map size is 5\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] \nuri_worker_map_add::jk_uri_worker_map.c (382): match rule /servlets-\nexamples/=ajp13w was added\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] \nuri_worker_map_add::jk_uri_worker_map.c (382): match rule /jsp-\nexamples/=ajp13w1 was added\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] \nuri_worker_map_add::jk_uri_worker_map.c (382): match rule /icf/=ajp13w2 was \nadded\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] \nuri_worker_map_add::jk_uri_worker_map.c (360): suffix rule /servlets-\nexamples/.jpeg=ajp13w was added\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] \nuri_worker_map_add::jk_uri_worker_map.c (360): suffix rule /jsp-\nexamples/.jpeg=ajp13w1 was added\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] \nuri_worker_map_open::jk_uri_worker_map.c (478): there are 5 rules\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] build_worker_map::jk_worker.c \n(196): creating worker ajp13w\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] wc_create_worker::jk_worker.c \n(120): about to create instance ajp13w of ajp13\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] wc_create_worker::jk_worker.c \n(133): about to validate and init ajp13w\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_validate::jk_ajp_common.c \n(1721): worker ajp13w contact is localhost:8009\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1767): setting socket keepalive to 0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1806): setting socket timeout to -1\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1810): setting connection recycle timeout to 0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1814): setting cache timeout to 0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1818): setting connect timeout to 0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1822): setting reply timeout to 0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1826): setting prepost timeout to 0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1830): setting recovery opts to 0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1834): setting number of retries to 3\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1854): setting connection cache size to 1\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] build_worker_map::jk_worker.c \n(208): removing old ajp13w worker \n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] build_worker_map::jk_worker.c \n(196): creating worker ajp13w1\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] wc_create_worker::jk_worker.c \n(120): about to create instance ajp13w1 of ajp13\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] wc_create_worker::jk_worker.c \n(133): about to validate and init ajp13w1\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_validate::jk_ajp_common.c \n(1721): worker ajp13w1 contact is localhost:8010\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1767): setting socket keepalive to 0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1806): setting socket timeout to -1\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1810): setting connection recycle timeout to 0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1814): setting cache timeout to 0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1818): setting connect timeout to 0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1822): setting reply timeout to 0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1826): setting prepost timeout to 0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1830): setting recovery opts to 0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1834): setting number of retries to 3\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1854): setting connection cache size to 1\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] build_worker_map::jk_worker.c \n(208): removing old ajp13w1 worker \n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] build_worker_map::jk_worker.c \n(196): creating worker ajp13w2\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] wc_create_worker::jk_worker.c \n(120): about to create instance ajp13w2 of ajp13\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] wc_create_worker::jk_worker.c \n(133): about to validate and init ajp13w2\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_validate::jk_ajp_common.c \n(1721): worker ajp13w2 contact is localhost:8011\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1767): setting socket keepalive to 0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1806): setting socket timeout to -1\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1810): setting connection recycle timeout to 0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1814): setting cache timeout to 0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1818): setting connect timeout to 0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1822): setting reply timeout to 0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1826): setting prepost timeout to 0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1830): setting recovery opts to 0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1834): setting number of retries to 3\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] ajp_init::jk_ajp_common.c \n(1854): setting connection cache size to 1\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] build_worker_map::jk_worker.c \n(208): removing old ajp13w2 worker \n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] \nHttpFilterProc::jk_isapi_plugin.c (636): Detected IIS >= 5.0\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] \nHttpFilterProc::jk_isapi_plugin.c (687): Filter started\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] \nHttpFilterProc::jk_isapi_plugin.c (753): Virtual Host redirection \nof /localhost/servlets-examples/\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] \nmap_uri_to_worker::jk_uri_worker_map.c (700): Attempting to map \nURI '/localhost/servlets-examples/' from 5 maps\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] \nmap_uri_to_worker::jk_uri_worker_map.c (718): Attempting to map context \nURI '/servlets-examples/*'\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] \nmap_uri_to_worker::jk_uri_worker_map.c (718): Attempting to map context \nURI '/jsp-examples/*'\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] \nmap_uri_to_worker::jk_uri_worker_map.c (718): Attempting to map context \nURI '/icf/*'\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] \nHttpFilterProc::jk_isapi_plugin.c (760): Default redirection of /servlets-\nexamples/\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] \nmap_uri_to_worker::jk_uri_worker_map.c (700): Attempting to map URI '/servlets-\nexamples/' from 5 maps\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] \nmap_uri_to_worker::jk_uri_worker_map.c (718): Attempting to map context \nURI '/servlets-examples/*'\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] \nmap_uri_to_worker::jk_uri_worker_map.c (755): Found a context match ajp13w -\n> /servlets-examples/\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] \nHttpFilterProc::jk_isapi_plugin.c (770): check if [/servlets-examples/] is \npoints to the web-inf directory\n[Wed Mar 16 14:24:10 2005] [3584:2756] [debug] \nHttpFilterProc::jk_isapi_plugin.c (788): [/servlets-examples/] is a servlet \nurl - should redirect to ajp13w\n\n--------------------------------------------------------------End of Log\nAs you will notice in the last line, log states should redirect to ajp13w.  \nThe jk connector is retrieving the correct worker from uirworkermap for the \nrequested context, however simply not successfully redirecting the request to \nthe worker.\n\nI hope this helps in resolving this issue.\n\n== Shane", "count": 1, "id": 72530, "time": "2005-03-16T21:39:11Z", "bug_id": 34036, "creation_time": "2005-03-16T21:39:11Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 34036, "attachment_id": null, "is_private": false, "id": 72531, "time": "2005-03-16T21:59:39Z", "creator": "mturk@apache.org", "creation_time": "2005-03-16T21:59:39Z", "text": "Since you are using 2K3 you did not enable isapi extensions\ninside your web setup. This is a known issue with IIS6.\n\nPlease use tomcat-user list (browse archive) for such kind of problems.\n"}, {"count": 3, "attachment_id": null, "creator": "mturk@apache.org", "is_private": false, "id": 72535, "time": "2005-03-16T23:43:15Z", "bug_id": 34036, "creation_time": "2005-03-16T23:43:15Z", "tags": [], "text": "Looks I was closing the case on a second topic.\n\nFor you case use:\n\n/*/=worker1\n"}, {"attachment_id": null, "tags": [], "bug_id": 34036, "text": "(In reply to comment #3)\n> Looks I was closing the case on a second topic.\n> For you case use:\n> /*/=worker1\n\n\nI have tried this as well. It does not still work.\n\nCurrently I have the worker map like this:\n\n/developer/*=worker2\n/*/=worker1\n\nWith this, all contexts fo to worker1. It is almost like the map\nfor worker2 did not exist.\n\nWhen I try a resource that has to be served by worker2, for example:\nhttp://myhost.com/developer/newsletter.html,\nI get a HTTP 404.\n\nWhen I check the logs, the request has actually gone to worker1. Should it\nnot have gone to worker2?\n\nI still feel this could be a bug! I might be wrong.. but I am unable to get it \nto work either. \n", "count": 4, "id": 72568, "time": "2005-03-17T10:46:37Z", "creator": "nags@bsg.co.uk", "creation_time": "2005-03-17T10:46:37Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 34036, "attachment_id": null, "text": "Not sure for 1.2.8, but 1.2.9-dev is working like I explained with /*/\nWait couple of days for release.\n\nMladen.\n\n", "id": 72573, "time": "2005-03-17T11:24:21Z", "creator": "mturk@apache.org", "creation_time": "2005-03-17T11:24:21Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 34036, "is_private": false, "count": 6, "id": 72580, "time": "2005-03-17T13:41:08Z", "creator": "nags@bsg.co.uk", "creation_time": "2005-03-17T13:41:08Z", "text": "(In reply to comment #5)\n> Not sure for 1.2.8, but 1.2.9-dev is working like I explained with /*/\n> Wait couple of days for release.\n> Mladen.\n\nPhew... Thanks for that. Where would I find the dev version of 1.2.9? Is it \navailable for download?"}]