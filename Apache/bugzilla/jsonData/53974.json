[{"count": 0, "text": "The Apache POI 3.8 can't create xls files with google app engine.\n\nIndeed, at the line 1098 of InternalWorkbook.java , POI uses System.getProperty(\"user.name\").\nUsage of System.xxx is forbiden with app engine.\n\nThere is a usage of catch (AccessControlException e) { .. }.\nYou can add a new catch of NullPointerException like this :\n\n--- InternalWorkbook.java.orig  2012-03-17 14:18:59.000000000 +0100\n+++ InternalWorkbook.java.new   2012-10-05 18:17:25.000000000 +0200\n@@ -1100,6 +1100,8 @@\n                 // AccessControlException can occur in a restricted context\n                 // (client applet/jws application or restricted security server)\n                 retval.setUsername(\"POI\");\n+        } catch (NullPointerException e) {\n+            retval.setUsername(\"POI\");\n         }\n         return retval;\n     }\n\nI try this fix and it works well.\n\nOr you can modify the setUsername function in WriteAccessRecord.java (line 99).\n\n\nPS: I don't use java.awt.x fonctionnalities.\n\n\nMy stack trace is : \n\njava.lang.NullPointerException\n\tat org.apache.poi.hssf.record.WriteAccessRecord.setUsername(WriteAccessRecord.java:101)\n\tat org.apache.poi.hssf.model.InternalWorkbook.createWriteAccess(InternalWorkbook.java:1098)\n\tat org.apache.poi.hssf.model.InternalWorkbook.createWorkbook(InternalWorkbook.java:367)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:163)\n\tat fsart.diffTools.outputDriver.Impl.CsvExcelView2SpecialAppEngine.<init>(CsvExcelView2SpecialAppEngine.scala:75)\n\tat fsart.diffTools.webApp.CompareFiles.doGet(CompareFiles.scala:68)", "bug_id": 53974, "is_private": false, "id": 162592, "time": "2012-10-05T16:47:37Z", "creator": "fabien.sartor@gmail.com", "creation_time": "2012-10-05T16:47:37Z", "tags": [], "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 53974, "attachment_id": null, "id": 162662, "time": "2012-10-10T11:10:35Z", "creator": "yegor@dinom.ru", "creation_time": "2012-10-10T11:10:35Z", "is_private": false, "text": "Fixed in r1396543\n\nYegor"}]