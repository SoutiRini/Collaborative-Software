[{"count": 0, "tags": [], "bug_id": 43126, "attachment_id": null, "text": "We have two web applications deployed to the same Tomcat 6.0.13 server on a\nWindows host, and both applications need to connect to IBM content manager\n(remote) to retrieve documents. The first one can connect to content manager and\nretrieve documents. The second one encounters error when it tries to connect.\n\nAfter some research, I found that the IBM content manager API used in our\napplication to connect to content manager uses DB2 type 2 driver to connect to\nthe content manager DB2 database. So I developed a simple web application that\ndemonstrate this problem.\n\nThis sample web application has one class, TestDB.java, that connects to DB2\ndatabase uses type 2 driver. It creates a DriverManager, obtains a JDBC\nconnection, then release the connection. This web application has one jsp,\nTestDB.jsp, that invokes the TestDB java class.\n\nHere are the steps I used to demonstrate the problem:\n\n1. Make a copy of the attached TestDB.war, name the copy as TestDB2.war.\n2. Deploy both TestDB.war and TestDB2.war to tomcat 6.0.13 server,\n3. Open a browser, request\n     http://localhost:8080/TestDB/jsp/TestDB.jsp\n   This request finishes successfully, it prints out:\n\n       Starting...\n       Test finished.\n       Done\n4. Open a browser, request\n     http://localhost:8080/TestDB2/jsp/TestDB.jsp\n   This request results an error with stack trace appears in catalina console\nand in the browser:\n\njava.lang.IllegalStateException: Failed to get db connection: No suitable driver\nfound for jdbc:db2:CRISOP\n\tcom.test.db2driver.TestDriver.createDbConnection(TestDriver.java:84)\n\tcom.test.db2driver.TestDriver.getDbConnection(TestDriver.java:63)\n\nFor complete stack trace, see attached TestDBError.html file.\n\n5. Bounce tomcat server,\n6. This time, request \n     http://localhost:8080/TestDB2/jsp/TestDB.jsp\nfirst. It finished successfully.\n7. Request \n     http://localhost:8080/TestDB/jsp/TestDB.jsp\nthrows the error described above (step 4)\n\nSo it seems like once the first webapp loaded the DB2 JDBC native library, the\nsecond webapp cannot load the same native library anymore.\n\nI tested the same scenario on Tomcat 5.5.13 server, same results.\n\nNOTE\n----\n\nTo run the sample webapp on your box, make sure \n\n1. You have DB2 client (native libray) installed on that box, and \n2. Substitute the driver url and username/password in TestDB.java class to match\nyour environment, the re-compile this class.", "id": 106772, "time": "2007-08-14T20:21:29Z", "creator": "puhong.you@gmail.com", "creation_time": "2007-08-14T20:21:29Z", "is_private": false}, {"count": 1, "tags": [], "text": "Created attachment 20664\nSample web app that demonstrates the problem.", "attachment_id": 20664, "id": 106773, "creator": "puhong.you@gmail.com", "time": "2007-08-14T20:23:14Z", "bug_id": 43126, "creation_time": "2007-08-14T20:23:14Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 43126, "text": "Created attachment 20665\nComplete error message/stack trace", "id": 106774, "time": "2007-08-14T20:27:35Z", "creator": "puhong.you@gmail.com", "creation_time": "2007-08-14T20:27:35Z", "is_private": false, "attachment_id": 20665}, {"count": 3, "tags": [], "bug_id": 43126, "text": "The \u2018problem\u2019 seems like a design feature of JNI:\n\nhttp://java.sun.com/docs/books/jni/html/design.html#8628\n", "id": 107437, "time": "2007-08-29T15:28:25Z", "creator": "puhong.you@gmail.com", "creation_time": "2007-08-29T15:28:25Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 43126, "text": "This is indeed a JNI 'feature'.", "id": 107808, "time": "2007-09-06T19:12:06Z", "creator": "markt@apache.org", "creation_time": "2007-09-06T19:12:06Z", "is_private": false, "attachment_id": null}]