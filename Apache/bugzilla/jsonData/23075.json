[{"count": 0, "tags": [], "bug_id": 23075, "attachment_id": null, "text": "I am creating a directory browser for our local intranet and decided to \ndownload POI to be able to access the files' property sets. At the beginning I \nwas getting a NegativeArraySizeException when trying to access the file \nSummaryInformation.  when I downloaded the sourcecode I realized that properties\n[5],properties[6] and properties[13] in th properties array were being \ninitialized with a negative length.  to prove HPFS functionality I programed a \nworkaround so that if the length was negative, it should leave that elemat in \nthe array as a null Property.  This elements hold the information of: \nApplcation Name,Revision Number and Thumbnail.  I am also having problem whe \ngetting the comments, since the files have comments but the SummaryInformation \nreturns an empty string.", "id": 43956, "time": "2003-09-10T17:15:20Z", "creator": "izelaya@proyectopaar.org", "creation_time": "2003-09-10T17:15:20Z", "is_private": false}, {"count": 1, "tags": [], "creator": "klute@apache.org", "attachment_id": null, "id": 44025, "time": "2003-09-11T09:32:40Z", "bug_id": 23075, "creation_time": "2003-09-11T09:32:40Z", "is_private": false, "text": "Please try the latest POI release and try again. Does that help?"}, {"count": 2, "tags": [], "creator": "izelaya@proyectopaar.org", "attachment_id": null, "id": 44058, "time": "2003-09-11T17:50:51Z", "bug_id": 23075, "creation_time": "2003-09-11T17:50:51Z", "is_private": false, "text": "hi:\n \nFor HPFS to interpret microsoft's property set correctly, including \nmultilingual support(only tried spanish tildes) I changed the 'value' variable \nassigmet in the following code:\n \n            case Variant.VT_LPSTR:\n            case Variant.VT_LPWSTR:\n            {\n                /* Read a byte string. In Java it is represented as a\n                   String. The null bytes at the end of the byte\n                   strings must be stripped. */\n                final int first = o + DWord.LENGTH;\n                int last = first + new DWord(src, o).intValue() - 1;\n                o += DWord.LENGTH;\n/*                while (src[last] == 0 && first <= last)\n                    last--;*/\n                try{\n                  /*value = new String(src, first, last - first + 1);*/\n                  value = new String((new String(src, first, last - first + \n1, \"UTF-16LE\")).getBytes(),\"UTF-8\");\n                }\n                catch(java.io.UnsupportedEncodingException ex){\n                }\n                break;\n            }\n \nTo solve the NegativeArraySizeException I added an if-statement in the \nfollowing code:\n\n            default:\n            {\n              if (length > 0){\n                final byte[] v = new byte[length];\n                for (int i = 0; i < length; i++)\n                  v[i] = src[offset + i];\n                value = v;\n              }\n              else\n                value = null;\n              break;\n            }\n\nHope this can help you guys for future releases.  Thanks,\n \nIgor L. Zelaya\nSenior Software Developer\nProyecto PAAR"}, {"count": 3, "tags": [], "text": "In order to fix this permanently (and to prepare a test case) I need a sample\ndocument showing the faulty behaviour. Thanks!", "attachment_id": null, "id": 44229, "creator": "klute@apache.org", "time": "2003-09-16T07:57:13Z", "bug_id": 23075, "creation_time": "2003-09-16T07:57:13Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 23075, "attachment_id": null, "id": 44376, "time": "2003-09-20T07:49:59Z", "creator": "klute@apache.org", "creation_time": "2003-09-20T07:49:59Z", "is_private": false, "text": "Reading the sample document with the current CVS HEAD worked without any\nproblem. Please consider an upgrade!"}]