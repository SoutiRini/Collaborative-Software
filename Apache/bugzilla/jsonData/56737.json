[{"count": 0, "tags": [], "creator": "apache@gagravarr.org", "text": "Consider a .xlsx workbook with two sheets. Sheet two \"Defines\" has a named range \"NR_To_A1\" on it, while there's a workbook scoped named range \"NR_Global_B2\". The first sheet has formulas which use it\n\nFor a sheet scoped named range reference, with a formula like \n\n=Defines!NR_To_A1\n\nEvaluation will fail with org.apache.poi.ss.formula.FormulaParseException: Cell reference expected after sheet name at index 9.\n\nFor a workbook scoped named range reference, with a formula like \n\n=TestFile.xlsx!NR_Global_B2\n\nEvaluation will fail with org.apache.poi.ss.formula.FormulaParseException: Parse error near char 0 '[' in specified formula '[0]!NR_Global_B2'. Expected number, string, or defined name", "id": 176459, "time": "2014-07-17T15:40:22Z", "bug_id": 56737, "creation_time": "2014-07-17T15:40:22Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 56737, "attachment_id": 31826, "text": "Created attachment 31826\nTest Excel file with the described formulas and named ranges", "id": 176460, "time": "2014-07-17T15:42:17Z", "creator": "apache@gagravarr.org", "creation_time": "2014-07-17T15:42:17Z", "is_private": false}, {"count": 2, "text": "Note that this is different to with .xls, where you get a different error \"java.lang.RuntimeException: Unexpected eval class (org.apache.poi.ss.formula.eval.NameXEval)\" when evaluating", "creator": "apache@gagravarr.org", "is_private": false, "id": 176461, "time": "2014-07-17T15:46:42Z", "bug_id": 56737, "creation_time": "2014-07-17T15:46:42Z", "tags": [], "attachment_id": null}, {"count": 3, "text": "Disabled, failing unit tests added in r1611400.", "creator": "apache@gagravarr.org", "is_private": false, "id": 176462, "time": "2014-07-17T17:49:59Z", "bug_id": 56737, "creation_time": "2014-07-17T17:49:59Z", "tags": [], "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 56737, "attachment_id": null, "text": "As of r1612156, this file can now be evaluated without error", "id": 176547, "time": "2014-07-20T19:24:58Z", "creator": "apache@gagravarr.org", "creation_time": "2014-07-20T19:24:58Z", "is_private": false}]