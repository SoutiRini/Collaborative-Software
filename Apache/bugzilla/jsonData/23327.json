[{"count": 0, "tags": [], "bug_id": 23327, "attachment_id": null, "id": 44444, "time": "2003-09-22T12:32:56Z", "creator": "ramses_ru@hotmail.com", "creation_time": "2003-09-22T12:32:56Z", "is_private": false, "text": "I found out, that ant since 1.5.x (1.5 is OK) war/jar/zip tasks change time \nstamps of the files in archive. The files became \"older\" compare to originals \n(which are not in archive). \n\nWe are using Weblogic Application Server. It does not verify the timestamps for \nsource jsp and corresponding *.class (compiled jsp) direct, but using it own \nmethod. Files in war look 2 sec. older and web logic server starts to recompile \nthe sources!\n\npublic boolean _isStale()\n{\n   StaleChecker stalechecker = (StaleChecker)getServletConfig\n().getServletContext();\n        Object obj = null;\n        long l = 0L;\n        return stalechecker.isResourceStale(\"/adminloginform.jsp\",    \n0xf766bf9c0bL, //THIS IS A TIMESTAMP OF ORIGINAL JSP\n\"7.0.1.0\");\n   }\n\nhttp://cvs.apache.org/viewcvs/ant/src/main/org/apache/tools/ant/taskdefs/Zip.jav\na\nprotected void zipFile(File file, ZipOutputStream zOut, String vPath, int mode) \nthrows IOException \n{\n  if (file.equals(zipFile)) { \n    throw new BuildException(\"A zip file cannot include itself\", getLocation\n()); \n  } \n  FileInputStream fIn = new FileInputStream(file); \n  try { \n   // ZIPs store time with a granularity of 2 seconds, round up \n    zipFile(fIn, zOut, vPath, file.lastModified() + 1999, null, mode); \n  } \n  finally { \n   fIn.close(); \n  } \n} \n\nThank you in advance\nRoman"}, {"count": 1, "attachment_id": null, "bug_id": 23327, "is_private": false, "id": 44449, "time": "2003-09-22T14:36:43Z", "creator": "bodewig@apache.org", "creation_time": "2003-09-22T14:36:43Z", "tags": [], "text": "\n\n*** This bug has been marked as a duplicate of 17934 ***"}, {"count": 2, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "text": "I addition I should note that _isStale() is going to return false for any files\nin wars as wars (like any other zip) store file dates with a granularity of\ntwo seconds.  So an in-filesystem and an in-archive resource are not too likely\nto have the same timestamps anyway.\n", "id": 44451, "time": "2003-09-22T14:46:08Z", "bug_id": 23327, "creation_time": "2003-09-22T14:46:08Z", "is_private": false}]