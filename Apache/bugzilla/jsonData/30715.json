[{"count": 0, "tags": [], "bug_id": 30715, "text": "Heres a fixed version of the function. The problem was that after\nnode.getParentNode() this already accepted node was returned again, leading to\nan endless loop and an OutOfMemory after some time.\n\nReplacing nextNode with this function fixed the problem:\n\n------------ PATCH ----------------------------------------------\n\n    public Node nextNode() {\n        Node result = null;\n        if (next != null) {\n            result = next;\n        } else {\n            return null;\n        }\n        \n        Node node = next;\n        while (true) {\n            if (node.hasChildNodes()) {\n            \t// Go deeper...\n                node = node.getFirstChild();\n            } else {\n            \t// Go further \n                while (true) {\n                    Node old = node;\n                    node = node.getNextSibling();                    \n                    if (node == null) {\n                    \t// Else go up and further...\n                        do { \n  \t\t\t        node = old;\n\t                        node = node.getParentNode();\n    \t                    if (node == null) {\n        \t                    next = null;\n            \t                return result;\n                \t        }\n                \t        // Take the next sibling of the parent,\n                \t        // because the parent has already been\n                \t        // visited\n\t\t\t\t\t\t\told = node;\n                \t        node = node.getNextSibling();\n\t\t\t\t\t\t} while( node == null );\n                    } else\n                        break;\n                }\n            }\n            if (node != null && acceptNode(node)) {\n                next = node;\n                return result;\n            }\n        }\n    }", "id": 62092, "time": "2004-08-17T21:26:14Z", "creator": "xindice@Mig-O.de", "creation_time": "2004-08-17T21:26:14Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "vgritsenko@apache.org", "text": "TreeWalkerImpl had several problems; with previousNode, nextNode, and\ngetRootNode as well. It is fixed in CVS now.\n\n(next time; to create a patch use \"cvs diff -u\" command, or \"diff -u file1 file2\")", "id": 62619, "attachment_id": null, "bug_id": 30715, "creation_time": "2004-08-28T02:23:00Z", "time": "2004-08-28T02:23:00Z", "is_private": false}]