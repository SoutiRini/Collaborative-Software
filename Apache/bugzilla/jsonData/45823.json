[{"count": 0, "tags": [], "creator": "per.landberg@polago.se", "attachment_id": 22595, "id": 120700, "time": "2008-09-17T02:20:05Z", "bug_id": 45823, "creation_time": "2008-09-17T02:20:05Z", "is_private": false, "text": "Created attachment 22595\nPatch that corrects this bug\n\nWhen configuring the AccessLogValve valve to use the combined log format and either referer or user-agent fields are unavailable in the request, the corresponding log entry fields will contain \"(null)\" instead of \"-\". This behaviour breaks access log analyzers like AWStats and I believe it's also a violation of the log spec.\n\nIncluded is a patch that I believe will correct the problem. The patch make sure that any non-existing header will be logged as '-' instead of trying to log a null pointer.\n\nI stumbled on this problem when upgrading from Tomcat 5.5 to 6.0.16 using Debian etch and JDK 6. Tomcat 5.5 didn't suffer from this issue.\n\nI haven't yet tried Tomcat 6.0.18 but the AccessLogValve.java file seems to be unchanged between the two releases so I suspect the problem still exists."}, {"count": 1, "attachment_id": null, "creator": "markt@apache.org", "text": "Thanks for the report and the patch. I have applied a slightly modified patch to trunk and proposed it for 6.0.x.", "id": 120703, "time": "2008-09-17T03:58:39Z", "bug_id": 45823, "creation_time": "2008-09-17T03:58:39Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 45823, "attachment_id": null, "id": 120784, "time": "2008-09-19T04:06:37Z", "creator": "markt@apache.org", "creation_time": "2008-09-19T04:06:37Z", "is_private": false, "text": "This has been committed to 6.0.x and will be included in 6.0.19 onwards.\n\nThanks again for the patch."}]