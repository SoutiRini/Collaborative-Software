[{"count": 0, "tags": [], "creator": "benjamin.ruede@bs.ch", "is_private": false, "text": "I had build the newest version of Chainsaw from the SVN with maven. (revision: 953286)\n\nProblem now ist that the column for the Logger is empty if i get LoggingEvents from a SocketReceiver or SocketHubReceiver\n\nthe following exceptions are shown in the chainsaw log:\n\nLevel: ERROR\nLogger: org.apache.log4j.chainsaw.LogUI\nTime: 2010-06-10 13:48:22,364\nThread: AWT-EventQueue-0\nMessage: Uncaught exception in thread Thread[AWT-EventQueue-0,6,main]\nMarker:\nThrowable:java.lang.NullPointerException\n\tat java.util.StringTokenizer. (Unknown Source)\n\tat java.util.StringTokenizer. (Unknown Source)\n\tat org.apache.log4j.chainsaw.LogPanelLoggerTreeModel.tokenize(LogPanelLoggerTreeModel.java:161)\n\tat org.apache.log4j.chainsaw.LogPanelLoggerTreeModel.addLoggerNameInDispatchThread(LogPanelLoggerTreeModel.java:66)\n\tat org.apache.log4j.chainsaw.LogPanelLoggerTreeModel.access$100(LogPanelLoggerTreeModel.java:44)\n\tat org.apache.log4j.chainsaw.LogPanelLoggerTreeModel$1.run(LogPanelLoggerTreeModel.java:60)\n\tat java.awt.event.InvocationEvent.dispatch(Unknown Source)\n\tat java.awt.EventQueue.dispatchEvent(Unknown Source)\n\tat java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)\n\tat java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)\n\tat java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)\n\tat java.awt.EventDispatchThread.pumpEvents(Unknown Source)\n\tat java.awt.EventDispatchThread.pumpEvents(Unknown Source)\n\tat java.awt.EventDispatchThread.run(Unknown Source)   \n\nAnd if i klick on a event in the table the following Error is thrown:\n\nLevel: ERROR\nLogger: org.apache.log4j.chainsaw.LogUI\nTime: 2010-06-10 13:50:23,236\nThread: AWT-EventQueue-0\nMessage: Uncaught exception in thread Thread[AWT-EventQueue-0,6,main]\nMarker:\nThrowable: java.lang.NullPointerException\n\tat org.apache.log4j.CategoryKey. (CategoryKey.java:32)\n\tat org.apache.log4j.Hierarchy.getLogger(Hierarchy.java:266)\n\tat org.apache.log4j.Hierarchy.getLogger(Hierarchy.java:247)\n\tat org.apache.log4j.LoggerRepositoryExImpl.getLogger(LoggerRepositoryExImpl.java:383)\n\tat org.apache.log4j.LogManager.getLogger(LogManager.java:228)\n\tat org.apache.log4j.Logger.getLogger(Logger.java:104)\n\tat org.apache.log4j.chainsaw.layout.EventDetailLayout.copyForHTML(EventDetailLayout.java:181)\n\tat org.apache.log4j.chainsaw.layout.EventDetailLayout.format(EventDetailLayout.java:269)\n\tat org.apache.log4j.chainsaw.LogPanel$DetailPaneUpdater.updateDetailPane(LogPanel.java:3062)\n\tat org.apache.log4j.chainsaw.LogPanel$DetailPaneUpdater.setAndUpdateSelectedRow(LogPanel.java:3037)\n\tat org.apache.log4j.chainsaw.LogPanel$DetailPaneUpdater.access$3100(LogPanel.java:3019)\n\tat org.apache.log4j.chainsaw.LogPanel$44.tableChanged(LogPanel.java:1121)\n\tat javax.swing.table.AbstractTableModel.fireTableChanged(Unknown Source)\n\tat javax.swing.table.AbstractTableModel.fireTableRowsUpdated(Unknown Source)\n\tat org.apache.log4j.chainsaw.ChainsawCyclicBufferTableModel.fireRowUpdated(ChainsawCyclicBufferTableModel.java:669)\n\tat org.apache.log4j.chainsaw.LogPanel$MarkerCellEditor.stopCellEditing(LogPanel.java:3142)\n\tat javax.swing.plaf.basic.BasicTableUI$Handler.mousePressed(Unknown Source)\n\tat java.awt.AWTEventMulticaster.mousePressed(Unknown Source)\n\tat java.awt.AWTEventMulticaster.mousePressed(Unknown Source)\n\tat java.awt.Component.processMouseEvent(Unknown Source)\n\tat javax.swing.JComponent.processMouseEvent(Unknown Source)\n\tat java.awt.Component.processEvent(Unknown Source)\n\tat java.awt.Container.processEvent(Unknown Source)\n\tat java.awt.Component.dispatchEventImpl(Unknown Source)\n\tat java.awt.Container.dispatchEventImpl(Unknown Source)\n\tat java.awt.Component.dispatchEvent(Unknown Source)\n\tat java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)\n\tat java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)\n\tat java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)\n\tat java.awt.Container.dispatchEventImpl(Unknown Source)\n\tat java.awt.Window.dispatchEventImpl(Unknown Source)\n\tat java.awt.Component.dispatchEvent(Unknown Source)\n\tat java.awt.EventQueue.dispatchEvent(Unknown Source)\n\tat java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)\n\tat java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)\n\tat java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)\n\tat java.awt.EventDispatchThread.pumpEvents(Unknown Source)\n\tat java.awt.EventDispatchThread.pumpEvents(Unknown Source)\n\tat java.awt.EventDispatchThread.run(Unknown Source)\n\n\nI spend some time and watched in the Source what is going wrong.\n\ni found the following problem\n\nAfter the LoggingEvent is deseriazabled the Field logger is null because this field is set transident and is not restored in the \"writeObject\" method.\n\nif now Chainsaw use this LoggingEvent to create a ExtendedLoggingEvent there is no Logger in this event.\n\nthe construktor of the ExtendedLoggingEvent calls the super-construktor of LoggingEvent with e.getFQNOfLoggerClass() for the LoggerName and e.getLogger() for the logger both returnvalues will be null.\n\nthe construktor of LoggingEvent will now call categoryName = logger.getName(); for set the LoggerName. -> all null\n\nSo i changed the construktor for the ExtendedLoggingEvent from\n\n public ExtendedLoggingEvent(LoggingEvent e) {\n\n        super(e.getFQNOfLoggerClass(), e.getLogger(), e.getTimeStamp(), e.getLevel(), e.getMessage(), e.getThreadName(), e.getThrowableInformation(), e.getNDC(), e.getLocationInformation(), e.getProperties());\n    }\n\nto:\n\n //copy constructor\n    public ExtendedLoggingEvent(LoggingEvent e) {\n\n        super(e.getLoggerName(), e.getLogger()!=null?e.getLogger(): Logger.getLogger(e.getLoggerName()), e.getTimeStamp(), e.getLevel(), e.getMessage(), e.getThreadName(), e.getThrowableInformation(), e.getNDC(), e.getLocationInformation(), e.getProperties());\n    }\n\nwith this change i see now all Loggers in the column and no errors are thrown anymore.\n\ni don't know if it is the best way to fix this problem but it may help you to fix it.", "id": 137537, "time": "2010-06-10T08:08:35Z", "bug_id": 49421, "creation_time": "2010-06-10T08:08:35Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 49421, "attachment_id": null, "text": "Thanks for spending some time looking in to this.  I'll commit a fix for this by the weekend.", "id": 137540, "time": "2010-06-10T08:53:04Z", "creator": "sdeboy@iname.com", "creation_time": "2010-06-10T08:53:04Z", "is_private": false}, {"count": 2, "tags": [], "creator": "sdeboy@iname.com", "attachment_id": null, "text": "Fix committed to Chainsaw (and receivers) svn head, revision 953945.\n\nCommit msg:\nFix Bug 49421:  Chainsaw don't show Logger for SocketReceiver and SocketHubReceiver\n\nAll calls to the LoggingEvent constructor which pass in another event's Logger may only have a categoryName field and not logger field available - updated calls to LoggingEvent constructor to ensure logger was passed in if not null, or a logger was created from the logger name (pre-existing bug in rewritepolicy classes if they were used with socketappender/receiver).\n\nAlso (arbitrarily) updated Chainsaw revision in the pom.xml 2.1.0, in order to keep folks from being confused that this latest version is the original 2.0 (which according to maven was previously 1.99)", "id": 137589, "time": "2010-06-12T02:22:05Z", "bug_id": 49421, "creation_time": "2010-06-12T02:22:05Z", "is_private": false}]