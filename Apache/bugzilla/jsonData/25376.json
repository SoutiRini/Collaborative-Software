[{"count": 0, "tags": [], "creator": "jperezme@jazzfree.com", "attachment_id": null, "is_private": false, "id": 48774, "time": "2003-12-09T23:39:22Z", "bug_id": 25376, "creation_time": "2003-12-09T23:39:22Z", "text": "I have compiled Apache 2.0.48 with options Jeff Trawick's page and all\ngo right. I make this steps to building:\nApache:\n#./buildconf\n#CC=gcc ./configure --prefix=/usr/local/apache2\\\n--with-mpm=worker --enable-so --enable-layout=Apache \\\n--enable-mods-shared=most --enable-maintainer-mode   \\\n--with-expat=`pwd`/srclib/apr-util/xml/expat         \\\n--enable-static-support\n\nThen i have compiled php-4.3.4 with this options:\n#./configure --prefix=/usr/local/apache2/php --with-config-file-path=/usr/lo\ncal/apache2/php --with-mysql --with-apxs2=/usr/local/apache2/bin/apxs\n\nThen, i load phpinfo.php and go right, but when i load a Phpnuke 6.8 portal \npages\napache shows segmentation fault.\n[Fri Nov 14 12:12:10 2003] [notice] Apache/2.0.48 (Unix) DAV/2 PHP/4.3.4\nconfigured -- resuming normal operations\n[Fri Nov 14 12:16:45 2003] [notice] child pid 18322 exit signal Segmentation\nfault (11)\n[Fri Nov 14 12:17:40 2003] [notice] caught SIGTERM, shutting down\n\nI'm looking for a core file but i don't find it.\n\nIt works find with apache 1.3.29 and Php 4.3.4(also php 4.3.2).\n\nAny idea ?"}, {"count": 1, "tags": [], "creator": "trawick@apache.org", "is_private": false, "id": 48775, "attachment_id": null, "bug_id": 25376, "creation_time": "2003-12-09T23:59:04Z", "time": "2003-12-09T23:59:04Z", "text": "We corresponded privately about a month ago and I believe you checked for ulimit\nand coredumpdirectory and still couldn't get a core file generated.\n\nThe next best thing to get a backtrace for the segfault is to attach to a\nrunning httpd process with the debugger, use the continue command to let the\nhttpd process run freely, then keep requesting the PHP page until the httpd\nprocess you attached to segfaults.  Then get a backtrace.  Example:\n\ngdb /path/to/httpd pid\n(gdb) cont\n[keep requesting the page until the debugger wakes up after SIGSEGV]\n(gdb) where\n"}, {"count": 2, "tags": [], "bug_id": 25376, "text": "These are my httpd processes:\nroot 12654     1   0 23:22:24      -  0:00 /usr/local/apache2/bin/httpd -k \nstart \nnobody 16352 12654   0 23:22:25      -  0:00 /usr/local/apache2/bin/httpd -k \nstart \nnobody 16608 12654   0 23:32:01      -  0:00 /usr/local/apache2/bin/httpd -k \nstart \n\nThis is the result:\n\n#gdb ../bin/httpd 10074\nGNU gdb 5.0\nCopyright 2000 Free Software Foundation, Inc.\nGDB is free software, covered by the GNU General Public License, and you are\nwelcome to change it and/or distribute copies of it under certain conditions.\nType \"show copying\" to see the conditions.\nThere is absolutely no warranty for GDB.  Type \"show warranty\" for details.\nThis GDB was configured as \"powerpc-ibm-aix4.3.2.0\"...\n/usr/local/apache2/logs/10074: No such file or directory.\nAttaching to program: /usr/local/apache2/logs/../bin/httpd, process 10074\n0xd0011b6c in _pthread_ksleep ()\n(gdb) cont\nContinuing.\n\nProgram terminated with signal SIGSEGV, Segmentation fault.\nThe program no longer exists.\n(gdb) where\nNo stack.\n(gdb) \n\nIf i make the test with parent process of httpd(root):\n#/usr/local/apache2/logs#gdb ../bin/httpd 12654\nGNU gdb 5.0\nCopyright 2000 Free Software Foundation, Inc.\nGDB is free software, covered by the GNU General Public License, and you are\nwelcome to change it and/or distribute copies of it under certain conditions.\nType \"show copying\" to see the conditions.\nThere is absolutely no warranty for GDB.  Type \"show warranty\" for details.\nThis GDB was configured as \"powerpc-ibm-aix4.3.2.0\"...\n/usr/local/apache2/logs/12654: No such file or directory.\nAttaching to program: /usr/local/apache2/logs/../bin/httpd, process 12654\n0xd1136728 in apr_sleep (t=1000000) at time.c:288\n288     time.c: No such file or directory.\n(gdb) cont\nContinuing.\n", "id": 48868, "time": "2003-12-10T22:29:08Z", "creator": "jperezme@jazzfree.com", "creation_time": "2003-12-10T22:29:08Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 25376, "attachment_id": null, "id": 49720, "creation_time": "2003-12-26T12:49:38Z", "time": "2003-12-26T12:49:38Z", "creator": "jperezme@jazzfree.com", "text": "Any new idea ?\n", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 25376, "text": "Hi Jeff,\nI've got exactly the same problem with this version : AIX 4.3.3-11, APACHE \n2.0.48 mpm-worker, php 4.3.4 and IBM C for AIX ( cc_r ). The problem appears \nwith phpmyadmin ( not phpnuke like jos\u00e9 ), but a phpinfo page is always OK. The \nfirst time, i thought that it's a threaded problem with mpm worker. As i read \njos\u00e9 problem, he follow your page info about AIX/APACHE/PHP, and the problem \nseem to be the same through mpm-prefork and gcc.\nSo I tried an php version 4.3.5RC3, always with mpm-worker, and now the problem \nappears only after 5 of 6 call of phpmyadmin page, instead of the first call \nwith php 4.3.4.\nThere is no core file, just a message in error_log: \"child pid 38640 exit \nsignal Segmentation fault (11)\".\nApache create a new thread, but any page ( php or not ) can be serve, execpt \nafter an apachectl restart.\nI can reproduce this as soon as i want. therefore, i'm not a specialist of \ndebub execution of C program: if you have an detailed method to track this \nproblem, it can be helpfull.\nThanks in advance for your help.    \n", "count": 4, "id": 52653, "time": "2004-02-20T12:03:21Z", "creator": "phuret@free.fr", "creation_time": "2004-02-20T12:03:21Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 25376, "attachment_id": null, "id": 56968, "creation_time": "2004-05-07T00:36:35Z", "time": "2004-05-07T00:36:35Z", "creator": "chip@force-elite.com", "text": "This is using the Worker MPM.  This is not a supported MPM for PHP. \n\nThe PHP developers have said many times they have no interest in supporting the\nmulti-threaded MPMs.  There is nothing to fix in Apache, it is a PHP bug.\n\nIf you want to use the Worker MPM, try mod_perl :)", "is_private": false}]