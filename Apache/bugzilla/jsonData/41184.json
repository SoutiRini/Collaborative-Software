[{"count": 0, "tags": [], "creator": "harindranath@gmail.com", "is_private": false, "id": 96951, "attachment_id": null, "bug_id": 41184, "creation_time": "2006-12-15T11:18:39Z", "time": "2006-12-15T11:18:39Z", "text": "Httpd does only the following:\n\n[Sat Nov 18 14:39:50 2006] [notice] Apache/2.2.3 (Unix) mod_jk/1.2.19 configured\n-- resuming normal operations\n[Sat Nov 18 14:39:51 2006] [notice] child pid 6464 exit signal Segmentation\nfault (11)\n[Sat Nov 18 14:39:51 2006] [notice] child pid 6468 exit signal Segmentation\nfault (11)\n[Sat Nov 18 14:39:53 2006] [notice] child pid 6529 exit signal Segmentation\nfault (11)\n[Sat Nov 18 14:39:55 2006] [notice] child pid 6557 exit signal Segmentation\nfault (11)\n[Sat Nov 18 14:39:57 2006] [notice] child pid 6585 exit signal Segmentation\nfault (11)\n[Sat Nov 18 14:39:59 2006] [notice] child pid 6614 exit signal Segmentation\nfault (11)\n[Sat Nov 18 14:40:01 2006] [notice] child pid 6642 exit signal Segmentation\nfault (11)\n[Sat Nov 18 14:40:03 2006] [notice] child pid 6671 exit signal Segmentation\nfault (11)\n[Sat Nov 18 14:40:05 2006] [notice] child pid 6699 exit signal Segmentation\nfault (11)\n\nNo requests served.\nLooks similar to bug 40158"}, {"count": 1, "tags": [], "bug_id": 41184, "attachment_id": null, "id": 96952, "time": "2006-12-15T11:22:23Z", "creator": "harindranath@gmail.com", "creation_time": "2006-12-15T11:22:23Z", "is_private": false, "text": "Built with :\n./configure --enable-ssl=shared --with-mpm=worker\" \nAnd mod_jk installed.\n\n"}, {"count": 2, "tags": [], "bug_id": 41184, "attachment_id": null, "id": 96953, "time": "2006-12-15T11:22:53Z", "creator": "harindranath@gmail.com", "creation_time": "2006-12-15T11:22:53Z", "is_private": false, "text": "Backtrace:\n\nProgram received signal SIGSEGV, Segmentation fault.\n[Switching to Thread -1493984336 (LWP 7177)]\napr_pollset_add (pollset=0x0, descriptor=0xa6f39a40) at poll/unix/epoll.c:146\n146     poll/unix/epoll.c: No such file or directory.\n        in poll/unix/epoll.c\n(gdb) where\n#0  apr_pollset_add (pollset=0x0, descriptor=0xa6f39a40)\n    at poll/unix/epoll.c:146\n#1  0x08097289 in listener_thread (thd=0x812d770, dummy=0x80bce70)\n    at worker.c:620\n#2  0xb75813e0 in dummy_worker (opaque=0x0) at threadproc/unix/thread.c:138\n#3  0xb7515dac in start_thread () from /lib/tls/libpthread.so.0\n#4  0xb74b19ea in clone () from /lib/tls/libc.so.6\n"}, {"count": 3, "tags": [], "bug_id": 41184, "attachment_id": null, "id": 96954, "time": "2006-12-15T11:34:32Z", "creator": "wrowe@apache.org", "creation_time": "2006-12-15T11:34:32Z", "is_private": false, "text": "In fact, it looks like nothing.  Please post the backtrace of the core dump?"}, {"count": 4, "tags": [], "creator": "wrowe@apache.org", "is_private": false, "id": 96955, "attachment_id": null, "bug_id": 41184, "creation_time": "2006-12-15T11:35:11Z", "time": "2006-12-15T11:35:11Z", "text": "Sorry - your followup was faster than my email notices!"}, {"count": 5, "tags": [], "bug_id": 41184, "attachment_id": null, "id": 96956, "time": "2006-12-15T11:51:02Z", "creator": "harindranath@gmail.com", "creation_time": "2006-12-15T11:51:02Z", "is_private": false, "text": "Result of a little more digging around:\n\n(gdb) run -X -d /opt/CCBLPSM/ccm/httpd\nStarting program: /opt/CCBLPSM/ccm/httpd/bin/httpd -X -d /opt/CCBLPSM/ccm/httpd\nBreakpoint 1 at 0xb757e52d: file poll/unix/epoll.c, line 92.\n[Thread debugging using libthread_db enabled]\n[New Thread -1220712800 (LWP 7813)]\n[New Thread -1221248080 (LWP 7821)]\n[New Thread -1231737936 (LWP 7822)]\n[New Thread -1242227792 (LWP 7823)]\n[New Thread -1252717648 (LWP 7824)]\n[New Thread -1263207504 (LWP 7825)]\n[New Thread -1273697360 (LWP 7826)]\n[New Thread -1284187216 (LWP 7827)]\n[New Thread -1294677072 (LWP 7828)]\n[New Thread -1305166928 (LWP 7829)]\n[New Thread -1315656784 (LWP 7830)]\n[New Thread -1326146640 (LWP 7831)]\n[New Thread -1336636496 (LWP 7832)]\n[New Thread -1347126352 (LWP 7833)]\n[New Thread -1357616208 (LWP 7834)]\n[New Thread -1368106064 (LWP 7835)]\n[New Thread -1378595920 (LWP 7836)]\n[New Thread -1389085776 (LWP 7837)]\n[New Thread -1399575632 (LWP 7838)]\n[New Thread -1410065488 (LWP 7839)]\n[New Thread -1420555344 (LWP 7840)]\n[New Thread -1431045200 (LWP 7841)]\n[New Thread -1441535056 (LWP 7842)]\n[New Thread -1452024912 (LWP 7843)]\n[New Thread -1462514768 (LWP 7844)]\n[New Thread -1473004624 (LWP 7845)]\n[New Thread -1483494480 (LWP 7846)]\n[New Thread -1493984336 (LWP 7847)]\n[Switching to Thread -1493984336 (LWP 7847)]\n\nBreakpoint 1, apr_pollset_create (pollset=0xa6f39ac4, size=1, p=0x8108b58,\n    flags=0) at poll/unix/epoll.c:92\n92      poll/unix/epoll.c: No such file or directory.\n        in poll/unix/epoll.c\n(gdb) next\n96      in poll/unix/epoll.c\n(gdb) where\n#0  apr_pollset_create (pollset=0xa6f39a3c, size=1, p=0x8108b58, flags=0)\n    at poll/unix/epoll.c:96\n#1  0x08097245 in listener_thread (thd=0x812d770, dummy=0x819cc80)\n    at worker.c:609\n#2  0xb75813e0 in dummy_worker (opaque=0xa6f39a3c)\n    at threadproc/unix/thread.c:138\n#3  0xb7515dac in start_thread () from /lib/tls/libpthread.so.0\n#4  0xb74b19ea in clone () from /lib/tls/libc.so.6\n(gdb) next\n97      in poll/unix/epoll.c\n(gdb) next\n96      in poll/unix/epoll.c\n(gdb) print fd\n$1 = -1219447192\n(gdb) print errno\n$2 = 0\n(gdb) next\n97      in poll/unix/epoll.c\n(gdb) next\n98      in poll/unix/epoll.c\n(gdb) print $2\n$3 = 0\n(gdb) print errno\n$4 = 0\n(gdb) print\n$5 = 0\n(gdb) print fd\n$6 = -1\n(gdb) print errno\n$7 = 0\n(gdb) next\n99      in poll/unix/epoll.c\n(gdb) next\n131     in poll/unix/epoll.c\n(gdb) print size\n$8 = 1\n(gdb) next\nlistener_thread (thd=0x812d770, dummy=0x819cc80) at worker.c:611\n611     worker.c: No such file or directory.\n        in worker.c\n(gdb) print pollset\n$9 = (apr_pollset_t *) 0x0\n"}, {"count": 6, "tags": [], "creator": "rpluem@apache.org", "is_private": false, "text": "(In reply to comment #5)\n\n> \n> Breakpoint 1, apr_pollset_create (pollset=0xa6f39ac4, size=1, p=0x8108b58,\n>     flags=0) at poll/unix/epoll.c:92\n> 92      poll/unix/epoll.c: No such file or directory.\n>         in poll/unix/epoll.c\n> (gdb) next\n> 96      in poll/unix/epoll.c\n> (gdb) where\n> #0  apr_pollset_create (pollset=0xa6f39a3c, size=1, p=0x8108b58, flags=0)\n>     at poll/unix/epoll.c:96\n> #1  0x08097245 in listener_thread (thd=0x812d770, dummy=0x819cc80)\n>     at worker.c:609\n> #2  0xb75813e0 in dummy_worker (opaque=0xa6f39a3c)\n>     at threadproc/unix/thread.c:138\n> #3  0xb7515dac in start_thread () from /lib/tls/libpthread.so.0\n> #4  0xb74b19ea in clone () from /lib/tls/libc.so.6\n> (gdb) next\n> 97      in poll/unix/epoll.c\n> (gdb) next\n> 96      in poll/unix/epoll.c\n> (gdb) print fd\n> $1 = -1219447192\n\nAccording to the epoll_create man page this should never happen. epoll_create\nshould either return a positive int (success) or -1 (error) but never something\nlike -1219447192. So it is possible that this is a libc or kernel bug. Are using\na 32 or 64 bit Linux?\n\n> listener_thread (thd=0x812d770, dummy=0x819cc80) at worker.c:611\n> 611     worker.c: No such file or directory.\n>         in worker.c\n> (gdb) print pollset\n> $9 = (apr_pollset_t *) 0x0\n\nMaybe httpd should print an error message in this case and exit instead of\nsegfaulting.", "id": 96963, "time": "2006-12-15T15:21:44Z", "bug_id": 41184, "creation_time": "2006-12-15T15:21:44Z", "attachment_id": null}, {"count": 7, "tags": [], "text": "This is on a 32 bit kernel. 2.4.21-4.ELsmp, Redhat Enterprise Linux ES 3, no\nupdates.\n\nIt did return -1 through, a few lines later in the trace (I had printed before\nthe relevant line apparently), but strangely, no errno.", "is_private": false, "id": 96964, "creator": "harindranath@gmail.com", "time": "2006-12-15T15:28:50Z", "bug_id": 41184, "creation_time": "2006-12-15T15:28:50Z", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 41184, "attachment_id": null, "id": 96967, "time": "2006-12-15T16:18:15Z", "creator": "rpluem@apache.org", "creation_time": "2006-12-15T16:18:15Z", "is_private": false, "text": "(In reply to comment #7)\n \n> It did return -1 through, a few lines later in the trace (I had printed before\n> the relevant line apparently), but strangely, no errno.\n\nAh, Ok I missed that. So the other value is just some kind of bogus value that\nsometimes appears during debugging.\nI am not sure if gdb really displays the correct value for errno here as if you\ninclude errno.h errno is usually a macro to a function rather then a variable in\norder to work in threaded environments. So can you please apply the following\npatch and have a look what gets shown in the error log in debug mode?\n\nIndex: server/mpm/worker/worker.c\n===================================================================\n--- server/mpm/worker/worker.c  (Revision 487344)\n+++ server/mpm/worker/worker.c  (Arbeitskopie)\n@@ -606,7 +606,11 @@\n     free(ti);\n\n     /* ### check the status */\n-    (void) apr_pollset_create(&pollset, num_listensocks, tpool, 0);\n+    rv = apr_pollset_create(&pollset, num_listensocks, tpool, 0);\n+    if (rv != APR_SUCCESS) {\n+        ap_log_error(APLOG_MARK, APLOG_DEBUG, rv, ap_server_conf,\n+                                          \"Pollset create returned %i\", rv);\n+    }\n\n     for (lr = ap_listeners; lr != NULL; lr = lr->next) {\n         apr_pollfd_t pfd = { 0 };"}, {"text": "Could be really an OS problem. See http://kbase.redhat.com/faq/FAQ_79_4466.shtm.", "tags": [], "creator": "rpluem@apache.org", "is_private": false, "count": 9, "id": 96968, "time": "2006-12-15T16:25:38Z", "bug_id": 41184, "creation_time": "2006-12-15T16:25:38Z", "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 41184, "attachment_id": null, "id": 96969, "time": "2006-12-15T16:30:08Z", "creator": "rpluem@apache.org", "creation_time": "2006-12-15T16:30:08Z", "is_private": false, "text": "Further question: Have you compiled httpd on this box / another RedHat 3 ES box\nor has this binary been compiled on a different system e.g. RedHat 4?"}, {"count": 11, "tags": [], "bug_id": 41184, "attachment_id": null, "id": 96970, "time": "2006-12-15T16:31:52Z", "creator": "harindranath@gmail.com", "creation_time": "2006-12-15T16:31:52Z", "is_private": false, "text": "\"EPOLL does not exist in Red Hat Enterprise Linux version 3.\"!!! Now, that would\nexplain a few things. Turns out the binary was built on a 2.6 machine too.\nGuess I have some work to do..."}, {"text": "As per the last comment, appears to have been running on incompatible system.", "tags": [], "creator": "nick@webthing.com", "is_private": false, "count": 12, "id": 123539, "time": "2008-12-26T12:18:10Z", "bug_id": 41184, "creation_time": "2008-12-26T12:18:10Z", "attachment_id": null}]