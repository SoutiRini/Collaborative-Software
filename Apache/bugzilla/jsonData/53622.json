[{"count": 0, "tags": [], "creator": "nistor1@illinois.edu", "text": "Created attachment 29138\npatch\n\nThere is a performance problem in VectorSet.retainAll().  It appears\nin version 1.8.4 and also in revision 1366777.  I attached a test that\nexposes this problem and a patch that fixes it.  On my machine, for\nthis test, the patch provides a 319X speedup.\n\nTo run the test, just do:\n\n$ java Test\n\nThe output for the un-patched version is:\nTime is 7995\n\nThe output for the patched version is:\nTime is 25\n\nThe current implementation of \"VectorSet.retainAll(Collection c)\"\niterates over the elements in \"VectorSet\" and searches in \"c\", which\ncan be very slow, if for example \"c\" is a list.\n\nThe attached patch iterates over the elements of \"c\" and searched in\nVectorSet, which is always very fast, because we can use the field\n\"HashSet set\" in VectorSet.", "id": 161005, "time": "2012-07-30T14:57:31Z", "bug_id": 53622, "creation_time": "2012-07-30T14:57:31Z", "is_private": false, "attachment_id": 29138}, {"attachment_id": 29139, "tags": [], "creator": "nistor1@illinois.edu", "text": "Created attachment 29139\ntest", "count": 1, "id": 161006, "time": "2012-07-30T14:58:14Z", "bug_id": 53622, "creation_time": "2012-07-30T14:58:14Z", "is_private": false}, {"count": 2, "tags": [], "creator": "jglick@apache.org", "attachment_id": null, "text": "I committed revision 1367736 with stronger tests but your patch does not even pass the original testRetainAll: it does not preserve element order. (It also failed to return the right value from retainAll in some cases.)\n\nI committed a simpler patch (revision 1367741) which has at least improved speed and which passes all tests.", "id": 161035, "time": "2012-07-31T20:17:25Z", "bug_id": 53622, "creation_time": "2012-07-31T20:17:25Z", "is_private": false}]