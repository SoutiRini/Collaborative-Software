[{"count": 0, "tags": [], "creator": "roberto.benedetti@dedalus.eu", "text": "Created attachment 30931\nproposed patch\n\nWhen configuring server.loader in catalina.properties with libraries containing valves or realms and their dependencies, if those classes are set in server.xml a CNFE is thrown.\n\nThe reason is Digester using StandardServer's ClassLoader and not context ClassLoader.", "id": 170631, "time": "2013-10-16T09:56:54Z", "bug_id": 55656, "creation_time": "2013-10-16T09:56:54Z", "is_private": false, "attachment_id": 30931}, {"count": 1, "tags": [], "bug_id": 55656, "attachment_id": null, "id": 170635, "creation_time": "2013-10-16T13:45:56Z", "time": "2013-10-16T13:45:56Z", "creator": "chris@christopherschultz.net", "text": "Did you mean \"context\" instead of \"server\" in one of those cases in the description?", "is_private": false}, {"count": 2, "tags": [], "creator": "roberto.benedetti@dedalus.eu", "text": "(In reply to Christopher Schultz from comment #1)\n> Did you mean \"context\" instead of \"server\" in one of those cases in the\n> description?\n\nBefore instantiating and configuring the server, the \"server\" loader is set as the \"context\" loader: Thread.currentThread().setContextClassLoader(catalinaLoader) in Bootstrap class.\n\nDuring startup \"server\" and \"context\" loader are the same.\n\nThe Digester created to configure the server is instructed to use the loader of StandardServer class, but that loader is the \"common\" loader not the \"server\" loader.", "id": 170636, "time": "2013-10-16T14:43:25Z", "bug_id": 55656, "creation_time": "2013-10-16T14:43:25Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 55656, "attachment_id": null, "id": 170651, "creation_time": "2013-10-17T15:29:04Z", "time": "2013-10-17T15:29:04Z", "creator": "markt@apache.org", "text": "Thanks for the patch.\n\nThe report makes sense and the patch looks good to me.\n\nIt has been applied to 8.0.x for 8.0.0-RC6 onwards and 7.0.x for 7.0.48 onwards.\n\nThanks again.", "is_private": false}]