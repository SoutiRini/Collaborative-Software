[{"count": 0, "tags": [], "bug_id": 51146, "is_private": false, "text": "I believe that the fractional part of the file mtime would be thrown away if HAVE_STRUCT_STAT_ST_MTIME_N in fill_out_finfo(), as it is erroneously added to finfo->ctime, which is initialized in the following line. I have no idea for which platform/OS this might be true.\n\n    apr_time_ansi_put(&finfo->mtime, info->st_mtime);\n#ifdef HAVE_STRUCT_STAT_ST_MTIM_TV_NSEC\n    finfo->mtime += info->st_mtim.tv_nsec / APR_TIME_C(1000);\n#elif defined(HAVE_STRUCT_STAT_ST_MTIMENSEC)\n    finfo->mtime += info->st_mtimensec / APR_TIME_C(1000);\n#elif defined(HAVE_STRUCT_STAT_ST_MTIME_N)\n    finfo->ctime += info->st_mtime_n / APR_TIME_C(1000);\n#endif\n\n    apr_time_ansi_put(&finfo->ctime, info->st_ctime);", "id": 146089, "time": "2011-05-03T17:07:10Z", "creator": "rainer-apache@7val.com", "creation_time": "2011-05-03T17:07:10Z", "attachment_id": null}, {"count": 1, "attachment_id": null, "creator": "rpluem@apache.org", "is_private": false, "id": 146097, "time": "2011-05-04T06:05:21Z", "bug_id": 51146, "creation_time": "2011-05-04T06:05:21Z", "tags": [], "text": "Indeed this looks like a bug.\n\nThe following patch should fix this.\n\nIndex: file_io/unix/filestat.c\n===================================================================\n--- file_io/unix/filestat.c     (Revision 1098497)\n+++ file_io/unix/filestat.c     (Arbeitskopie)\n@@ -95,7 +95,7 @@\n #elif defined(HAVE_STRUCT_STAT_ST_ATIMENSEC)\n     finfo->atime += info->st_atimensec / APR_TIME_C(1000);\n #elif defined(HAVE_STRUCT_STAT_ST_ATIME_N)\n-    finfo->ctime += info->st_atime_n / APR_TIME_C(1000);\n+    finfo->atime += info->st_atime_n / APR_TIME_C(1000);\n #endif\n\n     apr_time_ansi_put(&finfo->mtime, info->st_mtime);\n@@ -104,7 +104,7 @@\n #elif defined(HAVE_STRUCT_STAT_ST_MTIMENSEC)\n     finfo->mtime += info->st_mtimensec / APR_TIME_C(1000);\n #elif defined(HAVE_STRUCT_STAT_ST_MTIME_N)\n-    finfo->ctime += info->st_mtime_n / APR_TIME_C(1000);\n+    finfo->mtime += info->st_mtime_n / APR_TIME_C(1000);\n #endif"}, {"count": 2, "tags": [], "bug_id": 51146, "text": "Fixed in r1099348 in trunk.", "id": 146098, "time": "2011-05-04T07:17:47Z", "creator": "rpluem@apache.org", "creation_time": "2011-05-04T07:17:47Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 51146, "attachment_id": null, "is_private": false, "id": 170553, "time": "2013-10-10T19:54:54Z", "creator": "trawick@apache.org", "creation_time": "2013-10-10T19:54:54Z", "text": "merged to 1.5.x branch with r1531085"}]