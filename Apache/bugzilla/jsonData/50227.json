[{"count": 0, "tags": [], "creator": "matt@mattmccutchen.net", "attachment_id": null, "is_private": false, "id": 141520, "time": "2010-11-07T01:03:00Z", "bug_id": 50227, "creation_time": "2010-11-07T01:03:00Z", "text": "In the presence of network attackers, an HTTPS server is liable to receive diverted connections asking for any site for which its certificate is valid, even if that site was supposed to be hosted elsewhere, and it is responsible for responding in a way that does not violate the integrity properties expected by clients.  (See discussion: http://www.ietf.org/mail-archive/web/tls/current/msg07142.html .)  One can set up a default vhost that responds to diverted connections with a relatively harmless error 400 or 403, but for SNI connections, it is even better to reject them at the SSL level.  I could not find any way to configure Apache to do that.  I tried the hack of disabling all protocols or ciphers on the default vhost, hoping to make sure the SSL handshake fails, but Apache detected that as a configuration error and refused to start.\n\nI propose a new option, tentatively named SSLUnrecognizedName, which can be set on or off per vhost and causes SSL connections to that vhost to be rejected with an unrecognized_name error.  Server admins could simply enable that option on the \"harmless\" default vhost they set up for non-SNI clients."}]