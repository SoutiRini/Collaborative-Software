[{"count": 0, "tags": [], "bug_id": 51378, "attachment_id": 27159, "is_private": false, "id": 147142, "time": "2011-06-15T14:27:07Z", "creator": "jxz164@hotmail.com", "creation_time": "2011-06-15T14:27:07Z", "text": "Created attachment 27159\nJava code and Excel files to reproduce the getDataFormatString crash\n\nThe getDataFormatString method call crashes when reading the test file \n\ntest-data\\spreadsheet\\12561-1.xls\n\nwith the following stack trace.\n\nException in thread \"main\" java.lang.ArrayIndexOutOfBoundsException: Array index out of range: 56\n\tat java.util.Vector.get(Vector.java:694)\n\tat org.apache.poi.hssf.usermodel.HSSFDataFormat.getFormat(HSSFDataFormat.java:146)\n\tat org.apache.poi.hssf.usermodel.HSSFCellStyle.getDataFormatString(HSSFCellStyle.java:133)\n\tat org.apache.poi.hssf.usermodel.HSSFCellStyle.getDataFormatString(HSSFCellStyle.java:110)\n\tat org.apache.poi.ss.examples.ReadDataFormat.getDataFormat(ReadDataFormat.java:15)\n\tat org.apache.poi.ss.examples.ReadDataFormat.main(ReadDataFormat.java:34)\n\nThis happens in both poi-3.8-beta3 and poi-3.7.\n\nI tested another Excel file and found that it failed with similar stack trace in poi-3.8-beta3 but succeeded in poi-3.7. I believe there is a regression here.\n\nPlease see attached source code and two Excel files to reproduce this issue."}, {"count": 1, "tags": [], "bug_id": 51378, "attachment_id": null, "text": "Your style is claiming to be format 56, but POI can't find a format with that ID\n\nIf you open the file in excel, and do a \"save as\", does that fix your problem?\n\nWhat does OpenOffice make of the file?\n\nHow was your excel file generated?", "id": 147143, "time": "2011-06-15T14:39:21Z", "creator": "apache@gagravarr.org", "creation_time": "2011-06-15T14:39:21Z", "is_private": false}, {"count": 2, "tags": [], "creator": "jxz164@hotmail.com", "attachment_id": null, "id": 147145, "time": "2011-06-15T14:57:22Z", "bug_id": 51378, "creation_time": "2011-06-15T14:57:22Z", "is_private": false, "text": "The attachment contains two files. The file 12561-1.xls is from shipped poi-3.8-beta3 under the test-data directory. Both POI-3.8-beta3 and POI 3.7 have trouble reading it. Yes, if I save it in Excel again, it will read OK. I don't have openoffice to test it.\n\nThe second file O_27272_2.xls was created by POI and resave it in Excel does not help. The crash happens only in POI-3.8-beta3, but not POI 3.7."}, {"count": 3, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "text": "Should be fixed in r1136352\n\nYegor", "id": 147190, "time": "2011-06-16T10:18:06Z", "bug_id": 51378, "creation_time": "2011-06-16T10:18:06Z", "is_private": false}]