[{"count": 0, "tags": [], "bug_id": 12475, "attachment_id": null, "id": 22584, "time": "2002-09-10T10:48:57Z", "creator": "zakharov@scph.mipt.ru", "creation_time": "2002-09-10T10:48:57Z", "is_private": false, "text": "Hi!\n\nWe use tomcat 3.2.x and 3.3.x on Windows 2k and Linux. Sometimes (one time in \none/two day(s) ) tomcat hangs up. Stack traces show that there is no our code \nin them, only tomcat's. Today I debugged hanged tomcat with the help of remote \ndebug. I find out that there is no thread, which listen HTTP port (port from \nHttpConnectionHandler). There were two threads with the following on top: \njava.net.PlainSocketImpl.socketAccept(java.net.SocketImpl). But these threads \nlistern ports from Ajp12ConnectionHandler and Ajp13ConnectionHandler. Besides \ntwo threads above and systems threads such as AWT-Threads, Finalizer and etc., \nthere were many waiting threads with following stack:\n\t\tjava.lang.Object.wait(long) line: not available [native method]\n\t\torg.apache.tomcat.util.threads.ThreadPool$ControlRunnable\n(java.lang.Object).wait() line: 420\n\t\torg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run() \nline: 495\n\t\tjava.lang.Thread.run() line: 484\n\nDo you have an idea what's wrong with tomcat ? Why is it hanging up ?"}, {"attachment_id": null, "tags": [], "bug_id": 12475, "text": "Are you using the latest release or code from CVS ? I've seen few fixes \nto the thread pooling code.\n\nThe traces you see are normal - there is one thread listening and a number\nof threads waiting ( in the thread pool ). Not sure why tomcat hungs - can \nyou telnet to the http port or the ajp port ? ( manually ) Can you do a dump\nafter you connect ( to see where's it hunged ) ? ", "count": 1, "id": 24095, "time": "2002-10-07T20:08:53Z", "creator": "cmanolache@yahoo.com", "creation_time": "2002-10-07T20:08:53Z", "is_private": false}, {"id": 24115, "tags": [], "bug_id": 12475, "attachment_id": null, "count": 2, "text": "Our jars for Tomcat 3.3.1 have date: 07/12/2002.\n\nThe traces are not normal. There are several waiting threads and threse is _no_ \nlistening thread. In my message I wrote that we saw two listening threads, but \nthey listen Ajp12 and Ajp13 ports. We removed from server.xml Ajp12 and Ajp13 \nand after that our server hung up without and listening thread and with several \nwaiting threads. \n\nI found one more detail. When the server hung up I made dump with the help of \njdb. I invoked the following commands: suspend and wherei all. A part from dump \nof hung server:\n...\nThread-23:\nMonitorRunnable:\n  [1] java.lang.Object.wait (native method)\n  [2] org.apache.tomcat.util.threads.ThreadPool$MonitorRunnable.run \n(ThreadPool.java:407), pc = 11\n  [3] java.lang.Thread.run (Thread.java:484), pc = 11\n...\nWhat is 'Thread-23:' ? Why is there no stack trace for this thread ? There are \nstack traces for 'Thread-22' and 'Theread-24, but there is no for 'Thread-23'.\nI tried visual tools sush as IDEA and Eclipse, and I have similar result: there \nis a thread, which I can't suspend. I have no idea why this thread can't be \nsuspended, but I always saw such thread, when our server hung up.\n\nWe tried to find bug in your source, but we aren't familiar with your code and \nwe didn't find anything wrong. Now we run our server under Tomcat 4.0 and we \ndon't have such hang-up....", "time": "2002-10-08T05:04:10Z", "creator": "zakharov@scph.mipt.ru", "creation_time": "2002-10-08T05:04:10Z", "is_private": false}]