[{"count": 0, "tags": [], "bug_id": 3729, "attachment_id": null, "id": 5782, "time": "2001-09-19T13:12:33Z", "creator": "beem_r@crane.navy.mil", "creation_time": "2001-09-19T13:12:33Z", "is_private": false, "text": "I'm having the following problem only on Windows 2000 with Sun's JDK 1.4.  It \nworks with Windows NT 4.0 and Sun's JDK 1.3.1.\n\nMy JAVA_HOME and CATALINA_HOME environment variables are properly set.\n\nWhile running Tomcat 4 as a service on Windows 2000 I get the following error \nwhen accessing any JSP page that isn't already compiled:\n\njava.lang.NoClassDefFoundError: sun/tools/javac/Main\n\nI believe sun.tools.javac.Main is called while the JSP page is compiled, and is \ncontainted in C:\\jdk1.4\\lib\\tools.jar.\n\nFor testing, delete all the files and folders in the \"Apache Tomcat 4.0\\work\" \ndirectory to force a recompile of the JSP pages.\n\nWhen I run Tomcat 4 from the command line with startup.bat it tells me that \nC:\\jdk1.4\\lib\\tools.jar is included in the CLASSPATH and JSP pages compile and \nwork as expected.  If I start Tomcat 4 as a service it doesn't seem to be using \nthe same CLASSPATH or isn't finding C:\\jdk1.4\\lib\\tools.jar."}, {"count": 1, "text": "The Service deployment will ignore JAVA_HOME and CATALINA_HOME, and instead use \nwhat is in the Windows registry. My own installation with JDK 1.4 works fine.\n\nYou probably do not have the JDK or JRE properly installed, or you may have \nmoved it around.\n\nTo solve the problem, copy tools.jar to the common/lib folder of Tomcat 4. It \nis copied during installation, as a workaround for many limitations on various \nWindows platforms.\n\nYou can also use 'regedt32' and edit \nkey 'HKLM/SYSTEM/CurrentControlSet/Services/Apache Tomcat' to do further tweaks \nto the service installation.", "creator": "remm@apache.org", "is_private": false, "id": 5783, "time": "2001-09-19T13:24:38Z", "bug_id": 3729, "creation_time": "2001-09-19T13:24:38Z", "tags": [], "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 3729, "is_private": false, "count": 2, "id": 5830, "time": "2001-09-20T07:53:01Z", "creator": "beem_r@crane.navy.mil", "creation_time": "2001-09-20T07:53:01Z", "text": "The Tomcat 4.0 install script, jakarta-tomcat-4.0-src\\tomcat.nsi, references \nHKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit\\1.4\\JavaHome to copy \ntools.jar to the \"Apache Tomcat 4.0\\common\\lib\" folder.  If JavaHome doesn't \npoint to the JDK but to the JRE as in my case tools.jar won't get copied.  \nEither manually copy it there or correct the registry entry and reinstall \nTomcat.\n\nHere's the revelant secion of tomcat.nsi:\n\n  ReadRegStr $2 HKLM \"SOFTWARE\\JavaSoft\\Java Development Kit\\$1\" \"JavaHome\"\n\n  CopyFiles \"$2\\lib\\tools.jar\" \"$INSTDIR\\common\\lib\" 4500\n "}]