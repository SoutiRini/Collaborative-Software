[{"count": 0, "tags": [], "bug_id": 15375, "attachment_id": null, "text": "When modifying an Excel 2000 Spreadsheet to add extra rows and columns the code \ncompletes as expected but causes either an 'Unable to open file' message from \nExcel or for the spreadsheet to briefly flash on screen and then disappear.\n\nThe code that causes this problem is:\n\nString[][] accountCodes = dataHandler.getAcctCodeList(data.getCostCenter());\n        HSSFCell cell = null;\n        HSSFCellStyle cellStyle = null;\n        HSSFRow row = sheet.getRow(rowPos);\n        String[] accountCode = null;\n        int a = 0;\n        row = sheet.createRow((short)(rowPos));\n        cell = row.createCell((short)cellPos);\n        cell.setCellType(HSSFCell.CELL_TYPE_STRING);\n        cell.setCellStyle(headerStyle);\n        cell.setCellValue(\"Account Code (and description)\");\n        a++;\n        for(;(accountCodes != null) && (a<=accountCodes.length-1);a++){\n            accountCode = accountCodes[a];\n            //Fails when adding this row\n            row = sheet.createRow((short)(rowPos+a));\n            cell = row.createCell((short)cellPos);\n            cell.setCellType(HSSFCell.CELL_TYPE_STRING);\n            cell.setCellStyle(bodyStyle);\n            cell.setCellValue(accountCode[0] + \" - \" + accountCode[1]);\n        }\n        return a;\n\nThis is not a problem in 1.5.1", "id": 27838, "time": "2002-12-14T22:03:05Z", "creator": "greggarson@hotmail.com", "creation_time": "2002-12-14T22:03:05Z", "is_private": false}, {"count": 1, "tags": [], "creator": "greggarson@hotmail.com", "attachment_id": 4168, "id": 27839, "time": "2002-12-14T22:05:10Z", "bug_id": 15375, "creation_time": "2002-12-14T22:05:10Z", "is_private": false, "text": "Created attachment 4168\nThe file being modified that fails.  The code is attempting to modify the first sheet of this workbook."}, {"count": 2, "tags": [], "creator": "poi-support@buni.org", "attachment_id": null, "id": 27843, "time": "2002-12-15T04:05:16Z", "bug_id": 15375, "creation_time": "2002-12-15T04:05:16Z", "is_private": false, "text": "Give another code sample which is just a simple \"main\" class and is the least\namount of code required to replicate the problem.  I'm pretty suspicious of this\nbug."}, {"count": 3, "tags": [], "bug_id": 15375, "attachment_id": 4173, "text": "Created attachment 4173\nHere is the barebones version of the failing code.  With further testing i've found this code does work with POI 1.6 Dev but fails with all subsequent versions.", "id": 27855, "time": "2002-12-16T00:00:51Z", "creator": "greggarson@hotmail.com", "creation_time": "2002-12-16T00:00:51Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 15375, "attachment_id": null, "text": "This is failing for me as well using the 1.8.0 distribution.  I'm surprised, \nbecause my test case is *very* basic (using Excell 2000) and taken right from \nthe docs.\n\n    HSSFWorkbook wb = new HSSFWorkbook(fs);\n    HSSFSheet sheet = wb.getSheetAt(0);\n    \n    HSSFRow row = sheet.getRow(5);\n    HSSFCell cell = row.getCell((short)3);\n    if (cell == null)\n        cell = row.createCell((short)3);\n        \n        // Write test\n    cell.setCellType(HSSFCell.CELL_TYPE_STRING);\n    cell.setCellValue(\"a test\");\n\n", "id": 29354, "time": "2003-01-14T16:47:39Z", "creator": "chris.haddad@cobia.net", "creation_time": "2003-01-14T16:47:39Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 15375, "attachment_id": 4429, "text": "Created attachment 4429\noriginal xls file", "id": 29409, "time": "2003-01-15T16:53:30Z", "creator": "chris.haddad@cobia.net", "creation_time": "2003-01-15T16:53:30Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 15375, "attachment_id": 4430, "text": "Created attachment 4430\nfile corrupted by poi", "id": 29410, "time": "2003-01-15T16:54:05Z", "creator": "chris.haddad@cobia.net", "creation_time": "2003-01-15T16:54:05Z", "is_private": false}, {"count": 7, "tags": [], "creator": "chris.haddad@cobia.net", "attachment_id": null, "id": 29413, "time": "2003-01-15T16:57:48Z", "bug_id": 15375, "creation_time": "2003-01-15T16:57:48Z", "is_private": false, "text": "Here is the code that corrupts the xls file (1/15/03 16:53 attachment to this \nbug report) when using the 1.9.0 nightly build from 20030115:\n\n    public void poiXlsTest() {      \n      \n      try {\n    POIFSFileSystem fs      =\n            new POIFSFileSystem(new FileInputStream\n(\"/usr/local/data/dashView.xls\"));\n    HSSFWorkbook wb = new HSSFWorkbook(fs);\n    HSSFSheet sheet = wb.getSheetAt(0);\n    \n    HSSFRow row = sheet.getRow(5);\n    HSSFCell cell = row.getCell((short)3);\n    if (cell == null)\n        cell = row.createCell((short)3);\n        \n        // Write test\n    cell.setCellType(HSSFCell.CELL_TYPE_STRING);\n    cell.setCellValue(\"a test\");\n\n        // change existing numeric cell value\n    log.debug(\"change existing numeric cell\");\n    HSSFRow oRow = sheet.getRow(14);\n    HSSFCell oCell = oRow.getCell((short)4);\n    oCell.setCellValue(75);\n    oCell = oRow.getCell((short)5);\n    oCell.setCellValue(\"0.3\");\n    \n    // Write the output to a file\n    FileOutputStream fileOut = new FileOutputStream(\"/usr/local/data/dashView-\n1.xls\");\n    wb.write(fileOut);\n    fileOut.close();\n  }\n  catch (java.io.FileNotFoundException ex)\n  {\n    log.error(ex.getMessage());\n  }\n  catch (java.io.IOException ex)\n  {\n    log.error(ex.getMessage());\n  }\n  \n  }\n"}, {"count": 8, "tags": [], "bug_id": 15375, "attachment_id": null, "text": "Resubmit the ExcelTest in a simpler form.  As it stands I'd have to spend too\nmuch time tracing through your sample.  It appears this may indeed be a bug, but\nI can't rule out a bug in the sample.  When we say \"the simplest possible\nexample\" we envision a monolitic class with main() which does things clearly in\na linear fashion...   There is a little too much for me to grok in a limited\namount of time.  ", "id": 29418, "time": "2003-01-15T17:10:42Z", "creator": "poi-support@buni.org", "creation_time": "2003-01-15T17:10:42Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 15375, "attachment_id": null, "text": "new sample submitted by haddad should be adequate.  I'll take a look.", "id": 29420, "time": "2003-01-15T17:23:25Z", "creator": "poi-support@buni.org", "creation_time": "2003-01-15T17:23:25Z", "is_private": false}, {"count": 10, "tags": [], "creator": "chris.haddad@cobia.net", "attachment_id": 4435, "id": 29428, "time": "2003-01-15T17:45:41Z", "bug_id": 15375, "creation_time": "2003-01-15T17:45:41Z", "is_private": false, "text": "Created attachment 4435\nsample code with main() demonstrating the excel error when loading the file.  Excel 2000 9.0.4402 sr1 on w2k used."}, {"count": 11, "attachment_id": null, "creator": "tschafer@hotmail.com", "text": "I have tried:\njakarta-poi-1.8.0-dev-20020919.jar\njakarta-poi-1.10.0-dev-20030222.jar\npoi-2.0-pre1-20030517.jar\n\nIn each case using POI to modify (per example provided by Chris Haddad)\na blank (open Excel press save) spreadsheet created using each of:\nExcel 2000 (9.0.2720)\nExcel 2002 (10.2614.2625)\nresulted in a blank spreadsheet\n\nUsing other input spreadsheets of varying complexity would result in a corrupt\noutput spreadsheet\nBut generally the result spreadsheet appeared as if it had not been modified\n\nThis problem does not occur using jakarta-poi-1.5.1-final-20020615.jar", "id": 39111, "time": "2003-06-19T19:19:08Z", "bug_id": 15375, "creation_time": "2003-06-19T19:19:08Z", "tags": [], "is_private": false}, {"count": 12, "tags": [], "bug_id": 15375, "attachment_id": 7367, "text": "Created attachment 7367\nA small class that can simulate this error", "id": 40926, "time": "2003-07-18T09:19:07Z", "creator": "dandare100@yahoo.com", "creation_time": "2003-07-18T09:19:07Z", "is_private": false}, {"count": 13, "tags": [], "bug_id": 15375, "text": "I have a similar problem and have managed to simulate it with a small class.\nI think it has to do with string references?(See class)", "id": 40927, "time": "2003-07-18T09:23:08Z", "creator": "dandare100@yahoo.com", "creation_time": "2003-07-18T09:23:08Z", "is_private": false, "attachment_id": null}, {"count": 14, "tags": [], "bug_id": 15375, "attachment_id": null, "text": "Have you tried this with 2.0-pre2?  1.5.x will not get new fixes this close to a release.", "id": 40934, "time": "2003-07-18T12:50:54Z", "creator": "poi-support@buni.org", "creation_time": "2003-07-18T12:50:54Z", "is_private": false}, {"count": 15, "tags": [], "bug_id": 15375, "attachment_id": null, "text": "This fault only happens with 2.0-pre2. \n\nIt does not happen with jakarta-poi-1.5.1-final\n\n", "id": 41046, "time": "2003-07-21T06:06:44Z", "creator": "dandare100@yahoo.com", "creation_time": "2003-07-21T06:06:44Z", "is_private": false}, {"count": 16, "attachment_id": null, "creator": "dandare100@yahoo.com", "text": "I have noticed that (In my case) as soon as the SST table becomes very big this \nhappens.\n\nI can put thousands of strings into a spreadsheet as long as there are not too \nmany unique ones. As soon as there are plenty unique strings the sheet can't \nopen.\n\nUsing the BIFF Viewer, I see that CONTINUE RECORD's are written for the \nspreadsheet that can't open and none are written for a spreadsheet that can \nopen.\n\nFrom looking at the source (I am not sure though) it seems that these CONTINUE \nRECORDs are a major change between POI 1.5.1 and POI2.\n\nAm I on the wrong track ???", "id": 41278, "time": "2003-07-24T11:15:05Z", "bug_id": 15375, "creation_time": "2003-07-24T11:15:05Z", "tags": [], "is_private": false}, {"count": 17, "tags": [], "bug_id": 15375, "attachment_id": null, "text": "*** Bug 23445 has been marked as a duplicate of this bug. ***", "id": 45125, "time": "2003-10-06T09:40:11Z", "creator": "avik@apache.org", "creation_time": "2003-10-06T09:40:11Z", "is_private": false}, {"count": 18, "tags": [], "bug_id": 15375, "attachment_id": null, "text": "*** Bug 22568 has been marked as a duplicate of this bug. ***", "id": 45128, "time": "2003-10-06T09:46:57Z", "creator": "avik@apache.org", "creation_time": "2003-10-06T09:46:57Z", "is_private": false}, {"count": 19, "tags": [], "bug_id": 15375, "attachment_id": null, "text": "OK, This bug is now fixed thanks to Jason's SST/Continue record fixes. I would\nappreciate if some of the original reporters would try out a latest nightly or\nCVS build, and report if they can confirm the fix. We should do a release once\nwe get some more confirmation.   ", "id": 45142, "time": "2003-10-06T10:39:25Z", "creator": "avik@apache.org", "creation_time": "2003-10-06T10:39:25Z", "is_private": false}, {"count": 20, "tags": [], "creator": "jheight@apache.org", "text": "*** Bug 23628 has been marked as a duplicate of this bug. ***", "id": 45177, "time": "2003-10-06T22:09:23Z", "bug_id": 15375, "creation_time": "2003-10-06T22:09:23Z", "is_private": false, "attachment_id": null}, {"count": 21, "tags": [], "bug_id": 15375, "attachment_id": null, "text": "*** Bug 21646 has been marked as a duplicate of this bug. ***", "id": 45213, "time": "2003-10-07T15:58:06Z", "creator": "avik@apache.org", "creation_time": "2003-10-07T15:58:06Z", "is_private": false}, {"count": 22, "tags": [], "bug_id": 15375, "attachment_id": null, "text": "I tried a build from CVS and can confirm that it fixes the problem I was \nhaving. Fantastic!\n\nA speedy release would be *very* much appreciated!", "id": 45251, "time": "2003-10-08T15:10:08Z", "creator": "rmlowe@rmlowe.com", "creation_time": "2003-10-08T15:10:08Z", "is_private": false}, {"count": 23, "tags": [], "bug_id": 15375, "text": "Cool. Big round of applause for Jason!\n\nClosing this bug. Please reopen with testcase if you still have a problem.\nBefore you do, please check test15375, test15375_2, and test22568 in\nTestBugs.java, which are the proof that this bug is fixed. ", "id": 45255, "time": "2003-10-08T18:11:10Z", "creator": "avik@apache.org", "creation_time": "2003-10-08T18:11:10Z", "is_private": false, "attachment_id": null}, {"count": 24, "tags": [], "creator": "RStrydom@Zarafin.com", "text": "Big round of applause for Jeff who actually found the problem with the continue \nrecords! Nice going boet.\n", "id": 45471, "time": "2003-10-13T08:35:09Z", "bug_id": 15375, "creation_time": "2003-10-13T08:35:09Z", "is_private": false, "attachment_id": null}, {"count": 25, "attachment_id": null, "creator": "avik@apache.org", "text": "*** Bug 21305 has been marked as a duplicate of this bug. ***", "id": 46545, "time": "2003-10-30T19:01:03Z", "bug_id": 15375, "creation_time": "2003-10-30T19:01:03Z", "tags": [], "is_private": false}, {"count": 26, "tags": [], "creator": "avik@apache.org", "attachment_id": null, "id": 46689, "time": "2003-11-03T17:54:22Z", "bug_id": 15375, "creation_time": "2003-11-03T17:54:22Z", "is_private": false, "text": "*** Bug 24355 has been marked as a duplicate of this bug. ***"}]