[{"count": 0, "tags": [], "bug_id": 1228, "attachment_id": null, "is_private": false, "id": 1744, "time": "2001-04-05T03:08:42Z", "creator": "gregor.karlinger@gmx.net", "creation_time": "2001-04-05T03:08:42Z", "text": "With validation switched on, Xerces does some \"normalization\" of\na text which is validated against the binary/base64 type. Take\nthe following example:\n\nSchema:\n\n  <xsd:element name=\"Root\">\n    <xsd:simpleType>\n      <xsd:restriction base=\"xsd:binary\">\n        <xsd:encoding value=\"base64\"/>\n      </xsd:restriction>\n    </xsd:simpleType>\n  </xsd:element>\n\nInstance file:\n\n<Root>\n  MIIDNzCCAvWgAwIBAgIEOd3+kDAJBgcqhkjOOAQDMFsxCzAJBgNVBAYTAklFMQ8w\n  9LAKPklQ/74fH18=\n</Root>\n\nAfter creation of a DOM document using the validating Xerces parser,\ntestDoc.getDocumentElement().getFirstChild().getValue() yields:\n\n\"MIIDNzCCAvWgAwIBAgIEOd3+kDAJBgcqhkjOOAQDMFsxCzAJBgNVBAYTAklFMQ8w \n9LAKPklQ/74fH18=\"\n\ninstead of the origninal value\n\n\"\n  MIIDNzCCAvWgAwIBAgIEOd3+kDAJBgcqhkjOOAQDMFsxCzAJBgNVBAYTAklFMQ8w\n  9LAKPklQ/74fH18=\n\"\n\nThis behaviour leads to big problems in the context of XML signatures,\nsince the original physical representation is changed by the parser\nduring validation."}, {"count": 1, "tags": [], "text": "whiteSpace facet value is collapsed for base64Binary. Thus, xerces does the \nright thing.\n\nFor more info see:  \nhttp://www.w3.org/TR/xmlschema-1/#section-White-Space-Normalization-during-Valid\nation", "attachment_id": null, "id": 2864, "creator": "elena@apache.org", "time": "2001-06-11T09:53:12Z", "bug_id": 1228, "creation_time": "2001-06-11T09:53:12Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 1228, "attachment_id": null, "is_private": false, "id": 5107, "time": "2001-09-04T23:01:07Z", "creator": "gregor.karlinger@gmx.net", "creation_time": "2001-09-04T23:01:07Z", "text": "After extensive discussion in the joint IETF and W3C XML-Signature working\ngroup I have been asked by the WG chair Joseph Reagle to reopen this bug:\n\nAs already described in the original bug report, Xerces provides the \n\"normalized\" value for an element content of type base64 instead of the\n\"initial\" value in its DOM interface after validating parsing (the terms\n\"normalized\" and \"initial\" are used as defined in XML Schema Part 1: \nStructures, section 3.1.4).\n\nAccording to XML Schema Part 1: Structures, Conformant XML Schema \nprocessors add a [schema normalized value] property to element info \nitems validated with simple type definitions.\n\nBut they do NOT make any changes to the input information set (see\nAppendix D of XML Schema Part 1: Structures).\n\nSo this behaviour of Xerces is not XML Schema conformant and has to\nbe classified as a bug.\n\nOur opinion is also supported by Henry S. Thompson, chair of the W3C\nXML Schema WG.\n\nRegards,\nGregor Karlinger\n(On behalf of the XML-Signature WG)\n"}, {"count": 3, "tags": [], "creator": "kent@hauN.org", "text": "Created attachment 681\nA patch against xerces1 to solve this problem", "id": 6782, "time": "2001-10-17T02:35:44Z", "bug_id": 1228, "creation_time": "2001-10-17T02:35:44Z", "is_private": false, "attachment_id": 681}, {"count": 4, "tags": [], "creator": "kent@hauN.org", "attachment_id": null, "text": "I have added a patch to solve this problem.\nIt introduces new feature \".../validation/normalize-element-contents\".\nThe default value of the feature is true (compatible to 1.4.3).\n", "id": 6783, "time": "2001-10-17T02:38:46Z", "bug_id": 1228, "creation_time": "2001-10-17T02:38:46Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 1228, "attachment_id": null, "is_private": false, "id": 9801, "time": "2002-01-23T11:13:03Z", "creator": "gregor.karlinger@gmx.net", "creation_time": "2002-01-23T11:13:03Z", "text": "The feature \".../validation/normalize-element-contents\" is not included in \nXerces 1.4.4. \n\nSo, has this issue been resolved in another way, or must it still be considered \nopen?"}, {"count": 6, "tags": [], "text": "What is new in this issue? Why is still open?\nI found that \".../validation/normalize-element-contents\" feature doesn't work \nin 2.4.0 (in SAX) and I found another one that \nworks: \".../validation/schema/normalized-value\". Is this correct? Why xerces \nprovides by default normalized instead of initial value?", "attachment_id": null, "bug_id": 1228, "id": 37905, "time": "2003-05-28T07:58:31Z", "creator": "vojtech.habarta@seznam.cz", "creation_time": "2003-05-28T07:58:31Z", "is_private": false}, {"count": 7, "tags": [], "text": "> What is new in this issue? Why is still open?\nIt is still open since we are no longer supporting Xerces 1.4.4 so all the bugs \nare left as is...\nYou are right -- you should turn off the \"\".../validation/schema/normalized-\nvalue\" feature to get initial values instead of schema normalized ones. \nThe defaut is set to true to make *smooth* transition between DTDs and XML \nSchemas: imagine someone had a DTD with bunch of ID attributes, they convert \nthe schema to XML Schema and suddenly all their code is broken since ID \nattributes are no longer normalized.\n\nAnyway, to make it work just turn it off.\n", "attachment_id": null, "id": 37943, "creator": "elena@apache.org", "time": "2003-05-28T20:10:56Z", "bug_id": 1228, "creation_time": "2003-05-28T20:10:56Z", "is_private": false}]