[{"count": 0, "tags": [], "bug_id": 60343, "attachment_id": null, "id": 194821, "time": "2016-11-04T16:13:51Z", "creator": "tallison@mitre.org", "creation_time": "2016-11-04T16:13:51Z", "is_private": false, "text": "On TIKA-2155, Seva Alekseyev supplied an xlsx that triggers an index out of bounds exception when trying to get a style from the StylesTable.  I haven't tried to open the file in Excel, but Seva has opened it.  The offending value in sheet67.xml is: <c r=\"L95\" s=\"65535\"/>... truly a bad value.\n\nStack:\n\njava.lang.IndexOutOfBoundsException: Index: 65535, Size: 251\n\n\tat java.util.ArrayList.rangeCheck(ArrayList.java:653)\n\tat java.util.ArrayList.get(ArrayList.java:429)\n\tat org.apache.poi.xssf.model.StylesTable.getStyleAt(StylesTable.java:421)\n\tat org.apache.poi.xssf.eventusermodel.XSSFSheetXMLHandler.startElement(XSSFSheetXMLHandler.java:282)\n\nMy inclination is to add bounds checking to StylesTable and return null if a style is requested outside of the list range.  I'll leave this open for a few days to make sure there are no objections from colleagues that this is making the parser too lax."}, {"count": 1, "tags": [], "bug_id": 60343, "attachment_id": null, "text": "r1770848\n\nStylesTable now returns null if idx is out of bounds.  This is a change in behavior, and I had to modify tests for bug49702 in TestXSSFWorkbook.\n\nI'm happy to revert to old behavior in StylesTable as long as we protect against AIOOBE higher up the stack, perhaps in XSSFSheetXMLHandler?", "id": 195145, "time": "2016-11-22T14:51:46Z", "creator": "tallison@mitre.org", "creation_time": "2016-11-22T14:51:46Z", "is_private": false}]