[{"count": 0, "tags": [], "bug_id": 55149, "is_private": false, "text": "When using POI 3.9 with Apache Tomcat 6, to load, manipulate and save XLSX worksheets, the following messages appear in catalina.out when stopping Tomcat using $CATALINA_HOME/bin/shutdown.sh --> this looks like a memory leak.\n\nSEVERE: The web application [/foobar] created a ThreadLocal with key of type [org.apache.xmlbeans.XmlBeans$1] (value [org.apache.xmlbeans.XmlBeans$1@7d3aace]) and a value of type [java.lang.ref.SoftReference] (value [java.lang.ref.SoftReference@5972be65]) but failed to remove it when the web application was stopped. This is very likely to create a memory leak.\nJun 26, 2013 7:01:56 PM org.apache.catalina.loader.WebappClassLoader clearThreadLocalMap\nSEVERE: The web application [/foobar] created a ThreadLocal with key of type [org.apache.xmlbeans.impl.schema.SchemaTypeLoaderImpl$1] (value [org.apache.xmlbeans.impl.schema.SchemaTypeLoaderImpl$1@7c3206c3]) and a value of type [java.util.ArrayList] (value [[java.lang.ref.SoftReference@385a2be8]]) but failed to remove it when the web application was stopped. This is very likely to create a memory leak.\nJun 26, 2013 7:01:56 PM org.apache.catalina.loader.WebappClassLoader clearThreadLocalMap\nSEVERE: The web application [/foobar] created a ThreadLocal with key of type [org.apache.xmlbeans.impl.store.Locale$1] (value [org.apache.xmlbeans.impl.store.Locale$1@27f8a93f]) and a value of type [java.lang.ref.SoftReference] (value [java.lang.ref.SoftReference@362f7b99]) but failed to remove it when the web application was stopped. This is very likely to create a memory leak.\nJun 26, 2013 7:01:56 PM org.apache.catalina.loader.WebappClassLoader clearThreadLocalMap\nSEVERE: The web application [/foobar] created a ThreadLocal with key of type [org.apache.xmlbeans.impl.store.CharUtil$1] (value [org.apache.xmlbeans.impl.store.CharUtil$1@675b9599]) and a value of type [java.lang.ref.SoftReference] (value [java.lang.ref.SoftReference@2dbaa4d2]) but failed to remove it when the web application was stopped. This is very likely to create a memory leak.", "id": 168087, "time": "2013-06-26T22:58:59Z", "creator": "brown@reflexe.fr", "creation_time": "2013-06-26T22:58:59Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "This looks like it might well be a problem with Apache XMLBeans, on which POI is based. I'm minded to say you should ask them for help first, to see if they have any ideas about why the thread locals are being created", "id": 168088, "time": "2013-06-27T00:14:30Z", "bug_id": 55149, "creation_time": "2013-06-27T00:14:30Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 55149, "is_private": false, "text": "I h", "id": 168091, "time": "2013-06-27T07:28:00Z", "creator": "brown@reflexe.fr", "creation_time": "2013-06-27T07:28:00Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 55149, "attachment_id": null, "text": "I have created issue:\nhttps://issues.apache.org/jira/browse/XMLBEANS-502", "id": 168092, "time": "2013-06-27T07:28:37Z", "creator": "brown@reflexe.fr", "creation_time": "2013-06-27T07:28:37Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 55149, "text": "handled by xmlbeans directly", "id": 169175, "time": "2013-08-06T09:41:15Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2013-08-06T09:41:15Z", "is_private": false, "attachment_id": null}]