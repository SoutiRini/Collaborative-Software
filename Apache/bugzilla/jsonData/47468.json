[{"count": 0, "attachment_id": 23922, "bug_id": 47468, "is_private": false, "id": 128483, "time": "2009-07-02T07:50:29Z", "creator": "roberto.manicardi@gmail.com", "creation_time": "2009-07-02T07:50:29Z", "tags": [], "text": "Created attachment 23922\nXLSX file with a single xml cell custom xml mapping\n\nto use the Custom XML Mapping an XML Schema is saved in the .xlsx  \nfile. I would like to access to this schema using the ooxml-schema API  \nbut I can't find any useful accessor method.\n\n\nAn example of the xml where the schema is saved is the following:\n\n\n<MapInfo>\n  <Schema ID=\"Schema1\" >\n   <xsd:schema xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns=\"\">\n   ...\n  </xsd:schema>\n  </Schema>\n...\n</MapInfo>\n\n\nThe Schema element is of complex type CT_Schema\n\n<complexType name=\"CT_Schema\">\n   <sequence>\n    <any/>\n   </sequence>\n   <attribute name=\"ID\" type=\"xsd:string\" use=\"required\"/>\n   <attribute name=\"SchemaRef\" type=\"xsd:string\" use=\"optional\"/>\n   <attribute name=\"Namespace\" type=\"xsd:string\" use=\"optional\"/>\n</complexType>\n\nso to access to the schema I need to navigate the <any/> part of the  \nxml.\n\nThe complex type CT_Schema is mapped to the class CTSchema which has  \nonly the getID(),getNamsepace() and getSchemaRef() methods and there  \nis no way to access to the <any/> part of the xml.\n\nAccording to this (http://xmlbeans.apache.org/docs/2.0.0/guide/conHandlingAny.html \n) there should be also a getArrayofany() method. I think there must be  \nan option to tell XMLBeans to generate the accessor method also for  \nthe <any/> node.\nHave you any clue on how to enable this?"}, {"count": 1, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "is_private": false, "id": 128624, "time": "2009-07-07T22:59:05Z", "bug_id": 47468, "creation_time": "2009-07-07T22:59:05Z", "text": "Roberto,\n\nThere are two ways how you can access XML that does not have a getXXX() accessor:\n\n (1) Grab the DOM node and navigate using the DOM API:\n   Node node = xmlobject.getDomNode();\n   NodeList ch = node.getChildNodes();\n   ...etc.\n\n (2) Use built-in support for XPath.  The XmlBeans API uses a dialect of XPath, please consult http://xmlbeans.apache.org/ for further details. \nBelow is a sample code that reads xsd from the attached file:\n\n        XSSFWorkbook wb = new XSSFWorkbook(\"CustomXMLMappings.xlsx\");\n        List<POIXMLDocumentPart> rel = wb.getRelations();\n        for(POIXMLDocumentPart p : rel){\n            if(\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/xmlMaps\".\n                    equals(p.getPackageRelationship().getRelationshipType())){\n\n\n                InputStream is = p.getPackagePart().getInputStream();\n                CTSchema ct = CTSchema.Factory.parse(is);\n\n                //select XML tree for the  schema\n                String query =\n                    \"declare namespace w='http://schemas.openxmlformats.org/spreadsheetml/2006/main';\" +\n                    \"$this/w:MapInfo/w:Schema\";\n\n                XmlObject[] o = ct.selectPath(query);\n                for (XmlObject xsd : o){\n                    XmlCursor cur = xsd.newCursor();\n                    cur.selectPath(\"./*/*\");\n                    while (cur.toNextSelection()) {\n                        XmlObject ch = cur.getObject();\n                        System.out.println(ch);\n                    }\n                }\n            }\n        }\n\nRegards,\nYegor"}]