[{"count": 0, "tags": [], "bug_id": 38240, "attachment_id": null, "text": "Multiple Include directives in httpd.conf can cause a segfault on \nsubsequent apachectl graceful or restart. Usually happens during \nthe second or third graceful.\n\nHere is a snippet from my config:\n\nInclude /export/kinetic/conf/apache/204.185.42.123/*.conf\nInclude /export/kinetic/conf/apache/204.185.42.129/*.conf\nInclude /export/kinetic/conf/apache/204.185.42.200/*.conf\nInclude etc/apache2/Includes/*.conf", "id": 84536, "time": "2006-01-12T16:48:50Z", "creator": "glenn@apache.org", "creation_time": "2006-01-12T16:48:50Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "slive@apache.org", "text": "Could you please supply a backtrace as discussed here:\nhttp://httpd.apache.org/dev/debugging.html#crashes", "count": 1, "id": 84548, "time": "2006-01-12T18:04:17Z", "bug_id": 38240, "creation_time": "2006-01-12T18:04:17Z", "is_private": false}, {"count": 2, "tags": [], "text": "I had to reinstall apache WITH_DEBUG. I then reproduced the bug and\ngenerated a core file. Here is the backtrace:\n\n#0  0x284da9fd in ?? () from /usr/lib/libpthread.so.1\n#1  0x0000000a in ?? ()\n#2  0x081416d0 in ?? ()\n#3  0x00001000 in ?? ()\n#4  0x28335240 in apr_file_read (thefile=0xbfbfe730, buf=0x2000000,\nnbytes=0x8142c28)\n    at readwrite.c:32\n#5  0x08069182 in ap_process_resource_config (s=0x80a8df8, \n    fname=0x8142bb0 \"/export/kinetic/conf/apache/204.185.42.123/*.conf\", \n    conftree=0xbfbfe7d4, p=0x80a7018, ptemp=0x8122018) at config.c:1598\n#6  0x0807cb9f in include_config (cmd=0xbfbfea30, dummy=0xbfbfe8a8, \n    name=0x8142b78 \"/export/kinetic/conf/apache/204.185.42.123/*.conf\") at\ncore.c:2392\n#7  0x0806766a in invoke_cmd (cmd=0x80958c0, parms=0xbfbfea30, mconfig=0xbfbfe8a8, \n    args=0x80d8051 \"\") at config.c:692\n#8  0x08068a57 in execute_now (cmd_line=0x8142b10 \"Include\", \n    args=0x80d8020 \"/export/kinetic/conf/apache/204.185.42.123/*.conf\", \n    parms=0xbfbfea30, p=0x80a7018, ptemp=0x8122018, sub_tree=0xbfbfe8a8, parent=0x0)\n    at config.c:1335\n#9  0x08068085 in ap_build_config_sub (p=0x80a7018, temp_pool=0x8122018, \n    l=0x80d8018 \"Include /export/kinetic/conf/apache/204.185.42.123/*.conf\", \n    parms=0xbfbfea30, current=0xbfbfe904, curr_parent=0xbfbfe900,\nconftree=0x809bed4)\n    at config.c:914\n#10 0x08068599 in ap_build_config (parms=0xbfbfea30, p=0x80a7018,\ntemp_pool=0x8122018, \n    conftree=0x809bed4) at config.c:1127\n#11 0x08068eb8 in process_resource_config_nofnmatch (s=0x80a8df8, \n    fname=0x81117a0 \"/usr/local/etc/apache2/httpd.conf\", conftree=0x809bed4, \n    p=0x80a7018, ptemp=0x8122018, depth=0) at config.c:1513\n#12 0x08068fc3 in ap_process_resource_config (s=0x80a8df8, \n    fname=0x81117a0 \"/usr/local/etc/apache2/httpd.conf\", conftree=0x809bed4, \n    p=0x80a7018, ptemp=0x8122018) at config.c:1549\n#13 0x08069a8f in ap_read_config (process=0x80a5090, ptemp=0x8122018, \n    filename=0x8091918 \"etc/apache2/httpd.conf\", conftree=0x809bed4) at\nconfig.c:1892\n#14 0x0806c2c1 in main (argc=2, argv=0xbfbfecdc) at main.c:609\n", "attachment_id": null, "id": 84561, "creator": "glenn@apache.org", "time": "2006-01-12T20:32:38Z", "bug_id": 38240, "creation_time": "2006-01-12T20:32:38Z", "is_private": false}, {"count": 3, "tags": [], "text": "(In reply to comment #2)\n> I had to reinstall apache WITH_DEBUG. I then reproduced the bug and\n> generated a core file. Here is the backtrace:\n> \n> #0  0x284da9fd in ?? () from /usr/lib/libpthread.so.1\n> #1  0x0000000a in ?? ()\n> #2  0x081416d0 in ?? ()\n> #3  0x00001000 in ?? ()\n> #4  0x28335240 in apr_file_read (thefile=0xbfbfe730, buf=0x2000000,\n> nbytes=0x8142c28)\n>     at readwrite.c:32\n\nThe addresses in #3 and #1 look really bad. Furthermore line 32 of readwrite.c\nis the beginning of the function apr_file_read. There is no real code apart from\n\"{\" there.\nWhich version of FreeBSD are you using?\nI saw discussions on the dev list about problems with FreeBSD and threads.\nAs I have no experience with FreeBSD, some FreeBSD expert here to the rescue please.\n", "is_private": false, "id": 84571, "creator": "rpluem@apache.org", "time": "2006-01-12T22:43:49Z", "bug_id": 38240, "creation_time": "2006-01-12T22:43:49Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 38240, "text": "Is /export a NFS mount?", "id": 84573, "time": "2006-01-12T23:05:00Z", "creator": "chip@force-elite.com", "creation_time": "2006-01-12T23:05:00Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 38240, "is_private": false, "text": "FreeBSD 5.3-RELEASE-p20, prefork MPM.\n\n/export is local but shared via NFS.\n\n# httpd -V\nServer version: Apache/2.0.55\nServer built:   Jan 12 2006 13:17:46\nServer's Module Magic Number: 20020903:11\nArchitecture:   32-bit\nServer compiled with....\n -D APACHE_MPM_DIR=\"server/mpm/prefork\"\n -D APR_HAS_SENDFILE\n -D APR_HAS_MMAP\n -D APR_HAVE_IPV6 (IPv4-mapped addresses enabled)\n -D APR_USE_FLOCK_SERIALIZE\n -D SINGLE_LISTEN_UNSERIALIZED_ACCEPT\n -D APR_HAS_OTHER_CHILD\n -D AP_HAVE_RELIABLE_PIPED_LOGS\n -D HTTPD_ROOT=\"/usr/local\"\n -D SUEXEC_BIN=\"/usr/local/bin/suexec\"\n -D DEFAULT_PIDLOG=\"/var/run/httpd.pid\"\n -D DEFAULT_SCOREBOARD=\"/var/run/apache_runtime_status\"\n -D DEFAULT_LOCKFILE=\"/var/run/accept.lock\"\n -D DEFAULT_ERRORLOG=\"/var/log/httpd-error.log\"\n -D AP_TYPES_CONFIG_FILE=\"etc/apache2/mime.types\"\n -D SERVER_CONFIG_FILE=\"etc/apache2/httpd.conf\"\n", "id": 84575, "time": "2006-01-12T23:27:31Z", "creator": "glenn@apache.org", "creation_time": "2006-01-12T23:27:31Z", "attachment_id": null}, {"count": 6, "tags": [], "text": "Is this still an issue in recent versions?", "attachment_id": null, "id": 108174, "creator": "slive@apache.org", "time": "2007-09-13T13:32:25Z", "bug_id": 38240, "creation_time": "2007-09-13T13:32:25Z", "is_private": false}, {"count": 7, "tags": [], "text": "CC myself on FreeBSD related bugs", "is_private": false, "id": 124154, "creator": "pgollucci@apache.org", "time": "2009-01-18T16:19:13Z", "bug_id": 38240, "creation_time": "2009-01-18T16:19:13Z", "attachment_id": null}]