[{"count": 0, "tags": [], "creator": "jmm@sublogic.com", "text": "WriterAppender and TelnetAppender both do the right thing in their subAppend \nmethods if the layout ignores throwable - they write/append the lines with line \nseparators.  Unfortunately, SMTPAppender and NTEventLogAppender do not, leaving \ntheir stack traces (I'm using SMTPAppender) a jumbled mess that's very \ndifficult to deal with.\n\nThe fix is just adding a couple of append's of Layout.LINE_SEP like the other 2 \nappenders already do, I'll go ahead and attach a patch as well although it's \nlikely just as easy to type in the lines than apply the patch\n\n/cygdrive/c/jakarta-log4j-1.2.8/src/java/org/apache/log4j> grep -A8 -ir \nlayout.ignoresThrowable .\n./net/SMTPAppender.java:        if(layout.ignoresThrowable()) {\n./net/SMTPAppender.java-          String[] s = event.getThrowableStrRep();\n./net/SMTPAppender.java-          if (s != null) {\n./net/SMTPAppender.java-            for(int j = 0; j < s.length; j++) {\n./net/SMTPAppender.java-              sbuf.append(s[j]);\n./net/SMTPAppender.java-            }\n./net/SMTPAppender.java-          }\n./net/SMTPAppender.java-        }\n./net/SMTPAppender.java-      }\n--\n./net/TelnetAppender.java:    if(layout.ignoresThrowable()) {\n./net/TelnetAppender.java-      String[] s = event.getThrowableStrRep();\n./net/TelnetAppender.java-      if (s != null) {\n./net/TelnetAppender.java-      int len = s.length;\n./net/TelnetAppender.java-      for(int i = 0; i < len; i++) {\n./net/TelnetAppender.java-        sh.send(s[i]);\n./net/TelnetAppender.java-        sh.send(Layout.LINE_SEP);\n./net/TelnetAppender.java-      }\n./net/TelnetAppender.java-      }\n--\n./nt/NTEventLogAppender.java:    if(layout.ignoresThrowable()) {\n./nt/NTEventLogAppender.java-      String[] s = event.getThrowableStrRep();\n./nt/NTEventLogAppender.java-      if (s != null) {\n./nt/NTEventLogAppender.java-   int len = s.length;\n./nt/NTEventLogAppender.java-   for(int i = 0; i < len; i++) {\n./nt/NTEventLogAppender.java-     sbuf.append(s[i]);\n./nt/NTEventLogAppender.java-   }\n./nt/NTEventLogAppender.java-      }\n./nt/NTEventLogAppender.java-    }\n--\n./WriterAppender.java:    if(layout.ignoresThrowable()) {\n./WriterAppender.java-      String[] s = event.getThrowableStrRep();\n./WriterAppender.java-      if (s != null) {\n./WriterAppender.java-  int len = s.length;\n./WriterAppender.java-  for(int i = 0; i < len; i++) {\n./WriterAppender.java-    this.qw.write(s[i]);\n./WriterAppender.java-    this.qw.write(Layout.LINE_SEP);\n./WriterAppender.java-  }\n./WriterAppender.java-      }", "id": 44271, "time": "2003-09-17T18:36:39Z", "bug_id": 23221, "creation_time": "2003-09-17T18:36:39Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 23221, "attachment_id": null, "is_private": false, "id": 44272, "time": "2003-09-17T18:37:12Z", "creator": "jmm@sublogic.com", "creation_time": "2003-09-17T18:37:12Z", "text": "FWIW, this is in 1.2.8, although I'm guessing the bug goes back further than \nthat"}, {"count": 2, "tags": [], "bug_id": 23221, "attachment_id": 8258, "is_private": false, "id": 44273, "time": "2003-09-17T18:37:59Z", "creator": "jmm@sublogic.com", "creation_time": "2003-09-17T18:37:59Z", "text": "Created attachment 8258\nsimple fix to add newlines to throwable printouts"}, {"count": 3, "text": "Created attachment 8289\nbetter patch, includes required import for SMTPAppender to build", "bug_id": 23221, "is_private": false, "id": 44341, "time": "2003-09-19T13:38:57Z", "creator": "jmm@sublogic.com", "creation_time": "2003-09-19T13:38:57Z", "tags": [], "attachment_id": 8289}]