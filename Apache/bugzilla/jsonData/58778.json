[{"count": 0, "tags": [], "creator": "onealj@apache.org", "text": "It looks like POI cannot override a built-in number format. The workbook must have been saved (by Excel) with an overridden built-in number format.\n\nFrom http://svn.apache.org/viewvc/poi/trunk/src/ooxml/testcases/org/apache/poi/xssf/usermodel/TestXSSFDataFormat.java?revision=1721923&view=markup#l35\n> global String poundFmt = \"\\\"\\u00a3\\\"#,##0;[Red]\\\\-\\\"\\u00a3\\\"#,##0\";\n> global short expectedPoundFmtIdx = 6;\n> // Read in a workbook where a currency format has been overridden to use the \u00a3 symbol in place of the $ symbol. The default built-in format is \"$#,##0_);[Red]($#,##0)\"\n> XSSFWorkbook wb = XSSFTestDataSamples.openSampleWorkbook(\"49928.xlsx\"); \n> DataFormat dataFormat = wb.createDataFormat();\n> short poundFmtIdx = wb.getSheetAt(0).getRow(0).getCell(0).getCellStyle().getDataFormat();\n> assertEquals(poundFmtIdx, dataFormat.getFormat(poundFmt));\n\nThis could be fixed by adding\nvoid XSSFDataFormat#putFormat(int index, String format).\nAm I correct that it isn't possible to override custom data formats in XSSFWorkbooks in POI?\n\nI'm also curious why the built-in formats don't have a leading opening parentheses. Seems like they should match up. If so, that could be a different bug.", "id": 187193, "time": "2015-12-28T23:07:36Z", "bug_id": 58778, "creation_time": "2015-12-28T23:07:36Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 58778, "attachment_id": null, "text": "Patch applied in r1722043.\nDocs updated in r1722044.\n\nPlease revert this patch if there is already a way to override built-in number formats in POI.", "id": 187195, "time": "2015-12-29T00:19:45Z", "creator": "onealj@apache.org", "creation_time": "2015-12-29T00:19:45Z", "is_private": false}]