[{"count": 0, "tags": [], "bug_id": 30870, "attachment_id": null, "id": 62547, "time": "2004-08-26T15:54:11Z", "creator": "tony.perkins@sabre.com", "creation_time": "2004-08-26T15:54:11Z", "is_private": false, "text": "If cookieValue (indicated at >>>) is null the code will continue in an endless\nloop. This has caused two of our servers to go to 99% cpu on the tomcat process.\n\n public  void processCookies( MimeHeaders headers ) {\n\tif( headers==null )\n\t    return;// nothing to process\n\t// process each \"cookie\" header\n\tint pos=0;\n\twhile( pos>=0 ) {\n\t    // Cookie2: version ? not needed\n\t    pos=headers.findHeader( \"Cookie\", pos );\n\t    // no more cookie headers headers\n\t    if( pos<0 ) break;\n\n>>>\t    MessageBytes cookieValue=headers.getValue( pos );\n\t    if( cookieValue==null || cookieValue.isNull() ) continue;\n\n\t    // Uncomment to test the new parsing code\n\t    if( cookieValue.getType() == MessageBytes.T_BYTES ) {\n\t\tif( dbg>0 ) log( \"Parsing b[]: \" + cookieValue.toString());\n\t\tByteChunk bc=cookieValue.getByteChunk();\n\t\tprocessCookieHeader( bc.getBytes(),\n\t\t\t\t     bc.getOffset(),\n\t\t\t\t     bc.getLength());\n\t    } else {\n\t\tif( dbg>0 ) log( \"Parsing S: \" + cookieValue.toString());\n\t\tprocessCookieHeader( cookieValue.toString() );\n\t    }\n\t    pos++;// search from the next position\n\t}\n    }\n\n\nShould be something like:\n\nif( cookieValue==null || cookieValue.isNull() ){\n  pos++;\n  continue;\n}"}, {"attachment_id": null, "tags": [], "bug_id": 30870, "is_private": false, "count": 1, "id": 62556, "time": "2004-08-26T19:33:19Z", "creator": "markt@apache.org", "creation_time": "2004-08-26T19:33:19Z", "text": "Fixed in CVS. Thanks for reporting."}]