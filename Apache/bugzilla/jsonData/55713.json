[{"count": 0, "tags": [], "bug_id": 55713, "attachment_id": null, "is_private": false, "id": 170878, "time": "2013-10-28T13:56:46Z", "creator": "evingot@informatica.com", "creation_time": "2013-10-28T13:56:46Z", "text": "When reading XLSX files with data validations.\nDataValidation.getErrorStyle() always returns 1 (warning)\nDataValidation.getEmptyCellAllowed() always returns true.\n\nChecked in 3.7 and 3.9 for XSSFSheet."}, {"count": 1, "tags": [], "bug_id": 55713, "text": "Any chance you could produce a short unit test that shows the problem? For example, a small file with a few different validations in it, some valid and some not, along with a short bit of POI code that tries to read and assert them?", "id": 171137, "time": "2013-11-07T22:51:41Z", "creator": "apache@gagravarr.org", "creation_time": "2013-11-07T22:51:41Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 55713, "attachment_id": null, "id": 185190, "time": "2015-09-13T18:39:37Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-09-13T18:39:37Z", "is_private": false, "text": "No response for a long time, therefore closing this as WONTFIX as we do not have a file/unit test which reproduces the issue.\nPlease reopen this bug with more information if you still see this problem with a more recent version of POI."}, {"count": 3, "tags": [], "bug_id": 55713, "attachment_id": 35696, "is_private": false, "id": 203480, "time": "2018-01-25T13:55:44Z", "creator": "Phili0815@gmx.de", "creation_time": "2018-01-25T13:55:44Z", "text": "Created attachment 35696\nCode and Example XLSX"}, {"count": 4, "tags": [], "text": "I can confirm the problem with the errorStyle.\n\nI you have a data validation with errorStyle = STOP, then DataValidation.getErrorStyle() will return WARNING. I added an example and junit test showing the problem.\n\nI looked into the .xslx file internals and noticed that Excel does not save the errorStyle attribute in the XML schema if the errorStyle equals STOP. So it seems that the default value for errorStyle is wrong.\n\n\nDataValidation.getEmptyCellAllowed() seems to work fine for me. I think the problem is the name which is quite missleading compared to the Excel UI.\nAt least in the German Excel the attribute \"emptyCellAllowed = true\" equals to the option \"ignore empty cells\". \n\nI think this is because the Excel UI wants to tell me something like \"we won't check empty cells\" but the implementation defines it like \"empty cells are always valid\".", "attachment_id": null, "bug_id": 55713, "id": 203481, "time": "2018-01-25T14:04:51Z", "creator": "Phili0815@gmx.de", "creation_time": "2018-01-25T14:04:51Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "fanningpj@yahoo.com", "is_private": false, "count": 5, "id": 203576, "time": "2018-01-31T00:02:29Z", "bug_id": 55713, "creation_time": "2018-01-31T00:02:29Z", "text": "Fix from https://github.com/apache/poi/pull/95 was merged - https://svn.apache.org/viewvc?view=revision&revision=1822719"}]