[{"count": 0, "tags": [], "creator": "julien.ayme@gmail.com", "attachment_id": null, "text": "When writing a HSSFWorkbook containing a HSSFSheet with an empty HSSFRow (ie. a\nrow with no cells), a NPE is thrown:\n\nThe Sample Code:\nHSSFWorkbook workbook = new HSSFWorkbook();\nHSSFSheet sheet = workbook.createSheet();\nsheet.createRow(0);\nworkbook.write(new ByteArrayOutputStream());\n\n\nThe StackTrace:\njava.lang.NullPointerException\n\tat org.apache.poi.hssf.model.Sheet.serializeIndexRecord(Sheet.java:787)\n\tat org.apache.poi.hssf.model.Sheet.serialize(Sheet.java:731)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.getBytes(HSSFWorkbook.java:963)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.write(HSSFWorkbook.java:901)\n\tat org.apache.poi.hssf.model.MyTestSheet.test(MyTestSheet.java:16)\n\t...", "id": 100030, "time": "2007-03-05T01:53:56Z", "bug_id": 41761, "creation_time": "2007-03-05T01:53:56Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 41761, "attachment_id": 19662, "id": 100031, "time": "2007-03-05T01:55:06Z", "creator": "julien.ayme@gmail.com", "creation_time": "2007-03-05T01:55:06Z", "is_private": false, "text": "Created attachment 19662\nThe test case\n\nThe test case file"}, {"count": 2, "tags": [], "bug_id": 41761, "attachment_id": 19665, "id": 100038, "time": "2007-03-05T02:01:40Z", "creator": "julien.ayme@gmail.com", "creation_time": "2007-03-05T02:01:40Z", "is_private": false, "text": "Created attachment 19665\nA patch proposal for the org.apache.poi.hssf.model.Sheet class\n\nI am not sure that 0 for a null cells is a good default value."}, {"count": 3, "attachment_id": null, "creator": "julien.ayme@gmail.com", "text": "Whoops, it seems that with my patch, another NPE occurs whith the same test\ncase, but in RowRecordsAggregate.serialize:\n\nThe StackTrace\njava.lang.NullPointerException\n\tat\norg.apache.poi.hssf.record.aggregates.RowRecordsAggregate.serialize(RowRecordsAggregate.java:216)\n\tat org.apache.poi.hssf.model.Sheet.serialize(Sheet.java:719)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.getBytes(HSSFWorkbook.java:963)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.write(HSSFWorkbook.java:901)\n\tat org.apache.poi.hssf.model.MyTestSheet.test(MyTestSheet.java:16)\n\t...", "id": 100039, "time": "2007-03-05T02:04:16Z", "bug_id": 41761, "creation_time": "2007-03-05T02:04:16Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "text": "Created attachment 19666\nA patch proposal for the org.apache.poi.hssf.model.aggregates.RowRecordsAggregate class\n\nI just added a check for null value.", "attachment_id": 19666, "bug_id": 41761, "id": 100042, "time": "2007-03-05T02:09:10Z", "creator": "julien.ayme@gmail.com", "creation_time": "2007-03-05T02:09:10Z", "is_private": false}, {"count": 5, "tags": [], "text": "Apparently, the binary file generated is \"good\", ie. I can open it without any\nerror being thrown in Excel.", "attachment_id": null, "bug_id": 41761, "id": 100043, "time": "2007-03-05T02:18:16Z", "creator": "julien.ayme@gmail.com", "creation_time": "2007-03-05T02:18:16Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 41761, "text": "Julien,\n\npatch applied.\nThanks a lot for it.\n\nRegards,\nYegor", "count": 6, "id": 100671, "time": "2007-03-20T08:01:13Z", "creator": "yegor@dinom.ru", "creation_time": "2007-03-20T08:01:13Z", "is_private": false}]