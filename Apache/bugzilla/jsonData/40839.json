[{"count": 0, "tags": [], "creator": "caster@gentoo.org", "is_private": false, "text": "Executing <javac> on any sources with ant 1.7 and ecj 3.1 (taken from eclipse\n3.1.2) results in (-debug):\n\nApache Ant version 1.7.0Beta3 compiled on October 29 2006\nBuildfile: build.xml\nAdding reference: ant.PropertyHelper\nDetected Java version: 1.5 in: /opt/sun-jdk-1.5.0.08/jre\nDetected OS: Linux\nAdding reference: ant.ComponentHelper\nSetting ro project property: trigger.include -> true\nSetting ro project property: build.compiler ->\norg.eclipse.jdt.core.JDTCompilerAdapter\nSetting ro project property: ant.file -> /home/caster/gentoo/ant/tst/build.xml\nsetting java.net.useSystemProxies to true\nAdding reference: ant.projectHelper\nAdding reference: ant.parsing.context\nAdding reference: ant.targets\nparsing buildfile /home/caster/gentoo/ant/tst/build.xml with URI =\nfile:/home/caster/gentoo/ant/tst/build.xml\nSetting ro project property: ant.project.name -> test\nAdding reference: test\nSetting ro project property: ant.file.test -> /home/caster/gentoo/ant/tst/build.xml\nProject base dir set to: /home/caster/gentoo/ant/tst\n +Target:\n +Target: compile\n +Target: prepare\n +Target: clean\nAttempting to create object of type org.apache.tools.ant.helper.DefaultExecutor\nAdding reference: ant.executor\nBuild sequence for target(s) `compile' is [compile]\nComplete build sequence is [compile, prepare, clean, ]\n\ncompile:\n[antlib:org.apache.tools.ant] Could not load definitions from resource\norg/apache/tools/ant/antlib.xml. It could not be found.\nfileset: Setup scanner in dir /home/caster/gentoo/ant/tst/src with patternSet{\nincludes: [Class1.java:if->trigger.include] excludes: [] }\n    [javac] Class1.java added as Class1.class doesn't exist.\n    [javac] Compiling 1 source file to /home/caster/gentoo/ant/tst/classes\n    [javac] Using JDT compiler\ndropping /opt/sun-jdk-1.5.0.08/jre/jre/lib/rt.jar from path as it doesn't exist\ndropping /opt/sun-jdk-1.5.0.08/Classes/jce.jar from path as it doesn't exist\ndropping /opt/sun-jdk-1.5.0.08/Classes/jsse.jar from path as it doesn't exist\ndropping /opt/sun-jdk-1.5.0.08/jre/lib/core.jar from path as it doesn't exist\ndropping /opt/sun-jdk-1.5.0.08/jre/lib/graphics.jar from path as it doesn't exist\ndropping /opt/sun-jdk-1.5.0.08/jre/lib/security.jar from path as it doesn't exist\ndropping /opt/sun-jdk-1.5.0.08/jre/lib/server.jar from path as it doesn't exist\ndropping /opt/sun-jdk-1.5.0.08/jre/lib/xml.jar from path as it doesn't exist\ndropping /opt/sun-jdk-1.5.0.08/Classes/classes.jar from path as it doesn't exist\ndropping /opt/sun-jdk-1.5.0.08/Classes/ui.jar from path as it doesn't exist\n\nBUILD FAILED\n/home/caster/gentoo/ant/tst/build.xml:5: java.lang.NullPointerException\n        at\norg.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:115)\n        at org.apache.tools.ant.Task.perform(Task.java:342)\n        at org.apache.tools.ant.Target.execute(Target.java:357)\n        at org.apache.tools.ant.Target.performTasks(Target.java:385)\n        at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1291)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1260)\n        at\norg.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1143)\n        at org.apache.tools.ant.Main.runBuild(Main.java:698)\n        at org.apache.tools.ant.Main.startAnt(Main.java:199)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:298)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:104)\nCaused by: java.lang.NullPointerException\n        at\norg.apache.tools.ant.types.AbstractFileSet.setupDirectoryScanner(AbstractFileSet.java:467)\n        at\norg.apache.tools.ant.types.AbstractFileSet.getDirectoryScanner(AbstractFileSet.java:429)\n        at org.apache.tools.ant.types.FileSet.iterator(FileSet.java:69)\n        at org.apache.tools.ant.types.resources.Union.getCollection(Union.java:105)\n        at org.apache.tools.ant.types.resources.Union.getCollection(Union.java:88)\n        at\norg.apache.tools.ant.types.resources.BaseResourceCollectionContainer.cacheCollection(BaseResourceCollectionContainer.java:244)\n        at\norg.apache.tools.ant.types.resources.BaseResourceCollectionContainer.toString(BaseResourceCollectionContainer.java:229)\n        at org.apache.tools.ant.types.Path.toString(Path.java:333)\n        at\norg.apache.tools.ant.types.Commandline$Argument.setPath(Commandline.java:135)\n        at\norg.eclipse.jdt.core.JDTCompilerAdapter.setupJavacCommand(JDTCompilerAdapter.java:144)\n        at\norg.eclipse.jdt.core.JDTCompilerAdapter.execute(JDTCompilerAdapter.java:56)\n        at org.apache.tools.ant.taskdefs.Javac.compile(Javac.java:995)\n        at org.apache.tools.ant.taskdefs.Javac.execute(Javac.java:819)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:281)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:585)\n        at\norg.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)\n        ... 11 more\n--- Nested Exception ---\njava.lang.NullPointerException\n        at\norg.apache.tools.ant.types.AbstractFileSet.setupDirectoryScanner(AbstractFileSet.java:467)\n        at\norg.apache.tools.ant.types.AbstractFileSet.getDirectoryScanner(AbstractFileSet.java:429)\n        at org.apache.tools.ant.types.FileSet.iterator(FileSet.java:69)\n        at org.apache.tools.ant.types.resources.Union.getCollection(Union.java:105)\n        at org.apache.tools.ant.types.resources.Union.getCollection(Union.java:88)\n        at\norg.apache.tools.ant.types.resources.BaseResourceCollectionContainer.cacheCollection(BaseResourceCollectionContainer.java:244)\n        at\norg.apache.tools.ant.types.resources.BaseResourceCollectionContainer.toString(BaseResourceCollectionContainer.java:229)\n        at org.apache.tools.ant.types.Path.toString(Path.java:333)\n        at\norg.apache.tools.ant.types.Commandline$Argument.setPath(Commandline.java:135)\n        at\norg.eclipse.jdt.core.JDTCompilerAdapter.setupJavacCommand(JDTCompilerAdapter.java:144)\n        at\norg.eclipse.jdt.core.JDTCompilerAdapter.execute(JDTCompilerAdapter.java:56)\n        at org.apache.tools.ant.taskdefs.Javac.compile(Javac.java:995)\n        at org.apache.tools.ant.taskdefs.Javac.execute(Javac.java:819)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:281)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:585)\n        at\norg.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)\n        at org.apache.tools.ant.Task.perform(Task.java:342)\n        at org.apache.tools.ant.Target.execute(Target.java:357)\n        at org.apache.tools.ant.Target.performTasks(Target.java:385)\n        at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1291)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1260)\n        at\norg.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1143)\n        at org.apache.tools.ant.Main.runBuild(Main.java:698)\n        at org.apache.tools.ant.Main.startAnt(Main.java:199)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:298)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:104)\n\nTotal time: 0 seconds\n\n\nHappens with both beta3 and latest svn (468820).\n\nWhat's interesting, ecj 3.2 works fine. But since it's different branch and not\njust bugfix of 3.1, I believe it's still worth fixing. Also, ant 1.6.5 works\nwith both ecj 3.1 and 3.2 which suggests the problem is in ant, not ecj?", "id": 95188, "time": "2006-10-28T19:44:08Z", "bug_id": 40839, "creation_time": "2006-10-28T19:44:08Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 40839, "text": "the sources of JDTCompilerAdapter can be seen here\nhttp://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.jdt.core/antadapter/org/eclipse/jdt/core/JDTCompilerAdapter.java", "id": 95189, "time": "2006-10-28T20:44:55Z", "creator": "antoine@apache.org", "creation_time": "2006-10-28T20:44:55Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "antoine@apache.org", "attachment_id": null, "is_private": false, "id": 95190, "time": "2006-10-28T20:46:22Z", "bug_id": 40839, "creation_time": "2006-10-28T20:46:22Z", "text": "Can you add your build file to the bug report ? Or ideally just the piece which\nis necessary to find the error."}, {"count": 3, "tags": [], "bug_id": 40839, "attachment_id": 19049, "text": "Created attachment 19049\nsimple build file exploiting the bug\n\n\"ant prepare\" creates the .java file to compile, \"ant\" compiles it,\nbuild.compiler property is pre-set to ecj, you just need to supply ecj.jar via\n-lib parameter\n\nyou can download sources of ecj here, to spare downloading of whole eclipse\nsources (they are just unpacked directly from there), there are also build\nfiles for creating ecj.jar for testing\nhttp://dev.gentoo.org/~caster/distfiles/eclipse-ecj-3.1.2.tar.bz2\nhttp://dev.gentoo.org/~caster/distfiles/eclipse-ecj-3.2.tar.bz2", "id": 95192, "time": "2006-10-29T01:10:00Z", "creator": "caster@gentoo.org", "creation_time": "2006-10-29T01:10:00Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 40839, "text": "fixed in SVN. Workaround is to set the Project attribute to FileSet in\nPath#addFileset. Did the same for FileList, Path, and DirSet.\nRoot cause of the problem is org.eclipse.jdt.core.JDTCompilerAdapter.java . In\nthe version 3.1 of Eclipse, a FileSet is created in the method addExtDirs(Path,\nPath). The Project attribute is not set on this FileSet, but it is added to a\nPath. When Path.toString() is called, this leads to a NullPointerException. I\nsuppose that this is done differently in Eclipse 3.2.", "id": 95201, "time": "2006-10-29T18:57:43Z", "creator": "antoine@apache.org", "creation_time": "2006-10-29T18:57:43Z", "is_private": false, "attachment_id": null}]