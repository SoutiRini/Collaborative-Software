[{"count": 0, "tags": [], "bug_id": 29187, "attachment_id": null, "id": 57989, "time": "2004-05-24T20:51:43Z", "creator": "lubell@nist.gov", "creation_time": "2004-05-24T20:51:43Z", "is_private": false, "text": "I cannot get xmlvalidate to perform schema validation using the Xerces parser\nincluded with Ant.\n\nMy build file, XML document, schema, and Ant build results are as follows:\n\n*** build.xml ***\n\n<project name=\"test\" default=\"validate\" basedir=\".\">\n\n  <description>$Date: 2004/05/24 19:43:26 $</description>\n\n  <target name=\"validate\">\n    <xmlvalidate file=\"personal-schema.xml\">\n      <attribute name=\"http://xml.org/sax/features/validation\" value=\"true\"/>\n      <attribute \n        name=\"http://apache.org/xml/features/validation/schema\" value=\"true\"/>\n    </xmlvalidate>\n  </target>\n\n</project>\n\n\n*** personal-schema.xml ***\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<personnel xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\t   xsi:noNamespaceSchemaLocation='personal.xsd'>\n\n  <person id=\"Big.Boss\" >\n    <name><family>Boss</family> <given>Big</given></name>\n    <email>chief@foo.com</email>\n    <link subordinates=\"one.worker two.worker three.worker four.worker\nfive.worker\"/>\n  </person>\n\n  <person id=\"one.worker\">\n    <name><family>Worker</family> <given>One</given></name>\n    <email>one@foo.com</email>\n    <link manager=\"Big.Boss\"/>\n  </person>\n\n  <person id=\"two.worker\">\n    <name><family>Worker</family> <given>Two</given></name>\n    <email>two@foo.com</email>\n    <link manager=\"Big.Boss\"/>\n  </person>\n\n  <person id=\"three.worker\">\n    <name><family>Worker</family> <given>Three</given></name>\n    <email>three@foo.com</email>\n    <link manager=\"Big.Boss\"/>\n  </person>\n\n  <person id=\"four.worker\">\n    <name><family>Worker</family> <given>Four</given></name>\n    <email>four@foo.com</email>\n    <link manager=\"Big.Boss\"/>\n  </person>\n\n  <person id=\"five.worker\">\n    <name><family>Worker</family> <given>Five</given></name>\n    <email>five@foo.com</email>\n    <link manager=\"Big.Boss\"/>\n  </person>\n\n</personnel>\n\n\n*** personal.xsd ***\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xs:schema xmlns:xs='http://www.w3.org/2001/XMLSchema'>\n\n <xs:element name=\"personnel\">\n  <xs:complexType>\n   <xs:sequence>\n     <xs:element ref=\"person\" minOccurs='1' maxOccurs='unbounded'/>\n   </xs:sequence>\n  </xs:complexType>\n\n  <xs:unique name=\"unique1\">\n   <xs:selector xpath=\"person\"/>\n   <xs:field xpath=\"name/given\"/>\n   <xs:field xpath=\"name/family\"/>\n  </xs:unique>\n  <xs:key name='empid'>\n   <xs:selector xpath=\"person\"/>\n   <xs:field xpath=\"@id\"/>\n  </xs:key>\n  <xs:keyref name=\"keyref1\" refer='empid'>\n   <xs:selector xpath=\"person\"/> \n   <xs:field xpath=\"link/@manager\"/>  \n  </xs:keyref>\n\n </xs:element>\n\n <xs:element name=\"person\">\n  <xs:complexType>\n   <xs:sequence>\n     <xs:element ref=\"name\"/>\n     <xs:element ref=\"email\" minOccurs='0' maxOccurs='unbounded'/>\n     <xs:element ref=\"url\"   minOccurs='0' maxOccurs='unbounded'/>\n     <xs:element ref=\"link\"  minOccurs='0' maxOccurs='1'/>\n   </xs:sequence>\n   <xs:attribute name=\"id\"  type=\"xs:ID\" use='required'/>\n   <xs:attribute name=\"note\" type=\"xs:string\"/>\n   <xs:attribute name=\"contr\" default=\"false\">\n    <xs:simpleType>\n     <xs:restriction base = \"xs:string\">\n       <xs:enumeration value=\"true\"/>\n       <xs:enumeration value=\"false\"/>\n     </xs:restriction>\n    </xs:simpleType>\n   </xs:attribute>\n   <xs:attribute name=\"salary\" type=\"xs:integer\"/>\n  </xs:complexType>\n </xs:element>\n\n <xs:element name=\"name\">\n  <xs:complexType>\n   <xs:all>\n    <xs:element ref=\"family\"/>\n    <xs:element ref=\"given\"/>\n   </xs:all>\n  </xs:complexType>\n </xs:element>\n\n <xs:element name=\"family\" type='xs:string'/>\n\n <xs:element name=\"given\" type='xs:string'/>\n\n <xs:element name=\"email\" type='xs:string'/>\n\n <xs:element name=\"url\">\n  <xs:complexType>\n   <xs:attribute name=\"href\" type=\"xs:string\" default=\"http://\"/>\n  </xs:complexType>\n </xs:element>\n\n <xs:element name=\"link\">\n  <xs:complexType>\n   <xs:attribute name=\"manager\" type=\"xs:IDREF\"/>\n   <xs:attribute name=\"subordinates\" type=\"xs:IDREFS\"/>\n  </xs:complexType>\n </xs:element>\n\n <xs:notation name='gif' public='-//APP/Photoshop/4.0' system='photoshop.exe'/>\n\n</xs:schema>\n\n\n*** Ant build results ***\n\nant\nBuildfile: build.xml\n\nvalidate:\n[xmlvalidate] /E:/xerces/data/personal-schema.xml:3:50: cvc-elt.1: Cannot find\nthe declaration of element 'personnel'.\n\nBUILD FAILED\nE:\\xerces\\data\\build.xml:6: E:\\xerces\\data\\personal-schema.xml is not a valid\nXML document.\n\nTotal time: 0 seconds\n\nCompilation exited abnormally with code 1 at Mon May 24 16:41:00"}, {"count": 1, "tags": [], "bug_id": 29187, "attachment_id": null, "id": 58893, "time": "2004-06-08T19:24:13Z", "creator": "antoine@apache.org", "creation_time": "2004-06-08T19:24:13Z", "is_private": false, "text": "I am studying the bug report, using the HEAD revision of ant, which allows to\nspecify the location of the schema using a property :\n        <property\n       \nname=\"http://apache.org/xml/properties/schema/external-noNamespaceSchemaLocation\"\n        value=\"${xsd.file}\"/> \nThis works, but only if the root tag of the xml file looks like this :\n<personnel>\nWith this root tag :\n<personnel xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\t   xsi:noNamespaceSchemaLocation=\"personal-schema.xsd\">\nI get this error :\n[xmlvalidate] /C:/dev/testant/xmlvalidate/personal-schema.xml:3:57:\ncvc-complex-type.3.2.2: Attribute 'xsi:noNamespaceSchemaLocation' is not allowed\nto appear in element 'personnel'.\n\n"}, {"count": 2, "tags": [], "text": "You need to add this attribute to the attributes you are using in the\nxmlvalidate task. This feature seems to be necessary for xerces to use the\nxsi:noNamespaceSchemaLocation attribute.\n      <attribute name=\"http://xml.org/sax/features/namespaces\" value=\"true\"/>\n\nBut the documentation of xerces says :\nhttp://xml.apache.org/xerces-j/features.html\nthat the namespaces feature is set to true by default.\nIs this a documentation bug, a code bug, or is there something special about xml\nvalidation leading to a different default for this feature.\n\nSo I am going to reassign this bug report to the xerces java group.\n\nAntoine", "attachment_id": null, "id": 59099, "creator": "antoine@apache.org", "time": "2004-06-11T12:49:57Z", "bug_id": 29187, "creation_time": "2004-06-11T12:49:57Z", "is_private": false}, {"count": 3, "tags": [], "creator": "antoine@apache.org", "attachment_id": null, "id": 59100, "time": "2004-06-11T12:54:46Z", "bug_id": 29187, "creation_time": "2004-06-11T12:54:46Z", "is_private": false, "text": "Actually, xerces Java 2 has moved to Jira, so I am going to close this bug in\nant/Bugzilla and move it to Jira"}, {"count": 4, "tags": [], "text": "OK.\nI have filed a bug in JIRA concerning Xerces Java 2.\nSee :\nhttp://nagoya.apache.org/jira/browse/XERCESJ-979\nWill also update the examples in the documentation of the xmlvalidate task, to\nbring the people to the right track, and prevent this from being a FAQ on the\nuser list.", "is_private": false, "bug_id": 29187, "id": 59101, "time": "2004-06-11T13:24:13Z", "creator": "antoine@apache.org", "creation_time": "2004-06-11T13:24:13Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 29187, "attachment_id": null, "id": 59137, "time": "2004-06-11T22:10:13Z", "creator": "antoine@apache.org", "creation_time": "2004-06-11T22:10:13Z", "is_private": false, "text": "Michael Glavassevich writes [3] :\n\n> Glancing at the source code for XMLValidateTask and JAXPUtils a non-namespace\n> aware JAXP SAXParser is being created and used.\n\n> JAXP says the default [for the namespaces feature] is false [1]. \n> SAX says the default is true [2]. \n> There isn't a bug here. It's just a conflict between the two specs,\n> which often burns users who assume that SAX and JAXP are consistent.\n\n[1]\nhttp://java.sun.com/j2se/1.4.2/docs/api/javax/xml/parsers/SAXParserFactory.html#setNamespaceAware(boolean)\n[2] http://www.saxproject.org/apidoc/org/xml/sax/package-summary.html \n[3] http://issues.apache.org/jira/browse/XERCESJ-979\n\nI will add to the documentation of the xmlvalidate task a sentence like :\nwarning - the namespaces feature defaults to false if you do not specify your\nown parser class."}, {"count": 6, "tags": [], "bug_id": 29187, "attachment_id": null, "id": 59229, "time": "2004-06-15T14:44:19Z", "creator": "lubell@nist.gov", "creation_time": "2004-06-15T14:44:19Z", "is_private": false, "text": "Thanks very much for investigating this issue. I set the namespaces feature to\ntrue, and my build file works fine now.\n\nRegards,\nJosh"}]