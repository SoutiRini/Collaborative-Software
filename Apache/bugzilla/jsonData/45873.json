[{"count": 0, "tags": [], "bug_id": 45873, "text": "Hello,\n\nUsing poi v.3.0 (poi-3.0-rc4-20070503.jar) I encountered a problem which looks like bug #44233.\nFormulas which are referenced to another sheet are not being recalculated when the source sheet data is modified.\n\nI viewed the change list and saw that it was fixed in Version 3.0.2-FINAL (2008-02-04).\n\nI tried using the latest version of POI 3.1-FINAL Released (2008-06-29) and still encountered the same problem, so I think that the fix for this bug might not be included in the new version.\n\nWill you able to check it please? \nA fix above v.3.1 will be appreciated.\n\nThanks,\nMerav", "id": 120915, "time": "2008-09-24T05:41:07Z", "creator": "merav.eshet@precise.com", "creation_time": "2008-09-24T05:41:07Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 45873, "text": "See http://poi.apache.org/hssf/eval.html", "id": 120919, "attachment_id": null, "creator": "apache@gagravarr.org", "creation_time": "2008-09-24T06:52:02Z", "time": "2008-09-24T06:52:02Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 45873, "is_private": false, "text": "(In reply to comment #0)\n> Hello,\n> Using poi v.3.0 (poi-3.0-rc4-20070503.jar) I encountered a problem which looks\n> like bug #44233.\n> Formulas which are referenced to another sheet are not being recalculated when\n> the source sheet data is modified.\n> I viewed the change list and saw that it was fixed in Version 3.0.2-FINAL\n> (2008-02-04).\n> I tried using the latest version of POI 3.1-FINAL Released (2008-06-29) and\n> still encountered the same problem, so I think that the fix for this bug might\n> not be included in the new version.\n> Will you able to check it please? \n> A fix above v.3.1 will be appreciated.\n> Thanks,\n> Merav\n\n(In reply to comment #1)\n> See http://poi.apache.org/hssf/eval.html\n\nThanks for your quick response.\nWhen I use old version of poi (I don\u2019t know the exact version but it\u2019s older than 3.0.0 and its size is 605 kb), the problem doesn\u2019t occur and all formulas are recalculated properly, without using any of the HSSFFormulaEvaluator methods (which were not exist then, anyway).\nWhen I use v.3.0 and v.3.1 this problem occurs: Formulas are not recalculated in a table list, although charts (I tried pie chart) are recalculated properly. When I try implementing the HSSFFormulaEvaluator in my code it doesn\u2019t solve the problem.\nPlease let me know if you need our code examples.\n\n", "id": 121147, "time": "2008-10-02T05:36:31Z", "creator": "merav.eshet@precise.com", "creation_time": "2008-10-02T05:36:31Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "josh@apache.org", "is_private": false, "text": "When you write \"modified\" and \"recalculated\", it is not clear whether POI or Excel is the agent for either operation.\n\nIt will help a lot if you attach a sample spreadsheet and/or some sample code, to show the exact steps that result in your observed problem.", "id": 122229, "time": "2008-11-05T20:03:00Z", "bug_id": 45873, "creation_time": "2008-11-05T20:03:00Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 45873, "is_private": false, "text": "Created attachment 23938\nTest spreadsheet", "id": 128617, "time": "2009-07-07T18:55:03Z", "creator": "asgillett@gmail.com", "creation_time": "2009-07-07T18:55:03Z", "attachment_id": 23938}, {"count": 5, "tags": [], "creator": "asgillett@gmail.com", "text": "Created attachment 23939\nJava test case", "id": 128618, "time": "2009-07-07T18:55:36Z", "bug_id": 45873, "creation_time": "2009-07-07T18:55:36Z", "is_private": false, "attachment_id": 23939}, {"count": 6, "tags": [], "text": "I've also encountered this problem recently. I have attached a test spreadsheet that contains data and a column with formula cells. The attached java program reads the spreadsheet and puts random numbers into the data cells.\n\nIf the java program is compiled and run with poi-2.5.1-final-20040804, the formula cells and chart are updated. With later versions of poi (I've tried 3.0-rc4-20070503, 3.2-FINAL-20081019, and 3.5-beta6-20090622) the formula cells retain their values from the original input file.", "is_private": false, "id": 128619, "creator": "asgillett@gmail.com", "time": "2009-07-07T19:01:12Z", "bug_id": 45873, "creation_time": "2009-07-07T19:01:12Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 45873, "text": "Your example seems to work OK with \npoi-2.5.1-final-20040804, poi-3.1-FINAL-20080629, poi-3.2-FINAL, poi-3.5-beta5-20090115, poi-3.5-FINAL-20090928, poi-3.6-20091214\n\nBut with poi-3.0-FINAL and poi-3.0.2-FINAL-20080204, POI fails to encode the formula correctly (perhaps an old bug token operand class transformation).  I'm a little surprised that you reported 3.0-rc4-20070503 to work for you.\n\nPerhaps your observations are specific to a particular Excel version.  I use Win Excel 2007. It might be the case that prior versions of Excel don't auto-calculate  a spreadsheet without being forced to.  I don't recall if POI has changed recently (with regard to the default value of the auto-calculate flag).  Try HSSFSheet.setForceFormulaRecalculation() to force Excel to re-calculate all formulas on the current sheet upon opening.  On the other hand, you can use HSSFFormulaEvaluator and evaluateFormulaCell() to update the cached formula results so that re-calculation by Excel is not relevant.", "id": 133357, "time": "2010-01-05T19:21:09Z", "creator": "josh@apache.org", "creation_time": "2010-01-05T19:21:09Z", "is_private": false, "attachment_id": null}]