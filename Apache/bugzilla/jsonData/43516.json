[{"count": 0, "tags": [], "text": "if i reload apache (graceful) the apache prozesses consumes additional 8kB for\neach VirtualHost-Definition! this is independant if i define workers or not.\nWith 1000 VirtualHost for example, each apache process consumes on every reload\nadditional 8MB memory\n\nif i remove \"LoadModule jk_module modules/mod_jk.so\" everything is ok again.\n\ni have installed apache 2.0.58 and tried with mod_jk 1.2.22/23 and 25 , but all\nhave same problem", "is_private": false, "bug_id": 43516, "id": 108815, "time": "2007-09-29T13:14:40Z", "creator": "marcel.boesiger@netzone.ch", "creation_time": "2007-09-29T13:14:40Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 43516, "attachment_id": null, "id": 108816, "time": "2007-09-29T13:23:38Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2007-09-29T13:23:38Z", "is_private": false, "text": "Could you please tell us your platform?\nDid you also try with httpd 2.2?\nIt's likely the bug doesn't depend on these details, but one never knows.\n\nThanks for reporting this!"}, {"count": 2, "tags": [], "bug_id": 43516, "attachment_id": null, "id": 108818, "time": "2007-09-29T13:53:22Z", "creator": "marcel.boesiger@netzone.ch", "creation_time": "2007-09-29T13:53:22Z", "is_private": false, "text": "no, i have not tried with apache 2.2\nplatform is Gentoo 4.1.2(In reply to comment #1)\n"}, {"count": 3, "tags": [], "bug_id": 43516, "attachment_id": null, "is_private": false, "id": 108819, "time": "2007-09-29T16:06:07Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2007-09-29T16:06:07Z", "text": "I could not really reproduce this. I tried with httpd 2.2 on Solaris.\nI can see a memory leak after each restart, but even without mod_jk.\nCould you please post your test config (OK if httpd 2.0)? Maybe you are able to\nproduce a \"minimal\" config.\n\nHow do you measure the leak? Are you looking at the memory map in the proc\nfilesystem entry of an httpd child process?"}, {"count": 4, "tags": [], "text": "Aha, can reproduce now. My httpd config leaks some memory even without mod_jk,\nbut it's only a small amount and it doesn't go up with the number of virtual\nservers.\n\nI tried again with 200 vhosts, and now I can see the mod_jk specific problem.", "is_private": false, "bug_id": 43516, "id": 108820, "time": "2007-09-29T16:20:28Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2007-09-29T16:20:28Z", "attachment_id": null}, {"count": 5, "tags": [], "text": "Can you confirm, that the problem only happens, if the vhosts have no individual\nJK configuration? I.e. as soon as you add an individual JkLogFile or an\nindividual JkMount to each host, then there is no restart leak.\n\nIf this is the case, I now know the cause of th eproblem and will think about\nthe right way of fixing it.", "is_private": false, "id": 108828, "creator": "rainer.jung@kippdata.de", "time": "2007-09-30T06:54:30Z", "bug_id": 43516, "creation_time": "2007-09-30T06:54:30Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 43516, "attachment_id": null, "id": 108830, "time": "2007-09-30T12:02:11Z", "creator": "marcel.boesiger@netzone.ch", "creation_time": "2007-09-30T12:02:11Z", "is_private": false, "text": "Yes! i could only make a short test, but you are right. with individual\nJK configuration it seems to be ok"}, {"count": 7, "tags": [], "bug_id": 43516, "is_private": false, "id": 108835, "attachment_id": null, "creator": "rainer.jung@kippdata.de", "creation_time": "2007-09-30T16:32:03Z", "time": "2007-09-30T16:32:03Z", "text": "I committed a fix. It's a little late now for me for final tests but I would\nappreciate, if you could give the fix a try. I put a new tarball under\n\nhttp://people.apache.org/~rjung/mod_jk-dev/\n\nYou can build this version exactly like an official release. The contents of the\ntarball is the latest mod_jk code from the code repository (subversion).\n"}, {"count": 8, "tags": [], "bug_id": 43516, "is_private": false, "id": 108852, "attachment_id": null, "creator": "marcel.boesiger@netzone.ch", "creation_time": "2007-10-01T07:40:29Z", "time": "2007-10-01T07:40:29Z", "text": "Hi Rainer!\nYes, looks great! problem solved! thank you very much !\n"}, {"count": 9, "tags": [], "bug_id": 43516, "attachment_id": null, "id": 108855, "time": "2007-10-01T08:25:42Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2007-10-01T08:25:42Z", "is_private": false, "text": "... and in case you really need many virtual servers without any JK in them, you\ncan save some memory with the global option\n\nJkMountCopy All\n\nThis will have the side effect, to enable all JkMounts which are defined in the\nglobal server in the virtual servers too.\n\nBut in case you only use JK in some/few virtual servers, you can define your\nJKMounts in those virtual servers and set JkMountCopy All in the global.\n\nThen all the virtual servers that have no JkMounts will share the same config\nelement, saving about 8KB per virtual server.\n\nI'm closing this issue, thanks again for reporting.\nIf you find a problem with the fix later, you can reopen the issue.\n\nFix will be part of 1.2.26, maybe sometime in November."}, {"count": 10, "tags": [], "creator": "rainer.jung@kippdata.de", "attachment_id": null, "text": "If you have some spare cycles: we needed to apply some changes to this fix. It\nwould be good to know, that the updated dev snapshot found at\n\nhttp://people.apache.org/~rjung/mod_jk-dev/\n\nstill is OK for you.", "id": 110215, "time": "2007-11-03T11:19:24Z", "bug_id": 43516, "creation_time": "2007-11-03T11:19:24Z", "is_private": false}]