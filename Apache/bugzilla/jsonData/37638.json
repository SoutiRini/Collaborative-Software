[{"count": 0, "tags": [], "bug_id": 37638, "attachment_id": null, "is_private": false, "id": 82867, "time": "2005-11-25T15:05:45Z", "creator": "as85586@gmail.com", "creation_time": "2005-11-25T15:05:45Z", "text": "With standart config from sample for FallbackErrorHandler everything works \nfine. But if you'll add anoher logger using PRIMARY appender, than nothing will \nappear in log file specified for backup appender.\n\nHere is con file:\n\n<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n<!DOCTYPE log4j:configuration SYSTEM \"log4j.dtd\">\n\n<log4j:configuration debug=\"true\" \nxmlns:log4j=\"http://jakarta.apache.org/log4j/\">\n  \n  <appender name=\"PRIMARY\" class=\"org.apache.log4j.FileAppender\">\n    <errorHandler class=\"org.apache.log4j.varia.FallbackErrorHandler\">\n      <root-ref/>\n      <appender-ref ref=\"FALLBACK\" />\n    </errorHandler>\n    <param name=\"File\" value=\"xyz/z.log\" />\n    <layout class=\"org.apache.log4j.PatternLayout\">\n      <param name=\"ConversionPattern\" value=\"%-5p %c{2} - %m%n\"/>\n    </layout>\n  </appender>\n\n  <appender name=\"FALLBACK\" class=\"org.apache.log4j.FileAppender\">\n    <param name=\"File\" value=\"fallback.log\" />\n    <param name=\"Append\" value=\"false\" />\n    <layout class=\"org.apache.log4j.PatternLayout\">\n      <param name=\"ConversionPattern\" value=\"--%d %p %t %c - %m%n\"/>\n    </layout>\n  </appender>\n\n  <logger name=\"org.mailbox\">\n    <level value=\"warn\" />\n    <appender-ref ref=\"PRIMARY\" />\n  </logger>\n\n  <root>\n    <level value=\"debug\" />\n    <appender-ref ref=\"PRIMARY\" />\n  </root>\n\n</log4j:configuration>\n\nTo reproduce bug, just make first log file readonly."}, {"count": 1, "tags": [], "text": "Created attachment 24366\nTest case that demonstrates problem with multiply attached fallbackerrorhandler", "is_private": false, "bug_id": 37638, "id": 131009, "time": "2009-10-08T21:04:39Z", "creator": "carnold@apache.org", "creation_time": "2009-10-08T21:04:39Z", "attachment_id": 24366}, {"count": 2, "tags": [], "bug_id": 37638, "attachment_id": null, "is_private": false, "id": 131010, "time": "2009-10-08T21:07:24Z", "creator": "carnold@apache.org", "creation_time": "2009-10-08T21:07:24Z", "text": "The sample configuration only specifies falling back on the root logger.  If there was a failure, only the root logger would be switched to the FALLBACK appender.  The \"org.mailbox\" logger would keep the failed PRIMARY appender.\n\nI've attached a test case that is a variant of the existing ErrorHandlerTestCase that should have worked, but at least for errors that occur during configuration, something closes FALLBACK appender before it can output anything.  Likely some unfortunately interaction between the configurator and the FallbackErrorHandler."}]