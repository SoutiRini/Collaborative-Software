[{"count": 0, "tags": [], "creator": "schulz@adi.com", "is_private": false, "id": 178327, "attachment_id": null, "bug_id": 57064, "creation_time": "2014-10-07T18:32:03Z", "time": "2014-10-07T18:32:03Z", "text": "Building httpd-2.4.10 on Solaris 10 on a i386 i86pc machine. I am using the Sun C 5.11 compiler. When building with apr-1.5.1 and apr-util-1.5.4, configure selects the event MPM. httpd-2.4.10 configures, builds and installs without error. But at run time I get the following error in the logs:\n\nld.so.1: httpd: fatal: relocation error:\nfile /disk_c0t0d0s7/opt/i86pc/opt-local/apache2/apache2.4/bin/httpd:\nsymbol apr_skiplist_init: referenced symbol not found\n\nand the server does not work.\n\nIf I instead build with apr-1.4.6 and apr-util-1.4.1, configure finds that the event MPM is not supported and selects the worker MPM. The resultant program works correctly."}, {"count": 1, "tags": [], "text": "httpd seems to be linked with an APR version < 1.5.\nWhat ldd shows for /disk_c0t0d0s7/opt/i86pc/opt-local/apache2/apache2.4/bin/httpd?\nDoes LD_LIBRARY_PATH help?", "attachment_id": null, "bug_id": 57064, "id": 178333, "time": "2014-10-07T23:31:17Z", "creator": "ylavic.dev@gmail.com", "creation_time": "2014-10-07T23:31:17Z", "is_private": false}, {"count": 2, "tags": [], "creator": "schulz@adi.com", "attachment_id": null, "id": 178347, "time": "2014-10-08T14:37:37Z", "bug_id": 57064, "creation_time": "2014-10-08T14:37:37Z", "is_private": false, "text": "Thanks for the pointer. The problem is a combination of the compiled in run path being reversed from what I would expect and an installation of an older APR that I did not know would cause a conflict.\n\nFirst, httpd-2.4.10 is configured with these options:\n\nCC=cc CFLAGS=-O  ./configure --prefix=/opt/local/apache2/apache2.4\n--with-ndbm --enable-mods-shared=\"ssl most\" --with-ssl=/opt/local\n--with-z=/opt/local --with-included-apr --with-expat=/opt/local\n--with-pcre=/opt/local --enable-nonportable-atomics=yes\n\nThe compiled in run path as given by ldd -s is:\n\n/opt/local/lib:/opt/local/apache2/apache2.4/lib\n\nNote that /opt/local/lib is placed first in the run path. I assumed that\n/opt/local/apache2/apache2.4/lib would be searched first. And there is\nan instillation of apr-1.4.6 and apr-util-1.4.1 in /opt/local/lib.\n\nI tried to reverse the run path by specifying the run path with the LDFLAGS environmental variable during configure, but I just ended up with what I specified appended to the above run path.\n\nSpecifying the run path with LD_LIBRARY_PATH as\n/opt/local/apache2/apache2.4/lib:/opt/local/lib\nmakes httpd run correctly.\n\nYour call if this is a bug. I think that the elements of the run path should be the other way around."}, {"count": 3, "tags": [], "creator": "ylavic.dev@gmail.com", "attachment_id": null, "id": 178350, "time": "2014-10-08T20:13:49Z", "bug_id": 57064, "creation_time": "2014-10-08T20:13:49Z", "is_private": false, "text": "The PATHs are always searched for left to right, and so is LD_LIBRARY_PATH.\n\nIf you want *dynamic* libraries paths to be fixed at link time, you have to specify it with a linker option (in LDFLAGS).\nHowever I can't tell how this works with solaris' cc/linker (with gcc for example, you could use -Wl,-rpath /opt/local/apache2/apache2.4/lib).\n\nSince this is not a bug in httpd, I close this report."}]