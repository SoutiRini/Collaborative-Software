[{"count": 0, "tags": [], "bug_id": 51162, "attachment_id": null, "id": 146171, "time": "2011-05-06T18:56:08Z", "creator": "ondra@dynawest.cz", "creation_time": "2011-05-06T18:56:08Z", "is_private": false, "text": "6.5.2011 20:54:01 org.apache.catalina.startup.HostConfig checkResources\nINFO: Undeploying context [/test]\n6.5.2011 20:54:01 org.apache.catalina.startup.HostConfig checkResources\nWARNING: Error while removing context [/test]\njava.lang.NullPointerException\n\tat org.apache.catalina.core.ContainerBase.removeChild(ContainerBase.java:923)\n\tat org.apache.catalina.startup.HostConfig.checkResources(HostConfig.java:1212)\n\tat org.apache.catalina.startup.HostConfig.check(HostConfig.java:1380)\n\tat org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:306)\n\tat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:142)\n\tat org.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1385)\n\tat org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1649)\n\tat org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1658)\n\tat org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1638)\n\tat java.lang.Thread.run(Thread.java:662)"}, {"count": 1, "tags": [], "text": "Steps to reproduce:\n\n1) Get commit \n\nhttps://github.com/OndraZizka/arquillian-container-tomcat/commit/35fa744834d23c190f25d70466813fcd9e741544\n\n2) Start Tomcat server with JMX on port 9876 (see arquillian.xml)\n\n3) Build the tomcat6-remote-container tests", "is_private": false, "id": 146172, "creator": "ondra@dynawest.cz", "time": "2011-05-06T19:04:03Z", "bug_id": 51162, "creation_time": "2011-05-06T19:04:03Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 51162, "attachment_id": null, "id": 146210, "time": "2011-05-09T13:08:28Z", "creator": "markt@apache.org", "creation_time": "2011-05-09T13:08:28Z", "is_private": false, "text": "Hmm. That looks like Arquillian is doing things it shouldn't and mixing auto-deployment with directly removing a Context from a Host via JMX.\n\nI have proposed some NPE protection so Tomcat will handle this more gracefully but it looks like the root cause lies elsewhere."}, {"attachment_id": null, "tags": [], "creator": "knst.kolinko@gmail.com", "text": "> I have proposed some NPE protection\n\nRegarding the proposed Tomcat 6 patch (backport of r943112):\n\nIt is good per se, for any Container.removeChild() call, but won't be enough here.\n\n> java.lang.NullPointerException\n>    at\norg.apache.catalina.core.ContainerBase.removeChild(ContainerBase.java:923)\n>    at\norg.apache.catalina.startup.HostConfig.checkResources(HostConfig.java:1212)\n\nThe patch will cure the removeChild(null) call at HostConfig.java:1212, but several lines later (1218) there is context.destroy() call that will result in the same NPE. This is specific to TC6, as trunk does not call destroy() there.", "count": 3, "id": 146235, "time": "2011-05-10T06:51:50Z", "bug_id": 51162, "creation_time": "2011-05-10T06:51:50Z", "is_private": false}, {"count": 4, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 146240, "creation_time": "2011-05-10T08:47:32Z", "time": "2011-05-10T08:47:32Z", "bug_id": 51162, "text": "First patch applied. Still need to address the additional issue Konstantin identified.", "is_private": false}, {"count": 5, "tags": [], "text": "Thanks.\nThis is part of https://issues.jboss.org/browse/ARQ-262 \nI will check the undeployment method eventually.", "is_private": false, "id": 146284, "creator": "ondra@dynawest.cz", "time": "2011-05-12T15:06:38Z", "bug_id": 51162, "creation_time": "2011-05-12T15:06:38Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 51162, "text": "Created attachment 27228\nAdditional patch for Tomcat 6\n\nThis patch addresses the additional NPE identified by Konstantin.", "id": 147610, "time": "2011-06-29T14:18:42Z", "creator": "markt@apache.org", "creation_time": "2011-06-29T14:18:42Z", "is_private": false, "attachment_id": 27228}, {"attachment_id": null, "tags": [], "creator": "markt@apache.org", "text": "This has been fixed in 6.0.x and will be included in 6.0.33 onwards.", "count": 7, "id": 147697, "time": "2011-07-02T11:46:17Z", "bug_id": 51162, "creation_time": "2011-07-02T11:46:17Z", "is_private": false}]