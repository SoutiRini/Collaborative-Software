[{"count": 0, "tags": [], "bug_id": 57411, "attachment_id": null, "id": 180125, "time": "2015-01-02T15:21:06Z", "creator": "amit04jain@gmail.com", "creation_time": "2015-01-02T15:21:06Z", "is_private": false, "text": "hi,\ni working on OSGI and added apache poi lib in bundle.\n i am getting below error \n\njava.lang.ExceptionInInitializerError\n\tat org.apache.poi.openxml4j.opc.internal.unmarshallers.PackagePropertiesUnmarshaller.<clinit>(PackagePropertiesUnmarshaller.java:49)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.init(OPCPackage.java:154)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.<init>(OPCPackage.java:141)\n\tat org.apache.poi.openxml4j.opc.Package.<init>(Package.java:37)\n\tat org.apache.poi.openxml4j.opc.ZipPackage.<init>(ZipPackage.java:65)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.create(OPCPackage.java:337)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.newPackage(XSSFWorkbook.java:347)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:180)\n\tat org.apache.poi.xssf.streaming.SXSSFWorkbook.<init>(SXSSFWorkbook.java:172)\n\tat org.apache.poi.xssf.streaming.SXSSFWorkbook.<init>(SXSSFWorkbook.java:143)\n\tat org.apache.poi.xssf.streaming.SXSSFWorkbook.<init>(SXSSFWorkbook.java:118)\n\tat org.apache.poi.xssf.streaming.SXSSFWorkbook.<init>(SXSSFWorkbook.java:79)\n.\n..\n...\nCaused by: java.lang.ClassCastException: org.dom4j.DocumentFactory cannot be cast to org.dom4j.DocumentFactory\n\tat org.dom4j.DocumentFactory.getInstance(DocumentFactory.java:97)\n\tat org.dom4j.tree.AbstractNode.<clinit>(AbstractNode.java:39)\n\t... 127 more"}, {"count": 1, "tags": [], "bug_id": 57411, "is_private": false, "id": 180128, "creation_time": "2015-01-02T17:55:03Z", "time": "2015-01-02T17:55:03Z", "creator": "dominik.stadler@gmx.at", "text": "Sounds like you end up with two copies of the dom4j jar somehow and OSGi mixes them up. \n\nCan you try with POI 3.11 where we have removed the dependency on dom4j?", "attachment_id": null}, {"count": 2, "tags": [], "text": "How did you produce the OSGi bundle?\n\nFrom the look of it though, you're supplying an invalid Dom4j package\n\nI'd suggest re-trying with 3.11 final, we have simplified the xml dependencies there with the move to java 6", "is_private": false, "bug_id": 57411, "id": 180133, "time": "2015-01-03T00:51:30Z", "creator": "apache@gagravarr.org", "creation_time": "2015-01-03T00:51:30Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "amit04jain@gmail.com", "text": "Thanks. i tried with 3.11 but it is giving me following error \n\njavax.xml.stream.XMLEventFactory.newFactory()Ljavax/xml/stream/XMLEventFactory;: java.lang.NoSuchMethodError: javax.xml.stream.XMLEventFactory.newFactory()Ljavax/xml/stream/XMLEventFactory;\n\n\nI am using java version 1.7.0_72\n\nalso i tried using dependency \n\t\t<dependency>\n\t\t\t<groupId>javax.xml.stream</groupId>\n\t\t\t<artifactId>stax-api</artifactId>\n\t\t\t<version>1.0</version>\n\t\t</dependency>\n\nand\n\n\t\t<dependency>\n\t\t\t<groupId>javax.xml.stream</groupId>\n\t\t\t<artifactId>stax-api</artifactId>\n\t\t\t<version>1.0.2</version>\n\t\t</dependency>", "id": 180134, "time": "2015-01-03T06:07:23Z", "bug_id": 57411, "creation_time": "2015-01-03T06:07:23Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 57411, "is_private": false, "id": 180137, "attachment_id": null, "creator": "dominik.stadler@gmx.at", "creation_time": "2015-01-03T10:53:12Z", "time": "2015-01-03T10:53:12Z", "text": "This now indicates mismatch/outdated XML parser interfaces/implementations, see e.g. http://stackoverflow.com/questions/26866398/nosuchmethoderror-in-main-thread-while-reading-xlsx-using-apache-poi/27754033#27754033 for some details, usually this happens if you include an old version of xml-apis or xerces in your project."}, {"count": 5, "tags": [], "bug_id": 57411, "is_private": false, "id": 180138, "creation_time": "2015-01-03T16:21:15Z", "time": "2015-01-03T16:21:15Z", "creator": "amit04jain@gmail.com", "text": "hi,\ni haven't include any lib  other than this 2\n\n\t\t<dependency>\n\t\t\t<groupId>org.apache.poi</groupId>\n\t\t\t<artifactId>poi</artifactId>\n\t\t\t<version>3.11</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>org.apache.poi</groupId>\n\t\t\t<artifactId>poi-ooxml</artifactId>\n\t\t\t<version>3.11</version>\n\t\t</dependency>\n\n\ni am not sure why it is throwing error of method not found exception.\ni am using  java version 7", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 57411, "is_private": false, "count": 6, "id": 180171, "time": "2015-01-06T07:42:54Z", "creator": "amit04jain@gmail.com", "creation_time": "2015-01-06T07:42:54Z", "text": "also i am getting error \n javax.xml.stream.XMLEventFactory.newFactory()Ljavax/xml/stream/XMLEventFactory;: java.lang.NoSuchMethodError: javax.xml.stream.XMLEventFactory.newFactory()Ljavax/xml/stream/XMLEventFactory; \n\n\nwhen i add \n\n\t<dependency>\n\t\t\t<groupId>xml-apis</groupId>\n\t\t\t<artifactId>xml-apis</artifactId>\n\t\t\t<version>1.3.04</version>\n\t\t</dependency>\n\nto my pom.xml"}, {"count": 7, "attachment_id": null, "bug_id": 57411, "is_private": false, "id": 180172, "time": "2015-01-06T07:44:42Z", "creator": "amit04jain@gmail.com", "creation_time": "2015-01-06T07:44:42Z", "tags": [], "text": "java.lang.NoSuchMethodError: javax.xml.stream.XMLEventFactory.newFactory()Ljavax/xml/stream/XMLEventFactory;\n\tat org.apache.poi.openxml4j.opc.internal.marshallers.PackagePropertiesMarshaller.<clinit>(PackagePropertiesMarshaller.java:45)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.init(OPCPackage.java:161)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.<init>(OPCPackage.java:141)\n\tat org.apache.poi.openxml4j.opc.Package.<init>(Package.java:37)\n\tat org.apache.poi.openxml4j.opc.ZipPackage.<init>(ZipPackage.java:65)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.create(OPCPackage.java:337)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.newPackage(XSSFWorkbook.java:410)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:217)\n\tat org.apache.poi.xssf.streaming.SXSSFWorkbook.<init>(SXSSFWorkbook.java:216)\n\tat org.apache.poi.xssf.streaming.SXSSFWorkbook.<init>(SXSSFWorkbook.java:185)\n\tat org.apache.poi.xssf.streaming.SXSSFWorkbook.<init>(SXSSFWorkbook.java:160)\n\tat org.apache.poi.xssf.streaming.SXSSFWorkbook.<init>(SXSSFWorkbook.java:135)\n\tat org.apache.poi.xssf.streaming.SXSSFWorkbook.<init>(SXSSFWorkbook.java:96)"}, {"count": 8, "tags": [], "bug_id": 57411, "attachment_id": null, "id": 180241, "time": "2015-01-09T12:44:02Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-01-09T12:44:02Z", "is_private": false, "text": "I think you are now hit by one of the things described at http://poi.apache.org/faq.html#faq-N1017E, please try those suggestions and let us know if it helped."}, {"count": 9, "tags": [], "text": "can you please let me know what is exact jar that poi library  are required.\n\ncurrently i had got below exception\n\n\torg/xml/sax/SAXException: java.lang.NoClassDefFoundError: org/xml/sax/SAXException\n\nMy Pom.xml\n\n<dependency>\n\t\t\t<groupId>org.apache.poi</groupId>\n\t\t\t<artifactId>poi</artifactId>\n\t\t\t<version>3.11</version>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>org.apache.poi</groupId>\n\t\t\t<artifactId>poi-ooxml</artifactId>\n\t\t\t<version>3.11</version>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>org.apache.poi</groupId>\n\t\t\t<artifactId>ooxml-security</artifactId>\n\t\t\t<version>1.0</version>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>org.apache.poi</groupId>\n\t\t\t<artifactId>ooxml-schemas</artifactId>\n\t\t\t<version>1.1</version>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>org.apache.xmlbeans</groupId>\n\t\t\t<artifactId>xmlbeans</artifactId>\n\t\t\t<version>2.4.0</version>\n\t\t</dependency>\n\n\nwith Embed Transitivity as false", "is_private": false, "bug_id": 57411, "id": 180243, "time": "2015-01-09T13:41:22Z", "creator": "amit04jain@gmail.com", "creation_time": "2015-01-09T13:41:22Z", "attachment_id": null}, {"count": 10, "tags": [], "text": "All dependencies are listed on the website:\nhttp://poi.apache.org/overview.html#components\n\nI'd suggest you upgrade to XMLBeans 2.6. \n\norg.xml.sax is provided by a Java 6+ JVM, see http://docs.oracle.com/javase/6/docs/api/org/xml/sax/package-summary.html . Make sure your OSGi container isn't somehow excluding that bit of the JVM", "is_private": false, "bug_id": 57411, "id": 180244, "time": "2015-01-09T13:47:41Z", "creator": "apache@gagravarr.org", "creation_time": "2015-01-09T13:47:41Z", "attachment_id": null}, {"count": 11, "tags": [], "text": "I don't think we can do much here, it seems to be a problem with the usage of multiple versions of some jars and incorrect XML libraries from some JVM versions...", "is_private": false, "bug_id": 57411, "id": 184164, "time": "2015-07-24T12:25:28Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-07-24T12:25:28Z", "attachment_id": null}]