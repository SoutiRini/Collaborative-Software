[{"count": 0, "tags": [], "bug_id": 56171, "is_private": false, "text": "Created attachment 31341\nVisio .vsd file\n\nException in thread \"main\" java.lang.RuntimeException: TODO\n\tat org.apache.poi.hdgf.pointers.PointerFactory.createPointer(PointerFactory.java:45)\n\tat org.apache.poi.hdgf.HDGFDiagram.<init>(HDGFDiagram.java:99)\n\tat org.apache.poi.hdgf.HDGFDiagram.<init>(HDGFDiagram.java:60)\n\n\nVisio .vsd file causes RuntimeException.\nThe file can viewed successfully in IE version 8", "id": 173405, "time": "2014-02-20T14:49:56Z", "creator": "kay.j@interfleet.co.uk", "creation_time": "2014-02-20T14:49:56Z", "attachment_id": 31341}, {"count": 1, "attachment_id": null, "creator": "apache@gagravarr.org", "text": "Looks like you have an older v5 file, which HDGF currently only has v6 pointer support\n\nAre you interested in helping to add support for this? It looks like vsdump has support for v5 points, and while we can't copy their code (vsdump is mostly GPL, plus it's in c!), we can use the outputs of vsdump to help debug and investigate the file to identify what's needed", "id": 173408, "time": "2014-02-20T23:17:23Z", "bug_id": 56171, "creation_time": "2014-02-20T23:17:23Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "kay.j@interfleet.co.uk", "text": "Don't mind having a go, but I am not sure my skills are up to it. What do you suggest. What would be the plan?", "id": 173410, "time": "2014-02-21T08:47:11Z", "bug_id": 56171, "creation_time": "2014-02-21T08:47:11Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "Created attachment 31343\nSlide1\n\nvsd file format details - slide 1", "is_private": false, "id": 173419, "creator": "kay.j@interfleet.co.uk", "time": "2014-02-21T15:40:36Z", "bug_id": 56171, "creation_time": "2014-02-21T15:40:36Z", "attachment_id": 31343}, {"count": 4, "tags": [], "text": "Created attachment 31344\nSlide 2\n\nvsd file format details - slide 2", "is_private": false, "id": 173420, "creator": "kay.j@interfleet.co.uk", "time": "2014-02-21T15:41:05Z", "bug_id": 56171, "creation_time": "2014-02-21T15:41:05Z", "attachment_id": 31344}, {"count": 5, "attachment_id": null, "creator": "kay.j@interfleet.co.uk", "text": ".vsd file format details - slides 1 & 2\n\nalso, the python tool ole-toy seems to be the best bet for analyzing any ole file formats, including .vsd; this was written to help reverse engineer .vsd for LibreOffice\n\nsee:\nhttp://libregraphicsworld.org/blog/entry/initial-support-for-visio-files-lands-to-libreoffice", "id": 173421, "time": "2014-02-21T15:45:17Z", "bug_id": 56171, "creation_time": "2014-02-21T15:45:17Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "creator": "apache@gagravarr.org", "text": "You'll probably want to use POIFSDump and POIFSViewer to see the raw data in the pointers stream, get bits out to play with etc\n\nNext up, try using vsdump to parse out the pointers from the test file\n\nIn TestPointerFactory you'll see some examples of the raw bytes of some pointers, along with what they mean. We'll want to identify some pointer bytes, what they correspond to, then write some more unit test bits like that. Finally, we'll want to add logic to the PointerFactory to decode them.\n\nOne other thing - both LibreOffice and vsdump are under incompatible licenses, so we can't take code from either of them. We can use them to debug, to analyse, to test, but not to borrow!", "id": 173422, "time": "2014-02-21T16:54:55Z", "bug_id": 56171, "creation_time": "2014-02-21T16:54:55Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 56171, "text": "The libvisio library has been changed to MPL v2 (on the 31-01-2014).\nSee http://cgit.freedesktop.org/libreoffice/contrib/libvisio\n\nI believe that MPL v2 is compatible with the Apache Licence and hence we can used the code. \n\nIs this true?", "id": 173450, "time": "2014-02-24T13:39:58Z", "creator": "kay.j@interfleet.co.uk", "creation_time": "2014-02-24T13:39:58Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 56171, "attachment_id": null, "is_private": false, "id": 173451, "time": "2014-02-24T13:51:23Z", "creator": "apache@gagravarr.org", "creation_time": "2014-02-24T13:51:23Z", "text": "We can depend on a MPLv2 licensed library, but we can't borrow code from one"}]