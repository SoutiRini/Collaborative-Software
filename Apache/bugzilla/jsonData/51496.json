[{"count": 0, "tags": [], "creator": "knst.kolinko@gmail.com", "text": "It was noticed on the users list, that it is not possible to install two copies of Tomcat with the same service name.\n\nhttp://markmail.org/message/rcmayrkydamywbpw\n\nIt would be preferable to check for a duplicate name before starting the installation, but I do not know of a way to check existing service names in installer.\n\nIs there an API method, or maybe we can look up in the Registry?\n\n\nIt looks that when this error occurs it is too late to go back to the configuration pages, or to specify a different name. At least we can tweak text of the message that appears. The current text is:\n\n\"Failed to install Tomcat7 service.\nCheck your settings and permissions.\nIgnore and continue anyway (not recommended)?\" abort|retry|ignore", "id": 147861, "time": "2011-07-11T12:05:57Z", "bug_id": 51496, "creation_time": "2011-07-11T12:05:57Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "etienne.massip@gmail.com", "attachment_id": null, "text": "http://nsis.sourceforge.net/How_do_I_start/stop/create/remove/check_a_service", "id": 147879, "time": "2011-07-12T07:24:30Z", "bug_id": 51496, "creation_time": "2011-07-12T07:24:30Z", "is_private": false}, {"count": 2, "tags": [], "creator": "ralph@purejava.org", "attachment_id": 29251, "id": 161513, "time": "2012-08-19T18:16:01Z", "bug_id": 51496, "creation_time": "2012-08-19T18:16:01Z", "is_private": false, "text": "Created attachment 29251\nCheck wheather a service of the same name is allready installed.\n\nDear All,\n\nI'd like to propose the attached patch in svn diff format against trunk.\nAfter checking how tomcat.nsi got improved with r1139117 and further commits the attached patch addresses the check wheather a service of the same name is allready installed.\n\nThe patch also applies to tc7.0.x/trunk and tc7.0.x/tags/TOMCAT_7_0_29.\n\nRegards,\nRalph"}, {"count": 3, "tags": [], "text": "-1 for the patch (attachment 29251)\n\nIt does not check that a service is installed.\n\nWhat it checks is whether the \"Tomcat Monitor\" application is configured to auto-launch on Windows startup or not. That is quite a differing thing.", "attachment_id": null, "bug_id": 51496, "id": 161732, "time": "2012-08-27T15:12:37Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2012-08-27T15:12:37Z", "is_private": false}, {"count": 4, "attachment_id": 29289, "bug_id": 51496, "text": "Created attachment 29289\nCheck wheather a service of the same name is allready installed.", "id": 161764, "time": "2012-08-28T08:51:01Z", "creator": "ralph@purejava.org", "creation_time": "2012-08-28T08:51:01Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "creator": "ralph@purejava.org", "text": "Dear Konstantin,\n\nthank you very much for the fast review.\n\nI'd like to explain why I checked for the Tomcat Monitor application whether it is configured to autolaunch: in tomcat.nsi $TomcatServiceName is also part of the registry entry stored for the Tomcat Monitor application and it seemed better to check that than to use an external NSIS library to read the installed services as suggested in comment 1.\n\nBut you are absolutely right, it's better to check if a service of the same name is already installed. I looked a little further into MSDN documentation and found that services are also listed in the registry under HKLM SYSTEM\\CurrentControlSet\\Services\\ so I changed  the registry check in the patch.\n\nPlease find the new patch attached.\nYou can check that it works by installing the tomcat service and running the installer a second time. If a service of the same name exists, it prompts the user with a pop-up and remains on the configuration page.\n\nThe patch is in svn diff format against trunk.\n\nRegards,\nRalph", "id": 161765, "time": "2012-08-28T08:51:33Z", "bug_id": 51496, "creation_time": "2012-08-28T08:51:33Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "creator": "knst.kolinko@gmail.com", "attachment_id": null, "id": 161781, "time": "2012-08-28T19:14:19Z", "bug_id": 51496, "creation_time": "2012-08-28T19:14:19Z", "is_private": false, "text": "Do you have a link to MSDN page describing this?"}, {"count": 7, "tags": [], "bug_id": 51496, "attachment_id": null, "id": 161805, "time": "2012-08-29T09:04:47Z", "creator": "ralph@purejava.org", "creation_time": "2012-08-29T09:04:47Z", "is_private": false, "text": "http://msdn.microsoft.com/en-us/library/ms682544(v=vs.85)\nThe SCM maintains a database of installed services in the registry. The database is used by the SCM and programs that add, modify, or configure services. The following is the registry key for this database: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services.\n\nThis key contains a subkey for each installed service and driver service."}, {"count": 8, "tags": [], "bug_id": 51496, "text": "Thanks for the patch. I fixed a typo - otherwise it was applied as provided.\n\nFixed in:\n- trunk for 9.0.2 onwards\n- 8.5.x for 8.5.24 onwards\n- 8.0.x for 8.0.48 onwards\n- 7.0.x for 7.0.83 onwards", "id": 202349, "time": "2017-11-22T21:30:01Z", "creator": "markt@apache.org", "creation_time": "2017-11-22T21:30:01Z", "is_private": false, "attachment_id": null}]