[{"count": 0, "tags": [], "bug_id": 44235, "attachment_id": null, "id": 112847, "time": "2008-01-14T19:14:23Z", "creator": "longsebo@use.com.cn", "creation_time": "2008-01-14T19:14:23Z", "is_private": false, "text": "FileInputStream fIn;\n    \tHSSFWorkbook workbook ;\n    \tHSSFSheet sheet;\n    \tHSSFCell cell;\n    \ttry {\n\t\t\tfIn = new FileInputStream(\"c://PM0037.xls\");\n\t\t\tworkbook = new HSSFWorkbook(fIn);\n\t\t\tsheet = workbook.getSheetAt(0);\n\t\t\tcell = sheet.getRow(6).getCell((short)3);\n\t\t\t//cell.setCellValue(1019.2);\n\n\t        FileOutputStream fOut = new FileOutputStream(\"c:/test.xls\");\n\t\n\t        workbook.write(fOut);\n\t        fOut.flush();\n\t        fOut.close();\n\t\t\t \n\t\t} catch (FileNotFoundException e) {\n\t\t\t// TODO Auto-generated catch block\n\t\t\te.printStackTrace();\n\t\t} catch (IOException e) {\n\t\t\t// TODO Auto-generated catch block\n\t\t\te.printStackTrace();\n\t\t}\n//when use excel 2003 open test.xls is fails,report open fails!need repair.\n//when use poi open c:\\test.xls report exception:\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record \ninstance\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java:191)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java:115)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:205)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:257)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:238)\n\tat plantix.report.poi.TestPOI.testOpenWorkBookComplexStyle\n(TestPOI.java:108)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke\n(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:324)\n\tat junit.framework.TestCase.runTest(TestCase.java:164)\n\tat junit.framework.TestCase.runBare(TestCase.java:130)\n\tat junit.framework.TestResult$1.protect(TestResult.java:106)\n\tat junit.framework.TestResult.runProtected(TestResult.java:124)\n\tat junit.framework.TestResult.run(TestResult.java:109)\n\tat junit.framework.TestCase.run(TestCase.java:120)\n\tat org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestReference.run\n(JUnit3TestReference.java:130)\n\tat org.eclipse.jdt.internal.junit.runner.TestExecution.run\n(TestExecution.java:38)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests\n(RemoteTestRunner.java:460)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests\n(RemoteTestRunner.java:673)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run\n(RemoteTestRunner.java:386)\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main\n(RemoteTestRunner.java:196)\nCaused by: java.lang.reflect.InvocationTargetException\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native \nMethod)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance\n(NativeConstructorAccessorImpl.java:39)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance\n(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:274)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java:179)\n\t... 21 more\nCaused by: org.apache.poi.hssf.record.RecordFormatException: Expected continue \nrecord.\n\tat org.apache.poi.hssf.record.UnicodeString.fillFields\n(UnicodeString.java:243)\n\tat org.apache.poi.hssf.record.UnicodeString.<init>\n(UnicodeString.java:117)\n\tat org.apache.poi.hssf.record.SSTDeserializer.manufactureStrings\n(SSTDeserializer.java:49)\n\tat org.apache.poi.hssf.record.SSTRecord.fillFields(SSTRecord.java:368)\n\tat org.apache.poi.hssf.record.Record.<init>(Record.java:56)\n\tat org.apache.poi.hssf.record.SSTRecord.<init>(SSTRecord.java:104)\n\t... 26 more"}, {"count": 1, "tags": [], "creator": "longsebo@use.com.cn", "text": "Created attachment 21394\nwell format excel", "id": 112848, "time": "2008-01-14T19:15:30Z", "bug_id": 44235, "creation_time": "2008-01-14T19:15:30Z", "is_private": false, "attachment_id": 21394}, {"count": 2, "tags": [], "creator": "yegor@dinom.ru", "text": "Thanks for the bug report. \nLooks like something is wrong with the serialization of unicode strings. \nIf I change all fonts to Arial the test passes but it fails with the original\n(Chinese) fonts. \nThe code responsible for serialization of strings is quite complicated\n(SSTRecord and related classes). SO, it will take some time to fix. \n\nYegor", "id": 112853, "time": "2008-01-15T00:34:21Z", "bug_id": 44235, "creation_time": "2008-01-15T00:34:21Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 44235, "attachment_id": null, "text": "The bug is not reproducible in poi-3.1-beta1.\n\nYegor", "id": 116251, "time": "2008-05-05T09:14:13Z", "creator": "yegor@dinom.ru", "creation_time": "2008-05-05T09:14:13Z", "is_private": false}, {"count": 4, "tags": [], "creator": "longsebo@use.com.cn", "text": "(In reply to comment #3)\n> The bug is not reproducible in poi-3.1-beta1.\n> Yegor\n\nThank you a lots", "id": 116273, "time": "2008-05-05T17:56:15Z", "bug_id": 44235, "creation_time": "2008-05-05T17:56:15Z", "is_private": false, "attachment_id": null}]