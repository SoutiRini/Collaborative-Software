[{"count": 0, "tags": [], "creator": "gilles.scokart@be.fujitsu.com", "attachment_id": null, "id": 41964, "time": "2003-08-01T15:25:13Z", "bug_id": 22058, "creation_time": "2003-08-01T15:25:13Z", "is_private": false, "text": "I have a simple JSP that use a custom tag (file) writen by extending \nSimpleTagSupport.\n\nHere is the JSP :\n<%@ taglib uri=\"c-rt.tld\" prefix=\"b\" %>\n<%@ taglib uri=\"templater.tld\" prefix=\"t\" %>\n\n\n<b:forEach begin=\"0\" end=\"10\">\n\t<t:file name=\"t\">\n\t\t<b:if test=\"true\">\n\t\t</b:if>\n\t</t:file>\n</b:forEach>\n\nThe generated code doesn't compile.  The error is:\n_jspx_push_body_count_b_forEach_0 cannot be resolved (in the function invoke_0)\n\nHere is an extract of the generated code:\n\n private class test_jspHelper\n      extends org.apache.jasper.runtime.JspFragmentHelper\n  {\n    private javax.servlet.jsp.tagext.JspTag parentTag;\n\n    public test_jspHelper( int discriminator, JspContext jspContext, \njavax.servlet.jsp.tagext.JspTag parentTag ) {\n      super( discriminator, jspContext, parentTag );\n      this.parentTag = parentTag;\n    }\n    public boolean invoke0( java.io.Writer out ) \n      throws Throwable\n    {\n      javax.servlet.jsp.tagext.JspTag _jspx_th_t_file_0 = parentTag;\n      out.write(\"\\r\\n\\t\\t\");\n      if (_jspx_meth_b_if_0(_jspx_th_t_file_0, pageContext, \n_jspx_push_body_count_b_forEach_0))\n        return true;\n      out.write(\"\\r\\n\\t\");\n      return false;\n    }\n    public void invoke( java.io.Writer writer )\n      throws javax.servlet.jsp.JspException\n    {\n      java.io.Writer out = null;\n      if( writer != null ) {\n        out = this.jspContext.pushBody(writer);\n      } else {\n        out = this.jspContext.getOut();\n      }\n      try {\n        switch( this.discriminator ) {\n          case 0:\n            invoke0( out );\n            break;\n        }\n      }\n      catch( Throwable e ) {\n        if (e instanceof javax.servlet.jsp.SkipPageException)\n            throw (javax.servlet.jsp.SkipPageException) e;\n        throw new javax.servlet.jsp.JspException( e );\n      }\n      finally {\n        if( writer != null ) {\n          this.jspContext.popBody();\n        }\n      }\n    }"}, {"count": 1, "tags": [], "creator": "gilles.scokart@be.fujitsu.com", "attachment_id": 7812, "text": "Created attachment 7812\nSources", "id": 42716, "time": "2003-08-14T07:26:50Z", "bug_id": 22058, "creation_time": "2003-08-14T07:26:50Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 22058, "attachment_id": null, "text": "Hmm... The attached war file does not seem to contain the JSP page you quoted.", "id": 43486, "time": "2003-08-29T22:01:23Z", "creator": "kin-man.chung@sun.com", "creation_time": "2003-08-29T22:01:23Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 22058, "attachment_id": null, "is_private": false, "id": 43534, "time": "2003-09-01T06:47:28Z", "creator": "gilles.scokart@be.fujitsu.com", "creation_time": "2003-09-01T06:47:28Z", "text": "It's \"test1.jsp\" in the .zip"}, {"count": 4, "attachment_id": null, "bug_id": 22058, "is_private": false, "id": 43625, "time": "2003-09-02T18:23:18Z", "creator": "kin-man.chung@sun.com", "creation_time": "2003-09-02T18:23:18Z", "tags": [], "text": "The codes generated from the latest nightly build does not contain a reference\nto _jspx_push_body_count_b_forEach_0 in invoke0, and the page was successfully\ncompiled, so I consider this bug fixed.  You can verify that with 5.0.9.\n\nHowever at request tim, I did get a ClassCastException on\ntemplater.jsp.tag.FileTag.doTag(FileTag.java:20)\n\n      TemplatePageContext ctx = (TemplatePageContext) getJspContext();\n\nbut that's in your code.\n\nNext time you should provide a war file; that'll let me get to debugging\nquicker.\n\nAlso, you should use jstl 1.1 instead of jstl 1.0."}, {"count": 5, "tags": [], "bug_id": 22058, "attachment_id": null, "id": 43722, "time": "2003-09-04T15:12:26Z", "creator": "ecarmich@alumni.rice.edu", "creation_time": "2003-09-04T15:12:26Z", "is_private": false, "text": "I'm still seeing this problem, with latest CVS and with 5.0.9.  I will attach \na .war file that reproduces the problem against 5.0.9."}, {"count": 6, "attachment_id": 8063, "bug_id": 22058, "is_private": false, "id": 43723, "time": "2003-09-04T15:14:03Z", "creator": "ecarmich@alumni.rice.edu", "creation_time": "2003-09-04T15:14:03Z", "tags": [], "text": "Created attachment 8063\n.war that reproduces the problem against 5.0.9"}]