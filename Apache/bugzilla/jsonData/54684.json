[{"count": 0, "tags": [], "bug_id": 54684, "attachment_id": null, "text": "When turning on DEBUG logging, toString() causes the following exception.\nIt happens in an OSGi environment.\n\nSLF4J: Failed toString() invocation on an object of type [org.apache.tomcat.jdbc.pool.DataSource]\n2013-03-12 14:17:13,612 | DEBUG | Blueprint Extender: 1    | ServiceRecipe                    | lueprint.container.ServiceRecipe  276 | 7 - org.apache.aries.blueprint.core - 1.1.0 | Creating service instance\njava.lang.NoClassDefFoundError: javax/naming/spi/ObjectFactory\n    at java.lang.ClassLoader.defineClass1(Native Method)\n    at java.lang.ClassLoader.defineClass(ClassLoader.java:791)\n    at org.apache.felix.framework.BundleWiringImpl$BundleClassLoader.findClass(BundleWiringImpl.java:2128)\n    at org.apache.felix.framework.BundleWiringImpl.findClassOrResourceByDelegation(BundleWiringImpl.java:1432)\n    at org.apache.felix.framework.BundleWiringImpl.access$400(BundleWiringImpl.java:72)\n    at org.apache.felix.framework.BundleWiringImpl$BundleClassLoader.loadClass(BundleWiringImpl.java:1843)\n    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)\n    at org.apache.tomcat.jdbc.pool.PoolProperties.toString(PoolProperties.java:804)\n    at java.lang.String.valueOf(String.java:2854)\n    at java.lang.StringBuilder.append(StringBuilder.java:128)\n    at org.apache.tomcat.jdbc.pool.DataSourceProxy.toString(DataSourceProxy.java:215)\n    at org.slf4j.helpers.MessageFormatter.safeObjectAppend(MessageFormatter.java:304)\n    at org.slf4j.helpers.MessageFormatter.deeplyAppendParameter(MessageFormatter.java:276)\n    at org.slf4j.helpers.MessageFormatter.arrayFormat(MessageFormatter.java:230)\n    at org.slf4j.helpers.MessageFormatter.format(MessageFormatter.java:124)\n    at org.ops4j.pax.logging.slf4j.Slf4jLogger.debug(Slf4jLogger.java:280)\n    at org.apache.aries.blueprint.container.ServiceRecipe.createService(ServiceRecipe.java:302)\n    at org.apache.aries.blueprint.container.ServiceRecipe.internalGetService(ServiceRecipe.java:249)\n    at org.apache.aries.blueprint.container.ServiceRecipe.internalCreate(ServiceRecipe.java:146)\n    at org.apache.aries.blueprint.di.AbstractRecipe$1.call(AbstractRecipe.java:79)\n    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)\n    at java.util.concurrent.FutureTask.run(FutureTask.java:166)\n    at org.apache.aries.blueprint.di.AbstractRecipe.create(AbstractRecipe.java:88)\n    at org.apache.aries.blueprint.container.BlueprintRepository.createInstances(BlueprintRepository.java:245)\n    at org.apache.aries.blueprint.container.BlueprintRepository.createAll(BlueprintRepository.java:183)\n    at org.apache.aries.blueprint.container.BlueprintContainerImpl.instantiateEagerComponents(BlueprintContainerImpl.java:668)\n    at org.apache.aries.blueprint.container.BlueprintContainerImpl.doRun(BlueprintContainerImpl.java:370)\n    at org.apache.aries.blueprint.container.BlueprintContainerImpl.run(BlueprintContainerImpl.java:261)\n    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)\n    at java.util.concurrent.FutureTask.run(FutureTask.java:166)\n    at org.apache.aries.blueprint.container.ExecutorServiceWrapper.run(ExecutorServiceWrapper.java:106)\n    at org.apache.aries.blueprint.utils.threading.impl.DiscardableRunnable.run(DiscardableRunnable.java:48)\n    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)\n    at java.util.concurrent.FutureTask.run(FutureTask.java:166)\n    at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:178)\n    at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:292)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n    at java.lang.Thread.run(Thread.java:722)\nCaused by: java.lang.ClassNotFoundException: javax.naming.spi.ObjectFactory not found by org.apache.tomcat.jdbc [165]\n    at org.apache.felix.framework.BundleWiringImpl.findClassOrResourceByDelegation(BundleWiringImpl.java:1460)\n    at org.apache.felix.framework.BundleWiringImpl.access$400(BundleWiringImpl.java:72)\n    at org.apache.felix.framework.BundleWiringImpl$BundleClassLoader.loadClass(BundleWiringImpl.java:1843)\n    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)\n    ... 41 more", "id": 165788, "time": "2013-03-13T08:39:00Z", "creator": "lichtin@yahoo.com", "creation_time": "2013-03-13T08:39:00Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 54684, "text": "The current Import-Package contains\n\nImport-Package:  javax.management;version=\"0\", javax.management.openmb\n ean;version=\"0\", javax.naming;version=\"0\", javax.sql;version=\"0\", org\n .apache.juli.logging;version=\"[6.0.18, 7.0.0)\"\n\nWe need to add \"javax.naming.spi\" also to it", "id": 165789, "time": "2013-03-13T08:49:15Z", "creator": "violetagg@apache.org", "creation_time": "2013-03-13T08:49:15Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "violetagg@apache.org", "text": "Also this version range is strange because it specifies that jdbc-pool can work only with org.apache.juli.logging version 6.x. Is that correct?\n\norg.apache.juli.logging;version=\"[6.0.18, 7.0.0)\"", "id": 165790, "time": "2013-03-13T08:54:30Z", "bug_id": 54684, "creation_time": "2013-03-13T08:54:30Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 54684, "is_private": false, "text": "(In reply to comment #2)\n> Also this version range is strange because it specifies that jdbc-pool can\n> work only with org.apache.juli.logging version 6.x. Is that correct?\n> \n> org.apache.juli.logging;version=\"[6.0.18, 7.0.0)\"\n\nYes it seems wrong. See also bug 54684 where this is discussed.\nEven worse, because Juli is not packaged as an OSGi bundle (and therefore\nnot versioned for an OSGi import), the version range causes yet another issue.", "id": 165791, "time": "2013-03-13T09:29:15Z", "creator": "lichtin@yahoo.com", "creation_time": "2013-03-13T09:29:15Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 54684, "is_private": false, "text": "I ment to refer to bug 52318", "id": 165796, "time": "2013-03-13T14:17:13Z", "creator": "lichtin@yahoo.com", "creation_time": "2013-03-13T14:17:13Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "knst.kolinko@gmail.com", "text": "Should have been fixed by r1455854 r1456068", "id": 165820, "time": "2013-03-14T04:00:45Z", "bug_id": 54684, "creation_time": "2013-03-14T04:00:45Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "creator": "violetagg@apache.org", "is_private": false, "id": 165823, "attachment_id": null, "bug_id": 54684, "creation_time": "2013-03-14T07:41:15Z", "time": "2013-03-14T07:41:15Z", "text": "Thanks for the report.\nFixed in trunk and 7.0.x and will be included in 7.0.39 onwards."}]