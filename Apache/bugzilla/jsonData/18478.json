[{"count": 0, "tags": [], "creator": "bbc@dataconnection.com", "attachment_id": null, "id": 34085, "time": "2003-03-28T19:07:04Z", "bug_id": 18478, "creation_time": "2003-03-28T19:07:04Z", "is_private": false, "text": "Tomcat seems to be confused when multiple services are listening on different \nports.  It is able to serve up files from webapps that are not configured for \nthat service.  In addition you can request files based on the name of the \nwebapp directory in which they live, as well as the path of the webapp \nspecified in the <Context> element in server.xml (last example below).\n\nI'm afraid that this isn't clear, so here are some examples which make clear \nwhat I mean.\n\nI have two webapps set up in different services, one (ROOT) listening on port \n80 and the other (test) on port 8080.  My server.xml is appended below.\n\nWith this setup, the requests\n\n  http://localhost:80/test/\n  http://localhost:8080/test/\n\nboth return the directory listing for the 'test' webapp.  This result is \nunaffected by whether or not there is a directory named 'test' in the ROOT \nwebapp.\n\nThe requests\n\n  http://localhost:80/\n  http://localhost:8080/\n\nboth return the directory listing for the ROOT webapp.\n\nHowever the log for each request is written to the expected access log file.  \nRequests to port 80 result in logs to the ROOT access log; those to port 8080 \nresult in logs to the 'test' access log.\n\nIf I change the <Context> element for the 'test' webapp to be\n\n  <Context path=\"\" docBase=\"test\" debug=\"0\"/>\n\nthe requests\n\n  http://localhost:80/test/\n  http://localhost:8080\n  http://localhost:8080/test/\n\nall return the same thing, the directory listing of the 'test' webapp.  The \nport on which the request is made alters only where the access log is written \nas before.\n\nIf I now change the <Context> element for the 'test' webapp to be\n\n  <Context path=\"/some-other-path\" docBase=\"test\" debug=\"0\"/>\n\nthe requests\n\n  http://localhost:80/test/\n  http://localhost:80/some-other-path/\n  http://localhost:8080/test/\n  http://localhost:8080/some-other-path/\n\nall return the directory listing of the 'test' webapp.  Logs written as before.\n\nExpected behaviour:\n - requests to a certain port are served by the service listening on\n   that port, from the webapp configured for that port;\n - requests which refer to the directory name (docBase) of a webapp,\n   rather than the specified path, should fail.\n\n-- -- --\n\nserver.xml:\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Server port=\"8005\" shutdown=\"SHUTDOWN\" debug=\"0\">\n  <Service name=\"Tomcat-Standalone\">\n    <Connector className=\"org.apache.coyote.tomcat4.CoyoteConnector\"\n               port=\"80\" minProcessors=\"5\" maxProcessors=\"1000\"\n               enableLookups=\"true\" redirectPort=\"443\" acceptCount=\"10\"\n               debug=\"0\" connectionTimeout=\"60000\" scheme=\"http\"\n               secure=\"false\"/>\n    <Engine name=\"Standalone\" defaultHost=\"localhost\" debug=\"0\">\n      <Logger className=\"org.apache.catalina.logger.FileLogger\"\n              prefix=\"catalina_log.\" suffix=\".txt\" timestamp=\"true\"/>\n      <Realm className=\"org.apache.catalina.realm.MemoryRealm\"/>\n      <Host name=\"localhost\" debug=\"0\" appBase=\"webapps\" unpackWARs=\"true\">\n        <Valve className=\"org.apache.catalina.valves.AccessLogValve\"\n               directory=\"logs\" prefix=\"localhost_access_log.\"\n               suffix=\".txt\" pattern=\"common\"/>\n        <Logger className=\"org.apache.catalina.logger.FileLogger\"\n                directory=\"logs\" prefix=\"localhost_log.\" suffix=\".txt\"\n                timestamp=\"true\"/>\n        <Context path=\"\" docBase=\"ROOT\" debug=\"0\"/>\n      </Host>\n    </Engine>\n  </Service>\n  <Service name=\"test\">\n    <Connector className=\"org.apache.coyote.tomcat4.CoyoteConnector\"\n               port=\"8080\" minProcessors=\"5\" maxProcessors=\"1000\"\n               enableLookups=\"true\" redirectPort=\"443\" acceptCount=\"10\"\n               debug=\"0\" connectionTimeout=\"60000\" scheme=\"http\"\n               secure=\"false\"/>\n    <Engine name=\"Standalone\" defaultHost=\"localhost\" debug=\"0\">\n      <Logger className=\"org.apache.catalina.logger.FileLogger\"\n              prefix=\"test_catalina_log.\" suffix=\".txt\" timestamp=\"true\"/>\n      <Realm className=\"org.apache.catalina.realm.MemoryRealm\"/>\n      <Host name=\"localhost\" debug=\"0\" appBase=\"webapps\" unpackWARs=\"true\">\n        <Valve className=\"org.apache.catalina.valves.AccessLogValve\"\n               directory=\"logs\" prefix=\"test_localhost_access_log.\"\n               suffix=\".txt\" pattern=\"common\"/>\n        <Logger className=\"org.apache.catalina.logger.FileLogger\"\n                directory=\"logs\" prefix=\"test_localhost_log.\" suffix=\".txt\"\n                timestamp=\"true\"/>\n        <Context path=\"/test\" docBase=\"test\" debug=\"0\"/>\n      </Host>\n    </Engine>\n  </Service>\n</Server>"}, {"count": 1, "tags": [], "bug_id": 18478, "attachment_id": null, "id": 35870, "time": "2003-04-23T10:40:09Z", "creator": "remm@apache.org", "creation_time": "2003-04-23T10:40:09Z", "is_private": false, "text": "The appBases are the same, zhich causes the problem. Engines should also *not*\nhave the same name in Tomcat 4.1.x. Please post on tomcat-user, or double check\nbefore filing a bug."}]