[{"count": 0, "tags": [], "creator": "eric.shoemaker@gmail.com", "attachment_id": null, "id": 86537, "time": "2006-03-06T18:27:22Z", "bug_id": 38868, "creation_time": "2006-03-06T18:27:22Z", "is_private": false, "text": "Defining the Realm in the META-INF/context.xml throws:\n\nMar 6, 2006 1:03:38 PM org.apache.catalina.realm.JAASRealm authenticate\nSEVERE: Unexpected error\njava.lang.SecurityException: Unable to locate a login configuration\n(... full stack trace below ...)\n\nThe EXACT same Realm definition works perfectly when defined inside the Engine\nor Host containers in Server.xml.  According to the Tomcat 5.0 Realm\ndocumentation, the Realm can be defined inside the Context container as well.\n\nThis is the same error that is generated if no Realm is defined at all. It seems\nthe Realm definition in META-INF/context.xml is silently ignored.  \n\nRelavent configuration files follow:\n\nMETA-INF/context.xml (FAILS):\n\n<Context path=\"/WAdmin\">\n  \n   <Realm\n    className=\"org.apache.catalina.realm.JDBCRealm\" \n    debug=\"99\"\n    driverName=\"org.postgresql.Driver\"\n    connectionURL=\"jdbc:postgresql://localhost:5432/wikid\"\n    connectionName=\"tomcat\" \n    connectionPassword=\"\" \n    digest=\"MD5\"\n    userTable=\"tomcat_users\" \n    userNameCol=\"username\" \n    userCredCol=\"password\"\n    userRoleTable=\"tomcat_roles\" \n    roleNameCol=\"role\"\n   />\n\n</Context>\n\nserver.xml (WORKS):\n\n<Server port=\"8005\" shutdown=\"SHUTDOWN\">\n  <Service name=\"Catalina\">\n    <Connector port=\"8080\" redirectPort=\"8443\"/>\n    <Connector port=\"8443\" scheme=\"https\" secure=\"true\" >\n     <Factory\n      keystorePass=\"passphrase\"\n      keystoreFile=\"conf/Keystore\"\n      clientAuth=\"false\"\n      protocol=\"TLS\"\n     />\n    </Connector>\n    <Engine name=\"Catalina\" defaultHost=\"localhost\">\n      <Logger className=\"org.apache.catalina.logger.FileLogger\" />\n      <Realm\n       className=\"org.apache.catalina.realm.JDBCRealm\"\n       debug=\"99\"\n       driverName=\"org.postgresql.Driver\"\n       connectionURL=\"jdbc:postgresql://localhost:5432/wikid\"\n       connectionName=\"tomcat\"\n       connectionPassword=\"\"\n       digest=\"MD5\"\n       userTable=\"tomcat_users\"\n       userNameCol=\"username\"\n       userCredCol=\"password\"\n       userRoleTable=\"tomcat_roles\"\n       roleNameCol=\"role\"\n      /> \n      <Host name=\"localhost\" appBase=\"webapps\" />\n    </Engine>\n  </Service>\n</Server>\n\n\nException: \n\nMar 6, 2006 1:03:38 PM org.apache.catalina.realm.JAASRealm authenticate\nSEVERE: Unexpected error\njava.lang.SecurityException: Unable to locate a login configuration\n        at com.sun.security.auth.login.ConfigFile.<init>(ConfigFile.java:97)\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n        at\nsun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n        at\nsun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:274)\n        at java.lang.Class.newInstance0(Class.java:308)\n        at java.lang.Class.newInstance(Class.java:261)\n        at javax.security.auth.login.Configuration$3.run(Configuration.java:221)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at\njavax.security.auth.login.Configuration.getConfiguration(Configuration.java:215)\n        at javax.security.auth.login.LoginContext$1.run(LoginContext.java:170)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at javax.security.auth.login.LoginContext.init(LoginContext.java:167)\n        at javax.security.auth.login.LoginContext.<init>(LoginContext.java:404)\n        at org.apache.catalina.realm.JAASRealm.authenticate(JAASRealm.java:298)\n        at\norg.apache.catalina.authenticator.FormAuthenticator.authenticate(FormAuthenticator.java:229)\n        at\norg.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:446)\n        at\norg.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:102)\n        at\norg.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:137)\n        at\norg.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:104)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:118)\n        at\norg.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:102)\n        at\norg.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n        at\norg.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:104)\n        at\norg.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:929)\n        at org.apache.coyote.tomcat5.CoyoteAdapter.service(CoyoteAdapter.java:160)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:799)\n        at\norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:705)\n        at\norg.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:577)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:683)\n        at java.lang.Thread.run(Thread.java:534)\nCaused by: java.io.IOException: Unable to locate a login configuration\n        at com.sun.security.auth.login.ConfigFile.init(ConfigFile.java:206)\n        at com.sun.security.auth.login.ConfigFile.<init>(ConfigFile.java:95)\n        ... 33 more\n\n\n--Eric"}, {"count": 1, "tags": [], "bug_id": 38868, "attachment_id": null, "text": "Does it work for you in Tomcat 5.5.17 or later?", "id": 90254, "time": "2006-06-15T18:27:46Z", "creator": "yoavs@computer.org", "creation_time": "2006-06-15T18:27:46Z", "is_private": false}, {"count": 2, "tags": [], "text": "Yes.  This works on 5.5.17.", "attachment_id": null, "id": 90970, "creator": "eric.shoemaker@gmail.com", "time": "2006-07-07T02:50:31Z", "bug_id": 38868, "creation_time": "2006-07-07T02:50:31Z", "is_private": false}, {"count": 3, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 98430, "time": "2007-01-23T20:02:53Z", "bug_id": 38868, "creation_time": "2007-01-23T20:02:53Z", "is_private": false, "text": "There has been very little development on 5.0.x branch for some time. It is\nunlikely that this will be addressed in 5.0.x so I am marking this as WONTFIX."}]