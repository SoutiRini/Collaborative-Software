[{"count": 0, "tags": [], "bug_id": 34102, "text": "The xmlcatalog element is used to specify the location of local DTD but if the\nlocation of the DTD is in a directory containing spaces, the DTD is not loaded\nlocally but remotely.\n\nHow to reproduce:\nCopy a DTD to the c:\\Program Files\\ directory and remove your network cable.\nThen the XmlValide tasks will fail as it will try to find the DTD on Internet.", "id": 52394, "attachment_id": null, "creator": "anthony.goubard@wanadoo.nl", "creation_time": "2005-03-21T11:53:34Z", "time": "2005-03-21T11:53:34Z", "is_private": false}, {"count": 1, "tags": [], "text": "Is this using the Apache resolver or the built-in one?\n\nCan you give us Ant's -debug output, please?", "is_private": false, "id": 52395, "creator": "bodewig@apache.org", "time": "2005-03-21T12:37:21Z", "bug_id": 34102, "creation_time": "2005-03-21T12:37:21Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 34102, "is_private": false, "count": 2, "id": 52399, "time": "2005-03-21T13:29:07Z", "creator": "anthony.goubard@wanadoo.nl", "creation_time": "2005-03-21T13:29:07Z", "text": "Please find at the end a small test that fails because of this bug.\n\n(In reply to comment #1)\n> Is this using the Apache resolver or the built-in one?\nI don't know, I just use the default one. I don't set any specific property.\n\n> \n> Can you give us Ant's -debug output, please?\nC:\\temp\\dtdpb>ant -debug\nApache Ant version 1.6.2 compiled on July 16 2004\nBuildfile: build.xml\nAdding reference: ant.PropertyHelper\nDetected Java version: 1.4 in: c:\\Java\\Jdk1.4\\jre\nDetected OS: Windows 2000\nAdding reference: ant.ComponentHelper\nSetting ro project property: ant.version -> Apache Ant version 1.6.2 compiled on\n July 16 2004\nSetting ro project property: ant.file -> C:\\temp\\dtdpb\\build.xml\nAdding reference: ant.projectHelper\nAdding reference: ant.parsing.context\nAdding reference: ant.targets\nparsing buildfile C:\\temp\\dtdpb\\build.xml with URI = file:///C:/temp/dtdpb/build\n.xml\nSetting ro project property: ant.project.name -> dtdproblem\nAdding reference: dtdproblem\nSetting ro project property: ant.file.dtdproblem -> C:\\temp\\dtdpb\\build.xml\nProject base dir set to: C:\\temp\\dtdpb\n +Target:\n +Target: load-dtd\nAdding reference: all-dtds\n +Target: validate\nBuild sequence for target `validate' is [load-dtd, validate]\nComplete build sequence is [load-dtd, validate, ]\n\nload-dtd:\nCould not load a dependent class (com/sun/media/jai/codec/FileSeekableStream) fo\nr type image\nCould not load class (org.apache.tools.ant.tasksdefs.cvslib.CvsVersion) for type\n cvsversion\nCould not load a dependent class (jdepend/xmlui/JDepend) for type jdepend\nAdding reference: all-dtds\n\nvalidate:\n[xmlvalidate] Using SAX2 reader org.apache.xerces.parsers.SAXParser\n[xmlvalidate] Validating xins-project.xml...\nresolveEntity: '-//XINS//DTD XINS Project 1.0//EN': 'http://xins.sourceforge.net\n/dtd/xins-project_1_0.dtd'\nApache resolver library not found, internal resolver will be used\nFailed to load Apache resolver: java.lang.NoClassDefFoundError: org/apache/xml/r\nesolver/tools/CatalogResolver\nMatching catalog entry found for publicId: '-//XINS//DTD XINS Project 1.0//EN' l\nocation: 'C:\\Program Files\\xins-1.1.0/src/dtd/xins-project_1_0.dtd'\nuri : 'C:/Program Files/xins-1.1.0/src/dtd/xins-project_1_0.dtd' matches a reada\nble file\nfileName /C:/Program%20Files/xins-1.1.0/src/dtd/xins-project_1_0.dtd\nCouldn't load ResourceStream for C:\\Program Files\\xins-1.1.0/src/dtd/xins-projec\nt_1_0.dtd\nNo matching catalog entry found, parser will use: 'http://xins.sourceforge.net/d\ntd/xins-project_1_0.dtd'\n\nBUILD FAILED\nC:\\temp\\dtdpb\\build.xml:12: Could not validate document C:\\temp\\dtdpb\\xins-proje\nct.xml\n        at org.apache.tools.ant.taskdefs.optional.XMLValidateTask.doValidate(XML\nValidateTask.java:469)\n        at org.apache.tools.ant.taskdefs.optional.XMLValidateTask.execute(XMLVal\nidateTask.java:279)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:275)\n        at org.apache.tools.ant.Task.perform(Task.java:364)\n        at org.apache.tools.ant.Target.execute(Target.java:341)\n        at org.apache.tools.ant.Target.performTasks(Target.java:369)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1214)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1062)\n        at org.apache.tools.ant.Main.runBuild(Main.java:673)\n        at org.apache.tools.ant.Main.startAnt(Main.java:188)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:196)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:55)\nCaused by: java.net.UnknownHostException: xins.sourceforge.net\n        at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:153)\n        at java.net.Socket.connect(Socket.java:452)\n        at java.net.Socket.connect(Socket.java:402)\n        at sun.net.NetworkClient.doConnect(NetworkClient.java:139)\n        at sun.net.www.http.HttpClient.openServer(HttpClient.java:402)\n        at sun.net.www.http.HttpClient.openServer(HttpClient.java:618)\n        at sun.net.www.http.HttpClient.<init>(HttpClient.java:306)\n        at sun.net.www.http.HttpClient.<init>(HttpClient.java:267)\n        at sun.net.www.http.HttpClient.New(HttpClient.java:339)\n        at sun.net.www.http.HttpClient.New(HttpClient.java:320)\n        at sun.net.www.http.HttpClient.New(HttpClient.java:315)\n        at sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConne\nction.java:521)\n        at sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection\n.java:498)\n        at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLCon\nnection.java:626)\n        at org.apache.xerces.impl.XMLEntityManager.setupCurrentEntity(Unknown So\nurce)\n        at org.apache.xerces.impl.XMLEntityManager.startEntity(Unknown Source)\n        at org.apache.xerces.impl.XMLEntityManager.startDTDEntity(Unknown Source\n)\n        at org.apache.xerces.impl.XMLDTDScannerImpl.setInputSource(Unknown Sourc\ne)\n        at org.apache.xerces.impl.XMLDocumentScannerImpl$DTDDispatcher.dispatch(\nUnknown Source)\n        at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Un\nknown Source)\n        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\n        at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)\n        at org.apache.tools.ant.taskdefs.optional.XMLValidateTask.doValidate(XML\nValidateTask.java:460)\n        ... 11 more\n--- Nested Exception ---\njava.net.UnknownHostException: xins.sourceforge.net\n        at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:153)\n        at java.net.Socket.connect(Socket.java:452)\n        at java.net.Socket.connect(Socket.java:402)\n        at sun.net.NetworkClient.doConnect(NetworkClient.java:139)\n        at sun.net.www.http.HttpClient.openServer(HttpClient.java:402)\n        at sun.net.www.http.HttpClient.openServer(HttpClient.java:618)\n        at sun.net.www.http.HttpClient.<init>(HttpClient.java:306)\n        at sun.net.www.http.HttpClient.<init>(HttpClient.java:267)\n        at sun.net.www.http.HttpClient.New(HttpClient.java:339)\n        at sun.net.www.http.HttpClient.New(HttpClient.java:320)\n        at sun.net.www.http.HttpClient.New(HttpClient.java:315)\n        at sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConne\nction.java:521)\n        at sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection\n.java:498)\n        at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLCon\nnection.java:626)\n        at org.apache.xerces.impl.XMLEntityManager.setupCurrentEntity(Unknown So\nurce)\n        at org.apache.xerces.impl.XMLEntityManager.startEntity(Unknown Source)\n        at org.apache.xerces.impl.XMLEntityManager.startDTDEntity(Unknown Source\n)\n        at org.apache.xerces.impl.XMLDTDScannerImpl.setInputSource(Unknown Sourc\ne)\n        at org.apache.xerces.impl.XMLDocumentScannerImpl$DTDDispatcher.dispatch(\nUnknown Source)\n        at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Un\nknown Source)\n        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\n        at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)\n        at org.apache.tools.ant.taskdefs.optional.XMLValidateTask.doValidate(XML\nValidateTask.java:460)\n        at org.apache.tools.ant.taskdefs.optional.XMLValidateTask.execute(XMLVal\nidateTask.java:279)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:275)\n        at org.apache.tools.ant.Task.perform(Task.java:364)\n        at org.apache.tools.ant.Target.execute(Target.java:341)\n        at org.apache.tools.ant.Target.performTasks(Target.java:369)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1214)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1062)\n        at org.apache.tools.ant.Main.runBuild(Main.java:673)\n        at org.apache.tools.ant.Main.startAnt(Main.java:188)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:196)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:55)\n\nTotal time: 0 seconds\n\n\n------------------------------\nbuild.xml:\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project name=\"dtdproblem\" basedir=\".\" default=\"validate\">\n\n<target name=\"load-dtd\">\n<xmlcatalog id=\"all-dtds\">\n<!--dtd location=\"c:\\projects\\xins/src/dtd/xins-project_1_0.dtd\"\npublicId=\"-//XINS//DTD XINS Project 1.0//EN\"/--> <!-- This works -->\n<dtd location=\"C:\\Program Files\\xins-1.1.0/src/dtd/xins-project_1_0.dtd\"\npublicId=\"-//XINS//DTD XINS Project 1.0//EN\"/> <!-- This doesn't work -->\n</xmlcatalog>\n</target>\n\n<target name=\"validate\" depends=\"load-dtd\">\n<xmlvalidate file=\"xins-project.xml\">\n<xmlcatalog refid=\"all-dtds\" />\n</xmlvalidate>\n</target>\n\n</project>\n\nxins-project.xml:\n\n<?xml version=\"1.0\" encoding=\"US-ASCII\"?>\n<!DOCTYPE project PUBLIC \"-//XINS//DTD XINS Project 1.0//EN\"\n\"http://xins.sourceforge.net/dtd/xins-project_1_0.dtd\">\n<project\nname=\"myprojects\"\nrcsversion=\"$Revision: 1.7 $\"\nrcsdate=\"$Date: 2004/10/12 15:19:40 $\"\ndomain=\"com.mycompany\">\n\n\t<api name=\"myproject\" >\n\t\t<impl />\n\t\t<environments />\n\t</api>\n</project>\n\nThe DTD is available at\nhttp://xins.sourceforge.net/dtd/xins-project_1_0.dtd\n\nXINS is available at http://xins.sourceforge.net/\n"}, {"attachment_id": null, "tags": [], "bug_id": 34102, "is_private": false, "count": 3, "id": 50861, "time": "2005-03-21T15:14:17Z", "creator": "bodewig@apache.org", "creation_time": "2005-03-21T15:14:17Z", "text": "Could you give a nightly build of Ant a try, please?\n\nIt may be a case where Ant's own FileUtils class works better than java.net.URL\nand the newer code uses FileUtils.\n\nI've taken your example and tried it with \"/tmp/foo bar/\" and it works with CVS\nHEAD.  Since I don't have a version of Windows to test, I need your help to see\nwhether it has been fixed or is platform specific.\n\n"}, {"count": 4, "tags": [], "text": "Indeed Stefan, FileUtils works better as I've just tried it with the nightly\nbuild and it worked.\nThanks.", "is_private": false, "id": 48045, "creator": "anthony.goubard@wanadoo.nl", "time": "2005-03-21T16:32:17Z", "bug_id": 34102, "creation_time": "2005-03-21T16:32:17Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "bodewig@apache.org", "text": "Great, thanks.\n", "id": 47672, "time": "2005-03-21T16:39:08Z", "bug_id": 34102, "creation_time": "2005-03-21T16:39:08Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "creator": "anthony.goubard@wanadoo.nl", "text": "Here is a work around for this problem:\nLoad the DTD from the classpath.\n\nE.g.\n<target name=\"load-dtd\">\n<xmlcatalog id=\"all-dtds\">\n<classpath>\n  <pathelement path=\"C:\\Program Files\\xins-1.1.0/src/dtd\"/>\n</classpath>\n<dtd location=\"xins-project_1_0.dtd\" publicId=\"-//XINS//DTD XINS Project 1.0//EN\"/>\n</xmlcatalog>\n</target>", "id": 39786, "time": "2005-03-22T14:22:19Z", "bug_id": 34102, "creation_time": "2005-03-22T14:22:19Z", "is_private": false, "attachment_id": null}]