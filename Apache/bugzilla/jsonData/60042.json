[{"count": 0, "tags": [], "bug_id": 60042, "text": "Created attachment 34172\nPresentation file which triggers the bug when used with the code in the description.\n\nI have a use case which requires taking a template presentation, deleting some slides, and adding some more. When doing this, I get the following error message when attempting to add a new slide after removing an old one:\nException in thread \"main\" org.apache.poi.openxml4j.exceptions.PartAlreadyExistsException: A part with the name '/ppt/slides/slide2.xml' already exists : Packages shall not contain equivalent part names and package implementers shall neither create nor recognize packages with equivalent part names. [M1.12]\n\tat org.apache.poi.openxml4j.opc.OPCPackage.createPart(OPCPackage.java:811)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.createPart(OPCPackage.java:775)\n\tat org.apache.poi.POIXMLDocumentPart.createRelationship(POIXMLDocumentPart.java:536)\n\tat org.apache.poi.xslf.usermodel.XMLSlideShow.createSlide(XMLSlideShow.java:220)\n\tat org.apache.poi.xslf.usermodel.XMLSlideShow.createSlide(XMLSlideShow.java:243)\n\tat com.thalesgroup.uk.airscape.investigations.briefinggenerator.PresentationBugger.main(PresentationBugger.java:35)\n\nThe following code results in the exception being thrown:\n\npublic class PresentationBugger {\n\n  public static void main(String... args) throws IOException, OpenXML4JException, XmlException {\n    try (XMLSlideShow pptx = new XMLSlideShow(new FileInputStream(new File(\"pres.pptx\")))) {\n      pptx.removeSlide(0);\n      pptx.createSlide();\n    }\n  }\n}\n\n\"pres.pptx\" is a presentation (tested with PowerPoint 2010). With one slide in the presentation, the bug doesn't occur, but with two or more, it does. I've attached an example of pres.pptx which triggers the bug.", "id": 193320, "time": "2016-08-25T10:13:03Z", "creator": "john.littlewood@uk.thalesgroup.com", "creation_time": "2016-08-25T10:13:03Z", "is_private": false, "attachment_id": 34172}, {"count": 1, "tags": [], "creator": "onealj@apache.org", "attachment_id": null, "text": "Should searching for file name (slide2.xml) be case insensitive?\nhttps://svn.apache.org/viewvc/poi/trunk/src/ooxml/java/org/apache/poi/xslf/usermodel/XMLSlideShow.java?revision=1753073&view=markup#l210\n\nAlso, slideNumber may not be computed correctly if the slides are out of order.\n\n> for (CTSlideIdListEntry slideId : slideList.getSldIdArray()){\n>     slideNumber = (int)Math.max(slideId.getId() + 1, slideNumber);\n>     cnt++;\n> }\n\nIt would be better to store slide numbers in a set and find the largest or smallest slide number and find the next unused number.", "id": 193330, "time": "2016-08-25T15:56:19Z", "bug_id": 60042, "creation_time": "2016-08-25T15:56:19Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 60042, "attachment_id": null, "id": 197807, "time": "2017-03-19T20:41:19Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2017-03-19T20:41:19Z", "is_private": false, "text": "This seems to have been fixed shortly after version 3.14 was released, see bug 55791. I tried the test-code with the attached sample and it did work fine in current trunk.\n\n*** This bug has been marked as a duplicate of bug 55791 ***"}]