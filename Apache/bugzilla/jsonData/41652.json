[{"count": 0, "tags": [], "creator": "joe.nemeth@cpluscsystems.axelero.net", "text": "In the actual peace of code\n\n\nfo:block hyphenate=\"false\" font-family=\"monospace\" text-align=\"start\"\nwrap-option=\"no-wrap\" font-size=\"8pt\" id=\"d0e3596\" white-space-collapse=\"false\"\nwhite-space-treatment=\"preserve\" linefeed-treatment=\"preserve\"\nline-stacking-strategy=\"font-height\">xxxxxxxxxxxxxxxxxxxxx\n\nyyyyyyyyyyyy\nzzzzzzzzzzzzzzzzzzz</fo:block>\n\nthe second (empty) line is \"swallowed\"", "id": 99543, "time": "2007-02-18T10:38:01Z", "bug_id": 41652, "creation_time": "2007-02-18T10:38:01Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "adelmelle@apache.org", "attachment_id": null, "id": 99544, "time": "2007-02-18T11:07:24Z", "bug_id": 41652, "creation_time": "2007-02-18T11:07:24Z", "is_private": false, "text": "Confirmed with FOP Trunk.\n\nInterestingly, if you insert a space between the two consecutive linefeeds, you do get an empty line... \nleading me to think that the linefeed is preserved, but one ends up with a zero-height line.\n\nA way to fix this may exactly be to insert such a space-character in the code somewhere, whenever there \nare two consecutive linefeeds."}, {"count": 2, "tags": [], "creator": "adelmelle@apache.org", "attachment_id": null, "id": 99545, "time": "2007-02-18T13:18:59Z", "bug_id": 41652, "creation_time": "2007-02-18T13:18:59Z", "is_private": false, "text": "Further investigation and debugging confirm my suspicion, I think:\n\nIn both cases, with or without the intermediate space, the list returned by the TextLM consists of 4 \nInlineKnuthSequences. Without the intermediate space, the second sequence contains only a \nKnuthPenalty corresponding to the preserved linefeed.\n\nMy initial idea of Inserting a space character would lead to undesirable outcomes, in for instance the \nfollowing case:\n\n<fo:block linefeed-treatment=\"preserve\">xxxx\n<fo:inline background-color=\"blue\">\n\nyyyy</fo:inline>\nzzzz</fo:block>\n\nin case there is a space on the 'empty' line, one would expect the blue background to appear for the \nwidth of one space character. In case it's just two consecutive linefeeds, the line should be completely \nempty, so no background should be visible...\n\nI see a possible fix in adding the following to fop.layoutmgr.InlineKnuthSequence.endSequence():\n\n        if (!isClosed) {\n            if (isEmpty()) {\n                add(new KnuthGlue(1, 0, 0, null, true));\n            }\n       ...\n\nOr in English: if endSequence() is called on an empty sequence, add a dummy glue element.\nThe glue will be suppressed because of the following infinite penalty, so will leave no trace behind \nwhen background colors are used, like in the above example, but it will trigger the generation of the \nexpected empty line (in AreaTree terms: an empty linearea, or one containing only an empty \ninlineparent of zero ipd)\n\nI'm going to leave it open FTM, to allow others to comment in on the proposed change."}, {"count": 3, "tags": [], "creator": "adelmelle@apache.org", "attachment_id": null, "id": 99556, "time": "2007-02-19T08:05:41Z", "bug_id": 41652, "creation_time": "2007-02-19T08:05:41Z", "is_private": false, "text": "(In reply to comment #2)\n> I see a possible fix in adding the following to fop.layoutmgr.InlineKnuthSequence.endSequence():\n>\n\nOn second thought, maybe it's better to do something similar in \nLineLayoutManager.collectInlineKnuthElements().\n\nAt line 746, an attempt is made to deal with the situation of blank lines (~ InlineKnuthSequence \ncontaining nothing but a forced break), but the added KnuthInlineBox of w=0 still doesn't produce the \nexpected result. It does work if you increase the width (to some value between 1 and iLineWidth). \n\nStill, using an auxiliary KnuthGlue instead of a box also works, and somehow seems more appropriate.\n\nOpinions anyone?"}, {"count": 4, "tags": [], "creator": "adelmelle@apache.org", "text": "\nDecided on the proposed change in LineLayoutManager.\n\nBug fixed in FOP Trunk.\nsee:  http://svn.apache.org/viewvc?view=rev&rev=510626\n\nThanks for reporting the bug!", "id": 99694, "time": "2007-02-22T11:08:56Z", "bug_id": 41652, "creation_time": "2007-02-22T11:08:56Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 41652, "attachment_id": null, "text": "batch transition pre-FOP1.0 resolved+fixed bugs to closed+fixed", "id": 156052, "time": "2012-04-01T06:55:47Z", "creator": "gadams@apache.org", "creation_time": "2012-04-01T06:55:47Z", "is_private": false}]