[{"count": 0, "tags": [], "bug_id": 40318, "text": "The following code doesn't work: \n\nPOIFSFileSystem fs = new POIFSFileSystem(new FileInputStream\n( \"c:\\\\workbook1.xls\")); \nwb = new HSSFWorkbook(fs); \nFileOutputStream fileOut = new FileOutputStream(\"c:\\\\workbook2.xls\"); \nbyte[] bytes = wb.getBytes(); \nfileOut.write(bytes);\nfileOut.close();\n\nWhereas this does: \n \nPOIFSFileSystem fs = new POIFSFileSystem(new FileInputStream\n( \"c:\\\\workbook1.xls\")); \nwb = new HSSFWorkbook(fs); \nFileOutputStream fileOut = new FileOutputStream(\"c:\\\\workbook2.xls\"); \nwb.write(fileOut);\nfileOut.close();\n\nMy input file just contains a simple text \"Hi\" in the 1st cell. \n\nI have just replaced the line - wb.write(fileOut); \nwith the lines -\nbyte[] bytes = wb.getBytes(); \nfileOut.write(bytes);\n\nI think there is some problem with the wb.getBytes() method.", "id": 92527, "time": "2006-08-25T08:39:39Z", "creator": "ishanbhatt@gmail.com", "creation_time": "2006-08-25T08:39:39Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 40318, "text": "The write method works because it does a couple more things than just getBytes\nand write them to the stream:\n\n    public void write(OutputStream stream)\n            throws IOException\n    {\n        byte[] bytes = getBytes();\n        POIFSFileSystem fs = new POIFSFileSystem();\n\n        fs.createDocument(new ByteArrayInputStream(bytes), \"Workbook\");\n\n        if (preserveNodes) {\n            List excepts = new ArrayList(1);\n            excepts.add(\"Workbook\");\n            copyNodes(this.poifs,fs,excepts);\n        }\n        fs.writeFilesystem(stream);\n        //poifs.writeFilesystem(stream);\n    }\n", "id": 92639, "attachment_id": null, "creator": "amolweb@yahoo.com", "creation_time": "2006-08-28T18:17:19Z", "time": "2006-08-28T18:17:19Z", "is_private": false}]