[{"count": 0, "tags": [], "creator": "gvrossum@springsite.com", "attachment_id": null, "id": 42721, "time": "2003-08-14T08:33:18Z", "bug_id": 22408, "creation_time": "2003-08-14T08:33:18Z", "is_private": false, "text": "Hello,\n\nI'm trying to render the follwing code using FOP 0.20.5 (Platform is Win2k, \nj2sdk1.4.0).\n\n<fo:root xmlns:fo=\"http://www.w3.org/1999/XSL/Format\">\n\t<fo:layout-master-set>\n\t\t<fo:simple-page-master master-name=\"title-page\" page-\nwidth=\"21cm\" page-height=\"29.7cm\" margin-top=\"6cm\" margin-bottom=\"2px\" margin-\nleft=\"2cm\" margin-right=\"2cm\">\n\t\t\t<fo:region-body margin-top=\"0px\"></fo:region-body>\n\t\t</fo:simple-page-master>\n\t\t<fo:page-sequence-master master-name=\"title\">\n\t\t\t<fo:single-page-master-reference master-\nreference=\"title-page\"></fo:single-page-master-reference>\n\t\t</fo:page-sequence-master>\n\t</fo:layout-master-set>\n\t<fo:page-sequence master-reference=\"title\">\n\t\t<fo:flow flow-name=\"xsl-region-body\">\n\t\t\t<fo:block>\n\t\t\t\t<fo:instream-foreign-object>\n\t\t\t\t\t<svg:svg viewBox=\"0 0 100 100\" \nwidth=\"100\" height=\"50\" xmlns:svg=\"http://www.w3.org/2000/svg\" \nxmlns:xlink=\"http://www.w3.org/1999/xlink\">\n\t\t\t\t\t<svg:defs>\n\t\t\t\t\t\t<svg:polygon id=\"Star\" points=\"-\n4,-1 -1,-1 0,-4 1,-1 4,-1 2,1 3,4 0,2 -3,4 -2,1\"/>\n\t\t\t\t\t</svg:defs>\n\t\t\t\t\t<svg:rect width=\"100\" height=\"100\" \nx=\"0\" y=\"0\" fill=\"yellow\"/>\n\t\t\t\t\t<svg:use x=\"50%\" y=\"50%\" \nxlink:href=\"#Star\" style=\"fill:limegreen;stroke:black;stroke-width:0.7px;\"/>\n\t\t\t\t\t</svg:svg>\n\t\t\t\t</fo:instream-foreign-object>\n\t\t\t</fo:block>\n\t\t</fo:flow>\n\t</fo:page-sequence>\n</fo:root>\n\nwhen executing FOP with:\n\nfop svgUse.fo test.pdf\n\nI get the following NullpointerException:\n\n[INFO] Using org.apache.xerces.parsers.SAXParser as SAX2 Parser\n[INFO] FOP 0.20.5\n[INFO] Using org.apache.xerces.parsers.SAXParser as SAX2 Parser\n[INFO] building formatting object tree\n[INFO] setting up fonts\n[INFO] [1]\n[ERROR] svg graphic could not be built: null\njava.lang.NullPointerException\n        at org.apache.batik.bridge.UnitProcessor$DefaultContext.getViewportWidth\n(UnitProcessor.java:382)\n        at org.apache.batik.util.UnitProcessor.percentagesToPixels\n(UnitProcessor.java:223)\n        at org.apache.batik.util.UnitProcessor.svgToUserSpace\n(UnitProcessor.java:166)\n        at org.apache.batik.util.UnitProcessor.svgToUserSpace\n(UnitProcessor.java:131)\n        at org.apache.batik.bridge.UnitProcessor.svgToUserSpace\n(UnitProcessor.java:313)\n        at \norg.apache.batik.bridge.UnitProcessor.svgHorizontalCoordinateToUserSpace\n(UnitProcessor.java:247)\n        at org.apache.batik.bridge.SVGUseElementBridge.computeTransform\n(SVGUseElementBridge.java:178)\n        at org.apache.batik.bridge.SVGUseElementBridge.createGraphicsNode\n(SVGUseElementBridge.java:152)\n        at org.apache.batik.bridge.GVTBuilder.buildGraphicsNode\n(GVTBuilder.java:182)\n        at org.apache.batik.bridge.GVTBuilder.buildComposite\n(GVTBuilder.java:148)\n        at org.apache.batik.bridge.GVTBuilder.build(GVTBuilder.java:76)\n        at org.apache.fop.render.pdf.PDFRenderer.renderSVGDocument\n(PDFRenderer.java:590)\n        at org.apache.fop.render.pdf.PDFRenderer.renderSVGArea\n(PDFRenderer.java:549)\n        at org.apache.fop.svg.SVGArea.render(SVGArea.java:98)\n        at org.apache.fop.render.pdf.PDFRenderer.renderForeignObjectArea\n(PDFRenderer.java:533)\n        at org.apache.fop.layout.inline.ForeignObjectArea.render\n(ForeignObjectArea.java:89)\n        at org.apache.fop.render.AbstractRenderer.renderLineArea\n(AbstractRenderer.java:516)\n        at org.apache.fop.layout.LineArea.render(LineArea.java:519)\n        at org.apache.fop.render.AbstractRenderer.renderBlockArea\n(AbstractRenderer.java:485)\n        at org.apache.fop.layout.BlockArea.render(BlockArea.java:117)\n        at org.apache.fop.render.AbstractRenderer.renderAreaContainer\n(AbstractRenderer.java:451)\n        at org.apache.fop.layout.ColumnArea.render(ColumnArea.java:71)\n        at org.apache.fop.render.AbstractRenderer.renderSpanArea\n(AbstractRenderer.java:100)\n        at org.apache.fop.layout.SpanArea.render(SpanArea.java:94)\n        at org.apache.fop.render.AbstractRenderer.renderBodyAreaContainer\n(AbstractRenderer.java:368)\n        at org.apache.fop.layout.BodyAreaContainer.render\n(BodyAreaContainer.java:137)\n        at org.apache.fop.render.AbstractRenderer.renderRegions\n(AbstractRenderer.java:529)\n        at org.apache.fop.render.pdf.PDFRenderer.renderPage\n(PDFRenderer.java:904)\n        at org.apache.fop.render.pdf.PDFRenderer.render(PDFRenderer.java:880)\n        at org.apache.fop.apps.StreamRenderer.queuePage(StreamRenderer.java:302)\n        at org.apache.fop.layout.AreaTree.addPage(AreaTree.java:108)\n        at org.apache.fop.fo.pagination.PageSequence.makePage\n(PageSequence.java:415)\n        at org.apache.fop.fo.pagination.PageSequence.format\n(PageSequence.java:338)\n        at org.apache.fop.apps.StreamRenderer.render(StreamRenderer.java:262)\n        at org.apache.fop.fo.FOTreeBuilder.endElement(FOTreeBuilder.java:223)\n        at org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown \nSource)\n        at org.apache.xerces.impl.XMLNSDocumentScannerImpl.scanEndElement\n(Unknown Source)\n        at \norg.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.\ndispatch(Unknown Source)\n        at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument\n(Unknown Source)\n        at org.apache.xerces.parsers.DTDConfiguration.parse(Unknown Source)\n        at org.apache.xerces.parsers.DTDConfiguration.parse(Unknown Source)\n        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\n        at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)\n        at org.apache.fop.apps.Driver.render(Driver.java:498)\n        at org.apache.fop.apps.CommandLineStarter.run\n(CommandLineStarter.java:106)\n        at org.apache.fop.apps.Fop.main(Fop.java:62)\n[INFO] Parsing of document complete, stopping renderer\n\nI tested the same svg code in Batik's SVG Viewer Batik-Squiggle without any \nproblem. \n\nWhen I remove the '%' from the positioning attributes x and y of svg:use, there \nis no problem, except from the fact that the image that is produced is not what \nI meant. The same problem exists when I use 'cm' instead of '%'.\n\nI first posted this question in Batik's mailinglist. We concluded that the \nproblem lies within FOP, it seems that \"FOP doesn't pass the svg element to \nBatiks bridge\".\n\nAny suggestions?\n\nthanx & greetings"}, {"count": 1, "tags": [], "creator": "pascal.sancho@takoma.fr", "attachment_id": null, "id": 110761, "time": "2007-11-20T00:30:21Z", "bug_id": 22408, "creation_time": "2007-11-20T00:30:21Z", "is_private": false, "text": "Fixed in FOP 0.94 and probably earlier versions"}, {"count": 2, "tags": [], "bug_id": 22408, "text": "batch transition pre-FOP1.0 resolved+fixed bugs to closed+fixed", "id": 155599, "time": "2012-04-01T06:30:03Z", "creator": "gadams@apache.org", "creation_time": "2012-04-01T06:30:03Z", "is_private": false, "attachment_id": null}]