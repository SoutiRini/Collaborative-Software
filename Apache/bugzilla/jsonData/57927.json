[{"count": 0, "tags": [], "bug_id": 57927, "attachment_id": null, "text": "This intermittently happens on Redhat 6.\n\n\nThe rconf has a memory address of 0x0 from \nproxy_req_conf *rconf = ap_get_module_config(r->request_config,\n                                                 &proxy_module);\n\nGDB Output\nProgram terminated with signal 11, Segmentation fault.\n#0  0x00007f1483c7efc5 in ap_proxy_cookie_reverse_map (r=0x7f12f000a9b0, conf=0x7f13e8004528, str=0x7f142cf848ec \"JSESSIONID=3AA0AFCF3E1FF34900C2AC5992452490; Path=/\")\n    at proxy_util.c:994\n994\t            ent = (struct proxy_alias *)rconf->cookie_paths->elts;\n(gdb) bt full\n#0  0x00007f1483c7efc5 in ap_proxy_cookie_reverse_map (r=0x7f12f000a9b0, conf=0x7f13e8004528, str=0x7f142cf848ec \"JSESSIONID=3AA0AFCF3E1FF34900C2AC5992452490; Path=/\")\n    at proxy_util.c:994\n        rconf = 0x0\n        ent = <value optimized out>\n        len = 51\n        newpath = 0x0\n        newdomain = 0x0\n        pathp = 0x7f142cf8491e \"/\"\n        domainp = <value optimized out>\n        pathe = 0x7f142cf8491f \"\"\n        domaine = 0x0\n        l1 = 1\n        l2 = <value optimized out>\n        poffs = 50\n        doffs = 0\n        i = <value optimized out>\n        ddiff = 0\n        pdiff = 0\n        ret = <value optimized out>\n#1  0x00007f1483a679c4 in process_proxy_header (p=0x7f12f000a938, r=<value optimized out>, backend_ptr=0x7f142cf86b28, worker=0x1293ba0, conf=0x12939e8, \n    server_portstr=0x7f142cf86a70 \"\") at mod_proxy_http.c:1063\n        i = <value optimized out>\n        date_hdrs = {0x7f1483a6be79 \"Date\", 0x7f1483a6c132 \"Expires\", 0x7f1483a6c13a \"Last-Modified\", 0x0}\n        transform_hdrs = {{name = 0x7f1483a6c119 \"Location\", func = 0x7f1483c7f0b0 <ap_proxy_location_reverse_map>}, {name = 0x7f1483a6c111 \"Content-Location\", \n            func = 0x7f1483c7f0b0 <ap_proxy_location_reverse_map>}, {name = 0x7f1483a6c122 \"URI\", func = 0x7f1483c7f0b0 <ap_proxy_location_reverse_map>}, {\n            name = 0x7f1483a6c126 \"Destination\", func = 0x7f1483c7f0b0 <ap_proxy_location_reverse_map>}, {name = 0x7f1483a6befb \"Set-Cookie\", \n            func = 0x7f1483c7eb70 <ap_proxy_cookie_reverse_map>}, {name = 0x0, func = 0}}\n#2  ap_proxy_read_headers (p=0x7f12f000a938, r=<value optimized out>, backend_ptr=0x7f142cf86b28, worker=0x1293ba0, conf=0x12939e8, server_portstr=0x7f142cf86a70 \"\")\n    at mod_proxy_http.c:1171\n        value = <value optimized out>\n        end = <value optimized out>\n        field = \"\\030i\\000\\220\\022\\177\\000\\000\\000\\000\\000\\000\\000\\000\\000\\000\\300\\261\\373c\\372\\025\\005\", '\\000' <repeats 7873 times>\"\\356, O*\\241=\", '\\000' <repeats 19 times>\"\\243, H\\370,\\024\\177\\000\\000\\000\\000\\000\\000\\000\\000\\000\\000\\003\\000\\000\\000\\000\\000\\000\\000\\003\\000\\000\\000\\000\\000\\000\\000\\020I\\370,\\024\\177\\000\\000\\000\\000\\000\\000\\002\\000\\000\\000\\246H\\370,\\000\\000\\000\\000\\001\\000\\000\\000\\000\\000\\000\\000\\220H\\370,\\024\\177\\000\\000\\246H\\370,\\024\\177\\000\\000\\340\\302X\\241=\\000\\000\\000\\377H\\370,\\024\\177\\000\\000\\000\\000\\000\\000\\000\\000\\000\\000PH\\370,\\024\\177\", '\\000' <repeats 100 times>, \"2400\", '\\000' <repeats 18 times>, \"hi\\370,\\024\\177\\000\\000\\320 \\006\\344\\022\\177\\000\\000\\300i\\370,\\024\\177\\000\\000\\300\\313m\\001\\000\\000\\000\\000\\213\\234\\324\\254\\372\\025\\005\"\n        psc = 0x12939e8\n        dconf = 0x7f13e8004528\n        size = 8192\n        saw_headers = -268392016\n        len = 63\n        sconf = <value optimized out>\n#3  ap_proxy_http_process_response (p=0x7f12f000a938, r=<value optimized out>, backend_ptr=0x7f142cf86b28, worker=0x1293ba0, conf=0x12939e8, \n    server_portstr=0x7f142cf86a70 \"\") at mod_proxy_http.c:1432\n        major = <value optimized out>\n        minor = 1\n        rc = <value optimized out>\n        c = 0x7f14781407d8\n        buffer = \"Set-Cookie\\000 JSESSIONID=3AA0AFCF3E1FF34900C2AC5992452490; Path=/\\000\\n\\313m\\001\\000\\000\\000\\000\\213\\234\\324\\254\\372\\025\\005\\000\\001\\000\\000\\000\\000\\000\\000\\000I&\\255\\204\\024\\177\\000\\000h\\317m\\001\\000\\000\\000\\000\\320 \\006\\344\\022\\177\\000\\000\\300i\\370,\\024\\177\\000\\000\\373\\260B\\202\\024\\177\\000\\000\\061\\063/May/2015:14:21:09 -0400\\000,\\024\\177\", '\\000' <repeats 100 times>, \"2400\", '\\000' <repeats 18 times>\"\\250, j\\370,\\024\\177\\000\\000p)\\000\\360\\022\\177\\000\\000\\000k\\370,\\024\\177\\000\\000\\300\\313m\\0---Type <return> to continue, or q <return> to quit---\n01\\000\\000\\000\\000\\340\\063\\063N\\372\\025\\005\\000\\001\"...\n        buf = <value optimized out>\n        keepchar = <value optimized out>\n        e = <value optimized out>\n        bb = 0x7f12f0002e70\n        tmp_bb = 0x7f12f0002f18\n        pass_bb = 0x7f12f0002e90\n        len = 15\n        backasswards = 0\n        interim_response = 0\n        pread_len = 0\n        save_table = 0x7f12f0002f48\n        backend_broke = 0\n        hop_by_hop_hdrs = {0x7f1483a6be7e \"Keep-Alive\", 0x7f1483a6c0eb \"Proxy-Authenticate\", 0x7f1483a6c0fe \"TE\", 0x7f1483a6c101 \"Trailer\", 0x7f1483a6c109 \"Upgrade\", 0x0}\n        i = <value optimized out>\n        te = 0x7f12f000a9b0 \"8\\251\"\n        original_status = 200\n        proxy_status = <value optimized out>\n        original_status_line = 0x0\n        proxy_status_line = <value optimized out>\n        backend = 0x7f1414004a40\n        origin = 0x7f1414006c60\n        old_timeout = 0\n        dconf = 0x7f13e8004528\n        do_100_continue = <value optimized out>\n#4  0x00007f1483a6a77b in proxy_http_handler (r=0x7f12f000a9b0, worker=0x1293ba0, conf=0x12939e8, url=0x7f13e8004896 \"http://10.48.172.120:7100/gsi/mat/family/index.jsp\", \n    proxyname=0x0, proxyport=2008) at mod_proxy_http.c:2006\n        locurl = 0x7f13c80025d0 \"/gsi/mat/family/index.jsp\"\n        status = <value optimized out>\n        server_portstr = \"\\000$\\000\\310\\023\\177\\000\\000\\206\\375B\", '\\000' <repeats 20 times>\n        scheme = <value optimized out>\n        proxy_function = 0x7f1483a6bfe9 \"HTTP\"\n        u = <value optimized out>\n        backend = 0x7f1414004a40\n        is_ssl = -402650904\n        c = 0x7f14781407d8\n        retry = <value optimized out>\n        p = 0x7f12f000a938\n        uri = 0x7f13c8002518\n#5  0x00007f1483c72d52 in proxy_run_scheme_handler (r=0x7f12f000a9b0, worker=0x1293ba0, conf=0x12939e8, \n    url=0x7f13e8004896 \"http://10.48.172.120:7100/gsi/mat/family/index.jsp\", proxyhost=0x0, proxyport=0) at mod_proxy.c:2758\n        pHook = <value optimized out>\n        n = <value optimized out>\n        rv = -1\n(gdb) print *r\n$1 = {pool = 0x7f12f000a938, connection = 0x7f14781407d8, server = 0x1566ae0, next = 0x0, prev = 0x0, main = 0x0, the_request = 0x7f12f000bb88 \"GET /family/ HTTP/1.1\", \n  assbackwards = 0, proxyreq = 2, header_only = 0, proto_num = 1001, protocol = 0x7f12f000bbd8 \"HTTP/1.1\", hostname = 0x7f12f000bd20 \"xxxxxxx.com\", \n  request_time = 1431541448162516, status_line = 0x7f12f0002f40 \"200 OK\", status = 200, method_number = 0, method = 0x7f12f000bba0 \"GET\", allowed = 0, \n  allowed_xmethods = 0x0, allowed_methods = 0x7f12f000ac68, sent_bodyct = 0, bytes_sent = 0, mtime = 0, range = 0x0, clength = 0, chunked = 0, read_body = 0, \n  read_chunked = 0, expecting_100 = 0, kept_body = 0x0, body_table = 0x0, remaining = 0, read_length = 0, headers_in = 0x7f12f000aca8, headers_out = 0x7f12f00030a0, \n  err_headers_out = 0x7f13c8002170, subprocess_env = 0x7f13c8002298, notes = 0x7f13c8001ec0, content_type = 0x0, handler = 0x7f1483c836b0 \"proxy-server\", \n  content_encoding = 0x0, content_languages = 0x0, vlist_validator = 0x0, user = 0x0, ap_auth_type = 0x0, unparsed_uri = 0x7f12f000bbb8 \"/family/\", \n  uri = 0x7f13e00019f8 \"/family/index.jsp\", filename = 0x7f13e8004890 \"proxy:http://10.48.172.120:7100/xxxxxxx/index.jsp\", canonical_filename = 0x0, \n  path_info = 0x0, args = 0x0, used_path_info = 2, eos_sent = 0, per_dir_config = 0x7f13e8004218, request_config = 0x7f12f000b930, log = 0x1566b00, log_id = 0x0, \n  htaccess = 0x0, output_filters = 0x7f13c8002488, input_filters = 0x7f12f000bd30, proto_output_filters = 0x7f12f000baa8, proto_input_filters = 0x7f12f000bd30, \n  no_cache = 0, no_local_copy = 0, invoke_mtx = 0x7f12f000be68, parsed_uri = {scheme = 0x0, hostinfo = 0x0, user = 0x0, password = 0x0, hostname = 0x0, port_str = 0x0, \n    path = 0x7f12f000bbc8 \"/family/\", query = 0x0, fragment = 0x0, hostent = 0x0, port = 0, is_initialized = 1, dns_looked_up = 0, dns_resolved = 0}, finfo = {pool = 0x0, \n    valid = 0, protection = 0, filetype = APR_NOFILE, user = 0, group = 0, inode = 0, device = 0, nlink = 0, size = 0, csize = 0, atime = 0, mtime = 0, ctime = 0, \n    fname = 0x0, name = 0x0, filehand = 0x0}, useragent_addr = 0x7f12f000bd68, useragent_ip = 0x7f12f000be58 \"178.137.19.143\"}\n\n(gdb) print rconf\n$3 = (proxy_req_conf *) 0x0\n\n(gdb) print *rconf\nCannot access memory at address 0x0", "id": 182978, "time": "2015-05-13T22:08:00Z", "creator": "bhanuska@gmail.com", "creation_time": "2015-05-13T22:08:00Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 57927, "text": "Thanks for the report.\n\nWould you share the minimal configuration to reproduce this?\n\nIt seems that ProxyPassReverse* is/are used with a RewriteRule [P] (not ProxyPass), is that correct?", "id": 183002, "time": "2015-05-17T14:06:15Z", "creator": "ylavic.dev@gmail.com", "creation_time": "2015-05-17T14:06:15Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 57927, "attachment_id": null, "id": 183043, "time": "2015-05-19T18:46:15Z", "creator": "curleyj@gsicommerce.com", "creation_time": "2015-05-19T18:46:15Z", "is_private": false, "text": "(In reply to Yann Ylavic from comment #1)\n> Thanks for the report.\n> \n> Would you share the minimal configuration to reproduce this?\n> \n> It seems that ProxyPassReverse* is/are used with a RewriteRule [P] (not\n> ProxyPass), is that correct?\n\ntomcat backend, load balanced through F5 vip\n\n        SetEnvIf Request_Protocol HTTP PROTO=http\n        SetEnvIf ProxyHTTPS true PROTO=https\n        RewriteCond %{HTTPS} =on   [NC]\n        RewriteRule / - [E=PROTO:https]\n        RewriteCond %{HTTP_HOST}  ^(.*)$\n        RewriteRule / - [E=VHOST:%1]\n        <Location /*.jsp>\n          ExpiresActive Off\n          ProxyPass  http://10.xxx.xxx.xxx:7300/app\n          ProxyPassReverse http://10.xxx.xxx.xxx:7300/app\n        </Location>\n        ProxyPassReverse / ${PROTO}://${VHOST}/gsi/etoys/ interpolate"}, {"count": 3, "tags": [], "bug_id": 57927, "text": "(In reply to Yann Ylavic from comment #1)\n> Thanks for the report.\n> \n> Would you share the minimal configuration to reproduce this?\n> \n> It seems that ProxyPassReverse* is/are used with a RewriteRule [P] (not\n> ProxyPass), is that correct?\n\nIs there any other information you might need to get this fixed?", "id": 183311, "time": "2015-06-03T18:12:01Z", "creator": "bhanuska@gmail.com", "creation_time": "2015-06-03T18:12:01Z", "is_private": false, "attachment_id": null}]