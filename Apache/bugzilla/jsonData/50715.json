[{"count": 0, "tags": [], "text": "Observed problem:\nIf you specify the 'encoding' attribute of the <sql> task, you would expect that the task fails when some illegal characters are passed as input. Current behavior is to replace them with U+FFFD REPLACEMENT CHARACTER, which is useless in the database world.\n\nBackground:\nStackoverflow question: http://stackoverflow.com/questions/4886460/why-does-us-ascii-encoding-accept-non-us-ascii-characters\n\nSuggested solution: \nWhen encoding is specified, explicitly specify 'CharsetDecoder' with CodingErrorAction.REPORT as the input to InputStreamReader instead of simple encoding.\n\nSemi-patch:\nreader = (encoding == null) ? new InputStreamReader(is) : new InputStreamReader(is, encoding);\n\ncould be replaced with:\n\nif (encoding == null) {\n   reader = new InputStreamReader(is);\n} else {\n   CharsetDecoder decoder = Charset.forName(encoding).newDecoder();\n   decoder.onMalformedInput(CodingErrorAction.REPORT);\n   reader = new InputStreamReader(bais, decoder);  \n}", "is_private": false, "bug_id": 50715, "id": 143958, "time": "2011-02-03T09:26:19Z", "creator": "grzegon@poczta.onet.pl", "creation_time": "2011-02-03T09:26:19Z", "attachment_id": null}]