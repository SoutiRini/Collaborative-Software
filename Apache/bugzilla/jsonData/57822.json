[{"count": 0, "tags": [], "bug_id": 57822, "attachment_id": null, "id": 182427, "time": "2015-04-16T14:41:34Z", "creator": "jerelmoh@uk.ibm.com", "creation_time": "2015-04-16T14:41:34Z", "is_private": false, "text": "On Ant 1.7, 1.8 there are no problems. If you choose to use Ant 1.9 at runtime then this happens when trying to untar a file:\n\nuntar:\n    [untar] Expanding: /MV5C/colony/worker/cics.ds.v200/PI37397/com.ibm.cics.php/natives/DSObjects.tar into /MV5C/colony/worker/cics.ds.v200/PI37397/dist\n\n    [untar] expanding \u00f8\u00c7\u00f8\u0007%\u00d1\u00c2\u0007%\u00d1\u00c2%?/\u00c0\u00c1\u00ca\u0006\u00cb? to /MV5C/colony/worker/cics.ds.v200/PI37397/dist/\u00f8\u00c7\u00f8\u0007%\u00d1\u00c2\u0007%\u00d1\u00c2%?/\u00c0\u00c1\u00ca\u0006\u00cb?\n\n    [untar] expanding \u00f8\u00c7\u00f8\u0007%\u00d1\u00c2\u0007%\u00d1\u00c2\u00cc/\u00f8\u00d1\u00c4\u0006\u00cb? to /MV5C/colony/worker/cics.ds.v200/PI37397/dist/\u00f8\u00c7\u00f8\u0007%\u00d1\u00c2\u0007%\u00d1\u00c2\u00cc/\u00f8\u00d1\u00c4\u0006\u00cb?\n\nDSObjects.tar should untar into php/lib/** and works perfectly on previous versions of Ant.\n\nSomething seems to have gone wrong with the encoding - but the untar task does not allow any encoding modification on Ant 1.9."}, {"count": 1, "tags": [], "text": "Is there any chance you could provide us with an example tar that gets garbled with Ant 1.9.x but works with 1.8.x?", "attachment_id": null, "bug_id": 57822, "id": 182474, "time": "2015-04-18T20:11:20Z", "creator": "bodewig@apache.org", "creation_time": "2015-04-18T20:11:20Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 57822, "attachment_id": null, "id": 182494, "time": "2015-04-20T12:50:47Z", "creator": "jerelmoh@uk.ibm.com", "creation_time": "2015-04-20T12:50:47Z", "is_private": false, "text": "Re comment 1:\n\nOne vital piece of infomation - this is on z/OS and the local codepage is ebcdic IBM-1047. Nonetheless an untar of the same file works fine before ant 1.9. \n\nThe ant task has the job of converting UTF-8 file names to the local codepage - which appears to have regressed. Any tar can be used to test this eg .."}, {"count": 3, "tags": [], "bug_id": 57822, "text": "Created attachment 32665\nTest .tar file\n\nI used compressed some files encoded in UTF-8 (on my linux machine) and ftp'ed it to the Mainframe. There, I tried to run the untar task on it and again at Ant 1.9.4 the output filenames are completely messed up:\n\nExpanding: /MV54/colony/worker/cics.ds.v200/JAM/untar.test.tar into /MV54/colony/worker/cics.ds.v200/JAM/test\n[untar] expanding \u00c8\u00c7\u00d1\u00cb to /MV54/\u00c8\u00c7\u00d1\u00cb\n[untar] expanding \u00c8\u00c7/\u00c8 to /MV54/\u00c8\u00c7/\u00c8\n\nThis tar contains two sampel text files I made before compressing.", "id": 182498, "time": "2015-04-20T13:57:58Z", "creator": "jerelmoh@uk.ibm.com", "creation_time": "2015-04-20T13:57:58Z", "is_private": false, "attachment_id": 32665}, {"count": 4, "tags": [], "bug_id": 57822, "attachment_id": null, "id": 182537, "time": "2015-04-21T18:32:24Z", "creator": "bodewig@apache.org", "creation_time": "2015-04-21T18:32:24Z", "is_private": false, "text": "(In reply to Jerel from comment #2)\n\n> Any tar can be used to test this\n\nas long as you've got access to a z/OS machine :-)\n\nThe task work fine for your archive on other platforms.\n\nAnt 1.9 has ported a few improvements from Commons Compress, for example support for PAX extensions (special entries created by POSIX conforming tar implementations used - for example - for Unicode file names).  I wanted to see an archive causing problems to know where to look.  Your example is not using POSIX extensions at all, so something must have changed in the way Ant parses \"normal\" file names in tar archives.\n\nI'll look into it."}, {"count": 5, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "text": "Yes, this is a regression.\n\nAnt used to read the file name by a crude algorithm that effectively read the file name as ASCII <https://git-wip-us.apache.org/repos/asf?p=ant.git;a=blob;f=src/main/org/apache/tools/tar/TarUtils.java;h=1c4d960feb47021c3db819e0fd30f76217d2c4eb;hb=7105ec785cdcc0faa9afcb9b8384d4864f08a5d6#l81>\n\nWith 1.9.0 it uses the platform's default encoding by default.  Unfortunately turning it back now, would break backwards compatibility for the 1.9.x series.  I'm going to add an encoding attribute to <untar> and you could then set it to ASCII or UTF-8 when expanding the archive.", "id": 182538, "time": "2015-04-21T18:49:49Z", "bug_id": 57822, "creation_time": "2015-04-21T18:49:49Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 57822, "attachment_id": null, "id": 182540, "time": "2015-04-21T19:39:19Z", "creator": "bodewig@apache.org", "creation_time": "2015-04-21T19:39:19Z", "is_private": false, "text": "added encoding attributes as a workaround with git commit 1a58420"}]