[{"count": 0, "tags": [], "bug_id": 57462, "text": "Created attachment 32379\nResulting Excel-File\n\nI create a new workbook with\n1. \"Sheet 1\" with autofilter 0,0,0,2\n2. \"Sheet 2\" with autofilter 0,0,0,5\n3. \"Sheet 3\" with no autofilter.\n4. Set Order of \"Sheet 3\" to 0.\n5. Saving XLS.\n=> \"Sheet 1\" becomes autofilter of \"Sheet 2\" 0,0,0,5\n\nHere is the used JAVA-Code:\n\n\tHSSFWorkbook wb = new HSSFWorkbook();\n\tHSSFSheet sheet1 = wb.createSheet(\"Sheet 1\");\n\tHSSFSheet sheet2 = wb.createSheet(\"Sheet 2\");\n\tHSSFSheet sheet3 = wb.createSheet(\"Sheet 3\");\n\tsheet1.setAutoFilter(new CellRangeAddress(0, 0, 0, 2));\n\tsheet2.setAutoFilter(new CellRangeAddress(0, 0, 0, 5));\n\twb.setSheetOrder(\"Sheet 3\", 0);\n\twb.setSheetOrder(\"Sheet 1\", 1); // Optional ?\n\twb.setSheetOrder(\"Sheet 2\", 2); // Optional ?\n\tFileOutputStream fos = new FileOutputStream(\"POI-TEST.XLS\");\n\twb.write(fos);\n\tfos.close();\n\nI have attached the resulting XLS.\n\nThanks in advance for fixing!", "id": 180377, "time": "2015-01-19T12:33:18Z", "creator": "thomas.kuhlmann@thk-systems.de", "creation_time": "2015-01-19T12:33:18Z", "is_private": false, "attachment_id": 32379}, {"count": 1, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "text": "Seems the autofilter is not adjusted when sheet order changes, this is stored as getSpecificBuiltinRecord() in the Workbook, but not adjusted for setSheetOrder(). I tried to adjust this, but it was non-trivial to get this to work.\n\nNote: removeSheet() is likely also affected, similar adjusting of sheetIndexes is likely necessary there as well.", "id": 180975, "time": "2015-02-11T20:13:28Z", "bug_id": 57462, "creation_time": "2015-02-11T20:13:28Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 57462, "text": "Created attachment 35681\nworkbook with autofilter\n\njust open the file with excel an libreoffice.", "id": 203287, "time": "2018-01-16T09:01:14Z", "creator": "albertofanjul@gmail.com", "creation_time": "2018-01-16T09:01:14Z", "is_private": false, "attachment_id": 35681}, {"count": 3, "tags": [], "bug_id": 57462, "text": "Adding an autofilter to a sheet from file 1, and shifting first rows, on excel 2016 autofilter is shown correctly from file 2 but on libreoffice 5 it shows the autofilter on file 3\n\nAfter save autofilter with libreoffice, both programs show autofilter correctly", "id": 203288, "time": "2018-01-16T09:02:24Z", "creator": "albertofanjul@gmail.com", "creation_time": "2018-01-16T09:02:24Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 57462, "text": "Adding an autofilter to a sheet from file 1, and shifting first rows, on excel 2016 autofilter is shown correctly from file 2 but on libreoffice 5 it shows the autofilter on file 3\n\nAfter save autofilter with libreoffice, both programs show autofilter correctly", "id": 203289, "time": "2018-01-16T09:03:08Z", "creator": "albertofanjul@gmail.com", "creation_time": "2018-01-16T09:03:08Z", "is_private": false, "attachment_id": null}]