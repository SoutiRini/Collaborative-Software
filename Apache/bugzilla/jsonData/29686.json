[{"count": 0, "tags": [], "text": "<cite>\nI goto Admin->Users and try to edit a profile. I am logged in as lenya \n(admin) and every time I click the edit profile button I get booted to \nthe login screen.\n</cite>\n\nI also could verify this behaviour locally.", "attachment_id": null, "id": 59552, "creator": "roku@apache.org", "time": "2004-06-19T07:58:54Z", "bug_id": 29686, "creation_time": "2004-06-19T07:58:54Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 29686, "is_private": false, "text": "This snippet in sitemap.xmap intercepts the usecase \"userChangeGroup\"\n\n<map:match pattern=\"**\">\n        <map:act type=\"authorizer\">\n          <map:mount uri-prefix=\"\" src=\"global-sitemap.xmap\" check-reload=\"true\"\nreload-method=\"synchron\"/>\n        </map:act>\n        <map:redirect-to\nuri=\"{request:requestURI}?lenya.usecase=login&amp;lenya.step=showscreen\"\nsession=\"true\"/>\n      </map:match>\n\nI have no idea why the authorizer action fails here and causes a redirect.\nAt least I could debug the sitemaps to this point. \n\nMore ideas on this?", "id": 59554, "time": "2004-06-19T08:45:10Z", "creator": "roku@apache.org", "creation_time": "2004-06-19T08:45:10Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "A.Kuckartz@ping.de", "attachment_id": null, "is_private": false, "id": 59585, "time": "2004-06-19T13:48:07Z", "bug_id": 29686, "creation_time": "2004-06-19T13:48:07Z", "text": "*** Bug 29296 has been marked as a duplicate of this bug. ***"}, {"count": 3, "tags": [], "bug_id": 29686, "is_private": false, "id": 59629, "creation_time": "2004-06-20T20:59:48Z", "time": "2004-06-20T20:59:48Z", "creator": "andreas@apache.org", "text": "You could set the lenya logging to DEBUG in logkit.xconf and check out the\nlenya.log (all access control stuff is logged there). Maybe I can take a look at\nit the day after tomorrow.", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 29686, "is_private": false, "id": 59679, "creation_time": "2004-06-21T16:38:55Z", "time": "2004-06-21T16:38:55Z", "creator": "roku@apache.org", "text": "The problem seems to be located in\ndefault/config/ac/policies/admin/subtree-policy.acml\n\nand\n\n/home/roku/workspace2/cocoon-lenya/build/lenya/webapp/lenya/pubs/default/config/ac/usecase-policies.xml\n\nusecase-policies defines a role \"edit\" being able to change a users profile, but\nin subtree-*.xml the group admin is defined for edit. \n\nSo I changed subtree-*.xml to \n\n  <group id=\"admin\">\n    <role id=\"admin\"/>\n    <role id=\"edit\"/>\n  </group>\n\nAfter that all \"admins\" are able to edit user profiles again.\n\nBUT I found anohter bug related to this one. Login as user \"alice\" and click on\nadmin tab. If alice should be able to edit her (and only her) password, she\nneeds to be in a group which is in the role edit. BUT if we now for exapmle add\nsth. like\n\n  <group id=\"editor\">\n    <role id=\"edit\"/>\n  </group>\n\nto subtree-policies.xml, all \"editors\" are able to change passwords/profiles of\nother users too.\n\nSo, maybe a more experienced developer concerning the ac can take over now.\n\nI guess the current ac concept is not able to cover the case that a user can use\na usecase only under special circumstances i.e. a user can edit _only_ his own\nprofile. But to be honest, I'm new to lenya's ac code.", "attachment_id": null}, {"count": 5, "tags": [], "creator": "roku@apache.org", "attachment_id": null, "id": 59680, "time": "2004-06-21T16:40:47Z", "bug_id": 29686, "creation_time": "2004-06-21T16:40:47Z", "is_private": false, "text": "Sorry, typo. i meant \n\n\"...in subtree-*.xml the group admin is NOT defined being in role edit. \""}, {"count": 6, "tags": [], "bug_id": 29686, "attachment_id": null, "text": "<quote>\nI guess the current ac concept is not able to cover the case that a user can use\na usecase only under special circumstances i.e. a user can edit _only_ his own\nprofile.\n</quote>\n\nThis is possible using a policy\n\n/admin/users/alice.html/subtree-policy.html\n\nwhich makes alice an editor on her own profile.\nThis policy is generated automatically when a user is created (and removed when\nthe user is deleted), but the policies for lenya and alice are not yet in CVS. I\nassigned the bug to me and will add them when the freeze is over or we voted to\ninclude this in 1.2.", "id": 59839, "time": "2004-06-24T14:25:48Z", "creator": "andreas@apache.org", "creation_time": "2004-06-24T14:25:48Z", "is_private": false}]