[{"count": 0, "tags": [], "bug_id": 57704, "text": "During shutdown, tomcat crashes as follows:\n\nSEVERE: Exception sending context destroyed event to listener instance of class org.apache.tomcat.websocket.server.WsContextListener\njava.lang.NullPointerException\n        at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:5076)\n        at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:5719)\n        at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:232)\n        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:160)\n        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:649)\n        at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:672)\n        at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfig.java:1859)\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n        at java.util.concurrent.FutureTask.run(FutureTask.java:262)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n\n\nAn analysis of the code shows that getInstanceManager() is being called, and an assumption is made that this call will always return not-null, which is not the case. The rest of the code shows that there are valid situations where this returns null.\n\n5075 \ttry {\n5076 \tgetInstanceManager().destroyInstance(listeners[j]);\n5077 \t} catch (Throwable t) {\n5078 \tt = ExceptionUtils.unwrapInvocationTargetException(t);\n5079 \tExceptionUtils.handleThrowable(t);\n5080 \tgetLogger().error\n5081 \t(sm.getString(\"standardContext.listenerStop\",\n5082 \tlisteners[j].getClass().getName()), t);\n5083 \tok = false;\n5084 \t} \n\nThe fix should be a simple null check on or around line 5076.", "id": 181735, "time": "2015-03-13T15:10:13Z", "creator": "minfrin@sharp.fm", "creation_time": "2015-03-13T15:10:13Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 57704, "is_private": false, "id": 181751, "creation_time": "2015-03-14T11:26:55Z", "time": "2015-03-14T11:26:55Z", "creator": "violetagg@apache.org", "text": "Hi,\n\nFix is provided in trunk, 8.0.x for 8.0.21 and 7.0.x for 7.0.60 onwards.\n\nRegards,\nVioleta", "attachment_id": null}]