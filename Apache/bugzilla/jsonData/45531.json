[{"count": 0, "tags": [], "creator": "ondra@dynawest.cz", "attachment_id": null, "text": "HSSFDateUtil.getJavaDate( int ) returns null, because:\n\nisValidExcelDate() returns false for negative numbers.\n\nAlthough, I've tried filling my great-grandmother's birth date (1.8.1898), and Excel stores this as a negative number, which is convertible back to Date using the computation code in getJavaDate(double date, boolean use1904windowing).\n\nIs there some reason for limiting isValidExcelDate() to positive numbers?\n\nI suggest to overload HSSFDateUtil.getJavaDate( int, boolean, boolean ) which would allow converting negative values to date.\n\nThanks, Ondra Zizka.", "id": 119332, "time": "2008-08-03T19:40:51Z", "bug_id": 45531, "creation_time": "2008-08-03T19:40:51Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 45531, "text": "This may be a limitation of Excel (I am having trouble entering dates prior to 1900).  If I am mistaken about this, can you please upload an example spreadsheet with a pre-1900 date stored in one of the cells?\n\n", "id": 119337, "time": "2008-08-04T01:10:23Z", "creator": "josh@apache.org", "creation_time": "2008-08-04T01:10:23Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "ondra@dynawest.cz", "attachment_id": null, "id": 119396, "time": "2008-08-05T05:58:00Z", "bug_id": 45531, "creation_time": "2008-08-05T05:58:00Z", "is_private": false, "text": "When saving with Excel 2003 SP3, pre-1900 dates behave correctly.\nI'll attach the file and check if it uses negative double or some hack.\n\nHowever, I must admit, that the Excel file I've been trying so far was saved using OpenOffice.org.\n\nAnyway, POI could be able to read it, using overloaded method... OOo generated Excel files also count :-)\n\nMay I fix the bug? What do I need for it?"}, {"count": 3, "tags": [], "bug_id": 45531, "attachment_id": null, "is_private": false, "id": 119473, "time": "2008-08-06T00:56:02Z", "creator": "josh@apache.org", "creation_time": "2008-08-06T00:56:02Z", "text": "The functionality (storing dates prior to 1900) you are suggesting makes sense, but it is important to identify exactly what Excel does with the same.\n\nThere are different levels of support that POI might provide:\n(a) to read every file written by MS Office apps\n(b) to produce files readable by MS Office apps\n(c) to read files (produced by other apps) which are readable by MS Office\n(d) to produce files also readable by other apps\n(e) to read files (produced by other apps) which are not readable by MS Office, but presumably readable by the source app. \n(f) to produce files only readable by other apps\n\nGenerally speaking, levels (a)+(b) are high priority, (c)+(d) are low priority and (e)+(f) are mostly avoided.  There is still not enough information to classify this functionality request.  If you could do some further investigation that would be very helpful.  Please upload an OOO and/or Excel example spreadsheet with pre-1900 dates.\n\nIf you want to try writing a patch for this, here is some information about getting started:\nhttp://poi.apache.org/getinvolved/index.html\n\n"}, {"count": 4, "tags": [], "bug_id": 45531, "text": "Created attachment 22399\nXLS file from OpenOffice 2.4.1 stored as Excel 97/2000/XP file\n\nOne column with dates 1.1.1898 to 1.1.1930.", "id": 119535, "time": "2008-08-07T02:21:01Z", "creator": "ondra@dynawest.cz", "creation_time": "2008-08-07T02:21:01Z", "is_private": false, "attachment_id": 22399}, {"count": 5, "tags": [], "bug_id": 45531, "attachment_id": null, "id": 119771, "time": "2008-08-12T17:55:48Z", "creator": "ondra@dynawest.cz", "creation_time": "2008-08-12T17:55:48Z", "is_private": false, "text": "Please excuse some delay on my side - I am applying for a job, so I've to focus that :-)  I will return to the feature request right after. (Posting this comment to prevent this feat.req. being dismissed.)"}]