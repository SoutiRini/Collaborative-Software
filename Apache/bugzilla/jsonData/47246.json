[{"count": 0, "attachment_id": null, "bug_id": 47246, "is_private": false, "id": 127304, "time": "2009-05-22T10:46:58Z", "creator": "jonathan.holloway@gmail.com", "creation_time": "2009-05-22T10:46:58Z", "tags": [], "text": "I get a RecordFormatException, unable to construct record instance when dealing with one particular spreadsheet:\n\nRecordFormatException: \norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\tat org.apache.poi.hssf.record.RecordFactory$ReflectionRecordCreator.create(RecordFactory.java:71)\n\tat org.apache.poi.hssf.record.RecordFactory.createSingleRecord(RecordFactory.java:269)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:408)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:277)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:202)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:184)\n...\nCaused by: org.apache.poi.hssf.record.RecordFormatException: Leftover 32 bytes in subrecord data [15, 00, 12, 00, 14, 00, 02, 00, 11, 00, 00, 00, 00, 00, 00, 7C, FE, 0E, 90, C4, B5, 1D, 0C, 00, 14, 00, 00, 00, 00, 00, 00, 00, 00, 00, 00, 00, 01, 00, 03, 00, 00, 00, 10, 00, 00, 00, 04, 00, 0E, 00, 07, 00, A4, C1, B5, 1D, 39, 0B, 00, 02, 00, 00, 00, 01, 13, 00, DC, 1F, 00, 00, 03, 00, 02, 00, 0A, 00, 00, 00, 00, 00, 08, 00, 00, 00, 00, 00, 00, C3, 0B, 00, 00, 44, 43, 4D, 20, 4C, 49, 4D, 49, 54, 45, 44, 03, 00, 00, 53, 43, 4D, 09, 00, 00, 53, 43, 4D, 44, 43, 4D, 54, 4F, 50]\n\tat org.apache.poi.hssf.record.ObjRecord.<init>(ObjRecord.java:106)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:513)\n\tat org.apache.poi.hssf.record.RecordFactory$ReflectionRecordCreator.create(RecordFactory.java:63)\n\nBiffViewer throws the following exception:\n\n  [java] Offset=0x00009FE0(40928) recno=771 sid=0x0018 size=0x0024(36)\n     [java] [NAME]\n     [java]     .option flags           = 0x0000\n     [java]     .keyboard shortcut      = 0x00\n     [java]     .length of the name     = 10\n     [java]     .extSheetIx(1-based, 0=Global)= 0\n     [java]     .sheetTabIx             = 0\n     [java]     .Menu text length       = 0\n     [java]     .Description text length= 0\n     [java]     .Help topic text length = 0\n     [java]     .Status bar text length = 0\n     [java]     .NameIsMultibyte        = false\n     [java]     .Name (Unicode text)    = xxxxxx\n     [java]     .Formula (nTokens=1):\n     [java]        org.apache.poi.hssf.record.formula.Area3DPtg [sheetIx=0 ! $DH$138:$DH$263]R\n     [java]     .Menu text       = \n     [java]     .Description text= \n     [java]     .Help topic text = \n     [java]     .Status bar text = \n     [java] [/NAME]\n\n[java] Offset=0x0000A008(40968) recno=772 sid=0x01C1 size=0x0008(8)\n     [java] [UNKNOWNRECORD] (0x1C1)\n     [java]   rawData=[C1, 01, 00, 00, 22, BE, 01, 00]\n     [java] [/UNKNOWNRECORD]\n     [java] \n     [java] java.lang.ArrayIndexOutOfBoundsException\n     [java]     at java.lang.System.arraycopy(Native Method)\n     [java]     at org.apache.poi.ddf.EscherMetafileBlip.fillFields(EscherMetafileBlip.java:93)\n     [java]     at org.apache.poi.ddf.EscherBSERecord.fillFields(EscherBSERecord.java:79)\n     [java]     at org.apache.poi.ddf.EscherContainerRecord.fillFields(EscherContainerRecord.java:53)\n     [java]     at org.apache.poi.ddf.EscherContainerRecord.fillFields(EscherContainerRecord.java:53)\n     [java]     at org.apache.poi.hssf.record.AbstractEscherHolderRecord.convertToEscherRecords(AbstractEscherHolderRecord.java:82)\n     [java]     at org.apache.poi.hssf.record.AbstractEscherHolderRecord.<init>(AbstractEscherHolderRecord.java:68)\n     [java]     at org.apache.poi.hssf.record.DrawingGroupRecord.<init>(DrawingGroupRecord.java:41)\n     [java]     at org.apache.poi.hssf.dev.BiffViewer.createRecord(BiffViewer.java:149)\n     [java]     at org.apache.poi.hssf.dev.BiffViewer.createRecords(BiffViewer.java:84)\n     [java]     at org.apache.poi.hssf.dev.BiffViewer.main(BiffViewer.java:398)\n\nThe spreadsheet contains Macros and links, it opens fine in OpenOffice 3.0.1 build 9379."}, {"count": 1, "tags": [], "bug_id": 47246, "text": "Can you attach the problem file? \n\nYegor", "id": 127321, "time": "2009-05-23T00:03:36Z", "creator": "yegor@dinom.ru", "creation_time": "2009-05-23T00:03:36Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "text": "no response in a long time => resolving for now, please reopen with more information ifnthis is still an issue", "is_private": false, "bug_id": 47246, "id": 169110, "time": "2013-08-05T09:37:12Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2013-08-05T09:37:12Z", "attachment_id": null}]