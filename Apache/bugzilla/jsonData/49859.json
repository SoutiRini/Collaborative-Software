[{"count": 0, "tags": [], "bug_id": 49859, "text": "Using the following:\n\nAddHandler   test-file                .tst\nAction       test-file                    /cgi-bin/set.cgi\n\nAnd with set.cgi = \n\n#!/bin/bash\necho\necho\necho \"$@\"\nset\n\nwith an existing file \"test.tst\" and the url:  \"http://host/test.tst\"\neverything is fine = we see eg PATH_TRANSLATED showing \"...test.tst\"\n\nBUG is exposed with same environment, but the url \"http://host/test.tst/ghost.html\"\n\nThe handler sees test.tst and calls set.cgi - however,  PATH_TRANSLATED includes /ghost.html as a part of the path, even though clearly the logic is wrong. \n\nThe url should not trigger the handler - (because the file ..../test.tst/ghost.html does not exist )\nbut should instead trigger a 404.", "id": 139599, "time": "2010-09-01T11:12:40Z", "creator": "ben@redsnapper.net", "creation_time": "2010-09-01T11:12:40Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 49859, "text": "The mapping is due to AcceptPathInfo, and CGI says PATH_INFO should be included in PATH_TRANSLATED.  Followups on users@httpd.apache.org unless there's some gross misunderstanding, in which casr provide verbatim, complete config and log entries.", "id": 139600, "time": "2010-09-01T11:21:07Z", "creator": "covener@gmail.com", "creation_time": "2010-09-01T11:21:07Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 49859, "text": "Eric, thanks. I read up on your comments. I attempted to post a mail as suggested, but was refused.\n\n\"AcceptPathInfo Off\" appears to have no effect when using a suffix handler via AddHandler (the handler in the bug report's case is a bash script calling set)\n\nThe documentation says:\nhttp://httpd.apache.org/docs/2.0/mod/core.html#acceptpathinfo\n\"For example, assume the location /test/ points to a directory that contains only the single file here.html. Then requests for/test/here.html/more and /test/nothere.html/more both collect /more as PATH_INFO.\"\n\n\"Therefore a request with trailing pathname information after the true filename such as /test/here.html/more in the above example will return a 404 NOT FOUND error.\"\n\nHowever, this is not what I find.\n\nHere is the entire apache config file. (note that this is based on a Mac, but the original bug was found on Debian Linux)\n\napache.conf follows (dso.conf is the default set of modules)\n#================================================\nInclude /etc/apache2/dso.conf\nServerRoot /Library/WebServer\nListen 80\n\nUser _www\nGroup _www \n\n<Directory /Library/WebServer/CGI-Executables/>\n\tOptions +ExecCGI\n</Directory>\n\nAddHandler    cgi-script            .cgi\nAddType \t  application/test\t\t.tst\n\nScriptAlias  /cgi/\t/Library/WebServer/CGI-Executables/\nAction       application/test        /cgi/set.cgi\n\n<VirtualHost *:80>\nAcceptPathInfo Off\nOptions -Indexes +FollowSymLinks\nDocumentRoot   Documents/public\n</VirtualHost>\n#================================================\n\nset.cgi follows\n#================================================\n#!/bin/bash\necho Status: 200 OK\necho Content-Type: text/plain\necho\nset\n#================================================\n\nDirectory /Library/WebServer/Documents/public contains one file, called \"here.tst\" which is a text file containing the word \"test\"\n\nResults from the above setting. (taken from the environment as listed by set.cgi above)\nNOTE THAT AcceptPathInfo IS OFF\n\nhttp://127.0.0.1/here.tst/more\n\nPATH_INFO=/here.tst/more\nPATH_TRANSLATED=/Library/WebServer/Documents/public/here.tst/more\n\nWhat I expect is a 404 - after all, AcceptPathInfo is OFF.\n\nIf this is not a bug, how do I ensure that PATH_TRANSLATED always points to a valid file, especially when using AddHandler", "id": 139601, "time": "2010-09-01T12:03:17Z", "creator": "ben@redsnapper.net", "creation_time": "2010-09-01T12:03:17Z", "is_private": false, "attachment_id": null}]