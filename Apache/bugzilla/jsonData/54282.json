[{"count": 0, "tags": [], "text": "Created attachment 29744\nPatch for avoiding repeated calls to size function\n\nI'm seeing Apache POI being very slow when opening certain xslx/XSSF spreadsheets. After profiling, it turns out that around half the time was spent calling CTColsImpl.sizeOfColArray() inside ColumnHelper.addCleanColIntoCols(). See the attached screenshot from my profiler session.\n\nThe fix is trivially simple, it just pulls the call to sizeOfColArray() outside of the loop. On some spreadsheets, this reduces the time of loading the spreadsheet to half of the original time.", "is_private": false, "id": 164032, "creator": "jan.stette@gmail.com", "time": "2012-12-11T17:52:04Z", "bug_id": 54282, "creation_time": "2012-12-11T17:52:04Z", "attachment_id": 29744}, {"count": 1, "tags": [], "creator": "jan.stette@gmail.com", "attachment_id": 29745, "id": 164033, "creation_time": "2012-12-11T17:53:00Z", "time": "2012-12-11T17:53:00Z", "bug_id": 54282, "text": "Created attachment 29745\nScreenshot from profiler session showing bottleneck", "is_private": false}, {"count": 2, "tags": [], "bug_id": 54282, "attachment_id": null, "id": 164035, "time": "2012-12-12T00:48:26Z", "creator": "apache@gagravarr.org", "creation_time": "2012-12-12T00:48:26Z", "is_private": false, "text": "Thanks for this, committed in r1420501."}]