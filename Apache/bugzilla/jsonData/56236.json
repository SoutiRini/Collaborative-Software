[{"count": 0, "tags": [], "creator": "kean12@126.com", "is_private": false, "text": "Created attachment 31377\nerror log\n\nDear contributor\nSince I upgrade my tomcat 7.0.47 to 7.0.52. those kind of issue was found and it is still not fixed yet.\nthis issue was also found on latest tomcate 6 and 8 version. \n\nI attach the error log. please check the attachment.\n\nthis issue was also repoerted by other user but they have not report to offical site yet.\n\nsame symptom:\n\nhttp://stackoverflow.com/questions/21138279/tomcat-7-50jdk-64bit-1-7-0-51-start-up-issues\n\nhttp://bbs.csdn.net/topics/390705454 (Chinese version site) \n\nenvironment:\n\nOS: Win7  (64 BIT)\nJDK :JDK7 with update 51 (64 bit.)\n\nMarch 09, 2014 12:12:15 AM org.apache.catalina.core.AprLifecycleListener init\nINFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: C:\\Program Files\\Java\\jdk1.7.0\\bin;C:\\server\\tomcat 7\\bin\nMarch 09, 2014 12:12:15 AM org.apache.coyote.AbstractProtocol init\nINFO: Initializing ProtocolHandler [\"http-bio-8080\"]\nMarch 09, 2014 12:12:15 AM org.apache.coyote.AbstractProtocol init\nINFO: Initializing ProtocolHandler [\"ajp-bio-8009\"]\nMarch 09, 2014 12:12:15 AM org.apache.catalina.startup.Catalina load\nINFO: Initialization processed in 797 ms\nMarch 09, 2014 12:12:15 AM org.apache.catalina.core.StandardService startInternal\nINFO: Starting service Catalina\nMarch 09, 2014 12:12:15 AM org.apache.catalina.core.StandardEngine startInternal\nINFO: Starting Servlet Engine: Apache Tomcat/7.0.52\nMarch 09, 2014 12:12:15 AM org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory C:\\server\\tomcat 7\\webapps\\docs\nMarch 09, 2014 12:12:16 AM org.apache.catalina.startup.HostConfig deployDirectory\nSEVERE: Error deploying web application directory C:\\server\\tomcat 7\\webapps\\docs\njava.lang.ExceptionInInitializerError\n\tat org.apache.catalina.startup.ContextConfig.createWebXmlDigester(ContextConfig.java:515)\n\tat org.apache.catalina.startup.ContextConfig.init(ContextConfig.java:836)\n\tat org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:382)\n\tat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:117)\n\tat org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)\n\tat org.apache.catalina.util.LifecycleBase.setStateInternal(LifecycleBase.java:402)\n\tat org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:110)\n\tat org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:139)\n\tat org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)\n\tat org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)\n\tat org.apache.catalina.core.StandardHost.addChild(StandardHost.java:632)\n\tat org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1229)\n\tat org.apache.catalina.startup.HostConfig$DeployDirectory.run(HostConfig.java:1875)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:262)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n\tat java.lang.Thread.run(Thread.java:744)\nCaused by: java.lang.NullPointerException\n\tat org.apache.tomcat.util.descriptor.DigesterFactory.idFor(DigesterFactory.java:107)\n\tat org.apache.tomcat.util.descriptor.DigesterFactory.<clinit>(DigesterFactory.java:59)\n\t... 18 more\nMarch 09, 2014 12:12:16 AM org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory C:\\server\\tomcat 7\\webapps\\examples\nMarch 09, 2014 12:12:16 AM org.apache.catalina.startup.HostConfig deployDirectory\nSEVERE: Error deploying web application directory C:\\server\\tomcat 7\\webapps\\examples\njava.lang.NoClassDefFoundError: Could not initialize class org.apache.tomcat.util.descriptor.DigesterFactory\n\tat org.apache.catalina.startup.ContextConfig.createWebXmlDigester(ContextConfig.java:515)\n\tat org.apache.catalina.startup.ContextConfig.init(ContextConfig.java:836)\n\tat org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:382)\n\tat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:117)\n\tat org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)\n\tat org.apache.catalina.util.LifecycleBase.setStateInternal(LifecycleBase.java:402)\n\tat org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:110)\n\tat org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:139)\n\tat org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)\n\tat org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)\n\tat org.apache.catalina.core.StandardHost.addChild(StandardHost.java:632)\n\tat org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1229)\n\tat org.apache.catalina.startup.HostConfig$DeployDirectory.run(HostConfig.java:1875)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:262)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n\tat java.lang.Thread.run(Thread.java:744)\nMarch 09, 2014 12:12:16 AM org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory C:\\server\\tomcat 7\\webapps\\host-manager\nMarch 09, 2014 12:12:16 AM org.apache.catalina.startup.HostConfig deployDirectory\nSEVERE: Error deploying web application directory C:\\server\\tomcat 7\\webapps\\host-manager\njava.lang.NoClassDefFoundError: Could not initialize class org.apache.tomcat.util.descriptor.DigesterFactory\n\tat org.apache.catalina.startup.ContextConfig.createWebXmlDigester(ContextConfig.java:515)\n\tat org.apache.catalina.startup.ContextConfig.init(ContextConfig.java:836)\n\tat org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:382)\n\tat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:117)\n\tat org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)\n\tat org.apache.catalina.util.LifecycleBase.setStateInternal(LifecycleBase.java:402)\n\tat org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:110)\n\tat org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:139)\n\tat org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)\n\tat org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)\n\tat org.apache.catalina.core.StandardHost.addChild(StandardHost.java:632)\n\tat org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1229)\n\tat org.apache.catalina.startup.HostConfig$DeployDirectory.run(HostConfig.java:1875)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:262)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n\tat java.lang.Thread.run(Thread.java:744)\nMarch 09, 2014 12:12:16 AM org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory C:\\server\\tomcat 7\\webapps\\manager\nMarch 09, 2014 12:12:16 AM org.apache.catalina.startup.HostConfig deployDirectory\nSEVERE: Error deploying web application directory C:\\server\\tomcat 7\\webapps\\manager\njava.lang.NoClassDefFoundError: Could not initialize class org.apache.tomcat.util.descriptor.DigesterFactory\n\tat org.apache.catalina.startup.ContextConfig.createWebXmlDigester(ContextConfig.java:515)\n\tat org.apache.catalina.startup.ContextConfig.init(ContextConfig.java:836)\n\tat org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:382)\n\tat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:117)\n\tat org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)\n\tat org.apache.catalina.util.LifecycleBase.setStateInternal(LifecycleBase.java:402)\n\tat org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:110)\n\tat org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:139)\n\tat org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)\n\tat org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)\n\tat org.apache.catalina.core.StandardHost.addChild(StandardHost.java:632)\n\tat org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1229)\n\tat org.apache.catalina.startup.HostConfig$DeployDirectory.run(HostConfig.java:1875)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:262)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n\tat java.lang.Thread.run(Thread.java:744)\nMarch 09, 2014 12:12:16 AM org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory C:\\server\\tomcat 7\\webapps\\ROOT\nMarch 09, 2014 12:12:16 AM org.apache.catalina.startup.HostConfig deployDirectory\nSEVERE: Error deploying web application directory C:\\server\\tomcat 7\\webapps\\ROOT\njava.lang.NoClassDefFoundError: Could not initialize class org.apache.tomcat.util.descriptor.DigesterFactory\n\tat org.apache.catalina.startup.ContextConfig.createWebXmlDigester(ContextConfig.java:515)\n\tat org.apache.catalina.startup.ContextConfig.init(ContextConfig.java:836)\n\tat org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:382)\n\tat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:117)\n\tat org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)\n\tat org.apache.catalina.util.LifecycleBase.setStateInternal(LifecycleBase.java:402)\n\tat org.apache.catalina.util.LifecycleBase.init(LifecycleBase.java:110)\n\tat org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:139)\n\tat org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)\n\tat org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)\n\tat org.apache.catalina.core.StandardHost.addChild(StandardHost.java:632)\n\tat org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1229)\n\tat org.apache.catalina.startup.HostConfig$DeployDirectory.run(HostConfig.java:1875)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:262)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n\tat java.lang.Thread.run(Thread.java:744)\nMarch 09, 2014 12:12:16 AM org.apache.coyote.AbstractProtocol start\nINFO: Starting ProtocolHandler [\"http-bio-8080\"]\nMarch 09, 2014 12:12:16 AM org.apache.coyote.AbstractProtocol start\nINFO: Starting ProtocolHandler [\"ajp-bio-8009\"]\nMarch 09, 2014 12:12:16 AM org.apache.catalina.startup.Catalina start\nINFO: Server startup in 191 ms", "id": 173702, "time": "2014-03-08T16:30:51Z", "bug_id": 56236, "creation_time": "2014-03-08T16:30:51Z", "attachment_id": 31377}, {"count": 1, "tags": [], "text": "incate the tomcat version", "is_private": false, "bug_id": 56236, "id": 173703, "time": "2014-03-08T16:32:12Z", "creator": "kean12@126.com", "creation_time": "2014-03-08T16:32:12Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "knst.kolinko@gmail.com", "attachment_id": null, "is_private": false, "id": 173711, "time": "2014-03-08T19:20:04Z", "bug_id": 56236, "creation_time": "2014-03-08T19:20:04Z", "text": "(In reply to kean12 from comment #0)\n>\n> INFO: Starting Servlet Engine: Apache Tomcat/7.0.52\n>(...)\n> SEVERE: Error deploying web application directory C:\\server\\tomcat\n> 7\\webapps\\docs\n>(...)\n> Caused by: java.lang.NullPointerException\n> \tat\n> org.apache.tomcat.util.descriptor.DigesterFactory.idFor(DigesterFactory.java:\n> 107)\n> \tat\n> org.apache.tomcat.util.descriptor.DigesterFactory.<clinit>(DigesterFactory.\n> java:59)\n>\n\nThis should have been fixed in the versions that you are using!\n\n(Thanks to bugs 56045 and 56016 that have been reported for 7.0.50).\n\nThis behaviour of DigesterFactory is a result of our work on blocking CVE-2013-4590. Essentially, DigesterFactory populates a table with resource URLs of schema and DTD files bundled in Tomcat's servlet-api.jar.\n\nThis NPE happens when classloader cannot locate those files and returns 'null' instead of a valid URL.\n\nMy guess is that you have a mess either in your CLASSPATH or in CATALINA_BASE/lib, CATALINA_HOME/lib directories. Essentially that you have a rogue Servlet API jar file that does not belong to Tomcat.  That is that a classloader has loaded a wrong \"javax.servlet.ServletContext\" class that does not belong to our servlet-api.jar."}, {"count": 3, "tags": [], "creator": "kean12@126.com", "attachment_id": null, "is_private": false, "id": 173712, "time": "2014-03-09T02:56:14Z", "bug_id": 56236, "creation_time": "2014-03-09T02:56:14Z", "text": "Dear Konstantin Kolinko\nthank you for your suggestion. your suggestion is correct after I clean up java folder and reinstall java.\n\nHave a nice day"}, {"count": 4, "attachment_id": null, "bug_id": 56236, "is_private": false, "id": 173816, "time": "2014-03-14T11:33:54Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2014-03-14T11:33:54Z", "tags": [], "text": "The behaviour was changed in 8.0.4, 7.0.53 (and proposed for 6.0.x) to log a warning instead of failing fatally with an NullPointerException.\n\nThe text of the warning will be:\n The XML schema [{0}] could not be found. This is very likely to break XML validation if XML validation is enabled.\n\nNote though that in my opinion any configuration that uses wrong servlet-api JAR at runtime is a broken one.\n\nDiscussion:\nhttp://marc.info/?t=139055909300001&r=1&w=2\n\n[quote]\nFor example, Cookie.java relies on certain configuration properties\ndefined by Tomcat documentation to provide secure and\nspecification-compliant behaviour.  You cannot swap that\nimplementation with random other.\n[/quote]"}, {"count": 5, "tags": [], "creator": "knst.kolinko@gmail.com", "attachment_id": null, "text": "(In reply to Konstantin Kolinko from comment #4)\n> The behaviour was changed in 8.0.4, 7.0.53 (and proposed for 6.0.x) to log a\n> warning instead of failing fatally with an NullPointerException.\n> \n\nApplied to Tomcat 6 as well in r1578369, will be in 6.0.40.\n\n> Note though that in my opinion any configuration that uses wrong\n> servlet-api JAR at runtime is a broken one.", "id": 173883, "time": "2014-03-17T20:01:17Z", "bug_id": 56236, "creation_time": "2014-03-17T20:01:17Z", "is_private": false}]