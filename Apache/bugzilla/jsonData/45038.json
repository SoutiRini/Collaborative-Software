[{"count": 0, "tags": [], "bug_id": 45038, "text": "Hello, \n\nwith the version 3.0.1 of POI I can do this code : \nis = new FileInputStream(myExcelFile);\nPOIFSFileSystem poifsFileSystem = new POIFSFileSystem(is);\nHSSFWorkbook wb = new HSSFWorkbook(poifsFileSystem, false);\n\nHowever, when I want to use the version 3.0.2 of POI (for use the Class \"HSSFFormulaEvaluator\"), it's impossible : \nHSSFWorkbook wb = new HSSFWorkbook(poifsFileSystem, false);  // Exception with 3.0.2 (and 2.5.1), no probleme with 3.0.1\n\nThe Exception is : \norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:199)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:117)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:207)\n\tat business.extractfees.Go.doTreatmentByExcelFile(Go.java:298)\n\tat business.extractfees.Go.extractDataFromRepertoryGeneral(Go.java:205)\n\tat business.extractfees.Go.doTreatment(Go.java:87)\n\tat business.extractfees.Go.main(Go.java:67)\nCaused by: java.lang.reflect.InvocationTargetException\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:274)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:187)\n\t... 6 more\nCaused by: java.lang.UnsupportedOperationException:  Unknown Ptg in Formula: 0x2 (2)\n\tat org.apache.poi.hssf.record.formula.Ptg.createPtg(Ptg.java:357)\n\tat org.apache.poi.hssf.record.DVRecord.fillFields(DVRecord.java:201)\n\tat org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n\tat org.apache.poi.hssf.record.DVRecord.<init>(DVRecord.java:134)\n\t... 11 more\n\n\nI use for POI 3.0.1 : \n3.0.1 : \npoi-3.0.1-FINAL-20070705.jar\npoi-contrib-3.0.1-FINAL-20070705.jar \npoi-scratchpad-3.0.1-FINAL-20070705.jar\n\nand for POI 3.0.2 : \npoi-3.0.2-FINAL-20080204.jar\npoi-contrib-3.0.2-FINAL-20080204.jar \npoi-scratchpad-3.0.2-FINAL-20080204.jar\n\n\nNB : the file that I open is not on my station, but on the network; and the file is open ONLY for reading (protected by password if you want to write). \n\n\nSo, is it normal that I can open the file with the version 3.0.1, but not with 3.0.2 ? \nIs it possible to try to evaluate a Formula with POI 3.0.1 ? \n\nSincerely,", "id": 116815, "time": "2008-05-19T08:06:41Z", "creator": "pechereau_l@yahoo.fr", "creation_time": "2008-05-19T08:06:41Z", "is_private": false, "attachment_id": null}, {"count": 1, "text": "Between versions 3.0.1 and 3.0.2 support for data validation was added. Before then, DVRecord and DVALRecord were uninterpreted by POI so the formulas contained within were uninterpreted too.\n\nThere are many possible explanations for why POI has failed in this way.  The only way to know for sure would be for you to upload an example of the offending spreadsheet.\n\nIt's possible that the formula truly does contain Ptg 0x02 (=tTbl), in which case this bug is the same as bug 44958.  It's also possible that there is some other bug that causes POI to get out of alignment while reading the token data. Many bugs have been fixed since 3.0.2 (for example bug 44710) so it might be worth trying out 3.1-beta1.  Even more recently bug 44306 (which could have symptoms like this) was fixed. it might be worth trying out the latest svn trunk.", "creator": "josh@apache.org", "is_private": false, "id": 116816, "time": "2008-05-19T08:34:24Z", "bug_id": 45038, "creation_time": "2008-05-19T08:34:24Z", "tags": [], "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 45038, "attachment_id": null, "text": "I am going to resolve this as FIXED - judging from Josh's comments. Without a response from the OP this is the best we can do.", "id": 124952, "time": "2009-02-18T12:32:06Z", "creator": "dfisher@jmlafferty.com", "creation_time": "2009-02-18T12:32:06Z", "is_private": false}]