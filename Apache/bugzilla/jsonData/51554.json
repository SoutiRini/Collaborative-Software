[{"count": 0, "tags": [], "bug_id": 51554, "attachment_id": null, "id": 148148, "time": "2011-07-25T20:58:17Z", "creator": "bryan_coleman@dart.biz", "creation_time": "2011-07-25T20:58:17Z", "is_private": false, "text": "Using version 3.7 and 3.8-beta3\n\nHSSFSheet.autoSizeColumn calculates the size of a column with capital letters too small.  Unfortunately, the test is visual.  With the test below, notice how the \"TEST\" and \"HIPS\" columns are too small.\n\nTo reproduce:\n\nimport org.apache.poi.hssf.usermodel.*;\nimport java.io.*;\n\npublic class AutoSizeTest {\n\n    public static void main(String args[]) {\n        HSSFWorkbook workbook = new HSSFWorkbook();\n        HSSFSheet sheet = workbook.createSheet();\n        HSSFRow row = sheet.createRow(0);\n        HSSFCell cell0 = row.createCell(0);\n        HSSFCell cell1 = row.createCell(1);\n        HSSFCell cell2 = row.createCell(2);\n        HSSFCell cell3 = row.createCell(3);\n        HSSFCell cell4 = row.createCell(4);\n        cell0.setCellValue(\"TEST\");\n        cell1.setCellValue(\"test\");\n        cell2.setCellValue(\"ZZZZ\");\n        cell3.setCellValue(\"zzzz\");\n        cell4.setCellValue(\"HIPS\");\n        sheet.autoSizeColumn(0);\n        sheet.autoSizeColumn(1);\n        sheet.autoSizeColumn(2);\n        sheet.autoSizeColumn(3);\n        sheet.autoSizeColumn(4);\n\n        try {\n            FileOutputStream out = new FileOutputStream(\"working.xls\");\n            workbook.write(out);\n            out.close();\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n    } // main\n}"}, {"count": 1, "text": "Created attachment 27315\nsample file generated using the latest build from trunk", "bug_id": 51554, "attachment_id": 27315, "id": 148161, "time": "2011-07-26T07:40:41Z", "creator": "yegor@dinom.ru", "creation_time": "2011-07-26T07:40:41Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 51554, "attachment_id": null, "id": 148162, "time": "2011-07-26T07:45:43Z", "creator": "yegor@dinom.ru", "creation_time": "2011-07-26T07:45:43Z", "is_private": false, "text": "\nThere have been updates in HSSFSheet.autoSizeColumn since 3.8-beta3, please try with the latest build from trunk. Daily builds can be downloaded from here:\nhttp://encore.torchbox.com/poi-cvs-build/\n\n\nSee attached sample generated with the latest build from trunk. All columns including TEST and HIPS are properly re-sized.\n\nYegor"}, {"count": 3, "tags": [], "creator": "bryan_coleman@dart.biz", "attachment_id": null, "text": "I tried poi-3.8-beta4-20110727.jar and it looks the same as version 3.7 / 3.8-beta3.  I opened the provided attached file and it looks good.  What version should I be trying?  Is there any way to verify the poi version in the output (xls) file?", "id": 148210, "time": "2011-07-27T12:48:24Z", "bug_id": 51554, "creation_time": "2011-07-27T12:48:24Z", "is_private": false}, {"count": 4, "attachment_id": null, "bug_id": 51554, "text": "See the FAQ for how to check what POI version you're running - http://poi.apache.org/faq.html#faq-N10006\n\nAlso, are you sure you have the correct fonts installed? Sizing columns requires the font to work out how big letters render - can you confirm you have appropriate fonts installed?", "id": 148211, "time": "2011-07-27T12:51:58Z", "creator": "apache@gagravarr.org", "creation_time": "2011-07-27T12:51:58Z", "tags": [], "is_private": false}, {"count": 5, "attachment_id": null, "bug_id": 51554, "text": "Thank you for the information on finding the poi version.  It doesn't really show how to obtain it from the output; however, the information was valuable.\n\nCorrect fonts installed?\n\n  Are you referring to the fonts of the underlying system?  Or, in my java classpath/libraries/etc?  I know I didn't install any fonts specifically for this purpose.  For reference: I am running linux Fedora version 15.", "id": 148221, "time": "2011-07-27T17:06:56Z", "creator": "bryan_coleman@dart.biz", "creation_time": "2011-07-27T17:06:56Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "bug_id": 51554, "attachment_id": null, "id": 148225, "time": "2011-07-27T17:21:54Z", "creator": "apache@gagravarr.org", "creation_time": "2011-07-27T17:21:54Z", "is_private": false, "text": "(In reply to comment #5)\n> Thank you for the information on finding the poi version.  It doesn't really\n> show how to obtain it from the output; however, the information was valuable.\n\nYou should get a jar filename, which will have the version string in it (unless you've done something strange and renamed the jar that is!)\n \n\n> Correct fonts installed?\n> \n>   Are you referring to the fonts of the underlying system?  Or, in my java\n> classpath/libraries/etc?  I know I didn't install any fonts specifically for\n> this purpose.  For reference: I am running linux Fedora version 15.\n\nThe fonts need to be available and usable by Java. You firstly need to ensure that all the required fonts are installed on your system, then you need to ensure that Java looks for them. Installing the required true type fonts is distro specific. Once installed, either set the JAVA_FONTS environment variable to point to the directory containing them, or edit the JRE font properties file to list the directory in something like the \"appendedfontpath\" entry\n\nTry something like the code on http://silveiraneto.net/2010/01/05/java-font-list/ to list the fonts that Java can see. If the one excel uses isn't there, or at least one very close, then POI doesn't know how big your text is so can't correctly size"}, {"count": 7, "tags": [], "bug_id": 51554, "attachment_id": null, "id": 148226, "time": "2011-07-27T17:54:55Z", "creator": "bryan_coleman@dart.biz", "creation_time": "2011-07-27T17:54:55Z", "is_private": false, "text": "I see that makes the problem more interesting.  We are using poi to generate reports via linux system and distributing those reports to windows based clients.  There may be a list that matches fonts from linux to microsoft ones that would get us close.  I don't know what the licensing requirements would be to use the microsoft ones directly from linux.  Thank you for the explanation."}, {"count": 8, "tags": [], "bug_id": 51554, "text": "It might be worthwhile discussing the use of Adobe Font Metric files when fonts are not available. For years this was not possible due to licensing issues, but now if you look at http://www.apache.org/legal/resolved.html you will see that the Adobe AFM license is considered similar to the Apache License 2.0.", "id": 148227, "time": "2011-07-27T18:02:25Z", "creator": "dfisher@jmlafferty.com", "creation_time": "2011-07-27T18:02:25Z", "is_private": false, "attachment_id": null}]