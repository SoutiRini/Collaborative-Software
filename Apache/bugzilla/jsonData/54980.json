[{"count": 0, "tags": [], "bug_id": 54980, "attachment_id": null, "text": "As stated in http://tomcat.apache.org/tomcat-7.0-doc/config/context.html, setting 'cookie' attribute to 'false' should disable the use of cookies for session identifier communication. But it turns out not to work. The JSESSIONID cookie is still generated and saved in browser side.\n\nThis happens when user doesn't specify \"tracking-mode\" (http://www.e-zest.net/blog/new-session-management-features-in-servlet-3-0/) in the web.xml, which is the default behavior.\n\n\nBelow is some analysis I'd give after doing some debugging with Tomcat's source code (tag: TOMCAT_7_0_27).\n\n(setting 'cookie' attribute to 'false' in WEB-INF/context.xml)\n\nThe JSESSIONID cookie is generated in Request#doGetSession(boolean):line 2891. As no \"tracking-mode\" is given in web.xml, the call of ServletContext#getEffectiveSessionTrackingModes() falls back to #getDefaultSessionTrackingModes(). There's no problem here.\n\nThe problem is the ServletContext is initialized before the 'cookie' attribute is read from context.xml. Specifically, StandardContext#getServletContext() is called before ContextConfig#processContextConfig(Digest, URL).\n\nHence, when initializing a ServletContext, the referenced StandardContext's \"cookies\" field is in default value \"true\" which wrongly initializes its \"defaultSessionTrackingModes\" with COOKIE mode!\n\nOne solution I'd give is when a StandardContext's \"cookie\" field is changed, re-initialize the referenced ServletContext.\n\nOr make sure ContextConfig#processContextConfig(Digest, URL) is called before any StandardContext#getServletContext() call.", "id": 167228, "time": "2013-05-16T07:28:08Z", "creator": "bishen@ebay.com", "creation_time": "2013-05-16T07:28:08Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 54980, "attachment_id": null, "text": "(In reply to comment #0)\n> \n> (setting 'cookie' attribute to 'false' in WEB-INF/context.xml)\n> \n\nDid you mean META-INF/context.xml or you really mean WEB-INF/context.xml?\n\n\nI cannot observe the described behavior on the latest Tomcat version (7.0.40).\n\n\nCan you provide an example that illustrates the problem against 7.0.40?\n\n\nRegards\nVioleta", "id": 167384, "time": "2013-05-23T16:09:41Z", "creator": "violetagg@apache.org", "creation_time": "2013-05-23T16:09:41Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 54980, "text": "I meant MEAT-INF/.\n\nSorry, I cannot re-produce it in a clean Tomcat server. Previously, I actually encountered this issue in Geronimo 3 which embeds Tomcat 7.0.27 version. So it must be related to the customization in Geronimo server.\n\nMarked it as invalid. Thanks for looking into this.", "id": 167392, "time": "2013-05-24T03:28:53Z", "creator": "bishen@ebay.com", "creation_time": "2013-05-24T03:28:53Z", "is_private": false, "attachment_id": null}]