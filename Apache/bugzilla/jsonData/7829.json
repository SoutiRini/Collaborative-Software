[{"count": 0, "tags": [], "creator": "Apache-bugzilla@Stolsvik.com", "attachment_id": null, "is_private": false, "id": 12999, "time": "2002-04-08T08:39:55Z", "bug_id": 7829, "creation_time": "2002-04-08T08:39:55Z", "text": "[TC4.0.3, Jre 1.4.0, Linux 7.2]\nIf you after a redirect try to close the output stream as in:\n\n        try {\n            // Getting encoding\n            String encoding = res.getCharacterEncoding();\n            // Setting content type\n            res.setContentType(\"text/html; charset=\" + encoding);\n            // Getting the OutputStream (just to be able to close it)\n            OutputStream out = res.getOutputStream();\n            // Sending the redirect\n            res.sendRedirect(Configuration.getDEFAULT_MAINPAGE());\n            // close output stream\n            out.close();\n        }\n        catch (IOException e) {\n            throw new ServerException(\"Got IOException while trying to redirect\nuser to [\"+Configuration.getDEFAULT_MAINPAGE()+\"].\", e);\n        }\n\nYou get weird errors. On 4.0.1, I had to do this to be sure that the client\nexited, a load tester package (loadsim, Java stuff, based on some Apache stuff,\nusing java.net.HttpConnection or whatever it's called) I used didn't \"let go\"\n(but the web browsers did) unless I did this.\n\n\nDoing this with 4.0.3 on Sun's JRE 1.4.0 I get this error:\n\n[Nested Exception] this: com.corelets.api.ServerException: Got IOException while\ntrying to redirect user to [Renderer]., nested: java.io.IOException: Cannot find\nmessage associated with key 'responseStream.suspended'\n        at com.corelets.servlets.Parameters.doCCSGet(Parameters.java:146)\n        at com.corelets.servlets.CCSServlet.callServiceMethod(CCSServlet.java:698)\n\nThis is the \"nested exception\":\n\njava.io.IOException: Cannot find message associated with key\n'responseStream.suspended'\n        at\norg.apache.catalina.connector.http.HttpResponseStream.close(HttpResponseStream.java:202)\n        at com.corelets.servlets.Parameters.doCCSGet(Parameters.java:143)\n        at com.corelets.servlets.CCSServlet.callServiceMethod(CCSServlet.java:698)\n        at com.corelets.servlets.CCSServlet.showAppropriatePage(CCSServlet.java:581)\n        at com.corelets.servlets.CCSServlet.process2(CCSServlet.java:413)\n        at com.corelets.servlets.CCSServlet.process(CCSServlet.java:300)\n        at com.corelets.servlets.CCSServlet.doGet(CCSServlet.java:177)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:740)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:247)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)\n\n..........\n\nClosing that stream is probably wrong, but the error wasn't exactly clear about\nit. And the way it works have changed..."}, {"count": 1, "tags": [], "bug_id": 7829, "attachment_id": null, "text": "After the redirect, the response is finished, so your stream is invalid (that's\nwhy you get the exception). The message string has been forgotten, apparently.", "id": 13002, "time": "2002-04-08T10:02:31Z", "creator": "remm@apache.org", "creation_time": "2002-04-08T10:02:31Z", "is_private": false}, {"count": 2, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "is_private": false, "id": 16042, "time": "2002-05-14T00:20:59Z", "bug_id": 7829, "creation_time": "2002-05-14T00:20:59Z", "text": "Fixed. The fix will be in 4.0.4 and 4.1.2. Thanks."}, {"count": 3, "attachment_id": null, "bug_id": 7829, "is_private": false, "id": 16044, "time": "2002-05-14T00:22:22Z", "creator": "remm@apache.org", "creation_time": "2002-05-14T00:22:22Z", "tags": [], "text": "*** Bug 7402 has been marked as a duplicate of this bug. ***"}]