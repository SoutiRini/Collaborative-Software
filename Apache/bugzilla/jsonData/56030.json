[{"attachment_id": 31227, "tags": [], "creator": "mattiase@acm.org", "is_private": false, "count": 0, "id": 172473, "time": "2014-01-18T14:50:39Z", "bug_id": 56030, "creation_time": "2014-01-18T14:50:39Z", "text": "Created attachment 31227\napr-getopt-error-code.patch\n\nThe error messages of getopt are tricky to localise properly, since they are served as fprintf-like function invocations only. Since there is only very few distinct messages, the best solution is to introduce some sort of codes that the application can do whatever it wants with.\n\nHere is a patch that does exactly that. It is entirely source and, by virtue of a slightly sleazy hack, binary compatible. That hack can be eliminated if we get to break binary compatibility; source compatibility would still be retained. I'd suggest using the hack in 1.x and doing it cleanly (by adding a apr_getopt_t member) in 2.x.\n\nThe getopt code is ancient and it shows: nobody would have exposed a struct like that in an API design today, but it's what we have to work with.\n\nPlease review, and tell me if I should supply a commit message, CHANGES addition and so on. The patch is textually against trunk, although it contains the compatibility hack mentioned above only needed in 1.x."}, {"count": 1, "tags": [], "bug_id": 56030, "text": "Comment on attachment 31227\napr-getopt-error-code.patch\n\nAttachment properly marked as patch in Bugzilla.", "id": 172474, "time": "2014-01-18T14:51:51Z", "creator": "mattiase@acm.org", "creation_time": "2014-01-18T14:51:51Z", "is_private": false, "attachment_id": 31227}]