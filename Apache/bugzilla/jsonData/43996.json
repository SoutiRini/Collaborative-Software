[{"count": 0, "tags": [], "bug_id": 43996, "attachment_id": null, "id": 111276, "time": "2007-11-29T10:55:29Z", "creator": "wenjun@creditex.com", "creation_time": "2007-11-29T10:55:29Z", "is_private": false, "text": "Found one Java-level deadlock:\n\n=============================\n\n\"Dispatcher-Thread-4\":\n\n  waiting to lock monitor 0x08115e04 (object 0xe9fcad00, a\norg.apache.catalina.loader.ResourceEntry),\n\n  which is held by \"Dispatcher-Thread-2\"\n\n\"Dispatcher-Thread-2\":\n\n  waiting to lock monitor 0x08115484 (object 0x80e66408, a\norg.apache.catalina.loader.WebappClassLoader),\n\n  which is held by \"Dispatcher-Thread-4\"\n\n \n\nJava stack information for the threads listed above:\n\n===================================================\n\n\"Dispatcher-Thread-4\":\n\n        at\norg.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:1766)\n\n        - waiting to lock <0xe9fcad00> (a org.apache.catalina.loader.ResourceEntry)\n\n        at\norg.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:872)\n\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1325)\n\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1204)\n\n        at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:319)\n\n        - locked <0x80e66408> (a org.apache.catalina.loader.WebappClassLoader)\n\n        at java.lang.ClassLoader.defineClass1(Native Method)\n\n        at java.lang.ClassLoader.defineClass(ClassLoader.java:620)\n\n        at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:124)\n\n        at\norg.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:1815)\n\n        - locked <0xe9fcb228> (a org.apache.catalina.loader.ResourceEntry)\n\n        at\norg.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:872)\n\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1325)\n\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1204)\n\n        at\njavax.activation.MailcapCommandMap.getDataContentHandler(MailcapCommandMap.java:590)\n\n        at\njavax.activation.MailcapCommandMap.createDataContentHandler(MailcapCommandMap.java:550)\n\n        - locked <0xe9f2b988> (a javax.activation.MailcapCommandMap)\n\n        at javax.activation.DataHandler.getDataContentHandler(DataHandler.java:611)\n\n        - locked <0xe9fcb268> (a javax.activation.DataHandler)\n\n        at javax.activation.DataHandler.writeTo(DataHandler.java:315)\n\n        at javax.mail.internet.MimeUtility.getEncoding(MimeUtility.java:248)\n\n        at javax.mail.internet.MimeBodyPart.updateHeaders(MimeBodyPart.java:1268)\n\n        at javax.mail.internet.MimeBodyPart.updateHeaders(MimeBodyPart.java:1001)\n\n        at javax.mail.internet.MimeMultipart.updateHeaders(MimeMultipart.java:333)\n\n        at javax.mail.internet.MimeBodyPart.updateHeaders(MimeBodyPart.java:1255)\n\n        at javax.mail.internet.MimeMessage.updateHeaders(MimeMessage.java:2012)\n\n        at javax.mail.internet.MimeMessage.saveChanges(MimeMessage.java:1980)\n\n        at javax.mail.Transport.send(Transport.java:97)\n\n        at org.apache.log4j.net.SMTPAppender.sendBuffer(Unknown Source)\n\n        at org.apache.log4j.net.SMTPAppender.append(Unknown Source)\n\n        at org.apache.log4j.AppenderSkeleton.doAppend(AppenderSkeleton.java:230)\n\n        - locked <0x80ebafa8> (a org.apache.log4j.net.SMTPAppender)\n\n        at\norg.apache.log4j.helpers.AppenderAttachableImpl.appendLoopOnAppenders(AppenderAttachableImpl.java:65)\n\n        at org.apache.log4j.AsyncAppender$Dispatcher.run(AsyncAppender.java:578)\n\n        - locked <0x80ebad38> (a org.apache.log4j.helpers.AppenderAttachableImpl)\n\n        at java.lang.Thread.run(Thread.java:595)\n\n\"Dispatcher-Thread-2\":\n\n        at java.lang.ClassLoader.defineClass1(Native Method)\n\n        at java.lang.ClassLoader.defineClass(ClassLoader.java:620)\n\n        at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:124)\n\n        at\norg.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:1815)\n\n        - locked <0xe9fcad00> (a org.apache.catalina.loader.ResourceEntry)\n\n        at\norg.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:872)\n\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1325)\n\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1204)\n\n        at\njavax.activation.MailcapCommandMap.getDataContentHandler(MailcapCommandMap.java:590)\n\n        at\njavax.activation.MailcapCommandMap.createDataContentHandler(MailcapCommandMap.java:550)\n\n        - locked <0xea094e50> (a javax.activation.MailcapCommandMap)\n\n        at javax.activation.DataHandler.getDataContentHandler(DataHandler.java:611)\n\n        - locked <0xea060a98> (a javax.activation.DataHandler)\n\n        at javax.activation.DataHandler.writeTo(DataHandler.java:315)\n\n        at javax.mail.internet.MimeUtility.getEncoding(MimeUtility.java:248)\n\n        at javax.mail.internet.MimeBodyPart.updateHeaders(MimeBodyPart.java:1268)\n\n        at javax.mail.internet.MimeBodyPart.updateHeaders(MimeBodyPart.java:1001)\n\n        at javax.mail.internet.MimeMultipart.updateHeaders(MimeMultipart.java:333)\n\n        at javax.mail.internet.MimeBodyPart.updateHeaders(MimeBodyPart.java:1255)\n\n        at javax.mail.internet.MimeMessage.updateHeaders(MimeMessage.java:2012)\n\n        at javax.mail.internet.MimeMessage.saveChanges(MimeMessage.java:1980)\n\n        at javax.mail.Transport.send(Transport.java:97)\n\n        at org.apache.log4j.net.SMTPAppender.sendBuffer(Unknown Source)\n\n        at org.apache.log4j.net.SMTPAppender.append(Unknown Source)\n\n        at org.apache.log4j.AppenderSkeleton.doAppend(AppenderSkeleton.java:230)\n\n        - locked <0x80eb2f20> (a org.apache.log4j.net.SMTPAppender)\n\n        at\norg.apache.log4j.helpers.AppenderAttachableImpl.appendLoopOnAppenders(AppenderAttachableImpl.java:65)\n\n        at org.apache.log4j.AsyncAppender$Dispatcher.run(AsyncAppender.java:578)\n\n        - locked <0x80eb2a90> (a org.apache.log4j.helpers.AppenderAttachableImpl)\n\n        at java.lang.Thread.run(Thread.java:595)"}, {"count": 1, "tags": [], "text": "This looks like a problem with org.apache.catalina.loader.WebappClassLoader.loadClass() to me.\n\nSimilar deadlocks have been reported at \n\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=10967.\nhttp://mail-archives.apache.org/mod_mbox/tomcat-\ndev/200702.mbox/%3Caf3311880702210317v961dc51xf0cd41c51bde66ca@mail.gmail.com%3E\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=11307\n\nI would suggest making sure that you are using the latest Tomcat release (or at least a release after the \nfixes from the previous bug reports have been applied) and if it still occurs to raise the issue on the \ntomcat-dev mailing list or change the bug to be a Tomcat bug (or both).\n\nI'm marking the bug as NEEDINFO.  If it still occurs with a current Tomcat release, please specify the \nTomcat release in use and change the product to Tomcat 3, 4, 5 or 6 as appropriate.  If it has been \nfixed by later Tomcat releases, mark it as a duplicate, invalid or whatever you feel is appropriate.", "attachment_id": null, "id": 111281, "creator": "carnold@apache.org", "time": "2007-11-29T12:38:53Z", "bug_id": 43996, "creation_time": "2007-11-29T12:38:53Z", "is_private": false}, {"count": 2, "attachment_id": null, "bug_id": 43996, "text": "According to comment 1 this should be in NEEDINFO (but is in NEW).\n\nI agree that this is a class loading issue, and that Tomcat is the likely culprit.  I would suggest that this bug report is set to CLOSED with a comment about reopening if this still appears in fixed Tomcats or other containers.", "id": 118128, "time": "2008-06-30T13:06:00Z", "creator": "thorbjoern@gmail.com", "creation_time": "2008-06-30T13:06:00Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 43996, "text": "Marking as INVALID.  This is a Tomcat bug, very similar to the fixed bugs 10967 and 11307.  Without additional info about Tomcat version in use, it is impossible to know if this is a manifestation of those fixed bugs or a similar new bug.  Since the reporter has not responded to requests for more info, it wouldn't help Tomcat to move this into their bug queue.", "id": 119722, "attachment_id": null, "creator": "carnold@apache.org", "creation_time": "2008-08-12T08:57:50Z", "time": "2008-08-12T08:57:50Z", "is_private": false}]