[{"count": 0, "tags": [], "bug_id": 45391, "attachment_id": 22250, "id": 118612, "time": "2008-07-13T22:49:37Z", "creator": "vinu.kumar@gmail.com", "creation_time": "2008-07-13T22:49:37Z", "is_private": false, "text": "Created attachment 22250\nSampe ppt for the bug\n\nFollowing code is for reading a line in the ppt and converting to a graphics object.\n\n// Read all shapes\n...\n\nif  (type == ShapeTypes.Line)\n{\n  Line l = (Line)s;\n  Rectangle a = l.getAnchor();\n  int w = a.width;\n  int h = a.height;\n  double x = a.getX();\n  double y = a.getY();\n  \n  BufferedImage img = new BufferedImage(w,h,BufferedImage.TYPE_INT_RGB);\n  Graphics2D g = img.createGraphics();\n  l.draw(graphics);\n  // ... Draw the image\n\n}\n\nThe issue is the height and width returned from anchor is smaller that actual size.\n\nIf a ppt has a table, the table is drawn half."}, {"count": 1, "tags": [], "bug_id": 45391, "attachment_id": null, "id": 118876, "time": "2008-07-21T11:08:32Z", "creator": "yegor@dinom.ru", "creation_time": "2008-07-21T11:08:32Z", "is_private": false, "text": "Anchor doesn't take into account the line width. \nIf you want to draw individual lines you need to set the image dimensions\nas max(linewidth, anchor.width) and max(linewidth, anchor.height):\n\n   Rectangle2D a = l.getAnchor2D();\n   double w = Math.max(a.getWidth(), l.getLineWidth());\n   double h = Math.max(a.getHeight(), l.getLineWidth());\n\n   BufferedImage img = new BufferedImage((int) Math.round(w), (int) Math.round(h), BufferedImage.TYPE_INT_RGB);\n\nRegards,\nYegor\n"}]