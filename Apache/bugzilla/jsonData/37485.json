[{"count": 0, "tags": [], "bug_id": 37485, "attachment_id": null, "id": 82437, "time": "2005-11-14T09:37:22Z", "creator": "jmelichna@gitus.cz", "creation_time": "2005-11-14T09:37:22Z", "is_private": false, "text": "Hi!\n\nI'm porting some j2ee web based applications from BEA Web Logic to Tomcat 5.5. \nIn BEA Web Lobic connection pool it is possible to specify ini qurery that \nserver runs after connection is created (before first use). It's very good for \nexample of national settings in Oracle. For correct czech sorting i have to \nrun \"setting query\":\n\nALTER SESSION SET NLS_SORT = XCZECH\n\nFirst time i tryed to write interceptor into my application. This interceptor \nset ALTER SESSION SET NLS_SORT = XCZECH before evey sorted query (SELECT ... \nORDER BY...), but i had some performance problems. So i starded to work with \nDBCP. I was very wandered about DBCP packages in Tomcat 5.5 and i did not find \nsources of naming-factory-dbcp.jar. So i had to refactor, change and compile \nfull DBCP and now i'm afraid of some library conflicts (full DBCP, full Pool \nand full Collections refactored into tomcat packages), but performance is OK \nand tests of my application seems good.\n\nI added property connectionInitSql for int SQL into BasicDataSource. I had to \nmofify BasicDataSourceFactory for correct setting of this property. Property \nis used in method createConnection() of DriverConnectionFactory to init \nConnection. \n\nIt would be very nice if you will add this init feature into Tomcat DBCP.\n\nBest regards\nJiri Melichna"}, {"count": 1, "tags": [], "bug_id": 37485, "attachment_id": 16958, "id": 82438, "time": "2005-11-14T09:42:51Z", "creator": "jmelichna@gitus.cz", "creation_time": "2005-11-14T09:42:51Z", "is_private": false, "text": "Created attachment 16958\nMy changes in BasicDataSource of Tomcat DBCP\n\nInit SQL in resource Context setting:\n\n<Resource name=\"jdbc/CzechSortDS\" auth=\"Container\"\n\t      type=\"javax.sql.DataSource\" \n\t      driverClassName=\"oracle.jdbc.driver.OracleDriver\"\n\t      url=\"jdbc:oracle:thin:@server:1521:sid\"\n\t      factory=\"org.apache.tomcat.dbcp.dbcp.BasicDataSourceFactory\"\n\t      username=\"xxxx\" \n\t      password=\"xxxx\" \n\t      maxActive=\"40\" \n\t      maxIdle=\"10\"\n\t      maxWait=\"5000\"\n\t      connectionInitSql=\"ALTER SESSION SET NLS_SORT=XCZECH\"/>"}, {"count": 2, "tags": [], "creator": "jmelichna@gitus.cz", "attachment_id": null, "text": "Tell me please, where to find sources of naming-factory-dbcp.jar for Tomcat \n5.5.12. It will be safer solution to change this package. ", "id": 82516, "time": "2005-11-15T17:26:10Z", "bug_id": 37485, "creation_time": "2005-11-15T17:26:10Z", "is_private": false}, {"count": 3, "tags": [], "text": "DBCP is a Jakarta Commons package.  You can find its source code in the\njakarta-commons/dbcp module in SVN, and its documentation at\nhttp://jakarta.apache.org/commons/dbcp.  Enhancements to it should be filed as\ncommons/DBCP issues in Bugzilla, not as Tomcat issues.\n\nThe naming factory files are in the tomcat/container SVN module, under\ncatalina/src/share/org/apache/naming.\n\nI will mark this issue as NEEDINFO for now, as we wait for your new patch.  If\nyou decide to do it in the DBCP classes, please change the Bugzilla Component\nfor this issue when you reopen it.", "attachment_id": null, "id": 82734, "creator": "yoavs@computer.org", "time": "2005-11-22T16:41:25Z", "bug_id": 37485, "creation_time": "2005-11-22T16:41:25Z", "is_private": false}, {"count": 4, "tags": [], "text": "This belongs in DBCP.", "attachment_id": null, "id": 139463, "creator": "markt@apache.org", "time": "2010-08-25T14:55:13Z", "bug_id": 37485, "creation_time": "2010-08-25T14:55:13Z", "is_private": false}]