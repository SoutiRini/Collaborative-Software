[{"count": 0, "tags": [], "bug_id": 54469, "is_private": false, "text": "I have extended POI to contain the EXCEL fincancial functions\nIPMT, PPMT. Just diff and integrate the differences... is this the right place for posting the patched POI?", "id": 164798, "time": "2013-01-22T18:50:02Z", "creator": "micharg@gmail.com", "creation_time": "2013-01-22T18:50:02Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "micharg@gmail.com", "attachment_id": null, "is_private": false, "id": 164801, "time": "2013-01-22T19:51:09Z", "bug_id": 54469, "creation_time": "2013-01-22T19:51:09Z", "text": "Because the patched POI is too large to attach it here (about 100MB) you can download it from http://uploaded.net/file/ulq8cj21"}, {"count": 2, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "is_private": false, "id": 164804, "time": "2013-01-22T20:50:49Z", "bug_id": 54469, "creation_time": "2013-01-22T20:50:49Z", "text": "The patch should normally be just a few kb in size, maybe a few hundred kb with test files. Are you able to check that your patch only has these, and not something else by mistake? (100mb is a pretty huge patch!)"}, {"text": "Actually I have uploaded all the POI project patched with the new code. Should I upload only the diffs?", "tags": [], "bug_id": 54469, "is_private": false, "count": 3, "id": 164805, "time": "2013-01-22T20:55:11Z", "creator": "micharg@gmail.com", "creation_time": "2013-01-22T20:55:11Z", "attachment_id": null}, {"text": "yes, you should upload only the diffs. See http://poi.apache.org/guidelines.html#SubmittingPatches\n\n(In reply to comment #3)\n> Actually I have uploaded all the POI project patched with the new code.\n> Should I upload only the diffs?", "tags": [], "bug_id": 54469, "is_private": false, "count": 4, "id": 164834, "time": "2013-01-23T17:50:53Z", "creator": "yegor@dinom.ru", "creation_time": "2013-01-23T17:50:53Z", "attachment_id": null}, {"text": "I have downloaded the latest POI from git, integrated/created the IPMT,PPMT functions and created the patched using \"ant -f patch.xml\". I have attached the path created by Ant.", "tags": [], "bug_id": 54469, "is_private": false, "count": 5, "id": 164849, "time": "2013-01-23T20:01:49Z", "creator": "micharg@gmail.com", "creation_time": "2013-01-23T20:01:49Z", "attachment_id": null}, {"count": 6, "tags": [], "creator": "micharg@gmail.com", "attachment_id": 29887, "text": "Created attachment 29887\ndiff patch file created from \"ant -f patch.xml\" on the latest svn POI repository", "id": 164855, "time": "2013-01-23T20:35:58Z", "bug_id": 54469, "creation_time": "2013-01-23T20:35:58Z", "is_private": false}, {"count": 7, "tags": [], "creator": "micharg@gmail.com", "attachment_id": null, "is_private": false, "id": 165211, "time": "2013-02-12T18:09:24Z", "bug_id": 54469, "creation_time": "2013-02-12T18:09:24Z", "text": "Is there any feedback for this patch?"}, {"count": 8, "tags": [], "bug_id": 54469, "is_private": false, "text": "Created attachment 29949\nUpdated FormulaEvalTestData", "id": 165232, "time": "2013-02-13T16:30:00Z", "creator": "apache@gagravarr.org", "creation_time": "2013-02-13T16:30:00Z", "attachment_id": 29949}, {"count": 9, "attachment_id": null, "bug_id": 54469, "is_private": false, "id": 165233, "time": "2013-02-13T16:31:33Z", "creator": "apache@gagravarr.org", "creation_time": "2013-02-13T16:31:33Z", "tags": [], "text": "The patch doesn't include any unit tests, so I tried adding one myself by putting in a few sample formulas using the functions in FormulaEvalTestData.xls\n\nHowever, when I do that, the unit test fails as POI is unable to correctly evaluate the PPMT function to give the same result as Excel\n\nCould you please look into this, and produce either an updated patch that fixes it, or suggest an alternate test for it?"}, {"count": 10, "attachment_id": null, "creator": "micharg@gmail.com", "text": "Can you attach the unit test?", "id": 165236, "time": "2013-02-13T16:35:49Z", "bug_id": 54469, "creation_time": "2013-02-13T16:35:49Z", "tags": [], "is_private": false}, {"count": 11, "attachment_id": null, "bug_id": 54469, "is_private": false, "id": 165444, "time": "2013-02-22T17:30:16Z", "creator": "micharg@gmail.com", "creation_time": "2013-02-22T17:30:16Z", "tags": [], "text": "Nick can you attach the unit tests please so I can check why they fail in order the patch to be integrated to POI? Thank u!"}, {"count": 12, "tags": [], "bug_id": 54469, "is_private": false, "text": "If you grab the POI sourcecode, you'll find the unit test in there already. If you replace FormulaEvalTestData in test-documents with the one attached, and re-run the test with your patch applied you'll see the failure", "id": 165445, "time": "2013-02-22T17:32:18Z", "creator": "apache@gagravarr.org", "creation_time": "2013-02-22T17:32:18Z", "attachment_id": null}, {"text": "Thank you for your immediate answer! I will take care of it asap...", "tags": [], "bug_id": 54469, "is_private": false, "count": 13, "id": 165446, "time": "2013-02-22T17:33:47Z", "creator": "micharg@gmail.com", "creation_time": "2013-02-22T17:33:47Z", "attachment_id": null}, {"count": 14, "tags": [], "creator": "micharg@gmail.com", "attachment_id": 29986, "is_private": false, "id": 165457, "time": "2013-02-23T23:16:44Z", "bug_id": 54469, "creation_time": "2013-02-23T23:16:44Z", "text": "Created attachment 29986\nupdated patch\n\nUpdated patch....some minor fixes and some typos...\n\nThe tests should pass if you set the formatting of the cells in FormulaEvalTestData.xls to more decimal digits... the IPMT test fails because the cell D764 with value 0.01 has two decimals digits...the test returns the value ~0.005 and it fails..increase the cell's number of decimal digits to (e.g.) 4..."}, {"count": 15, "tags": [], "bug_id": 54469, "text": "Created attachment 29987\nMain classes for testing ipmt, pmt, etc\n\nThe attachnent contains Main-classes which test the financial functions...check the code please...\n\nplace all the *.java in trunk/src/java", "id": 165458, "time": "2013-02-23T23:18:19Z", "creator": "micharg@gmail.com", "creation_time": "2013-02-23T23:18:19Z", "is_private": false, "attachment_id": 29987}, {"text": "I have uploaded an updated patch and new convinient manual tests (should not be included in the POI trunk repository)..\n\nJust read the attachments comments..in the nutshell please increase the decimal digitis on the test-xls.\n\nThanks you\nMike", "tags": [], "bug_id": 54469, "is_private": false, "count": 16, "id": 165459, "time": "2013-02-23T23:19:33Z", "creator": "micharg@gmail.com", "creation_time": "2013-02-23T23:19:33Z", "attachment_id": null}, {"count": 17, "attachment_id": null, "bug_id": 54469, "is_private": false, "id": 165584, "time": "2013-03-02T13:22:59Z", "creator": "yegor@dinom.ru", "creation_time": "2013-03-02T13:22:59Z", "tags": [], "text": "Partially applied in r1451886 with some tweaks.\n\nYour implementation of PPMT is buggy. If I run PPMT_test I'm getting this:\n\nppmt=-121.95920277082378 [should be equal to -350.99]\n\nThe value -350.99 is correct, I confirmed it in Excel. \n\nInterestingly that two test cases from http://office.microsoft.com/en-001/excel-help/ppmt-function-HP010342774.aspx pass. \n\nPlease fix PPMT , I guess it a math error and should be easy to detect and fix.\n\nRegards,\nYegor"}, {"count": 18, "tags": [], "bug_id": 54469, "is_private": false, "text": "needs info based on previous comment", "id": 169165, "time": "2013-08-06T05:59:34Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2013-08-06T05:59:34Z", "attachment_id": null}]