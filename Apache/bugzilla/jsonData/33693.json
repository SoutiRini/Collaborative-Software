[{"count": 0, "tags": [], "text": "Using the <input:form> tag in a WSRP portlet interferes with URL rewriting and\nrenders the rewrite formatting invalid on the WSRP consumer.\n\nThe rewrite-encoded URL is passed to the HttpServletResponse.encodeURL() method\nwhich interferes with the specially formatted URL.", "is_private": false, "id": 71357, "creator": "valeri_david@bah.com", "time": "2005-02-22T17:08:06Z", "bug_id": 33693, "creation_time": "2005-02-22T17:08:06Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 33693, "attachment_id": null, "id": 71358, "time": "2005-02-22T17:13:59Z", "creator": "valeri_david@bah.com", "creation_time": "2005-02-22T17:13:59Z", "is_private": false, "text": "(In reply to comment #0)\n> Using the <input:form> tag in a WSRP portlet interferes with URL rewriting and\n> renders the rewrite formatting invalid on the WSRP consumer.\n\nTo clarify: renders the rewrite formatting on the action parameter invalid.\n\nApologies for the ambiguity.\n\n"}, {"count": 2, "tags": [], "bug_id": 33693, "attachment_id": null, "id": 71364, "time": "2005-02-22T20:08:16Z", "creator": "karl@xk72.com", "creation_time": "2005-02-22T20:08:16Z", "is_private": false, "text": "The action attribute on the form tag is passed through encodeURL() before \nbeing output on the page. Do you mean that you're already putting an \nencodedURL into the action attribute on the page, and that the double encoding \nis the problem?"}, {"count": 3, "tags": [], "text": "Here is the scenario under which the issue occurs.\n\nA JSR-168 Portlet uses a JSP to render its output. The JSP employs the\n<input:form> tag to assist in the generation of a prepopulated form. The form is\nto submit back to the portlet that is displaying the form. In order to do so,\nthe form's action URL must be generated using the portlet taglib or from a\nRenderResponse. In the event that the portlet is exposed through WSRP, the URL\nis specially encoded to enable client side URL rewriting (See the OASIS WSRP 1.0\nSpecification for more details on URL rewriting). The special encoding is\nprovided by the portlet container and is provided in the output of the portlet\ntaglib or the RenderResponse.createActionURL() method. When this specially\nencoded URL is sent through the HttpServletResponse.encodeURL() method, the\nrewrite encoding is destroyed and the URL becomes invalid to the WSRP consumer\nwhen it is invoked.\n\nSince the portlet container is responsible for properly encoding the URL\n(regardless of the use of WSRP), the HTTPServletResponse.endodeURL() has the\npotential to interfere with an already valid URL. To avoid this issue the taglib\nwould need to check if the current request is indeed a render request for a\nportlet. In short, it is indeed the double encoding that is causing the problem,\nbut the situation is unavoidable when creating URLs for a JSR-168 portlet.\n", "is_private": false, "id": 71369, "creator": "valeri_david@bah.com", "time": "2005-02-22T21:08:43Z", "bug_id": 33693, "creation_time": "2005-02-22T21:08:43Z", "attachment_id": null}, {"text": "Maybe I'm missing something, but using <input:form> just doesn't make sense in\nthis instance. Portlet 1.0 implies Servlet 2.3 which supports JSP 1.2 which\nsupports JSTL 1.0. So, I assume you can do something like:\n\n<%@ taglib prefix=\"c\"       uri=\"http://java.sun.com/jstl/core\" %>\n<%@ taglib prefix=\"portlet\" uri=\"http://java.sun.com/portlet\"   %>\n\n<portlet:actionURL var=\"formAction\" portletMode=\"edit\"/>\n\n<form action=\"<c:out value=\"${formAction}\" escapeXml=\"false\"/>\" ...>\n  ...\n</form>\n\nAs well as using JSTL to dynamically add other attributes to the <form> element\nas needed...", "tags": [], "bug_id": 33693, "is_private": false, "count": 4, "id": 71372, "time": "2005-02-22T21:54:30Z", "creator": "kschneider@gmail.com", "creation_time": "2005-02-22T21:54:30Z", "attachment_id": null}, {"count": 5, "tags": [], "text": "Ahem, it looks like the simple case (no params for <portlet:actionURL>) could\njust be:\n\n<%@ taglib prefix=\"portlet\" uri=\"http://java.sun.com/portlet\" %>\n\n<form action=\"<portlet:actionURL portletMode=\"edit\"/>\" ...>\n  ...\n</form>\n\nAnyway, you get the idea...", "is_private": false, "bug_id": 33693, "id": 71374, "time": "2005-02-22T22:02:57Z", "creator": "kschneider@gmail.com", "creation_time": "2005-02-22T22:02:57Z", "attachment_id": null}, {"count": 6, "tags": [], "creator": "karl@xk72.com", "attachment_id": null, "text": "I imagine that there are still benefits to using the input taglib. In terms of \na possible solution:\n\nI'm not sure if it's possible or wise to detect automatically whether the URL \nhas been through the encoding process already. Perhaps the best alternative is \nto provide another attribute to the form tag to turn off encoding?", "id": 71380, "time": "2005-02-23T01:55:32Z", "bug_id": 33693, "creation_time": "2005-02-23T01:55:32Z", "is_private": false}, {"count": 7, "attachment_id": null, "bug_id": 33693, "text": "I have added an encodeActionURL attribute to the form tag. This defaults to true but can be set to false to \nturn off the response.encodeURL(). Note that the action parameter now has HTML entities encoded inline \nwith the rest of the taglib.", "id": 102007, "time": "2007-04-22T01:12:18Z", "creator": "karl@xk72.com", "creation_time": "2007-04-22T01:12:18Z", "tags": [], "is_private": false}]