[{"attachment_id": 29120, "tags": [], "bug_id": 53611, "is_private": false, "count": 0, "id": 160939, "time": "2012-07-27T12:45:17Z", "creator": "math2306@hotmail.com", "creation_time": "2012-07-27T12:45:17Z", "text": "Created attachment 29120\nSmall java project build with maven to create example .xlsx file having incorrect dimension ref value set in workbook sheet xml file\n\nAfter creating and writing an XSSFWorkbook with some rows and cells to a file the sheet XML file included in .xlsx archive has an incorrect value for attribute 'ref' of tag 'dimension':\n\n<worksheet>\n <dimension ref=\"A1\"/>\n <sheetViews>\n  <sheetView ...\n\n\nIt's always set to 'A1' no matter how many rows and cells are actually in the sheet. The dimension is only initialized on creation of worksheet in class XSSFSheet:\n\nXSSFSheetworksheet.newSheet(){\n ...\n worksheet.addNewDimension().setRef(\"A1\");\n ...\n}\n\nI included a example java app showing the. Build it with maven:\n\ncd poi-bug\nmvn package\njava -jar target/poi-bug-0.1-SNAPSHOT-jar-with-dependencies.jar\n\nAfter successful execution the project folder contains the file 'poi-bug.xlsx'. Unzip file and open 'xl/worksheets/sheet1.xml' containing the dimension tag."}, {"count": 1, "tags": [], "creator": "math2306@hotmail.com", "attachment_id": null, "id": 160941, "time": "2012-07-27T12:52:19Z", "bug_id": 53611, "creation_time": "2012-07-27T12:52:19Z", "is_private": false, "text": "copy and paste error in source code:\n\nit's \n\nXSSFSheet.newSheet(){\n\nnot:\nXSSFSheetworksheet.newSheet(){"}, {"count": 2, "tags": [], "creator": "math2306@hotmail.com", "attachment_id": null, "id": 160942, "time": "2012-07-27T13:06:37Z", "bug_id": 53611, "creation_time": "2012-07-27T13:06:37Z", "is_private": false, "text": "Same bug described here:\n\nhttp://stackoverflow.com/questions/7204217/poi-creates-xlsx-files-incompletely-or-wronglythe-dimension-tag-in-the-xlsx-xml"}, {"attachment_id": null, "tags": [], "bug_id": 53611, "text": "I have found a workaround to this bug.  You can set the dimension reference yourself.  I am using SXSSF in my application, but the workaround is possible for either SXSSF or XSSF.\n\nIt should also be an easy bug to fix for POI.\n\nHere is the code snippet: (wb is a SXSSFWorkbook)\n\nCTWorksheet ctSheet = wb.getXSSFWorkbook().getSheetAt(0).getCTWorksheet();\nctSheet.getDimension().setRef(\"A1:D47\");", "count": 3, "id": 162251, "time": "2012-09-18T16:46:42Z", "creator": "Ryan.Harris@Teradata.com", "creation_time": "2012-09-18T16:46:42Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 53611, "attachment_id": null, "is_private": false, "id": 162412, "time": "2012-09-26T13:02:46Z", "creator": "mpatil007@gmail.com", "creation_time": "2012-09-26T13:02:46Z", "text": "Getting following error for POI 3.7-\n\"Excel found unreadable content in 'out.xlsx'. Do you want to recover the contents of this workbook ? If you trust the source of this workbook, click Yes.\"\n\nI have tried searching the fix for it, please paste the fix if anyone knows.\n\nI have tried following remedy, but in vain-\nXSSFWorkbook wb = new XSSFWorkbook();\nXSSFSheet sheet = wb.createSheet(\"Q\");\t\t\t\nsheet.getCTWorksheet().getDimension().setRef(\"A1:K47\");"}, {"attachment_id": null, "tags": [], "bug_id": 53611, "text": "(In reply to comment #4)\n> Getting following error for POI 3.7-\n> \"Excel found unreadable content in 'out.xlsx'. Do you want to recover the\n> contents of this workbook ? If you trust the source of this workbook, click\n> Yes.\"\n> \n> I have tried searching the fix for it, please paste the fix if anyone knows.\n> \n> I have tried following remedy, but in vain-\n> XSSFWorkbook wb = new XSSFWorkbook();\n> XSSFSheet sheet = wb.createSheet(\"Q\");\t\t\t\n> sheet.getCTWorksheet().getDimension().setRef(\"A1:K47\");\n\nMahesh - remove setting the reference from your code, generate an .xlsx file, and make sure that the file is readable by Excel.  In other words, did your file generation work until you added the reference change?  Incorrect references will not cause the file to be unreadable.", "count": 5, "id": 162424, "time": "2012-09-26T16:48:49Z", "creator": "Ryan.Harris@Teradata.com", "creation_time": "2012-09-26T16:48:49Z", "is_private": false}, {"count": 6, "tags": [], "creator": "mpatil007@gmail.com", "attachment_id": null, "text": "Thanks! Ryan for your reply,\n\nI am getting this error even I remove this reference code. I have added it to see if its work for this issue.\n\nI am generating report and have kept all the columns names less than 31 character including sheet name.\n\nYour help will be much appreciated!", "id": 162430, "time": "2012-09-27T06:08:07Z", "bug_id": 53611, "creation_time": "2012-09-27T06:08:07Z", "is_private": false}, {"count": 7, "tags": [], "creator": "Ryan.Harris@Teradata.com", "attachment_id": null, "text": "Then your problem has nothing to do with this bug, and you just have bad Excel generation code.  This bug has nothing to do with unreadable content.", "id": 162436, "time": "2012-09-27T15:49:51Z", "bug_id": 53611, "creation_time": "2012-09-27T15:49:51Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 53611, "is_private": false, "count": 8, "id": 162437, "time": "2012-09-27T15:53:07Z", "creator": "Ryan.Harris@Teradata.com", "creation_time": "2012-09-27T15:53:07Z", "text": "(In reply to comment #6)\n> Thanks! Ryan for your reply,\n> \n> I am getting this error even I remove this reference code. I have added it\n> to see if its work for this issue.\n> \n> I am generating report and have kept all the columns names less than 31\n> character including sheet name.\n> \n> Your help will be much appreciated!\n\nAlso, make sure you let your program finish writing.  If you don't check the progress or notify the user when it is done, then the excel generation could still be occurring.  I made this mistake by trying to open it too fast before the program was finished.  You can use task manager to see when it stops using CPU and then its done.  My program takes around 1 min 15 sec to write a .xlsx file that is 200,000 rows by 41 columns"}, {"count": 9, "tags": [], "text": "Problem still exists for XSSFWorkbook in POI version 3.9 .", "is_private": false, "id": 166469, "creator": "math2306@hotmail.com", "time": "2013-04-08T12:34:11Z", "bug_id": 53611, "creation_time": "2013-04-08T12:34:11Z", "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 53611, "attachment_id": null, "is_private": false, "id": 166471, "time": "2013-04-08T12:41:49Z", "creator": "math2306@hotmail.com", "creation_time": "2013-04-08T12:41:49Z", "text": "Thanks, Ryan for the workaround. Works. Now IBM SPSS Statistics imports all columns and rows without manual help. Hope they will fix it soon in POI. XSSFSheet.getCTWorksheet is annotated with @Internal marking this as possibly being removed in future releases :(."}, {"count": 11, "tags": [], "text": "In r1767096 we populate the dimension when writing out the XSSFSheet. Doing it for every change to rows/cells would likely be a performance problem so we only update this before writing out the file.", "attachment_id": null, "bug_id": 53611, "id": 194720, "time": "2016-10-29T07:39:54Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-10-29T07:39:54Z", "is_private": false}, {"count": 12, "tags": [], "creator": "math2306@hotmail.com", "attachment_id": null, "text": "(In reply to Dominik Stadler from comment #11)\n> In r1767096 we populate the dimension when writing out the XSSFSheet. Doing\n> it for every change to rows/cells would likely be a performance problem so\n> we only update this before writing out the file.\n\nThanks, looking forward to the release containing this fix.", "id": 194837, "time": "2016-11-05T20:50:11Z", "bug_id": 53611, "creation_time": "2016-11-05T20:50:11Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 53611, "text": "(In reply to Mathias R\u00fchle from comment #12)\n> (In reply to Dominik Stadler from comment #11)\n> > In r1767096 we populate the dimension when writing out the XSSFSheet. Doing\n> > it for every change to rows/cells would likely be a performance problem so\n> > we only update this before writing out the file.\n> \n> Thanks, looking forward to the release containing this fix.\n\nThis code has a bug reported here: Bug 61798", "count": 13, "id": 202339, "time": "2017-11-22T13:38:35Z", "creator": "marek.zaplata@gmail.com", "creation_time": "2017-11-22T13:38:35Z", "is_private": false}]