[{"count": 0, "tags": [], "bug_id": 47509, "attachment_id": null, "id": 128743, "time": "2009-07-10T16:44:47Z", "creator": "slugfiller@ifireball.dyndns.org", "creation_time": "2009-07-10T16:44:47Z", "is_private": false, "text": "When I run a scriptdef like:\n\t<scriptdef name=\"quickfail\" language=\"beanshell\">\n\t\t<![CDATA[\n\t\t\tself.fail(\"I failed!\");\n\t\t]]>\n\t</scriptdef>\n\nI expect to get an output like:\n\nBUILD FAILED\nC:\\myproject\\build.xml:10: [quickfail] I failed!\n\nOr something of the sort... Instead I get:\n\nBUILD FAILED\njavax.script.ScriptException: Sourced file: inline evaluation of: ``self.fail(\"I failed!\");                         ;'' : Method Invocation self.fail : at Line: 3 : in file: inline evaluation of: ``\nself.fail(\"I failed!\");\n'' : self .fail ( \"I failed!\" );\n\nTarget exception: I failed!\nin inline evaluation of: ``                                        self.fail(\"I failed!\");\n\tat line number 3 '';\n\tat bsh.engine.BshScriptEngine.evalSource(BshScriptEngine.java:86)\n\tat bsh.engine.BshScriptEngine.eval(BshScriptEngine.java:46)\n\tat javax.script.AbstractScriptEngine.eval(Unknown Source)\n.BshScriptEngine.evalSource(BshScriptEngine.java:86)\n        at bsh.engine.BshScriptEngine.eval(BshScriptEngine.java:46)\n        at javax.script.AbstractScriptEngine.eval(Unknown Source)\n[...it keeps going for 3 more pages, making the original error very hard to read...]\n\nI'm willing to grudgingly accept such an output for an IOException, or even a syntax error, but for a user-generated fail? What's the point of providing a custom fail command if it looks like a full system crash?\n\nI haven't checked if this is beanshell specific, or if it applies to javascript and other languages as well, since I only have beanshell installed."}, {"count": 1, "tags": [], "bug_id": 47509, "attachment_id": null, "id": 128782, "time": "2009-07-13T04:00:49Z", "creator": "bodewig@apache.org", "creation_time": "2009-07-13T04:00:49Z", "is_private": false, "text": "I haven't tried beanshell but JavaScript in svn revision 793540\n\nWhen using Apache BSF things are just like one would want them to be - a one line \"I failed!\" message.\n\nBut using javax.script things look ugly.  Unfortunately the scripting engine throws a ScriptException without any nested cause in this case, completely hiding the original BuildException.\n\nThe beanshell implementation may be doing better, in which case the changes committed in above revision may help.\n\nIf it doesn't, then I'm afraid there isn't anything we can do from Ant's side.\n\nUsing WONTFIX as a placeholder for CANTFIX."}]