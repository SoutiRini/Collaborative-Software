[{"count": 0, "tags": [], "creator": "stefan.lloyd@essentia.ltd.uk", "attachment_id": null, "text": "Messages such as the following are logged:\n\n[Mon Sep 05 11:36:35 2011]  [jk_isapi_plugin.c (843)]: HttpFilterProc [/integrator/download/d2b3b4c1-5eb2-4c45-9ca6-2af7bdc286e3/teamtrainer/50/meta-inf.xml;jsessionid=4adfb2366e39fef63fda294d375f0273] points to the web-inf or meta-inf directory.\nSomebody try to hack into the site!!!\n\nand HTTP status 403 is returned on the request. This is a false positive. The file name is meta-inf.xml but it is not in the meta-inf directory.\n\nA number of forum references can be found e.g. http://mail-archives.apache.org/mod_mbox/tomcat-dev/200505.mbox/%3C1115929838.4283bcee5ca60@aragorntools.webappcabaret.net%3E but it does appear to have been previously raised as a bug.\n\nUnfortunately this renders the ispai connector unusable with this Tomcat application. \n\nReproduced on isapi at 1.2.32 (not available in pulldown list!). Cannot be reproduced in mod_jk connector.", "id": 149039, "time": "2011-09-06T08:33:56Z", "bug_id": 51769, "creation_time": "2011-09-06T08:33:56Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 51769, "text": "Looks like jk_isapi_plugin.c::uri_is_web_inf is a little too liberal with it's check:\n\nstatic int uri_is_web_inf(const char *uri)\n{\n    if (stristr(uri, \"/web-inf\")) {\n        return JK_TRUE;\n    }\n    if (stristr(uri, \"/meta-inf\")) {\n        return JK_TRUE;\n    }\n\n    return JK_FALSE;\n}\n\nMight make sense to check to see if the uri either ends with either of those two strings or explicitly has a \"/\" after either of them.\n\nObviously, requesting \"/anything/meta-info-for-my-application\" would cause a failure, here.\n\nI can confirm that mod_jk does not enforce such checks, because without <Location>Allow/Deny</Location>, httpd will serve content out of WEB-INF and META-INF directories if an Alias is set up to point to the deployment directory.", "id": 149048, "time": "2011-09-06T20:17:01Z", "creator": "chris@christopherschultz.net", "creation_time": "2011-09-06T20:17:01Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "chris@christopherschultz.net", "attachment_id": 27466, "is_private": false, "id": 149078, "time": "2011-09-07T16:38:50Z", "bug_id": 51769, "creation_time": "2011-09-07T16:38:50Z", "text": "Created attachment 27466\nProposed fix to uri_is_web_inf function.\n\nI have neither a win32 compiler nor an IIS environment handy to compile and test this, so I'm attaching this as a patch in BZ instead of committing to trunk.\n\nIf someone could test, that would be great."}, {"count": 3, "tags": [], "text": "Fixed in r1187916, will be part of version 1.2.33.\n\nI used a slightly different solution as Chris choosing to add another function as a replacement for stristr. Should be functionally equivalent.\n\nRegards,\n\nRainer", "attachment_id": null, "bug_id": 51769, "id": 150844, "time": "2011-10-23T16:19:47Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2011-10-23T16:19:47Z", "is_private": false}]