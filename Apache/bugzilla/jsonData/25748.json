[{"attachment_id": null, "tags": [], "bug_id": 25748, "is_private": false, "count": 0, "id": 49676, "time": "2003-12-24T20:19:56Z", "creator": "dice@east.sun.com", "creation_time": "2003-12-24T20:19:56Z", "text": " "}, {"attachment_id": null, "tags": [], "bug_id": 25748, "text": "Briefly, worker threads in the ControlRunnable class execute a loop of the form:\n    for \n       // toRun, shouldRun, shouldTerminate are non-volatile instance variables\n       synchronized(this) { if (!shouldRun && !shouldTerminate) wait(); }\n       ...\n       re-read shouldRun, shouldTerminate\n       fetch job description from toRun\n       perform work describec by toRun\n       clear shouldRun, shouldTerminate, etc. \n\nInstead, I think it'd be safer to use code of the form\n    for \n       synchronized (this) { \n          while (!shouldRun && !shouldTerminate) wait(); \n          copy shouldRun, shouldTerminate, toRun etc into temporary auto\n          auto variables _shouldRun, _shouldTerminate, _toRun, etc.\n          clear shouldRun, shouldTerminate, etc.\n       }\n       check _shouldRun, _shouldTerminate\n       perform work described by _toRun\n   \n\nSee Josh Bloch's \"Effective Java\" book, chapter 50, for details.\nIn addition, running Bill Pugh's \"BugFinder\" on the class files might turn up\nother issues.\n\nWe've encountered this bug during large application stability testing at Sun. \nFixing the code (as described above) seemed to remedy the problem. \n\n\n\n      \n", "count": 1, "id": 49679, "time": "2003-12-24T20:32:50Z", "creator": "dice@east.sun.com", "creation_time": "2003-12-24T20:32:50Z", "is_private": false}, {"count": 2, "tags": [], "text": "I'm not convinced that the pseudo code above addresses any real problem (and I \nstrongly disagree with parts of it).  You will have to show that this is still \nan issue with a higher version than 4.1.24 before I'll consider the bug valid.\n\n*** This bug has been marked as a duplicate of 21763 ***", "is_private": false, "id": 49682, "creator": "william.barker@wilshire.com", "time": "2003-12-25T03:04:40Z", "bug_id": 25748, "creation_time": "2003-12-25T03:04:40Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 25748, "text": "The bug has been closed as dup, but the problematic code appears in 4.1.24-.28\nand very recent 5.x betas (as of 3 weeks ago).  Perhaps the problematic code has\nbeen fixed in the interim? ", "count": 3, "id": 49700, "time": "2003-12-25T18:57:36Z", "creator": "dice@east.sun.com", "creation_time": "2003-12-25T18:57:36Z", "is_private": false}, {"count": 4, "attachment_id": null, "creator": "dice@east.sun.com", "is_private": false, "id": 49701, "time": "2003-12-25T18:58:33Z", "bug_id": 25748, "creation_time": "2003-12-25T18:58:33Z", "tags": [], "text": "The bug has been closed as dup, but the problematic code appears in 4.1.24-.28\nand very recent 5.x betas (as of 3 weeks ago).  Perhaps the problematic code has\nbeen fixed in the interim? \n\nWe can mention the issue in the 1.5.0 release notes to warn users that 4.1.2X\nand some 5.x versions are unstable.  "}, {"count": 5, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "text": "Quite frankly you need to improve how you interact with this community. I think\nthe \"problems\" you attempted to point out are hypothetical at best, and the\nchanges you did suggest would not fix anything.\nIf you want to make yourself understood, you need to post detailed, argumented\ninformation.", "id": 49702, "time": "2003-12-25T19:42:24Z", "bug_id": 25748, "creation_time": "2003-12-25T19:42:24Z", "is_private": false}]