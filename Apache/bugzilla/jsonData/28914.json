[{"count": 0, "tags": [], "text": "it is not possible to tune quality of http services (responsiveness)\nthrough thread priority.\nother threads in the web app are of various priority than the http connector and\nwe want the connector to be of a higher/lower priority.\n\n1-\nadd connector thread pool property to server.xml to set initial thread priority.\n\n2-\nadditionnally, we would like a tomcat public API (perfectly knowing that it is\nnot jsdk2.x), maybe jmx but that overkill, to vary connector's thread pool\nthreads priorities according to application specific knowledge.", "attachment_id": null, "id": 57230, "creator": "quartz12h@yahoo.com", "time": "2004-05-11T21:10:15Z", "bug_id": 28914, "creation_time": "2004-05-11T21:10:15Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 28914, "is_private": false, "text": "Quite frankly, thread priority is a big lie (at least from Java). Look at the\njavadocs.", "id": 57231, "time": "2004-05-11T21:26:29Z", "creator": "remm@apache.org", "creation_time": "2004-05-11T21:26:29Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 28914, "attachment_id": null, "id": 57261, "time": "2004-05-12T02:20:58Z", "creator": "quartz12h@yahoo.com", "creation_time": "2004-05-12T02:20:58Z", "is_private": false, "text": "Euh.. No. Sorry.\n(suns statements in javadoc about thread are known to be very forgiving for JVM\nimplementors. Most if not all serious jvm have correct priorities.)\n\nThere are plenty of JVMs out there that do correctly implements priority.\nAnd thrust me, it works. Here are some examples.\nPlease verify by yourself.\n\n-screen updater toggles back and forth between prio 4 and 6. It help propmptness\nof drawing.\n\n-finalizer has low prio, for obvious reason. It does run seldomly, as expected\nin idle times.\n\n-SEDA architecture like sandstorm works great!\nI myself created a seda thread manager based on priority and load detection. It\nruns very nicely on sun, ibm, jrockit JVM, on both win32 and linux platform.\n\nBesides, I raise the tomcat connector threads in a dirty way: enumerate thread,\nmatch name with regex, and raise prio to 7 (because I use prio 1 to 6 for\nsandstorm).\n\nTrust me, it really balances stage & queue load and work well. And with that\ntomcat prio raised, my web UI is responsive and I keep the control.\n\nIn other systems, with jmx timer and with container sheduling\nJSR 236 titled \"Timer for Application Servers\"\nhttp://jcp.org/en/jsr/detail?id=236\nthread priority will become a serious concern.\n\nPlease consider this RFE with \"normal priority\" (hehehe!)"}, {"count": 3, "tags": [], "creator": "yoavs@computer.org", "is_private": false, "text": "Done.  Need minor help from Amy Roh or another admin webapp expert on the \nwriting of modified configuration, will post on tomcat-dev, but the code is \nthere and seems to be working.", "id": 58220, "time": "2004-05-27T16:15:55Z", "bug_id": 28914, "creation_time": "2004-05-27T16:15:55Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "quartz12h@yahoo.com", "is_private": false, "text": "for cross-ref purpose: see bug #27616\n", "id": 59601, "time": "2004-06-19T16:58:55Z", "bug_id": 28914, "creation_time": "2004-06-19T16:58:55Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "quartz12h@yahoo.com", "is_private": false, "text": "Priority not applied.\n\nRun tomcat in a debugger, like eclipse, pause processors/monitors threads,\nlook at first stackframe (thread run()), the variable 'this' (the thread).\nlook at the priority field: still = 5 (normal prio) instead of prescribed value.\n\nExpected to see the monitor thread and the processors threads at priority 8 in\nthe case below.\n\n\t<Connector\n\t\tport=\"1026\"\n\t\tmaxThreads=\"15\"\n\t\tminSpareThreads=\"2\"\n\t\tmaxSpareThreads=\"5\"\n\t\tenableLookups=\"false\" \n\t\tacceptCount=\"100\"\n\t\tdebug=\"1\"\n\t\tconnectionTimeout=\"20000\"\n\t\tdisableUploadTimeout=\"true\"\n\t\tthreadPriority=\"8\"\n\t\tredirectPort=\"18443\"\n\t/>\n\n\nThr: d P=05 ALIVE  \"http-1026-Processor1\" \n(org.apache.tomcat.util.threads.ThreadWithAttributes)\n\nThr: d P=05 ALIVE  \"http-1026-Processor2\" \n(org.apache.tomcat.util.threads.ThreadWithAttributes)\n\nThr:   P=05 ALIVE  \"http-1026-Monitor\"", "id": 62085, "time": "2004-08-17T19:07:45Z", "bug_id": 28914, "creation_time": "2004-08-17T19:07:45Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 28914, "attachment_id": null, "id": 62086, "time": "2004-08-17T19:08:08Z", "creator": "quartz12h@yahoo.com", "creation_time": "2004-08-17T19:08:08Z", "is_private": false, "text": "against 5.0.27\n"}, {"count": 7, "tags": [], "bug_id": 28914, "attachment_id": null, "id": 62798, "time": "2004-08-30T19:26:14Z", "creator": "yoavs@computer.org", "creation_time": "2004-08-30T19:26:14Z", "is_private": false, "text": "Ooops, I forgot the actual Thread#setPriority call.  Sorry about that ;)  Fixed \nin both TOMCAT_5_0 and CVS HEAD branches."}]