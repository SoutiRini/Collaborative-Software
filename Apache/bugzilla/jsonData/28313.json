[{"count": 0, "tags": [], "creator": "viy75@ukr.net", "text": "Description:\n============\nwhen my login-page JSP uses other resources from protected area\ne.g. .CSS or .JS files then after successful authentication client always\nredirected to last requested protected resource used by login-page.\nThis behaviour violated Servlet 2.3 Spec\nsection SRV.12.5.3 Form Based Authentication.\nWith accordance to spec after successful authentication\nclient should be redirected to\n\"URL path triggering the authentication and stored by the container\"\n\nDetails:\n========\n1.Here are scraps of my web.xml:\n\n<login-config>\n  <auth-method>FORM</auth-method>\n  <form-login-config>\n    <form-login-page>/login.jsp</form-login-page>\n[..skipped..]\n\n<security-constraint>\n[..skipped..]\n  <url-pattern>/*</url-pattern>\n[..skipped..]\n\n2.Here are scraps of my localhost_access_log.txt\n127.0.0.1 - - [09/Apr/2004:17:18:13 +0200] \"GET /tceinq/index.jsp HTTP/1.1\" 302 -\n127.0.0.1 - - [09/Apr/2004:17:18:13 +0200] \"GET /tceinq/login.jsp HTTP/1.1\" 200 908\n127.0.0.1 - - [09/Apr/2004:17:18:13 +0200] \"GET /tceinq/_.js HTTP/1.1\" 302 -\n127.0.0.1 - - [09/Apr/2004:17:18:13 +0200] \"GET /tceinq/login.jsp HTTP/1.1\" 200 908\n127.0.0.1 - - [09/Apr/2004:17:18:20 +0200] \"POST /tceinq/j_security_check HTTP/1.1\" 302 -\n127.0.0.1 - tomcat [09/Apr/2004:17:18:20 +0200] \"GET /tceinq/_.js HTTP/1.1\" 200 197\n\nSo as you can see container done redundant redirect to\nlogin.jsp when _.js (JavaScript file) had been requested,\nand exactly this file had been stored as initiating URL,\nso after authentication I see content of my _.js file instead of\ncontent of my realy initialy requested index.jsp file.\n\nThanks in advance.\nDo not hesitate to ask me about additional info about the issue.", "id": 55561, "time": "2004-04-09T14:52:34Z", "bug_id": 28313, "creation_time": "2004-04-09T14:52:34Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "markt@apache.org", "is_private": false, "text": "I am afraid I disagree with your analysis.\n\nIf the login page includes protected resources then the requests for these \nresorces are also subject to the process described in SRV.12.5.3 (look at the \n302s in your access log) which is why the eventual redirect is to the last \nrequested resource.\n\nThe only way you will get this to work is if you move the included resources \noutside the protected area.\n\nLooking at this from another point of view. Lets assume you have the following \nresources (all protected):\nindex.jsp\nlogin.jsp\npicture.gif\nsensitivedata.jsp\n\nYou request index.jsp and get redirected to login.jsp. NB the login page is a \nspecial case and can be retrieved even though it is protected but it can not \nbe retrieved directly.\nlogin.jsp includes picture.gif so the browser requests it.\nA rouge browser requests sensitivedata.jsp rather than picture.gif\n\nTomcat has no way of detecting the difference between the valid request for \npicture.gif and the invalid request for sensitivedata.jsp therefore requests \nfor any protected resource will be redirected to the login page until the user \nis authenticated.\n\nTo reiterate my point above - if you want to use included resources with the \nlogin page they must be outside of the protected area.", "id": 60575, "time": "2004-07-13T22:33:25Z", "bug_id": 28313, "creation_time": "2004-07-13T22:33:25Z", "attachment_id": null}]