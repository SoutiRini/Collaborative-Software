[{"count": 0, "tags": [], "text": "When I try to read some Excel file with a cell that contains a formula with the\n#N/D word, HSSFWorkbook can't istanciates the workbook...Is there any\nwork-around solution for this kind of problem? I want to ignore this type of\nerror and continue to work with other cells... Tnx for support!\nThis is the stacktrace:\n\njava.lang.reflect.InvocationTargetException\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)\n\tat java.lang.reflect.Constructor.newInstance(Unknown Source)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:213)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:149)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:183)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:230)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:211)", "attachment_id": null, "bug_id": 40786, "id": 94927, "time": "2006-10-18T04:00:04Z", "creator": "ecdic@yahoo.it", "creation_time": "2006-10-18T04:00:04Z", "is_private": false}, {"count": 1, "tags": [], "text": "The problem is in createRecord(RecordInputStream in) function of RecordFactory\nClass (package org.apache.hssf.record)\nWhen the flow encounter the cell with formula that contains #N/D string,\nConstructor returns sid=0x06 that corresponds to FormulaRecord object.\nFormulaRecord fillFields(RecordInputStream in) method try to parse the formula with:\nfield_8_parsed_expr = Ptg.createParsedExpressionTokens(field_7_expression_len, in);\n\nPtg.createPtg was called and in some case of the switch was generated an\nexception, I haven't verified what id was detected...I'll try to work again in\nthis days..\n\n(In reply to comment #0)\n> When I try to read some Excel file with a cell that contains a formula with the\n> #N/D word, HSSFWorkbook can't istanciates the workbook...Is there any\n> work-around solution for this kind of problem? I want to ignore this type of\n> error and continue to work with other cells... Tnx for support!\n> This is the stacktrace:\n> \n> java.lang.reflect.InvocationTargetException\n> \tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n> \tat sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)\n> \tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)\n> \tat java.lang.reflect.Constructor.newInstance(Unknown Source)\n> \tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:213)\n> \tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:149)\n> \tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:183)\n> \tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:230)\n> \tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:211)\n\n", "attachment_id": null, "id": 94962, "creator": "ecdic@yahoo.it", "time": "2006-10-19T02:51:17Z", "bug_id": 40786, "creation_time": "2006-10-19T02:51:17Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 40786, "attachment_id": 19029, "id": 94963, "time": "2006-10-19T02:53:33Z", "creator": "ecdic@yahoo.it", "creation_time": "2006-10-19T02:53:33Z", "is_private": false, "text": "Created attachment 19029\nEXCEL FILE WITH BUG CELL\n\nlook at the red cell..."}, {"count": 3, "tags": [], "bug_id": 40786, "attachment_id": null, "id": 116450, "time": "2008-05-10T17:35:45Z", "creator": "josh@apache.org", "creation_time": "2008-05-10T17:35:45Z", "is_private": false, "text": "Retested OK in 3.1-beta1\n\nThis bug must have been fixed between version 3.0 and 3.0.2.\n\nUnfortunately the stack trace was truncated.  We actually needed to see the exception inside the ITE.  It also would have been nice to know the POI version which had this bug.  I couldn't get a similar error out of a few recent versions of POI.\nI also made sure that Excel can open the spreadsheet that POI re-writes.\n\nFor recent versions (svn trunk, 3.1-beta1, 3.0.2) POI reads and writes the example sheet silently.  Excel opens it OK.\n\nIn version 3.0, POI stderr: \"WARN. Unread 4 bytes of record 0x6\".  Excel does not open the output file properly.\n\nIn version 2.5.1, POI stderr \"POI:[WARNING] Unknown Ptg 1c (28) at cell (3,1)\", but Excel seems to open OK\n"}]