[{"count": 0, "tags": [], "creator": "sradicchio@hotmail.com", "attachment_id": null, "text": "PROBLEM\n\nConfiguring <auth-method>DIGEST</auth-method> for a web application using \nJDBCRealm doesn't work.\nIs not possible to authenticate users.\n\n\nANALYSIS\n\nDebugging source code of org.apache.catalina.realm.JDBCRealm class I noticed:\n\n1) the method\nauthenticate(String username, String clientDigest,\n             String nOnce, String nc, String cnonce,\n             String qop, String realm,\n             String md5a2)\nof the class org.apache.catalina.realm.RealmBase\ncalculates the md5a1 value calling the method\ngetDigest(String username, String realmName)\nof the same class\n\n2) the method\ngetDigest(String username, String realmName)\ncalculates the md5a1 value getting the user password from the method\ngetPassword(String username)\nof the org.apache.catalina.realm.JDBCRealm class\n\nIn this algorithm there are two problems:\n- getPassword() must return the cleartext password, so you have to save it \nsomewhere in clear\n- at the moment getPassword() is not implemented and always returns null\n\n3) if you implement getPassword(), the method authenticate() still returns null \nbecause it tries to get the Principal calling the method\ngetPrincipal(String username)\nof the org.apache.catalina.realm.JDBCRealm class\nbut at the moment this method is not implemented and always returns null\n\n\nSOLUTION\n\nI think there are two main things to solve:\n- implement getPassword() and getPrincipal() in the JDBCRealm class\n- provide the possibility to save on the DB not the cleartext password but the \nmd5a1 value\n(the md5a1 value is the digest of the following string: username + realmname + \npassword)\n\n\nCOMMENTS\n\nAt the end you should decide to use 4 different configurations:\n1) <auth-method>BASIC and DB with cleartext pwd (working)\n2) <auth-method>BASIC and DB with digest of pwd (working)\nMain limits of this solution are:\n. password sent in clear on the network\n. on the DB : if pwdA = pwdB then digestA = digestB\n3) <auth-method>DIGEST and DB with cleartext pwd (not working)\n. you have only to implement getPassword() and getPrincipal in class \norg.apache.catalina.realm.JDBCRealm\n4) <auth-method>DIGEST and DB with md5a1 (not working)\n. you have to modify the getDigest() method in class \norg.apache.catalina.realm.RealmBase providing the chance to get this value \ndirectly from the DB\n\n\nBye\n  Giovanni", "id": 36907, "time": "2003-05-08T15:21:52Z", "bug_id": 19767, "creation_time": "2003-05-08T15:21:52Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 19767, "attachment_id": null, "id": 43287, "time": "2003-08-25T23:37:02Z", "creator": "funkman@joedog.org", "creation_time": "2003-08-25T23:37:02Z", "is_private": false, "text": "*** Bug 17908 has been marked as a duplicate of this bug. ***"}, {"count": 2, "tags": [], "creator": "markt@apache.org", "text": "*** Bug 4352 has been marked as a duplicate of this bug. ***", "id": 63430, "time": "2004-09-12T22:08:27Z", "bug_id": 19767, "creation_time": "2004-09-12T22:08:27Z", "is_private": false, "attachment_id": null}, {"count": 3, "attachment_id": null, "creator": "markt@apache.org", "text": "Fixed in CVS.", "id": 67508, "time": "2004-11-27T19:31:14Z", "bug_id": 19767, "creation_time": "2004-11-27T19:31:14Z", "tags": [], "is_private": false}]