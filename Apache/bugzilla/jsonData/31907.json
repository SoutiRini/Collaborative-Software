[{"count": 0, "attachment_id": null, "creator": "wburrows@e2open.com", "is_private": false, "id": 65786, "time": "2004-10-27T00:37:24Z", "bug_id": 31907, "creation_time": "2004-10-27T00:37:24Z", "tags": [], "text": "The problem was that some of the action related methods in the SecurityImpl \nclass were not \"enlisted\" to the current transaction when they made db calls. \nThe \"Uri\" object instance that was being used to call the store's retrieve \ninterface didn't have the current SlideToken set because the Uri was being \ncreated with getUri(String) and not getUri(SlideToken, String). Without the \ncurrent token set the Uri assumes that there is no current transaction going on \nand gets another connection to make its requests on. It seems that it was \neventually blocking waiting for the transaction to complete but the transaction \ncould not complete until it had performed its db reads. So I modified the path \nto loadActions() called from the\nmatchAction() method which takes a SlideToken and passed this token through to \nloadActions() setting Uri's with the getUri(String) with getUri(SlideToken, \nString) when I found it. I also fixed the call path to\nloadActions() that came from the PropertyHelper classes.\n\nTEST CASE:  this was easy to reproduce for me using the DB2 client on the 2.1b2 \nSlide server release I have. From a fresh Slide installation with an empty DB \nand Slide just started, simply lock a collection like \"/files\" then attempt to \ncreate a collection under it."}, {"count": 1, "attachment_id": 13229, "creator": "wburrows@e2open.com", "text": "Created attachment 13229\nCombined patch file for SecurityImpl.java, StructureImpl.java and PropertyHelper.java", "id": 65787, "time": "2004-10-27T00:47:54Z", "bug_id": 31907, "creation_time": "2004-10-27T00:47:54Z", "tags": [], "is_private": false}, {"count": 2, "attachment_id": null, "creator": "wburrows@e2open.com", "is_private": false, "id": 65788, "time": "2004-10-27T00:49:31Z", "bug_id": 31907, "creation_time": "2004-10-27T00:49:31Z", "tags": [], "text": "Modified component to security."}, {"count": 3, "tags": [], "creator": "ozeigermann@apache.org", "attachment_id": null, "is_private": false, "id": 65807, "time": "2004-10-27T08:32:09Z", "bug_id": 31907, "creation_time": "2004-10-27T08:32:09Z", "text": "Patch applied"}]