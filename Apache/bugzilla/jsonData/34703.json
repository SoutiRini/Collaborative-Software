[{"count": 0, "tags": [], "bug_id": 34703, "text": "A problem with thread synchronization in org.apache.taglibs.scrape.PageData\nleads to a java.lang.IllegalThreadStateException.  Looking at PageData CVS rev 1.15.\n\nIn scrapePage(), a synchronized(scraping) attempts to protect the instantiation\nand start()-ing of the new Page object (Thread).  This fails however, as\nscraping is an instance variable, and whilst still inside the critical section,\nscraping is reassigned:\n\nscraping = new Boolean(true);\n\n... unprotecting the critical section.  The result is that it is possible for\ntwo threads to attempt to start() the same page object, resulting in:\n\njava.lang.IllegalThreadStateException\n\tat java.lang.Thread.start(Native Method)\n\tat org.apache.taglibs.scrape.PageData.scrapePage(PageData.java:549)\n\tat org.apache.taglibs.scrape.PageTag.doEndTag(PageTag.java:152)\n\tat org.apache.jsp.scrap_jsp._jspService(scrap_jsp.java:165)\n\tat org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:92)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:809)\n\tat org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:162)\n\tat org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:240)\n\tat org.apache.jasper.servlet.JspServlet.service(JspServlet.java:187)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:809)\n\nRecommended solution: don't use \"scraping\" as the mutex if it needs to be\nreassigned during the critical section.  A second lock Object might be more\nappropriate.\n\nAs per any thread-related bug, this is difficult to reproduce, as you need two\nthreads to hit the expiring page at once, however in this case a review of the\ncode should make it clear how this problem can occur, and the fix is fairly simple.\n\nLet me know if you need a patch submitted.", "id": 74311, "time": "2005-05-02T13:18:00Z", "creator": "brett_s_r@yahoo.com.au", "creation_time": "2005-05-02T13:18:00Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "text": "Resolving. Taglib has been retired.", "attachment_id": null, "id": 132428, "creator": "bayard@apache.org", "time": "2009-11-29T19:42:07Z", "bug_id": 34703, "creation_time": "2009-11-29T19:42:07Z", "is_private": false}]