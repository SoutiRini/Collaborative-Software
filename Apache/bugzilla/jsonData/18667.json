[{"attachment_id": null, "tags": [], "bug_id": 18667, "text": "The javah module uses the old internal interface to javah with entry point Main\nand method run() and will generate an error for new JDK releases\n\njava.lang.NoClassDefFoundError: com/sun/tools/javah/Main\n at org.apache.tools.ant.taskdefs.optional.Javah.doClassicCompile(Javah.java:348)\n at org.apache.tools.ant.taskdefs.optional.Javah.execute(Javah.java:318)\n at org.apache.tools.ant.Task.perform(Task.java:319)\n at org.apache.tools.ant.Target.execute(Target.java:309)\n at org.apache.tools.ant.Target.performTasks(Target.java:336)\n at org.apache.tools.ant.Project.executeTarget(Project.java:1306)\n at org.apache.tools.ant.Project.executeTargets(Project.java:1250)\n at org.apache.tools.ant.Main.runBuild(Main.java:610)\n at org.apache.tools.ant.Main.start(Main.java:196)\n at org.apache.tools.ant.Main.main(Main.java:235)\n\nExample test case\n\n<project name=\"test\" default=\"build\" basedir=\".\">\n     <target name=\"build\" >\n         <javah destdir=\".\" class=\"hello\">\n             <classpath>\n                 <pathelement path=\"classes\"/>\n             </classpath>\n         </javah>\n    </target>\n</project>", "count": 0, "id": 34471, "time": "2003-04-03T20:25:11Z", "creator": "calvin.austin@sun.com", "creation_time": "2003-04-03T20:25:11Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 18667, "text": "I have a similar problem using Ant 1.5.1 on Linux with Java 1.4.2 beta.\n\njava.lang.NoSuchMethodError: com.sun.tools.javah.Main.<init>([Ljava/lang/String;\n)V\n        at org.apache.tools.ant.taskdefs.optional.Javah.doClassicCompile(Javah.\njava:348)\n        at org.apache.tools.ant.taskdefs.optional.Javah.execute(Javah.java:318)\n        at org.apache.tools.ant.Task.perform(Task.java:319)\n        at org.apache.tools.ant.Target.execute(Target.java:309)\n        at org.apache.tools.ant.Target.performTasks(Target.java:336)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1306)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1250)\n        at org.apache.tools.ant.Main.runBuild(Main.java:610)\n        at org.apache.tools.ant.Main.start(Main.java:196)\n        at org.apache.tools.ant.Main.main(Main.java:235)\n", "count": 1, "id": 34520, "time": "2003-04-04T11:11:04Z", "creator": "dan.dyer@empathysoftware.com", "creation_time": "2003-04-04T11:11:04Z", "is_private": false}, {"count": 2, "tags": [], "text": "This bug is posted on java.sun.com as bug 4824827\n\nhttp://developer.java.sun.com/developer/bugParade/bugs/4824827.html\n\nThe workaround they suggest is <exec/>", "attachment_id": null, "bug_id": 18667, "id": 34589, "time": "2003-04-06T20:02:54Z", "creator": "felix@physicianpal.com", "creation_time": "2003-04-06T20:02:54Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 18667, "attachment_id": null, "id": 34608, "time": "2003-04-07T05:39:51Z", "creator": "stevel@apache.org", "creation_time": "2003-04-07T05:39:51Z", "is_private": false, "text": "The sun bug is a bit self centred \"Ant will have to check what\nversion JDK it is running on and use a method present on that JDK.\", but of\ncourse there are no stable public methods; this is the whole problem. \n\nWe are going to have to fix this as we'll see the bugreps, but I am miffed at\ntheir attitude. 'yup, we changed stuff without telling you, you will just have\nto do a workaround'. Maybe the workaround will have to print out a snide comment in \nreturn about  Sun's developer team in response, something like \"using\nnonstandard entrypoint on java1.4.2 because whoever maintains javah doesnt like\nAnt\". "}, {"count": 4, "tags": [], "text": "btw I emailed Richard Beton back in February asking if he was still the javah\nmaintainer because there was an up and coming change to javah. \n\nI never received a reply", "attachment_id": null, "id": 34629, "creator": "calvin.austin@sun.com", "time": "2003-04-07T15:47:28Z", "bug_id": 18667, "creation_time": "2003-04-07T15:47:28Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 18667, "attachment_id": null, "id": 34641, "time": "2003-04-07T20:23:53Z", "creator": "stevel@apache.org", "creation_time": "2003-04-07T20:23:53Z", "is_private": false, "text": "We can get a patch together if someone can tell us what the new main() class is,\nwhether any params or exit values have changed. We like an entry point that does\nnot call System.exit(), incidentally. "}, {"count": 6, "tags": [], "bug_id": 18667, "attachment_id": null, "is_private": false, "id": 34645, "time": "2003-04-07T21:18:25Z", "creator": "jallers@advancedreality.com", "creation_time": "2003-04-07T21:18:25Z", "text": "It looks like javah is now implemented as a doclet. I don't think any of the\narguments hava changed.\n\ncom.sun.tools.javah.Main no longer is constructed with the arguments to run against.\n\nThe new implementation has a no arg constructor. The new main method verifies\nthe arguments, appends to more arguments for javadoc(\"-private\" and \"-Xclasses\",\nand invokes javadoc with the following command,\n\ncom.sun.tools.javadoc.Main.execute(\n    \"javadoc\",\n    \"com.sun.tools.javah.MainDoclet\",\n    args1);\n\n\"com.sun.tools.javah.MainDoclet\" does not appear to invoke System.exit, and I\nthink the execute method of com.sun.tools.javadoc.Main will not call System.exit.\n\nI think invoking javadoc with the javah doclet it the way to go for 1.4.2.\n\n\n"}, {"count": 7, "tags": [], "bug_id": 18667, "attachment_id": null, "id": 34646, "time": "2003-04-07T21:36:01Z", "creator": "calvin.austin@sun.com", "creation_time": "2003-04-07T21:36:01Z", "is_private": false, "text": "The 'old' interface is still available as \ncom.sun.tools.javah.oldjavah.Main.main(args) which should see ant through until\n(java) 1.5. This is what the javah binary currently uses"}, {"count": 8, "tags": [], "text": "out of curiosity, why was the old entry point moved? Just to see what broke?", "is_private": false, "bug_id": 18667, "id": 34654, "time": "2003-04-07T23:13:30Z", "creator": "stevel@apache.org", "creation_time": "2003-04-07T23:13:30Z", "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 18667, "attachment_id": null, "id": 34657, "time": "2003-04-07T23:46:12Z", "creator": "calvin.austin@sun.com", "creation_time": "2003-04-07T23:46:12Z", "is_private": false, "text": "This was supposed to be some pre work for the up and coming language changes. \nThe javah, javap and related tools use a different compiler 'engine' code than\nthe javac tool. Only one compiler engine would then need to be changed. \n\nThe person who did the change is no longer here.\n\n"}, {"count": 10, "tags": [], "bug_id": 18667, "attachment_id": 5684, "id": 34658, "time": "2003-04-07T23:57:48Z", "creator": "jallers@advancedreality.com", "creation_time": "2003-04-07T23:57:48Z", "is_private": false, "text": "Created attachment 5684\nPatch to Javah task to support 1.4.2 changes"}, {"attachment_id": null, "tags": [], "bug_id": 18667, "is_private": false, "count": 11, "id": 34800, "time": "2003-04-09T13:39:08Z", "creator": "bodewig@apache.org", "creation_time": "2003-04-09T13:39:08Z", "text": "Thanks james, patch will be in nightly build 2003-04-10."}, {"count": 12, "tags": [], "bug_id": 18667, "attachment_id": null, "id": 38307, "time": "2003-06-04T03:26:49Z", "creator": "conor@apache.org", "creation_time": "2003-06-04T03:26:49Z", "is_private": false, "text": "*** Bug 20425 has been marked as a duplicate of this bug. ***"}, {"count": 13, "tags": [], "text": "*** Bug 20700 has been marked as a duplicate of this bug. ***", "attachment_id": null, "bug_id": 18667, "id": 38755, "time": "2003-06-12T07:41:18Z", "creator": "peter.reilly@corvil.com", "creation_time": "2003-06-12T07:41:18Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 18667, "text": "*** Bug 20896 has been marked as a duplicate of this bug. ***", "count": 14, "id": 39078, "time": "2003-06-19T07:38:47Z", "creator": "peter.reilly@corvil.com", "creation_time": "2003-06-19T07:38:47Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 18667, "text": "*** Bug 21236 has been marked as a duplicate of this bug. ***", "count": 15, "id": 39795, "time": "2003-07-01T21:26:06Z", "creator": "antoine@apache.org", "creation_time": "2003-07-01T21:26:06Z", "is_private": false}, {"count": 16, "tags": [], "text": "*** Bug 21270 has been marked as a duplicate of this bug. ***", "attachment_id": null, "bug_id": 18667, "id": 39841, "time": "2003-07-02T11:38:09Z", "creator": "antoine@apache.org", "creation_time": "2003-07-02T11:38:09Z", "is_private": false}, {"count": 17, "tags": [], "creator": "peter.reilly@corvil.com", "is_private": false, "id": 40079, "creation_time": "2003-07-07T15:00:44Z", "time": "2003-07-07T15:00:44Z", "bug_id": 18667, "text": "*** Bug 21375 has been marked as a duplicate of this bug. ***", "attachment_id": null}, {"count": 18, "tags": [], "creator": "peter.reilly@corvil.com", "is_private": false, "text": "*** Bug 21410 has been marked as a duplicate of this bug. ***", "id": 40184, "time": "2003-07-08T15:34:30Z", "bug_id": 18667, "creation_time": "2003-07-08T15:34:30Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 18667, "is_private": false, "count": 19, "id": 41224, "time": "2003-07-23T14:00:33Z", "creator": "conor@apache.org", "creation_time": "2003-07-23T14:00:33Z", "text": "*** Bug 21827 has been marked as a duplicate of this bug. ***"}, {"count": 20, "tags": [], "bug_id": 18667, "attachment_id": null, "is_private": false, "id": 41680, "time": "2003-07-28T19:02:56Z", "creator": "antoine@apache.org", "creation_time": "2003-07-28T19:02:56Z", "text": "*** Bug 21942 has been marked as a duplicate of this bug. ***"}]