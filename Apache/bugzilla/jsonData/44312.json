[{"count": 0, "tags": [], "bug_id": 44312, "text": "On a system running tomcat 6.0.14 we encountered the problem, that the specified\ndocBase of the default Host of an Engine is being overwritten, when an Alias\nwith the same name (as the default Host) is defined on a different Host of the\nsame Engine.\n\nThe user should be warned if the docBase of the default Host is being changed to\nthe one of an Alias.\n\nWhen using tomcat 6.0.13 this problem didn't occur; means that the docBase of\nthe default Host remained the same for an equal configuration.\n\nAre there any future plans on providing such a warning?\n\nBest regards, Jan", "id": 113200, "time": "2008-01-28T08:31:40Z", "creator": "bielik@privasphere.com", "creation_time": "2008-01-28T08:31:40Z", "is_private": false, "attachment_id": null}, {"count": 1, "attachment_id": null, "creator": "markt@apache.org", "is_private": false, "id": 113227, "time": "2008-01-28T12:27:49Z", "bug_id": 44312, "creation_time": "2008-01-28T12:27:49Z", "tags": [], "text": "There are so many ways to do bad things with the configuration files I am not\nsure we could reasonably catch them all or should even try.\n\nThat said, if you want to provide a patch it will be considered. Keep in mind\nthat the more invasive the patch, the less likely it is to be considered."}, {"count": 2, "tags": [], "text": "I guess this only thing needed is to utter a \"SEVERE\" warning when\norg.apache.tomcat.util.http.mapper.Mapper.Context.extensionWrappers are created\nthat overwrite a pre-existing one...", "is_private": false, "id": 113250, "creator": "hauser@acm.org", "time": "2008-01-28T21:01:58Z", "bug_id": 44312, "creation_time": "2008-01-28T21:01:58Z", "attachment_id": null}, {"count": 3, "attachment_id": null, "creator": "markt@apache.org", "text": "No patch has been provided for consideration.", "id": 160394, "time": "2012-07-02T09:52:54Z", "bug_id": 44312, "creation_time": "2012-07-02T09:52:54Z", "tags": [], "is_private": false}, {"count": 4, "attachment_id": null, "creator": "knst.kolinko@gmail.com", "text": "Reopening.\n\nFrom looking into this, I think messing up host and alias names can really be a surprise for a sloppy admin.\n\nIn the Mapper class the hosts and aliases are in the same list. Duplicates are silently prevented by Mapper.insertMap() with the \"first come, first served\" behaviour. The results may be surprising.\n\n\nI have a patch for this.\n\nA test case:\nConfigure the following hosts in server.xml:\n\n[[[\n      <Host name=\"localhost\"  appBase=\"webapps\">\n        <!-- Alias equal to the name of its own Host is OK. -->\n        <Alias>localhost</Alias>\n      </Host>\n      <Host name=\"second\"  appBase=\"secondwebapps\">\n        <Alias>localhost</Alias>\n      </Host>\n      <Host name=\"third\"  appBase=\"thirdwebapps\">\n        <Alias>fourth</Alias>\n      </Host>\n      <Host name=\"fourth\"  appBase=\"fourthwebapps\">\n        <Alias>localhost</Alias>\n        <Alias>second</Alias>\n      </Host>\n]]]\n\nThere is also a bug in Mapper.removeHost(name):\nIf host with such name is not registered in the mapper, it results in NPE at  \"if (newHosts[i].object == host)\" line.\n(The find() method returns the closest match. To check that the correct item was found, one has to compare names).", "id": 175919, "time": "2014-06-19T23:12:15Z", "bug_id": 44312, "creation_time": "2014-06-19T23:12:15Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "text": "Fixed in Tomcat 8 by r1604066 and will be in 8.0.10 onwards.", "is_private": false, "id": 175920, "creator": "knst.kolinko@gmail.com", "time": "2014-06-20T01:09:36Z", "bug_id": 44312, "creation_time": "2014-06-20T01:09:36Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 44312, "attachment_id": null, "id": 175986, "time": "2014-06-23T17:44:33Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2014-06-23T17:44:33Z", "is_private": false, "text": "(In reply to Konstantin Kolinko from comment #4)\n\n> There is also a bug in Mapper.removeHost(name):\n> If host with such name is not registered in the mapper, it results in NPE\n> at  \"if (newHosts[i].object == host)\" line.\n\nFor a record:\nThe bug in removeHost(), removeHostAlias() that was fixed here is more serious than just an NPE.\n\nThe bug is that those methods may remove a wrong host.\n\nThey remove whatever host is located at hosts[pos], but the find() method does not return the exact name match, but closest name."}, {"count": 7, "attachment_id": null, "creator": "knst.kolinko@gmail.com", "text": "Fixed in Tomcat 7 by r1604895  and will be in 7.0.55 onwards.", "id": 175987, "time": "2014-06-23T18:02:10Z", "bug_id": 44312, "creation_time": "2014-06-23T18:02:10Z", "tags": [], "is_private": false}, {"count": 8, "tags": [], "bug_id": 44312, "text": "Created attachment 31744\n2014-06-23_tc6_44312.patch\n\nPatch that will be proposed for Tomcat 6.\n\nTestMapper includes test case for bug 56653 (testContextListConcurrencyBug56653)", "id": 175991, "time": "2014-06-23T18:39:39Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2014-06-23T18:39:39Z", "is_private": false, "attachment_id": 31744}, {"count": 9, "tags": [], "bug_id": 44312, "attachment_id": null, "text": "Tomcat 6 reached EOL without this patch being applied.", "id": 198162, "time": "2017-04-04T19:21:44Z", "creator": "markt@apache.org", "creation_time": "2017-04-04T19:21:44Z", "is_private": false}]