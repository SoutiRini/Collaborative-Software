[{"count": 0, "tags": [], "bug_id": 60428, "attachment_id": null, "id": 195280, "creation_time": "2016-11-29T03:13:14Z", "time": "2016-11-29T03:13:14Z", "creator": "liu_xp2003@sina.com", "text": "Steps:\n1. Create JMeter test script with default Backend Listener.\n2. Set correct graphiteHost,graphitePort,rootMetricsPrefix and samplersList.\n3. Change useRegexpForSamplersList to true.\n4. Run the test script.\n\nResult:\nWe can see exception like below:\n2016/11/29 11:01:19 WARN  - jmeter.engine.StandardJMeterEngine: Error encountered during shutdown of org.apache.jmeter.visualizers.backend.BackendListener@2b1f1961 java.lang.IllegalStateException: Failed calling teardownTest\n\tat org.apache.jmeter.visualizers.backend.BackendListener.testEnded(BackendListener.java:384)\n\tat org.apache.jmeter.visualizers.backend.BackendListener.testEnded(BackendListener.java:392)\n\tat org.apache.jmeter.engine.StandardJMeterEngine.notifyTestListenersOfEnd(StandardJMeterEngine.java:216)\n\tat org.apache.jmeter.engine.StandardJMeterEngine.run(StandardJMeterEngine.java:437)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.NullPointerException\n\tat org.apache.jmeter.visualizers.backend.graphite.GraphiteBackendListenerClient.teardownTest(GraphiteBackendListenerClient.java:327)\n\tat org.apache.jmeter.visualizers.backend.BackendListener.testEnded(BackendListener.java:382)\n\t... 4 more\n\n\nThis is issue should be bring with the Bug 59099 fixed at 9 month ago.\nBug 59099 - Backend listener : Add the possibility to consider samplersList as a Regular Expression\n\nI fixed this issue by changing code temporary. org.apache.jmeter.visualizers.backend.graphite.GraphiteBackendListenerClient\nmove line 304 \"samplersToFilter = new HashSet<>();\" after line 301", "is_private": false}, {"count": 1, "tags": [], "bug_id": 60428, "is_private": false, "text": "mistake!\nMove line 304 \"samplersToFilter = new HashSet<>();\" after line 299", "id": 195281, "time": "2016-11-29T03:16:47Z", "creator": "liu_xp2003@sina.com", "creation_time": "2016-11-29T03:16:47Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "felix.schumacher@internetallee.de", "is_private": false, "count": 2, "id": 195294, "time": "2016-11-29T20:12:25Z", "bug_id": 60428, "creation_time": "2016-11-29T20:12:25Z", "text": "Thanks for your contribution. \n\nI chose a slightly different approach by checking for null instead of initialising the collection, though.\n\nDate: Tue Nov 29 20:10:27 2016\nNew Revision: 1771952\n\nURL: http://svn.apache.org/viewvc?rev=1771952&view=rev\nLog:\nJMeter Graphite Backend Listener throws exception when test ends\nand useRegexpForSamplersList is set to true.\nBased on patch by Liu XP (liu_xp2003 at sina.com)\n\nBugzilla Id: 60428\n\nModified:\n    jmeter/trunk/src/components/org/apache/jmeter/visualizers/backend/graphite/GraphiteBackendListenerClient.java\n    jmeter/trunk/xdocs/changes.xml"}]