[{"count": 0, "tags": [], "creator": "JoeX@gmx.de", "text": "When shutting down Apache service \n(net stop Apache or\n Apache.exe -n Apache -k stop or\n Apache.exe -n Apache -k restart)\nI sometimes (randomly) get an Access Violation.\n\nMaybe its the same problem  described in BugReport No. 17986\n\nHad the same Problem with Apache 1.3.26, but only at Windows shutdown (again, \nonly sometimes).\n\nThat's what Dr.Watson said (german):\n\nDie Anwendung \"\" hat einen Programmfehler verursacht. Datum und Zeit des \nFehlers: 20.11.2003 um 16:51:17.171  Ausnahme: c0000005 an Adresse 77885C41 \n(RtlpWaitForCriticalSection)  \n\nLog:\n\nMicrosoft (R) Windows 2000 (R) Version 5.00 DrWtsn32\nCopyright (C) 1985-1999 Microsoft Corp. Alle Rechte vorbehalten.\n\n\n\nAnwendungsausnahme aufgetreten:\n        Anwendung:  (pid=1664)\n        Wann: 20.11.2003 @ 16:51:17.171\n        Ausnahmenummer: c0000005 (Zugriffsverletzung)\n\n*----> Systeminformationen <----*\n        Computername: lumpi\n        Benutzername: SYSTEM\n        Prozessoranzahl: 1\n        Prozessortyp: x86 Family 15 Model 1 Stepping 2\n        Windows 2000-Version: 5.0\n        Aktuelles Build: 2195\n        Service Pack: 3\n        Aktueller Typ: Uniprocessor Free\n        Firma:\n        Besitzer: Joseph Smith\n\n*----> Taskliste <----*\n   0 Idle.exe\n   8 System.exe\n 140 SMSS.exe\n 164 CSRSS.exe\n 184 WINLOGON.exe\n 212 SERVICES.exe\n 224 LSASS.exe\n 388 svchost.exe\n 420 spoolsv.exe\n 492 defwatch.exe\n 548 svchost.exe\n 592 rtvscan.exe\n 680 regsvc.exe\n 696 mstask.exe\n 748 WinMgmt.exe\n1240 explorer.exe\n1276 MSGSYS.exe\n1592 vptray.exe\n 944 jusched.exe\n 940 internat.exe\n1212 taskmgr.exe\n1620 SSEXP.exe\n1736 Compil32.exe\n1004 mmc.exe\n1612 MAPISP32.exe\n1952 CMD.exe\n2172 DRWTSN32.exe\n   0 _Total.exe\n\n(00400000 - 00405000) \n(77880000 - 77901000) \n(6EEC0000 - 6EEDE000) \n(77E70000 - 77F33000) \n(77DA0000 - 77DFD000) \n(77D20000 - 77D8E000) \n(74FA0000 - 74FB3000) \n(78000000 - 78046000) \n(74F90000 - 74F98000) \n(74F60000 - 74F73000) \n(77E00000 - 77E65000) \n(77F40000 - 77F7C000) \n(77970000 - 77994000) \n(74FC0000 - 74FC9000) \n(6EE60000 - 6EE88000) \n(6EE50000 - 6EE59000) \n(6FF00000 - 6FF40000) \n(77580000 - 777CC000) \n(70BD0000 - 70C34000) \n(71780000 - 7180A000) \n(74F40000 - 74F5D000) \n(74F80000 - 74F87000) \n(77830000 - 7783C000) \n(77310000 - 77323000) \n(774F0000 - 774F5000) \n(772F0000 - 77307000) \n(750C0000 - 750D0000) \n(750E0000 - 7512F000) \n(77BD0000 - 77BDF000) \n(75130000 - 75136000) \n(77940000 - 7796B000) \n(77A40000 - 77B2C000) \n(779A0000 - 77A3B000) \n(77380000 - 773AF000) \n(77350000 - 77372000) \n(77820000 - 7782E000) \n(78310000 - 783A0000) \n(77C00000 - 77C5F000) \n(774B0000 - 774E2000) \n(77490000 - 774A1000) \n(77500000 - 77522000) \n(77330000 - 77349000) \n(777D0000 - 777D8000) \n(777E0000 - 777E5000) \n(7CA00000 - 7CA23000) \n(77410000 - 77487000) \n(77400000 - 77410000) \n(6FCF0000 - 6FCF6000) \n(6FCD0000 - 6FCD6000) \n(6FCE0000 - 6FCE6000) \n(6FC90000 - 6FC97000) \n(6FC80000 - 6FC86000) \n(6FC20000 - 6FC27000) \n(6FC30000 - 6FC37000) \n(6FE70000 - 6FE7D000) \n(6FDA0000 - 6FDAA000) \n(6FD90000 - 6FD95000) \n(6FD70000 - 6FD76000) \n(10000000 - 10014000) \n(6FC50000 - 6FC55000) \n(6FD00000 - 6FD1F000) \n(00AA0000 - 00AC7000) \n(00AD0000 - 00BA8000) \n\nStatusabbild f\u00fcr Threadkennung 0x7f8\n\neax=00000000 ebx=00000000 ecx=00446694 edx=0000017c esi=00446684 edi=00000000\neip=77885c41 esp=0006dcc8 ebp=0006dd28 iopl=0         nv up ei pl zr na po nc\ncs=001b  ss=0023  ds=0023  es=0023  fs=0038  gs=0000             efl=00000246\n\n\nFunktion: RtlpWaitForCriticalSection\n        77885c1d 0f85307f0100              jne \nRtlEnableEarlyCriticalSectionEventCreation+0x151 (7789db53)\n        77885c23 a0d0f18c77      mov al,[RtlZeroHeap+0xa90 (778cf1d0)] ds:\n778cf1d0=01\n        77885c28 f6d8             neg     al\n        77885c2a 1bc0             sbb     eax,eax\n        77885c2c f7d0             not     eax\n        77885c2e 2580f48c77       and     eax,0x778cf480\n        77885c33 395e10           cmp     [esi+0x10],ebx         ds:00ec3c56=???\n?????\n        77885c36 8945fc           mov     [ebp+0xfc],eax         ss:\n00aeb2fa=8d000000\n        77885c39 0f84b3350000     je      RtlFreeSid+0x9c (778891f2)\n        77885c3f 8b06             mov     eax,[esi]              ds:\n00446684=00000000\nFEHLER ->77885c41 ff4010           inc     dword ptr [eax+0x10]   ds:00a7d5d2=??\n??????\n        77885c44 ff75fc           push    dword ptr [ebp+0xfc]   ss:\n00aeb2fa=8d000000\n        77885c47 8b06             mov     eax,[esi]              ds:\n00446684=00000000\n        77885c49 ff4014           inc     dword ptr [eax+0x14]   ds:00a7d5d2=???\n?????\n        77885c4c 53               push    ebx\n        77885c4d ff7610           push    dword ptr [esi+0x10]   ds:00ec3c56=???\n?????\n        77885c50 e826dbffff       call    NtWaitForSingleObject (7788377b)\n        77885c55 3d02010000       cmp     eax,0x102\n        77885c5a 0f84237f0100               je \nRtlEnableEarlyCriticalSectionEventCreation+0x181 (7789db83)\n        77885c60 3bc3             cmp     eax,ebx\n        77885c62 0f8cc87f0100               jl \nRtlEnableEarlyCriticalSectionEventCreation+0x22e (7789dc30)\n        77885c68 385d08           cmp     [ebp+0x8],bl                 ss:\n00aeb2fa=00\n\n*----> Stack Back Trace <----*\n\nFramePtr ReturnAd Param#1  Param#2  Param#3  Param#4  Function Name\n0006DD28 77885BD1 00446600 6EEC6905 00446684 6EEC597E ntdll!\nRtlpWaitForCriticalSection \n004465F8 FFFFFFFF 00000000 00000000 FFFFFFFF FFFFFFFF ntdll!\nRtlIntegerToUnicodeString \n004460F8 00000000 004440F0 00237F1C 00000000 00233A18 <nosymbols> \n\n*----> Raw Stack Dump <----*\n0006dcc8  00 00 00 00 67 00 00 00 - f8 65 44 00 c8 9e 08 00  ....g....eD.....\n0006dcd8  01 00 00 00 04 dd 06 00 - 68 dc 06 00 1a 00 00 00  ........h.......\n0006dce8  b0 ff 06 00 95 2b 88 77 - 18 36 88 77 ff ff ff ff  .....+.w.6.w....\n0006dcf8  2c dd 06 00 86 2e e7 77 - 00 00 07 00 00 00 00 00  ,......w........\n0006dd08  d0 9e 08 00 b8 dd 06 00 - b8 dd 06 00 d8 1f 00 00  ................\n0006dd18  1a 00 d8 1f b8 dd 06 00 - 34 00 36 00 00 00 00 00  ........4.6.....\n0006dd28  f8 65 44 00 d1 5b 88 77 - 00 66 44 00 05 69 ec 6e  .eD..[.w.fD..i.n\n0006dd38  84 66 44 00 7e 59 ec 6e - 78 66 44 00 fa dd 06 00  .fD.~Y.nxfD.....\n0006dd48  67 00 00 00 86 fc 0a 00 - f8 65 44 00 00 00 00 00  g........eD.....\n0006dd58  00 00 00 00 65 5c ec 6e - f8 65 44 00 90 dd 06 00  ....e\\.n.eD.....\n0006dd68  74 dd 06 00 d4 dd 06 00 - 4e da f0 6f 69 00 00 00  t.......N..oi...\n0006dd78  f8 65 44 00 20 00 00 00 - d8 80 23 00 00 9a 46 00  .eD. .....#...F.\n0006dd88  10 6f 4b 00 f8 65 44 00 - 5b 54 68 75 20 4e 6f 76  .oK..eD.[Thu Nov\n0006dd98  20 32 30 20 31 36 3a 35 - 31 3a 31 33 20 32 30 30   20 16:51:13 200\n0006dda8  33 5d 20 5b 77 61 72 6e - 5d 20 28 4f 53 20 36 29  3] [warn] (OS 6)\n0006ddb8  44 61 73 20 48 61 6e 64 - 6c 65 20 69 73 74 20 75  Das Handle ist u\n0006ddc8  6e 67 fc 6c 74 69 67 2e - 20 20 3a 20 46 61 69 6c  ng.ltig.  : Fail\n0006ddd8  65 64 20 74 6f 20 61 63 - 71 75 69 72 65 20 67 6c  ed to acquire gl\n0006dde8  6f 62 61 6c 20 6d 75 74 - 65 78 20 6c 6f 63 6b 0d  obal mutex lock.\n0006ddf8  0a 00 06 00 0c de 06 00 - 01 00 00 00 00 00 00 00  ................\n\nStatusabbild f\u00fcr Threadkennung 0x568\n\neax=778221fe ebx=00000004 ecx=77da0260 edx=00000000 esi=778837a7 edi=00000004\neip=778837b2 esp=00a8fd24 ebp=00a8fd70 iopl=0         nv up ei pl zr na po nc\ncs=001b  ss=0023  ds=0023  es=0023  fs=0038  gs=0000             efl=00000246\n\n\nFunktion: NtWaitForMultipleObjects\n        778837a7 b8e9000000       mov     eax,0xe9\n        778837ac 8d542404         lea     edx,[esp+0x4]          ss:0150d2f7=???\n?????\n        778837b0 cd2e             int     2e\n        778837b2 c21400           ret     0x14\n\n*----> Stack Back Trace <----*\n\nFramePtr ReturnAd Param#1  Param#2  Param#3  Param#4  Function Name\n00A8FD70 77E7A31D 00A8FD48 00000001 00000000 00000000 ntdll!\nNtWaitForMultipleObjects \n00A8FFB4 77E787DD 00000005 00000000 000B000A 00072680 kernel32!\nWaitForMultipleObjects \n00A8FFEC 00000000 778221FE 00072680 00000000 000000C8 kernel32!\nGetModuleFileNameA \n\n*----> Raw Stack Dump <----*\n00a8fd24  b7 7a e7 77 04 00 00 00 - 48 fd a8 00 01 00 00 00  .z.w....H.......\n00a8fd34  00 00 00 00 00 00 00 00 - 01 00 00 00 80 26 07 00  .............&..\n00a8fd44  01 00 00 00 d4 00 00 00 - d8 00 00 00 f0 00 00 00  ................\n00a8fd54  5c 01 00 00 00 00 00 00 - 00 00 00 00 48 54 8a 81  \\...........HT..\n00a8fd64  04 00 00 00 01 00 00 00 - 20 54 8a 81 b4 ff a8 00  ........ T......\n00a8fd74  1d a3 e7 77 48 fd a8 00 - 01 00 00 00 00 00 00 00  ...wH...........\n00a8fd84  00 00 00 00 00 00 00 00 - b2 22 82 77 04 00 00 00  .........\".w....\n00a8fd94  b0 fe a8 00 00 00 00 00 - ff ff ff ff 80 26 07 00  .............&..\n00a8fda4  0a 00 0b 00 00 00 00 00 - 64 ff 44 80 58 c3 76 e2  ........d.D.X.v.\n00a8fdb4  23 fc 44 80 00 00 00 00 - 01 00 00 00 38 00 00 00  #.D.........8...\n00a8fdc4  23 00 00 00 23 00 00 00 - 00 00 00 00 0a 00 0b 00  #...#...........\n00a8fdd4  80 26 07 00 00 6c 88 77 - 60 02 da 77 fe 21 82 77  .&...l.w`..w.!.w\n00a8fde4  00 00 00 00 85 87 e7 77 - 1b 00 00 00 00 02 00 00  .......w........\n00a8fdf4  fc ff a8 00 23 00 00 00 - 0c 2b 32 b7 04 00 00 00  ....#....+2.....\n00a8fe04  05 00 00 00 98 00 00 00 - f8 00 00 00 98 00 00 00  ................\n00a8fe14  74 2b 32 b7 00 08 45 80 - 05 00 00 00 24 00 01 e1  t+2...E.....$...\n00a8fe24  05 00 00 00 fe ff f8 00 - b8 e6 1f 81 34 00 00 c0  ............4...\n00a8fe34  88 4b 16 e3 02 00 00 00 - 49 03 00 00 88 4b 16 e3  .K......I....K..\n00a8fe44  60 2b 32 b7 d0 87 8a 81 - b4 2b 32 b7 0c 11 45 80  `+2......+2...E.\n00a8fe54  88 87 00 e1 e0 49 8a 81 - bc 2c 32 b7 68 87 8a 81  .....I...,2.h...", "id": 47750, "time": "2003-11-21T08:27:17Z", "bug_id": 24879, "creation_time": "2003-11-21T08:27:17Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 24879, "attachment_id": null, "id": 47993, "time": "2003-11-24T09:37:04Z", "creator": "JoeX@gmx.de", "creation_time": "2003-11-24T09:37:04Z", "is_private": false, "text": "Found a workaround (thanks to http://www.devside.net/web/server/win32/apache)\n\nEdit 'LogLevel warn' in httpd.conf to 'LogLevel error', or anything above \n'warn'.\n['warn' and below creates an illegal memory reference upon exit of Apache after \nan SSL request]\n"}, {"count": 2, "tags": [], "text": "Hi it's me again :-)\n\nFound that setting the SSLSessionCache to \"none\" works for me.\n", "attachment_id": null, "bug_id": 24879, "id": 47997, "time": "2003-11-24T11:02:18Z", "creator": "JoeX@gmx.de", "creation_time": "2003-11-24T11:02:18Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 24879, "attachment_id": null, "id": 80777, "creation_time": "2005-10-05T06:45:26Z", "time": "2005-10-05T06:45:26Z", "creator": "john.shelton@sheltoncomputers.biz", "text": "I'm using Windows XP Professional with SP2 fully updated. I have apache 2.0.54 \npre-compiled (installation wizard) and installed as \"Apache2\" service on system \naccount. I get a similiar problem, if not same, when shutting down apache or \nwhen starting apache (roughly 10 - 20 seconds afterwards) by the apache monitor. \nBoth errors present the screen \"has performed an illegal operation and needs to \nclose\" along with the send error or don't send error report. I traced it back to \ntwo DLL's that give me this error - ntdll.dll & libapr.dll\n\nHere is the application logs for Apache.exe\n===============================================================================\nEvent Type:\tError\nEvent Source:\tApplication Error\nEvent Category:\t(100)\nEvent ID:\t1000\nDate:\t\t10/2/2005\nTime:\t\t8:06:42 PM\nUser:\t\tN/A\nComputer:\tASCENT\nDescription:\nFaulting application Apache.exe, version 2.0.54.0, faulting module ntdll.dll, \nversion 5.1.2600.2180, fault address 0x00001230.\n\nFor more information, see Help and Support Center at http://go.microsoft.com/\nfwlink/events.asp.\nData:\n0000: 41 70 70 6c 69 63 61 74   Applicat\n0008: 69 6f 6e 20 46 61 69 6c   ion Fail\n0010: 75 72 65 20 20 41 70 61   ure  Apa\n0018: 63 68 65 2e 65 78 65 20   che.exe \n0020: 32 2e 30 2e 35 34 2e 30   2.0.54.0\n0028: 20 69 6e 20 6e 74 64 6c    in ntdl\n0030: 6c 2e 64 6c 6c 20 35 2e   l.dll 5.\n0038: 31 2e 32 36 30 30 2e 32   1.2600.2\n0040: 31 38 30 20 61 74 20 6f   180 at o\n0048: 66 66 73 65 74 20 30 30   ffset 00\n0050: 30 30 31 32 33 30         001230  \n===============================================================================\nEvent Type:\tError\nEvent Source:\tApplication Error\nEvent Category:\t(100)\nEvent ID:\t1000\nDate:\t\t10/2/2005\nTime:\t\t4:40:55 PM\nUser:\t\tN/A\nComputer:\tASCENT\nDescription:\nFaulting application Apache.exe, version 2.0.54.0, faulting module libapr.dll, \nversion 0.0.0.0, fault address 0x00007983.\n\nFor more information, see Help and Support Center at http://go.microsoft.com/\nfwlink/events.asp.\nData:\n0000: 41 70 70 6c 69 63 61 74   Applicat\n0008: 69 6f 6e 20 46 61 69 6c   ion Fail\n0010: 75 72 65 20 20 41 70 61   ure  Apa\n0018: 63 68 65 2e 65 78 65 20   che.exe \n0020: 32 2e 30 2e 35 34 2e 30   2.0.54.0\n0028: 20 69 6e 20 6c 69 62 61    in liba\n0030: 70 72 2e 64 6c 6c 20 30   pr.dll 0\n0038: 2e 30 2e 30 2e 30 20 61   .0.0.0 a\n0040: 74 20 6f 66 66 73 65 74   t offset\n0048: 20 30 30 30 30 37 39 38    0000798\n0050: 33                        3       \n=============================================================================\n\nOf course apache restarts automatically as a system service and continues like \nit should (all modules, configurations, etc. work that I use including php 4.4.0 \n(module), active perl 5.7.86, asp.net module). This is NO major error for me but \nmay be for other people.", "is_private": false}, {"count": 4, "tags": [], "text": "I just read the post about sslsessioncache.....i don't even have any ssl modules \nloaded.........", "is_private": false, "bug_id": 24879, "id": 80778, "time": "2005-10-05T06:46:49Z", "creator": "john.shelton@sheltoncomputers.biz", "creation_time": "2005-10-05T06:46:49Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 24879, "attachment_id": null, "id": 80926, "creation_time": "2005-10-09T02:06:29Z", "time": "2005-10-09T02:06:29Z", "creator": "john.shelton@sheltoncomputers.biz", "text": "ok i ran debug with my Visual C studio. It says this line in ntdll.dll is giving \nthe trouble:\n\n7C901230   int         3\n7C901231   ret\n7C901232   mov         edi,edi\n\nI don't know C programming but i thought it might help the situation.", "is_private": false}, {"count": 6, "tags": [], "creator": "john.shelton@sheltoncomputers.biz", "attachment_id": null, "text": "Now it says invalid handle or something for this line in ntdll.dll\n\n7C90EB74   mov         eax,dword ptr [esp]\n\nand from the error i last posted\n\n7C901230   int         3\n7C901231   ret\n7C901232   mov         edi,edi\n\nIt says User breakpoint called from code or something.", "id": 80927, "time": "2005-10-09T02:11:42Z", "bug_id": 24879, "creation_time": "2005-10-09T02:11:42Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 24879, "attachment_id": null, "id": 112050, "creation_time": "2007-12-21T21:40:44Z", "time": "2007-12-21T21:40:44Z", "creator": "wrowe@apache.org", "text": "In the more recent releases, the WAIT_ABANDONED is correctly handled,\nand I believe that was the cause of this issue.", "is_private": false}]