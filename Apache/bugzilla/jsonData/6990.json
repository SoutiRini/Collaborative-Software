[{"count": 0, "tags": [], "bug_id": 6990, "attachment_id": null, "id": 11576, "time": "2002-03-08T14:30:42Z", "creator": "jarecsni.janos@chello.hu", "creation_time": "2002-03-08T14:30:42Z", "is_private": false, "text": "We are using Catalina embedded in JBoss 2.4.4. Formerly we used TC 3.2.3 with \nJBoss 2.4.1: they had been up and running for weeks without any problem.\n\nNow this version of Catalina hangs after 2-5 days of operating. Although I kill \nthe JBoss-Catalina server there's always one thread (process) remains, which is \na Catalina thread. It cannot be killed with kill -9. \n\nThis is regular, so since we have this upgrade, we had no normal shutdowns, and \nthe server needs to be restarted in every few days.\n\nWe use Apache in front, using the mod_jk connector. \n\nHope this will soon be resolved, since it's now a major threat to us, since our \nwebsite is in production for a while now.\n\nCheers\nJ\u00e1nos\nPS: heard 4-5 other people complaining about similar issue."}, {"count": 1, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "text": "It is very hard to use this kind of bug report as is, since it doesn't specify\nmuch information except the fact that TC is hanging.\nFor example, you should precise the workload and the type of webapps used\n(servlets, JSPs, EJBs, ...), suspect errors which may end up in the logs.\n\nAlso, did you try to test your server with ab ? Can you reproduce the problem\njust by hammering the server for some time ?", "id": 11583, "time": "2002-03-08T17:19:12Z", "bug_id": 6990, "creation_time": "2002-03-08T17:19:12Z", "is_private": false}, {"text": "Well, Remy, this bugreport is so laconic because not too much can be seen from \nwhat's happening. There's our website, modest load (30-60 concurrent sessions, \nI don't exactly know how many concurrent users). \n\nI tried to stress the application a bit (opening 4-5 browsers, requesting pages \nrandomly). There was no problem. My suspicion is that time is a factor here \nthat matters somehow. \n\nWhat I noticed in each case was that there is always exactly one thread (linux \nprocess) which cannot be killed. It seems that memory is not eaten up, CPU is \nfree, so it indicates that the process in question simply waits for something. \nBut then why this hangs the whole server?\n\ncheers,\nJ\u00e1nos", "tags": [], "creator": "jarecsni.janos@chello.hu", "attachment_id": null, "count": 2, "id": 11589, "time": "2002-03-08T17:45:20Z", "bug_id": 6990, "creation_time": "2002-03-08T17:45:20Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 6990, "text": "Could you use ab to stress test the site (it's included in the Apache HTTPd\nbinaries), and see if you can reproduce the problem using that ?\nAre all the logs empty of useful info ? (in particular, catalina_log)\nWithout a reliable way to reproduce it, this will be very hard to fix, I'm afraid.", "id": 11592, "time": "2002-03-08T18:22:32Z", "creator": "remm@apache.org", "creation_time": "2002-03-08T18:22:32Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 6990, "text": "I get something similar.  I'm using Catalina 4.0.2 with Ajp13Connector/mod_jk\ncompiled from Tomcat Connectors 4.0.2_1, using apache 1.3.22 to serve non-jsp\npages.  We are running are production site off the following setup, but\noccasionally a java/httpd pair will start spinning indefinately.  Curious about\nwhat was causing this, I took a stack dump using killall -QUIT java and looked\nup the spinning threads.  This revealed the following thread which seemed to be\nhanging above request.getParameter(String paramname). Let me know if you need\nmore info, or suggestions on working around the problem.\n\n\"Ajp13Processor[8009][9]\" daemon prio=1 tid=0x0x828a1c0 nid=0x7e33 runnable\n[5437f000..5438086c]\n        at java.net.SocketInputStream.socketRead0(Native Method)\n        at java.net.SocketInputStream.read(SocketInputStream.java:116)\n        at org.apache.ajp.Ajp13.readN(Ajp13.java:429)\n        at org.apache.ajp.Ajp13.receive(Ajp13.java:469)\n        at org.apache.ajp.RequestHandler.refillReadBuffer(RequestHandler.java:712)\n        at org.apache.ajp.RequestHandler.doRead(RequestHandler.java:655)\n        at org.apache.ajp.Ajp13.doRead(Ajp13.java:354)\n        at org.apache.ajp.tomcat4.Ajp13InputStream.read(Ajp13InputStream.java:99)\n        at\norg.apache.catalina.connector.HttpRequestBase.parseParameters(HttpRequestBase.java:644)\n        at\norg.apache.catalina.connector.HttpRequestBase.getParameter(HttpRequestBase.java:674)\n        at\norg.apache.catalina.connector.RequestFacade.getParameter(RequestFacade.java:160)\n        at org.apache.jsp.memberLogin$jsp.login(memberLogin$jsp.java:59)\n        at org.apache.jsp.memberLogin$jsp._jspService(memberLogin$jsp.java:500)\n        at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:107)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n        at\norg.apache.jasper.servlet.JspServlet$JspServletWrapper.service(JspServlet.java:202)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:382)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:474)\n        at com.ee.servlet.RedirectJspServlet.service(RedirectJspServlet.java:43)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:247)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)\n        at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:243)\n        at\norg.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:566)\n        at\norg.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:472)\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n        at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:190)\n        at\norg.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:566)\n        at\norg.apache.catalina.valves.CertificatesValve.invoke(CertificatesValve.java:246)\n        at\norg.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:564)\n        at com.ee.servlet.HandleJspServlet.invoke(HandleJspServlet.java:77)\n        at\norg.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:564)\n        at\norg.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:472)\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n        at\norg.apache.catalina.core.StandardContext.invoke(StandardContext.java:2343)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:180)\n        at\norg.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:566)\n        at\norg.apache.catalina.valves.ErrorDispatcherValve.invoke(ErrorDispatcherValve.java:170)\n        at\norg.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:564)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:170)\n        at\norg.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:564)\n        at\norg.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:472)\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:174)\n        at\norg.apache.catalina.core.StandardPipeline.invokeNext(StandardPipeline.java:566)\n        at\norg.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:472)\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:943)\n        at org.apache.ajp.tomcat4.Ajp13Processor.process(Ajp13Processor.java:458)\n        at org.apache.ajp.tomcat4.Ajp13Processor.run(Ajp13Processor.java:551)\n        at java.lang.Thread.run(Thread.java:536)", "id": 13911, "time": "2002-04-17T21:12:20Z", "creator": "brian@experts-exchange.com", "creation_time": "2002-04-17T21:12:20Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "glenn@apache.org", "attachment_id": null, "text": "There is a bug that can be triggered rarely when an HTTP POST is performed\nusing mod_jk which causes the HTTP POST Request content sent to be < the\nContentLength.  A fix has been found and committed to CVS. The bug fix will be\navailable in the next 4.0.x release.\n\nAs a work around you can do an Apache reload, this will tear down the socket\nfrom the Apache side which will cause Tomcat to break out of that infinite\nloop.\n\n", "id": 13968, "time": "2002-04-18T14:02:58Z", "bug_id": 6990, "creation_time": "2002-04-18T14:02:58Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 6990, "attachment_id": null, "id": 14361, "time": "2002-04-22T20:22:32Z", "creator": "brian@experts-exchange.com", "creation_time": "2002-04-22T20:22:32Z", "is_private": false, "text": "cool, thanks a lot for the info. I have a script that finds these spinning httpd\nprocesses and terminates them, it's a hack but it works wonderfully.  Looking\nforward to future tomcat 4.0.x releases"}]