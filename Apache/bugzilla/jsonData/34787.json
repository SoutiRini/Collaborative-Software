[{"count": 0, "tags": [], "bug_id": 34787, "attachment_id": null, "id": 74541, "time": "2005-05-06T18:09:08Z", "creator": "apache@gagravarr.org", "creation_time": "2005-05-06T18:09:08Z", "is_private": false, "text": "ddf.EscherClientAnchorRecord assumes that it has 9 2 byte records, and hence is\n26 bytes long. In some powerpoint files, it just has 4 2 bytes records, so the\nsize is only 16 bytes. Because of its assumption, this breaks things.\n\nAttached is a patch to make it check that it has the data before trying to read\nthe last 5 fields, which stops it breaking on 4 field records. (However, it\nmakes no attempt to ensure that the first 4 fields correspond to the ones\npresent in a short record, since there's no guide I can find to explain what the\n4 fields in a short record actually correspond to)"}, {"text": "Created attachment 14954\npatch for short records", "tags": [], "creator": "apache@gagravarr.org", "attachment_id": 14954, "count": 1, "id": 74542, "time": "2005-05-06T18:09:28Z", "bug_id": 34787, "creation_time": "2005-05-06T18:09:28Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 34787, "attachment_id": 14955, "id": 74543, "time": "2005-05-06T18:36:21Z", "creator": "apache@gagravarr.org", "creation_time": "2005-05-06T18:36:21Z", "is_private": false, "text": "Created attachment 14955\nUpdated patch that also handles the size when writing back out\n\nForgot to store the fact that we are a short record for when writing back out.\nThis version uses that when writing out, and disables short record status if\nany of flags 5-9 happen to get set"}, {"count": 3, "tags": [], "bug_id": 34787, "attachment_id": null, "id": 75364, "time": "2005-05-25T17:38:08Z", "creator": "avik@apache.org", "creation_time": "2005-05-25T17:38:08Z", "is_private": false, "text": "Comitted, thanks. pls verify. "}, {"count": 4, "tags": [], "text": "Created attachment 15172\nPatch to the unit test for EscherClientAnchorRecord\n\nUpdate to the unit test, to include a test for short records\n\n(Shows that the currently applied patch works just great)", "is_private": false, "bug_id": 34787, "id": 75388, "time": "2005-05-25T23:23:52Z", "creator": "apache@gagravarr.org", "creation_time": "2005-05-25T23:23:52Z", "attachment_id": 15172}]