[{"count": 0, "tags": [], "bug_id": 4189, "text": "I have a task defined in my build.xml thus:\n\n  <target name=\"stubs\" depends=\"dds\">\n    <ejbc\n           descriptors=\"${dds}\"\n           src=\"${src}\"\n           dest=\"${dds}\"\n           manifest=\"${build.manifest}\"\n           classpath=\"${build};${classes}\">\n           <include name=\"**/*.ser\" />\n    </ejbc>\n  </target>\n\nWhen it runs I get this message:\n\n     [ejbc] The following character string is too long:\n     [ejbc]\n\n  BUILD FAILED\n\n  d:\\dev\\main\\build.xml:68: Execution of ejbc helper failed\n\nIf I run Ant with the -debug option I can see that it is trying to launch a JVM \nto run the org.apache.tools.ant.taskdefs.optional.ejb.EjbcHelper class via \ncmd.  The command line supplied to it is very long as it lists all the .ser \nfiles found.  If I copy and paste the command as an argument to cmd /c (via a \nbash shell, I can't even paste it into a command prompt) I get the same message.\n\nI can work around this, but a fix would be nice.  I would suggest either not \nusing a sub-process, or passing the pattern sets to the sub-processes using a \ntemporary file.\n\n\nThe output from the Ant -debug command looks like the following:\n--------------------------------------------------------------------------\nstubs:\n   +Task: java\n     [ejbc] Forking java -classpath ... \norg.apache.tools.ant.taskdefs.optional.ejb.EjbcHelper dds dds src manifest.mf \nfalse ...lots_of_.ser_files...\nExecute:CommandLauncher: cmd /c cd /d D:\\dev\\MAIN && java -classpath ... \norg.apache.tools.ant.taskdefs.optional.ejb.EjbcHelper dds dds src manifest.mf\n false ...lots_of_.ser_files...\n     [ejbc] The following character string is too long:\n     [ejbc]\n\nBUILD FAILED\n\nd:\\dev\\main\\build.xml:68: Execution of ejbc helper failed\n--------------------------------------------------------------------------", "id": 6745, "time": "2001-10-16T02:33:08Z", "creator": "reg.whitton@ifonline.com", "creation_time": "2001-10-16T02:33:08Z", "is_private": false, "attachment_id": null}, {"count": 1, "attachment_id": null, "bug_id": 4189, "text": "Have tried this again in 1.4.1 and the problem is still the same.\n\nThe problem is (as suspected) the use of cmd.exe which must have a limited \ncommand line.  I changed a copy of org.apache.tools.ant.taskdefs.Execute so \nthat the method WinNTCommandLauncher does not piggy back the command on cmd.exe \nand so does not change directory.  This works fine for me as I always run Ant \nin my project directory.\n\nThere appears to be no other way to change the current working directory for \nthe sub-process in java (why is that?). So there doesn't seem to be a easy \ngeneric solution to this problem.\n\nMaybe there it could be done with a native executable for piggy backing \ncommands (like env except it changes dir instead of the environment).", "id": 6756, "time": "2001-10-16T08:40:59Z", "creator": "reg.whitton@ifonline.com", "creation_time": "2001-10-16T08:40:59Z", "tags": [], "is_private": false}, {"count": 2, "attachment_id": null, "bug_id": 4189, "is_private": false, "id": 6779, "time": "2001-10-17T00:42:48Z", "creator": "reg.whitton@ifonline.com", "creation_time": "2001-10-17T00:42:48Z", "tags": [], "text": "OK - Solved my problem.  Looking carefully at the code I can see that if I use \nJDK 1.3, Ant 1.4.1 does not use cmd.exe.  Instead it uses the new Runtime.exec\n(String[] cmdarray, String[] envp, File dir) method to change directory and run \nprocesses.\n\nThis just leaves me trying to get Ant to use JDK 1.3, while building a project \nthat uses 1.2.2.  Ho Hum.\n\n"}, {"count": 3, "attachment_id": null, "bug_id": 4189, "text": "OK.  So, may I go ahead and mark this report as invalid?", "id": 10229, "time": "2002-02-02T17:16:09Z", "creator": "umagesh@apache.org", "creation_time": "2002-02-02T17:16:09Z", "tags": [], "is_private": false}, {"count": 4, "attachment_id": null, "bug_id": 4189, "text": "Yes.  Please do.", "id": 10286, "time": "2002-02-04T07:52:49Z", "creator": "reg.whitton@ifonline.com", "creation_time": "2002-02-04T07:52:49Z", "tags": [], "is_private": false}, {"count": 5, "attachment_id": null, "bug_id": 4189, "is_private": false, "id": 10298, "time": "2002-02-04T14:39:33Z", "creator": "umagesh@apache.org", "creation_time": "2002-02-04T14:39:33Z", "tags": [], "text": "User wants this marked invalid."}]