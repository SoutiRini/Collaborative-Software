[{"count": 0, "tags": [], "bug_id": 19012, "is_private": false, "text": "Hi,\n\n      I tried to build Apache 2.0.45 in my AIX 5.1 system. \nhere is what I start to build:\n./configure --enable-ssl=shared \\\n--with-ssl=/usr/local/ssl \\\n--enable-rule=SHARED_CORE \\\n--enable-module=so\n\neverything is working fine then I do make\nno error\nmake install no error\nbut when I relized mod_so doesn't work I went beck to check the config.log file.\nit is showed:\n..........\nconfigure:14313: checking whether to enable mod_userdir\nconfigure:14351: result: yes (default)\nconfigure:14399: checking whether to enable mod_alias\nconfigure:14437: result: yes (default)\nconfigure:14486: checking whether to enable mod_rewrite\nconfigure:14524: result: no\nconfigure:14618: checking whether to enable mod_so\nconfigure:14656: result:\nconfigure:15020: checking whether byte ordering is bigendian\n..........\n\nsomehow mod_so module can not be turned on\n\n--Tony", "id": 35142, "time": "2003-04-14T21:01:40Z", "creator": "tfan@kronos.com", "creation_time": "2003-04-14T21:01:40Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 19012, "text": "Try --enable-so or --enable-modules=so\n\n(Have I mentioned how annoying it is that you can\n--enable-whatever-you-want without getting an \nerror message; yes, I think I have.)", "count": 1, "id": 35146, "time": "2003-04-14T23:03:01Z", "creator": "slive@apache.org", "creation_time": "2003-04-14T23:03:01Z", "is_private": false}, {"count": 2, "tags": [], "creator": "trawick@apache.org", "attachment_id": null, "id": 35148, "time": "2003-04-14T23:18:38Z", "bug_id": 19012, "creation_time": "2003-04-14T23:18:38Z", "is_private": false, "text": "Also, drop the --enable-rule=SHARED_CORE argument.  That too is Apache-1.3-style\nconfigure argument which means nothing to Apache 2.0.\n\n(But I suspect you have mod_so anyway...  mod_so defaults to on for most systems\n(including AIX 5.1)...  Try ./httpd -l and see if mod_so.c is in the output.)\n\nAlso, there is a bug in the message generation.  As you noticed, nothing is\nprinted in the expected position to say yes or no or shared.\n"}, {"count": 3, "tags": [], "bug_id": 19012, "is_private": false, "text": "Thank you for the information.  I recomplired Aapche,  I check httpd -l to make \nsure I had mod_so,  but after I used JRun 4 connector to configure with Apache.\nhere is the error I am getting.\n# ./apachectl start\nSyntax error on line 1037 of /usr/local/apache2/conf/httpd.conf:\nCannot load /home/tfan/jrun4/lib/wsconfig/1/mod_jrun20.so into server: \n\nhere is line 1037 from httpd.conf:\nLoadModule jrun_module /home/tfan/jrun4/lib/wsconfig/1/mod_jrun20.so\n\nthis error most likely is mod_so doesn't work.  any ideal?", "id": 35375, "time": "2003-04-16T19:36:27Z", "creator": "tfan@kronos.com", "creation_time": "2003-04-16T19:36:27Z", "attachment_id": null}, {"count": 4, "text": "Ehm no, the error probably says, that mod_jrun doesn't work with that httpd version.\n\n  Syntax error on line 1037 of /usr/local/apache2/conf/httpd.conf:\n  Cannot load /home/tfan/jrun4/lib/wsconfig/1/mod_jrun20.so into server: \n  <here is the interesting part>\n\nwhat is the interesting message?", "creator": "nd@perlig.de", "attachment_id": null, "id": 35377, "time": "2003-04-16T19:53:45Z", "bug_id": 19012, "creation_time": "2003-04-16T19:53:45Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "bug_id": 19012, "attachment_id": null, "text": "Unfortunately, some Apache modules don't build properly\non AIX and an inability to load them is a frequent symptom.\n\nSee my fun at trying to get some Tomcat connectors to build properly \non AIX: http://www.apache.org/~trawick/tomcataix.html\n\nSend me privately the output of \"dump -Tv mod_jrun20.so\" and \"dump -Hv\nmod_jrun20.so\" and I'll maybe have a guess as to why they won't load.\n", "id": 35378, "time": "2003-04-16T19:58:39Z", "creator": "trawick@apache.org", "creation_time": "2003-04-16T19:58:39Z", "is_private": false}, {"count": 6, "tags": [], "creator": "tfan@kronos.com", "attachment_id": null, "id": 35379, "time": "2003-04-16T20:11:22Z", "bug_id": 19012, "creation_time": "2003-04-16T20:11:22Z", "is_private": false, "text": "Here is result for dump -Tv mod_jrun20.so:\n\n# dump -Tv /home/tfan/jrun4/lib/wsconfig/1/mod_jrun20.so\n\n/home/tfan/jrun4/lib/wsconfig/1/mod_jrun20.so:\n\n                        ***Loader Section***\n\n                        ***Loader Symbol Table Information***\n[Index]      Value      Scn     IMEX Sclass   Type           IMPid Name\n\n[0]     0x00000000    undef      IMP     DS EXTref               . ap_add_cgi_va\nrs\n[1]     0x00000000    undef      IMP     DS EXTref               . ap_add_common\n_vars\n[2]     0x00000000    undef      IMP     DS EXTref               . ap_destroy_su\nb_req\n[3]     0x00000000    undef      IMP     DS EXTref               . ap_get_client\n_block\n[4]     0x00000000    undef      IMP     DS EXTref               . ap_log_error\n[5]     0x00000000    undef      IMP     DS EXTref               . ap_os_escape_\npath\n[6]     0x00000000    undef      IMP     DS EXTref               . ap_rflush\n[7]     0x00000000    undef      IMP     DS EXTref               . ap_rwrite\n[8]     0x00000000    undef      IMP     DS EXTref               . ap_set_conten\nt_length\n[9]     0x00000000    undef      IMP     DS EXTref               . ap_setup_clie\nnt_block\n[10]    0x00000000    undef      IMP     DS EXTref               . ap_should_cli\nent_block\n[11]    0x00000000    undef      IMP     DS EXTref               . ap_sub_req_lo\nokup_uri\n[12]    0x00000000    undef      IMP     UA EXTref   libc.a(shr.o) errno\n[13]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) close\n[14]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) socket\n[15]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) send\n[16]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) recv\n[17]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) setsockopt\n[18]    0x00000000    undef      IMP     UA EXTref   libc.a(shr.o) _system_confi\nguration\n[19]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) free\n[20]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) malloc\n[21]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) strlen\n[22]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) fopen\n[23]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) strncasecmp\n[24]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) atoi\n[25]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) strchr\n[26]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) strtok\n[27]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) fclose\n[28]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) memset\n[29]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) vsprintf\n[30]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) sprintf\n[31]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) fwrite\n[32]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) strncmp\n[33]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) tolower\n[34]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) fread\n[35]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) strdup\n[36]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) ftell\n[37]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) fseek\n[38]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) time\n[39]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) gettimeofday\n[40]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) strstr\n[41]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) srand\n[42]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) rand\n[43]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) strerror\n[44]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) connect\n[45]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) inet_addr\n[46]    0x00000000    undef      IMP     DS EXTref   libc.a(shr.o) strcasecmp\n[47]    0x20000580    .data      EXP     RW SECdef        [noIMid] jrun_module\n[48]    0x200005b8    .data      EXP     RW SECdef        [noIMid] jrMetrics\n[49]    0x200005c0    .data      EXP     RW SECdef        [noIMid] VARIABLE_NAME\nS\n[50]    0x2000089c    .data      EXP     DS SECdef        [noIMid] loadServersFr\nomStore\n[51]    0x200008a8    .data      EXP     DS SECdef        [noIMid] mappingsTable\nNew\n[52]    0x200008b4    .data      EXP     DS SECdef        [noIMid] mappingsTable\nDelete\n[53]    0x200008c0    .data      EXP     DS SECdef        [noIMid] init_jrun_req\nuest\n[54]    0x200008cc    .data      EXP     DS SECdef        [noIMid] retrieveServe\nrsFromServer\n[55]    0x200008d8    .data      EXP     DS SECdef        [noIMid] persistServer\ns\n[56]    0x200008e4    .data      EXP     DS SECdef        [noIMid] longerThan\n[57]    0x200008f0    .data      EXP     DS SECdef        [noIMid] removePathPar\nms\n[58]    0x200008fc    .data      EXP     DS SECdef        [noIMid] jrunProxyNew\n[59]    0x20000908    .data      EXP     DS SECdef        [noIMid] startSync\n[60]    0x20000914    .data      EXP     DS SECdef        [noIMid] gtod\n[61]    0x20000920    .data      EXP     DS SECdef        [noIMid] tvToMillis\n[62]    0x2000092c    .data      EXP     DS SECdef        [noIMid] stopSync\n[63]    0x20000938    .data      EXP     DS SECdef        [noIMid] initSync\n[64]    0x20000944    .data      EXP     DS SECdef        [noIMid] getPropertyVa\nlue\n[65]    0x20000950    .data      EXP     DS SECdef        [noIMid] freePropertie\ns\n[66]    0x2000095c    .data      EXP     DS SECdef        [noIMid] describeError\n[67]    0x20000968    .data      EXP     DS SECdef        [noIMid] parseProperti\nes\n[68]    0x20000974    .data      EXP     DS SECdef        [noIMid] getSession\n[69]    0x20000980    .data      EXP     DS SECdef        [noIMid] addProperty\n[70]    0x2000098c    .data      EXP     DS SECdef        [noIMid] removePropert\nyByIndex\n[71]    0x20000998    .data      EXP     DS SECdef        [noIMid] removePropert\ny\n[72]    0x200009a4    .data      EXP     DS SECdef        [noIMid] setProperty\n[73]    0x200009b0    .data      EXP     DS SECdef        [noIMid] getPropertyVa\nlue3\n[74]    0x200009bc    .data      EXP     DS SECdef        [noIMid] getPropertyVa\nlue2\n[75]    0x200009c8    .data      EXP     DS SECdef        [noIMid] freePropertie\ns1\n[76]    0x200009d4    .data      EXP     DS SECdef        [noIMid] parseProperti\nes1\n[77]    0x200009e0    .data      EXP     DS SECdef        [noIMid] loadPropertie\ns1\n[78]    0x200009ec    .data      EXP     DS SECdef        [noIMid] loadPropertie\ns\n[79]    0x200009f8    .data      EXP     DS SECdef        [noIMid] getServerId\n[80]    0x20000a04    .data      EXP     DS SECdef        [noIMid] getNextBuddy\n[81]    0x20000a10    .data      EXP     DS SECdef        [noIMid] freeSync\n[82]    0x20000c78     .bss      EXP     RW    BSS        [noIMid] jrun_rootdir\n[83]    0x00000000    undef      IMP     DS EXTref              .. apr_palloc\n[84]    0x00000000    undef      IMP     DS EXTref              .. apr_table_add\n[85]    0x00000000    undef      IMP     DS EXTref              .. apr_table_set\n[86]    0x00000000    undef      IMP     DS EXTref              .. apr_pstrdup\n[87]    0x00000000    undef      IMP     DS EXTref              .. apr_table_get\n[88]    0x00000000    undef      IMP     DS EXTref              .. apr_pstrcat\n[89]    0x00000000    undef      IMP     DS EXTref              .. ap_hook_post_\nconfig\n[90]    0x00000000    undef      IMP     DS EXTref              .. ap_hook_child\n_init\n[91]    0x00000000    undef      IMP     DS EXTref              .. ap_hook_type_\nchecker\n[92]    0x00000000    undef      IMP     DS EXTref              .. ap_hook_handl\ner\n[93]    0x00000000    undef      IMP     DS EXTref              .. ap_run_http_m\nethod\n[94]    0x00000000    undef      IMP     DS EXTref              .. apr_table_elt\ns\n[95]    0x00000000    undef      IMP     DS EXTref              .. apr_table_set\nn\n[96]    0x00000000    undef      IMP     DS EXTref              .. apr_pool_clea\nnup_register\n\n\n--------------------------------------------------------------------------------\nHere is a result for dump -Hv /home/tfan/jrun4/lib/wsconfig/1/mod_jrun20.so:\n\n# dump -Hv /home/tfan/jrun4/lib/wsconfig/1/mod_jrun20.so\n\n/home/tfan/jrun4/lib/wsconfig/1/mod_jrun20.so:\n\n                        ***Loader Section***\n                      Loader Header Information\nVERSION#         #SYMtableENT     #RELOCent        LENidSTR\n0x00000001       0x00000061       0x00000149       0x00000038\n\n#IMPfilID        OFFidSTR         LENstrTBL        OFFstrTBL\n0x00000004       0x000018a4       0x00000470       0x000018dc\n\n\n                        ***Import File Strings***\nINDEX  PATH                          BASE                MEMBER\n0      /usr/lib/threads:/usr/lib:/lib\n1                                    libc.a              shr.o\n2                                    .\n3                                    .."}, {"attachment_id": null, "tags": [], "bug_id": 19012, "text": "dang it, I think it is a build problem related to the display issue you noted\nback at square one...  your DSO looks great\n\ntry this:\n\n$ cd /path/to/httpd-2.0.45\n$ grep HTTPD_LDFLAGS build/config_vars.mk\n\nI bet the output is simply\n\nHTTPD_LDFLAGS = \n\nwhen it should be something similar to \n\nHTTPD_LDFLAGS = -Wl,-uXML_Parse -Wl,-bE:/path/to/server/httpd.exp\n\nThe lack of the weird \"-Wl,-bE:\" option means that httpd doesn't export the\nApache API to DSOs, subsequently leading to DSOs failing to load.\n\nDepending on how mod_so gets enabled, the variable $enable_so may or may not get\nset, and if it isn't set then the right LDFLAGS for linking httpd don't get\ninitialized.\n\nIf you verify that HTTPD_LDFLAGS is an empty string, here is a work-around that\nworked for me:  Add \"--enable-so\" to your Apache configure invocation, as in\n\nmake distclean && ./configure --enable-so --other-opts && make && make install\n\nBy explicitly turning on mod_so (using the Apache 2 option this time :) ), we\navoid the bug.", "count": 7, "id": 35383, "time": "2003-04-16T22:47:07Z", "creator": "trawick@apache.org", "creation_time": "2003-04-16T22:47:07Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 19012, "text": "This has been fixed in 2.1-dev, and if nobody complains about the fix\nin the next few days I'll propose it for merging into 2.0.46-dev.\n\nUntil then, specify --enable-so.\n", "count": 8, "id": 35394, "time": "2003-04-17T02:46:18Z", "creator": "trawick@apache.org", "creation_time": "2003-04-17T02:46:18Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 19012, "text": "I recompiled as your suggection. \nafter that I check:\n1. config.log (I can see mod_so turned on YES)\n2. HTTPD_LDFLAGS = -Wl,-uXML_Parse -Wl,-bE:/path/to/server/httpd.exp\n3. httpd -l showed mod_so\n\nbut when I start up Aapche still got same error.\n# ./apachectl start\nSyntax error on line 1037 of /usr/local/apache2/conf/httpd.conf:\nCannot load /home/tfan/jrun4/lib/wsconfig/1/mod_jrun20.so into server: \n", "id": 35439, "time": "2003-04-17T16:13:08Z", "creator": "tfan@kronos.com", "creation_time": "2003-04-17T16:13:08Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "creator": "trawick@apache.org", "attachment_id": null, "id": 35442, "time": "2003-04-17T16:21:25Z", "bug_id": 19012, "creation_time": "2003-04-17T16:21:25Z", "is_private": false, "text": "plz send me off-line (trawick@apache.org) the output of\n\n dump -Tv /path/to/new/httpd\n\n(the one picked up by your still-failing ./apachectl start)\n"}, {"count": 11, "text": "ISTR hearing off-line that the Apache build was corrected with the --enable-so\nwork-around, and that further work was going to be done with the 3rd-party\nmodule build to see why it wasn't loading.\n\nRe-open the PR if there is still a problem with httpd not exporting symbols.\n", "bug_id": 19012, "is_private": false, "id": 38992, "time": "2003-06-18T02:32:47Z", "creator": "trawick@apache.org", "creation_time": "2003-06-18T02:32:47Z", "tags": [], "attachment_id": null}]