[{"count": 0, "tags": [], "creator": "nuxi@vault24.org", "text": "The current TLS SNI spec (RFC 6066) no longer recommends sending back a TLS warning if the name couldn't be found because this is being interpreted as a fatal error by many older SSL libraries with semi-broken SNI support.\n\n\"It is NOT RECOMMENDED to send a warning-level unrecognized_name(112) alert, because the client's behavior in response to warning-level alerts is unpredictable.\"\n\nI assume this is as simple as changing line 1943 of ssl_engine_kernel.c to say NOACK instead of WARNING:\n\nhttp://svn.apache.org/viewvc/httpd/httpd/trunk/modules/ssl/ssl_engine_kernel.c?view=markup#l1918\n\n\nThis is particularly noticeable if for some reason someone is using a short DNS name (eg https://issues/ instead of https://issues.apache.org/) with one of the broken SSL libraries that has semi-functional SNI support.", "id": 173729, "time": "2014-03-10T14:29:28Z", "bug_id": 56241, "creation_time": "2014-03-10T14:29:28Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 56241, "text": "(In reply to Jon from comment #0)\n> The current TLS SNI spec (RFC 6066) no longer recommends sending back a TLS\n> warning if the name couldn't be found because this is being interpreted as a\n> fatal error by many older SSL libraries with semi-broken SNI support.\n\nI agree that mod_ssl's current behavior still reflects RFC 4366. Specifically:\n\n   If the server understood the client hello extension but does not\n   recognize the server name, it SHOULD send an \"unrecognized_name\"\n   alert (which MAY be fatal).\n\nRFC 6066 has changed this to\n\n               If the server understood the ClientHello extension but\n   does not recognize the server name, the server SHOULD take one of two\n   actions: either abort the handshake by sending a fatal-level\n   unrecognized_name(112) alert or continue the handshake.  It is NOT\n   RECOMMENDED to send a warning-level unrecognized_name(112) alert,\n   because the client's behavior in response to warning-level alerts is\n   unpredictable.\n\nFor backward compatibility, I think we should take the second action (\"continue the handshake\"), i.e. return SSL_TLSEXT_ERR_NOACK as suggested.\n\n> I assume this is as simple as changing line 1943 of ssl_engine_kernel.c to\n> say NOACK instead of WARNING:\n\nWe can just drop line 1943, essentially, and fall through. Did you already test this with the SSL library which is causing problems for you?", "count": 1, "id": 174175, "time": "2014-03-30T09:57:40Z", "creator": "asfbugz@velox.ch", "creation_time": "2014-03-30T09:57:40Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 56241, "text": "(In reply to Kaspar Brand from comment #1)\n> > I assume this is as simple as changing line 1943 of ssl_engine_kernel.c to\n> > say NOACK instead of WARNING:\n> \n> We can just drop line 1943, essentially, and fall through. Did you already\n> test this with the SSL library which is causing problems for you?\n\nI've been running with the patch I described for about 2 weeks. It seems to fix interaction with openssl 0.9.8 (which OSX 10.9 has, wtf apple) and older versions of gnutls", "id": 174181, "attachment_id": null, "creator": "nuxi@vault24.org", "creation_time": "2014-03-30T20:24:41Z", "time": "2014-03-30T20:24:41Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 56241, "attachment_id": null, "id": 174305, "time": "2014-04-05T13:02:12Z", "creator": "asfbugz@velox.ch", "creation_time": "2014-04-05T13:02:12Z", "is_private": false, "text": "Thanks for the feedback. I have just committed this change to trunk, as part of r1585090. Will propose for backport unless there are objections on dev@httpd.apache.org."}, {"attachment_id": null, "tags": [], "bug_id": 56241, "text": "(In reply to Kaspar Brand from comment #3)\n> Will propose for backport\n\nDone with r1585922.", "count": 4, "id": 174399, "time": "2014-04-09T10:04:25Z", "creator": "asfbugz@velox.ch", "creation_time": "2014-04-09T10:04:25Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 56241, "text": "Committed to 2.4.x with r1588424. To appear in 2.4.10.", "id": 174691, "attachment_id": null, "creator": "asfbugz@velox.ch", "creation_time": "2014-04-18T08:37:48Z", "time": "2014-04-18T08:37:48Z", "is_private": false}, {"count": 6, "tags": [], "text": "What is the status of the backport to the 2.2 release?  We are using 2.2.27 with openssl 0.9.8za which is affected by this.  In particular, .NET and Java 7 clients fail to connect to recently updated servers.", "attachment_id": null, "id": 175912, "creation_time": "2014-06-19T17:15:14Z", "time": "2014-06-19T17:15:14Z", "creator": "steven.BUSH@3ds.com", "bug_id": 56241, "is_private": false}, {"count": 7, "tags": [], "bug_id": 56241, "text": "Backport to 2.2.x proposed in r1684336.", "id": 183377, "attachment_id": null, "creator": "ylavic.dev@gmail.com", "creation_time": "2015-06-09T09:01:31Z", "time": "2015-06-09T09:01:31Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 56241, "text": "Backported to upcoming 2.2.30 in r1684462.", "id": 183396, "time": "2015-06-09T16:15:21Z", "creator": "ylavic.dev@gmail.com", "creation_time": "2015-06-09T16:15:21Z", "is_private": false, "attachment_id": null}]