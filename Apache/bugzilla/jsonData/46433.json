[{"count": 0, "tags": [], "bug_id": 46433, "text": "I use following codes to read the formula in attached Excel: formula.xlsx. I found that except the first row, \"c.getCellFormula()\" return an empty string. In fact, other rows do contain formula.\n\n--\n\nXSSFWorkbook wb = new XSSFWorkbook(\"formula.xlsx\");\n\nFormulaEvaluator evaluator = wb.getCreationHelper().createFormulaEvaluator();\nfor(int sheetNum = 0; sheetNum < wb.getNumberOfSheets(); sheetNum++) {\n\tSheet sheet = wb.getSheetAt(sheetNum);\n\tfor(Row r : sheet) {\n\t\tfor(Cell c : r) {\n\t\t\tif(c.getCellType() == Cell.CELL_TYPE_FORMULA) {           \t\t\t\n\t\t\t\tSystem.out.println(\"c.getCellFormula():\" + c.getCellFormula());\n\t\t\t}\n\t\t}\n\t}\n}\n\n--\n\nPlease help. Thanks a lot!", "id": 123473, "time": "2008-12-22T02:02:03Z", "creator": "matthew.knl@gmail.com", "creation_time": "2008-12-22T02:02:03Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 46433, "attachment_id": 23046, "id": 123474, "creation_time": "2008-12-22T02:02:40Z", "time": "2008-12-22T02:02:40Z", "creator": "matthew.knl@gmail.com", "text": "Created attachment 23046\nformula.xlsx", "is_private": false}, {"count": 2, "tags": [], "bug_id": 46433, "attachment_id": null, "id": 123491, "creation_time": "2008-12-22T11:53:40Z", "time": "2008-12-22T11:53:40Z", "creator": "yegor@dinom.ru", "text": "Fixed in r728749. \n\nIn some cases Excel attempts to optimize pervasive formulas. Instead of storing similar formula value in each cell, Excel stores a \"master\" formula and use it as a template. Other cells refer to the master formula by index and convert it to non-shared formula on the fly.  \n\nThis support was missing and you got an empty string instead.\n\nYegor", "is_private": false}]