[{"count": 0, "tags": [], "text": "Tasks <apply> and <exec> do not work in OS/2. The reason is that the \"cd\"\ncommand does not recognize the \"/d\" switch an the working directory must be\nchanged in two steps, first the drive and second the directory. OS/2 does not\nallow to use netbios paths in form \\\\computer\\source\\some\\path, therefore I do\nnot check it. the problem is in main.org.apache.tools.ant.taskdefs.Execute, my\npatch (verified with Revision 1.43.2.5) is below:\n\n--- Execute.java.orig\tWed Oct  2 11:09:02 2002\n+++ Execute.java\tThu Feb  6 12:05:10 2003\n@@ -714,14 +714,26 @@\n \n             // Use cmd.exe to change to the specified directory before running\n             // the command\n-            final int preCmdLength = 6;\n+            int preCmdLength;\n+            if (Os.isFamily(\"os/2\")) preCmdLength = 7;\n+            else preCmdLength = 6;\n             String[] newcmd = new String[cmd.length + preCmdLength];\n             newcmd[0] = \"cmd\";\n             newcmd[1] = \"/c\";\n-            newcmd[2] = \"cd\";\n-            newcmd[3] = \"/d\";\n-            newcmd[4] = commandDir.getAbsolutePath();\n-            newcmd[5] = \"&&\";\n+            if (preCmdLength == 6) {   // Windows\n+                newcmd[2] = \"cd\";\n+                newcmd[3] = \"/d\";\n+                newcmd[4] = commandDir.getAbsolutePath();\n+                newcmd[5] = \"&&\";\n+            }\n+            else {   // OS/2 does not have /d switch in cd\n+                final String cmdDir = commandDir.getAbsolutePath();\n+                newcmd[2] = cmdDir.substring(0, 2);\n+                newcmd[3] = \"&&\";\n+                newcmd[4] = \"cd\";\n+                newcmd[5] = cmdDir.substring(2);\n+                newcmd[6] = \"&&\";\n+            }\n             System.arraycopy(cmd, 0, newcmd, preCmdLength, cmd.length);\n \n             return exec(project, newcmd, env);", "attachment_id": null, "id": 30991, "creator": "wagner@cesnet.cz", "time": "2003-02-10T10:06:42Z", "bug_id": 16924, "creation_time": "2003-02-10T10:06:42Z", "is_private": false}, {"count": 1, "tags": [], "text": "I don't thnik anybody of us is using OS/2, having somebody actually test our\n(naive) assumptions is great.\n\nI'll take care of this.", "is_private": false, "id": 31054, "creator": "bodewig@apache.org", "time": "2003-02-11T09:52:20Z", "bug_id": 16924, "creation_time": "2003-02-11T09:52:20Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "text": "Could you please try a nightly build of 2003-02-12 or later to confirm the bug is\nfixed?  I've taken a slightly different approach.\n\nIf everything works for you I'm going to merge the change into Ant 1.5.2.\n\nCould you please also confirm that <property environment=\"env\"/> works on\nOS/2 - I'd like to remove the \"// Not sure\" from\n\n        if (Os.isFamily(\"os/2\")) {\n            // OS/2 - use same mechanism as Windows 2000\n            // Not sure\n            String[] cmd = {\"cmd\", \"/c\", \"set\" };\n", "id": 31056, "time": "2003-02-11T10:10:29Z", "bug_id": 16924, "creation_time": "2003-02-11T10:10:29Z", "is_private": false}, {"count": 3, "tags": [], "creator": "conor@apache.org", "attachment_id": null, "text": "Please test and reopen if this needs more work - thanks", "id": 31395, "time": "2003-02-17T03:05:58Z", "bug_id": 16924, "creation_time": "2003-02-17T03:05:58Z", "is_private": false}]