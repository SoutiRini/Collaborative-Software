[{"count": 0, "tags": [], "bug_id": 39300, "attachment_id": null, "text": "In ant.bat there is used\n\n%ANT_ARGS% -cp \"%CLASSPATH%\" %ANT_CMD_LINE_ARGS%\n\nin the \"targets\" :runAntWithClasspath and :runAntWithJikesAndClasspath.\nThe problem is, if %CLASSPATH% has a '\\' as last character, this escapes the \nquotation mark in the commandline, so any following %ANT_CMD_LINE_ARGS% \nare \"ignored\" because they count as part of the classpath.\n\nSolution:\nChange the order to:\n%ANT_ARGS% %ANT_CMD_LINE_ARGS% -cp \"%CLASSPATH%\"\nSo the classpath is the last element on the commanline and therefor may span \nuntil the end.", "id": 87906, "time": "2006-04-13T14:08:47Z", "creator": "Vampire@Masters-of-Disaster.de", "creation_time": "2006-04-13T14:08:47Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 39300, "attachment_id": null, "text": "*** Bug 39301 has been marked as a duplicate of this bug. ***", "id": 87912, "time": "2006-04-13T14:22:25Z", "creator": "carej@us.ibm.com", "creation_time": "2006-04-13T14:22:25Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 39300, "attachment_id": null, "text": "Have you tried with svn HEAD Ant?  I thought I recalled some trailing-quote\nrelated changes to the wrapper scripts.", "id": 87914, "time": "2006-04-13T14:47:53Z", "creator": "mbenson@apache.org", "creation_time": "2006-04-13T14:47:53Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 39300, "attachment_id": null, "text": "No, I didn't try, but as far as I can see, there the problem shouldn't happen\nanymore that command-line-args are eaten by the classpath, but only because it\nis impossible to reach :runAntWithClasspath or :runAntWithJikesAndClasspath\nwhere the error occurs in the current ant.bat, which is another, new introduced,\nbug.\n\n[quote]\n:runAnt\nif \"%_USE_CLASSPATH%\"==\"no\" goto runAntNoClasspath\n\n:runAntNoClasspath\n\"%_JAVACMD%\" %ANT_OPTS% -classpath \"%ANT_HOME%\\lib\\ant-launcher.jar\"\n\"-Dant.home=%ANT_HOME%\" org.apache.tools.ant.launch.Launcher %ANT_ARGS%\n%ANT_CMD_LINE_ARGS%\nrem Check the error code of the Ant build\nif not \"%OS%\"==\"Windows_NT\" goto onError\nset ANT_ERROR=%ERRORLEVEL%\ngoto end\n\n:runAntWithClasspath\n\"%_JAVACMD%\" %ANT_OPTS% -classpath \"%ANT_HOME%\\lib\\ant-launcher.jar\"\n\"-Dant.home=%ANT_HOME%\" org.apache.tools.ant.launch.Launcher %ANT_ARGS% -cp\n\"%CLASSPATH%\" %ANT_CMD_LINE_ARGS%\nrem Check the error code of the Ant build\nif not \"%OS%\"==\"Windows_NT\" goto onError\nset ANT_ERROR=%ERRORLEVEL%\ngoto end\n[/quote]\n\nif \"%_USE_CLASSPATH%\"==\"no\" goto runAntNoClasspath\njumps to :runAntNoClasspath, ok, but if \"%_USE_CLASSPATH%\"==\"yes\" then it just\ngoes on to the next line which is also :runAntNoClasspath.\nSame goes for the Jikes-variants", "id": 87921, "time": "2006-04-13T16:09:40Z", "creator": "Vampire@Masters-of-Disaster.de", "creation_time": "2006-04-13T16:09:40Z", "is_private": false}, {"count": 4, "text": "I was unable to post my followup comment when bugzilla was undergoing\nmaintenance.  Of course I meant trailing backslashes, not quotes, and the\nchanges I had been thinking of were related to the \"ant\" script.  This means\nthat until the problems you have noted in ant.bat are fixed, running \"ant\" under\ncygwin might represent a workaround for you.\n\nbr,\nMatt", "bug_id": 39300, "is_private": false, "id": 87925, "time": "2006-04-13T17:23:48Z", "creator": "mbenson@apache.org", "creation_time": "2006-04-13T17:23:48Z", "tags": [], "attachment_id": null}, {"count": 5, "tags": [], "creator": "Vampire@Masters-of-Disaster.de", "text": "Thanks, I don't need a workaround. I fixed it in my local copy how I described\nhere and it works just fine.", "id": 88077, "time": "2006-04-14T15:51:53Z", "bug_id": 39300, "creation_time": "2006-04-14T15:51:53Z", "is_private": false, "attachment_id": null}, {"count": 6, "text": "and your suggested workaround works for Ant invocations specifying a target to\nrun?  e.g.:\n\nant foo\n\ninstead of simply:\n\nant\n\n?", "bug_id": 39300, "is_private": false, "id": 88764, "time": "2006-05-03T16:42:06Z", "creator": "mbenson@apache.org", "creation_time": "2006-05-03T16:42:06Z", "tags": [], "attachment_id": null}, {"count": 7, "tags": [], "creator": "mbenson@apache.org", "attachment_id": null, "id": 88765, "time": "2006-05-03T16:43:45Z", "bug_id": 39300, "creation_time": "2006-05-03T16:43:45Z", "is_private": false, "text": "Never mind; I see this looks okay, esp. for this arg which is pulled away by the\nlauncher anyway."}, {"count": 8, "text": "added spinoff bug 39475 to document the problem with classpaths in HEAD.  Thanks.", "bug_id": 39300, "is_private": false, "id": 88774, "time": "2006-05-03T19:01:36Z", "creator": "mbenson@apache.org", "creation_time": "2006-05-03T19:01:36Z", "tags": [], "attachment_id": null}, {"count": 9, "tags": [], "creator": "mbenson@apache.org", "attachment_id": null, "id": 88776, "time": "2006-05-03T19:11:36Z", "bug_id": 39300, "creation_time": "2006-05-03T19:11:36Z", "is_private": false, "text": "The suggested fix seemed pretty hacky to me.  Changed ant.bat to trim trailing\nbackslashes.  The only documentation I could find suggested that this syntax was\navailable on win98, but I can't verify ATM.  I would personally be satisfied to\nconditionally execute these tests only on NT families if it can be demonstrated\nthat this does not work on 98."}]