[{"count": 0, "tags": [], "creator": "ptorrodellas@fihoca.com", "attachment_id": null, "id": 146102, "time": "2011-05-04T09:40:04Z", "bug_id": 51148, "creation_time": "2011-05-04T09:40:04Z", "is_private": false, "text": "XWPFDocument.removeBodyElement(int pos) throws IndexOutOfBoundsException whatever the value of the element index.\n\nI think that this is caused by two XWPFDocument class code errors:\n\n1 - In removeBodyElement(int pos), the statement:\n\nbodyElements.remove(pos);\n\nshould be placed AFTER the statements:\n\nInteger tablePos = getTablePos(pos); \n\nand\n\nInteger paraPos = getParagraphPos(pos);\n\ninstead of before, otherwise the element is not there in the bodyElements List to be used to locate it in the paragraphs or tables Lists.\n\n2 - In getParagraphPos(int pos) and getTablePos(int pos), the for loop should be:\nfor(int i = startPos; i >= 0; i--) {\n....\n}"}, {"count": 1, "text": "Good spot. I've cleaned up the code a bit (the table/paragraph code is now generic), and added a bunch of unit tests for it. Fixed in r1100027.", "bug_id": 51148, "attachment_id": null, "id": 146150, "time": "2011-05-06T02:14:48Z", "creator": "apache@gagravarr.org", "creation_time": "2011-05-06T02:14:48Z", "tags": [], "is_private": false}]