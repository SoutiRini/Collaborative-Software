[{"text": "JSR233 proposes Compilable interface and many ScriptEngine implement it\n\nI think we should improve this part by doing something like that:\n- We could compile script code\n- then cache it (which key to use ? add a new property ? use Sampler Name ? use file script name ? use a hash of Script code ?)\n\nI tested this approach:\n- It fixes the memory leak issue\n- It gives fabulous performance enhancements\n\nBut doing so means script code must not contains variables which would forbid caching the compiled code unless we hash script code to see if it changes but this will introduce a performance issue on this hashing.\n\n[reply] [-] Comment 5 Sebb 2012-06-30 08:58:13 UTC\n\nThe scripting elements were intended mainly for prototyping and ad-hoc testing; the intention being that the script would often be turned into a Java class if necessary for performance. So performance and memory consumption are not as important as for the Java classes.\n\nThat's not to say that improvements aren't useful, but such improvements must not affect backwards compatibility; in particular variables must be supported as before.\n\nThe JSR223 test elements support reading the script from a file, and parameters can be passed to the file, so one way to improve performance without affecting compatibility would be to cache the compiled form of a file using the key of file name+modification time.\n\nThe same could apply to the ScriptEngineManager: cache that if using a file.\n\nThis would guarantee compatibility, and probably not be too difficult to implement, nor be difficult for users to convert their test elements.", "tags": [], "bug_id": 53520, "attachment_id": null, "count": 0, "id": 160493, "time": "2012-07-07T22:35:49Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2012-07-07T22:35:49Z", "is_private": false}, {"text": "Date: Sun Jul  8 20:27:52 2012\nNew Revision: 1358829\n\nURL: http://svn.apache.org/viewvc?rev=1358829&view=rev\nLog:\nBug 53520 - JSR223 Elements : Use Compilable interface to improve performances on File scripts\nBugzilla Id: 53520\n\nModified:\n    jmeter/trunk/src/components/org/apache/jmeter/assertions/JSR223Assertion.java\n    jmeter/trunk/src/components/org/apache/jmeter/extractor/JSR223PostProcessor.java\n    jmeter/trunk/src/components/org/apache/jmeter/modifiers/JSR223PreProcessor.java\n    jmeter/trunk/src/components/org/apache/jmeter/timers/JSR223Timer.java\n    jmeter/trunk/src/components/org/apache/jmeter/visualizers/JSR223Listener.java\n    jmeter/trunk/src/core/org/apache/jmeter/util/JSR223TestElement.java\n    jmeter/trunk/src/protocol/java/org/apache/jmeter/protocol/java/sampler/JSR223Sampler.java\n    jmeter/trunk/xdocs/changes.xml", "tags": [], "bug_id": 53520, "attachment_id": null, "count": 1, "id": 160511, "time": "2012-07-08T20:28:48Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2012-07-08T20:28:48Z", "is_private": false}, {"count": 2, "attachment_id": 29040, "creator": "p.mouawad@ubik-ingenierie.com", "text": "Created attachment 29040\nTest plan used for bench", "id": 160514, "time": "2012-07-08T20:46:40Z", "bug_id": 53520, "creation_time": "2012-07-08T20:46:40Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 53520, "text": "Results of Test plan run on my Computer:\n- JMeter 2.8 before this feature: Throughput => 75 samples/sec\n- JMeter 2.8 with this feature : Throughput => 253 samples/sec", "id": 160515, "time": "2012-07-08T20:48:26Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2012-07-08T20:48:26Z", "is_private": false, "attachment_id": null}, {"text": "Date: Sun Jul  8 20:50:40 2012\nNew Revision: 1358831\n\nURL: http://svn.apache.org/viewvc?rev=1358831&view=rev\nLog:\nBug 53520 - JSR223 Elements : Use Compilable interface to improve performances on File scripts\nBugzilla Id: 53520\n\nModified:\n    jmeter/trunk/bin/jmeter.properties", "tags": [], "bug_id": 53520, "is_private": false, "count": 4, "id": 160516, "time": "2012-07-08T20:51:57Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2012-07-08T20:51:57Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 53520, "text": "Date: Sun Jul  8 21:02:58 2012\nNew Revision: 1358835\n\nURL: http://svn.apache.org/viewvc?rev=1358835&view=rev\nLog:\nBug 53520 - JSR223 Elements : Use Compilable interface to improve performances on File scripts\nBugzilla Id: 53520\n\nModified:\n    jmeter/trunk/xdocs/usermanual/component_reference.xml", "id": 160517, "time": "2012-07-08T21:05:06Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2012-07-08T21:05:06Z", "is_private": false, "attachment_id": null}]