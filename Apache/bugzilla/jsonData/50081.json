[{"count": 0, "tags": [], "creator": "kirill.balod@gmail.com", "text": "If path for signing jar look like c:\\aaa\\..\\bbb\\my.jar and not destDir nor destFile are defined sign procedure finish with error:\njzfile = 43261776,\ntotal = 5, \nname = c:\\bbb\\my.jar\\com.borland.orbit_8.2.3.v20101012-1621.jar,\ni = 1, \nmessage = couldn't read LOC header\nat java.util.zip.ZipFile$3.nextElement(ZipFile.java:429)\nat java.util.zip.ZipFile$3.nextElement(ZipFile.java:415)\nat sun.security.tools.JarSigner.getManifestFile(JarSigner.java:1449)\nat sun.security.tools.JarSigner.signJar(JarSigner.java:836)\nat sun.security.tools.JarSigner.run(JarSigner.java:194)\nat sun.security.tools.JarSigner.main(JarSigner.java:75)\n\nIt happened because in SignJar.signOneJar(File jarSource, File jarTarget) \njarSource = c:\\aaa\\..\\bbb\\my.jar\njarTarget = c:\\bbb\\my.jar\nIt points on the same file but !jarSource.equals(targetFile)\nSo code add \"-signedjar\" argument in command call but should not.\n\nSignJar.signOneJar:377\n        //DO NOT SET THE -signedjar OPTION if source==dest\n        //unless you like fielding hotspot crash reports\n        if (!jarSource.equals(targetFile)) {\n            addValue(cmd, \"-signedjar\");\n            addValue(cmd, targetFile.getPath());\n        }", "id": 140695, "time": "2010-10-12T08:49:17Z", "bug_id": 50081, "creation_time": "2010-10-12T08:49:17Z", "is_private": false, "attachment_id": null}, {"count": 1, "attachment_id": null, "creator": "bodewig@apache.org", "text": "Kiril, are you using the task from an ant build file or via its Java API.\n\nWhen usied from the Ant API, the \"jarSource\" should have been \"normalized\" by\nAnt and shpuld not contain any relative path remainders anymore.", "id": 140929, "time": "2010-10-22T10:09:48Z", "bug_id": 50081, "creation_time": "2010-10-22T10:09:48Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "text": "I'm sorry. I thought about it just after submitting this bug.\nIt is used via Java API in Eclipse PDE build.\nI will submit bug in Eclipse bugzilla.", "is_private": false, "id": 140930, "creator": "kirill.balod@gmail.com", "time": "2010-10-22T10:14:31Z", "bug_id": 50081, "creation_time": "2010-10-22T10:14:31Z", "attachment_id": null}, {"count": 3, "attachment_id": null, "creator": "bodewig@apache.org", "is_private": false, "id": 140933, "time": "2010-10-22T10:46:37Z", "bug_id": 50081, "creation_time": "2010-10-22T10:46:37Z", "tags": [], "text": "Opening a bug report with Eclipse is fine, but then again we are providing\nthe task with a public API and so should be more defensive about the paths.\n\nI'll get this fixed inside of Ant (as well - if the Eclipse people\ncould fix their side, it would benefit users of released versions of\nAnt)."}, {"count": 4, "tags": [], "creator": "bodewig@apache.org", "text": "svn revision 1026982", "id": 140982, "time": "2010-10-25T05:10:45Z", "bug_id": 50081, "creation_time": "2010-10-25T05:10:45Z", "is_private": false, "attachment_id": null}]