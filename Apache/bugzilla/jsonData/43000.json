[{"count": 0, "tags": [], "text": "./configure\n...\nmake test\n...\ntestpipe            : SUCCESS\ntestpoll            : FAILED 1 of 13\ntestpools           : SUCCESS\ntestproc            : SUCCESS\ntestprocmutex       : SUCCESS\ntestrand            : SUCCESS\ntestrand2           : SUCCESS\ntestsleep           : SUCCESS\ntestshm             : SUCCESS\ntestsock            : SUCCESS\ntestsockets         : -\n\non testsockets test always freeze...\nOS: SunOS snake.sysdev.ru 5.10 Generic_125101-10 i86pc i386 i86pc\nCC: any (gcc, Sun Studio 11, SunStudio 12)\n\nAnd if i using tomcat-native, servlet thread always freeze at 20-30 read from \nany socket.", "is_private": false, "bug_id": 43000, "id": 106058, "time": "2007-07-30T08:53:45Z", "creator": "a.rymonin@gmail.com", "creation_time": "2007-07-30T08:53:45Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 43000, "is_private": false, "text": "I can't reproduce this problem this problem. Could you try to isolate which\ntest is freezing? A truss output might help too.\n", "id": 106354, "time": "2007-08-04T16:10:04Z", "creator": "davi@apache.org", "creation_time": "2007-08-04T16:10:04Z", "attachment_id": null}, {"count": 2, "tags": [], "text": "If i using version from svn, testall not freeze at testsockets, but give two \nerror: one on testpoll and one on testsockets...\nIf i using CFLAGS=\"-fprofile-arcs -ftest-coverage\" ./configure, build process \nSIGFALS...\nhow i can get more information for you?", "is_private": false, "id": 106495, "creator": "a.rymonin@gmail.com", "time": "2007-08-08T13:08:13Z", "bug_id": 43000, "creation_time": "2007-08-08T13:08:13Z", "attachment_id": null}, {"count": 3, "attachment_id": null, "bug_id": 43000, "is_private": false, "id": 106505, "time": "2007-08-08T14:43:20Z", "creator": "davi@apache.org", "creation_time": "2007-08-08T14:43:20Z", "tags": [], "text": "(In reply to comment #2)\n> If i using version from svn, testall not freeze at testsockets, but give two \n> error: one on testpoll and one on testsockets...\n\nI see them on trunk (svn HEAD) too, i'll take a closer look them later.\n\n> If i using CFLAGS=\"-fprofile-arcs -ftest-coverage\" ./configure, build process \n> SIGFALS...\n> how i can get more information for you?\n\nWhich version were you using before? (frozen testsockets)\n"}, {"count": 4, "tags": [], "text": "> Which version were you using before? (frozen testsockets)\n\nIn 1.2.8 and 1.2.9 versions i have frozen testsockets....\nIn 1.2.2 (i get source from www.sunfreeware.com) on testsockets SEGFAULS...\n", "is_private": false, "bug_id": 43000, "id": 106515, "time": "2007-08-08T22:49:36Z", "creator": "a.rymonin@gmail.com", "creation_time": "2007-08-08T22:49:36Z", "attachment_id": null}, {"count": 5, "tags": [], "text": "(In reply to comment #4)\nI came across what appears to be the same problem on Solaris 10 x86 (and also\nTru64 5.1B) and resolved it by configuring IPv6. Hopefully this is useful.\n\nWith APR 1.2.9 the hang is in sendto_receivefrom (testsockets.c). It first\ncreates two IPv6 datagram sockets, which succeeds as the kernel supports IPv6.\nIt then tries to bind them to addresses, which fails as IPv6 is not configured\non the machine. It then sends a message on one socket and waits to read it from\nthe other. As the addressing was not correctly set up it waits forever trying to\nreceive it.\n\nThe output of \"./testall -v testsockets\" was useful:\ntestsockets         : -Line 148: expected <0>, but saw <126>\nLine 148 of testsockets.c is where it compares the return value of\napr_socket_bind() to APR_SUCCESS. The call failed and returned EADDRNOTAVAIL (A\nbind() operation was attempted for an address that is not configured on this\nmachine.)\n\nWith a more recent APR (I used the apr_20070817101928.tar.gz snapshot) the test\nfails rather than hangs because the sendto_receivefrom_helper() function in\ntestsockets.c returns if the call to apr_socket_bind() fails.\n\nTo resolve this issue IPv6 must be configured. This might be as simple as\ncreating an empty file named /etc/hostname6.<interface> and rebooting\n(<interface> is the name of your interface - \"/usr/sbin/ifconfig -a\" should give\nyou a hint). It worked for me.\n\nCheers,\nSteve", "is_private": false, "bug_id": 43000, "id": 106853, "time": "2007-08-17T06:39:05Z", "creator": "steven.nairn@kewill.com", "creation_time": "2007-08-17T06:39:05Z", "attachment_id": null}, {"count": 6, "tags": [], "text": "(In reply to comment #5)\n> (In reply to comment #4)\n> I came across what appears to be the same problem on Solaris 10 x86 (and also\n> Tru64 5.1B) and resolved it by configuring IPv6. Hopefully this is useful.\n\nThank you very much, with sockets now everything is all right. But also i have \none failed at testpoll\n\n[root@snake test]# ./testall -v testpoll\ntestpoll            : /Line 315: expected <5>, but saw <4>\nFAILED 1 of 19\nFailed Tests            Total   Fail    Failed %\n===================================================\ntestpoll                   19      1      5.26%\n\nIt's important error? \n", "is_private": false, "bug_id": 43000, "id": 106893, "time": "2007-08-19T02:21:01Z", "creator": "a.rymonin@gmail.com", "creation_time": "2007-08-19T02:21:01Z", "attachment_id": null}, {"count": 7, "tags": [], "text": "I *believe* that's the same optimization bug as on other platforms such as\nWindows, where two faces (in/out) of the same socket fd are compressed into\none poll event entry.  You would have to singlestep the test to be certain.", "is_private": false, "id": 107276, "creator": "wrowe@apache.org", "time": "2007-08-26T23:12:20Z", "bug_id": 43000, "creation_time": "2007-08-26T23:12:20Z", "attachment_id": null}, {"count": 8, "attachment_id": 21136, "bug_id": 43000, "is_private": false, "id": 110623, "time": "2007-11-15T17:58:24Z", "creator": "henryjen@ztune.net", "creation_time": "2007-11-15T17:58:24Z", "tags": [], "text": "Created attachment 21136\nFix for port.c bugs on Solaris\n\nA couple issues in the port.c implementation for Solaris:\n\n1. When calling port_dissociate with a file descriptor has not been associated,\nport_dissociate will return -1 and set errno to ENOENT.\n\nPer the man page for port_dissociate:\n> The port_dissociate() function will fail if:\n>\n>      EACCES\t The process is not the owner of the association.\n>\n>\n>      ENOENT\t The specified object is not  associated  with\tthe\n>\t\t port.\n\n2. The apr_pollcb_poll should also re-associate the fd with port. Per the man\npage:\n\n> When an event for a PORT_SOURCE_FD object is retrieved,  the\n> object  no  longer  has  an  association with the port.  The\n> event can be processed without the possibility that  another\n> thread  can retrieve a subsequent event for the same object.\n> After processing of the file descriptor  is  completed,  the\n> port_associate()  function  can be called to reassociate the\n> object with the port.\n\n3. POLLIN Event is generated at the time port_associate is called and at most\none event can be generated, and that causes testpoll to fail. Per the man page\nof port_associate:\n\n> Objects of type PORT_SOURCE_FD  are  file  descriptors.  The\n> event  types\tfor  PORT_SOURCE_FD  objects  are described in\n> poll(2).  At most one event notification will  be  generated\n> per  associated  file  descriptor.   For  example, if a file\n> descriptor is associated with  a  port  for  the  POLLRDNORM\n> event  and  data  is available on the file descriptor at the\n> time the port_associate() function is called,  an  event  is\n> immediately  sent to the port. If data is not yet available,\n> one event is sent to the port when data first becomes avail-\n> able.\n\nThis explains the first event only has POLLOUT flagged, as sendto is\ncalled after port_associate. Attached patch basically minimize the timing\nwindow to make a port_associate before someone is trying to retrieve events\nfrom the\nport."}, {"count": 9, "attachment_id": null, "creator": "nick@webthing.com", "text": "Fixed 6 months ago in r672345.", "id": 123853, "time": "2009-01-07T18:48:07Z", "bug_id": 43000, "creation_time": "2009-01-07T18:48:07Z", "tags": [], "is_private": false}, {"count": 10, "tags": [], "bug_id": 43000, "text": "(In reply to comment #9)\n> Fixed 6 months ago in r672345\n> \n\nAre you sure that r672345 is about this bug here? The patch in comment 8 is entirely different.", "id": 123855, "time": "2009-01-07T23:27:40Z", "creator": "rpluem@apache.org", "creation_time": "2009-01-07T23:27:40Z", "is_private": false, "attachment_id": null}]