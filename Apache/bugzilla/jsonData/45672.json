[{"count": 0, "tags": [], "bug_id": 45672, "attachment_id": 22473, "text": "Created attachment 22473\nSpreadsheet containing issue\n\nI'm trying to convert a Excel spreadsheet to CSV based on something similar to the example XLS2CSVmra.java.\n\nThis is using the Event API.  For some reason on certain rows of my spreadsheet I get multiple LastCellOfRowDummyRecord records per row.  These happen at different points doing the processing of the row.  \nFor example row 16 returns LastCellOfRowDummyRecord after processing column 12, column 18 and column 31.\n\nProblem Spreadsheet attached.\n\nTested in 3.1 and 3.5 beta 1", "id": 120025, "time": "2008-08-22T06:33:22Z", "creator": "IBeaumont@categoric.com", "creation_time": "2008-08-22T06:33:22Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 45672, "text": "Created attachment 22475\nSpreadsheet containing issue\n\nThis is a smaller/simpler spreadsheet showing the problem", "id": 120038, "time": "2008-08-22T09:38:50Z", "creator": "IBeaumont@categoric.com", "creation_time": "2008-08-22T09:38:50Z", "is_private": false, "attachment_id": 22475}, {"count": 2, "tags": [], "bug_id": 45672, "attachment_id": 22476, "id": 120039, "time": "2008-08-22T09:46:48Z", "creator": "IBeaumont@categoric.com", "creation_time": "2008-08-22T09:46:48Z", "is_private": false, "text": "Created attachment 22476\nProposed patch to fix issue\n\nOn investigating the problem it seems that the issue is because the spreadsheet contains SharedFormulaRecord and the MissingRecordAwareHSSFListener seems to generate a LastCellOfRowDummyRecord for the row every time it hits one of these records.\n\nI've included a patch which updates the MissingRecordAwareHSSFListener to ignore any SharedFormulaRecord and this seems to fix the issue and the spreadsheet is now processed correctly.  However I don't have a great understanding of POI so whether what I've done is valid I'm not sure.  Certainly has fixed my issue."}, {"count": 3, "tags": [], "creator": "josh@apache.org", "text": "I think it is not quite correct to completely ignore the SharedFormulaRecord.\n\nApplied patch with some simplifications in svn r688426\n\nAdded junit", "id": 120051, "time": "2008-08-23T15:58:01Z", "bug_id": 45672, "creation_time": "2008-08-23T15:58:01Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 45672, "text": "I am using the XLS2CSVmra example with POI 3.5beta5 and today I hit a XLS (2003 format) spreadsheet that triggers this exact problem.  The sheet is very wide but only has 2 rows.  The first row has headers and is read/reported perfectly.  The second row has data and becomes *9* rows in the output.  I am using Excel to look at the data in the cells that become the last item in the output.  One is a date, one is a number stored as a string; neither appears to be a formula.  Right now the data is proprietary so I cannot upload it.  I am happy to investigate further, like using the debugger, but don't know what evidence you need.", "id": 127566, "time": "2009-06-02T12:33:39Z", "creator": "apache7@chris-lott.org", "creation_time": "2009-06-02T12:33:39Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 45672, "attachment_id": null, "text": "Hello.  I noticed Chris's earlier note to the user mailing list and then followed the bug here.  I'm seeing the same issue.  I attached a .java and a trace of the program as applied to Chris's sample .xls file to that message.", "id": 127568, "time": "2009-06-02T15:48:38Z", "creator": "pingel@gmail.com", "creation_time": "2009-06-02T15:48:38Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 45672, "is_private": false, "count": 6, "id": 127569, "time": "2009-06-02T16:03:38Z", "creator": "dfisher@jmlafferty.com", "creation_time": "2009-06-02T16:03:38Z", "text": "Hi Adam,\n\nThanks. If possible, try a recent nightly build first.\n\nBTW - your attachments didn't make it through to the list with your email. Please attach the files to this issue. Hopefully someone will look into it in the near future.\n\nRegards,\nDave"}, {"count": 7, "tags": [], "bug_id": 45672, "text": "I tried again with poi-3.5-beta7-20090602.jar and poi-ooxml-3.5-beta7-20090602.jar.  I will attach my .java and the resulting log.", "id": 127570, "time": "2009-06-02T17:15:51Z", "creator": "pingel@gmail.com", "creation_time": "2009-06-02T17:15:51Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "creator": "pingel@gmail.com", "attachment_id": 23744, "id": 127571, "time": "2009-06-02T17:18:06Z", "bug_id": 45672, "creation_time": "2009-06-02T17:18:06Z", "is_private": false, "text": "Created attachment 23744\nexecution trace of my code applied to Chris's .xls file"}, {"attachment_id": 23745, "tags": [], "bug_id": 45672, "is_private": false, "count": 9, "id": 127572, "time": "2009-06-02T17:19:22Z", "creator": "pingel@gmail.com", "creation_time": "2009-06-02T17:19:22Z", "text": "Created attachment 23745\na reworked XLS2CSVmra that I'm using to create the trace"}, {"count": 10, "tags": [], "creator": "apache7@chris-lott.org", "attachment_id": null, "id": 128172, "time": "2009-06-23T04:58:01Z", "bug_id": 45672, "creation_time": "2009-06-23T04:58:01Z", "is_private": false, "text": "I reopened this bug -- I hope that's acceptable to the POI committers.  Adam and I have provided fairly convincing evidence and attached it to this bug report.  I hope this isn't too hard to fix, and that maybe the fix will be delivered in time for the 3.5 final release.  Thanks for listening."}, {"attachment_id": null, "tags": [], "bug_id": 45672, "is_private": false, "count": 11, "id": 131217, "time": "2009-10-19T07:16:43Z", "creator": "kirklib@gmail.com", "creation_time": "2009-10-19T07:16:43Z", "text": "Was very happy to discover this library, and then quickly disappointed by this bug which is a fairly essential necessity for such a program.\n\nI have detailed the problem I have on the mailing list:\nhttp://www.nabble.com/XLS-to-Tab-delimited-getting-extra-new-lines-to25931161.html#a25935746\n\nAn event is thrown signalling the end of a row whenever it encounters various blank cells in my data."}, {"count": 12, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 131642, "time": "2009-11-03T14:48:43Z", "bug_id": 45672, "creation_time": "2009-11-03T14:48:43Z", "is_private": false, "text": "Ah, I'd forgotten that you can have records that cover multiple cells (MulBlankRecord and MulRKRecord). MissingRecordAwareHSSFListener wasn't handling these properly, and probably nor was anyone's code...\n\nI've updated MissingRecordAwareHSSFListener to expand these out into individual records, so hopefully it'll behave itself better now"}, {"count": 13, "text": "Created attachment 24504\nTwo-row spreadsheet that triggers LsatCellOfDummyRowRec failure\n\nI sent this spreadsheet to Adam Pingel but forgot to attach it to this bug.  Running XLS2CSVmra + POI 3.5 FINAL on this input yields 3 rows (expected 2).", "bug_id": 45672, "is_private": false, "id": 131794, "time": "2009-11-08T06:45:06Z", "creator": "apache7@chris-lott.org", "creation_time": "2009-11-08T06:45:06Z", "tags": [], "attachment_id": 24504}, {"count": 14, "tags": [], "bug_id": 45672, "text": "Nick Burch, thank you very much for the patch.  It works for me!  I tested the nightly build POI-3.6-beta1-20091108.jar from encore.torchbox.com together with the XLS2CSVmra program on the two-row spreadsheet that is attached to this bug.  The failure no longer happens.  POI 3.5 final yields 3 rows, POI 3.6 beta yields 2 rows, which is what I expect.", "id": 131795, "time": "2009-11-08T06:48:52Z", "creator": "apache7@chris-lott.org", "creation_time": "2009-11-08T06:48:52Z", "is_private": false, "attachment_id": null}]