[{"count": 0, "tags": [], "text": "Created attachment 29885\nZip file with updated class and Excel sample template\n\nHi all,\n\nWith version 3.9 (and older versions) it is not possible to rename a sheet which contains some graphs, and it is also not possible to copy graphs while cloning a sheet.\n\nI have amended the POI api to support Graph while cloning sheet and also while renaming sheet.\n\nBelow the solution I have implemented (note that I am not experienced with the POI api, so it might be possible to perform the same operation in a more official way).\n\nI hope it will be usefull...\n\nRegards,\nGuillaume", "is_private": false, "id": 164813, "creator": "gdegentile@finbox-solutions.com", "time": "2013-01-22T22:24:11Z", "bug_id": 54470, "creation_time": "2013-01-22T22:24:11Z", "attachment_id": 29885}, {"count": 1, "tags": [], "bug_id": 54470, "text": "*** Bug 47352 has been marked as a duplicate of this bug. ***", "id": 181883, "time": "2015-03-18T20:20:36Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-03-18T20:20:36Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 54470, "is_private": false, "count": 2, "id": 181887, "time": "2015-03-18T20:26:42Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-03-18T20:26:42Z", "text": "*** Bug 57712 has been marked as a duplicate of this bug. ***"}, {"count": 3, "tags": [], "bug_id": 54470, "attachment_id": null, "text": "(In reply to Guillaume de GENTILE from comment #0)\n> Created attachment 29885 [details]\n> Zip file with updated class and Excel sample template\n> \n> Hi all,\n> \n> With version 3.9 (and older versions) it is not possible to rename a sheet\n> which contains some graphs, and it is also not possible to copy graphs while\n> cloning a sheet.\n> \n> I have amended the POI api to support Graph while cloning sheet and also\n> while renaming sheet.\n> \n> Below the solution I have implemented (note that I am not experienced with\n> the POI api, so it might be possible to perform the same operation in a more\n> official way).\n> \n> I hope it will be usefull...\n> \n> Regards,\n> Guillaume\n\nAwesome code~!\n\nI'm attempting to copy chart objects from one workbook to another.\nIf I manage to clone both the CTChart and the CTChartSpace objects?\n\nBest regards,\nNovak", "id": 181904, "time": "2015-03-19T10:49:34Z", "creator": "sebastian.novak@rt-rk.com", "creation_time": "2015-03-19T10:49:34Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 54470, "is_private": false, "count": 4, "id": 181905, "time": "2015-03-19T10:51:10Z", "creator": "sebastian.novak@rt-rk.com", "creation_time": "2015-03-19T10:51:10Z", "text": "(In reply to sebastian.novak from comment #3)\n> (In reply to Guillaume de GENTILE from comment #0)\n> > Created attachment 29885 [details]\n> > Zip file with updated class and Excel sample template\n> > \n> > Hi all,\n> > \n> > With version 3.9 (and older versions) it is not possible to rename a sheet\n> > which contains some graphs, and it is also not possible to copy graphs while\n> > cloning a sheet.\n> > \n> > I have amended the POI api to support Graph while cloning sheet and also\n> > while renaming sheet.\n> > \n> > Below the solution I have implemented (note that I am not experienced with\n> > the POI api, so it might be possible to perform the same operation in a more\n> > official way).\n> > \n> > I hope it will be usefull...\n> > \n> > Regards,\n> > Guillaume\n> \n> Awesome code~!\n> \n> I'm attempting to copy chart objects from one workbook to another.\n> If I manage to clone both the CTChart and the CTChartSpace objects?\n> \n> Best regards,\n> Novak\n\nWould it be possible if I manage to clone both the CTChart and the CTChartSpace objects? *"}, {"count": 5, "tags": [], "text": "Hi there,\n\nI have run the sample code of \"Guillaume de GENTILE\", and I get new sheet create with the data-table at the top but no chart object.\nI get an Exception:\nfrom Method:\nupdateRelationsSheetName\nIn class: class XmlNodeUtils\n------------------------------------\nwhile(it.hasNext()) {\n                \tXSSFChart chart = it.next();\n                \t//System.out.println(\"chart = \" + chart);\n                \tCTChart c = chart.getCTChart();\n                \t\n             ERROR HERE:  Node node1 = chart.getCTChart().getDomNode();\n                \tupdateDomDocSheetReference(node1, frwb, oldSheetName);\n\n                \tNode node2 = chart.getCTChartSpace().getDomNode();\n                \tupdateDomDocSheetReference(node2, frwb, oldSheetName);\n\n                }\n                continue;\n\n------------------------------------\nNote that the variable/object : c , is not used in the code:\n\"CTChart c = chart.getCTChart();\"\n\nHope Guillaume can debug this.\n\nRegards,\n\nP", "attachment_id": null, "id": 183093, "creator": "palmerr_2002@hotmail.com", "time": "2015-05-23T20:02:55Z", "bug_id": 54470, "creation_time": "2015-05-23T20:02:55Z", "is_private": false}, {"count": 6, "attachment_id": null, "creator": "palmerr_2002@hotmail.com", "is_private": false, "id": 183094, "time": "2015-05-23T20:08:17Z", "bug_id": 54470, "creation_time": "2015-05-23T20:08:17Z", "tags": [], "text": "Hi there,\n\nI have run the sample code of \"Guillaume de GENTILE\", and I get new sheet create with the data-table at the top but no chart object.\nI get an Exception:\nfrom Method:\nupdateRelationsSheetName\nIn class: class XmlNodeUtils\n------------------------------------\nwhile(it.hasNext()) {\n                \tXSSFChart chart = it.next();\n                \t//System.out.println(\"chart = \" + chart);\n                \tCTChart c = chart.getCTChart();\n                \t\n             ERROR HERE:  Node node1 = chart.getCTChart().getDomNode();\n                \tupdateDomDocSheetReference(node1, frwb, oldSheetName);\n\n                \tNode node2 = chart.getCTChartSpace().getDomNode();\n                \tupdateDomDocSheetReference(node2, frwb, oldSheetName);\n\n                }\n                continue;\n\n------------------------------------\nNote that the variable/object : c , is not used in the code:\n\"CTChart c = chart.getCTChart();\"\n\nHope Guillaume can debug this.\n\nRegards,\n\nP"}, {"count": 7, "tags": [], "bug_id": 54470, "is_private": false, "text": "Hi all,\n\nI have adapted the code to make it compatible with POI 3.12. (consider New ZIP)\n\nWith the enclosed path it is possible to rename a Sheet containing a Chart (the Chart  referencees will be correctly refreshed).\n\nAlso it is possible to duplicate a Sheet containing charts.\n\nNote that due to a bug in the Apache POI, it is not possible to Clone and rename a Sheet in the same context. The workbook must be closed and reopenned.\n\nSee testcase \"TestCloneSheet.java\" for more details.\n\nRegards,\nGuillaume de GENTILE", "id": 183095, "time": "2015-05-24T16:24:18Z", "creator": "gdegentile@finbox-solutions.com", "creation_time": "2015-05-24T16:24:18Z", "attachment_id": null}, {"count": 8, "attachment_id": 32753, "bug_id": 54470, "text": "Created attachment 32753\nNew patch for POI 3.12\n\nNew patch for POI 3.12:\n\n * Rename Sheet with Chart works fine :)\n * Clone Sheet with Chart works fine :)\n\nRegards,\nGuillaume de GENTILE", "id": 183096, "time": "2015-05-24T16:27:30Z", "creator": "gdegentile@finbox-solutions.com", "creation_time": "2015-05-24T16:27:30Z", "tags": [], "is_private": false}, {"count": 9, "attachment_id": null, "bug_id": 54470, "text": "*** Bug 49319 has been marked as a duplicate of this bug. ***", "id": 191661, "time": "2016-06-15T09:45:50Z", "creator": "onealj@apache.org", "creation_time": "2016-06-15T09:45:50Z", "tags": [], "is_private": false}]