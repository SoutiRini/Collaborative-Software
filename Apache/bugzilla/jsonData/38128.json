[{"count": 0, "tags": [], "bug_id": 38128, "attachment_id": null, "is_private": false, "id": 84233, "time": "2006-01-04T22:20:38Z", "creator": "rafaels@redhat.com", "creation_time": "2006-01-04T22:20:38Z", "text": "With directory listings enabled, multiple requests to a large directory can\ncause tomcat to quickly run out of memory and die."}, {"count": 1, "tags": [], "bug_id": 38128, "text": "Created attachment 17328\npatch for caching directory listings\n\nThis patch addresses the DoS problem and significantly improves directory\nlisting performance.", "id": 84234, "time": "2006-01-04T22:22:34Z", "creator": "rafaels@redhat.com", "creation_time": "2006-01-04T22:22:34Z", "is_private": false, "attachment_id": 17328}, {"count": 2, "attachment_id": null, "bug_id": 38128, "is_private": false, "id": 88502, "time": "2006-04-26T13:48:21Z", "creator": "rafaels@redhat.com", "creation_time": "2006-04-26T13:48:21Z", "tags": [], "text": "Does anyone know what the status regarding this patch is? I believe the problem\nstill affects the latest versions of tomcat."}, {"count": 3, "tags": [], "bug_id": 38128, "text": "Patch is yet to be evaluated.", "id": 88522, "time": "2006-04-26T21:04:18Z", "creator": "markt@apache.org", "creation_time": "2006-04-26T21:04:18Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "rafaels@redhat.com", "is_private": false, "text": "Is there anything I can do to expidite the process? I would really like to see a\nfix for the problem incorporated. Without some fix it is impossible to use the\ndirectory listing feature when even moderately large directories are involved.", "id": 88532, "time": "2006-04-27T00:02:47Z", "bug_id": 38128, "creation_time": "2006-04-27T00:02:47Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "yoavs@computer.org", "text": "There are a few things I dislike in this patch.\n\nYou shouldn't catch Throwables and then silently not handle them.  You shouldn't\neven do that with Exceptions, but certainly not Throwables.  That by itself\nmeans -1 on the patch as it stands currently.\n\nThen there's the overall weight of the solution: adding a custom cache and tying\nit into the default web.xml just for this case seems overweight.  I wonder if\nthere's an easier solution without caching, and certainly without a time-based\ncache which means additional background processing.  One approach that comes to\nmind is a no-op XSLT for customizations, as documented in\nhttp://tomcat.apache.org/tomcat-5.0-doc/default-servlet.html#dir\n\nFinally, as you probably know directory listings are easy to disable: see\nhttp://marc.theaimsgroup.com/?l=tomcat-user&m=105525007220640&w=2 for example of\nthe one setting change required.  For others concerned about this DoS (and I\ndon't think there are any, seeing as how no one else has opined on this issue\nand/or posted such a DoS on the mailing lists), they can simply disable\ndirectory listings.\n\nBecause of these, I'm going to mark this particular patch as WONTFIX.  If\nsomeone else wants strongly feels this patch should be applied as-is, they can\nsay so here.  Otherwise, maybe a more lightweight patch can be attached to the\nissue (and the issue itself reopened), that is if anyone still cares.", "id": 97229, "time": "2006-12-24T17:38:35Z", "bug_id": 38128, "creation_time": "2006-12-24T17:38:35Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 38128, "text": "(In reply to comment #5)\n> There are a few things I dislike in this patch.\n> \n> You shouldn't catch Throwables and then silently not handle them.  You shouldn't\n> even do that with Exceptions, but certainly not Throwables.  That by itself\n> means -1 on the patch as it stands currently.\n\nI agree that catching Throwable is a really bad idea, however the DefaultServlet\ncode does this repeatedly when accessing parameters from the servlet config. I\nchose to keep the code consistent and follow the pattern already prevalent when\nmaking this patch. I beleive it should be a simple matter to string replace\nThrowable with a more appropriate exception in this code.\n\n> Then there's the overall weight of the solution: adding a custom cache and tying\n> it into the default web.xml just for this case seems overweight.  I wonder if\n> there's an easier solution without caching, and certainly without a time-based\n> cache which means additional background processing.  One approach that comes to\n> mind is a no-op XSLT for customizations, as documented in\n> http://tomcat.apache.org/tomcat-5.0-doc/default-servlet.html#dir\n> \n> Finally, as you probably know directory listings are easy to disable: see\n> http://marc.theaimsgroup.com/?l=tomcat-user&m=105525007220640&w=2 for example of\n> the one setting change required.  For others concerned about this DoS (and I\n> don't think there are any, seeing as how no one else has opined on this issue\n> and/or posted such a DoS on the mailing lists), they can simply disable\n> directory listings.\n> \n> Because of these, I'm going to mark this particular patch as WONTFIX.  If\n> someone else wants strongly feels this patch should be applied as-is, they can\n> say so here.  Otherwise, maybe a more lightweight patch can be attached to the\n> issue (and the issue itself reopened), that is if anyone still cares.\n\nThe caching this patch adds is not just a special purpose fix to eliminate a\nDoS, it also significantly improves the performance of directory listings in the\ngeneral case. Please review my posts to the dev lists containing my benchmarks\ncomparing performance with and without the patch in place.", "id": 97337, "time": "2006-12-26T07:56:12Z", "creator": "rafaels@redhat.com", "creation_time": "2006-12-26T07:56:12Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 38128, "text": "Note I've also converted existing DefaultServlet catch(Throwable t) code to\ncatching exceptions.\n\nI saw your mailing list messages, and I believe the benchmarks.  I still think\nthis approach is too heavyweight.", "id": 97338, "time": "2006-12-26T07:58:24Z", "creator": "yoavs@computer.org", "creation_time": "2006-12-26T07:58:24Z", "is_private": false, "attachment_id": null}]