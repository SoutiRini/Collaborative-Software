[{"count": 0, "tags": [], "creator": "terrywarren@gmail.com", "attachment_id": null, "is_private": false, "id": 191332, "time": "2016-05-31T14:03:32Z", "bug_id": 59645, "creation_time": "2016-05-31T14:03:32Z", "text": "In Page Setup -> Sheet there is a checkbox for Row and Column Headings. Checking this checkbox causes the Row numbers and Column Letters to be printed on each page. There doesn't seem to be any support for this in POI.\n\nThere is (as mentioned in resolution of Bug 27084) support for Repeating Rows and Columns; however this only causes designated rows and columns to be repeated on each printed page. It is not related to print Row and column headings. (Which is why there are separate settings for these two features)"}, {"count": 1, "attachment_id": null, "bug_id": 59645, "text": "Do you know where this is saved in the xlsx file? The printer settings (this sounds like one) are saved in a binary printerSettings.bin. [1]\n\nIf so, this is something that would take a non-trivial amount of work to add as someone would have to write code that could read the binary file into record objects, mutate one of the record objects, and write the records back out as a binary file.\n\nIf you're not sure, you could create two Excel files that differ only by the page setup settings. Rename the .xlsx files to .zip, extract them, and recursively diff the files. Hopefully this is a change in one of the XML files that defines the view (like freeze pane or split pane). *fingers crossed*\n\n[1] http://stackoverflow.com/questions/23139328/where-is-the-definition-of-the-xlsx-printersettings-bin-file-format", "id": 191744, "time": "2016-06-17T10:38:10Z", "creator": "onealj@apache.org", "creation_time": "2016-06-17T10:38:10Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "terrywarren@gmail.com", "attachment_id": 33960, "id": 191770, "time": "2016-06-18T23:22:48Z", "bug_id": 59645, "creation_time": "2016-06-18T23:22:48Z", "is_private": false, "text": "Created attachment 33960\ndifferences in hex dumps for 2 reference xlsx files\n\ncomment was added in my latest reply"}, {"text": "I don't really have any in depth knowledge of xlsx internal formats. However, I did attempt to create 2 spreadsheets as suggested. I don't have a fancy difference program, but I do have a program that produces a hex dump, so I did that for the 2 files and looked at them. The files were created as follows:\n\n(1) empty excel spreadsheet, then go to Page Setup -> Sheet and checked the Pint Row and Column headings checkbox.\n(2) saved this file as reference1.xlsx\n(3) unchecked the box and saved again, this time as reference2.xlsx\n(4) created the hex dumps for those 2 files.\n\nAttached is a printout of what seemed to be different in the 2 files (not necessarily a thorough examination):\n\nseem to be the same up until offset 48E0 where that 1 byte is different\nthen different again at offset:\n  reference1 48F0 - 4A7E\n  reference2 48F0 - 4A8B\n\n(so, reference1 has 11 extra bytes, plus differences)\n\nthen same again\n\nI can send complete hex dump output if it would be helpful.", "tags": [], "bug_id": 59645, "is_private": false, "count": 3, "id": 191771, "time": "2016-06-18T23:24:48Z", "creator": "terrywarren@gmail.com", "creation_time": "2016-06-18T23:24:48Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "terrywarren@gmail.com", "attachment_id": null, "id": 191772, "time": "2016-06-18T23:30:35Z", "bug_id": 59645, "creation_time": "2016-06-18T23:30:35Z", "is_private": false, "text": "(In reply to Terry Warren from comment #3)\n> I don't really have any in depth knowledge of xlsx internal formats.\n> However, I did attempt to create 2 spreadsheets as suggested. I don't have a\n> fancy difference program, but I do have a program that produces a hex dump,\n> so I did that for the 2 files and looked at them. The files were created as\n> follows:\n> \n> (1) empty excel spreadsheet, then go to Page Setup -> Sheet and checked the\n> Pint Row and Column headings checkbox.\n> (2) saved this file as reference1.xlsx\n> (3) unchecked the box and saved again, this time as reference2.xlsx\n> (4) created the hex dumps for those 2 files.\n> \n> Attached is a printout of what seemed to be different in the 2 files (not\n> necessarily a thorough examination):\n> \n> seem to be the same up until offset 48E0 where that 1 byte is different\n> then different again at offset:\n>   reference1 48F0 - 4A7E\n>   reference2 48F0 - 4A8B\n> \n> (so, reference1 has 17 extra bytes, plus differences)\n> \n> then same again\n> \n> I can send complete hex dump output if it would be helpful."}, {"count": 5, "tags": [], "creator": "kiwiwings@apache.org", "attachment_id": null, "text": "I've just repeated that test and printerSettings1.bin is left unchanged.\n\nIn the sheet1.xml there is a \"printOptions\" element with attribute \"headings\"=\"1\", when the row and column headings are checked. I guess this can be easily changed via the xmlbeans objects ... something like:\nsheet.getCTWorksheet().getPrintOptions().setHeadings(true);\n\nRegarding your hex dumps, can it be, that you've compared the xlxs-files and not their content, i.e. .xlsx are .zip files, so you need to unpack them first before comparing ...", "id": 191775, "time": "2016-06-19T00:29:56Z", "bug_id": 59645, "creation_time": "2016-06-19T00:29:56Z", "is_private": false}, {"count": 6, "attachment_id": null, "bug_id": 59645, "text": "yes, I did not \"unzip\" the .xlsx files; When I look at them using text wrangler app, it does this automatically and I can see the printOptions element.", "id": 191779, "time": "2016-06-19T11:11:19Z", "creator": "terrywarren@gmail.com", "creation_time": "2016-06-19T11:11:19Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "creator": "terrywarren@gmail.com", "attachment_id": null, "text": "one additional comment:\n\nif I check \"gridlines\" checkbox in Page Setup -> Sheet as well as Headings then the xml contains the following:\n\n<printOptions headings=\"1\" gridLines=\"1\"/>\n\nand, currently, there is support for printing gridlines:\n\nsheet.setPrintGridlines(true)\n\nso, it would seem that adding support for print headings should not be too difficult.", "id": 191786, "time": "2016-06-19T14:09:14Z", "bug_id": 59645, "creation_time": "2016-06-19T14:09:14Z", "is_private": false}, {"count": 8, "attachment_id": null, "bug_id": 59645, "is_private": false, "id": 191788, "time": "2016-06-19T18:20:48Z", "creator": "onealj@apache.org", "creation_time": "2016-06-19T18:20:48Z", "tags": [], "text": "Applied in r1749191."}]