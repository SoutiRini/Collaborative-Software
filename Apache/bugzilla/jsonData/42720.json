[{"count": 0, "attachment_id": null, "creator": "keiichi.fujino@gmail.com", "text": "A large amount of following messages are output with Tomcat6.0.13. \n\norg.apache.catalina.tribes.ChannelException: No destination given; No faulty \nmembers identified.\n    at org.apache.catalina.tribes.group.GroupChannel.send\n(GroupChannel.java:194)\n    at org.apache.catalina.tribes.group.GroupChannel.send\n(GroupChannel.java:175)\n    at org.apache.catalina.ha.tcp.SimpleTcpCluster.send\n(SimpleTcpCluster.java:835)\n    at org.apache.catalina.ha.tcp.SimpleTcpCluster.sendClusterDomain\n(SimpleTcpCluster.java:814)\n    at org.apache.catalina.ha.session.DeltaManager.send(DeltaManager.java:586)\n    at org.apache.catalina.ha.session.DeltaManager.sessionExpired\n(DeltaManager.java:1211)\n    at org.apache.catalina.ha.session.DeltaSession.expire\n(DeltaSession.java:366)\n    at org.apache.catalina.ha.session.DeltaSession.expire\n(DeltaSession.java:352)\n    at org.apache.catalina.ha.session.DeltaSession.isValid\n(DeltaSession.java:327)\n    at org.apache.catalina.session.ManagerBase.processExpires\n(ManagerBase.java:682)\n    at org.apache.catalina.session.ManagerBase.backgroundProcess\n(ManagerBase.java:667)\n    at org.apache.catalina.core.ContainerBase.backgroundProcess\n(ContainerBase.java:1316)\n    at \norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChil\ndren(ContainerBase.java:1601)\n    at \norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChil\ndren(ContainerBase.java:1610)\n    at \norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChil\ndren(ContainerBase.java:1610)\n    at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run\n(ContainerBase.java:1590)\n    \nThe easiest reproduction procedure is as follows. \n 1: < Cluster > and \n    <Manager className=\"org.apache.catalina.ha.session.DeltaManager\"...>\n   is set to server.xml. \n 2: Only one Tomcat is started. \n 3: The request that creates the session is sent. (a lot)\n 4: The session does the timeout. (or session.invalidate())\n 5: The error message is output per session timeout(or invalidate()). \n \nI think that DeltaManager should check the number of cluster members\nbefore transmitting the replication message in DeltaManager.sessionExpired. \nFor instance, org.apache.catalina.ha.session.DeltaManager.sessionExpired is \ncorrected as follows. \n\nprotected void sessionExpired(String id) {\n    if (cluster.getMembers().length > 0) {\n        counterSend_EVT_SESSION_EXPIRED++;\n        SessionMessage msg = new SessionMessageImpl(getName\n(),SessionMessage.EVT_SESSION_EXPIRED, null, id, id + \"-EXPIRED-MSG\");\n        if (log.isDebugEnabled()) log.debug(sm.getString\n(\"deltaManager.createMessage.expire\", getName(), id));\n        send(msg);\n    }\n}\n\t\nThis correction is done by the way similar to DeltaManager.sendCreateSession.", "id": 104621, "time": "2007-06-22T01:22:44Z", "bug_id": 42720, "creation_time": "2007-06-22T01:22:44Z", "tags": [], "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 42720, "text": "I have test the patch for tomcat 5.5 and it works fine.\nFilip can we also patch the 6.0 code base?\n\nPeter", "id": 106144, "time": "2007-08-01T07:28:58Z", "creator": "pr@objektpark.de", "creation_time": "2007-08-01T07:28:58Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 42720, "attachment_id": null, "text": "Fixed globally in SimpleTcpCluster.send\nFixed in both 6.0.x and trunk", "id": 106459, "time": "2007-08-07T08:47:01Z", "creator": "fhanik@apache.org", "creation_time": "2007-08-07T08:47:01Z", "is_private": false}]