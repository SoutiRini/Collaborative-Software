[{"count": 0, "tags": [], "creator": "henryjen@ztune.net", "attachment_id": null, "id": 95414, "time": "2006-11-03T22:50:35Z", "bug_id": 40893, "creation_time": "2006-11-03T22:50:35Z", "is_private": false, "text": "apr_brigade_length with readall set to 1 will try to read from a bucket\nwith length -1 to determine the value.\n\nCurrently, if apr_bucket_read with the bucket of length -1 returns other\nthan APR_SUCCESS, the length returned is undefined.\n\nIn case of a socket bucket with a nonblocking socket, the return status\ncould be EAGAIN and the length is still useful to determine value\navailable at the moment. A use case, for example, is waiting for a\ncertain amount of data to be available.\n\nI would propose to return the value up-to-date is better than undefined.\nThe application can decide whether the value is meaningful with the\nreturned status. Does this make sense?\n\nAttached is a simple path specifying the length.\n\nIt may not be accurate, but it is what you can get from the brigade for sure.\n\nIn the socket example, you are not likely to get an length back when there is an\nerror. Even you do have a length, the data read was discarded so that it won't\nbe in the brigade.\n\nGiven that, I think not adding the *len value might be a better solution."}, {"count": 1, "tags": [], "bug_id": 40893, "attachment_id": 19087, "text": "Created attachment 19087\nReturn available data length", "id": 95415, "time": "2006-11-03T22:51:49Z", "creator": "henryjen@ztune.net", "creation_time": "2006-11-03T22:51:49Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 40893, "attachment_id": null, "id": 105816, "time": "2007-07-21T10:43:41Z", "creator": "davi@apache.org", "creation_time": "2007-07-21T10:43:41Z", "is_private": false, "text": "Slightly different patch committed to trunk in revision 558361:\n\nhttp://svn.apache.org/viewvc?view=rev&revision=558361"}]