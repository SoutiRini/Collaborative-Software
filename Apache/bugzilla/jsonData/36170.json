[{"count": 0, "tags": [], "bug_id": 36170, "attachment_id": null, "id": 78452, "creation_time": "2005-08-12T20:08:32Z", "time": "2005-08-12T20:08:32Z", "creator": "grant_benson@msn.com", "text": "I discovered that I receive this error if a worksheet in the workbook has \nAutoFilter enabled.\n\nIt doesn't matter if the workbook has 1 or many sheets with this feature \nenabled.\n\nHere are the pertenent lines of code:\n\nprivate POIFSFileSystem wbFs;\nprivate HSSFWorkbook wbWb;\n\nwbFs = new POIFSFileSystem(new FileInputStream(srcFilename));\nwbWb = new HSSFWorkbook(wbFs);\n\nTrace stack:\njava.lang.reflect.InvocationTargetException\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native \nMethod)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown \nSource)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown \nSource)\n\tat java.lang.reflect.Constructor.newInstance(Unknown Source)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java:224)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java:160)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:163)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:130)\n\tat newbenson.Extract2.updateWorkbooks(Extract2.java:885)\n\tat newbenson.Extract2$ActualTask.<init>(Extract2.java:1101)\n\tat newbenson.Extract2$1.construct(Extract2.java:1011)\n\tat newbenson.SwingWorker$2.run(SwingWorker.java:114)\n\tat java.lang.Thread.run(Unknown Source)\nCaused by: java.lang.ArrayIndexOutOfBoundsException\n\tat java.lang.System.arraycopy(Native Method)\n\tat org.apache.poi.hssf.record.UnknownRecord.<init>\n(UnknownRecord.java:62)\n\tat org.apache.poi.hssf.record.SubRecord.createSubRecord\n(SubRecord.java:57)\n\tat org.apache.poi.hssf.record.ObjRecord.fillFields(ObjRecord.java:99)\n\tat org.apache.poi.hssf.record.Record.fillFields(Record.java:90)\n\tat org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n\tat org.apache.poi.hssf.record.ObjRecord.<init>(ObjRecord.java:61)\n\t... 13 more\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record \ninstance, the following exception occured: null\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java:237)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java:160)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:163)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:130)\n\tat newbenson.Extract2.updateWorkbooks(Extract2.java:885)\n\tat newbenson.Extract2$ActualTask.<init>(Extract2.java:1101)\n\tat newbenson.Extract2$1.construct(Extract2.java:1011)\n\tat newbenson.SwingWorker$2.run(SwingWorker.java:114)\n\tat java.lang.Thread.run(Unknown Source)", "is_private": false}, {"count": 1, "tags": [], "bug_id": 36170, "attachment_id": 16024, "id": 78453, "time": "2005-08-12T20:10:10Z", "creator": "grant_benson@msn.com", "creation_time": "2005-08-12T20:10:10Z", "is_private": false, "text": "Created attachment 16024\nSample of the workbook I'm attempting to read."}, {"count": 2, "tags": [], "creator": "jheight@apache.org", "attachment_id": null, "text": "The attached file works with HEAD of CVS.\n\nJason", "id": 78901, "time": "2005-08-24T04:16:20Z", "bug_id": 36170, "creation_time": "2005-08-24T04:16:20Z", "is_private": false}]