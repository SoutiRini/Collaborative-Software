[{"count": 0, "tags": [], "text": "Currently the tar task imposes a directory permission of 755 regardless of the\nmode specified for the files.  Could you please consider allowing the \nspecification of a \"dirmode\" for directory permission and a \"filemode\" for\nfile permission for the tarfileset?  Your consideration for this is greatly \nappreciated.  Thanks.", "attachment_id": null, "bug_id": 7780, "id": 12890, "time": "2002-04-05T23:02:04Z", "creator": "acl1@notes.ntrs.com", "creation_time": "2002-04-05T23:02:04Z", "is_private": false}, {"count": 1, "tags": [], "creator": "steve_l@iseran.com", "attachment_id": null, "id": 12891, "time": "2002-04-05T23:25:10Z", "bug_id": 7780, "creation_time": "2002-04-05T23:25:10Z", "is_private": false, "text": "RTM on <tarfileset> and the mode attribute"}, {"count": 2, "tags": [], "bug_id": 7780, "is_private": false, "text": "The tar file that I need to come up with must have directory permission 750 and\nfile permission 640.  Since the tarfileset has only one mode specification, it\nis impossible to do this.  So I modified tar.java to suit my requirement.  The\ntarfileset class is defined inside tar.java and it has been modified to include\nthe following two attributes in place of the original mode attribute:        \n\nprivate int fileMode = 0100644;\nprivate int dirMode = 040755;\n\nIn place of the original methods for the mode attribute, the following methods\nhave been substituted:\n\n        public void setFileMode(String octalString) {\n            this.fileMode = 0100000 | Integer.parseInt(octalString, 8);\n        }\n            \n        public int getFileMode() {\n            return fileMode;\n        }\n        \n        public void setDirMode(String octalString) {\n            this.dirMode = 040000 | Integer.parseInt(octalString, 8);\n        }\n            \n        public int getDirMode() {\n            return dirMode;\n        }\n        \nThen in the tarfile() method in the tar class, the following modification has\nbeen made:\n\n    protected void tarFile(File file, TarOutputStream tOut, String vPath,\n                           TarFileSet tarFileSet)\n        throws IOException\n    {\n        .\n        .\n        .\n\n(removed)    if (!file.isDirectory()) {\n(removed)        te.setSize(file.length());\n(removed)        te.setMode(tarFileSet.getMode());\n(removed)    } \n\n(added)      if (!file.isDirectory()) {\n(added)          te.setSize(file.length());\n(added)          te.setMode(tarFileSet.getFileMode());\n(added)      } \n(added)      else {\n(added)          te.setMode(tarFileSet.getDirMode());\n(added)      }\n        .\n        .\n        .\n\n    }\n\nWith the new modification I can specify a 'dirmode' for the mode of directories\nand a 'filemode' for the mode of files within the tar file.  This provides more\nflexibility for the tar task.\n\nAny further consideration for this issue will be greatly appreciated.  Thanks.\n\n\n\n\n", "id": 13096, "time": "2002-04-09T14:34:16Z", "creator": "acl1@notes.ntrs.com", "creation_time": "2002-04-09T14:34:16Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 7780, "attachment_id": null, "text": "OK, I see your point\n\nyour patch, of course, breaks every build file which uses the mode attribute; \nwe'd need one which doesnt do that.\n\nI'd suggest leaving mode as is, setting both file and dir when used, but when \na dirmode attr is set then the dir mode is derived from that value instead.\n\nIf you can do this, and write a junit test to verify backwards compatibility, \nthen attach the files/ cvs diff -u patch files up as attachments to this \nreport and we'll see what can be done about incorporation", "id": 13112, "time": "2002-04-09T16:39:03Z", "creator": "steve_l@iseran.com", "creation_time": "2002-04-09T16:39:03Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 7780, "attachment_id": null, "text": "an additional dirmode attribute has been added - actually months ago, I just forgot\nto close this report.", "id": 33523, "time": "2003-03-20T08:27:20Z", "creator": "bodewig@apache.org", "creation_time": "2003-03-20T08:27:20Z", "is_private": false}]