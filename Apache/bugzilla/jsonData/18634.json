[{"count": 0, "tags": [], "bug_id": 18634, "attachment_id": null, "text": "The changes below:\ndiff -c -r1.75 -r1.79\n*** proxy_http.c        24 Sep 2001 22:35:37 -0000      1.75\n--- proxy_http.c        5 Oct 2001 17:46:39 -0000       1.79\n***************\n*** 172,178 ****\n  {\n      const char *strp;\n      char *strp2;\n!     const char *err, *desthost;\n      int i, j, sock, len, backasswards;\n      array_header *reqhdrs_arr;\n      table *resp_hdrs;\n--- 172,178 ----\n  {\n      const char *strp;\n      char *strp2;\n!     const char *err, *desthost, *pragma;\n      int i, j, sock, len, backasswards;\n      array_header *reqhdrs_arr;\n      table *resp_hdrs;\n***************\n*** 472,477 ****\n--- 472,487 ----\n        ap_table_set(resp_hdrs, \"Location\", proxy_location_reverse_map(r,\ndatestr));\n      if ((datestr = ap_table_get(resp_hdrs, \"URI\")) != NULL)\n        ap_table_set(resp_hdrs, \"URI\", proxy_location_reverse_map(r, datestr));\n+ \n+  /*\n+   * If \"Pragma: no-cache\" set nocache and make reply un-buffered to\n+   * ensure timely delivery\n+   */\n+     if (((pragma = ap_table_get(resp_hdrs, \"Pragma\")) != NULL &&\n+         ap_proxy_liststr(pragma, \"no-cache\"))) {\n+         nocache = 1;\n+         r->connection->client->flags &= ~B_WR;\n+     }\n  \n  /* check if NoCache directive on this host */\n      if (nocache == 0) {\n\n----------------------------\nrevision 1.76\ndate: 2001/09/28 05:28:59;  author: chuck;  state: Exp;  lines: +9 -1\nHonor Pragma: no-cache for HTTP 1.0. The 1.3 proxy rewrite and 2.0 code\nalready handles both cases (Pragma: and Cache-Control:)\nPR: 5668\nSubmitted by:   Kim Bisgaard <kib@dmi.dk>\nReviewed by:    Chuck Murcko\n=============================================================================\n\n(1.77-1.79 were minor bugfixes to 1.76 commit)\n\nwere rolled out on this commit:\n----------------------------\nrevision 1.101\ndate: 2002/09/03 07:12:46;  author: minfrin;  state: Exp;  lines: +0 -2\nFix a problem in proxy where headers from other modules were\nadded to the response headers when this was already done in the\ncore already. This resulted in header (and therefore cookie)\nduplication.\nPR:\nObtained from:\nSubmitted by:   Martijn Schoemaker <martijn@osp.nl>\nReviewed by:    Graham Leggett\n=============================================================================", "id": 34390, "time": "2003-04-02T23:54:53Z", "creator": "joshua@safeweb.com", "creation_time": "2003-04-02T23:54:53Z", "is_private": false}]