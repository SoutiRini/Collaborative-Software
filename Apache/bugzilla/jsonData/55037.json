[{"count": 0, "attachment_id": 30351, "creator": "cedric.walter@gmail.com", "text": "Created attachment 30351\nnew function delta + testcases\n\nnew function delta + testcases", "id": 167540, "time": "2013-05-31T17:37:43Z", "bug_id": 55037, "creation_time": "2013-05-31T17:37:43Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "id": 167580, "time": "2013-06-02T15:54:01Z", "bug_id": 55037, "creation_time": "2013-06-02T15:54:01Z", "is_private": false, "text": "Patch applied in r1488730 but there is some work to do . \n\nDELTA is a function from the Excel Analysis Toolpack . It needs to implement FreeRefFunction and be registered in org.apache.poi.ss.formula.atp.AnalysisToolPak. Otherwise the formula evaluator will not find it. \n\nWhat you need to do:\n\n(1) Declare DELTA as implementing FreeRefFunction . There is one method to implement and you need to simply delegate it to the existing implementation:\n\n    public ValueEval evaluate(ValueEval[] args, OperationEvaluationContext ec) {\n        if (args.length != 2) {\n            return ErrorEval.VALUE_INVALID;\n        }\n        return evaluate(ec.getRowIndex(), ec.getColumnIndex(), args[0], args[1]);    \n    }\n\n(2) register DELTA in AnalysisToolPack, see how other functions are registered and follow the pattern.\n\n(3) Provide a test(s) that evaluate functions from a real excel file. Attach the modified test workbook to this bug report.\n\nYegor"}, {"count": 2, "tags": [], "creator": "cedric.walter@gmail.com", "text": "Created attachment 30365\nThis spreadsheet contains various test cases for the functions: DELTA", "id": 167586, "time": "2013-06-02T18:08:40Z", "bug_id": 55037, "creation_time": "2013-06-02T18:08:40Z", "is_private": false, "attachment_id": 30365}, {"count": 3, "tags": [], "bug_id": 55037, "attachment_id": 30366, "text": "Created attachment 30366\nThis spreadsheet contains various test cases for the functions: DELTA", "id": 167587, "time": "2013-06-02T18:09:29Z", "creator": "cedric.walter@gmail.com", "creation_time": "2013-06-02T18:09:29Z", "is_private": false}, {"count": 4, "tags": [], "creator": "yegor@dinom.ru", "text": "You seem to attached the test spreadsheet instead of the patch. Please re-attach.\n\nYegor", "id": 167598, "time": "2013-06-02T23:08:25Z", "bug_id": 55037, "creation_time": "2013-06-02T23:08:25Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "cedric.walter@gmail.com", "text": "Created attachment 30380\npatch : TestDeltaFunctionsFromSpreadsheet.java Delta.java AnalysisToolPak.java", "id": 167611, "time": "2013-06-03T07:18:24Z", "bug_id": 55037, "creation_time": "2013-06-03T07:18:24Z", "is_private": false, "attachment_id": 30380}, {"count": 6, "tags": [], "text": "Add missing TestDeltaFunctionsFromSpreadsheet and register Delta in AnalysisToolPak in r1529809", "attachment_id": null, "bug_id": 55037, "id": 170464, "time": "2013-10-07T09:43:40Z", "creator": "cedric.walter@gmail.com", "creation_time": "2013-10-07T09:43:40Z", "is_private": false}]