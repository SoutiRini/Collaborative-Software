[{"attachment_id": null, "tags": [], "bug_id": 37735, "is_private": false, "count": 0, "id": 83071, "time": "2005-12-01T14:20:52Z", "creator": "jessh@ptc.com", "creation_time": "2005-12-01T14:20:52Z", "text": "Even after cleansing source code using log4j to compile and run cleanly with\nlog4j 1.3 (alpha 7 or HEAD), the resulting binaries are incompatible (produce\nVerifyErrors) when they are compiled against 1.2 (1.2.13rc2) and then run with 1.3.\n\nWorse, the incompatibility surrounds use of Level with Logger, i.e. rather\ncommon usage.\n\nThe problem turns out to be the fact that log4j 1.3 flips the inheritance\nhierarchy so that Priority is a subclass of Logger rather than vice versa as was\nthe case in 1.2.  This drives the class verifier nuts in cases.\n\nI have produced a patch that I believe is quite clean and will attach it."}, {"count": 1, "tags": [], "bug_id": 37735, "attachment_id": 17101, "text": "Created attachment 17101\nProposed patch", "id": 83072, "time": "2005-12-01T14:22:25Z", "creator": "jessh@ptc.com", "creation_time": "2005-12-01T14:22:25Z", "is_private": false}, {"count": 2, "tags": [], "creator": "jessh@ptc.com", "is_private": false, "text": "Created attachment 17102\nProposed patch", "id": 83073, "time": "2005-12-01T14:54:57Z", "bug_id": 37735, "creation_time": "2005-12-01T14:54:57Z", "attachment_id": 17102}, {"count": 3, "attachment_id": null, "bug_id": 37735, "is_private": false, "id": 83074, "time": "2005-12-01T14:57:11Z", "creator": "jessh@ptc.com", "creation_time": "2005-12-01T14:57:11Z", "tags": [], "text": "[Second proposed patch is same as the first except with file paths relative to\nthe SVN root whereas previous were relative to src/java/org/apache/log4j.]"}, {"count": 4, "tags": [], "creator": "jessh@ptc.com", "attachment_id": null, "is_private": false, "id": 83078, "time": "2005-12-01T16:02:18Z", "bug_id": 37735, "creation_time": "2005-12-01T16:02:18Z", "text": "Note I am aware that this hierarchy was inverted quite intentionally.\n\nThe impact of the change is *very* onerous to existing code, however -- we can't\ncompile against alpha and beta releases and a given version of our software is\nreleased it's too late, it's locked into log4j 1.2 (vs. 1.3) indefinitely.\n\nThe proposed patch balances code purity with binary compatibility.  It's not the\nperfectly clean ideal the log4j 1.3 developers were shooting for.  It's also not\ncompatible with all binaries compiled against 1.2.  It is, however, much cleaner\nthan 1.2 and compatible with binaries compiled against 1.2 that never reference\nPriority methods or fields."}, {"count": 5, "tags": [], "creator": "carnold@apache.org", "is_private": false, "text": "\n\n*** This bug has been marked as a duplicate of 35452 ***", "id": 83082, "time": "2005-12-01T17:24:07Z", "bug_id": 37735, "creation_time": "2005-12-01T17:24:07Z", "attachment_id": null}]