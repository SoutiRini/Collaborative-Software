[{"count": 0, "tags": [], "text": "AccessInterceptor redirects the user to incorrect URL after logging in to a \nsecond secure (i.e. requiring authentication) area on the webserver.\n\nMy solution:\n\nIn doService, the block of code:\n\n        \n        String originalLocation = req.getRequestURI();\n\n\tif (req.getQueryString() != null)\n\t    originalLocation += \"?\" + req.getQueryString();\n\n \tsession.setAttribute( \"tomcat.auth.originalLocation\",\n\t\t\t      originalLocation);\n \n\nshould be moved up, before the first of the two redirects:\n\n\t    contextM.handleStatus( req, res, 302 ); // redirect            \n\nnot before the second redirect.", "is_private": false, "bug_id": 2147, "id": 2904, "time": "2001-06-13T01:48:19Z", "creator": "mark.shotton@micromass.co.uk", "creation_time": "2001-06-13T01:48:19Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "nacho@apache.org", "text": "\n\n*** This bug has been marked as a duplicate of 2118 ***", "id": 4102, "time": "2001-07-28T12:44:30Z", "bug_id": 2147, "creation_time": "2001-07-28T12:44:30Z", "is_private": false, "attachment_id": null}]