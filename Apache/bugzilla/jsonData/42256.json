[{"count": 0, "tags": [], "creator": "sara_uppalapati@yahoo.com", "attachment_id": null, "id": 102413, "time": "2007-04-25T19:37:24Z", "bug_id": 42256, "creation_time": "2007-04-25T19:37:24Z", "is_private": false, "text": "Hi, I am trying to read an excel file that was modified on excel 2003. Getting \nbelow exceptions:\n\njava.lang.reflect.InvocationTargetException\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance\n(NativeConstructorAccessorImpl.java:39)\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance\n(DelegatingConstructorAccessorImpl.java:27)\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:274)\n        at org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java:213)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java:149)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:183)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:230)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:211)\n        at ReadInvSheet.main(ReadInvSheet.java:47)\nCaused by: org.apache.poi.hssf.record.RecordFormatException: Unknown grbit '16'\n        at org.apache.poi.hssf.record.formula.ArrayPtg.readTokenValues\n(ArrayPtg.java:98)\n        at org.apache.poi.hssf.record.formula.Ptg.createParsedExpressionTokens\n(Ptg.java:109)\n        at org.apache.poi.hssf.record.NameRecord.fillFields(NameRecord.java:739)\n        at org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n        at org.apache.poi.hssf.record.NameRecord.<init>(NameRecord.java:142)\n        ... 10 more\nError in Reading : org.apache.poi.hssf.record.RecordFormatException: Unable to \nconstruct record instance, the following exception occured: null\n\nCode snippet that is trying to read excel -\ntry\n\t    {\n\t      fs = new FileInputStream(fileToBeRead);\n\t      System.out.println(\" file read\" );\n\t      FI = new FileInputStream(propertyFile) ;\n\t      FW = new FileWriter(fileToBeWritten);\n\t    }\n\t  catch(FileNotFoundException e)\n\t    {\n\t      throw new Exception(e);\n\t    }\n\t  catch(IOException e)\n\t    {\n\t      throw new Exception(e);\n\t    }\n\t  System.out.println(\"Before HSSFWorkbook Initiation\");\n\t  HSSFWorkbook workbook = new HSSFWorkbook(fs);\n\t  System.out.println(\"After HSSFWorkbook Initiation\");\n\n\nException are right at initializing HSSFWorkbook() - HSSFWorkbook workbook = \nnew HSSFWorkbook(fs);\n\nWe are using POI_3.0_Alpha.jar. I tried test with poi-3.0-rc3-20070402.jar and \nstill have same error. \n\nI tried deleting all tabs in the excel file step by step and tried at last with \nno data also and I still have same error.\nBut when I try create empty excel on my machine(office 2000) and used it, \nprogram works fine.  \n\nCould this be the issue with office 2003 compatibility? \n\nIt is failing even with no data in the file that was created/updated on the \nmachine which has office 2003.  Since no data and no array formulas in the \nexcel file, control is still going to Ptg and ArrayPtg classes and calling \nreadTokenValues(). \n\nI will attach the spread sheet that started causing issues. Thanks."}, {"count": 1, "tags": [], "bug_id": 42256, "attachment_id": 20048, "is_private": false, "id": 102414, "time": "2007-04-25T19:48:21Z", "creator": "sara_uppalapati@yahoo.com", "creation_time": "2007-04-25T19:48:21Z", "text": "Created attachment 20048\nExcel file that caused issues even after deleting all data\n\nAfter deleting all data from the attached spreadsheet also caused same errors.\nAttached the same file. I tried save as of type excel 97-2000 also with no\nluck."}, {"count": 2, "tags": [], "creator": "marco.ghezzi@ingeniumtech.it", "text": "I have the same problem on Windows XP and Linux (Ubuntu).\nPoi version: poi-3.0.2-FINAL-20080204.jar\n\nException in thread \"main\" org.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:199)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:117)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:207)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:148)\n\tat it.ingeniumtech.test.excel.Poi.main(Poi.java:25)\nCaused by: java.lang.reflect.InvocationTargetException\n\tat sun.reflect.GeneratedConstructorAccessor5.newInstance(Unknown Source)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)\n\tat java.lang.reflect.Constructor.newInstance(Unknown Source)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:187)\n\t... 4 more\nCaused by: org.apache.poi.hssf.record.RecordFormatException: Unknown grbit '16'\n\tat org.apache.poi.hssf.record.formula.ArrayPtg.readTokenValues(ArrayPtg.java:99)\n\tat org.apache.poi.hssf.record.formula.Ptg.createParsedExpressionTokens(Ptg.java:110)\n\tat org.apache.poi.hssf.record.NameRecord.fillFields(NameRecord.java:778)\n\tat org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n\tat org.apache.poi.hssf.record.NameRecord.<init>(NameRecord.java:139)\n\t... 8 more", "id": 115008, "time": "2008-03-27T02:34:34Z", "bug_id": 42256, "creation_time": "2008-03-27T02:34:34Z", "is_private": false, "attachment_id": null}, {"text": "\n\n*** This bug has been marked as a duplicate of bug 42564 ***", "tags": [], "bug_id": 42256, "attachment_id": null, "count": 3, "id": 115019, "time": "2008-03-27T05:37:12Z", "creator": "apache@gagravarr.org", "creation_time": "2008-03-27T05:37:12Z", "is_private": false}]