[{"count": 0, "tags": [], "bug_id": 6804, "is_private": false, "text": "[ 522488 ] failed to create HSSFWorkbook\nEmail:    (?)\nDate:\n2002-02-25 07:54 Priority:\n5\nSubmitted By:\nC. Mike Davis (c_mike_davis) Assigned To:\nGlen Stampoultzis (gstamp)\nCategory:\nHSSF API Status:\nOpen\nSummary:\nfailed to create HSSFWorkbook\nWhen I execute the following code on the attached\nExcel file, I get a RecordFormatException at the\nHSSFWorkbook constructor call in the line marked with\nthe comment \"// *****\". The attached file was\noriginally a larger file, but I stripped it down\nsequentially to find the minimal example that still\nthrows the exception.\n\n\nInputStream input = null;\nBufferedInputStream buffInput = null;\nPOIFSFileSystem fs = null;\nHSSFWorkbook workbook = null;\nHSSFSheet sheet = null;\ntry {\nURL sourceURL = new URL(\"file:/d:/data/bad excel\n29.xls\");\ninput = sourceURL.openStream();\nbuffInput = new BufferedInputStream(input);\nfs = new POIFSFileSystem(buffInput);\nworkbook = new HSSFWorkbook(fs); // *****\nsheet = workbook.getSheet(\"Sheet1\");\n} catch (Throwable th) {\nth.printStackTrace();\n}\n\n\n\nMessage:\nnet.sourceforge.poi.hssf.record.RecordFormatException:\nUnable to construct record instance\n\nnet.sourceforge.poi.hssf.record.RecordFormatException:\nUnable to construct record instance\n\nat\nnet.sourceforge.poi.hssf.record.RecordFactory.createRec\nord(RecordFactory.java:271)\n\nat\nnet.sourceforge.poi.hssf.record.RecordFactory.createRec\nords(RecordFactory.java:202)\n\nat\nnet.sourceforge.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:156)\n\n...\n\nAdd A Comment:\nPlease log in!\n\nIf you cannot login, then enter your email address here:\n\nDO NOT enter passwords or confidential information in your message!\n\nFollowups:\n\nMessage\n\nDate: 2002-02-26 05:16\nSender: acoliver2\nLogged In: YES \nuser_id=287767\n\nGive me a couple days.  I'll take a look.  Make sure that\nyour workbook is not protected and that it is an Excel 97 or\nbetter workbook.  (note StarOffice 5.1 actuall generated\nmore Excel 95ish workbooks)\n\n\nAttached Files:\nName Description Download\nbad excel 29.xls minimal workbook that causes exception Download\nChanges:\n\nField Old Value Date By\nFile Added 18395: bad excel 29.xls 2002-02-25 07:54 c_mike_davis", "id": 11367, "time": "2002-03-01T21:19:18Z", "creator": "poi-support@buni.org", "creation_time": "2002-03-01T21:19:18Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 6804, "is_private": false, "text": "Fixed", "id": 11620, "time": "2002-03-10T10:45:33Z", "creator": "glens@apache.org", "creation_time": "2002-03-10T10:45:33Z", "attachment_id": null}]