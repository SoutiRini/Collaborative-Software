[{"count": 0, "text": "Using poi-3.10-FINAL\n\nWhen trying to create an instance of HSSFWorkbook, either from a POIFSFileSystem or FileInputStream I get this error sometimes.\n\nIn my experience this has only occured for .xls files which is encrypted with the option \"Protect Workbook Structure\".\n\nI've experience that this happens all the time when doing following:\n\n 1 ) Open an existing .xls file, or create a new one, either encrypted with \"Protect Workbook Structure\".\n 2 ) Save the file as a new file with different name.\n 3 ) Save the file again as new file with different name. (For every file you does this with, will cause an error as shown below)\n\nBe aware if you reopen the file from step 3, and saves as a new file with different name, this file will not cause an error.\n\nHope it is understandable.\n\nStacktrace:\norg.apache.poi.hssf.record.RecordFormatException: Unknown encryption info 4\n\tat org.apache.poi.hssf.record.FilePassRecord.<init>(FilePassRecord.java:70)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:526)\n\tat org.apache.poi.hssf.record.RecordFactory$ReflectionConstructorRecordCreator.create(RecordFactory.java:87)\n\tat org.apache.poi.hssf.record.RecordFactory.createSingleRecord(RecordFactory.java:338)\n\tat org.apache.poi.hssf.record.RecordFactoryInputStream$StreamEncryptionInfo.<init>(RecordFactoryInputStream.java:65)\n\tat org.apache.poi.hssf.record.RecordFactoryInputStream.<init>(RecordFactoryInputStream.java:182)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:477)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:301)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:264)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:199)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:181)", "bug_id": 56564, "is_private": false, "id": 175455, "time": "2014-05-26T08:00:17Z", "creator": "almas.kristoffer@gmail.com", "creation_time": "2014-05-26T08:00:17Z", "tags": [], "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 56564, "text": "\n\n*** This bug has been marked as a duplicate of bug 35897 ***", "id": 175456, "attachment_id": null, "creator": "apache@gagravarr.org", "creation_time": "2014-05-26T09:04:11Z", "time": "2014-05-26T09:04:11Z", "is_private": false}]