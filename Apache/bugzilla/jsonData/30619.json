[{"count": 0, "tags": [], "text": "I have a <macrodef/> to easily create fileset- and path-references so that they \ncan be used all over my project in various buildfiles.\n\nHowever, a reference created by/in such a macro, is lost as soon as the \nbuildprocess leaves the context of the calling target:\n\n  <macrodef name=\"create-refs\">\n    <attribute name=\"filelist\"/>\n    <attribute name=\"reference\"/>\n    <sequential>\n      <path id=\"@{reference}.path\">\n        <fileset dir=\"${lib.dir}\" includes=\"@{filelist}\" id=\"@{reference}.fs\"/>\n      </path>\n      <echo level=\"info\" message=\"Created references '@{reference}.path' and \n'@{reference}.fs'.\"/>\n    </sequential>\n  </macrodef>\n\nCalling this macro and displaying its contents within the same target is ok:\n\n  <target name=\"create-references\">\n    <create-refs filelist=\"${test.filelist}\" reference=\"test\"/>\n    <echorefs refid=\"test.path\"/>\n  </target>\n\nyields:\n\ncreate-references:\n     [echo] Created references: 'test.fs' and 'test.path'.\n     [echo] Reference test.fs consists of sample.jar from C:\\projects\\sample\\lib \n\nHowever, trying to display its content from the parent target gives an error \n(note that 'init' is dependent on 'create-references'):\n\ninit:\n\ncreate-references:\n     [echo] Created references: 'test.fs' and 'test.path'.\n     [echo] Reference test.fs consists of sample.jar from C:\\projects\\sample\\lib \n\nBUILD FAILED\nC:\\projects\\sample\\dependencies.xml:198: The following error occurred while \nexecuting this line:\nC:\\projects\\sample\\dependencies.xml:23: Reference test.fs not found.", "attachment_id": null, "id": 61897, "creator": "dylan@van-iersel.org", "time": "2004-08-12T15:33:55Z", "bug_id": 30619, "creation_time": "2004-08-12T15:33:55Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 30619, "is_private": false, "id": 61902, "attachment_id": null, "creator": "peter.reilly@corvil.com", "creation_time": "2004-08-12T15:56:10Z", "time": "2004-08-12T15:56:10Z", "text": "Can you provide a full (and small) build.xml that\nshows this problem\n"}, {"count": 2, "attachment_id": null, "bug_id": 30619, "text": "Hmm, another inspection shows that I used an <antcall/> to create the \nreferences. This is ofcourse the problem as the references are gone as soon as \nthe <antcall/> finishes. Having the references created by a dependent target \ncorrects the problem.", "id": 62031, "time": "2004-08-16T09:19:48Z", "creator": "dylan@van-iersel.org", "creation_time": "2004-08-16T09:19:48Z", "tags": [], "is_private": false}, {"count": 3, "attachment_id": null, "bug_id": 30619, "text": "Thanks for the follow up.", "id": 62032, "time": "2004-08-16T09:38:04Z", "creator": "peterreilly@apache.org", "creation_time": "2004-08-16T09:38:04Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 30619, "is_private": false, "id": 62041, "attachment_id": null, "creator": "mbenson@apache.org", "creation_time": "2004-08-16T14:04:15Z", "time": "2004-08-16T14:04:15Z", "text": "Changing from WONTFIX to INVALID"}]