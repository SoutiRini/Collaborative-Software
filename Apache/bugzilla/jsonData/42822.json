[{"attachment_id": null, "tags": [], "bug_id": 42822, "text": "It is not currently possible to use entity references in JSP Documents in a\nreasonable way.  A JSP such as this:\n\n<jsp:root\n version='2.0'\n xmlns:jsp='http://java.sun.com/JSP/Page'>\n\n  <html>\n    <head>\n      <title>The test page</title>\n    </head>\n    <body>\n      And here it is:&nbsp;\n    </body>\n  </html>\n</jsp:root>\n\nwill quite naturally fail to parse.  But while one might expect to be able to\ninclude a doctype declaration with an appropriate entity decl, that doesn't work\n either.  That is, if you try\n\n<!DOCTYPE jsp:root \n[\n  <!ENTITY nbsp \"&#160;\" >\n]>\n<jsp:root\n version='2.0'\n xmlns:jsp='http://java.sun.com/JSP/Page'>\n\n  ... &nbsp; ...\n</jsp:root>\n\nJasper says: Element type \"jsp:root\" must be declared.\n\nThis is apparently because Jasper's parser turns on validation when it sees any\nsort of DTD at all (see JspDocumentParser:1413), and since there's no external\nDTD provided all elements are going to fail validation.\n\nI can see the logic here, but it seems to go too far.  It is not necessarily the\ncase that if I've provided a DTD, I want validation.  Entity resolution can\nhappen w/o validation, so all that needs to happen is to allow the parse to\ncontinue in non-validating mode.\n\nI gather that the \"solution\" is to not actually use entity references, but\ninstead to use something like &amp;nbsp; and let the browser resolve the\n\"reference\".  I find this confusing, to say the least.", "count": 0, "id": 105121, "time": "2007-07-05T15:15:51Z", "creator": "jdane@hawaii.edu", "creation_time": "2007-07-05T15:15:51Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 42822, "is_private": false, "count": 1, "id": 105228, "time": "2007-07-09T15:27:19Z", "creator": "jdane@hawaii.edu", "creation_time": "2007-07-09T15:27:19Z", "text": "I see now that JSP requires validation where a DOCTYPE is present.  JSP2.0\nsection 6.2.4.  This still seems wrong to me, but I can't fault Tomcat for\nfollowing the spec.  So it goes.   I will have to find or fake a DTD, or give up\non the idea of using JSP Documents.\n\n\n"}, {"attachment_id": null, "tags": [], "bug_id": 42822, "text": "oops.  this was meant to be resolved INVALID in the last comment.", "count": 2, "id": 105229, "time": "2007-07-09T15:27:58Z", "creator": "jdane@hawaii.edu", "creation_time": "2007-07-09T15:27:58Z", "is_private": false}]