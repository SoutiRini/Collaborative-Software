[{"count": 0, "tags": [], "creator": "lucabilli@grupposervizi.it", "attachment_id": null, "text": "I'm using jakarta-poi-1.9.0-dev-20030122.\nIf I create a workbook containing formulas and then I try to call \ncell.getNumericCellValue on formula cells, returns 0.0\n(the same happens if I save the workbook on disk and then I read it again with \nPOI)\nIf I open such a workbook with Excel2000, it works, but when I try to close the \ndocument (without any manual change), Excel prompts me with a question: \"Do you \nwant to save the changes you made to POI.xls? Microsoft Excel recalculates \nformulas when opening files last saved by an earlier version of Excel\".\nNow, if I say \"yes\", and I read the newly saved workbook with POI, the \ncell.getNumericCellValue on formula cells returns the correct value.\n\nHere I put a short Java code presenting the problem, then I will attach two \nvery simple xls (POI.xls and Excel.xls), the first created with POI and \ncontaining a formula cell that is not calculated by POI when asked to, the \nlatter is the Excel saved version of the same workbook (it is quite bigger than \nthe original).\n\nHSSFWorkbook wb = new HSSFWorkbook();\nHSSFSheet sh = wb.createSheet(\"Sheet\");\nHSSFRow row = sh.createRow((short) 0);\nHSSFCell cell = row.createCell((short) 0);\ncell.setCellValue(3.18);\ncell = row.createCell((short) 1);\ncell.setCellFormula(\"A1\");\n//wb.write(new FileOutputStream(\"POI.xls\"));\n//wb = new HSSFWorkbook(new FileInputStream(\"POI.xls\"));\n//cell = wb.getSheet(\"Sheet\").getRow(0).getCell((short) 1);\nSystem.out.println(cell.getCellFormula());\nSystem.out.println(cell.getNumericCellValue());\n\nThis prints out:\n\nA1\n0.0\n\nThe same happens if you uncomment the three commented lines\n\nBy the way, since I know that formulas are under development, today I wanted to \ndownload the last nightly release before submitting this bug, but I found the \nnightly directory is empty ...", "id": 31106, "time": "2003-02-12T09:28:56Z", "bug_id": 16985, "creation_time": "2003-02-12T09:28:56Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 16985, "text": "Created attachment 4823\nPOI-created workbook", "id": 31107, "time": "2003-02-12T09:30:43Z", "creator": "lucabilli@grupposervizi.it", "creation_time": "2003-02-12T09:30:43Z", "is_private": false, "attachment_id": 4823}, {"count": 2, "text": "Created attachment 4824\nExcel-saved workbook", "creator": "lucabilli@grupposervizi.it", "attachment_id": 4824, "id": 31108, "time": "2003-02-12T09:31:10Z", "bug_id": 16985, "creation_time": "2003-02-12T09:31:10Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 16985, "text": "I am sorry it took so long to respond, but for some reason this has slipped\nunder, and I hadnt read the bug report properly. What you describe is NOT a bug.\nThere is no calculation engine in POI. POI just puts the formula in the workbook\nin a format that excel understands. It does NOT do any calculation. When you\nopen the file in excel, it is excel that calculates the result and stores in the\nfile. POI can only then read the value. \n\nHope this explains how things work. If not, please continue to discuss this on\nthe  mailing lists, where we will be glad to help. ", "id": 46312, "time": "2003-10-27T13:57:43Z", "creator": "avik@apache.org", "creation_time": "2003-10-27T13:57:43Z", "is_private": false, "attachment_id": null}]