[{"count": 0, "tags": [], "creator": "martin.studer@mirai-solutions.com", "attachment_id": null, "is_private": false, "id": 139799, "time": "2010-09-10T05:27:01Z", "bug_id": 49907, "creation_time": "2010-09-10T05:27:01Z", "text": "Consider the following code:\n\nWorkbook wb = new HSSFWorkbook();\nwb.createName();\nwb.createName();\n\nThis fails for HSSF with the following error message:\n\"You are trying to assign a duplicated name record: \"\n\nFor XSSFWorkbook's there is no problem.\n\n\nIt's not quite clear to me which behaviour is more appropriate...\n\nPOI: 3.7-build2\nOS: Windows 7 64-bit\nJava: 1.6.0_20 64-bit"}, {"count": 1, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "is_private": false, "id": 139826, "time": "2010-09-11T08:48:30Z", "bug_id": 49907, "creation_time": "2010-09-11T08:48:30Z", "text": "Strictly speaking your code snippet does not make sense. Name's name and formula MUST be set, otherwise Excel will complain on unreadable content.  \n\nHowever, it should be possible to create two consecutive names and initialize them later:\n\nWorkbook wb = new HSSFWorkbook(); //or new XSSFWorkook()\nName name1 = wb.createName();\nName name2 = wb.createName();\n\nname1.setNameName(\"sale_1\");\nname1.setRefersToFormula(1);\n\nname2.setNameName(\"sale_2\");\nname2.setRefersToFormula(2);\n\n\nThe following code works in XSSF but fails in HSSF - checking uniqueness of names in HSSF is too aggressive. Both should allow creating a pool of names and initialize them later. \n\nI committed the fix in r996136. \n\nThanks,\nYegor"}]