[{"count": 0, "tags": [], "creator": "apache-b6e@deemzed.uk", "attachment_id": 30531, "text": "Created attachment 30531\nMake request_rec information available to htaccess error logging\n\nError logging for .htaccess is missing request information.\n\nThis information is not available to ErrorLogFormat as the request_rec is not passed in (for example, on vhost aliasing, %V cannot find the request host and so makes determining where an error was generated impossible)\n\nAs part of the changes for PR 52439, the very common .htaccess errors AH02295 and AH02296 are now logged locally inside invoke_cmd and ap_walk_config_sub. Since no associated request_rec is available, these are logged using ap_log_perror().\n\nOne possible solution is to add the request_rec to cmd_parms and use ap_log_rerror() when available. However, as this changes the API it may not be desirable. I've attached a rough patch demonstrating this workaround.\n\nExample:\n\nErrorLogFormat \"%-V [%{c}t] [%-m:%l] %7F: %E: [client\\ %a] %M% ,\\ referer\\ %{Referer}i\"\"\n\nBefore:\n\n- [2013-07-03 00:46:02] [core:warn] AH02295: Options in .htaccess forbidden by AllowOverride\n\nAfter:\n\nsomedomain.com [2013-07-03 14:47:56] [core:warn] [client X.X.X.X:Y] AH02295: Options in .htaccess forbidden by AllowOverride, referer http://somedomain.com/somefile.html", "id": 168258, "time": "2013-07-03T13:53:00Z", "bug_id": 55192, "creation_time": "2013-07-03T13:53:00Z", "is_private": false}]