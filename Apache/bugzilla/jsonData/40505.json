[{"count": 0, "tags": [], "bug_id": 40505, "attachment_id": null, "is_private": false, "id": 93560, "time": "2006-09-14T06:20:33Z", "creator": "e_christov@hotmail.com", "creation_time": "2006-09-14T06:20:33Z", "text": "Hallo,\n\ni have written the following code trying to access excel files (read and write):\n\nURL url = new URL(\"file:/c:/Arbeit/Termine.xls\");\nURLConnection uc = url.openConnection();\nPOIFSFileSystem fis = new POIFSFileSystem(uc.getInputStream());\nHSSFWorkbook hssfworkbook = new HSSFWorkbook(fis);\n\nWhen using it in an java application it works fine. \nThen I put this line of code within an appplet, then I had signed the applet \n(in order to be allowed to read and write files on the hard disk). \nUnfortunately the last line of code, namely \"HSSFWorkbook hssfworkbook = new \nHSSFWorkbook(fis);\" still throw the following exception:\njava.lang.ExceptionInInitializerError\n  at java.lang.Class.forName0(Native Method)\n  at java.lang.Class.forName(Class.java:141)\n  at org.apache.poi.hssf.record.RecordFactory.class$(RecordFactory.java:50)\n  at org.apache.poi.hssf.record.RecordFactory.<clinit>(RecordFactory.java:48)\n  at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:163)\n  .........\nCaused by: java.security.AccessControlException: access denied \n(java.util.PropertyPermission poi.deserialize.escher read)\nat\njava.security.AccessControlContext.checkPermission(AccessControlContext.java:269)\nat java.security.AccessController.checkPermission(AccessController.java:401)\nat java.lang.SecurityManager.checkPermission(SecurityManager.java:524)\nat java.lang.SecurityManager.checkPropertyAccess(SecurityManager.java:1276)\nat java.lang.System.getProperty(System.java:573)\nat\norg.apache.poi.hssf.record.AbstractEscherHolderRecord.<clinit>(AbstractEscherHolderRecord.java:40)\n\t... 19 more\n\nI have solved the problem as I wrote the following line of code into the \njava.policy file: \npermission java.util.PropertyPermission \"poi.deserialize.escher\", \"read\";\n\nNow it works fine, but when another person in the web use my applet I can't \nassume that he (or she) has the same line of code in the java.policy file.\n\nMy question: how should I handle this kind of error, without having to write \ninto the java.policy file. Is this a HSSFWorkbook-bug?\n\nThanks\n\nEvgeniy Hristov"}, {"count": 1, "tags": [], "bug_id": 40505, "text": "If the JVM is telling POI that it can't read that property, the best POI could\nhope to do is catch it and assume that it's not set.\n\nBut you can work around this by signing the POI jar files, so I don't see this\nas a major issue.\n", "id": 96135, "time": "2006-11-23T20:08:50Z", "creator": "trejkaz@trypticon.org", "creation_time": "2006-11-23T20:08:50Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 40505, "attachment_id": null, "is_private": false, "id": 101949, "time": "2007-04-19T10:29:55Z", "creator": "yegor@dinom.ru", "creation_time": "2007-04-19T10:29:55Z", "text": "Not a POI bug.\n\nRegards,\nYegor"}]