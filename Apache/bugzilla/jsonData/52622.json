[{"count": 0, "attachment_id": null, "bug_id": 52622, "text": "We use poi excel xssf usermodel to create a excel2007 xlsx file,then we use xssf eventmodel to read it,the ooxml xml content is not right.When we read the file with SAX Handler(startElement,endElement,characters and so on),we find the XML content is only like that:\n<sst><si><t>content</t></si><si><t>content2</t></si><si><t>content3</t></si></sst>\nSo we can't process it using OOXML\u3000specification\uff0eBut if the file is created without using POI,it is ok,the xml content is right.\n\nNB:if we make some mistakes when write xml or read xml,please show,thanks in advance,we see the testcases for eventmodel,we use it like that.", "id": 153567, "time": "2012-02-08T03:58:43Z", "creator": "dmxiaolan@163.com", "creation_time": "2012-02-08T03:58:43Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "text": "Which version of POI? \n\nI don't quite understand what's wrong. Please post sample code that demonstrates what's wrong:\n 1. code that generates a .xlsx file with the XSSF usermodel API\n 2. code that reads the created file using SAX. \n\n\n\nYegor", "is_private": false, "bug_id": 52622, "id": 153570, "time": "2012-02-08T08:15:30Z", "creator": "yegor@dinom.ru", "creation_time": "2012-02-08T08:15:30Z", "attachment_id": null}, {"count": 2, "tags": [], "text": "Created attachment 28282\nthe code for creating xlsx file\n\nuse the code to create file,the poi version is poi-3.7-20101029.then you can read it using event sax,you will find the problem.", "is_private": false, "bug_id": 52622, "id": 153573, "time": "2012-02-08T08:36:24Z", "creator": "dmxiaolan@163.com", "creation_time": "2012-02-08T08:36:24Z", "attachment_id": 28282}, {"count": 3, "tags": [], "text": "Try with the latest POI-3.8-beta5. \nMany bugs have been fixed since POI-3.7 including fixes in the XSSF usermodel API.\n\nYegor", "is_private": false, "bug_id": 52622, "id": 153574, "time": "2012-02-08T08:38:44Z", "creator": "yegor@dinom.ru", "creation_time": "2012-02-08T08:38:44Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "dmxiaolan@163.com", "text": "My reading code like that:\nOPCPackage pkg = OPCPackage.open(filename);\nXSSFReader r = new XSSFReader(pkg);\nSharedStringsTable sst = r.getSharedStringsTable();\nXMLReader parser = fetchSheetParser(sst);\n// how to by sheet name?\nInputStream sheet2 = r.getSheet(\"rId1\");\nInputSource sheetSource = new InputSource(sheet2);\nparser.parse(sheetSource);\nsheet2.close();\nreturn resultSet;\n\npublic XMLReader fetchSheetParser(SharedStringsTable sst) throws SAXException {\nXMLReader parser =\nXMLReaderFactory.createXMLReader(\"org.apache.xerces.parsers.SAXParser\");\nContentHandler handler = new SAXSheetHandler(sst);\nparser.setContentHandler(handler);\nreturn parser;\n}", "id": 153575, "time": "2012-02-08T08:59:38Z", "bug_id": 52622, "creation_time": "2012-02-08T08:59:38Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "dmxiaolan@163.com", "attachment_id": 28284, "text": "Created attachment 28284\nthe poi example file\n\nI think i make some mistake.\nBecause i use the poi example code in the newest poi version to read the previous xlsx file,it is ok.I compare the codes and find some differences:\nthe poi example use like that:\nReadOnlySharedStringsTable strings = new ReadOnlySharedStringsTable(this.xlsxPackage);\ni guess it is a important thing,can you tell me why,show me the right usecase of construct the event sax context,and show me something that i need to notice.\n\nNB:no change the poi version,", "id": 153577, "time": "2012-02-08T09:08:08Z", "bug_id": 52622, "creation_time": "2012-02-08T09:08:08Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 52622, "text": "please notice that: my wrong code can read the xlsx file without using poi.Thanks in advance.", "id": 153578, "time": "2012-02-08T09:12:23Z", "creator": "dmxiaolan@163.com", "creation_time": "2012-02-08T09:12:23Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 52622, "text": "no support the handler code,because i make sure that it is not important for the issue.", "id": 153579, "time": "2012-02-08T09:14:33Z", "creator": "dmxiaolan@163.com", "creation_time": "2012-02-08T09:14:33Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "creator": "dmxiaolan@163.com", "attachment_id": null, "text": "also i test it with the newest poi-bin-3.8-beta5-20111217.zip,the same action with the 3.7", "id": 153580, "time": "2012-02-08T09:25:24Z", "bug_id": 52622, "creation_time": "2012-02-08T09:25:24Z", "is_private": false}, {"count": 9, "tags": [], "text": "really look forward your reply.Thanks.", "is_private": false, "bug_id": 52622, "id": 153582, "time": "2012-02-08T09:40:36Z", "creator": "dmxiaolan@163.com", "creation_time": "2012-02-08T09:40:36Z", "attachment_id": null}, {"count": 10, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "text": "I still don't see anything wrong with POI. \n\nThe attached Java program creates a sheet with two cells: A1 with a string value \"a\" and B1 with a string value \"b\". \n\nXLSX2CSV  is based on the event model and can process this file without problems.\nThe console output:\n\nsheet1 [index=0]:\n\"a\",\"b\"\n \nPlease confirm that you observe the same results.\n\nThe second code snippet is not complete and I cannot compile and verify it. Please post full code and describe what values you expect to see in the output, what is missing, etc. \n\nYou said that files created in Excel 2007 are processed OK. Please attach two sample files:  one created by POI and the other created in Excel 2007 and which is read OK by your program. \n\nYegor", "id": 153618, "time": "2012-02-09T07:46:40Z", "bug_id": 52622, "creation_time": "2012-02-09T07:46:40Z", "is_private": false}, {"count": 11, "tags": [], "bug_id": 52622, "text": "This is ok,and it is my mistake,now you can close it.thanks very much.", "id": 162859, "time": "2012-10-22T01:13:17Z", "creator": "dmxiaolan@163.com", "creation_time": "2012-10-22T01:13:17Z", "is_private": false, "attachment_id": null}, {"count": 12, "tags": [], "bug_id": 52622, "text": "closed based on the previous comment", "id": 169131, "time": "2013-08-05T12:34:16Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2013-08-05T12:34:16Z", "is_private": false, "attachment_id": null}]