[{"count": 0, "tags": [], "bug_id": 8429, "text": "The SQLTask has severall methods that are usefull for any JDBC related task.  I\nhave written several in the past. (see http://chalktools.sourceforge.net).  \nI have a patch that makes SQLTask a subclass of JDBCTask which handles\nclasspath\nuserid\nURL\nautocommit\nrdbms\nversion\ndriver\ncaching (drivers and loaders)\n\nJDBCTask provides a protected method getConnection that returns a new\nconnection. from the supplied properties.", "id": 14492, "time": "2002-04-23T18:57:34Z", "creator": "nick@chalko.com", "creation_time": "2002-04-23T18:57:34Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 8429, "text": "Created attachment 1667\nPatch adding JDBCTask as superclass for SQLTask", "id": 14493, "time": "2002-04-23T18:59:01Z", "creator": "nick@chalko.com", "creation_time": "2002-04-23T18:59:01Z", "is_private": false, "attachment_id": 1667}, {"count": 2, "tags": [], "creator": "jakarta@ehatchersolutions.com", "attachment_id": null, "is_private": false, "id": 14497, "time": "2002-04-23T19:10:28Z", "bug_id": 8429, "creation_time": "2002-04-23T19:10:28Z", "text": "Please resubmit your patch in 'diff -u' format.  Looks worthwhile to make it \ninto Ant 1.5 so hurry!"}, {"count": 3, "attachment_id": 1668, "bug_id": 8429, "is_private": false, "id": 14499, "time": "2002-04-23T19:15:13Z", "creator": "nick@chalko.com", "creation_time": "2002-04-23T19:15:13Z", "tags": [], "text": "Created attachment 1668\nJDBCTask patch in Unified format"}, {"count": 4, "tags": [], "creator": "jakarta@ehatchersolutions.com", "is_private": false, "id": 14509, "attachment_id": null, "bug_id": 8429, "creation_time": "2002-04-23T19:47:40Z", "time": "2002-04-23T19:47:40Z", "text": "Did you run the SQLExecTest case?  I get a failure after applying your patch:\n\nC:\\jakarta\\jakarta-ant>build run-single-test -Dtestcase=org.apache.tools.ant.tas\nkdefs.SQLExecTest\nBuildfile: build.xml\n\nprepare:\n\ncheck_for_optional_packages:\n\nbuild:\nCreated dir: C:\\jakarta\\jakarta-ant\\build\\classes\nCompiling 456 source files to C:\\jakarta\\jakarta-ant\\build\\classes\nNote: Some input files use or override a deprecated API.\nNote: Recompile with -deprecation for details.\nCopying 4 files to C:\\jakarta\\jakarta-ant\\build\\classes\nCopying 2 files to C:\\jakarta\\jakarta-ant\\build\\classes\nCopying 2 files to C:\\jakarta\\jakarta-ant\\build\\classes\\org\\apache\\tools\\ant\\tas\nkdefs\\optional\\junit\\xsl\n\ncompile-tests:\nCreated dir: C:\\jakarta\\jakarta-ant\\build\\testcases\nCompiling 137 source files to C:\\jakarta\\jakarta-ant\\build\\testcases\nNote: Some input files use or override a deprecated API.\nNote: Recompile with -deprecation for details.\n\nrun-single-test:\nTestsuite: org.apache.tools.ant.taskdefs.SQLExecTest\nTests run: 2, Failures: 0, Errors: 2, Time elapsed: 0.01 sec\n\nTestcase: testDriverCaching took 0.01 sec\n        Caused an ERROR\ntry to access method org.apache.tools.ant.taskdefs.JDBCTask.getLoaderMap()Ljava/\nutil/Hashtable; from class org.apache.tools.ant.taskdefs.SQLExecTest\njava.lang.IllegalAccessError: try to access method org.apache.tools.ant.taskdefs\n.JDBCTask.getLoaderMap()Ljava/util/Hashtable; from class org.apache.tools.ant.ta\nskdefs.SQLExecTest\n        at org.apache.tools.ant.taskdefs.SQLExecTest.setUp(SQLExecTest.java:100)\n\nAlso, you modified the accessibility of 'caching' member variable.  We cannot \nbreak backwards compatibility, so please be careful with such things.  I didn't \ncheck for other such modifications that you may have made.  Let us know when \nyou have fixed the test case and have had a look at any backwards compatibility \nissues that may have been introduced."}, {"count": 5, "tags": [], "bug_id": 8429, "text": "Actually it looks like making 'caching' private is ok, since it was only added \nafter 1.4.1.", "id": 14512, "time": "2002-04-23T19:55:41Z", "creator": "jakarta@ehatchersolutions.com", "creation_time": "2002-04-23T19:55:41Z", "is_private": false, "attachment_id": null}, {"count": 6, "attachment_id": null, "bug_id": 8429, "is_private": false, "id": 14535, "time": "2002-04-23T22:07:25Z", "creator": "nick@chalko.com", "creation_time": "2002-04-23T22:07:25Z", "tags": [], "text": "I did not run the test Sorry.\nI see the error.  I will release a new patch soon."}, {"count": 7, "tags": [], "text": "Created attachment 1674\nabstract JDBCTask with SQLExecTest changes.", "attachment_id": 1674, "id": 14549, "creation_time": "2002-04-23T22:35:05Z", "time": "2002-04-23T22:35:05Z", "creator": "nick@chalko.com", "bug_id": 8429, "is_private": false}, {"count": 8, "tags": [], "creator": "nick@chalko.com", "attachment_id": null, "text": "I was unable to run the test from the command line (Missing the\norg.apache.tools.ant.listener.CommonsLoggingListener)  I will keep trying.\nBut the SQLExecTest runs fine from my ide (eclipse M5) now.", "id": 14553, "time": "2002-04-23T22:36:45Z", "bug_id": 8429, "creation_time": "2002-04-23T22:36:45Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 8429, "text": "I'm not comfortable applying this change if it requires a change to the the \ntest case.  That means its breaking some level of API compatibility.  Please re-\nwork your change such that the test case runs as it was before and then it can \nbe applied.  Sorry - just too risky.  If another committer wants to jump in and \napply thats fine - I just don't feel comfortable with it.", "id": 14566, "time": "2002-04-23T23:17:46Z", "creator": "jakarta@ehatchersolutions.com", "creation_time": "2002-04-23T23:17:46Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "text": "Are you sure the SQLExecTest passes before my changes.  I rolled by my changes\ndid a build clean and a \nbuild run-single-test -Dtestcase=org.apache.tools.ant.tskdefs.SQLExecTest\n\nand still got \n\nTestcase: testDriverCachingTestcase: testNull took 0 sec\n        Caused an ERROR\ntry to access method org.apache.tools.ant.taskdefs.SQLExec.getLoaderMap()Ljava/u\ntil/Hashtable; from class org.apache.tools.ant.taskdefs.SQLExecTest\njava.lang.IllegalAccessError: try to access method org.apache.tools.ant.taskdefs\n.SQLExec.getLoaderMap()Ljava/util/Hashtable; from class org.apache.tools.ant.tas\nkdefs.SQLExecTest\n        at org.apache.tools.ant.taskdefs.SQLExecTest.setUp(SQLExecTest.java:100)\n", "attachment_id": null, "id": 14763, "creation_time": "2002-04-25T17:27:58Z", "time": "2002-04-25T17:27:58Z", "creator": "nick@chalko.com", "bug_id": 8429, "is_private": false}, {"count": 11, "tags": [], "text": "Digging deeper I see that it works if you set junit.fork=true - have a look at \nAnt's build.xml for the SQLExecTest and the conditional exclusion of it during \nthe main test runs.  I've re-applied your original unified diff patch and the \ntests run.  I apologize for the false alarm.  I'll commit them shortly.", "attachment_id": null, "bug_id": 8429, "id": 14808, "time": "2002-04-26T00:20:13Z", "creator": "jakarta@ehatchersolutions.com", "creation_time": "2002-04-26T00:20:13Z", "is_private": false}, {"count": 12, "tags": [], "creator": "bodewig@apache.org", "text": "*** Bug 7105 has been marked as a duplicate of this bug. ***", "id": 26275, "attachment_id": null, "bug_id": 8429, "creation_time": "2002-11-14T15:12:41Z", "time": "2002-11-14T15:12:41Z", "is_private": false}]