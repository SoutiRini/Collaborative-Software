[{"count": 0, "attachment_id": null, "bug_id": 53754, "is_private": false, "id": 161558, "time": "2012-08-21T13:42:33Z", "creator": "rubinov702@mail.ru", "creation_time": "2012-08-21T13:42:33Z", "tags": [], "text": "The following code causes NullPointerException in a normal javac task scenario:\n\n@Test\npublic void testJavac() throws Exception {\n    Javac javac = new Javac();\n    Project project = new Project();\n    project.init();\n    javac.setProject(project);\n    javac.createCompilerArg();\n    javac.setFork(true);\n    javac.getCurrentCompilerArgs(); //NPE occurs\n}\n\nIt is also reproducible with the simple build using <compilerarg/>:\n\n<project name=\"project\" default=\"all\" basedir=\".\">\n    <target name=\"all\">\n        <javac srcdir=\"./src\" destdir=\"./buildbug\" fork=\"true\">\n            <compilerarg/>\n        </javac>\n    </target>\n</project>      \n\n\nThe stack trace:\n\nBUILD FAILED\n/buildproject.xml:5: java.lang.NullPointerException\n\tat org.apache.tools.ant.util.facade.FacadeTaskHelper.getArgs(FacadeTaskHelper.java:134)\n\tat org.apache.tools.ant.taskdefs.Javac.getCurrentCompilerArgs(Javac.java:748)\n\tat org.apache.tools.ant.taskdefs.compilers.DefaultCompilerAdapter.addCurrentCompilerArgs(DefaultCompilerAdapter.java:550)\n\tat org.apache.tools.ant.taskdefs.compilers.DefaultCompilerAdapter.setupJavacCommandlineSwitches(DefaultCompilerAdapter.java:328)\n\tat org.apache.tools.ant.taskdefs.compilers.DefaultCompilerAdapter.setupModernJavacCommandlineSwitches(DefaultCompilerAdapter.java:340)\n\tat org.apache.tools.ant.taskdefs.compilers.JavacExternal.execute(JavacExternal.java:49)\n\tat org.apache.tools.ant.taskdefs.Javac.compile(Javac.java:1134)\n\tat org.apache.tools.ant.taskdefs.Javac.execute(Javac.java:912)\n\tat org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)\n\tat org.apache.tools.ant.Task.perform(Task.java:348)\n\tat org.apache.tools.ant.Target.execute(Target.java:390)\n\tat org.apache.tools.ant.Target.performTasks(Target.java:411)\n\tat org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)\n\tat org.apache.tools.ant.Project.executeTarget(Project.java:1368)\n\tat org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n\tat org.apache.tools.ant.Project.executeTargets(Project.java:1251)\n\tat org.apache.tools.ant.Main.runBuild(Main.java:809)\n\tat org.apache.tools.ant.Main.startAnt(Main.java:217)\n\tat org.apache.tools.ant.launch.Launcher.run(Launcher.java:280)\n\tat org.apache.tools.ant.launch.Launcher.main(Launcher.java:109)\n\n\nAnt version:\n\nApache Ant(TM) version 1.8.2 compiled on May 16 2012\nDetected Java version: 1.6 in: /System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home\nDetected OS: Mac OS X\n\nAfter some investigation I assume that the failing sequence is due to:\n\nFacadeTaskHelper.getArgs() uses ImplementationSpecificArgument.getParts() -> Commandline.Argument.getParts(), that returns null\nand FacadeTaskHelper.getArgs() fails to handle the null value."}, {"count": 1, "attachment_id": null, "bug_id": 53754, "is_private": false, "id": 172071, "time": "2014-01-04T15:31:36Z", "creator": "bodewig@apache.org", "creation_time": "2014-01-04T15:31:36Z", "tags": [], "text": "well, a compilerarg without value or line attribute is not exactly a \"normal javac task scenario\".  Added a null-guard with svn revision 1555356"}]