[{"count": 0, "attachment_id": null, "creator": "holger.sunke@bodo-peters.de", "is_private": false, "id": 148126, "time": "2011-07-25T13:22:52Z", "bug_id": 51550, "creation_time": "2011-07-25T13:22:52Z", "tags": [], "text": "IllegalStateException for \"Too many active Sessions\" error on createSession(..) sometines results in empty response with HTTP 200 OK status instead of an error message.\n\nI saw this happening when tomcat trys to create session #(n+1) for a protected area with FORM based authentication and SessionManager with maxActiveSessions=n, not depending on whether StandardManager or PersistentManager is beeing used.\n\nReproduction:\n\n1) Add webbapps/examples/META-INF/context.xml with following content:\n<Context>\n        <Manager className=\"org.apache.catalina.session.StandardManager\"\n\t\t maxActiveSessions=\"1\">\n\t</Manager>\n</Context>\n\n2) Restart Tomcat\n3) Visit http://localhost:8080/examples/jsp/security/protected/\n4) Clear cookies in your browser\n5) repeat step 3).\n\nResult:\nHTTP/1.1 200 OK\nServer: Apache-Coyote/1.1\nCache-Control: private\nExpires: Thu, 01 Jan 1970 01:00:00 CET\nTransfer-Encoding: chunked\nDate: Mon, 25 Jul 2011 13:20:56 GMT\n\nExpected Result:\nHTTP/1.1 500 OK\nServer: Apache-Coyote/1.1\n[...]"}, {"count": 1, "tags": [], "bug_id": 51550, "text": "Thanks for the report and the steps to reproduce the error.\n\nI have fixed this in 7.0.x and it will be included in 7.0.20 onwards.", "id": 148146, "time": "2011-07-25T19:45:29Z", "creator": "markt@apache.org", "creation_time": "2011-07-25T19:45:29Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "holger.sunke@bodo-peters.de", "text": "Thank you.\n\nWhat I forgot to mention is, that this issue also hits Tomcat 6. Maybe you'd check older versions too.", "id": 148156, "time": "2011-07-26T06:02:33Z", "bug_id": 51550, "creation_time": "2011-07-26T06:02:33Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 51550, "attachment_id": null, "is_private": false, "id": 148158, "time": "2011-07-26T07:17:59Z", "creator": "markt@apache.org", "creation_time": "2011-07-26T07:17:59Z", "text": "Re-open to fix older versions"}, {"count": 4, "tags": [], "text": "Created attachment 27316\nProposed patch for Tomcat 6 v1", "is_private": false, "bug_id": 51550, "id": 148163, "time": "2011-07-26T08:00:14Z", "creator": "markt@apache.org", "creation_time": "2011-07-26T08:00:14Z", "attachment_id": 27316}, {"count": 5, "tags": [], "bug_id": 51550, "attachment_id": 27317, "text": "Created attachment 27317\nProposed patch for Tomcat 5 v1", "id": 148164, "time": "2011-07-26T08:00:31Z", "creator": "markt@apache.org", "creation_time": "2011-07-26T08:00:31Z", "is_private": false}, {"count": 6, "tags": [], "text": "Created attachment 27318\nProposed patch for Tomcat 6 v2\n\nRemoves additional fixes from patch", "is_private": false, "bug_id": 51550, "id": 148165, "time": "2011-07-26T08:02:17Z", "creator": "markt@apache.org", "creation_time": "2011-07-26T08:02:17Z", "attachment_id": 27318}, {"count": 7, "tags": [], "bug_id": 51550, "is_private": false, "text": "Created attachment 27421\nProposed patch for Tomcat 5 v2\n\nUpdates patch for 5.5.x after review comments", "id": 148748, "time": "2011-08-22T12:53:42Z", "creator": "markt@apache.org", "creation_time": "2011-08-22T12:53:42Z", "attachment_id": 27421}, {"attachment_id": 27434, "tags": [], "bug_id": 51550, "text": "Created attachment 27434\nUpdated patch\n\nAddresses review comments (needed to catch Throwable in JkCoyoteHandler)", "count": 8, "id": 148825, "time": "2011-08-25T17:11:46Z", "creator": "markt@apache.org", "creation_time": "2011-08-25T17:11:46Z", "is_private": false}, {"count": 9, "tags": [], "text": "Tomcat 7.0.20 now correctly responds \"HTTP/1.1 500\", but I still don't get my error page configured in web.xml like this:\n\n<error-page>\n  <error-code>500</error-code>\n  <location>/static/error/internal.html</location>\n</error-page>", "is_private": false, "bug_id": 51550, "id": 148951, "time": "2011-09-01T12:46:51Z", "creator": "holger.sunke@bodo-peters.de", "creation_time": "2011-09-01T12:46:51Z", "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 51550, "is_private": false, "text": "I've added some code to 7.0.x that will use custom error pages in this scenario. I don't intend to back-port this part of the fix to 6.0.x or 5.5.x.", "id": 148977, "time": "2011-09-02T11:33:46Z", "creator": "markt@apache.org", "creation_time": "2011-09-02T11:33:46Z", "attachment_id": null}, {"count": 11, "tags": [], "text": "The proposed patch has been applied to 5.5 and will be in 5.5.34.\n\nThe example of maxActiveSessions=\"1\" in the Description now results in a reply with HTTP status 500, whereas with 5.5.33 the status was 200.\nThe content of the response is still empty.\n\n\nThe patch has not been applied to 6.0 yet, so I am leaving this issue open.", "is_private": false, "bug_id": 51550, "id": 149335, "time": "2011-09-16T18:48:09Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2011-09-16T18:48:09Z", "attachment_id": null}, {"count": 12, "tags": [], "creator": "markt@apache.org", "text": "The patch has been applied to 6.0.x and will be included in 6.0.34 onwards.", "id": 149576, "time": "2011-09-21T11:33:14Z", "bug_id": 51550, "creation_time": "2011-09-21T11:33:14Z", "is_private": false, "attachment_id": null}]