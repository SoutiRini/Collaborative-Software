[{"count": 0, "tags": [], "bug_id": 60003, "attachment_id": null, "id": 193106, "time": "2016-08-15T03:26:41Z", "creator": "onealj@apache.org", "creation_time": "2016-08-15T03:26:41Z", "is_private": false, "text": "When running the Tika corpus regression tests for POI 3.15 beta 3 RC1, Tim found a regression where the text \"Prague\" in the footer area of a master slide of an OLE2 Powerpoint document was not returned by the PowerPointExtractor.\n\nThis regression was introduced in r1743769 as part of bug 58144."}, {"count": 1, "tags": [], "creator": "onealj@apache.org", "is_private": false, "text": "Created attachment 34150\nFailing unit test\n\ncommoncrawl2/XX/XX6MTKAWWQSRDI56YYBZBAC4BCB4AWWK rename to 60003.ppt\n\nhttps://issues.apache.org/jira/browse/TIKA-2013\n\nTo be fair, re-saving the slideshow in LibreOffice does not reproduce the problem (possible LibreOffice bug).\nLibreOffice does not show the Master slide on any of the sheets, so if the PowerPointExtractor's goal is to get the text that is visibly displayed on the sheets and not unused hidden templates, then POI may be doing the right thing in 3.15 beta 3 RC 1.", "id": 193111, "time": "2016-08-15T04:15:20Z", "bug_id": 60003, "creation_time": "2016-08-15T04:15:20Z", "attachment_id": 34150}, {"count": 2, "tags": [], "text": "Created attachment 34152\nFailing unit test with logging\n\nIt looks like the omission of \"Prague\" from the PowerPointExtractor output was likely intentional [1]\n\n> 210\tif(HSLFMasterSheet.isPlaceholder(sh)) {\n> 211\t    // don't bother about boiler\n> 212\t    // plate text on master\n> 213\t    // sheets\n> 214\t    continue;\n> 215\t}\n\nSpecifically, POI identified this master slide footer as a placeholder. Since \"placeholders aren't normal shapes, they are visible only in the Edit Master mode\" [2], they are omitted from the powerpoint extractor output. If POI incorrectly identified this as a placeholder or the file was incorrectly saved treating this as a placeholder, then this text should be included in the PowerPointExtractor output.\n\n> Ignoring boiler plate (placeholder) text '*' on slide master\n> Ignoring boiler plate (placeholder) text 'Plan4all Kick-off Meeting, 14th May 2009, Prague' on slide master\n> Ignoring boiler plate (placeholder) text '*' on slide master\n> Ignoring boiler plate (placeholder) text 'Click to edit Master title style' on slide master\n\nThe change in functionality is likely somewhere in HeadersFooters.java where\n> if(_newRecord) attach();\nwas no longer called, or changes to the implementation of\n> isVisible\n\nExtracting from the Master slide goes back to bug 48161 in 2009.\n\n[1] https://svn.apache.org/viewvc/poi/trunk/src/scratchpad/src/org/apache/poi/hslf/extractor/PowerPointExtractor.java?revision=1748783&view=markup#l206\n[2] https://poi.apache.org/apidocs/org/apache/poi/hslf/usermodel/HSLFMasterSheet.html#isPlaceholder(org.apache.poi.hslf.usermodel.HSLFShape)", "attachment_id": 34152, "id": 193117, "creation_time": "2016-08-15T08:22:50Z", "time": "2016-08-15T08:22:50Z", "creator": "onealj@apache.org", "bug_id": 60003, "is_private": false}, {"count": 3, "attachment_id": null, "bug_id": 60003, "is_private": false, "id": 193789, "time": "2016-09-18T21:13:46Z", "creator": "kiwiwings@apache.org", "creation_time": "2016-09-18T21:13:46Z", "tags": [], "text": "Added a patch which also extracts custom placeholder. The placeholders in the \nexample have metro blobs attached and I use those to distinguish between \ndefault and custom placeholders. As this also applies to slide-number and date \nfield, I also check for their default text \"*\" ...\nOf course this only applies when mastersheet texts are requested - the tradeoff \nis between having no custom texts and additional default texts in the output -\nso I guess this unclean handling for master sheets is ok ..."}, {"count": 4, "tags": [], "text": "Created attachment 34265\nextract custom placeholder", "is_private": false, "id": 193790, "creator": "kiwiwings@apache.org", "time": "2016-09-18T21:13:49Z", "bug_id": 60003, "creation_time": "2016-09-18T21:13:49Z", "attachment_id": 34265}, {"count": 5, "tags": [], "bug_id": 60003, "attachment_id": 34266, "text": "Created attachment 34266\nTikas test file", "id": 193791, "time": "2016-09-18T21:14:03Z", "creator": "kiwiwings@apache.org", "creation_time": "2016-09-18T21:14:03Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 60003, "attachment_id": null, "id": 194234, "time": "2016-10-08T18:09:59Z", "creator": "kiwiwings@apache.org", "creation_time": "2016-10-08T18:09:59Z", "is_private": false, "text": "Applied via r1763927"}]