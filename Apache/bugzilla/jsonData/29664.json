[{"count": 0, "tags": [], "text": "DataSourceRealm can't lookup the Context Datasources, event with the \nlocalDataSource=\"true\" flag.\nI'm using jwsdp 1.3\nI know its a recurring one, but, you may have to take a closer look.\nHere's my config:\n<Host name=\"localhost\" debug=\"0\" appBase=\"webapps\"\n       unpackWARs=\"false\" autoDeploy=\"true\">\n\n       <Valve className=\"org.apache.catalina.authenticator.SingleSignOn\"\n                   debug=\"0\"/>\n        <Context path=\"/dms\" docBase=\"dms\" debug=\"0\" reloadable=\"true\" \ncrossContext=\"false\">\n   \n <Logger className=\"org.apache.catalina.logger.FileLogger\"\n             prefix=\"localhost_dms_log.\" suffix=\".txt\"\n             timestamp=\"true\"/>\n\n  <Resource name=\"jdbc/dmsdb\"\n               auth=\"Container\"\n               type=\"javax.sql.DataSource\"/>\n\n  <ResourceParams name=\"jdbc/dmsdb\">\n    <parameter>\n      <name>factory</name>\n      <value>org.apache.commons.dbcp.BasicDataSourceFactory</value>\n    </parameter>\n\n    <parameter>\n      <name>maxActive</name>\n      <value>100</value>\n    </parameter>\n\n    <!-- Maximum number of idle dB connections to retain in pool.\n         Set to 0 for no limit.\n         -->\n    <parameter>\n      <name>maxIdle</name>\n      <value>30</value>\n    </parameter>\n\n    <parameter>\n      <name>maxWait</name>\n      <value>10000</value>\n    </parameter>\n\n    <!-- MySQL dB username and password for dB connections  -->\n    <parameter>\n     <name>username</name>\n     <value>xxxxxxx</value>\n    </parameter>\n    <parameter>\n     <name>password</name>\n     <value>xxxxxxx</value>\n    </parameter>\n\n    <!-- Class name for mm.mysql JDBC driver -->\n    <parameter>\n       <name>driverClassName</name>\n       <value>org.gjt.mm.mysql.Driver</value>\n    </parameter>\n\n    <parameter>\n      <name>url</name>\n      <value>jdbc:mysql://localhost:3306/dmsdb?autoReconnect=true</value>\n    </parameter>\n  </ResourceParams>\n  \n  <Logger className=\"org.apache.catalina.logger.FileLogger\"\n             prefix=\"dms_Realm_log.\" suffix=\".txt\"\n             timestamp=\"true\"/>\n\n  <!--\nTried with dataSourceName= /jdbc/dmsdb, jdbc, dmsdb, java:comp/env/jdbc/dmsdb\nNone seem to work.\n -->\n\n  <Realm className=\"org.apache.catalina.realm.DataSourceRealm\" debug=\"99\" \n        dataSourceName=\"jdbc/dmsdb\" localDataSource=\"true\"\n      userTable=\"administrator\" userNameCol=\"username\" userCredCol=\"password\"\n   userRoleTable=\"another\" roleNameCol=\"rights\"/>\n\n   \n</Context>  \n\n      </Host>\n\n-------------------------------------------------------------------------\n\nHeres the exception:\nLooks to me as bug in the Context setup rather than in the Realm code.\nEspecially because the exception only shows half of the name.\nBut you folks, are the experts.\n\n2004-06-18 10:35:43 DataSourceRealm[/dms]: Exception performing authentication\njavax.naming.NameNotFoundException: Name jdbc is not bound in this Context\n\tat org.apache.naming.NamingContext.lookup(NamingContext.java:814)\n\tat org.apache.naming.NamingContext.lookup(NamingContext.java:197)\n\tat org.apache.catalina.realm.DataSourceRealm.open\n(DataSourceRealm.java:467)\n\tat org.apache.catalina.realm.DataSourceRealm.authenticate\n(DataSourceRealm.java:315)\n\tat org.apache.catalina.authenticator.FormAuthenticator.authenticate\n(FormAuthenticator.java:265)\n\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke\n(AuthenticatorBase.java:497)\n\tat org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:149)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:564)\n\tat org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:196)\n\tat org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:151)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke\n(ErrorReportValve.java:175)\n\tat org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:149)\n\tat org.apache.catalina.authenticator.SingleSignOn.invoke\n(SingleSignOn.java:383)\n\tat org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:149)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:564)\n\tat org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:156)\n\tat org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:151)\n\tat org.apache.catalina.valves.AccessLogValve.invoke\n(AccessLogValve.java:577)\n\tat org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:149)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:564)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:974)\n\tat org.apache.coyote.tomcat5.CoyoteAdapter.service\n(CoyoteAdapter.java:207)\n\tat org.apache.coyote.http11.Http11Processor.process\n(Http11Processor.java:647)\n\tat \norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnectio\nn(Http11Protocol.java:499)\n\tat org.apache.tomcat.util.net.TcpWorkerThread.runIt\n(PoolTcpEndpoint.java:575)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:649)\n\tat java.lang.Thread.run(Thread.java:534)", "attachment_id": null, "id": 59465, "creator": "avelino.xa.benavides@ericsson.com", "time": "2004-06-18T09:10:46Z", "bug_id": 29664, "creation_time": "2004-06-18T09:10:46Z", "is_private": false}, {"count": 1, "tags": [], "text": "Please look into this more: I doubt there's a bug. If there's one, please\nprovide a patch.", "attachment_id": null, "bug_id": 29664, "id": 59470, "time": "2004-06-18T10:56:51Z", "creator": "remm@apache.org", "creation_time": "2004-06-18T10:56:51Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 29664, "attachment_id": null, "text": "Without further details, it works for me (at least, it worked for the folks who\nsubmitted this feature). If it doesn't work, please look into it and provide a\npatch.", "id": 60008, "time": "2004-06-28T16:15:39Z", "creator": "remm@apache.org", "creation_time": "2004-06-28T16:15:39Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 29664, "text": "same problem as described ", "id": 76960, "time": "2005-07-04T02:18:47Z", "creator": "sal_cheung@yahoo.com", "creation_time": "2005-07-04T02:18:47Z", "is_private": false, "attachment_id": null}, {"text": "The original issues was reported on 5.0.0.  The DataSourceRealm works fine for\nme on 5.0.28 and 5.5.9, so I'm closing this issue.  Salina Cheung, or anyone\nelse reopening this issue, please specify what Tomcat version you're using, and\nplease make it the latest stable release.  Thanks.", "tags": [], "bug_id": 29664, "attachment_id": null, "count": 4, "id": 77568, "time": "2005-07-22T16:20:01Z", "creator": "yoavs@computer.org", "creation_time": "2005-07-22T16:20:01Z", "is_private": false}]