[{"count": 0, "tags": [], "text": "We had an Apache module we wrote which works fine in Apache 2.2.*. But it generated segfault when loaded in Apache 2.4.1. After some debugging, We found the segfault was caused by calling ap_log_rerror. In Apache server/log.c, in function do_errorlog_default,  it tried to access info->r->useragent_addr->port which generated segfault. Here is our code:\n\nstatic void cuwa_register_hooks(apr_pool_t *p)\n{\n...\n\nap_hook_create_request(cuwa_create_request, NULL, NULL, APR_HOOK_MIDDLE);\n\n...\n\n}\nstatic int cuwa_create_request(request_rec *r)\n{\n    ....\n    ap_log_rerror(APLOG_MARK, APLOG_DEBUG, 0, r,\"message\");\n\n    if (!r->main && !r->prev)\n    {\n        ap_add_input_filter_handle(cuwa_filter_handle, NULL, r, r->connection);\n    }\n\n    return OK;\n}", "attachment_id": null, "id": 159176, "creator": "hy93@cornell.edu", "time": "2012-05-18T19:39:57Z", "bug_id": 53265, "creation_time": "2012-05-18T19:39:57Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 53265, "attachment_id": null, "id": 159177, "time": "2012-05-18T19:46:03Z", "creator": "covener@gmail.com", "creation_time": "2012-05-18T19:46:03Z", "is_private": false, "text": "http://svn.apache.org/viewvc?view=revision&revision=1334344\n\nWill be released in 2.4.3\n\n*** This bug has been marked as a duplicate of bug 50823 ***"}]