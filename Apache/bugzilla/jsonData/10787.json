[{"count": 0, "tags": [], "bug_id": 10787, "text": "With the 'saveAsJPEG' example given in Batik doc. for TranscoderInput, if the\nSVG file is read from a 'java.io.FileInputStream' opened on the SVG file,\ninstead of a 'File' pointing to the same file, a NullPointerException is thrown.\n\ni.e. if the lines\n\n            String svgURI = new File(args[0]).toURL().toString();\n            input = new TranscoderInput(svgURI);\n\nare replaced by\n\n            InputStream is=new FileInputStream(args[0]);\n            input = new TranscoderInput(is);\n\nthe file can't be loaded anymore... a NullPointerException is thrown by\n\n        t.transcode(input, output);\n\nNote: tested with 'henryV.svg' sample file.\n\nHere follows the stack trace:\n\nException in thread \"main\" java.lang.NullPointerException\n        at java.net.URL.<init>(URL.java:366)\n        at java.net.URL.<init>(URL.java:329)\n        at java.net.URL.<init>(URL.java:321)\n        at java.net.URL.<init>(URL.java:252)\n        at java.net.URL.<init>(URL.java:275)\n        at org.apache.batik.util.ParsedURLData.buildURL(Unknown Source)\n        at org.apache.batik.util.ParsedURLData.openStreamInternal(Unknown Source)\n        at org.apache.batik.util.ParsedURLData.openStream(Unknown Source)\n        at org.apache.batik.util.ParsedURL.openStream(Unknown Source)\n        at org.apache.batik.dom.svg.SAXSVGDocumentFactory.createDocument(Unknown\nSource)\n        at org.apache.batik.bridge.DocumentLoader.loadDocument(Unknown Source)\n        at org.apache.batik.bridge.URIResolver.getNode(Unknown Source)\n        at org.apache.batik.bridge.URIResolver.getElement(Unknown Source)\n        at org.apache.batik.bridge.BridgeContext.getReferencedElement(Unknown\nSource)\n        at org.apache.batik.bridge.CSSUtilities.convertFilter(Unknown Source)\n        at\norg.apache.batik.bridge.AbstractGraphicsNodeBridge.buildGraphicsNode(Unknown Source)\n        at org.apache.batik.bridge.GVTBuilder.buildGraphicsNode(Unknown Source)\n        at org.apache.batik.bridge.GVTBuilder.buildComposite(Unknown Source)\n        at org.apache.batik.bridge.GVTBuilder.buildGraphicsNode(Unknown Source)\n        at org.apache.batik.bridge.GVTBuilder.buildComposite(Unknown Source)\n        at org.apache.batik.bridge.GVTBuilder.build(Unknown Source)\n        at org.apache.batik.transcoder.SVGAbstractTranscoder.transcode(Unknown\nSource)\n        at org.apache.batik.transcoder.image.ImageTranscoder.transcode(Unknown\nSource)\n        at org.apache.batik.transcoder.XMLAbstractTranscoder.transcode(Unknown\nSource)", "id": 19504, "time": "2002-07-14T15:44:54Z", "creator": "vincent@cautaerts.org", "creation_time": "2002-07-14T15:44:54Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 10787, "is_private": false, "text": "I get the same error using a Reader with TranscoderInput", "id": 21670, "time": "2002-08-24T14:21:23Z", "creator": "bills@asg.com", "creation_time": "2002-08-24T14:21:23Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 10787, "is_private": false, "id": 25905, "creation_time": "2002-11-08T06:44:26Z", "time": "2002-11-08T06:44:26Z", "creator": "technosf@speakeasy.net", "text": "I get the same thing on 1.1 , different error on 1.5 with (testRotate.svg used \nas and example input) the class below called from a servlet that does this:\n\n\n        response.setContentType(\"image/png\");\n        PrintWriter out = response.getWriter();\n        \n        ConvertSVG convertSVG = new ConvertSVG();\n        \n        FileReader in = new FileReader(\"E:\\\\batik-1.5\n\\\\samples\\\\textRotate.svg\");\n        \n        convertSVG.PNG(in,out);\n        \n        out.close();\n\n\n------\n\n**** The Transcoder class:\n\n-----------------------------------------\n\nimport java.io.*;\n\nimport org.apache.batik.transcoder.image.PNGTranscoder;\nimport org.apache.batik.transcoder.TranscoderException;\nimport org.apache.batik.transcoder.TranscoderInput;\nimport org.apache.batik.transcoder.TranscoderOutput;\n\n/**\n *\n * @author  martin@technomation.net\n */\npublic class ConvertSVG { \n    \n    /** Creates a new instance of SVGtoPNG */\n    public ConvertSVG() {\n    }\n    \n    private static void toPNG( TranscoderInput input, TranscoderOutput output ) \nthrows TranscoderException {\n        PNGTranscoder t = new PNGTranscoder();\n        t.transcode(input, output);\n    }\n        \n    \n    /**\n     * @param inputStream\n     * @param outputStream\n     * @throws IOException  */   \n    public static void PNG( Reader reader, Writer writer ) throws IOException {\n        // Transcoder input\n        TranscoderInput input = new TranscoderInput( reader );\n        \n        // create the transcoder output\n        BufferedWriter ostream = new BufferedWriter( writer );\n        TranscoderOutput output = new TranscoderOutput(ostream);\n        \n        // save the image\n        try {\n            toPNG(input, output);\n        } catch ( TranscoderException e ) {\n            System.err.println( \"Transcoder exception thrown transcoding \nstream :\" + e.toString() );\n            throw new IOException( \"Transcoder exception thrown transcoding \nstream :\" + e.toString() );\n        }\n        \n        // flush and close the stream then exit\n        ostream.flush();\n        ostream.close();\n    }    \n}\n\n---------------------------------\n\n\n**** The error on 1.1:\n\n\njava.lang.NullPointerException\n\tat java.net.URL.(URL.java:366)\n\tat java.net.URL.(URL.java:329)\n\tat java.net.URL.(URL.java:321)\n\tat java.net.URL.(URL.java:252)\n\tat java.net.URL.(URL.java:275)\n\tat org.apache.batik.util.ParsedURLData.buildURL(Unknown Source)\n\tat org.apache.batik.util.ParsedURLData.openStreamInternal(Unknown \nSource)\n\tat org.apache.batik.util.ParsedURLData.openStream(Unknown Source)\n\tat org.apache.batik.util.ParsedURL.openStream(Unknown Source)\n\tat org.apache.batik.dom.svg.SAXSVGDocumentFactory.createDocument\n(Unknown Source)\n\tat org.apache.batik.bridge.DocumentLoader.loadDocument(Unknown Source)\n\tat org.apache.batik.bridge.URIResolver.getNode(Unknown Source)\n\tat org.apache.batik.bridge.URIResolver.getElement(Unknown Source)\n\tat org.apache.batik.bridge.BridgeContext.getReferencedElement(Unknown \nSource)\n\tat org.apache.batik.bridge.SVGUseElementBridge.createGraphicsNode\n(Unknown Source)\n\tat org.apache.batik.bridge.GVTBuilder.buildGraphicsNode(Unknown Source)\n\tat org.apache.batik.bridge.GVTBuilder.buildComposite(Unknown Source)\n\tat org.apache.batik.bridge.GVTBuilder.build(Unknown Source)\n\tat org.apache.batik.transcoder.image.ImageTranscoder.transcode(Unknown \nSource)\n\tat org.apache.batik.transcoder.XMLAbstractTranscoder.transcode(Unknown \nSource)\n\tat com.dnaShare.charts.ConvertSVG.toPNG(ConvertSVG.java:28)\n\tat com.dnaShare.charts.ConvertSVG.PNG(ConvertSVG.java:100)\n\n\n\n---------------------------\n\n\n*****    The error on 1.5rc4:\n\njava.lang.NullPointerException\n\tat org.apache.batik.css.engine.CSSEngine.parseStyleSheet(Unknown Source)\n\tat org.apache.batik.css.engine.CSSEngine.parseStyleSheet(Unknown Source)\n\tat \norg.apache.batik.dom.svg.SVGStyleSheetProcessingInstruction.getCSSStyleSheet\n(Unknown Source)\n\tat org.apache.batik.css.engine.CSSEngine.getStyleSheetNodes(Unknown \nSource)\n\tat org.apache.batik.css.engine.CSSEngine.getCascadedStyleMap(Unknown \nSource)\n\tat org.apache.batik.css.engine.CSSEngine.getComputedStyle(Unknown \nSource)\n\tat org.apache.batik.bridge.CSSUtilities.getComputedStyle(Unknown Source)\n\tat org.apache.batik.bridge.CSSUtilities.convertVisibility(Unknown \nSource)\n\tat org.apache.batik.bridge.SVGSVGElementBridge.createGraphicsNode\n(Unknown Source)\n\tat org.apache.batik.bridge.GVTBuilder.build(Unknown Source)\n\tat org.apache.batik.transcoder.SVGAbstractTranscoder.transcode(Unknown \nSource)\n\tat org.apache.batik.transcoder.image.ImageTranscoder.transcode(Unknown \nSource)\n\tat org.apache.batik.transcoder.XMLAbstractTranscoder.transcode(Unknown \nSource)\n\tat com.dnaShare.charts.ConvertSVG.toPNG(ConvertSVG.java:28)\n\tat com.dnaShare.charts.ConvertSVG.PNG(ConvertSVG.java:100)\n\n\n", "attachment_id": null}, {"count": 3, "tags": [], "creator": "deweese@apache.org", "attachment_id": null, "is_private": false, "id": 32240, "time": "2003-03-02T02:39:39Z", "bug_id": 10787, "creation_time": "2003-03-02T02:39:39Z", "text": "  The problem is with documents that have relative reference there is no\nway to resolve the reference when you just provide a stream."}]