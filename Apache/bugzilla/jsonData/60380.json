[{"count": 0, "attachment_id": null, "creator": "1983-01-06@gmx.net", "text": "If the client code calls HttpServletRequest#logout(), it is delegated to getContext().getAuthenticator().logout(this); but AuthenticatorBase#logout(Request) never calls TomcatPrincipal#logout() to free resources. The only spot where this method is called is in StandardSession#expire(boolean).\n\nA completely request-based application cannot free the principal without ugly hacks.", "id": 195023, "time": "2016-11-16T10:29:32Z", "bug_id": 60380, "creation_time": "2016-11-16T10:29:32Z", "tags": [], "is_private": false}, {"count": 1, "attachment_id": 34462, "creator": "1983-01-06@gmx.net", "text": "Created attachment 34462\nPatch calling TomcatPrincipal#logout()", "id": 195086, "time": "2016-11-20T18:51:07Z", "bug_id": 60380, "creation_time": "2016-11-20T18:51:07Z", "tags": [], "is_private": false}, {"count": 2, "attachment_id": 34463, "creator": "1983-01-06@gmx.net", "text": "Created attachment 34463\nPatch calling TomcatPrincipal#logout()", "id": 195087, "time": "2016-11-20T18:54:26Z", "bug_id": 60380, "creation_time": "2016-11-20T18:54:26Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 60380, "attachment_id": null, "id": 195129, "time": "2016-11-21T21:18:42Z", "creator": "markt@apache.org", "creation_time": "2016-11-21T21:18:42Z", "is_private": false, "text": "Thanks for the report and the patch. I applied a slightly modified patch that used Tomcat's standard(ish) style of exception handling.\n\nFixed in:\n- trunk for 9.0.0.M14 onwards\n- 8.5.x for 8.5.9 onwards\n- 8.0.x for 8.0.40 onwards\n- 7.0.x for 7.0.74 onwards"}, {"count": 4, "tags": [], "bug_id": 60380, "attachment_id": null, "id": 195130, "time": "2016-11-21T21:29:59Z", "creator": "1983-01-06@gmx.net", "creation_time": "2016-11-21T21:29:59Z", "is_private": false, "text": "(In reply to Mark Thomas from comment #3)\n> Thanks for the report and the patch. I applied a slightly modified patch\n> that used Tomcat's standard(ish) style of exception handling.\n\nAny reason not to keep \"catch (Exception e)\" because Exception extends Throwable and the ExceptionUtils still can do their work? Anything but Exception indicates some severe VM error."}, {"count": 5, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "text": "The reason is java.lang.StackOverflowError and anything similar that may be added / discovered.", "id": 195140, "time": "2016-11-22T09:54:18Z", "bug_id": 60380, "creation_time": "2016-11-22T09:54:18Z", "is_private": false}]