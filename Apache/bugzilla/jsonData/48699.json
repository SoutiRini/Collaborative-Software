[{"count": 0, "tags": [], "bug_id": 48699, "text": "Created attachment 24945\nthe excel\n\nAfter upgrading from POI 3.2 to 3.6 we get an error while reading an excisting Excel 2003 and writing an updated version to another file. You can find the Excel in attachment.\n\nCode:\n\nInputStream inp = new FileInputStream(file);\nwb_xls = new HSSFWorkbook(inp);\n\nTracing:\n\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\tat org.apache.poi.hssf.record.RecordFactory$ReflectionRecordCreator.create(RecordFactory.java:64)\n\tat org.apache.poi.hssf.record.RecordFactory.createSingleRecord(RecordFactory.java:263)\n\tat org.apache.poi.hssf.record.RecordFactoryInputStream.readNextRecord(RecordFactoryInputStream.java:270)\n\tat org.apache.poi.hssf.record.RecordFactoryInputStream.nextRecord(RecordFactoryInputStream.java:236)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:392)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:276)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:201)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:317)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:298)\n\tat be.mc.system.poi.excel.ExcelFromList.makeXLSWorkBook(ExcelFromList.java:387)\n\tat be.mc.system.poi.excel.ExcelFromList.generateReport(ExcelFromList.java:170)\n\tat be.mc.system.poi.excel.ExcelFromList.send(ExcelFromList.java:235)\n\tat be.mc.system.scheduler.server.ScheduleExportJob.execute(ScheduleExportJob.java:165)\n\tat be.ldc.trading.orderheader.export.ExportJob.execute(ExportJob.java:44)\n\tat org.quartz.core.JobRunShell.run(JobRunShell.java:203)\n\tat org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:520)\nCaused by: org.apache.poi.hssf.record.RecordFormatException: Unexpected remaining size (12)\n\tat org.apache.poi.hssf.record.pivottable.ExtendedPivotTableViewFieldsRecord.<init>(ExtendedPivotTableViewFieldsRecord.java:68)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:494)\n\tat org.apache.poi.hssf.record.RecordFactory$ReflectionRecordCreator.create(RecordFactory.java:56)\n\t... 15 more\n\n\n\nChecking the file with the BiffViewer gives us the following error:\n\n\n\nOffset=0x0020A085(2138245) recno=137008 sid=0x00EC size=0x00AA(170)\n[MSODRAWING]\nNo Escher Records Decoded\n[/MSODRAWING]\n\nOffset=0x0020A133(2138419) recno=137009 sid=0x005D size=0x0046(70)\njava.lang.NullPointerException\n        at org.apache.poi.hssf.record.LbsDataSubRecord.toString(LbsDataSubRecord\n.java:246)\n        at org.apache.poi.hssf.record.ObjRecord.toString(ObjRecord.java:146)\n        at org.apache.poi.hssf.dev.BiffViewer.createRecords(BiffViewer.java:97)\n        at org.apache.poi.hssf.dev.BiffViewer.main(BiffViewer.java:401)", "id": 134322, "time": "2010-02-08T05:19:14Z", "creator": "mail.metallo.now@gmail.com", "creation_time": "2010-02-08T05:19:14Z", "is_private": false, "attachment_id": 24945}, {"count": 1, "tags": [], "bug_id": 48699, "attachment_id": null, "is_private": false, "id": 183079, "time": "2015-05-22T15:58:29Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-05-22T15:58:29Z", "text": "still happens with current release."}]