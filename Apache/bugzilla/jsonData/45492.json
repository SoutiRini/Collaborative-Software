[{"count": 0, "tags": [], "bug_id": 45492, "text": "Created attachment 22323\nTest workbook\n\nVersion: 3.1-FINAL-20080629 (not in the version listbox)\n\nAfter upgrading POI library to version 3.1 FINAL in my project I have found that there is a bug in retrieving fill background color. It returns value 64 for any cell in the worksheet.\n\nI attach sample Excel file (created in Excel 2000 if it does matter), on which the following code fails.\n\n<pre>\n    HSSFSheet sheet = workBook.getSheet( \"Sheet1\" );\n    HSSFRow row = sheet.getRow( sheet.getFirstRowNum() );\n    StringBuilder sb = new StringBuilder( \"Background color test:\\n\");\n    boolean flag = false;\n    for( short colIx = row.getFirstCellNum(); colIx < row.getLastCellNum(); colIx++ )\n    {\n      HSSFCell cell = row.getCell( colIx );\n      if( cell == null )\n      {\n        continue;\n      }\n      short bgColor = cell.getCellStyle().getFillBackgroundColor();\n      if( bgColor != 64 )\n      {\n        flag = true;\n      }\n      sb.append( \"Column \" ).append( colIx ).append( \" has background color index \" )\n          .append( bgColor ).append( \"\\n\" );\n    }\n    System.out.println( sb.toString() );\n    assertTrue( flag );\n</pre>", "id": 119076, "attachment_id": 22323, "creator": "minarikv@gmail.com", "creation_time": "2008-07-28T06:09:02Z", "time": "2008-07-28T06:09:02Z", "is_private": false}, {"count": 1, "tags": [], "text": "This is as expected. You've setup your cells with a foreground colour fill, and not a background one. If you check the foreground fill colour, it'll have the values you want.", "attachment_id": null, "id": 120839, "creator": "apache@gagravarr.org", "time": "2008-09-21T11:57:37Z", "bug_id": 45492, "creation_time": "2008-09-21T11:57:37Z", "is_private": false}]