[{"count": 0, "tags": [], "creator": "vicentesalvador@netscape.net", "attachment_id": null, "text": "We will like to implement a single session across all Contexts. We've tested we\ncan do this with a Manager but every new Context we must change the server.xml\nfile to add this context with the Manager.\n\nAllowing a Manager configuration inside the DefaultContext will allow us to\nimplement this feature accross all Context wherever they are.", "id": 4033, "time": "2001-07-26T02:36:26Z", "bug_id": 2820, "creation_time": "2001-07-26T02:36:26Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 2820, "text": "Many of the new Browsers like IE 5 and Mozilla (NS 6) implements the capacity to\naccept gziped pages from the server. This will result on a great performance\nimprovement because HTML pages gziped reduces their size very much.\n\nI think we should implement the gziped content feature inside the connector,\nmaybe creating a new Factory like: GZipSocketFactory and SSLGzipSocketFactory.\n\nHere is a sample of a Gzip content producer:\n\npublic PrintWriter getWriter(HttpServletRequest req, HttpServletResponse res)\n\tthrows Exception\n{\n\tPrintWriter pwr;\n\tif (SysCfgValues.getValue(\"GZIPOutput\") != 0) {\n\t\tString enc = req.getHeader(\"Accept-Encoding\");\n\t\tif (enc == null)\n\t\t\tenc = req.getHeader(\"accept-encoding\");\n\t\tif ((enc != null) && (enc.indexOf(\"gzip\") != -1))\n\t\t{\n\t\t\tpwr = new PrintWriter(new GZIPOutputStream(res.getOutputStream()), false);\n\t\t\tres.setHeader(\"Content-Encoding\", \"gzip\");\n\t\t\tres.setHeader(\"Vary\", \"Accept-Encoding\");\n\t\t\tif (m_debug)\n\t\t\t\tMessageLog.log(this, \"getWriter\", \"GZIP encoding\");\n\t\t} else if ((enc != null) && (enc.indexOf(\"compress\") != -1)) {\n\t\t\tpwr = new PrintWriter(new ZipOutputStream(res.getOutputStream()), false);\n\t\t\tres.setHeader(\"Content-Encoding\", \"compress\");\n\t\t\tres.setHeader(\"Vary\", \"Accept-Encoding\");\n\t\t\tif (m_debug)\n\t\t\t\tMessageLog.log(this, \"getWriter\", \"ZIP encoding\");\n\t\t} else {\n\t\t\tif (m_debug)\n\t\t\t\tMessageLog.log(this, \"getWriter\", \"no GZIP or ZIP supported\");\n\t\t\tpwr = res.getWriter();\t\n\t\t}\n\t} else {\n\t\tpwr = res.getWriter();\t\n\t}\n\treturn pwr;\n}\n\nWe need to consider that not all mimetypes should be gziped. For example, GIF or\nJPEG images should not be compressed, but HTML, TEXT, XML, XSL and other text\nbases mimes should be compressed.\n\nSo maybe we can add a new parameter to the mimetype definition on web.xml to\nspecify wich mimetypes accepts compression streams.\n\n  <mime-mapping>\n    <extension>txt</extension>\n    <mime-type>text/plain</mime-type>\n    <accept-gzip>true</accept-gzip>\n  </mime-mapping>\n\nWe need to be carefull because results from JSP compilation could be also be\ncompressed and I'n not sure how this is treated inside Catalina.\n\nExpecting your opinion!!!!", "id": 4034, "time": "2001-07-26T04:33:28Z", "creator": "vicentesalvador@netscape.net", "creation_time": "2001-07-26T04:33:28Z", "is_private": false, "attachment_id": null}, {"count": 2, "attachment_id": null, "creator": "vicentesalvador@netscape.net", "is_private": false, "id": 4040, "time": "2001-07-26T04:39:59Z", "bug_id": 2820, "creation_time": "2001-07-26T04:39:59Z", "tags": [], "text": "I think this is a Connectors RFE. Isn't it\n\nChanging to connectors component"}, {"count": 3, "tags": [], "bug_id": 2820, "text": "Yes, I plan to implement that kind of feature in 4.1.", "id": 4054, "time": "2001-07-26T09:39:01Z", "creator": "remm@apache.org", "creation_time": "2001-07-26T09:39:01Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "text": "Note that there is a compression filter included in the \"/examples\" web\napplication that does precisely this kind of thing.  Because it is implemented\nas a filter, it is also portable.\n", "is_private": false, "bug_id": 2820, "id": 4057, "time": "2001-07-26T11:26:33Z", "creator": "craig.mcclanahan@sun.com", "creation_time": "2001-07-26T11:26:33Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 2820, "text": "Can you give me some help about how to get the Compress Filter on. I'm getting\nvery strange errors configuring it as a Valve and as a filter.\n\nPutting as a valve by editing server.xml\n\n<Valve className=\"compressionFilters.CompressionFilter\" />\n\nERROR reading .\\conf\\server.xml\nAt Line 131 /Server/Service/Engine/Host/Valve/\n\nCatalina.start: java.lang.IllegalArgumentException: argument type mismatch\njava.lang.IllegalArgumentException: argument type mismatch\n        at java.lang.reflect.Method.invoke(Native Method)\n        at org.apache.catalina.util.xml.AddChild.end(XmlMapper.java:811)\n\nIf I cannot edit server.xml and put a filter on web.xml:\n\n    <filter>\n        <filter-name>Compression Filter</filter-name>\n        <filter-class>compressionFilters.CompressionFilter</filter-class>\n\n        <init-param>\n          <param-name>compressionThreshold</param-name>\n          <param-value>10</param-value>\n        </init-param>\n        <init-param>\n          <param-name>debug</param-name>\n          <param-value>9</param-value>\n        </init-param>\n    </filter>\n\nI cannot start the web application and the log file shows:\n\n2001-07-27 15:25:13 ContextConfig[/deisterxml]: Added certificates -> request\nattribute Valve\n2001-07-27 15:25:13 StandardContext[/deisterxml]: Exception starting filter\nCompression Filter\njava.lang.ClassCastException: compressionFilters.CompressionFilter\n\tat\norg.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:253)\n\tat\norg.apache.catalina.core.ApplicationFilterConfig.setFilterDef(ApplicationFilterConfig.java:314)\n\tat\norg.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:120)\n\tat org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:3004)\n\tat org.apache.catalina.core.StandardContext.start(StandardContext.java:3297)\n\tat org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1123)\n\tat org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1123)\n\tat org.apache.catalina.core.StandardEngine.start(StandardEngine.java:278)\n\tat org.apache.catalina.core.StandardService.start(StandardService.java:368)\n\tat org.apache.catalina.core.StandardServer.start(StandardServer.java:473)\n\tat org.apache.catalina.startup.Catalina.start(Catalina.java:738)\n\tat org.apache.catalina.startup.Catalina.execute(Catalina.java:657)\n\tat org.apache.catalina.startup.Catalina.process(Catalina.java:178)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:30)\n\tat\nsun.reflect.InflatableMethodAccessorImpl.invoke(InflatableMethodAccessorImpl.java:48)\n\tat java.lang.reflect.Method.invoke(Method.java:306)\n\tat jas.boot.start.Bootstrap.main(Bootstrap.java:227)", "id": 4086, "time": "2001-07-27T06:35:21Z", "creator": "vicentesalvador@netscape.net", "creation_time": "2001-07-27T06:35:21Z", "is_private": false, "attachment_id": null}, {"count": 6, "attachment_id": null, "bug_id": 2820, "is_private": false, "id": 4087, "time": "2001-07-27T10:24:11Z", "creator": "craig.mcclanahan@sun.com", "creation_time": "2001-07-27T10:24:11Z", "tags": [], "text": "Any further discussion of this topic should take place on the TOMCAT-USER list\n(so that everyone can benefit from it).  However, the following points are\nimportant:\n\n* The compression filter is configured in the web.xml file of\n  the web application you wish to use it in, not in server.xml.\n\n* In order for the compression filter to be available, you must\n  copy the required classes (from /WEB-INF/classes/compressionFilters\n  in the example app) into your own web application.\n\n"}, {"count": 7, "text": "After further discussion and thinking:\n- content encoding handling (which is what you're asking for here) is a user \nspace feature, and should be implemented in the filter / servlet\n- pluggable transfer encoding support will be added in the next version of the \nHTTP/1.1 connector (which will be a full rewrite)", "bug_id": 2820, "is_private": false, "id": 5164, "time": "2001-09-06T11:06:41Z", "creator": "remm@apache.org", "creation_time": "2001-09-06T11:06:41Z", "tags": [], "attachment_id": null}, {"count": 8, "tags": [], "text": "Fix bug status.", "is_private": false, "id": 5972, "creator": "remm@apache.org", "time": "2001-09-24T12:35:12Z", "bug_id": 2820, "creation_time": "2001-09-24T12:35:12Z", "attachment_id": null}, {"count": 9, "text": "TE support should be in the next version of the HTTP connector.", "bug_id": 2820, "is_private": false, "id": 5973, "time": "2001-09-24T12:35:52Z", "creator": "remm@apache.org", "creation_time": "2001-09-24T12:35:52Z", "tags": [], "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 2820, "text": "This is now implementable using the new HTTP/1.1 connector.", "id": 11601, "time": "2002-03-09T05:33:06Z", "creator": "remm@apache.org", "creation_time": "2002-03-09T05:33:06Z", "is_private": false, "attachment_id": null}, {"count": 11, "attachment_id": null, "bug_id": 2820, "is_private": false, "id": 28888, "time": "2003-01-05T07:37:53Z", "creator": "hoju@visi.com", "creation_time": "2003-01-05T07:37:53Z", "tags": [], "text": "Remy,\n\nYou said this is \"implementable\".  However, that was back in March.  Has it been\n\"implemented\" yet in Coyote?  If so, is there a config to turn it on?  If it\nwon't get into Tomcat-4.x.x, will it get into Tomcat-5?\n\nJake"}, {"count": 12, "text": "This has been implemented.", "bug_id": 2820, "is_private": false, "id": 35194, "time": "2003-04-15T15:20:43Z", "creator": "remm@apache.org", "creation_time": "2003-04-15T15:20:43Z", "tags": [], "attachment_id": null}]