[{"count": 0, "tags": [], "bug_id": 46419, "attachment_id": 23038, "is_private": false, "id": 123419, "time": "2008-12-19T04:45:19Z", "creator": "jmvazquez@lomg.net", "creation_time": "2008-12-19T04:45:19Z", "text": "Created attachment 23038\nSaved xlsx file using the specified code. Very simple xlsx file. Open Office 3.0 don't recognize it\n\nUsing this code to load an xlsx file and save it in another path with o without changes.\n\nWorkbook xlsDocument=null;\ntry {\n   xlsDocument = WorkbookFactory.create(new FileInputStream(pathOriginal));\n} catch (FileNotFoundException ex) {\n   ex.printStackTrace();\n} catch (Exception ex) {\n   ex.printStackTrace();\n}\nFileOutputStream fos = new FileOutputStream(pathTemp);\nxlsDocument.write(fos);\nfos.flush();\nfos.close(); \n\nThe saved file contains file format errors.\n\nIf the saved file is a complex file,\nwhen you try to open it with excel, it says that the file is damaged but\nsometimes can repair it. With simples files (including the most simple file,\nonly one cell with a simple text content) excel can open the file without\nerrors. But if you try to open the saved file using OpenOffice\n3.0 which supports xlsx file format. OpenOffice 3.0 can open the original\nxlsx file without problems, but the saved file isn't recognized by\nOpenOffcie 3.0.\n\nIf you open the saved file with excel and save it again (usign save option\nfrom excel), now OpenOffice can open it without problems, so I supose that\nexists a save bug that causes a format problem that usually can be repaired\nby excel, but never can be repaired by OpenOffice."}, {"count": 1, "tags": [], "bug_id": 46419, "attachment_id": null, "id": 123445, "time": "2008-12-20T05:43:29Z", "creator": "yegor@dinom.ru", "creation_time": "2008-12-20T05:43:29Z", "is_private": false, "text": "Please attach the original file. \n\nYegor"}, {"count": 2, "tags": [], "bug_id": 46419, "attachment_id": null, "id": 123459, "time": "2008-12-21T05:52:11Z", "creator": "yegor@dinom.ru", "creation_time": "2008-12-21T05:52:11Z", "is_private": false, "text": "I think it is a bug in OpenOffice, not in POI. I files and issue, let's wait for feedback from OO guys:\nhttp://www.openoffice.org/issues/show_bug.cgi?id=97460\n\nDescription:\nOpenOffice can't read core OOXML relationships if a part name starts with a forward slash character '/'.\nFor example, if the main document part is referenced as \"/xl/workbook.xml\" then OpenOffice Calc fails to open it. If the main part is referenced as \"xl/workbook.xml\" (without the leading slash), then the file is opened OK.\n\nThe part name grammar implies the forward slash constraint. See OOXML Open Packaging Conventions, Package model conformance requirements:\nM1.4 A part name shall start with a forward slash (\u201c/\u201d) character.\n\nThis constraint doesn't seem to be mandatory. Excel 2007 writes package part names without the leading slash and doesn't require it when reading files. Both \"xl/workbook.xml\" and \"/xl/workbook.xml\" part names seem to be valid, although only the first one is OK in OpenOffice 3.0. \n\nSo, I think OO should support package part names starting with a forward slash.\n\nYegor"}, {"count": 3, "tags": [], "bug_id": 46419, "attachment_id": null, "is_private": false, "id": 123577, "time": "2008-12-29T04:53:43Z", "creator": "jmvazquez@lomg.net", "creation_time": "2008-12-29T04:53:43Z", "text": "Sorry for not responding, but I was on holiday.\n\nI agree that can exist an OpenOffice bug as you say, but I think that the bug I reported is a POI bug too. If I open an original file with MS Excel 2007 it works properly, but if I save this file without changes using POI the saved file not only can't be opened by OpenOffice but also presents problems to be opened with MS Excel 2007. Excel can open it, but it has to delete some registers, so I think that exists a problem with Apache POI too.\n\nThis is the messages reported by Excel 2007 when I try to open the saved file:\n\nRegistros quitados: Informaci\u00f3n de celda de /xl/worksheets/sheet6.xml parte\nRegistros quitados: F\u00f3rmula de /xl/calcChain.xml parte (Propiedades de c\u00e1lculo)\n\nThe message is in spanish, in English it could be translated as:\n\nDeleted registers: Cell information of /xl/worksheets/sheet6.xml part\nDeleted registers: Formula of /xl/calcChain.xml part (Calculation of properties)\n\nI can't attach my original file because it contains some private information, but I will try to modify this file to delete this private information and attach it. The file is protected so I can't modify it, when I get the password to unprotect  and modify it I will attach the file. Sorry.\n\nJ. Miguel"}, {"count": 4, "tags": [], "text": "Created attachment 23159\nOriginal xlsx fiel (before saving)", "is_private": false, "id": 124278, "creator": "jmvazquez@lomg.net", "time": "2009-01-22T04:39:33Z", "bug_id": 46419, "creation_time": "2009-01-22T04:39:33Z", "attachment_id": 23159}, {"count": 5, "tags": [], "text": "Created attachment 23160\nSaved file using Apache POI. No changes from the original file\n\nOpen office can\u00b4t open this file.", "is_private": false, "id": 124279, "creator": "jmvazquez@lomg.net", "time": "2009-01-22T04:41:44Z", "bug_id": 46419, "creation_time": "2009-01-22T04:41:44Z", "attachment_id": 23160}, {"count": 6, "tags": [], "bug_id": 46419, "attachment_id": null, "id": 124280, "creation_time": "2009-01-22T04:42:50Z", "time": "2009-01-22T04:42:50Z", "creator": "jmvazquez@lomg.net", "text": "I attached the Original file and the saved file which I have the problem. I can open the saved file with Office Excel, but not with OpenOffice Calc. I only opened and saved the the file without changes and in a different path. \n\nSorry but we had a lot of problems to can unprotect the file and publish it.\n\nThanks.", "is_private": false}, {"count": 7, "tags": [], "bug_id": 46419, "attachment_id": null, "is_private": false, "id": 128324, "time": "2009-06-26T08:14:49Z", "creator": "lnelson@llnl.gov", "creation_time": "2009-06-26T08:14:49Z", "text": "*** Bug 47432 has been marked as a duplicate of this bug. ***"}, {"count": 8, "tags": [], "bug_id": 46419, "attachment_id": null, "is_private": false, "id": 129076, "time": "2009-07-23T07:40:42Z", "creator": "lnelson@llnl.gov", "creation_time": "2009-07-23T07:40:42Z", "text": "I wrote a simple java class to work around this issue and make the xlsx files generated by POI compatible with OpenOffice.  We use it when generating all of our xlsx files as an interim solution while the OpenOffice bug sits there and does nothing :-)  It is attached as OpenOfficeXlsxRepair.java\n\n--Leif"}, {"count": 9, "tags": [], "bug_id": 46419, "attachment_id": 24027, "is_private": false, "id": 129077, "time": "2009-07-23T07:42:47Z", "creator": "lnelson@llnl.gov", "creation_time": "2009-07-23T07:42:47Z", "text": "Created attachment 24027\nOpenOfficeXlsxRepair.java - simple java class that works around OpenOffice issues - uses truezip: https://truezip.dev.java.net/"}, {"count": 10, "tags": [], "text": "(In reply to comment #9)\n> Created an attachment (id=24027) [details]\n> OpenOfficeXlsxRepair.java - simple java class that works around OpenOffice\n> issues\n\nFYI.  This class uses truezip to manipulate the contents of the xlsx zip file: https://truezip.dev.java.net/", "is_private": false, "id": 129078, "creator": "lnelson@llnl.gov", "time": "2009-07-23T07:45:43Z", "bug_id": 46419, "creation_time": "2009-07-23T07:45:43Z", "attachment_id": null}, {"count": 11, "tags": [], "bug_id": 46419, "attachment_id": null, "is_private": false, "id": 129107, "time": "2009-07-24T01:40:08Z", "creator": "yegor@dinom.ru", "creation_time": "2009-07-24T01:40:08Z", "text": "I fixed POI to produce files compatible with OpenOffice.\nThe fix was committed in r797350\n\nYegor"}, {"count": 12, "tags": [], "text": "Thank you Yegor!  I will remove my workaround for around this :-)\n\n--Leif", "is_private": false, "id": 129171, "creator": "lnelson@llnl.gov", "time": "2009-07-27T07:45:43Z", "bug_id": 46419, "creation_time": "2009-07-27T07:45:43Z", "attachment_id": null}, {"count": 13, "tags": [], "bug_id": 46419, "attachment_id": null, "is_private": false, "id": 129194, "time": "2009-07-28T03:07:23Z", "creator": "jmvazquez@lomg.net", "creation_time": "2009-07-28T03:07:23Z", "text": "Thanks Yegor and Leif for solving the bug."}]