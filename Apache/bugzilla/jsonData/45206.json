[{"count": 0, "tags": [], "creator": "kayamkulamkochunni@gmail.com", "attachment_id": null, "id": 117699, "time": "2008-06-14T17:12:40Z", "bug_id": 45206, "creation_time": "2008-06-14T17:12:40Z", "is_private": false, "text": "The following example is not an array product. When you create an excel file and use the following forumula, we see a #VALUE. However if you click on the cell and press enter, the number gets populated. I am guessing this is some kind of bug related to the unique way this formula works. \n\n=SUMPRODUCT(('SHEET1'!C3:C751=Summary!F22)*('SHEET1'!D3:D751=Summary!G22),'SHEET1'!AF3:AF751)"}, {"count": 1, "tags": [], "bug_id": 45206, "is_private": false, "id": 117708, "creation_time": "2008-06-15T15:28:36Z", "time": "2008-06-15T15:28:36Z", "creator": "josh@apache.org", "text": "Looks like this was fixed with bug 45060. This bug is visible in 3.1-beta2 but the fix should be available in 3.1-final.  It is also available in svn trunk.\n\nJust to be sure, the existing unit test was modified (svn r668014) to add this example. Here is a trace from successful execution of the new test case:\n\nSUMPRODUCT((Sheet1!C3:C751=Sheet1!F22)*(Sheet1!D3:D751=Sheet1!G22),Sheet1!AF3:AF751)\n  token[0] org.apache.poi.hssf.record.formula.Area3DPtg [sheetIx=0 ! C3:C751] A\n  token[1] org.apache.poi.hssf.record.formula.Ref3DPtg [sheetIx=0 ! F22] A\n  token[4] org.apache.poi.hssf.record.formula.Area3DPtg [sheetIx=0 ! D3:D751] A\n  token[5] org.apache.poi.hssf.record.formula.Ref3DPtg [sheetIx=0 ! G22] A\n  token[9] org.apache.poi.hssf.record.formula.Area3DPtg [sheetIx=0 ! AF3:AF751] A\n  token[10] org.apache.poi.hssf.record.formula.FuncVarPtg [SUMPRODUCT nArgs=2] V\n\nIn 3.1-beta2, tokens 0,1,4,5 are erroneously encoded as operand class 'V'\n\n\n\n\n\n*** This bug has been marked as a duplicate of bug 45060 ***", "attachment_id": null}]