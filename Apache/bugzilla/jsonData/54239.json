[{"count": 0, "tags": [], "creator": "xshao@ebay.com", "text": "Created attachment 29684\nInterface of ELInterpreter\n\nIn some cases, applications need doing code generation for EL to make EL evaluation more faster.\n\nIt's better for tomcat to provide an extensible EL Interpreter. So application can inject it's own ELInterpreter to replace the default JspUtil.interpreterCall.\n\nAttached an implementation.", "id": 163823, "time": "2012-12-04T06:56:18Z", "bug_id": 54239, "creation_time": "2012-12-04T06:56:18Z", "is_private": false, "attachment_id": 29684}, {"count": 1, "tags": [], "bug_id": 54239, "attachment_id": 29685, "text": "Created attachment 29685\nELInterpreterFactory", "id": 163824, "time": "2012-12-04T06:56:48Z", "creator": "xshao@ebay.com", "creation_time": "2012-12-04T06:56:48Z", "is_private": false}, {"count": 2, "attachment_id": 29686, "bug_id": 54239, "text": "Created attachment 29686\nPatch for Generator.java", "id": 163825, "time": "2012-12-04T06:57:26Z", "creator": "xshao@ebay.com", "creation_time": "2012-12-04T06:57:26Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 54239, "attachment_id": 29685, "text": "Comment on attachment 29685\nELInterpreterFactory\n\nIn principle this looks like a good idea.\n\nI have a couple of concerns with the patch as currently written:\n1. No documentation.\n2. No test cases.\n3. The use of enum for the default instance is rather odd.\n4. I dislike the use of system properties when they are not necessary. If the class name was handled as a servlet context initialization parameters then Tomcat already has the necessary plumbing for global, per host and per web application configuration.\n5. Error messages need to use the standard i18n support.", "id": 163831, "time": "2012-12-04T08:37:15Z", "creator": "markt@apache.org", "creation_time": "2012-12-04T08:37:15Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 54239, "attachment_id": null, "text": "Thanks Mark.\n\nI'll provide document & test cases for BUG 54239-54242.", "id": 163847, "time": "2012-12-04T13:46:14Z", "creator": "xshao@ebay.com", "creation_time": "2012-12-04T13:46:14Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 54239, "attachment_id": 29693, "text": "Created attachment 29693\nInterface of ELInterpreter\n\nAdd more comments", "id": 163877, "time": "2012-12-05T09:37:12Z", "creator": "xshao@ebay.com", "creation_time": "2012-12-05T09:37:12Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 54239, "attachment_id": 29694, "id": 163878, "time": "2012-12-05T09:37:47Z", "creator": "xshao@ebay.com", "creation_time": "2012-12-05T09:37:47Z", "is_private": false, "text": "Created attachment 29694\nELInterpreterFactory\n\nAdded more comments"}, {"count": 7, "tags": [], "bug_id": 54239, "attachment_id": 29695, "text": "Created attachment 29695\nPatch for Generator.java\n\nPatch for Generator.java & LocalStrings.*", "id": 163879, "time": "2012-12-05T09:38:30Z", "creator": "xshao@ebay.com", "creation_time": "2012-12-05T09:38:30Z", "is_private": false}, {"attachment_id": 29696, "tags": [], "creator": "xshao@ebay.com", "text": "Created attachment 29696\nTest case for ELInterpreterFactory\n\nTest case for ELInterpreterFactory", "count": 8, "id": 163880, "time": "2012-12-05T09:39:24Z", "bug_id": 54239, "creation_time": "2012-12-05T09:39:24Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 54239, "text": "(In reply to comment #3)\n> Comment on attachment 29685 [details]\n> ELInterpreterFactory\n> \n> In principle this looks like a good idea.\n> \n> I have a couple of concerns with the patch as currently written:\n> 1. No documentation.\n     ~~~~~~~~~~~~~~~~~ Added more comments in ELInterpreter & ELInterpreterFactory\n> 2. No test cases.\n     ~~~~~~~~~~~~~~~~~ Provided a test case for ELInterpreterFactory\n\n> 3. The use of enum for the default instance is rather odd.\n     ~~~~~~~~~~~~~~~~~ Fixed\n\n> 4. I dislike the use of system properties when they are not necessary. If\n> the class name was handled as a servlet context initialization parameters\n> then Tomcat already has the necessary plumbing for global, per host and per\n> web application configuration.\n     ~~~~~~~~~~~~~~~~~~ Supported passing the class name from context initialization parameters. Still keep the feature from System Property. \n     In our case, System Property can be easily passed in from such kind of Daemon-Watcher, For example: JSW.\n\n> 5. Error messages need to use the standard i18n support.\n     ~~~~~~~~~~~~~~~~~~ Fixed", "count": 9, "id": 163881, "time": "2012-12-05T09:50:06Z", "creator": "xshao@ebay.com", "creation_time": "2012-12-05T09:50:06Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "rainer.jung@kippdata.de", "text": "(In reply to comment #9)\n> (In reply to comment #3)\n\n> > 4. I dislike the use of system properties when they are not necessary. If\n> > the class name was handled as a servlet context initialization parameters\n> > then Tomcat already has the necessary plumbing for global, per host and per\n> > web application configuration.\n>      ~~~~~~~~~~~~~~~~~~ Supported passing the class name from context\n> initialization parameters. Still keep the feature from System Property. \n>      In our case, System Property can be easily passed in from such kind of\n> Daemon-Watcher, For example: JSW.\n\nI haven't looked at the details here but it might be useful for you that system properties are automaticaly supported in most Tomcat config files, e.g. in server.xml and context.xml. What should work if you already support a className attribute is className=\"${my.el.interpreter}\" (using a system property reference) and setting the system property via \"-Dmy.el.interpreter=some.class.i.Use\". No need for special code or a fixed system property name for this type of use case.\n\nRegards,\n\nRainer", "count": 10, "id": 163888, "time": "2012-12-05T13:50:58Z", "bug_id": 54239, "creation_time": "2012-12-05T13:50:58Z", "is_private": false}, {"count": 11, "tags": [], "bug_id": 54239, "attachment_id": null, "id": 163896, "time": "2012-12-06T00:45:20Z", "creator": "xshao@ebay.com", "creation_time": "2012-12-06T00:45:20Z", "is_private": false, "text": "Thank you very much for your information! \nI'll try to follow up with this approach.\n\n(In reply to comment #10)\n> (In reply to comment #9)\n> > (In reply to comment #3)\n> \n> > > 4. I dislike the use of system properties when they are not necessary. If\n> > > the class name was handled as a servlet context initialization parameters\n> > > then Tomcat already has the necessary plumbing for global, per host and per\n> > > web application configuration.\n> >      ~~~~~~~~~~~~~~~~~~ Supported passing the class name from context\n> > initialization parameters. Still keep the feature from System Property. \n> >      In our case, System Property can be easily passed in from such kind of\n> > Daemon-Watcher, For example: JSW.\n> \n> I haven't looked at the details here but it might be useful for you that\n> system properties are automaticaly supported in most Tomcat config files,\n> e.g. in server.xml and context.xml. What should work if you already support\n> a className attribute is className=\"${my.el.interpreter}\" (using a system\n> property reference) and setting the system property via\n> \"-Dmy.el.interpreter=some.class.i.Use\". No need for special code or a fixed\n> system property name for this type of use case.\n> \n> Regards,\n> \n> Rainer"}, {"count": 12, "tags": [], "creator": "xshao@ebay.com", "text": "Created attachment 29704\nTest case for ELInterpreterFactory", "id": 163898, "time": "2012-12-06T05:09:32Z", "bug_id": 54239, "creation_time": "2012-12-06T05:09:32Z", "is_private": false, "attachment_id": 29704}, {"count": 13, "tags": [], "creator": "xshao@ebay.com", "attachment_id": 29705, "text": "Created attachment 29705\nELInterpreterFactory", "id": 163899, "time": "2012-12-06T05:10:14Z", "bug_id": 54239, "creation_time": "2012-12-06T05:10:14Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "xshao@ebay.com", "text": "All have been fixed by your suggestion. Please take a look. Thanks.\n\n(In reply to comment #3)\n> Comment on attachment 29685 [details]\n> ELInterpreterFactory\n> \n> In principle this looks like a good idea.\n> \n> I have a couple of concerns with the patch as currently written:\n> 1. No documentation.\n> 2. No test cases.\n> 3. The use of enum for the default instance is rather odd.\n> 4. I dislike the use of system properties when they are not necessary. If\n> the class name was handled as a servlet context initialization parameters\n> then Tomcat already has the necessary plumbing for global, per host and per\n> web application configuration.\n> 5. Error messages need to use the standard i18n support.", "count": 14, "id": 163900, "time": "2012-12-06T05:11:16Z", "bug_id": 54239, "creation_time": "2012-12-06T05:11:16Z", "is_private": false}, {"count": 15, "tags": [], "bug_id": 54239, "text": "Created attachment 29706\nInterface of ELInterpreter\n\nAdded License information at the front of java file", "id": 163903, "attachment_id": 29706, "creator": "xshao@ebay.com", "creation_time": "2012-12-06T06:01:30Z", "time": "2012-12-06T06:01:30Z", "is_private": false}, {"count": 16, "tags": [], "bug_id": 54239, "attachment_id": 29707, "id": 163904, "time": "2012-12-06T06:02:32Z", "creator": "xshao@ebay.com", "creation_time": "2012-12-06T06:02:32Z", "is_private": false, "text": "Created attachment 29707\nELInterpreterFactory\n\nAdded APLV2.0 into ELInterpreterFactory.java"}, {"count": 17, "tags": [], "bug_id": 54239, "attachment_id": 29708, "text": "Created attachment 29708\nTest case for ELInterpreterFactory\n\nAdded APL into TestELInterpreterFactory.java", "id": 163905, "time": "2012-12-06T06:03:46Z", "creator": "xshao@ebay.com", "creation_time": "2012-12-06T06:03:46Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "xshao@ebay.com", "text": "Hi Mark,\n\nThe code has been refined. Test cases and document also have been provided. \n\nCould you please take a look ?", "count": 18, "id": 164371, "time": "2013-01-04T09:15:30Z", "bug_id": 54239, "creation_time": "2013-01-04T09:15:30Z", "is_private": false}, {"count": 19, "tags": [], "creator": "markt@apache.org", "text": "Patch applied to trunk and 7.0.x with a few tweaks here and there and the addition of some very basic documentation.\n\nIt will be included in 7.0.37 onwards.", "id": 165201, "time": "2013-02-12T14:57:01Z", "bug_id": 54239, "creation_time": "2013-02-12T14:57:01Z", "is_private": false, "attachment_id": null}]