[{"count": 0, "tags": [], "bug_id": 28231, "is_private": false, "text": "This is a big problem because the creating applications (Word, Excel) will open \nthese files with no problems. I get the following stacktrace:\njava.io.IOException: Unable to read entire block; 1 byte read; expected 512 \nbytes\n\n\tat org.apache.poi.poifs.storage.RawDataBlock.<init>\n(RawDataBlock.java:62)\n\n\tat org.apache.poi.poifs.storage.RawDataBlockList.<init>\n(RawDataBlockList.java:51)\n\n\tat org.apache.poi.poifs.filesystem.POIFSFileSystem.<init>\n(POIFSFileSystem.java:86)\n\n\tat td.plugin.thumbnail.OleThumbnailRenderer.createRenderedImage\n(OleThumbnailRenderer.java:95)\n\n\tat td.plugin.thumbnail.OleThumbnailRenderer.main\n(OleThumbnailRenderer.java:218)", "id": 55403, "time": "2004-04-06T15:00:03Z", "creator": "sackley@cfl.rr.com", "creation_time": "2004-04-06T15:00:03Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "trejkaz@trypticon.org", "text": "I get this a lot, particularly on Microsoft Works documents.\n", "count": 1, "id": 87090, "time": "2006-03-21T23:14:47Z", "bug_id": 28231, "creation_time": "2006-03-21T23:14:47Z", "is_private": false}, {"count": 2, "tags": [], "text": "Created attachment 17933\nWorkaround for this issue\n\nHere's how I worked around this issue.\n\nHowever, you'll probably find that the file has been truncated, so an error\nwill come from somewhere else once you avoid this one.", "is_private": false, "id": 87091, "creator": "trejkaz@trypticon.org", "time": "2006-03-21T23:16:52Z", "bug_id": 28231, "creation_time": "2006-03-21T23:16:52Z", "attachment_id": 17933}, {"count": 3, "tags": [], "bug_id": 28231, "is_private": false, "text": "Created attachment 17934\nBetter workaround :)", "id": 87095, "time": "2006-03-22T03:03:05Z", "creator": "trejkaz@trypticon.org", "creation_time": "2006-03-22T03:03:05Z", "attachment_id": 17934}, {"count": 4, "tags": [], "bug_id": 28231, "is_private": false, "text": "Any chance of getting this one committed?  Is there something else required?\n", "id": 96136, "time": "2006-11-23T20:14:19Z", "creator": "trejkaz@trypticon.org", "creation_time": "2006-11-23T20:14:19Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 28231, "text": "Possibly the same as 42834. Similar issues, similar but different patch.", "id": 106040, "time": "2007-07-29T20:23:38Z", "creator": "paulk@asert.com.au", "creation_time": "2007-07-29T20:23:38Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "text": "I am new to POI and I get this error with the latest version 3.0.2. I only have tried this with Word 2007 documents since that is what I am concerned with. I see this was bug back from 2005. Has anyone developed  a real solution to this problem yet? I would send some sample docs but I am on a secure network so I can't.\n\n ", "is_private": false, "id": 114303, "creator": "scott_cornwell@hotmail.com", "time": "2008-03-05T14:29:01Z", "bug_id": 28231, "creation_time": "2008-03-05T14:29:01Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 28231, "is_private": false, "text": "Does the patch not work for you?\n", "id": 114304, "time": "2008-03-05T14:31:28Z", "creator": "trejkaz@trypticon.org", "creation_time": "2008-03-05T14:31:28Z", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 28231, "is_private": false, "text": "I assumed a patch from 2006 would be included in the latest release. So are you saying it is not? I did look at the source yet...", "id": 114305, "time": "2008-03-05T14:37:07Z", "creator": "scott_cornwell@hotmail.com", "creation_time": "2008-03-05T14:37:07Z", "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 28231, "is_private": false, "text": "A rule of thumb is that if a bug is still NEW, the patch hasn't been put in.  Otherwise it would be RESOLVED FIXED.\n\nCertainly this patch works for us.  Why it hasn't been committed is anyone's guess.  Probably someone wants to keep throwing the error because the document is \"technically\" invalid OLE2.  Unfortunately Microsoft's own software generates files with this problem when the last block isn't completely used...\n", "id": 114308, "time": "2008-03-05T14:48:41Z", "creator": "trejkaz@trypticon.org", "creation_time": "2008-03-05T14:48:41Z", "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 28231, "text": "Yes, I supplied a similar patch to issue 42834 which was never supplied \"because it didn't follow OLE2 rules\" but documents produced from crystal reports and Microsoft themselves and other vendors don't follow these rules. We manually patched POI ourselves and have successfully been using the patched version for two years with these kinds of files. Sure would be nice for the official version not to be broken though rather than us having to keep patching it.", "id": 114314, "time": "2008-03-05T17:43:47Z", "creator": "paulk@asert.com.au", "creation_time": "2008-03-05T17:43:47Z", "is_private": false, "attachment_id": null}, {"count": 11, "tags": [], "bug_id": 28231, "text": "OK, looks like the changes for 42834 haven't fixed this\n\nI've updated svn trunk to issue an error about a probably truncated file, but still carry on. Affected people may wish to open bug reports with the people who make the software that produces these files, as OLE2 documents are required to be multiples of 512 bytes...", "id": 114341, "time": "2008-03-06T07:52:51Z", "creator": "apache@gagravarr.org", "creation_time": "2008-03-06T07:52:51Z", "is_private": false, "attachment_id": null}, {"count": 12, "tags": [], "bug_id": 28231, "is_private": false, "text": "Microsoft don't even have a bug tracking system, and filing a bug won't solve all the existing files anyway.  But thanks for getting this in, it's one less custom patch for our local branch.\n\n\nIt's true that they're supposed to be multiples of 512 bytes, but if the last block in the file contains the end of a stream (happens fairly often) and the stream itself isn't a multiple of 512 bytes (also happens fairly often), sometimes they just don't pad it out to the 512-byte boundary.  But since the stream length is declared elsewhere in the file and all the bytes in the stream are present, it seems silly to even warn about it possibly being truncated as none of the real data has been lost, only the padding.\n\nIf a stream itself is truncated (declared to be longer than the amount of data available in its blocks) or if a block declared in the file isn't actually present... that sort of thing is a critical error still, of course.\n", "id": 114375, "time": "2008-03-06T12:52:51Z", "creator": "trejkaz@trypticon.org", "creation_time": "2008-03-06T12:52:51Z", "attachment_id": null}, {"count": 13, "attachment_id": null, "bug_id": 28231, "text": "Guys thanks for readdressing this. I didn't have time to try it today with the patch but I am sure there will be lots of people very interested in using this product which they assumed didn't work for MS documents. I am not sure why we generate hundreds of documents which all fail but they do. \n\nIs it possible to use the poibrowser to identify what the block size is? 512 or other? I believe the poibrowser reads in these documents fine.", "id": 114391, "time": "2008-03-06T16:58:27Z", "creator": "scott_cornwell@hotmail.com", "creation_time": "2008-03-06T16:58:27Z", "tags": [], "is_private": false}, {"count": 14, "tags": [], "bug_id": 28231, "is_private": false, "text": "I'm not sure how our current block parsing code would know that we're on the last block, and that it's due to be short, so not warn if there's no padding\n\nDo please submit a patch if you can think of a nice way to tell the block code not to issue a warning :)", "id": 114403, "time": "2008-03-07T02:20:26Z", "creator": "apache@gagravarr.org", "creation_time": "2008-03-07T02:20:26Z", "attachment_id": null}, {"count": 15, "tags": [], "creator": "paulk@asert.com.au", "is_private": false, "id": 114404, "attachment_id": null, "bug_id": 28231, "creation_time": "2008-03-07T02:42:29Z", "time": "2008-03-07T02:42:29Z", "text": "Thanks for fixing this. Great news. Personally, I would have just set the log level to 'warning' and said 'possibly' truncated rather than 'probably' truncated as we have thousands of files the aren't truncated that will trigger this log message every day and I would be surprised if we have ever more than 1 or 2 files actually truncated in 2 years (if we have ever had any - I certainly don't recall any)."}, {"count": 16, "tags": [], "bug_id": 28231, "is_private": false, "text": "FYI, I pulled down your patch, rebuilt the code and as expected it worked like a charmed. Thanks!", "id": 114438, "time": "2008-03-07T15:42:53Z", "creator": "scott_cornwell@hotmail.com", "creation_time": "2008-03-07T15:42:53Z", "attachment_id": null}]