[{"count": 0, "tags": [], "bug_id": 45066, "text": "This bug is one of a few noticed while working on bug 45046.\n\nInspection of Sheet.getSize() and Sheet.serialize() shows that the presence of UncalcedRecord is handled differently.  The discrepancy causes wrong offset values to be encoded into BoundSheetRecord.  If there is more than one sheet, Excel will report errors and loose data when trying to open the book.\n\nTo reproduce: Create a spreadsheet in Excel with 2 sheets. Change the workbook settings for 'recalculation' to 'manual' and uncheck the 'recalculate before save' option.  Add any formula to the first sheet. Save. Read with POI and write back. Open in Excel. boom.\n\nPerhaps the biggest problem here is that HSSFWorkbook asks all the sheets for their sizes, but then doesn't care how much space they take when they are serialized.", "id": 116913, "time": "2008-05-22T20:45:57Z", "creator": "josh@apache.org", "creation_time": "2008-05-22T20:45:57Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "josh@apache.org", "attachment_id": null, "text": "Fixed in svn r659403.\n\nHSSFWorkbook was modified to always check that the return values from sheet.getSize() match those from sheet.serialize().\n\nSheet was modified to handle UncalcedRecord consistently.\n\nJunits were added for both changes.", "id": 116914, "time": "2008-05-22T21:02:55Z", "bug_id": 45066, "creation_time": "2008-05-22T21:02:55Z", "is_private": false}]