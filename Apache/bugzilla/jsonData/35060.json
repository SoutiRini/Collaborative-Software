[{"count": 0, "tags": [], "bug_id": 35060, "attachment_id": null, "is_private": false, "id": 75339, "time": "2005-05-25T14:16:14Z", "creator": "kajtzu@basen.net", "creation_time": "2005-05-25T14:16:14Z", "text": "Something changed in ant between version 1.6.2 and 1.6.4 which leads to the fact\nthat jar files placed in ~/.ant/lib are not being used by ant anymore. I looked\nat Launcher.java which seems to have been rewritten w.r.t. finding the .ant/lib\ndirectory but then stracing the ant process does show that the file gets at\nleast statted but it doesn't seem to be used.\n\n% jar tvf ~/.ant/lib/ant-contrib-basen-bootstrap.jar\n     0 Wed Jul 28 22:36:10 EEST 2004 META-INF/\n   379 Wed Jul 28 22:36:08 EEST 2004 META-INF/MANIFEST.MF\n     0 Wed Jul 28 21:39:48 EEST 2004 net/\n     0 Wed Jul 28 21:39:48 EEST 2004 net/basen/\n     0 Wed Jul 28 21:39:48 EEST 2004 net/basen/antcontrib/\n     0 Wed Jul 28 22:36:08 EEST 2004 net/basen/antcontrib/bootstrap/\n  4159 Wed Jul 28 22:36:08 EEST 2004\nnet/basen/antcontrib/bootstrap/BasenTaskdef.class\n    58 Wed Jul 28 22:36:08 EEST 2004\nnet/basen/antcontrib/bootstrap/bootstrap.properties\n\n% ant\nBuildfile: build.xml\n  [taskdef] Could not load definitions from resource\nnet/basen/antcontrib/bootstrap/bootstrap.properties. It could not be found.\n\nBUILD FAILED\n/usr/src/cvs-in/FortN/FortN/build.xml:35: Could not create task or type of type:\nbasentaskdef.\n\nAnt could not find the task or a class this task relies upon.\n\nThis is common and has a number of causes; the usual\nsolutions are to read the manual pages then download and\ninstall needed JAR files, or fix the build file:\n - You have misspelt 'basentaskdef'.\n   Fix: check your spelling.\n - The task needs an external JAR file to execute\n     and this is not found at the right place in the classpath.\n   Fix: check the documentation for dependencies.\n   Fix: declare the task.\n - The task is an Ant optional task and the JAR file and/or libraries\n     implementing the functionality were not found at the time you\n     yourself built your installation of Ant from the Ant sources.\n   Fix: Look in the ANT_HOME/lib for the 'ant-' JAR corresponding to the\n     task and make sure it contains more than merely a META-INF/MANIFEST.MF.\n     If all it contains is the manifest, then rebuild Ant with the needed\n     libraries present in ${ant.home}/lib/optional/ , or alternatively,\n     download a pre-built release version from apache.org\n - The build file was written for a later version of Ant\n   Fix: upgrade to at least the latest release version of Ant\n - The task is not an Ant core or optional task\n     and needs to be declared using <taskdef>.\n - You are attempting to use a task defined using\n    <presetdef> or <macrodef> but have spelt wrong or not\n   defined it at the point of use\n\nRemember that for JAR files to be visible to Ant tasks implemented\nin ANT_HOME/lib, the files must be in the same directory or on the\nclasspath\n\nPlease neither file bug reports on this problem, nor email the\nAnt mailing lists, until all of these causes have been explored,\nas this is not an Ant bug.\n\nTotal time: 0 seconds\n\n\n\nAny thoughts?"}, {"count": 1, "tags": [], "bug_id": 35060, "attachment_id": null, "is_private": false, "id": 75430, "time": "2005-05-26T18:53:37Z", "creator": "peterreilly@apache.org", "creation_time": "2005-05-26T18:53:37Z", "text": "can you please give a small self contained example.\nMy testing with ant 1.6.4 does no show this problem"}, {"count": 2, "tags": [], "bug_id": 35060, "attachment_id": null, "is_private": false, "id": 75522, "time": "2005-05-27T16:07:03Z", "creator": "kajtzu@basen.net", "creation_time": "2005-05-27T16:07:03Z", "text": "(In reply to comment #1)\n> can you please give a small self contained example.\n> My testing with ant 1.6.4 does no show this problem\n\nAfter further investigation the problem seems to lie in the fact that I/we use\nJPackage rpms for ant and the way the files are laid out there; ant.jar and\nant-launcher.jar are found in /usr/share/java/ while everything else is in\n/usr/share/java/ant/. Things work really well if I move/copy ant.jar and\nant-launcher.jar to the /usr/share/java/ant/ subdirectory - this one directory\napproach is also the one you guys have in your ant binary distribution.\n\nPlaying around with the ant shell script (sh -x ant, really) I noticed that\n1.6.2 starts as follows:\n\n/usr/lib/jvm/java/bin/java -classpath\n/usr/share/java/ant.jar:/usr/share/java/ant-launcher.jar:/usr/share/java/jaxp_parser_impl.jar:/usr/share/java/xml-commons-apis.jar:/usr/lib/jvm/java/lib/tools.jar\n-Dant.home=/usr/share/ant -Dant.library.dir=/usr/share/ant/lib\norg.apache.tools.ant.launch.Launcher -cp ''\n\nThe above does not seem to work at all with 1.6.4 while the one below works fine:\n\n/usr/lib/jvm/java/bin/java -classpath /usr/share/java/ant-launcher.jar\n-Dant.home=/usr/share/ant -Dant.library.dir=/usr/share/ant/lib\norg.apache.tools.ant.launch.Launcher -cp\n/usr/share/java/ant.jar:/usr/share/java/jaxp_parser_impl.jar:/usr/share/java/xml-commons-apis.jar:/usr/share/java/junit.jar:/usr/share/java/ant/ant-junit.jar:/usr/lib/jvm/java/lib/tools.jar\n\nThe jvm version is 1.4.2_08.\n\nMy original report of jars in ~/.ant/lib not being used wasn't true, it just\nlooked that way since ant didn't start up.\n\n"}, {"count": 3, "tags": [], "bug_id": 35060, "attachment_id": null, "text": "Jpackage has not released ant 1.6.3 or 1.6.4 yet. I do not\nknow if there is an issue with their packaging of ant 1.6.4,\nbut there has been no such bug reports (yet).\nIf you want to use ant 1.6.4, you will need to use the\nrelease from apache - try using the ant -noconfig options.\n\nI am marking this as invalid - please reopen if there\nis an issue with jpackage and ant 1.6.4 - if there\nis, there will of course need to be a fix.", "id": 75525, "time": "2005-05-27T17:41:56Z", "creator": "peterreilly@apache.org", "creation_time": "2005-05-27T17:41:56Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 35060, "is_private": false, "count": 4, "id": 115708, "time": "2008-04-18T15:54:27Z", "creator": "tbeattie@boingo.com", "creation_time": "2008-04-18T15:54:27Z", "text": "http://svn.apache.org/viewvc/ant/core/trunk/src/main/org/apache/tools/ant/util/ClasspathUtils.java?r1=276313&r2=277160&diff_format=h\n\nWhy does ClasspathUtils.getUniqueClassLoaderForPath no longer set the new class loader's classpath to the system class path when no explicit path is provided?\n\nI'm having this same problem with ivy.  I tried copying ant.jar and ant-launcher.jar to /usr/share/java/ant/ as Kaj suggested, but in my case I still got the error \"Could not create task or type of type: antlib:org.apache.ivy.ant:retrieve.\"\n\nI loaded up ant in Eclipse's debugger and tried to trace through it.  All of the jars in ~/.ant/lib/ are added to the java.class.path system property as well as the thread's context class loader, but when ant goes to load the resource \"org/apache/ivy/ant/antlib.xml\", it's not using that URLClassLoader; it's using a new AntClassLoader2 instead.\n"}]