[{"count": 0, "tags": [], "creator": "luke@cramvision.com", "attachment_id": null, "text": "I recently upgraded one of my RedHat7.1 servers running apache 1.3.20 to\nRedhat8.0 running Apache 1.3.26 and then 1.3.27 and I discovered that previously\ngood PHP code no longer worked. The code was simple file upload code for a multi\npart form with a form element input=\"file\". The POST data just didn't seem to\ncome through to the PHP code. I tried the same thing on a Redhat7.3 box running\napache 1.3.26 and then 1.3.27 and I got the same problem. As soon as I put the\nsame code back on version 1.3.20 on another server it worked first time. the\nfollowing is the code which I used to discover the problem.\n\n\n<HTML>\n<HEAD><TITLE>Store binary data into SQL Database</TITLE></HEAD>\n<BODY>\n\n<?php\n\nif ($upload) {\n\n    // connect to the database\n    // (you may have to adjust the hostname,username or password)\n\n$db = mysql_connect(\"192.168.x.x\",\"foo\",\"bar\"); mysql_select_db(\"graphic\",$db);\n\n@copy(\"$formdata\",\"./tempfile.jpg\");\n\n$size = GetImageSize(\"./tempfile.jpg\");\n\nif ($size[0] < $size[1]){\n$dataupright = \"1\";\n}\nelse {\n$dataupright = \"0\";\n}\n\n    $data = addslashes(fread(fopen($formdata, \"r\"), filesize($formdata)));\n\n    $result=MYSQL_QUERY(\"INSERT INTO binary_data\n(bin_data,file_name,file_size,file_type,dataupright) \".\n        \"VALUES\n('$data','$formdata_name','$formdata_size','$formdata_type','$dataupright')\");\n    $id= mysql_insert_id();\n?>\nPlease use the following tag to use this graphic.<br>\n<b>&lt;img src=\"getpicture.php?id=<?php echo $id?>\"&gt;</b><br>\n<?\n    MYSQL_CLOSE();\n} else {\n?>\n    <form method=\"post\" action=\"uploadgraphic.php\" enctype=\"multipart/form-data\">\n    <INPUT TYPE=\"hidden\" name=\"MAX_FILE_SIZE\" value=\"1000000\">\n    <br>File to upload/store in database:<br>\n    <input type=\"file\" name=\"formdata\"  size=\"40\">\n    <input type=\"hidden\" name=\"upload\" value=\"work please\">\n    <p><input type=\"submit\" name=\"submit\" value=\"submit\">\n    </form>\n<?php\n}\n?>\n</BODY>\n</HTML>", "id": 25294, "time": "2002-10-29T02:48:22Z", "bug_id": 14031, "creation_time": "2002-10-29T02:48:22Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 14031, "text": "register_globals PHP issue, perhaps, but not an httpd bug.", "id": 65578, "time": "2004-10-23T11:29:03Z", "creator": "jorton@redhat.com", "creation_time": "2004-10-23T11:29:03Z", "is_private": false, "attachment_id": null}]