[{"count": 0, "tags": [], "bug_id": 14292, "attachment_id": null, "is_private": false, "id": 25758, "time": "2002-11-06T10:12:39Z", "creator": "stefan.proels@gmx.de", "creation_time": "2002-11-06T10:12:39Z", "text": "JkCoyote does not write a status message after the status code in the HTTP\nresponse header. This causes problems with some proxies, e.g., domains hosted by\nStrato which are forwarded through Strato's proxies.\n\nThere are actually 2 bugs which cause the problem:\n\n1. JkCoyoteHandler.java always appends an empty status message instead of the\nreal one to the generated message. Here is my fix (relative to the current CVS\nrepository):\n\n--------------------------------------------------------------------\n--- JkCoyoteHandler.java\t2002-11-06 10:51:19.000000000 +0100\n+++ JkCoyoteHandler.java_new\t2002-11-06 10:08:56.000000000 +0100\n@@ -284,7 +284,10 @@\n         msg.appendInt( res.getStatus() );\n         \n         // s->b conversion, message\n-        msg.appendBytes( null );\n+\tMessageBytes mb = new MessageBytes();\n+\tmb.setString(res.getMessage());\n+\tc2b.convert (mb);\n+        msg.appendBytes(mb);\n         \n         // XXX add headers\n--------------------------------------------------------------------\n         \n2. Newly created Coyote Responses contain a status message of NULL instead of\n\"OK\". Here is my fix:\n\n--------------------------------------------------------------------\n--- Response.java\t2002-11-06 10:46:36.000000000 +0100\n+++ Response.java_new\t2002-11-06 10:04:49.000000000 +0100\n@@ -102,7 +102,7 @@\n     /**\n      * Status message.\n      */\n-    protected String message = null;\n+    protected String message = \"OK\";\n \n \n     /**\n@@ -316,7 +316,7 @@\n         contentLength = -1;\n \n         status = 200;\n-        message = null;\n+        message = \"OK\";\n         headers.clear();\n         \n         // Force the PrintWriter to flush its data to the output\n@@ -524,7 +524,7 @@\n         characterEncoding = Constants.DEFAULT_CHARACTER_ENCODING;\n         contentLength = -1;\n         status = 200;\n-        message = null;\n+        message = \"OK\";\n         commited = false;\n         errorException = null;\n         errorURI = null;\n--------------------------------------------------------------------\n\n\nCU,\nStefan"}, {"count": 1, "tags": [], "bug_id": 14292, "attachment_id": null, "id": 25760, "time": "2002-11-06T10:20:42Z", "creator": "remm@apache.org", "creation_time": "2002-11-06T10:20:42Z", "is_private": false, "text": "-1 to the patch to Response.java, which would cause problems to HTTP/1.1.\nInstead, you should check for null in the first case and do something else."}, {"count": 2, "tags": [], "bug_id": 14292, "attachment_id": null, "is_private": false, "id": 28019, "time": "2002-12-18T17:30:05Z", "creator": "stefan.proels@gmx.de", "creation_time": "2002-12-18T17:30:05Z", "text": "just a quick note: this bug ist still present in the 4.1.17 distribution."}, {"count": 3, "tags": [], "bug_id": 14292, "attachment_id": null, "text": "I committed a modified version of your fix.", "id": 33160, "time": "2003-03-14T00:05:10Z", "creator": "cmanolache@yahoo.com", "creation_time": "2003-03-14T00:05:10Z", "is_private": false}]