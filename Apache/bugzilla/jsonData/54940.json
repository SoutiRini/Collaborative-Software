[{"count": 0, "tags": [], "bug_id": 54940, "attachment_id": null, "id": 167094, "time": "2013-05-08T15:13:36Z", "creator": "andrew.cagney@gmail.com", "creation_time": "2013-05-08T15:13:36Z", "is_private": false, "text": "I'm trying to reconcile these bits of the documentation with the tests I've attached:\n\n\"Any target in the included file will be renamed to prefix.name where name is the original target's name and prefix is either the value of the as attribute or the name attribute of the project tag of the included file.\"\n\nI'm assuming this means that:\n  foo.xml:\n    <project name=\"foo\">...\n  bar.xml:\n    <include file=\"foo.xml\"/>\nand\n  foo.xml:\n    <project>...\n  bar.xml:\n    <include file=\"foo.xml\" as=\"foo\"/>\nare equivalent.\n\nAnd trying this for a simple include suggests my understanding is correct.\n\nThe documentation then goes on:\n\n\"The depends attribute of all included targets is rewritten so that all target names are prefixed as well. This makes the included file self-contained.\nNote that prefixes nest, so if a build file includes a file with prefix \"a\" and the included file includes another file with prefix \"b\", then the targets of that last build file will be prefixed by \"a.b.\".\"\n\nWhich I'm interpreting to mean that the above should still work when includes are nested.  Unfortunately, I'm finding that I need to specify \"as=\" to make things work.  For instance, the below which specifies \"as=\" on nested includes ...\n\nw.xml:\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project name=\"w\">\n    <echo>${ant.file.w}</echo>\n    <include file=\"x.xml\"/>\n    <target name=\"ww\" depends=\"x.xx, x.y.yy, x.y.z.zz\"/>\n</project>\n\nx.xml:\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project name=\"x\">\n    <echo>${ant.file.x}</echo>\n    <include file=\"y.xml\" as=\"y\"/>\n    <target name=\"xx\" depends=\"y.yy, y.z.zz\"/>\n</project>\n\ny.xml:\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project name=\"y\">\n    <echo>${ant.file.y}</echo>\n    <include file=\"z.xml\" as=\"z\"/>\n    <target name=\"yy\" depends=\"z.zz\"/>\n</project>\n\nz.xml:\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project name=\"z\">\n    <echo>${ant.file.z}</echo>\n    <target name=\"zz\"/>\n</project>\n\n... works as I would expect.  Both immediate (e.x.: \"ww\") and rewritten included targets work (e.x.: x.y.z.zz) vis:\n\n$ ant -f w.xml ww x.y.z.zz\nBuildfile: /home/work/senv/Build/good/w.xml\n     [echo] /home/work/senv/Build/good/w.xml\n     [echo] /home/work/senv/Build/good/x.xml\n     [echo] /home/work/senv/Build/good/y.xml\n     [echo] /home/work/senv/Build/good/z.xml\nx.y.z.zz:\nx.y.yy:\nx.xx:\nww:\nx.y.z.zz:\nBUILD SUCCESSFUL\nTotal time: 0 seconds\n\nHowever, when I remove the \"as=..\" things break down.  For instance, removng \"as=\"y\" from \"x.xml\"'s include of \"y.xml\", vis:\n\nx.xml:\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project name=\"x\">\n    <echo>${ant.file.x}</echo>\n    <include file=\"y.xml\"/>\n    <target name=\"xx\" depends=\"y.yy, y.z.zz\"/>\n</project>\n\nthen I get the error:\n\n$ ant -f w.xml ww\nBuildfile: /home/work/senv/Build/good/w.xml\n     [echo] /home/work/senv/Build/good/w.xml\n     [echo] /home/work/senv/Build/good/x.xml\n     [echo] /home/work/senv/Build/good/y.xml\n     [echo] /home/work/senv/Build/good/z.xml\nBUILD FAILED\nTarget \"x.y.yy\" does not exist in the project \"w\". It is used from target \"x.xx\"."}, {"count": 1, "tags": [], "creator": "andrew.cagney@gmail.com", "is_private": false, "id": 167098, "creation_time": "2013-05-08T16:49:22Z", "time": "2013-05-08T16:49:22Z", "bug_id": 54940, "text": "Seems to also be present in 1.9.0:\n\n$ JAVA_HOME=~software/jdk1.7.0_17 ~software/apache-ant-1.9.0/bin/ant -f w.xml ww\nBuildfile: /home/cagney/tmp/w.xml\n     [echo] /home/cagney/tmp/w.xml\n     [echo] /home/cagney/tmp/x.xml\n     [echo] /home/cagney/tmp/y.xml\n     [echo] /home/cagney/tmp/z.xml\nBUILD FAILED\nTarget \"x.y.yy\" does not exist in the project \"w\". It is used from target \"x.xx\".\nTotal time: 0 seconds\n\nupdated version link", "attachment_id": null}, {"count": 2, "tags": [], "text": "fixed in r1481662. Thanks for reporting the bug.", "is_private": false, "id": 167152, "creator": "antoine@apache.org", "time": "2013-05-12T22:38:49Z", "bug_id": 54940, "creation_time": "2013-05-12T22:38:49Z", "attachment_id": null}]