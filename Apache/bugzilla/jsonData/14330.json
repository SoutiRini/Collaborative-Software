[{"count": 0, "tags": [], "bug_id": 14330, "is_private": false, "text": "This seems similar to Bug 13796. The same workbook causes a similar, but \ndifferent, error in the usermodel.examples.EventExample class (recompiled, \nunchanged, into my own package for simplicity). Namely:\n\njava.lang.reflect.InvocationTargetException: java.lang.StringIndexOutOfBoundsExc\neption: String index out of range: 45\n        at java.lang.String.<init>(Unknown Source)\n        at java.lang.String.<init>(Unknown Source)\n        at org.apache.poi.hssf.record.formula.StringPtg.<init>(StringPtg.java:82\n)\n        at org.apache.poi.hssf.record.formula.Ptg.createPtg(Ptg.java:244)\n        at org.apache.poi.hssf.record.FormulaRecord.getParsedExpressionTokens(Fo\nrmulaRecord.java:171)\n        at org.apache.poi.hssf.record.FormulaRecord.fillFields(FormulaRecord.jav\na:147)\n        at org.apache.poi.hssf.record.Record.fillFields(Record.java:143)\n        at org.apache.poi.hssf.record.Record.<init>(Record.java:105)\n        at org.apache.poi.hssf.record.FormulaRecord.<init>(FormulaRecord.java:11\n8)\n        at java.lang.reflect.Constructor.newInstance(Native Method)\n        at org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.j\nava:252)\n        at org.apache.poi.hssf.eventmodel.HSSFEventFactory.genericProcessEvents(\nHSSFEventFactory.java:221)\n        at org.apache.poi.hssf.eventmodel.HSSFEventFactory.processEvents(HSSFEve\nntFactory.java:139)\n        at omvuk.util.EventExample.main(EventExample.java:93)\nException in thread \"main\" org.apache.poi.hssf.record.RecordFormatException: Una\nble to construct record instance, the following exception occured: null\n        at org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.j\nava:265)\n        at org.apache.poi.hssf.eventmodel.HSSFEventFactory.genericProcessEvents(\nHSSFEventFactory.java:221)\n        at org.apache.poi.hssf.eventmodel.HSSFEventFactory.processEvents(HSSFEve\nntFactory.java:139)\n        at omvuk.util.EventExample.main(EventExample.java:93)", "id": 25846, "time": "2002-11-07T08:26:21Z", "creator": "michael.tosdevin@btinternet.com", "creation_time": "2002-11-07T08:26:21Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 14330, "attachment_id": 3766, "text": "Created attachment 3766\nTest workbook demonstrating error", "id": 25847, "time": "2002-11-07T08:28:51Z", "creator": "michael.tosdevin@btinternet.com", "creation_time": "2002-11-07T08:28:51Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 14330, "text": "Created attachment 4065\nThis simple file replicates the problem. It appears to be due to the way in which strings are handled by StringPtg. The problem does not occur with SSTRecord (see next attachment).", "id": 27488, "time": "2002-12-06T13:50:25Z", "creator": "michael.tosdevin@btinternet.com", "creation_time": "2002-12-06T13:50:25Z", "is_private": false, "attachment_id": 4065}, {"count": 3, "tags": [], "bug_id": 14330, "is_private": false, "id": 27489, "creation_time": "2002-12-06T13:51:57Z", "time": "2002-12-06T13:51:57Z", "creator": "michael.tosdevin@btinternet.com", "text": "Created attachment 4066\nThis file does not have the problem even though it uses the same characters. LabelSSTRecord and SSTRecord appear to handle the character properly.", "attachment_id": 4066}, {"count": 4, "tags": [], "bug_id": 14330, "is_private": false, "text": "Works in CVS and possible 2.0pre3. Will be in the pre4 release. \n\nAdded both problem files as testcases. See test14330 in TestBugs.java", "id": 45168, "time": "2003-10-06T17:49:16Z", "creator": "avik@apache.org", "creation_time": "2003-10-06T17:49:16Z", "attachment_id": null}]