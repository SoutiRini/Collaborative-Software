[{"count": 0, "tags": [], "bug_id": 11618, "attachment_id": null, "id": 20884, "time": "2002-08-11T20:02:14Z", "creator": "siberian@siberian.org", "creation_time": "2002-08-11T20:02:14Z", "is_private": false, "text": "Using Mod_Rewrite in a [proxy] configuration, when it receives a Chunked\nEncoding request it appears that when apache makes the re-request it is\nstripping out the TE: and  Transfer-Encoding: headers as well as the chunk\nlength information. This appears very deliberate but I have no idea what its\ndoing it.\n\nBelow is a typical example of a captured session ( captured via tcpflow ).\n\nTested in 2.0.35, 2.0.39 an 2.0.40\n\n--------------------------------------\n- Rewrite Rule handling this request -\n--------------------------------------\nRewriteRule ^/pmcserver(.*)$ http://128.241.116.14:6208/pmcserver$1 [proxy]\n\n----------------------------\n- ORIGINAL INBOUND REQUEST -\n----------------------------\nPOST /pmcserver/GetServerTime/ HTTP/1.1\nHost: pre.printme.com:443\nUser-Agent: Mozilla/4.0 (compatible)\nProxy-Connection: close\nConnection: close\nAccept: */*\nContent-Type: application/octet-stream\nTE: chunked\nAccept-Encoding: deflate\nContent-Encoding: deflate\nTransfer-Encoding: chunked\nCache-Control: no-cache, no-transform, no-store\nPragma: no-cache\nX-PrintMe-XML-Length: 579\nVia: 1.1 128.241.116.8 (Alteon iSD-SSL/2.0)\nX-SSL: decrypted=true, ciphers=\"TLSv1/SSLv3 RC4-SHA\"\n\n177\nx.uR.n.0...+P.....W.#....J.H{.Rp.j...>....#.J>..........5xs...~...h....u.7......j+/D.+y..?.M..'?@...}......oD..........D.D3...\nD[Kco..?Ow...!..y.U........f...`A.......9....9xbuc..=..y0p.....|o.....G.......]y....*?.\"......;Hh8..s.....il.p.88.P...T.........f.2*]..-+X..!y...(M\n...b9...\"5J.........f*U.#.+......4.(V...K.c.b..O.U.Q.....#.Rcp...D..3.0.6o\nl9_..vS..0d.6D.)..W|.o...\n0\n\n\n-------------------------\n- REVERSE PROXY REQUEST -\n-------------------------\nPOST /pmcserver/GetServerTime/ HTTP/1.1\nHost: 128.241.116.14:6208\nUser-Agent: Mozilla/4.0 (compatible)\nAccept: */*\nContent-Type: application/octet-stream\nAccept-Encoding: deflate\nContent-Encoding: deflate\nCache-Control: no-cache, no-transform, no-store\nPragma: no-cache\nX-PrintMe-XML-Length: 579\nVia: 1.1 128.241.116.8 (Alteon iSD-SSL/2.0), 1.1 pre.printme.com:443\nX-SSL: decrypted=true, ciphers=\"TLSv1/SSLv3 RC4-SHA\"\nMax-Forwards: 10\nConnection: close\nX-Forwarded-For: 10.10.99.83\nX-Forwarded-Host: pre.printme.com:443\nX-Forwarded-Server: pre.printme.com\n\n\nx.uR.n.0...+P.....W.#....J.H{.Rp.j...>....#.J>..........5xs...~...h....u.7......j+/D.+y..?.M..'?@...}......oD..........D.D3...\nD[Kco..?Ow...!..y.U........f...`A.......9....9xbuc..=..y0p.....|o.....G.......]y....*?.\"......;Hh8..s.....il.p.88.P...T.........f.2*]..-+X..!y...(M\n...b9...\"5J.........f*U.#.+......4.(V...K.c.b..O.U.Q.....#.Rcp...D..3.0.6o\nl9_..vS..0d.6D.)..W|.o...\n\n\nHTTP/1.1 411 Length Required\nContent-type: text/plain\nConnection: close\nContent-Length: 0"}, {"count": 1, "text": "So essentially the proxy is dechunking (which is fine) but not supplying\na content-length (which is not fine).  I think this is actually a mod_proxy\nbug and not a mod_rewrite bug, so I'll reassign accordingly.", "bug_id": 11618, "attachment_id": null, "id": 21292, "time": "2002-08-19T17:50:03Z", "creator": "slive@apache.org", "creation_time": "2002-08-19T17:50:03Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "siberian@siberian.org", "is_private": false, "id": 21293, "creation_time": "2002-08-19T17:55:18Z", "time": "2002-08-19T17:55:18Z", "bug_id": 11618, "text": "This sounds about right.\n\nShould it even dechunk though or should it act transparently and just pass the \ndata through with no manipulation?", "attachment_id": null}, {"count": 3, "tags": [], "creator": "wrowe@apache.org", "attachment_id": null, "text": "\n  rewrite has nothing to do with this, it's a fundimental error in mod_proxy.\n\n\n*** This bug has been marked as a duplicate of 11993 ***", "id": 24233, "time": "2002-10-09T20:13:09Z", "bug_id": 11618, "creation_time": "2002-10-09T20:13:09Z", "is_private": false}]