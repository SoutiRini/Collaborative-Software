[{"attachment_id": 25802, "tags": [], "bug_id": 49648, "text": "Created attachment 25802\nPowerPoint for test\n\nHi, \nI urgently need your help. \nFirst I apologize for my bad English. \nI am a newbie of POI, I'm just venturing into their use. \nMy environment is this: \nJ2SE 1.5 \nEclipse \nPOI 03/06 (20091214) \n\nI have this problem, I can not replace the text within a text to be replaced when the ppt contains special characters. An example of a special character is \u20ac  \n\nException in thread \"main\" java.lang.NullPointerException \n        at org.apache.poi.hslf.model.TextRun.storeText(TextRun.java:350) \n        at org.apache.poi.hslf.model.TextRun.setRawText(TextRun.java:464) \n        at org.apache.poi.hslf.model.TextRun.setText(TextRun.java:498) \n        at ExampleError.main(ExampleError.java:41)\n\n\nBanging his head on, but unable to solve. \n\nBelow the code that I'm using: \n\n\nimport org.apache.poi.hslf.HSLFSlideShow; \nimport org.apache.poi.hslf.model.Slide; \nimport org.apache.poi.hslf.model.TextRun; \nimport org.apache.poi.hslf.usermodel.RichTextRun; \nimport org.apache.poi.hslf.usermodel.SlideShow; \nimport org.apache.poi.poifs.filesystem.POIFSFileSystem; \n\n\npublic class ExampleError { \n\n        public static void main(String[] args) { \n                POIFSFileSystem fs; \n\n                try { \n                        fs = new POIFSFileSystem(new FileInputStream(\"c://temp//template_test.ppt\")); \n                        SlideShow ppt = new SlideShow(new HSLFSlideShow(fs)); \n                        Slide[] slides = ppt.getSlides(); \n                        \n                        String replace = \"Amount \u20ac100\"; \n                        \n                        int nSlide = slides.length; \n\n                        for (int i = 0; i < nSlide; i++) { \n                                TextRun[] txtRun = slides[i].getTextRuns(); \n                        \n                                for (int j = 0; j < txtRun.length; j++) { \n                                                        \n                                        String textGet = txtRun[j].getText(); \n                                        \n                                        String txtReplaced = textGet.replace(\"{txtTot}\", replace); \n                                        \n                                        System.out.println(\"Replaced: \" + txtReplaced); \n                                        txtRun[j].setText(txtReplaced); \n                                } \n                        } \n                        \n                        FileOutputStream out = new FileOutputStream(\"c://temp//template_final.ppt\"); \n                        ppt.write(out); \n                        out.close(); \n                        \n                } catch (FileNotFoundException e) { \n                        e.printStackTrace(); \n                } catch (IOException e) { \n                        e.printStackTrace(); \n                } \n\n        } \n\n} \n\nPlease find attached a ppt that I use for simple tests. \nPlease help I no longer go forward suggestions are welcome, Changes to my code are welcome, you run a small example, would be ideal ... any help is greatly appreciated. \n\nBest Regards.", "count": 0, "id": 138677, "time": "2010-07-26T08:34:49Z", "creator": "registro72@gmail.com", "creation_time": "2010-07-26T08:34:49Z", "is_private": false}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "text": "I've run your sample program with your file on 3.8 beta 3, and I can change the text to contain unicode characters without error", "id": 147453, "time": "2011-06-24T11:19:29Z", "bug_id": 49648, "creation_time": "2011-06-24T11:19:29Z", "is_private": false, "attachment_id": null}]