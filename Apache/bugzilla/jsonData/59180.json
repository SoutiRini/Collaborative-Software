[{"count": 0, "tags": [], "bug_id": 59180, "attachment_id": 33674, "is_private": false, "id": 189468, "time": "2016-03-14T16:13:27Z", "creator": "tony.benbrahim@gmail.com", "creation_time": "2016-03-14T16:13:27Z", "text": "Created attachment 33674\ninspection of anchor field\n\nXSSFGraphicFrame incorrectly declares its own anchor field, hiding the anchor property from XSSFShape. The achor property from XSSFShape has the anchor value, the one from XSSFGraphicFrame is always null.\n\n\nWorkaround:\nI was working with the graphic frame for a chart. I was able to get the anchor through the chart parent:\n\nfinal XSSFDrawing parent = (XSSFDrawing) chart.getParent();\nfinal CTTwoCellAnchor twoCellAnchorArray = parent.getCTDrawing().getTwoCellAnchorArray(0);\n\t\tfinal XSSFClientAnchor xssfClientAnchor = new XSSFClientAnchor((int) twoCellAnchorArray.getFrom().getColOff(),\n\t\t\t\t(int) twoCellAnchorArray.getFrom().getRowOff(), (int) twoCellAnchorArray.getTo().getColOff(),\n\t\t\t\t(int) twoCellAnchorArray.getTo().getRowOff(), twoCellAnchorArray.getFrom().getCol(),\n\t\t\t\ttwoCellAnchorArray.getFrom().getRow(), twoCellAnchorArray.getTo().getCol(),\ntwoCellAnchorArray.getTo().getRow());"}, {"count": 1, "attachment_id": null, "creator": "tony.benbrahim@gmail.com", "text": "Workaround above did not work in one case of three (wrong parent returned by chart.getParent().\n\nI ended up using this (ugly but works)\n\nif (shape instanceof XSSFGraphicFrame) {\n    try {\n\tfinal Field anchorField = XSSFShape.class.getDeclaredField(\"anchor\");\n\tanchorField.setAccessible(true);\n\tfinal XSSFClientAnchor anchor = (XSSFClientAnchor) anchorField.get(shape);\n        renderGraphicsFrame...\n    } catch (NoSuchFieldException | SecurityException | IllegalAccessException |\n IllegalArgumentException e) {\n\tLOG.info(\"unable to extract anchor for chart\", e);\n   }", "id": 189616, "time": "2016-03-21T15:37:34Z", "bug_id": 59180, "creation_time": "2016-03-21T15:37:34Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 59180, "is_private": false, "text": "One thing that makes it a bit more complex to fix this is that  XSSFGraphicFrame uses an XSSFClientAnchor, but XSSFShape the superclass XSSFAnchor. XSSFClientAnchor seems to hold a bit more information, so I am not sure how this can be combined without causing compatibility problems and missing functionality. \n\nThe best way I can think of is to rename the field/getters/setters in  XSSFGraphicFrame to get/setClientAnchor() to have both available for now, however this still could cause some compatibility errors for other users of  XSSFGraphicFrame.", "id": 189768, "time": "2016-03-28T20:44:03Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-03-28T20:44:03Z", "attachment_id": null}]