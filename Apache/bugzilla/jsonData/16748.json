[{"count": 0, "tags": [], "bug_id": 16748, "is_private": false, "text": "The BuildFileTest class stores output captured from System.err to outBuffer\nrather than to errBuffer.  As a result, getError() always returns an empty\nstring and getOutput() includes the test written to System.err.\n\nThis patch will fix the problem:\n\n--- source/org/apache/tools/ant/BuildFileTest.java  4 Feb 2003 05:25:13 -0000   1.1\n+++ source/org/apache/tools/ant/BuildFileTest.java  4 Feb 2003 05:41:47 -0000   1.2\n@@ -243,10 +243,10 @@\n             sysOut.flush();\n             sysErr.flush();\n             outBuffer = new StringBuffer();\n-            PrintStream out = new PrintStream(new AntOutputStream());\n+            PrintStream out = new PrintStream(new AntOutputStream(outBuffer));\n             System.setOut(out);\n             errBuffer = new StringBuffer();\n-            PrintStream err = new PrintStream(new AntOutputStream());\n+            PrintStream err = new PrintStream(new AntOutputStream(errBuffer));\n             System.setErr(err);\n             logBuffer = new StringBuffer();\n             fullLogBuffer = new StringBuffer();\n@@ -383,8 +383,12 @@\n      * an output stream which saves stuff to our buffer.\n      */\n     private class AntOutputStream extends java.io.OutputStream {\n+        private StringBuffer buffer;\n+        public AntOutputStream( StringBuffer buffer ) {\n+            this.buffer = buffer;\n+        }\n         public void write(int b) { \n-            outBuffer.append((char)b);\n+            buffer.append((char)b);\n         }\n     }", "id": 30615, "time": "2003-02-04T06:41:18Z", "creator": "JPMcGrath@JPMcGrath.net", "creation_time": "2003-02-04T06:41:18Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 16748, "attachment_id": null, "is_private": false, "id": 30650, "time": "2003-02-04T14:27:58Z", "creator": "conor@apache.org", "creation_time": "2003-02-04T14:27:58Z", "text": "Fix applied - thanks"}]