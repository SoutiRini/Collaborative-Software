[{"count": 0, "tags": [], "bug_id": 5422, "is_private": false, "text": "When using FORM authentication (for realm), it appears that HTTP headers are \nnot being reset as the page is redirected to target page (after authentication).\n\nProcess (tested against stock 4.0.1 tomcat install)\n1. Create new webapp (eg header)\n2. Unpack zip file listed in URL to webapp\nhttp://members.optushome.com.au/bwalding/tomcat/header.zip\n3. Go to http://localhost:8080/header/HeaderServlet (or appropriate spot if you \naren't running against localhost)\n4. You should be redirected to the login.html page (user/pass = tomcat/tomcat  \n(default memory realm))\n5. After that you should go to header display page.  Note the duplicates?\nIf you invalidate the session and re-enter the page, you will see the session \nid's are different.", "id": 8906, "time": "2001-12-13T15:47:50Z", "creator": "ben@walding.com", "creation_time": "2001-12-13T15:47:50Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 5422, "attachment_id": null, "text": "This bug does not appear to occur for BASIC authentication.  I have not tried \nother authentication types.", "id": 8907, "time": "2001-12-13T15:51:40Z", "creator": "ben@walding.com", "creation_time": "2001-12-13T15:51:40Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 5422, "attachment_id": null, "id": 8908, "time": "2001-12-13T16:11:21Z", "creator": "craig.mcclanahan@sun.com", "creation_time": "2001-12-13T16:11:21Z", "is_private": false, "text": "It would make sense that this would affect only FORM based login, because that\nis the only case where Tomcat itself saves and replays the original request.  In\nBASIC, the browser does that.\n\nYour comments imply that you have a test case available.  Can you attach that to\nthis bug report?\n"}, {"count": 3, "tags": [], "bug_id": 5422, "text": "Ok... I missed an important part about this one... what I see and what I expect\nto see!\n\nHere is what I see when I run the servlet (enumeration of headers)\nThe duplication is what I think is the problem.\n\nhost = localhost:8080\nhost = localhost:8080\nuser-agent = Mozilla/5.0 (Windows; U; Windows NT 5.0; en-US; rv:0.9.6)\nGecko/20011120\nuser-agent = Mozilla/5.0 (Windows; U; Windows NT 5.0; en-US; rv:0.9.6)\nGecko/20011120\naccept = text/xml, application/xml, application/xhtml+xml, text/html;q=0.9,\nimage/png, image/jpeg, image/gif;q=0.2, text/plain;q=0.8, text/css, */*;q=0.1\naccept = text/xml, application/xml, application/xhtml+xml, text/html;q=0.9,\nimage/png, image/jpeg, image/gif;q=0.2, text/plain;q=0.8, text/css, */*;q=0.1\naccept-language = en-us\naccept-language = en-us\naccept-encoding = gzip, deflate, compress;q=0.9\naccept-encoding = gzip, deflate, compress;q=0.9\naccept-charset = ISO-8859-1, utf-8;q=0.66, *;q=0.66\naccept-charset = ISO-8859-1, utf-8;q=0.66, *;q=0.66\nkeep-alive = 300\nkeep-alive = 300\nconnection = keep-alive\nconnection = keep-alive\ncookie = JSESSIONID=2461B354C403704973A067A5E6C78630\nreferer =\nhttp://localhost:8080/header/login.html;jsessionid=2461B354C403704973A067A5E6C78630\nconnection = keep-alive\nconnection = keep-alive\naccept-language = en-us\naccept-language = en-us\naccept-encoding = gzip, deflate, compress;q=0.9\naccept-encoding = gzip, deflate, compress;q=0.9\naccept = text/xml, application/xml, application/xhtml+xml, text/html;q=0.9,\nimage/png, image/jpeg, image/gif;q=0.2, text/plain;q=0.8, text/css, */*;q=0.1\naccept = text/xml, application/xml, application/xhtml+xml, text/html;q=0.9,\nimage/png, image/jpeg, image/gif;q=0.2, text/plain;q=0.8, text/css, */*;q=0.1\nhost = localhost:8080\nhost = localhost:8080\naccept-charset = ISO-8859-1, utf-8;q=0.66, *;q=0.66\naccept-charset = ISO-8859-1, utf-8;q=0.66, *;q=0.66\nkeep-alive = 300\nkeep-alive = 300\nuser-agent = Mozilla/5.0 (Windows; U; Windows NT 5.0; en-US; rv:0.9.6)\nGecko/20011120\nuser-agent = Mozilla/5.0 (Windows; U; Windows NT 5.0; en-US; rv:0.9.6)\nGecko/20011120\n\n\n\nWhat I expect is the headers not to be unduly duplicated i.e. something like the\nfollowing...\n\nhost = localhost:8080\nuser-agent = Mozilla/5.0 (Windows; U; Windows NT 5.0; en-US; rv:0.9.6)\nGecko/20011120\naccept = text/xml, application/xml, application/xhtml+xml, text/html;q=0.9,\nimage/png, image/jpeg, image/gif;q=0.2, text/plain;q=0.8, text/css, */*;q=0.1\naccept-language = en-us\naccept-encoding = gzip, deflate, compress;q=0.9\naccept-charset = ISO-8859-1, utf-8;q=0.66, *;q=0.66\nkeep-alive = 300\nconnection = keep-alive\ncookie = JSESSIONID=69B2B995D150D330F21152C4C2658186\nreferer = http://localhost:8080/header/login.html\ncache-control = max-age=0", "id": 8934, "time": "2001-12-14T17:03:14Z", "creator": "ben@walding.com", "creation_time": "2001-12-14T17:03:14Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 5422, "attachment_id": null, "id": 8940, "time": "2001-12-14T18:36:13Z", "creator": "craig.mcclanahan@sun.com", "creation_time": "2001-12-14T18:36:13Z", "is_private": false, "text": "Thanks ... now *that* tells me what I need to know to fix the problem :-)\n"}, {"count": 5, "tags": [], "bug_id": 5422, "is_private": false, "text": "For HEAD branch, fixed in nightly build 20020216.\n\nFor 4.0.x branch, will be fixed in 4.0.3.\n", "id": 10775, "time": "2002-02-15T23:06:18Z", "creator": "craig.mcclanahan@sun.com", "creation_time": "2002-02-15T23:06:18Z", "attachment_id": null}]