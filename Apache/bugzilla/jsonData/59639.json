[{"count": 0, "tags": [], "bug_id": 59639, "text": "org.apache.poi.openxml4j.exceptions.OpenXML4JRuntimeException: Rule M2.4 exception : this error should NEVER happen! Please raise a bug at https://bz.apache.org/bugzilla/enter_bug.cgi?product=POI and attach a file that triggers it, thanks!\n\tat org.apache.poi.openxml4j.opc.internal.ContentTypeManager.getContentType(ContentTypeManager.java:343)\n\tat org.apache.poi.openxml4j.opc.internal.ContentTypeManager.removeContentType(ContentTypeManager.java:256)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.removePart(OPCPackage.java:958)\n\tat org.apache.poi.openxml4j.opc.PackagePart.getOutputStream(PackagePart.java:522)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.commit(XSSFWorkbook.java:1687)\n\tat org.apache.poi.POIXMLDocumentPart.onSave(POIXMLDocumentPart.java:464)\n\tat org.apache.poi.POIXMLDocument.write(POIXMLDocument.java:211)\n\tat AddPatient_Excel.ReadPatientExcel.writeExcel(ReadPatientExcel.java:110)\n\tat AddPatient_Excel.ReadPatientExcel.fillPatientDetails(ReadPatientExcel.java:94)\n\tat AddPatient_Excel.ReadPatientExcel.readPatientExc(ReadPatientExcel.java:65)\n\tat AddPatient_Excel.ReadPatientExcel.main(ReadPatientExcel.java:35)", "id": 191287, "time": "2016-05-27T10:25:14Z", "creator": "ankita.naik@synechron.com", "creation_time": "2016-05-27T10:25:14Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "dominik.stadler@gmx.at", "text": "What about \"and attach a file that triggers it\"? Without it there is not much we can do...", "count": 1, "id": 191300, "time": "2016-05-27T19:26:34Z", "bug_id": 59639, "creation_time": "2016-05-27T19:26:34Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "ankita.naik@synechron.com", "is_private": false, "count": 2, "id": 191313, "time": "2016-05-30T10:22:19Z", "bug_id": 59639, "creation_time": "2016-05-30T10:22:19Z", "text": "(In reply to Dominik Stadler from comment #1)\n> What about \"and attach a file that triggers it\"? Without it there is not\n> much we can do...\n\nFollowing method is generating issue:\nIt is Write On Excel file\n\npublic void writeMethod() throws FileNotFoundException, IOException{\n\t\t\t\n\t\t\tString dataToWrite[]={\"Pass\"};\t\n\t\t\t//FileInputStream inputStream=new FileInputStream(\"C:\\\\Users\\\\Ankita.Naik\\\\workspace\\\\Selenium_Practice\\\\src\\\\AddPatient_Excel\\\\A.xlsx\");\n\t\t\t\t\t\n\t\t\tXSSFWorkbook workbook=new XSSFWorkbook(new FileInputStream(\"C:\\\\Users\\\\Ankita.Naik\\\\workspace\\\\Selenium_Practice\\\\src\\\\AddPatient_Excel\\\\A.xlsx\"));\n\t\t\tXSSFSheet sheet=workbook.getSheetAt(0);\n\t\t\tint rowcount=sheet.getLastRowNum()-sheet.getFirstRowNum();\n\t\t\t\n\t\t\t//Row row=sheet.getRow(0);\n\t\t\t//Row newRow=sheet.createRow(rowcount+1);\n\t\t\t\n\t\t\tfor(int i=0;i<rowcount;i++)\n\t\t\t\t{\n\t\t\t\t\tRow row=sheet.getRow(i);\n\t\t\t\t\tCell cell=row.createCell(3);\n\t\t\t\t\tcell.setCellValue(dataToWrite[i]);\n\t\t\t\t}\n\t\t\t\n\t\t\tworkbook.close();\n\t\t\tFileOutputStream outputStream=new FileOutputStream(\"C:\\\\Users\\\\Ankita.Naik\\\\workspace\\\\Selenium_Practice\\\\src\\\\AddPatient_Excel\\\\A.xlsx\");\n\t\t\tworkbook.write(outputStream);\n\t\t\toutputStream.close();\n\t\t\t\n\t}"}, {"attachment_id": null, "tags": [], "creator": "onealj@apache.org", "is_private": false, "count": 3, "id": 194542, "time": "2016-10-19T08:11:01Z", "bug_id": 59639, "creation_time": "2016-10-19T08:11:01Z", "text": "Workbook objects cannot be used after they are closed.\nFrom javadocs[1] \"Once this has been called, no further operations, updates or reads should be performed on the Workbook.\"\n\n> workbook.close();\n> FileOutputStream outputStream=new FileOutputStream(...);\n> workbook.write(outputStream);\n> outputStream.close();\n\n[1] https://poi.apache.org/apidocs/org/apache/poi/ss/usermodel/Workbook.html#close()"}]