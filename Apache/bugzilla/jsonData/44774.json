[{"count": 0, "tags": [], "bug_id": 44774, "is_private": false, "id": 115396, "creation_time": "2008-04-07T22:28:42Z", "time": "2008-04-07T22:28:42Z", "creator": "mrlal_tvm@yahoo.com", "text": "Created attachment 21790\nExcel FIle\n\nThis file doest open in release 'poi-3.0.3-alpha1-20080404.jar\" but it works opens with \"poi-3.0.2-FINAL-20080204.jar\"\n\nFollowing is the error thrown.\n\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:206)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:124)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:204)\n\tat TestUserHome.main(TestUserHome.java:41)\nCaused by: java.lang.reflect.InvocationTargetException\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:494)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:194)\n\t... 3 more\nCaused by: java.lang.ArrayIndexOutOfBoundsException\n\tat org.apache.poi.hssf.record.RecordInputStream.checkRecordPosition(RecordInputStream.java:132)\n\tat org.apache.poi.hssf.record.RecordInputStream.readShort(RecordInputStream.java:152)\n\tat org.apache.poi.hssf.record.ExternalNameRecord.fillFields(ExternalNameRecord.java:156)\n\tat org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n\tat org.apache.poi.hssf.record.ExternalNameRecord.<init>(ExternalNameRecord.java:51)\n\t... 8 more", "attachment_id": 21790}, {"count": 1, "tags": [], "bug_id": 44774, "text": "Created attachment 21791\nThis file gives gives IO Exception.\n\nCannot remove block[ 215 ]; out of range\njava.io.IOException: Cannot remove block[ 215 ]; out of range\n\tat org.apache.poi.poifs.storage.BlockListImpl.remove(BlockListImpl.java:104)\n\tat org.apache.poi.poifs.storage.BlockAllocationTableReader.fetchBlocks(BlockAllocationTableReader.java:190)\n\tat org.apache.poi.poifs.storage.BlockListImpl.fetchBlocks(BlockListImpl.java:129)\n\tat org.apache.poi.poifs.filesystem.POIFSFileSystem.processProperties(POIFSFileSystem.java:536)\n\tat org.apache.poi.poifs.filesystem.POIFSFileSystem.<init>(POIFSFileSystem.java:175)\n\tat TestUserHome.main(TestUserHome.java:40)", "id": 115397, "time": "2008-04-07T22:37:56Z", "creator": "mrlal_tvm@yahoo.com", "creation_time": "2008-04-07T22:37:56Z", "is_private": false, "attachment_id": 21791}, {"count": 2, "tags": [], "creator": "mrlal_tvm@yahoo.com", "attachment_id": 21792, "is_private": false, "id": 115398, "time": "2008-04-07T22:42:21Z", "bug_id": 44774, "creation_time": "2008-04-07T22:42:21Z", "text": "Created attachment 21792\nThis file also gives gives IO Exception.\n\nCannot remove block[ 215 ]; out of range\njava.io.IOException: Cannot remove block[ 215 ]; out of range\n\tat org.apache.poi.poifs.storage.BlockListImpl.remove(BlockListImpl.java:104)\n\tat org.apache.poi.poifs.storage.BlockAllocationTableReader.fetchBlocks(BlockAllocationTableReader.java:190)\n\tat org.apache.poi.poifs.storage.BlockListImpl.fetchBlocks(BlockListImpl.java:129)\n\tat org.apache.poi.poifs.filesystem.POIFSFileSystem.processProperties(POIFSFileSystem.java:536)\n\tat org.apache.poi.poifs.filesystem.POIFSFileSystem.<init>(POIFSFileSystem.java:175)\n\tat TestUserHome.main(TestUserHome.java:40)"}, {"count": 3, "tags": [], "bug_id": 44774, "attachment_id": null, "id": 115484, "creation_time": "2008-04-10T00:20:28Z", "time": "2008-04-10T00:20:28Z", "creator": "josh@apache.org", "text": "(In reply to comment #0)\n> Created an attachment (id=21790) [details]\n> Excel FIle\n> \n> This file doest open in release 'poi-3.0.3-alpha1-20080404.jar\" but it works\n> opens with \"poi-3.0.2-FINAL-20080204.jar\"\n> \n> ... Caused by: java.lang.ArrayIndexOutOfBoundsException ...\n> ... ExternalNameRecord.fillFields ....\n\nI created a separate bugzilla (bug 44792) for this bug.  More problems were found (after the first one in ExternalNameRecord) when re-writing this XLS file.  Excel could not open the output file properly due to problems in CRNRecord.  These were also fixed in bug 44792.\n\nPOI now seems to be able to read attachment (id=21790) and write it back without any obvious corruption.", "is_private": false}, {"count": 4, "tags": [], "creator": "josh@apache.org", "attachment_id": null, "is_private": false, "id": 115485, "time": "2008-04-10T00:52:39Z", "bug_id": 44774, "creation_time": "2008-04-10T00:52:39Z", "text": "(In reply to comment #1)\n> Created an attachment (id=21791) [details]\n> ... java.io.IOException: Cannot remove block[ 215 ]; out of range\n> ...\n\nI get \"Cannot remove block[ 454 ]; out of range\".  (I assume you accidentally copied the stack trace from the attachment 21792.\n\n(In reply to comment #2)\n> Created an attachment (id=21792) [details]\n> ... java.io.IOException: Cannot remove block[ 215 ]; out of range\n> ...\n\nI get this error exactly. The following test code hits the same error, without HSSFWorkbook:\n\ntry {\n  InputStream is = new FileInputStream(\"ex44774-21792.xls\");\n  new POIFSFileSystem(is);\n} catch (IOException e) {\n  if (e.getMessage().equals(\"Cannot remove block[ 215 ]; out of range\")) {\n    throw new AssertionFailedError(\"Identified bug 44774\");\n  }\n  throw new RuntimeException(e);\n}\n\nI tried this code out against poi-3.0.2-FINAL-20080204.jar and got a different error:\n\njava.lang.RuntimeException: java.io.IOException: Unable to read entire block; 479 bytes read before EOF; expected 512 bytes\n\tat example.poi.Test44774.test44774(Test44774.java:43)\nCaused by: java.io.IOException: Unable to read entire block; 479 bytes read before EOF; expected 512 bytes\n\tat org.apache.poi.poifs.storage.RawDataBlock.<init>(RawDataBlock.java:78)\n\tat org.apache.poi.poifs.storage.RawDataBlock.<init>(RawDataBlock.java:50)\n\tat org.apache.poi.poifs.storage.RawDataBlockList.<init>(RawDataBlockList.java:52)\n\tat org.apache.poi.poifs.filesystem.POIFSFileSystem.<init>(POIFSFileSystem.java:93)\n\tat example.poi.Test44774.test44774b(Test44774.java:38)\n\t... 18 more\n\nThere seems to have been some work done in this area recently.\n(see bugzilla bug 28231 and bug 35928 / svn r634318 and r636786)\n\nHopefully someone with more knowledge of POIFS can help diagnose this further.\n"}, {"count": 5, "tags": [], "bug_id": 44774, "text": "I believe this bug is fixed in 3.1 FINAL. Please re-open the bug, and attach a new stack trace if you're still having problems with 3.1 FINAL", "id": 118513, "time": "2008-07-10T15:50:10Z", "creator": "apache@gagravarr.org", "creation_time": "2008-07-10T15:50:10Z", "is_private": false, "attachment_id": null}]