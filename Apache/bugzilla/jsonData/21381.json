[{"count": 0, "tags": [], "creator": "seanlist@msgilligan.com", "is_private": false, "text": "The FOP Ant task currently always renders the output.  The attached patch will\nrender only when the source file (.fo) is newer then the target (.pdf, etc.). \nThere is also a \"force\" flag that can be used to always render.\n\nThis is the patch for org.apache.fop.tools.anttasks.Fop on the HEAD branch that\ncorresponds to the patch on the 0_20_2-maintain branch.  (The changes to the XML\ndocumentation are the same for both branches.)\n\ncvs diff -u src/java/org/apache/fop/tools/anttasks/Fop.java                    \n Index: src/java/org/apache/fop/tools/anttasks/Fop.java\n===================================================================\nRCS file: /home/cvspublic/xml-fop/src/java/org/apache/fop/tools/anttasks/Fop.java,v\nretrieving revision 1.4\ndiff -u -u -r1.4 Fop.java\n--- src/java/org/apache/fop/tools/anttasks/Fop.java     17 Jun 2003 16:35:58\n-0000      1.4\n+++ src/java/org/apache/fop/tools/anttasks/Fop.java     7 Jul 2003 20:44:17 -0000\n@@ -94,6 +94,8 @@\n  *      non-error messages</li>\n  * <li>logFiles -> Controls whether the names of the files that are processed\n  *      are logged or not</li>\n+ * <li>force -> Recreate target files, even if they are newer than their\n+ *      corresponding source files</li>\n  * </ul>\n  */\n public class Fop extends Task {\n@@ -107,6 +109,7 @@\n     private File userConfig;\n     private int messageType = Project.MSG_VERBOSE;\n     private boolean logFiles = true;\n+    boolean force = false;         // Ignore modification dates if true\n \n     /**\n      * Sets the filename for the userconfig.xml.\n@@ -270,6 +273,20 @@\n     }\n \n     /**\n+     * Sets force (ignore mod dates) flag \n+     */\n+    public void setForce(boolean aBoolean) {\n+        this.force = aBoolean;\n+    }\n+\n+    /**\n+     * Gets force (ignore mod dates) flag\n+     */\n+    public boolean getForce() {\n+        return this.force;\n+    }\n+\n+    /**\n      * @see org.apache.tools.ant.Task#execute()\n      */\n     public void execute() throws BuildException {\n@@ -410,8 +427,13 @@\n                 if (task.getOutdir() != null) {\n                     outf = new File(task.getOutdir(), outf.getName());\n                 }\n-                render(task.getFofile(), outf, rint);\n-                actioncount++;\n+                // Only render if \"force\" flag is set OR output file doesn't\nexist OR\n+                // output file is older than input file\n+                if ( task.force || !outf.exists() ||\n+                    (task.getFofile().lastModified() > outf.lastModified() ) ) {\n+                    render(task.getFofile(), outf, rint);\n+                    actioncount++;\n+                }\n             }\n         }\n \n@@ -449,14 +471,17 @@\n                     task.log(\"Error setting base URL\", Project.MSG_DEBUG);\n                 }\n \n-                render(f, outf, rint);\n-                actioncount++;\n+                // Only render if \"force\" flag is set OR output file doesn't\nexist OR\n+                // output file is older than input file\n+                if ( task.force || !outf.exists() || (f.lastModified() >\noutf.lastModified() ) ) {\n+                    render(f, outf, rint);\n+                    actioncount++;\n+                }\n             }\n         }\n \n         if (actioncount == 0) {\n-            task.log(\"No files processed. No files were selected by the filesets \"\n-                + \"and no fofile was set.\" , Project.MSG_WARN);\n+            task.log(\"Nothing to do.\" , Project.MSG_WARN);\n         }\n     }", "id": 40106, "time": "2003-07-07T20:47:20Z", "bug_id": 21381, "creation_time": "2003-07-07T20:47:20Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "glenmazza@yahoo.com", "text": "Applied (w/minor changes)--thanks for the patch!\n\nhttp://cvs.apache.org/viewcvs.cgi/xml-\nfop/src/java/org/apache/fop/tools/anttasks/Fop.java\n\n", "id": 41805, "time": "2003-07-30T22:06:56Z", "bug_id": 21381, "creation_time": "2003-07-30T22:06:56Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "text": "batch transition pre-FOP1.0 resolved+fixed bugs to closed+fixed", "is_private": false, "bug_id": 21381, "id": 155932, "time": "2012-04-01T06:49:28Z", "creator": "gadams@apache.org", "creation_time": "2012-04-01T06:49:28Z", "attachment_id": null}]