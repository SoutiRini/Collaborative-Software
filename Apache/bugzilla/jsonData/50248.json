[{"count": 0, "tags": [], "bug_id": 50248, "attachment_id": null, "id": 141607, "time": "2010-11-10T13:42:37Z", "creator": "Oliver.Moehrke@web.de", "creation_time": "2010-11-10T13:42:37Z", "is_private": false, "text": "The static method Init.init() is synchronized and therefore protected against calling it by more than one thread at a time. It is also protected against accidentally calling it more than once. But it is not protected against an incomplete initialization:\n\nImagine the two threads T1 and T2.\n\nInside Init.init() the line \"_alreadyInitialized = true;\" is at the beginning of the method, when only some variables have been set, but the initialization process is not fully completed.\n\nIf T1 successfully entered Init.init() but is suspended by the scheduler just after processing the line \"_alreadyInitialized = true;\" this will cause concurrency problems for T2.\n\nBecause T1 already set \"_alreadyInitialized\" to \"true\", T2 can use the unsynchronized method Init.isInitialized() to check if an initialization is needed. Unfortunately T2 will get the result \"true\" and therefore skips the call to Init.init() and directly goes to check a signature via XMLSginature.checkSignatureValue(X509Certificate).\n\nBecause of the incomplete initialization this will lead to some very strange exceptions. In our case the exception misses some entries of the ResourceBundle...\n\nTo fix this issue, the line \"_alreadyInitialized = true;\" should be the last line of Init.init()."}, {"count": 1, "tags": [], "text": "\nFixed on trunk:\n\nAuthor: coheigea\nDate: Thu Nov 11 10:27:32 2010\nNew Revision: 1033870\n\nURL: http://svn.apache.org/viewvc?rev=1033870&view=rev\nLog:\n[50248] - Concurrency problem on incomplete Init.init() calls.\n\nand on J_1_4_4 tag:\n\nAuthor: coheigea\nDate: Thu Nov 11 10:35:37 2010\nNew Revision: 1033875\n\nURL: http://svn.apache.org/viewvc?rev=1033875&view=rev\nLog:\n[50248] - Concurrency problem on incomplete Init.init() calls.\n\nColm.", "attachment_id": null, "id": 141620, "creator": "coheigea@apache.org", "time": "2010-11-11T05:37:12Z", "bug_id": 50248, "creation_time": "2010-11-11T05:37:12Z", "is_private": false}]