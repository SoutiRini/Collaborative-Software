[{"count": 0, "tags": [], "creator": "iainxt@hotmail.com", "text": "Created attachment 32442\nUsed by code to demostrate the issue\n\nWhen I evaulate a the formula in Excel I get 92.4, but if I invoke the following and read the same cell I get 92.39\n\nworkbook.getCreationHelper().createFormulaEvaluator().evaluateAll();\n\nI suspect the issue is internally poi is storing part of the result as a double, and just before I FLOOR the value it has is 92.399999999999\n\nThe formula\n=FLOOR(2100*0.044,0.01)\n\nExcel result: 92.4\nPOI result: 94.39\n\nThe code\n  @Test\n  public void roundingBug() throws IOException {\n    File file = new File(\"E:\\\\Temp\\\\POI.Formula.RoundingBug.xlsx\");\n\n    XSSFWorkbook workbook = new XSSFWorkbook((new FileInputStream(file)));\n    workbook.getCreationHelper().createFormulaEvaluator().evaluateAll();\n    XSSFSheet sheet = workbook.getSheetAt(0);\n    for (int i = 0; i < sheet.getPhysicalNumberOfRows(); i++) {\n      Row row = sheet.getRow(i);\n      if (row == null) {\n        continue;\n      }\n      System.out.print(\"Row \" + i + \": \");\n      for (int c = 0; c < row.getPhysicalNumberOfCells(); c++) {\n        Cell cell = row.getCell(c);\n        if (cell == null) {\n          System.out.print(\"null \");\n        } else {\n          int type = cell.getCellType();\n          if (cell.getCellType() == Cell.CELL_TYPE_FORMULA) {\n            type = cell.getCachedFormulaResultType();\n          }\n          if (type == Cell.CELL_TYPE_NUMERIC) {\n            System.out.print(cell.getNumericCellValue() + \" \");\n          } else if (type == Cell.CELL_TYPE_STRING) {\n            System.out.print(cell.getStringCellValue() + \" \");\n          }\n        }\n      }\n      System.out.println(\"\");\n    }\n  }", "id": 180861, "time": "2015-02-09T09:51:50Z", "bug_id": 57550, "creation_time": "2015-02-09T09:51:50Z", "is_private": false, "attachment_id": 32442}, {"count": 1, "tags": [], "creator": "iainxt@hotmail.com", "text": "I have re-tested in 3.11", "id": 180862, "time": "2015-02-09T09:52:26Z", "bug_id": 57550, "creation_time": "2015-02-09T09:52:26Z", "is_private": false, "attachment_id": null}]