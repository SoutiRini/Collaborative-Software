[{"count": 0, "tags": [], "bug_id": 10212, "attachment_id": null, "text": "I can set up the Coyote Adaptor to work in http mode, but if I configure the \nConnector to run in HTTPS mode, then tomcat starts up fine but the browser \ncannot connect to any url in https mode. http works fine. When I comment out my \ncoyote setup code and activate my setup code for the old connectors everything \nworks. Here are the relevant config lines from the server.xml file.\n\n(I also included an out-commented setup for the old http connector in https \nmode which works fine. By the way, you will also note that for https \nconnections I set the attributes maxProcessors and acceptCount to extremely \nhigh values to make tomcat work within our production system. Otherwise \nTomcat 4.s.th. rejected some requests when I ran load tests and this behaviour \nalso showed up within our production environment under usual load.\nSince that time I have not yet run any further tests to verify whether Tomcat \n4.0.4 bahaves differently, but I am also not sure whether this is a bug at all, \nsince https connections always maintain a session notion. I also do not quite \nunderstand the semantics of these two properties and why one property doesn't \ndo, although I read the documentation...)\n\nOK. Here is my setup:\n\n    <!-- Define a non-SSL Coyote HTTP/1.1 Connector on port 80 -->\n    <Connector className=\"org.apache.coyote.tomcat4.CoyoteConnector\"\n               port=\"80\" minProcessors=\"5\" maxProcessors=\"75\"\n               enableLookups=\"true\" redirectPort=\"443\"\n               acceptCount=\"10\" debug=\"0\" connectionTimeout=\"60000\"/>\n\n    <!-- Define an SSL HTTP/1.1 Connector on port 443 -->\n<!--\n    <Connector className=\"org.apache.catalina.connector.http.HttpConnector\"\n               port=\"443\" minProcessors=\"5\" maxProcessors=\"750\"\n               enableLookups=\"true\"\n\t         acceptCount=\"100\" debug=\"0\" scheme=\"https\" secure=\"true\">\n      <Factory className=\"org.apache.catalina.net.SSLServerSocketFactory\"\n\t\t   keystorePass=\"changeit\" keystoreType=\"pkcs12\" \nkeystoreFile=\"D:\\cert\\spares.p12\"\n               clientAuth=\"false\" protocol=\"TLS\"/>\n    </Connector>\n-->\n    <!-- Define an SSL Coyote HTTP/1.1 Connector on port 443 -->\n    <Connector className=\"org.apache.coyote.tomcat4.CoyoteConnector\"\n               port=\"443\" minProcessors=\"5\" maxProcessors=\"750\"\n               enableLookups=\"true\"\n\t         acceptCount=\"100\" debug=\"0\" scheme=\"https\" secure=\"true\">\n      <Factory className=\"org.apache.catalina.net.SSLServerSocketFactory\"\n\t\t   keystorePass=\"changeit\" keystoreType=\"pkcs12\" \nkeystoreFile=\"D:\\cert\\spares.p12\"\n               clientAuth=\"false\" protocol=\"TLS\"/>\n    </Connector>", "id": 18541, "time": "2002-06-25T14:18:07Z", "creator": "wtff@freenet.de", "creation_time": "2002-06-25T14:18:07Z", "is_private": false}, {"count": 1, "tags": [], "text": "Can you explain what happens when you try to use HTTPS? You get an error? What\nerror? What do the server logs say?", "attachment_id": null, "bug_id": 10212, "id": 18547, "time": "2002-06-25T14:48:20Z", "creator": "ekr@rtfm.com", "creation_time": "2002-06-25T14:48:20Z", "is_private": false}, {"count": 2, "text": "With Coyote, you have to use a different socket factory.\nExample:\n    <Connector className=\"org.apache.coyote.tomcat4.CoyoteConnector\"\n               port=\"443\" minProcessors=\"5\" maxProcessors=\"75\"\n               enableLookups=\"true\"\n\t       acceptCount=\"10\" debug=\"0\" scheme=\"https\" secure=\"true\"\n               useURIValidationHack=\"false\">\n      <Factory className=\"org.apache.coyote.tomcat4.CoyoteServerSocketFactory\"\n               clientAuth=\"false\" protocol=\"TLS\" />\n    </Connector>\n\nAfter you do that, I think it should work.", "bug_id": 10212, "attachment_id": null, "id": 18550, "time": "2002-06-25T15:00:20Z", "creator": "remm@apache.org", "creation_time": "2002-06-25T15:00:20Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "text": "That was it! Now it works. Thanks a lot.\n\n(To answer the previous question: there were no errors within the log. The \nbrowser reacted as if being pointed to a non existent port. It waited for a \nresponse until its timeout occurs.)", "is_private": false, "bug_id": 10212, "id": 18556, "time": "2002-06-25T15:56:59Z", "creator": "wtff@freenet.de", "creation_time": "2002-06-25T15:56:59Z", "attachment_id": null}]