[{"count": 0, "tags": [], "creator": "stevel@apache.org", "attachment_id": null, "text": "Even though ant's build.xml probes for online/offline, you cannot run build test\nin offline mode, as the new tests for url support in <property> require the\nsystem to be online.\n\nGiven the granularity of test patterns, I suspect the fix is to split out\nproperty-online tests into their own class and only run if the system is online\nand has visibility to the net, as per all the other online tasks.", "id": 41690, "time": "2003-07-28T22:42:28Z", "bug_id": 21948, "creation_time": "2003-07-28T22:42:28Z", "is_private": false}, {"count": 1, "text": "I had filed this as an online/offline issue, but testing with network access\nshows this is not the case...the problem still occurs.\n\nI had more looks at the test code here. test5 is meant to resolve a file:: url,\nbut on my system XPSP1; Java(1.4.2), java is trying to connect to some remote site:\n\n    [junit] --- Nested Exception ---\n    [junit] java.net.ConnectException: Connection timed out: connect\n    [junit]     at java.net.PlainSocketImpl.socketConnect(Native Method)\n    [junit]     at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:305)\n    [junit]     at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.jav\na:171)\n    [junit]     at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:158)\n    [junit]     at java.net.Socket.connect(Socket.java:452)\n    [junit]     at java.net.Socket.connect(Socket.java:402)\n    [junit]     at sun.net.NetworkClient.doConnect(NetworkClient.java:139)\n    [junit]     at sun.net.NetworkClient.openServer(NetworkClient.java:118)\n    [junit]     at sun.net.ftp.FtpClient.openServer(FtpClient.java:423)\n    [junit]     at sun.net.ftp.FtpClient.<init>(FtpClient.java:692)\n    [junit]     at sun.net.www.protocol.ftp.FtpURLConnection.connect(FtpURLConne\nction.java:175)\n    [junit]     at sun.net.www.protocol.ftp.FtpURLConnection.getInputStream(FtpU\nRLConnection.java:257)\n    [junit]     at java.net.URL.openStream(URL.java:913)\n    [junit]     at org.apache.tools.ant.taskdefs.Property.loadUrl(Property.java:\n420)\n    [junit]     at org.apache.tools.ant.taskdefs.Property.execute(Property.java:\n386)\n    [junit]     at org.apache.tools.ant.UnknownElement.execute(UnknownElement.ja\nva:272)\n    [junit]     at org.apache.tools.ant.Task.perform(Task.java:401)\n    [junit]     at org.apache.tools.ant.Target.execute(Target.java:347)\n    [junit]     at org.apache.tools.ant.Target.performTasks(Target.java:374)\n    [junit]     at org.apache.tools.ant.Project.executeTarget(Project.java:1228)\n\n    [junit]     at org.apache.tools.ant.BuildFileTest.executeTarget(BuildFileTes\nt.java:273)\n    [junit]     at org.apache.tools.ant.BuildFileTest.expectLog(BuildFileTest.ja\nva:107)\n    [junit]     at org.apache.tools.ant.taskdefs.PropertyTest.test5(PropertyTest\n.java:99)\n\nEven though the test URL is \n    <property url=\"file://${basedir}/property3.properties\"/>\nFTP should not be getting a look in. \n\nThis is not a 'cant run the tests' problem, it looks more like correct behaviour\nof the tests -and a potential problem in Java1.4.2...", "bug_id": 21948, "is_private": false, "id": 41737, "time": "2003-07-29T20:33:18Z", "creator": "stevel@apache.org", "creation_time": "2003-07-29T20:33:18Z", "tags": [], "attachment_id": null}, {"count": 2, "tags": [], "creator": "antoine@apache.org", "attachment_id": null, "text": "Hi, Steve, I can run this test with JDK1.4.2 on Win 2000.\nMaybe you should run the test in a debugger to find out what it is doing.", "id": 41738, "time": "2003-07-29T20:44:49Z", "bug_id": 21948, "creation_time": "2003-07-29T20:44:49Z", "is_private": false}, {"count": 3, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "text": "Is the URL that you are giving correct?  It should have three slashes after file:\n", "id": 41768, "time": "2003-07-30T12:34:02Z", "bug_id": 21948, "creation_time": "2003-07-30T12:34:02Z", "is_private": false}, {"count": 4, "tags": [], "creator": "peter.reilly@corvil.com", "attachment_id": null, "text": "on unix ${basedir} would be have a leading / - giving\nthe normal file:///kk/k url.\nwindows ${basedir} would have a leading drive c:\ngiving   file://c:\\kk\\k\nAs this test normally passes, this should be ok ???\n", "id": 41792, "time": "2003-07-30T16:32:36Z", "bug_id": 21948, "creation_time": "2003-07-30T16:32:36Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "ddevienne@lgc.com", "text": "On Windows, a local path (e.g. C:\\WinNT) must have 3 forward slashes as Stefan \nindicates, i.e. file:///WinNT. A UNC path on the other hand (e.g. \n\\\\MyServer\\Public) should have two, i.e. file://MyServer/Public.\n\nOn Unix, it's simply the usual path, the file: prefixed:\nfile:/etc/init.d/\nfile:/net/MyServer/Public (assuming MyServer is visible from both Windows and \nUnix)\n\nAnd of course, it's preferrable to always use forward slashes in URLs. --DD", "count": 5, "id": 41796, "time": "2003-07-30T17:59:04Z", "bug_id": 21948, "creation_time": "2003-07-30T17:59:04Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "ddevienne@lgc.com", "text": "Of course, I meant C:\\WinNT <==> file:///C:/WinNT. --DD", "count": 6, "id": 41797, "time": "2003-07-30T18:01:24Z", "bug_id": 21948, "creation_time": "2003-07-30T18:01:24Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 21948, "text": "interesting. It works on one of my XP boxes and on unix, but on the one that\nfails, the debug trace shows\n\n[property] Loading\nfile://C:/Java/Apache/jakarta-ant/src/etc/testcases/taskdefs/property3.properties\n\n....\n\na check of the box that work also shows that the file://C:/Java path is the same. \n\nWhen i change test5 to add an extra leading slash,\n<property url=\"file:///${basedir}/property3.properties\"/>\n\n it works on the system that it did not before: \n\n [property] Loading\nfile:/C:/Java/Apache/jakarta-ant/src/etc/testcases/taskdefs/property3.properties\n\nNotice how the stated property (the -debug trace) has fewer /es that before. \n\nLets assume the problem is the # of forward slashes. Why does it work on one and\nnot the other? Well, the box that is failing is not in a domain. And somewhere\nin the network, there is a an address called -wait for it- C, with nothing at\nthe far end\n\nping C\n\nPinging C [15.123.209.81] with 32 bytes of data:\n\nAnd look what happens when I revert to the old version of the test and go off\nthe LAN ::\n\n [property] Loading\nfile://C:/Java/Apache/jakarta-ant/src/etc/testcases/taskdefs/property3.properties\n\nBUILD FAILED\nC:\\Java\\Apache\\jakarta-ant\\src\\etc\\testcases\\taskdefs\\property.xml:27:\njava.net.UnknownHostException: C\n\nSo on my laptop, it is trying to connect to the machine C to get the data. Why\nit is using FTP, I dont know. ", "id": 41801, "time": "2003-07-30T18:48:57Z", "creator": "stevel@apache.org", "creation_time": "2003-07-30T18:48:57Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "ddevienne@lgc.com", "is_private": false, "count": 8, "id": 41802, "time": "2003-07-30T19:01:38Z", "bug_id": 21948, "creation_time": "2003-07-30T19:01:38Z", "text": "Fascinating ;-) Now you know you have a machine called C on the LAN too... \nProbably a HACKER ;-)\n\nI had also notice the reduction from file:///C:/... to file:/C: and maybe it's \nthe correct form. Does it work for all your machines, on and off the LAN? \n\n--DD"}, {"count": 9, "tags": [], "bug_id": 21948, "text": "yes, this URL works on the broken box:\n    <property url=\"file:/${basedir}/property3.properties\"/>", "id": 41810, "time": "2003-07-30T23:09:03Z", "creator": "stevel@apache.org", "creation_time": "2003-07-30T23:09:03Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "text": "You know you shouldn't count on me when it comes to Windows 8-)\n\nThe reason I asked for the third slash is simply that this is required according\nto URL syntax.  The file: scheme works similar to http:, it is\nfile://host/path - with the main difference that an empty host part means\nlocalhost (or this machine or whatever).\n\nIf you have something like file://C:\\Temp, the URL handling code witll look for\na host named C (don't know, maybe it's even trying tu use the colon as a\nseparator for the port?  scary).  The third slash prevents that.\n\nOn Unix you may even get away with four slashes as consecutive slashes are\nusually collapsed into a single one and ls //tmp is the same as ls /tmp.\nThis would allow a hardcoded third slash.\n\nFinally, the correct fix would be to run the code of FileUtils#toURI over\nwhatever you are passing to the url attribute.  Do we have a task for that?", "id": 41825, "time": "2003-07-31T06:52:52Z", "bug_id": 21948, "creation_time": "2003-07-31T06:52:52Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "peter.reilly@corvil.com", "is_private": false, "count": 11, "id": 41827, "time": "2003-07-31T08:25:21Z", "bug_id": 21948, "creation_time": "2003-07-31T08:25:21Z", "text": "Yikes, yes I had forgotten about windows\nwhen writing the test.\nI will get a fix for this.\n"}, {"count": 12, "tags": [], "bug_id": 21948, "text": "Ok, I placed a fix into CVS head, it works\non linux, but I do not have access to Windows,\nit should however work there as well.\n", "id": 41828, "time": "2003-07-31T09:07:20Z", "creator": "peter.reilly@corvil.com", "creation_time": "2003-07-31T09:07:20Z", "is_private": false, "attachment_id": null}]