[{"count": 0, "tags": [], "bug_id": 11035, "text": "If in a CGI-script a header outputted, such as \"Content-Language: en\", and \nApache has DefaultLanguage en in the httpd.conf, the output of the cgi-script \nwill be \"Content-Language: en, en\"", "id": 19968, "attachment_id": null, "creator": "info@orangexl.com", "creation_time": "2002-07-22T10:22:18Z", "time": "2002-07-22T10:22:18Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 11035, "is_private": false, "text": "FWIW, it still works on current code and 1.3 works this way too.\n\nThe double \"en\" has nothing to do with mod_cgi but instead with how\nthe merge operation works in the http header filter, so I'm changing the\ncomponent from mod_cgi to core.\n", "id": 31166, "time": "2003-02-12T20:35:43Z", "creator": "trawick@apache.org", "creation_time": "2003-02-12T20:35:43Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 11035, "text": "Created attachment 19565\nPatchAvailable\n\nIf defaultLanguage is defined and cgi/module try to set the Content-Language\nheader, apache merge the various content languages. However before this fix,\napache doesn't avoid duplicate content languages.\n\nIn this fix we create a hash of existing languages (in Content-Language)\nheader. Before adding a new language in Content-Length, we verify if the\nlanguage doesn't exist before.\n\nThere is a overhead of creating a hash however it only happens if module/cgi\nset content-language header and DefaultLanguage is defined.\n\nThe patch has been tested with following perl and php scripts:\n\n#!/usr/bin/perl\nprint \"Content-type: text/plain\\n\";\nprint \"Content-Language: en, fr, sp\\n\\n\";\nprint \"mod_perl 2.0 rocks!\\n\";\n\n\n#!/usr/bin/perl\nprint \"Content-type: text/plain\\n\";\nprint \"Content-Language: fr, sp, en  \\n\\n\";\nprint \"mod_perl 2.0 rocks!\\n\";\n\n\n#!/usr/bin/perl\nprint \"Content-type: text/plain\\n\\n\";\nprint \"mod_perl 2.0 rocks!\\n\";\n\n\n#!/usr/bin/php\n<?\nprint \"Content-type: text/plain\\n\";\nprint \"Content-Language: en, fr, sp\\n\\n\";\nprint \"test.php cgi script!\\n\";\n?>", "id": 99207, "time": "2007-02-09T15:38:20Z", "creator": "basant.kukreja@sun.com", "creation_time": "2007-02-09T15:38:20Z", "is_private": false, "attachment_id": 19565}, {"count": 3, "attachment_id": null, "creator": "basant.kukreja@sun.com", "is_private": false, "id": 99208, "time": "2007-02-09T15:41:06Z", "bug_id": 11035, "creation_time": "2007-02-09T15:41:06Z", "tags": [], "text": "Marking the bug as PatchAvailable"}, {"count": 4, "tags": [], "bug_id": 11035, "attachment_id": null, "is_private": false, "id": 99211, "time": "2007-02-09T16:00:56Z", "creator": "rpluem@apache.org", "creation_time": "2007-02-09T16:00:56Z", "text": "Please NEVER change the assigning of bugs. If a bug is no longer assigned to\nbugs@httpd.apache.org the respective mailing list will be cut off of any changes\nto this bug and no further care will be taken of the report by the community."}, {"count": 5, "tags": [], "bug_id": 11035, "is_private": false, "id": 104198, "attachment_id": 20327, "creator": "davi@apache.org", "creation_time": "2007-06-08T07:34:37Z", "time": "2007-06-08T07:34:37Z", "text": "Created attachment 20327\nDon't add duplicate entries to the content_languages array\n\nMuch simpler patch attached."}, {"count": 6, "tags": [], "creator": "rpluem@apache.org", "text": "(In reply to comment #5)\n> Created an attachment (id=20327) [edit]\n> Don't add duplicate entries to the content_languages array\n> \n> Much simpler patch attached.\n\napr_table_addn(r->headers_out, \"Content-Language\", field);\n\nseems wrong to me. I think it should be\n\napr_table_setn(r->headers_out, \"Content-Language\", field);\n\nto avoid having multiple Content-Language headers.", "id": 104203, "time": "2007-06-08T08:13:10Z", "bug_id": 11035, "creation_time": "2007-06-08T08:13:10Z", "is_private": false, "attachment_id": null}, {"count": 7, "attachment_id": null, "creator": "davi@apache.org", "text": "(In reply to comment #6)\n> (In reply to comment #5)\n> \n> apr_table_addn(r->headers_out, \"Content-Language\", field);\n> \n> seems wrong to me. I think it should be\n> \n> apr_table_setn(r->headers_out, \"Content-Language\", field);\n> \n> to avoid having multiple Content-Language headers.\n\nYes, obviously. Thanks!", "id": 104208, "time": "2007-06-08T09:01:48Z", "bug_id": 11035, "creation_time": "2007-06-08T09:01:48Z", "tags": [], "is_private": false}, {"count": 8, "tags": [], "text": "Created attachment 20328\nDon't add duplicate entries to the content_languages array (updated)\n\nAlso, don't duplicate the headers :)", "attachment_id": 20328, "id": 104209, "creator": "davi@apache.org", "time": "2007-06-08T09:03:27Z", "bug_id": 11035, "creation_time": "2007-06-08T09:03:27Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 11035, "attachment_id": null, "text": "Backported to 2.2.x as r631363 (http://svn.apache.org/viewvc?rev=631363&view=rev).", "id": 97594, "time": "2008-02-26T12:39:07Z", "creator": "rpluem@apache.org", "creation_time": "2008-02-26T12:39:07Z", "is_private": false}]