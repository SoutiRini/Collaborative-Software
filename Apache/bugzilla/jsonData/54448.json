[{"attachment_id": null, "tags": [], "creator": "violetagg@apache.org", "text": "Hi,\n\nI have a servlet with one field of primitive type.\nThe field is annotated with @Resource.\n\n\npublic class MyServlet extends HttpServlet {\n\n    @Resource(mappedName = \"1\")\n    private int envEntry;\n\n    protected void doGet(HttpServletRequest req, HttpServletResponse resp)\n            throws ServletException, IOException {\n        ...\n    }\n}\n\n\nWhen I request this servlet I receive the following exception:\n\n\nSEVERE: Allocate exception for servlet MyServlet\njavax.naming.NamingException: Cannot create resource instance\n\tat org.apache.naming.factory.ResourceEnvFactory.getObjectInstance(ResourceEnvFactory.java:117)\n\tat javax.naming.spi.NamingManager.getObjectInstance(NamingManager.java:304)\n\tat org.apache.naming.NamingContext.lookup(NamingContext.java:843)\n\tat org.apache.naming.NamingContext.lookup(NamingContext.java:154)\n\tat org.apache.naming.NamingContext.lookup(NamingContext.java:831)\n\tat org.apache.naming.NamingContext.lookup(NamingContext.java:168)\n\tat org.apache.catalina.core.DefaultInstanceManager.lookupFieldResource(DefaultInstanceManager.java:581)\n\tat org.apache.catalina.core.DefaultInstanceManager.processAnnotations(DefaultInstanceManager.java:470)\n\tat org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultInstanceManager.java:157)\n\tat org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultInstanceManager.java:138)\n\tat org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1137)\n\tat org.apache.catalina.core.StandardWrapper.allocate(StandardWrapper.java:858)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:136)\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)\n\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\n\tat org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1004)\n\tat org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)\n\tat org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n\tat java.lang.Thread.run(Thread.java:680)\n\n\nThat's because in the method below the primitive types are not 'converted' to their corresponding wrappers and this field is interpreted not as env entry but as resource env ref. org.apache.catalina.startup.WebAnnotationSet.addResource(Context, Resource, \nString, String)\n\n\nI'm attaching a patch that solves this issue and a test case.\n\nI'm looking forward to your comments.\n\nRegards\nVioleta", "count": 0, "id": 164715, "time": "2013-01-17T21:48:35Z", "bug_id": 54448, "creation_time": "2013-01-17T21:48:35Z", "is_private": false}, {"count": 1, "tags": [], "creator": "violetagg@apache.org", "is_private": false, "text": "Created attachment 29865\npatch proposal + test", "id": 164716, "time": "2013-01-17T21:53:00Z", "bug_id": 54448, "creation_time": "2013-01-17T21:53:00Z", "attachment_id": 29865}, {"count": 2, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "is_private": false, "id": 164821, "time": "2013-01-23T10:24:30Z", "bug_id": 54448, "creation_time": "2013-01-23T10:24:30Z", "text": "Thanks for the report, patch and test case. The patch has been applied to trunk and 7.0.x and will be included in 7.0.36 onwards."}]