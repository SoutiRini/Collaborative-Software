[{"count": 0, "attachment_id": null, "creator": "corporate_gadfly@hotmail.com", "text": "I have an ant target as follows (for remote deploying):\n\n  <target name=\"remote-deploy\"\n   description=\"Deploy application to remote host\">\n    <echo message=\"Deploying war to remote host: ${host} with tag ${tag.war}\"/>\n    <deploy url=\"http://${host}:8080/manager\"\n        username=\"${tomcat.username}\"\n        password=\"${tomcat.password}\"\n        path=\"/${app.name}\"\n        update=\"true\"\n        tag=\"${tag.war}\"\n        war=\"file:${gen.dir}/war/${webapp.war}\"/>\n  </target>\n\nA few days ago I noticed the following output from my nightly ant build:\n\n   [deploy] FAIL - Encountered exception java.io.FileNotFoundException:\n/servers/jakarta-tomcat-5.0.24/work/Catalina/localhost/manager/sws-1.1-prod-2005\n-01-10-2341/sws.war (No such file or directory)\n\nSomething had happened to the filesystem, so the deploy wasn't successful. Even\nthough the deploy failed, I got a BUILD SUCCESSFUL at the end of the ant output.\n\nShouldn't that instead be a BUILD FAILED?", "id": 69821, "time": "2005-01-18T21:44:59Z", "bug_id": 33159, "creation_time": "2005-01-18T21:44:59Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "text": "Not that it should matter, but I do use the ant-contrib <foreach> task to call\nmy remote-deploy target, in parallel, as follows:\n\n            <foreach target=\"remote-deploy\" param=\"host\"\n                delimiter=\"${line.separator}\"\n                parallel=\"true\"\n                list=\"${remote-hosts}\" inheritall=\"true\"/>\n\nThanks in advance,\n\nCheers", "attachment_id": null, "bug_id": 33159, "id": 69823, "time": "2005-01-18T21:49:53Z", "creator": "corporate_gadfly@hotmail.com", "creation_time": "2005-01-18T21:49:53Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 33159, "text": "Does it fail properly if you don't do foreach, i.e. just try a simple deploy?  \nI think foreach/parallel explicitly does not fail overall execution if one \npath/list fails.", "id": 71022, "time": "2005-02-15T18:25:09Z", "creator": "yoavs@computer.org", "creation_time": "2005-02-15T18:25:09Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "(In reply to comment #2)\n> Does it fail properly if you don't do foreach, i.e. just try a simple deploy?  \n> I think foreach/parallel explicitly does not fail overall execution if one \n> path/list fails.\n\nThanks for the response Yoav. I will try and see if I can conjure up a testcase\nwhere I can fail with a simple deploy. In the meantime, I will read up on the\nforeach/parallel fail handling.", "attachment_id": null, "bug_id": 33159, "id": 71087, "time": "2005-02-16T15:30:15Z", "creator": "corporate_gadfly@hotmail.com", "creation_time": "2005-02-16T15:30:15Z", "is_private": false}, {"count": 4, "tags": [], "text": "(In reply to comment #2)\n> Does it fail properly if you don't do foreach, i.e. just try a simple deploy?  \n> I think foreach/parallel explicitly does not fail overall execution if one \n> path/list fails.\n\nHi Yoav,\n\nHere's some followup. I have tried a few simple deploys (while trying to cause a\nfailure) and even with foreach/parallel out of the equation, <deploy> would not\nshow deterministic results. Sometimes I would get a \"BUILD SUCCESSFUL\" and\nsometimes a \"BUILD FAILED\" even though the message in all the cases was as follows:\n\n   [deploy] FAIL - Encountered exception java.io.IOException:\njava.lang.IllegalStateException: Context path /sws is already in use\n\nSeeing the above message paired up with the BUILD SUCCESSFUL is a little\ndisconcerting.\n\nDoing some more followup on the foreach/parallel, I have a simple ant file which\nshows that the foreach/parallel combination is not to blame:\n\n<?xml version=\"1.0\"?>\n<project name=\"ant-contrib parallel task\" default=\"parallel\">\n\n<property name=\"lib.dir\" value=\"${user.home}/libfiles.java\"/>\n<!-- Ant-Contrib -->\n<property name=\"ant-contrib.ver\" value=\"0.6\"/>\n<property name=\"ant-contrib.dir\"\nlocation=\"${lib.dir}/ant-contrib-${ant-contrib.ver}\"/>\n\n<taskdef resource=\"net/sf/antcontrib/antcontrib.properties\"\n    classpath=\"${ant-contrib.dir}/lib/ant-contrib-${ant-contrib.ver}.jar\"/>\n\n<target name=\"parallel\">\n    <foreach target=\"foo\" param=\"arg\"\n        parallel=\"true\"\n        list=\"1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20\"\ninheritall=\"true\"/>\n</target>\n\n<target name=\"foo\">\n    <echo message=\"--${arg}--\"/>\n    <if>\n        <equals arg1=\"${arg}\" arg2=\"3\"/>\n        <then>\n            <fail message=\"Failing for argument ${arg}\"/>\n        </then>\n    </if>\n</target>\n\n</project>\n\nI will attach it to the bugreport as well.\n\nAny more ideas on how to further investigate the <deploy> task?", "attachment_id": null, "bug_id": 33159, "id": 71131, "time": "2005-02-17T19:07:07Z", "creator": "corporate_gadfly@hotmail.com", "creation_time": "2005-02-17T19:07:07Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 33159, "text": "Created attachment 14306\nant file which shows that foreach/parallel target behaves okay", "id": 71132, "time": "2005-02-17T19:08:14Z", "creator": "corporate_gadfly@hotmail.com", "creation_time": "2005-02-17T19:08:14Z", "is_private": false, "attachment_id": 14306}, {"attachment_id": null, "tags": [], "creator": "yoavs@computer.org", "is_private": false, "count": 6, "id": 72171, "time": "2005-03-11T04:18:29Z", "bug_id": 33159, "creation_time": "2005-03-11T04:18:29Z", "text": "I don't have time to mess with ant at the moment.  If you have a patch, please \ncontribute it and I'll gladly incorporate it into the build file."}, {"count": 7, "tags": [], "text": "Guess not.", "is_private": false, "bug_id": 33159, "id": 77559, "time": "2005-07-22T15:22:59Z", "creator": "yoavs@computer.org", "creation_time": "2005-07-22T15:22:59Z", "attachment_id": null}]