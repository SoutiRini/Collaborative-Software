[{"count": 0, "tags": [], "bug_id": 3273, "attachment_id": null, "is_private": false, "id": 4871, "time": "2001-08-25T23:38:55Z", "creator": "tony_robertson@yahoo.com", "creation_time": "2001-08-25T23:38:55Z", "text": "Using the RE.match(CharacterIterator,int) function\nwith a \"CharacterArrayCharacterIterator\", then calling \"getParen(int)\"\noften returns a string of the incorrect length, or throws an exception.\n\nThis is due to the implementation of \"substring(int,int)\" in the\nCharacterArrayCharacterIterator class and/or the mis-documentation of\nthe CharacterIterator.substring interface.\n\nThe confusion is in whether the second argument to substring represents\nthe endIndex or the length. The API docs say it's the length, but the\nRE implementation, and the StringCharacterIterator implementation both\ntreat it as the endIndex.\n[Note, the standard java string has,\njava.lang.String.substring(int beginIndex, int endIndex)\nbut the constructor is java.lang.String(char[] src, int off, int len)]\n\nSecondly, there is no check that the requested substring stays within the\nbounds of the sequence length specified at construction time.\nAn IndexOutOfBoundsException should be thrown in that case.\n\nI think the best solution is to first update the API docs to specify\nthat it is infact (beginIndex, endIndex), and then to update the \nCharacterArrayCharacterIterator.substring functions to be something like this:\n\n public String substring(int beginIndex, int endIndex)\n {\n   if (endIndex > len)\n     throw new IndexOutOfBoundsException(\"endIndex=\" + endIndex +\n\t\"; sequence size=\" + len);\n   if (beginIndex < 0)\n     throw new IndexOutOfBoundsException(\"beginIndex=\" + beginIndex);\n   return new String(src, off + beginIndex, endIndex - beginIndex);\n }\n\n public String substring(int beginIndex)\n {\n   if (beginIndex > len)\n     throw new IndexOutOfBoundsException(\"index=\" + beginIndex +\n\t\"; sequence size=\" + len);\n   return new String(src, off + beginIndex, len - beginIndex);\n }"}, {"count": 1, "tags": [], "text": "Created attachment 8532\nImplementation of the fix suggested in this bug.", "is_private": false, "bug_id": 3273, "id": 45409, "time": "2003-10-11T03:27:47Z", "creator": "son@sparc.spb.su", "creation_time": "2003-10-11T03:27:47Z", "attachment_id": 8532}, {"count": 2, "tags": [], "creator": "vgritsenko@apache.org", "is_private": false, "text": "Changed bug summary from\n  \"CharacterArrayCharacterIterator substring function returns incorrect results\"\nto\n  \"CharacterArrayCharacterIterator docs and implementation mismatch\"", "id": 47546, "time": "2003-11-18T14:04:21Z", "bug_id": 3273, "creation_time": "2003-11-18T14:04:21Z", "attachment_id": null}, {"count": 3, "attachment_id": null, "creator": "vgritsenko@apache.org", "is_private": false, "id": 47548, "time": "2003-11-18T14:10:38Z", "bug_id": 3273, "creation_time": "2003-11-18T14:10:38Z", "tags": [], "text": "Patch applied; please check and close the bug.\n\nThanks,\nVadim"}]