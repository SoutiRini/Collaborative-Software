[{"count": 0, "tags": [], "creator": "lahoda@gmail.com", "attachment_id": 29541, "is_private": false, "id": 163139, "time": "2012-11-02T08:08:22Z", "bug_id": 54090, "creation_time": "2012-11-02T08:08:22Z", "text": "Created attachment 29541\nA project demonstrating the problem.\n\nSeems that the depend task does not handle classfiles with the invokeDynamic properly:\n/tmp/invokeDynamicByteCode/nbproject/build-impl.xml:923: The following error occurred while executing this line:\n/tmp/invokeDynamicByteCode/nbproject/build-impl.xml:329: java.lang.ClassFormatError: Invalid Constant Pool entry Type 18\n        at org.apache.tools.ant.taskdefs.optional.depend.constantpool.ConstantPoolEntry.readEntry(ConstantPoolEntry.java:159)\n        at org.apache.tools.ant.taskdefs.optional.depend.constantpool.ConstantPool.read(ConstantPool.java:67)\n        at org.apache.tools.ant.taskdefs.optional.depend.ClassFile.read(ClassFile.java:72)\n        at org.apache.tools.ant.taskdefs.optional.depend.AntAnalyzer.determineDependencies(AntAnalyzer.java:92)\n        at org.apache.tools.ant.util.depend.AbstractAnalyzer.getClassDependencies(AbstractAnalyzer.java:100)\n        at org.apache.tools.ant.taskdefs.optional.depend.Depend.determineDependencies(Depend.java:346)\n        at org.apache.tools.ant.taskdefs.optional.depend.Depend.execute(Depend.java:718)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)\n        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:474)\n        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)\n        at org.apache.tools.ant.Task.perform(Task.java:348)\n        at org.apache.tools.ant.taskdefs.Sequential.execute(Sequential.java:68)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)\n        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:474)\n        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)\n        at org.apache.tools.ant.Task.perform(Task.java:348)\n        at org.apache.tools.ant.taskdefs.MacroInstance.execute(MacroInstance.java:398)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)\n        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:474)\n        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)\n        at org.apache.tools.ant.Task.perform(Task.java:348)\n        at org.apache.tools.ant.Target.execute(Target.java:390)\n        at org.apache.tools.ant.Target.performTasks(Target.java:411)\n        at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1368)\n        at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1251)\n        at org.apache.tools.ant.Main.runBuild(Main.java:809)\n        at org.apache.tools.ant.Main.startAnt(Main.java:217)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:280)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:109)\n\nThis may exist for some time, but is a bigger problem now, as it seems that recent JDK-lambda builds appear to be using invokeDynamic to implement lambdas.\n\nTo reproduce:\n-download and unpack the attached project\n-run \"ant\" inside the project - the above exception appears for me\n\nThe above steps work even when running on JDK6, but the project as such can only be succesfully compiled on a lambda JDK.\n\nTested with custom build ant from revision 1404889, and with:\n$ ant -version\nApache Ant(TM) version 1.8.2 compiled on December 20 2010"}, {"count": 1, "attachment_id": null, "bug_id": 54090, "text": "https://github.com/jenkinsci/constant-pool-scanner/issues/2 is similar.", "id": 164594, "time": "2013-01-11T22:16:00Z", "creator": "jglick@apache.org", "creation_time": "2013-01-11T22:16:00Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "text": "can you build ant from the latest sources in svn found under http://svn.apache.org/repos/asf/ant/core/trunk/ and try your build?", "attachment_id": null, "id": 164777, "creator": "antoine@apache.org", "time": "2013-01-22T05:06:15Z", "bug_id": 54090, "creation_time": "2013-01-22T05:06:15Z", "is_private": false}]