[{"count": 0, "tags": [], "bug_id": 43800, "attachment_id": null, "id": 110279, "creation_time": "2007-11-06T15:09:16Z", "time": "2007-11-06T15:09:16Z", "creator": "panther@pinkboard.com.au", "text": "I have configuration where where Tomcat loads the SSL connector correctly when\nthe native library is not installed, but has an error when the native library is\nadded to the classpath.\n\nConfiguration is a fresh install with this added to server.xml:\n\t<Connector port=\"8443\" protocol=\"HTTP/1.1\" SSLEnabled=\"true\"\n               maxThreads=\"10\" scheme=\"https\" secure=\"true\"\n               clientAuth=\"true\" sslProtocol=\"TLS\"\n               keystoreFile=\"C:\\SmartHealth\\SmartdevelopmentSSLStore\"\n               keystorePass=\"W0Lv3r1n3\"\n               truststoreFile=\"C:\\SmartHealth\\truststore\"\n               truststorePass=\"changeit\"/>\n\nError is:\n\n7/11/2007 10:07:07 org.apache.catalina.core.AprLifecycleListener init\nINFO: Loaded Apache Tomcat Native library 1.1.10.\n7/11/2007 10:07:07 org.apache.catalina.core.AprLifecycleListener init\nINFO: APR capabilities: IPv6 [false], sendfile [true], accept filters [false],\nrandom [true].\n7/11/2007 10:07:08 org.apache.coyote.http11.Http11AprProtocol init\nINFO: Initializing Coyote HTTP/1.1 on http-8080\n7/11/2007 10:07:08 org.apache.coyote.http11.Http11AprProtocol init\nSEVERE: Error initializing endpoint\njava.lang.Exception: No Certificate file specified\n\tat org.apache.tomcat.jni.SSLContext.setCertificate(Native Method)\n\tat org.apache.tomcat.util.net.AprEndpoint.init(AprEndpoint.java:684)\n\tat org.apache.coyote.http11.Http11AprProtocol.init(Http11AprProtocol.java:121)\n\tat org.apache.catalina.connector.Connector.initialize(Connector.java:1059)\n\tat org.apache.catalina.core.StandardService.initialize(StandardService.java:677)\n\tat org.apache.catalina.core.StandardServer.initialize(StandardServer.java:792)\n\tat org.apache.catalina.startup.Catalina.load(Catalina.java:518)\n\tat org.apache.catalina.startup.Catalina.load(Catalina.java:538)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:585)\n\tat org.apache.catalina.startup.Bootstrap.load(Bootstrap.java:260)\n\tat org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:412)\n7/11/2007 10:07:08 org.apache.catalina.startup.Catalina load\nSEVERE: Catalina.start\nLifecycleException:  Protocol handler initialization failed:\njava.lang.Exception: No Certificate file specified\n\tat org.apache.catalina.connector.Connector.initialize(Connector.java:1061)\n\tat org.apache.catalina.core.StandardService.initialize(StandardService.java:677)\n\tat org.apache.catalina.core.StandardServer.initialize(StandardServer.java:792)\n\tat org.apache.catalina.startup.Catalina.load(Catalina.java:518)\n\tat org.apache.catalina.startup.Catalina.load(Catalina.java:538)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:585)\n\tat org.apache.catalina.startup.Bootstrap.load(Bootstrap.java:260)\n\tat org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:412)\n7/11/2007 10:07:08 org.apache.catalina.startup.Catalina load\nINFO: Initialization processed in 1864 ms\n7/11/2007 10:07:08 org.apache.catalina.core.StandardService start\nINFO: Starting service Catalina\n7/11/2007 10:07:08 org.apache.catalina.core.StandardEngine start\nINFO: Starting Servlet Engine: Apache Tomcat/6.0.14\n7/11/2007 10:07:10 org.apache.coyote.http11.Http11AprProtocol start\nINFO: Starting Coyote HTTP/1.1 on http-8080\n7/11/2007 10:07:10 org.apache.coyote.http11.Http11AprProtocol start\nSEVERE: Error starting endpoint\njava.lang.Exception: Socket bind failed: [730048] Only one usage of each socket\naddress (protocol/network address/port) is normally permitted.  \n\tat org.apache.tomcat.util.net.AprEndpoint.init(AprEndpoint.java:612)\n\tat org.apache.tomcat.util.net.AprEndpoint.start(AprEndpoint.java:717)\n\tat org.apache.coyote.http11.Http11AprProtocol.start(Http11AprProtocol.java:151)\n\tat org.apache.catalina.connector.Connector.start(Connector.java:1132)\n\tat org.apache.catalina.core.StandardService.start(StandardService.java:531)\n\tat org.apache.catalina.core.StandardServer.start(StandardServer.java:710)\n\tat org.apache.catalina.startup.Catalina.start(Catalina.java:566)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:585)\n\tat org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n\tat org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:413)\n7/11/2007 10:07:10 org.apache.catalina.startup.Catalina start\nSEVERE: Catalina.start: \nLifecycleException:  service.getName(): \"Catalina\";  Protocol handler start\nfailed: java.lang.Exception: Socket bind failed: [730048] Only one usage of each\nsocket address (protocol/network address/port) is normally permitted.  \n\tat org.apache.catalina.connector.Connector.start(Connector.java:1139)\n\tat org.apache.catalina.core.StandardService.start(StandardService.java:531)\n\tat org.apache.catalina.core.StandardServer.start(StandardServer.java:710)\n\tat org.apache.catalina.startup.Catalina.start(Catalina.java:566)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:585)\n\tat org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n\tat org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:413)\n7/11/2007 10:07:10 org.apache.catalina.startup.Catalina start\nINFO: Server startup in 2449 ms", "is_private": false}, {"count": 1, "tags": [], "bug_id": 43800, "attachment_id": null, "text": "The configuration for an HTTPS Connector when using APR is different from the\nconfiguration when APR is not used. This is explained in the docs for APR.\nIf something remains unclear after reading the docs, post your question to the\nTomcat Users mailing list.", "id": 110281, "time": "2007-11-06T15:25:27Z", "creator": "bugzilla@schoenhaber.de", "creation_time": "2007-11-06T15:25:27Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 43800, "attachment_id": null, "id": 110690, "creation_time": "2007-11-18T15:07:35Z", "time": "2007-11-18T15:07:35Z", "creator": "panther@pinkboard.com.au", "text": "This error message does not make it easy to find what caused the error. \n\nThe message does not mention APR. The Tomcat installation talks about native,\nnot APR. There is no obvious connection between these two terms. I suggest this\nmessage is changed:\n7/11/2007 10:07:07 org.apache.catalina.core.AprLifecycleListener init\nINFO: Loaded Apache Tomcat Native library 1.1.10.\nto:\n7/11/2007 10:07:07 org.apache.catalina.core.AprLifecycleListener init\nINFO: Loaded Apache Tomcat Native (APR) library 1.1.10.\n\nI suggest the message at the top of the page\nhttp://tomcat.apache.org/tomcat-6.0-doc/ssl-howto.html also includes the words\n\"Apache Tomcat Native library\".\n\nAlso, the error message says the file is not specified. I suggest this message\nbe revised to say \"no file specified or in an invalid format\".", "is_private": false}, {"count": 3, "attachment_id": null, "bug_id": 43800, "text": "Thanks for the comments. I have updated the docs, the installer and the error\nmessages. Generally I have replaced APR and Native with \"APR based Apache Tomcat\nNative library\" or similar.\n\nThese changes have been made in svn and proposed for 6.0.x", "id": 112371, "time": "2008-01-01T09:34:33Z", "creator": "markt@apache.org", "creation_time": "2008-01-01T09:34:33Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 43800, "attachment_id": null, "text": "This has been fixed in svn and will be included in 6.0.16 onwards.", "id": 112746, "time": "2008-01-10T13:28:48Z", "creator": "markt@apache.org", "creation_time": "2008-01-10T13:28:48Z", "is_private": false}]