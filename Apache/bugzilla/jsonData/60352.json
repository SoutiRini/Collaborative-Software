[{"attachment_id": null, "tags": [], "creator": "cos.marginean@gmail.com", "text": "We use XSSFExcelExtractor as a mechanism to extract the complete text in an Excel file, however it seems that in certain circumstances the \"null\" value is extracted from an empty cell.\n\nFor example:\n\n> Breakdown of data generated by project, technology, submitting centre\tnull\t> null\tnull\tnull\tnull\tnull\n> null\tnull\tnull\tnull\tnull\tnull\tnull\n> null\tAbbreviation Definitions\tnull\tnull\tnull\tnull\tnull\n> null\tPlatform\tDefinition\tnull\tnull\tnull\tnull\n> null\tLS454\t454 Roche Genome Sequencer FLX System\tnull\tnull\tnull\t\n\n\nThe patch is relatively simple (and I'm happy to create a PR for it on GitHub). All we need to is to wrap the last two lines in XSSFExcelExtractor.handleNonStringCell() with a null check\n\n>         if (contents != null) {\n>             checkMaxTextSize(text, contents);\n>             text.append(contents);\n>         }\n\nThis would then perform as expected and extract this text instead.\n\n> Breakdown of data generated by project, technology, submitting centre\t\t\t\t\t\t\n> \t\t\t\t\t\t\n> \tAbbreviation Definitions\t\t\t\t\t\n> \tPlatform\tDefinition\t\t\t\t\n> \tLS454\t454 Roche Genome Sequencer FLX System\n\nWe believe that an empty string is the preferred option here, because the text \"null\" itself might be used as cell contents in certain cases. In that situation it's difficult to discriminate between these occurrences (is it the text \"null\" or is the cell empty?)\n\nLooking forward to hearing your thoughts.", "count": 0, "id": 194863, "time": "2016-11-08T09:29:27Z", "bug_id": 60352, "creation_time": "2016-11-08T09:29:27Z", "is_private": false}, {"count": 1, "tags": [], "text": "Fixed via r1794260, should be included in release 3.17-beta1, thanks for the report and the suggested fix.", "is_private": false, "bug_id": 60352, "id": 198728, "time": "2017-05-08T18:11:48Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2017-05-08T18:11:48Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 60352, "attachment_id": null, "id": 198741, "time": "2017-05-09T13:42:26Z", "creator": "cos.marginean@gmail.com", "creation_time": "2017-05-09T13:42:26Z", "is_private": false, "text": "Great! Many thanks!"}]