[{"count": 0, "tags": [], "creator": "koos.pol@nl.compuware.com", "is_private": false, "text": "In order to shorten my CLASSPATH (Windows) I've put all my project jars in the\nroot of a directory mapping (ex. X:\\ant-launcher.jar).\n\norg.apache.tools.ant.launch.Launcher fails in this setup. It apparently requires\nthe ant jars to be located in a subdirectory. (ex. X:\\ant\\ant-launcher.jar).", "id": 99158, "time": "2007-02-09T01:13:09Z", "bug_id": 41579, "creation_time": "2007-02-09T01:13:09Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 41579, "attachment_id": null, "text": "If you would install ant in the root of a drive the ant-launcher.jar would be in\nthe lib directory, no in the root directory (this should also be the case on\nunix/linux systems). The ant-launcher (nor any of the other jar files in the lib\ndirectory) typically need not be  on the CLASSPATH environment variable.\nRecommended usage of ant even ignores the CLASSPATH as provided in the environment.\n\nCould you please elaborate on \na) how you try to start ant\nb) what you are trying to achieve", "id": 99195, "time": "2007-02-09T13:20:00Z", "creator": "jkf@apache.org", "creation_time": "2007-02-09T13:20:00Z", "is_private": false}, {"count": 2, "tags": [], "creator": "koos.pol@nl.compuware.com", "text": "In answer to your questions:\na) ant is started by an embedded CruiseControl configuration. That is, I supply\nthe build.xml and CruiseControl takes care of the rest. CruiseControl has a\nserver/daemon part from which it fires up ant if given instructions to do so.\n\nb) The only thing I'm trying to achieve is shortening the CLASSPATH for my\nproject. By now I've got 49 jars. Some are part of 3rd party tools such as\nCruiseControl. So I have to deal with the many jars I'm given.\n\nBTW, this is the CruiseControl output.\n[cc]Feb-12 08:50:23 ScriptRunner  - java.lang.NullPointerException\n[cc]Feb-12 08:50:23 ScriptRunner  -     at\norg.apache.tools.ant.launch.Launcher.run(Launcher.java:125)\n[cc]Feb-12 08:50:23 ScriptRunner  -     at\norg.apache.tools.ant.launch.Launcher.main(Launcher.java:67)\n\nBlessed with no ant design knowledge whatsoever I'd expect this behavior to be\nregarded as a bug. That is, ant-launcher should be allowed to live in the root\njust fine.\n\n\n", "id": 99266, "time": "2007-02-11T23:57:09Z", "bug_id": 41579, "creation_time": "2007-02-11T23:57:09Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 41579, "text": "Cruisecontrol also ignores the CLASSPATH. The standard Cruisecontrol also\nexpects a complete ant to be installed, installed in anthome (so that\n${anthome}/lib contains ant-launcher.jar)\nsomething like\n<ant anthome=\"x:\\apache-ant-1.7.0\" buildfile=\"projects/${project.name}/build.xml\"/>\nor even\n<ant anthome=\"x:\\\" buildfile=\"projects/${project.name}/build.xml\"/>\n\n\nSo I still have no clue why ant (or cruisecontrol for that matter) would have to\nbe on the CLASSPATH.\n\nIn order to shorten the CLASSPATH you could repack all ant-*.jar, except for\nant-launcher.jar of ant into a single jar file ant-optional.jar.\n\nPlacing ant-launcher in the root directory might work if the system property\nant.home is set correctly, and all jar files of ant are available under\n${ant.home}/lib, some other files of ant should be available in ${ant.home}/etc\nand ${ant.home}/bin. Please note that this is not and most probably will not be\nsupported.\n\nAs said before a complete ant installation should live in the root just fine,\nbut a complete ant installation has ant-launcher.jar in the lib directory, and\ntherefore never in the root.\n\nB.t.w. you report this as a bug to 1.7.0, yet the launcher you use seems to be\nfrom another ant version (as can be deduced from the line numbers displayed in\nthe stack trace.) Mixing ant versions is known to cause troubles and is not\nsupported either.", "count": 3, "id": 99286, "time": "2007-02-12T10:01:44Z", "creator": "jkf@apache.org", "creation_time": "2007-02-12T10:01:44Z", "is_private": false}, {"count": 4, "attachment_id": null, "bug_id": 41579, "is_private": false, "id": 99318, "time": "2007-02-13T01:11:28Z", "creator": "koos.pol@nl.compuware.com", "creation_time": "2007-02-13T01:11:28Z", "tags": [], "text": "Reporting this problem against 1.7.0 is my bad. Should've been 1.6.5. My\napologies. Field updated.\n\nThe CLASSPATH requirements come from the fact that we are running our own build\nmanagement tool (based upon an embeded CC). \nOur embedded CC (only using cruisecontrol.jar and cruisecontrol-launcher.jar) \nruns just fine without a complete ant installation. Hence there is the need for\nfully specified jars in the CLASSPATH.\n\nAlthough I appreciate your explanation, it doesn't explain why it is required\nfor ant-launcher to live in a subdir. Checking the sources around line 125 I'm\ngetting the feeling the subdir problem only exist because it is hardcoded as\nsuch. Not because there is a design requirement.\n\nIf you insist this is not a bug, feel free to close this bug. I will hardlink to\nthis page in our sources for reference.\nThanks,\nKP.\n\n\n\n"}, {"count": 5, "tags": [], "creator": "jkf@apache.org", "is_private": false, "text": "As far as I can see, things even work when ant-launcher.jar is in the root of a\ndrive, again note that this is not a supported set-up.\nIn this case ant will just need to know where the ant.home drive is (can be the\nroot of the drive) and where to find the ant libraries (ant.library.dir), (can\nalso be the root of the drive).\n\nThe problem is, when no ant.home is defined ant-launcher expects a standard\ninstallation where ant.home is one level above the library directory where\nant-launcher.jar is supposed to be present. As ant.home is not set and the root\ndirectory has no parent the ant.home (where ant searches for certain other\nfiles) becomes null, which leads to problems.\n\nI have verified this against ant 1.7.1Alpha\n\nD:\\data\\eclipseworkspace\\ant-trunk>subst x: d:\\data\\eclipseworkspace\\ant-trunk\\d\nist\\lib\n\nD:\\data\\eclipseworkspace\\ant-trunk>dir x:\n Het volume in station X heeft geen naam.\n Het volumenummer is \n\n Map van X:\\\n\n13-02-2007  20:29    <DIR>          .\n13-02-2007  20:29    <DIR>          ..\n09-02-2007  23:14             5.754 ant-antlr.jar\n09-02-2007  23:14             8.601 ant-apache-bcel.jar\n09-02-2007  23:14             3.962 ant-apache-bsf.jar\n09-02-2007  23:14             3.064 ant-apache-log4j.jar\n09-02-2007  23:14            39.581 ant-apache-oro.jar\n09-02-2007  23:14             3.735 ant-apache-regexp.jar\n09-02-2007  23:14             4.079 ant-apache-resolver.jar\n09-02-2007  23:14             3.918 ant-commons-logging.jar\n09-02-2007  23:14            47.034 ant-commons-net.jar\n09-02-2007  23:14            21.356 ant-jai.jar\n09-02-2007  23:14             7.006 ant-javamail.jar\n09-02-2007  23:14             8.130 ant-jdepend.jar\n09-02-2007  23:14             6.601 ant-jmf.jar\n09-02-2007  23:14            29.992 ant-jsch.jar\n09-02-2007  23:14            93.386 ant-junit.jar\n09-02-2007  23:14            11.722 ant-launcher.jar\n09-02-2007  23:14             9.881 ant-netrexx.jar\n09-02-2007  23:14           429.084 ant-nodeps.jar\n09-02-2007  23:14             6.703 ant-swing.jar\n09-02-2007  23:14            14.914 ant-testutil.jar\n09-02-2007  23:14             6.889 ant-trax.jar\n13-02-2007  20:07         1.290.102 ant.jar\n13-02-2007  20:29    <DIR>          etc\n09-02-2007  21:52         1.223.877 xercesImpl.jar\n09-02-2007  21:52           194.354 xml-apis.jar\n              24 bestand(en)        3.473.725 bytes\n               3 map(pen)   6.636.945.920 bytes beschikbaar\n\nD:\\data\\eclipseworkspace\\ant-trunk>set CLASSPATH=x:\\ant-launcher.jar\n\nD:\\data\\eclipseworkspace\\ant-trunk>java -Dant.home=x:\\ -Dant.library.dir=x:\\ org\n.apache.tools.ant.launch.Launcher -file tst\\build.xml\nBuildfile: tst\\build.xml\n\ntest:\n     [copy] Copying 1 file to D:\\data\\eclipseworkspace\\ant-trunk\\tst\n  [replace] Replaced 1 occurrences in 1 files.\n  [replace] Replaced 2 occurrences in 1 files.\n  [replace] Replaced 0 occurrences in 0 files.\n\nBUILD SUCCESSFUL\nTotal time: 0 seconds\n\nD:\\data\\eclipseworkspace\\ant-trunk>", "id": 99338, "time": "2007-02-13T11:36:50Z", "bug_id": 41579, "creation_time": "2007-02-13T11:36:50Z", "attachment_id": null}]