[{"count": 0, "tags": [], "bug_id": 22103, "is_private": false, "text": "When there is an error in the JSP file, and the JSP compiler is invoked from an \nANT script via JspC.execute(), the opened files are not closed.\n\nWhat seems to happen is that the java output files is created and opened, the \nerror in the JSP is detected and an exception is trigered without closing the \nopened files.\n\nThat raise problems when the ANT script is called from an IDE (like eclipse) \nthat does'nt use a separate JVM to execute it.  In that case, the created empty \nfile can not be deleted without closing the IDE.\n\nIs it possible to add a finally clause somewhere to always close all opened \nfiles, even in case of errors ?", "id": 42048, "time": "2003-08-04T10:31:03Z", "creator": "gilles.scokart@be.fujitsu.com", "creation_time": "2003-08-04T10:31:03Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 22103, "text": "Since you seem to have looked into the problem in detail, could you submit a\nsmall patch ?\nOtherwise, can you give more details on where the leak come from ?", "id": 42062, "time": "2003-08-04T12:43:03Z", "creator": "remm@apache.org", "creation_time": "2003-08-04T12:43:03Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "gilles.scokart@be.fujitsu.com", "text": "Oups, sorry I can not send you a patch.  But I have look in the source, and I \nthink that if you update the org.apache.jasper.compiler.Compiler.compile\n(boolean) method by insterting\n\nif (ctx.getWriter()!=null)\n{\n   ctx.getWriter().close();\n   ctx.setWriter(null);\n}\n\nin the finally clause.\n\nBTW, how can I give you patch if I don't have a CVS client?\n", "id": 42063, "time": "2003-08-04T13:12:41Z", "bug_id": 22103, "creation_time": "2003-08-04T13:12:41Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 22103, "is_private": false, "count": 3, "id": 42079, "time": "2003-08-04T15:12:22Z", "creator": "remm@apache.org", "creation_time": "2003-08-04T15:12:22Z", "text": "Ok, the proposed change seems reasonable to me. Thanks. I assume you have\nverified it fixes your problem."}, {"count": 4, "tags": [], "creator": "gilles.scokart@be.fujitsu.com", "attachment_id": null, "text": "Unfortunately, no.  I didn't have all the environment (and/or the time) I need \nto recompile and test the fix.  But as you said, it seems reasonable.\n\nThanks.", "id": 42080, "time": "2003-08-04T15:22:38Z", "bug_id": 22103, "creation_time": "2003-08-04T15:22:38Z", "is_private": false}]