[{"count": 0, "text": "When I access some CGI scripts with \"Range: bytes=1-5\" header, \ncase Apache_Version in\n  2.0.54)\n    I got from 1 to 5 byte of all with \"Content-Range\" response header.\n    ;;\n  2.0.55, 2.0.58)\n    I got WHOLE body data without \"Content-Range\" response header.\n    ;;\nesac\n\nSSI pages are same too.\n\nI suppose changes on PR 29962 affected.\n\n* Is this correct behavior?\n* Are there any workaround in >= 2.0.55?", "bug_id": 39514, "attachment_id": null, "id": 88921, "time": "2006-05-08T16:56:35Z", "creator": "hirose31@t3.rim.or.jp", "creation_time": "2006-05-08T16:56:35Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "text": "how to repeat.\n\n* this is source code of simple CGI script.\n$ cat t/range.cgi\n#!/bin/sh\necho \"Content-Type: text/plain\"\necho\necho 0123456789\n\n* firstly, do normal HTTP access.\n$ curl -i http://example.com/t/range.cgi\nHTTP/1.1 200 OK\nDate: Tue, 09 May 2006 17:08:16 GMT\nServer: Apache/2.0.54 (Unix) PHP/4.3.11\nTransfer-Encoding: chunked\nContent-Type: text/plain; charset=euc-jp\n\n0123456789\n\n* secondary, access with \"Range\" request header to Apache-2.0.54.\n* OK, size of response body is 5 byte.\n$ curl -i -H 'Range: bytes=1-5' http://example.com/t/range.cgi\nHTTP/1.1 206 Partial Content\nDate: Tue, 09 May 2006 17:08:43 GMT\nServer: Apache/2.0.54 (Unix) PHP/4.3.11\nContent-Range: bytes 1-5/11\nContent-Length: 5\nContent-Type: text/plain; charset=euc-jp\n\n12345$\n\n* do same HTTP access to Apache-2.0.58.\n* size of response body is not 5 byte but 10byte(whole).\n$ curl -i -H 'Range: bytes=1-5' http://example.com/t/range.cgi\nHTTP/1.1 200 OK\nDate: Tue, 09 May 2006 17:09:36 GMT\nServer: Apache/2.0.58 (Unix) PHP/4.4.2 with Hardening-Patch\nTransfer-Encoding: chunked\nContent-Type: text/plain; charset=euc-jp\n\n0123456789\n$\n\nIs this changing behavior between 2.0.54 and 2.0.5[58]  known incompatibility?\n\nI hope back to following behavior like 2.0.54.\n  * Apache       add \"Content-Range\" and strip data unless CGI response data\ncontains \"Content-Range\" header.\n  * Apache don't add \"Content-Range\" and strip data if     CGI response data\ncontains \"Content-Range\" header.\n\n", "is_private": false, "bug_id": 39514, "id": 88968, "time": "2006-05-09T17:25:17Z", "creator": "hirose31@t3.rim.or.jp", "creation_time": "2006-05-09T17:25:17Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "slive@apache.org", "attachment_id": null, "id": 88971, "time": "2006-05-09T19:52:18Z", "bug_id": 39514, "creation_time": "2006-05-09T19:52:18Z", "is_private": false, "text": "I'm not sure what your question is here.  As you can see in the bug you\nreferenced (bug 29962), range responses have been deliberately turned off on\ncontent that isn't disk based, because they cause unbounded memory usage.  It is\nperfectly legal for the server to ignore the Range header when it wants, so this\nis not a bug and shouldn't cause problems for any conforming client.\n\n\n"}, {"attachment_id": null, "tags": [], "creator": "hirose31@t3.rim.or.jp", "is_private": false, "count": 3, "id": 88977, "time": "2006-05-10T03:45:04Z", "bug_id": 39514, "creation_time": "2006-05-10T03:45:04Z", "text": "Thank you for reply.\n\nI confirm that Range response turns off for response which isn't disk based(eg\nCGI, SSI).\n\nI hope that Apache team announce cleary this changing as incompatible change.\n\n> It is\n> perfectly legal for the server to ignore the Range header when it wants, so this\n> is not a bug and shouldn't cause problems for any conforming client.\n\n(digression)\nI know that, but browser in some mobile phone absolutely need Range response\nwhen downloading media data(sound, movie...)."}, {"count": 4, "tags": [], "text": "Well, the change isn't incompatible in the sense that it will not break any\ncompliant browsers.  You seem to be dealing with clients that do not properly\nimpliment http.\n\nYou might consider bringing up this issue on the developers list to see if any\ndevelopers have an interest in partially restoring byteranges on dynamic\ncontent.  Personally, I've never understood why it was necessary to completely\ndisable dynamic byteranges.  Clients that request out-of-order byteranges\nobviously require buffering and should be ignored.  But for in-order byteranges,\nyou would think httpd could simply dump content until it hits the relevant range\nrather than buffering it all in memory.", "is_private": false, "bug_id": 39514, "id": 88996, "time": "2006-05-10T14:48:25Z", "creator": "slive@apache.org", "creation_time": "2006-05-10T14:48:25Z", "attachment_id": null}, {"count": 5, "text": "If you need to send ranged responses in your CGI script, do it in your CGI\nscript; parse the Range header and send a response with an appropriate\nContent-Range header.\n\nIMO it is simply not correct to do this in general at httpd level - it's very\nexpensive (say your CGI script generates 2Gb of content, and the user just\nrequested the last 2 bytes), and it would add a lots of complexity.", "bug_id": 39514, "attachment_id": null, "id": 89000, "time": "2006-05-10T15:33:29Z", "creator": "jorton@redhat.com", "creation_time": "2006-05-10T15:33:29Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "creator": "hirose31@t3.rim.or.jp", "attachment_id": null, "is_private": false, "id": 89018, "time": "2006-05-11T04:19:38Z", "bug_id": 39514, "creation_time": "2006-05-11T04:19:38Z", "text": "The reply thank you.\n\nI also think that the modification of byterange is appropriate and Range should\nbe processed on CGI side. And I know properly implimented http client is no problem.\n\nSimply, I hoped announcing clearly the fact that byterange processing which is\napplied to also CGI so far stopped being applied, as incompatibility between\nApache-2.0.54 and 2.0.55. (I cannot grasp this change from CHANGES_2.0.55)\n\nBecause perhaps the user of CGI and mod_jk/Tomcat which depend on the Range\nprocessing of Apache is...\n\nFor example, MySQL say cleary \"Incompatible change\" in its change history \n<http://dev.mysql.com/doc/refman/5.0/en/news-5-0-19.html>. This is very helpful\nfor mysql users. I think many Apache user are happy if Apache team announce\ndistinguishing the difference with incompatible change and just bug fix.\n\n"}, {"count": 7, "tags": [], "creator": "trawick@apache.org", "attachment_id": null, "id": 89029, "time": "2006-05-11T10:18:23Z", "bug_id": 39514, "creation_time": "2006-05-11T10:18:23Z", "is_private": false, "text": ">(I cannot grasp this change from CHANGES_2.0.55)\n\nThat is a good point.  It is an interesting change which some people would want\nto understand since they may see the change when analyzing network traces.\n\nAs far as \"incompatibility:\"  Perhaps a more accurate way to say this from our\nperspective is:  \"[It is remotely possible that somebody somewhere has a broken\nHTTP client which would be affected by this change.]\"  But that would have to be\nadded to many CHANGES entries, and perhaps many thousands of people would feel\nthe need to investigate some of these issues even though actual problems are\nextremely rare, and the problem would be present only in clients which might\nalready have issues communicating with other web servers or other versions of\nApache.\n"}, {"count": 8, "tags": [], "bug_id": 39514, "attachment_id": null, "text": "FWIW, improving this so it'll support byteranges in a wider range of cases \nwithout the DoS attack is on the wishlist for at least some of us.  So it may \nhappen sometime.  But it's not a priority! ", "id": 89031, "time": "2006-05-11T10:37:35Z", "creator": "nick@webthing.com", "creation_time": "2006-05-11T10:37:35Z", "is_private": false}]