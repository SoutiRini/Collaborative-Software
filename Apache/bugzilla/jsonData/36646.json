[{"count": 0, "tags": [], "bug_id": 36646, "attachment_id": null, "text": "(Will attach test code and xls file.) \nWhen running FormulaEvaluator on a cell containing the reference formula\n  ='Sheet 1'!A1\nthe Exception below is seen.  A minimal test file also shows that\nFormulaParser.toFormulaString(...) is also missing the single quotes that exist\nin the formula.  I was not able to identify where the single quotes were being\ndropped (or try to fix it) after many tries with the debugger -- I don't know\nthe internal POI code yet.\n================================\nException in thread \"main\" java.lang.StringIndexOutOfBoundsException: String\nindex out of range: 0\n\tat java.lang.String.charAt(String.java:444)\n\tat org.apache.poi.hssf.util.CellReference.<init>(CellReference.java:44)\n\tat org.apache.poi.hssf.record.formula.ReferencePtg.<init>(ReferencePtg.java:50)\n\tat org.apache.poi.hssf.model.FormulaParser.Ident(FormulaParser.java:292)\n\tat org.apache.poi.hssf.model.FormulaParser.Factor(FormulaParser.java:480)\n\tat org.apache.poi.hssf.model.FormulaParser.Term(FormulaParser.java:569)\n\tat org.apache.poi.hssf.model.FormulaParser.Expression(FormulaParser.java:617)\n\tat org.apache.poi.hssf.model.FormulaParser.parse(FormulaParser.java:721)\n\tat\norg.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.internalEvaluate(HSSFFormulaEvaluator.java:284)\n\tat\norg.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluate(HSSFFormulaEvaluator.java:181)\n\tat com.gametable.poi.Sandbox$Test.main(Sandbox.java:186)\n=======\nWorkaround: I can't think of a reasonable one, unless one has control of the\nspreadsheet generation.", "id": 79899, "time": "2005-09-14T00:32:53Z", "creator": "jbroglio@gametableonline.com", "creation_time": "2005-09-14T00:32:53Z", "is_private": false}, {"count": 1, "attachment_id": 16398, "creator": "jbroglio@gametableonline.com", "text": "Created attachment 16398\nminimal xls test file containg ref. formula with space; Excell 2002 SP1", "id": 79900, "time": "2005-09-14T00:36:31Z", "bug_id": 36646, "creation_time": "2005-09-14T00:36:31Z", "tags": [], "is_private": false}, {"count": 2, "attachment_id": 16399, "creator": "jbroglio@gametableonline.com", "is_private": false, "id": 79901, "time": "2005-09-14T00:41:23Z", "bug_id": 36646, "creation_time": "2005-09-14T00:41:23Z", "tags": [], "text": "Created attachment 16399\nCode that reproduces problem.  In default package."}, {"count": 3, "tags": [], "bug_id": 36646, "attachment_id": null, "text": "Workaround: if you just want to get the cell value, this works for many cases in\n3.0-alpha1:\n//============= code ===================\n    private static String tryAnything(HSSFCell cell)\n    {\n        try{\n            return cell.getNumericCellValue()+\"\";\n        } catch (NumberFormatException e){\n            try{\n                return cell.getStringCellValue();\n            } catch (NumberFormatException f){\n                try{\n                    return cell.getStringCellValue();\n                } catch (NumberFormatException g){\n                    try {\n                    return cell.getDateCellValue()+\"\";\n                    } catch (NumberFormatException h){\n                        // getCellBooleanValue doesn't allow fallthrough to\npre-computed formula\n                        // so presumably you got a 1/0 on getNumericCellValue \n                        // earlier.\n                        return \"Value not available in field.\";\n                    }\n                }\n            }\n\n        }\n    }\n//=============== end of code snippet ============", "id": 79902, "time": "2005-09-14T00:55:52Z", "creator": "jbroglio@gametableonline.com", "creation_time": "2005-09-14T00:55:52Z", "is_private": false}, {"count": 4, "attachment_id": 16407, "creator": "jbroglio@gametableonline.com", "is_private": false, "id": 79962, "time": "2005-09-14T19:19:45Z", "bug_id": 36646, "creation_time": "2005-09-14T19:19:45Z", "tags": [], "text": "Created attachment 16407\nWorkaround code to get value of a formula cell without FormulaEvaluator\n\nWorkaround in bug text was incorrect."}, {"count": 5, "attachment_id": null, "creator": "jheight@apache.org", "text": "Problem was in Ref3DPtg which did not quote the sheet name if it contained a\nstring/Sheetname with a space\n\nFixed in SVN.\n\nJason", "id": 92594, "time": "2006-08-28T03:36:24Z", "bug_id": 36646, "creation_time": "2006-08-28T03:36:24Z", "tags": [], "is_private": false}]