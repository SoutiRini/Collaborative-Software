[{"count": 0, "tags": [], "bug_id": 60830, "text": "The java.text.SimpleDateFormatter class is not thread safe, but jmeter reuses a SimpleDateFormatter instance across threads.  As a result, the saved timestamp is sometimes incorrect.  Here is the stack trace of one of the offending locations: \n\norg.apache.jmeter.save.CSVSaveService.resultToDelimitedString(CSVSaveService.java:868)\norg.apache.jmeter.save.CSVSaveService.resultToDelimitedString(CSVSaveService.java:784)\norg.apache.jmeter.reporters.ResultCollector.sampleOccurred(ResultCollector.java:559)\norg.apache.jmeter.threads.ListenerNotifier.notifyListeners(ListenerNotifier.java:67)\norg.apache.jmeter.threads.JMeterThread.notifyListeners(JMeterThread.java:819)\norg.apache.jmeter.threads.JMeterThread.executeSamplePackage(JMeterThread.java:493)\norg.apache.jmeter.threads.JMeterThread.processSampler(JMeterThread.java:410)\norg.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:241)\njava.lang.Thread.run(Thread.java:745)", "id": 197513, "time": "2017-03-07T19:37:12Z", "creator": "eric.markowitz@prolifics.com", "creation_time": "2017-03-07T19:37:12Z", "is_private": false, "attachment_id": null}, {"count": 1, "text": "(In reply to eric.markowitz from comment #0)\n> The java.text.SimpleDateFormatter class is not thread safe, but jmeter\n> reuses a SimpleDateFormatter instance across threads.  As a result, the\n> saved timestamp is sometimes incorrect.  Here is the stack trace of one of\n> the offending locations: \n> \n> org.apache.jmeter.save.CSVSaveService.resultToDelimitedString(CSVSaveService.\n> java:868)\n> org.apache.jmeter.save.CSVSaveService.resultToDelimitedString(CSVSaveService.\n> java:784)\n> org.apache.jmeter.reporters.ResultCollector.sampleOccurred(ResultCollector.\n> java:559)\n> org.apache.jmeter.threads.ListenerNotifier.notifyListeners(ListenerNotifier.\n> java:67)\n> org.apache.jmeter.threads.JMeterThread.notifyListeners(JMeterThread.java:819)\n> org.apache.jmeter.threads.JMeterThread.executeSamplePackage(JMeterThread.\n> java:493)\n> org.apache.jmeter.threads.JMeterThread.processSampler(JMeterThread.java:410)\n> org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:241)\n> java.lang.Thread.run(Thread.java:745)\n\nHello Eric,\nThanks for report, but where is the SimpleDateFormatter you mention ?\nWhat version of JMeter are you using ?\n\nThanks", "bug_id": 60830, "is_private": false, "id": 197514, "time": "2017-03-07T19:42:52Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2017-03-07T19:42:52Z", "tags": [], "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 60830, "text": "I omitted some stack frames previously.  Here is the full stack:\n\n        at java.text.SimpleDateFormat.format(SimpleDateFormat.java:971)\n        at java.text.SimpleDateFormat.format(SimpleDateFormat.java:935)\n        at java.text.DateFormat.format(DateFormat.java:345)\n        at org.apache.jmeter.save.CSVSaveService.resultToDelimitedString(CSVSaveService.java:868)\n        at org.apache.jmeter.save.CSVSaveService.resultToDelimitedString(CSVSaveService.java:784)\n        at org.apache.jmeter.reporters.ResultCollector.sampleOccurred(ResultCollector.java:559)\n        at org.apache.jmeter.threads.ListenerNotifier.notifyListeners(ListenerNotifier.java:67)\n        at org.apache.jmeter.threads.JMeterThread.notifyListeners(JMeterThread.java:819)\n        at org.apache.jmeter.threads.JMeterThread.executeSamplePackage(JMeterThread.java:493)\n        at org.apache.jmeter.threads.JMeterThread.processSampler(JMeterThread.java:410)\n        at org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:241)\n        at java.lang.Thread.run(Thread.java:745)\n\nI noticed the problem in jmeter version3.", "id": 197515, "attachment_id": null, "creator": "eric.markowitz@prolifics.com", "creation_time": "2017-03-07T19:46:44Z", "time": "2017-03-07T19:46:44Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 60830, "text": "Hi Team,\nCould we use DateTimeFormatter to fix this issue ?\n\nInstanciating a SimpleDateFormat for each call might be overkill.\nUsing ThreadLocal SimpleDateFormat is not simple here", "id": 197517, "attachment_id": null, "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2017-03-07T21:11:49Z", "time": "2017-03-07T21:11:49Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 60830, "is_private": false, "text": "Created attachment 34806\nPatch that does not handle setLenient", "id": 197518, "time": "2017-03-07T22:02:26Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2017-03-07T22:02:26Z", "attachment_id": 34806}, {"count": 5, "tags": [], "bug_id": 60830, "attachment_id": null, "is_private": false, "id": 197549, "time": "2017-03-08T20:40:18Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2017-03-08T20:40:18Z", "text": "*** Bug 60818 has been marked as a duplicate of this bug. ***"}, {"attachment_id": null, "tags": [], "creator": "eric.markowitz@prolifics.com", "is_private": false, "count": 6, "id": 197553, "time": "2017-03-08T22:19:05Z", "bug_id": 60830, "creation_time": "2017-03-08T22:19:05Z", "text": "I don't think Bug 60818 is a duplicate.  Bug 60818 refers to a corruption of the CSV file, while this bug referes to incorrect timestamps written to the CSV file."}, {"count": 7, "tags": [], "bug_id": 60830, "is_private": false, "text": "(In reply to eric.markowitz from comment #6)\n> I don't think Bug 60818 is a duplicate.  Bug 60818 refers to a corruption of\n> the CSV file, while this bug referes to incorrect timestamps written to the\n> CSV file.\n\nHi,\nThe other bug is Invalid in fact. See related discussion.\nBut if there is a corruption, it's in the issue your raised.\n\nRegards", "id": 197554, "time": "2017-03-08T22:21:07Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2017-03-08T22:21:07Z", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 60830, "attachment_id": null, "is_private": false, "id": 197591, "time": "2017-03-10T19:52:22Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2017-03-10T19:52:22Z", "text": "Hi,\nAny feedback on patch ? Or alternative solution ?\n\nI think we need to fix this bug before 3.2 .\nThanks"}, {"attachment_id": null, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "is_private": false, "count": 9, "id": 197787, "time": "2017-03-18T10:13:00Z", "bug_id": 60830, "creation_time": "2017-03-18T10:13:00Z", "text": "Author: pmouawad\nDate: Sat Mar 18 10:12:31 2017\nNew Revision: 1787542\n\nURL: http://svn.apache.org/viewvc?rev=1787542&view=rev\nLog:\nBug 60830 - Timestamps in CSV file could be corrupted due to sharing a SimpleDateFormatter across threads\nBugzilla Id: 60830\n\nModified:\n    jmeter/trunk/src/core/org/apache/jmeter/samplers/SampleSaveConfiguration.java\n    jmeter/trunk/src/core/org/apache/jmeter/save/CSVSaveService.java\n    jmeter/trunk/test/src/org/apache/jmeter/samplers/TestSampleSaveConfiguration.java\n    jmeter/trunk/xdocs/changes.xml"}, {"count": 10, "text": "Author: pmouawad\nDate: Sun Mar 26 20:00:59 2017\nNew Revision: 1788774\n\nURL: http://svn.apache.org/viewvc?rev=1788774&view=rev\nLog:\nBug 60830 Timestamps in CSV file could be corrupted due to sharing a SimpleDateFormatter across threads\nBugzilla Id: 60830\n\nModified:\n    jmeter/trunk/src/core/org/apache/jmeter/samplers/SampleSaveConfiguration.java", "bug_id": 60830, "is_private": false, "id": 197996, "time": "2017-03-26T20:01:37Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2017-03-26T20:01:37Z", "tags": [], "attachment_id": null}]