[{"count": 0, "tags": [], "bug_id": 24273, "attachment_id": null, "id": 46557, "time": "2003-10-31T00:49:28Z", "creator": "potentiallyspam@gmail.com", "creation_time": "2003-10-31T00:49:28Z", "is_private": false, "text": "Here's a little gem that causes BCEL's verifier to crash:\n(Compile the following with the bytecode assembler Jasmin)\n\n.class public Test47\n.super java/lang/Object\n\n.method public foo(B)V\n\t.limit stack 10\n\t.limit locals 10\n\t\n\tiload_1\n\tifne ELSE_0\n\t\tnew java/io/BufferedInputStream\n\t\tgoto ENDIF_0\n\tELSE_0:\n\t\tnew java/io/FilterInputStream\n\tENDIF_0:\n\tpop\n\t\n\treturn\n.end method\n\nThe error generated is as follows:\n\nException in thread \"main\" org.apache.bcel.verifier.exc.AssertionViolatedException: INTERNAL \nERROR: Some RuntimeException occured while verify()ing class 'Test47', method 'public void \nfoo(byte arg1)'. Original RuntimeException's stack trace:\n---\njava.lang.ClassCastException\n        at \norg.apache.bcel.generic.ReferenceType.getFirstCommonSuperclass(ReferenceType.java:256)\n        at org.apache.bcel.verifier.structurals.OperandStack.merge(OperandStack.java:254)\n        at \norg.apache.bcel.verifier.structurals.ControlFlowGraph$InstructionContextImpl.mergeInFrames(Cont\nrolFlowGraph.java:246)\n        at \norg.apache.bcel.verifier.structurals.ControlFlowGraph$InstructionContextImpl.execute(ControlFlow\nGraph.java:189)\n        at org.apache.bcel.verifier.structurals.Pass3bVerifier.circulationPump(Pass3bVerifier.java:228)\n        at org.apache.bcel.verifier.structurals.Pass3bVerifier.do_verify(Pass3bVerifier.java:342)\n        at org.apache.bcel.verifier.PassVerifier.verify(PassVerifier.java:108)\n        at org.apache.bcel.verifier.Verifier.doPass3b(Verifier.java:133)\n        at ClassVerifier.verify(ClassVerifier.java:33)\n        at ClassInfo.verify(ClassInfo.java:51)\n        at Main.main(Main.java:7)\n---\n\n        at org.apache.bcel.verifier.structurals.Pass3bVerifier.do_verify(Pass3bVerifier.java:356)\n        at org.apache.bcel.verifier.PassVerifier.verify(PassVerifier.java:108)\n        at org.apache.bcel.verifier.Verifier.doPass3b(Verifier.java:133)\n        at ClassVerifier.verify(ClassVerifier.java:33)\n        at ClassInfo.verify(ClassInfo.java:51)\n        at Main.main(Main.java:7)\n\nIt appears that ReferenceType.getFirstCommonSuperclass() is not designed to handle the \norg.apache.bcel.verifier.structurals.UninitializedObjectType ReferenceType that is used by BCEL's \nverifier."}, {"count": 1, "tags": [], "bug_id": 24273, "attachment_id": null, "id": 46639, "time": "2003-11-02T19:36:43Z", "creator": "ehaase@inf.fu-berlin.de", "creation_time": "2003-11-02T19:36:43Z", "is_private": false, "text": "\nRight. The UninitializedObjectType was invented to be used internally in JustIce.\nThe idea was not to go out with it and ask BCEL about its superclass. Oh lord."}, {"count": 2, "tags": [], "creator": "tcurdt@apache.org", "attachment_id": null, "id": 86377, "time": "2006-03-02T04:54:01Z", "bug_id": 24273, "creation_time": "2006-03-02T04:54:01Z", "is_private": false, "text": "So why is it exposed is the question then?!"}]