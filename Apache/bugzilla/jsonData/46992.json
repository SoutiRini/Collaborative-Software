[{"count": 0, "tags": [], "text": "Created attachment 23460\nCloneCellStyleFail.xlsx\n\nI run following codes want to copy cell styles from one workbook to other. But when I calling XSSFCellStyle.cloneStyleFrom(...), it failed and always throw exception.\n\n--\n\nXSSFWorkbook source = new XSSFWorkbook(\"CloneCellStyleFail.xlsx\");\nXSSFWorkbook target = new XSSFWorkbook(\"target.xlsx\");\n\nfor(short i=0; i<source.getNumCellStyles(); i++)\n{\n\tXSSFCellStyle cs = target.createCellStyle();\n\tcs.cloneStyleFrom(source.getCellStyleAt(i));\n}\n\n-- \n\nA sample workbook is attached for your testing.", "attachment_id": 23460, "bug_id": 46992, "id": 126073, "time": "2009-04-08T02:13:05Z", "creator": "matthew.knl@gmail.com", "creation_time": "2009-04-08T02:13:05Z", "is_private": false}, {"count": 1, "attachment_id": null, "creator": "junk@bkrodgers.com", "is_private": false, "id": 126598, "time": "2009-04-28T14:56:54Z", "bug_id": 46992, "creation_time": "2009-04-28T14:56:54Z", "tags": [], "text": "I ran into this too.  Looking at the source code for XSSFCellStyle, the method appears to be implemented as follows:\n\n public void cloneStyleFrom(CellStyle source) {\n        if(source instanceof XSSFCellStyle) {\n            this.cloneStyleFrom(source);\n        }\n        throw new IllegalArgumentException(\"Can only clone from one XSSFCellStyle to another, not between HSSFCellStyle and XSSFCellStyle\");\n    }\n\n\nThis causes an endless loop that in turn causes a stack overflow error.  Looking at HSSFCellStyle, it looks like it should be casting it to XXSFCellStyle and passing it to a method \"public void cloneStyleFrom(XSSFCellStyle source)\" to do the actual copy.  It looks like that method hasn't been implemented.\n\nI'm not sure if that's an oversight or if XSSFCellStyle copying is difficult to implement for some reason.  If XSSFCellStyle copying can't be easily implemented for the next beta, I'd suggest that at the very least an UnsupportedOperationException or similar be thrown instead of going into an endless loop."}, {"count": 2, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 126670, "time": "2009-05-01T08:27:57Z", "bug_id": 46992, "creation_time": "2009-05-01T08:27:57Z", "is_private": false, "text": "This was fixed by Yegor in r766755"}]