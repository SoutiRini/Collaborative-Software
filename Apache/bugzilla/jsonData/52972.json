[{"count": 0, "tags": [], "bug_id": 52972, "attachment_id": null, "text": "Currently RichText is lost (converted to normal text) in SXSSF.\nTwo ways to support this were suggested on the mailing list: either maintaining the RichText instances in memory (like styles) or streaming them via a separate file.\nFor my purposes I think in memory would be adequate, but a streaming solution that worked like SXSSF and kept the last n entries in memory would be tunable for different cases.", "id": 155245, "time": "2012-03-22T19:52:23Z", "creator": "jim-apache@spudsoft.co.uk", "creation_time": "2012-03-22T19:52:23Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 52972, "attachment_id": null, "id": 162704, "creation_time": "2012-10-12T01:09:33Z", "time": "2012-10-12T01:09:33Z", "creator": "piczmar@wp.pl", "text": "In addition to this issue RichText is also trimmed if there are leading or trailing spaces.\nThis issue is similar to Bug 48070. Probably it should be treated as separate issue.\n\nI have localized the problem comes from:\norg.apache.poi.xssf.streaming.SheetDataWriter\nIn metod 'writeCell' fragment:\n\n            case Cell.CELL_TYPE_STRING: {\n                _out.write(\" t=\\\"inlineStr\\\">\");\n                _out.write(\"<is><t>\");\n                outputQuotedString(cell.getStringCellValue());\n                _out.write(\"</t></is>\");\n                break;\n            }\na check should be done if value contains leading/trailing spaces and then handled differently:\n\n _out.write(\"<is><t xml:space=\\\"preserve\\\">\"); \ninstead of:\n _out.write(\"<is><t>\");", "is_private": false}, {"count": 2, "tags": [], "creator": "dirk.wilden@iav.de", "attachment_id": null, "id": 162709, "time": "2012-10-12T08:37:48Z", "bug_id": 52972, "creation_time": "2012-10-12T08:37:48Z", "is_private": false, "text": "it is also the same issue with leading/trailing linebreaks (\\n).\nThey are trimmed as well."}, {"count": 3, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "id": 162710, "time": "2012-10-12T09:40:05Z", "bug_id": 52972, "creation_time": "2012-10-12T09:40:05Z", "is_private": false, "text": "A very good catch, thanks!\n\nFixed in r1397499, junit aded.\n\nYegor\n\n(In reply to comment #1)\n> In addition to this issue RichText is also trimmed if there are leading or\n> trailing spaces.\n> This issue is similar to Bug 48070. Probably it should be treated as\n> separate issue.\n> \n> I have localized the problem comes from:\n> org.apache.poi.xssf.streaming.SheetDataWriter\n> In metod 'writeCell' fragment:\n> \n>             case Cell.CELL_TYPE_STRING: {\n>                 _out.write(\" t=\\\"inlineStr\\\">\");\n>                 _out.write(\"<is><t>\");\n>                 outputQuotedString(cell.getStringCellValue());\n>                 _out.write(\"</t></is>\");\n>                 break;\n>             }\n> a check should be done if value contains leading/trailing spaces and then\n> handled differently:\n> \n>  _out.write(\"<is><t xml:space=\\\"preserve\\\">\"); \n> instead of:\n>  _out.write(\"<is><t>\");"}, {"count": 4, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "id": 182022, "time": "2015-03-23T21:00:35Z", "bug_id": 52972, "creation_time": "2015-03-23T21:00:35Z", "is_private": false, "text": "*** Bug 53323 has been marked as a duplicate of this bug. ***"}, {"count": 5, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "id": 200955, "time": "2017-09-19T12:53:32Z", "bug_id": 52972, "creation_time": "2017-09-19T12:53:32Z", "is_private": false, "text": "This is pretty much the same as bug 57294 where a possible implementation was suggested, but is now outdated..."}]