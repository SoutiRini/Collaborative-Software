[{"count": 0, "tags": [], "creator": "esmond.pitt@bigpond.com", "attachment_id": null, "id": 158328, "time": "2012-04-24T03:37:51Z", "bug_id": 53137, "creation_time": "2012-04-24T03:37:51Z", "is_private": false, "text": "The org.apache.jk.config.ApacheConfig class assumes that the value of the jkLog parameter is a filename, and attempts to validate it by constructing a File object.\n\nHowever the Apache HTTPD which uses the output of this class also allows a pipe syntax which allows for rolling log files, e.g. JkLogFile=\"|bin/rotatelogs.exe logs/mod_jk.%Y-%m-%d.log 86400\".\n\nSo the ApacheConfig class prevents the use of this valuable feature. It should do one of two things:\n\n1. Not check directory existence if the pipe \"|\" syntax is present\n\nor better still:\n\n2. Not check directory existence *at all*. Tomcat doesn't need the directory to exist. It is Apache HTTPD that needs the logfile directory to exist, not Tomcat, and failures in the Apache HTTPD configuration should be detected and logged by Apache HTTPD, not by Tomcat. Note that if Tomcat detects the pipe syntax it doesn't presently log the error at all, it just displays it on the very transient startup screen. This is not really much use.\n\nThe server.xml required to produce this problem is as follows:\n\n  <Listener\n\tclassName=\"org.apache.jk.config.ApacheConfig\"\n\tconfigHome=\"C:/Program Files (x86)/Apache Software Foundation/Apache2.2/\"\n\tmodJk=\"modules/mod_jk.so\"\n\tjkWorker=\"ajp13\"\n\tjkLog=\"|bin/rotatelogs.exe logs/mod_jk.%Y-%m-%d.log 86400\"\n\tjkDebug=\"info\"\n\t/>\n\nThe console output is as follows:\n\njava.lang.reflect.InvocationTargetException\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.\njava:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces\nsorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)\nCaused by: java.lang.RuntimeException: Unable to create path to config file :C:\\\nProgram Files (x86)\\Apache Software Foundation\\Apache2.2\\|bin\\rotatelogs.exe log\ns\\mod_jk.%Y-%m-%d.log 86400\n        at org.apache.jk.config.BaseJkConfig.getConfigFile(BaseJkConfig.java:429\n)\n        at org.apache.jk.config.ApacheConfig.initProperties(ApacheConfig.java:23\n7)\n        at org.apache.jk.config.BaseJkConfig.execute(BaseJkConfig.java:134)\n        at org.apache.jk.config.BaseJkConfig.lifecycleEvent(BaseJkConfig.java:12\n5)\n        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(Lifecycl\neSupport.java:119)\n        at org.apache.catalina.core.StandardServer.start(StandardServer.java:703\n)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:581)\n        ... 6 more"}, {"count": 1, "tags": [], "creator": "billbarker@apache.org", "attachment_id": null, "id": 158329, "time": "2012-04-24T04:11:31Z", "bug_id": 53137, "creation_time": "2012-04-24T04:11:31Z", "is_private": false, "text": "Don't have karma to change status, but ApacheConfig is deprecated for versions higher that 5.5.  It has been removed from later versions all together. So someone with karma should mark this as WONTFIX."}, {"count": 2, "tags": [], "bug_id": 53137, "attachment_id": null, "id": 158362, "time": "2012-04-24T06:23:30Z", "creator": "chuck.caldarale@unisys.com", "creation_time": "2012-04-24T06:23:30Z", "is_private": false, "text": "(In reply to comment #1)\n> Don't have karma to change status, but ApacheConfig is deprecated for versions\n> higher that 5.5.  It has been removed from later versions all together. So\n> someone with karma should mark this as WONTFIX.\n\nDone."}]