[{"count": 0, "tags": [], "bug_id": 8005, "text": "Consider:\n\n<jsp:include page=\"header.jsp\" flush=\"true\">\n<jsp:param name=\"title\" value=\"<%= title %>\" />\n</jsp:include>\n\nIf title is \"Tom & Jerry\" it will not be passed correctly to the header.jsp.\nLooking at the tmp java file that this jsp is converted into before being\ncompilied, I see something like:\n\n{\nString _jspx_qStr = \"\";\n_jspx_qStr = _jspx_qStr + \"?title=\" +  title ;\nJspRuntimeLibrary.include(request, response, \"header.jsp\" + _jspx_qStr, out, true); \n}\n\nThe problem should be obvious now. Parameter values are _not_ being encoded\nbefore constructing the query string to be passed to the included jsp. This\nmeans that any value containing an ampersand will get mangled.\n\nAlso, from what I can tell, the same problem applies if the parameter value is\nhardcoded. i.e.\n\n<jsp:include page=\"header.jsp\" flush=\"true\">\n<jsp:param name=\"title\" value=\"Tom &amp; Jerry\" />\n</jsp:include>\n\nThe JSP 1.2 spec claims that these \"Standard Actions\" are XML. Which means that\n\"Tom &amp; Jerry\" should be legal.  The spec has little to say about encoding\nfor parameters specified as expressions though. Also, if this case I would\nexpect \"Tom & Jerry\" to be received by the called jsp. i.e. the parser should\nsee \"Tom &amp; Jerry\" and decode it to unicode (whatever) and pass that.\n\nThere is a also a security aspect to this bug. If an attacker can control a \nparameter value that is explicitly passed by a jsp to another jsp, they would be\nable to override any request parameters that may have been added directly by the\nappliction. (i.e. request parameters added to the request object via jsp:include\ncalls, not request parameters submitted as part of a HTTP POST/GET operation).\nJust ask if you need more explaination.", "id": 13332, "time": "2002-04-12T08:31:15Z", "creator": "simon@gx.nl", "creation_time": "2002-04-12T08:31:15Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 8005, "attachment_id": null, "text": "Fixed in jasper2.", "id": 15592, "time": "2002-05-07T00:06:09Z", "creator": "kin-man.chung@sun.com", "creation_time": "2002-05-07T00:06:09Z", "is_private": false}]