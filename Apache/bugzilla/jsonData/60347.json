[{"count": 0, "tags": [], "bug_id": 60347, "attachment_id": null, "text": "I have a password protected worksheet create with excel 95,97-2003\n\ni have the password and i was trying to read this file in different ways\n\nMethod 1:\n\nWorkbookFactory.create(inputStream, \"password\");\nthrows:  org.apache.poi.EncryptedDocumentException: HSSF does not currently support CryptoAPI encryption\nMethod 2:\n\n    protected InputStream WorkbookProtectionUnlocker(NPOIFSFileSystem fs, String password) throws AAAAException {\n\n    EncryptionInfo info;\n    try {\n        info = new EncryptionInfo(fs.getRoot());\n    } catch (IOException e) {\n        throw new AAAException(e.getCause());\n    }\n\n    Decryptor d = Decryptor.getInstance(info);\norg.apache.poi.EncryptedDocumentException: HSSF does not currently support CryptoAPI encryption\n\nalso throw the same exception\n\nMethod 3:\n\norg.apache.poi.hssf.record.crypto.Biff8EncryptionKey.setCurrentUserPassword(\"password\");\n\nWorkbook wb = new HSSFWorkbook(new FileInputStream(file);\nsame exception .\n\nMethod 4:\n\nread about jxl.Workbook.getWorkbook but in this object the password is only allowed setting it to the sheet not the entire worksheet .\n\nthrow this error: jxl.read.biff.PasswordException\n\nsince its not possible setting the password to the worksheet .\n\nmethod 5\n\norg.apache.poi.hssf.record.crypto.Biff8EncryptionKey.setCurrentUserPassword(fileInfo.getFileOptions().xlsWorkbookPasswordExpression);\n                            WorkbookFactory.create(new FileInputStream(fileInfo.getInputFile()));\nthe same exception:\n\n    org.apache.poi.EncryptedDocumentException: HSSF does not currently support CryptoAPI encryption\nwhat is the correct way of Opening HSSF workbook which is password protected ?", "id": 194841, "time": "2016-11-06T15:33:57Z", "creator": "barak.kedem@datorama.com", "creation_time": "2016-11-06T15:33:57Z", "is_private": false}, {"count": 1, "tags": [], "text": "Can you try with a nightly? ... I have added CryptoAPI support just recently.\nIf this fails, could you send me the file on my apache email?", "is_private": false, "id": 194842, "creation_time": "2016-11-06T16:11:54Z", "time": "2016-11-06T16:11:54Z", "creator": "kiwiwings@apache.org", "bug_id": 60347, "attachment_id": null}, {"count": 2, "tags": [], "text": "Created attachment 34424\nExcel file with password\n\npassword is 12345", "attachment_id": 34424, "bug_id": 60347, "id": 194843, "time": "2016-11-06T16:26:47Z", "creator": "barak.kedem@datorama.com", "creation_time": "2016-11-06T16:26:47Z", "is_private": false}, {"count": 3, "tags": [], "creator": "barak.kedem@datorama.com", "attachment_id": 34425, "id": 194844, "time": "2016-11-06T16:27:27Z", "bug_id": 60347, "creation_time": "2016-11-06T16:27:27Z", "is_private": false, "text": "Created attachment 34425\nExcel file 95 with password\n\npassword is 12345"}, {"count": 4, "tags": [], "text": "The \"Excel file 95\" is in Biff5 format, which is not supported by the HSSF classes - although there's an OldExcelExtractor class, I haven't implemented the crypto logic there.\nThe other excel file opens just fine:\n\nBiff8EncryptionKey.setCurrentUserPassword(\"12345\");\nHSSFWorkbook wb = new HSSFWorkbook(new FileInputStream(\"Canada - 97-2003 Pass.xls\"));\n\n\nWith \"nightly\" I meant a development build:\nhttps://builds.apache.org/job/POI/lastSuccessfulBuild/artifact/build/dist/", "attachment_id": null, "id": 194845, "creation_time": "2016-11-06T16:41:24Z", "time": "2016-11-06T16:41:24Z", "creator": "kiwiwings@apache.org", "bug_id": 60347, "is_private": false}]