[{"attachment_id": null, "tags": [], "creator": "stephen.jackson@nielsenmedia.com", "is_private": false, "count": 0, "id": 33489, "time": "2003-03-19T20:20:02Z", "bug_id": 18161, "creation_time": "2003-03-19T20:20:02Z", "text": "A 3rd party vendor is assigning a cookie to the request and \n\n\norg.apache.coyote.tomcat4.CoyoteResponseFacade\n\n\nis throwing the exception below.\n\n\n\n\nAs an \"on the fly\" fix I modified the maybeQuote to the following and it now is \nworking correctly.\n\n\n\n\n    public static void maybeQuote (int version, StringBuffer buf,\n\n\n                                    String value)\n\n\n    {\n\n\n\t// special case - a \\n or \\r  shouldn't happen in any case\n\n\n\tif ( isToken (value))\n\n\n\t  buf.append (value);\n\n\n\telse {\n\n\n\t  //  if(version==0)\n\n\n\t//\tthrow new IllegalArgumentException( value );\n\n\n\t //   else {\n\n\n\t\tbuf.append ('\"');\n\n\n\t\tbuf.append (value);\n\n\n\t\tbuf.append ('\"');\n\n\n\t //   }\n\n\n\t}\n\n\n    }\n\n\n\n\n    // log\n\n\n    static final int dbg=1;\n\n\n    public static void log(String s ) {\n\n\n\tSystem.out.println(\"ServerCookie: \" + s);\n\n\n    }\n\n\n\n\n}\n\n\n\n\n\n\njava.lang.IllegalArgumentException: 0111111English&m%2Fd%2Fyy&%2E&,&,\n\n\nat\n\n\norg.apache.tomcat.util.http.ServerCookie.maybeQuote(ServerCookie.java:315)\n\n\nat\n\n\norg.apache.tomcat.util.http.ServerCookie.appendCookieValue(ServerCookie.java\n\n\n:248)\n\n\nat\n\n\norg.apache.coyote.tomcat4.CoyoteResponse.addCookie(CoyoteResponse.java:864)\n\n\nat\n\n\norg.apache.coyote.tomcat4.CoyoteResponseFacade.addCookie(CoyoteResponseFacad\n\n\ne.java:278)"}, {"count": 1, "tags": [], "bug_id": 18161, "is_private": false, "text": "marking as dup of 15576\n\n*** This bug has been marked as a duplicate of 15576 ***", "id": 35551, "time": "2003-04-18T14:58:37Z", "creator": "funkman@joedog.org", "creation_time": "2003-04-18T14:58:37Z", "attachment_id": null}]