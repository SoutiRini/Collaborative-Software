[{"count": 0, "tags": [], "creator": "jakarta@trollingers.com", "text": "I have applied the 5.0 patch for this into 4.1.12 and it still does not work.\nIf I have two browsers try and load the same uncompiled jsp at the same time \none gets a null pointer exception.\n\nI think it might happen before the compile where the second page deletes \nthe .java file at the same time the first page trys to compile it but not sure.", "id": 24473, "time": "2002-10-14T15:01:59Z", "bug_id": 13606, "creation_time": "2002-10-14T15:01:59Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "is_private": false, "id": 24474, "time": "2002-10-14T15:11:01Z", "bug_id": 13606, "creation_time": "2002-10-14T15:11:01Z", "text": "As with many of your bug reports, there's simply not enough information to be\nable to reproduce them. You seem to assume that people reading them have access\nto your  computer.\nI also have no idea what is the \"5.0 patch for this\". Please be specific."}, {"count": 2, "tags": [], "bug_id": 13606, "attachment_id": null, "id": 24486, "time": "2002-10-14T17:51:10Z", "creator": "jakarta@trollingers.com", "creation_time": "2002-10-14T17:51:10Z", "is_private": false, "text": "Ok.. I will be as descriptive as I can.\n\nI have a jsp page lets call it a.jsp\n\nI have two browser windows try and access a.jsp at the same time.  If a.jsp has \nchanged since last compile time or a.jsp has not been compiled then one browser \nwindow will get a NPE and the other will load the jsp page fine.  This shows up \nmore on a dual processor system then on a single.  I have added the code from \ntomcat 5 o.a.j.c.Compiler to 4.1.12 that syncronizes the javac.execute() call \n\ntry {\n   synchronized(javacLock) {\n      javac.execute();\n   }\n} catch (BuildException e) {\n   success = false;\n}\n\nI believe what is happening is the first call to a.jsp starts to create \nthe .java file, the second call then sees this .java file and attempts to \ncompile it before the .java file is finished being generated or something like \nthat.  I have been unable to create a test outside of our application that has \nthis behavior on a regular basis, but our application can reproduce it \nconsistantly as its pages take a lot longer to compile.\n\nhere is the stacktrace that it creates\n\n2002-10-14 10:55:34 ApplicationDispatcher[] Servlet.service() for servlet jsp \nthrew exception\norg.apache.jasper.JasperException\n\tat org.apache.jasper.servlet.JspServletWrapper.service\n(JspServletWrapper.java:248)\n\tat org.apache.jasper.servlet.JspServlet.serviceJspFile\n(JspServlet.java:289)\n\tat org.apache.jasper.servlet.JspServlet.service(JspServlet.java:240)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat org.apache.catalina.core.ApplicationDispatcher.invoke\n(ApplicationDispatcher.java:684)\n\tat org.apache.catalina.core.ApplicationDispatcher.doForward\n(ApplicationDispatcher.java:432)\n\tat org.apache.catalina.core.ApplicationDispatcher.forward\n(ApplicationDispatcher.java:356)\n\tat com.controlj.green.web.servlets.NavigationMapperServlet.doGet\n(NavigationMapperServlet.java:175)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:740)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java:247)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java:193)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke\n(StandardWrapperValve.java:260)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardContextValve.invoke\n(StandardContextValve.java:191)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke\n(AuthenticatorBase.java:471)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:641)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardContext.invoke\n(StandardContext.java:2396)\n\tat org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:180)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.valves.ErrorDispatcherValve.invoke\n(ErrorDispatcherValve.java:170)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:641)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke\n(ErrorReportValve.java:172)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:641)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:174)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.connector.http.HttpProcessor.process\n(HttpProcessor.java:1040)\n\tat org.apache.catalina.connector.http.HttpProcessor.run\n(HttpProcessor.java:1151)\n\tat java.lang.Thread.run(Thread.java:536)\n----- Root Cause -----\njava.lang.NullPointerException\n\tat org.apache.jasper.servlet.JspServletWrapper.service\n(JspServletWrapper.java:204)\n\tat org.apache.jasper.servlet.JspServlet.serviceJspFile\n(JspServlet.java:289)\n\tat org.apache.jasper.servlet.JspServlet.service(JspServlet.java:240)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat org.apache.catalina.core.ApplicationDispatcher.invoke\n(ApplicationDispatcher.java:684)\n\tat org.apache.catalina.core.ApplicationDispatcher.doForward\n(ApplicationDispatcher.java:432)\n\tat org.apache.catalina.core.ApplicationDispatcher.forward\n(ApplicationDispatcher.java:356)\n\tat com.controlj.green.web.servlets.NavigationMapperServlet.doGet\n(NavigationMapperServlet.java:175)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:740)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java:247)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java:193)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke\n(StandardWrapperValve.java:260)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardContextValve.invoke\n(StandardContextValve.java:191)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke\n(AuthenticatorBase.java:471)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:641)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardContext.invoke\n(StandardContext.java:2396)\n\tat org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:180)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.valves.ErrorDispatcherValve.invoke\n(ErrorDispatcherValve.java:170)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:641)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke\n(ErrorReportValve.java:172)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:641)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:174)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.connector.http.HttpProcessor.process\n(HttpProcessor.java:1040)\n\tat org.apache.catalina.connector.http.HttpProcessor.run\n(HttpProcessor.java:1151)\n\tat java.lang.Thread.run(Thread.java:536)\n\n\nif you need more information short of access to my computer please just ask.\n\n\n\n"}, {"count": 3, "tags": [], "creator": "remm@apache.org", "text": "The sync on javac.execute is useless in that case, as there's already an\nequivalent syncing made on javac.compile.\nI'll try to reproduce the bug using a frameset.", "id": 24539, "attachment_id": null, "bug_id": 13606, "creation_time": "2002-10-15T08:56:02Z", "time": "2002-10-15T08:56:02Z", "is_private": false}, {"count": 4, "tags": [], "creator": "jakarta@trollingers.com", "attachment_id": null, "is_private": false, "id": 24545, "time": "2002-10-15T12:20:51Z", "bug_id": 13606, "creation_time": "2002-10-15T12:20:51Z", "text": "I believe to key to recreating this is to have a jsp page that takes a while to \ncompile.  I am trying to make one that will recreate it most of the time (I \nhave recreated it outside of our application, but only one out of every 60 or \nso tries).  I hope to be able to send a test case this afternoon."}, {"count": 5, "tags": [], "creator": "markt@apache.org", "is_private": false, "id": 51555, "attachment_id": null, "bug_id": 13606, "creation_time": "2004-02-01T21:53:40Z", "time": "2004-02-01T21:53:40Z", "text": "John, did you manage to produce a simple test case for this?\n\nCommitters, does anyone know if this is a valid bug that has since been fixed?\n\nI'll leave this open for now, but if a valid test case is not forthcoming I \nwill close it."}, {"count": 6, "tags": [], "creator": "markt@apache.org", "text": "\n\n*** This bug has been marked as a duplicate of 16449 ***", "id": 71803, "time": "2005-03-03T23:47:20Z", "bug_id": 13606, "creation_time": "2005-03-03T23:47:20Z", "is_private": false, "attachment_id": null}]