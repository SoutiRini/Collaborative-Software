[{"count": 0, "tags": [], "creator": "tallison@mitre.org", "attachment_id": null, "id": 176764, "time": "2014-07-30T11:07:20Z", "bug_id": 56792, "creation_time": "2014-07-30T11:07:20Z", "is_private": false, "text": "The embedded OLE objects in this document (http://digitalcorpora.org/corp/nps/files/govdocs1/268/268620.pptx) are extracted without a problem in 3.10-beta2. However, I'm getting the following stacktrace with 3.10-FINAL:\n\n\nStacktrace:\nCaused by: java.lang.StringIndexOutOfBoundsException: String index out of range: -369073454\n\tat java.lang.String.checkBounds(String.java:371)\n\tat java.lang.String.<init>(String.java:415)\n\tat org.apache.poi.util.StringUtil.getFromCompressedUnicode(StringUtil.java:114)\n\tat org.apache.poi.poifs.filesystem.Ole10Native.<init>(Ole10Native.java:163)\n\tat org.apache.poi.poifs.filesystem.Ole10Native.createFromEmbeddedOleObject(Ole10Native.java:91)\n\tat org.apache.poi.poifs.filesystem.Ole10Native.createFromEmbeddedOleObject(Ole10Native.java:63)\n\tat org.apache.tika.parser.microsoft.ooxml.AbstractOOXMLExtractor.handleEmbeddedOLE(AbstractOOXMLExtractor.java:250)\n\tat org.apache.tika.parser.microsoft.ooxml.AbstractOOXMLExtractor.handleEmbeddedParts(AbstractOOXMLExtractor.java:199)\n\tat org.apache.tika.parser.microsoft.ooxml.AbstractOOXMLExtractor.getXHTML(AbstractOOXMLExtractor.java:115)\n\tat org.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:112)\n\tat org.apache.tika.parser.microsoft.ooxml.OOXMLParser.parse(OOXMLParser.java:82)\n\tat org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:243)\n\n\nI haven't had a chance to confirm, but given the release dates and the modifications to the header parsing, r1531623 (\"Bugzilla 55578 - Support embedding OLE1.0 packages in HSSF\" (http://svn.apache.org/viewvc/poi/trunk/src/java/org/apache/poi/poifs/filesystem/Ole10Native.java?annotate=1531623) may be the cause."}, {"count": 1, "tags": [], "bug_id": 56792, "attachment_id": null, "text": "Do you know what the license is on that test file? i.e. whether we can add it as a test document or not?", "id": 176766, "time": "2014-07-30T11:52:53Z", "creator": "apache@gagravarr.org", "creation_time": "2014-07-30T11:52:53Z", "is_private": false}, {"count": 2, "tags": [], "creator": "apache@gagravarr.org", "text": "Also, any chance you could retest with a recent nightly build of POI - the line in your stacktrace in Ole10Native doesn't match on trunk so it is possible the problem has already been fixed", "id": 176767, "time": "2014-07-30T11:56:15Z", "bug_id": 56792, "creation_time": "2014-07-30T11:56:15Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "tallison@mitre.org", "text": "Unfortunately, I don't believe that we can add it as ASF 2.0. According to Simson Garfinkel, the creator of govdocs1, the documents are hostable and redistributable, in personal communication and this site (http://digitalcorpora.org/corpora/files)\n\"For these reasons, we have created and released a corpus of 1 million documents that are freely available for research and may be (to the best of our knowledge) freely redistributed. \" \n\nI think ASF is more stringent (release of copyright, etc.)", "id": 176768, "time": "2014-07-30T11:57:45Z", "bug_id": 56792, "creation_time": "2014-07-30T11:57:45Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 56792, "attachment_id": null, "text": "Note to self: check trunk, then submit issue; check trunk, then submit issue.  \n\nTrunk seems to work.\n\nThe following code fails in poi-3_10_FINAL (with the appropriate stacktrace), but works in poi-3_10_BETA2 and works in trunk.\n\n    public void testOleNativeGovdocs1() throws IOException, Ole10NativeException {\n        for (int i = 3; i <=5; i++){\n            String fName = \"oleObject\"+i+\"-govdocs1-268620.bin\";\n            InputStream is = dataSamples.openResourceAsStream(fName);\n            POIFSFileSystem fs = new POIFSFileSystem(is);\n\n            Ole10Native ole = Ole10Native.createFromEmbeddedOleObject(fs);\n            is.close();\n\n        }\n    }", "id": 176771, "time": "2014-07-30T13:01:39Z", "creator": "tallison@mitre.org", "creation_time": "2014-07-30T13:01:39Z", "is_private": false}]