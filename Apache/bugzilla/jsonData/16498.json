[{"count": 0, "tags": [], "creator": "apche_bug@spininhetweb.nl", "attachment_id": null, "is_private": false, "id": 30179, "time": "2003-01-28T16:47:51Z", "bug_id": 16498, "creation_time": "2003-01-28T16:47:51Z", "text": "This looks a bit like bug # 7666 (closed)\n\nWhen you use <--#include virtual=\"blah.cgi\" --> in an ssi page, \nand apache runs a cgi-wrapper instead of the default cgi-script handler, the \nContent-length header of the rendered page will be set to the content length \nof the output of the script that was included + the length of the static \ncontent in the shtml file *up to* the include virtual element.\n\nSo browsers that use the Content-length header truncate the output after the \noutput of the script. This is even more severe when you include more than one \ncgi in the above way. The Content-length will still be the output length of \nthe *first* script + static content before that one. It looks like this is \nanother or the same problem with timing of the filter as bug 7666??\n\nReproduce:\n\n1. I use Redhat 8.0, standard install, httpd now 2.0.40-11. (I tried to \ninstall 2.0.43 thru an rpm, but this did not work because of dependencies).\n\n2. Create a fake cgi-wrapper, that does nothing but run the script. I'll \nattach a file called testwrap, in perl code. It runs the script and logs the \nsize in bytes to a file in /tmp. Asume this is \nin /usr/local/testwrapper/testwrap and executable for apache.\n\n3. Make sure Includes are used, I used this globaly in httpd.conf:\nAddType text/html .shtml .shtm\nAddOutputFilter INCLUDES .shtm .shtml .htm .html\nOptions +Includes\nAcceptPathInfo On\n\n4. Make sure all .cgi gets handled by the testwrap script from step 2. I used \nthis in a virtual host:\n\nScriptAlias /testwrapper/ /usr/local/testwrapper/\nAddHandler test_wrapper .cgi .pl\nAction test_wrapper /testwrapper/testwrap\n\n5. Reload the server etc.\n\n6. In the documentroot of the virtual host, I created a test.shtml, test1.cgi \nand test2.cgi. test.shtml does an include virtual of test1.cgi (that outputs a \nheader + 100 bytes) and test2.cgi (header + 500 bytes). All files readable and \nthe cgi scripts executable for apache.\n\n7. Internet explorer en netscape only show the page up to and including the \nfirst script. wget -O - (url) will show that the content-length header is \nwrong, but will still get the whole file, showing that everything runs fine.\n\nI hope I just did something wrong, in which case my appologies."}, {"count": 1, "tags": [], "bug_id": 16498, "text": "Created attachment 4588\ntestwrap file (see description)", "id": 30180, "time": "2003-01-28T16:50:38Z", "creator": "apche_bug@spininhetweb.nl", "creation_time": "2003-01-28T16:50:38Z", "is_private": false, "attachment_id": 4588}, {"count": 2, "tags": [], "bug_id": 16498, "text": "Created attachment 4589\ntest.shtml file (see description)", "id": 30181, "time": "2003-01-28T16:52:06Z", "creator": "apche_bug@spininhetweb.nl", "creation_time": "2003-01-28T16:52:06Z", "is_private": false, "attachment_id": 4589}, {"count": 3, "tags": [], "creator": "apche_bug@spininhetweb.nl", "attachment_id": 4590, "is_private": false, "id": 30182, "time": "2003-01-28T16:56:16Z", "bug_id": 16498, "creation_time": "2003-01-28T16:56:16Z", "text": "Created attachment 4590\ntest1.cgi (see bug description)"}, {"count": 4, "tags": [], "text": "Created attachment 4591\ntest2.cgi (see bug description)", "attachment_id": 4591, "bug_id": 16498, "id": 30183, "time": "2003-01-28T16:56:45Z", "creator": "apche_bug@spininhetweb.nl", "creation_time": "2003-01-28T16:56:45Z", "is_private": false}, {"count": 5, "tags": [], "text": "I understand you have a problem with upgrading, but it is unlikely that\nApache developers are going to want to work on a problem with a release\nthat is several versions out of date.\n\nIf you can't upgrade for some Redhat-related reason, you may want to report this\nin Redhat's bug tracking database.", "attachment_id": null, "bug_id": 16498, "id": 30186, "time": "2003-01-28T17:39:28Z", "creator": "slive@apache.org", "creation_time": "2003-01-28T17:39:28Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 16498, "attachment_id": null, "id": 30187, "time": "2003-01-28T17:50:19Z", "creator": "apche_bug@spininhetweb.nl", "creation_time": "2003-01-28T17:50:19Z", "is_private": false, "text": "Well, I d\u00edd check the changelogs from 2.0.40 up to see if something like this \nwas fixed.... I did not find it. Maybe someone could at least tell wether this \nwas fixed or not?\n\nFor the rest, this is my testserver, so I could do without this for a while. \nJust trying to be helpful..."}, {"count": 7, "tags": [], "bug_id": 16498, "text": "There were several rixes related to the content-length filter.  I would think\nthat it should be just getting out of the way and not returning a content-length\nin this case.  But I can't say for sure whether this problem was fixed.\n\nThe easiest way is to try.", "id": 30205, "time": "2003-01-28T21:29:15Z", "creator": "slive@apache.org", "creation_time": "2003-01-28T21:29:15Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "creator": "apche_bug@spininhetweb.nl", "is_private": false, "text": "This bug seems to be sort-of fixed in 2.0.44, but problems still exists in the \nway the cgi-output is included. See my new bug report 16673.", "id": 30508, "time": "2003-02-02T12:47:30Z", "bug_id": 16498, "creation_time": "2003-02-02T12:47:30Z", "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 16498, "text": "Mark this as fixed.  Further tracking in bug 16673.", "id": 30594, "time": "2003-02-03T20:56:42Z", "creator": "slive@apache.org", "creation_time": "2003-02-03T20:56:42Z", "is_private": false, "attachment_id": null}]