[{"count": 0, "attachment_id": null, "creator": "alex@alex.org.uk", "is_private": false, "id": 177614, "time": "2014-09-08T10:34:29Z", "bug_id": 56926, "creation_time": "2014-09-08T10:34:29Z", "tags": [], "text": "On upgrading from apache 2.4.7 to 2.4.10 (to avoid BZ56919) I get a new issue where Apache fails to start. This appears to be due to the configuration filename (yes, really).\n\nOn starting apache2 I see\n\n[Mon Sep 08 10:18:03.434505 2014] [ssl:info] [pid 49020] AH01887: Init: Initializing (virtual) servers for SSL\n[Mon Sep 08 10:18:03.438805 2014] [ssl:info] [pid 49020] AH01876: mod_ssl/2.4.10 compiled against Server: Apache/2.4.10, Library: OpenSSL/1.0.1f\n[Mon Sep 08 10:18:03.467802 2014] [slotmem_shm:debug] [pid 49021] mod_slotmem_shm.c(334): AH02602: create didn't find /var/run/apache2/slotmem-shm-pf0144ffa.shm in global list\n[Mon Sep 08 10:18:03.467811 2014] [slotmem_shm:debug] [pid 49021] mod_slotmem_shm.c(344): AH02300: create /var/run/apache2/slotmem-shm-pf0144ffa.shm: 544/7\n[Mon Sep 08 10:18:03.467862 2014] [slotmem_shm:debug] [pid 49021] mod_slotmem_shm.c(353): AH02598: apr_shm_attach() succeeded\n[Mon Sep 08 10:18:03.467904 2014] [proxy:debug] [pid 49021] proxy_util.c(1243): AH02337: re-using shm[0] (0x7f981cacf018) for balancer://rest\n[Mon Sep 08 10:18:03.467929 2014] [slotmem_shm:debug] [pid 49021] mod_slotmem_shm.c(334): AH02602: create didn't find /var/run/apache2/slotmem-shm-pf0144ffa_rest.shm in global list\n[Mon Sep 08 10:18:03.467933 2014] [slotmem_shm:debug] [pid 49021] mod_slotmem_shm.c(344): AH02300: create /var/run/apache2/slotmem-shm-pf0144ffa_rest.shm: 608/1\n[Mon Sep 08 10:18:03.467952 2014] [slotmem_shm:debug] [pid 49021] mod_slotmem_shm.c(353): AH02598: apr_shm_attach() succeeded\n[Mon Sep 08 10:18:03.467963 2014] [slotmem_shm:error] [pid 49021] AH02599: existing shared memory for /var/run/apache2/slotmem-shm-pf0144ffa_rest.shm could not be used (failed size check)\n[Mon Sep 08 10:18:03.467977 2014] [:emerg] [pid 49021] AH00020: Configuration Failed, exiting\n\nHowever, if the config file referring to balancer://rest is renamed from\n  /etc/apache2/sites-enabled/extility-skyline-cp-f1e48937-f534-39a7-80d6-7f9b7f790dc1.conf\nto\n  /etc/apache2/sites-enabled/extility-skyline-cp-f1e48937-f534-39a7-80d6-7f9b7f790dc.conf\nor\n  /etc/apache2/sites-enabled/extility-skyline-cp-f1e48937-f534-39a7-80d6-7f9b7f790dc1X.conf\nor\n  /etc/apache2/sites-enabled/extility-skyline-cp-f1e48937-f534-39a7-80d6-7f9b7f790dc2.conf\nor indeed anything else it would seem, it works.\n\nThese are automatically generated filenames (as you can see they include a UUID). I have other files config files in the directory ending with that UUID but renaming them does not seem to permit the original name to be used.\n\nThis looks vaguely similar to\n  https://issues.apache.org/bugzilla/show_bug.cgi?id=55449\nsave that I've only got one instance of apache2, and there's only one balancer. This looks a bit like a hash collision on producing the slotmem shm filename or something (perhaps).\n\nThis must be one of the stranger apache bugs I've seen. Any clues on debugging it further?"}, {"count": 1, "tags": [], "creator": "alex@alex.org.uk", "attachment_id": 31974, "is_private": false, "id": 177621, "time": "2014-09-08T11:03:51Z", "bug_id": 56926, "creation_time": "2014-09-08T11:03:51Z", "text": "Created attachment 31974\nconfig file causing the issue"}, {"count": 2, "tags": [], "creator": "alex@alex.org.uk", "attachment_id": null, "text": "This is pretty fragile. It's completely reproducible for me with the attached config (commenting out the Include lines did not make a difference), but deleting the blank line on line 4 fixes it. Yes, very odd.", "id": 177622, "time": "2014-09-08T11:04:27Z", "bug_id": 56926, "creation_time": "2014-09-08T11:04:27Z", "is_private": false}]