[{"count": 0, "tags": [], "creator": "mangst@inventec.ch", "attachment_id": null, "id": 109175, "time": "2007-10-09T13:30:53Z", "bug_id": 43581, "creation_time": "2007-10-09T13:30:53Z", "is_private": false, "text": "In the file webapp/lenya/config/cocoon-xconf/scheduler/datasources.xconf the\nwhole node /cocoon/datasources is removed: 'remove=\"/cocoon/datasources\"' on\nline 23. This leads to the nasty effect that all datasources which have been\ndefined earlier during the build process (for example a datasource defined in a\npublication) are deleted."}, {"attachment_id": 20947, "tags": [], "bug_id": 43581, "text": "Created attachment 20947\nThis patch fixes the bug.", "count": 1, "id": 109176, "time": "2007-10-09T13:32:17Z", "creator": "mangst@inventec.ch", "creation_time": "2007-10-09T13:32:17Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 43581, "attachment_id": null, "id": 109225, "time": "2007-10-11T02:45:33Z", "creator": "nettings@apache.org", "creation_time": "2007-10-11T02:45:33Z", "is_private": false, "text": "looks good. but who takes care of adding a <datasources/> element to\ncocoon.xconf if it isn't already there? can we rely on some other global\npatchfile to do that?\nif not, i fear the patch might fail on a clean build... \nsorry can't test it myself atm. markus, can you comment? if you're sure there's\nno problem, i'll try and commit your patch tonight.\n"}, {"count": 3, "tags": [], "bug_id": 43581, "attachment_id": null, "text": "I will have another look at it and post my findings.", "id": 109247, "time": "2007-10-11T06:48:06Z", "creator": "mangst@inventec.ch", "creation_time": "2007-10-11T06:48:06Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 43581, "attachment_id": null, "text": "Thanks. I think you are right. ATM there is a datasource belonging to a Cocoon\nsample application called \"personnel\" which is providing a <datasources/>\nelement. If someone disables this, the datasource for the Lenya scheduler cannot\nbe patched.\n\nIt seems that patches can only go into existing elements. This is my private\nguess (confirmed by some experiments); i am not able to decide this by reading\nhttp://wiki.apache.org/cocoon/XPatchTaskUsage. So a <datasources/> element must\nbe provided before it can be used. As far as i can see, there are two solutions\nfor this:\n\n1. Cocoon provides an empty <datasources/> element in its master cocoon.xconf.\n\n2. The <datasources/> element is inserted by a separate patch file before the\nfirst patch file that wants to use the element.\n\nI created such a file and added another patch. This makes my first patch run\nwithout making assumptions about Cocoon sample applications.\n", "id": 109280, "time": "2007-10-11T14:28:29Z", "creator": "mangst@inventec.ch", "creation_time": "2007-10-11T14:28:29Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 43581, "text": "Created attachment 20964\nPatch described in comment #4.", "id": 109281, "time": "2007-10-11T14:29:48Z", "creator": "mangst@inventec.ch", "creation_time": "2007-10-11T14:29:48Z", "is_private": false, "attachment_id": 20964}, {"count": 6, "tags": [], "bug_id": 43581, "text": "I just realized that there is still something wrong. Will continue tomorrow. Sorry.", "id": 109283, "time": "2007-10-11T14:49:39Z", "creator": "mangst@inventec.ch", "creation_time": "2007-10-11T14:49:39Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 43581, "attachment_id": null, "id": 109309, "creation_time": "2007-10-12T09:39:18Z", "time": "2007-10-12T09:39:18Z", "creator": "mangst@inventec.ch", "text": "It is working now as described in comment #4. Sorry for the hassle.", "is_private": false}, {"count": 8, "tags": [], "bug_id": 43581, "text": "Created attachment 20972\nPatch for comment #7\n\nobsoletes patch 20964 described in comment #4.", "id": 109310, "time": "2007-10-12T09:42:36Z", "creator": "mangst@inventec.ch", "creation_time": "2007-10-12T09:42:36Z", "is_private": false, "attachment_id": 20972}, {"count": 9, "tags": [], "text": "committed, thanks.\nthe patch did not work for me, but i massaged the code in by hand.\nplease test and close if appropriate.\n", "attachment_id": null, "bug_id": 43581, "id": 109312, "time": "2007-10-12T14:07:50Z", "creator": "nettings@apache.org", "creation_time": "2007-10-12T14:07:50Z", "is_private": false}, {"count": 10, "tags": [], "bug_id": 43581, "attachment_id": null, "id": 109356, "time": "2007-10-15T10:00:12Z", "creator": "mangst@inventec.ch", "creation_time": "2007-10-15T10:00:12Z", "is_private": false, "text": "It works. Thanks Joern."}]