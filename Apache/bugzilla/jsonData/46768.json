[{"count": 0, "attachment_id": null, "bug_id": 46768, "is_private": false, "id": 125155, "time": "2009-02-25T18:03:08Z", "creator": "daniel.treacy@abs.gov.au", "creation_time": "2009-02-25T18:03:08Z", "tags": [], "text": "CustomProperties.containsKey(key) does not function for me."}, {"count": 1, "tags": [], "bug_id": 46768, "attachment_id": null, "text": "*** Bug 46769 has been marked as a duplicate of this bug. ***", "id": 125165, "time": "2009-02-25T18:37:39Z", "creator": "dfisher@jmlafferty.com", "creation_time": "2009-02-25T18:37:39Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 46768, "attachment_id": null, "text": "Please provide details about how this fails for you.\n\nWhich version of POI are you using?\n\nDo you have a simple test file and/or a code fragment that shows your trouble?\n\nWithout such we cannot know how to respond.", "id": 125166, "time": "2009-02-25T18:41:21Z", "creator": "dfisher@jmlafferty.com", "creation_time": "2009-02-25T18:41:21Z", "is_private": false}, {"count": 3, "tags": [], "creator": "daniel.treacy@abs.gov.au", "attachment_id": null, "id": 125173, "time": "2009-02-25T22:43:38Z", "bug_id": 46768, "creation_time": "2009-02-25T22:43:38Z", "is_private": false, "text": "Hi, \n\nSorry for not providing more information. I have since worked around th potential issue that I found. The jar I am using version 3.0.2 final. \n\nThe example code that I was trying (Not like this, but this is the same sort of thing): \n\nCustomProperties customProperties = documentSummaryInformation\n\t\t\t\t\t.getCustomProperties();\n\ncustomProperties.put(\"key\", \"value\");\n\n\n\\* Extraction of data by a diff class, from a different event *\\\n\nif(customProperties.containsKey(\"key\")) {\n\nString value = (String) customProperties.get(\"key\");\t\t\t\t\t\t\t\t\t\t\n\n}\n\n\nThe condition returns false resulting in the value not being extracted. \n\nI'm probably missing something. \n\nI wrote the following method as a temp work around: (I'm not a programming or java expert, dont be too harsh on me :-))\n\nprivate static boolean isCustomProperty(CustomProperties customProperties,\n\t\t\tString property) {\n\t\tif (logger.isDebugEnabled()) {\n\t\t\tlogger.debug(\"isCustomProperty(CustomProperties, String) - start\");\n\t\t}\n\t\n\t\ttry {\n\t\t\tSet<Map.Entry<?, CustomProperty>> set = customProperties.entrySet();\n\t\t\t\n\t\t\tfor (Map.Entry<?, CustomProperty> me : set) {\n\t\n\t\t\t\tCustomProperty cP = (CustomProperty) me.getValue();\n\t\t\t\t\n\t\t\t\tString key = cP.getName();\n\t\n\t\t\t\tif (key.contains(property)) {\n\t\t\t\t\tif (logger.isDebugEnabled()) {\n\t\t\t\t\t\tlogger\n\t\t\t\t\t\t\t\t.debug(\"isCustomProperty(CustomProperties, String) - end\");\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (Exception e) {\n\t\t\tlogger.error(\"isCustomProperty(CustomProperties, String)\", e);\n\t\n\t\t} \n\nThanks for your assistance."}, {"count": 4, "tags": [], "text": "Could you please try an unconditional \n\nObject value = customProperties.get(\"key\");\n\nand after doing the get() check whether the result is null (value not in properties) or not null (you retrieved the value successfully)?\n\nIf the custom properties indeed do not contain your value the question is whether your key/value pair\na) entered the custom properties successfully\nb) had been deleted by your application or\nc) had been deleted by a HPSF failure.\n\nIn case c) we'd need a sample program demonstrating the error. Ideally it would be in the form of a JUnit test case, but this is not required.", "attachment_id": null, "bug_id": 46768, "id": 125174, "time": "2009-02-25T23:47:50Z", "creator": "klute@apache.org", "creation_time": "2009-02-25T23:47:50Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 46768, "text": "No response here for a long time, therefore I am resolving this as LATER for now, if you still see this problem with the latest version of POI, then please reopen this bug with more information, preferably a unit test and sample documents which allow us to reproduce the problem more easily.", "id": 181940, "time": "2015-03-22T12:28:43Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-03-22T12:28:43Z", "is_private": false, "attachment_id": null}]