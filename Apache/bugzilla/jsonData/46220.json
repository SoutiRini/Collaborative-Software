[{"count": 0, "tags": [], "bug_id": 46220, "attachment_id": null, "text": "Some of our own test cases have been failing since an update from POI 3.1 to 3.2.\n\nThe embedded images now come out incorrectly or are not found at all.", "id": 122539, "time": "2008-11-16T14:05:10Z", "creator": "trejkaz@trypticon.org", "creation_time": "2008-11-16T14:05:10Z", "is_private": false}, {"count": 1, "tags": [], "creator": "trejkaz@trypticon.org", "text": "Test file 1 (too big to attach. :-( )\nhttp://dl.getdropbox.com/u/50201/nonconsecutive-images.doc\n\nThis one now gets 3 images instead of 4.\n\nCorrect MD5 digests for each image (first three do match up so the images it does pick up must be okay.)\n\n851be142bce6d01848e730cb6903f39e\n7fc6d8fb58b09ababd036d10a0e8c039\na7dc644c40bc2fbf17b2b62d07f99248\n72d07b8db5fad7099d90bc4c304b4666   <-- this is the missing one\n", "id": 122540, "time": "2008-11-16T14:15:42Z", "bug_id": 46220, "creation_time": "2008-11-16T14:15:42Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "apache@gagravarr.org", "text": "I wonder if this is another area of hwpf that is assuming bytes/characters but getting characters/bytes. (I tried to make it a bit more sane for 3.2, so that unicode text extraction worked more reliably, but the file format it really crazy about this sort of thing)\n\nOne test that'd be interesting is creating a few small test files with images, and seeing how hwpf copes with them:\n* non unicode, one image near start\n* non unicode, one image near end\n* non unicode, image near start, image near end\n* unicode, one image near start\n* unicode, one image near end\n* unicode, image near start, image near end\n\nIf 5 and 6 have issues with their later images, we'll know it's another byte/character problem. If it's something different, maybe it'll help us track down.\n\nAs a bonus, the files will make a good regression test for the future :)", "id": 122541, "time": "2008-11-17T02:02:02Z", "bug_id": 46220, "creation_time": "2008-11-17T02:02:02Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "trejkaz@trypticon.org", "attachment_id": null, "id": 122585, "time": "2008-11-17T17:38:35Z", "bug_id": 46220, "creation_time": "2008-11-17T17:38:35Z", "is_private": false, "text": "Any suggestions on how to go about this?  I tried doing what was suggested on the list, and incrementally adding images to existing documents, but even for \"broken\" ones, Word saved them in a form which fixed any warnings.\n"}, {"count": 4, "tags": [], "creator": "apache@gagravarr.org", "text": "The fact that re-saving them in word fixes the warning does tend to make me think these files really are slightly dodgy, and it isn't just us\n\nFirst up, could you try older versions of word, to see if maybe there was one earlier version which produced these dodgy files?\n\nOtherwise, if you could find a couple of different files which do trigger the warning, but not all have image issues, that'd be a big help. Especially if we could have two versions of each, the original (with warning) and the newer word re-saved version (without warnings). We can then compare them, see the differences, and hopefully figure out what needs fixing/working around", "id": 122633, "time": "2008-11-19T04:49:23Z", "bug_id": 46220, "creation_time": "2008-11-19T04:49:23Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "trejkaz@trypticon.org", "text": "Same file as before, with one more image added in and the number edited from 4 to 5 in the document...\n\n851be142bce6d01848e730cb6903f39e\n7fc6d8fb58b09ababd036d10a0e8c039\na7dc644c40bc2fbf17b2b62d07f99248\n5eee0af68b7856b731a7775db8a6e6e2\n72d07b8db5fad7099d90bc4c304b4666 <-- missing (same image as before)\n\nhttp://dl.getdropbox.com/u/50201/nonconsecutive-images-2.doc\n\nWarnings:\nA property claimed to start before zero, at -512! Resetting it to zero, and hoping for the best\nA property claimed to start before zero, at -512! Resetting it to zero, and hoping for the best\n", "id": 122652, "time": "2008-11-19T14:59:23Z", "bug_id": 46220, "creation_time": "2008-11-19T14:59:23Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 46220, "is_private": false, "count": 6, "id": 122653, "time": "2008-11-19T15:01:12Z", "creator": "trejkaz@trypticon.org", "creation_time": "2008-11-19T15:01:12Z", "text": "Actually for comparison, this is the same warnings I'm getting on the original file in this case, i.e. the Unicode one isn't appearing for this test case, only for the other ones (which I can't redistribute, because someone checked in IP as test cases.) :-(\n"}, {"count": 7, "tags": [], "bug_id": 46220, "attachment_id": null, "text": "Images are properly read with current trunk. I included your sample in our collection of test documents and added a unit test.\n\nYegor", "id": 147428, "time": "2011-06-24T08:19:54Z", "creator": "yegor@dinom.ru", "creation_time": "2011-06-24T08:19:54Z", "is_private": false}]