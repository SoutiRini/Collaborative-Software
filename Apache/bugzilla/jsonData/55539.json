[{"count": 0, "tags": [], "bug_id": 55539, "attachment_id": 30807, "id": 169975, "time": "2013-09-09T09:00:21Z", "creator": "shaddow_es@yahoo.es", "creation_time": "2013-09-09T09:00:21Z", "is_private": false, "text": "Created attachment 30807\nAnt example to check error\n\nIn some cases fail task does not return exit code indicated in status property. \n\nI have attached an example to check the error.\n+ Using target \"testok\" return code is 3. Its ok!\n+ Using target \"test\" return code should be either 4 or 5, but result code was 1."}, {"count": 1, "attachment_id": null, "creator": "bodewig@apache.org", "text": "Hmm, this is on a Ubuntu box:\n\nstefan@birdy:~$ cat > /tmp/55539.xml\n<project default=\"test\">\n\t\n    <target name=\"test\">\n\t\t<parallel threadCount=\"2\" failonany=\"true\">\n\t\t\t<antcall target=\"test1\" inheritAll=\"false\" />\n\t\t\t<antcall target=\"test2\" inheritAll=\"false\" />\n\t\t</parallel>\n    </target>\n\t\n    <target name=\"test1\">\n\t\t<fail message=\"exit 4!\" status=\"4\" />\n    </target>\n    <target name=\"test2\">\n\t\t<fail message=\"exit 5\" status=\"5\" />\n    </target>\n\t\n\t\n    <target name=\"testok\">\n\t\t<fail message=\"exit 3\" status=\"3\" />\n    </target>\n\n</project>\nstefan@birdy:~$ ant -f /tmp/55539.xml test1\nBuildfile: /tmp/55539.xml\n\ntest1:\n\nBUILD FAILED\n/tmp/55539.xml:11: exit 4!\n\nTotal time: 1 second\nstefan@birdy:~$ echo $?\n4\nstefan@birdy:~$ ant -f /tmp/55539.xml test2\nBuildfile: /tmp/55539.xml\n\ntest2:\n\nBUILD FAILED\n/tmp/55539.xml:14: exit 5\n\nTotal time: 0 seconds\nstefan@birdy:~$ echo $?\n5\nstefan@birdy:~$ ant -f /tmp/55539.xml testok\nBuildfile: /tmp/55539.xml\n\ntestok:\n\nBUILD FAILED\n/tmp/55539.xml:19: exit 3\n\nTotal time: 0 seconds\nstefan@birdy:~$ echo $?\n3\nstefan@birdy:~$ ant -f /tmp/55539.xml test\nBuildfile: /tmp/55539.xml\n\ntest:\n\ntest2:\n\ntest1:\n\nBUILD FAILED\n/tmp/55539.xml:5: The following error occurred while executing this line:\n/tmp/55539.xml:11: exit 4!\n\nTotal time: 0 seconds\nstefan@birdy:~$ echo $?\n1\n\nso it is not the fail task but the parallel task causing the problem.", "id": 170001, "time": "2013-09-10T04:19:58Z", "bug_id": 55539, "creation_time": "2013-09-10T04:19:58Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 170002, "time": "2013-09-10T04:27:00Z", "bug_id": 55539, "creation_time": "2013-09-10T04:27:00Z", "is_private": false, "text": "clicked save to soon, sorry.\n\nparallel catches the exceptions thrown in all threads and massages them a little - unfortunately it strips off the knowledge of an ExitStatusException which is a subclass thrown by the fail task."}, {"count": 3, "tags": [], "creator": "bodewig@apache.org", "text": "fixed with svn revision 1524979", "id": 170189, "time": "2013-09-20T11:50:34Z", "bug_id": 55539, "creation_time": "2013-09-20T11:50:34Z", "is_private": false, "attachment_id": null}]