[{"count": 0, "tags": [], "creator": "kiwiwings@apache.org", "attachment_id": null, "id": 171449, "time": "2013-11-26T22:48:00Z", "bug_id": 55818, "creation_time": "2013-11-26T22:48:00Z", "is_private": false, "text": "(As nick suggested in #53475, I'm opening this new bug to track the changes)\n\nCurrently POI only supports standard/agile decryption - my goal is to provide (mainly agile) encryption support\nAs this is a bigger change, I'll post changes as soon as a certain feature compiles/tests stable.\n\nI plan the following parts:\n- Part 1: refactor decryption code, so I can use it for encryption\n- Part 2: xmlbeans support for encryption descriptor\n- Part 3: encryption classes\n- Part 4: more javadocs and updates to the documentation ;)\n\nCurrently the patches will be based on the trunk, so part X contains changes of part X-1,... I'll update the diffs, if predecessor parts have been applied"}, {"count": 1, "attachment_id": 31077, "bug_id": 55818, "text": "Created attachment 31077\npatch for encryption support - Part 1 - refactor crypt code\n\nFor a starter I've refactored the used crypto helper functions, which will be reused for encryption", "id": 171451, "time": "2013-11-26T22:52:49Z", "creator": "kiwiwings@apache.org", "creation_time": "2013-11-26T22:52:49Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "kiwiwings@apache.org", "text": "Created attachment 31079\npatch for encryption support - Part 2 - xmlbeans for descriptor\n\nThe 2nd part introduces the xml schemas for the encryption descriptor, which is used in agile encryption.\n\nThe new xmlbeans classes made it necessary to also change the build. Furthermore there's a fix for OOXMLLite which didn't work with one of the recently introduced Junit4 tests.\n\nI've tried to keep the public decryption interface, i.e. EncryptionInfo/Decryptor, but\nI've split up the standard and agile classes, so one can use standard without xmlbeans support, i.e. these classes stay in the main-poi jar, whereas the agile classes have been moved to the ooxml area, because of the new xmlbeans dependency. As agile encryption is used for the X**F formats, one has to have xmlbeans anyway in the dependencies.\n\nBefore you apply the patch to the svn repo, please move the corresponding test classes in the repo, to keep the history.", "id": 171454, "time": "2013-11-26T23:41:35Z", "bug_id": 55818, "creation_time": "2013-11-26T23:41:35Z", "is_private": false, "attachment_id": 31079}, {"count": 3, "tags": [], "bug_id": 55818, "attachment_id": 31100, "id": 171623, "time": "2013-12-07T00:46:20Z", "creator": "kiwiwings@apache.org", "creation_time": "2013-12-07T00:46:20Z", "is_private": false, "text": "Created attachment 31100\npatch for encryption support - Part 3 - standard encryption\n\nok, here comes part 3, which contains standard encryption support\n\ncurrently only AES has been tested, but maybe you already want to give it a try ...\n\nAlso comments about the interface are welcomed"}, {"count": 4, "tags": [], "bug_id": 55818, "attachment_id": 31116, "id": 171745, "time": "2013-12-14T20:32:40Z", "creator": "kiwiwings@apache.org", "creation_time": "2013-12-14T20:32:40Z", "is_private": false, "text": "Created attachment 31116\npatch for encryption support - Part 4 - agile encryption\n\npart 4 brings support for agile encryption.\n\nI've tested most cipher/hash combinations with a ms word viewer, but couldn't validate the hashes ripemd* and whirlpool, because opposed to the full feature version, it doesn't support all encryptions. RC4 is currently also not supported, because I don't know how to handle a streaming cipher (i.e. IVs don't work the same way, as with block ciphers) and it's not recommended [1][2]\n\nThe code still lacks some (a lot?) of comments, so this is something for part 5 to come and some usage infos wouldn't hurt too ....\n\n[1] http://msdn.microsoft.com/en-us/library/dd925810(v=office.12).aspx\n[2] http://blogs.msdn.com/b/david_leblanc/archive/2010/04/16/don-t-use-office-rc4-encryption-really-just-don-t-do-it.aspx (although this focus actually on \"Office Binary Document RC4 Encryption\" ...)"}, {"count": 5, "tags": [], "creator": "kiwiwings@apache.org", "attachment_id": 31137, "id": 171847, "creation_time": "2013-12-20T00:49:24Z", "time": "2013-12-20T00:49:24Z", "bug_id": 55818, "text": "Created attachment 31137\npatch for encryption support - Part 5 - docs and certificate encryption\n\nPart 5 brings a few javadocs / docu updates and an experimental certificate encryption support.\n\nCurrently I can't validate the certificate approach ... lets see what the msdn people come up with [1]\n\n[1] social.msdn.microsoft.com/Forums/en-US/cc9092bb-0c82-4b5b-ae21-abf643bdb37c/agile-encryption-with-certificates", "is_private": false}, {"count": 6, "tags": [], "bug_id": 55818, "attachment_id": null, "text": "applied with SVN rev r1553336, r1553338, r1553339, r1553340, r1553342\nsorry for that many submits, but I'm running on a jdk 7 locally, instead of a jdk 5", "id": 171921, "time": "2013-12-25T01:30:42Z", "creator": "kiwiwings@apache.org", "creation_time": "2013-12-25T01:30:42Z", "is_private": false}]