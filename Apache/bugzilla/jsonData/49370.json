[{"count": 0, "tags": [], "creator": "will@coleda.com", "attachment_id": 25507, "is_private": false, "id": 137259, "time": "2010-06-01T16:14:25Z", "bug_id": 49370, "creation_time": "2010-06-01T16:14:25Z", "text": "Created attachment 25507\nxlsx that shows the issue.\n\nSimilar to ticket 48494\n\nGiven the following snippet in a J2EE app, using POI 3.6 20091214:\n\nString realPath = getServletContext().getRealPath(\"/WEB-INF/Book1.xlsx\");\n    InputStream inp = new FileInputStream(realPath);\n    Workbook wb = WorkbookFactory.create(inp);\n    \n    wb.createSheet(\"new sheet\");\n\n    // Write the output to a file\n     realPath = getServletContext().getRealPath(\"/WEB-INF/Book1_out.xlsx\");\n    FileOutputStream fileOut = new FileOutputStream(realPath);\n    wb.write(fileOut);\n    fileOut.close();\n\n\nthis dies on the .write() call with:\n\n\njavax.servlet.ServletException: java.lang.NoClassDefFoundError: org/openxmlformats/schemas/spreadsheetml/x2006/main/CTDxfs$1\n\torg.apache.jasper.runtime.PageContextImpl.doHandlePageException(PageContextImpl.java:855)\n\torg.apache.jasper.runtime.PageContextImpl.handlePageException(PageContextImpl.java:784)\n\torg.apache.jsp.About_jsp._jspService(About_jsp.java:112)\n\torg.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n\torg.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:387)\n\torg.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:320)\n\torg.apache.jasper.servlet.JspServlet.service(JspServlet.java:266)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n\torg.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter(ReplyHeaderFilter.java:96)\n\ncommenting out the .createSheet() avoids the error, avoiding conditional formatting avoids the error. (Cell E1 contains the conditional formatting in the attachment.)"}, {"text": "This sort of issue has been discussed a large number of times in bugs and on the mailing lists....\n\nShort term, you'll need to use the full ooxml schemas jar, not the minimal one\n\nLonger term, please submit a new unit test that uses the extra ooxml classes that you need, so that our build script which identifies only the bits of the full ooxml jar that are routinely used can pick it up and include it in the next version", "tags": [], "bug_id": 49370, "is_private": false, "count": 1, "id": 137260, "time": "2010-06-01T16:29:38Z", "creator": "apache@gagravarr.org", "creation_time": "2010-06-01T16:29:38Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "will@coleda.com", "attachment_id": null, "is_private": false, "id": 137262, "time": "2010-06-01T17:07:55Z", "bug_id": 49370, "creation_time": "2010-06-01T17:07:55Z", "text": "(In reply to comment #1)\n> This sort of issue has been discussed a large number of times in bugs and on\n> the mailing lists....\n\nFor those who end up finding /this/ bug when searching ...\n \n> Short term, you'll need to use the full ooxml schemas jar, not the minimal one\n\nAnd this is described here:\n\nhttps://issues.apache.org/bugzilla/show_bug.cgi?id=49325\n\nspecifically:\n\n>> As a workaround, replacing poi-ooxml-schemas-3.6-20091214.jar with\n>> ooxml-schemas-1.0.jar downloaded from\n>> http://mirrors.ibiblio.org/pub/mirrors/maven2//org/apache/poi/ooxml-schemas/1.0/\n>> resolved the issue.\n\n> Longer term, please submit a new unit test that uses the extra ooxml classes\n> that you need, so that our build script which identifies only the bits of the\n> full ooxml jar that are routinely used can pick it up and include it in the\n> next version"}, {"count": 3, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "is_private": false, "id": 137281, "time": "2010-06-02T12:03:43Z", "bug_id": 49370, "creation_time": "2010-06-02T12:03:43Z", "text": "http://poi.apache.org/faq.html#faq-N10025 also covers this too"}]