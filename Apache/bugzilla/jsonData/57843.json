[{"count": 0, "tags": [], "text": "Created attachment 32674\nfailing document\n\nTrying to parse this document via Tika. It appears to be a pretty vanilla Word 97 era .doc. It opens correctly in Word for Mac 2011.\n\nIt's attached. The document is already publicly posted and I grant any rights I have in the document to ASF; I should note that it's part of a publicly-posted dump of emails sent to/from former Florida Gov. Jeb Bush, so I don't hold copyright over it.\n\nThis is the POI version of https://issues.apache.org/jira/browse/TIKA-1608\n\nStacktrace looks like this:\n\n$ java -jar /tika-app/target/tika-app-1.9-SNAPSHOT.jar --text 1534-attachment.doc\nException in thread \"main\" org.apache.tika.exception.TikaException: Unexpected RuntimeException from org.apache.tika.parser.microsoft.OfficeParser@69af0db6\nat org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:283)\nat org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:281)\nat org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:120)\nat org.apache.tika.cli.TikaCLI$OutputType.process(TikaCLI.java:180)\nat org.apache.tika.cli.TikaCLI.process(TikaCLI.java:477)\nat org.apache.tika.cli.TikaCLI.main(TikaCLI.java:134)\nCaused by: java.lang.ArrayIndexOutOfBoundsException\nat java.lang.System.arraycopy(Native Method)\nat org.apache.poi.hwpf.model.PAPFormattedDiskPage.getGrpprl(PAPFormattedDiskPage.java:171)\nat org.apache.poi.hwpf.model.PAPFormattedDiskPage.<init>(PAPFormattedDiskPage.java:101)\nat org.apache.poi.hwpf.model.OldPAPBinTable.<init>(OldPAPBinTable.java:49)\nat org.apache.poi.hwpf.HWPFOldDocument.<init>(HWPFOldDocument.java:109)\nat org.apache.tika.parser.microsoft.WordExtractor.parseWord6(WordExtractor.java:532)\nat org.apache.tika.parser.microsoft.WordExtractor.parse(WordExtractor.java:84)\nat org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:201)\nat org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:172)\nat org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:281)\n... 5 more", "attachment_id": 32674, "bug_id": 57843, "id": 182535, "time": "2015-04-21T15:18:57Z", "creator": "jeremy.merrill@nytimes.com", "creation_time": "2015-04-21T15:18:57Z", "is_private": false}, {"count": 1, "tags": [], "creator": "onealj@apache.org", "attachment_id": null, "is_private": false, "id": 193914, "time": "2016-09-22T09:27:07Z", "bug_id": 57843, "creation_time": "2016-09-22T09:27:07Z", "text": "POI detected this as a Word 95 or older file, requiring HWPFOldDocument to read the file. \n\nThe file claims it is a Microsoft Word 6.0 Document, which is the file format of Word 6.0, released in 1993. [1] \n\n[1] https://en.wikipedia.org/wiki/Microsoft_Word#Release_history\n\nI got the same error as you in the latest version of POI, 3.16 trunk. I added this failing unit test in r1761873.\n\n> java.lang.ArrayIndexOutOfBoundsException\n>   at java.lang.System.arraycopy(Native Method)\n>   at org.apache.poi.hwpf.model.PAPFormattedDiskPage.getGrpprl(PAPFormattedDiskPage.java:171)\n>   at org.apache.poi.hwpf.model.PAPFormattedDiskPage.<init>(PAPFormattedDiskPage.java:101)\n>   at org.apache.poi.hwpf.model.OldPAPBinTable.<init>(OldPAPBinTable.java:49)\n>   at org.apache.poi.hwpf.HWPFOldDocument.<init>(HWPFOldDocument.java:107)\n>   at org.apache.poi.hwpf.HWPFOldDocument.<init>(HWPFOldDocument.java:45)\n>   at org.apache.poi.hwpf.usermodel.TestBugs.test57843(TestBugs.java:911)"}]