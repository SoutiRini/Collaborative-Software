[{"count": 0, "tags": [], "creator": "jiangguangtao@foxmail.com", "attachment_id": null, "text": "I want to rename a Excel Sheet, most of the time is ok, but yesterday I rename a sheet with IFERROR function, throw a NullPointException.", "id": 183667, "time": "2015-06-21T03:51:57Z", "bug_id": 58064, "creation_time": "2015-06-21T03:51:57Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 58064, "attachment_id": null, "id": 183668, "time": "2015-06-21T06:16:05Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-06-21T06:16:05Z", "is_private": false, "text": "Can you provide details, i.e. a sample file and a piece of self-contained code which reproduces the problem?"}, {"count": 2, "tags": [], "bug_id": 58064, "attachment_id": null, "text": "Test Excel(xlsx):\n   New one Excel file on windows platform, open it, select Cell D4 and set cell value to \"=IFERROR(VLOOKUP(C4,'Country List'!$A$1:$B$251,2,0),\"\")\"(except outside \").\n 'Country List' is a sheet, contains the conntry name list, col A full contry name, col B abbreviation.\n\n\nTest Code: \n   @Test\n    public void testRenameSheet() throws IOException, InvalidFormatException {\n        String filePath = \"D:\\\\win7temp\\\\testiferror.xlsx\";\n        Workbook book = WorkbookFactory.create(new File(filePath));\n        Sheet sheet = book.getSheetAt(0);\n        System.out.printf(\"origin name:%s \\n\", sheet.getSheetName());\n        book.setSheetName(0, \"NewSheetName\");\n        System.out.printf(\"rename over!\");\n    }\n\nOutput is:\norigin name:Sheet1 \n\njava.lang.NullPointerException\n\tat org.apache.poi.xssf.usermodel.helpers.XSSFFormulaUtils.updatePtg(XSSFFormulaUtils.java:128)\n\tat org.apache.poi.xssf.usermodel.helpers.XSSFFormulaUtils.updateFormula(XSSFFormulaUtils.java:98)\n\tat org.apache.poi.xssf.usermodel.helpers.XSSFFormulaUtils.updateSheetName(XSSFFormulaUtils.java:78)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.setSheetName(XSSFWorkbook.java:1361)\n\tat com.lrm.test.POICopyUtilTest.testRenameSheet(POICopyUtilTest.java:36)", "id": 183702, "time": "2015-06-23T06:21:31Z", "creator": "jiangguangtao@foxmail.com", "creation_time": "2015-06-23T06:21:31Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 58064, "text": "Created attachment 32851\ntest iferror function on POI 3.11 when set new sheet name.", "id": 183703, "time": "2015-06-23T06:22:32Z", "creator": "jiangguangtao@foxmail.com", "creation_time": "2015-06-23T06:22:32Z", "is_private": false, "attachment_id": 32851}, {"count": 4, "tags": [], "creator": "jiangguangtao@foxmail.com", "attachment_id": null, "text": "(In reply to Dominik Stadler from comment #1)\n> Can you provide details, i.e. a sample file and a piece of self-contained\n> code which reproduces the problem?\n\nI test it on POI 3.12 is ok.", "id": 183704, "time": "2015-06-23T06:31:04Z", "bug_id": 58064, "creation_time": "2015-06-23T06:31:04Z", "is_private": false}]