[{"count": 0, "tags": [], "bug_id": 16574, "attachment_id": null, "id": 30315, "time": "2003-01-30T00:24:04Z", "creator": "jorge_middleton@yahoo.com", "creation_time": "2003-01-30T00:24:04Z", "is_private": false, "text": "The problem is, that when replace a session attribute that implements \nHttpSessionBindingListener, in the valueUnbound method I get \njava.lang.NullPointerException.\n\nexample:\npublic void valueUnbound(HttpSessionBindingEvent be) {\n  User u = (User)be.getValue();\n  System.out.println(\"The user \" + u.getName() + \" was unbounded\");\n}\n\nI believe that the error is that in line 1250 of StandardSession \n(new HttpSessionBindingEvent((HttpSession) this, name));\nyou have put (new HttpSessionBindingEvent((HttpSession) this, name, unbound));\n\nIn the specification of Servlet 2.3, the method getValue() of \nHttpSessionBindingEvent class say:\n\n  .... If the attribute was replaced, this is the old value of the attribute.\n\nThank for your attention and sorry for my english. I you don't understand me, \nplease let me know.\n\nJorge L. Middleton\nBs. As. Argentina"}, {"count": 1, "text": "I have reviewed the code and I agree with your analysis of what is causing the \nNullPointerException. I have also reviewed the 2.3 Servlet specification. In \nmy view, the specification could be clearer but I believe Tomcat implements \nthe specification correctly.\n\n<spec-quote>\nSRV.15.1.11.1 Methods\nvalueBound(HttpSessionBindingEvent)\npublic void valueBound(HttpSessionBindingEvent event)\nNotifies the object that it is being bound to a session and identifies the \nsession.\nParameters:\nevent - the event that identifies the session\n</spec-quote>\n\nIt is clear that the event must identify the session. It makes no mention of \nthe value. To me this seems sensible as the object already knows it's own \nvalue. For example, your code could be re-written as:\n\npublic void valueUnbound(HttpSessionBindingEvent be) {\n  System.out.println(\"The user \" + getName() + \" was unbounded\");\n}\n\nwhich would not generate a NullPointerException.\n\nWhen notifing registered application event listeners, Tomcat does include the \nobject.", "bug_id": 16574, "attachment_id": null, "id": 53555, "time": "2004-03-06T15:45:43Z", "creator": "markt@apache.org", "creation_time": "2004-03-06T15:45:43Z", "tags": [], "is_private": false}]