[{"count": 0, "tags": [], "creator": "jonathan@onegoodidea.com", "attachment_id": null, "is_private": false, "id": 14600, "time": "2002-04-24T08:20:50Z", "bug_id": 8452, "creation_time": "2002-04-24T08:20:50Z", "text": "Apache 2.0.35 configured as:\n\n% ./configure --prefix=/._ark-deploy/apache--2.0.35 --enable-so --enable-\nssl --with-ssl=/._ark-deploy/openssl--0.9.6c --disable-status --disable-\ninfo --enable-rewrite --with-mpm=perchild \nLDFLAGS= CXXFLAGS=-O2 -fstrict-aliasing CFLAGS=-O2 -fstrict-aliasing \nCPPFLAGS= CXX=/ark/bin/g++ CC=/ark/bin/gcc\n\n% /ark/bin/gcc --version\n3.0.4\n\nCompile fails with:\n\nMaking all in perchild\n/bin/sh /item/ark-builds/apache--2.0.35/sparc-solaris/srclib/apr/libtool --\nsilent --mode=compile /ark/bin/gcc  -pthreads -DNO_DBM_REWRITEMAP  \n-O2 -fstrict-aliasing  -DSOLARIS2=8 -D_POSIX_PTHREAD_SEMANTICS -\nD_REENTRANT -DAP_HAVE_DESIGNATED_INITIALIZER   -I. -I/item/ark-\nbuilds/apache--2.0.35/sparc-solaris/os/unix -I/item/ark-builds/apache--\n2.0.35/sparc-solaris/server/mpm/perchild -I/item/ark-builds/apache--\n2.0.35/sparc-solaris/modules/http -I/item/ark-builds/apache--2.0.35/\nsparc-solaris/modules/proxy -I/item/ark-builds/apache--2.0.35/sparc-\nsolaris/include -I/item/ark-builds/apache--2.0.35/sparc-solaris/srclib/apr/\ninclude -I/item/ark-builds/apache--2.0.35/sparc-solaris/srclib/apr-util/\ninclude -I/._ark-deploy/openssl--0.9.6c/include/openssl -I/._ark-deploy/\nopenssl--0.9.6c/include -I/item/ark-builds/apache--2.0.35/sparc-solaris/\nmodules/dav/main -I/item/ark-builds/apache--2.0.35/sparc-solaris/srclib/\napr-util/include -I/item/ark-builds/apache--2.0.35/sparc-solaris/srclib/apr-\nutil/xml/expat/lib  -c perchild.c && touch perchild.lo\nperchild.c: In function `receive_from_other_child':\nperchild.c:668: structure has no member named `msg_control'\nperchild.c:669: structure has no member named `msg_controllen'\nperchild.c:670: structure has no member named `msg_flags'\nperchild.c:674: warning: passing arg 2 of `memcpy' makes pointer from \ninteger without a cast\nperchild.c: In function `pass_request':\nperchild.c:1573: warning: passing arg 1 of `memcpy' makes pointer from \ninteger without a cast\nperchild.c:1575: structure has no member named `msg_control'\nperchild.c:1576: structure has no member named `msg_controllen'\nperchild.c:1577: structure has no member named `msg_flags'\n*** Error code 1\nmake: Fatal error: Command failed for target `perchild.lo'\n\nThe missing members appear in '/usr/include/socket.h' as:\n\nstruct msghdr {\n        void            *msg_name;              /* optional address */\n        socklen_t       msg_namelen;            /* size of address */\n        struct iovec    *msg_iov;               /* scatter/gather array */\n        int             msg_iovlen;             /* # elements in msg_iov */\n\n#if defined(_XPG4_2) || defined(_KERNEL)\n        void            *msg_control;           /* ancillary data */\n        socklen_t       msg_controllen;         /* ancillary data buffer len */\n        int             msg_flags;              /* flags on received message */\n#else\n        caddr_t         msg_accrights;  /* access rights sent/received */\n        int             msg_accrightslen;\n#endif  /* defined(_XPG4_2) || defined(_KERNEL) */\n};\n\nfrom which I presume that some compatibility define is not being set.\n\nI tried re-configuring with 'CFLAGS=-O2 -fstrict-aliasing -D_XPG4_2', but \nthis just made the compile die with:\n\n/bin/sh /item/ark-builds/apache--2.0.35/sparc-solaris/srclib/apr/libtool --\nsilent --mode=compile /ark/bin/gcc -pthreads  -O2 -fstrict-aliasing -\nD_XPG4_2 -DHAVE_CONFIG_H -DSOLARIS2=8 -\nD_POSIX_PTHREAD_SEMANTICS -D_REENTRANT   -I../include -I../\ninclude/arch/unix  -c apr_strings.c && touch apr_strings.lo\nIn file included from ../include/apr_general.h:66,\n                 from apr_s\ntrings.c:57:\n/usr/include/signal.h:77: parse error \nbefore '*' token\n*** Error code 1\nmake: \nFatal error: Command failed for target `apr_strings.lo'\n\nSo I guess the problem is more complex than that.\n\n[I thought I'd seen this bug come up before, but I can't find anything on it \nsearching the database.]"}, {"count": 1, "tags": [], "creator": "jerenkrantz@apache.org", "attachment_id": null, "is_private": false, "id": 14689, "time": "2002-04-25T06:31:38Z", "bug_id": 8452, "creation_time": "2002-04-25T06:31:38Z", "text": "Perchild is an experimental MPM and is not currently expected to work on\nplatforms other than Linux.  In the forthcoming release of Apache 2.0.36, we\nhave moved perchild to our experimental/mpm directory.  This should better\nindicate our perspective on perchild's status.\n\nThere is not enough developer support currently to maintain perchild and see\nthat it works on all supported platforms of Apache 2.0.  If you wish to\ncontribute patches, we will welcome them on the developer mailing list. \nHowever, we will not provide support for perchild on the bug database until we\nhave enough developer support to improve the quality of the perchild MPM code first.\n\nThanks for using Apache!"}, {"count": 2, "tags": [], "bug_id": 8452, "text": "*** Bug 9295 has been marked as a duplicate of this bug. ***", "id": 16517, "time": "2002-05-22T04:05:32Z", "creator": "apachebugs@louisiana.edu", "creation_time": "2002-05-22T04:05:32Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 8452, "text": "Try this macro definition:\n    -D_XOPEN_SOURCE=500 -D__EXTENSIONS__\nI'm using Solaris8 IA + gcc-3.1, and apache-2.0.36 + perchild MPM\nhas been compiled successfully. Also, it works fine.\n\nAdditionally, on Solaris8, the alternate thread library is preferred\nthan the standard thread lib. (Normally, outperforming and stable.)\nIf \"/usr/xpg4/lib/libpthread.so\" exists:\n    LDFLAGS = -lpthread -R/usr/xpg4/lib\nOtherwise:\n    LDFLAGS = -lpthread -lthread -R/usr/lib/lwp\n\nNote that Solaris7 and earlier don't have the alternate thread lib,\nand Solaris9's standard thread lib is equivalent to Solaris8's\nalternate thread lib.", "id": 16620, "time": "2002-05-24T05:52:54Z", "creator": "nazonazo@miobox.jp", "creation_time": "2002-05-24T05:52:54Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 8452, "is_private": false, "text": "switch to wontfix, since it's not maintained.", "id": 63643, "time": "2004-09-15T22:56:55Z", "creator": "nd@perlig.de", "creation_time": "2004-09-15T22:56:55Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 8452, "text": "FWIW (Hiii 2002)...\n\nThe procset_t definition doesn't happen in <sys/procset.h> because of the _XPG4_2 define, so you need to edit the <signal.h> (that sounds bad, but it's a slip-up by Sun) to not use that struct if _XPG4_2 is used.\n\n#if !defined(_XPG4_2)\n    extern int sigsendset(const procset_t *, int);\n#endif\n\nIt happens on Solaris 9 too.", "id": 176447, "time": "2014-07-17T06:12:19Z", "creator": "mark@ibiblio.org", "creation_time": "2014-07-17T06:12:19Z", "is_private": false, "attachment_id": null}]