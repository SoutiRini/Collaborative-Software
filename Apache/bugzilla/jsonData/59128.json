[{"count": 0, "tags": [], "bug_id": 59128, "is_private": false, "text": "The full-scope schema JARs, ooxml-schemas 1.3 and ooxml-security 1.1 depend on xmlbeans 2.3. It should be 2.6 to match the dependency in the rest of POI.\n\nSee:\n\nhttp://mvnrepository.com/artifact/org.apache.poi/ooxml-schemas/1.3\nhttp://mvnrepository.com/artifact/org.apache.poi/ooxml-security/1.1\n\nIn practice this probably doesn't matter as users using these will also be depending on poi-ooxml, which will pull in xmlbeans 2.6.0 via transitive dependencies to poi-ooxml-schemas, and most Maven/Ivy-like tools will evict 2.3.0 in favour of 2.6.0 to resolve the clash.\n\nWe should fix this, though, presumably by issuing ooxml-schemas 1.3.1 and ooxml-security 1.1.1.", "id": 189155, "time": "2016-03-05T20:41:18Z", "creator": "dtn-asfbugs@corefiling.co.uk", "creation_time": "2016-03-05T20:41:18Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "text": "This is deliberate - xmlbeans runtimes will run older-compiled schemas but not newer ones. As such, we compile against the oldest feasible version we can (2.3), but ship 2.6 as the suggested runtime. This means that most people will use 2.6, but anyone who needs to can stick with 2.3, 2.4 or 2.5 (if their framework etc ships only that)", "id": 189156, "time": "2016-03-05T20:44:00Z", "bug_id": 59128, "creation_time": "2016-03-05T20:44:00Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 59128, "text": "I wonder if it still makes sense to be downward compatible, since we've switched to Java 6 and there are probably not many good reasons to stick with xmlbeans 2.3 ...", "count": 2, "id": 189157, "time": "2016-03-05T20:51:39Z", "creator": "kiwiwings@apache.org", "creation_time": "2016-03-05T20:51:39Z", "is_private": false}, {"count": 3, "tags": [], "creator": "dtn-asfbugs@corefiling.co.uk", "attachment_id": null, "is_private": false, "id": 189158, "time": "2016-03-05T20:55:59Z", "bug_id": 59128, "creation_time": "2016-03-05T20:55:59Z", "text": "Sorry, I should have made it clear how I arrived at raising this bug.\n\nWith the following JARs on its classpath:\n\npoi-3.14-20160307.jar\npoi-ooxml-3.14-20160307.jar\npoi-ooxml-schemas-3.14-20160307.jar\nxmlbeans-2.3.0.jar\n\n\nThe following piece of code:\n\nnew XSSFWorkbook();\n\n\nFails with a stack trace:\n\nException in thread \"main\" java.lang.NoSuchMethodError: org.apache.xmlbeans.XmlOptions.setLoadEntityBytesLimit(I)Lorg/apache/xmlbeans/XmlOptions;\n\tat org.apache.poi.POIXMLTypeLoader.<clinit>(POIXMLTypeLoader.java:50)\n\tat org.openxmlformats.schemas.spreadsheetml.x2006.main.CTWorkbook$Factory.newInstance(Unknown Source)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.onWorkbookCreate(XSSFWorkbook.java:425)\n\nLooking at the commits on POIXMLTypeLoader suggests that the fix to 58617 means we do now require XMLBeans 2.6.0 at runtime (or at any rate, one new enough to contain setLoadEntityBytesLimit, which 2.3.0 does not)."}, {"count": 4, "tags": [], "bug_id": 59128, "is_private": false, "text": "with my patch for ##57031 the dependency on xmloptions.setLoadEntityBytesLimit() will be obsolete, as jaxp will be used then, which already has this secure parsing feature ...", "id": 189159, "time": "2016-03-05T21:06:03Z", "creator": "kiwiwings@apache.org", "creation_time": "2016-03-05T21:06:03Z", "attachment_id": null}, {"count": 5, "text": "OK, in that case it looks like we can take no action and leave further work on this to bug 57031. Wontfixing again.", "bug_id": 59128, "is_private": false, "id": 189193, "time": "2016-03-07T08:32:26Z", "creator": "dtn-asfbugs@corefiling.co.uk", "creation_time": "2016-03-07T08:32:26Z", "tags": [], "attachment_id": null}]