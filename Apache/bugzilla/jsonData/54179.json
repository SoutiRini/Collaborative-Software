[{"count": 0, "tags": [], "creator": "mieszek2@interia.pl", "text": "Created attachment 29616\nsimple patch - to review, not to use\n\nWhen large message is logged by moddumpio message is divided in parts (MAX_STRING_LEN / 4 - 80 -> length of a message) and logged by ap_log_cerror() function. When message is divided its always logged from the beggining so part of a message is lost, example log(edited):\n\n mod_dumpio.c(63): [client 9.9.9.5:29835] mod_dumpio:  dumpio_out (data-HEAP): 204 bytes\n mod_dumpio.c(103): [client 9.9.9.5:29835] mod_dumpio:  dumpio_out (data-HEAP): HTTP/1.1 200 OK\\r\\nDate: Tue, 20 Nov 2012 09:49:33 GMT\\r\\nServer: WebSphere Application Server/6.1\\r\\nContent-Type: text/xml; charset=utf-8\\r\\nContent-Language: en-US\\r\\nContent-Length: 25709\\r\\nConnection: close\\r\\n\\r\\n\n mod_dumpio.c(161): [client 9.9.9.5:29835] mod_dumpio: dumpio_out\n mod_dumpio.c(63): [client 9.9.9.5:29835] mod_dumpio:  dumpio_out (data-TRANSIENT): 1163 bytes\n mod_dumpio.c(103): [client 9.9.9.5:29835] mod_dumpio:  dumpio_out (data-TRANSIENT): <?xml version=\"1.0\" encoding=\"utf-8\"?><soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"><soapenv:Body><message>part\n mod_dumpio.c(63): [client 9.9.9.5:29835] mod_dumpio:  dumpio_out (data-TRANSIENT): 4044 bytes\n mod_dumpio.c(103): [client 9.9.9.5:29835] mod_dumpio:  dumpio_out (data-TRANSIENT): //www.w3.org/2001/XMLSchema-instance\"><bigmessage>message part 1 .... </bigmessage\n mod_dumpio.c(103): [client 9.9.9.5:29835] mod_dumpio:  dumpio_out (data-TRANSIENT): //www.w3.org/2001/XMLSchema-instance\"><bigmessage>message part 1 .... </bigmessage\n mod_dumpio.c(103): [client 9.9.9.5:29835] mod_dumpio:  dumpio_out (data-TRANSIENT): //www.w3.org/2001/XMLSchema-instance\"><bigmessage>message part 1 .... </bigmessage\n\n\nmessage part 1 was logged 3 times, no message part 2 and 3 will be logged.\n\nProbable cause:\nap_log_cerror call in dumpit function shouldn't be made with &buf as a parameter because it will allways result in a message log made from the beggining of a message. Pointer to message passed to ap_log_cerror must be incremented by the value of previously logged message length. \n\nIm attaching patch which is working for us but it was not written by C proggramer so it shoutldn't be used :)", "id": 163571, "time": "2012-11-21T10:36:40Z", "bug_id": 54179, "creation_time": "2012-11-21T10:36:40Z", "is_private": false, "attachment_id": 29616}, {"count": 1, "tags": [], "bug_id": 54179, "text": "Thanks for the report.\n\nFixed in trunk, with a slightly different patch.\nhttp://svn.apache.org/viewvc?view=revision&sortby=date&revision=1412278\n\nThe idea is obviously the same, but I put the '+ logbytes' outside of the #if/#else/#endif because the issue is the same on the other branch.\nI also made some small cosmetic changes.\n\n\nI'll propose it for backport to 2.4.x in 1 week or so if nobody complains.", "id": 163584, "time": "2012-11-21T20:59:43Z", "creator": "christophe.jaillet@wanadoo.fr", "creation_time": "2012-11-21T20:59:43Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 54179, "attachment_id": null, "text": "thx, patch works for me :)", "id": 163599, "time": "2012-11-22T13:02:00Z", "creator": "mieszek2@interia.pl", "creation_time": "2012-11-22T13:02:00Z", "is_private": false}, {"count": 3, "attachment_id": null, "bug_id": 54179, "is_private": false, "id": 165615, "time": "2013-03-03T16:53:40Z", "creator": "sf@sfritsch.de", "creation_time": "2013-03-03T16:53:40Z", "tags": [], "text": "fixed in 2.4.4"}]