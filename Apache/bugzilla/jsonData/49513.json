[{"count": 0, "attachment_id": 25651, "creator": "jks@iname.com", "is_private": false, "id": 137956, "time": "2010-06-28T17:27:17Z", "bug_id": 49513, "creation_time": "2010-06-28T17:27:17Z", "tags": [], "text": "Created attachment 25651\nPatch to fix the problem\n\nMy computer has a 192.168.x.x IP.  It also has a vibr0 bridge with an ip of 192.168.122.1.  As it happens when HostInfo tries to find the \"best\" ip to use for hostname setting purposes it find vibr0 first, and I end up with DOMAIN set to \"168.122.1\" and NAME set to \"192\""}, {"count": 1, "attachment_id": null, "creator": "jkf@apache.org", "is_private": false, "id": 139539, "time": "2010-08-29T04:11:43Z", "bug_id": 49513, "creation_time": "2010-08-29T04:11:43Z", "tags": [], "text": "getLocalHost() is only specified to return an address of the machine. There is no reason that in general the one or the other address selected by this method is better than any other address available on the system. While in your case apparently the selected address of getLocalHost is \"better\" there is no guarantee that this is the case for others, or will remain true in the future.\n\nPlease also see http://stackoverflow.com/questions/901755/how-to-get-the-ip-of-the-computer-on-linux-through-java for a more elaborate explanation."}, {"count": 2, "tags": [], "creator": "jks@iname.com", "attachment_id": 25958, "is_private": false, "id": 139542, "time": "2010-08-29T13:30:47Z", "bug_id": 49513, "creation_time": "2010-08-29T13:30:47Z", "text": "Created attachment 25958\nSecond patch\n\nThis patch also prefers ip addresses with a hostname, and if the best ip address ends up not having a hostname doesn't set the host and domain to \"1\" and \"2.3.4\" which does not make any sense."}, {"count": 3, "tags": [], "bug_id": 49513, "attachment_id": null, "text": "In my ex(In reply to comment #1)\n> getLocalHost() is only specified to return an address of the machine. There is\n> no reason that in general the one or the other address selected by this method\n> is better than any other address available on the system. While in your case\n> apparently the selected address of getLocalHost is \"better\" there is no\n> guarantee that this is the case for others, or will remain true in the future.\n> \n> Please also see\n> http://stackoverflow.com/questions/901755/how-to-get-the-ip-of-the-computer-on-linux-through-java\n> for a more elaborate explanation.\n\nIn my experience what getLocalHost() returns is consistent with what `hostname` returns on Linux machines.", "id": 139543, "time": "2010-08-29T13:32:40Z", "creator": "jks@iname.com", "creation_time": "2010-08-29T13:32:40Z", "is_private": false}, {"count": 4, "tags": [], "creator": "jkf@apache.org", "attachment_id": null, "is_private": false, "id": 139548, "time": "2010-08-29T17:15:33Z", "bug_id": 49513, "creation_time": "2010-08-29T17:15:33Z", "text": "I've modified the sources according to the following specification:\n\nIf two addresses have the same scope, the address with a hostname prevails over the address without a hostname attached.\n\nFor local lookup, no IP address will be put anymore in NAME / DOMAIN.\n\nFor remote lookup, if a host name was provided and only an IP address is found, the IP address will no longer overwrite the host name provided to the task.\n\nCommitted to revision 990653: http://svn.apache.org/viewvc?rev=990653&view=rev\nDiff: http://svn.apache.org/viewvc/ant/core/trunk/src/main/org/apache/tools/ant/taskdefs/HostInfo.java?rev=990653&r1=990652&r2=990653&view=diff"}]