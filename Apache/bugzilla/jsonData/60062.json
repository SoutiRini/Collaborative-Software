[{"count": 0, "tags": [], "bug_id": 60062, "text": "Summary\n=============\n\nIn JUnitTestRunner.run(), when a class fails to initialize properly during the initial Class.forName(), the class is assumed to be a failed test and is reported as such even when skipNonTests is set.\n\nThis causes false error reports for classes that are not actual tests. This is especially noticeable when using wildcards in <batchtest> when classes that subclass JavaFX are present.\n\nCause/Example\n=============\n\nExample:\n---------\npublic class MyControl extends javafx.scene.control.Control\n{\n}\n---------\n\nWhen JUnitTestRunner tests this class, it attempts a Class.forName(), which then fails with:\n----------------\njava.lang.ExceptionInInitializerError\n\tat java.lang.Class.forName0(Native Method)\n\tat java.lang.Class.forName(Class.java:264)\n\tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:377)\n\tat ant_fx_test.MyTest.main(MyTest.java:31)\nCaused by: java.lang.IllegalStateException: Toolkit not initialized\n\tat com.sun.javafx.application.PlatformImpl.runLater(PlatformImpl.java:273)\n\tat com.sun.javafx.application.PlatformImpl.runLater(PlatformImpl.java:268)\n\tat com.sun.javafx.application.PlatformImpl.setPlatformUserAgentStylesheet(PlatformImpl.java:550)\n\tat com.sun.javafx.application.PlatformImpl.setDefaultPlatformUserAgentStylesheet(PlatformImpl.java:512)\n\tat javafx.scene.control.Control.<clinit>(Control.java:87)\n\t... 4 more\n---------------\n\nThe cause is static block in javafx.scene.control.Control that eventually throws an exception preventing the Class.forName() from completing.\n\nThe skipNonTests option has no effect as it is not checked until the class was initialized properly.\n\nThe issue of the static initializer in JavaFX has been reported here https://bugs.openjdk.java.net/browse/JDK-8102211 as fixed, with no indication that it was ever actually \"fixed\".\n\nWorkaround\n=============\nExclude the classes on a per name basis.\n\n\nRequested Enhancement\n=====================\nA configuration option to ignore classes that fail initialization.", "id": 193382, "time": "2016-08-29T01:32:11Z", "creator": "glen.a.ritchie@gmail.com", "creation_time": "2016-08-29T01:32:11Z", "is_private": false, "attachment_id": null}]