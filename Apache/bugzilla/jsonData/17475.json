[{"count": 0, "tags": [], "bug_id": 17475, "attachment_id": null, "text": "If I use Methode removeSheetAt on a sheet which contains a diagram, Excel 2000 \nSR-1 crashed when opening the modified file.\n\nThe original Excel file is a simple book created from scratch. It contains two \nsheets, each containing one simple line diagram.\n\nThe code to read, modify and write the file is as follows:\n\nHSSFWorkbook book = new HSSFWorkbook(new FileInputStream(path));\nbook.removeSheetAt(0);\nFileOutputStream fOut = new FileOutputStream(path);\nbook.write(fOut);\nfOut.close();\n\nThe POI version I use is\njakarta-poi-1.11.0-dev-20030225.jar", "id": 32071, "time": "2003-02-27T11:32:26Z", "creator": "ndz43wv02@sneakemail.com", "creation_time": "2003-02-27T11:32:26Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 17475, "attachment_id": null, "text": "Upload the excel file as well as providing a small piece of code that uses the \ntemplate to generate the error.", "id": 32111, "time": "2003-02-27T21:11:41Z", "creator": "jheight@apache.org", "creation_time": "2003-02-27T21:11:41Z", "is_private": false}, {"count": 2, "text": "Created attachment 5118\nExcel file for reproducing the bug", "bug_id": 17475, "attachment_id": 5118, "id": 32326, "time": "2003-03-03T14:30:49Z", "creator": "ndz43wv02@sneakemail.com", "creation_time": "2003-03-03T14:30:49Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "creator": "ndz43wv02@sneakemail.com", "attachment_id": null, "id": 32327, "time": "2003-03-03T14:37:15Z", "bug_id": 17475, "creation_time": "2003-03-03T14:37:15Z", "is_private": false, "text": "/*\nThe following code produces a corrupt(?) excel file by modifying the attached \ntemplate file (using jakarta-poi-1.11.0-dev-20030225.jar).\n\nNote: When opening the resulting \"out.xls\", Excel does not crash immediately, \nbut behaves strangely. I cannot select the sheet, the diagram is empty. If I \ntry to change the diagram's source fields, Excel crashes.\n*/\n\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\n\nimport org.apache.poi.hssf.usermodel.HSSFWorkbook;\n\npublic class SimpleExcelTest {\n\tpublic static void main(String[] args) throws Exception {\n\t\tHSSFWorkbook book = new HSSFWorkbook(new FileInputStream\n(\"template.xls\"));\n\t\t\n\t\tbook.removeSheetAt(0);\n\t\n\t\tFileOutputStream fOut = new FileOutputStream(\"out.xls\");\n\t\tbook.write(fOut);\n\t\tfOut.close();\n\t}\n}\n"}, {"count": 4, "text": "complicated.  put off till 3.0.", "bug_id": 17475, "attachment_id": null, "id": 41351, "time": "2003-07-24T15:50:32Z", "creator": "poi-support@buni.org", "creation_time": "2003-07-24T15:50:32Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "bug_id": 17475, "attachment_id": null, "text": "The problem is not reproducible with the latest trunk.  \n\nPlease try the latest svn version .\nDaily builds are available at\nhttp://encore.torchbox.com/poi-svn-build/\n\nRegards,\nYegor", "id": 126342, "time": "2009-04-17T11:32:19Z", "creator": "yegor@dinom.ru", "creation_time": "2009-04-17T11:32:19Z", "is_private": false}]