[{"count": 0, "tags": [], "bug_id": 17888, "attachment_id": null, "id": 32976, "time": "2003-03-11T17:56:21Z", "creator": "jimeng@ameritech.net", "creation_time": "2003-03-11T17:56:21Z", "is_private": false, "text": "I am trying to run tomcat 4.1.18 with new installs of ant 1.5.2 and j2sdk\n1.4.1_02.  I keep getting errors.  When trying to run a webapp on Tomcat, I\nget the following error messages from ANT:\n\nUnable to find a javac compiler;\ncom.sun.tools.javac.Main is not on the classpath.\nPerhaps JAVA_HOME does not point to the JDK\n        at org.apache.tools.ant.taskdefs.compilers.CompilerAdapterFactory.getCom\npiler(CompilerAdapterFactory.java:139)\n        at org.apache.tools.ant.taskdefs.Javac.compile(Javac.java:833)\n        at org.apache.tools.ant.taskdefs.Javac.execute(Javac.java:682)\n\nThis is followed by other error messages up the call-chain.  JAVA_HOME is\ndefined as C:\\j2sdk1.4.1_02, which is correct.  Also C:\\j2sdk1.4.1_02\\bin has\nbeen added to the path variable (as has %ANT_HOME%\\bin).\n\nIt seems that Tomcat invokes Jasper to compile something when starting a webapp\n(in this case, the examples page -- index.jsp) and Jasper calls Ant, which\ngenerates the first error message saying it can't find javac. Ant's\nCompilerAdapterFactory class uses a number of tests to determine the compiler in\nuse.  The doesModernCompilerExist method is supposed to distinguish between sun\njavac before 1.3 and after (I think).  Running j2sdk 1.4.1_02, I compiled and\nran the following code (which does the same test as doesModernCompilerExist):\n\nclass TestComp \n{   \n  public static void main(String[] arguments)\n  {\n\n     try {\n            Class.forName(\"com.sun.tools.javac.Main\");\n            System.out.println(\"found com.sun.tools.javac.Main\");\n        } \n        catch (ClassNotFoundException cnfe) {\n            System.out.println(\"did not find com.sun.tools.javac.Main\");\n\n        }\n  }\n}\n\n\nThe output from this is \"did not find com.sun.tools.javac.Main\".  I tested this\non j2sdk 1.4.0_03 with the same result.  \n\nInitially I thought this might be a problem in Ant and I filed a bugzilla report\nwith them (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=17857).  That was\nanswered by Conor MacNeill, who said:\n\nYou should probably raise this on the tomcat bugZilla. I'm not really sure how\nthe Tomcat folks have configured Jasper to use Ant's javac task. The most\nobvious thing to check is that tools.jar is available in the classpath whereever\nTomcat expects it to be  since it contains the compiler classes.\n\nI have found that tools.jar is in <JAVA_HOME>\\lib, which seems to be correct.      \n\nThis may not be an Tomcat bug, but I've tried lots of things and I'm hoping you\nhave a suggestion.\n\nThanks.\n\nJim"}, {"count": 1, "tags": [], "creator": "jimeng@ameritech.net", "attachment_id": 5271, "text": "Created attachment 5271\nFull report of errors from Tomcat", "id": 32977, "time": "2003-03-11T17:57:03Z", "bug_id": 17888, "creation_time": "2003-03-11T17:57:03Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 17888, "is_private": false, "text": "The conditions are:\n- you need to have JAVA_HOME set before running the Tomcat installer, or a\nrecent Sun JDK must have been previously installed (and you must not move it)\n- %JAVA_HOME%/lib/tools.jar must exist\n\nIf you do that, it will work. Sorry, but there's no really clean way to handle\nthis ...\nAs a workaround, copy tools.jar to common/lib.", "id": 35335, "time": "2003-04-16T15:25:04Z", "creator": "remm@apache.org", "creation_time": "2003-04-16T15:25:04Z", "attachment_id": null}]