[{"count": 0, "tags": [], "text": "I'm using batik1.6 and I have found an problem.\nDOMException occurs at SVGStylable#PresentationAttributePaintValue.getValue\nHere is an example.\n\n[svg test1.svg]\n<svg width=\"500\" height=\"300\" viewBox=\"0 0 500 300\" >\n    <rect x=\"40\" y=\"20\" width=\"400\" height=\"200\" style=\"fill:blue; stroke:gray; \nstroke-width:0.5;\" />\n</svg>\n\n[test code BatikDomTest.java]\nimport org.w3c.dom.*;\nimport org.w3c.dom.svg.*;\nimport org.w3c.dom.css.*;\nimport java.io.File;\nimport org.apache.batik.dom.svg.SAXSVGDocumentFactory;\nimport org.apache.batik.util.XMLResourceDescriptor;\nimport org.apache.batik.bridge.UserAgent;\nimport org.apache.batik.bridge.UserAgentAdapter;\nimport org.apache.batik.bridge.DocumentLoader;\nimport org.apache.batik.bridge.BridgeContext;\nimport org.apache.batik.bridge.GVTBuilder;\n\n\n/** Sample Test code */\nclass BatikDomTest {\n\tString[] cssSample = {\"stroke\",\"fill\",\"stroke-dasharray\",\"writing-\nmode\",\"letter-spacing\"};\n\n\tpublic static void main(String[] ar) throws Exception{\n\t\tBatikDomTest test = new BatikDomTest();\n\t\ttest.test1();\n\t}\n\n\tpublic SVGDocument parseSVG(String path) throws Exception {\n\t    String parser = XMLResourceDescriptor.getXMLParserClassName();\n\t    SAXSVGDocumentFactory f = new SAXSVGDocumentFactory(parser);\n\t\tSVGDocument svgDoc = f.createSVGDocument(new File(path).toURL\n().toExternalForm());\n       UserAgent      userAgent;\n        DocumentLoader loader;\n        BridgeContext  ctx;\n        GVTBuilder     builder;\n        \n        userAgent = new UserAgentAdapter();\n        loader    = new DocumentLoader(userAgent);\n        ctx       = new BridgeContext(userAgent, loader);\n        ctx.setDynamicState(BridgeContext.DYNAMIC);\n        builder   = new GVTBuilder();\n        builder.build(ctx, svgDoc);\n\t\treturn svgDoc;\n\t}\n\n\tprivate void test1() throws Exception{\n\t\tSVGDocument doc = parseSVG(\"test1.svg\");\n\t\t\n\t\tElement root = doc.getDocumentElement();\n\t\tNodeList list = root.getChildNodes();\n\t\tfor(int i=0;i<list.getLength();i++){\n\t\t\tNode node = list.item(i);\n\t\t\tif(node instanceof SVGRectElement){\n\t\t\t\tdoRect((SVGRectElement)node);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate void doRect(SVGRectElement rect){\n\t\tdumpCss(rect);\n\t}\n\n\tprivate void dumpCss(SVGStylable stylable){\n\t\tCSSStyleDeclaration css = null;\n\t\tcss = stylable.getStyle();\n\t\tif(css != null){\n\t\t\tint len = cssSample.length;\n\t\t\tfor(int i=0;i<len;i++){\n\t\t\t\tString key = cssSample[i];\n\n\t\t\t\t// DOM Exception !\n\t\t\t\tCSSValue cssValue = \nstylable.getPresentationAttribute(key);\n\t\t\t\tif(cssValue != null){\n\t\t\t\t\tSystem.out.println\n(key+\":\"+cssValue.getCssText());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\n[result]\nException in thread \"main\" org.w3c.dom.DOMException:\n        at \norg.apache.batik.dom.svg.SVGStylableElement$PresentationAttributePaintValue.getV\nalue(SVGStylableElement.java:468)\n        at org.apache.batik.css.dom.CSSOMSVGColor.getCssText\n(CSSOMSVGColor.java:98)\n        at BatikDomTest.dumpCss(BatikDomTest.java:69)\n        at BatikDomTest.doRect(BatikDomTest.java:55)\n        at BatikDomTest.test1(BatikDomTest.java:49)\n        at BatikDomTest.main(BatikDomTest.java:20)", "is_private": false, "bug_id": 36570, "id": 79705, "time": "2005-09-09T09:08:15Z", "creator": "nakamura@zyuon.co.jp", "creation_time": "2005-09-09T09:08:15Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 36570, "text": "You are using getPresentationAttribute(), but your element does not have any\npresentation attributes, it has a style=\"\" attribute that sets some properties.\n If instead your document were:\n\n  <svg xmlns=\"http://www.w3.org/2000/svg\"\n       width=\"500\" height=\"300\" viewBox=\"0 0 500 300\">\n    <rect x=\"40\" y=\"20\" width=\"400\" height=\"200\"\n          fill=\"blue\" stroke=\"gray\" stroke-width=\"0.5\"/>\n  </svg>\n\nthen the program should work.\n\nBatik's behaviour isn't strictly correct, since a getPresentationAttribute()\ncall when there is no corresponding presentation attribute set on the element\nshould return null.  This is now fixed in SVN.", "id": 108523, "time": "2007-09-24T04:03:51Z", "creator": "cam@apache.org", "creation_time": "2007-09-24T04:03:51Z", "is_private": false, "attachment_id": null}]