[{"count": 0, "tags": [], "bug_id": 40113, "text": "I download the svn trunk today of the Lenya 1.4 and I tried again to run the\nbuild for Tomcat deploy but it fails with following error\n\nprepare-modules:\nProcessing C:\\marquis1\\lenya1.4_2607\\lenya-1.4.x\\build\\lenya\\temp\\modules.xml to\n C:\\marquis1\\lenya1.4_2607\\lenya-1.4.x\\build\\lenya\\temp\\modules-build.xml\nLoading stylesheet C:\\marquis1\\lenya1.4_2607\\lenya-1.4.x\\src\\resources\\build\\mod\nules2build.xsl\nC:/marquis1/lenya1.4_2607/lenya-1.4.x/src/resources/build/modules2build.xsl:66:1\n09: Warning! Can not load requested doc: Programmer's Error!  putDocumentInCache\n found reparse of doc: file:///C:/marquis1/lenya1.4_2607/lenya-1.4.x/src/modules\n/bxe/module.xml\nC:/marquis1/lenya1.4_2607/lenya-1.4.x/src/resources/build/modules2build.xsl:66:1\n09: Warning! Can not load requested doc: Programmer's Error!  putDocumentInCache\n found reparse of doc: file:///C:/marquis1/lenya1.4_2607/lenya-1.4.x/src/modules\n/cforms/module.xml\n..............................................................\n98: Warning! Can not load requested doc: Programmer's Error!  putDocumentInCache\n found reparse of doc: file:///C:/marquis1/lenya1.4_2607/lenya-1.4.x/src/pubs/de\nfault/modules/defaultusecases/module.xml\nC:/marquis1/lenya1.4_2607/lenya-1.4.x/src/resources/build/modules2build.xsl:106:\n98: Warning! Can not load requested doc: Programmer's Error!  putDocumentInCache\n found reparse of doc: file:///C:/marquis1/lenya1.4_2607/lenya-1.4.x/src/pubs/de\nfault/modules/homepage/module.xml\nProcessing C:\\marquis1\\lenya1.4_2607\\lenya-1.4.x\\build\\lenya\\temp\\modules.xml to\n C:\\marquis1\\lenya1.4_2607\\lenya-1.4.x\\build\\lenya\\temp\\modules.xconf\nLoading stylesheet C:\\marquis1\\lenya1.4_2607\\lenya-1.4.x\\src\\resources\\build\\mod\nules2patch.xsl\nProcessing: C:\\marquis1\\lenya1.4_2607\\lenya-1.4.x\\build\\lenya\\temp\\modules.xconf\n\nWriting: C:\\marquis1\\lenya1.4_2607\\lenya-1.4.x\\build\\lenya\\webapp\\WEB-INF\\cocoon\n.xconf\n\nBUILD FAILED\nC:\\marquis1\\lenya1.4_2607\\lenya-1.4.x\\src\\targets\\webapp-build.xml:163: The foll\nowing error occurred while executing this line:\nC:\\marquis1\\lenya1.4_2607\\lenya-1.4.x\\src\\targets\\modules-build.xml:66: The foll\nowing error occurred while executing this line:\nSyntax Error: Depend attribute for target \"patch-modules-test\" has an empty stri\nng for dependency.", "id": 91603, "time": "2006-07-26T11:59:47Z", "creator": "midha.rakesh@gmail.com", "creation_time": "2006-07-26T11:59:47Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 40113, "attachment_id": null, "id": 91648, "time": "2006-07-27T07:18:00Z", "creator": "oliver.schalch@wyona.com", "creation_time": "2006-07-27T07:18:00Z", "is_private": false, "text": "I've just tried to compile latest trunk without having any errors on Windows\nPlattform."}, {"count": 2, "attachment_id": null, "bug_id": 40113, "is_private": false, "id": 91649, "time": "2006-07-27T08:03:02Z", "creator": "michael@wohlfart.net", "creation_time": "2006-07-27T08:03:02Z", "tags": [], "text": "this is strange, \ni had problems with JDK 1.5 on XP some days ago \nand patched a patch for that which hasn't been integrated \nyet as far as i know :-/\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=34191"}, {"attachment_id": null, "tags": [], "bug_id": 40113, "is_private": false, "count": 3, "id": 91659, "time": "2006-07-27T15:53:05Z", "creator": "thorsten@apache.org", "creation_time": "2006-07-27T15:53:05Z", "text": "The zones server is buiding fine as well. \n\nPlease make a backup copy of your local.build.properties and create a new on\nbased on the build.properties aka\ncp local.build.properties local.build.properties.bck\ncp build.properties local.build.properties\n\nI can remember having to do this on the zones server.\nhttp://lenya.zones.apache.org:9999"}, {"count": 4, "tags": [], "text": "I can reproduce this error on two different winXP/JDK1.5 machines,\nseems like a windows problem in the modules2build.xsl stylesheet.\n\nFumbling with local.build.properties doesn't help me at all.\n\nIn modules2build.xsl there are two Variables generated:\ncompileDependencyList and testDependencyList, both are compiled in \nsimilar for-each loops containing a select=\"document(..)\" expression\nhowever in the second loop the document() doesn't return any xml \nfragment. \nI changed the order of the for-each loops, it seems to be always the \nsecond call to document() with the same file that doesn't work :-/\n\nsomeone seen something similar, i have no clue what's going wrong here.", "is_private": false, "bug_id": 40113, "id": 91918, "time": "2006-08-05T19:51:17Z", "creator": "michael@wohlfart.net", "creation_time": "2006-08-05T19:51:17Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 40113, "attachment_id": 18680, "id": 91919, "creation_time": "2006-08-05T20:26:31Z", "time": "2006-08-05T20:26:31Z", "creator": "michael@wohlfart.net", "text": "Created attachment 18680\npatch for src/targets/modules-build.xml\n\nadding the xslt transformer factory seems to solve this issue,\nlooks like i got the wrong transformer in my environment\n\ncan someone please review and commit my patch", "is_private": false}, {"count": 6, "tags": [], "creator": "mangst@inventec.ch", "text": "I have the exact same problem (Windows XP Java 1.5.0_06 or 1.5.0_08) and\nMichael's patch works for me. Thanks!", "id": 92742, "time": "2006-08-30T16:49:05Z", "bug_id": 40113, "creation_time": "2006-08-30T16:49:05Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 40113, "attachment_id": null, "text": "is this still an issue?\ni have no clue about the build system and running on windows/tomcat - maybe\nsomeone else can look into it?\nin any case, this does not look like a lenya bug to me.", "id": 94005, "time": "2006-09-22T13:19:41Z", "creator": "nettings@apache.org", "creation_time": "2006-09-22T13:19:41Z", "is_private": false}, {"count": 8, "attachment_id": null, "bug_id": 40113, "is_private": false, "id": 94049, "time": "2006-09-24T18:36:56Z", "creator": "andreas@apache.org", "creation_time": "2006-09-24T18:36:56Z", "tags": [], "text": "I committed the patch, thanks a lot!\nI doubt this is a Lenya bug as well, but nevertheless we need the workaround."}, {"attachment_id": null, "tags": [], "bug_id": 40113, "text": "The build has been failing for me on Java 1.4/WinXP ever since this patch was\ncommitted several months ago, and I just noticed it again after doing a fresh\ncheckout.\n\nIf I revert this patch then Lenya builds with no problems.\n\nMore info here:\nhttp://marc.theaimsgroup.com/?l=lenya-dev&m=115929860901491&w=2", "count": 9, "id": 99136, "time": "2007-02-08T14:20:44Z", "creator": "jonathan.addison@wyona.com", "creation_time": "2007-02-08T14:20:44Z", "is_private": false}, {"count": 10, "tags": [], "bug_id": 40113, "attachment_id": null, "id": 102050, "creation_time": "2007-04-23T00:53:52Z", "time": "2007-04-23T00:53:52Z", "creator": "andreas@apache.org", "text": "What should we do here? Any hints?", "is_private": false}, {"count": 11, "tags": [], "text": "Back in August 2006 I debugged this and came to the same conclusion as Michael\nWohlfahrt in comment #4. The patch has fixed this for me under Windows XP and\nJava 1.5 / 1.6 (but according to comment #9 it seems to be broken for other\npeople now...).", "is_private": false, "bug_id": 40113, "id": 102148, "time": "2007-04-23T13:24:47Z", "creator": "mangst@inventec.ch", "creation_time": "2007-04-23T13:24:47Z", "attachment_id": null}, {"count": 12, "tags": [], "text": "if i interpret that workaround correctly, it is a bug in the default\ntransformer,        not in lenya. still, a workaround would make sense, but it\nshould not be a blocker bug.\ncan the people who were seeing problems please confirm:\n* you have been building for tomcat like the original poster\n* you were having the same issues, and the patch fixes it for you, or\n* you were not having issues, and the patch broke things (jonathan, you seem to\nbe the only one for whom the patch does not work, 2 people report success. tell\nyour problem to be a good democrat and go away!)\n\n", "is_private": false, "bug_id": 40113, "id": 102217, "time": "2007-04-24T03:59:54Z", "creator": "nettings@apache.org", "creation_time": "2007-04-24T03:59:54Z", "attachment_id": null}, {"count": 13, "attachment_id": null, "creator": "mangst@inventec.ch", "text": "> can the people who were seeing problems please confirm:\n>\n> * you have been building for tomcat like the original poster\n\nNo, sorry, I have been building for Jetty. Doesn't seem to make a difference.\n\n> * you were having the same issues, and the patch fixes it for you\n\nYes.  (see comments #6 and #11)\n", "id": 102233, "time": "2007-04-24T07:13:36Z", "bug_id": 40113, "creation_time": "2007-04-24T07:13:36Z", "tags": [], "is_private": false}, {"count": 14, "tags": [], "bug_id": 40113, "attachment_id": null, "is_private": false, "id": 102236, "time": "2007-04-24T07:34:35Z", "creator": "jonathan.addison@wyona.com", "creation_time": "2007-04-24T07:34:35Z", "text": "Actually I am not the only one who experienced problems, as you can see by\nreading the link I posted in comment #9.\n\nI just tried again with a fresh checkout and received the same error as before:\n\nprepare-modules:\nProcessing C:\\src\\lenya-1.4.x\\build\\lenya\\temp\\modules.xml to\nC:\\src\\lenya-1.4.x\\build\\lenya\\temp\\modules-build.xml\nLoading stylesheet C:\\src\\lenya-1.4.x\\src\\resources\\build\\modules2build.xsl\n: Error! null\n: Fatal Error! Could not compile stylesheet\nFailed to process C:\\src\\lenya-1.4.x\\build\\lenya\\temp\\modules.xml\n\nBUILD FAILED\nC:\\src\\lenya-1.4.x\\src\\targets\\webapp-build.xml:168: The following error\noccurred while executing this line:\nC:\\src\\lenya-1.4.x\\src\\targets\\modules-build.xml:42: Fatal error during\ntransformation\n\n\nCommenting out this line in modules-build.xml fixes the problem:\n<!--<factory name=\"org.apache.xalan.xsltc.trax.TransformerFactoryImpl\" />-->\n\nI am using Java 1.4/WinXP.\n\nI have tried with both Tomcat and Jetty, but it does not matter since the error\noccurs during the build process."}, {"attachment_id": 20033, "tags": [], "bug_id": 40113, "is_private": false, "count": 15, "id": 102273, "time": "2007-04-24T19:50:53Z", "creator": "josias.thoeny@wyona.org", "creation_time": "2007-04-24T19:50:53Z", "text": "Created attachment 20033\npatch for module build process\n\nI can confirm the problem that Jonathan reported (java 1.4 on WinXP).\n\nThe proposed patch is a workaround, it changes the build process for modules in\na way that the xsl document() function is never used more than once for each\nmodule. \nIt adds an intermediate step to the build process which aggregates all module\nconfig files into the file build/lenya/temp/modules-config.xml, and then feeds\nthis file to modules2build.xsl.\n\nI tested this with java1.4/WinXP, java5/WinXP, java1.4/Linux and it seemed to\nwork."}, {"count": 16, "tags": [], "bug_id": 40113, "text": "I'd consider this a blocker, and we should definitely apply the patch before\nreleasing RC1.", "id": 102286, "time": "2007-04-25T02:26:17Z", "creator": "andreas@apache.org", "creation_time": "2007-04-25T02:26:17Z", "is_private": false, "attachment_id": null}, {"count": 17, "attachment_id": null, "creator": "nettings@apache.org", "is_private": false, "id": 102483, "time": "2007-04-26T07:32:06Z", "bug_id": 40113, "creation_time": "2007-04-26T07:32:06Z", "tags": [], "text": "*** Bug 40017 has been marked as a duplicate of this bug. ***"}, {"count": 18, "attachment_id": null, "creator": "nettings@apache.org", "is_private": false, "id": 105320, "time": "2007-07-12T06:41:23Z", "bug_id": 40113, "creation_time": "2007-07-12T06:41:23Z", "tags": [], "text": "ok, we're trying to debug this one. iiuc:\n\n* originally, we did not have a <factory/> entry that explicitly declares a\ntransformer.\n* the build failed for people on windows with java 1.5+\n* the <factory/> was added.\n* now the build fails for people using java 1.4.x\n* building on linux/jkd1.5 works both with and without the factory.\n\njosias has identified a likely bug in the document() function of the xslt\nprocessor (which surfaces only under windows), that will return an empty node\nset if document() is called twice on the same document within an xslt.\n\nhis patch introduces an intermediate processing stage that works around the issue.\n\ni have committed the patch now for easier testing. please report.\n\nthis is not a lenya bug, and it should not block an RC, hence i'm downgrading it. "}, {"count": 19, "tags": [], "bug_id": 40113, "attachment_id": null, "is_private": false, "id": 105323, "time": "2007-07-12T07:12:54Z", "creator": "nettings@apache.org", "creation_time": "2007-07-12T07:12:54Z", "text": "j\u00fcrgen ragaller reports success with josias' patch on winxp running java1.6.\nmartin ginter just compiled it successfully on winxp with jdk 1.4.2-2.\n\n"}, {"count": 20, "tags": [], "bug_id": 40113, "text": "This patch works for me as well on WinXP/Java 1.4.2_08.\n\nThanks Josias!", "id": 105332, "time": "2007-07-12T08:26:16Z", "creator": "jonathan.addison@wyona.com", "creation_time": "2007-07-12T08:26:16Z", "is_private": false, "attachment_id": null}, {"count": 21, "tags": [], "creator": "nettings@apache.org", "text": "martin has also tried with java 1.5 on his winxp box, and it also works. i'm\nclosing this one, please reopen if you run into problems. thanks josias for the\nworkaround!\n\n", "id": 105337, "time": "2007-07-12T09:09:13Z", "bug_id": 40113, "creation_time": "2007-07-12T09:09:13Z", "is_private": false, "attachment_id": null}, {"count": 22, "attachment_id": null, "creator": "thorsten@apache.org", "is_private": false, "id": 105443, "time": "2007-07-16T01:58:31Z", "bug_id": 40113, "creation_time": "2007-07-16T01:58:31Z", "tags": [], "text": "Renaming Lenya 1.4 to 2.0"}]