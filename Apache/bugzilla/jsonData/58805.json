[{"count": 0, "tags": [], "bug_id": 58805, "is_private": false, "id": 187393, "creation_time": "2016-01-05T14:13:26Z", "time": "2016-01-05T14:13:26Z", "creator": "thomas.schwery@gmail.com", "text": "Created attachment 33407\nInput file with header and footer tests\n\nThe header and footer of doc documents can become corrupted and either crash Word or present wrong header and footers in the resulting document when runs have their text replaced.\n\nThe attached document is used as a template by the following code that will replace placeholders with a new text content :\n\n        HWPFDocument doc = new HWPFDocument(new FileInputStream(tstFile));\n        \n        Range oRange = doc.getHeaderStoryRange();\n        for (int i = 0; i < oRange.numCharacterRuns(); i++) {\n            CharacterRun run = oRange.getCharacterRun(i);\n            run.replaceText(\"_TEST_\", \"This text is longer than the initial text. It goes on and on without interruption.\");\n        }\n        \n        FileOutputStream fos = new FileOutputStream(outFile);\n        doc.write(fos);\n        fos.close();\n\nThe resulting file displays only part of the text in the header and the footer is copied from the header and cannot be edited when opened in Word 2013. LibreOffice 5 displays a short text in the header and copies the table in the footer with only a small snippet of text.\nThe _TEST_ in the main part of the document is not replaced, which is as expected.", "attachment_id": 33407}]