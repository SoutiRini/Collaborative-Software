[{"count": 0, "tags": [], "creator": "gliu@actuate.com", "attachment_id": null, "id": 54707, "time": "2004-03-26T06:39:33Z", "bug_id": 27971, "creation_time": "2004-03-26T06:39:33Z", "is_private": false, "text": "There's a bug found while converting an SVG file to PDF file with some \nfunctionalities of linearGradient and object translation, using the FOP \nversion xml-fop_20040318232912.tar.gz\n\nThe source SVG file contains two rect shapes, one is located from the origin, \nanother is translated for some distance. Both of them are employed with a same \nlinearGradient, names \"linearGradient1\", which is defined based on the origin \nof the SVG coordinate. However, in the converted PDF file, the translated rect \nobject just displays a single color (the second stop color of the \nlinearGradient), while the un-translated rect object displays normally.\nWe found the root cause of this issue maybe the improper concatinating \ntransformations implemented in the ApplyPaint() function of the class \norg.apache.fop.svg.PDFGraphics2D, omitting a necessary concatinating transform:\n=============================\n//MultipleGradientPaint.CycleMethodEnum cycenum = gp.getCycleMethod();\n            //boolean cyclic = (cycenum == MultipleGradientPaint.REPEAT);\n            AffineTransform transform = graphicsState.getTransform();\n            transform.concatenate(gp.getTransform());\n            transform.concatenate(getTransform()); ///Here the fixing\n=============================\n\nThe sample of SVG file is attached as below:\n===================================================================\n<?xml version=\"1.0\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n\"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg width=\"800\" height=\"600\" viewBox=\"0 0 800 600\"\nxmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\">\n<desc>Example lingrad01 - fill a rectangle using a\nlinear gradient paint server</desc>\n<g>\n<defs>\n<linearGradient x1=\"10\" gradientUnits=\"userSpaceOnUse\" x2=\"300\" y1=\"10\" \ny2=\"300\" id=\"linearGradient1\" spreadMethod=\"pad\">\n        <stop style=\"stop-opacity:1; stop-color:blue;\" offset=\"0%\" />\n        <stop style=\"stop-opacity:1; stop-color:green;\" offset=\"100%\" />\n</linearGradient>\n</defs>\n<!-- The rectangle is filled using a linear gradient paint server -->\n<rect x=\"10\" y=\"10\" width=\"290\" style=\"fill:url(#linearGradient1); \nstroke:none;\" height=\"290\" />\n<rect transform=\"translate(300,300)\" x=\"10\" y=\"10\" width=\"290\" style=\"fill:url\n(#linearGradient1); stroke:none;\" height=\"290\" />\n<rect x=\"0\" y=\"0\" height=\"600\" width=\"800\" style=\"stroke:red; fill:none\"/>\n</g>\n</svg>\n============================================================================"}, {"text": "Created attachment 11003\nThe converted PDF file from the given SVG file", "tags": [], "bug_id": 27971, "is_private": false, "count": 1, "id": 54708, "time": "2004-03-26T06:43:06Z", "creator": "gliu@actuate.com", "creation_time": "2004-03-26T06:43:06Z", "attachment_id": 11003}, {"count": 2, "tags": [], "text": "Thanks for finding this issue. Please could you submit your suggested change \nas a unified diff and attach (not copy and paste) it to this bug report. I \nwould also be grateful if you could attach the SVG (rather than copy and paste \ninto the text)\n\nThanks", "attachment_id": null, "id": 54715, "creation_time": "2004-03-26T09:12:21Z", "time": "2004-03-26T09:12:21Z", "creator": "bowditch_chris@hotmail.com", "bug_id": 27971, "is_private": false}, {"count": 3, "tags": [], "creator": "jeremias@apache.org", "attachment_id": null, "is_private": false, "id": 55220, "time": "2004-04-03T09:57:28Z", "bug_id": 27971, "creation_time": "2004-04-03T09:57:28Z", "text": "Looks good. Applied. But as Chris said, we'd be grateful if you sent a unified \ndiff against CVS next time. Thank you!"}, {"count": 4, "tags": [], "text": "batch transition pre-FOP1.0 resolved+fixed bugs to closed+fixed", "is_private": false, "bug_id": 27971, "id": 155559, "time": "2012-04-01T06:27:52Z", "creator": "gadams@apache.org", "creation_time": "2012-04-01T06:27:52Z", "attachment_id": null}]