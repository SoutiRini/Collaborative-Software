[{"count": 0, "tags": [], "creator": "kfujino@apache.org", "attachment_id": null, "is_private": false, "id": 139856, "time": "2010-09-14T03:23:07Z", "bug_id": 49924, "creation_time": "2010-09-14T03:23:07Z", "text": "If BackupManager is used,\nwhen a primary node is switched, \nDeltaSession#isPrimarySession is not changed to true. \n\nNon-primary node changes into a primary node \nwhen a primary node is stopped or we get a non-primary session. \n\nIf a primary node is stopped, a primary node is switched. \nIn AbstractReplicatedMap, when a primary node is switched, \nMapOwner(BackupManager)#objectMadePrimay is called. \nHowever, isPrimarySession does not change to true in this method. \n=====BackupManager#objectMadePrimay=====\npublic void objectMadePrimay(Object key, Object value) {\n    if (value!=null && value instanceof DeltaSession) {\n        DeltaSession session = (DeltaSession)value;\n        synchronized (session) {\n            session.access();\n            session.endAccess();\n        }\n    }\n}\n=====\n\nIf we get a non-primary session,  a primary node is switched. \nHowever, isPrimarySession does not change to true. \nIt is only a change of primary node.\n\nI made a patch.\nIt contains the following. \nisPrimarySession is set to true in BackupManager#objectMadePrimay.\nWhen get() is called in non-primary node, MapOwner#objectMadePrimay is called.\n\n\nBest regards."}, {"count": 1, "tags": [], "creator": "kfujino@apache.org", "attachment_id": 26024, "id": 139857, "time": "2010-09-14T03:26:53Z", "bug_id": 49924, "creation_time": "2010-09-14T03:26:53Z", "is_private": false, "text": "Created attachment 26024\nI made a patch."}, {"count": 2, "tags": [], "creator": "kfujino@apache.org", "attachment_id": null, "id": 139858, "time": "2010-09-14T03:50:54Z", "bug_id": 49924, "creation_time": "2010-09-14T03:50:54Z", "is_private": false, "text": "Fixed in trunk and proposed for 6.0.x"}, {"count": 3, "tags": [], "creator": "kfujino@apache.org", "is_private": false, "id": 140474, "attachment_id": null, "bug_id": 49924, "creation_time": "2010-10-05T01:34:45Z", "time": "2010-10-05T01:34:45Z", "text": "This fix applied to 6.0, will be in 6.0.30 onwards."}]