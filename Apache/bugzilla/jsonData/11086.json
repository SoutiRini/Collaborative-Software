[{"count": 0, "tags": [], "bug_id": 11086, "attachment_id": null, "is_private": false, "id": 20053, "time": "2002-07-23T14:24:19Z", "creator": "w.riezebos@genimen.com", "creation_time": "2002-07-23T14:24:19Z", "text": "A null pointer is generated in a specific situation where a JSP page needs to \nload a new class. The cause is not quite clear though.\nThe problem is directly caused by:\n\nIn the constructor the securityManager is initialized.\n\nJasperLoader(URL [] urls, String className, ClassLoader parent,\n\t\t PermissionCollection permissionCollection,\n\t\t CodeSource codeSource) {\n\tsuper(urls,parent);\n...\n\tthis.securityManager = System.getSecurityManager();\n    }\n\nFurther on in public Class loadClass(String name, boolean resolve)\nthere is a check:\n        if (System.getSecurityManager() != null) {     \n            if (dot >= 0) {                \n                try {                    \n                    securityManager.checkPackageAccess(name.substring(0,dot));\n\nAs you can see the System.getSecurityManager() is checked to be set; and then \nTHE INSTANCE VARIABLE IS USED.\nWhen at construction there is no security manager; this will be NULL. Af later \nat class loading time there IS a security manager the method will cause a null \npointer.\n\nIndirect causes:\nI have no clue why there suddenly is a system classloader; I am just using \nplain JSP pages and I am not messing about with security managers or class \nloaders. Anyway, this kind of check seems erratic to me.\n\nKind regards,\n\nWido Riezebos"}, {"count": 1, "tags": [], "creator": "w.riezebos@genimen.com", "is_private": false, "text": "As it turns out a component I am using IS installing a (RMI)securityManager on \nthe fly. Tomcat is unable to handle this because of the previously described \nflaw. Suggestion: modify \n\nif (System.getSecurityManager() != null) {   \ninto\nif (securityManager != null) {   \n\nor do not cache the securityManager at all.\n\nWido\n", "id": 20056, "time": "2002-07-23T14:55:04Z", "bug_id": 11086, "creation_time": "2002-07-23T14:55:04Z", "attachment_id": null}, {"count": 2, "tags": [], "text": "Please see bug report 7052 for a discussion of this \"bug\".\nBottom line, you need to configure Tomcat to use the SecurityManager\nwith support for RMI.  Applications hosted within Tomcat should not\nbe setting the SecurityManager.\n\n*** This bug has been marked as a duplicate of 7052 ***", "is_private": false, "id": 20091, "creator": "glenn@apache.org", "time": "2002-07-24T00:46:39Z", "bug_id": 11086, "creation_time": "2002-07-24T00:46:39Z", "attachment_id": null}]