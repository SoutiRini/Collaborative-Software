[{"count": 0, "tags": [], "creator": "kelly.chen@tumbleweed.com", "attachment_id": null, "text": "I can reproduce this easily. For any JSP pages that uses the standard tag lib\nwith the following line.\n<%@ taglib prefix=\"c\" uri=\"http://java.sun.com/jstl/core\" %>\nI will run into errors when using JspC to compile from command line. I use the\nfollowing command line to compile Jsp pages:\njava org.apache.jasper.JspC -d output_dir -p my.package -uriroot jsp \n\nI also need to put standard.jar under jsp/WEB-INF/lib for JspC to find it. An\nerror will occur. \n\nI also did a bit digging to see why the same Jasper library compiles Jsp fine\nfor a web-app, but not from command line. The following is what I found.The\nculprit is the following line of code in the constructor of TagLibraryInfoImpl.java\n\n               if(ctxt.getClassLoader() != null &&\n                 \njava.net.URLClassLoader.class.equals(ctxt.getClassLoader().getClass())\n                  && path.startsWith(\"/\"))\n               {\n                   path = path.substring(1,path.length()) ;\n               }\n               url = ctxt.getResource(path);\n\nWhen running from the web-app. The ctxt object is JspEngineContext (I am looking\nat a Jetty class). Its class loader is different from java.net.URLClassLoader,\nso it will not trigger the action to strip out the \"/\".\n\nWhen running JspC to compile the JSP pages, the ctxt object is\nJspCompilationContext. Its class loader is URLClassLoader, so it will trigger\nthe stripping action.\n\nHowever both context objects do not use class loader to getResource. Instead\nboth use javax.servlet.ServletContext.getResource, which requires the string to\nbe started with \"/\" according to Servlet spec. So the check for the class loader\nhere makes no sense here. It is clearly a bug that the code strips out the\nstarting \"/\" prior to calling ctxt.getResource. \n\nI would suggest to take out the above code that checks for class loader and\nremove the starting \"/\".", "id": 30781, "time": "2003-02-05T22:56:19Z", "bug_id": 16821, "creation_time": "2003-02-05T22:56:19Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 16821, "is_private": false, "text": "\n\n*** This bug has been marked as a duplicate of 14302 ***", "id": 53618, "time": "2004-03-07T19:14:31Z", "creator": "markt@apache.org", "creation_time": "2004-03-07T19:14:31Z", "attachment_id": null}]