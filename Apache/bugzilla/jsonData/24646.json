[{"count": 0, "tags": [], "bug_id": 24646, "attachment_id": null, "is_private": false, "id": 47250, "time": "2003-11-12T14:46:08Z", "creator": "sagem@e-mail.dk", "creation_time": "2003-11-12T14:46:08Z", "text": "I get an error when running a <junit> task with format=\"xml\". The only thing \nI've done to modify the installation is to add xalan.jar to the lib. I've \nofcourse modified the ANT_HOME to point to the correct installation.\n\nFirst I get a\n\n    [junit] java.lang.NoClassDefFoundError: org/w3c/dom/Node\n    [junit]     at java.lang.Class.forName0(Native Method)\n    [junit]     at java.lang.Class.forName(Class.java:115)\n    [junit]     at \norg.apache.tools.ant.taskdefs.optional.junit.FormatterElement.createFormatter\n(FormatterElement.java:236)\n    [junit]     at \norg.apache.tools.ant.taskdefs.optional.junit.FormatterElement.createFormatter\n(FormatterElement.java:220)\n    [junit]     at \norg.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.createAndStoreForma\ntter(JUnitTestRunner.java:586)\n    [junit]     at \norg.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main\n(JUnitTestRunner.java:531)\n    [junit] Exception in thread \"main\"\n\n\nI see that this class is found in the xml-apis.jar file, so I add this to the \nclasspath, and then get\n\n    [junit] javax.xml.parsers.FactoryConfigurationError: Provider for \njavax.xml.parsers.DocumentBuilderFactory cannot be found\n    [junit]     at javax.xml.parsers.DocumentBuilderFactory.newInstance(Unknown \nSource)\n    [junit]     at \norg.apache.tools.ant.taskdefs.optional.junit.XMLJUnitResultFormatter.getDocument\nBuilder(XMLJUnitResultFormatter.java:89)\n    [junit]     at \norg.apache.tools.ant.taskdefs.optional.junit.XMLJUnitResultFormatter.startTestSu\nite(XMLJUnitResultFormatter.java:139)\n    [junit]     at \norg.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.fireStartTestSuite\n(JUnitTestRunner.java:470)\n    [junit]     at \norg.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run\n(JUnitTestRunner.java:280)\n    [junit]     at \norg.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main\n(JUnitTestRunner.java:560)\n    [junit] Exception in thread \"main\""}, {"count": 1, "tags": [], "bug_id": 24646, "attachment_id": 9072, "id": 47258, "time": "2003-11-12T16:22:15Z", "creator": "sagem@e-mail.dk", "creation_time": "2003-11-12T16:22:15Z", "is_private": false, "text": "Created attachment 9072\nlogfile from ant using -verbose."}, {"count": 2, "tags": [], "text": "Changed Component to Optional Tasks - as there has been no response from \nDocumentation.\n\nCould somebody please try to run a junit task with formatter=\"xml\". ", "is_private": false, "id": 48076, "creator": "sagem@e-mail.dk", "time": "2003-11-25T09:40:42Z", "bug_id": 24646, "creation_time": "2003-11-25T09:40:42Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 24646, "attachment_id": null, "is_private": false, "id": 48095, "time": "2003-11-25T13:22:08Z", "creator": "sagem@e-mail.dk", "creation_time": "2003-11-25T13:22:08Z", "text": "When adding\n\n${ant.home}\\lib\\xml-apis.jar;${ant.home}\\lib\\xercesImpl.jar\n\nto my classpath things seems to work. Don't know however if this is the \nintended use. In the documentation it says that jars in the lib directory are \nloaded automatically.....\n\nRegards\nBo "}, {"count": 4, "tags": [], "bug_id": 24646, "attachment_id": null, "id": 48139, "time": "2003-11-26T09:42:48Z", "creator": "sagem@e-mail.dk", "creation_time": "2003-11-26T09:42:48Z", "is_private": false, "text": "Hmm, it seems that when using fork=\"yes\" I have to provide a classpath - even \nif includeantruntime is true (it should be by default according to junit task \ndocumentation). When fork is off things work well....\n\nI don't know if this is intended - so I'll just leave the bug in the NEW \nstatus. If this is intended the bug can be closed for my part. \n\nIs there anybody out there at all? ;o)"}, {"count": 5, "attachment_id": null, "bug_id": 24646, "text": "includeantruntime only includes the parts of Ant's runtime that are necessary\nto run the testrunner, not the classes to use the formatters.\n\nSo if you fork, you have to ensure there is a DOM library in your classpath (I\ndon't think the XML formatter needs anything besides DOM).\n\nHas this been different in 1.5.x?", "id": 48149, "time": "2003-11-26T12:03:27Z", "creator": "bodewig@apache.org", "creation_time": "2003-11-26T12:03:27Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "creator": "sagem@e-mail.dk", "is_private": false, "id": 48152, "creation_time": "2003-11-26T12:25:35Z", "time": "2003-11-26T12:25:35Z", "bug_id": 24646, "text": "I've tried to run the same target with both 1.5.2. and 1.6beta2 - and only 1.6 \nfailed...\n\nIt sounds odd to me as the java.class.path property looks fine i.e. all the \njars from the lib directory are included. And I guess that forked of VMs use \nthis property....", "attachment_id": null}, {"count": 7, "attachment_id": null, "bug_id": 24646, "text": "No, it doesn't use java.class.path, that property gets modified by Ant after\nstarting Ant and doesn't reflect your system classpath.\n\nI'll take a closer look.", "id": 48153, "time": "2003-11-26T12:27:34Z", "creator": "bodewig@apache.org", "creation_time": "2003-11-26T12:27:34Z", "tags": [], "is_private": false}, {"count": 8, "tags": [], "bug_id": 24646, "is_private": false, "id": 48273, "attachment_id": null, "creator": "stevel@apache.org", "creation_time": "2003-11-28T09:10:29Z", "time": "2003-11-28T09:10:29Z", "text": "- I think that ant's manifest used to declare that it needed the XML stuff, but\nthis was pulled -when it was there it implicitly added the xml libs to the\nruntime -whether it was appropriate or not. \n\nif we revert, then you lose the ability to specify the xml parser used in the\napp.  Maybe we could rework junit to not use DOM  for XML support, but just to \ngenerate the text output.."}, {"count": 9, "tags": [], "bug_id": 24646, "attachment_id": null, "id": 48277, "time": "2003-11-28T10:46:50Z", "creator": "sagem@e-mail.dk", "creation_time": "2003-11-28T10:46:50Z", "is_private": false, "text": "Well - all software suffer from peculiarities and this may be one. Usually if \nit's hard to fix without violating some intentions - let it be and supply a \nworkaround...  \n\nIn this case it would just be a minor documentation update to the section on \nfork ....\n"}, {"count": 10, "tags": [], "bug_id": 24646, "attachment_id": null, "id": 56067, "time": "2004-04-20T07:29:42Z", "creator": "bodewig@apache.org", "creation_time": "2004-04-20T07:29:42Z", "is_private": false, "text": "Added as a known problem to the FAQ and we're now pointing to that FAQ from the\nmanual.  Probably the best we can do in this situation."}]