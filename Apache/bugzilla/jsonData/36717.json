[{"count": 0, "text": "I am generating dynamic class files within an Ant task using Javassist.\n\nThe bug is best illustraighted by the following code snippet (from execute\nwithin my ant task):\n\nSystem.out.println(\"CL1: \"+Thread.currentThread().getContextClassLoader());\nSystem.out.println(\"CL2: \"+this.getClass().getClassLoader());\n\nThe output is:\n\n[MyTask] CL1: java.net.URLClassLoader@82ba41\n[MyTask] CL2: org.apache.tools.ant.loader.AntClassLoader2@1c1ea29\n\nThe workaround for my code is:\n\t\t\t\nThread.currentThread().setContextClassLoader(this.getClass().getClassLoader());\n\nWhich causes Javassist to work perfectly.\n\nYonas.", "creator": "yonas.jongkind@gmail.com", "attachment_id": null, "id": 80132, "time": "2005-09-19T22:07:49Z", "bug_id": 36717, "creation_time": "2005-09-19T22:07:49Z", "tags": [], "is_private": false}, {"count": 1, "text": "I'm not going to disagree, just to note that the whole notion of a context class\nloader is somewhat dubious. Should Ant change it to the classloader of every\ncustom task that is invoked? Should we then change it back when we reenter ant\ncore stuff? Its kind of an odd little global variable, like some of the EJB\ncontext things.\n\nGiven that you are calling ant from a custom task, its not clear what the\nclassloader should be, since the this.getClass().getClassloader() will probably\nbe different from that of this.project.getClass().getClassloader().\n\nMuch better to stick to what you are doing, and that way there are no surprises.", "bug_id": 36717, "attachment_id": null, "id": 80200, "time": "2005-09-20T19:06:33Z", "creator": "stevel@apache.org", "creation_time": "2005-09-20T19:06:33Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 36717, "text": "*** Bug 15018 has been marked as a duplicate of this bug. ***", "id": 92950, "time": "2006-09-03T17:01:47Z", "creator": "peterreilly@apache.org", "creation_time": "2006-09-03T17:01:47Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 36717, "attachment_id": null, "id": 92951, "time": "2006-09-03T17:04:13Z", "creator": "peterreilly@apache.org", "creation_time": "2006-09-03T17:04:13Z", "is_private": false, "text": "This could be done as an attribute to typedef/taskdef.\n"}, {"attachment_id": null, "tags": [], "creator": "peterreilly@apache.org", "is_private": false, "count": 4, "id": 96714, "time": "2006-12-10T14:39:18Z", "bug_id": 36717, "creation_time": "2006-12-10T14:39:18Z", "text": "The policy of using the context loader should be\nup to the indivual task. Ant cannot know when it\nis correct or incorrect to set it."}]