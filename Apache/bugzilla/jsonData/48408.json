[{"count": 0, "tags": [], "bug_id": 48408, "text": "Reading the API, it appears that if I want a column width of 8 I would multiply that by 256 which gives me the result of 2048.\n\nWhen I create my Excel spreadsheet, I get a column width of 7.29 instead.\n\nIt should be noted I am opening my document in Excel 2007.", "id": 132907, "time": "2009-12-17T07:59:51Z", "creator": "benicely@gmail.com", "creation_time": "2009-12-17T07:59:51Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "yegor@dinom.ru", "is_private": false, "count": 1, "id": 147277, "time": "2011-06-20T15:27:46Z", "bug_id": 48408, "creation_time": "2011-06-20T15:27:46Z", "text": "The value passed to  setColumnWidth  is written in the low-level format structures. This method sets the full column width which includes 4 pixels of margin padding (two on each side), plus 1 pixel padding for the gridlines. \n\nExcel shows you the actual amount of visible characters (margins and paddings are not included) and this explains why the value in Excel is smaller: 7.29 vs 8. \n\nThe spec for the .xlsx format describes how Excel calculates the width in characters:\n\nwidth = Truncate([{Number of Visible Characters} *\n     {Maximum Digit Width} + {5 pixel padding}]/{Maximum Digit Width}*256)/256;\n\nwhere {Maximum Digit Width} is the maximum digit width of the\nnumbers 0, 1, 2, ..., 9 as rendered in the normal style's font.\n\nUsing the Arial font as an example, the maximum digit width of 10 point font size is 7 pixels (at 96 dpi). Therefore if the cell\nwidth is 8 characters wide, then the actual value of visible characters (the value shown in Excel) is derived from the following equation:\n\n Truncate([numChars*7+5]/7*256)/256 = 8;\n\nwhich gives 7.29.\n\nI updated javadocs to reflect this.\n\n\nYegor"}]