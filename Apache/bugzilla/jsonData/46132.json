[{"count": 0, "tags": [], "text": "This patch allows one to suppress an unnecesary or \ninaccurate Vary header without introducing new problems \nby forcing a downgrade to HTTP 1.0 instead of 1.1.\n\nCurrently, the force-no-vary environment variable can be \nset to avoid having Apache send a Vary header when it would \notherwise send one unnecesarily.  An example is that if \nforce-no-vary is not set, using mod_rewrite will often \ncause a Vary header to be sent even when it shouldn't be.\nSuppressing the inaccurate or unnecesary Vary header is \nimportant due to the fact that the most popular browser \ndoes not handle the header properly.\n\nThe current force-no-vary handling, however, also forces \na downgrade to HTTP 1.0 just in case the Vary really was \nneeded after all and HTTP 1.1 caches might have needed it.\nThis unexpected side effect of turning the clock back \nto the deprecated protocol creates the well known problems \nwhich led to 1.1.\n\nMost often, force-no-vary is set precisely _because_ the \ndeveloper knows that the Vary header which would otherwise \nbe produced is not necesary and removing it will either \nimprove cacheability or at least not create caching \nproblems.  This is the majority of cases there is no \nneed to force HTTP version 1.0 to protect caches.\n\nThe existing \"force-no-vary\" variable is left with it's\nold but not intuitive behavior of causing a downgrade to \nHTTP 1.0.  To allow a developer to _only_ suppress the \nvary header _without_ other unexpected effects we introduce \n\"force-no-vary-keep-1.1\".", "attachment_id": null, "id": 122033, "creator": "support@webmastersguide.com", "time": "2008-10-30T11:39:05Z", "bug_id": 46132, "creation_time": "2008-10-30T11:39:05Z", "is_private": false}, {"count": 1, "tags": [], "text": "Created attachment 22797\nPatch to add no_vary_keep_1.1 to suppress vary only", "attachment_id": 22797, "id": 122034, "creator": "support@webmastersguide.com", "time": "2008-10-30T11:40:47Z", "bug_id": 46132, "creation_time": "2008-10-30T11:40:47Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 46132, "attachment_id": null, "is_private": false, "id": 122036, "time": "2008-10-30T13:01:06Z", "creator": "rpluem@apache.org", "creation_time": "2008-10-30T13:01:06Z", "text": "Two comments:\n\n1. There is a novary flag for RewriteCond to prevent mod_rewrite from adding\n   to / creating a Vary header (see http://httpd.apache.org/docs/2.2/en/mod/mod_rewrite.html#rewritecond). This is\n   much more precise than killing all fields in the Vary header.\n\n2. Without a documentation patch this patch is pretty much useless because nobody \n   will know about the new environment variable except you and the people who read\n   this PR."}, {"count": 3, "text": "> 1. There is a novary flag for RewriteCond to prevent mod_rewrite \n> from adding to / creating a Vary header \n> (see http://httpd.apache.org/docs/2.2/en/mod/mod_rewrite.html#rewritecond).\n\nHelpful for Apache 2.2, but not 1.3 or 2.0.  Also, rewrite isn't the \nonly thing that uses, or could use, force-no-vary.  Thus the new \n2.2 rewrite feature only reduces the need for this patch in 2.2.\n\n> 2. Without a documentation patch this patch is pretty much useless \n> because nobody will know about the new environment variable except \n> you and the people who read this PR.\n\nI will gladly attach a documentation patch.\nI had intended to follow the procedure suggested at \nhttp://httpd.apache.org/dev/patches.html:\n\n    You may wish to see if your patch is considered generally \n    acceptable before updating the documentation. \n\n\n\n", "creator": "support@webmastersguide.com", "is_private": false, "id": 122039, "time": "2008-10-30T14:15:49Z", "bug_id": 46132, "creation_time": "2008-10-30T14:15:49Z", "tags": [], "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 46132, "is_private": false, "count": 4, "id": 145325, "time": "2011-03-27T17:57:40Z", "creator": "wrowe@apache.org", "creation_time": "2011-03-27T17:57:40Z", "text": "httpd-1.3 is no longer in maintenance, and I see this issue is addressed in 2.2+."}]