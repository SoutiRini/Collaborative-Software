[{"count": 0, "tags": [], "creator": "osganian@yahoo.com", "attachment_id": null, "text": "Using the following task:\n\n        <junit printsummary=\"on\"\n               filtertrace=\"on\"\n               fork=\"yes\"\n               failureProperty=\"unit.failed\"\n               haltonfailure=\"no\"\n               showoutput=\"true\"\n               tempdir=\"${tmpDir}\">\n            <classpath refid=\"unit.classpath\"/>\n            <syspropertyset refid=\"unit.propertyset\"/>\n            <batchtest todir=\"${testReportDir}\">\n                <fileset dir=\"${testSrcDir}\">\n                    <include name=\"**/*Test.java\"/>\n                </fileset>\n            </batchtest>\n        </junit>\n\non ANT 1.7RC1 I get the following error:\n\n    [junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 3.015 sec\n    [junit] java.io.FileNotFoundException:\nC:\\trunk\\build\\tmp\\junitvmwatcher323850216.properties (The system cannot find\nthe file specified)\n\n    [junit]     at java.io.FileInputStream.open(Native Method)\n    [junit]     at java.io.FileInputStream.<init>(FileInputStream.java:106)\n    [junit]     at java.io.FileReader.<init>(FileReader.java:55)\n    [junit]     at\norg.apache.tools.ant.taskdefs.optional.junit.JUnitTask.executeAsForked(JUnitTask.java:1025)\n    [junit]     at\norg.apache.tools.ant.taskdefs.optional.junit.JUnitTask.execute(JUnitTask.java:817)\n    [junit]     at\norg.apache.tools.ant.taskdefs.optional.junit.JUnitTask.executeOrQueue(JUnitTask.java:1627)\n    [junit]     at\norg.apache.tools.ant.taskdefs.optional.junit.JUnitTask.execute(JUnitTask.java:764)\n    [junit]     at\norg.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)\n    [junit]     at sun.reflect.GeneratedMethodAccessor18.invoke(Unknown Source)\n    [junit]     at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    [junit]     at java.lang.reflect.Method.invoke(Method.java:585)\n    [junit]     at\norg.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)\n    [junit]     at org.apache.tools.ant.Task.perform(Task.java:342)\n    [junit]     at org.apache.tools.ant.Target.execute(Target.java:357)\n    [junit]     at org.apache.tools.ant.Target.performTasks(Target.java:385)\n    [junit]     at\norg.apache.tools.ant.Project.executeSortedTargets(Project.java:1292)\n    [junit]     at org.apache.tools.ant.Project.executeTarget(Project.java:1261)\n\n    [junit]     at\norg.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n    [junit]     at org.apache.tools.ant.Project.executeTargets(Project.java:1144)\n    [junit]     at org.apache.tools.ant.Main.runBuild(Main.java:698)\n    [junit]     at org.apache.tools.ant.Main.startAnt(Main.java:199)\n    [junit]     at org.apache.tools.ant.launch.Launcher.run(Launcher.java:298)\n    [junit]     at org.apache.tools.ant.launch.Launcher.main(Launcher.java:104)\n    [junit] Running MyTest\n\nI see the file junitvmwatcher323850216.properties get created and then removed\nin my tmpDir but I supposed there is a synchronization issue going on.\n\nThe tasks runs fine in ANT 1.6.5 or if I set fork=\"no\" but if I do that only so\nmany of my tasks run then it eventually fails.\n\nI'm using junit 4.1 (which i dropped in the ANT's lib dir).", "id": 96514, "time": "2006-12-04T07:36:01Z", "bug_id": 41104, "creation_time": "2006-12-04T07:36:01Z", "is_private": false}, {"count": 1, "tags": [], "creator": "peterreilly@apache.org", "attachment_id": null, "is_private": false, "id": 96518, "time": "2006-12-04T09:34:13Z", "bug_id": 41104, "creation_time": "2006-12-04T09:34:13Z", "text": "This is interesting.\n1) are all the tests run (i.e. are there only three tests?)\n2) do any of the tests delete the ${tmpDir}?\n3) do you get the problem if the \"tempdir\" attribute is not used.\n\nIf possible, can you reduce your project to\nthe smallest that causes the problem (i.e. one test),\nand if possible place it in a zip file and\nattach them to this bug report.\nTx."}, {"count": 2, "attachment_id": null, "bug_id": 41104, "is_private": false, "id": 96519, "time": "2006-12-04T09:43:08Z", "creator": "osganian@yahoo.com", "creation_time": "2006-12-04T09:43:08Z", "tags": [], "text": "1. Each test that runs gets the same error, just the generated property file\nname is unique.\n2. No test delete the ${tmpDir}, ${tmpDir} is created before the <junit> task.\n3. If I don't specify ${tmpDir} as the <junit>'s tempdir I still get the problem.\n\nI can try and generate a zip to reproduce the problem.\n"}, {"count": 3, "attachment_id": null, "bug_id": 41104, "text": "Just to be clear, I set the <include name=\"\"/> within the <batchtest> block to a\nsingle test and it still fails with the same error.\n\nAlso I'm using weblogic 9.2 as my j2ee server and get all my J2EE jar libraries\nfrom it for my classpath (using api.jar and weblogic.jar).\n", "id": 96522, "time": "2006-12-04T12:23:20Z", "creator": "osganian@yahoo.com", "creation_time": "2006-12-04T12:23:20Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "creator": "peterreilly@apache.org", "attachment_id": null, "text": "There is a problem if the JUnitTestRunner cannot\nbe created. In this case nothing would create\nthe vmlancher file that JunitTest tries to\ndelete.\nThis can happen if the classpath used for JUnitTestRunner\ncontains weblogic.jar.\nA lot of versions of weblogic.jar contain org.apache.tools.ant.*\nclasses. These can conflict with the classes in ant.\n\nTry to extract the org.apache.tools.ant.* classes from weblogic.jar.", "id": 96523, "time": "2006-12-04T12:59:42Z", "bug_id": 41104, "creation_time": "2006-12-04T12:59:42Z", "is_private": false}, {"count": 5, "tags": [], "creator": "osganian@yahoo.com", "text": "Thanks for the quick reply.\n\nI checked weblogic.jar in version 9.2 and there isn't that package.  There is a\nantlr package however, is that equalivent?", "id": 96524, "time": "2006-12-04T13:07:52Z", "bug_id": 41104, "creation_time": "2006-12-04T13:07:52Z", "is_private": false, "attachment_id": null}, {"count": 6, "attachment_id": null, "bug_id": 41104, "is_private": false, "id": 96525, "time": "2006-12-04T13:21:57Z", "creator": "osganian@yahoo.com", "creation_time": "2006-12-04T13:21:57Z", "tags": [], "text": "Also, when my explorer window is looking at my ${tmpDir} directory I can see the\njunitvmwatcher*.properties file getting created then immediately deleted.  So it\nlooks like the file is being created just maybe it is just after something else\ntries to read it."}, {"count": 7, "attachment_id": null, "bug_id": 41104, "text": "Ok, I messed up, I still had a weblogic.jar in the classpath.  You are right if\nI take (all) weblogic.jar files out of the classpath it works.  Not sure what is\nin there but it turns out I didn't need weblogic.jar in my classpath for\ncompiling/unit tests anyway.\n\nSorry if I wasted your time.  Not sure if there is still a bug there or not.", "id": 96529, "time": "2006-12-04T14:50:04Z", "creator": "osganian@yahoo.com", "creation_time": "2006-12-04T14:50:04Z", "tags": [], "is_private": false}, {"count": 8, "tags": [], "bug_id": 41104, "attachment_id": null, "id": 96583, "time": "2006-12-06T16:24:34Z", "creator": "peterreilly@apache.org", "creation_time": "2006-12-06T16:24:34Z", "is_private": false, "text": "I have done some more testing with this.\nIf the classpath given to junit contains\nant.1.6 classes, one gets the FileNotFoundException.\nand after this there should be a \"Tests FAILED (crashed)\"\n- can you confirm that.\n\nAs regards the \"false positive\" summary report:\n[junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 3.015 sec\n\nI recompiled ant 1.6.5 and changed the summary output string to\nreflect the version, I found that that this output comes from\nthe ant 1.6.5 summary report.\n\ntask:\n    <junit printsummary=\"yes\" fork=\"yes\" forkmode=\"once\">\n      <classpath>\n        <path path=\"build/classes\"/>\n        <fileset dir=\"lib\" includes=\"*.jar\"/>\n        <fileset dir=\"l:/src/apache-ant-1.6.5/dist/lib\" includes=\"*.jar\"/>\n      </classpath>\n      <batchtest todir=\"build/reports\">\n        <fileset dir=\"src\"/>  <!-- contains two test classes each of which have\n                                   two tests -->\n      </batchtest>\n      <formatter type=\"xml\"/>\n    </junit>\n\nI get the following output (after removing the spurious filenotfound exception):\n\nTests run: 2, Failures(1.6): 0, Errors: 0, Time elapsed: 0.328 sec\nTests run: 2, Failures(1.6): 0, Errors: 0, Time elapsed: 0.016 sec\nRunning Example\nTests run: 1, Failures: 0, Errors: 1, Time elapsed: 0 sec\nTests FAILED (crashed)\n\nBUILD SUCCESSFUL\n\nSo it looks like the tests ran successfully,\nthe SummaryReport from ant 1.6 got used to report the success,\nthis is hidden from ant 1.7, which sees that the\njunitrunner task seems to have crashed (1.7 has a new\nhandshake mechanism based on the error return and the\ncrash file) it reports this via the 1.7 summary report,\nand then reports a crash.\n\nOf course mixing ant1.6 and ant1.7 jars in the classpath\nwill not be good, the question is how can ant detect\nthis and report this to the user."}, {"count": 9, "attachment_id": null, "bug_id": 41104, "is_private": false, "id": 97198, "time": "2006-12-22T13:21:13Z", "creator": "jkf@apache.org", "creation_time": "2006-12-22T13:21:13Z", "tags": [], "text": "I have added a check on existing file in the JUnitTask which gives a somewhat\nbetter error in the report. (I knew of the discussion, not of this actual\nreport). Does this resolve this issue?"}, {"count": 10, "tags": [], "text": "I have added a check to see if there are multi\nversions of ant in the classpath for the forked\njunit task. - this and Martijn's modification should\nsolve this bug.", "attachment_id": null, "id": 97449, "creation_time": "2006-12-29T09:00:20Z", "time": "2006-12-29T09:00:20Z", "creator": "peterreilly@apache.org", "bug_id": 41104, "is_private": false}, {"count": 11, "attachment_id": null, "bug_id": 41104, "is_private": false, "id": 98847, "time": "2007-01-31T11:44:49Z", "creator": "peterreilly@apache.org", "creation_time": "2007-01-31T11:44:49Z", "tags": [], "text": "*** Bug 41511 has been marked as a duplicate of this bug. ***"}]