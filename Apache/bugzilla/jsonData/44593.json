[{"count": 0, "tags": [], "bug_id": 44593, "text": "Created attachment 21657\nExcel file that causes an exception\n\nI'm using org.apache.poi.hssf.extractor.ExcelExtractor class for reading Excel files and I've got an exception below. Problem file is zipped and attached, I tried to minimize it's contents to make it easier to investigate, but I have no enough Excel knoweledge to figure out what field causes the problem :)\n\nException in thread \"main\" org.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n        at org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:199)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:117)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:207)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:259)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:240)\n        at org.apache.poi.hssf.extractor.ExcelExtractor.<init>(ExcelExtractor.java:54)\n        at org.apache.poi.hssf.extractor.ExcelExtractor.main(ExcelExtractor.java:66)\nCaused by: java.lang.reflect.InvocationTargetException\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:513)\n        at org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:187)\n        ... 6 more\nCaused by: java.lang.ArrayIndexOutOfBoundsException\n        at org.apache.poi.hssf.record.RecordInputStream.checkRecordPosition(RecordInputStream.java:132)\n        at org.apache.poi.hssf.record.RecordInputStream.readShort(RecordInputStream.java:152)\n        at org.apache.poi.hssf.util.HSSFCellRangeAddress.fillFields(HSSFCellRangeAddress.java:77)\n        at org.apache.poi.hssf.util.HSSFCellRangeAddress.<init>(HSSFCellRangeAddress.java:65)\n        at org.apache.poi.hssf.record.DVRecord.fillFields(DVRecord.java:207)\n        at org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n        at org.apache.poi.hssf.record.DVRecord.<init>(DVRecord.java:134)\n        ... 11 more", "id": 114559, "attachment_id": 21657, "creator": "batrakov@gmail.com", "creation_time": "2008-03-13T01:16:03Z", "time": "2008-03-13T01:16:03Z", "is_private": false}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "text": "We were running out of data processing the validation rules in one of the DVRecords\n\nFor now, I've tweaked poi to issue a warning in this case, and carry on. Not sure if we'll then have garbage data validation rules then or not, but at least your file can be opened fine, and you ought to be able to get your text out\n\n(Fixed in SVN trunk)", "id": 114578, "time": "2008-03-13T06:19:44Z", "bug_id": 44593, "creation_time": "2008-03-13T06:19:44Z", "is_private": false, "attachment_id": null}, {"count": 2, "text": "Fixed was applied in svn r636756", "bug_id": 44593, "is_private": false, "id": 133242, "time": "2009-12-30T17:55:53Z", "creator": "josh@apache.org", "creation_time": "2009-12-30T17:55:53Z", "tags": [], "attachment_id": null}]