[{"count": 0, "tags": [], "text": "Hello,\n\nI had problem reading xls files created with Perl module Spreadsheet::WriteExcel\n(v2.17, released May 21, 2006)\n\nSample files to follow.", "attachment_id": null, "id": 96971, "creator": "hubertwslin@gmail.com", "time": "2006-12-15T22:10:13Z", "bug_id": 41187, "creation_time": "2006-12-15T22:10:13Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 41187, "attachment_id": 19267, "id": 96972, "time": "2006-12-15T22:12:24Z", "creator": "hubertwslin@gmail.com", "creation_time": "2006-12-15T22:12:24Z", "is_private": false, "text": "Created attachment 19267\nxls created with Perl module Spreadsheet::WriteExcel\n\nThis file can be opened without any problem in\n1. MS office\n2. OpenOffice\n3. Google Docs & Spreadsheet"}, {"count": 2, "tags": [], "bug_id": 41187, "attachment_id": 19268, "id": 96973, "time": "2006-12-15T22:14:02Z", "creator": "hubertwslin@gmail.com", "creation_time": "2006-12-15T22:14:02Z", "is_private": false, "text": "Created attachment 19268\nperl src to write xls file\n\nThis code is availabe in the manpage of Spreadsheet::WriteExcel."}, {"count": 3, "tags": [], "bug_id": 41187, "text": "Is it an Excel 97+ format?  We do not read anything but 97 or later.  Those may.\n Was there a stack trace or any other info?", "id": 96974, "time": "2006-12-15T22:48:48Z", "creator": "poi-support@buni.org", "creation_time": "2006-12-15T22:48:48Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 41187, "text": "Quoted from Spreadsheet::WriteExcel manpage:\n\n    The Spreadsheet::WriteExcel module can be used to create a cross-platform\nExcel binary file. Multiple worksheets can be added to a workbook and formatting\ncan be applied to cells. Text, numbers, formulas, hyperlinks and images can be\nwritten to the cells.\n    The Excel file produced by this module is compatible with 97, 2000, 2002 and\n2003.\n\n\n\nHere's the java code i used to parse the excel file:\nhttp://www.javaworld.com/javaworld/javaqa/2002-05/01-qa-0503-excel3.html", "id": 96975, "time": "2006-12-15T23:18:33Z", "creator": "hubertwslin@gmail.com", "creation_time": "2006-12-15T23:18:33Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 41187, "attachment_id": null, "text": "The java code produce no error or exception, and nothing on the stdout.", "id": 96976, "time": "2006-12-15T23:19:51Z", "creator": "hubertwslin@gmail.com", "creation_time": "2006-12-15T23:19:51Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 41187, "text": "I'm a bit incredulous because POI (OLE2FS at the time) .01 was loosely based on\nthe documentation produced by the author of that module.  Secondly POI generally\nbarfs with big fat stack traces when it doesn't like something.  I'd suggest\nwriting the mail list providing executable copies of each part and see if\nsomeone will run it for you and maybe figure out what's missing...", "id": 96984, "time": "2006-12-16T05:13:02Z", "creator": "poi-support@buni.org", "creation_time": "2006-12-16T05:13:02Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "creator": "hubertwslin@gmail.com", "is_private": false, "id": 96991, "creation_time": "2006-12-17T06:13:05Z", "time": "2006-12-17T06:13:05Z", "bug_id": 41187, "text": "Created attachment 19270\nsimple java code to test poi\n\nFurther test shows the flow never goes into the while( rows.hasNext() ) loop.\nIt's pretty easy to reproduce this, please give it a try. Thanks.\n\n\n[h@mag ~]$ /usr/java/j2sdk1.4.2_13/bin/javac -classpath\npoi-3.0-alpha3-20061216.jar POITest.java \n[h@mag ~]$ /usr/java/j2sdk1.4.2_13/bin/java -classpath\npoi-3.0-alpha3-20061216.jar:. POITest perl.xls \n[h@mag ~]$ /usr/java/j2sdk1.4.2_13/bin/javac -classpath\npoi-2.5.1-final-20040804.jar POITest.java \n[h@mag ~]$ /usr/java/j2sdk1.4.2_13/bin/java -classpath\npoi-2.5.1-final-20040804.jar:. POITest perl.xls \n[h@mag ~]$", "attachment_id": 19270}, {"count": 8, "tags": [], "bug_id": 41187, "text": "I too have just encountered this error (using poi-3.0.2beta2.  It appears the\nperl module does not create any RowRecord records. so\norg.apache.poi.hssf.model.Sheet.createSheet(List, int, int) never populates the\nrows field.  \n\nI have found a workaround to be to open the perl generated file in OpenOffice /\nExcel and then do a \"save as\" this will create the missing RowRecords.\n\nI hope this helps,\nDanny", "id": 113061, "time": "2008-01-22T13:25:44Z", "creator": "dkatzel@jcvi.org", "creation_time": "2008-01-22T13:25:44Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 41187, "text": "I have added a bug report to the Perl SpreadSheet :: WriteExcel module on cpan:\n\nthe problem is known and will be corrected in a future release of WriteExcel.\n\nhttp://rt.cpan.org/Public/Bug/Display.html?id=32544\n\nEven though the problem will be resolved on the Perl side, I think it is still a\ngood idea to handle this issue on the Java side as well.  \n\n-Danny", "id": 113062, "time": "2008-01-22T15:27:57Z", "creator": "dkatzel@jcvi.org", "creation_time": "2008-01-22T15:27:57Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 41187, "attachment_id": null, "id": 116473, "time": "2008-05-11T01:25:05Z", "creator": "josh@apache.org", "creation_time": "2008-05-11T01:25:05Z", "is_private": false, "text": "fixed in svn r655278.\n\nHSSFSheet needed to be modified to handle files missing the ROW records. An extra fix was to set the default row height flag properly.\n\nThe attached file (id=19267) was not so obscure.  Quite a few existing HSSF junit example files already had this characteristic.  POI was just ignoring all rows in those spreadsheets."}]