[{"count": 0, "tags": [], "creator": "knst.kolinko@gmail.com", "text": "A minor issue, reported in Re:r1614165,\nhttp://markmail.org/message/4iplahbcanujbqoo\n\nThe Manager application has commands that display distribution of sessions according to their idle time. (The commands are \"/text/sessions\", \"/text/expire\" in Test GUI and \"Expire Sessions\" button in HTML GUI.)\n\nThe commands display how many sessions have idle time <1 minute, from 1 up to 2 minutes (1 - <2), from 2 to 3 (2 - <3) and so on.\n\nLets assume that a web application is configured with session-timeout of 30 minutes. Before r1614165 (in 7.0.56)/r1614163 (in 8.0.11) the last time slot in that statistics was labeled \">= 30\". In those revisions it was fixed to be labeled \"29 - <30\".\n\nActually it should have been labeled \">= 29\", as sessions that have idle time more than 30 minutes are actually added to the value,\n\n else if (time >= maxCount)\n timeout[maxCount-1]++; \n\nIt would be better to count outdated sessions in a separate time slot, so that  \"29 - <30\" and \">=30\" were two distinct numbers.\n\nOne may see \">=30\" sessions if the thread that performs expiration have not run yet (or is stuck).\n\n\nAn incorrect configuration to test this behaviour:\n1. Configure examples application with the following text in its web.xml\n\n <session-config>\n  <session-timeout>2</session-timeout>\n </session-config> \nand the following META-INF/context.xml\n <Context backgroundProcessorDelay=\"10\"/>\n\n2. Configure a user with roles manager-script and manager-gui. Start Tomcat.\n\n3. Visit example webapp -> Servlet examples -> Session example to create a session.\n\n4. Visit http://localhost:8080/manager/html, click on sessions number on the row for the examples webapp. A list of sessions opens. Use it to check idle time of the session.\n\n5. Visit http://localhost:8080/manager/text/sessions?path=/examples to see sessions statistics.\n\n6. Wait for 2 minutes.\nExpected output of /text/sessions command is that you have a session that is idle for more than 2 minutes.\n\nActual output is \"1 - <2 minutes: 1 sessions\"", "id": 179595, "time": "2014-12-07T07:01:34Z", "bug_id": 57323, "creation_time": "2014-12-07T07:01:34Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "knst.kolinko@gmail.com", "text": "Fixed in Tomcat trunk, 8 and 7 (r1643654/r1643655/r1643656). It will be in 7.0.58, 8.0.16.", "id": 179596, "time": "2014-12-07T07:50:24Z", "bug_id": 57323, "creation_time": "2014-12-07T07:50:24Z", "is_private": false, "attachment_id": null}]