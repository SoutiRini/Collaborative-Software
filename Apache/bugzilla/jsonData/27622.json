[{"count": 0, "tags": [], "creator": "simon.niederberger@want.ch", "attachment_id": null, "text": "(1) My workbook has sheets SHA, SHB, SHC, ...\n(2) Create a named range pointing to e.g. SHD!$A$2:$A$16\n(3) Delete some sheets (not SHD, of course)\n(4) The named range now points to e.g. SHA!$A$2:$A$16\n\nFrom taking a glimpse at HSSFName, I guess named ranges are internally linked \nto the sheet nidex rather than the name. I guess when running \nworkbook.removeSheet, the indexes of the named ranges are not update (or \nsomething like that)\nNOTE: haven't tried release 2.5, maybe it's already fixed there.\n\nThanks nd good luck\nSimon", "id": 53909, "time": "2004-03-12T08:24:07Z", "bug_id": 27622, "creation_time": "2004-03-12T08:24:07Z", "is_private": false}, {"count": 1, "tags": [], "text": "Here's the source code (snippet) [works with a workbook containing sheets \nSHA ... SHG]\n\n\t\t\t// **** CREATE NAMED RANGE **** \n\t\t\tint idxRange = _book.getNameIndex(\"MYRANGE\");\n\t\t\tHSSFName name;\n\t\t\tif (idxRange == -1) {\n\t\t\t\tname = _book.createName();\n\t\t\t\tname.setNameName(\"MYRANGE\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\tname = _book.getNameAt(idxRange);\n\t\t\t}\n\t\t\t\n\t\t\tname.setReference(\"SHC!$A$2:$A$8\");\n\n\t\t\t// **** DELETE SOME SHEETS **** \n\t\t\tint idxSheet;\n\t\t\tidxSheet = _book.getSheetIndex(\"SHB\");\n\t\t\tif (idxSheet > 0) {\n\t\t\t\t_book.removeSheetAt(idxSheet);\n\t\t\t}\n\t\t\t\n\t\t\tidxSheet = _book.getSheetIndex(\"SHF\");\n\t\t\tif (idxSheet > 0) {\n\t\t\t\t_book.removeSheetAt(idxSheet);\n\t\t\t}\n\n... and MYRANGE will point to SHD!$A$2:$A$8 (instead of SHC).\n\nCurrent workaround is to first delete the sheets, then create the range, so \nthe bug fix isn't really urgent.", "attachment_id": null, "id": 54037, "creator": "simon.niederberger@want.ch", "time": "2004-03-15T19:55:42Z", "bug_id": 27622, "creation_time": "2004-03-15T19:55:42Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 27622, "text": "Could you please try poi-3.1-beta1 and report if the problem still persists? \n\nYegor", "count": 2, "id": 116732, "time": "2008-05-17T04:33:35Z", "creator": "yegor@dinom.ru", "creation_time": "2008-05-17T04:33:35Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 27622, "attachment_id": null, "id": 116844, "time": "2008-05-20T07:54:24Z", "creator": "simon.niederberger@want.ch", "creation_time": "2008-05-20T07:54:24Z", "is_private": false, "text": "Sorry, I've moved to a different project in the meantime and don't have the original source code available."}, {"attachment_id": null, "tags": [], "bug_id": 27622, "text": "Guessing this is now fixed. Please re-open the bug if it still occurs on re-testing with a recent version (eg 3.1), if you do happen to find the source to test against again", "count": 4, "id": 119449, "time": "2008-08-05T15:57:54Z", "creator": "apache@gagravarr.org", "creation_time": "2008-08-05T15:57:54Z", "is_private": false}]