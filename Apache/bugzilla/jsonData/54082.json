[{"count": 0, "tags": [], "bug_id": 54082, "text": "Created attachment 29536\nOutput\n\nI have a nested grouping with one parent and two children. \nThe first level is expanded. The first child is expanded and the second one collapsed. I expand/collapse the groups using setRowGroupCollapsed. The problem is that if I set the second child as NOT expanded, the first one is also closed (see attachment)\n\n\n\n\nHere the code:\n\n\nimport java.io.FileOutputStream;\nimport java.io.IOException;\n\nimport org.apache.poi.ss.usermodel.Sheet;\nimport org.apache.poi.ss.usermodel.Workbook;\nimport org.apache.poi.xssf.usermodel.XSSFWorkbook;\n\n\npublic class ExcelGroupRowTest {\n\n\t/**\n\t * @param args\n\t */\n\tpublic static void main(String[] args) {\n\t\ttry{\n\t\tWorkbook wb = new XSSFWorkbook();\n\t\tSheet sheet = wb.createSheet(\"Mysheet\");\n\t\tsheet.groupRow(1, 20);\n\t\tsheet.setRowGroupCollapsed(1, false);\n\t\t\n\t\tsheet.groupRow(5, 10);\n\t\tsheet.setRowGroupCollapsed(5, false);\n\t\t\n\n\t\tsheet.groupRow(12, 14);\n\t\tsheet.setRowGroupCollapsed(12, true);\n\t\t\n    FileOutputStream fileOut = new FileOutputStream(\"workbook.xlsx\");\n\t\t\twb.write(fileOut);\n\t\t\tfileOut.close();\n\t\t}catch (IOException e){\n\n\t\t\te.printStackTrace();\n\t\t}\n\n\t}\n\n}", "id": 163094, "time": "2012-10-31T17:06:10Z", "creator": "michele.croci@immopac.ch", "creation_time": "2012-10-31T17:06:10Z", "is_private": false, "attachment_id": 29536}, {"count": 1, "tags": [], "bug_id": 54082, "is_private": false, "id": 163095, "attachment_id": null, "creator": "michele.croci@immopac.ch", "creation_time": "2012-10-31T17:09:06Z", "time": "2012-10-31T17:09:06Z", "text": "I have looked at the source code, one possible patch would be to modify the writeHidden method in this way:\n\n\n    private int writeHidden(XSSFRow xRow, int rowIndex, boolean hidden) {\n      int level = xRow.getCTRow().getOutlineLevel();\n      int currentRow;\n      for (currentRow = rowIndex; currentRow < getLastRowNum(); currentRow++) {\n          if (getRow(currentRow) == null\n                  || getRow(currentRow).getCTRow().getOutlineLevel() < level) {\n              break;\n          }else{\n          \tgetRow(currentRow).getCTRow().setHidden(hidden);\n          }\n      }\n      return currentRow;\n    }"}, {"count": 2, "tags": [], "bug_id": 54082, "attachment_id": null, "is_private": false, "id": 165424, "time": "2013-02-21T13:08:02Z", "creator": "dm.smirnov@gmail.com", "creation_time": "2013-02-21T13:08:02Z", "text": "*** Bug 53582 has been marked as a duplicate of this bug. ***"}, {"attachment_id": null, "tags": [], "bug_id": 54082, "is_private": false, "count": 3, "id": 184538, "time": "2015-08-13T08:18:11Z", "creator": "mcroci@gmail.com", "creation_time": "2015-08-13T08:18:11Z", "text": "still no official fix for this Bug?"}]