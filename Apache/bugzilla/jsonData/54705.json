[{"count": 0, "tags": [], "creator": "jan.stette@gmail.com", "is_private": false, "id": 165865, "attachment_id": null, "bug_id": 54705, "creation_time": "2013-03-15T16:38:55Z", "time": "2013-03-15T16:38:55Z", "text": "I'm seeing a very strange problem where cells containing dates become unreadable after certain operations on certain spreadsheet. The following unit tests reproduces the problem consistently with a specific spreadsheet. Unfortunately this contains confidential data so I can't provide this. Also, I can't create a spreadsheet with the sensitive data removed, as the problem goes away as soon as the spreadsheet is re-saved from Excel!\n\nThe test looks as follows:\n\n    public void testGetCellFormat() throws Exception {\n        try (InputStream inputStream = getClass().getResourceAsStream(\n                \"spreadsheet.xls\")) {\n            Workbook workbook = WorkbookFactory.create(inputStream);\n\n            CellStyle styleBefore =\n              workbook.getSheetAt(0).getRow(7).getCell(7).getCellStyle();\n            String dateFormatBefore = styleBefore.getDataFormatString();\n            int dateFormatIndexBefore = styleBefore.getDataFormat();\n            \n            assertNull(\"Randomly chosen cell has no comment\", \n              workbook.getSheetAt(0).getRow(0).getCell(0).getCellComment());\n            \n            CellStyle styleAfter = \n              workbook.getSheetAt(0).getRow(7).getCell(7).getCellStyle();\n            String dateFormatAfter = styleAfter.getDataFormatString();\n            int dateFormatIndexAfter = styleAfter.getDataFormat();\n\n            assertEquals(\"Should be the same\", \n              dateFormatBefore, dateFormatAfter);\n            assertEquals(\"Should be the same\",\n              dateFormatIndexBefore, dateFormatIndexAfter);\n        }\n    }\n\nThis fails on the first assertion with the error: \"expected:<[M/d/yyyy  hh:mm:ss ]> but was:<[General]>\"\n\nBasically, the date format of the cell is OK before the call to getCellComment(), but consistently returns the wrong result after (it then returns \"General\"). Note that getCellComment() is called on an unrelated cell! And the cell format is broken on ALL cells in the spreadsheet after this call."}, {"attachment_id": null, "tags": [], "creator": "dominik.stadler@gmx.at", "is_private": false, "count": 1, "id": 167421, "time": "2013-05-25T21:42:42Z", "bug_id": 54705, "creation_time": "2013-05-25T21:42:42Z", "text": "This works for me both with a sample XLS and XLSX file. Can you please attach the actual file \"spreadsheet.xls\" to let us reproduce the problem?"}, {"count": 2, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "text": "No update for a long time, thus resolving this bug now.", "id": 183268, "time": "2015-06-01T21:24:24Z", "bug_id": 54705, "creation_time": "2015-06-01T21:24:24Z", "is_private": false}]