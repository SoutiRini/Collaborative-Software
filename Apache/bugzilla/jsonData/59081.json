[{"count": 0, "tags": [], "text": "If I configure JSSE connector (NIO) with JSSE implementation, and explicit JSSE ciphers list, my resulting list of enabled ciphers is ordered differently from what I configured.\n\nThe reason for that seems to be in method SSLUtilBase.getEnabled which creates list of enabled ciphers like this:\n\n  enabled.addAll(implemented);\n  enabled.retainAll(configured);\n\nResulting List contains intersection between configured and implemented ciphers, but having the order of implemented ciphers, and that is not what the user wants. I guess, it should keep the order of configured ciphers, like this:\n\n  enabled.addAll(configured);\n  enabled.retainAll(implemented);\n\nRight?\n\n\nThe second issue with cipher ordering is that OpenSSLCipherConfigurationParser.parse always returns:\n\n  return defaultSort(ciphers);\n\nI am not sure what's the intention here, because defaultSort method may change user-defined cipher order.\n\n\nMy cipher configuration:\n\n[TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384, TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA, TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA, TLS_DHE_RSA_WITH_AES_256_CBC_SHA, TLS_DHE_RSA_WITH_AES_128_CBC_SHA, TLS_RSA_WITH_3DES_EDE_CBC_SHA]\n\ndefaultSort(ciphers) changes order to:\n\n[TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384, TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA, TLS_DHE_RSA_WITH_AES_256_CBC_SHA, TLS_DHE_RSA_WITH_AES_128_CBC_SHA, TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA, TLS_RSA_WITH_3DES_EDE_CBC_SHA]\n\nAnd getEnabled changes order to:\n\n[TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA, TLS_DHE_RSA_WITH_AES_128_CBC_SHA, SSL_RSA_WITH_3DES_EDE_CBC_SHA, TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384, TLS_DHE_RSA_WITH_AES_256_CBC_SHA, TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA]", "is_private": false, "bug_id": 59081, "id": 188874, "time": "2016-02-26T23:18:04Z", "creator": "ognjen.d.blagojevic@gmail.com", "creation_time": "2016-02-26T23:18:04Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "text": "Good catch.\n\nI've fixed both those issues for 9.0.x (9.0.0.M4 onwards). 8.0.x is only affected by the defaultSort() issue. that has been fixed for 8.0.33 onwards.", "id": 189048, "time": "2016-03-03T11:16:31Z", "bug_id": 59081, "creation_time": "2016-03-03T11:16:31Z", "is_private": false}]