[{"count": 0, "tags": [], "text": "When using ssh to execute remote scripts containing \"sudo\" you get the following error if /etc/sudoers contains \"Defaults requiretty\".\n\nsudo: sorry, you must have a tty to run sudo\n\nThe solution is to edit your sudoers file or add support for pseudo tty allocation (this is the same as the ssh -t option in unix).\n\nAdding support for pseudo tty connections is a minor change:\n\nIn SSHExec.java\n    private boolean tty = false;\n    public void setTty(boolean tty) {\n        this.tty = tty;\n    }\n\n\n    private void executeCommand(Session session, String cmd, StringBuffer sb)\n...\n            final ChannelExec channel;\n            session.setTimeout((int) maxwait);\n            /* execute the command */\n            channel = (ChannelExec) session.openChannel(\"exec\");\n            channel.setCommand(cmd);\n            channel.setOutputStream(tee);\n            channel.setExtOutputStream(tee);\n            if (istream != null) {\n                channel.setInputStream(istream);\n            }\n+           channel.setPty(tty);\n            channel.connect();", "attachment_id": null, "bug_id": 52554, "id": 153272, "time": "2012-01-30T03:47:21Z", "creator": "richard.allwood@suncorp.com.au", "creation_time": "2012-01-30T03:47:21Z", "is_private": false}, {"count": 1, "tags": [], "text": "added with svn revision 1239121", "is_private": false, "id": 153344, "creator": "bodewig@apache.org", "time": "2012-02-01T13:21:34Z", "bug_id": 52554, "creation_time": "2012-02-01T13:21:34Z", "attachment_id": null}]