[{"count": 0, "tags": [], "text": "When using a reverse proxy, mod_proxy is not properly parsing the Set-Cookie header when modifying on the way back to the client.\n\nThe issue is in the definition of the string matcher:\n\n    ap_proxy_strmatch_path = apr_strmatch_precompile(pconf, \"path=\", 0);\n    ap_proxy_strmatch_domain = apr_strmatch_precompile(pconf, \"domain=\", 0);\n\nThe issue is obvious to see and easily reproduced if the origin server sets a cookie whose name ends in the word \"path\" or \"domain\".\n\nFor example, if the reverse proxy has a configuration directive such as:\nProxyPassReverseCookiePath  /  /my/nested/path\n\nand the origin server sets a header like:\nSet-Cookie: testPath=/hello;path=/\n\nthen the reverse proxy will rewrite the value of the cookie in the header to:\nSet-Cookie: testPath=/my/nested/path;path=/\n\nwhich is to say, it did NOT rewrite the cookie path (still \"/\"), but rather it rewrote the cookie value because the cookie name ended with the letters \"path\".", "attachment_id": null, "id": 201096, "creator": "bart+apache@cilfone.com", "time": "2017-09-23T00:05:11Z", "bug_id": 61560, "creation_time": "2017-09-23T00:05:11Z", "is_private": false}]