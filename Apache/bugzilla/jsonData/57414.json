[{"count": 0, "tags": [], "bug_id": 57414, "text": "hi,\nwhile writing xssf file, i am getting a Exception saying \nCaused by: java.lang.ClassCastException: Caused by: java.lang.ClassCastException: org.apache.xerces.jaxp.DocumentBuilderFactoryImpl cannot be cast to javax.xml.parsers.DocumentBuilderFactory\n\tat javax.xml.parsers.DocumentBuilderFactory.newInstance(Unknown Source)\n\tat org.apache.poi.util.DocumentHelper.<clinit>(DocumentHelper.java:52)\n\t... 121 more\n\n\n\nDetails:\n\npom.xml\n\n\t\t<groupId>org.apache.poi</groupId>\n\t\t\t<artifactId>poi</artifactId>\n\t\t\t<version>3.11</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>org.apache.poi</groupId>\n\t\t\t<artifactId>poi-ooxml</artifactId>\n\t\t\t<version>3.11</version>\n\t\t\t<exclusions>\n\t\t\t\t<!-- STAX comes with Java 1.6 -->\n\t\t\t\t<exclusion>\n\t\t\t\t\t<artifactId>stax-api</artifactId>\n\t\t\t\t\t<groupId>javax.xml.stream</groupId>\n\t\t\t\t</exclusion>\n\t\t\t\t<exclusion>\n\t\t\t\t\t<artifactId>stax-api</artifactId>\n\t\t\t\t\t<groupId>stax</groupId>\n\t\t\t\t</exclusion>\n\t\t\t</exclusions>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>dom4j</groupId>\n\t\t\t<artifactId>dom4j</artifactId>\n\t\t\t<version>1.6.1</version>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>org.apache.geronimo.specs</groupId>\n\t\t\t<artifactId>geronimo-stax-api_1.2_spec</artifactId>\n\t\t\t<version>1.2</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>org.codehaus.woodstox</groupId>\n\t\t\t<artifactId>woodstox-core-lgpl</artifactId>\n\t\t\t<version>4.4.1</version>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>xerces</groupId>\n\t\t\t<artifactId>xerces</artifactId>\n\t\t\t<version>2.4.0</version>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>xerces</groupId>\n\t\t\t<artifactId>xmlParserAPIs</artifactId>\n\t\t\t<version>2.6.2</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>xerces</groupId>\n\t\t\t<artifactId>xercesImpl</artifactId>\n\t\t\t<version>2.11.0</version>\n\t\t</dependency>\n\n\n\nLibrary Inside war:\n\n xercesImpl-2.4.0.jar\n xml-apis-1.3.04.jar\n xml-apis-ext-1.3.04.jar", "id": 180160, "time": "2015-01-05T13:52:07Z", "creator": "amit04jain@gmail.com", "creation_time": "2015-01-05T13:52:07Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 180165, "time": "2015-01-05T16:25:00Z", "bug_id": 57414, "creation_time": "2015-01-05T16:25:00Z", "is_private": false, "text": "That looks a very complicated pom file, and if your project is just doing POI stuff, it contains lots of things that aren't needed, and most likely one of those is breaking it\n\nYou should be fine with just:\n\n\n\t\t<groupId>org.apache.poi</groupId>\n\t\t\t<artifactId>poi</artifactId>\n\t\t\t<version>3.11</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>org.apache.poi</groupId>\n\t\t\t<artifactId>poi-ooxml</artifactId>\n\t\t\t<version>3.11</version>\n\t\t</dependency>\n\nNo need for any exclusions with 3.11, no need for anything else!"}, {"count": 2, "tags": [], "bug_id": 57414, "text": "i tried the same but now i am getting below error\n\n \torg/xml/sax/SAXException: java.lang.NoClassDefFoundError: org/xml/sax/SAXException", "id": 180170, "attachment_id": null, "creator": "amit04jain@gmail.com", "creation_time": "2015-01-06T07:37:40Z", "time": "2015-01-06T07:37:40Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 57414, "attachment_id": null, "id": 182030, "time": "2015-03-23T21:49:12Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-03-23T21:49:12Z", "is_private": false, "text": "These are included in Java 6 and newer, so it seems you are either using a Java prior to 6 (which is not supported any more by POI), or the JRE that you are using is not fully conforming to standards, e.g. we had similar problems with IBM JDK, where using IBM JDK 7 resolved problems.\n\nPlease review http://poi.apache.org/faq.html#faq-N1017E and see if the suggestions there make it work. \n\nFor now I cannot see any problem in POI, therefore I am closing this as WORKSFORME, please reopen with more information and full code to reproduce the error if you still think this is caused by POI itself."}]