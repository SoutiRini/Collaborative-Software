[{"count": 0, "tags": [], "creator": "g.bronzetti@sourcesense.com", "is_private": false, "text": "HSSFWorkBook.setRepeatingRowsAndColumns() generates new NameRecord\nitems all with empty 'field_12_name_text' and all with the same\n'field_12_builtIn_name', that is 'Print_Title'.\nThis makes Excel asking for the setting of a new name for all the\nduplicated NameRecord items before opening the file.\nThis causes some problems with page breaks, too.\nThis behavior happens only with the follow versions of Excel:\nOffice 2007: all languages\nOffice 03: german\nOffice XP: german", "id": 117325, "time": "2008-06-04T02:00:47Z", "bug_id": 45126, "creation_time": "2008-06-04T02:00:47Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "Created attachment 22069\nPatch", "is_private": false, "id": 117326, "creation_time": "2008-06-04T02:03:40Z", "time": "2008-06-04T02:03:40Z", "creator": "g.bronzetti@sourcesense.com", "bug_id": 45126, "attachment_id": 22069}, {"count": 2, "attachment_id": 22070, "bug_id": 45126, "is_private": false, "id": 117329, "time": "2008-06-04T02:56:11Z", "creator": "g.bronzetti@sourcesense.com", "creation_time": "2008-06-04T02:56:11Z", "tags": [], "text": "Created attachment 22070\nsample excel spreadsheet that causes problem"}, {"count": 3, "tags": [], "creator": "josh@apache.org", "text": "(In reply to comment #1)\n> Created an attachment (id=22069) [details]\n> Patch\n> \n\nI have a few suggestions regarding the proposed patch\n\n(1) It seems like the new logic in Workbook.createBuiltInName() checks for a built-in name clash (effectively comparing the byte field field_12_builtIn_name on NameRecord).  If there is a clash, the new built-in name record is replaced with a *non*-built-in name record with nameText \"Excel_BuiltIn_Titles_\" + <digit> (where digit is chosen to make the name unique).  \nWhat is the justification for creating a non-built-in name record when a built-in name was requested?  I can't find any reference to the name \"Excel_BuiltIn_Titles\".  \nPerhaps the more correct operation would be to not add a name record, if one already exists.\n\n(2) A new junit is required, showing the mistake (as visible in latest POI svn).\n\n(3) The deletion of lines from the existing junit looks like it might be wrong.  From what I can see in the API, the print-area can be set per sheet, and therefore a workbook with more than one sheet can have multiple print areas. The name of the unit test method and the comment also seem to support this.  I made a modification to the test case in svn r663322 - duplicating the checks for the multiple print areas before and after re-serialization.  This should make POI's *current* behaviour clearer.  If POI is wrong (in attempting to support multiple print areas) we'll need to change quite a few things. \n\n(4) checkNameAlreadyExists() or any method like it belongs on LinkTable.  As mentioned above, the name check might need to take sheetIx into account for built-in names. Should the name comparison be case-insensitive?  Either way add a comment.", "id": 117348, "time": "2008-06-04T10:48:12Z", "bug_id": 45126, "creation_time": "2008-06-04T10:48:12Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "g.bronzetti@sourcesense.com", "text": "Created attachment 22153\npatch\n\n\nI create non-built-in name record in order to imitate the same correct behavior of OpenOffice.\nIn effect if I open an xls file create with POI in OpenOffice and then I save the file, \nI notice that all built-in record generated by POI like \"Print_Titles\" are changed like\n\"Excel-BuiltInPrintTitles + Sheet Number + progressive number\". \n\nI attach a reviewed patch to fix the problem and 2 xsl file created \nbefore and after the pach to show the mistake.\nIf you try to open the file 45126_old.xls with MSOffice2007 you will prompt to insert a new name.\nInstead the file 45126.xls, which is generated with the patched POI, you'll be able to open it \nnormally.", "id": 117862, "time": "2008-06-20T06:10:44Z", "bug_id": 45126, "creation_time": "2008-06-20T06:10:44Z", "is_private": false, "attachment_id": 22153}, {"count": 5, "tags": [], "creator": "g.bronzetti@sourcesense.com", "is_private": false, "text": "Created attachment 22154\nexcel that causes problem", "id": 117863, "time": "2008-06-20T06:11:50Z", "bug_id": 45126, "creation_time": "2008-06-20T06:11:50Z", "attachment_id": 22154}, {"count": 6, "tags": [], "text": "Created attachment 22155\nexcel  without problem generated applying the proposed patch", "is_private": false, "id": 117864, "creation_time": "2008-06-20T06:13:34Z", "time": "2008-06-20T06:13:34Z", "creator": "g.bronzetti@sourcesense.com", "bug_id": 45126, "attachment_id": 22155}, {"count": 7, "tags": [], "creator": "apache@gagravarr.org", "text": "Thanks for this patch. I've applied something like it to svn trunk (I moved the duplicate name detection logic to LinkTable, but otherwise left it about as was)\n\nI've also run your test case, and it opens fine in excel, no warnings", "id": 118502, "time": "2008-07-10T14:49:29Z", "bug_id": 45126, "creation_time": "2008-07-10T14:49:29Z", "is_private": false, "attachment_id": null}]