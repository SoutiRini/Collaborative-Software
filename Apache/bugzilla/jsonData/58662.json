[{"count": 0, "tags": [], "creator": "rmannibucau@gmail.com", "is_private": false, "id": 186598, "attachment_id": null, "bug_id": 58662, "creation_time": "2015-11-27T12:23:04Z", "time": "2015-11-27T12:23:04Z", "text": "Tomcat (at least 7 to 9) uses custom ObjectInputStream, since the server can't control the fact a user add one of the vulnerable libraries in the same classloader as tomcat (aka common.loader), tomcat should blacklist these classes.\n\nThis can be done with https://github.com/apache/tomee/blob/master/container/openejb-core/src/main/java/org/apache/openejb/core/rmi/BlacklistClassResolver.java (adapting the config I guess) and calling check(name) here https://github.com/apache/tomcat/blob/trunk/java/org/apache/catalina/util/CustomObjectInputStream.java#L74 around classDesc.getName() before loading the class"}, {"count": 1, "tags": [], "bug_id": 58662, "text": "If an attacker can add a JAR to that directory then deserialization is likely to be the least of your worries.\n\nThe recent spate of deserialization issues is only of concern if an application accepts untrusted data and deserializes without validation/sanitization. A default Tomcat install does not expose any such mechanism. If an application chooses to accept such input then validation/sanitization is an application concern.\n\nI'll also note that security concerns should be raised via the security list, not via a public bug tracker.", "id": 186607, "time": "2015-11-27T20:18:09Z", "creator": "markt@apache.org", "creation_time": "2015-11-27T20:18:09Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "text": "You dont need to be able to add a jar to lib directory. The point was a user can do it in its installation and this can have side effects. Or do you mean that adding a jar to tomcat/lib makes tomcat no more supported?", "is_private": false, "bug_id": 58662, "id": 186609, "time": "2015-11-27T20:52:12Z", "creator": "rmannibucau@gmail.com", "creation_time": "2015-11-27T20:52:12Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 58662, "is_private": false, "count": 3, "id": 186614, "time": "2015-11-27T20:55:54Z", "creator": "markt@apache.org", "creation_time": "2015-11-27T20:55:54Z", "text": "If a system admin adds a JAR then it is a non-issue. To repeat my previous comment:\n<quote>\nThe recent spate of deserialization issues is only of concern if an application accepts untrusted data and deserializes without validation/sanitization. A default Tomcat install does not expose any such mechanism.\n</quote>\n\nTherefore, adding one of the known enabling JARs - or some currently unknown enablign JAR - to Tomcat does not create a security issue that can be exploited by a remote attacker."}]