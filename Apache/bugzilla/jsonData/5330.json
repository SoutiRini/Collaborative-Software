[{"count": 0, "tags": [], "bug_id": 5330, "text": "I put some object into HttpSession. Object implements \nHttpSession listener, and should perform some \noperation on JNDI context. Everything work fine for \nmethod 'valueBound(HttpSessionBindingEvent event)', \nbut if I try to work with with JNDI from  \nmethod 'valueUnbound(HttpSessionBindingEvent event)', \nI've got NameNotFoundException: conext 'env' not bound.\nThis problem occusre when session expired. I didn't perform any action from \ncustom thread, nor action during undeploing application.\nhere is log file:\nStarting service Tomcat-Standalone\nApache Tomcat/4.0.1\nStarting service Tomcat-Apache\nApache Tomcat/4.0.1\nBound into session: 04C46173A2F1381392C4C9A843D517F7\nIs session new: true\nEvent name: TestSessionScopeJNDI\nClassLoader: WebappClassLoader\n  available:\n  delegate: false\n  repositories:\n    /WEB-INF/classes/\n  required:\n----------> Parent Classloader:\nStandardClassLoader\n  available:\n  delegate: true\n  repositories:\n    file:F:\\tools\\catalina\\classes\\\n    file:F:\\tools\\catalina\\lib\\jasper-compiler.jar\n    file:F:\\tools\\catalina\\lib\\jasper-runtime.jar\n    file:F:\\tools\\catalina\\lib\\naming-factory.jar\n  required:\n----------> Parent Classloader:\nStandardClassLoader\n  available:\n    Extension[javax.mail, implementationVendor=Sun Microsystems, Inc., implement\nationVendorId=com.sun, implementationVersion=1.2, specificationVendor=Sun Micros\nystems, Inc., specificationVersion=1.2]\n  delegate: true\n  repositories:\n    file:F:\\tools\\catalina\\common\\classes\\\n    file:F:\\tools\\catalina\\common\\lib\\activation.jar\n    file:F:\\tools\\catalina\\common\\lib\\jdbc2_0-stdext.jar\n    file:F:\\tools\\catalina\\common\\lib\\jta.jar\n    file:F:\\tools\\catalina\\common\\lib\\mail.jar\n    file:F:\\tools\\catalina\\common\\lib\\naming-common.jar\n    file:F:\\tools\\catalina\\common\\lib\\naming-resources.jar\n    file:F:\\tools\\catalina\\common\\lib\\servlet.jar\n    file:F:\\tools\\catalina\\common\\lib\\tyrex-0.9.7.0.jar\n    file:F:\\tools\\catalina\\common\\lib\\xerces.jar\n  required:\n----------> Parent Classloader:\nsun.misc.Launcher$AppClassLoader@71732b\n\n\n\n\nUnbound from session: 04C46173A2F1381392C4C9A843D517F7\nEvent name: TestSessionScopeJNDI\nClassLoader: StandardClassLoader\n  available:\n  delegate: true\n  repositories:\n    file:F:\\tools\\catalina\\server\\classes\\\n    file:F:\\tools\\catalina\\server\\lib\\catalina.jar\n    file:F:\\tools\\catalina\\server\\lib\\jakarta-regexp-1.2.jar\n    file:F:\\tools\\catalina\\server\\lib\\servlets-common.jar\n    file:F:\\tools\\catalina\\server\\lib\\servlets-default.jar\n    file:F:\\tools\\catalina\\server\\lib\\servlets-invoker.jar\n    file:F:\\tools\\catalina\\server\\lib\\servlets-manager.jar\n    file:F:\\tools\\catalina\\server\\lib\\servlets-snoop.jar\n    file:F:\\tools\\catalina\\server\\lib\\servlets-webdav.jar\n    file:F:\\tools\\catalina\\server\\lib\\tomcat-ajp.jar\n    file:F:\\tools\\catalina\\server\\lib\\tomcat-util.jar\n    file:F:\\tools\\catalina\\server\\lib\\warp.jar\n  required:\n----------> Parent Classloader:\nStandardClassLoader\n  available:\n    Extension[javax.mail, implementationVendor=Sun Microsystems, Inc., implement\nationVendorId=com.sun, implementationVersion=1.2, specificationVendor=Sun Micros\nystems, Inc., specificationVersion=1.2]\n  delegate: true\n  repositories:\n    file:F:\\tools\\catalina\\common\\classes\\\n    file:F:\\tools\\catalina\\common\\lib\\activation.jar\n    file:F:\\tools\\catalina\\common\\lib\\jdbc2_0-stdext.jar\n    file:F:\\tools\\catalina\\common\\lib\\jta.jar\n    file:F:\\tools\\catalina\\common\\lib\\mail.jar\n    file:F:\\tools\\catalina\\common\\lib\\naming-common.jar\n    file:F:\\tools\\catalina\\common\\lib\\naming-resources.jar\n    file:F:\\tools\\catalina\\common\\lib\\servlet.jar\n    file:F:\\tools\\catalina\\common\\lib\\tyrex-0.9.7.0.jar\n    file:F:\\tools\\catalina\\common\\lib\\xerces.jar\n  required:\n----------> Parent Classloader:\nsun.misc.Launcher$AppClassLoader@71732b\n\n\njavax.naming.NameNotFoundException: Name java:comp is not bound in this Context\n        at org.apache.naming.NamingContext.lookup(NamingContext.java:811)\n        at org.apache.naming.NamingContext.lookup(NamingContext.java:194)\n        at javax.naming.InitialContext.lookup(InitialContext.java:350)\n        at JndiPrintBean.valueUnbound(JndiPrintBean.java:50)\n        at org.apache.catalina.session.StandardSession.removeAttribute(StandardS\nession.java:1073)\n        at org.apache.catalina.session.StandardSession.expire(StandardSession.ja\nva:596)\n        at org.apache.catalina.session.StandardManager.processExpires(StandardMa\nnager.java:755)\n        at org.apache.catalina.session.StandardManager.run(StandardManager.java:\n831)\n        at java.lang.Thread.run(Thread.java:484)", "id": 8719, "time": "2001-12-08T20:53:45Z", "creator": "alexpavlov.geo@yahoo.com", "creation_time": "2001-12-08T20:53:45Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "text": "The bindings are not set for the thread which is in charge of the session\npassivation, so that's why the ENC is not usable there at the moment.", "attachment_id": null, "id": 8963, "creator": "remm@apache.org", "time": "2001-12-17T01:30:31Z", "bug_id": 5330, "creation_time": "2001-12-17T01:30:31Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 5330, "attachment_id": null, "text": "Yes, I figured out what different threads are responsible for this tasks:\ncalls of bound/unbound methods. But other containers, like BEA's Weblogic and \nOrion (these ones I tested)provide access to ENC context in both methods, I \ndidn't look at specification yet, but my assumption will be we have to have \naccess to ENC context in both cases.\n\n", "id": 8982, "time": "2001-12-17T18:09:04Z", "creator": "alexpavlov.geo@yahoo.com", "creation_time": "2001-12-17T18:09:04Z", "is_private": false}, {"count": 3, "text": "The manager thread's CCL should now be associated with the webapp classloader,\nwhich should make the ENC work. This needs testing, however.", "bug_id": 5330, "attachment_id": null, "id": 10608, "time": "2002-02-12T23:04:15Z", "creator": "remm@apache.org", "creation_time": "2002-02-12T23:04:15Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 5330, "attachment_id": null, "id": 10715, "time": "2002-02-14T18:45:04Z", "creator": "remm@apache.org", "creation_time": "2002-02-14T18:45:04Z", "is_private": false, "text": "The fix is included in 4.0.2."}, {"count": 5, "tags": [], "bug_id": 5330, "attachment_id": null, "text": "I tested it tonight. Everything work now. Good job, thank you.", "id": 10741, "time": "2002-02-15T04:13:26Z", "creator": "alexpavlov.geo@yahoo.com", "creation_time": "2002-02-15T04:13:26Z", "is_private": false}, {"count": 6, "attachment_id": null, "creator": "remm@apache.org", "text": "*** Bug 6984 has been marked as a duplicate of this bug. ***", "id": 11580, "time": "2002-03-08T16:38:04Z", "bug_id": 5330, "creation_time": "2002-03-08T16:38:04Z", "tags": [], "is_private": false}, {"count": 7, "attachment_id": null, "creator": "remm@apache.org", "text": "*** Bug 7126 has been marked as a duplicate of this bug. ***", "id": 11805, "time": "2002-03-14T17:29:26Z", "bug_id": 5330, "creation_time": "2002-03-14T17:29:26Z", "tags": [], "is_private": false}]