[{"count": 0, "tags": [], "creator": "andrew.roughan@writeme.com", "text": "Have the Recording Controller record any authorisations that are\nentered and populate the HTTP Authorisation component with the\nvalues.\nThis would assist with setting up the HTTP Authorisation Manager\ncorrectly.", "id": 48878, "time": "2003-12-11T02:33:56Z", "bug_id": 25430, "creation_time": "2003-12-11T02:33:56Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "dzmitry.kashlach@blazemeter.com", "text": "Created attachment 32182\nProxyControl patch\n\nPlease, review patch from attachment.\n\nWith this change ProxyControl should grab \"Authentication\" header, add Authentication Manager(if there was no any), add authentication.\nDuplicated Authentication records will be removed.", "id": 178911, "time": "2014-11-03T12:06:54Z", "bug_id": 25430, "creation_time": "2014-11-03T12:06:54Z", "is_private": false, "attachment_id": 32182}, {"count": 2, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "attachment_id": null, "id": 178954, "time": "2014-11-04T12:34:36Z", "bug_id": 25430, "creation_time": "2014-11-04T12:34:36Z", "is_private": false, "text": "Reopening as it was closed by error.\nThanks for patch, for next time , only update Keywords with PatchAvailable but don't Mark bug as Resolved.\nThanks"}, {"count": 3, "tags": [], "text": "Ok, Philippe.", "is_private": false, "bug_id": 25430, "id": 178957, "time": "2014-11-04T12:48:43Z", "creator": "dzmitry.kashlach@blazemeter.com", "creation_time": "2014-11-04T12:48:43Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "attachment_id": null, "id": 178966, "time": "2014-11-04T19:58:18Z", "bug_id": 25430, "creation_time": "2014-11-04T19:58:18Z", "is_private": false, "text": "Hello Dzimitry,\nFirst thank you for your contribution.\nFew notes on patch:\n- There are no javadocs for many methods, can you add meaningful docs that explains them and comments for some processing\n- AFAIU You code makes hypothesis that Authorization is Basic while it can be Digest. So you need to adapt code to handle this case, it would make it even smarter :-)\n- getAuthorization should be named differently as it in fact removes from Headers the one named HTTPConstants.HEADER_AUTHORIZATION) once it has handled the creation of Auth Manager. \n- Proxy#run : add some docs to explain that HEADER_AUTHORIZATION is removed\n- In AuthManager#addAuth , can you explain what removeMatchingAuthorizations exactly does\n\nThanks"}, {"count": 5, "tags": [], "creator": "dzmitry.kashlach@blazemeter.com", "attachment_id": 32190, "id": 178977, "time": "2014-11-05T11:11:55Z", "bug_id": 25430, "creation_time": "2014-11-05T11:11:55Z", "is_private": false, "text": "Created attachment 32190\nbug_25430_1.patch\n\n> getAuthorization should be named differently as it in fact removes from Headers the one named HTTPConstants.HEADER_AUTHORIZATION) once it has handled the creation of Auth Manager. \n\nIt extracts Authentication header from subconfigs and constructs Authentication object for further adding to Authentication Manager. Removing header is side-effect, not the main sense of this method. May be, it worth breaking it into two methods, but I have no clear idea about it.\n\n> AFAIU You code makes hypothesis that Authorization is Basic while it can be Digest. So you need to adapt code to handle this case, it would make it even smarter :-)\n\nYes, agree. How about such code?\nauthorization.setMechanism(authType.equals(\"Basic\")|authType.equals(\"Digest\")?\n                                AuthManager.Mechanism.BASIC_DIGEST:\n                                AuthManager.Mechanism.KERBEROS);\n\n> In AuthManager#addAuth , can you explain what removeMatchingAuthorizations exactly does\nIt iterates over Authorization objects in Authorization Manager and remove Authorization, which has the same fields as auth. I took this approach from Cookie Manager. I\u2019ve reviewed this part and made changes. Now authentication object added only in case, if there is no the same one in manager.\n\npublic void addAuth(Authorization newAuthorization) {\n        boolean alreadyExists=false;\n        PropertyIterator iter = getAuthObjects().iterator();\n        while (iter.hasNext()) {\n            Authorization authorization = (Authorization) iter.next().getObjectValue();\n            if (authorization == null) {\n                continue;\n            }\n            if (match(authorization,newAuthorization)) {\n                if (log.isDebugEnabled()) {\n                    log.debug(\"Found the same Authorization object = \" + newAuthorization.toString());\n                }\n                alreadyExists=true;\n            }\n        }\n        if(!alreadyExists){\n            getAuthObjects().addItem(newAuthorization);\n        }\n    }\n\nAlso added more comments to patch."}, {"count": 6, "tags": [], "text": "Date: Tue Dec 16 21:23:26 2014\nNew Revision: 1646084\n\nURL: http://svn.apache.org/r1646084\nLog:\nBug 25430 - HTTP(S) Test Script Recorder : Make it populate HTTP Authorisation Manager\nBugzilla Id: 25430\n\nModified:\n    jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/control/AuthManager.java\n    jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/proxy/Proxy.java\n    jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/proxy/ProxyControl.java\n    jmeter/trunk/xdocs/changes.xml\n    jmeter/trunk/xdocs/usermanual/component_reference.xml", "is_private": false, "bug_id": 25430, "id": 179803, "time": "2014-12-16T21:23:51Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2014-12-16T21:23:51Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 25430, "attachment_id": null, "is_private": false, "id": 179804, "time": "2014-12-16T21:30:12Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2014-12-16T21:30:12Z", "text": "Hi Dzmitry,\nThanks for Patch, I commited it with a bunch of changes:\n- Base64 conversion cannot work with Digest\n- Authorization header was not correctly removed\n- URL of Authorization was not created correctly, Domain was wrongly used\n- When I fail parsing or guessing I put in authorization:\n* ${AUTH_BASE_URL}\n* ${AUTH_LOGIN}\n* ${AUTH_PASSWORD}\n\n1/ Note I am not satisfied currently with the URL Matching nor guessing , but I don't see how to improve this.\n2/ I think it would be better to put AuthorizationManager as first child of Recording controller if possible it would be more visible\n\nPlease make as much tests as you can on your side.\n\nThanks"}, {"count": 8, "tags": [], "bug_id": 25430, "is_private": false, "id": 179805, "creation_time": "2014-12-16T21:36:25Z", "time": "2014-12-16T21:36:25Z", "creator": "p.mouawad@ubik-ingenierie.com", "text": "Date: Tue Dec 16 21:35:47 2014\nNew Revision: 1646093\n\nURL: http://svn.apache.org/r1646093\nLog:\nBug 25430 - HTTP(S) Test Script Recorder : Make it populate HTTP Authorisation Manager\nMatching should ignore login/password\nBugzilla Id: 25430\n\nModified:\n    jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/control/AuthManager.java", "attachment_id": null}, {"count": 9, "tags": [], "creator": "dzmitry.kashlach@blazemeter.com", "attachment_id": 32300, "id": 179833, "time": "2014-12-18T08:09:26Z", "bug_id": 25430, "creation_time": "2014-12-18T08:09:26Z", "is_private": false, "text": "Created attachment 32300\nAdd AuthManager as first node\n\nHi Philippe,\nThank you for feedback.\n\n1/ Yes, seems for now your variant is the best;\n2/ Please, review patch proxy_control.patch. I've noticed, that if Test tree is new, Test Recorder has default value \"Use recording controller\". In this case all recorded samples are added below WorkBench. I've implemented addition of AuthManager as 3rd element(TestPlan,WorkBench,...) in this case. Is it ok?"}, {"count": 10, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "attachment_id": null, "id": 179883, "time": "2014-12-19T21:39:09Z", "bug_id": 25430, "creation_time": "2014-12-19T21:39:09Z", "is_private": false, "text": "Hi Dzmitry,\nI don't think it is OK from what I understand but to be sure, could you show a screenshot of what you get without patch and what you get with it ?\n\nThx"}, {"count": 11, "tags": [], "creator": "dzmitry.kashlach@blazemeter.com", "attachment_id": 32315, "id": 179909, "time": "2014-12-21T07:52:02Z", "bug_id": 25430, "creation_time": "2014-12-21T07:52:02Z", "is_private": false, "text": "Created attachment 32315\nAuthManager_use_recording_controller\n\nPhillipe,\nPlease, look."}, {"count": 12, "tags": [], "bug_id": 25430, "attachment_id": null, "text": "This is an existing behaviour and is due to wrong configuration of Recording.\nI close this one and opened a new Bugzilla 57381 to change general recording behaviour if team is ok with it.", "id": 179913, "time": "2014-12-21T15:02:45Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2014-12-21T15:02:45Z", "is_private": false}, {"count": 13, "tags": [], "creator": "dzmitry.kashlach@blazemeter.com", "attachment_id": null, "id": 179922, "time": "2014-12-21T20:11:53Z", "bug_id": 25430, "creation_time": "2014-12-21T20:11:53Z", "is_private": false, "text": "So, what do you think about suggestion to make HTTP Auth Manager first element of node?\n\nIt may look like this:\n\nsrc/protocol/http/org/apache/jmeter/protocol/http/proxy/ProxyControl.java\n  try {\n                 log.debug(\"Creating HTTP Authentication manager for authorization:\"+authorization);\n                 AuthManager authManager = newAuthorizationManager(authorization);\n                JMeterTreeNode authManagerNode = new JMeterTreeNode(authManager,jmeterTreeModel);\n                int index=(target.getChildCount()>0&&\n                        ((JMeterTreeNode)target.getFirstChild()).getTestElement() instanceof TestPlan)?2:0;\n                jmeterTreeModel.insertNodeInto(authManagerNode, target,index);\n             } catch (IllegalUserActionException e) {\n                 log.error(\"Failed to add Authorization Manager to target node:\" + target.getName(), e);\n             }"}]