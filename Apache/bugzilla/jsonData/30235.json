[{"count": 0, "tags": [], "bug_id": 30235, "attachment_id": null, "text": "A merge of the latest code from Goss Interactive that includes the fixes that \nwe rolled into our latest product release. This has been tested against a \nseries of testcase word documents that were supplied by clients or created \nspecifically in-house. \n\nPlatforms and formats tested include: Office 97/2k/xp, Mac, OpenOffice. All \ntestcases can now be read correctly. Writing is not totally transparent and \nstill needs some work. From our further testing, previous HWPF write \nfunctionality appears to remain unaffected.\n\n\nFiles altered:\n==============\n\nhwpf/model/ListLevel.java\n-------------------------\n- fix for listlevel() - papx and chpx arrays were being copied in the wrong \norder\n\n- added getLevelProperties()\n\n\nhwpf/model/ListTables.java\n--------------------------\n- added getListData()\n\n\nhwpf/model/SectionTable.java\n----------------------------\n- fixed CPtoFC() to accomodate non-contigous textpieces\n\n\nhwpf/model/TextPiece.java\n-------------------------\n- added CP_start property and accessor used by CPtoFC in model/SectionTable.java\n\n\nhwpf/model/TextPiecetable.java\n------------------------------\n- fix for constructor to take into account non-contigous textpieces\n\n\nhwpf/sprm/ParagraphSprmUncompressor.java\n----------------------------------------\n- fix for tabs being read as INTs instead of the SHORTs that they are\n\n\nhwpf/sprm/TableSprmUncompressor\n-------------------------------\n- fix for TC entries not always being present in the Word file\n\n\nhwpf/usermodel/CharacterRun.java\n--------------------------------\n- changed to use updateSprm() rather than addSprm() to match code elsewhere \nthat prevents additional sprms being created if they already exist\n\n- added accessors for properties that Word uses when handling embedded objects \nsuch as Hyperlinks, Pictures, OleObjects etc\n\n\nhwpf/usermodel/Paragraph.java\n-----------------------------\n- added accessors for Ilfo and Ilvl used by Word for numbered lists\n\n\nhwpf/usermodel/Range.java\n-------------------------\n- fixed text() to correctly return unicode text\n\n- fixed findRange() to prevent loop indexes going out of bounds, causing an \nexception\n\n- fixed getTable() to cope with tables that start at the beginning of a section \nsuch that they don't get merged with preceeding tables\n\n- fixed getTable() to return a table at the correct tablelevel\n\n\nhwpf/usermodel/Table.java\n-------------------------\n- minor code tidy\n\n\nhwpf/usermodel/TableRow.java\n----------------------------\n- removed constraint requiring levelNum==1 in constructor that doesn't work \nwhen dealing with documents that include sections", "id": 60909, "time": "2004-07-21T16:18:17Z", "creator": "piers.taylor@gossinteractive.com", "creation_time": "2004-07-21T16:18:17Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 30235, "attachment_id": 12182, "id": 60911, "time": "2004-07-21T16:21:52Z", "creator": "piers.taylor@gossinteractive.com", "creation_time": "2004-07-21T16:21:52Z", "is_private": false, "text": "Created attachment 12182\nListLevel.java, ListTables.java, SectionTable.java, TextPiece.java, TextPiecetable.java, ParagraphSprmUncompressor.java, TableSprmUncompressor.java, CharacterRun.java, Paragraph.java, Range.java, Table.java, TableRow.java"}, {"count": 2, "tags": [], "bug_id": 30235, "attachment_id": null, "is_private": false, "id": 61514, "time": "2004-08-04T01:28:51Z", "creator": "glens@apache.org", "creation_time": "2004-08-04T01:28:51Z", "text": "Since you're contribution is fairly large I think it would be preferable to get\nyou to sign a CLA before we commit your changes.  Since this is work on behalf\nof your company it might be best to get them to sign a CLA also.\n\nIndividual CLA:\n\nhttp://www.apache.org/licenses/cla.txt\n\nCompany CLA:\n\nhttp://www.apache.org/licenses/cla-corporate.txt\n\nSorry to be a pain about CLA's and things but Apache tries hard to make sure\nthere are no legal issues surrounding the code it receives.\n"}, {"count": 3, "tags": [], "bug_id": 30235, "attachment_id": null, "is_private": false, "id": 61555, "time": "2004-08-04T18:59:46Z", "creator": "apachedev@2vu.com", "creation_time": "2004-08-04T18:59:46Z", "text": "No problem Glen,\n\nGoss Interactive Ltd. have alredy signed a CLA which you should have on file. \nRyan requested this right at the beginning. That CLA will cover the current \npatch since it was work carried out when I was working there.\n\nI have downloaded the \"Individual CLA\" and will sign and return it to you ASAP.\n\n>Sorry to be a pain...\n\nNot at all.\n\nRegards,\n        Piers"}, {"count": 4, "tags": [], "creator": "glens@apache.org", "attachment_id": null, "id": 62398, "time": "2004-08-24T12:50:35Z", "bug_id": 30235, "creation_time": "2004-08-24T12:50:35Z", "is_private": false, "text": "I've applies this patch.  It conflicted with the other patch because they're\ncumulative rather than incremental.  Better to close the original patch and\nrecreate a new one with all changes included.\n\nI think I got it all sorted out but please give it a check.  Once again... sorry\nfor being so late in getting this committed.\n\nThere are failing tests in scratchpad so if you could have a look at those that\nwould be great."}, {"count": 5, "tags": [], "creator": "apachedev@2vu.com", "attachment_id": null, "id": 62516, "time": "2004-08-26T03:25:54Z", "bug_id": 30235, "creation_time": "2004-08-26T03:25:54Z", "is_private": false, "text": "Thanks for applying the patch. I'll check it out asap. I'll take a look at the \ntests too."}]