[{"count": 0, "tags": [], "bug_id": 11502, "text": "The current tomcat version does not stop all my servlets correctly. I use \nstruts (the current nightly build) and define four servlets \nnamed \"init\", \"config\", \"download\" and \"pkit\". They all start up correctly (my \napplication is under the /pkit context):\n\n2002-08-06 16:53:00 StandardWrapper[/pkit:default]: Loading container servlet \ndefault\n2002-08-06 16:53:00 default: init\n2002-08-06 16:53:00 init: init\n2002-08-06 16:53:01 StandardWrapper[/pkit:invoker]: Loading container servlet \ninvoker\n2002-08-06 16:53:01 invoker: init\n2002-08-06 16:53:01 config: init\n2002-08-06 16:53:05 download: init\n2002-08-06 16:53:05 jsp: init\n2002-08-06 16:53:05 pkit: init\n\nIf I stop tomcat, it tries to make the session persistent (and fails because my \nsessions are not yet serializable) and stops the servlets. But it only stops \nthree of the servlets. The fourth servlet named \"pkit\" (the main servlet that \nprocesses the struts actions) is never stopped and thus, the JVM refuses to \nstop.\n\nHere is the excerpt from the log. Please note that the \"pkit\" servlet is not \nmentioned there:\n\n2002-08-06 17:01:18 StandardHost[localhost]: Removing web application at context\n path /manager\n2002-08-06 17:01:18 StandardHost[localhost]: Removing web application at context\n path /pkit\n2002-08-06 17:01:18 StandardContext[/pkit]: Stopping\n2002-08-06 17:01:18 StandardContext[/pkit]: Stopping filters\n2002-08-06 17:01:18 StandardManager[/pkit] Cannot serialize session attribute us\ner for session 78E657ED2623FEEBA49892B47D257BF7\njava.io.NotSerializableException: de.methodpark.pkit.storage.User$1\n        at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1054)\n        ...\n2002-08-06 17:01:18 StandardContext[/pkit]: Processing standard container shutdo\nwn\n2002-08-06 17:01:18 ContextConfig[/pkit]: ContextConfig: Processing STOP\n2002-08-06 17:01:18 download: destroy\n2002-08-06 17:01:18 config: destroy\n2002-08-06 17:01:18 init: destroy\n2002-08-06 17:01:18 StandardContext[/pkit]: Sending application stop events\n2002-08-06 17:01:18 StandardContext[/pkit]: Releasing document base pkit\n2002-08-06 17:01:18 StandardContext[/pkit]: Stopping complete\n2002-08-06 17:01:18 StandardHost[localhost]: Removing web application at context\n path\n2002-08-06 17:01:18 StandardHost[localhost]: Removing web application at context\n path /admin", "id": 20695, "time": "2002-08-06T15:08:26Z", "creator": "Erich.Meier@methodpark.de", "creation_time": "2002-08-06T15:08:26Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 11502, "is_private": false, "text": "Please send an easy to run test case or a patch, as we cannot reproduce this.", "id": 20711, "time": "2002-08-06T17:00:27Z", "creator": "remm@apache.org", "creation_time": "2002-08-06T17:00:27Z", "attachment_id": null}]