[{"count": 0, "attachment_id": null, "bug_id": 16700, "text": "I submit the excel file from the client using IE Explorer 5.5 by the code given \nbelow:\n\n<form action=\"http://xxx/POIExample\" method=\"post\" enctype=\"multipart/form-\ndata\">\n  <input size=\"70\" type=\"file\" name=\"spreadsheet\" />\n  <input type=\"submit\" value=\"Upload File\" />\n</form>\n\nIn the servlet (running in Weblogic 6.1) I remove the extra data which comes in \nthe HttpServletRequest and have the extract (only the content of the file) in \nthe String \"file\": \n\nThen I use the following code to create the workbook\n\n//the parse method returns the content of the excel file which was uploaded\n1. String file = parse(req.getInputStream(),req.getContentLength\n(),req.getContentType());\n\n//this line creates the ByteArrayInputStream\n2. ByteArrayInputStream is = new ByteArrayInputStream(file.getBytes());\n\n//then try to create the workbook\n3. HSSFWorkbook wb = new HSSFWorkbook(is);\n\nIf i upload the excel file from the client which is less than 64.5 kb, the \nHSSFWorkbook gets created successfully and I am able to read data.\n\nBut if the excel file size is greater than 64.5 kb it throws an error \n\njava.io.IOException: block[ 63 ] already removed\n        at org.apache.poi.poifs.storage.BlockListImpl.remove\n(BlockListImpl.java:133)\n        at org.apache.poi.poifs.storage.BlockAllocationTableReader.fetchBlocks\n(BlockAllocationTableReader.java:227)\n        at org.apache.poi.poifs.storage.BlockListImpl.fetchBlocks\n(BlockListImpl.java:165)\n        at org.apache.poi.poifs.filesystem.POIFSFileSystem.processProperties\n(POIFSFileSystem.java:441)\n        at org.apache.poi.poifs.filesystem.POIFSFileSystem.<init>\n(POIFSFileSystem.java:139)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:175)\n        at lehman.brokerlink.servlets.POIExample.doProcess(POIExample.java:88)\n        at lehman.brokerlink.servlets.POIExample.doPost(POIExample.java:26)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:760)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n        at weblogic.servlet.internal.ServletStubImpl.invokeServlet\n(ServletStubImpl.java:265)\n        at weblogic.servlet.internal.ServletStubImpl.invokeServlet\n(ServletStubImpl.java:200)\n        at weblogic.servlet.internal.WebAppServletContext.invokeServlet\n(WebAppServletContext.java:2456)\n        at weblogic.servlet.internal.ServletRequestImpl.execute\n(ServletRequestImpl.java:2039)\n        at weblogic.kernel.ExecuteThread.execute(ExecuteThread.java:139)\n        at weblogic.kernel.ExecuteThread.run(ExecuteThread.java:120)\n\nPlease note: If I try reading/creating the HSSFWorkbook from a java client by \nreading the same excel file (for which it was earlier throwing error), it does \nnot throw any errors.", "id": 30553, "time": "2003-02-03T13:11:27Z", "creator": "vinit_kl@yahoo.com", "creation_time": "2003-02-03T13:11:27Z", "tags": [], "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 16700, "text": "post to the mailing list.  I doubt this is a POI bug.", "id": 30559, "time": "2003-02-03T14:35:57Z", "creator": "poi-support@buni.org", "creation_time": "2003-02-03T14:35:57Z", "tags": [], "is_private": false}]