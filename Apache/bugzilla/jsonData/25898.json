[{"count": 0, "tags": [], "creator": "tuor07@yahoo.de", "attachment_id": null, "is_private": false, "id": 50059, "time": "2004-01-05T12:47:09Z", "bug_id": 25898, "creation_time": "2004-01-05T12:47:09Z", "text": "The problem:\n============\n\nI needed a mechanism to build a jar's manifest classpath entry from jars within \na lib. The snippet below does the job. However I have to perform that \"dirname\" \nstep to ensure, that the dir separator in the property value is the platform's \ndir separator. If \"dist.dir\" is specified with another separator (say C:\n/Temp/xyz on Windows) it would fail otherwise to remove the directory prefix as \nspecified.\n\n  <dirname property=\"norm.dist.dir\" file=\"${dist.dir}/_SOMETHING_\"/>\n  \n  <path id=\"dist.path\">\n    <fileset dir=\"${dist.dir}\">\n      <include name=\"*.jar\"/>\n    </fileset>\n  </path>\n  \n  <pathconvert property=\"jar.manifest.classpath\" refid=\"dist.path\" pathsep=\" \">\n    <map from=\"${norm.dist.dir}/\" to=\"\"/>\n    <map from=\"${norm.dist.dir}\\\" to=\"\"/>\n  </pathconvert>\n\n\nRelated to this: I guess that the mapper task (as used by uptodate) has the same \nproblem. I encountered something similar with the following snippet (under W2k):\n\n  <uptodate property=\"check.jar.uptodate\">\n    <srcfiles dir=\"${build.classes.dir}\" includes=\"**/*.class\"/>\n    <mapper type=\"merge\" to=\"${build.jar}\"/>\n  </uptodate>\n\nThe verbose flag tells me, the jar does not exist. But it definitely is there \n(also checked with the available task)."}, {"count": 1, "tags": [], "bug_id": 25898, "attachment_id": null, "id": 50063, "time": "2004-01-05T13:11:42Z", "creator": "tuor07@yahoo.de", "creation_time": "2004-01-05T13:11:42Z", "is_private": false, "text": "\nAddendum:\n\nThat latter suspicion about the mapper task has proved wrong. It did not work \nbecause the \"to\" Attribute seems to require a fully qualified entry, where I \nprovided a relative path. However, the \"map\" issue still exists."}, {"count": 2, "tags": [], "bug_id": 25898, "is_private": false, "text": "The dirname \"trick\" is necesarry because your property isn't in the correct format\nin the first place, you may be able to directly set it via <property>'s location\nattribute or use \n\n<property name=\"norm.dist.dir\" location=\"${dist.dir}\"/>\n\ninstead of <dirname>.\n\nAnd then you could simply use\n\n<map from=\"${norm.dist.dir}${file.separator}\" to=\"\"/>\n\nto have a platform independent format.\n", "id": 51466, "time": "2004-01-30T14:22:00Z", "creator": "bodewig@apache.org", "creation_time": "2004-01-30T14:22:00Z", "attachment_id": null}]