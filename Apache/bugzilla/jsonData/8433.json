[{"count": 0, "attachment_id": null, "creator": "cavan.morris@worldnet.att.net", "is_private": false, "id": 14513, "time": "2002-04-23T19:59:33Z", "bug_id": 8433, "creation_time": "2002-04-23T19:59:33Z", "tags": [], "text": "I'm running tomcat 4.0.2 under apache 2.0.32 with webapp-module-1.0.2-tc402 on \nredhat 7.2 and jdk 1.4\n\nI'm using the apache \"ab\" program for perfomance testing and have noticed that \nthe sockets between apache and tomcat seem to die when I use concurrent \nrequests.  Somtimes I have to restart the servers in order to get a response \nfrom them again.\n\nHere's the ab command that will cause the problem:\n./ab -v 2 -n 20 -c 2 MY_HOST/index.jsp\n\nHere are the exceptions from the tomcat logs:\n2002-04-23 11:38:02 WarpHost[MY_HOST]: Mapping request for Host\n2002-04-23 11:38:02 WarpEngine[Apache]: Mapping request\n2002-04-23 11:38:02 WarpHost[MY_HOST]: Mapping request for Host\n2002-04-23 11:38:02 [org.apache.catalina.connector.warp.WarpConnector] \nConnection from /127.0.0.1:33290 to /127.0.0.1:8008\n2002-04-23 11:38:02 [org.apache.catalina.connector.warp.WarpConnector] \nConnection from /127.0.0.1:33292 to /127.0.0.1:8008\n2002-04-23 11:38:02 \n[org.apache.catalina.connector.warp.WarpConfigurationHandler] Invalid packet \nwith type 16\n2002-04-23 11:38:02 [org.apache.catalina.connector.warp.WarpConnection] \nException on socket\njava.io.IOException: Premature packet header end\n        at org.apache.catalina.connector.warp.WarpConnection.recv\n(WarpConnection.java:237)\n        at org.apache.catalina.connector.warp.WarpRequestHandler.handle\n(WarpRequestHandler.java:113)\n        at org.apache.catalina.connector.warp.WarpConnection.run\n(WarpConnection.java:194)\n        at java.lang.Thread.run(Thread.java:536)\n\n2002-04-23 11:38:02 [org.apache.catalina.connector.warp.WarpConnection] \nException on socket\njava.net.SocketException: Socket closed\n        at java.net.SocketOutputStream.socketWrite0(Native Method)\n        at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)\n        at java.net.SocketOutputStream.write(SocketOutputStream.java:105)\n        at org.apache.catalina.connector.warp.WarpConnection.send\n(WarpConnection.java:220)\n        at org.apache.catalina.connector.warp.WarpConfigurationHandler.handle\n(WarpConfigurationHandler.java:246)\n        at org.apache.catalina.connector.warp.WarpConnection.run\n(WarpConnection.java:189)\n        at java.lang.Thread.run(Thread.java:536)\n\n2002-04-23 11:38:02 \n[org.apache.catalina.connector.warp.WarpConfigurationHandler] Filter mappings \n(0)\n2002-04-23 11:38:02 \n[org.apache.catalina.connector.warp.WarpConfigurationHandler] Filter mappings \n(0)\n2002-04-23 11:38:02 WarpEngine[Apache]: Mapping request\n\nChanging the number of requests to perform from 20 to 100 will make it so that \nI have to restart apache to get a response from the host."}, {"count": 1, "tags": [], "bug_id": 8433, "text": "This is the same thing happening on Windows with 1.3.x (multi-threading \nissue).\n\n*** This bug has been marked as a duplicate of 3509 ***", "id": 15014, "time": "2002-04-29T12:51:47Z", "creator": "pier@betaversion.org", "creation_time": "2002-04-29T12:51:47Z", "is_private": false, "attachment_id": null}]