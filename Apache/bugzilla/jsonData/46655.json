[{"count": 0, "tags": [], "bug_id": 46655, "text": "Created attachment 23216\nConnector.java\n\nThis patch is useful when you want handle keystore password from external class. \nTo do this, I added two additional parameters (in Connector tag of server.xml) to call external method and get Password String. \n - Parameter keystorePassHandler (in form some.package.Class.methodToInvoke)\n - Parameter truststorePassHandler (in form some.package.Class.methodToInvoke) \n \nobviously, if not present,  keystorePass and truststorePass parameters are used.\n \nExample:\nUsing external attached passConsole.jar to enter password from console \nadd attribute to Connector tag of server.xml\n \n<Connector \n port=\"8443\" minProcessors=\"5\" maxProcessors=\"75\"\n enableLookups=\"false\" disableUploadTimeout=\"true\" \n acceptCount=\"100\"  maxThreads=\"200\"\n scheme=\"https\" secure=\"true\" SSLEnabled=\"true\"\n keystoreFile=\"C:/keystore/cert.p12\"\n keystoreType=\"PKCS12\" keystorePass=\"keypass\"\n keystorePassHandler=\"it.urmet.test.EnterPassword.consolePassword\"\n truststoreFile=\"C:/keystore/.keystore\"\n truststorePassHandler=\"it.urmet.test.EnterPassword.consolePassword\"\n truststoreType=\"JKS\" truststorePass=\"trustorepass\"\n clientAuth=\"true\" sslprotocol=\"TLS\"/>\n \nIf new attributes are presents,keystorePass and truststorePass are ignored (can be omitted).", "id": 124617, "attachment_id": 23216, "creator": "alessandro.giannini@urmet.it", "creation_time": "2009-02-03T00:24:36Z", "time": "2009-02-03T00:24:36Z", "is_private": false}, {"count": 1, "tags": [], "creator": "alessandro.giannini@urmet.it", "attachment_id": 23217, "id": 124619, "time": "2009-02-03T00:27:56Z", "bug_id": 46655, "creation_time": "2009-02-03T00:27:56Z", "is_private": false, "text": "Created attachment 23217\nexample of external jar to handle pasword\n\nAn example of external keystore's password utilization"}, {"count": 2, "attachment_id": null, "bug_id": 46655, "text": "As far as I can tell, the jar only contains the class file for the password handler.", "id": 124776, "time": "2009-02-11T09:19:54Z", "creator": "sebb@apache.org", "creation_time": "2009-02-11T09:19:54Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "creator": "alessandro.giannini@urmet.it", "attachment_id": null, "id": 124841, "time": "2009-02-13T06:45:21Z", "bug_id": 46655, "creation_time": "2009-02-13T06:45:21Z", "is_private": false, "text": "Connector.java contain patch code to handle new attributes (In reply to comment #2)\n> As far as I can tell, the jar only contains the class file for the password\n> handler.\n\n"}, {"count": 4, "tags": [], "bug_id": 46655, "text": "(In reply to comment #3)\n> Connector.java contain patch code to handle new attributes (In reply to comment\n> #2)\n\nAgreed, but in order to use the new attributes, the following class file (or an equivalent) needs to be provided:\n\nit.urmet.test.EnterPassword\n\n> > As far as I can tell, the jar only contains the class file for the password\n> > handler.\n> \n\nHowever, the jar file only contains the compiled version of that class.\n\nIt would be helpful for the API of the external class to be documented.\n\nAlso, please provide the Connector.java file as a patch (unified diff format) against the current code, rather than as a complete source file.\nPatch files are generally easier for the Tomcat committers to review.", "id": 124843, "time": "2009-02-13T07:07:34Z", "creator": "sebb@apache.org", "creation_time": "2009-02-13T07:07:34Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "alessandro.giannini@urmet.it", "text": "Created attachment 23256\npatch to Connector.java to handle new parameters\n\nThe new parameters allow you to invoke external Method (tipically included in jar) like the example. In this case the 'it.urmet.test.EnterPassword.consolePassword' Method is invoked but, obviously, you can use other implementations.  \n\nI let you remeber that if new attributes are presents,keystorePass and truststorePass are ignored (can be omitted).", "id": 124852, "time": "2009-02-14T06:28:56Z", "bug_id": 46655, "creation_time": "2009-02-14T06:28:56Z", "is_private": false, "attachment_id": 23256}, {"count": 6, "attachment_id": null, "bug_id": 46655, "text": "Thanks for the patch replacement.\n\nUnfortunately it uses tabs instead of spaces for alignment (except for one or two lines). The original source file uses spaces only.", "id": 124854, "time": "2009-02-14T06:58:36Z", "creator": "sebb@apache.org", "creation_time": "2009-02-14T06:58:36Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "bug_id": 46655, "is_private": false, "text": "even after fixing sebb's concerns, the patch is still bad.  It depends on the order that arguments are passed from the xml parser, which is undefined.  On the principal of least surprise I'd vote -1 on this until it is considerably improved. ", "id": 124865, "time": "2009-02-15T17:57:19Z", "creator": "wbarker@wilshire.com", "creation_time": "2009-02-15T17:57:19Z", "attachment_id": null}, {"count": 8, "attachment_id": null, "bug_id": 46655, "text": "If you really want to go down this route (and I don't recommend it) then there are other passwords and sensitive data you'll need to protect and a generic solution is much better than a case by case approach.\n\nThe generic solution (for Tomcat 7 at least) is hinted at in [1] which is to provide your own org.apache.tomcat.util.IntrospectionUtils.PropertySource implementation that can prompt for console entry at the appropriate point. For example, you may choose to set property values to \"${***Prompt***}\" for those that you want the user to be prompted for.\n\n[1] http://wiki.apache.org/tomcat/FAQ/Password", "id": 155159, "time": "2012-03-20T23:05:18Z", "creator": "markt@apache.org", "creation_time": "2012-03-20T23:05:18Z", "tags": [], "is_private": false}]