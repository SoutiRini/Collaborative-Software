[{"count": 0, "attachment_id": null, "creator": "thiagobart@gmail.com", "text": "I noticed that MethodGen.getLocalVariables sorts the local variables by index. However, it uses a hand written sort algorithm that is unstable. That is, it does not guarantee that variables with the same index are kept in the same order. In fact, it always swaps them.\n\nThis does not cause a major problem apart from having a different order of variables in the local variables table when a class is simply parsed and dumped.\n\nA simple enhancement is to use java's own merge sort implementation (available in version 1.3, which seems to be the target platform). In getLocalVariables(), instead of calling:\n\n    sort(lg, 0, size - 1);\n\nuse something like (maybe remove generics):\n\n    Arrays.sort(lg, new Comparator<LocalVariableGen>() {\n        public int compare(LocalVariableGen o1, LocalVariableGen o2) {\n            return o1.getIndex() - o2.getIndex();\n        }\n    });\n\nThe advantage, besides using a stable sort, is that this is less code to maintain, compared to the trick sort method.", "id": 152599, "time": "2012-01-05T20:29:45Z", "bug_id": 52433, "creation_time": "2012-01-05T20:29:45Z", "tags": [], "is_private": false}, {"count": 1, "attachment_id": null, "creator": "tcurdt@apache.org", "text": "Indeed. Good suggestion.", "id": 153450, "time": "2012-02-04T19:55:02Z", "bug_id": 52433, "creation_time": "2012-02-04T19:55:02Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "sebb@apache.org", "attachment_id": null, "text": "URL: http://svn.apache.org/viewvc?rev=1299373&view=rev\nLog:\nBug 52433 - Why using unstable sort at MethodGen.getLocalVariables() ?\n\nAdded:\n   commons/proper/bcel/trunk/src/changes/\n   commons/proper/bcel/trunk/src/changes/changes.xml   (with props)\n   commons/proper/bcel/trunk/src/changes/release-notes.vm   (with props)\nModified:\n   commons/proper/bcel/trunk/src/main/java/org/apache/bcel/generic/MethodGen.java", "id": 154801, "time": "2012-03-11T15:07:03Z", "bug_id": 52433, "creation_time": "2012-03-11T15:07:03Z", "is_private": false}]