[{"count": 0, "tags": [], "bug_id": 52406, "attachment_id": null, "text": "Hi.\n\nEither this is a bug, or a suggestion to change behaviour, or at least a suggestion to clarify documentation:\n\nIt seems that the set \"Order\" is not inherited as one would expect from the usual way different sections are merged.\n\nExample:\n<Directory /foo>\n    Order allow,deny\n    Deny from all\n</Directory>\n\n<Directory /foo/bar>\n    Allow from localhost\n</Directory>\n\n\nI would now assume, that in /foo, everything is denied (which is actually the case) and that in /foo/bar, everything is denied but accesses from localhost (as I'd expect that the \"Order allow,deny\" applies on /foo/bar, too).\n\nIt seems however, that \"Order\" is silently set back to it's default (deny,allow) in the /foo/bar section.\nAnd therefore... _any_ access is granted.\n\n\nThis seems to be some quite strange behaviour.\n\nNot sure whether any similar directives (e.g. Satisfy) also behave as strange as this.\n\n\nCheers,\nChris.", "id": 152500, "time": "2012-01-01T01:56:59Z", "creator": "calestyo@scientia.net", "creation_time": "2012-01-01T01:56:59Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 52406, "attachment_id": null, "id": 152501, "time": "2012-01-01T02:08:51Z", "creator": "calestyo@scientia.net", "creation_time": "2012-01-01T02:08:51Z", "is_private": false, "text": "Just checked it,.. e.g. Satisfy behaves as expected, meaning:\nSetting the non-default:\n\n<Directory /foo>\n   Satisfy any\n</Directory>\n\n<Directory /foo/bar>\n</Directory>\n\nwill also have \"Satisfy any\" effective in /foo/bar."}, {"count": 2, "tags": [], "creator": "covener@gmail.com", "text": "What if mod_access/mod_access compat said at the top:\n\n\"Every time you use a directive from this module in a new context, you're starting from scratch\"\n\n(this is how it works)", "id": 152502, "time": "2012-01-01T03:23:54Z", "bug_id": 52406, "creation_time": "2012-01-01T03:23:54Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "calestyo@scientia.net", "text": "Well ....\na) IMHO this should really be changed... it just seems to contradict how everything else works,... and is also a security risk, as the default \"Order deny,allow\" is rather \"open\".\n\nApache 2.3/2.4 could be a good opportunity to introduce such a (major) change in behaviour.\n\nI think it would also rather \"uncritical\" to do this...\n- The default is \"order deny,allow\" anyway... if this is set in the parent directory (or not set at all and therefore left at the default)... it was till now also the case for subdirs (but just because it \"started there from scratch\" and not because it was inherited.\n\n- If the parent directory had the non-default allow,deny set,.. it will now be inherited and change potentially semantics (cause before it was reset to start with deny,allow):\nBut this would not open any security problems,... it would rather just deny any accesses that were allowed before.\nThis IS of course some major change, but not a bad one,.. and it would be quickly noted (in case people wouldn't read the release notes, that would then notify about this change).\n\n\nb) In case the inheritance behaviour of Order is not corrected as I propose above:\nI guess this should be noted in serveral places, not just mod_access (which is depreated anyway:\n\n- mod_access\n- mod_authz_host\nThere it should IMHO not only be noted in the Order directive,.. but also in the Deny/Allow directives, as they're directly affected\n\nI'd further notice it in:\n- sections.html\nPerhaps by adding a new small chapter, that informs about this special case.\n\n- security_tips.html\nAs this is IMHO security related (because the behaviour is strange, and the default deny,allow is lax)...\n\n\n\nCheers,\nChris.", "id": 152533, "time": "2012-01-02T16:20:39Z", "bug_id": 52406, "creation_time": "2012-01-02T16:20:39Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "covener@gmail.com", "text": "Changing to doc, seems unreasonable to make Order become merged when it never has been and is now _compat.", "id": 152534, "time": "2012-01-02T16:26:50Z", "bug_id": 52406, "creation_time": "2012-01-02T16:26:50Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 52406, "attachment_id": null, "id": 152535, "time": "2012-01-02T16:32:43Z", "creator": "calestyo@scientia.net", "creation_time": "2012-01-02T16:32:43Z", "is_private": false, "text": "What do you mean by \"_compat\"?\n\nAnd again,.. I'm not sure whether this is unreasonable... as far as I understand the merging behaviour (i.e. no merging) diverts here from the default... which can be easily forgotten by admins,... and this in turn can easily lead to security problems."}, {"count": 6, "tags": [], "creator": "covener@gmail.com", "text": "These directives are provided by a compat module in 2.3 and later and replaced by mod_authz_host and authorization config sections that control merging.\n\nThe default behavior of an apache module is actually what mod_access/mod_access_compat uses -- replacement of the configuration when you use a directive.  If a module wants to inherit, it has to decide the semantics and implement the merging.", "id": 152536, "time": "2012-01-02T16:48:01Z", "bug_id": 52406, "creation_time": "2012-01-02T16:48:01Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 52406, "attachment_id": null, "text": "added some refs in r1226477", "id": 152537, "time": "2012-01-02T17:20:54Z", "creator": "covener@gmail.com", "creation_time": "2012-01-02T17:20:54Z", "is_private": false}]