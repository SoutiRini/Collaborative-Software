[{"count": 0, "text": "Step to reproduce:\n1. Create a .jmx file with a request containing a typical ISO-8859-1 character, for example \"Kopi\u00ebren\" (Dutch for 'to copy')\n2. Run the JMeter test to produce a .jtl file\n3. Open the .jtl in an Aggregate Report listener.\n4. Export the table to .csv\n5. Open the .csv file in a spreadsheet editor (e.g. Excel)\n6. Notice that the label has become \"Kopi\u00c3\u00abren\"\n\nExpected:\n6. The label remains \"Kopi\u00ebren\" and is readable.\n\nThis scenario works in version 2.13, 3.0 and 3.1, but broke in 3.2.\n\nI expect that the scenario broke since this commit:\n24e22e433 (\"sonar: fix errors and false-positive Fix missing Encoding issue by saving in UTF-8\", 2016-12-28)\ngit-svn-id: https://svn.apache.org/repos/asf/jmeter/trunk@1776330 13f79535-47bb-0310-9956-ffa450edef68\n\nIt seems that the bug is still present on trunk:\nhttps://svn.apache.org/viewvc/jmeter/trunk/src/components/org/apache/jmeter/visualizers/StatVisualizer.java?view=markup#l220\n\nI don't know the project well enough to define the best solution. But if it helps, these are 3 alternative approaches to resolve the issue:\n\n* Revert line that introduced the hardcoding of UTF-8 character set.\n\n* Replace it by using the existing property \"_file_encoding\" specified in \"saveservice.properties\" (According to the documentation: Character set encoding used to read and write JMeter XML files and CSV results)\nBy default it is set to \"_file_encoding=UTF-8\", but can be configured to be \"_file_encoding=ISO-8859-1\"\nThis property is already used for reading/writing to .jmx and .jtl file (Steps 1-3) but not in reading/writing this .csv (Step 4).\n\n* Provide the Byte Order Mark when writing in UTF-8, so that other program that consumes the .csv file can be sure that the text stream is in Unicode.", "bug_id": 61317, "attachment_id": null, "id": 199874, "time": "2017-07-19T15:23:09Z", "creator": "linard.verstraete@tenforce.com", "creation_time": "2017-07-19T15:23:09Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 61317, "is_private": false, "text": "(In reply to LinardAtTenForce from comment #0)\n> Step to reproduce:\n> 1. Create a .jmx file with a request containing a typical ISO-8859-1\n> character, for example \"Kopi\u00ebren\" (Dutch for 'to copy')\n> 2. Run the JMeter test to produce a .jtl file\n> 3. Open the .jtl in an Aggregate Report listener.\n> 4. Export the table to .csv\n> 5. Open the .csv file in a spreadsheet editor (e.g. Excel)\n\nHow do you do that ? Are you sure you respect encoding of file ?\nhttps://stackoverflow.com/questions/6002256/is-it-possible-to-force-excel-recognize-utf-8-csv-files-automatically\n\n\n> 6. Notice that the label has become \"Kopi\u00c3\u00abren\"\nAre you sure it's not the way you open it in excel that is broken ?\n> \n> Expected:\n> 6. The label remains \"Kopi\u00ebren\" and is readable.\n> \n> This scenario works in version 2.13, 3.0 and 3.1, but broke in 3.2.\n> \n> I expect that the scenario broke since this commit:\n> 24e22e433 (\"sonar: fix errors and false-positive Fix missing Encoding issue\n> by saving in UTF-8\", 2016-12-28)\n> git-svn-id: https://svn.apache.org/repos/asf/jmeter/trunk@1776330\n> 13f79535-47bb-0310-9956-ffa450edef68\n> \n> It seems that the bug is still present on trunk:\n> https://svn.apache.org/viewvc/jmeter/trunk/src/components/org/apache/jmeter/\n> visualizers/StatVisualizer.java?view=markup#l220\n> \n> I don't know the project well enough to define the best solution. But if it\n> helps, these are 3 alternative approaches to resolve the issue:\n> \n> * Revert line that introduced the hardcoding of UTF-8 character set.\n> \n> * Replace it by using the existing property \"_file_encoding\" specified in\n> \"saveservice.properties\" (According to the documentation: Character set\n> encoding used to read and write JMeter XML files and CSV results)\n> By default it is set to \"_file_encoding=UTF-8\", but can be configured to be\n> \"_file_encoding=ISO-8859-1\"\n> This property is already used for reading/writing to .jmx and .jtl file\n> (Steps 1-3) but not in reading/writing this .csv (Step 4).\n> \n> * Provide the Byte Order Mark when writing in UTF-8, so that other program\n> that consumes the .csv file can be sure that the text stream is in Unicode.\n\nI tested your scenario, it works fine for me with LibreOffice.\nI don't have Excel.", "id": 199901, "time": "2017-07-20T20:04:27Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2017-07-20T20:04:27Z", "attachment_id": null}, {"count": 2, "text": "(In reply to Philippe Mouawad from comment #1)\n> (In reply to LinardAtTenForce from comment #0)\n> > Step to reproduce:\n> > 1. Create a .jmx file with a request containing a typical ISO-8859-1\n> > character, for example \"Kopi\u00ebren\" (Dutch for 'to copy')\n> > 2. Run the JMeter test to produce a .jtl file\n> > 3. Open the .jtl in an Aggregate Report listener.\n> > 4. Export the table to .csv\n> > 5. Open the .csv file in a spreadsheet editor (e.g. Excel)\n> \n> How do you do that ? Are you sure you respect encoding of file ?\n> https://stackoverflow.com/questions/6002256/is-it-possible-to-force-excel-\n> recognize-utf-8-csv-files-automatically\n\nI have Excel as default application for .csv files. I open the file by double clicking it.\n\n> > 6. Notice that the label has become \"Kopi\u00c3\u00abren\"\n> Are you sure it's not the way you open it in excel that is broken ?\n\nBased on the stackoverflow post you provided, I can confirm that opening Excel and importing the .csv file (with specify the encoding) in separate steps, results in the expected behavior.\n\n> > \n> > Expected:\n> > 6. The label remains \"Kopi\u00ebren\" and is readable.\n> > \n> > This scenario works in version 2.13, 3.0 and 3.1, but broke in 3.2.\n> > \n> > I expect that the scenario broke since this commit:\n> > 24e22e433 (\"sonar: fix errors and false-positive Fix missing Encoding issue\n> > by saving in UTF-8\", 2016-12-28)\n> > git-svn-id: https://svn.apache.org/repos/asf/jmeter/trunk@1776330\n> > 13f79535-47bb-0310-9956-ffa450edef68\n> > \n> > It seems that the bug is still present on trunk:\n> > https://svn.apache.org/viewvc/jmeter/trunk/src/components/org/apache/jmeter/\n> > visualizers/StatVisualizer.java?view=markup#l220\n> > \n> > I don't know the project well enough to define the best solution. But if it\n> > helps, these are 3 alternative approaches to resolve the issue:\n> > \n> > * Revert line that introduced the hardcoding of UTF-8 character set.\n> > \n> > * Replace it by using the existing property \"_file_encoding\" specified in\n> > \"saveservice.properties\" (According to the documentation: Character set\n> > encoding used to read and write JMeter XML files and CSV results)\n> > By default it is set to \"_file_encoding=UTF-8\", but can be configured to be\n> > \"_file_encoding=ISO-8859-1\"\n> > This property is already used for reading/writing to .jmx and .jtl file\n> > (Steps 1-3) but not in reading/writing this .csv (Step 4).\n\nI do understand that the program (e.g. Excel) that reads the .csv needs to use the right encoding, but coming from previous JMeter versions, it feels tedious to do these extra steps. I'm still confused that the .csv can't be written in something else than UTF-8, even when setting the saveservice.properties.\n\n> > * Provide the Byte Order Mark when writing in UTF-8, so that other program\n> > that consumes the .csv file can be sure that the text stream is in Unicode.\n> \n> I tested your scenario, it works fine for me with LibreOffice.\n> I don't have Excel.", "bug_id": 61317, "is_private": false, "id": 199978, "time": "2017-07-24T08:49:36Z", "creator": "linard.verstraete@tenforce.com", "creation_time": "2017-07-24T08:49:36Z", "tags": [], "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 61317, "attachment_id": null, "is_private": false, "id": 199989, "time": "2017-07-24T18:28:38Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2017-07-24T18:28:38Z", "text": "Thanks for feedback.\nFrom your answers I see no problem in JMeter.\nIn fact it's the opposite, it was broken before 3.2 (UTF-8 data was corrupt), it is ok now.\n\nClosing as WORKSFORME"}, {"count": 4, "tags": [], "creator": "linard.verstraete@tenforce.com", "attachment_id": null, "id": 200008, "time": "2017-07-25T08:26:37Z", "bug_id": 61317, "creation_time": "2017-07-25T08:26:37Z", "is_private": false, "text": "(In reply to Philippe Mouawad from comment #3)\n> Thanks for feedback.\n> From your answers I see no problem in JMeter.\n> In fact it's the opposite, it was broken before 3.2 (UTF-8 data was\n> corrupt), it is ok now.\n> \n> Closing as WORKSFORME\n\nMaybe I need to rephrase my last paragraph.\n\nChanging the default value of the following property in saveservice.properties\n\n# Character set encoding used to read and write JMeter XML files and CSV results\n_file_encoding=ISO-8859-1\n\nresults in a UTF-8 .csv file. Why is that?"}]