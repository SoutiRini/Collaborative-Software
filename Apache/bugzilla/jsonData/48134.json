[{"count": 0, "tags": [], "bug_id": 48134, "attachment_id": null, "id": 131720, "time": "2009-11-04T19:48:09Z", "creator": "jrlambs@yahoo.com", "creation_time": "2009-11-04T19:48:09Z", "is_private": false, "text": "In XSSF\n\nWhen calling the Picture.resize() function after adding a picture to a spreadsheet the file reference used by the imageio package is being left open.\n\nHow to repeat:  \n1) Use Quick Start Code for inserting an image in an Excel sheet.\n2) Run the code, having it pause just after calling the \"resize\" function.\n3) Check the temp directory on your system.. a file is present called \"imageioXXXX.tmp\"\n4) Allow the program to Continue/End.  (The file is now gone)\n\nI have a J2EE project which generates spreadsheets and embeds images in them.  Each time a spreadsheet is generated a new \"imageio\" file is generated and held open by the java server process.  After generating enough spreadsheets the java process runs out of possible file handles.  The only way to release the hold on/remove the imageio files int he temp directory is to shut down the server and restart it.  When java ends, the files are released.\n\nI believe the bug is located in the getImageDimension() function in the HSSFPicture.java file.  This function opens an ImageIO Image to get its dimension but never closes it.  \n\nI've tried both version 3.2 and 3.5 and the bug is present in both."}, {"attachment_id": null, "tags": [], "creator": "yegor@dinom.ru", "is_private": false, "count": 1, "id": 131772, "time": "2009-11-06T11:34:02Z", "bug_id": 48134, "creation_time": "2009-11-06T11:34:02Z", "text": "A very good catch, thanks!\n\nIt turns out that ImageReader must be disposed, otherwise it may continue to hold system resources indefinitely.\n\nThe fix was committed in r833527\n\nYegor"}, {"count": 2, "tags": [], "bug_id": 48134, "attachment_id": null, "id": 131861, "time": "2009-11-10T21:20:38Z", "creator": "dfisher@jmlafferty.com", "creation_time": "2009-11-10T21:20:38Z", "is_private": false, "text": "*** Bug 48168 has been marked as a duplicate of this bug. ***"}]