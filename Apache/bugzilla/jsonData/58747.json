[{"count": 0, "attachment_id": 33356, "bug_id": 58747, "text": "Created attachment 33356\nincriminated XLSX file\n\nStacktrace:\n\njava.lang.NullPointerException\n\tat org.apache.poi.xssf.eventusermodel.XSSFReader$SheetIterator.<init>(XSSFReader.java:202)\n\tat org.apache.poi.xssf.eventusermodel.XSSFReader$SheetIterator.<init>(XSSFReader.java:170)\n\tat org.apache.poi.xssf.eventusermodel.XSSFReader.getSheetsData(XSSFReader.java:164)\n\tat org.apache.poi.xssf.eventusermodel.XSSFReader$getSheetsData$0.call(Unknown Source)\n\n\nTriggered by getSheetsData() in this code (Groovy):\n\ndef container = OPCPackage.open(file)\nReadOnlySharedStringsTable strings = new ReadOnlySharedStringsTable(container)\nXSSFReader reader = new XSSFReader(container)\nStylesTable styles = reader.getStylesTable()\nXSSFReader.SheetIterator iter = (XSSFReader.SheetIterator) reader.getSheetsData()\n\nCurious thing is: invoking getStylesTable() *after* getSheetsData() like this below does not trigger the NPE:\n\ndef container = OPCPackage.open(file)\nReadOnlySharedStringsTable strings = new ReadOnlySharedStringsTable(container)\nXSSFReader reader = new XSSFReader(container)\nXSSFReader.SheetIterator iter = (XSSFReader.SheetIterator) reader.getSheetsData()\nStylesTable styles = reader.getStylesTable()\n\n\nExample XLSX file is attached", "id": 186998, "time": "2015-12-17T09:59:35Z", "creator": "sergio.nalin@gmail.com", "creation_time": "2015-12-17T09:59:35Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 58747, "is_private": false, "text": "I've had a go at converting your groovy code into a unit test in r1720588.\n\nOne issue - on trunk the unit test passes as-is!\n\nAny chance you could grab release candidate 2 of 3.14 beta 1, and see if it's already fixed for you in that? If not, please let us know what we need to tweak with the unit test to reproduce your issue", "id": 187009, "time": "2015-12-17T15:05:33Z", "creator": "apache@gagravarr.org", "creation_time": "2015-12-17T15:05:33Z", "attachment_id": null}, {"text": "Tested with 3.14-beta2-20151217.\nStill happens.\n\nHere is the stacktrace when using the latest version:\n\njava.lang.NullPointerException\n\tat org.apache.poi.xssf.eventusermodel.XSSFReader$SheetIterator.<init>(XSSFReader.java:204)\n\tat org.apache.poi.xssf.eventusermodel.XSSFReader$SheetIterator.<init>(XSSFReader.java:172)\n\tat org.apache.poi.xssf.eventusermodel.XSSFReader.getSheetsData(XSSFReader.java:166)\n\tat org.apache.poi.xssf.eventusermodel.XSSFReader$getSheetsData$0.call(Unknown Source)", "tags": [], "bug_id": 58747, "is_private": false, "count": 2, "id": 187040, "time": "2015-12-18T13:33:39Z", "creator": "sergio.nalin@gmail.com", "creation_time": "2015-12-18T13:33:39Z", "attachment_id": null}, {"text": "Forgot to add: I'm a bit tied up now, but I'll try to extract the failing code into a simpler unit-test-friendly package", "tags": [], "bug_id": 58747, "is_private": false, "count": 3, "id": 187041, "time": "2015-12-18T13:37:53Z", "creator": "sergio.nalin@gmail.com", "creation_time": "2015-12-18T13:37:53Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 58747, "text": "The unit test added in r1720588 has been passing on every nightly build since. Please re-open this bug with a failing unit test if you are still getting NPE's from openpyxl-generated files.", "id": 194544, "time": "2016-10-19T08:25:38Z", "creator": "onealj@apache.org", "creation_time": "2016-10-19T08:25:38Z", "is_private": false, "attachment_id": null}, {"count": 5, "attachment_id": null, "creator": "onealj@apache.org", "text": "(In reply to Sergio Nalin from comment #2)\n> Tested with 3.14-beta2-20151217.\n> java.lang.NullPointerException\n> \tat\n> org.apache.poi.xssf.eventusermodel.XSSFReader$SheetIterator.\n> <init>(XSSFReader.java:204)\n\nBased on the date and line number, either wb is null or wb.getRelationships() is null. Make sure you aren't mixing versions of poi, poi-ooxml, and poi-ooxml-schemas (or the full ooxml-schemas), as that might cause unexpected behavior.\n\nLine 204:  for(PackageRelationship rel : wb.getRelationships()){\n\nhttps://svn.apache.org/viewvc/poi/trunk/src/ooxml/java/org/apache/poi/xssf/eventusermodel/XSSFReader.java?revision=1715555&view=markup#l196", "id": 194545, "time": "2016-10-19T08:51:04Z", "bug_id": 58747, "creation_time": "2016-10-19T08:51:04Z", "tags": [], "is_private": false}]