[{"count": 0, "tags": [], "creator": "sven.koehler@gmail.com", "attachment_id": null, "text": "The Exception below is produced by this JSP-Page:\n\n<!-- $Id: index.jsp,v 1.39 2004/10/31 20:45:29 sven Exp $ -->\n<%@ page import=\"java.io.*\" %>\n<%\n\tresponse.reset();\n\tOutputStream os = response.getOutputStream();\n\tos.write(0);\n\tos.close();\n%>\n\nThe Exception:\n\nServlet.service() for servlet jsp threw exception\njava.lang.IllegalStateException: getOutputStream() has already been called for t\nhis response\n        at org.apache.catalina.connector.Response.getWriter(Response.java:596)\n        at\norg.apache.catalina.connector.ResponseFacade.getWriter(ResponseFacade.java:186)\n        at org.apache.jasper.runtime.JspWriterImpl.initOut(JspWriterImpl.java:124)\n        at\norg.apache.jasper.runtime.JspWriterImpl.flushBuffer(JspWriterImpl.java:117)\n        at\norg.apache.jasper.runtime.PageContextImpl.release(PageContextImpl.java:191)\n        at\norg.apache.jasper.runtime.JspFactoryImpl.internalReleasePageContext(JspFactoryImpl.java:115)\n        at\norg.apache.jasper.runtime.JspFactoryImpl.releasePageContext(JspFactoryImpl.java:75)\n        at\norg.apache.jsp.test.index_jsp._jspService(org.apache.jsp.test.index_jsp:61)\n        at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:99)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n        at\norg.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:325)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:295)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:245)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at de.djh.servlet.filter.SetDates.doFilter(SetDates.java:80)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:202)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:214)\n        at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)\n        at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:825)\n        at\norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:738)\n        at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:526)\n        at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n        at java.lang.Thread.run(Unknown Source)", "id": 68530, "time": "2004-12-14T23:49:35Z", "bug_id": 32707, "creation_time": "2004-12-14T23:49:35Z", "is_private": false}, {"count": 1, "tags": [], "creator": "remm@apache.org", "text": "The fact that you're calling reset doesn't change the fact that you still have a\npointer to the writer.", "id": 68531, "time": "2004-12-14T23:56:22Z", "bug_id": 32707, "creation_time": "2004-12-14T23:56:22Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "sven.koehler@gmail.com", "attachment_id": null, "is_private": false, "id": 68534, "time": "2004-12-15T00:15:34Z", "bug_id": 32707, "creation_time": "2004-12-15T00:15:34Z", "text": "The JSP-Page\n<!-- $Id: index.jsp,v 1.39 2004/10/31 20:45:29 sven Exp $ -->\n<%@ page import=\"java.io.*\" %>\n<%@ page import=\"java.util.*\" %>\n<%\n\tresponse.reset();\n\tresponse.setContentType(\"text/html\");\n\t\n\tOutputStream os = response.getOutputStream();\n\tos.write(\"wurst\".getBytes());\n\tos.close();\n\t\n\treturn;\n%>\n\nworks as expected, the client will get 5 bytes of content. Only the cleanup-code\nin a finally-block in the compiled JSP-Page causes the exception."}, {"count": 3, "tags": [], "creator": "remm@apache.org", "text": "If you want to discuss fine points in the specification (such as JSP's usage of\na writer), you should IMO try somewhere other than bugzilla. Thank you, and\nplease do not reopen the report.", "id": 68537, "time": "2004-12-15T00:20:25Z", "bug_id": 32707, "creation_time": "2004-12-15T00:20:25Z", "is_private": false, "attachment_id": null}]