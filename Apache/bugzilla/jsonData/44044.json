[{"count": 0, "tags": [], "creator": "michael@metaparadigm.com", "is_private": false, "text": "I was trying to track down a strange bug that affected mod_dav in httpd trunk.\n\nWhen doing a MOVE I was consistently getting this error:\n\n[error] [client 127.0.0.1] Could not MOVE/COPY /uploads/test.  [207, #0]\n[error] [client 127.0.0.1] (2)No such file or directory: Error(s) occurred on\nsome resources during the COPY/MOVE process.  [207, #0]\n\nI instrumented the code and found out that the \"Destination:\" absolute URI was\ngetting mis-parsed by apr-util.\n\nmodules/dav/main/util.c:dav_lookup_uri calls apr_uri_unparse with the\nAPR_URI_UNP_OMITSITEPART flag during translation to local filesystem paths.\n\nInstrumenting the mod_dav code showed it was returning paths like this:\n\"http:/uploads/test2\" resulting in broken translated paths like this:\n\"/usr/local/apache2/uploads/http:/uploads/test2\"\n\napr_uri_unparse is incorrectly adding the scheme when documented not to:\n/* If suppressing the site part, omit both user name & scheme://hostname */", "id": 111566, "time": "2007-12-08T01:14:49Z", "bug_id": 44044, "creation_time": "2007-12-08T01:14:49Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "michael@metaparadigm.com", "attachment_id": 21248, "id": 111567, "creation_time": "2007-12-08T01:16:59Z", "time": "2007-12-08T01:16:59Z", "bug_id": 44044, "text": "Created attachment 21248\nAdd test cases for APR_URI_UNP_OMITSITEPART flag to apr_uri_unparse", "is_private": false}, {"count": 2, "attachment_id": 21249, "bug_id": 44044, "text": "Created attachment 21249\nPatch to make apr_uri_unparse honour APR_URI_UNP_OMITSITEPART flag", "id": 111568, "time": "2007-12-08T01:18:08Z", "creator": "michael@metaparadigm.com", "creation_time": "2007-12-08T01:18:08Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "creator": "michael@metaparadigm.com", "attachment_id": null, "id": 111569, "creation_time": "2007-12-08T01:26:14Z", "time": "2007-12-08T01:26:14Z", "bug_id": 44044, "text": "After applying attached patch I've verified that the mod_dav MOVE operation works.\n\nTest case also added for completeness.", "is_private": false}, {"count": 4, "attachment_id": null, "bug_id": 44044, "is_private": false, "id": 111581, "time": "2007-12-08T06:56:12Z", "creator": "rpluem@apache.org", "creation_time": "2007-12-08T06:56:12Z", "tags": [], "text": "Thanks for the patch. Committed in r602472 and r602476 to apr-util trunk\n(http://svn.apache.org/viewvc?rev=602472&view=rev,\n.http://svn.apache.org/viewvc?rev=602476&view=rev)"}, {"count": 5, "tags": [], "bug_id": 44044, "text": "Backported to 1.2.x as r602693 along with r602690 which caused this bug\n(http://svn.apache.org/viewvc?rev602693=&view=rev,\nhttp://svn.apache.org/viewvc?rev=602690&view=rev).", "id": 111589, "time": "2007-12-09T08:14:06Z", "creator": "rpluem@apache.org", "creation_time": "2007-12-09T08:14:06Z", "is_private": false, "attachment_id": null}]