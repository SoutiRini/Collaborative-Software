[{"count": 0, "tags": [], "bug_id": 53320, "attachment_id": 28856, "id": 159457, "time": "2012-05-29T14:43:41Z", "creator": "j.brauge@qualiac.com", "creation_time": "2012-05-29T14:43:41Z", "is_private": false, "text": "Created attachment 28856\nClone formula\n\nShift a formula that contains absolute cells references with method adjustFormula change abosulte rows references."}, {"count": 1, "tags": [], "bug_id": 53320, "attachment_id": 28857, "is_private": false, "id": 159458, "time": "2012-05-29T14:46:50Z", "creator": "j.brauge@qualiac.com", "creation_time": "2012-05-29T14:46:50Z", "text": "Created attachment 28857\nTemplate excel\n\nTemplate excel.\nCell A1 contains formula :\n=SI($C1=O$1;SI(STXT($F1;1;1)=\"6\";$H1-$I1;$I1-$H1);0)\n\nAfter copy and shitfing formula from cell A1 to cell A2, we have:\n=SI($C2=O$2;SI(STXT($F2;1;1)=\"6\";$H2-$I2;$I2-$H2);0)\ninstead of\n=SI($C2=O$1;SI(STXT($F2;1;1)=\"6\";$H2-$I2;$I2-$H2);0)"}, {"count": 2, "tags": [], "bug_id": 53320, "attachment_id": null, "id": 159459, "time": "2012-05-29T14:50:18Z", "creator": "j.brauge@qualiac.com", "creation_time": "2012-05-29T14:50:18Z", "is_private": false, "text": "Adding test on isRowRelative() in rowMoveRefPtg (in FormulaShifter) seems toworks.\n\nprivate Ptg rowMoveRefPtg(RefPtgBase rptg) {\n\t\tint refRow = rptg.getRow();\n\t\tif (_firstMovedIndex <= refRow && refRow <= _lastMovedIndex) {\n\t\t\t// Rows being moved completely enclose the ref.\n\t\t\t// - move the area ref along with the rows regardless of destination\n            if (rptg.isRowRelative()) \n                rptg.setRow(refRow + _amountToMove); \n\t\t\treturn rptg;\n\t\t}\n...."}, {"count": 3, "tags": [], "bug_id": 53320, "attachment_id": null, "text": "I think this is fixed in POI 3.13, if not earlier.\n\nI'm using XSSFSheet.shiftRows and formulas with absolute row references are getting adjusted, if my memory serves correctly.", "id": 186072, "time": "2015-10-29T09:18:55Z", "creator": "onealj@apache.org", "creation_time": "2015-10-29T09:18:55Z", "is_private": false}, {"count": 4, "tags": [], "text": "This was fixed for row copy but not row move (Sheet.shiftrows)\nhttps://svn.apache.org/viewvc/poi/trunk/src/java/org/apache/poi/ss/formula/FormulaShifter.java?revision=1722410&view=markup", "is_private": false, "id": 190168, "creator": "onealj@apache.org", "time": "2016-04-12T02:25:07Z", "bug_id": 53320, "creation_time": "2016-04-12T02:25:07Z", "attachment_id": null}, {"count": 5, "tags": [], "text": "This behavior may be by design. Shift rows isn't the same as insert rows. I'm not sure if it's the same as cut-paste, either. I'd be happy to discuss this on the dev mailing list.", "is_private": false, "id": 191666, "creator": "onealj@apache.org", "time": "2016-06-15T10:51:09Z", "bug_id": 53320, "creation_time": "2016-06-15T10:51:09Z", "attachment_id": null}]