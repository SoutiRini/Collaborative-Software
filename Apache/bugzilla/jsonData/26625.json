[{"count": 0, "text": "We are having Ant versus IBM class loader conflicts (while trying to deploy our \napplication using WebSphere). Our application does not define a class loader, \nbut Ant utilizes its own class loader. Part of the log information is shown \nbelow (clearly a class loader confliction between WebSphere and Ant), any \nsuggestions will be appreciated. Thanks in advance...\n\n------------------------\n[2/2/04 22:13:44:820 PST] 3c7c9867 SystemErr     R log4j:ERROR \nA \"org.apache.log4j.xml.DOMConfigurator\" object is not assignable to \na \"org.apache.log4j.spi.Configurator\" variable.\n[2/2/04 22:13:44:820 PST] 3c7c9867 SystemErr     R log4j:ERROR The \nclass \"org.apache.log4j.spi.Configurator\" was loaded by \n[2/2/04 22:13:44:820 PST] 3c7c9867 SystemErr     R log4j:ERROR \n[org.apache.tools.ant.AntClassLoader@7a999865] whereas object of type \n[2/2/04 22:13:44:820 PST] 3c7c9867 SystemErr     R \nlog4j:ERROR \"org.apache.log4j.xml.DOMConfigurator\" was loaded by [\ncom.ibm.ws.classloader.CompoundClassLoader@4ec0d865\n------------------------", "bug_id": 26625, "is_private": false, "id": 51643, "time": "2004-02-03T07:57:56Z", "creator": "burcin.ekener@mscsoftware.com", "creation_time": "2004-02-03T07:57:56Z", "tags": [], "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 26625, "is_private": false, "text": "We need more information if we are to help you. Some things to consider\n\n1. What task are you running?\n2. How is Ant being run - command line, IDE\n3. The error message you show does not look like and Ant reported error - where\nis it coming from?\n\n", "id": 51650, "time": "2004-02-03T10:15:29Z", "creator": "conor@apache.org", "creation_time": "2004-02-03T10:15:29Z", "attachment_id": null}, {"count": 2, "text": "1. What task are you running?\nOur application is parsing the XML file the line of code shown below:\n\nProjectHelper ph = new ProjectHelperImpl();\nph.parse(project, antBuildFile);\n\nThe XML file being parsed contains various tasks and we believe the <taskdef> \ntask is the one that is causing the problem.\n\nWe think that the problem is that Ant class loader is conflicting with the \nWebSphere's class loader:\n\nlog4j:ERROR \"org.apache.log4j.xml.DOMConfigurator\" was loaded by [\ncom.ibm.ws.classloader.CompoundClassLoader@4e41f3e4  \n\n2. How is Ant being run - command line, IDE\nIDE - we are utilizing the Apache ant apis as shown in the answer above. \n\n3. The error message you show does not look like and Ant reported error - where\nis it coming from?\n\nWe are also using the log4j as our logging mechanism and we are loading the \nlog4j.properties file from our application as shown below:\n\nDOMConfigurator.configureAndWatch(path, 25000);\n\n\n\n", "bug_id": 26625, "is_private": false, "id": 51673, "time": "2004-02-03T19:27:57Z", "creator": "burcin.ekener@mscsoftware.com", "creation_time": "2004-02-03T19:27:57Z", "tags": [], "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 26625, "attachment_id": null, "text": "Your use of Ant is a little out of the ordinary which means I'm going to need\nmore info about your environment.\n\n1. What are the taskdef's like? What classpaths are being used in the taskdefs?\nWhere are the jars for the taskdef being sourced from.\n\n2. What is the classloader setup in the environment. How is the\nCompoundClassLoader setup - what is the classloader relationship between this\nloader and the classes used for Ant. A classloader delegation hierarchy would be\ngood to see.\n\n3. How are the Ant classes such as Project, etc being loaded. What ClassLoader\nis being used for that.\n\n4. A stacktrace wouldn't go astray here so I can understand in what code the\nproblem is occuring and what is the class trace to their.\n\nI've read some odd things about the IBM classloader\n(http://crazybob.org/roller/page/crazybob/20040123#weird_class_loader_behavior_in)\nbut I'm not sure if something similar is happening here.\n\nBTW to answer a point in your original post, Ant uses its own classloader\nprobably because you are taskdef'ing something with a classpath but I'm still\nguessing there.", "id": 51684, "time": "2004-02-04T04:25:18Z", "creator": "conor@apache.org", "creation_time": "2004-02-04T04:25:18Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 26625, "attachment_id": null, "is_private": false, "id": 93649, "time": "2006-09-15T22:37:59Z", "creator": "peterreilly@apache.org", "creation_time": "2006-09-15T22:37:59Z", "text": "Closing as invalid, no info in two years.\nIt is quite easy to get this sort\nof classloader problems with log4j in a web container."}]