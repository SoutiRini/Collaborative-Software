[{"attachment_id": null, "tags": [], "bug_id": 49810, "text": "It seems that mod_autoindex's directory listing and the custom header\nand footer files are separate streams that are not sequenced/handled\ncorrectly in all circumstances.  Here are details of 2 failure modes.\n\n\n\nTest setup: \n(using a host where PHP as a mod is no longer available, so using php as a cgi.)\n.htaccess includes:\n\n > AddHandler php5-cgi .html\n > AddType text/html .html\n > HeaderName test_doc_header.html\n\nmod_deflate must be enabled.\n\nThe test header is a simple header with a H1 header, like the default.  PHP code to generate the header can be added or omitted without affecting the result.  If using netconnect to test, you must accept compressed output.\n\nFailure mode 1: Accessing a directory (with no index.html) caused the server to serve up the custom header correctly and some garbage for the file listing.  \nDisabling mod_deflate (or not accepting compressed output in client) fixed it so that both came out right.  My guess is that the header was compressed and the file listing was not, so decompressing gave garbage.\n\nFailure mode 2: Start with same setup, but now with mod_deflate disabled.  Add a ReadmeName with a test footer to the htaccess setup.  The sequence of display in the browser is header, footer, then file listing.", "count": 0, "id": 139381, "time": "2010-08-23T11:56:48Z", "creator": "waynedensmore@gmail.com", "creation_time": "2010-08-23T11:56:48Z", "is_private": false}, {"count": 1, "tags": [], "creator": "covener@gmail.com", "text": "I was able to reproduce this with just a Readme and Header that were both just php5-cgi executed phpinfo() scripts, and the directory listing was in fact below the footer.  \n\nUsing simple shell scripts as CGI did not show any problem.", "id": 139382, "attachment_id": null, "bug_id": 49810, "creation_time": "2010-08-23T12:09:46Z", "time": "2010-08-23T12:09:46Z", "is_private": false}]