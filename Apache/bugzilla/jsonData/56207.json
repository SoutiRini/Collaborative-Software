[{"count": 0, "tags": [], "bug_id": 56207, "attachment_id": null, "text": "referred to: HTTP Sampler, HTTP Proxy Server\n\nWhen JMeter follows a redirect (upon a HTTP 302 response) some characters get an unnecessary %-encoding in the URL of the new request, causing some dumb web applications fail.\n\nExample:\n\nServer response:\nHTTP/1.1 302 Found\nLocation: /otrs/index.pl?Action=AgentTicketSearch;Subaction=AJAX\n...\n\nJMeter request:\nGET /otrs/index.pl?Action=AgentTicketSearch%3BSubaction%3DAJAX HTTP/1.1\n...\n\nThis behavior did not occur in 2.9.\nIn the obsoleted RFC 2396 ';', '/' and some other characters where not allowed in the query string. In the recent RFC 3986 (STD 66) the rule was relaxed and these are now vaild characters in a query string. Most browsers do also not encode these characters and pass the URL in the same way as they received it in the Location header (exept for the #fragment part).\n\nThis issue might be related to Bug 54482", "id": 173579, "time": "2014-03-03T12:08:59Z", "creator": "ateles.belzebuth.hybridus+apache@gmail.com", "creation_time": "2014-03-03T12:08:59Z", "is_private": false}, {"count": 1, "tags": [], "creator": "sebb@apache.org", "text": "The problem seems to be that the code calls ConversionUtils.sanitizeUrl which uses the HttpComponents class org.apache.http.client.utils.URIBuilder to recreate the URL from its component parts.\n\nNot sure why, but that uses the same encoding as for form fields.\nIt should probably be using a less restrictive set of safe characters for query encoding.", "id": 173648, "time": "2014-03-05T23:01:02Z", "bug_id": 56207, "creation_time": "2014-03-05T23:01:02Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 56207, "attachment_id": null, "is_private": false, "id": 173649, "time": "2014-03-05T23:11:09Z", "creator": "sebb@apache.org", "creation_time": "2014-03-05T23:11:09Z", "text": "Looks like this has been fixed in URIBuilder in HC 3.4"}, {"count": 3, "tags": [], "bug_id": 56207, "attachment_id": null, "is_private": false, "id": 173701, "time": "2014-03-08T11:12:10Z", "creator": "sebb@apache.org", "creation_time": "2014-03-08T11:12:10Z", "text": "An alternative might be to use the URI class for encoding.\nSee also Bug 56231"}, {"count": 4, "tags": [], "bug_id": 56207, "attachment_id": null, "is_private": false, "id": 173755, "time": "2014-03-12T02:25:02Z", "creator": "ateles.belzebuth.hybridus+apache@gmail.com", "creation_time": "2014-03-12T02:25:02Z", "text": "An similar issue occur with characters outside the allowed set. I came across a web application which insists of using an unencoded pipe sigen (\"|\", %7C) as part of the query string. I consider this as a bug of that application, but browsers allow this. Therefore JMeter should allow this also, if the option \"Encode\" is not checked in the HTML-Sampler."}, {"text": "(In reply to ateles.belzebuth.hybridus+apache from comment #4)\n> An similar issue occur with characters outside the allowed set. I came\n> across a web application which insists of using an unencoded pipe sigen\n> (\"|\", %7C) as part of the query string. I consider this as a bug of that\n> application, but browsers allow this. Therefore JMeter should allow this\n> also, if the option \"Encode\" is not checked in the HTML-Sampler.\n\nThe Encode option does not apply to redirects - it applies to specific parameters on the HTTP Sampler screem.\n\nIf there is a problem with samples containing a pipe sign in the query string, please raise a separate issue for that.", "tags": [], "creator": "sebb@apache.org", "attachment_id": null, "count": 5, "id": 173793, "time": "2014-03-13T13:32:57Z", "bug_id": 56207, "creation_time": "2014-03-13T13:32:57Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 56207, "attachment_id": null, "is_private": false, "id": 173866, "time": "2014-03-17T00:51:58Z", "creator": "sebb@apache.org", "creation_time": "2014-03-17T00:51:58Z", "text": "URL: http://svn.apache.org/r1578190\nLog:\nURLs get encoded on redirects in HC3.1 & HC4 samplers\nOnly encode if URL is not correctly encoded\nBugzilla Id: 56207\n\nModified:\n    jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/util/ConversionUtils.java\n    jmeter/trunk/test/src/org/apache/jmeter/protocol/http/util/TestHTTPUtils.java\n    jmeter/trunk/xdocs/changes.xml"}]