[{"count": 0, "tags": [], "bug_id": 60558, "is_private": false, "text": "Created attachment 34598\nminimal httpd configuration to exhibit bug\n\nWith the attached example.conf, I get situations where the variable %{HTTPS} is \"on\", but the variable %{REQUEST_SCHEME} is \"http\", not \"https\".\n\nTo reproduce:\nbin/httpd -f example.conf\n(please provide dummy certificate pair; you may also need to LoadModule your MPM of choice)\n\nwget --no-check-certificate --server-response -O- http://localhost\nyields\nLocation: [...]?port=80&scheme=http&https=off\nas expected, while\nwget --no-check-certificate --server-response -O- https://localhost\nyields\nLocation: [...]?port=443&scheme=http&https=on\n\nIf disabling UseCanonicalPhysicalPort, you get port=80 in the second case as well. A simple workaround is to not use %{REQUEST_SCHEME} at all but instead set  an environment variable by inspecting %{HTTPS} and use that.\n\n\n(I realize that having a single VirtualHost definition for ports 80 and 443 in the way shown here probably only works by accident, not design, but it does that from at least 2.2.3 up to 2.4.25 and provides the much-desired possibility to avoid duplicating the entire content of the definition. Still, I guess \"we will make that use-case fail\" would \"fix\" it.)", "id": 195889, "time": "2017-01-06T12:08:22Z", "creator": "schwarz@rz.uni-kiel.de", "creation_time": "2017-01-06T12:08:22Z", "attachment_id": 34598}]