[{"count": 0, "tags": [], "creator": "jaibabus@gmail.com", "attachment_id": null, "id": 133534, "time": "2010-01-11T21:01:05Z", "bug_id": 48528, "creation_time": "2010-01-11T21:01:05Z", "is_private": false, "text": "Hai Experts,\n\n     While creating an Excel Template with POI 3.5-FINAL API the DATE() function works abnormally. I used the following function \n\nDATE(YEAR(A20),MONTH(A20)-1,DAY(A20)) \n      ie., DATE(YEAR(previouscolumn value),MONTH(PreviousColumn Value)-1, \n                                                        DAY(PreviousCOlumn Value))\n\n     The above formula is working for some date ranges. If the previous column value is \"February-09\" it is correctly calculating the next value as \"January-09\"\nusing the above formula. But it fails after that. After \"January-09\" the next evaluation of the formula is not working properly saying \"#Value\" in the column with out any error such as \"Not Yet Implemented\". If i keep the cursor in the particular cell and i press enter without changing the value or formula then the excel calculates the value correctly. Hope this is a bug in POI 3.5-Final API. How can i overcome this.\n\nThanks\nJaibabu"}, {"count": 1, "tags": [], "creator": "josh@apache.org", "attachment_id": null, "id": 133730, "time": "2010-01-20T08:54:01Z", "bug_id": 48528, "creation_time": "2010-01-20T08:54:01Z", "is_private": false, "text": "You seem to be describing unexpected behaviour from Excel, but we're going to need explicit details on how POI produced this workbook. Please upload some simple java code to produce this error (If relevant please add example input/output files).\n\nAnother observation that may be useful: Does Excel fix the value if you force a recalculation of the whole sheet (instead of re-parsing the single cell as you described)?"}, {"count": 2, "tags": [], "creator": "jaibabus@gmail.com", "attachment_id": 24871, "is_private": false, "id": 133767, "time": "2010-01-21T00:03:45Z", "bug_id": 48528, "creation_time": "2010-01-21T00:03:45Z", "text": "Created attachment 24871\nJava file to generate Excel using POI3.5"}, {"count": 3, "tags": [], "creator": "jaibabus@gmail.com", "attachment_id": 24872, "is_private": false, "id": 133768, "time": "2010-01-21T00:05:23Z", "bug_id": 48528, "creation_time": "2010-01-21T00:05:23Z", "text": "Created attachment 24872\nTemplate Excel file that POI reads"}, {"count": 4, "tags": [], "creator": "jaibabus@gmail.com", "is_private": false, "id": 133769, "attachment_id": 24873, "bug_id": 48528, "creation_time": "2010-01-21T00:06:33Z", "time": "2010-01-21T00:06:33Z", "text": "Created attachment 24873\nExcel file created Using POI3.5"}, {"count": 5, "text": "Hai Josh,\n\n    Thanks for your response. I herewith attaching the Java file i used for writing Excel file using POI. (The java code reads a template excel file and generates the new Excel file with new values.)\n\n    I am also attaching the \"DemoTemplateFile.xlsx\" which is used as a template file(from which the POI reads the format and formula) and \"sampledemo.xlsx\" file that POI generates using java code.\n\n    In sampledemo.xlsx file please check the column \"B12-B19\" the Date formula is not evaluated correctly. But it evaluates the Date formula above that cell (B7-B11) correctly.\nThe formula used in that column is DATE( YEAR(  B6  ), MONTH( B6  )-1, DAY( B6 ) )\nAssuming -1 is the problem in evaluation.\n\n    If suppose if i use +1 instead it is evaluating correctly. Please refer Column (A7-A19).\n\n   I used formula Evaluator to evaluate the formula cells in the Sheet. But i get the same result.\n\n  Hope this may be useful for you.\n\nThanks\nJaibabu.J", "bug_id": 48528, "is_private": false, "id": 133770, "time": "2010-01-21T00:06:56Z", "creator": "jaibabus@gmail.com", "creation_time": "2010-01-21T00:06:56Z", "tags": [], "attachment_id": null}, {"count": 6, "tags": [], "creator": "jaibabus@gmail.com", "is_private": false, "id": 133771, "attachment_id": null, "bug_id": 48528, "creation_time": "2010-01-21T00:08:41Z", "time": "2010-01-21T00:08:41Z", "text": "Hai Josh,\n\n    Thanks for your response. I herewith attaching the Java file i used for writing Excel file using POI. (The java code reads a template excel file and generates the new Excel file with new values.)\n\n    I am also attaching the \"DemoTemplateFile.xlsx\" which is used as a template file(from which the POI reads the format and formula) and \"sampledemo.xlsx\" file that POI generates using java code.\n\n    In sampledemo.xlsx file please check the column \"B12-B19\" the Date formula is not evaluated correctly. But it evaluates the Date formula above that cell (B7-B11) correctly.\nThe formula used in that column is DATE( YEAR(  B6  ), MONTH( B6  )-1, DAY( B6 ) )\nAssuming -1 is the problem in evaluation.\n\n    If suppose if i use +1 instead it is evaluating correctly. Please refer Column (A7-A19).\n\n   I used formula Evaluator to evaluate the formula cells in the Sheet. But i get the same result.\n\n  Hope this may be useful for you.\n\nThanks\nJaibabu.J"}, {"count": 7, "tags": [], "creator": "jaibabus@gmail.com", "attachment_id": null, "id": 133872, "time": "2010-01-24T20:00:20Z", "bug_id": 48528, "creation_time": "2010-01-24T20:00:20Z", "is_private": false, "text": "Hai Experts,\n\n    I hope the explanation i gave was enough. Please have a look in this issue.\n\nThanks\nJaibabu.J"}, {"count": 8, "tags": [], "creator": "jaibabus@gmail.com", "attachment_id": null, "is_private": false, "id": 134167, "time": "2010-02-03T01:20:24Z", "bug_id": 48528, "creation_time": "2010-02-03T01:20:24Z", "text": "Hai,\n\n   Is there any thing need to explain about the problem more?\n\n   Please reply.\n\nThanks\nJaibabu.J"}, {"count": 9, "text": "This bug is still present in poi 3.7 final. Excel interprets carries in the date formula function, e.g. DATE(2012;MONTH(TODAY())-1;1) is evaluated to 2011-12-01 in January; DATE(2012;MONTH(TODAY())-13;1) is evaluated to 2010-12-01 then. It's the same with positive values and for carries at the date value.", "bug_id": 48528, "is_private": false, "id": 152568, "time": "2012-01-04T12:43:47Z", "creator": "brezelman@yahoo.de", "creation_time": "2012-01-04T12:43:47Z", "tags": [], "attachment_id": null}, {"count": 10, "tags": [], "creator": "apache@gagravarr.org", "is_private": false, "id": 152577, "attachment_id": null, "bug_id": 48528, "creation_time": "2012-01-05T02:08:45Z", "time": "2012-01-05T02:08:45Z", "text": "Could someone please re-test with POI 3.8 beta 5 (the latest beta release), and confirm if the problem is fixed there or not?"}, {"count": 11, "tags": [], "creator": "brezelman@yahoo.de", "attachment_id": null, "is_private": false, "id": 152579, "time": "2012-01-05T07:34:14Z", "bug_id": 48528, "creation_time": "2012-01-05T07:34:14Z", "text": "I checked the SVN code. Implementation of Date function doesn't deal with any carry. SVN history (log) of DateFunc.java only mentions elimination of dependency on HSSF and reduction of eclipse warnings after 3.7 release."}, {"count": 12, "tags": [], "text": "Fixed in r1331796.", "attachment_id": null, "bug_id": 48528, "id": 158500, "time": "2012-04-28T17:29:25Z", "creator": "apache@gagravarr.org", "creation_time": "2012-04-28T17:29:25Z", "is_private": false}]