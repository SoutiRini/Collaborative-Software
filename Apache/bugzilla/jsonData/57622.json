[{"count": 0, "tags": [], "bug_id": 57622, "text": "Hi!\n\nAt work we were making use of POI and when we updated the version to 3.11 we suffered some incompatibility issues. We have IBM WAS 7 servers and are unable to migrate (easily to WAS 8.5.5). IBMs JDK 1.6 implementation doesn't include all stax related classes and methods. Namely, we had an issue with POI class \nPackagePropertiesMarshaller.java, where it includes:\n\n  static\n  {\n    XMLEventFactory f = XMLEventFactory.newFactory();\n    namespaceDC = f.createNamespace(\"dc\", \"http://purl.org/dc/elements/1.1/\");\n    namespaceCoreProperties = f.createNamespace(\"cp\", \"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\");\n    namespaceDcTerms = f.createNamespace(\"dcterms\", \"http://purl.org/dc/terms/\");\n    namespaceXSI = f.createNamespace(\"xsi\", \"http://www.w3.org/2001/XMLSchema-instance\");\n  }\n\nIBM implementation has newInstance(), but not newFactory (in Oracle's JVM, it was introduced in 1.6 fix 18)\n\nWe have had to change PackagePropertiesMarshaller.java to use newInstance, so it could keep on running in our servers:\n\n  static\n  {\n    XMLEventFactory f = XMLEventFactory.newInstance();\n    namespaceDC = f.createNamespace(\"dc\", \"http://purl.org/dc/elements/1.1/\");\n    namespaceCoreProperties = f.createNamespace(\"cp\", \"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\");\n    namespaceDcTerms = f.createNamespace(\"dcterms\", \"http://purl.org/dc/terms/\");\n    namespaceXSI = f.createNamespace(\"xsi\", \"http://www.w3.org/2001/XMLSchema-instance\");\n  }\n\nAs the resultin execution is the same, to mantain compatibility with the broadest range of servers, I'd suggest to change this particular call.", "id": 181251, "attachment_id": null, "creator": "mediocaballero.spam@gmail.com", "creation_time": "2015-02-23T12:12:03Z", "time": "2015-02-23T12:12:03Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 57622, "text": "Do all unit tests still pass on an Orcale JVM after the change?\n\n(We don't want to make the change and break things on other JVMs!)", "id": 181256, "attachment_id": null, "creator": "apache@gagravarr.org", "creation_time": "2015-02-23T14:03:23Z", "time": "2015-02-23T14:03:23Z", "is_private": false}, {"count": 2, "tags": [], "text": "I haven't been able to test it, but according to API spec, it shouldn't have any effect.\n\nnewInstance existed since first version of stax api, while newFactoy was introduced in Oracle 1.6.0.18 'to mantain api consistency', but both have the same functionality.\n\nhttp://docs.oracle.com/javase/6/docs/api/javax/xml/stream/XMLEventFactory.html#newInstance(java.lang.String, java.lang.ClassLoader)\n\nhttp://upstream.rosalinux.ru/java/compat_reports/jdk/1.6.0.17_to_1.6.0.18/bin_compat_report.html#Added\n\nAlso as a reference, other users with the same issue:\nhttp://mail-archives.apache.org/mod_mbox/poi-dev/201501.mbox/%3CFB8F943CCE197F4A8C65545509CA885B0180A24F7FD8@MSGRTPCCRF2WIN.DMN1.FMR.COM%3E", "is_private": false, "id": 181272, "creator": "mediocaballero.spam@gmail.com", "time": "2015-02-23T16:31:13Z", "bug_id": 57622, "creation_time": "2015-02-23T16:31:13Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 57622, "is_private": false, "id": 181293, "attachment_id": null, "creator": "apache@gagravarr.org", "creation_time": "2015-02-24T12:04:37Z", "time": "2015-02-24T12:04:37Z", "text": "Changed in r1661903, thanks for your investigations and help on this!"}]