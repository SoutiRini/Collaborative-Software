[{"count": 0, "tags": [], "creator": "asf-bugzilla@lotk.de", "attachment_id": null, "is_private": false, "id": 69595, "time": "2005-01-12T14:06:13Z", "bug_id": 33063, "creation_time": "2005-01-12T14:06:13Z", "text": "Hello,\n\nin my web.xml I got this filter\n\n  <filter>\n    <filter-name>RequestFilter</filter-name>\n    <filter-class>de.lotk.webftp.servlet.RequestFilter</filter-class>\n  </filter>\n\nwith this filter-mapping:\n\n  <filter-mapping>\n    <filter-name>RequestFilter</filter-name>\n    <url-pattern>*.do</url-pattern>\n  </filter-mapping>\n\n  <filter-mapping>\n    <filter-name>RequestFilter</filter-name>\n    <url-pattern>*.jsp</url-pattern>\n  </filter-mapping>\n\nso only JSP-Files and Struts-Action should be filtered.\n\nUnfortunately tomcat also matches a call to the context-root:\n\n DEBUG http-8080-Processor25 de.lotk.webftp.servlet.RequestFilter - No valid\nSession - redirecting Request \"http://localhost:8080/webftp/\" to:\n\"/webftp/sessionTimeout.jsp\"\n\n\nWith other application-servers this doesn't happen...\n\nBest regards\nStephan"}, {"count": 1, "attachment_id": null, "creator": "remm@apache.org", "text": "Please submit a ready to test war.\nI suspect welcome files are what is giving you trouble.", "id": 69596, "time": "2005-01-12T14:11:05Z", "bug_id": 33063, "creation_time": "2005-01-12T14:11:05Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "asf-bugzilla@lotk.de", "attachment_id": 13980, "id": 69597, "time": "2005-01-12T14:44:21Z", "bug_id": 33063, "creation_time": "2005-01-12T14:44:21Z", "is_private": false, "text": "Created attachment 13980\nExample-war-file\n\nTo make the warfile smaller I deleted the files\n\ncommons-collections.jar\nand\ncommand-digester.jar\n\nin WEB-INF/lib/\n\nTo deploy the WAR in Tomcat reinsert them."}, {"count": 3, "tags": [], "creator": "remm@apache.org", "is_private": false, "text": "Well, it's exactly what I said.\n\"/\" will be rewritten as \"/index.jsp\" and your filter will be invoked.", "id": 69598, "time": "2005-01-12T14:49:26Z", "bug_id": 33063, "creation_time": "2005-01-12T14:49:26Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 33063, "attachment_id": null, "text": "Sorry, but this can't be the solution.\n\nFrom RequestFilter.java:\n\n  protected static String[] ignoredResources;\n\n  static {\n\n    ignoredResources = new String[5];\n    ignoredResources[0] = \"sessionTimeout.jsp\";\n    ignoredResources[1] = \"index.jsp\";\n    ignoredResources[2] = \"gotoLogon.do\";\n    ignoredResources[3] = \"logon.do\";\n    ignoredResources[4] = \"staticJavascript.jsp\";\n  }\n\n  [...]\n\n      // Welche Resource wird gerade aufgerufen?\n      String requestURL = httpRequest.getRequestURL().toString();\n\n      // Wird eine \"ignorierte Resource\" aufgerufen?\n      boolean ignoredResource = false;\n\n      for(int xx = 0; xx < ignoredResources.length; xx++) {\n\n        if(requestURL.endsWith(ignoredResources[xx])) {\n\n          ignoredResource = true;\n          break;\n        }\n      }\n\n      // Wenn eine \"ignorierte Resource\" aufgerufen wird auch weitergehen.\n      if(ignoredResource) {\n\n        filterChain.doFilter(request, response);\n      }\n\n\n-----------------\n\nAs you see \"index.jsp\" will not be handled and CANNOT out put this:\n\n DEBUG http-8080-Processor25 de.lotk.webftp.servlet.RequestFilter - No valid\nSession - redirecting Request \"http://localhost:8080/webftp/\" to:\n\"/webftp/sessionTimeout.jsp\"\n\n\n(besides the \"requestURL\" would than be \"http://localhost:8080/webftp/index.jsp\"\nand NOT \"http://localhost:8080/webftp/\"\n\nBest regards\nStephan", "id": 69600, "time": "2005-01-12T14:57:13Z", "creator": "asf-bugzilla@lotk.de", "creation_time": "2005-01-12T14:57:13Z", "is_private": false}, {"count": 5, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "id": 69601, "time": "2005-01-12T15:15:42Z", "bug_id": 33063, "creation_time": "2005-01-12T15:15:42Z", "is_private": false, "text": "Well, sorry, I'm just telling you how stuff works.\nThis is tomcat-user material, but requestURL is the URL exactly as sent by the\nclient."}, {"count": 6, "tags": [], "creator": "asf-bugzilla@lotk.de", "attachment_id": null, "is_private": false, "id": 69602, "time": "2005-01-12T15:59:52Z", "bug_id": 33063, "creation_time": "2005-01-12T15:59:52Z", "text": "Well, obviously Tomcat 5.5 doesn't seem to send a redirect for the wellcome-file\nany more, but immediately sends the content of the wellcome-file.\n\nI don't know if I like this behavior, but the servlet-specification seems to\nallow it.\n\nHowever, the httpd should send a \"Content-Location:\"-Header in this case..."}, {"count": 7, "tags": [], "text": "I don't think we're going to be doing that, as it's optional, and no client\nwould be using it.\n\nBTW, Tomcat 5.0 has the same behavior as Tomcat 5.5. Were you using 5.0 before ?", "attachment_id": null, "bug_id": 33063, "id": 69605, "time": "2005-01-12T17:19:51Z", "creator": "remm@apache.org", "creation_time": "2005-01-12T17:19:51Z", "is_private": false}, {"count": 8, "tags": [], "creator": "asf-bugzilla@lotk.de", "attachment_id": null, "id": 69622, "time": "2005-01-13T08:57:46Z", "bug_id": 33063, "creation_time": "2005-01-13T08:57:46Z", "is_private": false, "text": "Doesn't that mean that in a filter I have no chance to find out what resource is\nbeing actually send to the client? That would be kind of sad...\n\nTo answer your question:\nI developed my application under JBoss 3.2.3, which comes with Tomcat 4.whatever."}, {"count": 9, "tags": [], "text": "Of course you know what's being sent: the only thing which isn't changed are the\ngetRequestURL/URI methods (which, BTW, return the %xx encoded path as sent by\nthe client, so the algorithm you used won't work in other cases). You should use\nthe other methods to retrieve path information.", "is_private": false, "bug_id": 33063, "id": 69626, "time": "2005-01-13T11:39:45Z", "creator": "remm@apache.org", "creation_time": "2005-01-13T11:39:45Z", "attachment_id": null}]