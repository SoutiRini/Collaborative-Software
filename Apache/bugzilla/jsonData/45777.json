[{"count": 0, "text": "When header length more than 255 symbols (maximum allowed by xls format) java.lang.ArrayIndexOutOfBoundsException occures\n\nCode:\nHSSFWorkbook workBook = new HSSFWorkbook();\nHSSFSheet sheet = workBook.createSheet(\"Sheet 1\");\nsheet.getHeader().setCenter(reportTitle);\n\nException:\nException in thread \"main\" java.lang.ArrayIndexOutOfBoundsException\n\tat java.lang.System.arraycopy(Native Method)\n\tat org.apache.poi.util.StringUtil.putUnicodeLE(StringUtil.java:208)\n\tat org.apache.poi.hssf.record.HeaderRecord.serialize(HeaderRecord.java:179)\n\tat org.apache.poi.hssf.model.Sheet.serialize(Sheet.java:825)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.getBytes(HSSFWorkbook.java:1188)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.write(HSSFWorkbook.java:1118)\n\tat poiutils.HSSFUtils.flushWorkBook(HSSFUtils.java:170)\n\tat POITest.main(POITest.java:45)", "bug_id": 45777, "is_private": false, "id": 120532, "time": "2008-09-11T04:42:29Z", "creator": "aaacmc@mail.ru", "creation_time": "2008-09-11T04:42:29Z", "tags": [], "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 45777, "is_private": false, "text": "Any thoughts on what would be a logical exception to throw instead? Perhaps IllegalArgumentException or IllegalStateException\n\nI think picking the right exception may well be harder than detecting the situation and throwing it :)", "id": 120534, "time": "2008-09-11T05:34:35Z", "creator": "apache@gagravarr.org", "creation_time": "2008-09-11T05:34:35Z", "attachment_id": null}, {"count": 2, "text": "IllegalArgumentException is now thrown at the right point", "bug_id": 45777, "is_private": false, "id": 120836, "time": "2008-09-21T10:38:38Z", "creator": "apache@gagravarr.org", "creation_time": "2008-09-21T10:38:38Z", "tags": [], "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 45777, "text": "svn r697559\n\n.", "id": 127619, "time": "2009-06-03T19:02:52Z", "creator": "josh@apache.org", "creation_time": "2009-06-03T19:02:52Z", "is_private": false, "attachment_id": null}, {"count": 4, "text": "This bug was probably mis-diagnosed.  Excel handles header / footer text longer than 256 bytes, and none of the documentation mentions this limit.\n\nPrior to the introduction of StandardRecord (and LittleEndian input/output refactoring of the BIFF serialization) this code was much more fragile.  It's likely that the original bug was fixed through all that work.\n\nAs of the fix for bug 47244, POI now allows header / footer text much longer than 256 bytes.  POI enforces a limit of 8221 bytes.  I am not sure if this is the absolute max, but it avoids the need for BIFF record continuation logic.", "bug_id": 45777, "is_private": false, "id": 127623, "time": "2009-06-03T20:57:03Z", "creator": "josh@apache.org", "creation_time": "2009-06-03T20:57:03Z", "tags": [], "attachment_id": null}]