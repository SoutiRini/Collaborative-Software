[{"count": 0, "tags": [], "bug_id": 55296, "attachment_id": null, "text": "After an overnight run httpd memory usage has reached to 1.6Gb.\nMemory consumption started at around 10Mb and httpd service was left running overnight which resulted in increase in memory to 1.6Gb.\nSystem resource are getting exhausted.\n\n1. Start httpd service.\n2. Use service which send request to httpd server(as our application is GUI based which send request)\n3. Keep http service running overnight.\n\nlist of packages used:\nhttpd-2.2.3-43.el5.centos\nmod_python-3.2.8-3.1", "id": 168725, "time": "2013-07-23T07:51:41Z", "creator": "sumitinder.digra@aricent.com", "creation_time": "2013-07-23T07:51:41Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 55296, "is_private": false, "text": "Does it happen without mod_python? What's the minimum set of modules/config that shows the leak?", "id": 168732, "time": "2013-07-23T11:08:39Z", "creator": "covener@gmail.com", "creation_time": "2013-07-23T11:08:39Z", "attachment_id": null}, {"count": 2, "attachment_id": null, "creator": "sumitinder.digra@aricent.com", "is_private": false, "id": 168748, "time": "2013-07-24T05:20:11Z", "bug_id": 55296, "creation_time": "2013-07-24T05:20:11Z", "tags": [], "text": "This issue is observed on Centos 5.5. We need mod_python for our application as HTML code is generated using mod_python module at our end.\n\nWe are running our application with the below module set mentioned in httpd.conf file.\n\nLoadModule auth_basic_module modules/mod_auth_basic.so\nLoadModule authn_file_module modules/mod_authn_file.so\nLoadModule authz_host_module modules/mod_authz_host.so\nLoadModule authz_user_module modules/mod_authz_user.so\nLoadModule log_config_module modules/mod_log_config.so\nLoadModule logio_module modules/mod_logio.so\nLoadModule env_module modules/mod_env.so\nLoadModule mime_magic_module modules/mod_mime_magic.so\nLoadModule expires_module modules/mod_expires.so\nLoadModule deflate_module modules/mod_deflate.so\nLoadModule setenvif_module modules/mod_setenvif.so\nLoadModule mime_module modules/mod_mime.so\nLoadModule status_module modules/mod_status.so\nLoadModule autoindex_module modules/mod_autoindex.so\nLoadModule negotiation_module modules/mod_negotiation.so\nLoadModule dir_module modules/mod_dir.so\nLoadModule alias_module modules/mod_alias.so\n#LoadModule proxy_module modules/mod_proxy.so\nLoadModule cgi_module modules/mod_cgi.so\nLoadModule version_module modules/mod_version.so\n\n\nAdditionally, few modules are also loaded from conf.d/ path:-\n1. mrtg.conf\n2. php.conf (though we dont use php)\n3. python.conf\n4. squid.conf\n5. webalizer.conf"}, {"count": 3, "tags": [], "creator": "covener@gmail.com", "is_private": false, "text": "We have to assume the leak is in mod_python, which isn't part of the httpd distribution from the ASF. If you can show a leak without it [and other non-ASF modules], re-open.", "id": 168754, "time": "2013-07-24T10:44:16Z", "bug_id": 55296, "creation_time": "2013-07-24T10:44:16Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "sumitinder.digra@aricent.com", "attachment_id": null, "text": "Eric, how will you conclude that it is related to mod_python issue? Do you any reference to that.\n\nMeanwhile, we have reduced number of modules in httpd.conf file \n\nLoadModule authz_host_module modules/mod_authz_host.so\nLoadModule log_config_module modules/mod_log_config.so\nLoadModule setenvif_module modules/mod_setenvif.so\nLoadModule mime_module modules/mod_mime.so\nLoadModule autoindex_module modules/mod_autoindex.so\nLoadModule negotiation_module modules/mod_negotiation.so\nLoadModule dir_module modules/mod_dir.so\nLoadModule alias_module modules/mod_alias.so\nLoadModule cgi_module modules/mod_cgi.so\n\nincluding mod_python module.\n\nPlease suggest if you have any inputs in this regard.", "id": 168758, "time": "2013-07-24T12:09:41Z", "bug_id": 55296, "creation_time": "2013-07-24T12:09:41Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 55296, "attachment_id": null, "is_private": false, "id": 168759, "time": "2013-07-24T12:24:03Z", "creator": "covener@gmail.com", "creation_time": "2013-07-24T12:24:03Z", "text": "(In reply to Sumitinder from comment #4)\n> Eric, how will you conclude that it is related to mod_python issue? Do you\n> any reference to that.\n> \n> Meanwhile, we have reduced number of modules in httpd.conf file \n> \n> LoadModule authz_host_module modules/mod_authz_host.so\n> LoadModule log_config_module modules/mod_log_config.so\n> LoadModule setenvif_module modules/mod_setenvif.so\n> LoadModule mime_module modules/mod_mime.so\n> LoadModule autoindex_module modules/mod_autoindex.so\n> LoadModule negotiation_module modules/mod_negotiation.so\n> LoadModule dir_module modules/mod_dir.so\n> LoadModule alias_module modules/mod_alias.so\n> LoadModule cgi_module modules/mod_cgi.so\n> \n> including mod_python module.\n> \n> Please suggest if you have any inputs in this regard.\n\nYou're looking for support, not to report a bug.  Bugzilla is only for bugs.  You'll have to find someone to help you narrow this down (perhaps the user support mailing list advertised on the httpd website)"}, {"count": 6, "tags": [], "creator": "sf@sfritsch.de", "attachment_id": null, "is_private": false, "id": 168769, "time": "2013-07-24T19:37:24Z", "bug_id": 55296, "creation_time": "2013-07-24T19:37:24Z", "text": "In any case, there is nothing we can do about a 7 years old release. Httpd 2.4.x has greatly reduced memory usage in some configurations. And even in the 2.2.x branch, there have been various memory leak fixes since 2.2.3, for example in 2.2.8 and 2.2.15.\n\nSo, unless you can reproduce the issue with a current version, we won't spend any time investigating further."}, {"count": 7, "tags": [], "bug_id": 55296, "text": "Moreover, looking at mod_python homepage:\n\nv3.2.10:\n(MODPYTHON-78) Added support for Apache 2.2.\n(MODPYTHON-172) Fixed three memory leaks that were found in _apachemodule.parse_qsl, req.readlines and util.cfgtree_walk. \n\nv3.3.1:\n(MODPYTHON-181) Fixed memory leak when mod_python handlers are defined for more than one phase at the same time.\n(MODPYTHON-182) Fixed memory leak in req.readline().\n(MODPYTHON-184) Fix memory leak in apache.make_table(). This was used by util.FieldStorage class so affected all code using forms. \n(MODPYTHON-194) Fixed potential memory leak due to not clearing the state of thread state objects before deleting them.", "id": 168772, "attachment_id": null, "creator": "christophe.jaillet@wanadoo.fr", "creation_time": "2013-07-24T20:54:09Z", "time": "2013-07-24T20:54:09Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 55296, "text": "Hi,\n\nWe have observed this issue is coming when httpd reload command is invoked. We confirmed that this comes when mod_python is imported in httpd.conf file.\n\nIt is 100% reproducible and coming on both Centos 5.x and 6.4 setups. Can you please check and suggest if there is any issue in httpd reload command?\n\nRegards,\nAman Aggarwal", "id": 177794, "attachment_id": null, "creator": "aman.aggarwal@aricent.com", "creation_time": "2014-09-12T09:52:52Z", "time": "2014-09-12T09:52:52Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 55296, "text": "I suspect that since, mod_python is not part of httpd product lines, hence, may be during reload, the code might not be releasing earlier loaded mod_python module.\n\nCan you please suggest way how can we avoid reloading of mod_python module during httpd reload?\n\nregards,\naman", "id": 177795, "time": "2014-09-12T10:08:00Z", "creator": "aman.aggarwal@aricent.com", "creation_time": "2014-09-12T10:08:00Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "creator": "covener@gmail.com", "attachment_id": null, "is_private": false, "id": 177802, "time": "2014-09-12T11:43:58Z", "bug_id": 55296, "creation_time": "2014-09-12T11:43:58Z", "text": "(In reply to Aman Aggarwal from comment #9)\n> I suspect that since, mod_python is not part of httpd product lines, hence,\n> may be during reload, the code might not be releasing earlier loaded\n> mod_python module.\n> \n> Can you please suggest way how can we avoid reloading of mod_python module\n> during httpd reload?\n\nnothing we can help with in ASF bugzilla."}]