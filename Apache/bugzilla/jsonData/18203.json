[{"count": 0, "tags": [], "creator": "err@webedge.dk", "attachment_id": null, "id": 33565, "time": "2003-03-20T20:03:00Z", "bug_id": 18203, "creation_time": "2003-03-20T20:03:00Z", "is_private": false, "text": "I havent found a consistent way of provoking this error, but using Jikes 1.1.8\nas the compiler for JSP pages sometime fails when the JSP page is initially\ncompiled or a change has occurred to the page.\n\nI've tracked the problem to a taglib I'm using on the pages that fails. This\ntaglib is in jar format (with a MANIFEST.MF/taglib.tld file). \n\n\nJikes produces the following error:\n\n20:49:59,701 ERROR [Engine] ApplicationDispatcher[/webshop] Servlet.service()\nfor servlet jsp threw exception\norg.apache.jasper.JasperException: Unable to compile class for JSP\n\nAn error occurred at line: -1 in the jsp file: null\n\nGenerated servlet error:\n    [javac] Compiling 1 source file\n\n    [javac] Issued 14 system warnings:\n\n    [javac] *** Semantic Warning: The file\n\"/usr/java/jboss-3.0.6_tomcat-4.1.18/server/default/tmp/deploy/server/default/deploy/properties-service.xml/10.properties-service.xml\"\nis not a valid directory.\n\n\n    [javac] *** Semantic Warning: The file\n\"/usr/java/jboss-3.0.6_tomcat-4.1.18/server/default/tmp/deploy/server/default/deploy/user-service.xml/14.user-service.xml\"\nis not a valid directory.\n\n\n    [javac] *** Semantic Warning: The file\n\"/usr/java/jboss-3.0.6_tomcat-4.1.18/server/default/tmp/deploy/server/default/conf/jboss-service.xml/1.jboss-service.xml\"\nis not a valid directory.\n\n\n    [javac] *** Semantic Warning: The file\n\"/usr/java/jboss-3.0.6_tomcat-4.1.18/server/default/tmp/deploy/server/default/deploy/mail-service.xml/9.mail-service.xml\"\nis not a valid directory.\n\n\n    [javac] *** Semantic Warning: The file\n\"/usr/java/jboss-3.0.6_tomcat-4.1.18/server/default/tmp/deploy/server/default/deploy/postgres-service.xml/15.postgres-service.xml\"\nis not a valid directory.\n\n\n    [javac] *** Semantic Warning: The file\n\"/usr/java/jboss-3.0.6_tomcat-4.1.18/server/default/tmp/deploy/server/default/deploy/hsqldb-service.xml/4.hsqldb-service.xml\"\nis not a valid directory.\n\n\n    [javac] *** Semantic Warning: The file\n\"/usr/java/jboss-3.0.6_tomcat-4.1.18/server/default/tmp/deploy/server/default/deploy/jca-service.xml/7.jca-service.xml\"\nis not a valid directory.\n\n\n    [javac] *** Semantic Warning: The file\n\"/usr/java/jboss-3.0.6_tomcat-4.1.18/server/default/tmp/deploy/server/default/deploy/scheduler-service.xml/12.scheduler-service.xml\"\nis not a valid directory.\n\n\n    [javac] *** Semantic Warning: The file\n\"/usr/java/jboss-3.0.6_tomcat-4.1.18/server/default/tmp/deploy/server/default/deploy/jbossmq-service.xml/6.jbossmq-service.xml\"\nis not a valid directory.\n\n\n    [javac] *** Semantic Warning: The file\n\"/usr/java/jboss-3.0.6_tomcat-4.1.18/server/default/tmp/deploy/server/default/deploy/counter-service.xml/3.counter-service.xml\"\nis not a valid directory.\n\n\n    [javac] *** Semantic Warning: The file\n\"/usr/java/jboss-3.0.6_tomcat-4.1.18/server/default/tmp/deploy/server/default/deploy/schedule-manager-service.xml/11.schedule-manager-service.xml\"\nis not a valid directory.\n\n\n    [javac] *** Semantic Warning: The file\n\"/usr/java/jboss-3.0.6_tomcat-4.1.18/server/default/tmp/deploy/server/default/deploy/jms-service.xml/8.jms-service.xml\"\nis not a valid directory.\n\n\n    [javac] *** Semantic Warning: The file\n\"/usr/java/jboss-3.0.6_tomcat-4.1.18/server/default/tmp/deploy/server/default/deploy/tomcat41-service.xml/13.tomcat41-service.xml\"\nis not a valid directory.\n\n\n    [javac] *** Semantic Warning: The file\n\"/usr/java/jboss-3.0.6_tomcat-4.1.18/server/default/tmp/deploy/server/default/deploy/jbossmq-destinations-service.xml/5.jbossmq-destinations-service.xml\"\nis not a valid directory.\n\n    [javac] Found 1 semantic error compiling\n\"/usr/java/eclipse/deploy2/WebShop.war/WEB-INF/lib/GenerelTagLibs.jar/dk/webedge/web/taglib/design/list(ListTag.java)\":\n\n    [javac]         <----------------------------------------\n    [javac]     21. public class ListTag extends TagSupport {\n    [javac]    . . .\n    [javac]    221. }\n    [javac]         >\n    [javac] *** Semantic Error: Unable to write file\n\"/usr/java/eclipse/deploy2/WebShop.war/WEB-INF/lib/GenerelTagLibs.jar/dk/webedge/web/taglib/design/ListTag.class\".\n\n    [javac] Found 1 semantic error compiling\n\"/usr/java/eclipse/deploy2/WebShop.war/WEB-INF/lib/GenerelTagLibs.jar/dk/webedge/web/taglib/design/list(ListRowTag.java)\":\n\n    [javac]         <-------------------------------------------\n    [javac]     21. public class ListRowTag extends TagSupport {\n    [javac]    . . .\n    [javac]     61. }\n    [javac]         >\n    [javac] *** Semantic Error: Unable to write file\n\"/usr/java/eclipse/deploy2/WebShop.war/WEB-INF/lib/GenerelTagLibs.jar/dk/webedge/web/taglib/design/ListRowTag.class\".\n\n    [javac] Found 1 semantic error compiling\n\"/usr/java/eclipse/deploy2/WebShop.war/WEB-INF/lib/GenerelTagLibs.jar/dk/webedge/web/taglib/design/list(ListColumnTag.java)\":\n\n    [javac]         <--------------------------------------------------\n    [javac]     21. public class ListColumnTag extends BodyTagSupport {\n    [javac]    . . .\n    [javac]     64. }\n    [javac]         >\n    [javac] *** Semantic Error: Unable to write file\n\"/usr/java/eclipse/deploy2/WebShop.war/WEB-INF/lib/GenerelTagLibs.jar/dk/webedge/web/taglib/design/ListColumnTag.class\".\n\n    [javac] Found 1 semantic error compiling\n\"/usr/java/eclipse/deploy2/WebShop.war/WEB-INF/lib/GenerelTagLibs.jar/dk/webedge/web/taglib/design(CommonTagUtils.java)\":\n\n    [javac]         <----------------------------\n    [javac]     18. public class CommonTagUtils {\n    [javac]    . . .\n    [javac]    161. }\n    [javac]         >\n    [javac] *** Semantic Error: Unable to write file\n\"/usr/java/eclipse/deploy2/WebShop.war/WEB-INF/lib/GenerelTagLibs.jar/dk/webedge/web/taglib/CommonTagUtils.class\".\n\n\tat\norg.apache.jasper.compiler.DefaultErrorHandler.javacError(DefaultErrorHandler.java:130)\n\tat org.apache.jasper.compiler.ErrorDispatcher.javacError(ErrorDispatcher.java:293)\n\tat org.apache.jasper.compiler.Compiler.generateClass(Compiler.java:340)\n\tat org.apache.jasper.compiler.Compiler.compile(Compiler.java:352)\n\tat org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:474)\n\tat org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:184)\n\tat org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:295)\n\tat org.apache.jasper.servlet.JspServlet.service(JspServlet.java:241)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat\norg.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)\n\tat\norg.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:432)\n\tat\norg.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:356)\n\tat org.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1058)\n\tat\norg.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:451)\n\tat\norg.apache.struts.action.RequestProcessor.processActionForward(RequestProcessor.java:401)\n\tat org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:279)\n\tat org.apache.struts.action.ActionServlet.process(ActionServlet.java:1420)\n\tat org.apache.struts.action.ActionServlet.doGet(ActionServlet.java:502)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:740)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:247)\n\tat\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)\n\tat\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:260)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat org.apache.catalina.valves.CertificatesValve.invoke(CertificatesValve.java:246)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardContext.invoke(StandardContext.java:2415)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:180)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat\norg.apache.catalina.valves.ErrorDispatcherValve.invoke(ErrorDispatcherValve.java:170)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:172)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)\n\tat org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:509)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:174)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.coyote.tomcat4.CoyoteAdapter.service(CoyoteAdapter.java:223)\n\tat org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:432)\n\tat\norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:386)\n\tat org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:534)\n\tat\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:530)\n\tat java.lang.Thread.run(Thread.java:536)"}, {"count": 1, "tags": [], "text": "Errrr, this is too hard to debug. The problem might come from the JB\nintegration, which might not be too compatible with Jikes. Also, Jikes is used\nthrough Ant, so overall, I don't think we're looking at a TC issue.", "attachment_id": null, "bug_id": 18203, "id": 35875, "time": "2003-04-23T10:56:48Z", "creator": "remm@apache.org", "creation_time": "2003-04-23T10:56:48Z", "is_private": false}, {"count": 2, "tags": [], "creator": "err@webedge.dk", "text": "The component that gives Jikes the destination directory to write the compiled\nclasses to is giving it the wrong path (invalid path), looks at this (excerpt\nfrom the original mail):\n\n    [javac] *** Semantic Error: Unable to write file\n\"/usr/java/eclipse/deploy2/WebShop.war/WEB-INF/lib/GenerelTagLibs.jar/dk/webedge/web/taglib/design/ListTag.class\".\n\nJikes is being instructed to write a class file, where the original file is\ninside a jar file, to a directory which seems to include the jar filename\nitself. Shouldn't Jikes be instructed to write the classfile to some kind of\nwork-area?\n\nMy guess would be, that Tomcat tells (wheter through Ant or not) Jikes where to\nstick the compiled files?", "id": 36020, "time": "2003-04-24T20:22:58Z", "bug_id": 18203, "creation_time": "2003-04-24T20:22:58Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 18203, "attachment_id": null, "is_private": false, "id": 55786, "time": "2004-04-14T20:45:59Z", "creator": "markt@apache.org", "creation_time": "2004-04-14T20:45:59Z", "text": "You are right about the path being the problem. On closer inspection it looks \nlike something is trying to compile the tag library. Clearly this shouldn't \nhappen.\n\nWithout a reproducible test case this is going to be impossible to track down. \nDo you see this with the latest JBoss / Tomcat bundle?\nDo you see this if you don't use Jikes?\n\nI'll leave this open for now but without a test case this will eventually \nbecome a WONTFIX."}, {"count": 4, "tags": [], "bug_id": 18203, "text": "I've made an example war that provokes the error consistently (check the\nattached JikesTestCaseWeb.war).\n\nTo run it, deploy the war and hit:\n\nhttp://localhost:8080/JikesTestCaseWeb/index.jsp\n\nThis reproduces the error for me. I've setup Jikes using the instructions in the\nTomcat docs. The init params are:\n\n<init-param>\n  <param-name>compiler</param-name>\n  <param-value>jikes</param-value>\n</init-param>\n<init-param>\n  <param-name>javaEncoding</param-name>\n  <param-value>ISO-8859-1</param-value>\n</init-param>\n\nAnd I've set the JVM param: -Dbuild.compiler.emacs=true\n\nSpecs for my system are (updated since original posting):\nOS: Fedora Core 1 Linux (kernel 2.4.22-1.2174.nptl)\nJDK: Sun 1.4.2_04\nJikes: 1.2.0\nJboss: 3.2.3\nTomcat: 4.1.29 (integrated in JBoss)\n", "id": 56739, "attachment_id": null, "creator": "err@webedge.dk", "creation_time": "2004-05-03T09:56:32Z", "time": "2004-05-03T09:56:32Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 18203, "attachment_id": 11411, "text": "Created attachment 11411\nWAR to provoke Jikes compilation error with jar'ed taglib.", "id": 56740, "time": "2004-05-03T09:57:31Z", "creator": "err@webedge.dk", "creation_time": "2004-05-03T09:57:31Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 18203, "is_private": false, "id": 56741, "attachment_id": null, "creator": "err@webedge.dk", "creation_time": "2004-05-03T09:58:37Z", "time": "2004-05-03T09:58:37Z", "text": "Oh, and by the way.. The example runs fine without Jikes as the JSP compiler."}, {"count": 7, "tags": [], "bug_id": 18203, "attachment_id": null, "id": 60942, "creation_time": "2004-07-21T22:59:04Z", "time": "2004-07-21T22:59:04Z", "creator": "markt@apache.org", "text": "Thanks for the test case. It makes tracking this sort of problem down so much \neasier. One day all bug reports will be like this ;)\n\nThis problem occurs running TC4 standalone without JBoss.\n\nThe cause of the problem is that your taglib includes a source file. After \ndeleting the source file from the taglib jar, no compilation errors are seen. \nAFAICT jikes spots the dependency between the JSP and the taglib but doesn't \nrealise that it can't re-compile a source file within an archive. Therefore I \nthink the problem is with Jikes although it might be that the Ant task isn't \nsetting a compilier option but I can't see obvious options that Ant doesn't \nset that might fix this. (I had a quick look at +F but it didn't help).\n\nI am therefore resolving this as INVALID as the problem lies outside the \nTomcat codebase.", "is_private": false}]