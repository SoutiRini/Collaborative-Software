[{"count": 0, "tags": [], "bug_id": 37058, "attachment_id": null, "text": "Variable \"protected\" in class Sheet can be null when HSSFSheet.isProtected() \nis called.  Because there is no error detection around this call stack, an \nerror can be generated.\n\nA resolution is is to add the line\n\nif (protect == null) protect = (ProtectRecord)createProtect();\n\nbefore the return statement in Sheet.isProtected() though I don't know if this \nis valid.", "id": 81068, "time": "2005-10-12T21:03:30Z", "creator": "bill.seddon@lyquidity.com", "creation_time": "2005-10-12T21:03:30Z", "is_private": false}, {"count": 1, "tags": [], "creator": "jheight@apache.org", "text": "HSSFSheet.getProtected is the call.\n\nSheet.getProtected (which returns the ProtectedRecord) will now create and add\nthe ProtectedRecord to the list of records for the Sheet.\n\nCommitted in SVN.\n\nJason", "id": 84579, "time": "2006-01-13T03:21:37Z", "bug_id": 37058, "creation_time": "2006-01-13T03:21:37Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "josh@apache.org", "attachment_id": null, "id": 116462, "time": "2008-05-10T19:52:56Z", "bug_id": 37058, "creation_time": "2008-05-10T19:52:56Z", "is_private": false, "text": "*** Bug 27749 has been marked as a duplicate of this bug. ***"}, {"count": 3, "tags": [], "creator": "josh@apache.org", "attachment_id": null, "id": 127954, "time": "2009-06-15T13:09:38Z", "bug_id": 37058, "creation_time": "2009-06-15T13:09:38Z", "is_private": false, "text": "Original fix was in svn r368554\n\n\nFollow-up info:\n\nOriginal test code (from bug 27749) is no longer valid:\n\n    HSSFSheet sheet = workBook.cloneSheet(index);\n    sheet.setProtect(true);\n\n\nThe method HSSFSheet.setProtect(boolean) was deprecated (svn r552425 ) because it didn't set a password hash.  As of the fix for bug 47363 (svn r784240 ), the deprecated method was removed.\n\nThe test code for this problem would now look like this:\n\n    HSSFSheet sheet = workBook.cloneSheet(index);\n    sheet.protectSheet(\"secret\");\n\nThis still works OK in svn trunk"}]