[{"count": 0, "tags": [], "bug_id": 54392, "text": "java version \"1.6.0_31\"\nJava(TM) SE Runtime Environment (build 1.6.0_31-b05)\npoi version: poi-3.9-20121203.jar\nplatform: windows xp \n\n\n------------ source to reproduce is very simple:\nString s = \"excelfile.xls\";\nFileInputStream fis = new FileInputStream(file);\nworkbook = new HSSFWorkbook (fis);\n\nand then it would trigger this. \nit would be nice if it can be fixed. or at least with an extra constructor boolean to disable this check & throw. \n\n                    // Some tools (like Perl module Spreadsheet::WriteExcel - bug 41187) skip the RowRecords\n                    // Excel, OpenOffice.org and GoogleDocs are all OK with this, so POI should be too.\n                    if (rowRecordsAlreadyPresent) {\n                        // if at least one row record is present, all should be present.\n                        throw new RuntimeException(\"Unexpected missing row when some rows already present\");\n                    }\n\nSince I am very eager to use poi for this excel file, I disabled this throw statement and the rest of the parising can run perfectly fine. \n\n\n------------ Exception:\nError initializing Excel File:Unexpected missing row when some rows already present\njava.lang.RuntimeException: Unexpected missing row when some rows already present\n        at org.apache.poi.hssf.usermodel.HSSFSheet.setPropertiesFromSheet(HSSFSheet.java:195)\n        at org.apache.poi.hssf.usermodel.HSSFSheet.<init>(HSSFSheet.java:120)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:292)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:243)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:187)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:322)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:303)", "id": 164516, "time": "2013-01-09T10:38:32Z", "creator": "steveoreo@gmail.com", "creation_time": "2013-01-09T10:38:32Z", "is_private": false, "attachment_id": null}, {"count": 1, "attachment_id": null, "bug_id": 54392, "is_private": false, "id": 164517, "time": "2013-01-09T10:55:42Z", "creator": "apache@gagravarr.org", "creation_time": "2013-01-09T10:55:42Z", "tags": [], "text": "Where did the problematic file come from? If you try opening the file in excel and doing a save-as, does that fix it?"}, {"count": 2, "tags": [], "bug_id": 54392, "text": "Created attachment 29831\nthe excel file to reproduce", "id": 164525, "time": "2013-01-09T13:57:05Z", "creator": "steveoreo@gmail.com", "creation_time": "2013-01-09T13:57:05Z", "is_private": false, "attachment_id": 29831}, {"attachment_id": null, "tags": [], "bug_id": 54392, "text": "The file is coming from internet web site. \nI grep it and try to use poi to parse. \nI attached in the bugzilla for your reference (sorry I missed it before). \nthanks for your prompt response!", "count": 3, "id": 164526, "time": "2013-01-09T13:58:45Z", "creator": "steveoreo@gmail.com", "creation_time": "2013-01-09T13:58:45Z", "is_private": false}, {"count": 4, "tags": [], "creator": "apache@gagravarr.org", "is_private": false, "text": "I've just tried the attached file with 3.10 Final, and it opens without error", "id": 176660, "time": "2014-07-24T16:09:23Z", "bug_id": 54392, "creation_time": "2014-07-24T16:09:23Z", "attachment_id": null}, {"count": 5, "attachment_id": null, "bug_id": 54392, "is_private": false, "id": 188686, "time": "2016-02-22T18:04:50Z", "creator": "pedro.t.garcia@gmail.com", "creation_time": "2016-02-22T18:04:50Z", "tags": [], "text": "This looks like an exact duplicate of bug 47245 and bug 49312\n\nPlease, correct me if I'm wrong."}, {"count": 6, "tags": [], "creator": "pedro.t.garcia@gmail.com", "is_private": false, "text": "I've just tried the attached file with 3.10-FINAL, and the error is still there.\nI've just tried the attached file with 3.13, and the error is still there.\nI've just tried the attached file with 3.14-beta1, and the error is still there.\n\nIt's been several years now and the workaround suggested in the bug 47245 still works without side effects. Despite the comments in the source code suggesting to remove the exception altogether this bug still persists, and I can't really understand why.\n\nIt would be great if someone with more knowledge would take a little minute to explain why this exception has to be thrown.", "id": 188700, "time": "2016-02-23T10:05:33Z", "bug_id": 54392, "creation_time": "2016-02-23T10:05:33Z", "attachment_id": null}, {"count": 7, "tags": [], "text": "There is still an open bug-report where further discussion of this should take place, so no need to have this open as well. It seems the origins of the code are somewhat lost in time, so the best chance of moving it along is probably to research why the code was built this way originally and comment in the open bug item.\n\n*** This bug has been marked as a duplicate of bug 47245 ***", "is_private": false, "id": 188710, "creator": "dominik.stadler@gmx.at", "time": "2016-02-23T13:36:07Z", "bug_id": 54392, "creation_time": "2016-02-23T13:36:07Z", "attachment_id": null}]