[{"count": 0, "tags": [], "bug_id": 17830, "attachment_id": null, "text": "I use two markers in a fo:table to retrieve sums that should be place in the \npage header (region-before) and footer (region-end).\n\n<for each account position ...>\n  <table-row keep-together=\"always\" keep-together.within-page=\"always\">\n   <fo:table-cell>\n\t   <fo:block text-align=\"center\" >\t\t\t\t\n\t\t\t\t\n\t<!-- \tMarker\t\t-->\n\t<fo:marker marker-class-name=\"subtotalvalue\"> \n\t\t<xsl:call-template name=\"soll_haben\">\n\t\t<xsl:with-param name=\"text\">\u00dcbertrag</xsl:with-param> \n\t\t<xsl:with-param name=\"amount\">\n\t\t\t<xsl:choose>\n\t\t\t\t<xsl:when test=\"A_AMOUNT!=''\">\n\t\t\t\t<xsl:value-of \nselect=\"/ACCOUNTDOCUMENT/ACCOUNTSTATEMENT/TOTALSANDLIMITS/@A_SBALANCE+A_AMOUNT+s\num(preceding::A_AMOUNT[.!=''])\"/>\n\t\t\t\t</xsl:when>\n\t\t\t\t<xsl:otherwise>\n\t\t\t\t<xsl:value-of \nselect=\"/ACCOUNTDOCUMENT/ACCOUNTSTATEMENT/TOTALSANDLIMITS/@A_SBALANCE + sum\n(preceding::A_AMOUNT[.!= ''])\"/>\n\t\t\t\t</xsl:otherwise>\n\t\t\t</xsl:choose>\n\t\t</xsl:with-param>\n\t\t<xsl:with-param name=\"currency\" \nselect=\"/ACCOUNTDOCUMENT/ACCOUNTSTATEMENT/ACCOUNTHEADER/@CURRENCY\"/>\n\t\t</xsl:call-template>\n\t</fo:marker>   \t\t\n\n\t<fo:marker marker-class-name=\"subtotalvalueEx\"> \n\t\t<xsl:call-template name=\"soll_haben\">\n\t\t<xsl:with-param name=\"text\">\u00dcbertrag</xsl:with-param> \n\t\t<xsl:with-param name=\"amount\">\n\t\t\t<xsl:value-of \nselect=\"/ACCOUNTDOCUMENT/ACCOUNTSTATEMENT/TOTALSANDLIMITS/@A_SBALANCE + sum\n(preceding::A_AMOUNT[.!= ''])\"/>\n\t\t</xsl:with-param>\n\t\t<xsl:with-param name=\"currency\" \nselect=\"/ACCOUNTDOCUMENT/ACCOUNTSTATEMENT/ACCOUNTHEADER/@CURRENCY\"/>\n\t\t</xsl:call-template>\n   </fo:marker>\t\t\t\t\t\n\n\t... other output like A_AMOUNT ...\n\n\nTo get the sum for the footer:\n<fo:retrieve-marker retrieve-class-name=\"subtotalvalue\" \n  retrieve-boundary=\"page\"\n  retrieve-position=\"last-starting-within-page\"/>         \n\nTo get the sum for the header :\n<fo:retrieve-marker retrieve-class-name=\"subtotalvalueEx\" \n  retrieve-boundary=\"page\" \n  retrieve-position=\"first-starting-within-page\"/>\t\n\nSome accountpositions have payment-notes, that are added as additional table-\nrows :\n <fo:table-row>\n  <xsl:attribute name=\"keep-with-previous.within-page\">always</xsl:attribute> \n  <xsl:attribute name=\"keep-with-previous\">always</xsl:attribute> \n\t... payment - note ...\n\n\nWhat happened is that FOP keeps blocks correctly together. (Accountposition and \npayment-notes should not be on separate pages)\nBut <fo:retrieve-marker> sometimes fetches wrong values (from previous / \nfollowing lines).\nAs a result the sum on a page and their following may differ.\n\nIs that behavior a ( known ) mistake ?\n\nRegards \n\tJoachim Unger", "id": 32863, "time": "2003-03-10T15:47:47Z", "creator": "joachim.unger@softwareag.com", "creation_time": "2003-03-10T15:47:47Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 17830, "text": "\n\n*** This bug has been marked as a duplicate of 16999 ***", "id": 32894, "time": "2003-03-10T23:34:54Z", "creator": "j3322ptm@yahoo.de", "creation_time": "2003-03-10T23:34:54Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "gadams@apache.org", "attachment_id": null, "id": 156590, "time": "2012-04-01T13:50:14Z", "bug_id": 17830, "creation_time": "2012-04-01T13:50:14Z", "is_private": false, "text": "batch transition to closed remaining pre-FOP1.0 resolved bugs"}]