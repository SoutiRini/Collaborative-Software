[{"count": 0, "tags": [], "bug_id": 20151, "text": "when you do \n  Parameters_object.recycle(); it clears paramHashStringArray, so there suposed\nto be no params, but after\n  Parameters_object.processParameters(\"par1=a\"); there will be old params from\nqueryMB and new params.\nIt works correctly if queryMB.recycle(); is added in\norg.apache.tomcat.util.http.Parameters.recycle();\n\nThanks", "id": 37596, "time": "2003-05-22T14:47:18Z", "creator": "a271278@fmr.com", "creation_time": "2003-05-22T14:47:18Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "is_private": false, "id": 37602, "time": "2003-05-22T15:31:29Z", "bug_id": 20151, "creation_time": "2003-05-22T15:31:29Z", "text": "Does that pose an actual problem of any kind, or is this only a theorical bug ?\nParameters are recycled at the end of the processing of the request, and so is\nthe queryMB (at least that's the theory). Coupling the lifecycle of the two\nobjects is not that great an idea IMO, so I'm WONTFIX unless you can submit a\ncase where there's bad behavior."}, {"count": 2, "tags": [], "bug_id": 20151, "text": "I have a need to restore parameters of a previous request exactly as they were.\n( A request is being redirected to a login page and then we have to continue \nprevious transaction after logging in :\n\nUser clicks /getInfo?aaa=a -> redirect to login.jsp -> clicks\n/login?user=blah-blah&passwd=...&somestuff=... -> gotta redirect to /getInfo?aaa=a\n\n   )\nWe got a huge library we have to use and part of it is validation of the\nparameters for every transaction. So, I need to remove all parameters from the\nrequest and put saved ones back.\n\nI had to add a method in org.apache.coyote.tomcat4.CoyoteRequestFacade to get\naccess to protected member \"request\":\n public CoyoteRequest getRequest()\n    { return this.request;\n    }\n\nThen I access Parameters object:\norg.apache.tomcat.util.http.Parameters\np=((CoyoteRequestFacade)p_Request).getRequest().getCoyoteRequest().getParameters();\n\nand, finally:\np.recycle(); // to get rid of name=blah-blah&passwd=...&somestuff=...\np.processParameters((String)storedParameters);\njavax.servlet.RequestDispatcher rd =\nm_ServletContext.getRequestDispatcher((String)storedUrl);\nrd.forward(p_Request, p_Response);\n\n\nwithout queryMB.recycle()\nit redirects to  /getInfo?aaa=a&user=blah-blah&passwd=...&somestuff=... :(\n\nif I try  p.setQuery(MessageBytes.newInstance()); instead of p.recycle();\nit works twice and then it stops processing url params.", "id": 37621, "time": "2003-05-22T17:23:48Z", "creator": "a271278@fmr.com", "creation_time": "2003-05-22T17:23:48Z", "is_private": false, "attachment_id": null}]