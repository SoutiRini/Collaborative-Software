[{"attachment_id": null, "tags": [], "bug_id": 13609, "text": "In Apache 2.0.40, there was a change in the bin/apachectl file which added the\nfollwoing line:\n\nULIMIT_MAX_FILES=\"ulimit -S -n `ulimit -H -n`\"\n\nI tried to build Apache 2.0.42 and 2.0.43, and both had the same problem in that\nthis statement did not run.  Specifically, as root, I could not issue the\ncommand:\n\nulimit -H -n\n\nThis is not a legitimate Bourne shell command in Tru64 5.1 or 5.1A.  The\ncommand:\n\nulimit -h -n\n\ndoes do what I believe was desired, so I have modified my copy of apachectl to\nwork around the problem.  The man page for sh under Tru64 says that -H is used \nfor setting, not getting the hard ulimit.  I don't know if this is true for all\nunixes or just Tru64.  This looks to be generated by configure.\n\nThanks.  --Joe", "count": 0, "id": 24479, "time": "2002-10-14T15:37:59Z", "creator": "Joseph.Senulis@dnr.state.wi.us", "creation_time": "2002-10-14T15:37:59Z", "is_private": false}, {"count": 1, "tags": [], "creator": "trawick@apache.org", "text": "I'm a little confused at the symptom you saw.  I can see the ulimit command\nfail on Tru64 when using /bin/sh, but after the command fails at configure time\nI end up with this in apachectl, so apachectl doesn't try to do ulimit.\n\nULIMIT_MAX_FILES=\"\"\n\nAny ideas why we are seeing something different?", "id": 29393, "time": "2003-01-15T11:23:56Z", "bug_id": 13609, "creation_time": "2003-01-15T11:23:56Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "Joseph.Senulis@dnr.state.wi.us", "attachment_id": 4439, "id": 29437, "time": "2003-01-15T18:07:28Z", "bug_id": 13609, "creation_time": "2003-01-15T18:07:28Z", "is_private": false, "text": "Created attachment 4439\nconfiguration log which resulted in bad apachectl file"}, {"count": 3, "tags": [], "text": "I definitely got the following in apachectl:\n\nUMIMIT_MAX_FILES=\"ulimit -S -n `ulimit -H -n`\"\n\nI did not get any errors when running configure.  I have attached the\nconfiguration log from when I created this.  I will make some time to rerun\nconfigure with better logging to see if I can get better info.", "is_private": false, "id": 29439, "creator": "Joseph.Senulis@dnr.state.wi.us", "time": "2003-01-15T18:14:20Z", "bug_id": 13609, "creation_time": "2003-01-15T18:14:20Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "Joseph.Senulis@dnr.state.wi.us", "attachment_id": null, "id": 29551, "time": "2003-01-16T17:10:08Z", "bug_id": 13609, "creation_time": "2003-01-16T17:10:08Z", "is_private": false, "text": "OK, I'm confused too.  I rebuilt Apache and I still get the problem.  When I run\n/bin/sh by hand on that computer, I definitely get an error when I try to run\n\nulimit -H -n\n\nThe configure also is running /bin/sh, but the script did not get an error when\nexecuting the line \n\nif TMP_ULIMIT=`ulimit -H -n` && ulimit -S -n $TMP_ULIMIT ; then\n\nand as a result does not set APACHECTL_ULIMIT to null.  When I try running this\ncode fragment by hand I get an error.  I will attach config.log and\nconfig.status.  I also piped stdout and stderr from the configure into\nconfigure.log.  I will keep checking here to see what I can find, but any\nsuggestions would be appreciated.\n"}, {"count": 5, "tags": [], "text": "Created attachment 4466\nconfig.log from rebuild", "attachment_id": 4466, "id": 29552, "creator": "Joseph.Senulis@dnr.state.wi.us", "time": "2003-01-16T17:12:39Z", "bug_id": 13609, "creation_time": "2003-01-16T17:12:39Z", "is_private": false}, {"attachment_id": 4467, "tags": [], "bug_id": 13609, "text": "Created attachment 4467\nconfig.status from rebuild", "count": 6, "id": 29554, "time": "2003-01-16T17:32:38Z", "creator": "Joseph.Senulis@dnr.state.wi.us", "creation_time": "2003-01-16T17:32:38Z", "is_private": false}, {"attachment_id": 4468, "tags": [], "bug_id": 13609, "text": "Created attachment 4468\nstdout and stderr from configure, with set -v -x added at start", "count": 7, "id": 29555, "time": "2003-01-16T17:34:13Z", "creator": "Joseph.Senulis@dnr.state.wi.us", "creation_time": "2003-01-16T17:34:13Z", "is_private": false}, {"count": 8, "tags": [], "creator": "trawick@apache.org", "text": "Regardless of why configure fails to realize that the standard ulimit command\nwon't work on your box yet configure does realize it won't work on my box,\nthe fix is the same: check for Tru64 and substitute the right command rather\nthan trying the default.\n\nThe fix has been committed to Apache 2.1 development tree.  If nobody complains \nabout the change, I'll ask for it to be considered for merging into Apache \n2.0.45.\n\nThanks for your report/debug assistance, and thanks for using Apache!\n", "id": 29606, "time": "2003-01-17T14:51:00Z", "bug_id": 13609, "creation_time": "2003-01-17T14:51:00Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 13609, "text": "I have done some more poking about.  The configure script changes the shell \nfrom Bourne to Korn, in (I believe) the line:\n\nexec \"$CONFIG_SHELL\" \"$0\" ${1+\"$@\"}\n\nwhich restarts the script using the Korn shell.  At that point, it eventually \ngets to the line:\n\nif TMP_ULIMIT=`ulimit -H -n` && ulimit -S -n $TMP_ULIMIT ; then\n\nand is still running the Korn shell.  The argument `ulimit -H -n` is perfectly \nvalid in T64 Korn shell, so the configure script would not assign null to \nAPACHECTL_ULIMIT.  What I don't understand is why you were seeing differently.  \nPresumably, when you tested this, configure did not restart itself with the \nKorn Shell?  In any event, there is a discrepancy between T64 ksh and sh, in \nthat -H is valid in ksh, but -h should be used in sh.\n", "id": 29820, "time": "2003-01-21T22:26:27Z", "creator": "Joseph.Senulis@dnr.state.wi.us", "creation_time": "2003-01-21T22:26:27Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "text": "*** Bug 16415 has been marked as a duplicate of this bug. ***", "attachment_id": null, "id": 30046, "creator": "trawick@apache.org", "time": "2003-01-25T15:07:29Z", "bug_id": 13609, "creation_time": "2003-01-25T15:07:29Z", "is_private": false}]