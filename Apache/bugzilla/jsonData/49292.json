[{"count": 0, "tags": [], "text": "Created attachment 25438\nSnapshot shows large entries in the Map\n\nHi,\n\nI got an OOM and Eclipse MAT shows a potential leak in the org.apache.taglibs.standard.lang.jstl.ELEvaluator.\n \nThere was a memory leak in this area and fixed via revision 580198 (Bug 31789 \nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=31789).  This fix has already been pulled into our standard.jar bundle.\n\nI use the default exprCacheSize which is 100.  So the LRUMap size would be expected to be max out at 100.  However, the heapdump during the OOM shows that there was 1.8 million entries in the map (screenshot is attached).\n\nIs there any potential or known issue in this LRUMap?\n\nThanks,", "attachment_id": 25438, "bug_id": 49292, "id": 136860, "time": "2010-05-14T10:52:23Z", "creator": "pmd1nh-rm@yahoo.com", "creation_time": "2010-05-14T10:52:23Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 49292, "attachment_id": null, "id": 136958, "time": "2010-05-19T11:27:00Z", "creator": "ruben.aguado@gmail.com", "creation_time": "2010-05-19T11:27:00Z", "is_private": false, "text": "Hi,\n\nAre you sure apply correctly the patch? These patch is must be apply not in root path, also in \\src\\org\\apache\\taglibs\\standard.\n\nAnd extra/collections package must be move to extra\\commons\\collections before running ant. (the patch is a little confusing).\n\nCould you attach a memory snapshot for all direct ELEvaluator childrens?"}, {"count": 2, "tags": [], "creator": "ruben.aguado@gmail.com", "attachment_id": 25456, "id": 136959, "time": "2010-05-19T11:35:08Z", "bug_id": 49292, "creation_time": "2010-05-19T11:35:08Z", "is_private": false, "text": "Created attachment 25456\nstandard.1.0.6 patched for j2se 1.4\n\nAttached the standard.jar with the patch"}, {"count": 3, "tags": [], "bug_id": 49292, "attachment_id": 25458, "id": 136967, "time": "2010-05-19T16:26:08Z", "creator": "pmd1nh-rm@yahoo.com", "creation_time": "2010-05-19T16:26:08Z", "is_private": false, "text": "Created attachment 25458\nsnapshot of ELEvaluator direct children"}, {"count": 4, "tags": [], "text": "Hi,\n\nYes, I'm sure that the patch has been applied correctly.  I have also downloaded your attachment of standard-1.0.6, decompiled, and compared with ours.  They are same (from the main fixes in lang.jstl.ELEvaluator and Evaluator to the extra files in extra.commons.collections.*).  I attached the snapshot of ELEvaluator's direct children\n\nThanks!", "is_private": false, "id": 136968, "creator": "pmd1nh-rm@yahoo.com", "time": "2010-05-19T16:27:28Z", "bug_id": 49292, "creation_time": "2010-05-19T16:27:28Z", "attachment_id": null}, {"count": 5, "tags": [], "text": "Hi again,\n\nI just have tested the jar and seems to work correctly. \n\nSorry, but your jar seems not to be correctly. In your first snapshot you can see these:\n\n - ELEvaluator\n    - Colletions\n        -HashMap\n            -.... lots of HashMap\n\nIn my snapshot I attach today, yo can see:\n\n  - ELEvaluator\n    - Colletions\n        -LRUMap\n            - AbstractHasedMap\n            - 79 AbstractLinkedMap\n\n\nSo you are using the old ELEvaluator. Be sure your ELEvaluator are in:\n\n org\\apache\\taglibs\\standard\\lang\\jstl\n\nand not in:\n\n standard\\lang\\jstl\n\nOr if you prefer, test my jar file.", "attachment_id": null, "id": 136975, "creator": "ruben.aguado@gmail.com", "time": "2010-05-20T05:35:34Z", "bug_id": 49292, "creation_time": "2010-05-20T05:35:34Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 49292, "is_private": false, "text": "Created attachment 25461\nsnapshot new ELEvaluator", "id": 136976, "time": "2010-05-20T05:38:46Z", "creator": "ruben.aguado@gmail.com", "creation_time": "2010-05-20T05:38:46Z", "attachment_id": 25461}, {"count": 7, "tags": [], "creator": "pmd1nh-rm@yahoo.com", "attachment_id": null, "is_private": false, "id": 136993, "time": "2010-05-20T13:10:05Z", "bug_id": 49292, "creation_time": "2010-05-20T13:10:05Z", "text": "Hi,\n\nCan you please share the application/JSP source that you used to test this?  I don't have a test case for this as the dump was sent in by one of our customers. \n\nThank you for your help!"}, {"count": 8, "tags": [], "bug_id": 49292, "is_private": false, "text": "Sorry, I dont have any test case. I tested it in our aplication.", "id": 137009, "time": "2010-05-21T05:31:15Z", "creator": "ruben.aguado@gmail.com", "creation_time": "2010-05-21T05:31:15Z", "attachment_id": null}, {"count": 9, "text": "Noting that we just dropped the LRUMap code in trunk and replaced it with a JDK 1.5 class (LinkedHashMap). \n\nLooking at the comments, it looks as though the issue was resolved as a no-issue? Patch not applied on jar?\n\nIf still an issue, retrying with trunk (JSTL 1.2) would be valuable. Let me know if you need a build uploaded.", "bug_id": 49292, "is_private": false, "id": 137964, "time": "2010-06-29T03:44:14Z", "creator": "bayard@apache.org", "creation_time": "2010-06-29T03:44:14Z", "tags": [], "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 49292, "attachment_id": null, "id": 137989, "time": "2010-06-29T10:47:28Z", "creator": "pmd1nh-rm@yahoo.com", "creation_time": "2010-06-29T10:47:28Z", "is_private": false, "text": "Hi,\n\nUser's app overwrites our jar and causes this issue.\n\nPlease close down this thread.  Thank you very much for your help!\n\nRegards,"}, {"count": 11, "tags": [], "bug_id": 49292, "is_private": false, "text": "Resolving as per comment 10 this appears to be a user issue", "id": 140686, "time": "2010-10-11T22:58:22Z", "creator": "jboynes@apache.org", "creation_time": "2010-10-11T22:58:22Z", "attachment_id": null}]