[{"count": 0, "tags": [], "creator": "nbaraka@wp.pl", "text": "Rewriting empty sheets using poi doesn't produce almost any effect on modified\nsheet. It means there are no values inserted, no styles applied to cells. Only\nthing I can actually see in Excel are merged regions, and it means worksheet is\nbeing really modified.\nWay to reproduce:\n1) Create empty Excel document (don't change anything),\n2) Save to input.xls,\n3) Compile and run this code:\n\nimport org.apache.poi.hssf.usermodel.*;\nimport org.apache.poi.poifs.filesystem.*;\nimport org.apache.poi.hssf.util.*;\nimport java.io.*;\n\npublic class Test2\n{\n\tpublic static void main(String[] args)\n\t{\n\t\ttry {\n\t\t\tHSSFWorkbook workBook = new HSSFWorkbook(new POIFSFileSystem(new\nFileInputStream(\"input.xls\")), true);\n\t\t\tHSSFSheet sheet = workBook.getSheetAt(0);\n\t\t\tHSSFRow row = sheet.createRow((short) 0);\n\t\t\tif (row == null)\n\t\t\t\trow = sheet.createRow((short) 0);\n\t\t\tHSSFCell tmpCell = row.getCell((short) 0);\n\t\t\tif (tmpCell == null)\n\t\t\t\ttmpCell = row.createCell((short)0);\n\n\t\t\ttmpCell.setCellType(HSSFCell.CELL_TYPE_STRING);\n\t\t\ttmpCell.setCellValue(\"XYZ\");\n\n\t\t\tsheet.addMergedRegion(new Region(1, (short) 0, 1, (short) 1));\n\n\t\t\tFileOutputStream fileOut = new FileOutputStream(\"output.xls\", false);\n\t\t\tworkBook.write(fileOut);\n\t\t\tfileOut.close();\n\t\t}\n\t\tcatch (Exception ex){\n\t\t\tex.printStackTrace();\n\t\t}\n\t}\n}\n\n3) Open output.xls\n\nYou see empty sheet (without 'XYZ' string in cell(0,0)) with one merged region.\n\nVersion of poi:  poi-1.9.0-dev-20021122\nVersion of os/excel: windows2000prof/excel2002 (polish version)\nVersion of jdk: sun jdk 1.3.1\nCompile command: javac -classpath \".\\jakarta-poi-1.9.0-dev-20021122.jar\"\nExecution command: java -classpath \".;.\\jakarta-poi-1.9.0-dev-20021122.jar\"\n\nAdditional information:\nThere is simple workaround for this problem. Modify sheet in Excel putting (for\nexample) one space into cell(0,0).", "id": 26944, "time": "2002-11-25T14:47:31Z", "bug_id": 14824, "creation_time": "2002-11-25T14:47:31Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 14824, "is_private": false, "count": 1, "id": 40945, "time": "2003-07-18T19:19:17Z", "creator": "tschafer@hotmail.com", "creation_time": "2003-07-18T19:19:17Z", "text": "I have seen the behavior of only merged cells, but no other changes\nshowing up in result.\n\nHowever starting with a modified spreadsheet doesn't work.\nMy original template (some text, and a graphic) has the same problem.\n\nIt's only because I wanted a simple test case that I tried \nit with a blank sheet.\n\nsee bug 21066"}, {"count": 2, "attachment_id": null, "creator": "poi-support@buni.org", "is_private": false, "id": 41415, "time": "2003-07-24T17:01:12Z", "bug_id": 14824, "creation_time": "2003-07-24T17:01:12Z", "tags": [], "text": "*** Bug 21278 has been marked as a duplicate of this bug. ***"}, {"count": 3, "attachment_id": null, "creator": "glens@apache.org", "text": "I just committed something that may possibly fix your problem.  You can get a\njar from: http://www.apache.org/~glens/poi-20030921.jar", "id": 44395, "time": "2003-09-21T11:20:34Z", "bug_id": 14824, "creation_time": "2003-09-21T11:20:34Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 14824, "text": "Confirming that your fix resolves the problem. However I haven't tested it with\nmore complex example, only with code listed above.\nAdditional note: output file is slightly smaller then input file (13312 bytes\ncomparing with original 13824 bytes).\n", "id": 44483, "time": "2003-09-23T06:32:36Z", "creator": "nbaraka@wp.pl", "creation_time": "2003-09-23T06:32:36Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "glens@apache.org", "is_private": false, "count": 5, "id": 45236, "time": "2003-10-08T08:34:24Z", "bug_id": 14824, "creation_time": "2003-10-08T08:34:24Z", "text": "If you find any further problems please reopen this bug."}]