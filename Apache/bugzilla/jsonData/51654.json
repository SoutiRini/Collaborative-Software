[{"count": 0, "tags": [], "bug_id": 51654, "text": "A hard-to-diagnose NullPointerException at startup which can be bettered with an appropriate error message:\n\nINFO: Starting Servlet Engine: Apache Tomcat/7.0.19\njava.lang.NullPointerException\nat org.apache.catalina.startup.HostConfig.filterAppPaths(HostConfig.java:493)\nat org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:466)\nat org.apache.catalina.startup.HostConfig.start(HostConfig.java:1322)\nat org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:311)\nat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\nat org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:89)\n\nOk, what's this about?\n\nIn \"protected String[] filterAppPaths(String[] unfilteredAppPaths)\"\nthe exception is raised at\n\n  for (String appPath : unfilteredAppPaths)\n\nWhich means the \"unfilteredAppPaths\" passed in is null. filterAppPaths does not check for that (shouldn't there be an assertion at least)\n\nThe problems comes from \"deployApps()\":\n\n    protected void deployApps() {\n\n        File appBase = appBase();\n        File configBase = configBase();\n        String[] filteredAppPaths = filterAppPaths(appBase.list()); <----\n        // Deploy XML descriptors from configBase\n        deployDescriptors(configBase, configBase.list());\n        // Deploy WARs, and loop if additional descriptors are found\n        deployWARs(appBase, filteredAppPaths);\n        // Deploy expanded folders\n        deployDirectories(appBase, filteredAppPaths);\n        \n    }\n\nWhere \"appBase.list()\" returns null. This must be because \"appBase\" does not actually denote a directory (A-HA!)\n\nIndeed, the server.xml points to a nonexisting appBase.\n\nSuggesting to add a check to \"deployApps\":\n\n    protected void deployApps() {\n\n        File appBase = appBase();\n        File configBase = configBase();\n\n        if (!appBase.exists() || appBase.list()==null) {\n            throw new IllegalArgumentException(\"The appBase \" + appBase + \" does not exist or cannot be listed\");\n        }\n\n        String[] filteredAppPaths = filterAppPaths(appBase.list()); <----\n        // Deploy XML descriptors from configBase\n        deployDescriptors(configBase, configBase.list());\n        // Deploy WARs, and loop if additional descriptors are found\n        deployWARs(appBase, filteredAppPaths);\n        // Deploy expanded folders\n        deployDirectories(appBase, filteredAppPaths);\n        \n    }\n\nThis probably violates some I18N requirement though.", "id": 148589, "attachment_id": null, "creator": "bughunt@gluino.name", "creation_time": "2011-08-12T10:36:54Z", "time": "2011-08-12T10:36:54Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 51654, "attachment_id": null, "text": "This has been fixed in trunk and 7.0.x and will be included in 7.0.21 onwards.\n\nThe fix logs an error message and disables automatic deployment if the appBase is not a directory.", "id": 148623, "time": "2011-08-15T18:59:04Z", "creator": "markt@apache.org", "creation_time": "2011-08-15T18:59:04Z", "is_private": false}]