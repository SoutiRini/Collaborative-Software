[{"count": 0, "tags": [], "text": "If a client sends a PUT message containing a content range field and an error \nis experienced while receiving the data, dav_method_put function will delete \nthe entire file.\n\nFor example if a client sends a request such as:\n\nPUT /davtest/1gb.txt HTTP/1.1\ncontent-range: bytes 1048576-2097151/*\nUser-Agent: FPDAV client/1.0\nHost: mars.tivlab.westford.ibm.com\nContent-Length: 1048576\nConnection: Keep-Alive\nAuthorization: Basic dXNlcjpwYXNzd29yZA==\n\nis sent by the client and a network error occurs during the receipt of the \nmessage body then the entire file is deleted before the dav_method_put\nreturns.\n\nI believe this behavior is wrong and dav_method_put should do one of the \nfollowing:\n1. leave the file the way it is even with the modifications.\n2. restore the file to the way it was before the modifications.\n\nAt the very least dav_method_put should not delete the file if the\nerror happened before any modifications are made to the file.\n\nI realize this way of using PUT is may not be clear in any specifications but\nsince Apache is making an attempt I would like to explore the possibility\nof making it more useful until a better means up updating byte ranges of a\nresource comes along.\n\nI am eager to discuss a short term and to discuss any future\ndirections Apache may take to accomplish this (such as implementing the PATCH\nmethod)", "is_private": false, "bug_id": 42896, "id": 105427, "time": "2007-07-14T17:59:06Z", "creator": "kstearns@us.ibm.com", "creation_time": "2007-07-14T17:59:06Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "jorton@redhat.com", "attachment_id": null, "id": 105720, "time": "2007-07-17T07:06:28Z", "bug_id": 42896, "creation_time": "2007-07-17T07:06:28Z", "is_private": false, "text": "See also bug 38148 - I do think this behaviour is undesirable and I can't see\nany reason why it's necessary, but I might be missing something.\n"}, {"count": 2, "tags": [], "text": "(In reply to comment #1)\n> See also bug 38148 - I do think this behaviour is undesirable and I can't see\n> any reason why it's necessary, but I might be missing something.\n\nI think people will come down on many different sides of this issue but I \nthink in the end everyone will agree that at least one change is necessary.\n\nOne reason for this change is:\n\nWhen a client is doing a PUT request without the content-range field they \nwould typically keep the entire contents of the file around until the server \nindicates success. So in this case a client has the entire contents of the \nfile and can easily provide it to the server again to restart after an error.\nIt does not matter in this case if the server deletes the file after an error.\n\nThis is not necessarily true for a client using the content-range field. So \nafter the server experiences the error and deletes the file the client may not \nbe able to reproduce the file.\n\nThe client is asking for a portion of the file to be changed so if an error \nhappens during the transmission of that request the dav_method_put  function \nshould restore the file back the way it was (or do nothing which is really all \nI personally would require). For a PUT that does not contain the content-range \nthis would mean deleting the file. But for a PUT that does contain the content-\nrange deleting the file does much more than undoes what the request was \nattempting to do.\n\nAlso, I think the differentiating factor between this and the bug 38148 is the \npresence of the content-range field. They can be addressed independentally.", "is_private": false, "id": 105721, "creator": "kstearns@us.ibm.com", "time": "2007-07-17T07:47:35Z", "bug_id": 42896, "creation_time": "2007-07-17T07:47:35Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "kriskad@voila.fr", "is_private": false, "id": 114731, "creation_time": "2008-03-19T01:58:47Z", "time": "2008-03-19T01:58:47Z", "bug_id": 42896, "text": "I confirm problem with Apache 2.0.55 on Windows Server 2003...\nContent-Range not run with PUT command...", "attachment_id": null}, {"count": 4, "attachment_id": 21687, "creator": "kstearns@us.ibm.com", "is_private": false, "id": 114744, "time": "2008-03-19T06:31:45Z", "bug_id": 42896, "creation_time": "2008-03-19T06:31:45Z", "tags": [], "text": "Created attachment 21687\nThis is a patch that we are using to work around this problem\n\nLast year we developed a work-around to this problem in the form of the attached patch. I would, of course, would like to get it into apache (or even just WebSphere) but I have not made much forward progress on that."}, {"count": 5, "tags": [], "bug_id": 42896, "attachment_id": null, "id": 124185, "time": "2009-01-19T07:57:24Z", "creator": "mail@patrick-nagel.net", "creation_time": "2009-01-19T07:57:24Z", "is_private": false, "text": "Any news on this?\n\nWhen using Mozilla Sunbird with a ICS file stored in an Apache WebDAV folder this happens very frequently (see also http://getsatisfaction.com/foxmarks/topics/using_webdav_bookmarks_json_gets_deleted_by_the_foxmarks_client#reply_720003 )\n\nI'm currently using Apache 2.2.10 on Gentoo Linux."}, {"count": 6, "tags": [], "creator": "sf@sfritsch.de", "is_private": false, "id": 131818, "creation_time": "2009-11-09T05:50:54Z", "time": "2009-11-09T05:50:54Z", "bug_id": 42896, "text": "fixed in r834062", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 42896, "attachment_id": null, "id": 154195, "time": "2012-02-26T16:44:22Z", "creator": "sf@sfritsch.de", "creation_time": "2012-02-26T16:44:22Z", "is_private": false, "text": "fixed in 2.4.1"}]