[{"count": 0, "tags": [], "bug_id": 45859, "text": "Created attachment 22622\nsource and excel to re-produce the bug\n\nI ran into mysterious workbook corrupts with recent POI releases. When opening the workbook, excel (2003) complains\n\n\"File error, data may have been lost\". After repairs all the formatting and pictures seem to be lost.\n\nI could narrow down the problem to\n\n1) several cloneSheet operations\n2) one worksheet having picture in it (not the cloned one)\n\nSee the attachment for excel and source to re-produce.\n\nRemoving the picture helps, and with single cloneSheet it works. Not all pictures trigger the corrupt, and excel feedback varies based on picture too; with some pictures I'll get multiple \"File error\" boxes, one for every sheet. Or just one error box, like in attaced case.\n\nTested with several releases; r696898 (broken), r693085 (broken), r692893 (works), 3.1-FINAL (works) and 3.0.2-FINAL (works)", "id": 120851, "time": "2008-09-22T06:17:27Z", "creator": "antti.koskimaki@joinex.com", "creation_time": "2008-09-22T06:17:27Z", "is_private": false, "attachment_id": 22622}, {"count": 1, "tags": [], "bug_id": 45859, "attachment_id": null, "text": "\nActually, it seems that change in release 693085 have caused the corruption; tested reverting the change with latest r697599 and my test case does not corrupt anymore.\n\nMaybe someone with \"deeper understanding\" would verify?", "id": 120852, "time": "2008-09-22T06:23:41Z", "creator": "antti.koskimaki@joinex.com", "creation_time": "2008-09-22T06:23:41Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 45859, "is_private": false, "text": "I moved workbook.cloneDrawings back in the brackets. \n\nActually, the change in r693085 was intentional. Having cloneDrawings  in the brackets would mean that the drawing stuff is cloned ONLY if the sheet has data validation. In fact, we should clone drawings regardless if DV is present or not.\n\nI expect that other bugs related to this one will pop up in future.\n\nYegor", "id": 121089, "time": "2008-09-30T07:31:49Z", "creator": "yegor@dinom.ru", "creation_time": "2008-09-30T07:31:49Z", "attachment_id": null}]