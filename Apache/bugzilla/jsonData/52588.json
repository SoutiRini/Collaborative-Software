[{"count": 0, "tags": [], "text": "Created attachment 28255\nmodel file with tables\n\nI have problems for to use the method Range.replaceText() for alter values into tables. When i try to alter values into tables, the file created is corrupted.\n\ni'm using the poi-bin-3.8-beta5-20111217 version.\n\n\nA simple exemple:\n\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.text.Normalizer;\n\nimport org.apache.poi.hwpf.HWPFDocument;\nimport org.apache.poi.hwpf.usermodel.Paragraph;\nimport org.apache.poi.hwpf.usermodel.Range;\nimport org.apache.poi.hwpf.usermodel.Table;\nimport org.apache.poi.hwpf.usermodel.TableCell;\nimport org.apache.poi.hwpf.usermodel.TableRow;\nimport org.apache.poi.poifs.filesystem.POIFSFileSystem;\n\n\npublic class Tests {\n\n\t/**\n\t * @param args\n\t */\n\tpublic static void main(String[] args) {\n\t\t\n\t\ttry {\n\t\t\n\t\t\tFile arquivo = new File(\"C:\\\\in.doc\");\n\t\t\tFileInputStream input = new FileInputStream(arquivo);\n\t\t\tPOIFSFileSystem poi = new POIFSFileSystem(input);\n\t\t\t\n\t\t\tHWPFDocument doc = new HWPFDocument(poi);\n\t\t\t\n\t\t\tRange rg = doc.getRange();\n\t\t\t\n\t\t\trg.replaceText(\"${name}\", \"Jos\u00e9 Carlos\");\n\t\t\t\n\t\t\tFileOutputStream out = new FileOutputStream(new File(\"C:\\\\out.doc\"));\n\t\t\t\n\t\t\tdoc.write(out);\n\t\t\tout.flush();\n\t\t\tout.close();\n\t\t\tinput.close();\n\t\t\t\n\t\t} catch (Exception e){\n\t\t\t\n\t\t}\n\t\t\n\t}\n}", "attachment_id": 28255, "id": 153382, "creator": "josecarloslacerda@msn.com", "time": "2012-02-02T20:15:54Z", "bug_id": 52588, "creation_time": "2012-02-02T20:15:54Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 52588, "attachment_id": null, "id": 153543, "time": "2012-02-07T10:09:51Z", "creator": "yegor@dinom.ru", "creation_time": "2012-02-07T10:09:51Z", "is_private": false, "text": "I'm testing with the latest build from trunk and Excel 2007 and Excel 2010 are happy to open the generated file.\n\nPlease try with the latest build from trunk,\ndaily builds can be downloaded form here:\nhttp://encore.torchbox.com/poi-cvs-build/\n\nYegor"}, {"count": 2, "tags": [], "bug_id": 52588, "attachment_id": null, "is_private": false, "id": 153554, "time": "2012-02-07T18:59:19Z", "creator": "josecarloslacerda@msn.com", "creation_time": "2012-02-07T18:59:19Z", "text": "(In reply to comment #1)\n> I'm testing with the latest build from trunk and Excel 2007 and Excel 2010 are\n> happy to open the generated file.\n> \n> Please try with the latest build from trunk,\n> daily builds can be downloaded form here:\n> http://encore.torchbox.com/poi-cvs-build/\n> \n> Yegor\n\nMy problem is with file Word 2003.\n\ni'm trying open that link but it's broken"}, {"attachment_id": null, "tags": [], "creator": "gbogaert62@gmail.com", "text": "I have the same problem.\n\nThe output file is corrupt. MS Word can fix it but you have to save it and to \"open and fix\" with Word.\n\nthe code is the same : \n\nHWPFDocument document = new HWPFDocument(blobWord.getBinaryStream());\ndocument.getRange().replaceText(\"${******}\", \"*******\");", "count": 3, "id": 163080, "time": "2012-10-31T11:19:03Z", "bug_id": 52588, "creation_time": "2012-10-31T11:19:03Z", "is_private": false}]