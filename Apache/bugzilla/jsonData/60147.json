[{"count": 0, "tags": [], "bug_id": 60147, "attachment_id": 34272, "is_private": false, "id": 193799, "time": "2016-09-19T07:27:10Z", "creator": "346164994@qq.com", "creation_time": "2016-09-19T07:27:10Z", "text": "Created attachment 34272\nexport result\n\nHello !\nI want to export to excel 2007 use XSSF, but i found some string can't export correctly such as \"IBM_x3550_M2\", this string will be export to \"IBM\u3550M2\".\n\nThen i found the problem is \"_x3550_\", when the string's format like \"_xNUMBER_\"  and the NUMBER is a Unicode code , then it will be export to \"_xChinese character_\".\n\nIs this a bug of XSSF \uff1f\nOr there are some other ways to resolve it\uff1f\n\nPS\uff1aUse HSSF to export Excel 2003 is correctly\uff01"}, {"count": 1, "attachment_id": null, "bug_id": 60147, "is_private": false, "id": 193800, "time": "2016-09-19T07:41:07Z", "creator": "onealj@apache.org", "creation_time": "2016-09-19T07:41:07Z", "tags": [], "text": "Could you include a code sample to reproduce this?"}, {"count": 2, "attachment_id": null, "bug_id": 60147, "is_private": false, "id": 193801, "time": "2016-09-19T08:02:46Z", "creator": "346164994@qq.com", "creation_time": "2016-09-19T08:02:46Z", "tags": [], "text": "(In reply to Javen O'Neal from comment #1)\n> Could you include a code sample to reproduce this?\n\ncode sample is normal \uff0cyou can try it by yourself\uff01\n\nBy the way\uff0cjxls has same problem when i use to export Excel 2007\uff0cbecause jxls is base poi!"}, {"count": 3, "tags": [], "bug_id": 60147, "attachment_id": 34273, "is_private": false, "id": 193803, "time": "2016-09-19T08:34:51Z", "creator": "346164994@qq.com", "creation_time": "2016-09-19T08:34:51Z", "text": "Created attachment 34273\ncode sample"}, {"count": 4, "attachment_id": null, "bug_id": 60147, "is_private": false, "id": 193804, "time": "2016-09-19T09:04:08Z", "creator": "onealj@apache.org", "creation_time": "2016-09-19T09:04:08Z", "tags": [], "text": "I was hoping for a code sample that is less than 20 lines. I do not understand what function is causing the problem from comment 0.\n\nWhat code is called when you \"export to Excel\"? Where is the Unicode string set? Is this on an existing document or a new document? A concise code sample should be able to answer this."}, {"count": 5, "tags": [], "creator": "346164994@qq.com", "text": "(In reply to Javen O'Neal from comment #4)\n\ncode sample like this \uff1a\n\nXSSFRow row = sheet.createRow(rowNum);\nXSSFCell cell = row.createCell(i);\ncell.setCellStyle(style);\ncell.setCellValue(textValue);\n\nOR \n\nXSSFRichTextString richString = new XSSFRichTextString(textValue);\nrichString.applyFont(font);\ncell.setCellValue(richString);", "id": 193805, "time": "2016-09-19T09:14:37Z", "bug_id": 60147, "creation_time": "2016-09-19T09:14:37Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 60147, "attachment_id": null, "is_private": false, "id": 193809, "time": "2016-09-19T13:14:32Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-09-19T13:14:32Z", "text": "We had a few discussions around this already, see https://bz.apache.org/bugzilla/buglist.cgi?f0=OP&f1=OP&f3=CP&f4=CP&j2=OR&list_id=151221&product=POI&query_format=advanced&short_desc=_x&short_desc_type=allwordssubstr for some matches. \n\nSpecifically bug 57008 discussed this. Short answer: this is how Excel encodes special characters and the POI API currently does not interfere with these escape-sequences currently, so to solve this you should escape strings like these as described in bug 57008, specifically \"This seems to be an Excel \"feature\" and if you prepend this string with \"_0x005F\" the string stays at it is.\"\n\n*** This bug has been marked as a duplicate of bug 57008 ***"}]