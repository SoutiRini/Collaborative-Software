[{"count": 0, "tags": [], "creator": "roberto.manicardi@gmail.com", "attachment_id": null, "text": "Custom properties and Extended properties are not saved when I create a new XSSFWorkbook.\n\nBelow you can find one unit test for Extended properties and one for Custom properties\n\n\n\n\n    public void testWorkbookExtendedProperties() throws Exception {\n        XSSFWorkbook workbook = new XSSFWorkbook();\n        POIXMLProperties props = workbook.getProperties();\n        assertNotNull(props);\n        \n        org.apache.poi.POIXMLProperties.ExtendedProperties properties = props.getExtendedProperties();\n        org.openxmlformats.schemas.officeDocument.x2006.extendedProperties.CTProperties ctProps = properties.getUnderlyingProperties();\n        \n        \n        String appVersion = \"3.5 beta\";\n        String application = \"POI\";\n        \n        ctProps.setApplication(application);\n        ctProps.setAppVersion(appVersion);\n        \n        ctProps=null;\n        properties=null;\n        props = null;\n        \n        XSSFWorkbook newWorkbook = XSSFTestDataSamples.writeOutAndReadBack(workbook);\n        \n        assertTrue(workbook!=newWorkbook);\n        \n        \n        POIXMLProperties newProps = newWorkbook.getProperties();\n        assertNotNull(newProps);\n        org.apache.poi.POIXMLProperties.ExtendedProperties newProperties = newProps.getExtendedProperties();\n        org.openxmlformats.schemas.officeDocument.x2006.extendedProperties.CTProperties newCtProps = newProperties.getUnderlyingProperties();\n        \n        assertEquals(application,newCtProps.getApplication());\n        assertEquals(appVersion,newCtProps.getAppVersion());\n        \n        \n        \n        \n    }\n    \n    \n    public void testWorkbookCustomProperties() throws Exception {\n        XSSFWorkbook workbook = new XSSFWorkbook();\n        POIXMLProperties props = workbook.getProperties();\n        assertNotNull(props);\n        \n        org.apache.poi.POIXMLProperties.CustomProperties properties = props.getCustomProperties();\n        org.openxmlformats.schemas.officeDocument.x2006.customProperties.CTProperties ctProps = properties.getUnderlyingProperties();\n        \n        org.openxmlformats.schemas.officeDocument.x2006.customProperties.CTProperty property = ctProps.addNewProperty();\n        \n        \n        String fmtid = \"{A1A1A1A1A1A1A1A1-A1A1A1A1-A1A1A1A1-A1A1A1A1-A1A1A1A1A1A1A1A1}\";\n        int pId = 1;\n        String name = \"testProperty\";\n        String stringValue = \"testValue\";\n        \n        \n        property.setFmtid(fmtid);\n        property.setPid(pId);\n        property.setName(name);\n        property.setBstr(stringValue);\n        \n       \n        property =null;\n        ctProps=null;\n        properties=null;\n        props = null;\n        \n        XSSFWorkbook newWorkbook = XSSFTestDataSamples.writeOutAndReadBack(workbook);\n        \n        assertTrue(workbook!=newWorkbook);\n        \n        \n        POIXMLProperties newProps = newWorkbook.getProperties();\n        assertNotNull(newProps);\n        org.apache.poi.POIXMLProperties.CustomProperties newProperties = newProps.getCustomProperties();\n        org.openxmlformats.schemas.officeDocument.x2006.customProperties.CTProperties newCtProps = newProperties.getUnderlyingProperties();\n        \n        assertEquals(1,newCtProps.getPropertyArray().length);\n        \n        \n        org.openxmlformats.schemas.officeDocument.x2006.customProperties.CTProperty newpProperty = newCtProps.getPropertyArray()[0];\n        \n        assertEquals(fmtid, newpProperty.getFmtid() );\n        assertEquals(pId,newpProperty.getPid());\n        assertEquals(name,newpProperty.getName());\n        assertEquals(stringValue,newpProperty.getBstr());\n\n        \n    }", "id": 128897, "time": "2009-07-16T01:03:54Z", "bug_id": 47540, "creation_time": "2009-07-16T01:03:54Z", "is_private": false}, {"count": 1, "tags": [], "text": "I also would like to add in that you can't currently save the XWPFDocument properties. \n\n      XWPFDocument doc = new XWPFDocument(POIXMLDocument.openPackage(\"c:\\\\test.docx\"));\n\n      CustomProperties props = doc.getProperties().getCustomProperties();\n\n      CTProperty[] ctp = props.getUnderlyingProperties().getPropertyArray();\n      for (CTProperty foo : ctp) {\n          System.out.println(foo.toString());\n      } \n\nBut there is no, doc.setProperties(...) \nTested with 3.5-beta7", "is_private": false, "id": 128955, "creator": "awm@mbcli.com", "time": "2009-07-17T08:44:19Z", "bug_id": 47540, "creation_time": "2009-07-17T08:44:19Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 47540, "attachment_id": null, "is_private": false, "id": 128980, "time": "2009-07-19T11:30:28Z", "creator": "yegor@dinom.ru", "creation_time": "2009-07-19T11:30:28Z", "text": "Fixed in r795587, junit added.\n\nI also added an example on setting extended / custom OOXML properties:\nhttp://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/xssf/usermodel/examples/WorkbookProperties.java\n\nRegards,\nYegor"}]