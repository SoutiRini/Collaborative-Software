[{"attachment_id": null, "tags": [], "bug_id": 43623, "text": "Vector row seems to be unsupported in poi-3.0.1-FINAL-20070705.\n\nTo reproduce: load a spreadsheet and then immediately write it back to a file \nsystem - without making any modifications to it's structure.\nE.g. by\nnew HSSFWorkbook(new FileInputStream(inFileName)).write(new \nFileOutputStream(outFileName));\n\nIf the source spreadsheet contains a row vector, the newly created \nspreadsheets's structure seems to be broken: Excel refuses to open it - with \n\"File error: data may have been lost\" message.\n\nExcel 2003 (11.8146.8132) SP2.\n\nExample spreadsheets attached.\n\nTo create a row vector e.g. for SIN function, type a function name, provide an \narray of arguments, then press 'enter'. Then select the cell, then extend the \nselection to include more cells, press F2, then ctrl+shirt+enter - the vector \nwith the result will be created.", "count": 0, "id": 109341, "time": "2007-10-15T03:58:46Z", "creator": "michal.jacykiewicz@ubs.com", "creation_time": "2007-10-15T03:58:46Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 43623, "attachment_id": 20978, "text": "Created attachment 20978\na spreadsheet that contains a vector defined", "id": 109342, "time": "2007-10-15T04:00:14Z", "creator": "michal.jacykiewicz@ubs.com", "creation_time": "2007-10-15T04:00:14Z", "is_private": false}, {"count": 2, "tags": [], "text": "Created attachment 20979\noutput spreadsheet with a broken structure", "attachment_id": 20979, "id": 109343, "creator": "michal.jacykiewicz@ubs.com", "time": "2007-10-15T04:00:52Z", "bug_id": 43623, "creation_time": "2007-10-15T04:00:52Z", "is_private": false}, {"attachment_id": 20980, "tags": [], "bug_id": 43623, "text": "Created attachment 20980\nExcel's error message screenshot", "count": 3, "id": 109344, "time": "2007-10-15T04:01:28Z", "creator": "michal.jacykiewicz@ubs.com", "creation_time": "2007-10-15T04:01:28Z", "is_private": false}, {"count": 4, "tags": [], "text": "You might want to use the dev tools (poifs.dev.POIFSViewer and\nhssf.dev.BiffViewer in particular) to try and spot what records are getting\ncorrupted. Knowing what records are involved will make it easier to fix, and\nalso easier to figure out how much work would be involved in fixing it", "is_private": false, "bug_id": 43623, "id": 109345, "time": "2007-10-15T04:10:15Z", "creator": "apache@gagravarr.org", "creation_time": "2007-10-15T04:10:15Z", "attachment_id": null}, {"count": 5, "tags": [], "text": "Created attachment 20981\ndiff on BiffViewer output ran on good xls vs. broken one\n\nNick, I'm unable to spot 'corrupted records' here I'm afraid, as don't know the\nbiff format. But that diff I've atteched may someone to spot it. Thx.", "attachment_id": 20981, "id": 109347, "creator": "michal.jacykiewicz@ubs.com", "time": "2007-10-15T05:27:48Z", "bug_id": 43623, "creation_time": "2007-10-15T05:27:48Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 43623, "text": "I've just re-tried with svn trunk (r675734, not long after 3.1 final)\n\nWe are not able to process the formulas properly, as we're not doing the right thing with the ExpPtgs. There's now a disabled test in hssf.usermodel.TestBugs, so we can test fixes against that", "count": 6, "id": 118496, "time": "2008-07-10T14:05:16Z", "creator": "apache@gagravarr.org", "creation_time": "2008-07-10T14:05:16Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 43623, "attachment_id": null, "is_private": false, "id": 120239, "time": "2008-08-31T09:41:06Z", "creator": "josh@apache.org", "creation_time": "2008-08-31T09:41:06Z", "text": "Fixed with bug 26321 (svn r690636).\n\nPOI now does round trip re-serialization of workbooks with ArrayRecords and/or\nTableRecords without introducing errors.\n\nHowever, POI is still not able to create/edit Array or Table formulas. "}]