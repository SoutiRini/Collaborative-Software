[{"count": 0, "tags": [], "text": "Created attachment 23534\nTest Spreadsheet\n\nI encountered the following errors when I use \"createSheet()\" / \"cloneSheet()\" after \"removeSheetAt()\". The test spreadsheet is a .xlsx file which has two blank sheets.\n\n\nCase 1\n===============\n    Workbook workbook = WorkbookFactory.create(new FileInputStream(\"Book1.xlsx\"));\n    workbook.removeSheetAt(0);\n    workbook.createSheet();\n\n Error: java.lang.IllegalArgumentException: The workbook already contains a sheet of this name\n\n\nCase 2 \n===============\n    Workbook workbook = WorkbookFactory.create(new FileInputStream(\"Book1.xlsx\"));\n    workbook.removeSheetAt(1);\n    workbook.createSheet();\n\n Error: org.apache.poi.POIXMLException: org.apache.poi.openxml4j.exceptions.InvalidOperationException: A part with the name '/xl/worksheets/sheet2.xml' already exists : Packages shall not contain equivalent part names and package implementers shall neither create nor recognize packages with equivalent part names. [M1.12]\n\n\nCase 3\n===============\n    Workbook workbook = WorkbookFactory.create(new FileInputStream(\"Book1.xlsx\"));\n    workbook.removeSheetAt(0);\n    workbook.cloneSheet(0);\n\n Error: org.apache.poi.POIXMLException: org.apache.poi.openxml4j.exceptions.InvalidOperationException: A part with the name '/xl/worksheets/sheet2.xml' already exists : Packages shall not contain equivalent part names and package implementers shall neither create nor recognize packages with equivalent part names. [M1.12]\n\n\nCase 4\n===============\n    XSSFWorkbook workbook = new XSSFWorkbook();\n    workbook.createSheet();\n    workbook.removeSheetAt(0);\n    workbook.createSheet();\n\n Error: org.apache.poi.POIXMLException: org.apache.poi.openxml4j.exceptions.InvalidOperationException: A part with the name '/xl/worksheets/sheet1.xml' already exists : Packages shall not contain equivalent part names and package implementers shall neither create nor recognize packages with equivalent part names. [M1.12]", "attachment_id": 23534, "bug_id": 47090, "id": 126476, "time": "2009-04-23T21:25:23Z", "creator": "ytakahashi@bbreak.co.jp", "creation_time": "2009-04-23T21:25:23Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 47090, "attachment_id": null, "text": "I could not reproduce any of the problems any more with the latest version of POI, Please try with a snapshot build and reopen the bug with an updated testcase if any of the problems persist for you.", "id": 169682, "time": "2013-08-23T18:37:28Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2013-08-23T18:37:28Z", "is_private": false}]