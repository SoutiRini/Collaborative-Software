[{"count": 0, "tags": [], "bug_id": 8184, "attachment_id": null, "is_private": false, "id": 13825, "time": "2002-04-17T04:55:45Z", "creator": "rthomas-contrib@liveintellect.org", "creation_time": "2002-04-17T04:55:45Z", "text": "Error occurs with Apache 2.0.35 configured with rewrite rules that use the [P] \noption to proxy requests to Tomcat 4.0.x as follows:\n\nProxyPassReverse / http://localhost:8080/\nRewriteRule ^/(.*)/(.*\\.(jsp|serv))\\?(.*)  http://localhost:8080/$1/$2?$3 \n[P,skip=2]\nRewriteRule ^/(.*)/(.*\\.(jsp|serv))$  http://localhost:8080/$1/$2 [P,skip=1]\nRewriteRule ^/(.*)/(j_security_check)(.*)  http://localhost:8080/$1/$2$3 [P]\n\nThe error reported to the browser is:\nBad Gateway!\nThe proxy server received an invalid response from an upstream server. \nThe proxy server could not handle the request <EM><A \nHREF=\"/mywebapp/main.serv\">GET&nbsp;/mywebapp/main.serv</A></EM>.<P> Reason: \n<STRONG>Error reading from remote server</STRONG> \nIf you think this is a server error, please contact the webmaster\nError 502\n\nThe error that appears in the error log is:\n[Tue Apr 16 21:30:55 2002] [error] [client 192.168.0.7] proxy: Error reading \nfrom remote server returned by /mywebapp/main.serv, referer: \nhttp://tomcatsrvr01/mywebapp/index.html\n\nThe error only occurs intermittently (every 3rd or 4th request on average).  It \nbehaves as if requests are being distributed (via round-robin or the like) and \nhandled sometimes by a worker thread that is not properly initialized for \nproxy/rewrite (and sometimes by one that is).\n\nBy comparison, Apache v 1.3.24 works perfectly and reliably with the same \nconfiguration in the same environment (actually without changing anything else \nand running 1.3.24 instead of 2.0.35 on the very same machine).\n\nAlso tried a proxy to another machine running Tomcat 4.0.1 but the error still \noccurred with the same frequency.\n\nAlso tried proxy to Apache webserver 1.3.x running on another machine but got \nno failures that way (so perhaps this is some sort of incompatibility between \nTomcat 4 and Apache 2)."}, {"count": 1, "tags": [], "creator": "cbarth@bigfoot.com", "text": "I experience similar failures using apache 2.0.35 as a proxy on my own machine\n(win2k) to log requests. This is especially using Mozilla (various milestones\nincluding 1.0rc1) when Mozilla is set to use HTTP/1.1, keep-alive and pipelining.\n\nThe error log shows \n\nproxy: error reading status line from remote server nagoya.apache.org\nproxy: Error reading from remote server returned by\nhttp://nagoya.apache.org/bugzilla/feather.gif\n\nBefore setting MaxRequestsPerChild to a fairly low number the program was even\nhanging intermittently.", "id": 14050, "time": "2002-04-19T12:56:33Z", "bug_id": 8184, "creation_time": "2002-04-19T12:56:33Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 8184, "attachment_id": null, "is_private": false, "id": 14182, "time": "2002-04-21T17:26:52Z", "creator": "minfrin@sharp.fm", "creation_time": "2002-04-21T17:26:52Z", "text": "Please test for me whether this bug still exists in the latest 2.0.36-dev -> a\npatch was committed to handle stray blank lines after requests (ie don't bomb\nout of you get a blank line, just read the status line a second time). Looks\nlike this was the problem in your cases (in the previous case, the proxy would\nbomb out on every second request).\n"}]