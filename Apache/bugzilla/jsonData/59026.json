[{"count": 0, "tags": [], "text": "Created attachment 33568\nZip containing sample xsd, XLSX with Custom Mapping and code to reproduce this issue\n\nI got the following exception when try to export XLSX data using my Custom XML Mapping. Its due to the following line. I comment out this line as a workaround in my project because xml in sorted order is not my requirement. This issue occur because my XML Schema contains Anonymous complex types and Abstract complex types. I need a lot of changes to use all named complex types and remove abstract types from my schema. Can I go with this workaround and expect you will fix this issue in next release, so I don't need to rebuild the whole project for this single line change. You may give an overrided method with an additional boolean parameter to get whether need sorting or not like validation as a quick fix for this.\n\nXSSFExportToXml:153\nCollections.sort(xpaths, this);\n\nHere is the exception.\n\nException in thread \"main\" java.lang.NullPointerException\n\tat org.apache.poi.xssf.extractor.XSSFExportToXml.indexOfElementInComplexType(XSSFExportToXml.java:449)\n\tat org.apache.poi.xssf.extractor.XSSFExportToXml.compare(XSSFExportToXml.java:430)\n\tat org.apache.poi.xssf.extractor.XSSFExportToXml.compare(XSSFExportToXml.java:1)\n\tat java.util.TimSort.countRunAndMakeAscending(Unknown Source)\n\tat java.util.TimSort.sort(Unknown Source)\n\tat java.util.TimSort.sort(Unknown Source)\n\tat java.util.Arrays.sort(Unknown Source)\n\tat java.util.Collections.sort(Unknown Source)\n\tat org.apache.poi.xssf.extractor.XSSFExportToXml.exportToXML(XSSFExportToXml.java:153)\n\tat org.apache.poi.xssf.extractor.XSSFExportToXml.exportToXML(XSSFExportToXml.java:106)\n\nI attached a zip containing sample xsd, XLSX with Custom Mapping and code to reproduce this issue.", "attachment_id": 33568, "bug_id": 59026, "id": 188552, "time": "2016-02-18T06:19:45Z", "creator": "ehtasham37@gmail.com", "creation_time": "2016-02-18T06:19:45Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 59026, "is_private": false, "text": "After r1767057 we avoid two possible null-pointer-exceptions in this area, the export to XML seems to work fine then.", "id": 194706, "time": "2016-10-28T18:24:57Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-10-28T18:24:57Z", "attachment_id": null}]