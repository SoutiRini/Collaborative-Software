[{"count": 0, "tags": [], "bug_id": 56375, "text": "When setting autofilters on several tabs in a workbook, the _FilterDatabase built-in name sometimes has a wrong definition, e.g. it points to another sheet or no sheet at all. In that case, the filter dropdown buttons are present but they do nothing.\n\nI think the issue comes from the setAutoFilter() method in HSSFSheet, which calls new Area3DPtg() with a sheetIndex whereas it seems to expect an esternSheetIndex (line 2066 in v3.9):\n\n        Area3DPtg ptg = new Area3DPtg(range.getFirstRow(), range.getLastRow(),\n                range.getFirstColumn(), range.getLastColumn(),\n                false, false, false, false, sheetIndex);\n\nI seem to have resolved the problem by replacing this line with the following:\n\n        short externSheetIndex = \n                _workbook.getWorkbook().checkExternSheet(sheetIndex);\n        Area3DPtg ptg = new Area3DPtg(range.getFirstRow(), range.getLastRow(),\n                range.getFirstColumn(), range.getLastColumn(),\n                false, false, false, false, externSheetIndex);\n\nI have no simple code to reproduce the issue. Obviously it must happen when the sheetIndex is different from the externSheetIndex.", "id": 174412, "time": "2014-04-09T12:34:24Z", "creator": "jrsirieix@free.fr", "creation_time": "2014-04-09T12:34:24Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 56375, "text": "In addition, in order for a POI-created autofilter to be like that of a standard Excel file, the _FilterDatabase name should have be hidden (option flag NameRecord.Option.OPT_HIDDEN_NAME = 0x0001 in addition to NameRecord.Option.OPT_BUILTIN)", "id": 174414, "time": "2014-04-09T12:40:39Z", "creator": "jrsirieix@free.fr", "creation_time": "2014-04-09T12:40:39Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 56375, "attachment_id": null, "id": 181754, "time": "2015-03-14T13:49:31Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-03-14T13:49:31Z", "is_private": false, "text": "I tried to reproduce the problem, but couldn't reproduce it in a quick unit test.\n\nCan you provide a self-sufficient code-snippet or unit-test which shows the problem?\n\nPlease also try with the latest version 3.12-beta1 so we know it wasn't fixed by some unrelated change at some point."}, {"count": 3, "tags": [], "bug_id": 56375, "text": "No response for some time -> closing this as WORKSFORME for now, please reopen and attach a reproducer if this is still a problem for you.", "id": 191789, "time": "2016-06-19T19:38:20Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-06-19T19:38:20Z", "is_private": false, "attachment_id": null}]