[{"count": 0, "tags": [], "bug_id": 51946, "attachment_id": null, "is_private": false, "id": 150107, "time": "2011-10-04T00:27:55Z", "creator": "rpi_alum@yahoo.com", "creation_time": "2011-10-04T00:27:55Z", "text": "Unable to include sample document due to sensitive nature.\n\nIf there any pointers for utilities that can further investigate the documents, let me know and I'll see what further information I can supply.\n\nA few of my documents are trying to perform an arraycopy with a length thats greater than the amount remaining in the stream buffer.  File opens successfully in Word 2010, and may be older than a Word97 document.  Documents likely has encoding from Hong Kong region.\n\n\nA couple produce the following Stack Trace (Daily Build)\nCaused by: java.lang.ArrayIndexOutOfBoundsException\n\tat java.lang.System.arraycopy(Native Method)\n\tat org.apache.poi.hwpf.model.TextPieceTable.<init>(TextPieceTable.java:108)\n\tat org.apache.poi.hwpf.model.ComplexFileTable.<init>(ComplexFileTable.java:70)\n\tat org.apache.poi.hwpf.HWPFOldDocument.<init>(HWPFOldDocument.java:71)\n\tat org.apache.tika.parser.microsoft.WordExtractor.parseWord6(WordExtractor.java:410)\n\tat org.apache.tika.parser.microsoft.WordExtractor.parse(WordExtractor.java:69)\n\tat org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:200)\n\tat org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)\n\n\n\nMore than a handful are caught earlier on and produce this stack trace:\nCaused by: java.lang.IllegalStateException: Told we're for characters 0 -> 6385, but actually covers 6373 characters!\n\tat org.apache.poi.hwpf.model.TextPiece.<init>(TextPiece.java:73)\n\tat org.apache.poi.hwpf.model.TextPieceTable.<init>(TextPieceTable.java:115)\n\tat org.apache.poi.hwpf.model.ComplexFileTable.<init>(ComplexFileTable.java:70)\n\tat org.apache.poi.hwpf.HWPFOldDocument.<init>(HWPFOldDocument.java:71)\n\tat org.apache.tika.parser.microsoft.WordExtractor.parseWord6(WordExtractor.java:410)\n\tat org.apache.tika.parser.microsoft.WordExtractor.parse(WordExtractor.java:69)\n\tat org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:200)"}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "is_private": false, "text": "You can use the Binary File Format Validator to check files are valid, see http://poi.apache.org/faq.html#faq-N10109\n\nAlso, have you tried with a recent svn checkout / recent nightly build?", "id": 150110, "time": "2011-10-04T08:52:55Z", "bug_id": 51946, "creation_time": "2011-10-04T08:52:55Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "rpi_alum@yahoo.com", "is_private": false, "id": 150146, "creation_time": "2011-10-04T20:00:26Z", "time": "2011-10-04T20:00:26Z", "bug_id": 51946, "text": "I'm currently using a nightly build now for pretty much all of my investigation, and have actually had a bit of luck with getting improvements submitted.\n\nThe problem with many of these documents is that they are older versions of word likely from 1995-2001.  And also have the possability of originating from Asian countries.\n\nThe files aren't corrupt enough to the point where Word2010 can't open them... but thats not saying too much.  I've encountered numerous header signature issues which I'm kind of avoiding all together since the largest % are from ~based files... though a few are able to be opened by word.\n\nI'll take a look at using the validator on a few of the files and see what I get in the next few days.\n\n\nBTW, thanks Nick for the help on the Outlook issue #51873 a week ago.  If you get a chance can you revist my final msg there.  There was a small bug in the patch you placed into the trunk for me.\n\n\nThanks again.\n\n\n(In reply to comment #1)\n> You can use the Binary File Format Validator to check files are valid, see\n> http://poi.apache.org/faq.html#faq-N10109\n> Also, have you tried with a recent svn checkout / recent nightly build?", "attachment_id": null}, {"count": 3, "tags": [], "creator": "rpi_alum@yahoo.com", "attachment_id": null, "text": "Added link to bug 52349", "id": 152421, "time": "2011-12-27T17:06:08Z", "bug_id": 51946, "creation_time": "2011-12-27T17:06:08Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 51946, "text": "This is a duplicate of Bug 50955\n\n*** This bug has been marked as a duplicate of bug 50955 ***", "count": 4, "id": 163200, "time": "2012-11-05T15:54:37Z", "creator": "vlsergey@gmail.com", "creation_time": "2012-11-05T15:54:37Z", "is_private": false}]