[{"attachment_id": 30785, "tags": [], "creator": "martin.studer@mirai-solutions.com", "text": "Created attachment 30785\nExcel file to reproduce issue\n\nAttached is an xls file that was produced via Crystal Reports. Opening the file and trying to add a sheet leads to the following exception:\n\nException in thread \"main\" java.lang.RuntimeException: CountryRecord not found\n\tat org.apache.poi.hssf.model.LinkTable.<init>(LinkTable.java:265)\n\tat org.apache.poi.hssf.model.InternalWorkbook.getOrCreateLinkTable(InternalWorkbook.java:1794)\n\tat org.apache.poi.hssf.model.InternalWorkbook.checkSheets(InternalWorkbook.java:741)\n\tat org.apache.poi.hssf.model.InternalWorkbook.setSheetName(InternalWorkbook.java:585)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.createSheet(HSSFWorkbook.java:789)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.createSheet(HSSFWorkbook.java:73)\n\n\nThe code to reproduce this is:\n\nWorkbook wb = WorkbookFactory.create(new File(\"ReportB.xls\"));\nwb.createSheet(\"test\");\n\nOpening the file in Excel and saving it again produces a file that can be read and modified without any problems. I guess Excel simply assumes a default CountryRecord in this case. If this is the case, it would probably make sense to assume a default CountryRecord as well rather than throwing an exception.", "count": 0, "id": 169818, "time": "2013-08-29T19:30:40Z", "bug_id": 55505, "creation_time": "2013-08-29T19:30:40Z", "is_private": false}]