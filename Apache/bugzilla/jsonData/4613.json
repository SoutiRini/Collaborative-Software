[{"count": 0, "tags": [], "bug_id": 4613, "is_private": false, "text": "Code example:\n  public void valueUnbound(HttpSessionBindingEvent parm1) {\n    HttpSession session = parm1.getSession();\n    log.debug(\"SessionBindingListener::valueUnbound:Name:\"+parm1.getName()\n+\" :Session\"+session.getId());\n    System.out.println(\"1\");\n    // THE FOLLOWING CALL HANGS AFTER THE FOLLOWING CALL *******\n    User user = (User) session.getAttribute(PTLConstants.USER_KEY);\n    // THE THREAD NEVER EXECUTES THE NEXT STATEMENT\n    System.out.println(\"2\");\n    if (user == null) {\n           System.out.println(\"3\");\n       // log him off anyway\n       log.warn(\"Could not find User object in session\"+session.getId());\n       log.debug(\"user object was null\");\n       return;\n    }\n    System.out.println(\"4\");\n  }\n\nWorks OK! in Tomcat 3.2.3\n\nI believe this is the same problem of the thread hanging in HttpSessionListener \ntoo on sessionDestroyed() method.", "id": 7504, "time": "2001-11-03T01:31:07Z", "creator": "rajangupta@rocketmail.com", "creation_time": "2001-11-03T01:31:07Z", "attachment_id": null}, {"count": 1, "attachment_id": null, "creator": "rajangupta@rocketmail.com", "text": "*** Bug 4612 has been marked as a duplicate of this bug. ***", "id": 7506, "time": "2001-11-03T01:32:13Z", "bug_id": 4613, "creation_time": "2001-11-03T01:32:13Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 4613, "text": "It is far more likely that an uncaught exception occurs on that line. Try \nreplacing it with: \ntry {\n User user = (User) session.getAttribute(PTLConstants.USER_KEY);\n} catch (Throwable t) {\n t.printStackTrace();\n}\nto see what's happening. The most likely is a ClassCastException when casting \nto the 'User' type.\n\nIf I'm wrong and no exception is thrown on that line, please reopen the bug.", "id": 7512, "time": "2001-11-03T11:50:42Z", "creator": "remm@apache.org", "creation_time": "2001-11-03T11:50:42Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 4613, "is_private": false, "id": 7515, "creation_time": "2001-11-03T21:15:02Z", "time": "2001-11-03T21:15:02Z", "creator": "william.barker@wilshire.com", "text": "Most likely what is happening is that it is throwing an InvalidStateException \ndue to the fact that the session has expired, and calls to getAttribute are no \nlonger allowed.  This is exactly what the 2.3 servlet spec specifies (it was \nunspecified in the 2.2 spec), so Remy (and Tomcat) are right.", "attachment_id": null}]