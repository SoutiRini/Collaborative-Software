[{"count": 0, "tags": [], "creator": "tjuchniewicz@gmail.com", "attachment_id": 29005, "text": "Created attachment 29005\nExample XLS file.\n\nStacktrace:\n\nCaused by: java.lang.NullPointerException\n\tat org.apache.poi.poifs.filesystem.ODocumentInputStream.readUShort(ODocumentInputStream.java:294)\n\tat org.apache.poi.poifs.filesystem.DocumentInputStream.readUShort(DocumentInputStream.java:163)\n\tat org.apache.poi.hssf.record.RecordInputStream$SimpleHeaderInput.readRecordSID(RecordInputStream.java:98)\n\tat org.apache.poi.hssf.record.RecordInputStream.readNextSid(RecordInputStream.java:177)\n\tat org.apache.poi.hssf.record.RecordInputStream.<init>(RecordInputStream.java:115)\n\tat org.apache.poi.hssf.record.RecordInputStream.<init>(RecordInputStream.java:103)\n\tat org.apache.poi.hssf.record.RecordFactoryInputStream.<init>(RecordFactoryInputStream.java:180)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:440)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:285)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:248)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:192)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:327)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:308)\n\tat org.apache.poi.ss.usermodel.WorkbookFactory.create(WorkbookFactory.java:70)\n\nWhen file form attachment is re-saved in MS Office or OpenOffice then POI parse XLS with no NPE.", "id": 160326, "time": "2012-06-28T18:09:00Z", "bug_id": 53482, "creation_time": "2012-06-28T18:09:00Z", "is_private": false}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "is_private": false, "id": 160327, "time": "2012-06-28T18:53:04Z", "bug_id": 53482, "creation_time": "2012-06-28T18:53:04Z", "text": "Does opening the file with NPOIFSFileSystem rather than the older POIFSFileSystem solve the problem for you?"}, {"count": 2, "tags": [], "creator": "tjuchniewicz@gmail.com", "text": "Yes. After switching to NPOIFSFileSystem it works fine. My problem is solved, thanks.", "id": 160336, "attachment_id": null, "bug_id": 53482, "creation_time": "2012-06-29T06:55:42Z", "time": "2012-06-29T06:55:42Z", "is_private": false}, {"count": 3, "text": "There are a couple of design snags in the older POIFS implementation, which is partly why we re-wrote it (those and cleaner code now the documentation is better + public, lower memory footprint etc). I think this bug is likely related to one of the gnarly bits in the old codebase, so I'm marking this as Won't Fix since it's corrected by the new implementation", "bug_id": 53482, "attachment_id": null, "id": 160371, "time": "2012-06-30T13:22:54Z", "creator": "apache@gagravarr.org", "creation_time": "2012-06-30T13:22:54Z", "tags": [], "is_private": false}]