[{"count": 0, "tags": [], "bug_id": 26573, "attachment_id": null, "id": 51538, "time": "2004-02-01T05:34:07Z", "creator": "skrajesh@netzero.com", "creation_time": "2004-02-01T05:34:07Z", "is_private": false, "text": "If the formula contains a space or _ (underscore) charcters, setCellFormula \nthrows array out of bounds exception.\n\nSample code:\n\nimport java.io.*;\nimport org.apache.poi.hssf.usermodel.*;\nimport org.apache.poi.hssf.*;\n\npublic class FormulaError\n{\n  public static void main(String args[])\n  {\n    try\n    {\n      // New workbook\n      FileOutputStream out = new FileOutputStream\n(\"D://java//programs//test.xls\");\n      HSSFWorkbook book = new HSSFWorkbook();\n      HSSFSheet sheet1 = book.createSheet(\"Test Sheet1\"); // Note the space in \nbetween\n      HSSFSheet sheet2 = book.createSheet(\"Sheet2\");\n\n      HSSFRow row = sheet1.createRow((short)0);\n      HSSFCell cell = row.createCell((short)0);\n      cell.setCellValue(\"SVUG1000\");\n\n      HSSFRow row2 = sheet2.createRow((short)0);\n      HSSFCell cell2 = row2.createCell((short)0);\n      // The space in the sheet name causes the set formula to throw an \nexception\n      cell2.setCellFormula(\"Test Sheet1!A1\"); // Link to cell 0 on sheet 1\n\n      book.write(out);\n      out.close();\n\n    }\n    catch (Exception ex)\n    {\n      System.out.println(\"Ex: \" + ex);\n    }\n  }\n}"}, {"count": 1, "tags": [], "creator": "new_connie@hotmail.com", "attachment_id": null, "text": "Change the line\n    cell2.setCellFormula(\"Test Sheet1!A1\"); \nto\n    cell2.setCellFormula(\"'Test Sheet1'!A1\"); \n\nand it should work.\n\ncheers\nConrad", "id": 56776, "time": "2004-05-03T22:36:31Z", "bug_id": 26573, "creation_time": "2004-05-03T22:36:31Z", "is_private": false}]