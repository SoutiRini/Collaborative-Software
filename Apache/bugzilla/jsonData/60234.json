[{"count": 0, "tags": [], "creator": "andreas.kohn@gmail.com", "attachment_id": null, "text": "We have a piece of code that essentially does this:\n\ntry {\n  new XSSFWorkbook(new ByteArrayInputStream(\"garbage\".getBytes());\n} catch (POIXMLException e) {\n  // Ok, guess it wasn't OOXML, so try something else.\n  // ...\n}\n\nThis worked fine in 3.14 and before. After I updated to 3.15 it fails, because we're now seeing a 'org.apache.poi.openxml4j.exceptions.NotOfficeXmlFileException' instead:\n\norg.apache.poi.openxml4j.exceptions.NotOfficeXmlFileException: No valid entries or contents found, this is not a valid OOXML (Office Open XML) file\n\tat org.apache.poi.openxml4j.opc.ZipPackage.getPartsImpl(ZipPackage.java:290)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.getParts(OPCPackage.java:774)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.open(OPCPackage.java:344)\n\tat org.apache.poi.util.PackageHelper.open(PackageHelper.java:37)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:285)\n\tat ...", "id": 194311, "time": "2016-10-10T15:45:03Z", "bug_id": 60234, "creation_time": "2016-10-10T15:45:03Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 60234, "attachment_id": null, "text": "Work-around: For now I've changed the catch to catch all RuntimeExceptions, but that's obviously not very nice.", "id": 194312, "time": "2016-10-10T15:46:24Z", "creator": "andreas.kohn@gmail.com", "creation_time": "2016-10-10T15:46:24Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 60234, "attachment_id": null, "text": "NotOfficeXmlFileException extends from UnsupportedFileFormatException, which is in the core POI jar and has been around for a while. The fix to give a more helpful exception brings the OOXML code more in line with the behaviour of the other formats\n\nI'd suggest you change your code to catch org.apache.poi.UnsupportedFileFormatException as your primary \"is this a supported file\" exception", "id": 194315, "time": "2016-10-10T16:48:06Z", "creator": "apache@gagravarr.org", "creation_time": "2016-10-10T16:48:06Z", "is_private": false}, {"count": 3, "attachment_id": null, "creator": "andreas.kohn@gmail.com", "is_private": false, "id": 194320, "time": "2016-10-11T08:18:47Z", "bug_id": 60234, "creation_time": "2016-10-11T08:18:47Z", "tags": [], "text": "Thanks a lot for confirming that this is intentional, I've adjusted my code!"}]