[{"count": 0, "tags": [], "bug_id": 36947, "text": "Reading up on the issue suggested that similar bugs have been reported, once a\ngiven spreadsheet is copied and modified, excel returns an error on opening\nabout the file being too damaged to open. Experimenting with they issue lead me\nto the conclusion it was only doing on certain spreadsheets, while others would\nwork perfectly, specifically once I deleted the 'comments' from the spreadsheet\nin question (i'll attach it) it worked correctly.\n\npublic void testModify(String filename)\n{\n   try \n   {\n\tin = new FileInputStream(\"exists.xls\");\n\tfs = new POIFSFileSystem(in);\n        HSSFWorkbook     wb     = new HSSFWorkbook(fs);\n        FileOutputStream stream = new FileOutputStream(\"exists-copy.xls\");\n        HSSFSheet        sheet  = wb.getSheetAt(0);\n        HSSFRow  row  = sheet.getRow(5);\n        HSSFCell cell = row.getCell(( short ) 5);\n        cell.setCellType(HSSFCell.CELL_TYPE_NUMERIC);\n        cell.setCellValue(9999);\n        wb.write(stream);\n        stream.close();\n    }\n    catch (Exception e)\n    {\n        e.printStackTrace();\n    }\n}\n\nBoth 2.5.1-final and poi-bin-3.0-alpha1-20050704 appear to have the same problem.", "id": 80830, "time": "2005-10-06T11:02:12Z", "creator": "lukec@refocusit.com", "creation_time": "2005-10-06T11:02:12Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 36947, "attachment_id": 16603, "text": "Created attachment 16603\nXLS file causing the problem", "id": 80831, "time": "2005-10-06T11:04:48Z", "creator": "lukec@refocusit.com", "creation_time": "2005-10-06T11:04:48Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 36947, "text": "The problem seems to be fixed in poi-3.1-beta1.\n\nYegor", "id": 116738, "time": "2008-05-17T06:01:42Z", "creator": "yegor@dinom.ru", "creation_time": "2008-05-17T06:01:42Z", "is_private": false, "attachment_id": null}]