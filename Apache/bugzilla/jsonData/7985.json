[{"count": 0, "tags": [], "creator": "brian.bothwell@wisdomtools.com", "attachment_id": null, "is_private": false, "id": 13282, "time": "2002-04-11T21:24:28Z", "bug_id": 7985, "creation_time": "2002-04-11T21:24:28Z", "text": "We run our web-app with a light mod_proxy front end to handle static requests\nand pass all Perl stuff to backend mod_perl servers, and noticed that with this\nsetup the \"perl-status\" feature of server-status doesn't work correctly given\nour setup.\n\nWe have the mod_proxy server using configured like so:\n\nProxyPass         /test1 http://localhost:8000\nProxyPassReverse  /test1 http://localhost:8000\n\nso the URL of the mod_perl site is:\n\nhttp://ourserver.com/test1/script.cgi\n\nWe have the backend mod_perl servers configured with Apache::Status like so:\n\n <Location /perl-status>\nSetHandler  perl-script\nPerlHandler Apache::Status\nOrder deny,allow\nDeny from all\nAllow from .wisdomtools.com localhost\n</Location>\n\nWhen we access perl-status thru the proxy, the URL is:\n\nhttp://ourserver.com/test1/perl-status\n\nwhich works, but if we access one of the modules of perl-status, it attempts to\naccess this:\n\nhttp://ourserver.com/perl-status?symdump\n\nwhich doesn't work since the \"test1\" is missing, so I have taken to inserting\nthe \"test1\" into the URL manually. Not a showstopper, but annoying none the\nless.\n\nI may be missing some config to fix this, so this may not actually be a bug. \n\nThanks,\n\n-Brian"}, {"count": 1, "tags": [], "creator": "minfrin@sharp.fm", "attachment_id": null, "text": "ProxyPassReverse only changes URLs in the headers of the HTTP response, it does\nnot try and parse the body of the response (too expensive, and impossible to do\nreliably). As a result, this looks like a config issue rather than a bug.\n\nThe general rule with reverse proxying is to keep the URI on the backend the\nsame as on the frontend. ie, configure your backend perl URL to be <Location\n/test1/perl-status>. This ensure that when a backend website uses an absolute\nURL, such as \"/perl-status/blah\", it does not \"jump out\" of your carefully\nchosen URL space.\n\nIdeally all backend reverse proxied websites should use relative links, however\nin the real world this usually doesn't happen, thus the problem :(\n", "id": 14180, "time": "2002-04-21T17:20:36Z", "bug_id": 7985, "creation_time": "2002-04-21T17:20:36Z", "is_private": false}]