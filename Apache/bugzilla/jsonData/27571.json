[{"count": 0, "tags": [], "creator": "kim.madsen@inceptor.com", "is_private": false, "id": 53811, "creation_time": "2004-03-10T15:38:31Z", "time": "2004-03-10T15:38:31Z", "bug_id": 27571, "text": "A spredsheet file is read into POI and written back with no changes. However,\nonce reopened in Excel, gives the below error:\n \"Errors were detected in 'POIReadWriteTest.xls,' but Microsoft Excel\n was able to open the file by making the repairs listed below. Save\n the file to make these repairs permanent.\n \n Damage to the file was so extensive that repairs were not possible.\n Excel attempted to recover your formulas and values, but some data may \n have lost or corrupted.\"\n\nThe bug seems similar to 19054 and 18155, but these bugs has status as fixed,\nand this happened using both poi-1.5.1-final and poi-2.5-final.\nhttp://nagoya.apache.org/bugzilla/show_bug.cgi?id=19054\nhttp://nagoya.apache.org/bugzilla/show_bug.cgi?id=18155\n\nThe test for this is really simple. I have included the test code below. I shall\nbe happy to supply the spreadsheet in the before and after version if required.\n\npackage com.inceptor.thirdparty;\n\nimport junit.framework.Test;\nimport junit.framework.TestSuite;\nimport junit.framework.TestCase;\n\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\n\nimport org.apache.poi.poifs.filesystem.POIFSFileSystem;\nimport org.apache.poi.hssf.usermodel.HSSFWorkbook;\n\n/** Junit test case for the thread support library.\n *  This demonstrates a bug in POI.\n *  A spredsheet is read and written back without any changes.\n *  However, the written file contains error once opened in Excel:\n *\n *  \"Errors were detected in 'POIReadWriteTest.xls,' but Microsoft Excel\n *  was able to open the file by making the repairs listed below. Save\n *  the file to make these repairs permanent.\n *\n *  Damage to the file was so extensive that repairs were not possible.\n *  Excel attempted to recover your formulas and values, but some data may \n *  have lost or corrupted.\"\n *\n *  Notice does not happen for all spreadsheets.\n *  It may only be happening on spreadsheets over a certain size,\n *  or spreadsheets with VB code.\n *\n * @version $Id: POIReadWriteTest.java,v 1.4 2004/03/10 12:01:45 kim Exp $\n */\npublic class POIReadWriteTest extends TestCase {\n    \n    public POIReadWriteTest(String name) {\n\tsuper(name);\n    }\n    \n    public void testReadWrite() throws Exception {\n\tPOIFSFileSystem fs = new\n            POIFSFileSystem(new \n\t\tFileInputStream(\"src/test/etc/imp/com/inceptor/imp/lawuers.xls\"));\n\tHSSFWorkbook wb = new HSSFWorkbook(fs);\n\tFileOutputStream fileOut = new \n\t    FileOutputStream(\"src/test/etc/poi/POIReadWriteTest.xls\" );\n\twb.write( fileOut );\n\tfileOut.close();\n    }\n    \n    public static void main(String args[]) { \n\tjunit.textui.TestRunner.run(suite());\n    }\n    \n    public static Test suite() {\n\treturn new TestSuite(POIReadWriteTest.class);\n    }\n}", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 27571, "attachment_id": 10745, "is_private": false, "id": 53812, "time": "2004-03-10T15:40:25Z", "creator": "kim.madsen@inceptor.com", "creation_time": "2004-03-10T15:40:25Z", "text": "Created attachment 10745\nExcel spreadsheet before loading into POI"}, {"count": 2, "tags": [], "text": "Created attachment 10746\nExcel spreadsheet after being written back by POI", "attachment_id": 10746, "id": 53813, "creator": "kim.madsen@inceptor.com", "time": "2004-03-10T15:41:35Z", "bug_id": 27571, "creation_time": "2004-03-10T15:41:35Z", "is_private": false}, {"count": 3, "attachment_id": null, "bug_id": 27571, "is_private": false, "id": 53839, "time": "2004-03-10T20:03:44Z", "creator": "poi-support@buni.org", "creation_time": "2004-03-10T20:03:44Z", "tags": [], "text": "can you try with 2.0?  This is probably two completely different problems.  We\nanticipated some Read-Write problems with 2.5 which is why we released it so\nshortly after 2.0.  "}, {"count": 4, "tags": [], "creator": "kim.madsen@inceptor.com", "is_private": false, "id": 53852, "creation_time": "2004-03-11T09:49:48Z", "time": "2004-03-11T09:49:48Z", "bug_id": 27571, "text": "I just tried it using poi-bin-2.0-RC2-20040102 and it worked fine. \nThanks for the tip.", "attachment_id": null}, {"count": 5, "tags": [], "text": "Upgrading corrected issue.", "attachment_id": null, "id": 54277, "creator": "dmui@apache.org", "time": "2004-03-19T17:43:02Z", "bug_id": 27571, "creation_time": "2004-03-19T17:43:02Z", "is_private": false}, {"count": 6, "tags": [], "text": "File is corrupted after being read by poi. Still readable but it looks like \nthere are two panes overlaying each other, some cell borders are missing.  ", "attachment_id": null, "id": 63977, "creator": "mariya.klimenko@eia.doe.gov", "time": "2004-09-21T13:52:57Z", "bug_id": 27571, "creation_time": "2004-09-21T13:52:57Z", "is_private": false}, {"count": 7, "tags": [], "creator": "jheight@apache.org", "is_private": false, "text": "Using latest CVS code (2.5.1) visually confirmed that the workbook from POI is\nidentical to the original excel one.", "id": 64239, "time": "2004-09-27T02:59:53Z", "bug_id": 27571, "creation_time": "2004-09-27T02:59:53Z", "attachment_id": null}, {"count": 8, "tags": [], "text": "I'm experiencing the same problem with poi 2.5.1-final.\n\nhow can I investigate this?", "attachment_id": null, "id": 82797, "creator": "richts@gmx.at", "time": "2005-11-24T11:03:53Z", "bug_id": 27571, "creation_time": "2005-11-24T11:03:53Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 27571, "attachment_id": null, "is_private": false, "id": 82798, "time": "2005-11-24T11:07:01Z", "creator": "richts@gmx.at", "creation_time": "2005-11-24T11:07:01Z", "text": "additional info:\ni don't only read and write the workbook, i also clone and remove worksheets,\nrename them and write contents of cells.\n\ni'll try to create the excel files to attach them."}, {"count": 10, "tags": [], "bug_id": 27571, "attachment_id": 17028, "id": 82800, "time": "2005-11-24T11:14:28Z", "creator": "richts@gmx.at", "creation_time": "2005-11-24T11:14:28Z", "is_private": false, "text": "Created attachment 17028\nthe file before writing with poi"}, {"count": 11, "attachment_id": 17029, "bug_id": 27571, "is_private": false, "id": 82801, "time": "2005-11-24T11:14:58Z", "creator": "richts@gmx.at", "creation_time": "2005-11-24T11:14:58Z", "tags": [], "text": "Created attachment 17029\nand after writing with poi"}, {"count": 12, "tags": [], "text": "this is the \"log\", excel writes when i open the file.\n\nMicrosoft Office Excel File Repair Log\n\nErrors were detected in file 'ManualTest.xls'\nThe following is a list of repairs:\n\nRemoved one or more invalid formulas.\n", "attachment_id": null, "id": 82861, "creator": "richts@gmx.at", "time": "2005-11-25T10:45:43Z", "bug_id": 27571, "creation_time": "2005-11-25T10:45:43Z", "is_private": false}, {"count": 13, "tags": [], "bug_id": 27571, "attachment_id": null, "id": 83712, "time": "2005-12-15T23:23:32Z", "creator": "jheight@apache.org", "creation_time": "2005-12-15T23:23:32Z", "is_private": false, "text": "It would be easier if you provided a java class that opened the file, performed\nthe operations you are having trouble with and then wrote it out.\n\nJason"}, {"count": 14, "tags": [], "bug_id": 27571, "text": "I see this problem with POI 2.5.1 final 20040804.jar", "id": 91861, "time": "2006-08-03T13:37:59Z", "creator": "oyvind.harboe@zylin.com", "creation_time": "2006-08-03T13:37:59Z", "is_private": false, "attachment_id": null}, {"count": 15, "tags": [], "creator": "oyvind.harboe@zylin.com", "is_private": false, "text": "Created attachment 18674\nJava code to reproduce problem", "id": 91862, "time": "2006-08-03T13:38:31Z", "bug_id": 27571, "creation_time": "2006-08-03T13:38:31Z", "attachment_id": 18674}, {"count": 16, "tags": [], "text": "Created attachment 18675\nInput to TestPOI.java testcase\n\nWhen I try to open the resulting test.xls generated by TestPOI.java, I get an\nerror message in Excel 2003:\n\n\n\nMicrosoft Office Excel File Repair Log\n\nErrors were detected in file 'C:\\workspace\\qpbtapestry\\test.xls'\nThe following is a list of repairs:\n\nRemoved one or more invalid formulas.", "attachment_id": 18675, "id": 91863, "creator": "oyvind.harboe@zylin.com", "time": "2006-08-03T13:39:35Z", "bug_id": 27571, "creation_time": "2006-08-03T13:39:35Z", "is_private": false}, {"count": 17, "tags": [], "bug_id": 27571, "attachment_id": null, "id": 92599, "time": "2006-08-28T04:00:18Z", "creator": "jheight@apache.org", "creation_time": "2006-08-28T04:00:18Z", "is_private": false, "text": "\u00d8yvind your test case works fine in latest SVN code.\n\njuergen it appears that the removal of sheets and cloning is cause of the issue.\nA Bug like 29619 is more suited. (Plus you never gave us java code which did the\ncloning and removal that cprrupted your example)\n\nThe original issue was a pure read and write issue which as indicated was corrected.\n\nMarking this bug fixed. The other comments on the bug are covered by existing bugs.\n\nThink that sheet corruption with removal and cloning is the next thing to look at.\n\nJason"}, {"count": 18, "tags": [], "creator": "julianojoaobazzo@yahoo.com.br", "is_private": false, "id": 100838, "creation_time": "2007-03-23T09:51:38Z", "time": "2007-03-23T09:51:38Z", "bug_id": 27571, "text": "Hi, I am still facing this bug. I tried with version 2.5 and the\n3.0beta(20061212) and the problem remained, i.e., the generated file is corrupted.\n\nA weird thing happened when I removed the first worksheet (tab), the generated\nfile was NOT corrupted.\nI was thinking that the problem was with the MACROS but it seems not.\n\nSee the details:\n1) Java code:\n...\nPOIFSFileSystem fs = new POIFSFileSystem(new FileInputStream(\"C:\\\\table.xls\"));\nHSSFWorkbook wb = new HSSFWorkbook(fs);\nFileOutputStream fileOut = new FileOutputStream(\"C:\\\\table_output.xls\");\nwb.write(fileOut);\nfileOut.close();\n...\n\n2) The input file attached table.xls\n\n3) The output file attached table_output.xls\n\n4) The modified file with the first worksheet removed\ntable_removed_first_worksheet.xls.\n\nThanks,\nJuliano", "attachment_id": null}, {"count": 19, "tags": [], "bug_id": 27571, "text": "Created attachment 19789\nInput Excel Sheet", "id": 100839, "time": "2007-03-23T09:53:26Z", "creator": "julianojoaobazzo@yahoo.com.br", "creation_time": "2007-03-23T09:53:26Z", "is_private": false, "attachment_id": 19789}, {"count": 20, "tags": [], "text": "Created attachment 19790\nOutput Excel Sheet", "attachment_id": 19790, "id": 100840, "creator": "julianojoaobazzo@yahoo.com.br", "time": "2007-03-23T09:56:07Z", "bug_id": 27571, "creation_time": "2007-03-23T09:56:07Z", "is_private": false}, {"count": 21, "tags": [], "bug_id": 27571, "attachment_id": 19791, "id": 100841, "time": "2007-03-23T09:57:40Z", "creator": "julianojoaobazzo@yahoo.com.br", "creation_time": "2007-03-23T09:57:40Z", "is_private": false, "text": "Created attachment 19791\nModified file with worksheet removed"}, {"count": 22, "attachment_id": null, "bug_id": 27571, "is_private": false, "id": 100843, "time": "2007-03-23T10:22:38Z", "creator": "julianojoaobazzo@yahoo.com.br", "creation_time": "2007-03-23T10:22:38Z", "tags": [], "text": "I have just tested with the 3.0RC1-20070311 and the problem didn't happen anymore. \nChanging the state to RESOLVE.... Thanks. Juliano"}]