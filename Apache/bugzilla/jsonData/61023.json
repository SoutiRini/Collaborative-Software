[{"count": 0, "tags": [], "text": "If the following character sequence is used anywhere in a POST Request body, the reverse proxy server closes the connection before it can be finished:\n\n\" | \n\nIn words: <double quotation mark><space><pipe><space>\nIn hex: \\x22\\x20\\x7C\\x20\n\n\nAfter doing that you can find the following two lines in the error log:\n\n[proxy_http:error] [pid 6096:tid 7192] (OS 10054)An existing connection was forcibly closed by the remote host.  : [client xxx.xxx.xxx.xxx:62062] AH02609: read request body failed to xxx.xxx.xxx.xxx:80 (the.requested.url) from xxx.xxx.xxx.xxx (), referer: http://the.requested.url\n[proxy_http:error] [pid 6096:tid 7192] [client xxx.xxx.xxx.xxx:62062] AH01097: pass request body failed to xxx.xxx.xxx.xxx:80 (the.requested.url) from xxx.xxx.xxx.xxx (), referer: http://the.requested.url", "is_private": false, "bug_id": 61023, "id": 198461, "time": "2017-04-21T18:15:40Z", "creator": "dominik.winkelbauer@respon.se", "creation_time": "2017-04-21T18:15:40Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 61023, "attachment_id": null, "id": 198462, "time": "2017-04-21T18:17:41Z", "creator": "covener@gmail.com", "creation_time": "2017-04-21T18:17:41Z", "is_private": false, "text": "Can you share a packet capture from the webserver showing it?"}, {"count": 2, "tags": [], "text": "The error message says that the remote side closed the connection NOT the reverse proxy. This means your backend is unable to handle these POST request bodies. This would be a bug of backend server software or your backend application. Not of the reverse proxy.", "attachment_id": null, "id": 198463, "creator": "rpluem@apache.org", "time": "2017-04-21T18:47:03Z", "bug_id": 61023, "creation_time": "2017-04-21T18:47:03Z", "is_private": false}, {"count": 3, "tags": [], "text": "That was also my first explanation, but if I send the same request directly to the webserver (without a reverse proxy server in between), everything works fine.\n\nSo i concluded that this has to be a problem of the reverse proxy server.", "is_private": false, "id": 198464, "creation_time": "2017-04-21T18:58:17Z", "time": "2017-04-21T18:58:17Z", "creator": "dominik.winkelbauer@respon.se", "bug_id": 61023, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 61023, "attachment_id": null, "is_private": false, "id": 198494, "time": "2017-04-24T11:30:36Z", "creator": "toscano.luca@gmail.com", "creation_time": "2017-04-24T11:30:36Z", "text": "As Eric pointed out it would be great if you could support your thesis with some tcpdump pcap and/or with https://httpd.apache.org/docs/2.4/mod/mod_dumpio.html.\n\nWhat happens when the webserver receives a proxied request? Does it show anything in its logs? As Ruediger pointed out it seems that the backend webserver closes its connection for some reason, meanwhile you reported that hitting it directly works fine.\n\nThanks!\n\nLuca"}, {"count": 5, "attachment_id": 34949, "bug_id": 61023, "is_private": false, "id": 198521, "time": "2017-04-25T11:40:38Z", "creator": "gh_bugzilla@respon.se", "creation_time": "2017-04-25T11:40:38Z", "tags": [], "text": "Created attachment 34949\nmod_dumpio output\n\nI'm a colleague of Dominik and I digged a bit deeper in this problem.\n\nThere is no error log entry in the webservers error log (the server behind the Apache Reverse Proxy).\n\nThe dumpio log of the request and the sent POST data are contained in the attached file.\n\nThe system the Apache reverse proxy is running on is Windows. I suspect the problem may be related to the Windows version of Apache."}, {"count": 6, "tags": [], "bug_id": 61023, "attachment_id": null, "id": 198522, "time": "2017-04-25T11:58:00Z", "creator": "covener@gmail.com", "creation_time": "2017-04-25T11:58:00Z", "is_private": false, "text": "Reading the post body returned WSAECONNRESET.\n\nNothing from the ASF would synthesize that based on the data being read and processed.\n\nHistorically this would be more likely AV/firewall on Windows outside of httpd."}]