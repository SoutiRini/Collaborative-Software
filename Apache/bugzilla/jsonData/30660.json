[{"count": 0, "tags": [], "text": "I was playing around trying to learn how to use an antlib when I tried this\nbuild file.\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project  basedir=\".\" default=\"msg\" xmlns=\"antlib:any.resource\">\n  <target name=\"msg\">\n    <echo message=\"Echo.\"/>\n  </target>\n</project>\n\nThe build failed with this error:\nUnexpected element \"project\" project\n        at org.apache.tools.ant.helper.ProjectHelper2.parse(ProjectHelper2.java:223)\n        at org.apache.tools.ant.helper.ProjectHelper2.parse(ProjectHelper2.java:132)\n        at\norg.apache.tools.ant.ProjectHelper.configureProject(ProjectHelper.java:92)\n        at org.apache.tools.ant.Main.runBuild(Main.java:658)\n        at org.apache.tools.ant.Main.startAnt(Main.java:188)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:196)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:55)\n\nBeing completely confused by the 'Unexpected element \"project\" project',\nI started digging at the code.  I found two problems that contributed to\nthe uninformative message.\n\n1) In ProjectHelper2.parse, there is a catch block for\n   SAXParseException.  This block extracts the cause exception from\n   the SAXParseException using \"exc.getException ()\" then creates a\n   BuildException with that cause exception.  In this particular case,\n   \"exc.getException()\" returned null so the BuildException had no\n   cause.\n\n2) The actual exception message comes from\n   ProjectHelper2.MainHandler.onStartChild.  The qname and name\n   parameters supplied by the SAX parser are identical as my xmlns\n   attribute did not set a namespace.\n\nI believe that the first problem can be fixed by using the\nSAXParseException as the cause when it does not itself contain a cause\nexception.  As for the message text, it seems appropriate to display\nthe namespace URIs when the qname and name are otherwise identical.\nI've attached a patch that implements both of these changes.  Using\nthis patch, the original exception changed into the following.\n\nUnexpected element \"{antlib:any.resource}project\"\n{antlib:org.apache.tools.ant}project\n        at org.apache.tools.ant.helper.ProjectHelper2.parse(ProjectHelper2.java:225)\n        at org.apache.tools.ant.helper.ProjectHelper2.parse(ProjectHelper2.java:132)\n        at\norg.apache.tools.ant.ProjectHelper.configureProject(ProjectHelper.java:92)\n        at org.apache.tools.ant.Main.runBuild(Main.java:658)\n        at org.apache.tools.ant.Main.startAnt(Main.java:188)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:196)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:55)\nCaused by: org.xml.sax.SAXParseException: Unexpected element\n\"{antlib:any.resource}project\" {antlib:org.apache.tools.ant}project\n        at\norg.apache.tools.ant.helper.ProjectHelper2$MainHandler.onStartChild(ProjectHelper2.java:542)\n        at\norg.apache.tools.ant.helper.ProjectHelper2$RootHandler.startElement(ProjectHelper2.java:437)\n        at org.apache.xerces.parsers.AbstractSAXParser.startElement(Unknown Source)\n        at\norg.apache.xerces.impl.XMLNSDocumentScannerImpl.scanStartElement(Unknown Source)\n        at\norg.apache.xerces.impl.XMLNSDocumentScannerImpl$NSContentDispatcher.scanRootElementHook(Unknown\nSource)\n        at\norg.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown\nSource)\n        at\norg.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)\n        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\n        at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)\n        at org.apache.tools.ant.helper.ProjectHelper2.parse(ProjectHelper2.java:209)\n        ...", "attachment_id": null, "id": 61967, "creator": "kgreiner@xpediantsolutions.com", "time": "2004-08-13T20:49:26Z", "bug_id": 30660, "creation_time": "2004-08-13T20:49:26Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 30660, "text": "Created attachment 12426\nProvides improved exception message", "id": 61968, "time": "2004-08-13T20:50:30Z", "creator": "kgreiner@xpediantsolutions.com", "creation_time": "2004-08-13T20:50:30Z", "is_private": false, "attachment_id": 12426}, {"count": 2, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "text": "patch applied, thanks.", "id": 65735, "time": "2004-10-26T14:59:28Z", "bug_id": 30660, "creation_time": "2004-10-26T14:59:28Z", "is_private": false}]