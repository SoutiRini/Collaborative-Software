[{"count": 0, "tags": [], "bug_id": 31975, "attachment_id": null, "id": 66147, "time": "2004-10-29T21:22:13Z", "creator": "michi@bello.engert.org", "creation_time": "2004-10-29T21:22:13Z", "is_private": false, "text": "Luiz Fernando wrote an article in the Full-Disclosure Mailing List (see:\nhttp://archives.neohapsis.com/archives/fulldisclosure/2004-09/0547.html),\npublishing a PoC how to crash htpasswd. This could become a problem, if\nhtpasswd is run suid root with user supplied arguments at the command line.\n\nLarry Cashdollar <lwc@vapid.ath.cx> replied to this message via BUQTRAQ, giving\na patch, which replaces all calls to strcpy() with calls to strncpy(). Looking\nat the code, I found that this wasn't neccessary, because the strcpy()-calls in\nthe original are protected by if-statements. Well, almost all strcpy()-calls are\nprotected. At one place the protecting if-statement slipped into another one,\nbecoming useless in some situations.\n\nSo I created this little patch against src/support/htpasswd.c shipped with\napache-1.3.33.tar.gz:\n\n--- cut --- cut --- cut ---\n--- src/support/htpasswd.c.orig\tFri Feb 20 23:02:24 2004\n+++ src/support/htpasswd.c\tFri Oct 29 21:13:36 2004\n@@ -411,11 +411,11 @@\n \t    return ERR_OVERFLOW;\n \t}\n \tstrcpy(pwfilename, argv[i]);\n-\tif (strlen(argv[i + 1]) > (sizeof(user) - 1)) {\n-\t    fprintf(stderr, \"%s: username too long (>%lu)\\n\", argv[0],\n-\t\t    (unsigned long)(sizeof(user) - 1));\n-\t    return ERR_OVERFLOW;\n-\t}\n+    }\n+    if (strlen(argv[i + 1]) > (sizeof(user) - 1)) {\n+\tfprintf(stderr, \"%s: username too long (>%lu)\\n\", argv[0],\n+\t\t(unsigned long)(sizeof(user) - 1));\n+\treturn ERR_OVERFLOW;\n     }\n     strcpy(user, argv[i + 1]);\n     if ((arg = strchr(user, ':')) != NULL) {\n--- cut --- cut --- cut ---\n\nLarry told us, that there is a nessus plugin which recognizes this buffer\noverflow and recommends an update to apache httpd 1.3.32. But I couldn't find a\ncorresponding entry in the bug database. :-( Comparing the versions 1.3.31,\n1.3.32 and 1.3.33, I found no differences between the files. ..."}, {"count": 1, "attachment_id": null, "bug_id": 31975, "text": "Apache HTTP Server 1.3.x is not supported anymore and no bugs will be fixed in the old codebase (cf. <http://mail-archives.apache.org/mod_mbox/httpd-announce/201002.mbox/%3C20100203000334.GA19021@infiltrator.stdlib.net%3E>). Since this bug seems to affect only 1.3.x, I'm closing it as WONTFIX.\n\nIf this bug still affects you in a recent version (version 2.2.x or the upcoming version 2.4), please open a new bug.\n\nThank you for reporting the bug.", "id": 145154, "time": "2011-03-21T11:01:17Z", "creator": "mss@apache.org", "creation_time": "2011-03-21T11:01:17Z", "tags": [], "is_private": false}]