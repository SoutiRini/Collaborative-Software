[{"count": 0, "tags": [], "bug_id": 11603, "text": "With a deployment descriptor like this:\n<web-app>\n  <welcome-file-list>\n    <welcome-file>/index.jsp</welcome-file>\n  </welcome-file-list>\n  <security-constraint>\n    <web-resource-collection>\n      <web-resource-name>Block POSTs to /showMessage.jsp</web-resource-name>\n      <url-pattern>/showMessage.jsp</url-pattern>\n      <http-method>POST</http-method>\n    </web-resource-collection>\n  </security-constraint>\n  <login-config>\n    <auth-method>FORM</auth-method>\n    <form-login-config>\n      <form-login-page>/loginForm.jsp</form-login-page>\n      <form-error-page>/loginError.jsp</form-error-page>\n    </form-login-config>\n  </login-config>\n</web-app>\n\n...no one should be able to POST to /showMessage.jsp. However, if an \nunauthenticated user makes such a POST, they will be sent through the login \nform, ending up with a redirect which results in a GET for /showMessage.jsp. \nTomcat fails to recognize this request as a POST and allows the user to \nperform the GET. This is a problem because you can't effectively block access \nbased on http-methods other than GET. All a user need do is make sure they \naren't logged in before they make such a request, and the container will \nexecute their request as if it was a GET. Of course, it is a GET in the end, \nbut I think it needs to be interpreted by the container as being of the same \nmethod that caused the trip through the login sequence (i.e. use \nSavedRequest.getMethod() instead of the method from the current request when \nchecking for authorization).\n\nThis would be a major problem if someone wanted to block POST (or any method \nbesides GET) requests to their application or a part of their application.\n\nThe URL I included in this bug report will allow you to download a test \napplication that demonstrates this problem.", "id": 20868, "time": "2002-08-10T10:28:14Z", "creator": "max@maxcooper.com", "creation_time": "2002-08-10T10:28:14Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 11603, "attachment_id": null, "is_private": false, "id": 20869, "time": "2002-08-10T10:59:42Z", "creator": "max@maxcooper.com", "creation_time": "2002-08-10T10:59:42Z", "text": "The demonstration app is posted and available now.\n\nIt turns out this isn't as much of a problem as I originally thought. It seems \nthe request parameters are not available once you get to the destination page. \nThat makes this much less of a problem, but I would still expect to get a 403 \nerror than to see the page with my POSTed parameters missing.\n\nAlso, I did not include an <auth-constriant> in the web.xml that I posted in \nthe original report. There is no cause for the container to block access \nwithout this. The behavior is the same whether the auth-contraint tag is empty \n(i.e. no access is allowed) or there is a role that the user does not have. \nThis behavior seems correct."}, {"count": 2, "tags": [], "text": "Typo - <auth-constraint>", "is_private": false, "id": 20890, "creator": "max@maxcooper.com", "time": "2002-08-11T22:46:08Z", "bug_id": 11603, "creation_time": "2002-08-11T22:46:08Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "max@maxcooper.com", "is_private": false, "text": "I tested WebLogic 6.1 sp2 and it does the same thing that Tomcat does. It \nallows the GET after you login (that I think should be interpreted as a POST) \nbut does not inlcude the POSTed parameters. The servlet spec document does not \ncover this issue, but it does seem like a 403 response is most appropriate.", "id": 20894, "time": "2002-08-12T01:00:45Z", "bug_id": 11603, "creation_time": "2002-08-12T01:00:45Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 11603, "attachment_id": null, "id": 50019, "time": "2004-01-04T19:30:24Z", "creator": "medthomas@ntlworld.com", "creation_time": "2004-01-04T19:30:24Z", "is_private": false, "text": "*** Bug 13258 has been marked as a duplicate of this bug. ***"}, {"count": 5, "tags": [], "bug_id": 11603, "attachment_id": null, "text": "The duplicate bug explains why this can't be fixed.\n\n*** This bug has been marked as a duplicate of 20816 ***", "id": 50020, "time": "2004-01-04T19:31:56Z", "creator": "medthomas@ntlworld.com", "creation_time": "2004-01-04T19:31:56Z", "is_private": false}]