[{"count": 0, "tags": [], "text": "Hello, I've a problem with Apache 2.0.46/2.0.47 and mod_deflate under Linux. I \nuse ColdFusion MX to generate dynamic HTML pages, and these pages have to be \ncompressed using mod_deflate. Most of the time, it works fine.\nBut sometimes, there's a problem: the pages are not entirely transmitted to the \nweb browser.\nThis problem happens randomly: the same page can be transmitted completely one \ntime, and be truncated the next time. Even the place of the truncation in the \nsource is random.\nWhen mod_deflate is disconnected, I don't have the problem anyway. And the logs \ntell me that the sizes of compressed and uncompressed files are good.\nDo you have an idea to resolve this problem?\n\nGilles GUILLAUD.", "is_private": false, "bug_id": 21955, "id": 41703, "time": "2003-07-29T08:56:50Z", "creator": "gguillaud@cegid.fr", "creation_time": "2003-07-29T08:56:50Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 21955, "attachment_id": null, "id": 44133, "time": "2003-09-12T21:05:39Z", "creator": "brandon@mail.voyager.com", "creation_time": "2003-09-12T21:05:39Z", "is_private": false, "text": "This problem is also experienced on our site using standard CGI (compiled C) and \nmod_deflate.  Hundreds to thousands of visitors are reporting it (after an \nupgrade from Apache 1.3.2[78] to Apache 2.0.47) and transition from mod_gzip to \nmod_deflate.\n\nAdditional sidenote:  Our upgrade was performed when we began suddenly \nencountering problems with users staying connected to v1.3.27, halted in \nwritev()'s as if they had paused their connections, and using up the available \nserver slots.  The Timeout setting did not seem to affect them, and they would \noften remain for up to 15... 20 minutes, possibly more."}, {"count": 2, "tags": [], "bug_id": 21955, "attachment_id": null, "id": 44603, "time": "2003-09-24T16:47:12Z", "creator": "michael.minichino@parago.com", "creation_time": "2003-09-24T16:47:12Z", "is_private": false, "text": "I have the same problem with JBoss/mod_jk on Sun Solaris.  Random breakage,\nrandom occurrences.  When running Apache in debug mode you see \"[info]\n(32)Broken pipe: core_output_filter: writing data to the network\" in the log\nwhen the breakage occurs."}, {"count": 3, "tags": [], "creator": "chrisn@capitalstream.com", "attachment_id": null, "id": 46067, "time": "2003-10-22T15:53:49Z", "bug_id": 21955, "creation_time": "2003-10-22T15:53:49Z", "is_private": false, "text": "I was having a problem almost exactly like this.  We are using Tomcat and were \ngetting partial pages back from the server.  It turned out that mod_deflate has \nan error which was posted to another mailing list (and supposedly fixed in \n2.0.48) which occured when a perl script printed \"\".  This would cause a blank \nbuffer to appear in the chain of output filter buffers and mod_deflate would \nattempt to compress it and generate an error (which would terminate the output \nstream).  Here is the relavant code in mod_deflate\n\nAround line 538:\n\n532,534c532,537\n<             zRC = deflate(&(ctx->stream), Z_SYNC_FLUSH);\n<             if (zRC != Z_OK) {\n<                 return APR_EGENERAL;\n---\n>             //  FIX:  ensure that stream has bytes available before attempting\n to compress\n>                       if (ctx->stream.avail_in > 0) {\n>                 zRC = deflate(&(ctx->stream), Z_SYNC_FLUSH);\n>                 if (zRC != Z_OK) {\n>                     return APR_EGENERAL;\n>                 }\n536d538\n<\n\nwe were seeing this problem all the time (esp. on larger pages and with slower \npipes) and have not heard a wisper from it for several days once this patch was \napplied."}, {"count": 4, "tags": [], "creator": "nd@perlig.de", "attachment_id": null, "id": 46068, "time": "2003-10-22T16:07:06Z", "bug_id": 21955, "creation_time": "2003-10-22T16:07:06Z", "is_private": false, "text": "Yes, such a fix will be in 2.0.48. I'm marking this report as fixed therefore.\nIf the problem after 2.0.48 still occurs, please reopen the bug.\n\nThanks folks."}]