[{"count": 0, "attachment_id": 28023, "creator": "p.mouawad@ubik-ingenierie.com", "text": "Created attachment 28023\nTest plan\n\nI think there is an issue in StringFromFile function.\nIn the docs and javadocs it is said that:\n- JMeter instantiates a copy of each function for every reference in a Sampler or elsewhere; each instance will open its own copy of the the file\n\nBut debugging the attached Test Case , I see only one instance of StringFromFile shared by the 3 threads.\nSo this leads to a buggy result.\nExpected result shoud be that each time threadNum should match file Num (not the case)\nAnd each file should be read, depending on execution some files are not read at all.", "id": 151954, "time": "2011-12-04T10:40:39Z", "bug_id": 52284, "creation_time": "2011-12-04T10:40:39Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "attachment_id": 28024, "is_private": false, "id": 151955, "time": "2011-12-04T10:41:05Z", "bug_id": 52284, "creation_time": "2011-12-04T10:41:05Z", "text": "Created attachment 28024\nRun result"}, {"count": 2, "tags": [], "bug_id": 52284, "text": "Created attachment 28025\nTest data", "id": 151956, "time": "2011-12-04T10:42:37Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2011-12-04T10:42:37Z", "is_private": false, "attachment_id": 28025}, {"count": 3, "attachment_id": null, "creator": "p.mouawad@ubik-ingenierie.com", "text": "(In reply to comment #0)\n> Created attachment 28023 [details]\n> Test plan\n> \n> I think there is an issue in StringFromFile function.\n> In the docs and javadocs it is said that:\n> - JMeter instantiates a copy of each function for every reference in a Sampler\n> or elsewhere; each instance will open its own copy of the the file\n> \nThis part is OK in fact, I mixed up Thread and multiple usage\n\n> But debugging the attached Test Case , I see only one instance of\n> StringFromFile shared by the 3 threads.\n> So this leads to a buggy result.\n> Expected result shoud be that each time threadNum should match file Num (not\n> the case)\n> And each file should be read, depending on execution some files are not read at\n> all.\n\n\nThe issue is more in Synchronisation as described in Test Plan", "id": 151959, "time": "2011-12-04T11:23:59Z", "bug_id": 52284, "creation_time": "2011-12-04T11:23:59Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "text": "Function references are only instantiated once per occurrence in the test Plan.\n\nSo if a sampler references StringFromFile, all threads will use the same instance of the function.\n\nThis allows the same data file to be shared between threads.\n\nThe file is opened once, on the first reference, so will use whatever thread number happens to run the first sample.\n\nThis is similar to how the global counter (IterationCounter) works.\n\nStringFromFile was designed to share the data across threads.\n\nCSV Dataset can be used for per-thread data files.\n\nIt would be possible to implement a per-thread version of StringFromFile by using ThreadLocal storage for the file details. However I'm not sure there's a good use case for it, given that we already have CSV Dataset.\n\nI'll update the Javadoc and function desc.", "is_private": false, "id": 152118, "creation_time": "2011-12-11T11:38:39Z", "time": "2011-12-11T11:38:39Z", "creator": "sebb@apache.org", "bug_id": 52284, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 52284, "text": "Docs updated.\n\nURL: http://svn.apache.org/viewvc?rev=1212996&view=rev\nLog:\nClarify docs (Bug 52284)\n\nModified:\n   jmeter/trunk/src/functions/org/apache/jmeter/functions/StringFromFile.java\n   jmeter/trunk/xdocs/usermanual/functions.xml", "id": 152119, "time": "2011-12-11T12:08:58Z", "creator": "sebb@apache.org", "creation_time": "2011-12-11T12:08:58Z", "is_private": false, "attachment_id": null}]