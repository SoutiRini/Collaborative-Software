[{"count": 0, "tags": [], "creator": "murthy.mvvr@caprusit.com", "attachment_id": null, "id": 138782, "time": "2010-07-31T09:36:07Z", "bug_id": 49681, "creation_time": "2010-07-31T09:36:07Z", "is_private": false, "text": "i tried to upgrade from 0.95 to 1.0 version, and getting the exception attached when generating the TIFF image.\n\nThese are my changes\n\n0.95 jars                     1.0 upgrade changes\n========================      =============================\nfop0.95.jar                   - fop1.0.jar\nxercesImpl-2.6.2.jar          - xercesImpl-2.7.1.jar\nxmlgraphics-commons-1.3.1.jar - xmlgraphics-commons-1.4.jar\n\nother Jars using \n=================\nxalan-2.7.0.jar\nbatik-all-1.7.jar\navalon-framework-4.2.0.jar\nbarcode4j-fop-ext-complete.jar\n\n\nplease help me out in this problem\n\nThanks\nMurthy"}, {"count": 1, "tags": [], "bug_id": 49681, "text": "no exception log is attached, please give further information.", "id": 138806, "time": "2010-08-02T03:08:05Z", "creator": "pascal.sancho@takoma.fr", "creation_time": "2010-08-02T03:08:05Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 49681, "is_private": false, "text": "I'm sorry that the attachment is not uploaded, sorry for the inconvenience caused.\n\nBelow is the exception\n======================\njava.lang.Error: TIFFImageEncoder4\n\tat org.apache.xmlgraphics.image.codec.tiff.TIFFImageEncoder.encode(TIFFImageEncoder.java:245)\n\tat org.apache.xmlgraphics.image.codec.tiff.TIFFImageEncoder.finishMultiple(TIFFImageEncoder.java:186)\n\tat org.apache.xmlgraphics.image.writer.internal.TIFFImageWriter$TIFFMultiImageWriter.close(TIFFImageWriter.java:206)\n\tat org.apache.fop.render.bitmap.AbstractBitmapDocumentHandler.endDocument(AbstractBitmapDocumentHandler.java:174)\n\tat org.apache.fop.render.intermediate.IFRenderer.stopRenderer(IFRenderer.java:285)\n\tat org.apache.fop.area.RenderPagesModel.endDocument(RenderPagesModel.java:256)\n\tat org.apache.fop.area.AreaTreeHandler.endDocument(AreaTreeHandler.java:309)\n\tat org.apache.fop.fo.FOTreeBuilder.endDocument(FOTreeBuilder.java:164)\n\tat net.sf.saxon.event.ContentHandlerProxy.close(ContentHandlerProxy.java:274)\n\tat net.sf.saxon.event.ProxyReceiver.close(ProxyReceiver.java:90)\n\tat net.sf.saxon.event.ReceivingContentHandler.endDocument(ReceivingContentHandler.java:218)\n\tat org.apache.xerces.parsers.AbstractSAXParser.endDocument(Unknown Source)\n\tat org.apache.xerces.impl.XMLDocumentScannerImpl.endEntity(Unknown Source)\n\tat org.apache.xerces.impl.XMLEntityManager.endEntity(Unknown Source)\n\tat org.apache.xerces.impl.XMLEntityScanner.load(Unknown Source)\n\tat org.apache.xerces.impl.XMLEntityScanner.skipSpaces(Unknown Source)\n\tat org.apache.xerces.impl.XMLDocumentScannerImpl$TrailingMiscDispatcher.dispatch(Unknown Source)\n\tat org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)\n\tat org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n\tat org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n\tat org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\n\tat org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)\n\tat org.apache.xerces.jaxp.SAXParserImpl$JAXPSAXParser.parse(Unknown Source)\n\tat net.sf.saxon.event.Sender.sendSAXSource(Sender.java:371)\n\tat net.sf.saxon.event.Sender.send(Sender.java:185)\n\tat net.sf.saxon.IdentityTransformer.transform(IdentityTransformer.java:29)\n\n\nNote: \"xml-apis-ext-1.3.04.jar\" it is also part of core Jars\n\nThanks\nMVVR Murthy", "id": 138807, "time": "2010-08-02T04:44:51Z", "creator": "murthy.mvvr@caprusit.com", "creation_time": "2010-08-02T04:44:51Z", "attachment_id": null}, {"count": 3, "tags": [], "text": "*** Bug 49727 has been marked as a duplicate of this bug. ***", "is_private": false, "bug_id": 49681, "id": 139607, "time": "2010-09-02T02:59:19Z", "creator": "jeremias@apache.org", "creation_time": "2010-09-02T02:59:19Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "jeremias@apache.org", "attachment_id": null, "is_private": false, "id": 139608, "time": "2010-09-02T03:10:21Z", "bug_id": 49681, "creation_time": "2010-09-02T03:10:21Z", "text": "The actual exception:\n\n        case DataBuffer.TYPE_INT:\n        case DataBuffer.TYPE_FLOAT:\n            if(sampleSize[0] != 32) {\n                throw new Error(\"TIFFImageEncoder4\");\n            }\n\nUgly as hell but this has been so since TIFFImageEncoder has been introduced into Batik. Anyway, the error probably happens because INT is used as sample carrier but I assume the sample size is only 24 bits.\n\nOne change that happened from 0.95 to 1.0 was the introduction of the new intermediate format so that TIFF output is now handled by TIFFDocumentHandler instead of TIFFRenderer by default, but both classes use the same ImageWriter API from XML Graphics Commons. The default color type (RGBA) has remained the same. So I'm not sure where this comes from. I'll have to try to reproduce.\n\nA possibility in the meantime is to try different color format settings:\nhttp://xmlgraphics.apache.org/fop/1.0/output.html#bitmap-configuration"}, {"attachment_id": null, "tags": [], "creator": "jeremias@apache.org", "is_private": false, "count": 5, "id": 139609, "time": "2010-09-02T03:21:27Z", "bug_id": 49681, "creation_time": "2010-09-02T03:21:27Z", "text": "Ok, on my side, the ImageIO implementation for ImageWriter is used which doesn't show this problem. If I disable the ImageIO implementation the internal codec becomes active and fails on the default configuration settings with said exception. Now, the question is why the ImageIO implementation isn't used. Maybe it has to do with Bug 49696 but I don't really think so. So my next question:\n\nWhat JVM are running this on so you get this result? That might help me figure out why the internal codecs are selected over the ImageIO implementations.\n\nIn this light, another work-around presents itself:\nIn xmlgraphics-commons.jar you can edit\nMETA-INF/services/org.apache.xmlgraphics.image.writer.ImageWriter\nand remove the following entries:\norg.apache.xmlgraphics.image.writer.internal.PNGImageWriter\norg.apache.xmlgraphics.image.writer.internal.TIFFImageWriter\norg.apache.xmlgraphics.image.writer.internal.JPEGImageWriter"}, {"count": 6, "tags": [], "creator": "jeremias@apache.org", "attachment_id": null, "text": "Should have thought about it earlier. We're talking about TIFF export, so another work-around: Install JAI ImageIO Tools to give ImageIO a TIFF codec which it hasn't by default.\n\nhttp://jai-imageio.dev.java.net/\n\nSo, I guess that's an important clue. Could it be that you had JAI ImageIO Tools installed but didn't add that when upgrading to FOP 1.0? Otherwise, I still can't explain that the error should have appeared when switching to FOP 1.0.", "id": 139610, "time": "2010-09-02T03:36:12Z", "bug_id": 49681, "creation_time": "2010-09-02T03:36:12Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 49681, "text": "(In reply to comment #6)\n> Should have thought about it earlier. We're talking about TIFF export, so\n> another work-around: Install JAI ImageIO Tools to give ImageIO a TIFF codec\n> which it hasn't by default.\n> http://jai-imageio.dev.java.net/\n> So, I guess that's an important clue. Could it be that you had JAI ImageIO\n> Tools installed but didn't add that when upgrading to FOP 1.0? Otherwise, I\n> still can't explain that the error should have appeared when switching to FOP\n> 1.0.\n\nHi Maerki,\n\tYes you are right, JAI ImageIO tools were missing from my classpath which results in error.\n\tAfter placing the JAI ImageIO tool, able to generate the TIFF successfully.\n\t\n\tThanks for all your help.\n\nThanks\nMurthy", "id": 139702, "time": "2010-09-05T02:31:43Z", "creator": "murthy.mvvr@caprusit.com", "creation_time": "2010-09-05T02:31:43Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 49681, "text": "I am getting this error using the below ANT task.\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project name=\"FOPAnt\" default=\"generate-pdf-from-transform\" basedir=\".\">\n\n\t<property name=\"fop.home\" value=\"D:\\Dev\\Java\\libraries\\fop-1.0-bin\\fop-1.0\"/>\n\t\n\t<taskdef name=\"fop\" classname=\"org.apache.fop.tools.anttasks.Fop\">\n\t  <classpath>\n\t    <fileset dir=\"${fop.home}/lib\">\n\t      <include name=\"*.jar\"/>\n\t    </fileset>\n\t    <fileset dir=\"${fop.home}/build\">\n\t      <include name=\"*.jar\"/>\n\t    </fileset>\n\t    \n\t  </classpath>\n\t</taskdef>\t\n\t\n\t\n<target name=\"generate-pdf-from-transform\" description=\"Generates a single PDF file from an XSLT stylesheet\">\n     \n   <fop format=\"image/tiff\" force=\"true\" userconfig=\"D:\\Dev\\Java\\FopConverter\\workspace\\FopConverterService\\fop.xconf\"\n        xmlfile=\"D:\\Dev\\Java\\FopConverter\\workspace\\TestFiles\\EDIS_SCIDischarge.xml\"\n        xsltfile=\"D:\\Dev\\Java\\FopConverter\\workspace\\Stylesheets\\EDIS.fo\"\n        outfile=\"D:\\Dev\\Java\\FopConverter\\workspace\\FopConverterService\\something.tif\" />     \n        \n</target>\n</project>\n\n\n\nAs you can see, the contents of D:\\Dev\\Java\\libraries\\fop-1.0-bin\\fop-1.0\\build are included in the CLASSPATH, which includes jai_imageio.jar", "id": 150579, "time": "2011-10-14T16:21:31Z", "creator": "marc.lang@ggc.scot.nhs.uk", "creation_time": "2011-10-14T16:21:31Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "gadams@apache.org", "text": "batch transition to closed; if someone wishes to restore one of these to resolved in order to perform a verification step, then feel free to do so", "count": 9, "id": 155485, "time": "2012-04-01T06:18:40Z", "bug_id": 49681, "creation_time": "2012-04-01T06:18:40Z", "is_private": false}]