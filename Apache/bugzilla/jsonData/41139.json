[{"count": 0, "tags": [], "bug_id": 41139, "is_private": false, "text": "1)Following is the detail excepion\n[WARNING] Unknown Ptg 2d (45)\njava.lang.reflect.InvocationTargetException\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native \nMethod)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown \nSource)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown \nSource)\n\tat java.lang.reflect.Constructor.newInstance(Unknown Source)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java:224)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java:160)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:163)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:130)\n\tat test.Test.parsingToRawContent(Test.java:70)\n\tat test.Test.main(Test.java:313)\nCaused by: java.lang.ArrayIndexOutOfBoundsException\n\tat java.lang.System.arraycopy(Native Method)\n\tat org.apache.poi.hssf.record.UnknownRecord.<init>\n(UnknownRecord.java:62)\n\tat org.apache.poi.hssf.record.SubRecord.createSubRecord\n(SubRecord.java:57)\n\tat org.apache.poi.hssf.record.ObjRecord.fillFields(ObjRecord.java:99)\n\tat org.apache.poi.hssf.record.Record.fillFields(Record.java:90)\n\tat org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n\tat org.apache.poi.hssf.record.ObjRecord.<init>(ObjRecord.java:61)\n\t... 10 more\nException in thread \"main\" org.apache.poi.hssf.record.RecordFormatException: \nUnable to construct record instance, the following exception occured: null\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java:237)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java:160)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:163)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:130)\n\tat test.Test.parsingToRawContent(Test.java:70)\n\tat test.Test.main(Test.java:313)\n---------------------------------------------------------------\nMy code is quite simple:\nPOIFSFileSystem fs      =\n            new POIFSFileSystem(new FileInputStream(fileName));\nHSSFWorkbook wb = new HSSFWorkbook(fs);\n\n2)While I use the old version of POI to parse same excel file,\nalthough it will display warning message like \"[WARNING] Unknown Ptg 2d (45)\"\nbut at least it can parse the content, but It looks like that it always threw \nOutOfMemoryError while parsing the large xls file.", "id": 96681, "time": "2006-12-08T18:23:04Z", "creator": "zealz@cn.lenovo.com", "creation_time": "2006-12-08T18:23:04Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 41139, "attachment_id": 19234, "id": 96682, "time": "2006-12-08T18:35:33Z", "creator": "zealz@cn.lenovo.com", "creation_time": "2006-12-08T18:35:33Z", "is_private": false, "text": "Created attachment 19234\nThe testing xls file which cause exception"}, {"count": 2, "tags": [], "bug_id": 41139, "text": "I have run into the same bug (UnknownRecord throwing an\nArrayIndexOutOfBoundsException), and here is a possible solution\nChange the 3rd constructor to read:\n    public UnknownRecord( short id, short size, byte[] data, int offset )\n    {\n        sid     = id;\n\n        // ObjRecord's fillFields was getting an obviously wrong subRecordSize,\n        // which it passes to SubRecord.createSubRecord, which passes the value\n        // here as \"size\".\n        //\n        // Instead of allowing an ArrayIndexOutOfBoundsException \n        //   to happen, let's change the size if appropriate.\n        if ( size > (data.length - offset) ) {\n          size = (short)(data.length - offset);\n        }\n\n        thedata = new byte[size];\n\n        System.arraycopy(data, offset, thedata, 0, size);\n    }\nIt could be argued that this is just patching the real problem; the real\nproblem is that we have bogus length/size for some Unknown record type\nin Excel.\n", "id": 101389, "time": "2007-04-03T14:00:17Z", "creator": "steveknoll@yahoo.com", "creation_time": "2007-04-03T14:00:17Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 41139, "attachment_id": null, "id": 113007, "time": "2008-01-19T06:53:21Z", "creator": "yegor@dinom.ru", "creation_time": "2008-01-19T06:53:21Z", "is_private": false, "text": "Works with POI-3.0.2-BETA2.\n\nRegards,\nYegor"}]