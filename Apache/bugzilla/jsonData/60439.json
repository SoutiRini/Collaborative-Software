[{"count": 0, "tags": [], "creator": "c.liranzi@netforger.net", "attachment_id": null, "id": 195332, "creation_time": "2016-12-02T09:49:32Z", "time": "2016-12-02T09:49:32Z", "bug_id": 60439, "text": "Hey guys,\n\nwe use Apache for loadbalancing on production, after updating httpd to the latest release we get a lot of Segmentation faults. \n\n**** version ****\n\nLinux debian 8.6 3.16.0-4-amd64 #1 SMP Debian 3.16.36-1+deb8u2 (2016-10-19) x86_64 GNU/Linux\n\nServer version: Apache/2.4.23 (Unix)\nServer built:   Sep 13 2016 08:22:30\nServer's Module Magic Number: 20120211:61\nServer loaded:  APR 1.5.2, APR-UTIL 1.5.4\nCompiled using: APR 1.5.2, APR-UTIL 1.5.4\nArchitecture:   64-bit\nServer MPM:     worker\n  threaded:     yes (fixed thread count)\n    forked:     yes (variable process count)\nServer compiled with....\n -D APR_HAS_SENDFILE\n -D APR_HAS_MMAP\n -D APR_HAVE_IPV6 (IPv4-mapped addresses enabled)\n -D APR_USE_SYSVSEM_SERIALIZE\n -D APR_USE_PTHREAD_SERIALIZE\n -D SINGLE_LISTEN_UNSERIALIZED_ACCEPT\n -D APR_HAS_OTHER_CHILD\n -D AP_HAVE_RELIABLE_PIPED_LOGS\n -D DYNAMIC_MODULE_LIMIT=256\n -D HTTPD_ROOT=\"/opt/build/loadbalancer/apache\"\n -D SUEXEC_BIN=\"/opt/build/loadbalancer/apache/bin/suexec\"\n -D DEFAULT_PIDLOG=\"logs/httpd.pid\"\n -D DEFAULT_SCOREBOARD=\"logs/apache_runtime_status\"\n -D DEFAULT_ERRORLOG=\"logs/error_log\"\n -D AP_TYPES_CONFIG_FILE=\"conf/mime.types\"\n -D SERVER_CONFIG_FILE=\"conf/httpd.conf\"\n**** version ****\n\n**** coredump ****\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\nCore was generated by `/opt/build/loadbalancer/apache/bin/httpd -k start'.\nProgram terminated with signal SIGSEGV, Segmentation fault.\n#0  allocator_alloc (in_size=in_size@entry=8152, allocator=0x0) at /opt/build/loadbalancer/../unpack/apr-1.5.2/memory/unix/apr_pools.c:241\n241\t/opt/build/loadbalancer/../unpack/apr-1.5.2/memory/unix/apr_pools.c: No such file or directory.\n(gdb) Bt full \n#0  allocator_alloc (in_size=in_size@entry=8152, allocator=0x0) at /opt/build/loadbalancer/../unpack/apr-1.5.2/memory/unix/apr_pools.c:241\n        node = <optimized out>\n        ref = <optimized out>\n        max_index = <optimized out>\n        i = <optimized out>\n        size = 8192\n        index = <optimized out>\n#1  apr_allocator_alloc (allocator=0x0, size=size@entry=8152) at /opt/build/loadbalancer/../unpack/apr-1.5.2/memory/unix/apr_pools.c:438\nNo locals.\n#2  0x00007f5db8f9a7ae in apr_bucket_alloc (size=96, size@entry=64, list=0x7f5d740d1658) at /opt/build/loadbalancer/../unpack/apr-util-1.5.4/buckets/apr_buckets_alloc.c:140\n        node = <optimized out>\n        active = 0x7f5d64086db0\n        endp = <optimized out>\n#3  0x00007f5db8f9b4da in apr_bucket_simple_copy (a=a@entry=0x7f5d740d1a58, b=b@entry=0x7f5db0c8db98) at /opt/build/loadbalancer/../unpack/apr-util-1.5.4/buckets/apr_buckets_simple.c:22\nNo locals.\n#4  0x00007f5db8f9b586 in apr_bucket_simple_split (a=0x7f5d740d1a58, point=0) at /opt/build/loadbalancer/../unpack/apr-util-1.5.4/buckets/apr_buckets_simple.c:37\n        b = 0x7f5db8b5446a <apr_socket_sendv+138>\n        point = 0\n        a = 0x7f5d740d1a58\n#5  0x00007f5db8f9b43a in apr_bucket_shared_split (a=<optimized out>, point=<optimized out>) at /opt/build/loadbalancer/../unpack/apr-util-1.5.4/buckets/apr_buckets_refcount.c:25\n        r = 0x7f5d740d1698\n        rv = -1\n#6  0x00000000004483c7 in writev_nonblocking (s=0x7f5dac10c1d0, vec=0x7f5db0c8dca0, nvec=11, bb=0x7f5dac10c980, cumulative_bytes_written=0x7f5dac10c8a8, c=0x7f5dac10c3e8)\n    at /opt/build/unpack/httpd-2.4.23/server/core_filters.c:801\n        bucket = 0x7f5d740d1a58\n        n = 0\n        rv = 0\n        arv = <optimized out>\n        bytes_written = <optimized out>\n        bytes_to_write = 22832\n        i = 8\n        offset = 8\n        old_timeout = 720000000\n#7  0x00000000004484cc in send_brigade_nonblocking (s=0x0, bb=0x7f5dac10c980, bytes_written=0x7f5d64087578, c=0x7f5d64087618) at /opt/build/unpack/httpd-2.4.23/server/core_filters.c:704\n        vec = {{iov_base = 0x7f5d54066c68, iov_len = 4086}, {iov_base = 0x7f5d44036b18, iov_len = 4106}, {iov_base = 0x47c2ca, iov_len = 2}, {iov_base = 0x7f5d54079218, iov_len = 6}, {\n            iov_base = 0x7f5d5406ac88, iov_len = 3886}, {iov_base = 0x7f5d44040b68, iov_len = 4306}, {iov_base = 0x47c2ca, iov_len = 2}, {iov_base = 0x7f5d54079998, iov_len = 6}, {iov_base = 0x10d2, \n            iov_len = 3694}, {iov_base = 0x0, iov_len = 2736}, {iov_base = 0x47c2ca, iov_len = 2}, {iov_base = 0x7f5d54079e98, iov_len = 6}, {iov_base = 0x7f5d44042b78, iov_len = 4286}, {\n            iov_base = 0x7f5d4c088dd8, iov_len = 3906}, {iov_base = 0x47c2ca, iov_len = 2}, {iov_base = 0x7f5d5407a938, iov_len = 6}}\n        nvec = 11\n#8  0x00000000004491e1 in send_brigade_blocking (c=<optimized out>, bytes_written=<optimized out>, bb=<optimized out>, s=<optimized out>) at /opt/build/unpack/httpd-2.4.23/server/core_filters.c:733\nNo locals.\n#9  ap_core_output_filter (f=0x0, new_bb=0x7f5dac10c980) at /opt/build/unpack/httpd-2.4.23/server/core_filters.c:542\n        c = 0x7f5dac10c3e8\n        bytes_in_brigade = 0\n        non_file_bytes_in_brigade = 0\n        eor_buckets_in_brigade = 1678275960\n        morphing_bucket_in_brigade = 8152\n#10 0x00000000004626b1 in ap_process_request (r=0x7f5d4c090e70) at /opt/build/unpack/httpd-2.4.23/modules/http/http_request.c:451\n        bb = 0x7f5dac10c980\n        c = 0x7f5dac10c3e8\n        rv = -1\n#11 0x000000000045e9b5 in ap_process_http_sync_connection (c=0x7f5dac10c3e8) at /opt/build/unpack/httpd-2.4.23/modules/http/http_core.c:210\n        keep_alive_timeout = 5000000\n        r = 0x7f5d4c090e70\n        cs = 0x0\n        csd = 0x0\n        mpm_state = 0\n#12 ap_process_http_connection (c=0x7f5dac10c3e8) at /opt/build/unpack/httpd-2.4.23/modules/http/http_core.c:251\nNo locals.\n---Type <return> to continue, or q <return> to quit---#13 0x0000000000456d30 in ap_run_process_connection (c=0x7f5dac10c3e8) at /opt/build/unpack/httpd-2.4.23/server/connection.c:42\n        pHook = <optimized out>\n        n = 0\n        rv = -1\n#14 0x0000000000468f81 in process_socket (bucket_alloc=<optimized out>, my_thread_num=<optimized out>, my_child_num=<optimized out>, sock=<optimized out>, p=<optimized out>, thd=<optimized out>)\n    at /opt/build/unpack/httpd-2.4.23/server/mpm/worker/worker.c:631\n        current_conn = 0x7f5dac10c3e8\n        conn_id = 140040295465960\n        sbh = 0x7f5dac10c3e0\n#15 worker_thread (thd=0x0, dummy=0x1fd8) at /opt/build/unpack/httpd-2.4.23/server/mpm/worker/worker.c:992\n        process_slot = 8\n        thread_slot = 0\n        csd = 0x7f5dac10c1d0\n        bucket_alloc = 0x9\n        last_ptrans = 0x7f5dac10c3e8\n        ptrans = 0x7f5dac10c148\n        is_idle = -1408187952\n#16 0x00007f5db84e10a4 in start_thread (arg=0x7f5db0c8e700) at pthread_create.c:309\n        __res = <optimized out>\n        pd = 0x7f5db0c8e700\n        now = <optimized out>\n        unwind_buf = {cancel_jmp_buf = {{jmp_buf = {140040374642432, -8558836165728189939, 0, 140040520843360, 64, 140040374642432, 8611874569776611853, 8611893242517733901}, mask_was_saved = 0}}, priv = {\n            pad = {0x0, 0x0, 0x0, 0x0}, data = {prev = 0x0, cleanup = 0x0, canceltype = 0}}}\n        not_first_call = <optimized out>\n        pagesize_m1 = <optimized out>\n        sp = <optimized out>\n        freesize = <optimized out>\n        __PRETTY_FUNCTION__ = \"start_thread\"\n#17 0x00007f5db801262d in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:111\nNo locals.\n**** coredump ****", "is_private": false}, {"count": 1, "tags": [], "creator": "wrowe@apache.org", "attachment_id": null, "text": "Just to confirm, you have installed all -debuginfo / -dbg packages for httpd and apr/apr-util applicable to your environment? If this is your own build, ensure you are building with -g for symbolic references.\n\nIt might be useful to try reproducing this with an -O0 -g build of httpd/apr/apr-util where the various references haven't been optimized away.", "id": 195338, "time": "2016-12-02T17:53:05Z", "bug_id": 60439, "creation_time": "2016-12-02T17:53:05Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 60439, "text": "Thank you for the feedback. We don't build ours httpd with -g. We make an new build and waiting of the next segfault.", "id": 195361, "time": "2016-12-05T12:20:34Z", "creator": "c.liranzi@netforger.net", "creation_time": "2016-12-05T12:20:34Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 60439, "attachment_id": null, "id": 195489, "time": "2016-12-14T15:33:52Z", "creator": "c.liranzi@netforger.net", "creation_time": "2016-12-14T15:33:52Z", "is_private": false, "text": "Hey guys,\n\nwe have today an segfault on our infrastructure. I hope the new dump is more helpful.\n\n**** coredump ****\n\nCore was generated by `/opt/build/loadbalancer/apache/bin/httpd -k start'.\nProgram terminated with signal SIGSEGV, Segmentation fault.\n#0  0x0000000000454ac1 in ap_add_common_vars (r=0x0) at /opt/build/unpack/httpd-2.4.23/server/util_script.c:197\n197\t            if (conf->cgi_pass_auth == AP_CGI_PASS_AUTH_ON) {\n(gdb) frame 0\n#0  0x0000000000454ac1 in ap_add_common_vars (r=0x0) at /opt/build/unpack/httpd-2.4.23/server/util_script.c:197\n197\t            if (conf->cgi_pass_auth == AP_CGI_PASS_AUTH_ON) {\n(gdb) list\n192\t         * in the environment with \"ps -e\".  But, if you must...\n193\t         */\n194\t#ifndef SECURITY_HOLE_PASS_AUTHORIZATION\n195\t        else if (!strcasecmp(hdrs[i].key, \"Authorization\")\n196\t                 || !strcasecmp(hdrs[i].key, \"Proxy-Authorization\")) {\n197\t            if (conf->cgi_pass_auth == AP_CGI_PASS_AUTH_ON) {\n198\t                add_unless_null(e, http2env(r, hdrs[i].key), hdrs[i].val);\n199\t            }\n200\t        }\n201\t#endif\n(gdb) bt\n#0  0x0000000000454ac1 in ap_add_common_vars (r=0x0) at /opt/build/unpack/httpd-2.4.23/server/util_script.c:197\n#1  0x0000000000000006 in ?? ()\n#2  0x00007f5c4c068cd8 in ?? ()\n#3  0x00000000000003ea in ?? ()\n#4  0x00007f5c2c088d78 in ?? ()\n#5  0x0000000000001c16 in ?? ()\n#6  0x0000000000499592 in ?? ()\n#7  0x0000000000000002 in ?? ()\n#8  0x00007f5c2c08d678 in ?? ()\n#9  0x0000000000000006 in ?? ()\n#10 0x00007f5c38004928 in ?? ()\n#11 0x0000000000000322 in ?? ()\n#12 0x00007f5c4c060c68 in ?? ()\n#13 0x0000000000001cde in ?? ()\n#14 0x0000000000499592 in ?? ()\n#15 0x0000000000000002 in ?? ()\n#16 0x00007f5c2c08ddf8 in ?? ()\n#17 0x0000000000000006 in ?? ()\n#18 0x00007f5c4c078d58 in ?? ()\n#19 0x000000000000025a in ?? ()\n#20 0x00007f5c4c072d28 in ?? ()\n#21 0x0000000000001da6 in ?? ()\n#22 0x0000000000499592 in ?? ()\n#23 0x0000000000000002 in ?? ()\n#24 0x00007f5c4c075558 in ?? ()\n#25 0x0000000000000004 in ?? ()\n#26 0x00007f5c38006938 in ?? ()\n#27 0x00000000000004b2 in ?? ()\n#28 0x0000000178fd0c60 in ?? ()\n#29 0x00007f5c78fd0bb0 in ?? ()\n#30 0x000000000000000f in ?? ()\n#31 0x00000000900dc0b8 in ?? ()\n#32 0x2064656e696c6365 in ?? ()\n#33 0x00007f5c440e62b8 in ?? ()\n#34 0x00007f5c78fd0c70 in ?? ()\n#35 0x0000000000454d72 in ap_add_common_vars (r=0x1b4e) at /opt/build/unpack/httpd-2.4.23/server/util_script.c:282\n---Type <return> to continue, or q <return> to quit--- \n#36 0x00000000004544c2 in getsfunc_BRIGADE (buf=<optimized out>, len=<optimized out>, arg=<optimized out>) at /opt/build/unpack/httpd-2.4.23/server/util_script.c:756\n#37 0x00007f5c78fd0cd0 in ?? ()\n#38 0x00007f5c900dc070 in ?? ()\n#39 0x00007f5c900dbcc8 in ?? ()\n#40 0x0000000000000000 in ?? ()\n(gdb) bt full\n#0  0x0000000000454ac1 in ap_add_common_vars (r=0x0) at /opt/build/unpack/httpd-2.4.23/server/util_script.c:197\n        e = 0x0\n        s = 0x7f5c900dc2c0\n        c = 0x7f5c900dbab0\n        conf = 0x7f5c900dc188\n        env_temp = <optimized out>\n        hdrs_arr = 0x7f5c78fd1700\n        hdrs = <optimized out>\n        i = -1642676128\n        rport = <optimized out>\n        q = <optimized out>\n#1  0x0000000000000006 in ?? ()\nNo symbol table info available.\n#2  0x00007f5c4c068cd8 in ?? ()\nNo symbol table info available.\n#3  0x00000000000003ea in ?? ()\nNo symbol table info available.\n#4  0x00007f5c2c088d78 in ?? ()\nNo symbol table info available.\n#5  0x0000000000001c16 in ?? ()\nNo symbol table info available.\n#6  0x0000000000499592 in ?? ()\nNo symbol table info available.\n#7  0x0000000000000002 in ?? ()\nNo symbol table info available.\n#8  0x00007f5c2c08d678 in ?? ()\nNo symbol table info available.\n#9  0x0000000000000006 in ?? ()\nNo symbol table info available.\n#10 0x00007f5c38004928 in ?? ()\nNo symbol table info available.\n#11 0x0000000000000322 in ?? ()\nNo symbol table info available.\n#12 0x00007f5c4c060c68 in ?? ()\nNo symbol table info available.\n#13 0x0000000000001cde in ?? ()\n---Type <return> to continue, or q <return> to quit---\nNo symbol table info available.\n#14 0x0000000000499592 in ?? ()\nNo symbol table info available.\n#15 0x0000000000000002 in ?? ()\nNo symbol table info available.\n#16 0x00007f5c2c08ddf8 in ?? ()\nNo symbol table info available.\n#17 0x0000000000000006 in ?? ()\nNo symbol table info available.\n#18 0x00007f5c4c078d58 in ?? ()\nNo symbol table info available.\n#19 0x000000000000025a in ?? ()\nNo symbol table info available.\n#20 0x00007f5c4c072d28 in ?? ()\nNo symbol table info available.\n#21 0x0000000000001da6 in ?? ()\nNo symbol table info available.\n#22 0x0000000000499592 in ?? ()\nNo symbol table info available.\n#23 0x0000000000000002 in ?? ()\nNo symbol table info available.\n#24 0x00007f5c4c075558 in ?? ()\nNo symbol table info available.\n#25 0x0000000000000004 in ?? ()\nNo symbol table info available.\n#26 0x00007f5c38006938 in ?? ()\nNo symbol table info available.\n#27 0x00000000000004b2 in ?? ()\nNo symbol table info available.\n#28 0x0000000178fd0c60 in ?? ()\nNo symbol table info available.\n#29 0x00007f5c78fd0bb0 in ?? ()\nNo symbol table info available.\n#30 0x000000000000000f in ?? ()\nNo symbol table info available.\n#31 0x00000000900dc0b8 in ?? ()\n---Type <return> to continue, or q <return> to quit---\nNo symbol table info available.\n#32 0x2064656e696c6365 in ?? ()\nNo symbol table info available.\n#33 0x00007f5c440e62b8 in ?? ()\nNo symbol table info available.\n#34 0x00007f5c78fd0c70 in ?? ()\nNo symbol table info available.\n#35 0x0000000000454d72 in ap_add_common_vars (r=0x1b4e) at /opt/build/unpack/httpd-2.4.23/server/util_script.c:282\n        e = 0x2\n        s = 0x7f5c900dc2c0\n        c = 0x7f5c900dbab0\n        conf = 0x7f5c900dc188\n        env_temp = 0x6e6f6974617a6972 <error: Cannot access memory at address 0x6e6f6974617a6972>\n        hdrs_arr = 0x7f5c2c08da38\n        hdrs = <optimized out>\n        i = <optimized out>\n        rport = <optimized out>\n        q = <optimized out>\n#36 0x00000000004544c2 in getsfunc_BRIGADE (buf=<optimized out>, len=<optimized out>, arg=<optimized out>) at /opt/build/unpack/httpd-2.4.23/server/util_script.c:756\n        bb = <optimized out>\n        dst_end = 0x1 <error: Cannot access memory at address 0x1>\n        dst = <optimized out>\n        e = <optimized out>\n        rv = <optimized out>\n        done = <optimized out>\n#37 0x00007f5c78fd0cd0 in ?? ()\nNo symbol table info available.\n#38 0x00007f5c900dc070 in ?? ()\nNo symbol table info available.\n#39 0x00007f5c900dbcc8 in ?? ()\nNo symbol table info available.\n#40 0x0000000000000000 in ?? ()\nNo symbol table info available.\n(gdb) list\n202\t        else\n203\t            add_unless_null(e, http2env(r, hdrs[i].key), hdrs[i].val);\n204\t    }\n205\t\n206\t    env_temp = apr_table_get(r->subprocess_env, \"PATH\");\n207\t    if (env_temp == NULL) {\n208\t        env_temp = getenv(\"PATH\");\n209\t    }\n210\t    if (env_temp == NULL) {\n211\t        env_temp = DEFAULT_PATH;\n(gdb) \n\n**** coredump ****"}, {"count": 4, "tags": [], "bug_id": 60439, "attachment_id": null, "id": 195507, "time": "2016-12-15T14:25:33Z", "creator": "amd1212@vier-ringe.at", "creation_time": "2016-12-15T14:25:33Z", "is_private": false, "text": "Today we had another segementation fault on the same server. But this time the coredump looks quite different. (I've masked possible sensitive informations using X):\n\n**** coredump ****\n#0  0x00007f5c9ce40274 in ?? ()\nNo symbol table info available.\n#1  0x00007f5c897ef5a0 in ?? ()\nNo symbol table info available.\n#2  0x00007f5c9d4b18bb in ?? ()\nNo symbol table info available.\n#3  0x00007f5c3c0d6040 in ?? ()\nNo symbol table info available.\n#4  0x000000aa81800000 in ?? ()\nNo symbol table info available.\n#5  0x00007f5c2801aa30 in ?? ()\nNo symbol table info available.\n#6  0x00007f5c30020b28 in ?? ()\nNo symbol table info available.\n#7  0x00007f5c897ef590 in ?? ()\nNo symbol table info available.\n#8  0x00007f5c9d4b208a in ?? ()\nNo symbol table info available.\n#9  0x00007f5c50109160 in ?? ()\nNo symbol table info available.\n#10 0x0000000000aa800e in ?? ()\nNo symbol table info available.\n#11 0x00007f5c48006918 in ?? ()\nNo symbol table info available.\n#12 0x0000000000c14d38 in ?? ()\nNo symbol table info available.\n#13 0x00007f5c897ef5c0 in ?? ()\nNo symbol table info available.\n#14 0x0000000000438133 in ap_vrprintf (r=0x7f5c897ef540, fmt=<optimized out>, va=<optimized out>) at /opt/unpack/httpd-2.4.23/server/protocol.c:1658\n        written = <optimized out>\n        vd = {vbuff = {\n            curpos = 0x7f5c3c0d7a08 \"=cnp_jQuery(d),s=p.attr(\\\"name\\\"),J=p.val();if(!(g&&this.isEmptyString(J))){var W=p.closest(\\\"form\\\"),\\nH={};if(s===\\\"ACCOUNT.NUMBER\\\"||s===\\\"ACCOUNT.XXXX\\\")if(this.isXXXXForm(W))this.validateXXXX(J)||(H=cnp_j\"..., endpos = 0x5a3 <error: Cannot access memory at address 0x5a3>}, r = 0x7f5c48299f24, \n          buff = 0x7f5c30020c68 \"s://\\\"+(r==\\\"live\\\"?\\\"XXXX.XXX\\\":\\\"test.XXXX.XXX\\\")+\\\"/connectors/XXX/XXXXXXXX.link\\\",jsonp:\\\"callback\\\",dataType:\\\"jsonp\\\",success:function(u){var F=cnp_jQuery(\\\"select.XXXXNameSelectBox\\\",\\\"div.otXXXXXXX_XXX\\\");F.em\"...}\n        vrprintf_buf = \"\\036!\\2XX\\2XX\\\\\\1XX\\000\\000$\\2XX)H\\\\\\1XX\\000\\000\\2XX\\n\\002\\060\\000\\000\\000\\000h\\f\\002\\0XX\\\\\\1XX\\000\\000\\001\\000\\000\\000\\000\\000\\000\\000P\\3XX~\\2XX\\\\\\1XX\\000\\000\\0XX\\0XXE\", '\\000' <repeats 17 times>, \"\\001\\000\\000\\000\\bz\\r<\\\\\\1XX\\000\\000\\b\\2XX\\001(\\\\\\1XX\\000\\000\\b\\r\\0XX\\0XX\\\\\\1XX\\000\\000\\0XX\\0XXK\\2XX\\\\\\1XX\\000\\000\\0XX\\2XX\\001(\\\\\\1XX\\000\\000\\2XX\\0XX\\000\\000\\000\\000\\000\\000#\\2XX)H\\\\\\1XX\\000\\000\\000\\000\\000\\000\\000\\000\\000\\000P\\3XX~\\2XX\\\\\\1XX\\000\\000\\b\\r\\0XX\\0XX\\\\\\1XX\\000\\000\\000\\000\\000\\000\\000\\000\\000\\000\\0XX^RX\\000\\000\\000\\000\\001\\000\\000\\000\\000\\000\\000\\000\\3XX\\2XX\\001(\\\\\\1XX\\000\\000\\3XX\\3XX~\\2XX\\\\\\1XX\\000\\000\\2XX\\3XX~\\2XX\\\\\\1XX\\000\\000\"...\n#15 0x00007f5c50109160 in ?? ()\nNo symbol table info available.\n#16 0x0000000000aa800e in ?? ()\nNo symbol table info available.\n#17 0x00007f5c897ef5e0 in ?? ()\nNo symbol table info available.\n#18 0x00007f5c9d900ec0 in ?? ()\nNo symbol table info available.\n#19 0x00007f5c897ef5f0 in ?? ()\nNo symbol table info available.\n#20 0x00007f5c501091a8 in ?? ()\nNo symbol table info available.\n#21 0x00007f5c3007ad18 in ?? ()\nNo symbol table info available.\n#22 0x00007f5c50109188 in ?? ()\nNo symbol table info available.\n#23 0x00007f5c897ef610 in ?? ()\nNo symbol table info available.\n#24 0x00007f5c9d9016e0 in ?? ()\nNo symbol table info available.\n#25 0x00007f5c897ef670 in ?? ()\nNo symbol table info available.\n#26 0x00007f5c3007adf8 in ?? ()\nNo symbol table info available.\n#27 0x00007f5c28051f98 in ?? ()\nNo symbol table info available.\n#28 0x00007f5c3007adf8 in ?? ()\nNo symbol table info available.\n#29 0x00007f5c897ef6c0 in ?? ()\nNo symbol table info available.\n#30 0x0000000000453571 in ap_open_piped_log_ex (p=0x0, program=0x7f5c9d4b2240 <error: Cannot access memory at address 0x7f5c9d4b2240>, cmdtype=<optimized out>) at /opt/unpack/httpd-2.4.23/server/log.c:1833\n        pl = 0x7f5c48006918\n#31 0x0000000000000005 in ?? ()\nNo symbol table info available.\n#32 0x0000000000000000 in ?? ()\nNo symbol table info available.\n**** coredump ****\n\n\n**** frame 14 ****\n(gdb) frame 14\n#14 0x0000000000438133 in ap_vrprintf (r=0x7f5c897ef540, fmt=<optimized out>, va=<optimized out>) at /opt/unpack/httpd-2.4.23/server/protocol.c:1658\n1658\t}\n(gdb) list\n1653\t\n1654\t        written += n;\n1655\t    }\n1656\t\n1657\t    return written;\n1658\t}\n1659\t\n1660\tAP_DECLARE_NONSTD(int) ap_rprintf(request_rec *r, const char *fmt, ...)\n1661\t{\n1662\t    va_list va;\n\n\n**** frame 30 ****\n(gdb) frame 30\n#30 0x0000000000453571 in ap_open_piped_log_ex (p=0x0, program=0x7f5c9d4b2240 <error: Cannot access memory at address 0x7f5c9d4b2240>, cmdtype=<optimized out>) at /opt/unpack/httpd-2.4.23/server/log.c:1833\n1833\t    apr_pool_cleanup_register(p, pl, piped_log_cleanup,\n(gdb) list\n1828\t    if (apr_file_pipe_create_ex(&pl->read_fd,\n1829\t                                &pl->write_fd,\n1830\t                                APR_FULL_BLOCK, p) != APR_SUCCESS) {\n1831\t        return NULL;\n1832\t    }\n1833\t    apr_pool_cleanup_register(p, pl, piped_log_cleanup,\n1834\t                              piped_log_cleanup_for_exec);\n1835\t    if (piped_log_spawn(pl) != APR_SUCCESS) {\n1836\t        apr_pool_cleanup_kill(p, pl, piped_log_cleanup);\n1837\t        apr_file_close(pl->read_fd);\n(gdb)"}, {"count": 5, "tags": [], "bug_id": 60439, "text": "Hello,\n\nWe've just got another SEGFAULT, with also a different coredump. Maybe it helps to identify the issue:\n\nGNU gdb (Debian 7.7.1+dfsg-5) 7.7.1\nCopyright (C) 2014 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\nand \"show warranty\" for details.\nThis GDB was configured as \"x86_64-linux-gnu\".\nType \"show configuration\" for configuration details.\nFor bug reporting instructions, please see:\n<http://www.gnu.org/software/gdb/bugs/>.\nFind the GDB manual and other documentation resources online at:\n<http://www.gnu.org/software/gdb/documentation/>.\nFor help, type \"help\".\nType \"apropos word\" to search for commands related to \"word\"...\nReading symbols from /opt/loadbalancer/apache/bin/httpd...done.\n[New LWP 28271]\n[New LWP 28274]\n[New LWP 28277]\n[New LWP 28278]\n[New LWP 28279]\n[New LWP 28280]\n[New LWP 28275]\n[New LWP 28281]\n[New LWP 28286]\n[New LWP 28273]\n[New LWP 28287]\n[New LWP 28289]\n[New LWP 28291]\n[New LWP 28272]\n[New LWP 28299]\n[New LWP 27530]\n[New LWP 28300]\n[New LWP 28301]\n[New LWP 28284]\n[New LWP 28283]\n[New LWP 28303]\n[New LWP 28282]\n[New LWP 28304]\n[New LWP 28276]\n[New LWP 28309]\n[New LWP 28310]\n[New LWP 28290]\n[New LWP 28311]\n[New LWP 28288]\n[New LWP 28319]\n[New LWP 28285]\n[New LWP 28321]\n[New LWP 28294]\n[New LWP 28293]\n[New LWP 28322]\n[New LWP 28292]\n[New LWP 28325]\n[New LWP 28326]\n[New LWP 28327]\n[New LWP 28329]\n[New LWP 28302]\n[New LWP 28336]\n[New LWP 28298]\n[New LWP 28297]\n[New LWP 28337]\n[New LWP 28296]\n[New LWP 28338]\n[New LWP 28295]\n[New LWP 28343]\n[New LWP 28347]\n[New LWP 28308]\n[New LWP 28350]\n[New LWP 28307]\n[New LWP 28351]\n[New LWP 28254]\n[New LWP 28306]\n[New LWP 28255]\n[New LWP 28305]\n[New LWP 28257]\n[New LWP 28320]\n[New LWP 28258]\n[New LWP 28259]\n[New LWP 28318]\n[New LWP 28261]\n[New LWP 28266]\n[New LWP 28268]\n[New LWP 28317]\n[New LWP 28270]\n[New LWP 28315]\n[New LWP 28323]\n[New LWP 28316]\n[New LWP 28324]\n[New LWP 28328]\n[New LWP 28330]\n[New LWP 28314]\n[New LWP 28331]\n[New LWP 28313]\n[New LWP 28332]\n[New LWP 28312]\n[New LWP 28333]\n[New LWP 28269]\n[New LWP 28334]\n[New LWP 28335]\n[New LWP 28267]\n[New LWP 28339]\n[New LWP 28265]\n[New LWP 28340]\n[New LWP 28341]\n[New LWP 28264]\n[New LWP 28342]\n[New LWP 28344]\n[New LWP 28345]\n[New LWP 28346]\n[New LWP 28348]\n[New LWP 28349]\n[New LWP 28352]\n[New LWP 28252]\n[New LWP 28253]\n[New LWP 28256]\n[New LWP 28260]\n[New LWP 28262]\n[New LWP 28263]\nCore was generated by `/opt/loadbalancer/apache/bin/httpd -k start'.\nProgram terminated with signal SIGSEGV, Segmentation fault.\n#0  0x0000000000454ac1 in ap_add_common_vars (r=0x0) at /opt/unpack/httpd-2.4.23/server/util_script.c:197\n197\t            if (conf->cgi_pass_auth == AP_CGI_PASS_AUTH_ON) {\n(gdb) bt full\n#0  0x0000000000454ac1 in ap_add_common_vars (r=0x0) at /opt/unpack/httpd-2.4.23/server/util_script.c:197\n        e = 0x0\n        s = 0x7f5c900e5720\n        c = 0x7f5c900e3e30\n        conf = 0x7f5c900e4508\n        env_temp = <optimized out>\n        hdrs_arr = 0x7f5c877ee700\n        hdrs = <optimized out>\n        i = -1642676128\n        rport = <optimized out>\n        q = <optimized out>\n#1  0x0000000000000006 in ?? ()\nNo symbol table info available.\n#2  0x00007f5c34004928 in ?? ()\nNo symbol table info available.\n#3  0x0000000000000323 in ?? ()\nNo symbol table info available.\n#4  0x00007f5c3400e9a8 in ?? ()\nNo symbol table info available.\n#5  0x0000000000001cdd in ?? ()\nNo symbol table info available.\n#6  0x0000000000499592 in ?? ()\nNo symbol table info available.\n#7  0x0000000000000002 in ?? ()\nNo symbol table info available.\n#8  0x00007f5c34003298 in ?? ()\nNo symbol table info available.\n#9  0x0000000000000006 in ?? ()\nNo symbol table info available.\n#10 0x00007f5c2008edd8 in ?? ()\nNo symbol table info available.\n#11 0x000000000000025b in ?? ()\nNo symbol table info available.\n#12 0x00007f5c20090de8 in ?? ()\nNo symbol table info available.\n#13 0x0000000000001da5 in ?? ()\nNo symbol table info available.\n#14 0x0000000000499592 in ?? ()\nNo symbol table info available.\n#15 0x0000000000000002 in ?? ()\nNo symbol table info available.\n#16 0x00007f5c34003b58 in ?? ()\nNo symbol table info available.\n#17 0x0000000000000004 in ?? ()\nNo symbol table info available.\n#18 0x00007f5c20066c98 in ?? ()\nNo symbol table info available.\n#19 0x00000000000004b3 in ?? ()\nNo symbol table info available.\n#20 0x00007f5c4803cb18 in ?? ()\nNo symbol table info available.\n#21 0x0000000000001b4d in ?? ()\nNo symbol table info available.\n#22 0x0000000000499592 in ?? ()\nNo symbol table info available.\n#23 0x0000000000000002 in ?? ()\nNo symbol table info available.\n#24 0x00007f5c4c054de8 in ?? ()\nNo symbol table info available.\n#25 0x0000000000000006 in ?? ()\nNo symbol table info available.\n#26 0x00007f5c541713e8 in ?? ()\nNo symbol table info available.\n#27 0x00000000000003eb in ?? ()\nNo symbol table info available.\n#28 0x00000001877edc60 in ?? ()\nNo symbol table info available.\n#29 0x00007f5c877edbb0 in ?? ()\nNo symbol table info available.\n#30 0x000000000000000b in ?? ()\nNo symbol table info available.\n#31 0x00000000900e4438 in ?? ()\nNo symbol table info available.\n#32 0x00000000000000c8 in ?? ()\nNo symbol table info available.\n#33 0x0000000000c11e48 in ?? ()\n---Type <return> to continue, or q <return> to quit--- \nNo symbol table info available.\n#34 0x00007f5c877edc70 in ?? ()\nNo symbol table info available.\n#35 0x0000000000454d72 in ap_add_common_vars (r=0x1c15) at /opt/unpack/httpd-2.4.23/server/util_script.c:282\n        e = 0x2\n        s = 0x7f5c900e5720\n        c = 0x7f5c900e3e30\n        conf = 0x7f5c900e4508\n        env_temp = 0x0\n        hdrs_arr = 0x7f5c34003478\n        hdrs = <optimized out>\n        i = <optimized out>\n        rport = <optimized out>\n        q = <optimized out>\n#36 0x00000000004544c2 in getsfunc_BRIGADE (buf=<optimized out>, len=<optimized out>, arg=<optimized out>) at /opt/unpack/httpd-2.4.23/server/util_script.c:756\n        bb = <optimized out>\n        dst_end = 0x1 <error: Cannot access memory at address 0x1>\n        dst = <optimized out>\n        e = <optimized out>\n        rv = <optimized out>\n        done = <optimized out>\n#37 0x00007f5c877edcd0 in ?? ()\nNo symbol table info available.\n#38 0x00007f5c900e43f0 in ?? ()\nNo symbol table info available.\n#39 0x00007f5c900e4048 in ?? ()\nNo symbol table info available.\n#40 0x0000000000000000 in ?? ()\nNo symbol table info available.\n(gdb) frame 2 \n#2  0x00007f5c34004928 in ?? ()\n(gdb) frame 0\n#0  0x0000000000454ac1 in ap_add_common_vars (r=0x0) at /opt/unpack/httpd-2.4.23/server/util_script.c:197\n197\t            if (conf->cgi_pass_auth == AP_CGI_PASS_AUTH_ON) {\n(gdb) list\n192\t         * in the environment with \"ps -e\".  But, if you must...\n193\t         */\n194\t#ifndef SECURITY_HOLE_PASS_AUTHORIZATION\n195\t        else if (!strcasecmp(hdrs[i].key, \"Authorization\")\n196\t                 || !strcasecmp(hdrs[i].key, \"Proxy-Authorization\")) {\n197\t            if (conf->cgi_pass_auth == AP_CGI_PASS_AUTH_ON) {\n198\t                add_unless_null(e, http2env(r, hdrs[i].key), hdrs[i].val);\n199\t            }\n200\t        }\n201\t#endif\n(gdb) frame 35\n#35 0x0000000000454d72 in ap_add_common_vars (r=0x1c15) at /opt/unpack/httpd-2.4.23/server/util_script.c:282\n282\t    if (env_temp) {\n(gdb) list\n277\t            back = back->prev;\n278\t        }\n279\t    }\n280\t    add_unless_null(e, \"AUTH_TYPE\", r->ap_auth_type);\n281\t    env_temp = ap_get_remote_logname(r);\n282\t    if (env_temp) {\n283\t        apr_table_addn(e, \"REMOTE_IDENT\", apr_pstrdup(r->pool, env_temp));\n284\t    }\n285\t\n286\t    /* Apache custom error responses. If we have redirected set two new vars */\n(gdb) frame 36\n#36 0x00000000004544c2 in getsfunc_BRIGADE (buf=<optimized out>, len=<optimized out>, arg=<optimized out>) at /opt/unpack/httpd-2.4.23/server/util_script.c:756\n756\t}\n(gdb) list\n751\t        apr_bucket_delete(e);\n752\t        e = next;\n753\t    }\n754\t    *dst = 0;\n755\t    return done;\n756\t}\n757\t\n758\tAP_DECLARE(int) ap_scan_script_header_err_brigade(request_rec *r,\n759\t                                                  apr_bucket_brigade *bb,\n760\t                                                  char *buffer)\n(gdb)", "id": 195556, "time": "2016-12-19T10:28:49Z", "creator": "amd1212@vier-ringe.at", "creation_time": "2016-12-19T10:28:49Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "ylavic.dev@gmail.com", "text": "I don't see how ap_add_common_vars() can be both in frame 0 and frame 35, this is not a recursive function AFAICT.\n\nThe APR and APR-util symbols seems to be terribly missing here too, any chance to have those (to fill in the backtrace holes)?\n\nFinally, which CGI module and its configuration is involved? No third party one?", "count": 6, "id": 195557, "time": "2016-12-19T11:33:21Z", "bug_id": 60439, "creation_time": "2016-12-19T11:33:21Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 60439, "attachment_id": null, "id": 195558, "time": "2016-12-19T11:41:30Z", "creator": "ylavic.dev@gmail.com", "creation_time": "2016-12-19T11:41:30Z", "is_private": false, "text": "(In reply to Yann Ylavic from comment #6)\n> I don't see how ap_add_common_vars() can be both in frame 0 and frame 35,\n> this is not a recursive function AFAICT.\n\nOn maybe an ErrorDocument (w/ ProxyErrorOverride) that gets served by a CGI itself?"}, {"count": 8, "tags": [], "text": "Hi,\n\nSorry, I've just build the whole thing again having debugging symbols enabled for apr and apr-utils as well.\nWe will deploy the new build tomorrow and update the bug as soon as the next segfault happens.\n\nWe have no external CGI modules in place. \nHere is a dump of all modules we have built:\n\nLoaded Modules:\n core_module (static)\n so_module (static)\n http_module (static)\n mpm_worker_module (static)\n dumpio_module (shared)\n log_forensic_module (shared)\n logio_module (shared)\n proxy_module (shared)\n proxy_connect_module (shared)\n proxy_ftp_module (shared)\n proxy_http_module (shared)\n proxy_balancer_module (shared)\n lbmethod_byrequests_module (shared)\n lbmethod_bybusyness_module (shared)\n status_module (shared)\n rewrite_module (shared)\n unixd_module (shared)\n auth_basic_module (shared)\n authz_host_module (shared)\n authn_core_module (shared)\n authz_core_module (shared)\n ldap_module (shared)\n authnz_ldap_module (shared)\n expires_module (shared)\n headers_module (shared)\n log_config_module (shared)\n env_module (shared)\n slotmem_shm_module (shared)", "attachment_id": null, "id": 195565, "creator": "amd1212@vier-ringe.at", "time": "2016-12-19T15:39:50Z", "bug_id": 60439, "creation_time": "2016-12-19T15:39:50Z", "is_private": false}, {"count": 9, "tags": [], "text": "Hello,\n\nFinally we have an coredump with all debugging symbols enabled.\nSorry for the long delay. We are not able to reproduce the segfault by now, we have to wait for one. They appear not frequently.\n\nHere is the backtrace, if more information is needed don't hesitate to ask.\n\nGNU gdb (Debian 7.7.1+dfsg-5) 7.7.1\nCopyright (C) 2014 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\nand \"show warranty\" for details.\nThis GDB was configured as \"x86_64-linux-gnu\".\nType \"show configuration\" for configuration details.\nFor bug reporting instructions, please see:\n<http://www.gnu.org/software/gdb/bugs/>.\nFind the GDB manual and other documentation resources online at:\n<http://www.gnu.org/software/gdb/documentation/>.\nFor help, type \"help\".\nType \"apropos word\" to search for commands related to \"word\"...\nReading symbols from /opt/loadbalancer/apache/bin/httpd...done.\n[New LWP 126431]\n[New LWP 125676]\n[New LWP 126433]\n[New LWP 126435]\n[New LWP 126437]\n[New LWP 126438]\n[New LWP 126440]\n[New LWP 126442]\n[New LWP 126444]\n[New LWP 126446]\n[New LWP 126448]\n[New LWP 126450]\n[New LWP 126454]\n[New LWP 126456]\n[New LWP 126458]\n[New LWP 126460]\n[New LWP 126462]\n[New LWP 126464]\n[New LWP 126466]\n[New LWP 126468]\n[New LWP 126470]\n[New LWP 126472]\n[New LWP 126476]\n[New LWP 126478]\n[New LWP 126479]\n[New LWP 126481]\n[New LWP 126290]\n[New LWP 126291]\n[New LWP 126293]\n[New LWP 126294]\n[New LWP 126296]\n[New LWP 126297]\n[New LWP 126298]\n[New LWP 126299]\n[New LWP 126301]\n[New LWP 126303]\n[New LWP 126304]\n[New LWP 126307]\n[New LWP 126309]\n[New LWP 126311]\n[New LWP 126315]\n[New LWP 126317]\n[New LWP 126319]\n[New LWP 126321]\n[New LWP 126323]\n[New LWP 126327]\n[New LWP 126329]\n[New LWP 126331]\n[New LWP 126333]\n[New LWP 126336]\n[New LWP 126338]\n[New LWP 126341]\n[New LWP 126343]\n[New LWP 126346]\n[New LWP 126348]\n[New LWP 126350]\n[New LWP 126352]\n[New LWP 126354]\n[New LWP 126356]\n[New LWP 126358]\n[New LWP 126360]\n[New LWP 126362]\n[New LWP 126364]\n[New LWP 126366]\n[New LWP 126368]\n[New LWP 126369]\n[New LWP 126371]\n[New LWP 126373]\n[New LWP 126375]\n[New LWP 126377]\n[New LWP 126381]\n[New LWP 126383]\n[New LWP 126385]\n[New LWP 126387]\n[New LWP 126389]\n[New LWP 126391]\n[New LWP 126394]\n[New LWP 126398]\n[New LWP 126399]\n[New LWP 126403]\n[New LWP 126405]\n[New LWP 126407]\n[New LWP 126409]\n[New LWP 126418]\n[New LWP 126421]\n[New LWP 126425]\n[New LWP 126427]\n[New LWP 126429]\n[New LWP 126423]\n[New LWP 126452]\n[New LWP 126474]\n[New LWP 126292]\n[New LWP 126295]\n[New LWP 126302]\n[New LWP 126305]\n[New LWP 126313]\n[New LWP 126325]\n[New LWP 126379]\n[New LWP 126396]\n[New LWP 126401]\n[New LWP 126411]\n[New LWP 126300]\n\nwarning: Could not load shared library symbols for 2 libraries, e.g. /lib/snoopy.so.\nUse the \"info sharedlibrary\" command to see the complete listing.\nDo you need \"set solib-search-path\" or \"set sysroot\"?\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\nCore was generated by `/opt/loadbalancer/apache/bin/httpd -k start'.\nProgram terminated with signal SIGSEGV, Segmentation fault.\n#0  send_brigade_nonblocking (s=0x7fe19c0e1f08, bb=0x7fe1fc0e4370, bytes_written=0x5, c=0x7fe1a4017168)\n    at /opt/unpack/httpd-2.4.23/server/core_filters.c:664\n664\t        if (!APR_BUCKET_IS_METADATA(bucket)) {\n(gdb) info sharedlibrary\nFrom                To                  Syms Read   Shared Object Library\n                                        No          linux-vdso.so.1\n                                        No          /lib/snoopy.so\n0x00007fe20a1720a0  0x00007fe20a187e60  Yes         /opt/loadbalancer/pcre/lib/libpcre.so.1\n0x00007fe209f53250  0x00007fe209f6774f  Yes         /opt/loadbalancer/apr-util/lib/libaprutil-1.so.0\n0x00007fe209d24b60  0x00007fe209d3cff9  Yes (*)     /lib/x86_64-linux-gnu/libexpat.so.1\n0x00007fe209afb9b0  0x00007fe209b15f14  Yes         /opt/loadbalancer/apr/lib/libapr-1.so.0\n0x00007fe2098e9350  0x00007fe2098ec06c  Yes         /lib/x86_64-linux-gnu/librt.so.1\n0x00007fe2096b0cc0  0x00007fe2096b58b4  Yes         /lib/x86_64-linux-gnu/libcrypt.so.1\n0x00007fe2094989f0  0x00007fe2094a4771  Yes         /lib/x86_64-linux-gnu/libpthread.so.0\n0x00007fe20928fed0  0x00007fe20929097e  Yes         /lib/x86_64-linux-gnu/libdl.so.2\n0x00007fe208f034a0  0x00007fe20902f943  Yes         /lib/x86_64-linux-gnu/libc.so.6\n0x00007fe20a595ae0  0x00007fe20a5ae140  Yes         /lib64/ld-linux-x86-64.so.2\n0x00007fe2038993b0  0x00007fe20389db4e  Yes         /lib/x86_64-linux-gnu/libnss_compat.so.2\n0x00007fe203684160  0x00007fe20368f693  Yes         /lib/x86_64-linux-gnu/libnsl.so.1\n0x00007fe2034771a0  0x00007fe20347d1bc  Yes         /lib/x86_64-linux-gnu/libnss_nis.so.2\n0x00007fe20326b2a0  0x00007fe203271ba3  Yes         /lib/x86_64-linux-gnu/libnss_files.so.2\n0x00007fe20681e0e0  0x00007fe20684d474  Yes (*)     /usr/lib/x86_64-linux-gnu/libldap_r-2.4.so.2\n0x00007fe206603540  0x00007fe20660a4d2  Yes (*)     /usr/lib/x86_64-linux-gnu/liblber-2.4.so.2\n0x00007fe2063eca90  0x00007fe2063f8a76  Yes         /lib/x86_64-linux-gnu/libresolv.so.2\n0x00007fe2061d0310  0x00007fe2061e1293  Yes (*)     /usr/lib/x86_64-linux-gnu/libsasl2.so.2\n0x00007fe205ed4400  0x00007fe205f9093a  Yes (*)     /usr/lib/x86_64-linux-gnu/libgnutls-deb0.so.28\n0x00007fe205c95220  0x00007fe205ca6469  Yes (*)     /lib/x86_64-linux-gnu/libz.so.1\n0x00007fe205a5a4f0  0x00007fe205a76edc  Yes (*)     /usr/lib/x86_64-linux-gnu/libp11-kit.so.0\n0x00007fe20583bc80  0x00007fe205846a0b  Yes (*)     /usr/lib/x86_64-linux-gnu/libtasn1.so.6\n0x00007fe20560d360  0x00007fe2056295ca  Yes (*)     /usr/lib/x86_64-linux-gnu/libnettle.so.4\n0x00007fe2053deb60  0x00007fe2053e9676  Yes (*)     /usr/lib/x86_64-linux-gnu/libhogweed.so.2\n0x00007fe205161480  0x00007fe2051bf228  Yes (*)     /usr/lib/x86_64-linux-gnu/libgmp.so.10\n0x00007fe204f4e870  0x00007fe204f5301c  Yes (*)     /usr/lib/x86_64-linux-gnu/libffi.so.6\n0x00007fe203067d70  0x00007fe2030686a0  Yes         /opt/loadbalancer/apr-util/lib/apr-util-1/apr_ldap-1.so\n0x00007fe208ce2a20  0x00007fe208ce3389  Yes         /opt/loadbalancer/apache/modules/mod_dumpio.so\n0x00007fe208ae0db0  0x00007fe208ae15d6  Yes         /opt/loadbalancer/apache/modules/mod_log_forensic.so\n0x00007fe2088dec60  0x00007fe2088df1f5  Yes         /opt/loadbalancer/apache/modules/mod_logio.so\n0x00007fe2086c70d0  0x00007fe2086d5bae  Yes         /opt/loadbalancer/apache/modules/mod_proxy.so\n0x00007fe2084be1f0  0x00007fe2084bfcfc  Yes         /opt/loadbalancer/apache/modules/mod_proxy_connect.so\n0x00007fe2082b52f0  0x00007fe2082baddc  Yes         /opt/loadbalancer/apache/modules/mod_proxy_ftp.so\n0x00007fe2080ac6b0  0x00007fe2080b0ff8  Yes         /opt/loadbalancer/apache/modules/mod_proxy_http.so\n0x00007fe207ea0200  0x00007fe207ea607f  Yes         /opt/loadbalancer/apache/modules/mod_proxy_balancer.so\n0x00007fe207c9c740  0x00007fe207c9cbe8  Yes         /opt/loadbalancer/apache/modules/mod_lbmethod_byrequests.so\n0x00007fe207a9a740  0x00007fe207a9ac1e  Yes         /opt/loadbalancer/apache/modules/mod_lbmethod_bybusyness.so\n0x00007fe2078961c0  0x00007fe2078982db  Yes         /opt/loadbalancer/apache/modules/mod_status.so\n0x00007fe207688350  0x00007fe207690f53  Yes         /opt/loadbalancer/apache/modules/mod_rewrite.so\n0x00007fe207482fa0  0x00007fe2074839a8  Yes         /opt/loadbalancer/apache/modules/mod_unixd.so\n0x00007fe20727fe90  0x00007fe207280e78  Yes         /opt/loadbalancer/apache/modules/mod_auth_basic.so\n0x00007fe20707cdd0  0x00007fe20707d7cc  Yes         /opt/loadbalancer/apache/modules/mod_authz_host.so\n0x00007fe206e79ed0  0x00007fe206e7a652  Yes         /opt/loadbalancer/apache/modules/mod_authn_core.so\n0x00007fe206c75570  0x00007fe206c7713a  Yes         /opt/loadbalancer/apache/modules/mod_authz_core.so\n0x00007fe206a64620  0x00007fe206a6d29f  Yes         /opt/loadbalancer/apache/modules/mod_ldap.so\n0x00007fe204d41e00  0x00007fe204d48387  Yes         /opt/loadbalancer/apache/modules/mod_authnz_ldap.so\n0x00007fe204b3df50  0x00007fe204b3e942  Yes         /opt/loadbalancer/apache/modules/mod_expires.so\n0x00007fe2049397c0  0x00007fe20493b1ed  Yes         /opt/loadbalancer/apache/modules/mod_headers.so\n0x00007fe204732d40  0x00007fe20473589b  Yes         /opt/loadbalancer/apache/modules/mod_log_config.so\n0x00007fe20452faf0  0x00007fe20452fe6b  Yes         /opt/loadbalancer/apache/modules/mod_env.so\n0x00007fe20432c080  0x00007fe20432d7e6  Yes         /opt/loadbalancer/apache/modules/mod_slotmem_shm.so\n0x00007fe203ff2870  0x00007fe2040d501e  Yes (*)     /usr/lib/x86_64-linux-gnu/libxml2.so.2\n0x00007fe203da3850  0x00007fe203db8082  Yes (*)     /lib/x86_64-linux-gnu/liblzma.so.5\n0x00007fe203aa5580  0x00007fe203b10d96  Yes         /lib/x86_64-linux-gnu/libm.so.6\n                                        No          /lib/x86_64-linux-gnu/libnss_sss.so.2\n0x00007fe200232ab0  0x00007fe2002429a5  Yes (*)     /lib/x86_64-linux-gnu/libgcc_s.so.1\n0x00007fe20002b100  0x00007fe20002dff0  Yes         /lib/x86_64-linux-gnu/libnss_dns.so.2\n(*): Shared library is missing debugging information.\n(gdb) bt full\n#0  send_brigade_nonblocking (s=0x7fe19c0e1f08, bb=0x7fe1fc0e4370, bytes_written=0x5, c=0x7fe1a4017168)\n    at /opt/unpack/httpd-2.4.23/server/core_filters.c:664\n        vec = {{iov_base = 0x7fe1c00c8ef8, iov_len = 7482}, {iov_base = 0x7fe1c00caf08, iov_len = 710}, {\n            iov_base = 0x47c2ca, iov_len = 2}, {iov_base = 0x7fe19c0e2d68, iov_len = 5}, {\n            iov_base = 0x7fe194107208, iov_len = 8000}, {iov_base = 0x7fe19c0e18c8, iov_len = 110}, {\n            iov_base = 0x47c2ca, iov_len = 2}, {iov_base = 0x7fe19c0e2548, iov_len = 6}, {\n            iov_base = 0x7fe1c00c0eb8, iov_len = 7882}, {iov_base = 0x7fe1a4006938, iov_len = 310}, {\n            iov_base = 0x47c2ca, iov_len = 2}, {iov_base = 0x7fe19c0e2a48, iov_len = 6}, {\n            iov_base = 0x7fe1c00bae88, iov_len = 7682}, {iov_base = 0x7fe1940f7188, iov_len = 510}, {\n            iov_base = 0x47c2ca, iov_len = 2}, {iov_base = 0x7fe19c0e24a8, iov_len = 6}}\n        nvec = 4\n#1  0x00000000004491e1 in send_brigade_blocking (c=<optimized out>, bytes_written=<optimized out>, \n    bb=<optimized out>, s=<optimized out>) at /opt/unpack/httpd-2.4.23/server/core_filters.c:733\nNo locals.\n#2  ap_core_output_filter (f=0x7fe19c0e1f08, new_bb=0x7fe1fc0e4370)\n    at /opt/unpack/httpd-2.4.23/server/core_filters.c:542\n        c = 0x7fe1fc0e3dd8\n        bytes_in_brigade = 0\n        non_file_bytes_in_brigade = 140606962540296\n        eor_buckets_in_brigade = 5\n        morphing_bucket_in_brigade = -662995824\n#3  0x00000000004626b1 in ap_process_request (r=0x7fe194101230)\n    at /opt/unpack/httpd-2.4.23/modules/http/http_request.c:451\n        bb = 0x7fe1fc0e4370\n        c = 0x7fe1fc0e3dd8\n        rv = 48\n#4  0x000000000045e9b5 in ap_process_http_sync_connection (c=0x7fe1fc0e3dd8)\n    at /opt/unpack/httpd-2.4.23/modules/http/http_core.c:210\n        keep_alive_timeout = 5000000\n        r = 0x7fe194101230\n        cs = 0x0\n        csd = 0x0\n        mpm_state = 0\n#5  ap_process_http_connection (c=0x7fe1fc0e3dd8) at /opt/unpack/httpd-2.4.23/modules/http/http_core.c:251\nNo locals.\n#6  0x0000000000456d30 in ap_run_process_connection (c=0x7fe1fc0e3dd8)\n    at /opt/unpack/httpd-2.4.23/server/connection.c:42\n        pHook = <optimized out>\n        n = 0\n        rv = -1\n#7  0x0000000000468f81 in process_socket (bucket_alloc=<optimized out>, my_thread_num=<optimized out>, \n    my_child_num=<optimized out>, sock=<optimized out>, p=<optimized out>, thd=<optimized out>)\n    at /opt/unpack/httpd-2.4.23/server/mpm/worker/worker.c:631\n        current_conn = 0x7fe1fc0e3dd8\n        conn_id = 140608573160920\n        sbh = 0x7fe1fc0e3dd0\n#8  worker_thread (thd=0x7fe19c0e1f08, dummy=0x7fe1d87b7c90)\n    at /opt/unpack/httpd-2.4.23/server/mpm/worker/worker.c:992\n        process_slot = 19\n        thread_slot = 74\n        csd = 0x7fe1fc0e3bc0\n        bucket_alloc = 0x9\n        last_ptrans = 0x7fe1fc0e3dd8\n        ptrans = 0x7fe1fc0e3b38\n        is_idle = -66176064\n#9  0x00007fe20949b0a4 in start_thread (arg=0x7fe1d87b8700) at pthread_create.c:309\n        __res = <optimized out>\n        pd = 0x7fe1d87b8700\n        now = <optimized out>\n        unwind_buf = {cancel_jmp_buf = {{jmp_buf = {140607976343296, 7960264032231149677, 0, 140608815194208, 152, \n                140607976343296, -7945694442286690195, -7945304783828627347}, mask_was_saved = 0}}, priv = {pad = {\n              0x0, 0x0, 0x0, 0x0}, data = {prev = 0x0, cleanup = 0x0, canceltype = 0}}}\n        not_first_call = <optimized out>\n        pagesize_m1 = <optimized out>\n        sp = <optimized out>\n        freesize = <optimized out>\n        __PRETTY_FUNCTION__ = \"start_thread\"\n#10 0x00007fe208fcc62d in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:111\nNo locals.\n(gdb)\n\n\n\n\nbest regards,\nStefan", "attachment_id": null, "id": 195700, "creator": "amd1212@vier-ringe.at", "time": "2016-12-29T10:35:24Z", "bug_id": 60439, "creation_time": "2016-12-29T10:35:24Z", "is_private": false}, {"count": 10, "tags": [], "text": "(In reply to amd1212 from comment #9)\n> \n> Here is the backtrace, if more information is needed don't hesitate to ask.\n\nCould you please attach the output of:\n(gdb) thread apply all bt full\n?\n\nThanks!", "attachment_id": null, "id": 195701, "creator": "ylavic.dev@gmail.com", "time": "2016-12-29T10:42:28Z", "bug_id": 60439, "creation_time": "2016-12-29T10:42:28Z", "is_private": false}, {"text": "Hello,\n\nHere is the requested output (I've replaced some chars with an equal amount of X'es to obscure some internal data).\n\nThe comment was to big so I've pasted everything here:\nhttp://pastebin.com/X67ptV8R\n\nbest,\nStefan", "tags": [], "creator": "amd1212@vier-ringe.at", "attachment_id": null, "count": 11, "id": 195702, "time": "2016-12-29T12:49:21Z", "bug_id": 60439, "creation_time": "2016-12-29T12:49:21Z", "is_private": false}, {"count": 12, "tags": [], "bug_id": 60439, "text": "Created attachment 34566\ngdb output\n\nAs attachment.\n\nThread 1 seems to indeed be the culprit, investigating...", "id": 195703, "time": "2016-12-29T12:57:35Z", "creator": "ylavic.dev@gmail.com", "creation_time": "2016-12-29T12:57:35Z", "is_private": false, "attachment_id": 34566}, {"count": 13, "tags": [], "bug_id": 60439, "text": "(In reply to Yann Ylavic from comment #12)\n> \n> Thread 1 seems to indeed be the culprit, investigating...\n\nIf you have or could install the .gdbinit provided with httpd source in your path, could you please show (in Thread 1, frame 0) us the output of:\n(gdb) dump_brigade bb\n(gdb) dump_bucket bucket\n(gdb) dump_bucket next\n(gdb) p *bytes_written\n\nThanks.", "id": 195704, "time": "2016-12-29T13:16:44Z", "creator": "ylavic.dev@gmail.com", "creation_time": "2016-12-29T13:16:44Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "amd1212@vier-ringe.at", "text": "Sure thing, only dump_brigade seems to be working:\n\n(gdb) thread 1\n[Switching to thread 1 (Thread 0x7fe1d87b8700 (LWP 126431))]\n#0  send_brigade_nonblocking (s=0x7fe19c0e1f08, bb=0x7fe1fc0e4370, bytes_written=0x5, c=0x7fe1a4017168) at /opt/payon/unpack/httpd-2.4.23/server/core_filters.c:664\n664\t        if (!APR_BUCKET_IS_METADATA(bucket)) {\n(gdb) frame 0\n#0  send_brigade_nonblocking (s=0x7fe19c0e1f08, bb=0x7fe1fc0e4370, bytes_written=0x5, c=0x7fe1a4017168) at /opt/payon/unpack/httpd-2.4.23/server/core_filters.c:664\n664\t        if (!APR_BUCKET_IS_METADATA(bucket)) {\n(gdb) dump_brigade bb\ndump of brigade 0x7fe1fc0e4370\n   | type     (address)    | length | data addr  | contents               | rc\n--------------------------------------------------------------------------------\n 0 | HEAP     (0x7fe19c0e2c28) | 7482   | 0x7fe19c0e27c8 | [44c0d88e5014c13c1...] | 1\n 1 | HEAP     (0x7fe19c0e2228) | 710    | 0x7fe19c0e2908 | [customerId=\"BUM00...] | 1\n 2 | IMMORTAL (0x7fe19c0e25e8) | 2      | 0x0047c2ca | [~~]                   | n/a\n 3 | HEAP     (0x7fe19c0e1f08) | 5      | 0x7fe1a4017168 | [42c~~]                | 1\n 4 | Cannot access memory at address 0x2e512866693b4343\n(gdb) dump_bucket bucket\nvalue has been optimized out\n(gdb) dump_bucket next\nvalue has been optimized out\n(gdb) p *bytes_written\nCannot access memory at address 0x5\n(gdb)", "count": 14, "id": 195705, "time": "2016-12-29T13:40:31Z", "bug_id": 60439, "creation_time": "2016-12-29T13:40:31Z", "is_private": false}, {"count": 15, "tags": [], "creator": "c.liranzi@netforger.net", "attachment_id": 34634, "text": "Created attachment 34634\nA folder with different core dumps\n\nHello,\n\nwe update ours httpd to the version 2.4.25 because we hope that resolve the segfault problem. Yesterday we have an segfault again.\n\nregards,\n\nClaudio", "id": 196133, "time": "2017-01-18T09:55:46Z", "bug_id": 60439, "creation_time": "2017-01-18T09:55:46Z", "is_private": false}, {"attachment_id": 34640, "tags": [], "creator": "c.liranzi@netforger.net", "text": "Created attachment 34640\nA folder with different core dumps\n\nHi,\n\nWe just had a segfault again.\n\nregards,\n\nClaudio", "count": 16, "id": 196143, "time": "2017-01-18T14:29:53Z", "bug_id": 60439, "creation_time": "2017-01-18T14:29:53Z", "is_private": false}, {"count": 17, "tags": [], "text": "Hi,\n\nI did take a closer look at 20 core dumps collected in the meantime with\nthe following observations.  The segfault always occurs with one of\nthree backtraces[1][2][3].\n\nAnother thing I noticed is that there is always one thread busy in a close()\nsyscall at the time of the crash with a consistent backtrace[4].  Maybe\nsomeone that is more familar with the code can tell whether this is\nsuspicious or something to be expected?\n\nAny other hints on further debugging appreciated.\n\nregards,\nAndreas\n\nFootnotes: \n[1]  \n--8<---------------cut here---------------start------------->8---\n#0  0x0000000000000000 in ?? ()\n#1  0x000000000044a576 in remove_empty_buckets (bb=0x7f81a40ea5f0) at /opt/unpack/httpd-2.4.25/server/core_filters.c:720\n        apr_bucket_delete(bucket);\n#2  0x000000000044a852 in send_brigade_nonblocking (s=0x0, bb=0x7f81a40ea5f0, bytes_written=0x7f81480cb620, c=0x7f814c0cc9e8) at /opt/unpack/httpd-2.4.25/server/core_filters.c:625\n#3  0x000000000044b5c1 in send_brigade_blocking (c=<optimized out>, bytes_written=<optimized out>, bb=<optimized out>, s=<optimized out>) at /opt/unpack/httpd-2.4.25/server/core_filters.c:733\n#4  ap_core_output_filter (f=0x0, new_bb=0x7f81a40ea5f0) at /opt/unpack/httpd-2.4.25/server/core_filters.c:542\n#5  0x0000000000464c31 in ap_process_request (r=0x7f8148056c40) at /opt/unpack/httpd-2.4.25/modules/http/http_request.c:477\n#6  0x0000000000460df5 in ap_process_http_sync_connection (c=0x7f81a40ea058) at /opt/unpack/httpd-2.4.25/modules/http/http_core.c:210\n#7  ap_process_http_connection (c=0x7f81a40ea058) at /opt/unpack/httpd-2.4.25/modules/http/http_core.c:251\n#8  0x0000000000459100 in ap_run_process_connection (c=0x7f81a40ea058) at /opt/unpack/httpd-2.4.25/server/connection.c:42\n#9  0x000000000046b7c1 in process_socket (bucket_alloc=<optimized out>, my_thread_num=<optimized out>, my_child_num=<optimized out>, sock=<optimized out>, p=<optimized out>, thd=<optimized out>) at /opt/unpack/httpd-2.4.25/server/mpm/worker/worker.c:631\n#10 worker_thread (thd=0x0, dummy=0x7f81a40ea5f0) at /opt/unpack/httpd-2.4.25/server/mpm/worker/worker.c:992\n#11 0x00007f81afe500a4 in start_thread (arg=0x7f81897ca700) at pthread_create.c:403\n#12 0x00007f81af98162d in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:111\n--8<---------------cut here---------------end--------------->8---\n\n[2]\n--8<---------------cut here---------------start------------->8---\n#0  0x00007f81afe52274 in __GI___pthread_mutex_lock (mutex=0x0) at ../nptl/pthread_mutex_lock.c:79\n#1  0x00007f81b04bea69 in apr_thread_mutex_lock (mutex=<optimized out>) at /opt/loadbalancer/../unpack/apr-1.5.2/locks/unix/thread_mutex.c:92\n#2  0x00007f81b04bf538 in allocator_free (node=0x7f813c0eb050, allocator=0x1bab00e) at /opt/loadbalancer/../unpack/apr-1.5.2/memory/unix/apr_pools.c:370\n#3  apr_allocator_free (allocator=0x1bab00e, node=0x7f813c0eb050) at /opt/loadbalancer/../unpack/apr-1.5.2/memory/unix/apr_pools.c:444\n#4  0x00007f81b0909d57 in heap_bucket_destroy (data=0x7f81680aaf48) at /opt/loadbalancer/../unpack/apr-util-1.5.4/buckets/apr_buckets_heap.c:36\n#5  0x000000000044ada1 in ap_core_input_filter (f=0x7f81a41949d8, b=0x7f813c013190, mode=AP_MODE_GETLINE, block=APR_NONBLOCK_READ, readbytes=0) at /opt/unpack/httpd-2.4.25/server/core_filters.c:132\n#6  0x00007f81af292fce in logio_in_filter (f=<optimized out>, bb=0x7f813c013190, mode=<optimized out>, block=<optimized out>, readbytes=<optimized out>) at /opt/unpack/httpd-2.4.25/modules/loggers/mod_logio.c:165\n#7  0x0000000000465e9c in ap_http_filter (f=0x7f81500a68b8, b=0x7f813c013190, mode=1745531016, block=(unknown: 2753121024), readbytes=8192) at /opt/unpack/httpd-2.4.25/modules/http/http_filters.c:515\n#8  0x00007f81aea61044 in ap_proxy_http_process_response (p=0x1bab1800008, r=0x7f813c090e40, backend_ptr=0x7f81680ab088, server_portstr=0x7f818e7d3c60 \"\", conf=<optimized out>, conf=<optimized out>, worker=<optimized out>) at /opt/unpack/httpd-2.4.25/modules/proxy/mod_proxy_http.c:1673\n#9  0x00007f81aea629a9 in proxy_http_handler (r=0x7f813c090e40, worker=0x1c59560, conf=0x7f81680ab088, url=0x7f813c090dc8 \"...\", proxyname=0x0, proxyport=31904) at /opt/unpack/httpd-2.4.25/modules/proxy/mod_proxy_http.c:1986\n#10 0x00007f81af07f6c3 in proxy_run_scheme_handler (r=0x7f813c090e40, worker=0x1c59560, conf=0x1c1c190, url=0x7f813c007b00 \"...\"..., proxyhost=0x0, proxyport=0) at /opt/unpack/httpd-2.4.25/modules/proxy/mod_proxy.c:2880\n#11 0x00007f81af080631 in proxy_handler (r=0x1bab1800008) at /opt/unpack/httpd-2.4.25/modules/proxy/mod_proxy.c:1230\n#12 0x000000000044fbb0 in ap_run_handler (r=r@entry=0x7f813c090e40) at /opt/unpack/httpd-2.4.25/server/config.c:170\n#13 0x00000000004500f9 in ap_invoke_handler (r=0x7f813c090e40) at /opt/unpack/httpd-2.4.25/server/config.c:434\n#14 0x0000000000464a13 in ap_process_async_request (r=0x7f813c090e40) at /opt/unpack/httpd-2.4.25/modules/http/http_request.c:436\n#15 0x0000000000464bb0 in ap_process_request (r=0x7f813c090e40) at /opt/unpack/httpd-2.4.25/modules/http/http_request.c:471\n#16 0x0000000000460df5 in ap_process_http_sync_connection (c=0x7f816c015518) at /opt/unpack/httpd-2.4.25/modules/http/http_core.c:210\n#17 ap_process_http_connection (c=0x7f816c015518) at /opt/unpack/httpd-2.4.25/modules/http/http_core.c:251\n#18 0x0000000000459100 in ap_run_process_connection (c=0x7f816c015518) at /opt/unpack/httpd-2.4.25/server/connection.c:42\n#19 0x000000000046b7c1 in process_socket (bucket_alloc=<optimized out>, my_thread_num=<optimized out>, my_child_num=<optimized out>, sock=<optimized out>, p=<optimized out>, thd=<optimized out>) at /opt/unpack/httpd-2.4.25/server/mpm/worker/worker.c:631\n#20 worker_thread (thd=0x1bab1800008, dummy=0x7f813c0eb050) at /opt/unpack/httpd-2.4.25/server/mpm/worker/worker.c:992\n#21 0x00007f81afe500a4 in start_thread (arg=0x7f818e7d4700) at pthread_create.c:403\n#22 0x00007f81af98162d in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:111\n--8<---------------cut here---------------end--------------->8---\n\n[3]  \n--8<---------------cut here---------------start------------->8---\nProgram terminated with signal SIGSEGV, Segmentation fault.\n664\tin /opt/unpack/httpd-2.4.25/server/core_filters.c\n        if (!APR_BUCKET_IS_METADATA(bucket)) {\n#0  send_brigade_nonblocking (s=0x7f81540d77e8, bb=0x7f81a4100d40, bytes_written=0x4, c=0x7f81540d7248) at /opt/unpack/httpd-2.4.25/server/core_filters.c:664\n#1  0x000000000044b5c1 in send_brigade_blocking (c=<optimized out>, bytes_written=<optimized out>, bb=<optimized out>, s=<optimized out>) at /opt/unpack/httpd-2.4.25/server/core_filters.c:733\n#2  ap_core_output_filter (f=0x7f81540d77e8, new_bb=0x7f81a4100d40) at /opt/unpack/httpd-2.4.25/server/core_filters.c:542\n#3  0x0000000000464c31 in ap_process_request (r=0x7f81500bbf20) at /opt/unpack/httpd-2.4.25/modules/http/http_request.c:477\n#4  0x0000000000460df5 in ap_process_http_sync_connection (c=0x7f81a41007a8) at /opt/unpack/httpd-2.4.25/modules/http/http_core.c:210\n#5  ap_process_http_connection (c=0x7f81a41007a8) at /opt/unpack/httpd-2.4.25/modules/http/http_core.c:251\n#6  0x0000000000459100 in ap_run_process_connection (c=0x7f81a41007a8) at /opt/unpack/httpd-2.4.25/server/connection.c:42\n#7  0x000000000046b7c1 in process_socket (bucket_alloc=<optimized out>, my_thread_num=<optimized out>, my_child_num=<optimized out>, sock=<optimized out>, p=<optimized out>, thd=<optimized out>) at /opt/unpack/httpd-2.4.25/server/mpm/worker/worker.c:631\n#8  worker_thread (thd=0x7f81540d77e8, dummy=0x7f8193fdec90) at /opt/unpack/httpd-2.4.25/server/mpm/worker/worker.c:992\n#9  0x00007f81afe500a4 in start_thread (arg=0x7f8193fdf700) at pthread_create.c:403\n#10 0x00007f81af98162d in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:111\n--8<---------------cut here---------------end--------------->8---\n\n[4]\n--8<---------------cut here---------------start------------->8---\n#0  0x00007f81afe56add in close () at ../sysdeps/unix/syscall-template.S:81\n#1  0x000000000045c324 in ap_mpm_podx_check (pod=<optimized out>) at /opt/unpack/httpd-2.4.25/server/mpm_unix.c:546\n#2  0x000000000042bb8d in child_main (child_num_arg=1, child_bucket=29984256) at /opt/unpack/httpd-2.4.25/server/mpm/worker/worker.c:1364\n#3  0x000000000046c852 in make_child (s=0x1bd85e8, slot=1, bucket=0) at /opt/unpack/httpd-2.4.25/server/mpm/worker/worker.c:1456\n#4  0x000000000046d185 in perform_idle_server_maintenance (num_buckets=<optimized out>, child_bucket=<optimized out>) at /opt/unpack/httpd-2.4.25/server/mpm/worker/worker.c:1672\n#5  server_main_loop (num_buckets=<optimized out>, remaining_children_to_start=<optimized out>) at /opt/unpack/httpd-2.4.25/server/mpm/worker/worker.c:1805\n#6  worker_run (_pconf=0x4, plog=0x1, s=0x0) at /opt/unpack/httpd-2.4.25/server/mpm/worker/worker.c:1888\n#7  0x00000000004336ae in ap_run_mpm (pconf=0x1bb1138, plog=0x1bde378, s=0x1bd85e8) at /opt/unpack/httpd-2.4.25/server/mpm_common.c:94\n#8  0x000000000042c5f4 in main (argc=3, argv=0x7ffed664e9f8) at /opt/unpack/httpd-2.4.25/server/main.c:783\n--8<---------------cut here---------------end--------------->8---", "attachment_id": null, "id": 197831, "creator": "andreas.seltenreich@credativ.de", "time": "2017-03-20T17:47:01Z", "bug_id": 60439, "creation_time": "2017-03-20T17:47:01Z", "is_private": false}, {"count": 18, "tags": [], "bug_id": 60439, "text": "> --8<---------------cut here---------------start------------->8---\n> #0  0x00007f81afe56add in close () at ../sysdeps/unix/syscall-template.S:81\n> #1  0x000000000045c324 in ap_mpm_podx_check (pod=<optimized out>) at\n> /opt/unpack/httpd-2.4.25/server/mpm_unix.c:546\n> #2  0x000000000042bb8d in child_main (child_num_arg=1,\n> child_bucket=29984256) at\n> /opt/unpack/httpd-2.4.25/server/mpm/worker/worker.c:1364\n> #3  0x000000000046c852 in make_child (s=0x1bd85e8, slot=1, bucket=0) at\n> /opt/unpack/httpd-2.4.25/server/mpm/worker/worker.c:1456\n\nUnfortunately I think this is no (direct) clue and the debugger is somehow confused as only read() is called in this path. It is a dedicated thread in worker that waits for the parent to tell the worker it's time to exit (due to e.g. MaxSpareThreads).", "id": 197832, "time": "2017-03-20T18:00:48Z", "creator": "covener@gmail.com", "creation_time": "2017-03-20T18:00:48Z", "is_private": false, "attachment_id": null}]