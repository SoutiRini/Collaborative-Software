[{"count": 0, "tags": [], "text": "Created attachment 23086\npatch\n\na) Create a formula that is invalid e.g. put XXX in A1 and =A1+1 in B1.\nb) Change the value in A1 to 2.5\nc) Call HSSFFormulaEvaluator.evaluateInCell on B1\n\nActual Result: java.lang.IllegalStateException: Cannot get a numeric value from a error formula cell\n\nExpected Result: B1 contains 3.5\n\nPOI 3.1 did not have this problem but POI 3.2 and all newer versions including the current trunk do.", "attachment_id": 23086, "bug_id": 46479, "id": 123772, "time": "2009-01-05T08:01:08Z", "creator": "robert_longson@standardandpoors.com", "creation_time": "2009-01-05T08:01:08Z", "is_private": false}, {"count": 1, "tags": [], "text": "Created attachment 23087\ntestcase", "attachment_id": 23087, "bug_id": 46479, "id": 123773, "time": "2009-01-05T08:03:59Z", "creator": "robert_longson@standardandpoors.com", "creation_time": "2009-01-05T08:03:59Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 46479, "text": "Created attachment 23088\ntestcase", "id": 123774, "time": "2009-01-05T08:05:28Z", "creator": "robert_longson@standardandpoors.com", "creation_time": "2009-01-05T08:05:28Z", "is_private": false, "attachment_id": 23088}, {"attachment_id": null, "tags": [], "creator": "josh@apache.org", "is_private": false, "count": 3, "id": 123778, "time": "2009-01-05T13:12:20Z", "bug_id": 46479, "creation_time": "2009-01-05T13:12:20Z", "text": "Thanks for the patch.  There is some ambiguity in original design as to whether setCellType() should be called before or after setCellValue().  The methods overlap in behaviour:  setCellValue() may change the cell type, and setCellType() converts the old cell value to the new type and sets the new value in the cell.\nThe new ordering of these calls (setCellValue before setCellType) actually causes other junits to fail, but your fix still seems correct to me.\n\nThree other related bugs were found and fixed, and junits added for all of them. \n\nsvn r731715"}, {"attachment_id": null, "tags": [], "creator": "josh@apache.org", "is_private": false, "count": 4, "id": 132609, "time": "2009-12-03T14:23:52Z", "bug_id": 46479, "creation_time": "2009-12-03T14:23:52Z", "text": "Additional similar fixes applied in svn r886951\n\nProblems occurred when changing a formula cell to type string.  These cases weren't addressed in the previous fix."}]