[{"count": 0, "tags": [], "bug_id": 47332, "attachment_id": null, "text": "Most used of the url rewriting rule is a redirection to the SERVER_NAME (elitwork.com to www.elitwork.com by example).\n\nMost of the time, the url to redirect to is also the servername given in the httpd.conf file.\n\nThe problem is that the env var SERVER_NAME in the mod_rewrite is corresponding to the domain name used in the request, so SERVER_NAME can also be an server_alias defined in the virtualhost.\n\nThe problem is that it impeach apache user to define a global rule to be sure that a user using a server_alias will be redirected to the server_name domain.\n\ni.e, this doesn't work : \n\nRewriteCond %{HTTP_HOST} !%{SERVER_NAME}\nRewriteRule (.*) %{SERVER_NAME}/$1 [R=301,L]\n\nI don't know if it is the right place but my english is poor and it's already a miracle if you understand what i wrote here ;)", "id": 127734, "time": "2009-06-08T04:43:43Z", "creator": "nicolas_froidure@elitwork.com", "creation_time": "2009-06-08T04:43:43Z", "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 47332, "is_private": false, "id": 127737, "time": "2009-06-08T06:11:12Z", "creator": "covener@gmail.com", "creation_time": "2009-06-08T06:11:12Z", "tags": [], "text": "Changing to Documentation; Docs should emphasize SERVER_NAME vs. UseCanonicalHost vs. %{HTTP_HOST}"}, {"attachment_id": null, "tags": [], "creator": "rbowen@apache.org", "text": "Moving docs bugs to docs@httpd.a.o ownership.", "count": 2, "id": 141204, "time": "2010-10-29T11:06:38Z", "bug_id": 47332, "creation_time": "2010-10-29T11:06:38Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "rbowen@apache.org", "text": "Not sure how to respond to this one. HTTP_HOST is the requested hostname. That's how it's defined. I'm not sure where we'd document the fact that it's not the other thing that you expect it to be. Could be in the env vars doc?\n\nDo you have a suggested patch?", "count": 3, "id": 141449, "time": "2010-11-04T19:28:52Z", "bug_id": 47332, "creation_time": "2010-11-04T19:28:52Z", "is_private": false}, {"count": 4, "attachment_id": null, "creator": "nicolas_froidure@elitwork.com", "text": "Hi,\n\nI'll try to be more clear.\n\nEach time i create a vhost, i must put the following rewrite rules inside :\nRewriteCond %{HTTP_HOST} !www.elitwork.com\nRewriteRule (.*) www.elitwork.com/$1 [R=301,L]\n\nBy this way, i ensure the client use the default domain instead of an alias (like elitwork.com). I do it systematically to avoid duplicate content in my websites.\n\nAs i define a ServerName and a ServerAlias value, i thought the SERVER_NAME\n global variable was filled with the ServerName value done in the vhost config.\n\nBut it's not the case. It give the value of the ServerName OR the ServerAlias. So i can't write a generic rule for each vhost of my httpd.conf file.\n\nIf i could, there will be two major advantages for me (and probably many others) :\n- currently, it would save 200 lines (50vhost * 2 lines) in my httpd.conf (in fact, i choose to use the .htaacess for readability, but performances are affected by it).\n\nThat's why i suggested an enhancement : fill SERVER_NAME with the ServerName value defined in the vhost, or, create a DEFAULT_SERVER_NAME variable to allow us to create generic rewriting rules.\n\nI assume the fact my first request was not clear and i apologize for it.\n\nThank you.", "id": 141464, "time": "2010-11-05T04:59:57Z", "bug_id": 47332, "creation_time": "2010-11-05T04:59:57Z", "tags": [], "is_private": false}, {"attachment_id": null, "tags": [], "creator": "nicolas_froidure@elitwork.com", "text": "Hi,\n\nI found the UseCanonicalName instruction that seems to fill SERVER_NAME with the default hostname given in the vhost.\n\nI found a discuss about my problem here :\nhttp://www.pubbs.net/200904/httpd/41857-usershttpd-server-variables-in-condpattern-of-rewritecond-directive.html\n\nI seems that it's impossible to use Server-Variables in condpattern of the RewriteCond instruction : http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html#rewritecond\n\nSo creating a DEFAULT_SERVER_NAME variable will not resolve anything.\n\nThe only way to do what i want is to do it manually.\n\nThank for you help.", "count": 5, "id": 141465, "time": "2010-11-05T05:46:26Z", "bug_id": 47332, "creation_time": "2010-11-05T05:46:26Z", "is_private": false}]