[{"count": 0, "tags": [], "text": "I have a simple program to test the function provided by Tomcat tribes:\n\n    public static void main(String[] args) throws Exception {\n        //create a channel\n        GroupChannel channel = new GroupChannel();\n        McastService mcastService = (McastService)channel.getMembershipService();\n        mcastService.setPort(MULTICAST_PORT);\n        mcastService.setAddress(MULTICAST_ADDRESS);\n\n        InetAddress localhost = InetAddress.getLocalHost();\n\n        // REVIEW: In my case, there are multiple IP addresses\n        // One for the WIFI and the other one for VPN. For some reason the VPN one doesn't support\n        // Multicast\n        // mcastService.setBind(\"192.168.1.100\");\n        channel.start(Channel.DEFAULT);\n        org.apache.catalina.tribes.tipis.ReplicatedMap map = new org.apache.catalina.tribes.tipis.ReplicatedMap(null, channel, 50, \"01\", null);\n        map.put(UUID.randomUUID().toString(), localhost.getHostAddress());\n        for (int i = 0; i < 4; i++) {\n            Thread.sleep(3000);\n            System.out.println(localhost + \": \" + map.keySet());\n        }\n        for (Object e : map.entrySetFull()) {\n            Map.Entry en = (Map.Entry)e;\n            org.apache.catalina.tribes.tipis.AbstractReplicatedMap.MapEntry entry = (org.apache.catalina.tribes.tipis.AbstractReplicatedMap.MapEntry)en.getValue();\n            System.out.println(entry);\n        }\n        map.breakdown();\n        channel.stop(Channel.DEFAULT);\n    }\n\nIf I run this programs on the same machine, I expect to see one entry per process. It works with tribes 6.0.18 but it fails in 6.0.20. \n\nLooking into the changelog, I found the following change is the cause of the problem.\n\nRevision: 757582\nAuthor: rjung\nDate: 4:01:31 PM, Monday, March 23, 2009\nMessage:\nAny cluster node should ignore its own heartbeat messages.\n\nBackport of r755302.\n----\nModified : /tomcat/tc6.0.x/trunk/STATUS.txt\nModified : /tomcat/tc6.0.x/trunk/java/org/apache/catalina/tribes/membership/McastServiceImpl.java\nModified : /tomcat/tc6.0.x/trunk/webapps/docs/changelog.xml\n\nsocket.setLoopbackMode(true) which disables the loopback. If I change the flag in debugger to false, then it works as in 6.0.18.", "is_private": false, "id": 128249, "creator": "rfeng@apache.org", "time": "2009-06-24T15:24:08Z", "bug_id": 47419, "creation_time": "2009-06-24T15:24:08Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "\n\n*** This bug has been marked as a duplicate of bug 47308 ***", "attachment_id": null, "id": 128250, "creator": "markt@apache.org", "time": "2009-06-24T15:31:30Z", "bug_id": 47419, "creation_time": "2009-06-24T15:31:30Z", "is_private": false}]