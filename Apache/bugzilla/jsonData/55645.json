[{"count": 0, "tags": [], "text": "Created attachment 30916\nOutlook MSG that gives the above error\n\nHello\n\nI've a message (attached to this bug), saved from Outlook 2010, that gives me ChunkNotFoundException when I try to call \ngetRtfBody\n\nCould you please check if there's a bug ? I'm using the latest stable release 3.9 on Android 4.0.1\n\nThanks a lot !\n\nPaolo", "is_private": false, "bug_id": 55645, "id": 170527, "time": "2013-10-10T08:00:24Z", "creator": "paolo.asioli@gmail.com", "creation_time": "2013-10-10T08:00:24Z", "attachment_id": 30916}, {"count": 1, "tags": [], "bug_id": 55645, "is_private": false, "text": "Are you sure your outlook file actually has a RTF part? (Not all of them do)", "id": 170544, "time": "2013-10-10T16:08:15Z", "creator": "apache@gagravarr.org", "creation_time": "2013-10-10T16:08:15Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 55645, "is_private": false, "text": "(In reply to Nick Burch from comment #1)\n> Are you sure your outlook file actually has a RTF part? (Not all of them do)\n\nDon't know for sure (don't know how to read a MSG by hand like an EML) but in Outlook it shows some richly formatted text.", "id": 170546, "time": "2013-10-10T18:09:49Z", "creator": "paolo.asioli@gmail.com", "creation_time": "2013-10-10T18:09:49Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 55645, "text": "Not all richly formatted text in Outlook is done using RTF! Does your message have a HTML chunk instead?\n\nTake a look at the Tika Outlook parser if you want a detailed example of using HSMF to process msg files:\nhttps://svn.apache.org/repos/asf/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/OutlookExtractor.java", "count": 3, "id": 170547, "time": "2013-10-10T18:29:57Z", "creator": "apache@gagravarr.org", "creation_time": "2013-10-10T18:29:57Z", "is_private": false}, {"count": 4, "tags": [], "text": "(In reply to Nick Burch from comment #3)\n> Not all richly formatted text in Outlook is done using RTF! Does your\n> message have a HTML chunk instead?\n> \n> Take a look at the Tika Outlook parser if you want a detailed example of\n> using HSMF to process msg files:\n> https://svn.apache.org/repos/asf/tika/trunk/tika-parsers/src/main/java/org/\n> apache/tika/parser/microsoft/OutlookExtractor.java\n\nYou're right, but I already get text, html and RTF and looks like there was none.\n\nSo I thought there may be some kind of bug, since Outlook showed some formatted text.\n\nHere is and extract of my code:\n\ntry {\n\tthis.messaggioHTML = msg.getHtmlBody();\n\tif (MainActivity.DEBUG) {\n\t\tandroid.util.Log.d(MainActivity.TAG, \"HTML Body: \"\n\t\t\t\t+ this.messaggioHTML);\n\t}\n} catch (ChunkNotFoundException e) {\n\tandroid.util.Log.e(MainActivity.TAG,\n\t\t\t\"HTML Body: not found\");\n\tthis.messaggioHTML = \"\";\n}\n\ntry {\n\tthis.messaggioTesto = msg.getTextBody();\n\tif (MainActivity.DEBUG) {\n\t\tandroid.util.Log.d(MainActivity.TAG, \"TXT Body: \"\n\t\t\t\t+ this.messaggioTesto);\n\t}\n} catch (ChunkNotFoundException e) {\n\tandroid.util.Log.e(MainActivity.TAG,\n\t\t\t\"TXT  Body: not found\");\n\tthis.messaggioTesto = \"\";\n}\n\ntry {\n\tString messaggioRtf = msg.getRtfBody();\n\n\tif (MainActivity.DEBUG) {\n\t\tandroid.util.Log.d(MainActivity.TAG, \"RTF Body: \"\n\t\t\t\t+ messaggioRtf);\n\t}\n\n} catch (ChunkNotFoundException e) {\n\tandroid.util.Log.e(MainActivity.TAG,\n\t\t\t\"RTF  Body: not found\");\n} catch (Exception e) {\n\t// TODO Auto-generated catch block\n\te.printStackTrace();\n}", "is_private": false, "bug_id": 55645, "id": 170548, "time": "2013-10-10T18:40:55Z", "creator": "paolo.asioli@gmail.com", "creation_time": "2013-10-10T18:40:55Z", "attachment_id": null}, {"count": 5, "tags": [], "text": "Outlook files tend to have one or two out of plain, rtf and html. It's very rare to have all 3. If your file only has rtf, and you really wanted something like html, you'd be best off using Apache Tika as that can convert for you", "attachment_id": null, "bug_id": 55645, "id": 170549, "time": "2013-10-10T19:31:56Z", "creator": "apache@gagravarr.org", "creation_time": "2013-10-10T19:31:56Z", "is_private": false}, {"count": 6, "tags": [], "text": "(In reply to Nick Burch from comment #5)\n> Outlook files tend to have one or two out of plain, rtf and html. It's very\n> rare to have all 3. If your file only has rtf, and you really wanted\n> something like html, you'd be best off using Apache Tika as that can convert\n> for you\n\nMaybe I didn't explain myself correctly. The attached example apparently has \nNO plain text\nNO HTML\nNO RTF\naccording to Apache POI.\n\nBut since I see text when opening in Outlook, I think there may be a problem.\n\nDid you test the MSG attachment to confirm my report ?", "attachment_id": null, "bug_id": 55645, "id": 170551, "time": "2013-10-10T19:47:33Z", "creator": "paolo.asioli@gmail.com", "creation_time": "2013-10-10T19:47:33Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 55645, "attachment_id": null, "text": "What kind of additional information do you need ? There's a MSG attached that to my tests shows this anomaly (no plain, no HTML and no RTF, yet when opened on Outlook presents formatted text).\nDon't know what's the problem, but I think I gave ample information to investigate...\n\nPlease let me know.", "id": 170579, "time": "2013-10-11T22:38:45Z", "creator": "paolo.asioli@gmail.com", "creation_time": "2013-10-11T22:38:45Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 55645, "text": "Are you able to use one of the tools like POIFSViewer or POIFSDump to identify which chunk (POIFS Entry) actually contains your text? That will help us narrow down what's wrong", "count": 8, "id": 170587, "time": "2013-10-12T21:19:33Z", "creator": "apache@gagravarr.org", "creation_time": "2013-10-12T21:19:33Z", "is_private": false}, {"count": 9, "text": "(In reply to Nick Burch from comment #8)\n> Are you able to use one of the tools like POIFSViewer or POIFSDump to\n> identify which chunk (POIFS Entry) actually contains your text? That will\n> help us narrow down what's wrong\n\nThanks for the tip. I'll try that and get back with relevant information.\nCheers", "bug_id": 55645, "is_private": false, "id": 170591, "time": "2013-10-13T11:16:38Z", "creator": "paolo.asioli@gmail.com", "creation_time": "2013-10-13T11:16:38Z", "tags": [], "attachment_id": null}, {"count": 10, "tags": [], "text": "No update for a long time, therefore I am closing this for now, please reopen with the promised additional information if this is still an issue for you.", "is_private": false, "bug_id": 55645, "id": 184610, "time": "2015-08-17T20:58:17Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-08-17T20:58:17Z", "attachment_id": null}, {"count": 11, "tags": [], "creator": "adrian.conlon@arup.com", "attachment_id": null, "is_private": false, "id": 190109, "time": "2016-04-10T18:09:38Z", "bug_id": 55645, "creation_time": "2016-04-10T18:09:38Z", "text": "An old problem, I realise, but here's some extra information that explains the symptoms (and why this *isn't* a POI issue):\n\nThe email message class is: IPM.Note.SMIME.MultipartSigned.  This means it's a digitally signed email with modifications effectively disabled.\n\nAs a signed email, this means the content is held in an attachment (one of \"smime.p7m\", \"smime.txt\" or \"smime.p7s\").\n\nIn this instance, the signed content is held in \"smime.p7m\" (which is pretty much the most common place).\n\nThe content is of this attachment is mime encoded.  Look for the \"multipart/alternative\" set, then pick out which part is best suited to your needs (I usually just pick out the \"text/plain\" part for body text extraction). Apache James Mime4j should do the trick..."}]