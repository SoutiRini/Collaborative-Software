[{"count": 0, "tags": [], "bug_id": 23098, "attachment_id": null, "is_private": false, "id": 44024, "time": "2003-09-11T09:25:06Z", "creator": "klausmartinschitz@msn.com", "creation_time": "2003-09-11T09:25:06Z", "text": "I have downloaded xindice ant tried to compile it with ant. Everything is\ncompiled without int[] opMap=cmp.getOpMap();. This instruction is somewhere at\nline 502 in\norg.apache.xindice.core.query.XPathQueryResolver.\n\nError Report is\n\ninit:\nidl:\nprepare:\nclean-jar:\nsrc:\nCompiling Source\nCompiling 1 source file to D:\\Programme\\ApacheGroup\\xml-xindice-1.0\\java\\classes\njava\\src\\org\\apache\\xindice\\core\\query\\XPathQueryResolver.java [503]\nincompatible types\nfound   : org.apache.xpath.compiler.OpMapVector\nrequired: int[]\n         int[] opMap=cmp.getOpMap();\n                                 ^\n1 error\nbuild.xml [123] Compile failed; see the compiler error output for details.\nBUILD FAILED\nTotal time: 30 seconds\n\n\nIt seems to be a casting exception. I realy don't know why compiler finds a\norg.apache.xpath.compiler.OpMapVector object. class should return int[] array.\nIs this a bug? I haven't changed anything after downloading and unzipping\nxindice package. I just compiled it."}, {"count": 1, "tags": [], "bug_id": 23098, "attachment_id": null, "text": "This occurs when you compile using JDK 1.4. In that JDK there is an embedded \nversion of Xalan, which takes precedence to ANY other version of Xalan that you \nput in your classpath.\n\nIn this particular case the XPathQueryResolver class needs to have some old \nversion of Xalan (2.4.0 to be exact), because getOpMap() returns an array in \nthat version. However Java overrides Xalan with its own embedded version, in \nwhich the method has been modified to return an OpMapVector object. Hence, the \nerror.\n\nOne way to solve this problem is to add a line to Xindice's build.xml file, in \nthe src-build target:\n\nBEFORE PATCH:\n\n    <target name=\"src-build\"\n            depends=\"init\">           \n       <javac srcdir=\"${src.dir}\"\n             destdir=\"${src.build.dir}\"\n             debug=\"${compile.debug}\"\n             optimize=\"${compile.optimize}\"\n             nowarn=\"${compile.nowarn}\"\n             deprecation=\"${compile.deprecation}\"\n             verbose=\"${compile.verbose}\">          \n          <classpath>\n             <path refid=\"project.class.path\"/>\n          </classpath>          \n       </javac>\n    </target>\n\nAFTER PATCH:\n\n    <target name=\"src-build\"\n            depends=\"init\">           \n       <javac srcdir=\"${src.dir}\"\n             destdir=\"${src.build.dir}\"\n             debug=\"${compile.debug}\"\n             optimize=\"${compile.optimize}\"\n             nowarn=\"${compile.nowarn}\"\n             deprecation=\"${compile.deprecation}\"\n             verbose=\"${compile.verbose}\">          \n          <classpath>\n             <path refid=\"project.class.path\"/>\n          </classpath>          \n\t  <compilerarg value=\"-Xbootclasspath/p:${jar.dir}/xalan-2.4.0.jar\"/>\n       </javac>\n    </target>\n\nEND PATCH\n\nThis ensures that the JDK will use the correct version of Xalan. For more \ninformation see\nhttp://xml.apache.org/xalan-j/faq.html#faq-N100CB\n\n--\nMathieu Vezeau\nmathieuvezeau@yahoo.com\n", "id": 44724, "time": "2003-09-25T22:22:23Z", "creator": "mathieuvezeau@yahoo.com", "creation_time": "2003-09-25T22:22:23Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 23098, "attachment_id": null, "is_private": false, "id": 44729, "time": "2003-09-26T00:13:59Z", "creator": "mathieuvezeau@yahoo.com", "creation_time": "2003-09-26T00:13:59Z", "text": "Of course the best way is probably to just change the source to support the new \nXalan API (v.2.4.1 or later)  :-)"}, {"count": 3, "tags": [], "bug_id": 23098, "text": "Currect xindice CVS (1.1) compiles and works with the latest xalan without\nerrors. Marking as WONTFIX because 1.0 release will not be fixed.", "id": 48877, "time": "2003-12-11T01:50:49Z", "creator": "vgritsenko@apache.org", "creation_time": "2003-12-11T01:50:49Z", "is_private": false, "attachment_id": null}]