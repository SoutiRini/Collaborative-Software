[{"count": 0, "tags": [], "creator": "faye.pearson@betfair.com", "text": "Running Tomcat in a JBOSS container.\nI am having a problem where threads aren't being destroyed when there are too many idle threads:\n\n      <!-- A HTTP/1.1 Connector on port 8080 -->\n      <Connector port=\"${tomcat.port}\" address=\"${jboss.bind.address}\"\n         maxThreads=\"500\" minSpareThreads=\"50\" maxSpareThreads=\"100\" strategy=\"ms\" \nmaxHttpHeaderSize=\"8192\"\n         emptySessionPath=\"true\"\n         enableLookups=\"false\" redirectPort=\"${tomcat.secure.port}\" acceptCount=\n\"100\"\n         connectionTimeout=\"20000\" disableUploadTimeout=\"true\"/>\n\n$ for host in `seq -w 1 30`; do echo $host; wget -qO - \nhttp://exobxw$host/administration/queryjmx.jsp | grep currentThread; done\n(trimmed output where the values were within expected limits)\n09\njboss.web:name=http-0.0.0.0-8080,type=ThreadPool: currentThreadCount: 153\njboss.web:name=http-0.0.0.0-8080,type=ThreadPool: currentThreadsBusy: 18\n11\njboss.web:name=http-0.0.0.0-8080,type=ThreadPool: currentThreadCount: 315\njboss.web:name=http-0.0.0.0-8080,type=ThreadPool: currentThreadsBusy: 27\n22\njboss.web:name=http-0.0.0.0-8080,type=ThreadPool: currentThreadCount: 220\njboss.web:name=http-0.0.0.0-8080,type=ThreadPool: currentThreadsBusy: 18\n23\njboss.web:name=http-0.0.0.0-8080,type=ThreadPool: currentThreadCount: 185\njboss.web:name=http-0.0.0.0-8080,type=ThreadPool: currentThreadsBusy: 18\n24\njboss.web:name=http-0.0.0.0-8080,type=ThreadPool: currentThreadCount: 141\njboss.web:name=http-0.0.0.0-8080,type=ThreadPool: currentThreadsBusy: 14\n25\njboss.web:name=http-0.0.0.0-8080,type=ThreadPool: currentThreadCount: 188\njboss.web:name=http-0.0.0.0-8080,type=ThreadPool: currentThreadsBusy: 18\n27\njboss.web:name=http-0.0.0.0-8080,type=ThreadPool: currentThreadCount: 127\njboss.web:name=http-0.0.0.0-8080,type=ThreadPool: currentThreadsBusy: 21\n28\njboss.web:name=http-0.0.0.0-8080,type=ThreadPool: currentThreadCount: 247\njboss.web:name=http-0.0.0.0-8080,type=ThreadPool: currentThreadsBusy: 15\n29\njboss.web:name=http-0.0.0.0-8080,type=ThreadPool: currentThreadCount: 202\njboss.web:name=http-0.0.0.0-8080,type=ThreadPool: currentThreadsBusy: 18\n30\njboss.web:name=http-0.0.0.0-8080,type=ThreadPool: currentThreadCount: 242\njboss.web:name=http-0.0.0.0-8080,type=ThreadPool: currentThreadsBusy: 16\n\nThere's a bug raised in the JBOSS JIRA which has been marked as a \"will not fix\" because Tomcat is \nusing the wrong thread pool:\n\nhttp://jira.jboss.org/jira/browse/JBAS-4412\n\nRemy Maucherat [27/Nov/07 11:31 AM]\nThe thread pool used in that Tomcat version does not have the capability to scale back the amount of \nthreads used.\n\nThis used to work in an older version, I believe.", "id": 112495, "attachment_id": null, "bug_id": 44170, "creation_time": "2008-01-04T07:03:29Z", "time": "2008-01-04T07:03:29Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 44170, "text": "This works as expected in Tomcat 5.5.25. I am not aware of this not working in a\nprevious Tomcat version. This looks like a JBoss issue to me.", "id": 112505, "time": "2008-01-04T13:32:26Z", "creator": "markt@apache.org", "creation_time": "2008-01-04T13:32:26Z", "is_private": false, "attachment_id": null}]