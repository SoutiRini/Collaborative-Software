[{"attachment_id": null, "tags": [], "bug_id": 58935, "text": "It appears that it is not possible to re-deploy a web application while the server is running without Tomcat cleaning up the context in /conf/Catalina/localhost/.\n\n\nWe want in server.xml\n\n<Host name=\"localhost\"  appBase=\"webapps\"\n            unpackWARs=\"true\" autoDeploy=\"false\">\n\nCurrently, the context file /conf/Catalina/localhost/appName.xml is deleted on the undeploy part of the re-deploy cycle.\n\nWe do not want the deletion of this file. We want a genuine update of the application that can be executed via the manager console by just overwriting the existing .war file. Currently, the manager application requires an undeployment first which cleans up the configuration.\n\nOr in other words, we want some means of updating the running application in a controlled fashion for production use. With controlled fashion we mean that we don't want to be exposed to the complexity that comes with autoDeploy=\"false\". From our perspective, the manager application should have the capability to upload and overwrite an existing .war file, explode it and reload the application without deleting the context. We do not want to put the context into the war file because it contains installation specific configuration.", "count": 0, "id": 188023, "time": "2016-01-29T03:01:45Z", "creator": "bht237@gmail.com", "creation_time": "2016-01-29T03:01:45Z", "is_private": false}, {"count": 1, "tags": [], "creator": "bht237@gmail.com", "text": "Sorry I should have written:\n\nWith controlled fashion we mean that we don't want to be exposed to the complexity that comes with autoDeploy=\"true\".", "id": 188024, "time": "2016-01-29T03:04:20Z", "bug_id": 58935, "creation_time": "2016-01-29T03:04:20Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "markt@apache.org", "text": "You should be able to use the Manager text interface to do that. The update option isn't avaialble in the HTML UI. We should look at adding that.", "id": 188076, "time": "2016-01-31T11:02:49Z", "bug_id": 58935, "creation_time": "2016-01-31T11:02:49Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 58935, "attachment_id": null, "text": "Thanks Mark for the info.\n\nI looked again at\n\nhttps://tomcat.apache.org/tomcat-8.0-doc/manager-howto.html#Reload_An_Existing_Application\n\nWith http://host:port/manager/text/deploy?path=/mypath&update=true&war=jar:file:/tomcat/mywardr/mypath.war!/\n\nFAIL - Deployed application at context path /mypath but context failed to start\n\nI could not figure out how to use the update parameter in any of the commands without getting an undeploy and subsequent context xml file loss.", "id": 188093, "time": "2016-02-01T04:09:06Z", "creator": "bht237@gmail.com", "creation_time": "2016-02-01T04:09:06Z", "is_private": false}, {"count": 4, "attachment_id": null, "bug_id": 58935, "text": "I think the docs need fixing. Try something like this:\n\nhttp://localhost:8080/manager/text/deploy?war=file:/d:/test1.war&path=/test&update=true\nhttp://localhost:8080/manager/text/deploy?war=file:/d:/test2.war&path=/test&update=true\n\nThis works for me. It swaps between test1.war and test2.war deployed as test.war and $CATALINA_BASE/conf/Catalina/localhost/test.xml remains untouched", "id": 188206, "time": "2016-02-04T10:09:45Z", "creator": "markt@apache.org", "creation_time": "2016-02-04T10:09:45Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "text": "I've updated the docs to remove the (very) out of date references to using jar:file: URLs.\n\nThe fix has been applied to 9.0.x for 9.0.0.M3, 8.0.x for 8.0.33, 7.0.x 7.0.68 and 6.0.x for 6.0.46 onwards.", "attachment_id": null, "bug_id": 58935, "id": 188213, "time": "2016-02-04T12:09:32Z", "creator": "markt@apache.org", "creation_time": "2016-02-04T12:09:32Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 58935, "text": "Thanks for the command line options. Would you please clarify in which release the update option will be available in the HTML UI. Many thanks.", "count": 6, "id": 192755, "time": "2016-07-31T23:03:06Z", "creator": "bht237@gmail.com", "creation_time": "2016-07-31T23:03:06Z", "is_private": false}, {"count": 7, "tags": [], "creator": "vinyjones@hotmail.fr", "attachment_id": null, "id": 196892, "time": "2017-02-09T23:08:30Z", "bug_id": 58935, "creation_time": "2017-02-09T23:08:30Z", "is_private": false, "text": "Could we have juste an option to prevent it from happening ?\nSo there will be no probleme of retrocompatibility."}]