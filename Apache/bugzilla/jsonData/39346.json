[{"count": 0, "tags": [], "text": "The following scriplet does not compile: \n\n<i18n:bundle baseName=\"TextBundle/text\" localeRef=\"userLocale\" id=\"text\" />\n\n\t<% \n\tif(true) {%>\n           <i18n:message bundleRef=\"text\" key=\"my_key\" id=\"value\"/>\n\t<% } else { %>\n\t    <i18n:message bundleRef=\"text\" key=\"my_key\" id=\"value\"/>\n\t    <% } %>\n\nWhen launched, throws an exception: \n\norg.apache.jasper.JasperException: Unable to compile class for JSP\n\nGenerated servlet error:\nC:\\Fujitsu\\InterstageBPM\\taskmanager\\tomcat\\work\\Catalina\\localhost\\ibpm\\org\\apache\\jsp\\jsp\\TestJSP_jsp.java:120:\ncannot resolve symbol\nsymbol  : variable value \nlocation: class org.apache.jsp.jsp.TestJSP_jsp\n      value = (java.lang.String) _jspx_page_context.findAttribute(\"value\");\n      ^\n1 error\n\n\nIn the servlet TestJSP_jsp.java, the corresponding code looks like\n\n\nif(true) {\n      //  i18n:message\n org.apache.taglibs.i18n.MessageTag _jspx_th_i18n_message_0 =      \n(org.apache.taglibs.i18n.MessageTag)   \n_jspx_tagPool_i18n_message_key_id_bundleRef_nobody.get(org.apache.taglibs.i18n.MessageTag.class);\n      \n_jspx_th_i18n_message_0.setPageContext(_jspx_page_context);_jspx_th_i18n_message_0.setParent(null);\n    _jspx_th_i18n_message_0.setBundleRef(\"text\");\n      _jspx_th_i18n_message_0.setKey(\"my_key\");\n      _jspx_th_i18n_message_0.setId(\"value\");\n      int _jspx_eval_i18n_message_0 = _jspx_th_i18n_message_0.doStartTag();\n      if (_jspx_th_i18n_message_0.doEndTag() ==\njavax.servlet.jsp.tagext.Tag.SKIP_PAGE)\n        return;\n     \n_jspx_tagPool_i18n_message_key_id_bundleRef_nobody.reuse(_jspx_th_i18n_message_0);\n\njava.lang.String value = null;\n      value = (java.lang.String) _jspx_page_context.findAttribute(\"value\");\n} else {\n      org.apache.taglibs.i18n.MessageTag _jspx_th_i18n_message_1 =\n(org.apache.taglibs.i18n.MessageTag)\n_jspx_tagPool_i18n_message_key_id_bundleRef_nobody.get(org.apache.taglibs.i18n.MessageTag.class);\n      _jspx_th_i18n_message_1.setPageContext(_jspx_page_context);\n      _jspx_th_i18n_message_1.setParent(null);\n      _jspx_th_i18n_message_1.setBundleRef(\"text\");\n      _jspx_th_i18n_message_1.setKey(\"my_key\");\n      _jspx_th_i18n_message_1.setId(\"value\");\n      int _jspx_eval_i18n_message_1 = _jspx_th_i18n_message_1.doStartTag();\n      if (_jspx_th_i18n_message_1.doEndTag() ==\njavax.servlet.jsp.tagext.Tag.SKIP_PAGE)\n        return;\n     \n_jspx_tagPool_i18n_message_key_id_bundleRef_nobody.reuse(_jspx_th_i18n_message_1);\n      \n//HERE IS WHERE IT GOES WRONG! \n\nvalue = (java.lang.String) _jspx_page_context.findAttribute(\"value\");\n \t} \n\n\nIn the else-part, the variable <code>value<code> is not declared, which is the\ncause of compilation error. It looks like the tag in the if-part sees that there\nis already a variable with the same name, and tries to reuse it. The problem is\naybe in the method <code>getVariableInfo TagData data)</code> in the\n<code>MessageTEI</code> class: \n\n\npublic VariableInfo [] getVariableInfo (TagData data)\n    {\n        String varName = data.getId();\n        if ( varName == null ) {\n            return new VariableInfo[] {};\n        } else {\n            return new VariableInfo [] {\n                new VariableInfo(varName,\n                                 \"java.lang.String\",\n                                 true,\n                                 VariableInfo.AT_END)\n            };\n        }\n    }\n\nOne should probably investigate the scope of the variable, in case it was\nalready declared somewhere earlier in the page.", "attachment_id": null, "id": 88257, "creator": "olga.bobrovnytska@est.fujitsu.com", "time": "2006-04-19T09:00:04Z", "bug_id": 39346, "creation_time": "2006-04-19T09:00:04Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 39346, "attachment_id": null, "id": 128700, "time": "2009-07-10T00:37:13Z", "creator": "bayard@apache.org", "creation_time": "2009-07-10T00:37:13Z", "is_private": false, "text": "JSTL replaced the i18n taglib, so this won't be worked on."}]