[{"count": 0, "tags": [], "creator": "ed@belisle.com", "attachment_id": null, "text": "Moving a file to a differet volume resets owner.group to current user.\n\nExample:\n1) Run as root\n2) Current directory is on a different volume then /tmp.\n3) Ant task (movefail.xml attached, bash pseudo code shown):\n   a) touch /tmp/movefile_from\n   b) chown ed /tmp/movefile_from\n   c) mv /tmp/movefile_from ./movefile_to\n4) owner of movefile_to is now root.\n\nNotes: \n1) Move task attempts to rename file, but ends up copying file instead.\n2) OS (rhel5) is able to move file to new volume and preserve owner", "id": 124879, "time": "2009-02-16T19:45:19Z", "bug_id": 46718, "creation_time": "2009-02-16T19:45:19Z", "is_private": false}, {"count": 1, "tags": [], "creator": "ed@belisle.com", "attachment_id": null, "is_private": false, "id": 124880, "time": "2009-02-16T19:50:06Z", "bug_id": 46718, "creation_time": "2009-02-16T19:50:06Z", "text": "<project default=\"test\">\n\t<target name=\"test\">\n\t<!-- assumes current directory on differnt volume then /tmp -->\n\t\t<touch file=\"movefile_from\"/>\n\t\t<chown file=\"movefile_from\" owner=\"ed\"/>\n                <move  file=\"movefile_from\" tofile=\"movefile_to\"/>\n\n\t\t<touch file=\"movefile_from\"/>\n\t\t<chown file=\"movefile_from\" owner=\"ed\"/>\n                <move  file=\"movefile_from\" tofile=\"/tmp/movefile_to\"/>\n\t</target>\n</project>\n"}, {"count": 2, "tags": [], "creator": "ed@belisle.com", "attachment_id": null, "text": "[root@server3 ~]# clear; ant -f movefail.xml -v; ls -l movefile_to /tmp/movefile_to\n\nApache Ant version 1.7.1 compiled on June 27 2008\nBuildfile: movefail.xml\nDetected Java version: 1.6 in: /usr/java/jdk1.6.0_10/jre\nDetected OS: Linux\nparsing buildfile /root/movefail.xml with URI = file:/root/movefail.xml\nProject base dir set to: /root\nBuild sequence for target(s) `test' is [test]\nComplete build sequence is [test, ]\n\ntest:\n[antlib:org.apache.tools.ant] Could not load definitions from resource org/apache/tools/ant/antlib.xml. It could not be found.\n    [touch] Creating /root/movefile_from\n    [chown] Current OS is Linux\n    [chown] Executing 'chown' with arguments:\n    [chown] 'ed'\n    [chown] '/root/movefile_from'\n    [chown] \n    [chown] The ' characters around the executable and arguments are\n    [chown] not part of the command.\n    [chown] Applied chown to 1 file and 0 directories.\n     [move] Moving 1 file to /root\n     [move] Attempting to rename: /root/movefile_from to /root/movefile_to\n    [touch] Creating /root/movefile_from\n    [chown] Current OS is Linux\n    [chown] Executing 'chown' with arguments:\n    [chown] 'ed'\n    [chown] '/root/movefile_from'\n    [chown] \n    [chown] The ' characters around the executable and arguments are\n    [chown] not part of the command.\n    [chown] Applied chown to 1 file and 0 directories.\n     [move] Moving 1 file to /tmp\n     [move] Attempting to rename: /root/movefile_from to /tmp/movefile_to\n     [move] Copying /root/movefile_from to /tmp/movefile_to\n\nBUILD SUCCESSFUL\nTotal time: 0 seconds\n-rw-r--r-- 1 ed   root 0 Feb 16 21:11 movefile_to\n-rw-r--r-- 1 root root 0 Feb 16 21:11 /tmp/movefile_to\n", "id": 124881, "time": "2009-02-16T19:51:31Z", "bug_id": 46718, "creation_time": "2009-02-16T19:51:31Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 46718, "text": "This is true, and unfortunately it is something we cannot fix without leaving the world of Java - because Java's file system API is too poor to even provide us with the current owner information, much less allow us to set it.\n\nIn a scenario like your's, using <exec> and the native mv command really is the only option, I'm afraid.\n\nCANTFIX rather than WONTFIX", "id": 124927, "time": "2009-02-18T08:14:24Z", "creator": "bodewig@apache.org", "creation_time": "2009-02-18T08:14:24Z", "is_private": false, "attachment_id": null}]