[{"count": 0, "tags": [], "bug_id": 59110, "attachment_id": 33620, "id": 189058, "time": "2016-03-03T14:07:48Z", "creator": "tfilteau@flexgroup.com", "creation_time": "2016-03-03T14:07:48Z", "is_private": false, "text": "Created attachment 33620\nFile to reproduce the bug illustrated above\n\nI'm running BIRT reports using the BIRT webviewer and everything worked fine until I decided to upgrade from Tomcat 8.0.28 to Tomcat 8.0.32 where some of my reports failed with the error \"String index out of bound exception\". The reports were those that included the \"importPackage\" statement. Here's how to reproduce the bug:\n\n1) Have Tomcat 8.0.32 properly installed and running\n2) Download the latest BIRT runtime\n3) Take the birt.war file inside what you just downloaded and put it in the webapps directory of Tomcat so that it'll get deployed.\n4) The deployment should have created a \"birt\" folder inside the webapps directory. Go inside and replace the test.rptdesign with the one I attached to this bug report.\n5) Navigate to localhost:8080/birt and click the \"View example\" at the bottom of the page which should trigger the bug.\n\nJust to be sure, here is the stack trace that's displayed:\n\norg.eclipse.birt.report.engine.api.EngineException: There are errors evaluating script \"importPackage(Packages.org.eclipse.birt.report.item.crosstab.core.de);\":\nString index out of range: 3\n   at org.eclipse.birt.report.engine.script.internal.ScriptExecutor.addException(ScriptExecutor.java:249)\n   at org.eclipse.birt.report.engine.script.internal.ReportScriptExecutor.handleInitialize(ReportScriptExecutor.java:93)\n   at org.eclipse.birt.report.engine.api.impl.EngineTask.loadDesign(EngineTask.java:1971)\n   at org.eclipse.birt.report.engine.api.impl.RunTask.doRun(RunTask.java:219)\n   at org.eclipse.birt.report.engine.api.impl.RunTask.run(RunTask.java:89)\n   at org.eclipse.birt.report.service.ReportEngineService.runReport(ReportEngineService.java:1325)\n   at org.eclipse.birt.report.service.BirtViewerReportService.runReport(BirtViewerReportService.java:159)\n   at org.eclipse.birt.report.service.actionhandler.BirtRunReportActionHandler.__execute(BirtRunReportActionHandler.java:81)\n   at org.eclipse.birt.report.service.actionhandler.BirtGetPageActionHandler.__checkDocumentExists(BirtGetPageActionHandler.java:58)\n   at org.eclipse.birt.report.service.actionhandler.AbstractGetPageActionHandler.prepareParameters(AbstractGetPageActionHandler.java:118)\n   at org.eclipse.birt.report.service.actionhandler.AbstractGetPageActionHandler.__execute(AbstractGetPageActionHandler.java:103)\n   at org.eclipse.birt.report.service.actionhandler.AbstractBaseActionHandler.execute(AbstractBaseActionHandler.java:90)\n   at org.eclipse.birt.report.soapengine.processor.AbstractBaseDocumentProcessor.__executeAction(AbstractBaseDocumentProcessor.java:47)\n   at org.eclipse.birt.report.soapengine.processor.AbstractBaseComponentProcessor.executeAction(AbstractBaseComponentProcessor.java:143)\n   at org.eclipse.birt.report.soapengine.processor.BirtDocumentProcessor.handleGetPage(BirtDocumentProcessor.java:87)\n   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n   at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n   at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n   at java.lang.reflect.Method.invoke(Unknown Source)\n   at org.eclipse.birt.report.soapengine.processor.AbstractBaseComponentProcessor.process(AbstractBaseComponentProcessor.java:112)\n   at org.eclipse.birt.report.soapengine.endpoint.BirtSoapBindingImpl.getUpdatedObjects(BirtSoapBindingImpl.java:66)\n   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n   at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n   at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n   at java.lang.reflect.Method.invoke(Unknown Source)\n   at org.apache.axis.providers.java.RPCProvider.invokeMethod(RPCProvider.java:397)\n   at org.apache.axis.providers.java.RPCProvider.processMessage(RPCProvider.java:186)\n   at org.apache.axis.providers.java.JavaProvider.invoke(JavaProvider.java:323)\n   at org.apache.axis.strategies.InvocationStrategy.visit(InvocationStrategy.java:32)\n   at org.apache.axis.SimpleChain.doVisiting(SimpleChain.java:118)\n   at org.apache.axis.SimpleChain.invoke(SimpleChain.java:83)\n   at org.apache.axis.handlers.soap.SOAPService.invoke(SOAPService.java:454)\n   at org.apache.axis.server.AxisServer.invoke(AxisServer.java:281)\n   at org.apache.axis.transport.http.AxisServlet.doPost(AxisServlet.java:699)\n   at org.eclipse.birt.report.servlet.BirtSoapMessageDispatcherServlet.doPost(BirtSoapMessageDispatcherServlet.java:265)\n   at javax.servlet.http.HttpServlet.service(HttpServlet.java:648)\n   at org.apache.axis.transport.http.AxisServletBase.service(AxisServletBase.java:327)\n   at javax.servlet.http.HttpServlet.service(HttpServlet.java:729)\n   at org.eclipse.birt.report.servlet.BirtSoapMessageDispatcherServlet.service(BirtSoapMessageDispatcherServlet.java:122)\n   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:292)\n   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n   at org.eclipse.birt.report.filter.ViewerFilter.doFilter(ViewerFilter.java:68)\n   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)\n   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n   at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)\n   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)\n   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)\n   at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:212)\n   at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:106)\n   at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:502)\n   at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:141)\n   at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79)\n   at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:616)\n   at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:88)\n   at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:522)\n   at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1095)\n   at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:672)\n   at org.apache.tomcat.util.net.AprEndpoint$SocketProcessor.doRun(AprEndpoint.java:2500)\n   at org.apache.tomcat.util.net.AprEndpoint$SocketProcessor.run(AprEndpoint.java:2489)\n   at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\n   at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n   at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\n   at java.lang.Thread.run(Unknown Source)\nCaused by: org.eclipse.birt.core.exception.CoreException: There are errors evaluating script \"importPackage(Packages.org.eclipse.birt.report.item.crosstab.core.de);\":\nString index out of range: 3\n   at org.eclipse.birt.report.engine.javascript.JavascriptEngine.evaluate(JavascriptEngine.java:295)\n   at org.eclipse.birt.core.script.ScriptContext.evaluate(ScriptContext.java:159)\n   at org.eclipse.birt.report.engine.executor.ExecutionContext.evaluate(ExecutionContext.java:789)\n   at org.eclipse.birt.report.engine.executor.ExecutionContext.evaluate(ExecutionContext.java:718)\n   at org.eclipse.birt.report.engine.script.internal.ScriptExecutor.handleScriptInternal(ScriptExecutor.java:118)\n   at org.eclipse.birt.report.engine.script.internal.ScriptExecutor.handleScript(ScriptExecutor.java:105)\n   at org.eclipse.birt.report.engine.script.internal.ReportScriptExecutor.handleInitialize(ReportScriptExecutor.java:84)\n... 61 more\nCaused by: java.lang.StringIndexOutOfBoundsException: String index out of range: 3\n   at java.lang.String.charAt(Unknown Source)\n   at org.apache.catalina.loader.WebappClassLoaderBase.filter(WebappClassLoaderBase.java:2780)\n   at org.apache.catalina.loader.WebappClassLoaderBase.loadClass(WebappClassLoaderBase.java:1253)\n   at java.lang.ClassLoader.loadClass(Unknown Source)\n   at java.lang.ClassLoader.loadClass(Unknown Source)\n   at java.lang.ClassLoader.loadClass(Unknown Source)\n   at org.eclipse.birt.report.engine.executor.ApplicationClassLoader.loadClass(ApplicationClassLoader.java:89)\n   at org.mozilla.javascript.Kit.classOrNull(Kit.java:60)\n   at org.mozilla.javascript.NativeJavaPackage.getPkgProperty(NativeJavaPackage.java:127)\n   at org.mozilla.javascript.NativeJavaPackage.get(NativeJavaPackage.java:82)\n   at org.mozilla.javascript.NativeJavaTopPackage.init(NativeJavaTopPackage.java:96)\n   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n   at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n   at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n   at java.lang.reflect.Method.invoke(Unknown Source)\n   at org.mozilla.javascript.ScriptableObject.buildClassCtor(ScriptableObject.java:1225)\n   at org.mozilla.javascript.LazilyLoadedCtor.buildValue0(LazilyLoadedCtor.java:105)\n   at org.mozilla.javascript.LazilyLoadedCtor.buildValue(LazilyLoadedCtor.java:96)\n   at org.mozilla.javascript.LazilyLoadedCtor.init(LazilyLoadedCtor.java:66)\n   at org.mozilla.javascript.ScriptableObject$GetterSlot.getValue(ScriptableObject.java:307)\n   at org.mozilla.javascript.ScriptableObject$RelinkedSlot.getValue(ScriptableObject.java:347)\n   at org.mozilla.javascript.ScriptableObject.get(ScriptableObject.java:456)\n   at org.mozilla.javascript.IdScriptableObject.get(IdScriptableObject.java:329)\n   at org.mozilla.javascript.ImporterTopLevel.get(ImporterTopLevel.java:96)\n   at org.mozilla.javascript.ScriptableObject.getProperty(ScriptableObject.java:2184)\n   at org.mozilla.javascript.ScriptRuntime.topScopeName(ScriptRuntime.java:1824)\n   at org.mozilla.javascript.ScriptRuntime.nameOrFunction(ScriptRuntime.java:1791)\n   at org.mozilla.javascript.ScriptRuntime.name(ScriptRuntime.java:1733)\n   at org.mozilla.javascript.gen._report_method__name__initialize___12._c_script_0(/report/method[@name=\"initialize\"]:1)\n   at org.mozilla.javascript.gen._report_method__name__initialize___12.call(/report/method[@name=\"initialize\"])\n   at org.mozilla.javascript.ContextFactory.doTopCall(ContextFactory.java:394)\n   at org.mozilla.javascript.ScriptRuntime.doTopCall(ScriptRuntime.java:3091)\n   at org.mozilla.javascript.gen._report_method__name__initialize___12.call(/report/method[@name=\"initialize\"])\n   at org.mozilla.javascript.gen._report_method__name__initialize___12.exec(/report/method[@name=\"initialize\"])\n   at org.eclipse.birt.report.engine.javascript.JavascriptEngine.evaluate(JavascriptEngine.java:290)\n... 67 more"}, {"count": 1, "tags": [], "bug_id": 59110, "is_private": false, "text": "\n\n*** This bug has been marked as a duplicate of bug 58999 ***", "id": 189059, "time": "2016-03-03T15:08:14Z", "creator": "violetagg@apache.org", "creation_time": "2016-03-03T15:08:14Z", "attachment_id": null}]