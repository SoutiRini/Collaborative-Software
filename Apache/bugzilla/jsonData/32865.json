[{"count": 0, "tags": [], "bug_id": 32865, "attachment_id": null, "text": "Apps are deployed on host start up whether deployOnStartup is set to true or false.\n\nPatch:\n\nIndex: HostConfig.java\n===================================================================\nRCS file:\n/home/cvspublic/jakarta-tomcat-catalina/catalina/src/share/org/apache/catalina/startup/HostConfig.java,v\nretrieving revision 1.51\ndiff -u -r1.51 HostConfig.java\n--- HostConfig.java\t1 Dec 2004 11:06:22 -0000\t1.51\n+++ HostConfig.java\t28 Dec 2004 19:59:17 -0000\n@@ -1101,7 +1101,8 @@\n             log.error(sm.getString(\"hostConfig.jmx.register\", oname), e);\n         }\n         \n-        deployApps();\n+        if (host.getDeployOnStartup()) \n+            deployApps();\n         \n     }", "id": 69043, "time": "2004-12-28T21:43:05Z", "creator": "tbenbrahim@houston.rr.com", "creation_time": "2004-12-28T21:43:05Z", "is_private": false}, {"count": 1, "text": "Created attachment 13846\npatch to HostConfig", "creator": "tbenbrahim@houston.rr.com", "is_private": false, "id": 69044, "time": "2004-12-28T21:44:10Z", "bug_id": 32865, "creation_time": "2004-12-28T21:44:10Z", "tags": [], "attachment_id": 13846}, {"count": 2, "tags": [], "bug_id": 32865, "text": "I removed this flag on purpose (obviously, it is useless).", "id": 69047, "attachment_id": null, "creator": "remm@apache.org", "creation_time": "2004-12-28T22:31:25Z", "time": "2004-12-28T22:31:25Z", "is_private": false}, {"count": 3, "text": "I urge you to reconsider:\n1) the flag is not removed, there is still a property deployOnStartup, settable\nin server.xml (sure in this case it may be useless) or settable on the MBean (in\nwhich case it is very useful, for fine grained control of which apps get\ndeployed, and to configure the Contexts through JMX prior to deployment). It is\nalso documented, and worked in 5.0.x, 4.x.x and prior.\n2) the patch causes no harm, if someone does not set deployOnStartup, it is true\nby default. The patch just restores the previous documented functionality.\n3) is there any reason for removing the flag, and why do you feel it is useless?\nI am trying to embed Tomcat using JMX, and the ignoring of the deployOnStartup\nflag is causing all kinds of problems. I need to set useNaming to false on the\ncontexts, and since DefaultContext is gone, the only way I can see to do this is\non the context themselves. I want to do this programmatically (through JMX), not\ntrhough yet another xml file.\n\nRegards\n\nTony BenBrahim", "bug_id": 32865, "is_private": false, "id": 69048, "time": "2004-12-28T22:59:20Z", "creator": "tbenbrahim@houston.rr.com", "creation_time": "2004-12-28T22:59:20Z", "tags": [], "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 32865, "is_private": false, "text": "I use this feature with virtual hosting on 5.0.28 so that I don't have to create\nseparate appBases for each host.  I set deployOnStartup=\"false\" and create\ncontext elements for all of the webapps I want in each host in server.xml.\n\nI'm upgrading to 5.5.4 and have discovered that this doesn't work.  Creating\nseparate appBase dirs for each host seems to create an unnecessarily complicated\ndir structure so I have applied Tony's patch.  This feature is not useless to me.\n\nI think that as more people migrate to 5.5.X many will have the same issue.  It\ndoesn't look to me like the addition of the flag complicates the code or has a\nnegative impact on performance.  If the only reason to remove it is that you\ndon't think it will be used, I believe you should put it back in.  As you can\nsee, it is used.", "id": 70083, "time": "2005-01-25T20:11:24Z", "creator": "cmorris@paycom.net", "creation_time": "2005-01-25T20:11:24Z", "attachment_id": null}]