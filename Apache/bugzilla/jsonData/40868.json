[{"attachment_id": null, "tags": [], "bug_id": 40868, "text": "When navigating off a page using IE7 (not IE6) whilst tomcat is still sending \ndata (dynamically generated graph) via a ServletOutputStream, the JVM (Java \nHotSpot(TM) Server VM (1.5.0_07-b03 mixed mode) on Windows 2003 Server (Service \nPack 1; Web Edition) crashes without any warning or information recorded in the \ntomcat logs.  The problem is with tcnative-1.dll and removal of this fixes the \nproblem.  The associated windows process error log is:\n\n#\n# An unexpected error has been detected by HotSpot Virtual Machine:\n#\n#  EXCEPTION_ACCESS_VIOLATION (0xc0000005) at pc=0x2c1643a4, pid=3796, tid=1400\n#\n# Java VM: Java HotSpot(TM) Server VM (1.5.0_07-b03 mixed mode)\n# Problematic frame:\n# C  [tcnative-1.dll+0x43a4]\n#\n\n---------------  T H R E A D  ---------------\n\nCurrent thread (0x0082ba48):  JavaThread \"Finalizer\" daemon [_thread_in_native, \nid=1400]\n\nsiginfo: ExceptionCode=0xc0000005, reading address 0x00000014\n\nRegisters:\nEAX=0x0000006f, EBX=0x0000006f, ECX=0x2cc04e68, EDX=0x03e78640\nESP=0x2b20f79c, EBP=0x2b20f7a8, ESI=0x00000000, EDI=0x00000000\nEIP=0x2c1643a4, EFLAGS=0x00010206\n\nTop of Stack: (sp=0x2b20f79c)\n0x2b20f79c:   0082ba48 03e77a48 03e77a48 2b20f7e4\n0x2b20f7ac:   0083864c 0082bb08 2b20f7ec 00000000\n0x2b20f7bc:   00000000 00000000 0000006f 2b20f7c8\n0x2b20f7cc:   00000000 2b20f800 03e78640 00000000\n0x2b20f7dc:   03e77a48 2b20f7f4 2b20f820 00832a3f\n0x2b20f7ec:   03e785e8 008364f9 0000006f 00000000\n0x2b20f7fc:   00000000 00000000 2b20f804 04ddd56e\n0x2b20f80c:   2b20f828 04ddd8a0 065cd178 04ddd5a0 \n\nInstructions: (pc=0x2c1643a4)\n0x2c164394:   8b 5d 1c 56 33 f6 85 db 57 76 32 8b 7d 10 8b c3\n0x2c1643a4:   8b 4f 14 2b c6 8d 55 1c 89 45 1c 8b 47 0c 52 8b \n\n\nStack: [0x2b1d0000,0x2b210000),  sp=0x2b20f79c,  free space=253k\nNative frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)\nC  [tcnative-1.dll+0x43a4]\nj  org.apache.tomcat.jni.Socket.sendbb(JII)I+0\nj  org.apache.coyote.http11.InternalAprOutputBuffer.flushBuffer()V+22\n\nJava frames: (J=compiled Java code, j=interpreted, Vv=VM code)\nj  org.apache.tomcat.jni.Socket.sendbb(JII)I+0\nj  org.apache.coyote.http11.InternalAprOutputBuffer.flushBuffer()V+22\nv  ~C2IAdapter\nJ  org.apache.coyote.http11.Http11AprProcessor.action(Lorg/apache/coyote/\nActionCode;Ljava/lang/Object;)V\nJ  org.apache.coyote.Response.action(Lorg/apache/coyote/ActionCode;Ljava/lang/\nObject;)V\nv  ~I2CAdapter\nj  org.apache.catalina.connector.OutputBuffer.doFlush(Z)V+95\nj  org.apache.catalina.connector.OutputBuffer.flush()V+2\nj  org.apache.catalina.connector.CoyoteOutputStream.flush()V+4\nj  javax.imageio.stream.FileCacheImageOutputStream.close()V+50\nj  javax.imageio.stream.ImageInputStreamImpl.finalize()V+8\nv  ~StubRoutines::call_stub\nJ  java.lang.ref.Finalizer.invokeFinalizeMethod(Ljava/lang/Object;)V\nJ  java.lang.ref.Finalizer$FinalizerThread.run()V\nv  ~OSRAdapter\nv  ~StubRoutines::call_stub\n\n---------------  P R O C E S S  ---------------\n\nJava Threads: ( => current thread )\n  0x2c636e80 JavaThread \"http-80-25\" daemon [_thread_blocked, id=5560]\n  0x2de21b70 JavaThread \"http-80-24\" daemon [_thread_blocked, id=492]\n  0x2c4b4e80 JavaThread \"http-80-23\" daemon [_thread_blocked, id=1964]\n  0x2be0b620 JavaThread \"http-80-22\" daemon [_thread_blocked, id=5336]\n  0x2bfd76f8 JavaThread \"http-80-21\" daemon [_thread_blocked, id=6068]\n  0x2cee6d30 JavaThread \"http-80-20\" daemon [_thread_blocked, id=1352]\n  0x2b127e00 JavaThread \"http-80-19\" daemon [_thread_blocked, id=4400]\n  0x2c63cd88 JavaThread \"http-80-18\" daemon [_thread_blocked, id=5444]\n  0x2b79ee20 JavaThread \"http-80-17\" daemon [_thread_blocked, id=1960]\n  0x2bfd7e30 JavaThread \"http-80-16\" daemon [_thread_blocked, id=4104]\n  0x2b544fa0 JavaThread \"http-80-15\" daemon [_thread_blocked, id=600]\n  0x2d7764e0 JavaThread \"http-80-14\" daemon [_thread_blocked, id=4156]\n  0x2be0bd80 JavaThread \"http-80-13\" daemon [_thread_blocked, id=256]\n  0x2d7f28b8 JavaThread \"http-80-12\" daemon [_thread_blocked, id=5696]\n  0x2dc704a8 JavaThread \"http-80-11\" daemon [_thread_blocked, id=5720]\n  0x2c3549c0 JavaThread \"http-80-10\" daemon [_thread_blocked, id=4060]\n  0x2c029b80 JavaThread \"http-80-9\" daemon [_thread_in_Java, id=1900]\n  0x2ea0acf8 JavaThread \"http-80-8\" daemon [_thread_blocked, id=988]\n  0x2c3a4008 JavaThread \"http-80-7\" daemon [_thread_blocked, id=3764]\n  0x2c46c008 JavaThread \"http-80-6\" daemon [_thread_blocked, id=5056]\n  0x2b40ddf0 JavaThread \"Java2D Disposer\" daemon [_thread_blocked, id=5892]\n  0x2da00900 JavaThread \"AWT-Windows\" daemon [_thread_in_native, id=1080]\n  0x2bf4a080 JavaThread \"http-80-5\" daemon [_thread_blocked, id=1444]\n  0x2b53d810 JavaThread \"http-80-4\" daemon [_thread_blocked, id=1268]\n  0x2bf52aa0 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#2\" daemon \n[_thread_blocked, id=3872]\n  0x2c97a548 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#1\" daemon \n[_thread_blocked, id=5284]\n  0x2c700888 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#0\" daemon \n[_thread_blocked, id=5996]\n  0x2b0e8310 JavaThread \"Timer-8\" daemon [_thread_blocked, id=5200]\n  0x2c728d00 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#2\" daemon \n[_thread_blocked, id=6072]\n  0x2bc4ad38 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#1\" daemon \n[_thread_blocked, id=4428]\n  0x2c789e60 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#0\" daemon \n[_thread_blocked, id=3932]\n  0x2b9dac90 JavaThread \"Timer-7\" daemon [_thread_blocked, id=5776]\n  0x2d49abe8 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#2\" daemon \n[_thread_blocked, id=2448]\n  0x2c393e28 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#1\" daemon \n[_thread_blocked, id=304]\n  0x2c393c00 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#0\" daemon \n[_thread_blocked, id=608]\n  0x2cb86a98 JavaThread \"Timer-6\" daemon [_thread_blocked, id=5964]\n  0x2ca51bf0 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#2\" daemon \n[_thread_blocked, id=1824]\n  0x2ca51a68 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#1\" daemon \n[_thread_blocked, id=572]\n  0x2bee6478 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#0\" daemon \n[_thread_blocked, id=1068]\n  0x2bc2b940 JavaThread \"Timer-5\" daemon [_thread_blocked, id=4956]\n  0x2cfb3970 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#2\" daemon \n[_thread_blocked, id=5344]\n  0x2bd872d0 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#1\" daemon \n[_thread_blocked, id=1048]\n  0x2bd87008 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#0\" daemon \n[_thread_blocked, id=4344]\n  0x2bc62870 JavaThread \"Timer-4\" daemon [_thread_blocked, id=4124]\n  0x2caff0a8 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#2\" daemon \n[_thread_blocked, id=1980]\n  0x2b5b8218 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#1\" daemon \n[_thread_blocked, id=3864]\n  0x007e2c58 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#0\" daemon \n[_thread_blocked, id=6060]\n  0x2c8f8508 JavaThread \"Timer-3\" daemon [_thread_blocked, id=5464]\n  0x2b4c3cd8 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#2\" daemon \n[_thread_blocked, id=5020]\n  0x2bf62288 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#1\" daemon \n[_thread_blocked, id=2424]\n  0x2bf62068 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#0\" daemon \n[_thread_blocked, id=6112]\n  0x2b4e5408 JavaThread \"Timer-2\" daemon [_thread_blocked, id=5288]\n  0x2c51c008 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#2\" daemon \n[_thread_blocked, id=3768]\n  0x2b4c0e08 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#1\" daemon \n[_thread_blocked, id=228]\n  0x2b4fde08 JavaThread \n\"com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#0\" daemon \n[_thread_blocked, id=5652]\n  0x2d3bb618 JavaThread \"Timer-1\" daemon [_thread_blocked, id=2452]\n  0x2b4e5d28 JavaThread \"http-80-3\" daemon [_thread_blocked, id=5680]\n  0x2ca01e58 JavaThread \"http-80-2\" daemon [_thread_blocked, id=748]\n  0x2be264d0 JavaThread \"http-443-Sendfile-0\" daemon [_thread_blocked, id=5984]\n  0x2cce89b8 JavaThread \"http-443-Poller-7\" daemon [_thread_blocked, id=4160]\n  0x2c4274f0 JavaThread \"http-443-Poller-6\" daemon [_thread_blocked, id=2508]\n  0x2bea4d40 JavaThread \"http-443-Poller-5\" daemon [_thread_blocked, id=5068]\n  0x2b751c90 JavaThread \"http-443-Poller-4\" daemon [_thread_blocked, id=5116]\n  0x2b643408 JavaThread \"http-443-Poller-3\" daemon [_thread_blocked, id=684]\n  0x2be9fb10 JavaThread \"http-443-Poller-2\" daemon [_thread_blocked, id=5240]\n  0x2ca01c98 JavaThread \"http-443-Poller-1\" daemon [_thread_blocked, id=5700]\n  0x2ca51200 JavaThread \"http-443-1\" daemon [_thread_blocked, id=4528]\n  0x2ca51078 JavaThread \"http-443-Poller-0\" daemon [_thread_blocked, id=2532]\n  0x2cd00d48 JavaThread \"http-443-Acceptor-0\" daemon [_thread_in_native, \nid=5704]\n  0x2b73e548 JavaThread \"http-80-Sendfile-0\" daemon [_thread_blocked, id=296]\n  0x2c61fdc8 JavaThread \"http-80-Poller-7\" daemon [_thread_in_native, id=4924]\n  0x2c82b408 JavaThread \"http-80-Poller-6\" daemon [_thread_in_native, id=3976]\n  0x2b5fb408 JavaThread \"http-80-1\" daemon [_thread_blocked, id=5060]\n  0x2ba2cdf0 JavaThread \"http-80-Poller-5\" daemon [_thread_blocked, id=1232]\n  0x2c134ad0 JavaThread \"http-80-Poller-4\" daemon [_thread_in_native, id=2088]\n  0x2c14cd88 JavaThread \"http-80-Poller-3\" daemon [_thread_blocked, id=5088]\n  0x0079bf90 JavaThread \"http-80-Poller-2\" daemon [_thread_blocked, id=5356]\n  0x2b761a38 JavaThread \"http-80-Poller-1\" daemon [_thread_blocked, id=776]\n  0x2ca72d68 JavaThread \"http-80-Poller-0\" daemon [_thread_in_native, id=548]\n  0x2b145300 JavaThread \"http-80-Acceptor-0\" daemon [_thread_in_native, id=392]\n  0x2cd77008 JavaThread \n\"ContainerBackgroundProcessor[StandardEngine[Catalina]]\" daemon \n[_thread_blocked, id=4652]\n  0x2b6133f0 JavaThread \"Thread-2\" [_thread_in_native, id=2140]\n  0x2b4dd440 JavaThread \"RMI TCP Accept-8011\" daemon [_thread_in_native, \nid=4788]\n  0x2b588940 JavaThread \"RMI TCP Accept-0\" daemon [_thread_in_native, id=2076]\n  0x2b556e50 JavaThread \"Timer-0\" daemon [_thread_blocked, id=5352]\n  0x2af6bcb0 JavaThread \"Low Memory Detector\" daemon [_thread_blocked, id=5180]\n  0x2af6a908 JavaThread \"CompilerThread1\" daemon [_thread_blocked, id=4300]\n  0x2af69a98 JavaThread \"CompilerThread0\" daemon [_thread_blocked, id=5992]\n  0x2af68be8 JavaThread \"AdapterThread\" daemon [_thread_blocked, id=4684]\n  0x2af67f00 JavaThread \"Signal Dispatcher\" daemon [_thread_blocked, id=5312]\n=>0x0082ba48 JavaThread \"Finalizer\" daemon [_thread_in_native, id=1400]\n  0x2af62c38 JavaThread \"Reference Handler\" daemon [_thread_blocked, id=5924]\n  0x003c6158 JavaThread \"main\" [_thread_in_native, id=3792]\n\nOther Threads:\n  0x2af60a98 VMThread [id=4796]\n  0x2b437ed0 WatcherThread [id=5512]\n\nVM state:not at safepoint (normal execution)\n\nVM Mutex/Monitor currently owned by a thread: None\n\nHeap\n PSYoungGen      total 33600K, used 5469K [0x274b0000, 0x297f0000, 0x2ac30000)\n  eden space 33280K, 15% used [0x274b0000,0x279c7408,0x29530000)\n  from space 320K, 80% used [0x29540000,0x29580020,0x29590000)\n  to   space 1408K, 0% used [0x29690000,0x29690000,0x297f0000)\n PSOldGen        total 455168K, used 125376K [0x0b830000, 0x274b0000, \n0x274b0000)\n  object space 455168K, 27% used [0x0b830000,0x132a0240,0x274b0000)\n PSPermGen       total 131072K, used 50206K [0x03830000, 0x0b830000, 0x0b830000)\n  object space 131072K, 38% used [0x03830000,0x06937940,0x0b830000)\n\nDynamic libraries:\n0x00400000 - 0x0041b000 \tc:\\usr\\bin\\tomcat\\current\\bin\\tomcat5.exe\n0x7c800000 - 0x7c8c0000 \tC:\\WINDOWS\\system32\\ntdll.dll\n0x77e40000 - 0x77f42000 \tC:\\WINDOWS\\system32\\kernel32.dll\n0x77380000 - 0x77412000 \tC:\\WINDOWS\\system32\\USER32.dll\n0x77c00000 - 0x77c48000 \tC:\\WINDOWS\\system32\\GDI32.dll\n0x77f50000 - 0x77fec000 \tC:\\WINDOWS\\system32\\ADVAPI32.dll\n0x77c50000 - 0x77cef000 \tC:\\WINDOWS\\system32\\RPCRT4.dll\n0x77da0000 - 0x77df2000 \tC:\\WINDOWS\\system32\\SHLWAPI.dll\n0x77ba0000 - 0x77bfa000 \tC:\\WINDOWS\\system32\\msvcrt.dll\n0x7c8d0000 - 0x7d0d3000 \tC:\\WINDOWS\\system32\\SHELL32.dll\n0x77420000 - 0x77523000 \tC:\\WINDOWS\\WinSxS\\x86_Microsoft.Windows.Common-\nControls_6595b64144ccf1df_6.0.3790.1830_x-ww_7AE38CCF\\comctl32.dll\n0x6d8d0000 - 0x6dc85000 \tc:\\usr\\bin\\java\\jdk1.5.0_07\\jre\\bin\\server\\jvm.dll\n0x76aa0000 - 0x76acd000 \tC:\\WINDOWS\\system32\\WINMM.dll\n0x6d2f0000 - 0x6d2f8000 \tc:\\usr\\bin\\java\\jdk1.5.0_07\\jre\\bin\\hpi.dll\n0x76b70000 - 0x76b7b000 \tC:\\WINDOWS\\system32\\PSAPI.DLL\n0x6d700000 - 0x6d70c000 \tc:\\usr\\bin\\java\\jdk1.5.0_07\\jre\\bin\\verify.dll\n0x6d370000 - 0x6d38d000 \tc:\\usr\\bin\\java\\jdk1.5.0_07\\jre\\bin\\java.dll\n0x6d720000 - 0x6d72f000 \tc:\\usr\\bin\\java\\jdk1.5.0_07\\jre\\bin\\zip.dll\n0x6d520000 - 0x6d528000 \tC:\\usr\\bin\\java\\jdk1.5.0_07\\jre\\bin\\management.dll\n0x6d530000 - 0x6d543000 \tC:\\usr\\bin\\java\\jdk1.5.0_07\\jre\\bin\\net.dll\n0x71c00000 - 0x71c17000 \tC:\\WINDOWS\\system32\\WS2_32.dll\n0x71bf0000 - 0x71bf8000 \tC:\\WINDOWS\\system32\\WS2HELP.dll\n0x71b20000 - 0x71b61000 \tC:\\WINDOWS\\System32\\mswsock.dll\n0x76ed0000 - 0x76ef9000 \tC:\\WINDOWS\\system32\\DNSAPI.dll\n0x76f70000 - 0x76f77000 \tC:\\WINDOWS\\System32\\winrnr.dll\n0x76f10000 - 0x76f3e000 \tC:\\WINDOWS\\system32\\WLDAP32.dll\n0x76f80000 - 0x76f85000 \tC:\\WINDOWS\\system32\\rasadhlp.dll\n0x68000000 - 0x6802f000 \tC:\\WINDOWS\\system32\\rsaenh.dll\n0x76920000 - 0x769e4000 \tC:\\WINDOWS\\system32\\USERENV.dll\n0x71c40000 - 0x71c98000 \tC:\\WINDOWS\\system32\\netapi32.dll\n0x5f270000 - 0x5f2c9000 \tC:\\WINDOWS\\system32\\hnetcfg.dll\n0x71ae0000 - 0x71ae8000 \tC:\\WINDOWS\\System32\\wshtcpip.dll\n0x2c160000 - 0x2c22f000 \tC:\\WINDOWS\\tcnative-1.dll\n0x6d070000 - 0x6d1d7000 \tC:\\usr\\bin\\java\\jdk1.5.0_07\\jre\\bin\\awt.dll\n0x73070000 - 0x73097000 \tC:\\WINDOWS\\system32\\WINSPOOL.DRV\n0x76290000 - 0x762ad000 \tC:\\WINDOWS\\system32\\IMM32.dll\n0x77670000 - 0x777a4000 \tC:\\WINDOWS\\system32\\ole32.dll\n0x73860000 - 0x738ac000 \tC:\\WINDOWS\\system32\\ddraw.dll\n0x73b30000 - 0x73b36000 \tC:\\WINDOWS\\system32\\DCIMAN32.dll\n0x6d2b0000 - 0x6d2ef000 \t\nC:\\usr\\bin\\java\\jdk1.5.0_07\\jre\\bin\\fontmanager.dll\n0x6d230000 - 0x6d253000 \tC:\\usr\\bin\\java\\jdk1.5.0_07\\jre\\bin\\dcpr.dll\n0x6d550000 - 0x6d559000 \tC:\\usr\\bin\\java\\jdk1.5.0_07\\jre\\bin\\nio.dll\n0x6d200000 - 0x6d22f000 \tC:\\usr\\bin\\java\\jdk1.5.0_07\\jre\\bin\\cmm.dll\n0x6d430000 - 0x6d44f000 \tC:\\usr\\bin\\java\\jdk1.5.0_07\\jre\\bin\\jpeg.dll\n\nVM Arguments:\njvm_args: -Dcatalina.base=c:\\usr\\bin\\tomcat\\current -\nDcatalina.home=c:\\usr\\bin\\tomcat\\current -\nDjava.endorsed.dirs=c:\\usr\\bin\\tomcat\\current\\common\\endorsed -\nDjava.io.tmpdir=c:\\usr\\bin\\tomcat\\current\\temp -\nDcom.sun.management.jmxremote.ssl=false -\nDcom.sun.management.jmxremote.port=8011 -\nDcom.sun.management.jmxremote.authenticate=false -XX:PermSize=128m -\nXX:MaxPermSize=128m vfprintf -Xms500m -Xmx500m\njava_command: <unknown>\nLauncher Type: generic\n\n\nPROCESSOR_IDENTIFIER=x86 Family 15 Model 4 Stepping 1, GenuineIntel\n\n\n\n---------------  S Y S T E M  ---------------\n\nOS: Windows Server 2003 family Build 3790 Service Pack 1\n\nCPU:total 4 family 15, cmov, cx8, fxsr, mmx, sse, sse2, ht\n\nMemory: 4k page, physical 2096612k(1276008k free), swap 4042272k(3038904k free)\n\nvm_info: Java HotSpot(TM) Server VM (1.5.0_07-b03) for windows-x86, built on \nMay  3 2006 00:45:13 by \"java_re\" with MS VC++ 6.0", "count": 0, "id": 95319, "time": "2006-11-02T01:50:50Z", "creator": "bernicewoodall@hotmail.com", "creation_time": "2006-11-02T01:50:50Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 40868, "attachment_id": null, "id": 95664, "time": "2006-11-10T07:46:26Z", "creator": "mturk@apache.org", "creation_time": "2006-11-10T07:46:26Z", "is_private": false, "text": "\n\n*** This bug has been marked as a duplicate of 40070 ***"}]