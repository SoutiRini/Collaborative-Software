[{"text": "reported on ant-user\n------------------------\n\nError occurs on 1.7 and 1.7.1 beta2.\n\nIf I define a typedef with a # in the path ant won't run.\n\nI have included a patch and have not created an error, is this a known\nissue or already fixed?\n\n<typedef\nfile=\"C:\\USERS\\helium\\helium-dev-forbuilds#\\helium\\tools\\compile\\compile\n.antlib.xml\"/>\n\nBUILD FAILED\nC:\\USERS\\helium\\helium-dev-forbuilds#\\helium\\build.xml:15: The following\nerror o\nccurred while executing this line:\nC:\\USERS\\helium\\helium-dev-forbuilds#\\helium\\helium.ant.xml:13:\njava.lang.Illega\nlArgumentException: URI has a fragment component\n        at\norg.apache.tools.ant.ProjectHelper.addLocationToBuildException(Projec\ntHelper.java:541)\n        at\norg.apache.tools.ant.taskdefs.ImportTask.execute(ImportTask.java:148)\n\n        at\norg.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.\njava:39)\n        at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces\nsorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at\norg.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.jav\na:105)\n        at org.apache.tools.ant.Task.perform(Task.java:348)\n        at org.apache.tools.ant.Target.execute(Target.java:357)\n        at\norg.apache.tools.ant.helper.ProjectHelper2.parse(ProjectHelper2.java:\n140)\n        at\norg.apache.tools.ant.ProjectHelper.configureProject(ProjectHelper.jav\na:96)\n        at org.apache.tools.ant.Main.runBuild(Main.java:683)\n        at org.apache.tools.ant.Main.startAnt(Main.java:199)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:257)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:104)\nCaused by:\nC:\\USERS\\helium\\helium-dev-forbuilds#\\helium\\helium.ant.xml:13: java.\nlang.IllegalArgumentException: URI has a fragment component\n        at\norg.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.jav\na:115)\n        at org.apache.tools.ant.Task.perform(Task.java:348)\n        at org.apache.tools.ant.Target.execute(Target.java:357)\n        at\norg.apache.tools.ant.helper.ProjectHelper2.parse(ProjectHelper2.java:\n129)\n        at\norg.apache.tools.ant.taskdefs.ImportTask.execute(ImportTask.java:146)\n\n        ... 14 more\nCaused by: java.lang.IllegalArgumentException: URI has a fragment\ncomponent\n        at java.io.File.<init>(File.java:370)\n        at sun.reflect.GeneratedConstructorAccessor1.newInstance(Unknown\nSource)\n\n        at\nsun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingC\nonstructorAccessorImpl.java:27)\n        at\njava.lang.reflect.Constructor.newInstance(Constructor.java:513)\n        at org.apache.tools.ant.launch.Locator.fromURI(Locator.java:165)\n        at\norg.apache.tools.ant.util.FileUtils.fromURI(FileUtils.java:1158)\n        at org.apache.tools.ant.Location.<init>(Location.java:90)\n        at\norg.apache.tools.ant.helper.ProjectHelper2.parse(ProjectHelper2.java:\n211)\n        at\norg.apache.tools.ant.helper.ProjectHelper2.parseUnknownElement(Projec\ntHelper2.java:86)\n        at nokia.ant.Antlib.createAntlib(Antlib.java:76)\n        at nokia.ant.TypedefURIFix.loadAntlib(TypedefURIFix.java:460)\n        at nokia.ant.TypedefURIFix.execute(TypedefURIFix.java:312)\n        at\norg.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)\n        at sun.reflect.GeneratedMethodAccessor2.invoke(Unknown Source)\n        at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces\nsorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at\norg.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.jav\na:105)\n        ... 18 more", "tags": [], "creator": "stevel@apache.org", "attachment_id": null, "count": 0, "id": 117614, "time": "2008-06-12T03:34:57Z", "bug_id": 45190, "creation_time": "2008-06-12T03:34:57Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 45190, "attachment_id": null, "text": "Patch is:\n\n--- Definer.java.org\tWed Jun 11 16:24:17 2008\n+++ Definer.java\tWed Jun 11 17:05:15 2008\n@@ -331,7 +331,7 @@\n         }\n         try {\n             if (message == null) {\n-                return file.toURL();\n+                return file.toURI().toURL();\n             }\n         } catch (Exception ex) {\n             message =\n", "id": 117615, "time": "2008-06-12T03:35:07Z", "creator": "stevel@apache.org", "creation_time": "2008-06-12T03:35:07Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 45190, "text": "patch is JDK 1.4+, Ant is not.\n\nDefiner.fileToURL should probably use FileUtils.getFileURL anyway ...", "count": 2, "id": 117751, "time": "2008-06-17T03:00:35Z", "creator": "bodewig@apache.org", "creation_time": "2008-06-17T03:00:35Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 45190, "text": "Created attachment 22132\nHere is new patch using fileutils", "id": 117752, "time": "2008-06-17T04:02:11Z", "creator": "ext-simon.steiner@nokia.com", "creation_time": "2008-06-17T04:02:11Z", "is_private": false, "attachment_id": 22132}, {"count": 4, "tags": [], "bug_id": 45190, "attachment_id": null, "id": 117753, "time": "2008-06-17T04:56:32Z", "creator": "bodewig@apache.org", "creation_time": "2008-06-17T04:56:32Z", "is_private": false, "text": "I was more thinking along the lines of http://svn.apache.org/viewvc?rev=668624&view=rev\n\nCan you confirm that this fixes the problem for you?"}, {"count": 5, "tags": [], "bug_id": 45190, "text": "Its working with your change, can this not go to 1.7.1?", "id": 117754, "time": "2008-06-17T05:03:27Z", "creator": "ext-simon.steiner@nokia.com", "creation_time": "2008-06-17T05:03:27Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 45190, "attachment_id": null, "id": 117794, "time": "2008-06-18T12:47:17Z", "creator": "jglick@apache.org", "creation_time": "2008-06-18T12:47:17Z", "is_private": false, "text": "Any particular reason you're deprecating a private method rather than simply removing it?"}, {"count": 7, "tags": [], "creator": "bodewig@apache.org", "text": "Whether this can go into 1.7.1 is under discussion, but it's pretty unlikely since we are already too close to the release.  1.7.2 may work.\n\nJesse, I've already committed a different patch which doesn't deprecate anything.\n\nThe Definer.fileToUrl method performs some additional checks like whether the file actually exists and is a file that the FileUtils method doesn't (for good reasons), I've only replaced the File.toURL call.\n", "id": 117803, "time": "2008-06-19T00:18:33Z", "bug_id": 45190, "creation_time": "2008-06-19T00:18:33Z", "is_private": false, "attachment_id": null}]