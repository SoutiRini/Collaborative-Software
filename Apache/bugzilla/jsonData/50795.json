[{"count": 0, "tags": [], "creator": "andrei.astrouski@gmail.com", "attachment_id": 26668, "is_private": false, "id": 144348, "time": "2011-02-16T09:30:02Z", "bug_id": 50795, "creation_time": "2011-02-16T09:30:02Z", "text": "Created attachment 26668\nCellCommentTest.xlsx\n\nSteps:\n1. Create Excel file.\n2. Add cell comment.\n3. Process with POI. Get our created cell comment and try to set to another cell.\n  XSSFCell cell = row.getCell(0);\n  XSSFComment comment = cell.getCellComment();\n  XSSFCell cellWithoutComment = row.getCell(1);\n  cellWithoutComment.setCellComment(comment);\n4. Try to save changes\n  FileOutputStream out = new FileOutputStream(testFilePath);\n  wb.write(out);\n  out.close();\n\nActual result: NPE appears, file size = 0 bytes\nExpected: comment moved successfull (in 3.6 it works)\n\nSee attachments to test"}, {"count": 1, "tags": [], "text": "Created attachment 26669\nCellCommentTest.java", "is_private": false, "bug_id": 50795, "id": 144349, "time": "2011-02-16T09:30:42Z", "creator": "andrei.astrouski@gmail.com", "creation_time": "2011-02-16T09:30:42Z", "attachment_id": 26669}, {"count": 2, "tags": [], "text": "Thanks for the test case, it made it much quicker to investigate\n\nI'm rather confused by this one, but it's either a bug in xmlbeans, or we're doing something too odd in our processing of the vml diagram part. However, by adding a .toString() call in after the update, it seems to make xmlbeans re-compute whatever was broken. I'm sure there should be a better solution, but this seems to work fine as a workaround...\n\nTest and workaround added in r1072022.", "is_private": false, "id": 144403, "creator": "apache@gagravarr.org", "time": "2011-02-18T10:31:05Z", "bug_id": 50795, "creation_time": "2011-02-18T10:31:05Z", "attachment_id": null}]