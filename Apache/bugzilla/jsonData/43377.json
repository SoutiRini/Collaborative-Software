[{"count": 0, "tags": [], "text": "Enabling the RequestDumperValve can lead to garbled POST data, but only under\nthe following circumstances:\n\n1. The POST data is submitted with the content type/method\napplication/x-www-form-urlencoded. The issue does NOT occur if the POST request\nuses multipart/form-data.\n2. The POST data must contain some non-ASCII characters (e.g. German umlauts\n\u00e4\u00f6\u00fc\u00c4\u00d6\u00dc) which are transferred using UTF-8 multi-byte sequences.\n\nI have not debugged this problem on the source code level, but what seems to\nhappen is the following:\n- the encoded POST data looks e.g. like this:\ncomment=noch+ein+Test+%C3%A4%C3%B6%C3%BC%C3%84%C3%96%C3%9C\n- the form data is de-escaped, i.e. the %xx sequences are converted to binary\n- the next step should be to UTF-8 decode the data, but this step seems to be\nskipped. \n- the garbled, i.e. not UTF-8 decoded data ends up in the request parameters,\nlooking like this \"noch ein Test \u00c3\u00a4\u00c3\u00b6\u00c3\u00bc\u00c3&#132;\u00c3&#150;\u00c3&#156;\" instead of this \"noch ein Test\n\u00e4\u00f6\u00fc\u00c4\u00d6\u00dc\"", "attachment_id": null, "id": 108111, "creator": "jh+asfbugzilla@foobar.de", "time": "2007-09-13T02:01:36Z", "bug_id": 43377, "creation_time": "2007-09-13T02:01:36Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 43377, "text": "Please read the comment just above the RequestDumperValve in server.xml or the\nwarning in the http://tomcat.apache.org/tomcat-5.5-doc/config/valve.html.\n\nYou need to use the RequestDumperFilter.", "id": 108195, "time": "2007-09-14T04:48:59Z", "creator": "markt@apache.org", "creation_time": "2007-09-14T04:48:59Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 43377, "attachment_id": null, "text": "Thanks for the pointer. One could, however, argue that the comment could be just\na wee bit more explicit. Like \"WARNING: using it will break stuff in\nunpredictable ways\" or at least include a pointer to the URL you mentioned.", "id": 108208, "time": "2007-09-14T09:26:29Z", "creator": "jh+asfbugzilla@foobar.de", "creation_time": "2007-09-14T09:26:29Z", "is_private": false}]