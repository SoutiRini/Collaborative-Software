[{"count": 0, "tags": [], "bug_id": 36710, "is_private": false, "text": "When a batch file is executed via CGI, the output of programs this batch file\ncalls is not captured and sent to the client.\n\nExample:\ncontents of test.cmd\n--------------------\n@echo off\necho Content-type: text/plain\necho.\necho pinging 192.168.0.160\nping.exe 192.168.0.160\necho done\n--------------------\n\nThe host is pinged, thus the ping.exe is executed (I can see the ICMP packets\nwith Ethereal, but the output of the ping program does not appear in the browser\nwindow (only the text 'pinging 192.168.2.160' and 'done').", "id": 80114, "time": "2005-09-19T15:58:41Z", "creator": "sk_np@krude.de", "creation_time": "2005-09-19T15:58:41Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "nick@webthing.com", "is_private": false, "count": 1, "id": 80117, "time": "2005-09-19T16:37:53Z", "bug_id": 36710, "creation_time": "2005-09-19T16:37:53Z", "text": "Please ask in a user support forum, if you have difficulty with the numerous  \nexamples of CGI scripts that capture the output of external programs. "}, {"count": 2, "tags": [], "creator": "sk_np@krude.de", "text": "Sorry, I *asked* in users@httpd.apache.org but got no answer. And I have\nextensively googled - without result.\nWhat 'numerous examples of CGI scripts that capture the output of external\nprograms' do you refer to?\nI don't think my example CGI script is wrong (it runs with IIS which I want to\nreplace by Apache) and I don't see any mod_cgi directive that could be related\nto my problem.", "id": 80118, "attachment_id": null, "bug_id": 36710, "creation_time": "2005-09-19T16:48:15Z", "time": "2005-09-19T16:48:15Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "nick@webthing.com", "is_private": false, "count": 3, "id": 80125, "time": "2005-09-19T17:50:23Z", "bug_id": 36710, "creation_time": "2005-09-19T17:50:23Z", "text": "I didn't see that.  Maybe if you said windows I just assumed it lay outside my  \nexpertise and I had nothing to say.  \n  \nYou just capture the output from your child command, and print it back to  \nstdout.  So in *X your script could be something like:  \n \necho Content-type: text/plain \necho \necho pinging 192.168.0.160 \n/path/to/ping.exe 192.168.0.160 | while read line \ndo \n  echo $line \ndone \necho done "}, {"count": 4, "tags": [], "bug_id": 36710, "text": "Yes, this is what in *X will work, but in *X the problem doesn't exist, script\noutput and output from progs called by the script is captured properly.\nUnfortunately Windows' cmd.exe doesn't know 'while' and 'read' and this would be\nan odd workaround anyway.\nI think if capturing from programs invoced by a script doesn't work with\nWindows, it must be a bug.\n", "id": 80126, "time": "2005-09-19T18:24:32Z", "creator": "sk_np@krude.de", "creation_time": "2005-09-19T18:24:32Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "cjm@cjmweb.fsnet.co.uk", "attachment_id": null, "text": "(In reply to comment #4)\n> Yes, this is what in *X will work, but in *X the problem doesn't exist, script\n> output and output from progs called by the script is captured properly.\n> Unfortunately Windows' cmd.exe doesn't know 'while' and 'read' and this would be\n> an odd workaround anyway.\n> I think if capturing from programs invoced by a script doesn't work with\n> Windows, it must be a bug.\n> \n\nThe bug is actually not an apache bug.  Under windows a command script will not\necho the output of any program it calls if @echo off is called.\n\nI suggest changing the script to:\n\n@echo off\necho Content-type: text/plain\necho.\necho pinging 192.168.0.160\n@echo on\nping.exe 192.168.0.160\n@echo off\necho done\n\nand leave it there.  If that doesn't work, reopen this bug.", "id": 80527, "time": "2005-09-28T08:53:47Z", "bug_id": 36710, "creation_time": "2005-09-28T08:53:47Z", "is_private": false}, {"count": 6, "tags": [], "creator": "sk_np@krude.de", "attachment_id": null, "text": "Of course that doesn't help. @echo off switches off the echoing of the command\nline, not the output of any program the script is calling.\nAnd as I said before: My scripts (that script with ping.exe is only a test\nscript) are running well with Microsoft IIS, but I want to migrate to Apache and\nwould expect that the scripts will work as well as with IIS (if not better ;-).", "id": 80528, "time": "2005-09-28T09:20:43Z", "bug_id": 36710, "creation_time": "2005-09-28T09:20:43Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 36710, "is_private": false, "text": "I would suspect that PATH isn't set as expected. May that be?\nwhat does echo %PATH% put out? Is there anything in the error log that ping.exe\nis not found? (Can't test myself right now, sorry).", "id": 80533, "time": "2005-09-28T09:35:15Z", "creator": "nd@perlig.de", "creation_time": "2005-09-28T09:35:15Z", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 36710, "text": "No, the ping is executed, pls. look at my first posting:\n> The host is pinged, thus the ping.exe is executed (I can see the ICMP packets\n> with Ethereal, but the output of the ping program does not appear in the browser\n> window (only the text 'pinging 192.168.2.160' and 'done').\n\nThe problem is *NOT* that the .exe isn't called but that it's output isn't\ncaputered and sent to the web client. The output of cmd.exe (the scripting host)\n*IS* captured but the output of all of it's child processes is not.", "id": 80534, "time": "2005-09-28T09:40:33Z", "creator": "sk_np@krude.de", "creation_time": "2005-09-28T09:40:33Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "nd@perlig.de", "is_private": false, "count": 9, "id": 80544, "time": "2005-09-28T12:08:33Z", "bug_id": 36710, "creation_time": "2005-09-28T12:08:33Z", "text": "oh well. Anyway; perhaps I've missed that also - there's still the question if\nthere's anything in the error log."}, {"count": 10, "tags": [], "bug_id": 36710, "is_private": false, "text": "(In reply to comment #8)\n> No, the ping is executed, pls. look at my first posting:\n> > The host is pinged, thus the ping.exe is executed (I can see the ICMP packets\n> > with Ethereal, but the output of the ping program does not appear in the browser\n> > window (only the text 'pinging 192.168.2.160' and 'done').\n> \n> The problem is *NOT* that the .exe isn't called but that it's output isn't\n> caputered and sent to the web client. The output of cmd.exe (the scripting host)\n> *IS* captured but the output of all of it's child processes is not.\n\nSorry, I hastily threew that together earlier without thinking and I can see\nyour problem.  It appears that ping opens in a NEW command session rather than\nthe Apache cmd session and therefore does not behave as expected.\n\nIn other words, take this up with M$.", "id": 80558, "time": "2005-09-28T17:54:35Z", "creator": "cjm@cjmweb.fsnet.co.uk", "creation_time": "2005-09-28T17:54:35Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "wrowe@apache.org", "is_private": false, "count": 11, "id": 80559, "time": "2005-09-28T18:01:05Z", "bug_id": 36710, "creation_time": "2005-09-28T18:01:05Z", "text": "This is a bug reporting forum, not a user support forum.\n\nYour problem is that on win32, ping never terminates unless you tell it to.\nFix your script to perform it's action and -terminate- and perhaps you will\nhave a working CGI.\n\nBill"}, {"count": 12, "tags": [], "creator": "sk_np@krude.de", "text": "Sorry, but that's rubbish. Of course ping.exe will terminate, but ping.exe is\nnot the matter, it was just an example. Take for another example any hello world\nprogram. It's output will not be seen by the client if this program is called by\ncmd.exe running as an Apache CGI.\nCan anybody understand the problem?\nIsn't it a bug if the output of an scripted CGI never reaches the user?\nIsn't it a bug if the same script runs well with Microsoft IIS?\nIsn't it a bug if (nearly) the same script runs well with Apache/Unix?", "id": 80629, "attachment_id": null, "bug_id": 36710, "creation_time": "2005-09-29T22:58:52Z", "time": "2005-09-29T22:58:52Z", "is_private": false}, {"count": 13, "tags": [], "text": "Please change your script to invoke\n\nping.exe -n 4 192.168.0.160\n\nand I think your problem will be solved (just tested locally).\n", "is_private": false, "id": 90477, "creation_time": "2006-06-22T08:37:12Z", "time": "2006-06-22T08:37:12Z", "creator": "wrowe@apache.org", "bug_id": 36710, "attachment_id": null}, {"count": 14, "tags": [], "bug_id": 36710, "text": "Yep, this still is an Issue on Windows XP with Apache 2.2.3.\nI am Not a Windows Guy, so this took me about a week to figure out.\nSome additional observations:  1) Internal cmd.exe commands (e.g. \"echo\", \"dir\")\nwork fine  2) Re-directing the output of an external program (such as \"ping.exe\"\nor \"netstat.exe\") to a file yields a 0-length file. 3) If you set the \"Allow\nservice to interact with desktop\" checkbox in \"Administrative\nTools->Services->Apache->properties->Log On\", you can see the stdout from your\ncommands in a desktop window which closes when the command completes.\nAlso NB that running the script from a command line yields the expected results.\nThe only work-around I could find was to drop back to apache 1.3.34, which works\ncorrectly. See also http://archive.apache.org/gnats/4898\n", "id": 97836, "time": "2007-01-09T11:12:11Z", "creator": "hooterpincher@gmail.com", "creation_time": "2007-01-09T11:12:11Z", "is_private": false, "attachment_id": null}]