[{"count": 0, "attachment_id": null, "bug_id": 10385, "text": "On 2001-11-06 Bug 4674 was submitted\n\n\" ... the 'Content-Encoding' header SSI-Servlet generates has always the \nvalue 'UTF-8'. ... \"\n\n\nIt was fixed on 2001-11-12\n\n------- Additional Comments From Amy Roh 2001-11-12 16:36 -------\nFixed. Should be available in the next nightly build.\n\nHowever, if you check the source code of this servlet on releases 4.03 and 4.04 \nthe code still shows \n\nLine 251:  res.setContentType(\"text/html;charset=UTF-8\");", "id": 18818, "time": "2002-07-01T20:54:06Z", "creator": "jmontiel@manduca.com", "creation_time": "2002-07-01T20:54:06Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 10385, "attachment_id": null, "is_private": false, "id": 18821, "time": "2002-07-01T21:19:13Z", "creator": "remm@apache.org", "creation_time": "2002-07-01T21:19:13Z", "text": "Nightlies != 4.0.x.\nThis bug won't be addressed in the 4.0.x releases, as they do not include the\nrefactored SSI code.\n\nPlease try the 4.1.6 test release instead to check the progress of the SSI code."}, {"count": 2, "tags": [], "bug_id": 10385, "text": "I tried to use polish character encoding on page\nhttp://pa22.katowice.sdi.tpnet.pl:23/fortune/example.shtml\nand the result is - the characters in \"Strona g\u00b3\u00f3wna\" are displayed wrong - it \nlooks they are converted to unicode.\n\nThe header is set properly\n<meta http-equiv=\"content-type\" content=\"text/html; charset=iso-8859-2\"> and \nthe characters are also ok - you can see source of the file in\nhttp://pa22.katowice.sdi.tpnet.pl:8101/fortune/example.shtml.src\n\nThe line with res.setContentType(\"text/html;charset=UTF-8\"); is still present \nin the code, propably this is the reason, but simple replacing it with my \ndesired encoding doesnt solve the problem completely.\n\nWhat should I do to make it work at least temporary?", "id": 37823, "time": "2003-05-27T07:09:33Z", "creator": "temp@pa22.katowice.sdi.tpnet.pl", "creation_time": "2003-05-27T07:09:33Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 10385, "attachment_id": null, "is_private": false, "id": 39492, "time": "2003-06-26T15:57:06Z", "creator": "t.kitynski@11interactive.com", "creation_time": "2003-06-26T15:57:06Z", "text": "I haven't found an existing solution to this problem, so I played a bit with \nthe source and I have working fix for that.\n\nFirst of all I am not very familiar with the procedure of applying patches to \nCVS (I mean I don't know if shall I report it before commiting anything or ask \nfor a permission or anything else), so I didn't put it into the repository. \nInstead I will give out the source and/or binaries if somebody asks. I'll be \nhappy if the patches would hit the repository anyway.\n\nOkay, here's the trick: now SSIServlet handles two more init-parameters, ie. \ndefaultInputEncoding and defaultOutputEncoding. First one tells the SSIInclude \ncommand to treat all processed (and included) files as they were written in \nthis charset (by creating appriopriate readers). The second sets Content-\nType's charset attribute to given value and thus allow to create proper writer.\n\nThis forced me to add two methods to SSIExternalResolver interface: \ngetDefaultInputEncoding and getDefaultOutputEncoding. Both return objects of \nthe type java.nio.charset.Charset, that hold appropriate charsets.\n\nIf happens, that certain included file is in different charset than the rest, \nthen it's charset can be entered after the file name. I was thinking of using \nseparate parameter, but it would break NCSA standard, besides <!--#include> \ncommand allows any number of file/virtual parameters, so it would have to be \nwritten like this: <!--#include file=\"foo.txt\" charset=\"iso-8859-2\" \nfile=\"bar.txt\" charset=\"iso-8859-1\"--> and so on. Well, maybe it's not bad, \nbut as I've written, it breaks NCSA standard. So instead I've used the same \nsyntax as in mail headers. So now we shall write: <!--#include \nfile=\"foo.txt;charset=iso-8859-2\" file=\"bar.txt; charset = iso-8859-1\"--> \na.s.o. I hope this will not break any rule, and I know---it's questionable.\n\nThis, however, solves my problems with incorrect output, and if we have all \nthe files in the same charset, we do not have to use \"...;charset=X\" \nconstruction (to be honest, I haven't tested the charset stuff just mentioned).\n\nDefault encodings works however flawlessly. If anyone is interrested in this \npatch, please contact me. If Tomcat developers find this patch usefull or not \ntoo dirty/nasty, then I gladly add my .02 to the contribution."}, {"count": 4, "tags": [], "bug_id": 10385, "attachment_id": null, "text": "I misused WORKSFORME resolution (ehh, I should have read FM ;-), so I am \nsetting the status back to REOPEN. I'm sorry, guys!", "id": 39531, "time": "2003-06-27T08:55:04Z", "creator": "t.kitynski@11interactive.com", "creation_time": "2003-06-27T08:55:04Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 10385, "attachment_id": 7011, "text": "Created attachment 7011\ntgzed org.apache.catalina.ssi src-package with quick fix", "id": 39532, "time": "2003-06-27T09:15:28Z", "creator": "t.kitynski@11interactive.com", "creation_time": "2003-06-27T09:15:28Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 10385, "attachment_id": 7012, "id": 39533, "time": "2003-06-27T09:22:31Z", "creator": "t.kitynski@11interactive.com", "creation_time": "2003-06-27T09:22:31Z", "is_private": false, "text": "Created attachment 7012\nservlets-ssi.jar bin-package with quick fix"}, {"count": 7, "tags": [], "bug_id": 10385, "attachment_id": null, "text": "I have committed a partial fix for TC4.1.x that should resolve the original issue.\n\nI am still looking at the attached patches.", "id": 73219, "time": "2005-04-03T21:07:01Z", "creator": "markt@apache.org", "creation_time": "2005-04-03T21:07:01Z", "is_private": false}, {"count": 8, "tags": [], "creator": "markt@apache.org", "text": "I have not committed the proposed patch as it would introduce Tomcat specific\nSSI syntax. Whilst there is no offical SSi spec I do not believe that Tomcat\nshould differ from the SSI syntax supported by Apache Web Server.\n\nI have committed an alternative patch that introduces 2 new servlet parameters.\nSee the docs/source for details.\n\nI have also ported the changes to TC5.5.x", "id": 73276, "time": "2005-04-04T22:59:37Z", "bug_id": 10385, "creation_time": "2005-04-04T22:59:37Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 10385, "attachment_id": null, "is_private": false, "id": 80137, "time": "2005-09-19T22:44:23Z", "creator": "markt@apache.org", "creation_time": "2005-09-19T22:44:23Z", "text": "*** Bug 36651 has been marked as a duplicate of this bug. ***"}]