[{"attachment_id": null, "tags": [], "creator": "paul.kemler@bull.net", "text": "I'm adding test cases to JOnAS administration console and I have a problem to\nremove Access Log Valve.\n\nI have reproduced the problem with Tomcat administration.\n1-I create a new Access Log Valve in directory logs/\n2-I delete the valve\n3-I create a new Access Log Valve in directory logs/ again\n4-I try to delete the valve and I have an error :\n\norg.apache.commons.modeler.BaseModelMBean invoke\nGRAVE: Exception invoking method removeValve\njava.lang.NullPointerException\n        at\norg.apache.catalina.mbeans.MBeanFactory.removeValve(MBeanFactory.java:1069)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:324)\n        at org.apache.commons.modeler.BaseModelMBean.invoke(BaseModelMBean.java:501)\n        at\nmx4j.server.interceptor.InvokerMBeanServerInterceptor.invoke(InvokerMBeanServerInterceptor.java:221)\n        at\nmx4j.server.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:120)\n        at\nmx4j.server.interceptor.SecurityMBeanServerInterceptor.invoke(SecurityMBeanServerInterceptor.java:84)\n        at\nmx4j.server.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:120)\n        at\nmx4j.server.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:120)\n        at\nmx4j.server.interceptor.ContextClassLoaderMBeanServerInterceptor.invoke(ContextClassLoaderMBeanServerInterceptor.java:203)\n        at mx4j.server.MX4JMBeanServer.invoke(MX4JMBeanServer.java:1043)\n        at\norg.apache.webapp.admin.valve.DeleteValvesAction.execute(DeleteValvesAction.java:124)\n        at\norg.apache.struts.action.RequestProcessor.processActionPerform(RequestProcessor.java:419)\n        at\norg.apache.struts.action.RequestProcessor.process(RequestProcessor.java:224)\n        at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1192)\n        at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:430)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:709)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at\norg.apache.webapp.admin.filters.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:123)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:202)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\n        at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)\n        at\norg.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)\n        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:526)\n        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:526)\n        at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:856)\n        at\norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:744)\n        at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)\n        at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n        at java.lang.Thread.run(Thread.java:534)\n\nI think that the error is when the valve is removed in the first time because if\nchanges are commited and the server is restarted, there are the two valves.\nMoreover I must kill the process for restarting.", "count": 0, "id": 77759, "time": "2005-07-28T15:27:25Z", "bug_id": 35914, "creation_time": "2005-07-28T15:27:25Z", "is_private": false}, {"count": 1, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "text": "I don't see the NPE but the pipeline is not correctly reset on the remove so the\nvalve doesn't work when re-added. The root cuse is the same as the duplicate.\n\n*** This bug has been marked as a duplicate of 39724 ***", "id": 94411, "time": "2006-10-02T18:02:23Z", "bug_id": 35914, "creation_time": "2006-10-02T18:02:23Z", "is_private": false}]