[{"count": 0, "tags": [], "creator": "kkauffman@headfog.com", "attachment_id": null, "id": 49083, "time": "2003-12-14T01:39:02Z", "bug_id": 25507, "creation_time": "2003-12-14T01:39:02Z", "is_private": false, "text": "Setting the header fails:\nHeader set Server \"Apache 2\"\n\nActual header check response is after reloading configuration:\nApache/2.0.48 (Unix) mod_ssl/2.0.48 OpenSSL/0.9.7c DAV/2 mod_ruby/1.0.7 \nRuby/1.8.0 \n\nCompilation of mod_headers verified and restart of apache performed."}, {"count": 1, "tags": [], "text": "This is not a bug, the Server header is a basic HTTP header and cannot\nbe overriden with mod_headers. \n\nhttp://httpd.apache.org/docs-2.0/mod/mod_headers.html#header says:\n\n\"The Header directives are processed just before the response is\nsent to the network. These means that it is possible to set and/or\noverride most headers, except for those headers added by the header\nfilter.\"\n\nHave a look at the ServerTokens directive and see if it addresses your\nproblem: http://httpd.apache.org/docs-2.0/mod/core.html#servertokens\n\nSee also http://httpd.apache.org/docs/misc/FAQ.html#serverheader and\nif you're interested in the source code: basic_http_header() in\nmodules/http/http_protocol.c", "attachment_id": null, "bug_id": 25507, "id": 49087, "time": "2003-12-14T02:21:40Z", "creator": "erik@codefaktor.de", "creation_time": "2003-12-14T02:21:40Z", "is_private": false}, {"count": 2, "tags": [], "text": "This referenced documentation is not for Apache 2:\nhttp://httpd.apache.org/docs/misc/FAQ.html#serverheader \n\nIn addition, using mod_headers and Header set Server has worked in previous \nversions of Apache 2.x and has started failing on the most recent upgrade.  \nAside from working for me, this article additionally references that this \nmethod works in Apache 2 and NOT in 1.3x.  I filed this bug against v2.\n\n", "attachment_id": null, "bug_id": 25507, "id": 49094, "time": "2003-12-14T12:31:01Z", "creator": "kkauffman@headfog.com", "creation_time": "2003-12-14T12:31:01Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 25507, "attachment_id": null, "is_private": false, "id": 49095, "time": "2003-12-14T12:33:06Z", "creator": "kkauffman@headfog.com", "creation_time": "2003-12-14T12:33:06Z", "text": "article reference:\nhttp://www.port80software.com/surveys/top1000webservers/masking"}, {"count": 4, "attachment_id": null, "bug_id": 25507, "is_private": false, "id": 49096, "time": "2003-12-14T13:43:00Z", "creator": "trawick@apache.org", "creation_time": "2003-12-14T13:43:00Z", "tags": [], "text": "There was a bug in Apache 2 which, until fairly recently, allowed the Server\nheader field to be overridden.\n\nFrom 2.0.48 changes:\n\n  *) Don't respect the Server header field as set by modules and CGIs.\n     As with 1.3, for proxy requests any such field is from the origin\n     server; otherwise it will have our server info as controlled by\n     the ServerTokens directive.\n\nIt is a long-standing policy for Apache httpd to set the Server header field to\nwell-defined values, controlled only by the ServerTokens directive.  (See\nhttp://httpd.apache.org/docs-2.0/mod/core.html#servertokens.)\n\nThe server can be patched easily enough to set the Server header field as you wish.\n\nFind this code in modules/http/http_protocol.c:\n\n    /* keep the set-by-proxy server header, otherwise\n     * generate a new server header */\n    if (r->proxyreq != PROXYREQ_NONE) {\n        server = apr_table_get(r->headers_out, \"Server\");\n        if (server) {\n            form_header_field(&h, \"Server\", server);\n        }\n    }\n    else {\n        form_header_field(&h, \"Server\", ap_get_server_version());\n    }\n\n\nand change it to the following (untested):\n\n    server = apr_table_get(r->headers_out, \"Server\");\n    if (server) {\n        form_header_field(&h, \"Server\", server);\n    }\n    else {\n        form_header_field(&h, \"Server\", ap_get_server_version());\n    }\n\nAs with IIS (see referenced URL), a module could be written to set Server to the\ndesired value without changing Apache.  But this module would have to implement\na filter that runs after the HTTP_HEADER filter and be able to parse the\nresponse and substitute the desired Server value.  (Not recommended!)\n"}, {"count": 5, "tags": [], "bug_id": 25507, "attachment_id": null, "text": "As a note.  The referenced (self tested) patch will not enable setting the\nheader via the Header set Server directive in the conf file.", "id": 49129, "time": "2003-12-15T14:15:51Z", "creator": "kkauffman@headfog.com", "creation_time": "2003-12-15T14:15:51Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 25507, "attachment_id": null, "id": 49134, "time": "2003-12-15T14:54:02Z", "creator": "trawick@apache.org", "creation_time": "2003-12-15T14:54:02Z", "is_private": false, "text": "I applied this patch:\nIndex: modules/http/http_protocol.c\n===================================================================\nRCS file: /home/cvspublic/httpd-2.0/modules/http/http_protocol.c,v\nretrieving revision 1.463.2.6\ndiff -u -r1.463.2.6 http_protocol.c\n--- modules/http/http_protocol.c        20 Nov 2003 19:52:42 -0000      1.463.2.\n6\n+++ modules/http/http_protocol.c        15 Dec 2003 14:51:29 -0000\n@@ -1290,11 +1290,9 @@\n\n     /* keep the set-by-proxy server header, otherwise\n      * generate a new server header */\n-    if (r->proxyreq != PROXYREQ_NONE) {\n-        server = apr_table_get(r->headers_out, \"Server\");\n-        if (server) {\n-            form_header_field(&h, \"Server\", server);\n-        }\n+    server = apr_table_get(r->headers_out, \"Server\");\n+    if (server) {\n+        form_header_field(&h, \"Server\", server);\n     }\n     else {\n         form_header_field(&h, \"Server\", ap_get_server_version());\n\nand rebuilt\n\nadded this to conf file:\n<location />\nheader set Server gobble\n</location>\n\nand got this in response to HTTP/1.1 request:\n\nHTTP/1.1 200 OK\nDate: Mon, 15 Dec 2003 09:52:23 GMT\nServer: gobble\n"}]