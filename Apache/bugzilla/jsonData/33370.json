[{"count": 0, "tags": [], "bug_id": 33370, "attachment_id": null, "id": 70412, "time": "2005-02-02T21:17:09Z", "creator": "joel.shaw@tellabs.com", "creation_time": "2005-02-02T21:17:09Z", "is_private": false, "text": "On Tomcat 4.1.24, this works fine but with Tomcat 5, I experience the following \nproblem.\nIn the code below my app knows uid until it reaches the navigation servlet.\nIn summary:\nindex.html: uid requested on this page\nauthenticateUser.java: uid = The provided uid.\nframe.java: uid = The provided uid.\nnavigation.java: uid = null\n\nCode:\n\nIndex.HTML:\n<HTML>\n    <HEAD><TITLE>DaTitle</TITLE></HEAD>\n    <BODY>\n        <CENTER>\n\t        <H1>User Login Page</H1>\n            <BR>Please provide your user credentials.\n            <BR>\n            <FORM ACTION=\"servlet/authenticateUser\" METHOD=\"POST\">\n                <TABLE ALIGN=\"center\" WIDTH=\"100%\" CELLSPACING=\"2\" \nCELLPADDING=\"2\">\n                    <TR>\n                        <TD ALIGN=\"right\" WIDTH=\"45%\">User Name:</TD>\n                        <TD ALIGN=\"left\"><INPUT TYPE=\"TEXT\" NAME=\"uid\" \nALIGN=\"left\" SIZE=\"20\"></TD>\n                    </TR>\n                    <TR>\n                        <TD ALIGN=\"right\" WIDTH=\"45%\">Password:</TD>\n                        <TD ALIGN=\"left\"><INPUT TYPE=\"PASSWORD\" NAME=\"pwd\" \nALIGN=\"left\" SIZE=\"20\"></TD>\n                    </TR>\n                </TABLE>\n                <HR><BR>\n                <INPUT TYPE=\"Submit\" NAME=\"login\" VALUE=\"Login\">\n            </FORM>\n        </CENTER>\n    </BODY>\n</HTML>\n\nauthenticateUser.java:\nimport javax.servlet.*;\nimport javax.servlet.http.*;\nimport java.io.*;\nimport java.util.*;\npublic class authenticateUser extends HttpServlet {\n\tpublic void doPost(HttpServletRequest request, HttpServletResponse \nresponse) throws ServletException, IOException {\n\t\tHttpSession session = request.getSession();\n\t\tString userName = request.getParameter(\"uid\");\n\t\tString password = request.getParameter(\"pwd\");\n\t\tsession.setAttribute(\"uid\", userName);\n\t\ttry {\n\t\t\tResourceBundle resourceBundle = ResourceBundle.getBundle\n(\"LocalString\", request.getLocal());\n\t\t\tString storedPassword = resourceBundle.getString(\"UID.\" \n+ userName + \".Password\");\n\t\t\tif (password.equals(storedPassword)) {\n\t\t\t\tRequestDispatcher rd = getServletContext\n().getNamedDispatcher(\"frame\");\n\t\t\t\trd.forward(request, response);\n\t\t\t} else {\n\t\t\t\tRequestDispatcher rd = \nrequest.getRequestDispatcher(\"/Invalidlogin.html\");\n\t\t\t\trd.forward(request, response);\n\t\t\t}\n\t\t} catch (MissingResourceException ne) {\n\t\t}\n\t}\n}\n\nframe.java:\nimport javax.servlet.*;\nimport javax.servlet.http.*;\nimport java.io.*;\nimport java.util.*;\npublic class frame extends HttpServlet {\n\tpublic void doPost(HttpServletRequest request, HttpServletResponse \nresponse) throws ServletException, IOException {\n\t\tHttpSession session = request.getSession();\n\t\tStringBuffer frame = new StringBuffer(\"\");\n\t\tString space = \"&nbsp;\";\n\t\tString CRLF = \"\\r\\n\";\n\t\tString tab = \"\\t\";\n\t\tResourceBundle rb = ResourceBundle.getBundle(\"LocalStrings\", \nrequest.getLocale());\n\t\tPrintWriter out = response.getWriter();\n\t\tframe.append(\"<HTML>\" + CRLF\n\t\t\t\t+ tab + \"<HEAD>\" + CRLF\n\t\t\t\t+ tab + tab + \"<TITLE>\" + rb.getString\n(\"FrameServlet.title\") + \"</TITLE>\" + CRLF\n\t\t\t\t+ tab + \"</HEAD>\" + CRLF\n\t\t\t\t+ tab + \"<FRAMESET COLS='250,*' BORDER='0'>\" + \nCRLF\n\t\t\t\t+ tab + tab + \"<FRAME NAME='left' \nSRC='navigation' SCROLLING='auto'>\" + CRLF\n\t\t\t\t+ tab + tab + \"<FRAME NAME='right' \nSRC='todoList'>\" + CRLF\n\t\t\t\t+ tab + tab + \"<NOFRAMES>\" + CRLF\n\t\t\t\t+ tab + tab + tab + \"<BODY>\" + CRLF\n\t\t\t\t+ tab + tab + tab + tab + \"</P>Please use a \nbrowser that supports frames\" + CRLF\n\t\t\t\t+ tab + tab + tab + \"</BODY>\" + CRLF\n\t\t\t\t+ tab + tab + \"</NOFRAMES>\" + CRLF\n\t\t\t\t+ tab + \"</FRAMESET>\" + CRLF\n\t\t\t\t+ \"</HTML>\");\n\t\tresponse.setContentType(\"text/html\");\n\t\tout.println(frame);\n\t}\n}\n\nnavigation.java:\nimport javax.servlet.*;\nimport javax.servlet.http.*;\nimport java.io.*;\nimport java.util.*;\npublic class navigation extends HttpServlet {\n\tprotected void doGet(HttpServletRequest request, HttpServletResponse \nresponse)throws ServletException, IOException {\n\t\tdoPost(request, response);\n\t}\n\tpublic void doPost(HttpServletRequest request, HttpServletResponse \nresponse) throws ServletException, IOException {\n\t\tHttpSession session = request.getSession();\n\t\tString userName = (String)session.getAttribute(\"uid\");\n\n\t\tResourceBundle resourceBundle = ResourceBundle.getBundle\n(\"LocalStrings\", request.getLocale());\n\t\tString firstName = resourceBundle.getString(\"UID.\" + userName \n+ \".firstName\");\n\t\tString lastName = resourceBundle.getString(\"UID.\" + userName \n+ \".lastName\");\n\n\t\tStringBuffer nav = new StringBuffer(\"\");\n\t\tString space = \"&nbsp;\";\n\t\tString CRLF = \"\\r\\n\";\n\t\tString tab = \"\\t\";\n\t\tnav.append(\"<HTML>\" + CRLF\n\t\t\t\t+ tab + \"<HEAD>\" + CRLF\n\t\t\t\t+ tab + tab + \"<TITLE>DaTitle</TITLE>\" + CRLF\n\t\t\t\t+ tab + \"</HEAD>\" + CRLF\n\t\t\t\t+ tab + \"<BODY BGCOLOR=\\\"WHITE\\\">\" + CRLF\n\t\t\t\t+ tab + tab + \"</P>\" + firstName + CRLF\n\t\t\t\t+ tab + tab + \"</P>\" + lastName + CRLF);\n\t\t\t\t+ tab + \"</BODY>\" + CRLF\n\t\t\t\t+ \"</HTML>\");\n\t\tPrintWriter out = response.getWriter();\n\t\tresponse.setContentType(\"text/html\");\n\t\tout.println(nav);\n\t}\n}"}, {"count": 1, "tags": [], "text": "It appears the session is not being picked up in the navigation servlet. Why?\nthere isn't enough detail. Please use the tomcat user list to debug this. They\nwill be much more helpful.", "is_private": false, "id": 70431, "creator": "funkman@joedog.org", "time": "2005-02-03T00:14:16Z", "bug_id": 33370, "creation_time": "2005-02-03T00:14:16Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 33370, "is_private": false, "count": 2, "id": 70475, "time": "2005-02-03T18:52:22Z", "creator": "joel.shaw@tellabs.com", "creation_time": "2005-02-03T18:52:22Z", "text": "Can you provide me with the URL to the Tomcat: user list?"}, {"count": 3, "attachment_id": null, "bug_id": 33370, "is_private": false, "id": 71005, "time": "2005-02-15T16:25:00Z", "creator": "yoavs@computer.org", "creation_time": "2005-02-15T16:25:00Z", "tags": [], "text": "http://jakarta.apache.org/site/mail2.html#Tomcat"}]