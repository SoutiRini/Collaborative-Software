[{"count": 0, "tags": [], "bug_id": 32389, "text": "We are using tomcat-5.5.2, apache2 + mod_jk. Everything is working well but\nafter a while (day or two, does not directly depend on server load) tomcat stops\nresponding to ajp13 requests. Here is debug info from mod_jk:\n\n[Thu Nov 25 13:33:46 2004]  [jk_uri_worker_map.c (539)]:\njk_uri_worker_map_t::map_uri_to_worker, Found a suffix match ajp13 -> *.jsp\n[Thu Nov 25 13:33:46 2004]  [mod_jk.c (1689)]: Into handler r->proxyreq=0\nr->handler=jakarta-servlet r->notes=136986608 worker=ajp13\n[Thu Nov 25 13:33:46 2004]  [jk_worker.c (90)]: Into wc_get_worker_for_name ajp13\n[Thu Nov 25 13:33:46 2004]  [jk_worker.c (94)]: wc_get_worker_for_name, done\nfound a worker\n[Thu Nov 25 13:33:46 2004]  [mod_jk.c (472)]: agsp=80 agsn=www.autorychle.cz\nhostn=www.autorychle.cz shostn=rychle.cz cbsport=0 sport=0\n[Thu Nov 25 13:33:46 2004]  [jk_ajp_common.c (1741)]: Into jk_worker_t::get_endpoint\n[Thu Nov 25 13:33:46 2004]  [jk_ajp_common.c (1367)]: Into jk_endpoint_t::service\n[Thu Nov 25 13:33:46 2004]  [jk_ajp_common.c (257)]: Into ajp_marshal_into_msgb\n[Thu Nov 25 13:33:46 2004]  [jk_ajp_common.c (425)]: ajp_marshal_into_msgb - Done\n[Thu Nov 25 13:33:46 2004]  [jk_connect.c (136)]: Into jk_open_socket\n[Thu Nov 25 13:33:46 2004]  [jk_connect.c (143)]: jk_open_socket, try to connect\nsocket = 40 to 127.0.0.1:8009\n[Thu Nov 25 13:33:46 2004]  [jk_connect.c (159)]: jk_open_socket, after connect\nret = 0\n[Thu Nov 25 13:33:46 2004]  [jk_connect.c (168)]: jk_open_socket, set\nTCP_NODELAY to on\n[Thu Nov 25 13:33:46 2004]  [jk_connect.c (185)]: jk_open_socket, return, sd = 40\n[Thu Nov 25 13:33:46 2004]  [jk_ajp_common.c (701)]: In\njk_endpoint_t::ajp_connect_to_endpoint, connected sd = 40 to 127.0.0.1:8009\n[Thu Nov 25 13:33:46 2004]  [jk_ajp_common.c (737)]: sending to ajp13 #547\n[Thu Nov 25 13:33:46 2004]  [jk_ajp_common.c (1035)]: ajp_send_request 2:\nrequest body to send 0 - request body to resend 0\n[Thu Nov 25 13:38:28 2004]  [jk_ajp_common.c (783)]: ERROR: can't receive the\nresponse message from tomcat, network problems or tomcat is down\n(127.0.0.1:8009), err=-104\n\netc. Tomcat must be restarted to work again. While not responding to ajp13,\nconnecting directly to http interface works ok.\n\nHere is Tomcat ajp config:\n\n    <!-- Define an AJP 1.3 Connector on port 8009 -->\n    <Connector port=\"8009\"\n               enableLookups=\"false\" redirectPort=\"8443\" debug=\"0\"\n               address=\"127.0.0.1\"\n               backlog=\"50\" maxSpareThreads=\"75\" maxThreads=\"220\"\n               soTimeout=\"15000\"\n               protocol=\"AJP/1.3\" />\n\n\nI think this is a tomcat problem. We are running binary distribution on:\n\nbruno:/opt/jakarta/tomcat-5/conf # java -version\njava version \"1.5.0\"\nJava(TM) 2 Runtime Environment, Standard Edition (build 1.5.0-b64)\nJava HotSpot(TM) Server VM (build 1.5.0-b64, mixed mode)\n\n4-processor intel linux machine, 2.4.21\n\ntomcat logs is full of this message:\n\nNov 25, 2004 1:54:39 PM org.apache.commons.modeler.Registry unregisterComponent\nSEVERE: Error unregistering mbean\njavax.management.RuntimeOperationsException: Object name cannot be null\n        at\ncom.sun.jmx.interceptor.DefaultMBeanServerInterceptor.isRegistered(DefaultMBeanServerInterceptor.java:545)\n        at\ncom.sun.jmx.mbeanserver.JmxMBeanServer.isRegistered(JmxMBeanServer.java:619)\n        at\norg.apache.commons.modeler.Registry.unregisterComponent(Registry.java:642)\n        at\norg.apache.jk.common.ChannelSocket.processConnection(ChannelSocket.java:706)\n        at org.apache.jk.common.SocketConnection.runIt(ChannelSocket.java:866)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n        at java.lang.Thread.run(Thread.java:595)\nCaused by: java.lang.IllegalArgumentException: Object name cannot be null\n        ... 7 more\n\nthanks\ndan", "id": 67456, "time": "2004-11-25T13:58:51Z", "creator": "daniel.stanek@mius.cz", "creation_time": "2004-11-25T13:58:51Z", "is_private": false, "attachment_id": null}, {"count": 1, "text": "The Exception is harmless, and nothing in the logs quoted looks even slightly \nunusual.  \n\nYou could try asking for help on tomcat-user.  If you discover additional \ninformation that would point to a Tomcat problem, feel free to REOPEN this.  \nREOPENing without additional information is just a waste of everybody's time, \nsince it is very unlikely that anybody will investigate further based on the \ninformation here :).", "bug_id": 32389, "attachment_id": null, "id": 67498, "time": "2004-11-26T23:12:12Z", "creator": "william.barker@wilshire.com", "creation_time": "2004-11-26T23:12:12Z", "tags": [], "is_private": false}]