[{"count": 0, "attachment_id": null, "bug_id": 34423, "text": "I was trying out mod_jk 1.2.10 with Apache 2.0.53 on FreeBSD when I noticed these errors messages in \nthe log:\n\n...\n[Tue Apr 12 03:18:00 2005] [crit] (13)Permission denied: mod_jk: could not init JK log lock in child\n[Tue Apr 12 03:18:00 2005] [crit] (13)Permission denied: mod_jk: could not init JK log lock in child\n[Tue Apr 12 03:18:00 2005] [crit] (13)Permission denied: mod_jk: could not init JK log lock in child\n...\n\nUpon further examination, it appeared to be caused by wrong permissions on the lock. (It remained \nowned by, and only readable/writable by root.) It seems unixd_set_global_mutex_perms() was not being \ncalled when APR_USE_FLOCK_SERIALIZE was set (as it is on FreeBSD).\n\nThe fix is fairly simple: change the conditional tests for APR_USE_SYSVSEM_SERIALIZE to also include \nAPR_USE_FLOCK_SERIALIZE, i.e. from\n\n  #if APR_USE_SYSVSEM_SERIALIZE\n\nto\n\n  #if APR_USE_SYSVSEM_SERIALIZE || APR_USE_FLOCK_SERIALIZE\n\nOutput of httpd -V:\n\nServer version: Apache/2.0.53\nServer built:   Feb 16 2005 13:42:04\nServer's Module Magic Number: 20020903:9\nArchitecture:   32-bit\nServer compiled with....\n -D APACHE_MPM_DIR=\"server/mpm/prefork\"\n -D APR_HAS_SENDFILE\n -D APR_HAS_MMAP\n -D APR_HAVE_IPV6 (IPv4-mapped addresses enabled)\n -D APR_USE_FLOCK_SERIALIZE\n -D SINGLE_LISTEN_UNSERIALIZED_ACCEPT\n -D APR_HAS_OTHER_CHILD\n -D AP_HAVE_RELIABLE_PIPED_LOGS\n -D HTTPD_ROOT=\"/usr/local\"\n -D SUEXEC_BIN=\"/usr/local/bin/suexec\"\n -D DEFAULT_PIDLOG=\"/var/run/httpd.pid\"\n -D DEFAULT_SCOREBOARD=\"/var/run/apache_runtime_status\"\n -D DEFAULT_LOCKFILE=\"/var/run/accept.lock\"\n -D DEFAULT_ERRORLOG=\"/var/log/httpd-error.log\"\n -D AP_TYPES_CONFIG_FILE=\"etc/apache2/mime.types\"\n -D SERVER_CONFIG_FILE=\"etc/apache2/httpd.conf\"", "id": 73589, "time": "2005-04-12T23:23:12Z", "creator": "allan@saddi.com", "creation_time": "2005-04-12T23:23:12Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "allan@saddi.com", "attachment_id": 14695, "id": 73590, "time": "2005-04-12T23:26:08Z", "bug_id": 34423, "creation_time": "2005-04-12T23:26:08Z", "is_private": false, "text": "Created attachment 14695\nProposed fix\n\nThis patch was made against the 1.2.10 distribution, relative to the jk/native\ndirectory."}, {"count": 2, "tags": [], "text": "Committed, thanks!", "attachment_id": null, "id": 73601, "creator": "mturk@apache.org", "time": "2005-04-13T08:35:43Z", "bug_id": 34423, "creation_time": "2005-04-13T08:35:43Z", "is_private": false}]