[{"count": 0, "tags": [], "bug_id": 58505, "attachment_id": null, "id": 185791, "time": "2015-10-19T14:50:34Z", "creator": "arliweng@gmail.com", "creation_time": "2015-10-19T14:50:34Z", "is_private": false, "text": "on i686 archlinux\nthe ServletRequest.getParameterMap() size is 0 always when POST.\nbut fine when GET. and fine when i read from ServletRequest.getInputStream()..\nonly 7.0.62 work fine, i don't known what's happen.\n\ni try version 7.0.63,7.0.64,8.0.28, all same problem.\nthat version i have manual download and run by root via bin/startup.sh, not by archlinux's package or archlinux's aur system.\n\ni try read something from changelog, but nothing about that.\n\nthis's my env:\n\n[root@srv1-lb http]# uname -a\nLinux srv1-lb 4.2.3-1-ARCH #1 SMP PREEMPT Sat Oct 3 19:08:23 CEST 2015 i686 GNU/Linux\n\n[root@srv1-lb http]# java -version\nopenjdk version \"1.8.0_60\"\nOpenJDK Runtime Environment (build 1.8.0_60-b24)\nOpenJDK Server VM (build 25.60-b23, mixed mode)\n\n[root@srv1-lb http]# ls /srv/http/apache-tomcat-7.0.6*\n/srv/http/apache-tomcat-7.0.62:\nbin   lib      logs    RELEASE-NOTES  temp     work\nconf  LICENSE  NOTICE  RUNNING.txt    webapps\n\n/srv/http/apache-tomcat-7.0.63:\nbin   lib      logs    RELEASE-NOTES  temp     work\nconf  LICENSE  NOTICE  RUNNING.txt    webapps\n\n/srv/http/apache-tomcat-7.0.64:\nbin   lib      logs    RELEASE-NOTES  temp     work\nconf  LICENSE  NOTICE  RUNNING.txt    webapps\n\n[root@srv1-lb http]# cat /srv/http/apache-tomcat-7.0.64/conf/server.xml \n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\n<Server port=\"8005\" shutdown=\"SHUTDOWN\">\n\t<Service name=\"Catalina\">\n\t\t<Connector address=\"127.0.0.1\" port=\"8080\" maxHttpHeaderSize=\"8192\" maxThreads=\"1000\"\n\t\t\tminSpareThreads=\"10\" maxSpareThreads=\"50\" enableLookups=\"false\"\n\t\t\tacceptCount=\"100\" connectionTimeout=\"10000\" connectionLinger=\"50\"\n\t\t\tdisableUploadTimeout=\"false\" URIEncoding=\"UTF-8\" maxPostSize=\"0\" />\n\t\t<Context reloadable=\"true\" />\n\t\t<Engine name=\"Catalina\" defaultHost=\"arlihost\">\n                        <Host name=\"arlihost\" appBase=\"/srv/http/arlihost/webroot/\"\n                                unpackWARs=\"true\" autoDeploy=\"true\" xmlValidation=\"false\"\n                                xmlNamespaceAware=\"false\">\n\t\t\t\t<Alias>1fawu.com</Alias>\n                        </Host>\n\t\t</Engine>\n\t</Service>\n</Server>"}, {"count": 1, "tags": [], "bug_id": 58505, "is_private": false, "text": "this's p.java:\n\npackage j2eetest;\n\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\n@WebServlet(name = \"p\", urlPatterns = {\"/p\"})\npublic class p extends HttpServlet {\n\n    @Override\n    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        this.doPost(req, resp);\n    }\n\n    @Override\n    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        resp.setContentType(\"text/plain\");\n//        InputStream in = req.getInputStream();\n//        byte[] bs = StreamReader.readAllBytes(in, false);\n//        resp.getWriter().write(String.valueOf(bs.length));\n//        resp.getWriter().write('\\n');\n//        resp.getWriter().write(new String(bs)); // here is work fine\n\n        resp.getWriter().write('\\n');\n        try {\n            resp.getWriter().write(req.getParameter(\"_mn\")); //here i got null\n            resp.getWriter().write('\\n');\n            resp.getWriter().write(String.valueOf(req.getParameterMap().size()));\n        } catch (Exception e) {\n            e.printStackTrace(new PrintWriter(resp.getWriter()));\n        }\n    }\n}\n\nthis's 8.0.28(last test version) response:\n\njava.lang.NullPointerException\n\tat org.apache.catalina.connector.CoyoteWriter.write(CoyoteWriter.java:180)\n\tat j2eetest.p.doPost(p.java:30)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:648)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:729)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:291)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n\tat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:239)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:217)\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:106)\n\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:502)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:142)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79)\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:88)\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:518)\n\tat org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1091)\n\tat org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:673)\n\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1500)\n\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1456)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\n\tat java.lang.Thread.run(Thread.java:745)", "id": 185792, "time": "2015-10-19T14:52:17Z", "creator": "arliweng@gmail.com", "creation_time": "2015-10-19T14:52:17Z", "attachment_id": null}, {"count": 2, "attachment_id": null, "bug_id": 58505, "is_private": false, "id": 185793, "time": "2015-10-19T14:54:31Z", "creator": "arliweng@gmail.com", "creation_time": "2015-10-19T14:54:31Z", "tags": [], "text": "(In reply to ArLi Weng from comment #1)\n> this's p.java:\n> \n> package j2eetest;\n> \n> import java.io.IOException;\n> import java.io.PrintWriter;\n> import javax.servlet.ServletException;\n> import javax.servlet.annotation.WebServlet;\n> import javax.servlet.http.HttpServlet;\n> import javax.servlet.http.HttpServletRequest;\n> import javax.servlet.http.HttpServletResponse;\n> \n> @WebServlet(name = \"p\", urlPatterns = {\"/p\"})\n> public class p extends HttpServlet {\n> \n>     @Override\n>     protected void doGet(HttpServletRequest req, HttpServletResponse resp)\n> throws ServletException, IOException {\n>         this.doPost(req, resp);\n>     }\n> \n>     @Override\n>     protected void doPost(HttpServletRequest req, HttpServletResponse resp)\n> throws ServletException, IOException {\n>         resp.setContentType(\"text/plain\");\n> //        InputStream in = req.getInputStream();\n> //        byte[] bs = StreamReader.readAllBytes(in, false);\n> //        resp.getWriter().write(String.valueOf(bs.length));\n> //        resp.getWriter().write('\\n');\n> //        resp.getWriter().write(new String(bs)); // here is work fine\n> \n>         resp.getWriter().write('\\n');\n>         try {\n>             resp.getWriter().write(req.getParameter(\"_mn\")); //here i got\n> null\n>             resp.getWriter().write('\\n');\n>            \n> resp.getWriter().write(String.valueOf(req.getParameterMap().size()));\n>         } catch (Exception e) {\n>             e.printStackTrace(new PrintWriter(resp.getWriter()));\n>         }\n>     }\n> }\n> \n> this's 8.0.28(last test version) response:\n> \n> java.lang.NullPointerException\n> \tat org.apache.catalina.connector.CoyoteWriter.write(CoyoteWriter.java:180)\n> \tat j2eetest.p.doPost(p.java:30)\n> \tat javax.servlet.http.HttpServlet.service(HttpServlet.java:648)\n> \tat javax.servlet.http.HttpServlet.service(HttpServlet.java:729)\n> \tat\n> org.apache.catalina.core.ApplicationFilterChain.\n> internalDoFilter(ApplicationFilterChain.java:291)\n> \tat\n> org.apache.catalina.core.ApplicationFilterChain.\n> doFilter(ApplicationFilterChain.java:206)\n> \tat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)\n> \tat\n> org.apache.catalina.core.ApplicationFilterChain.\n> internalDoFilter(ApplicationFilterChain.java:239)\n> \tat\n> org.apache.catalina.core.ApplicationFilterChain.\n> doFilter(ApplicationFilterChain.java:206)\n> \tat\n> org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.\n> java:217)\n> \tat\n> org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.\n> java:106)\n> \tat\n> org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.\n> java:502)\n> \tat\n> org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:142)\n> \tat\n> org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79)\n> \tat\n> org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:\n> 88)\n> \tat\n> org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:518)\n> \tat\n> org.apache.coyote.http11.AbstractHttp11Processor.\n> process(AbstractHttp11Processor.java:1091)\n> \tat\n> org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.\n> process(AbstractProtocol.java:673)\n> \tat\n> org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.\n> java:1500)\n> \tat\n> org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:\n> 1456)\n> \tat\n> java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:\n> 1142)\n> \tat\n> java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:\n> 617)\n> \tat\n> org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.\n> java:61)\n> \tat java.lang.Thread.run(Thread.java:745)\n\nbtw: i have post that data: _mn=a"}, {"attachment_id": null, "tags": [], "creator": "arliweng@gmail.com", "is_private": false, "count": 3, "id": 185794, "time": "2015-10-19T14:58:23Z", "bug_id": 58505, "creation_time": "2015-10-19T14:58:23Z", "text": "but work fine on archlinux x86_64(my work pc: Linux anix-pc 4.2.3-1-ARCH #1 SMP PREEMPT Sat Oct 3 18:52:50 CEST 2015 x86_64 GNU/Linux)\n\nmay be jdk problem?\n\nall same but i686 vs x86_64\n\n[root@srv1-lb http]# pacman -Qs jre\nlocal/jre8-openjdk 8.u60-1\n    OpenJDK Java 8 full runtime environment\nlocal/jre8-openjdk-headless 8.u60-1\n    OpenJDK Java 8 headless runtime environment"}, {"count": 4, "tags": [], "bug_id": 58505, "attachment_id": null, "text": "Bugzilla is not a support forum. Please take this to the users mailing list.\n\nIf that discussion results in a reproducible test case for behaviour that is inconsistent with the Servlet specification then feel free to re-open this issue and attach the test case.", "id": 185796, "time": "2015-10-19T15:22:53Z", "creator": "markt@apache.org", "creation_time": "2015-10-19T15:22:53Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 58505, "is_private": false, "text": "> maxPostSize=\"0\" />\n\nThe above setting is invalid. Its interpretation was changed in 7.0.63 (see the changelog).", "id": 185799, "time": "2015-10-19T18:32:47Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2015-10-19T18:32:47Z", "attachment_id": null}, {"count": 6, "tags": [], "text": "(In reply to Konstantin Kolinko from comment #5)\n> > maxPostSize=\"0\" />\n> \n> The above setting is invalid. Its interpretation was changed in 7.0.63 (see\n> the changelog).\n\nthank u for reply..\nsorry for delay, i have confirm is maxPostSize problem, resoleved when i change to 10485760.\n\nps:i forget tell multipart mode on that test sample.", "attachment_id": null, "bug_id": 58505, "id": 187810, "time": "2016-01-18T20:32:56Z", "creator": "arliweng@gmail.com", "creation_time": "2016-01-18T20:32:56Z", "is_private": false}]