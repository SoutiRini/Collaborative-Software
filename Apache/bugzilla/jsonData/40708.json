[{"count": 0, "tags": [], "creator": "mirko.zieroth@nuernberger.de", "attachment_id": null, "text": "The classes to be tested are Singletons written with AspectJ and Java 1.5. The\ntest-classes are pure Junit 4 tests with anotations and without JUnit4TestAdapter.\n\nIf I run the ant script with fork=\"no\" I get the exception: \"No runnable methods\".\nBut if I run the ant script with the attribute fork=\"yes\" the junit testcase can\nbe executed and I get an \"AssertionFailedError\".\n\nHere is the junit task of my ant-script:\n\n<junit printsummary=\"on\" haltonerror=\"off\"  >\n\t<formatter type=\"xml\" />\n\t<classpath>\n\t <pathelement path=\"${classes.dir}\" />\n\t\t<pathelement path=\"${test.classes.dir}\" />\n\t\t<pathelement path=\"${ant.home}/lib/\" />\n\t</classpath>\n\t<classpath refid=\"project.classpath\" />\n\n\t<batchtest fork=\"no\" todir=\"${test.report.dir}\" >\n\t\t<fileset dir=\"${test.source.dir}\">\n\t\t\t<include name=\"**/*Test*.java\" />\n\t\t\t<exclude name=\"**/*Mock*.java\" />\n\t\t</fileset>\n\t</batchtest>\n</junit>\n\n\nHere is the test-case:\n\npublic class SingletonTest\n{\n  @Test \n  public void createSingleton()\n  {\n    TestMock1 s1 = new TestMock1();\n    TestMock1 s2 = new TestMock1();\n    \n    assertEquals(s1, s2);\n    assertTrue(s1.getInvocationTime() == s2.getInvocationTime());\n    \n    TestMock2 s3 = new TestMock2();\n    TestMock2 s4 = new TestMock2();\n    \n    assertEquals(s3, s4);\n    assertTrue(s3.getInvocationTime() == s4.getInvocationTime());\n    assertNotSame(s1, s3);\n  }\n}\n\nand one mock object representatively for the other:\n\n@Singleton\npublic class TestMock1\n{\n  protected Long invocationTime = System.currentTimeMillis();\n  \n  /**\n   * R&#65533;ckgabe der Instanziierungszeit\n   * @return long - Timestamp\n   */\n  public Long getInvocationTime()\n  {\n    return invocationTime; \n  }", "id": 94644, "time": "2006-10-09T02:00:15Z", "bug_id": 40708, "creation_time": "2006-10-09T02:00:15Z", "is_private": false}, {"count": 1, "tags": [], "creator": "peterreilly@apache.org", "attachment_id": null, "text": "This should be fixed with the current nightly build.\n\n*** This bug has been marked as a duplicate of 40697 ***", "id": 94645, "time": "2006-10-09T02:16:24Z", "bug_id": 40708, "creation_time": "2006-10-09T02:16:24Z", "is_private": false}]