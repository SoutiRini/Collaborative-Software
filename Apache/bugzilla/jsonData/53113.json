[{"attachment_id": 28645, "tags": [], "bug_id": 53113, "is_private": false, "count": 0, "id": 158217, "time": "2012-04-20T10:03:29Z", "creator": "sergio@bosoconsulting.it", "creation_time": "2012-04-20T10:03:29Z", "text": "Created attachment 28645\nProperty File working\n\nIf  the application creates multiple clocke in a single operation ONLY one is stored by the cookie manager.\nThe workaround is to set the property:\nCookieManager.save.cookies=true\n\nEnclose you an find:\n- demo plan based on yahoo\n- jmeter_original.properties : default property file (Jmeter 2.6)\n- step1_jmeter.properties    : working property file\n\n- Note_bug Jmeter.doc        : few more nfo con test I have done.\n\nbest regards\n\nSergio"}, {"count": 1, "tags": [], "text": "Created attachment 28646\nUsed test plan", "is_private": false, "id": 158218, "creator": "sergio@bosoconsulting.it", "time": "2012-04-20T10:04:11Z", "bug_id": 53113, "creation_time": "2012-04-20T10:04:11Z", "attachment_id": 28646}, {"count": 2, "tags": [], "bug_id": 53113, "text": "Created attachment 28647\nProperty File NOT working", "id": 158219, "time": "2012-04-20T10:05:44Z", "creator": "sergio@bosoconsulting.it", "creation_time": "2012-04-20T10:05:44Z", "is_private": false, "attachment_id": 28647}, {"count": 3, "tags": [], "bug_id": 53113, "is_private": false, "text": "Created attachment 28648\nShort test description (word format)", "id": 158220, "time": "2012-04-20T10:06:57Z", "creator": "sergio@bosoconsulting.it", "creation_time": "2012-04-20T10:06:57Z", "attachment_id": 28648}, {"count": 4, "tags": [], "creator": "sebb@apache.org", "attachment_id": null, "text": "The main difference between the two property files is that the following line is included in the file that you say works.\n\nCookieManager.check.cookies=false\n\nThis means that the problem is due to JMeter receiving an invalid cookie.\n\nI've had a brief look at the test plan, and there are at least 5 samplers.\nIt's not at all clear which one is failing. It could take a long time to find out.\n\nPlease provide a *minimal* test plan that shows the problem, and / or details of the server responses that show the Set-Cookie headers that are not being processed.", "id": 158221, "time": "2012-04-20T10:35:28Z", "bug_id": 53113, "creation_time": "2012-04-20T10:35:28Z", "is_private": false}, {"count": 5, "tags": [], "text": "Created attachment 28651\nProperty File working\n\nThis property file has less differences from the standard property", "is_private": false, "id": 158252, "creator": "sergio@bosoconsulting.it", "time": "2012-04-21T08:51:30Z", "bug_id": 53113, "creation_time": "2012-04-21T08:51:30Z", "attachment_id": 28651}, {"count": 6, "tags": [], "bug_id": 53113, "is_private": false, "text": "Created attachment 28652\nUsed test plan (slightly simplyfied)\n\nTook away some parts.", "id": 158253, "time": "2012-04-21T08:53:21Z", "creator": "sergio@bosoconsulting.it", "creation_time": "2012-04-21T08:53:21Z", "attachment_id": 28652}, {"count": 7, "tags": [], "creator": "sergio@bosoconsulting.it", "text": "After further investigation, I reach the conclusion all is about cookie validity check.\nI'm not able to simplify the test plan and still reproducing the problem.\n\nThe file jmeter_original.properties makes the test NOT working (this is teh one distributed with the release 2.6).\nThe file step2bis_jmeter.properties makes the test working.\nThe difference is the line:\n\tCookieManager.check.cookies=false\n\nIf you run the test with the original property file, look at the result tree, go to the \u201ccheck mail\u201d sampler and see that only  2 Cookie Data are sent:\n  B=6ctqrh17p4s62&b=3&s=ki;\n  CH=AgBPknAQAD8pEAAKgBAAMY8QADXYEAA7kRAAMbQQAApUEAAW2hAAK44QAAzU\nGo up to the \u201cPOST Login\u201d sampler, \u201csampler result\u201d tab, you can see that several cookies are set (see below).\nI'm not able to say if these are correct or not, however they are managed by Firefox 3.9 and Explorer 9. \nAlso, HttpWatch 7.2 do not give any warning about them.\n\nLet me know if you need more info/test etc.\n\nregards\nSergio", "id": 158254, "time": "2012-04-21T08:59:34Z", "bug_id": 53113, "creation_time": "2012-04-21T08:59:34Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 53113, "attachment_id": null, "is_private": false, "id": 158262, "time": "2012-04-21T15:02:08Z", "creator": "sebb@apache.org", "creation_time": "2012-04-21T15:02:08Z", "text": "(In reply to comment #7)\n> After further investigation, I reach the conclusion all is about cookie\n> validity check.\n\nAs expected.\n\n> Let me know if you need more info/test etc.\n\nWhat are the cookies that are being sent by the server which are not being accepted by JMeter?\n\nPleas provide the exact headers (they are available from the Tree View Listener).\n\nHave you checked the jmeter.log file to see if there are any errors logged?"}, {"count": 9, "tags": [], "bug_id": 53113, "text": "(In reply to comment #8)\n> (In reply to comment #7)\n> > After further investigation, I reach the conclusion all is about cookie\n> > validity check.\n> \n> As expected.\n> \n> > Let me know if you need more info/test etc.\n> \n> What are the cookies that are being sent by the server which are not being\n> accepted by JMeter?\n> \n=== 1- Copy& past from sampler POST login:\nResponse headers:\nHTTP/1.1 200 OK\nDate: Sun, 22 Apr 2012 09:35:33 GMT\nSet-Cookie: B=35qqdth7p7k75&b=4&d=bSx.OL9pYF6j5KSqgyEJJHH7R4hqrGnPvjOxAA--&s=o9&i=HtjX4zCoyjr4SjajBsB.; expires=Wed, 23-Apr-2014 09:35:33 GMT; path=/; domain=.yahoo.com\nSet-Cookie: YLS=v=1&p=1&n=1; expires=Wed, 23-Apr-2014 09:35:33 GMT; path=/; domain=.yahoo.com\nSet-Cookie: F=a=YRu.LIcMvTc.SfPHCfHJ6CRCRPonieXousSPOlJkp4rz_ZPiVx3IPyvRYQM4sN6q20sHeis-&b=98vx; expires=Wed, 23-Apr-2014 09:35:33 GMT; path=/; domain=.yahoo.com\nSet-Cookie: Y=v=1&n=bijjs1v60be04&l=j4ijsqrr1/o&p=m1tvvit012000000&iz=35129&r=np&lg=it-IT&intl=it; expires=Wed, 23-Apr-2014 09:35:33 GMT; path=/; domain=.yahoo.com\nSet-Cookie: PH=fn=3NJftyOSujR3odeaf68-&l=it-IT&i=it; expires=Wed, 23-Apr-2014 09:35:33 GMT; path=/; domain=.yahoo.com\nSet-Cookie: T=z=lD9kPBlXkpPBjI.4HVDVZSSNU4zBjAyMzQyNU4zNTEzMzcyTz&a=QAE&sk=DAAb.ZXs3K2wt5&ks=EAAQERxB2tWZz3VjzIOSQkLMw--~E&d=c2wBTWprMEFUYzFORE0xTWprME1qWTBOREExT0RZeQFhAVFBRQFnATVIVFlMN1AyRzZORFVQS0Y1M1dEMklYNFRVAXRpcAFVeE5SREIBenoBbEQ5a1BCQTdF; expires=Wed, 23-Apr-2014 09:35:33 GMT; path=/; domain=.yahoo.com\nSet-Cookie: SSL=v=1&s=Lk2gWWXc9XAu_6o_5EETuQWjBdHrK7fNO2AQc6RFKQrhQF5UFe_j41giO.HM4msWSJOaBXau2rF5jVF5Nr7EYw--&kv=0; expires=Wed, 23-Apr-2014 09:35:33 GMT; path=/; domain=.yahoo.com; secure; httponly\nP3P: policyref=\"http://info.yahoo.com/w3c/p3p.xml\", CP=\"CAO DSP COR CUR ADM DEV TAI PSA PSD IVAi IVDi CONi TELo OTPi OUR DELi SAMi OTRi UNRi PUBi IND PHY ONL UNI PUR FIN COM NAV INT DEM CNT STA POL HEA PRE LOC GOV\"\nX-Frame-Options: DENY\nVary: Accept-Encoding\nConnection: close\nTransfer-Encoding: chunked\nContent-Type: application/json\nContent-Encoding: gzip\nCache-Control: private\n\n=== 2- Copy&paste from CheckMail sampler, Request tab:\n\nCookie Data:\nB=9fh8c7l7p7k71&b=3&s=81; CH=AgBPk9AQABCxEAAFwBAAFtoQABk8EAA6MxAAJkcQADhrEAAI4hAALAUQAAzU\n\nRequest Headers:\nConnection: keep-alive\nAccept-Language: it-it,it;q=0.8,en-us;q=0.5,en;q=0.3\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nKeep-Alive: 115\nUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; it; rv:1.9.2.28) Gecko/20120306 Firefox/3.6.28 (.NET CLR 3.5.30729)\nAccept-Encoding: gzip,deflate\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\nConnection: keep-alive\nHost: it.mg40.mail.yahoo.com\n\n> \n> Have you checked the jmeter.log file to see if there are any errors logged?\n\n=== I did right now. No warning/error message. Here is execution part of the log file\n\n\n2012/04/22 11:35:26 INFO  - jmeter.util.NameUpdater: Processing jar:file:/C:/Program_files/apache-jmeter-2.6/lib/ext/JMeterPlugins.jar!/META-INF/resources/org.apache.jmeter.nameupdater.properties \n2012/04/22 11:35:26 INFO  - jmeter.util.NameUpdater: Added additional nameMap entry: kg.apc.jmeter.vizualizers.TotalTransactionsPerSecondGui \n2012/04/22 11:35:26 INFO  - jmeter.protocol.http.control.CookieManager: Settings: Delete null: true Check: true Allow variable: true Save: false Prefix: COOKIE_ \n2012/04/22 11:35:26 INFO  - jmeter.services.FileServer: Set new base='D:\\Home\\Lavoro\\Progetti\\WebStress\\Jmeter Bug' \n2012/04/22 11:35:30 INFO  - jmeter.engine.StandardJMeterEngine: Listeners will be started after enabling running version \n2012/04/22 11:35:30 INFO  - jmeter.engine.StandardJMeterEngine: To revert to the earlier behaviour, define jmeterengine.startlistenerslater=false \n2012/04/22 11:35:30 INFO  - jmeter.engine.StandardJMeterEngine: Running the test! \n2012/04/22 11:35:30 INFO  - jmeter.gui.util.JMeterMenuBar: setRunning(true,*local*) \n2012/04/22 11:35:30 INFO  - jmeter.engine.StandardJMeterEngine: Starting 1 threads for group Thread Group base. \n2012/04/22 11:35:30 INFO  - jmeter.engine.StandardJMeterEngine: Thread will continue on error \n2012/04/22 11:35:30 INFO  - jmeter.threads.JMeterThread: jmeterthread.startearlier=true (see jmeter.properties) \n2012/04/22 11:35:30 INFO  - jmeter.threads.JMeterThread: Running PostProcessors in forward order \n2012/04/22 11:35:30 INFO  - jmeter.engine.StandardJMeterEngine: All threads have been started \n2012/04/22 11:35:30 INFO  - jmeter.threads.JMeterThread: Thread started: Thread Group base 1-1 \n2012/04/22 11:35:30 INFO  - jmeter.protocol.http.sampler.HTTPHCAbstractImpl: Local host = Sergio-PC \n2012/04/22 11:35:30 INFO  - jmeter.protocol.http.sampler.HTTPHC4Impl: HTTP request retry count = 1 \n2012/04/22 11:35:31 INFO  - jmeter.protocol.http.sampler.HTTPHC4Impl: Setting up HTTPS TrustAll scheme \n2012/04/22 11:35:37 INFO  - jmeter.threads.JMeterThread: Thread finished: Thread Group base 1-1 \n2012/04/22 11:35:37 INFO  - jmeter.engine.StandardJMeterEngine: Ending thread Thread Group base 1-1 \n2012/04/22 11:35:37 INFO  - jmeter.engine.StandardJMeterEngine: Notifying test listeners of end of test \n2012/04/22 11:35:37 INFO  - jmeter.gui.util.JMeterMenuBar: setRunning(false,*local*) \n2012/04/22 11:35:37 INFO  - jmeter.engine.StandardJMeterEngine: Test has ended on host null", "id": 158269, "time": "2012-04-22T09:48:02Z", "creator": "sergio@bosoconsulting.it", "creation_time": "2012-04-22T09:48:02Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "attachment_id": null, "text": "Hello,\nI ran you test plan and this is the issue with Cookie:\norg.apache.commons.httpclient.cookie.MalformedCookieException: Illegal domain attribute \".yahoo.com\". Domain of origin: \"mail.yahoo.com/\"\n\nNote that message is at DEBUG level, so this may explain why you don't get it.\nSeems strange that it's DEBUG and not WARN.\n\n\nI see the following issues in your test plan:\n- extractor should be : mail.yahoo.com/([^\"].+?)\"\n- Hosts in Sampler end with /\n\n\nI attach partly fixed test plan.\nI will change log level to WARN on this kind of issues.", "id": 158315, "time": "2012-04-23T19:25:18Z", "bug_id": 53113, "creation_time": "2012-04-23T19:25:18Z", "is_private": false}, {"count": 11, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "text": "Created attachment 28661\nPatly fixed test plan", "id": 158316, "time": "2012-04-23T19:25:56Z", "bug_id": 53113, "creation_time": "2012-04-23T19:25:56Z", "is_private": false, "attachment_id": 28661}, {"count": 12, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "attachment_id": null, "text": "Date: Mon Apr 23 19:26:32 2012\nNew Revision: 1329387\n\nURL: http://svn.apache.org/viewvc?rev=1329387&view=rev\nLog:\nChange level to warn when invalid cookie is found\n\nModified:\n  \njmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/control/HC3CookieHandler.java", "id": 158317, "time": "2012-04-23T19:27:51Z", "bug_id": 53113, "creation_time": "2012-04-23T19:27:51Z", "is_private": false}]