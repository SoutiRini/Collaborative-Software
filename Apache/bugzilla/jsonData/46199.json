[{"count": 0, "tags": [], "bug_id": 46199, "is_private": false, "text": "I try open a spreadsheet with POI 3.2-final. This is error message:\n\n\nException in thread \"main\" org.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:186)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:328)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:271)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:196)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:178)\n\tat atd2ltdd.main(atd2ltdd.java:62)\nCaused by: java.lang.ArrayIndexOutOfBoundsException\n\tat org.apache.poi.hssf.record.RecordInputStream.checkRecordPosition(RecordInputStream.java:142)\n\tat org.apache.poi.hssf.record.RecordInputStream.readInt(RecordInputStream.java:172)\n\tat org.apache.poi.hssf.record.EmbeddedObjectRefSubRecord.<init>(EmbeddedObjectRefSubRecord.java:134)\n\tat org.apache.poi.hssf.record.SubRecord.createSubRecord(SubRecord.java:52)\n\tat org.apache.poi.hssf.record.ObjRecord.<init>(ObjRecord.java:63)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)\n\tat java.lang.reflect.Constructor.newInstance(Unknown Source)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:184)\n\t... 5 more", "id": 122427, "time": "2008-11-13T07:14:19Z", "creator": "duc.nguyen@sds.com.vn", "creation_time": "2008-11-13T07:14:19Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "duc.nguyen@sds.com.vn", "attachment_id": 22860, "is_private": false, "id": 122428, "time": "2008-11-13T07:17:15Z", "bug_id": 46199, "creation_time": "2008-11-13T07:17:15Z", "text": "Created attachment 22860\nInput for this bug"}, {"count": 2, "tags": [], "bug_id": 46199, "attachment_id": null, "is_private": false, "id": 122447, "time": "2008-11-13T15:08:59Z", "creator": "josh@apache.org", "creation_time": "2008-11-13T15:08:59Z", "text": "Fixed in svn r713852.\n\nMore tweaks to EmbeddedObjectRefSubRecord (also changed recently in bug 45912).  This record has an unusual encoding for one of its string fields: the unicode options byte is omitted when the string length is zero.  Prior to this fix, the code was not consistent about this.\n\nJunit added."}, {"count": 3, "tags": [], "bug_id": 46199, "is_private": false, "text": "After I get patch for EmbeddedObjectRefSubRecord.java in svn r713852, then compile POI. But this issue still appears.\n", "id": 122491, "time": "2008-11-14T08:21:39Z", "creator": "duc.nguyen@sds.com.vn", "creation_time": "2008-11-14T08:21:39Z", "attachment_id": null}, {"count": 4, "tags": [], "text": "Patch version of EmbeddedObjectRefSubRecord in r713852 imported some classes.\nimport org.apache.poi.util.LittleEndianInput;\nimport org.apache.poi.util.LittleEndianInputStream;\nimport org.apache.poi.util.LittleEndianOutput;\n\nBut they're not in source code of POI 3.2-final.\nWhere do I get them ?", "is_private": false, "id": 122529, "creator": "duc.nguyen@sds.com.vn", "time": "2008-11-15T23:56:11Z", "bug_id": 46199, "creation_time": "2008-11-15T23:56:11Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "josh@apache.org", "attachment_id": null, "is_private": false, "id": 122576, "time": "2008-11-17T08:57:15Z", "bug_id": 46199, "creation_time": "2008-11-17T08:57:15Z", "text": "These files were added back in r707450.  I guess that was after POI-3.2-FINAL\n\nFrom what I can see these files are present OK in svn trunk.  For example:\nhttp://svn.apache.org/repos/asf/poi/trunk/src/java/org/apache/poi/util/LittleEndianInput.java\n\nPlease re-open if you are still having trouble."}]