[{"attachment_id": null, "tags": [], "bug_id": 35016, "text": "For searchengine optimization and to make our dynamic links a little bit nicer\nwe use a mod_rewrite map program, which rewrites a URL like this:\n\nhttp://whiskey/cipp/cachetest,foo,1  ->  \nlynx http://whiskey/cgi-bin/cachetest.cgi?foo=1\n\nThe RewriteRule looks like this:\n  RewriteEngine On\n  RewriteMap    stat2cgi           prg:/usr/local/bin/rewritemap_stat2cgi.pl\n  RewriteRule   ^/cipp/(.+)$            ${stat2cgi:/cgi-bin/$1} [PT,L]\n\n\nAfter years of using Apache 1.3 with a reverse acceleration squid proxy, we now\nwant to use mod_cache with Apache 2.0 for caching our dynamic content...\n\nWhen requesting \nlynx http://whiskey/cgi-bin/cachetest.cgi?foo=1\neverything works fine. The content was stored in the cache. \n\nWhen requesting\nhttp://whiskey/cipp/cachetest,foo,1\nthe content was NOT stored in the cache...\n\nHere are some interesting excerpts from the mod_rewrite log and mod_cache log:\n\nmod_rewrite:\n194.8.212.148 - - [23/May/2005:08:37:35 +0200]\n[whiskey/sid#81550d8][rid#8396ea0/initial] (2) init rewrite engine with\nrequested uri /cipp/cachetest,foo,1\n[whiskey/sid#81550d8][rid#8396ea0/initial] (3) applying pattern '^/cipp/(.+)$'\nto uri '/cipp/cachetest,foo,1'\n[whiskey/sid#81550d8][rid#8396ea0/initial] (2) rewrite /cipp/cachetest,foo,1 ->\n/cgi-bin/cachetest.cgi?foo=1\n[whiskey/sid#81550d8][rid#8396ea0/initial] (3) split\nuri=/cgi-bin/cachetest.cgi?foo=1 -> uri=/cgi-bin/cachetest.cgi, args=foo=1\n\nHere is the apache debug log:\n[Mon May 23 08:52:18 2005] [debug] mod_cache.c(534): cache: Caching url:\n/cipp/cachetest,foo,1\n[Mon May 23 08:52:18 2005] [debug] mod_disk_cache.c(645): disk_cache: Stored\nheaders for URL whiskey/cgi-bin/cachetest.cgi?foo=1\n[Mon May 23 08:52:18 2005] [debug] mod_disk_cache.c(747): disk_cache: Body for\nURL whiskey/cgi-bin/cachetest.cgi?foo=1 cached.\n[Mon May 23 08:52:18 2005] [debug] \n\nSo it looks like mod_cache doesn't use the requesting URL but instead the\nrewrited URL as the cache key.\n\nIn my opinion, this is a bug.", "count": 0, "id": 75209, "time": "2005-05-23T08:58:24Z", "creator": "apache@dimedis.de", "creation_time": "2005-05-23T08:58:24Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 35016, "text": "Bug #34885 has the solution to this.\n\nAfter applying the patch in bug 34885. setting:\nCacheEnable disk / normal\n\nWill provide the requested functionality.\n\n\n*** This bug has been marked as a duplicate of 34885 ***", "id": 75211, "time": "2005-05-23T09:35:41Z", "creator": "chip@force-elite.com", "creation_time": "2005-05-23T09:35:41Z", "is_private": false, "attachment_id": null}]