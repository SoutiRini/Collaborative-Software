[{"count": 0, "attachment_id": null, "bug_id": 8034, "text": "(Note: This issue was posted to users@httpd.apache.org, but didn't receive any \nresponses.)\n\nI have been unable to get Apache 2.0.35's built-in mod_ssl to work.  I've tried \nbuilding on Solaris 7 and 8 with the same results.  I've tried building mod_ssl \nboth shared and staticly; both fail, but with different reasons, which I will \ndetail below.\n\n### SHARED\n\nWhen I build a shared mod_ssl, I use the following configure:\n\n  ./configure --prefix=/local/opt/apache2 \\\n              --enable-usertrack=shared \\\n              --enable-so \\\n              --with-mpm=worker \\\n              --disable-imap \\\n              --enable-cgid \\\n              --enable-ssl=shared \\          # shared mod_ssl\n              --with-ssl=/usr/local/ssl \\    # OpenSSL 0.9.6b\n              --enable-dav=shared \\\n              --enable-dav-fs=shared \n  \nIt builds and installs fine.  When I start it in non-ssl mode, it also \nworks fine.  But when I try \"apachectl startssl\" I get the following \noutput:\n\n  Syntax error on line 220 of /local/opt/apache2/conf/httpd.conf:\n  Cannot load /local/opt/apache2/modules/mod_ssl.so into server: ld.so.1:\n/local/opt/apache2/bin/httpd: fatal: relocation error: file\n/local/opt/apache2/modules/mod_ssl.so: symbol X509_INFO_free: referenced\nsymbol not found\n  ./apachectl startssl: httpd could not be started\n  \nThe syntax error it is complaining about is from the stock httpd.conf:\n\n  LoadModule ssl_module modules/mod_ssl.so \n\nRunning just 'apachectl start' works fine, but, of course, it doesn't serve\nSSL.\n\n### STATIC\n\nSo since that didn't work, I tried building a staticly-linked mod_ssl\nwith the following configure:\n\n  ./configure --prefix=/local/opt/apache2 \\\n              --enable-usertrack=shared \\\n              --enable-so \\\n              --with-mpm=worker \\\n              --disable-imap \\\n              --enable-cgid \\\n              --enable-ssl \\                  # static\n              --with-ssl=/usr/local/ssl \\\n              --enable-dav=shared \\\n              --enable-dav-fs=shared\n\nThis builds and installs fine.  However, when I try to start using \n'apachectl startssl' I simply get the following:\n\n  Segmentation Fault\n  ./apachectl startssl: httpd could not be started\n  \nWhen I try a plain 'apachectl start' I get the following message in \nthe error_log:\n\n  [error] mod_ssl: Init: Failed to generate temporary 512 bit RSA private\nkey\n  \nI found this message in the mod_ssl FAQ which basically says you can fix it \nusing SSLRandomKey directives.  However, the default ssl.conf already has these \nlines:\n\n  SSLRandomSeed startup builtin\n  SSLRandomSeed connect builtin\n\nNote that Apache 1.3.x with mod_ssl 2.8.4 and OpenSSL 0.9.6b on both the \nSolaris 7 and 8 boxes works fine.", "id": 13414, "time": "2002-04-12T20:26:23Z", "creator": "allen.chen@digex.com", "creation_time": "2002-04-12T20:26:23Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "jwoolley@apache.org", "attachment_id": null, "text": "SHARED:  \n/local/opt/apache2/modules/mod_ssl.so: symbol X509_INFO_free: referenced  \nsymbol not found  \n  \nThis means that you've built Apache against a static OpenSSL (libssl.a/libcrypto.a as  \nopposed to .so).  That won't work currently, because OpenSSL gets linked against httpd  \nand not against mod_ssl.so so some needed symbols get thrown away by the linker.  Rebuild  \nwith a shared OpenSSL library and it should work fine.  \n  \nSTATIC:  \nI'm not sure if this segfault is related to the problem listed above or not.  If it's  \nnot, can you please provide us with a backtrace?  If you need help doing that, look at \nhttp://httpd.apache.org/dev/debugging.html \n \nThanks for using Apache!  ", "id": 13415, "time": "2002-04-12T20:41:03Z", "bug_id": 8034, "creation_time": "2002-04-12T20:41:03Z", "is_private": false}, {"count": 2, "attachment_id": null, "bug_id": 8034, "text": "A suggestion from Nigel Cole in re: the STATIC issue: \nMake *sure* that if you have mod_ssl built statically into the server that you \ndon't _also_ have an old mod_ssl.so lying around and an old LoadModule directive \nin your config file.  Having the same module loaded both shared and static is \nvery bad news. \n \nI'm going to assume this is what's going on and close this bug report... if you \nhave double-checked this and are still getting segfaults, feel free to reopen it. ", "id": 13782, "time": "2002-04-16T16:42:07Z", "creator": "jwoolley@apache.org", "creation_time": "2002-04-16T16:42:07Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "text": "Yes, it \"worksforme\" now!  I have one related suggestion, though.  Bring back a \nway to create certificates like you can with \"make certificate\" in Apache 1.3.x \nand mod_ssl.\n\nThanks, you guys rule.\n-Allen", "is_private": false, "id": 13786, "creator": "allen.chen@digex.com", "time": "2002-04-16T17:13:52Z", "bug_id": 8034, "creation_time": "2002-04-16T17:13:52Z", "attachment_id": null}, {"count": 4, "tags": [], "text": "*** Bug 8237 has been marked as a duplicate of this bug. ***", "is_private": false, "id": 13942, "creator": "jwoolley@apache.org", "time": "2002-04-18T05:03:11Z", "bug_id": 8034, "creation_time": "2002-04-18T05:03:11Z", "attachment_id": null}, {"count": 5, "tags": [], "text": "*** Bug 10586 has been marked as a duplicate of this bug. ***", "attachment_id": null, "id": 19170, "creator": "jwoolley@apache.org", "time": "2002-07-09T14:40:05Z", "bug_id": 8034, "creation_time": "2002-07-09T14:40:05Z", "is_private": false}]