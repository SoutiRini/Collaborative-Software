[{"count": 0, "tags": [], "bug_id": 28465, "text": "I try to use a jsp error page from a servlet to report an exception by first \nsetting the request attribute \"javax.servlet.error.exception\" to the exception \nobject and then forwarding to the jsp page.\n\nThis worked fine with Tomcat 4 but with Tomcat 5.0.19 the default error page is \ndisplayed instead. However my error page is displayed correctly if it commits \nthe response (is larger than the page buffer) or it removes the error attribute.\n\nSo It appears that Tomcat always calls my error page but after the call it \ntries to forward to the default error page if the error attribute exists.\n\nThe situation is the same if I use the \"javax.servlet.jsp.jspException\" \nattribute.", "id": 56008, "time": "2004-04-19T10:33:30Z", "creator": "pekka.lund@uta.fi", "creation_time": "2004-04-19T10:33:30Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "text": "Please use the container's error page mechanism, rather than try to hack up yours.", "id": 56020, "time": "2004-04-19T14:01:41Z", "bug_id": 28465, "creation_time": "2004-04-19T14:01:41Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 28465, "text": "Using error pages defined in web.xml <error-page> -element is not really an \noption for me. I need to use different error pages depending on the location of \nthe page that generated the exception. Basically I have a dispatcher that \nsearches for the correct error page from the parent directories of the page \nthat generated the exception.\n\nUse of the standard attribute (javax.servlet.error.exception) enables my error \npages to take advantage of the standard jsp features such as having the \nimplicit exception object defined in my error pages and the possibility to \nexplicitly select the error page to be used by defining the errorPage page \ndirective.\n\nInvoking jsp error pages from servlets, dispatchers and such by first setting \nthe standard attribute and then forwarding seems to be a common practise \nanyway. I have seen numerous examples where this has been done. For example the \njava pet store example (both version 1.3.2 from \nhttp://java.sun.com/developer/releases/petstore/ and version 1.4 that comes \nwith j2ee 1.4) contains a servlet called \ncom.sun.j2ee.blueprints.waf.controller.web.MainServlet which on error \nconditions sets the \"javax.servlet.jsp.jspException\" attribute and uses a \ndispatcher to forward to the error page it selects. To my understanding the pet \nstore example is supposed to provide best practice guidelines.\n\nFrom the petstore:\n\n    private void doProcess(HttpServletRequest request, HttpServletResponse \nresponse)\n                   throws IOException, ServletException {\n        // set the locale of the user to default if not set\n        if (request.getSession().getAttribute(WebKeys.LOCALE) == null) {\n            request.getSession().setAttribute(WebKeys.LOCALE, defaultLocale);\n        }\n        try {\n                 getRequestProcessor().processRequest(request);\n                 getScreenFlowManager().forwardToNextScreen(request,response);\n        } catch (Throwable ex) {\n            String className = ex.getClass().getName();\n            String nextScreen = getScreenFlowManager().getExceptionScreen(ex);\n            // put the exception in the request\n            request.setAttribute(\"javax.servlet.jsp.jspException\", ex);\n            if (nextScreen == null) {\n                // send to general error screen\n                ex.printStackTrace();\n                throw new ServletException(\"MainServlet: unknown exception: \" + \nclassName);\n            }\n            context.getRequestDispatcher(nextScreen).forward(request, response);\n      }\n", "id": 56066, "time": "2004-04-20T07:01:13Z", "creator": "pekka.lund@uta.fi", "creation_time": "2004-04-20T07:01:13Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 28465, "attachment_id": null, "id": 56079, "time": "2004-04-20T10:14:05Z", "creator": "remm@apache.org", "creation_time": "2004-04-20T10:14:05Z", "is_private": false, "text": "Well, I don't agree with that."}, {"count": 4, "tags": [], "bug_id": 28465, "attachment_id": null, "id": 56080, "time": "2004-04-20T10:24:45Z", "creator": "pekka.lund@uta.fi", "creation_time": "2004-04-20T10:24:45Z", "is_private": false, "text": "You don't agree with what? Do you mean that it's not common to set those \nattributes or that the pet store is not implemented correctly?"}, {"count": 5, "tags": [], "creator": "remm@apache.org", "text": "I don't see anything difficult to understand: I understand your use case, and I\nconsider it invalid.", "id": 56092, "time": "2004-04-20T13:30:12Z", "bug_id": 28465, "creation_time": "2004-04-20T13:30:12Z", "is_private": false, "attachment_id": null}]