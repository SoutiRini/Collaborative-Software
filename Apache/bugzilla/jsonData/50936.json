[{"count": 0, "tags": [], "creator": "ehetzner@gmail.com", "attachment_id": null, "id": 145034, "time": "2011-03-16T10:59:27Z", "bug_id": 50936, "creation_time": "2011-03-16T10:59:27Z", "is_private": false, "text": "When parsing the attached MS Word 8.0 file via Tika, I get the following exception:\n\n$ java -jar tika-app-1.0-SNAPSHOT.jar http://www.arb.ca.gov/msprog/smogcheck/july00/iiif.doc\nException in thread \"main\" org.apache.tika.exception.TikaException: Unexpected RuntimeException from org.apache.tika.parser.microsoft.OfficeParser@44aea710\n        at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:199)\n        at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:197)\n        at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:135)\n        at org.apache.tika.cli.TikaCLI$OutputType.process(TikaCLI.java:107)\n        at org.apache.tika.cli.TikaCLI.process(TikaCLI.java:302)\n        at org.apache.tika.cli.TikaCLI.main(TikaCLI.java:91)\nCaused by: java.lang.ArrayIndexOutOfBoundsException: 610125\n        at org.apache.poi.util.LittleEndian.getShort(LittleEndian.java:45)\n        at org.apache.poi.ddf.EscherRecord$EscherRecordHeader.readHeader(EscherRecord.java:250)\n        at org.apache.poi.ddf.DefaultEscherRecordFactory.createRecord(DefaultEscherRecordFactory.java:56)\n        at org.apache.poi.hwpf.model.PicturesTable.searchForPictures(PicturesTable.java:169)\n        at org.apache.poi.hwpf.model.PicturesTable.searchForPictures(PicturesTable.java:180)\n        at org.apache.poi.hwpf.model.PicturesTable.searchForPictures(PicturesTable.java:180)\n        at org.apache.poi.hwpf.model.PicturesTable.getAllPictures(PicturesTable.java:207)\n        at org.apache.tika.parser.microsoft.WordExtractor$PicturesSource.<init>(WordExtractor.java:430)\n        at org.apache.tika.parser.microsoft.WordExtractor$PicturesSource.<init>(WordExtractor.java:420)\n        at org.apache.tika.parser.microsoft.WordExtractor.parse(WordExtractor.java:75)\n        at org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:182)\n        at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:197)\n        ... 5 more"}, {"count": 1, "tags": [], "creator": "ehetzner@gmail.com", "attachment_id": 26777, "id": 145035, "time": "2011-03-16T11:01:09Z", "bug_id": 50936, "creation_time": "2011-03-16T11:01:09Z", "is_private": false, "text": "Created attachment 26777\nword file which causes error, as downloaded from http://www.arb.ca.gov/msprog/smogcheck/july00/iiif.doc"}, {"count": 2, "tags": [], "bug_id": 50936, "text": "The problem is not reproducible with latest build from trunk. I added a unit\ntest and included the attached document in our collection of test documents.\n\nYegor", "id": 147434, "attachment_id": null, "creator": "yegor@dinom.ru", "creation_time": "2011-06-24T08:26:46Z", "time": "2011-06-24T08:26:46Z", "is_private": false}, {"count": 3, "tags": [], "creator": "pablo.queixalos@polyspot.com", "text": "Issue reopened, tested with r1175705 from trunk (through tika) : \n\njava.lang.ArrayIndexOutOfBoundsException: 70185\nat org.apache.poi.util.LittleEndian.getShort(LittleEndian.java:45)\nat org.apache.poi.ddf.DefaultEscherRecordFactory.createRecord(DefaultEscherRecordFactory.java:60)\nat org.apache.poi.hwpf.model.PicturesTable.searchForPictures(PicturesTable.java:182)\nat org.apache.poi.hwpf.model.PicturesTable.searchForPictures(PicturesTable.java:193)\nat org.apache.poi.hwpf.model.PicturesTable.searchForPictures(PicturesTable.java:193)\nat org.apache.poi.hwpf.model.PicturesTable.getAllPictures(PicturesTable.java:220)\nat org.apache.tika.parser.microsoft.WordExtractor$PicturesSource.<init>(WordExtractor.java:498)\nat org.apache.tika.parser.microsoft.WordExtractor$PicturesSource.<init>(WordExtractor.java:488)\nat org.apache.tika.parser.microsoft.WordExtractor.parse(WordExtractor.java:81)\nat org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:200)", "id": 149751, "time": "2011-09-26T09:42:01Z", "bug_id": 50936, "creation_time": "2011-09-26T09:42:01Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 50936, "text": "Created attachment 27594\nThrowing ArrayIndexOutOfBoundsException", "id": 149753, "attachment_id": 27594, "creator": "pablo.queixalos@polyspot.com", "creation_time": "2011-09-26T09:46:34Z", "time": "2011-09-26T09:46:34Z", "is_private": false}, {"count": 5, "tags": [], "creator": "pablo.queixalos@polyspot.com", "attachment_id": 27595, "id": 149754, "time": "2011-09-26T09:47:19Z", "bug_id": 50936, "creation_time": "2011-09-26T09:47:19Z", "is_private": false, "text": "Created attachment 27595\nAnother one Throwing ArrayIndexOutOfBoundsException"}, {"count": 6, "tags": [], "creator": "vlsergey@gmail.com", "attachment_id": null, "id": 151039, "time": "2011-10-30T00:17:36Z", "bug_id": 50936, "creation_time": "2011-10-30T00:17:36Z", "is_private": false, "text": "(In reply to comment #5)\n> Created attachment 27595 [details]\n> Another one Throwing ArrayIndexOutOfBoundsException\n\nThis one failing validation:\n\n<BFFValidation path=\"Bug50936_3.doc\" datetime=\"10/30/11 03:16:10\" result=\"FAILED\">\n  <ParseStack>\n    <!-- skipped -->\n    <Type docName=\"MS-DOC\" sectionTitle=\"Section Properties\" msdnLink=\"http://msdn.microsoft.com/en-us/library/46c3ec54-53ff-4c0a-b0d6-07ad15d2546e\" streamName=\"WordDocument\" streamOffset=\"166413\" hexStreamOffset=\"0x28a0d\"/>\n\n  <LastData><![CDATA[\n3A -- -- -- -- -- -- --  -- -- -- -- -- -- -- --  :\n]]></LastData>\n</BFFValidation>"}, {"count": 7, "tags": [], "creator": "vlsergey@gmail.com", "text": "\n\n*** This bug has been marked as a duplicate of bug 47958 ***", "id": 151040, "time": "2011-10-30T00:31:42Z", "bug_id": 50936, "creation_time": "2011-10-30T00:31:42Z", "is_private": false, "attachment_id": null}]