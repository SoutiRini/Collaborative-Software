[{"count": 0, "tags": [], "creator": "Petr.Udalau@exigenservices.com", "is_private": false, "text": "Created attachment 24614\nFix.\n\nThere is simple example when we set wrong formula and get FormulaParseException.\n\npublic class Test {\n    public static void main(String[] args) throws Exception{\n        HSSFWorkbook wb = new HSSFWorkbook();\n        Sheet sheet = wb.createSheet();\n        Row row = sheet.createRow(0);\n        Cell cell = row.createCell(0);\n        cell.setCellFormula(\"Sasd(1)\");\n    }\n}\n\nBut we cant catch it because its visibility is package. We can't catch this exception outside the POI internal.\n\nVisibility is raised in patch.", "id": 132319, "time": "2009-11-25T07:55:12Z", "bug_id": 48284, "creation_time": "2009-11-25T07:55:12Z", "attachment_id": 24614}, {"count": 1, "tags": [], "bug_id": 48284, "text": "There's a comment on the exception:\n\n\t// This class was given package scope until it would become clear that it is useful to\n\t// general client code.\n\nProbably one for Josh to comment on?", "id": 132323, "time": "2009-11-25T09:19:59Z", "creator": "apache@gagravarr.org", "creation_time": "2009-11-25T09:19:59Z", "is_private": false, "attachment_id": null}, {"count": 2, "attachment_id": 24621, "bug_id": 48284, "is_private": false, "id": 132341, "time": "2009-11-25T17:21:12Z", "creator": "josh@apache.org", "creation_time": "2009-11-25T17:21:12Z", "tags": [], "text": "Created attachment 24621\nRevised patch making FormulaParseException a public top-level type\n\nI originally added this exception quite some time back in the patch of bug 44504.  The purpose of the exception is to tell the difference between internal POI errors and parsing errors caused by a bad user-supplied formula.  I deliberately restricted visibility for two reasons - firstly because I didn't want to augment POI's public API and secondly because I wasn't confident that the formula parser did a good job of recognising formula errors yet.\n\nHaving said that, I think the formula parser has improved greatly since then (almost thirty bugs fixed and more than a dozen additional enhancements) so it is probably more reliable in throwing FormulaParseException correctly now.\n\nAs far as the API is concerned, I'd like to make this class a top level class perhaps:\norg.apache.poi.ss.formula.FormulaParseException\nIt should be OK to make this change since no-one has been able to specifically catch this exception so far.\n\nI see in your patch you left the the exception unchecked (which I agree with).  I'm also considering declaring this exception on Cell.setCellFormula() for clarity.  It's slightly unusual to have declared unchecked exceptions but that seems like the best approach here.\n\n\nThe attached patch file includes the changes described here and some related clean-up.  Let me know if you think it needs further changes.  Otherwise I'll apply it over the weekend."}, {"count": 3, "attachment_id": null, "bug_id": 48284, "text": "Your patch completely resolves the problem.\n\nThanks.", "id": 132349, "time": "2009-11-26T01:44:03Z", "creator": "Petr.Udalau@exigenservices.com", "creation_time": "2009-11-26T01:44:03Z", "tags": [], "is_private": false}, {"count": 4, "attachment_id": null, "bug_id": 48284, "is_private": false, "id": 132490, "time": "2009-11-30T16:17:27Z", "creator": "josh@apache.org", "creation_time": "2009-11-30T16:17:27Z", "tags": [], "text": "Applied in svn r885007."}]