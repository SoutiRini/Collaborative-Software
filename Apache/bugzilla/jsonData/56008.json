[{"count": 0, "tags": [], "bug_id": 56008, "attachment_id": null, "text": "We used the Apache 2.4.2 and since availablity 2.4.6 in our global Apache Setup.\nIt occured three times now (at different config sections) that the check with IfDefine was not evaluated correctly which resulted in big errors.\n\nHere is a simple example to show how drastic the implications can be: Let us assume we have an apache httpd 2.4.6 in the USA and one in the UK.\nThe daemons are started with the -D flag as follows:\nUSA: -DUSA\nUK: -DUK\n\nBoth have this config:\n\n__________________________\n\nDefine ip_of_USA_location 10.30.0.2\nDefine ip_of_UK_location 10.40.0.2\n<VirtualHost ${ip_of_XXX_location}:80>\n# some configs\n# ...\nRewriteEngine On\n\n<IfDefine USA>\nRewriteRule ^/(.*)$ http://${ip_of_UK_location}/getSomeStuffOnlyAvailableInUk/$1 [P]\n</IfDefine>\n<IfDefine UK>\nRewriteRule ^/(.*)$ http://${ip_of_USA_location}/getSomeStuffOnlyAvailableInUsa/$1 [P]\n</IfDefine>\n\n# some configs\n# ...\n</VirtualHost>\n\n___________________________\n\nNow after several days/reloads/MaxConnectionsPerChild the UK-httpd \"thinks\" that USA is defined.\nThat will result in a loop because UK-httpd enters the vhost with UK-IP and proxies to the vhost with UK-IP and so on and endless on.\n\nAn other example would be some BalancerMembers only available in that zone. If both are defined the following would produce serious trouble:\n<IfDefine USA>\nBalancerMember http://10.30.0.70 ...\nBalancerMember http://10.30.0.71 ...\n</IfDefine>\n<IfDefine UK>\nBalancerMember http://10.40.0.70 ...\nBalancerMember http://10.40.0.71 ...\n</IfDefine>\n\nI perhaps should also mention that we use mpm_event.\nWhen the daemon is startet or restartet there works everything as expected. In most of the time when the daemon is reloaded/forks new childs there is also no problem.\nWe hit that bug now three times in a year and because of my configuration the only thing possible is that the IfDefine sections are not working properly.\nI know it is really hard to reproduce, because it works thousend times but in one not, but the problem is there. Heisenbug? :P", "id": 172381, "time": "2014-01-14T21:49:33Z", "creator": "stgrein@gmail.com", "creation_time": "2014-01-14T21:49:33Z", "is_private": false}, {"count": 1, "tags": [], "creator": "a.abfalterer@gmail.com", "is_private": false, "text": "Hi Stefan,\n\nI had the same problem and I've found out that there is a bug in the apache core\n\nSee my report at https://issues.apache.org/bugzilla/show_bug.cgi?id=57328\n\nI hope the patch will be incorporated asap...\n\nRegards, Armin", "id": 179620, "time": "2014-12-08T11:38:51Z", "bug_id": 56008, "creation_time": "2014-12-08T11:38:51Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 56008, "text": "A fix was commited in trunk (r1643825) for Bug 57328.\nMarking this report as duplicated, please re-open if r1643825 does not fix this \nissue.\n\n*** This bug has been marked as a duplicate of bug 57328 ***", "id": 179625, "time": "2014-12-08T14:39:06Z", "creator": "ylavic.dev@gmail.com", "creation_time": "2014-12-08T14:39:06Z", "is_private": false, "attachment_id": null}]