[{"count": 0, "tags": [], "creator": "bugs@oneofus.org", "is_private": false, "id": 113540, "attachment_id": null, "bug_id": 44376, "creation_time": "2008-02-07T10:36:12Z", "time": "2008-02-07T10:36:12Z", "text": "I get the following error:\n\n[Wed Feb 06 15:01:04 2008] [error] (9)Bad file descriptor: process_socket: apr_pollset_add failure\n\non several occasions when running a load test. It appears a few times. I think it also leaves a slot in the \nscoreboard in 'L' state, though I have not been able to ensure causality for this, just correlation.\n\nThe server is RHEL5.1 x64. Running 2.2.6. event MPM. I'll attach /server-info details."}, {"count": 1, "tags": [], "bug_id": 44376, "attachment_id": 21495, "id": 113541, "time": "2008-02-07T10:40:38Z", "creator": "bugs@oneofus.org", "creation_time": "2008-02-07T10:40:38Z", "is_private": false, "text": "Created attachment 21495\nserver-info"}, {"count": 2, "tags": [], "creator": "bugs@oneofus.org", "attachment_id": 21496, "id": 113542, "time": "2008-02-07T10:41:16Z", "bug_id": 44376, "creation_time": "2008-02-07T10:41:16Z", "is_private": false, "text": "Created attachment 21496\nserver-info?config"}, {"count": 3, "tags": [], "bug_id": 44376, "attachment_id": null, "id": 113543, "time": "2008-02-07T10:41:53Z", "creator": "bugs@oneofus.org", "creation_time": "2008-02-07T10:41:53Z", "is_private": false, "text": "mod_query is a custom module."}, {"count": 4, "tags": [], "text": "I am seeing the same issue come up when doing some additional load testing. This time, though, we are not using any custom modules but a fairly stock system (using mod_proxy_http to connect to a Tomcat instance).\n\nWith the test over for several hours, the scoreboard looks in part like:\n\n101 requests currently being processed, 99 idle workers\n................................................................\n................................................................\n................................................................\n........LLLLLLLLLLLLLLLL.LLLLLLLLLLLLLLLLLLLLLLLL.LLLLLLLLLLLLLL\nLL.LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL.LLLLLL..LLLL.L.L.L\nLL.LLLL..LLLLLL..L.LLL..LL.L..L.L..LLLL.L...LLLLLLLLL..LLL..L.LL\nLLLLL.L.LLLLL..L................................................\n................................................................\n................................................................\n........................LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL\nLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL____\n___________________________________________W____________________\n________________________________................................\n................................................................\n....LLL.LL.LLLLLLLL.L.L.LLLLLLLLLLLLL..LLL.L.LLLL.L.LLL..LL.LL..\nLLLLLL.LLGLLLLLLLLLLL.LLLLLL.LLLLL.LL.LLLLLLLLLLLLLLLLLLLLLLL.LL\nLLLLLLLLLLLLL..LLLLLLLLLLLLLLLLLL..LLLLLLLLLLLLLL.LLLLLLLLLLLLLL\nLLLLLLLLLL......................................................\n", "attachment_id": null, "bug_id": 44376, "id": 114712, "time": "2008-03-18T09:08:47Z", "creator": "bugs@oneofus.org", "creation_time": "2008-03-18T09:08:47Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 44376, "text": "Please provide a backtrace of process that has several workers hanging in the L state.", "id": 114716, "time": "2008-03-18T09:50:25Z", "creator": "rpluem@apache.org", "creation_time": "2008-03-18T09:50:25Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 44376, "attachment_id": null, "id": 114717, "time": "2008-03-18T10:05:43Z", "creator": "bugs@oneofus.org", "creation_time": "2008-03-18T10:05:43Z", "is_private": false, "text": "How would I go about this? It is on RHEL5.1x64.\n\n(In reply to comment #5)\n> Please provide a backtrace of process that has several workers hanging in the L\n> state.\n> \n\n"}, {"count": 7, "tags": [], "bug_id": 44376, "attachment_id": null, "id": 114724, "time": "2008-03-18T13:13:10Z", "creator": "rpluem@apache.org", "creation_time": "2008-03-18T13:13:10Z", "is_private": false, "text": "(In reply to comment #6)\n> How would I go about this? It is on RHEL5.1x64.\n\nhttp://httpd.apache.org/dev/debugging.html\n\n"}, {"count": 8, "tags": [], "bug_id": 44376, "attachment_id": 21688, "id": 114753, "time": "2008-03-19T08:59:55Z", "creator": "bugs@oneofus.org", "creation_time": "2008-03-19T08:59:55Z", "is_private": false, "text": "Created attachment 21688\npstack output"}, {"count": 9, "tags": [], "bug_id": 44376, "is_private": false, "text": "Attached pstack output.", "id": 114754, "time": "2008-03-19T09:00:17Z", "creator": "bugs@oneofus.org", "creation_time": "2008-03-19T09:00:17Z", "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 44376, "text": "(In reply to comment #9)\n> Attached pstack output.\n> \n\nThanks for this. Sorry I should have made it more clear that I liked to see a gdb backtrace as it delivers more information. As far as I can tell from the pstack you did not catch a process that is affected by your problem.", "id": 114773, "attachment_id": null, "creator": "rpluem@apache.org", "creation_time": "2008-03-19T13:33:23Z", "time": "2008-03-19T13:33:23Z", "is_private": false}, {"count": 11, "tags": [], "bug_id": 44376, "attachment_id": null, "id": 114776, "time": "2008-03-19T14:19:33Z", "creator": "bugs@oneofus.org", "creation_time": "2008-03-19T14:19:33Z", "is_private": false, "text": "The pstack output is for the correct process according to /server-status. The\nprocess in question is 22267. Below is the gdb output.\n\n(gdb) where\n#0  0x00002aaaab1215a5 in pthread_join () from /lib64/libpthread.so.0\n#1  0x00002aaaaaf10b85 in apr_thread_join (retval=0x7fff2f923f34, \n    thd=0xbe8d7d0) at threadproc/unix/thread.c:218\n#2  0x0000000000444632 in join_workers (listener=<value optimized out>, \n    threads=0xbf20840) at event.c:1347\n#3  0x000000000044556d in child_main (child_num_arg=<value optimized out>)\n    at event.c:1524\n#4  0x0000000000445645 in make_child (s=0xbdf57b0, slot=4) at event.c:1578\n#5  0x0000000000446107 in ap_mpm_run (_pconf=<value optimized out>, \n    plog=<value optimized out>, s=<value optimized out>) at event.c:1765\n#6  0x0000000000421588 in main (argc=3, argv=0x7fff2f9242b8) at main.c:730\n\n"}, {"count": 12, "tags": [], "bug_id": 44376, "attachment_id": null, "id": 114779, "time": "2008-03-19T14:56:05Z", "creator": "rpluem@apache.org", "creation_time": "2008-03-19T14:56:05Z", "is_private": false, "text": "(In reply to comment #11)\n> The pstack output is for the correct process according to /server-status. The\n> process in question is 22267. Below is the gdb output.\n> \n> (gdb) where\n> #0  0x00002aaaab1215a5 in pthread_join () from /lib64/libpthread.so.0\n> #1  0x00002aaaaaf10b85 in apr_thread_join (retval=0x7fff2f923f34, \n>     thd=0xbe8d7d0) at threadproc/unix/thread.c:218\n> #2  0x0000000000444632 in join_workers (listener=<value optimized out>, \n>     threads=0xbf20840) at event.c:1347\n> #3  0x000000000044556d in child_main (child_num_arg=<value optimized out>)\n>     at event.c:1524\n> #4  0x0000000000445645 in make_child (s=0xbdf57b0, slot=4) at event.c:1578\n> #5  0x0000000000446107 in ap_mpm_run (_pconf=<value optimized out>, \n>     plog=<value optimized out>, s=<value optimized out>) at event.c:1765\n> #6  0x0000000000421588 in main (argc=3, argv=0x7fff2f9242b8) at main.c:730\n> \n\nSorry, but this does not help either :-). Please do a\n\nthread apply all bt full\n\ninstead of the\n\nwhere\n"}, {"count": 13, "tags": [], "bug_id": 44376, "attachment_id": 21694, "id": 114786, "time": "2008-03-19T15:53:34Z", "creator": "bugs@oneofus.org", "creation_time": "2008-03-19T15:53:34Z", "is_private": false, "text": "Created attachment 21694\ngdb output"}, {"count": 14, "tags": [], "bug_id": 44376, "text": "gdb output as requested.", "id": 114787, "time": "2008-03-19T15:53:57Z", "creator": "bugs@oneofus.org", "creation_time": "2008-03-19T15:53:57Z", "is_private": false, "attachment_id": null}, {"count": 15, "tags": [], "bug_id": 44376, "text": "This seems to be the bug fixed by r575282 (http://svn.apache.org/viewvc?view=rev&revision=575282). Please either apply this patch to your 2.2.6 or use 2.2.8 which contains this patch and let me know if this fixes your problem.", "id": 114803, "time": "2008-03-20T00:37:18Z", "creator": "rpluem@apache.org", "creation_time": "2008-03-20T00:37:18Z", "is_private": false, "attachment_id": null}, {"count": 16, "tags": [], "bug_id": 44376, "attachment_id": null, "id": 123540, "time": "2008-12-26T12:28:28Z", "creator": "nick@webthing.com", "creation_time": "2008-12-26T12:28:28Z", "is_private": false, "text": "Assuming fixed as per comment 15."}]