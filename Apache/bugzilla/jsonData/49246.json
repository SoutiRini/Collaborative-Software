[{"count": 0, "tags": [], "bug_id": 49246, "is_private": false, "text": "When configured with a virtual host, caching and a non-empty CacheIgnoreURLSessionIdentifiers parameter httpd segfaults on requests with no path. Configuration:\n\nNameVirtualHost *:80\n<VirtualHost *:80>\n  ServerName www.example.com\n  CacheEnable disk /\n  CacheRoot /tmp/cache-root\n  CacheDefaultExpire 86400\n  CacheIgnoreURLSessionIdentifiers cachebuster\n</VirtualHost>\n\nTest:\n\nhost:~ tail -0f logs/error_log &\n[1] 7637\nhost:~ (echo \"GET http://www.example.com HTTP/1.0\"; echo) | nc localhost 80\n[Tue May 04 14:12:47 2010] [notice] child pid 7617 exit signal Segmentation fault (11)\n\nGDB:\n\n(gdb) b ap_process_request\nBreakpoint 1 at 0x44d4ac: file http_request.c, line 276.\n(gdb) run -X -d /usr/local/apache2\nStarting program: /usr/local/apache2/bin/httpd -X -d /usr/local/apache2\n[Thread debugging using libthread_db enabled]\n[New Thread 0x2b6659641860 (LWP 12669)]\n\nBreakpoint 1, ap_process_request (r=0xd694558) at http_request.c:276\n276\t    if (ap_extended_status)\n(gdb) n\n278\t    access_status = ap_run_quick_handler(r, 0);  /* Not a look-up request */\n(gdb) n\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x0000003e06678fe0 in strchr () from /lib64/libc.so.6\n(gdb) bt\n#0  0x0000003e06678fe0 in strchr () from /lib64/libc.so.6\n#1  0x0000003e06679ade in strrchr () from /lib64/libc.so.6\n#2  0x00002b665b066f7f in cache_generate_key_default (r=0xd694558, p=0xd6944e8, key=0x7fff521544d8) at cache_storage.c:498\n#3  0x00002b665b0666c8 in cache_select (r=0xd694558) at cache_storage.c:192\n#4  0x00002b665b0638ae in cache_url_handler (r=0xd694558, lookup=0) at mod_cache.c:112\n#5  0x000000000043ba0e in ap_run_quick_handler (r=0xd694558, lookup=0) at config.c:160\n#6  0x000000000044d4e0 in ap_process_request (r=0xd694558) at http_request.c:278\n#7  0x000000000044a049 in ap_process_http_connection (c=0xd68e5b8) at http_core.c:190\n#8  0x000000000044500e in ap_run_process_connection (c=0xd68e5b8) at connection.c:43\n#9  0x0000000000445448 in ap_process_connection (c=0xd68e5b8, csd=0xd68e3c8) at connection.c:178\n#10 0x0000000000454089 in child_main (child_num_arg=0) at prefork.c:662\n#11 0x000000000045416c in make_child (s=0xd5b3dd8, slot=0) at prefork.c:702\n#12 0x0000000000454701 in ap_mpm_run (_pconf=0xd5ac6c8, plog=0xd5de858, s=0xd5b3dd8) at prefork.c:978\n#13 0x00000000004220ef in main (argc=4, argv=0x7fff52154a78) at main.c:740", "id": 136625, "time": "2010-05-04T09:19:57Z", "creator": "mark@markdrayton.info", "creation_time": "2010-05-04T09:19:57Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 49246, "attachment_id": null, "id": 140804, "time": "2010-10-18T18:54:58Z", "creator": "minfrin@sharp.fm", "creation_time": "2010-10-18T18:54:58Z", "is_private": false, "text": "Fixed in httpd v2.2.16."}]