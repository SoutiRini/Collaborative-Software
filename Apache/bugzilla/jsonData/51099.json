[{"count": 0, "attachment_id": null, "creator": "markt@apache.org", "text": "As reported by fhanik on the dev list:\n\n2. com.sun.security.jgss.krb5.accept is not configurable\nWhile the authenticator has the attribute loginConfigName, there seems to be a place in the code where it omits this entry.\nrenaming this entry in jaas.conf and setting the loginConfigName will fail to validate a ticket\n\nThe problem code is here:\n\n            gssContext = manager.createContext(manager.createCredential(null,\n                    GSSCredential.DEFAULT_LIFETIME,\n                    new Oid(\"1.3.6.1.5.5.2\"),\n                    GSSCredential.ACCEPT_ONLY));\n\nshould look like\n            final GSSManager manager = GSSManager.getInstance();\n            final PrivilegedExceptionAction<GSSCredential> action =\n                new PrivilegedExceptionAction<GSSCredential>() {\n                    public GSSCredential run() throws GSSException {\n                        return manager.createCredential(null,\n                                GSSCredential.DEFAULT_LIFETIME,\n                                new Oid(\"1.3.6.1.5.5.2\"),\n                                GSSCredential.ACCEPT_ONLY);\n                    }\n                };\n            gssContext = manager.createContext(Subject.doAs(lc.getSubject(), action));||\n\n\nbest\nFilip", "id": 145924, "time": "2011-04-21T05:11:31Z", "bug_id": 51099, "creation_time": "2011-04-21T05:11:31Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 51099, "text": "Patch was spot on. Cheers Filip.\n\nApplied to 7.0.x. Will be in 7.0.13 onwards.", "id": 146129, "time": "2011-05-04T21:47:16Z", "creator": "markt@apache.org", "creation_time": "2011-05-04T21:47:16Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 51099, "attachment_id": null, "text": "I think it looks very good and I'm very interested because I use a spnego filter at this moment, but I think the JAAS login and the creation of the gssmanager should be in a constructor or in this case possibly in the initInternal. This the JAAS login of the server and should be done only once. At least I think so, maybe I'm wrong, it's a complex subject.\n\nI'm  talking about this part:\n\n            try {\n                lc = new LoginContext(getLoginConfigName());\n                lc.login();\n            } catch (LoginException e) {\n                log.error(sm.getString(\"spnegoAuthenticator.serviceLoginFail\"),\n                        e);\n                response.sendError(\n                        HttpServletResponse.SC_INTERNAL_SERVER_ERROR);\n                return false;\n            }\n            // Assume the GSSContext is stateless\n            // TODO: Confirm this assumption\n            final GSSManager manager = GSSManager.getInstance();\n\nMet vriendelijke groet,\n\nGerard", "id": 146144, "time": "2011-05-05T17:51:54Z", "creator": "gerard-borst@hotmail.com", "creation_time": "2011-05-05T17:51:54Z", "is_private": false}, {"count": 3, "attachment_id": null, "creator": "markt@apache.org", "text": "That is a separate issue that does not belong as part of this issue. To be perfectly honest, reports along the lines of \"this might be a bug, I'm not sure\" are just going to get closed as invalid.", "id": 146145, "time": "2011-05-05T18:48:30Z", "bug_id": 51099, "creation_time": "2011-05-05T18:48:30Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "creator": "gerard-borst@hotmail.com", "is_private": false, "id": 146160, "attachment_id": null, "bug_id": 51099, "creation_time": "2011-05-06T09:39:54Z", "time": "2011-05-06T09:39:54Z", "text": "Just trying to help."}]