[{"count": 0, "attachment_id": null, "bug_id": 50801, "is_private": false, "id": 144369, "time": "2011-02-16T22:47:14Z", "creator": "anthony@whitford.com", "creation_time": "2011-02-16T22:47:14Z", "tags": [], "text": "The dependency tree for poi-ooxml-schemas looks like this:\n\norg.apache.poi:poi-ooxml-schemas:jar:3.7:compile\n+- org.apache.xmlbeans:xmlbeans:jar:2.3.0:compile\n|  \\- stax:stax-api:jar:1.0.1:compile\n\\- org.apache.geronimo.specs:geronimo-stax-api_1.0_spec:jar:1.0:compile\n\nIt would seem that geronimo's stax api was added as part of Bug 46758:\n  https://issues.apache.org/bugzilla/show_bug.cgi?id=46758\n\nThe problem is that the stax-api dependency is essentially duplicated because xmlbeans uses stax:stax-api, while poi is using org.apache.geronimo.specs:geronimo-stax-api_1.0_spec.  (If they used the same groupId/artifactId, then there would not be duplication as Maven would recognize these artifacts as being logically the same.)\n\nIf you must keep with geronimo's stax-api, then I suggest excluding stax:stax-api.\n\nBTW...  com.sun.xml.bind:jaxb-impl references javax.xml.stream:stax-api:jar:1.0:compile -- so this jar has 3 aliases."}, {"count": 1, "attachment_id": null, "bug_id": 50801, "is_private": false, "id": 144405, "time": "2011-02-18T10:35:32Z", "creator": "apache@gagravarr.org", "creation_time": "2011-02-18T10:35:32Z", "tags": [], "text": "I think we do need to keep our own stax api dependency, as it is required for some things. We want to use the geronimo one too, for licensing reasons\n\nI'd suggest therefore that we exclude the other stax api pulled in via xmlbeans. Any chance you (or another maven guru) could work out the appropriate lines to add into the pom to do that?"}, {"count": 2, "tags": [], "text": "Sure.  From:  http://svn.apache.org/repos/asf/poi/trunk/maven/poi-ooxml-schemas.pom\n\nThe dependency should be:\n\n  <dependencies>\n    <dependency>\n      <groupId>org.apache.xmlbeans</groupId>\n      <artifactId>xmlbeans</artifactId>\n      <version>2.3.0</version>\n      <!-- Excluding XMLBean's STAX because we want to use Geronimo's -->\n      <exclusions>\n        <exclusion>\n          <groupId>stax</groupId>\n          <artifactId>stax-api</artifactId>\n        </exclusion>\n      </exclusions>\n    </dependency>\n    <dependency>\n      <groupId>org.apache.geronimo.specs</groupId>\n      <artifactId>geronimo-stax-api_1.0_spec</artifactId>\n      <version>1.0</version>\n    </dependency>\n  </dependencies>\n\nAdding the <exclusions> to the XMLBeans dependency would do the trick.  (Might also be nice to upgrade XMLBeans, but I'm not sure if that needs to be a separate request.)", "attachment_id": null, "id": 144432, "creation_time": "2011-02-19T11:23:10Z", "time": "2011-02-19T11:23:10Z", "creator": "anthony@whitford.com", "bug_id": 50801, "is_private": false}, {"count": 3, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "id": 144446, "time": "2011-02-21T03:10:42Z", "bug_id": 50801, "creation_time": "2011-02-21T03:10:42Z", "is_private": false, "text": "POI should run fine with stax:stax-api. Other Apache projects use this dependency I don't see why POI shouldn't. \n\nWe used to depend on javax.xml.bind.jsr173_api and had to switch to geronimo's because of that licensing issue. stax:stax-api is ALv2 (see http://repo2.maven.org/maven2/stax/stax-api/1.0.1/stax-api-1.0.1.pom) and is fine from the licensing point of view. \n\nI checked locally and POI builds OK against stax:stax-api, both under JDK 1.5 and JDK 1.6, so I'm for abandoning geronimo and using stax-api.\n\nPerhaps, to be on the safe side, we can split the fix into two parts:\n\n (a) The short-term fix is to exclude stax-api from poi-ooxml-schemas.pom, as suggested above. This is definitely safe and we can push this fix in 3.8-beta1 (expected in early March)\n (b) The long-term fix is to abandon org.apache.geronimo.specs:geronimo-stax-api_1.0_spec and to use stax:stax-api. \n\nBTW, commons-logging:jar:1.1 has a weird dependency chain. What avalon-framework and servlet-api are doing here? \n\n$ mvn dependency:tree\n[INFO] Scanning for projects...\n[INFO] Searching repository for plugin with prefix: 'dependency'.\n[INFO] ------------------------------------------------------------------------\n[INFO] Building Maven test project\n[INFO]    task-segment: [dependency:tree]\n[INFO] ------------------------------------------------------------------------\n[INFO] [dependency:tree {execution: default-cli}]\n[INFO] org.apache.poi.maven:maven-test:jar:1.0-beta\n[INFO] +- junit:junit:jar:3.8.1:test\n[INFO] \\- org.apache.poi:poi-ooxml:jar:3.6:compile\n[INFO]    +- org.apache.poi:poi:jar:3.6:compile\n[INFO]    |  +- commons-logging:commons-logging:jar:1.1:runtime\n[INFO]    |  |  +- logkit:logkit:jar:1.0.1:runtime\n[INFO]    |  |  +- avalon-framework:avalon-framework:jar:4.1.3:runtime\n[INFO]    |  |  \\- javax.servlet:servlet-api:jar:2.3:runtime\n[INFO]    |  \\- log4j:log4j:jar:1.2.13:runtime\n[INFO]    +- org.apache.poi:poi-ooxml-schemas:jar:3.7-beta4:compile\n[INFO]    |  +- org.apache.xmlbeans:xmlbeans:jar:2.3.0:compile\n[INFO]    |  |  \\- stax:stax-api:jar:1.0.1:compile\n[INFO]    |  \\- org.apache.geronimo.specs:geronimo-stax-api_1.0_spec:jar:1.0:compile\n[INFO]    \\- dom4j:dom4j:jar:1.6.1:compile\n[INFO]       \\- xml-apis:xml-apis:jar:1.0.b2:compile\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD SUCCESSFUL\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time: 9 seconds\n[INFO] Finished at: Mon Feb 21 11:05:52 MSK 2011\n[INFO] Final Memory: 10M/24M\n[INFO] ------------------------------------------------------------------------\n\n\nYegor"}, {"count": 4, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 144451, "time": "2011-02-21T06:43:49Z", "bug_id": 50801, "creation_time": "2011-02-21T06:43:49Z", "is_private": false, "text": "The commons logging thing is a \"this is what you need to begin using\" vs \"this is what you need to do everything\" thing. IIRC, it has a few methods in there to work well with some servlet stuff, but to use that you end up pulling in avalon...\n\nOne fix is to add this to the commons logging dependency line:\n      <exclusions>\n\t\t<exclusion>\n\t\t\t<groupId>avalon-framework</groupId>\n\t\t\t<artifactId>avalon-framework</artifactId>\n\t\t</exclusion>\n\t\t<exclusion>\n\t\t\t<groupId>javax.servlet</groupId>\n\t\t\t<artifactId>servlet-api</artifactId>\n\t\t</exclusion>\n\t</exclusions>\n\nThe other is to move to commons-logging 1.1.1, which apparently correctly marked those ones as being optional rather than required (see https://issues.apache.org/jira/browse/LOGGING-113). I'd say probably this is the right fix, is someone able to verify that?"}, {"count": 5, "tags": [], "text": "I went ahead and removed geronimo's stax api from poi-ooxml-schemas. The dependency tree is now as follows:\n\n+- org.apache.poi:poi-ooxml-schemas:jar:3.8-beta1:compile\n|  \\- org.apache.xmlbeans:xmlbeans:jar:2.3.0:compile\n|     \\- stax:stax-api:jar:1.0.1:compile\n\nThe fix applied in r1073683\n\nYegor", "attachment_id": null, "id": 144499, "creator": "yegor@dinom.ru", "time": "2011-02-23T05:46:58Z", "bug_id": 50801, "creation_time": "2011-02-23T05:46:58Z", "is_private": false}]