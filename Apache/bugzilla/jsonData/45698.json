[{"count": 0, "tags": [], "bug_id": 45698, "attachment_id": null, "id": 120154, "time": "2008-08-27T19:17:30Z", "creator": "josh@apache.org", "creation_time": "2008-08-27T19:17:30Z", "is_private": false, "text": "This bugzilla was created as a follow-on from:\nhttp://www.nabble.com/Error-opening-a-Excel-File-tp19083161p19162369.html\n\nThe attached xls file has several EXTERNSHEET records present where single one should have been written.  POI throws an exception when attempting to read the file:\n\nException in thread \"main\" org.apache.poi.hssf.record.RecordFormatException: Error reading bytes\n    at org.apache.poi.hssf.record.RecordInputStream.nextRecord(RecordInputStream.java:115)\n    at org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:123)\n    at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:246)\n    at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:169)\n    at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:151)\n... \nExcel (2007) opens the file without obvious error.\nWhen the file is re-saved by Excel, POI read it without throwing an exception."}, {"count": 1, "tags": [], "text": "Created attachment 22488\nfrom http://www.nabble.com/file/p19162369/CRE_CODIFICATION.xls", "attachment_id": 22488, "bug_id": 45698, "id": 120155, "time": "2008-08-27T19:25:34Z", "creator": "josh@apache.org", "creation_time": "2008-08-27T19:25:34Z", "is_private": false}, {"count": 2, "tags": [], "creator": "josh@apache.org", "attachment_id": null, "text": "Fixed in svn r689704.\n\nIt looks like whatever application has written this sample file has written out multiple ExternSheetRecords instead of multiple RefSubRecords within a single ExternSheetRecord.  When this unusual condition is detected, POI will now combine the records into one (which is hopefully the right thing to do). \n\nJunit added to make sure the observed RecordFormatException has been averted.\n\nHowever, there are more problems concerning this file.  Bug 45699 has been opened to manage those.\n\n\n", "id": 120157, "time": "2008-08-27T20:11:45Z", "bug_id": 45698, "creation_time": "2008-08-27T20:11:45Z", "is_private": false}]