[{"count": 0, "tags": [], "bug_id": 18444, "attachment_id": null, "id": 34012, "time": "2003-03-28T05:50:57Z", "creator": "vgujjar@tcg-software.com", "creation_time": "2003-03-28T05:50:57Z", "is_private": false, "text": "I tried to set formula in a cell using following three ways.\n\n1. HSSFCell cell = sheet.createCell(1);\n2. cell.setCellType(HSSFCell.CELL_TYPE_FORMULA);\n3.  cell.setCellFormula(\"A2+B2\");\nGives Error on line 2\n\n1. HSSFCell cell = sheet.createCell(1,HSSFCell.CELL_TYPE_FORMULA);\n2. cell.setCellFormula(\"A2+B2\");\n This works but for only once i.e if I try setCellFormula again it gives a \nClassCastException line 458 in HSSFCell.java()\n\n1. HSSFCell cell = sheet.createCell(1);\n2. cell.setCellFormula(\"A2+B2\");\n This works perfectly"}, {"count": 1, "attachment_id": null, "creator": "kamoshida.toshiaki@future.co.jp", "is_private": false, "id": 34019, "time": "2003-03-28T07:20:47Z", "bug_id": 18444, "creation_time": "2003-03-28T07:20:47Z", "tags": [], "text": "I am not developer:D,but I have an opinion about the problem.\n\nWhen I tried to call HSSFCell#setCellType(CELL_TYPE_STRING) to a cell having \na \"number value\" and I fouund it causes Exception.It is reasonable because \nnumber value is already existed.\n\nHSSFCell has some metod to set value,setCellFormula(formulla string) and \nsetCellValue(for each value types).and in thease methods,inner logic \nautomatically changes cell's type to right value.\n\nSo I feel,the method HSSFCell#setCellType() is no need to open as public method.\nThe matter that the method is pubic, may make users confuse(as I did:D).The \nmethod should be \"deprecated method\"."}, {"count": 2, "attachment_id": null, "creator": "vgujjar@tcg-software.com", "is_private": false, "id": 34023, "time": "2003-03-28T07:52:22Z", "bug_id": 18444, "creation_time": "2003-03-28T07:52:22Z", "tags": [], "text": " I went throught the source code I find that setCellFormula(String formula) \ncalls the setCellType(HSSFCell.CELL_TYPE_FORMULA) so, you are right because \nthis method  setCellType(HSSFCell.CELL_TYPE_FORMULA) is being called twice \nhence throws exception.\n\nThanks for your reply.."}, {"count": 3, "attachment_id": null, "creator": "poi-support@buni.org", "is_private": false, "id": 41363, "time": "2003-07-24T16:01:56Z", "bug_id": 18444, "creation_time": "2003-07-24T16:01:56Z", "tags": [], "text": "this looks like a conversation that should have been on the list and has\nresolved itself."}]