[{"count": 0, "tags": [], "creator": "ben@zvan.net", "text": "Documentation for LockOutRealm does not specify if failed logins due to being locked out by the LockOutRealm count as failed logins for the purpose of locking out a user.\n\nFor example: Lets say I'm protecting an API with LockOutRealm and the authentication fails either due to maliciously bad password, accidentally bad password, or back-end auth fail. This results in a LockOut condition because it happened x times in y period. But the machines legitimately hitting the API don't care and continue to fail to authenticate during the LockOut period. Will the machines ever be allowed to authenticate or is this a critical failure of the API?", "id": 191684, "time": "2016-06-15T15:17:08Z", "bug_id": 59708, "creation_time": "2016-06-15T15:17:08Z", "is_private": false, "attachment_id": null}, {"count": 1, "attachment_id": null, "creator": "markt@apache.org", "text": "Thanks for the report.\n\nTo answer the question, the LockOutRealm currently treats any authentication attempt during the lock out period as a failure. This does mean that once an account is locked out, if the legitimate users attempts to login more frequently that the lockout period that user is never going to regain access.\n\nIt does make sense to change this behaviour (and document it) so that valid logins do not extend the lockout period. I'll take a look at a patch.", "id": 191696, "time": "2016-06-15T19:48:57Z", "bug_id": 59708, "creation_time": "2016-06-15T19:48:57Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 59708, "is_private": false, "id": 191702, "creation_time": "2016-06-15T21:18:13Z", "time": "2016-06-15T21:18:13Z", "creator": "ben@zvan.net", "text": "Thanks for the clarification. I look forward to seeing this progress.", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 59708, "is_private": false, "id": 191849, "creation_time": "2016-06-20T18:49:18Z", "time": "2016-06-20T18:49:18Z", "creator": "markt@apache.org", "text": "This has been fixed the trunk for all currently supported versions and will be included in:\n- 9.0.0.M9 onwards\n- 8.5.4 omwards\n- 8.0.37 onwards\n- 7.0.71 onwards\n- 6.0.46 onwards", "attachment_id": null}, {"count": 4, "attachment_id": null, "bug_id": 59708, "is_private": false, "id": 193174, "time": "2016-08-18T13:59:28Z", "creator": "ben@zvan.net", "creation_time": "2016-08-18T13:59:28Z", "tags": [], "text": "Thanks for this fix. I'd like to ask one more technical question about it: Are the wrapped realms authenticated before the lockout or is the lockout checked before attempting real authentication?\n\nExample:\n<Lockout realm>\n  <LDAP realm/>\n</Lockout realm>\n\nIf I try to authenticate but I'm in lockout, is LDAP triggered? It looks like the answer is probably \"yes\" because of the 401 Unauthorized response, which usually indicates authentication was successful."}, {"count": 5, "tags": [], "bug_id": 59708, "is_private": false, "id": 193217, "creation_time": "2016-08-19T08:14:25Z", "time": "2016-08-19T08:14:25Z", "creator": "markt@apache.org", "text": "Yes, authentication is now always checked so Tomcat can vary the behaviour during a lock out depending on whether the authentication credentials provided were valid or not.\n\nFor more details, you can always look at the source:\nhttp://svn.apache.org/viewvc/tomcat/trunk/java/org/apache/catalina/realm/LockOutRealm.java?view=annotate", "attachment_id": null}]