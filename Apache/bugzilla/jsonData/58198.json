[{"count": 0, "tags": [], "creator": "cronier.jy@gmail.com", "attachment_id": null, "text": "To facilitate Tomcat administration with multiple instances, I pass the 'controlPort' with variable substitution in server.xml with value in CATALINA_OPTS\n\nFor example in server.xml:\n  <Connector port=\"${connector.port}\"\n\nAnd I launch with:\n  CATALINA_OPTS=-Dconnector.port=8181\n\nThe Tomcat launching is sucessful, but not the Tomcat stoping because substitution variable isn't done.\n\nTo successfully stopping Tomcat, I have to fix issue in catalina.sh (and catalina.bat)\n\nI have replaced the following:\n\n  eval \"\\\"$_RUNJAVA\\\"\" $LOGGING_MANAGER $JAVA_OPTS \\\n    -Djava.endorsed.dirs=\"\\\"$JAVA_ENDORSED_DIRS\\\"\" -classpath \"\\\"$CLASSPATH\\\"\" \\\n    -Dcatalina.base=\"\\\"$CATALINA_BASE\\\"\" \\\n    -Dcatalina.home=\"\\\"$CATALINA_HOME\\\"\" \\\n    -Djava.io.tmpdir=\"\\\"$CATALINA_TMPDIR\\\"\" \\\n    org.apache.catalina.startup.Bootstrap \"$@\" stop\n\nBy:\n\n  eval \"\\\"$_RUNJAVA\\\"\" $LOGGING_MANAGER $JAVA_OPTS \\\n    -Djava.endorsed.dirs=\"\\\"$JAVA_ENDORSED_DIRS\\\"\" -classpath \"\\\"$CLASSPATH\\\"\" \\\n    -Dcatalina.base=\"\\\"$CATALINA_BASE\\\"\" \\\n    -Dcatalina.home=\"\\\"$CATALINA_HOME\\\"\" \\\n    -Djava.io.tmpdir=\"\\\"$CATALINA_TMPDIR\\\"\" \\\n    ${CATALINA_OPTS} \\\n    org.apache.catalina.startup.Bootstrap \"$@\" stop", "id": 184252, "time": "2015-07-31T12:01:04Z", "bug_id": 58198, "creation_time": "2015-07-31T12:01:04Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 58198, "attachment_id": null, "id": 184255, "time": "2015-07-31T15:12:15Z", "creator": "chris@christopherschultz.net", "creation_time": "2015-07-31T15:12:15Z", "is_private": false, "text": "This behavior is by design: CATALINA_OPTS is only intended to be used as a start option.\n\nIf you want to pass options to the \"stop\" command, use JAVA_OPTS instead."}]