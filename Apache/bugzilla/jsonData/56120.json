[{"count": 0, "tags": [], "creator": "aharrison@gmail.com", "attachment_id": null, "id": 172943, "time": "2014-02-07T21:07:57Z", "bug_id": 56120, "creation_time": "2014-02-07T21:07:57Z", "is_private": false, "text": "I noticed this while trying to use %{mod_php_memory_usage} in a LogFormat directive. The PHP source (sapi_apache2.c) calls apr_psprintf using a %zu format. Instead of expanding, %zu is written in plain text to the log file.\n\nDoesn't look like many other people have stumbled on this issue, I only turned up one with this specific problem:\n\nhttp://stackoverflow.com/questions/21549852/apache-mod-php-memory-usage-prints-zu-instead-of-useful-data\n\nI looked at the glibc source, but %z has existed there for 10+ years.  So I went looking at the php source. Here is the php commit from May 16, 2011 that implemented the %zu, but the comment isn't terribly descriptive:  \n\nhttps://github.com/php/php-src/commit/e0df4e3dba7c4ab92442b9e82c1de01fdbaa3cce\n\nI see that you've implemented other characters to expand over time, so I thought this would be a good one to add to the list."}, {"count": 1, "tags": [], "bug_id": 56120, "attachment_id": null, "text": "The z prefix is standard with C99, so it would be nice for APR to support that in a future release (i.e., starting with APR 1.6 or 2.0).\n\nPHP should be using APR_SIZE_T_FMT, as in the following call:\n\napr_psprintf(ctx->r->pool, \"%\" APR_SIZE_T_FMT, zend_memory_peak_usage(1 TSRMLS_CC)));\n\nI posted that to the PHP folks via https://github.com/php/php-src/pull/641.\n\nWe'll leave this APR issue open as an enhancement request.", "id": 174538, "time": "2014-04-13T20:41:33Z", "creator": "trawick@apache.org", "creation_time": "2014-04-13T20:41:33Z", "is_private": false}]