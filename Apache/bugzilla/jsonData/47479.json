[{"count": 0, "tags": [], "bug_id": 47479, "attachment_id": null, "id": 128550, "time": "2009-07-06T05:22:38Z", "creator": "vesa_akerman@sil.org", "creation_time": "2009-07-06T05:22:38Z", "is_private": false, "text": "Gives this error when creating new HSSFWorkbook.  The excel file was made with OpenOffice 3.0, and converted to Microsoft Excel 97/... format.\nThis error occurs ONLY WHEN THERE ARE BOOLEAN VALUES in the spreadsheet!"}, {"count": 1, "tags": [], "creator": "josh@apache.org", "attachment_id": null, "id": 128566, "time": "2009-07-06T13:06:27Z", "bug_id": 47479, "creation_time": "2009-07-06T13:06:27Z", "is_private": false, "text": "I think the mistake is in OOO Calc - line 651 of xetable.cxx:\n(http://svn.services.openoffice.org/ooo/trunk/sc/source/filter/excel/xetable.cxx)\nThis is inconsistent with the documentation.\n\nI would propose this fix:\n\nIndex: xetable.cxx\n===================================================================\n--- xetable.cxx (revision 268869)\n+++ xetable.cxx (working copy)\n@@ -648,7 +648,7 @@\n\n void XclExpBooleanCell::WriteContents( XclExpStream& rStrm )\n {\n-    rStrm << sal_uInt16( mbValue ? 1 : 0 ) << EXC_BOOLERR_BOOL;\n+    rStrm << sal_uInt8( mbValue ? 1 : 0 ) << EXC_BOOLERR_BOOL;\n }\n\n // ----------------------------------------------------------------------------\n\n\nI guess Excel is able to read the file because the desired value of 0 (==EXC_BOOLERR_BOOL) still gets written to the second data byte.  \n\n\nFixed in svn r791595\n\nI wrote a unit test to reproduce the problem and also modified POI to tolerate the OOO Calc bug."}]