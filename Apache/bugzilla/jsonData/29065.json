[{"text": "I ran into a proble when trying to create a new worksheet off of a template \nwhich contains an image and some formatting in POI v2.5.  I was not able to \nrecreate the problem in POI 2.0 RC2.  \n\nBelow is the message that I posted to the User Mailing List describing the \nproblem in more detail and also showing the example code that I used.\n\n> Basically, I have a test case that attempts to modify one cell in the \n> new worksheet.  When I attempt to open the newly created file it gives \n> me an error that Microsoft attempted to repair the file.  Here is a \n> copy of the\n> log:\n> \n> \n> \tErrors were detected in file \n> 'C:\\API_RECON\\test_data\\excel_manipulation_test.xls'\n> \tThe following is a list of repairs:\n> \n> \tDamage to the file was so extensive that repairs were not possible.\n> Excel attempted to recover your formulas and values, but \tsome data\n> may have been lost or corrupted.\n> \n> The file opens, but all the formatting is gone and the image is not \n> displayed. Is anyone else having this problem?  Any help is much \n> appreciated.\n> \n> \n> Here is my test code:\n> \n>   public ExcelTest() {\n>   \n>     try {\n>       FileInputStream file = new \n> FileInputStream(\"C:\\\\API_RECON\\\\test_data\\\\Reconciliation_Report_Templ\n> ate.xl\n> t\");\n>       HSSFWorkbook wb = new HSSFWorkbook(file, true);\n>       HSSFSheet sheet = wb.getSheetAt(0);\n>       HSSFRow title_row = sheet.getRow(3);\n>       HSSFCell title_cell = title_row.getCell((short)0);\n>       title_cell.setCellValue(\"TEST TEST TEST\");\n>       \n>       FileOutputStream out = new \n> FileOutputStream(\"C:\\\\API_RECON\\\\test_data\\\\excel_manipulation_test.xls\");\n>       wb.write(out); \n>       out.close();\n> \n>     } catch (FileNotFoundException fnf) {\n>       fnf.printStackTrace();\n>     } catch (IOException ioe) {\n>       ioe.printStackTrace();\n>     }  \n>   }\n>   \n>   public static void main(String[] args) {\n>     new ExcelTest();\n>   }", "tags": [], "creator": "bret.gregory@accesspointinc.com", "attachment_id": null, "count": 0, "id": 57613, "time": "2004-05-18T16:56:51Z", "bug_id": 29065, "creation_time": "2004-05-18T16:56:51Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 29065, "text": "Try the latest POI-3.5-beta4. If the problem persists, re-open this bug and attach the problem file and sample code to reproduce the problem.\n\nYegor", "id": 123584, "time": "2008-12-29T09:06:36Z", "creator": "yegor@dinom.ru", "creation_time": "2008-12-29T09:06:36Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "text": "No answer for a long time, set Bug to RESOLVED", "id": 169090, "time": "2013-08-04T19:47:14Z", "bug_id": 29065, "creation_time": "2013-08-04T19:47:14Z", "is_private": false}]