[{"count": 0, "tags": [], "creator": "dmaiocchi@suse.com", "attachment_id": null, "id": 190614, "time": "2016-04-28T08:20:05Z", "bug_id": 59390, "creation_time": "2016-04-28T08:20:05Z", "is_private": false, "text": "[Distros tested]\n\n-opensuse\n-fedora\n\n[HOW to Reproduce]\n\ninstalling tomcat. \nAs user i want to setup tomcat with ssl.\n\nI generate the keystore using the java tool but \"accidentally\" i put it in a directory  that as the wrong permission. example \"root/keystore\"\n\nSo i setup tomcat and start it with systemctl start tomcat.\n\nwhen i run systemctl status tomcat i got :\n\nsystemctl status tomcat.service \n\u25cf tomcat.service - Apache Tomcat Web Application Container\n   Loaded: loaded (/usr/lib/systemd/system/tomcat.service; disabled; vendor preset: disabled)\n   Active: active (running) since Do 2016-04-28 08:35:44 CEST; 1h 31min ago\n  Process: 2657 ExecStop=/usr/libexec/tomcat/server stop (code=exited, status=0/SUCCESS)\n Main PID: 2693 (java)\n   CGroup: /system.slice/tomcat.service\n           \u2514\u25002693 /usr/lib/jvm/jre/bin/java -Djavax.sql.DataSource.Factory=org.apache.commons.dbcp.BasicDataSourceFactory -classpath /usr/share/tomcat/bin/bootstrap.jar:/usr/share/tomcat/bin/tomcat-juli.jar:/...\n\nApr 28 08:35:48 localhost.localdomain server[2693]: 28-Apr-2016 08:35:48.582 INFO [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Deployment of web r[2693]: 28-Apr-2016 08:35:48.900 INFO [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Deploying web application director.../webapps/docs\nApr 28 08:35:49 localhost.localdomain server[2693]: 28-Apr-2016 08:35:49.154 INFO [localhost-startStop-1] org.apache.jasper.servlet.TldScanner.scanJars At least one JAR was scanned for TLDs yet contained no T...\nApr 28 08:35:49 localhost.localdomain server[2693]: 28-Apr-2016 08:35:49.157 INFO [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Deployment of web application dire...hed in 257 ms\nApr 28 08:35:49 localhost.localdomain server[2693]: 28-Apr-2016 08:35:49.166 INFO [main] org.apache.coyote.AbstractProtocol.start Starting ProtocolHandler [\"http-nio-8080\"]\nApr 28 08:35:49 localhost.localdomain server[2693]: 28-Apr-2016 08:35:49.177 INFO [main] org.apache.coyote.AbstractProtocol.start Starting ProtocolHandler [\"ajp-nio-8009\"]\nApr 28 08:35:49 localhost.localdomain server[2693]: 28-Apr-2016 08:35:49.180 INFO [main] org.apache.catalina.startup.Catalina.start Server startup in 2804 ms\n\n====================\nI would think that the status of tomcat with ssl is perfect and is working but, \nlooking and catalina.log this is not the case.\n\ngrep /var/log/tomcat/catalina.2016-04-28.log \n\nSEVERE [main] org.apache.tomcat.util.net.jsse.JSSESocketFactory.getStore Failed to load keystore type JKS with path /root/keystore due to /root/keystore (Keine Berechtigung)  > (not Allowed).\n\n\n[EXPECTED RESULTS]\n\nI can expect 2 results:\n\n1) If the configuration is broken for some reason, then systemctl start tomcat should fail.\n[ this could be a difficult approach if we have multiple hosts, or conf. Like http and https. and https is bad configured , but http well configured.\n\nSo i'm thinking  about the second solution.\n\n\n\n2)\nsystemctl status tomcat \n\n\u25cf tomcat.service - Apache Tomcat Web Application Container\n   Loaded: loaded (/usr/lib/systemd/system/tomcat.service; disabled; vendor preset: disabled)\n   Active: active (running) since Do 2016-04-28 08:35:44 CEST; 1h 38min ago\n  Process: 2657 ExecStop=/usr/libexec/tomcat/server stop (code=exited, status=0/SUCCESS)\n Main PID: 2693 (java)\n   CGroup: /system.slice/tomcat.service\n\nApr 28 08:35:48 localhost.localdomain server[2693]: 28-Apr-2016 08:35:48.900 INFO [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Deploying web applica\n\nSEVERE [main] org.apache.tomcat.util.net.jsse.JSSESocketFactory.getStore Failed to load keystore type JKS with path /root/keystore due to /root/keystore \n\n\n2) solution should be that systemctl status should report directly that ths ssl configuration is failed, and the other configuration are fine, but starting tomcat, unlike solution 1)."}, {"count": 1, "tags": [], "bug_id": 59390, "text": "The Apache Tomcat project has no control over the status scripts that distros may wrap around Tomcat.", "id": 190615, "time": "2016-04-28T08:33:49Z", "creator": "markt@apache.org", "creation_time": "2016-04-28T08:33:49Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "dmaiocchi@suse.com", "attachment_id": null, "text": "Ok thank you Mark for you answer  !  have nice day", "id": 190616, "time": "2016-04-28T08:53:15Z", "bug_id": 59390, "creation_time": "2016-04-28T08:53:15Z", "is_private": false}, {"count": 3, "tags": [], "creator": "csutherl@apache.org", "text": "@dario, I haven't seen a bug report from you against Fedora tomcat, so I'll just respond here. The reason why you don't get a failure is because Tomcat didn't fail to start :) Tomcat is up and running, but without the SSL connector because of the keystore issue. In order for the status check to return a failure, Tomcat would have to indicate that it didn't start up completely somehow, which it presently doesn't as far as I can tell. You could check yourself in various ways though.\n\nI don't have much more to say on the topic, but please open a Fedora/SUSE tomcat bug (or maybe inquire on the tomcat-users list on the possibility of getting a failed start in your situation) if you wish to continue discussing this issue.", "id": 190650, "time": "2016-04-29T16:58:33Z", "bug_id": 59390, "creation_time": "2016-04-29T16:58:33Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "jeff@redradishtech.com", "attachment_id": null, "text": "> 2) solution should be that systemctl status should report directly that ths ssl configuration is failed, and the other configuration are fine, but starting tomcat, unlike solution 1).\n\nThe lack of error message in 'systemctl status' is a systemd bug:\n\nhttps://github.com/systemd/systemd/issues/1347\n\nSee Tomcat workaround suggestion at https://bz.apache.org/bugzilla/show_bug.cgi?id=60632", "id": 196352, "time": "2017-01-24T02:16:18Z", "bug_id": 59390, "creation_time": "2017-01-24T02:16:18Z", "is_private": false}]