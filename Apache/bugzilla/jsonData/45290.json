[{"count": 0, "tags": [], "text": "I am getting this exception on one specific document from a customer. The origin of this document is unclear.\n\nWe're running POI 3.0.1 Final.\n\nHas this issue been resolved since?\n\nI know other folks have reported something similar before, e.g. \nhttps://issues.apache.org/bugzilla/show_bug.cgi?id=32076\n\nPlease advise.\nThanks.", "attachment_id": null, "id": 118028, "creator": "dgoldenberg@attivio.com", "time": "2008-06-26T13:50:41Z", "bug_id": 45290, "creation_time": "2008-06-26T13:50:41Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 45290, "text": "Created attachment 22182\nthe doc\n\nThis is the document that I'm seeing the behavior on.", "id": 118029, "time": "2008-06-26T13:51:51Z", "creator": "dgoldenberg@attivio.com", "creation_time": "2008-06-26T13:51:51Z", "is_private": false, "attachment_id": 22182}, {"count": 2, "tags": [], "creator": "dgoldenberg@attivio.com", "attachment_id": null, "text": "Here is the stack trace:\n\njava.io.IOException: block[ 44 ] already removed\n\tat org.apache.poi.poifs.storage.BlockListImpl.remove(BlockListImpl.java:97)\n\tat org.apache.poi.poifs.storage.BlockAllocationTableReader.fetchBlocks(BlockAllocationTableReader.java:190)\n\tat org.apache.poi.poifs.storage.BlockListImpl.fetchBlocks(BlockListImpl.java:129)\n\tat org.apache.poi.poifs.filesystem.POIFSFileSystem.processProperties(POIFSFileSystem.java:412)\n\tat org.apache.poi.poifs.filesystem.POIFSFileSystem.<init>(POIFSFileSystem.java:103)", "id": 118030, "time": "2008-06-26T13:53:12Z", "bug_id": 45290, "creation_time": "2008-06-26T13:53:12Z", "is_private": false}, {"count": 3, "tags": [], "text": "I'm pretty sure this was fixed a while back.\n\nPlease try with 3.1-BETA2, or 3.1 final when that comes out (hopefully next week)", "attachment_id": null, "id": 118055, "creator": "apache@gagravarr.org", "time": "2008-06-27T02:15:45Z", "bug_id": 45290, "creation_time": "2008-06-27T02:15:45Z", "is_private": false}, {"count": 4, "tags": [], "text": "Just as a comment. If have seen this error once when I was trying to load an xls-file that (wrongly) has been placed in CVS with ASCII substitution. As soon as the file was converted to binary the error disappeared.", "attachment_id": null, "id": 120168, "creator": "poul-bildsoe.moller@capgemini.com", "time": "2008-08-28T04:00:50Z", "bug_id": 45290, "creation_time": "2008-08-28T04:00:50Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 45290, "attachment_id": null, "is_private": false, "id": 122082, "time": "2008-10-31T11:51:21Z", "creator": "dgoldenberg@attivio.com", "creation_time": "2008-10-31T11:51:21Z", "text": "Folks,\nI just verified and I am still seeing this exception with 3.2 FINAL.\n\nWe really would like to see this fixed since we have a customer that keeps asking about it :)\n\nAnd I'd love to contribute to the fix but unfortunately the \"block[ 44 ] already removed\" error is not informative enough for me to do anything about it.\n\nAnyone?\n\nThanks!"}, {"count": 6, "tags": [], "text": "I was pretty sure we had fixed this in svn months and months ago :(\n\nCan you confirm that the excel file attached to the bug triggers it?", "is_private": false, "id": 122125, "creator": "apache@gagravarr.org", "time": "2008-11-02T20:18:20Z", "bug_id": 45290, "creation_time": "2008-11-02T20:18:20Z", "attachment_id": null}, {"count": 7, "tags": [], "creator": "dgoldenberg@attivio.com", "attachment_id": null, "text": "Nick,\n\nYes, this indeed is the case; I'm seeing the behavior on the attached file, using 3.2 FINAL.\n\nHere is the stack trace:\n\njava.io.IOException: block[ 44 ] already removed\n\tat org.apache.poi.poifs.storage.BlockListImpl.remove(BlockListImpl.java:97)\n\tat org.apache.poi.poifs.storage.BlockAllocationTableReader.fetchBlocks(BlockAllocationTableReader.java:190)\n\tat org.apache.poi.poifs.storage.BlockListImpl.fetchBlocks(BlockListImpl.java:130)\n\tat org.apache.poi.poifs.filesystem.POIFSFileSystem.processProperties(POIFSFileSystem.java:530)\n\tat org.apache.poi.poifs.filesystem.POIFSFileSystem.<init>(POIFSFileSystem.java:176)\n\n- Dmitry", "id": 122130, "time": "2008-11-03T04:59:01Z", "bug_id": 45290, "creation_time": "2008-11-03T04:59:01Z", "is_private": false}, {"count": 8, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "Ah, this is a subtly different error message to the one in bug #44898\n\nSome digging deep into poifs is probably needed", "id": 122413, "time": "2008-11-12T07:39:38Z", "bug_id": 45290, "creation_time": "2008-11-12T07:39:38Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 45290, "attachment_id": null, "id": 122415, "time": "2008-11-12T10:25:11Z", "creator": "apache@gagravarr.org", "creation_time": "2008-11-12T10:25:11Z", "is_private": false, "text": "Your file seems really odd - the block containing the header information is then listed at the end of the normal blocks list.\n\nSo, poifs pulls out the header block to process, then sets off along the data block list, hits a reference to the header block that's already been handled, and gets in a huff\n\nI've just committed a workaround to svn, where if the block is already gone and it's the header block, then consider the data blocks section done. Hopefully that'll fix it for you, but there does seem to be something very odd about the file. Do you happen to know how it was created?"}, {"count": 10, "tags": [], "text": "Nick,\n\nNo idea really how this file was created. It came from a customer and I believe they had been googling for test files.\n\nCould you point me at the the files that contain your fix? Is this off 3.2 FINAL?\n\nThanks for the quick turnaround!", "attachment_id": null, "id": 122416, "creator": "dgoldenberg@attivio.com", "time": "2008-11-12T10:33:56Z", "bug_id": 45290, "creation_time": "2008-11-12T10:33:56Z", "is_private": false}, {"count": 11, "tags": [], "bug_id": 45290, "attachment_id": null, "is_private": false, "id": 122431, "time": "2008-11-13T08:50:28Z", "creator": "apache@gagravarr.org", "creation_time": "2008-11-13T08:50:28Z", "text": "commits@poi.apache.org IYF here:\nhttp://mail-archives.apache.org/mod_mbox/poi-commits/\nhttp://mail-archives.apache.org/mod_mbox/poi-commits/200811.mbox/%3c20081112182543.8D52C23888F1@eris.apache.org%3e"}]