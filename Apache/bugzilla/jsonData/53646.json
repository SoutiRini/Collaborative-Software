[{"count": 0, "attachment_id": 29158, "bug_id": 53646, "text": "Created attachment 29158\nJSESSIONID cookie suffixed by Apache2 2.2.22 load balancer\n\nDear HTTP community,\n\ncurrently, we're having the following Apache 2.2.22 web server configuration to allow a uniformly distributed balancing of HTTP requests to the two running Apache Tomcat instances behind.\n\nBoth Apache Tomcat instances are located on invidual but identital physical hardware.\n\nThe configuration looks like:\n\n<Proxy balancer://fs4_javaclient_over_https>\n    BalancerMember ajp://rb-wcmstc1.de.bosch.com:8009 loadfactor=50 ping=5 retry=10 route=rb-wcmstc1 connectiontimeout=5 timeout=300\n    BalancerMember ajp://rb-wcmstc2.de.bosch.com:8009 loadfactor=50 ping=5 retry=10 route=rb-wcmstc2 connectiontimeout=5 timeout=300\n\n    ProxySet stickysession=JSESSIONID|jsessionid\n    ProxySet lbmethod=byrequests\n    ProxySet scolonpathdelim=On\n    ProxySet nofailover=Off\n</Proxy>\n\n<Proxy balancer://fs4_webclient_over_https>\n    BalancerMember ajp://rb-wcmstc1.de.bosch.com:8010 loadfactor=50 ping=5 retry=10 route=rb-wcmstc1 connectiontimeout=5 timeout=300\n    BalancerMember ajp://rb-wcmstc2.de.bosch.com:8010 loadfactor=50 ping=5 retry=10 route=rb-wcmstc2 connectiontimeout=5 timeout=300\n    ProxySet stickysession=JSESSIONID|jsessionid\n    ProxySet lbmethod=byrequests\n    ProxySet scolonpathdelim=On\n    ProxySet nofailover=Off\n</Proxy>\n\nRewriteCond %{REQUEST_URI} !^/index.html\nRewriteCond %{REQUEST_URI} !^/balancer-manager\nRewriteCond %{REQUEST_URI} !^/server-*\nRewriteRule ^/(.*) balancer://fs4_webclient_over_https/$1 [proxy,last]\n\n\nNow, what happens:\n- initially, balancing is - as expected - uniformly distributed\n- after a while, the balancing behaviour changes on one of the two balancing members\n\nIf we restart the Apache2 2.2.22 web server the problem has gone - for a short moment. This could be proven, when taking a closer look to the JSESSIONID cookies suffixed by Apache2 with the \"route\" value of the \"BalancerMember\". Details see screenshot attached!", "id": 161071, "time": "2012-08-02T15:51:44Z", "creator": "Holger.King@de.bosch.com", "creation_time": "2012-08-02T15:51:44Z", "tags": [], "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 53646, "text": "For sure, during the test, after each request, the COOKIES are deleted in the browser (here: Firefox). Then, the new request, shows the same COOKIE suffix again.", "id": 161072, "time": "2012-08-02T16:00:18Z", "creator": "Holger.King@de.bosch.com", "creation_time": "2012-08-02T16:00:18Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "Holger.King@de.bosch.com", "attachment_id": null, "id": 161073, "time": "2012-08-02T16:14:36Z", "bug_id": 53646, "creation_time": "2012-08-02T16:14:36Z", "is_private": false, "text": "The first \"Proxy balancer://fs4_javaclient_over_https\" is called when, the following rules match:\n\nRewriteCond %{REQUEST_URI} ^/servlet/ClientIO [NC]\nRewriteRule ^/(.*) balancer://fs4_javaclient_over_https/$1 [proxy,last]"}]