[{"count": 0, "tags": [], "bug_id": 35682, "attachment_id": null, "text": "The JDBCRealm currently is configured via table names and column names.  In \nour database, this is not flexible enough and we cannot use the JDBCRealm.\n\nThe proposed enhancement adds new configuration strings to the JDBCRealm to \nallow it to work with more database schemas.  Specifically, you specify and \ncredentialsSQL and rolesSQL configuration string in the Realm fragment in \nserver.xml.\n\nWith this enhancement, my Realm fragment looks like this:\n\n\t\t            <Realm  \n\t\t                className=\"org.apache.catalina.realm.JDBCRealm\"\n\t\t                driverName=\"net.sourceforge.jtds.jdbc.Driver\"\n\t\t                \nconnectionURL=\"jdbc:jtds:sqlserver://localhost:1433/xxx;SelectMethod=cursor;Use\nr=xxx;Password=xxx\"\n\t\t                credentialsSQL=\"SELECT FPassword FROM DAccount \nWHERE FUsername=?\"\n\t\t                rolesSQL=\"SELECT DRole.FName FROM DAccount \nINNER JOIN DAccountToDRole ON DAccount.FId = DAccountToDRole.FAccountId INNER \nJOIN DRole ON DAccountToDRole.FRoleId = DRole.FId WHERE (DAccount.FUsername \n= ?)\"\n\t\t                />\n\nThe code modifications in JDBCRealm.java are minor, the diff -u will be \nattached.  Basically, if the credentialsSQL and rolesSQL are valid (ie non \nnull and not \"\"), then the credentialsSQL and rolesSQL will be used instead of \nany column/table names provided.\n\n-- thanks, Andrew", "id": 77166, "time": "2005-07-11T00:56:57Z", "creator": "aktweb@msn.com", "creation_time": "2005-07-11T00:56:57Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 35682, "attachment_id": 15642, "id": 77167, "time": "2005-07-11T00:58:20Z", "creator": "aktweb@msn.com", "creation_time": "2005-07-11T00:58:20Z", "is_private": false, "text": "Created attachment 15642\ndiff -u of the change"}, {"count": 2, "tags": [], "creator": "aktweb@msn.com", "attachment_id": 15643, "is_private": false, "id": 77168, "time": "2005-07-11T00:58:49Z", "bug_id": 35682, "creation_time": "2005-07-11T00:58:49Z", "text": "Created attachment 15643\nnew JDBCRealm.java"}, {"count": 3, "attachment_id": null, "bug_id": 35682, "is_private": false, "id": 77169, "time": "2005-07-11T01:00:27Z", "creator": "aktweb@msn.com", "creation_time": "2005-07-11T01:00:27Z", "tags": [], "text": "One more thing, probably should'nt have, but the fixes a typo in the \nwork \"given\".\n-- Andrew"}, {"count": 4, "tags": [], "creator": "yoavs@computer.org", "is_private": false, "text": "Thanks for submitting this patch.  However, as we're trying to move away from\nJDBCRealm in favor of DataSourceRealm, and as this might be addressed by setting\nup appropriate views in your database, I'm hesitant to apply it to the\nJDBCRealm.  If you strongly feel there's a broad use-case for this, please bring\nit up on the tomcat-dev mailing list.  Thanks.", "id": 77578, "time": "2005-07-22T16:51:17Z", "bug_id": 35682, "creation_time": "2005-07-22T16:51:17Z", "attachment_id": null}]