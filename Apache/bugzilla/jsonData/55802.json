[{"count": 0, "tags": [], "bug_id": 55802, "text": "i am creating a document in that way:\n\nXWPFRun aktRun = aktpara.createRun();\naktRun.setText(textA);\naktRun.setBold(aktBold);\naktRun.setItalic(aktItalic);\naktRun.setFontFamily(aktFont);\naktRun.setFontSize(aktSize);\n\nMy textA-String includes german words which has '\u00e4, \u00fc, \u00df or \u00f6' inside. When writing the document i have a wrong font inside the words. It use the Calibri Font instead of the Font of the other letters of the word at that position. The size and the other attributes are all right, only the font is wrong.", "id": 171351, "time": "2013-11-20T14:53:01Z", "creator": "tp@klar-partner.de", "creation_time": "2013-11-20T14:53:01Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 55802, "text": "I'm not quite understanding the problem. Any chance you can create a short junit unit test that shows the problem?", "id": 171355, "time": "2013-11-20T17:19:59Z", "creator": "apache@gagravarr.org", "creation_time": "2013-11-20T17:19:59Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "text": "Created attachment 31105\nBug", "is_private": false, "bug_id": 55802, "id": 171701, "time": "2013-12-12T08:04:59Z", "creator": "tp@klar-partner.de", "creation_time": "2013-12-12T08:04:59Z", "attachment_id": 31105}, {"attachment_id": null, "tags": [], "bug_id": 55802, "text": "Sorry to answer that late. My Problem is still very important for me to get solved. In the Attachement you can see the Problem.\nWhen i open my generated file with Word (or open Office should be the same) i get everything in the right font (the font i used in the Java Project).\nBut all the Special letters like \u00fc,\u00f6,\u00e4,\u00df uses the Font 'Calibri'. Whats wrong there, i know These letters also exist in the other Fonts. Everything works, the underline, italic, bold, fontsize, but only the font is different there. I hope my Infos are now enough, otherwise i can Show you more sourcetext, but it doesnt seem it is because of that! Thank you already:)", "count": 3, "id": 171702, "time": "2013-12-12T08:08:56Z", "creator": "tp@klar-partner.de", "creation_time": "2013-12-12T08:08:56Z", "is_private": false}, {"count": 4, "tags": [], "creator": "kiwiwings@apache.org", "attachment_id": null, "is_private": false, "id": 171878, "time": "2013-12-22T00:39:48Z", "bug_id": 55802, "creation_time": "2013-12-22T00:39:48Z", "text": "You probably need to show more of your code and/or explain how you get the input data - with a simple test, this can't be reproduced:\n\n\npublic void testUmlaut() throws Exception {\n\tXWPFDocument doc = new XWPFDocument();\n\tXWPFRun run = doc.createParagraph().createRun();\n\trun.setText(\"Ort, Datum der Erstellung: Kornelim\u00fcnster, am 8. November 2013\");\n\trun.setFontFamily(\"Arial\");\n\trun.setFontSize(11);\n\tOutputStream os = new FileOutputStream(\"umlaut.docx\");\n\tdoc.write(os);\n\tos.close();\n}\n\n... doesn't generate any other textrun elements in the docx:\n\n<w:p><w:r><w:rPr><w:rFonts w:ascii=\"Arial\"/><w:sz w:val=\"22\"/></w:rPr><w:t>Ort, Datum der Erstellung: Kornelim\u00fcnster, am 8. November 2013</w:t></w:r></w:p>\n\nMy guess is, that you are converting from old doc to docx format and while reading the input file, you are already receiving broken textruns."}, {"count": 5, "tags": [], "bug_id": 55802, "is_private": false, "text": "Thank you for the answer. I used your code to create a test-document.\nExactly the same error happens. The letter '\u00fc' ist Calibri, the rest is Arial.\n\nI wonder, if its correct at you ?!", "id": 172094, "time": "2014-01-06T07:55:14Z", "creator": "tp@klar-partner.de", "creation_time": "2014-01-06T07:55:14Z", "attachment_id": null}, {"count": 6, "tags": [], "creator": "tp@klar-partner.de", "attachment_id": null, "text": "And yes, the file includes: <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<w:document xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"><w:body><w:p><w:r><w:rPr><w:rFonts w:ascii=\"Arial\"/><w:sz w:val=\"22\"/></w:rPr><w:t>Ort, Datum der Erstellung: Kornelim\u00fcnster, am 8. November 2013</w:t></w:r></w:p></w:body></w:document>\n\nSo it seems its something else which is saved incorrect.", "id": 172095, "time": "2014-01-06T07:57:41Z", "bug_id": 55802, "creation_time": "2014-01-06T07:57:41Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 55802, "is_private": false, "text": "May i get some help? It is very important for my Project that this works fine.\nthank you in advance", "id": 172786, "time": "2014-01-29T09:33:06Z", "creator": "tp@klar-partner.de", "creation_time": "2014-01-29T09:33:06Z", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 55802, "is_private": false, "text": "The above example works ok in Libre Writer and Windows Wordpad, but MS Word (Viewer) seem to need the hAnsi attribute to be set: [1]\n\nSo as a temporary workaround, you'll need to write to the xmlbeans directly:\n\nrun.setText(\"Ort, Datum der Erstellung: Kornelim\u00fcnster, am 8. November 2013\");\nrun.setFontFamily(\"Times New Roman\");\nrun.getCTR().getRPr().getRFonts().setHAnsi(\"Times New Roman\");\nrun.setFontSize(50);\n\n\n[1] http://officeopenxml.com/WPtextFonts.php", "id": 172794, "time": "2014-01-29T22:02:29Z", "creator": "kiwiwings@apache.org", "creation_time": "2014-01-29T22:02:29Z", "attachment_id": null}, {"count": 9, "tags": [], "creator": "kiwiwings@apache.org", "attachment_id": 31271, "is_private": false, "id": 172798, "time": "2014-01-29T23:40:37Z", "bug_id": 55802, "creation_time": "2014-01-29T23:40:37Z", "text": "Created attachment 31271\n[PATCH] add default font ranges\n\nThis patch sets the font family of other font ranges to a default value if not they aren't specified explicitly.\n\n(... to be applied when POI 3.10 final is released ...)"}, {"attachment_id": null, "tags": [], "bug_id": 55802, "text": "Many thanks Andreas,\nfinally it works.", "count": 10, "id": 172804, "time": "2014-01-30T09:22:21Z", "creator": "tp@klar-partner.de", "creation_time": "2014-01-30T09:22:21Z", "is_private": false}, {"count": 11, "tags": [], "bug_id": 55802, "text": "I haven't committed the patch yet, so I mark it as reopened.", "id": 172806, "time": "2014-01-30T09:55:01Z", "creator": "kiwiwings@apache.org", "creation_time": "2014-01-30T09:55:01Z", "is_private": false, "attachment_id": null}, {"count": 12, "tags": [], "bug_id": 55802, "attachment_id": null, "text": "Patch applied with r1563496.", "id": 172853, "time": "2014-02-01T22:27:19Z", "creator": "kiwiwings@apache.org", "creation_time": "2014-02-01T22:27:19Z", "is_private": false}]