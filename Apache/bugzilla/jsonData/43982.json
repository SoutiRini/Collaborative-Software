[{"count": 0, "tags": [], "text": "on a recently \"yasted\" SuSE installation, we cannot run tasks we otherwise can\nrun on all other linuxes and Windows.\n\nThe ant-contrib.jar for example is correctly to be found in ${ant.home}/lib and\ndoes contain the file the ant-output complains about below.\n\nWe probably could be helped if the \norg.apache.tools.ant.taskdefs.Definer.addDefinition method in the case of\nfailure tells us where it is searching. A method like the one next would help a\nlot here!\n\nSince we did a chmod 777 on the concerned jar, permissions most likely is not\nthe reason...\n\npublic String getClassLoaderInfo(ClassLoader cl) {\n\t\tStringBuffer extraInfo = new StringBuffer();\n\t\textraInfo.append(cl.getClass().getName() + \": \");\n\t\tif (cl instanceof URLClassLoader) {\n\t\t\tURLClassLoader ucl = (URLClassLoader) cl;\n\t\t\tURL[] urls = ucl.getURLs();\n\t\t\tif (null == urls || 0 == urls.length) {\n\t\t\t\textraInfo.append(\"null == urls\");\n\t\t\t} else {\n\t\t\t\tint i = 0;\n\t\t\t\tfor (i = 0; i < urls.length; i++) {\n\t\t\t\t\tURL url = urls[i];\n\t\t\t\t\textraInfo.append(url.toString()).append(\",\\n\");\n\t\t\t\t}\n\t\t\t\tlog.debug(i + \" elements in class path\");\n\t\t\t}\n\t\t}\n\nor is the problem related to bug 43888\n\nJan:~/s/> ant -debug -v\nApache Ant version 1.7.0 compiled on September 22 2007\nApache Ant version 1.7.0 compiled on September 22 2007\nBuildfile: build.xml\nDetected Java version: 1.5 in: /usr/lib/jvm/java-1.5.0-sun-1.5.0_update12/jre\nDetected OS: Linux\nparsing buildfile /home/jan/build.xml with URI = file:/home/jan/build.xml\nProject base dir set to: /home/jan\n[antlib:org.apache.tools.ant] Could not load definitions from resource\norg/apache/tools/ant/antlib.xml. It could not be found.\n  [taskdef] Could not load definitions from resource\nnet/sf/antcontrib/antcontrib.properties. It could not be found.\n\nBUILD FAILED\n/home/jan/build.xml:13: taskdef class fmpp.tools.AntTask cannot be found\n        at org.apache.tools.ant.taskdefs.Definer.addDefinition(Definer.java:609)\n        at org.apache.tools.ant.taskdefs.Definer.execute(Definer.java:228)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:585)\n        at\norg.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)\n        at org.apache.tools.ant.Task.perform(Task.java:348)\n        at org.apache.tools.ant.Target.execute(Target.java:357)\n        at org.apache.tools.ant.helper.ProjectHelper2.parse(ProjectHelper2.java:140)\n        at\norg.apache.tools.ant.ProjectHelper.configureProject(ProjectHelper.java:96)\n        at org.apache.tools.ant.Main.runBuild(Main.java:683)\n        at org.apache.tools.ant.Main.startAnt(Main.java:199)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:257)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:104)", "attachment_id": null, "id": 111203, "creator": "hauser@acm.org", "time": "2007-11-28T07:47:20Z", "bug_id": 43982, "creation_time": "2007-11-28T07:47:20Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 43982, "attachment_id": null, "text": "see also Bug 23541", "id": 111207, "time": "2007-11-28T07:53:33Z", "creator": "hauser@acm.org", "creation_time": "2007-11-28T07:53:33Z", "is_private": false}, {"count": 2, "tags": [], "text": "taskdef class fmpp.tools.AntTask cannot be found\n\nyou know that http://fmpp.sourceforge.net/ is not ant-contrib?\n\nI agree, we can always improve diagnostics, but there is a limit to what we can\ndo to find tasks we've never heard of, and listing the jars may not be adequate\nwhen there is confusion about where a task comes from.", "attachment_id": null, "id": 111211, "creator": "stevel@apache.org", "time": "2007-11-28T09:46:52Z", "bug_id": 43982, "creation_time": "2007-11-28T09:46:52Z", "is_private": false}, {"count": 3, "tags": [], "creator": "hauser@acm.org", "attachment_id": null, "text": "steve you are right, the fmpp.jar is kind of the second error, but it is present\nwith 777 rights and the \"fmpp/tools/AntTask.class\" is part of the\n/usr/share/ant/lib/fmpp.jar\n\nSuggestions:\n1) when run with the \"-debug\" option or \"-v\" respectively, ant should also print\nthe ${ant.home} and the $ANT_HOME env variable\n2) Is still suggest to list the jar's so that one at least knows in what all\nlocations ant was searching (one might have a not realized how the ant\n\"location\" mechanism deals with a relative path)\n3) again, when run with Debug, <<[antlib:org.apache.tools.ant] Could not load\ndefinitions from resource\norg/apache/tools/ant/antlib.xml. It could not be found.>> should be more\noutspoken where it was looking for the resource", "id": 111243, "time": "2007-11-29T01:03:01Z", "bug_id": 43982, "creation_time": "2007-11-29T01:03:01Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 43982, "attachment_id": null, "text": "a work-around was to simply install ant again in the user-space.\n\nBut I still that if a linux distribution botches up an ant installation, with\n\"ant -debug\" (or -v), it should be possible to get useful hints from ant what's\nwrong and unfortunately, this currently appears not to be the case.", "id": 111253, "time": "2007-11-29T03:50:00Z", "creator": "hauser@acm.org", "creation_time": "2007-11-29T03:50:00Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 43982, "attachment_id": null, "text": "surely ant -diagnostics provides all this information?", "id": 111265, "time": "2007-11-29T05:24:22Z", "creator": "stevel@apache.org", "creation_time": "2007-11-29T05:24:22Z", "is_private": false}, {"count": 6, "tags": [], "creator": "hauser@acm.org", "attachment_id": null, "text": "thx for the hint - diagnostics shows that both our ant-contrib.jar and fmpp.jar\nwere in the java.class.path also with the yast installation. This makes it even\nmore confusing why we got the error...", "id": 111269, "time": "2007-11-29T06:05:38Z", "bug_id": 43982, "creation_time": "2007-11-29T06:05:38Z", "is_private": false}, {"count": 7, "attachment_id": null, "bug_id": 43982, "text": "1. we could provide a hint in the taskdef error (run ant -diagnostics), as well\nas more details on classpaths.\n\n2. RPM-based installation is trouble. I'm not going to say its a bad thing,\nbecause what things like yast, yum and apt-get bring to the table is the ability\nto pump out updates to thousands of machines from one server. Its just very much\nat odds with the java way of thinking. alternatively, the java way of thinking\nis out of touch with some world views of configuration management.\n\n-It may be something classloader related\n-It may be the file exists (and is on the CP) but isnt readable. We could check\nin -diagnostics by doing a File.isReadable() on every JAR, flagging those that\narent actually legit", "id": 111305, "time": "2007-11-30T07:34:30Z", "creator": "stevel@apache.org", "creation_time": "2007-11-30T07:34:30Z", "tags": [], "is_private": false}, {"attachment_id": null, "tags": [], "creator": "stevel@apache.org", "text": "I'm planning to do this, by extending the error message in the exception:\n String msg = getTaskName() + \" class \" + classname\n                    + \" cannot be found\"\n                    + \"\\n using the classloader \"+al;\n\nAnt's own classloaders dump the classpath in toString(), and other classloaders\nwill return something meaningful. \n\nSeem good?", "count": 8, "id": 112879, "time": "2008-01-15T09:58:48Z", "bug_id": 43982, "creation_time": "2008-01-15T09:58:48Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 43982, "text": "looks good to me!", "id": 112884, "time": "2008-01-15T11:20:04Z", "creator": "hauser@acm.org", "creation_time": "2008-01-15T11:20:04Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 43982, "text": "svn revision 709762", "id": 122974, "time": "2008-12-01T21:27:57Z", "creator": "bodewig@apache.org", "creation_time": "2008-12-01T21:27:57Z", "is_private": false, "attachment_id": null}]