[{"count": 0, "tags": [], "creator": "dmitry@ardas.dp.ua", "attachment_id": null, "is_private": false, "id": 116060, "time": "2008-04-30T05:34:30Z", "bug_id": 44910, "creation_time": "2008-04-30T05:34:30Z", "text": "I tested application using JMeter TCP Sampler. This application closes session\nwhen TCP Socket is closed.\n\nBut when I use the isReUseConnection flag - new connection is started\nbut old socket doesn't closed until JMeter is not closed.\n\nTCPSampler closes connection in the finally block in the \"sample\" method if isReUseConnection set. But it closes new connection from the map but old connection is never closed.\n\nI think connection should be closed every time when new connection created in the getSocket(). I added closeSocket() method to the getSocket() method:\n\n  ...\n  try {    // line 141\n\tcloseSocket();\n\tcon = new Socket(getServer(), getPort());\n  ...\n\nand it works for me correctly.\n\nThank you.\n-- \nRegards,\nDmitry Kudrenko\nARDAS group http://ardas.dp.ua"}, {"count": 1, "tags": [], "bug_id": 44910, "text": "Good catch.\n\nFix applied to SVN:\n\nURL: http://svn.apache.org/viewvc?rev=652380&view=rev\nLog:\nBug 44910 - close previous socket (if any) in TCP Sampler\n", "id": 116063, "time": "2008-04-30T05:45:54Z", "creator": "sebb@apache.org", "creation_time": "2008-04-30T05:45:54Z", "is_private": false, "attachment_id": null}]