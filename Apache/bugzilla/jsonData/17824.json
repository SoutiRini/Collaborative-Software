[{"count": 0, "tags": [], "creator": "tdyildirim@yahoo.com", "is_private": false, "id": 32852, "attachment_id": null, "bug_id": 17824, "creation_time": "2003-03-10T12:59:25Z", "time": "2003-03-10T12:59:25Z", "text": "When i read a ms doc file with using HDF classes. I have got a big problem. If \nmy data is not unicode and contains english char then there is no problem. But \nwhen i use unicode or utf-8 charset then i have a big problem. because when we \nuse those type of charter string. It doesn't read all the data. it stopped to \nread some part of the data for example if i use something like inside of \ndemo.doc document:  \u00fd\u00fd\u00fc\u00fc \nthen when we read we got \u00fd\u00fd\u00fc\nand it is increasing like this.\n\ni will send my example given below\n\npublic class Deneme {\n\n\tpublic static void main(String[] args) {\n\t\t\n\ttestDoc deneme = new testDoc(\"demo.doc\",\"demo.txt\");\n\tdeneme.getText();\n\t}\n}\n\n-----------------------------\n//------- this code writes doc file to txt-----------\n//------go get hfd libs from jakarta.poi (scratchpad at the moment)-------------\n-------------------\n//------------------------------------------------------------------------------\n---------------\nimport org.apache.poi.hdf.extractor.util.*;\nimport org.apache.poi.hdf.extractor.data.*;\nimport org.apache.poi.hdf.extractor.*;\nimport java.util.*;\nimport java.io.*;\nimport javax.swing.*;\n\nimport java.awt.*;\n\nimport org.apache.poi.poifs.filesystem.POIFSFileSystem;\nimport org.apache.poi.poifs.filesystem.POIFSDocument;\nimport org.apache.poi.poifs.filesystem.DocumentEntry;\n\nimport org.apache.poi.util.LittleEndian;\n\nclass testDoc extends Deneme{\nString origFileName;\nString tempFile;\nWordDocument wd;\n\ntestDoc(String origFileName, String tempFile) {\nthis.tempFile=tempFile;\nthis.origFileName=origFileName;\n}\n\npublic void getText() {\ntry {\nwd = new WordDocument(origFileName);\n//Writer out = new BufferedWriter(new FileWriter(tempFile)); //eskisi\nWriter out = new OutputStreamWriter(new FileOutputStream(tempFile),\"utf-8\");\n\t\t\t\t\n            \n\nwd.writeAllText(out);\nout.flush();\nout.close();\n}\ncatch (Exception eN) {\nSystem.out.println(\"Error reading document:\"+origFileName+\"\\n\"+eN.toString());\n}\n} // end for getText\n\n} // end of class\n \n \n------------------------\nthe problem starts in \nwd.writeAllText(out);\nwhen we look at the this method we see that end integer doesn't get the end \npoint when we use unicode ms doc file..\n\nThank you for your supports."}, {"count": 1, "tags": [], "creator": "tdyildirim@yahoo.com", "text": "fixxed by Raghuram Velega\nI fixed the bug which was in the WordDocument.java class, replace the\nfollowing segemnt of the code:\n\n public void writeAllText(Writer out) throws IOException\n  {\n    int textStart = Utils.convertBytesToInt(_header, 0x18);\n    int textEnd = Utils.convertBytesToInt(_header, 0x1c);\n    ArrayList textPieces = findProperties(textStart, textEnd, \n_text.root);\n    int size = textPieces.size();\n\n\n    for(int x = 0; x < size ; x++)\n    {\n      TextPiece nextPiece = (TextPiece)textPieces.get(x);\n      int start = nextPiece.getStart();\n       int end = nextPiece.getEnd();\n       boolean unicode = nextPiece.usesUnicode();\n       char ch;\n       if(unicode){\n           for(int y = start; y < end +(end-start); y += 2){\n               ch = (char)Utils.convertBytesToShort(_header, y);\n               out.write(ch);\n            }\n\n       }else{\n            for(int y = start; y < end ; y += 1){\n                ch = (char) Utils.convertUnsignedByteToInt(_header[y]);\n                out.write(ch);\n            }\n       }\n    }\n\n\n  }\n\nIt should work then,\n\nthanks,\nraghu\n", "id": 33004, "time": "2003-03-12T05:43:13Z", "bug_id": 17824, "creation_time": "2003-03-12T05:43:13Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "poi-support@buni.org", "text": "Attach this as a patch per the instructions\nhttp://jakarta.apache.org/poi/getinvolved/index.html ", "count": 2, "id": 33027, "time": "2003-03-12T13:35:15Z", "bug_id": 17824, "creation_time": "2003-03-12T13:35:15Z", "is_private": false}, {"count": 3, "tags": [], "text": "it doesn't work long unicode word documents.\n", "attachment_id": null, "id": 33035, "creator": "tdyildirim@yahoo.com", "time": "2003-03-12T14:17:20Z", "bug_id": 17824, "creation_time": "2003-03-12T14:17:20Z", "is_private": false}, {"count": 4, "tags": [], "creator": "dfisher@jmlafferty.com", "text": "HDF is not currently supported.", "id": 132156, "time": "2009-11-19T21:18:29Z", "bug_id": 17824, "creation_time": "2009-11-19T21:18:29Z", "is_private": false, "attachment_id": null}]