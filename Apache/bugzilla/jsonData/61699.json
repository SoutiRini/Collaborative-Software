[{"attachment_id": 35476, "tags": [], "bug_id": 61699, "text": "Created attachment 35476\nEmpty workbook with a hidden workbook view\n\nFrom Users@POI mailing list: https://lists.apache.org/thread.html/4c6b6800d165d90374d3ad3ea49bbd1509c3a4d0dc093d0f1d597965@%3Cuser.poi.apache.org%3E\n\nI was able to create a hidden window in Microsoft Excel 2013 only when there were multiple views of a workbook open.\nView > Window > New Window to create a 2nd view of the active workbook\nView > Window > Hide to hide the active view of the active workbook\n\nIn the XML:\nxl/workbook.xml:\n <workbook xmlns=\"...\" ...>\n     ...\n     <bookViews>\n         <workbookView xWindow=\"0\" yWindow=\"0\" windowWidth=\"16920\" windowHeight=\"10980\"/>\n+        <workbookView visibility=\"hidden\" xWindow=\"0\" yWindow=\"0\" windowWidth=\"16920\" windowHeight=\"10980\"/>\n     </bookViews>\n     ...\n </workbook>\n\nxl/worksheets/sheet1.xml:\n <worksheet xmlns=\"...\" ...>\n     ...\n     <sheetViews>\n         <sheetView tabSelected=\"1\" workbookViewId=\"0\"/>\n+        <sheetView tabSelected=\"1\" workbookViewId=\"1\"/>\n     </sheetViews>\n     ...\n </worksheet>", "count": 0, "id": 201799, "time": "2017-10-31T00:46:09Z", "creator": "onealj@apache.org", "creation_time": "2017-10-31T00:46:09Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 61699, "attachment_id": null, "id": 201801, "time": "2017-10-31T01:36:59Z", "creator": "onealj@apache.org", "creation_time": "2017-10-31T01:36:59Z", "is_private": false, "text": "HSSFWorkbook implemented isHidden/setHidden as the visibility of the first workbook view (InternalWorkbook.getWindowOne().getHidden()).\n\nThe correct behavior would seem to let the user specify the index of the window (view) and return the visibility of that window (view).\n\nPOI currently doesn't have functions for creating workbook views.\n\nBeing that Microsoft Excel doesn't allow you to hide every window view of a workbook, it's likely you'll end up with a corrupt workbook if you hide the only view on a workbook."}, {"count": 2, "tags": [], "text": "Created attachment 35477\nPatch to add isHidden(), setHidden(boolean), isHidden(int), setHidden(int, boolean)\n\nBeing able to set workbook window views as hidden isn't very useful without being able to create and delete workbook views.\n\nThis gets more complicated because of bookviews and sheetviews\n\n> CTWorkbook.getBookViews().addNewWorkbookView();\n> CTWorkbook.getBookViews().removeWorkbookView(int i);\n\nhttp://www.datypic.com/sc/ooxml/e-ssml_workbookView-1.html\nhttp://www.datypic.com/sc/ooxml/e-ssml_customWorkbookView-1.html\nhttp://www.datypic.com/sc/ooxml/a-visibility-1.html", "attachment_id": 35477, "id": 201802, "creator": "onealj@apache.org", "time": "2017-10-31T02:27:20Z", "bug_id": 61699, "creation_time": "2017-10-31T02:27:20Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 61699, "attachment_id": null, "id": 201825, "time": "2017-10-31T15:45:23Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2017-10-31T15:45:23Z", "is_private": false, "text": "Comments from Mark:\n\nIn my testing, Excel 2016, I can hide a workbook by selecting View->Hide. I can do that even if it is the only workbook open. The XML is in workbook.xml and looks like this:\n\n<bookViews>\n   <workbookView windowHeight=\"9600\" windowWidth=\"17595\" yWindow=\"255\" xWindow=\"225\" visibility=\"hidden\"/>\n</bookViews>\n\nI can close out of Excel with the only workbook hidden, and it allows me to save it as hidden. When I re-open that workbook, it starts out hidden.\n---------------------------------------------------------------------\nFor sheets, once again Excel 2016, I cannot hide the last visible sheet. So it appears that Excel handles Sheets and workbooks differently. One potential reason to have hidden workbooks is if you have a workbook with just macros in it, and you have that in your XLSTART library [User library]/AppData/Roaming/Microsoft/Excel/XLSTART, then that workbook will open every time you open Excel, and you really want that workbook to be hidden, but open with no visible window views."}]