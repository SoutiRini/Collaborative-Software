[{"count": 0, "tags": [], "creator": "llefevre@fivia.com", "text": "--- HSSFCell.java       Wed Mar 13 17:53:21 2002\n+++ HSSFCellNew.java    Wed Mar 13 17:53:02 2002\n@@ -72,6 +72,7 @@\n import org.apache.poi.hssf.record.ExtendedFormatRecord;\n\n import java.util.Date;\n+import java.util.Calendar;\n\n /**\n  * High level representation of a cell in a row of a spreadsheet.\n@@ -631,6 +632,19 @@\n     public void setCellValue(Date value)\n     {\n         setCellValue(HSSFDateUtil.getExcelDate(value));\n+    }\n+\n+    /**\n+     * set a date value for the cell. Excel treats dates as numeric so you\nwill need to format the cell as\n+     * a date.\n+     *\n+     * @param value  the date value to set this cell to.  For formulas\nwe'll set the\n+     *        precalculated value, for numerics we'll set its value. For\nothertypes we\n+     *        will change the cell to a numeric cell and set its value.\n+     */\n+    public void setCellValue(Calendar value)\n+    {\n+        setCellValue(value.getTime());\n     }\n\n     /**", "id": 11791, "time": "2002-03-14T14:30:08Z", "bug_id": 7119, "creation_time": "2002-03-14T14:30:08Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "llefevre@fivia.com", "text": "cvs server: Diffing .\ncvs server: Diffing build\ncvs server: Diffing legal\ncvs server: Diffing lib\ncvs server: Diffing lib/core\ncvs server: Diffing lib/optional\ncvs server: Diffing src\ncvs server: Diffing src/contrib\ncvs server: Diffing src/contrib/lib\ncvs server: Diffing src/contrib/src\ncvs server: Diffing src/contrib/src/org\ncvs server: Diffing src/contrib/src/org/apache\ncvs server: Diffing src/contrib/src/org/apache/poi\ncvs server: Diffing src/contrib/src/org/apache/poi/contrib\ncvs server: Diffing src/contrib/src/org/apache/poi/contrib/poibrowser\ncvs server: Diffing src/contrib/targets\ncvs server: Diffing src/documentation\ncvs server: Diffing src/documentation/images\ncvs server: Diffing src/documentation/stylesheets\ncvs server: Diffing src/documentation/stylesheets/printer_skin\ncvs server: Diffing src/documentation/xdocs\ncvs server: Diffing src/documentation/xdocs/dtd\ncvs server: Diffing src/documentation/xdocs/hdf\ncvs server: Diffing src/documentation/xdocs/hpsf\ncvs server: Diffing src/documentation/xdocs/hssf\ncvs server: Diffing src/documentation/xdocs/plan\ncvs server: Diffing src/documentation/xdocs/poifs\ncvs server: Diffing src/documentation/xdocs/poifs/html\ncvs server: Diffing src/documentation/xdocs/resolutions\ncvs server: Diffing src/documentation/xdocs/utils\ncvs server: Diffing src/examples\ncvs server: Diffing src/examples/src\ncvs server: Diffing src/examples/src/org\ncvs server: Diffing src/examples/src/org/apache\ncvs server: Diffing src/examples/src/org/apache/poi\ncvs server: Diffing src/examples/src/org/apache/poi/hssf\ncvs server: Diffing src/examples/src/org/apache/poi/hssf/usermodel\ncvs server: Diffing src/examples/src/org/apache/poi/hssf/usermodel/examples\ncvs server: Diffing src/java\ncvs server: Diffing src/java/org\ncvs server: Diffing src/java/org/apache\ncvs server: Diffing src/java/org/apache/poi\ncvs server: Diffing src/java/org/apache/poi/hdf\ncvs server: Diffing src/java/org/apache/poi/hpsf\ncvs server: Diffing src/java/org/apache/poi/hpsf/littleendian\ncvs server: Diffing src/java/org/apache/poi/hpsf/wellknown\ncvs server: Diffing src/java/org/apache/poi/hssf\ncvs server: Diffing src/java/org/apache/poi/hssf/dev\ncvs server: Diffing src/java/org/apache/poi/hssf/eventmodel\ncvs server: Diffing src/java/org/apache/poi/hssf/model\ncvs server: Diffing src/java/org/apache/poi/hssf/record\ncvs server: Diffing src/java/org/apache/poi/hssf/record/aggregates\ncvs server: Diffing src/java/org/apache/poi/hssf/record/formula\ncvs server: Diffing src/java/org/apache/poi/hssf/usermodel\nIndex: src/java/org/apache/poi/hssf/usermodel/HSSFCell.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-\npoi/src/java/org/apache/poi/hssf/usermodel/HSSFCell.java,v\nretrieving revision 1.3\ndiff -u -r1.3 HSSFCell.java\n--- src/java/org/apache/poi/hssf/usermodel/HSSFCell.java\t12 Feb 2002 \n02:19:12 -0000\t1.3\n+++ src/java/org/apache/poi/hssf/usermodel/HSSFCell.java\t14 Mar 2002 \n15:16:57 -0000\n@@ -72,6 +72,7 @@\n import org.apache.poi.hssf.record.ExtendedFormatRecord;\n \n import java.util.Date;\n+import java.util.Calendar;\n \n /**\n  * High level representation of a cell in a row of a spreadsheet.\n@@ -631,6 +632,19 @@\n     public void setCellValue(Date value)\n     {\n         setCellValue(HSSFDateUtil.getExcelDate(value));\n+    }\n+\n+    /**\n+     * set a date value for the cell. Excel treats dates as numeric so you \nwill need to format the cell as\n+     * a date.\n+     *\n+     * @param value  the date value to set this cell to.  For formulas we'll \nset the\n+     *        precalculated value, for numerics we'll set its value. For other \ntypes we\n+     *        will change the cell to a numeric cell and set its value.\n+     */\n+    public void setCellValue(Calendar value)\n+    {\n+        setCellValue(value.getTime());\n     }\n \n     /**\ncvs server: Diffing src/java/org/apache/poi/hssf/util\ncvs server: Diffing src/java/org/apache/poi/poifs\ncvs server: Diffing src/java/org/apache/poi/poifs/common\ncvs server: Diffing src/java/org/apache/poi/poifs/dev\ncvs server: Diffing src/java/org/apache/poi/poifs/eventfilesystem\ncvs server: Diffing src/java/org/apache/poi/poifs/filesystem\ncvs server: Diffing src/java/org/apache/poi/poifs/property\ncvs server: Diffing src/java/org/apache/poi/poifs/storage\ncvs server: Diffing src/java/org/apache/poi/util\ncvs server: Diffing src/models\ncvs server: Diffing src/records\ncvs server: Diffing src/records/definitions\ncvs server: Diffing src/records/styles\ncvs server: Diffing src/resources\ncvs server: Diffing src/resources/devtools\ncvs server: Diffing src/resources/entities\ncvs server: Diffing src/resources/entities/catalog-demo\ncvs server: Diffing src/scratchpad\ncvs server: Diffing src/scratchpad/lib\ncvs server: Diffing src/scratchpad/src\ncvs server: Diffing src/scratchpad/src/org\ncvs server: Diffing src/scratchpad/src/org/apache\ncvs server: Diffing src/scratchpad/src/org/apache/poi\ncvs server: Diffing src/scratchpad/src/org/apache/poi/generator\ncvs server: Diffing src/scratchpad/src/org/apache/poi/hdf\ncvs server: Diffing src/scratchpad/src/org/apache/poi/hdf/extractor\ncvs server: Diffing src/scratchpad/src/org/apache/poi/hdf/extractor/data\ncvs server: Diffing src/scratchpad/src/org/apache/poi/hdf/extractor/util\ncvs server: Diffing src/scratchpad/src/org/apache/poi/hdf/model\ncvs server: Diffing src/scratchpad/src/org/apache/poi/hdf/model/hdftypes\ncvs server: Diffing src/scratchpad/targets\ncvs server: Diffing src/targets\ncvs server: Diffing src/testcases\ncvs server: Diffing src/testcases/org\ncvs server: Diffing src/testcases/org/apache\ncvs server: Diffing src/testcases/org/apache/poi\ncvs server: Diffing src/testcases/org/apache/poi/hssf\ncvs server: Diffing src/testcases/org/apache/poi/hssf/data\ncvs server: Diffing src/testcases/org/apache/poi/hssf/record\ncvs server: Diffing src/testcases/org/apache/poi/hssf/usermodel\nIndex: src/testcases/org/apache/poi/hssf/usermodel/TestCellStyle.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-\npoi/src/testcases/org/apache/poi/hssf/usermodel/TestCellStyle.java,v\nretrieving revision 1.4\ndiff -u -r1.4 TestCellStyle.java\n--- src/testcases/org/apache/poi/hssf/usermodel/TestCellStyle.java\t18 Feb \n2002 11:59:08 -0000\t1.4\n+++ src/testcases/org/apache/poi/hssf/usermodel/TestCellStyle.java\t14 Mar \n2002 15:17:00 -0000\n@@ -135,7 +135,7 @@\n     }\n \n     /**\n-     * Tests that is creating a file with a date works correctly.\n+     * Tests that is creating a file with a date or an calendar works \ncorrectly.\n      */\n     public void testDataStyle()\n             throws Exception\n@@ -147,10 +147,21 @@\n         HSSFSheet        s    = wb.createSheet();\n         HSSFCellStyle    cs   = wb.createCellStyle();\n         HSSFRow row = s.createRow((short)0);\n+\n+        // with Date:\n         HSSFCell cell = row.createCell((short)1);\n         cs.setDataFormat(HSSFDataFormat.getFormat(\"m/d/yy\"));\n         cell.setCellStyle(cs);\n         cell.setCellValue(new Date());\n+\n+        // with Calendar:\n+        cell = row.createCell((short)2);\n+        cs.setDataFormat(HSSFDataFormat.getFormat(\"m/d/yy\"));\n+        cell.setCellStyle(cs);\n+        Calendar cal = Calendar.getInstance();\n+        cal.setTime(new Date());\n+        cell.setCellValue(cal);\n+\n         wb.write(out);\n         out.close();\n \ncvs server: Diffing src/testcases/org/apache/poi/poifs\ncvs server: Diffing src/testcases/org/apache/poi/poifs/eventfilesystem\ncvs server: Diffing src/testcases/org/apache/poi/poifs/filesystem\ncvs server: Diffing src/testcases/org/apache/poi/poifs/property\ncvs server: Diffing src/testcases/org/apache/poi/poifs/storage\ncvs server: Diffing src/testcases/org/apache/poi/util\ncvs server: Diffing src/testcases/org/apache/poi/util/data\ncvs server: Diffing tools\ncvs server: Diffing tools/ant\ncvs server: Diffing tools/ant/bin\ncvs server: Diffing tools/ant/lib\ncvs server: Diffing tools/centipede\ncvs server: Diffing tools/centipede/lib\ncvs server: Diffing tools/centipede/src\ncvs server: Diffing tools/centipede/src/java\ncvs server: Diffing tools/centipede/src/resources\ncvs server: Diffing tools/centipede/src/resources/stylesheets\ncvs server: Diffing tools/centipede/targets\ncvs server: Diffing tools/cocoon\ncvs server: Diffing tools/cocoon/conf\ncvs server: Diffing tools/cocoon/lib\ncvs server: Diffing tools/lib\ncvs server: Diffing tools/targets\ncvs server: Diffing tools/targets/deprecated", "id": 11796, "time": "2002-03-14T15:20:36Z", "bug_id": 7119, "creation_time": "2002-03-14T15:20:36Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 7119, "attachment_id": null, "id": 11826, "time": "2002-03-15T02:49:11Z", "creator": "poi-support@buni.org", "creation_time": "2002-03-15T02:49:11Z", "is_private": false, "text": "applied --  Please add yourself to the authors tags at the top of the class when\nsubmitting patches in the future.  Thanks!"}]