[{"count": 0, "tags": [], "bug_id": 49253, "attachment_id": null, "id": 136647, "time": "2010-05-05T10:19:53Z", "creator": "thomas.herre@abosco.com", "creation_time": "2010-05-05T10:19:53Z", "is_private": false, "text": "I have an XSSFWorkbook in which I set the page/print orientation to landscape and set one row/some columns to repeat on each page. After setting the repeating rows and columns, Excel displays orientation portrait instead of the desired landscape.\n\nTest code:\n\n        Workbook workbook = new XSSFWorkbook();\n        Sheet sheet = workbook.createSheet();\n        \n        Row row = sheet.createRow(0);\n        Cell cell = row.createCell(0);\n        cell.setCellValue(\"1\");\n        cell = row.createCell(1);\n        cell.setCellValue(\"2\");\n        cell = row.createCell(2);\n        \n        PrintSetup printSetup = sheet.getPrintSetup();\n        printSetup.setLandscape(true);\n        \n        workbook.setRepeatingRowsAndColumns(0, 0, 1, 0, 0);\n        // printSetup.setValidSettings(true);\n        \n        workbook.write(new FileOutputStream(new File(\"test-landscape.xlsx\")));\n\nNow open the file in Excel and check the page settings. \nIt displays \"portrait\". That's wrong!\n\nNow, if you comment in the line: \nprintSetup.setValidSettings(true);\nand run the test again, the resulting file shows \"landscape\" again. Correct.\n\nLooking into the sources, I found that in the last statement of method setRepeatingRowsAndColumns, printSetup.setValidSettings(false); is called,\nwhich led me to the described workaround."}, {"count": 1, "tags": [], "text": "Created attachment 25401\nWorkbook with wrong orientation", "is_private": false, "bug_id": 49253, "id": 136648, "time": "2010-05-05T10:22:42Z", "creator": "thomas.herre@abosco.com", "creation_time": "2010-05-05T10:22:42Z", "attachment_id": 25401}, {"count": 2, "tags": [], "bug_id": 49253, "attachment_id": 25402, "id": 136649, "time": "2010-05-05T10:23:47Z", "creator": "thomas.herre@abosco.com", "creation_time": "2010-05-05T10:23:47Z", "is_private": false, "text": "Created attachment 25402\nWorkbook with correct orientation\n\nThis workbook was created using the workaround as described in the bug report."}, {"attachment_id": null, "tags": [], "bug_id": 49253, "is_private": false, "count": 3, "id": 145089, "time": "2011-03-18T12:06:37Z", "creator": "apache@gagravarr.org", "creation_time": "2011-03-18T12:06:37Z", "text": "Filip Defoort reported much the same thing on the mailing list last week. Based on his postings, and this bug report, I think I've fixed this in r1082961 (along with a unit test)."}, {"count": 4, "tags": [], "bug_id": 49253, "attachment_id": null, "text": "Thanks for fixing this one - I was just gettin' around to actually filing a bug for it !\n\n- Filip", "id": 145424, "time": "2011-03-30T18:57:47Z", "creator": "filipdef@cirquedigital.com", "creation_time": "2011-03-30T18:57:47Z", "is_private": false}]