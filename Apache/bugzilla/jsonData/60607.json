[{"count": 0, "tags": [], "bug_id": 60607, "text": "Created attachment 34648\nTest Plan showing issue\n\nAs reported in Bug 57447 by Sean Chang, a regression has been introduced in version 3.0 of JMeter related to migration to HttpCLient 4.5.2", "id": 196199, "time": "2017-01-19T17:01:49Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2017-01-19T17:01:49Z", "is_private": false, "attachment_id": 34648}, {"count": 1, "tags": [], "text": "Author: pmouawad\nDate: Thu Jan 19 17:11:07 2017\nNew Revision: 1779498\n\nURL: http://svn.apache.org/viewvc?rev=1779498&view=rev\nLog:\nBug 60607 - DNS Cache Manager configuration is ignored\nBugzilla Id: 60607\n\nAdded:\n    jmeter/trunk/bin/testfiles/Bug60607.csv\n    jmeter/trunk/bin/testfiles/Bug60607.jmx\n    jmeter/trunk/bin/testfiles/Bug60607.xml   (with props)\nModified:\n    jmeter/trunk/build.xml\n    jmeter/trunk/src/protocol/http/org/apache/http/impl/conn/JMeterPoolingClientConnectionManager.java\n    jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/sampler/MeasuringConnectionManager.java\n    jmeter/trunk/xdocs/changes.xml", "is_private": false, "id": 196214, "creator": "p.mouawad@ubik-ingenierie.com", "time": "2017-01-19T20:41:34Z", "bug_id": 60607, "creation_time": "2017-01-19T20:41:34Z", "attachment_id": null}, {"count": 2, "tags": [], "text": "@Sean,\nCould you test nightly build ?:\n\n-http://jmeter.apache.org/nightly.html\n\nThank you", "is_private": false, "id": 196215, "creator": "p.mouawad@ubik-ingenierie.com", "time": "2017-01-19T20:42:56Z", "bug_id": 60607, "creation_time": "2017-01-19T20:42:56Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 60607, "text": "Author: pmouawad\nDate: Thu Jan 19 21:02:25 2017\nNew Revision: 1779526\n\nURL: http://svn.apache.org/viewvc?rev=1779526&view=rev\nLog:\nBug 60607 - DNS Cache Manager configuration is ignored\nAdd test case for SystemDnsResolver\nBugzilla Id: 60607\n\nModified:\n    jmeter/trunk/bin/testfiles/Bug60607.csv\n    jmeter/trunk/bin/testfiles/Bug60607.jmx\n    jmeter/trunk/bin/testfiles/Bug60607.xml", "id": 196217, "time": "2017-01-19T21:02:51Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2017-01-19T21:02:51Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 60607, "attachment_id": null, "is_private": false, "id": 196289, "time": "2017-01-22T18:31:12Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2017-01-22T18:31:12Z", "text": "Hello Sean,\nAny feedback on fix ?\nThanks"}, {"count": 5, "attachment_id": null, "bug_id": 60607, "text": "(In reply to Philippe Mouawad from comment #4)\n> Hello Sean,\n> Any feedback on fix ?\n> Thanks\n\nJust tried r1779550. It works fine for DNS Cache Manager issue.\nThanks a lot for your fix!\nSorry for too late, having a fever for several days...", "id": 196355, "time": "2017-01-24T05:06:32Z", "creator": "s16260063@hotmail.com", "creation_time": "2017-01-24T05:06:32Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "text": "(In reply to Sean Chang from comment #5)\n> (In reply to Philippe Mouawad from comment #4)\n> > Hello Sean,\n> > Any feedback on fix ?\n> > Thanks\n> \n> Just tried r1779550. It works fine for DNS Cache Manager issue.\n> Thanks a lot for your fix!\n> Sorry for too late, having a fever for several days...\n\nThanks for your feedback .", "is_private": false, "id": 196374, "creator": "p.mouawad@ubik-ingenierie.com", "time": "2017-01-24T19:31:26Z", "bug_id": 60607, "creation_time": "2017-01-24T19:31:26Z", "attachment_id": null}, {"count": 7, "tags": [], "text": "Hi Philippe\uff0c\n\nSorry for one more question:\n\nCan I just replace JMeter 3.0 with your jmeter/trunk/src/protocol/http/org/apache/http/impl/conn/JMeterPoolingClientConnectionManager.java and jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/sampler/MeasuringConnectionManager.java to make DNS Cache Manager work?\n\nThe nightly build seems to be not stable for request sending and print many warnings. I guess they are not related to DNS. I can use it to verify your fix but can not use it for load test.\n\nThanks.", "is_private": false, "bug_id": 60607, "id": 196438, "time": "2017-01-26T04:11:18Z", "creator": "s16260063@hotmail.com", "creation_time": "2017-01-26T04:11:18Z", "attachment_id": null}, {"count": 8, "tags": [], "text": "Hello, \nNo you can't.\nWhat are the warnings you see ?\nCan you attach jmeter.log ?\nNighlty build of today should be stable if you downloaded it from jenkins.\n\nThanks", "is_private": false, "id": 196439, "creator": "p.mouawad@ubik-ingenierie.com", "time": "2017-01-26T05:59:28Z", "bug_id": 60607, "creation_time": "2017-01-26T05:59:28Z", "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 60607, "text": "Some JMeter warnings like...\n\nJan 25, 2017 11:03:46 PM java.util.prefs.FileSystemPreferences checkLockFile0ErrorCode\nWARNING: Could not lock User prefs.  Unix error code 24.\nJan 25, 2017 11:03:47 PM java.util.prefs.FileSystemPreferences syncWorld\nWARNING: Couldn't flush user prefs: java.util.prefs.BackingStoreException: Couldn't get file lock.\nJan 25, 2017 11:07:46 PM java.util.prefs.FileSystemPreferences checkLockFile0ErrorCode\nWARNING: Could not lock User prefs.  Unix error code 24.\nJan 25, 2017 11:07:46 PM java.util.prefs.FileSystemPreferences syncWorld\nWARNING: Couldn't flush user prefs: java.util.prefs.BackingStoreException: Couldn't get file lock.", "id": 196440, "time": "2017-01-26T07:11:47Z", "creator": "s16260063@hotmail.com", "creation_time": "2017-01-26T07:11:47Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 60607, "attachment_id": null, "id": 196441, "time": "2017-01-26T07:12:22Z", "creator": "s16260063@hotmail.com", "creation_time": "2017-01-26T07:12:22Z", "is_private": false, "text": "And some request failed due to file not found, but actually the file is there and succeed for some other requests.\n\njava.io.FileNotFoundException: /home/cosben/cos_upload/2bill/200K.ts (Too many open files)\n\tat java.io.FileInputStream.open0(Native Method)\n\tat java.io.FileInputStream.open(FileInputStream.java:195)\n\tat java.io.FileInputStream.<init>(FileInputStream.java:138)\n\tat org.apache.http.entity.FileEntity.getContent(FileEntity.java:88)\n\tat org.apache.jmeter.protocol.http.sampler.HTTPHC4Impl.sendEntityData(HTTPHC4Impl.java:1459)\n\tat org.apache.jmeter.protocol.http.sampler.HTTPHC4Impl.handleMethod(HTTPHC4Impl.java:585)\n\tat org.apache.jmeter.protocol.http.sampler.HTTPHC4Impl.sample(HTTPHC4Impl.java:399)\n\tat org.apache.jmeter.protocol.http.sampler.HTTPSamplerProxy.sample(HTTPSamplerProxy.java:74)\n\tat org.apache.jmeter.protocol.http.sampler.HTTPSamplerBase.sample(HTTPSamplerBase.java:1176)\n\tat org.apache.jmeter.protocol.http.sampler.HTTPSamplerBase.sample(HTTPSamplerBase.java:1165)\n\tat org.apache.jmeter.threads.JMeterThread.executeSamplePackage(JMeterThread.java:473)\n\tat org.apache.jmeter.threads.JMeterThread.processSampler(JMeterThread.java:416)\n\tat org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:252)\n\tat java.lang.Thread.run(Thread.java:745)"}, {"count": 11, "tags": [], "bug_id": 60607, "attachment_id": null, "text": "(In reply to Sean Chang from comment #9)\n> Some JMeter warnings like...\n> \n> Jan 25, 2017 11:03:46 PM java.util.prefs.FileSystemPreferences\n> checkLockFile0ErrorCode\n> WARNING: Could not lock User prefs.  Unix error code 24.\n> Jan 25, 2017 11:03:47 PM java.util.prefs.FileSystemPreferences syncWorld\n> WARNING: Couldn't flush user prefs: java.util.prefs.BackingStoreException:\n> Couldn't get file lock.\n> Jan 25, 2017 11:07:46 PM java.util.prefs.FileSystemPreferences\n> checkLockFile0ErrorCode\n> WARNING: Could not lock User prefs.  Unix error code 24.\n> Jan 25, 2017 11:07:46 PM java.util.prefs.FileSystemPreferences syncWorld\n> WARNING: Couldn't flush user prefs: java.util.prefs.BackingStoreException:\n> Couldn't get file lock.\n\nHello,\nThis one is a java bug on linux systems, see:\nhttp://jmeter.apache.org/changes.html => Known problems and workarounds", "id": 196442, "time": "2017-01-26T07:59:09Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2017-01-26T07:59:09Z", "is_private": false}, {"count": 12, "tags": [], "text": "(In reply to Sean Chang from comment #10)\n> And some request failed due to file not found, but actually the file is\n> there and succeed for some other requests.\n> \n> java.io.FileNotFoundException: /home/cosben/cos_upload/2bill/200K.ts (Too\n> many open files)\n> \tat java.io.FileInputStream.open0(Native Method)\n> \tat java.io.FileInputStream.open(FileInputStream.java:195)\n> \tat java.io.FileInputStream.<init>(FileInputStream.java:138)\n> \tat org.apache.http.entity.FileEntity.getContent(FileEntity.java:88)\n> \tat\n> org.apache.jmeter.protocol.http.sampler.HTTPHC4Impl.\n> sendEntityData(HTTPHC4Impl.java:1459)\n> \tat\n> org.apache.jmeter.protocol.http.sampler.HTTPHC4Impl.handleMethod(HTTPHC4Impl.\n> java:585)\n> \tat\n> org.apache.jmeter.protocol.http.sampler.HTTPHC4Impl.sample(HTTPHC4Impl.java:\n> 399)\n> \tat\n> org.apache.jmeter.protocol.http.sampler.HTTPSamplerProxy.\n> sample(HTTPSamplerProxy.java:74)\n> \tat\n> org.apache.jmeter.protocol.http.sampler.HTTPSamplerBase.\n> sample(HTTPSamplerBase.java:1176)\n> \tat\n> org.apache.jmeter.protocol.http.sampler.HTTPSamplerBase.\n> sample(HTTPSamplerBase.java:1165)\n> \tat\n> org.apache.jmeter.threads.JMeterThread.executeSamplePackage(JMeterThread.\n> java:473)\n> \tat\n> org.apache.jmeter.threads.JMeterThread.processSampler(JMeterThread.java:416)\n> \tat org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:252)\n> \tat java.lang.Thread.run(Thread.java:745)\n\nThis does not mean the file is not here, it means you reach a linux limit on file descriptors.\nIf you don't hit this with the other version of JMeter then it could be a jmeter issue but it's not sure.\nhttps://easyengine.io/tutorials/linux/increase-open-files-limit/\n\n\n1/ Run ulimit -a with the user that runs jmeter .\n2/ How many threads are you running ?\nDid you compare versions of JMeter with exactly the same script and user.properties/jmeter.properties ?\nThank you", "is_private": false, "bug_id": 60607, "id": 196443, "time": "2017-01-26T08:02:55Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2017-01-26T08:02:55Z", "attachment_id": null}, {"count": 13, "tags": [], "bug_id": 60607, "attachment_id": null, "text": "1)$ ulimit -a\ncore file size          (blocks, -c) 0\ndata seg size           (kbytes, -d) unlimited\nscheduling priority             (-e) 0\nfile size               (blocks, -f) unlimited\npending signals                 (-i) 386013\nmax locked memory       (kbytes, -l) 64\nmax memory size         (kbytes, -m) unlimited\nopen files                      (-n) 1024\npipe size            (512 bytes, -p) 8\nPOSIX message queues     (bytes, -q) 819200\nreal-time priority              (-r) 0\nstack size              (kbytes, -s) 8192\ncpu time               (seconds, -t) unlimited\nmax user processes              (-u) 4096\nvirtual memory          (kbytes, -v) unlimited\nfile locks                      (-x) unlimited\n\n2)the running threads is 100\n\n3)I did not compare any version, I just using latest nightly build from Jenkins and modify HEAP and NEW size. What kind of version do you want me to compare?\n\nWhen I tried same test plan on 2.13, I did not remember we meet this issue.", "id": 196447, "time": "2017-01-26T09:45:43Z", "creator": "s16260063@hotmail.com", "creation_time": "2017-01-26T09:45:43Z", "is_private": false}, {"count": 14, "tags": [], "text": "(In reply to Sean Chang from comment #13)\n> 1)$ ulimit -a\n> core file size          (blocks, -c) 0\n> data seg size           (kbytes, -d) unlimited\n> scheduling priority             (-e) 0\n> file size               (blocks, -f) unlimited\n> pending signals                 (-i) 386013\n> max locked memory       (kbytes, -l) 64\n> max memory size         (kbytes, -m) unlimited\n> open files                      (-n) 1024\n> pipe size            (512 bytes, -p) 8\n> POSIX message queues     (bytes, -q) 819200\n> real-time priority              (-r) 0\n> stack size              (kbytes, -s) 8192\n> cpu time               (seconds, -t) unlimited\n> max user processes              (-u) 4096\n> virtual memory          (kbytes, -v) unlimited\n> file locks                      (-x) unlimited\n> \n> 2)the running threads is 100\n> \n> 3)I did not compare any version, I just using latest nightly build from\n> Jenkins and modify HEAP and NEW size. What kind of version do you want me to\n> compare?\n> \n> When I tried same test plan on 2.13, I did not remember we meet this issue.\n\n1/ Would you mind checking again on 2.13 ?\nWe just want to be sure there is no regression in 3.2\n2/ Then run with nighlty build and do a \nlsof -p <pid of jmeter> \n\nThank you", "attachment_id": null, "id": 196451, "creator": "p.mouawad@ubik-ingenierie.com", "time": "2017-01-26T13:18:04Z", "bug_id": 60607, "creation_time": "2017-01-26T13:18:04Z", "is_private": false}, {"count": 15, "tags": [], "text": "(In reply to Sean Chang from comment #10)\n> And some request failed due to file not found, but actually the file is\n> there and succeed for some other requests.\n> \n> java.io.FileNotFoundException: /home/cosben/cos_upload/2bill/200K.ts (Too\n> many open files)\n> \tat java.io.FileInputStream.open0(Native Method)\n> \tat java.io.FileInputStream.open(FileInputStream.java:195)\n> \tat java.io.FileInputStream.<init>(FileInputStream.java:138)\n> \tat org.apache.http.entity.FileEntity.getContent(FileEntity.java:88)\n> \tat\n> org.apache.jmeter.protocol.http.sampler.HTTPHC4Impl.\n> sendEntityData(HTTPHC4Impl.java:1459)\n> \tat\n\nThat should be fixed with https://bz.apache.org/bugzilla/show_bug.cgi?id=60652\n\nCould you try the next nightly?\n\nThanks,\n Felix", "is_private": false, "id": 196467, "creator": "felix.schumacher@internetallee.de", "time": "2017-01-26T19:35:32Z", "bug_id": 60607, "creation_time": "2017-01-26T19:35:32Z", "attachment_id": null}, {"count": 16, "tags": [], "text": "Yes, did not see this problem on r1780487. Thanks Felix.", "is_private": false, "id": 196479, "creator": "s16260063@hotmail.com", "time": "2017-01-27T02:36:28Z", "bug_id": 60607, "creation_time": "2017-01-27T02:36:28Z", "attachment_id": null}, {"count": 17, "attachment_id": null, "bug_id": 60607, "text": "Hi Philippe,\n\nSince this issue is fixed on latest nightly build as Felix's comments, I will not try 2.13 again.\nThanks for your help.", "id": 196480, "time": "2017-01-27T02:38:54Z", "creator": "s16260063@hotmail.com", "creation_time": "2017-01-27T02:38:54Z", "tags": [], "is_private": false}]