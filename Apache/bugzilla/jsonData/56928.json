[{"count": 0, "tags": [], "text": "Picture resizing does not seem to work with windows meta files (WMF). The following is a reproducible example:\n\nWorkbook workbook = new XSSFWorkbook(); // could also use HSSF\nSheet sheet = workbook.createSheet(\"test\");\nName name = workbook.createName();\nname.setNameName(\"test\");\nname.setRefersToFormula(\"test!$A$1:$C$6\");\n        \nAreaReference aref = new AreaReference(name.getRefersToFormula());\nCellReference topLeft = aref.getFirstCell();\nCellReference bottomRight = aref.getLastCell();\n\nint imageType = Workbook.PICTURE_TYPE_WMF;\n\nInputStream is = new FileInputStream(new File(\"/home/mstuder/test.wmf\"));\nbyte[] bytes = IOUtils.toByteArray(is);\nint imageIndex = workbook.addPicture(bytes, imageType);\nis.close();\n\nDrawing drawing = sheet.createDrawingPatriarch();\nCreationHelper helper = workbook.getCreationHelper();\nClientAnchor anchor = helper.createClientAnchor();\nanchor.setRow1(topLeft.getRow());\nanchor.setCol1(topLeft.getCol());\nanchor.setRow2(bottomRight.getRow() + 1);\nanchor.setCol2(bottomRight.getCol() + 1);\nanchor.setAnchorType(ClientAnchor.DONT_MOVE_AND_RESIZE);\n\nPicture picture = drawing.createPicture(anchor, imageIndex);\npicture.resize();\n        \nworkbook.write(new FileOutputStream(new File(\"/home/mstuder/test.xlsx\")));\n\n\nWhen commenting out picture.resize() the picture is added properly with the size of the named range \"test\". Including picture.resize(), no image is added at all. Picture resizing works fine with other image types such as jpeg and png.", "attachment_id": null, "bug_id": 56928, "id": 177627, "time": "2014-09-08T13:51:59Z", "creator": "martin.studer@mirai-solutions.com", "creation_time": "2014-09-08T13:51:59Z", "is_private": false}]