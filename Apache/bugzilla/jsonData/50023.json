[{"attachment_id": 26099, "tags": [], "bug_id": 50023, "text": "Created attachment 26099\npatch\n\nHi,\n\nWhile doing some static analysis on the Tomcat codebase, I came across this piece of code, which was considered strange for the analysis:\n         if(hasContext){\n            ctxt.generateJavaSource(contextName + \" = \");\n            ctxt.generateAttribute(\"context\");\n            ctxt.generateJavaSource(\";\");\n        }\n\nIt takes a long time to understand that in this case, ctxt.generateAttribute is equivalent to ctxt.getConstantAttribute (passing through org.apache.jasper.compiler.Generator.GenerateVisitor.visit(AttributeGenerator)).\n\nFor sake of maintainability / readability, I suggest doing as as in other classes implementing TagPlugin and using getConstantAttribute instead (e.g. in Url.java: if(hasScope){ strScope = ctxt.getConstantAttribute(\"scope\");}\n\nA patch is attached,\n\nRegards, --Martin", "count": 0, "id": 140294, "time": "2010-09-29T06:33:58Z", "creator": "martin.monperrus@gmail.com", "creation_time": "2010-09-29T06:33:58Z", "is_private": false}, {"count": 1, "tags": [], "creator": "martin.monperrus@gmail.com", "text": "Hi,\n\nIs the patch correct?\n\nThanks, --Martin", "id": 140476, "time": "2010-10-05T04:25:12Z", "bug_id": 50023, "creation_time": "2010-10-05T04:25:12Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 50023, "attachment_id": null, "text": "As c.tld says about the <c:redirect> JSTL tag:\n\n  <tag>\n    <description>\n        Redirects to a new URL.\n    </description>\n    <name>redirect</name>\n(...)\n    <attribute>\n        <name>context</name>\n        <required>false</required>\n        <rtexprvalue>true</rtexprvalue>\n    </attribute>\n  </tag>\n\nIt says <rtexprvalue>true</rtexprvalue>, which means that the attribute is evaluated at runtime and is not a constant value.\n\nThus the current Tomcat code is correct.", "id": 140501, "time": "2010-10-05T20:34:35Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2010-10-05T20:34:35Z", "is_private": false}, {"count": 3, "tags": [], "creator": "martin.monperrus@gmail.com", "text": "Created attachment 26124\nPatch to clarify the documentation of TagPluginContext\n\nHi Konstantin,\n\nMany thanks for your answer and pointer. Here is a patch to clarify the documentation of getConstantAttribute and generateAttribute.\n\nRegards,\n\n--Martin", "id": 140508, "time": "2010-10-06T07:52:48Z", "bug_id": 50023, "creation_time": "2010-10-06T07:52:48Z", "is_private": false, "attachment_id": 26124}]