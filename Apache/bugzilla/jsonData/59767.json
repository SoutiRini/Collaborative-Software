[{"count": 0, "tags": [], "bug_id": 59767, "is_private": false, "text": "Running APR-util testall on APR-util 1.5.4 (with APR 1.5.2 and APR-iconv 1.2.1) fails on my machine approximately 20% of all runs with the following failure:\n\ntestreslist: |Line 255: expected (10), but saw (20)\nFAILED 1 of 1\n\nThe corresponding check in testreslist.c compares the diff between c_count and d_count to equal RESLIST_SMAX which seems to be off in some cases.\n\nI quickly reviewed the mutexes for the corresponding construction and destruction calls and didn't find an immediate issue there.", "id": 191988, "time": "2016-06-27T23:35:16Z", "creator": "luke1410@gmx.de", "creation_time": "2016-06-27T23:35:16Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 59767, "attachment_id": null, "id": 198400, "creation_time": "2017-04-20T08:41:28Z", "time": "2017-04-20T08:41:28Z", "creator": "tschoening@am-soft.de", "text": "I have exactly the same problem now, with the difference that the test might only succeed in 20% of all runs on my machine. I built the lib and ran the tests in 2015 already and ran into Bug 59756 then, but not this one. Since then, a lot had changed in my machine, Windows 8.1 vs. 10, C++Builder RAD 10 vs. 10.1 vs. 10.2, but the hardware is the same, especially the CPU.\n\nLooks like some timing issue in \"test_shrinking\" to me, because if I set a breakpoint in the last loop and therefore provide some additional waiting time, the test seems to always succeed. Without that breakpoint or directly run on the shell, the test seems to fail most of the times.\n\n>    /*\n>     * Now free the remaining elements. This should trigger the shrinking of\n>     * the list\n>     */\n>    for (i = 0; i < RESLIST_SMAX - 1; i++) {\n>BP      rv = apr_reslist_release(rl, resources[i]);\n>        ABTS_INT_EQUAL(tc, APR_SUCCESS, rv);\n>    }", "is_private": false}]