[{"count": 0, "tags": [], "bug_id": 44746, "attachment_id": 21777, "id": 115292, "time": "2008-04-03T08:13:12Z", "creator": "Tom.Donovan@acm.org", "creation_time": "2008-04-03T08:13:12Z", "is_private": false, "text": "Created attachment 21777\nftp_data_out_filter for trunk (rev 639682)\n\nChange 600473 - \"document new API guarantee for handling non-NULL request_rec pointer when adding connection filters\"\nto httpd/trunk/server/util_filter.c removes the request_rec* from any filter which is AP_FTYPE_CONNECTION or higher.  This includes AP_FTYPE_NETWORK filters like the ftp_data_out filter.\n\nThe ftp_data_out_filter function (modules/ftp/ftp_data_filters.c:225) tries to retrieve its module config using the filter's request_rec.  It should use the conn_rec instead of the request_rec."}, {"count": 1, "tags": [], "creator": "jim@apache.org", "attachment_id": null, "is_private": false, "id": 115408, "time": "2008-04-08T03:13:01Z", "bug_id": 44746, "creation_time": "2008-04-08T03:13:01Z", "text": "Doesn't this mean that Vhosts are no longer honored here? Seems we'd always be using the base server config with this patch, which is non optimal."}, {"count": 2, "tags": [], "bug_id": 44746, "text": "re: \"Doesn't this mean that Vhosts are no longer honored here? \"\n\nThis could be a problem with change 600473 in general, but I think the effect on mod_ftp is limited because this only affects the data connection - not the main (control) connection.  \n\ndata_block_size is the only server field used by ftp_data_out_filter().\n\nThis change restricts the FTPDataBlockSize directive to \"server config\" rather than \"server config, virtual host\" context.\n\n  http://httpd.apache.org/mod_ftp/mod/mod_ftp.html#ftpdatablocksize", "id": 115424, "time": "2008-04-08T10:21:47Z", "creator": "Tom.Donovan@acm.org", "creation_time": "2008-04-08T10:21:47Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "wrowe@apache.org", "attachment_id": null, "is_private": false, "id": 115449, "time": "2008-04-09T01:24:18Z", "bug_id": 44746, "creation_time": "2008-04-09T01:24:18Z", "text": "fc->orig_server->module_config seems best... I've committed, thanks for this\nexcellent catch Tom!"}]