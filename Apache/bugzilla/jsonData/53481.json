[{"count": 0, "tags": [], "bug_id": 53481, "attachment_id": null, "id": 160322, "time": "2012-06-28T14:27:30Z", "creator": "mike@normi.net", "creation_time": "2012-06-28T14:27:30Z", "is_private": false, "text": "Currently, Tomcat Native does not have an equivalent of the mod_ssl SSLHonorCipherOrder directive and is thus vulnerable to the SSL BEAST attack.\n\nSee http://httpd.apache.org/docs/current/mod/mod_ssl.html#sslhonorcipherorder for the docs on this directive, and https://community.qualys.com/blogs/securitylabs/2011/10/17/mitigating-the-beast-attack-on-tls on why and how it mitigates the BEAST attack.\n\nPlease incorporate an option named SSLHonorCipherOrder that sets the OpenSSL option SSL_OP_CIPHER_SERVER_PREFERENCE\n\nP.S., not sure whether to qualify this as bug or enhancement, but since it concerns a security issue I filed it as a bug.\n\nP.S.2, I'm willing to create a patch myself, but since I don't have an Tomcat Native build env that will probably take some time... It's a really small change."}, {"text": "Created attachment 29148\nPatch that adds SSLHonorCipherOrder option\n\nActually, this can be already supported by current tcnative, but it needs to be added to tomcat itself. I've created a patch (should fit both 7.x and 8.x sources). It is compile-tested only. Perhaps it would be a good idea to reassign this bug to a more appropriate project.", "tags": [], "creator": "sebek64@post.cz", "is_private": false, "count": 1, "id": 161047, "time": "2012-08-01T18:01:25Z", "bug_id": 53481, "creation_time": "2012-08-01T18:01:25Z", "attachment_id": 29148}, {"count": 2, "tags": [], "bug_id": 53481, "text": "I'm looking at applying this, but I have to check on what SSLContext.setOptions does -- I think the patch will un-set previously-set options when setting SSL_HONOR_CIPHER_ORDER. Once I verify the behavior of SSLContext.setOptions, I'll make any necessary adjustments.", "id": 161186, "time": "2012-08-09T15:33:02Z", "creator": "chris@christopherschultz.net", "creation_time": "2012-08-09T15:33:02Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 53481, "attachment_id": null, "id": 161189, "time": "2012-08-09T16:06:13Z", "creator": "chris@christopherschultz.net", "creation_time": "2012-08-09T16:06:13Z", "is_private": false, "text": "Nope, SSL_CTX_set_options (which is what SSLContext.setOptions calls) only flips the bit(s) passed-into it, so the patch is fine."}, {"count": 4, "tags": [], "bug_id": 53481, "attachment_id": null, "is_private": false, "id": 161190, "time": "2012-08-09T16:32:25Z", "creator": "chris@christopherschultz.net", "creation_time": "2012-08-09T16:32:25Z", "text": "Fixed in trunk and 7.0.x. Will be included in Tomcat 7.0.30.\n\nProposed for 6.0.x."}, {"count": 5, "attachment_id": null, "bug_id": 53481, "is_private": false, "id": 162584, "time": "2012-10-05T11:55:55Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2012-10-05T11:55:55Z", "tags": [], "text": "Note that this feature requires an updated version of Tomcat Native.\nSee bug 53969 for details."}, {"count": 6, "tags": [], "creator": "chris@christopherschultz.net", "attachment_id": null, "is_private": false, "id": 164191, "time": "2012-12-20T23:11:54Z", "bug_id": 53481, "creation_time": "2012-12-20T23:11:54Z", "text": "(In reply to comment #5)\n> Note that this feature requires an updated version of Tomcat Native.\n> See bug 53969 for details.\n\nSpecifically, tcnative 1.1.25 or later."}, {"count": 7, "attachment_id": null, "bug_id": 53481, "is_private": false, "id": 164712, "time": "2013-01-17T20:48:07Z", "creator": "chris@christopherschultz.net", "creation_time": "2013-01-17T20:48:07Z", "tags": [], "text": "Fixed in Tomcat 6.0.x. Will be in Tomcat 6.0.37."}, {"count": 8, "attachment_id": null, "bug_id": 53481, "text": "see also bug 55988", "id": 191947, "time": "2016-06-25T13:18:00Z", "creator": "hauser@acm.org", "creation_time": "2016-06-25T13:18:00Z", "tags": [], "is_private": false}]