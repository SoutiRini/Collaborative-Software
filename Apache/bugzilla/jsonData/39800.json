[{"count": 0, "tags": [], "bug_id": 39800, "attachment_id": null, "id": 90138, "time": "2006-06-13T13:22:16Z", "creator": "apache@gagravarr.org", "creation_time": "2006-06-13T13:22:16Z", "is_private": false, "text": "I've discovered that the serialisation of properties from EscherOptRecord isn't\nbehaving on some EscherOptRecords in PowerPoint files.\n\nThe result is that they are serialised to a different (and I suspect incorrect)\nset of bytes (compared to the bytes used to build the record).\n\nI've added a (disabled) test to the end of TestEscherOptRecord which shows up\nthis bug - the serialised form will differ at byte 28.\n\n\n(I'm going to have to leave a few HSLF tests disabled for now, as they're being\nincorrectly tripped by byte-stream changes in EscherOptRecords)"}, {"count": 1, "text": "I also discovered this bug some time ago but put it aside for a while until my\nhands are free. \n\nThe problem is in org.apache.poi.ddf.EscherArrayProperty.\n\nEscherArrayProperty.checkComplexData overrides the record data if the size of\nthe array is 0. \n\nRegards, Yegor", "bug_id": 39800, "is_private": false, "id": 90139, "time": "2006-06-13T13:30:42Z", "creator": "yegor@dinom.ru", "creation_time": "2006-06-13T13:30:42Z", "tags": [], "attachment_id": null}, {"count": 2, "text": "From some more debugging, it looks like my problem is an EscherArrayProperty,\nbut not an empty one. It's a problem in the simple part, more debugging is\nrequired though.", "bug_id": 39800, "attachment_id": null, "id": 90147, "time": "2006-06-13T15:39:30Z", "creator": "apache@gagravarr.org", "creation_time": "2006-06-13T15:39:30Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 39800, "is_private": false, "text": "Ah ha! After much poking with a debugger, I finally properly understand Glen's\ncryptic comment in setArrayData\n\nI've added a new flag, to record when the simple part's size doesn't include the\nheader length, so we can write it out the same.\n\nI'm not sure if this'll help the zero size or not though, I'll have to find one\nto be sure.", "id": 90153, "time": "2006-06-13T17:01:11Z", "creator": "apache@gagravarr.org", "creation_time": "2006-06-13T17:01:11Z", "attachment_id": null}]