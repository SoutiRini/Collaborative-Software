[{"count": 0, "tags": [], "bug_id": 46317, "attachment_id": null, "id": 122964, "time": "2008-12-01T12:43:42Z", "creator": "arkadiyg@yahoo.com", "creation_time": "2008-12-01T12:43:42Z", "is_private": false, "text": "Our LDAP Active Directory tree looks like this:\nDC=xxx,DC=COM\n-OU=Accounts\n -OU=Usernames\n  -OU=Finance&Administration\n  -OU=Generic accounts\n  -OU=Security\n  -....\n-DC=sng,DC=xxx,DC=com\n -OU=Singapore Users\n-DC=uk,DC=xxx,DC=com\n -OU=Accounts\n  -OU=Users\n\nIf I use the following configuration, everything works, except I am not able to authonticate UK and SNG users because the root of the search does not include UK ans SNG domains.\n\nAuthBasicProvider ldap\nAuthLDAPURL \"ldap://nydomain04.xxx.com/OU=Accounts,DC=xxx,DC=com?sAMAccountName?sub?(objectClass=*)\"\nAuthLDAPBindDN \"CN=ldap connector,OU=Generic accounts,OU=Accounts,DC=xxx,DC=com\"\nAuthLDAPBindPassword ******\nAuthType Basic\nAuthName \"xxx Domain\"\nRequire ldap-group CN=JMX_Security, OU=Security, OU=Usernames, OU=Accounts, DC=xxx,DC=com\n\n\n[Wed Nov 26 22:24:36 2008] [debug] mod_authnz_ldap.c(373): [client 192.168.2.75] [3718] auth_ldap authenticate: using URL ldap://nydomain04.xxx.com/OU=Accounts,DC=xxx,DC=com?sAMAccountName?sub?(objectClass=*)\n[Wed Nov 26 22:24:36 2008] [debug] mod_authnz_ldap.c(454): [client 192.168.2.75] [3718] auth_ldap authenticate: accepting testuser\n[Wed Nov 26 22:24:36 2008] [debug] mod_authnz_ldap.c(691): [client 192.168.2.75] [3718] auth_ldap authorise: require group: testing for group membership in \"CN=JMX_Security, OU=Security, OU=Usernames, OU=Accounts, DC=xxx,DC=com\"\n[Wed Nov 26 22:24:36 2008] [debug] mod_authnz_ldap.c(697): [client 192.168.2.75] [3718] auth_ldap authorise: require group: testing for member: CN=Test User,OU=Finance&Administration,OU=Usernames,OU=Accounts,DC=xxx,DC=com (CN=JMX_Security, OU=Security, OU=Usernames, OU=Accounts, DC=xxx,DC=com)\n[Wed Nov 26 22:24:36 2008] [debug] mod_authnz_ldap.c(706): [client 192.168.2.75] [3718] auth_ldap authorise: require group: authorisation successful (attribute member) [Comparison true (adding to cache)][Compare True]\n\n\nHowever, if I use the follwong configuration, mod_authnz_ldap.c produces a seg fault.\n\nAuthBasicProvider ldap\nAuthLDAPURL \"ldap://nydomain04.xxx.com/DC=xxx,DC=com?sAMAccountName?sub?(objectClass=*)\" \nAuthLDAPBindDN \"CN=ldap connector,OU=Generic accounts,OU=Accounts,DC=xxx,DC=com\"\nAuthLDAPBindPassword ******\nAuthType Basic\nAuthName \"xxx Domain\"\nRequire ldap-group CN=JMX_Security, OU=Security, OU=Usernames, OU=Accounts, DC=xxx,DC=com\n\n\n[Wed Nov 26 20:24:31 2008] [debug] mod_authnz_ldap.c(373): [client 192.168.2.75] [3110] auth_ldap authenticate: using URL ldap://nydomain04.xxx.com/DC=xxx,DC=com?sAMAccountName?sub?(objectClass=*)\n[Wed Nov 26 20:24:42 2008] [notice] child pid 3110 exit signal Segmentation fault (11)\n\n\n# rpm -qi httpd\nName        : httpd                        Relocations: (not relocatable)\nVersion     : 2.2.3                             Vendor: CentOS\nRelease     : 11.el5_2.centos.4             Build Date: Wed 12 Nov 2008 10:44:43 AM EST\nInstall Date: Fri 14 Nov 2008 07:42:56 AM EST      Build Host: builder16.centos.org\nGroup       : System Environment/Daemons    Source RPM: httpd-2.2.3-11.el5_2.centos.4.src.rpm\nSize        : 2899288                          License: Apache Software License\nSignature   : DSA/SHA1, Wed 12 Nov 2008 05:54:31 PM EST, Key ID a8a447dce8562897\nURL         : http://httpd.apache.org/\nSummary     : Apache HTTP Server\nDescription : The Apache HTTP Server is a powerful, efficient, and extensible web server."}, {"count": 1, "tags": [], "bug_id": 46317, "is_private": false, "id": 123715, "attachment_id": null, "creator": "ksarkies@trinity.asn.au", "creation_time": "2009-01-02T15:34:21Z", "time": "2009-01-02T15:34:21Z", "text": "Is this the same as https://bugzilla.redhat.com/show_bug.cgi?id=471898\n\nUsing Fedora 10, Apache 2.2.10 I had the same problem. Installing apr-util-ldap fixed it.\n\nCan the assignee verify this please.\n\nKen\n"}, {"count": 2, "tags": [], "bug_id": 46317, "attachment_id": null, "id": 129056, "time": "2009-07-22T14:04:56Z", "creator": "twhu@alcatel-lucent.com", "creation_time": "2009-07-22T14:04:56Z", "is_private": false, "text": "I'm using solaris 10 and have the similar problem.\n\nI use apache 2.2.11.\n\nCC=\"gcc\"; export CC\nCPPFLAGS=\"-I/opt1/util/db/include -I/opt1/util/openssl98k/include\"; export CPPFLAGS\nLDFLAGS=\"-L/opt1/util/db/lib -L/opt1/util/openssl98k/lib\"; export LDFLAGS\n\"./configure\" \\\n\"--prefix=/PDS/twh/apache2ssl\" \\\n\"--enable-mime-magic\" \\\n\"--enable-so\" \\\n\"--enable-ssl\" \\\n\"--with-ssl=/opt1/util/openssl98k\" \\\n\"--with-ldap\" \\\n\"--with-port=5000\" \\\n\"--enable-mods-shared=mime-magic ssl ldap authnz-ldap\" \\\n\"CC=gcc\" \\\n\"LDFLAGS=-L/opt1/util/db/lib -L/opt1/util/openssl98k/lib\" \\\n\"CPPFLAGS=-I/opt1/util/db/include -I/opt1/util/openssl98k/include\" \\\n\"$@\"\n\nI need help on Apache ldaps setup."}, {"count": 3, "attachment_id": null, "creator": "trawick@apache.org", "is_private": false, "id": 129057, "time": "2009-07-22T14:14:39Z", "bug_id": 46317, "creation_time": "2009-07-22T14:14:39Z", "tags": [], "text": ">I'm using solaris 10 and have the similar problem...  I need help on Apache ldaps setup.\n\nAs mentioned in the docs, Apache doesn't support ldaps using native Solaris LDAP.  (In fact it segfaults.)  Build Apache with OpenLDAP if you need ldaps on Solaris 10."}]