[{"count": 0, "tags": [], "creator": "jeff@socialchange.net.au", "attachment_id": null, "id": 7079, "time": "2001-10-23T17:10:28Z", "bug_id": 4382, "creation_time": "2001-10-23T17:10:28Z", "is_private": false, "text": "(Only applicable on *nix, I think)\n\nI've found that if by accident, I run \"startup.sh\" when Tomcat is already\nrunning, I can no longer shut Tomcat down with \"shutdown.sh\":\n\n[jeff@kermit bin]$ ./shutdown.sh \nUsing classpath: ./../lib/tomcat.jar\nUsing JAVA_HOME: /usr/local/jdk\nUsing TOMCAT_HOME: ..\nStopping Tomcat.\nCan't read ../conf/ajp12.id\n\nThe same thing happens if I run \"./tomcat.sh start -jkconf\" when Tomcat is\nalready running.\n\nThe problem is that the first thing tomcat.sh does is remove ajp12.id,\nregardless of whether the tomcat invocation is successful or long-running. A few\nsolutions..\n 1 Ditch the whole ajp12.id system and make it 'stateless' like Tomcat 4.\n 2 Have tomcat.sh check for the '-jkconf' flag, and not remove ajp12.id if so.\n 3 Have './tomcat.sh start -jkconf' write a flag file to indicate that it\nsucceeded. Then tomcat.sh could delete this before, and check for this after.\nsuccessful. \n\n1 would be nicest, but I suppose 2 is most practical.. if you agree but don't\nlike shell hacking, I can have a go.\n\n--Jeff"}, {"count": 1, "tags": [], "bug_id": 4382, "is_private": false, "text": "1- I'm not sure, generating a random password is better than relying on\nserver.xml and localhost. We can add code to disable the generation of ajp.id\nif a secret is explicitely set. \n2. I don't remember why we remove ajp.id when starting, it would be overridden\nanyway if the startup is ok. I think just removing the 'rm' should be enough for this problem.\n3. Would also be nice to have.\n\nSo I would vote for all of them for 3.3.1", "id": 7120, "time": "2001-10-24T16:28:43Z", "creator": "cmanolache@yahoo.com", "creation_time": "2001-10-24T16:28:43Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "Larry.Isaacs@sas.com", "attachment_id": null, "text": "The deletion of ajp12.id was part of the -wait option which tries to detect\nwhen startup has \"completed\" by checking for the existence of ajp12.id.\n\nThis deletion has been removed from tomcat.sh in the current nightly Tomcat\n3.3.x.  To use the -wait option, make sure ajp12.id is deleted prior to\nexecuting tomcat.sh.\n", "id": 10119, "time": "2002-01-31T14:21:06Z", "bug_id": 4382, "creation_time": "2002-01-31T14:21:06Z", "is_private": false}]