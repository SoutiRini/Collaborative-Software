[{"count": 0, "text": "According to the SSL How-To, it should be possible to use the HTTPS flag and URL\nrewriting to limit certain accesses to HTTPS.  For example:\n\n    RewriteCond  %{HTTPS}  !=on\n    RewriteRule  ^foo$  -  [F]\n\nHowever, with the above I always get the forbidden result.  I'm using the\nfollowing as a workaround without problems:\n\n    RewriteCond  %{SERVER_PORT}  !^443$\n    RewriteRule  ^foo$  -  [F]\n\nSo why doesn't the HTTPS variable test work as described in the documentation?", "bug_id": 21672, "attachment_id": null, "id": 40875, "time": "2003-07-17T00:50:13Z", "creator": "jvb@prairienet.org", "creation_time": "2003-07-17T00:50:13Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 21672, "attachment_id": null, "text": "From what I can tell, mod_ssl is not setting the HTTPS flag.  I am using\n\"SSLOptions +StdEnvVars\".\n", "id": 40879, "time": "2003-07-17T01:22:50Z", "creator": "jvb@prairienet.org", "creation_time": "2003-07-17T01:22:50Z", "is_private": false}, {"count": 2, "tags": [], "creator": "jvb@prairienet.org", "text": "From the CGI script I can see that HTTPS is being set.  So I just don't know why\nmod_rewrite can't see it.  I've tried it from both per-server and per-directory\ncontext.  I've also tried %{ENV:HTTPS}.  In all cases the mod_rewrite log shows\nthe input to the test as empty string.\n", "id": 40882, "time": "2003-07-17T02:06:11Z", "bug_id": 21672, "creation_time": "2003-07-17T02:06:11Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "nd@perlig.de", "attachment_id": null, "id": 42865, "time": "2003-08-17T02:07:22Z", "bug_id": 21672, "creation_time": "2003-08-17T02:07:22Z", "is_private": false, "text": "HTTPS will be set too late for (server context) mod_rewrite. You can use the\n%{LA-U:ENV:HTTPS} construct which works reliably.\n\nHowever, someone needs to figure out, whether this is a documentation bug or a\ncode bug.\n\nThanks for using Apache."}, {"count": 4, "tags": [], "bug_id": 21672, "attachment_id": null, "text": "Using %{LA-U:ENV:HTTPS} does not work for me.  I tested it from a per-directory\ncontext.", "id": 42879, "time": "2003-08-17T23:48:20Z", "creator": "jvb@prairienet.org", "creation_time": "2003-08-17T23:48:20Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 21672, "attachment_id": null, "text": "Hmm. What happens? Is it empty? Can you post a rewritelog excerpt here?\n\nThanks.", "id": 42880, "time": "2003-08-18T00:00:00Z", "creator": "nd@perlig.de", "creation_time": "2003-08-18T00:00:00Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 21672, "attachment_id": null, "id": 42882, "time": "2003-08-18T03:06:17Z", "creator": "jvb@prairienet.org", "creation_time": "2003-08-18T03:06:17Z", "is_private": false, "text": "Yes, it's empty.\n\n24.193.103.235 - - [17/Aug/2003:22:59:26 --0400] [memebeam.org/sid#80fec48][rid#\n81a55c0/initial] (5) lookahead: path=/home/memebeam/www/cgi-bin/test2.cgi var=EN\nV:HTTPS -> val=\n24.193.103.235 - - [17/Aug/2003:22:59:26 --0400] [memebeam.org/sid#80fec48][rid#\n81a55c0/initial] (4) RewriteCond: input='' pattern='!=on' => matched\n"}, {"count": 7, "tags": [], "creator": "nd@perlig.de", "attachment_id": null, "id": 42930, "time": "2003-08-18T17:42:44Z", "bug_id": 21672, "creation_time": "2003-08-18T17:42:44Z", "is_private": false, "text": "Note that HTTPS will be only set, if the current request is an SSL request. I've\njust tried it and had no problems, i.e. I get an empty variable (resp.\nundefined) if no SSL is used, but inside the SSL enabled virtual host it is set\nto on. (tested both in server and directory context)."}, {"count": 8, "tags": [], "creator": "jvb@prairienet.org", "attachment_id": null, "id": 42939, "time": "2003-08-18T19:24:42Z", "bug_id": 21672, "creation_time": "2003-08-18T19:24:42Z", "is_private": false, "text": "I am aware HTTPS will not be set for non-SSL access.  The previous log was of an\nSSL access."}, {"count": 9, "tags": [], "creator": "nd@perlig.de", "attachment_id": null, "id": 42940, "time": "2003-08-18T19:38:53Z", "bug_id": 21672, "creation_time": "2003-08-18T19:38:53Z", "is_private": false, "text": "*sigh* please provide more information. Otherwise I can only guess what is\nspecial on your box (since I cannot reproduce the problem). Can you provide a\nminimal config which doesn't work as expected? Can you post the whole rewritelog?\n(please attach them, do not paste into the text field)."}, {"count": 10, "tags": [], "bug_id": 21672, "attachment_id": null, "id": 44115, "time": "2003-09-12T16:45:51Z", "creator": "corporate_gadfly@hotmail.com", "creation_time": "2003-09-12T16:45:51Z", "is_private": false, "text": "I'm just a third party who just got smitten by the non-availability of HTTPS\nunder mod_rewrite. %{LA-U:ENV:HTTPS} does work for me however. I'm using apache\n2.0.47. My directives look something like (I'm forcing http -> https on a\nper-directory basis):\n\n<IfModule mod_ssl.c>\nRewriteEngine On\nRewriteBase /www/BUILD/SISadm-cgi\nRewriteCond %{LA-U:ENV:HTTPS} !=on\nRewriteRule ^(.*)?$ https://%{SERVER_NAME}/dev-sisadm-cgi/$1 [L,R]\n</IfModule>\n\nFYI, this should probably be marked duplicate of bug 10434."}, {"count": 11, "tags": [], "bug_id": 21672, "text": "\n\n*** This bug has been marked as a duplicate of 10434 ***", "id": 44118, "time": "2003-09-12T17:40:48Z", "creator": "erik@codefaktor.de", "creation_time": "2003-09-12T17:40:48Z", "is_private": false, "attachment_id": null}]