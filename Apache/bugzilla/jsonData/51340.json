[{"attachment_id": null, "tags": [], "bug_id": 51340, "text": "An Eclipse Virgo CI build recently failed with the stack trace below. I\nhaven't seen the problem before, but it seems that at least\none user of vanilla Tomcat has hit the same problem, on Tomcat 6 in 2009 ([1]).\n\nI am raising this bug to get this on the record and perhaps to help identify a pattern of usage that may ultimately lead to a solution.\n\nIt is possible that the bug is in the JRE XML processing, of course.\n\nEnvironment:\n\nJava 6 R21 64 bit (Sun)\nSles 11 x86-64\nTomcat 7.0.12 embedded in development version of Eclipse Virgo 3.0\n\n[1] http://mail-archives.apache.org/mod_mbox/tomcat-users/200902.mbox/%3C36E4692623C5974BA6661C0B18EE8EDFE4138B@MAILSERV.hcrest.com%3E\n\n[2011-06-07 11:07:17.741] ERROR start-signalling-4           System.err                                                        Jun 7, 2011 11:07:17 AM org.apache.tomcat.util.digester.Digester startElement \n[2011-06-07 11:07:17.741] ERROR start-signalling-4           System.err                                                        SEVERE: Begin event threw exception \n[2011-06-07 11:07:17.741] ERROR start-signalling-4           System.err                                                        java.lang.IllegalArgumentException: <session-config> element is limited to 1 occurrence \n[2011-06-07 11:07:17.742] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.startup.SetSessionConfig.begin(WebRuleSet.java:722) \n[2011-06-07 11:07:17.742] ERROR start-signalling-4           System.err                                                        \tat org.apache.tomcat.util.digester.Digester.startElement(Digester.java:1282) \n[2011-06-07 11:07:17.742] ERROR start-signalling-4           System.err                                                        \tat com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startElement(AbstractSAXParser.java:501) \n[2011-06-07 11:07:17.742] ERROR start-signalling-4           System.err                                                        \tat com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(XMLDocumentFragmentScannerImpl.java:1363) \n[2011-06-07 11:07:17.742] ERROR start-signalling-4           System.err                                                        \tat com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2755) \n[2011-06-07 11:07:17.742] ERROR start-signalling-4           System.err                                                        \tat com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648) \n[2011-06-07 11:07:17.742] ERROR start-signalling-4           System.err                                                        \tat com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511) \n[2011-06-07 11:07:17.742] ERROR start-signalling-4           System.err                                                        \tat com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808) \n[2011-06-07 11:07:17.742] ERROR start-signalling-4           System.err                                                        \tat com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737) \n[2011-06-07 11:07:17.743] ERROR start-signalling-4           System.err                                                        \tat com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119) \n[2011-06-07 11:07:17.743] ERROR start-signalling-4           System.err                                                        \tat com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205) \n[2011-06-07 11:07:17.743] ERROR start-signalling-4           System.err                                                        \tat com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522) \n[2011-06-07 11:07:17.743] ERROR start-signalling-4           System.err                                                        \tat org.apache.tomcat.util.digester.Digester.parse(Digester.java:1543) \n[2011-06-07 11:07:17.743] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.startup.ContextConfig.parseWebXml(ContextConfig.java:1694) \n[2011-06-07 11:07:17.743] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1197) \n[2011-06-07 11:07:17.743] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:882) \n[2011-06-07 11:07:17.743] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:317) \n[2011-06-07 11:07:17.743] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119) \n[2011-06-07 11:07:17.744] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:89) \n[2011-06-07 11:07:17.744] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5081) \n[2011-06-07 11:07:17.744] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:145) \n[2011-06-07 11:07:17.744] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:812) \n[2011-06-07 11:07:17.744] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:787) \n[2011-06-07 11:07:17.744] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.core.StandardHost.addChild(StandardHost.java:607) \n[2011-06-07 11:07:17.744] ERROR start-signalling-4           System.err                                                        \tat org.eclipse.gemini.web.tomcat.internal.TomcatServletContainer.startWebApplication(TomcatServletContainer.java:122) \n[2011-06-07 11:07:17.744] ERROR start-signalling-4           System.err                                                        \tat org.eclipse.gemini.web.internal.StandardWebApplication.start(StandardWebApplication.java:91) \n[2011-06-07 11:07:17.745] ERROR start-signalling-4           System.err                                                        \tat org.eclipse.virgo.web.core.internal.WebBundleLifecycleListener.onStarted(WebBundleLifecycleListener.java:122) \n[2011-06-07 11:07:17.745] ERROR start-signalling-4           System.err                                                        \tat org.eclipse.virgo.kernel.install.artifact.internal.StandardArtifactStateMonitor.onStarted(StandardArtifactStateMonitor.java:247) \n[2011-06-07 11:07:17.745] ERROR start-signalling-4           System.err                                                        \tat org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact.asyncStartSucceeded(AbstractInstallArtifact.java:294) \n[2011-06-07 11:07:17.745] ERROR start-signalling-4           System.err                                                        \tat org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact.access$0(AbstractInstallArtifact.java:291) \n[2011-06-07 11:07:17.745] ERROR start-signalling-4           System.err                                                        \tat org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact$StateMonitorSignal.signalSuccessfulCompletion(AbstractInstallArtifact.java:229) \n[2011-06-07 11:07:17.745] ERROR start-signalling-4           System.err                                                        \tat org.eclipse.virgo.kernel.core.internal.BundleStartTracker$1.run(BundleStartTracker.java:143) \n[2011-06-07 11:07:17.745] ERROR start-signalling-4           System.err                                                        \tat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) \n[2011-06-07 11:07:17.745] ERROR start-signalling-4           System.err                                                        \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) \n[2011-06-07 11:07:17.746] ERROR start-signalling-4           System.err                                                        \tat java.lang.Thread.run(Thread.java:619) \n[2011-06-07 11:07:17.747] ERROR start-signalling-4           System.err                                                        Jun 7, 2011 11:07:17 AM org.apache.catalina.startup.ContextConfig parseWebXml \n[2011-06-07 11:07:17.748] ERROR start-signalling-4           System.err                                                        SEVERE: Parse error in application web.xml file at file:/opt/users/hudsonbuild/workspace/virgo.web-server.snapshot/org.eclipse.virgo.server.smoketest/target/test-expanded/virgo-tomcat-server-3.0.0.CI-2011-06-07_11-01-11/work/org.eclipse.virgo.kernel.deployer_3.0.0.D-20110603101321/staging/global/bundle/org.eclipse.gemini.web.tomcat/2.0.0.BUILD-20110603145554/org.eclipse.gemini.web.tomcat-2.0.0.BUILD-20110603145554.jar/conf/web.xml \n[2011-06-07 11:07:17.748] ERROR start-signalling-4           System.err                                                        java.lang.IllegalArgumentException: <session-config> element is limited to 1 occurrence \n[2011-06-07 11:07:17.748] ERROR start-signalling-4           System.err                                                        \tat org.apache.tomcat.util.digester.Digester.createSAXException(Digester.java:2687) \n[2011-06-07 11:07:17.748] ERROR start-signalling-4           System.err                                                        \tat org.apache.tomcat.util.digester.Digester.createSAXException(Digester.java:2713) \n[2011-06-07 11:07:17.748] ERROR start-signalling-4           System.err                                                        \tat org.apache.tomcat.util.digester.Digester.startElement(Digester.java:1285) \n[2011-06-07 11:07:17.748] ERROR start-signalling-4           System.err                                                        \tat com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startElement(AbstractSAXParser.java:501) \n[2011-06-07 11:07:17.749] ERROR start-signalling-4           System.err                                                        \tat com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(XMLDocumentFragmentScannerImpl.java:1363) \n[2011-06-07 11:07:17.749] ERROR start-signalling-4           System.err                                                        \tat com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2755) \n[2011-06-07 11:07:17.749] ERROR start-signalling-4           System.err                                                        \tat com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648) \n[2011-06-07 11:07:17.749] ERROR start-signalling-4           System.err                                                        \tat com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511) \n[2011-06-07 11:07:17.749] ERROR start-signalling-4           System.err                                                        \tat com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808) \n[2011-06-07 11:07:17.749] ERROR start-signalling-4           System.err                                                        \tat com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737) \n[2011-06-07 11:07:17.749] ERROR start-signalling-4           System.err                                                        \tat com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119) \n[2011-06-07 11:07:17.749] ERROR start-signalling-4           System.err                                                        \tat com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205) \n[2011-06-07 11:07:17.750] ERROR start-signalling-4           System.err                                                        \tat com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522) \n[2011-06-07 11:07:17.750] ERROR start-signalling-4           System.err                                                        \tat org.apache.tomcat.util.digester.Digester.parse(Digester.java:1543) \n[2011-06-07 11:07:17.750] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.startup.ContextConfig.parseWebXml(ContextConfig.java:1694) \n[2011-06-07 11:07:17.750] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1197) \n[2011-06-07 11:07:17.750] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:882) \n[2011-06-07 11:07:17.750] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:317) \n[2011-06-07 11:07:17.750] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119) \n[2011-06-07 11:07:17.750] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:89) \n[2011-06-07 11:07:17.750] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5081) \n[2011-06-07 11:07:17.751] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:145) \n[2011-06-07 11:07:17.751] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:812) \n[2011-06-07 11:07:17.751] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:787) \n[2011-06-07 11:07:17.751] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.core.StandardHost.addChild(StandardHost.java:607) \n[2011-06-07 11:07:17.751] ERROR start-signalling-4           System.err                                                        \tat org.eclipse.gemini.web.tomcat.internal.TomcatServletContainer.startWebApplication(TomcatServletContainer.java:122) \n[2011-06-07 11:07:17.751] ERROR start-signalling-4           System.err                                                        \tat org.eclipse.gemini.web.internal.StandardWebApplication.start(StandardWebApplication.java:91) \n[2011-06-07 11:07:17.751] ERROR start-signalling-4           System.err                                                        \tat org.eclipse.virgo.web.core.internal.WebBundleLifecycleListener.onStarted(WebBundleLifecycleListener.java:122) \n[2011-06-07 11:07:17.751] ERROR start-signalling-4           System.err                                                        \tat org.eclipse.virgo.kernel.install.artifact.internal.StandardArtifactStateMonitor.onStarted(StandardArtifactStateMonitor.java:247) \n[2011-06-07 11:07:17.751] ERROR start-signalling-4           System.err                                                        \tat org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact.asyncStartSucceeded(AbstractInstallArtifact.java:294) \n[2011-06-07 11:07:17.752] ERROR start-signalling-4           System.err                                                        \tat org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact.access$0(AbstractInstallArtifact.java:291) \n[2011-06-07 11:07:17.752] ERROR start-signalling-4           System.err                                                        \tat org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact$StateMonitorSignal.signalSuccessfulCompletion(AbstractInstallArtifact.java:229) \n[2011-06-07 11:07:17.752] ERROR start-signalling-4           System.err                                                        \tat org.eclipse.virgo.kernel.core.internal.BundleStartTracker$1.run(BundleStartTracker.java:143) \n[2011-06-07 11:07:17.752] ERROR start-signalling-4           System.err                                                        \tat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) \n[2011-06-07 11:07:17.752] ERROR start-signalling-4           System.err                                                        \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) \n[2011-06-07 11:07:17.752] ERROR start-signalling-4           System.err                                                        \tat java.lang.Thread.run(Thread.java:619) \n[2011-06-07 11:07:17.752] ERROR start-signalling-4           System.err                                                        Caused by: java.lang.IllegalArgumentException: <session-config> element is limited to 1 occurrence \n[2011-06-07 11:07:17.752] ERROR start-signalling-4           System.err                                                        \tat org.apache.catalina.startup.SetSessionConfig.begin(WebRuleSet.java:722) \n[2011-06-07 11:07:17.752] ERROR start-signalling-4           System.err                                                        \tat org.apache.tomcat.util.digester.Digester.startElement(Digester.java:1282) \n[2011-06-07 11:07:17.753] ERROR start-signalling-4           System.err                                                        \t... 33 more \n[2011-06-07 11:07:17.753] ERROR start-signalling-4           System.err                                                        Jun 7, 2011 11:07:17 AM org.apache.catalina.startup.ContextConfig parseWebXml \n[2011-06-07 11:07:17.753] ERROR start-signalling-4           System.err                                                        SEVERE: Occurred at line 468 column 21 \n[2011-06-07 11:07:17.759] ERROR start-signalling-1           System.err                                                        Jun 7, 2011 11:07:17 AM org.apache.tomcat.util.digester.Digester startElement \n[2011-06-07 11:07:17.759] ERROR start-signalling-1           System.err                                                        SEVERE: Begin event threw exception \n[2011-06-07 11:07:17.760] ERROR start-signalling-1           System.err                                                        java.lang.IllegalArgumentException: <session-config> element is limited to 1 occurrence \n[2011-06-07 11:07:17.760] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.startup.SetSessionConfig.begin(WebRuleSet.java:722) \n[2011-06-07 11:07:17.760] ERROR start-signalling-1           System.err                                                        \tat org.apache.tomcat.util.digester.Digester.startElement(Digester.java:1282) \n[2011-06-07 11:07:17.760] ERROR start-signalling-1           System.err                                                        \tat com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startElement(AbstractSAXParser.java:501) \n[2011-06-07 11:07:17.761] ERROR start-signalling-1           System.err                                                        \tat com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(XMLDocumentFragmentScannerImpl.java:1363) \n[2011-06-07 11:07:17.761] ERROR start-signalling-1           System.err                                                        \tat com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2755) \n[2011-06-07 11:07:17.762] ERROR start-signalling-1           System.err                                                        \tat com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648) \n[2011-06-07 11:07:17.762] ERROR start-signalling-1           System.err                                                        \tat com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511) \n[2011-06-07 11:07:17.763] ERROR start-signalling-1           System.err                                                        \tat com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808) \n[2011-06-07 11:07:17.763] ERROR start-signalling-1           System.err                                                        \tat com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737) \n[2011-06-07 11:07:17.763] ERROR start-signalling-1           System.err                                                        \tat com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119) \n[2011-06-07 11:07:17.764] ERROR start-signalling-1           System.err                                                        \tat com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205) \n[2011-06-07 11:07:17.764] ERROR start-signalling-1           System.err                                                        \tat com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522) \n[2011-06-07 11:07:17.765] ERROR start-signalling-1           System.err                                                        \tat org.apache.tomcat.util.digester.Digester.parse(Digester.java:1543) \n[2011-06-07 11:07:17.765] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.startup.ContextConfig.parseWebXml(ContextConfig.java:1694) \n[2011-06-07 11:07:17.765] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1197) \n[2011-06-07 11:07:17.766] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:882) \n[2011-06-07 11:07:17.766] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:317) \n[2011-06-07 11:07:17.766] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119) \n[2011-06-07 11:07:17.767] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:89) \n[2011-06-07 11:07:17.767] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5081) \n[2011-06-07 11:07:17.767] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:145) \n[2011-06-07 11:07:17.768] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:812) \n[2011-06-07 11:07:17.768] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:787) \n[2011-06-07 11:07:17.769] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.core.StandardHost.addChild(StandardHost.java:607) \n[2011-06-07 11:07:17.769] ERROR start-signalling-1           System.err                                                        \tat org.eclipse.gemini.web.tomcat.internal.TomcatServletContainer.startWebApplication(TomcatServletContainer.java:122) \n[2011-06-07 11:07:17.769] ERROR start-signalling-1           System.err                                                        \tat org.eclipse.gemini.web.internal.StandardWebApplication.start(StandardWebApplication.java:91) \n[2011-06-07 11:07:17.770] ERROR start-signalling-1           System.err                                                        \tat org.eclipse.virgo.web.core.internal.WebBundleLifecycleListener.onStarted(WebBundleLifecycleListener.java:122) \n[2011-06-07 11:07:17.770] ERROR start-signalling-1           System.err                                                        \tat org.eclipse.virgo.kernel.install.artifact.internal.StandardArtifactStateMonitor.onStarted(StandardArtifactStateMonitor.java:247) \n[2011-06-07 11:07:17.771] ERROR start-signalling-1           System.err                                                        \tat org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact.asyncStartSucceeded(AbstractInstallArtifact.java:294) \n[2011-06-07 11:07:17.771] ERROR start-signalling-1           System.err                                                        \tat org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact.access$0(AbstractInstallArtifact.java:291) \n[2011-06-07 11:07:17.772] ERROR start-signalling-1           System.err                                                        \tat org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact$StateMonitorSignal.signalSuccessfulCompletion(AbstractInstallArtifact.java:229) \n[2011-06-07 11:07:17.772] ERROR start-signalling-1           System.err                                                        \tat org.eclipse.virgo.kernel.core.internal.BundleStartTracker$1.run(BundleStartTracker.java:143) \n[2011-06-07 11:07:17.773] ERROR start-signalling-1           System.err                                                        \tat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) \n[2011-06-07 11:07:17.773] ERROR start-signalling-1           System.err                                                        \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) \n[2011-06-07 11:07:17.773] ERROR start-signalling-1           System.err                                                        \tat java.lang.Thread.run(Thread.java:619) \n[2011-06-07 11:07:17.775] ERROR start-signalling-1           System.err                                                        Jun 7, 2011 11:07:17 AM org.apache.catalina.startup.ContextConfig parseWebXml \n[2011-06-07 11:07:17.776] ERROR start-signalling-1           System.err                                                        SEVERE: Parse error in application web.xml file at file:/opt/users/hudsonbuild/workspace/virgo.web-server.snapshot/org.eclipse.virgo.server.smoketest/target/test-expanded/virgo-tomcat-server-3.0.0.CI-2011-06-07_11-01-11/work/org.eclipse.virgo.kernel.deployer_3.0.0.D-20110603101321/staging/global/bundle/org.eclipse.gemini.web.tomcat/2.0.0.BUILD-20110603145554/org.eclipse.gemini.web.tomcat-2.0.0.BUILD-20110603145554.jar/conf/web.xml \n[2011-06-07 11:07:17.777] ERROR start-signalling-1           System.err                                                        java.lang.IllegalArgumentException: <session-config> element is limited to 1 occurrence \n[2011-06-07 11:07:17.777] ERROR start-signalling-1           System.err                                                        \tat org.apache.tomcat.util.digester.Digester.createSAXException(Digester.java:2687) \n[2011-06-07 11:07:17.777] ERROR start-signalling-1           System.err                                                        \tat org.apache.tomcat.util.digester.Digester.createSAXException(Digester.java:2713) \n[2011-06-07 11:07:17.778] ERROR start-signalling-1           System.err                                                        \tat org.apache.tomcat.util.digester.Digester.startElement(Digester.java:1285) \n[2011-06-07 11:07:17.778] ERROR start-signalling-1           System.err                                                        \tat com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startElement(AbstractSAXParser.java:501) \n[2011-06-07 11:07:17.779] ERROR start-signalling-1           System.err                                                        \tat com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(XMLDocumentFragmentScannerImpl.java:1363) \n[2011-06-07 11:07:17.779] ERROR start-signalling-1           System.err                                                        \tat com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2755) \n[2011-06-07 11:07:17.780] ERROR start-signalling-1           System.err                                                        \tat com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648) \n[2011-06-07 11:07:17.780] ERROR start-signalling-1           System.err                                                        \tat com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511) \n[2011-06-07 11:07:17.781] ERROR start-signalling-1           System.err                                                        \tat com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808) \n[2011-06-07 11:07:17.781] ERROR start-signalling-1           System.err                                                        \tat com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737) \n[2011-06-07 11:07:17.781] ERROR start-signalling-1           System.err                                                        \tat com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119) \n[2011-06-07 11:07:17.782] ERROR start-signalling-1           System.err                                                        \tat com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205) \n[2011-06-07 11:07:17.782] ERROR start-signalling-1           System.err                                                        \tat com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522) \n[2011-06-07 11:07:17.782] ERROR start-signalling-1           System.err                                                        \tat org.apache.tomcat.util.digester.Digester.parse(Digester.java:1543) \n[2011-06-07 11:07:17.783] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.startup.ContextConfig.parseWebXml(ContextConfig.java:1694) \n[2011-06-07 11:07:17.783] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1197) \n[2011-06-07 11:07:17.783] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:882) \n[2011-06-07 11:07:17.784] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:317) \n[2011-06-07 11:07:17.784] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119) \n[2011-06-07 11:07:17.785] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:89) \n[2011-06-07 11:07:17.785] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5081) \n[2011-06-07 11:07:17.785] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:145) \n[2011-06-07 11:07:17.786] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:812) \n[2011-06-07 11:07:17.786] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:787) \n[2011-06-07 11:07:17.786] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.core.StandardHost.addChild(StandardHost.java:607) \n[2011-06-07 11:07:17.787] ERROR start-signalling-1           System.err                                                        \tat org.eclipse.gemini.web.tomcat.internal.TomcatServletContainer.startWebApplication(TomcatServletContainer.java:122) \n[2011-06-07 11:07:17.787] ERROR start-signalling-1           System.err                                                        \tat org.eclipse.gemini.web.internal.StandardWebApplication.start(StandardWebApplication.java:91) \n[2011-06-07 11:07:17.788] ERROR start-signalling-1           System.err                                                        \tat org.eclipse.virgo.web.core.internal.WebBundleLifecycleListener.onStarted(WebBundleLifecycleListener.java:122) \n[2011-06-07 11:07:17.788] ERROR start-signalling-1           System.err                                                        \tat org.eclipse.virgo.kernel.install.artifact.internal.StandardArtifactStateMonitor.onStarted(StandardArtifactStateMonitor.java:247) \n[2011-06-07 11:07:17.789] ERROR start-signalling-1           System.err                                                        \tat org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact.asyncStartSucceeded(AbstractInstallArtifact.java:294) \n[2011-06-07 11:07:17.789] ERROR start-signalling-1           System.err                                                        \tat org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact.access$0(AbstractInstallArtifact.java:291) \n[2011-06-07 11:07:17.790] ERROR start-signalling-1           System.err                                                        \tat org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact$StateMonitorSignal.signalSuccessfulCompletion(AbstractInstallArtifact.java:229) \n[2011-06-07 11:07:17.790] ERROR start-signalling-1           System.err                                                        \tat org.eclipse.virgo.kernel.core.internal.BundleStartTracker$1.run(BundleStartTracker.java:143) \n[2011-06-07 11:07:17.790] ERROR start-signalling-1           System.err                                                        \tat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) \n[2011-06-07 11:07:17.791] ERROR start-signalling-1           System.err                                                        \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) \n[2011-06-07 11:07:17.791] ERROR start-signalling-1           System.err                                                        \tat java.lang.Thread.run(Thread.java:619) \n[2011-06-07 11:07:17.791] ERROR start-signalling-1           System.err                                                        Caused by: java.lang.IllegalArgumentException: <session-config> element is limited to 1 occurrence \n[2011-06-07 11:07:17.792] ERROR start-signalling-1           System.err                                                        \tat org.apache.catalina.startup.SetSessionConfig.begin(WebRuleSet.java:722) \n[2011-06-07 11:07:17.792] ERROR start-signalling-1           System.err                                                        \tat org.apache.tomcat.util.digester.Digester.startElement(Digester.java:1282) \n[2011-06-07 11:07:17.792] ERROR start-signalling-1           System.err                                                        \t... 33 more \n[2011-06-07 11:07:17.793] ERROR start-signalling-1           System.err                                                        Jun 7, 2011 11:07:17 AM org.apache.catalina.startup.ContextConfig parseWebXml \n[2011-06-07 11:07:17.793] ERROR start-signalling-1           System.err                                                        SEVERE: Occurred at line 468 column 21 \n[2011-06-07 11:07:17.806] ERROR start-signalling-4           System.err                                                        Jun 7, 2011 11:07:17 AM org.apache.catalina.startup.ContextConfig configureStart \n[2011-06-07 11:07:17.806] ERROR start-signalling-4           System.err                                                        SEVERE: Marking this application unavailable due to previous error(s) \n[2011-06-07 11:07:17.808] ERROR start-signalling-1           System.err                                                        Jun 7, 2011 11:07:17 AM org.apache.catalina.startup.ContextConfig configureStart \n[2011-06-07 11:07:17.808] ERROR start-signalling-1           System.err                                                        SEVERE: Marking this application unavailable due to previous error(s) \n[2011-06-07 11:07:18.034] ERROR start-signalling-1           System.err                                                        Jun 7, 2011 11:07:18 AM org.apache.catalina.core.StandardContext startInternal \n[2011-06-07 11:07:18.035] ERROR start-signalling-1           System.err                                                        SEVERE: Error getConfigured \n[2011-06-07 11:07:18.036] ERROR start-signalling-1           System.err                                                        Jun 7, 2011 11:07:18 AM org.apache.catalina.core.StandardContext startInternal \n[2011-06-07 11:07:18.037] ERROR start-signalling-1           System.err                                                        SEVERE: Context [/org.eclipse.virgo.apps.repository] startup failed due to previous errors", "count": 0, "id": 146959, "time": "2011-06-08T13:37:25Z", "creator": "gnormington@vmware.com", "creation_time": "2011-06-08T13:37:25Z", "is_private": false}, {"count": 1, "tags": [], "creator": "gnormington@vmware.com", "text": "Created attachment 27131\nZipped full log", "id": 146960, "time": "2011-06-08T13:39:04Z", "bug_id": 51340, "creation_time": "2011-06-08T13:39:04Z", "is_private": false, "attachment_id": 27131}, {"attachment_id": null, "tags": [], "bug_id": 51340, "text": "A more readable version of the stack trace:\n\njava.lang.IllegalArgumentException: <session-config> element is limited to 1 occurrence \n\tat org.apache.catalina.startup.SetSessionConfig.begin(WebRuleSet.java:722) \n\tat org.apache.tomcat.util.digester.Digester.startElement(Digester.java:1282) \n\tat com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startElement(AbstractSAXParser.java:501) \n\tat com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(XMLDocumentFragmentScannerImpl.java:1363) \n\tat com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2755) \n\tat com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648) \n\tat com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511) \n\tat com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808) \n\tat com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737) \n\tat com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119) \n\tat com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205) \n\tat com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522) \n\tat org.apache.tomcat.util.digester.Digester.parse(Digester.java:1543) \n\tat org.apache.catalina.startup.ContextConfig.parseWebXml(ContextConfig.java:1694) \n\tat org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1197) \n\tat org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:882) \n\tat org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:317) \n\tat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119) \n\tat org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:89) \n\tat org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5081) \n\tat org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:145) \n\tat org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:812) \n\tat org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:787) \n\tat org.apache.catalina.core.StandardHost.addChild(StandardHost.java:607) \n\tat org.eclipse.gemini.web.tomcat.internal.TomcatServletContainer.startWebApplication(TomcatServletContainer.java:122) \n\tat org.eclipse.gemini.web.internal.StandardWebApplication.start(StandardWebApplication.java:91) \n\tat org.eclipse.virgo.web.core.internal.WebBundleLifecycleListener.onStarted(WebBundleLifecycleListener.java:122) \n\tat org.eclipse.virgo.kernel.install.artifact.internal.StandardArtifactStateMonitor.onStarted(StandardArtifactStateMonitor.java:247) \n\tat org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact.asyncStartSucceeded(AbstractInstallArtifact.java:294) \n\tat org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact.access$0(AbstractInstallArtifact.java:291) \n\tat org.eclipse.virgo.kernel.install.artifact.internal.AbstractInstallArtifact$StateMonitorSignal.signalSuccessfulCompletion(AbstractInstallArtifact.java:229) \n\tat org.eclipse.virgo.kernel.core.internal.BundleStartTracker$1.run(BundleStartTracker.java:143) \n\tat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) \n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) \n\tat java.lang.Thread.run(Thread.java:619)", "count": 2, "id": 146961, "time": "2011-06-08T13:42:47Z", "creator": "gnormington@vmware.com", "creation_time": "2011-06-08T13:42:47Z", "is_private": false}, {"count": 3, "tags": [], "creator": "markt@apache.org", "is_private": false, "text": "I got some more details from Glyn off-list.\n\nVirgo may use multiple threads for deployment depending on circumstances.\n\nLooking at the xml parsing code, there are 4 digesters each using the same ruleset. Neither object is threadsafe but we sync on the digester so there could be multiple threads using the same webruleset which is a possible explanation for this issue.\n\nI'll proceed on the basis that this is the root cause. We can always re-open if this re-occurs.", "id": 146962, "time": "2011-06-08T15:47:46Z", "bug_id": 51340, "creation_time": "2011-06-08T15:47:46Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 51340, "attachment_id": null, "is_private": false, "id": 146963, "time": "2011-06-08T15:52:45Z", "creator": "markt@apache.org", "creation_time": "2011-06-08T15:52:45Z", "text": "Fixed in 7.0.x and will be included in 7.0.16 onwards."}]