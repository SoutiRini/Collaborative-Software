[{"count": 0, "tags": [], "text": "Created attachment 23224\nRepro file for the issue\n\nRead a xlsx file. Write the same workbook to two different file. Closing FileOutputStream after second write throws XmlValueDisconnectedException.\n\norg.apache.xmlbeans.impl.values.XmlValueDisconnectedException\n        at org.apache.xmlbeans.impl.values.XmlObjectBase.check_orphaned(XmlObjectBase.java:1213)\n        at org.apache.xmlbeans.impl.values.XmlObjectBase.newCursor(XmlObjectBase.java:243)\n        at org.apache.xmlbeans.impl.values.XmlComplexContentImpl.arraySetterHelper(XmlComplexConten\ntImpl.java:1073)\n        at org.openxmlformats.schemas.spreadsheetml.x2006.main.impl.CTFontsImpl.setFontArray(Unknow\nn Source)\n        at org.apache.poi.xssf.model.StylesTable.writeTo(StylesTable.java:323)\n        at org.apache.poi.xssf.model.StylesTable.commit(StylesTable.java:381)\n        at org.apache.poi.POIXMLDocumentPart.onSave(POIXMLDocumentPart.java:171)\n        at org.apache.poi.POIXMLDocumentPart.onSave(POIXMLDocumentPart.java:173)\n        at org.apache.poi.POIXMLDocument.write(POIXMLDocument.java:199)\n        at com.mytest.xssftest.crxlsfile(xssftest.java:39)\n        at com.mytest.xssftest.main(xssftest.java:24)\n\nTested from latest svn trunk.", "is_private": false, "bug_id": 46662, "id": 124652, "time": "2009-02-04T02:24:04Z", "creator": "vinu.kumar@gmail.com", "creation_time": "2009-02-04T02:24:04Z", "attachment_id": 23224}, {"count": 1, "tags": [], "bug_id": 46662, "attachment_id": 23225, "id": 124653, "time": "2009-02-04T02:25:29Z", "creator": "vinu.kumar@gmail.com", "creation_time": "2009-02-04T02:25:29Z", "is_private": false, "text": "Created attachment 23225\nxlsx file used for testing"}, {"count": 2, "tags": [], "bug_id": 46662, "attachment_id": null, "text": "Same for me here. I need to mark some cells in a sheet already open and save it to a new file to download it so the user can see the modifications she's doing on the seet. \n\nIf it's a xls workbook, all goes well but when I have a xlsx workbook, this exception is thrown. So, as a workarround, I have to read the workbook all over again everytime I need to mark and save it (and keep track of all the modifications to apply them in each iteration). \n\nIt adds an unnecessary overhead to the process, so I'd like to see it solved asap.", "id": 145678, "time": "2011-04-10T08:40:10Z", "creator": "geraldolmr@yahoo.com", "creation_time": "2011-04-10T08:40:10Z", "is_private": false}, {"count": 3, "tags": [], "text": "I think this might be an xmlbeans bug - it doesn't look to me like we're doing anything wrong\n\nCan you try a newer version of xmlbeans and see if it fixes it?", "attachment_id": null, "id": 145680, "creator": "apache@gagravarr.org", "time": "2011-04-10T14:55:41Z", "bug_id": 46662, "creation_time": "2011-04-10T14:55:41Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 46662, "attachment_id": null, "id": 147901, "creation_time": "2011-07-13T18:29:23Z", "time": "2011-07-13T18:29:23Z", "creator": "pbtura@gmail.com", "text": "I was seeing this same issue in one of my projects. I tried replacing the xmlbeans jar with the latest version (2.5.0) and it had no effect.", "is_private": false}, {"count": 5, "tags": [], "bug_id": 46662, "attachment_id": null, "id": 155433, "time": "2012-03-31T07:12:22Z", "creator": "rohan1987nair@yahoo.in", "creation_time": "2012-03-31T07:12:22Z", "is_private": false, "text": "Even i am facing the similar problem.\nMy project was working with xls (Excel 2003) but now we had to do changes to make it work with xlsx(Excel 2007).\n\nI added the required jars xmlbeans-2.3.0.jar, ooxml-schemas-1.1.jar, poi-3.7.jar, poi-ooxml-3.7-20101029.jar, dom4j-1.6.1.jar \n\nCan anybody please help with this issue???????"}, {"count": 6, "tags": [], "bug_id": 46662, "attachment_id": null, "id": 157046, "creation_time": "2012-04-02T06:31:01Z", "time": "2012-04-02T06:31:01Z", "creator": "dhanashree.zagade@gmail.com", "text": "I am also facing the above problem; first time when i write in the workbook, it works fine but when second time i try writing in the workbook i get the XMLValueDisconnectedException!!!\nI have the required jars of poi,xmlbeans and dom4j jars\n\nCan anybody please suggest a solution for this problem?????????", "is_private": false}, {"count": 7, "tags": [], "text": "Similar problem as above; I am trying to create a new project working with xlsx. Also i have imported the required jars.\nBut still getting the XMLValueDisconnectedException.\nDoes anyone have a solution to this????\nPlease help!!!", "is_private": false, "id": 157047, "creator": "dixonjose098@gmail.com", "time": "2012-04-02T06:53:20Z", "bug_id": 46662, "creation_time": "2012-04-02T06:53:20Z", "attachment_id": null}, {"count": 8, "tags": [], "text": "\nI am trying to use Excel 2007 (xlsx files), in my project, but i get the XMLValueDisconnectedException.\nI have imported the jars\npoi-ooxml-schemas-3.7, poi-3.7, poi-ooxml-3.7, xmlbeans-2.3  and dom4j jars\n\nStill i get that exception.\nCan anyone please look into this????\n\nThanks...", "is_private": false, "id": 157048, "creator": "sneha.3bhise@gmail.com", "time": "2012-04-02T08:10:34Z", "bug_id": 46662, "creation_time": "2012-04-02T08:10:34Z", "attachment_id": null}, {"count": 9, "tags": [], "text": "Hi,\n\nMy Project is Excel based application where loads of excel file data gets processed. Currently we are using Office 2003 version (.xls format), we now want to switch to Office 2007 (.xlsx format). But when we try to overwrite the .xls file to .xlsx file it gives 'XMLValueDisconnectedException' Error.\n\nWe have tried numerous possibilities but nothing worked. It seems that it is related to POI JARs that we are using (POI 3.7).\n\nCould you please help us out in the solution for the above problem? as we need to migrate the project ASAP.\n\nThanks in advance.\n\n\nRegards,\nPravin A. Khavnekar", "is_private": false, "bug_id": 46662, "id": 157137, "time": "2012-04-04T06:07:24Z", "creator": "pravin.khavnekar@igatepatni.com", "creation_time": "2012-04-04T06:07:24Z", "attachment_id": null}, {"count": 10, "tags": [], "text": "Hi,\n\nThere is a need for our applications to be comaptible with Excel 2007 along with 2003. \n\nWe have a multiple write functionality and with the POI 3.7 using Workbook and WorkbookFactory class works fine for 2003 version but fails for 2007 version. We get an XMLValueDisconnectedException when we try to write the same workbook twice.\n\nAny help in this view is appreciated.\n\nRevert in case you need any further info.\n\nRegards,\nAjay", "is_private": false, "bug_id": 46662, "id": 157138, "time": "2012-04-04T07:26:16Z", "creator": "ajay.nair@igatepatni.com", "creation_time": "2012-04-04T07:26:16Z", "attachment_id": null}, {"count": 11, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 157144, "creation_time": "2012-04-04T11:33:07Z", "time": "2012-04-04T11:33:07Z", "bug_id": 46662, "text": "For those people who this bug affects, please remember that POI is a volunteer project. The quickest way to get a bug fixed is often to work on it yourself!\n\nThere may be a xmlbeans bug here, or there may be a mistake in how POI is calling xmlbeans. Likely avenues for investigation are trying to come up with a much smaller set of code calling xmlbeans that triggers the problem (so a bug report can be raised with the xmlbeans project), and reviewing (likely with a debugger) the POI calls to xmlbeans to identify what is triggering the disconnection", "is_private": false}, {"count": 12, "tags": [], "bug_id": 46662, "attachment_id": null, "is_private": false, "id": 157149, "time": "2012-04-04T13:12:45Z", "creator": "divya.gambhir@igatepatni.com", "creation_time": "2012-04-04T13:12:45Z", "text": "My Project is planning to use xlsx (Excel 2007) file ( previously used was xls (Excel 2003) ) so when we try to overwrite on the Xcel (xlsx file) for second time it gives XMLValueDisconnectedException\n\n \n\nDoes any one have the solution for the above problem????\u201d"}, {"count": 13, "tags": [], "creator": "rpm.manoj@gmail.com", "attachment_id": null, "id": 157213, "creation_time": "2012-04-05T11:10:19Z", "time": "2012-04-05T11:10:19Z", "bug_id": 46662, "text": "Hi,\n       My Project is planning to use .xlsx file, previously used was .xls.\nso when i try to overwrite on the .xlsx file for the second time i am getting XMLValueDisconnectedException\n\nThanks in advance, \nRevert in case you need any further info...\n\nManoj R", "is_private": false}, {"count": 14, "tags": [], "bug_id": 46662, "attachment_id": null, "text": "I have the same problem,\nit seems it hasnt been solved since i just downloaded the latest poi version 3.8", "id": 161937, "time": "2012-09-04T10:21:40Z", "creator": "tallstef@hotmail.com", "creation_time": "2012-09-04T10:21:40Z", "is_private": false}, {"count": 15, "tags": [], "bug_id": 46662, "attachment_id": null, "id": 169151, "creation_time": "2013-08-05T20:18:57Z", "time": "2013-08-05T20:18:57Z", "creator": "dominik.stadler@gmx.at", "text": "There are a number of bug reports for the same issue, duplicating this one to another one with more discussion.\n\n*** This bug has been marked as a duplicate of bug 49940 ***", "is_private": false}]