[{"count": 0, "tags": [], "creator": "manfred.muehlan@rimaone.com", "attachment_id": null, "text": "I have an Excel containing multiple drawings.\n\n/xl/drawings/drawing1.xml=Name: /xl/drawings/drawing1.xml - Content Type: application/vnd.openxmlformats-officedocument.drawing+xml\n/xl/drawings/drawing2.xml=Name: /xl/drawings/drawing2.xml - Content Type: application/vnd.openxmlformats-officedocument.drawing+xml\n/xl/drawings/drawing3.xml=Name: /xl/drawings/drawing3.xml - Content Type: application/vnd.openxmlformats-officedocument.drawing+xml\n/xl/drawings/drawing4.xml=Name: /xl/drawings/drawing4.xml - Content Type: application/vnd.openxmlformats-officedocument.drawing+xml\n/xl/drawings/drawing5.xml=Name: /xl/drawings/drawing5.xml - Content Type: application/vnd.openxmlformats-officedocument.drawing+xml\n/xl/drawings/drawing6.xml=Name: /xl/drawings/drawing6.xml - Content Type: application/vnd.openxmlformats-officedocument.drawing+xml\n/xl/drawings/drawing7.xml=Name: /xl/drawings/drawing7.xml - Content Type: application/vnd.openxmlformats-officedocument.drawing+xml\n/xl/drawings/drawing8.xml=Name: /xl/drawings/drawing8.xml - Content Type: application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml\n\nA Workbook gets created from this file.\n\n\t\tDrawing drawing = sheet.createDrawingPatriarch();\nThrows an Exception:\nException in thread \"main\" org.apache.poi.openxml4j.exceptions.PartAlreadyExistsException: A part with the name '/xl/drawings/drawing8.xml' already exists : Packages shall not contain equivalent part names and package implementers shall neither create nor recognize packages with equivalent part names. [M1.12]\n\nHaving analyzed this issue by looking into the sources, there are the following findings:\n1. XSSFRelation does not contain the ...drawingml.chartshapes+xml\n2. Excel apparently has a unique numbering across (at least) drawing+xml and drawingml.chartshapes+xml Content types\n3. My Suggestion would be to add the new Content type and modify the XSSFSheet createDrawingPatriarch() to:\n  int drawingNumber = \n   getPackagePart().getPackage().getPartsByContentType(XSSFRelation.DRAWINGS.getContentType()).size()\n   getPackagePart().getPackage().getPartsByContentType(XSSFRelation.***NEW CONSTANT FOR drawingml***.getContentType()).size()\n + 1;\n\nThis Problem occurs in 3.9 and in the latest 3.10 beta download.", "id": 169876, "time": "2013-09-03T06:30:19Z", "bug_id": 55516, "creation_time": "2013-09-03T06:30:19Z", "is_private": false}, {"count": 1, "tags": [], "text": "Any chance you could create a very small test excel file, with the mixture of drawing types, and then a short junit test case which triggers this bug?\n\nWe can then use those to test a fix, verify it is fixed, and ensure it stays fixed into the future!", "attachment_id": null, "id": 176812, "creator": "apache@gagravarr.org", "time": "2014-07-31T16:17:12Z", "bug_id": 55516, "creation_time": "2014-07-31T16:17:12Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 55516, "attachment_id": null, "id": 185183, "time": "2015-09-13T12:49:57Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-09-13T12:49:57Z", "is_private": false, "text": "No response since a long time, hard to fix without a file that allows to reproduce the problem, therefore I am closing this as WONTFIX for now, please reopen if you still see this problem and can provide more information, especially a sample file and related unit-test code."}, {"count": 3, "tags": [], "bug_id": 55516, "text": "fixed in https://svn.apache.org/viewvc?view=rev&rev=1764863 by Nick Burch", "id": 194449, "time": "2016-10-15T12:35:29Z", "creator": "tuyenivt@gmail.com", "creation_time": "2016-10-15T12:35:29Z", "is_private": false, "attachment_id": null}, {"count": 4, "attachment_id": null, "creator": "tuyenivt@gmail.com", "text": "same my problem at https://bz.apache.org/bugzilla/show_bug.cgi?id=60255", "id": 194450, "time": "2016-10-15T12:41:34Z", "bug_id": 55516, "creation_time": "2016-10-15T12:41:34Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "bug_id": 55516, "attachment_id": null, "id": 194453, "time": "2016-10-15T17:11:59Z", "creator": "onealj@apache.org", "creation_time": "2016-10-15T17:11:59Z", "is_private": false, "text": "\n\n*** This bug has been marked as a duplicate of bug 60255 ***"}]