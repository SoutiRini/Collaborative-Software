[{"count": 0, "tags": [], "creator": "stefan.eggerstorfer@gmail.com", "attachment_id": null, "id": 165728, "time": "2013-03-09T23:33:35Z", "bug_id": 54659, "creation_time": "2013-03-09T23:33:35Z", "is_private": false, "text": "Using the annotation API of the echo websocket example, following exception is thrown:\n\njava.lang.IllegalStateException: Failed to create configurator of type [javax.websocket.server.ServerEndpointConfig$Configurator] for POJO of type [java.lang.Class]\n\tat org.apache.tomcat.websocket.server.WsServerContainer.getServerEndpointConfiguration(WsServerContainer.java:219)\n\tat org.apache.tomcat.websocket.server.WsServlet.doGet(WsServlet.java:98)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:621)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:728)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:303)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:223)\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:107)\n\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:474)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:155)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:75)\n\tat org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:922)\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:90)\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:447)\n\tat org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:971)\n\tat org.apache.coyote.http11.Http11NioProcessor.process(Http11NioProcessor.java:234)\n\tat org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:620)\n\tat org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1566)\n\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1540)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n\tat java.lang.Thread.run(Thread.java:722)\nCaused by: java.lang.InstantiationException\n\tat sun.reflect.InstantiationExceptionConstructorAccessorImpl.newInstance(InstantiationExceptionConstructorAccessorImpl.java:48)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:525)\n\tat java.lang.Class.newInstance0(Class.java:372)\n\tat java.lang.Class.newInstance(Class.java:325)\n\tat org.apache.tomcat.websocket.server.WsServerContainer.getServerEndpointConfiguration(WsServerContainer.java:217)\n\t... 22 more\n\nI suppose this is caused by the default value of ServerEndpoint.Configurator:\npublic Class<? extends ServerEndpointConfig.Configurator> configurator() \n  default ServerEndpointConfig.Configurator.class;\n\nServerEndpointConfig.Configurator is an abstract class and this causes the newInstance call to fail.\n\nI could bypass this issue by using the class DefaultServerEndpointConfigurator as configurator in the echo example:\n@ServerEndpoint(value = \"/websocket/echoAnnotation\", configurator = DefaultServerEndpointConfigurator.class)\n\nI assume this class should be the default value for ServerEndpointConfig.Configurator."}, {"count": 1, "tags": [], "bug_id": 54659, "attachment_id": null, "is_private": false, "id": 165731, "time": "2013-03-10T11:57:08Z", "creator": "markt@apache.org", "creation_time": "2013-03-10T11:57:08Z", "text": "There were some failing unit tests that had the same root cause. Fixing the unit tests (r1454839) also fixed this.\n\nThe current default is correct so it needs special handling."}]