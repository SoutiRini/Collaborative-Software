[{"count": 0, "tags": [], "text": "The Win2K machine is running IIS 5.  However, IIS and Tomcat are NOT \nconnected.  Only one web application exists in Tomcat and is called directly \nvia http://server.name:8080/WebApp.\n\nOur network team regularly runs security tests on our servers, and noticed a \nnew port (8080) open after I installed Tomcat.  They have included it in their \ntesting scheule.\n\nWhenever they try to run certain bogus URLs it is causing Tomcat to throw an \nexception.  It is not crashing the server, and does not appear to be \ninterfering with server functionality or the web application, but nonetheless I \nam seeing an exception occur in the logs.\n\nThe URLs they call that cause these exceptions include:\n/scripts/..\\../winnt/system32/cmd.exe\n/_vti_bin/..\\../winnt/system32/cmd.exe\n/msadc/..\\../winnt/system32/cmd.exe\n\n(basically anything w/ a DOS backslash leading to an actual cmd.exe file)\n\nAn example exception that occurs (taken from localhost_log) is below:\n\n2003-04-11 10:16:05 StandardContext[]: Mapping contextPath='' with \nrequestURI='/_vti_bin/..\\../winnt/system32/cmd.exe' and \nrelativeURI='/_vti_bin/..\\../winnt/system32/cmd.exe'\n2003-04-11 10:16:05 StandardContext[]:  Mapped to servlet 'default' with \nservlet path '/_vti_bin/..\\../winnt/system32/cmd.exe' and path info 'null' and \nupdate=true\n2003-04-11 10:16:05 default: DefaultServlet.serveResource:  Serving \nresource 'null' headers and data\n2003-04-11 10:16:05 StandardWrapperValve[default]: Servlet.service() for \nservlet default threw exception\njava.lang.NullPointerException\n\tat java.io.File.<init>(File.java:263)\n\tat org.apache.naming.resources.FileDirContext.file\n(FileDirContext.java:880)\n\tat org.apache.naming.resources.FileDirContext.getAttributes\n(FileDirContext.java:487)\n\tat org.apache.naming.resources.BaseDirContext.getAttributes\n(BaseDirContext.java:797)\n\tat org.apache.naming.resources.ProxyDirContext.cacheLoad\n(ProxyDirContext.java:1462)\n\tat org.apache.naming.resources.ProxyDirContext.cacheLookup\n(ProxyDirContext.java:1386)\n\tat org.apache.naming.resources.ProxyDirContext.lookup\n(ProxyDirContext.java:293)\n\tat org.apache.catalina.servlets.DefaultServlet$ResourceInfo.set\n(DefaultServlet.java:2267)\n\tat org.apache.catalina.servlets.DefaultServlet$ResourceInfo.<init>\n(DefaultServlet.java:2219)\n\tat org.apache.catalina.servlets.DefaultServlet.serveResource\n(DefaultServlet.java:921)\n\tat org.apache.catalina.servlets.DefaultServlet.doGet\n(DefaultServlet.java:506)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:740)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java:247)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java:193)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke\n(StandardWrapperValve.java:260)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardContextValve.invoke\n(StandardContextValve.java:191)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.valves.CertificatesValve.invoke\n(CertificatesValve.java:246)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:641)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardContext.invoke\n(StandardContext.java:2396)\n\tat org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:180)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.valves.ErrorDispatcherValve.invoke\n(ErrorDispatcherValve.java:170)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:641)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke\n(ErrorReportValve.java:172)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:641)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:174)\n\tat \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNex\nt(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.coyote.tomcat4.CoyoteAdapter.service\n(CoyoteAdapter.java:223)\n\tat org.apache.coyote.http11.Http11Processor.process\n(Http11Processor.java:405)\n\tat \norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnectio\nn(Http11Protocol.java:380)\n\tat org.apache.tomcat.util.net.TcpWorkerThread.runIt\n(PoolTcpEndpoint.java:508)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:533)\n\tat java.lang.Thread.run(Thread.java:536)\n\nIf you require further information please email me: greensun@usa.net\nThanks,\n-Becky", "attachment_id": null, "bug_id": 19202, "id": 35728, "time": "2003-04-21T21:43:51Z", "creator": "greensun@usa.net", "creation_time": "2003-04-21T21:43:51Z", "is_private": false}, {"count": 1, "tags": [], "creator": "markt@apache.org", "is_private": false, "text": "I have just tried the URLs you suggested (and various variations on a similar \ntheme) and I do not see any NPEs. Please re-open if you still see this error \nwith the latest version of tomcat.", "id": 55722, "time": "2004-04-13T21:21:14Z", "bug_id": 19202, "creation_time": "2004-04-13T21:21:14Z", "attachment_id": null}]