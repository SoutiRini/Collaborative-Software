[{"count": 0, "tags": [], "bug_id": 15727, "attachment_id": null, "text": "Tried POI HSSF the other day and it was great!  Then I noticed a few issues \nwith the example code I found that printed an entire worksheet, notably that it \ndidn't like blank cells. I've attached a modified version that no longer has \nthis problem. Also, I've made it a JSP page (though I know this isn't the\nbest way to use POI in a *real* app) which makes it easy for someone to try out \nPOI/HSSF and have a simple example to work from. The JSP is attached below as a \npossible contribution to POI. \n\n\nJSP source file begins below this line.  \n\n<%@page contentType=\"text/html\" \nimport=\"java.io.*,org.apache.poi.poifs.filesystem.POIFSFileSystem,org.apache.poi\n.hssf.record.*,org.apache.poi.hssf.model.*,org.apache.poi.hssf.usermodel.*,org.a\npache.poi.hssf.util.*\" %>\n<html>\n<head><title>Read Excel file </title>\n</head>\n<body>\nAn example of using Jakarta POI's HSSF package to read an excel spreadsheet: \n\n\n<form name=\"form1\" method=\"get\" action=\"\">\nSelect an Excel file to read. \n  <input type=\"file\" name=\"xls_filename\" onChange=\"form1.submit()\">\n</form>\n\n<%\n\tString filename = request.getParameter(\"xls_filename\"); \n\tif (filename != null && !filename.equals(\"\")) {\n%>\t\n\t<br>You chose the file <%= filename %>. \n\t<br><br>It's contents are: \t\n<%\t\n            try\n            {\n\n                // create a poi workbook from the excel spreadsheet file\n                POIFSFileSystem fs =\n                    new POIFSFileSystem(new FileInputStream(filename));\n                HSSFWorkbook wb = new HSSFWorkbook(fs);\n\n                for (int k = 0; k < wb.getNumberOfSheets(); k++)\n                {\n%>\t\t\t\t\n                    <br><br>Sheet  <%= k %> <br>\n<%\t\t\t\t\t\n\t\t\t\t\t\n                    HSSFSheet sheet = wb.getSheetAt(k);\n                    int       rows  = sheet.getPhysicalNumberOfRows();\n\n                    for (int r = 0; r < rows; r++)\n                    {\n                        HSSFRow row   = sheet.getRow(r);\n                        if (row != null) { \n                            int     cells = row.getPhysicalNumberOfCells();\n%>\n\t\t\t\t\t\t\t<br><b>ROW  <%= \nrow.getRowNum() %> </b>\n<%\n                            for (short c = 0; c < cells; c++) \n                            { \n                                HSSFCell cell  = row.getCell(c);\n                                if (cell != null) { \n                                    String   value = null;\n\n                                    switch (cell.getCellType())\n                                    {\n\n                                        case HSSFCell.CELL_TYPE_FORMULA :\n                                            value = \"FORMULA \";\n                                            break;\n\n                                        case HSSFCell.CELL_TYPE_NUMERIC :\n                                            value = \"NUMERIC value=\"\n                                                    + cell.getNumericCellValue\n();\n                                            break;\n\n                                        case HSSFCell.CELL_TYPE_STRING :\n                                            value = \"STRING value=\"\n                                                    + cell.getStringCellValue();\n                                            break;\n\n                                        default :\n                                    }\n%>\t\t\t\t\t\t\t\t\t\n                                    <%= \"CELL col=\" \n\t\t\t\t\t\t\t\t\t\n\t+ cell.getCellNum()\n                                        + \" VALUE=\" + value %>\n<%\n                                } \n                            }\n                        }\n                    }\n                }\n            }\n            catch (Exception e)\n            {\n%>\n\tError occurred:  <%= e.getMessage() %>\n<%\t\t\t\n                e.printStackTrace();\n            }\n\n\t} \n%> \n</body>\n</html>\n\n\n\nJSP source file ends above this line.", "id": 28767, "time": "2002-12-30T23:22:41Z", "creator": "bw@mcwestcorp.com", "creation_time": "2002-12-30T23:22:41Z", "is_private": false}, {"count": 1, "tags": [], "text": "added in the examples directory. Thanks", "is_private": false, "bug_id": 15727, "id": 30076, "time": "2003-01-26T20:45:50Z", "creator": "avik@apache.org", "creation_time": "2003-01-26T20:45:50Z", "attachment_id": null}]