[{"count": 0, "tags": [], "bug_id": 48101, "attachment_id": 24459, "text": "Created attachment 24459\nthis is srclib/apr/config.log\n\nI tried to compile apache configured as\n\n$ CC=/usr/sfw/bin/gcc ./configure --prefix=/var/tmp/apache --with-included-apr\n--enable-authnz-ldap --with-ldap --enable-ldap\n$ make\n...\n/bin/bash /root/Downloads/httpd-2.2.14/srclib/apr/libtool --silent\n--mode=compile /usr/sfw/bin/gcc -g -O2   -DHAVE_CONFIG_H -DSOLARIS2=11\n-D_POSIX_PTHREAD_SEMANTICS -D_REENTRANT -D_LARGEFILE64_SOURCE   -I./include\n-I/root/Downloads/httpd-2.2.14/srclib/apr/include/arch/unix\n-I./include/arch/unix\n-I/root/Downloads/httpd-2.2.14/srclib/apr/include/arch/unix\n-I/root/Downloads/httpd-2.2.14/srclib/apr/include  -o locks/unix/proc_mutex.lo\n-c locks/unix/proc_mutex.c && touch locks/unix/proc_mutex.lo\nlocks/unix/proc_mutex.c: In function `proc_mutex_choose_method':\nlocks/unix/proc_mutex.c:834: error: `mutex_fcntl_methods' undeclared (first use\nin this function)\nlocks/unix/proc_mutex.c:834: error: (Each undeclared identifier is reported\nonly once\nlocks/unix/proc_mutex.c:834: error: for each function it appears in.)\ngmake[3]: *** [locks/unix/proc_mutex.lo] Error 1\ngmake[3]: Leaving directory `/root/Downloads/httpd-2.2.14/srclib/apr'\ngmake[2]: *** [all-recursive] Error 1\ngmake[2]: Leaving directory `/root/Downloads/httpd-2.2.14/srclib/apr'\ngmake[1]: *** [all-recursive] Error 1\ngmake[1]: Leaving directory `/root/Downloads/httpd-2.2.14/srclib'\ngmake: *** [all-recursive] Error 1\n\n\nI am attaching srclib/apr/config.log\n\nThank you\n\n-- \n  Vlad", "id": 131553, "time": "2009-11-02T02:39:31Z", "creator": "Vladimir.Marek@Sun.COM", "creation_time": "2009-11-02T02:39:31Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 48101, "attachment_id": null, "is_private": false, "id": 131581, "time": "2009-11-02T10:21:30Z", "creator": "nick@webthing.com", "creation_time": "2009-11-02T10:21:30Z", "text": "I've just built successfully on opensolaris/x86 using your commandline.\n\nPoking in a bit more detail, I see mutex_fcntl_methods is defined at line 623 in locks/unix/proc_mutex.c, within \"#if APR_HAS_FCNTL_SERIALIZE\".  Line 834 is within \"#if APR_USE_FCNTL_SERIALIZE\"!\n\nDigging further, the problem appears to be evident in your config.log:\nfcntlser='1'\nhasfcntlser='0'\n(mine, by contrast, set both to 1).\n\nAs a workaround, take a look in apr.h, find some APR_HAS_foo_SERIALIZE that's set to 1, and set the corresponding APR_USE_foo_SERIALIZE."}, {"count": 2, "tags": [], "creator": "trawick@apache.org", "text": ">hasfcntlser='0'\n>#define HAVE_F_SETLK 1\n> #define HAVE_FCNTL_H 1\n\nGiven this combination, it would appear to be a shell script (configure) issue.\n\nWhat is the output of \"uname -a\"?\n\nIf you can try it Vlad, does the problem go away if you edit the first line of srclib/apr/configure to reference bash instead of /bin/sh?", "id": 131584, "time": "2009-11-02T10:54:40Z", "bug_id": 48101, "creation_time": "2009-11-02T10:54:40Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 48101, "attachment_id": null, "text": "Hi,\n\nthank you for very quick response. In the mean time I found out that using SunCC instead of gcc works. I can attach SunCC's config.log if it is of any help.\n\nMy uname -a is:\n\n$ uname -a\nSunOS unknown 5.11 snv_126 i86pc i386 i86pc Solaris\n\nUsing /bin/bash instead of /bin/sh at the top of srclib/apr/configure also makes the compilation work. But I haven't found yet why exactly.\n\nI'll try to investigate more.", "id": 131628, "time": "2009-11-03T09:00:08Z", "creator": "Vladimir.Marek@Sun.COM", "creation_time": "2009-11-03T09:00:08Z", "is_private": false}, {"count": 4, "tags": [], "creator": "trawick@apache.org", "text": "I tried the same httpd build invocation with 2.2.14 on snv_126 and cannot reproduce.", "id": 131853, "time": "2009-11-10T13:30:52Z", "bug_id": 48101, "creation_time": "2009-11-10T13:30:52Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "Vladimir.Marek@Sun.COM", "is_private": false, "text": "I can't reproduce it anymore. Even that I was able to see the problem consistently back then, it does not happen now. I'm using the same virtual machine as before. After closer inspection I can see that gcc was crashing a lot when I was seeing the issues.\n\nI'm sorry for the noise, it seems to be issue on my side.\n\nPlease close the bug.\n\nThank you\n\n-- \n  Vlad", "id": 132007, "time": "2009-11-16T06:17:14Z", "bug_id": 48101, "creation_time": "2009-11-16T06:17:14Z", "attachment_id": null}, {"count": 6, "tags": [], "creator": "trawick@apache.org", "text": "np", "id": 132011, "time": "2009-11-16T06:38:58Z", "bug_id": 48101, "creation_time": "2009-11-16T06:38:58Z", "is_private": false, "attachment_id": null}]