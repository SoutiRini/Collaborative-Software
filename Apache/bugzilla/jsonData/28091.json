[{"count": 0, "tags": [], "creator": "alexandra.angibault@lexmarkpartners-europe.com", "attachment_id": null, "id": 54963, "time": "2004-03-31T14:08:59Z", "bug_id": 28091, "creation_time": "2004-03-31T14:08:59Z", "is_private": false, "text": "Hi all,\n\nI have the following problem. I try to open excel files that I received by \nemail. I can't open some with POI. But I can open them with Excel 97. They \naren't protected by a password.\nI get the following exception with the HSSF class:\n\njava.lang.ArrayIndexOutOfBoundsException: 11\n        at org.apache.poi.util.LittleEndian.getNumber(LittleEndian.java:491)\n        at org.apache.poi.util.LittleEndian.getInt(LittleEndian.java:139)\n        at org.apache.poi.hssf.record.BOFRecord.fillFields(BOFRecord.java:133)\n        at org.apache.poi.hssf.record.Record.fillFields(Record.java:90)\n        at org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n        at org.apache.poi.hssf.record.BOFRecord.<init>(BOFRecord.java:98)\n        at org.apache.poi.hssf.dev.BiffViewer.createRecord(BiffViewer.java:251)\n        at org.apache.poi.hssf.dev.BiffViewer.createRecords(BiffViewer.java:114)\n        at org.apache.poi.hssf.dev.BiffViewer.run(BiffViewer.java:72)\n        at org.apache.poi.hssf.dev.BiffViewer.main(BiffViewer.java:649)\n\nC:\\Documents and Settings\\aangibau\\My Documents\\projets\\Channel Knowledge\\Excel \nconversion\\Java\\Jakart\na POI HSSF>d:\\JDK\\bin\\java HSSF ..\\files_to_convert\\Lex-LS.xls\n\nC:\\Documents and Settings\\aangibau\\My Documents\\projets\\Channel Knowledge\\Excel \nconversion\\Java\\Jakart\na POI HSSF>d:\\JDK\\bin\\java HSSF ..\\files_to_convert\\Lex-\nLS.xls ..\\converted_files\\test.xls\nreadwrite test\njava.lang.reflect.InvocationTargetException\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance\n(NativeConstructorAccessorImpl.java:39\n)\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance\n(DelegatingConstructorAccessorImpl\n.java:27)\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:274)\n        at org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java:224)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java:160)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:165)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:132)\n        at HSSF.<init>(HSSF.java:109)\n        at HSSF.main(HSSF.java:345)\nCaused by: java.lang.ArrayIndexOutOfBoundsException: 11\n        at org.apache.poi.util.LittleEndian.getNumber(LittleEndian.java:491)\n        at org.apache.poi.util.LittleEndian.getInt(LittleEndian.java:139)\n        at org.apache.poi.hssf.record.BOFRecord.fillFields(BOFRecord.java:133)\n        at org.apache.poi.hssf.record.Record.fillFields(Record.java:90)\n        at org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n        at org.apache.poi.hssf.record.BOFRecord.<init>(BOFRecord.java:98)\n        ... 10 more\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record \ninstance, the following e\nxception occured: null\n        at org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java:237)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java:160)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:165)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:132)\n        at HSSF.<init>(HSSF.java:109)\n        at HSSF.main(HSSF.java:345)\n\n\nI tried to read them with BiffViewer and I also got an error:\njava.lang.ArrayIndexOutOfBoundsException: 11\n        at org.apache.poi.util.LittleEndian.getNumber(LittleEndian.java:491)\n        at org.apache.poi.util.LittleEndian.getInt(LittleEndian.java:139)\n        at org.apache.poi.hssf.record.BOFRecord.fillFields(BOFRecord.java:133)\n        at org.apache.poi.hssf.record.Record.fillFields(Record.java:90)\n        at org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n        at org.apache.poi.hssf.record.BOFRecord.<init>(BOFRecord.java:98)\n        at org.apache.poi.hssf.dev.BiffViewer.createRecord(BiffViewer.java:251)\n        at org.apache.poi.hssf.dev.BiffViewer.createRecords(BiffViewer.java:114)\n        at org.apache.poi.hssf.dev.BiffViewer.run(BiffViewer.java:72)\n        at org.apache.poi.hssf.dev.BiffViewer.main(BiffViewer.java:649)\n\nI searched on internet and didn't find any solution.\nI hope someone will have an idea.\n\nThanks\n\nRegards"}, {"text": "Support for reading a short BOF record was added with the fix for bug 42794 (svn r594102)\n\nThere are no details provided about the offending file.  Hopefully this was the only problem.", "tags": [], "bug_id": 28091, "attachment_id": null, "count": 1, "id": 116458, "time": "2008-05-10T19:04:24Z", "creator": "josh@apache.org", "creation_time": "2008-05-10T19:04:24Z", "is_private": false}]