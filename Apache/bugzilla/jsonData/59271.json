[{"count": 0, "tags": [], "bug_id": 59271, "attachment_id": null, "id": 189937, "creation_time": "2016-04-04T14:59:26Z", "time": "2016-04-04T14:59:26Z", "creator": "nospam@kaigrabfelder.de", "text": "The following formula works fine in poi 3.12 but does no longer work with poi 3.13 or 3.14\n\nThe error that we are getting with 3.13 is the following\n\nCaused by: org.apache.poi.ss.formula.FormulaParseException: Parse error near char 71 ')' in specified formula '(VLOOKUP(\"item1\", A2:B3, 2, FALSE) - VLOOKUP(\"item2\", A2:B3, 2, FALSE) )'. Expected cell ref or constant literal\n\tat org.apache.poi.ss.formula.FormulaParser.expected(FormulaParser.java:208)\n\tat org.apache.poi.ss.formula.FormulaParser.parseSimpleFactor(FormulaParser.java:1148)\n\tat org.apache.poi.ss.formula.FormulaParser.percentFactor(FormulaParser.java:1103)\n\tat org.apache.poi.ss.formula.FormulaParser.powerFactor(FormulaParser.java:1090)\n\tat org.apache.poi.ss.formula.FormulaParser.Term(FormulaParser.java:1450)\n\tat org.apache.poi.ss.formula.FormulaParser.additiveExpression(FormulaParser.java:1570)\n\tat org.apache.poi.ss.formula.FormulaParser.concatExpression(FormulaParser.java:1554)\n\tat org.apache.poi.ss.formula.FormulaParser.comparisonExpression(FormulaParser.java:1511)\n\tat org.apache.poi.ss.formula.FormulaParser.intersectionExpression(FormulaParser.java:1499)\n\tat org.apache.poi.ss.formula.FormulaParser.unionExpression(FormulaParser.java:1472)\n\tat org.apache.poi.ss.formula.FormulaParser.parseSimpleFactor(FormulaParser.java:1131)\n\tat org.apache.poi.ss.formula.FormulaParser.percentFactor(FormulaParser.java:1103)\n\tat org.apache.poi.ss.formula.FormulaParser.powerFactor(FormulaParser.java:1090)\n\tat org.apache.poi.ss.formula.FormulaParser.Term(FormulaParser.java:1450)\n\tat org.apache.poi.ss.formula.FormulaParser.additiveExpression(FormulaParser.java:1570)\n\tat org.apache.poi.ss.formula.FormulaParser.concatExpression(FormulaParser.java:1554)\n\tat org.apache.poi.ss.formula.FormulaParser.comparisonExpression(FormulaParser.java:1511)\n\tat org.apache.poi.ss.formula.FormulaParser.intersectionExpression(FormulaParser.java:1492)\n\tat org.apache.poi.ss.formula.FormulaParser.unionExpression(FormulaParser.java:1472)\n\tat org.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:1612)\n\tat org.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:153)\n\tat org.apache.poi.xssf.usermodel.XSSFEvaluationWorkbook.getFormulaTokens(XSSFEvaluationWorkbook.java:53)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateAny(WorkbookEvaluator.java:261)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluate(WorkbookEvaluator.java:205)\n\tat org.apache.poi.xssf.usermodel.BaseXSSFFormulaEvaluator.evaluateFormulaCellValue(BaseXSSFFormulaEvaluator.java:189)\n\tat org.apache.poi.xssf.usermodel.BaseXSSFFormulaEvaluator.evaluateFormulaCell(BaseXSSFFormulaEvaluator.java:117)\n\nI've attached an excel file and a unit test to reproduce the bug. I guess that this is the same issue as https://bz.apache.org/bugzilla/show_bug.cgi?id=58648", "is_private": false}, {"count": 1, "tags": [], "creator": "nospam@kaigrabfelder.de", "attachment_id": 33723, "is_private": false, "id": 189938, "time": "2016-04-04T15:06:53Z", "bug_id": 59271, "creation_time": "2016-04-04T15:06:53Z", "text": "Created attachment 33723\ntestcase to reproduce the issue"}, {"count": 2, "tags": [], "bug_id": 59271, "attachment_id": 33724, "text": "Created attachment 33724\nexcel testcase used for the unit test", "id": 189939, "time": "2016-04-04T15:07:19Z", "creator": "nospam@kaigrabfelder.de", "creation_time": "2016-04-04T15:07:19Z", "is_private": false}, {"count": 3, "attachment_id": null, "creator": "dominik.stadler@gmx.at", "is_private": false, "id": 189942, "time": "2016-04-04T19:24:19Z", "bug_id": 59271, "creation_time": "2016-04-04T19:24:19Z", "tags": [], "text": "Looks very much like a duplicate of bug 58648.\n\nIt's better to try to help fix it there if you can provide more information or even a patch instead of creating a new bug entry.\n\n*** This bug has been marked as a duplicate of bug 58648 ***"}]