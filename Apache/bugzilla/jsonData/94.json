[{"count": 0, "tags": [], "bug_id": 94, "is_private": false, "text": "I am trying to catch all errors from my JSP, but I have found a problem\r\nwith Jakarta-Tomcat that it is not on OrionServer.\r\nI have two jsp: jsp1 and jsp2. jsp1 includes jsp2, and then jsp2 throws\r\nan error. I am using tomcat 3.2B3 on windows 2000 with jdk 1.3.\r\nI have tested the same with orionserver and it works fine. On this mail\r\nI send the error thrown and the three jsp pages: jsp1.jsp, jsp2.jsp and\r\nerrorPage.jsp.\r\n\r\nWhen I run http://localhost/mycontext/jsp1.jsp I get the following\r\nerror:\r\n\r\n\r\nThis is the content from jsp1 before inserting jsp2\r\n--------------------------------------------------------------------------------\r\n\r\nIncluded servlet error: 500\r\nLocalizacion:/isum/jsp1.jsp\r\nError interno del servlet:\r\n\r\njava.lang.IllegalStateException: Cannot forward as OutputStream or\r\nWriter has already been obtained\r\n at\r\norg.apache.tomcat.facade.RequestDispatcherImpl.forward(RequestDispatcherImpl.java:150)\r\n\r\n at\r\norg.apache.jasper.runtime.PageContextImpl.forward(PageContextImpl.java:414)\r\n\r\n at\r\norg.apache.jasper.runtime.PageContextImpl.handlePageException(PageContextImpl.java:438)\r\n\r\n at\r\n_0002fjsp_00032_0002ejspjsp2_jsp_5._jspService(_0002fjsp_00032_0002ejspjsp2_jsp_5.java:70)\r\n\r\n at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:119)\r\n at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\r\n at\r\norg.apache.jasper.servlet.JspServlet$JspServletWrapper.service(JspServlet.java:177)\r\n\r\n at\r\norg.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:296)\r\n\r\n at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:369)\r\n at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\r\n at\r\norg.apache.tomcat.core.ServletWrapper.doService(ServletWrapper.java:368)\r\n\r\n at org.apache.tomcat.core.Handler.service(Handler.java:261)\r\n at\r\norg.apache.tomcat.core.ServletWrapper.service(ServletWrapper.java:356)\r\n at\r\norg.apache.tomcat.facade.RequestDispatcherImpl.include(RequestDispatcherImpl.java:308)\r\n\r\n at\r\norg.apache.jasper.runtime.PageContextImpl.include(PageContextImpl.java:407)\r\n\r\n at\r\n_0002fjsp_00031_0002ejspjsp1_jsp_5._jspService(_0002fjsp_00031_0002ejspjsp1_jsp_5.java:69)\r\n\r\n at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:119)\r\n at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\r\n at\r\norg.apache.jasper.servlet.JspServlet$JspServletWrapper.service(JspServlet.java:177)\r\n\r\n at\r\norg.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:296)\r\n\r\n at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:369)\r\n at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\r\n at\r\norg.apache.tomcat.core.ServletWrapper.doService(ServletWrapper.java:368)\r\n\r\n at org.apache.tomcat.core.Handler.service(Handler.java:261)\r\n at\r\norg.apache.tomcat.core.ServletWrapper.service(ServletWrapper.java:356)\r\n at\r\norg.apache.tomcat.core.ContextManager.internalService(ContextManager.java:720)\r\n\r\n at\r\norg.apache.tomcat.core.ContextManager.service(ContextManager.java:666)\r\n at\r\norg.apache.tomcat.service.http.HttpConnectionHandler.processConnection(HttpConnectionHandler.java:194)\r\n\r\n at\r\norg.apache.tomcat.service.TcpWorkerThread.runIt(PoolTcpEndpoint.java:403)\r\n\r\n at\r\norg.apache.tomcat.util.ThreadPool$ControlRunnable.run(ThreadPool.java:498)\r\n\r\n at java.lang.Thread.run(Unknown Source)\r\n\r\n\r\n--------------------------------------------------------------------------------\r\n\r\nThis is the content from jsp1 after inserting jsp2\r\n\r\n\r\n---------- jsp1.jsp----------\r\n<%@ page errorPage=\"/errorPage.jsp\" %>\r\n<html>\r\n<head><title>JSP Page</title></head>\r\n<body>\r\n<%\r\nout.println(\"This is the content from jsp1 before inserting jsp2\");\r\n%>\r\n<hr>\r\n<jsp:include page=\"jsp2.jsp\" flush=\"true\"/>\r\n<hr>\r\n<%\r\nout.println(\"This is the content from jsp1 after inserting jsp2\");\r\n\r\n%>\r\n\r\n</body>\r\n</html>\r\n\r\n------------------------------\r\n\r\n---------- jsp2.jsp----------\r\n<%@ page errorPage=\"errorPage.jsp\" %>\r\n\r\n\r\n<%\r\nout.println(\"Lets throw an exception:.....\");\r\nif (true) throw new Exception(\"Oops an Error has occurred\");\r\n%>\r\n\r\n------------------------------\r\n\r\n---------- errorPage.jsp----------\r\n<%@ page isErrorPage=\"true\" import=\"java.io.*,com.tissat.isum.util.Util\"\r\n%>\r\n<html>\r\n<head><title>JSP Page</title></head>\r\n<body>\r\n\r\nSomething bad has happened. And it looks like: <br>\r\n\r\n<%= \"Exception \"+ exception %>\r\n\r\n<br><br>\r\n\r\n<%= \"Message \" + exception.getMessage() %>\r\n<%\r\nUtil.error(exception.toString());\r\n//exception.printStackTrace(); %>\r\n\r\n<br>\r\n\r\n</body>\r\n</html>\r\n\r\n--------------------------------------\r\n\r\nHow could this be solved? Has this already reported as a bug?\r\n\r\n\r\n", "id": 74, "time": "2000-09-07T08:36:34Z", "creator": "dev@tomcat.apache.org", "creation_time": "2000-09-07T08:36:34Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 94, "attachment_id": null, "text": "This works fine in 3.2.2b1.  It must have been fixed and the bug report never \nclosed.", "id": 980, "time": "2001-03-05T08:59:47Z", "creator": "marc.saegesser@apropos.com", "creation_time": "2001-03-05T08:59:47Z", "is_private": false}, {"count": 2, "tags": [], "creator": "arun@ipin.com", "text": "Actually, I wonder that it is actually fixed....  \n\nThe JSP include is supposed to flush the jsp doing the include into the \nresponse stream.  Once flushed, an error should cause indeterminate output - \nthe engine should not be able to write a completely separate errorpage to the \nresponse stream given that the first part of the original page has already been \nflushed!  ", "id": 2399, "time": "2001-05-10T18:29:46Z", "bug_id": 94, "creation_time": "2001-05-10T18:29:46Z", "is_private": false, "attachment_id": null}]