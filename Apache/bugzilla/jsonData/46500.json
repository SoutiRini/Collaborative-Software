[{"count": 0, "tags": [], "bug_id": 46500, "text": "First i'm not certain that this qualifies as a bug but it shure bites me hard right now.\n\nWhen upgrading to 2.2.11 on a \"slightly old\" RHEL4-machine (we prefer to verify patches which leave us a bit behind at times) the configuration of mod_proxy_ajp balancer members break on the ping attribute se below:\n\n#/software/apache2/2.2.11/bin/httpd -t -f /data/conf/apache/director/httpd.conf -d /data/conf/apache/director\n[Fri Jan 09 11:59:13 2009] [warn] module auth_basic_module is already loaded, skipping\nSyntax error on line 12 of /data/conf/apache/director/extra/tomcatvtest_ajp.conf:\nBalancerMember Ping/Pong timeout has wrong format\nExit 1\n\ntomcatvtest_ajp.conf follows:\n\n<Proxy balancer://tomcat_vtest>\n        BalancerMember ajp://wc-special5.dc.ltu.se:7011 route=wc-special5 lbset=10 ping=10 timeout=60\n        BalancerMember ajp://wc-special6.dc.ltu.se:7011 route=wc-special6 lbset=10 ping=10 timeout=60\n        ProxySet lbmethod=byrequests\n        ProxySet maxattempts=1\n        ProxySet timeout=60\n        ProxySet nofailover=Off\n        ProxySet stickysession=JSESSIONID\n</Proxy>\n\nI presume that this relates to the following from the changelogs:\n *) mod_proxy: Add the possibility to set the worker parameters\n    connectiontimeout and ping in milliseconds. [Ruediger Pluem]\n\nEverything work fine on a newly patched server, my five cents says that this is related to library versions, i'll be happy to dig a bit deeper into this after the weekend.\n\nI'm a bit upset about this due to the fact that it causes undocumented problems with configuration when performing a minor upgrade, anyways keep up the good work :)\n\n/Petter", "id": 123893, "time": "2009-01-09T03:36:23Z", "creator": "Petter.Skott@ltu.se", "creation_time": "2009-01-09T03:36:23Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "rpluem@apache.org", "attachment_id": null, "text": "This is an issue with apr_strtoi64 which is already fixed in apr 1.3 branch but not part of a recent apr release (r727605).", "id": 123904, "time": "2009-01-09T07:36:47Z", "bug_id": 46500, "creation_time": "2009-01-09T07:36:47Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 46500, "is_private": false, "text": "You can either apply the cited apr patch to the bundled apr before building httpd, or in case you are not using a system apr you can apply the following workaround to httpd 2.2.11 directly:\n\n--- server/util.c.orig\n+++ server/util.c\n@@ -2174,6 +2174,7 @@\n     const char *time_str;\n     apr_int64_t tout;\n\n+    errno = 0;\n     tout = apr_strtoi64(timeout_parameter, &endp, 10);\n     if (errno) {\n         return errno;\n\n", "id": 123905, "time": "2009-01-09T08:05:54Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2009-01-09T08:05:54Z", "attachment_id": null}]