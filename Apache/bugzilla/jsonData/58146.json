[{"attachment_id": null, "tags": [], "bug_id": 58146, "text": "Is it is possible to create empty Theme if I create XSSFWorkbook by constructor XSSFWorkbook()?\nI tried to do this, but there is a lot of fields (like Relations) to fill when I create Theme - and finally I have to do something like reading inputStream. But I don\u2019t have IS, because I want create new workbook and fill everything using data from external JSON file.\nI checked that constructor XSSFWorkbook() creates objects like StylesSource and SharedStringsTable, but not ThemesTable. So maybe it\u2019 impossible to change Theme after constructor, because in fact it changes nothing?\nCreating Theme is so complicated (or maybe impossible now), so I tried to do this in some other ways too:\n1) I tried to: import empty XLSX file to ApachePOI, get Theme from it and set this Theme to my new XSSFWorkbook. But then my new XLSX file doesn\u2019t have file /xl/theme/theme1.xml and informations: <Override ContentType=\"application/vnd.openxmlformats-officedocument.theme+xml\" PartName=\"/xl/theme/theme1.xml\" /> in content_types.xml, <Override ContentType=\"application/vnd.openxmlformats-officedocument.theme+xml\" PartName=\"/xl/theme/theme1.xml\" /> in /xl/_rels/workbook.xml.rels.\n2) Then I tried to not create new XSSFWorkbook, but: import external XLSX file, change its Theme and save again as XLSX. Then file has informations about Theme, but about original - not changed.", "count": 0, "id": 184049, "time": "2015-07-16T14:18:11Z", "creator": "markiewicz.piotr@tlen.pl", "creation_time": "2015-07-16T14:18:11Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 58146, "attachment_id": null, "id": 184102, "time": "2015-07-21T12:58:19Z", "creator": "markiewicz.piotr@tlen.pl", "creation_time": "2015-07-21T12:58:19Z", "is_private": false, "text": "After some days I can create new Theme without reading anything from external file. I can create two entries in files content_types.xml and /xl/_rels/workbook.xml.rels:\n    XSSFWorkbook xssfWorkbook = new XSSFWorkbook();\n    POIXMLDocumentPart docThemePart = xssfWorkbook.createRelationship(XSSFRelation.THEME, XSSFFactory.getInstance(), 1);\nNormally it\u2019s not possible in ApachePOI, because it causes error. I had to MODIFY(!) ApachePOI ThemesTable class - I added constructor:\n    public ThemesTable() { super(); }\nThen function above creates file /xl/theme/theme1.xml too, but it\u2019s empty. How to fill this file? If I get Theme\n    ThemesTable theme = (ThemesTable) docThemePart;\nand change it, content is not wrote to theme.xml. How to fill this file?\nI checked Zip creating. Method marshall() in ZipPartMarshaller class gets input stream from some workbook parts. And for Theme input stream is empty. Maybe that\u2019s the problem? When I tried (for tests) to create other object:\n    xssfWorkbook.createRelationship(XSSFRelation.CHART, XSSFFactory.getInstance());\neverything was good."}, {"count": 2, "tags": [], "bug_id": 58146, "attachment_id": null, "id": 184282, "time": "2015-08-03T07:33:14Z", "creator": "markiewicz.piotr@tlen.pl", "creation_time": "2015-08-03T07:33:14Z", "is_private": false, "text": "Answer is here: http://stackoverflow.com/questions/31539873/unable-to-simply-create-theme-in-new-apachepoi-xssfworkbook/31551722#31551722"}]