[{"count": 0, "tags": [], "bug_id": 55966, "attachment_id": 31177, "text": "Created attachment 31177\nWord document with 3 content controls\n\nWhen calling getText() the contents of the content controls is not returned when the content control is within a paragraph with other text.\n\nWhen the content control is the only item then the text is there.\n\nThis appears to be the exact opposite of the behaviour in 3.9 where text in a content control where that is the only item in a paragraph doesn't appear though that in a paragraph with other text does. (That fix appears to have been in the onDocumentRead() method of org.apache.poi.xwpf.XWPFDocument).\n\nI've used the following test (and attached document to demonstrate the problem.\n\n\n\tpublic void test_manualDoc() throws FileNotFoundException, IOException  {\n\t\tString filepath = \"resources/contentcontrol.docx\";\n\t\tString expected = \"Content control within a paragraph is here text content from within a paragraph second control with a new\\nline\\n\\nContent control that is the entire paragraph\";\n\n\t\tXWPFDocument doc = new XWPFDocument(new FileInputStream(filepath));\n\t\tXWPFWordExtractor extractedDoc = new XWPFWordExtractor(doc);\n\n\t\tString actual = extractedDoc.getText();\n\t\t\n\t\textractedDoc.close();\n\t\tAssert.assertEquals(expected, actual);\n\n\t}", "id": 172145, "time": "2014-01-07T16:38:30Z", "creator": "ben+poi@benbat.com", "creation_time": "2014-01-07T16:38:30Z", "is_private": false}]