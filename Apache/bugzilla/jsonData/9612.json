[{"count": 0, "tags": [], "creator": "mohanind@wellsfargo.com", "attachment_id": null, "id": 17151, "time": "2002-06-05T00:34:05Z", "bug_id": 9612, "creation_time": "2002-06-05T00:34:05Z", "is_private": false, "text": "Hi,\n\nWhen I try to create excel file from template with filled values and try to \nopen this file from MS Excel, excel really crashes. I used following code:\n\nimport java.util.*;\nimport java.text.*;\nimport java.lang.Math.*;\nimport java.io.*;\nimport org.apache.poi.hssf.usermodel.*;\nimport org.apache.poi.poifs.filesystem.*;\n\npublic class inder7 {\n\tpublic static void main(String[] args) {\n\t\tfinal String TEMPLATE = \"ordertest2.xls\";\n\t\tfinal String WORKING_DIRECTORY = \"c:\\\\sample\\\\\";\n\t\tfinal String OUTFILE = WORKING_DIRECTORY + \"sampleout.xls\";\n\n\t\ttry {\n\t\t\tFileInputStream fis = new FileInputStream\n(WORKING_DIRECTORY + TEMPLATE);\n\n\t\t\tPOIFSFileSystem pfs = new POIFSFileSystem(fis);\n\n\t\t\tHSSFWorkbook book = new HSSFWorkbook(pfs);\n\t\t\tHSSFSheet sheet1 = book.getSheet(\"Sheet1\");\n\n\t\t\tHSSFRow row = sheet1.getRow(1);\n\t\t\tHSSFCell cell = row.getCell((short)1);\n\t\t\tcell.setCellValue(\"Inder\");\n\n\t\t\tbyte[] bbuf = book.getBytes();\n\n\t\t\tFile f = new File(OUTFILE);\n\t\t\tFileOutputStream fos = new FileOutputStream(f);\n\t\t\tfos.write(bbuf);\n\t\t\tfos.close();\n\t\t}\n\t\tcatch (java.io.IOException e) {\n\t\t\te.printStackTrace(System.out);\n\t\t}\n\t\tcatch (Exception e) {\n\t\t\te.printStackTrace(System.out);\n\t\t}\n\t}\n}\n\nHelp!!\nInder"}, {"count": 1, "tags": [], "bug_id": 9612, "attachment_id": 2004, "text": "Created attachment 2004\nTemplate excel file", "id": 17152, "time": "2002-06-05T00:40:57Z", "creator": "mohanind@wellsfargo.com", "creation_time": "2002-06-05T00:40:57Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 9612, "attachment_id": null, "text": "Works fine when I use this method to write the workbook:\n\n            File f = new File( OUTFILE );\n            FileOutputStream fos = new FileOutputStream( f );\n            book.write(fos);\n            fos.close();\n\nOne thing to note though.  The cell you're writting the text into is merged and\nso it will not display the text Inder.\n", "id": 17475, "time": "2002-06-10T02:54:18Z", "creator": "glens@apache.org", "creation_time": "2002-06-10T02:54:18Z", "is_private": false}]