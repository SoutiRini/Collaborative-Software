[{"count": 0, "tags": [], "text": "Requests timeout occasionally with the following error after calling AsyncContext.dispatch:\n\n10-Jul-2014 01:40:33.145 SEVERE [http-nio-8080-exec-2] org.apache.catalina.connector.CoyoteAdapter.asyncDispatch Exception while processing an asynchronous request\n java.lang.IllegalStateException: Calling [asyncTimeout()] is not valid for a request with Async state [DISPATCHING]\n    at org.apache.coyote.AsyncStateMachine.asyncTimeout(AsyncStateMachine.java:267)\n    ...\n\nHappens also with the Java Blocking Connector (Http11Protocol).\n\nCould not reproduce on Tomcat 7.0.54.\n\nCan be reproduced with the sample project with the following request:\nhttp://localhost:8080/servlet3-async/error2?fail=true\n\nSample code and more information about the test can be found here:\nhttps://github.com/marko-asplund/servlet3-async\n\nVerified on:\nUbuntu 14.04 / OpenJDK 1.7.0_55\nMac OS X 10.8.5 / Oracle Java 1.7.0_55", "attachment_id": null, "id": 176449, "creator": "marko.asplund@gmail.com", "time": "2014-07-17T08:15:47Z", "bug_id": 56736, "creation_time": "2014-07-17T08:15:47Z", "is_private": false}, {"count": 1, "tags": [], "text": "This has been fixed in 8.0.x for 8.0.11 onwards.\n\nThere were actually two problems here. The first was that calls to dispatch() from threads started with AsyncContext.start(Runnable) were not being processed until the AsyncContext timed out. The second was a rare timing issue made much more likely by the previous bug.\n\nThe timing issue has also been fixed in 7.0.x for 7.0.56 onwards.", "is_private": false, "bug_id": 56736, "id": 176970, "time": "2014-08-07T10:34:32Z", "creator": "markt@apache.org", "creation_time": "2014-08-07T10:34:32Z", "attachment_id": null}]