[{"count": 0, "tags": [], "bug_id": 24620, "attachment_id": null, "text": "I have been tring to get the latest Apache to pass all requests to the latest\nTomcat via mod_Jk. I RTFM. I folllowed the instructions to the best of my\nunderstanding. Once I get everything set up and start the servers and go to\nhttp://localhost:8080/index.jsp and it shows the Tomcat main page. When I go to\nhttp://localhost/index.jsp I get a 500 Internal Server Error.\n\nIs there any way you could look at the rest of my post and suggest what I might\nhave done wrong???\nThanks,\nRick\nHere is the what I get in /home/rick/DEVELOPMENT/TOOLS/SERVERS/CORP/logs/mod_jk.log\n[Tue Nov 11 10:01:19 2003] [jk_uri_worker_map.c (486)]: Into\njk_uri_worker_map_t::map_uri_to_worker\n[Tue Nov 11 10:01:19 2003] [jk_uri_worker_map.c (500)]: Attempting to map URI\n'/index.jsp'\n[Tue Nov 11 10:01:19 2003] [jk_uri_worker_map.c (524)]:\njk_uri_worker_map_t::map_uri_to_worker, Found a context match ajp13 -> /\n[Tue Nov 11 10:01:19 2003] [mod_jk.c (1709)]: Into handler r->proxyreq=0\nr->handler=jakarta-servlet r->notes=135942192 worker=ajp13\n[Tue Nov 11 10:01:19 2003] [jk_worker.c (132)]: Into wc_get_worker_for_name ajp13\n[Tue Nov 11 10:01:19 2003] [jk_worker.c (136)]: wc_get_worker_for_name, done\nfound a worker\n[Tue Nov 11 10:01:19 2003] [mod_jk.c (497)]: agsp=80 agsn=localhost\nhostn=localhost shostn=localhost cbsport=0 sport=0\n[Tue Nov 11 10:01:19 2003] [jk_ajp_common.c (1546)]: Into jk_worker_t::get_endpoint\n[Tue Nov 11 10:01:19 2003] [jk_ajp_common.c (1208)]: Into jk_endpoint_t::service\n[Tue Nov 11 10:01:19 2003] [jk_ajp_common.c (295)]: Into ajp_marshal_into_msgb\n[Tue Nov 11 10:01:19 2003] [jk_ajp_common.c (463)]: ajp_marshal_into_msgb - Done\n[Tue Nov 11 10:01:19 2003] [jk_connect.c (188)]: Into jk_open_socket\n[Tue Nov 11 10:01:19 2003] [jk_connect.c (195)]: jk_open_socket, try to connect\nsocket = 10\n[Tue Nov 11 10:01:19 2003] [jk_connect.c (204)]: jk_open_socket, after connect\nret = -1\n[Tue Nov 11 10:01:19 2003] [jk_connect.c (233)]: jk_open_socket, connect()\nfailed errno = 101\n[Tue Nov 11 10:01:19 2003] [jk_ajp_common.c (676)]: Error connecting to tomcat.\nTomcat is probably not started or is listenning on the wrong port. Failed errno\n= 101\n[Tue Nov 11 10:01:19 2003] [jk_ajp_common.c (955)]: Error connecting to the\nTomcat process.\n[Tue Nov 11 10:01:19 2003] [jk_ajp_common.c (1309)]: sending request to tomcat\nfailed in send loop. err=0\n[Tue Nov 11 10:01:19 2003] [jk_connect.c (188)]: Into jk_open_socket\n[Tue Nov 11 10:01:19 2003] [jk_connect.c (195)]: jk_open_socket, try to connect\nsocket = 10\n[Tue Nov 11 10:01:19 2003] [jk_connect.c (204)]: jk_open_socket, after connect\nret = -1\n[Tue Nov 11 10:01:19 2003] [jk_connect.c (233)]: jk_open_socket, connect()\nfailed errno = 101\n[Tue Nov 11 10:01:19 2003] [jk_ajp_common.c (676)]: Error connecting to tomcat.\nTomcat is probably not started or is listenning on the wrong port. Failed errno\n= 101\n[Tue Nov 11 10:01:19 2003] [jk_ajp_common.c (955)]: Error connecting to the\nTomcat process.\n[Tue Nov 11 10:01:19 2003] [jk_ajp_common.c (1309)]: sending request to tomcat\nfailed in send loop. err=1\n[Tue Nov 11 10:01:19 2003] [jk_connect.c (188)]: Into jk_open_socket\n[Tue Nov 11 10:01:19 2003] [jk_connect.c (195)]: jk_open_socket, try to connect\nsocket = 10\n[Tue Nov 11 10:01:19 2003] [jk_connect.c (204)]: jk_open_socket, after connect\nret = -1\n[Tue Nov 11 10:01:19 2003] [jk_connect.c (233)]: jk_open_socket, connect()\nfailed errno = 101\n[Tue Nov 11 10:01:19 2003] [jk_ajp_common.c (676)]: Error connecting to tomcat.\nTomcat is probably not started or is listenning on the wrong port. Failed errno\n= 101\n[Tue Nov 11 10:01:19 2003] [jk_ajp_common.c (955)]: Error connecting to the\nTomcat process.\n[Tue Nov 11 10:01:19 2003] [jk_ajp_common.c (1309)]: sending request to tomcat\nfailed in send loop. err=2\n[Tue Nov 11 10:01:19 2003] [jk_ajp_common.c (1318)]: Error connecting to tomcat.\nTomcat is probably not started or is listening on the wrong port. worker=ajp13\nfailed errno = 101\n[Tue Nov 11 10:01:19 2003] [jk_ajp_common.c (1529)]: Into jk_endpoint_t::done,\nclosing connection 0\n[Tue Nov 11 10:01:19 2003] [jk_ajp_common.c (605)]: In\njk_endpoint_t::ajp_close_endpoint\n\nHere is what I did to install Apache, Tomcat, and mod_Jk\n1. Installed Tomcat 4.1.29\n2. Renamed folder from jakarta-tomcat-4.1.29 to CORP\n3. Tested Tomcat on port 8080 (sucess)\n\n4. Compiled/Installed Apache 2.0.48 with options (--prefix\n/home/rick/DEVELOPMENT/TOOLS/SERVERS/apache --enable-so --enable-rewrite\n--enable-ssl --enable-proxy)\n5. Tested Apache on port 80 (sucsess)\n\n6. Compiled/Installed Mod_Jk1.2 with options\n(--with-apxs=/home/rick/DEVELOPMENT/TOOLS/SERVERS/apache/bin/apxs)\n\n7. Checked to make sure\n/home/rick/DEVELOPMENT/TOOLS/SERVERS/apache/modules/mod_jk.so was created\n8. Make changes to the\n/home/rick/DEVELOPMENT/TOOLS/SERVERS/apache/conf/httpd.conf file:\n    Change 'DocumentRoot' to point to\n'/home/rick/DEVELOPMENT/TOOLS/SERVERS/CORP/webapps/ROOT'\n    Add Index.jsp to 'DirectoryIndex'\n    Add 'Include\n/home/rick/DEVELOPMENT/TOOLS/SERVERS/CORP/conf/auto/mod_jk.conf' to the bottom\nof the file.\n9. Make changes to the /home/rick/DEVELOPMENT/TOOLS/SERVERS/CORP/conf/server.xml\n    Add the following line below the line that says server and lists the port 8005\n        <Listener className=\"org.apache.ajp.tomcat4.config.ApacheConfig\"\njkDebug=\"debug\"\nmodJk=\"/home/rick/DEVELOPMENT/TOOLS/SERVERS/apache/modules/mod_jk.so\" />\n    Inside the <HOST> tags add the following line\n        <Listener className=\"org.apache.ajp.tomcat4.config.ApacheConfig\"\nappend=\"true\" noRoot=\"false\" forwardAll=\"true\"\nmodJk=\"/home/rick/DEVELOPMENT/TOOLS/SERVERS/apache/modules/mod_jk.so\" />\n10. Create a new folder called 'jk' in\n/home/rick/DEVELOPMENT/TOOLS/SERVERS/CORP/conf/\n11. Create a new file called 'workers.properties' in folder\n/home/rick/DEVELOPMENT/TOOLS/SERVERS/CORP/conf/jk/\n12. Add the following lines to\n/home/rick/DEVELOPMENT/TOOLS/SERVERS/CORP/conf/jk/workers.properties\n    worker.list=ajp13\n    worker.ajp13.port=8009\n    worker.ajp13.host=localhost\n    worker.ajp13.type=ajp13\n\n13. Start Tomcat and wait 60 seconds\n14. Start Apache\n15. Go to http://localhost", "id": 47208, "time": "2003-11-11T20:16:27Z", "creator": "rick@incorppro.com", "creation_time": "2003-11-11T20:16:27Z", "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 24620, "text": "Please use the tomcat user list to debug this config error.\n\nFrom the logs there is this: \n[Tue Nov 11 10:01:19 2003] [jk_ajp_common.c (676)]: Error connecting to tomcat.\nTomcat is probably not started or is listenning on the wrong port. Failed errno\n= 101\n\nHint: see if tomcat has a connector listening for 8009, similar to this:\n<Connector className=\"org.apache.coyote.tomcat4.CoyoteConnector\"\n           port=\"8009\" minProcessors=\"5\" maxProcessors=\"75\"\n           enableLookups=\"true\" redirectPort=\"8443\"\n           acceptCount=\"10\" debug=\"0\" connectionTimeout=\"0\"\n           useURIValidationHack=\"false\"\n           protocolHandlerClassName=\"org.apache.jk.server.JkCoyoteHandler\"/>\n\n\nPlease followup to tomcat-user list. Any future re-opens might be (rudely) closed.\n", "id": 47212, "time": "2003-11-11T20:39:58Z", "creator": "funkman@joedog.org", "creation_time": "2003-11-11T20:39:58Z", "tags": [], "is_private": false}]