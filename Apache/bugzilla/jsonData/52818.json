[{"count": 0, "tags": [], "bug_id": 52818, "attachment_id": 28414, "id": 154483, "time": "2012-03-04T09:41:36Z", "creator": "roadlit@gmail.com", "creation_time": "2012-03-04T09:41:36Z", "is_private": false, "text": "Created attachment 28414\nimplemenation of RANK\n\nI could not find the implementation of RANK in POI3.8, so I proceed to create one. See attachment. \n\nI also \"add retval[216] = new Rank();\" to private static Function[] produceFunctions().\n\n\nThanks"}, {"count": 1, "tags": [], "bug_id": 52818, "attachment_id": null, "text": "Any chance you could upload a unit test for your implementation?\n\nHow to test:\n\n - open ./test-data/spreadsheet/FormulaEvalTestData.xls and fill the placeholder for RANK. Just follow the pattern that other functions use. The formula testing framework will find and run this test automatically.\n- It is a good idea to test against the example from MS Office online help: http://office.microsoft.com/en-us/excel-help/rank-function-HP010062535.aspx?CTT=5&origin=HA010277524.\nAlso check that your implementation follows the spec and correctly handles ordered/unordered lists, duplicates, not numbers, etc.\n\n \nYegor", "id": 154528, "time": "2012-03-05T07:14:17Z", "creator": "yegor@dinom.ru", "creation_time": "2012-03-05T07:14:17Z", "is_private": false}, {"count": 2, "tags": [], "creator": "roadlit@gmail.com", "attachment_id": 28417, "id": 154533, "time": "2012-03-05T08:26:59Z", "bug_id": 52818, "creation_time": "2012-03-05T08:26:59Z", "is_private": false, "text": "Created attachment 28417\nFormulaEvalTestData.xls (tests for RANK added)\n\nTest case"}, {"count": 3, "tags": [], "bug_id": 52818, "attachment_id": 28418, "is_private": false, "id": 154534, "time": "2012-03-05T08:37:34Z", "creator": "roadlit@gmail.com", "creation_time": "2012-03-05T08:37:34Z", "text": "Created attachment 28418\nRank.java\n\nImplementation of RANK(ARG1, ARG2, ARG3). Based on the description in http://office.microsoft.com/en-us/excel-help/rank-function-HP010062535.aspx?CTT=5&origin=HA010277524.\n\nThe algorithm is as follows:\n\n1) throw EvaluationException(ErrorEval.NUM_ERROR) if either ARG0 does not contain a number or ARG3 does not contain 0 or 1.\n\n2) set rank=0, search each cell in the range specified by ARG2, if the cell contains a number greater than ARG0 and ARG3 is 0, or lower than ARG0 and ARG3 is 1, then rank++;  If the cell does not contain a number, then ignore this cell.\n\n3) return the value of rank"}, {"count": 4, "tags": [], "bug_id": 52818, "attachment_id": 28419, "text": "Created attachment 28419\nFunctionEval.java\n\nAdd one line \"retval[216] = new Rank();\" to the function \"private static Function[] produceFunctions()\" This is the only change.", "id": 154535, "time": "2012-03-05T08:45:08Z", "creator": "roadlit@gmail.com", "creation_time": "2012-03-05T08:45:08Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 52818, "is_private": false, "text": "Patch applied in r1297021\n\nThanks,\nYegor", "id": 154538, "time": "2012-03-05T12:14:05Z", "creator": "yegor@dinom.ru", "creation_time": "2012-03-05T12:14:05Z", "attachment_id": null}]