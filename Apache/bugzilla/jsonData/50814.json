[{"count": 0, "attachment_id": null, "creator": "kilroy155@gmail.com", "is_private": false, "id": 144459, "time": "2011-02-21T15:35:33Z", "bug_id": 50814, "creation_time": "2011-02-21T15:35:33Z", "tags": [], "text": "We are unable to use 'exec' with Server Side Includes to execute commands and \nget the output on a Windows system using either 2.2.17 or 2.0.64.  It does \nappear to work on 1.3.28.1.  We have tried Windows 2003 SP2, Windows XP SP3, \nand an older Windows 2000 system.\nWe used the documentation at: http://httpd.apache.org/docs/2.2/howto/ssi.html\n\nTo reproduce:\n\n- Configure SSI.  In the .conf:\n   a) In the <Directory> section of the DocumentRoot, change the Options value \n      so it has 'Includes'.  We used:\n        Options All\n\n   b) Uncomment these lines:\n        AddType text/html .shtml\n        AddOutputFilter INCLUDES .shtml\n\n- Place an 'index.shtml' file in the DocumentRoot dir root.  We used a simple \n  one with the following contents:\n \n   <br/>\n   <!--#set var=\"FOOBAR\" value=\"SSI is working\" -->\n   <!--#echo var=\"FOOBAR\" -->\n   <br/>\n   <pre>\n   Here is output of the internal 'dir' command: <!--#exec cmd=\"dir\" -->\n   </pre>\n   <br/>\n   Here is output from exec of 'c:/windows/system32/hostname.exe': &gt;&gt;<!--#exec cmd=\"c:/windows/system32/hostname.exe\" -->&lt;&lt;\n\n\n- Start the server and access the 'index.shtml' document in your browser.\n   The output shows the 'SSI is working' string, but there is no output from \n   the 'dir' and 'hostname.exe' execs for 2.x, but there is for 1.3.28.1\n   \n  It doesn't seem to matter whether the server is started as a service or from \n  the command-line, but when started from the command-line we have noticed \n  cmd-prompt windows popping up very briefly and then disappearng, as if the\n  exec'ed commands may be running within them.\n\n   \nNote: The config for 1.3.28.1 is slightly different per the 1.3 documentation: \n http://httpd.apache.org/docs/1.3/howto/ssi.html\n It uses: \n   AddHandler server-parsed .shtml\n whereas 2.x uses:  \n   AddOutputFilter INCLUDES .shtml"}, {"count": 1, "tags": [], "creator": "wrowe@apache.org", "attachment_id": null, "is_private": false, "id": 144460, "time": "2011-02-21T16:12:58Z", "bug_id": 50814, "creation_time": "2011-02-21T16:12:58Z", "text": "The exec construct doesn't correspond to a \"command line\" per say.\n\ndir in your example is not expected to work.  You didn't invoke cmd.exe.\n\nThat hostname.exe fails is interesting.  What about backslashes?\n\nIn any case exec is not recommended, include virtual is."}, {"count": 2, "tags": [], "bug_id": 50814, "is_private": false, "text": "I included the 'dir' because it was the provided example for Windows from the\n'Executing commands' section of the \n'Apache Tutorial: Introduction to Server Side Includes' doc:\n http://httpd.apache.org/docs/2.2/howto/ssi.html\n \nI agree that the invocation of an actual .exe file is of more interest however.\n\nI have tried a variety of variations on the slashes (backslashes, double \nbackslashes, escaped backslashes) and have so far still been unable to get it \nto work.", "id": 144526, "time": "2011-02-24T12:07:11Z", "creator": "kilroy155@gmail.com", "creation_time": "2011-02-24T12:07:11Z", "attachment_id": null}, {"count": 3, "attachment_id": null, "creator": "gls@gknw.net", "text": "I'm having no problem invoking a exe in the docroot/scriptalias, as stated, the include virtual= and file system doesn't map 1 to 1. I don't think even if it did hostname.exe would work cause it doesn't print out the content type. Moving a copy into the docroot I get.\n\n[Thu Feb 24 22:51:48 2011] [error] [client ::1] malformed header from script. Bad header=MYPUTER3: HOSTNAME.EXE\nMYPUTER3 is correct.\n\nA compiled perl script helloworld.exe works without problem since it prints out the content-type.\n\nI was using:\nServer version: Apache/2.2.18-dev (Win32)\nServer built:   Jan 26 2011 11:51:40\n\nI'd call this Invalid in the case of 2.2.x as it's a user produced error looking at the examples given.\n\n2.3.11-dev is another story it seems but I need to test further on it.", "id": 144533, "time": "2011-02-25T02:07:43Z", "bug_id": 50814, "creation_time": "2011-02-25T02:07:43Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "creator": "covener@gmail.com", "attachment_id": null, "text": "(In reply to comment #3)\n> I'm having no problem invoking a exe in the docroot/scriptalias, as stated, the\n> include virtual= and file system doesn't map 1 to 1. I don't think even if it\n> did hostname.exe would work cause it doesn't print out the content type. Moving\n> a copy into the docroot I get.\n> \n> [Thu Feb 24 22:51:48 2011] [error] [client ::1] malformed header from script.\n> Bad header=MYPUTER3: HOSTNAME.EXE\n> MYPUTER3 is correct.\n\nThis PR is about #exec cmd=foo which is supposed to substitute the output of a (non-CGI) regular executable.", "id": 144534, "time": "2011-02-25T07:22:50Z", "bug_id": 50814, "creation_time": "2011-02-25T07:22:50Z", "is_private": false}, {"count": 5, "tags": [], "creator": "kilroy155@gmail.com", "attachment_id": null, "is_private": false, "id": 144683, "time": "2011-03-02T14:29:23Z", "bug_id": 50814, "creation_time": "2011-03-02T14:29:23Z", "text": "Some updates about trying to use ssi exec after doing some more \nexperimentation with this:\n\nI still have not been able to use exec to invoke an .exe and see its output \nbut have been able to use it to show some output from an invoked Windows batch \nfile.  If Windows internal commands (ex: dir, ver, vol, date /t, time /t) are \ninvoked within the batch file then their output will appear in the .shtml page.  \nHowever, I have not been able to get the output of external commands\n(ex: hostname.exe, netstat.exe, ipconfig.exe, etc.) that are invoked from the \nbatch file to appear.  I have tried various .exe invocations from within the \nbatch file to no avail (ex: 'hostname.exe', 'cmd /c hostname.exe', etc.).\n\nAny thoughts on how to get the output of a .exe using the ssi exec?\n\nBelow is an example of the latest test files and output.  You can see that\nhostname.exe produced no output either when invoked directly by exec or\nwhen used within the batch file.  However, hostname.exe does produce output to\nthe console when the ssitest.cmd is invoked directly on the command-line.\n\n\nindex.shtml\n---------------------------------------------------------\n<br/>\n<!--#set var=\"FOOBAR\" value=\"SSI is working\" -->\n<!--#echo var=\"FOOBAR\" -->\n<br/>\n<pre>\nHere is output from exec of 'd:\\temp\\ssitest.cmd': &gt;&gt;<!--#exec cmd=\"d:\\temp\\ssitest.cmd\" -->&lt;&lt;\n</pre>\n<br/>\nHere is output from exec of 'c:\\windows\\system32\\hostname.exe': &gt;&gt;<!--#exec cmd=\"c:\\windows\\system32\\hostname.exe\" -->&lt;&lt;\n<br/>\n\n\n\nssitest.cmd batch file (invoked by within index.shtml by exec):\n---------------------------------------------------------------\n@echo off\n@echo \"ssitest.cmd ran\"\ndir\nhostname.exe\n@echo on\n\n\n\nOutput seen in my browser (for http://localhost/index.shtml):\n------------------------------------------------------------\nSSI is working \n\nHere is output from exec of 'd:/temp/ssitest.cmd': >>\"ssitest.cmd ran\"\n Volume in drive D is D_DRIVE\n Volume Serial Number is 14E9-D859\n\n Directory of D:\\Apache_2217\\htdocs\n\n03/02/2011  01:50 PM              .\n03/02/2011  01:50 PM              ..\n06/22/2010  04:46 PM                20 cache2.html\n11/20/2004  03:16 PM                44 index.html\n03/02/2011  01:53 PM               363 index.shtml\n03/02/2011  01:24 PM               575 index.shtml_sav\n02/17/2011  10:49 AM               614 index.shtml_test1\n02/21/2011  11:25 AM               323 index.shtml_use\n               6 File(s)          1,939 bytes\n               2 Dir(s)  420,219,654,144 bytes free\n<<\n\n\nHere is output from exec of 'c:\\windows\\system32\\hostname.exe': >><<"}, {"count": 6, "attachment_id": null, "creator": "wrowe@apache.org", "is_private": false, "id": 144686, "time": "2011-03-02T16:56:18Z", "bug_id": 50814, "creation_time": "2011-03-02T16:56:18Z", "tags": [], "text": "Note that httpd runs as a service as the designated user (usually LocalSystem).\nThat means several environmental factors are going to potentially interfere in\nvarious ways with operation.\n\nRunning httpd in a console is one way to differentiate service-oriented flukes\nfrom the possible user/desktop/shell expectations."}, {"count": 7, "tags": [], "bug_id": 50814, "text": "Good thought, but it doesn't seem to have made any difference.  \n\nI had been running it as a service under the LocalSystem account, so tried \nboth running the service under a different account and starting the server\nfrom the command-line.\n\nFor both cases, the output was still exactly as shown in my last update with\nno output from hostname.exe appearing.", "id": 144707, "time": "2011-03-03T12:16:43Z", "creator": "kilroy155@gmail.com", "creation_time": "2011-03-03T12:16:43Z", "is_private": false, "attachment_id": null}]