[{"attachment_id": null, "tags": [], "bug_id": 44664, "is_private": false, "count": 0, "id": 114907, "time": "2008-03-23T19:07:36Z", "creator": "ta-seok@brainsellers.com", "creation_time": "2008-03-23T19:07:36Z", "text": "Hi\n\nI found some problem at the method \nHSSFPalette.findSimilarColor(byte red, byte green, byte blue)\n\nThis does not return similar color.\n\nWhen I input Color A I get the Color B from this method.\nColor A -> red:120 green:114 blue:4\nColor B -> red:51 green:51 blue:51 ColorIndex:63\n\nBut this is not proper color value.\n\nWhen I use this edited method I can get the proper color value.\n\n    public HSSFColor findSimilarColor(byte red, byte green, byte blue)\n    {\n     .\n     .\n     .\n\n      //int colorDistance = red - b[0] + green - b[1] + blue - b[2];\n      int colorDistance = Math.abs(((int) red & 0xff) - ((int) b[0] & 0xff))\n      + Math.abs(((int) green & 0xff) - ((int) b[1] & 0xff))\n      + Math.abs(((int) blue & 0xff) - ((int) b[2] & 0xff));\n     .\n     .\n     .\n\n    }\n\nColor A -> red:120 green:114 blue:4\nColor B -> red:-128 green:-128 blue:0 ColorIndex:19"}, {"count": 1, "tags": [], "bug_id": 44664, "attachment_id": null, "id": 114920, "time": "2008-03-24T10:14:22Z", "creator": "apache@gagravarr.org", "creation_time": "2008-03-24T10:14:22Z", "is_private": false, "text": "I believe this was fixed after bug #38921\n\nHave you tried with svn trunk\n\n*** This bug has been marked as a duplicate of bug 38921 ***"}]