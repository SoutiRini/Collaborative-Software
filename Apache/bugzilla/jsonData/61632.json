[{"count": 0, "tags": [], "creator": "knst.kolinko@gmail.com", "attachment_id": null, "text": "In short:\n\n- When running Tomcat on Windows, if current directory (when starting Tomcat) is not $CATALINA_HOME\\bin then the tcnative-1.dll is not found.\n\nThe default \"java.library.path\" on Windows includes \".\" current directory, but does not include \"$CATALINA_HOME\\bin\".\n\n\nMy main concern is running Tomcat as a Server in Eclipse IDE.\n\nSteps to reproduce:\n1. Download and unzip apache-tomcat-8.5.23-windows-<arch>.zip\n\n2. Download, install and run Eclipse IDE for Java EE developers (I am using Neon.3 aka 4.6.3)\n\n3. Create a Tomcat 8.5 server in the IDE\n\nhttps://wiki.apache.org/tomcat/FAQ/Developing#Q6\n\n(Window > Show view > Other... > Server/Servers, add a new server)\n\n4. Start it\n\nResult:\n[[[\nOct 18, 2017 4:17:59 PM org.apache.catalina.core.AprLifecycleListener lifecycleEvent\nINFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: [...;;D:\\eclipse_4_6;;.]\n]]]\n\nIn Eclipse the default working directory when running a new server is the same as default working directory of Eclipse IDE. In my case: \"D:\\eclipse_4_6\"\n\n\nPossible ways to resolve this:\na. Improve documentation. Add a note and a recipe to\n\nhttps://tomcat.apache.org/tomcat-8.5-doc/apr.html#Windows\n\nand\n\nhttps://wiki.apache.org/tomcat/FAQ/Developing#Q6\n\nb. Implement some way to search for tcnative-1.dll in ${catalina.home}/bin ?", "id": 201513, "time": "2017-10-18T14:43:25Z", "bug_id": 61632, "creation_time": "2017-10-18T14:43:25Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 61632, "is_private": false, "text": "> b. Implement some way to search for tcnative-1.dll in ${catalina.home}/bin ?\n\nFor this solution I thought that maybe\n\n1. Allow to configure an explicit path to the dll in AprLifecycleListener\n\n2. Use System.load(filename) call to load the library from an explicitly specified filename.\n\nThe current code (in org.apache.tomcat.jni.Library) calls a different method - System.loadLibrary(name).\n\nGenerally, loading a DDL from an explicit path is better than performing a search.\n\n\nA deficiency in this solution is that such configuration is specific to Microsoft Windows. It cannot be included in the default *.zip download of Apache Tomcat,\nbut it can be included \"Windows\" flavors of zip downloads.", "id": 201515, "time": "2017-10-18T15:04:58Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2017-10-18T15:04:58Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 61632, "attachment_id": null, "id": 201516, "time": "2017-10-18T15:14:49Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2017-10-18T15:14:49Z", "is_private": false, "text": "> a. Improve documentation. Add a note and a recipe to\n\nMy recipe is to configure \"java.library.path\" explicitly.\n\n\nFor running Tomcat in Eclipse IDE the steps are the following:\n\n1. Open edit dialog for the Server\n\n(In \"Servers\" view select the server and double-click it or press \"F3\" (Open))\n\nSee http://markmail.org/message/7zkyocvph56b6t6q\n\n2. Click \"Open launch configuration\" link\n\nAn \"Edit launch configuration properties\" dialog opens.\n\n3. Switch to \"Arguments\" tab and edit \"VM arguments\".\n\nAdd\n-Djava.library.path=\"<your path of catalina.home>\\bin\""}]