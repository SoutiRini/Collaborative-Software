[{"count": 0, "tags": [], "text": "When I invoke cgi, CGiServlet refuses to run it and throws IOException :\n\nCharacter in CGI command path ('.' or '..') detected.  Not running\n CGI [/opt/catalina/bin/../ilab/Excendia/WEB-INF/cgi/printenv].", "attachment_id": null, "id": 6787, "creator": "maint@intercollab.kiev.ua", "time": "2001-10-17T04:40:40Z", "bug_id": 4227, "creation_time": "2001-10-17T04:40:40Z", "is_private": false}, {"count": 1, "tags": [], "text": "Currently, the CGI servlet refuses to run a request that has \"/./\" or \"/../\" in\nthe CGI command path (as yours does), in order to avoid spoofing attacks that\ntry to access binaries outside of the appropriate webapp directory.  In this\ncase, it appears that the \"/../\" is occurring because you are letting the\nstandard startup script figure out what CATALINA_HOME is.\n\nCould you try explicitly setting the CATALINA_HOME environment variable (to\n\"/opt/catalina\") and see if that solves the problem for you?\n", "attachment_id": null, "bug_id": 4227, "id": 6989, "time": "2001-10-22T09:19:11Z", "creator": "craig.mcclanahan@sun.com", "creation_time": "2001-10-22T09:19:11Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 4227, "attachment_id": null, "id": 7230, "time": "2001-10-28T06:38:36Z", "creator": "root@martindengler.com", "creation_time": "2001-10-28T06:38:36Z", "is_private": false, "text": "It makes sense for the CGIServlet behavior to be very conservative in this\nrespect (and, indeed, the specs specifically allow CGI implementations to take\ntheir own personal view on this).\n\nHowever, it IS on the CGIServlet TODO list to \"Make checking for \".\" and \"..\" in\nservlet & cgi PATH_INFO less draconian\".\n\nHow big a problem is this?"}, {"count": 3, "tags": [], "text": "Will not fix '.' or '..' for now for security reasons.  ", "attachment_id": null, "bug_id": 4227, "id": 7804, "time": "2001-11-12T16:48:29Z", "creator": "amyroh@apache.org", "creation_time": "2001-11-12T16:48:29Z", "is_private": false}, {"count": 4, "tags": [], "text": "To modify status.", "is_private": false, "bug_id": 4227, "id": 69993, "time": "2005-01-23T17:11:01Z", "creator": "markt@apache.org", "creation_time": "2005-01-23T17:11:01Z", "attachment_id": null}, {"count": 5, "tags": [], "text": "This is really an enhancement request.", "attachment_id": null, "bug_id": 4227, "id": 69994, "time": "2005-01-23T17:11:52Z", "creator": "markt@apache.org", "creation_time": "2005-01-23T17:11:52Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 4227, "attachment_id": null, "is_private": false, "id": 140869, "time": "2010-10-20T18:33:00Z", "creator": "markt@apache.org", "creation_time": "2010-10-20T18:33:00Z", "text": "This is fixed in 7.0.x, 6.0.x (and I think 5.5.x) since Tomcat normalises the request URI before calculating the contextPath, servletPath and pathInfo. I have therefore removed the todo (in 7.0.x) re making the checks less draconian.\n\nI have left the checks for \".\" and \"..\" in place just to be on the safe side but they should never be triggered."}]