[{"count": 0, "tags": [], "bug_id": 58973, "attachment_id": null, "is_private": false, "id": 188238, "time": "2016-02-05T10:11:23Z", "creator": "rahul.kr.sharma29@gmail.com", "creation_time": "2016-02-05T10:11:23Z", "text": "I trying to implement the bellow code to embed video file in pptx file\n\nhttp://stackoverflow.com/questions/15197300/apache-poi-xslf-adding-movie-to-the-slide.\n\nFor doing this I am using following jar to the projects LIB.\n\ncommons-logging-1.1.3.jar\ndom4j-1.5.jar\nooxml-schemas-1.1.jar\npoi-3.9.jar\npoi-excelant-3.13-20150929.jar\npoi-ooxml-3.9.jar\npoi-scratchpad-3.13-20150929.jar\nslf4j-api-1.7.5.jar\nxmlbeans-2.6.0.jar\nxuggle-xuggler-5.4.jar\n\nand I am attaching the source code as well in which PPTXUsingPOI.java has the source code.\nThe PPTX file successfullt generated but when I open the pptx It always gives error message \"PowerPoint found a problem with content in pptx-with-video.pptx. PowerPoint can attempt to repair the presentation. If you trust the source of the presentation click Repair\". And when I click on the Repair button it Repairs the PPTX file and play the video. The video not plays very smoothly.\n\n\nPlease help what I have done wrong? why this alert message is coming.\n\nAttachment: source code of test project."}, {"count": 1, "tags": [], "bug_id": 58973, "attachment_id": 33532, "text": "Created attachment 33532\nPPTXUsingPOI Having source code\n\nAttachment is the source code. Please Put mp4 file in the folder \\src\\resources\\movie\\ folder as Due to upload limit I am not able to upload the video", "id": 188240, "time": "2016-02-05T10:31:07Z", "creator": "rahul.kr.sharma29@gmail.com", "creation_time": "2016-02-05T10:31:07Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 58973, "attachment_id": null, "id": 188243, "time": "2016-02-05T12:19:16Z", "creator": "kiwiwings@apache.org", "creation_time": "2016-02-05T12:19:16Z", "is_private": false, "text": "Why do you mix POI 3.9 and 3.13?\n\nNot sure if this makes any difference regarding the Powerpoint error message, but I'll use the current trunk for the test.\nAs you haven't provided a movie file, I'll use a random one and this can have an influence on how smoothly it is played.\n\nI'll test it under PowerPoint Viewer, PowerPoint 2016 and Libre Office."}, {"count": 3, "tags": [], "bug_id": 58973, "text": "As per http://poi.apache.org/faq.html#faq-N1019C mixing jars from different versions is not supported, you need to fix that first (it may well solve your issue!)", "id": 188245, "time": "2016-02-05T14:09:33Z", "creator": "apache@gagravarr.org", "creation_time": "2016-02-05T14:09:33Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 58973, "text": "Hi Andreas,\n\nThanks for your quick reply.\n \nActually the code which I find from http://stackoverflow.com/questions/15197300/apache-poi-xslf-adding-movie-to-the-slide giving compile time and run time error related to the library version, some of class not found some of method not found, I find the combination of those jar files on which it runs. I used the latest jar files for which one the sample code accepts. If you have any sample/Junit Test case with latest POI for embedding mp4 video in power-point-presentation please share it with me.\nAnd for video I uploaded a sample video on google drive plese find the file from bellow link.\nhttps://drive.google.com/open?id=0B28rXyRBKGbJdXhzbGw0Nkh2eTA\n\nThanks", "id": 188247, "time": "2016-02-05T14:25:34Z", "creator": "rahul.kr.sharma29@gmail.com", "creation_time": "2016-02-05T14:25:34Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 58973, "text": "Having seen who wrote the code you're referring to... I think we need Andreas to turn his SO answer into something in the POI examples package :)", "id": 188248, "time": "2016-02-05T14:29:18Z", "creator": "apache@gagravarr.org", "creation_time": "2016-02-05T14:29:18Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 58973, "attachment_id": null, "is_private": false, "id": 188260, "time": "2016-02-06T22:27:30Z", "creator": "kiwiwings@apache.org", "creation_time": "2016-02-06T22:27:30Z", "text": "Added an example via r1728888\nthere was also a regression fixed via r1728737"}, {"count": 7, "tags": [], "bug_id": 58973, "text": "I tried to run the Example Which you given by r1728888 with latest POI poi-3.13 jars but it is giving compile time error for class not found for the following classes.\n\nimport org.openxmlformats.schemas.presentationml.x2006.main.CTExtension;\nimport org.openxmlformats.schemas.presentationml.x2006.main.CTTLCommonMediaNodeData;\nimport org.openxmlformats.schemas.presentationml.x2006.main.CTTLCommonTimeNodeData;\nimport org.openxmlformats.schemas.presentationml.x2006.main.CTTimeNodeList;\nimport org.openxmlformats.schemas.presentationml.x2006.main.STTLTimeIndefinite;\nimport org.openxmlformats.schemas.presentationml.x2006.main.STTLTimeNodeFillType;\nimport org.openxmlformats.schemas.presentationml.x2006.main.STTLTimeNodeRestartType;\nimport org.openxmlformats.schemas.presentationml.x2006.main.STTLTimeNodeType;", "id": 188284, "time": "2016-02-08T10:40:29Z", "creator": "rahul.kr.sharma29@gmail.com", "creation_time": "2016-02-08T10:40:29Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 58973, "text": "The regression was in the trunk, so you either use a nightly build or wait for 3.14-final to be released.\n\nRegarding the class not found exception, have a look at\nhttp://poi.apache.org/faq.html#faq-N10025\n\nAs the example uses xuggle and I didn't want to add another jar dependency, which is furthermore from an unofficial repository, I have saved the example as \"*.txt\".\nThis means that it's ignored by the build and the corresponding classes (mentioned in your last message) won't get pulled into the poi-ooxml-schemas, i.e. the lite schema jar.", "id": 188288, "time": "2016-02-08T12:39:24Z", "creator": "kiwiwings@apache.org", "creation_time": "2016-02-08T12:39:24Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "text": "OK, but when I tried to run the code with the combination of the bellow jars\ncommons-logging-1.1.3.jar\ndom4j-1.5.jar\nooxml-schemas-1.1.jar\npoi-3.9.jar\npoi-excelant-3.13-20150929.jar\npoi-ooxml-3.9.jar\npoi-scratchpad-3.13-20150929.jar\nslf4j-api-1.7.5.jar\nxmlbeans-2.6.0.jar\nxuggle-xuggler-5.4.jar\n\nThe ppt was created successfully, mp4 Video embedded successfully but when I start playing mp4 video in PPT it's not playing smoothly is it because of not using some of the latest jar?", "attachment_id": null, "id": 188289, "creator": "rahul.kr.sharma29@gmail.com", "time": "2016-02-08T13:09:22Z", "bug_id": 58973, "creation_time": "2016-02-08T13:09:22Z", "is_private": false}, {"count": 10, "tags": [], "bug_id": 58973, "text": "so the ppt error message is gone?\n(see [1] - John has also replaced the movie bookmark with the trim option, which is now also in my example)\n\nthe next thing is the movie itself ... does Powerpoint react differently if you import it manually (i.e. via Powerpoint)?\n\nif yes: is it still the same movie file?\nSimply unzip the .pptx and check the /.../media folder for your file.\n\nif yes, what's the difference in the .xml? compare slide1.xml (POI vs. Powerpoint)\n\nas I haven't tested yet your provided movie, my bet is, that powerpoint can play your movie, but there might be better codecs for it.\n\nbtw. I've tested the example with Powerpoint Viewer and Powerpoint 2016, which were ok.\nLibre Office couldn't recognize the trimming stuff.\n\n[1] http://apache-poi.1045710.n5.nabble.com/Question-about-embedded-video-in-PPTX-files-tt5718461.html", "id": 188291, "time": "2016-02-08T16:43:18Z", "creator": "kiwiwings@apache.org", "creation_time": "2016-02-08T16:43:18Z", "is_private": false, "attachment_id": null}, {"count": 11, "tags": [], "bug_id": 58973, "text": "... and of course having mixed POI jars is still a bad idea, but I ignore your used jars for the time being ...", "id": 188292, "attachment_id": null, "creator": "kiwiwings@apache.org", "creation_time": "2016-02-08T16:45:17Z", "time": "2016-02-08T16:45:17Z", "is_private": false}, {"count": 12, "tags": [], "bug_id": 58973, "attachment_id": null, "is_private": false, "id": 188302, "time": "2016-02-09T12:19:44Z", "creator": "rahul.kr.sharma29@gmail.com", "creation_time": "2016-02-09T12:19:44Z", "text": "Hi Andreas,\n\nI had tested the code with Full HD Movies, the videos are not playing very smoothly.Is there any size limit to embed a mp4 video to the PPT. I am getting OutOfMemoryError for more than 200 mb size of video and getting following error trash.\n\nException in thread \"main\" java.lang.OutOfMemoryError: Java heap space\n\tat java.util.Arrays.copyOf(Arrays.java:2271)\n\tat java.io.ByteArrayOutputStream.grow(ByteArrayOutputStream.java:118)\n\tat java.io.ByteArrayOutputStream.ensureCapacity(ByteArrayOutputStream.java:93)\n\tat java.io.ByteArrayOutputStream.write(ByteArrayOutputStream.java:153)\n\tat org.apache.poi.openxml4j.opc.internal.MemoryPackagePartOutputStream.write(MemoryPackagePartOutputStream.java:88)\n\tat pptxusingpoi.PPTXUsingPOI.main(PPTXUsingPOI.java:99)\n\nError coming for following code\n\nfor (int readBytes; (readBytes = fis.read(buf)) != -1; partOs.write(buf, 0, readBytes));\n\nI have uploaded some of Full-HD movies on Google-Drive and shared the access to you and the link of video is as fallows:\n\nhttps://drive.google.com/open?id=0B28rXyRBKGbJdnNfS0JGTEFHd0U\nhttps://drive.google.com/open?id=0B28rXyRBKGbJWEQzWExQcXdGblk"}, {"count": 13, "tags": [], "creator": "kiwiwings@apache.org", "is_private": false, "id": 188329, "attachment_id": null, "bug_id": 58973, "creation_time": "2016-02-10T00:54:30Z", "time": "2016-02-10T00:54:30Z", "text": "The stuttering video is a codec problem ... as I already guessed.\nUse ffmpeg to convert your videos - see [1]\nffmpeg -i input-video.mp4 -q:a 2 -q:v 4 -vcodec wmv2 -acodec wmav2 output-video.avi\n\nNot sure what you want to do with such big videos,\nbut it will be probably better, if you link and not embed the videos.\nPOI is holding the whole ZIP file in memory - if you link the files, there aren't POIs business.\n\nIf you still want to embed those file, either increase the memory settings or \nembed a dummy file and later on, you can change that file [2]\n\n\n[1] http://esonderegger.github.io/posts/20140320/powerpoint-ffmpeg.html\n[2] http://stackoverflow.com/questions/2223434/appending-files-to-a-zip-file-with-java"}, {"count": 14, "text": "Hi Andreas,\n\nIt is my client's requirement to embed HD video in ppt presentation. Actually we have recorded video of the surgical processes of the hospitals, this is why the videos are Full-HD and big in size.\nCurrently we are using Aspose for making embedded video presentation but Aspose also loading the video in the memory and that's why they have 30MB limitation for creation presentation. So we are looking POI option. My requirement is to embed MP4 video file in presentation, format conversion will not fulfill the requirement.\nI am going to try second option which one you suggested that is embed a dummy file and later on, change that file.\n\nFor codec issue is their any way to provide selected codec by java code in the program?\n\nThanks & Regards.\nRahul", "creator": "rahul.kr.sharma29@gmail.com", "is_private": false, "id": 188330, "time": "2016-02-10T10:03:27Z", "bug_id": 58973, "creation_time": "2016-02-10T10:03:27Z", "tags": [], "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "kiwiwings@apache.org", "is_private": false, "count": 15, "id": 188336, "time": "2016-02-10T17:11:21Z", "bug_id": 58973, "creation_time": "2016-02-10T17:11:21Z", "text": "(In reply to Rahul from comment #14)\n> I am going to try second option which one you suggested that is embed a\n> dummy file and later on, change that file.\n\nOf course the second option works also with Aspose.\n\n> For codec issue is their any way to provide selected codec by java code in\n> the program?\n\nNot sure if I understand you correctly:\n- either you think, the codec is just a parameter given from the outside (i.e. powerpoint):\nno ... the codec is inside the movie file/container (actually there a different movie containers (mp4,mkv,avi,...) having various audio/video codecs (h.264,x.264,...))\n\n- or you think, the conversion should take place with the help of java:\nyou could try something like jcodec.org, but I would simply call the ffmpeg executable from java\n\nThere's even a 3rd option which came to my mind, you could try to use an ActiveX control, something like a shockwave player. I guess the problem will be, how to give the embedded movie to the ActiveX control.\n\n(not sure, if we should continue the discussion in this bug entry, as it's going to be off-topic regarding POI ... would you mind switch to the mailing list?!)\n\nAndi"}, {"attachment_id": null, "tags": [], "bug_id": 58973, "text": "Hi Andreas,\n\nI has tested the Embedding video code with latest poi-poi-3.14-beta1-20151223.jar, but using this jar I find compile time error cannot-find-symbol for the bellow classes\n\nimport org.openxmlformats.schemas.presentationml.x2006.main.CTExtension;\nimport org.openxmlformats.schemas.presentationml.x2006.main.CTTLCommonMediaNodeData;\nimport org.openxmlformats.schemas.presentationml.x2006.main.CTTLCommonTimeNodeData;\nimport org.openxmlformats.schemas.presentationml.x2006.main.CTTimeNodeList;\nimport org.openxmlformats.schemas.presentationml.x2006.main.STTLTimeIndefinite;\nimport org.openxmlformats.schemas.presentationml.x2006.main.STTLTimeNodeFillType;\nimport org.openxmlformats.schemas.presentationml.x2006.main.STTLTimeNodeRestartType;\nimport org.openxmlformats.schemas.presentationml.x2006.main.STTLTimeNodeType;\n\nI think the regression issue is still pending with 3.14-beta version.\n\n\nThanks,", "count": 16, "id": 188841, "time": "2016-02-26T13:59:09Z", "creator": "rahul.kr.sharma29@gmail.com", "creation_time": "2016-02-26T13:59:09Z", "is_private": false}, {"count": 17, "tags": [], "text": "Hi Rahul,\n\nfrom your earlier response I know you are aware of using ooxml-schemas-1.1.jar.\nWhen you browse through that jar, you see your missing classes,\nwhich means you need to provide that jar also to your compiler.\nmaybe you need to change to the order in which the jars are processed.\nmaybe you need to remove the poi-ooxml-schemas.jar\n\n... but that's up to you to find out ...\n\nAndi", "attachment_id": null, "id": 188842, "creator": "kiwiwings@apache.org", "time": "2016-02-26T14:30:34Z", "bug_id": 58973, "creation_time": "2016-02-26T14:30:34Z", "is_private": false}, {"count": 18, "tags": [], "bug_id": 58973, "attachment_id": null, "is_private": false, "id": 189682, "time": "2016-03-23T21:59:02Z", "creator": "kiwiwings@apache.org", "creation_time": "2016-03-23T21:59:02Z", "text": "fixed - see comment 6"}]