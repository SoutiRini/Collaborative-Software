[{"count": 0, "tags": [], "bug_id": 54963, "is_private": false, "id": 167185, "attachment_id": 30280, "creator": "xshao@ebay.com", "creation_time": "2013-05-14T06:50:20Z", "time": "2013-05-14T06:50:20Z", "text": "Created attachment 30280\nPatch for NetSupportSocket\n\nDuplicated Threads were started for doing \"onBlockingSocket\" in NetSupportSocket.java\n\nWhen a socket is coming, Listener creates a Runnable and executes the runnable with Thread Pool.  \n\nIn \"onAccept\", it invokes the method \"onBlockingSocket\". And the same method will be invoked in \"ctx.getExecutor().execute(ch.inputThread);\" as well.\n\nIt means there are two threads work on one sinle Socket.  This cause concurrent issue.\n\nHere is the orginal code,\n\n\n    @Override\n    public void onAccept(Object socket) {\n        SpdyConnectionSocket ch = new SpdyConnectionSocket(ctx, (Socket) socket);\n        ctx.getExecutor().execute(ch.inputThread);\n        ch.onBlockingSocket();\n    }\n\nJust remove the line \"ctx.getExecutor().execute(ch.inputThread);\" will fix this issue."}, {"count": 1, "tags": [], "bug_id": 54963, "attachment_id": null, "is_private": false, "id": 167457, "time": "2013-05-28T11:47:06Z", "creator": "markt@apache.org", "creation_time": "2013-05-28T11:47:06Z", "text": "Thanks for the patch. Applied to trunk."}]