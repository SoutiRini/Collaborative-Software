[{"count": 0, "attachment_id": null, "bug_id": 26509, "is_private": false, "id": 51366, "time": "2004-01-29T03:48:16Z", "creator": "neil+apachebugzilla@askneil.com", "creation_time": "2004-01-29T03:48:16Z", "tags": [], "text": "DataSourceRealms only validate against DataSources defined\nin the global context.  Several folks were confused by this,\nor asked to have it changed:\n\nhttp://nagoya.apache.org/bugzilla/show_bug.cgi?id=16316\nhttp://nagoya.apache.org/bugzilla/show_bug.cgi?id=24545\nhttp://nagoya.apache.org/bugzilla/show_bug.cgi?id=24723\nhttp://nagoya.apache.org/bugzilla/show_bug.cgi?id=25805\n\nAs well, there has been comments on the tomcat-dev mailing list about this:\n\nhttp://www.servlets.com/archive/servlet/BrowseList?listName=tomcat-dev&by=subject&from=148510\n\nI was surprised by this this week -- the fact that DataSourceRealm only\nworks against the global context is undocumented (except in mailing lists).\n\nI'm going to guess that if I just asked for things to be changed, the request\nwould be rejected, as all the other requests were.  Besides, changing the\nexisting DataSourceRealm's behaviour could break existing code.  I have\na different proposal:\n\nI'ld like to introduce a new class: LocalDataSourceRealm.  It would be\nidentical to DataSourceRealm, except that it queries the container's JNDI\ncontext, instead of the global one.  I've coded up a subclass of DataSourceRealm\nto do this; it works for me.\n\nI did have to make one change to DataSourceRealm to avoid copying the\nwhole file: I changed the open() method to be protected instead of private.\nI changed close() to protected also for symmetry.\n\nRemy, if you find this more acceptable I'll attach a full patch, including\ndocumentation updates."}, {"count": 1, "tags": [], "creator": "neil+apachebugzilla@askneil.com", "attachment_id": 10138, "text": "Created attachment 10138\nWorking implementation of LocalDataSourceRealm class", "id": 51367, "time": "2004-01-29T03:50:03Z", "bug_id": 26509, "creation_time": "2004-01-29T03:50:03Z", "is_private": false}, {"count": 2, "tags": [], "text": "Indeed. So why do you create a new bug ? This is a duplicate.\n\n*** This bug has been marked as a duplicate of 25805 ***", "attachment_id": null, "id": 51379, "creator": "remm@apache.org", "time": "2004-01-29T08:23:51Z", "bug_id": 26509, "creation_time": "2004-01-29T08:23:51Z", "is_private": false}, {"count": 3, "tags": [], "text": "\nIt isn't a bug -- its an enhancement, with a specific suggestion for\nhow to accomodate both needs.  Doesn't that at least deserve some\nconsideration?\n", "is_private": false, "id": 51397, "creator": "neil+apachebugzilla@askneil.com", "time": "2004-01-29T15:00:14Z", "bug_id": 26509, "creation_time": "2004-01-29T15:00:14Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 26509, "attachment_id": null, "is_private": false, "id": 51399, "time": "2004-01-29T15:05:20Z", "creator": "neil+apachebugzilla@askneil.com", "creation_time": "2004-01-29T15:05:20Z", "text": "\nSorry for the last comment; I hadn't read all my mail to\nsee that the patch was accepted...\n"}]