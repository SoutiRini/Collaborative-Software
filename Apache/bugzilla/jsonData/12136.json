[{"count": 0, "tags": [], "bug_id": 12136, "attachment_id": null, "is_private": false, "id": 21919, "time": "2002-08-28T19:46:21Z", "creator": "elvira_gurevich@ibi.com", "creation_time": "2002-08-28T19:46:21Z", "text": "Running code from jakarta-poi-1.7.0-dev-bin.zip,\nI get the following stack trace when reading a file of about 130 rows and 4 \ncolumns( not really that big!):\njava.lang.NullPointerException\n        at org.apache.poi.hssf.usermodel.HSSFSheet.setPropertiesFromSheet(HSSFSh\neet.java:174)\n        at org.apache.poi.hssf.usermodel.HSSFSheet.<init>(HSSFSheet.java:136)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:1\n64)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:1\n90)\n        at com.ibi.preparsers.XDExcelpreParser.transform(XDExcelpreParser.java:1\n07)\n        at com.ibi.edaqm.XDWorker.parseAndValidate(XDWorker.java:1202)\n        at com.ibi.edaqm.XDWorker.parseAndValidate(XDWorker.java:1147)\n        at com.ibi.edaqm.XDFileWorker.run(XDFileWorker.java:208)\n        at java.lang.Thread.run(Thread.java:484)\n\nThis does not happen when the file has 1 row less.\nThe call to HSSFWorkbook is as following:\n        HSSFWorkbook workbook = new HSSFWorkbook(new ByteArrayInputStream\n(input.getBytes()));\nwhere the file was initially read into a String input."}, {"count": 1, "tags": [], "creator": "elvira_gurevich@ibi.com", "attachment_id": 2870, "id": 21988, "creation_time": "2002-08-29T17:38:27Z", "time": "2002-08-29T17:38:27Z", "bug_id": 12136, "text": "Created attachment 2870\nexcel file producing an error", "is_private": false}, {"count": 2, "tags": [], "text": "I ran the latest CVS against the attachment and the following worked fine:\n\nHSSFWorkbook workbook = new HSSFWorkbook(new FileInputStream(\"c:/att.xls\"));\n\nMaybe the input.getBytes that you are calling is not providing the entire set \nof bytes or try the latest build from the nightly area and let us know if it is \nfixed or not: http://jakarta.apache.org/builds/jakarta-poi/nightly/\n\nJason", "attachment_id": null, "id": 22013, "creator": "jheight@apache.org", "time": "2002-08-30T04:17:16Z", "bug_id": 12136, "creation_time": "2002-08-30T04:17:16Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 12136, "attachment_id": null, "id": 22029, "time": "2002-08-30T14:36:57Z", "creator": "elvira_gurevich@ibi.com", "creation_time": "2002-08-30T14:36:57Z", "is_private": false, "text": "you are right! we were reading the file as bytes, converting them to String and \nthen converting back to bytes - sort of legacy design, since originally we were \nonly dealing with character files. changing code to deal with the original byte \narray fixed this problem. Thanks! "}]