[{"count": 0, "tags": [], "creator": "iluvtr@gmail.com", "attachment_id": 32630, "text": "Created attachment 32630\nSample projects demonstrating the bug\n\nIn Tomcat 8 the Resources framework intented for loading JSP, static resources and JAR, doesn't work with resources located in META-INF/resources as specified by Servlet 3.0 specification.  In Tomcat 7 with the old VirtualWebLoader this feature worked pretty well.\n\nFor example you have a JAR with this content\n\n/META-INF/resources/admin/test.jsp\n/META-INF/resources/admin/test.js\n/META-INF/resources/tags/test.tag\n/META-INF/tlds/javapp.tld \n\nNormally with Servlet 3.0 feature you can access this files for example:\n\nhttp://localhost:8080/webapp/admin/test.jsp Doesn't work, 404 for you\n\nTag libraries declared in JARs including those linking to Tag files doesn't work too\nFor example this Tag Library located at /META-INF/tlds/javapp.tld doesn't work\n\n<taglib>\n  <tlib-version>1.0</tlib-version>\n  <short-name>javaapp</short-name>\n  <uri>/javaapp</uri>\n  <tag-file>\n    <name>test</name>\n    <path>/META-INF/tags/test.tag</path>\n  </tag-file>\n</taglib>\n\n\nI tried with the following configurations in context.xml\n\nThis\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Context  path=\"/webapp\"  >   \n \n    <Resources>\n        \n        <PostResources className=\"org.apache.catalina.webresources.DirResourceSet\"\n                       base=\"D:/PROYECTOS/modules/javaapp/target/classes\"\n                       internalPath=\"/\"\n                       webAppMount=\"/WEB-INF/classes\" />\n\n    </Resources>\n    \n</Context>\n\n\nAnd this\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Context path=\"/webapp\"  >   \n \n    <Resources>\n\n \n  <JarResources className=\"org.apache.catalina.webresources.JarResourceSet\"\n                       base=\"D:/PROYECTOS/modules/javaapp/target/javaapp-1.0-SNAPSHOT.jar\"\n                       internalPath=\"/\"\n                       webAppMount=\"/WEB-INF/lib\" />\n        \n    </Resources>\n   \n</Context>\n\n\nI'm attaching the projects, all you have to do is change the base attribute of the Resources", "id": 182234, "time": "2015-04-03T16:43:47Z", "bug_id": 57791, "creation_time": "2015-04-03T16:43:47Z", "is_private": false}, {"count": 1, "tags": [], "creator": "markt@apache.org", "is_private": false, "text": "The provided test case fails because it is using the wrong configuration to map the external JAR into the web application. Even though the file is a JAR, it needs to be mapped as a file, not as a JAR. Mapping as a JAR exposes the contents of the JAR to the web application which is not what is required. A working configuration is:\n\n<PreResources className=\"org.apache.catalina.webresources.FileResourceSet\"\n              base=\"D:/PROYECTOS/modules/javaapp/target/javaapp-1.0-SNAPSHOT.jar\"\n              internalPath=\"/\"\n              webAppMount=\"/WEB-INF/lib/javaapp-1.0-SNAPSHOT.jar\" />\n\nThis tells Tomcat to treat this external file as it it was located within the web application.", "id": 182558, "time": "2015-04-22T14:36:54Z", "bug_id": 57791, "creation_time": "2015-04-22T14:36:54Z", "attachment_id": null}]