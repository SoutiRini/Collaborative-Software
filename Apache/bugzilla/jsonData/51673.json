[{"count": 0, "tags": [], "creator": "pakbugzilla@gmail.com", "text": "Created attachment 27399\nTest Class for the GroupRow Issue\n\nUsing the groupRow method on an SXSSFSheet causes Excel to say it contains unreadable data when opening the workbook.  The rows that were grouped were still active in the sliding window.", "id": 148670, "attachment_id": 27399, "bug_id": 51673, "creation_time": "2011-08-17T21:39:55Z", "time": "2011-08-17T21:39:55Z", "is_private": false}, {"count": 1, "tags": [], "creator": "geedeen@gmail.com", "attachment_id": null, "text": "We tried to debug the issue and the issue is in groupRow() method of XSSFSheet object (_sh) in SXSSFSheet. SXSSFSheet.groupRow() calls XSSFSheet.groupRow() method. This method checks if the row exists already, if yes, then create a new row. For some reasons _rows map is empty in XSSFSheet , whereas _rows in SXSSFSheet is populated. So XSSFSheet.groupRow() method overwrites the content by creating a new Row for the same index. In short, SXSSFSheet._rows and XSSFSheet._rows are not in sync and so the rows are corrupted.", "id": 150543, "time": "2011-10-13T21:12:25Z", "bug_id": 51673, "creation_time": "2011-10-13T21:12:25Z", "is_private": false}, {"count": 2, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "is_private": false, "id": 150660, "time": "2011-10-17T11:53:13Z", "bug_id": 51673, "creation_time": "2011-10-17T11:53:13Z", "text": "It would seem that groupRow will need to be directly implemented on SXSSFSheet, and isn't something that can be delegated down to XSSFSheet\n\nSomeone would need to look at the method on XSSFSheet, review the actions it performs, then add a similar thing to SXSSFSheet (working on the sometimes different objects that SXSSF has to hand)"}, {"count": 3, "tags": [], "bug_id": 51673, "is_private": false, "id": 154356, "creation_time": "2012-02-29T10:58:51Z", "time": "2012-02-29T10:58:51Z", "creator": "yegor@dinom.ru", "text": "Support for grouping rows in SXSSF has been committed in r1295058\n\nPlease note that the rows being grouped must be in the memory window, you cannot write 1000000 rows and then group rows 100-200. \nWorkbook wb = new SXSSFWorkbook(100);\n\n        Sheet sh = wb.createSheet();\n\n        for (int rownum = 0; rownum < 1000; rownum++) {\n            Row row = sh.createRow(rownum);\n            if(rownum == 200)  {\n                sh.groupRow(100, 200);\n            }\n\n        }\n\n        for (int rownum = 0; rownum < 1000; rownum++) {\n            Row row = sh.createRow(rownum);\n        }\n        sh.groupRow(100, 200);", "attachment_id": null}, {"count": 4, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "is_private": false, "id": 154357, "time": "2012-02-29T11:01:17Z", "bug_id": 51673, "creation_time": "2012-02-29T11:01:17Z", "text": "Please ignore my previous post, I occasionally submitted it too early.\n\nSupport for grouping rows in SXSSF has been committed in r1295058\n\nPlease note that the rows being grouped must be in the memory window, you cannot write 1000000 rows and then group rows 100-200. \n\nExamples:\n\n        Workbook wb = new SXSSFWorkbook(100);\n\n        Sheet sh = wb.createSheet();\n\n        for (int rownum = 0; rownum < 1000; rownum++) {\n            Row row = sh.createRow(rownum);\n            if(rownum == 200)  {\n                // correct: group rows while they are in memory\n                sh.groupRow(100, 200);\n            }\n\n        }\n\n        for (int rownum = 0; rownum < 1000; rownum++) {\n            Row row = sh.createRow(rownum);\n        }\n        // wrong: rows are already flushed and groupRow has no effect\n        sh.groupRow(100, 200);\n\nYegor"}, {"count": 5, "tags": [], "creator": "sweeny121@gmail.com", "attachment_id": null, "is_private": false, "id": 168093, "time": "2013-06-27T07:52:14Z", "bug_id": 51673, "creation_time": "2013-06-27T07:52:14Z", "text": "Yegor,\n\nHow do you group rows that have been flushed, i.e. are not in the memory window now?"}]