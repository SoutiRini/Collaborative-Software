[{"count": 0, "tags": [], "creator": "kumphol@s-onetelecom.com", "attachment_id": null, "text": "Dear all,\n\nI'm not sure is this bug? but If we use phone browser browse redirect page by \nsome mobile browser it isn't work:\n\n========================\nFile: index.jsp\n========================\n<%\nresponse.sendRedirect(\"../login.jsp\");\n%>\n========================\n\nI check by use telnet to my server and write HTTP request to see the response \nbelow:\n\n\nGET /wap/index.jsp HTTP/1.0\nHOST: myserver:8080\n\nHTTP/1.1 302 Moved Temporarily\nSet-Cookie: JSESSIONID=F2CCA24F97C6990CB96354EE4DC398BD; Path=/wap\nLocation: http://myserver:8080/wap/../login.jsp\nContent-Type: text/html\nContent-Length: 0\nDate: Tue, 20 Jul 2004 11:48:20 GMT\nServer: Apache-Coyote/1.1\nConnection: close\n\n\nI think that phone browser doesn't support this Location url : \nhttp://myserver:8080/wap/../login.jsp, but on Tomcat 4.x this file will generate \nheader in absolute url like this below and it work:\n\nHTTP/1.1 302 Moved Temporarily\nLocation: http://myserver:8080/wap/login.jsp\nContent-Length: 0\nDate: Tue, 20 Jul 2004 12:08:37 GMT\nServer: Apache-Coyote/1.1\nConnection: close\n\n\nCould you advise which Tomcat 5.x can resolve this unexpected problem. I know \nthat Tomcat 5.x have performance optimization and more efficiently features.\n\nThank you.\n\nKumphol Rattanachanchai", "id": 60864, "time": "2004-07-20T12:30:43Z", "bug_id": 30206, "creation_time": "2004-07-20T12:30:43Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 30206, "is_private": false, "text": "If you want to support broken clients, I suggest modifying the Tomcat code\n(normalizing the URL before setting the location header seems a possibility).", "id": 60865, "time": "2004-07-20T12:35:14Z", "creator": "remm@apache.org", "creation_time": "2004-07-20T12:35:14Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 30206, "text": "Thank you for your reply,\n\nI download jakarta-tomcat-5.0.27-src and see sendRedirect method description \nbelow:\n\n===================================================\n    /**\n     * Sends a temporary redirect response to the client using the\n     * specified redirect location URL.  This method can accept relative URLs;\n     * the servlet container must convert the relative URL to an absolute URL\n     * before sending the response to the client. If the location is relative \n     * without a leading '/' the container interprets it as relative to\n     * the current request URI. If the location is relative with a leading\n     * '/' the container interprets it as relative to the servlet container root.\n     *\n     * <p>If the response has already been committed, this method throws \n     * an IllegalStateException.\n     * After using this method, the response should be considered\n     * to be committed and should not be written to.\n     *\n     * @param\t\tlocation\tthe redirect location URL\n     * @exception\tIOException\tIf an input or output exception occurs\n     * @exception\tIllegalStateException\tIf the response was committed or\n if a partial URL is given and cannot be converted into a valid URL\n     */\n\n    public void sendRedirect(String location) throws IOException;\n===================================================\n\nI am new developer with jakarta-tomcat. Please suggest me how to implement \nthis method.\n\nThank you,\nKumphol.", "id": 61023, "time": "2004-07-23T04:39:07Z", "creator": "kumphol@s-onetelecom.com", "creation_time": "2004-07-23T04:39:07Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 30206, "text": "You need to look at the toAbsolute method of the \norg.apache.coyote.tomcat5.CoyoteResponse class.  That is where you would \nnormalize the URL.", "id": 61024, "time": "2004-07-23T05:35:54Z", "creator": "william.barker@wilshire.com", "creation_time": "2004-07-23T05:35:54Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 30206, "text": "It's the same as for a canonicalized path vs an absolute path. We implement the\nspecification correctly (returning an absolute URL), so there's nothing to fix.\nThe implementation of the sendRedirect menthod is indeed in the class Bill\nmentioned.", "id": 61027, "time": "2004-07-23T06:49:33Z", "creator": "remm@apache.org", "creation_time": "2004-07-23T06:49:33Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "text": "*** Bug 30287 has been marked as a duplicate of this bug. ***", "id": 61043, "time": "2004-07-23T08:55:57Z", "bug_id": 30206, "creation_time": "2004-07-23T08:55:57Z", "is_private": false}, {"count": 6, "tags": [], "creator": "kumphol@s-onetelecom.com", "attachment_id": null, "text": "I had modified code follow William suggested. Work very well.\n\nThank you for your supported.", "id": 61263, "time": "2004-07-28T17:33:09Z", "bug_id": 30206, "creation_time": "2004-07-28T17:33:09Z", "is_private": false}]