[{"count": 0, "tags": [], "bug_id": 31821, "attachment_id": null, "text": "I am getting a exception when i am trying to biff view xls  file.\n\njava.lang.ArrayIndexOutOfBoundsException\n        at java.lang.System.arraycopy(Native Method)\n        at org.apache.poi.ddf.EscherArrayProperty.getElement\n(EscherArrayProperty\n.java:111)\n        at org.apache.poi.ddf.EscherArrayProperty.toString\n(EscherArrayProperty.j\nava:146)\n        at org.apache.poi.ddf.EscherOptRecord.toString\n(EscherOptRecord.java:138)\n\n        at org.apache.poi.ddf.EscherContainerRecord.toString\n(EscherContainerReco\nrd.java:158)\n        at org.apache.poi.hssf.record.AbstractEscherHolderRecord.toString\n(Abstra\nctEscherHolderRecord.java:126)\n        at org.apache.poi.hssf.dev.BiffViewer.dumpNormal(BiffViewer.java:148)\n        at org.apache.poi.hssf.dev.BiffViewer.access$1(BiffViewer.java:144)\n        at org.apache.poi.hssf.dev.BiffViewer$RecordDetails.dump\n(BiffViewer.java\n:700)\n        at org.apache.poi.hssf.dev.BiffViewer.createRecords\n(BiffViewer.java:120)\n\n        at org.apache.poi.hssf.dev.BiffViewer.run(BiffViewer.java:73)\n        at org.apache.poi.hssf.dev.BiffViewer.main(BiffViewer.java:652)\n\n\n\nI just debugged a little  and found a strange thing\n\nHere is the modified code i used to debug\n\n    public byte[] getElement( int index )\n    {\n        int actualSize = getActualSizeOfElements(getSizeOfElements());\n        byte[] result = new byte[actualSize];\n       try {\n\t\t\tSystem.arraycopy(complexData, FIXED_SIZE + index * \nactualSize, result, 0, result.length );\n\t\t\t//System.arraycopy(complexData, 0, result, 0, \nresult.length );\n        } catch (Exception exception) {\n        \tSystem.out.println(\"================\");\n        \tSystem.out.println(\"src array total length \n= \"+complexData.length);\n\t\t\t//System.out.println(\"src position = \"+FIXED_SIZE + \nindex * actualSize);\n\t\t\tSystem.out.println(\"FIXED_SIZE  \"+FIXED_SIZE);\n\t\t\tSystem.out.println(\"index  \"+index);\n\t\t\tSystem.out.println(\"actualSize  \"+actualSize);\n\t\t\tSystem.out.println(\"dest array len = \"+result.length);\n\t\t\t\n\t\t\tSystem.out.println(\"length = \"+result.length);\n\t\t\t\n\t\t\tSystem.out.println(\"=================\");\n        }\n\nThe results are surprising..\nhere are they\n\nsrc array total length = 6\nFIXED_SIZE  6\nindex  7\nactualSize  1290\ndest array len = 1290\nlength = 1290\n=================\n================\nsrc array total length = 6\nFIXED_SIZE  6\nindex  8\nactualSize  1290\ndest array len = 1290\nlength = 1290\n=================\n================\nsrc array total length = 6\nFIXED_SIZE  6\nindex  9\nactualSize  1290\ndest array len = 1290\nlength = 1290\n=================\n================\nsrc array total length = 6\nFIXED_SIZE  6\nindex  10\nactualSize  1290\ndest array len = 1290\nlength = 1290\n=================\n================\nsrc array total length = 6\nFIXED_SIZE  6\nindex  11\nactualSize  1290\ndest array len = 1290\nlength = 1290\n=================\n================\nsrc array total length = 6\nFIXED_SIZE  6\nindex  12\nactualSize  1290\ndest array len = 1290\nlength = 1290\n=================\n\nSo is the logic \n\nSystem.arraycopy(complexData, FIXED_SIZE + index * actualSize, result, 0, \nresult.length );\n correct??", "id": 65415, "time": "2004-10-21T06:29:45Z", "creator": "ash_sha_21@yahoo.com", "creation_time": "2004-10-21T06:29:45Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 31821, "attachment_id": null, "text": "I know that this is critical for you, however i am affraid that you will have to\nbear with us.\n\nI certainly work on HSSF for fun ... (now thats an oxymoron) ... and only really\nget about an hour a day to do so. I dont know about whether any other developer\nhas time.\n\nHowever i prefer to work on those issues that result in corruption, rather than\nfeature requests, so this one is high on my radar.\n\nUnfortunately for you i am currently rewriting some of the low level record\nreading code which i havent quite got into a usable state hence i cant work on\nyour probalem ... yet.\n\nJason", "id": 65625, "time": "2004-10-25T01:14:26Z", "creator": "jheight@apache.org", "creation_time": "2004-10-25T01:14:26Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 31821, "text": "You can turn off deserializing of the escher records.\n\nGo to line 632 and alter:\n\nSystem.setProperty(\"poi.deserialize.escher\", \"true\");\n\nto\n\nSystem.setProperty(\"poi.deserialize.escher\", \"false\");", "id": 65640, "time": "2004-10-25T10:55:21Z", "creator": "glens@apache.org", "creation_time": "2004-10-25T10:55:21Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 31821, "attachment_id": null, "text": "Actually...  not exactly right.  Remove the line completely to turn off\ndeserialization of escher records.", "id": 65641, "time": "2004-10-25T11:01:25Z", "creator": "glens@apache.org", "creation_time": "2004-10-25T11:01:25Z", "is_private": false}, {"count": 4, "tags": [], "creator": "avik@apache.org", "text": "Can you attach the excel sheet that was causing problems for you? There have\nbeen some fixes to these parts, so maybe this has also been fixed?", "id": 74362, "time": "2005-05-03T15:37:08Z", "bug_id": 31821, "creation_time": "2005-05-03T15:37:08Z", "is_private": false, "attachment_id": null}, {"attachment_id": 19549, "tags": [], "bug_id": 31821, "text": "Created attachment 19549\nfixes ArrayOutOfBounds exception\n\nIn trying various things, I got this common error, found the code, and fixed\nit.", "count": 5, "id": 99116, "time": "2007-02-08T08:49:13Z", "creator": "bkalbfus@emerginghealthit.com", "creation_time": "2007-02-08T08:49:13Z", "is_private": false}, {"count": 6, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "id": 116745, "time": "2008-05-17T06:46:19Z", "bug_id": 31821, "creation_time": "2008-05-17T06:46:19Z", "is_private": false, "text": "Please check if the problem still exists in 3.1-beta1.\n\nYegor"}, {"count": 7, "tags": [], "creator": "dfisher@jmlafferty.com", "text": "Low Level code is clearly different.", "id": 124935, "time": "2009-02-18T09:40:35Z", "bug_id": 31821, "creation_time": "2009-02-18T09:40:35Z", "is_private": false, "attachment_id": null}]