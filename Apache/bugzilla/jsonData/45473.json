[{"count": 0, "tags": [], "bug_id": 45473, "attachment_id": 22311, "text": "Created attachment 22311\nthis file is not handled correctly\n\nSimply reading and writing this file:\n\n\t\tHWPFDocument doc = new HWPFDocument(new FileInputStream(\"hebrew.doc\"));\n\t\tFileOutputStream fos=new FileOutputStream(\"hebrew2.doc\");\n\t\tdoc.write(fos);\n\ngenerates a corrupted word file which can not be read by either Word or POI:\n\nException in thread \"main\" java.lang.ArrayIndexOutOfBoundsException\n\tat java.lang.System.arraycopy(Native Method)\n\tat org.apache.poi.hwpf.model.TextPieceTable.<init>(TextPieceTable.java:91)\n\tat org.apache.poi.hwpf.model.ComplexFileTable.<init>(ComplexFileTable.java:59)\n\tat org.apache.poi.hwpf.HWPFDocument.<init>(HWPFDocument.java:219)\n\tat org.apache.poi.hwpf.HWPFDocument.<init>(HWPFDocument.java:152)\n\tat org.apache.poi.hwpf.HWPFDocument.<init>(HWPFDocument.java:140)\n\tat HWPFwrite.main(HWPFwrite.java:19)\n\nI am using POI 3.1 final", "id": 118964, "time": "2008-07-24T01:47:41Z", "creator": "sbendavid@gmail.com", "creation_time": "2008-07-24T01:47:41Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 45473, "text": "The problem is not reproducible with latest build from trunk. I added a unit test and included the attached document in our collection of test documents.\n\nYegor", "id": 147429, "time": "2011-06-24T08:21:26Z", "creator": "yegor@dinom.ru", "creation_time": "2011-06-24T08:21:26Z", "is_private": false, "attachment_id": null}]