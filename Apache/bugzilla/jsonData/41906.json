[{"count": 0, "attachment_id": null, "creator": "enterit@gmail.com", "text": "SUMIF(range;criteria;sum_range) formula with reference to another cell in \ncriteria part is not evaluated in Excel.", "id": 100679, "time": "2007-03-20T09:41:27Z", "bug_id": 41906, "creation_time": "2007-03-20T09:41:27Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 41906, "attachment_id": null, "id": 100680, "time": "2007-03-20T09:43:41Z", "creator": "enterit@gmail.com", "creation_time": "2007-03-20T09:43:41Z", "is_private": false, "text": "For example, \nSUMIF(A1:A100;B1;E1:E100) \n- Excel does not recalculate. It leaves zero in such cell.\n\nbut\nSUMIF(A1:A100;B1+0;E1:E100) \n- Excel recalculates properly.\n\nI used Excel 2007."}, {"count": 2, "attachment_id": null, "creator": "enterit@gmail.com", "text": "Test code:\n\n        HSSFWorkbook book = new HSSFWorkbook();\n        HSSFSheet sheet = book.createSheet();\n\n        HSSFRow row0 = sheet.createRow(0);\n        row0.createCell((short)0).setCellValue(1);\n        row0.createCell((short)1).setCellValue(1);\n        row0.createCell((short)2).setCellValue(3);\n        row0.createCell((short)3).setCellFormula(\"SUMIF(A1:A100;B1;C1:C100)\");\n\n        HSSFRow row1 = sheet.createRow(1);\n        row1.createCell((short)0).setCellValue(1);\n        row1.createCell((short)1).setCellValue(1);\n        row1.createCell((short)2).setCellValue(3);\n        row1.createCell((short)3).setCellFormula(\"SUMIF(A1:A100;B1+0;C1:C100)\");\n        \n        FileOutputStream fos = new FileOutputStream(\"book.xls\");\n        book.write(fos);\n        fos.close();\n\nFirst row in resulting workbook contains formula, that is not calculated by \nExcel.\nSecond row contains formula, that is calculated properly.", "id": 100681, "time": "2007-03-20T09:45:09Z", "bug_id": 41906, "creation_time": "2007-03-20T09:45:09Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 41906, "attachment_id": null, "text": "Hello.\nAny news ?", "id": 100947, "time": "2007-03-26T00:29:12Z", "creator": "enterit@gmail.com", "creation_time": "2007-03-26T00:29:12Z", "is_private": false}, {"count": 4, "tags": [], "text": "Re-tested in 3.1-beta1.\n\nThis was probably fixed in bug 44675 (The second argument (ReferencePtg) operand\nclass should be 'value' not 'reference')", "attachment_id": null, "id": 116269, "creator": "josh@apache.org", "time": "2008-05-05T14:55:03Z", "bug_id": 41906, "creation_time": "2008-05-05T14:55:03Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 41906, "attachment_id": null, "id": 116287, "time": "2008-05-06T00:51:12Z", "creator": "enterit@gmail.com", "creation_time": "2008-05-06T00:51:12Z", "is_private": false, "text": "Why the second argument should be 'value' not 'reference'?\nI seems Excel supports reference as the second argument.\nI am able to create cell with formula \"=SUMIF(A1:A100;B1;C1:C100)\" using Excel 2007.\nI think that current POI behaviour (3.1-beta) has regression, since it does not allow to create such formulas (neither \"..;B1;..\" nor \"..;B1+0;..\" can be created)."}, {"count": 6, "tags": [], "creator": "josh@apache.org", "attachment_id": null, "id": 116304, "time": "2008-05-06T08:56:51Z", "bug_id": 41906, "creation_time": "2008-05-06T08:56:51Z", "is_private": false, "text": "(In reply to comment #5)\n> I think that current POI behaviour (3.1-beta) has regression, \nSorry I mis-typed. I meant \"Re-tested in 3.1-beta2\". Bug 44675 was completed after 3.1-beta1.  You can either wait for the beta2 release, grab a nightly build, or build directly from svn trunk.\n\n\n> Why the second argument should be 'value' not 'reference'?\n> I seems Excel supports reference as the second argument.\n'Operand classes' are different to token types.  If the second arg is a reference, the token type will be 'tRef'.  Depending on the operand class, it will be 'tRefR', 'tRefV', or 'tRefA'.   \n"}]