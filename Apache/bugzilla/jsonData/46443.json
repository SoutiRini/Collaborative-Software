[{"count": 0, "tags": [], "bug_id": 46443, "attachment_id": null, "text": "I am getting a strange message when I read the paragraphs of a Word file. Here is the message:\n\t\nproperty claimed to start before zero, at -512! Resetting it to zero, and hoping for the best\n\nHere is my code. It happens on the createion of the new HWPFDocument.\n        final POIFSFileSystem fileSystem = new POIFSFileSystem(new FileInputStream(file));\n        final HWPFDocument document = new HWPFDocument(fileSystem);\n\nThe error occurs in org.apache.poi.hwpf.model.PropertyNode in the constructor :\n\n  protected PropertyNode(int fcStart, int fcEnd, Object buf)\n  {\n      _cpStart = fcStart;\n      _cpEnd = fcEnd;\n      _buf = buf;\n      \n      if(_cpStart < 0) {\n    \t  System.err.println(\"A property claimed to start before zero, at \" + _cpStart + \"! Resetting it to zero, and hoping for the best\");\n    \t  _cpStart = 0;\n      }\n  }\n\nThe -512 originates in a calculation done in org.apache.poi.hwpf.model. CHPFormattedDiskPage, where getStart(x) returns 1536 and fcMin is 2048.\n\n    public CHPFormattedDiskPage(byte[] documentStream, int offset, int fcMin, TextPieceTable tpt)\n    {\n      super(documentStream, offset);\n\n      for (int x = 0; x < _crun; x++)\n      {\n    \tboolean isUnicode = tpt.isUnicodeAtByteOffset( getStart(x) );\n        _chpxList.add(new CHPX(getStart(x) - fcMin, getEnd(x) - fcMin, getGrpprl(x), isUnicode));\n      }\n    }\n\nI am using these jars, the latest version available to download using Maven2:\npoi-3.5-beta4.jar\npoi-scratchpad-3.5-beta4.jar\n\nIt still seems to work, but I get a lot of these messages.\n\nNOTE: This message appears in bug 46220 but that bug does not seem to be related.", "id": 123605, "time": "2008-12-29T20:30:26Z", "creator": "doug.mccomsey@verizon.net", "creation_time": "2008-12-29T20:30:26Z", "is_private": false}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "text": "This warning is because our understanding of how the file's structure should work out, and how it has been found differs.\n\nIf you're just reading stuff, you're likely to be ok. However, writing changes back out might break, as other things are likely to be wrong too. (It generally seems that ignoring the negative start and assuming it's zero lets most stuff work, but we're not entirely sure why)\n\nAny help figuring out where one of our assumptions is wrong, so we can handle this cleanly, are greatly appreciated!", "id": 123802, "time": "2009-01-06T11:13:52Z", "bug_id": 46443, "creation_time": "2009-01-06T11:13:52Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 46443, "attachment_id": null, "text": "*** Bug 46511 has been marked as a duplicate of this bug. ***", "id": 123946, "time": "2009-01-12T02:38:15Z", "creator": "apache@gagravarr.org", "creation_time": "2009-01-12T02:38:15Z", "is_private": false}, {"count": 3, "tags": [], "creator": "adb@teamware.com", "text": "Sorry for the duplicate.  Is there a good reason to leave this in the final libraries as it can be quite annoying when it occurs frequently.  We are using it for text extraction and get it quite a lot.\n", "id": 123947, "time": "2009-01-12T02:43:53Z", "bug_id": 46443, "creation_time": "2009-01-12T02:43:53Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 46443, "text": "See Comment #1. The warning remains because the problem remains", "id": 123948, "attachment_id": null, "creator": "apache@gagravarr.org", "creation_time": "2009-01-12T02:50:30Z", "time": "2009-01-12T02:50:30Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 46443, "attachment_id": null, "text": "Nick, I understand your reasoning for the warning, but from a large scale deployed server side application that is simply extracting text from hundreds of thousands of word documents for indexing, this message creates a massive amount of noise and obscures other potentially important errors.  You refer to comment #1 where you say\n\n\"If you're just reading stuff, you're likely to be ok\"\n\nso why does POI forcing a system.err when it is not aware of the higher level use case.\n\nAt least can't you make the output conditional on some system property, so at least applications, for which this is not important, can disable it.", "id": 126452, "time": "2009-04-22T16:30:11Z", "creator": "adb@teamware.com", "creation_time": "2009-04-22T16:30:11Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 46443, "attachment_id": null, "text": "The same applies to the error in SectionTable.java\n\nSystem.err.println(\"Your document seemed to be mostly unicode, but the section definition was in bytes! Trying anyway, but things may well go wrong!\");\n\nYou also say that read-only case should be fine.", "id": 126453, "time": "2009-04-22T16:38:45Z", "creator": "adb@teamware.com", "creation_time": "2009-04-22T16:38:45Z", "is_private": false}, {"count": 7, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 126460, "time": "2009-04-23T07:15:43Z", "bug_id": 46443, "creation_time": "2009-04-23T07:15:43Z", "is_private": false, "text": "Part of the hope is that with an annoying enough error, someone'll be motivated to get around to fixing the underlying issue...\n\nThere really is something screwy going in which needs to be fixed, and hiding the error is just papering over the cracks :("}, {"count": 8, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "id": 147451, "time": "2011-06-24T10:41:58Z", "bug_id": 46443, "creation_time": "2011-06-24T10:41:58Z", "is_private": false, "text": "Can you attach the problematic document? Without it we can't do much to figure out what's wrong.\n\nYegor"}, {"count": 9, "tags": [], "bug_id": 46443, "text": "No update for a long time and there is not much we can do without a sample document, therefore closing this as WONTFIX for now, please reopen with a sample document if this is still an issue with a recent version of POI.", "id": 191614, "attachment_id": null, "creator": "dominik.stadler@gmx.at", "creation_time": "2016-06-13T19:21:06Z", "time": "2016-06-13T19:21:06Z", "is_private": false}]