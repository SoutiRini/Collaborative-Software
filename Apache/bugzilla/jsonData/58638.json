[{"count": 0, "tags": [], "bug_id": 58638, "attachment_id": null, "text": "I have an async servlet annotated like this:\n\n@WebServlet(name = \"streaming\", urlPatterns = {\"/streaming/*\"})\n\nAnd I'm trying to add CORS filter to it. Since it's third-party (I tried the one bundled with tomcat, as well as a couple external filters), I have to add it using web.xml:\n\n    <filter>\n        <filter-name>CorsFilter</filter-name>\n        <filter-class>org.apache.catalina.filters.CorsFilter</filter-class>\n        <async-supported>true</async-supported>\n    </filter>\n\n    <filter-mapping>\n        <filter-name>CorsFilter</filter-name>\n        <url-pattern>/*</url-pattern>\n    </filter-mapping>\n\nBut when I run this, I get the following exception:\n\n23-Nov-2015 13:24:02.072 SEVERE [http-nio-8080-exec-2] org.apache.catalina.core.StandardWrapperValve.invoke Servlet.service() for servlet [streaming] in context with path [/tuareg_1] threw exception\n java.lang.IllegalStateException: A filter or servlet of the current chain does not support asynchronous operations.\n\tat org.apache.catalina.connector.Request.startAsync(Request.java:1611)\n\tat org.apache.catalina.connector.Request.startAsync(Request.java:1604)\n\tat org.apache.catalina.connector.RequestFacade.startAsync(RequestFacade.java:1030)\n\tat ...\n\n(N.B. The startAsync call is from the same thread, so this is not the problem)\n\nI moved the servlet registration in the web.xml file (and removed the annotation) and the whole thing worked.\n\nI think that maybe tomcat doesn't merge the configration from web.xml and annotations properly.", "id": 186498, "time": "2015-11-23T11:37:26Z", "creator": "ivan@toshkov.org", "creation_time": "2015-11-23T11:37:26Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 58638, "attachment_id": null, "id": 186499, "time": "2015-11-23T11:56:31Z", "creator": "markt@apache.org", "creation_time": "2015-11-23T11:56:31Z", "is_private": false, "text": "Your annotation doesn't specify that async is supported.\n\nIf required, further assistance is available from the users' mailing list."}, {"count": 2, "tags": [], "creator": "ivan@toshkov.org", "attachment_id": null, "text": "Thank for the quick find and sorry for the noise. I accidentally removed the flag from the annotation during a \"minor\" refactoring.", "id": 186500, "time": "2015-11-23T12:27:23Z", "bug_id": 58638, "creation_time": "2015-11-23T12:27:23Z", "is_private": false}]