[{"count": 0, "tags": [], "bug_id": 9745, "text": "We have seen an interesting bug here having to do with external cache \nmanagement in conditionally static pages.  The bug scenario, seen in a jsp,\nis as follows:\n\n1) Have conditional forward to a non-xsl, static file (html in this case).\n\n2) Otherwise have xsl transform.\n\n3) User goes through some scenario that goes first by xsl, then by\n   non-xsl.\n\n4) Fetch the jsp by GET.\n\nIn this case, the browser cache will be primed with the result of the XSL\ngeneration.  Then, when it goes through the static page case, it will observe\nthat the page is unchanged and send a 304 Unmodified reply to the browser.\nThe browser, in turn, will use the version of the file that it last saw.\n\nOops!\n\nThis bug has been verified to exist under 4.0.3 and 4.0.4b.\n\nCode that reproduces this scenario is included with this message in a \n.tar.gz file intended to be extracted in a webapps directory as an\napplication directory named 'bugreport.  You can run the code by going\nto: \n\n  http://localhost/bugreport/\n\nWhen you hit the button labeled 'Do The Bug,' you will be taken\nthrough a jsp case that sends it to an alternate file, unseen.html,\nbut you will never see that file because you will stick with the\ntest.xsl that was first displayed, that contains that button.  Oops!\n\nThere are some embedded debugging printlns that show which way the jsp\ndecision branch is going, and why.\n\nThank you for looking at this report, and indeed for all your work on\nTomcat, which make projects like ours possible.", "id": 17491, "time": "2002-06-10T13:57:56Z", "creator": "jonkay@isgenesis.com", "creation_time": "2002-06-10T13:57:56Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "jonkay@isgenesis.com", "text": "Created attachment 2045\n.tar.gz of webapps 'bugreport' subdir that repros bug", "id": 17492, "time": "2002-06-10T14:04:02Z", "bug_id": 9745, "creation_time": "2002-06-10T14:04:02Z", "is_private": false, "attachment_id": 2045}, {"count": 2, "tags": [], "bug_id": 9745, "attachment_id": null, "id": 17544, "time": "2002-06-11T00:40:57Z", "creator": "remm@apache.org", "creation_time": "2002-06-11T00:40:57Z", "is_private": false, "text": "You should disable the cache in that particular situation. It has to be seen if\nthe cache can be improved while not killing performance at the same time (since\nJNDI is used to access the actual file, doing a lookup for the attributes is\nvery expensive).\n\nExample:\n<Context path=\"\"  docBase=\"nowbooks/ROOT\" debug=\"0\">\n  <Resources className=\"org.apache.naming.resources.FileDirContext\" \ndocBase=\"nowbooks/ROOT\" cached=\"false\"/>\n</Context>"}, {"count": 3, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "is_private": false, "id": 142741, "time": "2010-12-15T10:46:41Z", "bug_id": 9745, "creation_time": "2010-12-15T10:46:41Z", "text": "This has been fixed for some time in 7.0.x and 6.0.x (and I suspect 5.5.x as well)"}]