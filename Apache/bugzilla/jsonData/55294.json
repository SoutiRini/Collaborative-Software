[{"count": 0, "attachment_id": null, "creator": "vladk.dev@gmail.com", "text": "The OOXML spec leaves some fields optional and doesn't define what should happen if, for instance \"width\" attribute is not set on a \"col\" element.\n\nThe MS Excel 2010 never leaves the \"width\" attribute unset, the POI does it. As result the XLSX files created with POI can look corrupted when opened with MX Excel 2010.\n\nI have created a patch to make POI behaves more like MS Excel and written several unit tests to verify it. The changes could be summarized as follows:\n- never leave the \"width\" attribute unset\n- never let a column being defined by more than one \"col\" element\n\nIn other words, avoid configuration like follows:\n<cols>\n       <col min=\"3\" max=\"3\" width=\"20.0\" customWidth=\"true\" collapsed=\"false\" outlineLevel=\"1\" />\n       <col min=\"3\" max=\"5\" collapsed=\"false\" outlineLevel=\"1\" />\n</cols>\nInstead create something like this:\n<cols>\n       <col min=\"3\" max=\"3\" width=\"20.0\" customWidth=\"true\" collapsed=\"false\" outlineLevel=\"1\" />\n       <col min=\"4\" max=\"5\" width=\"8.0\" collapsed=\"false\" outlineLevel=\"1\" />\n</cols>\n\nI have decided to created a separate test class TestXSSFColGrouping instead of adding test methods to the TestXSSFSheet near to the testSetColumnGroupCollapsed() method, because my tests can save generated XLSX files on a disk if a system property \"poi.test.xssf.output.dir\" is set. It helps to verify the files interpreted as expected in MS Excel. Furthermore the tests log CTCols content via private instance of the POILogger.", "id": 168720, "time": "2013-07-22T21:52:20Z", "bug_id": 55294, "creation_time": "2013-07-22T21:52:20Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 55294, "text": "Created attachment 30613\nPatch with unit tests", "id": 168721, "time": "2013-07-22T21:54:24Z", "creator": "vladk.dev@gmail.com", "creation_time": "2013-07-22T21:54:24Z", "is_private": false, "attachment_id": 30613}, {"count": 2, "attachment_id": null, "creator": "vladk.dev@gmail.com", "is_private": false, "id": 168722, "time": "2013-07-22T21:55:45Z", "bug_id": 55294, "creation_time": "2013-07-22T21:55:45Z", "tags": [], "text": "The proposed patch should also resolve https://issues.apache.org/bugzilla/show_bug.cgi?id=52186."}, {"count": 3, "tags": [], "bug_id": 55294, "text": "Vlad,\n  I should have time in the next few days to review and commit unless another committer wants to take this sooner.  Thank you for subitting this!", "id": 168818, "time": "2013-07-26T14:34:54Z", "creator": "tallison@mitre.org", "creation_time": "2013-07-26T14:34:54Z", "is_private": false, "attachment_id": null}, {"count": 4, "attachment_id": null, "creator": "tallison@mitre.org", "text": "Committed r1510587.  Thank you, Vlad!", "id": 169135, "time": "2013-08-05T16:17:58Z", "bug_id": 55294, "creation_time": "2013-08-05T16:17:58Z", "tags": [], "is_private": false}]