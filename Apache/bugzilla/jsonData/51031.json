[{"text": "Created attachment 26861\nSample Excel File\n\nMy client requirement is  to upload an Excel File (which is generated from another system). To upload this generated Excel File, I am using Apache POI api. The following jar files are in the classpath of my application.\n\ndom4j-1.6.1\nooxml-schemas-1.0\npoi-3.5-FINAL\npoi-ooxml-3.5-FINAL\nxmlbeans-2.3.0\nopenxml4j-1.0-beta.jar\n\nI am getting the following exception(using Apache POI3.5)\n\nException in thread \"main\" java.lang.IllegalArgumentException: Your InputStream was neither an OLE2 stream, nor an OOXML stream\n        at org.apache.poi.ss.usermodel.WorkbookFactory.create(WorkbookFactory.java:65)\n        at PoiExcelRead.main(PoiExcelRead.java:22)\n\n\nwhen my code is\n\n17    public static void main(String[] args) throws IOException, InvalidFormatException {\n18 // TODO Auto-generated method stub\n19\n20 String xlsPath = \"d://BOM70914831.xls\";\n21 InputStream myxls = new FileInputStream(xlsPath);\n22 Workbook workBook = WorkbookFactory.create(myxls);\n23    }\n\n\n\nand I am getting the following exception(using Apache POI3.0)\n\nException in thread \"main\" java.io.IOException: Invalid header signature; read 0x6D78206C6D74683C, expected 0xE11AB1A1E011CFD0\n        at org.apache.poi.poifs.storage.HeaderBlockReader.<init>(HeaderBlockReader.java:120)\n        at org.apache.poi.poifs.filesystem.POIFSFileSystem.<init>(POIFSFileSystem.java:151)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:317)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:298)\n        at PoiExcelRead.main(PoiExcelRead.java:22)\n\nwhen my code is\n17    public static void main(String[] args) throws IOException {\n18 // TODO Auto-generated method stub\n19\n20 String xlsPath = \"d://BOM70914831.xls\";\n21 InputStream myxls = new FileInputStream(xlsPath);\n22 HSSFWorkbook wb     = new HSSFWorkbook(myxls);\n23    }\n\n\nPlease find the sample excel file(BOM70914831.xls) to check my issue as an attachment.\n\nNote: It is working when I open the file using Microsoft Excel and saving it as another file(using File>Save As option from Microsoft Excel Menu)", "tags": [], "bug_id": 51031, "is_private": false, "count": 0, "id": 145581, "time": "2011-04-06T07:47:16Z", "creator": "ramullangi@yahoo.com", "creation_time": "2011-04-06T07:47:16Z", "attachment_id": 26861}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "is_private": false, "id": 145582, "attachment_id": null, "bug_id": 51031, "creation_time": "2011-04-06T07:52:06Z", "time": "2011-04-06T07:52:06Z", "text": "The clue's in the exception message - your file is neither a .xls file nor a\n.xlsx one. If you open it in a text editor, you'll see that instead it's\nHTML!"}, {"count": 2, "tags": [], "creator": "ramullangi@yahoo.com", "attachment_id": null, "text": "(In reply to comment #1)\n> The clue's in the exception message - your file is neither a .xls file nor a\n> .xlsx one. If you open it in a text editor, you'll see that instead it's\n> HTML!\n\nNick Burch,\n\nThanks for your reply. Can you please suggest any other solution.\n\nRgds,\nRam", "id": 145583, "time": "2011-04-06T08:01:08Z", "bug_id": 51031, "creation_time": "2011-04-06T08:01:08Z", "is_private": false}]