[{"count": 0, "attachment_id": null, "creator": "xujingcheng2016@gmail.com", "is_private": false, "id": 200989, "time": "2017-09-20T07:09:02Z", "bug_id": 61543, "creation_time": "2017-09-20T07:09:02Z", "tags": [], "text": "I am facing a issue when try to remove a XSSF Table after creating one.\n \nHere is my test case with manual print out result.\n \n    Create 3 tables on a single sheet.\n \n     [java] Create Table Name: /xl/tables/table1.xml - Content Type: application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\n     [java] Create Table Name: /xl/tables/table2.xml - Content Type: application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\n     [java] Create Table Name: /xl/tables/table3.xml - Content Type: application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\n \nDelete table2\n \n    [java] Tables before deletion Name: /xl/tables/table1.xml - Content Type: application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\n     [java] Tables before deletion Name: /xl/tables/table2.xml - Content Type: application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\n     [java] Tables before deletion Name: /xl/tables/table3.xml - Content Type: application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\n \n     [java] Tables after deletion Name: /xl/tables/table1.xml - Content Type: application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\n     [java] Tables after deletion Name: /xl/tables/table3.xml - Content Type: application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\n \nCreate a new table table and it throws exception as below\norg.apache.poi.openxml4j.exceptions.PartAlreadyExistsException: A part with the name '/xl/tables/table3.xml' already exists : Packages shall not contain equivalent part names and package implementers shall neither create nor recognize packages with equivalent part names. [M1.12]\n \nLooks like it tries to re-use table3.xml which already exists.\n \nWhen I look into the code, this line.\nXSSFSheet line 3971\nint tableNumber = getPackagePart().getPackage().getPartsByContentType(XSSFRelation.TABLE.getContentType()).size() + 1;"}, {"count": 1, "attachment_id": null, "creator": "dominik.stadler@gmx.at", "is_private": false, "id": 201191, "time": "2017-09-28T12:55:47Z", "bug_id": 61543, "creation_time": "2017-09-28T12:55:47Z", "tags": [], "text": "Please state which exact version of POI you are using and please try to put your steps into a self-sufficient unit-test so we can actually try to reproduce the problem on our end."}, {"count": 2, "tags": [], "creator": "dominik.stadler@gmx.at", "is_private": false, "id": 202963, "attachment_id": null, "bug_id": 61543, "creation_time": "2017-12-30T15:52:14Z", "time": "2017-12-30T15:52:14Z", "text": "Seems to be related to bug 57165 where we fixed this for sheets in workbooks. Probably a similar fix is necessary here to not always use \"size()-1\" as id for new table-parts"}, {"count": 3, "attachment_id": null, "creator": "dominik.stadler@gmx.at", "is_private": false, "id": 202994, "time": "2018-01-01T14:55:03Z", "bug_id": 61543, "creation_time": "2018-01-01T14:55:03Z", "tags": [], "text": "Should be fixed via r1819773."}]