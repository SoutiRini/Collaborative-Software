[{"count": 0, "tags": [], "creator": "bugzilla@c-est-simple.com", "attachment_id": null, "is_private": false, "id": 33039, "time": "2003-03-12T15:19:31Z", "bug_id": 17918, "creation_time": "2003-03-12T15:19:31Z", "text": "The api method 'ap_escape_path_segment' does not URL-encode the '&' character.\nThis means that if you use it in a custom apache module, you will not be able \nto correctly encode an URL that contains parameter-value pairs separated \nwith '&'. The '&' will be left unchanged, and passing this URL as a value of a \nparameter of another URL will lead to mistakingly take this unchanged '&' for a \nparameter-name separator of the new URL.\n\nRFC 1738 says that ';', '/', '?' are reserved characters in the path and search \ncomponents of an HTTP URL, but the BNF shows '&' as well.\nIt looks like the correct parameter-value separator should be ';' but we all \nknow it's almost never the case (I think the CGI perl modules handles it, \nthough).\n\nThe correction of this problem is rather simple:\nin src/main/gen_test_char.c\nreplace (line 61 in 1.3.27 Solaris):\n        if (!ap_isalnum(c) && !strchr(\"$-_.+!*'(),:@&=~\", c)) {\nwith\n        if (!ap_isalnum(c) && !strchr(\"$-_.+!*'(),:@=~\", c)) {\nand start the full compilation all over again.\n\nThe \"test_char.h\" generator (gen_test_char) will be modified, a new\ntest_char.h generated, and used in util.c with the needed values to have '&' \nurl-encoded by 'ap_escape_path_segment' \n\nThe 'ap_escape_path_segment' documentation, while short, says it is not used by \napache. Witch is probably why this was not an issue until now..."}, {"count": 1, "tags": [], "bug_id": 17918, "attachment_id": 5289, "id": 33040, "time": "2003-03-12T15:24:48Z", "creator": "bugzilla@c-est-simple.com", "creation_time": "2003-03-12T15:24:48Z", "is_private": false, "text": "Created attachment 5289\nthe modification as proposed in the bug description"}, {"count": 2, "tags": [], "bug_id": 17918, "is_private": false, "text": "enabling the PatchAvailable keyword\nupdated doc on submitting patches is at http://httpd.apache.org/dev/patches.html\n", "id": 47898, "time": "2003-11-21T22:44:53Z", "creator": "trawick@apache.org", "creation_time": "2003-11-21T22:44:53Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 17918, "is_private": false, "text": "According to RFC 2616 which refers explicitly to RFC 2396, the & is not a\nreserved character within path segments. See RFC 2396, section 3.3.", "id": 47904, "time": "2003-11-21T23:13:09Z", "creator": "nd@perlig.de", "creation_time": "2003-11-21T23:13:09Z", "attachment_id": null}]