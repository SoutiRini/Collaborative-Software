[{"attachment_id": null, "tags": [], "bug_id": 33885, "text": "I'm seeing the following unexpected behavior on Tomcat 5.5.7:\n\n(1) Place a context configuration file in \nCATALINA_HOME/conf/Catalina/localhost/myapp.xml with a mistyped docBase \nattribute (so as to be point to a non-existent directory under the app base).\n\n(2) Startup and then shutdown Tomcat; Tomcat seems to delete both the \nconfiguration file and the entire corresponding exploded web app directory \nCATALINA_HOME/webapps/myapp\n\nThis deletion seems to be new behavior with 5.5.7.  Tomcat 5.5.4 exhibits a \nhanging problem on startup in the same circumstances, but doesn't delete \neverything when stopped.  Tomcat 5.0.28 exhibited neither of these.\n\nIs this deletion now expected behavior or is it a bug?  If it is expected, is \nthere any way to disable it?\n\nI am seeing this on Tomcat 5.5.7 with default configuration over JDK 1.5.0_01 \non Win XP", "count": 0, "id": 71933, "time": "2005-03-07T23:28:38Z", "creator": "anil@busybuddha.org", "creation_time": "2005-03-07T23:28:38Z", "is_private": false}, {"count": 1, "tags": [], "creator": "anil@busybuddha.org", "attachment_id": 14422, "id": 71934, "time": "2005-03-07T23:31:47Z", "bug_id": 33885, "creation_time": "2005-03-07T23:31:47Z", "is_private": false, "text": "Created attachment 14422\nTest case context xml file.\n\nDrop this context xml file into the CATALINA_HOME/conf/Catalina/localhost dir."}, {"count": 2, "tags": [], "creator": "anil@busybuddha.org", "attachment_id": 14423, "id": 71935, "time": "2005-03-07T23:34:33Z", "bug_id": 33885, "creation_time": "2005-03-07T23:34:33Z", "is_private": false, "text": "Created attachment 14423\nTest caes index.html file.  Any file will do.\n\nCreate directory CATALINA_HOME/webapps/myapp/\nand place this index.html file there.\n\nAnything here will work for the test case."}, {"count": 3, "text": "I am starting the server, then waiting about 10 seconds, and then stopping the \nserver via a CTRL-C in the console window.\n", "bug_id": 33885, "attachment_id": null, "id": 71936, "time": "2005-03-07T23:37:12Z", "creator": "anil@busybuddha.org", "creation_time": "2005-03-07T23:37:12Z", "tags": [], "is_private": false}, {"count": 4, "text": "1) No docBase in your myapp.xml (BTW, yours is wrong in the xml file)\n2) No path in your myapp.xml\n\nAnd, no, it won't actually delete your content (with or without the bad\ndocBase), so the report is wrong. Note that I am testing with the current CVS code.", "bug_id": 33885, "attachment_id": null, "id": 71937, "time": "2005-03-07T23:48:26Z", "creator": "remm@apache.org", "creation_time": "2005-03-07T23:48:26Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "bug_id": 33885, "text": "Huh?  The context file attached does include a path attribute and it does \ninclude a docBase *intentionally* misspelled.  That is needed to trigger the \nbug.\n\nI can reproduce it consistently on my installation with Tomcat 5.5.7.\n\n", "id": 71938, "time": "2005-03-07T23:53:09Z", "creator": "anil@busybuddha.org", "creation_time": "2005-03-07T23:53:09Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 33885, "attachment_id": null, "id": 71940, "time": "2005-03-08T01:52:35Z", "creator": "remm@apache.org", "creation_time": "2005-03-08T01:52:35Z", "is_private": false, "text": "Ok, I'll try again.\n\n1) Don't put any docBase in your myapp.xml (BTW, yours is wrong in the xml file)\n2) Don't put any path in your myapp.xml\n\nAnd, no, it won't actually delete your content (with or without the bad\ndocBase), so the report is wrong. Note that I am testing with the current CVS code.\n\nPlease do not reopen the report, or I will close it without further comments."}, {"count": 7, "tags": [], "bug_id": 33885, "attachment_id": null, "id": 72645, "time": "2005-03-17T20:04:42Z", "creator": "anil@busybuddha.org", "creation_time": "2005-03-17T20:04:42Z", "is_private": false, "text": "This bug is present in Tomcat 5.5.7 but is no longer present in the current \ncvs HEAD.   \n\nThe following stacktrace was captured during deletion of the test case app \nsupplied using Tomcat 5.5.7:\n        at org.apache.catalina.startup.ExpandWar.delete(ExpandWar.java:267)\n        at org.apache.catalina.startup.HostConfig.checkResources\n(HostConfig.java:1024)\n        at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1166)\n        at org.apache.catalina.startup.HostConfig.lifecycleEvent\n(HostConfig.java:292)\n        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent\n(LifecycleSupport.java:119)\n        at org.apache.catalina.core.ContainerBase.backgroundProcess\n(ContainerBase.java:1301)\n        at \norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChil\ndren(ContainerBase.java:1561)\n        at \norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChil\ndren(ContainerBase.java:1570)\n        at \norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run\n(ContainerBase.java:1550)\n        at java.lang.Thread.run(Thread.java:595)\n\nThis bug appears to have been fixed along with the fix for Bug 33572\nin revision 1.55 of jakarta-tomcat-\ncatalina/catalina/src/share/org/apache/catalina/startup/HostConfig.java\n\n[See comments 5 and 6 on that Bug 33572 as well.]\n\nThe fix should appear in release 5.5.8 (if it goes out) and later.\n\n"}]