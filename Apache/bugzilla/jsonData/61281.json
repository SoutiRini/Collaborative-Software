[{"count": 0, "tags": [], "bug_id": 61281, "attachment_id": null, "text": "When attempting to Export the XML of attached xlsx, there occurs following exception:\njava.lang.IndexOutOfBoundsException: Index: 1, Size: 1\n\tat java.util.ArrayList.rangeCheck(Unknown Source)\n\tat java.util.ArrayList.get(Unknown Source)\n\tat org.apache.poi.xssf.extractor.XSSFExportToXml.exportToXML(XSSFExportToXml.java:203)\n\tat org.apache.poi.xssf.extractor.XSSFExportToXml.exportToXML(XSSFExportToXml.java:109)\n\nThe reason is, that one column of the table isn't mapped. When I do the export from Excel, it works. There is a different handling between Excel and Apache POI.\nThe code for exporting the XML is as following:\n\n XSSFWorkbook wb = /*given from previous code execution*/;\n       for (XSSFMap map : wb.getCustomXMLMappings()) {\n           XSSFExportToXml exporter = new XSSFExportToXml(map);\n\n           ByteArrayOutputStream os = new ByteArrayOutputStream();\n           exporter.exportToXML(os, true);\n       }", "id": 199715, "time": "2017-07-11T11:17:11Z", "creator": "misc.daniel@stucki.me", "creation_time": "2017-07-11T11:17:11Z", "is_private": false}, {"count": 1, "tags": [], "creator": "misc.daniel@stucki.me", "text": "Created attachment 35119\n[PATCH] proposed patch including testcase", "id": 199716, "time": "2017-07-11T11:21:52Z", "bug_id": 61281, "creation_time": "2017-07-11T11:21:52Z", "is_private": false, "attachment_id": 35119}, {"count": 2, "tags": [], "bug_id": 61281, "attachment_id": 35119, "text": "Comment on attachment 35119\n[PATCH] proposed patch including testcase\n\nMark patch as obsolete, as the solution is not complete", "id": 199718, "time": "2017-07-11T11:58:45Z", "creator": "misc.daniel@stucki.me", "creation_time": "2017-07-11T11:58:45Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 61281, "attachment_id": 35120, "text": "Created attachment 35120\nxlsx which ends up in a IndexOutOfBoundsException", "id": 199721, "time": "2017-07-11T12:18:17Z", "creator": "misc.daniel@stucki.me", "creation_time": "2017-07-11T12:18:17Z", "is_private": false}, {"count": 4, "attachment_id": null, "bug_id": 61281, "text": "added guard in https://svn.apache.org/viewvc?view=revision&revision=1801634", "id": 199728, "time": "2017-07-11T16:39:32Z", "creator": "fanningpj@yahoo.com", "creation_time": "2017-07-11T16:39:32Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "creator": "misc.daniel@stucki.me", "text": "Thanks for your fast fix. unfortunately, it just gets rid of the exception, but doesn't provide the same behaviour as the export in Excel does. ==> Reopen\n\nPlease see attached patch that has a testcase illustrating the Problem and a proposed fix.", "id": 199735, "time": "2017-07-12T09:20:42Z", "bug_id": 61281, "creation_time": "2017-07-12T09:20:42Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 61281, "attachment_id": 35122, "text": "Created attachment 35122\nProposed fix that provides same behaviour as excel", "id": 199736, "time": "2017-07-12T09:21:55Z", "creator": "misc.daniel@stucki.me", "creation_time": "2017-07-12T09:21:55Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 61281, "attachment_id": null, "text": "Hi Daniel - any chance you could do a Github Pull Request? https://github.com/apache/poi", "id": 199737, "time": "2017-07-12T10:09:22Z", "creator": "fanningpj@yahoo.com", "creation_time": "2017-07-12T10:09:22Z", "is_private": false}, {"count": 8, "tags": [], "creator": "fanningpj@yahoo.com", "attachment_id": null, "id": 199739, "time": "2017-07-12T10:54:37Z", "bug_id": 61281, "creation_time": "2017-07-12T10:54:37Z", "is_private": false, "text": "Latest patch applied using https://svn.apache.org/viewvc?view=revision&revision=1801721"}]