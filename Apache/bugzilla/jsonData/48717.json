[{"count": 0, "tags": [], "bug_id": 48717, "attachment_id": null, "text": "This appears to be a regression from an earlier bug #35916 which describes the exact same problem, but somewhere along the way, it appears that the bug has come back.\n\nBasically, once Tomcat is put in to a cluster and a node joins the cluster, the webapp isn't notified via either HttpSessionActivationListener.didActivate or HttpSessionListener.sessionCreated.\n\nOtherwise, all nodes seem to receive these events as expected once in the cluster.\n\nThis is a problem for an application which needs to track all currently active sessions as it will not know of any existing sessions when joining a cluster.\n\nThis also appears to affect Tomcat 6.0.24 as well where the symptoms are the same.\n\nI actually posted to the users list almost a year ago (totally forgot I did that until I was searching the archives again), but didn't hear any response and worked around the issue temporarily, but it has come up again so I posted to the list again, but no response either time.\n\nhttp://www.mail-archive.com/users@tomcat.apache.org/msg58675.html\nhttp://www.mail-archive.com/users@tomcat.apache.org/msg73135.html", "id": 134377, "time": "2010-02-09T17:43:14Z", "creator": "drees76@gmail.com", "creation_time": "2010-02-09T17:43:14Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 48717, "attachment_id": null, "text": "Confirmed and fixed in trunk for 7.0.x\n\nI have proposed the same fix for 6.0.x and 5.5.x", "id": 135728, "time": "2010-03-28T19:42:34Z", "creator": "markt@apache.org", "creation_time": "2010-03-28T19:42:34Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 48717, "attachment_id": null, "text": "This has been fixed in 6.0.x and will be included in 6.0.27 onwards.", "id": 136674, "time": "2010-05-05T17:54:37Z", "creator": "markt@apache.org", "creation_time": "2010-05-05T17:54:37Z", "is_private": false}, {"count": 3, "tags": [], "creator": "drees76@gmail.com", "attachment_id": null, "id": 136675, "time": "2010-05-05T18:01:33Z", "bug_id": 48717, "creation_time": "2010-05-05T18:01:33Z", "is_private": false, "text": "Is there any chance you'll also be backporting to 5.5.x as well?\n\nAppreciate the updates..."}, {"count": 4, "tags": [], "bug_id": 48717, "attachment_id": null, "text": "As per comment #1, it has been proposed for 5.5.x. When it gets enough votes, it will be committed.", "id": 136676, "time": "2010-05-05T18:05:34Z", "creator": "markt@apache.org", "creation_time": "2010-05-05T18:05:34Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 48717, "attachment_id": null, "text": "This has been fixed in 5.5.x and will be included in 5.5.30 onwards.", "id": 136935, "time": "2010-05-18T13:17:12Z", "creator": "markt@apache.org", "creation_time": "2010-05-18T13:17:12Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 48717, "text": "I never got a chance to test that this was fixed until now, but testing on 5.5.32 still does not appear to work.\n\nHow I'm testing:\n\nTwo Linux systems running Tomcat 5.5.32 with a Cluster defined in the Host section like this:\n\n<Cluster className=\"org.apache.catalina.cluster.tcp.SimpleTcpCluster\" receiver.sendAck=\"false\" sender.waitForAck=\"false\" sender.doTransmitterProcessingStats=\"true\" sender.queueDoStats=\"true\" sender.queueTimeWait=\"true\">\n<Valve className=\"org.apache.catalina.cluster.tcp.ReplicationValve\" filter=\".*\\.gif;.*\\.js;.*\\.jpg;.*\\.png;.*\\.htm;.*\\.html;.*\\.css;.*\\.txt;\"/>\n<Valve className=\"org.apache.catalina.cluster.session.JvmRouteBinderValve\" enabled=\"true\"/>\n<ClusterListener className=\"org.apache.catalina.cluster.session.ClusterSessionListener\"/>\n<ClusterListener className=\"org.apache.catalina.cluster.session.JvmRouteSessionIDBinderListener\"/>\n</Cluster>\n\nThe application has a <listener><listener-class> defined in the web.xml which implements ServletContextListener and HttpSessionListener.  The HttpSessionListener methods work fine on each node.\n\nThe application adds an attribute to a session which implements HttpSessionActivationListener, HttpSessionBindingListener and Serializable.  The HttpSessionBindingListener methods work fine on each node.\n\nWhen restarting a node, the session attribute never receives any calls to sessionDidActivate when that node comes back online.\n\nLet me know if you need any more details.", "id": 144119, "time": "2011-02-09T19:29:32Z", "creator": "drees76@gmail.com", "creation_time": "2011-02-09T19:29:32Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "creator": "markt@apache.org", "attachment_id": 26679, "id": 144400, "time": "2011-02-18T06:45:45Z", "bug_id": 48717, "creation_time": "2011-02-18T06:45:45Z", "is_private": false, "text": "Created attachment 26679\nAdds sessionDidActivate calss\n\nThe previous fix handled session creation/destruction but not activation"}, {"count": 8, "tags": [], "creator": "drees76@gmail.com", "attachment_id": null, "id": 144530, "time": "2011-02-24T17:48:44Z", "bug_id": 48717, "creation_time": "2011-02-24T17:48:44Z", "is_private": false, "text": "Thanks - so I guess to test this I'd have to apply the patch to Tomcat source and build it myself?"}, {"count": 9, "tags": [], "bug_id": 48717, "text": "'fraid so.", "id": 144531, "attachment_id": null, "creator": "markt@apache.org", "creation_time": "2011-02-24T17:52:52Z", "time": "2011-02-24T17:52:52Z", "is_private": false}, {"count": 10, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 148638, "time": "2011-08-16T12:44:45Z", "bug_id": 48717, "creation_time": "2011-08-16T12:44:45Z", "is_private": false, "text": "This has been fixed in 5.5.x and will be included in 5.5.34 onwards."}]