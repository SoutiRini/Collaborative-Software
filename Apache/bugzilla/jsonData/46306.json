[{"count": 0, "tags": [], "bug_id": 46306, "text": "We have a URL with two versions, and older one and a newer one.\n\nThe older one had these attributes:\n\nContent-Length: 2558\nETag: \"1ee799-9fe-49158c39\"\nLast-Modified: Sat, 08 Nov 2008 12:55:21 GMT\n\nIt was then edited and now has these attributes:\n\nLast-Modified: Sat, 08 Nov 2008 13:48:57 GMT\nETag: \"1ee799-bb7-491598c9\"\nContent-Length: 2999\n\nWe have a buggy caching client that is sending the following conditionals on a refresh request:\n\nIf-Modified-Since: Sat, 08 Nov 2008 12:55:21 GMT\nIf-None-Match: \"1ee799-bb7-491598c9\"\n\n(The IMS is from the older one, but the INM is from the newer one.)\n\nApache returns a 304 response to this request.\n\nThis seems wrong, since RFC 2616 13.3.4 states, \"An HTTP/1.1 origin server, upon receiving a conditional request that includes both a Last-Modified date (e.g., in an If-Modified-Since or If-Unmodified-Since header field) and one or more entity tags (e.g., in an If-Match, If-None-Match, or If-Range header field) as cache validators, MUST NOT return a response status of 304 (Not Modified) unless doing so is consistent with all of the conditional header fields in the request.\" \n\nThe correct behavior would be to return a 200 response with the content, since the IMS conditional header is not consistent.\n\nThe content in this case is a static HTML file, but the problem has been observed with various other content types as well.", "id": 122899, "time": "2008-11-27T12:12:15Z", "creator": "apache@wheelhouse.org", "creation_time": "2008-11-27T12:12:15Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "mss@apache.org", "text": "This is fixed both in v2.3 and v2.2:\n\n$ for s in www.apache.org msquadrat.de; do\n  url=http://$s/robots.txt\n  lwp-request -USed -m GET \\\n    -H \"If-Modified-Since: Sat, 08 Nov 2000 00:00:00 GMT\" \\\n    -H \"If-None-Match: $(lwp-request -m HEAD \"$url\" | \\\n      sed -ne '/^ETag:/{s/^[^:]*: //;p}')\" \\\n    \"$url\"\ndone\nHEAD http://www.apache.org/robots.txt\nIf-Modified-Since: Sat, 08 Nov 2000 00:00:00 GMT\nIf-None-Match: \"d20a95-2f-494031bea5f40\"\nUser-Agent: lwp-request/5.834 libwww-perl/5.836\n\nHEAD http://www.apache.org/robots.txt --> 200 OK\nCache-Control: max-age=3600\nConnection: close\nDate: Mon, 21 Mar 2011 16:18:06 GMT\nAccept-Ranges: bytes\nETag: \"d20a95-2f-494031bea5f40\"\nServer: Apache/2.3.8 (Unix) mod_ssl/2.3.8 OpenSSL/1.0.0c\nVary: Accept-Encoding\nContent-Length: 47\nContent-Type: text/plain\nExpires: Mon, 21 Mar 2011 17:18:06 GMT\nLast-Modified: Mon, 01 Nov 2010 19:49:41 GMT\n\nHEAD http://msquadrat.de/robots.txt\nIf-Modified-Since: Sat, 08 Nov 2000 00:00:00 GMT\nIf-None-Match: \"d9-3e26dc70d9240\"\nUser-Agent: lwp-request/5.834 libwww-perl/5.836\n\nHEAD http://msquadrat.de/robots.txt --> 200 OK\nConnection: close\nDate: Mon, 21 Mar 2011 16:18:10 GMT\nAccept-Ranges: bytes\nETag: \"d9-3e26dc70d9240\"\nServer: Apache/2.2.12 (Ubuntu)\nVary: Accept-Encoding\nContent-Length: 217\nContent-Type: text/plain\nLast-Modified: Tue, 24 Aug 2004 22:20:49 GMT\n\n\nApache HTTP Server 1.3.x is not supported anymore and no bugs will be fixed in the old codebase (cf. <http://mail-archives.apache.org/mod_mbox/httpd-announce/201002.mbox/%3C20100203000334.GA19021@infiltrator.stdlib.net%3E>).", "id": 145178, "time": "2011-03-21T12:22:13Z", "bug_id": 46306, "creation_time": "2011-03-21T12:22:13Z", "is_private": false, "attachment_id": null}]