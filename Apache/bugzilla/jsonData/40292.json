[{"count": 0, "tags": [], "text": "Operation system: Debian linux\n\nReproducing steps\n\n1 Create a site config file test in /etc/apache2/sites-available by using \nfollowing command:\necho Listen 1234 > test\n2 Enable site test and reload\n3 Disable site test and reload\nAfter this reloading, apache will use up all memory and finally be killed by \nlinux kernel.\nThere are 2G memory in my server!\n\nThere is another server with the same apache2 version but using apache2-mpm-\nprefork model doesn't have this problem.\n\nThis problem won't happen if I use /etc/init.d/apache2 restart.\n\nThanks.", "attachment_id": null, "bug_id": 40292, "id": 92377, "time": "2006-08-21T20:54:19Z", "creator": "oliver.peng@skywave.com", "creation_time": "2006-08-21T20:54:19Z", "is_private": false}, {"count": 1, "attachment_id": null, "creator": "nick@webthing.com", "text": "If reproducing the bug requires distro-specific steps (such as creating \nentries in a Debian-only directory), then it's a Debian bug, not an Apache \none.  Can you reformulate your steps in terms of standard Apache?  And what do \nyou mean by \"reload\" that differs from restarting?", "id": 92379, "time": "2006-08-21T22:27:57Z", "bug_id": 40292, "creation_time": "2006-08-21T22:27:57Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "oliver.peng@skywave.com", "text": "There is no special configuration in Debian system.\n\nSteps to Reproduce:\n1) Create a site config file test in /etc/apache2/sites-available by using \nfollowing command:\ncd /etc/apache2/sites-available \necho Listen 1234 > test\n\n2) Enable site test and reload\na2ensite test\n/etc/init.d/apache2 reload\n\n3) Disable site test and reload\na2dissite test\n/etc/init.d/apache2 reload\n\nAfter this reloading, apache will begin to use up all memory rapidly and \nfinally be killed by linux kernel.\n\nIt can use up 2G memory in just 5 seconds!\n\nThere is another server with the same apache2 version but using apache2-mpm-\nprefork model doesn't have this problem.\n\nThis problem won't happen if I use \"/etc/init.d/apache2 restart\".\n\nThanks.\n", "id": 92408, "time": "2006-08-22T13:34:13Z", "bug_id": 40292, "creation_time": "2006-08-22T13:34:13Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 40292, "is_private": false, "text": "Your instructions are entirely debian-specific.  Noone else \nhas \"/etc/apache2/sites-available\", \"a2ensite\", or \"a2dissite\", so I can't \nreproduce your steps on gentoo or slackware, for instance.", "id": 92411, "time": "2006-08-22T14:28:33Z", "creator": "nick@webthing.com", "creation_time": "2006-08-22T14:28:33Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "oliver.peng@skywave.com", "attachment_id": null, "id": 92415, "time": "2006-08-22T15:21:20Z", "bug_id": 40292, "creation_time": "2006-08-22T15:21:20Z", "is_private": false, "text": "Sorry I am not familiar gentoo or slackware. So can you give me some idea on \nhow to deploy a site config file with only one line : Listen 1234 in standard \nprocess.\n\n\"/etc/apache2/sites-available\" refer to the directory to put the site config \nfile. There is another directory \"/etc/apache2/sites-enabled\" to put the link \nfiles pointed to the site config files in \"/etc/apache2/sites-available\". Just \nlike the relationship between /etc/rc.5 and /etc/init.d. Only the config file \nwith link file in \"/etc/apache2/sites-enabled\" will be loaded in apache2.\n\n\"a2ensite\" and \"a2dissite\" commands just add or delete the link file \nin \"/etc/apache2/sites-enabled\" directory. For example, \"a2ensite test\" will \nadd a link file in \"/etc/apache2/sites-enabled\" directory pointed to the test \nconfig file test in \"/etc/apache2/sites-available\".\n\nThanks."}, {"count": 5, "tags": [], "bug_id": 40292, "attachment_id": null, "text": "Reload is no command accepted by httpd any longer (As far as I remember it was\none with 1.3, but I am not sure). So please provide the details what\n/etc/init.d/apache2 reload is actually doing, since /etc/init.d/apache2 seems to\nbe a Debian written script.", "id": 92427, "time": "2006-08-22T19:31:10Z", "creator": "rpluem@apache.org", "creation_time": "2006-08-22T19:31:10Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 40292, "is_private": false, "text": "I checked the apache2 script in /etc/init.d and I abstract the reload part \ncode as follow:\n\nENV=\"env -i LANG=C PATH=/usr/local/bin:/usr/bin:/bin\"\n\nAPACHE2CTL=\"$ENV /usr/sbin/apache2ctl\"\n\nlog_begin_msg \"Reloading apache 2.0 configuration...\"\nif $APACHE2CTL graceful $2 ; then\n    log_end_msg 0\nelse\n    log_end_msg 1\nfi\n\nSo finally I think it just do command: \n\n/usr/sbin/apache2ctl graceful\n", "id": 92428, "time": "2006-08-22T19:45:48Z", "creator": "oliver.peng@skywave.com", "creation_time": "2006-08-22T19:45:48Z", "attachment_id": null}, {"count": 7, "tags": [], "creator": "rpluem@apache.org", "text": "Sorry, but I cannot reproduce this with a graceful restart. Do you have any 3rd\nparty modules loaded (like e.g. php)? Often Linux distros deliver patched\nversions of Apache which makes it impossible to find the error. So I would\npropose the following:\n\n1. Report this error to Debian.\n2. Download the sources for 2.0.59 / 2.0.55, compile httpd yourself and check if\nthe problem remains with these self compiled httpd's. If yes please come back\nand we might get a clue what happens.", "id": 92433, "time": "2006-08-22T20:52:49Z", "bug_id": 40292, "creation_time": "2006-08-22T20:52:49Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "creator": "oliver.peng@skywave.com", "attachment_id": null, "id": 92468, "time": "2006-08-23T13:22:46Z", "bug_id": 40292, "creation_time": "2006-08-23T13:22:46Z", "is_private": false, "text": "Thanks for your reply.\n\nI will try to report this problem to Debian and have a try to use source \nversion on Debian."}, {"count": 9, "tags": [], "creator": "sf@sfritsch.de", "attachment_id": null, "id": 111332, "time": "2007-12-02T13:48:32Z", "bug_id": 40292, "creation_time": "2007-12-02T13:48:32Z", "is_private": false, "text": "This was a duplicate of\n\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=37680\n\n*** This bug has been marked as a duplicate of 37680 ***"}]