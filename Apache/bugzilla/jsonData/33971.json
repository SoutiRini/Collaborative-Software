[{"count": 0, "attachment_id": null, "bug_id": 33971, "text": "The problem is that the host names are getting mixed up with each other. It \nseems like a threading problem in Tomcat.\n\nI use resolveHost=true in Tomcat and I get a host but most often not the right \none for the ip, but for another ip that sends a request at almost the same time.\n\nWhen I used the same code in Tomcat 5.0.49 this wasn't a problem.", "id": 72243, "time": "2005-03-11T22:29:50Z", "creator": "susnet@gmail.com", "creation_time": "2005-03-11T22:29:50Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "is_private": false, "id": 72247, "time": "2005-03-11T23:35:14Z", "bug_id": 33971, "creation_time": "2005-03-11T23:35:14Z", "text": "Please provide detailed instructions on how to reproduce this."}, {"count": 2, "tags": [], "bug_id": 33971, "is_private": false, "text": "Created attachment 14467\nserver.xml Tomcat\n\nUsing virtual hosts and AJP1.3.", "id": 72253, "time": "2005-03-12T00:42:21Z", "creator": "susnet@gmail.com", "creation_time": "2005-03-12T00:42:21Z", "attachment_id": 14467}, {"count": 3, "tags": [], "creator": "susnet@gmail.com", "attachment_id": 14468, "is_private": false, "id": 72254, "time": "2005-03-12T00:42:55Z", "bug_id": 33971, "creation_time": "2005-03-12T00:42:55Z", "text": "Created attachment 14468\nworkers.properties"}, {"count": 4, "tags": [], "bug_id": 33971, "is_private": false, "text": "This is what i have in httpd.conf\n\n<VirtualHost *>\nServerName susnet.se\nServerAlias www.susnet.se\nServerAdmin webmaster@susnet.se\nDocumentRoot /usr/tomcat-5/webapps/susnet\nErrorLog /usr/tomcat-5/logs/susnet.se-errorlog\nCustomLog /usr/tomcat-5/logs/susnet.se-customlog combined\njkMount /* ajp13\n</VirtualHost>\n\nIn the code for my application i have \n\nboolean insertOk = stat.insertLogs(id, request.getRemoteAddr(),\n                                             request.getRemoteHost(),\n                                             referer);\n\n public boolean insertLogs(int counterId, String ip, String hostname,\n                         String referer) {\n\n    try {\n      PreparedStatement pstmt = connection.prepareStatement(\n          \"INSERT INTO service.logs VALUES(?, NOW(), ?, ?, ?)\");\n      synchronized (pstmt) {\n        pstmt.clearParameters();\n        pstmt.setInt(1, counterId);\n        pstmt.setString(2, ip);\n        pstmt.setString(3, hostname);\n        pstmt.setString(4, referer);\n        pstmt.executeUpdate();\n      }\n    }\n    catch (Exception e) {\n      System.out.println(\n          \"Error i susnet.se/tjanster statistics.java insertLogs.\");\n          return false;\n    }\n    return true;\n  }\n\nthis is executed in a standard Struts executeLogic. There is no problem with \nanything else and it worked fine when I used Tomcat 5.0.49 and JK2.\n\nTell me if you want some more input!\n\n", "id": 72255, "time": "2005-03-12T00:47:55Z", "creator": "susnet@gmail.com", "creation_time": "2005-03-12T00:47:55Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 33971, "is_private": false, "text": "It was Tomcat 5.0.27 it worked fine in, not 5.0.49. Sorry.", "id": 72256, "time": "2005-03-12T00:51:47Z", "creator": "susnet@gmail.com", "creation_time": "2005-03-12T00:51:47Z", "attachment_id": null}, {"count": 6, "tags": [], "creator": "susnet@gmail.com", "attachment_id": null, "is_private": false, "id": 72257, "time": "2005-03-12T00:54:40Z", "bug_id": 33971, "creation_time": "2005-03-12T00:54:40Z", "text": "Summerized the problem occures with\n\nTomcat 5.5.7\nJK 1.2.8\nApache 2.0.53 (and also 2.0.49)\n"}, {"count": 7, "attachment_id": null, "bug_id": 33971, "text": "It seems that we do have a bug here.\n\nYou can fix your system today by including:\n  HostnameLookups On\nin your httpd.conf.  This is much more efficient anyway if you want host \nnames, since then Apache looks it up and tells Tomcat what it is.\n", "id": 72258, "time": "2005-03-12T01:32:33Z", "creator": "william.barker@wilshire.com", "creation_time": "2005-03-12T01:32:33Z", "tags": [], "is_private": false}, {"count": 8, "tags": [], "bug_id": 33971, "text": "This is fixed now in the CVS, and will appear in 5.5.9.", "id": 72278, "time": "2005-03-12T04:28:24Z", "creator": "william.barker@wilshire.com", "creation_time": "2005-03-12T04:28:24Z", "is_private": false, "attachment_id": null}]