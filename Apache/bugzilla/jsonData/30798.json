[{"count": 0, "tags": [], "bug_id": 30798, "attachment_id": null, "id": 62329, "time": "2004-08-23T09:04:59Z", "creator": "jamie@white-mountain.org", "creation_time": "2004-08-23T09:04:59Z", "is_private": false, "text": "org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner creates the\njunit.framework.Test instance before grabbing System.out and System.err. As a\nresult, anything printed to System.out or System.err in the constructor gets\nthrough.\n\nHere's why this is bad. I'm using the Commons Logging classes. When my log4j\ninstance field is instantiated, it grabs System.out right away, which is before\nJUnitTestRunner.run() is called. So, any log output goes around the Ant JUnit\ntask and right to the console, despite the fact that \"showoutput\" defaults to false.\n\nI can fix this in my own classes by moving the instantiation of the Log into the\nsetUp() method of my test case, but StrutsTestCase also makes the logger at\ninstantiation time, so now all of my test cases print to the same logger and\ntheir output goes to the console anyway. In fact, this is the way that <a\nhref=\"http://jakarta.apache.org/commons/logging/guide.html#Developing%20With%20JCL\">the\ndocumentation for the commons logger says to do things</a>, so I wouldn't be\nsurprised if there are more projects out there that do the same thing. So, I\ndon't think it's reasonable to rely on workarounds. Even so, I've managed to\ncreate a hackish workaround just by making a test case that creates the log in\nits setUp() method, and making sure that's the first test case to be run.\n\nThe fix seems simple, although I haven't tried it yet. Basically, move the code\nthat instantiates the test case in JUnitTestRunner from the constructor into the\npart of run() right before it calls suite.run().\n\nI looked in the CVS for Ant and the code still works this way. However I've only\ntested this with Ant 1.6.2."}, {"count": 1, "tags": [], "text": "*** Bug 30099 has been marked as a duplicate of this bug. ***", "is_private": false, "id": 63968, "creator": "bodewig@apache.org", "time": "2004-09-21T11:49:43Z", "bug_id": 30798, "creation_time": "2004-09-21T11:49:43Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 64695, "time": "2004-10-06T15:04:29Z", "bug_id": 30798, "creation_time": "2004-10-06T15:04:29Z", "is_private": false, "text": "should work with CVS HEAD now, may be merged into Ant 1.6.3 after some more\ntesting."}, {"count": 3, "tags": [], "text": "The bug is still present with Ant 1.6.3b1. Is the fix part of that release?\n\nIf you need to me to do some QA, write a JUnit test case, etc. please let me\nknow. I'm willing to do some work to improve Ant's JUnit task in general but I\ndon't know where to start or if my help is needed.", "is_private": false, "id": 73213, "creator": "jamie@white-mountain.org", "time": "2005-04-03T06:24:22Z", "bug_id": 30798, "creation_time": "2005-04-03T06:24:22Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 30798, "attachment_id": null, "id": 73228, "time": "2005-04-04T09:49:52Z", "creator": "bodewig@apache.org", "creation_time": "2005-04-04T09:49:52Z", "is_private": false, "text": "No, this has not been fixed in the CVS branch that leads to the 1.6.x releases,\nonly in CVS HEAD.\n\nWe expect 1.7 to get released sometime in the (late) summer of this year.\n\nIf you really want to see the fix merged into 1.6.3, the very first thing we need\nis that you confirm it has been fixed using a nightly build of Ant (which comes\nfrom CVS HEAD).  If it is, we can talk about merging ..."}, {"count": 5, "tags": [], "bug_id": 30798, "attachment_id": null, "id": 73321, "time": "2005-04-06T03:09:34Z", "creator": "jamie@white-mountain.org", "creation_time": "2005-04-06T03:09:34Z", "is_private": false, "text": "Verified fixed with the 20050404 nightly build."}, {"count": 6, "tags": [], "bug_id": 30798, "attachment_id": null, "id": 73520, "time": "2005-04-11T12:37:13Z", "creator": "bodewig@apache.org", "creation_time": "2005-04-11T12:37:13Z", "is_private": false, "text": "fix ported to 1.6 branch.\n\nChecking in\nsrc/main/org/apache/tools/ant/taskdefs/optional/junit/JUnitTestRunner.java;\n/home/cvs/ant/src/main/org/apache/tools/ant/taskdefs/optional/junit/JUnitTestRunner.java,v\n <--  JUnitTestRunner.java\nnew revision: 1.42.2.10; previous revision: 1.42.2.9\ndone\n"}]