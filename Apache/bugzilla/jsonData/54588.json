[{"count": 0, "tags": [], "text": "This is something we're seeing in customer data.\n\n    @Test\n    public void testCellFormat() {\n        CellFormat format = CellFormat.getInstance(\"_(*\\\"-\\\"??_);\");\n        // not sure if this assertion is right, but we'll figure that out once\n        // the call completes without throwing an exception...\n        assertThat(format.apply(135.45).text, is(equalTo(\"135.45\")));\n    }\n\nI can't figure out what's specifically wrong with the format but I don't know what this format means, either. If someone figures out what it is, perhaps the bug summary could be made more specific.\n\nPossibly related to Bug 53494, although in the case of that one, I can reproducibly show that it's the locale code causing it. In this case, there is no locale code, but there is other stuff which I don't know what it is.", "is_private": false, "id": 165395, "creator": "trejkaz@trypticon.org", "time": "2013-02-20T00:49:23Z", "bug_id": 54588, "creation_time": "2013-02-20T00:49:23Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "is_private": false, "id": 165400, "time": "2013-02-20T12:04:48Z", "bug_id": 54588, "creation_time": "2013-02-20T12:04:48Z", "text": "Could you please let us know what the format string shows as in Excel? With backslashes and quotes in your test, it's hard to be sure which bits have been escaped by you, and which bits were escaped in Excel, so it's harder to work out what it should be"}, {"count": 2, "tags": [], "bug_id": 54588, "attachment_id": null, "text": "Nothing was escaped by Excel in the example provided there. I caught the format string in the debugger while it was failing on the real file.\n\nIn the debug output it was just: _(*\"-\"??_);\n\nThen I obviously had to add the backslashes to make it valid Java...", "id": 165401, "time": "2013-02-20T12:12:30Z", "creator": "trejkaz@trypticon.org", "creation_time": "2013-02-20T12:12:30Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 54588, "attachment_id": null, "id": 165402, "time": "2013-02-20T12:16:14Z", "creator": "trejkaz@trypticon.org", "creation_time": "2013-02-20T12:16:14Z", "is_private": false, "text": "Incidentally, the stack trace is on the same line as Bug 53494, so even though the two look totally unrelated, it could be the same bug. In both cases there are existing unit tests which reproduce the problem in isolation... so it shouldn't be too hard to find it, right?"}, {"count": 4, "tags": [], "text": "Hi Nick.. is this something you can fix?  It would be great to see this resolved.. thanks.", "attachment_id": null, "id": 165426, "creator": "david.sitsky@gmail.com", "time": "2013-02-22T00:41:30Z", "bug_id": 54588, "creation_time": "2013-02-22T00:41:30Z", "is_private": false}, {"count": 5, "tags": [], "text": "I've been unable to get my copy of Excel to format a cell into anything sensible using this format string, so I can't work out what POI should be doing to start with\n\nAre you able to supply an example of the raw value shown in Excel, and what it formats to as a display value, when using this format string? Or event better, maybe two or three (possibly involving a negative number)?", "is_private": false, "id": 165427, "creator": "apache@gagravarr.org", "time": "2013-02-22T00:51:29Z", "bug_id": 54588, "creation_time": "2013-02-22T00:51:29Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 54588, "attachment_id": null, "id": 165428, "time": "2013-02-22T01:01:25Z", "creator": "trejkaz@trypticon.org", "creation_time": "2013-02-22T01:01:25Z", "is_private": false, "text": "I don't really have a copy of Excel to test this with, but...\n\nIn OpenOffice I can see it formatting them like normal numbers:\n  (positive example) 126,789.82\n  (negative example) -3,521.94\n\nIn Preview, I get something visually a bit odder:\n  (positive example) _-126,789.82_-\n  (negative example) -  3,521.94    (two spaces between the - and 3)"}, {"count": 7, "tags": [], "bug_id": 54588, "attachment_id": null, "is_private": false, "id": 165429, "time": "2013-02-22T01:05:56Z", "creator": "trejkaz@trypticon.org", "creation_time": "2013-02-22T01:05:56Z", "text": "Reading the docs:\n\n_(*\"-\"??_);\n\n   _(    - a space, but the width of the (\n   *     - repeat the next character to fill the column width\n   \"-\"   - seems to be equivalent to -, unless double quotes escaped it somehow\n   ??    - minimum of two significant zeroes\n   _)    - a space, but the width of the )\n   ;\n\nSince it's *\"-\" I would expect that it pads with -... but it seems to be padded with spaces instead, so I don't know... maybe the docs are just wrong. I'm not an expert on Excel, I just know that this format throws an exception."}, {"count": 8, "tags": [], "bug_id": 54588, "attachment_id": 29977, "id": 165430, "time": "2013-02-22T01:16:43Z", "creator": "david.sitsky@gmail.com", "creation_time": "2013-02-22T01:16:43Z", "is_private": false, "text": "Created attachment 29977\nHow some of these cells are rendered in Excel"}, {"count": 9, "tags": [], "bug_id": 54588, "attachment_id": 29978, "is_private": false, "id": 165431, "time": "2013-02-22T01:31:26Z", "creator": "david.sitsky@gmail.com", "creation_time": "2013-02-22T01:31:26Z", "text": "Created attachment 29978\nNumber format of cell as shown in Excel 2010\n\nFWIW.. right-clicking one of these cells and choosing \"Format cells...\" or \"Number format...\" shows the item formatted as type \"Accounting\" in Excel 2010.  So perhaps it is a built-in format type?"}, {"count": 10, "attachment_id": 29979, "bug_id": 54588, "is_private": false, "id": 165432, "time": "2013-02-22T01:37:42Z", "creator": "david.sitsky@gmail.com", "creation_time": "2013-02-22T01:37:42Z", "tags": [], "text": "Created attachment 29979\nExample Excel file\n\nNow that I know it is a standard \"accounting type\", I can attach an example Excel file.  See attached."}, {"count": 11, "tags": [], "bug_id": 54588, "attachment_id": null, "id": 165471, "time": "2013-02-25T06:02:30Z", "creator": "david.sitsky@gmail.com", "creation_time": "2013-02-25T06:02:30Z", "is_private": false, "text": "Hi Nick - just curious, were you able to reproduce this with my sample Excel file that uses the \"accounting type\" for a cell value?"}, {"count": 12, "tags": [], "text": "It has taken a while... But I think these should now be working thanks to the accountancy-with-currency support and tests added for #58536\n\nWould you be able to take a look with a nightly build from 20151026 onwards / 3.14 beta 1 once released, and see if it now works correctly for you too?", "is_private": false, "id": 185942, "creator": "apache@gagravarr.org", "time": "2015-10-25T21:49:16Z", "bug_id": 54588, "creation_time": "2015-10-25T21:49:16Z", "attachment_id": null}, {"count": 13, "tags": [], "bug_id": 54588, "attachment_id": null, "id": 185956, "time": "2015-10-25T23:47:26Z", "creator": "trejkaz@trypticon.org", "creation_time": "2015-10-25T23:47:26Z", "is_private": false, "text": "I checked the ticket on our side which referred to our one and apparently we had updated POI around 25 June 2013. Supposedly whatever we updated to at that point in time had fixed the issue for us already..."}, {"count": 14, "tags": [], "bug_id": 54588, "is_private": false, "text": "If you could grab a recent nightly build, and check that my work hasn't somehow un-fixed this for you (we didn't seem to have much in the way of accountancy unit tests before...), that'd be great and we can close the bug!", "id": 185957, "time": "2015-10-25T23:52:13Z", "creator": "apache@gagravarr.org", "creation_time": "2015-10-25T23:52:13Z", "attachment_id": null}, {"count": 15, "tags": [], "bug_id": 54588, "attachment_id": null, "id": 185958, "time": "2015-10-26T00:59:00Z", "creator": "trejkaz@trypticon.org", "creation_time": "2015-10-26T00:59:00Z", "is_private": false, "text": "I wish it were still easy to do that... but now that our build has been rejigged to use Gradle, it seems a lot harder to temporarily test a nightly release of a jar.\n\nUnless POI's nightlies happen to be in a repo somewhere?"}, {"count": 16, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 185975, "time": "2015-10-26T12:02:42Z", "bug_id": 54588, "creation_time": "2015-10-26T12:02:42Z", "is_private": false, "text": "Nightlies are produced by Jenkins, and available at https://builds.apache.org/job/POI/lastSuccessfulBuild/artifact/build/dist/\n\nI gather that a line like this should let you include the jars from the nightly bin build in gradle:\n\ndependencies {\n    compile fileTree(dir: 'libs', include: ['*.jar'])\n}"}, {"count": 17, "tags": [], "bug_id": 54588, "is_private": false, "text": "What our build has now:\n    poi: [\n        'poi:poi:3.9-N1.0',\n        'poi:poi-ooxml:3.9-N1.0',\n        'poi:poi-ooxml-schemas:3.9-N1.0',\n        'poi:poi-scratchpad:3.9-N1.0',\n    ]\n\nWhat I tried (1):\n\n    poi: [\n            fileTree(dir: '/Users/daniel/Downloads/poi-3.14-beta1', include: ['*.jar'])\n    ],\n\nWhat I tried (2):\n\n    poi: fileTree(dir: '/Users/daniel/Downloads/poi-3.14-beta1', include: ['*.jar']),\n\nWhat I got:\n    > Cannot convert the provided notation to an object of type ModuleVersionSelector: /Users/tester/Downloads/poi-3.14-beta1/poi-3.14-beta1-20151027.jar.\n      The following types/formats are supported:\n        - Instances of ModuleVersionSelector.\n        - String or CharSequence values, for example 'org.gradle:gradle-core:1.0'.\n        - Maps, for example [group: 'org.gradle', name:'gradle-core', version: '1.0'].\n        - Collections or arrays of any other supported format. Nested collections/arrays will be flattened.", "id": 186035, "time": "2015-10-28T00:55:56Z", "creator": "trejkaz@trypticon.org", "creation_time": "2015-10-28T00:55:56Z", "attachment_id": null}, {"count": 18, "tags": [], "bug_id": 54588, "is_private": false, "text": "I use the following when testing pre-release versions:\n\ndependencies {\n\tcompile files('/tmp/poi-3.13/ooxml-lib/xmlbeans-2.6.0.jar')\n\tcompile files('/tmp/poi-3.13/poi-3.13-20150929.jar')\n\tcompile files('/tmp/poi-3.13/poi-ooxml-3.13-20150929.jar')\n\tcompile files('/tmp/poi-3.13/poi-ooxml-schemas-3.13-20150929.jar')\n}\n\nThese lines are in the normal dependency/configuration-section, I am not sure how you include the \"poi: [...]\" stuff in your build, unfortunately Groove/Gradle is very dynamic and allows to do all sorts of stuff.", "id": 186049, "time": "2015-10-28T09:50:33Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-10-28T09:50:33Z", "attachment_id": null}, {"count": 19, "tags": [], "text": "In one of the builds referring to it, it's:\n\n    dependencies {\n      // ...other dependencies...\n      compile libraries.poi\n      // ...other dependencies...\n    }\n\nSo you would think that I could do this:\n\n    ext.libraries = [\n      // ...other libraries...\n\n      poi: [\n        files('.../poi-3.14-beta1/poi-3.14-beta1-20151027.jar'),\n        files('.../poi-3.14-beta1/poi-3.14-ooxml-20151027.jar'),\n        files('.../poi-3.14-beta1/poi-3.14-ooxml-schemas-20151027.jar'),\n        files('.../poi-3.14-beta1/poi-3.14-scratchpad-20151027.jar'),\n      ],\n\n      // ...other libraries...\n    }\n\nAnd then this would be equivalent to putting an array of files() directly onto the compile. And yet, I get the same error. So I dunno, maybe it just isn't possible unless it's in a repo somewhere.", "attachment_id": null, "id": 186107, "creator": "trejkaz@trypticon.org", "time": "2015-10-30T04:19:31Z", "bug_id": 54588, "creation_time": "2015-10-30T04:19:31Z", "is_private": false}, {"count": 20, "tags": [], "text": "I'm not an expert on Gradle myself, but I would use the snippet that I posted previously in the dependencies-section directly, not in the poi-library-definition, i.e.\n\n    dependencies {\n      // ...other dependencies...\n        compile files('poi-3.14-beta1/poi-3.14-beta1-20151027.jar')\n        compile files('poi-3.14-beta1/poi-3.14-ooxml-20151027.jar')\n        compile files('poi-3.14-beta1/poi-3.14-ooxml-schemas-20151027.jar')\n        compile files('poi-3.14-beta1/poi-3.14-scratchpad-20151027.jar')\n      // ...other dependencies...\n    }\n\ninstead of \n\n    dependencies {\n      // ...other dependencies...\n      compile libraries.poi\n      // ...other dependencies...\n    }\n\nNote: You might need to add a line for the XmlBeans-jar as well in this case.", "is_private": false, "id": 186116, "creator": "dominik.stadler@gmx.at", "time": "2015-10-30T17:10:34Z", "bug_id": 54588, "creation_time": "2015-10-30T17:10:34Z", "attachment_id": null}, {"count": 21, "tags": [], "text": "Turns out putting it directly in still gives me the same error. Still investigating. Gradle has really been a huge time sink... :/", "attachment_id": null, "id": 186155, "creator": "trejkaz@trypticon.org", "time": "2015-11-01T23:54:25Z", "bug_id": 54588, "creation_time": "2015-11-01T23:54:25Z", "is_private": false}, {"count": 22, "tags": [], "bug_id": 54588, "is_private": false, "text": "Okay, I finally managed to get the jars on the classpath, but there are compilation failures. So this is not something I'm going to be able to easily test. We'll just have to find out whether it works in the future when someone has time to rewrite all the code for the new version.", "id": 186160, "time": "2015-11-02T01:35:09Z", "creator": "trejkaz@trypticon.org", "creation_time": "2015-11-02T01:35:09Z", "attachment_id": null}, {"count": 23, "attachment_id": null, "bug_id": 54588, "is_private": false, "id": 186167, "time": "2015-11-02T05:25:45Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-11-02T05:25:45Z", "tags": [], "text": "Ok, so I am closing this as FIXED anyway, keep us posted about your findings and if the compile-errors seem to be caused by an incorrect change in POI be sure to create new bug entries."}]