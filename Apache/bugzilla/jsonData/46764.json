[{"count": 0, "tags": [], "creator": "montesa@unizar.es", "attachment_id": null, "id": 125139, "time": "2009-02-25T01:59:38Z", "bug_id": 46764, "creation_time": "2009-02-25T01:59:38Z", "is_private": false, "text": "I have attached a Tomcat 6.0.18 (and TC-Native 1.1.16) with Apache 2.2 using mod_jk 1.2.27. Tomcat is configured with multiple vhost.\n\nApache & Tomcat is running in Debian 4 with SUN Java 6.0.\n\nMy server.xml looks like this:\n\n...\n<Connector port=\"8009\"\n           enableLookups=\"false\" redirectPort=\"443\" protocol=\"AJP/1.3\"/>\n\n    <Engine name=\"Catalina\" defaultHost=\"localhost\">\n\n      <Host name=\"localhost\" appBase=\"webapps\"\n            autoDeploy=\"false\" unpackWARs=\"false\"\n            xmlValidation=\"false\" xmlNamespaceAware=\"false\"/>\n\n     <Host name=\"other.machine.com\" appBase=\"sharedwebapps\"\n           autoDeploy=\"false\" unpackWARs=\"false\"\n           xmlValidation=\"false\" xmlNamespaceAware=\"false\"/>\n...\n\nWhen start up Tomcat appear in catalina.out the following errores:\n\n[Fatal Error] loose.dtd:31:3: The declaration for the entity \"HTML.Version\" must end with '>'.\n\nMy JSP code generated is like this:\n\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\n\n\t\nBut I do not want to validate. Furthermore Tomcat tries to open a connection to http://www.w3.org making the request is resolved more slowly. If activate the firewall (DROP OUTPUT connections) will retry the connection for minutes."}, {"count": 1, "attachment_id": null, "bug_id": 46764, "is_private": false, "id": 125292, "time": "2009-03-03T14:05:57Z", "creator": "markt@apache.org", "creation_time": "2009-03-03T14:05:57Z", "tags": [], "text": "Can you please supply the simplest JSP that exhibits this error on a clean 6.0.18 installation."}, {"count": 2, "tags": [], "creator": "montesa@unizar.es", "text": "(In reply to comment #1)\n> Can you please supply the simplest JSP that exhibits this error on a clean\n> 6.0.18 installation.\n\nMy code is as follows:\n\nURL urlXMLIdioma=new URL(\"http://machine.com/idioma.xml\");\norg.w3c.dom.Document docIdioma=null;\norg.xml.sax.InputSource isXMLIdioma=null;\njavax.xml.parsers.DocumentBuilderFactory docbfIdioma=javax.xml.parsers.DocumentBuilderFactory.newInstance();\ndocbfIdioma.setNamespaceAware(false);\ndocbfIdioma.setValidating(false);\nisXMLIdioma=new org.xml.sax.InputSource(urlXMLIdioma.openStream());\nisXMLIdioma.setEncoding(\"ISO-8859-1\");\ndocIdioma=docbfIdioma.newDocumentBuilder().parse(isXMLIdioma);\n\nThe last line throws the exception: org.xml.sax.SAXParseException: The declaration for the entity \"HTML.Version\" must end with '>'.\n\nIf \"idioma.xml\" not exists then server returns a 404 error page. The 404 page begins like this:\n\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\n<html lang=\"es\">\n...\n\nand then the exception occurs.\n\nWhy? I disabled all xmlValidation (tomcat, in jsp, etc.)", "id": 125336, "time": "2009-03-05T02:52:19Z", "bug_id": 46764, "creation_time": "2009-03-05T02:52:19Z", "is_private": false, "attachment_id": null}, {"count": 3, "attachment_id": null, "bug_id": 46764, "text": "I can't reproduce this. With the sample JSP code you have provided, this just works.\n\nThere is also something odd about your configuration. A clean installation won't even look at a JSP on start-up, let alone try and parse it.\n\nIf you still see this error on a clean Tomcat 6.0.18 installation downloaded from the ASF (not installed via your OS's packaging system) please provide the complete source for a single JSP that demonstrates this issue on the clean installation so we can investigate further.", "id": 125404, "time": "2009-03-07T06:03:59Z", "creator": "markt@apache.org", "creation_time": "2009-03-07T06:03:59Z", "tags": [], "is_private": false}]