[{"count": 0, "tags": [], "text": "The actual bug is that JK2 on Apache 1.3 on Win2K encounters an error when\ncreating the shared memory file. The log file simply says:\n\n[jk_shm.c (358)]: shm.create(): error mmapping c:/servers/apache/logs/jk2.shm\n\nI have seen the shm file working without problems on apache 2.0 and not working\non apache 1.3, on the same machine with the same tomcat version.\nThis in turn leads to further errors when requests start comming in:\n\n[jk_endpoint.c (90)]: workerEnv.init() create slot epStat.0 failed\n\n.. because this requires shared memory.\n\nI have seen a number of reports of the first error online, but nobody seems to\nhave a solution. I have also seen many people with the second problem, and not\nmany people realize that it is often a result of the first problem...\n\nFortunately there is a workaround: set shm.disabled=1.\n\nThe details:\nTomcat 5.0.18\nApache 1.3.29\nJK2 2.0.2 (mod_jk2-1.3.27.dll)\n\nMy config file:\n\n[shm]\nfile=${serverRoot}/logs/jk2.shm\nsize=1048576\n[channel.socket:localhost:8009]\n[uri:/examples/*]\n\nThe log output:\n[Wed Feb 25 13:49:23 2004]  (error) [jk_shm.c (358)]: shm.create(): error\nmmapping c:/servers/apache/logs/jk2.shm\n[Wed Feb 25 13:49:53 2004]  (error) [jk_endpoint.c (90)]: workerEnv.init()\ncreate slot epStat.0 failed\n[Wed Feb 25 13:49:53 2004]  (error) [jk_worker_lb.c (402)]: lb.service() worker\nfailed 21000 for ajp13:localhost:8009\n[Wed Feb 25 13:49:53 2004]  (error) [jk_worker_lb.c (415)]: lb.service()\nunrecoverable error...\n[Wed Feb 25 13:49:53 2004]  (error) [mod_jk2.c (427)]: mod_jk.handler() Error\nconnecting to tomcat 21000", "attachment_id": null, "bug_id": 27222, "id": 52932, "time": "2004-02-25T14:09:49Z", "creator": "latesta@hotmail.com", "creation_time": "2004-02-25T14:09:49Z", "is_private": false}, {"count": 1, "tags": [], "creator": "yoavs@computer.org", "attachment_id": null, "text": "Set shm.disabled=1 where?  In the configuration file, right?  So this is not a \ncode bug, but we should update our documentation to include your suggestion.  \nIs my understanding correct?", "id": 58318, "time": "2004-05-28T14:29:20Z", "bug_id": 27222, "creation_time": "2004-05-28T14:29:20Z", "is_private": false}, {"count": 2, "attachment_id": null, "bug_id": 27222, "is_private": false, "id": 58504, "time": "2004-06-01T20:55:34Z", "creator": "latesta@hotmail.com", "creation_time": "2004-06-01T20:55:34Z", "tags": [], "text": "Actually, Yoav, this is a code bug. Shared memory does not work on apache 1.3,\nat least not with my config (Win2K, Tomcat 5.0). Disabeling shared memory is a\nrather crude workaround I'd say.\n\nBut it is a workaround nonetheless. And yes, disabled=1 goes in your\nconfiguration file, like so:\n[shm]\ndisabled=1\n\nHope this helps,\ndr testa"}, {"count": 3, "tags": [], "creator": "yoavs@computer.org", "attachment_id": null, "id": 67555, "time": "2004-11-29T19:50:16Z", "bug_id": 27222, "creation_time": "2004-11-29T19:50:16Z", "is_private": false, "text": "As of November 15, 2004, JK2 is no longer supported. All bugs related to JK2 \nwill be marked as WONTFIX. In its place, some of its features have been \nbackported to jk1. Most of those features will be seen in 1.2.7, which is \nslated for release on November 30th, 2004.\n\nAnother alternative is the ajp addition to mod_proxy which will be part of \napache 2.\n\nFor more information on the Tomat connectors docs at\nhttp://jakarta.apache.org/tomcat/connectors-doc/\n"}]