[{"count": 0, "tags": [], "creator": "peterreilly@apache.org", "attachment_id": null, "is_private": false, "id": 93628, "time": "2006-09-15T14:29:34Z", "bug_id": 40522, "creation_time": "2006-09-15T14:29:34Z", "text": "project.setCoreLoader(Classloader x) has been part\nof the ant code base for quite a long time, (it\nwas orignally called project.setSystemLoader(Classloader x)).\n\nCurrently it does not do anything usefull, but with a few modifications\nit can be made to work again.\n\n1) change antclassloader to use the core loader as a parent\n   loader\n2) when the coreloader is changed update all the non resolved\n   tasks and types that use the coreloader to use the new\n   core loader.\n\nTwo other changes are also necessary:\n1) when the coreloader is set, ensure that it can be used\n   to resolve Project correctly.\n2) modify oata.taskdefs.Classloader to add types.optional and\n   util.optional to its addLoaderPackageRoot list.\n\nWhen these changes are made, <classloader> works.\n<classloader> has been in the ant code since 1.6, but has not\nbeen docuemented.\n\nWith these changes one can do the following:\n<project ... xmlns:ac=\"antlib:net.sf.antcontrib\">\n    <classloader>\n      <classpath>\n        <pathelement path=\"c:/apps/jdepend-2.9.1/lib/jdepend-2.9.1.jar\"/>\n        <pathelement path=\"${ant.home}/lib/ant-jdepend.jar\"/>\n        <pathelement path=\"c:/apps/ant-contrib/build/lib/ant-contrib.jar\"/>\n     </classpath>\n    </classloader>\n\n    <jdepend>\n       ..\n    </jdepend>\n\n    <ac:for ...\n    <ac:for"}, {"count": 1, "tags": [], "creator": "peterreilly@apache.org", "attachment_id": null, "is_private": false, "id": 93630, "time": "2006-09-15T14:32:01Z", "bug_id": 40522, "creation_time": "2006-09-15T14:32:01Z", "text": "*** Bug 21635 has been marked as a duplicate of this bug. ***"}, {"count": 2, "tags": [], "text": "Created attachment 18870\npatch of changes to fix coreloader", "is_private": false, "bug_id": 40522, "id": 93631, "time": "2006-09-15T14:33:57Z", "creator": "peterreilly@apache.org", "creation_time": "2006-09-15T14:33:57Z", "attachment_id": 18870}, {"count": 3, "attachment_id": null, "bug_id": 40522, "is_private": false, "id": 93634, "time": "2006-09-15T15:19:20Z", "creator": "mbenson@apache.org", "creation_time": "2006-09-15T15:19:20Z", "tags": [], "text": "How does the example below differ from your <appendprojectpath> prototype task?\n Is it that fixing this code that is already \"polluting\" our released codebase\nby being present in a less-than-wholly-working state, that the need for\n<appendprojectpath> would be obviated?"}, {"text": "It is more similar to the <addlibpath>\nWhen I introduced that, I said that it\nis similar to the coreloader stuff, which\nI could not get to work.\n\nThe main difference is that the coreloader\ncode does not need to modify a classloader.\n\nThere are a number of things to be done\nto make it rock solid, (handling of <antcall>\n<ant> etc, easier handling of ant-<optional> jars\netc, modification of <classloader> task to only\nhandle the coreloader and not other classloaders\n(this is done *much* better by \nRainer's http://jtools.org/ant-classloadertask task).\n\nthe <appendprojectpath> task is a simplified copy\nof Rainer's task, it only handles the project classpath\nand assumes that it is URLClassLoader. The latter assumption\nmay not be true if ant is used outside of ant[.bat] (say\nin a web application).\n\n\n", "tags": [], "bug_id": 40522, "is_private": false, "count": 4, "id": 93637, "time": "2006-09-15T16:04:25Z", "creator": "peterreilly@apache.org", "creation_time": "2006-09-15T16:04:25Z", "attachment_id": null}, {"count": 5, "attachment_id": null, "bug_id": 40522, "is_private": false, "id": 129356, "time": "2009-07-31T11:01:11Z", "creator": "gscokart@gmail.com", "creation_time": "2009-07-31T11:01:11Z", "tags": [], "text": "Fixing this will also make it easier to launch the test of the antunit build (by avoiding the need to put all the classes and the test classes in the ant classpath).\n\nSee http://markmail.org/thread/5bbknx6hm7liqvi6"}]