[{"id": 131918, "tags": [], "bug_id": 48191, "is_private": false, "count": 0, "text": "I newly installed the mod_jk 1.2.28 and since then got problem (see below).\n\nI have a web application which is deployed on Jboss. One of the function of this web-app is: You can click a button (such as 'Generate Report') on client to submit a request for generating a PDF-report. The generation of PDF-report is done on Jboss. The generation will take very long, from 5 to 40 minutes, depends on what kind of report you want. After the PDF-report is generated, it will be sent back a confirm message (such as \"Generated in 22220 msec[query time: 22186 msec, processing time: 20 msec] for 36 contracts. \") to the client (browser)\n\nMy system atlas looks as follow:\n\nClient: IE - browser\n          |\n          |\nApache Http-Server (Red Hat Enterprise Linux ES release 4/64bit , Apache/2.0.52, mod_jk 1.2.28)\n          |\n          |\nServer: JBoss  on Linux (the Web-App is deployed hier)\n\n\nOne can access the web-app directly to Jboss. In this case, no matter how long the report-generation will take, I can get the returned confirm message on the browser.\n\nBut when I access via Apache-Http-Server and after the PDF-report is generated on Jboss-side, I can not get the returned confirm message shown on the browser, even after 30 min. \n\nLater I move the same configuration of worders.properties to another machine (Red Hat Enterprise Linux ES release 3/32bit , Apache/2.0.46, mod_jk 1.2.26). It works fine.\n\nI am not sure if the version-difference is the cause.\n\nHere is my workers.properties:\n\nworker.worker_portfolio_son1.connection_pool_timeout=600\nworker.worker_portfolio_son1.socket_keepalive=True\nworker.worker_portfolio_son1.lbfactor=1\nworker.worker_portfolio_son1.type=ajp13\nworker.worker_portfolio_son1.port=8009\nworker.worker_portfolio_son1.host=appl-myweb.mycom.com\nworker.worker_portfolio_son1.sticky_session=True\n\n\n*****\n\nLog message to my case:\n\nI issue a request from the client (browser) to the to generate the report. From Jboss-log I can watch as follow:\n\n2009-11-12 15:50:24,094 INFO  [STDOUT] ----- 1. Get data -----\n2009-11-12 15:56:15,478 INFO  [STDOUT] ----- 2. Process data -----\n2009-11-12 15:56:15,509 INFO  [STDOUT] ----- 3. Completed -----\n2009-11-12 15:56:15,510 INFO  [STDOUT] ----- Clearing resources -----\n2009-11-12 15:56:15,510 INFO  [STDOUT] ----- 4. Render page -----\n\nOne can see it just take about 6 min. to generate the PDF report and then send the confirm message back to the client.\n\nOn Apache-Http-WebSer mod_jk.log I can see at the same time:\n[Thu Nov 12 16:09:07 2009] [9286:2537062720] [debug] jk_handler::mod_jk.c (2599): Service finished with status=200 for worker=samos-test\n\nBut on the browser client I can't get the returned page/confirm message.\n\nHere is the whole log in mod_jk.log. \n\n[code]\n\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] map_uri_to_worker_ext::jk_uri_worker_map.c (1036): Attempting to map URI '/test1/result1.htm' from 12 maps\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] find_match::jk_uri_worker_map.c (850): Attempting to map context URI '/cps/rde/xchg/civ_usermanagement_russia/*=worker_ru' source 'JkMount'\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] find_match::jk_uri_worker_map.c (850): Attempting to map context URI '/cps/rde/xbcr/civ_usermanagement_russia/*=worker_ru' source 'JkMount'\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] find_match::jk_uri_worker_map.c (850): Attempting to map context URI '/cps/rde/xchg/civ_extranet_russia/*=worker_ru' source 'JkMount'\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] find_match::jk_uri_worker_map.c (850): Attempting to map context URI '/cps/rde/xbcr/civ_extranet_russia/*=worker_ru' source 'JkMount'\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] find_match::jk_uri_worker_map.c (850): Attempting to map context URI '/cps/rde/xchg/mis_reports/*=worker_ru' source 'JkMount'\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] find_match::jk_uri_worker_map.c (850): Attempting to map context URI '/cps/rde/MISPdfController*=worker_ru' source 'JkMount'\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] find_match::jk_uri_worker_map.c (850): Attempting to map context URI '/calculator/*=worker_ru' source 'JkMount'\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] find_match::jk_uri_worker_map.c (850): Attempting to map context URI '/test1/*=worker_portfolio_son1' source 'JkMount'\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] find_match::jk_uri_worker_map.c (863): Found a wildchar match '/test1/*=worker_portfolio_son1'\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] jk_handler::mod_jk.c (2459): Into handler jakarta-servlet worker=worker_portfolio_son1 r->proxyreq=0\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] wc_get_worker_for_name::jk_worker.c (116): found a worker worker_portfolio_son1\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] wc_get_name_for_type::jk_worker.c (293): Found worker type 'ajp13'\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] init_ws_service::mod_jk.c (977): Service protocol=HTTP/1.0 method=GET ssl=false host=(null) addr=172.23.17.1 name=citibank-extranet-ru-test.civ-versicherung.de port=80 auth=(null) user=(null) laddr=172.23.17.33 raddr=172.23.17.1 uri=/test1/result1.htm\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_get_endpoint::jk_ajp_common.c (2977): acquired connection pool slot=0 after 0 retries\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_marshal_into_msgb::jk_ajp_common.c (605): ajp marshaling done\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_service::jk_ajp_common.c (2283): processing worker_portfolio_son1 with 2 retries\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): sending to ajp13 pos=4 len=775 max=8192\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0000    12 34 03 03 02 02 00 08 48 54 54 50 2F 31 2E 30  - .4......HTTP/1.0\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0010    00 00 12 2F 74 65 73 74 31 2F 72 65 73 75 6C 74  - .../test1/result\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0020    31 2E 68 74 6D 00 00 0B 31 37 32 2E 32 33 2E 31  - 1.htm...172.23.1\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0030    37 2E 31 00 FF FF 00 2D 63 69 74 69 62 61 6E 6B  - 7.1....-citibank\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0040    2D 65 78 74 72 61 6E 65 74 2D 72 75 2D 74 65 73  - -extranet-ru-tes\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0050    74 2E 63 69 76 2D 76 65 72 73 69 63 68 65 72 75  - t.civ-versicheru\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0060    6E 67 2E 64 65 00 00 50 00 00 0B A0 01 00 A4 69  - ng.de..P.......i\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0070    6D 61 67 65 2F 67 69 66 2C 20 69 6D 61 67 65 2F  - mage/gif,.image/\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0080    78 2D 78 62 69 74 6D 61 70 2C 20 69 6D 61 67 65  - x-xbitmap,.image\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0090    2F 6A 70 65 67 2C 20 69 6D 61 67 65 2F 70 6A 70  - /jpeg,.image/pjp\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 00a0    65 67 2C 20 61 70 70 6C 69 63 61 74 69 6F 6E 2F  - eg,.application/\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 00b0    76 6E 64 2E 6D 73 2D 65 78 63 65 6C 2C 20 61 70  - vnd.ms-excel,.ap\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 00c0    70 6C 69 63 61 74 69 6F 6E 2F 76 6E 64 2E 6D 73  - plication/vnd.ms\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 00d0    2D 70 6F 77 65 72 70 6F 69 6E 74 2C 20 61 70 70  - -powerpoint,.app\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 00e0    6C 69 63 61 74 69 6F 6E 2F 6D 73 77 6F 72 64 2C  - lication/msword,\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 00f0    20 61 70 70 6C 69 63 61 74 69 6F 6E 2F 78 2D 73  - .application/x-s\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0100    68 6F 63 6B 77 61 76 65 2D 66 6C 61 73 68 2C 20  - hockwave-flash,.\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0110    2A 2F 2A 00 A0 0D 00 44 68 74 74 70 3A 2F 2F 63  - */*....Dhttp://c\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0120    69 74 69 62 61 6E 6B 2D 65 78 74 72 61 6E 65 74  - itibank-extranet\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0130    2D 72 75 2D 74 65 73 74 2E 63 69 76 2D 76 65 72  - -ru-test.civ-ver\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0140    73 69 63 68 65 72 75 6E 67 2E 64 65 2F 74 65 73  - sicherung.de/tes\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0150    74 31 2F 69 6E 64 65 78 2E 68 74 6D 00 00 0F 41  - t1/index.htm...A\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0160    63 63 65 70 74 2D 4C 61 6E 67 75 61 67 65 00 00  - ccept-Language..\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0170    02 64 65 00 A0 0E 00 5E 4D 6F 7A 69 6C 6C 61 2F  - .de....^Mozilla/\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0180    34 2E 30 20 28 63 6F 6D 70 61 74 69 62 6C 65 3B  - 4.0.(compatible;\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0190    20 4D 53 49 45 20 36 2E 30 3B 20 57 69 6E 64 6F  - .MSIE.6.0;.Windo\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 01a0    77 73 20 4E 54 20 35 2E 31 3B 20 53 56 31 3B 20  - ws.NT.5.1;.SV1;.\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 01b0    2E 4E 45 54 20 43 4C 52 20 31 2E 31 2E 34 33 32  - .NET.CLR.1.1.432\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 01c0    32 3B 20 2E 4E 45 54 20 43 4C 52 20 32 2E 30 2E  - 2;..NET.CLR.2.0.\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 01d0    35 30 37 32 37 29 00 A0 0B 00 2D 63 69 74 69 62  - 50727)....-citib\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 01e0    61 6E 6B 2D 65 78 74 72 61 6E 65 74 2D 72 75 2D  - ank-extranet-ru-\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 01f0    74 65 73 74 2E 63 69 76 2D 76 65 72 73 69 63 68  - test.civ-versich\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0200    65 72 75 6E 67 2E 64 65 00 A0 09 00 41 4A 53 45  - erung.de....AJSE\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0210    53 53 49 4F 4E 49 44 3D 46 45 37 35 34 35 32 37  - SSIONID=FE754527\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0220    34 45 33 33 45 37 31 42 33 42 33 42 32 38 32 42  - 4E33E71B3B3B282B\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0230    35 41 31 33 38 46 35 43 2E 77 6F 72 6B 65 72 5F  - 5A138F5C.worker_\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0240    70 6F 72 74 66 6F 6C 69 6F 5F 73 6F 6E 31 00 00  - portfolio_son1..\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0250    03 56 69 61 00 00 58 31 2E 30 20 73 30 30 33 69  - .Via..X1.0.s003i\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0260    73 31 30 2E 70 72 6F 61 63 74 69 76 2E 64 65 3A  - s10.proactiv.de:\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0270    38 30 38 30 20 28 49 57 53 53 29 2C 20 31 2E 30  - 8080.(IWSS),.1.0\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0280    20 73 30 30 33 69 73 30 36 2E 70 72 6F 61 63 74  - .s003is06.proact\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0290    69 76 2E 64 65 3A 33 31 32 38 20 28 73 71 75 69  - iv.de:3128.(squi\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 02a0    64 2F 32 2E 35 2E 53 54 41 42 4C 45 31 34 29 00  - d/2.5.STABLE14).\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 02b0    00 0F 58 2D 46 6F 72 77 61 72 64 65 64 2D 46 6F  - ..X-Forwarded-Fo\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 02c0    72 00 00 07 75 6E 6B 6E 6F 77 6E 00 00 0D 43 61  - r...unknown...Ca\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 02d0    63 68 65 2D 43 6F 6E 74 72 6F 6C 00 00 0E 6D 61  - che-Control...ma\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 02e0    78 2D 61 67 65 3D 32 35 39 32 30 30 00 A0 06 00  - x-age=259200....\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 02f0    0A 6B 65 65 70 2D 61 6C 69 76 65 00 A0 08 00 01  - .keep-alive.....\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_connection_tcp_send_message::jk_ajp_common.c (1070): 0300    30 00 05 00 00 00 FF 00 00 00 00 00 00 00 00 00  - 0...............\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_send_request::jk_ajp_common.c (1549): (worker_portfolio_son1) Statistics about invalid connections: connect check (0), cping (0), send (0)\n[Thu Nov 12 15:50:24 2009] [9287:2537062720] [debug] ajp_send_request::jk_ajp_common.c (1560): (worker_portfolio_son1) request body to send 0 - request body to resend 0\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): received from ajp13 pos=0 len=276 max=8192\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0000    04 00 C8 00 02 4F 4B 00 00 08 00 0C 58 2D 50 6F  - .....OK.....X-Po\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0010    77 65 72 65 64 2D 42 79 00 00 59 53 65 72 76 6C  - wered-By..YServl\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0020    65 74 20 32 2E 34 3B 20 4A 42 6F 73 73 2D 34 2E  - et.2.4;.JBoss-4.\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0030    32 2E 33 2E 47 41 20 28 62 75 69 6C 64 3A 20 53  - 2.3.GA.(build:.S\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0040    56 4E 54 61 67 3D 4A 42 6F 73 73 5F 34 5F 32 5F  - VNTag=JBoss_4_2_\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0050    33 5F 47 41 20 64 61 74 65 3D 32 30 30 38 30 37  - 3_GA.date=200807\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0060    31 38 31 34 31 37 29 2F 4A 42 6F 73 73 57 65 62  - 181417)/JBossWeb\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0070    2D 32 2E 30 00 00 06 50 72 61 67 6D 61 00 00 08  - -2.0...Pragma...\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0080    6E 6F 2D 63 61 63 68 65 00 00 07 45 78 70 69 72  - no-cache...Expir\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0090    65 73 00 00 1D 54 68 75 2C 20 30 31 20 4A 61 6E  - es...Thu,.01.Jan\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 00a0    20 31 39 37 30 20 30 30 3A 30 30 3A 30 30 20 47  - .1970.00:00:00.G\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 00b0    4D 54 00 00 0D 43 61 63 68 65 2D 43 6F 6E 74 72  - MT...Cache-Contr\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 00c0    6F 6C 00 00 08 6E 6F 2D 63 61 63 68 65 00 00 0D  - ol...no-cache...\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 00d0    43 61 63 68 65 2D 43 6F 6E 74 72 6F 6C 00 00 08  - Cache-Control...\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 00e0    6E 6F 2D 73 74 6F 72 65 00 A0 01 00 17 74 65 78  - no-store.....tex\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 00f0    74 2F 68 74 6D 6C 3B 63 68 61 72 73 65 74 3D 55  - t/html;charset=U\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0100    54 46 2D 38 00 A0 02 00 02 64 65 00 A0 03 00 03  - TF-8.....de.....\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0110    34 33 33 00 00 00 00 00 00 00 00 00 00 00 00 00  - 433.............\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_unmarshal_response::jk_ajp_common.c (660): status = 200\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_unmarshal_response::jk_ajp_common.c (667): Number of headers is = 8\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_unmarshal_response::jk_ajp_common.c (723): Header[0] [X-Powered-By] = [Servlet 2.4; JBoss-4.2.3.GA (build: SVNTag=JBoss_4_2_3_GA date=200807181417)/JBossWeb-2.0]\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_unmarshal_response::jk_ajp_common.c (723): Header[1] [Pragma] = [no-cache]\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_unmarshal_response::jk_ajp_common.c (723): Header[2] [Expires] = [Thu, 01 Jan 1970 00:00:00 GMT]\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_unmarshal_response::jk_ajp_common.c (723): Header[3] [Cache-Control] = [no-cache]\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_unmarshal_response::jk_ajp_common.c (723): Header[4] [Cache-Control] = [no-store]\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_unmarshal_response::jk_ajp_common.c (723): Header[5] [Content-Type] = [text/html;charset=UTF-8]\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_unmarshal_response::jk_ajp_common.c (723): Header[6] [Content-Language] = [de]\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_unmarshal_response::jk_ajp_common.c (723): Header[7] [Content-Length] = [433]\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): received from ajp13 pos=0 len=437 max=8192\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0000    03 01 B1 0A 0A 0A 0A 0A 0A 0A 3C 21 44 4F 43 54  - ..........<!DOCT\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0010    59 50 45 20 48 54 4D 4C 20 50 55 42 4C 49 43 20  - YPE.HTML.PUBLIC.\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0020    22 2D 2F 2F 57 33 43 2F 2F 44 54 44 20 48 54 4D  - \"-//W3C//DTD.HTM\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0030    4C 20 34 2E 30 31 20 54 72 61 6E 73 69 74 69 6F  - L.4.01.Transitio\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0040    6E 61 6C 2F 2F 45 4E 22 0A 20 20 20 22 68 74 74  - nal//EN\"....\"htt\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0050    70 3A 2F 2F 77 77 77 2E 77 33 2E 6F 72 67 2F 54  - p://www.w3.org/T\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0060    52 2F 68 74 6D 6C 34 2F 6C 6F 6F 73 65 2E 64 74  - R/html4/loose.dt\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0070    64 22 3E 0A 3C 68 74 6D 6C 3E 0A 20 20 20 20 3C  - d\">.<html>.....<\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0080    68 65 61 64 3E 0A 20 20 20 20 20 20 20 20 3C 6D  - head>.........<m\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0090    65 74 61 20 68 74 74 70 2D 65 71 75 69 76 3D 22  - eta.http-equiv=\"\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 00a0    43 6F 6E 74 65 6E 74 2D 54 79 70 65 22 20 63 6F  - Content-Type\".co\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 00b0    6E 74 65 6E 74 3D 22 74 65 78 74 2F 68 74 6D 6C  - ntent=\"text/html\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 00c0    3B 20 63 68 61 72 73 65 74 3D 55 54 46 2D 38 22  - ;.charset=UTF-8\"\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 00d0    3E 0A 20 20 20 20 20 20 20 20 3C 74 69 74 6C 65  - >.........<title\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 00e0    3E 4A 53 50 20 50 61 67 65 3C 2F 74 69 74 6C 65  - >JSP.Page</title\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 00f0    3E 0A 20 20 20 20 3C 2F 68 65 61 64 3E 0A 20 20  - >.....</head>...\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0100    20 20 3C 62 6F 64 79 3E 0A 20 20 20 20 20 20 20  - ..<body>........\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0110    20 0A 20 20 20 20 20 20 20 20 47 65 6E 65 72 61  - ..........Genera\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0120    74 65 64 20 69 6E 20 33 35 31 34 31 36 20 6D 73  - ted.in.351416.ms\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0130    65 63 5B 71 75 65 72 79 20 74 69 6D 65 3A 20 33  - ec[query.time:.3\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0140    35 31 33 38 34 20 6D 73 65 63 2C 20 70 72 6F 63  - 51384.msec,.proc\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0150    65 73 73 69 6E 67 20 74 69 6D 65 3A 20 33 32 20  - essing.time:.32.\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0160    6D 73 65 63 5D 20 66 6F 72 20 38 32 34 37 32 37  - msec].for.824727\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0170    20 72 6F 77 73 2E 0A 20 20 20 20 20 20 20 20 3C  - .rows..........<\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0180    70 2F 3E 3C 61 20 68 72 65 66 3D 22 69 6E 64 65  - p/><a.href=\"inde\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0190    78 2E 68 74 6D 22 3E 42 61 63 6B 3C 2F 61 3E 0A  - x.htm\">Back.\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 01a0    20 20 20 20 3C 2F 62 6F 64 79 3E 0A 3C 2F 68 74  - ....</body>.</ht\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 01b0    6D 6C 3E 0A 00 00 00 00 00 00 00 00 00 00 00 00  - ml>.............\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ws_write::mod_jk.c (506): written 433 out of 433\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): received from ajp13 pos=0 len=2 max=8192\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_connection_tcp_get_message::jk_ajp_common.c (1259): 0000    05 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00  - ................\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_process_callback::jk_ajp_common.c (1846): AJP13 protocol: Reuse is OK\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_reset_endpoint::jk_ajp_common.c (743): (worker_portfolio_son1) resetting endpoint with sd = 29\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] ajp_done::jk_ajp_common.c (2905): recycling connection pool slot=0 for worker worker_portfolio_son1\n[Thu Nov 12 15:56:15 2009] worker_portfolio_son1 citibank-extranet-ru-test.civ-versicherung.de 351.425973\n[Thu Nov 12 15:56:15 2009] [9287:2537062720] [debug] jk_handler::mod_jk.c (2599): Service finished with status=200 for worker=worker_portfolio_son1\n[/code] \n[Thu Nov 12 16:08:15 2009] [9280:2537062720] [debug] wc_maintain::jk_worker.c (339): Maintaining worker worker_portfolio_son1\n[Thu Nov 12 16:08:15 2009] [9280:2537062720] [debug] ajp_reset_endpoint::jk_ajp_common.c (743): (worker_portfolio_son1) resetting endpoint with sd = 29 (     socket shutdown)\n[Thu Nov 12 16:08:18 2009] [9284:2537062720] [debug] wc_maintain::jk_worker.c (339): Maintaining worker worker_portfolio_son1\n[Thu Nov 12 16:08:18 2009] [9284:2537062720] [debug] ajp_reset_endpoint::jk_ajp_common.c (743): (worker_portfolio_son1) resetting endpoint with sd = 29 (     socket shutdown)\n[Thu Nov 12 16:08:52 2009] [9470:2537062720] [debug] wc_maintain::jk_worker.c (339): Maintaining worker worker_portfolio_son1\n[Thu Nov 12 16:08:53 2009] [9282:2537062720] [debug] wc_maintain::jk_worker.c (339): Maintaining worker worker_portfolio_son1\n[Thu Nov 12 16:08:53 2009] [9282:2537062720] [debug] ajp_reset_endpoint::jk_ajp_common.c (743): (worker_portfolio_son1) resetting endpoint with sd = 29 (     socket shutdown)\n[Thu Nov 12 16:09:05 2009] [9286:2537062720] [debug] wc_maintain::jk_worker.c (339): Maintaining worker worker_portfolio_son1\n[Thu Nov 12 16:09:05 2009] [9286:2537062720] [debug] ajp_reset_endpoint::jk_ajp_common.c (743): (worker_portfolio_son1) resetting endpoint with sd = 29 (     socket shutdown)\n[Thu Nov 12 16:11:05 2009] [9283:2537062720] [debug] wc_maintain::jk_worker.c (339): Maintaining worker worker_portfolio_son1\n[Thu Nov 12 16:11:05 2009] [9283:2537062720] [debug] ajp_reset_endpoint::jk_ajp_common.c (743): (worker_portfolio_son1) resetting endpoint with sd = 29 (     socket shutdown)\n[Thu Nov 12 16:11:08 2009] [9285:2537062720] [debug] wc_maintain::jk_worker.c (339): Maintaining worker worker_portfolio_son1\n[Thu Nov 12 16:11:08 2009] [9285:2537062720] [debug] ajp_reset_endpoint::jk_ajp_common.c (743): (worker_portfolio_son1) resetting endpoint with sd = 29 (     socket shutdown)\n[Thu Nov 12 16:11:19 2009] [9457:2537062720] [debug] wc_maintain::jk_worker.c (339): Maintaining worker worker_portfolio_son1\n[Thu Nov 12 16:11:19 2009] [9457:2537062720] [debug] ajp_reset_endpoint::jk_ajp_common.c (743): (worker_portfolio_son1) resetting endpoint with sd = 29 (     socket shutdown)\n[Thu Nov 12 16:11:21 2009] [9281:2537062720] [debug] wc_maintain::jk_worker.c (339): Maintaining worker worker_portfolio_son1\n[Thu Nov 12 16:11:21 2009] [9281:2537062720] [debug] ajp_reset_endpoint::jk_ajp_common.c (743): (worker_portfolio_son1) resetting endpoint with sd = 29 (     socket shutdown)\n[Thu Nov 12 16:11:43 2009] [9287:2537062720] [debug] wc_maintain::jk_worker.c (339): Maintaining worker worker_portfolio_son1\n[Thu Nov 12 16:11:43 2009] [9287:2537062720] [debug] ajp_reset_endpoint::jk_ajp_common.c (743): (worker_portfolio_son1) resetting endpoint with sd = 29 (     socket shutdown)\n[Thu Nov 12 16:11:44 2009] [9284:2537062720] [debug] wc_maintain::jk_worker.c (339): Maintaining worker worker_portfolio_son1\n[Thu Nov 12 16:11:44 2009] [9280:2537062720] [debug] wc_maintain::jk_worker.c (339): Maintaining worker worker_portfolio_son1\n[Thu Nov 12 16:11:45 2009] [9470:2537062720] [debug] wc_maintain::jk_worker.c (339): Maintaining worker worker_portfolio_son1", "time": "2009-11-13T00:35:05Z", "creator": "thomas2004ch@yahoo.de", "creation_time": "2009-11-13T00:35:05Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "rainer.jung@kippdata.de", "attachment_id": null, "id": 131922, "time": "2009-11-13T03:17:44Z", "bug_id": 48191, "creation_time": "2009-11-13T03:17:44Z", "is_private": false, "text": "Switch Product to Tomcat Connectors for mod_jk."}, {"count": 2, "tags": [], "creator": "rainer.jung@kippdata.de", "attachment_id": null, "id": 131923, "time": "2009-11-13T03:27:09Z", "bug_id": 48191, "creation_time": "2009-11-13T03:27:09Z", "is_private": false, "text": "This looks like mod_jk received the full response from the backend and could successfully send it to the client.\n\nUnfortunately the problem you originally reported on the users list was very different, namely you found an error in the jk log file:\n\n[Tue Nov 03 11:03:07 2009] [12138:2537062720] [info]\najp_connection_tcp_get_message::jk_ajp_common.c (1150):\n(worker_portfolio_son1) can't receive the response header message from\ntomcat, network problems or tomcat (172.23.17.37:8009) is down (errno=11)\n[Tue Nov 03 11:03:07 2009] [12138:2537062720] [error]\najp_get_reply::jk_ajp_common.c (1962): (worker_portfolio_son1) Tomcat is\ndown or refused connection. No response has been sent to the client (yet)\n[Tue Nov 03 11:03:07 2009] [12138:2537062720] [info]\najp_service::jk_ajp_common.c (2447): (worker_portfolio_son1) sending request\nto tomcat failed (recoverable), (attempt=2) [Tue Nov 03 11:03:07 2009]\n[12138:2537062720] [error] ajp_service::jk_ajp_common.c (2466):\n(worker_portfolio_son1) connecting to tomcat failed. [Tue Nov 03 11:03:07\n2009] worker_portfolio_son1 citibank-extranet-ru-test.civ-versicherung.de\n244.108419 [Tue Nov 03 11:03:07 2009] [12138:2537062720] [info]\njk_handler::mod_jk.c (2615): Service error=0 for\nworker=worker_portfolio_son1\n\nHere errno=11 meens EAGAIN. You also originally reported that this problem doesn't occur with version 1.2.26:\n\nWorking:\nmod_jk 1.2.26:\nServer version: Apache/2.0.46\nRed Hat Enterprise Linux ES release 3 (Taroon Update 5) 32 bit\n\nBroken:\nmod_jk 1.2.28:\nServer version: Apache/2.0.52\nRed Hat Enterprise Linux ES release 4 (Nahant Update 8) 64 bit\n\nIndeed the return code EAGAIN when reading from the backend socket was handled in a special way until 1.2.26 and is no longer in 1.2.28. We removed tolerating EAGAIN while reading from the backend:\n\nhttp://svn.apache.org/viewvc/tomcat/connectors/trunk/jk/native/common/jk_connect.c?r1=705959&r2=705977&pathrev=802161&diff_format=h\n\nEAGAIN should only be returned by read() when the socket is set to\nnon-blocking mode. I can't see why this should be the case for your\nconfiguration.\n\nTo not confuse any longer:\n\nCan you reproduce the problem under the following circumstances:\n\n- no reply_timeout\n- no coekcet_timeout\n- with at least one line of \"[error]\" in the JK log\n\nIf so, what's the request, what's in the JK log, what's the config in that case?\n\nI actually don't care whether it's a PDF request or not as long as we know what's being tested and the above conditions are met."}, {"count": 3, "tags": [], "creator": "thomas2004ch@yahoo.de", "text": "Further infomation:\n\nI took out the socket_timeout and reply_timeout. Here again my\nworkers.properties:\n\nworker.worker_portfolio_son1.connection_pool_timeout=600\nworker.worker_portfolio_son1.socket_keepalive=True\nworker.worker_portfolio_son1.lbfactor=1\nworker.worker_portfolio_son1.type=ajp13\nworker.worker_portfolio_son1.port=8009\nworker.worker_portfolio_son1.host=appl-portfolio-test.mycom.com\nworker.worker_portfolio_son1.sticky_session=True\n\nI can't see the errno=11 in the mod_jk.log now. As I said in my last post,\nthe developer changed the program so it will not return PDF-stream but\nsimply plain text. What I get is posted in my former post.\n\n\n(my original post by Apache - User:\nhttp://old.nabble.com/A-question-about-mod_jk-1.2.28-configuration-to26264069.html#a26440263)", "id": 132173, "time": "2009-11-20T09:28:10Z", "bug_id": 48191, "creation_time": "2009-11-20T09:28:10Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "rainer.jung@kippdata.de", "text": "OK, so we know, that this problem here (errno=11 during read) comes from the socket_timeout.\n\nConcerning your other observation: that is a totally different problem, even if it looks the same to you. There you send a tiny html content and the JK log shows, that we return the content, but the browser is not showing it. There are multiple reasons possible, from invalid content send up to MSIE behaviour.\n\nTry again using a simple commandline http client like wget or curl. If they show the content, then there's not bug with mod_jk. If you still think there's a problem in that html use case, please open another issue.\n\nThe case with socket_timeout set and resulting in errno=11 will be handled here. We know enough about it now to fix it :)", "id": 132177, "time": "2009-11-20T10:57:11Z", "bug_id": 48191, "creation_time": "2009-11-20T10:57:11Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "text": "Hi Rainer,\n\nSuerly can I test it with wget oder cURL. But I don't think it'S the problem of \" invalid content s\" to MSIE since as Iposted in my former post: As I try by another machine with mod_jk-1.2.25 everything is fine. But when I try this on machine with mod_jk 1.2.28, the IE-browser is waiting all the time for the return content.\n\nHow can you explain this? :)", "is_private": false, "bug_id": 48191, "id": 132236, "time": "2009-11-23T02:55:04Z", "creator": "thomas2004ch@yahoo.de", "creation_time": "2009-11-23T02:55:04Z", "attachment_id": null}, {"count": 6, "tags": [], "creator": "rainer.jung@kippdata.de", "attachment_id": null, "id": 137770, "time": "2010-06-20T07:17:12Z", "bug_id": 48191, "creation_time": "2010-06-20T07:17:12Z", "is_private": false, "text": "*** Bug 49468 has been marked as a duplicate of this bug. ***"}, {"count": 7, "tags": [], "creator": "rainer.jung@kippdata.de", "attachment_id": null, "id": 180095, "time": "2014-12-31T13:26:09Z", "bug_id": 48191, "creation_time": "2014-12-31T13:26:09Z", "is_private": false, "text": "The errno 11 part was explained (socket_timeout).\n\nThe part about the browser not showing the response got no response about testing with a commandline client in 5 years.\n\nResolving as INVALID."}]