[{"count": 0, "tags": [], "text": "I have excel having chart with primary and secondary axis.  I am to retrieve the chart Axis details to update the maximum value. \n\nI am having XSSFSheet instance after loading the given excel on which i am retrieving drawing and chart as below:\n\n        final XSSFDrawing drawing = xsh.createDrawingPatriarch();\n        final XSSFChart chart = drawing.getCharts().get(0);\n        final List<XSSFChartAxis> axisList = (List<XSSFChartAxis>) chart.getAxis();\n\nWhile debugging, it seems that XSSFChart.getAxis() is not having null check on axis variable and its not initialized. Its just checking the empty check. Which is why its failing. axis is initialized in the constructor. However in this case, its not initialized.\n\nI think in this case it should not come as null or it should be initialized on getAxis also.", "attachment_id": null, "id": 179821, "creator": "srivastavavijay@gmail.com", "time": "2014-12-17T08:00:43Z", "bug_id": 57362, "creation_time": "2014-12-17T08:00:43Z", "is_private": false}, {"count": 1, "tags": [], "text": "Can you produce a small junit unit test showing this problem? And ideally also a patch if you can see the right fix!", "attachment_id": null, "id": 179822, "creator": "apache@gagravarr.org", "time": "2014-12-17T08:11:21Z", "bug_id": 57362, "creation_time": "2014-12-17T08:11:21Z", "is_private": false}, {"count": 2, "tags": [], "creator": "srivastavavijay@gmail.com", "attachment_id": 32306, "id": 179853, "time": "2014-12-19T08:34:10Z", "bug_id": 57362, "creation_time": "2014-12-19T08:34:10Z", "is_private": false, "text": "Created attachment 32306\nSampleExcel"}, {"count": 3, "tags": [], "creator": "srivastavavijay@gmail.com", "attachment_id": null, "id": 179854, "time": "2014-12-19T08:34:27Z", "bug_id": 57362, "creation_time": "2014-12-19T08:34:27Z", "is_private": false, "text": "I just downloaded the src from svn and trying to get used to build process and creating patch . \nMeanwhile I just provide the test case and possible fix (which, I had tried out to be working).\n\nTest Examples:\n//Load existing excel with some chart on it having primary and secondary axis.\nfinal File res = new File(\"SampleExcel.xlsx\");\nfinal Workbook workbook = new XSSFWorkbook(OPCPackage.open(new FileInputStream(res)));\n        final Sheet sh = workbook.getSheetAt(0);\n        final XSSFSheet xsh = (XSSFSheet) sh;\n        final XSSFDrawing drawing = xsh.createDrawingPatriarch();\n        final XSSFChart chart = drawing.getCharts().get(0);\n        final List<XSSFChartAxis> axisList = (List<XSSFChartAxis>) chart.getAxis();\n//Note: getAxis fails as axis variable inside chart is null.\n        for(XSSFChartAxis axis: axisList){\n           //Do Some operation.\n        }\n\n\nFix:XSSFChart.java\n=====================\npublic List<? extends XSSFChartAxis> getAxis() \n{\n //ADDED NULL Check and Initialize the axis.\n if(axis == null){\n   axis = new ArrayList<XSSFChartAxis>();\n }\n if (axis.isEmpty() && hasAxis()) {\n   parseAxis();\n }\nreturn axis;\n}"}, {"count": 4, "tags": [], "bug_id": 57362, "attachment_id": null, "id": 179947, "time": "2014-12-22T14:24:14Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2014-12-22T14:24:14Z", "is_private": false, "text": "Thanks for the Patch, this is now applied via r1647317, although I reworked it slightly to not need to query in getAxis() constantly, we rather now create the List of Axises always."}, {"count": 5, "tags": [], "bug_id": 57362, "attachment_id": null, "is_private": false, "id": 180009, "time": "2014-12-24T05:25:34Z", "creator": "srivastavavijay@gmail.com", "creation_time": "2014-12-24T05:25:34Z", "text": "(In reply to Dominik Stadler from comment #4)\n> Thanks for the Patch, this is now applied via r1647317, although I reworked\n> it slightly to not need to query in getAxis() constantly, we rather now\n> create the List of Axises always.\n\nThanks for applying the patch."}]