[{"count": 0, "tags": [], "creator": "i.galic@brainsware.org", "text": "Apache HTTPd with mpm worker in rev proxy mode, spinning on the CPU.\n\nIf I don't restart the server by myself, this will go on, I suppose until the the process reached MaxRequestsPerChild (set to the default value of 10000)\n\ntop - 09:17:07 up 95 days, 17:12,  4 users,  load average: 2.10, 1.57, 1.06\nTasks: 276 total,   5 running, 271 sleeping,   0 stopped,   0 zombie\nCpu(s):100.0%us,  0.0%sy,  0.0%ni,  0.0%id,  0.0%wa,  0.0%hi,  0.0%si,  0.0%st\nMem:   2097152k total,  2063808k used,    33344k free,    49636k buffers\nSwap:  2097144k total,    22524k used,  2074620k free,  1530100k cached\n\n  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+   PPID COMMAND\n19501 www       25   0  346m  92m  82m R 49.7  4.5  19:09.60 17149 httpd-worker\n19498 www       25   0  346m  92m  82m R 49.3  4.5  25:40.51 17149 httpd-worker\n\n\nHere's a backtrace of one of the offending LWPs:\n\nmetis:~# gdb -q --pid 19501\nAttaching to process 19501\n\nwarning: process 19501 is a cloned process\nReading symbols from /opt/bw/bin/httpd-worker...done.\nUsing host libthread_db library \"/lib/libthread_db.so.1\".\nBFD: /usr/lib/libpcre.so.3: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/usr/lib/libpcre.so.3\": not in executable format: File format not recognized.\nBFD: /usr/lib/libldap_r-2.4.so.2: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/usr/lib/libldap_r-2.4.so.2\": not in executable format: File format not recognized.\nBFD: /usr/lib/liblber-2.4.so.2: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/usr/lib/liblber-2.4.so.2\": not in executable format: File format not recognized.\nBFD: /lib/libnsl.so.1: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/lib/libnsl.so.1\": not in executable format: File format not recognized.\nBFD: /lib/libm.so.6: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/lib/libm.so.6\": not in executable format: File format not recognized.\nBFD: /usr/lib/libz.so.1: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/usr/lib/libz.so.1\": not in executable format: File format not recognized.\nBFD: /usr/lib/libsqlite3.so.0: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/usr/lib/libsqlite3.so.0\": not in executable format: File format not recognized.\nBFD: /lib/librt.so.1: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/lib/librt.so.1\": not in executable format: File format not recognized.\nBFD: /lib/libcrypt.so.1: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/lib/libcrypt.so.1\": not in executable format: File format not recognized.\nBFD: /lib/libpthread.so.0: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/lib/libpthread.so.0\": not in executable format: File format not recognized.\nBFD: /lib/libdl.so.2: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/lib/libdl.so.2\": not in executable format: File format not recognized.\nBFD: /lib/libc.so.6: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/lib/libc.so.6\": not in executable format: File format not recognized.\nBFD: /lib/libresolv.so.2: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/lib/libresolv.so.2\": not in executable format: File format not recognized.\nBFD: /usr/lib/libgnutls.so.26: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/usr/lib/libgnutls.so.26\": not in executable format: File format not recognized.\nBFD: /usr/lib/libssl.so.0.9.8: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/usr/lib/libssl.so.0.9.8\": not in executable format: File format not recognized.\nBFD: /usr/lib/libcrypto.so.0.9.8: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/usr/lib/libcrypto.so.0.9.8\": not in executable format: File format not recognized.\nBFD: /usr/lib/libkrb5.so.3: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/usr/lib/libkrb5.so.3\": not in executable format: File format not recognized.\nBFD: /lib64/ld-linux-x86-64.so.2: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/lib64/ld-linux-x86-64.so.2\": not in executable format: File format not recognized.\nBFD: /usr/lib/libgcrypt.so.11: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/usr/lib/libgcrypt.so.11\": not in executable format: File format not recognized.\nBFD: /usr/lib/libk5crypto.so.3: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/usr/lib/libk5crypto.so.3\": not in executable format: File format not recognized.\nBFD: /usr/lib/libkrb5support.so.0: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/usr/lib/libkrb5support.so.0\": not in executable format: File format not recognized.\nBFD: /lib/libnss_compat.so.2: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/lib/libnss_compat.so.2\": not in executable format: File format not recognized.\nBFD: /lib/libnss_nis.so.2: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/lib/libnss_nis.so.2\": not in executable format: File format not recognized.\nBFD: /lib/libnss_files.so.2: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/lib/libnss_files.so.2\": not in executable format: File format not recognized.\nBFD: /lib/libgcc_s.so.1: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while mapping shared library sections:\n\"/lib/libgcc_s.so.1\": not in executable format: File format not recognized.\nBFD: /usr/lib/libpcre.so.3: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/usr/lib/libpcre.so.3\": can't read symbols: File format not recognized.\nReading symbols from /opt/bw/lib/libaprutil-1.so.0...done.\nLoaded symbols for /opt/bw/lib/libaprutil-1.so.0\nBFD: /usr/lib/libldap_r-2.4.so.2: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/usr/lib/libldap_r-2.4.so.2\": can't read symbols: File format not recognized.\nBFD: /usr/lib/liblber-2.4.so.2: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/usr/lib/liblber-2.4.so.2\": can't read symbols: File format not recognized.\nReading symbols from /usr/lib/libpq.so.4...done.\nLoaded symbols for /usr/lib/libpq.so.4\nReading symbols from /usr/lib/libmysqlclient_r.so.15...done.\nLoaded symbols for /usr/lib/libmysqlclient_r.so.15\nBFD: /lib/libnsl.so.1: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/lib/libnsl.so.1\": can't read symbols: File format not recognized.\nBFD: /lib/libm.so.6: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/lib/libm.so.6\": can't read symbols: File format not recognized.\nBFD: /usr/lib/libz.so.1: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/usr/lib/libz.so.1\": can't read symbols: File format not recognized.\nBFD: /usr/lib/libsqlite3.so.0: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/usr/lib/libsqlite3.so.0\": can't read symbols: File format not recognized.\nReading symbols from /usr/lib/libexpat.so.1...done.\nLoaded symbols for /usr/lib/libexpat.so.1\nReading symbols from /opt/bw/lib/libapr-1.so.0...done.\nLoaded symbols for /opt/bw/lib/libapr-1.so.0\nBFD: /lib/librt.so.1: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/lib/librt.so.1\": can't read symbols: File format not recognized.\nBFD: /lib/libcrypt.so.1: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/lib/libcrypt.so.1\": can't read symbols: File format not recognized.\nBFD: /lib/libpthread.so.0: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/lib/libpthread.so.0\": can't read symbols: File format not recognized.\nBFD: /lib/libdl.so.2: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/lib/libdl.so.2\": can't read symbols: File format not recognized.\nBFD: /lib/libc.so.6: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/lib/libc.so.6\": can't read symbols: File format not recognized.\nBFD: /lib/libresolv.so.2: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/lib/libresolv.so.2\": can't read symbols: File format not recognized.\nReading symbols from /usr/lib/libsasl2.so.2...done.\nLoaded symbols for /usr/lib/libsasl2.so.2\nBFD: /usr/lib/libgnutls.so.26: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/usr/lib/libgnutls.so.26\": can't read symbols: File format not recognized.\nBFD: /usr/lib/libssl.so.0.9.8: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/usr/lib/libssl.so.0.9.8\": can't read symbols: File format not recognized.\nBFD: /usr/lib/libcrypto.so.0.9.8: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/usr/lib/libcrypto.so.0.9.8\": can't read symbols: File format not recognized.\nBFD: /usr/lib/libkrb5.so.3: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/usr/lib/libkrb5.so.3\": can't read symbols: File format not recognized.\nReading symbols from /lib/libcom_err.so.2...done.\nLoaded symbols for /lib/libcom_err.so.2\nBFD: /lib/ld-linux-x86-64.so.2: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/lib/ld-linux-x86-64.so.2\": can't read symbols: File format not recognized.\nReading symbols from /usr/lib/libtasn1.so.3...done.\nLoaded symbols for /usr/lib/libtasn1.so.3\nReading symbols from /usr/lib/libgpg-error.so.0...done.\nLoaded symbols for /usr/lib/libgpg-error.so.0\nBFD: /usr/lib/libgcrypt.so.11: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/usr/lib/libgcrypt.so.11\": can't read symbols: File format not recognized.\nBFD: /usr/lib/libk5crypto.so.3: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/usr/lib/libk5crypto.so.3\": can't read symbols: File format not recognized.\nBFD: /usr/lib/libkrb5support.so.0: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/usr/lib/libkrb5support.so.0\": can't read symbols: File format not recognized.\nReading symbols from /lib/libkeyutils.so.1...done.\nLoaded symbols for /lib/libkeyutils.so.1\nBFD: /lib/libnss_compat.so.2: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/lib/libnss_compat.so.2\": can't read symbols: File format not recognized.\nBFD: /lib/libnss_nis.so.2: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/lib/libnss_nis.so.2\": can't read symbols: File format not recognized.\nBFD: /lib/libnss_files.so.2: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/lib/libnss_files.so.2\": can't read symbols: File format not recognized.\nReading symbols from /opt/bw/libexec/apache/mod_authn_file.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_authn_file.so\nReading symbols from /opt/bw/libexec/apache/mod_authz_host.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_authz_host.so\nReading symbols from /opt/bw/libexec/apache/mod_authz_groupfile.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_authz_groupfile.so\nReading symbols from /opt/bw/libexec/apache/mod_authz_user.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_authz_user.so\nReading symbols from /opt/bw/libexec/apache/mod_authz_default.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_authz_default.so\nReading symbols from /opt/bw/libexec/apache/mod_auth_basic.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_auth_basic.so\nReading symbols from /opt/bw/libexec/apache/mod_include.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_include.so\nReading symbols from /opt/bw/libexec/apache/mod_charset_lite.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_charset_lite.so\nReading symbols from /opt/bw/libexec/apache/mod_env.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_env.so\nReading symbols from /opt/bw/libexec/apache/mod_mime_magic.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_mime_magic.so\nReading symbols from /opt/bw/libexec/apache/mod_expires.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_expires.so\nReading symbols from /opt/bw/libexec/apache/mod_headers.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_headers.so\nReading symbols from /opt/bw/libexec/apache/mod_setenvif.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_setenvif.so\nReading symbols from /opt/bw/libexec/apache/mod_mime.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_mime.so\nReading symbols from /opt/bw/libexec/apache/mod_autoindex.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_autoindex.so\nReading symbols from /opt/bw/libexec/apache/mod_negotiation.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_negotiation.so\nReading symbols from /opt/bw/libexec/apache/mod_dir.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_dir.so\nReading symbols from /opt/bw/libexec/apache/mod_alias.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_alias.so\nReading symbols from /opt/bw/libexec/apache/mod_rewrite.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_rewrite.so\nReading symbols from /opt/bw/libexec/apache/mod_proxy.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_proxy.so\nReading symbols from /opt/bw/libexec/apache/mod_proxy_http.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_proxy_http.so\nReading symbols from /opt/bw/libexec/apache/mod_proxy_connect.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_proxy_connect.so\nReading symbols from /opt/bw/libexec/apache/mod_deflate.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_deflate.so\nReading symbols from /opt/bw/libexec/apache/mod_log_config.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_log_config.so\nReading symbols from /opt/bw/libexec/apache/mod_ssl.so...done.\nLoaded symbols for /opt/bw/libexec/apache/mod_ssl.so\nBFD: /lib/libgcc_s.so.1: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\nError while reading shared library symbols:\n\"/lib/libgcc_s.so.1\": can't read symbols: File format not recognized.\nBFD: /lib64/ld-linux-x86-64.so.2: don't know how to handle OS specific section `.gnu.hash' [0x6ffffff6]\n\nwarning: Unable to grok dynamic linker /lib64/ld-linux-x86-64.so.2 as an object file\n\n\nwarning: Unable to find dynamic linker breakpoint function.\nGDB will be unable to debug shared library initializers\nand track explicitly loaded dynamic code.\nap_http_outerror_filter (f=0xb67220, b=0xb68180) at http_filters.c:1605\n1605    http_filters.c: No such file or directory.\n        in http_filters.c\n(gdb) bt\n#0  ap_http_outerror_filter (f=0xb67220, b=0xb68180) at http_filters.c:1605\n#1  0x000000000044176b in ap_http_header_filter (f=0xb671f8, b=0xb68180) at http_filters.c:1302\n#2  0x0000000000428cfe in ap_content_length_filter (f=0xb671d0, b=0xb68180) at protocol.c:1338\n#3  0x0000000000442c34 in ap_byterange_filter (f=0xb671a8, bb=0xb68180) at byterange_filter.c:177\n#4  0x00002b2050b03199 in deflate_out_filter (f=0xb67a28, bb=0xb68180) at mod_deflate.c:486\n#5  0x00002b20506f8f41 in ap_proxy_http_process_response (p=0xb5dc28, r=0xb65cd8, backend=0xd164d8, origin=0xcd8798, conf=0x8571d8,\n    server_portstr=0x45809da0 \"\") at mod_proxy_http.c:1763\n#6  0x00002b20506fb06e in proxy_http_handler (r=0xb65cd8, worker=<value optimized out>, conf=0x8571d8,\n    url=0xb67db8 \"/blog/contents/2008/June/thafirst520/bocage_closer/thumbnails/i400.jpg\", proxyname=0x0, proxyport=<value optimized out>)\n    at mod_proxy_http.c:1953\n#7  0x00002b20504e7fe0 in proxy_run_scheme_handler (r=0xb65cd8, worker=0x8573a8, conf=0x8571d8,\n    url=0xb679be \"http://127.0.0.1:8006/blog/contents/2008/June/thafirst520/bocage_closer/thumbnails/i400.jpg\", proxyhost=0x0,\n    proxyport=<value optimized out>) at mod_proxy.c:2345\n#8  0x00002b20504ec07c in proxy_handler (r=0xb65cd8) at mod_proxy.c:969\n#9  0x00000000004332c9 in ap_run_handler (r=0xb65cd8) at config.c:157\n#10 0x00000000004363ac in ap_invoke_handler (r=0xb65cd8) at config.c:372\n#11 0x00000000004406e8 in ap_process_request (r=0xb65cd8) at http_request.c:258\n#12 0x000000000043db8c in ap_process_http_connection (c=0xb5dec0) at http_core.c:190\n#13 0x0000000000439f61 in ap_run_process_connection (c=0xb5dec0) at connection.c:43\n#14 0x0000000000445026 in worker_thread (thd=0x7f1c88, dummy=<value optimized out>) at worker.c:544\n#15 0x00002b204be24017 in ?? ()\n#16 0x0000000000000000 in ?? ()\n(gdb) bt full\n#0  ap_http_outerror_filter (f=0xb67220, b=0xb68180) at http_filters.c:1605\n        r = (request_rec *) 0xb65cd8\n        ctx = (outerror_filter_ctx_t *) 0xd750c8\n        e = (apr_bucket *) 0xbc3e98\n#1  0x000000000044176b in ap_http_header_filter (f=0xb671f8, b=0xb68180) at http_filters.c:1302\n        r = (request_rec *) 0xb65cd8\n        c = (conn_rec *) 0xb5dec0\n        clheader = <value optimized out>\n        protocol = 0x449833 \"HTTP/1.1\"\n        e = <value optimized out>\n        b2 = (apr_bucket_brigade *) 0xd74e88\n        h = {pool = 0xb65c68, bb = 0xd74e88}\n        ctx = (header_filter_ctx *) 0x0\n        ctype = 0x200 <Address 0x200 out of bounds>\n        eb = <value optimized out>\n#2  0x0000000000428cfe in ap_content_length_filter (f=0xb671d0, b=0xb68180) at protocol.c:1338\n        split = (apr_bucket_brigade *) 0xb671a8\n        flush = <value optimized out>\n        len = 206158430256\n        ignored = 0x2b204f4b8032 \"H\\205\ufffdu\ufffd\ufffd4\ufffd\ufffd\ufffdI\\213u\\bH\\213|$\\020\ufffdf\ufffd\ufffd\ufffdH\\205\ufffdI\\211\ufffd\\017\\205\ufffd\"\n        rv = 7702\n        r = (request_rec *) 0xb65cd8\n        ctx = (struct content_length_ctx *) 0xd74e00\n        e = <value optimized out>\n        eblock = 14110920\n#3  0x0000000000442c34 in ap_byterange_filter (f=0xb671a8, bb=0xb68180) at byterange_filter.c:177\n        r = (request_rec *) 0xb65cd8\n        c = (conn_rec *) 0xb5dec0\n        e = <value optimized out>\n        bsend = <value optimized out>\n        range_start = <value optimized out>\n        range_end = <value optimized out>\n        current = <value optimized out>\n        clength = 7702\n        rv = <value optimized out>\n        found = <value optimized out>\n        num_ranges = <value optimized out>\n#4  0x00002b2050b03199 in deflate_out_filter (f=0xb67a28, bb=0xb68180) at mod_deflate.c:486\n        tmp = 0x1e16 <Address 0x1e16 out of bounds>\n        token = <value optimized out>\n        encoding = 0x0\n        e = <value optimized out>\n        r = (request_rec *) 0xb65cd8\n        ctx = (deflate_ctx *) 0x0\n        zRC = 0\n        c = (deflate_filter_config *) 0x6e7280\n#5  0x00002b20506f8f41 in ap_proxy_http_process_response (p=0xb5dc28, r=0xb65cd8, backend=0xd164d8, origin=0xcd8798, conf=0x8571d8,\n    server_portstr=0x45809da0 \"\") at mod_proxy_http.c:1763\n        readbytes = 7702\n        rv = <value optimized out>\n        mode = <value optimized out>\n        finish = 0\n        c = (conn_rec *) 0xb5dec0\n        buffer = \"\\000\\nntent-Type\\000 image/jpeg\\000\\n=100\\000\\n\\\"\\000\\n20:31 GMT\\000\\nt\\000\\n.php\\000\\n\\000\ufffd\\215\ufffd\\000\\000\\000\\000\\000X\\216\ufffd\\000\\000\\000\\000\\000\\200\\t.J +\\000\\000\\000\ufffdA\", '\\0' <repeats 13 times>, \"\\001\\000\\000\\000\\000\\000\\000\\000\\023\ufffd|K +\\000\\000\ufffd\\215\ufffd\\000\\000\\000\\000\\000X\\216\ufffd\\000\\000\\000\\000\\000\ufffd\\215\ufffd\\000\\000\\000\\000\\000\ufffd\\215\ufffd\\000\\000\\000\\000\\000\\230<\ufffd\\000\\000\\000\\000\\000\ufffd\\027.J +\\000\\000\ufffd\\207\ufffd\\000\\000\\000\\000\\000g\ufffd/L +\\000\\000`-\ufffd\\000\\000\\000\\000\\000\\001\\000\\000\\000\\000\\000\\000\\000\ufffd\\000\\000\\000\\000\\000\ufffd\\236\\200\"...\n        buf = <value optimized out>\n        keepchar = <value optimized out>\n        rp = (request_rec *) 0xb61f18\n        e = <value optimized out>\n        bb = (apr_bucket_brigade *) 0xb68180\n        tmp_bb = (apr_bucket_brigade *) 0xb681a0\n        len = 15\n        backasswards = <value optimized out>\n        interim_response = 0\n        pread_len = 0\n        save_table = (apr_table_t *) 0xb63858\n        backend_broke = 0\n        te = 0x0\n        hop_by_hop_hdrs = {0x2b20506fc44f \"Keep-Alive\", 0x2b20506fc77c \"Proxy-Authenticate\", 0x2b20506fc65a \"TE\", 0x2b20506fc65d \"Trailer\",\n  0x2b20506fc665 \"Upgrade\", 0x0}\n#6  0x00002b20506fb06e in proxy_http_handler (r=0xb65cd8, worker=<value optimized out>, conf=0x8571d8,\n    url=0xb67db8 \"/blog/contents/2008/June/thafirst520/bocage_closer/thumbnails/i400.jpg\", proxyname=0x0, proxyport=<value optimized out>)\n    at mod_proxy_http.c:1953\n        data = 0x45809ef0 \"xz\ufffd\"\n        bytes_read = 0\n        bytes_written = 1166056976\n        status = 0\n        server_portstr = \"\\000\\000\\000\\0000\\000\\000\\000\ufffd\\236\\200E\\000\\000\\000\\000\ufffd\\235\\200E\\000\\000\\000\\0000\\236\\200E\\000\\000\\000\"\n        scheme = <value optimized out>\n        proxy_function = 0x2b20506fc5b8 \"HTTP\"\n        backend = (proxy_conn_rec *) 0xd164d8\n        is_ssl = 0\n        p = (apr_pool_t *) 0xb5dc28\n        uri = <value optimized out>\n#7  0x00002b20504e7fe0 in proxy_run_scheme_handler (r=0xb65cd8, worker=0x8573a8, conf=0x8571d8,\n    url=0xb679be \"http://127.0.0.1:8006/blog/contents/2008/June/thafirst520/bocage_closer/thumbnails/i400.jpg\", proxyhost=0x0,\n    proxyport=<value optimized out>) at mod_proxy.c:2345\n        n = 0\n        rv = <value optimized out>\n#8  0x00002b20504ec07c in proxy_handler (r=0xb65cd8) at mod_proxy.c:969\n        url = 0xb679be \"http://127.0.0.1:8006/blog/contents/2008/June/thafirst520/bocage_closer/thumbnails/i400.jpg\"\n        uri = 0xb679be \"http://127.0.0.1:8006/blog/contents/2008/June/thafirst520/bocage_closer/thumbnails/i400.jpg\"\n        scheme = 0xb67a78 \"http\"\n        p = 0x4 <Address 0x4 out of bounds>\n        p2 = 0xb5df40 \"\\230\ufffd\"\n        conf = (proxy_server_conf *) 0x8571d8\n        proxies = (apr_array_header_t *) 0x8572a8\n        i = 7172792\n        access_status = 0\n        direct_connect = <value optimized out>\n        str = <value optimized out>\n        maxfwd = <value optimized out>\n        balancer = (proxy_balancer *) 0x0\n        worker = (proxy_worker *) 0x8573a8\n        attempts = 0\n        max_attempts = 0\n#9  0x00000000004332c9 in ap_run_handler (r=0xb65cd8) at config.c:157\n        n = 0\n        rv = 11960712\n#10 0x00000000004363ac in ap_invoke_handler (r=0xb65cd8) at config.c:372\n        handler = 0x861568 \"\\200\ufffdC\"\n        result = 0\n        old_handler = 0x2b20504f22b5 \"proxy-server\"\n        ignore = <value optimized out>\n#11 0x00000000004406e8 in ap_process_request (r=0xb65cd8) at http_request.c:258\n        access_status = 1246708896\n#12 0x000000000043db8c in ap_process_http_connection (c=0xb5dec0) at http_core.c:190\n        r = (request_rec *) 0xb65cd8\n        csd = (apr_socket_t *) 0xb5dca8\n#13 0x0000000000439f61 in ap_run_process_connection (c=0xb5dec0) at connection.c:43\n        n = 0\n        rv = 11960712\n#14 0x0000000000445026 in worker_thread (thd=0x7f1c88, dummy=<value optimized out>) at worker.c:544\n        process_slot = 1\n        thread_slot = 9\n        csd = (apr_socket_t *) 0xb5dca8\n        bucket_alloc = (apr_bucket_alloc_t *) 0xbcddd8\n        last_ptrans = <value optimized out>\n        ptrans = (apr_pool_t *) 0xb5dc28\n        rv = <value optimized out>\n        is_idle = <value optimized out>\n#15 0x00002b204be24017 in ?? ()\nNo symbol table info available.\n#16 0x0000000000000000 in ?? ()\nNo symbol table info available.\n(gdb)", "id": 118381, "time": "2008-07-08T02:16:06Z", "bug_id": 45362, "creation_time": "2008-07-08T02:16:06Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 45362, "is_private": false, "id": 118389, "attachment_id": null, "creator": "rpluem@apache.org", "creation_time": "2008-07-08T06:17:04Z", "time": "2008-07-08T06:17:04Z", "text": "Can you please step further through with gdb to see the limits of the loop (so where we are really looping on)?"}, {"text": "I have now managed to draw a couple of (22 so far) backtraces of the running processes or rather LWPs. But I have not managed to get a 'next':\n\nfor lwppid in $( ps -Lef | grep -v grep | grep $( < /var/opt/bw/apache/proxy/proxy.pid )| awk '{print $4}' | xargs ); do  gdb --batch --eval-command=\"where\" -ex \"bt full\" --pid=$lwppid /opt/bw/bin/httpd-worker > $lwppid.$(date +\"%Y%m%d%H%M%S\") 2>/dev/null; done\n\n\nSome of the backtraces for the same LWP are equal, which shows that the state doesn't change for a very long time.\nI'm not quite sure how to proceede next, if I shouldn't just upload the stacktraces. NEEDINFO.", "tags": [], "bug_id": 45362, "is_private": false, "count": 2, "id": 118401, "time": "2008-07-08T14:25:07Z", "creator": "i.galic@brainsware.org", "creation_time": "2008-07-08T14:25:07Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "i.galic@brainsware.org", "attachment_id": null, "id": 118402, "time": "2008-07-08T14:32:27Z", "bug_id": 45362, "creation_time": "2008-07-08T14:32:27Z", "is_private": false, "text": "An additional info from my side:\n  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+   PPID WCHAN     COMMAND\n24151 www       25   0  168m  26m  19m R 97.7  1.3 232:08.94 17149 stext     httpd-worker\n\nThis thread has now been for quite a long time in this very same state (it's currently my main source of backtraces and frustration)."}, {"count": 4, "tags": [], "creator": "rpluem@apache.org", "text": "Can you try to trace the rogue process with ltrace?", "id": 118404, "time": "2008-07-08T23:45:07Z", "bug_id": 45362, "creation_time": "2008-07-08T23:45:07Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 45362, "attachment_id": null, "text": "Updates: After rpluem asked me to ltrace, I tried, but failed in achieving anything meaningful. ltracing the parent I'm getting stuff like:\n              \n11:21:25.046949 SYS_wait4(-1, 0x7fff60c1555c, 3, 0, 0x667168)                                    = 0\n11:21:25.047094 <... apr_proc_wait_all_procs resumed> )                                          = 70006\n11:21:25.047157 apr_sleep(0xf4240, 0x7fff60c1555c, 70006, -1, 0x667168 <unfinished ...>\n11:21:25.047260 SYS_select(0, 0, 0, 0, 0x7fff60c15570)                                           = 0\n11:21:26.046765 <... apr_sleep resumed> )                                                        = 0\n11:21:26.046874 apr_proc_wait_all_procs(0x7fff60c15690, 0x7fff60c156b8, 0x7fff60c156bc, 1, 0x667168 <unfinished ...>\n11:21:26.046997 SYS_wait4(-1, 0x7fff60c1555c, 3, 0, 0x667168)                                    = 0\n11:21:26.047141 <... apr_proc_wait_all_procs resumed> )                                          = 70006\n11:21:26.047204 apr_sleep(0xf4240, 0x7fff60c1555c, 70006, -1, 0x667168 <unfinished ...>\n11:21:26.047307 SYS_select(0, 0, 0, 0, 0x7fff60c15570)                                           = 0\n11:21:27.046849 <... apr_sleep resumed> )                                                        = 0\n11:21:27.046950 apr_proc_wait_all_procs(0x7fff60c15690, 0x7fff60c156b8, 0x7fff60c156bc, 1, 0x667168 <unfinished ...>\n11:21:27.047068 SYS_wait4(-1, 0x7fff60c1555c, 3, 0, 0x667168)                                    = 0\n11:21:27.047230 <... apr_proc_wait_all_procs resumed> )                                          = 70006\n11:21:27.047296 apr_sleep(0xf4240, 0x7fff60c1555c, 70006, -1, 0x667168 <unfinished ...>\n11:21:27.047402 SYS_select(0, 0, 0, 0, 0x7fff60c15570)                                           = 0\n11:21:28.046897 <... apr_sleep resumed> )                                                        = 0\n11:21:28.047003 apr_proc_wait_all_procs(0x7fff60c15690, 0x7fff60c156b8, 0x7fff60c156bc, 1, 0x667168 <unfinished ...>\n11:21:28.047126 SYS_wait4(-1, 0x7fff60c1555c, 3, 0, 0x667168)                                    = 0\n11:21:28.047273 <... apr_proc_wait_all_procs resumed> )                                          = 70006\n11:21:28.047335 apr_sleep(0xf4240, 0x7fff60c1555c, 70006, -1, 0x667168 <unfinished ...>\n11:21:28.047439 SYS_select(0, 0, 0, 0, 0x7fff60c15570)                                           = 0\n11:21:29.046945 <... apr_sleep resumed> )                                                        = 0\n11:21:29.047046 apr_proc_wait_all_procs(0x7fff60c15690, 0x7fff60c156b8, 0x7fff60c156bc, 1, 0x667168 <unfinished ...>\n11:21:29.047164 SYS_wait4(-1, 0x7fff60c1555c, 3, 0, 0x667168)                                    = 0\n11:21:29.047323 <... apr_proc_wait_all_procs resumed> )                                          = 70006\n11:21:29.047389 apr_sleep(0xf4240, 0x7fff60c1555c, 70006, -1, 0x667168 <unfinished ...>\n11:21:29.047492 SYS_select(0, 0, 0, 0, 0x7fff60c15570)                                           = 0\n\nwhich seems natural.\nNow, if I try to ltrace a LWP, I'm hitting a limitation of ltrace itself: http://lists.alioth.debian.org/pipermail/ltrace-devel/2006-April/000039.html\n\n\nAfter ca 36~ hours of runtime: I finally got: \n\ntop - 12:16:45 up 96 days, 20:11,  4 users,  load average: 0.00, 0.01, 0.25\nTasks: 253 total,   2 running, 219 sleeping,  30 stopped,   2 zombie\nCpu(s):  0.0%us,  0.3%sy,  0.0%ni, 99.7%id,  0.0%wa,  0.0%hi,  0.0%si,  0.0%st\nMem:   2097152k total,  1903600k used,   193552k free,   299744k buffers\nSwap:  2097144k total,    18924k used,  2078220k free,  1072724k cached\n\n  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+   PPID nDRT WCHAN     COMMAND\n24125 www       15   0  168m  26m  19m T  0.0  1.3   0:00.00 17149    0 finish_st httpd-worker\n24151 www       18   0  168m  26m  19m T  0.0  1.3 845:53.74 17149    0 finish_st httpd-worker\n 5136 www       18   0  345m  11m 2728 T  0.0  0.6   0:00.00 17149    0 finish_st httpd-worker\n 5138 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.13 17149    0 finish_st httpd-worker\n 5139 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.10 17149    0 finish_st httpd-worker\n 5140 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.12 17149    0 finish_st httpd-worker\n 5141 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.13 17149    0 finish_st httpd-worker\n 5142 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.10 17149    0 finish_st httpd-worker\n 5143 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.08 17149    0 finish_st httpd-worker\n 5144 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.08 17149    0 finish_st httpd-worker\n 5145 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.08 17149    0 finish_st httpd-worker\n 5146 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.07 17149    0 finish_st httpd-worker\n 5147 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.60 17149    0 finish_st httpd-worker\n 5148 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.11 17149    0 finish_st httpd-worker\n 5149 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.15 17149    0 finish_st httpd-worker\n 5150 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.11 17149    0 finish_st httpd-worker\n 5151 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.11 17149    0 finish_st httpd-worker\n 5152 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.12 17149    0 finish_st httpd-worker\n 5153 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.10 17149    0 finish_st httpd-worker\n 5154 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.14 17149    0 finish_st httpd-worker\n 5155 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.14 17149    0 finish_st httpd-worker\n 5156 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.16 17149    0 finish_st httpd-worker\n 5157 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.15 17149    0 finish_st httpd-worker\n 5158 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.08 17149    0 finish_st httpd-worker\n 5159 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.13 17149    0 finish_st httpd-worker\n 5160 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.12 17149    0 finish_st httpd-worker\n 5161 www       18   0  345m  11m 2728 T  0.0  0.6  51:08.45 17149    0 finish_st httpd-worker\n 5162 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.10 17149    0 finish_st httpd-worker\n 5163 www       15   0  345m  11m 2728 T  0.0  0.6   0:00.21 17149    0 finish_st httpd-worker\n 5902 www       17   0     0    0    0 Z  0.0  0.0   0:04.58 17149    0 exit      httpd-worker <defunct>\n 6251 www       17   0     0    0    0 Z  0.0  0.0   0:00.21 17149    0 exit      httpd-worker <defunct>\n\n\nNo longer LISTENing (according to netstat), not reacting to apachectl stop, or kill for that matter. I had to kill -9 it.\n", "id": 118440, "time": "2008-07-10T02:14:48Z", "creator": "i.galic@brainsware.org", "creation_time": "2008-07-10T02:14:48Z", "is_private": false}, {"count": 6, "tags": [], "creator": "i.galic@brainsware.org", "text": "updates!\nI have managed to reproduce the bug with mpm prefork (on the same system) -- and, to a certain extent with mpm worker (as of yet) on Open Solaris:\n\n\ntop - 16:32:13 up 102 days, 43 min,  3 users,  load average: 1.09, 1.16, 1.10\nTasks: 234 total,   3 running, 231 sleeping,   0 stopped,   0 zombie\nCpu(s): 99.7%us,  0.3%sy,  0.0%ni,  0.0%id,  0.0%wa,  0.0%hi,  0.0%si,  0.0%st\nMem:   2097152k total,  1970148k used,   127004k free,   307868k buffers\nSwap:  2097144k total,    18676k used,  2078468k free,  1198244k cached\n\n  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+   PPID nDRT WCHAN     COMMAND\n25675 www       25   0  122m  12m 9300 R 97.7  0.6  50:31.07 22818    0 stext     httpd-prefork\n27246 www       15   0  122m 5280 1536 S  0.0  0.3   0:00.03 22818    0 184466121 httpd-prefork\n27251 www       15   0  123m 6216 2356 S  0.0  0.3   0:00.09 22818    0 semtimedo httpd-prefork\n27286 www       15   0  122m 5268 1536 S  0.0  0.3   0:00.02 22818    0 360474278 httpd-prefork\n27287 www       15   0  123m 6424 2356 S  0.0  0.3   0:00.04 22818    0 semtimedo httpd-prefork\n27288 www       15   0  122m 5268 1536 S  0.0  0.3   0:00.00 22818    0 semtimedo httpd-prefork\n27290 www       15   0  123m 5512 1536 S  0.0  0.3   0:00.01 22818    0 semtimedo httpd-prefork\n27318 www       15   0  122m 5248 1536 S  0.0  0.3   0:00.00 22818    0 semtimedo httpd-prefork\n27344 www       15   0  122m 5096 1520 S  0.0  0.2   0:00.02 22818    0 semtimedo httpd-prefork\n27354 www       15   0  122m 5088 1520 S  0.0  0.2   0:00.00 22818    0 semtimedo httpd-prefork\n27356 www       15   0  123m 5392 1536 S  0.0  0.3   0:00.00 22818    0 semtimedo httpd-prefork\n27361 www       15   0  123m 5456 1532 S  0.0  0.3   0:00.00 22818    0 211816788 httpd-prefork\n\n\nOn Solaris I only have a zombified process (LWP), which won't go away unless killed -9, but it's not eating 80+ CPU:\n\n   PID USERNAME  SIZE   RSS STATE  PRI NICE      TIME  CPU PROCESS/LWPID\n 16635 webservd 9488K 3312K sleep   59    0   0:00:00 0.0% httpd-worker/23\n[/snip]\n 16635 webservd 9488K 3312K sleep   59    0   0:00:00 0.0% httpd-worker/3\n 16635 webservd 9488K 3312K zombie   0    -   0:00:00 0.0% httpd-worker/2\n 16635 webservd 9488K 3312K sleep   59    0   0:00:00 0.0% httpd-worker/1\n[/snip]\nTotal: 3 processes, 84 lwps, load averages: 0.02, 0.01, 0.01\n\n", "id": 118654, "time": "2008-07-14T09:34:08Z", "bug_id": 45362, "creation_time": "2008-07-14T09:34:08Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "creator": "chris@ia.gov", "attachment_id": null, "id": 121423, "time": "2008-10-10T12:38:17Z", "bug_id": 45362, "creation_time": "2008-10-10T12:38:17Z", "is_private": false, "text": "I'm experiencing the same symptoms as Igor (single httpd sucking up 90% cpu time) using 2.2.10 test release on Opensuse 10.3 x86_64 and have a couple of observations to add.\n\nI run worker in a pure reverse proxy scenario (built with included apr) with one major difference than Igor being that I do not use mod_deflate at all.\n\nFirst observation is that the out of control process had three sockets open and they were all in CLOSE_WAIT hoping to eventually be released.\n\nSecond observation is that after defining \"disablereuse on\" for every proxypass, the problem has not reoccurred.  In addition errors of the type \"(70014)End of file found: proxy: error reading status line from remote server\"  have disappeared.  \n\nHappy to provide any information that I can to help on this, just tell me what is needed.\n\n\n"}, {"count": 8, "tags": [], "text": "Has anyone found a fix for this?  We have the exact same problem with 2.2.9 and also 2.2.10.  I tried the workaround for disablereuse, but mod_proxy_balancer does not support this in the ProxyPass directive.  ", "is_private": false, "bug_id": 45362, "id": 121853, "time": "2008-10-24T09:08:18Z", "creator": "grodenhi@holycross.edu", "creation_time": "2008-10-24T09:08:18Z", "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 45362, "text": "I am experiencing similar problem on Win2K3 with Apache 2.2.8 and 2.2.11.  I am using mod_proxy and mod_rewrite where mod_rewrite enables the PROXY flag", "id": 128203, "attachment_id": null, "creator": "todd_643@yahoo.com", "creation_time": "2009-06-23T09:58:29Z", "time": "2009-06-23T09:58:29Z", "is_private": false}, {"count": 10, "tags": [], "creator": "peter.boros@vengit.com", "attachment_id": null, "id": 135748, "time": "2010-03-29T12:11:28Z", "bug_id": 45362, "creation_time": "2010-03-29T12:11:28Z", "is_private": false, "text": "We ran into this bug with apache 2.2.9 on Solaris 10. Here are the stack traces:\n# pstack 19235\n19235:  /opt/coolstack/apache2/bin/httpd -k start\n ff236b1c ???????? (dafa0, 87c88, 87c88, 455518, 1b7788, 87d50)\n fe2ec680 connection_cleanup (dafe0, dafe0, 7, 96bd0, 8fc20, 974c8) + 148\n fe2ed0a8 ap_proxy_release_connection (fe2c5fb8, dafe0, 97440, 10400, fe300a0c, 96bd0) + 4c\n fe2c5064 proxy_http_handler (fffffffe, dafe0, ec318, ffbf9694, fe2c5fb8, 1ac660) + 3e8\n fe2e508c proxy_handler (fe2c4c7c, fe3018b8, 1f78c8, fe2eec9c, ec3e0, ec318) + 728\n 0003fe60 ap_run_handler (1f78c8, 4, 826ac, 826c8, 9f330, 0) + 3c\n 00040478 ap_invoke_handler (1f78c8, 9f450, 0, 0, 0, fe2ee1c8) + e8\n 0004fcbc ap_process_request (0, 80000, 1f78c8, 0, 0, 1f78c8) + 54\n 0004ca68 ap_process_http_connection (1999e8, 1f78c8, 8fc20, 80000, 801b8, 80000000) + 6c\n 000482f8 ap_run_process_connection (1999e8, 199750, 9ef88, 82ee4, 9f760, 0) + 3c\n 0005505c child_main (22, 1999e8, 6b75c, 82f30, 803bc, 1) + 64c\n 000553b0 make_child (54400, 33, 0, 0, 34, 80000) + 13c\n 00055654 perform_idle_server_maintenance (80000, 57, 19, 803ac, 8337c, 4) + 1d0\n 00055d54 ap_mpm_run (80000, 0, ffffffff, 27, 803c4, 82f40) + 678\n 0002928c main     (8bdb0, ffbffd08, 8023c, 7f090, 64650, 7f080) + 9f4\n 00028378 _start   (0, 0, 0, 0, 0, 0) + 108\n\n# mdb -p 19235\n\nLoading modules: [ ld.so.1 libc.so.1 libuutil.so.1 ]\n> $C\nffbf9498 libapr-1.so.0.3.0`apr_thread_mutex_unlock+0xc(dafa0, 87c88, 87c88, 455518, 1b7788, 87d50)\nffbf94f8 mod_proxy.so`connection_cleanup+0x148(dafe0, dafe0, 7, 96bd0, 8fc20, 974c8)\nffbf9560 mod_proxy.so`ap_proxy_release_connection+0x4c(fe2c5fb8, dafe0, 97440, 10400, fe300a0c, 96bd0)\nffbf95c8 mod_proxy_http.so`proxy_http_handler+0x3e8(fffffffe, dafe0, ec318, ffbf9694, fe2c5fb8, 1ac660)\nffbf96b8 mod_proxy.so`proxy_handler+0x728(fe2c4c7c, fe3018b8, 1f78c8, fe2eec9c, ec3e0, ec318)\nffbf9790 httpd`ap_run_handler+0x3c(1f78c8, 4, 826ac, 826c8, 9f330, 0)\nffbf97f0 httpd`ap_invoke_handler+0xe8(1f78c8, 9f450, 0, 0, 0, fe2ee1c8)\nffbf9858 httpd`ap_process_request+0x54(0, 80000, 1f78c8, 0, 0, 1f78c8)\nffbf98b8 httpd`ap_process_http_connection+0x6c(1999e8, 1f78c8, 8fc20, 80000, 801b8, 80000000)\nffbf9920 httpd`ap_run_process_connection+0x3c(1999e8, 199750, 9ef88, 82ee4, 9f760, 0)\nffbf9980 httpd`child_main+0x64c(22, 1999e8, 6b75c, 82f30, 803bc, 1)\nffbf9a18 httpd`make_child+0x13c(54400, 33, 0, 0, 34, 80000)\nffbf9a78 httpd`perform_idle_server_maintenance+0x1d0(80000, 57, 19, 803ac, 8337c, 4)\nffbf9b78 httpd`ap_mpm_run+0x678(80000, 0, ffffffff, 27, 803c4, 82f40)\nffbf9c20 main+0x9f4(8bdb0, ffbffd08, 8023c, 7f090, 64650, 7f080)\nffbffd20 _start+0x108(0, 0, 0, 0, 0, 0)\n\nWe use apache in prefork mode. The apache process fully utilizes 1 cpu when it's stuck. If we disable connection reusing with disableReuse=On, then there are no stuck apache processes."}, {"count": 11, "tags": [], "creator": "trawick@apache.org", "text": "I think some of the problem symptoms described here were fixed in 2.2.11 for PR45792.\n\nhttp://svn.apache.org/viewvc?view=revision&revision=713146\n\nNote that one of the folks chiming in on this thread already had 2.2.11 at the time.\n\n(Apologies for claiming 2.2.14 earlier today in one of the httpd sessions at ApacheCon ;)   Some folks I support picked up the pool corruption/cleanup loop fix when *they* upgraded to 2.2.14.  I remembered incorrectly that 2.2.14 was the first release with the fix.)", "id": 141365, "time": "2010-11-03T14:51:52Z", "bug_id": 45362, "creation_time": "2010-11-03T14:51:52Z", "is_private": false, "attachment_id": null}, {"count": 12, "tags": [], "text": "After a month of runtime without running into this issue, I'm closing this ticket.", "is_private": false, "bug_id": 45362, "id": 142352, "time": "2010-12-03T18:59:03Z", "creator": "i.galic@brainsware.org", "creation_time": "2010-12-03T18:59:03Z", "attachment_id": null}, {"count": 13, "tags": [], "creator": "covener@gmail.com", "attachment_id": null, "id": 148462, "time": "2011-08-07T15:46:49Z", "bug_id": 45362, "creation_time": "2011-08-07T15:46:49Z", "is_private": false, "text": "*** Bug 45483 has been marked as a duplicate of this bug. ***"}]