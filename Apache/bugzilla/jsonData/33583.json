[{"count": 0, "attachment_id": null, "bug_id": 33583, "text": "Apache Ant version 1.6.2 compiled on July 16 2004\nJava version: 1.5\n\nI have a javac task that depends on init, if I delete all classes and compile\nthe task completes succesfully. if I modify the source code of a class then an\nerror, java.util.zip.ZipException: error in opening zip file\n, is thrown for each class that is unchanged.\n\nBuildfile: build.xml\n\ninit:\n\ncompile:\n    [javac] Compiling 1 source file to ../WEB-INF/classes\n    [javac] ../db/map/Event.java\n    [javac] error: error reading ../actions/EventAction.class;\njava.util.zip.ZipException: error in opening zip file\n    [javac] 1 error\n\nBUILD FAILED", "id": 70991, "time": "2005-02-15T12:02:07Z", "creator": "alex.scotti@email.it", "creation_time": "2005-02-15T12:02:07Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 33583, "attachment_id": null, "text": "Can it be that the ZIP file is locked by another process (for example by JBuilder)?", "id": 71023, "time": "2005-02-15T18:28:14Z", "creator": "alexeys@inventigo.com", "creation_time": "2005-02-15T18:28:14Z", "is_private": false}, {"count": 2, "attachment_id": null, "bug_id": 33583, "is_private": false, "id": 71072, "time": "2005-02-16T11:13:50Z", "creator": "alex.scotti@email.it", "creation_time": "2005-02-16T11:13:50Z", "tags": [], "text": "I don't know if a class file may be considered as a zip file, nor why the\nZipException is thrown reading the *.class files. Anyway no other process is\ninvolved. I'm working on a small laptop that has just java, tomcat and ant. I\nstop tomcat, call ant, restart tomcat.\n"}, {"count": 3, "attachment_id": null, "bug_id": 33583, "text": "It looks as if the jar file containing ../actions/EventAction.class was corrupt.\n\nWhat does \"jar tf that-jar-file\" say?\n", "id": 71164, "time": "2005-02-18T12:27:43Z", "creator": "bodewig@apache.org", "creation_time": "2005-02-18T12:27:43Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 33583, "attachment_id": null, "text": "The fileS that raise the error are ALL the class files that ant will not compile\nbecause nothing changed. These files are not corrupt since the web application\nworks fine.\njar -tf one-of-the-class-files exits with non messages.", "id": 71166, "time": "2005-02-18T13:06:26Z", "creator": "alex.scotti@email.it", "creation_time": "2005-02-18T13:06:26Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 33583, "is_private": false, "text": "One of the JARs on your CLASSPATH or the <classpath> of the <javac> task contains\nthe class - and this one seems to be corrupt.\n\nThe other reason I could imagine why a ZoException gets raised is that you have\nthe classes themselves, not your target directory on the classpath.\n\nWhat does your javac task look like?", "id": 71168, "time": "2005-02-18T13:28:05Z", "creator": "bodewig@apache.org", "creation_time": "2005-02-18T13:28:05Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 33583, "text": "...\n        <path id=\"sms-all-classes\">\n                <fileset dir=\"${bin}\">\n                        <include name=\"**/*.class\"/>\n                </fileset>\n\n                <fileset dir=\"${jakarta.home}\\common\">\n                        <include name=\"**/*.class\"/>\n                </fileset>\n                <fileset dir=\"${jakarta.home}\\server\">\n                        <include name=\"**/*.class\"/>\n                </fileset>\n                <fileset dir=\"${jakarta.home}\\shared\">\n                        <include name=\"**/*.class\"/>\n                </fileset>\n        </path>\n        <path id=\"sms-all-jars\">\n                <fileset dir=\"${lib}\">\n                        <include name=\"**/*.jar\"/>\n                </fileset>\n\n                <fileset dir=\"${jakarta.home}\\common\">\n                        <include name=\"**/*.jar\"/>\n                </fileset>\n                <fileset dir=\"${jakarta.home}\\server\">\n                        <include name=\"**/*.jar\"/>\n                </fileset>\n                <fileset dir=\"${jakarta.home}\\shared\">\n                        <include name=\"**/*.jar\"/>\n                </fileset>\n        </path>\n        <path id=\"sms-all\">\n                <path refid=\"sms-all-jars\"/>\n                <path refid=\"sms-all-classes\"/>\n        </path>\n\n        <target name=\"init\">\n                <tstamp/>\n        </target>\n\n        <target name=\"compile\" depends=\"init\">\n                <javac\n                        classpathref=\"sms-all\"\n                        srcdir=\"${src}\"\n                        destdir=\"${bin}\"\n                        listfiles=\"yes\"\n                />\n...\n", "id": 71170, "time": "2005-02-18T13:43:00Z", "creator": "alex.scotti@email.it", "creation_time": "2005-02-18T13:43:00Z", "is_private": false, "attachment_id": null}, {"count": 7, "attachment_id": null, "bug_id": 33583, "is_private": false, "id": 71174, "time": "2005-02-18T14:06:05Z", "creator": "peterreilly@apache.org", "creation_time": "2005-02-18T14:06:05Z", "tags": [], "text": "You are getting the exception because you are placing class files in\nthe classpath - for example at the command line:\njavac -cp classes/peter/Hello.class -d x -sourcepath src src/peter/Hello.java\nerror: error reading classes/peter/Hello.class; java.util.zip.ZipException:\nerror in opening zip file\n\nYou need to change the \"sms-all-classes\" to something like:\n<path id=\"sms-all-classes\">\n  <pathelement location=\"${bin}\"/>\n  <pathelement location=\"${jakarta.home}/common\"/>\n .. etc\n</path>\n"}]