[{"count": 0, "tags": [], "creator": "yneko@yamamaya.com", "attachment_id": null, "text": "mod_proxy of Apache 2.3 works well with connection pool and keepalive, but \nmod_proxy_balance does not works so well. Connections once used are pooled, but \nused only once, not reused.", "id": 87741, "time": "2006-04-11T06:43:27Z", "bug_id": 39267, "creation_time": "2006-04-11T06:43:27Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 39267, "attachment_id": null, "text": "I currently do not understand your problem. Could you reword it and describe it\nin more detail?", "id": 87804, "time": "2006-04-11T22:19:17Z", "creator": "rpluem@apache.org", "creation_time": "2006-04-11T22:19:17Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 39267, "attachment_id": null, "id": 87814, "time": "2006-04-12T00:25:34Z", "creator": "jim.robinson@stanford.edu", "creation_time": "2006-04-12T00:25:34Z", "is_private": false, "text": "(In reply to comment #0)\n> mod_proxy of Apache 2.3 works well with connection pool and keepalive, but \n> mod_proxy_balance does not works so well. Connections once used are pooled, but \n> used only once, not reused.\n\n\nIs there any chance you're seeing the same thing I discuss\non http://issues.apache.org/bugzilla/show_bug.cgi?id=38227 ?\n\nSpecifically, where I find that the worker's 'hmax' setting\ndoes not seem to be set by default on the balancer, thereby\ncausing the code to always allocate new connections?\n"}, {"count": 3, "tags": [], "text": "Following is the simple example. There are only 1 client, 1 proxy, 1 backend \nand 1 connection, to easy to understand.\nExample1 is the behavior of mod_proxy. It works perfectly with keepalive and \nconnection pool.\nExample2 is the most simple behavior of mod_proxy_balancer with only 1 backend \nserver. It does not reuse the connection however it can be reusable.\n\n################ Example1 ################\n## conf\nProxyRequests Off\nProxyPass / http://backend/ min=1 max=1\n\n## tcp packets (ACK packets are omitted)\nclient =====syn=====> proxy\nclient =====GET1====> proxy\n                      proxy =====syn=====> backend\n                      proxy =====GET1====> backend\n                      proxy <=====RES1==== backend\nclient <=====RES1==== proxy\nclient =====GET2====> proxy\n                      proxy =====GET2====> backend\n                      proxy <=====RES2==== backend\nclient <=====RES2==== proxy\n                        :\nclient <=====fin===== proxy (keepalive timeout)\n                        :\n                      proxy <=====fin===== backend (keepalive timeout)\n\n\n################ Example2 ################\n## conf\n<Proxy balancer://cluster/>\n    BalancerMember http://backend min=1 max=1\n</Proxy>\nProxyPass / balancer://cluster/\n\n## tcp packets (ACK packets are omitted)\nclient =====syn=====> proxy\nclient =====GET1====> proxy\n                      proxy =====syn=====> backend\n                      proxy =====GET1====> backend\n                      proxy <=====RES1==== backend\nclient <=====RES1==== proxy\nclient =====GET2====> proxy\n                      proxy =====fin=====> backend\n                      proxy =====syn=====> backend\n                      proxy =====GET2====> backend\n                      proxy <=====RES2==== backend\nclient <=====RES2==== proxy\n                        :\nclient <=====fin===== proxy (keepalive timeout)\n                        :\n                      proxy <=====fin===== backend (keepalive timeout)\n", "is_private": false, "id": 87815, "creator": "yneko@yamamaya.com", "time": "2006-04-12T02:50:39Z", "bug_id": 39267, "creation_time": "2006-04-12T02:50:39Z", "attachment_id": null}, {"count": 4, "tags": [], "text": "It seems that you are affected by what has been described in comment #14 and #15\n of PR38227. Please apply\nhttp://issues.apache.org/bugzilla/attachment.cgi?id=18055 and your problem\nshould be solved.", "attachment_id": null, "id": 88055, "creator": "rpluem@apache.org", "time": "2006-04-14T12:39:29Z", "bug_id": 39267, "creation_time": "2006-04-14T12:39:29Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 39267, "text": "Thank you. The latest version httpd_20060418221939 works almost well.\nBut I noticed, the first connection to backend server is discarded immediately. \nIt's not so serious problem, but I think it's not correct.", "id": 88249, "time": "2006-04-19T02:59:21Z", "creator": "yneko@yamamaya.com", "creation_time": "2006-04-19T02:59:21Z", "is_private": false, "attachment_id": null}, {"count": 6, "attachment_id": null, "creator": "rpluem@apache.org", "is_private": false, "id": 88298, "time": "2006-04-19T21:02:31Z", "bug_id": 39267, "creation_time": "2006-04-19T21:02:31Z", "tags": [], "text": "Hm, this is strange. I do not see this behaviour on my environment. Could you\nplease provide some more details (network sniffs)?"}, {"count": 7, "tags": [], "bug_id": 39267, "text": "Sorry. I had misunderstood it. The client uses 2 sessions to the proxy, the \nsecond session from client to proxy was processed by other child process of \nApache, and so I misunderstood it that the connection does not be reused.", "id": 88301, "time": "2006-04-20T00:47:46Z", "creator": "yneko@yamamaya.com", "creation_time": "2006-04-20T00:47:46Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "text": "\n\n*** This bug has been marked as a duplicate of 38227 ***", "attachment_id": null, "id": 88379, "creator": "rpluem@apache.org", "time": "2006-04-22T15:27:27Z", "bug_id": 39267, "creation_time": "2006-04-22T15:27:27Z", "is_private": false}]