[{"count": 0, "tags": [], "bug_id": 47261, "attachment_id": null, "is_private": false, "id": 127376, "time": "2009-05-25T06:33:50Z", "creator": "cvolozhin@pragmaticsoft.com", "creation_time": "2009-05-25T06:33:50Z", "text": "removeSlide method of SlideShow makes PPT corrupted.\nCheck code snippet below.\nWhen I try to open TestSlide_Empty.ppt in MS Powerpoint 2003, I catch \"PowerPoint was unable to display some og the text...\". error. See full error text in attached screenshot.\n\nCode snippet:\n\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\n\nimport org.apache.poi.hslf.model.Slide;\nimport org.apache.poi.hslf.usermodel.SlideShow;\n\npublic class POITest {\n\n    public static void main(String[] args) throws Exception {\n        \n        SlideShow ppt = new SlideShow(new FileInputStream(\"TestSlide.ppt\"));\n\n        Slide[] slides = ppt.getSlides();\n\n        for (int i = 0; i < slides.length; i++) {\n          ppt.removeSlide(0);\n        }\n        \n        FileOutputStream out = new FileOutputStream(\"TestSlide_Empty.ppt\");\n        ppt.write(out);\n        out.close();\n\n    }\n\n}"}, {"count": 1, "tags": [], "bug_id": 47261, "attachment_id": 23711, "id": 127377, "time": "2009-05-25T06:35:29Z", "creator": "cvolozhin@pragmaticsoft.com", "creation_time": "2009-05-25T06:35:29Z", "is_private": false, "text": "Created attachment 23711\nTestSlide.ppt"}, {"count": 2, "tags": [], "bug_id": 47261, "is_private": false, "text": "Created attachment 23712\nScreenshot", "id": 127378, "time": "2009-05-25T06:37:21Z", "creator": "cvolozhin@pragmaticsoft.com", "creation_time": "2009-05-25T06:37:21Z", "attachment_id": 23712}, {"count": 3, "tags": [], "bug_id": 47261, "is_private": false, "text": "Is this error with POI-3.2 FINAL or on the current trunk?\n\nWould you please describe your use case within your production.", "id": 128024, "time": "2009-06-17T07:08:05Z", "creator": "dfisher@jmlafferty.com", "creation_time": "2009-06-17T07:08:05Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 47261, "attachment_id": null, "is_private": false, "id": 128025, "time": "2009-06-17T07:14:21Z", "creator": "cvolozhin@pragmaticsoft.com", "creation_time": "2009-06-17T07:14:21Z", "text": "(In reply to comment #3)\n> Is this error with POI-3.2 FINAL or on the current trunk?\n> \n> Would you please describe your use case within your production.\n\nOn trunk and on 3.2.\nI use this method to remove slides."}, {"count": 5, "text": "Should be fixed in r786501. PowerPoint wasn't happy to find orphan references to notes belonging to the deleted slide. \n\nP.S. PowerPoint 2007 silently ignored this bug, the alert was only in PowerPoint 2003 and older.\n\nYegor", "creator": "yegor@dinom.ru", "attachment_id": null, "id": 128092, "time": "2009-06-19T06:27:28Z", "bug_id": 47261, "creation_time": "2009-06-19T06:27:28Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "bug_id": 47261, "is_private": false, "text": "Created attachment 23844\nAnother PPT\n\nThanks for quick feedback, Yegor,\nbut bug still here.\nI have attached another PPT, that still causes error.\nCould you check please?\nUse the same code snippet.", "id": 128137, "time": "2009-06-22T03:20:22Z", "creator": "cvolozhin@pragmaticsoft.com", "creation_time": "2009-06-22T03:20:22Z", "attachment_id": 23844}, {"count": 7, "tags": [], "bug_id": 47261, "attachment_id": null, "text": "Should be fixed in r788948. There was a typo that prevented deletion of slide's notes. \n\nRegards,\nYegor", "id": 128335, "time": "2009-06-27T03:27:04Z", "creator": "yegor@dinom.ru", "creation_time": "2009-06-27T03:27:04Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 47261, "attachment_id": 24364, "id": 130971, "time": "2009-10-08T04:04:49Z", "creator": "cvolozhin@pragmaticsoft.com", "creation_time": "2009-10-08T04:04:49Z", "is_private": false, "text": "Created attachment 24364\nPowerPoint file\n\nCode snippet:\n\nimport java.io.FileInputStream;\n\nimport org.apache.poi.hslf.model.Slide;\nimport org.apache.poi.hslf.usermodel.SlideShow;\n\npublic class POITest {\n\n    public static void main(String[] args) throws Exception {\n        \n        SlideShow ppt = new SlideShow(new FileInputStream(\"tt2.ppt\"));\n\n        Slide[] slides = ppt.getSlides();\n\n        for (int i = 0; i < slides.length; i++) {\n          ppt.removeSlide(0);\n        }\n\n        Slide newSlide = ppt.createSlide();\n\n    }\n\n}\n\nThis code generates following error:\n\nException in thread \"main\" java.lang.IllegalStateException: The last child record of a Document should be EndDocument, but it was org.apache.poi.hslf.record.UnknownRecordPlaceholder@12d96f2\n\tat org.apache.poi.hslf.record.Document.addSlideListWithText(Document.java:179)\n\tat org.apache.poi.hslf.usermodel.SlideShow.createSlide(SlideShow.java:700)\n\tat POITest.main(POITest.java:19)\n\nWith removeSlide commented works ok.\ntt2.ppt attached (file received from our customer)"}, {"count": 9, "tags": [], "bug_id": 47261, "attachment_id": null, "text": "comment #8", "id": 130972, "time": "2009-10-08T04:05:53Z", "creator": "cvolozhin@pragmaticsoft.com", "creation_time": "2009-10-08T04:05:53Z", "is_private": false}, {"count": 10, "tags": [], "bug_id": 47261, "attachment_id": null, "text": "Constantin,\n\nPlease don't abuse Bugzilla. Changing the priority of a bug to Blocker will not help us to fix it sooner. \nIf you are really interested in fixing this bug - you are welcome to do a research and figure out which bits in the PPT format are broken. If you need a guidance, please ask, I will be happy to help.\n\nYegor", "id": 134492, "time": "2010-02-14T17:09:22Z", "creator": "yegor@dinom.ru", "creation_time": "2010-02-14T17:09:22Z", "is_private": false}, {"count": 11, "text": "Fix applied with r1648458\nAlthough saving a PPT without slides doesn't make sense, there was a problem with an optional RoundTripCustomTableStyles12Atom, which occured when all slides were removed and new slides created afterwards - this is fixed now.", "bug_id": 47261, "is_private": false, "id": 180069, "time": "2014-12-30T01:08:10Z", "creator": "kiwiwings@apache.org", "creation_time": "2014-12-30T01:08:10Z", "tags": [], "attachment_id": null}]