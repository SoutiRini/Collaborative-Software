[{"count": 0, "tags": [], "creator": "pete@geekpete.com", "is_private": false, "text": "Subject: context path has first character removed on deploy of war file causing failed deployment\n\nExcerpt from server.xml:\n\n        <Context path=\"testapp\" docBase=\"testapp\" allowLinking=\"true\"\n            reloadable=\"true\" >\n\nUpon starting tomcat, the war file is exploded and two directories\nare created inside the deploy directory where the testapp.war resides:\nestapp/\ntestapp/\n\nCatalina.out shows:\n\n28/04/2010 11:08:58 AM org.apache.catalina.core.AprLifecycleListener init\nINFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: /apps/jre1.6.0_20/lib/i386/client:/apps/jre1.6.0_20/lib/i386:/apps/jre1.6.0_20/../lib/i386:/usr/java/packages/lib/i386:/lib:/usr/lib\n28/04/2010 11:08:59 AM org.apache.coyote.http11.Http11Protocol init\nINFO: Initializing Coyote HTTP/1.1 on http-8480\n28/04/2010 11:08:59 AM org.apache.catalina.startup.Catalina load\nINFO: Initialization processed in 475 ms\n28/04/2010 11:08:59 AM org.apache.catalina.core.StandardService start\nINFO: Starting service Catalina\n28/04/2010 11:08:59 AM org.apache.catalina.core.StandardEngine start\nINFO: Starting Servlet Engine: Apache Tomcat/6.0.26\n28/04/2010 11:09:00 AM org.apache.catalina.core.ApplicationContext log\nINFO: Set web app root system property: 'webapp.root' = [/data/tomcat/testapp/deploy/estapp/]\nlog4j:WARN No appenders could be found for logger (org.springframework.web.servlet.DispatcherServlet).\nlog4j:WARN Please initialize the log4j system properly.\n28/04/2010 11:09:00 AM org.apache.catalina.core.ApplicationContext log\nINFO: Initializing Spring FrameworkServlet 'testapp'\n28/04/2010 11:09:01 AM org.apache.catalina.startup.HostConfig deployWAR\nINFO: Deploying web application archive testapp.war\n28/04/2010 11:09:02 AM org.apache.catalina.core.StandardContext listenerStart\nSEVERE: Exception sending context initialized event to listener instance of class org.springframework.web.util.Log4jConfigListener\njava.lang.IllegalStateException: Web app root system property already set to different value: 'webapp.root' = [/data/tomcat/testapp/deploy/estapp/] instead of [/data/tomcat/testapp/deploy/testapp/] - Choose unique values for the 'webAppRootKey' context-param in your web.xml files!\n        at org.springframework.web.util.WebUtils.setWebAppRootSystemProperty(WebUtils.java:146)\n        at org.springframework.web.util.Log4jWebConfigurer.initLogging(Log4jWebConfigurer.java:118)\n        at org.springframework.web.util.Log4jConfigListener.contextInitialized(Log4jConfigListener.java:47)\n        at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:3972)\n        at org.apache.catalina.core.StandardContext.start(StandardContext.java:4467)\n        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:791)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:771)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:546)\n        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:905)\n        at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:740)\n        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:500)\n        at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1277)\n        at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:321)\n        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)\n        at org.apache.catalina.core.StandardHost.start(StandardHost.java:785)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)\n        at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)\n        at org.apache.catalina.core.StandardService.start(StandardService.java:519)\n        at org.apache.catalina.core.StandardServer.start(StandardServer.java:710)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:581)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n        at java.lang.reflect.Method.invoke(Unknown Source)\n        at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)\n28/04/2010 11:09:02 AM org.apache.catalina.core.StandardContext start\nSEVERE: Error listenerStart\n28/04/2010 11:09:02 AM org.apache.catalina.core.StandardContext start\nSEVERE: Context [/testapp] startup failed due to previous errors\n28/04/2010 11:09:02 AM org.apache.catalina.core.ApplicationContext log\nINFO: Shutting down log4j\n28/04/2010 11:09:02 AM org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory ROOT\n28/04/2010 11:09:02 AM org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory estapp\n28/04/2010 11:09:02 AM org.apache.catalina.core.ApplicationContext log\nINFO: Set web app root system property: 'webapp.root' = [/data/tomcat/testapp/deploy/estapp/]\nlog4j:WARN No appenders could be found for logger (org.springframework.web.servlet.DispatcherServlet).\nlog4j:WARN Please initialize the log4j system properly.\n28/04/2010 11:09:02 AM org.apache.catalina.core.ApplicationContext log\nINFO: Initializing Spring FrameworkServlet 'testapp'\n28/04/2010 11:09:04 AM org.apache.coyote.http11.Http11Protocol start\nINFO: Starting Coyote HTTP/1.1 on http-8480\n28/04/2010 11:09:04 AM org.apache.jk.common.ChannelSocket init\nINFO: JK: ajp13 listening on /0.0.0.0:8409\n28/04/2010 11:09:04 AM org.apache.jk.server.JkMain start\nINFO: Jk running ID=0 time=0/15  config=null\n28/04/2010 11:09:04 AM org.apache.catalina.startup.Catalina start\nINFO: Server startup in 5004 ms\n\n\nThere is no context defined inside the war file, which worked on a previous RHEL/tomcat/java version combination.\n\nThis issue occurs with:\n\nOS: Red Hat Enterprise Linux Server release 5.5 (Tikanga)\nKernel: Linux tomcatserver1.internal 2.6.18-194.el5 #1 SMP Tue Mar 16 21:52:43 EDT 2010 i686 i686 i386 GNU/Linux\nJava: jre1.6.0_20\nTomcat: apache-tomcat-6.0.26", "id": 136470, "time": "2010-04-27T21:39:55Z", "bug_id": 49205, "creation_time": "2010-04-27T21:39:55Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 49205, "is_private": false, "count": 1, "id": 136471, "time": "2010-04-27T21:59:23Z", "creator": "pete@geekpete.com", "creation_time": "2010-04-27T21:59:23Z", "text": "My current workaround is to use this configuration in my server.xml:\n\n\n        <Context path=\"xtestapp\" docBase=\"testapp\" allowLinking=\"true\"\n            reloadable=\"true\" >\n\nThe leading \"x\" is removed as per the bug and the correct context is then in place with no errors shown in Catalina.out. There is also only one correct exploded war directory of \"testapp\" inside the deploy directory."}, {"count": 2, "tags": [], "bug_id": 49205, "attachment_id": null, "id": 136508, "time": "2010-04-28T20:25:05Z", "creator": "markt@apache.org", "creation_time": "2010-04-28T20:25:05Z", "is_private": false, "text": "Your configuration is invalid. Read section SRV.3.4 of the servlet spec or ask on the users list for further assistance."}]