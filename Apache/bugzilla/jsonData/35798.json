[{"count": 0, "tags": [], "bug_id": 35798, "attachment_id": null, "id": 77450, "time": "2005-07-19T21:12:43Z", "creator": "spadala@sbcglobal.net", "creation_time": "2005-07-19T21:12:43Z", "is_private": false, "text": "When the servlet output stream is pooled for future use, any writes followed\nwith a flush to the output stream (obtained from the pool) are causing null\npointer exceptions. \n\n* Same problem exists with PrintWriter.\n* The writes+flush to the output stream are not happening on the thread that\nreceived the initial service request.\n* There is a server listening on the other side of HTTP socket.\n* Is the original service thread cleaning up the output stream?\n\nPlatform : Windows XP PRofessional\nJava Version : jdk 1.5.0_04\n\nApache Tomcat Version 5.5.9\n$Id: RELEASE-NOTES,v 1.25 2005/01/19 20:30:26 remm Exp $\n\n---------------------stack trace-----------------\njava.lang.NullPointerException\n\tat\norg.apache.coyote.http11.InternalOutputBuffer.realWriteBytes(InternalOutputBuffer.java:747)\n\tat org.apache.tomcat.util.buf.ByteChunk.flushBuffer(ByteChunk.java:403)\n\tat\norg.apache.coyote.http11.InternalOutputBuffer.flush(InternalOutputBuffer.java:305)\n\tat org.apache.coyote.http11.Http11Processor.action(Http11Processor.java:978)\n\tat org.apache.coyote.Response.action(Response.java:182)\n\tat org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:322)\n\tat org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:293)\n\tat org.apache.catalina.connector.CoyoteWriter.flush(CoyoteWriter.java:82)\n\tat\ncom.xxx.ClientConnectionManager._writeToConnection(ClientConnectionManager.java:346)\n\tat java.lang.Thread.run(Thread.java:595)"}, {"count": 1, "tags": [], "bug_id": 35798, "text": "Need a war file to reproduce. \n\n\"When the servlet output stream is pooled for future use\" seems rather sketchy.\nIt seems like a misuse of the OutputStream at the when it is no longer valid\nwhich causes the error. ", "id": 77451, "time": "2005-07-19T21:30:04Z", "creator": "funkman@joedog.org", "creation_time": "2005-07-19T21:30:04Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 35798, "text": "\n(In reply to comment #1)\nthx for the quick reply.\n> Need a war file to reproduce. \nOk. I will try sending a war file.\n \n> \"When the servlet output stream is pooled for future use\" seems rather sketchy.\n> It seems like a misuse of the OutputStream at the when it is no longer valid\n> which causes the error. \nIs the output stream cleaned up by the thread servicing the original request? If\n that is the case i can't reuse the stream for future use. Didn't expect a NPE.\nIf that is the case, please close the bug. I will try figure out a workaround. \n \n", "id": 77452, "time": "2005-07-19T21:38:43Z", "creator": "spadala@sbcglobal.net", "creation_time": "2005-07-19T21:38:43Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 35798, "attachment_id": null, "id": 77453, "time": "2005-07-19T21:45:47Z", "creator": "funkman@joedog.org", "creation_time": "2005-07-19T21:45:47Z", "is_private": false, "text": "An OutputStream only lasts (at most) as long as the HttpServletResponse. In\nother words, the life of the request. \n\nOnce the reponse has been sent to the request has been sent (Servlet.service is\nfinished) - then the OutputStream is invalid.\n\n \n\n"}]