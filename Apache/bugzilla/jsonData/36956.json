[{"count": 0, "attachment_id": null, "creator": "alex.savitsky@kraft.com", "text": "This error only happens when trying to insert page break in an existing \nworkbook, like in\n\nHSSFWorkbook book = new HSSFWorkbook(new FileInputStream(existingFileName));\nHSSFSheet sheet = book.getSheetAt(0);\nsheet.setRowBreak(10);\n\nWhen doing same thing with a new workbook, it works:\n\nHSSFWorkbook book = new HSSFWorkbook();\nHSSFSheet sheet = book.createSheet(\"Test\");\nsheet.setRowBreak(10);\n\nThe reason is that the rowBreaks property of Sheet is only initialized for new \nsheets (the createSheet() call). If an existing sheet (createSheet(List, int, \nint) call) doesn't have any records for page breaks, then rowBreaks doesn't \nget initialized, resulting in an NPE.\n\nPossible resolution: either initialize rowBreaks during createSheet call, or \ndo a null check in setRowBreak()", "id": 80869, "time": "2005-10-06T21:45:04Z", "bug_id": 36956, "creation_time": "2005-10-06T21:45:04Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "jheight@apache.org", "attachment_id": null, "text": "This appears to be fixed in the code in SVN. see code block below from Sheet:\n\n\t\t\telse if (rec.getSid() == PageBreakRecord.HORIZONTAL_SID) \n\t\t\t{\t\n\t\t\t\tretval.rowBreaks = (PageBreakRecord)rec;\t\t\t\t\n\t\t\t}\n\t\t\telse if (rec.getSid() == PageBreakRecord.VERTICAL_SID) \n\t\t\t{\t\n\t\t\t\tretval.colBreaks = (PageBreakRecord)rec;\t\t\t\t\n\t\t\t}\n \n\nJason", "id": 84582, "time": "2006-01-13T03:24:00Z", "bug_id": 36956, "creation_time": "2006-01-13T03:24:00Z", "is_private": false}]