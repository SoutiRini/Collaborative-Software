[{"attachment_id": null, "tags": [], "bug_id": 44010, "text": "I work on a xls with Excel XP and POI HSSF.\nIt contains 3 charts.\n\nI only open the workbook and then save it into a new xls (without any\nmodifications).\nAfter that, I can t open the new workbook with Excel 2002 (it is the same with\nExcel 2003), I have an error message from Excel ...\n\n\nMy code is :\n                // open the woorkbook\n                {\n                        POIFSFileSystem fs =\n                                new POIFSFileSystem(new\nFileInputStream(workbookFileNameSrc));\n                        hssfworkbook = new HSSFWorkbook(fs);\n                        //hssfworkbook = new HSSFWorkbook(fs,true);\n                }\n\n                // write the new woorkbook without modifications\n                FileOutputStream fileOut = new\nFileOutputStream(workbookFileNameDest);\n                this.hssfworkbook.write(fileOut);\n                fileOut.close();\n\nI have try with POI 3.0.1 final and the latest beta\npoi-src-3.0.2-beta1-20071204.zip.\n\nThanks", "count": 0, "id": 111340, "time": "2007-12-03T02:16:08Z", "creator": "longa@deltacad.fr", "creation_time": "2007-12-03T02:16:08Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 44010, "is_private": false, "id": 111341, "attachment_id": 21214, "creator": "longa@deltacad.fr", "creation_time": "2007-12-03T02:18:32Z", "time": "2007-12-03T02:18:32Z", "text": "Created attachment 21214\nThe source workbook"}, {"count": 2, "tags": [], "bug_id": 44010, "attachment_id": 21215, "text": "Created attachment 21215\nthe output workbook (cannot be opened with MS Excel)", "id": 111342, "time": "2007-12-03T02:19:33Z", "creator": "longa@deltacad.fr", "creation_time": "2007-12-03T02:19:33Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 44010, "text": "Are you able to produce a very simple file to show this? Something like a file\nwith only one chart in it, and only a limited set of data. Or, perhaps a file\nwith two simple charts that works, and then the same file with a third chart\nadded, which doesn't.\n\nTracking down what bit of a file excel has taken objection too is very tricky.\nIf we have two files, one which works, and one which is very similar but\ndoesn't, that process is made much easier.", "id": 111344, "time": "2007-12-03T02:45:12Z", "creator": "apache@gagravarr.org", "creation_time": "2007-12-03T02:45:12Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "longa@deltacad.fr", "text": "Created attachment 21216\nworkbook with data and 2 charts. (Not work)\n\nI have make a more simple test.\n\n\"Bug_44010_OK.xls\" with a limited set of data and only one chart\nIn this case, it works !\n\n\"Bug_44010_OK.xls\" with a limited set of data and two charts\nIn this cas, it's not works.\n\nThese xls files are simple. enough simple or not ??\n\nThanks", "id": 111346, "time": "2007-12-03T03:14:19Z", "bug_id": 44010, "creation_time": "2007-12-03T03:14:19Z", "is_private": false, "attachment_id": 21216}, {"count": 5, "tags": [], "creator": "longa@deltacad.fr", "is_private": false, "id": 111347, "attachment_id": 21217, "bug_id": 44010, "creation_time": "2007-12-03T03:16:05Z", "time": "2007-12-03T03:16:05Z", "text": "Created attachment 21217\nthe same workbook with only one chart (the output xls is correct after writing with hssf)\n\nI have make a more simple test.\n\n\"Bug_44010_OK.xls\" with a limited set of data and only one chart\nIn this case, it works !\n\n\"Bug_44010_OK.xls\" with a limited set of data and two charts\nIn this cas, it's not works.\n\nThese xls files are simple. enough simple or not ??\n\nThanks"}, {"count": 6, "tags": [], "creator": "longa@deltacad.fr", "attachment_id": 21218, "id": 111348, "time": "2007-12-03T03:17:15Z", "bug_id": 44010, "creation_time": "2007-12-03T03:17:15Z", "is_private": false, "text": "Created attachment 21218\nThe source file\n\nthe java source"}, {"count": 7, "tags": [], "bug_id": 44010, "text": "the correct comment is :\n\"Bug_44010_OK.xls\" with a limited set of data and only one chart\nIn this case, it works !\n\n\"Bug_44010_NOTOK.xls\" with a limited set of data and two charts\nIn this cas, it's not works.\n\n:-)\n\n(In reply to comment #4)\n> Created an attachment (id=21216) [edit]\n> workbook with data and 2 charts. (Not work)\n> \n> I have make a more simple test.\n> \n> \"Bug_44010_OK.xls\" with a limited set of data and only one chart\n> In this case, it works !\n> \n> \"Bug_44010_OK.xls\" with a limited set of data and two charts\n> In this cas, it's not works.\n> \n> These xls files are simple. enough simple or not ??\n> \n> Thanks\n\n", "id": 111349, "time": "2007-12-03T03:22:25Z", "creator": "longa@deltacad.fr", "creation_time": "2007-12-03T03:22:25Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "creator": "ms@rationellit.se", "attachment_id": null, "is_private": false, "id": 113737, "time": "2008-02-14T00:45:45Z", "bug_id": 44010, "creation_time": "2008-02-14T00:45:45Z", "text": "I have the same problem... A template with one chart works nice to read and then\nwrite with poi, but if you add another worksheet with a chart to the template\nand then read and write with poi, excel can't open the file."}, {"count": 9, "tags": [], "text": "Same problem for a another user ...", "attachment_id": null, "id": 113738, "creator": "longa@deltacad.fr", "time": "2008-02-14T01:23:04Z", "bug_id": 44010, "creation_time": "2008-02-14T01:23:04Z", "is_private": false}, {"count": 10, "tags": [], "text": "I have the same problem... xls file was prepared in MSOffice2007 and saved in MS0ffice2003 Excel (Compatibility Mode).\n\nI only open the workbook and then save it into a new xls (without any\nmodifications).\n\nPOIFSFileSystem fs = new POIFSFileSystem(new FileInputStream(filePath));\nHSSFWorkbook wb = new HSSFWorkbook(fs);\nFileOutputStream fos = new FileOutputStream(filePath + \"_error1\");\nwb.write(fos);\n\nPOI: poi-bin-3.0.2-FINAL-20080204.zip\nxls files att.\n\nThanks", "attachment_id": null, "id": 114323, "creator": "arsen15@yandex.ru", "time": "2008-03-06T02:08:29Z", "bug_id": 44010, "creation_time": "2008-03-06T02:08:29Z", "is_private": false}, {"count": 11, "tags": [], "creator": "arsen15@yandex.ru", "attachment_id": 21636, "id": 114324, "time": "2008-03-06T02:10:03Z", "bug_id": 44010, "creation_time": "2008-03-06T02:10:03Z", "is_private": false, "text": "Created attachment 21636\noriginal xls file"}, {"count": 12, "tags": [], "bug_id": 44010, "text": "Created attachment 21637\nxls file saved by POI", "id": 114325, "time": "2008-03-06T02:11:42Z", "creator": "arsen15@yandex.ru", "creation_time": "2008-03-06T02:11:42Z", "is_private": false, "attachment_id": 21637}, {"count": 13, "tags": [], "text": "xls file was saved successfully after deleting old 3.0 version of poi from classpath.\nSorry", "attachment_id": null, "id": 114456, "creator": "arsen15@yandex.ru", "time": "2008-03-10T05:00:43Z", "bug_id": 44010, "creation_time": "2008-03-10T05:00:43Z", "is_private": false}, {"count": 14, "tags": [], "text": "Does everything now work properly for you? If so, please do mark the bug as resolved :)", "attachment_id": null, "id": 114458, "creator": "apache@gagravarr.org", "time": "2008-03-10T05:26:24Z", "bug_id": 44010, "creation_time": "2008-03-10T05:26:24Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 44010, "text": "hi,\nthis bug is not resolved.\nWith my example, you can reproduce the problem. (?)\nThanks.", "count": 15, "id": 114464, "time": "2008-03-10T07:34:24Z", "creator": "longa@deltacad.fr", "creation_time": "2008-03-10T07:34:24Z", "is_private": false}, {"count": 16, "tags": [], "bug_id": 44010, "attachment_id": null, "id": 114643, "time": "2008-03-14T12:42:49Z", "creator": "zalewski@optonline.net", "creation_time": "2008-03-14T12:42:49Z", "is_private": false, "text": "There are two problems here. The first one is Bug_44010_NOTOK.xls, which has chartsheets. \n\nThe second problem is new.xls, which is *way* more complicated than it looks. This workbook seems to have been created in Excel 2003 and contains many of that version's newer features such as format extensions, enhanced protection (of data from EXTERNSHEETs) and style extensions. The sheet also contains Office Drawings (though nothing is visible on the sheet).\n\nAn Excel workbook can actually contain 4 types of sheets\n\n1) A Worksheet is the most common. It contains rows and columns of data\n2) A Macrosheet is very similar to a worksheet, but the data represents macros to be executed on a worksheet. This is a holdover from Excel v2, and is no longer used as far as I know.\n3) A Chartsheet is a sheet that contains a chart. It has now rows or columns, only a chart\n4) A Dialogsheet is a sheet that contains a form. It also has no rows or columns.\n\nMost Excel workbooks contain only worksheets, and POI works quite well on these types of workbooks.\n\nThe Excel file Bug_44010_NOTOK.xls which does not work contains a ChartSheet. I suspect that HSSF has put some elements of a Worksheet (such as a ROW or COLUMN record) that does not belong on a ChartSheet. It is possible to place a Chart object onto a Worksheet (instead of using a ChartSheet).If youy did this, I bet you would be able to process the spreadsheet with POI.\n\nBTW, the Excel file which does work also contains a ChartSheet (but only one ChartSheet). I was actually surprised to see that POI works with this.\n\nThis bug could be split into two.\n\n1) Support for non-row and column sheet types such as ChartSheet and DialogSheet (Bug_44010_NOT_OK.xls)\n\n2) Support for Excel 2003 extended features (new.xls) I'm not sure what the problem is in this case. I know there are several record types new in Excel 2003 that are present in this worksheet and not recognized by HSSF. Such record types are blindly copied by HSSF, which might be incorrect if the record contains internal pointers, or may result in an improperordering of the BIFF records in the file output by HSSF.\n"}, {"count": 17, "tags": [], "creator": "b.tel@fortes.nl", "attachment_id": null, "id": 115816, "time": "2008-04-23T11:52:28Z", "bug_id": 44010, "creation_time": "2008-04-23T11:52:28Z", "is_private": false, "text": "Have the same problem as described. Found out that the end of the file has additional data while the original has not. Only thing that has been done on the file using POI, is set a document property."}, {"count": 18, "tags": [], "creator": "longa@deltacad.fr", "text": "hello,\ni have change the summary for this bug.", "id": 117428, "time": "2008-06-06T03:38:49Z", "bug_id": 44010, "creation_time": "2008-06-06T03:38:49Z", "is_private": false, "attachment_id": null}, {"count": 19, "tags": [], "creator": "patrickyccheng@gmail.com", "attachment_id": null, "text": "I tried the latest trunk with both Bug_44010_NOTOK.xls and new.xls, and they both open and save fine in both POI and Excel 2007, as far as I can tell.\n", "id": 122396, "time": "2008-11-11T20:59:08Z", "bug_id": 44010, "creation_time": "2008-11-11T20:59:08Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 44010, "text": "The reported problem is not reproducible with the latest trunk.\nPlease try the latest 3.5-beta4 or download daily builds from\nhttp://encore.torchbox.com/poi-svn-build/\n\nYegor\n", "count": 20, "id": 123615, "time": "2008-12-29T23:24:39Z", "creator": "yegor@dinom.ru", "creation_time": "2008-12-29T23:24:39Z", "is_private": false}]