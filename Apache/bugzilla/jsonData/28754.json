[{"count": 0, "tags": [], "creator": "new_connie@hotmail.com", "attachment_id": null, "id": 56777, "time": "2004-05-03T22:54:09Z", "bug_id": 28754, "creation_time": "2004-05-03T22:54:09Z", "is_private": false, "text": "Excel allows quotes within string - but escapes it with a \" before that.\n\nSo, the formula -\n   =RIGHT(\"test\"\"ing\", 3)\nis allowed in excel and returns the string \"ing\".\n\nTrying to do the same using HSSF gives an error.\n\nThe call -\n   cell.setCellFormula(\"RIGHT(\\\"test\\\"\\\"ing\\\", 3)\");\n\nThe stacktrace -\njava.lang.RuntimeException: Cannot Parse, sorry : ) Expected\nError: ) Expected\n\tat org.apache.poi.hssf.model.FormulaParser.Abort(FormulaParser.java:117)\n\tat org.apache.poi.hssf.model.FormulaParser.Expected\n(FormulaParser.java:124)\n\tat org.apache.poi.hssf.model.FormulaParser.Match(FormulaParser.java:184)\n\tat org.apache.poi.hssf.model.FormulaParser.function\n(FormulaParser.java:316)\n\tat org.apache.poi.hssf.model.FormulaParser.Ident(FormulaParser.java:265)\n\tat org.apache.poi.hssf.model.FormulaParser.Factor\n(FormulaParser.java:474)\n\tat org.apache.poi.hssf.model.FormulaParser.Term(FormulaParser.java:548)\n\tat org.apache.poi.hssf.model.FormulaParser.Expression\n(FormulaParser.java:596)\n\tat org.apache.poi.hssf.model.FormulaParser.parse(FormulaParser.java:700)\n\tat org.apache.poi.hssf.usermodel.HSSFCell.setCellFormula\n(HSSFCell.java:678)\n\tat emr.test.Test.setSecondRow(Test.java:88)\n\tat emr.test.Test.main(Test.java:116)\nException in thread \"main\" \n\ncheers\nConrad\n\nPS I'm using version 2.5 (the version combobox in poi bugzilla doesn't have \nthat option!)"}, {"count": 1, "tags": [], "text": "Mostly fixed in bug 44504.\n\nOne extra bug was noticed - HSSFCell.getCellFormula() did not double up the double quotes present in string literals.\n\nFix and junit added in svn r653608.\n\n", "attachment_id": null, "id": 116268, "creator": "josh@apache.org", "time": "2008-05-05T14:41:09Z", "bug_id": 28754, "creation_time": "2008-05-05T14:41:09Z", "is_private": false}]