[{"count": 0, "tags": [], "bug_id": 51440, "attachment_id": 27217, "id": 147541, "creation_time": "2011-06-28T04:15:30Z", "time": "2011-06-28T04:15:30Z", "creator": "yuyj@yuyj.com", "text": "Created attachment 27217\nthe excel file\n\nError occur when i deal excel 2003 files with poi.\n(btw: the hssf.xls file is created by ms office 2003 directly.\n\nand i use FileFormatConverters.exe Compatibility Pack for opening office2007 files.\nhttp://www.microsoft.com/download/en/details.aspx?id=3\n\nnow i see FileFormatConverters.exe is the right reason why this error occur.\nplease see the picture attached.\n\nThe code like this: \uff08hssf.xls as attached.)\n=============================================================\nimport java.io.FileInputStream;\n\nimport org.apache.poi.hssf.usermodel.HSSFWorkbook;\nimport org.apache.poi.poifs.filesystem.POIFSFileSystem;\n\npublic class PoiTest {\n\tpublic static void main(String[] args) {\n\t\tFileInputStream in;\n\t\ttry {\n\n\t\t\tin = new FileInputStream(\"e:/hssf.xls\");\n\n\t\t\tPOIFSFileSystem f = new POIFSFileSystem(in);\n\t\t\tHSSFWorkbook wb = new HSSFWorkbook(f);\n\n\t\t\tSystem.out.println(\"ok\");\n\n\t\t} catch (Exception e) {\n\n\t\t\te.printStackTrace();\n\t\t}\n\n\t}\n\n}\n\nThe exception as bellow:\n=================================================================\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\tat org.apache.poi.hssf.record.RecordFactory$ReflectionConstructorRecordCreator.create(RecordFactory.java:65)\n\tat org.apache.poi.hssf.record.RecordFactory.createSingleRecord(RecordFactory.java:300)\n\tat org.apache.poi.hssf.record.RecordFactoryInputStream.readNextRecord(RecordFactoryInputStream.java:270)\n\tat org.apache.poi.hssf.record.RecordFactoryInputStream.nextRecord(RecordFactoryInputStream.java:236)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:442)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:263)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:188)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:170)\n\tat PoiTest.main(PoiTest.java:37)\nCaused by: org.apache.poi.hssf.record.RecordFormatException: Expected to find a ContinueRecord in order to read remaining 4 of 14 chars\n\tat org.apache.poi.hssf.record.RecordInputStream.readStringCommon(RecordInputStream.java:353)\n\tat org.apache.poi.hssf.record.RecordInputStream.readString(RecordInputStream.java:293)\n\tat org.apache.poi.hssf.record.SupBookRecord.<init>(SupBookRecord.java:96)\n\tat sun.reflect.GeneratedConstructorAccessor6.newInstance(Unknown Source)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:513)\n\tat org.apache.poi.hssf.record.RecordFactory$ReflectionConstructorRecordCreator.create(RecordFactory.java:57)\n\t... 8 more", "is_private": false}, {"count": 1, "tags": [], "bug_id": 51440, "attachment_id": 27218, "is_private": false, "id": 147542, "time": "2011-06-28T05:43:30Z", "creator": "yuyj@yuyj.com", "creation_time": "2011-06-28T05:43:30Z", "text": "Created attachment 27218\nthe end of the excel file.\n\nthe end of the two excel files."}, {"count": 2, "tags": [], "bug_id": 51440, "is_private": false, "id": 147551, "attachment_id": null, "creator": "apache@gagravarr.org", "creation_time": "2011-06-28T10:22:48Z", "time": "2011-06-28T10:22:48Z", "text": "Does the error still happen with POI 3.8 beta 3?"}, {"count": 3, "tags": [], "bug_id": 51440, "is_private": false, "id": 147585, "attachment_id": null, "creator": "yuyj@yuyj.com", "creation_time": "2011-06-29T03:07:50Z", "time": "2011-06-29T03:07:50Z", "text": "(In reply to comment #2)\n> Does the error still happen with POI 3.8 beta 3?\n\nYES"}, {"count": 4, "tags": [], "bug_id": 51440, "attachment_id": null, "id": 147693, "time": "2011-07-02T09:47:05Z", "creator": "yegor@dinom.ru", "creation_time": "2011-07-02T09:47:05Z", "is_private": false, "text": "the problem is not reproducible with the latest build from trunk. \n\nYegor\n\n(In reply to comment #3)\n> (In reply to comment #2)\n> > Does the error still happen with POI 3.8 beta 3?\n> \n> YES"}]