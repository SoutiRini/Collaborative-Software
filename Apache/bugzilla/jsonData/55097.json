[{"count": 0, "tags": [], "creator": "adrian@symphonious.net", "attachment_id": 30429, "id": 167800, "time": "2013-06-13T01:50:53Z", "bug_id": 55097, "creation_time": "2013-06-13T01:50:53Z", "is_private": false, "text": "Created attachment 30429\nSimple demonstration of problem\n\nIf you import the same file via two different resource types (url and javaresource in my case) it can be resolved to exactly the same URL but still be imported twice.\n\nAttached is a complete demonstration of this problem.  In brief, if we have a file imported.xml which fails if it is imported twice, then:\n\n<?xml version=\"1.0\"?>\n<project name=\"multi-import\">\n\n  <dirname file=\"${ant.file}\" property=\"path\"/>\n  <import>\n    <url url=\"file:${path}/imported.xml\"/>\n    <javaresource classpath=\".\" name=\"imported.xml\"/>\n  </import>\n</project>\n\nwill fail. This is despite the fact that ant -debug clearly shows the file is resolved to the same underlying URL:\n\nImporting file file:/home/suttona/bugs/ant-multi-import/imported.xml from /home/suttona/bugs/ant-multi-import/build.xml\nOverriding previous definition of reference to ant.projectHelper\nAdding reference: ant.projectHelper\nparsing buildfile file:/home/suttona/bugs/ant-multi-import/imported.xml with URI = file:/home/suttona/bugs/ant-multi-import/imported.xml\n...\nImporting file imported.xml from /home/suttona/bugs/ant-multi-import/build.xml\nResourceStream for imported.xml loaded from ant loader\nOverriding previous definition of reference to ant.projectHelper\nAdding reference: ant.projectHelper\nResource imported.xml loaded from ant loader\nparsing buildfile file:/home/suttona/bugs/ant-multi-import/imported.xml with URI = file:/home/suttona/bugs/ant-multi-import/imported.xml\n\n\nThe simplified example is clearly a stupid thing to do, but we ran across this issue in a much more reasonable use case. For the background see http://www.symphonious.net/2013/06/12/importing-an-ant-buildfile-multiple-times/\n\nThe work around is just to use URLs consistently - they are quite capable of pointing to files on remote servers local file systems or within zip/jar files which is all we need.\n\nIssue exists at least as far back as 1.8.4."}, {"count": 1, "tags": [], "bug_id": 55097, "attachment_id": null, "text": "fixed with svn revision 1554400", "id": 171975, "time": "2013-12-31T11:05:33Z", "creator": "bodewig@apache.org", "creation_time": "2013-12-31T11:05:33Z", "is_private": false}]