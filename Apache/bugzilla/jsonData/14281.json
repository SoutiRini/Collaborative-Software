[{"count": 0, "tags": [], "bug_id": 14281, "attachment_id": null, "is_private": false, "id": 25735, "time": "2002-11-05T23:44:49Z", "creator": "stronk7@si.unirioja.es", "creation_time": "2002-11-05T23:44:49Z", "text": "I've configured the AccessLogValve in combined format and to invoke servlets seems to \nreturn \"-\" at the BytesSent position in the log file.\n\nStatic content seems to fill ok this field.\n\nCiao."}, {"count": 1, "tags": [], "text": "If the servlet doesn't set the content-length, then the number of bytes sent\ncan't be logged (it is not known).", "attachment_id": null, "bug_id": 14281, "id": 25749, "time": "2002-11-06T08:00:00Z", "creator": "remm@apache.org", "creation_time": "2002-11-06T08:00:00Z", "is_private": false}, {"count": 2, "tags": [], "creator": "stronk7@si.unirioja.es", "is_private": false, "text": "But this worked ok before 4.1.x.\n\nI just upgrade my apps from 4.0.6 to 4.1.12.\n\nIs correct to set the content-length mandatory to make the AccessValve knows \nBytesSent? I think it doesn't have much sense.", "id": 25752, "time": "2002-11-06T08:44:51Z", "bug_id": 14281, "creation_time": "2002-11-06T08:44:51Z", "attachment_id": null}, {"count": 3, "tags": [], "text": "I've found the root cause of the error (I think) at coyote classes.\n\norg.apache.coyote.tomcat4.CoyoteResponse calls to \n   org.apache.coyote.tomcat4.OutputBuffer.getBytesWritten()\n\nIt returna byte-count, and the \n   org.apache.coyote.tomcat4.OutputBuffer.getCharsWritten()\nreturns chars-count.\n\nI've created a new method:\n   org.apache.coyote.tomcat4.OutputBuffer.getContentWritten()\nthat returns charsWritten + bytesWritten\n\nAnd in org.apache.coyote.tomcat4.CoyoteResponse,\nI've changed the getContentCount() method to call the\nnew OutputBuffer's method.\n\n\nI've recompiled the connector and all seems to work fine.\n\nPlease, analyze it.\n\nCiao.", "is_private": false, "bug_id": 14281, "id": 26020, "time": "2002-11-10T02:08:49Z", "creator": "stronk7@si.unirioja.es", "creation_time": "2002-11-10T02:08:49Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "stronk7@si.unirioja.es", "attachment_id": 3794, "id": 26028, "creation_time": "2002-11-10T11:54:06Z", "time": "2002-11-10T11:54:06Z", "bug_id": 14281, "text": "Created attachment 3794\nChanges on org.apache.coyote.tomcat4.OutputBuffer.java", "is_private": false}, {"count": 5, "tags": [], "creator": "stronk7@si.unirioja.es", "attachment_id": 3795, "id": 26029, "creation_time": "2002-11-10T11:54:50Z", "time": "2002-11-10T11:54:50Z", "bug_id": 14281, "text": "Created attachment 3795\nChanges on org.apache.coyote.tomcat4.Changes on org.apache.coyote.tomcat4.CoyoteResponse.java", "is_private": false}, {"count": 6, "tags": [], "text": "I've sent two patch atachments to:\n\norg.apache.coyote.tomcat4.OutputBuffer.java\norg.apache.coyote.tomcat4.CoyoteResponse.java\n\nCiao.\n\nPlease, patch it.", "attachment_id": null, "bug_id": 14281, "id": 26030, "time": "2002-11-10T11:56:48Z", "creator": "stronk7@si.unirioja.es", "creation_time": "2002-11-10T11:56:48Z", "is_private": false}, {"count": 7, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "id": 26038, "time": "2002-11-10T18:19:06Z", "bug_id": 14281, "creation_time": "2002-11-10T18:19:06Z", "is_private": false, "text": "Yes, I think this makes sense. Good job finding the cause of the problem :)"}, {"count": 8, "tags": [], "creator": "funkman@joedog.org", "attachment_id": null, "id": 38373, "time": "2003-06-04T17:13:06Z", "bug_id": 14281, "creation_time": "2003-06-04T17:13:06Z", "is_private": false, "text": "This appears to be working fine for me. I think this was already fixed."}]