[{"count": 0, "tags": [], "bug_id": 47581, "attachment_id": null, "id": 129149, "time": "2009-07-25T21:05:47Z", "creator": "prescindor@gmail.com", "creation_time": "2009-07-25T21:05:47Z", "is_private": false, "text": "After being dissatisfied with the results of XSSFSheet.autoSizeColumn, I tried to use XSSFSheet.setColumnWidth to implement my own crude attempt at column width fitting. Nothing happened. The columns in the output .xlsx were all the default width.\n\nArmed with the knowledge that autoSizeColumn was able to do something, if not what I wanted, but setColumnWidth was not, I looked at the source. Turns out autoSizeColumn calls columnHelper.setColBestFit and columnHelper.setCustomWidth when it sets the width it computed, whereas setColumnWidth does not.\n\nWorkaround: I was able to set my computed widths by calling the columnHelper methods prior to the setColumnWidth call (easy to do from JRuby \u2014 from Java, you probably need a reflection hack). Actually, it looks like you only need either one of the columnHelper calls, not both."}, {"count": 1, "tags": [], "text": "Can you attach a sample code that demonstrates the problem? \n\nThe following code works fine to me:\n\n        XSSFWorkbook wb = new XSSFWorkbook();\n        XSSFSheet sh = wb.createSheet();\n        sh.setColumnWidth(0, 256*5);  //5-character wide\n        sh.setColumnWidth(1, 256*20); //20-character wide\n        sh.setColumnWidth(2, 256*50); //50-character wide\n\n        FileOutputStream out = new FileOutputStream(\"bug-47581.xlsx\");\n        wb.write(out);\n        out.close();\n\nI tested with current trunk and Excel 2007.\n\nYegor", "is_private": false, "bug_id": 47581, "id": 129490, "time": "2009-08-05T10:15:55Z", "creator": "yegor@dinom.ru", "creation_time": "2009-08-05T10:15:55Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "prescindor@gmail.com", "attachment_id": 24228, "id": 130214, "time": "2009-09-08T09:42:33Z", "bug_id": 47581, "creation_time": "2009-09-08T09:42:33Z", "is_private": false, "text": "Created attachment 24228\nTest case with code to generate good and bad files.\n\nAttached is a Java app that generates good and bad test files.\n\nThe bad version of the file displays incorrectly in Excel 2008 for Mac 12.2.1 (090605) but correctly in the Mac Finder's preview display and correctly on Windows, using Excel 2007.\n\nThe good version, produced using the workaround (calling ColumnHelper.setCustomWidth) displays correctly in Excel Mac 2008. The good version is a few bytes longer."}, {"count": 3, "tags": [], "creator": "dfisher@jmlafferty.com", "attachment_id": null, "text": "You should upgrade your Mac Excel version.\n\nPlease see https://issues.apache.org/bugzilla/show_bug.cgi?id=47559\n\nMicrosoft was very responsive and quick with the patch. It was delivered about one month ago.", "id": 130215, "time": "2009-09-08T09:51:44Z", "bug_id": 47581, "creation_time": "2009-09-08T09:51:44Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 47581, "text": "(In reply to comment #3)\n> You should upgrade your Mac Excel version.\n> \n> Please see https://issues.apache.org/bugzilla/show_bug.cgi?id=47559\n> \n> Microsoft was very responsive and quick with the patch. It was delivered about\n> one month ago.\n\nI tested with 12.2.1. I just ran Check for Updates, and it didn't turn up any.", "id": 130216, "time": "2009-09-08T10:03:23Z", "creator": "prescindor@gmail.com", "creation_time": "2009-09-08T10:03:23Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "text": "I fixed XSSFSheet.setColumnWidth to always set the customWidth=\"true\" attribute of the CTCol bean. \n\nThe fix was committed in r814358\n\nRegards,\nYegor", "attachment_id": null, "bug_id": 47581, "id": 130347, "time": "2009-09-13T10:53:02Z", "creator": "yegor@dinom.ru", "creation_time": "2009-09-13T10:53:02Z", "is_private": false}]