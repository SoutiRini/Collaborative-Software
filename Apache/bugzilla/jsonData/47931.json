[{"count": 0, "tags": [], "bug_id": 47931, "text": "Created attachment 24334\nallow few additional flags to be passed to mysql_real_connect\n\nIt is not possible to use CALL MySQL method with apr_dbd_mysql, because\nlibmysqlclient requires CLIENT_MULTI_STATEMENTS and \nCLIENT_MULTI_RESULTS to be passed, but apr_dbd_mysql accepts only \nCLIENT_FOUND_ROWS flag.\n\nThis patch slightly changes apr_dbd_mysql in order to accept these two\nadditional flags.", "id": 130797, "time": "2009-10-01T23:46:31Z", "creator": "mkevac@gmail.com", "creation_time": "2009-10-01T23:46:31Z", "is_private": false, "attachment_id": 24334}, {"count": 1, "tags": [], "bug_id": 47931, "is_private": false, "text": "Created attachment 24372\nallow few additional flags to be passed to mysql_real_connect\n\nFlags are not exclusive, so we must use if's, not else if's", "id": 131046, "time": "2009-10-09T23:36:47Z", "creator": "mkevac@gmail.com", "creation_time": "2009-10-09T23:36:47Z", "attachment_id": 24372}, {"count": 2, "tags": [], "bug_id": 47931, "text": "(In reply to comment #0)\n> Created attachment 24334 [details]\n> allow few additional flags to be passed to mysql_real_connect\n> \n> It is not possible to use CALL MySQL method with apr_dbd_mysql, because\n> libmysqlclient requires CLIENT_MULTI_STATEMENTS and \n> CLIENT_MULTI_RESULTS to be passed, but apr_dbd_mysql accepts only \n> CLIENT_FOUND_ROWS flag.\n> \n> This patch slightly changes apr_dbd_mysql in order to accept these two\n> additional flags.\n\nThis patch may solve use problem, but then another problem appearing,\n\"Commands out of synch\" as declared in mysql ref. as common error \nhttp://dev.mysql.com/doc/refman/5.1/en/commands-out-of-sync.html\n\nThere is a solution.\nhttp://dev.mysql.com/doc/refman/5.1/en/c-api-multiple-queries.html\n\nBut applying the solution described above to current design of apr_mysql_dbd_driver does not seem easy to me. \n\nAlso I've tested and succeed to use underlaying MYSQL connection like\n\nMYSQL *mysql = ((apr_dbd_t*)db->handle)->conn;\nstatus = mysql_query(mysql,\"CALL xgetposts;\");\ndo {\n/* did current statement return data? */\n\t//MYSQL_RES *result = mysql_store_result(mysql);\n\tMYSQL_RES *result = mysql_use_result(mysql);\nif (result)\n{\n\tMYSQL_ROW row;\n\twhile ((row = mysql_fetch_row(result)))\n\t{\n\n\n\t\tap_rprintf(r, \"<h2> %s</h2>%s\\n%s</br><hr>\\n\", row[2], row[1], ap_escape_html(r->pool, row[3]));\n\t//\tap_rprintf(r, \"<h2>%s</h2>%s\\n%s</br><hr>\\n\", row[2], row[1], (r->pool, row[3]));\n\t}\n\tmysql_free_result(result);\n}\n\n/* more results? -1 = no, >0 = error, 0 = yes (keep looping) */\nif ((status = mysql_next_result(mysql)) > 0)\nprintf(\"Could not execute statement\\n\");\n} while (status == 0);", "id": 148357, "time": "2011-08-03T16:47:29Z", "creator": "sfirat@yahoo.com", "creation_time": "2011-08-03T16:47:29Z", "is_private": false, "attachment_id": null}]