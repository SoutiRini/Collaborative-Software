[{"count": 0, "tags": [], "creator": "listcraigs86@yahoo.com", "attachment_id": null, "id": 197167, "time": "2017-02-20T17:05:49Z", "bug_id": 60753, "creation_time": "2017-02-20T17:05:49Z", "is_private": false, "text": "After an upgrade from Tomcat 8.0.39 to 8.0.41, an application no longer starts. In the catalina log file, there are many exceptions of the type:\n\nWARNING [localhost-startStop-1] org.apache.tomcat.util.\nscan.StandardJarScanner.scan Failed to scan [file:/usr/share/java/tomcat8/javax.\nannotation-api.jar] from classloader hierarchy\n java.io.FileNotFoundException: /usr/share/java/tomcat8/javax.annotation-api.jar\n (No such file or directory)\n\nThe files complained about belong to jaxws-ri. Even after copying all 23 jars from the jaxws-ri 2.2.10 lib directory to the Tomcat lib directory (per the documentation of jaxws-ri), exceptions for additional jars apparently referenced by jaxws-ri (and some with very specific build versions) persist:\njaxb-core-2.2.10-b140802.1033.jar\njaxb-api-2.2.12-b140109.1041.jar\nistack-commons-runtime-2.19.jar\ntxw2-2.2.10-b140802.1033.jar\nhk2-core.jar\nclass-model.jar\nconfig.jar\nauto-depends.jar\njavax.inject.jar\nhk2-api.jar\nosgi-resource-locator.jar\ntiger-types.jar\nbean-validator.jar\njtype.jar\n\nIt looks like the jar scanner has suddenly become very picky about the presence of all these files, even though the application works perfectly fine without them. Please restore the more permissive operation of the scanner from 8.0.39."}, {"count": 1, "tags": [], "creator": "violetagg@apache.org", "attachment_id": null, "id": 197169, "time": "2017-02-20T19:50:40Z", "bug_id": 60753, "creation_time": "2017-02-20T19:50:40Z", "is_private": false, "text": "Hi,\n\nPut in your context.xml the following configuration:\n\n<Context>\n  ...\n  <JarScanner scanManifest=\"false\"/>\n  ...\n</Context>\n\nhttps://tomcat.apache.org/tomcat-8.0-doc/config/jar-scanner.html#Standard_Implementation\n\nPlease use tomcat users list when you need help for Tomcat configuration.\n\nBest Regards,\nVioleta Georgieva"}, {"count": 2, "tags": [], "creator": "listcraigs86@yahoo.com", "text": "(In reply to Violeta Georgieva from comment #1)\n\nIn the context.xml of the existing Tomcat 8.0.39 installation on AWS, I do not see this setting at all. The documentation for version 8.0.41 says the default for this setting is true. This tells me that the default changed from false in 8.0.39 to true in 8.0.41. This is an unexpected change of behavior between minor versions of Tomcat. I consider this a bug.", "id": 197187, "time": "2017-02-21T13:56:17Z", "bug_id": 60753, "creation_time": "2017-02-21T13:56:17Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 60753, "attachment_id": null, "text": "The addition of the scanManifest flag was made in 8.0.38, and the default was already to scan the manifest (it was not possible to disable it), so there are some issues somewhere with your statements. There has been no relevant update of the skip list either.", "id": 197188, "time": "2017-02-21T14:27:39Z", "creator": "remm@apache.org", "creation_time": "2017-02-21T14:27:39Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 60753, "is_private": false, "id": 197189, "creation_time": "2017-02-21T14:43:41Z", "time": "2017-02-21T14:43:41Z", "creator": "listcraigs86@yahoo.com", "text": "(In reply to Remy Maucherat from comment #3)\n> The addition of the scanManifest flag was made in 8.0.38, and the default\n> was already to scan the manifest (it was not possible to disable it), so\n> there are some issues somewhere with your statements.\n\nOK, so in /usr/share/java/tomcat8 of the existing installation, I issue the following command:\n\njava -cp catalina.jar org.apache.catalina.util.ServerInfo\n\nand get the following output:\n\nServer version: Apache Tomcat/8.0.39\nServer built:   Dec 19 2016 19:32:05 UTC\nServer number:  8.0.39.0\nOS Name:        Linux\nOS Version:     4.4.44-39.55.amzn1.x86_64\nArchitecture:   amd64\nJVM Version:    1.8.0_121-b13\nJVM Vendor:     Oracle Corporation\n\nThis is the content of context.xml (with the initial licensing comment shortened for brevity):\n\n<?xml version='1.0' encoding='utf-8'?>\n<!--\n  Licensed to the Apache Software Foundation (ASF) under one or more\n  ...\n-->\n<!-- The contents of this file will be loaded for each web application -->\n<Context>\n\n    <!-- Default set of monitored resources. If one of these changes, the    -->\n    <!-- web application will be reloaded.                                   -->\n    <WatchedResource>WEB-INF/web.xml</WatchedResource>\n    <WatchedResource>${catalina.base}/conf/web.xml</WatchedResource>\n\n    <!-- Uncomment this to disable session persistence across Tomcat restarts -->\n    <!--\n    <Manager pathname=\"\" />\n    -->\n\n    <!-- Uncomment this to enable Comet connection tacking (provides events\n         on session expiration as well as webapp lifecycle) -->\n    <!--\n    <Valve className=\"org.apache.catalina.valves.CometConnectionManagerValve\" />\n    -->\n</Context>\n\nAs you see, this is Tomcat version 8.0.39 and there is no scanManifest setting in context.xml, so a default value of this setting has to be used (you stated that the setting was introduced in 8.0.38). If the default is true, then the jar scan in 8.0.39 should result in the same exceptions as in 8.0.41. But it does not -- the application starts and works perfectly fine.", "attachment_id": null}, {"text": "As stated previously, configuration discussions belong on the users' mailing list, not in bugzilla.  Post your query there.", "tags": [], "bug_id": 60753, "attachment_id": null, "count": 5, "id": 197190, "time": "2017-02-21T15:02:29Z", "creator": "chuck.caldarale@unisys.com", "creation_time": "2017-02-21T15:02:29Z", "is_private": false}, {"text": "(In reply to Chuck Caldarale from comment #5)\n> As stated previously, configuration discussions belong on the users' mailing\n> list, not in bugzilla.  Post your query there.\n\nSorry, but I disagree. The default value is clearly *hard-coded* in Tomcat, and it appears that the resulting behavior is different between versions 8.0.39 and 8.0.41, even though it is claimed to be the same. So, this is not a user configuration issue per se, it is a code issue.", "tags": [], "bug_id": 60753, "attachment_id": null, "count": 6, "id": 197192, "time": "2017-02-21T15:28:28Z", "creator": "listcraigs86@yahoo.com", "creation_time": "2017-02-21T15:28:28Z", "is_private": false}, {"count": 7, "tags": [], "creator": "violetagg@apache.org", "text": "(In reply to listcraigs86 from comment #6)\n> (In reply to Chuck Caldarale from comment #5)\n> > As stated previously, configuration discussions belong on the users' mailing\n> > list, not in bugzilla.  Post your query there.\n> \n> Sorry, but I disagree. The default value is clearly *hard-coded* in Tomcat,\n> and it appears that the resulting behavior is different between versions\n> 8.0.39 and 8.0.41, even though it is claimed to be the same. So, this is not\n> a user configuration issue per se, it is a code issue.\n\nOk\n\nI did the following test\n- downloaded Tomcat 8.0.39 from tomcat.apache.org (the official distribution)\n- downloaded jaxws-ri 2.2.10 from https://jax-ws.java.net/2.2.10/\n- copied the *.jar files from jaxws-ri/lib to <Tomcat-Home>/lib\n\nThe observed behavior is the same as with Tomcat 8.0.41\n\nI'm closing this one. If you provide a clear step by step reproducible scenario you can reopen it. \n\nRegards,\nVioleta", "id": 197193, "time": "2017-02-21T15:44:48Z", "bug_id": 60753, "creation_time": "2017-02-21T15:44:48Z", "is_private": false, "attachment_id": null}]