[{"count": 0, "tags": [], "creator": "greg@arakelian.com", "text": "In RemoteIpFilter class, there is code that publishes the new request attributes to AccessLog (see below).\n\n821             if (requestAttributesEnabled) {\n822                 request.setAttribute(AccessLog.REMOTE_ADDR_ATTRIBUTE,\n823                         request.getRemoteAddr());\n824                 request.setAttribute(AccessLog.REMOTE_HOST_ATTRIBUTE,\n825                         request.getRemoteHost());\n826                 request.setAttribute(AccessLog.PROTOCOL_ATTRIBUTE,\n827                         request.getProtocol());\n828                 request.setAttribute(AccessLog.SERVER_PORT_ATTRIBUTE,\n829                         Integer.valueOf(request.getServerPort()));\n830             }\n\nThe problem is that the source values should come from xRequest, e.g. xRequest.getRemoteAddr() and xRequest.getRemoteHost(), etc.\n\nAs it is written above, RemoteIpFilter simply republishes the current values, and AccessLog therefore does not display the correct values.", "id": 164413, "time": "2013-01-05T23:52:37Z", "bug_id": 54377, "creation_time": "2013-01-05T23:52:37Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 54377, "text": "Created attachment 29820\npatch proposal", "id": 164415, "time": "2013-01-06T20:19:29Z", "creator": "violetagg@apache.org", "creation_time": "2013-01-06T20:19:29Z", "is_private": false, "attachment_id": 29820}, {"count": 2, "tags": [], "creator": "violetagg@apache.org", "text": "Created attachment 29821\ntest case", "id": 164416, "time": "2013-01-06T20:19:53Z", "bug_id": 54377, "creation_time": "2013-01-06T20:19:53Z", "is_private": false, "attachment_id": 29821}, {"count": 3, "tags": [], "bug_id": 54377, "text": "+1\n\nPlease find a patch proposal and a test case.\nRemoteIpValve sets the correct request attributes, only RequestIpFilter need correction.\n\nRegards\nVioleta", "id": 164417, "time": "2013-01-06T20:21:11Z", "creator": "violetagg@apache.org", "creation_time": "2013-01-06T20:21:11Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 54377, "text": "Thanks for the patch and test cases. This has been applied to trunk and 7.0.x and will be included in 7.0.35 onwards.", "id": 164494, "time": "2013-01-08T20:30:57Z", "creator": "markt@apache.org", "creation_time": "2013-01-08T20:30:57Z", "is_private": false, "attachment_id": null}]