[{"attachment_id": null, "tags": [], "bug_id": 44306, "is_private": false, "count": 0, "id": 113178, "time": "2008-01-28T04:15:42Z", "creator": "apache@gagravarr.org", "creation_time": "2008-01-28T04:15:42Z", "text": "On a formula\n    =CHOOSE(2,A2,A3,A4)\n\ncalling cell.getCellFormula() will blow up with an EmptyStackException\n\nNot sure if it's a bug with the formula parser, or the processing of the Ptgs\n\nTest for the Ptg parsing is in\nsrc/testcases/org/apache/poi/hssf/record/TestFormulaRecord.java#testWithConcat()\nbut may not be fully correct\n\nTest for the usermodel side is in\nsrc/testcases/org/apache/poi/hssf/usermodel/TestBugs.java#test42618() with the\nlast line calling getCellFormula commented out"}, {"count": 1, "tags": [], "bug_id": 44306, "text": "Fixed in svn r657702.\n\nThere were two problems: tAttrChoose was ignoring the following jump-table and FormulaParser.toFormulaString() needed to handle the extra case of tAttrChoose.\n\nBy not reading the extra data belonging to the choose AttrPtg, POI would interpret that data as subsequent Ptgs which had unpredictable results (none good).\n\n\nNote - as of this fix POI is still not able to evaluate formulas involving CHOOSE() (see bug 45031)", "id": 116789, "time": "2008-05-18T18:46:26Z", "creator": "josh@apache.org", "creation_time": "2008-05-18T18:46:26Z", "is_private": false, "attachment_id": null}]