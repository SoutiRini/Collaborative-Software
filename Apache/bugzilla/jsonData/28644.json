[{"count": 0, "tags": [], "text": "I have a servlet that produce an excel file using POI HSSF. The info. printed \non that file is obtained through a database.\n\nThe problem is that when I want to print a lot of rows on excel it throws an \nexception, as follows:\n\nSEVERE: StandardWrapperValve[REPCBRR090SRV]: Servlet.service() for servlet REPCB\nRR090SRV threw exception\njava.lang.IllegalStateException: Cannot forward after response has been committe\nd\n        at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationD\nispatcher.java:375)\n        at org.apache.catalina.core.ApplicationDispatcher.access$000(Application\nDispatcher.java:123)\n        at org.apache.catalina.core.ApplicationDispatcher$PrivilegedForward.run(\nApplicationDispatcher.java:138)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDis\npatcher.java:355)\n        at code.com.nextel.servlet.REPCBRR090SRV.doTask(REPCBRR090SRV.java:155)\n        at code.com.nextel.servlet.NextelSrv.doGet(NextelSrv.java:77)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:740)\n        at code.com.nextel.servlet.NextelSrv.service(NextelSrv.java:44)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n        at org.apache.catalina.core.StandardWrapperValve.invokeServletService(St\nandardWrapperValve.java:720)\n        at org.apache.catalina.core.StandardWrapperValve.access$000(StandardWrap\nperValve.java:118)\n        at org.apache.catalina.core.StandardWrapperValve$1.run(StandardWrapperVa\nlve.java:278)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperV\nalve.java:274)\n        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.jav\na:505)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextV\nalve.java:212)\n        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.jav\na:505)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.j\nava:203)\n        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.jav\na:505)\n        at com.iplanet.ias.web.connector.nsapi.NSAPIProcessor.process(NSAPIProce\nssor.java:157)\n        at com.iplanet.ias.web.WebContainer.service(WebContainer.java:598)\n\nI have done several tests:\n\n1. If I obtain 10K (10000 rows) from database, it produce an output on excel of \naround 25K rows. the difference is because all the titles and related stuff \nwith the output (like titles, cuts, and so on just for printing purposes)\n2. If I obtain 15K (15000 rows) from database, it produce an output on excel of \naround 30K rows.\n3. Then  if I obtain 20K (20000 rows) from database, it produce an output on \nexcel of around ????, here it throws the EXCEPTION!!!\n\nI have increased my buffer size on the servlet with:\nresponse.setBufferSize(32000);\nwhen it had around 8900 (retrieved with getBufferSize()), and nothing.\n\nHope somebody can help me!\n\nThanks.\nI appreciate you can reply me to: gab_s@hotmail.com", "attachment_id": null, "id": 56527, "creator": "gab_s@hotmail.com", "time": "2004-04-28T00:10:37Z", "bug_id": 28644, "creation_time": "2004-04-28T00:10:37Z", "is_private": false}, {"count": 1, "tags": [], "text": "As far as I can tell this is a logic error with your servlet not a problem with\nPOI.  You shouldn't be forwarding after serving data to the user.  Make the\ndecision to forward before you start spitting out any data.", "attachment_id": null, "id": 63798, "creator": "glens@apache.org", "time": "2004-09-19T03:02:46Z", "bug_id": 28644, "creation_time": "2004-09-19T03:02:46Z", "is_private": false}]