[{"count": 0, "tags": [], "text": "Our mod proxy is configured as follows:\n\n<Proxy balancer://App>\nBalancerMember ajp://xxxx-44276360-13-70680295.prod.aaa.bbb.ccc.prod.ddd.com:8009 route=xxxx-44276360-13-70680295\nBalancerMember ajp://xxxx-44277895-7-70710077.prod.aaa.bbb.ccc.prod.ddd.com:8009 route=xxxx-44277895-7-70710077\n..\n..\n.. (50 odd such Balancer Members)\nProxySet lbmethod=bytraffic\nProxySet stickysession=JSESSIONID|jsessionid scolonpathdelim=On\n</Proxy>\nProxyPreserveHost On\nProxyPass / balancer://App/\n\nBackend server is Jboss 5.1.2. Stickiness is maintained via JSESSIONID cookie. jvmRoute is appropriately configured on jboss side. And situation works as expected most of the times.\n\nHowever, sometimes, stickiness stops working randomly. & happens for all sessions when it kickstarts. When that happens, we see that BALANCER_WORKER_ROUTE is set as different from BALANCER_SESSION_ROUTE without any error from worker. Following is the log entry for one error occurence\n\n[10/Sep/2015:07:59:14 +0000] | 200 | [3506610 us] | [JSESSIONID xxxx-44277895-7-70710077  ajp://xxxx-44276360-13-70680295.prod.aaa.bbb.ccc.prod.ddd.com:8009 xxxx-44276360-13-7068029 1]\n\nLogformat used is\nLogFormat \"%t | %>s | [%D us] | [%{BALANCER_SESSION_STICKY}e %{BALANCER_SESSION_ROUTE}e  %{BALANCER_WORKER_NAME}e %{BALANCER_WORKER_ROUTE}e %{BALANCER_ROUTE_CHANGED}e]\n\nNotice the BALANCER_WORKER_ROUTE. It is missing one character. Route should have been xxxx-44276360-13-70680295 but apache sees it as xxxx-44276360-13-7068029 (last character truncated). Point in question is not that BALANCER_WORKER_ROUTE is malformed, but that all route will malform and session stickiness will definitely not work if that happens because apache won't find it due to truncated character.\n\nWe've been checking on character length limitation (as prescribed for mod-cluster here https://docs.jboss.org/mod_cluster/1.2.0/html/Intro.html#d0e85) but all looks ok. Plus it's for mod_cluster & mod_proxy_ajp doesn't really publish any such limitations.\n\nPlease check & advice if this could be a potential bug.", "is_private": false, "id": 185082, "creation_time": "2015-09-10T17:13:02Z", "time": "2015-09-10T17:13:02Z", "creator": "nirbhaypundir@gmail.com", "bug_id": 58356, "attachment_id": null}]