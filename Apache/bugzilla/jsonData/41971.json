[{"count": 0, "tags": [], "bug_id": 41971, "text": "With POI 2.5.1, whenever you changed a cell on which a formula depended, that\nformula got reevaluated once you reopened the modified document in Excel.\n\nIn 3.0 (both from the repository and the latest dev \"release\" from the download\nsection), that doesn't seem to happy anymore.\n\nSimple Example:\n\nsuppose you have the following Excel document:\n\nA1:  somefoo\nA2:  =A1\n\nafter modifying A1 with POI to contain 22 instead of \"somefoo\", A2 still shows\n\"somefoo\". This didn't happen with 2.5.1.\n\nPressing F9 doesn't help, but one workaround I found: replace all occurences of\n'=' in the sheet with '='. Yes, it's the same character, but since it \"touches\"\nthe formula cells, it forces Excel to reevaluate them (probably because Excel\nthinks you just changed them).\n\nSo I'm actually contemplating to add a macro which does exactly that on load,\nfor every sheet in the correct order, but that's a rather crude workaround.\n\nMaybe it's worth noting that I'm not using POI directly, but JXLS, which uses\nPOI as backend.", "id": 101113, "time": "2007-03-28T08:59:33Z", "creator": "julien.oster@terrasel.de", "creation_time": "2007-03-28T08:59:33Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 41971, "attachment_id": null, "text": "[copying and pasting from a mail which I just sent to the mailing list]\n\nHello,\n\nwhat exactly is an IterationRecord for?\nhttp://jakarta.apache.org/poi/apidocs/org/apache/poi/hssf/record/IterationRecord.html\n\nI especially wonder why it's set to false upon document creation, as the\ndescription somehow seems like it would control whether depending formulas are\nrecalculated upon modification of cells/other formulas.\n\nThe reason why I'm interested is because I have a document where formulas aren't\nrecalculated. After modifying the cells on which the formulas depend and saving\nthe document (JXLS does that using POI), the formula cells still show their old\nvalue before modification.\n\nI can trigger recalculation by pressing F2 or somehow modifying the formulas, or\nat least pretending to do so. For example, searching and replacing '=' with '='\n(yes, same character) in a sheet will update the formulas to their correct value.\n\nHowever, it's an existing document, so maybe createIteration() isn't even\ncalled. Maybe it's still connected to the IterationRecord?\n\nThat issue wasn't present in POI 2.5.1.\n\nI also added a bug: http://issues.apache.org/bugzilla/show_bug.cgi?id=41971\n\nRegards,\nJulien", "id": 101213, "time": "2007-03-30T03:58:21Z", "creator": "julien.oster@terrasel.de", "creation_time": "2007-03-30T03:58:21Z", "is_private": false}, {"count": 2, "tags": [], "creator": "aktizol@gmail.com", "attachment_id": null, "text": "we have the same problem with POI 3.0.1\n\nafter opening/editing an excel spreadsheet and then saving the file, the\nformulas are not re-calculating automatically. in POI 2.5.1 it is working fine.", "id": 110849, "time": "2007-11-20T07:06:23Z", "bug_id": 41971, "creation_time": "2007-11-20T07:06:23Z", "is_private": false}, {"count": 3, "attachment_id": null, "bug_id": 41971, "text": "(In reply to comment #1)\n> [copying and pasting from a mail which I just sent to the mailing list]\n> \n> Hello,\n> \n> what exactly is an IterationRecord for?\n>\nhttp://jakarta.apache.org/poi/apidocs/org/apache/poi/hssf/record/IterationRecord.html\n> \n> I especially wonder why it's set to false upon document creation, as the\n> description somehow seems like it would control whether depending formulas are\n> recalculated upon modification of cells/other formulas.\n> \n> The reason why I'm interested is because I have a document where formulas aren't\n> recalculated. After modifying the cells on which the formulas depend and saving\n> the document (JXLS does that using POI), the formula cells still show their old\n> value before modification.\n> \n> I can trigger recalculation by pressing F2 or somehow modifying the formulas, or\n> at least pretending to do so. For example, searching and replacing '=' with '='\n> (yes, same character) in a sheet will update the formulas to their correct value.\n> \n> However, it's an existing document, so maybe createIteration() isn't even\n> called. Maybe it's still connected to the IterationRecord?\n> \n> That issue wasn't present in POI 2.5.1.\n> \n> I also added a bug: http://issues.apache.org/bugzilla/show_bug.cgi?id=41971\n> \n> Regards,\n> Julien\n\nyes, I have the same problem here, with 2.5.1 everything is fine.\nanother workaround is to pres CTRL+SHIFT+F9 or to record a macro with VBA to\nrecalculate all fields on document start.\n", "id": 110850, "time": "2007-11-20T07:10:02Z", "creator": "aktizol@gmail.com", "creation_time": "2007-11-20T07:10:02Z", "tags": [], "is_private": false}, {"count": 4, "attachment_id": null, "bug_id": 41971, "is_private": false, "id": 110906, "time": "2007-11-21T02:23:18Z", "creator": "apache@gagravarr.org", "creation_time": "2007-11-21T02:23:18Z", "tags": [], "text": "With POI 3.x, you can do formulas properly now. If you're editing cells used in\nformulas, then either add a vb macro to trigger a full re-calculate, or use the\nformula code in POI to recalculate the values."}, {"count": 5, "tags": [], "creator": "peter@breitling.name", "attachment_id": null, "is_private": false, "id": 110934, "time": "2007-11-21T08:53:52Z", "bug_id": 41971, "creation_time": "2007-11-21T08:53:52Z", "text": "in our use-case we import a complete sheet as a template (from the user), modify some cells of it, and \noutput the result (to the user). \n\nThus we don't know which formulas exist and are dependent of the modified cells. So we need to do a full \nrecalculation of all sheets before we output the result.\n\nHow would you recalculate all existing cells in all sheets using POI effectively?\n\nA VB Macro ist not what we want, as this will depend on the client excel version and the permissions to \nexecute."}, {"count": 6, "attachment_id": null, "bug_id": 41971, "is_private": false, "id": 112714, "time": "2008-01-09T15:26:30Z", "creator": "apache@gagravarr.org", "creation_time": "2008-01-09T15:26:30Z", "tags": [], "text": "See <http://poi.apache.org/hssf/eval.html#EvaluateAll> - it's about 10 lines of code\n\n(There are also a few recalculation related booleans on the underling formula\nrecord, you could always play with those if you don't fancy just using the\nformula parser)"}, {"count": 7, "text": "The evaluateInCell Method removes the original formulas and replaces it with the result value. The \nresulting excel is unusable for our client.\n\nWe can not use poi 3x as we used to with poi 2.5: Load Template, inject some new cell values, save the \nresult in a reliable manner.", "bug_id": 41971, "attachment_id": null, "id": 113103, "time": "2008-01-24T05:01:20Z", "creator": "peter@breitling.name", "creation_time": "2008-01-24T05:01:20Z", "tags": [], "is_private": false}, {"count": 8, "tags": [], "bug_id": 41971, "attachment_id": null, "id": 113110, "time": "2008-01-24T07:44:05Z", "creator": "apache@gagravarr.org", "creation_time": "2008-01-24T07:44:05Z", "is_private": false, "text": "(In reply to comment #7)\n> The evaluateInCell Method removes the original formulas and replaces it with\nthe result value. The \n> resulting excel is unusable for our client.\n\nAh, so it does, my bad :( Sorry about that\n\nI've updated the docs at <http://poi.apache.org/hssf/eval.html#EvaluateAll>\n\nYou'll want a svn checkout for evaluator.evaluateFormulaCell(c), but that should\ndo what you want (I even wrote a test to check that!). Also, with a svn\ncheckout, there's a new flag on a sheet to allow you to request a complete\nformula re-evaluation from excel on the next load. That might also work for you"}]