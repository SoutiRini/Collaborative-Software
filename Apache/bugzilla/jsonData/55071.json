[{"count": 0, "tags": [], "creator": "bruce@iris.washington.edu", "text": "I have run into a mysterious apparent SQL exception in JDBCRealm.getPassword().\n\nPresumably, line 557 \"stmt.executeQuery()\" occasionally fails. I'm not sure why and would like to know why. \n\nHowever, the finally block contains dbConnection.commit() (line 579). This throws an exception (Connection Closed) which is then logged on line 585. \n\nIn summary, line 579 should be surrounded by a try catch.", "id": 167705, "time": "2013-06-06T22:26:48Z", "bug_id": 55071, "creation_time": "2013-06-06T22:26:48Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "chris@christopherschultz.net", "attachment_id": null, "id": 167714, "time": "2013-06-07T14:18:28Z", "bug_id": 55071, "creation_time": "2013-06-07T14:18:28Z", "is_private": false, "text": "That commit() looks weird to me. COMMIT after SELECT?"}, {"count": 2, "text": "I was wondering about that. I never do that on SELECT statements myself. After I read that piece of code, I was thinking that perhaps I've been doing SQL wrong for all these years! \n\nLooking at http://docs.oracle.com/javase/6/docs/api/java/sql/Connection.html#setAutoCommit%28%29 it sounds like rs.close() commits the select. \n\nSo perhaps the solution is to just get rid of the commit() statement.", "bug_id": 55071, "attachment_id": null, "id": 167722, "time": "2013-06-07T16:03:53Z", "creator": "bruce@iris.washington.edu", "creation_time": "2013-06-07T16:03:53Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "creator": "chris@christopherschultz.net", "attachment_id": null, "id": 167724, "time": "2013-06-07T16:20:31Z", "bug_id": 55071, "creation_time": "2013-06-07T16:20:31Z", "is_private": false, "text": "While this is likely to be fixed, you should understand that JDBCRealm is not appropriate for any real-world situation. Instead, you should use DataSourceRealm, which is much more robust."}, {"count": 4, "tags": [], "bug_id": 55071, "attachment_id": null, "text": "Thanks I've made the switch.", "id": 167726, "time": "2013-06-07T18:52:48Z", "creator": "bruce@iris.washington.edu", "creation_time": "2013-06-07T18:52:48Z", "is_private": false}, {"count": 5, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 167944, "time": "2013-06-20T20:04:27Z", "bug_id": 55071, "creation_time": "2013-06-20T20:04:27Z", "is_private": false, "text": "Ah, the joys of svn archeology.\n\nThe dbConnection.commit() is a result of fixing 10623. I am not convinced it was ever necessary. The fix for 10623 also added the rs.close() which does essentially the same thing.\n\nThis has been fixed in trunk and 7.0.x and will be included in 7.0.42 onwards."}, {"count": 6, "tags": [], "bug_id": 55071, "attachment_id": null, "id": 167948, "time": "2013-06-20T21:39:44Z", "creator": "markt@apache.org", "creation_time": "2013-06-20T21:39:44Z", "is_private": false, "text": "Opps. My analysis assumed autoCommit == true which it doesn't. The commit is therefore required. I've restored it and cleaned up the code."}, {"count": 7, "tags": [], "bug_id": 55071, "text": "I still think commit() should not be called. For the shared-connection of JDBCRealm to ever be put into auto-commit=false would be an enormous mistake, assuming any data modification was taking place... which it is not.", "id": 167950, "time": "2013-06-20T21:48:05Z", "creator": "chris@christopherschultz.net", "creation_time": "2013-06-20T21:48:05Z", "is_private": false, "attachment_id": null}]