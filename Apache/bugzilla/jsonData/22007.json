[{"count": 0, "attachment_id": null, "bug_id": 22007, "is_private": false, "id": 41814, "time": "2003-07-31T00:09:35Z", "creator": "magellan94@hotmail.com", "creation_time": "2003-07-31T00:09:35Z", "tags": [], "text": "A copy task that uses replacetokens to replace a key with an empty string \nthrows a StringIndexOutOfBoundsException. For example:\n    <copy tofile=\"${destfile}\" file=\"${srcfile}\">\n      <filterchain>\n        <replacetokens>\n          <!-- replace @someKey@ with nothing -->\n          <token key=\"someKey\" value=\"\"/>\n        </replacetokens>\n      </filterchain>\n    </copy>\n\nWorkaround: Set the token value to a single space instead of the empty String:\n          <!-- replace @someKey@ with a space \" \" -->\n          <token key=\"someKey\" value=\" \"/>\n\nThe bug is caused by this code in ReplaceTokens.java\n    public final int read() throws IOException {\n        // ...snip...\n        // the call to String.charAt throws a StringIndexOutOfBoundsException\n\n        if (replaceIndex != -1) { // line 159\n            final int ch = replaceData.charAt(replaceIndex++);\n            if (replaceIndex >= replaceData.length()) {\n                replaceIndex = -1;\n            }\n            return ch;\n        }"}, {"count": 1, "tags": [], "creator": "antoine@apache.org", "text": "I have tried your build snippet, and I do not have any problem (with ant 1.\n6alpha). Actually, the bug has already been fixed in CVS.\n\n*** This bug has been marked as a duplicate of 18625 ***", "id": 41837, "time": "2003-07-31T09:51:26Z", "bug_id": 22007, "creation_time": "2003-07-31T09:51:26Z", "is_private": false, "attachment_id": null}]