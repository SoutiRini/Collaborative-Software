[{"count": 0, "tags": [], "bug_id": 50967, "text": "When trying to create the object HSSFWorkbook i got the following exception:\n\norg.apache.poi.hssf.record.RecordFormatException: Unhandled Continue Record at org.apache.poi.hssf.record.RecordFactoryInputStream.readNextRecord(RecordFactoryInputStream.java:342)\n        at org.apache.poi.hssf.record.RecordFactoryInputStream.nextRecord(RecordFactoryInputStream.java:236)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:392)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:276)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:201)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:317)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:298)\n\nAttached the file used.\n\nThanks in advance for your help!!", "id": 145236, "time": "2011-03-24T11:52:11Z", "creator": "jerojacobo@gmail.com", "creation_time": "2011-03-24T11:52:11Z", "is_private": false, "attachment_id": null}, {"count": 1, "text": "Could you please try with 3.8 beta 1 and see if that fixes it? There have been some fixes in this area since 3.7.", "bug_id": 50967, "attachment_id": null, "id": 145238, "time": "2011-03-24T11:54:07Z", "creator": "apache@gagravarr.org", "creation_time": "2011-03-24T11:54:07Z", "tags": [], "is_private": false}, {"count": 2, "attachment_id": 26796, "bug_id": 50967, "text": "Created attachment 26796\nerror by creating HSSFWorkbook\n\nthe XLS file ist in the zip file", "id": 145239, "time": "2011-03-24T12:00:24Z", "creator": "jerojacobo@gmail.com", "creation_time": "2011-03-24T12:00:24Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 50967, "text": "(In reply to comment #1)\n> Could you please try with 3.8 beta 1 and see if that fixes it? There have been\n> some fixes in this area since 3.7.\n\nOk, i tried with 3.8 as well, here the exception:\n\norg.apache.poi.hssf.record.RecordFormatException: Unhandled Continue Record followining class org.apache.poi.hssf.record.ExtSSTRecord at org.apache.poi.hssf.record.RecordFactoryInputStream.readNextRecord(RecordFactoryInputStream.java:342)\n        at org.apache.poi.hssf.record.RecordFactoryInputStream.nextRecord(RecordFactoryInputStream.java:236)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:442)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:298)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:260)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:204)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:340)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:321)\n\n\nThanks for your help!", "id": 145240, "time": "2011-03-24T12:06:39Z", "creator": "jerojacobo@gmail.com", "creation_time": "2011-03-24T12:06:39Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 50967, "attachment_id": null, "id": 145255, "time": "2011-03-25T08:59:31Z", "creator": "yegor@dinom.ru", "creation_time": "2011-03-25T08:59:31Z", "is_private": false, "text": "What software created this file? Excel 2010 complains that the file is unreadable and when I click Yes to recover then nothing happens. \n\nOpenOffice can read this file OK. \n\nYegor"}, {"attachment_id": null, "tags": [], "bug_id": 50967, "is_private": false, "count": 5, "id": 145257, "time": "2011-03-25T11:14:55Z", "creator": "jerojacobo@gmail.com", "creation_time": "2011-03-25T11:14:55Z", "text": "Hello, \nthanks for your response. It is hard to tell the software that created the file. We receive a lot of files from different customers and each of them has his own software.\nThis is not the only file which throws the exception, so a one-time-error can be discarded.\n\nBR\n\n\n(In reply to comment #4)\n> What software created this file? Excel 2010 complains that the file is\n> unreadable and when I click Yes to recover then nothing happens. \n> \n> OpenOffice can read this file OK. \n> \n> Yegor"}, {"count": 6, "tags": [], "bug_id": 50967, "attachment_id": null, "id": 145309, "time": "2011-03-27T06:34:57Z", "creator": "yegor@dinom.ru", "creation_time": "2011-03-27T06:34:57Z", "is_private": false, "text": "Fixed in r1085900, junit added. \n\nStrictly speaking, the problematic ExtSST record is not correct.\n\nThis record stores a set of buckets that are used to perform a quick lookup of a string within the shared string table.\n\nAccording to the Excel spec (section 2.4.107 ExtSST), the number of buckets depends on the number of unique strings in the workbook and defined by the following formula:\n\nnumBuckets = num_unique_strings mod max(((num_unique_strings / 128) + 1),8)\n\nIn your file num_unique_strings=12378 and the number of buckets should be \n\n\nnumBuckets = 12378 % Math.max(12378 / 128 + 1, 8) = 59\n\nThe bucket size is eight bytes and the expected record length is 8 + 2 + 59*8 = 482 bytes.\n\nIn your file numBuckets=1548 and the record size including the continue remainder is 12394 bytes! \n\nExcel 2003 and OpenOffice can read the attached file without any warnings, but on re-save the ExtSST record is truncated to match the formulas above. I fixed POI to behave similarly. Excel2010 can't read such file which seems a regression. \n\nYegor"}, {"count": 7, "tags": [], "bug_id": 50967, "text": "Hello Yegor,\n\nmany thanks for your effort!! I really appreciate it. \nJust one more question, do I have to wait until 3.8-beta2 or is there another way to start using it?\n\nBR.", "id": 145332, "time": "2011-03-28T03:27:01Z", "creator": "jerojacobo@gmail.com", "creation_time": "2011-03-28T03:27:01Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 50967, "attachment_id": null, "id": 145333, "time": "2011-03-28T03:27:54Z", "creator": "jerojacobo@gmail.com", "creation_time": "2011-03-28T03:27:54Z", "is_private": false, "text": "Hello Yegor,\n\nmany thanks for your effort!! I really appreciate it. \nJust one more question, do I have to wait until 3.8-beta2 or is there another way to start using it?\n\nBR."}, {"attachment_id": null, "tags": [], "bug_id": 50967, "text": "I got the same exception by using LibreOffice 3.3 (LibreOffice 3.3.2 \nOOO330m19 (Build:202)\ntag libreoffice-3.3.2.2", "count": 9, "id": 145460, "time": "2011-04-01T08:28:01Z", "creator": "fr.koala@gmail.com", "creation_time": "2011-04-01T08:28:01Z", "is_private": false}, {"count": 10, "tags": [], "bug_id": 50967, "attachment_id": null, "id": 145467, "time": "2011-04-01T09:43:25Z", "creator": "yegor@dinom.ru", "creation_time": "2011-04-01T09:43:25Z", "is_private": false, "text": "(In reply to comment #9)\n> I got the same exception by using LibreOffice 3.3 (LibreOffice 3.3.2 \n> OOO330m19 (Build:202)\n> tag libreoffice-3.3.2.2\n\nWhich version of POI? The problem was fixed in r1085900 on 2011-03-27. Please try the latest build from trunk. \n\nIf the problem is still there, please upload the problematic file, without it we can't do much.\n\nYegor"}, {"count": 11, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "text": "\n(In reply to comment #8)\n> Hello Yegor,\n> \n> many thanks for your effort!! I really appreciate it. \n> Just one more question, do I have to wait until 3.8-beta2 or is there another\n> way to start using it?\n> \n\nIf all is OK, 3.8-beta2 will be on the mirrors after April 8. The release vote on the poi-dev list is in progress and you are welcome to vote.\n\nIf you want to try ASAP then build POI jars yourself or download daily builds from http://encore.torchbox.com/poi-cvs-build/\n\nYegor", "id": 145468, "time": "2011-04-01T09:46:19Z", "bug_id": 50967, "creation_time": "2011-04-01T09:46:19Z", "is_private": false}]