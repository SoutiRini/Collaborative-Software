[{"count": 0, "tags": [], "bug_id": 18311, "attachment_id": null, "is_private": false, "id": 33737, "time": "2003-03-25T10:42:41Z", "creator": "gaughana@ebrd.com", "creation_time": "2003-03-25T10:42:41Z", "text": "I think this bug is related to 15223 but I am logging it again because I think \nI have a bit more detail.\nThis appears to be one of those obscure bugs that only appears under certain \ncircumstances.\n\nI am reading an existing Excel workbook (excel.xls), amending some values \n(omitted from the test case) and writing out the resultant workbook (poi.xls).\nIn Excel creating the original workbook, I have entered two rows of numbers.\nI have also defined a summation row. I declare a formula for a cell, copy it \nthen :-\n1)  paste it individually to any number of subsequent cells across a row\n        the workbook is written out correctly\n2)  paste it simultaneously to up to 5 subsequent cells in the row\n        the workbook is written out correctly\n3)  paste it simultaneously to more than 5 subsequent cells in the row\n        the original formula cell is OK but the others have #REF! error\n        and when the workbook is opened in Excel you get the error\n            \"File error: data may have been lost.\"\n\nTest Case\n---------\n\tString filename = \"Excel.xls\" ;\n\tFileInputStream  fis = new FileInputStream( filename );\n\tPOIFSFileSystem  fs  = new POIFSFileSystem( fis );\n\tHSSFWorkbook     wb  = new HSSFWorkbook( fs );\n\n\tFileOutputStream fos = new FileOutputStream( \"Poi.xls\" );\n\twb.write( fos );\n\tfos.close();\n\nEnvironment\n-----------\nPOI   : jakarta-poi-1.11.0-dev-20030324.jar\nJava  : 1.4.1 b21\nExcel : 2002 SP-2\nOS    : XP 5.1.2600"}, {"count": 1, "tags": [], "creator": "gaughana@ebrd.com", "attachment_id": 5490, "id": 33739, "time": "2003-03-25T10:49:15Z", "bug_id": 18311, "creation_time": "2003-03-25T10:49:15Z", "is_private": false, "text": "Created attachment 5490\nOriginal Excel workbook"}, {"count": 2, "tags": [], "creator": "gaughana@ebrd.com", "is_private": false, "text": "Created attachment 5492\nOutput Excel written by POI", "id": 33741, "time": "2003-03-25T10:49:58Z", "bug_id": 18311, "creation_time": "2003-03-25T10:49:58Z", "attachment_id": 5492}, {"count": 3, "tags": [], "bug_id": 18311, "attachment_id": null, "text": "I think I know why...This looks like something Avik or Glen (which one?) worked\non awhile bakc...", "id": 41361, "time": "2003-07-24T16:00:46Z", "creator": "poi-support@buni.org", "creation_time": "2003-07-24T16:00:46Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 18311, "attachment_id": null, "text": "Is there a fix for it?", "id": 41488, "time": "2003-07-25T09:21:00Z", "creator": "gaughana@ebrd.com", "creation_time": "2003-07-25T09:21:00Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 18311, "attachment_id": null, "text": "this looks like a shared formula which we added to release_2_branch..can u\nverify with 2.0pre2", "id": 41523, "time": "2003-07-25T15:20:45Z", "creator": "dmui@apache.org", "creation_time": "2003-07-25T15:20:45Z", "is_private": false}, {"count": 6, "tags": [], "creator": "tgkprog@gmail.com", "is_private": false, "text": "A workaround I used is: split the formula across multiple cells; use something \nlike =IF((BH4>BX4),BH4,0)*IF(BK4>BX4,BK4,0) instead of =IF((BH4<>\"\"),IF\n(BK4<>\"\",BH4*BK4,0),0)", "id": 80105, "time": "2005-09-19T13:05:27Z", "bug_id": 18311, "creation_time": "2005-09-19T13:05:27Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 18311, "attachment_id": null, "text": "Shared Formula support now in SVN. Marking as fixed.", "id": 91577, "time": "2006-07-25T14:29:01Z", "creator": "jheight@apache.org", "creation_time": "2006-07-25T14:29:01Z", "is_private": false}]