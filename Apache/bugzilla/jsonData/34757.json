[{"count": 0, "tags": [], "text": "using the load-on-start tag seem to cause the application to be deployed twice. \nit does not matter if the value of the tag is 1 or 0 the duplicate deplyment \nwill take place.   if the load-on-startup tag is not included in the web.xml, \nthe application will deploy once as expected.\n\nthe environemnt checked for this is tomcat 5.5.9 + compat package on \njdk1.4.2_04 with only the server.xml slightly modified to include the context \nelement (see below). i used jforum 2.0.2 as the application and added to its \nmain forum servlet a load-on-startup tag in the web.xml (see below).\n\n-----my server.xml------\n<!-- Example Server Configuration File -->\n<!-- Note that component elements are nested corresponding to their\n     parent-child relationships with each other -->\n\n<!-- A \"Server\" is a singleton element that represents the entire JVM,\n     which may contain one or more \"Service\" instances.  The Server\n     listens for a shutdown command on the indicated port.\n\n     Note:  A \"Server\" is not itself a \"Container\", so you may not\n     define subcomponents such as \"Valves\" or \"Loggers\" at this level.\n -->\n\n<Server port=\"8005\" shutdown=\"SHUTDOWN\">\n\n  <!-- Comment these entries out to disable JMX MBeans support used for the \n       administration web application -->\n  <Listener className=\"org.apache.catalina.mbeans.ServerLifecycleListener\" />\n  <Listener \nclassName=\"org.apache.catalina.mbeans.GlobalResourcesLifecycleListener\" />\n  <Listener \nclassName=\"org.apache.catalina.storeconfig.StoreConfigLifecycleListener\"/>\n\n  <!-- Global JNDI resources -->\n\n  <GlobalNamingResources>\n\n    <!-- Test entry for demonstration purposes -->\n    <Environment name=\"simpleValue\" type=\"java.lang.Integer\" value=\"30\"/>\n\n    <!-- Editable user database that can also be used by\n         UserDatabaseRealm to authenticate users -->\n    <Resource name=\"UserDatabase\" auth=\"Container\"\n              type=\"org.apache.catalina.UserDatabase\"\n       description=\"User database that can be updated and saved\"\n           factory=\"org.apache.catalina.users.MemoryUserDatabaseFactory\"\n          pathname=\"conf/tomcat-users.xml\" />\n\n  </GlobalNamingResources>\n\n  <Service name=\"Catalina\">\n\n    <Connector port=\"8080\" maxHttpHeaderSize=\"8192\"\n               maxThreads=\"150\" minSpareThreads=\"25\" maxSpareThreads=\"75\"\n               enableLookups=\"false\" redirectPort=\"8443\" acceptCount=\"100\"\n               connectionTimeout=\"20000\" disableUploadTimeout=\"true\" />\n\n    <Connector port=\"8009\" \n               enableLookups=\"false\" redirectPort=\"8443\" protocol=\"AJP/1.3\" />\n\n    <Engine name=\"Catalina\" defaultHost=\"localhost\">\n\n\n      <Realm className=\"org.apache.catalina.realm.UserDatabaseRealm\"\n             resourceName=\"UserDatabase\"/>\n\n\n      <Host name=\"localhost\" appBase=\"webapps\"\n       unpackWARs=\"true\" autoDeploy=\"true\"\n       xmlValidation=\"false\" xmlNamespaceAware=\"false\">\n\n        <Context crossContext=\"false\" \n        \t path=\"/forum\"\n                 docBase=\"JForum-2.0.2\"\n                 debug=\"0\" reloadable=\"true\">\n        </Context>\n\n      </Host>\n\n    </Engine>\n\n  </Service>\n\n</Server>\n\n------my web.xml-----\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\n<!DOCTYPE web-app\n    PUBLIC \"-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN\"\n    \"http://java.sun.com/dtd/web-app_2_3.dtd\">\n<web-app>\n    <listener>\n    \t<listener-class>net.jforum.ForumSessionListener</listener-class>\n    </listener>   \n\n\n    <servlet>\n\t\t<servlet-name>jforum</servlet-name>\n\t\t<servlet-class>net.jforum.JForum</servlet-class>\n\t\t\n\t\t<init-param>\n\t\t\t<param-name>development</param-name>\n\t\t\t<param-value>true</param-value>\n\t\t</init-param>\n\t\t<load-on-startup>1</load-on-startup>\n    </servlet>\n    \n    <servlet>\n    \t<servlet-name>install</servlet-name>\n    \t<servlet-class>net.jforum.InstallServlet</servlet-class>\n    \t\n    \t<init-param>\n\t\t\t<param-name>development</param-name>\n\t\t\t<param-value>true</param-value>\n\t\t</init-param>\n    </servlet>\n    \n    <!-- SERVLETS -->\n    <servlet-mapping>\n    \t<servlet-name>install</servlet-name>\n    \t<url-pattern>/install/install.page</url-pattern>\n    </servlet-mapping>\n    \n\t<servlet-mapping>\n    \t<servlet-name>jforum</servlet-name>\n    \t<url-pattern>*.page</url-pattern>\n    </servlet-mapping>\n\n    <!-- SESSION -->\n    <session-config>\n    \t<session-timeout>10</session-timeout>\n    </session-config>\n</web-app>", "attachment_id": null, "bug_id": 34757, "id": 74475, "time": "2005-05-05T14:21:26Z", "creator": "gkatz@allot.com", "creation_time": "2005-05-05T14:21:26Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 34757, "attachment_id": null, "is_private": false, "id": 74479, "time": "2005-05-05T15:02:31Z", "creator": "yoavs@computer.org", "creation_time": "2005-05-05T15:02:31Z", "text": "Double deployment is because you have both an explicit Context and\nautoDeploy=true on the Host.  Pick one, don't use both at the same time."}]