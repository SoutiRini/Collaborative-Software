[{"count": 0, "tags": [], "bug_id": 44338, "is_private": false, "text": "- I downloaded and installed apache_2.0.63-win32-x86-no_ssl.msi \n- activated the delfate module by adding the following line to httpd.conf\n\nLoadModule deflate_module modules/mod_deflate.so\n\n- configured the following compression settings:\n\n<Location />\n\t# Insert filter\n\tAddOutputFilterByType DEFLATE text/html text/plain text/css text/javascript\n\n\t# NOTE: Due to a bug in mod_setenvif up to Apache 2.0.48\n\t# the above regex won't work. You can use the following\n\t# workaround to get the desired effect:\n\tBrowserMatch \\bMSI[E] !no-gzip !gzip-only-text/html\n\n\t# Don't compress images\n\tSetEnvIfNoCase Request_URI \\\n\t\\.(?:gif|jpe?g|png|pdf|gz|zip)$ no-gzip dont-vary\n\n\t# Make sure proxies don't deliver the wrong content\n\tHeader append Vary User-Agent env=!dont-vary\n</Location>\n\n<Files *.js>\n\tForceType text/javascript\n</Files>\n\n- After restarting apache and reloading the default index.html mod_deflate\ncrashes and wants to start a debug session - no content is delivery to the\nclient browser", "id": 113332, "time": "2008-02-01T02:00:09Z", "creator": "tom@einwaller.net", "creation_time": "2008-02-01T02:00:09Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 44338, "is_private": false, "text": "I've succeeded to reproduce the crash.", "id": 113333, "time": "2008-02-01T03:34:53Z", "creator": "takashi.asfbugzilla@tks.st", "creation_time": "2008-02-01T03:34:53Z", "attachment_id": null}, {"count": 2, "attachment_id": null, "creator": "takashi.asfbugzilla@tks.st", "is_private": false, "id": 113336, "time": "2008-02-01T05:07:12Z", "bug_id": 44338, "creation_time": "2008-02-01T05:07:12Z", "tags": [], "text": "(In reply to comment #1)\n> I've succeeded to reproduce the crash.\n\nI'm able to reproduce it with the official apache_2.0.63-win32-x86-no_ssl.msi,\nbut I can't debug because dist/httpd/binaries/win32/symbols/apache_2.0.63-\nwin32-x86-no_ssl-symbols.zip is missing.\nSo I tried to build debug build with httpd-2.0.63-win32-src.zip, VC++2005 and \nzlib 1.1.4, and it works fine.\n"}, {"count": 3, "tags": [], "bug_id": 44338, "text": "apache_2.0.63-win32-x86-no_ssl-symbols.zip has become available, so I'm \ndebugging the ASF official build.\nbut I can't find out what is wrong because of lack of my skill.\n\n\n \tntdll.dll!7c951669() \t\n \tntdll.dll!7c95082c() \t\n\tmod_deflate.so!gen_codes(ct_data_s * tree=0x00010008, int max_code=18, \nunsigned short * bl_count=0x00997b5c)  line 604 + 0x1a bytes\tC\n \tmod_deflate.so!build_tree(internal_state * s=0x0000ffff, tree_desc_s * \ndesc=0x00000001)  line 700 + 0x12 bytes\tC\n \tmod_deflate.so!send_all_trees(internal_state * s=0x002c0000, int \nlcodes=0, int dcodes=10127080, int blcodes=666)  line 860 + 0x13 bytes\tC\n \tmsvcrt.dll!77bdc2de() \t\n \tmod_deflate.so!zcfree(void * opaque=0x00000000, void * \nptr=0x009a86e8)  line 314 + 0xb bytes\tC\n \tmod_deflate.so!deflateEnd(z_stream_s * strm=0x00993818)  line 586 + \n0x12 bytes\tC\n \tmod_deflate.so!deflate_out_filter(ap_filter_t * f=0x00987e1d, \napr_bucket_brigade * bb=0x009938e0)  line 502\tC\n \tlibhttpd.dll!ap_pass_brigade(ap_filter_t * next=0x00993650, \napr_bucket_brigade * bb=0x009937f0)  line 512 + 0x7 bytes\tC\n \tlibhttpd.dll!default_handler(request_rec * r=0x009936b8)  line 3651\n\tC\n \tlibhttpd.dll!ap_run_handler(request_rec * r=0x00990cd8)  line 153 + \n0x1f bytes\tC\n \tlibhttpd.dll!ap_invoke_handler(request_rec * r=0x00990cb8)  line 368\n\tC\n \tmod_negotiation.so!handle_map_file(request_rec * r=0x0098dea8)  line \n2943\tC\n \tlibhttpd.dll!ap_run_handler(request_rec * r=0x00986fa8)  line 153 + \n0x1f bytes\tC\n \tlibhttpd.dll!ap_invoke_handler(request_rec * r=0x00986fa8)  line 368\n\tC\n \tlibhttpd.dll!ap_process_http_connection(conn_rec * c=0x0097f068)  line \n253 + 0x6 bytes\tC\n \tlibhttpd.dll!ap_run_process_connection(conn_rec * c=0x0097f068)  line \n43 + 0x1f bytes\tC\n \tlibhttpd.dll!ap_process_connection(conn_rec * c=0x0097f068, void * \ncsd=0x0097ef98)  line 176 + 0x6 bytes\tC\n \tlibhttpd.dll!worker_main(void * thread_num_val=0x0097f060)  line 734\n\tC\n \tmsvcrt.dll!77bea3b0() \t\n \tkernel32.dll!7c80b703() \t\n", "id": 113998, "time": "2008-02-21T17:25:00Z", "creator": "takashi.asfbugzilla@tks.st", "creation_time": "2008-02-21T17:25:00Z", "is_private": false, "attachment_id": null}, {"count": 4, "text": "After upgrading from 2.0.58 to 2.0.63 mod_deflate started to cause all king of problems. I run Apache on Windows Server 2008. mod_deflate results in lock up of Apache, which causes Apache to use 100% CPU in some occasions. In other occasions mod_deflate just produces an empty output. After I reverted only this module back to .58 version everything come back to normal.", "bug_id": 44338, "is_private": false, "id": 116779, "time": "2008-05-18T11:35:21Z", "creator": "vlad.sharanhovich@gmail.com", "creation_time": "2008-05-18T11:35:21Z", "tags": [], "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 44338, "text": "The funny thing is that the code of mod_deflate in 2.0.58 and 2.0.63 is exactly the same.", "id": 116786, "time": "2008-05-18T13:18:21Z", "creator": "rpluem@apache.org", "creation_time": "2008-05-18T13:18:21Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 44338, "is_private": false, "text": "Then it is compiled differently. The size of .so file is bigger in .63.", "id": 116790, "time": "2008-05-18T22:04:21Z", "creator": "vlad.sharanhovich@gmail.com", "creation_time": "2008-05-18T22:04:21Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 44338, "text": "Something similar is with apache_2.0.63-win32-x86-openssl-0.9.7m.msi\nWhen I upgraded from 2.0.50 to 2.0.63, deflate stopped working properly. From what I saw by 'lynx -verbose -mime_header http://127.0.0.1/', I can add, that the size of output is rediculously small. File with 42k bytes in it, being compressed by 'gzip -9' to 8k bytes was outputted by Apache+mod_deflate to 124 bytes  (and could not be read as deflated output). Also Apache raised an exception (but stayed resident).", "id": 118990, "time": "2008-07-24T10:30:47Z", "creator": "gja822@ngs.ru", "creation_time": "2008-07-24T10:30:47Z", "is_private": false, "attachment_id": null}, {"count": 8, "attachment_id": null, "creator": "wrowe@apache.org", "is_private": false, "id": 119232, "time": "2008-08-01T12:43:39Z", "bug_id": 44338, "creation_time": "2008-08-01T12:43:39Z", "tags": [], "text": "FYI, Apache 2.2 is built using zlib.dll version 1.2.3 dynamically, instead\nof using the sources of 1.1.4 statically.  You might try upgrading to 2.2.\n\nIn the interim, if we repackage apache 2.0.63, I'll be sure to study what\nis going on here and see if we need to change the build mechanics for 2.0.64."}, {"count": 9, "attachment_id": null, "creator": "fielding@apache.org", "is_private": false, "id": 125995, "time": "2009-04-03T18:44:58Z", "bug_id": 44338, "creation_time": "2009-04-03T18:44:58Z", "tags": [], "text": "Since this is apparently a problem with an old binary build\non a specific platform, it should have been fixed in the newer builds."}]