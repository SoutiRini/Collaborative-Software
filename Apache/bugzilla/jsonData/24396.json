[{"count": 0, "tags": [], "bug_id": 24396, "is_private": false, "text": "If a HTTP request contains more than one host header line like in\n\nGET / HTTP/1.1\nHost: host1\nHost: host2\nConnection: close\n\nall host headers get concatenated and are treated as if only one host header\ncontaining \"host1, host2\" had been given. While this makes sense for other\nheaders like X-Forwarded-For, you cannot request data from multiple hosts in one\nsingle HTTP request.\n\nRFC 2616 doesn't explicitly state that there must not be more than one host\nheader per request but I think it implies it by referring to \"the host header\"\nthroughout the document.\n\nI suggest that multiple host headers be rejected with a \"400 Bad Request\" response.", "id": 46759, "time": "2003-11-04T15:22:50Z", "creator": "apache@snakefarm.org", "creation_time": "2003-11-04T15:22:50Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 24396, "text": "Hmmm... Is there a real problem you are trying to solve here, or this\njust some theoretical issue.\n\nObviously, a client shouldn't be sending two host headers.  But if it\ndoes, I see no problem in following normal header-folding rules.  The\nresult will simply be that apache won't recognize the hostname, and will\nfall back to the default host.  That seems to be a sensible result, and\nmore polite than a 400.\n", "id": 46765, "time": "2003-11-04T16:48:40Z", "creator": "slive@apache.org", "creation_time": "2003-11-04T16:48:40Z", "is_private": false, "attachment_id": null}, {"count": 2, "attachment_id": null, "creator": "nd@perlig.de", "text": "Actually, I've posted some time ago about this issue on dev@.\n<http://marc.theaimsgroup.com/?l=apache-httpd-dev&m=103516122302207&w=2>\n\nIMHO the httpd should respond with 400, shouldn't it?", "id": 46820, "time": "2003-11-04T21:39:11Z", "bug_id": 24396, "creation_time": "2003-11-04T21:39:11Z", "tags": [], "is_private": false}, {"count": 3, "attachment_id": null, "creator": "slive@apache.org", "text": "Ok.  I buy that.", "id": 46870, "time": "2003-11-05T16:31:59Z", "bug_id": 24396, "creation_time": "2003-11-05T16:31:59Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "creator": "apache@snakefarm.org", "text": "It's not a real problem that I'm trying to solve. I just noticed some clients\nsending multiple host headers to some of our servers recently and wondered why\nthey received a \"200 OK\" response from the default host. IMHO the server should\ntell the client that something's going wrong. I mean, the host header was (in a\nway) actually invented to avoid a default answer from the server, wasn't it? :-)", "id": 46895, "attachment_id": null, "bug_id": 24396, "creation_time": "2003-11-05T22:31:54Z", "time": "2003-11-05T22:31:54Z", "is_private": false}, {"count": 5, "attachment_id": null, "bug_id": 24396, "text": "Look into folding in for 1.3.34 (and make note to see what 2.x does)", "id": 67859, "time": "2004-12-03T02:22:11Z", "creator": "jim@apache.org", "creation_time": "2004-12-03T02:22:11Z", "tags": [], "is_private": false}]