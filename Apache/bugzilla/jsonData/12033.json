[{"text": "A gracefull restart results in the following message:\n\n[Fri Aug 23 10:30:21 2002] [notice] Graceful restart requested, doing restart\n[Fri Aug 23 10:30:25 2002] [info] mod_unique_id: using ip addr 127.0.0.1\n[Fri Aug 23 10:30:26 2002] [notice] Digest: generating secret for digest authent\nication ...\n[Fri Aug 23 10:30:26 2002] [notice] Digest: done\n[Fri Aug 23 10:30:26 2002] [notice] Apache/2.0.40 (Unix) configured -- resuming\nnormal operations\n[Fri Aug 23 10:30:26 2002] [info] Server built: Aug 16 2002 01:39:38\n[Fri Aug 23 10:30:26 2002] [warn] long lost child came home! (pid 62461)\n[Fri Aug 23 10:30:26 2002] [warn] long lost child came home! (pid 62460)\n[Fri Aug 23 10:30:26 2002] [warn] long lost child came home! (pid 62459)\n[Fri Aug 23 10:30:26 2002] [warn] long lost child came home! (pid 62458)\n[Fri Aug 23 10:30:26 2002] [warn] long lost child came home! (pid 62457)\n[Fri Aug 23 10:30:26 2002] [warn] long lost child came home! (pid 62456)\n\nServer is FreeBSD 4.6 with Apache 2.0.40. A similiar problem was present in \nprevious versions, however they seemed to be related to the use of cronolog. \nCurrently, the logfilerotation tool which comes with Apache is used.\n\nServer is a basic low activity server with several virtual hosts.", "tags": [], "bug_id": 12033, "is_private": false, "count": 0, "id": 21730, "time": "2002-08-26T10:25:15Z", "creator": "info@orangexl.com", "creation_time": "2002-08-26T10:25:15Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 12033, "text": "someone told something like that:\n\napache uses PIDs for each of its childs... and it occurs, that apache uses PIDs \nmore than one time...\nand if this occurs, apache write: long lost child came home!", "id": 22253, "attachment_id": null, "creator": "josef.zellner@smartstream-md.com", "creation_time": "2002-09-04T12:29:44Z", "time": "2002-09-04T12:29:44Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 12033, "attachment_id": null, "id": 23246, "time": "2002-09-23T14:14:22Z", "creator": "panlinux@gmail.com", "creation_time": "2002-09-23T14:14:22Z", "is_private": false, "text": "Could be related, here is what I see with linux (apache-2.0.41-dev): [Mon Sep 23 11:03:35 2002] [notice] Apache/2.0.41-dev (Unix) PHP/4.2.3 DAV/2 configured -- resuming normal operations [Mon Sep 23 11:07:05 2002] [error] [client 127.0.0.1] File does not exist: /srv/www/default/html/server-status [Mon Sep 23 11:07:21 2002] [notice] Graceful restart requested, doing restart [Mon Sep 23 11:07:54 2002] [notice] seg fault or similar nasty error detected in the parent process  "}, {"count": 3, "tags": [], "bug_id": 12033, "attachment_id": null, "id": 23261, "time": "2002-09-23T18:27:20Z", "creator": "panlinux@gmail.com", "creation_time": "2002-09-23T18:27:20Z", "is_private": false, "text": "Sorry, konqueror is not bugzilla-friendly, reformating my latest post:\n\n[Mon Sep 23 11:03:35 2002] [notice] Apache/2.0.41-dev (Unix) PHP/4.2.3 DAV/2\nconfigured -- resuming normal operations\n[Mon Sep 23 11:07:05 2002] [error] [client 127.0.0.1] File does not exist:\n/srv/www/default/html/server-status\n[Mon Sep 23 11:07:21 2002] [notice] Graceful restart requested, doing restart\n[Mon Sep 23 11:07:54 2002] [notice] seg fault or similar nasty error detected in\nthe parent process"}, {"count": 4, "tags": [], "bug_id": 12033, "attachment_id": null, "id": 23362, "time": "2002-09-25T14:27:42Z", "creator": "panlinux@gmail.com", "creation_time": "2002-09-25T14:27:42Z", "is_private": false, "text": "I'm trying to download 2.0.42 to test if this persists, but for some reason I'm\nunable to reach httpd.apache.org. Will try again later."}, {"count": 5, "tags": [], "text": "Tried 2.0.42, and it still happens, but ONLY if the php module (currently 4.2.3)\nis loaded. Without the PHP module, apachectl graceful works just fine. Bummer.", "is_private": false, "id": 23378, "creator": "panlinux@gmail.com", "time": "2002-09-25T17:46:05Z", "bug_id": 12033, "creation_time": "2002-09-25T17:46:05Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 12033, "attachment_id": null, "id": 23381, "time": "2002-09-25T18:12:13Z", "creator": "info@orangexl.com", "creation_time": "2002-09-25T18:12:13Z", "is_private": false, "text": "This bug has nothing to do with PHP. It's just a \"regular\" (with_experimental) \ninstall. Did not try 2.0.42 yet."}, {"count": 7, "tags": [], "text": "Well, for me apachectl graceful only works if php is not loaded OR if php from\ntoday's CVS is used. So, for me, it's a PHP issue that is fixed in CVS.", "is_private": false, "id": 23390, "creator": "panlinux@gmail.com", "time": "2002-09-25T19:20:26Z", "bug_id": 12033, "creation_time": "2002-09-25T19:20:26Z", "attachment_id": null}, {"count": 8, "tags": [], "text": "seems to be no(t| longer) an httpd problem. Fine! ;-)", "attachment_id": null, "id": 30425, "creator": "nd@perlig.de", "time": "2003-01-31T15:55:21Z", "bug_id": 12033, "creation_time": "2003-01-31T15:55:21Z", "is_private": false}, {"count": 9, "tags": [], "text": "[Mon Feb 10 01:20:54 2003] [notice] Graceful restart requested, doing restart\n[Mon Feb 10 01:20:57 2003] [info] mod_unique_id: using ip addr 127.0.0.1\n[Mon Feb 10 01:20:58 2003] [notice] Digest: generating secret for digest authent\n[Mon Feb 10 01:20:58 2003] [notice] Digest: done\n[Mon Feb 10 01:20:58 2003] [notice] Apache/2.0.43 configured -- resuming normal\n[Mon Feb 10 01:20:58 2003] [info] Server built: Oct  7 2002 23:56:44\n[Mon Feb 10 01:20:58 2003] [warn] long lost child came home! (pid 4173)\n[Mon Feb 10 01:20:58 2003] [warn] long lost child came home! (pid 4172)\n[Mon Feb 10 01:20:58 2003] [warn] long lost child came home! (pid 4171)\n[Mon Feb 10 01:20:58 2003] [warn] long lost child came home! (pid 4170)\n[Mon Feb 10 01:20:58 2003] [warn] long lost child came home! (pid 4169)\n[Mon Feb 10 01:20:58 2003] [warn] long lost child came home! (pid 4168)\n[Mon Feb 10 01:20:58 2003] [warn] long lost child came home! (pid 4167)\n\nNo PHP, no experimental modules loaded. OS: FreeBSD 4.7-stable", "is_private": false, "bug_id": 12033, "id": 30974, "time": "2003-02-10T00:26:14Z", "creator": "info@orangexl.com", "creation_time": "2003-02-10T00:26:14Z", "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 12033, "attachment_id": null, "id": 31004, "time": "2003-02-10T14:10:08Z", "creator": "trawick@apache.org", "creation_time": "2003-02-10T14:10:08Z", "is_private": false, "text": "Sander,\n\nDo you have any piped log programs or perhaps mod_rewrite external processes,\nor any child processes created by httpd (other than those serving http\nrequests)?  I have a hunch (perhaps a bad one :( ) that when some such\nprocesses go away during restart some accounting is messed up and the MPM\ncan issue such a log message.\n\nThanks!\n"}, {"count": 11, "tags": [], "bug_id": 12033, "attachment_id": null, "id": 31005, "time": "2003-02-10T14:27:23Z", "creator": "info@orangexl.com", "creation_time": "2003-02-10T14:27:23Z", "is_private": false, "text": "The only child processes created by the httpd are the piped logs. No external \nrewrite_engine processes or other child processes.\n\nRelevant entry from my vhosts.conf:\n   CustomLog \"|/usr/local/sbin/rotatelogs /usr/local/www/domain.nl/logs/access_%\nY%m%d.log 86400\" combined\n\nI checked with ps aux, and it are the piped logs that cause the problem. (the \nPID's belong to them)."}, {"count": 12, "tags": [], "bug_id": 12033, "attachment_id": null, "is_private": false, "id": 49066, "time": "2003-12-13T21:30:33Z", "creator": "trawick@apache.org", "creation_time": "2003-12-13T21:30:33Z", "text": "still present in 2.0-HEAD, 2.1-HEAD, etc.\n\nMPMs handle other children differently for graceful restart vs. hard restart,\nresulting in these confusing log messages.\n\nap_reclaim_child_processes() is called for apachectl stop and apachectl restart,\nbut not apachectl graceful.\n\napr_proc_other_child_refresh_all(APR_OC_REASON_RESTART) is called from\nap_reclaim_child_processes() but nowhere else.  That is the code that kills\nthe piped loggers from the server generation that is currently shutting down.\nThis cleaner way of cleaning them up isn't done for graceful restart.  For\ngraceful restart, the loggers get whacked by the plog pool going away.\n\nThere are a couple of ways to fix this.  One way is for the MPM to call\napr_proc_other_child_refresh_all() for both types of restarts.  I believe that\nanother way is to change piped log maintenance function to terminate the piped\nlogger when it gets the UNREGISTER call.  That is nice because whenever the pool\ngoes POOF the piped logger will terminate cleanly, irrespective of what the MPM\ndoes (not tested :) ).  This assumes that during pool cleanup, the UNREGISTER\ncall will be made before the apr_proc_t-based process termination occurs.\n"}, {"count": 13, "tags": [], "text": "The problem is still present in 2.2.4.", "is_private": false, "id": 107942, "creator": "peter@poeml.de", "time": "2007-09-10T01:12:38Z", "bug_id": 12033, "creation_time": "2007-09-10T01:12:38Z", "attachment_id": null}, {"count": 14, "tags": [], "bug_id": 12033, "text": "CC myself on FreeBSD related bugs", "id": 124161, "attachment_id": null, "creator": "pgollucci@apache.org", "creation_time": "2009-01-18T16:19:16Z", "time": "2009-01-18T16:19:16Z", "is_private": false}, {"count": 15, "tags": [], "text": "[Sat Nov 30 19:20:28 2013] [notice] Apache/2.2.24 (Unix)   configured -- resuming normal operations\n[Mon Dec 02 18:04:04 2013] [notice] Graceful restart requested, doing restart\n[Mon Dec 02 18:04:05 2013] [notice] Apache/2.2.24 (Unix)   configured -- resuming normal operations\n[Mon Dec 02 18:04:05 2013] [warn] long lost child came home! (pid 1937)", "attachment_id": null, "id": 172868, "creator": "7raivis@inbox.lv", "time": "2014-02-02T20:19:18Z", "bug_id": 12033, "creation_time": "2014-02-02T20:19:18Z", "is_private": false}, {"count": 16, "tags": [], "bug_id": 12033, "text": " [mpm_prefork:warn] [pid 19070] AH00167: long lost child came home!(pid 19074)", "id": 179593, "attachment_id": null, "creator": "mateen.ahmed07@yahoo.com", "creation_time": "2014-12-07T04:52:14Z", "time": "2014-12-07T04:52:14Z", "is_private": false}, {"count": 17, "tags": [], "text": "[Sun Dec 07 03:21:01.970843 2014] [mpm_prefork:notice] [pid 3380] AH00171: Graceful restart requested, doing restart\n[Sun Dec 07 03:21:03.008332 2014] [mpm_prefork:notice] [pid 3380] AH00163: Apache/2.4.10 (Unix) OpenSSL/1.0.1e-fips configured -- resuming normal operations\n[Sun Dec 07 03:21:03.008344 2014] [core:notice] [pid 3380] AH00094: Command line: '/usr/sbin/httpd'\n[Sun Dec 07 03:21:03.008378 2014] [mpm_prefork:warn] [pid 3380] AH00167: long lost child came home! (pid 3384)\n\nevery sunday i gets susch messages", "attachment_id": null, "id": 179594, "creator": "mateen.ahmed07@yahoo.com", "time": "2014-12-07T04:54:23Z", "bug_id": 12033, "creation_time": "2014-12-07T04:54:23Z", "is_private": false}, {"count": 18, "tags": [], "text": "This error still occurs in version 2.4.6:\n\n[Wed Aug 26 10:41:45.668897 2015] [auth_digest:notice] [pid 4416] AH01757: generating secret for digest authentication ...\n[Wed Aug 26 10:41:45.670339 2015] [lbmethod_heartbeat:notice] [pid 4416] AH02282: No slotmem from mod_heartmonitor\n[Wed Aug 26 10:41:45.709307 2015] [jk:warn] [pid 4416] No JkShmFile defined in httpd.conf. Using default /etc/httpd/logs/jk-runtime-status\n[Wed Aug 26 10:41:45.714202 2015] [mpm_prefork:notice] [pid 4416] AH00163: Apache/2.4.6 (CentOS) mod_jk/1.2.41 configured -- resuming normal operations\n[Wed Aug 26 10:41:45.714214 2015] [core:notice] [pid 4416] AH00094: Command line: '/usr/sbin/httpd -D FOREGROUND'\n[Wed Aug 26 10:41:45.714269 2015] [mpm_prefork:warn] [pid 4416] AH00167: long lost child came home! (pid 5230)\n[Wed Aug 26 10:41:45.714283 2015] [mpm_prefork:warn] [pid 4416] AH00167: long lost child came home! (pid 5231)\n[Wed Aug 26 10:41:45.714309 2015] [mpm_prefork:warn] [pid 4416] AH00167: long lost child came home! (pid 5232)\n\n\nall the pids correspond with stream loggers we run to our elk stack:\n\n0     0  5230  4416  20   0  49832  2652 poll_s S    ?          0:00  \\_ /usr/bin/nc -u elk.host.local 12202\n0     0  5230  4416  20   0      0     0 exit   Z    ?          0:00  \\_ [nc] <defunct>", "is_private": false, "bug_id": 12033, "id": 184757, "time": "2015-08-26T10:00:55Z", "creator": "danny.webb@thehutgroup.com", "creation_time": "2015-08-26T10:00:55Z", "attachment_id": null}, {"count": 19, "tags": [], "text": "Still occurs in 2.4.10 and 2.4.12 (Solaris 10 SPARC)\nUsing piped logs to rotate them throug rotatelogs:\n\n[adm@test log]$ ps -fu httpd\n     UID   PID  PPID   C    STIME TTY         TIME CMD\n   httpd  1857  2139   0   Aug 14 ?           6:39 /pub/site/httpd/sbin/httpd -k start\n   httpd  8763  2139   0 17:16:58 ?           0:00 /pub/site/httpd/sbin/rotatelogs -L log/transfer.log -l log/transfer.l\n   httpd  8762  2139   0 17:16:58 ?           0:00 /pub/site/httpd/sbin/rotatelogs -L log/access.log -l log/access.log.%Y-%m-%d 86\n   httpd  8756  2139   0 17:16:58 ?           0:00 /pub/site/httpd/sbin/rotatelogs -L log/error.log -l log/error.log.%Y-\n   httpd  5150  2139   0   Jul 28 ?           9:19 /pub/site/httpd/sbin/httpd -k start\n   httpd 19310  2139   0   Aug 07 ?           8:21 /pub/site/httpd/sbin/httpd -k start\n   httpd  2801  2139   0   Jul 14 ?           8:19 /pub/site/httpd/sbin/httpd -k start\n   httpd  6118  2139   0   Jul 29 ?           9:26 /pub/site/httpd/sbin/httpd -k start\n   httpd 19359  2139   0   Aug 07 ?           8:46 /pub/site/httpd/sbin/httpd -k start\n   httpd 19136  2139   0   Jul 28 ?           9:10 /pub/site/httpd/sbin/httpd -k start\n   httpd  8765  2139   0 17:16:59 ?           0:00 /pub/site/httpd/sbin/httpd -k start\n   httpd  2749  2139   0   Jul 14 ?           8:08 /pub/site/httpd/sbin/httpd -k start\n   httpd  8764  2139   0 17:16:58 ?           0:00 /pub/site/httpd/sbin/rotatelogs -L log/transfer.log -l log/transfer.l\n   httpd  2139  1283   0   Jul 14 ?         109:37 /pub/site/httpd/sbin/httpd -k start\n   httpd  2179  2139   0   Jul 14 ?           8:32 /pub/site/httpd/sbin/httpd -k start\n   httpd  6131  2139   0   Jul 29 ?           9:43 /pub/site/httpd/sbin/httpd -k start\n   httpd  8754  2139   0 17:16:58 ?           0:00 /pub/site/httpd/sbin/rotatelogs -L log/error.log -l log/error.log.%Y-%m-%d 8640\n   httpd 19151  2139   0   Jul 28 ?           8:50 /pub/site/httpd/sbin/httpd -k start\n   httpd  2154  2139   0   Jul 14 ?           8:55 /pub/site/httpd/sbin/httpd -k start\n   httpd  1845  2139   0   Aug 14 ?           6:52 /pub/site/httpd/sbin/httpd -k start\n   httpd  2176  2139   0   Jul 14 ?           8:40 /pub/site/httpd/sbin/httpd -k start\n   httpd  2751  2139   0   Jul 14 ?           9:03 /pub/site/httpd/sbin/httpd -k start\n[appadm@pine-test log]$ svcadm refresh httpd\n[appadm@pine-test log]$ tail error.log\n[Thu Oct 01 17:19:01.707625 2015] [mpm_worker:notice] [pid 2139:tid 1] AH00297: SIGUSR1 received.  Doing graceful restart\n[Thu Oct 01 17:19:02.304683 2015] [socache_shmcb:info] [pid 2139:tid 1] AH00830: Shared memory socache initialised\n[Thu Oct 01 17:19:02.306327 2015] [ssl:info] [pid 2139:tid 1] AH01887: Init: Initializing (virtual) servers for SSL\n[Thu Oct 01 17:19:02.313674 2015] [ssl:info] [pid 2139:tid 1] AH01876: mod_ssl/2.4.12 compiled against Server: Apache/2.4.12, Library: OpenSSL/1.0.1i\n[Thu Oct 01 17:19:02.332053 2015] [mpm_worker:notice] [pid 2139:tid 1] AH00292: Apache/2.4.12 (Unix) OpenSSL/1.0.1i configured -- resuming normal operations\n[Thu Oct 01 17:19:02.332344 2015] [mpm_worker:info] [pid 2139:tid 1] AH00293: Server built: Jun  8 2015 17:07:18\n[Thu Oct 01 17:19:02.332533 2015] [core:notice] [pid 2139:tid 1] AH00094: Command line: '/pub/site/httpd/sbin/httpd'\n[Thu Oct 01 17:19:02.395953 2015] [mpm_worker:warn] [pid 2139:tid 1] AH00291: long lost child came home! (pid 8762)\n[Thu Oct 01 17:19:02.396639 2015] [mpm_worker:warn] [pid 2139:tid 1] AH00291: long lost child came home! (pid 8763)\n[Thu Oct 01 17:19:02.396867 2015] [mpm_worker:warn] [pid 2139:tid 1] AH00291: long lost child came home! (pid 8764)", "is_private": false, "id": 185574, "creator": "n.akhnin@ftc.ru", "time": "2015-10-01T11:21:49Z", "bug_id": 12033, "creation_time": "2015-10-01T11:21:49Z", "attachment_id": null}]