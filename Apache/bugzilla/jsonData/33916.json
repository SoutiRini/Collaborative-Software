[{"count": 0, "tags": [], "bug_id": 33916, "text": "I have an upload page that has been working without any problems for months.  \nIt is used dozens of times each day.  My web app uses Struts.\n\nToday, I installed Java 5 and upgraded from Tomcat 5.0.16 to 5.5.7.  I deployed \nto same code as before and started getting a multipart request error (see \nbelow).  It does not occur consistently.  So far today, it has occurred twice.\n\nError from logs...\n\n INFO http-9999-Processor24 org.apache.struts.action.RequestProcessor - \nProcessing a 'POST' for path '/viewBidDetailsAction'\n ERROR http-9999-Processor25 \norg.apache.struts.upload.CommonsMultipartRequestHandler - Failed to parse \nmultipart request\n org.apache.commons.fileupload.FileUploadException: Processing of \nmultipart/form-data request failed. Read timed out\n\tat org.apache.commons.fileupload.FileUpload.parseRequest\n(FileUpload.java:462)\n\tat org.apache.commons.fileupload.FileUpload.parseRequest\n(FileUpload.java:304)\n\tat org.apache.struts.upload.CommonsMultipartRequestHandler.handleRequest\n(CommonsMultipartRequestHandler.java:234)\n\tat org.apache.struts.util.RequestUtils.populate(RequestUtils.java:934)\n\tat org.apache.struts.action.RequestProcessor.processPopulate\n(RequestProcessor.java:779)\n\tat org.apache.struts.action.RequestProcessor.process\n(RequestProcessor.java:246)\n\tat org.apache.struts.action.ActionServlet.process\n(ActionServlet.java:1292)\n\tat org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:510)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:709)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java:252)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java:173)\n\tat com.dex.goldmine.actions.SessionTimeoutFilter.doFilter(Unknown \nSource)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java:202)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java:173)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke\n(StandardWrapperValve.java:214)\n\tat org.apache.catalina.core.StandardContextValve.invoke\n(StandardContextValve.java:178)\n\tat org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:126)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke\n(ErrorReportValve.java:105)\n\tat org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:107)\n\tat org.apache.catalina.connector.CoyoteAdapter.service\n(CoyoteAdapter.java:148)\n\tat org.apache.coyote.http11.Http11Processor.process\n(Http11Processor.java:825)\n\tat \norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnectio\nn(Http11Protocol.java:738)\n\tat org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket\n(PoolTcpEndpoint.java:526)\n\tat org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt\n(LeaderFollowerWorkerThread.java:80)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:684)\n\tat java.lang.Thread.run(Unknown Source)\nERROR http-9999-Processor25 StandardWrapper[/goldmine2:action] - Servlet.service\n() for servlet action threw exception\n javax.servlet.ServletException: Filter exception : Processing of \nmultipart/form-data request failed. Read timed out\n\tat com.dex.goldmine.actions.SessionTimeoutFilter.doFilter(Unknown \nSource)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java:202)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java:173)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke\n(StandardWrapperValve.java:214)\n\tat org.apache.catalina.core.StandardContextValve.invoke\n(StandardContextValve.java:178)\n\tat org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:126)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke\n(ErrorReportValve.java:105)\n\tat org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:107)\n\tat org.apache.catalina.connector.CoyoteAdapter.service\n(CoyoteAdapter.java:148)\n\tat org.apache.coyote.http11.Http11Processor.process\n(Http11Processor.java:825)\n\tat \norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnectio\nn(Http11Protocol.java:738)\n\tat org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket\n(PoolTcpEndpoint.java:526)\n\tat org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt\n(LeaderFollowerWorkerThread.java:80)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:684)\n\tat java.lang.Thread.run(Unknown Source)\nINFO http-9999-Processor24 org.apache.struts.action.RequestProcessor - \nProcessing a 'POST' for path '/updateBidAction'\n\n\nHere's the HTML for the upload page (Page is actually written with Struts \ntags)...\n\n<html>\n<head>\n<style>\ninput {font-family:arial;font-size:11px}\nselect {font-family:arial;font-size:11px}\n.columnHeadings {font-family:arial;font-size:9px;font-weight:bold;background-\ncolor:#e6e6e6}\n.pageTitle {font-family:arial;font-size:10pt;color:#ffffff;font-\nweight:bold;background-color:#387BB8}\n.pageSubtitle {font-family:arial;font-size:11px;color:#ffffff;font-\nweight:bold;background-color:#598DBE}\n.results {font-family:arial;font-size:9px}\na {font-family:arial;font-size:9px}\n</style>\n<SCRIPT type='text/javascript' src='goldmine_edit.js'></SCRIPT>\n<title>Attachment Details</title>\n</head>\n<body bgcolor=\"#FFFFFF\" leftmargin=\"2\" topmargin=\"2\" marginwidth=\"2\" \nmarginheight=\"2\" onKeyPress=\"keyPress()\" onKeyDown=\"keyDown()\">\n<form name=\"attachmentDetailForm\" method=\"POST\" \naction=\"/goldmine2/updateAttachmentInfo.do\" enctype=\"multipart/form-data\" \nonsubmit=\"return showHourglass()\"> \n<table width=\"600\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr> \n    <td>\n      <font color=\"red\"><B></B></font> \n      <font color=\"green\">\n        <B>\n          \n        </B>\n      </font> \n      <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n        <tr>\n          <td>\n            <a href=\"/goldmine2/UpdateTargets.do\"><img src=\"btn_targets.gif\" \nwidth=\"67\" height=\"18\" border=\"0\"></a>\n          </td>\n          <td>\n           <img src=\"btn_bidpipeline.gif\" width=\"89\" height=\"18\">\n          </td>\n        </tr>\n      </table>\n    </td>\n  </tr>\n</table>\n<table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\n  <tr> \n    <td height=\"2\"> \n      <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" \nbgcolor=\"#CCCCCC\">\n        <tr> \n          <td> \n            <table border=\"0\" cellspacing=\"0\" cellpadding=\"2\" width=\"100%\">\n              <tr bgcolor=\"#387BB8\"> \n                <td class=\"pageTitle\">ATTACHMENT</td>\n              </tr>\n            </table>\n          </td>\n        </tr>\n      </table>\n    </td>\n  </tr>\n  <tr> \n    <td height=\"2\" bgcolor=\"#999999\"><img src=\"spacer.gif\" width=\"1\" \nheight=\"1\"></td>\n  </tr>\n  <tr valign=\"top\">\n    <td>\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <tr>\n          \n            \n              <td valign=\"top\">\n                <a href=\"javascript:goBack()\">\n                  <img src=\"btn_back.gif\" width=\"41\" height=\"15\" border=\"0\">\n                </a>\n              </td>\n              <td height=\"17\" valign=\"top\"><a \nhref=\"/goldmine2/BidSearchForm.jsp\" onclick=\"showHourglass()\"><img \nsrc=\"btn_search.gif\" border=\"0\"></a></td>\n              <td valign=\"top\"><a href=\"javascript:window.print()\"><img \nsrc=\"btn_print.gif\" width=\"47\" height=\"15\" border=\"0\"></a></td>              \n            \n          \n        </tr>\n      </table>\n  </tr>\n  <tr> \n    <td height=\"8\"> \n      <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"1\">\n        <tr> \n          <td bgcolor=\"#CCCCCC\"> \n            <table border=\"0\" bgcolor=\"#FFFFFF\" width=\"100%\" cellpadding=\"2\" \ncellspacing=\"1\">\n              <tr bgcolor=\"#598DBE\"> \n                <td colspan=\"2\" class=\"pageSubtitle\">Attachment Information</td>\n                <td colspan=\"10\" class=\"pageSubtitle\"></td>\n              </tr>\n            </table>\n          </td>\n        </tr>\n        <tr> \n          <td height=\"8\"><img src=\"spacer.gif\" width=\"1\" height=\"1\"></td>\n        </tr>\n        <tr> \n          <td bgcolor=\"#CCCCCC\"> \n            <table border=\"0\" width=\"100%\" cellpadding=\"2\" cellspacing=\"1\" \nbgcolor=\"#FFFFFF\">\n              <tr>\n                <td class=\"columnHeadings\" width=\"5%\" nowrap=\"true\" \nalign=\"right\">Description</td>\n                <td class=\"results\" colspan=\"3\" nowrap=\"true\">\n                  \n                  \n                    <input type=\"text\" name=\"linkedDocument.description\" \nmaxlength=\"35\" size=\"80\" value=\"\">\n                    \n                  \n                </td>\n              </tr>\n              <tr>\n                <td class=\"columnHeadings\" width=\"5%\" nowrap=\"true\" \nalign=\"right\">Notes</td>\n                <td class=\"results\" colspan=\"3\" nowrap=\"true\">\n                  \n                  \n                    <textarea name=\"linkedDocument.notes\" cols=\"80\" \nrows=\"5\"></textarea>\n                    \n                  \n                </td>\n              </tr>\n              <tr>\n                <td class=\"columnHeadings\" width=\"5%\" nowrap=\"true\" \nalign=\"right\">File</td>\n                <td class=\"results\" colspan=\"3\" nowrap=\"true\">\n                  \n                    <input type=\"file\" name=\"file\" size=\"80\" value=\"\">\n                  \n                  \n                </td>\n              </tr>\n              <tr valign=\"top\"> \n                <td true colspan=\"19\" height=\"1\"> \n                  <table width=\"100%\" border=\"0\" cellspacing=\"0\" \ncellpadding=\"0\">\n                    <tr bgcolor=\"#CCCCCC\"> \n                      <td><img src=\"spacer.gif\" width=\"1\" height=\"1\"></td>\n                    </tr>\n                  </table>\n                </td>\n              </tr>\n            </table>\n          </td>\n        </tr>\n        <tr> \n          <td height=\"8\"><img src=\"spacer.gif\" width=\"1\" height=\"1\"></td>\n        </tr>\n        <tr>\n          <td>\n            <table align=\"center\">\n              <tr>\n                 \n                  <td><input type=\"submit\" name=\"submitType\" value=\"Save\"></td>\n                  <td><input type=\"submit\" name=\"submitType\" \nvalue=\"Delete\"></td>\n                  <td><input type=\"submit\" name=\"submitType\" \nvalue=\"Cancel\"></td>\n                \n                \n              </tr>\n            </table>\n          </td>\n        </tr>\n      </table>\n    </td>\n  </tr>\n</table>\n\n</form> \n</body>\n</html>", "id": 72017, "time": "2005-03-08T23:29:51Z", "creator": "rmills@dex.com", "creation_time": "2005-03-08T23:29:51Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 33916, "attachment_id": null, "id": 72021, "time": "2005-03-08T23:45:38Z", "creator": "remm@apache.org", "creation_time": "2005-03-08T23:45:38Z", "is_private": false, "text": "As you may understand, you need to file reports that we have a chance to\nreproduce. I cannot debug this, so I recommend you investigate more (or use the\nrelease which was working for you instead)."}, {"count": 2, "tags": [], "bug_id": 33916, "text": "No response -> invalid.", "id": 72443, "time": "2005-03-15T14:11:57Z", "creator": "remm@apache.org", "creation_time": "2005-03-15T14:11:57Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 33916, "text": "Just an FYI on this:\n\nI've seen a similar stack trace, which wasn't reproduceable but just happened\nonce in a while when IE was the web client.  I looked into it and concluded\nthat it was a bug in Commons FileUpload, and that it is likely fixed in newer\nversions (probably a newer version than we're using).\n\nSee bug 21269.  I believe that's the one, although I haven't confirmed that\nit is indeed fixed that way.\n", "id": 72466, "time": "2005-03-15T23:31:06Z", "creator": "jason_brittain@yahoo.com", "creation_time": "2005-03-15T23:31:06Z", "is_private": false, "attachment_id": null}]