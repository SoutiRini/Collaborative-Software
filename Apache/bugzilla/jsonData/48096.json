[{"count": 0, "tags": [], "bug_id": 48096, "text": "I use the eventmodel of POI to process XLS files and convert them to XML (I am the creator of http://elev.at).\n\nI came across a spreadsheet today that results in the RecordFormatException as per the subject line.\nThe spreadsheet can be found at: http://www.nytimes.com/packages/html/nyregion/20050405_DONOR_SPREADSHEET.xls\n\nThe stack trace I get is:\n\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\torg.apache.poi.hssf.record.RecordFactory$ReflectionRecordCreator.create(RecordFactory.java:64)\n\torg.apache.poi.hssf.record.RecordFactory.createSingleRecord(RecordFactory.java:263)\n\torg.apache.poi.hssf.record.RecordFactoryInputStream.readNextRecord(RecordFactoryInputStream.java:270)\n\torg.apache.poi.hssf.record.RecordFactoryInputStream.nextRecord(RecordFactoryInputStream.java:236)\n\torg.apache.poi.hssf.eventusermodel.HSSFEventFactory.genericProcessEvents(HSSFEventFactory.java:122)\n\torg.apache.poi.hssf.eventusermodel.HSSFEventFactory.processEvents(HSSFEventFactory.java:85)\n\torg.apache.poi.hssf.eventusermodel.HSSFEventFactory.processWorkbookEvents(HSSFEventFactory.java:56)\n\txlsconvert$to_xml__7.invoke(xlsconvert.clj:154)\n\tliftServlet$fn__29.invoke(liftServlet.clj:47)\n\tclojure.lang.MultiFn.invoke(MultiFn.java:165)\n\tliftServlet$_doGet__41.invoke(liftServlet.clj:54)\n\tliftServlet.doGet(Unknown Source)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:690)\n\tliftServlet.service(Unknown Source)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n\tliftServlet.service(Unknown Source)\nroot cause\n\norg.apache.poi.hssf.record.RecordFormatException: expected 449 but got 49409\n\torg.apache.poi.hssf.record.RecalcIdRecord.<init>(RecalcIdRecord.java:46)\n\tsun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tsun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n\tsun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tjava.lang.reflect.Constructor.newInstance(Constructor.java:513)\n\torg.apache.poi.hssf.record.RecordFactory$ReflectionRecordCreator.create(RecordFactory.java:56)\n\torg.apache.poi.hssf.record.RecordFactory.createSingleRecord(RecordFactory.java:263)\n\torg.apache.poi.hssf.record.RecordFactoryInputStream.readNextRecord(RecordFactoryInputStream.java:270)\n\torg.apache.poi.hssf.record.RecordFactoryInputStream.nextRecord(RecordFactoryInputStream.java:236)\n\torg.apache.poi.hssf.eventusermodel.HSSFEventFactory.genericProcessEvents(HSSFEventFactory.java:122)\n\torg.apache.poi.hssf.eventusermodel.HSSFEventFactory.processEvents(HSSFEventFactory.java:85)\n\torg.apache.poi.hssf.eventusermodel.HSSFEventFactory.processWorkbookEvents(HSSFEventFactory.java:56)\n\txlsconvert$to_xml__7.invoke(xlsconvert.clj:154)\n\tliftServlet$fn__29.invoke(liftServlet.clj:47)\n\tclojure.lang.MultiFn.invoke(MultiFn.java:165)\n\tliftServlet$_doGet__41.invoke(liftServlet.clj:54)\n\tliftServlet.doGet(Unknown Source)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:690)\n\tliftServlet.service(Unknown Source)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n\tliftServlet.service(Unknown Source)", "id": 131526, "attachment_id": null, "creator": "joubert@joubster.com", "creation_time": "2009-11-01T09:38:22Z", "time": "2009-11-01T09:38:22Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 48096, "attachment_id": null, "is_private": false, "id": 131640, "time": "2009-11-03T12:26:01Z", "creator": "josh@apache.org", "creation_time": "2009-11-03T12:26:01Z", "text": "Fixed in svn r832536 \n\njunit added\n\nThe deserialization code was made more strict during svn r718810 . This check has been removed since Excel(2007) seems to tolerate the incorrect field value."}]