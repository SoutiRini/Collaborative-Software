[{"count": 0, "tags": [], "creator": "laird.trimble@gmail.com", "attachment_id": null, "text": "Using POI 3.1, when I read in a file containing a chart with a title containing more than 127 characters I get an exception (see below).  Titles with 127 or less characters cause no problem.  The interesting line is near the bottom and says \"Caused by: java.lang.IllegalArgumentException: Illegal length - asked for -126 but only 130 left!\n        at org.apache.poi.hssf.record.RecordInputStream.readUnicodeLEString(RecordInputStream.java:252)\"\n\nI have attaced the small xls file that generated the exception below.\n\n\nException in thread \"AWT-EventQueue-0\" org.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n        at org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:208)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:126)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:246)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:169)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:151)\n        at pkintegrator.PKIntegratorApp.updateReport(PKIntegratorApp.java:223)\n        at pkintegrator.PKIntegratorApp.submitPressed(PKIntegratorApp.java:189)\n        at pkintegrator.PKIntegratorView.submitStudy(PKIntegratorView.java:532)\n        at pkintegrator.PKIntegratorView.submitButtonActionPerformed(PKIntegratorView.java:1537)\n        at pkintegrator.PKIntegratorView.access$1800(PKIntegratorView.java:42)\n        at pkintegrator.PKIntegratorView$FormListener.actionPerformed(PKIntegratorView.java:1458)\n        at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:1849)\n        at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2169)\n        at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:420)\n        at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:258)\n        at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(BasicButtonListener.java:236)\n        at java.awt.AWTEventMulticaster.mouseReleased(AWTEventMulticaster.java:231)\n        at java.awt.Component.processMouseEvent(Component.java:5517)\n        at javax.swing.JComponent.processMouseEvent(JComponent.java:3135)\n        at java.awt.Component.processEvent(Component.java:5282)\n        at java.awt.Container.processEvent(Container.java:1966)\n        at java.awt.Component.dispatchEventImpl(Component.java:3984)\n        at java.awt.Container.dispatchEventImpl(Container.java:2024)\n        at java.awt.Component.dispatchEvent(Component.java:3819)\n        at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4212)\n        at java.awt.LightweightDispatcher.processMouseEvent(Container.java:3892)\n        at java.awt.LightweightDispatcher.dispatchEvent(Container.java:3822)\n        at java.awt.Container.dispatchEventImpl(Container.java:2010)\n        at java.awt.Window.dispatchEventImpl(Window.java:1791)\n        at java.awt.Component.dispatchEvent(Component.java:3819)\n        at java.awt.EventQueue.dispatchEvent(EventQueue.java:463)\n        at java.awt.EventDispatchThread.pumpOneEventForHierarchy(EventDispatchThread.java:242)\n        at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:163)\n        at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:157)\n        at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:149)\n        at java.awt.EventDispatchThread.run(EventDispatchThread.java:110)\nCaused by: java.lang.reflect.InvocationTargetException\n        at sun.reflect.GeneratedConstructorAccessor67.newInstance(Unknown Source)\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:494)\n        at org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:196)\n        ... 35 more\nCaused by: java.lang.IllegalArgumentException: Illegal length - asked for -126 but only 130 left!\n        at org.apache.poi.hssf.record.RecordInputStream.readUnicodeLEString(RecordInputStream.java:252)\n        at org.apache.poi.hssf.record.SeriesTextRecord.fillFields(SeriesTextRecord.java:78)\n        at org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n        at org.apache.poi.hssf.record.SeriesTextRecord.<init>(SeriesTextRecord.java:56)\n        ... 39 more\nBUILD SUCCESSFUL (total time: 96 minutes 38 seconds)", "id": 120544, "time": "2008-09-11T10:56:49Z", "bug_id": 45784, "creation_time": "2008-09-11T10:56:49Z", "is_private": false}, {"count": 1, "tags": [], "text": "Created attachment 22560\ncreated with Office Excel 2003 (11.8146.8131) SP2\n\nthis is the file that generated the exception trace in the bug report", "attachment_id": 22560, "id": 120545, "creator": "laird.trimble@gmail.com", "time": "2008-09-11T10:58:31Z", "bug_id": 45784, "creation_time": "2008-09-11T10:58:31Z", "is_private": false}, {"count": 2, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "Fixed in svn trunk", "id": 120837, "time": "2008-09-21T10:49:20Z", "bug_id": 45784, "creation_time": "2008-09-21T10:49:20Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 45784, "attachment_id": null, "id": 121257, "time": "2008-10-06T18:58:45Z", "creator": "laird.trimble@gmail.com", "creation_time": "2008-10-06T18:58:45Z", "is_private": false, "text": "Nick,\n\nThanks for the notification of the bug fix.  I can now read in the attached .xls file that contains a chart having a title longer than 127 characters.  However, when I try to write out the file unchanged I get the following error:\n\nError java.lang.ArrayIndexOutOfBoundsException: 3204\n\nBTW, I am using the latest build of poi-3.2-alpha.\n\nLaird"}, {"count": 4, "tags": [], "text": "Fixed in svn r711764\n\nThere were some more issues with calculating record size for re-serialization.\n\nFor reference, the initial fix was in svn r697562.", "attachment_id": null, "bug_id": 45784, "id": 122227, "time": "2008-11-05T19:47:19Z", "creator": "josh@apache.org", "creation_time": "2008-11-05T19:47:19Z", "is_private": false}]