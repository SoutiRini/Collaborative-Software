[{"count": 0, "tags": [], "text": "eventually, DOS attachs might move from syn flooding to the application layer as\nnow seen for example by the decompression bombs\n(http://www.aerasec.de/security/advisories/decompression-bomb-vulnerability.html).\n\nTherefore, the concept implemented in most current httpd's is to first accept\nanything of ANY SIZE and only afterwards (provided the server didn't blow up\nalready with \"out-of-memory\" - see Bug 22633 [maxFileSize not reaching GUI in\ngraceful way] and Bug 27143 [proactive management of low memory situations])\ne.g. in struts-validator checking whether the received file size was acceptable\nincreasingly becomes a problem for uninterrupted server operation.\n\nThe concept of the future should be more proactive and optionally (configurable\nin web.xml) apply the following more restrictive policies:\n1) only accept fields with permitted names\n2) only accept forms whose total length is declared with Content-Length (mozilla\nalready seems to do that for \"Content-Type: multipart/form-data\")\n3) only accept fields whose length is declared with Content-Length (this allows\neven more detailed user feedback)\n\nThis would allow to manage size matters from within the application:\nFor example, the application could make sure that only one logged in user at a\ntime can upload a 45 MB file while visitors not logged in cannot upload anything\nbeyond 10K - thus preventing unmanageable out-of-memory exceptions.\n\nEspecially policies 2 and 3 should be optional because the admin running the\nserver should be able to decide whether legacy browsers not providing such\ninformation should be served or not.", "is_private": false, "id": 53246, "creator": "hauser@acm.org", "time": "2004-03-01T09:33:49Z", "bug_id": 27327, "creation_time": "2004-03-01T09:33:49Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 27327, "attachment_id": null, "is_private": false, "id": 53247, "time": "2004-03-01T10:07:18Z", "creator": "hauser@acm.org", "creation_time": "2004-03-01T10:07:18Z", "text": "Mozilla RFE to detail the content length with a \"per form-field\"-granularity to\nbe able to implement policy 3)\nhttp://bugzilla.mozilla.org/show_bug.cgi?id=236084"}, {"count": 2, "attachment_id": null, "bug_id": 27327, "is_private": false, "id": 53248, "time": "2004-03-01T10:14:31Z", "creator": "remm@apache.org", "creation_time": "2004-03-01T10:14:31Z", "tags": [], "text": "Thanks for the suggestions. This has nothing to do in a bug report. Post on\ntomcat-dev, and see if anyone is interested.\nBTW, multipart is handled by the application, so I don't see how this has\nanything to do with Tomcat."}, {"count": 3, "tags": [], "text": "Remy, thx for the hint that this is not a tomcat issue for the case of multipart\nforms (a pointer to here is now available in RFE Bug 27328 of commons\nfileupload). However, I guess, this idea is also applicable to simple forms\nwithout input type=\"file\", but just simple text form input fields - aren't those\nhandled by tomcat itself? I was able to easily fill > 120K of garbage into a\nfield that had supposedly only 200 characters maximum length.\n\n\nAlso, this was never intended to be a \"bug\" report, but an \"enhancement\" as it\nhopefully was correctly labeled in field severity. If \"enhancement\" is no longer\na legitimate selection, please remove it from the options to choose there and\nupdate http://nagoya.apache.org/bugzilla/bug_status.html#severity accordingly.", "attachment_id": null, "id": 53251, "creator": "hauser@acm.org", "time": "2004-03-01T10:35:21Z", "bug_id": 27327, "creation_time": "2004-03-01T10:35:21Z", "is_private": false}, {"count": 4, "attachment_id": null, "bug_id": 27327, "is_private": false, "id": 53252, "time": "2004-03-01T10:38:32Z", "creator": "remm@apache.org", "creation_time": "2004-03-01T10:38:32Z", "tags": [], "text": "Please use tomcat-dev, and don't reopen this report."}, {"count": 5, "attachment_id": null, "bug_id": 27327, "text": "see also Bug 36351 and https://issues.apache.org/struts/browse/STR-1705", "id": 100380, "time": "2007-03-14T06:11:14Z", "creator": "hauser@acm.org", "creation_time": "2007-03-14T06:11:14Z", "tags": [], "is_private": false}]