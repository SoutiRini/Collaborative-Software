[{"count": 0, "tags": [], "bug_id": 35771, "attachment_id": null, "is_private": false, "id": 77367, "time": "2005-07-17T14:35:37Z", "creator": "Hans-Dieter.Dreier@freenet.de", "creation_time": "2005-07-17T14:35:37Z", "text": "When starting apache_2.0.54-win32-x86-no_ssl.msi on Win98SE (German), Error box \npops up: \"Internal Error 2735. ResolveServerName\". After confirming box, you \ncan just click \"finish\" & installation is aborted. Machine is connected to \nInternet via NAT/DHCP. Using msiinstall.exe version 2.0.2600.2. Installation \nlog follows:\n\n=== Verbose logging started: 17.07.05  14:02:30  Build type: SHIP ANSI \n2.00.2600.02  Calling process: C:\\WINDOWS\\SYSTEM\\MSIEXEC.EXE ===\nMSI (c) (41:75): Resetting cached policy values\nMSI (c) (41:75): Machine policy value 'Debug' is 0\nMSI (c) (41:75): ******* RunEngine:\n           ******* Product: C:\\WINDOWS\\PROFILES\\HD\\EIGENE~1\\APACHE\\APACHE~1.MSI\n           ******* Action: \n           ******* CommandLine: **********\nMSI (c) (41:75): End dialog not enabled\nMSI (c) (41:75): Original package ==> C:\\WINDOWS\\PROFILES\\HD\\EIGENE~1\n\\APACHE\\APACHE~1.MSI\nMSI (c) (41:75): Package we're running from ==> C:\\WINDOWS\\TEMP\\1106438.msi\nMSI (c) (41:75): APPCOMPAT: looking for appcompat database entry with \nProductCode '{3A862C7D-0504-48BC-AEF8-7F7479C7C158}'.\nMSI (c) (41:75): APPCOMPAT: no matching ProductCode found in database.\nMSI (c) (41:75): Machine policy value 'TransformsSecure' is 0\nMSI (c) (41:75): User policy value 'TransformsAtSource' is 0\nMSI (c) (41:75): APPCOMPAT: looking for appcompat database entry with \nProductCode '{3A862C7D-0504-48BC-AEF8-7F7479C7C158}'.\nMSI (c) (41:75): APPCOMPAT: no matching ProductCode found in database.\nMSI (c) (41:75): Transforms are not secure.\nMSI (c) (41:75): Command Line: CURRENTDIRECTORY=C:\\WINDOWS\\Profiles\\hd\\Desktop \nCLIENTUILEVEL=0 CLIENTPROCESSID=-429503 \nMSI (c) (41:75): Product Code passed to Engine.Initialize:           ''\nMSI (c) (41:75): Product Code from property table before transforms: '{3A862C7D-\n0504-48BC-AEF8-7F7479C7C158}'\nMSI (c) (41:75): Product Code from property table after transforms:  '{3A862C7D-\n0504-48BC-AEF8-7F7479C7C158}'\nMSI (c) (41:75): Product not registered: beginning first-time install\nMSI (c) (41:75): Entering CMsiConfigurationManager::SetLastUsedSource.\nMSI (c) (41:75): User policy value 'SearchOrder' is 'nmu'\nMSI (c) (41:75): Adding new sources is allowed.\nMSI (c) (41:75): Package name extracted from package path: 'APACHE~1.MSI'\nMSI (c) (41:75): Package to be registered: 'apache_2.0.54-win32-x86-no_ssl.msi'\nMSI (c) (41:75): Note: 1: 2729 \nMSI (c) (41:75): Note: 1: 2729 \nMSI (c) (41:75): Note: 1: 2262 2: AdminProperties 3: -2147287038 \nMSI (c) (41:75): Machine policy value 'DisableMsi' is 0\nMSI (c) (41:75): Machine policy value 'AlwaysInstallElevated' is 0\nMSI (c) (41:75): User policy value 'AlwaysInstallElevated' is 0\nMSI (c) (41:75): Running product '{3A862C7D-0504-48BC-AEF8-7F7479C7C158}' with \nuser privileges: It's not assigned.\nMSI (c) (41:75): TRANSFORMS property is now: \nMSI (c) (41:75): SHFOLDER::SHGetFolderPath returned: \nC:\\WINDOWS\\Profiles\\hd\\Anwendungsdaten\nMSI (c) (41:75): SHFOLDER::SHGetFolderPath returned: \nC:\\WINDOWS\\Profiles\\hd\\Favoriten\nMSI (c) (41:75): SHFOLDER::SHGetFolderPath returned: \nC:\\WINDOWS\\Profiles\\hd\\Netzwerkumgebung\nMSI (c) (41:75): SHFOLDER::SHGetFolderPath returned: \nC:\\WINDOWS\\Profiles\\hd\\Eigene Dateien\nMSI (c) (41:75): SHFOLDER::SHGetFolderPath returned: C:\\WINDOWS\\PrintHood\nMSI (c) (41:75): SHFOLDER::SHGetFolderPath returned: \nC:\\WINDOWS\\Profiles\\hd\\Recent\nMSI (c) (41:75): SHFOLDER::SHGetFolderPath returned: C:\\WINDOWS\\SendTo\nMSI (c) (41:75): SHFOLDER::SHGetFolderPath returned: C:\\WINDOWS\\ShellNew\nMSI (c) (41:75): SHFOLDER::SHGetFolderPath returned: C:\\WINDOWS\\Profiles\\All \nUsers\\Anwendungsdaten\nMSI (c) (41:75): SHFOLDER::SHGetFolderPath returned: \nC:\\WINDOWS\\Profiles\\hd\\Local Settings\\Anwendungsdaten\nMSI (c) (41:75): SHFOLDER::SHGetFolderPath returned: \nC:\\WINDOWS\\Profiles\\hd\\Eigene Dateien\\Eigene Bilder\nMSI (c) (41:75): SHFOLDER::SHGetFolderPath returned: \nC:\\WINDOWS\\Profiles\\hd\\Startmen\u00fc\\Programme\\Verwaltung\nMSI (c) (41:75): SHFOLDER::SHGetFolderPath returned: \nC:\\WINDOWS\\Profiles\\hd\\Startmen\u00fc\\Programme\\Autostart\nMSI (c) (41:75): SHFOLDER::SHGetFolderPath returned: \nC:\\WINDOWS\\Profiles\\hd\\Startmen\u00fc\\Programme\nMSI (c) (41:75): SHFOLDER::SHGetFolderPath returned: \nC:\\WINDOWS\\Profiles\\hd\\Startmen\u00fc\nMSI (c) (41:75): SHFOLDER::SHGetFolderPath returned: \nC:\\WINDOWS\\Profiles\\hd\\Desktop\nMSI (c) (41:75): SHFOLDER::SHGetFolderPath returned: C:\\WINDOWS\\FONTS\nMSI (c) (41:75): Note: 1: 2898 2: MS Sans Serif 3: MS Sans Serif 4: 0 5: 16 \nMSI (c) (41:75): MSCOREE not loaded loading copy from system32\n=== Logging started: 17.07.05  14:02:31 ===\nMSI (c) (41:75): Machine policy value 'DisableRollback' is 0\nMSI (c) (41:75): User policy value 'DisableRollback' is 0\nMSI (c) (41:75): Doing action: INSTALL\nAction start 14:02:31: INSTALL.\nMSI (c) (41:75): UI Sequence table 'InstallUISequence' is present and populated.\nMSI (c) (41:75): Running UISequence\nMSI (c) (41:75): Doing action: AppSearch\nAction start 14:02:31: AppSearch.\nAction 14:02:31: AppSearch. Searching for installed applications\nAppSearch: Property: EXISTING_APACHE_SERVICE_PATH, Signature: \nExistingApacheService\nMSI (c) (41:75): Note: 1: 2262 2: Signature 3: -2147287038 \nMSI (c) (41:75): Note: 1: 2262 2: CompLocator 3: -2147287038 \nMSI (c) (41:75): Note: 1: 1402 2: \nHKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Apache2 3: 2 \nMSI (c) (41:75): Note: 1: 2262 2: IniLocator 3: -2147287038 \nMSI (c) (41:75): Note: 1: 2262 2: DrLocator 3: -2147287038 \nAction ended 14:02:31: AppSearch. Return value 1.\nMSI (c) (41:75): Doing action: LaunchConditions\nAction start 14:02:31: LaunchConditions.\nMSI (c) (41:75): Note: 1: 2262 2: LaunchCondition 3: -2147287038 \nAction ended 14:02:31: LaunchConditions. Return value 1.\nMSI (c) (41:75): Doing action: SetupInitialization\nAction start 14:02:31: SetupInitialization.\nInfo 2898.Tahoma8, Tahoma, 0\nInfo 2898.TahomaBold10, Tahoma, 0\nAction 14:02:31: SetupInitialization. Dialog created\nAction ended 14:02:31: SetupInitialization. Return value 1.\nMSI (c) (41:75): Doing action: FindRelatedProducts\nAction start 14:02:31: FindRelatedProducts.\nMSI (c) (41:75): Note: 1: 2262 2: Upgrade 3: -2147287038 \nAction ended 14:02:31: FindRelatedProducts. Return value 1.\nMSI (c) (41:75): Skipping action: CCPSearch (condition is false)\nMSI (c) (41:75): Skipping action: RMCCPSearch (condition is false)\nMSI (c) (41:75): Doing action: ResolveServerName\nAction start 14:02:31: ResolveServerName.\nMSI (c) (41:75): Creating MSIHANDLE (1) of type 790542 for thread -425099\n=====================================================\nException code: C0000005 ACCESS_VIOLATION\nModule: C:\\WINDOWS\\TEMP\\MSI21F0.TMP\nFunction: 0x100011f7\n=====================================================\n\nRegisters:\nEAX:00000000  EBX:00D621A0  ECX:00C54240  EDX:00D50DD4  ESI:00000000  \nEDI:0188FCC4\nCS:EIP:0187:100011F7 SS:ESP:018F:0188FBB0  EBP:00000000\nDS:018F  ES:018F  FS:575F  GS:0000\nFlags:00010246\n\nCall stack:\nAddress   Frame\n\nMSI (c) (41:75): Note: 1: 2735 2: ResolveServerName \nDEBUG: Error 2735:  Custom action 'ResolveServerName' has caused an unhandled \nexception and has been stopped.  This may be the result of an internal error in \nthe custom action, such as an access violation.\nDEBUG: Error 2835:  The control ErrorIcon was not found on dialog SetupError\nInternal Error 2835. ErrorIcon, SetupError\nInternal Error 2735. ResolveServerName\nMSI (c) (41:75): Product: Apache HTTP Server 2.0.54 -- Internal Error 2735. \nResolveServerName\n\nAction ended 14:03:17: ResolveServerName. Return value 3.\nMSI (c) (41:75): Closing MSIHANDLE (1) of type 790542 for thread -425099\nMSI (c) (41:75): Doing action: SetupCompleteError\nAction start 14:03:17: SetupCompleteError.\nAction 14:03:17: SetupCompleteError. Dialog created\nAction ended 14:03:18: SetupCompleteError. Return value 2.\nAction ended 14:03:18: INSTALL. Return value 3.\nProperty(C): DiskPrompt = [1]\nProperty(C): Registration = No\nProperty(C): UpgradeCode = {0EA14757-3D48-4F78-878E-B9AF261753D9}\nProperty(C): ProductLanguage = 1033\nProperty(C): ProgramFilesFolder = C:\\Programme\\\nProperty(C): AdminToolsFolder = \nC:\\WINDOWS\\Profiles\\hd\\Startmen\u00fc\\Programme\\Verwaltung\\\nProperty(C): AppDataFolder = C:\\WINDOWS\\Profiles\\hd\\Anwendungsdaten\\\nProperty(C): CommonAppDataFolder = C:\\WINDOWS\\Profiles\\All \nUsers\\Anwendungsdaten\\\nProperty(C): CommonFilesFolder = C:\\Programme\\Gemeinsame Dateien\\\nProperty(C): DesktopFolder = C:\\WINDOWS\\Profiles\\hd\\Desktop\\\nProperty(C): FavoritesFolder = C:\\WINDOWS\\Profiles\\hd\\Favoriten\\\nProperty(C): FontsFolder = C:\\WINDOWS\\FONTS\\\nProperty(C): LocalAppDataFolder = C:\\WINDOWS\\Profiles\\hd\\Local \nSettings\\Anwendungsdaten\\\nProperty(C): MyPicturesFolder = C:\\WINDOWS\\Profiles\\hd\\Eigene Dateien\\Eigene \nBilder\\\nProperty(C): NetHoodFolder = C:\\WINDOWS\\Profiles\\hd\\Netzwerkumgebung\\\nProperty(C): PersonalFolder = C:\\WINDOWS\\Profiles\\hd\\Eigene Dateien\\\nProperty(C): PrintHoodFolder = C:\\WINDOWS\\PrintHood\\\nProperty(C): ProgramMenuFolder = C:\\WINDOWS\\Profiles\\hd\\Startmen\u00fc\\Programme\\\nProperty(C): RecentFolder = C:\\WINDOWS\\Profiles\\hd\\Recent\\\nProperty(C): SendToFolder = C:\\WINDOWS\\SendTo\\\nProperty(C): StartMenuFolder = C:\\WINDOWS\\Profiles\\hd\\Startmen\u00fc\\\nProperty(C): StartupFolder = \nC:\\WINDOWS\\Profiles\\hd\\Startmen\u00fc\\Programme\\Autostart\\\nProperty(C): System16Folder = C:\\WINDOWS\\SYSTEM\\\nProperty(C): SystemFolder = C:\\WINDOWS\\SYSTEM\\\nProperty(C): SourceDir = C:\\WINDOWS\\PROFILES\\HD\\EIGENE~1\\APACHE\\\nProperty(C): TempFolder = C:\\WINDOWS\\TEMP\\\nProperty(C): TemplateFolder = C:\\WINDOWS\\ShellNew\\\nProperty(C): WindowsFolder = C:\\WINDOWS\\\nProperty(C): WindowsVolume = C:\\\nProperty(C): LAUNCHPROGRAM = 0\nProperty(C): LAUNCHREADME = 0\nProperty(C): FileInUseProcess = 0\nProperty(C): AgreeToLicense = No\nProperty(C): _IsMaintenance = Reinstall\nProperty(C): IS_SQLSERVER_USERNAME = sa\nProperty(C): IS_SQLSERVER_AUTHENTICATION = 0\nProperty(C): ApplicationUsers = AllUsers\nProperty(C): SetupType = Typical\nProperty(C): _IsSetupTypeMin = Typical\nProperty(C): Display_IsBitmapDlg = 1\nProperty(C): ProductCode = {3A862C7D-0504-48BC-AEF8-7F7479C7C158}\nProperty(C): ProductName = Apache HTTP Server 2.0.54\nProperty(C): ProductVersion = 2.0.54\nProperty(C): ARPCONTACT = Apache Users Mailing List\nProperty(C): ARPHELPLINK = http://httpd.apache.org/userslist.html\nProperty(C): ARPHELPTELEPHONE = N/A\nProperty(C): ARPPRODUCTICON = ARPPRODUCTICON.exe\nProperty(C): ARPURLINFOABOUT = http://httpd.apache.org/\nProperty(C): ARPURLUPDATEINFO = http://www.apache.org/dist/httpd/binaries/win32/\nProperty(C): Apache_Local_Docs = http://127.0.0.1/htdocs/manual/\nProperty(C): Apache_Site_Docs = http://httpd.apache.org/docs-2.0/\nProperty(C): ApplicationName = Apache HTTP Server 2.0\nProperty(C): DWUSINTERVAL = 30\nProperty(C): DWUSLINK = \nCEECD09FF92CD7F83EACB0485E7C978F8EDCB78F59EB97D8CE9CD048EECCA00FFE9C77CFE9AC\nProperty(C): DefaultUIFont = Tahoma8\nProperty(C): DialogCaption = Installation Wizard\nProperty(C): DiskSerial = 1234-5678\nProperty(C): DisplayNameCustom = Custom\nProperty(C): DisplayNameMinimal = Minimal\nProperty(C): DisplayNameTypical = Typical\nProperty(C): ErrorDialog = SetupError\nProperty(C): INSTALLLEVEL = 100\nProperty(C): ISVROOT_PORT_NO = 0\nProperty(C): IS_COMPLUS_PROGRESSTEXT_COST = Costing COM+ application: [1]\nProperty(C): IS_COMPLUS_PROGRESSTEXT_INSTALL = Installing COM+ application: [1]\nProperty(C): IS_COMPLUS_PROGRESSTEXT_UNINSTALL = Uninstalling COM+ application: \n[1]\nProperty(C): InstallChoice = AR\nProperty(C): Manufacturer = Apache Software Foundation\nProperty(C): PIDTemplate = 12345<###-%%%%%%%>@@@@@\nProperty(C): PROGMSG_IIS_CREATEVROOT = Creating IIS virtual directory %s\nProperty(C): PROGMSG_IIS_CREATEVROOTS = Creating IIS virtual directories...\nProperty(C): PROGMSG_IIS_EXTRACT = Extracting information for IIS virtual \ndirectories...\nProperty(C): PROGMSG_IIS_EXTRACTDONE = Extracted information for IIS virtual \ndirectories...\nProperty(C): PROGMSG_IIS_REMOVESITE = Removing web site at port %d\nProperty(C): PROGMSG_IIS_REMOVEVROOT = Removing IIS virtual directory %s\nProperty(C): PROGMSG_IIS_REMOVEVROOTS = Removing IIS virtual directories...\nProperty(C): PROGMSG_IIS_ROLLBACKVROOTS = Rolling back virtual directory and \nweb site changes...\nProperty(C): ProgressType0 = install\nProperty(C): ProgressType1 = Installing\nProperty(C): ProgressType2 = installed\nProperty(C): ProgressType3 = installs\nProperty(C): RESOLVED_WINSOCK2 = 1\nProperty(C): RebootYesNo = Yes\nProperty(C): ReinstallFileVersion = o\nProperty(C): ReinstallModeText = omus\nProperty(C): ReinstallRepair = r\nProperty(C): SERVERPORT = 80\nProperty(C): SERVICEINTERNALNAME = Apache2\nProperty(C): SERVICENAME = Apache2\nProperty(C): ISReleaseFlags = NoSSL\nProperty(C): EXECUTEACTION = INSTALL\nProperty(C): ACTION = INSTALL\nProperty(C): UILevel = 5\nProperty(C): VersionHandler = 2.00\nProperty(C): SOURCEDIR = C:\\WINDOWS\\PROFILES\\HD\\EIGENE~1\\APACHE\\\nProperty(C): OriginalDatabase = C:\\WINDOWS\\PROFILES\\HD\\EIGENE~1\n\\APACHE\\APACHE~1.MSI\nProperty(C): DATABASE = C:\\WINDOWS\\TEMP\\1106438.msi\nProperty(C): COMPANYNAME = xxx\nProperty(C): USERNAME = xxx\nProperty(C): Privileged = 1\nProperty(C): Date = 17.07.05\nProperty(C): Time = 14:03:18\nProperty(C): RedirectedDllSupport = 1\nProperty(C): ColorBits = 32\nProperty(C): TextHeight = 16\nProperty(C): BorderSide = 1\nProperty(C): BorderTop = 1\nProperty(C): CaptionHeight = 19\nProperty(C): ScreenY = 768\nProperty(C): ScreenX = 1024\nProperty(C): SystemLanguageID = 1031\nProperty(C): ComputerName = HDD\nProperty(C): UserLanguageID = 1031\nProperty(C): LogonUser = hd\nProperty(C): AdminUser = 1\nProperty(C): VirtualMemory = 1182\nProperty(C): PhysicalMemory = 255\nProperty(C): Intel = 6\nProperty(C): ShellAdvtSupport = 1\nProperty(C): WindowsBuild = 2222\nProperty(C): Version9X = 410\nProperty(C): Version95 = 410\nProperty(C): VersionMsi = 2.00\nProperty(C): VersionDatabase = 110\nProperty(C): CLIENTPROCESSID = -429503\nProperty(C): CLIENTUILEVEL = 0\nProperty(C): CURRENTDIRECTORY = C:\\WINDOWS\\Profiles\\hd\\Desktop\nProperty(C): WIN9XPROFILESENABLED = 1\nProperty(C): PackagecodeChanging = 1\nProperty(C): ProductState = -1\nProperty(C): PackageCode = {0B906299-82F0-4B07-B48C-D31A112CC2F8}\n=== Logging stopped: 17.07.05  14:03:18 ===\nMSI (c) (41:75): Grabbed execution mutex.\nMSI (c) (41:75): Cleaning up uninstalled install packages, if any exist\nMSI (c) (41:75): MainEngineThread is returning 1603\n=== Verbose logging stopped: 17.07.05  14:03:18 ==="}, {"count": 1, "tags": [], "creator": "jorton@redhat.com", "text": "\n\n*** This bug has been marked as a duplicate of 35770 ***", "id": 78156, "time": "2005-08-05T15:21:43Z", "bug_id": 35771, "creation_time": "2005-08-05T15:21:43Z", "is_private": false, "attachment_id": null}]