[{"count": 0, "tags": [], "bug_id": 47026, "text": "Created attachment 23488\ntest.xlsm\n\nProblem 1\n=========\nCell \"A1\" contains a simple formula, following code assign a string value \"456\" to cell \"A1\". But the cell type is still Cell.CELL_TYPE_FORMULA after the assignment.\n--\nWorkbook source = new XSSFWorkbook(\"test.xlsm\");\nSheet sheet = source.getSheetAt(0);\nRow row = sheet.getRow(0);\nCell cell = row.getCell(0);\t\t\nSystem.out.println(\"cell.getCellType() = \" + cell.getCellType());\ncell.setCellValue(\"456\");\nSystem.out.println(\"cell.getCellType() = \" + cell.getCellType());\n--\n\nProblem 2\n=========\nNullPointerException is thrown if I explicit change the cell type to Cell.CELL_TYPE_STRING.\n--\nWorkbook source = new XSSFWorkbook(\"test.xlsm\");\nSheet sheet = source.getSheetAt(0);\nRow row = sheet.getRow(0);\nCell cell = row.getCell(0);\t\t\ncell.setCellType(Cell.CELL_TYPE_STRING);\t\t\ncell.setCellValue(\"456\");\n--\njava.lang.NullPointerException\n\tat org.apache.poi.xssf.usermodel.XSSFCell.setCellType(XSSFCell.java:693)\n\nProblem 3\n=========\nNullPointerException is thrown if I explicit set the cell formula to null.\n--\nWorkbook source = new XSSFWorkbook(\"test.xlsm\");\nSheet sheet = source.getSheetAt(0);\nRow row = sheet.getRow(0);\nCell cell = row.getCell(0);\ncell.setCellFormula(null);\ncell.setCellValue(\"456\");\n--\njava.lang.NullPointerException\n\tat org.apache.poi.xssf.usermodel.XSSFCell.setCellType(XSSFCell.java:693)\n--\n(If I change the cell value from \"456\" to 456, no exception will be thrown and cell type will be changed to Cell.CELL_TYPE_NUMERIC)", "id": 126220, "time": "2009-04-14T02:51:41Z", "creator": "matthew.knl@gmail.com", "creation_time": "2009-04-14T02:51:41Z", "is_private": false, "attachment_id": 23488}, {"count": 1, "tags": [], "text": "\"Problem 1\" actually is not a problem. setCellValue does not change the cell type of a formula cell, it just updated the pre-calculated (cached) formula value. If you want to remove the formula, call setCellFormula(null) first.\n\n\"Problem 2\" and \"Problem 2\" had the same origin. The trouble happened when the source workbook didn't contain string and the internal string cache was null.\n\nFixed in 766103\n\nYegor", "is_private": false, "bug_id": 47026, "id": 126338, "time": "2009-04-17T11:08:51Z", "creator": "yegor@dinom.ru", "creation_time": "2009-04-17T11:08:51Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "matthew.knl@gmail.com", "attachment_id": null, "text": "I found that \"Problem 3\" still exists in 766563.", "id": 126373, "time": "2009-04-19T20:02:47Z", "bug_id": 47026, "creation_time": "2009-04-19T20:02:47Z", "is_private": false}, {"count": 3, "tags": [], "text": "Did you use a different file for testing? I've just checked, \"Problem 3\" is not reproducible with the posted code and attached test.xlsm.\n\nYegor", "is_private": false, "bug_id": 47026, "id": 126374, "time": "2009-04-19T22:18:12Z", "creator": "yegor@dinom.ru", "creation_time": "2009-04-19T22:18:12Z", "attachment_id": null}, {"count": 4, "attachment_id": null, "bug_id": 47026, "text": "My test case call Cell.setCellFormula(null) in a non-formula cell, it throws NullPointerException. Is it normal and expected?", "id": 126379, "time": "2009-04-20T03:11:55Z", "creator": "matthew.knl@gmail.com", "creation_time": "2009-04-20T03:11:55Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "bug_id": 47026, "text": "(In reply to comment #4)\n> My test case call Cell.setCellFormula(null) in a non-formula cell, it throws\n> NullPointerException. Is it normal and expected?\n\nSounds like \"Problem 4\" :)\n\nShould be fixed in r766750.\n\nYegor", "id": 126391, "time": "2009-04-20T09:51:05Z", "creator": "yegor@dinom.ru", "creation_time": "2009-04-20T09:51:05Z", "is_private": false, "attachment_id": null}]