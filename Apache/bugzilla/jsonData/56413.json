[{"count": 0, "tags": [], "creator": "625953844@qq.com", "text": "/usr/local/webserver/apache/bin/apachectl \n[Tue Apr 15 18:29:09.344674 2014] [core:crit] [pid 28990] AH00102: [Tue Apr 15 18:29:09 2014] file mod_setenvif.c, line 637, assertion \"is_header_regex_regex != NULL\" failed\n/usr/local/webserver/apache/bin/apachectl: line 79: 28990 \u5df2\u653e\u5f03               $HTTPD \"$@\"", "id": 174586, "time": "2014-04-15T11:10:15Z", "bug_id": 56413, "creation_time": "2014-04-15T11:10:15Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "lakshmi@utahinteractive.org", "text": "I have the same issue and we are on RHEL 5.6. I can install 2.4.7 fine, but 2.4.9 fails. If anyone fixed the issue please let me know.\n\nThank you", "id": 174948, "time": "2014-04-30T18:56:05Z", "bug_id": 56413, "creation_time": "2014-04-30T18:56:05Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "text": "I have encountered the same issue with RHEL 5.10. I have tried installing using pcre-8.34 with the same result.", "is_private": false, "bug_id": 56413, "id": 174957, "time": "2014-05-01T08:12:44Z", "creator": "bkiddie@csc.com", "creation_time": "2014-05-01T08:12:44Z", "attachment_id": null}, {"count": 3, "tags": [], "text": "I have got the same issue on Centos 5. See\nhttp://forum.directadmin.com/showthread.php?t=48569&page=2&p=250879#post250879", "attachment_id": null, "bug_id": 56413, "id": 174973, "time": "2014-05-02T08:36:04Z", "creator": "apache@ehrhardt.nl", "creation_time": "2014-05-02T08:36:04Z", "is_private": false}, {"count": 4, "tags": [], "creator": "rainer.jung@kippdata.de", "attachment_id": null, "text": "Which version of PCRE is your running httpd actually using?\n\nIf you are not sure, you can try to inspect in the following way:\n\n- Start httpd\n- Check process id of parent process, say it is 1234\n- \"grep pcre /proc/1234/maps\"\n- The output should contain the pcre lib file name that actually gets used\n- If that file was installed using an RPM check that RPM for version info.\n- If not, you can do a\n     strings /lib64/libpcre.so.0.0.1 | egrep -e '[0-9]\\.[0-9]'\n  (with appropriate change in path and maybe soname). The result contains a version line similar to \"6.6 06-Feb-2006\". Which one is it?\n\nEven if you installed a new version of pcre, please double check if your httpd actually uses it.\n\nRegards,\n\nRainer", "id": 174977, "time": "2014-05-02T09:11:41Z", "bug_id": 56413, "creation_time": "2014-05-02T09:11:41Z", "is_private": false}, {"count": 5, "tags": [], "text": "I have just downgraded our production server to 5.4.7:\nhttp://forum.directadmin.com/showthread.php?t=48569&page=3&p=250903#post250903\n\nBut I will try the upgrade once again on the dev server. In the mean time:\n\nbash-3.2# strings /lib64/libpcre.so.0.0.1 | egrep -e '[0-9]\\.[0-9]'\nGLIBC_2.4\nGLIBC_2.3\nGLIBC_2.3.4\nGLIBC_2.2.5\n6.6 06-Feb-2006", "is_private": false, "bug_id": 56413, "id": 174982, "time": "2014-05-02T12:47:30Z", "creator": "apache@ehrhardt.nl", "creation_time": "2014-05-02T12:47:30Z", "attachment_id": null}, {"count": 6, "tags": [], "text": "After the upgrade of our dev server to Apache 2.4.9:\n\nbash-3.2# grep pcre /proc/5027/maps\n7f3a3e96e000-7f3a3e9ab000 r-xp 00000000 ca:01 4654444                    /usr/local/lib/libpcre.so.0.0.1\n7f3a3e9ab000-7f3a3ebaa000 ---p 0003d000 ca:01 4654444                    /usr/local/lib/libpcre.so.0.0.1\n7f3a3ebaa000-7f3a3ebab000 rw-p 0003c000 ca:01 4654444                    /usr/local/lib/libpcre.so.0.0.1\nbash-3.2# strings /usr/local/lib/libpcre.so.0.0.1 | egrep -e '[0-9]\\.[0-9]'\nGLIBC_2.3\nGLIBC_2.2.5\n8.20 2011-10-21\n\nWhen I try to build PHP this happens:\n\nSorry, I cannot run apxs.  Possible reasons follow:\n\n1. Perl is not installed\n2. apxs was not found. Try to pass the path using --with-apxs2=/path/to/apxs\n3. Apache was not built using --enable-so (the apxs usage page is displayed)\n\nThe output of /usr/sbin/apxs follows:\n[Fri May 02 16:29:21.208426 2014] [core:crit] [pid 9049] AH00102: [Fri May 02 16:29:21 2014] file mod_setenvif.c, line 637, assertion \"is_header_regex_regex != NULL\" failed\nsh: line 1:  9049 Aborted                 /usr/sbin/httpd -l\napxs:Error: Sorry, no shared object support for Apache.\napxs:Error: available under your platform. Make sure.\napxs:Error: the Apache module mod_so is compiled into.\napxs:Error: your server binary `/usr/sbin/httpd'..\nconfigure: error: Aborting\n\n*** There was an error while trying to configure php. Check the configure file", "attachment_id": null, "bug_id": 56413, "id": 174985, "time": "2014-05-02T14:30:57Z", "creator": "apache@ehrhardt.nl", "creation_time": "2014-05-02T14:30:57Z", "is_private": false}, {"count": 7, "tags": [], "creator": "rainer.jung@kippdata.de", "attachment_id": null, "id": 174995, "time": "2014-05-02T19:24:51Z", "bug_id": 56413, "creation_time": "2014-05-02T19:24:51Z", "is_private": false, "text": "Can you confirm, that you also have the problem that the OP reported, ie. the error shows up when you do a graceful restart?\n\nOr do you \"only\" have the problem of building php?\n\nIn the latter case, is /usr/sbin/apxs the apxs that was installed with your httpd 2.4.9 and /usr/sbin/httpd your 2.4.9 httpd binary?\n\nIf so, do you get the same error when simply running \"/usr/sbin/httpd -l\"?\n\nWhen running that and before setting \"export LD_LIBRARY_PATH=/usr/local/lib\" which contains your newer PCRE?\n\nSorry about the many questions, but I'm trying to understand the situation."}, {"count": 8, "tags": [], "creator": "rainer.jung@kippdata.de", "attachment_id": null, "is_private": false, "id": 174997, "time": "2014-05-02T20:16:35Z", "bug_id": 56413, "creation_time": "2014-05-02T20:16:35Z", "text": "And one more question: is mod_setenvif compiled as a shared object file (mod_setenvif.so) and loaded via LoadModule, or compiled in statically?"}, {"count": 9, "tags": [], "creator": "lakshmi@utahinteractive.org", "attachment_id": null, "id": 174999, "time": "2014-05-02T21:20:12Z", "bug_id": 56413, "creation_time": "2014-05-02T21:20:12Z", "is_private": false, "text": "The apache 2.4.9 compiles and builds fine. After the install when I do :\n\napachectl restart\n[Fri May 02 15:11:42.789241 2014] [core:crit] [pid 16074:tid 47630748573680] AH00102: [Fri May 02 15:11:42 2014] file mod_setenvif.c, line 637, assertion \"is_header_regex_regex != NULL\" failed\nin/apachectl: line 79: 16074 Aborted                 $HTTPD -k $ARGV\n\n\nIt won't even kill the old process and no errors in the error_log either. \n\nI have tried the compilation with new pcre-8.35 also and I have forced to use this pcre-8.35 when I compile the apache:  --with-pcre=/usr/local/pcre-8.35/pcre-config\n\nI have also tried killing the old PIDs and just doing apachectl start, I get same error. \n\nWe don't have PHP in our environment, so I think the issue is unrelated to PHP version."}, {"count": 10, "tags": [], "creator": "apache@ehrhardt.nl", "attachment_id": null, "is_private": false, "id": 175005, "time": "2014-05-03T10:06:29Z", "bug_id": 56413, "creation_time": "2014-05-03T10:06:29Z", "text": "(In reply to Rainer Jung from comment #7)\n> Can you confirm, that you also have the problem that the OP reported, ie.\n> the error shows up when you do a graceful restart?\n\nNo, it restarts fine.\n\n> Or do you \"only\" have the problem of building php?\n\nLooks like it.\n\n> In the latter case, is /usr/sbin/apxs the apxs that was installed with your\n> httpd 2.4.9 and /usr/sbin/httpd your 2.4.9 httpd binary?\n\nThis was the clue. It was an old apxs from Sep 23, 2012. Apparently, 'make install' does not install a new apxs. When I copied the new support/apxs to /usr/sbin, my troubles were gone. I will report this to the Directadmin folks.\n\nBTW: mod_setenvif was compiled in statically."}, {"count": 11, "tags": [], "text": "(In reply to Lakshmi Mekala from comment #9)\n> The apache 2.4.9 compiles and builds fine.\n\nDoes it install the new apxs? If not, try chmodding support/apxs to 755 and copying it to /usr/sbin.", "attachment_id": null, "bug_id": 56413, "id": 175006, "time": "2014-05-03T10:35:49Z", "creator": "apache@ehrhardt.nl", "creation_time": "2014-05-03T10:35:49Z", "is_private": false}, {"count": 12, "tags": [], "creator": "lakshmi@utahinteractive.org", "attachment_id": null, "text": "(In reply to Jan Ehrhardt from comment #11)\n> (In reply to Lakshmi Mekala from comment #9)\n> > The apache 2.4.9 compiles and builds fine.\n> \n> Does it install the new apxs? If not, try chmodding support/apxs to 755 and\n> copying it to /usr/sbin.\n\nYes it is installing new apxs. However I tried restarting apache after I copied support/apxs as you said and sill I see same error:\n\n[Sat May 03 17:45:14.069265 2014] [core:crit] [pid 32379:tid 47901599981552] AH00102: [Sat May 03 17:45:14 2014] file mod_setenvif.c, line 637, assertion \"is_header_regex_regex != NULL\" failed\nbin/apachectl: line 79: 32379 Aborted                 $HTTPD -k $ARGV\n\n\nDo you think setenvif module is corrupt in that httpd-2.4.9.tar.gz package itself? Because when I comment the LoadModule setenvif_module part the apachectl restart works until these lines:\n\n<FilesMatch \"^\\.ht\">\n    Order allow,deny\n    Deny from all\n    Satisfy All\n</FilesMatch>\n\n\nOfcourse the restart will fail because I have commented the LoadModule part.\n\nAlso do you know what is changed in 2.4.9 related to this setenvif module from version 2.4.7. Because the same httpd.conf file works in 2.4.7.\n\nThank you", "id": 175009, "time": "2014-05-03T23:56:52Z", "bug_id": 56413, "creation_time": "2014-05-03T23:56:52Z", "is_private": false}, {"count": 13, "tags": [], "creator": "apache@ehrhardt.nl", "text": "(In reply to Jan Ehrhardt from comment #10)\n> > In the latter case, is /usr/sbin/apxs the apxs that was installed with your\n> > httpd 2.4.9 and /usr/sbin/httpd your 2.4.9 httpd binary?\n> \n> This was the clue. It was an old apxs from Sep 23, 2012. Apparently, 'make\n> install' does not install a new apxs. When I copied the new support/apxs to\n> /usr/sbin, my troubles were gone. I will report this to the Directadmin\n> folks.\n\nHmmm. The bug recurred with the Directadmin build script:\nhttp://forum.directadmin.com/showthread.php?t=48569&page=3&p=251053#post251053", "id": 175054, "time": "2014-05-06T15:10:01Z", "bug_id": 56413, "creation_time": "2014-05-06T15:10:01Z", "is_private": false, "attachment_id": null}, {"count": 14, "tags": [], "creator": "msg@martynas.it", "attachment_id": null, "is_private": false, "id": 175067, "time": "2014-05-06T21:58:14Z", "bug_id": 56413, "creation_time": "2014-05-06T21:58:14Z", "text": "I reproduced the problem, please check the following:\n\n-bash-3.2# cat tst\n#!/bin/sh\nLD_LIBRARY_PATH=/lib64:/usr/lib64:/usr/local/lib64:/lib:/usr/lib:/usr/local/lib\nexport LD_LIBRARY_PATH\nhttpd -v\n\n-bash-3.2# sh tst\n[Tue May 06 23:57:29.273420 2014] [core:crit] [pid 30983] AH00102: [Tue May 06 23:57:29 2014] file mod_setenvif.c, line 637, assertion \"is_header_regex_regex != NULL\" failed\ntst: line 4: 30983 Aborted                 httpd -v"}, {"count": 15, "tags": [], "text": "The problem is that with the mentioned LD_LIBRARY_PATH the following PCRE module gets loaded:\nlibpcre.so.0 => /lib64/libpcre.so.0\nlibz.so.1 => /lib64/libz.so.1\n\nWhile it should be:\nlibpcre.so.0 => /usr/local/lib/libpcre.so.0\nlibz.so.1 => /usr/local/lib/libz.so.1\n\nSo it might be that there were some changes in required version of PCRE in Apache 2.4.9. And the issue is PCRE-related.", "is_private": false, "bug_id": 56413, "id": 175068, "time": "2014-05-06T22:35:39Z", "creator": "msg@martynas.it", "creation_time": "2014-05-06T22:35:39Z", "attachment_id": null}, {"count": 16, "tags": [], "text": "(In reply to msg from comment #15)\n> The problem is that with the mentioned LD_LIBRARY_PATH the following PCRE\n> module gets loaded:\n> libpcre.so.0 => /lib64/libpcre.so.0\n> libz.so.1 => /lib64/libz.so.1\n> \n> While it should be:\n> libpcre.so.0 => /usr/local/lib/libpcre.so.0\n> libz.so.1 => /usr/local/lib/libz.so.1\n> \n> So it might be that there were some changes in required version of PCRE in\n> Apache 2.4.9. And the issue is PCRE-related.\n\nSo we just have to wait on new PCRE release then? I have tried both pcre-8.34 and 8.35 and I see same issue.", "attachment_id": null, "bug_id": 56413, "id": 175083, "time": "2014-05-07T16:08:15Z", "creator": "lakshmi@utahinteractive.org", "creation_time": "2014-05-07T16:08:15Z", "is_private": false}, {"count": 17, "tags": [], "text": "I am following the bug for this over on PCRE they are pointing back to a file in the apache source: \n\nmod_setenvif.c\n\n\nHere is the bug over on PCRE:\n\nhttp://bugs.exim.org/show_bug.cgi?id=1487\n\n\nI am having the same issues listed in the above comments which is preventing us from releasing anything higher than 2.4.7 for RHEL5.", "attachment_id": null, "bug_id": 56413, "id": 176600, "time": "2014-07-22T18:48:28Z", "creator": "benjamin.taylor@savvis.com", "creation_time": "2014-07-22T18:48:28Z", "is_private": false}, {"count": 18, "tags": [], "creator": "rpluem@apache.org", "text": "Does the following patch fix your issue?\n\nIndex: util_pcre.c\n===================================================================\n--- util_pcre.c (revision 1612204)\n+++ util_pcre.c (working copy)\n@@ -125,7 +125,7 @@\n     const char *errorptr;\n     int erroffset;\n     int errcode = 0;\n-    int options = PCRE_DUPNAMES;\n+    int options = 0;\n\n     if ((cflags & AP_REG_ICASE) != 0)\n         options |= PCRE_CASELESS;", "id": 176601, "time": "2014-07-22T19:08:38Z", "bug_id": 56413, "creation_time": "2014-07-22T19:08:38Z", "is_private": false, "attachment_id": null}, {"count": 19, "tags": [], "creator": "benjamin.taylor@savvis.com", "attachment_id": null, "is_private": false, "id": 176609, "time": "2014-07-23T01:04:34Z", "bug_id": 56413, "creation_time": "2014-07-23T01:04:34Z", "text": "I just tested the above patch:\n\nIndex: util_pcre.c\n===================================================================\n--- util_pcre.c (revision 1612204)\n+++ util_pcre.c (working copy)\n@@ -125,7 +125,7 @@\n     const char *errorptr;\n     int erroffset;\n     int errcode = 0;\n-    int options = PCRE_DUPNAMES;\n+    int options = 0;\n\n     if ((cflags & AP_REG_ICASE) != 0)\n         options |= PCRE_CASELESS;\n\nThis does fix the issue and corrects any of the above mentioned pcre issues. 2.4.10 starts without issue now."}, {"count": 20, "tags": [], "creator": "rpluem@apache.org", "attachment_id": null, "is_private": false, "id": 176614, "time": "2014-07-23T07:22:15Z", "bug_id": 56413, "creation_time": "2014-07-23T07:22:15Z", "text": "(In reply to Benji Taylor from comment #19)\n> I just tested the above patch:\n> \n> Index: util_pcre.c\n> ===================================================================\n> --- util_pcre.c (revision 1612204)\n> +++ util_pcre.c (working copy)\n> @@ -125,7 +125,7 @@\n>      const char *errorptr;\n>      int erroffset;\n>      int errcode = 0;\n> -    int options = PCRE_DUPNAMES;\n> +    int options = 0;\n> \n>      if ((cflags & AP_REG_ICASE) != 0)\n>          options |= PCRE_CASELESS;\n> \n> This does fix the issue and corrects any of the above mentioned pcre issues.\n> 2.4.10 starts without issue now.\n\nThis means that you compile against a recent version of PCRE, but when you start Apache the RedHat provided PCRE is used. So you need to have a look at your LD_LIBRARY_PATH settings."}, {"text": "How do we specify current pcre while compiling apache? I have used \n--with-pcre:/usr/local/pcre-8.35\n\nI get the same error after installing 2.4.10 as well:\n\n[Wed Jul 23 12:48:25.293419 2014] [core:crit] [pid 30025:tid 47707166380016] AH00102: [Wed Jul 23 12:48:25 2014] file mod_setenvif.c, line 637, assertion \"is_header_regex_regex != NULL\" failed", "tags": [], "bug_id": 56413, "attachment_id": null, "count": 21, "id": 176632, "time": "2014-07-23T18:50:50Z", "creator": "lakshmi@utahinteractive.org", "creation_time": "2014-07-23T18:50:50Z", "is_private": false}, {"count": 22, "tags": [], "creator": "benjamin.taylor@savvis.com", "text": "If you apply this patch when you compile:\n\nIndex: util_pcre.c\n===================================================================\n--- util_pcre.c (revision 1612204)\n+++ util_pcre.c (working copy)\n@@ -125,7 +125,7 @@\n     const char *errorptr;\n     int erroffset;\n     int errcode = 0;\n-    int options = PCRE_DUPNAMES;\n+    int options = 0;\n\n     if ((cflags & AP_REG_ICASE) != 0)\n         options |= PCRE_CASELESS;\n\nIt will fix the issue with:\n\n[Wed Jul 23 12:48:25.293419 2014] [core:crit] [pid 30025:tid 47707166380016] AH00102: [Wed Jul 23 12:48:25 2014] file mod_setenvif.c, line 637, assertion \"is_header_regex_regex != NULL\" failed\n\nI have checked both versions of PCRE and I have tried the build both ways with using Redhat PCRE and just grabbing PCRE source. I still get the above error in either case unless I manually apply the patch from above. I also verified that the installed apache 2.4 in both cases were using the same version of PCRE that it was compiled against.", "id": 176634, "time": "2014-07-23T19:02:08Z", "bug_id": 56413, "creation_time": "2014-07-23T19:02:08Z", "is_private": false, "attachment_id": null}]