[{"count": 0, "tags": [], "text": "Hello,\n\ni get an NPE writing a null value\n\nString value = null;\n\nWorkbook workbook = new SXSSFWorkbook();\nSheet sheet = workbook.createSheet();\nRow row = sheet.createRow( currentRowNr);\nCell cell = currentRow.createCell( currentCellNr);\n\ncell.setCellValue( new XSSFRichTextString( value));\n\nError:\n\njava.lang.NullPointerException\n\tat org.apache.poi.xssf.streaming.SXSSFSheet$SheetDataWriter.outputQuotedString(SXSSFSheet.java:1384)\n\tat org.apache.poi.xssf.streaming.SXSSFSheet$SheetDataWriter.writeCell(SXSSFSheet.java:1349)\n\tat org.apache.poi.xssf.streaming.SXSSFSheet$SheetDataWriter.writeRow(SXSSFSheet.java:1289)\n\tat org.apache.poi.xssf.streaming.SXSSFSheet.flushOneRow(SXSSFSheet.java:1209)\n\tat org.apache.poi.xssf.streaming.SXSSFSheet.flushRows(SXSSFSheet.java:1199)\n\tat org.apache.poi.xssf.streaming.SXSSFSheet.getWorksheetXMLInputStream(SXSSFSheet.java:61)\n\tat org.apache.poi.xssf.streaming.SXSSFWorkbook.injectData(SXSSFWorkbook.java:108)\n\tat org.apache.poi.xssf.streaming.SXSSFWorkbook.write(SXSSFWorkbook.java:496)\n\nKind regards,\nDaniel", "attachment_id": null, "id": 147740, "creation_time": "2011-07-05T09:53:06Z", "time": "2011-07-05T09:53:06Z", "creator": "daniel.wehrle@damgroup.de", "bug_id": 51474, "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 51474, "is_private": false, "id": 147750, "time": "2011-07-05T13:12:16Z", "creator": "apache@gagravarr.org", "creation_time": "2011-07-05T13:12:16Z", "tags": [], "text": "Not sure what we should be doing for someone giving XSSFRichTextString a null value? \n\nAny chance you could check what XSSF and HSSF make of this?"}, {"count": 2, "tags": [], "bug_id": 51474, "text": "in XSSF and HSSF it's ok. \n\nI have changed implementation today cause we need large file export.", "id": 147751, "attachment_id": null, "creator": "daniel.wehrle@damgroup.de", "creation_time": "2011-07-05T13:28:03Z", "time": "2011-07-05T13:28:03Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 51474, "is_private": false, "text": "Do they just treat it as an empty string?\n\n(We'll want to replicate the same behaviour for SXSSF when fixed)", "id": 147753, "time": "2011-07-05T13:31:14Z", "creator": "apache@gagravarr.org", "creation_time": "2011-07-05T13:31:14Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 51474, "attachment_id": null, "id": 147755, "time": "2011-07-05T13:35:59Z", "creator": "daniel.wehrle@damgroup.de", "creation_time": "2011-07-05T13:35:59Z", "is_private": false, "text": "Yes. Null value should be treat as empty string.\n\nI have done a workaround in my implementation. null value -> empty string"}, {"count": 5, "tags": [], "text": "Should be fixed in r1143059.", "is_private": false, "id": 147756, "creator": "apache@gagravarr.org", "time": "2011-07-05T13:42:19Z", "bug_id": 51474, "creation_time": "2011-07-05T13:42:19Z", "attachment_id": null}]