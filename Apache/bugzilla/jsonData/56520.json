[{"count": 0, "tags": [], "bug_id": 56520, "text": "Unchecked Return Value malloc() in win32 timestr on WINDOWS platform\n\nstatic apr_size_t win32_strftime_extra(char *s, size_t max, const char *format,\n                                       const struct tm *tm) \n{\n   /* If the new format string is bigger than max, the result string won't fit\n    * anyway. If format strings are added, made sure the padding below is\n    * enough */\n    char *new_format = (char *) malloc(max + 11); <============ MALLOC\n    size_t i, j, format_length = strlen(format);\n    apr_size_t return_value;\n    int length_written;\n \n    for (i = 0, j = 0; (i < format_length && j < max);) {\n        if (format[i] != '%') {\n            new_format[j++] = format[i++]; <============ INVALID MEMORY REFERENCE\n            continue;\n\nBR,\nMaksymilian\ncifrex.org", "id": 175184, "time": "2014-05-13T17:18:05Z", "creator": "max@cert.cx", "creation_time": "2014-05-13T17:18:05Z", "is_private": false, "attachment_id": null}]