[{"count": 0, "tags": [], "bug_id": 35991, "is_private": false, "text": "I'm trying to generate the following code use BCEL:\n\npackage bci;\n\npublic class Test {\n\n  public int[] getArray() {\n    return new int[1];\n  }\n\n  public static void main(String[] args) {\n  }\n}\n\nI use BCELIfier to generate the code that creates Test. The snippet that creates getArray is\n\n  private void createMethod_2() {\n    InstructionList il = new InstructionList();\n    MethodGen method = new MethodGen(ACC_PUBLIC, new ArrayType(T_INT, 1), Type.NO_ARGS, new \nString[] {  }, \"getArray\", \"bci.Test\", il, _cp);\n\n    InstructionHandle ih_0 = il.append(new PUSH(_cp, 1));\n    il.append(_factory.createNewArray(new ArrayType(T_INT, 1), (short) 1));\n    InstructionHandle ih_3 = il.append(_factory.createReturn(Type.OBJECT));\n    method.setMaxStack();\n    method.setMaxLocals();\n    _cg.addMethod(method.getMethod());\n    il.dispose();\n  }\n\nI run TestCreator (generated by BCELIfier) and execute Test, which triggers the following error:\n\nException in thread \"main\" java.lang.VerifyError: (class: bci/Test, method: getArray signature: ()[I) \nWrong return type in function\n\nIf I return null rather than the array, everything is perfectly allright.", "id": 77987, "time": "2005-08-03T09:08:14Z", "creator": "cavengene@yahoo.de", "creation_time": "2005-08-03T09:08:14Z", "attachment_id": null}, {"count": 1, "text": "I figured this is actually a bug in BCELIfier. Rather than\n\n    il.append(_factory.createNewArray(new ArrayType(Type.INT, 1), (short) 1));\n\nit should say\n\n    il.append(_factory.createNewArray(Type.INT, (short) 1));\n", "bug_id": 35991, "is_private": false, "id": 77988, "time": "2005-08-03T09:35:26Z", "creator": "cavengene@yahoo.de", "creation_time": "2005-08-03T09:35:26Z", "tags": [], "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 35991, "attachment_id": null, "is_private": false, "id": 78000, "time": "2005-08-03T12:30:47Z", "creator": "dbrosius@mebigfatguy.com", "creation_time": "2005-08-03T12:30:47Z", "text": "agreed... working on it."}, {"count": 3, "tags": [], "creator": "dbrosius@mebigfatguy.com", "attachment_id": null, "is_private": false, "id": 78058, "time": "2005-08-04T05:57:45Z", "bug_id": 35991, "creation_time": "2005-08-04T05:57:45Z", "text": "fix applied to svn, thanks for the report."}]