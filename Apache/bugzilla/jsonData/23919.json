[{"count": 0, "tags": [], "bug_id": 23919, "attachment_id": null, "id": 45891, "creation_time": "2003-10-19T11:51:34Z", "time": "2003-10-19T11:51:34Z", "creator": "jkf@apache.org", "text": "Because of encoding issues the following files cannot be build using\njava version \"1.2.2\"\nClassic VM (build JDK-1.2.2_016, green threads, nojit)\nat least on linux.\n\nsrc/main/org/apache/tools/ant/filters/ConcatFilter.java\nsrc/main/org/apache/tools/ant/types/selectors/modifiedselector/Algorithm.java\nsrc/main/org/apache/tools/ant/types/selectors/modifiedselector/Cache.java\nsrc/main/org/apache/tools/ant/types/selectors/modifiedselector/DigestAlgorithm.java\nsrc/main/org/apache/tools/ant/types/selectors/modifiedselector/EqualComparator.java\nsrc/main/org/apache/tools/ant/types/selectors/modifiedselector/HashvalueAlgorithm.java\nsrc/main/org/apache/tools/ant/types/selectors/modifiedselector/ModifiedSelector.java\nsrc/main/org/apache/tools/ant/types/selectors/modifiedselector/PropertiesfileCache.java\n\nThe encoding issues were caused by nonessential items in the code, an alternate\n' in don't etc. and an e with an accent in a persons name. I replaced the\nalternate ' with ' and the e with accent to an e without one in the patch, the\ncode now compiles using jdk 1.2.2", "is_private": false}, {"count": 1, "tags": [], "creator": "jkf@apache.org", "attachment_id": 8616, "id": 45892, "time": "2003-10-19T11:57:36Z", "bug_id": 23919, "creation_time": "2003-10-19T11:57:36Z", "is_private": false, "text": "Created attachment 8616\nPatch to avoid encoding issues for jdk 1.2.2"}, {"count": 2, "tags": [], "bug_id": 23919, "text": "Created attachment 8617\nPatch to avoid compile issues for test code on jdk 1.2.2", "id": 45893, "time": "2003-10-19T13:03:13Z", "creator": "jkf@apache.org", "creation_time": "2003-10-19T13:03:13Z", "is_private": false, "attachment_id": 8617}, {"count": 3, "tags": [], "creator": "jkf@apache.org", "attachment_id": null, "id": 45894, "time": "2003-10-19T13:04:42Z", "bug_id": 23919, "creation_time": "2003-10-19T13:04:42Z", "is_private": false, "text": "The same problem also existed for the test code. Fixed in a separate patch.\n\nsrc/testcases/org/apache/tools/ant/filters/ConcatFilterTest.java\nsrc/testcases/org/apache/tools/ant/types/selectors/BaseSelectorTest.java\nsrc/testcases/org/apache/tools/ant/types/selectors/ModifiedSelectorTest.java\n"}, {"count": 4, "tags": [], "bug_id": 23919, "attachment_id": 8619, "text": "Created attachment 8619\nAdaptation to testcase to make testcase also pass on jdk 1.2.2", "id": 45895, "time": "2003-10-19T14:25:49Z", "creator": "jkf@apache.org", "creation_time": "2003-10-19T14:25:49Z", "is_private": false}, {"count": 5, "tags": [], "creator": "jkf@apache.org", "attachment_id": null, "id": 45896, "time": "2003-10-19T14:27:32Z", "bug_id": 23919, "creation_time": "2003-10-19T14:27:32Z", "is_private": false, "text": "An Sitraka testcase has a dependency on the compiler that compiles an test\nclass. The testcase is set up to allow for such variations, but the lower limit\nfor one of the items has to be adapted to pass the testcase on JDK 1.2.2"}, {"attachment_id": null, "tags": [], "bug_id": 23919, "text": "Martin Kruithof says : \n\"Because of encoding issues the following files cannot be build using\njava version \"1.2.2\"\nClassic VM (build JDK-1.2.2_016, green threads, nojit)\nat least on linux. ...\"\n\nI am OK to checkin the patches of Martijn in both the ant1.6 and the main\nbranches. I am surprised that we have to change Mat\u00e8rne into Materne (remove\naccents) to make ant build, but if this is needed, let it be.\n\nUnless someone voices a concern, I will check in the patches this evening.\n\nAntoine", "count": 6, "id": 45917, "time": "2003-10-20T11:28:05Z", "creator": "antoine@apache.org", "creation_time": "2003-10-20T11:28:05Z", "is_private": false}, {"count": 7, "tags": [], "creator": "jan@materne.de", "attachment_id": null, "id": 45963, "time": "2003-10-21T07:50:28Z", "bug_id": 23919, "creation_time": "2003-10-21T07:50:28Z", "is_private": false, "text": "The accents are part of UNICODE and therefore available in Java. It does \ncompile on my (and other) machines (otherwise I hadn\u00b4t committed that :-).\n\nSo I think something is wrong with your build environment.\n\nI would declare that part as WONTFIX until there are others which can confirm \nthat."}, {"count": 8, "tags": [], "bug_id": 23919, "text": "I have just tested with jdk 1.2.2 and it does not compile -\n    [javac]\n/home/preilly/cvs/ant.live/src/main/org/apache/tools/ant/types/selectors/\nmodifiedselector/Algorithm.java:1: The source file encoding may be different\nwith thi\ns platform encoding. Please use -encoding option to adjust file encoding, or\napply na\ntive2ascii utility to make source file ASCII encoding\n\nWe need to support jdk 1.2.2 - even if it is wrong ;-)", "id": 45965, "time": "2003-10-21T08:07:26Z", "creator": "peter.reilly@corvil.com", "creation_time": "2003-10-21T08:07:26Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 23919, "attachment_id": null, "id": 45966, "creation_time": "2003-10-21T08:15:40Z", "time": "2003-10-21T08:15:40Z", "creator": "antoine@apache.org", "text": "the sitraka classfile test with the patch supplied in the attachment does not\npass under jdk 1.4", "is_private": false}, {"count": 10, "tags": [], "creator": "jan@materne.de", "attachment_id": null, "id": 45967, "time": "2003-10-21T08:32:44Z", "bug_id": 23919, "creation_time": "2003-10-21T08:32:44Z", "is_private": false, "text": "But I tried with JDK 1.2.1 ...\n\nClassic VM (build JDK-1.2.1_004, native threads)\non Windows 2000 SP4 German\n\nOf course JDK 1.2 has to be supported - but it is (on my machine).\n\nhttp://java.sun.com/products/jdk/1.2/docs/tooldocs/win32/javac.html\nhttp://java.sun.com/products/jdk/1.2/docs/tooldocs/solaris/javac.html\n\nStandard Options: -encoding \nSet the source file encoding name, such as EUCJIS/SJIS. If -encoding is not \nspecified, the platform default converter is used. \n\n\nFor my machine: ant -diagnostics\njava.version=1.2.1\nuser.timezone : Europe/Berlin\njava.specification.version : 1.2\njava.vm.vendor : Sun Microsystems Inc.\njava.vm.specification.version : 1.0\nos.arch : x86\nfile.encoding.pkg : sun.io\nuser.region : DE\nos.name : Windows NT\nsun.io.unicode.encoding : UnicodeLittle\nfile.encoding : Cp1252\njava.class.version : 46.0\njava.vm.version : 1.2.1\njava.compiler : symcjit\n\n\nBecause that is not a bug in the code we should alter the buildfile and set a \ncommon encoding there. So we do not depend on a local setting outside the \nbuildfile.\n\n\n\n--- C:\\seu\\cvs-downloads\\ant\\ant\\build.xml.org.fixcrlf\tTue Oct 21 08:27:50 2003\n+++ C:\\seu\\cvs-downloads\\ant\\ant\\build.xml\tTue Oct 21 08:26:30 2003\n@@ -49,6 +49,7 @@\n   <property name=\"deprecation\" value=\"false\"/>\n   <property name=\"optimize\" value=\"true\"/>\n   <property name=\"javac.target\" value=\"1.1\"/>\n+  <property name=\"javac.encoding\" value=\"ISO-8859-1\"/>\n   <property name=\"junit.fork\" value=\"false\"/>\n   <property name=\"junit.filtertrace\" value=\"off\"/>\n   <property name=\"junit.summary\" value=\"no\"/>\n@@ -596,6 +597,7 @@\n            debug=\"${debug}\"\n            deprecation=\"${deprecation}\"\n            target=\"${javac.target}\"\n+           encoding=\"${javac.encoding}\"\n            optimize=\"${optimize}\" >\n       <classpath refid=\"classpath\"/>\n \n@@ -1334,6 +1336,7 @@\n            destdir=\"${build.tests}\"\n            debug=\"${debug}\"\n            target=\"${javac.target}\"\n+           encoding=\"${javac.encoding}\"\n            deprecation=\"${deprecation}\" >\n       <classpath refid=\"tests-classpath\"/>\n\n\n"}, {"count": 11, "tags": [], "bug_id": 23919, "attachment_id": null, "text": "Yep the change in the build.xml fixes the problem.\n\nOne of the unit tests fail (well two but one of\nthose - taskdefs.optional.i18n.TranslateTest failed for me with\njdk 1.4 as well).\n\n    [junit] Testcase:\ntestSelectionBehaviour(org.apache.tools.ant.types.selectors.ContainsSelectorTest):\n Caused an ERROR\n    [junit] Could not read file asf-logo.gif.bz2\n    [junit] Could not read file asf-logo.gif.bz2\n\n(Wow the unit tests are soooo much slower with jdk1.2.2)", "id": 45972, "time": "2003-10-21T08:56:41Z", "creator": "peter.reilly@corvil.com", "creation_time": "2003-10-21T08:56:41Z", "is_private": false}, {"count": 12, "tags": [], "bug_id": 23919, "text": "On adding the io exception in the buildexeception, the error reported\nis:\n\n    [junit] --- Nested Exception ---\n    [junit] sun.io.MalformedInputException\n    [junit]     at sun.io.ByteToCharUTF8.convert(ByteToCharUTF8.java:87)\n    [junit]     at java.io.InputStreamReader.convertInto(InputStreamReader.java:120)\n    [junit]     at java.io.InputStreamReader.fill(InputStreamReader.java:169)\n    [junit]     at java.io.InputStreamReader.read(InputStreamReader.java:232)\n    [junit]     at java.io.BufferedReader.fill(BufferedReader.java:130)\n    [junit]     at java.io.BufferedReader.readLine(BufferedReader.java:267)\n    [junit]     at java.io.BufferedReader.readLine(BufferedReader.java:322)\n    [junit]     at\norg.apache.tools.ant.types.selectors.ContainsSelector.isSelected(ContainsSelector.java:212)\n", "id": 45974, "time": "2003-10-21T09:08:23Z", "creator": "peter.reilly@corvil.com", "creation_time": "2003-10-21T09:08:23Z", "is_private": false, "attachment_id": null}, {"count": 13, "tags": [], "bug_id": 23919, "text": "Hi, on the last issue mentioned I wrote a separate bug report as it also fails\nfor the IBM JDK. Its bug id 23920.\n\nRegarding the encoding ISO-8859-1 cannot contain all Unicode characters, but\ncontains only a subset. A subset of this and many other encodings is US-ASCII,\nwhich seems to match with the rest of the codebase. Why should code set ISO\n8859-1 be selected to develop with, as said taking only a subset would match\nmany encodings, while also ISO 8859-1 is a subset of the entire Unicode space.\nChooosing character set 8859-1 is choosing an obsolete character set (it has\nbeen superseded by 8859-15 at least in western europe afaik) which makes it\nharder to develop for people that normally use an other encoding (while working\nwith a lot of different encodings, certainly the entire ISO 8859 series, KOI8-R\nvarious ms-dos codepages and UTF-8 work as long as everyone uses the common\nASCII subset) Furthermore the transition to the UTF-8 encoding, which allows all\nunicode characters is ruled out by using ISO 8859-1.\n\nTherefore imho choosing ISO 8859-1 isn't going to make developing on ant easier\nfor a lot of people, and will even make it more difficult to go to the only\nUnicode encoding variant we currently comply with (UTF-8) if we wanted to\nsupport all unicode characters in the ant source.", "id": 46005, "time": "2003-10-21T20:22:31Z", "creator": "jkf@apache.org", "creation_time": "2003-10-21T20:22:31Z", "is_private": false, "attachment_id": null}, {"count": 14, "tags": [], "bug_id": 23919, "attachment_id": 8656, "text": "Created attachment 8656\nsample iso-8859-15 text file", "id": 46007, "time": "2003-10-21T21:00:40Z", "creator": "antoine@apache.org", "creation_time": "2003-10-21T21:00:40Z", "is_private": false}, {"count": 15, "tags": [], "bug_id": 23919, "text": "Created attachment 8657\nsample iso-8859-15 text file", "id": 46008, "time": "2003-10-21T21:01:13Z", "creator": "antoine@apache.org", "creation_time": "2003-10-21T21:01:13Z", "is_private": false, "attachment_id": 8657}, {"count": 16, "tags": [], "creator": "antoine@apache.org", "attachment_id": 8658, "id": 46009, "time": "2003-10-21T21:01:54Z", "bug_id": 23919, "creation_time": "2003-10-21T21:01:54Z", "is_private": false, "text": "Created attachment 8658\nsample iso-8859-1 text file"}, {"count": 17, "tags": [], "bug_id": 23919, "text": "I am OK for ISO-8859-15 personally.\n\nIs this OK for Americans ? for Australians ? for Chinese ? for Japanese ? ...\nfor exotic operating systems ? Dunno.\n\nFor fun, I have edited under JEdit 2 text files with the same textual content,\none in iso-8859-15, the other one in iso-8859-1\nThe only difference I saw between them is in an exotic French character that we\ncall \"o e dans l'o\" which looks like an o and e stuck together.\nIDEA was not able to display properly this letter in either encodings.", "id": 46010, "time": "2003-10-21T21:09:08Z", "creator": "antoine@apache.org", "creation_time": "2003-10-21T21:09:08Z", "is_private": false, "attachment_id": null}, {"count": 18, "tags": [], "creator": "stevel@apache.org", "attachment_id": null, "id": 46020, "time": "2003-10-22T01:21:00Z", "bug_id": 23919, "creation_time": "2003-10-22T01:21:00Z", "is_private": false, "text": "What impact does it have on CVS patches? And IDEs? \n\nI think it may be best to stick to ASCII in the source with everything else\nrepresented as \\uabcd when needed."}, {"count": 19, "tags": [], "bug_id": 23919, "text": "FWIW, I agree with Stever that we'd better try to keep our sources to ASCII only.", "id": 46112, "time": "2003-10-23T09:45:34Z", "creator": "bodewig@apache.org", "creation_time": "2003-10-23T09:45:34Z", "is_private": false, "attachment_id": null}, {"count": 20, "tags": [], "bug_id": 23919, "attachment_id": null, "text": "I have no problems either to keep the sources to ASCII only. In this case, we\nwould change the build.xml again to say encoding=\"US-ASCII\" and remove all\naccentuated characters from the sources. ", "id": 46118, "time": "2003-10-23T10:05:06Z", "creator": "antoine@apache.org", "creation_time": "2003-10-23T10:05:06Z", "is_private": false}, {"count": 21, "tags": [], "bug_id": 23919, "attachment_id": 8699, "text": "Created attachment 8699\nThe 1 other class that did not comply to ASCII translated to ASCII", "id": 46154, "time": "2003-10-23T17:38:04Z", "creator": "jkf@apache.org", "creation_time": "2003-10-23T17:38:04Z", "is_private": false}, {"count": 22, "tags": [], "bug_id": 23919, "attachment_id": null, "text": "When the patch 10/19/03 11:57, 10/19/03 13:03 and 10/23/03 17:38 all non ASCII\ncharacters are removed from the java sources.\nTranslations have been done from an alternative form of ' to ' and\nnames have been spelled with non accented characters.\nTo be explicit about the names\nJan Materne and \nAslak Hellesoy\n\nI missed the src/main/org/apache/tools/ant/taskdefs/optional/IContract.java file\nprobably because it is not touched in a basic build of ant.\n\nPlease also apply patch 10/19/03 14:25 as it makes a testcase pass on jdk 1.2.2\nwhich would otherwise fail.\nThis leaves only one testcase open for jdk 1.2.2 which has been described in the\nbug report 23920", "id": 46155, "time": "2003-10-23T17:55:22Z", "creator": "jkf@apache.org", "creation_time": "2003-10-23T17:55:22Z", "is_private": false}, {"count": 23, "tags": [], "bug_id": 23919, "attachment_id": null, "text": "I Just read the mail of Stefan suggesting to use the escapes, \n\nI made a new patch which replaces all patches except for the patch 8619 10/19/03\n14:25 which does replace the e and the o from the names by unicode escape\nsequences but replaces \\u00b4 by ' to avoid constructs like don\\u00b4t\n\nI am currently verifying the patch", "id": 46164, "time": "2003-10-23T19:09:02Z", "creator": "jkf@apache.org", "creation_time": "2003-10-23T19:09:02Z", "is_private": false}, {"count": 24, "tags": [], "creator": "jkf@apache.org", "attachment_id": 8705, "id": 46166, "time": "2003-10-23T19:18:00Z", "bug_id": 23919, "creation_time": "2003-10-23T19:18:00Z", "is_private": false, "text": "Created attachment 8705\n\\u00b4 replaced by ' e from materne replaced by \\u00e8 and o from hellesoy replaced by \\u00f8."}, {"count": 25, "tags": [], "bug_id": 23919, "attachment_id": null, "text": "Attachment 8705 (replacement of accentuated characters by UNICODE escapes)\nsubmitted in the HEAD revision of ant. Thanks a lot Martijn.\nI will also test it and submit it in the ant1.6 branch.", "id": 46206, "time": "2003-10-24T06:39:09Z", "creator": "antoine@apache.org", "creation_time": "2003-10-24T06:39:09Z", "is_private": false}, {"count": 26, "tags": [], "bug_id": 23919, "attachment_id": null, "text": "Attachment 8705 now also applied to ANT_16_BRANCH\nThe sitraka classfile test problem under jdk1.2 is now leftover (attachment 8619)\n", "id": 46208, "time": "2003-10-24T07:01:24Z", "creator": "antoine@apache.org", "creation_time": "2003-10-24T07:01:24Z", "is_private": false}, {"count": 27, "tags": [], "bug_id": 23919, "attachment_id": null, "id": 46334, "creation_time": "2003-10-27T18:36:34Z", "time": "2003-10-27T18:36:34Z", "creator": "antoine@apache.org", "text": "ClassFileTest change also submitted with a slight variation so that it does not\nfail under JDK 1.4. Thanks Martijn.", "is_private": false}]