[{"count": 0, "tags": [], "creator": "sebas.lillo@gmail.com", "attachment_id": null, "id": 164231, "time": "2012-12-25T14:09:28Z", "bug_id": 54349, "creation_time": "2012-12-25T14:09:28Z", "is_private": false, "text": "in order to emulate excel's rate function, I'm using apache poi v3.8. My code is:\n\npublic static void main(String[] args) {\n\n    int nper = 120;\n    double pmt = 28.1;\n    double pv = 2400;\n\n    HSSFWorkbook workbook = new HSSFWorkbook();\n    HSSFSheet sheet = workbook.createSheet();\n\n    FormulaEvaluator evaluator = workbook.getCreationHelper().createFormulaEvaluator();\n\n    Row row = sheet.createRow(0);\n\n    Cell np = row.createCell(0);\n    np.setCellValue(nper);\n\n    Cell pt = row.createCell(1);\n    pt.setCellValue(pmt);\n\n    Cell cpv = row.createCell(2);\n    cpv.setCellValue(-pv);\n\n    Cell rate = row.createCell(3); \n    rate.setCellFormula(\"RATE(A1,B1,C1)\");\n\n    evaluator.evaluateFormulaCell(rate);\n    double drate = rate.getNumericCellValue() * 100;\n    System.out.println(\"RATE: \" + drate);\n\n}\n\nwhich output is the same as excel: 0.599\n\nBut if I try the same calculation, this time with the values:\n\nint nper = 360;\ndouble pmt = 15.9;\ndouble pv = 2400;\n\n\nIn excel I get 0.580, and the program returns 3.722909655790338E-14. Is this a known bug ? Any hints ? Thanks"}, {"count": 1, "tags": [], "text": "Are you able to run some tests on intermediate values? Specifically, can you identify if the accuracy drops off gradually as you increase the values, or if there's a sudden change? And if you increase even more, does the accuracy return, or does it stay wrong?", "attachment_id": null, "id": 164238, "creator": "apache@gagravarr.org", "time": "2012-12-26T08:37:30Z", "bug_id": 54349, "creation_time": "2012-12-26T08:37:30Z", "is_private": false}, {"count": 2, "tags": [], "text": "Someone on StackOverflow has identified some problems with the code - http://stackoverflow.com/a/14087532/685641 - looks like it needs some more unit tests and some fixing up!", "attachment_id": null, "id": 164283, "creator": "apache@gagravarr.org", "time": "2012-12-30T07:47:28Z", "bug_id": 54349, "creation_time": "2012-12-30T07:47:28Z", "is_private": false}]