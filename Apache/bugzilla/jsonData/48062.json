[{"count": 0, "text": "Created attachment 24420\nIF XML\n\nWhen using multiple threads to render the attached IF XML to PCL using the\nPainter the following exception occurs. The exception does not occur when only\na single thread is used. In a quick debugging session we observed that when the\nerror occurs the method PCLPainter.getTextBoundingBox returns a rectangle with\nnegative width\n\njava.lang.NegativeArraySizeException\n        at java.awt.image.DataBufferByte.<init>(DataBufferByte.java:42)\n        at java.awt.image.Raster.createInterleavedRaster(Raster.java:253)\n        at java.awt.image.Raster.createInterleavedRaster(Raster.java:194)\n        at\norg.apache.xmlgraphics.image.loader.impl.ImageConverterG2D2Bitmap.createGrayBufferedImageWithAlpha(ImageConve\nrterG2D2Bitmap.java:170)\n        at\norg.apache.xmlgraphics.image.loader.impl.ImageConverterG2D2Bitmap.paintToBufferedImage(ImageConverterG2D2Bitm\nap.java:108)\n        at\norg.apache.xmlgraphics.image.loader.impl.ImageConverterG2D2Bitmap.convert(ImageConverterG2D2Bitmap.java:74)\n        at\norg.apache.xmlgraphics.image.loader.pipeline.ImageProviderPipeline.execute(ImageProviderPipeline.java:173)\n        at\norg.apache.xmlgraphics.image.loader.ImageManager.convertImage(ImageManager.java:330)\n        at\norg.apache.fop.render.intermediate.AbstractIFPainter.drawImage(AbstractIFPainter.java:209)\n        at\norg.apache.fop.render.pcl.PCLPainter.paintMarksAsBitmap(PCLPainter.java:304)\n        at\norg.apache.fop.render.pcl.PCLPainter.drawTextAsBitmap(PCLPainter.java:489)\n        at org.apache.fop.render.pcl.PCLPainter.drawText(PCLPainter.java:329)\n        at\norg.apache.fop.render.intermediate.IFParser$Handler$TextHandler.endElement(IFParser.java:487)\n        at\norg.apache.fop.render.intermediate.IFParser$Handler.endElement(IFParser.java:277)", "bug_id": 48062, "is_private": false, "id": 131404, "time": "2009-10-27T01:46:17Z", "creator": "bowditch_chris@hotmail.com", "creation_time": "2009-10-27T01:46:17Z", "tags": [], "attachment_id": 24420}, {"count": 1, "tags": [], "creator": "bowditch_chris@hotmail.com", "attachment_id": null, "text": "Sometimes rendering to PCL also fails with the following error:\n\njava.lang.ArrayIndexOutOfBoundsException\n        at javax.media.jai.PlanarImage.cobbleByte(PlanarImage.java:2785)\n        at javax.media.jai.PlanarImage.getData(PlanarImage.java:2067)\n        at javax.media.jai.PlanarImage.getData(PlanarImage.java:1922)\n        at javax.media.jai.RenderedOp.getData(RenderedOp.java:2222)\n        at org.apache.fop.render.pcl.PCLGenerator.paintMonochromeBitmap(PCLGenerator.java:803)\n        at org.apache.fop.render.pcl.PCLGenerator.paintBitmap(PCLGenerator.java:757)\n        at org.apache.fop.render.pcl.PCLImageHandlerRenderedImage.handleImage(PCLImageHandlerRenderedImage.java:68)\n        at org.apache.fop.render.intermediate.AbstractIFPainter.drawImage(AbstractIFPainter.java:227)\n        at org.apache.fop.render.pcl.PCLPainter.paintMarksAsBitmap(PCLPainter.java:305)\n        at org.apache.fop.render.pcl.PCLPainter.drawTextAsBitmap(PCLPainter.java:490)\n        at org.apache.fop.render.pcl.PCLPainter.drawText(PCLPainter.java:330)\n        at org.apache.fop.render.intermediate.IFParser$Handler$TextHandler.endElement(IFParser.java:569)\n        at org.apache.fop.render.intermediate.IFParser$Handler.endElement(IFParser.java:352)\n        at com.thunderhead.util.xml.BufferedContentHandler.endElement(BufferedContentHandler.java:106)", "id": 138366, "time": "2010-07-12T09:49:16Z", "bug_id": 48062, "creation_time": "2010-07-12T09:49:16Z", "is_private": false}, {"count": 2, "tags": [], "creator": "jeremias@apache.org", "attachment_id": null, "is_private": false, "id": 138434, "time": "2010-07-15T03:50:44Z", "bug_id": 48062, "creation_time": "2010-07-15T03:50:44Z", "text": "I can't reproduce the multi-threading problem with various JVMs and settings (3 to 11 threads, client and server VMs etc.) on a Core2Duo. :-("}, {"count": 3, "tags": [], "creator": "gadams@apache.org", "attachment_id": null, "is_private": false, "id": 157411, "time": "2012-04-07T01:42:37Z", "bug_id": 48062, "creation_time": "2012-04-07T01:42:37Z", "text": "resetting P2 open bugs to P3 pending further review"}]