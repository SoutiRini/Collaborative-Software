[{"count": 0, "tags": [], "bug_id": 53842, "text": "if the scoreboard file does not exist for an existing domain -\n\nUpon a restart, or graceful reload, the scoreboard file is created with root permissions.\n\n-rw-------  1 root   root     44 Sep  8 10:18 sunshinecoastnxxxxxx\n\nIf httpd is stopped, then restarted, and page hit occurs under that domain, it is created correctly - as the httpd user.\n\n-rw-------  1 apache apache   44 Sep  8 10:19 sunshinecoastnxxxxxx\n\n\n\nnote, this is not always triggered, if a new vhost is added, and graceful reload, issued,  it does create it correctly\n\n-rw-------  1 apache apache   44 Sep  8 10:23 scanairxxxxxx\n\n\nhttpd restart/graceful*/whatever, should always create these files as \"http user\"", "id": 162017, "time": "2012-09-08T00:26:15Z", "creator": "bugs@ausics.net", "creation_time": "2012-09-08T00:26:15Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 53842, "text": "Can you elaborate on why your report seems to refer to the scoreboard as per-domain and getting created after a request is received? Are you using some other software to spin up new instances of httpd?  Are you using a custom MPM?", "id": 162030, "time": "2012-09-09T01:43:40Z", "creator": "covener@gmail.com", "creation_time": "2012-09-09T01:43:40Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 53842, "attachment_id": null, "id": 162050, "time": "2012-09-10T11:18:38Z", "creator": "bugs@ausics.net", "creation_time": "2012-09-10T11:18:38Z", "is_private": false, "text": "Eric, not at all.\n\nEach new vhost is added to the conf file by a perl script, it inserts a \nCBandScoreBoard /usr/local/apache/scoreboards/domain.name\nline into its virtualhost block.\n\n/usr/local/apache/bin/apachectl -k graceful   is then issued.\n\nthe problem lies within the above command in some instances as earlier indicated.\n\nI discovered this because something went wrong with a host addition, and checking the logs I found trillion lines of \napache2_mod_cband: cannot open scoreboard file /usr/local/apache/scoreboards/domain.name\n\nwhich is correct, given it was recreated as \"root\" and not apache (user web server runs as)\n\nnew timeline...\n\nexample.com host added\nhttpd graceful issued\n\n4 minutes has elapsed\n\nls -la /usr/local/apache/scoreboards/example*\n/bin/ls: cannot access /usr/local/apache/scoreboards/example*: No such file or directory\n\n\nlynx -dump example.com\n\n                              [sitepending.png]\n\n\nls -la /usr/local/apache/scoreboards/example*\n-rw-------  1 apache apache   44 Sep 10 21:00 example.com\n\n\n rm /usr/local/apache/scoreboards/example.com\n(to simulate some error)\n\nls -la /usr/local/apache/scoreboards/example*\n/bin/ls: cannot access /usr/local/apache/scoreboards/example*: No such file or directory\n\n/etc/rc.d/rc.httpd reload\nGraceful reload of Apache... Done.\n\n\nroot@www3:/usr/local/scripts# ls -la /usr/local/apache/scoreboards/example*\n-rw-------  1 root   root     44 Sep 10 21:02 example.com\n\n\nI do note, that, if the file is removed, and, the website is hit withOUT or before a reload is issued, then the scoreboard file is recreated correctly as user apache and gives no errors.\n\nWe might have caught this error, in adding domains in quick succession of each other, getting the reload (from adding new vhost in cobf) before the earlier site was hit, httpd thinking somethings wrong as it was missing that scoreboard file so recreated it? I don't know, hence my bug report, but somethings amiss somewhere."}, {"count": 3, "tags": [], "bug_id": 53842, "text": "My bad, forgot to include we are using the default MPM", "id": 162051, "time": "2012-09-10T11:23:32Z", "creator": "bugs@ausics.net", "creation_time": "2012-09-10T11:23:32Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "text": "Thanks for clarifying -- CBandScoreBoard isn't a directive for any modules distributed by the ASF, you'll have to report your problem to the module author.", "attachment_id": null, "id": 162052, "creator": "covener@gmail.com", "time": "2012-09-10T11:50:19Z", "bug_id": 53842, "creation_time": "2012-09-10T11:50:19Z", "is_private": false}]