[{"count": 0, "attachment_id": null, "bug_id": 49908, "text": "Symbols in Word documents are stored specially:\n- in the CharacterRun there is a character 0x28\n- CHP.fSpec is true\n- CHP.ftcSym contains index of the symbol font in the font table\n- CHP.xchSym contains character in the symbol font\n\nThere are several ways how support could be implemented:\n\n1. add getters for ftcSym and xchSym to the CharacterRun, then user could process symbols like this.\n\n2. add helper class to help extract symbol and font from CharacterRun\n\nWith the first variant the user could do this:\n\n  String text = characterRun.text();\n  String fontName = characterRun.getFontName();\n  if (characterRun.isSpecialCharacter() && text.length() == 1 && text.charAt(0) == 0x28) {\n    fontName = wd.getFontTable().getMainFont(chr.getFtcSym());\n    text = new String(new char[] { (char) chr.getXchSym() } );\n  }\n  // work on with fontName and text\n\nIn my testing, the CharacterRun with symbol always contained exactly one character, but I cannot confirm this is a rule.\n\nPlease let me know which version is better to be incorporated and I will provide a patch.\n\nViliam", "id": 139800, "time": "2010-09-10T06:01:38Z", "creator": "a6537691@bofthew.com", "creation_time": "2010-09-10T06:01:38Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "a6537691@bofthew.com", "attachment_id": null, "text": "I forgot to state, that (as far as I know) the current API does not allow for processing of symbols - there is no way to read read ftcSym and xchSym from CharacterRun.", "id": 139801, "time": "2010-09-10T06:04:15Z", "bug_id": 49908, "creation_time": "2010-09-10T06:04:15Z", "is_private": false}, {"count": 2, "tags": [], "text": "I think ideally we probably want to hide some of the complexity from the user. That's how we do it for Pictures, you can pass a CharacterRun to the PicturesTable and it'll tell you if it has a picture in it, return the picture etc\n\nSo my view is that we should have a helper that will return a boolean has symbol / no symbol for a given character run, and also would return the symbol itself (looking up via the font table) if requested.\n\nI don't know enough about the uses for symbols to know if this should go in the existing FontTable, or in a helper fetched from HWPFDocument that has suitable references\n\nIf you could work on a patch, that'd be great! Marking as need info to indicate a patch is needed, remove that once uploaded.", "attachment_id": null, "bug_id": 49908, "id": 139970, "time": "2010-09-20T07:25:53Z", "creator": "apache@gagravarr.org", "creation_time": "2010-09-20T07:25:53Z", "is_private": false}, {"count": 3, "tags": [], "creator": "a6537691@bofthew.com", "attachment_id": 26130, "text": "Created attachment 26130\nPatch to support symbols (with testcase)\n\nI added the methods to CharacterRun, as processing of symbols is directly associated with particular character run and the processing does not need other information (as the case with pictures). Methods are documented.", "id": 140533, "time": "2010-10-07T02:27:24Z", "bug_id": 49908, "creation_time": "2010-10-07T02:27:24Z", "is_private": false}, {"count": 4, "tags": [], "text": "Created attachment 26131\nNew files not included in the diff", "attachment_id": 26131, "id": 140534, "creator": "a6537691@bofthew.com", "time": "2010-10-07T02:27:45Z", "bug_id": 49908, "creation_time": "2010-10-07T02:27:45Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 49908, "attachment_id": null, "id": 140556, "time": "2010-10-07T09:42:38Z", "creator": "yegor@dinom.ru", "creation_time": "2010-10-07T09:42:38Z", "is_private": false, "text": "Applied in r1005443\n\nThanks,\nYegor"}, {"count": 6, "tags": [], "creator": "dfisher@jmlafferty.com", "attachment_id": null, "text": "*** Bug 33227 has been marked as a duplicate of this bug. ***", "id": 141250, "time": "2010-10-29T18:25:49Z", "bug_id": 49908, "creation_time": "2010-10-29T18:25:49Z", "is_private": false}]