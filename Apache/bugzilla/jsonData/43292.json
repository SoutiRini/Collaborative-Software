[{"count": 0, "tags": [], "creator": "gekis@yandex.ru", "is_private": false, "id": 107649, "creation_time": "2007-09-03T03:35:17Z", "time": "2007-09-03T03:35:17Z", "bug_id": 43292, "text": "No check for null:\n\n    public String[] mapFileName(String sourceFileName) {\n\n            String result = FileUtils.readFully(helper.getAssembledReader());\n!!!         if (result.length() == 0) {\n                return null;\n\nchange to:\n            if (result==null || result.length() == 0) {\n\n\njava.lang.NullPointerException\n\tat\norg.apache.tools.ant.types.mappers.FilterMapper.mapFileName(FilterMapper.java:74)\n\tat org.apache.tools.ant.util.CompositeMapper.mapFileName(CompositeMapper.java:38)\n\tat gekis.ant.taskdefs.Append.buildMap(Append.java:691)\n\tat gekis.ant.taskdefs.Append.scan(Append.java:630)\n\tat gekis.ant.taskdefs.Append.execute(Append.java:513)\n\tat org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:585)\n\tat org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)\n\tat org.apache.tools.ant.Task.perform(Task.java:348)\n\tat org.apache.tools.ant.Target.execute(Target.java:357)\n\tat org.apache.tools.ant.Target.performTasks(Target.java:385)\n\tat org.apache.tools.ant.Project.executeSortedTargets(Project.java:1329)\n\tat\norg.apache.tools.ant.helper.SingleCheckExecutor.executeTargets(SingleCheckExecutor.java:38)\n\tat org.apache.tools.ant.Project.executeTargets(Project.java:1181)\n\tat org.apache.tools.ant.taskdefs.Ant.execute(Ant.java:416)\n\tat gekis.ant.process.StepsProcessor.execute(StepsProcessor.java:136)\n\tat org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:585)\n\tat org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)\n\tat org.apache.tools.ant.Task.perform(Task.java:348)\n\tat org.apache.tools.ant.Target.execute(Target.java:357)\n\tat org.apache.tools.ant.Target.performTasks(Target.java:385)\n\tat org.apache.tools.ant.Project.executeSortedTargets(Project.java:1329)\n\tat org.apache.tools.ant.Project.executeTarget(Project.java:1298)\n\tat\norg.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n\tat org.apache.tools.ant.Project.executeTargets(Project.java:1181)\n\tat org.apache.tools.ant.Main.runBuild(Main.java:698)\n\tat org.apache.tools.ant.Main.startAnt(Main.java:199)\n\tat org.apache.tools.ant.Main.start(Main.java:161)\n\tat org.apache.tools.ant.Main.main(Main.java:250)", "attachment_id": null}, {"count": 1, "tags": [], "text": "Yes, FileUtils.readFully() can return null for empty\nfiles.\nI would rather change FileUtils.readFully() rather\nthat have all the clients do the null check stepdance.", "attachment_id": null, "id": 107651, "creator": "peterreilly@apache.org", "time": "2007-09-03T03:45:18Z", "bug_id": 43292, "creation_time": "2007-09-03T03:45:18Z", "is_private": false}, {"count": 2, "attachment_id": null, "bug_id": 43292, "text": "Thanks for the report, I fixed FileUtils.readFully\nto do the right thing.\nWill be in the next ant release.", "id": 107657, "time": "2007-09-03T05:59:49Z", "creator": "peterreilly@apache.org", "creation_time": "2007-09-03T05:59:49Z", "tags": [], "is_private": false}]