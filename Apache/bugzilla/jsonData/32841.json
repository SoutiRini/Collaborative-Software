[{"count": 0, "tags": [], "bug_id": 32841, "attachment_id": null, "text": "i rewrote the login usecase to use the new usecase framework. unfortunately,\ncalling the usecase fails because the usecase framework tries to setup\ninformation that is not yet available.\n\norg.apache.avalon.framework.CascadingRuntimeException:\n\"file:/C:/src/lenya-trunk/build/lenya/webapp/lenya/usecases/usecases.js\", line\n44: uncaught JavaScript exception: \nat executeUsecase\n(file:/C:/src/lenya-trunk/build/lenya/webapp/lenya/usecases/usecases.js, Line 44):\norg.apache.avalon.framework.service.ServiceException: usecases:\nComponentSelector could not access the Component for hint [ac.Login] (key\n[ac.Login]) (Key='org.apache.lenya.cms.usecase.UsecaseSelector/ac.Login')\n\tat\norg.apache.cocoon.components.flow.javascript.fom.FOM_JavaScriptInterpreter.callFunction(FOM_JavaScriptInterpreter.java:733)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.CallFunctionNode.invoke(CallFunctionNode.java:135)\n\tat\norg.apache.cocoon.components.treeprocessor.AbstractParentProcessingNode.invokeNodes(AbstractParentProcessingNode.java:46)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.PreparableMatchNode.invoke(PreparableMatchNode.java:130)\n\tat\norg.apache.cocoon.components.treeprocessor.AbstractParentProcessingNode.invokeNodes(AbstractParentProcessingNode.java:68)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.PipelineNode.invoke(PipelineNode.java:138)\n\tat\norg.apache.cocoon.components.treeprocessor.AbstractParentProcessingNode.invokeNodes(AbstractParentProcessingNode.java:68)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.PipelinesNode.invoke(PipelinesNode.java:89)\n\tat\norg.apache.cocoon.components.treeprocessor.ConcreteTreeProcessor.process(ConcreteTreeProcessor.java:240)\n\tat\norg.apache.cocoon.components.treeprocessor.ConcreteTreeProcessor.process(ConcreteTreeProcessor.java:180)\n\tat\norg.apache.cocoon.components.treeprocessor.TreeProcessor.process(TreeProcessor.java:243)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.MountNode.invoke(MountNode.java:117)\n\tat\norg.apache.cocoon.components.treeprocessor.AbstractParentProcessingNode.invokeNodes(AbstractParentProcessingNode.java:46)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.PreparableMatchNode.invoke(PreparableMatchNode.java:130)\n\tat\norg.apache.cocoon.components.treeprocessor.AbstractParentProcessingNode.invokeNodes(AbstractParentProcessingNode.java:68)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.PipelineNode.invoke(PipelineNode.java:138)\n\tat\norg.apache.cocoon.components.treeprocessor.AbstractParentProcessingNode.invokeNodes(AbstractParentProcessingNode.java:68)\n\tat\norg.apache.cocoon.components.treeprocessor.sitemap.PipelinesNode.invoke(PipelinesNode.java:89)\n\tat\norg.apache.cocoon.components.treeprocessor.ConcreteTreeProcessor.process(ConcreteTreeProcessor.java:240)\n\tat\norg.apache.cocoon.components.treeprocessor.ConcreteTreeProcessor.process(ConcreteTreeProcessor.java:180)\n\tat\norg.apache.cocoon.components.treeprocessor.TreeProcessor.process(TreeProcessor.java:243)\n\tat org.apache.cocoon.Cocoon.process(Cocoon.java:606)\n\tat org.apache.cocoon.servlet.CocoonServlet.service(CocoonServlet.java:1119)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:358)\n\tat\norg.mortbay.jetty.servlet.WebApplicationHandler.dispatch(WebApplicationHandler.java:294)\n\tat org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:567)\n\tat org.mortbay.http.HttpContext.handle(HttpContext.java:1807)\n\tat\norg.mortbay.jetty.servlet.WebApplicationContext.handle(WebApplicationContext.java:525)\n\tat org.mortbay.http.HttpContext.handle(HttpContext.java:1757)\n\tat org.mortbay.http.HttpServer.service(HttpServer.java:879)\n\tat org.mortbay.http.HttpConnection.service(HttpConnection.java:790)\n\tat org.mortbay.http.HttpConnection.handleNext(HttpConnection.java:961)\n\tat org.mortbay.http.HttpConnection.handle(HttpConnection.java:807)\n\tat org.mortbay.http.SocketListener.handleConnection(SocketListener.java:218)\n\tat org.mortbay.util.ThreadedServer.handle(ThreadedServer.java:300)\n\tat org.mortbay.util.ThreadPool$PoolThread.run(ThreadPool.java:511)\nCaused by: org.apache.avalon.framework.service.ServiceException: usecases:\nComponentSelector could not access the Component for hint [ac.Login] (key\n[ac.Login]) (Key='org.apache.lenya.cms.usecase.UsecaseSelector/ac.Login')\n\tat\norg.apache.avalon.framework.service.WrapperServiceSelector.select(WrapperServiceSelector.java:125)\n\tat\norg.apache.lenya.cms.usecase.UsecaseResolverImpl.resolve(UsecaseResolverImpl.java:47)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:324)\n\tat\norg.apache.avalon.excalibur.component.ComponentProxyGenerator$ComponentInvocationHandler.invoke(ComponentProxyGenerator.java:143)\n\tat $Proxy8.resolve(Unknown Source)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:324)\n\tat org.mozilla.javascript.NativeJavaMethod.call(NativeJavaMethod.java:230)\n\tat org.mozilla.javascript.ScriptRuntime.call(ScriptRuntime.java:1244)\n\tat\norg.mozilla.javascript.continuations.ContinuationInterpreter.interpret(ContinuationInterpreter.java:1134)\n\tat\norg.mozilla.javascript.continuations.ContinuationInterpreter.interpret(ContinuationInterpreter.java:190)\n\tat\norg.mozilla.javascript.continuations.ContinuationInterpreter.interpret(ContinuationInterpreter.java:138)\n\tat\norg.mozilla.javascript.continuations.InterpretedFunctionImpl.call(InterpretedFunctionImpl.java:121)\n\tat org.mozilla.javascript.ScriptRuntime.call(ScriptRuntime.java:1244)\n\tat\norg.apache.cocoon.components.flow.javascript.fom.FOM_JavaScriptInterpreter.callFunction(FOM_JavaScriptInterpreter.java:724)\n\t... 36 more\nCaused by: org.apache.avalon.framework.component.ComponentException: usecases:\nComponentSelector could not access the Component for hint [ac.Login] (key\n[ac.Login])\n\tat\norg.apache.avalon.excalibur.component.ExcaliburComponentSelector.select(ExcaliburComponentSelector.java:229)\n\tat\norg.apache.cocoon.components.ExtendedComponentSelector.select(ExtendedComponentSelector.java:260)\n\tat\norg.apache.avalon.framework.service.WrapperServiceSelector.select(WrapperServiceSelector.java:121)\n\t... 55 more\nCaused by: java.lang.RuntimeException:\norg.apache.lenya.workflow.WorkflowException:\norg.apache.lenya.ac.AccessControlException: Request\n[org.apache.cocoon.environment.http.HttpRequest@a45435] does not contain roles: \n    URI: [/default/authoring/index.html]\n    Parameter: [lenya.usecase] = [ac.Login]\n\n\tat\norg.apache.lenya.cms.usecase.AbstractUsecase.doInitialize(AbstractUsecase.java:372)\n\tat\norg.apache.lenya.cms.admin.AccessControlUsecase.doInitialize(AccessControlUsecase.java:55)\n\tat\norg.apache.lenya.cms.usecase.AbstractUsecase.initialize(AbstractUsecase.java:358)\n\tat\norg.apache.avalon.framework.container.ContainerUtil.initialize(ContainerUtil.java:283)\n\tat\norg.apache.avalon.excalibur.component.DefaultComponentFactory.newInstance(DefaultComponentFactory.java:277)\n\tat\norg.apache.avalon.excalibur.component.DefaultComponentHandler.doGet(DefaultComponentHandler.java:136)\n\tat\norg.apache.avalon.excalibur.component.ComponentHandler.get(ComponentHandler.java:381)\n\tat\norg.apache.avalon.excalibur.component.ExcaliburComponentSelector.select(ExcaliburComponentSelector.java:213)\n\t... 57 more\nCaused by: org.apache.lenya.workflow.WorkflowException:\norg.apache.lenya.ac.AccessControlException: Request\n[org.apache.cocoon.environment.http.HttpRequest@a45435] does not contain roles: \n    URI: [/default/authoring/index.html]\n    Parameter: [lenya.usecase] = [ac.Login]\n\n\tat\norg.apache.lenya.cms.cocoon.workflow.WorkflowHelper.buildSituation(WorkflowHelper.java:63)\n\tat\norg.apache.lenya.cms.cocoon.workflow.WorkflowHelper.buildSituation(WorkflowHelper.java:49)\n\tat\norg.apache.lenya.cms.usecase.AbstractUsecase.doInitialize(AbstractUsecase.java:370)\n\t... 64 more\nCaused by: org.apache.lenya.ac.AccessControlException: Request\n[org.apache.cocoon.environment.http.HttpRequest@a45435] does not contain roles: \n    URI: [/default/authoring/index.html]\n    Parameter: [lenya.usecase] = [ac.Login]\n\n\tat org.apache.lenya.ac.impl.PolicyAuthorizer.getRoles(PolicyAuthorizer.java:174)\n\tat\norg.apache.lenya.cms.cocoon.workflow.WorkflowHelper.buildSituation(WorkflowHelper.java:61)\n\t... 66 more", "id": 68993, "time": "2004-12-26T16:34:48Z", "creator": "gregor@apache.org", "creation_time": "2004-12-26T16:34:48Z", "is_private": false}, {"count": 1, "tags": [], "creator": "andreas@apache.org", "attachment_id": null, "id": 69154, "time": "2005-01-03T16:32:33Z", "bug_id": 32841, "creation_time": "2005-01-03T16:32:33Z", "is_private": false, "text": "I added a WorkflowUsecase class to the hierarchy which is not extended by the\naccess control usecases. Therefore the workflow situation is not resolved anymore."}]