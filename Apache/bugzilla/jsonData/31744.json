[{"count": 0, "tags": [], "creator": "rhino1@sympatico.ca", "attachment_id": null, "id": 65224, "time": "2004-10-16T12:55:45Z", "bug_id": 31744, "creation_time": "2004-10-16T12:55:45Z", "is_private": false, "text": "I would like to see the FTP task use the same connection if the user is \nexecuting several subsequent FTP tasks that use the same server, userid and \npassword. \n\nFor example, in my current project, I have one FTP task to delete all existing \nfiles beneath a given directory, another FTP task to delete the (now empty) \nsubdirectories beneath that same directory, five separate FTP tasks to create \nfive new subdirectories, and five FTP tasks to populate each of those new \nsubdirectories. Each of those tasks needs to connect and disconnect which adds \nsubstantially to the elapsed time for these tasks yet all of these tasks are \noperating against the exact same server with the same userid and password. If \nthese tasks shared the same connection, it would save a lot of time."}, {"count": 1, "tags": [], "creator": "scohen@apache.org", "attachment_id": null, "text": "This is a very interesting suggestion and I am considering how best to implement it.\n\nI have an idea.  I'd like some of the other ant developers to chime in on it.\n\nSuppose we had an <ftp-connection> data type, with an id, etc.  Could we wrap\nthat around a jakarta-commons-net FTPClient object, and keep its connection\nlive?  Then we could refer to it via refid in subsequent invocations of the\n<ftp> task within the same target.  Some care would have to be taken to insure\nthat the connection is closed within the target.\n\nSo ant-dev's please chime in here.  Is there any glaring flaw in this plan that\nwould cause it not to work?", "id": 75598, "time": "2005-05-30T18:12:57Z", "bug_id": 31744, "creation_time": "2005-05-30T18:12:57Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 31744, "attachment_id": null, "text": "Should work fine. :-)", "id": 75601, "time": "2005-05-30T19:34:36Z", "creator": "antoine@apache.org", "creation_time": "2005-05-30T19:34:36Z", "is_private": false}, {"count": 3, "tags": [], "creator": "jkf@apache.org", "attachment_id": null, "id": 75602, "time": "2005-05-30T19:52:47Z", "bug_id": 31744, "creation_time": "2005-05-30T19:52:47Z", "is_private": false, "text": "I'd in that case propose an ftp open and a close task, with the other ftp tasks\nnot closing the connection when an id is given.\n\n\n"}, {"count": 4, "tags": [], "creator": "scohen@apache.org", "attachment_id": null, "id": 75604, "time": "2005-05-30T20:14:33Z", "bug_id": 31744, "creation_time": "2005-05-30T20:14:33Z", "is_private": false, "text": "A better idea might be something like this:\n\n<ftp user=\"me\"\n     password=\"mypassword\"\n     server=\"ftp.big.server\"\n     port=\"21\"\n     systemTypeKey=\"UNIX\"\n     serverTimeZone=\"Asia/Tokyo\"\n\n>\n     <action name=\"mkdir\" remotedir=\"public/private\"/>\n     <action name=\"put\" remotedir=\"public/private\" newer=\"true\">\n         <fileset dir=\"mylocaldir\"/>\n     </action> \n     <action name=\"get\" .../>\n</ftp>\n\nThis looks like a better plan.  Question now is how to do it and still preserve\nbackward compatibility.\n\n"}, {"count": 5, "tags": [], "creator": "scohen@apache.org", "attachment_id": null, "id": 75607, "time": "2005-05-30T20:41:49Z", "bug_id": 31744, "creation_time": "2005-05-30T20:41:49Z", "is_private": false, "text": "or better yet:\n\n<ftp user=\"me\"\n     password=\"mypassword\"\n     server=\"ftp.big.server\"\n     port=\"21\"\n     systemTypeKey=\"UNIX\"\n     serverTimeZone=\"Asia/Tokyo\"\n>\n\n     <mkdir remotedir=\"public/private\"/>\n     <put remotedir=\"public/private\" newer=\"true\">\n         <fileset dir=\"mylocaldir\"/>\n     </put> \n     <get .../>\n</ftp>"}, {"count": 6, "tags": [], "bug_id": 31744, "attachment_id": null, "text": "This would pretty nearly satisfy bug 33214 as well, wouldn't it?", "id": 75661, "time": "2005-05-31T17:43:27Z", "creator": "mbenson@apache.org", "creation_time": "2005-05-31T17:43:27Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 31744, "attachment_id": null, "text": "of course, I didn't see any reason why the connection sharing would have to be \nall in one target.  It seems that you could attempt to close the connection \nduring finalization (worst case).  Then the connection could be used across \ntargets and the refid approach still has merit, with the nested action approach \nbeing an also-good-but-separate idea.", "id": 75663, "time": "2005-05-31T17:49:01Z", "creator": "mbenson@apache.org", "creation_time": "2005-05-31T17:49:01Z", "is_private": false}, {"count": 8, "tags": [], "creator": "peterreilly@apache.org", "attachment_id": null, "text": "Do not forget that the ant script may\nbe running in an IDE using one jvm - netbeans for example,\nso the connection will need to be closed by hand.\nThe nested commands to the ftp task look nice.", "id": 75664, "time": "2005-05-31T17:58:46Z", "bug_id": 31744, "creation_time": "2005-05-31T17:58:46Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 31744, "is_private": false, "id": 75666, "creation_time": "2005-05-31T20:14:25Z", "time": "2005-05-31T20:14:25Z", "creator": "mbenson@apache.org", "text": "(In reply to comment #8)\n> Do not forget that the ant script may\n> be running in an IDE using one jvm - netbeans for example,\n> so the connection will need to be closed by hand.\n\nI can't think of any other solution just now, but I still think it would be \nnice to orchestrate auto-closing of the connection per Ant \"invocation\" using \ntask invalidation or some existing mechanism.  :(\n", "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 31744, "attachment_id": null, "text": "Failing that I suppose we could recommend using a final target as in the posted \nsolution to bug 17973.", "id": 75667, "time": "2005-05-31T20:20:56Z", "creator": "mbenson@apache.org", "creation_time": "2005-05-31T20:20:56Z", "is_private": false}, {"count": 11, "tags": [], "bug_id": 31744, "attachment_id": null, "text": "(In reply to comment #6)\n> This would pretty nearly satisfy bug 33214 as well, wouldn't it?\n\nYes, I kind of had that in the back of my mind, too.", "id": 75681, "time": "2005-06-01T02:08:03Z", "creator": "scohen@apache.org", "creation_time": "2005-06-01T02:08:03Z", "is_private": false}]