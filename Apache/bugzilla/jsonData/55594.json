[{"count": 0, "attachment_id": 30880, "creator": "c.pagenkopp@googlemail.com", "text": "Created attachment 30880\nContent of sheet1.xml in text editor and error messages by excel\n\nHello,\n\nwe are using the POI-API in version 3.9 on a z/OS system.\nOn this platform we have the default encoding \"EBCDIC\".\n\nWe are now facing problems using the SXXSFWorkbook.\nWe receive corrupt Excel-XML, because within \"\\xl\\worksheets\" the sheets are corrupt.\nThe data between <sheetData> and </sheetData> is in wrong Encoding.\n\nPlease find attached a screenshot of the xml-content and the Excel message boxes.\n\nI think, that the writing into sheet-file will be done in platform encoding, but writing of resulting workbook will explicity be done using \"UTF-8\".\n\nThanks and best regards\nConstantin", "id": 170264, "time": "2013-09-25T09:24:43Z", "bug_id": 55594, "creation_time": "2013-09-25T09:24:43Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "text": "Hi all,\n\nwe found a way to fix this problem:\n\nWe changed method \nWriter createWriter(File fd)\nin org.apache.poi.xssf.streaming.GZIPSheetDataWriter and org.apache.poi.xssf.streaming.SheetDataWriter.\n\nFollowing changes have been done:\nGZIPSheetDataWriter.createWriter(File fd) ... {\n   return new BufferedWriter(new OutputStreamWriter(new GZIPOutputStream(new FileOutputStream(fd)), \"UTF-8\"));\n}\nSheetDataWriter.createWriter(File fd) ... {\n   return new BufferedWriter(new OutputStreamWriter(new FileOutputStream(fd), \"UTF-8\"));\n}\n\nWe force writing data with UTF-8 encoding, because the whole workbook will be written in UTF-8 as well.\n\nBest regards\nConstantin", "attachment_id": null, "id": 170265, "creator": "c.pagenkopp@googlemail.com", "time": "2013-09-25T10:51:02Z", "bug_id": 55594, "creation_time": "2013-09-25T10:51:02Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 55594, "attachment_id": null, "id": 170605, "time": "2013-10-14T20:10:28Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2013-10-14T20:10:28Z", "is_private": false, "text": "Reopen as I changing this in general sounds like the right thing to do to avoid similar issues for other environments with other encodings as well."}, {"count": 3, "tags": [], "bug_id": 55594, "attachment_id": null, "id": 173995, "time": "2014-03-21T15:20:45Z", "creator": "vonnahme@gmail.com", "creation_time": "2014-03-21T15:20:45Z", "is_private": false, "text": "I can confirm the fix reported works for us as well."}, {"count": 4, "tags": [], "bug_id": 55594, "attachment_id": 31421, "id": 173996, "creation_time": "2014-03-21T15:22:24Z", "time": "2014-03-21T15:22:24Z", "creator": "vonnahme@gmail.com", "text": "Created attachment 31421\nPatch as described in previous comment", "is_private": false}, {"count": 5, "tags": [], "creator": "apache@gagravarr.org", "text": "Thanks for the patch, applied in r1580314.", "id": 174018, "time": "2014-03-22T20:50:05Z", "bug_id": 55594, "creation_time": "2014-03-22T20:50:05Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "text": "*** Bug 56999 has been marked as a duplicate of this bug. ***", "is_private": false, "id": 178028, "creator": "dominik.stadler@gmx.at", "time": "2014-09-22T13:44:13Z", "bug_id": 55594, "creation_time": "2014-09-22T13:44:13Z", "attachment_id": null}]