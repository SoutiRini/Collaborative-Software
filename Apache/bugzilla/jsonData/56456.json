[{"count": 0, "tags": [], "creator": "bluewolf.chung@gmail.com", "text": "Created attachment 31558\nEndpointStateMachine class using AtomicInteger\n\nIn regard to https://issues.apache.org/bugzilla/show_bug.cgi?id=55799 , \n\nnow org.apache.tomcat.websocket.WsRemoteEndpointImplBase has its StateMachine to handle wrong concurrent accesses correctly.\n\nI've reading the code carefully and have concluded that it would be more effective if it uses lock-free synchronization using one of AtomicXXX classes.\n\n\nBased on https://www.ibm.com/developerworks/java/library/j-jtp11234/ and some other articles,\n\nI've changed 'state' to use AtomicInteger, and have adopted CAS to remove all 'synchronized' blocks.\n\nAnd for the unit test and readability, StateMachine class is moved to the upper class, having the name 'EndpointStateMachine'.", "id": 174865, "time": "2014-04-25T02:46:50Z", "bug_id": 56456, "creation_time": "2014-04-25T02:46:50Z", "is_private": false, "attachment_id": 31558}, {"count": 1, "attachment_id": 31559, "creator": "bluewolf.chung@gmail.com", "is_private": false, "id": 174866, "time": "2014-04-25T02:48:10Z", "bug_id": 56456, "creation_time": "2014-04-25T02:48:10Z", "tags": [], "text": "Created attachment 31559\nRemoteEndpoint which uses EndpointStateMachine"}, {"count": 2, "tags": [], "bug_id": 56456, "is_private": false, "text": "Created attachment 31560\njunit test for EndpointStateMachine", "id": 174867, "time": "2014-04-25T02:49:47Z", "creator": "bluewolf.chung@gmail.com", "creation_time": "2014-04-25T02:49:47Z", "attachment_id": 31560}, {"count": 3, "tags": [], "creator": "markt@apache.org", "text": "Patches should be in diff -u format to aid review.\n\nWithout some performance tests that demonstrate that this code performs better than the current code for the normal usage case(s) then this issue is likely to be resolved as WONTFIX.", "id": 174871, "time": "2014-04-25T08:11:07Z", "bug_id": 56456, "creation_time": "2014-04-25T08:11:07Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 56456, "attachment_id": null, "text": "No sign of a test case.\n\nFeel free to re-open this if you have a test case that demonstrates that there is a performance problem here that needs solving.", "id": 175316, "time": "2014-05-19T13:06:28Z", "creator": "markt@apache.org", "creation_time": "2014-05-19T13:06:28Z", "is_private": false}]