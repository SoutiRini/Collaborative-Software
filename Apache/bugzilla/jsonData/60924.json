[{"count": 0, "text": "Version: First seen with 3.10-FINAL, however skimming the code it appears to still be a problem in 3.15-FINAL.\n\nExcel 2016 added a new SWITCH statement, and likely others.  Running evaluateAll() on the workbook results in the following stack trace.\n\norg.apache.poi.ss.formula.FormulaParseException: Name '_xlfn.SWITCH' is completely unknown in the current workbook\n\tat org.apache.poi.ss.formula.FormulaParser.function(FormulaParser.java:920)\n\tat org.apache.poi.ss.formula.FormulaParser.parseNonRange(FormulaParser.java:558)\n\tat org.apache.poi.ss.formula.FormulaParser.parseRangeable(FormulaParser.java:429)\n\tat org.apache.poi.ss.formula.FormulaParser.parseRangeExpression(FormulaParser.java:268)\n\tat org.apache.poi.ss.formula.FormulaParser.parseSimpleFactor(FormulaParser.java:1119)\n\tat org.apache.poi.ss.formula.FormulaParser.percentFactor(FormulaParser.java:1079)\n\tat org.apache.poi.ss.formula.FormulaParser.powerFactor(FormulaParser.java:1066)\n\tat org.apache.poi.ss.formula.FormulaParser.Term(FormulaParser.java:1426)\n\tat org.apache.poi.ss.formula.FormulaParser.additiveExpression(FormulaParser.java:1526)\n\tat org.apache.poi.ss.formula.FormulaParser.concatExpression(FormulaParser.java:1510)\n\tat org.apache.poi.ss.formula.FormulaParser.comparisonExpression(FormulaParser.java:1467)\n\tat org.apache.poi.ss.formula.FormulaParser.unionExpression(FormulaParser.java:1447)\n\tat org.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:1568)\n\tat org.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:176)\n\tat org.apache.poi.xssf.usermodel.XSSFEvaluationWorkbook.getFormulaTokens(XSSFEvaluationWorkbook.java:148)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluateAny(WorkbookEvaluator.java:286)\n\tat org.apache.poi.ss.formula.WorkbookEvaluator.evaluate(WorkbookEvaluator.java:230)\n\tat org.apache.poi.xssf.usermodel.XSSFFormulaEvaluator.evaluateFormulaCellValue(XSSFFormulaEvaluator.java:264)\n\tat org.apache.poi.xssf.usermodel.XSSFFormulaEvaluator.evaluateFormulaCell(XSSFFormulaEvaluator.java:151)\n\tat org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluateAllFormulaCells(HSSFFormulaEvaluator.java:324)\n\tat org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluateAllFormulaCells(HSSFFormulaEvaluator.java:315)\n\tat org.apache.poi.xssf.usermodel.XSSFFormulaEvaluator.evaluateAll(XSSFFormulaEvaluator.java:252)\n\nFor anyone seeing this bug and looking for a workaround, follow the instructions at http://poi.apache.org/spreadsheet/user-defined-functions.html to implement a custom function with the name '_xlfn.SWITCH'.", "bug_id": 60924, "is_private": false, "id": 198019, "time": "2017-03-27T17:24:26Z", "creator": "barnes41@llnl.gov", "creation_time": "2017-03-27T17:24:26Z", "tags": [], "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 60924, "attachment_id": null, "is_private": false, "id": 198020, "time": "2017-03-27T18:24:01Z", "creator": "onealj@apache.org", "creation_time": "2017-03-27T18:24:01Z", "text": "Official documentation for SWITCH function: https://support.office.com/en-us/article/SWITCH-function-47ab33c0-28ce-4530-8a45-d532ec4aa25e"}, {"count": 2, "tags": [], "bug_id": 60924, "attachment_id": null, "text": "I don't have Excel 2016 to be able to create a workbook to test this. Could you upload a valid, blank Excel 2016 file with a switch function and populate any cells necessary to verify the function evaluation is correct?", "id": 198021, "time": "2017-03-27T18:27:35Z", "creator": "onealj@apache.org", "creation_time": "2017-03-27T18:27:35Z", "is_private": false}, {"count": 3, "tags": [], "creator": "barnes41@llnl.gov", "text": "Created attachment 34878\nExample of 2016 SWITCH Statement\n\nAccording to https://www.onmsft.com/news/excel-2016-gains-6-new-functions-to-simplify-formula-editing , there are 6 new formulas.\n\nHere's the Microsoft documentation for each:\n\nSWITCH - https://support.office.com/en-us/article/SWITCH-function-47ab33c0-28ce-4530-8a45-d532ec4aa25e\n\nIFS - https://support.office.com/en-US/article/IFS-function-36329a26-37b2-467c-972b-4a39bd951d45\n\nCONCAT - https://support.office.com/en-US/article/CONCAT-function-9b1a9a3f-94ff-41af-9736-694cbd6b4ca2\n\nTEXTJOIN - https://support.office.com/en-US/article/TEXTJOIN-function-357b449a-ec91-49d0-80c3-0e8fc845691c\n\nMAXIFS - https://support.office.com/en-us/article/MAXIFS-function-dfd611e6-da2c-488a-919b-9b6376b28883\n\nMINIFS - https://support.office.com/en-us/article/MINIFS-function-6ca1ddaa-079b-4e74-80cc-72eef32e6599", "id": 198022, "time": "2017-03-27T22:32:23Z", "bug_id": 60924, "creation_time": "2017-03-27T22:32:23Z", "is_private": false, "attachment_id": 34878}, {"count": 4, "tags": [], "creator": "barnes41@llnl.gov", "text": "Created attachment 34879\nExample of 2016 IFS Statement", "id": 198023, "time": "2017-03-27T22:32:58Z", "bug_id": 60924, "creation_time": "2017-03-27T22:32:58Z", "is_private": false, "attachment_id": 34879}, {"count": 5, "tags": [], "bug_id": 60924, "attachment_id": 34880, "is_private": false, "id": 198024, "time": "2017-03-27T22:33:20Z", "creator": "barnes41@llnl.gov", "creation_time": "2017-03-27T22:33:20Z", "text": "Created attachment 34880\nExample of 2016 MAXIFS Statement"}, {"count": 6, "text": "Created attachment 34881\nExample of 2016 MINIFS Statement", "creator": "barnes41@llnl.gov", "attachment_id": 34881, "id": 198025, "time": "2017-03-27T22:33:40Z", "bug_id": 60924, "creation_time": "2017-03-27T22:33:40Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "creator": "barnes41@llnl.gov", "text": "Created attachment 34882\nExample of 2016 TEXTJOIN Statement", "id": 198026, "time": "2017-03-27T22:34:05Z", "bug_id": 60924, "creation_time": "2017-03-27T22:34:05Z", "is_private": false, "attachment_id": 34882}, {"count": 8, "tags": [], "bug_id": 60924, "attachment_id": 34883, "text": "Created attachment 34883\nExample of 2016 CONCAT Statement", "id": 198027, "time": "2017-03-27T22:34:24Z", "creator": "barnes41@llnl.gov", "creation_time": "2017-03-27T22:34:24Z", "is_private": false}]