[{"count": 0, "tags": [], "creator": "tyamadajp@list.rakugaki.org", "attachment_id": null, "text": "With following configuration, I see Apache dumping random memory content to \naccess_log instead of expected \"Host:\" header content:\n\n  RequestHeader set Host \"hogehoge\"\n  LogFormat \"%{Host}i\" vhost_common\n  CustomLog /var/log/apache2/access.log vhost_common\n\nSometimes it's a \"(null)\" (glibc-way of saying you're\naccessing NULL), sometimes it's a text fragment from unknown\nmemory area.\n\nWhy would I want to manipulate \"Host:\" header anyway?\n\nI was trying to rewrite incoming Host: header in order to\nnormalize document root path set with \"VirtualDocumentRoot\".\nUltimately, I wanted to do somethig like below:\n\n  RewriteEngine On\n  RewriteCond   %{HTTP_HOST} ^www\\.(.+) [NC]\n  RewriteRule   - - [E=REALHOST:%1]\n  RequestHeader set Host \"%{REALHOST}e\" env=REALHOST\n\n  # use normalized hostname to obtain vhost docroot\n  VirtualDocumentRoot /docroot/%1/%2/htdocs\n\nYou can accomplish similar result by redirecting client to\nnormalized URL, but that would cost additional roundtrip.\n\nI know I'm doing something tricky here, so I'll report it as minor.\nAlso, after some code reviews, I gues this isn't feasible anyway\nas mod_headers hooks into fixup stage whereas mod_vhost_alias hooks\ninto translations stage. I just wish if I could hook mod_headers into\nsome stage earlier...", "id": 94105, "time": "2006-09-26T08:56:00Z", "bug_id": 40607, "creation_time": "2006-09-26T08:56:00Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 40607, "is_private": false, "text": "I additionally tested with other header and it also caused garbage\nin access_log.\n\n  RequestHeader set XHost \"hogehoge\"\n  LogFormat \"%{XHost}i\" vhost_common\n\nThis means this issue isn't only limited to certain special headers,\nbut it's that mod_headers and mod_log_config is exclusive in some ways.\nDue to this finding, I'm raising severity to \"normal\" now.\n\nAlso, I found out this does not happen with\n\n  Header set XHost \"hogehoge\"\n  LogFormat \"%{XHost}o\" vhost_common\n\nSo the issue is limited to incoming headers.\n", "id": 94106, "time": "2006-09-26T09:08:03Z", "creator": "tyamadajp@list.rakugaki.org", "creation_time": "2006-09-26T09:08:03Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 40607, "text": "I've not been able to reproduce the issue with current trunk.\nMoreover 2.0 is no more supported.\n\nBeing opened since 2006, I close it.\nFeel free to re-open if needed if still the same in 2.2 or 2.4", "id": 170424, "time": "2013-10-05T06:31:10Z", "creator": "christophe.jaillet@wanadoo.fr", "creation_time": "2013-10-05T06:31:10Z", "is_private": false, "attachment_id": null}]