[{"attachment_id": null, "tags": [], "creator": "ext-jens.riis@nokia.com", "is_private": false, "count": 0, "id": 32302, "time": "2003-03-03T09:41:24Z", "bug_id": 17582, "creation_time": "2003-03-03T09:41:24Z", "text": "The formulaparser fails when text contains no alpha characters (e.g) giving the \nargument \"(\" & F3 & \")\" throws an exception. The code in \norg.apache.poi.hssf.model.FormulaParser.StringLiteral() executes the method \nGetNameAsIs() which in turn calls isAlpha() that only allows for alphabetic \ncharacters which of course is to limited for a formula like the above."}, {"count": 1, "tags": [], "creator": "danny@muibros.com", "attachment_id": null, "id": 32408, "time": "2003-03-04T17:26:43Z", "bug_id": 17582, "creation_time": "2003-03-04T17:26:43Z", "is_private": false, "text": "Can you provide the snippet of code to duplicate this (ie a testcase)?\n\nCan you also provide the Excel use for such a formula (for people that aren't\n100% experts in Excel).\n\nThanks"}, {"count": 2, "tags": [], "creator": "ext-jens.riis@nokia.com", "attachment_id": null, "id": 32443, "time": "2003-03-05T06:54:33Z", "bug_id": 17582, "creation_time": "2003-03-05T06:54:33Z", "is_private": false, "text": "Example\n\n      String currencyCell = \"F3\";\n      HSSFWorkbook wb = new HSSFWorkbook();\n\n      HSSFSheet sheet = wb.createSheet(quote.getName());\n      HSSFRow row = sheet.createRow((short) 0);\n      HSSFCell cell = row.createCell((short) 0);\n      cell.setCellFormula(\"\\\"TOTAL[\\\" & \" + currencyCell + \" & \\\"]\\\"\");\n\nIn this case I had a request to create a spreadsheet, that in cell F3 would \ncontain a currency (by the user typing it), and several other cells would use \nthat value to display a heading e.g. typing USD in cell F3 would display \"Total \n[USD]\" in cell A1.(obviously the requirement of the square brackets could be \nrelaxed).\n"}, {"count": 3, "tags": [], "creator": "dmui@apache.org", "attachment_id": null, "id": 33277, "time": "2003-03-17T04:51:46Z", "bug_id": 17582, "creation_time": "2003-03-17T04:51:46Z", "is_private": false, "text": "Resolved in nightly build as of March 17, 2003\n\nThanks for the bug report!"}]