[{"attachment_id": 25378, "tags": [], "bug_id": 49234, "is_private": false, "count": 0, "id": 136552, "time": "2010-04-30T00:17:34Z", "creator": "chamibuddhika@gmail.com", "creation_time": "2010-04-30T00:17:34Z", "text": "Created attachment 25378\nDescriptor Modification\n\nPackage: org.apache.catalina\n\nI have slightly modified mbeans-descriptor.xml in above package as below.\n 1. Removed username and password attributes from the User mbean object since it exposes username and the password of the users.\n 2. Modified some attributes as non writeable according to the context."}, {"count": 1, "tags": [], "creator": "markt@apache.org", "is_private": false, "text": "username and password are meant to be read/write, otherwise looks good. Please update your patch and I'll apply it.", "id": 136589, "time": "2010-05-01T11:16:58Z", "bug_id": 49234, "creation_time": "2010-05-01T11:16:58Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "chamibuddhika@gmail.com", "is_private": false, "text": "Created attachment 25389\nModified patch\n\nUsername and password descriptors are included.", "id": 136598, "time": "2010-05-02T22:09:56Z", "bug_id": 49234, "creation_time": "2010-05-02T22:09:56Z", "attachment_id": 25389}, {"count": 3, "tags": [], "creator": "chamibuddhika@gmail.com", "text": "Created attachment 25390\ncatalina.connector-descriptor\n\nPackage: org.apache.catalina.connector\n\nThis patch adds some attributes missing in mbeans descriptor for CoyoteConnector mbean which are present in the underlying Connector object.\n\nIssues related to the this package\n\nSo far I have identified following issue with regards to the mbean usage in this package.\n\nCurrently mbean method invocation delegation happens as follows.\n\nConnectorMBean --> Connector \n\nNow if the connector object is not having the asked property it delegates to the corresponding ProtocolHandler implementation in order to find whether the property is present in that class. (via get/setProperty methods in Connector). \nCurrently there are two ProtocolHandler implementations as I noticed (Http11Protocol & AjpProtocol). Both these implementations are having different sets of properties. Currently CoyoteConnector mbean tries to describe both scenarios with same set of attributes. So some attributes in the descriptor doesn't make sense in one implementation or the other.\n\nThe solution for this issue, as far as I understood is to use separate mbeans for these two implementations. Any suggestions in this regards are highly appreciated.", "id": 136599, "time": "2010-05-03T02:26:58Z", "bug_id": 49234, "creation_time": "2010-05-03T02:26:58Z", "is_private": false, "attachment_id": 25390}, {"count": 4, "tags": [], "text": "Thanks for the updated patches.\n\nThe o.a.catalina patch still needs a little work. It makes more changes than it needs to. The net effect of the patch is to make Role.rolename and User.groups read-only. Only those changes should be present in the patch file. The changes that change the order of the attributes need to be removed (attributes are currently in alphabetical order and should stay that way).\n\nFor the o.a.c.connector patch, the initialized attribute was removed in r940008. As far as possible, patches should be aligned with the code at the point of submission. It is easy to drop a section of a patch so I have applied this patch less that one new attribute.\n\nIn terms of approach for handling the ProtocolHandlers, that is worth a discussion on the dev list. I suggest you write an e-mail that outlines the different options. If you think one option is better than the rest then include that in the e-mail along with why you think it is better.", "is_private": false, "id": 136639, "creator": "markt@apache.org", "time": "2010-05-05T05:06:20Z", "bug_id": 49234, "creation_time": "2010-05-05T05:06:20Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "chamibuddhika@gmail.com", "is_private": false, "text": "Created attachment 25404\no.a.Catalina-Final-patch\n\nAttribute swap reverted.", "id": 136677, "time": "2010-05-05T22:15:36Z", "bug_id": 49234, "creation_time": "2010-05-05T22:15:36Z", "attachment_id": 25404}, {"count": 6, "tags": [], "creator": "chamibuddhika@gmail.com", "text": "Created attachment 25405\no.a.Catalina.Core Descriptor Attributes\n\nPackage: org.apache.Catalina.Core\n\nThis patch deals with attributes of above package descriptor. Changes are mainly\n\n 1. Addition of missing attributes\n 2. Ordering of attributes according to their alphabetical order\n\nRequired changes (if any) to descriptor operations will be attached in a separate patch.", "id": 136679, "time": "2010-05-06T04:25:25Z", "bug_id": 49234, "creation_time": "2010-05-06T04:25:25Z", "is_private": false, "attachment_id": 25405}, {"count": 7, "tags": [], "creator": "markt@apache.org", "text": "(In reply to comment #5)\n> Created an attachment (id=25404) [details]\n> o.a.Catalina-Final-patch\n\nThere are still a lot of unnecessary white-space changes in that patch. I have applied the patch, less the whitespace changes.", "id": 136683, "time": "2010-05-06T07:58:47Z", "bug_id": 49234, "creation_time": "2010-05-06T07:58:47Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 49234, "text": "(In reply to comment #6)\n> Created an attachment (id=25405) [details]\n> o.a.Catalina.Core Descriptor Attributes\n\nPatch applied. Many thanks.\n\nFor future reference:\n- The description needs to be on a single line. Line breaks look odd in JConsole.\n- Try and keep the alignment consistent throughout the file", "count": 8, "id": 136684, "time": "2010-05-06T08:14:47Z", "creator": "markt@apache.org", "creation_time": "2010-05-06T08:14:47Z", "is_private": false}, {"attachment_id": 25443, "tags": [], "bug_id": 49234, "is_private": false, "count": 9, "id": 136890, "time": "2010-05-15T22:33:46Z", "creator": "chamibuddhika@gmail.com", "creation_time": "2010-05-15T22:33:46Z", "text": "Created attachment 25443\no.a.Catalina.Connector Second Patch\n\nThis new patch on connector descriptor extracts out common attributes of related ProtocolHandler instances. Common attributes are marked with inline comments."}, {"count": 10, "text": "It seems that o.a.Catalina.Core descriptor has got operations containing POJO objects instead of primitive types which make them inaccessible via JConsole. Was this intended or does any one have suggestions for handling POJO object parameters in mbean descriptors in general?", "creator": "chamibuddhika@gmail.com", "is_private": false, "id": 136891, "time": "2010-05-15T23:21:44Z", "bug_id": 49234, "creation_time": "2010-05-15T23:21:44Z", "tags": [], "attachment_id": null}, {"count": 11, "tags": [], "creator": "chamibuddhika@gmail.com", "is_private": false, "text": "Created attachment 25444\no.a.Catalina.Deploy Patch\n\nPatch for o.a.Catalina.Deploy package. Adds getter and setter support for the properties of ContextResourceLink additionally.", "id": 136892, "time": "2010-05-15T23:28:41Z", "bug_id": 49234, "creation_time": "2010-05-15T23:28:41Z", "attachment_id": 25444}, {"count": 12, "tags": [], "text": "In o.a.Catalina.Deploy descriptor for NamingResources the associated MBean (NamingResourceMBean) only exposes add/remove methods for following properties.\n\n    - Environment\n    - Resource\n    - ResourceLink\n\nIn the NamingResource object following additional properties are present which have corresponding add/remove methods.\n\n    - EJB\n    - LocalEJB\n    - MessageDestinationRef\n    - PropertyChangeListener\n    - ResourceEnvRef\n    - Service\n\nI am not sure about the applicability of these additional properties in the context of remote administrative purposes. Any idea on this matter is appreciated.", "is_private": false, "id": 136893, "creator": "chamibuddhika@gmail.com", "time": "2010-05-15T23:45:37Z", "bug_id": 49234, "creation_time": "2010-05-15T23:45:37Z", "attachment_id": null}, {"count": 13, "tags": [], "creator": "markt@apache.org", "text": "(In reply to comment #10)\n> It seems that o.a.Catalina.Core descriptor has got operations containing POJO\n> objects instead of primitive types which make them inaccessible via JConsole.\n> Was this intended or does any one have suggestions for handling POJO object\n> parameters in mbean descriptors in general?\n\nI don't think there is a one size fits all solution to this. Options include:\n- provide a reference to the associated MBean\n- add MBean support to the object and then add a reference\n- remove them from the descriptor\n- provide methods that use primitives to achieve the same ends\n- something else\n\nYou may want to ask for feedback on the dev list before you start making too many changes for this.", "id": 136962, "time": "2010-05-19T12:25:07Z", "bug_id": 49234, "creation_time": "2010-05-19T12:25:07Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 49234, "text": "(In reply to comment #12)\n>     - EJB\n>     - LocalEJB\n>     - MessageDestinationRef\n>     - PropertyChangeListener\n>     - ResourceEnvRef\n>     - Service\nI wouldn't worry about these for now although exposing getContainer() could be useful.", "count": 14, "id": 136963, "time": "2010-05-19T12:41:06Z", "creator": "markt@apache.org", "creation_time": "2010-05-19T12:41:06Z", "is_private": false}, {"count": 15, "tags": [], "bug_id": 49234, "attachment_id": 25471, "is_private": false, "id": 137041, "time": "2010-05-23T00:20:48Z", "creator": "chamibuddhika@gmail.com", "creation_time": "2010-05-23T00:20:48Z", "text": "Created attachment 25471\no.a.Catalina.Deploy Second Patch\n\nAdds getContainer() method"}, {"count": 16, "tags": [], "creator": "chamibuddhika@gmail.com", "text": "Created attachment 25473\no.a.Catalina.ha Patch\n\nThis patch adds to o.a.Catalina.ha descriptor. In this descriptor I found that it references to a class org.apache.catalina.ha.tcp.SimpleTcpReplicationManager which I cannot seem to find in the code base. Probably the class has been removed. In a future patch this reference can be removed if necessary.", "id": 137044, "time": "2010-05-23T01:21:31Z", "bug_id": 49234, "creation_time": "2010-05-23T01:21:31Z", "is_private": false, "attachment_id": 25473}, {"count": 17, "text": "Package : o.a.Catalina.ha.authenticator\n\nThis package descriptor references to a non existant class org.apache.catalina.cluster.authenticator.ClusterSingleSignOn.", "creator": "chamibuddhika@gmail.com", "is_private": false, "id": 137045, "time": "2010-05-23T01:23:22Z", "bug_id": 49234, "creation_time": "2010-05-23T01:23:22Z", "tags": [], "attachment_id": null}, {"count": 18, "tags": [], "bug_id": 49234, "attachment_id": 25474, "is_private": false, "id": 137046, "time": "2010-05-23T01:38:44Z", "creator": "chamibuddhika@gmail.com", "creation_time": "2010-05-23T01:38:44Z", "text": "Created attachment 25474\no.a.Catalina.ha.deploy Patch\n\nAdds missing attributes to FarmWarDeployer."}, {"count": 19, "tags": [], "creator": "markt@apache.org", "text": "comment #15 - Patch applied\n            - Doesn't add much since container is unavailable\n            - More fuel for the separate MBean vs adding methods that return the\n              oname debate\n\ncomment #16 - Patch applied\n            - SimpleTcpReplicationManager is in o.a.c.ha.session package\n            - Looks like a duplicate. I'm fine with removal.\n\ncomment #17 - Huh? That class in in that package. Please re-check.\n\ncomment #18 - Applied", "id": 137127, "time": "2010-05-25T19:45:16Z", "bug_id": 49234, "creation_time": "2010-05-25T19:45:16Z", "is_private": false, "attachment_id": null}, {"attachment_id": 25516, "tags": [], "bug_id": 49234, "is_private": false, "count": 20, "id": 137311, "time": "2010-06-03T08:49:21Z", "creator": "chamibuddhika@gmail.com", "creation_time": "2010-06-03T08:49:21Z", "text": "Created attachment 25516\no.a.Catalina.ha.session Patch\n\nAdds missing attributes and reorders the existing attributes."}, {"attachment_id": 25517, "tags": [], "bug_id": 49234, "text": "Created attachment 25517\no.a.Catalina.ha.tcp Patch\n\nI found references to some classes I cannot seem to find in the code base? Am I missing some thing here? Classes are\n\n - ClusterReceiverBase\n - SocketReplicatonListener\n - AsyncSocketSender\n - FastAsyncSocketSender\n - PooledSocketSender\n - SocketSender", "count": 21, "id": 137312, "time": "2010-06-03T08:52:31Z", "creator": "chamibuddhika@gmail.com", "creation_time": "2010-06-03T08:52:31Z", "is_private": false}, {"attachment_id": 25518, "tags": [], "bug_id": 49234, "is_private": false, "count": 22, "id": 137313, "time": "2010-06-03T08:54:14Z", "creator": "chamibuddhika@gmail.com", "creation_time": "2010-06-03T08:54:14Z", "text": "Created attachment 25518\no.a.Catalina.loader Patch\n\nAdds missing attributes/operations and reorders existing attributes."}, {"count": 23, "tags": [], "creator": "rainer.jung@kippdata.de", "text": "(In reply to comment #21)\n> I found references to some classes I cannot seem to find in the code base? Am I\n> missing some thing here? Classes are\n> \n>  - ClusterReceiverBase\n>  - SocketReplicatonListener\n>  - AsyncSocketSender\n>  - FastAsyncSocketSender\n>  - PooledSocketSender\n>  - SocketSender\n\nAt least some of them were part of Tomcat 5.5 \u00b4cluster and have been dropped when the new Tomcat 6 cluster was written.", "id": 137315, "time": "2010-06-03T09:52:52Z", "bug_id": 49234, "creation_time": "2010-06-03T09:52:52Z", "is_private": false, "attachment_id": null}, {"count": 24, "tags": [], "creator": "chamibuddhika@gmail.com", "text": "(In reply to comment #23)\n\n> At least some of them were part of Tomcat 5.5 \u00b4cluster and have been dropped\n> when the new Tomcat 6 cluster was written.\n\nSo their corresponding descriptors can be safely removed?", "id": 137464, "time": "2010-06-09T00:10:04Z", "bug_id": 49234, "creation_time": "2010-06-09T00:10:04Z", "is_private": false, "attachment_id": null}, {"count": 25, "tags": [], "bug_id": 49234, "text": "(In reply to comment #24)\n> (In reply to comment #23)\n> \n> > At least some of them were part of Tomcat 5.5 \u00b4cluster and have been dropped\n> > when the new Tomcat 6 cluster was written.\n> \n> So their corresponding descriptors can be safely removed?\n\nYes, but first check\n\n- that those classes exist in the old tc 5.5 cluster (under tc5.5.x/trunk/container/modules the directories are cluster, ha, groupcom) . If they are not there, we missed something.\n\n- and that they are no longer present in any cluster related package in TC 7 (which is easy, because since Tomcat 6 all Java classes are in the same directory tree).\n\nRegards,\n\nRainer", "id": 137466, "attachment_id": null, "creator": "rainer.jung@kippdata.de", "creation_time": "2010-06-09T03:44:29Z", "time": "2010-06-09T03:44:29Z", "is_private": false}, {"count": 26, "tags": [], "bug_id": 49234, "attachment_id": 25555, "is_private": false, "id": 137469, "time": "2010-06-09T05:02:32Z", "creator": "chamibuddhika@gmail.com", "creation_time": "2010-06-09T05:02:32Z", "text": "Created attachment 25555\no.a.Catalina.Mbeans Patch\n\nAdds missing methods."}, {"count": 27, "tags": [], "text": "Created attachment 25556\no.a.Catalina.Realm Patch\n\nUserDatabaseRealm and LockoutRealm contains a method with POJO parameters. \naddRealm(org.apache.catalina.Realm)\nI think an overload having a String would do the trick since there is only one method to be taken care of. So a seperate MBean resource is not necessary. \nThe patch adds missing attributes and methods and does some reordering of attributes as well.", "is_private": false, "id": 137470, "creator": "chamibuddhika@gmail.com", "time": "2010-06-09T05:45:12Z", "bug_id": 49234, "creation_time": "2010-06-09T05:45:12Z", "attachment_id": 25556}, {"count": 28, "tags": [], "creator": "chamibuddhika@gmail.com", "text": "Created attachment 25562\no.a.Catalina.session Patch\n\nAdds missing attributes/methods and reorders them.", "id": 137478, "time": "2010-06-09T06:08:17Z", "bug_id": 49234, "creation_time": "2010-06-09T06:08:17Z", "is_private": false, "attachment_id": 25562}, {"count": 29, "tags": [], "creator": "chamibuddhika@gmail.com", "text": "Created attachment 25563\no.a.Catalina.Startup Patch\n\nAdds missing attributes.", "id": 137479, "time": "2010-06-09T06:10:02Z", "bug_id": 49234, "creation_time": "2010-06-09T06:10:02Z", "is_private": false, "attachment_id": 25563}, {"count": 30, "tags": [], "bug_id": 49234, "text": "(In reply to comment #29)\n> Created an attachment (id=25563) [details]\n> o.a.Catalina.Startup Patch\n> \n> Adds missing attributes.\n\nIn here also there is a operation having POJO parameters which can be overloaded. Will supply this in a future patch if this is acceptable.", "id": 137481, "attachment_id": null, "creator": "chamibuddhika@gmail.com", "creation_time": "2010-06-09T06:12:03Z", "time": "2010-06-09T06:12:03Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 49234, "is_private": false, "count": 31, "id": 137482, "time": "2010-06-09T06:20:02Z", "creator": "chamibuddhika@gmail.com", "creation_time": "2010-06-09T06:20:02Z", "text": "o.a.Catalina.tribes package descriptor has got mbeans which are present in other several packages as well. They are\n\nSimpleTcpCluster \n Present in following package descriptors\n       - o.a.Catalina.ha.tcp\n       - o.a.Catalina.ha\n       - o.a.Catalina.tribes\n       - o.a.Catalina.tribes.transport\n \nReplicationValve\n Present in above 4 packages as SimpleTcpCluster\n\nSimpleTcpReplicationManager\n Present in following package descriptors\n       - o.a.Catalina.ha.session\n       - o.a.Catalina.tribes\n\nThese mbeans are present in packages with some differences in attributes and operations. The other difference is being that they are in different groups. Any suggestions for proceeding with this scenario? I am guessing this replication may have been intended? Anyway they can be made consistent across packages with respect to their attributes and methods."}, {"count": 32, "tags": [], "bug_id": 49234, "text": "Created attachment 25564\no.a.Catalina.tribes.membership Patch\n\nRemove mbean descriptor methods using deprecated methods and adds new ones.", "id": 137483, "attachment_id": 25564, "creator": "chamibuddhika@gmail.com", "creation_time": "2010-06-09T06:25:46Z", "time": "2010-06-09T06:25:46Z", "is_private": false}, {"count": 33, "tags": [], "bug_id": 49234, "text": "comment #20 - Patch applied\ncomment #21 - Patch *NOT* applied\n              resetStatistics() operation has been removed yet it exists. Why?\ncomment #26 - Patch applied\ncomment #27 - Patch applied - I'm fine with an overloaded method\ncomment #28 - Patch applied\ncomment #29 - Patch applied - I'm fine with an overloaded method\ncomment #31 - Probably duplicates that need to be cleaned up\ncomment #32 - Patch *NOT* applied\n              Patch does not handle nulls correctly\n\nThe applied patches will be in Tomcat 7.0.1 onwards.", "id": 137605, "attachment_id": null, "creator": "markt@apache.org", "creation_time": "2010-06-13T17:28:29Z", "time": "2010-06-13T17:28:29Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 49234, "is_private": false, "count": 34, "id": 137788, "time": "2010-06-21T19:12:50Z", "creator": "markt@apache.org", "creation_time": "2010-06-21T19:12:50Z", "text": "Ping. No update/progress in over a week. I'm starting to get concerned."}, {"count": 35, "tags": [], "creator": "chamibuddhika@gmail.com", "text": "(In reply to comment #34)\n> Ping. No update/progress in over a week. I'm starting to get concerned.\n\nSorry I was extremely busy last 1 and half weeks with my university work. (Finalization of the final year project). So couldn't attend much to Tomcat related work. It will be over in another couple of days and I hope to speed-up my work after that. Sorry for the inconvenience.", "id": 137793, "time": "2010-06-22T00:00:20Z", "bug_id": 49234, "creation_time": "2010-06-22T00:00:20Z", "is_private": false, "attachment_id": null}, {"count": 36, "tags": [], "bug_id": 49234, "text": "Created attachment 25634\no.a.Catalina.ha Modified Patch\n\nAdds missed incorrectly out resetStatistics() function in earlier patch.", "id": 137861, "attachment_id": 25634, "creator": "chamibuddhika@gmail.com", "creation_time": "2010-06-23T22:06:33Z", "time": "2010-06-23T22:06:33Z", "is_private": false}, {"attachment_id": 25635, "tags": [], "bug_id": 49234, "text": "Created attachment 25635\no.a.Catalina.tribes.membership Modified Patch\n\nAdds correct handling of nulls missing in the previous patch.", "count": 37, "id": 137862, "time": "2010-06-23T22:32:46Z", "creator": "chamibuddhika@gmail.com", "creation_time": "2010-06-23T22:32:46Z", "is_private": false}, {"count": 38, "tags": [], "creator": "chamibuddhika@gmail.com", "is_private": false, "text": "(In reply to comment #31)\n> o.a.Catalina.tribes package descriptor has got mbeans which are present in\n> other several packages as well. They are\n> \n> SimpleTcpCluster \n>  Present in following package descriptors\n>        - o.a.Catalina.ha.tcp\n>        - o.a.Catalina.ha\n>        - o.a.Catalina.tribes\n>        - o.a.Catalina.tribes.transport\n> \n> ReplicationValve\n>  Present in above 4 packages as SimpleTcpCluster\n> \n> SimpleTcpReplicationManager\n>  Present in following package descriptors\n>        - o.a.Catalina.ha.session\n>        - o.a.Catalina.tribes\n> \n> These mbeans are present in packages with some differences in attributes and\n> operations. The other difference is being that they are in different groups.\n> Any suggestions for proceeding with this scenario? I am guessing this\n> replication may have been intended? Anyway they can be made consistent across\n> packages with respect to their attributes and methods.\n\nAny suggestions for the localization of these descriptors? I am planning to localize all of these class descriptors to o.a.Catalina.tribes mbeans descriptor.", "id": 137883, "time": "2010-06-25T06:36:26Z", "bug_id": 49234, "creation_time": "2010-06-25T06:36:26Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 49234, "text": "(In reply to comment #38)\n> (In reply to comment #31)\n> > o.a.Catalina.tribes package descriptor has got mbeans which are present in\n> > other several packages as well. They are\n> > \n> > SimpleTcpCluster \n> >  Present in following package descriptors\n> >        - o.a.Catalina.ha.tcp\n> >        - o.a.Catalina.ha\n> >        - o.a.Catalina.tribes\n> >        - o.a.Catalina.tribes.transport\n> > \n> > ReplicationValve\n> >  Present in above 4 packages as SimpleTcpCluster\n> > \n> > SimpleTcpReplicationManager\n> >  Present in following package descriptors\n> >        - o.a.Catalina.ha.session\n> >        - o.a.Catalina.tribes\n> > \n> > These mbeans are present in packages with some differences in attributes and\n> > operations. The other difference is being that they are in different groups.\n> > Any suggestions for proceeding with this scenario? I am guessing this\n> > replication may have been intended? Anyway they can be made consistent across\n> > packages with respect to their attributes and methods.\n> \n> Any suggestions for the localization of these descriptors? I am planning to\n> localize all of these class descriptors to o.a.Catalina.tribes mbeans\n> descriptor.\n\nI have localized them in to the o.a.Catalina.tribes package descriptor. Will be committing the changes soon.", "count": 39, "id": 137884, "time": "2010-06-25T06:55:48Z", "creator": "chamibuddhika@gmail.com", "creation_time": "2010-06-25T06:55:48Z", "is_private": false}, {"count": 40, "tags": [], "text": "(In reply to comment #25)\n> (In reply to comment #24)\n> > (In reply to comment #23)\n> > \n> > > At least some of them were part of Tomcat 5.5 \u00b4cluster and have been dropped\n> > > when the new Tomcat 6 cluster was written.\n> > \n> > So their corresponding descriptors can be safely removed?\n> \n> Yes, but first check\n> \n> - that those classes exist in the old tc 5.5 cluster (under\n> tc5.5.x/trunk/container/modules the directories are cluster, ha, groupcom) . If\n> they are not there, we missed something.\n> \n> - and that they are no longer present in any cluster related package in TC 7\n> (which is easy, because since Tomcat 6 all Java classes are in the same\n> directory tree).\n> \n> Regards,\n> \n> Rainer\n\nI couldn't find the mentioned classes in Tomcat 5.5 and nor they are present in the trunk.", "is_private": false, "id": 137885, "creator": "chamibuddhika@gmail.com", "time": "2010-06-25T07:09:20Z", "bug_id": 49234, "creation_time": "2010-06-25T07:09:20Z", "attachment_id": null}, {"count": 41, "tags": [], "bug_id": 49234, "attachment_id": null, "is_private": false, "id": 137886, "time": "2010-06-25T07:16:23Z", "creator": "chamibuddhika@gmail.com", "creation_time": "2010-06-25T07:16:23Z", "text": "(In reply to comment #40)\n> (In reply to comment #25)\n> > (In reply to comment #24)\n> > > (In reply to comment #23)\n> > > \n> > > > At least some of them were part of Tomcat 5.5 \u00b4cluster and have been dropped\n> > > > when the new Tomcat 6 cluster was written.\n> > > \n> > > So their corresponding descriptors can be safely removed?\n> > \n> > Yes, but first check\n> > \n> > - that those classes exist in the old tc 5.5 cluster (under\n> > tc5.5.x/trunk/container/modules the directories are cluster, ha, groupcom) . If\n> > they are not there, we missed something.\n> > \n> > - and that they are no longer present in any cluster related package in TC 7\n> > (which is easy, because since Tomcat 6 all Java classes are in the same\n> > directory tree).\n> > \n> > Regards,\n> > \n> > Rainer\n> \n> I couldn't find the mentioned classes in Tomcat 5.5 and nor they are present in\n> the trunk.\n\nI found some of the classes in TC5.0. Namely \n>  - PooledSocketSender\n>  - SocketSender\n>  - AsyncSocketSender\n>  - ReplicationTransmitter\n\nSome of the other classes are missing in TC5.0 as well.\n>  - ClusterReceiverBase\n>  - SocketReplicatonListener\n>  - FastAsyncSocketSender"}, {"count": 42, "tags": [], "bug_id": 49234, "attachment_id": null, "is_private": false, "id": 137887, "time": "2010-06-25T07:22:19Z", "creator": "chamibuddhika@gmail.com", "creation_time": "2010-06-25T07:22:19Z", "text": "(In reply to comment #41)\n> (In reply to comment #40)\n> > (In reply to comment #25)\n> > > (In reply to comment #24)\n> > > > (In reply to comment #23)\n> > > > \n> > > > > At least some of them were part of Tomcat 5.5 \u00b4cluster and have been dropped\n> > > > > when the new Tomcat 6 cluster was written.\n> > > > \n> > > > So their corresponding descriptors can be safely removed?\n> > > \n> > > Yes, but first check\n> > > \n> > > - that those classes exist in the old tc 5.5 cluster (under\n> > > tc5.5.x/trunk/container/modules the directories are cluster, ha, groupcom) . If\n> > > they are not there, we missed something.\n> > > \n> > > - and that they are no longer present in any cluster related package in TC 7\n> > > (which is easy, because since Tomcat 6 all Java classes are in the same\n> > > directory tree).\n> > > \n> > > Regards,\n> > > \n> > > Rainer\n> > \n> > I couldn't find the mentioned classes in Tomcat 5.5 and nor they are present in\n> > the trunk.\n> \n> I found some of the classes in TC5.0. Namely \n> >  - PooledSocketSender\n> >  - SocketSender\n> >  - AsyncSocketSender\n> >  - ReplicationTransmitter\n> \n> Some of the other classes are missing in TC5.0 as well.\n> >  - ClusterReceiverBase\n> >  - SocketReplicatonListener\n> >  - FastAsyncSocketSender\n\nSo I will be removing the descriptors of these classes in respective packages."}, {"count": 43, "tags": [], "creator": "rainer.jung@kippdata.de", "text": "(In reply to comment #40)\n> (In reply to comment #25)\n> > (In reply to comment #24)\n> > > (In reply to comment #23)\n> > > \n> > > > At least some of them were part of Tomcat 5.5 \u00b4cluster and have been dropped\n> > > > when the new Tomcat 6 cluster was written.\n> > > \n> > > So their corresponding descriptors can be safely removed?\n> > \n> > Yes, but first check\n> > \n> > - that those classes exist in the old tc 5.5 cluster (under\n> > tc5.5.x/trunk/container/modules the directories are cluster, ha, groupcom) . If\n> > they are not there, we missed something.\n> > \n> > - and that they are no longer present in any cluster related package in TC 7\n> > (which is easy, because since Tomcat 6 all Java classes are in the same\n> > directory tree).\n> > \n> > Regards,\n> > \n> > Rainer\n> \n> I couldn't find the mentioned classes in Tomcat 5.5 and nor they are present in\n> the trunk.\n\nMenioned classes were.\n\n - ClusterReceiverBase\n - SocketReplicatonListener\n - AsyncSocketSender\n - FastAsyncSocketSender\n - PooledSocketSender\n - SocketSender\n\nIn tc5.5.x/trunk/container/modules/cluster/src/share/org/apache/catalina/cluster/tcp you will find all of them. Curious how you missed them.", "id": 137888, "time": "2010-06-25T07:29:52Z", "bug_id": 49234, "creation_time": "2010-06-25T07:29:52Z", "is_private": false, "attachment_id": null}, {"count": 44, "tags": [], "bug_id": 49234, "text": "(In reply to comment #43)\n> (In reply to comment #40)\n> > (In reply to comment #25)\n> > > (In reply to comment #24)\n> > > > (In reply to comment #23)\n> > > > \n> > > > > At least some of them were part of Tomcat 5.5 \u00b4cluster and have been dropped\n> > > > > when the new Tomcat 6 cluster was written.\n> > > > \n> > > > So their corresponding descriptors can be safely removed?\n> > > \n> > > Yes, but first check\n> > > \n> > > - that those classes exist in the old tc 5.5 cluster (under\n> > > tc5.5.x/trunk/container/modules the directories are cluster, ha, groupcom) . If\n> > > they are not there, we missed something.\n> > > \n> > > - and that they are no longer present in any cluster related package in TC 7\n> > > (which is easy, because since Tomcat 6 all Java classes are in the same\n> > > directory tree).\n> > > \n> > > Regards,\n> > > \n> > > Rainer\n> > \n> > I couldn't find the mentioned classes in Tomcat 5.5 and nor they are present in\n> > the trunk.\n> \n> Menioned classes were.\n> \n>  - ClusterReceiverBase\n>  - SocketReplicatonListener\n>  - AsyncSocketSender\n>  - FastAsyncSocketSender\n>  - PooledSocketSender\n>  - SocketSender\n> \n> In\n> tc5.5.x/trunk/container/modules/cluster/src/share/org/apache/catalina/cluster/tcp\n> you will find all of them. Curious how you missed them.\n\nSeems I somehow overlooked this package. Sorry for false alarm. Anyway since these are not present in the trunk I will be removing them. \n\nRegards,", "id": 137891, "attachment_id": null, "creator": "chamibuddhika@gmail.com", "creation_time": "2010-06-25T08:10:29Z", "time": "2010-06-25T08:10:29Z", "is_private": false}, {"count": 45, "tags": [], "bug_id": 49234, "text": "Created attachment 25637\no.a.Catalina.ha Modified Patch\n\nRemoves references to old TC cluster classes which are non existent in the trunk. Now the descriptor is empty. Can possibly be removed.", "id": 137892, "attachment_id": 25637, "creator": "chamibuddhika@gmail.com", "creation_time": "2010-06-25T08:11:37Z", "time": "2010-06-25T08:11:37Z", "is_private": false}, {"count": 46, "tags": [], "text": "Created attachment 25638\no.a.Catalina.ha.session Modified Patch\n\nRemoves SimpleTcpReplicationManager which has been moved to o.a.Catalina.tribes package descriptor.", "is_private": false, "id": 137893, "creator": "chamibuddhika@gmail.com", "time": "2010-06-25T08:14:50Z", "bug_id": 49234, "creation_time": "2010-06-25T08:14:50Z", "attachment_id": 25638}, {"attachment_id": 25639, "tags": [], "bug_id": 49234, "text": "Created attachment 25639\no.a.Catalina.ha.tcp Patch\n\nRemoves old TC5.5 cluster classes. Now the descriptor is empty. Can possibly be removed.", "count": 47, "id": 137894, "time": "2010-06-25T08:16:27Z", "creator": "chamibuddhika@gmail.com", "creation_time": "2010-06-25T08:16:27Z", "is_private": false}, {"count": 48, "tags": [], "text": "Created attachment 25640\no.a.Catalina.tribes Patch\n\nNow descriptors for classes SimpleTcpCluster, ReplicationValve and SimpleTcpReplicationManager have been localized to this package descriptor.", "is_private": false, "id": 137895, "creator": "chamibuddhika@gmail.com", "time": "2010-06-25T08:18:55Z", "bug_id": 49234, "creation_time": "2010-06-25T08:18:55Z", "attachment_id": 25640}, {"count": 49, "tags": [], "text": "Created attachment 25641\no.a.Catalina.tribes.transport Patch\n\nRemoves duplicated descriptors from this package. (Moved to o.a.Catalina.tribes descriptor). Now the descriptor is empty. Can possibly be removed.", "is_private": false, "id": 137896, "creator": "chamibuddhika@gmail.com", "time": "2010-06-25T08:20:48Z", "bug_id": 49234, "creation_time": "2010-06-25T08:20:48Z", "attachment_id": 25641}, {"count": 50, "tags": [], "creator": "chamibuddhika@gmail.com", "text": "Where can I find the class JDBCUserDatabase? It is not in the package org.apache.catalina.users as mentioned in org.apache.catalina.users descriptor.", "id": 137920, "time": "2010-06-26T02:21:59Z", "bug_id": 49234, "creation_time": "2010-06-26T02:21:59Z", "is_private": false, "attachment_id": null}, {"count": 51, "text": "I cannot seem to find classes FastCommonAccessLogValve, RequestDamperValve and RequestListenerValve described in o.a.Catalina.Valves. Have they been removed from the code base? Will it be possible to remove their descriptors?", "creator": "chamibuddhika@gmail.com", "is_private": false, "id": 137929, "time": "2010-06-27T07:38:53Z", "bug_id": 49234, "creation_time": "2010-06-27T07:38:53Z", "tags": [], "attachment_id": null}, {"count": 52, "tags": [], "bug_id": 49234, "text": "(In reply to comment #51)\n> I cannot seem to find classes FastCommonAccessLogValve, RequestDamperValve and\n> RequestListenerValve described in o.a.Catalina.Valves. Have they been removed\n> from the code base? Will it be possible to remove their descriptors?\n\nSee:\n\nhttp://svn.apache.org/viewvc?view=revision&revision=769347\n\nhttp://svn.apache.org/viewvc?view=revision&revision=805375\n\nhttp://svn.apache.org/viewvc?view=revision&revision=302036\n\nRegards,\n\nRainer", "id": 137932, "attachment_id": null, "creator": "rainer.jung@kippdata.de", "creation_time": "2010-06-27T13:15:50Z", "time": "2010-06-27T13:15:50Z", "is_private": false}, {"count": 53, "tags": [], "bug_id": 49234, "attachment_id": null, "is_private": false, "id": 138095, "time": "2010-07-02T14:28:42Z", "creator": "markt@apache.org", "creation_time": "2010-07-02T14:28:42Z", "text": "comment #36 - Patch applied\ncomment #37 - Patch applied\ncomment #45 - Patch applied\n\ncomment #46 - Patch NOT applied\ncomment #47 - Patch NOT applied\ncomment #48 - Patch NOT applied\ncomment #49 - Patch NOT applied\n\nNone of the last four patches were applied since they appear to define MBeans in different packages to where class. The simple rule is that the descriptor for a package should include descriptions for classes in that package and that package only.\n\nMaintenance will be a nightmare if the descriptor is in a different package."}, {"count": 54, "tags": [], "bug_id": 49234, "text": "Created attachment 25716\no.a.Catalina.ha.session Modified Patch\n\nIncludes SimpleTCPReplicationManager to this package descriptor. Earlier was in o.a.catalina.tribes descriptor. Adds missing attributes and methods to it.", "id": 138220, "attachment_id": 25716, "creator": "chamibuddhika@gmail.com", "creation_time": "2010-07-06T12:51:09Z", "time": "2010-07-06T12:51:09Z", "is_private": false}, {"count": 55, "tags": [], "creator": "chamibuddhika@gmail.com", "text": "Created attachment 25717\no.a.Catalina.ha.tcp Modified Patch\n\nMoves SimpleTcpCluster and ReplicationValve from o.a.Catalina.tribes descriptor to this descriptor.", "id": 138221, "time": "2010-07-06T12:58:25Z", "bug_id": 49234, "creation_time": "2010-07-06T12:58:25Z", "is_private": false, "attachment_id": 25717}, {"count": 56, "tags": [], "bug_id": 49234, "attachment_id": 25719, "is_private": false, "id": 138224, "time": "2010-07-06T13:05:22Z", "creator": "chamibuddhika@gmail.com", "creation_time": "2010-07-06T13:05:22Z", "text": "Created attachment 25719\no.a.Catalina.tribes Modified Patch\n\nRemoves SimpleTcpReplicationManager, SimpleTcpCluster and ReplicationValve from this package descriptor since the classes themselves are not belonging to this package. Now the descriptor is empty. Possible to be removed."}, {"count": 57, "tags": [], "creator": "chamibuddhika@gmail.com", "text": "Created attachment 25720\no.a.Catalina.tribes.transport Modified Patch\n\nNow the descriptor is empty. Possible to be removed.", "id": 138225, "time": "2010-07-06T13:11:26Z", "bug_id": 49234, "creation_time": "2010-07-06T13:11:26Z", "is_private": false, "attachment_id": 25720}, {"count": 58, "tags": [], "text": "Created attachment 25733\no.a.Catalina.users Patch\n\nRemoves non existent class descriptors.", "is_private": false, "id": 138273, "creator": "chamibuddhika@gmail.com", "time": "2010-07-08T07:05:50Z", "bug_id": 49234, "creation_time": "2010-07-08T07:05:50Z", "attachment_id": 25733}, {"count": 59, "tags": [], "bug_id": 49234, "text": "Created attachment 25734\no.a.Catalina.valves Patch\n\nRemoves non existent class descriptors and adds missing attributes.", "id": 138274, "attachment_id": 25734, "creator": "chamibuddhika@gmail.com", "creation_time": "2010-07-08T07:09:03Z", "time": "2010-07-08T07:09:03Z", "is_private": false}, {"count": 60, "tags": [], "creator": "markt@apache.org", "text": "All patches applied. Many thanks.", "id": 138287, "time": "2010-07-08T17:56:28Z", "bug_id": 49234, "creation_time": "2010-07-08T17:56:28Z", "is_private": false, "attachment_id": null}, {"count": 61, "tags": [], "creator": "markt@apache.org", "text": "Ping. No update/progress in over a week. Again.\n\nOverall I am beginning to have serious concerns about the rate of progress of this project.", "id": 138443, "time": "2010-07-15T16:52:12Z", "bug_id": 49234, "creation_time": "2010-07-15T16:52:12Z", "is_private": false, "attachment_id": null}, {"count": 62, "tags": [], "creator": "chamibuddhika@gmail.com", "text": "(In reply to comment #61)\n> Ping. No update/progress in over a week. Again.\n> \n> Overall I am beginning to have serious concerns about the rate of progress of\n> this project.\n\nSorry. It seems the I have gone through all the mbean-descriptors in the tomcat packages as of now in the first round. Now I am evaluating what I have missed in the first round. There are some work left in several packages which I have been working on lately. Will provide a patch soon. e.g.: o.a.Catalina.Core POJO operations.Apart from those I guess descriptor related work should be pretty much done. Are there any specific other JMX related improvements that you have in mind?", "id": 138447, "time": "2010-07-15T21:45:46Z", "bug_id": 49234, "creation_time": "2010-07-15T21:45:46Z", "is_private": false, "attachment_id": null}, {"count": 63, "tags": [], "bug_id": 49234, "text": "(In reply to comment #10)\n> It seems that o.a.Catalina.Core descriptor has got operations containing POJO\n> objects instead of primitive types which make them inaccessible via JConsole.\n> Was this intended or does any one have suggestions for handling POJO object\n> parameters in mbean descriptors in general?\n\nFor this I was considering to use a separate MBean whose methods would take an oname of the respective component as a string. But it seems currently there is no facility (in the Registry) to obtain the associated resource object given the oname of a component. Alternatively it is possible to create a component from a scratch within the mbean method in add methods. But remove methods still requires obtaining the resource from the corresponding oname. Am I missing some thing here?", "id": 138457, "attachment_id": null, "creator": "chamibuddhika@gmail.com", "creation_time": "2010-07-16T06:58:14Z", "time": "2010-07-16T06:58:14Z", "is_private": false}, {"count": 64, "tags": [], "bug_id": 49234, "attachment_id": null, "is_private": false, "id": 138515, "time": "2010-07-19T10:25:49Z", "creator": "chamibuddhika@gmail.com", "creation_time": "2010-07-19T10:25:49Z", "text": "(In reply to comment #63)\n> (In reply to comment #10)\n> > It seems that o.a.Catalina.Core descriptor has got operations containing POJO\n> > objects instead of primitive types which make them inaccessible via JConsole.\n> > Was this intended or does any one have suggestions for handling POJO object\n> > parameters in mbean descriptors in general?\n> \n> For this I was considering to use a separate MBean whose methods would take an\n> oname of the respective component as a string. But it seems currently there is\n> no facility (in the Registry) to obtain the associated resource object given\n> the oname of a component. Alternatively it is possible to create a component\n> from a scratch within the mbean method in add methods. But remove methods still\n> requires obtaining the resource from the corresponding oname. Am I missing some\n> thing here?\n\nHi All,\n\nCurrently I am bit stuck on above. Any ideas on this?"}, {"attachment_id": null, "tags": [], "bug_id": 49234, "is_private": false, "count": 65, "id": 138605, "time": "2010-07-21T12:19:16Z", "creator": "markt@apache.org", "creation_time": "2010-07-21T12:19:16Z", "text": "(In reply to comment #64)\n> Currently I am bit stuck on above. Any ideas on this?\n\nI'd start by looking at the MBeans for the components that currently have separate MBeans."}, {"count": 66, "tags": [], "bug_id": 49234, "attachment_id": 25796, "is_private": false, "id": 138647, "time": "2010-07-23T03:58:36Z", "creator": "chamibuddhika@gmail.com", "creation_time": "2010-07-23T03:58:36Z", "text": "Created attachment 25796\no.a.Catalina.Core Operations Patch\n\nThis deals with operations add/remove valve/lifecycleListener in the StandardContext mbean. Seperate MBean called ContainerMBean has been created with the operations. The operations are available at container level (not just StandardContext level) hence the name ContainerMBean. But this still doesn't account for addChild methods present in the descriptor. For valves and lifecycleListeners new instances have been created using the provided classnames. I am still exploring the possibility of using that approach to addChild methods as well."}, {"count": 67, "tags": [], "text": "(In reply to comment #66)\n> Created an attachment (id=25796) [details]\n> o.a.Catalina.Core Operations Patch\n> \n> This deals with operations add/remove valve/lifecycleListener in the\n> StandardContext mbean. Seperate MBean called ContainerMBean has been created\n> with the operations. The operations are available at container level (not just\n> StandardContext level) hence the name ContainerMBean. But this still doesn't\n> account for addChild methods present in the descriptor. For valves and\n> lifecycleListeners new instances have been created using the provided\n> classnames. I am still exploring the possibility of using that approach to\n> addChild methods as well.\n\nAny comments on this? However I am not sure this approach can be applied to addChild methods since different child types (Host, Context e.g.) require different parameters for their initialization.", "is_private": false, "id": 138783, "creator": "chamibuddhika@gmail.com", "time": "2010-07-31T10:46:30Z", "bug_id": 49234, "creation_time": "2010-07-31T10:46:30Z", "attachment_id": null}, {"count": 68, "tags": [], "bug_id": 49234, "text": "(In reply to comment #67)\n> Any comments on this? However I am not sure this approach can be applied to\n> addChild methods since different child types (Host, Context e.g.) require\n> different parameters for their initialization.\n\nPlease ping sooner if you don't getting a reply in 48 hours. I missed your 23/07 post.\n\n1. Please use 4 spaces not tabs\n2. All public methods should have Javadoc comments\n3. Why only modify the descriptor for StandardContext? What about Host, Engine etc\n4. re addChild. All children *must* implement Container and they all should have a no-arg constructor. It should be simple to write a addChild method that takes a class name. The startChldren attribute on the parent can be used to prevent the added child from being started until it has been initialised. You may need to change the visibility of the LifecycleMBeanBase.register() method\n\nOverall, this looks to be heading in the right direction but I'd like to see it get to the point where all containers can be added and removed via JMX before it is committed.", "id": 138795, "attachment_id": null, "creator": "markt@apache.org", "creation_time": "2010-08-01T16:06:35Z", "time": "2010-08-01T16:06:35Z", "is_private": false}, {"count": 69, "tags": [], "text": "Created attachment 25837\no.a.Catalina.Core Operations Second Patch\n\nThis patch address the first three concerns raised by Mark for the initial patch. Add/RemoveChild methods have also been incorporated to the ContainerMbean class though they may require some more work.", "is_private": false, "id": 138864, "creator": "chamibuddhika@gmail.com", "time": "2010-08-04T00:45:33Z", "bug_id": 49234, "creation_time": "2010-08-04T00:45:33Z", "attachment_id": 25837}, {"count": 70, "tags": [], "text": "(In reply to comment #69)\n\n\"May require some work\"?\n\nIt sure does. The following needs to be supported:\n- Start Tomcat\n- Via JMX, select the host\n- Create a new context\n- Configure it to serve content (e.g. from an external directory)\n- Start it\n- Check the content is accessible\n\nHint: It will be a lot easier if you modify your addChild() method to also specify the name of the child.", "is_private": false, "id": 138932, "creator": "markt@apache.org", "time": "2010-08-05T17:52:54Z", "bug_id": 49234, "creation_time": "2010-08-05T17:52:54Z", "attachment_id": null}, {"count": 71, "tags": [], "creator": "chamibuddhika@gmail.com", "is_private": false, "text": "(In reply to comment #70)\n> (In reply to comment #69)\n\nI am little bit confused here.\n> - Start Tomcat\n\nI was under the impression Tomcat should have been already started for MBean Server to be up and running and to do any work with JMX.\n\n> - Via JMX, select the host\n> - Create a new context\n> - Configure it to serve content (e.g. from an external directory)\n> - Start it\n\nThese can be done in one method or using a series of JMX method invocations. But I guess we can provide the flexibility for both ways. The issue I am having in order to incorporate these into addChild() is the fact that this method is common to Engine, Host and Context. But the above steps seem to be specified towards adding a child (a Context) to a given host. To accommodate that within addChild we may have to conditionally check for each type of the child (whether it is a Host or a Context etc.) and take suitable actions (if new Context above steps or if new Host something else) according to that. It is possible but one issue that may crop up is different types of children needing different types of configuration parameters. (e.g: for Context workDir, for Host appBase). May be we can provide this using a extended MBean classes for different types of children which overload addChild method with different parameters. WDYT?  \n\n\n> - Check the content is accessible", "id": 138944, "time": "2010-08-06T01:50:32Z", "bug_id": 49234, "creation_time": "2010-08-06T01:50:32Z", "attachment_id": null}, {"count": 72, "tags": [], "text": "(In reply to comment #71)\n> (In reply to comment #70)\n> > (In reply to comment #69)\n> \n> I am little bit confused here.\n> > - Start Tomcat\n> \n> I was under the impression Tomcat should have been already started for MBean\n> Server to be up and running and to do any work with JMX.\n\nThose steps are a series of actions the user should be able to perform.\n\n> These can be done in one method or using a series of JMX method invocations.\n\nNeither. These are user actions. But, the JMX methods need to be there to support them once Tomcat has been started.\n\n> But I guess we can provide the flexibility for both ways.\n\nNot necessary.\n\n> WDYT?\n\nI think you missed the point. addChild() needs to make sure that the child is visible in JMX so it can be configured (again via JMX) before it is started. Note my previous comment about using startChildren attribute of the parent to ensure the child isn't started until it has been configured.", "is_private": false, "id": 138946, "creator": "markt@apache.org", "time": "2010-08-06T02:46:42Z", "bug_id": 49234, "creation_time": "2010-08-06T02:46:42Z", "attachment_id": null}, {"count": 73, "tags": [], "bug_id": 49234, "attachment_id": 25862, "is_private": false, "id": 138978, "time": "2010-08-07T22:04:13Z", "creator": "chamibuddhika@gmail.com", "creation_time": "2010-08-07T22:04:13Z", "text": "Created attachment 25862\no.a.Catalina.Core Operations Third Patch\n\nThis patch adds to addChild method in ContainerMBean and does some adding and redorderings to the o.a.c.Core descriptor.\n\n- Start Tomcat\n- Via JMX, select the host\n\n- Create a new context       ----> addChild \n\n- Configure it to serve content (e.g. from an external directory) ---> Other descriptor methods in StandardContext\n\n- Start it  --> start/ startChild methods\n\n- Check the content is accessible  --> Currently not sure how this can be done"}, {"count": 74, "tags": [], "creator": "chamibuddhika@gmail.com", "text": "(In reply to comment #73)\n> Created an attachment (id=25862) [details]\n> o.a.Catalina.Core Operations Third Patch\n> \n> This patch adds to addChild method in ContainerMBean and does some adding and\n> redorderings to the o.a.c.Core descriptor.\n> \n> - Start Tomcat\n> - Via JMX, select the host\n> \n> - Create a new context       ----> addChild \n> \n> - Configure it to serve content (e.g. from an external directory) ---> Other\n> descriptor methods in StandardContext\n> \n> - Start it  --> start/ startChild methods\n> \n> - Check the content is accessible  --> Currently not sure how this can be done\n\nAny comment on this?", "id": 139012, "time": "2010-08-10T00:22:51Z", "bug_id": 49234, "creation_time": "2010-08-10T00:22:51Z", "is_private": false, "attachment_id": null}, {"count": 75, "tags": [], "bug_id": 49234, "attachment_id": null, "is_private": false, "id": 139027, "time": "2010-08-10T09:46:59Z", "creator": "markt@apache.org", "creation_time": "2010-08-10T09:46:59Z", "text": "> > Created an attachment (id=25862) [details] [details]\n> \n> Any comment on this?\n\nI only have intermittent internet access at the moment. I have just downloaded this for review."}, {"count": 76, "tags": [], "bug_id": 49234, "text": "Thanks for the updated patch.\n\nI wasn't thinking of explicitly setting startChildren in the addChild() method but it is a good idea and I like it. However, you need to rework your patch to ensure startChildren is always reset, even if an Exception occurs.\n\nAlso, there is no need to manipulate startChildren in startChild() - at least I can't see one.", "id": 139053, "attachment_id": null, "creator": "markt@apache.org", "creation_time": "2010-08-11T12:59:22Z", "time": "2010-08-11T12:59:22Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 49234, "text": "Just as a reminder remember one of the goals of this work was to be able to start with a 'blank' server object and completely configure a Tomcat instance via JMX. i.e. add a servic, engine, host and contexts. Add one or more connectors and be able to serve content from the contexts.\n\nI'll be happy to apply this patch when it can be used to add children to containers via X.", "count": 77, "id": 139054, "time": "2010-08-11T13:07:03Z", "creator": "markt@apache.org", "creation_time": "2010-08-11T13:07:03Z", "is_private": false}, {"count": 78, "tags": [], "creator": "chamibuddhika@gmail.com", "text": "(In reply to comment #77)\n> Just as a reminder remember one of the goals of this work was to be able to\n> start with a 'blank' server object and completely configure a Tomcat instance\n> via JMX. i.e. add a servic, engine, host and contexts. Add one or more\n> connectors and be able to serve content from the contexts.\n\nI guess above (add a servic, engine, host and contexts. Add one or more\nconnectors and be able to serve content from the contexts) can be done using a combination of addChild and/or MBeanFactory create methods as of now.", "id": 139059, "time": "2010-08-11T23:09:16Z", "bug_id": 49234, "creation_time": "2010-08-11T23:09:16Z", "is_private": false, "attachment_id": null}, {"count": 79, "tags": [], "bug_id": 49234, "text": "(In reply to comment #78)\n> (In reply to comment #77)\n> > Just as a reminder remember one of the goals of this work was to be able to\n> > start with a 'blank' server object and completely configure a Tomcat instance\n> > via JMX. i.e. add a servic, engine, host and contexts. Add one or more\n> > connectors and be able to serve content from the contexts.\n> \n> I guess above (add a servic, engine, host and contexts. Add one or more\n> connectors and be able to serve content from the contexts) can be done using a\n> combination of addChild and/or MBeanFactory create methods as of now.\n\nAny comment on this?", "id": 139079, "attachment_id": null, "creator": "chamibuddhika@gmail.com", "creation_time": "2010-08-13T00:47:56Z", "time": "2010-08-13T00:47:56Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 49234, "text": "(In reply to comment #79)\n> (In reply to comment #78)\n> > (In reply to comment #77)\n> > > Just as a reminder remember one of the goals of this work was to be able to\n> > > start with a 'blank' server object and completely configure a Tomcat instance\n> > > via JMX. i.e. add a servic, engine, host and contexts. Add one or more\n> > > connectors and be able to serve content from the contexts.\n> > \n> > I guess above (add a servic, engine, host and contexts. Add one or more\n> > connectors and be able to serve content from the contexts) can be done using a\n> > combination of addChild and/or MBeanFactory create methods as of now.\n> \n> Any comment on this?\n\nMark is away, please be patient.", "count": 80, "id": 139080, "time": "2010-08-13T03:26:46Z", "creator": "pidster@apache.org", "creation_time": "2010-08-13T03:26:46Z", "is_private": false}, {"count": 81, "tags": [], "bug_id": 49234, "attachment_id": 25885, "is_private": false, "id": 139092, "time": "2010-08-14T21:31:34Z", "creator": "chamibuddhika@gmail.com", "creation_time": "2010-08-14T21:31:34Z", "text": "Created attachment 25885\no.a.Catalina.Core Operations Fourth Patch\n\nModifies startChildren handling even with an exception thrown."}, {"attachment_id": 25888, "tags": [], "bug_id": 49234, "text": "Created attachment 25888\no.a.Catalina.Core Operations Fifth Patch\n\nAdds ContextMBean to support find methods of Context implementations.", "count": 82, "id": 139098, "time": "2010-08-15T11:28:51Z", "creator": "chamibuddhika@gmail.com", "creation_time": "2010-08-15T11:28:51Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 49234, "is_private": false, "count": 83, "id": 139145, "time": "2010-08-17T11:23:43Z", "creator": "markt@apache.org", "creation_time": "2010-08-17T11:23:43Z", "text": "(In reply to comment #79)\n> (In reply to comment #78)\n> > (In reply to comment #77)\n> > > Just as a reminder remember one of the goals of this work was to be able to\n> > > start with a 'blank' server object and completely configure a Tomcat instance\n> > > via JMX. i.e. add a servic, engine, host and contexts. Add one or more\n> > > connectors and be able to serve content from the contexts.\n> > \n> > I guess above (add a servic, engine, host and contexts. Add one or more\n> > connectors and be able to serve content from the contexts) can be done using a\n> > combination of addChild and/or MBeanFactory create methods as of now.\n> \n> Any comment on this?\n\nRather than 'guessing' and copy and pasting my own comments, what you should have been doing is trying this for yourself."}, {"count": 84, "tags": [], "bug_id": 49234, "text": "Created attachment 25908\no.a.Catalina.Core Operations Patch- Fix\n\nA bug fix patch for earlier patches. Now it is possible to start from a Server and add a service, engine, host, context and connectors to come up with a configured server.", "id": 139212, "attachment_id": 25908, "creator": "chamibuddhika@gmail.com", "creation_time": "2010-08-18T12:28:25Z", "time": "2010-08-18T12:28:25Z", "is_private": false}, {"count": 85, "tags": [], "creator": "markt@apache.org", "text": "The patch is getting there but there is still quite a lot of work to do.\n\nStarting from just a Server object the patch is insufficient. See my commits earlier today for StandardServer and MBeanFactory. Further work is also required. See below for details.\n\nThe patch contained a number of tabs. I'd suggest enabling validation as it will pick this up as part of the build process.\n\nThe two new files are missing the mandatory AL2 license header.\n\nWhen adding child containers, the children need to be initialized. This will register them with the MBeanServer so they can be configured before they are started. That should also make the startChild() method unnecessary.\n\nI fixed most of the above and then tested with a server.xml that just had a Server object defined. I could add everything I needed to and some bits worked (others didn't) but I still saw a lot of errors. Overall I think you need to do more testing and generally make things more robust.\n\nOn a related point, I noticed that the addConnector method on Service isn't available via JMX. I suspect that this isn't an isolated issue and that other methods exposed via MBeans will have similar issues that need to be fixed.", "id": 139284, "time": "2010-08-20T11:31:41Z", "bug_id": 49234, "creation_time": "2010-08-20T11:31:41Z", "is_private": false, "attachment_id": null}, {"count": 86, "tags": [], "creator": "chamibuddhika@gmail.com", "is_private": false, "text": "(In reply to comment #85)\n\n \n> When adding child containers, the children need to be initialized. This will\n> register them with the MBeanServer so they can be configured before they are\n> started. That should also make the startChild() method unnecessary.\n> \n\nI am little bit confused here. MBean registration for the component happens within  init(). But it is called as a part of the start() procedure. If I am not mistaken init() consist of only part of this start procedure. So still we may have to call the start method of the child to get the other stuff properly executed (e.g: startInternal())? Calling start on already inited component doesn't have any other side effects as I understood looking at the state diagram on the Lifecycle class.", "id": 139374, "time": "2010-08-23T09:41:38Z", "bug_id": 49234, "creation_time": "2010-08-23T09:41:38Z", "attachment_id": null}, {"count": 87, "tags": [], "bug_id": 49234, "attachment_id": null, "is_private": false, "id": 139375, "time": "2010-08-23T09:53:20Z", "creator": "markt@apache.org", "creation_time": "2010-08-23T09:53:20Z", "text": "(In reply to comment #86)\n\n> I am little bit confused here. MBean registration for the component happens\n> within  init(). But it is called as a part of the start() procedure.\n\nIt can be called as part of start() but it doesn't have to be.\n\n> If I am\n> not mistaken init() consist of only part of this start procedure. So still we\n> may have to call the start method of the child to get the other stuff properly\n> executed (e.g: startInternal())? Calling start on already inited component\n> doesn't have any other side effects as I understood looking at the state\n> diagram on the Lifecycle class.\n\nTake a look at the LifecycleBase class."}, {"count": 88, "tags": [], "creator": "chamibuddhika@gmail.com", "is_private": false, "text": "(In reply to comment #86)\n\n> I am little bit confused here. MBean registration for the component happens\n> within  init(). But it is called as a part of the start() procedure. If I am\n> not mistaken init() consist of only part of this start procedure. So still we\n> may have to call the start method of the child to get the other stuff properly\n> executed (e.g: startInternal())? Calling start on already inited component\n> doesn't have any other side effects as I understood looking at the state\n> diagram on the Lifecycle class.\n\nActually now I realize that once the child is visible via JMX we can directly call child's start method to start it once we are finished configuring it. So the startChild method of the parent is not strictly necessary. So I guess I will be removing that.", "id": 139376, "time": "2010-08-23T10:16:02Z", "bug_id": 49234, "creation_time": "2010-08-23T10:16:02Z", "attachment_id": null}, {"attachment_id": 25937, "tags": [], "bug_id": 49234, "is_private": false, "count": 89, "id": 139450, "time": "2010-08-25T10:42:02Z", "creator": "chamibuddhika@gmail.com", "creation_time": "2010-08-25T10:42:02Z", "text": "Created attachment 25937\no.a.Catalina.core Operations Patch 6\n\nThis iteration of the patch adds a ServiceMBean to enhance Service related functionalities. AddConnector and related methods are now properly available in Service MBean. Includes several other modifications for the earlier patch like removal of startChild method in ContainerMBean and initializing the children during addChild."}, {"count": 90, "tags": [], "creator": "chamibuddhika@gmail.com", "text": "(In reply to comment #89)\n> Created an attachment (id=25937) [details]\n> o.a.Catalina.core Operations Patch 6\n> \n> This iteration of the patch adds a ServiceMBean to enhance Service related\n> functionalities. AddConnector and related methods are now properly available in\n> Service MBean. Includes several other modifications for the earlier patch like\n> removal of startChild method in ContainerMBean and initializing the children\n> during addChild.\n\nWith this patch I am able to do following successfully.\n\n1. Create a Service and Engine\n2. Create and add a connector to the service\n3. Initialize the service, engine and connectors\n3. Create a Host and Context and initialize them\n\nIt is not clear what sequence of next steps to be taken to add and serve a resource after this. Any ideas on how to proceed?", "id": 139790, "time": "2010-09-09T11:01:50Z", "bug_id": 49234, "creation_time": "2010-09-09T11:01:50Z", "is_private": false, "attachment_id": null}, {"count": 91, "tags": [], "bug_id": 49234, "attachment_id": null, "is_private": false, "id": 139829, "time": "2010-09-11T13:18:01Z", "creator": "markt@apache.org", "creation_time": "2010-09-11T13:18:01Z", "text": "Please enable validation in your build process and ensure in future that patch you provide build with validation enabled. This one had a number of tabs that needs to be replaced with spaces."}, {"count": 92, "tags": [], "bug_id": 49234, "attachment_id": null, "is_private": false, "id": 139832, "time": "2010-09-11T13:51:37Z", "creator": "markt@apache.org", "creation_time": "2010-09-11T13:51:37Z", "text": "The patch is heading in the right direction and I am tempted to commit it. However, I see a bunch of stack traces in the logs when I try to start a Context so I think there is still some more work required but definitely making progress."}, {"count": 93, "tags": [], "text": "I got to the bottom of the problem. The correct parent class loader was not being passed down the object hierarchy. I fixed that and applied your patch. I can now get to the point where I can create a context with static content and JSPs via JMX from a server.xml that just contains a Server object. Woot!\n\nWith this patch the basic functionality is in place. The MBeans exposed are a lot better than they were but there is still work to do. For example a quick review of the StandardContext found a bunch if typos, a missing attribute and other attributes that are not visible in JConsole. See r996235 for details.\n\nI recommend that the next step is to work through the MBeans in JConsole and resolving the following issues:\n- attributes that show up as Unavailable (in red text)\n- methods that can not be called (you'll see an error message when you click on \"Operations\" in the navigation tree)\n\nSome will be easier than others. I'd go for the quick win typos (like those in r966235) first.", "is_private": false, "id": 139835, "creator": "markt@apache.org", "time": "2010-09-11T21:44:59Z", "bug_id": 49234, "creation_time": "2010-09-11T21:44:59Z", "attachment_id": null}, {"count": 94, "text": "(In reply to comment #93)\n> I got to the bottom of the problem. The correct parent class loader was not\n> being passed down the object hierarchy. I fixed that and applied your patch. I\n> can now get to the point where I can create a context with static content and\n> JSPs via JMX from a server.xml that just contains a Server object. Woot!\n> \n> With this patch the basic functionality is in place. The MBeans exposed are a\n> lot better than they were but there is still work to do. For example a quick\n> review of the StandardContext found a bunch if typos, a missing attribute and\n> other attributes that are not visible in JConsole. See r996235 for details.\n> \n> I recommend that the next step is to work through the MBeans in JConsole and\n> resolving the following issues:\n> - attributes that show up as Unavailable (in red text)\n> - methods that can not be called (you'll see an error message when you click on\n> \"Operations\" in the navigation tree)\n> \n> Some will be easier than others. I'd go for the quick win typos (like those in\n> r966235) first.\n\nI will look in to these issues in next couple of days.", "creator": "chamibuddhika@gmail.com", "is_private": false, "id": 139876, "time": "2010-09-14T20:36:41Z", "bug_id": 49234, "creation_time": "2010-09-14T20:36:41Z", "tags": [], "attachment_id": null}, {"count": 95, "tags": [], "bug_id": 49234, "text": "Now might be a good time to resolve this issue as FIXED and move to using separate issues for any future improvements. That would keep this issue as an archive of your GSOC work.", "id": 139881, "attachment_id": null, "creator": "markt@apache.org", "creation_time": "2010-09-15T11:33:48Z", "time": "2010-09-15T11:33:48Z", "is_private": false}, {"count": 96, "tags": [], "bug_id": 49234, "text": "As per Mark's suggestion I am marking this issue as resolved and continue any further work as new issues.", "id": 139891, "attachment_id": null, "creator": "chamibuddhika@gmail.com", "creation_time": "2010-09-16T03:04:51Z", "time": "2010-09-16T03:04:51Z", "is_private": false}]