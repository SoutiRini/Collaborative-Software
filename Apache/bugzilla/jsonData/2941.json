[{"count": 0, "tags": [], "bug_id": 2941, "is_private": false, "text": "Now accessing TC4 through Apache.  It mostly works\nperfectly, but there's a show-stopper: cookies.\n\n-----------------------------------------------\nTHE SETUP:\n\n        Apache:         1.3.20\n        Catalina:       CVS this week (4.0b7++)\n        mod_webapp:     CVS this week\n        warp.jar:       from latest mod_webapp\n        \n\n-----------------------------------------------\nTHE PROBLEM: \n\nI am trying to disable cookies for\nall webapps under Catalina... or at least, for a given\nContext.  When I access the webapp through Catalina\ndirectly, the right thing happens.  But when I go \nthrough Apache via Warp, Catalina does the wrong\nthing.  You can try this out with /examples/servlet/SessionExample.\n\nIn some cases, it fails to recognize and strip off the\ntrailing \";jsessionid=****\", and so Catalina seems\nto think the \";...\" is part of the URI, raising\nthis:\n\n        HTTP Status 404 -\n/examples/servlet/SessionExample;jsessionid=9271664256C7E592889000D43292C845\n        \n        The requested resource\n(/examples/servlet/SessionExample;jsessionid=9271664256C7E592889000D43292C845) \n        is not available. \n\nIn other cases, it seems to disregard the \"cookies=false\"\nin server.xml, and it tries to give me a cookie.\nBTW, my \"server.xml\" contains this:\n\n       <Context path=\"/examples\" docBase=\"examples\" debug=\"0\" \n                cookies=\"false\" \n                reloadable=\"true\">\n        ...\n\nI don't quite know if this is correct, but it seemed\nto do the right thing when Apache was not part of\nthe picture.  Going through Warp, however, broke\nthis approach (see below).\n\n-----------------------------------------------\nWHY THIS IS A BIG PROBLEM:\n\nThis is for a US Government site, and by Federal order,\nwe are not to use cookies in our web apps at all.\nThis is to make access to our sites more anonymous,\nbut it can make life a little difficult.\n\n-----------------------------------------------\nTESTS THAT WE RAN:\n\nAgain, this is simply mounting /examples through Warp\nand hitting /examples/servlet/SessionExample:\nHere's a quick test matrix, varying whether:\n\n        1. Netscape did/didn't have cookies enabled\n        2. We accessed via Apache (as opposed to TC4 directly)\n        3. We set cookies true/false in the server.xml context.\n\nThe table (i'm hoping I've transcribed it correctly):\n\n        Browser Access  Cookies\n        cookies via     on in\n        enabled apache  Context RESULT:\n        ------  ------  ------  ------\n        no      no      no      ok\n        no      no      yes     ok\n        no      yes     no      FAIL [1]\n        no      yes     yes     FAIL [2]\n        yes     no      no      ok      \n        yes     no      yes     ok\n        yes     yes     no      FAIL [3]\n        yes     yes     yes     ok\n        \n[1] 404 on the jsessionid=....\n[2] 404 on the jsessionid=....\n[3] Apache asks the browser for a cookie.\n\n-----------------------------------------------\nCONCLUSION:\n\nThe problem only appears when you access the webapp\nvia Apache, and attempt to NOT use cookies -- \nby turning them off in your browser, or\nby disabling them in the context, or both.", "id": 4197, "time": "2001-07-31T18:17:00Z", "creator": "eryq@zeegee.com", "creation_time": "2001-07-31T18:17:00Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 2941, "attachment_id": null, "id": 4463, "time": "2001-08-10T12:31:54Z", "creator": "pier@betaversion.org", "creation_time": "2001-08-10T12:31:54Z", "is_private": false, "text": "Should be fixed in CVS. Eriq, can you please check and report?"}, {"count": 2, "tags": [], "bug_id": 2941, "attachment_id": null, "id": 4575, "time": "2001-08-14T17:18:03Z", "creator": "pier@betaversion.org", "creation_time": "2001-08-14T17:18:03Z", "is_private": false, "text": "I didn't hear anything back from Eriq, and the Fix in CVS seems to be \nholding. I'm closing this one."}, {"count": 3, "tags": [], "bug_id": 2941, "attachment_id": null, "id": 7927, "time": "2001-11-14T17:07:31Z", "creator": "eryq@zeegee.com", "creation_time": "2001-11-14T17:07:31Z", "is_private": false, "text": "Just installed the new TC4.0.1 with the new mod_webapp.so connector,\nrunning under Apache 1.3.20.  The following case does not work:\n\n        * Cookies are turned OFF in context /examples in the server.xml\n        * Browser has cookies enabled\n        * Catalina is accessed via Apache through WARP connector\n\nI am accessing Catalina via Apache, using a URL like this:\n\n        http://localhost:8080/examples/servlet/SessionExample\n\nWhat I would *expect* is that the SessionExample would\nNOT attempt to use cookies.  Unfortunately, it still tries\nto set a cookie!  The way I turn off cookies for the examples\nis via Catalina's server.xml:\n\n        <!-- Tomcat Examples Context --> \n        <Context path=\"/examples\" docBase=\"examples\" debug=\"0\" \n                cookies=\"false\" \n                reloadable=\"true\"> \n        \nThe setup is:\n\n        * Tomcat 4.0.1 (from download area)\n        * WARP connector \n        * Apache 1.3.20\n\t* mod_webapp.so (eapi)\n        * Netscape 4 with cookies ENABLED (plus a warning if cookies are sent)\n        * Solaris\n"}, {"count": 4, "attachment_id": null, "bug_id": 2941, "is_private": false, "id": 8183, "time": "2001-11-22T02:59:41Z", "creator": "jfclere@gmail.com", "creation_time": "2001-11-22T02:59:41Z", "tags": [], "text": "Pier was right it is fixed:\nTo test it you have to put the context in the WARP engine:\n+++\n      <!-- Global logger unless overridden at lower levels -->\n      <Logger className=\"org.apache.catalina.logger.FileLogger\"\n              prefix=\"apache_log.\" suffix=\".txt\"\n              timestamp=\"true\"/>\n      <Host name=\"vtxclere.bcn.fsc.net\" debug=\"0\" appBase=\"webapps\"\n       unpackWARs=\"false\">\n \n              <Context path=\"/examples\" docBase=\"examples\" debug=\"0\"\n                cookies=\"false\"\n                reloadable=\"true\">\n              </Context>\n      </Host>\n+++"}]