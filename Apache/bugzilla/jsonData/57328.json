[{"count": 0, "attachment_id": 32268, "creator": "a.abfalterer@gmail.com", "is_private": false, "id": 179619, "time": "2014-12-08T11:16:20Z", "bug_id": 57328, "creation_time": "2014-12-08T11:16:20Z", "tags": [], "text": "Created attachment 32268\nPatch to dump elements of ap_server_config_defines after a graceful restart, includes also fix for the problem\n\n== Reproduction ==\n\n1) Find attached a patch for server/core.c that dumps the elements of ap_server_config_defines after a graceful restart.\n\n2) Define some variables in httpd.conf, e.g.\n\nDefine arg1=val1\nDefine arg2=val2\nDefine arg3=val4\n\n3) By doing some graceful restarts (5-10 times), the increasing number of array elements with invalid memory references can be observerd. The problem can be reproduced each time.\n\n== Explanation ==\n\nAfter a graceful restart, the reset_config_defines() function in server/core.c resets ap_server_config_defines back to its original pointer saved_server_config_defines. Henceforth, variable definitions (by means of Define) are stored in the original array, and thus, leading to invalid memory access upon next graceful restarts.\n\n== Solution == \nA fix to the problem can be found in the provided patch file and be enabled by setting the macro constant WITH_FIX to 1.\n\nRegards, Armin"}, {"count": 1, "tags": [], "bug_id": 57328, "text": "Committed in r1643825.\n\nI first misread your patch and started working on a much more complicated one, until I realized yours was the minimal/only change needed.\n\nThanks for the analysis and patch Armin, will propose it for 2.4.x.", "id": 179624, "time": "2014-12-08T14:35:43Z", "creator": "ylavic.dev@gmail.com", "creation_time": "2014-12-08T14:35:43Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "ylavic.dev@gmail.com", "text": "*** Bug 56008 has been marked as a duplicate of this bug. ***", "count": 2, "id": 179626, "time": "2014-12-08T14:39:06Z", "bug_id": 57328, "creation_time": "2014-12-08T14:39:06Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 57328, "text": "Backported to 2.4.11 (unreleased) in r1651083, available in upcoming 2.4.12.", "id": 180496, "time": "2015-01-23T08:10:03Z", "creator": "ylavic.dev@gmail.com", "creation_time": "2015-01-23T08:10:03Z", "is_private": false, "attachment_id": null}]