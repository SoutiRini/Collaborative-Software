[{"count": 0, "tags": [], "bug_id": 41154, "attachment_id": null, "text": "I construct my own GUI to run testcases written by ant scripts\nI hope to redirect the output to textarea at the beginning of run and \nredirect the output back to console at the end of the run.\nThose echo message and log message can be print in textarea easily but \nthe output of sshexec can't be print in textarea.\nMy related codes are as below:\n\n\tclass FilteredStream extends FilterOutputStream {\n\t    public FilteredStream(OutputStream aStream) {\n\t\t  \tsuper(aStream);\n\t\t}\n\t\t\n\t\tpublic void write(byte b[]) throws IOException {\n\t\t   String aString = new String(b);\n\t\t   postInfo(aString);\n\t\t}\n\n\t\tpublic void write(byte b[], int off, int len) throws \nIOException {\n\t\t   String aString = new String(b , off , len);\n\t\t   postInfo(aString);\n\t\t}\n\t}\n\n\tprivate void postInfo(String message) {\n\t\ttaskOutput.append(message);\n\t\t//eBARTMainPanel.getResultTextPane().append(message);\n\t\tif(\"\\r\\n\".equals(message)||\"\\n\".equals(message))\n\t\t\treturn;\n\t\telse \n\t\t\t_log.info(message.replaceAll(\"\\n\",\"\"));\n\t}\n\t\n\tprivate void redirectOutputToTextArea(){\n\t\tPrintStream out  = \n\t\t   new PrintStream(\n\t\t\t new FilteredStream(\n\t\t\t   new ByteArrayOutputStream()));\n\t\tdefaultPrintStream = System.out;\n\t\tSystem.setOut(out);\n\t\tSystem.setErr(out);\t\n\t}\n\t\n\tprivate void redirectOutputToConsole(){\n\t\tSystem.setOut(defaultPrintStream);\n\t\tSystem.setErr(defaultPrintStream);\n\t}\n\nTherefore, I debug into the source code of ant.\nIn class org.apache.tools.ant.taskdefs.optional.ssh.SSHExec\nline 136: \nTeeOutputStream tee = new TeeOutputStream(out, new KeepAliveOutputStream\n(System.out));\n\nand in class org.apache.tools.ant.util.KeepAliveOutputStream\nit extends class java.io.FilterOutputStream but didn't implement method such \nas write(byte[] b) and write(byte[] b, int off, int len)\n\nI believe that's why the sshexec output can't be written to the textarea.\nThanks,\n\n-Nicholas", "id": 96784, "time": "2006-12-12T00:09:19Z", "creator": "wdu@ebay.com", "creation_time": "2006-12-12T00:09:19Z", "is_private": false}, {"count": 1, "tags": [], "creator": "jan@materne.de", "attachment_id": null, "text": "*** Bug 41155 has been marked as a duplicate of this bug. ***", "id": 96789, "time": "2006-12-12T02:31:11Z", "bug_id": 41154, "creation_time": "2006-12-12T02:31:11Z", "is_private": false}, {"count": 2, "tags": [], "text": "(In reply to comment #0)\n[SNIP]\n> and in class org.apache.tools.ant.util.KeepAliveOutputStream\n> it extends class java.io.FilterOutputStream but didn't implement method such \n> as write(byte[] b) and write(byte[] b, int off, int len)\n> \n> I believe that's why the sshexec output can't be written to the textarea.\n\nI'm afraid I don't understand the process by which you arrived at this\nconclusion.  Maybe your time would be better spent putting together an example\nyou can attach to this report so that we can get a better picture of the overall\nsituation.\n\n-Matt\n", "attachment_id": null, "id": 96805, "creator": "mbenson@apache.org", "time": "2006-12-12T07:11:00Z", "bug_id": 41154, "creation_time": "2006-12-12T07:11:00Z", "is_private": false}]