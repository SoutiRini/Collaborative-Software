[{"count": 0, "tags": [], "bug_id": 47958, "attachment_id": 24360, "id": 130959, "time": "2009-10-07T20:27:42Z", "creator": "trejkaz@trypticon.org", "creation_time": "2009-10-07T20:27:42Z", "is_private": false, "text": "Created attachment 24360\nSample file\n\nPut the sample file somewhere, adjust this test to point to the correct file\nlocation and run.\n\n    @Test\n    public void testPictureExtractionProblem() throws Exception\n    {\n        File file = new File(\"C:\\\\Data\\\\Test\\\\NUIQ021202.doc\");\n        POIFSFileSystem poifs;\n        InputStream stream = new FileInputStream(file);\n        try\n        {\n            poifs = new POIFSFileSystem(stream);\n        }\n        finally\n        {\n            stream.close();\n        }\n\n        HWPFDocument doc = new HWPFDocument(poifs);\n\n        // Throws ArrayIndexOutOfBoundsException\n        doc.getPicturesTable().getAllPictures();\n    }\n\nGives the following error:\n\njava.lang.ArrayIndexOutOfBoundsException: 50206\n    at org.apache.poi.util.LittleEndian.getShort(LittleEndian.java:45)\n    at\norg.apache.poi.ddf.EscherRecord$EscherRecordHeader.readHeader(EscherRecord.java:250)\n    at\norg.apache.poi.ddf.DefaultEscherRecordFactory.createRecord(DefaultEscherRecordFactory.java:56)\n    at\norg.apache.poi.hwpf.model.PicturesTable.searchForPictures(PicturesTable.java:171)\n    at\norg.apache.poi.hwpf.model.PicturesTable.searchForPictures(PicturesTable.java:178)\n    at\norg.apache.poi.hwpf.model.PicturesTable.searchForPictures(PicturesTable.java:178)\n    at\norg.apache.poi.hwpf.model.PicturesTable.getAllPictures(PicturesTable.java:202)\n\nThere does appear to be a picture in the document but it's unknown to me\nwhether it's embedded directly or via an OLE2 container (what is known is that\nthere *is* one OLE2 container in the file.)"}, {"count": 1, "tags": [], "bug_id": 47958, "attachment_id": null, "text": "Still have the problem in trunk.\n\nYegor", "id": 147433, "time": "2011-06-24T08:25:01Z", "creator": "yegor@dinom.ru", "creation_time": "2011-06-24T08:25:01Z", "is_private": false}, {"count": 2, "text": "*** Bug 50936 has been marked as a duplicate of this bug. ***", "bug_id": 47958, "attachment_id": null, "id": 151041, "time": "2011-10-30T00:31:42Z", "creator": "vlsergey@gmail.com", "creation_time": "2011-10-30T00:31:42Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "creator": "vlsergey@gmail.com", "attachment_id": null, "id": 151042, "time": "2011-10-30T00:35:11Z", "bug_id": 47958, "creation_time": "2011-10-30T00:35:11Z", "is_private": false, "text": "I added workaround to skip pictures that can't be loaded and print an exception for those in logs. It turns out in example files we have more records than pictures present.\n\nDone in revision 1195080"}]