[{"count": 0, "tags": [], "bug_id": 61153, "attachment_id": null, "is_private": false, "id": 199050, "time": "2017-06-04T14:10:02Z", "creator": "espen@blikstad.no", "creation_time": "2017-06-04T14:10:02Z", "text": "Hi\n\nI'm trying to solve a bug in Rundeck which uses the Apache Ant libraries. Rundeck does not compile or build any components, it runs scripts for IT administrators.\n\nI'm running Rundeck on Windows and I'm experiencing deadslocks. I have discovered that serveral tools on Windows like PowerShell.exe does not handle a closed input handle for I/O redirection. I have also experienced this with multiple other Windows tools like cmd.exe and winrs.exe.\n\nWhile debugging Rundeck i discovered that it uses Ant and creates an ExecTask object for executing a local program. ExecTask creates a Redirector object which in turn creates a PumpStreamHandler. The PumpStreamHandler however has a variable called closedwhenexhausted which causes the input thread to close the process input handle and stop the thread when no more data is available.\n\nOn Windows you cannot close the input handle until the process has completed...\n\n\nLines of code taken from StreamPumper.java. os being the output stream is the process input stream which cannot be closed until the process is done.\n##############################################\n        } finally {\n            if (closeWhenExhausted) {\n                try {\n                    os.close();\n                } catch (IOException e) {\n                    // ignore\n                }"}, {"count": 1, "tags": [], "text": "I have forked the ant repository and created a pull request.\nhttps://github.com/apache/ant/pull/34", "attachment_id": null, "id": 199054, "creator": "espen@blikstad.no", "time": "2017-06-04T18:42:30Z", "bug_id": 61153, "creation_time": "2017-06-04T18:42:30Z", "is_private": false}]