[{"count": 0, "tags": [], "creator": "dgoeury@workspeed.com", "attachment_id": null, "text": "JkInputStream.receive() thinks that MsgAjp.getLen() returns the total number \nof bytes contained by the ajp13 packet when in fact it returns only the data \nlength. Here is where I think the bug comes from:\n\n  /** Receive a chunk of data. Called to implement the\n   *  'special' packet in ajp13 and to receive the data\n   *  after we send a GET_BODY packet\n   */\n  public boolean receive() throws IOException\n  {\n    ...\n    if( bodyMsg.getLen() <= 4 ) { // just the header\n      // Don't mark 'end of stream' for the first chunk.\n      // end_of_stream = true;\n      return false;\n    }\n    ...\n  }\n\nAnd here is an example of a packet that is ignored because of this bug. This \npacket contains a two characters string \"ab\".\n\n  Byte   Content    Description\n\n   0      0x12    standard header\n   1      0x34    standard header\n   2      0x00    data length\n   3      0x04    data length\n   4      0x00    string length\n   5      0x02    string length\n   6      0x61    'a'\n   7      0x62    'b'", "id": 37671, "time": "2003-05-23T13:40:40Z", "bug_id": 20184, "creation_time": "2003-05-23T13:40:40Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 20184, "attachment_id": null, "is_private": false, "id": 52909, "time": "2004-02-25T03:48:29Z", "creator": "truk@apache.org", "creation_time": "2004-02-25T03:48:29Z", "text": "*** Bug 27012 has been marked as a duplicate of this bug. ***"}, {"count": 2, "tags": [], "creator": "truk@apache.org", "attachment_id": null, "text": "Transfered comments from bug 27012:\n\nThe tomcat connected to apache over jk2. Two bytes of a request get lost if the\nrequest size is 8190 (even the critical length is perioodic about 1024x8+2). The\nerror is brobably in the class org.apache.jk.common.JkInputStream in the method\nreceive. The check 'if( bodyMsg.getLen() <= 4 )' seems to be not correct.", "id": 52910, "time": "2004-02-25T03:54:10Z", "bug_id": 20184, "creation_time": "2004-02-25T03:54:10Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 20184, "text": "This is fixed in CVS. Thanks for the detailed report.", "id": 53480, "time": "2004-03-05T05:17:02Z", "creator": "truk@apache.org", "creation_time": "2004-03-05T05:17:02Z", "is_private": false, "attachment_id": null}]