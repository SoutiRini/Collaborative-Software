[{"count": 0, "tags": [], "bug_id": 24937, "attachment_id": null, "is_private": false, "id": 47995, "time": "2003-11-24T10:02:13Z", "creator": "karpierz@alpha.pl", "creation_time": "2003-11-24T10:02:13Z", "text": "Fix for this bug mentioned in http://nagoya.apache.org/bugzilla/show_bug.cgi?\nid=24329 is not quite good, because it caused that ssl-std.conf which is \nproduced by Makefile.in contains improper symbolic part of paths \n(pseudo_variables fo 'configure' utility on unix platforms) rather than real \npaths.\nFollowing patch (tested on the real installation of Apache2.0) makes (I hope) \nbetter solution and is symmetrical for httpd-std.conf.in, httpd-win.conf pair.\n\n(sorry for my 'english')\n\nIndex: Makefile.win\n===================================================================\nRCS file: /home/cvspublic/httpd-2.0/Makefile.win,v\nretrieving revision 1.120.2.13\ndiff -u -r1.120.2.13 Makefile.win\n--- Makefile.win\t18 Nov 2003 00:46:02 -0000\t1.120.2.13\n+++ Makefile.win\t24 Nov 2003 09:32:04 -0000\n@@ -451,10 +451,10 @@\n \t-mkdir \"$(INSTDIR)\\logs\"\n \t-mkdir \"$(INSTDIR)\\modules\"\n \t-mkdir \"$(INSTDIR)\\proxy\"\n- \t-mkdir \"$(INSTDIR)\\symbols\"\n- \t-mkdir \"$(INSTDIR)\\symbols\\exe\"\n- \t-mkdir \"$(INSTDIR)\\symbols\\dll\"\n- \t-mkdir \"$(INSTDIR)\\symbols\\so\"\n+\t-mkdir \"$(INSTDIR)\\symbols\"\n+\t-mkdir \"$(INSTDIR)\\symbols\\exe\"\n+\t-mkdir \"$(INSTDIR)\\symbols\\dll\"\n+\t-mkdir \"$(INSTDIR)\\symbols\\so\"\n \tcopy ABOUT_APACHE \t\"$(INSTDIR)\\ABOUT_APACHE.txt\" <.y\n \tcopy CHANGES \t\t\"$(INSTDIR)\\CHANGES.txt\" <.y\n \tcopy INSTALL \t\t\"$(INSTDIR)\\INSTALL.txt\" <.y\n@@ -630,8 +630,8 @@\n <<\n \tif not exist \"$(INSTDIR)\\conf\\httpd.conf\" \\\n \t    copy \"$(INSTDIR)\\conf\\httpd.default.conf\" \"$(INSTDIR)\n\\conf\\httpd.conf\"\n-\tcopy docs\\conf\\ssl-std.conf.in \"$(INSTDIR)\\conf\\ssl.default.conf\" <.y\n-\t-awk -f <<script.awk \"docs/conf/ssl-std.conf\" \"$(INSTDIR)\" \n> \"$(INSTDIR)\\conf\\ssl.default.conf\"\n+\tcopy docs\\conf\\ssl-win.conf \"$(INSTDIR)\\conf\\ssl.default.conf\" <.y\n+\t-awk -f <<script.awk \"docs/conf/ssl-win.conf\" \"$(INSTDIR)\" \n> \"$(INSTDIR)\\conf\\ssl.default.conf\"\n     BEGIN { \n \tserverroot = ARGV[2];\n \tdelete ARGV[2];\nIndex: docs/conf/ssl-win.conf\n===================================================================\n+++ docs/conf/ssl-win.conf\tFri Nov 21 11:04:38 2003\n@@ -0,0 +1,249 @@\n+#\n+# This is the Apache server configuration file providing SSL support.\n+# It contains the configuration directives to instruct the server how to\n+# serve pages over an https connection. For detailing information about these \n+# directives see <URL:http://httpd.apache.org/docs-2.0/mod/mod_ssl.html>\n+#\n+#   For the moment, see <URL:http://www.modssl.org/docs/> for this info. \n+#   The documents are still being prepared from material donated by the\n+#   modssl project.\n+# \n+# Do NOT simply read the instructions in here without understanding\n+# what they do.  They're here only as hints or reminders.  If you are unsure\n+# consult the online docs. You have been warned.  \n+#\n+<IfDefine SSL>\n+\n+#   Until documentation is completed, please check http://www.modssl.org/\n+#   for additional config examples and module docmentation.  Directives\n+#   and features of mod_ssl are largely unchanged from the mod_ssl project\n+#   for Apache 1.3.\n+\n+#\n+# When we also provide SSL we have to listen to the \n+# standard HTTP port (see above) and to the HTTPS port\n+#\n+# Note: Configurations that use IPv6 but not IPv4-mapped addresses need two\n+#       Listen directives: \"Listen [::]:443\" and \"Listen 0.0.0.0:443\"\n+#\n+Listen 443\n+\n+##\n+##  SSL Global Context\n+##\n+##  All SSL configuration in this context applies both to\n+##  the main server and all SSL-enabled virtual hosts.\n+##\n+\n+#\n+#   Some MIME-types for downloading Certificates and CRLs\n+#\n+AddType application/x-x509-ca-cert .crt\n+AddType application/x-pkcs7-crl    .crl\n+\n+#   Pass Phrase Dialog:\n+#   Configure the pass phrase gathering process.\n+#   The filtering dialog program (`builtin' is a internal\n+#   terminal dialog) has to provide the pass phrase on stdout.\n+SSLPassPhraseDialog  builtin\n+\n+#   Inter-Process Session Cache:\n+#   Configure the SSL Session Cache: First the mechanism \n+#   to use and second the expiring timeout (in seconds).\n+#SSLSessionCache        none\n+#SSLSessionCache        shmht:logs/ssl_scache(512000)\n+#SSLSessionCache        shmcb:logs/ssl_scache(512000)\n+SSLSessionCache         dbm:logs/ssl_scache\n+SSLSessionCacheTimeout  300\n+\n+#   Semaphore:\n+#   Configure the path to the mutual exclusion semaphore the\n+#   SSL engine uses internally for inter-process synchronization. \n+SSLMutex  file:logs/ssl_mutex\n+\n+#   Pseudo Random Number Generator (PRNG):\n+#   Configure one or more sources to seed the PRNG of the \n+#   SSL library. The seed data should be of good random quality.\n+#   WARNING! On some platforms /dev/random blocks if not enough entropy\n+#   is available. This means you then cannot use the /dev/random device\n+#   because it would lead to very long connection times (as long as\n+#   it requires to make more entropy available). But usually those\n+#   platforms additionally provide a /dev/urandom device which doesn't\n+#   block. So, if available, use this one instead. Read the mod_ssl User\n+#   Manual for more details.\n+SSLRandomSeed startup builtin\n+SSLRandomSeed connect builtin\n+#SSLRandomSeed startup file:/dev/random  512\n+#SSLRandomSeed startup file:/dev/urandom 512\n+#SSLRandomSeed connect file:/dev/random  512\n+#SSLRandomSeed connect file:/dev/urandom 512\n+\n+##\n+## SSL Virtual Host Context\n+##\n+\n+<VirtualHost _default_:443>\n+\n+#  General setup for the virtual host\n+DocumentRoot \"@@ServerRoot@@/htdocs\"\n+ServerName www.example.com:443\n+ServerAdmin you@example.com\n+ErrorLog logs/error_log\n+TransferLog logs/access_log\n+\n+#   SSL Engine Switch:\n+#   Enable/Disable SSL for this virtual host.\n+SSLEngine on\n+\n+#   SSL Cipher Suite:\n+#   List the ciphers that the client is permitted to negotiate.\n+#   See the mod_ssl documentation for a complete list.\n+SSLCipherSuite ALL:!ADH:!\nEXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL\n+\n+#   Server Certificate:\n+#   Point SSLCertificateFile at a PEM encoded certificate.  If\n+#   the certificate is encrypted, then you will be prompted for a\n+#   pass phrase.  Note that a kill -HUP will prompt again.  Keep\n+#   in mind that if you have both an RSA and a DSA certificate you\n+#   can configure both in parallel (to also allow the use of DSA\n+#   ciphers, etc.)\n+SSLCertificateFile @@ServerRoot@@/conf/ssl.crt/server.crt\n+#SSLCertificateFile @@ServerRoot@@/conf/ssl.crt/server-dsa.crt\n+\n+#   Server Private Key:\n+#   If the key is not combined with the certificate, use this\n+#   directive to point at the key file.  Keep in mind that if\n+#   you've both a RSA and a DSA private key you can configure\n+#   both in parallel (to also allow the use of DSA ciphers, etc.)\n+SSLCertificateKeyFile @@ServerRoot@@/conf/ssl.key/server.key\n+#SSLCertificateKeyFile @@ServerRoot@@/conf/ssl.key/server-dsa.key\n+\n+#   Server Certificate Chain:\n+#   Point SSLCertificateChainFile at a file containing the\n+#   concatenation of PEM encoded CA certificates which form the\n+#   certificate chain for the server certificate. Alternatively\n+#   the referenced file can be the same as SSLCertificateFile\n+#   when the CA certificates are directly appended to the server\n+#   certificate for convinience.\n+#SSLCertificateChainFile @@ServerRoot@@/conf/ssl.crt/ca.crt\n+\n+#   Certificate Authority (CA):\n+#   Set the CA certificate verification path where to find CA\n+#   certificates for client authentication or alternatively one\n+#   huge file containing all of them (file must be PEM encoded)\n+#   Note: Inside SSLCACertificatePath you need hash symlinks\n+#         to point to the certificate files. Use the provided\n+#         Makefile to update the hash symlinks after changes.\n+#SSLCACertificatePath @@ServerRoot@@/conf/ssl.crt\n+#SSLCACertificateFile @@ServerRoot@@/conf/ssl.crt/ca-bundle.crt\n+\n+#   Certificate Revocation Lists (CRL):\n+#   Set the CA revocation path where to find CA CRLs for client\n+#   authentication or alternatively one huge file containing all\n+#   of them (file must be PEM encoded)\n+#   Note: Inside SSLCARevocationPath you need hash symlinks\n+#         to point to the certificate files. Use the provided\n+#         Makefile to update the hash symlinks after changes.\n+#SSLCARevocationPath @@ServerRoot@@/conf/ssl.crl\n+#SSLCARevocationFile @@ServerRoot@@/conf/ssl.crl/ca-bundle.crl\n+\n+#   Client Authentication (Type):\n+#   Client certificate verification type and depth.  Types are\n+#   none, optional, require and optional_no_ca.  Depth is a\n+#   number which specifies how deeply to verify the certificate\n+#   issuer chain before deciding the certificate is not valid.\n+#SSLVerifyClient require\n+#SSLVerifyDepth  10\n+\n+#   Access Control:\n+#   With SSLRequire you can do per-directory access control based\n+#   on arbitrary complex boolean expressions containing server\n+#   variable checks and other lookup directives.  The syntax is a\n+#   mixture between C and Perl.  See the mod_ssl documentation\n+#   for more details.\n+#<Location />\n+#SSLRequire (    %{SSL_CIPHER} !~ m/^(EXP|NULL)/ \\\n+#            and %{SSL_CLIENT_S_DN_O} eq \"Snake Oil, Ltd.\" \\\n+#            and %{SSL_CLIENT_S_DN_OU} in {\"Staff\", \"CA\", \"Dev\"} \\\n+#            and %{TIME_WDAY} >= 1 and %{TIME_WDAY} <= 5 \\\n+#            and %{TIME_HOUR} >= 8 and %{TIME_HOUR} <= 20       ) \\\n+#           or %{REMOTE_ADDR} =~ m/^192\\.76\\.162\\.[0-9]+$/\n+#</Location>\n+\n+#   SSL Engine Options:\n+#   Set various options for the SSL engine.\n+#   o FakeBasicAuth:\n+#     Translate the client X.509 into a Basic Authorisation.  This means that\n+#     the standard Auth/DBMAuth methods can be used for access control.  The\n+#     user name is the `one line' version of the client's X.509 certificate.\n+#     Note that no password is obtained from the user. Every entry in the user\n+#     file needs this password: `xxj31ZMTZzkVA'.\n+#   o ExportCertData:\n+#     This exports two additional environment variables: SSL_CLIENT_CERT and\n+#     SSL_SERVER_CERT. These contain the PEM-encoded certificates of the\n+#     server (always existing) and the client (only existing when client\n+#     authentication is used). This can be used to import the certificates\n+#     into CGI scripts.\n+#   o StdEnvVars:\n+#     This exports the standard SSL/TLS related `SSL_*' environment variables.\n+#     Per default this exportation is switched off for performance reasons,\n+#     because the extraction step is an expensive operation and is usually\n+#     useless for serving static content. So one usually enables the\n+#     exportation for CGI and SSI requests only.\n+#   o CompatEnvVars:\n+#     This exports obsolete environment variables for backward compatibility\n+#     to Apache-SSL 1.x, mod_ssl 2.0.x, Sioux 1.0 and Stronghold 2.x. Use this\n+#     to provide compatibility to existing CGI scripts.\n+#   o StrictRequire:\n+#     This denies access when \"SSLRequireSSL\" or \"SSLRequire\" applied even\n+#     under a \"Satisfy any\" situation, i.e. when it applies access is denied\n+#     and no other module can change it.\n+#   o OptRenegotiate:\n+#     This enables optimized SSL connection renegotiation handling when SSL\n+#     directives are used in per-directory context. \n+#SSLOptions +FakeBasicAuth +ExportCertData +CompatEnvVars +StrictRequire\n+<Files ~ \"\\.(cgi|shtml|phtml|php3?)$\">\n+    SSLOptions +StdEnvVars\n+</Files>\n+<Directory \"@@ServerRoot@@/cgi-bin\">\n+    SSLOptions +StdEnvVars\n+</Directory>\n+\n+#   SSL Protocol Adjustments:\n+#   The safe and default but still SSL/TLS standard compliant shutdown\n+#   approach is that mod_ssl sends the close notify alert but doesn't wait for\n+#   the close notify alert from client. When you need a different shutdown\n+#   approach you can use one of the following variables:\n+#   o ssl-unclean-shutdown:\n+#     This forces an unclean shutdown when the connection is closed, i.e. no\n+#     SSL close notify alert is send or allowed to received.  This violates\n+#     the SSL/TLS standard but is needed for some brain-dead browsers. Use\n+#     this when you receive I/O errors because of the standard approach where\n+#     mod_ssl sends the close notify alert.\n+#   o ssl-accurate-shutdown:\n+#     This forces an accurate shutdown when the connection is closed, i.e. a\n+#     SSL close notify alert is send and mod_ssl waits for the close notify\n+#     alert of the client. This is 100% SSL/TLS standard compliant, but in\n+#     practice often causes hanging connections with brain-dead browsers. Use\n+#     this only for browsers where you know that their SSL implementation\n+#     works correctly. \n+#   Notice: Most problems of broken clients are also related to the HTTP\n+#   keep-alive facility, so you usually additionally want to disable\n+#   keep-alive for those clients, too. Use variable \"nokeepalive\" for this.\n+#   Similarly, one has to force some clients to use HTTP/1.0 to workaround\n+#   their broken HTTP/1.1 implementation. Use variables \"downgrade-1.0\" and\n+#   \"force-response-1.0\" for this.\n+SetEnvIf User-Agent \".*MSIE.*\" \\\n+         nokeepalive ssl-unclean-shutdown \\\n+         downgrade-1.0 force-response-1.0\n+\n+#   Per-Server Logging:\n+#   The home of a custom SSL log file. Use this when you want a\n+#   compact non-error SSL logfile on a virtual host basis.\n+CustomLog logs/ssl_request_log \\\n+          \"%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \\\"%r\\\" %b\"\n+\n+</VirtualHost>                                  \n+\n+</IfDefine>\n+"}, {"count": 1, "tags": [], "creator": "wrowe@apache.org", "is_private": false, "text": "\n  Adam, do not create yet another bug - reopen the old incident please next time!\n  Closing as a dup.  \n\n  The reason this patch won't be applied since we are trying to consolidate, \n  not expand the number of config source files.  \n\n  The conf has become broken in the past, with several critical changes missed \n  on one or more platforms.  This was due to multiple config source files.\n\n  The correct solution is a more complete .awk rewrite script, which was sitting\n  1/2 complete in my source tree.  It will be committed prior to any .49 release.\n\n  ", "id": 48006, "time": "2003-11-24T13:57:26Z", "bug_id": 24937, "creation_time": "2003-11-24T13:57:26Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "wrowe@apache.org", "text": "\n\n*** This bug has been marked as a duplicate of 24329 ***", "id": 48007, "time": "2003-11-24T13:58:12Z", "bug_id": 24937, "creation_time": "2003-11-24T13:58:12Z", "is_private": false, "attachment_id": null}]