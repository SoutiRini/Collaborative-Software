[{"count": 0, "tags": [], "creator": "mhilpert@gmx.de", "attachment_id": null, "text": "I have a chart graphics that can be drawn with or without anti-aliasing. When i \ndisplay the graphics in a JFrame, the anti-aliasing is correctly drawn (on or \noff). But when i want to save the very same graphics with the SVGGraphics2D \n(code see below), anti-aliasing behaves strange (svg file displayed in Internet \nExplorer (Acrobat SVG Plug-In) or embedded in PDF file displayed with Acrobat \nReader):\n\n1. graphics aliased (not anti-aliased) => svg file displays text/fonts anti-\naliased(!) and other drawings (lines, curves) aliased.\n2. graphics anti-aliased => svg file displays text/fonts aliased (!) and other \ndrawings anti-aliased.\n\nSetting rendering hints for SVGGraphics2D doesn't change anything.\n\nIt seems that there is some misbehaviour for aliased/anti-aliased fonts. And \nsetting rendering hints doesn't do anything.\n\n\nHere's the code to produce the SVG file:\n\n    /**\n     * Save chart to SVG file format.\n     * Requires Apache Batik library.\n     * \n     * @param chart JFreeChart to save.\n     * @param fileName Name of file to save .svg chart.\n     */\n    public void saveChartToSVG(JFreeChart chart, String fileName) {\n        if (chart != null) {\n            if (fileName == null) {\n                fileName = \"chart.svg\";\n            } \n            DOMImplementation domImpl = \nGenericDOMImplementation.getDOMImplementation();\n            Document document = domImpl.createDocument(null, \"svg\", null);\n            SVGGraphics2D svgGenerator = new SVGGraphics2D(document);\n            \n            //set anti-aliasing:\n            if (chart.getAntiAlias()) {\n                svgGenerator.setRenderingHint(RenderingHints.KEY_ANTIALIASING, \nRenderingHints.VALUE_ANTIALIAS_ON);\n            } else {\n                svgGenerator.setRenderingHint(RenderingHints.KEY_ANTIALIASING, \nRenderingHints.VALUE_ANTIALIAS_OFF);\n            }\n            \n            chart.draw(svgGenerator, new Rectangle2D.Double(0, 0, 400, 300), \nnull);\n            \n            boolean useCSS = true;\n            try {\n                Writer out = new OutputStreamWriter(new FileOutputStream(new \nFile(fileName)),\"iso-8859-1\"); //UTF-8\n                svgGenerator.stream(out, useCSS);\n            } catch (Exception e) {\n                System.err.println(\"saveChartToSVG() \"+e);\n            } finally {\n                svgGenerator.dispose();\n            }\n        }\n    }//saveChartToSVG()", "id": 43889, "time": "2003-09-09T14:17:17Z", "bug_id": 23030, "creation_time": "2003-09-09T14:17:17Z", "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 23030, "text": "Even setting text aliasing explicitaly doesn't help:\n\n            //set anti-aliasing:\n            if (chart.getAntiAlias()) {\n                svgGenerator.setRenderingHint(RenderingHints.KEY_ANTIALIASING, \nRenderingHints.VALUE_ANTIALIAS_ON);\n                svgGenerator.setRenderingHint\n(RenderingHints.KEY_TEXT_ANTIALIASING, RenderingHints.VALUE_TEXT_ANTIALIAS_ON);\n            } else {\n                svgGenerator.setRenderingHint(RenderingHints.KEY_ANTIALIASING, \nRenderingHints.VALUE_ANTIALIAS_OFF);\n                svgGenerator.setRenderingHint\n(RenderingHints.KEY_TEXT_ANTIALIASING, RenderingHints.VALUE_TEXT_ANTIALIAS_OFF);\n            }", "id": 43890, "time": "2003-09-09T14:36:37Z", "creator": "mhilpert@gmx.de", "creation_time": "2003-09-09T14:36:37Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 23030, "text": "Same effect when viewing with Squiggle (viewer that comes with Batik).", "id": 43892, "time": "2003-09-09T14:47:56Z", "creator": "mhilpert@gmx.de", "creation_time": "2003-09-09T14:47:56Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "i guess, i found the bug: text aliasing in SVGGraphics2D is broken - it inverts \nthe alias value. if i set the inverted value for text aliasing, the complete \ngraphics is correct:\n\n    /**\n     * Save chart to SVG file format.\n     * Requires Apache Batik library.\n     * \n     * @param chart JFreeChart to save.\n     * @param fileName Name of file to save .svg chart.\n     */\n    public void saveChartToSVG(JFreeChart chart, String fileName) {\n        if (chart != null) {\n            if (fileName == null) {\n                fileName = \"chart.svg\";\n            } \n            DOMImplementation domImpl = \nGenericDOMImplementation.getDOMImplementation();\n            Document document = domImpl.createDocument(null, \"svg\", null);\n            SVGGraphics2D svgGenerator = new SVGGraphics2D(document);\n\n            //set anti-aliasing:\n            System.out.println(\"anti-aliasing:\"+chart.getAntiAlias());\n            if (!chart.getAntiAlias()) { //anti-aliasing enabled? (Batik bugfix)\n                svgGenerator.setRenderingHint\n(RenderingHints.KEY_TEXT_ANTIALIASING, RenderingHints.VALUE_TEXT_ANTIALIAS_ON);\n            } else {\n                svgGenerator.setRenderingHint\n(RenderingHints.KEY_TEXT_ANTIALIASING, RenderingHints.VALUE_TEXT_ANTIALIAS_OFF);\n            }\n                        \n            chart.draw(svgGenerator, new Rectangle2D.Double(0, 0, 400, 300), \nnull);\n\n            boolean useCSS = true;\n            try {\n                Writer out = new OutputStreamWriter(new FileOutputStream(new \nFile(fileName)),\"iso-8859-1\"); //UTF-8\n                svgGenerator.stream(out, useCSS);\n            } catch (Exception e) {\n                System.err.println(\"saveChartToSVG() \"+e);\n            } finally {\n                svgGenerator.dispose();\n            }\n        }\n    }//saveChartToSVG()", "is_private": false, "bug_id": 23030, "id": 43895, "time": "2003-09-09T15:28:04Z", "creator": "mhilpert@gmx.de", "creation_time": "2003-09-09T15:28:04Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 23030, "is_private": false, "text": "This is fixed in CVS.", "id": 45189, "time": "2003-10-07T00:58:39Z", "creator": "deweese@apache.org", "creation_time": "2003-10-07T00:58:39Z", "attachment_id": null}]