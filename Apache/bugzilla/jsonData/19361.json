[{"count": 0, "attachment_id": null, "creator": "paul.fernley@sqlt.com", "is_private": false, "id": 36184, "time": "2003-04-27T07:42:11Z", "bug_id": 19361, "creation_time": "2003-04-27T07:42:11Z", "tags": [], "text": "Using a nested custom tag that creates a scripting variable leads Jasper to \ncreate invalid code. I don't believe that this is the same fault as bug # \n12432, but is possibly related. A sample tag handler class is:\n\npublic class TestTag extends TagSupport {\n    static int num = 1;\n    String val = null;\n\n    public void setVal(String val) {\n        this.val = val;\n    }\n\n    public int doStartTag() throws JspException {\n\n        /* Store the scripting variable */\n        pageContext.setAttribute(val, new Integer(num++));\n\n        return EVAL_BODY_INCLUDE;\n    }\n\n    public void release() {\n        val = null;\n    }\n}\n\nA sample JSP is:\n\n<%@ taglib prefix=\"lib\" uri=\"/testlib\" %>\n<HTML>\n<BODY>\n    <lib:testtag val=\"one\">\n        <lib:testtag val=\"two\"/>\n        <p>Val after the inner tag is <%=two%></p>\n    </lib:testtag>\n    <p>Val after the outer tag is <%=one%></p>\n</BODY>\n</HTML>\n\nThe sample output is:\n\n  Val after the inner tag is null\n\n  Val after the outer tag is 1\n\nI think that the 'Val after the inner tag' should be 2 (at least, that's the \nway it worked in Tomcat v3.x and also in other containers such as JRun)."}, {"count": 1, "tags": [], "creator": "kin-man.chung@sun.com", "text": "Fixed in CVS", "id": 54767, "time": "2004-03-27T01:06:28Z", "bug_id": 19361, "creation_time": "2004-03-27T01:06:28Z", "is_private": false, "attachment_id": null}]