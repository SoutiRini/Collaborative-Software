[{"count": 0, "tags": [], "creator": "bruce_rice@yahoo.com", "attachment_id": null, "id": 42638, "time": "2003-08-12T16:00:48Z", "bug_id": 22353, "creation_time": "2003-08-12T16:00:48Z", "is_private": false, "text": "We have been using Tomcat along with MCVE (a credit card payment engine) for\nsome time.  We have it working with Tomcat 4.1.24 just fine.  When we tried\ntesting it out with Tomcat 4.1.27, we started getting this error.\n\nAn unexpected exception has been detected in native code outside the VM.\nUnexpected Signal : 11 occurred at PC=0x4002ACF2\nFunction=__pthread_mutex_lock+0x12\nLibrary=/lib/i686/libpthread.so.0\n\nCurrent Java thread:\n        at com.mainstreetsoftworks.MCVE.M_DestroyConn(Native Method)\n        at com.mainstreetsoftworks.MCVE.finalize(MCVE.java:15)\n        at java.lang.ref.Finalizer.invokeFinalizeMethod(Native Method)\n        at java.lang.ref.Finalizer.runFinalizer(Finalizer.java:83)\n        at java.lang.ref.Finalizer.access$100(Finalizer.java:14)\n        at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:160)\n\nAm running Redhat 8.0 (kernel 2.4.20-19.8) with Sun java version 1.4.2.  We are\nusing the newest MCVE Java API 3.1 which is build on the MCVE C API 3.2.1. These\nlibraries can be downloaded from http://www.mcve.com/?page=17.  \n\nThe error only seems to come when the MCVE.finalize() is called.  This however\nis what closes the connection to MCVE.  Without this call the socket connections\nare left open and can start to be a problem.\n\nHere is the error log that gets genereated:\nAn unexpected exception has been detected in native code outside the VM.\nUnexpected Signal : 11 occurred at PC=0x4EE1C4F3\nFunction=Java_com_mainstreetsoftworks_MCVE_M_1DestroyConn+0x1D\nLibrary=/usr/java/j2sdk1.4.2/jre/lib/i386/libmcvejni.so\n\nCurrent Java thread:\n\tat com.mainstreetsoftworks.MCVE.M_DestroyConn(Native Method)\n\tat com.mainstreetsoftworks.MCVE.finalize(MCVE.java:15)\n\tat java.lang.ref.Finalizer.invokeFinalizeMethod(Native Method)\n\tat java.lang.ref.Finalizer.runFinalizer(Finalizer.java:83)\n\tat java.lang.ref.Finalizer.access$100(Finalizer.java:14)\n\tat java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:160)\n\nDynamic libraries:\n08048000-0804e000 r-xp 00000000 03:09 276833     /usr/java/j2sdk1.4.2/bin/java\n0804e000-0804f000 rw-p 00005000 03:09 276833     /usr/java/j2sdk1.4.2/bin/java\n40000000-40013000 r-xp 00000000 03:03 71485      /lib/ld-2.3.2.so\n40013000-40014000 rw-p 00013000 03:03 71485      /lib/ld-2.3.2.so\n40014000-4001c000 r-xp 00000000 03:09 601211    \n/usr/java/j2sdk1.4.2/jre/lib/i386/native_threads/libhpi.so\n4001c000-4001d000 rw-p 00007000 03:09 601211    \n/usr/java/j2sdk1.4.2/jre/lib/i386/native_threads/libhpi.so\n40021000-40024000 r--s 00000000 03:09 633999    \n/usr/java/j2sdk1.4.2/jre/lib/ext/dnsns.jar\n40024000-40031000 r-xp 00000000 03:03 79565      /lib/i686/libpthread-0.10.so\n40031000-40034000 rw-p 0000d000 03:03 79565      /lib/i686/libpthread-0.10.so\n40075000-40077000 r-xp 00000000 03:03 71414      /lib/libdl-2.3.2.so\n40077000-40078000 rw-p 00002000 03:03 71414      /lib/libdl-2.3.2.so\n40078000-4046f000 r-xp 00000000 03:09 634006    \n/usr/java/j2sdk1.4.2/jre/lib/i386/client/libjvm.so\n4046f000-4048a000 rw-p 003f6000 03:09 634006    \n/usr/java/j2sdk1.4.2/jre/lib/i386/client/libjvm.so\n4049d000-404b0000 r-xp 00000000 03:03 71418      /lib/libnsl-2.3.2.so\n404b0000-404b1000 rw-p 00012000 03:03 71418      /lib/libnsl-2.3.2.so\n404b3000-404d4000 r-xp 00000000 03:03 79563      /lib/i686/libm-2.3.2.so\n404d4000-404d5000 rw-p 00021000 03:03 79563      /lib/i686/libm-2.3.2.so\n404d5000-404e2000 r--s 00000000 03:09 634000    \n/usr/java/j2sdk1.4.2/jre/lib/ext/ldapsec.jar\n404e2000-404e5000 r--s 00000000 03:05 1233088   \n/web/tomcat-4.1.27/bin/commons-daemon.jar\n404e5000-404f0000 r-xp 00000000 03:03 71434      /lib/libnss_files-2.3.2.so\n404f0000-404f1000 rw-p 0000a000 03:03 71434      /lib/libnss_files-2.3.2.so\n404f1000-40501000 r-xp 00000000 03:09 1250648   \n/usr/java/j2sdk1.4.2/jre/lib/i386/libverify.so\n40501000-40503000 rw-p 0000f000 03:09 1250648   \n/usr/java/j2sdk1.4.2/jre/lib/i386/libverify.so\n40503000-40523000 r-xp 00000000 03:09 1250634   \n/usr/java/j2sdk1.4.2/jre/lib/i386/libjava.so\n40523000-40525000 rw-p 0001f000 03:09 1250634   \n/usr/java/j2sdk1.4.2/jre/lib/i386/libjava.so\n40525000-40539000 r-xp 00000000 03:09 1250649   \n/usr/java/j2sdk1.4.2/jre/lib/i386/libzip.so\n40539000-4053c000 rw-p 00013000 03:09 1250649   \n/usr/java/j2sdk1.4.2/jre/lib/i386/libzip.so\n4053c000-40617000 r--s 00000000 03:05 1135873   \n/web/tomcat-4.1.27/common/endorsed/xercesImpl.jar\n40617000-40636000 r--s 00000000 03:05 1135874   \n/web/tomcat-4.1.27/common/endorsed/xmlParserAPIs.jar\n40636000-41fc1000 r--s 00000000 03:09 569111     /usr/java/j2sdk1.4.2/jre/lib/rt.jar\n41fc1000-41fd7000 r--s 00000000 03:09 569110    \n/usr/java/j2sdk1.4.2/jre/lib/sunrsasign.jar\n41fd7000-41fe8000 r--s 00000000 03:09 568889    \n/usr/java/j2sdk1.4.2/jre/lib/jce.jar\n41fe8000-41fee000 r--s 00000000 03:05 1233089   \n/web/tomcat-4.1.27/bin/bootstrap.jar\n41fee000-41ff4000 r--s 00000000 03:05 1054614   \n/web/tomcat-4.1.27/common/lib/commons-logging-api.jar\n41ff4000-41ff6000 r--s 00000000 03:05 1054616   \n/web/tomcat-4.1.27/common/lib/jdbc2_0-stdext.jar\n41ff6000-41ffe000 r--s 00000000 03:05 1054617   \n/web/tomcat-4.1.27/common/lib/commons-pool.jar\n41ffe000-42000000 r--s 00000000 03:05 438073    \n/web/tomcat-4.1.27/server/lib/servlets-invoker.jar\n42000000-42134000 r-xp 00000000 03:03 79568      /lib/i686/libc-2.3.2.so\n42134000-42139000 rw-p 00134000 03:03 79568      /lib/i686/libc-2.3.2.so\n42185000-42260000 r--s 00000000 03:09 569109    \n/usr/java/j2sdk1.4.2/jre/lib/jsse.jar\n42260000-427b9000 r--s 00000000 03:09 568890    \n/usr/java/j2sdk1.4.2/jre/lib/charsets.jar\n44861000-44866000 r--s 00000000 03:05 1054619   \n/web/tomcat-4.1.27/common/lib/naming-factory.jar\n44866000-44870000 r--s 00000000 03:05 1054623   \n/web/tomcat-4.1.27/common/lib/naming-resources.jar\n4ca73000-4cc73000 r--p 00000000 03:09 212127     /usr/lib/locale/locale-archive\n4ce77000-4cf33000 r--s 00000000 03:09 634007    \n/usr/java/j2sdk1.4.2/jre/lib/ext/localedata.jar\n4cf33000-4cf4f000 r--s 00000000 03:09 634002    \n/usr/java/j2sdk1.4.2/jre/lib/ext/sunjce_provider.jar\n4cf4f000-4d42b000 r--s 00000000 03:09 1136335    /usr/java/j2sdk1.4.2/lib/tools.jar\n4d42b000-4d43f000 r--s 00000000 03:05 1054612   \n/web/tomcat-4.1.27/common/lib/servlet.jar\n4d43f000-4d484000 r--s 00000000 03:05 1054613   \n/web/tomcat-4.1.27/common/lib/mail.jar\n4d484000-4d4ad000 r--s 00000000 03:05 1054615   \n/web/tomcat-4.1.27/common/lib/commons-collections.jar\n4d4ad000-4d4da000 r--s 00000000 03:05 1054618   \n/web/tomcat-4.1.27/common/lib/jasper-compiler.jar\n4d4da000-4d4f3000 r--s 00000000 03:05 1054620   \n/web/tomcat-4.1.27/common/lib/jndi.jar\n4d4f3000-4d4ff000 r--s 00000000 03:05 1054621   \n/web/tomcat-4.1.27/common/lib/activation.jar\n4d4ff000-4d511000 r--s 00000000 03:05 1054622   \n/web/tomcat-4.1.27/common/lib/jasper-runtime.jar\n4d511000-4d518000 r--s 00000000 03:05 1054624   \n/web/tomcat-4.1.27/common/lib/naming-common.jar\n4d518000-4d528000 r--s 00000000 03:05 1054625   \n/web/tomcat-4.1.27/common/lib/commons-dbcp.jar\n4d528000-4d5dd000 r--s 00000000 03:05 1054626   \n/web/tomcat-4.1.27/common/lib/ant.jar\n4d5dd000-4d5e0000 r--s 00000000 03:05 1054627   \n/web/tomcat-4.1.27/common/lib/jta.jar\n4d5e0000-4d6ff000 r--s 00000000 03:05 65052     \n/web/tomcat-4.1.27/common/lib/ojdbc14.jar\n4d6ff000-4d753000 r--s 00000000 03:05 438069    \n/web/tomcat-4.1.27/server/lib/mx4j-jmx.jar\n4d753000-4d75b000 r--s 00000000 03:05 438070    \n/web/tomcat-4.1.27/server/lib/commons-logging.jar\n4d75b000-4d776000 r--s 00000000 03:05 438071    \n/web/tomcat-4.1.27/server/lib/commons-digester.jar\n4d776000-4d77b000 r--s 00000000 03:05 438074    \n/web/tomcat-4.1.27/server/lib/servlets-manager.jar\n4d77b000-4d783000 r--s 00000000 03:05 438075    \n/web/tomcat-4.1.27/server/lib/commons-modeler.jar\n4d783000-4d788000 r--s 00000000 03:05 438076    \n/web/tomcat-4.1.27/server/lib/servlets-default.jar\n4d788000-4d792000 r--s 00000000 03:05 438077    \n/web/tomcat-4.1.27/server/lib/tomcat-http11.jar\n4d792000-4d7bb000 r--s 00000000 03:05 438079    \n/web/tomcat-4.1.27/server/lib/tomcat-util.jar\n4d7bb000-4d873000 r--s 00000000 03:05 438080    \n/web/tomcat-4.1.27/server/lib/catalina.jar\n4d873000-4d890000 r--s 00000000 03:05 438081    \n/web/tomcat-4.1.27/server/lib/commons-beanutils.jar\n4d890000-4d8a0000 r--s 00000000 03:05 438082    \n/web/tomcat-4.1.27/server/lib/tomcat-coyote.jar\n4d8a0000-4d8ba000 r--s 00000000 03:05 438083    \n/web/tomcat-4.1.27/server/lib/jaas.jar\n4d8ba000-4d8bc000 r--s 00000000 03:05 438085    \n/web/tomcat-4.1.27/server/lib/servlets-common.jar\n4d8bc000-4d8c2000 r--s 00000000 03:05 438086    \n/web/tomcat-4.1.27/server/lib/servlets-webdav.jar\n4d8c2000-4d8c8000 r--s 00000000 03:05 438087    \n/web/tomcat-4.1.27/server/lib/tomcat-warp.jar\n4d8c8000-4d8cc000 r--s 00000000 03:05 438088    \n/web/tomcat-4.1.27/server/lib/catalina-ant.jar\n4d8cc000-4d8e0000 r--s 00000000 03:05 438089    \n/web/tomcat-4.1.27/server/lib/tomcat-jk2.jar\n4d8e0000-4d8e6000 r--s 00000000 03:05 438090    \n/web/tomcat-4.1.27/server/lib/commons-fileupload-1.0.jar\n4d8e6000-4d8ee000 r--s 00000000 03:05 438091    \n/web/tomcat-4.1.27/server/lib/jakarta-regexp-1.2.jar\n4d8ee000-4d8fe000 r--s 00000000 03:05 438092    \n/web/tomcat-4.1.27/server/lib/tomcat-jk.jar\n4d8fe000-4d90e000 r-xp 00000000 03:09 1250645   \n/usr/java/j2sdk1.4.2/jre/lib/i386/libnet.so\n4d90e000-4d90f000 rw-p 0000f000 03:09 1250645   \n/usr/java/j2sdk1.4.2/jre/lib/i386/libnet.so\n4d90f000-4d91b000 r--s 00000000 03:05 64899     \n/web/tomcat-4.1.27/shared/lib/activation.jar\n4d91b000-4d91d000 r--s 00000000 03:05 65034     \n/web/tomcat-4.1.27/shared/lib/jaxp.jar\n4d91d000-4d91f000 r--s 00000000 03:05 65036     \n/web/tomcat-4.1.27/shared/lib/jcert.jar\n4d91f000-4d92a000 r-xp 00000000 03:03 71442      /lib/libnss_nisplus-2.3.2.so\n4d92a000-4d92b000 rw-p 0000a000 03:03 71442      /lib/libnss_nisplus-2.3.2.so\n4d92b000-4d92e000 r-xp 00000000 03:03 71431      /lib/libnss_dns-2.3.2.so\n4d92e000-4d92f000 rw-p 00003000 03:03 71431      /lib/libnss_dns-2.3.2.so\n4d92f000-4d93e000 r-xp 00000000 03:03 71446      /lib/libresolv-2.3.2.so\n4d93e000-4d93f000 rw-p 0000f000 03:03 71446      /lib/libresolv-2.3.2.so\n4d941000-4d9bb000 r--s 00000000 03:05 1054611   \n/web/tomcat-4.1.27/server/webapps/admin/WEB-INF/lib/struts.jar\n4d9bb000-4da0c000 r--s 00000000 03:05 64900     \n/web/tomcat-4.1.27/shared/lib/ant.jar\n4da0c000-4da1e000 r--s 00000000 03:05 64901     \n/web/tomcat-4.1.27/shared/lib/antlr.jar\n4da1e000-4da28000 r--s 00000000 03:05 65027     \n/web/tomcat-4.1.27/shared/lib/classgen.jar\n4da28000-4da2f000 r--s 00000000 03:05 65029     \n/web/tomcat-4.1.27/shared/lib/commons-logging.jar\n4da2f000-4da30000 r--s 00000000 03:05 65038     \n/web/tomcat-4.1.27/shared/lib/jnet.jar\n4da30000-4da31000 r--s 00000000 03:05 65048     \n/web/tomcat-4.1.27/shared/lib/MCVE.jar\n4dab6000-4db30000 r--s 00000000 03:05 1054611   \n/web/tomcat-4.1.27/server/webapps/admin/WEB-INF/lib/struts.jar\n4e5c5000-4e623000 r--s 00000000 03:05 64902     \n/web/tomcat-4.1.27/shared/lib/axis-ant.jar\n4e623000-4e74f000 r--s 00000000 03:05 64903     \n/web/tomcat-4.1.27/shared/lib/axis.jar\n4e74f000-4e769000 r--s 00000000 03:05 64904     \n/web/tomcat-4.1.27/shared/lib/bsf.jar\n4e769000-4e79b000 r--s 00000000 03:05 64905     \n/web/tomcat-4.1.27/shared/lib/checkstyle-2.4.jar\n4e79b000-4e7e5000 r--s 00000000 03:05 65026     \n/web/tomcat-4.1.27/shared/lib/checkstyle-all-2.4.jar\n4e7e5000-4e7f6000 r--s 00000000 03:05 65028     \n/web/tomcat-4.1.27/shared/lib/commons-discovery.jar\n4e7f6000-4e847000 r--s 00000000 03:05 65030     \n/web/tomcat-4.1.27/shared/lib/com_nicusa.jar\n4e847000-4e855000 r--s 00000000 03:05 65031     \n/web/tomcat-4.1.27/shared/lib/gnu_regexp.jar\n4e855000-4eaf0000 r--s 00000000 03:05 65032     \n/web/tomcat-4.1.27/shared/lib/ii.jar\n4eaf0000-4eaf8000 r--s 00000000 03:05 65033     \n/web/tomcat-4.1.27/shared/lib/jakarta-regexp-1.2.jar\n4eaf8000-4eb01000 r--s 00000000 03:05 65035     \n/web/tomcat-4.1.27/shared/lib/jaxrpc.jar\n4eb01000-4ebc6000 r--s 00000000 03:05 65037     \n/web/tomcat-4.1.27/shared/lib/jconn2.jar\n4ebc6000-4ec26000 r--s 00000000 03:05 65039     \n/web/tomcat-4.1.27/shared/lib/js.jar\n4ec26000-4ec98000 r--s 00000000 03:05 65040     \n/web/tomcat-4.1.27/shared/lib/jsse.jar\n4ec98000-4ecbb000 r--s 00000000 03:05 65041     \n/web/tomcat-4.1.27/shared/lib/kicfw.jar\n4ed3c000-4ed45000 r--s 00000000 03:05 65042     \n/web/tomcat-4.1.27/shared/lib/kic.jar\n4ed45000-4ed4d000 r--s 00000000 03:05 65043     \n/web/tomcat-4.1.27/shared/lib/ldapfilt.jar\n4ed4d000-4ed78000 r--s 00000000 03:05 65044     \n/web/tomcat-4.1.27/shared/lib/ldapjdk.jar\n4ed78000-4edd5000 r--s 00000000 03:05 65046     \n/web/tomcat-4.1.27/shared/lib/log4j-1.2.4.jar\n4edd5000-4ee1a000 r--s 00000000 03:05 65047     \n/web/tomcat-4.1.27/shared/lib/mail.jar\n4ee1a000-4ee1f000 r-xp 00000000 03:09 1250413   \n/usr/java/j2sdk1.4.2/jre/lib/i386/libmcvejni.so\n4ee1f000-4ee20000 rw-p 00004000 03:09 1250413   \n/usr/java/j2sdk1.4.2/jre/lib/i386/libmcvejni.so\n4ee20000-4ee26000 r--s 00000000 03:09 292227     /usr/lib/gconv/gconv-modules.cache\n4ee30000-4ee39000 r-xp 00000000 03:08 178466     /usr/local/lib/libmcve.so.0.0.0\n4ee39000-4ee3a000 rw-p 00009000 03:08 178466     /usr/local/lib/libmcve.so.0.0.0\n4ee3a000-4ee67000 r-xp 00000000 03:03 71406      /lib/libssl.so.0.9.6b\n4ee67000-4ee6a000 rw-p 0002d000 03:03 71406      /lib/libssl.so.0.9.6b\n4ee6a000-4ef2f000 r-xp 00000000 03:03 71404      /lib/libcrypto.so.0.9.6b\n4ef2f000-4ef3b000 rw-p 000c4000 03:03 71404      /lib/libcrypto.so.0.9.6b\n\nHeap at VM Abort:\nHeap\n def new generation   total 704K, used 64K [0x44870000, 0x44930000, 0x44d50000)\n  eden space 640K,   0% used [0x44870000, 0x448700e8, 0x44910000)\n  from space 64K, 100% used [0x44910000, 0x44920000, 0x44920000)\n  to   space 64K,   0% used [0x44920000, 0x44920000, 0x44930000)\n tenured generation   total 8816K, used 5304K [0x44d50000, 0x455ec000, 0x48870000)\n   the space 8816K,  60% used [0x44d50000, 0x4527e1f8, 0x4527e200, 0x455ec000)\n compacting perm gen  total 8704K, used 8485K [0x48870000, 0x490f0000, 0x4c870000)\n   the space 8704K,  97% used [0x48870000, 0x490b94f8, 0x490b9600, 0x490f0000)\n\nLocal Time = Fri Aug  8 16:39:16 2003\nElapsed Time = 45\n#\n# The exception above was detected in native code outside the VM\n#\n# Java VM: Java HotSpot(TM) Client VM (1.4.2-b28 mixed mode)\n#"}, {"count": 1, "tags": [], "bug_id": 22353, "attachment_id": null, "text": "This looks like a bug with MCVE that is exposed when upgrading tomcat, not a\ntomcat bug.", "id": 52262, "time": "2004-02-13T20:40:50Z", "creator": "funkman@joedog.org", "creation_time": "2004-02-13T20:40:50Z", "is_private": false}]