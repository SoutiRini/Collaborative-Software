[{"count": 0, "tags": [], "bug_id": 43694, "attachment_id": null, "is_private": false, "id": 109711, "time": "2007-10-24T12:04:07Z", "creator": "dmitry@ardas.dp.ua", "creation_time": "2007-10-24T12:04:07Z", "text": "If ForEach Controller used in the cycle and input collection is empty at the\nfirst n iterations and not empty starting from the n+1 iteration then ForEach\nstarts to process collections from n+1 element.\n\nExample\nShort plan description:\nThread Group\n-While (several times)\n--HTTP Request\n---RegExp Extractor (receives collection \u2018input\u2019)\t\t\n--ForEach (input:out)\n---HTTP Request using out value\n\nFirst iteration: input is empty\nSecond iteration: input {element1, element2, element3}\nFor each will process started from element2."}, {"count": 1, "tags": [], "bug_id": 43694, "attachment_id": null, "is_private": false, "id": 109714, "time": "2007-10-24T12:18:04Z", "creator": "dmitry@ardas.dp.ua", "creation_time": "2007-10-24T12:18:04Z", "text": "\n(In reply to comment #0)\n> If ForEach Controller used in the cycle and input collection is empty at the\n> first n iterations and not empty starting from the n+1 iteration then ForEach\n> starts to process collections from n+1 element.\n> \n> Example\n> Short plan description:\n> Thread Group\n> -While (several times)\n> --HTTP Request\n> ---RegExp Extractor (receives collection \u2018input\u2019)\t\t\n> --ForEach (input:out)\n> ---HTTP Request using out value\n> \n> First iteration: input is empty\n> Second iteration: input {element1, element2, element3}\n> For each will process started from element2.\n\nSeems the problem in the org.apache.jmeter.control.ForeachController.next() method. \n\nAs I understand, It should reset loop counter if collection is empty.\n\n public Sampler next() {\n\tif (emptyList()) {\n\t\treInitialize();\n+\t\tresetLoopCount();\n\t\treturn null;\n\t}\n\treturn super.next();\n }\n\n"}, {"count": 2, "tags": [], "creator": "sebb@apache.org", "text": "Thanks very much for the report and the patch.\n\nI can confirm the problem, and the patch fixes it - good work.\n\nApplied to SVN in r588094", "id": 109724, "time": "2007-10-24T17:36:12Z", "bug_id": 43694, "creation_time": "2007-10-24T17:36:12Z", "is_private": false, "attachment_id": null}]