[{"count": 0, "tags": [], "bug_id": 56812, "attachment_id": 31873, "is_private": false, "id": 176878, "time": "2014-08-04T16:00:16Z", "creator": "geoff@wrightville.org", "creation_time": "2014-08-04T16:00:16Z", "text": "Created attachment 31873\nPowerpoint file with three pictures. First picture is embedded, second picture is linked and embedded, third picture is only linked.\n\nWhen adding a picture to a PowerPoint presentation, you can embed the file or link to it. The embedded filename can be accessed using:\n\nXSLFPictureData data = ((XSLFPictureShape) shape).getPictureData();\nSystem.out.println(data.getFileName());\n\noutput:\n\norg.apache.poi.xslf.usermodel.XSLFPictureShape@654df764\nimage7.png\n\nHowever, when the picture is not embedded but inserted only as a \"link to file\", there is no data available and the above code produces a null pointer exception.\n\nIs it possible to add a reference to the linked picture file ?"}, {"count": 1, "tags": [], "creator": "geoff@wrightville.org", "attachment_id": 31874, "text": "Created attachment 31874\nCode to demonstrate null pointer error when picture is only linked (third picture in attached Powerpoint file).\n\nThe third picture in the referenced Powerpoint file is a linked picture (not embedded). data.getFilename() returns a null pointer exception but it would be useful if it returned the name of the linked picture file.", "id": 176879, "time": "2014-08-04T16:03:30Z", "bug_id": 56812, "creation_time": "2014-08-04T16:03:30Z", "is_private": false}, {"count": 2, "tags": [], "text": "Thanks for this, I've used it to add a disabled unit test in r1615803.", "attachment_id": null, "bug_id": 56812, "id": 176889, "time": "2014-08-04T21:35:28Z", "creator": "apache@gagravarr.org", "creation_time": "2014-08-04T21:35:28Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 56812, "attachment_id": null, "is_private": false, "id": 176890, "time": "2014-08-04T22:02:24Z", "creator": "apache@gagravarr.org", "creation_time": "2014-08-04T22:02:24Z", "text": "Fixed in r1615812.\n\nXSLFPictureShape now provides a method isExternalLinkedPicture(), which lets you check if it'll have a picture data or not. If not, you can use getPictureLink() to get the URI of the externally linked image.\n\n(You can't get a XSLFPictureData as the data isn't in the pptx file)"}]