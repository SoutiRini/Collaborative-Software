[{"count": 0, "tags": [], "bug_id": 45732, "attachment_id": null, "text": "on evaluation of this formala NPER(12,4500,100000.0,100000.0) (this formula contain VALUE error ) POI give NumericCellValue = 15\n\n\nCell Formula is : NPER(12,4500,100000.0,100000.0)\nCell RichStringValue is : \nCell NumericCellValue is : 15.0", "id": 120304, "time": "2008-09-02T21:48:40Z", "creator": "umairiqbal@gmail.com", "creation_time": "2008-09-02T21:48:40Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 45732, "is_private": false, "count": 1, "id": 120697, "time": "2008-09-16T17:01:00Z", "creator": "josh@apache.org", "creation_time": "2008-09-16T17:01:00Z", "text": "It looks like POI calculates NPER OK.  Excel gives a result of #NUM! for the example parameters, and so does POI. FinanceLib.nper has not changed in a long time (2005), so recent versions of POI should be OK too.\n\nYou didn't attach any example code, but I am guessing that you were using the method HSSFFormulaEvaluator.evaluateFormulaCell(), and calling HSSFCell.getNumericCellValue() to check the result.  Prior to svn r694631 POI did not write error result codes back to the cached formula value, so this could explain your observations.\n\nA new test case (TestNper.testEvaluate_bug_45732) has been checked in (svn 696109) which produces behaviour like you have described.\n\nNote also, since svn r694631 a new method has become available:\nHSSFCell.getCachedFormulaResultType(), which can take the trial and error out of determining which getter method value type to use when reading formula cell cached values. \n\n"}]