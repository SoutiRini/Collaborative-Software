[{"count": 0, "tags": [], "bug_id": 6803, "text": "[ 517014 ] Files created w. POI 1.2 crashes excel\nEmail:    (?)\nDate:\n2002-02-13 07:19 Priority:\n5\nSubmitted By:\nLorenzo Resta (lresta) Assigned To:\nGlen Stampoultzis (gstamp)\nCategory:\nHSSF API Status:\nOpen\nSummary:\nFiles created w. POI 1.2 crashes excel\nHi,\n\nI tried to create Excel files POI-HSSF 1.2 and i am\nhaving following problem: Excel crashes immediately\nafter opening the created file. This problem did not\nhappen with POI 1.0.2. Funny enough POI 1.2 is able to\nopen this without any problem.\n\nI have attached the file that crashes Excel.\n\nThanks\n\nLorenzo\n\nAdd A Comment:\nPlease log in!\n\nIf you cannot login, then enter your email address here:\n\nDO NOT enter passwords or confidential information in your message!\n\nFollowups:\n\nMessage\n\nDate: 2002-02-14 06:31\nSender: lresta\nLogged In: YES \nuser_id=450634\n\nHi Andi,\n\nThanks for the quick reply. I tried to track the problem \nand now i believe to know where the problem lies:\n\nIf the read in Excel file had blank cells and i then change \nsuch a blank cell to a String type and set a value to that \ncell the then written Excel file is not readable by Excel \nor even crashes Excel. If i then reopen that modified file \nagain with HSSF and immediately write it back, then Excel \nis able again to open it.\n\nCheers\n\nLorenzo\n\n\npackage com.forumedia.dwb.spreadsheet.adapter.excel;\n\nimport net.sourceforge.poi.hssf.usermodel.HSSFCellStyle;\nimport net.sourceforge.poi.hssf.usermodel.HSSFCell;\nimport com.forumedia.dwb.spreadsheet.StringCellIF;\n\npublic class ExcelStringCellAdapter extends  \nExcelCellAdapter implements StringCellIF {\n\nprotected ExcelStringCellAdapter(HSSFCell anExcelCell){\n super(anExcelCell);\n}\n\npublic Object getValue(){\n return getExcelCell().getStringCellValue();\n}\n\npublic void setValue(Object aValue){\n        \n//If cell is of type BLANK, change it to String\nif(getExcelCell().getCellType() == HSSFCell.CELL_TYPE_BLANK)\n{\n  getExcelCell().setCellType(HSSFCell.CELL_TYPE_STRING);\n}\n                \ngetExcelCell().setCellValue(aValue.toString());\n}\n\n}\n\nDate: 2002-02-13 08:03\nSender: acoliver2\nLogged In: YES \nuser_id=287767\n\nCan you attach some sourcecode that demonstrates how you \nare creating workbooks?\n\n-Andy\n\nAttached Files:\nName Description Download\nCountry3.XLS Download\nChanges:\n\nField Old Value Date By\nFile Added 17807: Country3.XLS 2002-02-13 07:19 lresta", "id": 11366, "time": "2002-03-01T21:17:27Z", "creator": "poi-support@buni.org", "creation_time": "2002-03-01T21:17:27Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 6803, "text": "This seems to be working with 1.5 prerelease (I could not reproduce it at any \nrate).  Could you try again please?", "id": 11688, "time": "2002-03-12T11:41:57Z", "creator": "glens@apache.org", "creation_time": "2002-03-12T11:41:57Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 6803, "text": "Since no further correspondence on this bug has been provided and I have been \nunable to reproduce the problem I am closing this bug.", "id": 12559, "time": "2002-03-30T23:49:49Z", "creator": "glens@apache.org", "creation_time": "2002-03-30T23:49:49Z", "is_private": false, "attachment_id": null}]