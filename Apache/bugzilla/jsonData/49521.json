[{"count": 0, "tags": [], "bug_id": 49521, "attachment_id": null, "is_private": false, "id": 137984, "time": "2010-06-29T10:14:35Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2010-06-29T10:14:35Z", "text": "There is a feature in org.apache.jk.server.JkCoyoteHandler implementation of AJP/1.3 protocol: when connector fails to bind to the specified port, it does not fail immediately but will try next available port number.\n\nThis was previously discussed in the following threads:\nhttp://marc.info/?t=126402175600004&r=1&w=2\nhttp://marc.info/?t=119266320200003&r=1&w=2\n\nThis feature is implemented in the org.apache.jk.common.ChannelSocket and ChannelNioSocket classes and can be controlled by setting channelSocket.maxPort property on a <Connector/>, but there is a bug:\n\nChannelSocket#setPort(int) resets the value of maxPort, and thus the final configuration is dependent on the order in which the XML attributes were processed.\n\n\nThis concerns only JkCoyoteHandler implementation of the protocol, present in Tomcat 5.5 and 6.0. The new AjpProtocol implementation present in 6.0 and used by default in Tomcat 7.0, as well AjpAprProtocol are not affected."}, {"count": 1, "tags": [], "creator": "knst.kolinko@gmail.com", "attachment_id": 25657, "id": 137985, "time": "2010-06-29T10:20:40Z", "bug_id": 49521, "creation_time": "2010-06-29T10:20:40Z", "is_private": false, "text": "Created attachment 25657\n2010-06-29_tc6_maxPort.patch\n\nPatch for tc6.0.x\nIt does the following:\n- implements <Connector maxPort=\"\"/> as a synonym for <Connector channelSocket.maxPort=\"\"/>\n- implements workaround for this issue, so that the channelSocket.maxPort property, if present, is applied later than the others"}, {"count": 2, "tags": [], "bug_id": 49521, "attachment_id": 25657, "is_private": false, "id": 138500, "time": "2010-07-17T19:09:20Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2010-07-17T19:09:20Z", "text": "Comment on attachment 25657\n2010-06-29_tc6_maxPort.patch\n\nProposed a different patch for 6.0 and 5.5"}, {"count": 3, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 140071, "time": "2010-09-22T11:04:17Z", "bug_id": 49521, "creation_time": "2010-09-22T11:04:17Z", "is_private": false, "text": "Fixed in 6.0.x and will be included in 6.0.30 onwards."}, {"count": 4, "tags": [], "creator": "knst.kolinko@gmail.com", "attachment_id": null, "id": 141518, "time": "2010-11-07T00:25:37Z", "bug_id": 49521, "creation_time": "2010-11-07T00:25:37Z", "is_private": false, "text": "Fixed in 5.5.x and will be in 5.5.32 onwards."}]