[{"attachment_id": null, "tags": [], "bug_id": 56575, "text": "I have a user that reported an issue with Tomcat8 + Ubuntu, where the same websocket application would work without any issue with Tomcat8 + Window:\n\n   https://groups.google.com/forum/#!topic/atmosphere-framework/-exX6IKdB9s\n\nSeveral users also reported similar issue with Tomcat 8, not only on Ubuntu, but it is extremely hard to reproduce. But the user above was able to reproduce it 100% of the time. The observed exception is\n\n06:38:07.568 ERROR [http-nio-8080-exec-2] o.a.c.AtmosphereFramework [AtmosphereFramework.java:1822] AtmosphereFramework exception\njava.lang.IllegalStateException: Not supported.\n\tat org.apache.catalina.connector.Request.startAsync(Request.java:1604) ~[catalina.jar:8.0.5]\n\tat org.apache.catalina.connector.RequestFacade.startAsync(RequestFacade.java:1037) ~[catalina.jar:8.0.5]\n\tat org.atmosphere.cpr.AtmosphereRequest.startAsync(AtmosphereRequest.java:692) ~[AtmosphereRequest.class:2.1.4]\n\tat org.atmosphere.container.Servlet30CometSupport.suspend(Servlet30CometSupport.java:93) ~[Servlet30CometSupport.class:2.1.4]\n\tat org.atmosphere.container.Servlet30CometSupport.service(Servlet30CometSupport.java:68) ~[Servlet30CometSupport.class:2.1.4]\n\tat org.atmosphere.cpr.AtmosphereFramework.doCometSupport(AtmosphereFramework.java:1801) ~[AtmosphereFramework.class:2.1.4]\n\tat org.atmosphere.cpr.AtmosphereServlet.doPost(AtmosphereServlet.java:210) [AtmosphereServlet.class:2.1.4]\n\tat org.atmosphere.cpr.AtmosphereServlet.doGet(AtmosphereServlet.java:196) [AtmosphereServlet.class:2.1.4]\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:618) [servlet-api.jar:na]\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:725) [servlet-api.jar:na]\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:301) [catalina.jar:8.0.5]\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) [catalina.jar:8.0.5]\n\tat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52) [tomcat-websocket.jar:8.0.5]\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:239) [catalina.jar:8.0.5]\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) [catalina.jar:8.0.5]\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:219) [catalina.jar:8.0.5]\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:106) [catalina.jar:8.0.5]\n\nNote that <async-supported>true</async-supported> is defined in web.xml. The sample used to reproduce the issue is:\n\n   http://goo.gl/AxmXf9\n\nNow when using Tomcat 7 everything works as expected, both using native and jsr356 implementation for websocket. I'm not sure if that is caused by the websocket implementation, but I must say it always happens when there is a mix or websocket and http/comet connections occuring. \n\nThe sample above is configured to use websocket when available, and fallback to long-polling if websocket aren't supported. That's the case when IE 9 fails.\n\nSorry if the issue is vague, but it is extremely hard to reproduce.", "count": 0, "id": 175545, "time": "2014-05-29T12:46:11Z", "creator": "jfarcand@apache.org", "creation_time": "2014-05-29T12:46:11Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 56575, "attachment_id": null, "id": 175594, "time": "2014-06-02T12:40:40Z", "creator": "jfarcand@apache.org", "creation_time": "2014-06-02T12:40:40Z", "is_private": false, "text": "Sorry for the trouble, the user found the issue:\n\n======================\n\nHi Jeanfrancois,\n\nI have investigated more on this, problem is only coming when i use memcached-session-manager in the tomcat. Otherwise chat application works perfectly fine in tomcat 8 & 7. \n\nThis problem even exists in tomcat 7 also if we use memcached-session-manager.\n\nSorry for creating confusion.\n\nThanks a lot,\nKartik\n========================"}]