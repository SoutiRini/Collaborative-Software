[{"count": 0, "tags": [], "text": "In connectors/jk/java/org/apache/jk/common/HandlerRequest.java\n\ncoyote.Request's schemeMB is assigned in 2 places.\n\n1st place: \n400         boolean isSSL = msg.getByte() != 0;\n401         if( isSSL ) {\n402             // XXX req.setSecure( true );\n403             req.scheme().setString(\"https\");\n404         }\n\n2nd place:\n518             case AjpConstants.SC_A_SSL_CERT     :\n519                 req.scheme().setString( \"https\" );\nand similar assignments for SC_A_SSL_CIPHER and SC_A_SSL_SESSION cases below.\n\nIt seems they do not make sense because the packet's 8-bit field is designated for telling whether it's SSL or not. So the 1st place is enough. Adding the 2nd place may pose potential bug in that a packet with the 8-bit SSL field being 0 and suffixes of SC_A_SSL_* key-value pairs can later incorrect trigger a wrong redirection message pointing to a https location.\n\nA simple correction is to honor the 8-bit SSL-field in packet and delete the 3 lines of 2nd place assigning \"https\". \n\nEven though the chances of such spurious packet is low, but it's best we can have threat-free, semantic-correct tomcat code.\n\nThe same lines of code remain in 6.0 and 7.0.\n\nBut maybe I misunderstand the code, in which case please kindly point out. Thanks.", "attachment_id": null, "bug_id": 54010, "id": 162770, "time": "2012-10-16T02:20:47Z", "creator": "shensiulap@gmail.com", "creation_time": "2012-10-16T02:20:47Z", "is_private": false}, {"count": 1, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "text": "Tomcat 5.5.x is no longer supported.\n\nLooking at the mod_jk, I don't see how there could ever be a problem here but there is scope for removing the additional unnecessary calls.\n\nMoving this to Tomcat 8.0.x and marking as an enhancement.\n\nThis will most likely get be applied to 8.0.x only, as part of the ongoing clean-up of the code base for the 8.0.x branch.", "id": 162884, "time": "2012-10-22T22:40:27Z", "bug_id": 54010, "creation_time": "2012-10-22T22:40:27Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 54010, "attachment_id": null, "id": 162885, "time": "2012-10-22T22:49:15Z", "creator": "markt@apache.org", "creation_time": "2012-10-22T22:49:15Z", "is_private": false, "text": "Fixed in 8.0.x and will be included in 8.0.0 onwards."}, {"attachment_id": null, "tags": [], "creator": "shensiulap@gmail.com", "text": "Thank Mark for your efforts.\n\nThe credit of this vulnerability should be given to this bug report: \nhttps://issues.apache.org/bugzilla/show_bug.cgi?id=36883\n\nThey discovered the bug but only fixed in the httpd site and left the problem in tomcat intact. Now the problem at the tomcat part is also fixed.", "count": 3, "id": 162886, "time": "2012-10-22T22:54:43Z", "bug_id": 54010, "creation_time": "2012-10-22T22:54:43Z", "is_private": false}]