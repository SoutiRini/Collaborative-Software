[{"text": "It's currently possible in POI to create a spreadsheet with overlapping merged regions. When saved to a file, this results in a corrupted workbook that Microsoft Excel must repair before being able to read.\n\nIn order to eliminate the possibility of creating a corrupted workbook from merged regions, Sheet.addMergedRegion(CellRangeAddress) should check existing merged regions for any existing regions that overlap with the candidate.", "tags": [], "bug_id": 58443, "is_private": false, "count": 0, "id": 185410, "time": "2015-09-22T03:39:25Z", "creator": "onealj@apache.org", "creation_time": "2015-09-22T03:39:25Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "Created attachment 33128\npatch to check for intersection when adding a merged region\n\nFixes:\n* remove HSSFSheet.addMergedRegion(Region), which has been deprecated since Aug 2008\n* modified H/XSSFSheet.addMergedRegion to check if candidate region overlaps with an existing region, and throw an IllegalStateException if there is overlap, and corresponding unit test\n* add CellRangeAddressBase.intersects and corresponding unit test\n* fixed several unit tests that unintentionally created overlapping merged regions.\n\nNote: this patch requires the fix for bug 58350 (attachment 33086).", "attachment_id": 33128, "bug_id": 58443, "id": 185411, "time": "2015-09-22T03:47:23Z", "creator": "onealj@apache.org", "creation_time": "2015-09-22T03:47:23Z", "is_private": false}, {"count": 2, "tags": [], "text": "Created attachment 33129\npatch to check for intersection when adding a merged region\n\nfixed whitespace", "attachment_id": 33129, "bug_id": 58443, "id": 185412, "time": "2015-09-22T03:51:03Z", "creator": "onealj@apache.org", "creation_time": "2015-09-22T03:51:03Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 58443, "attachment_id": null, "id": 185457, "time": "2015-09-23T14:19:48Z", "creator": "onealj@apache.org", "creation_time": "2015-09-23T14:19:48Z", "is_private": false, "text": "Current implementation runs in linear time to add one merged region, and quadratic time if adding multiple regions. Is there a faster way (O(n log n)?) to add multiple regions? If so, we may want to add a addMergedRegions(List<CellRangeAddress>) if users plan on adding many merged regions."}, {"count": 4, "tags": [], "creator": "onealj@apache.org", "attachment_id": null, "id": 186130, "time": "2015-10-31T10:39:33Z", "bug_id": 58443, "creation_time": "2015-10-31T10:39:33Z", "is_private": false, "text": "Applied to trunk in r1711581 and r1711586:\n* prevent corrupted workbooks by checking for overlapping merged regions before adding a merged region to a sheet\n* fix unit tests that produced corrupt workbooks due to overlapping merged regions\n* remove deprecated HSSFSheet#addMergedRegion(Region)\n\nDocumentation updated in r1711590."}, {"text": "*** Bug 58070 has been marked as a duplicate of this bug. ***", "tags": [], "bug_id": 58443, "attachment_id": null, "count": 5, "id": 187200, "time": "2015-12-29T06:08:12Z", "creator": "onealj@apache.org", "creation_time": "2015-12-29T06:08:12Z", "is_private": false}, {"count": 6, "tags": [], "creator": "dtn-asfbugs@corefiling.co.uk", "attachment_id": null, "is_private": false, "id": 187802, "time": "2016-01-18T14:44:04Z", "bug_id": 58443, "creation_time": "2016-01-18T14:44:04Z", "text": "Spun performance regression off as bug 58885"}]