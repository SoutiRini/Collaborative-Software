[{"count": 0, "tags": [], "creator": "marie-soleil.l.allier@ericsson.com", "is_private": false, "id": 75534, "creation_time": "2005-05-27T21:07:10Z", "time": "2005-05-27T21:07:10Z", "bug_id": 35109, "text": "Hi,\n\n------------------------------------\nCONTEXT\n------------------------------------\nI have 2 build.xml files and both of them are importing common.xml\nThe first build.xml is calling the second build.xml. And the second build.xml \nis calling a macro of the common.xml\n\nThis macro have the following definition:\n<property name=\"jar.dir\" location=\"build/jar\"/>     <!-- generated jar files -->\n...\n<macrodef name=\"common-jar\">\n    <attribute name=\"dir\" default=\"${jar.dir}\" Description=\"Directory in which \nto create the jar file\"/>\n    <sequential>\n\t\t<echo>\n\t\t\tDEBUG INFO :: COMMON-JAR\n\t\t\tjar.dir=${jar.dir}\t\n\t\t\t@dir=@{dir}\t\t\n\t\t</echo>\n    \n        <mkdir dir=\"@{dir}\"/>\n           ...\n    </sequential>\n</macrodef>\n\n------------------------------------\nPROBLEM\n------------------------------------\nWhen the macro is called without defining the attribute \"dir\", it uses the \ndefault value... look at those traces:\n     [echo] DEBUG INFO :: MMS-JAR\n     [echo] \tjar.dir=Y:\\mmsoe\\common\\build\\jar\n     [echo] \t@dir=Y:\\mms_testtools\\tstauto\\build\\jar\n\nThe value contains in the @dir attribute is not the same as the property's \nvalue ${jar.dir}... in fact, it is the one that was defined when common.xml was \nimported by the FIRST build.xml.... \n\nAnd I only get this problem when building with ant 1.6.3 (not with ant 1.6.2 or \n1.6.1)", "attachment_id": null}, {"count": 1, "tags": [], "text": "can you distill this down to three working buildfiles that reproduce the error\nand attach them with clear intent as to what to execute in order to trigger the\nproblem?\n\nThanks,\nMatt", "is_private": false, "id": 75536, "creator": "mbenson@apache.org", "time": "2005-05-27T21:11:40Z", "bug_id": 35109, "creation_time": "2005-05-27T21:11:40Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "marie-soleil.l.allier@ericsson.com", "attachment_id": 15190, "text": "Created attachment 15190\nto test the bug\n\nGo to the directory _build1 and run the target \"cmd.build2\" from the build.xml", "id": 75547, "time": "2005-05-27T22:51:48Z", "bug_id": 35109, "creation_time": "2005-05-27T22:51:48Z", "is_private": false}, {"count": 3, "tags": [], "text": "I get:\n\nBuildfile: build.xml\n\ncmd.build2:\n\nbuild2.jar:\n     [echo]\n     [echo]                     DEBUG INFO :: COMMON-JAR\n     [echo]                     jar.dir=D:\\javaWorkArea\\mariesoleil\\_build2\\buil\nd\\jar\n     [echo]                     @dir=D:\\javaWorkArea\\mariesoleil\\_build2\\build\\j\nar\n     [echo]\n    [mkdir] Created dir: D:\\javaWorkArea\\mariesoleil\\_build2\\build\\jar\n\nBUILD SUCCESSFUL\nTotal time: 0 seconds\n\n\nThis looks correct to me... what is wrong with this result?", "is_private": false, "id": 75548, "creator": "mbenson@apache.org", "time": "2005-05-27T23:54:29Z", "bug_id": 35109, "creation_time": "2005-05-27T23:54:29Z", "attachment_id": null}, {"count": 4, "tags": [], "text": "BTW, I tested with Ant 1.7 and what will be Ant 1.6.5;  There have been no \nchanges from 1.6.3 to 1.6.5 that should have any impact on this.", "is_private": false, "id": 75549, "creator": "mbenson@apache.org", "time": "2005-05-27T23:55:59Z", "bug_id": 35109, "creation_time": "2005-05-27T23:55:59Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "peterreilly@apache.org", "attachment_id": null, "text": "This is a bug. It was caused by an incorrect fix to\nbug 31215. I have committed a fix and a test for\nthe fix. The fix will be in 1.6.5.\n\nThanks for the timely report!", "id": 75588, "time": "2005-05-30T12:07:29Z", "bug_id": 35109, "creation_time": "2005-05-30T12:07:29Z", "is_private": false}]