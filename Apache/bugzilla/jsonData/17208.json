[{"count": 0, "tags": [], "bug_id": 17208, "attachment_id": null, "text": "I have a word document that was created in word 2000. Whenever I attempt to \ncreate a WordDocument object, it throws the exception:\n\nException in thread \"main\" java.lang.NegativeArraySizeException\n        at org.apache.poi.hdf.extractor.data.ListTables.createLVL\n(ListTables.java:206)\n        at org.apache.poi.hdf.extractor.data.ListTables.initLFO\n(ListTables.java:184)\n        at org.apache.poi.hdf.extractor.data.ListTables.<init>\n(ListTables.java:78)\n        at org.apache.poi.hdf.extractor.WordDocument.createListTables\n(WordDocument.java:1670)\n        at org.apache.poi.hdf.extractor.WordDocument.findFormatting\n(WordDocument.java:399)\n        at org.apache.poi.hdf.extractor.WordDocument.processComplexFile\n(WordDocument.java:326)\n        at org.apache.poi.hdf.extractor.WordDocument.readFIB\n(WordDocument.java:278)\n        at org.apache.poi.hdf.extractor.WordDocument.<init>\n(WordDocument.java:228)\n        at Word.main(Word.java:12)\n\nThe document has only text, and a footer. Let me know if you need more \ninformation. I would be happy to work on this problem, but I do not fully \nunderstand what LittleEndian.getInt is doing, for example. If someone could \nexplain to me the purpose of that (and where to get info on that), as well as \nwhere to get info on Word 2000 document format, I'm sure I can be of help.", "id": 31615, "time": "2003-02-19T15:57:19Z", "creator": "rpjava@hotmail.com", "creation_time": "2003-02-19T15:57:19Z", "is_private": false}, {"count": 1, "tags": [], "text": "I did a bit of research into this problem. From what I can tell, the value (at \nposition 24) of cbGrpprlChpx in LVLF is -1 (on the 4th list in my test case). I \ndo not know if this is a valid value (is it?), but the code does not handle \nthis. So what happens is the code attempts to create: new byte[ -1 ].\n\nTo create this exception, I used windows 2000, word 2000 and created a document \nwith a numbered list. It only happens with multi-level lists.\n", "attachment_id": null, "bug_id": 17208, "id": 31792, "time": "2003-02-22T16:41:03Z", "creator": "rpjava@hotmail.com", "creation_time": "2003-02-22T16:41:03Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 17208, "attachment_id": 5150, "text": "Created attachment 5150\nProposed patch", "id": 32427, "time": "2003-03-04T21:47:02Z", "creator": "bob.otterberg@finetix.com", "creation_time": "2003-03-04T21:47:02Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 17208, "attachment_id": null, "text": "I uploaded a proposed patch for the problem.  I was also experience similar \nproblems with a few of my files.  The proposed patch fixed my problem.  I think \nit will fix Robert's also.  Might also fix bug 16305.", "id": 32428, "time": "2003-03-04T21:49:03Z", "creator": "bob.otterberg@finetix.com", "creation_time": "2003-03-04T21:49:03Z", "is_private": false}, {"count": 4, "tags": [], "creator": "bob.otterberg@finetix.com", "attachment_id": 5302, "id": 33097, "time": "2003-03-13T02:28:04Z", "bug_id": 17208, "creation_time": "2003-03-13T02:28:04Z", "is_private": false, "text": "Created attachment 5302\n[PATCH] A simple test case (new files contained in a .zip)"}, {"count": 5, "tags": [], "creator": "poi-support@buni.org", "text": "Note that no one will probably commit anything not labeled with PATCH in the\nsubject line (because we query on them ;-) )", "id": 33609, "time": "2003-03-21T16:57:20Z", "bug_id": 17208, "creation_time": "2003-03-21T16:57:20Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "creator": "avik@apache.org", "attachment_id": null, "id": 33716, "time": "2003-03-24T21:26:32Z", "bug_id": 17208, "creation_time": "2003-03-24T21:26:32Z", "is_private": false, "text": "Andy, are you planning on comitting this? I'll do it tomorrow if you havent got\nit by then. "}, {"count": 7, "tags": [], "creator": "avik@apache.org", "attachment_id": null, "id": 34321, "time": "2003-04-02T12:20:32Z", "bug_id": 17208, "creation_time": "2003-04-02T12:20:32Z", "is_private": false, "text": "guess what? apparently this is the first testcase in hdf!! How do i run\ntestcases in scratchpad???? does {old|new} cent let me do that??????"}, {"count": 8, "tags": [], "creator": "poi-support@buni.org", "attachment_id": null, "id": 34924, "time": "2003-04-11T02:41:56Z", "bug_id": 17208, "creation_time": "2003-04-11T02:41:56Z", "is_private": false, "text": "committed.  Nice work.  Please verify."}, {"count": 9, "tags": [], "bug_id": 17208, "attachment_id": null, "text": "There's a problem with the data files used by the test case.  The files \ncommitted to CVS don't match the files posted in the zip.  Each of the files \ncommitted to CVS is slightly larger than the corresponding file in the zip.\n\nfilename         size in zip     size in CVS\n--------------------------------------------\nempty.doc        19456           19462\nsimple.doc       19456           19463\nsimple-list.doc  19456           19467\nsimple-table.doc 19456           19467\n\nNotice that the file sizes in the zip are a multiple of 512.  The file sizes in \nCVS are not a multiple of 512.  This presents all sorts of problems with the\nRawDataBlock class in org.apache.poi.poifs.storage.\nWord 2000 is unable to open any of the files committed to CVS.  No problem with \nthe files in the zip.\n\nI downloaded the zip again and verified it.  The files in it are definitely \nOK.  I think you'll need to re-extract the files and re-commit them to CVS.", "id": 35188, "time": "2003-04-15T14:47:31Z", "creator": "bob.otterberg@finetix.com", "creation_time": "2003-04-15T14:47:31Z", "is_private": false}, {"count": 10, "tags": [], "text": "I reopened the bug because the Word docs added to CVS for use by the test cases \nare not correct.  Check the comment from 2003-04-15 14:47 for details.  I \nverified that the attached zip file is correct.  The Word docs simply need to \nbe extracted and replaced in CVS.", "attachment_id": null, "bug_id": 17208, "id": 36248, "time": "2003-04-28T17:16:38Z", "creator": "bob.otterberg@finetix.com", "creation_time": "2003-04-28T17:16:38Z", "is_private": false}, {"count": 11, "tags": [], "creator": "poi-support@buni.org", "attachment_id": null, "id": 41347, "time": "2003-07-24T15:46:02Z", "bug_id": 17208, "creation_time": "2003-07-24T15:46:02Z", "is_private": false, "text": "Should be against HWPF if its still a problem"}]