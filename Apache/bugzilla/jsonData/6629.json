[{"count": 0, "tags": [], "creator": "tilo.christ@online.de", "attachment_id": null, "text": "Hello!\n\nThis is the Tomcat 3.3.1 version of #1450 which is reported against Tomcat \n4.0.2. Tomcat's Response.encodeURL implementation breaks URLs when it is \ninvoked several times on the same URL. The Servlet 2.2 spec is unclear on \nwhether this is legal behavior, but several competing products do not have this \nproblem (Orion, Resin, HP-AS). I am therefore suggesting the following patch to \nfix this behavior.\nThe affected file is \nsrc\\facade22\\org\\apache\\tomcat\\facade\\HttpServletResponseFacade.java\nThe diff is\n--- HttpServletResponseFacade.java.orig\tMon Feb 11 16:00:40 2002\n+++ HttpServletResponseFacade.java\tThu Feb 21 21:22:52 2002\n@@ -434,6 +434,10 @@\n \t    return (url);\n \n \tString sessionId = session.getId().toString();\n+\n+\tif (url.indexOf(\";jsessionid=\" + sessionId) != -1)\n+\t    return (url);\n+\n \tString path = null;\n \tString query = null;\n \tint question = url.indexOf(\"?\");\n\nI do not have CVS commit access, and would appreciate it if someone else could \ncommit it.", "id": 11064, "time": "2002-02-21T22:17:33Z", "bug_id": 6629, "creation_time": "2002-02-21T22:17:33Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 6629, "attachment_id": null, "is_private": false, "id": 11071, "time": "2002-02-21T22:27:52Z", "creator": "tilo.christ@online.de", "creation_time": "2002-02-21T22:27:52Z", "text": "*** Bug 6631 has been marked as a duplicate of this bug. ***"}, {"count": 2, "tags": [], "text": "A fix similar to your patch has been added to the CVS HEAD, and will appear in \n3.3.1-RC1.", "attachment_id": null, "id": 11082, "creator": "william.barker@wilshire.com", "time": "2002-02-22T06:13:23Z", "bug_id": 6629, "creation_time": "2002-02-22T06:13:23Z", "is_private": false}]