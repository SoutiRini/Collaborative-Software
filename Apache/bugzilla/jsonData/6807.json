[{"count": 0, "attachment_id": null, "creator": "poi-support@buni.org", "text": "[ 501897 ] Query refresh dialog when open XLS file\n (?)\nSubmitted By:\nSteven R Smith (steversmith) Date Submitted:\n2002-01-10 11:13\nDate Closed:\n2002-01-12 11:21\nData Type: (?)\nCategory: (?)\n (admin) Group: (?)\n (admin)\nAssigned To: (?)\n (admin) Priority: (?)\nStatus: (?)\nResolution: (?)\nSummary: (?)\nI used the HSSF API to create a very simple XLS file.\nWhen I open the resulting file in Excel, I get a\ndialog box titled \"Query Refresh\" that indicates the\nworkbook contains queries to external data that\nrefresh automatically, followed by a warning about\nusing automatic refresh, and then a couple of buttons\nto either enable or disable automatic refresh.\n\nAny ideas on how to prevent this dialog box from\nshowing up?\n\nI am using Excel 2000 on a WinNT 4.0 workstation\n(do I need to use another version of Excel?).\n\nHeres the code I used to create the file:\n// create a new workbook with one sheet\nHSSFWorkbook wb = new HSSFWorkbook();\nHSSFSheet s = wb.createSheet(\"Demo Sheet\");\n\n// create a row\nHSSFRow row = s.createRow((short)0);\n\n// create a numeric and a text cell\nHSSFCell cell = row.createCell((short)0,\nHSSFCell.CELL_TYPE_STRING);\ncell.setCellValue(\"Text\");\ncell = row.createCell((short)1,\nHSSFCell.CELL_TYPE_NUMERIC);\ncell.setCellValue(123);\n\n// finally, write the workbook out to a file\nFileOutputStream out = new FileOutputStream(FILENAME);\nwb.write(out);\nout.close();\nUse Canned Response: (?)\n (admin)\n\nOR Attach A Comment: (?)\n\nFollowups:\n\nMessage\n\nDate: 2002-01-12 11:21\nSender: acoliver2\nLogged In: YES \nuser_id=287767\n\none day sourceforge will actually close this bug. \nPersonally I think its possesed.  Don't htink I'll be doing\na project in PHP anytime soon if this is the kind of\nperformance we can expect.  \n\nDate: 2002-01-10 13:49\nSender: steversmith\nLogged In: YES \nuser_id=421542\n\nThanks for the very quick response!  \n\nI am using the production version of HSSF (poi-\n1_0_1.tar.gz).  I was able to apply the suggested mod to \nthe source code and everything seems fine now.\n\nDate: 2002-01-10 12:44\nSender: acoliver2\nLogged In: YES \nuser_id=287767\n\nAre you using the development or the production version of HSSF?\n\nYou can solve this problem in the production sources by\napplying this patch net.sourceforge.poi.hssf.model.Workbook:\n\n------------------PATCH\n--- ./Workbook.java\tMon Dec 24 10:31:01 2001\n+++ /home/andy/Workbook.java\tWed Jan  2 14:06:14 2002\n@@ -958,9 +958,9 @@\n     {\n         RefreshAllRecord retval = new RefreshAllRecord();\n \n-        retval.setRefreshAll(true);   // by default refresh\nthe calculations on\n-        return retval;   // startup  -- differs from sample\nbut seems\n-    }                    // like it may help us.\n+        retval.setRefreshAll(false);   // by default\nrefresh the calculations off \n+        return retval;   \n+    }                    \n \n     /**\n      * creates the BookBool record with saveLinkValues set\nto 0. (don't save link values)\n\n\n-----------------------------PATCH--------------------\n\nif you are unable to use patches you can edit the line to\nread: retval.setRefreshAll(false);\n\n(and delete the incorrect comments).\n\nThis SHOULD be fixed in the next development build.  Someone\nwho has Office 2k should test this patch.  (I have Excel 97)\n\nI never heard back from the last person who had this problem\non whether it was resolved.\n\nThanks,\n\nAndy\n\nCheck to Upload & Attach File: (?)\n\nFile Description:\n\nExisting Files:\nDelete Name Description Download\nNo Files Currently Attached\nChange Log:\nField Old Value Date By\nstatus_id Open 2002-01-12 11:21 acoliver2\nclose_date 1969-12-31 19:00 2002-01-12 11:21 acoliver2\nresolution_id None 2002-01-10 16:02 acoliver2", "id": 11370, "time": "2002-03-01T21:23:21Z", "bug_id": 6807, "creation_time": "2002-03-01T21:23:21Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "poi-support@buni.org", "attachment_id": null, "is_private": false, "id": 11416, "time": "2002-03-04T02:46:59Z", "bug_id": 6807, "creation_time": "2002-03-04T02:46:59Z", "text": "test"}, {"count": 2, "tags": [], "bug_id": 6807, "text": "test again", "id": 11417, "time": "2002-03-04T02:49:31Z", "creator": "poi-support@buni.org", "creation_time": "2002-03-04T02:49:31Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 6807, "text": "test again..", "id": 11418, "time": "2002-03-04T02:56:53Z", "creator": "poi-support@buni.org", "creation_time": "2002-03-04T02:56:53Z", "is_private": false, "attachment_id": null}, {"count": 4, "attachment_id": null, "creator": "poi-support@buni.org", "is_private": false, "id": 11427, "time": "2002-03-04T12:52:34Z", "bug_id": 6807, "creation_time": "2002-03-04T12:52:34Z", "tags": [], "text": ".. another blasted test."}, {"count": 5, "tags": [], "creator": "glens@apache.org", "attachment_id": null, "text": "This has been fixed and will be available for the 1.5 release.", "id": 11641, "time": "2002-03-11T02:11:01Z", "bug_id": 6807, "creation_time": "2002-03-11T02:11:01Z", "is_private": false}]