[{"count": 0, "tags": [], "bug_id": 32437, "attachment_id": null, "is_private": false, "id": 67588, "time": "2004-11-29T23:26:21Z", "creator": "robert.dockins@tufts.edu", "creation_time": "2004-11-29T23:26:21Z", "text": "I'm using the Ant API to embed Ant into an application I am writing.  When\nsetting the core class loader for an ant project which has been set\nparentFirst(false), a null pointer exception occurs in DefBase.createLoader.  A\nshort test case is attached.  The exception stack trace follows.  To run the\ntest case copy ant.jar, ant-launcher.jar and ant-contrib-1.0b.jar into the\ndirectory and run test.sh.  Note this exception is not unique to the For task;\nI've tried a number.\n\njava.lang.NullPointerException\n        at org.apache.tools.ant.taskdefs.DefBase.createLoader(DefBase.java:132)\n        at org.apache.tools.ant.taskdefs.Definer.execute(Definer.java:169)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:324)\n        at org.apache.tools.ant.TaskAdapter.execute(TaskAdapter.java:123)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:275)\n        at org.apache.tools.ant.Task.perform(Task.java:364)\n        at org.apache.tools.ant.Target.execute(Target.java:341)\n        at org.apache.tools.ant.Target.performTasks(Target.java:369)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1214)\n        at testprob.testCase(testprob.java:60)\n        at testprob.main(testprob.java:33)"}, {"count": 1, "tags": [], "bug_id": 32437, "attachment_id": 13587, "text": "Created attachment 13587\ncode for the test case\n\nRuns the test in two modes, one with parentFirst set, and one without.\twith\nparentFirst, the class is not found.  With parentFirst = false, null pointer\nexception", "id": 67589, "time": "2004-11-29T23:28:46Z", "creator": "robert.dockins@tufts.edu", "creation_time": "2004-11-29T23:28:46Z", "is_private": false}, {"count": 2, "tags": [], "creator": "robert.dockins@tufts.edu", "is_private": false, "text": "Created attachment 13588\ndriver script -- compiles and runs the code", "id": 67590, "time": "2004-11-29T23:29:28Z", "bug_id": 32437, "creation_time": "2004-11-29T23:29:28Z", "attachment_id": 13588}, {"count": 3, "tags": [], "creator": "robert.dockins@tufts.edu", "text": "Also note, the null pointer exception occurs with or without isolated set.", "id": 67591, "time": "2004-11-29T23:31:49Z", "bug_id": 32437, "creation_time": "2004-11-29T23:31:49Z", "is_private": false, "attachment_id": null}, {"count": 4, "attachment_id": null, "bug_id": 32437, "text": "Further note:\n\n$ java -version\njava version \"1.4.2_06\"\nJava(TM) 2 Runtime Environment, Standard Edition (build 1.4.2_06-b03)\nJava HotSpot(TM) Client VM (build 1.4.2_06-b03, mixed mode)\n", "id": 67593, "time": "2004-11-29T23:34:06Z", "creator": "robert.dockins@tufts.edu", "creation_time": "2004-11-29T23:34:06Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "creator": "robert.dockins@tufts.edu", "is_private": false, "text": "Created attachment 13589\noutput of \"ant -diagnostics\"", "id": 67595, "time": "2004-11-29T23:34:43Z", "bug_id": 32437, "creation_time": "2004-11-29T23:34:43Z", "attachment_id": 13589}, {"count": 6, "tags": [], "creator": "bodewig@apache.org", "text": "I think it has been fixed in CVS HEAD, could you please try a recent nightly build?\n\n<http://cvs.apache.org/viewcvs.cgi/ant/src/main/org/apache/tools/ant/taskdefs/DefBase.java?r1=1.10&r2=1.11>", "id": 68766, "time": "2004-12-21T16:10:47Z", "bug_id": 32437, "creation_time": "2004-12-21T16:10:47Z", "is_private": false, "attachment_id": null}, {"count": 7, "attachment_id": null, "bug_id": 32437, "is_private": false, "id": 68773, "time": "2004-12-21T19:19:24Z", "creator": "robert.dockins@tufts.edu", "creation_time": "2004-12-21T19:19:24Z", "tags": [], "text": "The test program does indeed no longer fail where it was failing.  It now gets a\ndifferent null pointer exception elsewhere.  This is with the Dec 20, 2004\nnightly build.\n\n\njava.lang.NullPointerException\n        at\norg.apache.tools.ant.util.ClasspathUtils.isMagicPropertySet(ClasspathUtils.java:275)\n        at\norg.apache.tools.ant.util.ClasspathUtils.access$000(ClasspathUtils.java:66)\n        at\norg.apache.tools.ant.util.ClasspathUtils$Delegate.getClassLoader(ClasspathUtils.java:401)\n        at org.apache.tools.ant.taskdefs.DefBase.createLoader(DefBase.java:135)\n        at org.apache.tools.ant.taskdefs.Definer.execute(Definer.java:169)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:324)\n        at\norg.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:95)\n        at org.apache.tools.ant.TaskAdapter.execute(TaskAdapter.java:120)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:275)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:324)\n        at\norg.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:95)\n        at org.apache.tools.ant.Task.perform(Task.java:366)\n        at org.apache.tools.ant.Target.execute(Target.java:341)\n        at org.apache.tools.ant.Target.performTasks(Target.java:369)\n        at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1243)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1213)\n        at testprob.testCase(testprob.java:113)\n        at testprob.main(testprob.java:37)\n"}, {"count": 8, "tags": [], "bug_id": 32437, "attachment_id": null, "is_private": false, "id": 69478, "time": "2005-01-10T14:25:53Z", "creator": "bodewig@apache.org", "creation_time": "2005-01-10T14:25:53Z", "text": "(In reply to comment #7)\n\n>         at org.apache.tools.ant.TaskAdapter.execute(TaskAdapter.java:120)\n\nfinally gave me the clue.  You load DefBase via a different classloader than\nProject in your example program if you set parentFirst to false (since it is\navailable via the parent as well as your new core loader, but you load Project\nitself via the system classloader).\n\nIf you add l.addSystemPackageRoot( \"org.apache.tools.ant\" ); to your test method,\nthings work."}]