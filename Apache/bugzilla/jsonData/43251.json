[{"count": 0, "tags": [], "bug_id": 43251, "attachment_id": null, "is_private": false, "id": 107471, "time": "2007-08-30T06:57:50Z", "creator": "sandeepgiri@gmail.com", "creation_time": "2007-08-30T06:57:50Z", "text": "Hi,\nI am getting the following error.\nPlease let me know how can I send the sample attachment for which this problem\nis occurring. \n\nRegards,\nSandeep Giri\n------------------------------\njava.lang.reflect.InvocationTargetException\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)\n\tat java.lang.reflect.Constructor.newInstance(Unknown Source)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:237)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:160)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:183)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:152)\n\tat transbit.tbits.Helper.Xls2csv.getText(Xls2csv.java:42)\n\tat transbit.tbits.Helper.Xls2csv.getText(Xls2csv.java:32)\n\tat transbit.tbits.common.Readerizer.readerizeExcelFiles(Readerizer.java:322)\n\tat transbit.tbits.common.Readerizer.readerize(Readerizer.java:209)\n\tat transbit.tbits.common.Readerizer.main(Readerizer.java:136)\nCaused by: java.lang.ArrayIndexOutOfBoundsException: 33\n\tat org.apache.poi.util.LittleEndian.getNumber(LittleEndian.java:491)\n\tat org.apache.poi.util.LittleEndian.getShort(LittleEndian.java:52)\n\tat org.apache.poi.hssf.record.ObjRecord.fillFields(ObjRecord.java:98)\n\tat org.apache.poi.hssf.record.Record.fillFields(Record.java:90)\n\tat org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n\tat org.apache.poi.hssf.record.ObjRecord.<init>(ObjRecord.java:61)\n\t... 13 more\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record\ninstance, the following exception occured: null\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:250)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:160)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:183)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:152)"}, {"count": 1, "tags": [], "text": "You should attach the problem file to this bugzilla entry", "is_private": false, "id": 107661, "creator": "apache@gagravarr.org", "time": "2007-09-03T09:27:05Z", "bug_id": 43251, "creation_time": "2007-09-03T09:27:05Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 43251, "attachment_id": 21679, "id": 114723, "time": "2008-03-18T13:07:30Z", "creator": "lucalus@hotmail.com", "creation_time": "2008-03-18T13:07:30Z", "is_private": false, "text": "Created attachment 21679\nAn excel file that fails in the constructor with RecordFormatException: \"Unable to construct record instance\"\n\nAssuming xlsFile is a File object that points to the Problem.xls file the following code fails:\n\ninputStream_ = new FileInputStream( xlsFile );\nPOIFSFileSystem fs = new POIFSFileSystem( inputStream_ );\nworkbook_ = new HSSFWorkbook( fs ); //FAILS HERE\n\nHere's a stack trace:\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:199)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:117)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:207)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:148)\n\tat com.snowfly.spincast.XlsSheetList.open(XlsSheetList.java:50)\n\tat com.snowfly.spincast.XlsSheetList.<init>(XlsSheetList.java:36)\n\tat com.snowfly.spincast.client.XLSFileImporter.processFile(XLSFileImporter.java:63)\n\tat com.snowfly.spincast.client.XLSFileImporter.doImport(XLSFileImporter.java:45)\n\tat com.snowfly.spincast.Task.process(Task.java:74)\n\tat com.snowfly.spincast.TaskManager.process(TaskManager.java:33)\n\tat com.snowfly.spincast.Spincast.main(Spincast.java:34)\nCaused by: java.lang.reflect.InvocationTargetException\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:513)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:187)\n\t... 10 more\nCaused by: java.lang.IllegalArgumentException: Illegal length\n\tat org.apache.poi.hssf.record.RecordInputStream.readCompressedUnicode(RecordInputStream.java:270)\n\tat org.apache.poi.hssf.record.FileSharingRecord.fillFields(FileSharingRecord.java:62)\n\tat org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n\tat org.apache.poi.hssf.record.FileSharingRecord.<init>(FileSharingRecord.java:48)\n\t... 15 more"}, {"count": 3, "tags": [], "creator": "apache@gagravarr.org", "is_private": false, "text": "I've just tried the attached spreadsheet, and it opens just fine with svn\ntrunk\n\nI've added a new test to the test suite, so we can ensure this doesn't get\nbroken again in future\n", "id": 114733, "time": "2008-03-19T04:59:54Z", "bug_id": 43251, "creation_time": "2008-03-19T04:59:54Z", "attachment_id": null}]