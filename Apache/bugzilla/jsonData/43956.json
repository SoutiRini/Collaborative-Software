[{"count": 0, "tags": [], "creator": "samy-delux@gmx.de", "attachment_id": null, "id": 111079, "time": "2007-11-25T06:46:47Z", "bug_id": 43956, "creation_time": "2007-11-25T06:46:47Z", "is_private": false, "text": "I want to run a filter (mod_layout) only when a page is Content-Type is\ntext/html _and_ it's Content-Encryption is not gzip.\nI was told I could achieve this by doing the following:\n\nFilterProvider gzipcheck LAYOUT resp=Content-Encoding $!gzip\nFilterProvider addcomment gzipcheck resp=Content-Type $text/html\nFilterChain addcomment\n\nUnfortunately if you try just that, every apache process that tries to process\nthe FilterChain segfaults."}, {"count": 1, "tags": [], "bug_id": 43956, "text": "Please provide a backtrace of the crash (see\nhttp://httpd.apache.org/dev/debugging.html) and the OS you are using.", "id": 111080, "time": "2007-11-25T08:23:16Z", "creator": "rpluem@apache.org", "creation_time": "2007-11-25T08:23:16Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "samy-delux@gmx.de", "attachment_id": null, "text": "I tried to get backtrace with gdb, but it gbd throws \"Failed to read a valid\nobject file image from memory.\".\nI'm running debian etch with an 2.6.18 kernel. After some research on the net, I\nfound out that this kernel in debian is suffering from a bug that renders gdb\nunusable. It does not show any symbols even thou apache was compiled with the\n\"-g\" option.\n\nI would really appreciate it, if someone else could provide the backtrace. You\njust have to pop those lines into your config an all childs, which process\nrequests, will crash instantly.", "id": 111083, "time": "2007-11-25T15:01:53Z", "bug_id": 43956, "creation_time": "2007-11-25T15:01:53Z", "is_private": false}, {"count": 3, "tags": [], "creator": "rpluem@apache.org", "attachment_id": null, "is_private": false, "id": 111090, "time": "2007-11-26T05:24:56Z", "bug_id": 43956, "creation_time": "2007-11-26T05:24:56Z", "text": "Sorry but mod_layout is a third party module not delivered with httpd to which I\ndo not have access. So please update your kernel by applying an appropriate\npatch from debian and provide a backtrace."}, {"count": 4, "tags": [], "creator": "nick@webthing.com", "is_private": false, "id": 111095, "attachment_id": null, "bug_id": 43956, "creation_time": "2007-11-26T06:39:45Z", "time": "2007-11-26T06:39:45Z", "text": "We can reproduce the bug using AN Other filter - e.g. INCLUDES.\n\n1. FilterProvider gzipcheck INCLUDES resp=Content-Encoding !$gzip\n\ndeclares a new filter \"gzipcheck\" implemented by mod_filter.\n\n2. FilterProvider addcomment gzipcheck resp=Content-Type $text/html\n\nuses gzipcheck as a provider.\n\nNow filter_init in mod_filter calls itself recursively at line 142.\n\nThus the fix to avoid segfault is trivial, but to enable the kind of chaining\nthe OP wants (and which I originally envisaged) for filters with a filter_init\nis harder.  I'm thinking an expression parser looks like a better solution to\ncomplex mod_filter configuration problems."}, {"count": 5, "tags": [], "creator": "nick@webthing.com", "attachment_id": null, "id": 111101, "time": "2007-11-26T07:07:19Z", "bug_id": 43956, "creation_time": "2007-11-26T07:07:19Z", "is_private": false, "text": "Fixed in r598299.  It will no longer segfault, but will generate Internal Server\nError and log an error instead.\n\nThis fixes the bug, though not your original problem (enhancement request)\nreported on users@."}, {"count": 6, "tags": [], "bug_id": 43956, "text": "Fixed for 2.2.7 in r602472.", "id": 111578, "time": "2007-12-08T06:32:45Z", "creator": "nick@webthing.com", "creation_time": "2007-12-08T06:32:45Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "creator": "nick@webthing.com", "attachment_id": null, "id": 115144, "time": "2008-03-31T08:55:29Z", "bug_id": 43956, "creation_time": "2008-03-31T08:55:29Z", "is_private": false, "text": "mod_filter in svn /trunk/ (httpd-2.3) now supports expression evaluation with AND, OR, etc for the kind of problem the OP here is tackling.\n\nBug me if I don't get around to documenting how to use this with 2.2."}]