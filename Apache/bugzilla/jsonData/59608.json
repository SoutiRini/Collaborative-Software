[{"count": 0, "tags": [], "text": "https://bz.apache.org/bugzilla/show_bug.cgi?id=59226 added scanning of the Class-Path JAR manifest entries (Yay!). \n\nUnfortunately this now broke my Tomcat setup when updating from 8.0.33 to 8.0.35, I now see these errors in the logs:\n~~~~\n20-May-2016 12:15:39.467 INFO [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Deploying web application directory /opt/collaborne/j2ee-server/webapps/manager\n20-May-2016 12:15:39.494 SEVERE [localhost-startStop-1] org.apache.catalina.core.ContainerBase.addChildInternal ContainerBase.addChild: start: \n org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/manager]]\n\tat org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:153)\n\tat org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:725)\n\tat org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:701)\n\tat org.apache.catalina.core.StandardHost.addChild(StandardHost.java:717)\n\tat org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1092)\n\tat org.apache.catalina.startup.HostConfig$DeployDirectory.run(HostConfig.java:1834)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.IllegalArgumentException: Illegal character in path at index 0: \\\n\tat java.net.URI.create(URI.java:852)\n\tat java.net.URI.resolve(URI.java:1036)\n\tat org.apache.tomcat.util.scan.StandardJarScanner.processManifest(StandardJarScanner.java:400)\n\tat org.apache.tomcat.util.scan.StandardJarScanner.process(StandardJarScanner.java:324)\n\tat org.apache.tomcat.util.scan.StandardJarScanner.scan(StandardJarScanner.java:273)\n\tat org.apache.catalina.startup.ContextConfig.processJarsForWebFragments(ContextConfig.java:1887)\n\tat org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1127)\n\tat org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:779)\n\tat org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:306)\n\tat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:95)\n\tat org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)\n\tat org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5171)\n\tat org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:147)\n\t... 10 more\nCaused by: java.net.URISyntaxException: Illegal character in path at index 0: \\\n\tat java.net.URI$Parser.fail(URI.java:2848)\n\tat java.net.URI$Parser.checkChars(URI.java:3021)\n\tat java.net.URI$Parser.parseHierarchical(URI.java:3105)\n\tat java.net.URI$Parser.parse(URI.java:3063)\n\tat java.net.URI.<init>(URI.java:588)\n\tat java.net.URI.create(URI.java:850)\n\t... 22 more\n\n20-May-2016 12:15:39.494 SEVERE [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Error deploying web application directory /opt/collaborne/j2ee-server/webapps/manager\n java.lang.IllegalStateException: ContainerBase.addChild: start: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/manager]]\n\tat org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:729)\n\tat org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:701)\n\tat org.apache.catalina.core.StandardHost.addChild(StandardHost.java:717)\n\tat org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1092)\n\tat org.apache.catalina.startup.HostConfig$DeployDirectory.run(HostConfig.java:1834)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\n20-May-2016 12:15:39.495 INFO [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Deployment of web application directory /opt/collaborne/j2ee-server/webapps/manager has finished in 27 ms\n~~~~\n\nI was able to track this down to a bug inside Batik 1.7 (https://bz.apache.org/bugzilla/show_bug.cgi?id=51908), but I'm pretty tied to that version at this moment.\n\n1. I think it would be a good idea to log the JAR name/path/URI that is currently processed, so that finding these problems would not require stepping through Tomcat :)\n2. Given that things worked before without these entries being read, it seems like Tomcat should catch exceptions here, and just log them as warning. For Tomcat 9 one might be more aggressive, but for 8.x this failure mode seems to be to aggressive.", "is_private": false, "id": 191141, "creator": "andreas.kohn@gmail.com", "time": "2016-05-20T12:32:50Z", "bug_id": 59608, "creation_time": "2016-05-20T12:32:50Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 59608, "attachment_id": null, "text": "Only one URL error was caught and logged, I also prefer catching everything there. Errors will be logged as debug with the offending JAR URL.\nIncluded in 9M7, 8.5.3 and 8.0.36.", "id": 191144, "time": "2016-05-20T15:59:24Z", "creator": "remm@apache.org", "creation_time": "2016-05-20T15:59:24Z", "is_private": false}]