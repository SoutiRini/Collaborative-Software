[{"count": 0, "tags": [], "bug_id": 48026, "text": "Version 3.5-beta4 had problem with reading XLS saved in Office 2007, this was fixed in 3.5-beta5, but now not working document saved in old Office 2003. It's possible fix it for booth version?\n\nHere is Exception:\n\nException in thread \"main\" org.apache.poi.hssf.record.RecordFormatException: Duplicate PageSettingsBlock record (sid=0x89c)\n        at org.apache.poi.hssf.record.aggregates.PageSettingsBlock.checkNotPresent(PageSettingsBlock.java:227)\n        at org.apache.poi.hssf.record.aggregates.PageSettingsBlock.readARecord(PageSettingsBlock.java:215)\n        at org.apache.poi.hssf.record.aggregates.PageSettingsBlock.addLateRecords(PageSettingsBlock.java:639)\n        at org.apache.poi.hssf.model.Sheet.<init>(Sheet.java:222)\n        at org.apache.poi.hssf.model.Sheet.createSheet(Sheet.java:158)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:286)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:200)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:316)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:297)\n        at cz.atomsoft.actum.carrefour.carrefourhelper.tasks.XlsToAccessConverter.convert(XlsToAccessConverter.java:90)\n        at cz.atomsoft.actum.carrefour.carrefourhelper.tasks.XlsToAccessConverter.convert(XlsToAccessConverter.java:78)\n        at cz.atomsoft.actum.carrefour.carrefourhelper.tasks.XlsToAccessConverter.searchFolderAndConverAllFiles(XlsToAccessConverter.java:73)\n        at cz.atomsoft.actum.carrefour.carrefourhelper.tasks.XlsToAccessConverter.process(XlsToAccessConverter.java:59)\n        at cz.atomsoft.actum.carrefour.carrefourhelper.App.main(App.java:23)", "id": 131236, "time": "2009-10-20T02:40:13Z", "creator": "t.prochazka@centrum.cz", "creation_time": "2009-10-20T02:40:13Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "t.prochazka@centrum.cz", "is_private": false, "text": "Created attachment 24399\nXLS saved in o2003 it work in old 3.5 beta 4", "id": 131237, "time": "2009-10-20T02:47:08Z", "bug_id": 48026, "creation_time": "2009-10-20T02:47:08Z", "attachment_id": 24399}, {"count": 2, "tags": [], "text": "Created attachment 24400\nXLS saved in O2007 it work in 3.5 beta 5 and 3.5 final", "is_private": false, "bug_id": 48026, "id": 131238, "time": "2009-10-20T02:47:55Z", "creator": "t.prochazka@centrum.cz", "creation_time": "2009-10-20T02:47:55Z", "attachment_id": 24400}, {"count": 3, "tags": [], "bug_id": 48026, "text": "Created attachment 24608\nExcel 2000 Document (for test case)\n\nI added an Excel 2000 file for testing purposes. I am getting the mentioned RecordFormatException in 3.5-FINAL but 3.5-beta4 works fine.\n\nHere's my test code:\nstatic void copyPoi( File xlsFile ) throws Exception\n{\n    File tgt = new File( xlsFile.getParentFile(), xlsFile.getName() + \".P.xls\" );\n    \n    HSSFWorkbook wbook = new HSSFWorkbook( new FileInputStream( xlsFile ) );\n    \n    FileOutputStream out = new FileOutputStream( tgt );\n    wbook.write( out );\n    out.close();\n}\n\nI'd really appreciate a fix for this issue very soon. Maybe if someone could give me direction I'd be able to look in the concerning source-code myself...", "id": 132300, "time": "2009-11-25T01:16:42Z", "creator": "20mithrandir@gmail.com", "creation_time": "2009-11-25T01:16:42Z", "is_private": false, "attachment_id": 24608}, {"count": 4, "tags": [], "bug_id": 48026, "text": "Fixed in r892468\n\nIt took time to understand the meaning of the duplicate records and how Excel 2007 repositions them when saving such a file. The fix mimics Excel 2007: duplicates in PageSettingsBlock are not ignored. In the observed cases they are related to custom sheet views and Excel 2007 moves them to the appropriate block. So does POI.\n\nYegor", "id": 132947, "attachment_id": null, "creator": "yegor@dinom.ru", "creation_time": "2009-12-19T03:53:38Z", "time": "2009-12-19T03:53:38Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 48026, "is_private": false, "text": "*** Bug 48852 has been marked as a duplicate of this bug. ***", "id": 135342, "time": "2010-03-15T06:32:17Z", "creator": "yegor@dinom.ru", "creation_time": "2010-03-15T06:32:17Z", "attachment_id": null}]