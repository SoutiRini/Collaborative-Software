[{"count": 0, "tags": [], "text": "Created attachment 34807\nok and error excel files\n\nwhen I use SXSSF export excel, sometimes can not open, I don't know why.\nThere is nothing exceptions or errors print.\nThe broken file's size lager than the file which can open.\nThe broken file has no author, the right file has author named Apache POI.\nThe bottom is the OK.xlsx and error.xlsx files.\nHelp me to find the reason, Thanks!", "is_private": false, "id": 197520, "creator": "icewee@126.com", "time": "2017-03-08T04:48:05Z", "bug_id": 60832, "creation_time": "2017-03-08T04:48:05Z", "attachment_id": 34807}, {"count": 1, "tags": [], "bug_id": 60832, "attachment_id": null, "is_private": false, "id": 197521, "time": "2017-03-08T05:47:33Z", "creator": "onealj@apache.org", "creation_time": "2017-03-08T05:47:33Z", "text": "> sometimes\nFor the same input file and code, do you always get a corrupt file?\n\nCan you include the code you used that resulted in corrupt files?"}, {"count": 2, "tags": [], "creator": "icewee@126.com", "attachment_id": null, "id": 197522, "time": "2017-03-08T07:35:55Z", "bug_id": 60832, "creation_time": "2017-03-08T07:35:55Z", "is_private": false, "text": "Thans for your reply!\n\nUsing the same code, some data export correctly, open is ok, but some data failed.\n\nI think whether some special word/sign/char make excel-cell wrong, xml wrong...\n\nThis is Microsoft Office Excel's error tips:\nExcel file level has been completed verification and repair.This workbook parts may have been repaired or discarded.\nReplaced parts: XML errors/xl/worksheets/sheet1.xml.The attribute value cannot contain the '<'.Line 1880, 370.\n\nI have checked the OK.xlsx and Error.xlsx, it's the same,/xl/worksheets/sheet1.xml the same.\n\nWhether compress zip error? when I changed xlsx to zip, overrides Error file's sheet1.xml with the OK's, WINRAR tip \"Compressed file damage\""}, {"count": 3, "tags": [], "bug_id": 60832, "attachment_id": null, "is_private": false, "id": 197524, "time": "2017-03-08T08:09:44Z", "creator": "icewee@126.com", "creation_time": "2017-03-08T08:09:44Z", "text": "(In reply to Javen O'Neal from comment #1)\n> > sometimes\n> For the same input file and code, do you always get a corrupt file?\n> \n> Can you include the code you used that resulted in corrupt files?\n\nbelow codes:\ncell = row.createCell(cellnum);\ncell.setCellValue(value);\n\nthe value is from database, if I change the value to common string such as \"hello\", export file is OK. But sometimes(debugging) change nothing it's OK.\n\n Crazy...."}, {"count": 4, "tags": [], "creator": "onealj@apache.org", "attachment_id": null, "is_private": false, "id": 197526, "time": "2017-03-08T09:08:27Z", "bug_id": 60832, "creation_time": "2017-03-08T09:08:27Z", "text": "(In reply to IceWee from comment #3)\n> below codes:\n> cell = row.createCell(cellnum);\n> cell.setCellValue(value);\n\nThis isn't sufficient for me to reproduce this problem. See http://sscce.org"}, {"count": 5, "tags": [], "bug_id": 60832, "attachment_id": null, "text": "I am sorry. I really don't know how to desc.\n\nMaybe the data caused.", "id": 197529, "time": "2017-03-08T10:31:31Z", "creator": "icewee@126.com", "creation_time": "2017-03-08T10:31:31Z", "is_private": false}, {"count": 6, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "is_private": false, "id": 197532, "time": "2017-03-08T11:57:50Z", "bug_id": 60832, "creation_time": "2017-03-08T11:57:50Z", "text": "Based on your description, it sounds like there might be a bug in how we're escaping one of the more complicated/less-common values, when writing to the cell\n\nFor your problem file, if I open it in Excel 2010 I get the same error, with the same line/column. However, reading the unzipped .xlsx file I can't see anything wrong with the XML at the position indicated. (Does Excel count differently?)\n\nxmllint is happy with the file, as is libreoffice\n\nFor the problematic file, would you be able to change your export logic to write a new file every 10 lines instead, and then share with us the smaller problematic file with just 10 lines in that fails the same way?"}, {"count": 7, "tags": [], "bug_id": 60832, "attachment_id": null, "is_private": false, "id": 197537, "time": "2017-03-08T13:36:59Z", "creator": "icewee@126.com", "creation_time": "2017-03-08T13:36:59Z", "text": "I've no idea.\nIf I export part data it's OK, for example, 100 rows, 10 rows.\n\nWhen I export top 714 rows it's failed. So I think 714 row is problem data.\nThen I export only 714 row, it's OK...Crazy....\n\nIt's work well export other Tables. SO I give up..."}]