[{"count": 0, "text": "The following small test case crashes with crimson (cvs snapshot):\n\nimport org.w3c.dom.*;\n\nimport org.apache.crimson.tree.*;\n\npublic class BugB\n{\n    // CJO 02/2002\n    public static void main(String[] arg) {\n    // directly create XmlDocument just for the prupose\n    // of having a smaller test...\n        XmlDocument doc = new XmlDocument();\n        Element elt = doc.createElementNS(null, \"foo\");\n        doc.appendChild(elt);\n        elt.setAttributeNS(null, \"bar\", \"bar_value\");\n    // this line should not return the previous\n    // element has the namespace is not the same\n    // but it should not crash either...\n        elt.getAttributeNS(\"myNS\", \"bar\");\n    }\n}", "bug_id": 6607, "attachment_id": null, "id": 11004, "time": "2002-02-21T10:19:32Z", "creator": "cjolif@ilog.fr", "creation_time": "2002-02-21T10:19:32Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 6607, "attachment_id": null, "is_private": false, "id": 13259, "time": "2002-04-11T16:04:34Z", "creator": "clerob@infonie.de", "creation_time": "2002-04-11T16:04:34Z", "text": "The problem is caused by the fact that the code does not expect\nsomeone mixing namespaces with non-namespaces.\n if the requested namespace is not null, the code silently\nexpects all namespaces of the node attributes to be not null,\nand sends them messages without null - checks ...\n\n i will upload a small patch here that will fix the problem\nin this place. the code is not-so-efficient afterwards\nbecause it always sends an \"equals\" to the namespace-strings,\nwhile mostly an \"==\" should give the right anwer.\n i guess to keep the code efficient one should write two\nloops in the affected method; one for null and one for non-null\narguments, to avoid repetetive tests for null / not null within\nthe loop. (i have made no performance measurements; i think the\nperformance loss if my patch is neglegible ... but who knows ...)\n\n by the way: is passing \"null\" argument as namespaceURI legal anyway?\n\nif one changes the test case from:\n\n elt.setAttributeNS(null, \"bar\", \"bar_value\");\n\nto\n\n elt.setAttribute( \"bar\", \"bar_value\");\n\nno exception happens. \n\n If \"null\" namespaces are not allowed \n(the w3c DOM-spec says nothing about it, because it is defined\nin IDL, wich does not case about Java \"null\"; but seems reasonable\nto me, that namespaces should not be null),\n this bug report is invalid and the patch obsolete.\n\n Instead one should throw an exception in \"setAttributeNS\" instead\n(which happens already now, if the attribute name contains namespace\ndefinition; change:\n\n elt.setAttributeNS(null, \"bar\", \"bar_value\");\n\nto:\n\n elt.setAttributeNS(null, \"foo:bar\", \"bar_value\");\n\nto see the exception.\n"}, {"count": 2, "tags": [], "bug_id": 6607, "is_private": false, "text": "Created attachment 1523\npatch allowing \"null\"-namespaceURIs in Element.getAttributeNS", "id": 13260, "time": "2002-04-11T16:07:01Z", "creator": "clerob@infonie.de", "creation_time": "2002-04-11T16:07:01Z", "attachment_id": 1523}, {"count": 3, "tags": [], "bug_id": 6607, "attachment_id": null, "is_private": false, "id": 13261, "time": "2002-04-11T16:15:05Z", "creator": "cjolif@ilog.fr", "creation_time": "2002-04-11T16:15:05Z", "text": "FYI, a <null> namespace is perfectly conformant to W3C DOM. So this have to be\nfixed. From DOM Level 2 recommendation:\n\n\"Applications must use the value null as the namespaceURI parameter for methods\nif they wish to have no namespace.\"\n"}, {"count": 4, "tags": [], "creator": "clerob@infonie.de", "attachment_id": null, "id": 13283, "time": "2002-04-11T21:31:13Z", "bug_id": 6607, "creation_time": "2002-04-11T21:31:13Z", "is_private": false, "text": " Er, Christophe is right ... I should have read the spec before\nmake statements about it :("}]