[{"count": 0, "tags": [], "bug_id": 38468, "attachment_id": null, "id": 85282, "time": "2006-02-01T01:43:52Z", "creator": "apache@personal.fishh2o.com", "creation_time": "2006-02-01T01:43:52Z", "is_private": false, "text": "Patch for HTMLLayout.java to allow the user of the logger to turn the html header/footer off if needed.\n\nI'm using log4j to output some html but I'm doing this within an existing webpage.  Therefore, I don't \nneed/want the html header/footer that the logger normally prints out.\n\nAdded the member var shouldWriteHtmlHeaderAndFooter and the appropriate if statements to make \nthe desired effect.  Also added an assessor and setter for shouldWriteHtmlHeaderAndFooter.\n\n\nThanx for the awesome logging lib.\n\n\n\nIndex: HTMLLayout.java\n===============================================================\n====\nRCS file: /home/cvspublic/logging-log4j/src/java/org/apache/log4j/html/HTMLLayout.java,v\nretrieving revision 1.7\ndiff -u -r1.7 HTMLLayout.java\n--- HTMLLayout.java\t22 May 2005 07:56:22 -0000\t1.7\n+++ HTMLLayout.java\t3 Oct 2005 20:42:58 -0000\n@@ -66,6 +66,7 @@\n   private FormattingInfo[] patternFields;\n   private String timezone;\n   private String title = \"Log4J Log Messages\";\n+  private boolean shouldWriteHtmlHeaderAndFooter = true;\n \n   private boolean internalCSS = false;\n   private String url2ExternalCSS = \"http://logging.apache.org/log4j/docs/css/eventTable-1.0.css\";\n@@ -109,6 +110,16 @@\n   public String getConversionPattern() {\n     return pattern;\n   }\n+\u00a0\n+  public boolean shouldWriteHtmlHeaderAndFooter()\n+  {\n+\treturn shouldWriteHtmlHeaderAndFooter;\n+  }\n+\u00a0\n+  public void setShouldWriteHtmlHeaderAndFooter(boolean shouldWriteHtmlHeaderAndFooter)\n+  {\n+\tthis.shouldWriteHtmlHeaderAndFooter = shouldWriteHtmlHeaderAndFooter;\n+  }\n \n   /**\n    * Does not do anything as options become effective\n@@ -236,28 +247,31 @@\n    */\n   public String getHeader() {\n     StringBuffer sbuf = new StringBuffer();\n-    sbuf.append(\"<!DOCTYPE HTML PUBLIC \\\"-//W3C//DTD HTML 4.01 Transitional//EN\\\"\");\n-    sbuf.append(\" \\\"http://www.w3.org/TR/html4/loose.dtd\\\">\");\n-    sbuf.append(Layout.LINE_SEP);\n-    sbuf.append(\"<html>\");\n-    sbuf.append(Layout.LINE_SEP);\n-    sbuf.append(\"<head>\");\n-    sbuf.append(Layout.LINE_SEP);\n-    sbuf.append(\"<title>\" + title + \"</title>\");\n-    sbuf.append(Layout.LINE_SEP);\n-    if(internalCSS) {\n-      getInternalCSS(sbuf);\n-    } else {\n-      sbuf.append(\"<LINK REL=StyleSheet HREF=\\\"\"+url2ExternalCSS+\"\\\" TITLE=\\\"Basic\\\">\");\n-    }\n-    sbuf.append(Layout.LINE_SEP);\n-    sbuf.append(\"</head>\");\n-    sbuf.append(Layout.LINE_SEP);\n-    sbuf.append(\"<body>\");\n-    sbuf.append(Layout.LINE_SEP);\n-\u00a0\u00a0\u00a0\n-    sbuf.append(\"<hr size=\\\"1\\\" noshade>\");\n-    sbuf.append(Layout.LINE_SEP);\n+\t if(shouldWriteHtmlHeaderAndFooter)\n+\t {\n+\t\t sbuf.append(\"<!DOCTYPE HTML PUBLIC \\\"-//W3C//DTD HTML 4.01 Transitional//EN\\\"\");\n+\t\t sbuf.append(\" \\\"http://www.w3.org/TR/html4/loose.dtd\\\">\");\n+\t\t sbuf.append(Layout.LINE_SEP);\n+\t\t sbuf.append(\"<html>\");\n+\t\t sbuf.append(Layout.LINE_SEP);\n+\t\t sbuf.append(\"<head>\");\n+\t\t sbuf.append(Layout.LINE_SEP);\n+\t\t sbuf.append(\"<title>\" + title + \"</title>\");\n+\t\t sbuf.append(Layout.LINE_SEP);\n+\t\t if(internalCSS) {\n+\t\t\tgetInternalCSS(sbuf);\n+\t\t } else {\n+\t\t\tsbuf.append(\"<LINK REL=StyleSheet HREF=\\\"\"+url2ExternalCSS+\"\\\" TITLE=\\\"Basic\\\">\");\n+\t\t }\n+\t\t sbuf.append(Layout.LINE_SEP);\n+\t\t sbuf.append(\"</head>\");\n+\t\t sbuf.append(Layout.LINE_SEP);\n+\t\t sbuf.append(\"<body>\");\n+\t\t sbuf.append(Layout.LINE_SEP);\n+\t\t\n+\t\t sbuf.append(\"<hr size=\\\"1\\\" noshade>\");\n+\t\t sbuf.append(Layout.LINE_SEP);\n+\t }\n \u00a0\u00a0\u00a0\n     sbuf.append(\"Log session start time \" + new java.util.Date() + \"<br>\");\n     sbuf.append(Layout.LINE_SEP);\n@@ -290,9 +304,12 @@\n   public String getFooter() {\n     StringBuffer sbuf = new StringBuffer();\n     sbuf.append(\"</table>\" + Layout.LINE_SEP);\n-    sbuf.append(\"<br>\" + Layout.LINE_SEP);\n-    sbuf.append(\"</body></html>\");\n-    return sbuf.toString();\n+\t if(shouldWriteHtmlHeaderAndFooter)\n+\t {\n+\t\tsbuf.append(\"<br>\" + Layout.LINE_SEP);\n+\t\tsbuf.append(\"</body></html>\");\n+    }\n+\t return sbuf.toString();\n   }\n \n   /**"}, {"count": 1, "tags": [], "bug_id": 38468, "attachment_id": null, "id": 85283, "time": "2006-02-01T04:52:25Z", "creator": "carnold@apache.org", "creation_time": "2006-02-01T04:52:25Z", "is_private": false, "text": "Good idea, but the name is awkward.  I thought bodyOnly might be better until I saw that you had the \nbody element as part of the header.  Maybe innerOnly?  Any other suggestions?"}, {"count": 2, "tags": [], "creator": "apache@personal.fishh2o.com", "attachment_id": null, "is_private": false, "id": 85284, "time": "2006-02-01T05:01:53Z", "bug_id": 38468, "creation_time": "2006-02-01T05:01:53Z", "text": "Maybe bodyOnly is good and then also add a way to turn off the body tag."}, {"count": 3, "tags": [], "creator": "lilianne_blaze@tlen.pl", "attachment_id": null, "text": "I think it would be more flexible with three properties, \"bodyOnly\" as in above\ncomments - personally I think \"dataOnly\" name would be better, and\n\"generateHeader\" / \"generateFooter\" to control both parts independently.\nPlus, maybe add \"header\" / \"footer\" properties to override default header/footer\ntext?\nI don't see the point (though I have nothing against it as long as default vaule\n is reasonable - false) of providing an option to skip header/footer while still\ngenerating \"<body>\" / \"</body>\" tags. If really needed, it would be possible\nwith above properties simply as: header=\"<body>\", footer=\"</body>\".", "id": 97721, "time": "2007-01-06T12:40:19Z", "bug_id": 38468, "creation_time": "2007-01-06T12:40:19Z", "is_private": false}, {"count": 4, "tags": [], "text": "Can be accomplished using XSLTAppender in the extras companion which is hugely configurable.  Marking \nas won't fix.", "attachment_id": null, "id": 107095, "creator": "carnold@apache.org", "time": "2007-08-22T19:05:53Z", "bug_id": 38468, "creation_time": "2007-08-22T19:05:53Z", "is_private": false}]