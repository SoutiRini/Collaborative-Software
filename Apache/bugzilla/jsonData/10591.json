[{"count": 0, "tags": [], "bug_id": 10591, "attachment_id": null, "id": 19166, "time": "2002-07-09T14:03:53Z", "creator": "kevinj@develop.com", "creation_time": "2002-07-09T14:03:53Z", "is_private": false, "text": "I'm using TC 4.1.7 and I have a JNDI resource referencing an MSSQL database. \nThe context looks like this\n\n<Context path=\"/AddressBook\" docBase=\"AddressBook\" debug=\"0\"  \nreloadable=\"true\">\n  <Logger className=\"org.apache.catalina.logger.SystemOutLogger\" \ntimestamp=\"true\"/>\n  <Loader checkInterval=\"3\"/>\n  <Resource name=\"jdbc/WhitePages\" auth=\"Container\"  \ntype=\"javax.sql.DataSource\"/>\n  <ResourceParams name=\"jdbc/WhitePages\">\n    <parameter>\n      <name>username</name>\n      <value>sa</value>\n    </parameter>\n    <parameter>\n      <name>password</name>\n      <value></value>\n    </parameter>\n    <parameter>\n      <name>driverClassName</name>\n      <value>com.microsoft.jdbc.sqlserver.SQLServerDriver</value>\n    </parameter>\n    <parameter>\n      <name>url</name>\n      \n<value>jdbc:microsoft:sqlserver://localhost:1433;DatabaseName=WhitePages</value\n>\n    </parameter>\n  </ResourceParams>\n</Context>\n\nIn my servlet::init I do\n\n            ctx = new javax.naming.InitialContext();\n            ds = (javax.sql.DataSource)ctx.lookup\n(\"java:comp/env/jdbc/WhitePages\");\n            System.err.println(\"init: have a datasource: \" + ds);\n\n\nand this prints\n\n            ctx = new javax.naming.InitialContext();\n            ds = (javax.sql.DataSource)ctx.lookup\n(\"java:comp/env/jdbc/WhitePages\");\n            System.err.println(\"init: have a datasource: \" + ds);\n\n\nin my doGet I do\n\n        java.sql.Connection conn = null;\n        try\n        {\n            System.err.println(\"getConnection\");\n            synchronized(ds)\n            {\n                System.err.println(\"getConnection\");\n                conn = ds.getConnection();\n            }\n\nand the call to getConnection *never* returns\n\nI'm running the full 4.1.7 install on Windows XP Pro, JDK 1.4_01\n\nIn 4.0.4 the default behaviour (with Tyrex) works, however if I move to the \nJakarta commons JNDI classes and specify the factory as \norg.apache.commons.dbcp.BasicDataSourceFactory\nthen this also hangs\n\nTo get this to work I also have to add\n\n    <parameter>\n      <name>maxActive</name>\n      <value>20</value>\n    </parameter>\n\n(I guess the value is irrelevant but I haven't tried that)\n\nSurely this should work with the default?"}, {"text": "This is either a DBCP bug or a bug with MS SQL.", "tags": [], "bug_id": 10591, "attachment_id": null, "count": 1, "id": 19167, "time": "2002-07-09T14:09:53Z", "creator": "remm@apache.org", "creation_time": "2002-07-09T14:09:53Z", "is_private": false}, {"count": 2, "tags": [], "creator": "kevinj@develop.com", "attachment_id": null, "id": 19171, "time": "2002-07-09T14:43:17Z", "bug_id": 10591, "creation_time": "2002-07-09T14:43:17Z", "is_private": false, "text": "Reported as a DBCP bug (10592)"}, {"count": 3, "tags": [], "bug_id": 10591, "attachment_id": null, "is_private": false, "id": 19173, "time": "2002-07-09T14:53:04Z", "creator": "remm@apache.org", "creation_time": "2002-07-09T14:53:04Z", "text": "Thanks."}]