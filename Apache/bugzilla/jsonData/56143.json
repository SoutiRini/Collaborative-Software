[{"count": 0, "tags": [], "bug_id": 56143, "text": "If you use a Microsoft Windows OS that has UAC and use service.bat script to install Tomcat as a service, you have to first launch command console (cmd.exe) in elevated privileges mode (\"Run as administrator\") and then call \"service.bat install\" from there.\n\nThis requirement is mentioned in Tomcat documentation:\nhttp://tomcat.apache.org/tomcat-7.0-doc/windows-service-howto.html#Installing_services\n\n[quote]\nNOTE: On Windows Vista or any other operating system with User Account Control (UAC) you must either disable UAC or right-click on cmd.exe and select \"Run as administrator\" in order to run this script. If UAC is enabled being logged on with an Administrator account is not sufficient. \n[/quote]\n\n\n\nIf you forget to launch cmd.exe in that mode and just run \"service.bat install\",  with the current Tomcat versions (6.0.39, 7.0.50, 8.0.3) you will be prompted 3 times by UAC [3], but the service will be installed incorrectly.\n\nWith r1565781 / r1567742 (7.0.52) this was improved and you will be prompted by UAC only once, but still the service will be installed incorrectly.\n\n\nThe cause for this behaviour is that install command in service.bat script uses environment variables (such as PR_CLASSPATH) to pass parameters to service installer (prunsrv).[1] Apparently, when a child application is launched with elevated privileges it does not inherit environment variables from its parent. [2]\n\nThe consequence is that a number of crucial settings in the installed service will be blank. For example, its classpath and its log path will be blank.\n\nAs a result, an attempt to launch such service will fail shortly and silently, as Tomcat bootstrap classes are not found and logging is not configured either.\n\n(There will be some logs in %SystemRoot%\\system32\\LogFiles\\Apache  though).\n\n\nA workaround is to fix such configuration by using service configuration application (tomcat7w.exe) to configure missing options.\n\n\nI hope that this can be solved by changing service.bat so that all necessary options are passed as command-line arguments instead of variables.\n\nFor reference:\n[1] Apache Commons Daemon documentation\nhttp://commons.apache.org/proper/commons-daemon/procrun.html\n\n[2] \"Re: r1567742\" thread on dev mailing list\nhttp://tomcat.markmail.org/thread/tjmwxc5vb5ut4zuq\n\n[3] Bug 56079\nhttps://issues.apache.org/bugzilla/show_bug.cgi?id=56079#c6", "id": 173059, "time": "2014-02-16T13:16:15Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2014-02-16T13:16:15Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "knst.kolinko@gmail.com", "text": "Fixed in Tomcat 8 by r1568779, docs updated by r1568786. Will be in 8.0.4.", "id": 173060, "time": "2014-02-16T16:12:27Z", "bug_id": 56143, "creation_time": "2014-02-16T16:12:27Z", "is_private": false, "attachment_id": null}, {"count": 2, "attachment_id": null, "bug_id": 56143, "is_private": false, "id": 173070, "time": "2014-02-17T11:24:22Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2014-02-17T11:24:22Z", "tags": [], "text": "Fixed in Tomcat 7 by r1568920 and will be in 7.0.53."}, {"count": 3, "tags": [], "creator": "knst.kolinko@gmail.com", "is_private": false, "text": "Fixed in Tomcat 6 with r1589390 , will be in 6.0.40.", "id": 174801, "time": "2014-04-23T12:50:11Z", "bug_id": 56143, "creation_time": "2014-04-23T12:50:11Z", "attachment_id": null}, {"count": 4, "attachment_id": null, "bug_id": 56143, "is_private": false, "id": 176042, "time": "2014-06-25T14:41:15Z", "creator": "AAlauddin@ebix.com", "creation_time": "2014-06-25T14:41:15Z", "tags": [], "text": "Hi Konstantin,\n\nI am getting permission issue only for tomcat service while installing TOMCAT 7 on windows 2000 server.\n\nI logged into the server with Administrator privileges. \nPlease update with your feedback.\n\nThanks,\nAbdul Wahid"}, {"count": 5, "attachment_id": null, "bug_id": 56143, "is_private": false, "id": 176055, "time": "2014-06-25T22:33:14Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2014-06-25T22:33:14Z", "tags": [], "text": "(In reply to Abdul Wahid from comment #4)\n\nYou are asking on a different topic. Your question cannot be answered here."}]