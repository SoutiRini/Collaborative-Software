[{"count": 0, "tags": [], "creator": "amseager@mail.ru", "text": "Tried to open docx file in that way:\n\nFile wordFile = new File(wordFilePath);\nOPCPackage wordPackage = OPCPackage.open(wordFile, PackageAccess.READ_WRITE);\nXWPFDocument wordDocument = new XWPFDocument(wordPackage);\n\nThen I caught this exception:\n\nException in thread \"main\" org.apache.poi.openxml4j.exceptions.OpenXML4JRuntimeException: Rule M2.4 exception : this error should NEVER happen! If you can provide the triggering file, then please raise a bug at https://bz.apache.org/bugzilla/enter_bug.cgi?product=POI and attach the file that triggers it, thanks!\n\tat org.apache.poi.openxml4j.opc.internal.ContentTypeManager.getContentType(ContentTypeManager.java:340)\n\tat org.apache.poi.openxml4j.opc.internal.ContentTypeManager.removeContentType(ContentTypeManager.java:253)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.removePart(OPCPackage.java:1020)\n\tat org.apache.poi.openxml4j.opc.PackagePart.getOutputStream(PackagePart.java:519)\n\tat org.apache.poi.xwpf.usermodel.XWPFDocument.commit(XWPFDocument.java:764)\n\tat org.apache.poi.POIXMLDocumentPart.onSave(POIXMLDocumentPart.java:414)\n\tat org.apache.poi.POIXMLDocument.write(POIXMLDocument.java:242)", "id": 201429, "time": "2017-10-13T09:36:47Z", "bug_id": 61612, "creation_time": "2017-10-13T09:36:47Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "amseager@mail.ru", "text": "Created attachment 35415\nFile which triggered an exception\n\nCouldn't send it directly (Bugzilla rased an error), so I zipped it", "id": 201430, "time": "2017-10-13T09:38:35Z", "bug_id": 61612, "creation_time": "2017-10-13T09:38:35Z", "is_private": false, "attachment_id": 35415}, {"count": 2, "tags": [], "bug_id": 61612, "attachment_id": 35416, "id": 201431, "creation_time": "2017-10-13T09:40:24Z", "time": "2017-10-13T09:40:24Z", "creator": "amseager@mail.ru", "text": "Created attachment 35416\nAnother example, triggered that exception too", "is_private": false}, {"count": 3, "tags": [], "bug_id": 61612, "attachment_id": null, "id": 202948, "time": "2017-12-28T14:07:37Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2017-12-28T14:07:37Z", "is_private": false, "text": "The first zip contains an document with zero bytes length. The second does not reproduce the problem for me with the latest version of POI.\n\nTherefore I am closing this as INVALID for now, if this is still a problem for you please re-run the example with the latest version of Apache POI and then reopen and attach both the triggering document and the full self-sufficient code for reproducing the problem here."}]