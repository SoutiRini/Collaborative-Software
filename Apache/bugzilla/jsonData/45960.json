[{"count": 0, "tags": [], "bug_id": 45960, "attachment_id": null, "id": 121262, "creation_time": "2008-10-07T00:22:20Z", "time": "2008-10-07T00:22:20Z", "creator": "support_niveau_3_socle_technique_j2ee.grprec@agora.msa.fr", "text": "I use an ant script to build an EAR file.\n\nThis script runs fine since years on Unix systems.\nOn Windows, an exception happens with the following message :\n\nD:\\DevWebSDI02\\NE00P\\UEDIE\\bin\\Z55C02.xml:325: IOException in D:\\DevWebSDI02\\wlo\\DWRDZ82TEI\\EAR\\online\\Agora\\z55cnxtest\\WEB-INF\\web.xml - java.io.IOException:Failed to delete D:\\DevWebSDI02\\wlo\\DWRDZ82TEI\\EAR\\online\\Agora\\z55cnxtest\\WEB-INF\\web.xml while trying to rename D:\\DevWebSDI02\\wlo\\DWRDZ82TEI\\EAR\\online\\Agora\\z55cnxtest\\WEB-INF\\rep371926229.tmp\n\n\nThe line 325 and followings are :\n<replace file=\"${ear.dir}${file.separator}$...\" propertyfile=\"${scriptsdir}$...\">\n  <replacefilter token=\"@@@@ROLE_USER@@@@\" property=\"ROLE_USER_${templ}\" />\n  <replacefilter token=\"@@@@AUTH_METHOD@@@@\" property=\"AUTH_METHOD_${templ}\" />\n</replace>\n\nThe ant version used is Eclipse's one org.apache.ant_1.7.0.v200706080842\nThe same problem happens with Ant 1.7.1.\n\nMy workaround is to call System.gc() when entering in the replace method of the file FileUtils.java\n\nBut it has an effect on speed execution.\n\nI had also found some posts about this problem and Stefan Bodewig was talking about relations between JVM and Windows file systems but unfortunately, I cannot retrieve these posts.", "is_private": false}, {"count": 1, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "text": "I've looked through my archives of the last two years but don't find the post you talked about, it may have been older than that.\n\nAnyway.\n\nAnt has just closed the file (because it had to read it) and it may very well be that the JVM hasn't released the file handle to the operating system yet (and your call to GC made it release the handle).  We have had similar cases in <delete> where we explicitly insert a System.gc() on Windows and retry after sleeping for a 10 millis if a call to delete() fails - we could introduce the same in replace as well.\n\n", "id": 121336, "time": "2008-10-09T04:43:22Z", "bug_id": 45960, "creation_time": "2008-10-09T04:43:22Z", "is_private": false}, {"count": 2, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "text": "should work better with svn trunk revision 703151.", "id": 121341, "time": "2008-10-09T05:23:30Z", "bug_id": 45960, "creation_time": "2008-10-09T05:23:30Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 45960, "text": "I'll test as soon as possible.\nThanks", "id": 121394, "time": "2008-10-10T03:00:07Z", "creator": "support_niveau_3_socle_technique_j2ee.grprec@agora.msa.fr", "creation_time": "2008-10-10T03:00:07Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 45960, "text": "correction seems good but I can't access to Apache SVN repositories from my company.", "id": 122995, "time": "2008-12-02T04:48:27Z", "creator": "support_niveau_3_socle_technique_j2ee.grprec@agora.msa.fr", "creation_time": "2008-12-02T04:48:27Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "is_private": false, "id": 123027, "time": "2008-12-03T01:32:45Z", "bug_id": 45960, "creation_time": "2008-12-03T01:32:45Z", "text": "you can download a snapshot of Ant's trunk from http://svn.apache.org/snapshots/ant/"}, {"count": 6, "tags": [], "bug_id": 45960, "text": "I've just made a test.\nThe bug is fixed.", "id": 123034, "time": "2008-12-03T03:19:39Z", "creator": "support_niveau_3_socle_technique_j2ee.grprec@agora.msa.fr", "creation_time": "2008-12-03T03:19:39Z", "is_private": false, "attachment_id": null}]