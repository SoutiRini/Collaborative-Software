[{"count": 0, "tags": [], "bug_id": 9576, "attachment_id": null, "is_private": false, "id": 17070, "time": "2002-06-03T14:39:49Z", "creator": "apache@grau.net", "creation_time": "2002-06-03T14:39:49Z", "text": "I created a simple XLS file using the attached code.\nThe file is loaded by Excel 97 without any problems.\nThe same file imported into Access 97 fails with the\nerror message \"External table ins't in the expected format\"\nIf I load the file into Excel, save it in Excel and\nthe import it into Access, it works fine. If you need\nmore information or want me to test anything, please\nlet me know.\n\nThanx,\n\n  Guenther\n\n\npackage test;\n\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport org.apache.poi.hssf.usermodel.*;\n\npublic class PoiTest {\n\n  public static void main(String[] args) {\n  \tHSSFWorkbook workbook = new HSSFWorkbook();\n  \tHSSFSheet sheet = workbook.createSheet(\"TestSheet\");\n  \t\n  \tHSSFRow row = sheet.createRow((short)0);\n\tHSSFCell cell = row.createCell((short)0);\n\tcell.setCellValue(\"Hallo\");\n\tcell = row.createCell((short)1);\n\tcell.setCellValue(7);\n\t\n  \trow = sheet.createRow((short)1);\n\tcell = row.createCell((short)0);\n\tcell.setCellValue(42);\n\tcell = row.createCell((short)1);\n\tcell.setCellValue(\"end\");\n\t\n\ttry {\n\t  FileOutputStream outputStream = new FileOutputStream(\"c:\\\\test.xls\");\n\t  workbook.write(outputStream);\n\t  outputStream.close();\n\t}\n\tcatch (IOException ioException) {\n\t  ioException.printStackTrace();\n\t}\n  }\n}"}, {"count": 1, "tags": [], "bug_id": 9576, "attachment_id": null, "is_private": false, "id": 17071, "time": "2002-06-03T15:23:23Z", "creator": "poi-support@buni.org", "creation_time": "2002-06-03T15:23:23Z", "text": "I don't plan to strive for MS Access compatibility (Excel/OpenOffice/Gnumeric\nonly), but if you'd like to track this down and contribute, we'll be happy to\naccept contributions."}, {"count": 2, "tags": [], "bug_id": 9576, "attachment_id": null, "id": 23134, "time": "2002-09-20T01:32:20Z", "creator": "poi-support@buni.org", "creation_time": "2002-09-20T01:32:20Z", "is_private": false, "text": "Please confirm but I think this is fixed in 1.8  I think it was the same thing\nthat corrupted macros..."}, {"count": 3, "tags": [], "bug_id": 9576, "attachment_id": null, "id": 29981, "time": "2003-01-24T03:51:13Z", "creator": "jheight@apache.org", "creation_time": "2003-01-24T03:51:13Z", "is_private": false, "text": "Sorry but this is not fixed.\n\nI am trying to perform a mail merge with a POI generated sheet and am getting a \nvery similar error. \n\nThe real reason for this failing is the DBCell and Index Records are not fully \nimplemented. I will be looking into this shortly BUT the firewall at my \nemployer currently blocks CVS access :-( So i cant download the source just yet.\n\nDont suppose someone has coincidently written DBCell support properly and not \ncommitted it to CVS ;-) ?\n\nJason"}, {"count": 4, "tags": [], "bug_id": 9576, "attachment_id": null, "id": 29982, "time": "2003-01-24T03:58:48Z", "creator": "poi-support@buni.org", "creation_time": "2003-01-24T03:58:48Z", "is_private": false, "text": "no but I can certainly tar.gz an extract up and stick it on my server.  It would\nbe chill to have Index/DBCell support.  The catch is that its kind of a pain,\nwhen you add a DBCell you have to change all the indexes in Index, but then\nadding one moves them down."}, {"count": 5, "tags": [], "bug_id": 9576, "attachment_id": null, "is_private": false, "id": 29983, "time": "2003-01-24T04:03:05Z", "creator": "jheight@apache.org", "creation_time": "2003-01-24T04:03:05Z", "text": "Yup Meaty little bug to fix eh? ;-) \n\nYeah if you could place the code somewhere & let me know. I went looking on the \nwebsite for a nightly tar ball of CVS but couldnt find one (only the nightly \nbinary builds!). Perhaps this could be easily setup and then by Monday i will \nhave a version i can at least download?\n\nJason"}, {"count": 6, "tags": [], "text": "Created attachment 4661\nPatch to allow Access, Word Mail Merge import the sheet", "attachment_id": 4661, "id": 30397, "creator": "jheight@apache.org", "time": "2003-01-31T10:50:21Z", "bug_id": 9576, "creation_time": "2003-01-31T10:50:21Z", "is_private": false}, {"count": 7, "tags": [], "text": "OK I see now why the DBCell and Index functionality hasnt been done up to \nnow.. It was a real pain (but i still had fun doing it, well actually only \nwhen it started to work ;-)\n\nThis is a large patch so suggestions are welcome. \n\nThere are some issues that I think need to be cleaned up after this patch is \naccepted, but i was thinking that i could include another patch at a later \ndate if it is agreed that these issues should be resolved:\n1) Removal of the old code that attempted to do this work from \nRowRecordsAggregate.\n2) RowRecordsAggregate and ValueRecordsAggregate.serialize is no longer called \nso they can be removed.\n3) I dont understand the need for the serialize method that returns the byte \narray. Since this doesnt seem to be called. (Although i could be wrong on this \none, i didnt spend alot of time on it)\n4) A unit test for this (although basically the unit tests that write a set of \nrows will already test these changes)\n5) The lookup of rows from the RowRecordsAggregate and cells from \nValueRecordAggregate seems sub optimal in certain situations (see comments in \npatch)\n\nThe patch will create the DBCell and Index records in the output stream but \nfor most people to this point they have lived without this functionality. \nMaybe there should be a flag for the Sheet that tells it whether to write \nthese records or not?\n\nThanks\n\nJason\n", "is_private": false, "id": 30398, "creator": "jheight@apache.org", "time": "2003-01-31T11:02:07Z", "bug_id": 9576, "creation_time": "2003-01-31T11:02:07Z", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 9576, "attachment_id": null, "is_private": false, "id": 30400, "time": "2003-01-31T11:11:54Z", "creator": "jheight@apache.org", "creation_time": "2003-01-31T11:11:54Z", "text": "Actually i just did a little test and I suspect the quickest way to resolve \nthe original BUG is simply to not write the INDEX and DBCell records at all. \nThe problem with Access not being able to import was due to the fact that HSSF \noriginally didnt ignore INDEX records but it did ignore DBCELL records (INDEX \nrecords reference DBCell records, so the INDEX record would have been \nreferencing an invalid location in the resultant excel file). I am 95% sure of \nthis (I dont have Access, i only have Word at home here, so i can only do a \nmail merge. I suspect that both mail merge and Access import both use DDE, \nhence my confidence. I will check on this when i get back to work)\n\nHowever assuming that i am correct, Do you want me to modify the previous \npatch to have a flag on Sheet (and exposed in HSSFSheet) that will turn the \nWriting of DBCell & INDEX records on/off?\n\nLet me know..\n\nJason"}, {"count": 9, "tags": [], "bug_id": 9576, "attachment_id": null, "is_private": false, "id": 30401, "time": "2003-01-31T12:19:19Z", "creator": "apache@grau.net", "creation_time": "2003-01-31T12:19:19Z", "text": "Hi,\n\nsince you are requesting feedback:\n\nFirst, let me thank you for looking into this problem!!!\n\nNow for the comments:\nI'd prefer if this file would be written in the exact format (or as close as\npossible to it) that Excel would write. This would give it the most likelyhood\nthat it will work well with other programs depending on the format. \nI don't mind adding a method to strip off unneeded data if wanted but IMHO the\ndefault behaviour should be as described above.\n\nBut as I don't have a clue what the format actually looks like, this might be\ntotally off topic. Anyways, these were just my 2 cents (pick currency yourself :-)\n\nThanx again,\n\n  Guenther"}, {"count": 10, "tags": [], "bug_id": 9576, "attachment_id": null, "id": 30533, "time": "2003-02-03T01:52:07Z", "creator": "jheight@apache.org", "creation_time": "2003-02-03T01:52:07Z", "is_private": false, "text": "Please dont apply the current patch. I just tried it at work where i have MS \nAccess available and it still doesnt import !\n\nInvestigating....\n\nJason"}, {"count": 11, "tags": [], "text": "Created attachment 4717\nFinal WORKING patch for DBCell, Index and EXTSST records!", "is_private": false, "id": 30630, "creator": "jheight@apache.org", "time": "2003-02-04T12:06:19Z", "bug_id": 9576, "creation_time": "2003-02-04T12:06:19Z", "attachment_id": 4717}, {"count": 12, "tags": [], "bug_id": 9576, "attachment_id": null, "id": 30633, "time": "2003-02-04T12:10:01Z", "creator": "jheight@apache.org", "creation_time": "2003-02-04T12:10:01Z", "is_private": false, "text": "\n*** Can someone please apply this patch. ***\n\nThis patch implements the DBCellRecord, IndexRecord and ExtSSTRecord correctly.\n\nThese records are required for MailMerge to excel files, and Import into \nAccess to work correctly.\n\nAs mentioned else where, the need to create a Collection over the TreeMap in \nthe RowRecordAggregate and ValueRecordAggregate is a performance penalty and \none which I will investigate ways of reducing after this patch is applied.\n\nThe testcases now work with this patch (they didnt half way through the \ndevelopment).\n\nThanks\n\nJason"}, {"count": 13, "tags": [], "bug_id": 9576, "attachment_id": null, "is_private": false, "id": 30644, "time": "2003-02-04T13:44:15Z", "creator": "poi-support@buni.org", "creation_time": "2003-02-04T13:44:15Z", "text": "Glen is going to commit his zoom stuff tonight.  Then I do this.  Then we do\nDanny's and any other various trinkets lying around.  Then we cut a dev release.\n Then I kiss your feet, thank you for doing this.  :-)"}, {"text": "I had trouble apply this so I did cvs update -r version against the Sheet and\nWorkbook, where version = the version cited in the patch.  Applied, did cvs\nupdate -A for sheet and workbook and recompiled/tested.  this seems to have\nworked for compilation. Before releasing we need to make sure these sheets work\nin excel.  Also while the unit tests pass, I do not see NEW unit tests for\nEXTSST/ DBCELL and INDEX.  I would really like to see those submited because I\nguarantee we're going to break these like OVER and OVER again otherwise.  I\npromise absolutely!\n\nIn anycase, a test failed (and boy formulas took forever):\n\nRunning org.apache.poi.hssf.usermodel.TestNamedRange\nTests run: 1, Failures: 1, Errors: 0, Time elapsed: 0.824 sec\n\nBUILD FAILED\n/home/andy/poipatch/jakarta-poi/tools/cents/junit.cent/xbuild.xml:59: Test\norg.apache.poi.hssf.usermodel.TestNamedRange failed\n\nTotal time: 5 minutes 51 seconds\n\nformula test:\n\nRunning org.apache.poi.hssf.usermodel.TestFormulas\nTests run: 21, Failures: 0, Errors: 0, Time elapsed: 236.824 sec\n\nI think we need some more consideration here, I'm sorry to say.  Can you look\ninto this further?\n", "tags": [], "creator": "poi-support@buni.org", "attachment_id": null, "count": 14, "id": 30930, "time": "2003-02-08T16:41:10Z", "bug_id": 9576, "creation_time": "2003-02-08T16:41:10Z", "is_private": false}, {"count": 15, "tags": [], "bug_id": 9576, "attachment_id": null, "is_private": false, "id": 30966, "time": "2003-02-09T21:52:17Z", "creator": "jheight@apache.org", "creation_time": "2003-02-09T21:52:17Z", "text": "Odd this patch definitly passed all tests on my machine ;-)\n\nNever mind that though I will write some unit tests and make DAMN sure that \nthey work. Maybe I will get to it today. Otherwise tonight. Give me 24 hours.\n\nJason"}, {"count": 16, "tags": [], "creator": "poi-support@buni.org", "is_private": false, "text": "its probably because of the new stuff.  ", "id": 30968, "time": "2003-02-09T22:05:53Z", "bug_id": 9576, "creation_time": "2003-02-09T22:05:53Z", "attachment_id": null}, {"count": 17, "tags": [], "creator": "jheight@apache.org", "is_private": false, "text": "Created attachment 5238\nUnified Diff Patch. This doesnt address the concerns that people had with the patch. I will do this shortly", "id": 32757, "time": "2003-03-10T02:38:34Z", "bug_id": 9576, "creation_time": "2003-03-10T02:38:34Z", "attachment_id": 5238}, {"count": 18, "tags": [], "bug_id": 9576, "attachment_id": null, "id": 33493, "time": "2003-03-19T21:50:28Z", "creator": "jheight@apache.org", "creation_time": "2003-03-19T21:50:28Z", "is_private": false, "text": "*** Bug 18149 has been marked as a duplicate of this bug. ***"}, {"count": 19, "tags": [], "bug_id": 9576, "attachment_id": null, "is_private": false, "id": 37853, "time": "2003-05-27T17:31:33Z", "creator": "apache@grau.net", "creation_time": "2003-05-27T17:31:33Z", "text": "Hi,\n\nI downloaded the patch from 2003-03-10 (attach_id=5238) and applied it and I\nstill can't import generated XLS file into access 97:\n\nExternal table isn't in the expected format.\n\nGuenther"}, {"count": 20, "tags": [], "bug_id": 9576, "attachment_id": 6514, "id": 37854, "time": "2003-05-27T17:33:27Z", "creator": "apache@grau.net", "creation_time": "2003-05-27T17:33:27Z", "is_private": false, "text": "Created attachment 6514\nTest file generated by HSSF"}, {"count": 21, "tags": [], "creator": "apache@grau.net", "is_private": false, "text": "Created attachment 6515\nHSSF generated file loaded in Excel and saved", "id": 37855, "time": "2003-05-27T17:35:31Z", "bug_id": 9576, "creation_time": "2003-05-27T17:35:31Z", "attachment_id": 6515}, {"count": 22, "tags": [], "bug_id": 9576, "attachment_id": null, "is_private": false, "id": 37856, "time": "2003-05-27T17:42:14Z", "creator": "apache@grau.net", "creation_time": "2003-05-27T17:42:14Z", "text": "Hi,\n\nI just added two attachments for this bug.\nThe first is a test file generated by HSSF.\nIf I import this directly into access I get an error message (table not in\nexpected format).\nI loaded this file into Excel and saved it as test-ms.xls, which is the second\nattachment I just added. The second attachment can be imported into Access\nwithout any problems. \n\nI used poi-pre2.0 src with the patch from 2003-03-10 applied. (I get the same\nresults if the patch is not applied).\n\nI'd be really glad if someone could look into this, or tell me where I should\nstart to look :-)\n\nThanx in advance,\n\n  Guenther\n\n\nThe Java-code to create the file is very simple:\npublic class Test {\n  public static void main(String[] args) {\n  \ttry {\n      HSSFWorkbook workbook = new HSSFWorkbook();\n      HSSFSheet sheet = workbook.createSheet(\"Hallo\");\n      HSSFRow row = sheet.createRow(0);\n      short cellIndex = 0;\n      HSSFCell cell = row.createCell(cellIndex);\n      cell.setCellValue(\"Hello world\");\n      FileOutputStream output = new FileOutputStream(\"c:/test.xls\");\n  \t  workbook.write(output);\n  \t  output.close();\n  \t} catch (Exception e) {\n  \t  e.printStackTrace();\n  \t}\n      }\n}"}, {"count": 23, "tags": [], "bug_id": 9576, "attachment_id": null, "id": 44282, "time": "2003-09-18T02:25:27Z", "creator": "jheight@apache.org", "creation_time": "2003-09-18T02:25:27Z", "is_private": false, "text": "I have patched the head and as of now it should work fine."}]