[{"count": 0, "tags": [], "bug_id": 59893, "attachment_id": 34067, "text": "Created attachment 34067\nreplace available() calls and add forbidden-apis-check\n\nIn #59841 I've realized a lot of wrong calls to InputStream.available().\nThe wrong assumption is, that it returns the bytes until the EOF, whereas it really return the bytes until the next blocking read [1]\n\nSo when working with streams, you really need to read until EOF and not rely on available().\n\nThis patch removes most of the calls to available() or ignores them for delegates.\n\n\n[1] http://stackoverflow.com/questions/3695372/what-does-inputstream-available-do-in-java", "id": 192582, "time": "2016-07-23T12:11:41Z", "creator": "kiwiwings@apache.org", "creation_time": "2016-07-23T12:11:41Z", "is_private": false}, {"count": 1, "tags": [], "creator": "kiwiwings@apache.org", "attachment_id": 34068, "id": 192584, "time": "2016-07-23T18:01:57Z", "bug_id": 59893, "creation_time": "2016-07-23T18:01:57Z", "is_private": false, "text": "Created attachment 34068\nreplace available() calls and add forbidden-apis-check\n\nfix issue with PropertySet"}, {"text": "The patch has a number of unrelated changes, whitespaces, @Test, ... can you apply those and re-base the patch, that would make reviewing much easier.", "tags": [], "bug_id": 59893, "attachment_id": null, "count": 2, "id": 192636, "time": "2016-07-26T05:33:28Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-07-26T05:33:28Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 59893, "attachment_id": 34760, "text": "Created attachment 34760\npatch with some of the unrelated code removed\n\nI committed some of Andi's unrelated changes from attachment 34068 in r1783347 and r1783353.\n\nSome of the line numbers may be off since I deleted unrelated changes from the patch by directly editing the text file.", "id": 197107, "time": "2017-02-17T09:10:21Z", "creator": "onealj@apache.org", "creation_time": "2017-02-17T09:10:21Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 59893, "attachment_id": null, "is_private": false, "id": 197108, "time": "2017-02-17T09:28:02Z", "creator": "onealj@apache.org", "creation_time": "2017-02-17T09:28:02Z", "text": "ChunkedCipherInputStream.read needs attention. Changed from checking the return value of reading from the underlying stream from 1 to -1.\n\nI have temporarily reverted this to restore the original behavior in 1783356. This should probably have been put back into the patch that excludes the unrelated stuff, since this behavior is related to the available() changes."}, {"text": "r1783356", "tags": [], "bug_id": 59893, "attachment_id": null, "count": 5, "id": 197109, "time": "2017-02-17T09:28:20Z", "creator": "onealj@apache.org", "creation_time": "2017-02-17T09:28:20Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 59893, "attachment_id": 34761, "id": 197111, "time": "2017-02-17T09:55:21Z", "creator": "onealj@apache.org", "creation_time": "2017-02-17T09:55:21Z", "is_private": false, "text": "Created attachment 34761\npatch with all of the unrelated code removed\n\nLess than half the size of the original. Hopefully this makes it easier to review, though it still needs to be rebased to trunk."}, {"count": 7, "tags": [], "bug_id": 59893, "attachment_id": null, "text": "(unrelated changes) close leaked resources in r1783362", "id": 197112, "time": "2017-02-17T09:56:01Z", "creator": "onealj@apache.org", "creation_time": "2017-02-17T09:56:01Z", "is_private": false}]