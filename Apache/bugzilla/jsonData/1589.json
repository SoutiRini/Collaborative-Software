[{"count": 0, "tags": [], "bug_id": 1589, "text": "I have encountered a problem trying to use a run-time valued attribute\nwhose tag java code implementation wants to take the value as an Object.\n\nIn detail, the custom tag tld is like:\n\n  <tag>\n    <name>bar</name>\n    ...\n    <attribute>\n       <name>value</name>\n       <required>false</required>\n       <rtexprvalue>true</rtexprvalue>\n    </attribute>\n  </tag>\n\nand underlying Java tag library code that takes the value of this attribute is:\n\n  public void setValue( Object value )\n\nThe usage of this tag fails in tomcat-3.2.1 when invoked in a JSP as:\n\n  <foo:bar value=\"x\"/>\n\nThe problem here seems to be that the method convertString in\nsrc/share/org/apache/jasper/compiler/TagBeginGenerator.java is missing a\ncheck for the Object type.  I think that changing the first few lines of that\ncode from:\n        if (c == String.class) {\n            return writer.quoteString(s);\n        } else if (c == boolean.class) {\nto:\n        if (c == String.class) {\n            return writer.quoteString(s);\n        } else if (c == Object.class) {\n            return writer.quoteString(s);\n        } else if (c == boolean.class) {\n\nwould solve this problem.", "id": 2189, "time": "2001-05-01T10:33:42Z", "creator": "bprice@evergreen.com", "creation_time": "2001-05-01T10:33:42Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "cmanolache@yahoo.com", "is_private": false, "text": "Fixed in 3.3", "id": 5277, "time": "2001-09-09T23:57:18Z", "bug_id": 1589, "creation_time": "2001-09-09T23:57:18Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 1589, "attachment_id": null, "is_private": false, "id": 5286, "time": "2001-09-10T06:01:04Z", "creator": "Larry.Isaacs@sas.com", "creation_time": "2001-09-10T06:01:04Z", "text": "I'm afraid I'm going to have to unfix this one.  Use of this feature would\nmake a web application non-portable.\n\nThough I haven't found it explicitly stated, I believe the intent was that\ntaglib attributes receive the same conversions as jsp:setProperty. Conversion\nto Object isn't listed for JSP 1.1.  The workaround is for the attribute\nto accept realtime expressions and use:\n\n    value=\"<%= x %>\"\n\nIMPORTANT NOTE: You will have to do the same for JSP 1.2.  The JSP 1.2 spec\ndoes include conversion to Object, but does so *differently*.  The spec says\nthat conversion to Object is \"As if new String(string-literal)\".  Thus, in\nJSP 1.2:\n\n    value=\"x\"\n\nis equivalent to:\n\n    value=\"<%= new String(\"x\") %>\"\n\nwhich I don't think is what you are looking for.\n"}, {"count": 3, "tags": [], "bug_id": 1589, "text": "Implementing this would be in violation of the JSP 1.1 spec and inconsistent\nwith the JSP 1.2 spec.", "id": 5287, "time": "2001-09-10T06:02:23Z", "creator": "Larry.Isaacs@sas.com", "creation_time": "2001-09-10T06:02:23Z", "is_private": false, "attachment_id": null}]