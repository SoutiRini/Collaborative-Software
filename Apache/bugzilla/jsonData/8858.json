[{"count": 0, "tags": [], "creator": "XZTYOYWEHSIC@spammotel.com", "attachment_id": null, "id": 15613, "time": "2002-05-07T09:16:06Z", "bug_id": 8858, "creation_time": "2002-05-07T09:16:06Z", "is_private": false, "text": "The following code:\n\tpublic static void main(String[] aArgs) throws IOException {\n\t\tInputStream in = PoiTest.class.getResourceAsStream(\"KW_d.xls\");\n\t\tHSSFWorkbook workBook = new HSSFWorkbook(in);\n\t\tint nbSheets = workBook.getNumberOfSheets();\n\t\tSystem.out.println(\"The Excel document has \"+nbSheets+\" sheet\");\n\t\tSystem.out.println(\"The names are:\");\n\t\tfor( int i=0; i<nbSheets; ++i) {\n\t\t\tSystem.out.println( \"\"+i+\". \"+workBook.getSheetName(i));\n\t\t}\n\t\t\n\t\tOutputStream out = new FileOutputStream\n(\"C:/temp/ExcelTest.xls\");\n\t\tworkBook.write( out );\n\t\tout.close();\n\t}\n\nThrows the following exception:\njava.lang.ArrayIndexOutOfBoundsException\n\tat org.apache.poi.util.StringUtil.putUncompressedUnicode\n(StringUtil.java:175)\n\tat org.apache.poi.hssf.record.UnicodeString.serialize\n(UnicodeString.java:299)\n\tat org.apache.poi.hssf.record.Record.serialize(Record.java:168)\n\tat org.apache.poi.hssf.record.SSTRecord.serialize(SSTRecord.java:541)\n\tat org.apache.poi.hssf.model.Workbook.serialize(Workbook.java:664)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.getBytes\n(HSSFWorkbook.java:505)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.write\n(HSSFWorkbook.java:465)\n\tat com.consultens.poi.PoiTest.main(PoiTest.java:72)\nException in thread \"main\""}, {"count": 1, "tags": [], "creator": "XZTYOYWEHSIC@spammotel.com", "attachment_id": null, "id": 16056, "time": "2002-05-14T07:13:49Z", "bug_id": 8858, "creation_time": "2002-05-14T07:13:49Z", "is_private": false, "text": "Do you need additional information to tackle this bug? All our corporate\nexcelsheets I try to use ends in this or a simillary error. Perhaps I'm using\na wrong excel version, which excel version should be used with POI?\n\nI hope you can soon fix this bug, because otherwise we have to look for another\nsolution for our excel sheets. Although I would like to use a 100% java solution\nlike POI.\n\nThanks.\n\nDieter"}, {"count": 2, "tags": [], "creator": "glens@apache.org", "attachment_id": null, "id": 16057, "creation_time": "2002-05-14T07:27:13Z", "time": "2002-05-14T07:27:13Z", "bug_id": 8858, "text": "They actual excel file causing the crash would be handy.", "is_private": false}, {"count": 3, "tags": [], "creator": "XZTYOYWEHSIC@spammotel.com", "attachment_id": 1852, "id": 16060, "time": "2002-05-14T08:35:23Z", "bug_id": 8858, "creation_time": "2002-05-14T08:35:23Z", "is_private": false, "text": "Created attachment 1852\nExcel Sheet which reproduces the exception"}, {"count": 4, "tags": [], "creator": "poi-support@buni.org", "attachment_id": null, "id": 16065, "time": "2002-05-14T12:00:59Z", "bug_id": 8858, "creation_time": "2002-05-14T12:00:59Z", "is_private": false, "text": "I'll look at it.  You must use Excel 97 or newer.\n\nThis file has =Embed(blabla) functions in it.  I've never seen such a thing. \nSecondly it has embedded graphics.  My money is on the =Embed(blabla). \nRegardless I'll look at it probably this weekend.  This is 2.0 stuff.  (we don't\nclaim to support embedded graphics or formulas)"}, {"count": 5, "attachment_id": null, "bug_id": 8858, "is_private": false, "id": 16066, "time": "2002-05-14T12:22:41Z", "creator": "XZTYOYWEHSIC@spammotel.com", "creation_time": "2002-05-14T12:22:41Z", "tags": [], "text": "Hi Andy,\n\nthanks for your answer. Which version of Excel is now exactly supported?\n\nI don't think, that the Image is the problem. Probably the =Embed(blabla).\nI didn't created the excel sheets, so I don't know what the =Embed(blabla)\nstuff is at all. Do you know how they can be removed?"}, {"count": 6, "tags": [], "text": "I said Excel 97+.  Delete the =Embed(xx) (and probably the image with it) and\npaste the image directly.", "is_private": false, "bug_id": 8858, "id": 16067, "time": "2002-05-14T12:29:53Z", "creator": "poi-support@buni.org", "creation_time": "2002-05-14T12:29:53Z", "attachment_id": null}, {"count": 7, "attachment_id": 1857, "bug_id": 8858, "is_private": false, "id": 16068, "time": "2002-05-14T12:46:56Z", "creator": "XZTYOYWEHSIC@spammotel.com", "creation_time": "2002-05-14T12:46:56Z", "tags": [], "text": "Created attachment 1857\nExcelsheet without the picture"}, {"count": 8, "attachment_id": null, "bug_id": 8858, "text": "I removed the picture from the excel sheet and saved the file with Excel 2000.\nThe same error still occures.", "id": 16069, "time": "2002-05-14T12:48:42Z", "creator": "XZTYOYWEHSIC@spammotel.com", "creation_time": "2002-05-14T12:48:42Z", "tags": [], "is_private": false}, {"count": 9, "tags": [], "text": "Looks like it might be something to do with the characterset.  Need to \ninvestigate more.", "attachment_id": null, "bug_id": 8858, "id": 16075, "time": "2002-05-14T13:48:52Z", "creator": "glens@apache.org", "creation_time": "2002-05-14T13:48:52Z", "is_private": false}, {"count": 10, "tags": [], "text": "is this possibly more RTF problems?  (rich text)", "attachment_id": null, "bug_id": 8858, "id": 16076, "time": "2002-05-14T13:50:19Z", "creator": "poi-support@buni.org", "creation_time": "2002-05-14T13:50:19Z", "is_private": false}, {"count": 11, "tags": [], "bug_id": 8858, "attachment_id": null, "id": 16112, "time": "2002-05-14T23:21:09Z", "creator": "glens@apache.org", "creation_time": "2002-05-14T23:21:09Z", "is_private": false, "text": "Nope, rtf's generally cause problems with reading.  a unicode problem i think."}, {"count": 12, "attachment_id": null, "bug_id": 8858, "is_private": false, "id": 16114, "time": "2002-05-15T00:05:16Z", "creator": "poi-support@buni.org", "creation_time": "2002-05-15T00:05:16Z", "tags": [], "text": "so are you looking at this or do you want me to?  I'm about to commit changes to\nthe record generator to make it autodefine tests."}, {"count": 13, "tags": [], "creator": "glens@apache.org", "attachment_id": null, "id": 16208, "creation_time": "2002-05-15T23:24:45Z", "time": "2002-05-15T23:24:45Z", "bug_id": 8858, "text": "Andy was right.  It's an rich text problem.  Deleting cell F8 fixed the \nproblem.  I didn't spot is straight away because it's doesn't look obviously \nformatted.\n\nWe don't support this one yet.  I think it was planned for 2.0 but maybe some \nkind sole will post a workaround that we may be able to put in 1.5.1.\n", "is_private": false}, {"count": 14, "attachment_id": null, "bug_id": 8858, "is_private": false, "id": 16227, "time": "2002-05-16T13:24:17Z", "creator": "XZTYOYWEHSIC@spammotel.com", "creation_time": "2002-05-16T13:24:17Z", "tags": [], "text": "Hi Glen,\n\nhow can I see which cells are wrong formatted? I see no differences from this\ncell to the other cells?"}, {"count": 15, "tags": [], "bug_id": 8858, "text": "I had a hard time spotting it too.  I only discovered it through debugging the \nworkbook.  It doesn't appear formatted to me but it's definately being stored \nas rich text.  ", "id": 16273, "time": "2002-05-16T23:45:29Z", "creator": "glens@apache.org", "creation_time": "2002-05-16T23:45:29Z", "is_private": false, "attachment_id": null}]