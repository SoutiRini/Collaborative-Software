[{"count": 0, "tags": [], "creator": "java@enerpred.ru", "is_private": false, "text": "Hi. I have such build script:\n==================build.xml========================\n<project name=\"agapi\" default=\"dist\" basedir=\".\">\n    <property file=\".ant.properties\"/>\n\n    <property name=\"build.dir\" value=\"${basedir}/build\"/>\n    <property name=\"src.dir\" value=\"${basedir}/src\"/>\n    <property name=\"jboss.client\" value=\"${jboss.home}/client\"/>\n    <property name=\"jboss.lib\" value=\"${jboss.home}/lib\"/>\n    <property name=\"build.x.dir\" value=\"${build.dir}/classes\"/>\n\n    <fileset id=\"hibernate.mapfiles\" dir=\"${build.x.dir}\">\n        <include name=\"**/*.hbm.xml\"/>\n    </fileset>\n\n\n    <path id=\"ejb.base.path\">\n        <pathelement location=\"${jboss.client}/jboss-j2ee.jar\"/>\n        <pathelement location=\"${jboss.client}/jboss-client.jar\"/>\n        <pathelement location=\"${jboss.client}/jnp-client.jar\"/>\n        <pathelement location=\"${jboss.client}/jbossmq-client.jar\"/>\n        <pathelement location=\"${jboss.client}/jbosssx-client.jar\"/>\n        <pathelement location=\"${jboss.client}/concurrent.jar\"/>\n        <pathelement location=\"${jboss.client}/jaas.jar\"/>\n        <pathelement location=\"${jboss.lib}/jboss-jmx.jar\"/>\n        <pathelement location=\"${jboss.lib}/jboss-common.jar\"/>\n        <pathelement location=\"${jboss.home}/server/\n${jboss.configuration}/lib/jbosssx.jar\"/>\n        <pathelement location=\"${jboss.home}/server/\n${jboss.configuration}/lib/mail.jar\"/>\n        <pathelement location=\"${jboss.home}/server/\n${jboss.configuration}/lib/jnet.jar\"/>\n    </path>\n\n    <path id=\"xdoclet.path\">\n        <pathelement location=\"${ant.home}/lib/ant.jar\"/>\n        <fileset dir=\"${xdoclet.home}/lib\">\n            <include name=\"**/*.jar\"/>\n        </fileset>\n    </path>\n\n    <path id=\"oracle.path\">\n        <fileset dir=\"${basedir}/lib\">\n            <include name=\"**/oracle/*.jar\"/>\n        </fileset>\n    </path>\n\n    <path id=\"hibernate.path\">\n        <pathelement location=\"${hibernate.home}/hibernate2.jar\"/>\n        <fileset dir=\"${hibernate.home}/lib\">\n            <include name=\"**/*.jar\"/>\n        </fileset>\n    </path>\n\n\n    <target name=\"init\">\n        <mkdir dir=\"${build.dir}\"/>\n        <mkdir dir=\"${build.x.dir}\"/>\n        <mkdir dir=\"${build.dir}/generated\"/>\n        <mkdir dir=\"${build.dir}/META-INF\"/>\n    </target>\n\n    <target name=\"dist\" depends=\"clean,init,xdoclet-generate,compile,hibernate-\ngenerate,jar-beans,jar-server,jar-client,deploy\"/>\n\n    <target name=\"compile\" depends=\"init,xdoclet-generate\">\n        <javac\n            destdir=\"${build.x.dir}\"\n            debug=\"on\"\n            deprecation=\"off\"\n            optimize=\"on\">\n            <src path=\"${src.dir}\"/>\n            <src path=\"${build.dir}/generated\"/>\n            <classpath>\n                <path refid=\"hibernate.path\"/>\n                <path refid=\"xdoclet.path\"/>\n                <path refid=\"ejb.base.path\"/>\n            </classpath>\n        </javac>\n    </target>\n\n    <target name=\"hibernate-generate\" depends=\"compile\">\n        <taskdef name=\"hibernatedoclet\" \nclassname=\"xdoclet.modules.hibernate.HibernateDocletTask\">\n            <classpath refid=\"xdoclet.path\"/>\n        </taskdef>\n        <hibernatedoclet\n            destdir=\"${build.x.dir}\"\n            excludedtags=\"@version,@author,@todo\"\n            force=\"true\"\n            mergedir=\"${build.dir}\"\n            verbose=\"true\">\n\n            <fileset dir=\"${src.dir}\">\n                <exclude name=\"enerprom/agapi/metadata/**/*Abstract*\"/>\n                <include name=\"enerprom/agapi/metadata/**/*.java\"/>\n            </fileset>\n            <hibernate version=\"2.0\"/>\n\n        </hibernatedoclet>\n    </target>\n\n    <target name=\"xdoclet-generate\">\n        <taskdef name=\"ejbdoclet\" \nclassname=\"xdoclet.modules.ejb.EjbDocletTask\">\n            <classpath>\n                <path refid=\"ejb.base.path\"/>\n                <path refid=\"xdoclet.path\"/>\n            </classpath>\n        </taskdef>\n        <ejbdoclet\n            destdir=\"${build.dir}/generated\"\n            excludedtags=\"@version,@author\"\n            ejbspec=\"${ejb.version}\"\n            verbose=\"true\"\n            force=\"${xdoclet.force}\">\n\n            <fileset dir=\"${src.dir}\">\n                <include name=\"**/*Bean.java\"/>\n            </fileset>\n            <packageSubstitution packages=\"session,persistence,entity\" \nsubstituteWith=\"interfaces\"/>\n            <!-- <valueobject/> -->\n            <dataobject/>\n            <remoteinterface/>\n            <homeinterface/>\n\n            <localinterface/>\n            <localhomeinterface/>\n\n            <entitypk/>\n            <entitybmp/>\n            <entitycmp/>\n\n            <deploymentdescriptor destdir=\"${build.dir}/META-INF\"/>\n            <jboss version=\"${jboss.version}\"\n                destdir=\"${build.dir}/META-INF\"\n                validateXml=\"false\"/>\n        </ejbdoclet>\n    </target>\n\n    <target name=\"jar-beans\" depends=\"compile\">\n        <jar jarfile=\"${basedir}/agapiBeans.jar\">\n            <fileset dir=\"${build.x.dir}\">\n                <exclude name=\"enerprom/agapi/client/\"/>\n                <exclude name=\"enerprom/agapi/metadata/\"/>\n                <include name=\"**\"/>\n            </fileset>\n            <fileset dir=\"${build.dir}\" includes=\"META-INF/**\"/>\n        </jar>\n    </target>\n\n    <target name=\"jar-server\" depends=\"compile\">\n        <jar jarfile=\"${basedir}/agapipersist.sar\">\n            <fileset dir=\"${build.x.dir}\">\n                <include name=\"enerprom/agapi/metadata/\"/>\n            </fileset>\n            <fileset dir=\"${src.dir}\" includes=\"META-INF/jboss-service.xml\"/>\n        </jar>\n    </target>\n\n    <target name=\"jar-client\" depends=\"compile\">\n        <jar jarfile=\"${basedir}/agapiClient.jar\">\n            <fileset dir=\"${build.x.dir}\">\n                <include name=\"enerprom/agapi/client/\"/>\n            </fileset>\n            <fileset dir=\"${build.dir}\" includes=\"META-INF/**\"/>\n        </jar>\n    </target>\n\n    <path id=\"hibernate.classpath\">\n        <path refid=\"hibernate.path\"/>\n        <path refid=\"oracle.path\"/>\n        <pathelement location=\"${build.x.dir}\"/>\n    </path>\n\n    <target name=\"initdb\" depends=\"compile\">\n        <pathconvert refid=\"hibernate.mapfiles\" property=\"tmp1\" pathsep=\" \"/>\n        <java classname=\"net.sf.hibernate.tool.hbm2ddl.SchemaExport\" \nfork=\"true\">\n            <classpath refid=\"hibernate.classpath\"/>\n            <arg path=\"${tmp1}\"/>\n        </java>\n    </target>\n\n\n    <target name=\"deploy\">\n        <copy todir=\"${jboss.home}/server/default/deploy\">\n            <fileset dir=\"${basedir}\">\n                <include name=\"agapipersist.sar\"/>\n                <include name=\"agapiBeans.jar\"/>\n            </fileset>\n        </copy>\n    </target>\n\n\n    <target name=\"clean\">\n        <delete dir=\"${build.dir}\"/>\n        <delete file=\"${basedir}/*.jar\"/>\n    </target>\n\n\n</project>\n=====================build.xml=============================\n\nAnd here, some log from ant -v initdb :\n=====================log===================================\nApache Ant version 1.5.3Beta1 compiled on March 24 2003\nBuildfile: build.xml\nDetected Java version: 1.4 in: c:\\j2sdk1.4.1_01\\jre\nDetected OS: Windows XP\nparsing buildfile build.xml with URI = file:C:/JAVA/PRJ/agapi/build.xml\nProject base dir set to: C:\\JAVA\\PRJ\\agapi\n [property] Loading C:\\JAVA\\PRJ\\agapi\\.ant.properties\nOverride ignored for property ant.home\nBuild sequence for target `initdb' is [init, xdoclet-generate, compile, initdb]\nComplete build sequence is [init, xdoclet-generate, compile, initdb, jar-\nbeans, deploy, clean, hibernate-generate, jar-server, jar-client, dist]\n\ninit:\n\nxdoclet-generate:\ndropping C:\\JSERVER\\jboss-3.0.6\\client\\jaas.jar from path as it doesn't exist\n\ncompile:\n    [javac] addProp2Hib.bat skipped - don't know how to handle it\n    [javac] enerprom\\agapi\\client\\AbstractReferenceFrame.java omitted as \nenerprom/agapi/client/AbstractReferenceFrame.class is up to date.\n    [javac] enerprom\\agapi\\client\\BeanFactory.java omitted as \nenerprom/agapi/client/BeanFactory.class is up to date.\n    [javac] enerprom\\agapi\\client\\BossClient.java omitted as \nenerprom/agapi/client/BossClient.class is up to date.\n    [javac] enerprom\\agapi\\client\\DealerFrame.java omitted as \nenerprom/agapi/client/DealerFrame.class is up to date.\n    [javac] enerprom\\agapi\\client\\InternalFrame.java omitted as \nenerprom/agapi/client/InternalFrame.class is up to date.\n    [javac] enerprom\\agapi\\client\\Main.java omitted as \nenerprom/agapi/client/Main.class is up to date.\n    [javac] enerprom\\agapi\\client\\myTableModel.java omitted as \nenerprom/agapi/client/myTableModel.class is up to date.\n    [javac] enerprom\\agapi\\client\\Test.java omitted as \nenerprom/agapi/client/Test.class is up to date.\n    [javac] enerprom\\agapi\\ejb\\DataSouceFactoryBean.java omitted as \nenerprom/agapi/ejb/DataSouceFactoryBean.class is up to date.\n    [javac] enerprom\\agapi\\metadata\\AbstractPersistent.java omitted as \nenerprom/agapi/metadata/AbstractPersistent.class is up to date.\n    [javac] enerprom\\agapi\\metadata\\reference\\Dealer.hbm.xml skipped - don't \nknow how to handle it\n    [javac] enerprom\\agapi\\metadata\\reference\\Dealer.java omitted as \nenerprom/agapi/metadata/reference/Dealer.class is up to date.\n    [javac] enerprom\\agapi\\metadata\\reference\\Userlogin.hbm.xml skipped - \ndon't know how to handle it\n    [javac] enerprom\\agapi\\metadata\\reference\\Userlogin.java omitted as \nenerprom/agapi/metadata/reference/Userlogin.class is up to date.\n    [javac] hibernate.properties skipped - don't know how to handle it\n    [javac] META-INF\\jboss-service.xml skipped - don't know how to handle it\n    [javac] enerprom\\agapi\\ejb\\DataSourceFactory.java omitted as \nenerprom/agapi/ejb/DataSourceFactory.class is up to date.\n    [javac] enerprom\\agapi\\ejb\\DataSourceFactoryHome.java omitted as \nenerprom/agapi/ejb/DataSourceFactoryHome.class is up to date.\n    [javac] enerprom\\agapi\\ejb\\DataSourceFactoryLocal.java omitted as \nenerprom/agapi/ejb/DataSourceFactoryLocal.class is up to date.\n    [javac] enerprom\\agapi\\ejb\\DataSourceFactoryLocalHome.java omitted as \nenerprom/agapi/ejb/DataSourceFactoryLocalHome.class is up to date.\n\ninitdb:\n[pathconvert] Set property tmp1 = \nC:\\JAVA\\PRJ\\agapi\\build\\classes\\enerprom\\agapi\\metadata\\reference\\Dealer.hbm.xm\nl \nC:\\JAVA\\PRJ\\agapi\\build\\classes\\enerprom\\agapi\\metadata\\reference\\Userlogin.hbm\n.xml\n     [java] Executing 'C:\\j2sdk1.4.1_01\\jre\\bin\\java.exe' with arguments:\n     [java] '-classpath'\n     [java] 'C:\\JSERVER\\hibernate-2.0\\hibernate2.jar;C:\\JSERVER\\hibernate-2.0\n\\lib\\ant.jar;C:\\JSERVER\\hibernate-2.0\\lib\\c3p0.jar;C:\\JSERVER\\hibernate-2.0\n\\lib\\cglib.jar;C:\\JSERVER\\hibernate-2.0\\lib\\commons-\nbeanutils.jar;C:\\JSERVER\\hibernate-2.0\\lib\\commons-\ncollections.jar;C:\\JSERVER\\hibernate-2.0\\lib\\commons-\ndbcp.jar;C:\\JSERVER\\hibernate-2.0\\lib\\commons-lang.jar;C:\\JSERVER\\hibernate-2.0\n\\lib\\commons-logging.jar;C:\\JSERVER\\hibernate-2.0\\lib\\commons-\npool.jar;C:\\JSERVER\\hibernate-2.0\\lib\\connector.jar;C:\\JSERVER\\hibernate-2.0\n\\lib\\dom4j.jar;C:\\JSERVER\\hibernate-2.0\\lib\\jaas.jar;C:\\JSERVER\\hibernate-2.0\n\\lib\\jcs.jar;C:\\JSERVER\\hibernate-2.0\\lib\\jdbc2_0-\nstdext.jar;C:\\JSERVER\\hibernate-2.0\\lib\\jdom.jar;C:\\JSERVER\\hibernate-2.0\n\\lib\\jta.jar;C:\\JSERVER\\hibernate-2.0\\lib\\junit.jar;C:\\JSERVER\\hibernate-2.0\n\\lib\\odmg.jar;C:\\JSERVER\\hibernate-2.0\\lib\\optional.jar;C:\\JSERVER\\hibernate-\n2.0\\lib\\xalan.jar;C:\\JSERVER\\hibernate-2.0\\lib\\xerces.jar;C:\\JSERVER\\hibernate-\n2.0\\lib\\xml-\napis.jar;C:\\JAVA\\PRJ\\agapi\\lib\\oracle\\classes12.jar;C:\\JAVA\\PRJ\\agapi\\lib\\oracl\ne\\nls_charset12.jar;C:\\JAVA\\PRJ\\agapi\\build\\classes'\n     [java] 'net.sf.hibernate.tool.hbm2ddl.SchemaExport'\n     \n[java] 'C:\\JAVA\\PRJ\\agapi\\build\\classes\\enerprom\\agapi\\metadata\\reference\\Deale\nr.hbm.xml \nC;C:\\JAVA\\PRJ\\agapi\\build\\classes\\enerprom\\agapi\\metadata\\reference\\Userlogin.h\nbm.xml'\n     [java] \n     [java] The ' characters around the executable and arguments are\n     [java] not part of the command.\n     [java] 08.04.2003 13:14:46 net.sf.hibernate.cfg.Environment <clinit>\n     [java] INFO: Hibernate 2.0 beta 5\n     [java] 08.04.2003 13:14:46 net.sf.hibernate.cfg.Environment <clinit>\n     [java] INFO: loaded properties from resource hibernate.properties: \n{hibernate.connection.driver_class=oracle.jdbc.driver.OracleDriver, \nhibernate.dialect=net.sf.hibernate.dialect.OracleDialect, \nhibernate.jdbc.use_streams_for_binary=true, hibernate.jdbc.batch_size=0, \nhibernate.query.substitutions=true 1, false 0, yes 'Y', no 'N', \nhibernate.query.imports=net.sf.hibernate.test, net.sf.hibernate.eg, \nhibernate.connection.username=aware, \nhibernate.connection.url=jdbc:oracle:thin:@oraclser:1521:xm, \nhibernate.show_sql=true, hibernate.connection.password=vtkjxm, \nhibernate.statement_cache.size=0, hibernate.connection.pool_size=1}\n     [java] 08.04.2003 13:14:46 net.sf.hibernate.cfg.Environment <clinit>\n     [java] INFO: using java.io streams to persist binary types\n     [java] 08.04.2003 13:14:47 net.sf.hibernate.cfg.Environment <clinit>\n     [java] INFO: JVM proxy support: true\n     [java] 08.04.2003 13:14:47 net.sf.hibernate.cfg.Configuration addFile\n     [java] INFO: Mapping file: \nC:\\JAVA\\PRJ\\agapi\\build\\classes\\enerprom\\agapi\\metadata\\reference\\Dealer.hbm.xm\nl !++!\nC;C:\\JAVA\\PRJ\\agapi\\build\\classes\\enerprom\\agapi\\metadata\\reference\\Userlogin.h\nbm.xml\n     [java] 08.04.2003 13:14:47 net.sf.hibernate.cfg.Configuration addFile\n     [java] SEVERE: Could not configure datastore from file: \nC:\\JAVA\\PRJ\\agapi\\build\\classes\\enerprom\\agapi\\metadata\\reference\\Dealer.hbm.xm\nl \nC;C:\\JAVA\\PRJ\\agapi\\build\\classes\\enerprom\\agapi\\metadata\\reference\\Userlogin.h\nbm.xml\n     [java] org.dom4j.DocumentException: unknown protocol: c Nested exception: \nunknown protocol: c\n     [java] \tat org.dom4j.io.SAXReader.read(SAXReader.java:342)\n     [java] \tat org.dom4j.io.SAXReader.read(SAXReader.java:236)\n     [java] \tat net.sf.hibernate.cfg.Configuration.addFile\n(Configuration.java:152)\n     [java] \tat net.sf.hibernate.tool.hbm2ddl.SchemaExport.main\n(SchemaExport.java:273)\n     [java] Nested exception: \n=============================log================================\n\nPathconvert work perfect, but after I try to pass that result to <args it's \ngenerate C;C:\\... instead C:\\ I mark that place with !++!", "id": 34668, "time": "2003-04-08T05:42:11Z", "bug_id": 18795, "creation_time": "2003-04-08T05:42:11Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "It would really help if you'd cut your example to the relevant parts 8-)\n\nLet's see:\n\n<pathconvert refid=\"hibernate.mapfiles\" property=\"tmp1\" pathsep=\" \"/>\n\ngenerates\n\n[pathconvert] Set property tmp1 = \nC:\\JAVA\\PRJ\\agapi\\build\\classes\\enerprom\\agapi\\metadata\\reference\\Dealer.hbm.xm\nl \nC:\\JAVA\\PRJ\\agapi\\build\\classes\\enerprom\\agapi\\metadata\\reference\\Userlogin.hbm\n.xml\n\nYou say it works correctly, so this is what you want.  A space separated list of\nall files making up your hibernate.mapfiles fileset.\n\nThe you go on and use that property in\n\n<arg path=\"${tmp1}\"/>\n\nThe path attribute of <arg> expects as its value a String that looks like a\nPATH like environment variable.  You have the files separated by space, a PATH\nis separated by either : or ;.  Parsing your property,\n\"C:\\JAVA\\PRJ\\agapi\\build\\classes\\enerprom\\agapi\\metadata\\reference\\Dealer.hbm.xm\nl C\"\nbecomes the first part of your path as the first : is considered a disk\nspecifier and the next possible separator is the : after the C.  You get what you\nare asking for.\n\nIf you want the value of your property literally, use <arg value=\"${tmpl}\"/>\ninstead.\n\nI'm not closing this report as INVALID right now, as I don't know whether I have\nmisunderstood what you want and where the problem is.", "is_private": false, "id": 34679, "creator": "bodewig@apache.org", "time": "2003-04-08T06:39:04Z", "bug_id": 18795, "creation_time": "2003-04-08T06:39:04Z", "attachment_id": null}, {"count": 2, "attachment_id": null, "bug_id": 18795, "text": "ping?", "id": 35108, "time": "2003-04-14T11:47:50Z", "creator": "bodewig@apache.org", "creation_time": "2003-04-14T11:47:50Z", "tags": [], "is_private": false}]