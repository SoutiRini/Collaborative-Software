[{"count": 0, "attachment_id": null, "creator": "sebb@apache.org", "text": "Before clearing a test plan or exitting, JMeter checks to see if the test plan \nhas changed, and prompts the user to save it.\n\nSometimes, JMeter detects that the plan has changed when it hasn't.\nFor example, try loading GuiTest.jmx and then File> New. This prompts the user \nto save the plan, even though it has not changed.\n\nAt the moment, the code looks for differences in the tree from what it expects, \nbut this check sometimes leads to the wrong conclusion.\n\nThis bug report is a reminder to fix the problem.", "id": 48901, "time": "2003-12-11T13:52:03Z", "bug_id": 25441, "creation_time": "2003-12-11T13:52:03Z", "tags": [], "is_private": false}, {"count": 1, "attachment_id": null, "creator": "jsalvata@atg.com", "text": "Sebb: is this issue always a \"false positive\"? Or may it actually lead to data\nloss? In the former case, we'll label this as \"minor\".", "id": 51036, "time": "2004-01-23T02:12:37Z", "bug_id": 25441, "creation_time": "2004-01-23T02:12:37Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 25441, "is_private": false, "text": "Not 100% sure - I thought I'd noticed some changes that were not noticed \nrecently, but I need to check this. Suggest leaving as Normal for now.", "id": 51044, "time": "2004-01-23T11:13:56Z", "creator": "sebb@apache.org", "creation_time": "2004-01-23T11:13:56Z", "attachment_id": null}, {"count": 3, "attachment_id": null, "creator": "sebb@apache.org", "is_private": false, "id": 51063, "time": "2004-01-23T17:31:14Z", "bug_id": 25441, "creation_time": "2004-01-23T17:31:14Z", "tags": [], "text": "If you create a test plan by opening a jmx file and merging in another jmx (or \nseveral) the resulting plan is not automatically flagged as having been \nchanged - unless one of the file triggers the isDirty bug.\n\nThus there could be loss ot work."}, {"count": 4, "attachment_id": 20135, "creator": "alf@i100.no", "is_private": false, "id": 102888, "time": "2007-05-07T02:27:33Z", "bug_id": 25441, "creation_time": "2007-05-07T02:27:33Z", "tags": [], "text": "Created attachment 20135\nSuggested patch\n\nThis patch handles merging of test plans, by forcing the \"dirty\" flag to true\nwhen a test plan is merged into another test plan.\n\nThis patch also solves the problem where a test plan is incorrectly marked as\n\"dirty\" when it is not dirty. This happens when properties are set on the\ntestplan node, as described in bug 41779. The fix is to initialize the tree\nmodel with the node loaded from the test plan, instead of having the default\ntestplan node in the treemodel.\n\nThe patch also makes the \"Load\" action close the current testplan only when the\nuser selects a file to load. This means that if a user now has a currently open\ntest plan, then uses the \"Load\" menu option, but clicks \"Cancel\" in the file\ndialog, the test plan he had open is still open. Previously, the current test\nplan was closed before the file dialog appear, which is annoying.\n\nThis patch also fixes bug 41779, as mentioned above."}, {"count": 5, "tags": [], "creator": "sebb@apache.org", "attachment_id": null, "text": "Thanks - that's helped quite a bit. Applied in r535891.\n\nHowever, there's still a problem with plans being incorrectly marked as dirty.\n\nTest Plan\n- Simple Data Writer\nSave the plan.\n\nOpen the plan.\nClose the plan - no dialog box appears.\n\nOpen the plan, select the Simple Data Writer.\nClose the plan - the Save? dialogue appears.\nSame happens if you Resave the test plan - merely viewing the SDW causes the \nplan to be marked dirty.\nNot sure what is going on here (yet), but at least there is a simple test case!", "id": 102905, "time": "2007-05-07T08:12:05Z", "bug_id": 25441, "creation_time": "2007-05-07T08:12:05Z", "is_private": false}, {"count": 6, "attachment_id": null, "creator": "sebb@apache.org", "is_private": false, "id": 102908, "time": "2007-05-07T08:42:58Z", "bug_id": 25441, "creation_time": "2007-05-07T08:42:58Z", "tags": [], "text": "(In reply to comment #4)\n[...]\n> The patch also makes the \"Load\" action close the current testplan only when \nthe\n> user selects a file to load. This means that if a user now has a currently \nopen\n> test plan, then uses the \"Load\" menu option, but clicks \"Cancel\" in the file\n> dialog, the test plan he had open is still open. Previously, the current test\n> plan was closed before the file dialog appear, which is annoying.\n\nHowever, I've now fixed the Close action to allow for the user to cancel the \nclose - previously there was no cancel button, and the close (x) button was \ntreated the same as No.\n\nIf the user Opens an new file on an unsaved plan, the Save? (Close) dialog is \nnow presented when the user opens the file, and the cancel option is now \nignored, which is also annoying, as the user does not know the plan is dirty \nuntil too late...\n\nI think this needs a bit of tweaking.\n"}, {"count": 7, "attachment_id": null, "creator": "alf@i100.no", "is_private": false, "id": 102927, "time": "2007-05-08T01:55:33Z", "bug_id": 25441, "creation_time": "2007-05-08T01:55:33Z", "tags": [], "text": "(In reply to comment #5)\n> Thanks - that's helped quite a bit. Applied in r535891.\n> \n> However, there's still a problem with plans being incorrectly marked as dirty.\n> \n> Test Plan\n> - Simple Data Writer\n> Save the plan.\n> \n> Open the plan.\n> Close the plan - no dialog box appears.\n> \n> Open the plan, select the Simple Data Writer.\n> Close the plan - the Save? dialogue appears.\n> Same happens if you Resave the test plan - merely viewing the SDW causes the \n> plan to be marked dirty.\n> Not sure what is going on here (yet), but at least there is a simple test case!\n\n\nAll the Visualizers have this problem. If you select a Visualizer in the tree,\nthe test plan is then set as dirty by the CheckDirty action.\nThe reason is that AbstractVisualizer does a clone of the SampleSaveConfiguration :\ncollector.setSaveConfig((SampleSaveConfiguration) rc.getSaveConfig().clone());\n\nWhen CheckDirty then checks the visualizer node, the \"previous\" and \"current\"\nvalue is always different, because the \"current\" node has got a new\nSampleSaveConfiguration.\n\nOne way of solving this would be to implement the \"equals\" method of\nSampleSaveConfiguration, and then also the \"hashCode\" method.\n"}, {"count": 8, "attachment_id": null, "creator": "alf@i100.no", "text": "(In reply to comment #6)\n> (In reply to comment #4)\n> [...]\n> > The patch also makes the \"Load\" action close the current testplan only when \n> the\n> > user selects a file to load. This means that if a user now has a currently \n> open\n> > test plan, then uses the \"Load\" menu option, but clicks \"Cancel\" in the file\n> > dialog, the test plan he had open is still open. Previously, the current test\n> > plan was closed before the file dialog appear, which is annoying.\n> \n> However, I've now fixed the Close action to allow for the user to cancel the \n> close - previously there was no cancel button, and the close (x) button was \n> treated the same as No.\n> \n> If the user Opens an new file on an unsaved plan, the Save? (Close) dialog is \n> now presented when the user opens the file, and the cancel option is now \n> ignored, which is also annoying, as the user does not know the plan is dirty \n> until too late...\n> \n> I think this needs a bit of tweaking.\n> \n\n\nThe only way I see this can be improved, is by duplicating the code in the\n\"Close\" action in the \"Load\" action, and present the \"do you want to save\nchanges\" dialog from the \"Load\" action, and then take the necessary steps\ndepending on what the user wants.", "id": 102929, "time": "2007-05-08T02:32:38Z", "bug_id": 25441, "creation_time": "2007-05-08T02:32:38Z", "tags": [], "is_private": false}, {"count": 9, "attachment_id": 20155, "creator": "alf@i100.no", "is_private": false, "id": 102980, "time": "2007-05-09T01:40:01Z", "bug_id": 25441, "creation_time": "2007-05-09T01:40:01Z", "tags": [], "text": "Created attachment 20155\nImplement equals and hashCode for SampleSaveConfiguration\n\nThis suggested patch adds implementation of equals and hashCode method for the\nSampleSaveConfiguration class.\nIt also provides a more correct implementation of the clone method.\n\nWith these changes, you can select visualizers in the test plan, and the test\nplan is not marked as dirty, unless you change some properties of the\nvisualizers, for example some property of the SampleSaveConfiguration."}, {"count": 10, "tags": [], "bug_id": 25441, "is_private": false, "text": "Created attachment 20156\nUpdated patch for equals and hashcode\n\nUpdated to avoid NullPointer on clone", "id": 102983, "time": "2007-05-09T02:05:04Z", "creator": "alf@i100.no", "creation_time": "2007-05-09T02:05:04Z", "attachment_id": 20156}, {"count": 11, "tags": [], "bug_id": 25441, "is_private": false, "text": "(In reply to comment #10)\n> Created an attachment (id=20156) [edit]\n> Updated patch for equals and hashcode\n> Updated to avoid NullPointer on clone\n\nThanks - applied in r536710", "id": 103018, "time": "2007-05-09T16:26:16Z", "creator": "sebb@apache.org", "creation_time": "2007-05-09T16:26:16Z", "attachment_id": null}, {"count": 12, "tags": [], "creator": "sebb@apache.org", "attachment_id": null, "text": "(In reply to comment #8)\n> (In reply to comment #6)\n> > (In reply to comment #4)\n> > [...]\n> > > The patch also makes the \"Load\" action close the current testplan only \nwhen \n> > the\n> > > user selects a file to load. This means that if a user now has a \ncurrently \n> > open\n> > > test plan, then uses the \"Load\" menu option, but clicks \"Cancel\" in the \nfile\n> > > dialog, the test plan he had open is still open. Previously, the current \ntest\n> > > plan was closed before the file dialog appear, which is annoying.\n> > \n> > However, I've now fixed the Close action to allow for the user to cancel \nthe \n> > close - previously there was no cancel button, and the close (x) button \nwas \n> > treated the same as No.\n> > \n> > If the user Opens an new file on an unsaved plan, the Save? (Close) dialog \nis \n> > now presented when the user opens the file, and the cancel option is now \n> > ignored, which is also annoying, as the user does not know the plan is \ndirty \n> > until too late...\n> > \n> > I think this needs a bit of tweaking.\n> > \n> The only way I see this can be improved, is by duplicating the code in the\n> \"Close\" action in the \"Load\" action, and present the \"do you want to save\n> changes\" dialog from the \"Load\" action, and then take the necessary steps\n> depending on what the user wants.\n\nI've fixed this by putting the Close doAction() code in a static routine that \ncan be called by the Load class - see SVN r543879\n\nI think the bug is now all fixed - hoorah!", "id": 104009, "time": "2007-06-03T04:09:50Z", "bug_id": 25441, "creation_time": "2007-06-03T04:09:50Z", "is_private": false}]