[{"count": 0, "tags": [], "text": "Color color = Color.decode(\"#006B6B\");\nHSSFPalette palette = wb.getCustomPalette();\nHSSFColor hssfColor = palette.findColor((byte) color.getRed(), (byte) color.getGreen(),(byte) color.getBlue());\nif (hssfColor == null)\n{\n   palette.setColorAtIndex((short)(PaletteRecord.STANDARD_PALETTE_SIZE -1) , (byte) color.getRed(), (byte) color.getGreen(), (byte) color.getBlue());\n   hssfColor = palette.getColor((short)(PaletteRecord.STANDARD_PALETTE_SIZE -1) );\n\n....\n\n\nThis did not return Color that had been set to a specific index because the setColorIndex() in PaletteRecord picks wrong index. It set new color to the different index at byteIndex(the index that user wants HSSFPalette to add) - FIRST_COLOR_INDEX; (line 118 in PaletteRecord )", "attachment_id": null, "id": 132891, "creation_time": "2009-12-17T00:56:35Z", "time": "2009-12-17T00:56:35Z", "creator": "mobject@gmail.com", "bug_id": 48403, "is_private": false}, {"count": 1, "tags": [], "bug_id": 48403, "attachment_id": null, "id": 185530, "time": "2015-09-29T10:15:47Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-09-29T10:15:47Z", "is_private": false, "text": "I could not reproduce this with the latest POI 3.13/trunk, however I am not 100% sure to have understood the problem here. \n\nFor now there is a unit test at r1705830, please report a new bug if this is still a problem for you."}]