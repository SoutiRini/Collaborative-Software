[{"count": 0, "tags": [], "bug_id": 55326, "text": "The new directive SSLProxyCheckPeerName has no effect when using the proxy functionality of rewrite_module.\n\nSteps to reproduce:\n - Setup configuration like this on host a.example.org:\n\n   SSLProxyEngine on\n   SSLProxyCheckPeerName off\n   RewriteRule /status/(.*) https://$1/server-status [P]\n \n - When trying to access host b via host a ...\n   http://a.example.org/status/b\n   \n   mod_ssl raises an error:\n   AH02005: SSL Proxy: Peer certificate CN mismatch: Certificate CN: b.example.org Requested hostname: b\n\n\nIf you additionally add the old directive, it works just fine:\n\n   SSLProxyEngine on\n   SSLProxyCheckPeerName off\n   SSLProxyCheckPeerCN off\n   RewriteRule /status/(.*) https://$1/server-status [P]\n\nBut I do not think that this is intentional if SSLProxyCheckPeerName supersedes SSLProxyCheckPeerCN.", "id": 168913, "attachment_id": null, "creator": "hiding@falco.me", "creation_time": "2013-07-29T15:20:42Z", "time": "2013-07-29T15:20:42Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 55326, "attachment_id": null, "id": 168992, "time": "2013-08-01T05:59:51Z", "creator": "asfbugz@velox.ch", "creation_time": "2013-08-01T05:59:51Z", "is_private": false, "text": "(In reply to falco from comment #0)\n> If you additionally add the old directive, it works just fine:\n> \n>    SSLProxyEngine on\n>    SSLProxyCheckPeerName off\n>    SSLProxyCheckPeerCN off\n>    RewriteRule /status/(.*) https://$1/server-status [P]\n> \n> But I do not think that this is intentional if SSLProxyCheckPeerName\n> supersedes SSLProxyCheckPeerCN.\n\nIt is intentional, see http://httpd.apache.org/docs/2.4/mod/mod_ssl.html#sslproxycheckpeercn:\n\n\"In 2.4.5 and later, SSLProxyCheckPeerCN has been superseded by SSLProxyCheckPeerName, and its setting is only taken into account when SSLProxyCheckPeerName off is specified at the same time.\"\n\nSSLProxyCheckPeerName supersedes SSLProxyCheckPeerCN as far as the default settings are concerned. Turning off hostname checking for proxied https content mostly indicates a misunderstanding of the primary purpose of SSL (authentication), so I think it wouldn't be a good idea if \"SSLProxyCheckPeerName off\" would silently disable SSLProxyCheckPeerCN at the same time."}, {"count": 2, "tags": [], "creator": "hiding@falco.me", "text": "(In reply to Kaspar Brand from comment #1)\n> (In reply to falco from comment #0)\n> > If you additionally add the old directive, it works just fine:\n> > \n> >    SSLProxyEngine on\n> >    SSLProxyCheckPeerName off\n> >    SSLProxyCheckPeerCN off\n> >    RewriteRule /status/(.*) https://$1/server-status [P]\n> > \n> > But I do not think that this is intentional if SSLProxyCheckPeerName\n> > supersedes SSLProxyCheckPeerCN.\n> \n> It is intentional, see\n> http://httpd.apache.org/docs/2.4/mod/mod_ssl.html#sslproxycheckpeercn:\n> \n> \"In 2.4.5 and later, SSLProxyCheckPeerCN has been superseded by\n> SSLProxyCheckPeerName, and its setting is only taken into account when\n> SSLProxyCheckPeerName off is specified at the same time.\"\n> \n> SSLProxyCheckPeerName supersedes SSLProxyCheckPeerCN as far as the default\n> settings are concerned. Turning off hostname checking for proxied https\n> content mostly indicates a misunderstanding of the primary purpose of SSL\n> (authentication), so I think it wouldn't be a good idea if\n> \"SSLProxyCheckPeerName off\" would silently disable SSLProxyCheckPeerCN at\n> the same time.\n\nThank you for your reply.\nJust to make sure that I understood that correctly:\n\nSetting \"SSLProxyCheckPeerName off\":\n - disables \"SAN\" checking\n - hostname -has- to match CN\n * Is used if one want's to make sure, that remote host name and CN of its certificate are matching\n\n\nSetting \"SSLProxyCheckPeerName off\" and \"SSLProxyCheckPeerCN off\":\n - disables hostname matching at all\n * Is used if one doesn't care about the remote host name and its certificate\n\n\nSetting \"SSLProxyCheckPeerCN off\" without \"SSLProxyCheckPeerName off\":\n - doesn't do anything at all\n\nIf this is the case, then I agree, it is good that there's a way to disable SAN checking without ignoring the CN at all.\nI guess I was just irritated by the wording by the description of SSLProxyCheckPeerName and thought it would replace SSLProxyCheckPeerCN instead of offering another layer of security.", "id": 169022, "time": "2013-08-01T17:06:25Z", "bug_id": 55326, "creation_time": "2013-08-01T17:06:25Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 55326, "attachment_id": null, "id": 169082, "time": "2013-08-04T05:08:44Z", "creator": "asfbugz@velox.ch", "creation_time": "2013-08-04T05:08:44Z", "is_private": false, "text": "Your statements are correct, yes. Closing the bug, therefore."}]