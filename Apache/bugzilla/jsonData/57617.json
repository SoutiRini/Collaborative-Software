[{"count": 0, "tags": [], "bug_id": 57617, "is_private": false, "text": "Created attachment 32505\nhtml page\n\nHi,\n\nWe recently upgraded to 7.0.59 and have noticed that our file upload error reporting does not work any more. Our application usually uses ajax requests and various frameworks to handle this but we are able to reproduce this with the very basic attached example.\n\nExpected behaviour:\nWhen uploading a file that exceeds the specified limit, an error should be reported to the client.\n\nObserved behaviour:\nThe error is not returned to the client who instead encounters a \"The connection was reset\" error.\n\nThe above behaviour is observed when connecting to the http connector (see attached server.xml)\n\nIf we however connect to tomcat using mod_proxy_ajp we observe the expected behaviour (the client receives an error message).", "id": 181241, "time": "2015-02-23T04:06:41Z", "creator": "oliver.henlich@unimarket.com", "creation_time": "2015-02-23T04:06:41Z", "attachment_id": 32505}, {"count": 1, "tags": [], "bug_id": 57617, "attachment_id": 32506, "id": 181242, "time": "2015-02-23T04:07:13Z", "creator": "oliver.henlich@unimarket.com", "creation_time": "2015-02-23T04:07:13Z", "is_private": false, "text": "Created attachment 32506\njsp"}, {"count": 2, "text": "Created attachment 32507\nserver.xml", "bug_id": 57617, "is_private": false, "id": 181243, "time": "2015-02-23T04:07:54Z", "creator": "oliver.henlich@unimarket.com", "creation_time": "2015-02-23T04:07:54Z", "tags": [], "attachment_id": 32507}, {"count": 3, "tags": [], "bug_id": 57617, "attachment_id": null, "id": 181333, "time": "2015-02-25T15:00:47Z", "creator": "markt@apache.org", "creation_time": "2015-02-25T15:00:47Z", "is_private": false, "text": "You need to increase maxSwallowSize to a value greater than the size of the upload.\n\nTomcat drops the connection if more input bytes remain than maxSwallowSize.\n\nNote that as of Tomcat 7.0.60 Tomcat will read at least maxSwallowSize bytes before dropping the connection to give clients a chance to read the reponse.\n\nNote most clients don't read the response until the request has been fully written. You might want to consider using an expectation."}]