[{"count": 0, "tags": [], "creator": "jlawson-apache@bovine.net", "is_private": false, "text": "I am trying to define the \"X-Forwarded-For:\" header to be the IP address of the\nrequesting client when mod_proxy passes a request onto the destination server. \nI would expect that adding the following inside my <Proxy *></Proxy> block would\nhave that effect:\n\nRequestHeader set X-Forwarded-For \"%{REMOTE_ADDR}e\"\n\nHowever this just results in \"X-Forwarded-For: (null)\" being in the request\nheaders received by the destination server.  I have tried other variables, such\nas \"%{PATH}e\" with the same result so this leads me to be believe that there is\nsomething inherently wrong with variable expansion.", "id": 60033, "time": "2004-06-29T06:44:39Z", "bug_id": 29856, "creation_time": "2004-06-29T06:44:39Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "nick@webthing.com", "attachment_id": null, "id": 60039, "time": "2004-06-29T07:14:08Z", "bug_id": 29856, "creation_time": "2004-06-29T07:14:08Z", "is_private": false, "text": "CGI environment variables don't exist in httpd.conf!\n\nYou might be able to work it with some combo of mods [setenvif|rewrite|macro],\nbut what you're trying looks wrong."}, {"count": 2, "text": "That's pretty unfortunate.  I might choose to disagree about your terminology\nsince the mod_rewrite page classifies REMOTE_ADDR as a \"server-variable\"\n<http://httpd.apache.org/docs-2.0/mod/mod_rewrite.html#rewritecond>\n\nJust for the benefit of anyone else who ever needs to do the same thing, you can\ndo this by adding the following lines inside of your <Proxy *></Proxy> block\nusing mod_headers and mod_rewrite:\n\nRewriteEngine On\nRewriteCond %{REMOTE_ADDR} ^(.*)\nRewriteRule ^.* - [env=MY_REMOTE_ADDR:%1]\nRequestHeader set X-Forwarded-For \"%{MY_REMOTE_ADDR}e\"", "bug_id": 29856, "is_private": false, "id": 60040, "time": "2004-06-29T08:09:59Z", "creator": "jlawson-apache@bovine.net", "creation_time": "2004-06-29T08:09:59Z", "tags": [], "attachment_id": null}]