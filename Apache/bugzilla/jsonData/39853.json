[{"count": 0, "tags": [], "creator": "carnold@apache.org", "attachment_id": null, "text": "The global variable errno, include file errno.h and the macros ERANGE and EINVAL\nare not supported on Windows CE.  APR has an preprocessor macro APR_HAVE_ERRNO_H\nwhich signals that errno.h is not available, but the implementation of\napr_strtoi64 does not check that macro before attempting to set errno when range\nor invalid conditions are detected.\n\nThe attached patch places the setting of errno into #if's and also #if's two\ntests in test/teststr.c that expect range errors to be signaled through errno.\n\nFor background, compare the documentation of strtol in Win32 and WinCE and\nnotice the WinCE documentation drops any mention of errno.\n\nWindows definition of strtol:\nhttp://msdn2.microsoft.com/en-us/w4z2wdyc.aspx\n\nWindows CE definition of strtol:\nhttp://msdn.microsoft.com/library/default.asp?url=/library/en-us/wceappdev5/html/wce50lrfstrtolcmawcstol.asp", "id": 90450, "time": "2006-06-21T22:09:08Z", "bug_id": 39853, "creation_time": "2006-06-21T22:09:08Z", "is_private": false}, {"count": 1, "tags": [], "creator": "carnold@apache.org", "attachment_id": 18496, "text": "Created attachment 18496\nChecks APR_HAS_ERRNO_H before accessing errno", "id": 90451, "time": "2006-06-21T22:10:43Z", "bug_id": 39853, "creation_time": "2006-06-21T22:10:43Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 39853, "attachment_id": 18521, "id": 90546, "time": "2006-06-23T15:48:15Z", "creator": "carnold@apache.org", "creation_time": "2006-06-23T15:48:15Z", "is_private": false, "text": "Created attachment 18521\nBetter fix defining ERANGE and EINVAL in apr_private.h"}, {"count": 3, "tags": [], "bug_id": 39853, "text": "Created attachment 18530\nCorresponding patch for unit test in test/teststr.c", "id": 90572, "time": "2006-06-24T00:14:48Z", "creator": "carnold@apache.org", "creation_time": "2006-06-24T00:14:48Z", "is_private": false, "attachment_id": 18530}, {"count": 4, "tags": [], "creator": "jorton@redhat.com", "attachment_id": null, "text": "If WinCE does not have an errno definition then apr_strtoi64() should not be\nimplemented at all because the API guarantee cannot be met.\n\nThe function declaration should be surrounded with #if <FOO> for some macro\nwhich is only defined on non-WinCE.", "id": 90607, "time": "2006-06-26T12:31:03Z", "bug_id": 39853, "creation_time": "2006-06-26T12:31:03Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 39853, "text": "Mass reassign the 44 open apr-bugs to apr bug list", "id": 93852, "time": "2006-09-19T19:54:42Z", "creator": "wrowe@apache.org", "creation_time": "2006-09-19T19:54:42Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 39853, "text": "Created attachment 20110\nCombines two earlier patches plus now fails test if errno not available\n\nJoe's comment would also apply to apr_inet_top which appears to be the\nmotivation of the fake \"errno\" declared in include/arch/win32/apr_private.h. \nMy fix for apr_strtoi64 just continued in that path.\n\nI've combined the previous two patches into a combined patch and now explicit\nfail the unit test at completion if APR_HAVE_ERRNO_H is not true.  I do not\nthink suppressing the method when errno is not available is required. \napr_strtoi64 may not be fulfulling its contract, but since the caller is also\nconstrained by the lack of errno on the platform, it can't depend on that part\nof the contract.", "id": 102775, "time": "2007-05-02T11:28:22Z", "creator": "carnold@apache.org", "creation_time": "2007-05-02T11:28:22Z", "is_private": false, "attachment_id": 20110}, {"count": 7, "tags": [], "creator": "wrowe@apache.org", "attachment_id": null, "text": "I agree with Joe.  Flagging the test as failed is not sufficient.\n\nIt should either be ENOTIMPL or simply not be found.  If we have to write our\nown parser, then fine.  apr_strtoi64() promises to error out, and the patch\ndoesn't satisfy that promise.\n\n", "id": 103906, "time": "2007-05-31T15:23:31Z", "bug_id": 39853, "creation_time": "2007-05-31T15:23:31Z", "is_private": false}, {"count": 8, "tags": [], "creator": "wrowe@apache.org", "attachment_id": null, "text": "Striking patchavail - flagging needinfo", "id": 103922, "time": "2007-05-31T16:48:31Z", "bug_id": 39853, "creation_time": "2007-05-31T16:48:31Z", "is_private": false}]