[{"count": 0, "tags": [], "bug_id": 60629, "attachment_id": null, "text": "I believe that this log message is incorrect. In debug mode I get the following output (trimmed for brevity):\n\n> 23-Jan-2017 15:18:34.368 INFORMATION [localhost-startStop-1] o.a.catalina.startup.HostConfig.deployWAR Deploying web application archive /var/opt/tomcat-8.5/webapps/smartld.war\n> 23-Jan-2017 15:18:44.315 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner.scanResourcePaths No TLD files were found in resource path [/WEB-INF/jsp/control/recordUpdate/].\n> 23-Jan-2017 15:18:44.315 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner.scanResourcePaths No TLD files were found in resource path [/WEB-INF/jsp/control/].\n> 23-Jan-2017 15:18:44.316 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner.scanResourcePaths No TLD files were found in resource path [/WEB-INF/jsp/admin/].\n> 23-Jan-2017 15:18:44.317 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner.scanResourcePaths No TLD files were found in resource path [/WEB-INF/jsp/].\n> 23-Jan-2017 15:18:44.349 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner.scanResourcePaths No TLD files were found in resource path [/WEB-INF/vm/].\n> 23-Jan-2017 15:18:44.349 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner.scanResourcePaths TLD files were found in resource path [/WEB-INF/].\n> 23-Jan-2017 15:18:44.360 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/jericho-html-2.4.jar]. Consider ...\n> 23-Jan-2017 15:18:44.371 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/logback-core-1.1.8.jar]. Consider ...\n> 23-Jan-2017 15:18:44.375 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/json-lib-2.4-jdk15.jar]. Consider ...\n> 23-Jan-2017 15:18:44.377 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/tedab-services-search-syntax-converter-1.5.jar]. Consider ...\n> 23-Jan-2017 15:18:44.421 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan TLD files were found in JAR [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/smartld-widget-taglib-3.0-SNAPSHOT.jar].\n> 23-Jan-2017 15:18:44.424 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/yui2-assets-2.9.0-dynamowerk-10.jar]. Consider ...\n> 23-Jan-2017 15:18:44.425 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/commons-dbutils-1.6.jar]. Consider ...\n> 23-Jan-2017 15:18:44.426 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/xmlpull-1.1.3.1.jar]. Consider ...\n> 23-Jan-2017 15:18:44.562 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan TLD files were found in JAR [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/displaytag-1.2-dynamowerk-4.jar].\n> 23-Jan-2017 15:18:44.564 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/urlrewritefilter-4.0.4.jar]. Consider ...\n> 23-Jan-2017 15:18:44.565 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/ezmorph-1.0.6.jar]. Consider ...\n> 23-Jan-2017 15:18:44.566 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/dynamowerk-js-0.4.1.jar]. Consider ...\n> 23-Jan-2017 15:18:44.568 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/logback-classic-1.1.8.jar]. Consider ...\n> 23-Jan-2017 15:18:44.569 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/jcl-over-slf4j-1.7.22.jar]. Consider ...\n> 23-Jan-2017 15:18:44.572 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/lucene-queryparser-3.6.2.jar]. Consider ...\n> 23-Jan-2017 15:18:44.885 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan TLD files were found in JAR [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/javax.servlet.jsp.jstl-1.2.4.jar].\n> 23-Jan-2017 15:18:44.887 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/commons-csv-1.4.jar]. Consider ...\n> 23-Jan-2017 15:18:44.888 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/prototype-js-1.7.1-dynamowerk-2.jar]. Consider ...\n> 23-Jan-2017 15:18:44.891 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/itext-2.0.8.jar]. Consider ...\n> 23-Jan-2017 15:18:44.892 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/cal10n-api-0.7.7.jar]. Consider ...\n> 23-Jan-2017 15:18:44.893 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/smartld-js-libs-2.7.jar]. Consider ...\n> 23-Jan-2017 15:18:44.895 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/jstl-api-1.2.jar]. Consider ...\n> 23-Jan-2017 15:18:44.898 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/xstream-1.4.9.jar]. Consider ...\n> 23-Jan-2017 15:18:44.899 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/resources-dependency-filter-0.8.2.jar]. Consider ...\n> 23-Jan-2017 15:18:44.999 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan TLD files were found in JAR [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/input-taglib-0.2.1-dynamowerk-2.jar].\n> 23-Jan-2017 15:18:45.006 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/lucene-core-3.6.2.jar]. Consider ...\n> 23-Jan-2017 15:18:45.007 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/xpp3_min-1.1.4c.jar]. Consider ...\n> 23-Jan-2017 15:18:45.008 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/velocity-slf4j-0.3.jar]. Consider ...\n> 23-Jan-2017 15:18:45.009 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/yui2-js-2.9.0-dynamowerk-10.jar]. Consider ...\n> 23-Jan-2017 15:18:45.020 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan TLD files were found in JAR [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/velocity-tools-2.0-dynamowerk-1.jar].\n> 23-Jan-2017 15:18:45.093 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan TLD files were found in JAR [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/ajaxtags-1.3-dynamowerk-2.jar].\n> 23-Jan-2017 15:18:45.095 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/dieditor-model-0.2.jar]. Consider ...\n> 23-Jan-2017 15:18:45.097 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/smartld-help-2.6.jar]. Consider ...\n> 23-Jan-2017 15:18:45.099 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/var/opt/tomcat-8.5/webapps/smartld/WEB-INF/lib/velocity-1.7.jar]. Consider ...\n> 23-Jan-2017 15:18:45.103 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/opt/apache-tomcat-8.5.11/lib/michael-o-tomcat-extras-2.0-SNAPSHOT.jar]. Consider ...\n> 23-Jan-2017 15:18:45.104 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/opt/apache-tomcat-8.5.11/lib/dircontextsource-2.0-SNAPSHOT.jar]. Consider ...\n> 23-Jan-2017 15:18:45.105 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/opt/apache-tomcat-8.5.11/lib/tomcat-authnz-spnego-ad-3.0-SNAPSHOT.jar]. Consider ...\n> 23-Jan-2017 15:18:45.106 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/opt/apache-tomcat-8.5.11/lib/smtp-1.5.5.jar]. Consider ...\n> 23-Jan-2017 15:18:45.107 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/opt/apache-tomcat-8.5.11/lib/jaxb/txw2-2.2.11.jar]. Consider ...\n> 23-Jan-2017 15:18:45.108 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/opt/apache-tomcat-8.5.11/lib/jaxb/istack-commons-runtime-2.21.jar]. Consider ...\n> 23-Jan-2017 15:18:45.109 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/opt/apache-tomcat-8.5.11/lib/jaxb/stax-ex-1.7.7.jar]. Consider ...\n> 23-Jan-2017 15:18:45.111 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/opt/apache-tomcat-8.5.11/lib/jaxb/FastInfoset-1.2.13.jar]. Consider ...\n> 23-Jan-2017 15:18:45.117 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/opt/oracle/product/11.2.0/client_1/jdbc/lib/ojdbc6.jar]. Consider ...\n> 23-Jan-2017 15:18:45.118 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/opt/oracle/product/11.2.0/client_1/jlib/osdt_cert.jar]. Consider ...\n> 23-Jan-2017 15:18:45.120 FEIN [localhost-startStop-1] o.a.jasper.servlet.TldScanner$TldScannerCallback.scan No TLD files were found in [file:/opt/oracle/product/11.2.0/client_1/jlib/osdt_core.jar]. Consider ...\n> 23-Jan-2017 15:18:45.120 INFORMATION [localhost-startStop-1] o.a.jasper.servlet.TldScanner.scanJars At least one JAR was scanned for TLDs yet contained no TLDs. Enable debug logging for this logger for a complete list of JARs that were scanned but no TLDs were found in them. Skipping unneeded JARs during scanning can improve startup time and JSP compilation time.\n> 23-Jan-2017 15:18:47.781 INFORMATION [localhost-startStop-1] o.a.catalina.startup.HostConfig.deployWAR Deployment of web application archive /var/opt/tomcat-8.5/webapps/smartld.war has finished in 13,411 ms\n\nAs you can see, several JARs do contain a TLD file, #scan() says: \"At least one JAR was scanned for TLDs yet contained no TLDs.\" This is simply not true.\n\nThe issue is rooted in TldScanner#scanJars(). It creates *one* TldScannerCallback (collector) and asks for callback.scanFoundNoTLDs(). The callback is passed to #scan(JarScanType...) where an iterator over WEB-INF/lib is created and processed with #process(). Ultimately, TldScannerCallback#scan() decides for this JAR that it does not contain a TLD and writes to foundJarWithoutTld. If the last scanned JAR does not contain a TLD, this value is set to false, even if one JAR with a TLD exists on the chain.\n\nThe state is not maintained. I would expect to collect this information on a per-JAR basis in the collector and perform an any() mapping on the boolean array. This would also allow to say that \"n JARs\" where scanned and not just \"at least one JAR\". Alternatively, invert the logic foundJarWithoutTld => foundJarWithTld, init with false and set to true in the if(found) clause, so a negative match would not kill a previously found positive match.", "id": 196327, "time": "2017-01-23T15:10:34Z", "creator": "1983-01-06@gmx.net", "creation_time": "2017-01-23T15:10:34Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 60629, "attachment_id": null, "is_private": false, "id": 196330, "time": "2017-01-23T15:19:04Z", "creator": "markt@apache.org", "creation_time": "2017-01-23T15:19:04Z", "text": "The message is correct.\n\nOf the JARs scanned, at least one JAR was scanned for TLDs without any TLDs being found in that JAR.\n\nConfiguring the JAR scanner to skip the TLD scan for those JARs that do not contain TLDs should improve the web application start time."}, {"count": 2, "tags": [], "bug_id": 60629, "attachment_id": null, "is_private": false, "id": 196332, "time": "2017-01-23T15:27:32Z", "creator": "1983-01-06@gmx.net", "creation_time": "2017-01-23T15:27:32Z", "text": "(In reply to Mark Thomas from comment #1)\n> The message is correct.\n> \n> Of the JARs scanned, at least one JAR was scanned for TLDs without any TLDs\n> being found in that JAR.\n> \n> Configuring the JAR scanner to skip the TLD scan for those JARs that do not\n> contain TLDs should improve the web application start time.\n\nThanks, this might be a wording issue of the message. It implied erratic behavior to me. Maybe a rewording will help to avoid future misunderstanding from non-English natives."}, {"count": 3, "tags": [], "bug_id": 60629, "attachment_id": null, "text": "Maybe instead of\n\n\"At least one JAR was scanned for TLDs yet contained no TLDs.\"\n\nuse\n\n\"At least one JAR was scanned for TLDs which contained no TLDs.\"\n\nWould that make it easier to understand?", "id": 196334, "time": "2017-01-23T15:39:27Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2017-01-23T15:39:27Z", "is_private": false}, {"count": 4, "attachment_id": null, "creator": "1983-01-06@gmx.net", "text": "(In reply to Rainer Jung from comment #3)\n> Maybe instead of\n> \n> \"At least one JAR was scanned for TLDs yet contained no TLDs.\"\n> \n> use\n> \n> \"At least one JAR was scanned for TLDs which contained no TLDs.\"\n> \n> Would that make it easier to understand?\n\nIf I (user) wouldn't read the source code nor enabled debug, the message implies that: \"Hey, I have scanned one JAR, found no TLD and gave up.\" The problem is the \"At least one JAR\", it sounds like fail-fast and not fail-last.\n\nI would rather expect: \"n JARs were scanned, but some did not contain any TLDs. Enable ...\" or \"Some scanned JARs did not contain any TLDs. Enable ...\"", "id": 196335, "time": "2017-01-23T15:55:55Z", "bug_id": 60629, "creation_time": "2017-01-23T15:55:55Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "text": "The point was to say that some JARs were needlessly scanned, and they could be filtered out. People go on to complain sometimes that they have 1000s of JARs in their webapp and it takes too long to start.\n\nThe INFO log explains the JAR filtering part correctly, but the first part is too convoluted, and the \"yet\" -> \"which\" is marginally better, but not *so* much. I'm not sure who wrote that originally, maybe me who knows.\n\n-> \"JAR scanner did not find TLDs in some JARs. Enable debug logging for this logger for a complete list of JARs. Skipping unneeded JARs during scanning can improve startup time and JSP compilation time.\".\n\nThat's shorter, is it better ?", "is_private": false, "bug_id": 60629, "id": 196337, "time": "2017-01-23T16:18:49Z", "creator": "remm@apache.org", "creation_time": "2017-01-23T16:18:49Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 60629, "attachment_id": null, "id": 196338, "time": "2017-01-23T16:34:10Z", "creator": "1983-01-06@gmx.net", "creation_time": "2017-01-23T16:34:10Z", "is_private": false, "text": "(In reply to Remy Maucherat from comment #5)\n> The point was to say that some JARs were needlessly scanned, and they could\n> be filtered out. People go on to complain sometimes that they have 1000s of\n> JARs in their webapp and it takes too long to start.\n> \n> The INFO log explains the JAR filtering part correctly, but the first part\n> is too convoluted, and the \"yet\" -> \"which\" is marginally better, but not\n> *so* much. I'm not sure who wrote that originally, maybe me who knows.\n> \n> -> \"JAR scanner did not find TLDs in some JARs. Enable debug logging for\n> this logger for a complete list of JARs. Skipping unneeded JARs during\n> scanning can improve startup time and JSP compilation time.\".\n> \n> That's shorter, is it better ?\n\nYes, it is: \"JAR scanner did not find any TLDs in some JARs. ...\"\n\nIt removes the fail-fast implication for me."}]