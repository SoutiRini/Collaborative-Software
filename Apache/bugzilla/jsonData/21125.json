[{"attachment_id": null, "tags": [], "bug_id": 21125, "is_private": false, "count": 0, "id": 39518, "time": "2003-06-26T19:18:09Z", "creator": "lpingto@novarra.com", "creation_time": "2003-06-26T19:18:09Z", "text": "I encountered an CSS parsing issue and here is the test case and some \nsuggestion to fix it.\n\nThe following is a test CSS page\n\n<!-- Test -->\n.green { COLOR: green }\n/*end of css */\n\nWhen CSS parser parse the <!-- comment line,\nan exception of MissingResourceException is thrown which causes\nparser to abort reading the rest of the css file.\n\nHere is a workaround for the fix. Probably there may be other better way.\nI'm enclosing this for your reference.\n/********** Change **********************/\nFunction parseStyleSheet(InputSource source)\n\n*** change \ndefault:\n    parseRuleSet();\n\n---> to \ndefault:\n    try{\n          parseRuleSet();\n    } catch (Exception e) {               \t\n          this.seekNextCDC();\n    }\nwhere seekNextCDC() is a new function to skip to the next \"-->\" closing comment.\n\n    protected int seekNextCDC(){\n    \tloop: for (;;) {\n    \t\tswitch (current) {\n    \t\tcase LexicalUnits.CDC:\n\t\t\tcase LexicalUnits.EOF:\n    \t\t\treturn current;\n    \t\t}\n    \t\tscanner.clearBuffer();\n    \t\tnext();\n    \t}\n    }\n\nThis will allow parser to search for the \"-->\" closing comment and continue to\nparse the rest of the style sheet."}, {"count": 1, "tags": [], "creator": "deweese@apache.org", "text": "Your example may or may not be correct.\n\nReading CSS 2, SGML open and close comments do not\nstart and close CSS comments they are generally treated\nas whitespace (they are also allowed in a few specific places).\n\nHowever if your example was in a simple 'style' element\nwithout a CData Block around it the XML parser should \nremove the comment (and in Batik this was not happening,\nI am reviewing a fix for this with another committer).\n\nExamples:\n\n<!-- The '.blue' will be applied as the comment characters will be ignored.\n     the '.green' rule will not be as the parser will abort on the invalid\n     'TEST' content because the CDATA block hides the XML comments from\n     the XML parser. --> \n\n  <style type=\"text/css\"><![CDATA[\n    <!-- .blue { fill: blue } -->\n    <!-- TEST -->\n    .green { fill: green }\n    /*end of css */\n  ]]></style>\n\n<!-- Only .yellow will be applied .purple will be stripped by the\n     XML parser (Note no CDATA block). --> \n\n  <style type=\"text/css\">\n    <!-- .purple { fill: purple } -->\n    <!-- TEST -->\n    .yellow { fill: yellow }\n    /* end of css */\n  </style>", "id": 40057, "time": "2003-07-07T10:56:06Z", "bug_id": 21125, "creation_time": "2003-07-07T10:56:06Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "deweese@apache.org", "is_private": false, "id": 40129, "attachment_id": null, "bug_id": 21125, "creation_time": "2003-07-08T00:21:50Z", "time": "2003-07-08T00:21:50Z", "text": "Fixed in CVS 7/11/03"}, {"attachment_id": null, "tags": [], "bug_id": 21125, "text": "I just tried with the latest build 1.5 and still see the same problem.\n\nTest page as provided:\n  <style type=\"text/css\">\n    <!-- .purple { fill: purple } -->\n    <!-- TEST -->\n    .yellow { fill: yellow }\n    /* end of css */\n  </style>\n\nyellow was not applied.\n\n", "count": 3, "id": 40661, "time": "2003-07-14T18:16:15Z", "creator": "lpingto@novarra.com", "creation_time": "2003-07-14T18:16:15Z", "is_private": false}, {"count": 4, "text": "I just tested and element's with class=\"yellow\" do end up yellow for\nme.  I will shortly deliver a new test\n(xml-batik/samples/tests/spec/styling/styleElement.svg) \ncase that shows this working properly.  If you can attach\na complete example that shows the problem please reopen again.\n", "bug_id": 21125, "is_private": false, "id": 41023, "time": "2003-07-20T20:41:34Z", "creator": "deweese@apache.org", "creation_time": "2003-07-20T20:41:34Z", "tags": [], "attachment_id": null}]