[{"attachment_id": null, "tags": [], "creator": "frank.kline@gmail.com", "text": "The CorsFilter provided with Tomcat 7 should support the PATCH method.", "count": 0, "id": 178929, "time": "2014-11-03T22:53:58Z", "bug_id": 57180, "creation_time": "2014-11-03T22:53:58Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 57180, "attachment_id": null, "id": 178930, "time": "2014-11-03T23:13:19Z", "creator": "chris@christopherschultz.net", "creation_time": "2014-11-03T23:13:19Z", "is_private": false, "text": "Bugzilla is not a support forum. If you need help, please post to the user's mailing list.\n\nHint: you can set the \"cors.allowed.methods\" init-param for the CorsFilter and allow whatever HTTP methods you want. By default, the filter supports GET,POST,HEAD,OPTIONS but you can add whatever you want to that list.\n\nhttp://tomcat.apache.org/tomcat-7.0-doc/config/filter.html#CORS_Filter"}, {"count": 2, "tags": [], "bug_id": 57180, "text": "This isn't a help request; it's a bug report.\n\nIrrespective of allowed methods, the preflight filter evaluates the following:\n\"if (method != null && HTTP_METHODS.contains(method)) {\" as well as \"else if (COMPLEX_HTTP_METHODS.contains(method)) {\"\n\nNeither HTTP_METHODS nor COMPLEX_HTTP_METHODS contain \"PATCH\" hence, the original definition of \"CORSRequestType requestType = CORSRequestType.INVALID_CORS;\" is used.\n\nAdding \"PATCH\" to both HTTP_METHODS and COMPLEX_HTTP_METHODS just purely enables the use of the allowed methods filter param.", "id": 178931, "time": "2014-11-03T23:20:59Z", "creator": "frank.kline@gmail.com", "creation_time": "2014-11-03T23:20:59Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "text": "I have removed the check against complex methods.\n\nThis has been fixed in trunk 8.0.x (for 8.0.16 onwards) and 7.0.x (for 7.0.58 onwards).", "id": 179402, "time": "2014-12-01T11:57:27Z", "bug_id": 57180, "creation_time": "2014-12-01T11:57:27Z", "is_private": false}, {"count": 4, "tags": [], "creator": "frank.kline@gmail.com", "attachment_id": null, "is_private": false, "id": 179405, "time": "2014-12-01T14:45:39Z", "bug_id": 57180, "creation_time": "2014-12-01T14:45:39Z", "text": "Fantastic! Thanks, Mark."}, {"count": 5, "tags": [], "bug_id": 57180, "text": "Seems like this is still broken in 8.0.18. The check for a valid cors method is gated by a check against HTTP_METHODS, which doesn't include PATCH. \n\nNote there is an additional spec for the addition of PATCH:\nhttp://tools.ietf.org/html/rfc5789\n\n/**\n     * {@link Collection} of HTTP methods. Case sensitive.\n     *\n     * @see  <a href=\"http://tools.ietf.org/html/rfc2616#section-5.1.1\"\n     *       >http://tools.ietf.org/html/rfc2616#section-5.1.1</a>\n     *\n     */\n    public static final Collection<String> HTTP_METHODS =\n            new HashSet<>(Arrays.asList(\"OPTIONS\", \"GET\", \"HEAD\", \"POST\", \"PUT\",\n                    \"DELETE\", \"TRACE\", \"CONNECT\"));", "id": 180746, "time": "2015-02-04T05:55:00Z", "creator": "frank.kline@gmail.com", "creation_time": "2015-02-04T05:55:00Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 57180, "is_private": false, "text": "Additional fix applied to trunk, 8.0.x (for 8.0.19 onwards) and 7.0.x (for 7.0.60 onwards).", "id": 180749, "time": "2015-02-04T09:41:12Z", "creator": "markt@apache.org", "creation_time": "2015-02-04T09:41:12Z", "attachment_id": null}]