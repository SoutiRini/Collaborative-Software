[{"count": 0, "tags": [], "creator": "rainer.jung@kippdata.de", "text": "Currently RandomVariableConfig checks for maximum > minimum and complains otherwise. I have a situation where I create random values using RandomVariableConfig in some given range and sometimes I need that range to be exactly one number.\n\nE.g. the random value could be the number of products you want to buy but for a simple base test you always want only one product. I retrieve minimum and maximum from JMeter variables and it would be trivial to set both to \"1\" to get that behavior.\n\nUnfortunately RandomVariableConfig only accepts minimum < maximum, not minimum == maximum. Note that the Random math still works for minimum == maximum, because range = maximum - minimum + 1 would be 1 and we would generate minimum + randGen.nextInt(range) = minimum + randGen.nextInt(1) = minimum + 0 = minimum (== maximum), which would be the expected result.\n\nThe docs do not mention the condition on minimum and maximum, so there's no docs change involved.\n\nI'm going to apply the following (trivial) patch unless someone opposes:\n\nIndex: components/org/apache/jmeter/config/RandomVariableConfig.java\n===================================================================\n--- components/org/apache/jmeter/config/RandomVariableConfig.java       (revision 1782826)\n+++ components/org/apache/jmeter/config/RandomVariableConfig.java       (working copy)\n@@ -91,8 +91,8 @@\n         final String maxAsString = getMaximumValue();\n         long maximum = NumberUtils.toLong(maxAsString);\n         long rangeL=maximum-minimum+1; // This can overflow\n-        if (minimum >= maximum){\n-            log.error(\"maximum({}) must be > minimum({})\", maxAsString, minAsString);\n+        if (minimum > maximum){\n+            log.error(\"maximum({}) must be >= minimum({})\", maxAsString, minAsString);\n             range=0;// This is used as an error indicator\n             return;\n         }\n\nRegards,\n\nRainer", "id": 196967, "time": "2017-02-13T18:45:58Z", "bug_id": 60729, "creation_time": "2017-02-13T18:45:58Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "sitnikov.vladimir@gmail.com", "text": "Have you tried that patch?\n\nIt looks other uses of range should be corrected as well: https://github.com/vlsi/jmeter/blob/7ebfa083afd0b4e2be069b2a8a654bc33fe761cf/src/components/org/apache/jmeter/config/RandomVariableConfig.java#L99-L99 and https://github.com/vlsi/jmeter/blob/7ebfa083afd0b4e2be069b2a8a654bc33fe761cf/src/components/org/apache/jmeter/config/RandomVariableConfig.java#L121.", "id": 196968, "time": "2017-02-13T19:13:14Z", "bug_id": 60729, "creation_time": "2017-02-13T19:13:14Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 60729, "attachment_id": null, "id": 196969, "time": "2017-02-13T19:34:35Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2017-02-13T19:34:35Z", "is_private": false, "text": "Thanks. I'm in the middle of preparing tests. I'll include the fixes fpor the other two comparisons."}, {"count": 3, "tags": [], "bug_id": 60729, "attachment_id": null, "text": "Actzually these do not need changing. range comes from rangeL which was set to rangeL=maximum-minimum+1, so for minimum==maximum range is and should be 1. So comparing against 0 (which is used as a special marker value) is fine.", "id": 196970, "time": "2017-02-13T19:37:26Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2017-02-13T19:37:26Z", "is_private": false}, {"count": 4, "tags": [], "creator": "rainer.jung@kippdata.de", "text": "Will be part of version 3.2:\n\nAuthor: rjung\nDate: Mon Feb 13 20:07:52 2017\nNew Revision: 1782848\n\nURL: http://svn.apache.org/viewvc?rev=1782848&view=rev\nLog:\nAllow minimum == maximum in Random Variable Config Element.\n\nBugzilla Id: 60729\n\nModified:\n    jmeter/trunk/src/components/org/apache/jmeter/config/RandomVariableConfig.java", "id": 196972, "time": "2017-02-13T20:10:36Z", "bug_id": 60729, "creation_time": "2017-02-13T20:10:36Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "support@ubikloadpack.com", "attachment_id": null, "id": 196973, "time": "2017-02-13T20:27:27Z", "bug_id": 60729, "creation_time": "2017-02-13T20:27:27Z", "is_private": false, "text": "(In reply to Rainer Jung from comment #4)\n> Will be part of version 3.2:\n> \n> Author: rjung\n> Date: Mon Feb 13 20:07:52 2017\n> New Revision: 1782848\n> \n> URL: http://svn.apache.org/viewvc?rev=1782848&view=rev\n> Log:\n> Allow minimum == maximum in Random Variable Config Element.\n> \n> Bugzilla Id: 60729\n> \n> Modified:\n>    \n> jmeter/trunk/src/components/org/apache/jmeter/config/RandomVariableConfig.\n> java\n\nHi Rainer, \nCan't this fix break existing test plans ? I don't think so but you've investigated it more than me.\nMaybe a note in incompatible changes would be useful in this case.\nThanks for patch and fix."}, {"text": "> Hi Rainer, \n> Can't this fix break existing test plans ? I don't think so but you've\n> investigated it more than me.\n> Maybe a note in incompatible changes would be useful in this case.\n> Thanks for patch and fix.\n\nBehavior before that change: when minimum==maximum you got an error in the log, but the test plan proceeded without the defined variable being set to any value.\n\nSo yes, it can break plans and I will add a note, but I think just not setting the variable when minimum==maximum is wrong. Thus the fix.", "tags": [], "bug_id": 60729, "attachment_id": null, "count": 6, "id": 196976, "time": "2017-02-13T20:58:54Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2017-02-13T20:58:54Z", "is_private": false}, {"count": 7, "tags": [], "creator": "rainer.jung@kippdata.de", "text": "Author: rjung\nDate: Mon Feb 13 21:23:23 2017\nNew Revision: 1782880\n\nURL: http://svn.apache.org/viewvc?rev=1782880&view=rev\nLog:\nAdd info about BZ 60729 (the Random Variable\nConfig Element should allow minimum==maximum)\nto changes.\n\nModified:\n    jmeter/trunk/xdocs/changes.xml", "id": 196981, "time": "2017-02-13T21:24:42Z", "bug_id": 60729, "creation_time": "2017-02-13T21:24:42Z", "is_private": false, "attachment_id": null}]