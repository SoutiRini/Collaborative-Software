[{"count": 0, "tags": [], "creator": "toni.helenius@syncrontech.com", "text": "org.apache.poi.ss.usermodel.DataFormatter forces a comma as a grouping separator. This used to work with POI 3.13-final. I'm using Finnish locale. And we have a space (\" \") character as a grouping separator. I debugged this and it indeed goes to POI correctly, the grouping separator.\n\nThe code:\nDataFormatter formatter = new DataFormatter();\nformatter.formatCellValue(cell);\n\nI'm not sure but is it this commit that caused it:\nhttps://svn.apache.org/viewvc/poi/trunk/src/java/org/apache/poi/ss/usermodel/DataFormatter.java?r1=1712605&r2=1712604&pathrev=1712605\n\nI can see a comma added there. I didn't really debug that far. Just a stab in the dark.", "id": 191283, "time": "2016-05-27T07:13:13Z", "bug_id": 59638, "creation_time": "2016-05-27T07:13:13Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 59638, "is_private": false, "text": "On the whole, Apache POI only works with the formats defined in Excel, which are hard coded to US-English ones. We don't currently have any support for performing the localisation that Excel does on many formats when opened in other locales\n\nRight now, if we render to a string the same way that US-English Excel does, we consider it \"working\"\n\nWe would like to get the list of \"localised\" format strings, for those formats which support it (some formats are hard-coded as US-English, but many do change). Were that done, we'd then be able to properly support localising formats for those who wanted it. DateFormatConverter has a little bit of that, but needs generalising for all format types\n\nVolunteer needed!", "id": 191288, "time": "2016-05-27T10:47:57Z", "creator": "apache@gagravarr.org", "creation_time": "2016-05-27T10:47:57Z", "attachment_id": null}, {"count": 2, "tags": [], "text": "Created attachment 33899\nCell format in Excel\n\nThe decimal separator comes out as Finnish. It is also comma. US-English would have a period, right?\n\nAttachment show how the cell shows up in Excel.", "attachment_id": 33899, "bug_id": 59638, "id": 191289, "time": "2016-05-27T10:57:34Z", "creator": "toni.helenius@syncrontech.com", "creation_time": "2016-05-27T10:57:34Z", "is_private": false}, {"count": 3, "tags": [], "creator": "axel@dua3.com", "text": "Created attachment 33921\nproposed fix and test cases (patch)", "id": 191438, "time": "2016-06-06T21:22:50Z", "bug_id": 59638, "creation_time": "2016-06-06T21:22:50Z", "is_private": false, "attachment_id": 33921}, {"count": 4, "tags": [], "text": "Thanks for the patch, Axel! Applied in r1747139.\nUpdated changelog in r1747144.\n\nPlease reopen if anything else is needed.", "attachment_id": null, "id": 191439, "creator": "onealj@apache.org", "time": "2016-06-07T06:26:06Z", "bug_id": 59638, "creation_time": "2016-06-07T06:26:06Z", "is_private": false}, {"count": 5, "tags": [], "creator": "onealj@apache.org", "attachment_id": null, "id": 191440, "time": "2016-06-07T07:55:15Z", "bug_id": 59638, "creation_time": "2016-06-07T07:55:15Z", "is_private": false, "text": "(In reply to Nick Burch from comment #1)\n> We would like to get the list of \"localised\" format strings\n\nJava's understanding of localized number formatting: http://docs.oracle.com/cd/E19455-01/806-0169/overview-9/index.html\nThis may differ from Excel. \nhttps://support.office.com/en-us/article/Change-the-character-used-to-separate-thousands-or-decimals-c093b545-71cb-4903-b205-aebb9837bd1e\nWe should improve the comments in DataFormatter to make a distinction between thousands separator and decimal separator.\n\nhttps://support.office.com/en-us/article/show-or-hide-the-thousands-separator-b9f8aee0-ef50-42e5-8fd7-6e3ab1493876\n\"NOTE: By default, Microsoft Office Excel displays the system separator for thousands. You can specify a different system separator by changing the regional settings in Control Panel.\"\nCan someone compile a list of thousands and decimal separators for each region with Excel 2007+?"}]