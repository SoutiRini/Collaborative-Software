[{"count": 0, "tags": [], "bug_id": 60625, "attachment_id": 34662, "is_private": false, "id": 196305, "time": "2017-01-23T00:20:55Z", "creator": "otnateos@gmail.com", "creation_time": "2017-01-23T00:20:55Z", "text": "Created attachment 34662\nsample of result from slide 2 and 16 that have issue\n\nHi,\n\nWe are having problem to use POX XSLF with rendering background colour and rendering shape that overlayed by transparent image?\n\nWe test our code to render http://www.slideshare.net/sdeeg/spring-boot into image/svg but \n- the background is rendered as grey instead of white. \n- a rectangular shape that placed behind a PNG image is rendered. In this case can be argued that part of shape is behind the PNG image but some of them only behind transparent section of the image, but Powerpoint and Keynote application do not render them\n\nUsing:\n------\nPOI 3.16-beta1\nBatik 1.7\n\nCode to test:\n-------------\nString presentation = // your downloaded presentation file\nString dir = \"/tmp/\" + UUID.randomUUID().toString();\nFiles.createDirectory(Paths.get(dir));\nXMLSlideShow ppt = new XMLSlideShow(new FileInputStream(presentation));\nint i = 1;\nfor (XSLFSlide slide : ppt.getSlides())\n{\n    String filename = dir + \"/slide-\" + i + \".svg\";\n    org.w3c.dom.Document doc = org.apache.batik.dom.svg.SVGDOMImplementation.getDOMImplementation()\n            .createDocument(\"http://www.w3.org/2000/svg\", \"svg\", null);\n    //Use Batik SVG Graphics2D driver\n    SVGGeneratorContext svgContext = SVGGeneratorContext.createDefault(doc);\n    SVGGraphics2D graphics = new SVGGraphics2D(svgContext, false);\n    graphics.setBackground(Color.WHITE);\n    graphics.setSVGCanvasSize(ppt.getPageSize());\n    // draw stuff. All the heavy-lifting happens here\n    slide.draw(graphics);\n    // save the result.\n    try (final OutputStreamWriter out = new OutputStreamWriter(new FileOutputStream(filename), \"UTF-8\"))\n    {\n        graphics.stream(out, true);\n        out.flush();\n    }\n    i++;\n}\n\nI have tried to fix the background image but seems like setting up the fill colour is not the correct way to do. I also debug the drawing method for the layers for shape issue, i can see that the order of drawing is correct that the bottom most layer is rendered first but seems like the issue lay in the rectangular shape is rendered first without considering there is another image that have bounding rectangle on top of it (even though transparent).\n\nIf anyway can point out the correct direction to fix the issue going to be great.\n\nThanks,"}, {"text": "I don't have a LinkedIn account to download something from slideshare ... and I refuse to register! ... and I don't want to spent more than 15 minutes on how to download the original .pptx without registration ...\n\nIf it's ok copyright-wise and size-wise, please upload that slideshow to bugzilla ... or if not, send it to my apache email.\n\nAndi", "tags": [], "bug_id": 60625, "attachment_id": null, "count": 1, "id": 196306, "time": "2017-01-23T00:57:11Z", "creator": "kiwiwings@apache.org", "creation_time": "2017-01-23T00:57:11Z", "is_private": false}, {"count": 2, "tags": [], "creator": "kiwiwings@apache.org", "attachment_id": null, "is_private": false, "id": 196359, "time": "2017-01-24T07:47:03Z", "bug_id": 60625, "creation_time": "2017-01-24T07:47:03Z", "text": "The file is also available at [1] - I've seen a few rendering issues and try to cope with them (... hopefully soon ...)\nAs we've also uploaded files from tika runs, I probably will upload it also to our test corpus, \n\n\n[1] https://people.apache.org/~kiwiwings/spring-boot.pptx"}, {"count": 3, "tags": [], "creator": "kiwiwings@apache.org", "attachment_id": null, "id": 196832, "time": "2017-02-08T01:21:25Z", "bug_id": 60625, "creation_time": "2017-02-08T01:21:25Z", "is_private": false, "text": "fixed a few rendering issues with r1782096\nand tested it with batik too\nadded support for slide numbers to XSLF/HSLF\n\nyou should add the wingding.ttf to awt for correct bullet rendering - at least with png output\n\nplease give it a try"}, {"text": "Hi Andreas,\n\nI had a quick test from the nightly built yesterday and from my observation\n\nWhat works:\n- background colour issue is fixed\n- the fix for the page works on PPTx export but appear as asterisk if exported from PPT file\n\nWhat do not work:\n- rectangle border still exist (slide-16.svg)\n- (NEW) white background in the middle 1st page is not rendered (slide-1.svg) . This is quite weird issue, if I save the PPTx file into pre-2003 PPT format then the white background is rendered correctly. I also tested this one rendered correctly in 3.16-beta2 (samples in the link below)\n\n\nLinks: https://www.dropbox.com/sh/ir981cxkutmkxps/AADTcj17KwOnpm26JJBMjgj_a?dl=0", "tags": [], "bug_id": 60625, "attachment_id": null, "count": 4, "id": 196866, "time": "2017-02-08T22:51:09Z", "creator": "otnateos@gmail.com", "creation_time": "2017-02-08T22:51:09Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 60625, "attachment_id": null, "is_private": false, "id": 196950, "time": "2017-02-13T00:55:19Z", "creator": "kiwiwings@apache.org", "creation_time": "2017-02-13T00:55:19Z", "text": "I've added a few more fixes via r1782706\nand r1782712\n\nBoth XSLF (support for themes) and HSLF (support for shapes) still have quite a few problems ... I leave it up to you, to decide when to close the bug ... I probably close it before we push POI 3.16 final ..."}, {"count": 6, "tags": [], "creator": "otnateos@gmail.com", "attachment_id": null, "is_private": false, "id": 196984, "time": "2017-02-14T00:42:17Z", "bug_id": 60625, "creation_time": "2017-02-14T00:42:17Z", "text": "Thanks Andreas,\n\nSeems like your latest fixes work for the main issue that I reported for this bug"}]