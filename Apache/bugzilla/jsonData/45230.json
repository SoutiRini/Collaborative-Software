[{"count": 0, "tags": [], "text": "Created attachment 22137\nTestcase: sample application that reproduces the bug\n\nIt is possible, with BCEL, to generate invalid alignment of the 4-byte operands of the Select instructions. The problem is caused by the interaction of InstructionList.setPositions, the updatePosition methods of GOTO and JSR, and Select.updatePosition.\n\nIn particular, the updatePosition methods of GOTO and JSR will always return the difference between the wide instruction length and the normal instruction length. Since this value ends up being added into the additional_bytes variable in InstructionList.setPositions and then eventually contributes to the value passed into Select.updatePosition as the offset, its incorrect value causes the padding field to be set incorrectly.\n\nIt appears that in order to behave properly, the updatePosition method should return only the number of bytes of length that the instruction changed during this call to updatePosition.\n\nI am attaching a small example application that displays the bug.\n\nI will also be attaching a patch.", "attachment_id": 22137, "id": 117796, "creator": "talper@coverity.com", "time": "2008-06-18T15:23:31Z", "bug_id": 45230, "creation_time": "2008-06-18T15:23:31Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 45230, "attachment_id": 22138, "text": "Created attachment 22138\npatch for GOTO and JSR", "id": 117797, "time": "2008-06-18T15:25:55Z", "creator": "talper@coverity.com", "creation_time": "2008-06-18T15:25:55Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 45230, "is_private": false, "count": 2, "id": 133495, "time": "2010-01-10T13:22:30Z", "creator": "tcurdt@apache.org", "creation_time": "2010-01-10T13:22:30Z", "text": "Thx. Applied."}]