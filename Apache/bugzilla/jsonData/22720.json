[{"count": 0, "tags": [], "bug_id": 22720, "attachment_id": null, "id": 43302, "time": "2003-08-26T03:20:05Z", "creator": "huri@users.sourceforge.net", "creation_time": "2003-08-26T03:20:05Z", "is_private": false, "text": "I clone a worksheet with merged cells, and then delete the merged cells from \nthe clone:\n\nHSSFSheet sheet = workBook.cloneSheet(templateSheetIndex);\n\nfor (int i=sheet.getNumMergedRegions()-1; i>=0; i--) {\n  sheet.removeMergedRegion(i);\n}\n\nThis results in:\n\njava.lang.IndexOutOfBoundsException: Index: 157, Size: 41\n\tat java.util.ArrayList.RangeCheck(ArrayList.java:508)\n\tat java.util.ArrayList.remove(ArrayList.java:388)\n\tat org.apache.poi.hssf.model.Sheet.removeMergedRegion(Sheet.java:506)\n\tat org.apache.poi.hssf.usermodel.HSSFSheet.removeMergedRegion\n(HSSFSheet.java:564)\n\nIndex and size shown in the error message doesn't make sense because the \nsource sheet only has 4 merged cells."}, {"count": 1, "tags": [], "bug_id": 22720, "attachment_id": null, "id": 43332, "time": "2003-08-26T14:43:01Z", "creator": "dmui@apache.org", "creation_time": "2003-08-26T14:43:01Z", "is_private": false, "text": "will correct for 2.0"}, {"count": 2, "tags": [], "bug_id": 22720, "attachment_id": null, "id": 46384, "time": "2003-10-28T18:24:58Z", "creator": "avik@apache.org", "creation_time": "2003-10-28T18:24:58Z", "is_private": false, "text": "Danny, is this still valid? "}, {"count": 3, "tags": [], "creator": "huri@users.sourceforge.net", "attachment_id": null, "text": "Tested the problem scenario with RC1, it's better than before, but now there's \na different bug:\n\nHSSFSheet template = workBook.getSheetAt(templateSheetIndex);\nHSSFSheet clone = workBook.cloneSheet(templateSheetIndex);\n\n// remove merged regions from clone\nfor (int i=sheet.getNumMergedRegions()-1; i>=0; i--) {\n  clone.removeMergedRegion(i);\n}\n\n// check if template's merged regions are OK\nif (template.getNumMergedRegions()>0) {\n   // fetch the first merged region...EXCEPTION OCCURS HERE\n   template.getMergedRegionAt(0);\n}\n\nThis results in:\n\njava.lang.IndexOutOfBoundsException: Index: 0, Size: 0\n\tat java.util.ArrayList.RangeCheck(ArrayList.java:508)\n\tat java.util.ArrayList.get(ArrayList.java:320)\n\tat org.apache.poi.hssf.record.MergeCellsRecord.getAreaAt\n(MergeCellsRecord.java:200)\n\tat org.apache.poi.hssf.model.Sheet.getMergedRegionAt(Sheet.java:543)\n\tat org.apache.poi.hssf.usermodel.HSSFSheet.getMergedRegionAt\n(HSSFSheet.java:585)\n\nFrom this test, the delete of cloned merged regions works.  However, it \nappears that the original sheet's merged regions are also deleted.  The \ntemplate.getNumMergedRegions() returns the correct value (in my test \nspreadsheet there are 4 merged regions), but throws an Exception when \ngetMergedRegionAt() is called to retrieve the regions.", "id": 47218, "time": "2003-11-11T21:06:06Z", "bug_id": 22720, "creation_time": "2003-11-11T21:06:06Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 22720, "text": "Thanks for the bug report, committed November 17.  Should be in RC2 or Release\n(minor fix).", "id": 47510, "time": "2003-11-17T21:12:02Z", "creator": "dmui@apache.org", "creation_time": "2003-11-17T21:12:02Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "text": "I'm fixing another bug to detect overlapping merged regions (not allowed by Microsoft Excel), which breaks this unit test.\n\nI'm assuming that two merged regions are overlapping is coincidental/unintentional and doesn't change the meaning of this test if the addresses are changed.\n\n//Original code[1]\ntemplate.addMergedRegion(new Region(0, (short)0, 1, (short)2));\ntemplate.addMergedRegion(new Region(1, (short)0, 2, (short)2));\n\n//Latest code\ntemplate.addMergedRegion(new CellRangeAddress(0, 1, 0, 2));\ntemplate.addMergedRegion(new CellRangeAddress(1, 2, 0, 2));\n\n[1] https://svn.apache.org/viewvc/jakarta/poi/trunk/src/testcases/org/apache/poi/hssf/usermodel/TestBugs.java?revision=353586&view=markup&pathrev=353586#l374\n[2] https://svn.apache.org/viewvc/poi/trunk/src/testcases/org/apache/poi/ss/usermodel/BaseTestBugzillaIssues.java?revision=1704124&view=markup#l140", "attachment_id": null, "id": 185409, "creator": "onealj@apache.org", "time": "2015-09-22T03:08:43Z", "bug_id": 22720, "creation_time": "2015-09-22T03:08:43Z", "is_private": false}]