[{"count": 0, "tags": [], "text": "See discussion at:\n\nhttp://marc.theaimsgroup.com/?l=ant-user&m=102813021322034&w=2\n\nMy goal:\n\nCreate a jar that may have resources from an optional \"resources\" directory.  If that \ndirectory does not exist, do nothing.\n\nOne way to approach this is to use the update=\"true\" attribute of the jar task.\n\nCurrently, the 1.5 release code believes that the jar is up to date if it has a later date than \nthe files in the resources directory, even if they are not in the jar.  This is counterintuitive \nto me.\n\nOne workaround is to touch the jar to be earlier if the files exist, but then the jar is rebuilt \nwhenever resources exist.  This is bad for build times, especially if a jar depended on by \nother steps has resources.\n\nExample using touch:\n\n  <target name=\"jar-files\" description=\"Jar files\">\n    <available file=\"${jar.resources}\" type=\"dir\" property=\"jar.resources.exists\" />\n    <jar\n      jarfile=\"${jar.dist}/${jar.baseName}.jar\"\n      compress=\"${jar.compress}\" >\n      <fileset dir=\"${compile.classes}\"/>\n    </jar>\n  </target>\n\n  <target name=\"jar-resources\" if=\"jar.resources.exists\" description=\"Add resources to \njar\">\n    <!-- icky hack, as jar only checks file timestamps in 1.5.  If they check internal \ntimestamps as 1.4 did, this can be removed. -->\n    <touch file=\"${jar.dist}/${jar.baseName}.jar\" datetime=\"01/01/2000 2:02 pm\"/>\n    <jar\n      jarfile=\"${jar.dist}/${jar.baseName}.jar\"\n      compress=\"${jar.compress}\"\n      update=\"true\">\n      <zipfileset dir=\"${jar.resources}\" />\n    </jar>\n  </target>\n\nWhat I would prefer:\n\n  <target name=\"jar-files\" description=\"Jar files\">\n    <available file=\"${jar.resources}\" type=\"dir\" property=\"jar.resources.exists\" />\n    <jar\n      jarfile=\"${jar.dist}/${jar.baseName}.jar\"\n      compress=\"${jar.compress}\" >\n      <fileset dir=\"${compile.classes}\"/>\n    </jar>\n  </target>\n\n  <target name=\"jar-resources\" if=\"jar.resources.exists\" description=\"Add resources to \njar\">\n    <jar\n      jarfile=\"${jar.dist}/${jar.baseName}.jar\"\n      compress=\"${jar.compress}\"\n      update=\"true\">\n      <zipfileset dir=\"${jar.resources}\" />\n    </jar>\n  </target>\n\nIf files in the \"resources\" directory are newer than their counterpart in the jar, or if they do \nnot exist is the jar, a rebuild should be triggered.", "attachment_id": null, "id": 21145, "creator": "scott@alodar.com", "time": "2002-08-15T23:57:36Z", "bug_id": 11756, "creation_time": "2002-08-15T23:57:36Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 11756, "text": "\n\n*** This bug has been marked as a duplicate of 10755 ***", "id": 22183, "time": "2002-09-03T16:02:16Z", "creator": "bodewig@apache.org", "creation_time": "2002-09-03T16:02:16Z", "is_private": false, "attachment_id": null}]