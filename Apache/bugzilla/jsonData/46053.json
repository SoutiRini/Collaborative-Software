[{"count": 0, "text": "The following code demonstrates the problem:\n\nHSSFWorkbook wb = new HSSFWorkbook();\nHSSFSheet sheet = wb.createSheet(\"Sheet1\");\nHSSFRow row = sheet.createRow(0);\nHSSFCell cellA1 = row.createCell(0);\nHSSFCell cellB1 = row.createCell(1);\nHSSFFormulaEvaluator fe = new HSSFFormulaEvaluator(wb);\n\ncellA1.setCellFormula(\"B1+2.2\");\ncellB1.setCellValue(1.5);\n\nfe.notifyUpdateCell(cellA1);\nfe.notifyUpdateCell(cellB1);\n\nCellValue cv;\ncv = fe.evaluate(cellA1);\nassertEquals(3.7, cv.getNumberValue(), 0.0);\n\ncellB1.setCellType(HSSFCell.CELL_TYPE_BLANK);\nfe.notifyUpdateCell(cellB1);\ncv = fe.evaluate(cellA1);\nassertEquals(2.2, cv.getNumberValue(), 0.0);\n\ncellB1.setCellValue(0.4);\nfe.notifyUpdateCell(cellB1);\ncv = fe.evaluate(cellA1);\nif (cv.getNumberValue() == 2.2) {\n\tthrow new AssertionFailedError(\"Error in evaluation dependency (cached value not reset)\");\n}\nassertEquals(2.6, cv.getNumberValue(), 0.0);", "bug_id": 46053, "attachment_id": null, "id": 121748, "time": "2008-10-21T14:15:13Z", "creator": "josh@apache.org", "creation_time": "2008-10-21T14:15:13Z", "tags": [], "is_private": false}, {"count": 1, "text": "Fixed in svn r706722", "bug_id": 46053, "attachment_id": null, "id": 121750, "time": "2008-10-21T14:29:04Z", "creator": "josh@apache.org", "creation_time": "2008-10-21T14:29:04Z", "tags": [], "is_private": false}, {"count": 2, "text": "(In reply to comment #1)\n> Fixed in svn r706722\n> \n\noops - actually it was svn r706772", "bug_id": 46053, "is_private": false, "id": 122150, "time": "2008-11-03T11:36:02Z", "creator": "josh@apache.org", "creation_time": "2008-11-03T11:36:02Z", "tags": [], "attachment_id": null}]