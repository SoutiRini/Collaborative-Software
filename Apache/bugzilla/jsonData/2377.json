[{"count": 0, "tags": [], "text": "I have written a ResourceAdapter, which uses log4j for logging (obvious).\nWhen I deploy it to WebLogic server, I get the following exception:\n\nFerretServerMCF: could not instantiate Category, java.lang.ExceptionInInitialize\nrError\njava.lang.ExceptionInInitializerError: java.lang.NullPointerException\n        at java.lang.StringBuffer.<init>(StringBuffer.java:130)\n        at java.net.URLStreamHandler.toExternalForm(URLStreamHandler.java:366)\n        at java.net.URL.toExternalForm(URL.java:754)\n        at java.net.URL.toString(URL.java:741)\n        at java.lang.String.valueOf(String.java:1947)\n        at java.lang.StringBuffer.append(StringBuffer.java:370)\n        at org.apache.log4j.Category.<clinit>(Category.java:145)\n        at java.lang.Class.forName0(Native Method)\n        at java.lang.Class.forName(Class.java:120)\n        at com.akumiitti.ferret.connector.FerretServerMCF.<init>(FerretServerMCF\n.java:27)\n        at java.lang.Class.newInstance0(Native Method)\n        at java.lang.Class.newInstance(Class.java:237)\n        at weblogic.connector.common.internal.ConnectionPool.<init>(ConnectionPo\nol.java:301)\n        at weblogic.connector.common.internal.ConnectionPoolManager.addManagedCo\nnnectionFactory(ConnectionPoolManager.java:54)\n..........................................................\n\n\nThe code in com.akumiitti.ferret.connector.FerretServerMCF.<init> does nothing \nbut \n\n    try {\n      Class.forName(\"org.apache.log4j.Category\").newInstance();\n      debug(\"FerretServerMCF: created Category\");\n    } catch (Throwable e) {\n      debug(\"FerretServerMCF: could not instantiate Category, \" + e);\n      e.printStackTrace();\n    }\n\nSo it looks like log4j IS in the classpath, but something weird occurs (I think \nit's URL.getProtocol() returns null) somewhere in the deeps of log4j code.\n\nPlease e-mail me if you need any extra information.", "is_private": false, "bug_id": 2377, "id": 3314, "time": "2001-06-28T06:02:16Z", "creator": "girenko@akumiitti.com", "creation_time": "2001-06-28T06:02:16Z", "attachment_id": null}, {"count": 1, "attachment_id": null, "creator": "girenko@akumiitti.com", "is_private": false, "id": 3334, "time": "2001-06-28T23:50:46Z", "bug_id": 2377, "creation_time": "2001-06-28T23:50:46Z", "tags": [], "text": "I've tracked the problem as much as I could. It is actually weblogic's RAR \nclassloader, which returns URL with protocol and host = null (it sets \nURLStreamHandler for URL resolution). Though it is not forbidden by \nspecification, it throws NullPointerException somewhere in URL.toExternalForm \n\nSo this is not a bug in Log4J, not a bug in weblogic, it's rather a kind of \ninconsistency in Sun's URL implementation.\n\nAnyway it renders Log4J unusable in that environment."}, {"count": 2, "tags": [], "creator": "ceki@apache.org", "attachment_id": null, "id": 3336, "creation_time": "2001-06-28T23:56:12Z", "time": "2001-06-28T23:56:12Z", "bug_id": 2377, "text": "\nAh! A pacth for this problem has been submitted by Colin Sampaleanu on the \nlog4j-dev ML. Regards, Ceki ", "is_private": false}]