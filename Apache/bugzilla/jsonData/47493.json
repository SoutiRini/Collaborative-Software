[{"count": 0, "tags": [], "bug_id": 47493, "attachment_id": null, "text": "The now deprecated method HSSFCell.setCellValue(String value)\nhas been changed to call the new method setCellValue(HSSFRichTextString value)\nwith a HSSFRichTextString Object.\n\nThe problem with that, is that a null String gets replaced with\na HSSFRichTextString Object with the value \"\" (i.e. length 0).\n\nThis broke our application, which I have fixed by calling\nsetCellValue((HSSFRichTextString)null)\n\nI believe the correct implementation of HSSFCell.setCellValue(String value) should be:\nif (value == null) {\nsetCellValue((HSSFRichTextString)null);\n} else {\nsetCellValue(new HSSFRichTextString(value));\n}\n\nThis would be much more likely to be backward compatible with existing code.\nI'm sure others will be having this problem, but have maybe not yet noticed\nthe subtle difference in their reports.\n\nBest regards,\nDaveLaw", "id": 128620, "time": "2009-07-07T19:31:31Z", "creator": "apache@apconsult.de", "creation_time": "2009-07-07T19:31:31Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 47493, "attachment_id": null, "id": 128625, "time": "2009-07-07T23:12:23Z", "creator": "yegor@dinom.ru", "creation_time": "2009-07-07T23:12:23Z", "is_private": false, "text": "Please try POI-3.5-beta7 or the latest trunk, the fix is already there:\n\n    public void setCellValue(String value) {\n        HSSFRichTextString str = value == null ? null :  new HSSFRichTextString(value);\n        setCellValue(str);\n    }\n\nYegor"}]