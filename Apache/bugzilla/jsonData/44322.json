[{"count": 0, "tags": [], "bug_id": 44322, "is_private": false, "text": "On a reverse proxy we want to force cookie domain:\n--------------------------------------------------\nProxyPass       /       http://www1.foo.com/bar/\nProxyPassReverse /      http://www1.foo.com/bar/\nProxyPassReverseCookieDomain www1.foo.com .foo.com\n----------------------------------------------------\nIt works, ProxyPassReverseCookieDomain permits us to rewrite the cookie as a\n'domain valid' cookie for -bad- applications that cannot do it on their own.\n\nBut When such applications aren't setting any domain information on the cookie\nwe cannot enforce the cookie domain. This cookie domain is empty and so browsers\ninterpret it as the host name (here the proxy public name). Bad.\nlets say we should be able to write:\nProxyPassReverseCookieDomain \"\" \".foo.com\"\nor \nProxyPassReverseCookieDomain NULL .foo.com\nIt's not possible\n\nWorkaround: Actually we handle this situation by injection Cookie Domain in\nCookie path rewriting that way:\nProxyPassReverseCookiePath / \"/; Domain=.foo.com\"\nAnd it works, but that's piggy.", "id": 113271, "time": "2008-01-29T12:39:22Z", "creator": "regis.leroy@makina-corpus.com", "creation_time": "2008-01-29T12:39:22Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 44322, "attachment_id": null, "is_private": false, "id": 138431, "time": "2010-07-14T17:51:12Z", "creator": "bill+apache@bfccomputing.com", "creation_time": "2010-07-14T17:51:12Z", "text": "This came up for me today with Tomcat's JSESSIONID which sets a path but not a domain.\n\nThis is a sick, twisted, and clever work-around from Jason Butler:\n\nHeader edit Set-Cookie \"(JSESSIONID\\s?=[^;,]+?)((?:;\\s?(?:(?i)Comment|Max-Age|Path|Version|Secure)[^;,]*?)*)(;\\s?(?:(?i)Domain\\s?=)[^;,]+?)?((?:;\\s?(?:(?i)Comment|Max-Age|Path|Version|Secure)[^;,]*?)*)(,|$)\" \"$1$2; Domain=.example.com$4$5\"\n\nbut it would be better to have native support for this.  I'd prefer the NULL magic word approach."}]