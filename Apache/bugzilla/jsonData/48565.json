[{"count": 0, "tags": [], "bug_id": 48565, "attachment_id": null, "text": "Hi, \n\nIn our two node cluster we have made a membership configuration using StaticMembershipInterceptor.\n\nNodes are added and removed successfuly (or I hope soy) but when a node (tomcat service) goes down system raises the following stack trace in catalina.out:\n\nI have read about bug: 45261 which it looks fixed in version 6.0.19 but I'm currently experiencing the issue.\n\n\nThe stack trace:\n\n18-ene-2010 12:52:52 org.apache.catalina.ha.tcp.SimpleTcpCluster memberAdded\nINFO: Replication member added:org.apache.catalina.tribes.membership.MemberImpl[tcp://192.168.0.38:4038,192.168.0.38,4038, alive=0,id={0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 38 }, payload={}, command={}, domain={}, ]\n18-ene-2010 12:52:52 org.apache.catalina.tribes.group.interceptors.TcpFailureDetector performBasicCheck\nINFO: Suspect member, confirmed alive.[org.apache.catalina.tribes.membership.MemberImpl[tcp://192.168.0.38:4038,192.168.0.38,4038, alive=0,id={0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 38 }, payload={}, command={}, domain={}, ]]\n18-ene-2010 12:52:53 org.apache.catalina.tribes.io.BufferPool getBufferPool\nINFO: Created a buffer pool with max size:104857600 bytes of type:org.apache.catalina.tribes.io.BufferPool15Impl\n18-ene-2010 12:52:54 org.apache.catalina.tribes.group.interceptors.ThroughputInterceptor report\nINFO: ThroughputInterceptor Report[\n\tTx Msg:1 messages\n\tSent:0,00 MB (total)\n\tSent:0,00 MB (application)\n\tTime:0,02 seconds\n\tTx Speed:0,04 MB/sec (total)\n\tTxSpeed:0,04 MB/sec (application)\n\tError Msg:0\n\tRx Msg:2 messages\n\tRx Speed:0,00 MB/sec (since 1st msg)\n\tReceived:0,00 MB]\n\n18-ene-2010 12:55:09 org.apache.catalina.tribes.transport.nio.ParallelNioSender doLoop\nADVERTENCIA: Member send is failing for:tcp://192.168.0.38:4038 ; Setting to suspect and retrying.\n18-ene-2010 12:55:11 org.apache.catalina.tribes.group.interceptors.TcpFailureDetector memberDisappeared\nINFO: Received memberDisappeared[org.apache.catalina.tribes.membership.MemberImpl[tcp://192.168.0.38:4038,192.168.0.38,4038, alive=0,id={0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 38 }, payload={}, command={}, domain={}, ]] message. Will verify.\n18-ene-2010 12:55:12 org.apache.catalina.tribes.group.interceptors.TcpFailureDetector memberDisappeared\nINFO: Verification complete. Member disappeared[org.apache.catalina.tribes.membership.MemberImpl[tcp://192.168.0.38:4038,192.168.0.38,4038, alive=0,id={0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 38 }, payload={}, command={}, domain={}, ]]\n18-ene-2010 12:55:12 org.apache.catalina.ha.tcp.SimpleTcpCluster memberDisappeared\nINFO: Received member disappeared:org.apache.catalina.tribes.membership.MemberImpl[tcp://192.168.0.38:4038,192.168.0.38,4038, alive=0,id={0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 38 }, payload={}, command={}, domain={}, ]\n18-ene-2010 12:55:12 org.apache.catalina.ha.tcp.SimpleTcpCluster send\nGRAVE: Unable to send message through cluster sender.\norg.apache.catalina.tribes.ChannelException: Send failed, attempt:2 max:1; Faulty members:tcp://192.168.0.38:4038; \n\tat org.apache.catalina.tribes.transport.nio.ParallelNioSender.doLoop(ParallelNioSender.java:172)\n\tat org.apache.catalina.tribes.transport.nio.ParallelNioSender.sendMessage(ParallelNioSender.java:78)\n\tat org.apache.catalina.tribes.transport.nio.PooledParallelSender.sendMessage(PooledParallelSender.java:53)\n\tat org.apache.catalina.tribes.transport.ReplicationTransmitter.sendMessage(ReplicationTransmitter.java:80)\n\tat org.apache.catalina.tribes.group.ChannelCoordinator.sendMessage(ChannelCoordinator.java:78)\n\tat org.apache.catalina.tribes.group.ChannelInterceptorBase.sendMessage(ChannelInterceptorBase.java:75)\n\tat org.apache.catalina.tribes.group.interceptors.ThroughputInterceptor.sendMessage(ThroughputInterceptor.java:61)\n\tat org.apache.catalina.tribes.group.ChannelInterceptorBase.sendMessage(ChannelInterceptorBase.java:75)\n\tat org.apache.catalina.tribes.group.interceptors.MessageDispatchInterceptor.sendMessage(MessageDispatchInterceptor.java:73)\n\tat org.apache.catalina.tribes.group.ChannelInterceptorBase.sendMessage(ChannelInterceptorBase.java:75)\n\tat org.apache.catalina.tribes.group.ChannelInterceptorBase.sendMessage(ChannelInterceptorBase.java:75)\n\tat org.apache.catalina.tribes.group.interceptors.TcpFailureDetector.sendMessage(TcpFailureDetector.java:87)\n\tat org.apache.catalina.tribes.group.ChannelInterceptorBase.sendMessage(ChannelInterceptorBase.java:75)\n\tat org.apache.catalina.tribes.group.GroupChannel.send(GroupChannel.java:216)\n\tat org.apache.catalina.tribes.group.GroupChannel.send(GroupChannel.java:175)\n\tat org.apache.catalina.ha.tcp.SimpleTcpCluster.send(SimpleTcpCluster.java:818)\n\tat org.apache.catalina.ha.tcp.SimpleTcpCluster.sendClusterDomain(SimpleTcpCluster.java:796)\n\tat org.apache.catalina.ha.tcp.ReplicationValve.send(ReplicationValve.java:553)\n\tat org.apache.catalina.ha.tcp.ReplicationValve.sendMessage(ReplicationValve.java:537)\n\tat org.apache.catalina.ha.tcp.ReplicationValve.sendSessionReplicationMessage(ReplicationValve.java:519)\n\tat org.apache.catalina.ha.tcp.ReplicationValve.sendReplicationMessage(ReplicationValve.java:430)\n\tat org.apache.catalina.ha.tcp.ReplicationValve.invoke(ReplicationValve.java:363)\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)\n\tat org.apache.coyote.ajp.AjpAprProcessor.process(AjpAprProcessor.java:427)\n\tat org.apache.coyote.ajp.AjpAprProtocol$AjpConnectionHandler.process(AjpAprProtocol.java:384)\n\tat org.apache.tomcat.util.net.AprEndpoint$Worker.run(AprEndpoint.java:1527)\n\tat java.lang.Thread.run(Unknown Source)\nCaused by: java.net.ConnectException: Connection refused: no further information\n\tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)\n\tat sun.nio.ch.SocketChannelImpl.finishConnect(Unknown Source)\n\tat org.apache.catalina.tribes.transport.nio.NioSender.process(NioSender.java:88)\n\tat org.apache.catalina.tribes.transport.nio.ParallelNioSender.doLoop(ParallelNioSender.java:130)\n\t... 26 more\n18-ene-2010 13:00:01 org.apache.catalina.tribes.group.interceptors.TcpFailureDetector performBasicCheck\nADVERTENCIA: Member added, even though we werent notified:org.apache.catalina.tribes.membership.MemberImpl[tcp://192.168.0.38:4038,192.168.0.38,4038, alive=0,id={0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 38 }, payload={}, command={}, domain={}, ]\n18-ene-2010 13:00:01 org.apache.catalina.ha.tcp.SimpleTcpCluster memberAdded\nINFO: Replication member added:org.apache.catalina.tribes.membership.MemberImpl[tcp://192.168.0.38:4038,192.168.0.38,4038, alive=0,id={0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 38 }, payload={}, command={}, domain={}, ]", "id": 133678, "time": "2010-01-18T04:20:02Z", "creator": "osegarra@gencat.net", "creation_time": "2010-01-18T04:20:02Z", "is_private": false}, {"count": 1, "tags": [], "creator": "osegarra@gencat.net", "attachment_id": null, "id": 133875, "time": "2010-01-25T00:39:35Z", "bug_id": 48565, "creation_time": "2010-01-25T00:39:35Z", "is_private": false, "text": "Hi, \n\nIs there any new on this issue ?\n\nThanks a lot!"}, {"count": 2, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 134523, "time": "2010-02-15T17:30:53Z", "bug_id": 48565, "creation_time": "2010-02-15T17:30:53Z", "is_private": false, "text": "I don't see anything unusual in the log file. A member went down, a message to that member was lost which resulted in an error being logged and finally the member came back."}, {"count": 3, "tags": [], "bug_id": 48565, "attachment_id": null, "text": "Hi, \n\nIn tomcat 5.5 when a member goes down the other node just inform it but it did not raise a java stack trace.\n\nI think would be better to display a simple message instead of an ugly stack trace. This stack trace is confusing and it has made me to think it is a bug, not the correct behaviour.\n\nThanks a lot Mark", "id": 134525, "time": "2010-02-15T17:36:25Z", "creator": "osegarra@gencat.net", "creation_time": "2010-02-15T17:36:25Z", "is_private": false}]