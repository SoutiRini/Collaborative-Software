[{"text": "Seems we introduced a dependency on XMLBeans > 2.3.0, see the discussion at http://stackoverflow.com/questions/36063592/exception-in-thread-main-org-apache-poi-poixmlexception-exception-appearing-wh\n\nCaused by: java.lang.NoSuchMethodError: org.apache.xmlbeans.XmlOptions.setLoadEntityBytesLimit(I)Lorg/apache/xmlbeans/XmlOptions;\n    at org.apache.poi.POIXMLTypeLoader.<clinit>(POIXMLTypeLoader.java:50)\n    at org.apache.poi.xssf.model.ThemesTable.<init>(ThemesTable.java:85)\n    ... 10 more\n\nEither we should update to XMLBeans 2.6.0 officially or try to work around this by catching the NoSuchMethodError at this place.\n\nIf we want to stay compatible, we also should enhance the \"source build tests\" in src/integrationtest/build.xml to run a full build/test with XMLBeans 2.3.0 to verify that it keeps working in the future.", "tags": [], "bug_id": 59195, "attachment_id": null, "count": 0, "id": 189566, "time": "2016-03-18T07:24:56Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-03-18T07:24:56Z", "is_private": false}, {"count": 1, "tags": [], "creator": "kiwiwings@apache.org", "text": "I guess the call can be removed, as the xml streams are now processed via jaxp instead of the picollo parser. To make sure, that the picollo parser isn't used incidentally, how about removing its classes from the xmlbeans jars within the ant build?", "id": 189567, "time": "2016-03-18T07:34:26Z", "bug_id": 59195, "creation_time": "2016-03-18T07:34:26Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 59195, "attachment_id": null, "text": "I've removed the piccolo classes in the xmlbeans jars used for our build via r1735685\nThe failing XmlOption is now also disabled, as JAXP is used for parsing.\n\nAs we require JDK 6 as a minimum, I still don't see a reason for not upgrading to xmlbeans 2.6.0, i.e. asking our users to upgrade as we usually do for our own releases ...", "id": 189594, "time": "2016-03-18T21:40:37Z", "creator": "kiwiwings@apache.org", "creation_time": "2016-03-18T21:40:37Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 59195, "text": "Xmlbeans is shipped with all sorts of frameworks and runtimes and application servers, so upgrading can be hard. Also, the xmlbeans 2.6.0 jars are broken, which means some refuse to upgrade, or really struggle due to the need to repack it\n\nMaybe we could get together with Tika and Lucene, and ask the Attic PMC to let us put together a 2.6.1 release with the packaging fix and some others, if someone fancies spending a little bit of time to lead that?\n\n(I'd be much happier, if we do force people to upgrade, to make them upgrade to a non-broken release!)", "id": 189595, "time": "2016-03-18T21:50:39Z", "creator": "apache@gagravarr.org", "creation_time": "2016-03-18T21:50:39Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 59195, "text": "for the sake of completeness I link the thread [1] which mention the locking problem in xmlbeans. I have already forgotten about it ... :(\n\n\n[1] http://apache-poi.1045710.n5.nabble.com/Alternative-Replacement-for-xmlbeans-tt5722053.html", "id": 189596, "time": "2016-03-18T21:59:10Z", "creator": "kiwiwings@apache.org", "creation_time": "2016-03-18T21:59:10Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 59195, "attachment_id": null, "id": 193083, "creation_time": "2016-08-13T20:45:42Z", "time": "2016-08-13T20:45:42Z", "creator": "dominik.stadler@gmx.at", "text": "I think the best fix here will be to produce an updated XmlBeans which fixes the issues and allows us to depend on it alone and not 2.3.0 any more as this can cause all sorts of strange issues, thus I am closing this as duplicate of Bug 59268 for now.\n\n*** This bug has been marked as a duplicate of bug 59268 ***", "is_private": false}]