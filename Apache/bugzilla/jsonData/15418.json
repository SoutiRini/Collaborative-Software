[{"count": 0, "tags": [], "bug_id": 15418, "is_private": false, "text": "I have been researching this issue for some time...\n\nRelevant software versions:\n  Apache is 1.3.27 with SSL (2.8.12)\n  PHP 4.2.3 (w/ Zend P.S. 3.0.0)\n\nWe experience load spikes throughout the day. It almost looks counter driven -- \nthat is, after a certain number of requests it goes into a spike. So at night \nthey are farther between than in the middle of the day when things are busy. It \nis not really counter driven, of course, just looks that way. Look at \nhttp://www.network54.com/spikes/spikes.html for a graph.\n\nThe vmstat (at http://www.network54.com/spikes/vmstat.txt and included at the \nend of the message) is intriguing. Right before a spike, idle time soars and \nthe number of processes running is zero. Then the opposite, as it seems all \nprocesses get woken up and idle time goes to zero. It then takes a while to \nunwind.\n\nAdditional note: During a spike, the parent seems to try and wake everyone up \nand then starts spawning more children until it reaches its limit. All apache \nprocesses seem to be writing (could be 100,500,1000, whatever the \nHARD_SERVER_LIMIT was). The spikes still occur even if the MinServers is set to \nthe max and the parent process does not fork(). It is just worse when it does \nthe fork as well.\n\n\n\n\n\n\n\n\n\n\n\n\n   procs                      memory    swap          io     system         cpu\n r  b  w   swpd   free   buff  cache  si  so    bi    bo   in    cs  us  sy  id\n35  0  0  15960 129416  30932 208580   0   0     0     0 6908 29026  50  33  16\n58  0  0  15960 129636  30932 208580   0   0     0     0 4687 32111  24  31  45\n95  0  2  15960 130004  30940 208600   0   0    24    52 6520 15570  41  26  33\n88  0  2  15960 129084  30940 208600   0   0     0     0 8664 19536  64  36   0\n93  0  2  15960 128152  30940 208648   0   0     0     0 8690 19290  67  33   0\n 4  0  0  15960 126680  30940 208652   0   0     0     0 8455 20292  66  31   3\n32  0  0  15960 127264  30940 208672   0   0     0     0 3492 19996  16  21  63\n 2  0  0  15960 127596  30944 208676   0   0     0    84 3733 12757  20  17  63\n 1  0  0  15960 127712  30944 208680   0   0     0     0 2474  4759  12   8  79\n 0  0  0  15960 127824  30944 208688   0   0     0     0 3028  1248  15   8  77\n 0  0  0  15960 127660  30944 208720   0   0     0     0 7436  3884  35  19  46\n 0  0  0  15960 126924  30948 208724   0   0     0    56 1361   394   4   3  93\n 0  0  0  15960 122576  30948 208732   0   0     0     0 1306   402   6   4  90\n54  0  3  15960 109112  30948 208740   0   0     0     0 6100  2842  35  17  48\n327  0  2  15960  91432  30948 208744   0   0     0     0 5795  2404  41  20  39\n299  1  3  15960  79884  30948 208764   0   0     0     0 9154  3847  73  27   0\n277  0  2  15960  78028  30964 208768   0   0    16   244 8637  3911  67  33   0\n285  0  2  15960  74708  30964 208828   0   0     0     0 10260  4731  68  32   \n0\n275  0  2  15960  71660  30984 208880   0   0    68     0 13746  6097  66  34   \n0\n279  0  2  15960  70708  30996 208932   0   0    72     0 9439  4312  64  36   0\n283  0  2  15960  68624  31004 208956   0   0    24    64 9800  4874  60  39   1\n281  0  2  15960  67808  31004 208964   0   0     0     0 9773  4489  63  37   0\n232  0  2  15960  66776  31004 208972   0   0     0     0 10394  6636  58  41   \n0\n223  0  2  15960  63644  31012 209040   0   0    72     0 11785 10343  55  45   \n0\n241  0  2  15960  63372  31012 209148   0   0   104     0 9064 12047  63  37   0", "id": 27902, "time": "2002-12-16T21:28:52Z", "creator": "sroussey@network54.com", "creation_time": "2002-12-16T21:28:52Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 15418, "text": "Additional note about vmstat. Right before the load spike, when the idle time \ngoes way up, the context switches and interupts plummet! During that time they \nare 400 cs/second where normal is 19000 cs/second. During the load spike, it is \nabout 4000 cs/second and later goes back to the normal 19000+ cs/second.\n\n", "id": 27903, "time": "2002-12-16T21:34:49Z", "creator": "sroussey@network54.com", "creation_time": "2002-12-16T21:34:49Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 15418, "attachment_id": null, "id": 27911, "time": "2002-12-17T00:27:57Z", "creator": "sroussey@network54.com", "creation_time": "2002-12-17T00:27:57Z", "is_private": false, "text": "One last note: this server listens on three ports.\n\n(I swear this looks just like http://bugs.apache.org/index/full/467 though I \ndon't figure that is possible. Changes in Linux 2.4 and how Apache uses them \nshould make things better not worse...)"}, {"count": 3, "tags": [], "creator": "jim@apache.org", "attachment_id": null, "text": "reopen if bug still exists with 1.3.34-dev", "id": 67850, "time": "2004-12-03T01:49:03Z", "bug_id": 15418, "creation_time": "2004-12-03T01:49:03Z", "is_private": false}]