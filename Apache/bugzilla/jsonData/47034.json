[{"count": 0, "tags": [], "bug_id": 47034, "attachment_id": 23494, "id": 126246, "time": "2009-04-15T03:02:05Z", "creator": "matthew.knl@gmail.com", "creation_time": "2009-04-15T03:02:05Z", "is_private": false, "text": "Created attachment 23494\nproblem.xls\n\nPlease check the attached Excel file, it throws \"RecordFormatException: Unable to construct record instance\" when open it by following codes.\n--\nFileInputStream is = new FileInputStream(\"problem.xls\")\nPOIFSFileSystem poifs = new POIFSFileSystem(is);\nreturn new HSSFWorkbook(poifs);\n--\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\tat org.apache.poi.hssf.record.RecordFactory$ReflectionRecordCreator.create(RecordFactory.java:71)\n\tat org.apache.poi.hssf.record.RecordFactory.createSingleRecord(RecordFactory.java:254)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:373)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:277)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:202)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:184)"}, {"count": 1, "attachment_id": null, "bug_id": 47034, "is_private": false, "id": 126247, "time": "2009-04-15T03:09:02Z", "creator": "apache@gagravarr.org", "creation_time": "2009-04-15T03:09:02Z", "tags": [], "text": "Could you please post the full stacktrace, so we can see which record can't be created? Also, can you please confirm which build of 3.5 you're using?"}, {"count": 2, "tags": [], "bug_id": 47034, "attachment_id": null, "id": 126249, "time": "2009-04-15T03:22:24Z", "creator": "matthew.knl@gmail.com", "creation_time": "2009-04-15T03:22:24Z", "is_private": false, "text": "I am using the POI latest development version (checkout from SVN today)\nThe full stacktrace under the namespace \"org.apache.poi\" is pasted in previous post."}, {"count": 3, "tags": [], "bug_id": 47034, "is_private": false, "text": "Please check further down your stacktrace, you'll see there the details of the record that couldn't be constructed", "id": 126250, "time": "2009-04-15T03:39:42Z", "creator": "apache@gagravarr.org", "creation_time": "2009-04-15T03:39:42Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "matthew.knl@gmail.com", "attachment_id": null, "text": "org.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\tat org.apache.poi.hssf.record.RecordFactory$ReflectionRecordCreator.create(RecordFactory.java:71)\n\tat org.apache.poi.hssf.record.RecordFactory.createSingleRecord(RecordFactory.java:254)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:373)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:277)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:202)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:184)\n\tat com.dttn.excel.helper.ExcelFactory.readExcel03(ExcelFactory.java:116)\n\tat com.dttn.excel.helper.ExcelFactory.readExcel03(ExcelFactory.java:86)\n\tat com.dttn.excel.helper.ExcelFactory.read(ExcelFactory.java:33)\n\tat com.dttn.excel.generator.module.ExcelEnveloperModule.actionPerformed(ExcelEnveloperModule.java:112)\n\tat javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:1995)\n\tat javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2318)\n\tat javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:387)\n\tat javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:242)\n\tat javax.swing.plaf.basic.BasicButtonListener.mouseReleased(BasicButtonListener.java:236)\n\tat java.awt.Component.processMouseEvent(Component.java:6134)\n\tat javax.swing.JComponent.processMouseEvent(JComponent.java:3265)\n\tat java.awt.Component.processEvent(Component.java:5899)\n\tat java.awt.Container.processEvent(Container.java:2023)\n\tat java.awt.Component.dispatchEventImpl(Component.java:4501)\n\tat java.awt.Container.dispatchEventImpl(Container.java:2081)\n\tat java.awt.Component.dispatchEvent(Component.java:4331)\n\tat java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4301)\n\tat java.awt.LightweightDispatcher.processMouseEvent(Container.java:3965)\n\tat java.awt.LightweightDispatcher.dispatchEvent(Container.java:3895)\n\tat java.awt.Container.dispatchEventImpl(Container.java:2067)\n\tat java.awt.Window.dispatchEventImpl(Window.java:2458)\n\tat java.awt.Component.dispatchEvent(Component.java:4331)\n\tat java.awt.EventQueue.dispatchEvent(EventQueue.java:599)\n\tat java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:269)\n\tat java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:184)\n\tat java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:174)\n\tat java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:169)\n\tat java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:161)\n\tat java.awt.EventDispatchThread.run(EventDispatchThread.java:122)\nCaused by: java.lang.NegativeArraySizeException\n\tat org.apache.poi.util.StringUtil.readCompressedUnicode(StringUtil.java:119)\n\tat org.apache.poi.hssf.record.NameRecord.<init>(NameRecord.java:436)\n\tat sun.reflect.GeneratedConstructorAccessor5.newInstance(Unknown Source)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:513)\n\tat org.apache.poi.hssf.record.RecordFactory$ReflectionRecordCreator.create(RecordFactory.java:63)\n\t... 34 more", "id": 126251, "time": "2009-04-15T03:42:21Z", "bug_id": 47034, "creation_time": "2009-04-15T03:42:21Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 47034, "is_private": false, "text": "Fixed in svn (was a signed vs unsigned issue reading in very long strings)", "id": 126257, "time": "2009-04-15T05:42:36Z", "creator": "apache@gagravarr.org", "creation_time": "2009-04-15T05:42:36Z", "attachment_id": null}, {"count": 6, "tags": [], "text": "svn r765163", "attachment_id": null, "id": 126300, "creator": "josh@apache.org", "time": "2009-04-16T13:06:17Z", "bug_id": 47034, "creation_time": "2009-04-16T13:06:17Z", "is_private": false}, {"count": 7, "attachment_id": null, "bug_id": 47034, "is_private": false, "id": 126301, "time": "2009-04-16T13:06:57Z", "creator": "josh@apache.org", "creation_time": "2009-04-16T13:06:57Z", "tags": [], "text": "svn r765163\n."}]