[{"attachment_id": null, "tags": [], "bug_id": 33240, "is_private": false, "count": 0, "id": 70072, "time": "2005-01-25T18:31:32Z", "creator": "pbunce@momentumsi.com", "creation_time": "2005-01-25T18:31:32Z", "text": "Using propertyfile for date operation yields invalid dates.\nI am using a temporary (created and deleted each time) properties file for \nverifying default dates in testing (e.g. departure date should default to one \nweek from today), however the properties resulting from date operation (+) \ngives invalid dates. Today is 01/25/2005 (), so one week from now should be \n02/01/2005, but the entry ends up as 02/32/2005. The month gets incremented due \nto the wrap-over into Feb, but the day is just 25 + 7, instead of mod(#days-in-\norig-month). Just in case, I tried adding 1 week and adding 7 days, same result \n(as expected).\n===========================================\nSample build file:\n===========================================\n<project name=\"dateTest\" default=\"main\" basedir=\".\">\n\t<property name=\"test.props\" value=\"tmp.properties\"/>\n\n\t<propertyfile\n\t    file=\"${test.props}\"\n\t    comment=\"My properties\">\n\t  <entry  key=\"default.now\"\n\t      type=\"date\" default=\"now\" pattern=\"MM/DD/yyyy\" /> \n\t  <entry  key=\"default.departure.date.week\"\n\t      type=\"date\" default=\"now\" pattern=\"MM/DD/yyyy\"\n\t      operation=\"+\" value=\"1\" unit=\"week\"/> \n\t  <entry  key=\"default.departure.date.day\"\n\t      type=\"date\" default=\"now\" pattern=\"MM/DD/yyyy\"\n\t      operation=\"+\" value=\"7\" unit=\"day\"/> \n\t</propertyfile>\n\n\t<target name=\"main\" depends=\"echoTestProps,cleanTestProps\"/>\n\n  \t<target name=\"echoTestProps\" description=\"echo the test.properties \nfiles\">\n\t\t<property file=\"${test.props}\"/>\n         <echo message=\"default.now=${default.now}\"/>\n         <echo \nmessage=\"default.departure.date.week=${default.departure.date.week}\"/>\n         <echo \nmessage=\"default.departure.date.day=${default.departure.date.day}\"/>\n\t</target>\n\n  \t<target name=\"cleanTestProps\" description=\"cleans the test.properties \nfiles\">\n\t\t<delete file=\"${test.props}\"/>\n\t</target>\n\n</project>\n===========================================\nSample output:\n===========================================\nBuildfile: C:\\Projects\\SkyLink\\dateTest.xml\n[propertyfile] Creating new property file: C:\\Projects\\SkyLink\\tmp.properties\nechoTestProps:\n     [echo] default.now=01/25/2005\n     [echo] default.departure.date.week=02/32/2005\n     [echo] default.departure.date.day=02/32/2005\ncleanTestProps:\n   [delete] Deleting: C:\\Projects\\SkyLink\\tmp.properties\nmain:\nBUILD SUCCESSFUL\nTotal time: 281 milliseconds\n===========================================\nRegards,\n-Phil\npbunce@momentumsi.com"}, {"count": 1, "tags": [], "bug_id": 33240, "is_private": false, "text": "Doh!\n\nThe problem wasn't in Ant, it was in my use of the pattern.\n\nThe desired pattern = \"MM/dd/yyyy\" \n\nSorry for the fuss!\n\nRegards,\n-Phil", "id": 70073, "time": "2005-01-25T19:05:46Z", "creator": "pbunce@momentumsi.com", "creation_time": "2005-01-25T19:05:46Z", "attachment_id": null}, {"count": 2, "text": "I didn't think to check the java.text.SimpleDateFormat for the pattern.\n\nFor anyone else making my silly oversight:\n\nLetter  Date or Time Component  Presentation  Examples  \nG  Era designator  Text  AD  \ny  Year  Year  1996; 96  \nM  Month in year  Month  July; Jul; 07  \nw  Week in year  Number  27  \nW  Week in month  Number  2  \nD  Day in year  Number  189  \nd  Day in month  Number  10  \nF  Day of week in month  Number  2  \nE  Day in week  Text  Tuesday; Tue  \na  Am/pm marker  Text  PM  \nH  Hour in day (0-23)  Number  0  \nk  Hour in day (1-24)  Number  24  \nK  Hour in am/pm (0-11)  Number  0  \nh  Hour in am/pm (1-12)  Number  12  \nm  Minute in hour  Number  30  \ns  Second in minute  Number  55  \nS  Millisecond  Number  978  \nz  Time zone  General time zone  Pacific Standard Time; PST; GMT-08:00  \nZ  Time zone  RFC 822 time zone  -0800  \n", "bug_id": 33240, "is_private": false, "id": 70074, "time": "2005-01-25T19:18:17Z", "creator": "pbunce@momentumsi.com", "creation_time": "2005-01-25T19:18:17Z", "tags": [], "attachment_id": null}]