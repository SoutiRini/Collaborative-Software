[{"count": 0, "tags": [], "bug_id": 30833, "attachment_id": null, "id": 62422, "time": "2004-08-24T19:05:58Z", "creator": "jks@iname.com", "creation_time": "2004-08-24T19:05:58Z", "is_private": false, "text": "From the spec:\n\"the servlet container must convert the relative URL to an absolute URL before\nsending the response to the client.\"\n\nThe problem is that the port is not preserved in the redirect.  For example take\nthe simply jsp:\n\n<%\n                response.sendRedirect(\"snoop.jsp\");\n%>\n\nWhen in a web browser (mozilla 1.7.2) the port is preserved (for this test case,\nnot all the time).  But telneting to apache/tomcat myself resulted in:\n\n$ telnet login.d1segs.selectacast.net 81\nTrying 199.107.233.211...\nConnected to login.d1segs.selectacast.net.\nEscape character is '^]'.\nPOST /redirect-test.jsp HTTP/1.1       \nHOST: login.d1segs.selectacast.net\n\nHTTP/1.1 302 Moved Temporarily\nDate: Tue, 24 Aug 2004 18:46:13 GMT\nServer: Apache/2.0.50 (Unix) mod_ssl/2.0.50 OpenSSL/0.9.7a mod_jk/1.2.5\nSet-Cookie: JSESSIONID=8E18AD6D77E3D1337DA9FDF1BC7C0F4B; Path=/\nLocation: http://login.d1segs.selectacast.net/snoop.jsp\n                               ^^^^ See, no port.\nContent-Length: 0\nContent-Type: text/html; charset=ISO-8859-1\n\nLike I said in a web browser in this test case the port was preserved, but the\nreason I was poking around in this is that in my real jsp the port was not being\npreserved."}, {"count": 1, "tags": [], "text": "upon further investigation request.getServerPort() is returning 80 instead of\n81.  I don't know why sometimes it works and sometimes it doesn't.\n\nTo test put this in a jsp:\n<%= request.getServerPort() %>\n\n$ telnet login.d1segs.selectacast.net 81\nTrying 199.107.233.211...\nConnected to login.d1segs.selectacast.net.\nEscape character is '^]'.\nGET /server-port.jsp HTTP/1.1\nHOST: login.d1segs.selectacast.net\n\nHTTP/1.1 200 OK\nDate: Tue, 24 Aug 2004 19:43:22 GMT\nServer: Apache/2.0.50 (Unix) mod_ssl/2.0.50 OpenSSL/0.9.7a mod_jk/1.2.5\nSet-Cookie: JSESSIONID=1E19BDEFF3713F319A41AFEF78ACB799; Path=/\nContent-Length: 3\nContent-Type: text/html; charset=ISO-8859-1\nX-Pad: avoid browser bug\n\n80\n\n... but again in the web browser it does show the correct port:\nhttp://login.d1segs.selectacast.net:81/server-port.jsp\n\n<note: that url is subject to be taken down at any time so it would be best to\nrun the test on your local machine>", "is_private": false, "id": 62426, "creator": "jks@iname.com", "time": "2004-08-24T19:46:35Z", "bug_id": 30833, "creation_time": "2004-08-24T19:46:35Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 30833, "attachment_id": null, "is_private": false, "id": 62427, "time": "2004-08-24T19:56:19Z", "creator": "jks@iname.com", "creation_time": "2004-08-24T19:56:19Z", "text": "I'm changing component to Connector:Coyote even through this problem happens if\nI use the HTTP connector."}, {"count": 3, "tags": [], "creator": "jks@iname.com", "attachment_id": null, "text": "I should clarify: it *also* happens if I use the HTTP connector.", "id": 62428, "time": "2004-08-24T19:57:26Z", "bug_id": 30833, "creation_time": "2004-08-24T19:57:26Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 30833, "attachment_id": null, "id": 62453, "time": "2004-08-25T09:52:54Z", "creator": "funkman@joedog.org", "creation_time": "2004-08-25T09:52:54Z", "is_private": false, "text": "http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.23\n\nYour Host header should be:\n    Host: login.d1segs.selectacast.net:81\nnot\n   Host: login.d1segs.selectacast.net\n"}, {"attachment_id": null, "tags": [], "bug_id": 30833, "is_private": false, "count": 5, "id": 62505, "time": "2004-08-25T21:15:23Z", "creator": "jks@iname.com", "creation_time": "2004-08-25T21:15:23Z", "text": "Yup, you're right.\nhttp://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.23 if anyone cares.\n\nShould I mark this as verified invalid or as closed?"}]