[{"count": 0, "tags": [], "text": "If you create a DataValidation with a prompt text longer than the excel maximum (seems to be 32 characters) POI allows this to be made.  However, when opening the file with excel, assuming protected view is enabled, excel will go to protected view.  Furthermore, if you open up the data validation from excel you will not be able to edit the prompt title.", "is_private": false, "id": 189582, "creator": "hullmo@gmail.com", "time": "2016-03-18T14:57:12Z", "bug_id": 59200, "creation_time": "2016-03-18T14:57:12Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "dominik.stadler@gmx.at", "is_private": false, "text": "Can you provide a unit-test or at least a code-snippet that shows how you create the invalid data validation? This would make it much easier for others to reproduce the problem.", "id": 189764, "time": "2016-03-28T19:33:35Z", "bug_id": 59200, "creation_time": "2016-03-28T19:33:35Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "hullmo@gmail.com", "is_private": false, "text": "Sorry if this isn't in a reasonable format, I'm completely new to this.\n\n        String promptTitle;\n        DataValidation dataValidation;\n        CellRangeAddressList headerCell = new CellRangeAddressList(ImportFileBundleSheets.FIRST_ROW_INDEX, ImportFileBundleSheets.FIRST_ROW_INDEX, columnNum, columnNum);\n        DataValidationConstraint constraint = sheet.getDataValidationHelper().createCustomConstraint(\"A1<>\\\"\\\"\");\n\n        dataValidation = new HSSFDataValidation(headerCell, constraint);\n        promptTitle = PortalServices.getI18nString(adminLocale, GroupImportConstants.PROMPT_TITLE);\n\n        dataValidation.createPromptBox(\"Some long title that is greater than 32 characters in length\", promptDescription);\n        dataValidation.setShowErrorBox(false);\n        sheet.addValidationData(dataValidation);", "id": 189765, "time": "2016-03-28T19:47:55Z", "bug_id": 59200, "creation_time": "2016-03-28T19:47:55Z", "attachment_id": null}, {"count": 3, "tags": [], "text": "Fixed via r1771254, the spec states a limit for HSSF of 32 length for title and 255 length for text. For XSSF it does not state a limit as far as I saw, but Excel imposes a 255 length limit for both title and text, so I applied this limit as well here.", "is_private": false, "id": 195200, "creator": "dominik.stadler@gmx.at", "time": "2016-11-25T08:57:46Z", "bug_id": 59200, "creation_time": "2016-11-25T08:57:46Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "onealj@apache.org", "is_private": false, "text": "(In reply to Morgan Hull from comment #2)\n> Sorry if this isn't in a reasonable format, I'm completely new to this.\n\nIt's fine to submit small, trivial changes as a comment, preferably prefixing each line with \"> \" so that Bugzilla doesn't text-wrap the code.\n\nIf your changes get much bigger or it's ambiguous *what* you're suggesting should be changed, there's an easier way.\n\nCheck out the source code using SVN [1], save your changes in the source code, then save an svn patch file (\"svn diff > patch.txt\" or using a graphical client). Then upload the patch file.\nSee [2] for more info.\n\nThanks for contributing!\n\n[1] https://poi.apache.org/subversion.html\n[2] https://poi.apache.org/guidelines.html#Submitting+Patches", "id": 195279, "time": "2016-11-29T01:45:00Z", "bug_id": 59200, "creation_time": "2016-11-29T01:45:00Z", "attachment_id": null}]