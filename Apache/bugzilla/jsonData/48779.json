[{"count": 0, "tags": [], "text": "If you try to get a color from a cell which has a non-empty color, you always get black color independently of what is the right color of the cell. This bug can be reproduced only for Excel 2007 formats. For '.xls' files it's not reproducible. \n\nSo if you run the following code for the attached files:\n\tpublic static void main(String[] args) {\n\t\tWorkbook workbook = null;\n\t\ttry {\n\t\t\tworkbook = new XSSFWorkbook(\"C:/Test.xlsx\");\n\t\t\tSystem.out.println(\"Cell color in Excel 2007: \" + \n\t\t\t\t\tworkbook.getSheetAt(0).getRow(0).getCell(0)\n\t\t\t\t\t\t.getCellStyle().getFillForegroundColor());\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\n\t\ttry {\n\t\t\tworkbook = new HSSFWorkbook(new FileInputStream(\"C:/Test.xls\"));\n\t\t\tSystem.out.println(\"Cell color in Excel 2003: \" + \n\t\t\t\t\tworkbook.getSheetAt(0).getRow(0).getCell(0)\n\t\t\t\t\t\t.getCellStyle().getFillForegroundColor());\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n\nyou will see the following output:\nCell color in Excel 2007: 0\nCell color in Excel 2003: 10\n\nThanks,\nAndrej", "attachment_id": null, "id": 134700, "creation_time": "2010-02-19T15:04:24Z", "time": "2010-02-19T15:04:24Z", "creator": "AndrejRW@tut.by", "bug_id": 48779, "is_private": false}, {"count": 1, "tags": [], "creator": "AndrejRW@tut.by", "attachment_id": 25024, "is_private": false, "id": 134701, "time": "2010-02-19T15:05:28Z", "bug_id": 48779, "creation_time": "2010-02-19T15:05:28Z", "text": "Created attachment 25024\ntest file"}, {"attachment_id": null, "tags": [], "bug_id": 48779, "is_private": false, "count": 2, "id": 137156, "time": "2010-05-26T13:48:22Z", "creator": "apache@gagravarr.org", "creation_time": "2010-05-26T13:48:22Z", "text": "The problem is that XSSF does some colours differently to HSSF. HSSF only ever had indexed colours, while XSSF has a mixture of indexed colours and inline defined colours\n\nI'd suggest you try the new getFillForegroundColorColor() and getFillBackgroundColorColor() methods on a CellStyle, which'll always get you the underlying Color object no matter if they're inline or indexed\n\nPlease give feedback on the mailing list about the new ss.usermodel.Color class, as at the moment it's a stub, but if we can decide what's generic between XSSFColor and HSSFColor we can add in methods to it\n\n(You'll need a svn checkout of r948511 of later)"}]