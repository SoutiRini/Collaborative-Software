[{"count": 0, "tags": [], "text": "Further testing of our application has shown up a problem using\nmod_fcgid 2.3.4.\n\nWith the following configuration we are seeing the request body\nof POST messages get stripped out if FcgidAuthorizer is used for\nLocation /player.  If we comment out the \"Require onelan magic\" the\nPOSTs work.\n\nLooking at bridge_request we see the code is reading the input buckets\nand feeding then to the Authorizer.\n\nIt seems to us that:\n\nEither this must not happen if the fcgid is an authorizer\nor the buckets must be put back for whatever handles\nthe POST to process.\n\nBarry\n\n\n...\nLoadModule fcgid_module modules/mod_fcgid.so\n\nFcgidCmdOptions /usr/local/onelan/html/dsmauthorizer.fcgi MaxProcesses 1\nFcgidCmdOptions /usr/local/onelan/html/dsm.fcgi MaxProcesses 1\nFcgidCmdOptions /usr/local/onelan/html/dsmxml.fcgi MaxProcesses 1\n\n\n<VirtualHost *:80>\n\n   #+ Rewrite Web API Rules\n   RewriteEngine on\n\n   # security - deny TRACE and TRACK requests\n   RewriteCond %{REQUEST_METHOD} ^(TRACE|TRACK)\n   RewriteRule .* - [F]\n   #- Rewrite Web API Rules\n\n   #+ Rewrite Web API Rules\n   # make the URLs hide the use of dsm.fcgi\n   RewriteRule ^/$ /dsm.fcgi [L]\n   RewriteRule ^/(status|options|organisation|tools|setup|help)($|.*$) /dsm.fcgi/$1$2 [L]\n   #- Rewrite Web API Rules\n\n   #+ Rewrite XML API Rules\n   # make the URLs hide the use of dsmxml.fcgi\n   RewriteRule ^/(XML)($|.*$) /dsmxml.fcgi/$1$2 [L]\n   #- Rewrite XML API Rules\n\n   #+ Rewrite VPN\n   ReWriteMap ntb_ip_address prg:/usr/local/onelan/dsm/bin/vpn_lookup_ip_address\n   RewriteRule ^/player/(\\d+)\\.(.*) http://${ntb_ip_address:$1}:8080/player/$1.$2 [P]\n   #- Rewrite VPN\n\n   #+ Locations Web VPN API\n   <Location /player>\n         #+ HTTP auth file\n       Order allow,deny\n       Allow from all\n       AuthType Digest\n       AuthName \"Manager System\"\n       AuthGroupFile /etc/onelan/common/http.group\n       AuthUserFile /etc/onelan/common/http.passwd\n       Require onelan magic\n       #- HTTP auth file\n\n       FcgidAuthorizer /usr/local/onelan/html/dsmauthorizer.fcgi\n   </Location>\n</VirtualHost>", "attachment_id": null, "id": 131030, "creator": "barry.scott@onelan.com", "time": "2009-10-09T09:03:05Z", "bug_id": 47973, "creation_time": "2009-10-09T09:03:05Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 47973, "text": "Created attachment 24369\ntest fix for bug 47973\n\nApply to mod_fcgid 2.3.4.", "id": 131031, "time": "2009-10-09T09:49:43Z", "creator": "trawick@apache.org", "creation_time": "2009-10-09T09:49:43Z", "is_private": false, "attachment_id": 24369}, {"count": 2, "tags": [], "creator": "trawick@apache.org", "attachment_id": null, "text": "Please try the attachment and report back.\nIt is holding up well for me for a request with post body which is authorized via mod_fcgid but ultimately handled by another module.", "id": 131033, "time": "2009-10-09T09:51:29Z", "bug_id": 47973, "creation_time": "2009-10-09T09:51:29Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 47973, "attachment_id": null, "is_private": false, "id": 131084, "time": "2009-10-12T06:57:02Z", "creator": "trawick@apache.org", "creation_time": "2009-10-12T06:57:02Z", "text": "A better patch was committed to trunk (mod_fcgid 2.3.5-dev)."}]