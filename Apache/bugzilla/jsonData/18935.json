[{"count": 0, "tags": [], "creator": "jvb@andrew.cmu.edu", "attachment_id": null, "text": "Running ant.bat as is returns a ClassDefFoundError. It seems to get confused \nwith the quotes placed around some jar files included in the classpath, \nspecifically catalina-ant and tools (actually, even classes.zip). \n\nI was able to fix it by changing the lines that add them to the LOCALCLASSPATH \nto:\ncall \"%ANT_HOME%\\bin\\lcp.bat\" %ANT_HOME%\\..\\server\\lib\\catalina-ant.jar\nif exist \"%JAVA_HOME%\\lib\\tools.jar\" call \"%ANT_HOME%\\bin\\lcp.bat\" %JAVA_HOME%\n\\lib\\tools.jar\nif exist \"%JAVA_HOME%\\lib\\classes.zip\" call \"%ANT_HOME%\\bin\\lcp.bat\" %\nJAVA_HOME%\\lib\\classes.zip\n\nAlso, there was something weird going on with these lines:\n\"%_JAVACMD%\" -classpath \"%LOCALCLASSPATH%\" \"-Dant.home=%ANT_HOME%\" \"-\nDjwsdp.home=%ANT_HOME%\\..\" %ANT_OPTS% org.apache.tools.ant.Main %\nANT_CMD_LINE_ARGS%\n\"%_JAVACMD%\" -classpath \"%LOCALCLASSPATH%\" \"-Dant.home=%ANT_HOME%\" \"-\nDjwsdp.home=%ANT_HOME%\\..\" -Djikes.class.path=\"%JIKESPATH%\" %ANT_OPTS% \norg.apache.tools.ant.Main %ANT_CMD_LINE_ARGS%\n\nThe quotes were before the '-Dant' and 'Djwdsp'. They should be:\n\"%_JAVACMD%\" -classpath \"%LOCALCLASSPATH%\" -Dant.home=\"%ANT_HOME%\" -\nDjwsdp.home=\"%ANT_HOME%\\..\" %ANT_OPTS% org.apache.tools.ant.Main %\nANT_CMD_LINE_ARGS%\n\"%_JAVACMD%\" -classpath \"%LOCALCLASSPATH%\" -Dant.home=\"%ANT_HOME%\" -\nDjwsdp.home=\"%ANT_HOME%\\..\" -Djikes.class.path=\"%JIKESPATH%\" %ANT_OPTS% \norg.apache.tools.ant.Main %ANT_CMD_LINE_ARGS%\n\nMaybe I'm wrong, but it worked.", "id": 34935, "time": "2003-04-11T05:08:11Z", "bug_id": 18935, "creation_time": "2003-04-11T05:08:11Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 18935, "attachment_id": null, "id": 34998, "time": "2003-04-11T16:17:10Z", "creator": "stevel@apache.org", "creation_time": "2003-04-11T16:17:10Z", "is_private": false, "text": "You would not believe how long it has taken to get the ant.bat file to deal with\nall the combinations of spaces in exe and directory names. If it works for\neveryone but you, we do have to assume that your system is somehow at fault. \n\nCan you show us your CLASSPATH variable>\n\nYou should not have *any* quote marks in your classpath. If you do, this bug is\ninvalid.\n\n\n\n\n"}, {"count": 2, "tags": [], "creator": "jvb@andrew.cmu.edu", "attachment_id": null, "id": 35014, "time": "2003-04-11T18:59:25Z", "bug_id": 18935, "creation_time": "2003-04-11T18:59:25Z", "is_private": false, "text": "I know how many problems the ant.bat file has caused. I've actually checked \nthe previous bugs to see whether it would solve my problem. But my original \nclasspath does not have quotes in them:\n\nC:\\Program Files\\SQLLIB\\java\\db2java.zip;C:\\Program \nFiles\\SQLLIB\\java\\runtime.zip;C:\\Program Files\\SQLLIB\\bin; C:\\Program \nFiles\\j2sdk1.4.0\\lib\\jwdsp-1_0_01\\common\\lib;C:\\Program Files\\j2sdk1.4.0\n\\lib\\jwsdp-1.1\\jaxb-1.0\\lib\\jaxb-api.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-\n1.1\\jaxb-1.0\\lib\\jaxb-ri.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jaxb-1.0\n\\lib\\jaxb-xjc.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jaxb-1.0\\lib\\jaxb-\nlibs.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jaxp-1.2.2\\lib\\jaxb-\napi.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jaxp-1.2.2\n\\lib\\endorsed\\xercesImpl.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jaxp-1.2\n.2\\lib\\endorsed\\xalan.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jaxp-1.2.2\n\\lib\\endorsed\\sax.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jaxp-1.2.2\n\\lib\\endorsed\\dom.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jwsdp-\nshared\\lib\\jax-qname.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jwsdp-\nshared\\lib\\namespace.jar;.\n\nWhen I echo the localclasspath generated from ant.bat, this is is what I get:\n\n\"C:\\PROGRAM FILES\\j2sdk1.4.0\\lib\\tools.jar\";\"C:\\Program Files\\j2sdk1.4.0\n\\lib\\jwsdp-1.1\\jakarta-ant-1.5.1\\..\\server\\lib\\catalina-ant.jar\";C:\\Program \nFiles\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jakarta-ant-1.5.1\\..\\jaxp-1.2.2\\lib\\jaxp-\napi.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jakarta-ant-1.5.1\\..\\jaxp-\n1.2.2\\lib\\endorsed\\xsltc.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jakarta-\nant-1.5.1\\..\\jaxp-1.2.2\\lib\\endorsed\\xercesImpl.jar;C:\\Program Files\\j2sdk1.4.0\n\\lib\\jwsdp-1.1\\jakarta-ant-1.5.1\\..\\jaxp-1.2.2\n\\lib\\endorsed\\xalan.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jakarta-ant-\n1.5.1\\..\\jaxp-1.2.2\\lib\\endorsed\\sax.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-\n1.1\\jakarta-ant-1.5.1\\..\\jaxp-1.2.2\\lib\\endorsed\\dom.jar;C:\\Program \nFiles\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jakarta-ant-1.5.1\\lib\\optional.jar;C:\\Program \nFiles\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jakarta-ant-1.5.1\\lib\\ant.jar;C:\\Program Files\\\nSQLLIB\\java\\db2java.zip;C:\\Program Files\\SQLLIB\\java\\runtime.zip;C:\\Program \nFiles\\SQLLIB\\bin; C:\\Program Files\\j2sdk1.4.0\\lib\\jwdsp-1_0_01\n\\common\\lib;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jaxb-1.0\\lib\\jaxb-\napi.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jaxb-1.0\\lib\\jaxb-\nri.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jaxb-1.0\\lib\\jaxb-\nxjc.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jaxb-1.0\\lib\\jaxb-\nlibs.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jaxp-1.2.2\\lib\\jaxb-\napi.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jaxp-1.2.2\\lib\\endorsed\\xe\nrcesImpl.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jaxp-1.2.2\n\\lib\\endorsed\\xalan.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jaxp-1.2.2\n\\lib\\endorsed\\sax.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jaxp-1.2.2\n\\lib\\endorsed\\dom.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jwsdp-\nshared\\lib\\jax-qname.jar;C:\\Program Files\\j2sdk1.4.0\\lib\\jwsdp-1.1\\jwsdp-\nshared\\lib\\namespace.jar;.\nException in thread \"main\" java.lang.NoClassDefFoundError: FILES\\j2sdk1/4/0\n\\lib\\tools/jar;C:\\Program\n\nBut when I made the changes I've suggested before, it worked fine. I didn't \nchange the ant.bat previous to that. I just thought I'd send this bug in for \nthose who might be experiencing the same problem. Thanks!"}, {"count": 3, "attachment_id": null, "creator": "ddevienne@lgc.com", "is_private": false, "id": 35015, "time": "2003-04-11T19:02:40Z", "bug_id": 18935, "creation_time": "2003-04-11T19:02:40Z", "tags": [], "text": "You should not have a classpath that long in the first place. JWSDP has \nClassPath: sets in its main JARs. I have *nothing* in my classpath, and \neverything's peachy for me. Always set the classpath within Ant is my motto. --\nDD"}, {"count": 4, "tags": [], "bug_id": 18935, "text": "Okay ... but clearly from the output below, ant.bat inadvertently added quotes \nto the local classpath, which wasn't there before. And it doesn't explain why \nit didn't work before, and worked after the change I've made (despite the long \nclasspath). \n\nBut thanks for the tip. I'll do that. ", "id": 35016, "time": "2003-04-11T19:08:37Z", "creator": "jvb@andrew.cmu.edu", "creation_time": "2003-04-11T19:08:37Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "text": "Can you have a download of the ant1.5.3 distribution from ant.apache.org and see\nif it makes the problem go away. \n\nOne thing that scares me about this config is that it is the SUN supplied\ndistro, and we dont know what they did to their batch file -though clearly it\nhas a bug, as the quotes are going in wrongly. The whole classpath should be\nquoted, not some of the individual libs. ", "is_private": false, "bug_id": 18935, "id": 35043, "time": "2003-04-11T23:35:33Z", "creator": "stevel@apache.org", "creation_time": "2003-04-11T23:35:33Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 18935, "text": "It seems that you have a customised ant.bat. The snippet\n    -Djwsdp.home=\"%ANT_HOME%\\..\"\nis not part of the standard Ant distribution. Nevertheless, there were bugs in\nthe 1.5.1 ant.bat relating to spaces, quotes, and all the other pain here.\n\nYou can either stick with your changes (since they work) or try to sync up with\nthe 1.5.3 changes. In either case, I believe this is now working OK in the\nstandard Ant distribution.", "id": 35101, "time": "2003-04-14T11:37:34Z", "creator": "conor@apache.org", "creation_time": "2003-04-14T11:37:34Z", "is_private": false, "attachment_id": null}]