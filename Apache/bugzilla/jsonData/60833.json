[{"count": 0, "tags": [], "bug_id": 60833, "text": "Created attachment 34808\nthis is a report table received from email.", "id": 197523, "attachment_id": 34808, "creator": "yoker.wu@gmail.com", "creation_time": "2017-03-08T07:58:57Z", "time": "2017-03-08T07:58:57Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 60833, "text": "Thanks for the bug report and including the problematic file.\n\nBefore I spend time researching this, it would help us if you could answer a few questions.\n\nI'm assuming you get an exception (what exception class?) with the message \"Initialisation of record 0x31 left 4 bytes remaining still to be read\" when you open the workbook with\n> Workbook wb = WorkbookFactory.create(new File(\"buzhengc.xls\"));\nIf not, please include a stack trace and sample code so that we can reproduce the problem.\n\nWhat version of POI are you using?\n\nIs there anything written to stderr or the POILogger, that would suggest why we were 4 bytes short?\n\nDoes this file open without any errors in Microsoft Excel or other spreadsheet application? If so, what version?\n\nThanks in advance for the info.", "id": 197527, "time": "2017-03-08T09:21:45Z", "creator": "onealj@apache.org", "creation_time": "2017-03-08T09:21:45Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 60833, "text": "FYI, Bug 57093 sounds similar.", "id": 197540, "time": "2017-03-08T14:08:03Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2017-03-08T14:08:03Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "yoker.wu@gmail.com", "text": "@Javen O'Neal \n\nthis file can open without any errors in Microsoft Excel or WPS application.\n\ni tested on poi-3.15.jar.\n\nthis is my code.\n\npublic static void main(String[] args) throws Exception{\n\t\n\tString fileName = \"F:\\\\Desktop\\\\buzhengc.xls\";\n\n\tInputStream inputStream = new FileInputStream(fileName);\n\t\n\tPOIFSFileSystem fs = new POIFSFileSystem(inputStream);\n    \n\tDirectoryEntry root = fs.getRoot();\n\tSystem.out.println(root.getEntryNames());\n\t\n\tHSSFWorkbook hssfworkbook = new HSSFWorkbook(fs);\n\tSystem.out.println(hssfworkbook.getNameName(0));\n\t\n}\n\n\ni got this errors:\n\n[Workbook]\nException in thread \"main\" org.apache.poi.hssf.record.RecordInputStream$LeftoverDataException: Initialisation of record 0x31(FontRecord) left 4 bytes remaining still to be read.\n\tat org.apache.poi.hssf.record.RecordInputStream.hasNextRecord(RecordInputStream.java:174)\n\tat org.apache.poi.hssf.record.RecordFactoryInputStream.nextRecord(RecordFactoryInputStream.java:253)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:494)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:341)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:304)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:251)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:221)\n\tat com.test.pppp.main(test.java:26)", "id": 197555, "time": "2017-03-09T01:07:11Z", "bug_id": 60833, "creation_time": "2017-03-09T01:07:11Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 60833, "attachment_id": 34812, "id": 197564, "time": "2017-03-09T10:43:23Z", "creator": "yoker.wu@gmail.com", "creation_time": "2017-03-09T10:43:23Z", "is_private": false, "text": "Created attachment 34812\nThe Excel BIFF output file created by BIFFVIEW.exe\n\nI found another problem.\n\nthere is a WINDOW2 record before at ROW record."}, {"count": 5, "tags": [], "creator": "linckham@qq.com", "text": "I have the same exception when reading xls file\nthe stack trace \norg.apache.poi.hssf.record.RecordInputStream$LeftoverDataException: Initialisation of record 0x31(FontRecord) left 4 bytes remaining still to be read.\n\tat org.apache.poi.hssf.record.RecordInputStream.hasNextRecord(RecordInputStream.java:177) ~[poi-3.16.jar:3.16]\n\tat org.apache.poi.hssf.record.RecordFactoryInputStream.nextRecord(RecordFactoryInputStream.java:234) ~[poi-3.16.jar:3.16]\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:494) ~[poi-3.16.jar:3.16]\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:348) ~[poi-3.16.jar:3.16]\n\tat org.apache.poi.ss.usermodel.WorkbookFactory.create(WorkbookFactory.java:99) ~[poi-ooxml-3.16.jar:3.16]\n\tat org.apache.poi.ss.usermodel.WorkbookFactory.create(WorkbookFactory.java:182) ~[poi-ooxml-3.16.jar:3.16]\n\tat org.apache.poi.ss.usermodel.WorkbookFactory.create(WorkbookFactory.java:144) ~[poi-ooxml-3.16.jar:3.16]", "id": 198673, "time": "2017-05-05T01:48:59Z", "bug_id": 60833, "creation_time": "2017-05-05T01:48:59Z", "is_private": false, "attachment_id": null}, {"count": 6, "attachment_id": null, "bug_id": 60833, "text": "There is no problem opening the file using Microsoft Excel on Mac operating system", "id": 198674, "time": "2017-05-05T01:55:34Z", "creator": "linckham@qq.com", "creation_time": "2017-05-05T01:55:34Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "bug_id": 60833, "text": "(In reply to lintongchuan from comment #5)\n> I have the same exception when reading xls file\n> the stack trace \n> org.apache.poi.hssf.record.RecordInputStream$LeftoverDataException:\n> Initialisation of record 0x31(FontRecord) left 4 bytes remaining still to be\n> read.\n> \tat\n> org.apache.poi.hssf.record.RecordInputStream.hasNextRecord(RecordInputStream.\n> java:177) ~[poi-3.16.jar:3.16]\n> \tat\n> org.apache.poi.hssf.record.RecordFactoryInputStream.\n> nextRecord(RecordFactoryInputStream.java:234) ~[poi-3.16.jar:3.16]\n> \tat\n> org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:\n> 494) ~[poi-3.16.jar:3.16]\n> \tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:348)\n> ~[poi-3.16.jar:3.16]\n> \tat\n> org.apache.poi.ss.usermodel.WorkbookFactory.create(WorkbookFactory.java:99)\n> ~[poi-ooxml-3.16.jar:3.16]\n> \tat\n> org.apache.poi.ss.usermodel.WorkbookFactory.create(WorkbookFactory.java:182)\n> ~[poi-ooxml-3.16.jar:3.16]\n> \tat\n> org.apache.poi.ss.usermodel.WorkbookFactory.create(WorkbookFactory.java:144)\n> ~[poi-ooxml-3.16.jar:3.16]\n\nThere is no problem opening the file using Microsoft Excel on Mac operating system,\nwhen I open the excel file using Microsoft Excel , then save it as another file, another file can be correctly read and process.", "id": 198675, "time": "2017-05-05T02:11:17Z", "creator": "linckham@qq.com", "creation_time": "2017-05-05T02:11:17Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 60833, "text": "We have 15 stacktraces like this in our regression corpus for Tika.  I was hoping from the file attached here (first) and the file attached on Bug 57093 (second), that the first byte or two specified a length somehow.\n\nHowever, from govdocs1 085890.xls (third), it looks like junk at the end of the font record.  By junk, of course, I mean, \"I don't understand why it's there\"...like junk DNA. :)  But seriously, in 085890.xls, when I open the file in Excel and search for \"providing\", I don't find anything.\n\nFirst line is font name : length\nRemaining lines are: byte index : byte&0xff : char (if above 20)\n\nFONT NAME:\u9ed1\u4f53 : 2\n0 : 0 :  \n1 : 0 :  \n2 : 0 :  \n3 : 0 : \n\nFONT NAME:MS Sans Serif : 13\n0 : 19 :  \n1 : 0 :  \n2 : 1 :  \n3 : 0 :  \n4 : 0 :  \n5 : 88 : X\n6 : 1 :  \n7 : 0 :  \n8 : 0 :  \n9 : 89 : Y\n10 : 95 : _\n11 : 41 : )\n12 : 63 : ?\n13 : 95 : _\n14 : 41 : )\n15 : 59 : ;\n16 : 95 : _\n17 : 40 : (\n18 : 64 : @\n19 : 95 : _\n20 : 41 : )\n21 : 0 :  \n\nFONT NAME:MS Sans Serif : 13\n0 : 116 : t\n1 : 129 :  \n2 : 84 : T\n3 : 73 : I\n4 : 84 : T\n5 : 85 : U\n6 : 84 : T\n7 : 73 : I\n8 : 79 : O\n9 : 78 : N\n10 : 95 : _\n11 : 80 : P\n12 : 82 : R\n13 : 79 : O\n14 : 86 : V\n15 : 73 : I\n16 : 68 : D\n17 : 73 : I\n18 : 78 : N\n19 : 71 : G\n20 : 95 : _\n21 : 68 : D\n22 : 65 : A\n23 : 84 : T\n24 : 65 : A\n25 : 95 : _\n26 : 73 : I\n27 : 68 : D\n28 : 10 :  \n29 : 0 :  \n30 : 0 :  \n31 : 67 : C\n32 : 79 : O\n33 : 78 : N\n34 : 84 : T\n35 : 65 : A\n36 : 67 : C\n37 : 84 : T\n38 : 95 : _\n39 : 73 : I\n40 : 68 : D\n41 : 20 :", "id": 198692, "time": "2017-05-05T11:29:00Z", "creator": "tallison@mitre.org", "creation_time": "2017-05-05T11:29:00Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "text": "Whoa... and govdocs1/093/093996.xls has seven font records with an extra 1918 bytes!\n\nNo intelligible text (on a quick look)...\n\nFONT NAME:MS Sans Serif : 13\n0 : 149 :  \n1 : 129 :  \n2 : 95 : _\n3 : 41 : )\n4 : 59 : ;\n5 : 95 : _\n...\n1893 : 0 :  \n1894 : 115 : s\n1895 : 142 :  \n1896 : 78 : N\n1897 : 0 :  \n1898 : 75 : K\n1899 : 161 :  \n1900 : 78 : N\n1901 : 0 :  \n1902 : 3 :  \n1903 : 180 :  \n1904 : 78 : N\n1905 : 0 :  \n1906 : 227 :  \n1907 : 198 :  \n1908 : 78 : N\n1909 : 0 :  \n1910 : 145 :  \n1911 : 214 :  \n1912 : 78 : N\n1913 : 0 :  \n1914 : 48 : 0\n1915 : 65 : A\n1916 : 85 : U\n1917 : 8 :", "attachment_id": null, "bug_id": 60833, "id": 198693, "time": "2017-05-05T11:39:41Z", "creator": "tallison@mitre.org", "creation_time": "2017-05-05T11:39:41Z", "is_private": false}, {"count": 10, "text": "Stats from our regression corpus on which Excel records cause LeftoverDataExceptions (Record \\t number of exceptions).\n\n0x850(ChartFRTInfoRecord) \t763  (Bug 47247)\n0x85(BoundSheetRecord) \t95\n0x1D(SelectionRecord) \t35\n0x31(FontRecord) \t15\n0x203(NumberRecord) \t8\n0x42(CodepageRecord) \t5\n0x3C(ContinueRecord) \t2\n0x868(FeatRecord) \t2\n0x5B(FileSharingRecord) \t1\n0x5F(SaveRecalcRecord) \t1\n0xE(PrecisionRecord) \t1", "bug_id": 60833, "attachment_id": null, "id": 198694, "time": "2017-05-05T12:47:34Z", "creator": "tallison@mitre.org", "creation_time": "2017-05-05T12:47:34Z", "tags": [], "is_private": false}]