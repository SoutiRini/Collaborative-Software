[{"count": 0, "tags": [], "creator": "alex2grad@gmail.com", "is_private": false, "text": "Created attachment 34388\nThe patch which fixes segfault in ap_fcgi_encoded_env_len/ap_fcgi_encode_env\n\nIf the value of environment variable is NULL then the next code in the function ap_fcgi_encoded_env_len causes segfault\n----\nvallen = strlen(elts[i].val);\n----\n\nThe AUTHENTICATE_* environment variables could be NULL\nif the a SQL query returns NULL values.\n\nAttached patch fixes this issue.\n\nThe backtrace\n=============\nProgram received signal SIGSEGV, Segmentation fault.\n[Switching to Thread 0x7f0649d04710 (LWP 12340)]\n0x00007f0650bc09a2 in strlen () from /lib64/libc.so.6\n(gdb) bt\n#0  0x00007f0650bc09a2 in strlen () from /lib64/libc.so.6\n#1  0x00007f0653391530 in ap_fcgi_encoded_env_len ()\n#2  0x00007f064ce4b88d in ?? () from /opt/lib/httpd/modules/mod_proxy_fcgi.so\n#3  0x00007f064d25c732 in proxy_run_scheme_handler () from /opt/lib/httpd/modules/mod_proxy.so\n#4  0x00007f064d261863 in ?? () from /opt/lib/httpd/modules/mod_proxy.so\n#5  0x00007f0653388cc0 in ap_run_handler ()\n#6  0x00007f065338d11e in ap_invoke_handler ()\n#7  0x00007f06533a145a in ap_process_async_request ()\n#8  0x00007f065339d561 in ?? ()\n#9  0x00007f06533941f0 in ap_run_process_connection ()\n#10 0x00007f064c36e485 in ?? () from /opt/lib/httpd/modules/mod_mpm_event.so\n#11 0x00007f06510be980 in start_thread () from /lib64/libpthread.so.0\n#12 0x00007f0650c23b3d in clone () from /lib64/libc.so.6\n=============", "id": 194529, "time": "2016-10-18T22:02:07Z", "bug_id": 60275, "creation_time": "2016-10-18T22:02:07Z", "attachment_id": 34388}, {"count": 1, "tags": [], "creator": "covener@gmail.com", "is_private": false, "id": 195590, "attachment_id": null, "bug_id": 60275, "creation_time": "2016-12-21T16:13:55Z", "time": "2016-12-21T16:13:55Z", "text": "Thanks Alex, do you know if these are safe to be put in the environment passed down to the FCGI?  Curious if you've seen them listed out on the other side safely after the patch."}, {"count": 2, "tags": [], "creator": "covener@gmail.com", "is_private": false, "id": 195591, "attachment_id": null, "bug_id": 60275, "creation_time": "2016-12-21T16:19:59Z", "time": "2016-12-21T16:19:59Z", "text": "commited with cosmetic changes to trunk and will propose for backport"}, {"count": 3, "tags": [], "creator": "alex2grad@gmail.com", "attachment_id": null, "is_private": false, "id": 195593, "time": "2016-12-21T16:33:06Z", "bug_id": 60275, "creation_time": "2016-12-21T16:33:06Z", "text": "(In reply to Eric Covener from comment #1)\n> Thanks Alex, do you know if these are safe to be put in the environment\n> passed down to the FCGI?  Curious if you've seen them listed out on the\n> other side safely after the patch.\n\nI use the $_SERVER[\"AUTHENTICATE_*\"] variables in PHP-FPM.\nThis patch resolved the issue."}]