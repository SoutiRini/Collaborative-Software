[{"attachment_id": null, "tags": [], "bug_id": 46235, "is_private": false, "count": 0, "id": 122609, "time": "2008-11-18T17:08:43Z", "creator": "yesj@nttdatabj.com.cn", "creation_time": "2008-11-18T17:08:43Z", "text": "Hello, \n\nwith the version 3.1.0 of POI I can do this code : \n\n ByteArrayInputStream  instream_ = null; \n        POIFSFileSystem fs = null;       \n        POIManagerFactory managerFactory = null;\n        \n        try {\n            workbook = null;\n\n            instream_ = new ByteArrayInputStream(_byteFile);\n\n           fs = new POIFSFileSystem(instream_);  \n\n            workbook = new HSSFWorkbook(fs);  \n\n            instream_.close();\n            instream_ = null;\n            fs = null;\n      \u3000} catch (Exception e) {\n            throw new SystemException(e.getMessage(), e);\n        }\n\n\nHowever, when I want to open the attachment file, exception occurred,\nother file  is possible .\nworkbook = new HSSFWorkbook(fs);  \n// Exception with 3.1 no probleme with 2.5\n\nI use for POI 3.1 : \n\npoi-3.1-FINAL-20080629.jar\npoi-contrib-3.1-FINAL-20080629.jar\npoi-scratchpad-3.1-FINAL-20080629.jar\n\nThe Exception is : \n\nCaused by: org.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n at org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:208)\n at org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:126)\n at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:246)\n at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:169)\n at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:151)\n at jp.co.nttdata_chugoku.sprist.scm.common.comservice.POIManagerImpl.getHSSFWorkbook(POIManagerImpl.java:53)\n at jp.co.nttdata_chugoku.sprist.scm.common.comservice.MakeExcelCom.<init>(MakeExcelCom.java:150)\n ... 59 more\nCaused by: java.lang.reflect.InvocationTargetException\n at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n at java.lang.reflect.Constructor.newInstance(Constructor.java:274)\n at org.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:196)\n ... 65 more\nCaused by: org.apache.poi.hssf.record.RecordFormatException: Expected continue record.\n at org.apache.poi.hssf.record.UnicodeString.fillFields(UnicodeString.java:236)\n at org.apache.poi.hssf.record.UnicodeString.<init>(UnicodeString.java:115)\n at org.apache.poi.hssf.record.SSTDeserializer.manufactureStrings(SSTDeserializer.java:49)\n at org.apache.poi.hssf.record.SSTRecord.fillFields(SSTRecord.java:364)\n at org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n at org.apache.poi.hssf.record.SSTRecord.<init>(SSTRecord.java:101)\n\nNB : the file that I open is on my station.\n\nSincerely"}, {"count": 1, "tags": [], "text": "There have been some recent changes/fixes in ContinueRecord processing.  Try with POI 3.2\n\nIf the problem is still present, please re-open this bugzilla and upload a sample workbook which causes the error.", "attachment_id": null, "id": 122611, "creator": "josh@apache.org", "time": "2008-11-18T18:24:07Z", "bug_id": 46235, "creation_time": "2008-11-18T18:24:07Z", "is_private": false}, {"count": 2, "tags": [], "creator": "yesj@nttdatabj.com.cn", "attachment_id": 22890, "id": 122613, "time": "2008-11-18T19:21:22Z", "bug_id": 46235, "creation_time": "2008-11-18T19:21:22Z", "is_private": false, "text": "Created attachment 22890\nsample workbook which causes the error \n\nwhere I use poi3.2,the problem is still present, I have uploaded a\nsample workbook which causes the error at this bugzilla.\n\nSincerely"}]