[{"attachment_id": null, "tags": [], "bug_id": 13427, "is_private": false, "count": 0, "id": 24161, "time": "2002-10-08T23:04:31Z", "creator": "gaa@ulticom.com", "creation_time": "2002-10-08T23:04:31Z", "text": "I have attempted to build the LDAP enabled Apache 2.0.43 on Solaris 9 using\nOpenLDAP 2.0.7 (from Sunfreeware.com).  The Solaris compiles require\none to link LDAP with \"... -lldap -llber -lsocket -lnsl -lresolv ...\".\nThe attempted LDAP lookups in srclib/apr-util/configure don't include\nthis.\n\nAttempts to specify something on the command line like:\n    ../configure --with-ldap=\"ldap, \\\"-llber -lsocket\\\"...\"\nwill never work as the variable set by the script is different from the variable\nused.\n\nAttempts to fix the script to try more possibilities fails because the\nattempts are performed in a loop with a cache variable set and tested\neach time that is based purly upon the library name, not using the extralibs\nnames.  This causes second and subsequent tests to never be run.  It looks\nlike someone tried to unset the cache variable, but the name unset does not\nmatch the name set.  I don't know if the \"''\" in the middle of the name is\na bug in this package, a bug in autoconf, or \"planned\", but it gets translated\nto two extra \"_\" characters.  The sure fix is to unset both.\n\nThe fix: make these changes to build/apu-conf.m4 and rebuild configure:\n\ndiff -u -r1.1.1.1 apu-conf.m4\n--- build/apu-conf.m4   8 Oct 2002 21:38:11 -0000       1.1.1.1\n+++ build/apu-conf.m4   8 Oct 2002 22:38:52 -0000\n@@ -651,6 +651,7 @@\n     ldaplib=$1\n     extralib=$2\n     unset ac_cv_lib_${ldaplib}_ldap_init\n+    unset ac_cv_lib_${ldaplib}___ldap_init\n     AC_CHECK_LIB(${ldaplib}, ldap_init, \n       [\n         APR_ADDTO(APRUTIL_EXPORT_LIBS,[-l${ldaplib} ${extralib}])\n@@ -699,9 +700,13 @@\n       APU_FIND_LDAPLIB(\"ldapssl20\")\n       APU_FIND_LDAPLIB(\"ldap\", \"-llber\")\n       APU_FIND_LDAPLIB(\"ldap\", \"-llber -lresolv\")\n+      APU_FIND_LDAPLIB(\"ldap\", \"-llber -lsocket -lnsl -lresolv\")\n       APU_FIND_LDAPLIB(\"ldap\", \"-ldl -lpthread\")\n     else\n-      APU_FIND_LDAPLIB($LDAPLIB)\n+      APU_FIND_LDAPLIB($LIBLDAP)\n+      APU_FIND_LDAPLIB($LIBLDAP, \"-lresolv\")\n+      APU_FIND_LDAPLIB($LIBLDAP, \"-lsocket -lnsl -lresolv\")\n+      APU_FIND_LDAPLIB($LIBLDAP, \"-ldl -lpthread\")\n     fi\n \n     test ${apu_has_ldap} != \"define\" && AC_MSG_ERROR(could not find an LDAP\nlibrary)"}, {"count": 1, "tags": [], "creator": "jrd@cc.usu.edu", "attachment_id": 3762, "text": "Created attachment 3762\nSimilar failures on FreeBSD, likely related. Openldap in use.", "id": 25831, "time": "2002-11-06T23:25:18Z", "bug_id": 13427, "creation_time": "2002-11-06T23:25:18Z", "is_private": false}, {"count": 2, "tags": [], "creator": "minfrin@sharp.fm", "is_private": false, "text": "Patch has been applied to APR v0.9.2.\n\nIf this problem still persists, please reopen this bug.\n", "id": 29782, "time": "2003-01-21T14:28:56Z", "bug_id": 13427, "creation_time": "2003-01-21T14:28:56Z", "attachment_id": null}]