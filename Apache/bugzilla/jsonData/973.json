[{"count": 0, "tags": [], "creator": "cgay@vsegroup.com", "text": "I am using Ant's <java> task to generate EJB stubs and skeletons via the JOnAS \ncontainer's GenIC tool.  When using the nested <arg> and <classpath> elements I \nam unable to get Ant to work.  \n\nIt appears that 2 problems occur:\n1. When I specify more than one argument for the invoked class (i.e. \"-d\n   ${build.classes} ${conf}/vit2.xml\") as a single <arg> element or individual\n   <arg> elements, I receive a classpath error claiming it cannot find the\n   file \"-d c:\\projects\\belo\\velocit2\\build\\classes \nc:\\projects\\belo\\velocit\\confvit2.xml\".\n2. If I did not specify a destination directory for GenIC using the -d option \n(so I provided only <arg value=\"${conf}/vit2.xml\"/>), then it will find the xml \nfile, but then fail later on in the generation process due to a classpath issue \nwhen it cannot find some of the generated stubs.  Using the -verbose option for \nGenIC, I've noticed that it dies when using the rmic tool.  So it appears the \nclasspath is not passed to GenIC in a way that it can pass it internally.  This \nappears to be a problem with the <classpath> element.\n\nI can invoke from the command line successfully as follows:\nC:\\>java -cp c:\\projects\\belo\\velocit2\n\\build\\classes;c:\\projects\\vse\\libs\\RMI_jonas.jar \norg.objectweb.jonas_ejb.tools.GenIC -d c:\\projects\\belo\\velocit2\\build\\classes \nc:\\projects\\belo\\velocit2\\conf\\vit2.xml\n\nSimilarly, I can successfully use the following Ant task:\n<target name=\"stubs-all\">\n    <!-- Create the stubs and skeletons -->\n    <java fork=\"yes\" classname=\"org.objectweb.jonas_ejb.tools.GenIC\" \n    taskname=\"jonas\" failonerror=\"true\" \n    args=\"-d ${build.classes} ${conf}/vit2.xml\"\n    classpath=\"${build.classes};${vse.lib}/RMI_jonas.jar\"/>\n</target>\n\nHowever, the following Ant task fails in mid generation of the stubs due to a \nclasspath problem:\n<target name=\"stubs-all\">\n    <!-- Create the stubs and skeletons -->\n    <java fork=\"yes\" classname=\"org.objectweb.jonas_ejb.tools.GenIC\" \n    taskname=\"jonas\" failonerror=\"true\">\n        <classpath>\n            <pathelement path=\"${build.classes}\"/>\n            <pathelement path=\"${vse.lib}/RMI_jonas.jar\"/>\n        </classpath>\n        <arg value=\"-d ${build.classes} ${conf}/vit2.xml\"/>\n    </java>\n</target>\n\nPlease keep in mind that I tried every variation I could think of: seperate arg \nelements, not specifying a -d option for GenIC, setting the classpath via the \njava -D option, using the sysproperty element, etc.  In short, I spent 9 hours \non this, and have checked everything I can find on Ant or JOnAS.  I am \nreasonably sure this is an Ant problem, though it is possible it is an internal \nGenIC/JOnAS issue, so I will also submit this bug report to the latter.\n\nAssumptions:\n1. All the EJB descriptor and container xml files are in the conf directory.\n2. The following is set up within the build xml file \"velocit2_build.xml\":\n   <project name=\"velocit2\" default=\"all\" basedir=\"c:/projects/belo\">\n      <property name=\"build\" value=\"${basedir}/${ant.project.name}/build\" />\n      <property name=\"build.classes\" value=\"${build}/classes\" />\n      <property name=\"conf\" value=\"${basedir}/${ant.project.name}/conf\" />\n3. I am only using the JOnAS RMI_jonas.jar file, and have no other vestiges of\n   the container on my system - not even an environment variable. I do not use\n   any of its property files or scripts.\n4. My Ant start script is unmodified.\n5. I invoke my buildfile as follows\"\n   c:\\> ant -buildfile velocit2_build.xml c:\\projects\\belo\\velocit2\n\\conf\\vit2.xml\n6. My environment is as follows:\n   JDK:   1.3\n   JOnAS: 2.2.7\n   OS:    Win2000\n   Ant:   1.3", "id": 1262, "time": "2001-03-14T08:03:36Z", "bug_id": 973, "creation_time": "2001-03-14T08:03:36Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 973, "attachment_id": null, "text": "Fixed in CVS and nightly build 2001-03-17.", "id": 1315, "time": "2001-03-16T04:56:55Z", "creator": "bodewig@apache.org", "creation_time": "2001-03-16T04:56:55Z", "is_private": false}, {"count": 2, "tags": [], "creator": "bodewig@apache.org", "text": "sorry, my last comment (fixed) doesn't apply to this report", "id": 1318, "time": "2001-03-16T05:05:02Z", "bug_id": 973, "creation_time": "2001-03-16T05:05:02Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 973, "text": "Does this problem still exist? \n\nCan you try \n\n<java fork=\"yes\" classname=\"org.objectweb.jonas_ejb.tools.GenIC\" \n      taskname=\"jonas\" failonerror=\"true\">\n  <classpath>\n    <pathelement path=\"${build.classes}\"/>\n    <pathelement path=\"${vse.lib}/RMI_jonas.jar\"/>\n  </classpath>\n  <arg value=\"-d\"/>\n  <arg value=\"${build.classes}\"/>\n  <arg value=\"${conf}/vit2.xml\"/>\n</java>\n\nor \n\n<java fork=\"yes\" classname=\"org.objectweb.jonas_ejb.tools.GenIC\" \n      taskname=\"jonas\" failonerror=\"true\">\n  <classpath>\n    <pathelement path=\"${build.classes}\"/>\n    <pathelement path=\"${vse.lib}/RMI_jonas.jar\"/>\n  </classpath>\n  <arg line=\"-d ${build.classes} ${conf}/vit2.xml\"/>\n</java>\n", "count": 3, "id": 1626, "time": "2001-03-28T00:47:02Z", "creator": "nico@apache.org", "creation_time": "2001-03-28T00:47:02Z", "is_private": false}, {"count": 4, "tags": [], "creator": "max@webwizarddesign.com", "text": "I am experiencing this as well ... I tried all solutions listed .. none of them\nwork for us ... even with the <classpath> and <arg> elements ... for us the\nproblem manifests itself when a class tries to use the ClassLoader to find\na file on the class path .. this consistently fails from the script, but works\nfrom the command line ...", "id": 1754, "time": "2001-04-05T10:00:04Z", "bug_id": 973, "creation_time": "2001-04-05T10:00:04Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "conor@apache.org", "attachment_id": null, "id": 3527, "time": "2001-07-09T21:43:55Z", "bug_id": 973, "creation_time": "2001-07-09T21:43:55Z", "is_private": false, "text": "As Nico has suggested, I believe the problem may be due to the use of the \n<arg value=\"...\"/> construct as opposed to <arg line=\"...\"/>. Therefore I am \ngoing to close this bug. If you believe there is still an issue, please run ant \nwith the -debug flag to see what java command it is executing. If that doesn't \nmake what is happening clear, please repoen this bug, or a new one. Thanks"}]