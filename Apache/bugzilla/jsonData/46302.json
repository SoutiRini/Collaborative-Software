[{"count": 0, "tags": [], "bug_id": 46302, "attachment_id": null, "text": "CloneStyleFrom should only throw an exception if the passed in style is not HSSFCellStyle.\n\n\nNote that there is also an issue with XSSFCellStyle cloneStyleFrom - it appears to call itself indefinitely when the input is of XSSFCellStyle.", "id": 122883, "time": "2008-11-26T15:12:05Z", "creator": "patrick.radtke@vistaprojects.com", "creation_time": "2008-11-26T15:12:05Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 46302, "text": "Created attachment 22956\nPatch that should solve a bug related to the cloneStyleFrom method of XSSFCellStyle class (and HSSFCellStyle as well)\n\nI'm not so familiar with open source developing, so I don't know if this is the right way to proceed. If not, please excuse me. \nI came across a bug in XSSFCellStyle and consequently, in this bug. Probably I managed how to solve both (a first look at the generated xlsx seems to confirm that I was able to clone the style). You can find the changes I made to the sources in the attached patch. In XSSFCellStyle.java I tried to use the style used in HSSFCellStyle.java. I'm not sure it's an efficient, elegant or complete solution but I hope this can help.\n\nRegards, \n\nLorenzo Benvenuti", "id": 122891, "time": "2008-11-27T01:06:27Z", "creator": "lorenzo.benvenuti@yahoo.com", "creation_time": "2008-11-27T01:06:27Z", "is_private": false, "attachment_id": 22956}, {"count": 2, "tags": [], "creator": "patrick.radtke@vistaprojects.com", "attachment_id": null, "id": 122895, "time": "2008-11-27T07:59:49Z", "bug_id": 46302, "creation_time": "2008-11-27T07:59:49Z", "is_private": false, "text": "Lorenzo,\n\nThe only issue I see with the patch is for the XSSFCellStyle cloneStyleFrom() method. There is only a single cloneStyleFrom method in XSSFCellStyle (while HSSFCellStyle has two), therefor the XSSFCellStyle cloneStyleFrom method will call itself recursively and never return (while in HSSFCellStyle one of the methods calls the other)\n\n"}, {"count": 3, "tags": [], "creator": "patrick.radtke@vistaprojects.com", "attachment_id": null, "id": 122897, "time": "2008-11-27T08:08:30Z", "bug_id": 46302, "creation_time": "2008-11-27T08:08:30Z", "is_private": false, "text": "Lorenzo,\n\nMy apologies. I didn't scroll down all the way on your patch. I see that you have included the second cloneStyleFrom method.\n\nDo we need to set some of the other style variables like cellStyleXf?\n\n"}, {"count": 4, "tags": [], "bug_id": 46302, "attachment_id": null, "text": "Patrick,\n\nactually I'm not sure that the \"state\" of the XSSFCellStyle is fully determined by the cellXf property. I just took a look at the copy() method and I thought the style representation was fully delegated to the cellXf bean while the other properties were just cellStyle \"control\" variables already set in the costructor when the current style (the one that is going to clone the source style) is created.\nPlease notice I might be wrong, probably the author of the XSSFCellStyle class would be helpful here.\nRegarding the methods calling itself indefinitely, as you may have guessed, I used the overloaded method to mirror the HSSFCellStyle class implementation of the cloneStyleFrom method.\nAt last: I think the \"return\" clauses I added are necessary for avoiding the exception to be always thrown; actually I don't like using a \"return\" in the middle of a class (in this case I could have changed the \"if\" condition) but this was the less invasive change.\n\nHope this helps!\n\nLorenzo\n\n", "id": 122901, "time": "2008-11-27T23:24:24Z", "creator": "lorenzo.benvenuti@yahoo.com", "creation_time": "2008-11-27T23:24:24Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 46302, "attachment_id": null, "text": "Should be fixed in r766755\n\nYegor\n\n*** This bug has been marked as a duplicate of bug 47054 ***", "id": 126394, "time": "2009-04-20T10:32:08Z", "creator": "yegor@dinom.ru", "creation_time": "2009-04-20T10:32:08Z", "is_private": false}]