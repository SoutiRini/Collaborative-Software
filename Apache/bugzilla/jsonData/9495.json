[{"count": 0, "tags": [], "bug_id": 9495, "is_private": false, "id": 16878, "creation_time": "2002-05-29T15:35:03Z", "time": "2002-05-29T15:35:03Z", "creator": "garoper@arantech.com", "text": "The error is that not all of the characters in an element are being stored in \nthe mContent stringbuffer in the characters method e.g. a method coded like \nthis:\n\npublic void characters(char[] chars, int start, int len)  \n                                       throws SAXException {\n\t    mContent.append( chars, start, len );\n            if ( mContent==null ) {\n                // Validation takes care of that except for spaces. Discard.\n                return;\n            } \n}\n\nThe error occurs inconsistently but predominately in large XML files. \n\nTo avoid this error for a description element e.g. <description>What a great \ndescription</description>: \n\n1. declare a member variable to collect all of the description's characters and \none to store the current element's name at the beginning of the DefaultHandler\n\tprotected String mCurrentDescription = null;\n\tprotected String mCurrentElementName = null;\n\n2. add the following code to startElement()\n\t   if ( localName != null && localName.length() > 0 ) {\n\t\t    mCurrentElementName = localName;\n\t    } else if( qName != null && qName.length() > 0 ) {\n\t\t    mCurrentElementName = qName;\n\t    }\n\t    if( mCurrentElementName == null ) {\n\t\t     trace.error( \"startElement() no element to handle\" );\n\t\t     return;\n\t    }\n\t    if ( \"description\".equals( mCurrentElementName ) ){\n\t\t    mCurrentDescription = null;\n\t    }\n\n3. change the characters() to:\npublic void characters(char[] chars,\n                               int start, int len)  throws SAXException\n        {\n            String charsToAdd = new String( chars, start, len );\n\t    \n\t    if ( mCurrentElementName.equals( \"description\" ) ) {\n\t\t    if ( mCurrentDescription == null ){\n\t\t\t    mCurrentDescription = charsToAdd;\n\t\t    } else {\n\t\t\t    mCurrentDescription += charsToAdd;\n\t\t    }\n\t    } \n        }\n\n4. reinitialize mCurrentDescription to null in the endElement method.", "attachment_id": null}]