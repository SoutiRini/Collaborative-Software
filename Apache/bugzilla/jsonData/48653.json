[{"count": 0, "tags": [], "bug_id": 48653, "text": "Created attachment 24915\nTomcat 7 patch with many unit tests, updated docs and few additional jmx attributes fixes \n\nWhen X-Forwarded-Proto=\"http\", the incoming request attributes secure, scheme\nand serverPort are not overridden as they are with \"https\". \n\nIf a request came as unsecured/http but the communication between apache and\ntomcat is ssl, then request.isSecure(), request.getScheme() and\nrequest.getServerPort() are wrong. \n\nProposed patch :\n\n* introduce a httpServerPort configuration parameter\n* modify logic for request.isSecure(), request.getScheme() , and\nrequest.getServerPort() :\n** if header \"x-forwarded-proto\" is null then keep incoming values\n** else if header \"x-forwarded-proto\" is equal to \"https\" then override values\nto true, https and 443\n** else override values to false, http and 80\n\n\nNote :\n\n* \"x-forwarded-proto\", 80, 443 and \"https\" (as the ssl value for\nx-forwarded-proto header) are configurable ; I use sample values in the bug\ndescription to make it easier to understand.", "id": 134108, "time": "2010-02-01T09:26:02Z", "creator": "cyrille.leclerc@pobox.com", "creation_time": "2010-02-01T09:26:02Z", "is_private": false, "attachment_id": 24915}, {"count": 1, "tags": [], "bug_id": 48653, "attachment_id": null, "id": 134136, "time": "2010-02-02T05:32:02Z", "creator": "markt@apache.org", "creation_time": "2010-02-02T05:32:02Z", "is_private": false, "text": "Thanks again for the patch. It has been applied to 7.0.x and proposed for 6.0.x"}, {"count": 2, "tags": [], "bug_id": 48653, "text": "Patch applied to 6.0.x and will be included in 6.0.25 onwards. Many thanks.", "id": 134789, "time": "2010-02-22T19:56:50Z", "creator": "markt@apache.org", "creation_time": "2010-02-22T19:56:50Z", "is_private": false, "attachment_id": null}]