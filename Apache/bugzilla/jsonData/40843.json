[{"count": 0, "tags": [], "bug_id": 40843, "attachment_id": null, "id": 95206, "time": "2006-10-30T01:43:45Z", "creator": "saijaiganesh@gmail.com", "creation_time": "2006-10-30T01:43:45Z", "is_private": false, "text": "Hi All,\nConfigurations:\nApache 2.0.55 , forward proxy, RHEL 4, 4 GB RAM, 6 GB SWAP, dual core HT enabled\nmachine.\n  Recently we notice that some apache processess are taking up more memory and\ndoing nothing at all. \nThe browsing becomes slower, memory is getting consumed. We also notice that the\nbrowsing is back to normal when we kill these process manually.\nThis has become quite annoying as we need to keep killing the process manually\nand these process does not release the mem they are using, till they are dead.\nApache is not creating new process as these guys are not dead,yet.\n\nHere is the strace of one such process:\n\nfutex(0x9dfe690, FUTEX_WAKE, 1)         = 0\n gettimeofday({1161960021, 481837}, NULL) = 0\n clock_gettime(CLOCK_REALTIME, 0xbfff94e0) = -1 ENOSYS (Function not implemented)\n gettimeofday({1161960021, 481924}, NULL) = 0\n futex(0xa2adea6c, FUTEX_WAIT, 84065, {0, 249913000}) = -1 ETIMEDOUT (Connection\ntimed out)\n futex(0x9dfe690, FUTEX_WAKE, 1)         = 0\n gettimeofday({1161960021, 741879}, NULL) = 0\n clock_gettime(CLOCK_REALTIME, 0xbfff94e0) = -1 ENOSYS (Function not implemented)\n gettimeofday({1161960021, 741962}, NULL) = 0\n futex(0xa2adea6c, FUTEX_WAIT, 84067, {0, 249917000}) = -1 ETIMEDOUT (Connection\ntimed out)\n futex(0x9dfe690, FUTEX_WAKE, 1)         = 0\n gettimeofday({1161960022, 1931}, NULL)  = 0\n clock_gettime(CLOCK_REALTIME, 0xbfff94e0) = -1 ENOSYS (Function not implemented)\n gettimeofday({1161960022, 2037}, NULL)  = 0\n futex(0xa2adea6c, FUTEX_WAIT, 84069, {0, 249894000}) = -1 ETIMEDOUT (Connection\ntimed out)\n futex(0x9dfe690, FUTEX_WAKE, 1)         = 0\n gettimeofday({1161960022, 261859}, NULL) = 0\n clock_gettime(CLOCK_REALTIME, 0xbfff94e0) = -1 ENOSYS (Function not implemented)\n gettimeofday({1161960022, 261938}, NULL) = 0\n futex(0xa2adea6c, FUTEX_WAIT, 84071, {0, 249921000}) = -1 ETIMEDOUT (Connection\ntimed out)\n futex(0x9dfe690, FUTEX_WAKE, 1)         = 0\n gettimeofday({1161960022, 521857}, NULL) = 0\n clock_gettime(CLOCK_REALTIME, 0xbfff94e0) = -1 ENOSYS (Function not implemented)\n gettimeofday({1161960022, 521940}, NULL) = 0\nfutex(0xa2adea6c, FUTEX_WAIT, 84073, {0, 2499170\n\n...\n...\n\nThe same thing repeats again and again.\n\nany help will be appreciated.\n\nregards\nGanesh"}, {"count": 1, "tags": [], "bug_id": 40843, "attachment_id": null, "is_private": false, "id": 95245, "time": "2006-10-31T06:32:19Z", "creator": "jorton@redhat.com", "creation_time": "2006-10-31T06:32:19Z", "text": "Can you get a backtrace from such a process?  Attach to it using\n\ngdb /path/to/httpd <pid>\n\nand enter \"bt\" at the gdb prompt.\n"}, {"count": 2, "text": "(In reply to comment #1)\n> Can you get a backtrace from such a process?  Attach to it using\n> gdb /path/to/httpd <pid>\n> and enter \"bt\" at the gdb prompt.\ngdb showed 30 threads and here is the sample of some threads \nSeems like all threads waiting for something from JVM.\n\ngdb  -p 22033\n\n(30 threads it showed)\n\n(gdb) thread 30\n\n(gdb) bt full\n\n#0  0x0018845b in pthread_cond_timedwait@@GLIBC_2.3.2 () \nfrom /lib/tls/libpthread.so.0\nNo symbol table info available.\n\n#1  0x00188844 in pthread_cond_timedwait@GLIBC_2.0 () \nfrom /lib/tls/libpthread.so.0\n\nNo symbol table info available.\n\n#2  0x0125806c in os::Linux::safe_cond_timedwait () \nfrom /usr/java/jre1.5.0_06/lib/i386/client/libjvm.so\n\nNo symbol table info available.\n\n#3  0x01244281 in Monitor::wait () \nfrom /usr/java/jre1.5.0_06/lib/i386/client/libjvm.so\n\nNo symbol table info available.\n\n#4  0x012f8f8b in VMThread::loop () \nfrom /usr/java/jre1.5.0_06/lib/i386/client/libjvm.so\nNo symbol table info available.\n\n#5  0x012f8bf0 in VMThread::run () \nfrom /usr/java/jre1.5.0_06/lib/i386/client/libjvm.so\nNo symbol table info available.\n\n#6  0x01258d08 in _start () \nfrom /usr/java/jre1.5.0_06/lib/i386/client/libjvm.so\nNo symbol table info available.\n\n#7  0x00185de8 in start_thread () from /lib/tls/libpthread.so.0\nNo symbol table info available.\n#8  0x0026d93a in clone () from /lib/tls/libc.so.6\nNo symbol table info available.\n\n(gdb) Thread 29\nNo symbol table info available.\n\n#1  0x001887bd in pthread_cond_wait@GLIBC_2.0 () from /lib/tls/libpthread.so.0\nNo symbol table info available.\n\n#2  0x01257f0e in os::Linux::safe_cond_wait () \nfrom /usr/java/jre1.5.0_06/lib/i386/client/libjvm.so\nNo symbol table info available.\n\n#3  0x0124dfef in ObjectMonitor::wait () \nfrom /usr/java/jre1.5.0_06/lib/i386/client/libjvm.so\n\nNo symbol table info available.\n\n#4  0x012a3df6 in ObjectSynchronizer::wait () \nfrom /usr/java/jre1.5.0_06/lib/i386/client/libjvm.so\nNo symbol table info available.\n\n#5  0x011a4293 in JVM_MonitorWait () \nfrom /usr/java/jre1.5.0_06/lib/i386/client/libjvm.so\nNo symbol table info available.\n\n#6  0x04dc042b in ?? ()\nNo symbol table info available.\n\n#7  0xa44bc960 in ?? ()\nNo symbol table info available.\n\n#8  0x00ab168c in ?? ()\nNo symbol table info available.\n\n#9  0x00000000 in ?? ()\nNo symbol table info available.\n\n\n(gdb) thread 28\n\n[Switching to thread 28 (Thread 14363568 (LWP 22035))]#0  0x0018826d in \npthread_cond_wait@@GLIBC_2.3.2 () from /lib/tls/libpthread.so.0\n\n(gdb) bt full\n#0  0x0018826d in pthread_cond_wait@@GLIBC_2.3.2 () \nfrom /lib/tls/libpthread.so.0\n\nNo symbol table info available.\n\n#1  0x001887bd in pthread_cond_wait@GLIBC_2.0 () from /lib/tls/libpthread.so.0\nNo symbol table info available.\n\n#2  0x01257f0e in os::Linux::safe_cond_wait () \nfrom /usr/java/jre1.5.0_06/lib/i386/client/libjvm.so\nNo symbol table info available.\n\n#3  0x0124dfef in ObjectMonitor::wait () \nfrom /usr/java/jre1.5.0_06/lib/i386/client/libjvm.so\nNo symbol table info available.\n\n#4  0x012a3df6 in ObjectSynchronizer::wait () \nfrom /usr/java/jre1.5.0_06/lib/i386/client/libjvm.so\n\nNo symbol table info available.\n\n#5  0x011a4293 in JVM_MonitorWait () \nfrom /usr/java/jre1.5.0_06/lib/i386/client/libjvm.so\nNo symbol table info available.\n\n#6  0x04dc042b in ?? ()\nNo symbol table info available.\n\n#7  0xa44bd610 in ?? ()\nNo symbol table info available.\n\n#8  0x00db25dc in ?? ()\nNo symbol table info available.\n\n#9  0x00000000 in ?? ()\nNo symbol table info available.\n\n\n", "bug_id": 40843, "is_private": false, "id": 95273, "time": "2006-10-31T23:36:34Z", "creator": "saijaiganesh@gmail.com", "creation_time": "2006-10-31T23:36:34Z", "tags": [], "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 40843, "attachment_id": null, "is_private": false, "id": 95274, "time": "2006-11-01T00:51:50Z", "creator": "jorton@redhat.com", "creation_time": "2006-11-01T00:51:50Z", "text": "> Seems like all threads waiting for something from JVM.\n\nThanks.  In this case, please file a bug against whatever module it is which\nyou're using to link the JVM into httpd."}]