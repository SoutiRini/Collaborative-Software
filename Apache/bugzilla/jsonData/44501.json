[{"count": 0, "tags": [], "creator": "esimons@atl.lmco.com", "attachment_id": 21595, "id": 114062, "time": "2008-02-27T08:51:11Z", "bug_id": 44501, "creation_time": "2008-02-27T08:51:11Z", "is_private": false, "text": "Created attachment 21595\nzip file containing 3 Visio files which produced the error\n\nI'm working on Linux and trying to extract text from visio files with VisioTextExtractor. A sample of the code I've written to do this is below. \n\nprotected static String extractVSD(String filename){\n   try { \n     FileInputStream fin = new FileInputStream(filename);\n     VisioTextExtractor extractor = new VisioTextExtractor(fin);\n     .\n     .\n     .\n}\n\nWhen it goes to open a new VisioTextExtractor, I get the following error. This error occurs for every VSD file that I have tried. I'm using POI scratchpad version 3.0.2, but I've also tried version 3.0.1 and encountered the same error. I've attached a zip file containing 3 of the simple test files that produced the error.\n\n\nStacktrace:\njava.lang.ArrayIndexOutOfBoundsException: 1991\n        at org.apache.poi.util.LittleEndian.getNumber(LittleEndian.java:492)\n        at org.apache.poi.util.LittleEndian.getUInt(LittleEndian.java:164)\n        at org.apache.poi.hdgf.chunks.ChunkHeader.createChunkHeader(ChunkHeader.java:43)\n        at org.apache.poi.hdgf.chunks.ChunkFactory.createChunk(ChunkFactory.java:108)\n        at org.apache.poi.hdgf.streams.ChunkStream.findChunks(ChunkStream.java:54)\n        at org.apache.poi.hdgf.streams.PointerContainingStream.findChildren(PointerContainingStream.java:92)\n        at org.apache.poi.hdgf.streams.PointerContainingStream.findChildren(PointerContainingStream.java:99)\n        at org.apache.poi.hdgf.streams.PointerContainingStream.findChildren(PointerContainingStream.java:99)\n        at org.apache.poi.hdgf.HDGFDiagram.<init>(HDGFDiagram.java:92)\n        at org.apache.poi.hdgf.extractor.VisioTextExtractor.<init>(VisioTextExtractor.java:46)\n        at org.apache.poi.hdgf.extractor.VisioTextExtractor.<init>(VisioTextExtractor.java:50)\n        at com.lmco.atl.soser.collector.FileContentsUtil.extractVSD(FileContentsUtil.java:298)\n        at com.lmco.atl.soser.collector.FileContentsUtil.main(FileContentsUtil.java:442)"}, {"count": 1, "tags": [], "bug_id": 44501, "is_private": false, "id": 114101, "attachment_id": null, "creator": "fathi.nemeur@sacem.fr", "creation_time": "2008-02-28T08:01:13Z", "time": "2008-02-28T08:01:13Z", "text": "I have the same problem with my visio files (even an empty one)."}, {"count": 2, "tags": [], "creator": "apache@gagravarr.org", "text": "Out of interest, if you open one of these files up in visio, and do \"save as\", does the resulting file still have the same problem?\n\n(It looks like there's more data in a chunk stream than there are chunks, so we're running out of data when creating)", "id": 114243, "time": "2008-03-04T05:16:12Z", "bug_id": 44501, "creation_time": "2008-03-04T05:16:12Z", "is_private": false, "attachment_id": null}, {"count": 3, "text": "Created attachment 21624\ntest file\n\nI have the same problem with all my visio files.", "bug_id": 44501, "attachment_id": 21624, "id": 114247, "time": "2008-03-04T05:48:49Z", "creator": "fathi.nemeur@sacem.fr", "creation_time": "2008-03-04T05:48:49Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "text": "I can't extract the content of my visio file. (even if I do \"save as\" before extracting).\nI have joined my document and this is the trace of my Junit test.\n\njava.lang.ArrayIndexOutOfBoundsException: 57\n\tat org.apache.poi.util.LittleEndian.getNumber(LittleEndian.java:492)\n\tat org.apache.poi.util.LittleEndian.getDouble(LittleEndian.java:220)\n\tat org.apache.poi.hdgf.chunks.Chunk.processCommands(Chunk.java:174)\n\tat org.apache.poi.hdgf.chunks.ChunkFactory.createChunk(ChunkFactory.java:171)\n\tat org.apache.poi.hdgf.streams.ChunkStream.findChunks(ChunkStream.java:54)\n\tat org.apache.poi.hdgf.streams.PointerContainingStream.findChildren(PointerContainingStream.java:92)\n\tat org.apache.poi.hdgf.HDGFDiagram.<init>(HDGFDiagram.java:92)\n\tat org.apache.poi.hdgf.extractor.VisioTextExtractor.<init>(VisioTextExtractor.java:46)\n\tat org.apache.poi.hdgf.extractor.VisioTextExtractor.<init>(VisioTextExtractor.java:50)\n\tat fr.sacem.amely.document.repository.core.extractor.office.VisioContentExtractor.getPlainText(VisioContentExtractor.java:56)\n\tat fr.sacem.amely.document.repository.core.extractor.ContentExtractorManager.getPlainText(ContentExtractorManager.java:117)\n\tat fr.sacem.amely.document.repository.core.extractor.ContentExtractorManagerTestCase.testExtract(ContentExtractorManagerTestCase.java:78)", "is_private": false, "bug_id": 44501, "id": 114248, "time": "2008-03-04T05:49:41Z", "creator": "fathi.nemeur@sacem.fr", "creation_time": "2008-03-04T05:49:41Z", "attachment_id": null}, {"count": 5, "text": "Do you happen to know what version of visio produced the files?\n\n(It's odd that you're both finding lots of files that trigger this, but none of mine ever have)\n\nI've added your problem files to svn, so they're available for writing tests against", "bug_id": 44501, "attachment_id": null, "id": 114255, "time": "2008-03-04T07:05:55Z", "creator": "apache@gagravarr.org", "creation_time": "2008-03-04T07:05:55Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "bug_id": 44501, "is_private": false, "id": 114256, "creation_time": "2008-03-04T07:14:01Z", "time": "2008-03-04T07:14:01Z", "creator": "fathi.nemeur@sacem.fr", "text": "This is the version of visio , I use :\nMicrosoft Visio Professional 2002 SP-2(10.0.6865) (french version)\n\n(Do you have embedded stencils in your visio document?)", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 44501, "is_private": false, "text": "My Visio files were created with Microsoft Office Visio Professional 2007 (12.0.4518.1014) MSO (12.0.6017.5000)", "id": 114260, "time": "2008-03-04T08:34:13Z", "creator": "esimons@atl.lmco.com", "creation_time": "2008-03-04T08:34:13Z", "attachment_id": null}, {"count": 8, "tags": [], "creator": "fathi.nemeur@sacem.fr", "attachment_id": null, "id": 114345, "time": "2008-03-06T08:40:43Z", "bug_id": 44501, "creation_time": "2008-03-06T08:40:43Z", "is_private": false, "text": "Additional info have been provided"}, {"count": 9, "text": "*** Bug 44594 has been marked as a duplicate of this bug. ***", "bug_id": 44501, "attachment_id": null, "id": 114580, "time": "2008-03-13T06:21:01Z", "creator": "apache@gagravarr.org", "creation_time": "2008-03-13T06:21:01Z", "tags": [], "is_private": false}, {"count": 10, "tags": [], "creator": "apache@gagravarr.org", "text": "I think before we spend a lot of time trying to work around these short chunks, we'll want to be sure we're correctly decoding them in the first place.\n\nSo, I'll put this bug on hold until we've fixed the decompression problem from bug #43670", "id": 114745, "time": "2008-03-19T06:35:18Z", "bug_id": 44501, "creation_time": "2008-03-19T06:35:18Z", "is_private": false, "attachment_id": null}, {"count": 11, "text": "*** Bug 44687 has been marked as a duplicate of this bug. ***", "bug_id": 44501, "attachment_id": null, "id": 115014, "time": "2008-03-27T04:58:54Z", "creator": "apache@gagravarr.org", "creation_time": "2008-03-27T04:58:54Z", "tags": [], "is_private": false}, {"count": 12, "tags": [], "bug_id": 44501, "is_private": false, "id": 115176, "attachment_id": null, "creator": "durgadeep@gmail.com", "creation_time": "2008-03-31T18:21:14Z", "time": "2008-03-31T18:21:14Z", "text": "*** Bug 44717 has been marked as a duplicate of this bug. ***"}, {"count": 13, "tags": [], "creator": "apache@gagravarr.org", "text": "This should now be fixed in svn trunk", "id": 115373, "time": "2008-04-07T08:21:28Z", "bug_id": 44501, "creation_time": "2008-04-07T08:21:28Z", "is_private": false, "attachment_id": null}, {"count": 14, "tags": [], "creator": "durgadeep@gmail.com", "attachment_id": 21800, "id": 115466, "time": "2008-04-09T11:12:00Z", "bug_id": 44501, "creation_time": "2008-04-09T11:12:00Z", "is_private": false, "text": "Created attachment 21800\njava.lang.IllegalArgumentException: Found a chunk with a negative length, which isn't allowed"}, {"count": 15, "tags": [], "creator": "fathi.nemeur@sacem.fr", "attachment_id": null, "id": 116294, "time": "2008-05-06T05:01:59Z", "bug_id": 44501, "creation_time": "2008-05-06T05:01:59Z", "is_private": false, "text": "I have tried with the new release \"poi-bin-3.1-beta1-20080428\".\nI stil have the same problem.\n\nStacktrace: \n\njava.lang.ArrayIndexOutOfBoundsException: 57\n\tat org.apache.poi.util.LittleEndian.getNumber(LittleEndian.java:502)\n\tat org.apache.poi.util.LittleEndian.getDouble(LittleEndian.java:220)\n\tat org.apache.poi.hdgf.chunks.Chunk.processCommands(Chunk.java:174)\n\tat org.apache.poi.hdgf.chunks.ChunkFactory.createChunk(ChunkFactory.java:171)\n\tat org.apache.poi.hdgf.streams.ChunkStream.findChunks(ChunkStream.java:58)\n\tat org.apache.poi.hdgf.streams.PointerContainingStream.findChildren(PointerContainingStream.java:92)\n\tat org.apache.poi.hdgf.HDGFDiagram.<init>(HDGFDiagram.java:92)\n\tat org.apache.poi.hdgf.extractor.VisioTextExtractor.<init>(VisioTextExtractor.java:47)\n\tat org.apache.poi.hdgf.extractor.VisioTextExtractor.<init>(VisioTextExtractor.java:51)"}, {"count": 16, "tags": [], "text": "Bug still exists in POI 3.5 beta. Is there any idea about the error? I can do nothing if I can't create the HDGFDiagram object...", "is_private": false, "bug_id": 44501, "id": 129065, "time": "2009-07-23T02:45:58Z", "creator": "liyu.ma@simiolus.com", "creation_time": "2009-07-23T02:45:58Z", "attachment_id": null}, {"count": 17, "tags": [], "bug_id": 44501, "attachment_id": null, "is_private": false, "id": 149914, "time": "2011-09-28T14:26:45Z", "creator": "jan.stette@gmail.com", "creation_time": "2011-09-28T14:26:45Z", "text": "We're seeing the same bug in Apache POI 3.8.0 beta 3.  Is there anyone who is able to fix this?"}, {"count": 18, "tags": [], "text": "the same in 3.8 beta 4.\nstack trace:\n\njava.lang.ArrayIndexOutOfBoundsException: Illegal offset 8 (String data is of length 8)\nat org.apache.poi.util.StingUtil.getFromUnicodeLE(StringUtil.java:70)\nat org.apache.hdgf.chunks.Chunk.processCommands(Chunk.java:203)\n...", "is_private": false, "bug_id": 44501, "id": 152045, "time": "2011-12-07T09:15:57Z", "creator": "rendangpei@hotmail.com", "creation_time": "2011-12-07T09:15:57Z", "attachment_id": null}, {"count": 19, "tags": [], "bug_id": 44501, "text": "the same bug with Apache POI 3.8-20120326\n\nException in thread \"main\" java.lang.ArrayIndexOutOfBoundsException: 57\n\tat org.apache.poi.util.LittleEndian.getLong(LittleEndian.java:191)\n\tat org.apache.poi.util.LittleEndian.getDouble(LittleEndian.java:104)\n\tat org.apache.poi.hdgf.chunks.Chunk.processCommands(Chunk.java:175)\n\tat org.apache.poi.hdgf.chunks.ChunkFactory.createChunk(ChunkFactory.java:180)\n\tat org.apache.poi.hdgf.streams.ChunkStream.findChunks(ChunkStream.java:59)\n\tat org.apache.poi.hdgf.streams.PointerContainingStream.findChildren(PointerContainingStream.java:93)\n\tat org.apache.poi.hdgf.HDGFDiagram.<init>(HDGFDiagram.java:106)\n\tat org.apache.poi.hdgf.HDGFDiagram.<init>(HDGFDiagram.java:70)\n\tat VsdTextExtractor.<init>(VsdTextExtractor.java:56)\n\tat VsdTextExtractor.<init>(VsdTextExtractor.java:53)\n\tat VsdTextExtractor.<init>(VsdTextExtractor.java:66)\n\tat TestVsdTextExtractor.test(TestVsdTextExtractor.java:13)\n\tat TestVsdTextExtractor.main(TestVsdTextExtractor.java:6)", "id": 160154, "attachment_id": null, "creator": "c.czech@elo.com", "creation_time": "2012-06-21T09:52:05Z", "time": "2012-06-21T09:52:05Z", "is_private": false}, {"count": 20, "tags": [], "creator": "mdossantos_dev@hotmail.com", "attachment_id": null, "id": 161777, "time": "2012-08-28T15:22:28Z", "bug_id": 44501, "creation_time": "2012-08-28T15:22:28Z", "is_private": false, "text": "Has there been any update on this.  In 3.8 I get the same error with some simple visio documents."}, {"count": 21, "tags": [], "creator": "dominik.stadler@gmx.at", "text": "I tried all of the files provided here and all could be read successfully without any exception. Therefore I am closing this Bug now, if you still see this I think it would be best to report a new bug entry with a sample file and code to reproduce the problem, preferably as junit test.", "id": 181939, "time": "2015-03-22T12:17:55Z", "bug_id": 44501, "creation_time": "2015-03-22T12:17:55Z", "is_private": false, "attachment_id": null}]