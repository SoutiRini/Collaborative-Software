[{"count": 0, "tags": [], "creator": "charles.butterfield@nextcentury.com", "attachment_id": null, "id": 66485, "time": "2004-11-04T22:34:54Z", "bug_id": 32069, "creation_time": "2004-11-04T22:34:54Z", "is_private": false, "text": "For ant 1.6.2 on WinXP SP2, I noticed that the exit status is corrupted \n(changed from 0 to 1) if no command line args are specified.  It appears that \nthe act of unsetting _JAVACMD changes ERRORLEVEL (to 1) if and only if the \nvariable was not previous set.\n\nMy fix was to forcibly set the two variables being erased just prior to \nerasing them.  It's pretty ugly, maybe there is a better way. I don't know if \nthere are side-effects on other versions of Windows.\n\nFYI - here is how I patched my ant.bat file:\n...\n:end\n:: BUGFIX/CB: (under WinXP at least), erasing a shell variable that was never\n:: set appears to modify ERRORLEVEL (it sets it to 1, perhaps to indicate that\n:: the erase was erroneous/unneeded).  So we set each var to a DUMMY value to\n:: preserve the ant exit status.\nset _JAVACMD=DUMMY_VAL\nset _JAVACMD=\nset ANT_CMD_LINE_ARGS=DUMMY_VAL\nset ANT_CMD_LINE_ARGS=\n..."}, {"attachment_id": null, "tags": [], "creator": "bugzilla.asf@timmyxaphan.fastmail.fm", "is_private": false, "count": 1, "id": 85374, "time": "2006-02-03T00:42:20Z", "bug_id": 32069, "creation_time": "2006-02-03T00:42:20Z", "text": "Confirming this under Win 2000, SP4."}, {"count": 2, "tags": [], "bug_id": 32069, "attachment_id": null, "id": 86428, "time": "2006-03-03T03:13:38Z", "creator": "charles.butterfield@nextcentury.com", "creation_time": "2006-03-03T03:13:38Z", "is_private": false, "text": "Just a note that this bug still exists in 1.6.5.  Could somebody PLEASE \nincorporate the TRIVIAL FIX I have indicated into the current release?  It's \nbeen a long time (16 months) since originally reported.\n-- regards\n-- Charlie Butterfield"}, {"count": 3, "tags": [], "bug_id": 32069, "text": "Fixed in SVN head. Thanks!\n\nAs an aside, the ,bat and .sh files are the most troublesome bit of Ant. changes\nthere are a lot less trivial than you think, and need to be tested on win9x\nboxes as well as nt systems before committing.", "id": 86450, "time": "2006-03-03T14:40:02Z", "creator": "stevel@apache.org", "creation_time": "2006-03-03T14:40:02Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "stevel@apache.org", "is_private": false, "count": 4, "id": 91268, "time": "2006-07-13T11:22:22Z", "bug_id": 32069, "creation_time": "2006-07-13T11:22:22Z", "text": "Note that in Ant1.7, we can change ant.bat to go \n\nexit /b %ANT_EXIT_CODE% \n\nso exit with a proper value even after running ant_postrc.bat."}]