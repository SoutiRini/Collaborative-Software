[{"count": 0, "tags": [], "creator": "buzz.taiki@gmail.com", "attachment_id": null, "id": 150929, "time": "2011-10-26T10:39:01Z", "bug_id": 52091, "creation_time": "2011-10-26T10:39:01Z", "is_private": false, "text": "TagHandlerPool is slow when I ran stress test my web application using tomcat7.\nIt occured in 7.0.19.\nProfiler said that it causes are followings:\n\n 1. Lock of log instance at org.apache.jasper.runtime.TagHandlerPool.\n\n 2. Lock of parameters field at org.apache.catalina.core.StandardWrapper.getInitParameter.\n\nAn attached patch resolve this issue in my environment.\nIt makes following changes:\n\n 1. Makes log field to static.\n\n 2. At StandardWrapper, changes lock policy from synchronized block to ReentrantReadWriteLock."}, {"count": 1, "attachment_id": 27851, "creator": "buzz.taiki@gmail.com", "text": "Created attachment 27851\nReduce lock patch", "id": 150930, "time": "2011-10-26T10:41:29Z", "bug_id": 52091, "creation_time": "2011-10-26T10:41:29Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 151009, "time": "2011-10-28T14:43:14Z", "bug_id": 52091, "creation_time": "2011-10-28T14:43:14Z", "is_private": false, "text": "The lock changes look good to me.\n\nThe log change needed more careful checked. I have vague recollections of memory leaks with Jasper and logging and a number of components using non-static loggers to avoid them. Having checked the initialisation sequence, the logger is created by the container class loader, not a web app class loader so that change should be fine to. I'll commit these changes shortly."}, {"count": 3, "attachment_id": null, "bug_id": 52091, "is_private": false, "id": 151012, "time": "2011-10-28T15:16:39Z", "creator": "markt@apache.org", "creation_time": "2011-10-28T15:16:39Z", "tags": [], "text": "Many thanks for the patch. It has been applied to trunk and 7.0.x and will be in 7.0.23 onwards."}, {"text": "Created attachment 27862\n2011-10-29_tc6_52091_StandardWrapper.patch\n\nTC6 patch for StandardWrapper - backport of r1190389", "tags": [], "bug_id": 52091, "attachment_id": 27862, "count": 4, "id": 151022, "time": "2011-10-28T22:55:06Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2011-10-28T22:55:06Z", "is_private": false}, {"count": 5, "tags": [], "text": "Thanks for applying all changes!\n\nFollowings are changesets of this ticket for my reminder:\nr1190388, r1190389", "is_private": false, "id": 151063, "creator": "buzz.taiki@gmail.com", "time": "2011-10-31T04:02:14Z", "bug_id": 52091, "creation_time": "2011-10-31T04:02:14Z", "attachment_id": null}, {"count": 6, "tags": [], "creator": "knst.kolinko@gmail.com", "attachment_id": null, "id": 151360, "time": "2011-11-10T11:18:43Z", "bug_id": 52091, "creation_time": "2011-11-10T11:18:43Z", "is_private": false, "text": "Fixed in 6.0 and will be in 6.0.34.\nr1200268 and r1200269"}]