[{"attachment_id": null, "tags": [], "creator": "trejkaz@trypticon.org", "text": "On latest version in SVN, constructing an HSLFSlideShow on a certain slide show,\nI get the following error:\n\njava.lang.RuntimeException: Couldn't instantiate the class for type with id 0 on\nclass class org.apache.poi.hslf.record.UnknownRecordPlaceholder :\njava.lang.reflect.InvocationTargetException\nCause was : java.lang.ArrayIndexOutOfBoundsException\n        at org.apache.poi.hslf.record.Record.createRecordForType(Record.java:158)\n        at org.apache.poi.hslf.record.Record.findChildRecords(Record.java:109)\n        at org.apache.poi.hslf.HSLFSlideShow.readFIB(HSLFSlideShow.java:174)\n        at org.apache.poi.hslf.HSLFSlideShow.<init>(HSLFSlideShow.java:103)", "count": 0, "id": 85451, "time": "2006-02-06T06:03:50Z", "bug_id": 38526, "creation_time": "2006-02-06T06:03:50Z", "is_private": false}, {"count": 1, "tags": [], "creator": "trejkaz@trypticon.org", "text": "Created attachment 17600\nPPT file exhibiting the problem.\n\nHere's the file in question.  It opens in Office and OpenOffice, looks to be\npretty innocent but breaks in HSLF for some reason.", "id": 85452, "time": "2006-02-06T06:05:14Z", "bug_id": 38526, "creation_time": "2006-02-06T06:05:14Z", "is_private": false, "attachment_id": 17600}, {"count": 2, "tags": [], "bug_id": 38526, "text": "Following the normal slide records, that PPT file than has 63 records of type 0.\nThe first 62 are of zero length (so just the 8 byte record header), and the\nfinal one is 251658240 bytes big!\n\nI'm happy to code up something to ignore the empty records of type 0. I'm less\nhappy about the whacking great record\n\nHow did you go about creating this file, and is there anything special about it?", "id": 85461, "attachment_id": null, "creator": "apache@gagravarr.org", "creation_time": "2006-02-06T13:59:22Z", "time": "2006-02-06T13:59:22Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 38526, "attachment_id": null, "is_private": false, "id": 85462, "time": "2006-02-06T14:04:30Z", "creator": "apache@gagravarr.org", "creation_time": "2006-02-06T14:04:30Z", "text": "On closer inspection, that last record claims to be ~250mb in size, as part of a\n62kb file! Something is corrupt somewhere in that PPT file, but I'll see if I\ncan come up with a sensible way to handle documents with corruption like that."}, {"count": 4, "tags": [], "text": "OK, SVN now has a fix. If a record claims to be larger than the available data,\nit will be silently ignored. I can now process that file fine with HSLF.\n\nNote - if you open a corrupt file like this, and write it back out again, it\nwill be changed! (The corrupt record will be discarded)", "is_private": false, "id": 85463, "creator": "apache@gagravarr.org", "time": "2006-02-06T14:14:02Z", "bug_id": 38526, "creation_time": "2006-02-06T14:14:02Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 38526, "attachment_id": null, "is_private": false, "id": 85485, "time": "2006-02-07T00:19:44Z", "creator": "trejkaz@trypticon.org", "creation_time": "2006-02-07T00:19:44Z", "text": "Ah, so it was corrupt... I was wondering about that, because even OpenOffice\nopened it silently.  I actually got the PPT file out of a large set of PPT files\ncreated by other people, so it's impossible to know exactly which versions they\nused and what sort of shenanigans went on. :-)"}, {"count": 6, "tags": [], "bug_id": 38526, "attachment_id": null, "is_private": false, "id": 85486, "time": "2006-02-07T00:58:26Z", "creator": "trejkaz@trypticon.org", "creation_time": "2006-02-07T00:58:26Z", "text": "Darn.  This does prevent the error being thrown, but now getTextRuns() returns\nno text.  OpenOffice can show the text, so there must be something that can be\ndone to retrieve it.\n\nFeel free to re-close this if it looks like it's completely impossible to get\nout because of that corrupt record."}, {"count": 7, "tags": [], "bug_id": 38526, "attachment_id": null, "text": "Fixed, though it wasn't trivial.\nIn the attached file root-level records were not continuous and some of them\nwere skipped with the \"Skipping record of type 0 at position ...\" message in\nSystem.err. \nAs the result, the wrong Slide record was selected with no text runs.\nShould work fine now.\n\nYegor", "id": 103759, "time": "2007-05-29T01:42:15Z", "creator": "yegor@dinom.ru", "creation_time": "2007-05-29T01:42:15Z", "is_private": false}]