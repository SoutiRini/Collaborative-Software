[{"count": 0, "tags": [], "bug_id": 28263, "attachment_id": null, "text": "The Tomcat 5 installation on Windows detects the JRE folder (usually like \nC:\\Program Files\\Java\\j2re1.4\\), instead of the correct Java SDK folder\n(usually like C:\\j2sdk1.4\\).\n\nThis is really bad for the novice user, since after that Tomcat will run, but \nit will not be able to dynamically compile JSP pages by default, unless he/she \nmanually copy tools.jar to the Tomcat common\\lib\\ folder.", "id": 55471, "time": "2004-04-07T16:12:18Z", "creator": "mhtech@mhavila.com.br", "creation_time": "2004-04-07T16:12:18Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 28263, "attachment_id": null, "text": "This is not the case.", "id": 55473, "time": "2004-04-07T16:15:45Z", "creator": "remm@apache.org", "creation_time": "2004-04-07T16:15:45Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 28263, "attachment_id": null, "is_private": false, "id": 55474, "time": "2004-04-07T16:27:42Z", "creator": "mhtech@mhavila.com.br", "creation_time": "2004-04-07T16:27:42Z", "text": "I beg you pardon, but this is a reproducible issue in my Windows XP computer, \nwhich have the JDK 1.4.2_04 correctly installed. In addition, I maintain a \nTomcat installation tutorial (in Portuguese) in my site and some other users \nhave also contacted me describing the exact same problem. So *why* this is not \nthe case?"}, {"count": 3, "tags": [], "bug_id": 28263, "attachment_id": null, "is_private": false, "id": 55583, "time": "2004-04-09T20:29:55Z", "creator": "mhtech@mhavila.com.br", "creation_time": "2004-04-09T20:29:55Z", "text": "I've looked into the installation scripts from Tomcat CVS.\n\nThere's a \"Function findJavaPath\" in \"tomcat.nsi\" file. In Tomcat 4 script,\nwhich correctly find the JDK path, the registry keys for the Java Development\nKit are read, and the JavaHome path value will be put into $1 correctly:\n\n  ReadRegStr $2 HKLM \"SOFTWARE\\JavaSoft\\Java Development Kit\" \"CurrentVersion\"\n  ReadRegStr $1 HKLM \"SOFTWARE\\JavaSoft\\Java Development Kit\\$2\" \"JavaHome\"\n  ReadRegStr $3 HKLM \"SOFTWARE\\JavaSoft\\Java Runtime Environment\" \"CurrentVersion\"\n  ReadRegStr $4 HKLM \"SOFTWARE\\JavaSoft\\Java Runtime Environment\\$3\" \"RuntimeLib\"\n\nBut, in the Tomcat 5 installation script, this is WRONG, it really gets the\nJavaHome from JRE, not from JDK, as show in the current code:\n\n  ReadRegStr $2 HKLM \"SOFTWARE\\JavaSoft\\Java Runtime Environment\" \"CurrentVersion\"\n  ReadRegStr $1 HKLM \"SOFTWARE\\JavaSoft\\Java Runtime Environment\\$2\" \"JavaHome\"\n  ReadRegStr $3 HKLM \"SOFTWARE\\JavaSoft\\Java Runtime Environment\\$2\" \"RuntimeLib\"\n\nThe solution is just replace the installation code I've found for Tomcat 4.\n\nAfter that, if you still close the bug as invalid, I quit."}, {"count": 4, "tags": [], "creator": "mhtech@mhavila.com.br", "text": "Created attachment 11209\n[PATCH] Correctly detects JDK (and not JRE) in NSI Windows installation script", "id": 55626, "time": "2004-04-10T18:53:08Z", "bug_id": 28263, "creation_time": "2004-04-10T18:53:08Z", "is_private": false, "attachment_id": 11209}, {"count": 5, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "id": 56361, "time": "2004-04-25T12:37:11Z", "bug_id": 28263, "creation_time": "2004-04-25T12:37:11Z", "is_private": false, "text": "What I meant is actually that you should use something reliable (JAVA_HOME, or\nselect the right path in the dialog). The registry keys depend on the JDK used,\nso it will not really work."}, {"count": 6, "tags": [], "bug_id": 28263, "attachment_id": null, "text": "Actually the Function findJavaPath, in installation script, already look for \nthe JAVA_HOME environment variable as a first try, and this is correct.\nThe problem is in the second try, when it looks into Windows Registry.\nThe high-level algorithm for this function is:\n\n1. Try to read JAVA_HOME environment variable.\n2. If it exists, JDK is considered found, end function.\n3. Else (JAVA_HOME not defined), try to read Windows Registry for JDK \ninstallation.\n4. If Registry key for JDK is found,\n\nThe script for Tomcat 4 correctly do the step 3 looking for the SDK \ninstallation key. But the Tomcat 5 installation script looks for JRE key in \nthe step 3, which is obviously wrong. I don't know why the error was \nintroduced in Tomcat 5 installation, since it was correct in Tomcat 4.\n\nBut it IS a bug. BTW, the registry keys I'm talking about are conformant to \nall versions of Windows installation for Java SDK from Sun Microsystems, \nincluding the most recent, 1.4.2_04.\n\nI'm sorry, but I can't believe that a basic bug like that will remain existing \nsince it can be easily solved and I already sent a patch.\n\nWhich Tomcat project commiter is familiar to the Windows installation script?\nDoes anyone else agree with me, or everybody agree with mr. Remy Maucherat \nthat the error should not be fixed?", "id": 56379, "time": "2004-04-25T22:52:55Z", "creator": "mhtech@mhavila.com.br", "creation_time": "2004-04-25T22:52:55Z", "is_private": false}]