[{"count": 0, "tags": [], "creator": "stefan.stern@mind8.com", "attachment_id": 24859, "is_private": false, "id": 133699, "time": "2010-01-19T06:43:54Z", "bug_id": 48571, "creation_time": "2010-01-19T06:43:54Z", "text": "Created attachment 24859\nAdds some lines in order to close all Streams created in OPCPackage\n\nWhenever a file (docx, xlsx, pptx) is opened as OPCPackage, modified and afterwards closed with OPCPackage#close, the Java process keeps a file handle open. In order to modify a document with Word, Excel or Powerpoint, the Java process must terminate in order to release the file.\n\nThis happens because OPCPackage creates and opens Streams, which are never closed.\n\nSee enclosed Patch for a fix. I couldn't find a problem with that solution so far.\n\nGenerally speaking, I have the opinion that everyone creating a stream is responsible for the stream lifecycle and must take care that the stream is closed, after all actions requiring it, are done."}, {"count": 1, "tags": [], "bug_id": 48571, "attachment_id": null, "text": "Thanks for the patch, applied in r902565\n\n\nYegor", "id": 133856, "time": "2010-01-24T05:27:19Z", "creator": "yegor@dinom.ru", "creation_time": "2010-01-24T05:27:19Z", "is_private": false}]