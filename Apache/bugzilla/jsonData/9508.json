[{"count": 0, "tags": [], "creator": "gturner@unzane.com", "attachment_id": null, "id": 16897, "time": "2002-05-29T20:48:57Z", "bug_id": 9508, "creation_time": "2002-05-29T20:48:57Z", "is_private": false, "text": "The antstructure task of Ant 1.5Beta1 misses a few elements that Ant 1.4.1 is\nable to introspect/generate.  \n\nSpecifically I'm using third-party tasks from XDoclet 1.1.2 and have executed\nthe following target on both 1.5Beta1 and 1.4.1:\n\n  <target name=\"init\">\n    <taskdef name=\"webdoclet\" classname=\"xdoclet.web.WebDocletTask\"/>\n    <taskdef name=\"ejbdoclet\" classname=\"xdoclet.ejb.EjbDocletTask\"/>\n    <antstructure output=\"lib/dtd/ant/project.dtd\"/>\n  </target>\n\nI have immediately noticed that Ant 1.5Beta1 fails to write out all nested\nelements of the \"deploymentdescriptor\" nested task of the \"webdoclet\" task such\nas \"welcomefile\", \"taglib\", and \"contextparam\", whereas 1.4.1 can do this just\nfine.  I'm sure that there are many other missing elements, I'll do the research\nif this information isn't enough.  It's interesting to note that 1.5Beta1 *does*\nwrite some of the nested elements of \"deploymentdescriptor\", specifically\n\"packagesubstitutions\" and \"configparam\" which happen to be members of the\n\"deploymentdescriptor\" superclasses."}, {"count": 1, "tags": [], "creator": "gturner@unzane.com", "text": "Created attachment 1970\nOutput of anstructure task with Ant 1.5Beta1 (missing elements)", "id": 16899, "time": "2002-05-29T20:50:32Z", "bug_id": 9508, "creation_time": "2002-05-29T20:50:32Z", "is_private": false, "attachment_id": 1970}, {"count": 2, "tags": [], "creator": "gturner@unzane.com", "attachment_id": 1971, "is_private": false, "id": 16900, "time": "2002-05-29T20:51:18Z", "bug_id": 9508, "creation_time": "2002-05-29T20:51:18Z", "text": "Created attachment 1971\nOutput of anstructure task with Ant 1.4.1"}, {"count": 3, "tags": [], "text": "If you don't want to bother with attachments, here's the element declaration\nline from both files I've been talking about:\n\nAnt 1.5Beta1:\n\n  <!ELEMENT deploymentdescriptor (configparam | packagesubstitution)*>\n\nAnt 1.4.1:\n\n  <!ELEMENT deploymentdescriptor (taglib | contextparam | configparam |\nwelcomefile | packagesubstitution)*>\n\n\nThere could be plenty more differences, maybe within Ant's own tasks (not just\nthird-party XDoclet), I'll gladly research this if anyone thinks it'll help.", "attachment_id": null, "bug_id": 9508, "id": 16901, "time": "2002-05-29T20:55:57Z", "creator": "gturner@unzane.com", "creation_time": "2002-05-29T20:55:57Z", "is_private": false}, {"count": 4, "tags": [], "text": "I noticed a new release, Ant 1.5Beta2, and executed antstructure with it,\nproblem still exists :(", "attachment_id": null, "bug_id": 9508, "id": 17146, "time": "2002-06-04T22:36:27Z", "creator": "gturner@unzane.com", "creation_time": "2002-06-04T22:36:27Z", "is_private": false}, {"count": 5, "tags": [], "creator": "gturner@unzane.com", "attachment_id": 2310, "text": "Created attachment 2310\nOutput of anstructure task with Ant 1.5 (missing elements)", "id": 19275, "time": "2002-07-10T19:35:19Z", "bug_id": 9508, "creation_time": "2002-07-10T19:35:19Z", "is_private": false}, {"count": 6, "tags": [], "creator": "gturner@unzane.com", "attachment_id": null, "id": 19276, "time": "2002-07-10T19:35:39Z", "bug_id": 9508, "creation_time": "2002-07-10T19:35:39Z", "is_private": false, "text": "Wonderful, 1.5 released!\n\nSadly this bug still exists... I've attached the output generated by this test\ntarget:\n\n  <target name=\"antstructure\">\n    <taskdef name=\"ejbdoclet\"\n             classname=\"xdoclet.ejb.EjbDocletTask\"/>\n    <taskdef name=\"webdoclet\"\n             classname=\"xdoclet.web.WebDocletTask\"/>\n\n    <antstructure output=\"project_${ant.version}.dtd\"/>\n  </target>"}, {"count": 7, "tags": [], "creator": "rndzank@attbi.com", "attachment_id": null, "is_private": false, "id": 21404, "time": "2002-08-20T18:25:37Z", "bug_id": 9508, "creation_time": "2002-08-20T18:25:37Z", "text": "While fixing this bug, there are some simple workarounds that could help.\nPlease, see bug #11870."}, {"count": 8, "tags": [], "bug_id": 9508, "attachment_id": null, "text": "Gerald, can you tell me if this is still an issue - I've looked at this with the\ncurrent XDoclet code and not sure it is the same. Can you give me an update? Thanks", "id": 30509, "time": "2003-02-02T13:23:57Z", "creator": "conor@apache.org", "creation_time": "2003-02-02T13:23:57Z", "is_private": false}, {"count": 9, "tags": [], "text": "This is not a bug as such. It is an inherent limitation of DTDs. DTDs do not\nallow the same element to behave differently (i.e. to have a different content\nmodel) depending on its context. Ant, however, does allow that. When the same\nelement is used in two different ways (i.e. two different content models),\n<antstructure> will pick one of these as the content model it places in the DTD.\n\nSince both ejbdoclet and webdoclet support a <deploymentdescriptor> element and\nthose elements have different attributes, one will not be represented in the\nDTD. The order of processing by <antstructure> is essentially random - the\noutput order of a hashtable. Since the number of tasks changed in Ant 1.5 the\norder changed. You'll notice in your 1.4.1 output, webdoclet comes before\nejbdoclet while in the 1.5 traces it comes after.\n\nSince the xdoclet developers have taken advantage of Ant's capabilities to use\nthe same elementname in different contextx, these tasks cannot both be\nrepresented in the same DTD.", "is_private": false, "bug_id": 9508, "id": 41220, "time": "2003-07-23T13:46:23Z", "creator": "conor@apache.org", "creation_time": "2003-07-23T13:46:23Z", "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 9508, "attachment_id": null, "id": 41251, "time": "2003-07-23T17:20:37Z", "creator": "gturner@unzane.com", "creation_time": "2003-07-23T17:20:37Z", "is_private": false, "text": "Thanks for the explanation.  I did some further investigation of source code\nfor XDoclet, Ant 1.5.3 and HEAD.  Indeed XDoclet uses the DynamicConfigurator\ninterface and defines \"deploymentdescriptor\" as both EjbDotXmlSubTask and\nWebXmlSubTask classes.  Ant uses a Hashtable of \"name\" => Class.  Oh well."}]