[{"count": 0, "tags": [], "bug_id": 26848, "attachment_id": null, "text": "Trying to create an external graphics using a PNG file does not works if you \nwant to use JIMI instead JAI.\n\nLocation:\n\nclass::org.apache.fop.image.FopImageFactory\nmethod::getGenericImageClassName\n\nYou catch an Exception when configuring m_genericImageClassName field. If you \nhave configured JIMI in your classpath instead JAI it throws an Error:\n\njava.lang.NoClassDefFoundError: javax/media/jai/PlanarImage\n\tat java.lang.Class.forName0(Native Method)\n\tat java.lang.Class.forName(Class.java:141)\n\tat org.apache.fop.image.FopImageFactory.getGenericImageClassName\n(FopImageFactory.java:236)\n\tat org.apache.fop.image.FopImageFactory.Make(FopImageFactory.java:163)\n...\n...\n\nIn this scenario you cannot use FOP to render a PNG file. To solve this BUG you \nmust catch Throwable instead Exception.\n\nA workaround is to set m_genericImageClassName \nto \"org.apache.fop.image.JimiImage\" via java.lang.reflect package before you \ncall FOP.\n\nBye.\n\nThanks.", "id": 52095, "time": "2004-02-11T09:54:36Z", "creator": "joaquin.sanchez@fi2net.com", "creation_time": "2004-02-11T09:54:36Z", "is_private": false}, {"count": 1, "tags": [], "creator": "j3322ptm@yahoo.de", "attachment_id": null, "text": "*** Bug 26847 has been marked as a duplicate of this bug. ***", "id": 52171, "time": "2004-02-12T00:08:03Z", "bug_id": 26848, "creation_time": "2004-02-12T00:08:03Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 26848, "attachment_id": null, "text": "Solution:\n\n    private static String getGenericImageClassName() {\n\n        if (m_genericImageClassName == null) {\n            try {\n                Class.forName(\"org.apache.fop.image.JAIImage\");\n                m_genericImageClassName = \"org.apache.fop.image.JAIImage\";\n            } catch (Throwable ex) {\n                /* on any exception assume Jai is not present and use Jimi \ninstead */\n                m_genericImageClassName = \"org.apache.fop.image.JimiImage\";\n            }\n        }\n        return m_genericImageClassName;\n    }\n\nWorkaround:\n\n    public static String checkFOP() {\n\n        try {\n            FopImageFactory.Make(PDFGenerator.class.getResource(\"blank.png\");\n            return \"png\"; \n        } catch (Throwable t) {\n            try {\n                // trying to set by hand Bug#: 26848 from FOP\n                Class clazz = Class.forName\n(\"org.apache.fop.image.FopImageFactory\");\n                java.lang.reflect.Field field = clazz.getDeclaredField\n(\"m_genericImageClassName\");\n                field.setAccessible(true);\n                field.set(null, \"org.apache.fop.image.JimiImage\");\n                FopImageFactory.Make(PDFGenerator.class.getResource\n(\"blank.png\");\n                return \"png\"; \n            } catch (Throwable _t) {\n                return \"jpeg\"; \n            }\n        }\n    }\n\n", "id": 52175, "time": "2004-02-12T07:46:14Z", "creator": "joaquin.sanchez@fi2net.com", "creation_time": "2004-02-12T07:46:14Z", "is_private": false}, {"count": 3, "tags": [], "creator": "gadams@apache.org", "attachment_id": null, "text": "jimi is no longer supported", "id": 157614, "time": "2012-04-07T04:27:10Z", "bug_id": 26848, "creation_time": "2012-04-07T04:27:10Z", "is_private": false}, {"count": 4, "tags": [], "creator": "gadams@apache.org", "attachment_id": null, "text": "batch transition resolved+wontfix to closed+wontfix", "id": 158562, "time": "2012-04-30T00:14:41Z", "bug_id": 26848, "creation_time": "2012-04-30T00:14:41Z", "is_private": false}, {"count": 5, "tags": [], "creator": "gadams@apache.org", "attachment_id": null, "is_private": false, "id": 158607, "time": "2012-04-30T00:17:13Z", "bug_id": 26848, "creation_time": "2012-04-30T00:17:13Z", "text": "batch transition resolved+wontfix to closed+wontfix; if you believe this remains a bug and can demonstrate it with appropriate input FO file and output PDF file (as applicable), then you may reopen"}]