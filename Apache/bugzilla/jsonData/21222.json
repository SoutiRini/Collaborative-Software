[{"count": 0, "tags": [], "bug_id": 21222, "attachment_id": null, "is_private": false, "id": 39737, "time": "2003-07-01T12:50:23Z", "creator": "glenn@apache.org", "creation_time": "2003-07-01T12:50:23Z", "text": "We have two Sun E450's, dual CPU, running Solaris 7 and Apache 2.0.46\nwith the worker MPM.  Apache 2 is compiled with CC from Sun WorkShop 5.\n\nThe two servers combined serve about 1 - 1.5 million page views per month.\nIn the past three weeks since I have enabled core files.  During that time\nI have had about a dozen child processes die with the following backtrace:\n\nterminated by signal SEGV (no mapping at the fault address)\ncurrent thread: t@14\n=>[1] apr_thread_mutex_lock(mutex = 0x2), line 133 in \"thread_mutex.c\"\n  [2] apr_file_read(thefile = 0x33af58, buf = 0x2ac650, nbytes = 0xfd0071fc),\nline 86 in \"readwrite.c\"\n  [3] pipe_bucket_read(a = 0x21fd70, str = 0xfd007200, len = 0xfd0071fc, block =\nAPR_BLOCK_READ), line 74 in \"apr_buckets_pipe.c\"\n  [4] apr_brigade_length(bb = 0x2f6ac8, read_all = 1, length = 0xfd0072a0), line\n215 in \"apr_brigade.c\"\n  [5] ap_byterange_filter(f = 0x2f3818, bb = 0x2f6ac8), line 2931 in\n\"http_protocol.c\"\n  [6] ap_pass_brigade(next = 0x2f3818, bb = 0x2f6ac8), line 550 in \"util_filter.c\"\n  [7] send_parsed_content(bb = 0xfd007890, r = 0x2f2bc0, f = 0x33a5b8), line\n3213 in \"mod_include.c\"\n  [8] includes_filter(f = 0x33a5b8, b = 0x2f6ac8), line 3430 in \"mod_include.c\"\n  [9] ap_pass_brigade(next = 0x33a5b8, bb = 0x2f5c20), line 550 in \"util_filter.c\"\n  [10] default_handler(r = 0x2f2bc0), line 3419 in \"core.c\"\n  [11] ap_run_handler(0x2f2bc0, 0x3b, 0x2f2bc0, 0x2e8c58, 0x0, 0x0), at 0x7fab8\n  [12] ap_invoke_handler(r = 0x2f2bc0), line 401 in \"config.c\"\n  [13] ap_process_request(r = 0x2f2bc0), line 288 in \"http_request.c\"\n  [14] ap_process_http_connection(c = 0x2e8c58), line 293 in \"http_core.c\"\n  [15] ap_run_process_connection(0x2e8c58, 0x2e8b98, 0x2e8b98, 0x9, 0x2e8c50,\n0x21fbc0), at 0x95b80\n  [16] ap_process_connection(c = 0x2e8c58, csd = 0x2e8b98), line 211 in\n\"connection.c\"\n  [17] process_socket(p = 0x2e8b60, sock = 0x2e8b98, my_child_num = 0,\nmy_thread_num = 9, bucket_alloc = 0x21fbc0), line 632 in \"worker.c\"\n  [18] worker_thread(thd = 0x1aa530, dummy = 0x1e75b8), line 947 in \"worker.c\"\n  [19] dummy_worker(opaque = 0x1aa530), line 127 in \"thread.c\"\n\nI have also seen the following backtrace several times, it may be related\nto the one above.\n\nterminated by signal SEGV (no mapping at the fault address)\ncurrent thread: t@6\n=>[1] __align_cpy_1(0x5d3401, 0x629010, 0x1f38, 0x7, 0x0, 0x5d3401), at 0xfee70718\n  [2] apr_file_read(thefile = 0x5c3318, buf = 0x5d3400, nbytes = 0xfdc071f4),\nline 122 in \"readwrite.c\"\n  [3] pipe_bucket_read(a = 0x4baa90, str = 0xfdc071f8, len = 0xfdc071f4, block =\nAPR_BLOCK_READ), line 74 in \"apr_buckets_pipe.c\"\n  [4] apr_brigade_length(bb = 0x596010, read_all = 1, length = 0xfdc07298), line\n215 in \"apr_brigade.c\"\n  [5] ap_byterange_filter(f = 0x4f1bb8, bb = 0x596010), line 2931 in\n\"http_protocol.c\"\n  [6] ap_pass_brigade(next = 0x4f1bb8, bb = 0x596010), line 550 in \"util_filter.c\"\n  [7] send_parsed_content(bb = 0xfdc07888, r = 0x4f0f60, f = 0x4ee778), line\n3213 in \"mod_include.c\"\n  [8] includes_filter(f = 0x4ee778, b = 0x596010), line 3430 in \"mod_include.c\"\n  [9] ap_pass_brigade(next = 0x4ee778, bb = 0x595218), line 550 in \"util_filter.c\"\n  [10] default_handler(r = 0x4f0f60), line 3419 in \"core.c\"\n  [11] ap_run_handler(0x4f0f60, 0x3b, 0x4f0f60, 0x4eb008, 0x0, 0x0), at 0x7fab8\n  [12] ap_invoke_handler(r = 0x4f0f60), line 401 in \"config.c\"\n  [13] ap_process_request(r = 0x4f0f60), line 288 in \"http_request.c\"\n  [14] ap_process_http_connection(c = 0x4eb008), line 293 in \"http_core.c\"\n  [15] ap_run_process_connection(0x4eb008, 0x4eaf48, 0x4eaf48, 0x41, 0x4eb000,\n0x4ba520), at 0x95b80\n  [16] ap_process_connection(c = 0x4eb008, csd = 0x4eaf48), line 211 in\n\"connection.c\"\n  [17] process_socket(p = 0x4eaf10, sock = 0x4eaf48, my_child_num = 1,\nmy_thread_num = 1, bucket_alloc = 0x4ba520), line 632 in \"worker.c\"\n  [18] worker_thread(thd = 0x17a6c0, dummy = 0x135c28), line 947 in \"worker.c\"\n  [19] dummy_worker(opaque = 0x17a6c0), line 127 in \"thread.c\"\n\nI have not been able to reproduce this on a test system yet."}, {"count": 1, "tags": [], "bug_id": 21222, "attachment_id": 7274, "is_private": false, "id": 40555, "time": "2003-07-12T21:37:36Z", "creator": "glenn@apache.org", "creation_time": "2003-07-12T21:37:36Z", "text": "Created attachment 7274\nbacktraces and request info for six mod_include core dumps."}, {"count": 2, "tags": [], "text": "Updating bug summary after attaching core dump data.", "is_private": false, "bug_id": 21222, "id": 40708, "time": "2003-07-15T11:55:25Z", "creator": "glenn@apache.org", "creation_time": "2003-07-15T11:55:25Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 21222, "attachment_id": 7436, "is_private": false, "id": 41119, "time": "2003-07-21T23:38:29Z", "creator": "jwoolley@apache.org", "creation_time": "2003-07-21T23:38:29Z", "text": "Created attachment 7436\na patch for you to try"}, {"count": 4, "tags": [], "bug_id": 21222, "is_private": false, "text": "Please try the following patch and see if you still get segfaults.  I won't be surprised if \nyou do, but I just want to be sure.  The patch one we just finished testing to fix three \nother nasty mod_include bugs. ", "id": 41120, "time": "2003-07-21T23:38:40Z", "creator": "jwoolley@apache.org", "creation_time": "2003-07-21T23:38:40Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 21222, "attachment_id": null, "is_private": false, "id": 41165, "time": "2003-07-22T14:53:28Z", "creator": "glenn@apache.org", "creation_time": "2003-07-22T14:53:28Z", "text": "Thanks for the mod_include patch.\n\nI just upgraded all of our systems to apache 2.0.47 Sunday.\nThe mod_include bugs I have seen have only occurred on 2 of our\nproduction systems, I have never been able to reproduce them on a test system.\n\nIs this patch tested well enough for production?  If so I can see what I\ncan do about scheduling another upgrade.\n\nOn another note I think that some of the child process core dumps I have\nseen may be due to a Solaris 7 libthread bug.  We found a patch which\nlooks suspiciously similar to one of the ways we have seen a child process\ndie.  This bug is related to use of the cond_* functions.\nWe have already patched one server, the other Solaris 7 systems will be\npatched in the coming weeks."}, {"count": 6, "tags": [], "bug_id": 21222, "attachment_id": null, "id": 41168, "time": "2003-07-22T15:18:58Z", "creator": "jwoolley@apache.org", "creation_time": "2003-07-22T15:18:58Z", "is_private": false, "text": "It has definitely been tested very thoroughly and is ready for production.  As \nsoon as one more person reviews it, it will be committed to the 2.0 branch for \nthe next release of 2.0.x."}, {"count": 7, "tags": [], "text": "I now have 2 test servers and 5 production servers upgraded to 2.0.47 with\nthese mod_include patches.  Time will tell whether this reduces the number\nof child processes which die.\n\nApache 2 with worker MPM for us is starting to look pretty solid.\n\nThanks for all the help resolving apache 2 with worker MPM problems.", "attachment_id": null, "id": 41648, "creator": "glenn@apache.org", "time": "2003-07-28T12:58:36Z", "bug_id": 21222, "creation_time": "2003-07-28T12:58:36Z", "is_private": false}, {"count": 8, "tags": [], "text": "I have a core dump in mod_include since applying the mod_include patches.\n\nHere is the output from the backtrace:\n\nt@11 (l@9) terminated by signal SEGV (no mapping at the fault address)\nCurrent function is add_include_vars\n  158       if ((t = strrchr(r->filename, '/'))) {\n(/opt/SUNWspro/bin/dbx) where                                                \ncurrent thread: t@11\n  [1] strrchr(0x0, 0x2f, 0xd136c, 0x0, 0x48545450, 0x2f), at 0xfeed1958\n=>[2] add_include_vars(r = 0x4f38b0, timefmt = 0xcf05c \"%A, %d-%b-%Y %H:%M:%S\n%Z\"), line 158 in \"mod_include.c\"\n  [3] includes_filter(f = 0x4f56a8, b = 0x4f56f8), line 3395 in \"mod_include.c\"\n  [4] ap_pass_brigade(next = 0x4f56a8, bb = 0x4f56f8), line 550 in \"util_filter.c\"\n  [5] ap_old_write_filter(f = 0x4f56e0, bb = 0x4f56f8), line 1321 in \"protocol.c\"\n  [6] ap_pass_brigade(next = 0x4f56e0, bb = 0x4f57d0), line 550 in \"util_filter.c\"\n  [7] end_output_stream(r = 0x4f38b0), line 1039 in \"protocol.c\"\n  [8] ap_finalize_request_protocol(r = 0x4f38b0), line 1061 in \"protocol.c\"\n  [9] ap_send_error_response(r = 0x4f38b0, recursive_error = 0), line 2423 in\n\"http_protocol.c\"\n  [10] ap_die(type = 301, r = 0x4f38b0), line 232 in \"http_request.c\"\n  [11] ap_process_request(r = 0x4f38b0), line 301 in \"http_request.c\"\n  [12] ap_process_http_connection(c = 0x4dd8a8), line 293 in \"http_core.c\"\n  [13] ap_run_process_connection(0x4dd8a8, 0x4dd7e8, 0x4dd7e8, 0x6, 0x4dd8a0,\n0x48cc60), at 0x82dc0\n  [14] ap_process_connection(c = 0x4dd8a8, csd = 0x4dd7e8), line 211 in\n\"connection.c\"\n  [15] process_socket(p = 0x4dd7b0, sock = 0x4dd7e8, my_child_num = 0,\nmy_thread_num = 6, bucket_alloc = 0x48cc60), line 632 in \"worker.c\"\n  [16] worker_thread(thd = 0x11a530, dummy = 0xd59c8), line 947 in \"worker.c\"\n  [17] dummy_worker(opaque = 0x11a530), line 127 in \"thread.c\"\n\nLet me know if you need any more information from the core dump.", "attachment_id": null, "id": 41656, "creator": "glenn@apache.org", "time": "2003-07-28T14:33:28Z", "bug_id": 21222, "creation_time": "2003-07-28T14:33:28Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 21222, "attachment_id": null, "id": 41657, "time": "2003-07-28T14:38:51Z", "creator": "nd@perlig.de", "creation_time": "2003-07-28T14:38:51Z", "is_private": false, "text": "huh, do I read right, that r->filename is NULL?"}, {"count": 10, "tags": [], "bug_id": 21222, "attachment_id": null, "is_private": false, "id": 41771, "time": "2003-07-30T13:29:19Z", "creator": "glenn@apache.org", "creation_time": "2003-07-30T13:29:19Z", "text": "Yeah, thats what it looks like in the strrchr method call.\nBut it doesn't look like it is empty from examining the recquest_rec.\nHere is a more complete backtrace with a dump of the request req and\nthe filename.\n\nt@11 (l@9) terminated by signal SEGV (no mapping at the fault address)\nCurrent function is add_include_vars\n  158       if ((t = strrchr(r->filename, '/'))) {\n(/opt/SUNWspro/bin/dbx) where                                                \ncurrent thread: t@11\n  [1] strrchr(0x0, 0x2f, 0xd136c, 0x0, 0x48545450, 0x2f), at 0xfeed1958\n=>[2] add_include_vars(r = 0x4f38b0, timefmt = 0xcf05c \"%A, %d-%b-%Y %H:%M:%S\n%Z\"), line 158 in \"mod_include.c\"\n  [3] includes_filter(f = 0x4f56a8, b = 0x4f56f8), line 3395 in \"mod_include.c\"\n  [4] ap_pass_brigade(next = 0x4f56a8, bb = 0x4f56f8), line 550 in \"util_filter.c\"\n  [5] ap_old_write_filter(f = 0x4f56e0, bb = 0x4f56f8), line 1321 in \"protocol.c\"\n  [6] ap_pass_brigade(next = 0x4f56e0, bb = 0x4f57d0), line 550 in \"util_filter.c\"\n  [7] end_output_stream(r = 0x4f38b0), line 1039 in \"protocol.c\"\n  [8] ap_finalize_request_protocol(r = 0x4f38b0), line 1061 in \"protocol.c\"\n  [9] ap_send_error_response(r = 0x4f38b0, recursive_error = 0), line 2423 in\n\"http_protocol.c\"\n  [10] ap_die(type = 301, r = 0x4f38b0), line 232 in \"http_request.c\"\n  [11] ap_process_request(r = 0x4f38b0), line 301 in \"http_request.c\"\n  [12] ap_process_http_connection(c = 0x4dd8a8), line 293 in \"http_core.c\"\n  [13] ap_run_process_connection(0x4dd8a8, 0x4dd7e8, 0x4dd7e8, 0x6, 0x4dd8a0,\n0x48cc60), at 0x82dc0\n  [14] ap_process_connection(c = 0x4dd8a8, csd = 0x4dd7e8), line 211 in\n\"connection.c\"\n  [15] process_socket(p = 0x4dd7b0, sock = 0x4dd7e8, my_child_num = 0,\nmy_thread_num = 6, bucket_alloc = 0x48cc60), line 632 in \"worker.c\"\n  [16] worker_thread(thd = 0x11a530, dummy = 0xd59c8), line 947 in \"worker.c\"\n  [17] dummy_worker(opaque = 0x11a530), line 127 in \"thread.c\"\n(/opt/SUNWspro/bin/dbx) examine 0x4f38b0,0x4f39f0\n0x004f38b0:      0x004f3878 0x004dd8a8 0x00359840 0x00000000\n0x004f38c0:      0x00000000 0x00000000 0x004f4578 0x00000000\n0x004f38d0:      0x00000000 0x00000000 0x004f4618 0x000003e8\n0x004f38e0:      0x004f4d58 0x00000000 0x0003c375 0xce368320\n0x004f38f0:      0x00000000 0x0000012d 0x004f45c8 0x00000002\n0x004f3900:      0x00000000 0x00000000 0x00000000 0x004f3a38\n0x004f3910:      0x00000000 0x00000000 0x00000000 0x00000000\n0x004f3920:      0x00000000 0x00000000 0x00000000 0x00000000\n0x004f3930:      0x00000000 0x00000000 0x00000000 0x00000000\n0x004f3940:      0x004f3a68 0x004f40a0 0x004f3ef8 0x004f3cb0\n0x004f3950:      0x004f41f8 0x000aef00 0x00000000 0x00000000\n0x004f3960:      0x00000000 0x00000000 0x00000000 0x00000000\n0x004f3970:      0x00000000 0x00000000 0x004f45e8 0x004f4600\n0x004f3980:      0x00000000 0x00000000 0x00000000 0x00000000\n0x004f3990:      0x00000000 0x00000000 0x00000000 0x00000000\n0x004f39a0:      0x00000000 0x00000000 0x00000000 0x00000000\n0x004f39b0:      0x00000000 0x00000000 0x00000000 0x00000000\n0x004f39c0:      0x00000000 0x00000000 0x00000000 0x00000000\n0x004f39d0:      0x00000000 0x00000000 0x00000000 0x00000000\n0x004f39e0:      0x00000000 0x00000000 0x00000000 0x00000000\n0x004f39f0:      0x00000000\n(/opt/SUNWspro/bin/dbx) examine 0x004f45e8,0x004f4620 /c\n0x004f45e8:      '/' 'c' 'g' 'i' '-' 'b' 'i' 'n' '/' 'F' 'o' 'r' 'm' 'M' 'a' 'i'\n0x004f45f8:      'l' '.' 'p' 'l' '\\0' 'w' 'w' '.' '/' 'c' 'g' 'i' '-' 'b' 'i' 'n'\n0x004f4608:      '/' 'F' 'o' 'r' 'm' 'M' 'a' 'i' 'l' '.' 'p' 'l' '\\0' 'k' '-' 'c'\n0x004f4618:      'H' 'T' 'T' 'P' '/' '1' '.' '0' '\\0'\n(/opt/SUNWspro/bin/dbx) \n\n\nI have had another child die since applying the mod_include patch to 2.0.47,\nhere is the backtrace:\n\nt@5 (l@13) terminated by signal SEGV (no mapping at the fault address)\nCurrent function is apr_thread_mutex_lock\n  110       if (mutex->nested) {\n(/opt/SUNWspro/bin/dbx) where                                                \ncurrent thread: t@5\n=>[1] apr_thread_mutex_lock(mutex = 0x1), line 110 in \"thread_mutex.c\"\n  [2] apr_file_read(thefile = 0x36aea0, buf = 0x373870, nbytes = 0xfdd091fc),\nline 86 in \"readwrite.c\"\n  [3] pipe_bucket_read(a = 0x1b6898, str = 0xfdd09200, len = 0xfdd091fc, block =\nAPR_BLOCK_READ), line 74 in \"apr_buckets_pipe.c\"\n  [4] apr_brigade_length(bb = 0x33add8, read_all = 1, length = 0xfdd092a0), line\n215 in \"apr_brigade.c\"\n  [5] ap_byterange_filter(f = 0x3382b0, bb = 0x33add8), line 2931 in\n\"http_protocol.c\"\n  [6] ap_pass_brigade(next = 0x3382b0, bb = 0x33add8), line 550 in \"util_filter.c\"\n  [7] send_parsed_content(bb = 0xfdd09890, r = 0x337658, f = 0x336f50), line\n3209 in \"mod_include.c\"\n  [8] includes_filter(f = 0x336f50, b = 0x33add8), line 3426 in \"mod_include.c\"\n  [9] ap_pass_brigade(next = 0x336f50, bb = 0x33a4e8), line 550 in \"util_filter.c\"\n  [10] default_handler(r = 0x337658), line 3558 in \"core.c\"\n  [11] ap_run_handler(0x337658, 0x3b, 0x337658, 0x333708, 0x0, 0x0), at 0x717b0\n  [12] ap_invoke_handler(r = 0x337658), line 401 in \"config.c\"\n  [13] ap_process_request(r = 0x337658), line 288 in \"http_request.c\"\n  [14] ap_process_http_connection(c = 0x333708), line 293 in \"http_core.c\"\n  [15] ap_run_process_connection(0x333708, 0x333648, 0x333648, 0x80, 0x333700,\n0x1b6288), at 0x87878\n  [16] ap_process_connection(c = 0x333708, csd = 0x333648), line 211 in\n\"connection.c\"\n  [17] process_socket(p = 0x333610, sock = 0x333648, my_child_num = 2,\nmy_thread_num = 0, bucket_alloc = 0x1b6288), line 632 in \"worker.c\"\n  [18] worker_thread(thd = 0x152e58, dummy = 0x193968), line 947 in \"worker.c\"\n  [19] dummy_worker(opaque = 0x152e58), line 127 in \"thread.c\"\n"}, {"count": 11, "tags": [], "text": "r->filename is at offset 0xd0, right*?  And in your request_rec, that is\n\n0x004f3980:      0x00000000\n\nso yes, NULL is getting passed to strrchr().\n\nThe field you're formatting is at offset 0xc8, which for me is unparsed_uri.\nAnd it looks more like a uri than a filename.\n\n*0xd0 is the offset on my 32-bit non-largefile-support Solaris 8 build.\n\nGrab \n\nhttp://www.apache.org/~trawick/offsets.c\n\nand build it like this to verify the offset:\n\napxs -c -p -o offsets offsets.c\n\nBack to the big picture:\n\nThis patch ought to keep add_include_vars from searching r->filename string when\nit isn't even set:\n\n--- modules/filters/mod_include.c       30 Jul 2003 10:53:10 -0000      1.2\n+++ modules/filters/mod_include.c       30 Jul 2003 14:02:19 -0000\n@@ -155,7 +155,7 @@\n         apr_table_setn(e, \"DOCUMENT_PATH_INFO\", r->path_info);\n     }\n     apr_table_setn(e, \"USER_NAME\", LAZY_VALUE);\n-    if ((t = strrchr(r->filename, '/'))) {\n+    if (r->filename && (t = strrchr(r->filename, '/'))) {\n         apr_table_setn(e, \"DOCUMENT_NAME\", ++t);\n     }\n     else {\n", "is_private": false, "bug_id": 21222, "id": 41775, "time": "2003-07-30T14:13:11Z", "creator": "trawick@apache.org", "creation_time": "2003-07-30T14:13:11Z", "attachment_id": null}, {"count": 12, "tags": [], "bug_id": 21222, "attachment_id": null, "is_private": false, "id": 41843, "time": "2003-07-31T12:03:29Z", "creator": "glenn@apache.org", "creation_time": "2003-07-31T12:03:29Z", "text": "Thanks for the info on the offsets.  Based on the request_rec data structure\nI was guessing. ;-)\n\nWill the mod_include_vars patch be in the 2.0.48 release?\n\nHere is the data for another child process which died, the CGI\nbeing executed was the HtDig htsearch cgi /cgi/htsearch.cgi .\n\nt@11 (l@8) terminated by signal ILL (illegal opcode)\nCurrent function is send_parsed_content\n 3159                       apr_bucket_delete(tmp_bkt);\n(/opt/SUNWspro/bin/dbx) where                                                \ncurrent thread: t@11\n  [1] 0x1c2460(0xff317ad8, 0xfd30b860, 0x2a12a8, 0x327cd8, 0x1c2a88,\n0xfd30b784), at 0x1c245f\n=>[2] send_parsed_content(bb = 0xfd30b860, r = 0x2a12a8, f = 0x327cd8), line\n3159 in \"mod_include.c\"\n  [3] includes_filter(f = 0x327cd8, b = 0x3284b8), line 3426 in \"mod_include.c\"\n  [4] ap_pass_brigade(next = 0x327cd8, bb = 0x3279d8), line 550 in \"util_filter.c\"\n  [5] cgid_handler(r = 0x2a12a8), line 1483 in \"mod_cgid.c\"\n  [6] ap_run_handler(0x2a12a8, 0x0, 0x2a12a8, 0x29d358, 0x0, 0x0), at 0x717b0\n  [7] ap_invoke_handler(r = 0x2a12a8), line 401 in \"config.c\"\n  [8] ap_process_request(r = 0x2a12a8), line 288 in \"http_request.c\"\n  [9] ap_process_http_connection(c = 0x29d358), line 293 in \"http_core.c\"\n  [10] ap_run_process_connection(0x29d358, 0x29d298, 0x29d298, 0x6, 0x29d350,\n0x1c2478), at 0x87878\n  [11] ap_process_connection(c = 0x29d358, csd = 0x29d298), line 211 in\n\"connection.c\"\n  [12] process_socket(p = 0x29d260, sock = 0x29d298, my_child_num = 0,\nmy_thread_num = 6, bucket_alloc = 0x1c2478), line 632 in \"worker.c\"\n  [13] worker_thread(thd = 0x152f18, dummy = 0x195748), line 947 in \"worker.c\"\n  [14] dummy_worker(opaque = 0x152f18), line 127 in \"thread.c\"\n\n"}, {"count": 13, "tags": [], "bug_id": 21222, "attachment_id": null, "id": 41954, "time": "2003-08-01T13:51:50Z", "creator": "glenn@apache.org", "creation_time": "2003-08-01T13:51:50Z", "is_private": false, "text": "Another child process has died, the request was for /cgi/htesarch.cgi,\nhere is the backtrace:\n\nt@24 (l@11) terminated by signal SEGV (no mapping at the fault address)\nCurrent function is core_output_filter\n 3926                   rv = apr_bucket_read(e, &str, &n, eblock);\n(/opt/SUNWspro/bin/dbx) where                                                \ncurrent thread: t@24\n  [1] 0x50(0x2e64d4, 0xfc200ea8, 0xfc200ea4, 0x1, 0xf, 0xfc200fd4), at 0x4f\n=>[2] core_output_filter(f = 0x2df850, b = 0x2e1458), line 3926 in \"core.c\"\n  [3] ap_pass_brigade(next = 0x2df850, bb = 0x2e6490), line 550 in \"util_filter.c\"\n  [4] chunk_filter(f = 0x2e6360, b = 0x2e6490), line 260 in \"http_core.c\"\n  [5] ap_pass_brigade(next = 0x2e6360, bb = 0x2e6490), line 550 in \"util_filter.c\"\n  [6] ap_content_length_filter(f = 0x2f40f0, b = 0x2e6490), line 1215 in\n\"protocol.c\"\n  [7] ap_pass_brigade(next = 0x2f40f0, bb = 0x2e6490), line 550 in \"util_filter.c\"\n  [8] handle_include(ctx = 0x2df8b0, bb = 0xfc201860, r = 0x2f3480, f =\n0x2e5b98, head_ptr = 0x1dcb50, inserted_head = 0xfc201784), line 1252 in\n\"mod_include.c\"\n  [9] send_parsed_content(bb = 0xfc201860, r = 0x2f3480, f = 0x2e5b98), line\n3118 in \"mod_include.c\"\n  [10] includes_filter(f = 0x2e5b98, b = 0x2e6490), line 3426 in \"mod_include.c\"\n  [11] ap_pass_brigade(next = 0x2e5b98, bb = 0x2e5898), line 550 in \"util_filter.c\"\n  [12] cgid_handler(r = 0x2f3480), line 1483 in \"mod_cgid.c\"\n  [13] ap_run_handler(0x2f3480, 0x0, 0x2f3480, 0x2df4f0, 0x0, 0x0), at 0x717b0\n  [14] ap_invoke_handler(r = 0x2f3480), line 401 in \"config.c\"\n  [15] ap_process_request(r = 0x2f3480), line 288 in \"http_request.c\"\n  [16] ap_process_http_connection(c = 0x2df4f0), line 293 in \"http_core.c\"\n  [17] ap_run_process_connection(0x2df4f0, 0x2df430, 0x2df430, 0x93, 0x2df4e8,\n0x1dca90), at 0x87878\n  [18] ap_process_connection(c = 0x2df4f0, csd = 0x2df430), line 211 in\n\"connection.c\"\n  [19] process_socket(p = 0x2df3f8, sock = 0x2df430, my_child_num = 2,\nmy_thread_num = 19, bucket_alloc = 0x1dca90), line 632 in \"worker.c\"\n  [20] worker_thread(thd = 0x1530b8, dummy = 0x196a28), line 947 in \"worker.c\"\n  [21] dummy_worker(opaque = 0x1530b8), line 127 in \"thread.c\"\n"}, {"count": 14, "tags": [], "bug_id": 21222, "is_private": false, "text": "I have had three child processes die with the following back trace.\n\nAll three were handling the request for \"/\" on the same server.\n\nt@5 (l@12) terminated by signal SEGV (no mapping at the fault address)\nCurrent function is apr_thread_mutex_lock\n  110       if (mutex->nested) {\n(/opt/SUNWspro/bin/dbx) where                                                \ncurrent thread: t@5\n=>[1] apr_thread_mutex_lock(mutex = 0x2e687461), line 110 in \"thread_mutex.c\"\n  [2] apr_file_read(thefile = 0x58b148, buf = 0x65a0a0, nbytes = 0xfe9091f4),\nline 86 in \"readwrite.c\"\n  [3] pipe_bucket_read(a = 0x4811a0, str = 0xfe9091f8, len = 0xfe9091f4, block =\nAPR_BLOCK_READ), line 74 in \"apr_buckets_pipe.c\"\n  [4] apr_brigade_length(bb = 0x562350, read_all = 1, length = 0xfe909298), line\n215 in \"apr_brigade.c\"\n  [5] ap_byterange_filter(f = 0x55f6b0, bb = 0x562350), line 2931 in\n\"http_protocol.c\"\n  [6] ap_pass_brigade(next = 0x55f6b0, bb = 0x562350), line 550 in \"util_filter.c\"\n  [7] send_parsed_content(bb = 0xfe909888, r = 0x55ea58, f = 0x517170), line\n3209 in \"mod_include.c\"\n  [8] includes_filter(f = 0x517170, b = 0x562350), line 3426 in \"mod_include.c\"\n  [9] ap_pass_brigade(next = 0x517170, bb = 0x5619e8), line 550 in \"util_filter.c\"\n  [10] default_handler(r = 0x55ea58), line 3558 in \"core.c\"\n  [11] ap_run_handler(0x55ea58, 0x3b, 0x55ea58, 0x5099c8, 0x0, 0x0), at 0x6ccf8\n  [12] ap_invoke_handler(r = 0x55ea58), line 401 in \"config.c\"\n  [13] ap_process_request(r = 0x55ea58), line 288 in \"http_request.c\"\n  [14] ap_process_http_connection(c = 0x5099c8), line 293 in \"http_core.c\"\n  [15] ap_run_process_connection(0x5099c8, 0x509908, 0x509908, 0x40, 0x5099c0,\n0x480a00), at 0x82dc0\n  [16] ap_process_connection(c = 0x5099c8, csd = 0x509908), line 211 in\n\"connection.c\"\n  [17] process_socket(p = 0x5098d0, sock = 0x509908, my_child_num = 1,\nmy_thread_num = 0, bucket_alloc = 0x480a00), line 632 in \"worker.c\"\n  [18] worker_thread(thd = 0x11a470, dummy = 0x46a4a0), line 947 in \"worker.c\"\n  [19] dummy_worker(opaque = 0x11a470), line 127 in \"thread.c\"\n\n\n", "id": 42157, "time": "2003-08-05T13:42:21Z", "creator": "glenn@apache.org", "creation_time": "2003-08-05T13:42:21Z", "attachment_id": null}, {"count": 15, "tags": [], "bug_id": 21222, "attachment_id": null, "is_private": false, "id": 42179, "time": "2003-08-05T17:14:45Z", "creator": "jwoolley@apache.org", "creation_time": "2003-08-05T17:14:45Z", "text": "Can you email me one of those core files and the corresponding httpd binary?  \nI'll see if I can get them to load up in gdb on my Solaris box.  It might not \n(due to various version mismatches), but I'll give it a shot."}, {"count": 16, "tags": [], "text": "I will tar up the binary and core file and email it to you for the\ncore dump you are interested in.\n\nHere is another mod_include related backtrace:\n\nt@19 (l@8) terminated by signal SEGV (no mapping at the fault address)\nCurrent function is apr_thread_mutex_lock\n  110       if (mutex->nested) {\n(/opt/SUNWspro/bin/dbx) where                                                \ncurrent thread: t@19\n=>[1] apr_thread_mutex_lock(mutex = 0x702f7777), line 110 in \"thread_mutex.c\"\n  [2] apr_file_read(thefile = 0x2d4ad8, buf = 0x3b3ad0, nbytes = 0xfc70d1fc),\nline 86 in \"readwrite.c\"\n  [3] pipe_bucket_read(a = 0x1d3208, str = 0xfc70d200, len = 0xfc70d1fc, block =\nAPR_BLOCK_READ), line 74 in \"apr_buckets_pipe.c\"\n  [4] apr_brigade_length(bb = 0x31f008, read_all = 1, length = 0xfc70d2a0), line\n215 in \"apr_brigade.c\"\n  [5] ap_byterange_filter(f = 0x31c340, bb = 0x31f008), line 2931 in\n\"http_protocol.c\"\n  [6] ap_pass_brigade(next = 0x31c340, bb = 0x31f008), line 550 in \"util_filter.c\"\n  [7] send_parsed_content(bb = 0xfc70d890, r = 0x31b6e8, f = 0x31e180), line\n3209 in \"mod_include.c\"\n  [8] includes_filter(f = 0x31e180, b = 0x31f008), line 3426 in \"mod_include.c\"\n  [9] ap_pass_brigade(next = 0x31e180, bb = 0x31e4b8), line 550 in \"util_filter.c\"\n  [10] default_handler(r = 0x31b6e8), line 3558 in \"core.c\"\n  [11] ap_run_handler(0x31b6e8, 0x3b, 0x31b6e8, 0x2d14c0, 0x0, 0x0), at 0x717b0\n  [12] ap_invoke_handler(r = 0x31b6e8), line 401 in \"config.c\"\n  [13] ap_process_request(r = 0x31b6e8), line 288 in \"http_request.c\"\n  [14] ap_process_http_connection(c = 0x2d14c0), line 293 in \"http_core.c\"\n  [15] ap_run_process_connection(0x2d14c0, 0x2d1400, 0x2d1400, 0xe, 0x2d14b8,\n0x1d2838), at 0x87878\n  [16] ap_process_connection(c = 0x2d14c0, csd = 0x2d1400), line 211 in\n\"connection.c\"\n  [17] process_socket(p = 0x2d13c8, sock = 0x2d1400, my_child_num = 0,\nmy_thread_num = 14, bucket_alloc = 0x1d2838), line 632 in \"worker.c\"\n  [18] worker_thread(thd = 0x153018, dummy = 0x1918b8), line 947 in \"worker.c\"\n  [19] dummy_worker(opaque = 0x153018), line 127 in \"thread.c\"\n", "is_private": false, "bug_id": 21222, "id": 42330, "time": "2003-08-07T14:08:55Z", "creator": "glenn@apache.org", "creation_time": "2003-08-07T14:08:55Z", "attachment_id": null}, {"count": 17, "tags": [], "text": "Since I upgraded to 2.0.47 with the mod_include patches applied I am\nseeing significantly more child processes die than before.\n\nI will wait until the current mod_include rewrite is done and ready for\nproduction before following up on this anymore.", "attachment_id": null, "id": 42934, "creator": "glenn@apache.org", "time": "2003-08-18T18:39:28Z", "bug_id": 21222, "creation_time": "2003-08-18T18:39:28Z", "is_private": false}, {"count": 18, "tags": [], "text": "The rewrite will be included in 2.0.49. So hopefully you're dying children will\nbe history then... .-)", "is_private": false, "bug_id": 21222, "id": 52753, "time": "2004-02-21T19:26:56Z", "creator": "nd@perlig.de", "creation_time": "2004-02-21T19:26:56Z", "attachment_id": null}, {"count": 19, "tags": [], "bug_id": 21222, "attachment_id": null, "is_private": false, "id": 56128, "time": "2004-04-20T20:03:03Z", "creator": "nd@perlig.de", "creation_time": "2004-04-20T20:03:03Z", "text": "Assuming fixed."}]