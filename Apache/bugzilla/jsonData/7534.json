[{"count": 0, "tags": [], "creator": "osvaldo@visionnaire.com.br", "attachment_id": null, "id": 12417, "time": "2002-03-27T20:00:43Z", "bug_id": 7534, "creation_time": "2002-03-27T20:00:43Z", "is_private": false, "text": "I got the following error with Tomcat 4.0.4-b2, testing Coyote:\n\njava.lang.StackOverflowError\n        at org.apache.coyote.http11.filters.ChunkedOutputFilter.doWrite(ChunkedO\nutputFilter.java:166)\n        at org.apache.coyote.http11.filters.ChunkedOutputFilter.doWrite(ChunkedO\nutputFilter.java:166)\n(...)\n\nImmediately, other stack dump appears in the console, should be caused by the \nstack overflow problem:\n\nSEVERE: Error finishing response\njava.lang.ArrayIndexOutOfBoundsException\n        at org.apache.coyote.http11.InternalOutputBuffer.addActiveFilter(Interna\nlOutputBuffer.java:274)\n        at org.apache.coyote.http11.Http11Processor.prepareResponse(Http11Proces\nsor.java:694)\n        at org.apache.coyote.http11.Http11Processor.action(Http11Processor.java:\n391)\n        at org.apache.coyote.Response.action(Response.java:205)\n        at org.apache.coyote.http11.InternalOutputBuffer.endRequest(InternalOutp\nutBuffer.java:358)\n        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java\n:354)\n        at org.apache.coyote.tomcat4.CoyoteProcessor.process(CoyoteProcessor.jav\na:791)\n        at org.apache.coyote.tomcat4.CoyoteProcessor.run(CoyoteProcessor.java:87\n0)\n        at java.lang.Thread.run(Thread.java:536)\n\nThis only happened once, without apparent cause, and Tomcat keeps running \nsmoothly afterwards.  Couldn't find how to reproduce it.\n\nTrying to guess from the source, in ChunkedOutputFilter.java:166 -\n> \"buffer.doWrite(chunkHeader);\" it seems the problem is related to a cycle in \nthe linked list of filter pointers, and these are being updated by \naddActiveFilter().  It's very likely a race bug, so the difficulty to reproduce \n(when I did it, I was accessing my web-app pages immediately after starting \nTomcat, and maybe some initialization was still running in parallel, which is \nlikely because I have Cocoon installed in this Tomcat setup, addition to my web-\napp)."}, {"count": 1, "attachment_id": null, "creator": "remm@apache.org", "text": "This is not a race (as only one thread is handling the connection). I think I \nsaw this bug just once also. I'm aware that in rare cases where there would be \nan exception during the processing, the filter state could be invalid (and if \nit is, it could lead to those stack traces). I'm trying to find how to \nreproduce it.\nIt's indeed non fatal, and won't cause any further problems at all.", "id": 12436, "time": "2002-03-28T00:06:37Z", "bug_id": 7534, "creation_time": "2002-03-28T00:06:37Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 7534, "is_private": false, "text": "I have put in a fix in CVS. I'll revise my statement on the bug, as this is not \nthe issue I ran into before (I probably did fix it when I removed most of the \ndebug stack traces). I have not been able to reproduce it (I tried requests \nwhile TC was starting), but I have added some code to make the addActiveFilter \nalgorithm more robust, and should avoid the problem.\nThe fix will be in Coyote Beta 5 (probably coming soon, as it will include the \nmore important parameter parsing fix for the TC 4 adapter).", "id": 12442, "time": "2002-03-28T02:53:32Z", "creator": "remm@apache.org", "creation_time": "2002-03-28T02:53:32Z", "attachment_id": null}, {"count": 3, "attachment_id": null, "bug_id": 7534, "text": "*** Bug 7692 has been marked as a duplicate of this bug. ***", "id": 12706, "time": "2002-04-02T19:15:50Z", "creator": "remm@apache.org", "creation_time": "2002-04-02T19:15:50Z", "tags": [], "is_private": false}]