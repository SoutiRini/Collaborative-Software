[{"attachment_id": null, "tags": [], "bug_id": 25676, "is_private": false, "count": 0, "id": 49481, "time": "2003-12-20T20:44:22Z", "creator": "agilejava@hotmail.com", "creation_time": "2003-12-20T20:44:22Z", "text": "I have two web application,one name is \"/one\" and other is \"/two\".\n\nNow,one servlet named \"test0\" in \"/one\" will request the servlet named \"test2\" \nin \"/two\",the code is :\n\nServletContext sc = request.getSession().getServletContext().getContext(\"/two\");\nsc.getRequestDispatcher(\"/test2\").forward(request,response);\n\nand there are codes in servlet \"test2\" :\n\nrequest.getSession().isNew();\n\nthen this code throw an Exception:\"session is invalidated\".I'd like to know the \nexception is right?\n\nIf it is right,but the same code worked well in Tomcat4.1.12-LE-jdk1.4. Maybe \nit is a bug!\n\nRegards."}, {"count": 1, "attachment_id": null, "bug_id": 25676, "text": "Please submit a test case.", "id": 49485, "time": "2003-12-20T22:46:17Z", "creator": "remm@apache.org", "creation_time": "2003-12-20T22:46:17Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 25676, "is_private": false, "text": "Thank you for your reply. :)\n\nHere is my test case.\n\nThe config is server.xml is:\n\n<Host name=\"www.tjsinfo.com\" className=\"org.apache.catalina.core.StandardHost\" \nautoDeploy=\"true\" configClass=\"org.apache.catalina.startup.ContextConfig\" \ncontextClass=\"org.apache.catalina.core.StandardContext\" debug=\"0\" \ndeployXML=\"true\" \nerrorReportValveClass=\"org.apache.catalina.valves.ErrorReportValve\" \nliveDeploy=\"true\" mapperClass=\"org.apache.catalina.core.StandardHostMapper\" \nunpackWARs=\"true\">           \n\n<Context className=\"org.apache.catalina.core.StandardContext\" \ncachingAllowed=\"true\" \ncharsetMapperClass=\"org.apache.catalina.util.CharsetMapper\" cookies=\"false\" \ncrossContext=\"true\" debug=\"10000\" \ndocBase=\"D:\\eclipse\\workspace\\tjsinfo\\one\" path=\"/one\" privileged=\"false\" \nreloadable=\"true\" swallowOutput=\"false\" useNaming=\"true\" \nwrapperClass=\"org.apache.catalina.core.StandardWrapper\">\t\n</Context>\n        \n<Context className=\"org.apache.catalina.core.StandardContext\" \ncachingAllowed=\"true\" \ncharsetMapperClass=\"org.apache.catalina.util.CharsetMapper\" cookies=\"false\" \ncrossContext=\"true\" debug=\"10000\" \ndocBase=\"D:\\eclipse\\workspace\\tjsinfo\\second\" path=\"/second\" privileged=\"false\" \nreloadable=\"true\" swallowOutput=\"false\" useNaming=\"true\" \nwrapperClass=\"org.apache.catalina.core.StandardWrapper\">\t\n</Context>\n</Host>\n\nThe web.xml of the context one:\n<web-app>\n<servlet>\n<servlet-name>test</servlet-name>\n<servlet-class>OneTest</servlet-class>\n</servlet>\n<servlet-mapping>\n<servlet-name>test</servlet-name>\n<url-pattern>/onetest</url-pattern>\n</servlet-mapping>    \n</web-app>\n\n\nThe web.xml of the context second:\n<web-app>\n    <servlet>\n        <servlet-name>test</servlet-name>\n        <servlet-class>TwoTest</servlet-class>\n    </servlet>\n    <servlet-mapping>\n        <servlet-name>test</servlet-name>\n        <url-pattern>/twotest</url-pattern>\n    </servlet-mapping>\n</web-app>\n\nOneTest.java:\npublic class OneTest extends HttpServlet\n{\n\tprivate ServletConfig config = null;\n\n\tpublic void init(ServletConfig config) throws ServletException\n\t{\n\t\tthis.config = config;\n\t}\n\tprotected void doGet(HttpServletRequest request,HttpServletResponse \nresponse)\n\t\tthrows ServletException, IOException\n\t{\n\t\tHttpSession session = request.getSession(true);\t\t\t\n\t\tServletContext sc = this.config.getServletContext().getContext\n(\"/second\");\t\t\t\t\n\t\tRequestDispatcher rd = sc.getRequestDispatcher(\"/twotest\");\t\n\t\trd.forward(request,response);\t\t\t\t\n\t}\n}\n\n\nTwoTest.java:\npublic class TestServlet extends HttpServlet\n{\n\tprivate ServletConfig config = null;\n\tpublic void init(ServletConfig config) throws ServletException\n\t{\n\t\tthis.config = config;\t\t\n\t}\n\n\tprotected void doGet(HttpServletRequest request,HttpServletResponse \nresponse) throws ServletException, IOException\n\t{\n\t\tSystem.out.println(\"twotest:\"+request.getSession().getId());\n                System.out.println(\"twotest:\"+session.isNew());\t\t\n\t}\t\n}\n\n\n\nIt always throws \"java.lang.IllegalStateException: isNew: Session already \ninvalidated\" when I request the uri \"http://www.tjsinfo.com:8080/one/ontest\".\n\nRegards!\n       \n\n\n", "id": 49489, "time": "2003-12-21T07:43:35Z", "creator": "agilejava@hotmail.com", "creation_time": "2003-12-21T07:43:35Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 25676, "text": "This (usurprisingly) works fine for me. I did test it with JSPs. Please do not\nreopen the issue.\n\nI will have a small update to the session handling with cross context, though.\nRight now, the session in the subcontext won't expire, and is never new either.", "id": 49497, "time": "2003-12-21T19:56:30Z", "creator": "remm@apache.org", "creation_time": "2003-12-21T19:56:30Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 25676, "is_private": false, "text": "Thank you for your reply!:)\n\nI'm sorry for breaking in on you,but the exception is throwed again!\n\nI did one test again today:\n\npublic class OneTest extends HttpServlet\n{\n        private ServletConfig config = null;\n\n\tpublic void init(ServletConfig config) throws ServletException\n\t{\n\t\tthis.config = config;\n\t}\n\tprotected void doGet(HttpServletRequest request,HttpServletResponse \nresponse)\n\t\tthrows ServletException, IOException\n\t{\n\trequest.getSession().setAttribute(\"myname\",\"agile\");\n\tServletContext sc = this.config.getServletContext().getContext\n(\"/second\");\t\t\t\t\n\tRequestDispatcher rd = sc.getRequestDispatcher(\"/twotest\");\t\t\n\trd.forward(request,response);\t\t\n}\n\t\n}\n\n\npublic class TwoServlet extends HttpServlet\n{\n\tprivate ServletConfig config = null;\n\tpublic void init(ServletConfig config) throws ServletException\n\t{\n\t\tthis.config = config;\n\t\t\n\t}\n\tprotected void doGet(HttpServletRequest request,HttpServletResponse \nresponse) throws ServletException, IOException\n\t{\n\t\tSystem.out.println(\"testServlet:\"+request.getSession().getId());\n\t\t\n\t\tHttpSession session = request.getSession();\n                \n//here,it always throw Exception:\"session is invalidated already\"\n\t\tString myname = (String)session.getAttribute(\"myname\");\t\t\n\t\tresponse.getWriter().println(\"myname:\"+myname);\t\n\t}\t\n}\n\nIt works fine for you?\n\nWhy not for me? Thanks!\n\n\n", "id": 49510, "time": "2003-12-22T02:31:21Z", "creator": "agilejava@hotmail.com", "creation_time": "2003-12-22T02:31:21Z", "attachment_id": null}, {"count": 5, "attachment_id": null, "bug_id": 25676, "text": "This works for me. I did already spend time trying to reproduce this, but\ncouldn't. If you want me to waste more time on this \"issue\", then you should\nattach two ready to run WARs to this report.\n\nAgain, please do not reopen this report. You know, not knowing how to write\nproper english, and submitting \"test cases\" which don't build, casts big doubts\non the credibility of your reports. So when I actually test them, and it works,\nthen that credibility drops to zero.", "id": 49526, "time": "2003-12-22T09:13:53Z", "creator": "remm@apache.org", "creation_time": "2003-12-22T09:13:53Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "creator": "agilejava@hotmail.com", "text": "\nThe cause about my exception is that I have used tomcat 5.0.12.The other \nrelease which is 5.0.16 did not throw this exception.\n\nI downloaded Tomcat 5.0.16 and all is right today. \n\nI'm so sorry about my mistake.\n\nThank you! \n\n", "id": 49532, "time": "2003-12-22T11:02:31Z", "bug_id": 25676, "creation_time": "2003-12-22T11:02:31Z", "is_private": false, "attachment_id": null}]