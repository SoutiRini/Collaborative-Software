[{"count": 0, "tags": [], "bug_id": 39274, "is_private": false, "text": "We are using Apache 2.0.x as a reverse proxy/SSL handler in front of back-end\nApache 1.3.x/mod_perl servers.  After a recent multi-version upgrade of our\nfront-end from 2.0.44 to 2.0.55, we found that some POST transactions were not\nworking properly.  We eventually came up with a testcase that caused problems\nconsistently, and upon monitoring the traffic between the frontend and back-end\nserver, discovered that the multipart/form-data content of the POST transaction\nwas being mangled.  Specifically, the beginning of that data disappeared, while\nthe end portion of the data remained.\n\nThis only seems to happen when the content-length reaches at least a certain\nsize - we found it at a content-length of about 3525.  At that content length,\nthe problem is fully reproducable, while shorter content lengths do not appear\nto cause the problem to appear.\n\nDowngrading to 2.0.54 resolved this issue, so I believe this is a regression\nbetween those two versions.  Several of the proxy items in the 2.0.55 changelog\nseem to relate to content-length handling, which makes them seem like likely\ncandidates for causing this problem.\n\nWe are using mod_proxy via mod_rewrite - the rewrite rule that's causing the\nproxying that exhibits this problem is:\n\n    RewriteRule ^/(.*)          http://127.0.0.1:8001/$1 [P]\n\nI assume that's not really relevant, but wanted to include it for completeness.\n\nI will attach two files after submitting this bug, the first is a capture of the\nsent request (thanks to FireFox' LiveHTTPHeaders extension, since the\ntransaction takes place over SSL), and the second is the tcpdump output showing\nthe communication between frontend and backend for that same request.\n\nLet me know if I can provide any further details to help track this down.", "id": 87781, "time": "2006-04-11T20:06:58Z", "creator": "apache@krellis.org", "creation_time": "2006-04-11T20:06:58Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 39274, "attachment_id": 18068, "is_private": false, "id": 87782, "time": "2006-04-11T20:10:00Z", "creator": "apache@krellis.org", "creation_time": "2006-04-11T20:10:00Z", "text": "Created attachment 18068\nRequest Capture\n\nI've redacted basic auth credentials and my cookie, but everything else is\nas-captured when testing."}, {"attachment_id": 18069, "tags": [], "bug_id": 39274, "is_private": false, "count": 2, "id": 87783, "time": "2006-04-11T20:13:35Z", "creator": "apache@krellis.org", "creation_time": "2006-04-11T20:13:35Z", "text": "Created attachment 18069\ntcpdump output of the same request\n\nSame data redacted as in 18068.  Note after the Content-Length header it starts\nin the middle of one of the MIME parts \"rm-data;\".  Clearly something's cutting\nthis off internally."}, {"count": 3, "tags": [], "bug_id": 39274, "attachment_id": null, "is_private": false, "id": 87784, "time": "2006-04-11T20:27:10Z", "creator": "nick@webthing.com", "creation_time": "2006-04-11T20:27:10Z", "text": "Can you see if replacing that rewriterule with a ProxyPass makes any \ndifference? "}, {"count": 4, "tags": [], "creator": "apache@krellis.org", "text": "(In reply to comment #3)\n> Can you see if replacing that rewriterule with a ProxyPass makes any \n> difference? \n\nI replaced the referenced RewriteRule with:\n\nProxyPass / http://127.0.0.1:8003/\n\n(This is on a devel server using a different port, but I've verified the\noriginal behavior is the same), and it doesn't appear to make any difference -\nthe data is still truncated when it's passed on to the backend server.", "id": 87799, "attachment_id": null, "bug_id": 39274, "creation_time": "2006-04-11T21:38:29Z", "time": "2006-04-11T21:38:29Z", "is_private": false}, {"count": 5, "tags": [], "creator": "rpluem@apache.org", "attachment_id": null, "id": 87805, "time": "2006-04-11T22:22:37Z", "bug_id": 39274, "creation_time": "2006-04-11T22:22:37Z", "is_private": false, "text": "\n\n*** This bug has been marked as a duplicate of 37145 ***"}]