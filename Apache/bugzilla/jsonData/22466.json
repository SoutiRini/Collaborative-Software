[{"count": 0, "tags": [], "bug_id": 22466, "attachment_id": null, "id": 42814, "time": "2003-08-15T16:40:09Z", "creator": "mcepek@smsi.com", "creation_time": "2003-08-15T16:40:09Z", "is_private": false, "text": "We have a JSP page that brings down JBoss with a StackOverflowError\nexception when it iterates too many (2419) times.\n\nWe are using JBoss 2.4.4 and Struts 1.0.2 on SCO 5.0.6 with\nCaldera-UNIX-J2SE-1.3.0_02 (green threads, sunwjit).\n\nI am including the stack trace and JSP code below.  There is no\nrecursion, the stack has only 60 frames.  Also, our javac has no\n-Xss (stack size) option.\n\nWhen it crashes, the browser (not surprisingly) receives incomplete\nHTML (approx 3 Mb).\n\nOne bit of explanation about the JSP:  we used a file called\nGUIStyle.properties to contain common HTML snippets.  (And yes,\nwe are currently converting to CSS :-)\n\nI would greatly appreciate any fix or workaround suggestions, pointers\nto known bugs causing this, or recommendations for further debugging.\n\nThanks in advance.\n\nP.S.  I just confirmed that JBoss running on Win2k does NOT exhibit this\nproblem.  However, since virtually all of the code in the stack trace is\nJBoss', I don't think this can be easily dismissed as an OS or JVM problem.\nI am working to reduce the JSP to something smaller and repeatable.\n\n  -----------------------  Stack Trace:  -----------------------\n\n2003-08-13 11:32:51,361 HttpProcessor[8080][4]/ERROR: ApplicationDispatcher\n[/webconfig] Servlet.service() for servlet jsp threw exception\njavax.servlet.ServletException\n   at org.apache.jasper.runtime.PageContextImpl.handlePageException\n(PageContextImpl.java:457)\n   at org.apache.jsp.agentList$jsp._jspService(agentList$jsp.java, Compiled \nCode)\n   at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:107)\n   at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n   at org.apache.jasper.servlet.JspServlet$JspServletWrapper.service\n(JspServlet.java, Compiled Code)\n   at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:382)\n   at org.apache.jasper.servlet.JspServlet.service(JspServlet.java, Compiled \nCode)\n   at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n   at org.apache.catalina.core.ApplicationDispatcher.invoke\n(ApplicationDispatcher.java, Compiled Code)\n   at org.apache.catalina.core.ApplicationDispatcher.doForward\n(ApplicationDispatcher.java, Compiled Code)\n   at org.apache.catalina.core.ApplicationDispatcher.forward\n(ApplicationDispatcher.java:355)\n   at org.apache.struts.action.RequestProcessor.doForward\n(RequestProcessor.java:961)\n   at org.apache.struts.action.RequestProcessor.processActionForward\n(RequestProcessor.java:400)\n   at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java, \nCompiled Code)\n   at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1227)\n   at org.apache.struts.action.ActionServlet.doGet(ActionServlet.java:484)\n   at javax.servlet.http.HttpServlet.service(HttpServlet.java, Compiled Code)\n   at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java, Compiled Code)\n   at org.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java, Compiled Code)\n   at org.apache.catalina.core.StandardWrapperValve.invoke\n(StandardWrapperValve.java, Compiled Code)\n   at org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java, Compiled Code)\n   at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n   at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java, \nCompiled Code)\n   at org.apache.catalina.core.StandardContextValve.invoke\n(StandardContextValve.java, Compiled Code)\n   at org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java, Compiled Code)\n   at org.apache.catalina.valves.CertificatesValve.invoke\n(CertificatesValve.java:246)\n   at org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java, Compiled Code)\n   at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n   at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java, \nCompiled Code)\n   at org.apache.catalina.core.StandardContext.invoke(StandardContext.java:2344)\n   at org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:164)\n   at org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java, Compiled Code)\n   at org.apache.catalina.valves.ErrorDispatcherValve.invoke\n(ErrorDispatcherValve.java:170)\n   at org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java, Compiled Code)\n   at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java, \nCompiled Code)\n   at org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java, Compiled Code)\n   at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n   at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java, \nCompiled Code)\n   at org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:163)\n   at org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java, Compiled Code)\n   at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n   at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java, \nCompiled Code)\n   at org.apache.catalina.connector.http.HttpProcessor.process\n(HttpProcessor.java, Compiled Code)\n   at org.apache.catalina.connector.http.HttpProcessor.run\n(HttpProcessor.java:1106)\n   at java.lang.Thread.run(Thread.java:484)\n2003-08-13 11:32:51,436 HttpProcessor[8080][4]/ERROR: ----- Root Cause -----\njava.lang.StackOverflowError\n   at org.apache.catalina.connector.ResponseBase.write(ResponseBase.java, \nCompiled Code)\n   at org.apache.catalina.connector.ResponseStream.write(ResponseStream.java, \nCompiled Code)\n   at org.apache.catalina.connector.http.HttpResponseStream.write\n(HttpResponseStream.java, Compiled Code)\n   at javax.servlet.ServletOutputStream.print(ServletOutputStream.java, \nCompiled Code)\n   at javax.servlet.ServletOutputStream.println(ServletOutputStream.java, \nCompiled Code)\n   at org.apache.catalina.connector.http.HttpResponseStream.write\n(HttpResponseStream.java, Compiled Code)\n   at java.io.OutputStreamWriter.write(OutputStreamWriter.java, Compiled Code)\n   at java.io.PrintWriter.write(PrintWriter.java, Compiled Code)\n   at org.apache.catalina.connector.ResponseWriter.write(ResponseWriter.java, \nCompiled Code)\n   at org.apache.jasper.runtime.JspWriterImpl.flushBuffer(JspWriterImpl.java, \nCompiled Code)\n   at org.apache.jasper.runtime.JspWriterImpl.write(JspWriterImpl.java, \nCompiled Code)\n   at org.apache.jasper.runtime.JspWriterImpl.write(JspWriterImpl.java, \nCompiled Code)\n   at org.apache.jasper.runtime.JspWriterImpl.print(JspWriterImpl.java, \nCompiled Code)\n   at org.apache.struts.util.ResponseUtils.writePrevious(ResponseUtils.java, \nCompiled Code)\n   at org.apache.struts.taglib.logic.IterateTag.doAfterBody(IterateTag.java, \nCompiled Code)\n   at org.apache.jsp.agentList$jsp._jspService(agentList$jsp.java, Compiled \nCode)\n   at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:107)\n   at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n   at org.apache.jasper.servlet.JspServlet$JspServletWrapper.service\n(JspServlet.java, Compiled Code)\n   at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:382)\n   at org.apache.jasper.servlet.JspServlet.service(JspServlet.java, Compiled \nCode)\n   at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n   at org.apache.catalina.core.ApplicationDispatcher.invoke\n(ApplicationDispatcher.java, Compiled Code)\n   at org.apache.catalina.core.ApplicationDispatcher.doForward\n(ApplicationDispatcher.java, Compiled Code)\n   at org.apache.catalina.core.ApplicationDispatcher.forward\n(ApplicationDispatcher.java:355)\n   at org.apache.struts.action.RequestProcessor.doForward\n(RequestProcessor.java:961)\n   at org.apache.struts.action.RequestProcessor.processActionForward\n(RequestProcessor.java:400)\n   at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java, \nCompiled Code)\n   at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1227)\n   at org.apache.struts.action.ActionServlet.doGet(ActionServlet.java:484)\n   at javax.servlet.http.HttpServlet.service(HttpServlet.java, Compiled Code)\n   at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java, Compiled Code)\n   at org.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java, Compiled Code)\n   at org.apache.catalina.core.StandardWrapperValve.invoke\n(StandardWrapperValve.java, Compiled Code)\n   at org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java, Compiled Code)\n   at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n   at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java, \nCompiled Code)\n   at org.apache.catalina.core.StandardContextValve.invoke\n(StandardContextValve.java, Compiled Code)\n   at org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java, Compiled Code)\n   at org.apache.catalina.valves.CertificatesValve.invoke\n(CertificatesValve.java:246)\n   at org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java, Compiled Code)\n   at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n   at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java, \nCompiled Code)\n   at org.apache.catalina.core.StandardContext.invoke(StandardContext.java:2344)\n   at org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:164)\n   at org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java, Compiled Code)\n   at org.apache.catalina.valves.ErrorDispatcherValve.invoke\n(ErrorDispatcherValve.java:170)\n   at org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java, Compiled Code)\n   at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java, \nCompiled Code)\n   at org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java, Compiled Code)\n   at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n   at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java, \nCompiled Code)\n   at org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:163)\n   at org.apache.catalina.core.StandardPipeline.invokeNext\n(StandardPipeline.java, Compiled Code)\n   at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:472)\n   at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java, \nCompiled Code)\n   at org.apache.catalina.connector.http.HttpProcessor.process\n(HttpProcessor.java, Compiled Code)\n   at org.apache.catalina.connector.http.HttpProcessor.run\n(HttpProcessor.java:1106)\n   at java.lang.Thread.run(Thread.java:484)\n\n----------------------  agentList.jsp:  ----------------------\n\n<%@page contentType=\"text/html\" \nimport=\"com.smsi.config.action.*,org.apache.commons.beanutils.*\" \nlanguage=\"java\"%>\n<%@ taglib uri=\"/WEB-INF/struts-bean.tld\" prefix=\"bean\" %>\n<%@ taglib uri=\"/WEB-INF/struts-html.tld\" prefix=\"html\" %>\n<%@ taglib uri=\"/WEB-INF/struts-logic.tld\" prefix=\"logic\" %>\n<%@ taglib uri=\"/WEB-INF/config.tld\" prefix=\"config\" %>\n\n<jsp:useBean id=\"agentList_Items\" scope=\"request\" class=\"java.util.ArrayList\"/>\n<jsp:useBean id=\"agentListForm\" scope=\"request\" \nclass=\"org.apache.struts.validator.DynaValidatorForm\"/>\n\n<config:checkLogon/>\n\n<html:html locale=\"true\">\n<head>\n  <html:base/>\n  <%@ include file=\"javascript/messageBox.js\" %>\n</head>\n\n<body <bean:message bundle=\"GUIStyle\" key=\"body_bkg\"/> >\n\n<html:errors />\n\n<bean:message bundle=\"GUIStyle\" key=\"table_outer_start\"/>\n<tr>\n  <bean:message bundle=\"GUIStyle\" key=\"td_outer_header_start\" arg0=\"2\"/>\n  <bean:message key=\"agentListForm.subtitle\"/>\n  <bean:message bundle=\"GUIStyle\" key=\"td_outer_header_end\"/>\n</tr>\n<tr>\n  <td align=\"center\" valign=\"top\">\n  <bean:message bundle=\"GUIStyle\" key=\"table_column_start\"/>\n  <tr>\n    <bean:message bundle=\"GUIStyle\" key=\"td_inner_header_start\" arg0=\"1\"/>\n    <a href=\"agentList.do?action=sort&field=switch_name\">\n      <bean:message key=\"agentListForm.switchName.header\"/>\n    </a>\n    <bean:message bundle=\"GUIStyle\" key=\"td_inner_header_end\"/>\n\n    <bean:message bundle=\"GUIStyle\" key=\"td_inner_header_start\" arg0=\"1\"/>\n    <a href=\"agentList.do?action=sort&field=agent_id\">\n      <bean:message key=\"agentListForm.agentId.header\"/>\n    </a>\n    <bean:message bundle=\"GUIStyle\" key=\"td_inner_header_end\"/>\n\n    <bean:message bundle=\"GUIStyle\" key=\"td_inner_header_start\" arg0=\"1\"/>\n    <a href=\"agentList.do?action=sort&field=sw_agent_sname\">\n      <bean:message key=\"agentListForm.shortName.header\"/>\n    </a>\n    <bean:message bundle=\"GUIStyle\" key=\"td_inner_header_end\"/>\n\n    <bean:message bundle=\"GUIStyle\" key=\"td_inner_header_start\" arg0=\"5\"/>\n    <bean:message key=\"actions.header\"/>\n    <bean:message bundle=\"GUIStyle\" key=\"td_inner_header_end\"/>\n  </tr>\n  <tr>\n  <td>\n  <logic:iterate id=\"agent\" name=\"agentList_Items\"\n      type=\"com.smsi.config.model.MutableAgentModel\">\n    <tr>\n    <bean:message bundle=\"GUIStyle\" key=\"td_column_data_start\"/>\n    <bean:write name=\"agent\" property=\"switch_name\"/>\n    <bean:message bundle=\"GUIStyle\" key=\"td_column_data_end\"/>\n\n    <bean:message bundle=\"GUIStyle\" key=\"td_column_data_start\"/>\n    <bean:write name=\"agent\" property=\"agent_id\"/>\n    <bean:message bundle=\"GUIStyle\" key=\"td_column_data_end\"/>\n\n    <bean:message bundle=\"GUIStyle\" key=\"td_column_data_start\"/>\n    <bean:write name=\"agent\" property=\"sw_agent_sname\"/>\n    <bean:message bundle=\"GUIStyle\" key=\"td_column_data_end\"/>\n\n    <bean:message bundle=\"GUIStyle\" key=\"td_column_data_start\"/>\n    <a id=\"<bean:write name=\"agent\" property=\"sw_agent_sname\"/>-edit\" \nhref=\"agentList.do?action=edit&agentDetail_agentID=<bean:write name=\"agent\" \nproperty=\"agent_id\"/>&agentDetail_switchID=<bean:write name=\"agent\" \nproperty=\"switch_id\"/>&agentDetail_personID=<bean:write name=\"agent\" \nproperty=\"person_id\"/>\">\n        <bean:message key=\"edit.action\"/>\n    </a>\n    <bean:message bundle=\"GUIStyle\" key=\"td_column_data_end\"/>\n\n    <bean:message bundle=\"GUIStyle\" key=\"td_column_data_start\"/>\n    <a id=\"<bean:write name=\"agent\" property=\"sw_agent_sname\"/>-copy\" \nhref=\"agentList.do?action=copy&agentDetail_agentID=<bean:write name=\"agent\" \nproperty=\"agent_id\"/>&agentDetail_switchID=<bean:write name=\"agent\" \nproperty=\"switch_id\"/>&agentDetail_personID=<bean:write name=\"agent\" \nproperty=\"person_id\"/>\">\n        <bean:message key=\"copy.action\"/>\n    </a>\n    <bean:message bundle=\"GUIStyle\" key=\"td_column_data_end\"/>\n\n    <bean:message bundle=\"GUIStyle\" key=\"td_column_data_start\"/>\n    <a id=\"<bean:write name=\"agent\" property=\"sw_agent_sname\"/>-del\" \nhref=\"agentList.do?action=delete&agentList_agentID=<bean:write name=\"agent\" \nproperty=\"agent_id\"/>&agentList_switchID=<bean:write name=\"agent\" \nproperty=\"switch_id\"/>&agentList_personID=<bean:write name=\"agent\" \nproperty=\"person_id\"/>\" name=\"<bean:write name=\"agent\" \nproperty=\"sw_agent_sname\"/>\"\n        onmousedown='return popConfirmForAnchor( this.href, \"<bean:message \nkey=\"agentListForm.confirmDelete\"/>\" + this.name + \"?\" );'>\n      <bean:message key=\"delete.action\"/>\n    </a>\n    <!-- TODO: i18n the above line -->\n    <bean:message bundle=\"GUIStyle\" key=\"td_column_data_end\"/>\n\n    <bean:message bundle=\"GUIStyle\" key=\"td_column_data_start\"/>\n      <logic:notEqual name=\"agent\" property=\"agentHide\" value='N'>\n        <a id=\"<bean:write name=\"agent\" property=\"sw_agent_sname\"/>-hide\" \nhref=\"agentList.do?\naction=hide&agentList_agentHide=N&agentList_agentID=<bean:write name=\"agent\" \nproperty=\"agent_id\"/>&agentList_switchID=<bean:write name=\"agent\" \nproperty=\"switch_id\"/>&agentList_personID=<bean:write name=\"agent\" \nproperty=\"person_id\"/>\">\n          <bean:message key=\"agentListForm.show.action\"/>\n        </a>\n      </logic:notEqual>  \n      <logic:equal name=\"agent\" property=\"agentHide\" value='N'>\n        <a id=\"<bean:write name=\"agent\" property=\"sw_agent_sname\"/>-hide\" \nhref=\"agentList.do?\naction=hide&agentList_agentHide=Y&agentList_agentID=<bean:write name=\"agent\" \nproperty=\"agent_id\"/>&agentList_switchID=<bean:write name=\"agent\" \nproperty=\"switch_id\"/>&agentList_personID=<bean:write name=\"agent\" \nproperty=\"person_id\"/>\">\n            <bean:message key=\"agentListForm.hide.action\"/>\n        </a>\n      </logic:equal>  \n    <bean:message bundle=\"GUIStyle\" key=\"td_column_data_end\"/>\n\n    <bean:message bundle=\"GUIStyle\" key=\"td_column_data_start\"/>\n        <a id=\"<bean:write name=\"agent\" property=\"sw_agent_sname\"/>-group\" \nhref=\"agentList.do?action=group&agentID=<bean:write name=\"agent\" \nproperty=\"agent_id\"/>&switchID=<bean:write name=\"agent\" \nproperty=\"switch_id\"/>&personID=<bean:write name=\"agent\" \nproperty=\"person_id\"/>&swAgentName=<bean:write name=\"agent\" \nproperty=\"sw_agent_sname\"/>\">\n            <bean:message key=\"agentListForm.group.action\"/>\n        </a>\n    <bean:message bundle=\"GUIStyle\" key=\"td_column_data_end\"/>\n    </tr>\n  </logic:iterate>\n  <bean:message bundle=\"GUIStyle\" key=\"table_column_end\"/>\n</td>\n</tr>\n<bean:message bundle=\"GUIStyle\" key=\"table_outer_end\"/>\n\n<bean:message bundle=\"GUIStyle\" key=\"table_button_start\"/>\n<html:form method=\"post\" action=\"/agentList\">\n<tr>\n  <td align=\"center\">\n  <html:submit property=\"agentList_newButton\">\n    <bean:message key=\"agentListForm.newButton\"/>\n  </html:submit>\n  </td>\n  <td align=\"center\">\n      <html:submit property=\"agentList_hideButton\">\n            <bean:message key=\"agentListForm.hideButton\"/>\n      </html:submit>\n  </td>\n</tr>\n<bean:message bundle=\"GUIStyle\" key=\"table_button_end\"/>\n\n</html:form>\n</body>\n</html:html>"}, {"count": 1, "attachment_id": null, "bug_id": 22466, "text": "Confirmed that this problem does not occur on Window 2000 sp3, using the same \nversion of Java, JBoss/Tomcat, and Struts.", "id": 42921, "time": "2003-08-18T14:23:04Z", "creator": "mcepek@smsi.com", "creation_time": "2003-08-18T14:23:04Z", "tags": [], "is_private": false}, {"text": "Given that this occurs in one JVM and not another I believe that the \npossibility of this being a tomcat issue are pretty remote. I am going to \nresolve this as invalid for now. If you have a simple test case that \ndemonstrates this error please provide it and I will take another look.", "tags": [], "bug_id": 22466, "attachment_id": null, "count": 2, "id": 57571, "time": "2004-05-17T20:47:25Z", "creator": "markt@apache.org", "creation_time": "2004-05-17T20:47:25Z", "is_private": false}]