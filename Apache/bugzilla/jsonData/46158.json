[{"count": 0, "tags": [], "creator": "per.nilsson@sonyericsson.com", "attachment_id": null, "is_private": false, "id": 122242, "time": "2008-11-06T05:55:36Z", "bug_id": 46158, "creation_time": "2008-11-06T05:55:36Z", "text": "Set-up:\nHW load balancer\nStandalone Tomcat's 5.5.20\nNo session replication\nSessionID on URL (NOT as cookie)\n\n1) Request to app (e.g www.acme.com/app) is sent through HW load balancer (e.g lb.acme.com) to a host of web app (e.g. host1.acme.com/app).\n2) Web app creates a session.\n3) Web app creates a redirect URL (e.g. host1.acme.com/app/page2) to itself, same host where the session exist, and ask Tomcat to encodeRedirectURL to append sessionID on URL.\n4) URL is missing the sessionID\n\nCause:\n\ndoIsEncodeable tests if \"server name\" of request (lb.acme.com or www.acme.com ) is equal to \"host name\" of URL to be encoded (host1.acme.com) and fails if different (to prevent sending sessionID to other hosts?).\n\n        if (!hreq.getServerName().equalsIgnoreCase(url.getHost()))\n            return (false);\n\nThe test should be changed to not prevent redirect to it self with sessionIDs."}, {"count": 1, "tags": [], "creator": "rainer.jung@kippdata.de", "attachment_id": null, "id": 122247, "creation_time": "2008-11-06T06:58:18Z", "time": "2008-11-06T06:58:18Z", "bug_id": 46158, "text": "Use proxyName and proxyPort as attributes on your Tomcat Connector.\nSee:\n\nhttp://tomcat.apache.org/tomcat-5.5-doc/config/http.html\nhttp://tomcat.apache.org/tomcat-5.5-doc/proxy-howto.html\n\nLet us know, if it solves the problem.", "is_private": false}, {"count": 2, "tags": [], "text": "As Rainer suggested, proxyName should address this.", "is_private": false, "bug_id": 46158, "id": 125668, "time": "2009-03-21T08:34:38Z", "creator": "markt@apache.org", "creation_time": "2009-03-21T08:34:38Z", "attachment_id": null}]