[{"count": 0, "tags": [], "creator": "ariiber@yahoo.com", "attachment_id": null, "is_private": false, "id": 83245, "time": "2005-12-05T18:43:35Z", "bug_id": 37794, "creation_time": "2005-12-05T18:43:35Z", "text": "Overview: When an HTTP/1.1 client (for example J2ME) POST with\ntransfer-encoding: chunked to a servlet, the getParameter() family and\ngetQueryString() methods fail to retrieve the correct result by returning\nnothing. In contrast, reading until end-of-file on the servlets input stream\nproduces correct result.\n\nSteps to reproduce: Send a chunked POST request, with a=0 in the first chunk,\nsleep 1 s, then send &b=0 in the next, followed by a 0-chunk and trailer. On the\nreceiving servlet, call getParameterNames() or getParameter().\n\nActual Results: null\n\nExpected results: a=0&b=1\n\nBuild: Tomcat 5.5.12\n\nAdditional Builds and Platforms:\n- getParameter() does fail on:\n    Tomcat 4.1.18\n    Tomcat 4.1.24\n    Tomcat 5.5.12\n- getParameter() doesn't fail on:\n    Jetty 5.1.6\n\nAdditional Information: Please refer to the log below for Tomcat behaviour. It\nis from a simple test client and servlet written to demonstrate the bug.\nTomcat 5.5.12 log:\n\n****************************\n1) Reading the body - PASS *\n****************************\n    [junit] // testChunked(localhost, 8080)\n    [junit] // Sending request to host localhost port 8080\n    [junit] POST /testchunked/EchoServlet/getBody HTTP/1.1\n    [junit] User-Agent: no.riiber.net.http.test.chunked.EchoClient (chunked-test)\n    [junit] content-type: application/x-www-form-urlencoded\n    [junit] connection: Close\n    [junit] host: localhost:8080\n    [junit] transfer-encoding: chunked\n\n    [junit] 3\n    [junit] a=0\n    [junit] 4\n    [junit] &b=1\n    [junit] // Reading response from host localhost port 8080\n    [junit] HTTP/1.1 200 OK\n    [junit] Server: Apache-Coyote/1.1\n    [junit] Content-Type: text/plain;charset=ISO-8859-1\n    [junit] Content-Length: 9\n    [junit] Date: Mon, 05 Dec 2005 07:48:59 GMT\n    [junit] Connection: close\n\n    [junit] a=0&b=1\n    [junit] // PASS: a=0\n    [junit] // PASS: &b=1\n***************************************\n2) Reading using getQuerySTring: FAILS\n***************************************\n    [junit] // testChunked(localhost, 8080)\n    [junit] // Sending request to host localhost port 8080\n    [junit] POST /testchunked/EchoServlet/getQueryString HTTP/1.1\n    [junit] User-Agent: no.riiber.net.http.test.chunked.EchoClient (chunked-test)\n    [junit] content-type: application/x-www-form-urlencoded\n    [junit] connection: Close\n    [junit] host: localhost:8080\n    [junit] transfer-encoding: chunked\n\n    [junit] 3\n    [junit] a=0\n    [junit] 4\n    [junit] &b=1\n    [junit] // Reading response from host localhost port 8080\n    [junit] HTTP/1.1 200 OK\n    [junit] Server: Apache-Coyote/1.1\n    [junit] Content-Type: text/plain;charset=ISO-8859-1\n    [junit] Content-Length: 6\n    [junit] Date: Mon, 05 Dec 2005 07:48:59 GMT\n    [junit] Connection: close\n\n    [junit] null\n    [junit] // *** FAIL: a=0 is not present in response from\n/testchunked/EchoServlet/getQueryString ***\n    [junit] // *** FAIL: &b=1 is not present in response from\n/testchunked/EchoServlet/getQueryString ***\n********************************************\n3) Reading using getParameterNames(): FAILS\n*********************************************\n    [junit] // testChunked(localhost, 8080)\n    [junit] // Sending request to host localhost port 8080\n    [junit] POST /testchunked/EchoServlet/getParameterNamesAndValues HTTP/1.1\n    [junit] User-Agent: no.riiber.net.http.test.chunked.EchoClient (chunked-test)\n    [junit] content-type: application/x-www-form-urlencoded\n    [junit] connection: Close\n    [junit] host: localhost:8080\n    [junit] transfer-encoding: chunked\n\n    [junit] 3\n    [junit] a=0\n    [junit] 4\n    [junit] &b=1\n    [junit] // Reading response from host localhost port 8080\n    [junit] HTTP/1.1 200 OK\n    [junit] Server: Apache-Coyote/1.1\n    [junit] Content-Type: text/plain;charset=ISO-8859-1\n    [junit] Content-Length: 2\n    [junit] Date: Mon, 05 Dec 2005 07:49:02 GMT\n    [junit] Connection: close\n\n\n    [junit] // *** FAIL: a=0 is not present in response from\n/testchunked/EchoServlet/getParameterNamesAndValues ***\n    [junit] // *** FAIL: &b=1 is not present in response from\n/testchunked/EchoServlet/getParameterNamesAndValues ***\n\nBest regards\nArne Riiber"}, {"count": 1, "tags": [], "text": "URL POST must use a content-length. Otherwise, it's something else.", "is_private": false, "bug_id": 37794, "id": 83248, "time": "2005-12-05T18:53:01Z", "creator": "remm@apache.org", "creation_time": "2005-12-05T18:53:01Z", "attachment_id": null}, {"count": 2, "tags": [], "text": "It's correct that Content-Length was required for HTTP/1.0, but with HTTP/1.1\nit's not required anymore according to RFC2616\n[ftp://ftp.isi.edu/in-notes/rfc2616.txt] chapter 4.3:\n\nThe presence of a message-body in a request is signaled by the\n   inclusion of a Content-Length or Transfer-Encoding header field in\n   the request's message-headers.\n\nRFC2616 chapter 19.4.6 \"Introduction of Transfer-Encoding\" also includes pseudo\ncode for determining the content-length from the chunks.\n\nPlease correct me if I'm wrong.\n\nBest regards\nArne Riiber\n\n", "is_private": false, "bug_id": 37794, "id": 83252, "time": "2005-12-05T19:45:12Z", "creator": "ariiber@yahoo.com", "creation_time": "2005-12-05T19:45:12Z", "attachment_id": null}, {"attachment_id": 17155, "tags": [], "bug_id": 37794, "is_private": false, "count": 3, "id": 83257, "time": "2005-12-05T20:25:59Z", "creator": "ariiber@yahoo.com", "creation_time": "2005-12-05T20:25:59Z", "text": "Created attachment 17155\nSample code for demonstrating the bug"}, {"count": 4, "tags": [], "text": "This is really a problem for any POST requests coming out of MIDP where you\ncannot change your transfer encoding (its controlled by the device).\n\nThanks a lot,\n-Rushabh", "is_private": false, "bug_id": 37794, "id": 98475, "time": "2007-01-24T15:37:40Z", "creator": "radoshi@pelago.com", "creation_time": "2007-01-24T15:37:40Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "mjanger@agilissystems.com", "attachment_id": null, "is_private": false, "id": 115327, "time": "2008-04-04T15:18:59Z", "bug_id": 37794, "creation_time": "2008-04-04T15:18:59Z", "text": "As of Tomcat 5.5.20 and Tomcat 6.0.16, this is still an open issue.  Any status?"}, {"count": 6, "tags": [], "creator": "markt@apache.org", "text": "This has been fixed in trunk (with a test case) and will be proposed for 6.0.x and 5.5.x", "id": 127994, "time": "2009-06-16T13:31:19Z", "bug_id": 37794, "creation_time": "2009-06-16T13:31:19Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 37794, "is_private": false, "text": "This has been fixed in 6.0.x and will be included in 6.0.21 onwards", "id": 128238, "time": "2009-06-24T10:46:01Z", "creator": "markt@apache.org", "creation_time": "2009-06-24T10:46:01Z", "attachment_id": null}, {"count": 8, "text": "This has been fixed in 5.5.x and will be included in 5.5.28 onwards.", "bug_id": 37794, "is_private": false, "id": 128529, "time": "2009-07-05T16:03:38Z", "creator": "markt@apache.org", "creation_time": "2009-07-05T16:03:38Z", "tags": [], "attachment_id": null}]