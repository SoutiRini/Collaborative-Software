[{"count": 0, "tags": [], "bug_id": 46440, "attachment_id": null, "id": 123509, "creation_time": "2008-12-23T14:56:02Z", "time": "2008-12-23T14:56:02Z", "creator": "chad.retz@gmail.com", "text": "In the following build script, only the initial file (Test1.js) is loaded into file.contents and nothing else is after that. The @{srcfile} does change everytime:\n\n<project name=\"js-merger\" default=\"merge\" basedir=\".\">    \n    <!-- simple file appender -->\n    <macrodef name=\"fileappend\">\n        <attribute name=\"srcfile\" />\n        <attribute name=\"destfile\" />\n        <sequential>\n            <tstamp>\n                <format property=\"current.time\" pattern=\"MM/dd/yyyy hh:mm aa\" />\n            </tstamp>\n            <echo file=\"@{destfile}\" append=\"true\"><![CDATA[\n/**\n * Imported by js-merger from @{srcfile} at ${current.time}\n * --------------------------------------------------------\n */  \n]]></echo>\n            <loadfile property=\"file.contents\" srcFile=\"@{srcfile}\" />\n            <echo message=\"${file.contents}\" file=\"@{destfile}\" append=\"true\" />\n        </sequential>\n    </macrodef>\n    <target name=\"merge\">\n        <property name=\"dest.file\" value=\"Combined.js\" />\n        <!-- clean -->\n        <delete file=\"${dest.file}\" />\n        <!-- write -->\n        <fileappend srcfile=\"Test1.js\" destfile=\"${dest.file}\" />\n        <fileappend srcfile=\"Test2.js\" destfile=\"${dest.file}\" />\n        <fileappend srcfile=\"Test3.js\" destfile=\"${dest.file}\" />\n        <fileappend srcfile=\"Test4.js\" destfile=\"${dest.file}\" />\n        <fileappend srcfile=\"Test5.js\" destfile=\"${dest.file}\" />\n    </target>\n</project>\n\nant -version\nApache Ant version 1.7.0 compiled on December 13 2006\n\nI haven't bothered to look at the source yet, but I will. Of course, I can work around like by changing my macrodef to:\n\n    <macrodef name=\"fileappend\">\n        <attribute name=\"srcfile\" />\n        <attribute name=\"destfile\" />\n        <sequential>\n            <tstamp>\n                <format property=\"current.time\" pattern=\"MM/dd/yyyy hh:mm aa\" />\n            </tstamp>\n            <echo file=\"@{destfile}\" append=\"true\"><![CDATA[\n/**\n * Imported by js-merger from @{srcfile} at ${current.time}\n * --------------------------------------------------------\n */  \n]]></echo>\n            <loadfile property=\"file.contents.@{srcfile}\" srcFile=\"@{srcfile}\" />\n            <echo message=\"${file.contents.@{srcfile}}\" file=\"@{destfile}\" append=\"true\" />\n        </sequential>\n    </macrodef>\n\nIt'd be worth mentioning in the manual if this is intentional behavior.", "is_private": false}, {"count": 1, "tags": [], "bug_id": 46440, "attachment_id": null, "id": 123793, "creation_time": "2009-01-06T01:36:35Z", "time": "2009-01-06T01:36:35Z", "creator": "bodewig@apache.org", "text": "properties are more or less immutable, almost no Ant task changes the value of an existing property and loadfile is no exception.  This is documented in the manual page of the property task.\n\nI've added a sentence to the manual in svn revision 731895 - for \"experienced\" Ant users, loadfile's behavior is expected.", "is_private": false}, {"count": 2, "tags": [], "bug_id": 46440, "attachment_id": null, "id": 123799, "creation_time": "2009-01-06T08:20:27Z", "time": "2009-01-06T08:20:27Z", "creator": "mbenson@apache.org", "text": "Note that you may get some love from the scoped properties in Ant's trunk.", "is_private": false}]