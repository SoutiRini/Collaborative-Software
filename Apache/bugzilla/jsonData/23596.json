[{"count": 0, "tags": [], "bug_id": 23596, "attachment_id": null, "text": "Due to a bug, function evaluation was never\nperformed in XPathQueryResolver. The most obvious\nresult was that starts-with searches did not use\nindexes even if appropriate indexes were available\n(starts-with was supposed to be evaluated with index\nwhen possible).\n\nThe attached patch does the following:\n\n1) Make function evaluation work\n2) Fix class cast errors in evalMathOperation and evalUnaryOperation\n3) Optimize several 2-operand operations to eliminate unnecessary evaluations\n\t(e.g. if operation has a left operand and a right operand,\n\tevaluate left first and if left can't be evaluated, just\n\treturn that indicator (null instead of a keyset) rather than\n\tevaluating right before returning.)\n\n\tObject left = evaluate(...)\n\tObject right = evaluate(...)\n\n\tif(left instanceof NamedKeys && right instanceof NamedKeys) {\n\t\t// do some work on left and right\n\t}\n\telse {\n\t\t// can't evaluate but still evaluated BOTH left and right\n\t\treturn null;\n\t}\n\n\tbecomes:\n\n\tObject left = evaluate(...)\n\n\tif(left instanceof NamedKeys) {\n\n\t\t// have left - now evaluate right\n\t\tObject right = evaluate(...)\n\n\t\tif(right instanceof NamedKeys) {\n\t\t\t// do some work on left and right\n\t\t}\n\t}\n\telse {\n\t\t// can't evaluate but at least skipped needless evaluation of right\n\t\treturn null;\n\t}\n3) Ensure that all functions handle their argument types properly\n(since function code never executed previously, bugs were present)", "id": 45047, "time": "2003-10-03T18:13:01Z", "creator": "Terry.Rosenbaum@gmail.com", "creation_time": "2003-10-03T18:13:01Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 23596, "attachment_id": 8448, "id": 45048, "time": "2003-10-03T18:13:36Z", "creator": "Terry.Rosenbaum@gmail.com", "creation_time": "2003-10-03T18:13:36Z", "is_private": false, "text": "Created attachment 8448\nPatch for XPathQueryResolver"}, {"count": 2, "tags": [], "bug_id": 23596, "text": "*** Bug 23468 has been marked as a duplicate of this bug. ***", "id": 45054, "attachment_id": null, "creator": "Terry.Rosenbaum@gmail.com", "creation_time": "2003-10-03T18:23:22Z", "time": "2003-10-03T18:23:22Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 23596, "attachment_id": null, "text": "Please disregard patch 10/03/03 18:13. Still has a few bugs\nbrought to light by my applications. Following patch\nsupersedes previous one.", "id": 45389, "time": "2003-10-10T18:23:35Z", "creator": "Terry.Rosenbaum@gmail.com", "creation_time": "2003-10-10T18:23:35Z", "is_private": false}, {"count": 4, "tags": [], "creator": "Terry.Rosenbaum@gmail.com", "text": "Created attachment 8529\nPatch for XPathQueryResolver", "id": 45390, "time": "2003-10-10T18:24:34Z", "bug_id": 23596, "creation_time": "2003-10-10T18:24:34Z", "is_private": false, "attachment_id": 8529}, {"count": 5, "tags": [], "bug_id": 23596, "text": "Applied patches. There was some difficulty doing this (alot had to be done\nmanually) as the patches where not supplied in diff -u format from the root of\nthe project.", "id": 48622, "attachment_id": null, "creator": "kevinoneill@apache.org", "creation_time": "2003-12-06T22:30:34Z", "time": "2003-12-06T22:30:34Z", "is_private": false}]