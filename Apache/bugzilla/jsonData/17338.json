[{"count": 0, "tags": [], "creator": "PAF@design.ru", "attachment_id": null, "id": 31849, "time": "2003-02-24T13:13:10Z", "bug_id": 17338, "creation_time": "2003-02-24T13:13:10Z", "is_private": false, "text": "situation: \n  http://first [mod_rewrite+mod_proxy]\n  http://second [real server]\n\nfirst:\n.htaccess in / contains\nRewriteEngine On\nRewriteRule ^(.*)$ http://second/$1 [P]\n\nfirst receives request:\nhttp://first/test/?query\n\nsecond receives this:\nhttp://second/test/%3Fquery?query\n\nwhich is wrong.\n\ncurrently am fixing that by deleting may-be-buggy fragment of code in \nmod_rewrite in two places:\n/* make sure the QUERY_STRING\n...\nget incorporated\n*/\nwhen query strings get's appended to filename:\n                r->filename = ap_pstrcat(r->pool, r->filename,\n                                         \"?\", r->args, NULL);\n\nBUT it nobody ever removes r->args, and later on mod_proxy extracts r->args, \nwhile r->filename actually becomes urlencoded."}, {"count": 1, "tags": [], "creator": "nd@perlig.de", "attachment_id": null, "id": 31851, "time": "2003-02-24T13:22:22Z", "bug_id": 17338, "creation_time": "2003-02-24T13:22:22Z", "is_private": false, "text": "Just permute the AddModule directives of mod_rewrite and mod_proxy. It should\nwork then, because the hooks no longer conflict.\n\nThanks for using Apache!"}, {"count": 2, "tags": [], "bug_id": 17338, "is_private": false, "text": "actually we're using not mod_proxy [my mistake], we're using mod_accel.\nactually removing that piece of code helps with both modules, so I thought it \nwould be no difference what to report, sorry about being inaccurate.\n\nagain: I've tried to permute those directives without luck: request still \nproxied badly[as if nothing changed]: \n\nhere's url as it get proxied [piece of real-life log]:\n/press/publications/%3fid=4dccf8d8-55f9-\n4985-ab19-afdf6b4ba8cd?id=4dccf8d8-55f9-4985-ab19-afdf6b4ba8cd\n\nmaybe you'd take a closer look at the problem?", "id": 31867, "time": "2003-02-24T15:13:14Z", "creator": "PAF@design.ru", "creation_time": "2003-02-24T15:13:14Z", "attachment_id": null}]