[{"count": 0, "tags": [], "text": "/*\n     * if a value for this key already exists,\n     * reuse as much of the already malloc-ed data\n     * as possible.\n     */\n    if (asn1) {\n        if (asn1->nData != length) {\n            free(asn1->cpData); /* XXX: realloc? */\n            asn1->cpData = NULL;\n        }\n    }\n    else {\n        asn1 = malloc(sizeof(*asn1));\n        asn1->source_mtime = 0; /* used as a note for encrypted private keys */\n        asn1->cpData = NULL;\n    }\n\n    asn1->nData = length;\n    if (!asn1->cpData) {\n        asn1->cpData = malloc(length);\n    }\n\n    apr_hash_set(table, key, klen, asn1);", "attachment_id": null, "id": 148232, "creator": "max@cxib.net", "time": "2011-07-27T19:25:26Z", "bug_id": 51571, "creation_time": "2011-07-27T19:25:26Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 51571, "attachment_id": null, "is_private": false, "id": 149498, "time": "2011-09-19T16:28:38Z", "creator": "sf@sfritsch.de", "creation_time": "2011-09-19T16:28:38Z", "text": "fixed in trunk in r1172686, not important enough to be backported"}]