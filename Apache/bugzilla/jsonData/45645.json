[{"count": 0, "text": "Preliminary note: This bug is in 3.1-FINAL, but the latest version the Combo Box did offer was 3.0-dev\n\nIn HSSFSheet.autoSizeColumns(), the following code:\n\nif (width != -1) {\n    if (width > Short.MAX_VALUE) { //width can be bigger that Short.MAX_VALUE!\n        width = Short.MAX_VALUE;\n    }\n    sheet.setColumnWidth(column, (short) (width * 256));\n}\n\nshould be replaced by:\n\nif (width != -1) {\n    width *= 256;\n    if (width > Short.MAX_VALUE) { //width can be bigger that Short.MAX_VALUE!\n        width = Short.MAX_VALUE;\n    }\n    sheet.setColumnWidth(column, (short) (width));\n}\n\nwhich is probably what was intended, since only then the cast to short will always have an argument that is within range.\n\nWith the original version, large widths produce settings which depend on the least significant bits and thus tend to be rather random.\n\nThe topic has already be addressed in bug #43090, but the resolution which made it into the final version does not solve the problem.", "bug_id": 45645, "attachment_id": null, "id": 119886, "time": "2008-08-18T06:55:26Z", "creator": "norbert.schenk@bredex.de", "creation_time": "2008-08-18T06:55:26Z", "tags": [], "is_private": false}, {"count": 1, "text": "Thanks for pointing it out. Of course, multiplication should be done before checking Short.MAX_VALUE.\nFixed in r686844.\n\nYegor", "bug_id": 45645, "is_private": false, "id": 119898, "time": "2008-08-18T11:34:26Z", "creator": "yegor@dinom.ru", "creation_time": "2008-08-18T11:34:26Z", "tags": [], "attachment_id": null}]