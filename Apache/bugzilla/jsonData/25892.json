[{"count": 0, "tags": [], "creator": "e9726081@stud3.tuwien.ac.at", "is_private": false, "text": "if one uses xupdate to copy or move a tag like described in (section 21 and 22)\nhttp://www.xmldatabases.org/projects/XUpdate-UseCases/\nan exception is thrown\n\norg.xmldb.api.base.XMLDBException: :Error executing XPath query: Die Variable\nkann nicht aufgel\u00f6st werden: country\n\nTRANSLATION: \n\"Die Variable kann nicht aufgel\u00f6st werden: country\" (german)\n\"The following variable can not be resolved: country\"\n\nthe document is altered anyway. \nIn the case of moving a tag everythings looks ok\n\nbut in the case of copying a tag, the same exception is thrown, and the\ntag is insert to often (three times) in the document.\n\n\n\n\n\nUsed a cvs snapshot from 4th january 2004.\nTest cases made with the command line tool.\nI was able to reproduce the behaviour with the \"xmldb gui\" where I used v1.1b3\nin the lib directory.\nThis bug already existed in a simular way in v1.1b2, and i had the problems from\nwithin cocoon2.1.3 using the external mode\n\n\nEXAMPLE\n\n\ndocument before xupdate:\n\n<?xml version=\"1.0\"?>\n<continent>\n    <poland />\n    <uk />\n    <germany />\n    <france />\n    <austria />\n    <italy />\n</continent>\n\n\nxupdated used with the command line tool\n\n<xupdate:modifications version=\"1.0\" xmlns:xupdate=\"http://www.xmldb.org/xupdate\">\n\t<xupdate:variable name=\"country\" select=\"/*/austria\"/>\n\t<xupdate:insert-before select=\"/*/poland\">\n\t\t<xupdate:value-of select=\"$country\"/>\n\t</xupdate:insert-before>\n<xupdate:modifications>\n\n\n\nExpected behaviour:\n\ncopies the tag austria in front of the tag poland.\ntwo austria tags should be in the document.\n\n\nCommand Line:\n\nC:\\java\\tempxu>xindice xupdate -c /db/planet  -f xu4.xml\n[DEBUG] DatabaseImpl - -Using SAX Driver: 'xerces'\n[DEBUG] DatabaseImpl - -Using Service Location: '/xindice/'\n[DEBUG] CollectionImpl - -Using URL: 'http://127.0.0.1:8888/xindice/'\norg.xmldb.api.base.XMLDBException: :Error executing XPath query: Die Variable\nkann nicht aufgel\u00f6st werden: country\n        at\norg.apache.xindice.client.xmldb.xmlrpc.CollectionImpl.runRemoteCommand(CollectionImpl.java:201)\n        at\norg.apache.xindice.client.xmldb.xmlrpc.CollectionImpl.query(CollectionImpl.java:592)\n        at\norg.apache.xindice.client.xmldb.XindiceCollection.query(XindiceCollection.java:299)\n        at\norg.apache.xindice.client.xmldb.services.QueryService.query(QueryService.java:131)\n        at\norg.apache.xindice.client.xmldb.services.XUpdateQueryServiceImpl.update(XUpdateQueryServiceImpl.java:123)\n        at org.apache.xindice.tools.command.XUpdate.execute(XUpdate.java:136)\n        at org.apache.xindice.tools.XMLTools.execute(XMLTools.java:336)\n        at org.apache.xindice.tools.XMLTools.process(XMLTools.java:213)\n        at org.apache.xindice.tools.XMLTools.main(XMLTools.java:124)\nERROR : :Error executing XPath query: Die Variable kann nicht aufgel\u00c3\u00b7st werden:\ncountry\n\nTRANSLATION: \n\"Die Variable kann nicht aufgel\u00f6st werden: country\" (german)\n\"The following variable can not be resolved: country\"\n\n\n\nStill updated document:\n\n<?xml version=\"1.0\"?>\n<continent>\n    <austria />\t<austria /><austria />\t<poland />\n    <uk />\n    <germany />\n    <france />\n\t<austria />\n    <italy />\n</continent>\n\ninserted three times instead of once!\nnow four austria tags are in the document, instead of two\n\n\n\nI made a few variations, to find out if it has to do ,with specials cases like\nthe first or the last tag, but it seems that it happens at any position.\n\nI will attach a few xupdated files to make it easier to follow the problem", "id": 50040, "time": "2004-01-05T07:43:50Z", "bug_id": 25892, "creation_time": "2004-01-05T07:43:50Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "e9726081@stud3.tuwien.ac.at", "text": "Created attachment 9803\nthe copy case, as described in the textarea of this bug", "id": 50041, "time": "2004-01-05T07:48:35Z", "bug_id": 25892, "creation_time": "2004-01-05T07:48:35Z", "is_private": false, "attachment_id": 9803}, {"count": 2, "attachment_id": 9804, "bug_id": 25892, "is_private": false, "id": 50042, "time": "2004-01-05T07:50:06Z", "creator": "e9726081@stud3.tuwien.ac.at", "creation_time": "2004-01-05T07:50:06Z", "tags": [], "text": "Created attachment 9804\nmove case, to the front of the xml document"}, {"count": 3, "tags": [], "text": "Created attachment 9805\nmove case, in the middle of the xml document", "is_private": false, "id": 50043, "creator": "e9726081@stud3.tuwien.ac.at", "time": "2004-01-05T07:50:51Z", "bug_id": 25892, "creation_time": "2004-01-05T07:50:51Z", "attachment_id": 9805}, {"count": 4, "tags": [], "creator": "vgritsenko@apache.org", "text": "Assign to the list", "id": 50175, "time": "2004-01-07T11:32:10Z", "bug_id": 25892, "creation_time": "2004-01-07T11:32:10Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "dominic@stratlink.com.au", "is_private": false, "text": "This is a case where a variable has been used to store an xml node, delete it\nfrom the document, and insert it in a different place. An exception is thrown\n(Caused by: org.xmldb.api.base.XMLDBException: :Error executing XPath query:\nVariable not resolvable: existingCell)\n\nNotice that it leaves theses <temporaryXUpdateTree> elements in the document.\nCorruption.\n\n\n<View ignoreFormatting=\"false\" name=\"Compact Listing\" class=\"42\" type=\"Listing\"\nid=\"91\" xmlns:src=\"http://xml.apache.org/xindice/Query\"\nsrc:col=\"/db/websystem/advancen.com/dev/view\" src:key=\"91\">\n \n<temporaryXUpdateTree /><temporaryXUpdateTree /><temporaryXUpdateTree\n/><temporaryXUpdateTree /><Column id=\"3\"\ngroupDescendants=\"false\"><Layout><ObjectWidth>100%</ObjectWidth>\n<CellWidth>100%</CellWidth>\n<CellHorizAlign>left</CellHorizAlign>\n<CellVertAlign>top</CellVertAlign>\n<BorderSize>0</BorderSize>\n</Layout>\n<Rendering id=\"1\" element=\"Item Name\" class=\"1\" type=\"Single Line Text\"\ndisplayType=\"Text\" cssclass=\"text_default\"><Layout><CellWidth>100%</CellWidth>\n<CellHorizAlign>left</CellHorizAlign>\n<CellVertAlign>top</CellVertAlign>\n<BorderSize>0</BorderSize>\n</Layout>\n</Rendering></Column>\n \n</View>", "id": 54644, "time": "2004-03-25T08:19:26Z", "bug_id": 25892, "creation_time": "2004-03-25T08:19:26Z", "attachment_id": null}, {"count": 6, "attachment_id": null, "bug_id": 25892, "text": "I've looked a bit more into this and it seems that it only occurs if you call the \n\nXUpdateQueryService.update(String commands) method. This method applies the\nxupdate commands to the entire collection, even if only one document is affected\nby the query.\n\nif you use the\n\nXUpdateQueryService.updateResource(String documentName, String commands) it will\napply the xupdate to just the document you have specified. Using\nxupdate:variable here works flawlessy!\n\nThis is still a bug though because it should work even if applied to a\ncollection but for those who just need it to work, there is a workaround here.\n\nI have verified that this bug affects the cvs head (1.1b4-dev).", "id": 54698, "time": "2004-03-26T00:52:21Z", "creator": "dominic@stratlink.com.au", "creation_time": "2004-03-26T00:52:21Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "creator": "byrne@cns.montana.edu", "text": "Currently fixed in CVS.", "id": 75982, "time": "2005-06-03T18:28:42Z", "bug_id": 25892, "creation_time": "2005-06-03T18:28:42Z", "is_private": false, "attachment_id": null}]