[{"attachment_id": null, "tags": [], "creator": "dm.smirnov@gmail.com", "is_private": false, "count": 0, "id": 90986, "time": "2006-07-07T12:13:10Z", "bug_id": 39989, "creation_time": "2006-07-07T12:13:10Z", "text": "hi! When I remove row there is an exception (see below)\n\n\nexample:\nimport java.io.FileOutputStream;\nimport java.io.IOException;\n\nimport org.apache.poi.hssf.usermodel.HSSFCell;\nimport org.apache.poi.hssf.usermodel.HSSFRichTextString;\nimport org.apache.poi.hssf.usermodel.HSSFRow;\nimport org.apache.poi.hssf.usermodel.HSSFSheet;\nimport org.apache.poi.hssf.usermodel.HSSFWorkbook;\n\npublic class Test {\n\n    public static void main(String[] args) {\n        try {\n            HSSFWorkbook wb = new HSSFWorkbook();\n            HSSFSheet sheet = wb.createSheet();\n\n            for (int i = 0; i < 10; i++) {\n                HSSFRow row = sheet.createRow(i);\n                HSSFCell c1 = row.createCell((short) 0);\n                c1.setCellValue(new HSSFRichTextString(\"TEST\"));\n                HSSFCell c2 = row.createCell((short) 1);\n                c2.setCellValue(new HSSFRichTextString(\"TEST2\"));\n            }\n\n            sheet.removeRow(sheet.getRow(5));\n\n\n            FileOutputStream out = new FileOutputStream(\"C:\\\\2.xls\");\n            wb.write(out);\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n    }\n}\n\n\n\nexception:\njava.lang.ArrayIndexOutOfBoundsException: 2144\n\tat org.apache.poi.util.LittleEndian.putNumber(LittleEndian.java:511)\n\tat org.apache.poi.util.LittleEndian.putShort(LittleEndian.java:244)\n\tat org.apache.poi.hssf.record.EOFRecord.serialize(EOFRecord.java:80)\n\tat org.apache.poi.hssf.model.Sheet.serialize(Sheet.java:719)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.getBytes(HSSFWorkbook.java:937)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.write(HSSFWorkbook.java:875)\n\tat Test.main(Test.java:36)"}, {"count": 1, "tags": [], "creator": "amolweb@yahoo.com", "attachment_id": null, "is_private": false, "id": 92675, "time": "2006-08-29T14:39:00Z", "bug_id": 39989, "creation_time": "2006-08-29T14:39:00Z", "text": "I did verify that this bug exists in 3.0-alpha2 jar.\nHowever, this seems to be already fixed in SVN trunk."}]