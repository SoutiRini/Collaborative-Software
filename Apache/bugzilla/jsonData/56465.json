[{"count": 0, "tags": [], "text": "Created attachment 31565\nzip file containing 3 sample word documents\n\nWe processed some client documents where this exception was raised.  I can recreate the exception if I take a 'good' Word document, and zero out the last 100 or so bytes, samples attached.  I'm guessing the problem documents had an error when writing to disk.  The zeroed bytes \n\nMicrosoft Word opens these documents okay, and saving them in Word will fix them.\n\nAttached are\n1. original document\n2. corrupted version, I've zeroed out a bunch of bytes at the end, and slightly reduced the file size (matching the original client documents)\n3. fixed version, after opened and saved in Word 2013\n\nThe full exception is\n\n\njava.io.IOException: block[ 0 ] already removed - does your POIFS have circular or duplicate block references? \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 at org.apache.poi.poifs.storage.BlockListImpl.remove(BlockListImpl.java:89) \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 at org.apache.poi.poifs.storage.SmallDocumentBlockList.remove(SmallDocumentBlockList.java:30) \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 at org.apache.poi.poifs.storage.BlockAllocationTableReader.fetchBlocks(BlockAllocationTableReader.java:221) \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 at org.apache.poi.poifs.storage.BlockListImpl.fetchBlocks(BlockListImpl.java:123) \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 at org.apache.poi.poifs.storage.SmallDocumentBlockList.fetchBlocks(SmallDocumentBlockList.java:30) \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 at org.apache.poi.poifs.filesystem.POIFSFileSystem.processProperties(POIFSFileSystem.java:535) \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 at org.apache.poi.poifs.filesystem.POIFSFileSystem.<init>(POIFSFileSystem.java:164)", "is_private": false, "id": 174913, "creator": "peter.fetzer@nuix.com", "time": "2014-04-28T07:03:58Z", "bug_id": 56465, "creation_time": "2014-04-28T07:03:58Z", "attachment_id": 31565}, {"attachment_id": null, "tags": [], "creator": "apache@gagravarr.org", "is_private": false, "count": 1, "id": 174914, "time": "2014-04-28T07:29:34Z", "bug_id": 56465, "creation_time": "2014-04-28T07:29:34Z", "text": "Use NPOIFSFileSystem instead - it has a lower memory footprint AND fixes some deep seated issues POIFSFileSystem had with certain files where it got confused about circular references that didn't actually exist"}]