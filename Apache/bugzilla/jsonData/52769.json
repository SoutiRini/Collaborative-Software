[{"count": 0, "attachment_id": null, "bug_id": 52769, "text": "This is Ken Cheung, a Computer Science M.Phil. student. I observed some\ncode clones in Tomcat and found inconsistent code:\n\n/tomcat/trunk/java/org/apache/coyote/ajp/AjpMessage.java\n\n195\t        if (cc == null) {\n196\t            log.error(sm.getString(\"ajpmessage.null\"),\n197\t                    new NullPointerException());\n198\t            appendInt(0);\n199\t            appendByte(0);\n200\t            return;\n201\t        }\n202\t        int start = cc.getStart();\n203\t        int end = cc.getEnd();\n204\t        appendInt(end - start);\n205\t        char[] cbuf = cc.getBuffer();\n206\t        for (int i = start; i < end; i++) {\n207\t            char c = cbuf[i];\n208\t            // Note:  This is clearly incorrect for many strings,\n209\t            // but is the only consistent approach within the current\n210\t            // servlet framework.  It must suffice until servlet output\n211\t            // streams properly encode their output.\n212\t            if (((c <= 31) && (c != 9)) || c == 127 || c > 255) {\n213\t                c = ' ';\n214\t            }\n215\t            appendByte(c);\n216\t        }\n217\t        appendByte(0);\n\n/tomcat/trunk/java/org/apache/coyote/ajp/AjpMessage.java\n\n230\t        if (str == null) {\n231\t            log.error(sm.getString(\"ajpmessage.null\"),\n232\t                    new NullPointerException());\n233\t            appendInt(0);\n234\t            appendByte(0);\n235\t            return;\n236\t        }\n237\t        int len = str.length();\n238\t        appendInt(len);\n239\t        for (int i = 0; i < len; i++) {\n240\t            char c = str.charAt (i);\n241\t            // Note:  This is clearly incorrect for many strings,\n242\t            // but is the only consistent approach within the current\n243\t            // servlet framework.  It must suffice until servlet output\n244\t            // streams properly encode their output.\n245\t            if (((c <= 31) && (c != 9)) || c == 127 || c > 255) {\n246\t                c = ' ';\n247\t            }\n248\t            appendByte(c);\n249\t        }\n250\t        appendByte(0);\n\nQuick description of the inconsistency\nTwo code snippets are very similar code, but as you see, both codes use different ways to compute the condition of for loop.\n\nWe thought it could be a potential bug or inconsistency. Hope this helps.", "id": 154142, "time": "2012-02-25T14:55:14Z", "creator": "msrbugzilla@gmail.com", "creation_time": "2012-02-25T14:55:14Z", "tags": [], "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 52769, "text": "> We thought it could be a potential bug or inconsistency. Hope this helps.\n\nBugzilla is not for reporting \"potential bugs\". If you aren't 100% sure you are reporting a bug you shouldn't be going anywhere near Bugzilla. Just because you don't understand something, that does not make it a bug.\n\nIf there is a part of the Tomcat source code you don't understand, the users list (not the developers list) is the place to seek clarification.\n\nThere is no bug here. If you want an explanation of why, the users list is the place to ask.", "id": 154155, "time": "2012-02-25T23:31:24Z", "creator": "markt@apache.org", "creation_time": "2012-02-25T23:31:24Z", "tags": [], "is_private": false}]