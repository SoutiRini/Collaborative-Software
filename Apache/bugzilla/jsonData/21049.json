[{"count": 0, "tags": [], "bug_id": 21049, "is_private": false, "text": "The HSSFWorkBook construct throws exception when trying to instantiate an excel \nworkbook from a large excel document. Specifically, the document has more than \n14,000 rows. \nWhen reducing the number of rows to ~7,000 no exception is thrown. Must be \nsomething to do with the number of rows.\n\nBelow is the exception:\njava.lang.reflect.InvocationTargetException: \njava.lang.ArrayIndexOutOfBoundsException\n        at org.apache.poi.util.LittleEndian.getNumber(LittleEndian.java:557)\n        at org.apache.poi.util.LittleEndian.getInt(LittleEndian.java:177)\n        at org.apache.poi.hssf.record.BOFRecord.fillFields(BOFRecord.java:170)\n        at org.apache.poi.hssf.record.Record.fillFields(Record.java:143)\n        at org.apache.poi.hssf.record.Record.<init>(Record.java:105)\n        at org.apache.poi.hssf.record.BOFRecord.<init>(BOFRecord.java:135)\n        at java.lang.reflect.Constructor.newInstance(Native Method)\n        at org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java:257)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java:193)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:199)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:166)\n        at ExcelReader.main(ExcelReader.java:73)\nException in thread \"main\" org.apache.poi.hssf.record.RecordFormatException: \nUnable to construct record instance, the following exception occured: null\n        at org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java:270)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java:193)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:199)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:166)\n        at ExcelReader.main(ExcelReader.java:73)", "id": 39347, "time": "2003-06-24T14:37:15Z", "creator": "gnangoma@hotmail.com", "creation_time": "2003-06-24T14:37:15Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 21049, "attachment_id": null, "text": "No, you're attempting to read like an Excel 95 file..  The bof record isnt' in\nthe correct format so its balking.  We don't support pre Excel 97 files (which\nincludes Star Office 5.0 or 5.1 [don't remember] written excel files BTW)", "id": 41411, "time": "2003-07-24T16:58:53Z", "creator": "poi-support@buni.org", "creation_time": "2003-07-24T16:58:53Z", "is_private": false}]