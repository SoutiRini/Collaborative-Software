[{"count": 0, "tags": [], "creator": "bob@yrrid.com", "text": "For apache-ant-1.7.0Beta3 and ant-contrib-1.0b3\nant run-dummy causes OutOfMemoryError where:\n\n   <target name=\"run-dummy\" >\n      <for param=\"i\" begin=\"1\" end=\"5000000\">\n        <sequential>\n          <echo message=\"i is @{i}\" />\n          <antcall target=\"dummy\" />\n        </sequential>\n      </for>\n   </target>\n\n   <target name=\"dummy\" >\n      <for param=\"j\" begin=\"1\" end=\"50\">\n        <sequential>\n          <echo message=\"   j is @{j}\" />\n        </sequential>\n      </for>\n   </target>\n\nWill only run i < 400.\nTried <macrodef>, the memory leak is less, but is still there:\n\n   <target name=\"run-dummyalt\" >\n      <for param=\"i\" begin=\"1\" end=\"5000000\">\n        <sequential>\n          <echo message=\"i is @{i}\" />\n          <dummyalt/>\n        </sequential>\n      </for>\n   </target>\n\n   <macrodef name=\"dummyalt\">\n      <sequential>\n      <for param=\"j\" begin=\"1\" end=\"50\">\n        <sequential>\n          <echo message=\"   j is @{j}\" />\n        </sequential>\n      </for>\n      </sequential>\n   </macrodef>", "id": 96228, "time": "2006-11-27T13:47:01Z", "bug_id": 41049, "creation_time": "2006-11-27T13:47:01Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "text": "Is this a regression?  i.e., does it work in Ant 1.6.5?", "attachment_id": null, "bug_id": 41049, "id": 96237, "time": "2006-11-27T14:36:38Z", "creator": "mbenson@apache.org", "creation_time": "2006-11-27T14:36:38Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 41049, "attachment_id": null, "text": "It has actually being fixed in ant 1.7.0rc1.", "id": 96239, "time": "2006-11-27T14:39:14Z", "creator": "peterreilly@apache.org", "creation_time": "2006-11-27T14:39:14Z", "is_private": false}, {"count": 3, "tags": [], "creator": "bob@yrrid.com", "text": "Yes, the memory leak is essentially fixed in apache-ant-1.7.0RC1.\nYet there is still an extremely small leak.  You have to let 'run-dummy' a long \ntime (30 min.+) to notice it.\nThere is also a memory leak with the <macrodef> version of the test task 'run-\ndummyalt' (BTW 'run-dummyalt' runs a lot faster than the 'run-dummy' \n<target><antcall> version):\n\n   <target name=\"run-dummyalt\" >\n      <for param=\"i\" begin=\"1\" end=\"5000000\">\n        <sequential>\n          <echo message=\"i is @{i}\" />\n          <dummyalt/>\n        </sequential>\n      </for>\n   </target>\n\n   <macrodef name=\"dummyalt\">\n      <sequential>\n      <for param=\"j\" begin=\"1\" end=\"50\">\n        <sequential>\n          <echo message=\"   j is @{j}\" />\n        </sequential>\n      </for>\n      </sequential>\n   </macrodef>\n", "id": 96305, "time": "2006-11-28T14:51:56Z", "bug_id": 41049, "creation_time": "2006-11-28T14:51:56Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "bob@yrrid.com", "text": "ant run-dummyalt fails:\n     [echo] i is 21706\n     [echo]    j is 1\n[...]\n     [echo]    j is 40\n\nBUILD FAILED\n[...]\nC:\\Users\\Bob\\work\\_LOF_QA\\Nialls\\newProject\\LPTRunner\\build.xml:279: \njava.lang.OutOfMemoryError", "id": 96313, "time": "2006-11-28T16:42:20Z", "bug_id": 41049, "creation_time": "2006-11-28T16:42:20Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "peterreilly@apache.org", "attachment_id": null, "id": 96360, "time": "2006-11-29T06:42:55Z", "bug_id": 41049, "creation_time": "2006-11-29T06:42:55Z", "is_private": false, "text": "Thanks for the information and the test file.\nI have found the source the the leakage.\nComponentHelper attempts to keep track\nof all created tasks and invalidate the\ntask instance if the task definition changes.\n\nWith changes in the way ant works in ant 1.6 and ant 1.7\nfrom ant 1.5, I do not think that ComponentHelper\nneeds to keep track of the tasks.\n\n"}, {"count": 6, "tags": [], "creator": "peterreilly@apache.org", "attachment_id": null, "id": 96712, "time": "2006-12-10T14:26:34Z", "bug_id": 41049, "creation_time": "2006-12-10T14:26:34Z", "is_private": false, "text": "I have commmitted the change to ComponentHelper.\nYou should be able to test with the next nightly\nbuild or with ant 1.7.0RC2.\n"}]