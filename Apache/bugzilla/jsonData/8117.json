[{"count": 0, "tags": [], "text": "The system is a linux 2.2.20 system in which linux simply stops accepting \nrequests.  This magically started happening today and had been happening every \nfew minutes since this afternoon.  I had tried a server reboot as well with no \nluck.  Seems that an strace says that the master process is doing the following \nin a loop.  Other processes are just waiting with a sh...() command and sit \nthere.  I'm not sure why new HTTP requests aren't coming in and basically most \nof the children die off and the server load hits zero.  This happens until the \nserver is restarted.  Not sure why this is happening today when it hasn't for \nthe few months since 1.3.23 came out.  Any ideas why or what info do I need to \nprovide to help determine this.  Thanks in advance.\n--\nMike\n\nMASTER PROCESS:\ntime(NULL)                              = 1018893180\nwait4(-1, 0xbffffd80, WNOHANG, NULL)    = 0\nselect(0, NULL, NULL, NULL, {1, 0})     = 0 (Timeout)\ntime(NULL)                              = 1018893181\nwait4(-1, 0xbffffd80, WNOHANG, NULL)    = 0\nselect(0, NULL, NULL, NULL, {1, 0})     = 0 (Timeout)", "is_private": false, "id": 13665, "creator": "mike@epicworks.com", "time": "2002-04-15T18:13:08Z", "bug_id": 8117, "creation_time": "2002-04-15T18:13:08Z", "attachment_id": null}, {"count": 1, "text": "This problem is occuring every few minutes on one of our main production \nservers and I must find out why, but we are all stumped after working on this \nall morning.  Any suggestions?\n\nMore info:\n  All of the children are sitting at the following when it is not accepting any \nfurther requests:\n\nsemop(1920, 0x8398910, 1 \n\nThey all have the identical values in the semop statement.  As well, the master \nprocess just sits there and does the following:\n\nselect(0, NULL, NULL, NULL, {0, 980000}) = 0 (Timeout)\ntime(NULL)                              = 1018895322\nwait4(-1, 0xbffffd80, WNOHANG, NULL)    = 0\nselect(0, NULL, NULL, NULL, {1, 0})     = 0 (Timeout)\ntime(NULL)                              = 1018895323\nwait4(-1, 0xbffffd80, WNOHANG, NULL)    = 0\nselect(0, NULL, NULL, NULL, {1, 0})     = 0 (Timeout)\ntime(NULL)                              = 1018895324\nwait4(-1, 0xbffffd80, WNOHANG, NULL)    = 0", "bug_id": 8117, "attachment_id": null, "id": 13666, "time": "2002-04-15T18:32:56Z", "creator": "mike@epicworks.com", "creation_time": "2002-04-15T18:32:56Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "mike@epicworks.com", "attachment_id": null, "text": "Telnetting to port 80 results in nothing at all.  it can not make the \nconnection and the command just hangs there.  Restarting the apache daemon \n(using a full stop and start) and then trying telnet establishes a connection \ninstantly.  The reasoning is undetermined why it is not accepting a connection \nand the situation has consumed the entire day.  We are looking to discover why \nand to fix the problem immediately.  The number of children shrinks and does \nnot increase, so we are wondering why it is not accepting new connections.  Any \nideas?", "id": 13682, "time": "2002-04-15T20:06:06Z", "bug_id": 8117, "creation_time": "2002-04-15T20:06:06Z", "is_private": false}, {"count": 3, "text": "Anything interesting in the error log?  What is the output of httpd -V ?  Of httpd -l ? ", "bug_id": 8117, "attachment_id": null, "id": 13683, "time": "2002-04-15T20:27:24Z", "creator": "jwoolley@apache.org", "creation_time": "2002-04-15T20:27:24Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 8117, "text": "Just recompiled earlier today with 1.3.24 to see if it helps.  Same thing keeps \nhappening at the same frequency.  Here is the values from 1.3.24 (it was \nconfigured with the same options as 1.3.23 and same everything).\n\n\n#http -V\nServer version: Apache/1.3.24 (Unix)\nServer built:   Apr 15 2002 15:23:36\nServer's Module Magic Number: 19990320:11\nServer compiled with....\n -D EAPI\n -D EAPI_MM\n -D EAPI_MM_CORE_PATH=\"/var/run/httpd.mm\"\n -D HAVE_MMAP\n -D HAVE_SHMGET\n -D USE_SHMGET_SCOREBOARD\n -D USE_MMAP_FILES\n -D HAVE_FCNTL_SERIALIZED_ACCEPT\n -D HAVE_SYSVSEM_SERIALIZED_ACCEPT\n -D SINGLE_LISTEN_UNSERIALIZED_ACCEPT\n -D HTTPD_ROOT=\"/usr\"\n -D SUEXEC_BIN=\"/usr/bin/suexec\"\n -D DEFAULT_PIDLOG=\"/var/run/httpd.pid\"\n -D DEFAULT_SCOREBOARD=\"/var/run/httpd.scoreboard\"\n -D DEFAULT_LOCKFILE=\"/var/run/httpd.lock\"\n -D DEFAULT_XFERLOG=\"/logs/http/access_log\"\n -D DEFAULT_ERRORLOG=\"/logs/http/error_log\"\n -D TYPES_CONFIG_FILE=\"/conf/http/mime.types\"\n -D SERVER_CONFIG_FILE=\"/conf/http/httpd.conf\"\n -D ACCESS_CONFIG_FILE=\"/conf/http/access.conf\"\n -D RESOURCE_CONFIG_FILE=\"/conf/http/srm.conf\"\n\n\n# httpd -l\nCompiled-in modules:\n  http_core.c\n  mod_env.c\n  mod_log_config.c\n  mod_mime.c\n  mod_negotiation.c\n  mod_status.c\n  mod_include.c\n  mod_autoindex.c\n  mod_dir.c\n  mod_cgi.c\n  mod_asis.c\n  mod_imap.c\n  mod_actions.c\n  mod_alias.c\n  mod_rewrite.c\n  mod_access.c\n  mod_auth.c\n  mod_setenvif.c\n  mod_ssl.c\n  mod_php4.c\nsuexec: enabled; valid wrapper /usr/bin/suexec", "id": 13684, "time": "2002-04-15T20:31:46Z", "creator": "mike@epicworks.com", "creation_time": "2002-04-15T20:31:46Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 8117, "attachment_id": null, "id": 13686, "time": "2002-04-15T20:46:47Z", "creator": "jwoolley@apache.org", "creation_time": "2002-04-15T20:46:47Z", "is_private": false, "text": "What happens if you use a different setting for AcceptMutex? "}, {"count": 6, "tags": [], "bug_id": 8117, "is_private": false, "text": "Which value would you recommend for AcceptMutex?", "id": 13687, "time": "2002-04-15T20:49:12Z", "creator": "mike@epicworks.com", "creation_time": "2002-04-15T20:49:12Z", "attachment_id": null}, {"count": 7, "attachment_id": null, "bug_id": 8117, "is_private": false, "id": 13688, "time": "2002-04-15T20:50:45Z", "creator": "mike@epicworks.com", "creation_time": "2002-04-15T20:50:45Z", "tags": [], "text": "As well, I can only set this at compile time now..  Not sure what it is at \nnow.  Why would it work for a good two years with this option until this \nafternoon?  Not sure why it breaks."}, {"count": 8, "tags": [], "text": "Your system appears to support sysvsem and fcntl serialization, so try either one of  \nthose.  I don't remember if either one is known to have problems with Linux 2.2 or not.   \nI suppose it's a possibility.  I don't know if this is the cause or not.  I'm just \npicking at straws here.  I don't suppose you changed kernel revisions anytime recently, \nor made any other changes to the system that could have triggered this?  For \ncompleteness, please attach your config file to this report. ", "is_private": false, "id": 13689, "creator": "jwoolley@apache.org", "time": "2002-04-15T20:58:17Z", "bug_id": 8117, "creation_time": "2002-04-15T20:58:17Z", "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 8117, "text": "AcceptMutex is a config file directive, by the way.  You shouldn't need to recompile. ", "id": 13690, "time": "2002-04-15T20:59:30Z", "creator": "jwoolley@apache.org", "creation_time": "2002-04-15T20:59:30Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 8117, "attachment_id": null, "text": "Just as a data point: I occasionally see reports of \"stuck\" processes on the \nnewgroup.  They almost always involve people using mod_ssl/EAPI.  We don't\nsupport that module for Apache 1.3 from this site.", "id": 13691, "time": "2002-04-15T21:00:43Z", "creator": "slive@apache.org", "creation_time": "2002-04-15T21:00:43Z", "is_private": false}, {"count": 11, "tags": [], "bug_id": 8117, "is_private": false, "text": "When I do an STRACE, after a few seconds I get this error repeatedly.  Any idea \nwhy?\n\n\"sys_fork: tcb table full\"\n\n", "id": 13699, "time": "2002-04-15T22:11:39Z", "creator": "mike@epicworks.com", "creation_time": "2002-04-15T22:11:39Z", "attachment_id": null}, {"count": 12, "text": "Here's something much weirder.  It does this on all of the different \nacceptmutex methods (but at different efficiencies) but here's what I found.  \nWhen it happens, telnet localhost 80 hangs there trying to connect.  telnet \nlocalhost 443 connets fine and processes the request.  Clearly it's something \nwith accepting more connections to port 80.  Could this be an operating system \nissue (Linux 2.2.20)?  I can establish more connections to other ports without \na problem. I assume it's just no longer listening and getting requests.  Any \nideas?  This is becoming quite the hastle and I'd love to work with soemone to \nresolve it.\n\n", "bug_id": 8117, "is_private": false, "id": 13851, "time": "2002-04-17T13:48:02Z", "creator": "mike@epicworks.com", "creation_time": "2002-04-17T13:48:02Z", "tags": [], "attachment_id": null}, {"count": 13, "tags": [], "creator": "gunnjo@voicenet.com", "attachment_id": null, "is_private": false, "id": 30713, "time": "2003-02-05T06:28:54Z", "bug_id": 8117, "creation_time": "2003-02-05T06:28:54Z", "text": "Re: Bugzilla Bug 8117\n From: \"Michael Krieger\" \n To: \"Joseph J. Gunn\" <gunnjo@voicenet.com>\n \nHi Joseph,\n    This issue is long gone and has been resolved.  I thank you for your\ntime however.  This has come up for a number of various reasons including\nlooping HTTP opens, as well as still unkown reasons in which upgrading to\nnewer versions, restarting the daemon, or recompiling repaired the problem.\nI have not experienced the problem in quite some time and have dismissed it\nas a fluke of the time.\n\nCheers;\n--\nMichael Krieger\nLead Administrator\nEpic Works Ltd.\n\n"}]