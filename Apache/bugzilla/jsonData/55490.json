[{"count": 0, "tags": [], "creator": "sebastian@opencollada.org", "attachment_id": 30769, "is_private": false, "id": 169742, "time": "2013-08-27T19:57:40Z", "bug_id": 55490, "creation_time": "2013-08-27T19:57:40Z", "text": "Created attachment 30769\nSimple empty MSI file with BigBlocks\n\nWe are developing a MSI reader/writer based upon POIFS. Using a x64 Windows 7 and WIX we create MSI files that can not be modified by POIFS.\n\nThe file can be created by using:\n  candle.exe minimal.wxs -o tmp.wixobj\n  light tmp.wixobj -pdbout tmp.wixpdb -o empty.msi\n\nThe resulting MSI is attached to this bug report. The testcase to create a corrupt OLE2 document is rather simple:\n\nFileInputStream  istream = new FileInputStream(\"empty.msi\");\nFileOutputStream ostream = new FileOutputStream(\"empty2.msi\");\n\nnew POIFSFileSystem(istream).writeFilesystem(ostream);\nistream.close();\nostream.close();\n\nWe suspect that BigBlocks are the critical part.\nThanks in advance!"}, {"count": 1, "tags": [], "creator": "sebastian@opencollada.org", "attachment_id": 30770, "text": "Created attachment 30770\nMinimal WIX configuration to create the MSI file", "id": 169743, "time": "2013-08-27T19:58:53Z", "bug_id": 55490, "creation_time": "2013-08-27T19:58:53Z", "is_private": false}, {"count": 2, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "POIFS has some limited support for non-512 blocks, but it's not ideal, and not really fixable. The POIFSFileSystem code has some assumptions backed in very deeply, which are almost but not always correct...\n\nNPOIFS should work fine with both 512 and 4k blocks. The various problems spotted with POIFSFileSystem have been fixed in NPOIFSFileSystem\n\nHowever... NPOIFSFileSystem doesn't quite have write support. It's almost all there, but there's one or two failing unit tests to fix. I've been meaning to go back to it to finish it, but that has been the case for 2 or 3 years now :/\n\nIf you have a bit of time, I'd suggest you switch to NPOIFS, and give a hand to squash those last few bugs!", "id": 169752, "time": "2013-08-27T22:01:58Z", "bug_id": 55490, "creation_time": "2013-08-27T22:01:58Z", "is_private": false}, {"count": 3, "tags": [], "creator": "sebastian@opencollada.org", "attachment_id": null, "is_private": false, "id": 169758, "time": "2013-08-28T08:26:46Z", "bug_id": 55490, "creation_time": "2013-08-28T08:26:46Z", "text": "That did the trick! Thank you very much, I'll verify that everything is working as expected and report back.\nSebastian"}, {"count": 4, "tags": [], "bug_id": 55490, "is_private": false, "text": "Seems to basically work with using NPOIFSFileSystem, additional bugs should probably be handled in separate bug entries.", "id": 181977, "time": "2015-03-22T21:52:36Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-03-22T21:52:36Z", "attachment_id": null}]