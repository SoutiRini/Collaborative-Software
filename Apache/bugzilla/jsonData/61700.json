[{"count": 0, "tags": [], "bug_id": 61700, "text": "I think getForceFormulaRecalculation is implemented wrong.\n\n\nSome logging code in my applicaiton\n>>>\nboolean forceFormulaRecalculation = workbook.getForceFormulaRecalculation();\nlog.error(\"Will excel recalculate? {}\", forceFormulaRecalculation);\nworkbook.setForceFormulaRecalculation(true);\nboolean forceFormulaRecalculation2 = workbook.getForceFormulaRecalculation();\n>>>\n\nExpected Behavior\n- Will excel recalculate? false\n- Will excel recalculate after setting to true? true\n\n\nActual behavior\n- Will excel recalculate? true\n- Will excel recalculate after setting to true? false\n\n\nShouldn't this line of code here be \n\nreturn calcPr != null && calcPr.getCalcId() == 0;\n\nhttps://github.com/apache/poi/blob/REL_3_17_FINAL/src/ooxml/java/org/apache/poi/xssf/usermodel/XSSFWorkbook.java#L2232\n\n\n\nAdditional Context:\nXSSF workbook", "id": 201800, "time": "2017-10-31T00:47:56Z", "creator": "jchezenko@gmail.com", "creation_time": "2017-10-31T00:47:56Z", "is_private": false, "attachment_id": null}, {"text": "https://poi.apache.org/spreadsheet/eval.html#Recalculation+of+Formulas\n\n@Test\npublic void testWorkbookForceFormulaRecalculation() throws Exception {\n    Workbook workbook = _testDataProvider.createWorkbook();\n    workbook.createSheet().createRow(0).createCell(0).setCellFormula(\"B1+C1\");\n    workbook.getCreationHelper().createFormulaEvaluator().evaluateAll();\n\n    assertFalse(workbook.getForceFormulaRecalculation());\n    workbook.setForceFormulaRecalculation(true);\n    assertTrue(workbook.getForceFormulaRecalculation());\n\n    Workbook wbBack = _testDataProvider.writeOutAndReadBack(workbook);\n    assertTrue(wbBack.getForceFormulaRecalculation());\n\n    workbook.close();\n    wbBack.close();\n}", "tags": [], "bug_id": 61700, "attachment_id": null, "count": 1, "id": 201810, "time": "2017-10-31T09:18:44Z", "creator": "onealj@apache.org", "creation_time": "2017-10-31T09:18:44Z", "is_private": false}]