[{"count": 0, "tags": [], "bug_id": 21485, "text": "When starting the apache webserver with the ssl module activated, all requests\nto either the standard or secure ports (80 or 443) are not answered.  Browsers\nwill hang when talking to these ports.  I can duplicate this across multiple\nultrasparc based systems.\n\ncommon system info;\nGentoo Linux\ngcc 3.2.3\nglibc 2.3.1", "id": 40413, "time": "2003-07-11T00:54:04Z", "creator": "weeve@gentoo.org", "creation_time": "2003-07-11T00:54:04Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 21485, "text": "So turning off SSL allows pages to be served fine?\n\nWhich MPM are you using?  If you're currently using the worker MPM, does\nswitching to prefork MPM make it work?\n\nSince this is Linux and a mysterious problem at that, switching to the prefork\nMPM is going to vastly improve our chances at understanding the cause.\n\nWhat is the traceback of the httpd process handling the browser connection after\nit hangs?  (attach with gdb once it has hung and do \"where\")\n\nWhat is system trace of the httpd process handling the browser connection up\nuntil the point where it hangs?  (strace -p ####, where #### is the pid of some\nhttpd process; keep opening requests from the browser until that process handles\nthe request)\n", "id": 40436, "time": "2003-07-11T10:56:50Z", "creator": "trawick@apache.org", "creation_time": "2003-07-11T10:56:50Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 21485, "attachment_id": null, "is_private": false, "id": 40566, "time": "2003-07-13T01:36:34Z", "creator": "weeve@gentoo.org", "creation_time": "2003-07-13T01:36:34Z", "text": "Yes, turning off SSL allows pages to be served fine.\n\nThe MPM in use was prefork.  I tried switching to worker to see if that changed\nanything but it did not.  I have since switched back to prefork.\n\nThe output from gdb is as follows;(gdb) where\n#0  0x705b7ff4 in select () from /lib/libc.so.6\n#1  0x70334ed8 in apr_sleep () from /usr/lib/libapr-0.so.0\n#2  0x0003b944 in ap_wait_or_timeout ()\n#3  0x0002cbe0 in ap_mpm_run ()\n#4  0x0003464c in main ()\n#5  0x704f47f4 in __libc_start_main () from /lib/libc.so.6\n\nI tried strace'ing the various apache processes and all I could get to come back\nwas an endless loop of the following (and only from one of the processes\nrunning, not all);\n\nselect(0, NULL, NULL, NULL, {1, 0})     = 0 (Timeout)\nwait4(-1, 0xefff8034, WNOHANG|WUNTRACED, NULL) = 0\n\nI also tried strace'ing with SSL turned off and it was much more responsive,\nthough using a shell script to have wget endlessly fetch the default index.html\nfile was always handled by the same apache process.\n\n\n\n\n"}, {"count": 3, "tags": [], "creator": "wrowe@apache.org", "text": "\n  Just an oddball thought, perhaps this is a thundering hurd or problem with\n  the AcceptMutex itself.\n\n  Could you try different variations of the AcceptMutex directive in order to\n  narrow down the problem, and see if this affects the behavior?\n\n  http://httpd.apache.org/docs-2.0/mod/mpm_common.html#acceptmutex\n\n  To really prove this theory, if you add a second Listen directive for port\n  8080 and disable SSL, the same behavior will result.\n", "id": 41255, "time": "2003-07-23T18:11:51Z", "bug_id": 21485, "creation_time": "2003-07-23T18:11:51Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 21485, "attachment_id": null, "id": 43216, "time": "2003-08-24T18:08:14Z", "creator": "weeve@gentoo.org", "creation_time": "2003-08-24T18:08:14Z", "is_private": false, "text": "Sorry for the delay in responding.\n\nIf I add another Listen port to the config with SSL turned off (using Default\nAcceptMutex), it replicates the problem with enabling SSL.\n\nIn trying your AcceptMutex suggestiom, I found that flock and fcntl work. \nDefault and sysvsem do not work, and posixsem and pthread don't appear to be\nvalid for the sparc64 architecture."}, {"count": 5, "tags": [], "creator": "jorton@redhat.com", "text": "What was the default mutex implementation choice on this platform? You are\nreally using a 64-bit sparc64 build here not 32-bit?", "id": 48120, "time": "2003-11-25T21:47:00Z", "bug_id": 21485, "creation_time": "2003-11-25T21:47:00Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "creator": "weeve@gentoo.org", "attachment_id": null, "is_private": false, "id": 48123, "time": "2003-11-25T22:24:15Z", "bug_id": 21485, "creation_time": "2003-11-25T22:24:15Z", "text": "For both apache 1.3.x and apache 2.0.x, the default mutex is sysvsem.\n\nThis is using a 32 bit userland on sparc64 (only 64 bit component is the kernel\n(and the associated binutils and gcc to build it))."}, {"count": 7, "tags": [], "bug_id": 21485, "text": "Was this problem ever resolved?\n", "id": 54449, "time": "2004-03-23T01:30:16Z", "creator": "trawick@apache.org", "creation_time": "2004-03-23T01:30:16Z", "is_private": false, "attachment_id": null}, {"count": 8, "attachment_id": null, "bug_id": 21485, "is_private": false, "id": 54450, "time": "2004-03-23T02:25:54Z", "creator": "weeve@gentoo.org", "creation_time": "2004-03-23T02:25:54Z", "tags": [], "text": "It's now working in 2.0.49 and 1.3.29 using the value of Default for AcceptMutex\n(which is sysvsem).  Not sure what changed, but it seems to do the trick"}, {"count": 9, "tags": [], "creator": "trawick@apache.org", "attachment_id": null, "id": 54465, "time": "2004-03-23T11:08:21Z", "bug_id": 21485, "creation_time": "2004-03-23T11:08:21Z", "is_private": false, "text": "If you find out how to hit the problem again, please re-open.\n\nThanks for using Apache!\n"}]