[{"count": 0, "tags": [], "bug_id": 44548, "attachment_id": null, "id": 114344, "creation_time": "2008-03-06T08:36:02Z", "time": "2008-03-06T08:36:02Z", "creator": "sheetal.pathak@virginmedia.co.uk", "text": "Hi,\n\nOur application reads the contents of the MSExcel file uploaded at the server and generates HTML Table of each sheet in the excel file.\n\nIf the MSExcel sheet contains formula fields then, POI is not able to create the workbook.\n\nBut if the same MSExcel file is opened in Open Office and saved and then fed to POI then it works absolutely fine.\n\nDo you have any idea why doesnt POI is able to read MSExcel sheet without it being opened and saved in Open Office.", "is_private": false}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 114346, "time": "2008-03-06T08:42:33Z", "bug_id": 44548, "creation_time": "2008-03-06T08:42:33Z", "is_private": false, "text": "POI should have no problems reading files containing formulas\n\nCould you please upload one of your problem files, and a code snippet that's currently failing for this file? We'll also need to know what version of excel generated the file."}, {"count": 2, "tags": [], "text": "Created attachment 21640\nFile which fails to be read with POI\n\nThis is the file which fails when read with POI 3.1\nBut if the same file is opened and saved in Open office and then fed to POI , then it read fine.", "attachment_id": 21640, "bug_id": 44548, "id": 114349, "time": "2008-03-06T09:04:47Z", "creator": "sheetal.pathak@virginmedia.co.uk", "creation_time": "2008-03-06T09:04:47Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 44548, "attachment_id": null, "text": "WARN. Unread 77 bytes of record 0x18\nWARN. Unread 103 bytes of record 0x18\nWARN. Unread 103 bytes of record 0x18\nWARN. Unread 103 bytes of record 0x18\nWARN. Unread 104 bytes of record 0x18\nWARN. Unread 77 bytes of record 0x18\nWARN. Unread 103 bytes of record 0x18\nWARN. Unread 103 bytes of record 0x18\nWARN. Unread 7 bytes of record 0x1c1\nWARN. Unread 6589 bytes of record 0xeb\nWARN. Unread 8223 bytes of record 0xfc\nWARN. Unread 7986 bytes of record 0x3c\nCannot create Workbook so reject this file.\njava.lang.IndexOutOfBoundsException: Index: 571, Size: 0\n        at java.util.ArrayList.RangeCheck(ArrayList.java:546)\n        at java.util.ArrayList.get(ArrayList.java:321)\n        at org.apache.poi.util.IntMapper.get(IntMapper.java:81)\n        at org.apache.poi.hssf.record.SSTRecord.getString(SSTRecord.java:195)\n        at org.apache.poi.hssf.model.Workbook.getSSTString(Workbook.java:729)\n        at org.apache.poi.hssf.usermodel.HSSFRichTextString.<init>(HSSFRichTextString.java:57)\n        at org.apache.poi.hssf.usermodel.HSSFCell.<init>(HSSFCell.java:202)\n        at org.apache.poi.hssf.usermodel.HSSFRow.createCellFromRecord(HSSFRow.java:193)\n        at org.apache.poi.hssf.usermodel.HSSFSheet.setPropertiesFromSheet(HSSFSheet.java:177)\n        at org.apache.poi.hssf.usermodel.HSSFSheet.<init>(HSSFSheet.java:131)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:226)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:148)\n        at com.ch2m.gsri.wizards.ExcelSheetBean.getExcelSheetNames(ExcelSheetBean.java:37)\n        at org.apache.jsp.validate_jsp._jspService(validate_jsp.java:255)\n        at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:98)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:328)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:315)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:265)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:269)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:210)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:174)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:117)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:108)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:151)\n        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:870)\n        at org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:665)\n        at org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:528)\n        at org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:81)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:685)\n        at java.lang.Thread.run(Thread.java:595)\n", "id": 114350, "time": "2008-03-06T09:05:37Z", "creator": "sheetal.pathak@virginmedia.co.uk", "creation_time": "2008-03-06T09:05:37Z", "is_private": false}, {"count": 4, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 114351, "time": "2008-03-06T09:11:43Z", "bug_id": 44548, "creation_time": "2008-03-06T09:11:43Z", "is_private": false, "text": "The errors tend to indicate a very messed up file. Where did it come from?"}, {"count": 5, "tags": [], "bug_id": 44548, "attachment_id": null, "text": "This file is frm our customers.\nWhat special thing does Open office does, which makes sense to POI, any idea?", "id": 114352, "time": "2008-03-06T09:14:16Z", "creator": "sheetal.pathak@virginmedia.co.uk", "creation_time": "2008-03-06T09:14:16Z", "is_private": false}, {"count": 6, "tags": [], "creator": "apache@gagravarr.org", "text": "OpenOffice may be more tollerant of borderline corrupt files than POI is\n\nUnless we know how the file was created, and that it's really valid to be in that messed-up a state, it's unlikely that we'll hack poi with workarounds for a file this broken\n\nPlease re-open the bug if you're able to confirm this file really came from excel, and hasn't been corrupted since then", "id": 114354, "time": "2008-03-06T09:27:31Z", "bug_id": 44548, "creation_time": "2008-03-06T09:27:31Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "text": "Microsoft Excel 97 - Excel 2003 & 5.0/95 Workbook \n\nMicrosoft Office Excel Workbook.\n\nThese are the two forms in which the file could be saved as.\nIt is really valid to be in that messed up state.\n\n\nAnother thing is, if the same file (sheet) is copied and do a paste special with values only option then also even if it is not touched by open office POI reads is fine.\n\nour apologies, but please let us know what best can u do for us.", "attachment_id": null, "id": 114355, "creation_time": "2008-03-06T09:40:56Z", "time": "2008-03-06T09:40:56Z", "creator": "sheetal.pathak@virginmedia.co.uk", "bug_id": 44548, "is_private": false}, {"count": 8, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 114356, "time": "2008-03-06T09:49:59Z", "bug_id": 44548, "creation_time": "2008-03-06T09:49:59Z", "is_private": false, "text": "You still haven't said how the file was created. What version of excel? Is this problem reproducable with other files, or is it just this one file?"}, {"attachment_id": null, "tags": [], "bug_id": 44548, "is_private": false, "count": 9, "id": 114358, "time": "2008-03-06T09:55:23Z", "creator": "sheetal.pathak@virginmedia.co.uk", "creation_time": "2008-03-06T09:55:23Z", "text": "The file was created using MS Office Excel 2003 and is reproducable in all other files which contains the formulae  e.g. - Cell: H22 in PAF sheet.\n\n"}, {"count": 10, "tags": [], "text": "I opened the attached file using Excel 2004 for Mac.\n\nIt contains macros, so I clicked to open the file with Macros disabled. Excel then reported that the file contains Excel 4.0 Macros which cannot be disabled.\n\nI don't think that POI supports the Excel file format from before Excel 5.0.\n\nThis could be the problem. What happens if you remove the macros?\n", "is_private": false, "id": 114362, "creation_time": "2008-03-06T10:09:30Z", "time": "2008-03-06T10:09:30Z", "creator": "dfisher@jmlafferty.com", "bug_id": 44548, "attachment_id": null}, {"count": 11, "tags": [], "creator": "sheetal.pathak@virginmedia.co.uk", "attachment_id": null, "id": 114363, "time": "2008-03-06T10:17:28Z", "bug_id": 44548, "creation_time": "2008-03-06T10:17:28Z", "is_private": false, "text": "I deleted all the macros for this file and saved it and then fed to POI but again the same error. Problem persists even if i remove all the macros."}, {"count": 12, "tags": [], "creator": "dfisher@jmlafferty.com", "text": "No promises about progress, but would you attach the \"macro-less\" file as well?", "id": 114364, "time": "2008-03-06T10:28:49Z", "bug_id": 44548, "creation_time": "2008-03-06T10:28:49Z", "is_private": false, "attachment_id": null}, {"count": 13, "tags": [], "creator": "sheetal.pathak@virginmedia.co.uk", "attachment_id": 21642, "id": 114365, "time": "2008-03-06T10:30:11Z", "bug_id": 44548, "creation_time": "2008-03-06T10:30:11Z", "is_private": false, "text": "Created attachment 21642\nMacro less file\n\nHi,\nsending you the same file after deleting the macros."}, {"count": 14, "tags": [], "creator": "dfisher@jmlafferty.com", "attachment_id": null, "id": 114367, "time": "2008-03-06T10:56:13Z", "bug_id": 44548, "creation_time": "2008-03-06T10:56:13Z", "is_private": false, "text": "There are still macros on this sheet. This is easy to see. Tighten up you macro security so that it asks if you want to enable.\n\nI believe remaining macros are on your \"Site Details\" worksheet attached to two buttons.\n\nIt looks like this work order template has had a long history and I think it is likely that there are old records within. You might try the BiffReader and look at the records that are unrecognized to see if they are described in any of the newly released documentation.\n"}, {"count": 15, "tags": [], "creator": "sheetal.pathak@virginmedia.co.uk", "text": "I didnot understand the Biff Reader part. can u please elaborate.", "id": 114402, "time": "2008-03-07T01:19:25Z", "bug_id": 44548, "creation_time": "2008-03-07T01:19:25Z", "is_private": false, "attachment_id": null}, {"count": 16, "tags": [], "bug_id": 44548, "attachment_id": null, "text": "If i uncomment the code for unknownrecord(records.add(record)) then the Excel file is read by POI but fails to evaluate formula and to retrieve strings from the sheet.\n\nin RecordFactory.java\n----------------------\nif (lastRecord instanceof UnknownRecord) {\n    //Gracefully handle records that we dont know about,\n   //that happen to be continued\n     records.add(record);\n} \nelse {\n  // throw new RecordFormatException(\"Unhandled Continue Record\");\n}\n\nBut if i again comment it out ie.\n//records.add(record)\n\nthen POI fails to read my excel file.", "id": 114414, "time": "2008-03-07T07:28:40Z", "creator": "sheetal.pathak@virginmedia.co.uk", "creation_time": "2008-03-07T07:28:40Z", "is_private": false}, {"count": 17, "tags": [], "bug_id": 44548, "attachment_id": null, "text": "I'm sorry I should have written BiffViewer.\n\nSee http://poi.apache.org/hssf/how-to.html and look for org.apache.poi.hssf.dev.BiffViewer\n\nThis should help you see those records and what is in them. It does sound like they are some kind of embedded macro in an older form. Maybe the POI developers have never seen these before. Only now has Microsoft provided documentation.\n\nGood luck.", "id": 114415, "time": "2008-03-07T07:40:26Z", "creator": "dfisher@jmlafferty.com", "creation_time": "2008-03-07T07:40:26Z", "is_private": false}, {"count": 18, "tags": [], "bug_id": 44548, "attachment_id": null, "text": "Re-tested OK in 3.1 and svn trunk (r683126)\n\nBoth attachment (id=21640) and attachment (id=21642) can be read OK by POI.\n\nSome things are not quite right though.  Comment #2 mentions POI version '3.1' but in March, only version 3.0.2 was available.  Perhaps '3.0.1' was intended.  I tried both attachments against various earlier versions (3.0, 3.0.1, 3.0.2) of POI, and none of them fail with the same error described in comment #3.  It seems that the most common error was \"Unknown grbit '16'\".  This seems to be related to bug 42564 which was fixed in May.  \n\nIf I've made a mistake, please specify the exact POI version and attachment that produce the error.\n\n", "id": 119477, "time": "2008-08-06T01:38:18Z", "creator": "josh@apache.org", "creation_time": "2008-08-06T01:38:18Z", "is_private": false}]