[{"id": 108577, "tags": [], "bug_id": 43473, "is_private": false, "count": 0, "text": "I think it would be nice if apache parses response headers for invalid \ncharacters.\n\nThere are sites which allows manipulation of response headers for example by: \n\n  whatever.cgi?new_location=<url>\n\nThe cgi adds \"Location: $new_location\".\n\nIF the application (\"whatever.cgi\") takes no care about the get/post variables \nthis enables a remote user to simply add headers (or complete responses eg. in \nthe case of http-pipelining) , for Example:\n  \"\\r\\nMy: Header\".\n\nI know that the problem here is not apache, but it would be nice if apache \ntakes a bit care about this.\n\nIf this is going to be implemtened there should a way to configure how the \ncharacters are replaced. For Example:\n  remove  - remove all \"invalid\" characters\n  escape  - escape them (dont know how, maybe \"x00\" or %00\" (hex))\n  ignore  - do nothing", "time": "2007-09-25T10:42:55Z", "creator": "ralf@stormbind.net", "creation_time": "2007-09-25T10:42:55Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "Ugh. This wouldn't even help with your example. The apache couldn't distinguish\nthe \"spoofed\" header from a regular one. The CGI program is the only instance\nwhich could know that.\n\nI don't see any usefulness in this.", "is_private": false, "bug_id": 43473, "id": 108578, "time": "2007-09-25T10:50:19Z", "creator": "nd@perlig.de", "creation_time": "2007-09-25T10:50:19Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 43473, "attachment_id": null, "text": "(In reply to comment #1)\n> Ugh. This wouldn't even help with your example. The apache couldn't \ndistinguish\n> the \"spoofed\" header from a regular one. The CGI program is the only instance\n> which could know that.\n> \n> I don't see any usefulness in this.\n\nAh, dammit, youre right.\n\nThe cgi just sends \"Status: 200\\r\\nAnd: so on\\r\\n\" and apache cant know whats \ncorrect.\n\nSorry.\n", "id": 108579, "time": "2007-09-25T11:00:16Z", "creator": "ralf@stormbind.net", "creation_time": "2007-09-25T11:00:16Z", "is_private": false}]