[{"count": 0, "tags": [], "creator": "brett_schmoll@adp.com", "attachment_id": null, "text": "Attempting to configure APR on a HP Nonstop platform fails with an error \nregarding the shared memory allocation method despite reporting the presence of\nshm libraries. \n\n<snipped from configure output>\nchecking for shmget... yes \nchecking for shmat... yes \nchecking for shmdt... yes \nchecking for shmctl... yes \n./configure:Error: decision on anonymous shared memory allocation \n method failed", "id": 90209, "time": "2006-06-14T17:24:20Z", "bug_id": 39814, "creation_time": "2006-06-14T17:24:20Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 39814, "attachment_id": 18465, "text": "Created attachment 18465\nconfig log from failure", "id": 90210, "time": "2006-06-14T17:25:49Z", "creator": "brett_schmoll@adp.com", "creation_time": "2006-06-14T17:25:49Z", "is_private": false}, {"attachment_id": 18466, "tags": [], "bug_id": 39814, "text": "Created attachment 18466\nAPR Config log", "count": 2, "id": 90213, "time": "2006-06-14T17:34:50Z", "creator": "brett_schmoll@adp.com", "creation_time": "2006-06-14T17:34:50Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 39814, "text": "It looks, and I may be reading this wrong, I'm not an autoconf guru, that we\ndecided not to use shmget for our anonymous shared memory support because we\ncouldn't find sys/file.h, which is a required header for that support.  I have\nno idea if that's correct on that platform or not, but that appears to be the\ncause of the configure failure.", "count": 3, "id": 90214, "time": "2006-06-14T17:45:16Z", "creator": "rooneg@electricjellyfish.net", "creation_time": "2006-06-14T17:45:16Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 39814, "is_private": false, "text": "I'd be a bit worried about all these errors:\n\n/usr/local/bin/cc: /usr/local/bin/cc_symbols: Permission denied\n/usr/local/bin/cc: /usr/local/bin/cc_symbols: Permission denied\n\nalthough they don't seem to be causing test failures.\n\nI don't know why configure requires sys/file.h to be able to use anon-shmget().\n It looks like that code has been there since the configure code was copied from\nMM.  AFAIK sys/file.h is only needed for use of flock(); and indeed, looking at\ncurrent versions of MM, it only actually *includes* sys/file.h if using\nflock()-based locking.\n\nCan you try editing the configure script: look for the *two* lines which look like:\n\nfor ac_spec in header:sys/ipc.h header:sys/shm.h header:sys/file.h ...\n\nand delete the \"header:sys/file.h\" from them on both lines; then try re-running\nthe configure script.  (if it still fails please attach a new config.log)\n", "id": 90237, "time": "2006-06-15T09:08:58Z", "creator": "jorton@redhat.com", "creation_time": "2006-06-15T09:08:58Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "brett_schmoll@adp.com", "is_private": false, "count": 5, "id": 90249, "time": "2006-06-15T16:33:39Z", "bug_id": 39814, "creation_time": "2006-06-15T16:33:39Z", "text": "Kudo's Joe, deleting those items resolved the issue with APR configure! "}, {"count": 6, "attachment_id": null, "creator": "brett_schmoll@adp.com", "text": "Well one step forward...one step back.\n\nconfigure runs successfully but the make fails when trying to compile the \nstring directory. Looking into it, the apr_cpystrn.c etc have \n#if APR_HAVE_SYS_TYPES_H\n#include <sys/types.h>\n#endif\n\nAPR_HAVE_SYS_TYPES_H isn't defined by the modified configure and the compile \nfails on undefined types.\n\nSo, going back to looking at the cause of the failure in the configure script.\n\n", "id": 90274, "time": "2006-06-15T21:04:26Z", "bug_id": 39814, "creation_time": "2006-06-15T21:04:26Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "creator": "brett_schmoll@adp.com", "attachment_id": null, "text": "APR_HAVE_SYS_TYPES_H is defined (it wasn't showing as a -D to the libtool \nstatment) but is set in apr.h.\n\n\n/home/bschmoll/svn/subversion-1.3.2/apr: make\nMaking all in strings\n/bin/sh /home/bschmoll/svn/subversion-1.3.2/apr/libtool --silent --\nmode=compile cc -g   -DHAVE_CONFIG_H  -D_XOPEN_SOURCE_EXTENDED    -\nI../include -I../include/arch/unix  -c apr_cpystrn.c && touch apr_cpystrn.lo\n      char        __ss_pad1[_SS_PAD1SIZE]; /* 6 byte pad to alignment field */\n                            ^\n\"/usr/include/sys/socket.h\", line 187: error(114): identifier \"u_short\" is\n          undefined\n\n\n  typedef  unsigned long long   apr_uint64_t;\n                         ^\n\"/home/bschmoll/svn/subversion-1.3.2/apr/strings/../include/apr.h\", line 271: \nerror(764):\n          invalid unsigned type\n\n\n  typedef  unsigned long long   apr_uint64_t;\n  ^\n\"/home/bschmoll/svn/subversion-1.3.2/apr/strings/../include/apr.h\", line 271: \nerror(764):\n          invalid unsigned type\n\n\n", "id": 90281, "time": "2006-06-15T22:31:22Z", "bug_id": 39814, "creation_time": "2006-06-15T22:31:22Z", "is_private": false}, {"count": 8, "tags": [], "creator": "jorton@redhat.com", "attachment_id": null, "text": "Can you attach the config.log from the successful configure run?\n\nDoes this platform/compiler have a 64-bit integer type? (if not, this is a\nshowstopper for APR)\n\nI'd guess some header needs to be included before sys/socket.h; can you work out\nwhat it is? (perhaps from the \"socket\" man page).", "id": 90294, "time": "2006-06-16T08:34:23Z", "bug_id": 39814, "creation_time": "2006-06-16T08:34:23Z", "is_private": false}, {"attachment_id": 18478, "tags": [], "bug_id": 39814, "text": "Created attachment 18478\nSuccessfull config.log", "count": 9, "id": 90305, "time": "2006-06-16T16:26:23Z", "creator": "brett_schmoll@adp.com", "creation_time": "2006-06-16T16:26:23Z", "is_private": false}, {"count": 10, "tags": [], "bug_id": 39814, "attachment_id": null, "text": "The platform does have support for 64bit with long long but for some reason \ndoesn't have unsigned long long.", "id": 90306, "time": "2006-06-16T16:29:41Z", "creator": "brett_schmoll@adp.com", "creation_time": "2006-06-16T16:29:41Z", "is_private": false}, {"count": 11, "tags": [], "creator": "jorton@redhat.com", "is_private": false, "text": "I don't think there's any way round that in APR.  Can you build gcc on this\nplatform, or any vendor-supplied C99 compiler?", "id": 90356, "time": "2006-06-19T13:34:37Z", "bug_id": 39814, "creation_time": "2006-06-19T13:34:37Z", "attachment_id": null}, {"count": 12, "tags": [], "bug_id": 39814, "is_private": false, "text": "Mass reassign the 44 open apr-bugs to apr bug list", "id": 93831, "time": "2006-09-19T19:54:36Z", "creator": "wrowe@apache.org", "creation_time": "2006-09-19T19:54:36Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 39814, "text": "Still looking for response to Joe's request.", "count": 13, "id": 93866, "time": "2006-09-19T20:26:46Z", "creator": "wrowe@apache.org", "creation_time": "2006-09-19T20:26:46Z", "is_private": false}, {"count": 14, "tags": [], "creator": "dzonatas@dzonux.net", "attachment_id": null, "text": "I ran into this problem also by using i686-mingw32 as host. It appear the\ndefault condition is to fail if none of the shared memory detections find\nanything. The default case should be \"no\" that shared memory doesn't exist.\nHowever, mingw32 targets a native Microsoft Windows, so there actually is shared\nmemory in win32.\n\nI'm working in this repository: https://oslcc.svn.sourceforge.net/svnroot/oslcc\n\nTo steps to test this case (on Linux) with the Open Second Life project:\n\n$ svn co\nhttps://oslcc.svn.sourceforge.net/svnroot/oslcc/i686-mingw32-FL-1.13.3.58390/trunk\noslcc\n$ cd oslcc\n$ sh build.sh\n#note: -- just run build.sh once to build mingw completely and automatically,\n#         ignore other requests to copy files\n$ tar xjf apr-1.2.8.tar.bz2\n$ TMP=`pwd`\n$ cd apr-1.2.8\n$ PATH=$TMP/mingw/bin:$PATH ac_cv_file__dev_zero=no ./configure\n--prefix=$TMP/mingw --host=i686-mingw32\n\n", "id": 100560, "time": "2007-03-18T21:14:37Z", "bug_id": 39814, "creation_time": "2007-03-18T21:14:37Z", "is_private": false}, {"count": 15, "attachment_id": 19735, "creator": "dzonatas@dzonux.net", "text": "Created attachment 19735\nproposed patch for mingw build\n\nAttached file: dzonatas.configure.in.mingw.patch\n\nThis patch allows configure to complete in the previous test case described\nearlier with this command:\n\n$ PATH=$TMP/mingw/bin:$PATH ac_cv_file__dev_zero=no ac_cv_func_setpgrp_void=no\napr_lock_method=other apr_cv_tcp_nodelay_with_cork=no ./configure\n--prefix=$TMP/mingw --host=i686-mingw32", "id": 100561, "time": "2007-03-18T23:26:01Z", "bug_id": 39814, "creation_time": "2007-03-18T23:26:01Z", "tags": [], "is_private": false}, {"count": 16, "tags": [], "creator": "dzonatas@dzonux.net", "is_private": false, "text": "The 1.3.x versions appear to have been updated for mingw support that resolves\nthe issues I expressed above.\n\n-- changed back to NEEDINFO as originally requested by Will.\n\n", "id": 100849, "time": "2007-03-23T15:36:33Z", "bug_id": 39814, "creation_time": "2007-03-23T15:36:33Z", "attachment_id": null}, {"count": 17, "tags": [], "creator": "wrowe@apache.org", "is_private": false, "text": "As 1.3 solves the mingw issue, and the solaris issue appears to be from a very\ncorrupt toolchain (I disagree with Joe, cc_symbols is causing failures), \nI strongly encourage the original reporter to obtain a modern sun cc from the\nDevStudio and ensure it is patched - the system headers aren't compatible with\nthe toolchain, apparently.", "id": 101682, "time": "2007-04-13T13:39:15Z", "bug_id": 39814, "creation_time": "2007-04-13T13:39:15Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 39814, "text": "Miscoded, reopening to close", "count": 18, "id": 101683, "time": "2007-04-13T13:40:04Z", "creator": "wrowe@apache.org", "creation_time": "2007-04-13T13:40:04Z", "is_private": false}, {"count": 19, "tags": [], "bug_id": 39814, "attachment_id": null, "id": 101684, "time": "2007-04-13T13:40:33Z", "creator": "wrowe@apache.org", "creation_time": "2007-04-13T13:40:33Z", "is_private": false, "text": "Wrong letter 'w' - sorry about that."}]