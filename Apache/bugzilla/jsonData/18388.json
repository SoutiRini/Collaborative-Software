[{"count": 0, "tags": [], "text": "RFC 2109 -- HTTP State Management, e.g. cookies -- does not specify whether\ncookies should be returned on requests with HTTP status codes other than 200. \nHowever, the earlier Netscape cookie specification did state that cookies should\nbe returned on other status codes, specifically 304 (Not modified).\n\nReturning cookies during a 304 or 302 (Redirect) is very useful for\nauthorization / access-management products.\n\nCan you please enable the Set-Cookie header during a 304?\n\nCode to change is line 1675 of /modules/http/http_protocol.c.\n\nThanks!", "attachment_id": null, "id": 33865, "creation_time": "2003-03-26T20:39:41Z", "time": "2003-03-26T20:39:41Z", "creator": "ryan.eberhard@entegrity.com", "bug_id": 18388, "is_private": false}, {"count": 1, "tags": [], "bug_id": 18388, "attachment_id": 5927, "text": "Created attachment 5927\nProcess Set-Cookien on HTTP_NOT_MODIFIED", "id": 35715, "time": "2003-04-21T18:13:45Z", "creator": "ryan.eberhard@entegrity.com", "creation_time": "2003-04-21T18:13:45Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 18388, "attachment_id": null, "id": 38116, "time": "2003-05-31T21:10:30Z", "creator": "trawick@apache.org", "creation_time": "2003-05-31T21:10:30Z", "is_private": false, "text": "This has been reported before (in the old PR database, against Apache 1.3).\nThe answer, in the words of Marc Slemko, is:\n\n\"It is not valid to set a cookie in a 304 response.  Please see section 10.3.5\nof RFC2616.  That is the reason Apache explictly lists headers that will be sent\nand why Set-Cookie isn't one of them.\"\n"}, {"count": 3, "tags": [], "bug_id": 18388, "text": "Section 10.3.5 of RFC 2616 makes this statement:\n\n   \"If the conditional GET used a strong cache validator (see section\n   13.3.3), the response SHOULD NOT include other entity-headers.\n   Otherwise (i.e., the conditional GET used a weak validator), the\n   response MUST NOT include other entity-headers; this prevents\n   inconsistencies between cached entity-bodies and updated headers.\"\n\nNote that only entity-headers are forbidden.\n\nSection 4.2 describes three sets of headers: request (defined in 5.3), response\n(defined in section 6.2), and entity (defined in section 7.1).\n\nEach of these three sections lists headers, but \"Set-Cookie\" is not listed in\nany of the three sets.\n\nSection 6.2 makes this statment:\n\n   \"The response-header fields allow the server to pass additional\n   information about the response which cannot be placed in the Status-\n   Line.\"\n\nand...\n\n   \"However, new or\n   experimental header fields MAY be given the semantics of response-\n   header fields if all parties in the communication recognize them to\n   be response-header fields. Unrecognized header fields are treated as\n   entity-header fields.\"\n\nWhile section 7.1 makes this statement:\n\n   \"Entity-header fields define metainformation about the entity-body or,\n   if no body is present, about the resource identified by the request.\"\n\nSet-Cookie meets the test of universal acceptance as a known response-header and\nis must better defined as a response-header (\"additional information\") than as\nan entity-header (\"metainformation about the entity-body\").\n\nIt is also important to note that all other major web servers (IIS, iPlanet, and\nDomino) will return Set-Cookie headers on a 304 status.\n", "id": 38257, "attachment_id": null, "creator": "ryan.eberhard@entegrity.com", "creation_time": "2003-06-03T13:54:15Z", "time": "2003-06-03T13:54:15Z", "is_private": false}, {"count": 4, "tags": [], "creator": "trawick@apache.org", "attachment_id": null, "text": "enabling the PatchAvailable keyword\nupdated doc on submitting patches is at http://httpd.apache.org/dev/patches.html\n", "id": 47880, "time": "2003-11-21T22:16:16Z", "bug_id": 18388, "creation_time": "2003-11-21T22:16:16Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 18388, "is_private": false, "count": 5, "id": 71513, "time": "2005-02-25T12:41:30Z", "creator": "Okin7@yahoo.fr", "creation_time": "2005-02-25T12:41:30Z", "text": "The http_protocol.c file has changed, so the patch should apply line 1657 rather\nthan line 1682.\n\nThis bug is more than one year old.\nJust by correcting it, it could be possible to reduce bandwith usage on Apache 2\nservers, by not resending all the page just to set a cookie.\nPlease take a second to apply the patch in the next 2.0.54 or so.\nThank you very very much !\n\nHere is a small PHP script to test the bug :\non Apache 1.3.x, the printed line changes every second,\non Apache <=2.0.53, it won't change\n\n==============\n<?php\nif (@$_SERVER['HTTP_IF_MODIFIED_SINCE']) header('HTTP/1.x 304 Not Modified');\n\nheader('Last-Modified: ' . gmdate('D, d M Y H:i:s') . ' GMT');\nheader('Set-Cookie: test=' . time());\n\n?>\n<script>document.write(document.cookie);</script>\n=============="}, {"count": 6, "tags": [], "bug_id": 18388, "attachment_id": null, "id": 116719, "time": "2008-05-16T17:41:41Z", "creator": "fielding@apache.org", "creation_time": "2008-05-16T17:41:41Z", "is_private": false, "text": "This was fixed in trunk in 2004 (r104924).\n"}, {"count": 7, "tags": [], "creator": "fielding@apache.org", "attachment_id": null, "is_private": false, "id": 116720, "time": "2008-05-16T18:11:38Z", "bug_id": 18388, "creation_time": "2008-05-16T18:11:38Z", "text": "and released in 2.2.0."}]