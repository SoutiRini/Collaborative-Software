[{"count": 0, "tags": [], "bug_id": 98, "attachment_id": null, "is_private": false, "id": 78, "time": "2000-09-08T06:48:11Z", "creator": "dev@tomcat.apache.org", "creation_time": "2000-09-08T06:48:11Z", "text": "All session listener's method valueUnbound should \r\nbe processed before any attribute removed. \r\n\r\nthe following code is a listener's part\r\n\r\npublic void  valueUnbound(HttpSessionBindingEvent e){\r\n    HttpSession session=e.getSession();\r\n    if(e.getName().equals(\"session.listner\")){\r\n       Hashtable userdata=(Hashtable)session.getAttribute(\"userdata\");        \r\n       saveIntoMyDB(userdata);\r\n    }\r\n}\r\n\r\nIn the release of Tomcat 3.2 beta2, when\r\nvalueUnbound called, the attribute of \r\n\"usedata\" maybe already has been removed. \r\n\r\nSo maybe is better change code of expire() \r\nand removeAtrribute() in the classes of \r\nStandSession as following\r\n.....\r\n    Enumeration names=getAttributeNames();\r\n        while(names.hasMoreElements()){\r\n            String name=(String)names.nextElement();\r\n            Object value=getAttribute(name);\r\n            if(value instanceof HttpSessionBindingListener) {\r\n                ((HttpSessionBindingListener) value).valueUnbound\r\n                    (new HttpSessionBindingEvent((HttpSession) this, \r\nname));\r\n            }\r\n        }           \r\n\r\n        // Unbind any objects associated with this session\r\n        names=getAttributeNames();\r\n        while (names.hasMoreElements()) {\r\n            String name = (String) names.nextElement();\r\n            removeAttribute(name);\r\n        }\r\n\r\n\r\n \r\n\r\n"}, {"count": 1, "tags": [], "bug_id": 98, "text": "The specification is quite clear about when the valueBound() and valueUnbound() \nmethods are to be called and the existing implementation matches the spec.", "id": 824, "time": "2001-02-22T19:11:35Z", "creator": "marc.saegesser@apropos.com", "creation_time": "2001-02-22T19:11:35Z", "is_private": false, "attachment_id": null}]