[{"count": 0, "attachment_id": null, "bug_id": 24182, "is_private": false, "id": 46374, "time": "2003-10-28T16:07:42Z", "creator": "mike@renegadeinternet.com", "creation_time": "2003-10-28T16:07:42Z", "tags": [], "text": "Windows 2003 Server\nSun JDK 1.4.1\nTomcat 4.1.27\n\njava.util.ConcurrentModificationException\n        at java.util.LinkedHashMap$LinkedHashIterator.nextEntry\n(LinkedHashMap.java:358)\n        at java.util.LinkedHashMap$EntryIterator.next(LinkedHashMap.java:377)\n        at java.util.HashMap.writeObject(HashMap.java:976)\n        at sun.reflect.GeneratedMethodAccessor49.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:324)\n        at java.io.ObjectStreamClass.invokeWriteObject\n(ObjectStreamClass.java:809)\n        at java.io.ObjectOutputStream.writeSerialData\n(ObjectOutputStream.java:1296)\n        at java.io.ObjectOutputStream.writeOrdinaryObject\n(ObjectOutputStream.java:1247)\n        at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1052)\n        at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:278)\n        at org.apache.catalina.session.StandardSession.writeObject\n(StandardSession.java:1439)\n        at org.apache.catalina.session.StandardSession.writeObjectData\n(StandardSession.java:881)\n        at org.apache.catalina.session.JDBCStore.save(JDBCStore.java:730)\n        at org.apache.catalina.session.PersistentManagerBase.writeSession\n(PersistentManagerBase.java:782)\n        at org.apache.catalina.session.PersistentManagerBase.swapOut\n(PersistentManagerBase.java:762)\n        at org.apache.catalina.session.PersistentManagerBase.processMaxIdleSwaps\n(PersistentManagerBase.java:1015)\n        at \norg.apache.catalina.session.PersistentManagerBase.processPersistenceChecks\n(PersistentManagerBase.java:525)\n        at org.apache.catalina.session.PersistentManagerBase.run\n(PersistentManagerBase.java:1172)\n        at java.lang.Thread.run(Thread.java:534)"}, {"count": 1, "tags": [], "bug_id": 24182, "text": "Can you provide some more information about the circumstances in which you saw \nthis exception? Is it reproducible? If so - how? If you have a simple webapp \nthat reproduces problem, please attach it to the bug report.", "id": 47151, "time": "2003-11-11T00:04:03Z", "creator": "medthomas@ntlworld.com", "creation_time": "2003-11-11T00:04:03Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 24182, "attachment_id": null, "id": 47152, "time": "2003-11-11T00:11:35Z", "creator": "filip@filip.net", "creation_time": "2003-11-11T00:11:35Z", "is_private": false, "text": "are you trying to serialize a hashmap? Is it possible that you are at the same \ntime trying to change values in this hashmap?\n\nTry this, make the hashmap synchronized, and report if you still get exceptions!\n\nFilip"}, {"count": 3, "tags": [], "creator": "mike@renegadeinternet.com", "text": "This error has caused Tomcat to crash several times in production, though I \nhaven't been able to reproduce it with any tests.  Tomcat is getting about 5-6 \nmillion hits a day with about 30,000 user sessions persisted to MySQL on \naverage.  I will try what Philip suggests, I do have two classes in the \nsessions that extend LinkedHashMap.", "id": 47159, "time": "2003-11-11T02:44:53Z", "bug_id": 24182, "creation_time": "2003-11-11T02:44:53Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 24182, "attachment_id": null, "id": 59695, "time": "2004-06-21T22:40:46Z", "creator": "markt@apache.org", "creation_time": "2004-06-21T22:40:46Z", "is_private": false, "text": "Did making the HashMap synchronized fix this issue?"}, {"count": 5, "tags": [], "bug_id": 24182, "text": "No, though it seemed to make it occur much less frequently.  I ended up writing \nmy own LRU map that dealt with concurrency better and haven't had any problems \nsince then.", "id": 59698, "time": "2004-06-21T23:30:32Z", "creator": "mike@renegadeinternet.com", "creation_time": "2004-06-21T23:30:32Z", "is_private": false, "attachment_id": null}, {"count": 6, "text": "So the problem was with java.util.LinkedHashMap then?", "creator": "markt@apache.org", "is_private": false, "id": 59732, "time": "2004-06-22T20:04:40Z", "bug_id": 24182, "creation_time": "2004-06-22T20:04:40Z", "tags": [], "attachment_id": null}, {"count": 7, "text": "Yes, my two classes that I was storing in the session extended \njava.util.LinkedHashMap and implemented the removeEldestEntry method.", "creator": "mike@renegadeinternet.com", "is_private": false, "id": 59733, "time": "2004-06-22T21:17:56Z", "bug_id": 24182, "creation_time": "2004-06-22T21:17:56Z", "tags": [], "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 24182, "attachment_id": null, "id": 59738, "time": "2004-06-22T22:01:14Z", "creator": "markt@apache.org", "creation_time": "2004-06-22T22:01:14Z", "is_private": false, "text": "Thanks for the clarification. Based on this I am going to resolve this as \nINVALID since the issue is with the JDK implementation rather than Tomcat. \nAgain, thanks for responding so promptly to my somewhat belated questions."}]