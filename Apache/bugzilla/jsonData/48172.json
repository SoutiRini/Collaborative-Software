[{"count": 0, "tags": [], "creator": "sebb@apache.org", "text": "JspRuntimeContext.jspReloadCount is synchronised when updated, but not when read by getJspReloadCount().\n\nIf the instance is accessed from multiple threads, then the returned value may not be the current value, it could be arbitrarily stale.\n\nIf this is acceptable, then the Javadoc should say so; otherwise the getter needs to be synch. (or the field needs to be volatile) Or just use AtomicInteger.\n\n==\n\nVarious other fields are neither final nor synchronized, e.g.\n\nclasspath\ncodeSource\netc.\n\nAs far as I can tell, these could easily be made final as they are only written by the constructor.", "id": 131868, "attachment_id": null, "bug_id": 48172, "creation_time": "2009-11-11T03:23:50Z", "time": "2009-11-11T03:23:50Z", "is_private": false}, {"count": 1, "tags": [], "creator": "sebb@apache.org", "attachment_id": 24514, "text": "Created attachment 24514\nConvert jspReloadCount to AtomicInteger", "id": 131869, "time": "2009-11-11T03:38:03Z", "bug_id": 48172, "creation_time": "2009-11-11T03:38:03Z", "is_private": false}, {"count": 2, "tags": [], "creator": "sebb@apache.org", "text": "The lastCheck field is also not synch. \n\nThis is not problem, so long as:\n* the instance of JspRuntimeContext is created before the background thread is started\n* checkCompile() is only ever called from the background thread\n\nIMO such pre-conditions (if true) should be documented.", "id": 131870, "attachment_id": null, "bug_id": 48172, "creation_time": "2009-11-11T03:52:08Z", "time": "2009-11-11T03:52:08Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 48172, "text": "Created attachment 24515\nMake fields final", "id": 131874, "time": "2009-11-11T06:22:34Z", "creator": "sebb@apache.org", "creation_time": "2009-11-11T06:22:34Z", "is_private": false, "attachment_id": 24515}, {"count": 4, "tags": [], "creator": "markt@apache.org", "text": "Patch applied. Re comment#2, those statements are not true so I made the field volatile.", "id": 132115, "attachment_id": null, "bug_id": 48172, "creation_time": "2009-11-18T15:35:24Z", "time": "2009-11-18T15:35:24Z", "is_private": false}]