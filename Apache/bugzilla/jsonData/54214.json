[{"count": 0, "tags": [], "creator": "toralf.foerster@gmx.de", "text": "At an unstable Gentoo Linux image I get (both gcc-4.6.2 and 4.7.2) :\n\n...\ntestcond            : SUCCESS\ntestlfs             : \\/bin/bash: line 2:  5321 Segmentation fault      (core dumped) ./$prog\nPrograms failed: testall\nmake[1]: *** [check] Error 139\nmake[1]: Leaving directory `/var/tmp/portage/dev-libs/apr-1.4.6/work/apr-1.4.6/test'\n...\n\nand GDB says :\n\n...\nCore was generated by `./testall'.\nProgram terminated with signal 11, Segmentation fault.\n#0  apr_file_info_get (finfo=finfo@entry=0xbf990df4, wanted=wanted@entry=7582064, thefile=0x1) at file_io/unix/filestat.c:157\n157         if (thefile->buffered) {\n(gdb) bt\n#0  apr_file_info_get (finfo=finfo@entry=0xbf990df4, wanted=wanted@entry=7582064, thefile=0x1) at file_io/unix/filestat.c:157\n#1  0x0806a824 in test_reopen (tc=0xbf990e78, data=<optimized out>) at testlfs.c:120\n#2  test_reopen (tc=0xbf990e78, data=0x0) at testlfs.c:108\n#3  0x0804d998 in abts_run_test (ts=ts@entry=0x909c0c0, f=f@entry=0x806a790 <test_reopen>, value=value@entry=0x0) at abts.c:168\n#4  0x0806ab7c in testlfs (suite=0x909c0c0) at testlfs.c:356\n#5  0x0804d255 in main (argc=1, argv=0xbf990fa4) at abts.c:424", "id": 163684, "time": "2012-11-27T20:56:17Z", "bug_id": 54214, "creation_time": "2012-11-27T20:56:17Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 54214, "text": "Can you check in the buildlog if the compiler defines are the same when compiling the library itself and when compiling the tests? Especially WRT -D_LARGEFILE64_SOURCE?\n\nAnother issue could be if LD_LIBRARY_PATH is set and the tests somehow use a different libapr1.so than the one that has just been built. You could insert a line with \"ldd ./$$prog; \\\" into test/Makefile before the ./$$prog call to see which library is used.", "id": 164271, "time": "2012-12-28T10:00:16Z", "creator": "sf@sfritsch.de", "creation_time": "2012-12-28T10:00:16Z", "is_private": false, "attachment_id": null}, {"count": 2, "attachment_id": 29797, "bug_id": 54214, "text": "Created attachment 29797\nbuild log\n\n(In reply to comment #1)\n> Can you check in the buildlog if the compiler defines are the same when\n> compiling the library itself and when compiling the tests? Especially WRT\n> -D_LARGEFILE64_SOURCE?\nseems to be specified correctly always (pls seee attachedd build log)\n\n> Another issue could be if LD_LIBRARY_PATH is set and the tests somehow use a\n> different libapr1.so than the one that has just been built. You could insert\n> a line with \"ldd ./$$prog; \\\" into test/Makefile before the ./$$prog call to\n> see which library is used.\n\nit points to the tmp file :\n\n libapr-1.so.0 => /var/tmp/portage/dev-libs/apr-1.4.6-r1/work/apr-1.4.6/.libs/libapr-1.so.0 (0xb7747000)\n\n(and nevertheless after the 2nd  re-install even the sytem wide visible lib would be the same, isn't it ?\n\nWhat's interesting is that the test cases doesn't fail relyable, 2 subsequent call in a row show :\n\nn22 /var/tmp/portage/dev-libs/apr-1.4.6-r1/work/apr-1.4.6 # ./test/testall \ntestatomic          : SUCCESS\ntestdir             : FAILED 2 of 13\ntestdso             : FAILED 8 of 9\ntestdup             : SUCCESS\ntestenv             : SUCCESS\ntestfile            : FAILED 3 of 35\ntestfilecopy        : FAILED 2 of 4\ntestfileinfo        : SUCCESS\ntestflock           : FAILED 2 of 3\ntestfmt             : SUCCESS\ntestfnmatch         : FAILED 2 of 4\ntestargs            : SUCCESS\ntesthash            : SUCCESS\ntestipsub           : SUCCESS\ntestlock            : SUCCESS\ntestcond            : SUCCESS\ntestlfs             : SUCCESS\ntestmmap            : |Segmentation fault (core dumped)\n\nn22 /var/tmp/portage/dev-libs/apr-1.4.6-r1/work/apr-1.4.6 # ./test/testall \ntestatomic          : SUCCESS\ntestdir             : SUCCESS\ntestdso             : FAILED 8 of 9\ntestdup             : SUCCESS\ntestenv             : SUCCESS\ntestfile            : SUCCESS\ntestfilecopy        : FAILED 2 of 4\ntestfileinfo        : SUCCESS\ntestflock           : FAILED 2 of 3\ntestfmt             : SUCCESS\ntestfnmatch         : FAILED 2 of 4\ntestargs            : SUCCESS\ntesthash            : SUCCESS\ntestipsub           : SUCCESS\ntestlock            : SUCCESS\ntestcond            : SUCCESS\ntestlfs             : SUCCESS\ntestmmap            : |Segmentation fault (core dumped)\n\n(but since today I'm running glibc-2.17 for that chroot'ed test+play system) together with 3.7.1 as kernel.", "id": 164276, "time": "2012-12-28T14:28:42Z", "creator": "toralf.foerster@gmx.de", "creation_time": "2012-12-28T14:28:42Z", "tags": [], "is_private": false}]