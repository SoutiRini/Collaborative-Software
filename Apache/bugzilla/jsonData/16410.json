[{"count": 0, "tags": [], "creator": "jason@compositesw.com", "text": "POI version 1.5.1\nexcel 2002 10.2614.2625\n\nnot sure what the behavior of setCellType should be, but this strikes me as a \nbug. my assumption is that a cell, regardless of it's content, can have its \ntype changed without directly modifying the content first.\n\n\nusing the example program, ReadWriteWorkbook, with a blank excel spreadsheet \ncalled workbook.xls. when the example program tries to set the cell type to \nCELL_TYPE_STRING the following exception is thrown:\n\nException in thread \"main\" java.lang.NumberFormatException: You cannot get a str\ning value from a numeric cell\n        at org.apache.poi.hssf.usermodel.HSSFCell.getStringCellValue(HSSFCell.ja\nva:757)\n        at org.apache.poi.hssf.usermodel.HSSFCell.setCellType(HSSFCell.java:495)\n\n        at org.apache.poi.hssf.usermodel.HSSFCell.setCellType(HSSFCell.java:410)\n\n        at org.apache.poi.hssf.usermodel.examples.ReadWriteWorkbook.main(ReadWri\nteWorkbook.java:86)\n\nin order to find out more i modified the example program and found the \nfollowing:\nthe cell defaults to CELL_TYPE_NUMERIC.\nif the cell VALUE is set as a numeric with a value of 0, then the value is set \nto a null string, then the cell type is changed to a string, it works fine.\n\nguess at what is happening: cell, upon change of type, accesses the data in the \ncell as the type it will become. the cell type has not changed yet, so there is \nan exception where the data, still as old type cell, is trying to be accessed \nas new type cell.\n\nthe same behavior occurs when trying to convert to numeric cell to string cell.", "id": 30031, "time": "2003-01-24T22:15:02Z", "bug_id": 16410, "creation_time": "2003-01-24T22:15:02Z", "is_private": false, "attachment_id": null}, {"count": 1, "attachment_id": null, "creator": "avik@apache.org", "text": "Well, the way it probably works is that when you set the content, the cell type\ngets set automatically (ie, if you call cell.setStringValue .. it'll change its\ntype. I dont think its a good idea to change type irrespective of content. Given\nthat this bug hasnt recieved any vote apart from the reporter, i am inclined to\nmark this as WONTFIX and clarify the docs a bit. ", "id": 30069, "time": "2003-01-26T20:29:17Z", "bug_id": 16410, "creation_time": "2003-01-26T20:29:17Z", "tags": [], "is_private": false}, {"count": 2, "attachment_id": null, "creator": "poi-support@buni.org", "text": "I agree.  Its not a bug..  You're not supposed to do that and thats what the\nexception means :-)  (I think I wrote that exception....)", "id": 41317, "time": "2003-07-24T14:14:53Z", "bug_id": 16410, "creation_time": "2003-07-24T14:14:53Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 16410, "attachment_id": null, "text": "I am trying to read an excel file. One of the columns in the file is a numeric \ntype, it contains dates. I want to change the cell type to a String, so that i \ncan get the data as it is seen on the sheet...for example, cell 1 as an value \nof '06/01/2003'. since cell 1 is numeric, i get a numeric value - which is \n37773.0, i am trying to set the cell type to String so that i can get the \nString as 06/01/2003\n\nthis is how i set the cell type of cell 1\nrow.getCell((short) colIndex).setCellType(1);\n\nand this is how i try to get the string value\nrow.getCell((short) colIndex).getStringCellValue());\n\ni get this error\njava.lang.NumberFormatException: You cannot get a string value from a numeric \nce\nll\n        at org.apache.poi.hssf.usermodel.HSSFCell.getStringCellValue\n(HSSFCell.ja\nva:775)\n        at org.apache.poi.hssf.usermodel.HSSFCell.setCellType\n(HSSFCell.java:473)\n\n        at org.apache.poi.hssf.usermodel.HSSFCell.setCellType\n(HSSFCell.java:388)\n\n\nthanks.\nNirupa Ravilla", "id": 71858, "time": "2005-03-05T00:49:36Z", "creator": "nirupakanthi@hotmail.com", "creation_time": "2005-03-05T00:49:36Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 16410, "attachment_id": null, "id": 75108, "time": "2005-05-20T11:41:13Z", "creator": "avik@apache.org", "creation_time": "2005-05-20T11:41:13Z", "is_private": false, "text": "Not a bug. In respect of the original issue, i think setCellValue should be\nmarked as deprecated, since its use from outside is fraught with strange semantics. \n\nIn respect of Comment #3, that is an incorrect way of using the API. Please see\nthe documentation, or ask on the user mailing list. "}]