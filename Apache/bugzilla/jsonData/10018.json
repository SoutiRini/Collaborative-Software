[{"count": 0, "tags": [], "bug_id": 10018, "text": "My environment:\nRedHat 7.3, Apache 2.0.39, TC4.1.5 (Also happens on 4.1.3), JDK1.4.0_01.\n\nAccessing the admin webapp login page causes the following exception when \ntrying to load the Login.jpg. The problem can be seen at \nhttps://www.daveoxley.co.uk/admin as long as its up and running at the time!!!\n\n2002-06-19 16:45:42 StandardWrapperValve[default]: Servlet.service() for \nservlet default threw exception\njava.io.IOException: Connection reset by peer\n        at java.net.SocketOutputStream.socketWrite0(Native Method)\n        at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)\n        at java.net.SocketOutputStream.write(SocketOutputStream.java:126)\n        at org.apache.jk.common.ChannelSocket.send(ChannelSocket.java:325)\n        at org.apache.jk.common.ChannelSocket.invoke(ChannelSocket.java:499)\n        at org.apache.jk.server.JkCoyoteHandler.doWrite\n(JkCoyoteHandler.java:186)\n        at org.apache.coyote.Response.doWrite(Response.java:478)\n        at org.apache.coyote.tomcat4.OutputBuffer.realWriteBytes\n(OutputBuffer.java:380)\n        at org.apache.tomcat.util.buf.ByteChunk.flushBuffer(ByteChunk.java:360)\n        at org.apache.tomcat.util.buf.ByteChunk.append(ByteChunk.java:338)\n        at org.apache.coyote.tomcat4.OutputBuffer.writeBytes\n(OutputBuffer.java:407)\n        at org.apache.coyote.tomcat4.OutputBuffer.write(OutputBuffer.java:394)\n        at org.apache.coyote.tomcat4.CoyoteOutputStream.write\n(CoyoteOutputStream.java:110)\n        at org.apache.catalina.servlets.DefaultServlet.copyRange\n(DefaultServlet.java:1996)\n        at org.apache.catalina.servlets.DefaultServlet.copy\n(DefaultServlet.java:1745)\n        at org.apache.catalina.servlets.DefaultServlet.serveResource\n(DefaultServlet.java:1073)\n        at org.apache.catalina.servlets.DefaultServlet.doGet\n(DefaultServlet.java:506)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:740)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java:247)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java:193)\n        at org.apache.catalina.core.StandardWrapperValve.invoke\n(StandardWrapperValve.java:260)\n        at \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNe\nxt(StandardPipeline.java:643)\n        at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n        at org.apache.catalina.core.ContainerBase.invoke\n(ContainerBase.java:995)\n        at org.apache.catalina.core.StandardContextValve.invoke\n(StandardContextValve.java:191)\n        at \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNe\nxt(StandardPipeline.java:643)\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke\n(AuthenticatorBase.java:471)\n        at \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNe\nxt(StandardPipeline.java:641)\n        at org.apache.catalina.valves.CertificatesValve.invoke\n(CertificatesValve.java:246)\n        at \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNe\nxt(StandardPipeline.java:641)\n        at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n        at org.apache.catalina.core.ContainerBase.invoke\n(ContainerBase.java:995)\n        at org.apache.catalina.core.StandardContext.invoke\n(StandardContext.java:2350)\n        at org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:180)\n        at \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNe\nxt(StandardPipeline.java:643)\n        at org.apache.catalina.valves.ErrorDispatcherValve.invoke\n(ErrorDispatcherValve.java:170)\n        at \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNe\nxt(StandardPipeline.java:641)\n        at org.apache.catalina.valves.ErrorReportValve.invoke\n(ErrorReportValve.java:171)\n        at \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNe\nxt(StandardPipeline.java:641)\n        at org.apache.catalina.valves.AccessLogValve.invoke\n(AccessLogValve.java:469)\n        at \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNe\nxt(StandardPipeline.java:641)\n        at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n        at org.apache.catalina.core.ContainerBase.invoke\n(ContainerBase.java:995)\n        at org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:174)\n        at \norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNe\nxt(StandardPipeline.java:643)\n        at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:480)\n        at org.apache.catalina.core.ContainerBase.invoke\n(ContainerBase.java:995)\n        at org.apache.coyote.tomcat4.CoyoteAdapter.service\n(CoyoteAdapter.java:223)\n        at org.apache.jk.server.JkCoyoteHandler.invoke\n(JkCoyoteHandler.java:227)\n        at org.apache.jk.common.HandlerRequest.invoke(HandlerRequest.java:355)\n        at org.apache.jk.common.ChannelSocket.invoke(ChannelSocket.java:504)\n        at org.apache.jk.common.ChannelSocket.processConnection\n(ChannelSocket.java:476)\n        at org.apache.jk.common.SocketConnection.runIt(ChannelSocket.java:581)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:518)\n        at java.lang.Thread.run(Thread.java:536)", "id": 18088, "time": "2002-06-19T16:01:33Z", "creator": "Dave@Staffplanner.co.uk", "creation_time": "2002-06-19T16:01:33Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "Dave@Staffplanner.co.uk", "attachment_id": null, "text": "Please see my config files at:\nhttp://www.daveoxley.co.uk/server.xml\nhttp://www.daveoxley.co.uk/mod_jk.conf\nhttp://www.daveoxley.co.uk/workers.properties\n", "id": 18089, "time": "2002-06-19T16:03:25Z", "bug_id": 10018, "creation_time": "2002-06-19T16:03:25Z", "is_private": false}, {"count": 2, "text": "Aparently, the static resource is not getting served correctly.\nDoes it also happen when you're not using HTTPS ?", "creator": "remm@apache.org", "attachment_id": null, "id": 18091, "time": "2002-06-19T16:24:09Z", "bug_id": 10018, "creation_time": "2002-06-19T16:24:09Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 10018, "attachment_id": null, "id": 18092, "time": "2002-06-19T16:29:41Z", "creator": "Dave@Staffplanner.co.uk", "creation_time": "2002-06-19T16:29:41Z", "is_private": false, "text": "Just tried it and yes it does happen over HTTP as well, \nhttp://www.daveoxley.co.uk/admin. This didn't happen with the old \norg.apache.ajp.tomcat4.Ajp13Connector."}, {"count": 4, "tags": [], "bug_id": 10018, "attachment_id": null, "id": 18559, "time": "2002-06-25T17:05:50Z", "creator": "Dave@Staffplanner.co.uk", "creation_time": "2002-06-25T17:05:50Z", "is_private": false, "text": "Output in mod_jk.log with a slightly modified jk_ajp_common.c to log the \nmsglen and the jk_b_get_size(msg) within method ajp_connection_tcp_get_message.\nI seem to remember a problem with responses >8k from a long time ago.\n\n[Tue Jun 25 18:06:56 2002]  [jk_ajp_common.c (701)]: received from ajp13 #142\n[Tue Jun 25 18:06:56 2002]  [jk_ajp_common.c (462)]: ajp_unmarshal_response: \nstatus = 200\n[Tue Jun 25 18:06:56 2002]  [jk_ajp_common.c (467)]: ajp_unmarshal_response: \nNumber of headers is = 4\n[Tue Jun 25 18:06:56 2002]  [jk_ajp_common.c (507)]: ajp_unmarshal_response: \nHeader[0] [ETag] = [W/\"18404-1024087954000\"]\n[Tue Jun 25 18:06:56 2002]  [jk_ajp_common.c (507)]: ajp_unmarshal_response: \nHeader[1] [Last-Modified] = [Fri, 14 Jun 2002 20:52:34 GMT]\n[Tue Jun 25 18:06:56 2002]  [jk_ajp_common.c (507)]: ajp_unmarshal_response: \nHeader[2] [Content-Type] = [image/jpeg]\n[Tue Jun 25 18:06:56 2002]  [jk_ajp_common.c (507)]: ajp_unmarshal_response: \nHeader[3] [Content-Length] = [18404]\n[Tue Jun 25 18:06:56 2002]  [jk_ajp_common.c (687)]: \najp_connection_tcp_get_message: Error - Wrong message size\nmsglen (8196) > msglen_expected (8192)\n[Tue Jun 25 18:06:56 2002]  [jk_ajp_common.c (1015)]: Error reading reply\n[Tue Jun 25 18:06:56 2002]  [jk_ajp_common.c (1152)]: In \njk_endpoint_t::service, ajp_get_reply failed in send loop 0\n"}, {"count": 5, "text": "I have just recreated this bug on Windows with dynamic content. \norg.apache.coyote.tomcat4.CoyoteConnector does not work for content > 8k.", "creator": "Dave@Staffplanner.co.uk", "attachment_id": null, "id": 18612, "time": "2002-06-26T15:48:51Z", "bug_id": 10018, "creation_time": "2002-06-26T15:48:51Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "creator": "Dave@Staffplanner.co.uk", "text": "Just tried this with 4.1.6 and it is still a problem.", "id": 18743, "attachment_id": null, "bug_id": 10018, "creation_time": "2002-06-28T19:44:30Z", "time": "2002-06-28T19:44:30Z", "is_private": false}, {"count": 7, "tags": [], "creator": "Dave@Staffplanner.co.uk", "is_private": false, "id": 19042, "attachment_id": null, "bug_id": 10018, "creation_time": "2002-07-05T09:49:45Z", "time": "2002-07-05T09:49:45Z", "text": "This is now working in 4.1.7. Cheers Costin."}]