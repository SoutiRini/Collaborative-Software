[{"count": 0, "attachment_id": null, "creator": "balusc@gmail.com", "text": "The new Servlet 3.0 global error page\n\n    <error-page>\n        <location>/error.jsp</location>\n    </error-page>\n\nis not handled in Tomcat 7.\n\nOn Glassfish 3 for example, it works fine.", "id": 151190, "time": "2011-11-04T14:15:58Z", "bug_id": 52135, "creation_time": "2011-11-04T14:15:58Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 52135, "attachment_id": null, "text": "There is no \"new Servlet 3.0 global error page\" I can find references to in the Servlet 3.0 specification.\n\nTomcat uses error pages with some of the applications that ship with Tomcat and error pages work correctly in those applications.\n\nPlease feel free to re-open this issue but if you do you are going to have to provide a lot more detail else it will simply be re-closed as invalid. You'll need to provide the full steps to reproduce this issue on a clean install of the latest Tomcat 7 release. Providing the simplest possible web application (with source code) that demonstrates the issue is one way to do this.", "id": 151205, "time": "2011-11-04T19:41:49Z", "creator": "markt@apache.org", "creation_time": "2011-11-04T19:41:49Z", "is_private": false}, {"count": 2, "tags": [], "creator": "balusc@gmail.com", "attachment_id": null, "text": "The <exception-type> and <error-page> entries are now *optional* by XSD, before either one of them was required.", "id": 151208, "time": "2011-11-04T21:01:09Z", "bug_id": 52135, "creation_time": "2011-11-04T21:01:09Z", "is_private": false}, {"count": 3, "tags": [], "creator": "balusc@gmail.com", "attachment_id": null, "text": "(where's the edit comment link?) Sorry, in the previous comment I meant to say <error-code> instead of <error-page>. Also the figure 14-10 in Servlet 3.0 spec identifies those options with a dotted line which means that they are optional.", "id": 151210, "time": "2011-11-04T21:05:57Z", "bug_id": 52135, "creation_time": "2011-11-04T21:05:57Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 52135, "text": "I have tested this on Apache Tomcat/7.0.23\n\nIf I declare following without <error-code> or <exception-type> :\n    <error-page>\n        <location>/error</location>\n    </error-page> \n\nIt does not take effect, i.e. /error does not get invoked when any http error or exception from servlet occurs.\n\nNot sure if this is a valid declaration per servlet 3.0 spec. But if supported it's very useful to allow a \"catch-all\" error handler.", "id": 155410, "time": "2012-03-30T19:43:24Z", "creator": "sutanu_g@yahoo.com", "creation_time": "2012-03-30T19:43:24Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 52135, "attachment_id": null, "id": 155411, "time": "2012-03-30T19:53:33Z", "creator": "markt@apache.org", "creation_time": "2012-03-30T19:53:33Z", "is_private": false, "text": "There is no reference in section 10.9.2 for the behaviour described. That it works in Glassfish does not make it part of the specification. There is no explanation of why those elements are now optional. Nor does section 10.9.2 explain how the case where neither is provided should be handled."}, {"count": 6, "tags": [], "creator": "rstoyanchev@yahoo.com", "attachment_id": null, "text": "Mark, what's the process of getting a clarification? This is a useful feature for example in REST-ful web service scenarios where the behavior of ServletResponse.sendError() to send HTML is not desirable:\n\nhttp://blog.newsplore.com/2010/08/04/restful-error-handling-with-tomcat-springmvc", "id": 155413, "time": "2012-03-30T20:13:58Z", "bug_id": 52135, "creation_time": "2012-03-30T20:13:58Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 52135, "attachment_id": null, "id": 155414, "time": "2012-03-30T20:17:10Z", "creator": "keith.donald@gmail.com", "creation_time": "2012-03-30T20:17:10Z", "is_private": false, "text": "The XSD for Servlet 3.0's web.xml clearly allows a <error-page> element containing only a <location> sub-element. Older versions of the XSD do not. This is an indication this is a Servlet 3.0 feature.\n\nThis feature is useful. Most REST API implementations need to report unhandled errors the same way: by returning a JSON body containing the error message (reason). Having to define a error-page entry for each error code that may be set by the application via HttpServletResponse#sendError is more work than it should be. Having a single error-page entry for a default error handler is a lot simpler and future proof.\n\nI consider this a bug in Tomcat 7. Shoot me down if you want!"}, {"count": 8, "tags": [], "bug_id": 52135, "text": "e-mail the Servlet EG (of which I am a member but only since JSR 340 so I do not have access to the thinking behind the changes in JSR 315).\n\nYou'll need to join the JSR-340 users mailing list. See http://java.net/projects/servlet-spec", "id": 155415, "time": "2012-03-30T20:19:33Z", "creator": "markt@apache.org", "creation_time": "2012-03-30T20:19:33Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "creator": "markt@apache.org", "is_private": false, "text": "There is no bug here since there is no documented behaviour in the specification (nor the Javadoc, nor the XSD) that Tomcat is not implementing.\n\nThe change in the XSD is indicative of something but there is zero clarity on what that might be. The surrounding comment text in the XSD gives no clues. Neither, as I pointed out earlier, does the spec document.\n\nI can see the usefulness of this feature but (absent clarification from the EG) it would be as a Tomcat specific extension. I am therefore moving this to an enhancement request. Enhancement requests with patches tend to get addressed sooner than those with out.", "id": 155438, "time": "2012-03-31T12:39:46Z", "bug_id": 52135, "creation_time": "2012-03-31T12:39:46Z", "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 52135, "text": "Mark, I agree with your assessment. It is an enhancement, and a useful one. The spec itself is, and will remain, fairly limited on feature set, and as Tomcat evolves nothing prevents us from adding usability to the container.", "id": 157060, "time": "2012-04-02T14:36:55Z", "creator": "fhanik@apache.org", "creation_time": "2012-04-02T14:36:55Z", "is_private": false, "attachment_id": null}, {"count": 11, "tags": [], "creator": "ljelinek@virtage.com", "attachment_id": null, "text": "Maybe useful to \"is/isn't part of Servlet 3.0\" discussion: https://blogs.oracle.com/arungupta/entry/totd_136_default_error_page\n\nBut no matter if it is \"de iure\" part of spec, this feature is very handy and I hope that will be added soon.", "id": 158024, "time": "2012-04-13T10:43:15Z", "bug_id": 52135, "creation_time": "2012-04-13T10:43:15Z", "is_private": false}, {"count": 12, "tags": [], "bug_id": 52135, "attachment_id": null, "id": 160106, "time": "2012-06-19T17:29:26Z", "creator": "jens.borgland@gmail.com", "creation_time": "2012-06-19T17:29:26Z", "is_private": false, "text": "I think this would be a very good thing to have from a security perspective - makes it very easy to reduce the amount of error information that is disclosed by specifying one single error page that handles all errors and returns some generic message."}, {"count": 13, "tags": [], "bug_id": 52135, "text": "There is a number of circumstantial pieces of evidence that all suggest the Servlet 3.0 EG intended to include this in the 3.0 specification, updated the XSD for web.xml accordingly and then forgot to actually add the feature to the specification document.\n\nI have added support for this to trunk and 7.0.x and it will be included in 7.0.29 onwards.", "id": 160370, "time": "2012-06-30T13:14:56Z", "creator": "markt@apache.org", "creation_time": "2012-06-30T13:14:56Z", "is_private": false, "attachment_id": null}, {"count": 14, "tags": [], "bug_id": 52135, "text": "The fix is said to have gone into 7.0.29\n\"I have added support for this to trunk and 7.0.x and it will be included in 7.0.29 onwards.\"\n\nI tested this on 7.0.30.Iam still facing this issue.", "id": 164123, "time": "2012-12-17T08:18:00Z", "creator": "shivakpa@in.ibm.com", "creation_time": "2012-12-17T08:18:00Z", "is_private": false, "attachment_id": null}, {"count": 15, "tags": [], "bug_id": 52135, "attachment_id": null, "id": 164543, "time": "2013-01-10T02:46:22Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2013-01-10T02:46:22Z", "is_private": false, "text": "(In reply to comment #14)\n> The fix is said to have gone into 7.0.29\n> \"I have added support for this to trunk and 7.0.x and it will be included in\n> 7.0.29 onwards.\"\n> \n> I tested this on 7.0.30.Iam still facing this issue.\n\nWorks for me, tested current 7.0.x trunk (it is near to be tagged as 7.0.35).\n\nWhatever does not work for you, you have to provide the details, including the steps required to reproduce the issue. If it is indeed a bug, open a new issue."}, {"count": 16, "tags": [], "creator": "knst.kolinko@gmail.com", "attachment_id": 29837, "text": "Created attachment 29837\nglobalerrortest.war\n\nFor the record: a sample web application that I used to test that it DOES work with the current 7.0.x.\n\nAssessing index.jsp triggers a compilation error, and the error page is displayed.\n\nI should also note that the implementation for this feature ( r1355734 ) did include a test case.", "id": 164544, "time": "2013-01-10T02:49:45Z", "bug_id": 52135, "creation_time": "2013-01-10T02:49:45Z", "is_private": false}, {"count": 17, "tags": [], "creator": "ljelinek@virtage.com", "attachment_id": null, "text": "Potential reason to reopen this: Having the following web.xml still end up with showing Tomcat default error page. Is it intended behavior or a bug?\n\n  <servlet>\n    <!-- throws some exception -->\n    <servlet-name>ThrowerServlet</servlet-name>\n    <servlet-class>org.example.ThrowerServlet</servlet-class>\n  </servlet>\n  \n  <servlet-mapping>\n    <servlet-name>ThrowerServlet</servlet-name>\n    <url-pattern>/*</url-pattern>\n  </servlet-mapping>  \n \n  <error-page>\n    <location>/WEB-INF/global-error-page.jsp</location>\n  </error-page>\n\nI assume that scenario here is the following:\n1. ThrowerServlet causes an exception\n2. Tomcat issue error dispatch\n3. But it is responded by ThrowerServlet (have catch-all URL pattern /*) which causes same exception again.\n4. Tomcat present default error page\n\nI'm asking if error page should be matched by /*, i.e. effectively skipping error page to display and resulting in calling buggy servlet on /* again.", "id": 165890, "time": "2013-03-17T09:48:29Z", "bug_id": 52135, "creation_time": "2013-03-17T09:48:29Z", "is_private": false}, {"count": 18, "tags": [], "bug_id": 52135, "attachment_id": null, "id": 165900, "time": "2013-03-17T14:35:39Z", "creator": "balusc@gmail.com", "creation_time": "2013-03-17T14:35:39Z", "is_private": false, "text": "@Libor: this is behaving as specified. Your servlet is mapped on an overly generic URL pattern of /* which thus also overrides among others the servletcontainer's builtin JspServlet which is listening on *.jsp which thus never get the chance to serve the JSP."}]