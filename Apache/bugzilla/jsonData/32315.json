[{"count": 0, "tags": [], "bug_id": 32315, "attachment_id": null, "id": 67208, "time": "2004-11-19T13:10:11Z", "creator": "asf@element80.net", "creation_time": "2004-11-19T13:10:11Z", "is_private": false, "text": "mod_disk_cache appears to be badly broken when used in combination with\nmod_proxy (acting as a reverse proxy) and a Zope site.  The initial page fetch\nto the relayed page works correctly, but subsequent cache hits return duplicated\nheaders.  This includes a second \"Content-Encoding: gzip\" header, which breaks\nMozilla Firefox.  The page renders as garbage because it cannot be\ndoubly-decompressed.\n\nA forced refresh (shift-F5) returns a correct response but only for that one\nrequest.\n\nThe problem vanishes if mod_disk_cache is swapped with mod_mem_cache, or if the\ncache is disabled.\n\nI do not think that Zope site in particular is related to this bug, although I\nhaven't been able to try other gzip-enabled sites behind my reverse proxy.\n\n\nHere is a typical request and the incorrect response headers:\n\nGET /news HTTP/1.1\nHost: www.haloplayers.org\nAccept:\ntext/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5\nAccept-Language: en-us,en;q=0.5\nAccept-Encoding: gzip,deflate\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\nKeep-Alive: 300\nConnection: keep-alive\nReferer: http://www.haloplayers.org/\n\nHTTP/1.1 200 OK\nDate: Fri, 19 Nov 2004 11:45:16 GMT\nServer: Zope/(unreleased version, python 2.3.3, linux2) ZServer/1.1 Plone/2.0.4\nContent-Language:\nContent-Encoding: gzip\nExpires: Sat, 1 Jan 2000 00:00:00 GMT\nVary: Accept-Encoding\nEtag:\nPragma: no-cache\nContent-Length: 4340\nContent-Language:\nContent-Encoding: gzip\nExpires: Sat, 1 Jan 2000 00:00:00 GMT\nEtag:\nPragma: no-cache\nContent-Type: text/html;charset=utf-8\n\n\n(I am using 2.0.51-2 Fedora Core 2 httpd packages, which include versions of\nmod_cache and mod_disk_cache that are identical to those shipped with 2.0.52)"}, {"count": 1, "tags": [], "creator": "asf@element80.net", "attachment_id": null, "id": 67209, "time": "2004-11-19T13:32:24Z", "bug_id": 32315, "creation_time": "2004-11-19T13:32:24Z", "is_private": false, "text": "Ugh.  Directory mixup, the Fedora Core rpm definately does NOT have the latest\nmod_cache and mod_disk_cache (compared to cvs).  I will try to verify this bug\nin the latest CVS, but will not be able to get to it for a few days."}, {"attachment_id": null, "tags": [], "bug_id": 32315, "text": ">(I am using 2.0.51-2 Fedora Core 2 httpd packages, which \n>include versions of mod_cache and mod_disk_cache that are \n>identical to those shipped with 2.0.52)\n\nPlease don't report such bugs to this db.  We understand that\nin all likelihood the problem exists in some level of Apache \nhttpd, but please use the vendor bug db to report bugs\nin the vendor's httpd and only open bugs in this db if you\ncan recreate the problem with the Apache httpd which you\ngot from us.\n\n>I will try to verify this bug in the latest CVS, but will \n>not be able to get to it for a few days.\n\nThanks; please re-open the PR at that point.\n", "count": 2, "id": 67218, "time": "2004-11-19T15:14:17Z", "creator": "trawick@apache.org", "creation_time": "2004-11-19T15:14:17Z", "is_private": false}]