[{"count": 0, "tags": [], "bug_id": 44364, "text": "Added Implementations for Excel functions MATCH(), NA(), SUMPRODUCT(). Added \njunits.\n\nRewrote 3 classes(GenericFormulaTestCase, TestEverything, TestEverything) into \nTestFormulasFromSpreadsheet.  This served a few purposes:\n - to allow for more conventional structuring of the test suites\n - to formalise and simplify the interface between the test spreadsheet and \nthe test code.\n - to identify and fix a few bugs (related to comparing expected vs actual \nevaluation results)\nThose 3 classes should be deleted.  The most correct appropriate predecessor \nof TestFormulasFromSpreadsheet is GenericFormulaTestCase.\n\nAdded cases for COUNTA, COUNTIF, MATCH, NA, and SUMPRODUCT to the spreadsheet\n\nAs a result of fixing the spreadsheet and related test, a few other bugs \nbecame visible. \n\nFixed Excel error code propagation throughout HSSFFormulaEvaluator.   \nFixed error code handling in ROUNDDOWN(), ROUNDUP() and T(). Added junits.\nNote - TestFormulasFromSpreadsheet has a disabled assert which confirms \nexpected error codes.  This can be enabled after another 45 functions like \nROUNDDOWN and ROUNDUP are fixed wrt. error handling.\n\nFixed bug (involving column area refs) in UnaryPlusEval.  Added junit.\n\nFixed FormulaParser.toFormulaString() for the case of a single no-arg function \ne.g. \"=NOW()\". Added junit.", "id": 113461, "time": "2008-02-05T21:01:55Z", "creator": "josh@apache.org", "creation_time": "2008-02-05T21:01:55Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 44364, "attachment_id": 21477, "id": 113462, "time": "2008-02-05T21:03:54Z", "creator": "josh@apache.org", "creation_time": "2008-02-05T21:03:54Z", "is_private": false, "text": "Created attachment 21477\nsvn diff"}, {"count": 2, "tags": [], "bug_id": 44364, "is_private": false, "id": 113463, "attachment_id": 21478, "creator": "josh@apache.org", "creation_time": "2008-02-05T21:04:40Z", "time": "2008-02-05T21:04:40Z", "text": "Created attachment 21478\ntar bzip2 of newly added files (5 junit classes)"}, {"count": 3, "tags": [], "bug_id": 44364, "text": "Created attachment 21479\nnew version of TestDataValidation.xls \n\nsvn diff skips binary files\nThis spreadsheet belongs here:\nsrc/testcases/org/apache/poi/hssf/data/TestDataValidation.xls", "id": 113464, "time": "2008-02-05T21:14:36Z", "creator": "josh@apache.org", "creation_time": "2008-02-05T21:14:36Z", "is_private": false, "attachment_id": 21479}, {"count": 4, "tags": [], "creator": "apache@gagravarr.org", "text": "Thanks for this, it's quite the mammoth patch!\n\nI've done a visual review of the patch, and it does seem fine from that. Given\nthe size, I'll wait a few days for other people to cast an eye over it, and if\nno-one shouts I'll then apply it", "id": 113481, "time": "2008-02-06T06:10:16Z", "bug_id": 44364, "creation_time": "2008-02-06T06:10:16Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "text": "I exercised your code and TestFormulasFromSpreadsheet fails:\n\nant\n-Dtestcase=org.apache.poi.hssf.record.formula.eval.TestFormulasFromSpreadsheet \nsingle-scratchpad-test\n.....\n\nTest spreadsheet cell empty on row (79). Expected function name or\n'<END-OF-FUNCTIONS>'\njunit.framework.AssertionFailedError: Test spreadsheet cell empty on row (79).\nExpected function name or '<END-OF-FUNCTIONS>'\n\tat\norg.apache.poi.hssf.record.formula.eval.TestFormulasFromSpreadsheet.processFunctionGroup(TestFormulasFromSpreadsheet.java:205)\n\tat\norg.apache.poi.hssf.record.formula.eval.TestFormulasFromSpreadsheet.testFunctionsFromTestSpreadsheet(TestFormulasFromSpreadsheet.java:171)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\n\nSee the attached junit report.\n\nAll other tests pass.\n\n\nYegor ", "is_private": false, "bug_id": 44364, "id": 113526, "time": "2008-02-07T06:36:00Z", "creator": "yegor@dinom.ru", "creation_time": "2008-02-07T06:36:00Z", "attachment_id": null}, {"count": 6, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": 21492, "text": "Created attachment 21492\njunit report on failing TestFormulasFromSpreadsheet", "id": 113527, "time": "2008-02-07T06:37:11Z", "bug_id": 44364, "creation_time": "2008-02-07T06:37:11Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 44364, "attachment_id": null, "id": 113550, "time": "2008-02-07T11:38:46Z", "creator": "josh@apache.org", "creation_time": "2008-02-07T11:38:46Z", "is_private": false, "text": "You need to copy the new version of TestDataValidation.xls to \nsrc/testcases/org/apache/poi/hssf/data/\n\nI wasn't sure about how to include modified binary files in patch submissions.\n\nThe last revision of this file seems to be 615859 (Jan 28), and my work was \nafter that so there shouldn't be any need to merge."}, {"count": 8, "tags": [], "bug_id": 44364, "attachment_id": null, "id": 113747, "time": "2008-02-14T07:07:40Z", "creator": "apache@gagravarr.org", "creation_time": "2008-02-14T07:07:40Z", "is_private": false, "text": "Request for next time...\n\nIf you are uploading a new version of TestDataValidation.xls again, any chance\nyou could gzip / bzip it first? It's pretty beasting, and takes an age to\ndownload over GPRS, which is an issue when I decide to work on POI from a cafe!\n\n(Just doing a final review before applying now)"}, {"count": 9, "tags": [], "bug_id": 44364, "attachment_id": null, "is_private": false, "id": 113748, "time": "2008-02-14T07:58:07Z", "creator": "apache@gagravarr.org", "creation_time": "2008-02-14T07:58:07Z", "text": "Thanks for this, applied to svn\n\nHad to copy the new TestDataValidation.xls to FormulaEvalTestData.xls to get it\nto work. I think we need to review the fact that we have these two, and also try\nto figure out why TestDataValidation.xls sometimes gets changed"}]