[{"count": 0, "tags": [], "bug_id": 50096, "attachment_id": null, "is_private": false, "id": 140756, "time": "2010-10-15T02:49:03Z", "creator": "martin.studer@mirai-solutions.com", "creation_time": "2010-10-15T02:49:03Z", "text": "Cells in a row with an index > 255 that contain formulas may be evaluated wrongly.\n\nThe specific case can be seen in the attached Excel file (repro.xlsx). There are two rows. The first row simply contains the numbers 1 - 300. The second row simply refers to the cell value above in the first row by a simple formula.\n\nWhen evaluating the cell values (using the FormulaEvaluator) you get wrong cell values for cells in the second row if they have an index > 255.\n\nThe following code demonstrates the problem:\n\nWorkbook wb = WorkbookFactory.create(new FileInputStream(\"repro.xlsx\"));\n        FormulaEvaluator evaluator = wb.getCreationHelper().createFormulaEvaluator();\n\n        for(int i = 245; i < 265; i++) {\n            Cell cell_noformula = wb.getSheetAt(0).getRow(0).getCell(i);\n            Cell cell_formula = wb.getSheetAt(0).getRow(1).getCell(i);\n\n            CellValue cv_noformula = evaluator.evaluate(cell_noformula);\n            CellValue cv_formula = evaluator.evaluate(cell_formula);\n            System.out.println(\"Cell \" + i + \": no formula = \" + cv_noformula.getNumberValue() + \", formula = \" + cv_formula.getNumberValue());\n        }\n\n\nOS: Windows 7\nPOI: 3.7-beta3\nJava: 1.6.0_20 64-bit"}, {"count": 1, "tags": [], "creator": "martin.studer@mirai-solutions.com", "text": "Created attachment 26177\nExcel file for bug reproduction", "id": 140757, "time": "2010-10-15T02:50:34Z", "bug_id": 50096, "creation_time": "2010-10-15T02:50:34Z", "is_private": false, "attachment_id": 26177}, {"count": 2, "tags": [], "creator": "yegor@dinom.ru", "text": "Fixed in r1033556, junit added.\n\nYegor", "id": 141605, "time": "2010-11-10T11:11:09Z", "bug_id": 50096, "creation_time": "2010-11-10T11:11:09Z", "is_private": false, "attachment_id": null}]