[{"count": 0, "tags": [], "creator": "chip@force-elite.com", "text": "A 500 ISE page is not send to clients with mod_cgi, which there is an invalid\nCGI.  With mod_cgid the correct output is generated.\n\nTo repo:\necho \"foo\" > foo.cgi\n\nWith mod_cgi the output to a client is:\n% curl -is --compressed http://example.com/foo.cgi\n\nHTTP/1.1 500 Internal Server Error\nDate: Fri, 02 Jun 2006 22:21:49 GMT\nServer: Apache/2.2.2 (Unix) mod_ssl/2.2.2 OpenSSL/0.9.7a\nContent-Length: 0\nConnection: close\nContent-Type: text/plain\n\nA zero byte reply. However, just swap the LoadModule to mod_cgid, and restart,\nand the reply is this:\nHTTP/1.1 500 Internal Server Error\nDate: Fri, 02 Jun 2006 22:18:36 GMT\nServer: Apache/2.2.2 (Unix) mod_ssl/2.2.2 OpenSSL/0.9.7a\nVary: Accept-Encoding\nContent-Length: 653\nConnection: close\nContent-Type: text/html; charset=iso-8859-1\n\n<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\n<html><head>\n<title>500 Internal Server Error</title>\n</head><body>\n<h1>Internal Server Error</h1>\n<p>The server encountered an internal error or\nmisconfiguration and was unable to complete\nyour request.</p>\n....\netc.", "id": 89718, "attachment_id": null, "bug_id": 39710, "creation_time": "2006-06-02T22:22:34Z", "time": "2006-06-02T22:22:34Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 39710, "text": "Looks like this is caused by the changes in r231167:\nhttp://svn.apache.org/viewvc?view=rev&revision=231167\n\nmod_cgid was not modified to be kept in sync with mod_cgi.  They both have\nnearly the same code path after the ap_scan_script_header_err...", "id": 89719, "time": "2006-06-02T22:52:37Z", "creator": "chip@force-elite.com", "creation_time": "2006-06-02T22:52:37Z", "is_private": false, "attachment_id": null}, {"count": 2, "attachment_id": null, "bug_id": 39710, "text": "*** Bug 37938 has been marked as a duplicate of this bug. ***", "id": 96666, "time": "2006-12-08T10:47:23Z", "creator": "vjong@jandjgraphics.com", "creation_time": "2006-12-08T10:47:23Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "creator": "mail@cs-ware.de", "text": "this bug is still in 2.2.4, if you have mod_deflate enabled, you get the\ngz-output instead of a text-file", "id": 98302, "attachment_id": null, "bug_id": 39710, "creation_time": "2007-01-20T05:13:34Z", "time": "2007-01-20T05:13:34Z", "is_private": false}, {"count": 4, "tags": [], "creator": "chip@force-elite.com", "attachment_id": 19513, "is_private": false, "id": 98958, "time": "2007-02-04T21:30:09Z", "bug_id": 39710, "creation_time": "2007-02-04T21:30:09Z", "text": "Created attachment 19513\ndon't truncate error replies"}, {"count": 5, "tags": [], "creator": "chip@force-elite.com", "attachment_id": null, "is_private": false, "id": 98959, "time": "2007-02-04T21:30:59Z", "bug_id": 39710, "creation_time": "2007-02-04T21:30:59Z", "text": "Attached patch has been running in production since this bug was opened.  If you\nrun into this problem, can you try patching your mod_cgi.c?"}, {"count": 6, "tags": [], "bug_id": 39710, "text": "I can confirm the patch works on Apache2.2.4 with mod_deflate configured as \nwell.", "id": 98960, "time": "2007-02-04T22:25:38Z", "creator": "vjong@jandjgraphics.com", "creation_time": "2007-02-04T22:25:38Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 39710, "attachment_id": null, "id": 101763, "time": "2007-04-16T11:08:42Z", "creator": "bkline@rksystems.com", "creation_time": "2007-04-16T11:08:42Z", "is_private": false, "text": "Anything I can do to help get this bug fixed?  Is testing the patch all that\nstands in the way of getting it folded into the trunk?"}, {"count": 8, "tags": [], "creator": "bkline@rksystems.com", "is_private": false, "id": 102478, "creation_time": "2007-04-26T07:21:26Z", "time": "2007-04-26T07:21:26Z", "bug_id": 39710, "text": "(In reply to comment #7)\n> Anything I can do to help get this bug fixed?  Is testing the patch all that\n> stands in the way of getting it folded into the trunk?\n\nHello?  Anybody home?  What's next?", "attachment_id": null}, {"count": 9, "tags": [], "creator": "nick@webthing.com", "is_private": false, "text": "*** Bug 42525 has been marked as a duplicate of this bug. ***", "id": 103710, "time": "2007-05-26T11:31:06Z", "bug_id": 39710, "creation_time": "2007-05-26T11:31:06Z", "attachment_id": null}, {"count": 10, "tags": [], "creator": "Robert.Siemer@gmx.de", "attachment_id": null, "is_private": false, "id": 103711, "time": "2007-05-26T12:43:40Z", "bug_id": 39710, "creation_time": "2007-05-26T12:43:40Z", "text": "Why should bug 42525 be a duplicate of this one?\n\nMy setup runs with the Worker MPM, that means with mod_cgid.c. But the patch\nhere touches only mod_cgi.c and so can't possibly change anything in \"my\" bug.\n\nNick, could you explain that to me?"}, {"count": 11, "attachment_id": null, "bug_id": 39710, "text": "Please don't add other people to an error report!\n\n(In reply to comment #10)\n> Why should bug 42525 be a duplicate of this one?\n\nIt certainly looks like it.  Is your CGI script\n  (a) crashing,\n  (b) generating an error response, or\n  (c) generating a malformed response?\n\n> My setup runs with the Worker MPM, that means with mod_cgid.c. But the patch\n> here touches only mod_cgi.c and so can't possibly change anything in \"my\" bug.\n\nwhat does \"httpd -M\" tell you?", "id": 103712, "time": "2007-05-26T13:51:09Z", "creator": "nick@webthing.com", "creation_time": "2007-05-26T13:51:09Z", "tags": [], "is_private": false}, {"count": 12, "tags": [], "creator": "Robert.Siemer@gmx.de", "attachment_id": null, "is_private": false, "id": 103713, "time": "2007-05-26T14:18:41Z", "bug_id": 39710, "creation_time": "2007-05-26T14:18:41Z", "text": "(In reply to comment #11)\n> Please don't add other people to an error report!\n\nI obviously wanted to make sure you get my comment. I assume now that you get\nthese comments otherwise, too. Do you know a smart way how to find that out? -\nWho added me to this bug here?\n\n> (In reply to comment #10)\n> > Why should bug 42525 be a duplicate of this one?\n> \n> It certainly looks like it.  Is your CGI script\n>   (a) crashing,\n>   (b) generating an error response, or\n>   (c) generating a malformed response?\n\nIf you refer to the script I mention in \"my\" bug, it prints a \"hello\" and exits.\nI think that is what you refer to with (c). - But what is (a) exactly?\n\nI first noticed the problem with a script that should generated a conforming 200\nOK response, but it didn't because of errors in it. You could say it \"crashed\",\nbut doing so, it generated a malformed response...\n\n> > My setup runs with the Worker MPM, that means with mod_cgid.c. But the patch\n> > here touches only mod_cgi.c and so can't possibly change anything in \"my\" bug.\n> \n> what does \"httpd -M\" tell you?\n\nsiemer@polar:~$ /usr/sbin/apache2 -M\nLoaded Modules:\n core_module (static)\n log_config_module (static)\n logio_module (static)\n mpm_worker_module (static)\n http_module (static)\n so_module (static)\n actions_module (shared)\n alias_module (shared)\n auth_basic_module (shared)\n authn_file_module (shared)\n authz_default_module (shared)\n authz_groupfile_module (shared)\n authz_host_module (shared)\n authz_user_module (shared)\n autoindex_module (shared)\n cache_module (shared)\n cgi_module (shared)\n cgid_module (shared)\n dir_module (shared)\n disk_cache_module (shared)\n env_module (shared)\n include_module (shared)\n info_module (shared)\n mime_module (shared)\n negotiation_module (shared)\n rewrite_module (shared)\n setenvif_module (shared)\n speling_module (shared)\n status_module (shared)\n suexec_module (shared)\n userdir_module (shared)\nSyntax OK\n\n\nThe documentation at http://httpd.apache.org/docs/2.2/mod/mod_cgid.html says\nthat a threaded MPM uses mod_cgid. And the server-info handler on my site\nreports the Worker MPM with \"threaded: yes\". - Are there setups that use both!??\n\nRegards"}, {"count": 13, "tags": [], "bug_id": 39710, "text": "(In reply to comment #12)\n\n>  cgi_module (shared)\n\nRemove mod_cgi, and I expect your bug will go away.", "id": 103714, "time": "2007-05-26T15:46:47Z", "creator": "nick@webthing.com", "creation_time": "2007-05-26T15:46:47Z", "is_private": false, "attachment_id": null}, {"count": 14, "attachment_id": null, "bug_id": 39710, "is_private": false, "id": 103718, "time": "2007-05-26T17:02:05Z", "creator": "Robert.Siemer@gmx.de", "creation_time": "2007-05-26T17:02:05Z", "tags": [], "text": "(In reply to comment #13)\n> (In reply to comment #12)\n> \n> >  cgi_module (shared)\n> \n> Remove mod_cgi, and I expect your bug will go away.\n\nI removed the mod_cgi and the bug went away. Thank you, Nick.\n\nThat makes now the link between the mpm and the two cgi(d) modules unclear to\nme. And if loading both modules makes no sense, it could raise an error or\nwarning...\n\nRegards, R"}, {"count": 15, "tags": [], "bug_id": 39710, "text": "(In reply to comment #14)\n\n> \n> That makes now the link between the mpm and the two cgi(d) modules unclear to\n\nSee the second paragraph of the summary of \n\nhttp://httpd.apache.org/docs/2.2/en/mod/mod_cgid.html\n\nfor why mod_cgid exists. If forks of multi threaded processes are not expensive\non your OS you can use mod_cgi with a threaded MPM as well (you can even do so\nif they are expensive but then you may pay a huge performance penalty).", "id": 103719, "time": "2007-05-26T17:28:39Z", "creator": "rpluem@apache.org", "creation_time": "2007-05-26T17:28:39Z", "is_private": false, "attachment_id": null}, {"count": 16, "tags": [], "creator": "Robert.Siemer@gmx.de", "is_private": false, "id": 103720, "creation_time": "2007-05-26T18:31:12Z", "time": "2007-05-26T18:31:12Z", "bug_id": 39710, "text": "(In reply to comment #15)\n> ... \n> If forks of multi threaded processes are not expensive\n> on your OS you can use mod_cgi with a threaded MPM as well (you can even do so\n> if they are expensive but then you may pay a huge performance penalty).\n\nWhat I draw out of that:\nyou can use mod_cgid or mod_cgi with whatever MPM. And the one you load first\ngets used.\n\nThat opens a new question: Why says the doc \"[mod_cgid] is used by default\ninstead of mod_cgi whenever a multi-threaded MPM is selected\" when there is no\nsuch default?\n", "attachment_id": null}]