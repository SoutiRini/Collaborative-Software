[{"count": 0, "tags": [], "bug_id": 39737, "attachment_id": null, "text": "It seems that the access log with format \"%{tid}P\" gives the wrong thread id\non Windows.  I record the thread id in my kernel driver using\nPsGetCurrentThreadId(),\nwhich reports a different number than the apache log \"%{tid}P\".  I also\ntried a 3rd party monitoring software (Process Explorer v10.11), which\nreturns the same result as mine.  \"%{pid}P\" gives the correct process id though.\n\nCould someone look into this?  Thanks.", "id": 89829, "time": "2006-06-06T19:09:26Z", "creator": "gaodebin@hotmail.com", "creation_time": "2006-06-06T19:09:26Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 39737, "attachment_id": null, "text": "Just checked the source, and it's the thread handle that's being logged on\nWindows.  I don't see why the handle, instead of the id, is being logged, as the\nlog is to be used outside of httpd, where logging the id makes more sense.  BTW,\n%{pid}P logs the process id on Windows.\n\nAnyway, if there is indeed a reason to log the thread handle, please update the\ndocumentation. ", "id": 90110, "time": "2006-06-12T19:41:14Z", "creator": "gaodebin@hotmail.com", "creation_time": "2006-06-12T19:41:14Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 39737, "text": "Anyone cares to comment on this?\n\nThread Ids are unique throughout the system, while handles are only unique\nwithin the process.\n\nIt's really a pain not getting the thread id from the logs.  All I'm trying to\ndo is to find the corresponding thread that served the requests.  I can easily\nobtain thread ids of all the threads; I can also get a handle to any thread, but\nthe integer value of that handle I obtain is different from what's been logged\nby http, because the handles to the same thread could be different.", "id": 90146, "time": "2006-06-13T15:36:42Z", "creator": "gaodebin@hotmail.com", "creation_time": "2006-06-13T15:36:42Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 39737, "attachment_id": null, "text": "You are absolutely correct; the thread id and not its handle should be recorded.\n\nI should think calling gettid() (corresponding to the getpid call in\nap_append_pid) where available would have been the \"proper\" implementation.\n\nPatches welcome (gettid detection for unix is, of course, required).\n\nOne ponders why ap_append_tid wasn't implemented ;-)  (Appending, say, nothing\non a non-threaded architecture).", "id": 112322, "time": "2007-12-30T22:26:23Z", "creator": "wrowe@apache.org", "creation_time": "2007-12-30T22:26:23Z", "is_private": false}]