[{"count": 0, "tags": [], "text": "To demonstrate the problem first create two resource bundle properties files\nas follows:\n--\nlabels_en.properties:\n  hello=hello\n  goodbye=goodbye\n--\nlabels_es.properties:\n  hello=hola\n  goodbye=adios\n--\nput them in a jar and place the jar in the WEB-INF/lib dir of a webapp\n\nnow place the following code into a .jsp file and put it in the main dir of\nthe same webapp where you put the resource bundle jar\n--\n<%-- possible tomcat bug when using JSTL fmt:setLocale\n--%>\n<%@ taglib prefix=\"c\"   uri=\"http://java.sun.com/jstl/core\" %>\n<%@ taglib prefix=\"fmt\" uri=\"http://java.sun.com/jstl/fmt\" %>\n<html>\n<body>\n\n<c:if test=\"${param.locale != null}\">\n <fmt:setLocale value=\"${param.locale}\" scope=\"session\" />\n</c:if>\n\n<a href=\"?locale=en\">English</a> -\n<a href=\"?locale=es\">Spanish</a> -\n<br /><br />\n<jsp:useBean id=\"now\" class=\"java.util.Date\" />\nThe date functions seem to work correctly with regard to locale.<br />\nDate: <fmt:formatDate value=\"${now}\" dateStyle=\"full\" /><br />\nTime: <fmt:formatDate value=\"${now}\" type=\"time\" /><br />\n<br />\n<%-- create a jar with the resource bundles .class and/or .properties files\n     that contain the key=value pairs:\n\te.g.: labels_en.properties, labels_es.properties\n     and place it in the WEB-INF/lib dir of your webapp \n--%>\n<fmt:setBundle basename=\"labels\" var=\"labelsBundle\" scope=\"session\"/>\n<fmt:bundle basename=\"labels\">\nThe bundle functions do not seem to work correctly with regard to locale<br />\nunless we specifically do a &lt;fmt:setLocale \nvalue=\"hard_coded_string\" /&gt;.<br />\nIt seems as though the fmt:setLocale is interpreted at compile time not \nruntime.<br />\nHello: <fmt:message key=\"hello\" /><br />\nGoodbye: <fmt:message key=\"goodbye\" />\n</fmt:bundle>\n\n</body>\n</html>\n--\nbring up browser and access the .jsp file\nhttp://localhost:8080/thewebapp/thefile.jsp", "attachment_id": null, "bug_id": 13523, "id": 24328, "time": "2002-10-11T03:30:54Z", "creator": "grenoml@yahoo.com", "creation_time": "2002-10-11T03:30:54Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 13523, "text": "Your jsp source-code seems a mistake.\n\nTo the <fmt:bundle> tags in the jsp you wrote,\nplease specify the \"bundle\" attribute given the \"labelsBundle\" EL value.\n\nFor examples,\n ............................................................\n ............................................................\n <fmt:setBundle basename=\"labels\" var=\"labelsBundle\" scope=\"session\"/>\n Hello: <fmt:message key=\"hello\" bundle=\"${labelsBundle}\" /><br />\n Goodbye: <fmt:message key=\"goodbye\" bundle=\"${labelsBundle}\" />\n\nRegards,\nKan Ogawa", "id": 24337, "time": "2002-10-11T06:47:14Z", "creator": "super-creek@jcom.home.ne.jp", "creation_time": "2002-10-11T06:47:14Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "grenoml@yahoo.com", "attachment_id": null, "id": 24357, "time": "2002-10-11T14:48:57Z", "bug_id": 13523, "creation_time": "2002-10-11T14:48:57Z", "is_private": false, "text": "Yes, you can do it this way by declaring the bundle in every single fmt: \nstatement, but it should not be necessary according to the specification and \ntherefore this is a bug.\n\nFrom Section 9.2 of the JSR-52 JavaServer Pages\u2122 Standard Tag Library 1.0 (JSTL \n1.0) specification:\n--\n<fmt:bundle> action\nIf a formatting action is nested inside a <fmt:bundle> action (see Section \n8.6), the\nlocale of the i18n localization context of the enclosing <fmt:bundle> action is \nused\nas the formatting locale. ...\n--\n\n"}, {"count": 3, "tags": [], "creator": "bradley.scott@emagine-int.com", "attachment_id": null, "id": 30614, "time": "2003-02-04T05:04:01Z", "bug_id": 13523, "creation_time": "2003-02-04T05:04:01Z", "is_private": false, "text": "When I try to use fmt:setLocale, supplying a scope attribute, the server throws \na RuntimeException.\n\nExample:\n    <fmt:setLocale value=\"ja\" scope=\"session\" />\nError message:\n    Illegal scope attribute without var in \"fmt:setLocale\" tag\nException:\n    java.lang.RuntimeException: org.apache.jasper.JasperException: \n<h3>Validation error messages from tag library fmt</h3>Illegal scope attribute \nwithout var in \"fmt:setLocale\" tag.\n\nThe JSTL spec (version 1.0) for fmt:setLocale is:\n   <fmt:setLocale value=\"locale\"\n      [variant=\"variant\"]\n      [scope=\"{page|request|session|application}\"]/>\n\ntherefore I cannot supply a var attribute, nor would it make much sense to do \nso.\n\nIs there another way to set the Locale at the session scope for use with the \nother fmt tags?\n\nThis was tested on standard taglib release 1.0.2, servlet engine: JBoss v3.0.4\n\nRegards,\nBrad.\n"}, {"count": 4, "tags": [], "creator": "pierre.delisle@sun.com", "attachment_id": null, "id": 36156, "time": "2003-04-26T00:54:09Z", "bug_id": 13523, "creation_time": "2003-04-26T00:54:09Z", "is_private": false, "text": "I've just committed a new sample JSP page to test the behavior \ndescribed in this bug report.\n\nI have tested it with tomcat 4.1.24 and everything ran \naccording to spec.\n\nPlease get a copy of the nightly of the 1.0 branch\n(STANDARD_1_0_BRANCH) and run that sample JSP\npage (called 'Demo', under the 'formatting and I18N'\ncategory)."}]