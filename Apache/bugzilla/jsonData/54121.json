[{"count": 0, "text": "in most use case,tomcat was running for just one webapp and disabled reloadable option,so if it's unnecessary to wait clearReferences(),System.exit() is OK.\nin my case.I have a autodeploy shell to shutdown tomcat and unzip wars then startup tomcat,tomcat have to took long time when shutdown,sometime it's halt and not terminate the process ,I need to kill the process,I hope tomcat provide a way to disable such feature.", "bug_id": 54121, "attachment_id": null, "id": 163299, "time": "2012-11-09T05:38:28Z", "creator": "zhouyanming@gmail.com", "creation_time": "2012-11-09T05:38:28Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 54121, "attachment_id": null, "id": 163308, "time": "2012-11-09T11:19:00Z", "creator": "markt@apache.org", "creation_time": "2012-11-09T11:19:00Z", "is_private": false, "text": "checkThreadLocalMapForLeaks has nothing to do with Tomcat taking a long time to stop. Failure to stop is nearly always an application issue, not a Tomcat one.\n\nThis issue belongs on the users list."}, {"count": 2, "tags": [], "bug_id": 54121, "attachment_id": null, "id": 163320, "time": "2012-11-09T17:46:38Z", "creator": "bugzilla@pidster.com", "creation_time": "2012-11-09T17:46:38Z", "is_private": false, "text": "(In reply to comment #0)\n> in most use case,tomcat was running for just one webapp and disabled\n> reloadable option,so if it's unnecessary to wait\n> clearReferences(),System.exit() is OK.\n\nand System.exit() is never OK."}, {"count": 3, "attachment_id": null, "bug_id": 54121, "text": "I would like to reopen this bug, IMHO reporting this does not help at all as most of the time it is reported for external libraries, so the only result is wasted disk space.\n\nI believe everybody just restarts the tomcat process after updating their web applications - the most reliable approach.\n\nE.g. we have the following in logs:\n\nDec 18, 2014 1:58:10 PM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks\nSEVERE: The web application [] created a ThreadLocal with key of type [com.google.common.escape.Platform$1] (value [com.google.common.escape.Platform$1@3fae9355]) and a value of type [char[]] (value [[C@27d94f22]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.\n\nthis is just char[1024] reused and I am fine with that.\n\nAnd a few similar cases from other libraries, which we can't fix or stop using at the moment.\n\nI wonder if this warning is reported in each web project bugtracker, e.g. https://code.google.com/p/google-gson/issues/detail?id=402\nhttps://www.jfrog.com/jira/browse/RTFACT-5567\nhttps://confluence.atlassian.com/display/STASHKB/Harmless+checkThreadLocalMapForLeaks+messages+on+catalina.out\n\nI see 2 possible ways to fix this message which we don't care about:\n- an option to disable it per webapp/server\n- reporting it as INFO/WARN so the message can be suppressed in logging configuration\n\nWhat do you think of this?", "id": 180156, "time": "2015-01-05T12:43:48Z", "creator": "alex.panchenko@gmail.com", "creation_time": "2015-01-05T12:43:48Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 54121, "attachment_id": null, "text": "Re-closing as INVALID as that is the correct status for the original report.\n\nSee BZ 50175 for the request to make the memory leak checks configurable.", "id": 180157, "time": "2015-01-05T12:52:44Z", "creator": "markt@apache.org", "creation_time": "2015-01-05T12:52:44Z", "is_private": false}]