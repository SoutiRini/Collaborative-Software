[{"count": 0, "tags": [], "text": "When using Tomcat 4.1.29 and JSTL, pages which are expected to be encoded in\nUTF-8 are being encoded in native encoding.  The problem does not occur with\nTomcat 5.0.", "attachment_id": null, "bug_id": 36738, "id": 80199, "time": "2005-09-20T18:43:56Z", "creator": "developeratca@gmail.com", "creation_time": "2005-09-20T18:43:56Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 36738, "attachment_id": null, "text": "There is far from sufficient information in this report to enable us to\ninvestigate this issue.\n\nPlease follow the advice at http://jakarta.apache.org/tomcat/bugreport.html\n\nI strongly suggest you try both of the following before re-opneing this issue:\n- test with 4.1.31\n- ask on the tomcta-user list\n\nIf you re-open this report, please provide the smallest possible test case that\ndemonstrates the issue.", "id": 80207, "time": "2005-09-20T20:23:20Z", "creator": "markt@apache.org", "creation_time": "2005-09-20T20:23:20Z", "is_private": false}, {"count": 2, "text": "Created attachment 16525\nTestcase for the problem\n\n\tTo duplicate the problem do the following:\n\n\t1.  In IE delete all languages then add Japanese\n\t2.  Deploy the test.war file in tomcat\n\t3.  Access the localebad.jsp (http://localhost:8080/test/localebad.jsp)\n\n\t4.  Check the character encoding by using the browser right click menu.\n It\n\twill show that the page is using Shift-JIS which is wrong.\n\t5.  try the same test with locale.jsp, you will see that it is properly\n\n\tencoded using UTF-8", "bug_id": 36738, "attachment_id": 16525, "id": 80467, "time": "2005-09-26T08:34:13Z", "creator": "developeratca@gmail.com", "creation_time": "2005-09-26T08:34:13Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "creator": "developeratca@gmail.com", "text": "If I include <fmt:setBundle basename=\"messages\"/>, it will undo the\nencoding set using request.setCharacterEncoding().\nThe workaround is to use\n<% response.setContentType(\"text/html; charset=UTF-8\");%>\nafter <fmt:setBundle>.\nThe problem doesn't occur with 5.5.9.\nThanks,\nGanesh", "id": 80470, "attachment_id": null, "bug_id": 36738, "creation_time": "2005-09-26T10:39:45Z", "time": "2005-09-26T10:39:45Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 36738, "is_private": false, "text": "The short answer is that the behaviour you are seeing is as per the relevant\nspecs and therefore this bug in invalid.\n\nThe longer answer is:\nAs per the section 8.4 of the JSTL 1.0 spec, use of <fmt:setBundle ...> results\nin a call to ServletResponse.setLocale()\n\nThe servlet 2.3 spec states that a call to setContentType() or setLocale() can\nchange the character encoding of the resposne. Therefore when running on TC4 the\n<fmt:setBundle ...> in localebad.jsp ultimately results in a call to\nsetCharacterEncoding() which changes the encoding to Shift-JIS.\n\nThe servlet 2.4 spec states that once the character encoding has been set by a\ncall to setContentType() subsequent calls setLocale() must not change the\ncharacter encoding. Therefore when running on TC5 the <fmt:setBundle ...> in\nlocalebad.jsp has no effect on the character encoding since it has aleady be set\nas a result of the intial page directive.", "id": 80495, "time": "2005-09-27T00:11:09Z", "creator": "markt@apache.org", "creation_time": "2005-09-27T00:11:09Z", "attachment_id": null}]