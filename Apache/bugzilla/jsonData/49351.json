[{"count": 0, "tags": [], "bug_id": 49351, "is_private": false, "text": "The code in StandardEngine (around line 354) handles the situation when the standard engine is not set. But if you don't do it, the execution of Tomcat embedded fails with a NPE. The reason for this is a missing name for the StandardService.\n\nA workaround is to just add the StandardService to the server container with the following code:\n\n<code>\n    StandardService service = new StandardService();\n    service.setContainer( server.getContainer() );\n    service.setName(TC_HOST_CONTAINER_NAME);\n    service.initialize();\n</code>\n\nHowever, the name should be set in org.apache.catalina.core.StandardEngine:355 to the engine name.\n\nThe error exists in the trunk too.", "id": 137174, "time": "2010-05-27T06:39:35Z", "creator": "mgoldhahn@gmail.com", "creation_time": "2010-05-27T06:39:35Z", "attachment_id": null}, {"count": 1, "attachment_id": null, "creator": "markt@apache.org", "is_private": false, "id": 137925, "time": "2010-06-26T08:44:45Z", "bug_id": 49351, "creation_time": "2010-06-26T08:44:45Z", "tags": [], "text": "Trunk has been re-factored so that code doesn't exist any more.\n\nThe following patch should work for 6.0.x:\n\nIndex: java/org/apache/catalina/core/StandardEngine.java\n===================================================================\n--- java/org/apache/catalina/core/StandardEngine.java\t(revision 958198)\n+++ java/org/apache/catalina/core/StandardEngine.java\t(working copy)\n@@ -354,6 +354,8 @@\n                 service=new StandardService();\n                 service.setContainer( this );\n                 service.initialize();\n+                // Use same name for Service\n+                service.setName(getName());\n             } catch( Throwable t ) {\n                 log.error(t);\n             }"}, {"count": 2, "attachment_id": null, "creator": "markt@apache.org", "is_private": false, "id": 137975, "time": "2010-06-29T07:40:37Z", "bug_id": 49351, "creation_time": "2010-06-29T07:40:37Z", "tags": [], "text": "Fixed in 6.0.x and will be included in 6.0.28 onwards."}]