[{"count": 0, "tags": [], "text": "A ClassNotFoundException is thrown when instantiating a class defined via \"-\nclasspath\" and when using \"org.apache.catalina.startup.Bootstrap start\" \ndirectly from the command line (instead of running Tomcat via startup.bat).\n\nThe following example shows a reproducible case in which a class of the Struts \nframework fails to get instantiated. Exactly the same configuration works \nwithout any problems in Tomcat 4.1.27/29.\n\n1.) Command line I use to startup Tomcat 5.0.16:\n\nC:\\j2sdk1.4.1_02\\bin\\java.exe\n -Djava.endorsed.dirs=C:\\jakarta-tomcat-5.0.16\\bin;C:\\jakarta-tomcat-5.0.16\n\\common\\endorsed \n -Dcatalina.base=C:/work/projects/test_webapp\n -Dcatalina.home=C:\\jakarta-tomcat-5.0.16 \n -Djava.io.tmpdir=C:\\jakarta-tomcat-5.0.16\\temp\n -Djava.security.manager \n -Djava.security.policy=C:/work/projects/test_webapp/conf/catalina.policy \n -Djava.naming.security.credentials=password \n -classpath (...)\n org.apache.catalina.startup.Bootstrap start\n\n(Classpath includes all necessary jars including all of \"C:\\jakarta-tomcat-\n5.0.16\\common\\lib\" and \"C:\\jakarta-tomcat-5.0.16\\server\\lib\" plus the jars for \nStruts framework.)\n\n2.) JSP source that does not work then in Tomcat 5.0.16:\n\n<%@ page %>\n<%@ taglib uri=\"/WEB-INF/struts-html.tld\" prefix=\"html\" %>\n<html>\n<head>\n    <title>test</title>\n</head>\n<body>\n    <p><%= \"Hello, World!\" %></p>\n</body>\n</html>\n\n(If I comment the taglib line like this \"<%--<%@ taglib uri=\"/WEB-INF/struts-\nhtml.tld\" prefix=\"html\" %>--%>\" it works.)\n\n3.) Exception report when requesting above JSP is:\n\norg.apache.jasper.JasperException: Failed to load or instantiate TagExtraInfo \nclass: org.apache.struts.taglib.html.MessagesTei\n\torg.apache.jasper.compiler.DefaultErrorHandler.jspError\n(DefaultErrorHandler.java:94)\n\torg.apache.jasper.compiler.ErrorDispatcher.dispatch\n(ErrorDispatcher.java:404)\n\torg.apache.jasper.compiler.ErrorDispatcher.jspError\n(ErrorDispatcher.java:319)\n\torg.apache.jasper.compiler.TagLibraryInfoImpl.createTagInfo\n(TagLibraryInfoImpl.java:453)\n\torg.apache.jasper.compiler.TagLibraryInfoImpl.parseTLD\n(TagLibraryInfoImpl.java:290)\n\torg.apache.jasper.compiler.TagLibraryInfoImpl.\n(TagLibraryInfoImpl.java:204)\n\torg.apache.jasper.compiler.Parser.parseTaglibDirective(Parser.java:458)\n\torg.apache.jasper.compiler.Parser.parseDirective(Parser.java:523)\n\torg.apache.jasper.compiler.Parser.parseElements(Parser.java:1577)\n\torg.apache.jasper.compiler.Parser.parse(Parser.java:171)\n\torg.apache.jasper.compiler.ParserController.parse\n(ParserController.java:247)\n\torg.apache.jasper.compiler.ParserController.parse\n(ParserController.java:149)\n\torg.apache.jasper.compiler.ParserController.parse\n(ParserController.java:135)\n\torg.apache.jasper.compiler.Compiler.generateJava(Compiler.java:237)\n\torg.apache.jasper.compiler.Compiler.compile(Compiler.java:456)\n\torg.apache.jasper.compiler.Compiler.compile(Compiler.java:439)\n\torg.apache.jasper.JspCompilationContext.compile\n(JspCompilationContext.java:552)\n\torg.apache.jasper.servlet.JspServletWrapper.service\n(JspServletWrapper.java:291)\n\torg.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:301)\n\torg.apache.jasper.servlet.JspServlet.service(JspServlet.java:248)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:856)\n\tsun.reflect.GeneratedMethodAccessor33.invoke(Unknown Source)\n\tsun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:25)\n\tjava.lang.reflect.Method.invoke(Method.java:324)\n\torg.apache.catalina.security.SecurityUtil$1.run(SecurityUtil.java:284)\n\tjava.security.AccessController.doPrivileged(Native Method)\n\tjavax.security.auth.Subject.doAsPrivileged(Subject.java:499)\n\torg.apache.catalina.security.SecurityUtil.execute(SecurityUtil.java:306)\n\torg.apache.catalina.security.SecurityUtil.doAsPrivilege\n(SecurityUtil.java:200)\nroot cause \njava.lang.ClassNotFoundException: org.apache.struts.taglib.html.MessagesTei\n\torg.apache.catalina.loader.WebappClassLoader.loadClass\n(WebappClassLoader.java:1366)\n\torg.apache.catalina.loader.WebappClassLoader.loadClass\n(WebappClassLoader.java:1213)\n\torg.apache.jasper.compiler.TagLibraryInfoImpl.createTagInfo\n(TagLibraryInfoImpl.java:450)\n\torg.apache.jasper.compiler.TagLibraryInfoImpl.parseTLD\n(TagLibraryInfoImpl.java:290)\n\torg.apache.jasper.compiler.TagLibraryInfoImpl.\n(TagLibraryInfoImpl.java:204)\n\torg.apache.jasper.compiler.Parser.parseTaglibDirective(Parser.java:458)\n\torg.apache.jasper.compiler.Parser.parseDirective(Parser.java:523)\n\torg.apache.jasper.compiler.Parser.parseElements(Parser.java:1577)\n\torg.apache.jasper.compiler.Parser.parse(Parser.java:171)\n\torg.apache.jasper.compiler.ParserController.parse\n(ParserController.java:247)\n\torg.apache.jasper.compiler.ParserController.parse\n(ParserController.java:149)\n\torg.apache.jasper.compiler.ParserController.parse\n(ParserController.java:135)\n\torg.apache.jasper.compiler.Compiler.generateJava(Compiler.java:237)\n\torg.apache.jasper.compiler.Compiler.compile(Compiler.java:456)\n\torg.apache.jasper.compiler.Compiler.compile(Compiler.java:439)\n\torg.apache.jasper.JspCompilationContext.compile\n(JspCompilationContext.java:552)\n\torg.apache.jasper.servlet.JspServletWrapper.service\n(JspServletWrapper.java:291)\n\torg.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:301)\n\torg.apache.jasper.servlet.JspServlet.service(JspServlet.java:248)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:856)\n\tsun.reflect.GeneratedMethodAccessor33.invoke(Unknown Source)\n\tsun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:25)\n\tjava.lang.reflect.Method.invoke(Method.java:324)\n\torg.apache.catalina.security.SecurityUtil$1.run(SecurityUtil.java:284)\n\tjava.security.AccessController.doPrivileged(Native Method)\n\tjavax.security.auth.Subject.doAsPrivileged(Subject.java:499)\n\torg.apache.catalina.security.SecurityUtil.execute(SecurityUtil.java:306)\n\torg.apache.catalina.security.SecurityUtil.doAsPrivilege\n(SecurityUtil.java:200)", "is_private": false, "id": 50801, "creator": "ingo@sandbank.eu", "time": "2004-01-20T08:50:05Z", "bug_id": 26270, "creation_time": "2004-01-20T08:50:05Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 26270, "text": "We don't support custom packaging as bugs, sorry. If this doesn't work for you,\ntough luck, try repackaging Tomcat differently to see if it helps. Please don't\nreopen the report.", "id": 50808, "time": "2004-01-20T13:09:50Z", "creator": "remm@apache.org", "creation_time": "2004-01-20T13:09:50Z", "is_private": false, "attachment_id": null}]