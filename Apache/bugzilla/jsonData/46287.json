[{"count": 0, "tags": [], "bug_id": 46287, "attachment_id": null, "text": "When extracting the pure text with org.apache.poi.hssf.extractor.ExcelExtractor\nthe header and footer of sheets are unconditionally extracted.\n\nMost often those contain something like \"&page\", which isn't resolved.\n\nI'd prefer to not extract header & footer.\n\nIt would be ideal if there were a method setHeaderFooterExtraction() to\ninfluence the behaviour.\n\nThanks,\nAxel.", "id": 122816, "time": "2008-11-24T23:34:29Z", "creator": "axel.roeslein@googlemail.com", "creation_time": "2008-11-24T23:34:29Z", "is_private": false}, {"count": 1, "tags": [], "creator": "axel.roeslein@googlemail.com", "is_private": false, "text": "Patch suggestion:\n--- src/java/org/apache/poi/hssf/extractor/ExcelExtractor.java  (revision 722394)\n+++ src/java/org/apache/poi/hssf/extractor/ExcelExtractor.java  (working copy)\n@@ -46,6 +46,7 @@\n        private boolean formulasNotResults = false;\n        private boolean includeCellComments = false;\n        private boolean includeBlankCells = false;\n+       private boolean includeHeaderFooter = true;\n        \n        public ExcelExtractor(HSSFWorkbook wb) {\n                super(wb);\n@@ -79,6 +80,12 @@\n         this.includeCellComments = includeCellComments;\n     }\n        /**\n+     * Should header and footer be included? Default is true\n+     */\n+    public void setIncludeHeaderFooter(boolean includeHeaderFooter) {\n+        this.includeHeaderFooter = includeHeaderFooter;\n+    }\n+       /**\n         * Should blank cells be output? Default is to only\n         *  output cells that are present in the file and are\n         *  non-blank.\n@@ -111,7 +118,7 @@\n                        }\n                        \n                        // Header text, if there is any\n-                       if(sheet.getHeader() != null) {\n+                       if(sheet.getHeader() != null && includeHeaderFooter) {\n                                text.append(\n                                                _extractHeaderFooter(sheet.getHeader())\n                                );\n@@ -201,7 +208,7 @@\n                        }\n                        \n                        // Finally Feader text, if there is any\n-                       if(sheet.getFooter() != null) {\n+                       if(sheet.getFooter() != null && includeHeaderFooter) {\n                                text.append(\n                                                _extractHeaderFooter(sheet.getFooter())\n                                );\n", "id": 122981, "time": "2008-12-02T00:20:39Z", "bug_id": 46287, "creation_time": "2008-12-02T00:20:39Z", "attachment_id": null}, {"count": 2, "attachment_id": null, "bug_id": 46287, "is_private": false, "id": 127077, "time": "2009-05-17T11:49:42Z", "creator": "apache@gagravarr.org", "creation_time": "2009-05-17T11:49:42Z", "tags": [], "text": "Thanks. Applied with tweaks, and with the same thing for XSSFExcelExtractor too"}]