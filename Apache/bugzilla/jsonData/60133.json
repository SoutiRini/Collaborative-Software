[{"count": 0, "tags": [], "bug_id": 60133, "is_private": false, "text": "For backend listener rootmetricsprefix, we need to parameterize the value for it.  We have tried using system property and use ${__P(abc)}.   This works when running jmeter in single mode (master only), however, when running in distributed mode, even if we have confirmed system property (abc in this example) is set in the slave nodes, the backend listener sends nothing to the backend InfluxDB.\n\nThis needs to be fixed ASAP.", "id": 193714, "time": "2016-09-14T17:19:01Z", "creator": "jz5168@yahoo.com", "creation_time": "2016-09-14T17:19:01Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "attachment_id": null, "is_private": false, "id": 193719, "time": "2016-09-14T19:58:00Z", "bug_id": 60133, "creation_time": "2016-09-14T19:58:00Z", "text": "(In reply to jz5168 from comment #0)\n> For backend listener rootmetricsprefix, we need to parameterize the value\n> for it.  We have tried using system property and use ${__P(abc)}.   \n\n\nDid you use -G instead of -J to send property from Controller. Or -J if different per jmeter-server ?\n\nThis\n> works when running jmeter in single mode (master only), however, when\n> running in distributed mode, even if we have confirmed system property (abc\n> in this example) is set in the slave nodes, the backend listener sends\n> nothing to the backend InfluxDB.\n> \n> This needs to be fixed ASAP."}, {"count": 2, "tags": [], "creator": "jz5168@yahoo.com", "attachment_id": null, "is_private": false, "id": 193724, "time": "2016-09-14T20:47:00Z", "bug_id": 60133, "creation_time": "2016-09-14T20:47:00Z", "text": "For master, I use -J to specify system property and it works.  \n\nFor slave, I use Java system property directly using -D, see below:\n\nnohup ${JAVA_HOME}/bin/java -server -Xms512m -Xmx1024m -Dsun.rmi.dgc.client.gcInterval=600000 -Dsun.rmi.dgc.server.gcInterval=600000 -jar apache-jmeter-3.0/bin/ApacheJMeter.jar -Dserver_port=1099 -Dabc=somevalue ...\n\nThis technique works for other elements of test plan, but not backend listener rootmetricsprefix of slave nodes."}, {"count": 3, "tags": [], "creator": "jz5168@yahoo.com", "attachment_id": null, "id": 193725, "time": "2016-09-14T20:50:18Z", "bug_id": 60133, "creation_time": "2016-09-14T20:50:18Z", "is_private": false, "text": "The jmeter slave log file indicated the system property is set:\n\n...\nINFO  - jmeter.JMeter: Setting System property: abc=ABC\n..."}, {"count": 4, "tags": [], "text": "(In reply to jz5168 from comment #2)\n> For master, I use -J to specify system property and it works.  \n> \n> For slave, I use Java system property directly using -D, see below:\n> \n> nohup ${JAVA_HOME}/bin/java -server -Xms512m -Xmx1024m\n> -Dsun.rmi.dgc.client.gcInterval=600000\n> -Dsun.rmi.dgc.server.gcInterval=600000 -jar\n> apache-jmeter-3.0/bin/ApacheJMeter.jar -Dserver_port=1099 -Dabc=somevalue ...\n> \n> This technique works for other elements of test plan, but not backend\n> listener rootmetricsprefix of slave nodes.\n\nNo -D does not work with __P\n__P uses properties either set with -J (local) or -G(global). Global properties are usually sent from controller to servers.\n\nClosing bug as INVALID.\nPlease use mailing list for this.\nRegards", "attachment_id": null, "bug_id": 60133, "id": 193726, "time": "2016-09-14T20:55:56Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2016-09-14T20:55:56Z", "is_private": false}, {"count": 5, "tags": [], "creator": "jz5168@yahoo.com", "attachment_id": null, "is_private": false, "id": 193727, "time": "2016-09-14T20:58:18Z", "bug_id": 60133, "creation_time": "2016-09-14T20:58:18Z", "text": "Makes sense.  That's why -J is working for me.  Thanks."}, {"count": 6, "tags": [], "bug_id": 60133, "attachment_id": null, "id": 198497, "time": "2017-04-24T14:57:04Z", "creator": "antoine.lemieux@gmail.com", "creation_time": "2017-04-24T14:57:04Z", "is_private": false, "text": "Hi,\n\nI am using JMeter (Version 3.2 r1790748) and I suffer the same issue with the backendListener not substituting variables with the property define in the test plan.\n\nHow I run test:\n * 1x JMeter server instance (/jmeter/bin/jmeter-server -Dserver.rmi.localport=50000 -Dserver_port=1099)\n * 1x JMeter Client (/jmeter/bin/jmeter -n -t /test-plan/testplan.jmx -Rjmeter-server-0.jmeter-server:1099 -G/test-profile/sanity-check.properties)\n\nThe properties are sent over from the client to the server as per the following LOG entry:\n\nFrom Client log:\n  2017-04-24 12:37:14,537 INFO o.a.j.e.ClientJMeterEngine: Sending properties {us2.influxdb.host=10.21.xx.xx}\n\nFrom Server log\n  2017-04-24 12:37:14,540 INFO o.a.j.e.StandardJMeterEngine: Applying properties {us2.influxdb.host=10.21.xx.xx}\n\nEven if the properties are copied over and applied, the BackendListener is still trying to connect using the variable placeholder and not the given value\n\nCaused by: java.net.URISyntaxException: Illegal character in authority at index 7: http://${influxdb_host}:8086/\n        at java.net.URI$Parser.fail(URI.java:2848) ~[?:1.8.0_112]\n        at java.net.URI$Parser.parseAuthority(URI.java:3186) ~[?:1.8.0_112]\n        at java.net.URI$Parser.parseHierarchical(URI.java:3097) ~[?:1.8.0_112]\n        at java.net.URI$Parser.parse(URI.java:3053) ~[?:1.8.0_112]\n        at java.net.URI.<init>(URI.java:588) ~[?:1.8.0_112]\n        at okhttp3.HttpUrl.uri(HttpUrl.java:374) ~[JMeter-InfluxDB-Writer-plugin-1.1.jar:1.1]\n        at okhttp3.internal.connection.RouteSelector.resetNextProxy(RouteSelector.java:117) ~[JMeter-InfluxDB-Writer-plugin-1.1.jar:1.1]\n        at okhttp3.internal.connection.RouteSelector.<init>(RouteSelector.java:59) ~[JMeter-InfluxDB-Writer-plugin-1.1.jar:1.1]\n        at okhttp3.internal.connection.StreamAllocation.<init>(StreamAllocation.java:88) ~[JMeter-InfluxDB-Writer-plugin-1.1.jar:1.1]\n        at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept(RetryAndFollowUpInterceptor.java:111) ~[JMeter-InfluxDB-Writer-plugin-1.1.jar:1.1]\n        at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:92) ~[JMeter-InfluxDB-Writer-plugin-1.1.jar:1.1]\n        at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:67) ~[JMeter-InfluxDB-Writer-plugin-1.1.jar:1.1]\n        at okhttp3.logging.HttpLoggingInterceptor.intercept(HttpLoggingInterceptor.java:145) ~[JMeter-InfluxDB-Writer-plugin-1.1.jar:1.1]\n        at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:92) ~[JMeter-InfluxDB-Writer-plugin-1.1.jar:1.1]\n        at okhttp3.internal.http.RealInterceptorChain.proceed(RealInterceptorChain.java:67) ~[JMeter-InfluxDB-Writer-plugin-1.1.jar:1.1]\n        at okhttp3.RealCall.getResponseWithInterceptorChain(RealCall.java:170) ~[JMeter-InfluxDB-Writer-plugin-1.1.jar:1.1]\n        at okhttp3.RealCall.execute(RealCall.java:60) ~[JMeter-InfluxDB-Writer-plugin-1.1.jar:1.1]\n        at retrofit2.OkHttpCall.execute(OkHttpCall.java:174) ~[JMeter-InfluxDB-Writer-plugin-1.1.jar:1.1]\n        at org.influxdb.impl.InfluxDBImpl.execute(InfluxDBImpl.java:261) ~[JMeter-InfluxDB-Writer-plugin-1.1.jar:1.1]\n        at org.influxdb.impl.InfluxDBImpl.describeDatabases(InfluxDBImpl.java:246) ~[JMeter-InfluxDB-Writer-plugin-1.1.jar:1.1]\n        at rocks.nt.apm.jmeter.JMeterInfluxDBBackendListenerClient.createDatabaseIfNotExistent(JMeterInfluxDBBackendListenerClient.java:222) ~[JMeter-InfluxDB-Writer-plugin-1.1.jar:1.1]\n        at rocks.nt.apm.jmeter.JMeterInfluxDBBackendListenerClient.setupInfluxClient(JMeterInfluxDBBackendListenerClient.java:181) ~[JMeter-InfluxDB-Writer-plugin-1.1.jar:1.1]\n        at rocks.nt.apm.jmeter.JMeterInfluxDBBackendListenerClient.setupTest(JMeterInfluxDBBackendListenerClient.java:122) ~[JMeter-InfluxDB-Writer-plugin-1.1.jar:1.1]\n        at org.apache.jmeter.visualizers.backend.BackendListener.testStarted(BackendListener.java:349) ~[ApacheJMeter_components.jar:3.2 r1790748]\n        at org.apache.jmeter.samplers.RemoteSampleListenerImpl.testStarted(RemoteSampleListenerImpl.java:66) ~[ApacheJMeter_core.jar:3.2 r1790748]\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_112]\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_112]\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_112]\n        at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_112]\n        at sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:324) ~[?:1.8.0_112]\n        at sun.rmi.transport.Transport$1.run(Transport.java:200) ~[?:1.8.0_112]\n        at sun.rmi.transport.Transport$1.run(Transport.java:197) ~[?:1.8.0_112]\n        at java.security.AccessController.doPrivileged(Native Method) ~[?:1.8.0_112]\n        at sun.rmi.transport.Transport.serviceCall(Transport.java:196) ~[?:1.8.0_112]\n        at sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:568) ~[?:1.8.0_112]\n        at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:826) ~[?:1.8.0_112]\n        at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:683) ~[?:1.8.0_112]\n        at java.security.AccessController.doPrivileged(Native Method) ~[?:1.8.0_112]\n        at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:682) ~[?:1.8.0_112]\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[?:1.8.0_112]\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[?:1.8.0_112]\n\n\nAny idea why variables are not substitute properly when running in distributed mode only?\n\n\nThanks\n/Antoine"}, {"count": 7, "tags": [], "bug_id": 60133, "attachment_id": null, "text": "The backend listener work on the server side ( not on node side ) and variable are only replace on JMeter node - which execute the test plan\n\nI have a patch to fix this (only with user defined variables) but it's for next release of JMeter.", "id": 198499, "time": "2017-04-24T17:57:10Z", "creator": "mchassagneux@apache.org", "creation_time": "2017-04-24T17:57:10Z", "is_private": false}, {"count": 8, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "attachment_id": null, "id": 198550, "time": "2017-04-26T19:06:30Z", "bug_id": 60133, "creation_time": "2017-04-26T19:06:30Z", "is_private": false, "text": "\n\n*** This bug has been marked as a duplicate of bug 57962 ***"}]