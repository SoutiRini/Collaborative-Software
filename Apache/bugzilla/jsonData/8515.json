[{"count": 0, "tags": [], "creator": "shawn.laubach@b1b.tinker.af.mil", "attachment_id": null, "text": "These are a set of additions to add and modify the page headers, footers, \nwhether gridlines are printed, and the print setup which includes landscape \nmode, margins, and such.\n\nIndex: src/java/org/apache/poi/hssf/usermodel/HSSFSheet.java\n===================================================================\nRCS file: /home/cvspublic/jakarta-\npoi/src/java/org/apache/poi/hssf/usermodel/HSSFSheet.java,v\nretrieving revision 1.4\ndiff -u -r1.4 HSSFSheet.java\n--- src/java/org/apache/poi/hssf/usermodel/HSSFSheet.java\t14 Mar 2002 \n11:05:04 -0000\t1.4\n+++ src/java/org/apache/poi/hssf/usermodel/HSSFSheet.java\t25 Apr 2002 \n13:30:34 -0000\n@@ -756,4 +756,84 @@\n         return (( WSBoolRecord ) sheet.findFirstRecordBySid(WSBoolRecord.sid))\n             .getRowSumsRight();\n     }\n+\n+    /**\n+     * Returns whether gridlines are printed.\n+     * @return Gridlines are printed\n+     */\n+    public boolean getPrintGridlines() {\n+        Iterator i = getSheet().getRecords().iterator();\n+        while (i.hasNext()) {\n+            Record r = (Record)i.next();\n+            if (r.getSid() == PrintGridlinesRecord.sid) {\n+                PrintGridlinesRecord pgr = (PrintGridlinesRecord)r;\n+                return pgr.getPrintGridlines();\n+            }\n+        }\n+        return false;\n+    }\n+\n+    /**\n+     * Turns on or off the printing of gridlines.\n+     * @param newPrintGridlines boolean to turn on or off the printing of\n+     * gridlines\n+     */\n+    public void setPrintGridlines(boolean newPrintGridlines) {\n+        Iterator i = getSheet().getRecords().iterator();\n+        while (i.hasNext()) {\n+            Record r = (Record)i.next();\n+            if (r.getSid() == PrintGridlinesRecord.sid) {\n+                PrintGridlinesRecord pgr = (PrintGridlinesRecord)r;\n+                pgr.setPrintGridlines(newPrintGridlines);\n+            }\n+        }\n+    }\n+\n+    /**\n+     * Gets the print setup object.\n+     * @return The user model for the print setup object.\n+     */\n+    public HSSFPrintSetup getPrintSetup() {\n+        Iterator i = getSheet().getRecords().iterator();\n+        while (i.hasNext()) {\n+            Record r = (Record)i.next();\n+            if (r.getSid() == PrintSetupRecord.sid) {\n+                PrintSetupRecord psr = (PrintSetupRecord)r;\n+                return new HSSFPrintSetup(psr);\n+            }\n+        }\n+        return null;\n+    }\n+\n+    /**\n+     * Gets the user model for the document header.\n+     * @return The Document header.\n+     */\n+    public HSSFHeader getHeader() {\n+        Iterator i = getSheet().getRecords().iterator();\n+        while (i.hasNext()) {\n+            Record r = (Record)i.next();\n+            if (r.getSid() == HeaderRecord.sid) {\n+                HeaderRecord hr = (HeaderRecord)r;\n+                return new HSSFHeader(hr);\n+            }\n+        }\n+        return null;\n+    }\n+\n+    /**\n+     * Gets the user model for the document footer.\n+     * @return The Document footer.\n+     */\n+    public HSSFFooter getFooter() {\n+        Iterator i = getSheet().getRecords().iterator();\n+        while (i.hasNext()) {\n+            Record r = (Record)i.next();\n+            if (r.getSid() == FooterRecord.sid) {\n+                FooterRecord hr = (FooterRecord)r;\n+                return new HSSFFooter(hr);\n+            }\n+        }\n+        return null;\n+    }\n }", "id": 14725, "time": "2002-04-25T14:14:50Z", "bug_id": 8515, "creation_time": "2002-04-25T14:14:50Z", "is_private": false}, {"count": 1, "tags": [], "text": "Created attachment 1694\nUser model to the header record", "attachment_id": 1694, "id": 14726, "creator": "shawn.laubach@b1b.tinker.af.mil", "time": "2002-04-25T14:17:14Z", "bug_id": 8515, "creation_time": "2002-04-25T14:17:14Z", "is_private": false}, {"count": 2, "text": "Created attachment 1695\nUser model to the footer record", "creator": "shawn.laubach@b1b.tinker.af.mil", "is_private": false, "id": 14727, "time": "2002-04-25T14:17:37Z", "bug_id": 8515, "creation_time": "2002-04-25T14:17:37Z", "tags": [], "attachment_id": 1695}, {"count": 3, "text": "Created attachment 1696\nUser model to the print setup record", "creator": "shawn.laubach@b1b.tinker.af.mil", "is_private": false, "id": 14728, "time": "2002-04-25T14:17:58Z", "bug_id": 8515, "creation_time": "2002-04-25T14:17:58Z", "tags": [], "attachment_id": 1696}, {"count": 4, "text": "This is great stuff.  I'll put it in my to-do queue if Glen doesn't beat me to\nit.   Any chance we can get a unit test for this?  (I know it seems like we're\nfanatics but so far we've found that those things that don't get unit tested get\nbroken as the software gets patched....and no one tends to notice until much\nlater).  It should be fairly simple to figure out how to do one by going too\nsrc/testcases/org/apache/poi/hssf/..... and looking at a TestXXXX class.  Just\ncopy it and do the same for these features.  If you don't, I will eventually,\nbut I think there is a consensus among HSSF committers that no new\nun-unit-tested code should make it into a production release.  (nothing\nofficial...just I think we agree ;-) )", "creator": "poi-support@buni.org", "is_private": false, "id": 14729, "time": "2002-04-25T14:21:26Z", "bug_id": 8515, "creation_time": "2002-04-25T14:21:26Z", "tags": [], "attachment_id": null}, {"count": 5, "tags": [], "text": "Created attachment 1701\nTest File for Gridlines", "attachment_id": 1701, "id": 14758, "creator": "shawn.laubach@b1b.tinker.af.mil", "time": "2002-04-25T17:15:17Z", "bug_id": 8515, "creation_time": "2002-04-25T17:15:17Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 8515, "attachment_id": 1702, "is_private": false, "id": 14760, "time": "2002-04-25T17:15:48Z", "creator": "shawn.laubach@b1b.tinker.af.mil", "creation_time": "2002-04-25T17:15:48Z", "text": "Created attachment 1702\nTest File for Headers/Footers and PrintSetup"}, {"count": 7, "tags": [], "bug_id": 8515, "attachment_id": 1703, "is_private": false, "id": 14761, "time": "2002-04-25T17:16:32Z", "creator": "shawn.laubach@b1b.tinker.af.mil", "creation_time": "2002-04-25T17:16:32Z", "text": "Created attachment 1703\nBut in previous HSSFPrintSetup.  This fixes it."}, {"count": 8, "tags": [], "text": "will apply shortly.", "attachment_id": null, "id": 15064, "creator": "poi-support@buni.org", "time": "2002-04-29T18:00:11Z", "bug_id": 8515, "creation_time": "2002-04-29T18:00:11Z", "is_private": false}, {"count": 9, "tags": [], "creator": "poi-support@buni.org", "attachment_id": null, "text": "*** Bug 7864 has been marked as a duplicate of this bug. ***", "id": 15066, "time": "2002-04-29T18:01:35Z", "bug_id": 8515, "creation_time": "2002-04-29T18:01:35Z", "is_private": false}, {"count": 10, "tags": [], "bug_id": 8515, "attachment_id": null, "id": 15091, "time": "2002-04-30T04:21:07Z", "creator": "poi-support@buni.org", "creation_time": "2002-04-30T04:21:07Z", "is_private": false, "text": "after puting this in I get this:\n\nCreated dir: D:\\andy\\homestuff\\jakarta-poi\\build\\testcases\nCompiling 87 source files to D:\\andy\\homestuff\\jakarta-poi\\build\\testcases\nD:\\andy\\homestuff\\jakarta-poi\\src\\testcases\\org\\apache\\poi\\hssf\\usermodel\\TestGr\nidlines.java:103: cannot resolve symbol\nsymbol  : method setPrintGridlines  (boolean)\nlocation: class org.apache.poi.hssf.usermodel.HSSFSheet\n        s.setPrintGridlines(true);\n         ^\nD:\\andy\\homestuff\\jakarta-poi\\src\\testcases\\org\\apache\\poi\\hssf\\usermodel\\TestHe\nadersFootersPrintSetup.java:121: cannot resolve symbol\nsymbol  : method getHeader  ()\nlocation: class org.apache.poi.hssf.usermodel.HSSFSheet\n        h = s.getHeader();\n             ^\nD:\\andy\\homestuff\\jakarta-poi\\src\\testcases\\org\\apache\\poi\\hssf\\usermodel\\TestHe\nadersFootersPrintSetup.java:126: cannot resolve symbol\nsymbol  : method getFooter  ()\nlocation: class org.apache.poi.hssf.usermodel.HSSFSheet\n        f = s.getFooter();\n             ^\nD:\\andy\\homestuff\\jakarta-poi\\src\\testcases\\org\\apache\\poi\\hssf\\usermodel\\TestHe\nadersFootersPrintSetup.java:162: cannot resolve symbol\nsymbol  : method getPrintSetup  ()\nlocation: class org.apache.poi.hssf.usermodel.HSSFSheet\n        ps = s.getPrintSetup();\n              ^\nD:\\andy\\homestuff\\jakarta-poi\\src\\testcases\\org\\apache\\poi\\hssf\\usermodel\\TestHe\nadersFootersPrintSetup.java:218: cannot resolve symbol\nsymbol  : method getPrintSetup  ()\nlocation: class org.apache.poi.hssf.usermodel.HSSFSheet\n        ps = s.getPrintSetup();\n              ^\nD:\\andy\\homestuff\\jakarta-poi\\src\\testcases\\org\\apache\\poi\\hssf\\usermodel\\TestHe\nadersFootersPrintSetup.java:240: cannot resolve symbol\nsymbol  : method getFooter  ()\nlocation: class org.apache.poi.hssf.usermodel.HSSFSheet\n        f = s.getFooter();\n             ^\n6 errors\n\nBUILD FAILED\nD:\\andy\\homestuff\\jakarta-poi\\tools\\cents\\junit.cent\\xbuild.xml:27: Compile fail\ned; see the compiler error output for details.\n\n\nForget a file?  Submit patch with \"cvs diff -u\" for HSSFSheet.  Thanks -Andy"}, {"count": 11, "text": "The patch is part of the original bug comments.  I can attach it as a file if \nneeded.", "creator": "shawn.laubach@b1b.tinker.af.mil", "is_private": false, "id": 15121, "time": "2002-04-30T13:42:40Z", "bug_id": 8515, "creation_time": "2002-04-30T13:42:40Z", "tags": [], "attachment_id": null}, {"count": 12, "text": "Sorry I'd overlooked that patch in that description.  Okay I can't commit this\nas is.  Here is the deal, shoving that looping code into HSSFSheet would\ndrastically affect performance.  The approach I would suggest is putting the\ncode for dealing with the record in org.apache.poi.hssf.model.Sheet and have\nHSSFSheet access it from there.  Furthermore, have the Sheet contain some\nreference variables that are loaded when the sheet is loaded or when a footer or\nheader is created.  There are more than one example (I think) on how to do this\nin that file.  If you cna provide a patch that follows that convention versus\nlooping through the records in the usermodel I'll apply it.  thanks, -Andy", "creator": "poi-support@buni.org", "is_private": false, "id": 15141, "time": "2002-04-30T15:24:54Z", "bug_id": 8515, "creation_time": "2002-04-30T15:24:54Z", "tags": [], "attachment_id": null}, {"count": 13, "tags": [], "bug_id": 8515, "attachment_id": null, "id": 15187, "time": "2002-04-30T19:22:18Z", "creator": "poi-support@buni.org", "creation_time": "2002-04-30T19:22:18Z", "is_private": false, "text": "if you do a \"cvs update\" -- the problem should take care of itself.  Merge and\nconflicts and send the patch.  Should happen mostly automatically as this code\nisn't in any rapidly changing code."}, {"attachment_id": 1746, "tags": [], "bug_id": 8515, "is_private": false, "count": 14, "id": 15191, "time": "2002-04-30T20:03:07Z", "creator": "shawn.laubach@b1b.tinker.af.mil", "creation_time": "2002-04-30T20:03:07Z", "text": "Created attachment 1746\nUpdated HSSFSheet to not loop"}, {"count": 15, "tags": [], "text": "I've added a new patch that updates Sheet and HSSFSheet to not do looping to \ngrab the needed records.  Did run into a problem with indention changing in my \neditor so that there are more diffs than necessary.  I checked however and \nthere was nothing that did more that change the spacing.", "is_private": false, "id": 15192, "creator": "shawn.laubach@b1b.tinker.af.mil", "time": "2002-04-30T20:04:35Z", "bug_id": 8515, "creation_time": "2002-04-30T20:04:35Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 8515, "is_private": false, "count": 16, "id": 15204, "time": "2002-04-30T22:33:04Z", "creator": "poi-support@buni.org", "creation_time": "2002-04-30T22:33:04Z", "text": "yum that patch looks much better."}, {"count": 17, "tags": [], "bug_id": 8515, "attachment_id": null, "id": 15213, "time": "2002-05-01T03:37:40Z", "creator": "poi-support@buni.org", "creation_time": "2002-05-01T03:37:40Z", "is_private": false, "text": "After applying this TestHSSFSheet went into an infinite loop.  Can you run\n./build.sh clean compile test and see if you get the same?"}, {"count": 18, "tags": [], "creator": "shawn.laubach@b1b.tinker.af.mil", "attachment_id": null, "text": "I'll check it out.", "id": 15243, "time": "2002-05-01T15:06:15Z", "bug_id": 8515, "creation_time": "2002-05-01T15:06:15Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 8515, "is_private": false, "count": 19, "id": 15245, "time": "2002-05-01T15:20:46Z", "creator": "shawn.laubach@b1b.tinker.af.mil", "creation_time": "2002-05-01T15:20:46Z", "text": "When I run it, it gives me no errors and everything runs fine.  Could it be \nbecause of the diff having more differences than are required?  How do you \nindent the code?  Could I try the same thing and see what I get for the diffs \nthen?"}, {"count": 20, "tags": [], "bug_id": 8515, "attachment_id": null, "id": 15247, "time": "2002-05-01T15:48:35Z", "creator": "poi-support@buni.org", "creation_time": "2002-05-01T15:48:35Z", "is_private": false, "text": "indent the code?  Tell you what.  Lets try this one more time.  Attach a zip\nfile with all of you current .java files, including the directory relative to\njakarta-poi module (so src/java/org/apache/poi/hssf/usermodel/HSSFFooter).  Then\nmake sure your up to date.  attach a patch of the deltas.  \n\nLastly try checking out clean and applying your own patch.  run the clean\ncompile tests targets in order.  I swear even if I have to retype this we'll get\nthis in!  ;-).\n\n(I tried it pre-patch, then with patch and well with patch it hung on the unit\ntests)"}, {"count": 21, "tags": [], "bug_id": 8515, "attachment_id": 1757, "id": 15300, "time": "2002-05-02T02:57:53Z", "creator": "shawn.laubach@b1b.tinker.af.mil", "creation_time": "2002-05-02T02:57:53Z", "is_private": false, "text": "Created attachment 1757\nUpdated Patch"}, {"count": 22, "tags": [], "creator": "shawn.laubach@b1b.tinker.af.mil", "attachment_id": null, "text": "I've added the most resent patch that I based on the most recent code.  I just \ncopied the lines I added over and tested with everything.  The original files \nattached are OK but the patch only tries to change the necessary lines.  I've \ncompiled and ran all the tests and they all passed OK.  I hope this works this \ntime.", "id": 15301, "time": "2002-05-02T03:00:06Z", "bug_id": 8515, "creation_time": "2002-05-02T03:00:06Z", "is_private": false}, {"count": 23, "tags": [], "creator": "shawn.laubach@b1b.tinker.af.mil", "attachment_id": null, "id": 15378, "creation_time": "2002-05-03T02:51:41Z", "time": "2002-05-03T02:51:41Z", "bug_id": 8515, "text": "I created a new patch.  I then did a new checkout and downloaded the files from \nthe bug report.  Next, I applied the patch, compiled the code and ran the \ntests.  Everything worked just fine.", "is_private": false}, {"count": 24, "tags": [], "text": "applied....unit tests passed...please cross check... thanks for the patience -Andy", "attachment_id": null, "id": 15382, "creator": "poi-support@buni.org", "time": "2002-05-03T04:59:15Z", "bug_id": 8515, "creation_time": "2002-05-03T04:59:15Z", "is_private": false}, {"count": 25, "tags": [], "creator": "shawn.laubach@b1b.tinker.af.mil", "attachment_id": null, "id": 20314, "creation_time": "2002-07-27T18:32:58Z", "time": "2002-07-27T18:32:58Z", "bug_id": 8515, "text": "Verified.", "is_private": false}]