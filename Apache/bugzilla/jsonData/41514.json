[{"count": 0, "tags": [], "creator": "fop-dev@cumiskey.com", "attachment_id": null, "text": "Configuration checking for fonts and base urls is now much stricter\ngiven <strict-validation>true</strict-validation> (this is the default value)\nin the user config\n\nThis should address the following bugs :-\n\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=40120\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=40288\n\nPatch file and zip file containing new files will be attached.", "id": 98866, "time": "2007-02-01T07:31:25Z", "bug_id": 41514, "creation_time": "2007-02-01T07:31:25Z", "is_private": false}, {"count": 1, "tags": [], "creator": "fop-dev@cumiskey.com", "attachment_id": 19492, "text": "Created attachment 19492\nmain patch file", "id": 98867, "time": "2007-02-01T07:32:15Z", "bug_id": 41514, "creation_time": "2007-02-01T07:32:15Z", "is_private": false}, {"count": 2, "tags": [], "creator": "fop-dev@cumiskey.com", "attachment_id": 19493, "text": "Created attachment 19493\nnew package (and files) under test/src/org.apache.fop.config", "id": 98868, "time": "2007-02-01T07:34:58Z", "bug_id": 41514, "creation_time": "2007-02-01T07:34:58Z", "is_private": false}, {"count": 3, "tags": [], "creator": "spepping@apache.org", "attachment_id": null, "text": "The patch is fairly large and seems to address more than only validation of the\nconfiguration file. Can you give a summary?\n\nI am against this exception being thrown if I do not use the font arial at all:\n\n[ERROR] FOP - Exception\n<org.apache.avalon.framework.configuration.ConfigurationException: Failed to\nresolve font metric-url\n'arial.xml'>org.apache.avalon.framework.configuration.ConfigurationException:\nFailed to resolve font metric-url 'arial.xml'\n\nI am also against combining strict validation of the FO file and the user\nconfiguration; they are two different things. I would appreciate a separate\noption 'validate-configuration', which checks every entry in the configuration file.\n", "id": 98878, "time": "2007-02-01T12:13:54Z", "bug_id": 41514, "creation_time": "2007-02-01T12:13:54Z", "is_private": false}, {"count": 4, "text": "Comment on attachment 19492\nmain patch file\n\nThis patch attachment has been superceeded", "bug_id": 41514, "is_private": false, "id": 98899, "time": "2007-02-02T03:53:07Z", "creator": "fop-dev@cumiskey.com", "creation_time": "2007-02-02T03:53:07Z", "tags": [], "attachment_id": 19492}, {"count": 5, "tags": [], "bug_id": 41514, "attachment_id": 19497, "is_private": false, "id": 98900, "time": "2007-02-02T03:55:48Z", "creator": "fop-dev@cumiskey.com", "creation_time": "2007-02-02T03:55:48Z", "text": "Created attachment 19497\nmain patch file\n\n(In reply to comment #3)\n> The patch is fairly large and seems to address more than only validation of\nthe\n> configuration file. Can you give a summary?\n\nThe patch seems quite large because I have added a new suite of configuration\nunit tests for the fix (these are contained in the attached zip file).\tA\nsummary of the changes is given below.\n \n> I am against this exception being thrown if I do not use the font arial at\nall:\n> \n> [ERROR] FOP - Exception\n> <org.apache.avalon.framework.configuration.ConfigurationException: Failed to\n> resolve font metric-url\n> 'arial.xml'>org.apache.avalon.framework.configuration.ConfigurationException:\n\n> Failed to resolve font metric-url 'arial.xml'\n\nIn order for this to be the case, the user configuration would have to be\n(re-)read/parsed at the runtime of the rendering operation in order that it\nwould be able to know if a particular font is being used in the given FO file. \nThis would be an inefficient way of doing things and would require some\nstructural changes.\n \n> I am also against combining strict validation of the FO file and the user\n> configuration; they are two different things. I would appreciate a separate\n> option 'validate-configuration', which checks every entry in the\nconfiguration file.\n>\n\nI did raise this as a question on forum and I remember you responded to it.\n\nhttp://www.nabble.com/Bad-FOP-configurations-tf3064300.html#a8522251\n\nChris Bowditch suggested that it be combined with \"strict-validation\".\tI can\nsee your argument for this and this was my original idea but I can also see\nChris' argument too.  On balance I have decided to go with your suggestion and\nmake it separate a separate configuration option so as to not cause any\nconfusion.\n\nI have introduced a new configuration variable called \"strict-configuration\". \nI haven't called it \"validate-configuration\" because validation should always\noccur, its how the resulting error is handled that is the important thing (see\nAndreas' comments from the thread).\n\nIf \"strict-configuration\" == \"false\" then FOP will simply log the error and\ncontinue to parse the user configuration.  If \"strict-configuration\" == \"true\"\nthen FOP will immediately raise an exception and will not continue trying to\nconfigure itself.\n\nI have attached a new patch file containing these changes (this includes\nrelated documentation changes).  This new patch file superceeds the previous\none.\n\nKind regards,\n\nAdrian Cumiskey."}, {"count": 6, "tags": [], "creator": "fop-dev@cumiskey.com", "attachment_id": 19498, "is_private": false, "id": 98901, "time": "2007-02-02T04:03:03Z", "bug_id": 41514, "creation_time": "2007-02-02T04:03:03Z", "text": "Created attachment 19498\nmain patch file\n\nIncludes relevant changes to site (xdocs) documentation."}, {"count": 7, "tags": [], "creator": "fop-dev@cumiskey.com", "attachment_id": 19514, "text": "Created attachment 19514\npatch file update for fop config validating xsd file", "id": 98966, "time": "2007-02-05T03:57:19Z", "bug_id": 41514, "creation_time": "2007-02-05T03:57:19Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 41514, "attachment_id": 19539, "is_private": false, "id": 99063, "time": "2007-02-07T08:01:50Z", "creator": "fop-dev@cumiskey.com", "creation_time": "2007-02-07T08:01:50Z", "text": "Created attachment 19539\nmain patch file"}, {"count": 9, "tags": [], "creator": "fop-dev@cumiskey.com", "attachment_id": 19540, "text": "Created attachment 19540\nmain patch file\n\nI have updated the main patch file following feedback from Vincent.", "id": 99064, "time": "2007-02-07T08:11:44Z", "bug_id": 41514, "creation_time": "2007-02-07T08:11:44Z", "is_private": false}, {"count": 10, "tags": [], "creator": "spepping@apache.org", "attachment_id": null, "text": "I had a short look at the patch, and I have the following comments:\n\nDo not change the 0.93 documentation but the trunk documentation:\nsrc/documentation/content/xdocs/trunk/configuration.xml, etc.\n\nTargetResolution is a property of FOUserAgent because it may easily vary with\neach run. It is not a good idea if you move properties around. They are in\nFopFactory or in FOUserAgent for a reason. See\nhttp://xmlgraphics.apache.org/fop/trunk/embedding.html.\n\nAlthough I did not (and will not) have enough time to look at the patch in\ndetail, I have the feeling that it addresses more than user configuration\nvalidation. It does some refactoring. That requires careful inspection.\n", "id": 99069, "time": "2007-02-07T11:40:48Z", "bug_id": 41514, "creation_time": "2007-02-07T11:40:48Z", "is_private": false}, {"count": 11, "text": "(In reply to comment #10)\n> I had a short look at the patch, and I have the following comments:\n> \n> Do not change the 0.93 documentation but the trunk documentation:\n> src/documentation/content/xdocs/trunk/configuration.xml, etc.\n\nOops, yes I missed that.  I will update the patch file to make changes to the\ntrunk xdocs and not 0.93.\n \n> TargetResolution is a property of FOUserAgent because it may easily vary with\n> each run. It is not a good idea if you move properties around. They are in\n> FopFactory or in FOUserAgent for a reason. See\n> http://xmlgraphics.apache.org/fop/trunk/embedding.html.\n\nThere is no real change here.  TargetResolution is still a property of\nFOUserAgent, it is just configured from FopFactory and propagated to the\nFOUserAgent.  As before, the value of this property in FOUserAgent can be\nprogrammatically set at anytime during rendering.\n\n> Although I did not (and will not) have enough time to look at the patch in\n> detail, I have the feeling that it addresses more than user configuration\n> validation. It does some refactoring. That requires careful inspection.\n\nIt may look like quite a large patch, but there really isn't very much\nrefactoring, just stricter value checking which addresses issues raised in bugs\n40288 and 40120.", "bug_id": 41514, "is_private": false, "id": 99096, "time": "2007-02-08T02:28:18Z", "creator": "fop-dev@cumiskey.com", "creation_time": "2007-02-08T02:28:18Z", "tags": [], "attachment_id": null}, {"count": 12, "tags": [], "bug_id": 41514, "attachment_id": 19545, "is_private": false, "id": 99097, "time": "2007-02-08T02:42:42Z", "creator": "fop-dev@cumiskey.com", "creation_time": "2007-02-08T02:42:42Z", "text": "Created attachment 19545\nmain patch file\n\nWho ever commits this patch will need to remember to update fop/status.xml with\nsomething resembling the following (remember to fill in the dev attribute in\nthe action tag).\n\nIndex: status.xml\n===================================================================\n--- status.xml\t(revision 504579)\n+++ status.xml\t(working copy)\n@@ -28,6 +28,9 @@\n \n   <changes>\n     <release version=\"FOP Trunk\">\n+      <action context=\"Code\" dev=\"??\" type=\"fix\" fixes-bug=\"40120,40288\"\ndue-to=\"Adrian Cumiskey\">\n+\t Strict FOP user configuration checking.\n+      </action>\n       <action context=\"Code\" dev=\"JM\" type=\"add\">\n\t Support for GIF images in RTF output (RTF handler, only. Does not\naffect the RTF library.)\n       </action>"}, {"count": 13, "tags": [], "bug_id": 41514, "text": "(In reply to comment #12)\n> Created an attachment (id=19545) [edit]\n> main patch file\n\nI have another comment: this would be better to put the test config files in a\nsubdirectory of test/ --typically, test/conf.\nAlso, the tests fail with a SAXParseException: \"The processing instruction\ntarget matching \"[xX][mM][lL]\" is not allowed\". Can aynyone else try and tell me\nif the problem also occurs?\n\nFinally, I got a small error applying your patch. I could recover easily, but\nnext time be sure to create it from scratch and against the latest svn revision.\n\nThanks,\nVincent", "id": 99105, "time": "2007-02-08T07:02:42Z", "creator": "vhennebert@gmail.com", "creation_time": "2007-02-08T07:02:42Z", "is_private": false, "attachment_id": null}, {"count": 14, "tags": [], "bug_id": 41514, "is_private": false, "text": "(In reply to comment #13)\n> (In reply to comment #12)\n> > Created an attachment (id=19545) [edit] [edit]\n> > main patch file\n> \n> I have another comment: this would be better to put the test config files in a\n> subdirectory of test/ --typically, test/conf.\n\nThe reason I didn't do this is because of concerns raised about this patch\ncontaining too much refactoring.  But I am in agreement that it makes sense for\nthe config files to live separately.  So if nobody objects I will provide them\nin a separate zip attachment and move/remove the existing test/test.xconf to\ntest/config/test.xconfig.\n\n> Also, the tests fail with a SAXParseException: \"The processing instruction\n> target matching \"[xX][mM][lL]\" is not allowed\". Can aynyone else try and tell me\n> if the problem also occurs?\n\nDo you have the stack trace for this?\n\n> Finally, I got a small error applying your patch. I could recover easily, but\n> next time be sure to create it from scratch and against the latest svn revision.\n> \n> Thanks,\n> Vincent\n\nSorry about this, I will try to be mindful of this in the future.  Ideally I\nwould do this everytime, but there have been a number of revisions to this patch\nand preparing a new patch from scratch every half day is not a good use of time.\n Its not always practically quick and easy to do as I am in parallel cracking on\nwith other FOP development work.\n\nregards,\n\nAdrian.", "id": 99106, "time": "2007-02-08T07:20:24Z", "creator": "fop-dev@cumiskey.com", "creation_time": "2007-02-08T07:20:24Z", "attachment_id": null}, {"count": 15, "tags": [], "creator": "vhennebert@gmail.com", "attachment_id": null, "text": "(In reply to comment #14)\n> (In reply to comment #13)\n> > (In reply to comment #12)\n> > > Created an attachment (id=19545) [edit] [edit] [edit]\n> > > main patch file\n> > \n> > I have another comment: this would be better to put the test config files in a\n> > subdirectory of test/ --typically, test/conf.\n> \n> The reason I didn't do this is because of concerns raised about this patch\n> containing too much refactoring.  But I am in agreement that it makes sense for\n> the config files to live separately.  So if nobody objects I will provide them\n> in a separate zip attachment and move/remove the existing test/test.xconf to\n> test/config/test.xconfig.\n\nWell, the existing test.xconf might be used for other purposes. AFAIU its\npurpose its not to test that the handling of user config files is correct, but\nonly to configure other tests. So I would leave it as is and put in the conf/\nsubdirectory only files meant as tests for the config handling code.\n\n\n> > Also, the tests fail with a SAXParseException: \"The processing instruction\n> > target matching \"[xX][mM][lL]\" is not allowed\". Can aynyone else try and tell me\n> > if the problem also occurs?\n> \n> Do you have the stack trace for this?\n\nOf course, sorry, here it is:\n at\norg.apache.fop.config.BaseUserConfigTestCase.testUserConfig(BaseUserConfigTestCase.java:6\n8)\nSame error message for all of the testcases. It's a bit weird, I'm not even sure\nto understand it.\n\n\n> > Finally, I got a small error applying your patch. I could recover easily, but\n> > next time be sure to create it from scratch and against the latest svn revision.\n> > \n> > Thanks,\n> > Vincent\n> \n> Sorry about this, I will try to be mindful of this in the future.  Ideally I\n> would do this everytime, but there have been a number of revisions to this patch\n> and preparing a new patch from scratch every half day is not a good use of time.\n>  Its not always practically quick and easy to do as I am in parallel cracking on\n> with other FOP development work.\n\nI can understand. You may want to work on several copies of the Trunk for each\ndifferent task. That way it will be very easy to generate new patches.\n\nThanks,\nVincent", "id": 99108, "time": "2007-02-08T07:40:10Z", "bug_id": 41514, "creation_time": "2007-02-08T07:40:10Z", "is_private": false}, {"count": 16, "tags": [], "bug_id": 41514, "attachment_id": null, "is_private": false, "id": 99110, "time": "2007-02-08T08:04:29Z", "creator": "pascal.sancho@takoma.fr", "creation_time": "2007-02-08T08:04:29Z", "text": "I yet encountered this kind of error:\nit occurs during xsd validation if there is extra spaces or line brak before \nthe XML declaration.\n\nHTH,\n\nPascal\n\n\n(In reply to comment #14)\n> (In reply to comment #13)\n> > (In reply to comment #12)\n> > > Created an attachment (id=19545) [edit] [edit] [edit]\n> > > main patch file\n> > \n> > I have another comment: this would be better to put the test config files \nin a\n> > subdirectory of test/ --typically, test/conf.\n> The reason I didn't do this is because of concerns raised about this patch\n> containing too much refactoring.  But I am in agreement that it makes sense \nfor\n> the config files to live separately.  So if nobody objects I will provide \nthem\n> in a separate zip attachment and move/remove the existing test/test.xconf to\n> test/config/test.xconfig.\n> > Also, the tests fail with a SAXParseException: \"The processing instruction\n> > target matching \"[xX][mM][lL]\" is not allowed\". Can aynyone else try and \ntell me\n> > if the problem also occurs?\n> Do you have the stack trace for this?\n> > Finally, I got a small error applying your patch. I could recover easily, \nbut\n> > next time be sure to create it from scratch and against the latest svn \nrevision.\n> > \n> > Thanks,\n> > Vincent\n> Sorry about this, I will try to be mindful of this in the future.  Ideally I\n> would do this everytime, but there have been a number of revisions to this \npatch\n> and preparing a new patch from scratch every half day is not a good use of \ntime.\n>  Its not always practically quick and easy to do as I am in parallel \ncracking on\n> with other FOP development work.\n> regards,\n> Adrian.\n\n"}, {"count": 17, "tags": [], "bug_id": 41514, "text": "Created attachment 19548\nmain patch file\n\nContains suggested ammendments from Vincent.", "id": 99112, "time": "2007-02-08T08:19:25Z", "creator": "fop-dev@cumiskey.com", "creation_time": "2007-02-08T08:19:25Z", "is_private": false, "attachment_id": 19548}, {"count": 18, "text": "Comment on attachment 19514\npatch file update for fop config validating xsd file\n\nthis is now included in the main patch file", "bug_id": 41514, "attachment_id": 19514, "id": 99113, "time": "2007-02-08T08:21:23Z", "creator": "fop-dev@cumiskey.com", "creation_time": "2007-02-08T08:21:23Z", "tags": [], "is_private": false}, {"count": 19, "tags": [], "bug_id": 41514, "text": "Comment on attachment 19493\nnew package (and files) under test/src/org.apache.fop.config\n\nthis is now contain in the main patch file", "id": 99114, "time": "2007-02-08T08:27:13Z", "creator": "fop-dev@cumiskey.com", "creation_time": "2007-02-08T08:27:13Z", "is_private": false, "attachment_id": 19493}, {"count": 20, "tags": [], "bug_id": 41514, "attachment_id": null, "text": "(In reply to comment #19)\n> (From update of attachment 19493 [edit])\n> this is now contain in the main patch file\n> \n\nI have compilation errors when applying this patch: PDFRenderer, PSRenderer and\nXMLRenderer now expect the FontSetup.buildFontListFromConfiguration method to\nhave 2 arguments, which is not the case. It seems you forgot to include the\nmodifications of FontSetup in your latest patch.\n\nAlso, did you manage to reproduce the SAXParseException error?\n\nThanks,\nVincent", "id": 99159, "time": "2007-02-09T01:33:02Z", "creator": "vhennebert@gmail.com", "creation_time": "2007-02-09T01:33:02Z", "is_private": false}, {"count": 21, "tags": [], "bug_id": 41514, "attachment_id": 19561, "id": 99170, "time": "2007-02-09T04:24:01Z", "creator": "fop-dev@cumiskey.com", "creation_time": "2007-02-09T04:24:01Z", "is_private": false, "text": "Created attachment 19561\nmain patch file\n\nHi Vincent,\n\nI have the flu today but checked my email earlier this morning and noticed your\nreply.\tI have attached a new patch..  I did leave FontSetup out..  it is one\nof the files I am working on for the font directory functionality.\n\nI haven't experienced any SAXException problems, all the config unit tests\npassed fine.  I will try and investigate this when I am feeling a little\nbetter.\n\nWishing you a nice weekend,\n\nAdrian."}, {"count": 22, "tags": [], "creator": "vhennebert@gmail.com", "attachment_id": null, "is_private": false, "id": 99176, "time": "2007-02-09T07:10:27Z", "bug_id": 41514, "creation_time": "2007-02-09T07:10:27Z", "text": "(In reply to comment #16)\n> I yet encountered this kind of error:\n> it occurs during xsd validation if there is extra spaces or line brak before \n> the XML declaration.\n> \n> HTH,\n\n<lightbulb/>\nIndeed, this is probably due to extra ^M at the end of lines in the new files.\nWhen converting the patch to the unix file format the problem no longer\nappeared. Thanks for the hint Pascal!\n\nAdrian, please create your patch from a unix box next time.\n\nWait, just kidding :-P "}, {"count": 23, "tags": [], "bug_id": 41514, "is_private": false, "text": "Adrian, thanks for doing this! I've looked at the patch and have a few comments\nmyself:\n- I'd suggest to rename \"strict-configuration\" to \"validate-configuration\" (just\na personal preference).\n- the name of the variable \"strictFO\" in FopFactory.configure(Configuration)\nseems wrong. There's nothing \"FO\" specific there. Furthermore, some \"if\n(strictFO)\" should actually be \"if (strictConfig)\", right?\n\nAdrian, would you please install the CheckStyle plug-in in your IDE? There are a\nfew nits about the Java style in your patch. Checkstyle will help you find them.\n\nGet well quickly, Adrian!", "id": 99177, "time": "2007-02-09T07:12:43Z", "creator": "jeremias@apache.org", "creation_time": "2007-02-09T07:12:43Z", "attachment_id": null}, {"count": 24, "tags": [], "creator": "fop-dev@cumiskey.com", "attachment_id": null, "text": "(In reply to comment #23)\n> Adrian, thanks for doing this! I've looked at the patch and have a few comments\n> myself:\n> - I'd suggest to rename \"strict-configuration\" to \"validate-configuration\" (just\n> a personal preference).\n\nThe configuration will still be validated regardless of the setting of this\nvariable.  Its just how the error is handled that makes the difference.  If\n\"strict-configuration\" is true then FOP will immediately throw an exception and\nprocessing will terminate.  If \"strict-configuration\" is set to false then FOP\nwill log the error and attempt to continue parsing the configuration (if\npossible/meaningful).\n\n> - the name of the variable \"strictFO\" in FopFactory.configure(Configuration)\n> seems wrong. There's nothing \"FO\" specific there. Furthermore, some \"if\n> (strictFO)\" should actually be \"if (strictConfig)\", right?\n\nI think you may have been looking at an older patch.  The variable\n\"strictValidation\" is as before and the new variable is called\n\"strictUserConfigValidation\".\n \n> Adrian, would you please install the CheckStyle plug-in in your IDE? There are a\n> few nits about the Java style in your patch. Checkstyle will help you find them.\n> \n> Get well quickly, Adrian!\n\nAfter a weekend in bed am feeling much better today thanks.  I had installed\nchecksytle but not enabled it! ;-(  I will recreate the patch this morning.\n\nAll the best,\n\nAdrian.", "id": 99269, "time": "2007-02-12T02:10:38Z", "bug_id": 41514, "creation_time": "2007-02-12T02:10:38Z", "is_private": false}, {"count": 25, "tags": [], "bug_id": 41514, "text": "Created attachment 19574\nmain patch file\n\nThis *should* be the last patch file I upload for this bug :-).", "id": 99272, "time": "2007-02-12T03:41:51Z", "creator": "fop-dev@cumiskey.com", "creation_time": "2007-02-12T03:41:51Z", "is_private": false, "attachment_id": 19574}, {"count": 26, "tags": [], "bug_id": 41514, "is_private": false, "text": "(In reply to comment #24)\n> (In reply to comment #23)\n> > Adrian, thanks for doing this! I've looked at the patch and have a few comments\n> > myself:\n> > - I'd suggest to rename \"strict-configuration\" to \"validate-configuration\" (just\n> > a personal preference).\n> \n> The configuration will still be validated regardless of the setting of this\n> variable.  Its just how the error is handled that makes the difference.  If\n> \"strict-configuration\" is true then FOP will immediately throw an exception and\n> processing will terminate.  If \"strict-configuration\" is set to false then FOP\n> will log the error and attempt to continue parsing the configuration (if\n> possible/meaningful).\n> \n> > - the name of the variable \"strictFO\" in FopFactory.configure(Configuration)\n> > seems wrong. There's nothing \"FO\" specific there. Furthermore, some \"if\n> > (strictFO)\" should actually be \"if (strictConfig)\", right?\n> \n> I think you may have been looking at an older patch.  The variable\n> \"strictValidation\" is as before and the new variable is called\n> \"strictUserConfigValidation\".\n\nNo, Jeremias is right actually. There are 'if (strictFO)' statements to test if  \nan exception has to be thrown. That should be 'if \n(validateUserConfigStrictly())'. I should have better looked.\n\nAlso, in the new code a HyphenationTreeResolver is no longer created and \nassigned to the hyphResolver field. That should inevitably lead to \na NullPointerException later, however the hyphenation junit tests pass. Strange. \nAre you sure of what you're doing?\n\nOne other thing: when getting the default-page-settings parameter it's not \nnecessary to test if pageConfig is null; it will never be. See the javadoc of \ngetChild.\n\n>  \n> > Adrian, would you please install the CheckStyle plug-in in your IDE? There are a\n> > few nits about the Java style in your patch. Checkstyle will help you find them.\n\nSomething checkstyle doesn't seem to be catching: we usually don't put spaces \ninside brackets: if (test) instead of if ( test ).\n\n\n> > \n> > Get well quickly, Adrian!\n> \n> After a weekend in bed am feeling much better today thanks.  I had installed\n> checksytle but not enabled it! ;-(  I will recreate the patch this morning.\n\nHope you feel better now!\n\nSorry, I'll ask you to create yet another patch, but that should really be the \nlast one!\n\nThanks,\nVincent\n", "id": 99278, "time": "2007-02-12T08:01:34Z", "creator": "vhennebert@gmail.com", "creation_time": "2007-02-12T08:01:34Z", "attachment_id": null}, {"count": 27, "tags": [], "bug_id": 41514, "text": "Hi Vincent,\n\nThanks very much for taking the time to look closely at my patch.\n\n(In reply to comment #26)\n> (In reply to comment #24)\n> > (In reply to comment #23)\n> > > Adrian, thanks for doing this! I've looked at the patch and have a few\ncomments\n> > > myself:\n> > > - I'd suggest to rename \"strict-configuration\" to \"validate-configuration\"\n(just\n> > > a personal preference).\n> > \n> > The configuration will still be validated regardless of the setting of this\n> > variable.  Its just how the error is handled that makes the difference.  If\n> > \"strict-configuration\" is true then FOP will immediately throw an exception and\n> > processing will terminate.  If \"strict-configuration\" is set to false then FOP\n> > will log the error and attempt to continue parsing the configuration (if\n> > possible/meaningful).\n> > \n> > > - the name of the variable \"strictFO\" in FopFactory.configure(Configuration)\n> > > seems wrong. There's nothing \"FO\" specific there. Furthermore, some \"if\n> > > (strictFO)\" should actually be \"if (strictConfig)\", right?\n> > \n> > I think you may have been looking at an older patch.  The variable\n> > \"strictValidation\" is as before and the new variable is called\n> > \"strictUserConfigValidation\".\n> \n> No, Jeremias is right actually. There are 'if (strictFO)' statements to test if  \n> an exception has to be thrown. That should be 'if \n> (validateUserConfigStrictly())'. I should have better looked.\n\nDarn it..  I didn't think Jeremias was refering to the configure method.  I\nmissed this, thanks.\n\n> Also, in the new code a HyphenationTreeResolver is no longer created and \n> assigned to the hyphResolver field. That should inevitably lead to \n> a NullPointerException later, however the hyphenation junit tests pass. Strange. \n> Are you sure of what you're doing?\n\nThanks for checking this, I made a mistake refactoring here :-(.\n\n> One other thing: when getting the default-page-settings parameter it's not \n> necessary to test if pageConfig is null; it will never be. See the javadoc of \n> getChild.\n\nI've read the javadoc and have simplified/removed this unnecessary check now.\n\n> >  \n> > > Adrian, would you please install the CheckStyle plug-in in your IDE? There\nare a\n> > > few nits about the Java style in your patch. Checkstyle will help you find\nthem.\n> \n> Something checkstyle doesn't seem to be catching: we usually don't put spaces \n> inside brackets: if (test) instead of if ( test ).\n\nYes I have noticed this recently and believe all the code I've added adheres to\nthis now.\n\n> > > \n> > > Get well quickly, Adrian!\n> > \n> > After a weekend in bed am feeling much better today thanks.  I had installed\n> > checksytle but not enabled it! ;-(  I will recreate the patch this morning.\n> \n> Hope you feel better now!\n> \n> Sorry, I'll ask you to create yet another patch, but that should really be the \n> last one!\n\nIts ok, I am learning all the bumps for fop patch submissions - hopefully should\nbe smoother for you guys next time :-).\n\nKind regards,\n\nAdrian.", "id": 99280, "time": "2007-02-12T09:02:35Z", "creator": "fop-dev@cumiskey.com", "creation_time": "2007-02-12T09:02:35Z", "is_private": false, "attachment_id": null}, {"count": 28, "tags": [], "bug_id": 41514, "is_private": false, "text": "Created attachment 19576\nmain patch file", "id": 99283, "time": "2007-02-12T09:30:59Z", "creator": "fop-dev@cumiskey.com", "creation_time": "2007-02-12T09:30:59Z", "attachment_id": 19576}, {"count": 29, "tags": [], "bug_id": 41514, "attachment_id": null, "is_private": false, "id": 99320, "time": "2007-02-13T01:46:43Z", "creator": "vhennebert@gmail.com", "creation_time": "2007-02-13T01:46:43Z", "text": "(In reply to comment #28)\n> Created an attachment (id=19576) [edit]\n> main patch file\n> \n\nI'v had problems again applying the patch: something went wrong with FontSetup,\nlooks like the patch wants to remove this file entirely, which I don't think\nshould be the case.\n\nAlso, why did you change the DEFAULT_STRICT_FO_VALIDATION constant into\nDEFAULT_STRICT_VALIDATION? I think it would be clearer to leave it as is.\n\nThanks,\nVincent"}, {"count": 30, "text": "(In reply to comment #29)\n> (In reply to comment #28)\n> > Created an attachment (id=19576) [edit] [edit]\n> > main patch file\n> > \n> \n> I'v had problems again applying the patch: something went wrong with FontSetup,\n> looks like the patch wants to remove this file entirely, which I don't think\n> should be the case.\n\nHmm..  not sure quite why that happened.\n\n> Also, why did you change the DEFAULT_STRICT_FO_VALIDATION constant into\n> DEFAULT_STRICT_VALIDATION? I think it would be clearer to leave it as is.\n\nHave done.", "bug_id": 41514, "attachment_id": null, "id": 99323, "time": "2007-02-13T03:16:41Z", "creator": "fop-dev@cumiskey.com", "creation_time": "2007-02-13T03:16:41Z", "tags": [], "is_private": false}, {"count": 31, "tags": [], "bug_id": 41514, "attachment_id": 19578, "id": 99324, "time": "2007-02-13T03:17:06Z", "creator": "fop-dev@cumiskey.com", "creation_time": "2007-02-13T03:17:06Z", "is_private": false, "text": "Created attachment 19578\nmain patch file"}, {"count": 32, "tags": [], "bug_id": 41514, "is_private": false, "text": "(In reply to comment #31)\n> Created an attachment (id=19578) [edit]\n> main patch file\n\nPatch finally applied, with some modifications (rev. 507539). Thanks Adrian!\n\nI removed the test \"if (!dir.exists())\" in FopFactory.getBaseURLfromConfig\nbecause it doesn't work when the property is a URL. Perhaps you didn't know, but\nthis is actually possible, for user-friendliness, to specify base and font-base\neither as URLs or as directory paths. The purpose of this method is to convert a\npath into a URL if necessary.\nIf the given value actually is a path and does correspond to an existing\ndirectory, everything's fine. Otherwise, we assume that this is a URL whose\nresolution will be attempted later on, and possibly fail.\n\nThe patch is still useful and fixes bug #40120. Bug #40288 keeps open, because\nthe full URL isn't displayed in the error message yet. If you wish you're\nwelcome to continue your work on validation. For example you may want to add\ntestcases with URLs instead of paths as parameters for base and font-base.\n\nThanks,\nVincent\n", "id": 99379, "time": "2007-02-14T06:28:54Z", "creator": "vhennebert@gmail.com", "creation_time": "2007-02-14T06:28:54Z", "attachment_id": null}, {"count": 33, "tags": [], "bug_id": 41514, "text": "(In reply to comment #32)\n> (In reply to comment #31)\n> > Created an attachment (id=19578) [edit] [edit]\n> > main patch file\n> \n> Patch finally applied, with some modifications (rev. 507539). Thanks Adrian!\n> \n> I removed the test \"if (!dir.exists())\" in FopFactory.getBaseURLfromConfig\n> because it doesn't work when the property is a URL. Perhaps you didn't know, but\n\nHmmm, by doing this I broke the test_fontbase_bad.xconf testcase, which no\nlonger throws a ConfigurationException. I could swear I ran the testcases before\napplying the patch :-\\.\nRe-opening the bug, will handle that later.\n\nVincent", "id": 99837, "time": "2007-02-27T00:36:37Z", "creator": "vhennebert@gmail.com", "creation_time": "2007-02-27T00:36:37Z", "is_private": false, "attachment_id": null}, {"count": 34, "tags": [], "bug_id": 41514, "attachment_id": null, "id": 102111, "time": "2007-04-23T08:09:15Z", "creator": "fop-dev@cumiskey.com", "creation_time": "2007-04-23T08:09:15Z", "is_private": false, "text": "This bug (and others) are addressed in PATCH\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=41831\n\n*** This bug has been marked as a duplicate of 41831 ***"}, {"count": 35, "tags": [], "bug_id": 41514, "attachment_id": null, "text": "batch transition to closed remaining pre-FOP1.0 resolved bugs", "id": 156872, "time": "2012-04-01T13:54:09Z", "creator": "gadams@apache.org", "creation_time": "2012-04-01T13:54:09Z", "is_private": false}]