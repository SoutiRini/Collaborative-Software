[{"attachment_id": null, "tags": [], "creator": "cv@corbach.de", "text": "Today I ran in a problem involving envars set by mod_rewrite. From my point of \nview the following two situations should be equal:\n\n--- SetEnvIf solution --->\nSetEnvIf Host \"^my\\.domain\\.de\" allowed_http_host\n\nAuthType Basic\nAuthName test\nAuthUserFile /opt/apache/share/.htpasswd\nRequire valid-user\nOrder Allow,Deny\nAllow from env=allowed_http_host\nSatisfy any\n<--- SetEnvIf solution ---\n\n--- mod_rewrite solution --->\nRewriteCond     %{HTTP_HOST}    ^my\\.domain\\.de\nRewriteRule     .*    -      [E=allowed_http_host:1]\n\nAuthType Basic\nAuthName test\nAuthUserFile /opt/apache/share/.htpasswd\nRequire valid-user\nOrder Allow,Deny\nAllow from env=allowed_http_host\nSatisfy any\n<--- mod_rewrite solution ---\n\nThe first solution works, the second doesn't in httpd.conf nor in a per-\ndirectory configuration. In both cases the envar is set correctly and can be \naccessed via CGI. It seems as if mod_rewrite set the envar not till the fixup \nhook after authorisation has took into place what makes it impossible to \nreplace SetEnvIf with rewriting in cases one needs a more complicated use of \nenvars to handle authorisation.\nI really don't know if this a bug or a feature request so maybe someone could \nlight me up ;-)", "count": 0, "id": 23431, "time": "2002-09-26T11:07:56Z", "bug_id": 13026, "creation_time": "2002-09-26T11:07:56Z", "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 13026, "text": "Had a similiar problem and also issued a bug report. The problem is that the \nrewrite-engine goes to work after all other mods are done. In your case, the \nrewrite-engine goes to work AFTER the authentication has been done.", "id": 23434, "time": "2002-09-26T11:12:02Z", "creator": "info@orangexl.com", "creation_time": "2002-09-26T11:12:02Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "cv@corbach.de", "text": "That's right because the envar is obviously set the fixup hook. But what if it \nwas set in the URL-to-filename translation hook? I read your bug report but as \nI wrote envars by SetEnvIf must be set somehow earlier as there is no bad \ninteraction with authorisation. Of course there is no understandable reason to \ncombine SetEnvIf and mod_rewrite and that's not what I tried to do.", "id": 23442, "time": "2002-09-26T11:28:16Z", "bug_id": 13026, "creation_time": "2002-09-26T11:28:16Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "It's late ...\n\nJust to clarify the things a bit:\n\nmod_rewrite acts in directory context (httpd.conf or not) always in fixup (i.e.\nafter authentication). Only in global or VH context it acts in the uri->filename\nhook. Your report is not clear, how your configuration in the httpd.conf did\nlook exactly.\n\nI think, if you'd set the variable with RewriteRules in the global context (or\nVH), it should work as expected. If not, it's probably a bug. (but I didn't test\nit yet :)", "attachment_id": null, "bug_id": 13026, "id": 36924, "time": "2003-05-08T19:44:47Z", "creator": "nd@perlig.de", "creation_time": "2003-05-08T19:44:47Z", "is_private": false}, {"count": 4, "tags": [], "creator": "nd@perlig.de", "text": "Nothing we can do here. I hope things are clear now ;-)", "id": 46619, "time": "2003-11-01T21:27:02Z", "bug_id": 13026, "creation_time": "2003-11-01T21:27:02Z", "is_private": false, "attachment_id": null}]