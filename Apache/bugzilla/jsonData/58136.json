[{"count": 0, "attachment_id": null, "bug_id": 58136, "text": "Apache is crashing systematically with error:\nAH00428: Parent: child process 9628 exited with status 255 -- Restarting.\n\nAPACHE error log:\n\n[Tue Jul 14 15:02:13.038276 2015] [mpm_winnt:notice] [pid 7044:tid 404] AH00428: Parent: child process 9448 exited with status 255 -- Restarting.\n[Tue Jul 14 15:02:13.324305 2015] [mpm_winnt:notice] [pid 7044:tid 404] AH00455: Apache/2.4.9 (Win32) PHP/5.5.12 configured -- resuming normal operations\n[Tue Jul 14 15:02:13.329306 2015] [mpm_winnt:notice] [pid 7044:tid 404] AH00456: Apache Lounge VC11 Server built: Mar 16 2014 12:13:13\n[Tue Jul 14 15:02:13.329306 2015] [core:notice] [pid 7044:tid 404] AH00094: Command line: 'C:\\\\Program Files\\\\wamp\\\\bin\\\\apache\\\\apache2.4.9\\\\bin\\\\httpd.exe -d C:/Program Files/wamp/bin/apache/apache2.4.9'\n[Tue Jul 14 15:02:13.352308 2015] [mpm_winnt:notice] [pid 7044:tid 404] AH00418: Parent: Created child process 3140\n[Tue Jul 14 15:02:14.528388 2015] [mpm_winnt:notice] [pid 3140:tid 332] AH00354: Child: Starting 64 worker threads.\n\nI checked windows event and I found httpd.exe is crashing caused by php5ts.dll\n\nHOW TO REPRODUCE:\n\nPHP code:\n\n$mysqli=new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif (!($stmt = $mysqli->prepare(\"CALL test()\"))) {\n    echo \"Prepare failed: (\" . $mysqli->errno . \") \" . $mysqli->error;\n}\n\nif (!$stmt->execute()) {\n    echo \"Execute failed: (\" . $stmt->errno . \") \" . $stmt->error;\n}\n\ndo {\n    if ($res = $stmt->get_result()) { //Apache crash on this call\n        printf(\"---\\n\");\n        var_dump($res->fetch_assoc());\n        mysqli_free_result($res);\n    } else {\n        if ($stmt->errno) {\n            echo \"Store failed: (\" . $stmt->errno . \") \" . $stmt->error;\n        }\n    }\n} while ($stmt->more_results() && $stmt->next_result());\n\nStore procedure code:\n\nCREATE DEFINER=`root`@`localhost` PROCEDURE `test`()\nBEGIN\ndeclare test_var varchar(100) default \"ciao\";\ndeclare bNoMoreRows bool default false;\ndeclare test_cursor cursor for\n    select id from tmp_folder;\ndeclare continue handler for not found set bNoMoreRows := true;\ncreate temporary table tmp_folder select \"test\" as id;\nopen test_cursor;\nfetch test_cursor into test_var;\nclose test_cursor;\nselect test_var;\ndrop temporary table if exists tmp_folder;\nEND", "id": 184022, "time": "2015-07-14T16:12:50Z", "creator": "johntiror@gmail.com", "creation_time": "2015-07-14T16:12:50Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "trawick@apache.org", "is_private": false, "text": "File a bug with the PHP folks if it only crashes when running certain PHP code.  Reopen here if they can identify something wrong with httpd.", "id": 184028, "time": "2015-07-14T20:53:58Z", "bug_id": 58136, "creation_time": "2015-07-14T20:53:58Z", "attachment_id": null}]