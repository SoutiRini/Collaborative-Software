[{"count": 0, "tags": [], "bug_id": 452, "is_private": false, "text": "When using the jsp:include tag to include an html file and setting the flush option to true, Tomcat generates the following exception:\r\n\r\nA Servlet Exception Has Occurred\r\n\r\nException Report:\r\n\r\njavax.servlet.ServletException: Servlet.service() for servlet default threw exception\r\n        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:593)\r\n        at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:483)\r\n        at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:388)\r\n        at org.apache.jasper.runtime.PageContextImpl.include(PageContextImpl.java:430)\r\n        at _0002ftest_0002ejsptest_jsp_6._jspService(_0002ftest_0002ejsptest_jsp_6.java:56)\r\n        at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:119)\r\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\r\n        at org.apache.jasper.servlet.JspServlet$JspServletWrapper.service(JspServlet.java:184)\r\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:328)\r\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:407)\r\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\r\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:215)\r\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:251)\r\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:977)\r\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:196)\r\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:977)\r\n        at org.apache.catalina.core.StandardContext.invoke(StandardContext.java:2041)\r\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)\r\n        at org.apache.catalina.valves.ValveBase.invokeNext(ValveBase.java:242)\r\n        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:414)\r\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:975)\r\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:159)\r\n        at org.apache.catalina.valves.ValveBase.invokeNext(ValveBase.java:242)\r\n        at org.apache.catalina.valves.RequestDumperValve.invoke(RequestDumperValve.java:215)\r\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:975)\r\n        at org.apache.catalina.connector.http.HttpProcessor.process(HttpProcessor.java:818)\r\n        at org.apache.catalina.connector.http.HttpProcessor.run(HttpProcessor.java:897)\r\n        at java.lang.Thread.run(Thread.java:484)\r\n\r\nRoot Cause:\r\n\r\njava.lang.IllegalStateException: Buffer size cannot be changed after data has been written\r\n        at org.apache.catalina.connector.ResponseBase.setBufferSize(ResponseBase.java:746)\r\n        at javax.servlet.ServletResponseWrapper.setBufferSize(ServletResponseWrapper.java:172)\r\n        at javax.servlet.ServletResponseWrapper.setBufferSize(ServletResponseWrapper.java:172)\r\n        at org.apache.catalina.servlets.DefaultServlet.serveResource(DefaultServlet.java:1459)\r\n        at org.apache.catalina.servlets.DefaultServlet.doGet(DefaultServlet.java:433)\r\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:740)\r\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\r\n        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:573)\r\n        at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:483)\r\n        at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:388)\r\n        at org.apache.jasper.runtime.PageContextImpl.include(PageContextImpl.java:430)\r\n        at _0002ftest_0002ejsptest_jsp_6._jspService(_0002ftest_0002ejsptest_jsp_6.java:56)\r\n        at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:119)\r\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\r\n        at org.apache.jasper.servlet.JspServlet$JspServletWrapper.service(JspServlet.java:184)\r\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:328)\r\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:407)\r\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\r\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:215)\r\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:251)\r\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:977)\r\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:196)\r\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:977)\r\n        at org.apache.catalina.core.StandardContext.invoke(StandardContext.java:2041)\r\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)\r\n        at org.apache.catalina.valves.ValveBase.invokeNext(ValveBase.java:242)\r\n        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:414)\r\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:975)\r\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:159)\r\n        at org.apache.catalina.valves.ValveBase.invokeNext(ValveBase.java:242)\r\n        at org.apache.catalina.valves.RequestDumperValve.invoke(RequestDumperValve.java:215)\r\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:975)\r\n        at org.apache.catalina.connector.http.HttpProcessor.process(HttpProcessor.java:818)\r\n        at org.apache.catalina.connector.http.HttpProcessor.run(HttpProcessor.java:897)\r\n        at java.lang.Thread.run(Thread.java:484)", "id": 421, "time": "2001-01-15T20:23:29Z", "creator": "dev@tomcat.apache.org", "creation_time": "2001-01-15T20:23:29Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 452, "is_private": false, "text": "I've used the jsp:include tag to include an html file with flush set to true \nand have not encountered this problem.\n\nI need a sample jsp and html file in order to reproduce the problem.", "id": 1272, "time": "2001-03-14T17:01:54Z", "creator": "justyna.horwat@sun.com", "creation_time": "2001-03-14T17:01:54Z", "attachment_id": null}, {"count": 2, "attachment_id": null, "creator": "dion@almaer.com", "is_private": false, "id": 33188, "time": "2003-03-14T12:21:01Z", "bug_id": 452, "creation_time": "2003-03-14T12:21:01Z", "tags": [], "text": "I am seeing this exception myself.  Some of my pages were working and some were \nnot, and then I found that the ones that were not happy had:\n\n  <jsp:include page=\"/usercount.include\"/>\n\nIf I edited the files and changed them to have:\n\n  <jsp:include page=\"/usercount.include.jsp\"/>\n\nand moved the usercount.include -&gt; usercount.include.jsp\n\nthen things worked.\n\ntest JSPs:\n\n---\n<h2>Test include of Non-JSP</h2>\n\n<p>\nNon jsp: <jsp:include page=\"/usercount.include\"/>\n</p>\n---\n\n---\n<h2>Test include of JSP</h2>\n\n<p>\nAs jsp: <jsp:include page=\"/usercount.include.jsp\"/>\n</p>\n---\n"}]