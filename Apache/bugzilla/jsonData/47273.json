[{"count": 0, "tags": [], "bug_id": 47273, "attachment_id": null, "id": 127444, "time": "2009-05-27T09:37:29Z", "creator": "shehi@imanov.name", "creation_time": "2009-05-27T09:37:29Z", "is_private": false, "text": "My .htaccess contains following ReWrite rule:\n\n<IfModule mod_rewrite.c>\n\tRewriteEngine On\n\tRewriteBase /\n\tRewriteRule ^acp/([\\/-_a-z0-9\\.]*)    /index.php/acp/$1   [NC,QSA,L]\n\tRewriteRule ^news/([\\/-_a-z0-9\\.]*)    /index.php/news/$1    [NC,QSA,L]\n</IfModule>\n\nIt works fine when I visit pages like:\n\nhttp://URL.com/acp/components/\nhttp://URL.com/acp/components/index.do\nhttp://URL.com/acp/components/index.do?arg=value\nhttp://URL.com/acp/components/register2.do\n\netc. However, 403 is issued when I try URL's such as these:\n\nhttp://URL.com/acp/components/register.do\nhttp://URL.com/acp/components/2register.do\nhttp://URL.com/acp/components/getregister.do\n\nAnd when I go to:\nhttp://URL.com/acp/components/Register.do\n\nI get redirected by 301 here:\nhttp://URL.com/acp/index..do\n\nIN ALL of my Apache conf files, there are no Aliases, VHosts or anything else related to the keyword \"register\". I had this problem with some other keywords as well, in the past, but I am afraid I don't remember them at this moment.\n\nANY help, support, tip, suggestion to solve, or at least identify this problem is welcome!\n\nShehi\nazerista-spam@yahoo.com [my public redundant email]"}, {"count": 1, "tags": [], "bug_id": 47273, "text": "Try starting a thread on the users mailing list, and be sure to include your RewriteLog output and error log corresponding to the 403s.  \n\nhttp://httpd.apache.org/userslist.html", "id": 127452, "time": "2009-05-27T11:17:29Z", "creator": "covener@gmail.com", "creation_time": "2009-05-27T11:17:29Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 47273, "text": "Dear Eric,\n\nI wonder why the status and resolution of this report was changed. If this is a problem which was reported before and has a solution to it, why not redirect me to it? If not, then why change it as RESOLVED INVALID? Of course, I will subscribe and post in Users list as well, but still, I would like to have an answer to this question.\n\nDeep regards,\n\nShehi", "id": 127453, "time": "2009-05-27T11:55:07Z", "creator": "shehi@imanov.name", "creation_time": "2009-05-27T11:55:07Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 47273, "attachment_id": null, "id": 127454, "time": "2009-05-27T12:02:56Z", "creator": "rpluem@apache.org", "creation_time": "2009-05-27T12:02:56Z", "is_private": false, "text": "Bugzilla is no user support forum but for reporting bugs. As Eric says please go the users support mailing list. If it turns out to be a bug please come back here and reopen the report."}, {"count": 4, "tags": [], "bug_id": 47273, "attachment_id": null, "id": 127455, "time": "2009-05-27T13:24:19Z", "creator": "shehi@imanov.name", "creation_time": "2009-05-27T13:24:19Z", "is_private": false, "text": "Thanks guys. Problem fixed - my error because of prepending PERISHABLE PRESS 4G BLACKLIST in .htaccess. Subject in question is as follows [for the future reference]:\n\n### PERISHABLE PRESS 4G BLACKLIST ###\n\n# ESSENTIALS\nRewriteEngine on\nServerSignature Off\nOptions All -Indexes\nOptions +FollowSymLinks\n\n# FILTER REQUEST METHODS\n<IfModule mod_rewrite.c>\n\tRewriteCond %{REQUEST_METHOD} ^(HEAD|TRACE|DELETE|TRACK) [NC]\n\tRewriteRule ^(.*)$ - [F,L]\n</IfModule>\n\n# BLACKLIST CANDIDATES\n<Limit GET POST PUT>\n\tOrder Allow,Deny\n\tAllow from all\n\tDeny from 75.126.85.215   \"# blacklist candidate 2008-01-02 = admin-ajax.php attack \"\n\tDeny from 128.111.48.138  \"# blacklist candidate 2008-02-10 = cryptic character strings \"\n\tDeny from 87.248.163.54   \"# blacklist candidate 2008-03-09 = block administrative attacks \"\n\tDeny from 84.122.143.99   \"# blacklist candidate 2008-04-27 = block clam store loser \"\n\tDeny from 210.210.119.145 \"# blacklist candidate 2008-05-31 = block _vpi.xml attacks \"\n\tDeny from 66.74.199.125   \"# blacklist candidate 2008-10-19 = block mindless spider running \"\n\tDeny from 203.55.231.100  \"# 1048 attacks in 60 minutes\"\n\tDeny from 24.19.202.10    \"# 1629 attacks in 90 minutes\"\n</Limit>\n\n# QUERY STRING EXPLOITS\n<IfModule mod_rewrite.c>\n\tRewriteCond %{QUERY_STRING} \\.\\.\\/    [NC,OR]\n\tRewriteCond %{QUERY_STRING} boot\\.ini [NC,OR]\n\tRewriteCond %{QUERY_STRING} tag\\=     [NC,OR]\n\tRewriteCond %{QUERY_STRING} ftp\\:     [NC,OR]\n\tRewriteCond %{QUERY_STRING} http\\:    [NC,OR]\n\tRewriteCond %{QUERY_STRING} https\\:   [NC,OR]\n\tRewriteCond %{QUERY_STRING} mosConfig [NC,OR]\n\tRewriteCond %{QUERY_STRING} ^.*(\\[|\\]|\\(|\\)|<|>|'|\"|;|\\?|\\*).* [NC,OR]\n\tRewriteCond %{QUERY_STRING} ^.*(%22|%27|%3C|%3E|%5C|%7B|%7C).* [NC,OR]\n\tRewriteCond %{QUERY_STRING} ^.*(%0|%A|%B|%C|%D|%E|%F|127\\.0).* [NC,OR]\n\tRewriteCond %{QUERY_STRING} ^.*(globals|encode|config|localhost|loopback).* [NC,OR]\n\tRewriteCond %{QUERY_STRING} ^.*(request|select|insert|union|declare|drop).* [NC]\n\tRewriteRule ^(.*)$ - [F,L]\n</IfModule>\n\n# CHARACTER STRINGS\n<IfModule mod_alias.c>\n\t# BASIC CHARACTERS\n\tRedirectMatch 403 \\,\n\tRedirectMatch 403 \\:\n\tRedirectMatch 403 \\;\n\tRedirectMatch 403 \\=\n\tRedirectMatch 403 \\@\n\tRedirectMatch 403 \\[\n\tRedirectMatch 403 \\]\n\tRedirectMatch 403 \\^\n\tRedirectMatch 403 \\`\n\tRedirectMatch 403 \\{\n\tRedirectMatch 403 \\}\n\tRedirectMatch 403 \\~\n\tRedirectMatch 403 \\\"\n\tRedirectMatch 403 \\$\n\tRedirectMatch 403 \\<\n\tRedirectMatch 403 \\>\n\tRedirectMatch 403 \\|\n\tRedirectMatch 403 \\.\\.\n\tRedirectMatch 403 \\/\\/\n\tRedirectMatch 403 \\%0\n\tRedirectMatch 403 \\%A\n\tRedirectMatch 403 \\%B\n\tRedirectMatch 403 \\%C\n\tRedirectMatch 403 \\%D\n\tRedirectMatch 403 \\%E\n\tRedirectMatch 403 \\%F\n\tRedirectMatch 403 \\%22\n\tRedirectMatch 403 \\%27\n\tRedirectMatch 403 \\%28\n\tRedirectMatch 403 \\%29\n\tRedirectMatch 403 \\%3C\n\tRedirectMatch 403 \\%3E\n\tRedirectMatch 403 \\%3F\n\tRedirectMatch 403 \\%5B\n\tRedirectMatch 403 \\%5C\n\tRedirectMatch 403 \\%5D\n\tRedirectMatch 403 \\%7B\n\tRedirectMatch 403 \\%7C\n\tRedirectMatch 403 \\%7D\n\t# COMMON PATTERNS\n\tRedirectMatch 404 wp\\_\n\tRedirectmatch 403 \\_vpi\n\tRedirectMatch 403 \\.inc\n\tRedirectmatch 403 xAou6\n\tRedirectmatch 403 db\\_name\n\tRedirectmatch 403 select\\(\n\tRedirectmatch 403 convert\\(\n\tRedirectmatch 403 \\/query\\/\n\tRedirectMatch 403 ImpEvData\n\tRedirectmatch 403 \\.XMLHTTP\n\tRedirectmatch 403 proxydeny\n\tRedirectMatch 403 function\\.\n\tRedirectmatch 403 remoteFile\n\tRedirectmatch 403 servername\n\tRedirectmatch 403 \\&rptmode\\=\n\tRedirectmatch 403 sys\\_cpanel\n\tRedirectMatch 403 db\\_connect\n\tRedirectMatch 403 doeditconfig\n\tRedirectMatch 403 check\\_proxy\n\tRedirectmatch 403 system\\_user\n\tRedirectmatch 403 \\/\\(null\\)\\/\n\tRedirectmatch 403 clientrequest\n\tRedirectmatch 403 option\\_value\n\tRedirectMatch 403 ref\\.outcontrol\n\t# SPECIFIC EXPLOITS\n\tRedirectMatch 403 errors\\.\n\tRedirectMatch 403 config\\.\n\tRedirectMatch 403 include\\.\n\tRedirectMatch 403 display\\.\n\tRedirectMatch 403 register\\.\n\tRedirectmatch 403 password\\.\n\tRedirectMatch 403 maincore\\.\n\tRedirectMatch 403 authorize\\.\n\tRedirectmatch 403 macromates\\.\n\tRedirectMatch 403 head\\_auth\\.\n\tRedirectMatch 403 submit\\_links\\.\n\tRedirectMatch 403 change\\_action\\.\n\tRedirectmatch 403 com\\_facileforms\\/\n\tRedirectMatch 403 admin\\_db\\_utilities\\.\n\tRedirectMatch 403 admin\\.webring\\.docs\\.\n\tRedirectmatch 403 Table\\/Latest\\/index\\.\n</IfModule>"}]