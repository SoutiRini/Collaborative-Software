[{"count": 0, "tags": [], "text": "JDK version 1.4.2_16\n\nA LoggerConfigurationException would occur if the default web.xml (in the conf directory) or the web.xml in the web-app (in WEB-INF) contains the session-timeout entry\n\ni.e.\n<session-config>\n    <session-timeout>30</session-timeout>\n</session-config>\n\nAND\n\nthe WEB-INF/classes directory contains a commons-logging.properties file with the entry org.apache.commons.logging.Log=org.apache.commons.logging.impl.Log4JLogger.\n\nThe console would display\n\n30-Apr-2008 17:44:17 org.apache.commons.digester.Digester endElement\nSEVERE: End event threw exception\norg.apache.commons.logging.LogConfigurationException: User-specified log class '\norg.apache.commons.logging.impl.Log4JLogger' cannot be found or is not useable.\n        at org.apache.commons.logging.impl.LogFactoryImpl.discoverLogImplementation(LogFactoryImpl.java:874)\n        at org.apache.commons.logging.impl.LogFactoryImpl.newInstance(LogFactoryImpl.java:604)\n        at org.apache.commons.logging.impl.LogFactoryImpl.getInstance(LogFactoryImpl.java:336)\n        at org.apache.commons.logging.impl.LogFactoryImpl.getInstance(LogFactoryImpl.java:310)\n        at org.apache.commons.logging.LogFactory.getLog(LogFactory.java:685)\n        at org.apache.commons.beanutils.ConvertUtilsBean.<init>(ConvertUtilsBean.java:130)\n        at org.apache.commons.beanutils.BeanUtilsBean.<init>(BeanUtilsBean.java:110)\n        at org.apache.commons.beanutils.BeanUtilsBean$1.initialValue(BeanUtilsBean.java:68)\n        at org.apache.commons.beanutils.ContextClassLoaderLocal.get(ContextClassLoaderLocal.java:80)\n        at org.apache.commons.beanutils.BeanUtilsBean.getInstance(BeanUtilsBean.java:78)\n        at org.apache.commons.beanutils.ConvertUtilsBean.getInstance(ConvertUtilsBean.java:115)\n        at org.apache.commons.beanutils.ConvertUtils.convert(ConvertUtils.java:217)\n        at org.apache.commons.digester.CallMethodRule.end(CallMethodRule.java:561)\n        at org.apache.commons.digester.Rule.end(Rule.java:253)\n        at org.apache.commons.digester.Digester.endElement(Digester.java:1222)\n        at org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)\n        at org.apache.xerces.impl.dtd.XMLDTDValidator.endNamespaceScope(UnknownSource)\n        at org.apache.xerces.impl.dtd.XMLDTDValidator.handleEndElement(Unknown Source)\n        at org.apache.xerces.impl.dtd.XMLDTDValidator.endElement(Unknown Source)\n        at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanEndElement(Unknown Source)\n        at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown Source)\n        at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)\n        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\n        at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)\n        at org.apache.xerces.jaxp.SAXParserImpl$JAXPSAXParser.parse(Unknown Source)\n        at org.apache.commons.digester.Digester.parse(Digester.java:1745)\n        at org.apache.catalina.startup.ContextConfig.defaultConfig(ContextConfig.java:488)\n        at org.apache.catalina.startup.ContextConfig.start(ContextConfig.java:579)\n        at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:182)\n        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:120)\n        at org.apache.catalina.core.StandardContext.start(StandardContext.java:3644)\n        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:777)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:760)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:538)\n        at org.apache.catalina.core.StandardHostDeployer.install(StandardHostDeployer.java:265)\n        at org.apache.catalina.core.StandardHost.install(StandardHost.java:731)\n        at org.apache.catalina.startup.HostConfig.deployDirectories(HostConfig.java:649)\n        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:379)\n        at org.apache.catalina.startup.HostConfig.start(HostConfig.java:808)\n        at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:335)\n        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:120)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1156)\n        at org.apache.catalina.core.StandardHost.start(StandardHost.java:697)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1148)\n        at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:311)\n        at org.apache.catalina.core.StandardService.start(StandardService.java:450)\n        at org.apache.catalina.core.StandardServer.start(StandardServer.java:2213)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:484)\n        at org.apache.catalina.startup.Catalina.execute(Catalina.java:371)\n        at org.apache.catalina.startup.Catalina.process(Catalina.java:134)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:324)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:151)\n\nwhile the log file in the logs directory would contain\n\n2008-04-30 17:44:17 ContextConfig[/test] Parse error in default web.xml\norg.apache.commons.logging.LogConfigurationException: User-specified log class 'org.apache.commons.logging.impl.Log4JLogger' cannot be found or is not useable.\n\tat org.apache.commons.digester.Digester.createSAXException(Digester.java:3181)\n\tat org.apache.commons.digester.Digester.createSAXException(Digester.java:3207)\n\tat org.apache.commons.digester.Digester.endElement(Digester.java:1225)\n\tat org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)\n\tat org.apache.xerces.impl.dtd.XMLDTDValidator.endNamespaceScope(Unknown Source)\n\tat org.apache.xerces.impl.dtd.XMLDTDValidator.handleEndElement(Unknown Source)\n\tat org.apache.xerces.impl.dtd.XMLDTDValidator.endElement(Unknown Source)\n\tat org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanEndElement(Unknown Source)\n\tat org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown Source)\n\tat org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)\n\tat org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n\tat org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n\tat org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\n\tat org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)\n\tat org.apache.xerces.jaxp.SAXParserImpl$JAXPSAXParser.parse(Unknown Source)\n\tat org.apache.commons.digester.Digester.parse(Digester.java:1745)\n\tat org.apache.catalina.startup.ContextConfig.defaultConfig(ContextConfig.java:488)\n\tat org.apache.catalina.startup.ContextConfig.start(ContextConfig.java:579)\n\tat org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:182)\n\tat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:120)\n\tat org.apache.catalina.core.StandardContext.start(StandardContext.java:3644)\n\tat org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:777)\n\tat org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:760)\n\tat org.apache.catalina.core.StandardHost.addChild(StandardHost.java:538)\n\tat org.apache.catalina.core.StandardHostDeployer.install(StandardHostDeployer.java:265)\n\tat org.apache.catalina.core.StandardHost.install(StandardHost.java:731)\n\tat org.apache.catalina.startup.HostConfig.deployDirectories(HostConfig.java:649)\n\tat org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:379)\n\tat org.apache.catalina.startup.HostConfig.start(HostConfig.java:808)\n\tat org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:335)\n\tat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:120)\n\tat org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1156)\n\tat org.apache.catalina.core.StandardHost.start(StandardHost.java:697)\n\tat org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1148)\n\tat org.apache.catalina.core.StandardEngine.start(StandardEngine.java:311)\n\tat org.apache.catalina.core.StandardService.start(StandardService.java:450)\n\tat org.apache.catalina.core.StandardServer.start(StandardServer.java:2213)\n\tat org.apache.catalina.startup.Catalina.start(Catalina.java:484)\n\tat org.apache.catalina.startup.Catalina.execute(Catalina.java:371)\n\tat org.apache.catalina.startup.Catalina.process(Catalina.java:134)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:324)\n\tat org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:151)\n\n2008-04-30 17:44:17 ContextConfig[/test]: Occurred at line 324 column 46\n2008-04-30 17:44:17 ContextConfig[/test] Parse error in application web.xml\norg.apache.commons.logging.LogConfigurationException: User-specified log class 'org.apache.commons.logging.impl.Log4JLogger' cannot be found or is not useable.\n\tat org.apache.commons.digester.Digester.createSAXException(Digester.java:3181)\n\tat org.apache.commons.digester.Digester.createSAXException(Digester.java:3207)\n\tat org.apache.commons.digester.Digester.endElement(Digester.java:1225)\n\tat org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)\n\tat org.apache.xerces.impl.dtd.XMLDTDValidator.endNamespaceScope(Unknown Source)\n\tat org.apache.xerces.impl.dtd.XMLDTDValidator.handleEndElement(Unknown Source)\n\tat org.apache.xerces.impl.dtd.XMLDTDValidator.endElement(Unknown Source)\n\tat org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanEndElement(Unknown Source)\n\tat org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown Source)\n\tat org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)\n\tat org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n\tat org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n\tat org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\n\tat org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)\n\tat org.apache.xerces.jaxp.SAXParserImpl$JAXPSAXParser.parse(Unknown Source)\n\tat org.apache.commons.digester.Digester.parse(Digester.java:1745)\n\tat org.apache.catalina.startup.ContextConfig.applicationConfig(ContextConfig.java:221)\n\tat org.apache.catalina.startup.ContextConfig.start(ContextConfig.java:580)\n\tat org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:182)\n\tat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:120)\n\tat org.apache.catalina.core.StandardContext.start(StandardContext.java:3644)\n\tat org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:777)\n\tat org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:760)\n\tat org.apache.catalina.core.StandardHost.addChild(StandardHost.java:538)\n\tat org.apache.catalina.core.StandardHostDeployer.install(StandardHostDeployer.java:265)\n\tat org.apache.catalina.core.StandardHost.install(StandardHost.java:731)\n\tat org.apache.catalina.startup.HostConfig.deployDirectories(HostConfig.java:649)\n\tat org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:379)\n\tat org.apache.catalina.startup.HostConfig.start(HostConfig.java:808)\n\tat org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:335)\n\tat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:120)\n\tat org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1156)\n\tat org.apache.catalina.core.StandardHost.start(StandardHost.java:697)\n\tat org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1148)\n\tat org.apache.catalina.core.StandardEngine.start(StandardEngine.java:311)\n\tat org.apache.catalina.core.StandardService.start(StandardService.java:450)\n\tat org.apache.catalina.core.StandardServer.start(StandardServer.java:2213)\n\tat org.apache.catalina.startup.Catalina.start(Catalina.java:484)\n\tat org.apache.catalina.startup.Catalina.execute(Catalina.java:371)\n\tat org.apache.catalina.startup.Catalina.process(Catalina.java:134)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:324)\n\tat org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:151)\n\n2008-04-30 17:44:17 ContextConfig[/test]: Occurred at line 6 column 40\n\nNote that both line 324 of the default web.xml and line 6 of the web app web.xml point to the session-timeout entry.\n\nAttached is the WAR file that can be used to replicate this. It contains only\n/test (root directory of the web-app)\n/test/WEB-INF\n/test/WEB-INF/classes\n/test/WEB-INF/classes/commons-logging.properties\n/test/WEB-INF/web.xml", "is_private": false, "id": 116053, "creator": "edwin11_79@hotmail.com", "time": "2008-04-30T03:01:11Z", "bug_id": 44908, "creation_time": "2008-04-30T03:01:11Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "Created attachment 21885\nWAR file to replicate issue.", "is_private": false, "id": 116054, "creator": "edwin11_79@hotmail.com", "time": "2008-04-30T03:02:22Z", "bug_id": 44908, "creation_time": "2008-04-30T03:02:22Z", "attachment_id": 21885}, {"count": 2, "attachment_id": null, "bug_id": 44908, "is_private": false, "id": 116120, "time": "2008-05-01T15:42:19Z", "creator": "markt@apache.org", "creation_time": "2008-05-01T15:42:19Z", "tags": [], "text": "There might be a bug here but...\n\nlog4j isn't provided as part of the standard TC4 distro so the LoggerConfigurationException is understandable.\n\nThe reason you are seeing this is that Tomcat tries to log web-app related messages to the logger(s) associated with the web-app. What you are seeing is a side-effect of this.\n\nThere have been bugs in this area in the past, usually memory leaks related to class loaders not being properly released, and it wouldn't surprise me if a few more issues of that type were still in TC4.  That said, I don't think this falls into that category.\n\nThere are also many, many pages on the web documenting some horrible experiences people have have with logging frameworks and the class loader structure of a typical Servlet container. This has been improved in later versions but the changes are way to invasive to port back to the TC4 branch.\n\nIn short, small bugs in the logging will get fixed whereas issues that need architectural changes will not.\n\nAll that said, so far this issue looks like a configuration error to me."}]