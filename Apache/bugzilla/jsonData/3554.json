[{"count": 0, "tags": [], "creator": "calle@appeal.se", "attachment_id": null, "is_private": false, "id": 5378, "time": "2001-09-11T14:32:37Z", "bug_id": 3554, "creation_time": "2001-09-11T14:32:37Z", "text": "If I have a jsp using xml syntax, adding attributes with request-time values \nare not recognized by the jasper compiler... a silly example would be:\n<jsp:root xmlns:jsp=\"...blabla\">\n   <table width=\"%= System.currentTimeMillis()%100 %\"/>\n   ...\n   </table>\n</jsp:root>\n\nHere we would expect the attribute for width to be calculated in runtime, but \nthis is not the case.\n\nHowever, in my humble ignorance I'm not totally sure this is not a 'feature' of \nthe spec... it's very inconvinient in any case...\n\nA simple fix seems to be this mod to \norg.apache.jasper.compiler.UninterpretedTagBeginGenerator:\n<in generate(), 108>\n\t\tif (JspUtil.isExpression(value, true)) {\n\t\t   value=JspUtil.getExpr(value, true);\n\t\t   sb.append(\"  \").append(name).append(\"=\").append(quote).append\n(\"\\\"+\");\n\t\t   sb.append(value).append(\"+\\\"\").append(quote);\n\t\t} else {\n\t\t   if (value.indexOf('\"') != -1) quote = singleQuote;\n\t\t   sb.append(\"  \").append(name).append(\"=\").append(quote);\n\t\t   sb.append(value).append(quote);\n\t\t}\n\nthis at least gives the desired behaviour for simple examples. Am I missing \nsomething?"}, {"count": 1, "tags": [], "bug_id": 3554, "is_private": false, "text": "You are making incorrect assumptions about where the \"% ... %\" expression syntax \nis recognized.\n\nIf you have the following page in JSP syntax:\n\n  <html>\n  <body>\n  <table width=\"<%= System.currentTimeMillis() % 100 %>\">\n    <tr>\n      <td>foo</td>\n    </tr>\n  </table>\n  </body>\n  </html>\n\nThe corresponding page in XML syntax would be:\n\n  <jsp:root xmlns=\"http://java.sun.com/JSP/Page\" version=\"1.2\">\n  <jsp:text><![CDATA[\n  <html>\n  <body>\n  <table width=\"]]>\n  </jsp:text>\n  <jsp:expression><![CDATA[System.currentTimeMillis() % 100]]>\n  </jsp:expression>\n  <jsp:text><![CDATA[\">\n    <tr>\n      <td>foo</td>\n    </tr>\n  </table>\n  </body>\n  </html>\n  ]]>\n  </jsp:text>\n  </jsp:root>\n\nThe \"% expr %\" syntax is only used for the attributes of JSP custom tags that \naccept runtime expressions.  The <table> tag in your example is not a custom \ntag, so it is considered to be part of the template text.\n\n", "id": 5402, "time": "2001-09-11T21:58:17Z", "creator": "craig.mcclanahan@sun.com", "creation_time": "2001-09-11T21:58:17Z", "attachment_id": null}]