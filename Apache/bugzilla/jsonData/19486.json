[{"count": 0, "tags": [], "bug_id": 19486, "attachment_id": null, "is_private": false, "id": 36394, "time": "2003-04-30T15:32:16Z", "creator": "anjiloh@tecnes.com", "creation_time": "2003-04-30T15:32:16Z", "text": "I've got a Windows 2000 Server, I'm using Jakarta-Tomcat 4.1.24, Struts 1.1rc1.\nMy tomcat works as Windows Service.\nMy webapp is provided as WAR file.\n\nIf I stop/start the Windows Service (Via Control Panel/Administrative Tool) \nthe webapp is deployed correctly. If I use the Tomcat Web Application Manager\nand I stop the webapp, I replace the WARfile with a new one and I start the\napplication (http://servername:8000/manager/html/start?path=/PM) I've got the \nfollowing exception:\n\n\n2003-04-30 17:22:39 StandardContext[/PM]: Servlet /PM threw load() exception\njavax.servlet.ServletException: Servlet.init() for servlet action threw exception\n\tat org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:963)\n\tat org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:823)\n\tat\norg.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:3420)\n\tat org.apache.catalina.core.StandardContext.start(StandardContext.java:3608)\n\tat\norg.apache.catalina.core.StandardHostDeployer.start(StandardHostDeployer.java:629)\n\tat org.apache.catalina.core.StandardHost.start(StandardHost.java:897)\n\tat org.apache.catalina.servlets.ManagerServlet.start(ManagerServlet.java:1105)\n\tat\norg.apache.catalina.servlets.HTMLManagerServlet.start(HTMLManagerServlet.java:555)\n\tat\norg.apache.catalina.servlets.HTMLManagerServlet.doGet(HTMLManagerServlet.java:157)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:740)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:247)\n\tat\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)\n\tat\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:256)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat\norg.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:551)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardContext.invoke(StandardContext.java:2415)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:180)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat\norg.apache.catalina.valves.ErrorDispatcherValve.invoke(ErrorDispatcherValve.java:171)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:172)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:174)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.coyote.tomcat4.CoyoteAdapter.service(CoyoteAdapter.java:223)\n\tat org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:594)\n\tat\norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:392)\n\tat org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:565)\n\tat\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:619)\n\tat java.lang.Thread.run(Thread.java:536)\n----- Root Cause -----\njava.lang.NullPointerException\n\tat org.apache.log4j.Category.error(Category.java:300)\n\tat\norg.apache.struts.util.MessageResourcesFactory.createFactory(MessageResourcesFactory.java:197)\n\tat\norg.apache.struts.util.MessageResources.getMessageResources(MessageResources.java:576)\n\tat org.apache.struts.action.ActionServlet.initInternal(ActionServlet.java:1276)\n\tat org.apache.struts.action.ActionServlet.init(ActionServlet.java:462)\n\tat javax.servlet.GenericServlet.init(GenericServlet.java:256)\n\tat org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:935)\n\tat org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:823)\n\tat\norg.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:3420)\n\tat org.apache.catalina.core.StandardContext.start(StandardContext.java:3608)\n\tat\norg.apache.catalina.core.StandardHostDeployer.start(StandardHostDeployer.java:629)\n\tat org.apache.catalina.core.StandardHost.start(StandardHost.java:897)\n\tat org.apache.catalina.servlets.ManagerServlet.start(ManagerServlet.java:1105)\n\tat\norg.apache.catalina.servlets.HTMLManagerServlet.start(HTMLManagerServlet.java:555)\n\tat\norg.apache.catalina.servlets.HTMLManagerServlet.doGet(HTMLManagerServlet.java:157)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:740)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:247)\n\tat\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)\n\tat\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:256)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat\norg.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:551)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardContext.invoke(StandardContext.java:2415)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:180)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat\norg.apache.catalina.valves.ErrorDispatcherValve.invoke(ErrorDispatcherValve.java:171)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:172)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:174)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.coyote.tomcat4.CoyoteAdapter.service(CoyoteAdapter.java:223)\n\tat org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:594)\n\tat\norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:392)\n\tat org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:565)\n\tat\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:619)\n\tat java.lang.Thread.run(Thread.java:536)\n\n\nRegards \nAngelo"}, {"count": 1, "tags": [], "bug_id": 19486, "attachment_id": null, "id": 36534, "time": "2003-05-02T11:19:13Z", "creator": "anjiloh@tecnes.com", "creation_time": "2003-05-02T11:19:13Z", "is_private": false, "text": "I forgot to report some other infos:\n- log4j version 1.2.8;\n- appender: org.apache.log4j.RollingFileAppender\n- configurator: DOMConfigurator\n\nHope this can help.\nAngelo"}, {"count": 2, "attachment_id": null, "bug_id": 19486, "is_private": false, "id": 36902, "time": "2003-05-08T14:23:08Z", "creator": "anjiloh@tecnes.com", "creation_time": "2003-05-08T14:23:08Z", "tags": [], "text": "This NullPointerException  was generated by the incorrect usage of\ncommons-logging  and struts: The startup process was the following:\n\n1. struts (using common-logging)\n2. log4j\n\nWhen I started log4j I set the following property: \n  System.setProperty(\"org.apache.commons.logging.Log\", \"tecnes.log.LogManager\");\n\nso struts was confused by it and was unable to restart correctly.\nI changed the startup process:\n\n1. log4j\n2. struts \n\nand into the log4j startup I set the following properties:\n System.setProperty(\"org.apache.commons.logging.Log\", \"tecnes.log.LogManager\");\n System.setProperty(\"org.apache.commons.logging.LogFactory\",\n\"org.apache.commons.logging.impl.Log4jFactory\");\n\n(forcing struts to use log4j)\n\nand the exception vanished.\n\nAngelo"}, {"count": 3, "tags": [], "text": "\nWhat do you mean exactly by start up process?", "is_private": false, "id": 36909, "creator": "ceki@apache.org", "time": "2003-05-08T15:34:18Z", "bug_id": 19486, "creation_time": "2003-05-08T15:34:18Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "anjiloh@tecnes.com", "attachment_id": null, "text": "I've got a number of servlets starting when the servlet container starts (I set\ninto the web.xml the order using the load-on-startup tag).\n\nBefore the order was:\n1. struts (org.apache.struts.action.ActionServlet);\n2. jacob  ( mine servlet to start jacob, http://danadler.com/jacob/)\n3. log4j  (mine servlet configuring log4j, named tecnes.log.Log4JInit, and\nsetting, in a wrong way, the \nSystem.setProperty(\"org.apache.commons.logging.Log\", \"tecnes.log.LogManager\") to\nforce the other libraries, such common-digester, to use log4j)\n)\n4. jcrontab (org.jcrontab.web.loadCrontabServlet, from\nhttp://jcrontab.sourceforge.net);\n5. ConfiguratorServlet (mine servlet which configure my app)\n\nWhen I stopped and started the web application using the tomcat manager\napplication, I detected the NullPointerException, but when I stopped/started the\nWindows service the exception was not present.\n\nAfter some tests, I changed the code of tecnes.log.Log4JInit, so it now set the\nfollowing properties:\nSystem.setProperty(\"org.apache.commons.logging.Log\", \"tecnes.log.LogManager\");\nSystem.setProperty(\"org.apache.commons.logging.LogFactory\",\n\"org.apache.commons.logging.impl.Log4jFactory\");\n\nThen, I modified the web.xml changing the load-on-startup numbers. Now the\noreder is:\n\n1. log4j (tecnes.log.Log4JInit)\n2. struts (org.apache.struts.action.ActionServlet);\n3. jacob \n4. jcrontab\n5. ConfiguratorServlet\n\nand now all works and I configure the logging system (struts, my app and all the\nlibraries I use) using only a log4j.xml config file.\n\nI set this bug as \"invalid\" because my code was bugged, not log4j :-)\n\nBest regards\nAngelo", "id": 36962, "time": "2003-05-09T09:10:43Z", "bug_id": 19486, "creation_time": "2003-05-09T09:10:43Z", "is_private": false}]