[{"count": 0, "tags": [], "bug_id": 13700, "text": "When Tomcat parses a tag library descriptor the XML parser (or at least Crimson\nin my case) seems to try to load the DTD specified by the system identifier in\nthe DOCTYPE statement. The latter looks like this:\n\n<!DOCTYPE taglib PUBLIC \"-//Sun Microsystems, Inc.//DTD JSP Tag Library 1.2//EN\"\n\"http://java.sun.com/dtd/web-jsptaglibrary_1_2.dtd\">\n\nHere the system identifier is http://java.sun.com/dtd/web-jsptaglibrary_1_2.dtd\nand Crimson tries to fetch the DTD via the Internet. This a) is unnecessary\nsince the web container should already know about certain DTDs and b) is not\npossible if the web container isn't connected to the Internet).\n\nFor me that means that I cannot run my web application under Tomcat in a network\nthat is separated from the Internet. The exception I get is the following:\n\njavax.servlet.ServletException: Exception processing TLD META-INF/misc.tld in\nJAR at resource path /WEB-INF/lib/misc-taglib.jar\n        at\norg.apache.catalina.startup.ContextConfig.tldScanJar(ContextConfig.java:934)\n        at org.apache.catalina.startup.ContextConfig.tldScan(ContextConfig.java:868)\n        at org.apache.catalina.startup.ContextConfig.start(ContextConfig.java:647)\n        at\norg.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:243)\n        at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:166)\n        at org.apache.catalina.core.StandardContext.start(StandardContext.java:3493)\n        at\norg.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:821)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:807)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:579)\n        at\norg.apache.catalina.core.StandardHostDeployer.install(StandardHostDeployer.java:257)\n        at org.apache.catalina.core.StandardHost.install(StandardHost.java:772)\n        at\norg.apache.catalina.startup.HostConfig.deployDirectories(HostConfig.java:569)\n        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:411)\n        at org.apache.catalina.startup.HostConfig.start(HostConfig.java:879)\n        at\norg.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:368)\n        at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:166)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1196)\n        at org.apache.catalina.core.StandardHost.start(StandardHost.java:738)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1188)\n        at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:347)\n        at org.apache.catalina.core.StandardService.start(StandardService.java:497)\n        at org.apache.catalina.core.StandardServer.start(StandardServer.java:2191)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:510)\n        at org.apache.catalina.startup.Catalina.execute(Catalina.java:400)\n        at org.apache.catalina.startup.Catalina.process(Catalina.java:180)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:324)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:203)\n----- Root Cause -----\njava.net.ConnectException: Connection timed out\n        at org.apache.crimson.parser.Parser2.fatal(Parser2.java:3182)\n        at\norg.apache.crimson.parser.Parser2.externalParameterEntity(Parser2.java:2870)\n        at org.apache.crimson.parser.Parser2.maybeDoctypeDecl(Parser2.java:1167)\n        at org.apache.crimson.parser.Parser2.parseInternal(Parser2.java:489)\n        at org.apache.crimson.parser.Parser2.parse(Parser2.java:305)\n        at org.apache.crimson.parser.XMLReaderImpl.parse(XMLReaderImpl.java:442)\n        at org.apache.commons.digester.Digester.parse(Digester.java:1514)\n        at\norg.apache.catalina.startup.ContextConfig.tldScanStream(ContextConfig.java:977)\n        at\norg.apache.catalina.startup.ContextConfig.tldScanJar(ContextConfig.java:921)\n        at org.apache.catalina.startup.ContextConfig.tldScan(ContextConfig.java:868)\n        at org.apache.catalina.startup.ContextConfig.start(ContextConfig.java:647)\n        at\norg.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:243)\n        at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:166)\n        at org.apache.catalina.core.StandardContext.start(StandardContext.java:3493)\n        at\norg.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:821)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:807)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:579)\n        at\norg.apache.catalina.core.StandardHostDeployer.install(StandardHostDeployer.java:257)\n        at org.apache.catalina.core.StandardHost.install(StandardHost.java:772)\n        at\norg.apache.catalina.startup.HostConfig.deployDirectories(HostConfig.java:569)\n        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:411)\n        at org.apache.catalina.startup.HostConfig.start(HostConfig.java:879)\n        at\norg.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:368)\n        at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:166)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1196)\n        at org.apache.catalina.core.StandardHost.start(StandardHost.java:738)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1188)\n        at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:347)\n        at org.apache.catalina.core.StandardService.start(StandardService.java:497)\n        at org.apache.catalina.core.StandardServer.start(StandardServer.java:2191)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:510)\n        at org.apache.catalina.startup.Catalina.execute(Catalina.java:400)\n        at org.apache.catalina.startup.Catalina.process(Catalina.java:180)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:324)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:203)\n\nIs there a workaround? Do other XML parsers behave the same? If not, how can I\nconfigure Tomcat to use another XML parser?", "id": 24634, "time": "2002-10-16T16:41:10Z", "creator": "rainer.klute@epost.de", "creation_time": "2002-10-16T16:41:10Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "jfarcand@apache.org", "text": "Hi,\n\nI don't have any problems with the file you are\nhttp://java.sun.com/dtd/web-jsptaglibrary_1_2.dtd. As an example, the Admin Tool\nuses that file without any errors. And Yes, the file is redirected (we're using\nthe  jakarta-commons Digester component for that.\n\nFrom you stack trace, you seems to face a bug in Crimson. Try in with Xerces. It\nshould works.\n\n-- Jeanfrancois", "id": 24662, "attachment_id": null, "bug_id": 13700, "creation_time": "2002-10-16T20:35:10Z", "time": "2002-10-16T20:35:10Z", "is_private": false}, {"count": 2, "text": "I found the bug: The DOCTYPE declaration was actually split into two lines with\na newline inside the public identifier, like this:\n\n<!DOCTYPE taglib PUBLIC \"-//Sun Microsystems, Inc.//DTD JSP Tag Library\n1.2//EN\" \"http://java.sun.com/dtd/web-jsptaglibrary_1_2.dtd\">\n\nIt seems that Crimson does not treat the newline as white space as it should,\nconsiders the public identifier as something unknown and therefore goes to fetch\nthe DTD as denoted by the system identifier. Putting the whole DOCTYPE\ndeclaration into a single line or at least breaking the line between public and\nsystem identifier solved the problem.\n\nBTW, how can I configure Tomcat to use another XML parser?", "bug_id": 13700, "is_private": false, "id": 24756, "time": "2002-10-17T05:14:11Z", "creator": "rainer.klute@epost.de", "creation_time": "2002-10-17T05:14:11Z", "tags": [], "attachment_id": null}, {"count": 3, "text": "Under common/endorsed, just drop xercesImpl.jar and xmlParserAPIs.jar (download\nit from xml.apache.org). Now Xerces will replace Crimson... I assume you are\nusing 4.1.12.", "bug_id": 13700, "is_private": false, "id": 24782, "time": "2002-10-17T14:32:29Z", "creator": "jfarcand@apache.org", "creation_time": "2002-10-17T14:32:29Z", "tags": [], "attachment_id": null}]