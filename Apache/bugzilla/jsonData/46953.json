[{"count": 0, "attachment_id": 23435, "bug_id": 46953, "text": "Created attachment 23435\nproblem.xls\n\nI use following codes to read attached \"problem.xls\" Excel file, the Excel file contains 5 worksheets but HSSFWorkbook.getNumberOfSheets() output 1 only. And write the workbook out, it cannot be opened by MS Excel.\n\n--\n\nFileInputStream fis = new FileInputStream(\"problem.xls\");\nPOIFSFileSystem poifs = new POIFSFileSystem(fis);\nHSSFWorkbook wb = new HSSFWorkbook(poifs);\t\t\nSystem.out.println(\"wb.getNumberOfSheets() = \" + wb.getNumberOfSheets());\nFileOutputStream os = new FileOutputStream(\"problem.output.xls\");\nwb.write(os);", "id": 125941, "time": "2009-04-01T22:46:04Z", "creator": "matthew.knl@gmail.com", "creation_time": "2009-04-01T22:46:04Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "matthew.knl@gmail.com", "text": "Created attachment 23436\nproblem.output.xls", "id": 125942, "time": "2009-04-01T22:46:50Z", "bug_id": 46953, "creation_time": "2009-04-01T22:46:50Z", "is_private": false, "attachment_id": 23436}, {"count": 2, "attachment_id": null, "bug_id": 46953, "is_private": false, "id": 126005, "time": "2009-04-04T06:30:17Z", "creator": "yegor@dinom.ru", "creation_time": "2009-04-04T06:30:17Z", "tags": [], "text": "Looks like a regression introduced in r757520.\nIf I comment out the line 229 then the number of sheets is 5 and the output is readable by Excel.\n\nThe offending line:\n\n       _psBlock.addLateHeaderFooter(rs.getNext());\n \nJosh, please confirm the bug. \n\n\nYegor"}, {"count": 3, "tags": [], "text": "Since this bug is a blocker in our current project, is there any update on this bug? Thanks a lot.", "is_private": false, "bug_id": 46953, "id": 126475, "time": "2009-04-23T19:43:37Z", "creator": "matthew.knl@gmail.com", "creation_time": "2009-04-23T19:43:37Z", "attachment_id": null}, {"count": 4, "attachment_id": null, "bug_id": 46953, "text": "Fixed in svn r773412\n\njunit added\n\nIt seems like this bug was evident in existing test samples, but the junits were not checking the number of sheets in those cases.  This change is just another band-aid.  The code is long overdue for refactoring the chart/user-view stuff into dedicated RecordAggregate sub-classes.", "id": 126921, "time": "2009-05-10T14:50:53Z", "creator": "josh@apache.org", "creation_time": "2009-05-10T14:50:53Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "text": "*** Bug 47199 has been marked as a duplicate of this bug. ***", "is_private": false, "bug_id": 46953, "id": 127042, "time": "2009-05-15T11:11:48Z", "creator": "josh@apache.org", "creation_time": "2009-05-15T11:11:48Z", "attachment_id": null}]