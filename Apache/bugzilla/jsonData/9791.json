[{"count": 0, "tags": [], "bug_id": 9791, "attachment_id": null, "id": 17623, "time": "2002-06-11T20:56:53Z", "creator": "cpjunk@yeroc.ca", "creation_time": "2002-06-11T20:56:53Z", "is_private": false, "text": "Here's the situation:  We're setup with Apache v1.3.12 + mod_ssl + mod_jk +\nTomcat v4.0.3 using forms-based authentication.  Things work perfectly fine as\nlong as cookies are enabled in the browser but if cookies are disabled you can't\nlogin.  You are redirected to the login form properly but when you attempt to\nlogin you get the following Tomcat error message:\n\nApache Tomcat/4.0.3 - HTTP Status 400 - Invalid direct reference to form login page \n\nSo somehow in the interaction between the above components storage of the\noriginal URL is being lost."}, {"count": 1, "tags": [], "bug_id": 9791, "attachment_id": null, "id": 26480, "time": "2002-11-18T15:29:26Z", "creator": "Brian.Ewins@btinternet.com", "creation_time": "2002-11-18T15:29:26Z", "is_private": false, "text": "Corey, I've checked through the code and the tomcat side looks fine. Are you\nsure your login form is ok? For form based authentication without cookies, you\nneed to use URL rewriting on the form action in your login page, like so:\n\n<form action='<%= response.encodeURL(\"j_security_check\") %>'>\n\nIf you don't do this, then the session that created the login form will not be\nrequested when the login form is submitted. In particular, if you use a plain\n.htm login form instead of a jsp, you /must/ use cookies."}, {"count": 2, "attachment_id": null, "bug_id": 9791, "text": "Thanks for looking into this.  I was not aware of needing to encode the url like\nthis.  I've added the suggested fragment and it works.  Thanks!\n\nIs that documented somewhere?  If not maybe a bug should be filed against the\ndocumentation...\n\n", "id": 26583, "time": "2002-11-19T16:27:54Z", "creator": "cpjunk@yeroc.ca", "creation_time": "2002-11-19T16:27:54Z", "tags": [], "is_private": false}]