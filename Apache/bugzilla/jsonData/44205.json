[{"count": 0, "attachment_id": null, "creator": "vmahajan@amberpoint.com", "text": "On debugging I found that the cause of the problem was the\nElementProxy.getBytesFromTextChild() method. This method currently assumes that\nthe base64 certificate data is contained in the first child node of the\nX509Certificate element, which may not be true always. Here's the suggested patch:\n\n--------------------------------------------------------------\n--- ElementProxy.java.bak\t2008-01-08 12:36:08.000000000 +0530\n+++ ElementProxy.java\t2008-01-11 12:03:22.121625000 +0530\n@@ -406,10 +401,7 @@\n     */\n    public byte[] getBytesFromTextChild() throws XMLSecurityException {\n       \n-         Text t = (Text)this._constructionElement.getFirstChild();\n-                                                   \n-\n-         return Base64.decode(t.getData());\n+       return\nBase64.decode(XMLUtils.getFullTextChildrenFromElement(this._constructionElement));\n    }\n \n    /**\n--------------------------------------------------------------", "id": 112755, "time": "2008-01-10T22:37:19Z", "bug_id": 44205, "creation_time": "2008-01-10T22:37:19Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "sean.mullan@oracle.com", "text": "Can you attach a test signature that exhibits this problem? I tried to reproduce\nthis with some of the test signatures containing X509Certificate elements, but\ncould not. ", "id": 113324, "time": "2008-01-31T13:01:59Z", "bug_id": 44205, "creation_time": "2008-01-31T13:01:59Z", "is_private": false, "attachment_id": null}, {"count": 2, "attachment_id": null, "creator": "vmahajan@amberpoint.com", "text": "This can be reproduced if you sign a document and call verify on it *without*\nserializing the signed document.\n", "id": 113473, "time": "2008-02-06T03:27:33Z", "bug_id": 44205, "creation_time": "2008-02-06T03:27:33Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 44205, "attachment_id": null, "text": "Ok, I can reproduce it now and have fixed it as you suggested.", "id": 113549, "time": "2008-02-07T11:30:23Z", "creator": "sean.mullan@oracle.com", "creation_time": "2008-02-07T11:30:23Z", "is_private": false}]