[{"count": 0, "tags": [], "bug_id": 43970, "attachment_id": null, "id": 111126, "time": "2007-11-27T02:04:34Z", "creator": "u.pollaehne@seeburger.de", "creation_time": "2007-11-27T02:04:34Z", "is_private": false, "text": "The modified selector does not update the cache.\nA small test script:\n\n<project name=\"test\" default=\"test\" basedir=\".\">\n    <target name=\"init\">\n        <fileset dir=\"${basedir}\" id=\"fs\">\n            <modified seldirs=\"false\" update=\"true\">\n                <param name=\"cache.cachefile\" value=\"${basedir}/test.props\"/>\n            </modified>\n            <include name=\"*.properties\"/>\n        </fileset>\n    </target>\n    <target name=\"test\" depends=\"init\">\n        <property name=\"fs_p\" refid=\"fs\"/>\n        <echo>fs = ${fs_p}</echo>\n    </target>\n</project>\n\nRun this script in a directory with some property files.\nWith ANT 1.6.5 the cache file is created and on the second execution the fileset\nis empty.\nIf you now modify one of the property files it is recognized as modified (the\nfileset contains the file) and the cache is updated so that the next execution\nshows an empty fileset.\n\nWith ANT 1.7.0 on the first execution the cache is created. The second execution\nshows an empty fileset (ok).\nAfter modifying one of the properties the fileset contains the modified property\nfile (ok too).\nFor each subsequent execution of the script the same property file is shown as\nmodified (since the cache is not updated).\n\nIt does not matter if update=true is given explicit or implicit.\nExplicit or implicit cache filename does not matter.\nThe delayupdate=false also does not change anything."}, {"count": 1, "text": "Created attachment 21202\nmodify the the ModifiedSelector.java \n\n   /**\n    * save the cache file\n    */\n    protected void saveCache() {\n\tif (getModified() > 1) { // oupps! when your only one file to change !\n\t    cache.save();\n\t    setModified(0);\n\t}\n    }", "creator": "jeanpaul.stevens@minfin.fed.be", "attachment_id": 21202, "id": 111238, "time": "2007-11-29T00:02:25Z", "bug_id": 43970, "creation_time": "2007-11-29T00:02:25Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 43970, "attachment_id": null, "id": 111239, "time": "2007-11-29T00:46:58Z", "creator": "peterreilly@apache.org", "creation_time": "2007-11-29T00:46:58Z", "is_private": false, "text": "Thanks for the report.\nThis fix has already been done and will be be in ant 1.7.1.\n\n\n*** This bug has been marked as a duplicate of 42802 ***"}]