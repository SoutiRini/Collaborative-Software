[{"attachment_id": null, "tags": [], "bug_id": 48056, "is_private": false, "count": 0, "id": 131378, "time": "2009-10-26T02:51:09Z", "creator": "zeetaartpurf@yahoo.com", "creation_time": "2009-10-26T02:51:09Z", "text": "When submitting a post form with enctype \"multipart/form-data\", containing a file input, and at least one text input with a value containing the string \"poste\" (text is allowed before and after this string) will result in a time-out when submitted over HTTP.\n\nThis has been tested on a RedHat and Fedora server, using Apache 2.2.14 and other versions of apache.\nAll fail when this string is included.\n\nAn example form resulting in this issue is:\n\n<html>\n    <head>\n    </head>\n\n\n    <body  id=\"body\" class=\"body\">\n\n<div id=\"wrapper\">\n\n\n  <form action=\"#null\" method=\"post\" name=\"edit_metadata\" enctype=\"multipart/form-data\">\n\n    \n<input type=\"text\" name=\"dc_title\" value=\"poste\"/>\n\n<input type=\"file\" name=\"bitstream_file_type5_file5\"/>\n<input type=\"submit\" name=\"submit\" value=\"click me\"/>\n\n    </form>\n\n        </div> \n\n</body>\n</html>"}, {"count": 1, "tags": [], "creator": "covener@gmail.com", "attachment_id": null, "text": "Can you include logs, config, and a packet capture of the request that hangs?\n\nWhat handler is generating the response? Does it matter for the bug?", "id": 131383, "time": "2009-10-26T04:32:36Z", "bug_id": 48056, "creation_time": "2009-10-26T04:32:36Z", "is_private": false}, {"count": 2, "tags": [], "text": "I noticed this error is somehow browser dependent as well:\nI can process the request using Firefox on Mac and Windows, but I get no response using Safari or Camino on Mac, nor using Internet Explorer 6 or 7.\n\nThe access log contains:\n213.219.159.242 - - [26/Oct/2009:13:51:51 +0100] \"GET /test-apache/submit2.html HTTP/1.1\" 200 532\nwhen displaying the form, but no logs are present for processing the log.\n\nThe error log contains:\n[Mon Oct 26 13:59:25 2009] [error] [client 213.219.159.242] request failed: error reading the headers\n\nWhen tunneling this through a TCP Monitor, it sends out:\n\nPOST /test-apache/submit2.html HTTP/1.1\nHost: atmire.com\nAccept: application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5\nUser-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_1; nl-nl) AppleWebKit/531.9 (KHTML, like Gecko) Version/4.0.3 Safari/531.9\nOrigin: http://localhost:5555\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryOR8ylA8ZhAFLQNo4\nReferer: http://localhost:5555/test-apache/submit2.html\nAccept-Language: nl-nl\nAccept-Encoding: gzip, deflate\nCookie: __utma=111872281.626312053016873200.1229939867.1249466462.1255558105.14; __utmz=111872281.1245708531.10.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)\nContent-Length: 371\nConnection: keep-alive\n\n------WebKitFormBoundaryOR8ylA8ZhAFLQNo4\nContent-Disposition: form-data; name=\"dc_title\"\n\nposte\n------WebKitFormBoundaryOR8ylA8ZhAFLQNo4\nContent-Disposition: form-data; name=\"bitstream_file_type5_file5\"; filename=\"\"\n\n\n------WebKitFormBoundaryOR8ylA8ZhAFLQNo4\nContent-Disposition: form-data; name=\"submit\"\n\nclick me\n------WebKitFormBoundaryOR8ylA8ZhAFLQNo4--\n\nNo response is received in the TCP monitor.\n\nI am using an Apache server which is compiled from source, with as only changes to the configurations:\n* The SSL certificates (but this issue occurs while using HTTP)\n* The mod_proxy configuration (but I'm explicitly not proxying this URL to ensure this is unrelated)\n* An SVN server (also hosted on a different path)\n\n\nThe file is currently being hosted at http://atmire.com/test-apache/submit2.html", "is_private": false, "id": 131384, "creator": "zeetaartpurf@yahoo.com", "time": "2009-10-26T06:04:44Z", "bug_id": 48056, "creation_time": "2009-10-26T06:04:44Z", "attachment_id": null}, {"count": 3, "tags": [], "text": "is there any extra info needed on this issue?", "is_private": false, "id": 131563, "creator": "zeetaartpurf@yahoo.com", "time": "2009-11-02T03:43:26Z", "bug_id": 48056, "creation_time": "2009-11-02T03:43:26Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 48056, "text": "What handler is generating the response?", "id": 131565, "time": "2009-11-02T04:21:53Z", "creator": "poirier@pobox.com", "creation_time": "2009-11-02T04:21:53Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "zeetaartpurf@yahoo.com", "is_private": false, "count": 5, "id": 131568, "time": "2009-11-02T05:54:45Z", "bug_id": 48056, "creation_time": "2009-11-02T05:54:45Z", "text": "The response is being generated by the default-handler.\n\n\nTo further display the issue, I have downloaded a clean apache installation from http://apache.belnet.be/httpd/httpd-2.2.14.tar.gz\nI have installed this on a Fedora Linux testserver (2.6.26.8-57.fc8)\nI did not change anything at all to the configuration.\nand included the test file to:\nhttp://83.101.20.42/submit2.html\n\nThe click-me button still only works in firefox."}, {"count": 6, "tags": [], "bug_id": 48056, "attachment_id": null, "text": "The default handler doesn't handle POST requests. (What would you expect it to do with it?)  You need to have something set up to handle the POST request.", "id": 131569, "time": "2009-11-02T06:41:37Z", "creator": "poirier@pobox.com", "creation_time": "2009-11-02T06:41:37Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 48056, "attachment_id": null, "is_private": false, "id": 131570, "time": "2009-11-02T07:30:10Z", "creator": "zeetaartpurf@yahoo.com", "creation_time": "2009-11-02T07:30:10Z", "text": "In the original issue we had, we used mod_proxy for forwarding the request to an apache tomcat webserver.\nThe request didn't arrive at the apache tomcat if the string \"poste\" was included somewhere, while the apache HTTPD returned a time-out from the apache tomcat.\nThe request did get processed immediately if the string \"poste\" was not included.\n\nIn order to pin down the exact issue, I've removed the apache tomcat and mod_proxy from the process.\nThis is why I tried making a simple static html page instead.\nI know POST methods aren't the most logical thing to do for retrieving a static HTML, but the same POST method works if you would change the textfield to any other word not containing \"poste\".\nSo because of this, I assumed that apache had a default handler for this in a standard clean installation.\n\nBecause the same word seems to trigger the same issue, either when proxying requests to an apache tomcat, or when apache httpd is handling the request, I am assuming this is related to apache HTTPD.\n\nI am not an apache HTTPD specialist, so any hints in what I can do to further explain, or of course solve, the issue are welcome."}, {"count": 8, "tags": [], "bug_id": 48056, "attachment_id": null, "is_private": false, "id": 131573, "time": "2009-11-02T08:13:16Z", "creator": "poirier@pobox.com", "creation_time": "2009-11-02T08:13:16Z", "text": "I assume the request shown above is one that did not work.  What does a request look like that does work?"}, {"attachment_id": null, "tags": [], "bug_id": 48056, "text": "are you using anything like mod_security when it actually fails?\n\nWhat does the example URL do when it does or doesn't work?", "count": 9, "id": 131577, "time": "2009-11-02T08:43:59Z", "creator": "covener@gmail.com", "creation_time": "2009-11-02T08:43:59Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 48056, "is_private": false, "count": 10, "id": 131578, "time": "2009-11-02T08:52:48Z", "creator": "zeetaartpurf@yahoo.com", "creation_time": "2009-11-02T08:52:48Z", "text": "I am not using mod_security, I have even used a default installation of apache without any changes to the configuration, or without any extra modules to ensure this issue wasn't related to any external applications, or to any configuration settings.\n\n\nWhen tunneling a working request through a TCP monitor, I send the request:\n\n\n\nPOST /test-apache/submit2.html HTTP/1.1\nHost: atmire.com\nAccept:\napplication/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5\nUser-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_1; nl-nl)\nAppleWebKit/531.9 (KHTML, like Gecko) Version/4.0.3 Safari/531.9\nOrigin: http://localhost:5555\nContent-Type: multipart/form-data;\nboundary=----WebKitFormBoundaryVyCKgwIrA86n1Acg\nReferer: http://localhost:5555/test-apache/submit2.html\nAccept-Language: nl-nl\nAccept-Encoding: gzip, deflate\nCookie:\n__utma=111872281.626312053016873200.1229939867.1255558105.1256668835.15;\n__utmz=111872281.1245708531.10.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)\nContent-Length: 393\nConnection: keep-alive\n\n------WebKitFormBoundaryVyCKgwIrA86n1Acg\nContent-Disposition: form-data; name=\"dc_title\"\n\ntesting with a working page\n------WebKitFormBoundaryVyCKgwIrA86n1Acg\nContent-Disposition: form-data; name=\"bitstream_file_type5_file5\"; filename=\"\"\n\n\n------WebKitFormBoundaryVyCKgwIrA86n1Acg\nContent-Disposition: form-data; name=\"submit\"\n\nclick me\n------WebKitFormBoundaryVyCKgwIrA86n1Acg--\n\n\n\nAnd I receive the response:\n\n\n\nHTTP/1.1 200 OK\nDate: Mon, 02 Nov 2009 16:42:44 GMT\nServer: Apache/2.2.14 (Unix) mod_ssl/2.2.14 OpenSSL/0.9.7a DAV/2 SVN/1.6.5\nLast-Modified: Mon, 26 Oct 2009 12:35:20 GMT\nETag: \"38f934-214-476d5cb6ef200\"\nAccept-Ranges: bytes\nContent-Length: 532\nKeep-Alive: timeout=5, max=100\nConnection: Keep-Alive\nContent-Type: text/html\n\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\n\"http://info.togather.eu/togather-test/DTD/xhtml1-transitional.dtd\">\n\n<html>\n    <head>\n    </head>\n\n\n    <body  id=\"body\" class=\"body\">\n\n<div id=\"wrapper\">\n\n\n  <form action=\"submit2.html\" method=\"post\" name=\"edit_metadata\"\nenctype=\"multipart/form-data\">\n\n<input type=\"text\" name=\"dc_title\" value=\"poste\"/>\n\n<input type=\"file\" name=\"bitstream_file_type5_file5\"/>\n<input type=\"submit\" name=\"submit\" value=\"click me\"/>\n\n    </form>\n\n        </div> \n\n</body>\n</html>\n\n\n\nWhich is simply a display of the test page."}, {"attachment_id": null, "tags": [], "creator": "poirier@pobox.com", "is_private": false, "count": 11, "id": 131579, "time": "2009-11-02T08:57:50Z", "bug_id": 48056, "creation_time": "2009-11-02T08:57:50Z", "text": "No, I meant what does a request including \"poste\" look like when it's sent from a browser where it works."}, {"count": 12, "tags": [], "creator": "zeetaartpurf@yahoo.com", "text": "When posting the same request from firefox, the browser sends:\n\n\n\nHost\t83.101.20.42\nUser-Agent\tMozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; nl; rv:1.9.1.4) Gecko/20091016 Firefox/3.5.4\nAccept\ttext/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language\tfr,nl;q=0.8,en-us;q=0.5,en;q=0.3\nAccept-Encoding\tgzip,deflate\nAccept-Charset\tUTF-8,*\nKeep-Alive\t300\nConnection\tkeep-alive\nReferer\thttp://83.101.20.42/submit2.html\nCookie\t__utma=128795845.2825047967790454000.1237476472.1254843661.1254850172.45; __utmz=128795845.1254838596.43.1.utmccn=(direct)|utmcsr=(direct)|utmcmd=(none)\n\nContent-Type: multipart/form-data; boundary=---------------------------161692722414377846301360280366\nContent-Length: 487\n\n-----------------------------161692722414377846301360280366\nContent-Disposition: form-data; name=\"dc_title\"\n\nposte\n-----------------------------161692722414377846301360280366\nContent-Disposition: form-data; name=\"bitstream_file_type5_file5\"; filename=\"\"\nContent-Type: application/octet-stream\n\n\n-----------------------------161692722414377846301360280366\nContent-Disposition: form-data; name=\"submit\"\n\nclick me\n-----------------------------161692722414377846301360280366--\n\n\n\nAnd I get an immediate answer which is the contents of the webpage at http://83.101.20.42/submit2.html", "id": 131615, "time": "2009-11-03T05:51:20Z", "bug_id": 48056, "creation_time": "2009-11-03T05:51:20Z", "is_private": false, "attachment_id": null}, {"count": 13, "text": "When I use IE, the post is split into two TCP packets and the 2nd one is retransmitted over and over. The host Apache is running on has not acknowledged it, presumably because some intermedia is intercepting the packet and dropping it.\n\nIf the host doesn't even see it, Apache has no change of reading it and completing the request.\n\nCan you show a binary, unformatted, unlimited capture-length packet capture on the Apache system that shows all the bytes arriving? If not, there's no Apache bug.", "bug_id": 48056, "is_private": false, "id": 131618, "time": "2009-11-03T06:29:49Z", "creator": "covener@gmail.com", "creation_time": "2009-11-03T06:29:49Z", "tags": [], "attachment_id": null}, {"count": 14, "tags": [], "bug_id": 48056, "attachment_id": null, "id": 131631, "time": "2009-11-03T10:22:40Z", "creator": "zeetaartpurf@yahoo.com", "creation_time": "2009-11-03T10:22:40Z", "is_private": false, "text": "I can indeed see packages being retransmitted by internet explorer, while none of these package can be detected on the server.\nAlthough I still can't see what is causing this issue, I do understand that it's not an Apache issue.\n\nThank you for the great assistance."}, {"count": 15, "tags": [], "bug_id": 48056, "attachment_id": null, "is_private": false, "id": 131633, "time": "2009-11-03T10:50:23Z", "creator": "covener@gmail.com", "creation_time": "2009-11-03T10:50:23Z", "text": "marking invalid, please reset status if the guilt swings back to Apache."}]