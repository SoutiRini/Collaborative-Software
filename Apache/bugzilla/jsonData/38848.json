[{"count": 0, "tags": [], "creator": "ronnie.brunner@netcetera.ch", "attachment_id": null, "is_private": false, "id": 86471, "time": "2006-03-04T00:04:12Z", "bug_id": 38848, "creation_time": "2006-03-04T00:04:12Z", "text": "If httpd is running in single process debug mode (-X commandline option), it\ndoes not properly respond to stop (SIGTERM), graceful (SIGUSR1), graceful-stop\n(SIGWINCH) and probably other signals.\n\nExcept for a kill -9, the process cannot be terminated anymore and there is no\nway to properly shutdown the process.\n\n(BTW: I guess it's on newer versions as well but I didn't know hoe to cekc out\nworking head version of either 2.2 or 2.3)"}, {"count": 1, "tags": [], "creator": "sander@temme.net", "attachment_id": null, "is_private": false, "id": 86479, "time": "2006-03-04T07:51:53Z", "bug_id": 38848, "creation_time": "2006-03-04T07:51:53Z", "text": "FWIW I'm seeing the same thing on Darwin on my Powerbook. \n\nControl-C (which I think sends a SIGINT) also doesn't give me a reaction. It's as if we go through the \ntrouble of ignoring the signals (default for most signals is to terminate the program), but don't register \nhandlers when in -X mode. \n\nInterestingly, httpd reacts to ^C when run under -X. Maybe gdb plants its own handler? \n\nTrunk is also affected. \n\nSome notes on checking out the development trunk at http://httpd.apache.org/dev/devnotes.html . \n\nIn short, you get the latest and greatest as follows: \n\n$ svn co http://svn.apache.org/repos/asf/httpd/httpd/trunk httpd-trunk \n$ cd httpd-trunk/srclib/apr\n$ svn co http://svn.apache.org/repos/asf/apr/apr/trunk apr\n$ svn co http://svn.apache.org/repos/asf/apr/apr-util/trunk apr-util"}, {"count": 2, "tags": [], "text": "I was playing around with this, and I can \"fix\" the problem with the following\nchange:\n\nIndex: server/mpm/prefork/prefork.c\n===================================================================\n--- server/mpm/prefork/prefork.c        (revision 383230)\n+++ server/mpm/prefork/prefork.c        (working copy)\n@@ -536,7 +536,7 @@\n\n     bucket_alloc = apr_bucket_alloc_create(pchild);\n\n-    while (!die_now) {\n+    while (!die_now && !shutdown_pending) {\n         conn_rec *current_conn;\n         void *csd;\n\n\nI'm not sure if this is correct though, and I'm not sure when this problem\nstarted.  svn blame and poking around areas of the code related to die_now and\nshutdown_pending didn't show any particularly promising changes, mostly stuff\nfrom way the hell back in the day.\n\nDidn't try to fix the problem on non-prefork MPMs, but I do recall noticing it\nwith worker a while back.", "attachment_id": null, "bug_id": 38848, "id": 86488, "time": "2006-03-05T03:51:26Z", "creator": "rooneg@electricjellyfish.net", "creation_time": "2006-03-05T03:51:26Z", "is_private": false}, {"count": 3, "tags": [], "text": "I tried your patch and it did allow me to terminate httpd with Ctrl-C. However\nsemaphores don't get released (the real problem IMHO), thus I still have to run\nipcrm every once in a while.\n\nBtw, you can kill httpd without patching by hitting Ctrl-\\ (SIGQUIT).", "attachment_id": null, "bug_id": 38848, "id": 106391, "time": "2007-08-06T08:30:35Z", "creator": "becarre@free.fr", "creation_time": "2007-08-06T08:30:35Z", "is_private": false}, {"count": 4, "tags": [], "creator": "jorton@redhat.com", "attachment_id": null, "id": 109248, "time": "2007-10-11T06:57:20Z", "bug_id": 38848, "creation_time": "2007-10-11T06:57:20Z", "is_private": false, "text": "This was committed as: http://svn.apache.org/viewvc?view=rev&rev=552029"}]