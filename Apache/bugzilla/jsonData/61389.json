[{"count": 0, "tags": [], "text": "Eclipse Scripts fail to to load stylesheets with JDK 9 and Ant 1.10.1\n\njavax.xml.transform.TransformerException: java.lang.RuntimeException: Use of the extension function 'xalan://java.lang.String:replaceAll' is not allowed when the secure processing feature is set to true.\n\tat org.apache.tools.ant.taskdefs.XSLTProcess.handleTransformationError(XSLTProcess.java:1449)\n\tat org.apache.tools.ant.taskdefs.XSLTProcess.process(XSLTProcess.java:856)\n\tat org.apache.tools.ant.taskdefs.XSLTProcess.execute(XSLTProcess.java:437)\n\tat org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:293)\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:564)\n\tat org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)\n\tat org.apache.tools.ant.Task.perform(Task.java:348)\n\tat org.apache.tools.ant.Target.execute(Target.java:435)\n\tat org.apache.tools.ant.Target.performTasks(Target.java:456)\n\tat org.apache.tools.ant.Project.executeSortedTargets(Project.java:1405)\n\tat org.apache.tools.ant.helper.SingleCheckExecutor.executeTargets(SingleCheckExecutor.java:38)\n\tat org.eclipse.ant.internal.launching.remote.EclipseSingleCheckExecutor.executeTargets(EclipseSingleCheckExecutor.java:34)\n\tat org.apache.tools.ant.Project.executeTargets(Project.java:1260)\n\tat org.apache.tools.ant.taskdefs.Ant.execute(Ant.java:441)\n\t... 17 more\nCaused by: javax.xml.transform.TransformerException: java.lang.RuntimeException: Use of the extension function 'xalan://java.lang.String:replaceAll' is not allowed when the secure processing feature is set to true.\n\tat java.xml/com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(TransformerImpl.java:790)\n\tat java.xml/com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(TransformerImpl.java:377)\n\tat org.apache.tools.ant.taskdefs.optional.TraXLiaison.transform(TraXLiaison.java:205)\n\tat org.apache.tools.ant.taskdefs.XSLTProcess.process(XSLTProcess.java:847)\n\t... 32 more\nCaused by: java.lang.RuntimeException: Use of the extension function 'xalan://java.lang.String:replaceAll' is not allowed when the secure processing feature is set to true.\n\tat java.xml/com.sun.org.apache.xalan.internal.xsltc.runtime.BasisLibrary.runTimeError(BasisLibrary.java:1621)\n\tat java.xml/com.sun.org.apache.xalan.internal.xsltc.runtime.BasisLibrary.runTimeError(BasisLibrary.java:1625)\n\tat java.xml/com.sun.org.apache.xalan.internal.xsltc.runtime.BasisLibrary.unallowed_extension_functionF(BasisLibrary.java:453)\n\tat jdk.translet/die.verwandlung.JUNIT.JS$dash$escape()\n\tat jdk.translet/die.verwandlung.JUNIT.template$dot$5()\n\tat jdk.translet/die.verwandlung.JUNIT.applyTemplates()\n\tat jdk.translet/die.verwandlung.JUNIT.template$dot$0()\n\tat jdk.translet/die.verwandlung.JUNIT.applyTemplates()\n\tat jdk.translet/die.verwandlung.JUNIT.applyTemplates()\n\tat jdk.translet/die.verwandlung.JUNIT.transform()\n\tat java.xml/com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet.transform(AbstractTranslet.java:624)\n\tat java.xml/com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(TransformerImpl.java:783)\n\t... 35 more", "is_private": false, "id": 200227, "creator": "sarika.sinha@in.ibm.com", "time": "2017-08-08T03:56:32Z", "bug_id": 61389, "creation_time": "2017-08-08T03:56:32Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "sarika.sinha@in.ibm.com", "attachment_id": null, "text": "Eclipse Bug -\nhttps://bugs.eclipse.org/bugs/show_bug.cgi?id=506430", "id": 200228, "time": "2017-08-08T03:57:36Z", "bug_id": 61389, "creation_time": "2017-08-08T03:57:36Z", "is_private": false}, {"count": 2, "tags": [], "text": "We had a similar problem with our own unit tests, see bug 60060\n\nhttp://ant.apache.org/manual/Tasks/style.html says:\n\n> Note on XSLT extension functions: when using the default TraX implementation of the Java class library and a SecurityManager is active - e.g. when running from within an IDE - XSLT extension functions cannot be used as \"secure processing\" is active in Java 7 and above. Ant contains a special \"hack\" that allows XSLT extensions to be used in Java 7 and 8, but this hack fails for Java 9. If you want to use extensions like the redirect extension that are provided by the Java class library itself, you can allow them by enabling the feature http://www.oracle.com/xml/jaxp/properties/enableExtensionFunctions in Java 9 and above. If you need to use an extension function not provided by Java itself you can set the attribute jdk.xml.transform.extensionClassLoader to a classloader (reference to an Ant PATH-like structure).\n\nHave you tried setting http://www.oracle.com/xml/jaxp/properties/enableExtensionFunctions  to true?", "is_private": false, "id": 200246, "creator": "bodewig@apache.org", "time": "2017-08-09T09:56:07Z", "bug_id": 61389, "creation_time": "2017-08-09T09:56:07Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 61389, "text": "Will try out the option.", "id": 200274, "time": "2017-08-11T03:27:57Z", "creator": "sarika.sinha@in.ibm.com", "creation_time": "2017-08-11T03:27:57Z", "is_private": false, "attachment_id": null}, {"count": 4, "attachment_id": null, "bug_id": 61389, "text": "any news?", "id": 200623, "time": "2017-09-03T15:21:35Z", "creator": "bodewig@apache.org", "creation_time": "2017-09-03T15:21:35Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "bug_id": 61389, "attachment_id": null, "is_private": false, "id": 202437, "time": "2017-11-28T05:35:05Z", "creator": "sarika.sinha@in.ibm.com", "creation_time": "2017-11-28T05:35:05Z", "text": "Yes, we are able to with by using \nfactory.setFeature(\"http://www.oracle.com/xml/jaxp/properties/enableExtensionFunctions\", Boolean.TRUE); \n\nCan we use this for Java 8 as well as I see it mentioned on the help page that there was a hack for Java8 and Java7 which doesn't work now."}, {"count": 6, "tags": [], "text": "The Java7/8 hack is still in place and used unless Ant detects it is running on Java9+. So you don't need to set the feature.\n\nUnfortunately I assume trying to set the feature on Java8 may fail, so setting it unconditionally could cause problems on older JVMs. I'm not sure, though, the feature may as well simply get ignored and all would be well.\n\nFor org.apache.tools.ant.taskdefs.optional.junit.AggregateTransformer we only set it if we detect Java9 and are sure the XSLT processor is the one of the classlib and not a manually configured Xalan.", "is_private": false, "id": 202448, "creator": "bodewig@apache.org", "time": "2017-11-28T15:55:27Z", "bug_id": 61389, "creation_time": "2017-11-28T15:55:27Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 61389, "attachment_id": null, "text": "Thanks for the help.", "id": 202461, "time": "2017-11-29T03:45:19Z", "creator": "sarika.sinha@in.ibm.com", "creation_time": "2017-11-29T03:45:19Z", "is_private": false}, {"count": 8, "tags": [], "text": "When we run Eclipse in headless mode we are getting this exception - \n[xslt] Failed to load org.apache.xalan.processor.TransformerFactoryImpl via the configured classpath, will try Ant's classpath instead.\n     [xslt] Failed to process null \n\nSo problem I suppose is that java.xml/com.sun.org.apache.xalan.internal.xsltc.trax containing TransformerFactoryImpl in Java 9 is not exported in java.xml module.\nSo we tried adding --add-exports java.xml/com.sun.org.apache.xalan.internal.xsltc.trax=ALL-UNNAMED where we call Eclipse java program in headless mode.\n\nCan you suggest where to set this attribute or how to provide this information to xslt?", "is_private": false, "id": 203214, "creator": "sarika.sinha@in.ibm.com", "time": "2018-01-11T07:08:08Z", "bug_id": 61389, "creation_time": "2018-01-11T07:08:08Z", "attachment_id": null}, {"count": 9, "attachment_id": null, "bug_id": 61389, "text": "(In reply to Sarika Sinha from comment #8)\n> When we run Eclipse in headless mode we are getting this exception - \n> [xslt] Failed to load org.apache.xalan.processor.TransformerFactoryImpl via\n> the configured classpath, will try Ant's classpath instead.\n>      [xslt] Failed to process null \n\nThis means the class \"org.apache.xalan.processor.TransformerFactoryImpl\" hasn't been found. This seems to be the \"name\" attribute you've provided to the factory element of your xslt task.\n\nThis is not the class name of the transformer provided by JDK9 as far as I know. It is the name Apache Xalan would use when you add Xalan to your task's classpath.\n\n> So problem I suppose is that\n> java.xml/com.sun.org.apache.xalan.internal.xsltc.trax containing\n> TransformerFactoryImpl in Java 9 is not exported in java.xml module.\n> So we tried adding --add-exports\n> java.xml/com.sun.org.apache.xalan.internal.xsltc.trax=ALL-UNNAMED where we\n> call Eclipse java program in headless mode.\n\nIf you anted to use that, you must certainly use the correct package in the name attribute as well.\n\n> Can you suggest where to set this attribute or how to provide this\n> information to xslt?\n\nMy first suggestion is to not specify a name attribute for the factory at all but rather do with the default provided by the Jvaa runtime.\n\nI must admit I haven't got any idea why things should be different in headless mode.", "id": 203266, "time": "2018-01-15T08:08:02Z", "creator": "bodewig@apache.org", "creation_time": "2018-01-15T08:08:02Z", "tags": [], "is_private": false}, {"count": 10, "tags": [], "bug_id": 61389, "text": "Thanks Stefan for the suggestion, Yes using the default factory worked out.", "id": 203282, "time": "2018-01-16T04:46:57Z", "creator": "sarika.sinha@in.ibm.com", "creation_time": "2018-01-16T04:46:57Z", "is_private": false, "attachment_id": null}]