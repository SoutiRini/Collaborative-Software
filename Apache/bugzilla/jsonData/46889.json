[{"count": 0, "tags": [], "creator": "ptorrodellas@fihoca.com", "attachment_id": null, "is_private": false, "id": 125691, "time": "2009-03-23T01:43:14Z", "bug_id": 46889, "creation_time": "2009-03-23T01:43:14Z", "text": "Monitor Results reports erroneous thread load when application server has more thant one connector, because method calculateThreadLoad(Status stat) in class org.apache.jmeter.monitor.util.Stats retrieves thread usage only for the first connector in the server status XML file. \n\nFor example, if the first connector in the file happens to be a seldom used one (e.g. a HTTPS port), thread load is reported as 0% when in fact the real thread usage for the main (HTTP) connector may be heavy.\n\nMethod calculateThreadLoad should be changed to add the values for all connectors before calculating the load, for example:\n\npublic static int calculateThreadLoad(Status stat) {\n   int max = 0;\n   int current = 0;\n   int load = 0;\n   if (stat != null && stat.getConnector().size() > 0) {         \n      Connector cntr = null;\n      for(Iterator it = stat.getConnector().iterator(); it.hasNext();) {\n         cntr = (Connector)it.next();\n         max += cntr.getThreadInfo().getMaxThreads();\n         current += cntr.getThreadInfo().getCurrentThreadsBusy();\n      }\n      load = (int) (((double)current / (double)max) * 100);\n   }\n   return load;\n}\n\nBetter yet: Monitor Results definition panel could provide a \"Connector to monitor for thread usage\" input field to input a specific connector name, defaulting to \"All\" (and thus to the code above), or maybe it could be specifyed as a jmeter property?"}, {"count": 1, "tags": [], "bug_id": 46889, "attachment_id": null, "id": 125692, "time": "2009-03-23T02:57:26Z", "creator": "sebb@apache.org", "creation_time": "2009-03-23T02:57:26Z", "is_private": false, "text": "\n\n*** This bug has been marked as a duplicate of bug 40045 ***"}]