[{"count": 0, "tags": [], "text": "In Tomcat 6, it used to send Cluster Payload as part of start() and stop() method.\n\nIn Tomcat 7, the functionality is missing fro startInternal() and stopInternal() methods.\n\nTomcat 7 Current Implementation for SimpleTcpCluster.java\n========================================================================\n@Override\n    protected void startInternal() throws LifecycleException {\n\n        if (log.isInfoEnabled()) log.info(\"Cluster is about to start\");\n\n        fireLifecycleEvent(BEFORE_START_EVENT, this); --> This line missing which was present in Tomcat 6\n        try {\n            checkDefaults();\n            registerClusterValve();\n            channel.addMembershipListener(this);\n            channel.addChannelListener(this);\n            channel.start(channelStartOptions);\n            if (clusterDeployer != null) clusterDeployer.start();\n            //register JMX objects\n            ClusterJmxHelper.registerDefaultCluster(this);\n            // Notify our interested LifecycleListeners\n        } catch (Exception x) {\n            log.error(\"Unable to start cluster.\", x);\n            throw new LifecycleException(x);\n        }\n        fireLifecycleEvent(AFTER_START_EVENT, this);--> This line missing which was present in Tomcat 6\n\n        setState(LifecycleState.STARTING);\n    }\n\n\n========================================================================", "is_private": false, "id": 158444, "creator": "saplenm@yahoo.com", "time": "2012-04-26T06:31:46Z", "bug_id": 53151, "creation_time": "2012-04-26T06:31:46Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "Similar issue present for stopInternal() Method.", "attachment_id": null, "id": 158445, "creation_time": "2012-04-26T06:34:51Z", "time": "2012-04-26T06:34:51Z", "creator": "saplenm@yahoo.com", "bug_id": 53151, "is_private": false}, {"count": 2, "tags": [], "bug_id": 53151, "is_private": false, "id": 158462, "attachment_id": null, "creator": "kfujino@apache.org", "creation_time": "2012-04-27T04:20:25Z", "time": "2012-04-27T04:20:25Z", "text": "Life-cycle implementation was refactored in Tomcat7 .\nAs the result, SimpleTcpCluster in Tomcat7 has inherited LifecycleBase and LifecycleBase notifies a life cycle event. \nTherefore, the upper code is unnecessary to the SimpleTcpCluster in Tomcat7. \n\nHowever, as the side effects of this refactoring, \nIn Tomcat7.0, instance of SimpleTcpCluster is no longer set to the data field of LifecycleEvent. \nIn Tomcat6, it was set as the second argument. \nTherefore, if your LifecycleListener used getData() method in order to get instance of SimpleTcpCluster, \nyou must use getLifecycle() method instead of getData() method."}, {"count": 3, "tags": [], "text": "Thanks Keiichi for the detailed reply. Appreciated!\n\nThanks\n\nNilesh", "attachment_id": null, "id": 158464, "creator": "saplenm@yahoo.com", "time": "2012-04-27T06:01:48Z", "bug_id": 53151, "creation_time": "2012-04-27T06:01:48Z", "is_private": false}]