[{"count": 0, "tags": [], "text": "when using mod_rewrite to redirect whenever an env-variable is set\nit fails matching the RewriteCond described in \nhttp://httpd.apache.org/docs/mod/mod_rewrite.html#RewriteCond  (Special Note: 2)\n\nan example configuration that fails is:\n\nRewriteEngine   On                                                             \n                                                                               \n                                                   \nRewriteLog      /tmp/rewrite.log                                               \n                                                                               \n                                                   \nRewriteLogLevel 9                                                              \n                                                                               \n                                                   \n                                                                               \n                                                          RewriteCond\n%{ENV:HTTP_HOST}  domain                                                       \n                                                                               \n                        \nRewriteRule  ^/$    http://another.domain  [R]          \n\n/tmp/rewrite.log says:\n(2) init rewrite engine with requested uri /\n(3) applying pattern '^/$' to uri '/'\n(4) RewriteCond: input='' pattern='domain' => not-matched\n(1) pass through /\n\nin this case in env-variable is just _not_ substituted, as input=''.\nwhen i'm using \n  RewriteCond %{HTTP_HOST}       domain\ninstead of\n  RewriteCond %{ENV:HTTP_HOST}  domain\neverything works well (even debug-messages in /tmp/rewrite.log are ok)\n\nunfortunately it's not as simple as using the working version instead of the\nbroken, but i need to rewrite based on environment-variables that are no\napache-server-variables.\n\nwhen testing wheather the env-variable is correctly set, using a simple cgi,\nit displays correct values for the env-variable.", "is_private": false, "id": 76429, "creator": "pilop@difu.de", "time": "2005-06-15T20:19:46Z", "bug_id": 35375, "creation_time": "2005-06-15T20:19:46Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "HTTP_HOST does not exist in the environment.  It is only put there when calling\nCGI and SSI scripts.  So it is not surprise that mod_rewrite can't use it as\nsuch, and that is exactly the reason that mod_rewrite provides the HTTP_HOST\nvariable directly.\n\nIt sounds like you may have some other problem with another variable, but your\nexample does not demonstrate a bug.", "is_private": false, "bug_id": 35375, "id": 76431, "time": "2005-06-15T22:10:56Z", "creator": "slive@apache.org", "creation_time": "2005-06-15T22:10:56Z", "attachment_id": null}, {"count": 2, "tags": [], "text": "in fact i'm refering to HTTP_X_FORWARDED_HOST which should be an HTTP-variable,\nbut isn't usable with %{HTTP:HTTP_X_FORWARDED_HOST}.", "is_private": false, "bug_id": 35375, "id": 76470, "time": "2005-06-16T13:56:22Z", "creator": "pilop@difu.de", "creation_time": "2005-06-16T13:56:22Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 35375, "is_private": false, "id": 76471, "attachment_id": null, "creator": "slive@apache.org", "creation_time": "2005-06-16T15:20:56Z", "time": "2005-06-16T15:20:56Z", "text": "It sounds to me like you haven't read the CGI spec.\n\nCGI variables that start in HTTP_ are created from HTTP request headers with the\nHTTP_ being tagged on to avoid namespace conflicts and with '-' converted to\n'_'.  So to get at this variable in mod_rewrite, you would use\n%{HTTP:X-Forwarded-For}.\n\nI'll also point out a much better place to ask questions like this:\nhttp://httpd.apache.org/userslist.html"}]