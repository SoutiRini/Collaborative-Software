[{"count": 0, "tags": [], "bug_id": 54977, "attachment_id": null, "id": 167225, "time": "2013-05-15T18:39:06Z", "creator": "chrisryp@gmail.com", "creation_time": "2013-05-15T18:39:06Z", "is_private": false, "text": "Currently, in JsseSSLManager the alias selection is managed soley by the incrementing key index value. The user cannot override the selection of a specific client alias for a thread in ThreadGroup. This makes testing Mutual SSL auth impossible to do if each thread must be assigned a specific client alias. One potential approach is to handle this is to allow the user to define a hint variable in the thread and parse that in WrappedX509KeyManager.chooseClientAlias() as such:\n\n> diff JsseSSLManager.java JsseSSLManager.java.proposed \n42a43\n> import org.apache.jmeter.threads.JMeterContextService;\n397c398,407\n<             String alias = this.store.getAlias();\n---\n>             \n>             // Give the user a choice to select the alias by reading an alias hint from\n>             // a thread local variable\n>             String aliasHint = \n>                     JMeterContextService.getContext().getVariables().\n>                     get(\"jmeter.keystore.alias.hint\");\n>             String alias = aliasHint;\n>             if (alias == null) {\n>                 alias = this.store.getAlias();\n>             }\n\n\nA better, long term approach is to improve KeyStoreConfiguration to allow a thread local variable to specify the alias for the cert key but this requires the SSLManager to not be a singleton or to process thread local variables as above.\n\nNote that chooseClientAlias() has a comment currently that suggests allowing the user to choose the client alias is already on the TODO list:\n TODO? - does not actually allow the user to choose an alias at present"}, {"count": 1, "text": "Created attachment 31134\nPatch proposal that implements this feature\n\nHello,\nPlease find attached a patch that implements the described feature.\nNote by the way it fixes the following:\n- When certificates are not found, IllegalArgumentException or IllegalStateException are thrown making debug much easier\n- SSLManager#getKeyStore has been synchronized to avoid synchronization issues if Preload is set to false and performance issues due to as many loads as there are threads in worst case\n\n\nAs always, we grant full rights to use, modify, do anything project wants to do with classes as per our signed CLA.", "creator": "support@ubikloadpack.com", "attachment_id": 31134, "id": 171837, "time": "2013-12-19T20:30:24Z", "bug_id": 54977, "creation_time": "2013-12-19T20:30:24Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "support@ubikloadpack.com", "attachment_id": 31135, "id": 171838, "time": "2013-12-19T20:31:44Z", "bug_id": 54977, "creation_time": "2013-12-19T20:31:44Z", "is_private": false, "text": "Created attachment 31135\nScreenshot showing KeystoreConfig"}, {"count": 3, "tags": [], "creator": "support@ubikloadpack.com", "is_private": false, "text": "Created attachment 31136\nPlan showing how to use feature", "id": 171839, "time": "2013-12-19T20:34:48Z", "bug_id": 54977, "creation_time": "2013-12-19T20:34:48Z", "attachment_id": 31136}, {"count": 4, "tags": [], "bug_id": 54977, "attachment_id": null, "id": 171840, "time": "2013-12-19T20:57:11Z", "creator": "support@ubikloadpack.com", "creation_time": "2013-12-19T20:57:11Z", "is_private": false, "text": "Date: Thu Dec 19 20:56:21 2013\nNew Revision: 1552423\n\nURL: http://svn.apache.org/r1552423\nLog:\nBug 54977 - Ability to choose the client alias for the cert key in JsseSslManager such that Mutual SSL auth testing can be made more flexible\nBugzilla Id: 54977\n\nModified:\n    jmeter/trunk/docs/images/screenshots/keystore_config.png\n    jmeter/trunk/src/components/org/apache/jmeter/config/KeystoreConfig.java\n    jmeter/trunk/src/components/org/apache/jmeter/config/KeystoreConfigBeanInfo.java\n    jmeter/trunk/src/components/org/apache/jmeter/config/KeystoreConfigResources.properties\n    jmeter/trunk/src/components/org/apache/jmeter/config/KeystoreConfigResources_fr.properties\n    jmeter/trunk/src/core/org/apache/jmeter/util/JsseSSLManager.java\n    jmeter/trunk/src/core/org/apache/jmeter/util/SSLManager.java\n    jmeter/trunk/src/core/org/apache/jmeter/util/keystore/JmeterKeyStore.java\n    jmeter/trunk/xdocs/changes.xml\n    jmeter/trunk/xdocs/images/screenshots/keystore_config.png\n    jmeter/trunk/xdocs/usermanual/component_reference.xml"}, {"count": 5, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "attachment_id": null, "is_private": false, "id": 171842, "time": "2013-12-19T21:00:59Z", "bug_id": 54977, "creation_time": "2013-12-19T21:00:59Z", "text": "Thanks for patch , applied with minor changes on message labels.\n\nPS : Next time, wait for a JMeter commiter to put the commit mail message and mark bug as resolved."}]