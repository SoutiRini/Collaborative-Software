[{"count": 0, "tags": [], "creator": "salikh.zakirov@intel.com", "attachment_id": null, "text": "the current implementation of apr_thread_cond_signal() on Windows\nhas a deficiency: it may lose several concurrent or sequential\napr_thread_cond_signal() calls if more than one thread is waiting on a condition\nvariable, because there is no count of the number of signal() calls,\nand only one woken up thread will really come out of the loop.\n\nAs far as I can see, APR condition variables are meant as a portable\nreplacement for pthread condition variable, however, the lost signal()\nbehaviour is not compliant with pthread_cond_signal() specification [1]:\n\n\tThe pthread_cond_signal() function shall unblock at least one of the\n\tthreads that are blocked on the specified condition variable cond\n\t(if any threads are blocked on cond).\n\nDRLVM [2] is using APR as its porting layer, however, due to the lost signal()\nissue it is forced to use its own implementation of conditional variables,\ncurrently arranged as an APR patch [3] (not really a patch, but a couple of\nfiles replaced).\n\n[1] http://www.unix.org/single_unix_specification/, pthread_cond_signal() page\n[2] http://harmony.apache.org/subcomponents/drlvm/index.html\n[3]\nhttp://svn.apache.org/viewvc/harmony/enhanced/drlvm/trunk/build/patches/win/APR/locks/win32/thread_cond.c?view=markup\nhttp://svn.apache.org/viewvc/harmony/enhanced/drlvm/trunk/build/patches/win/APR/include/arch/win32/apr_arch_thread_cond.h?view=markup", "id": 97315, "time": "2006-12-26T05:41:44Z", "bug_id": 41243, "creation_time": "2006-12-26T05:41:44Z", "is_private": false}, {"count": 1, "tags": [], "creator": "wrowe@apache.org", "attachment_id": null, "text": "Would be happy to review this if presented as a 'minimalist patch'.\n\nWholesale refactorings are very expensive to review in terms of reviewers\ntime, so I can't in good faith tag this as PatchAvailable.", "id": 101830, "time": "2007-04-17T17:33:03Z", "bug_id": 41243, "creation_time": "2007-04-17T17:33:03Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 41243, "is_private": false, "id": 102689, "creation_time": "2007-04-30T12:18:06Z", "time": "2007-04-30T12:18:06Z", "creator": "davi@apache.org", "text": "There should be no count of the number of signal() calls, if no threads are waiting\non the condition variable (on the time of the signal/broadcast call) nothing happens.", "attachment_id": null}]