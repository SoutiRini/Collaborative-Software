[{"count": 0, "tags": [], "bug_id": 41014, "attachment_id": null, "text": "On Debian Sarge 3.1 rev2, httpd compiled with external libpcre 4.x and some\nRewriteRules segfault occurs every time we start the daemon.\nWith a stacktrace : \n#0  0xb7c66094 in mallopt () from /lib/tls/i686/cmov/libc.so.6\n#1  0xb7c64ffb in free () from /lib/tls/i686/cmov/libc.so.6\n#2  0xb7ca7bc3 in regfree () from /lib/tls/i686/cmov/libc.so.6\n#3  0x080b9676 in regex_cleanup ()\n#4  0xb7dc569f in run_cleanups () from /realsentry/wsp/engine-2.0/lib/libapr-0.so.0\n#5  0xb7dc4b13 in apr_pool_clear () from\n/realsentry/wsp/engine-2.0/lib/libapr-0.so.0\n#6  0x080b7831 in main ()", "id": 96065, "time": "2006-11-22T05:04:43Z", "creator": "francois.pesce@gmail.com", "creation_time": "2006-11-22T05:04:43Z", "is_private": false}, {"count": 1, "tags": [], "text": "Created attachment 19157\nPatch to fix namespace conflict between libc and pcreposix in util.c.\n\nWe can see that regfree() from libc is called, but it seems that the pointer\nwas returned by regcomp() from libpcre.\n\nAfter a quick reading of httpd/server/util.c, it appears ap_pregcomp,\nap_pregfree, ap_regerror and ap_regexec call respectively regcomp(), regfree(),\nregerror() and regexec(). httpd is linked with both libc and libpcre that both\nexport these 4 functions.\n\nI tried to patch util.c to avoid the use of function with the same name than\nlibc ones. Basically this patch is a move of the code from pcreposix.c into\nutil.c, to use directly function from pcre (with pcre_ namespace) in httpd.", "is_private": false, "bug_id": 41014, "id": 96066, "time": "2006-11-22T05:06:12Z", "creator": "francois.pesce@gmail.com", "creation_time": "2006-11-22T05:06:12Z", "attachment_id": 19157}, {"count": 2, "tags": [], "bug_id": 41014, "text": "Per dev@ reply, 2.0.x doesn't support external PCRE, report this to Debian or\nupgrade to 2.2.x.", "id": 96067, "time": "2006-11-22T05:28:41Z", "creator": "jorton@redhat.com", "creation_time": "2006-11-22T05:28:41Z", "is_private": false, "attachment_id": null}]