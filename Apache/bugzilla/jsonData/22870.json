[{"count": 0, "tags": [], "creator": "kalvinb602@hotmail.com", "attachment_id": null, "id": 43577, "time": "2003-09-02T03:12:33Z", "bug_id": 22870, "creation_time": "2003-09-02T03:12:33Z", "is_private": false, "text": "My logs for www.icarusindie.com had a number of requests for a single large \nfile.  After running it through my analyzer it reported around 18GB of transfer \nfor the day which is physically impossible on a 640/256 DSL line.  \n\nThe problem is that with 206 requests, it's reporting large chunks of a single \nfile being requested (in my case they were over 10MB in many cases) but that \namount of data obviously wasn't actually transfered.\n\nThis problem didn't exist with Apache 1.3\n\nBen"}, {"count": 1, "tags": [], "creator": "slive@apache.org", "text": "See mod_log_io for accurate byte counting.\n\nPerhaps this should be better documented.", "id": 43668, "time": "2003-09-03T14:16:35Z", "bug_id": 22870, "creation_time": "2003-09-03T14:16:35Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 22870, "attachment_id": null, "text": "In a comment on 2002-10-16 (over a year ago) in bug 10459 (which has been \nclosed), Joshua identified the root of the problem:\n\n>But there is a bug in apache related to this, which is that it always logs the\n>full amount that it intends to send, rather than the amount it actually put\n>on the wire.  There is active work to correct this, but it is not an easy\n>problem.\n\nMy recent trial of Apache 2.0 revealed exactly this issue.\n\n(BTW, this ALSO applies to requests with status 200 as well, not just 206.)\n\nUsing %I and %O (mod_log_io) does not help.  I do not want the bytecount to \ninclude header bytes - only content bytes.\n\nApache 2.0 is useless to us until this gets fixed.  Our business is downloads, \nand we need accurate byte counts, *especially* to indicate aborted downloads.  \nWe had to throw away several days worth of download logs because the \nbytecounts were so extremely inflated.  We *never suspected* that this basic \nlogging behavior would have changed from Apache 1.3!\n\nIn bug 8996 there is a comment on 2003-02-16 about this 'feature' being \nintentional because \"Some rely on having the %b and %B be what was intended to \nbe written rather than what was really written - don't ask - it was a major \npoint of contention on the development lists.\".\n\nWhat a crock!  Let *those* users be forced to use some snotty compile-time \noption that the Apache 2.0 developers seem to be so inordinately fond of \n(e.g. -DI_INSIST_ON_EXTRA_CYCLES_FOR_CLF_COMPLIANCE - see bug 21500).\n\nPerhaps something like -DI_INSIST_ON_NON_CLF_COMPLIANT_BOGUS_BYTECOUNTS.  ;-P\n", "id": 48087, "time": "2003-11-25T12:24:18Z", "creator": "jve@3dgamers.com", "creation_time": "2003-11-25T12:24:18Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 22870, "text": "Although your \"attitude\" seems a little strong, I do agree about\nyour conclusions.  This is -- at minimum -- very poorly documented.\nAnd it does seem to be a substantial change from 1.3 that isn't\nreally necessary.\n\nOf course, I don't have a patch handy to fix it.  Any contributions?", "count": 3, "id": 48106, "time": "2003-11-25T17:33:23Z", "creator": "slive@apache.org", "creation_time": "2003-11-25T17:33:23Z", "is_private": false}, {"count": 4, "tags": [], "creator": "slive@apache.org", "attachment_id": null, "id": 48108, "time": "2003-11-25T17:53:57Z", "bug_id": 22870, "creation_time": "2003-11-25T17:53:57Z", "is_private": false, "text": "One other thing: Without looking at the code, one thing to try is\nEnableSendfile Off\nWhen apache uses sendfile() to deliver the file, it passes off\ncontrol to the OS and has no way of knowing what happens after\nthat."}, {"count": 5, "tags": [], "creator": "jve@3dgamers.com", "attachment_id": null, "id": 48242, "time": "2003-11-27T11:10:14Z", "bug_id": 22870, "creation_time": "2003-11-27T11:10:14Z", "is_private": false, "text": "Joshua - thanks for your empathetic response.  :)  If you think my \"attitude\" \nseemd a little strong, you shoulda seen what I deleted before hitting the \nSubmit button.  Heh-heh.\n\nWe went back to 1.3, so I have no patch to contribute and no test system at \nthe moment.\n\nThanks for the tip about EnableSendfile, which defaults to \"on\".\n\nI see from the sendfile(2) man page that it updates an offset value to show \nthe last byte sent, plus 1.  So when using sendfile, apache should still be \nable to show the actual bytecount transmitted, even in the case of a \nprematurely closed socket.  Thus, setting EnableSendfile to \"off\" shouldn't \nmake a difference, right?  I haven't looked at the code, either..."}, {"count": 6, "tags": [], "creator": "sf@sfritsch.de", "attachment_id": null, "id": 147071, "time": "2011-06-13T20:33:44Z", "bug_id": 22870, "creation_time": "2011-06-13T20:33:44Z", "is_private": false, "text": "\n\n*** This bug has been marked as a duplicate of bug 25656 ***"}]