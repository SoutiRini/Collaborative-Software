[{"count": 0, "text": "I am trying to copy the whole Style of some Cells from one Worksheet to another.\nAt the moment I am using .cloneStyleFrom(), but this way a new Style is created everytime - since there is no way to detect if the new Style already exists and can be reused.\n\nXSSFCellStyle newStyle = dstSheet.getWorkbook().createCellStyle();\n// this creates a new style for every single cell, bad!\nnewStyle.cloneStyleFrom(oldCell.getCellStyle());\nnewCell.setCellStyle(newStyle);\n\nshould become something like:\n\nXSSFCellStyle newStyle = null;\nXSSFCellStyle exisiting = dstSheet.getWorkbook().searchForCellStyle(oldCell.getCellStyle());\n// returns the already existing style (if), or null\n\nif(existing == null){\n\n  newStyle = dstSheet.getWorkbook().createCellStyle();\n  newStyle.cloneStyleFrom(oldCell.getCellStyle());\n  newCell.setCellStyle(newStyle);\n\n} else {\n\n  newCell.setCellStyle(existing);\n\n}\n\nI'll give it a try to patch it, if somebody has a good idea - please let me know!\n\n---\n\nAnother Way would be to use CellUtil.setCellStyleProperties(), but it's not working for not-indexed colors, fonts, ...\n\nAlso a CellUtil.getCellStyleProperties() function would be nice.\n\n(But thats another issue, i will do that afterwards)", "creator": "dollinger.florian@gmx.de", "attachment_id": null, "id": 197742, "time": "2017-03-17T10:35:13Z", "bug_id": 60880, "creation_time": "2017-03-17T10:35:13Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 60880, "attachment_id": null, "is_private": false, "id": 197743, "time": "2017-03-17T10:57:45Z", "creator": "dollinger.florian@gmx.de", "creation_time": "2017-03-17T10:57:45Z", "text": "By the way, the following would in fact work - but makes only sense within the same Workbook!\n\nfor(int p = 0; p < dstSheet.getWorkbook().getNumCellStyles(); p++){\n  if(dstSheet.getWorkbook().getCellStyleAt(p).equals(newStyle))\n  System.out.println(\"exists\");\n}\n\n\nBecause\n\napplyAlignment=\"1\" borderId=\"0\" fillId=\"0\" fontId=\"0\" numFmtId=\"0\" xfId=\"0\"\non workbook 1\n\nand\napplyAlignment=\"1\" borderId=\"0\" fillId=\"0\" fontId=\"0\" numFmtId=\"0\" xfId=\"0\"\non workbook 2\n\nmay be referencing different fills, fonts, ... (the same index does not mean it is really the same on both workbooks)"}]