[{"count": 0, "tags": [], "text": "After migrating an existing webapp to tomcat 7.0.50 I started getting exceptions for EL expressions that worked fine in previous versions (everything seems to work just fine in 7.0.47 and previous versions, also tomcat 6.0.x).\n\nAll the errors I got were related to ternary expressions, and the error reported a strange corrupted version of the expression.\n\nThis is a sample expression:\n${my:link(!empty registration ? registration : \u2018/test/registration')}\n\nAnd this is the error I get:\norg.apache.jasper.JasperException: /WEB-INF/tags/project/tool.tag (line: 224, column: 110) \"${my:link(!empty registration ? registration : '/test/registration')}\" contains invalid expression(s): javax.el.ELException: Failed to parse the expression [${my:link(!emptyregistration?::'/test/registration')}]\n\n\nAs you can see in the error tomcat reports the expression as \"${my:link(!emptyregistration?::\u2019/test/registration')}\", removing all the whitespace and also replacing the \"registration\" variable with \":\".\n\nI checked all the settings to see if there may be a problem with the file encoding, whitespace characters or similar, but everything looks ok. After downgrading to 7.0.47 with the same webapp and settings everything works ok.\n\nI got several other errors in similar expressions, for all of them the expression reported in the errors has all the whitespace removed.\n\n\nI did a few tests and for this specific case I can make it work by changing it in the following way:\n${my:link(!empty registration ? registration : \u2018/test/registration')} -> does not work\n${my:link(!empty registration ? 'test' : \u2018/test/registration')} -> works\n\nIf this matters, the problems showed up in jsp tag files, with declared jsp version 2.0 (<jsp:root version=\"2.0\" ), xml format. Tested both on mac osx/java6 and redhat linux/java6.\n\nI couldn't find anything that may be related in jasper changelog between 7.0.47 and 7.0.50... do you have any idea if there is something that could cause this behaviour?", "attachment_id": null, "id": 172479, "creator": "fgiust@apache.org", "time": "2014-01-18T20:53:00Z", "bug_id": 56031, "creation_time": "2014-01-18T20:53:00Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 56031, "attachment_id": null, "id": 172480, "time": "2014-01-18T21:04:27Z", "creator": "markt@apache.org", "creation_time": "2014-01-18T21:04:27Z", "is_private": false, "text": "\n\n*** This bug has been marked as a duplicate of bug 56029 ***"}, {"count": 2, "tags": [], "bug_id": 56031, "text": "Just to be on the safe side I added your example as a test case to 8.0.x and with the fix in place it passes so this is already fixed in trunk and 7.0.x and will be in 8.0.0 and 7.0.51 onwards.", "id": 172484, "time": "2014-01-18T21:34:01Z", "creator": "markt@apache.org", "creation_time": "2014-01-18T21:34:01Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "thanks for the prompt response Mark", "is_private": false, "id": 172485, "creator": "fgiust@apache.org", "time": "2014-01-18T21:57:55Z", "bug_id": 56031, "creation_time": "2014-01-18T21:57:55Z", "attachment_id": null}]