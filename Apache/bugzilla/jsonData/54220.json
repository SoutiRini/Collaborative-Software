[{"count": 0, "tags": [], "bug_id": 54220, "attachment_id": null, "id": 163705, "creation_time": "2012-11-28T20:19:49Z", "time": "2012-11-28T20:19:49Z", "creator": "1983-01-06@gmx.net", "text": "If you issue a response.setStatus(404) from a servlet, you expect as per spec that the response is left untouched. No error page written. There is sendError for that.\n\nUnfortunately, ErrorReportValve reacts on line 158\n> if ((statusCode < 400) || (response.getContentCount() > 0))\n>            return;\n\nIf you take a look at the StandardHostValve, it invokes error handling on line 316\n> if (!response.isError())\n>            return;\nOn errors only (correct behavior).\n\nThe ErrorReportValve must react on response.isError() == true only. Regardless of the status code or the content count.\nThe Javadoc does not limit this to status codes >= 400 but is says that reponse.sendError() has to clears buffers. As far I understand that, regardless of the response body is disposed and the error reponse is always written.", "is_private": false}, {"count": 1, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "text": "Fixed in trunk and 7.0.x and will be included in 7.0.34 onwards.", "id": 163797, "time": "2012-12-03T14:21:22Z", "bug_id": 54220, "creation_time": "2012-12-03T14:21:22Z", "is_private": false}, {"count": 2, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "is_private": false, "id": 163798, "time": "2012-12-03T14:23:56Z", "bug_id": 54220, "creation_time": "2012-12-03T14:23:56Z", "text": "Opps. Need to keep this open until 6.0x. is fixed."}, {"count": 3, "attachment_id": null, "bug_id": 54220, "text": "Proposed for 6.0.x", "id": 163799, "time": "2012-12-03T14:42:38Z", "creator": "markt@apache.org", "creation_time": "2012-12-03T14:42:38Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "creator": "knst.kolinko@gmail.com", "attachment_id": null, "id": 163925, "time": "2012-12-06T14:56:19Z", "bug_id": 54220, "creation_time": "2012-12-06T14:56:19Z", "is_private": false, "text": "Fixed in Tomcat 6 by r1417925 , will be in 6.0.37 onwards."}]