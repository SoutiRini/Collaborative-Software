[{"count": 0, "tags": [], "bug_id": 50847, "attachment_id": null, "id": 144623, "time": "2011-03-01T09:50:53Z", "creator": "andrei.astrouski@gmail.com", "creation_time": "2011-03-01T09:50:53Z", "is_private": false, "text": "Try to set FontCharset.MAC value to font via setCharSet(int) method.\n\nActual: POIXMLException exception"}, {"count": 1, "attachment_id": null, "bug_id": 50847, "is_private": false, "id": 144627, "time": "2011-03-01T11:05:42Z", "creator": "apache@gagravarr.org", "creation_time": "2011-03-01T11:05:42Z", "tags": [], "text": "Is that one of the allowed values in .xlsx?"}, {"count": 2, "tags": [], "creator": "andrei.astrouski@gmail.com", "is_private": false, "text": "Probably but i'm not sure. For my locale font.getCharSet() returns FontCharset.RUSSIAN.", "id": 144630, "time": "2011-03-01T11:48:55Z", "bug_id": 50847, "creation_time": "2011-03-01T11:48:55Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 50847, "attachment_id": null, "id": 144631, "time": "2011-03-01T11:55:01Z", "creator": "apache@gagravarr.org", "creation_time": "2011-03-01T11:55:01Z", "is_private": false, "text": "Any chance you could dig into the Microsoft specs, and check what they say?"}, {"count": 4, "tags": [], "creator": "andrei.astrouski@gmail.com", "is_private": false, "text": "I found in the specification (Excel 2007 Binary File Format specification) font character set.\n0= Ansi \n1= Default \n2= Symbol \n77= Mac \n128= Japanese \n129= Korean \n130= Johab \n134= GB2312 \n136= Chinese Big 5 \n161= Greek \n162= Turkish \n163= Vietnamese \n177= Hebrew \n178= Arabic \n186= Baltic \n204= Russian \n222= Thai \n238= East Europe \n255= Oem\n\nIe the same as FontCharset has.", "id": 144676, "time": "2011-03-02T10:08:47Z", "bug_id": 50847, "creation_time": "2011-03-02T10:08:47Z", "attachment_id": null}, {"count": 5, "tags": [], "text": "Patch:\n\npublic void setCharSet(int charset) {\n        CTIntProperty charsetProperty = _ctFont.sizeOfCharsetArray() == 0 ? _ctFont.addNewCharset() : _ctFont.getCharsetArray(0);\n        FontCharset fontCharset = FontCharset.valueOf(charset);\n        if (fontCharset != null) {\n            charsetProperty.setVal(fontCharset.getValue());\n        } else {\n            throw new POIXMLException(\"Attention: an attempt to set a type of unknow charset and charset\");\n        }\n    }", "attachment_id": null, "id": 144677, "creator": "andrei.astrouski@gmail.com", "time": "2011-03-02T10:18:20Z", "bug_id": 50847, "creation_time": "2011-03-02T10:18:20Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 50847, "attachment_id": null, "id": 144731, "time": "2011-03-04T09:02:24Z", "creator": "apache@gagravarr.org", "creation_time": "2011-03-04T09:02:24Z", "is_private": false, "text": "Thanks for the patch. As we already had a setter which took a FontCharset object, I flipped it around a little bit, so we didn't need to do charset -> int -> charset. Fix and unit test committed in 1077950."}]