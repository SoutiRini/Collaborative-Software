[{"attachment_id": 27984, "tags": [], "bug_id": 52244, "text": "Created attachment 27984\nAttachment is the template file.\n\nThe template font is Arial, but the program says it's Times New Roman.\n\n\n\t\tString url = \"D:\\\\Temp\\\\template.ppt\";\n\t\t\n\t\torg.apache.poi.hslf.HSLFSlideShow hslf = null;\n\t\ttry {\n\t\t\thslf = new HSLFSlideShow(url);\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t\torg.apache.poi.hslf.usermodel.SlideShow slidePPT = new org.apache.poi.hslf.usermodel.SlideShow(hslf);\n\t\torg.apache.poi.hslf.model.Slide[] slides = slidePPT.getSlides();\n\n\t\tfor(org.apache.poi.hslf.model.Slide slide: slides){\n\t\t\tTextRun[] textRuns = slide.getTextRuns();\n\t\t\tfor(TextRun rt : textRuns){\n\t\t\t\tRichTextRun[] rtrs = rt.getRichTextRuns();\n\t\t\t\tfor(RichTextRun rtr : rtrs){\n\t\t\t\t\tSystem.out.println(\"Text: \" + rtr.getText());\n\t\t\t\t\tSystem.out.println(\"Color: \" + rtr.getFontColor());\n\t\t\t\t\tSystem.out.println(\"FontName: \" + rtr.getFontName());\n\t\t\t\t\tSystem.out.println(\"FontSize: \" + rtr.getFontSize());\n\t\t\t\t\tSystem.out.println(\"Alignment: \" + rtr.getAlignment());\n\t\t\t\t\tSystem.out.println();\n\t\t\t\t}\n\t\t\t}\n\t\t}", "count": 0, "id": 151784, "time": "2011-11-25T10:03:59Z", "creator": "andy20050125@163.com", "creation_time": "2011-11-25T10:03:59Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "andy20050125@163.com", "is_private": false, "count": 1, "id": 151821, "time": "2011-11-28T02:41:48Z", "bug_id": 52244, "creation_time": "2011-11-28T02:41:48Z", "text": "Found a TextHeaderAtom not followed by a TextBytesAtom or TextCharsAtom: Followed by 4002\nFound a TextHeaderAtom not followed by a TextBytesAtom or TextCharsAtom: Followed by 4002\nFound a TextHeaderAtom not followed by a TextBytesAtom or TextCharsAtom: Followed by 4002\nFound a TextHeaderAtom not followed by a TextBytesAtom or TextCharsAtom: Followed by 4002\nFound a TextHeaderAtom not followed by a TextBytesAtom or TextCharsAtom: Followed by 4002\nFound a TextHeaderAtom not followed by a TextBytesAtom or TextCharsAtom: Followed by 4002\nFound a TextHeaderAtom not followed by a TextBytesAtom or TextCharsAtom: Followed by 4002\nFound a TextHeaderAtom not followed by a TextBytesAtom or TextCharsAtom: Followed by 4002\ncom.open.framework.exception.BaseException: java.lang.ArrayIndexOutOfBoundsException: 36\n\tat com.open.framework.view.DispatchAction.dispatchMethod(DispatchAction.java:286)\n\tat com.open.framework.view.DispatchAction.executeAct(DispatchAction.java:195)\n\tat com.open.framework.view.BaseAction.execute(BaseAction.java:467)\n\tat org.apache.struts.action.RequestProcessor.processActionPerform(RequestProcessor.java:431)\n\tat org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:236)\n\tat org.apache.struts.action.ActionServlet.process(ActionServlet.java:1196)\n\tat org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:432)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n\tat com.open.security.authority.AuthorityFilter.doFilter(AuthorityFilter.java:137)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n\tat com.open.framework.view.contoller.CharsetEncodingFilter.doFilter(CharsetEncodingFilter.java:121)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:291)\n\tat org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)\n\tat org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)\n\tat org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)\n\tat java.lang.Thread.run(Unknown Source)\nCaused by: java.lang.ArrayIndexOutOfBoundsException: 36\n\tat org.apache.poi.util.LittleEndian.getInt(LittleEndian.java:95)\n\tat org.apache.poi.hslf.record.StyleTextPropAtom.setParentTextSize(StyleTextPropAtom.java:323)\n\tat org.apache.poi.hslf.model.TextRun.<init>(TextRun.java:100)\n\tat org.apache.poi.hslf.model.TextRun.<init>(TextRun.java:77)\n\tat org.apache.poi.hslf.model.Sheet.findTextRuns(Sheet.java:175)\n\tat org.apache.poi.hslf.model.Sheet.findTextRuns(Sheet.java:132)\n\tat org.apache.poi.hslf.model.Slide.<init>(Slide.java:70)\n\tat org.apache.poi.hslf.usermodel.SlideShow.buildSlidesAndNotes(SlideShow.java:411)\n\tat org.apache.poi.hslf.usermodel.SlideShow.<init>(SlideShow.java:109)\n\tat com.open.common.ppt.ReportUtility.writePPT(ReportUtility.java:1689)\n\tat com.auchan.crs.service.report.templatemgt.ReportAjaxService.ajaxCreateReportNew(ReportAjaxService.java:716)\n\tat com.auchan.crs.view.action.report.templatemgt.ReportAjaxAction.ajaxCreateReportNew(ReportAjaxAction.java:789)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n\tat java.lang.reflect.Method.invoke(Unknown Source)\n\tat com.open.framework.view.DispatchAction.dispatchMethod(DispatchAction.java:264)\n\t... 26 more"}, {"count": 2, "tags": [], "bug_id": 52244, "text": "There is also have this bug in POI 3.7", "id": 151822, "time": "2011-11-28T02:43:14Z", "creator": "andy20050125@163.com", "creation_time": "2011-11-28T02:43:14Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "yegor@dinom.ru", "text": "The problem with incorrect font name and size should be fixed in r1295478\n\nThe attached document has colliding master styles. Strictly speaking it is a violation of the format, but PowerPoint  resolves such cases OK and I fixed POI to do so.\n\nYegor", "id": 154395, "attachment_id": null, "bug_id": 52244, "creation_time": "2012-03-01T09:07:28Z", "time": "2012-03-01T09:07:28Z", "is_private": false}]