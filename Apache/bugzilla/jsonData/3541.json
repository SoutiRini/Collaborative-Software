[{"count": 0, "attachment_id": null, "bug_id": 3541, "is_private": false, "id": 5344, "time": "2001-09-11T00:57:07Z", "creator": "stuartwelham@yahoo.co.uk", "creation_time": "2001-09-11T00:57:07Z", "tags": [], "text": "When the following Schema \n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<xsd:schema \n    targetNamespace=\"http://www.example.com/Who\" \n    xmlns=\"http://www.example.com/Who\" \n    xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n    finalDefault=\"restriction\"\n    xml:lang=\"en-GB\">\n\n    <xsd:annotation>\n        <xsd:documentation>\n            XML Schema to test SubstitutionGroups with xsd:anyType head \n        </xsd:documentation>\n    </xsd:annotation>\n\n    <xsd:element\n        name=\"anyHead\"\n        type=\"xsd:anyType\"/>\n\n    <xsd:element\n        name=\"simpleSubstitute\"\n        substitutionGroup=\"anyHead\"\n        type=\"xsd:string\"/>\n\n    <xsd:element\n        name=\"complexSubstitute\"\n        substitutionGroup=\"anyHead\">\n        <xsd:complexType>\n            <xsd:simpleContent>\n                <xsd:extension base=\"xsd:string\"/>\n            </xsd:simpleContent>\n        </xsd:complexType>\n    </xsd:element>\n\n    <xsd:element\n        name=\"MotherHen\">\n        <xsd:complexType>\n            <xsd:sequence>\n                <xsd:element \n                    ref=\"anyHead\"\n                    maxOccurs=\"unbounded\"/>\n            </xsd:sequence>\n        </xsd:complexType>\n    </xsd:element>\n\n</xsd:schema>\n\nis used with the instance document\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<MotherHen \n    xmlns=\"http://www.example.com/Who\" \n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://www.example.com/Who Substitution.xsd\">\n    <complexSubstitute>John Entwhistle</complexSubstitute>\n    <simpleSubstitute>Pete Townsend</simpleSubstitute>\n</MotherHen>\n\nxerces reports an error on simpleSubstitute but fails to report an error on \ncomplexSubstitute.\n\nNOTE: Bug report from query on xerces-j-user mailing list. \nhttp://marc.theaimsgroup.com/?l=xerces-j-user&m=100013535924476&w=2\nReply from Sandy Gao as follows :\n\nIn the declaration of \"anyHead\" element, no \"final\" is specified, so\n\"finalDefault\" of the <schema> element is used, and {substitution group\nexclusions} for \"anyHead\" is \"restriction\".\n\n\"Schema Component Constraint: Element Declaration Properties Correct\",\npoint 3:\n\"3 If there is an {substitution group affiliation}, the {type definition}\nof the element declaration must be validly derived from the {type\ndefinition} of the {substitution group affiliation}, given the value of the\n{substitution group exclusions} of the {substitution group affiliation}, as\ndefined in Type Derivation OK (Complex) (\u00a73.4.6) (if the {type definition}\nis complex) or as defined in Type Derivation OK (Simple) (\u00a73.14.6) (if the\n{type definition} is simple).\"\n\nThat means, any element of a type that's derived by \"restriction\" from the\ntype of \"anyHead\" (anyType in this case) is not allowed to substitute\n\"anyHead\". So the parser is correct to report an error on\n\"simpleSubstitute\". For the same reason, the parser should also report an\nerror on \"complexSubstitute\", but it fails to, which is a bug. I'll look\ninto it, and fixed it if possible."}]