[{"attachment_id": 32392, "tags": [], "bug_id": 57485, "text": "Created attachment 32392\npacket capture\n\nI'm using mod_jk to connect apache to tomcat,\nWhen I send the following tcp packets(to simulate incomplete chunked body) and close the socket,strangely my servlet did received the partial body as complete,packet capture shows that mod_jk decoded the chunked body and passed the incomplete body just as complete to tomcat.\nPlease see the packet capture file for details.\n\n1.tcp packet I sent\n<pre>\nPOST /TestServlet/helloworld HTTP/1.1\nHost: 192.168.1.58\nUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.5) Gecko/20091102 Firefox/3.5.5 (.NET CLR 3.5.30729)\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-us,en;q=0.5\nAccept-Encoding: gzip,deflate\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\nKeep-Alive: 300\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nTransfer-Encoding: chunked\n\n5\nk=12<EOF>\n</pre>\n\n2.servlet code\n<pre>\n@Override\n\tprotected void doPost(HttpServletRequest req, HttpServletResponse resp)\n\t\t\tthrows ServletException, IOException {\n\t\tSystem.out.println(\"doPost start\");\n\t\tEnumeration pem = req.getParameterNames();\n\t\twhile (pem.hasMoreElements()) {\n\t\t\tString k = pem.nextElement().toString();\n\t\t\tString v = req.getParameter(k);\n\t\t\tSystem.out.println(k + \"=\" + v);\n\t\t}\n\t\tSystem.out.println(\"doPost end\");\n\n\t}\n\n</pre>\n\n3.the current result \nthe servlet outputs the following\n<pre>\ndoPost start\nk=12\ndoPost end\n</pre>\n\n4.the result I expected\n<pre>\ndoPost start\ndoPost end\n</pre>\n\n\nPlease", "count": 0, "id": 180493, "time": "2015-01-23T05:15:43Z", "creator": "charleschung.cn@gmail.com", "creation_time": "2015-01-23T05:15:43Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 57485, "attachment_id": null, "is_private": false, "id": 180544, "time": "2015-01-24T14:56:56Z", "creator": "charleschung.cn@gmail.com", "creation_time": "2015-01-24T14:56:56Z", "text": "mod_jk is using apache httpd api to read (and de-chunk) the http body,so the cause may be in apache ,instead of mod_jk.\n\nI am using Apache/2.2.15,after searching bug relating to chunked-transfering,I found https://issues.apache.org/bugzilla/show_bug.cgi?id=55475 which seems to relate to this one.\nI will try upgrading apache to 2.2.18(at which version the issue 55475 is fixed) or higher to see the result"}, {"attachment_id": null, "tags": [], "creator": "charleschung.cn@gmail.com", "text": "Even after upgrading to the latest version of apache(2.4.10) + APR 1.5.1,noghting changes:the incomplete chunked-transfered body is still sent to tomcat(servlet).", "count": 2, "id": 180549, "time": "2015-01-24T16:57:13Z", "bug_id": 57485, "creation_time": "2015-01-24T16:57:13Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 57485, "attachment_id": null, "is_private": false, "id": 193923, "time": "2016-09-22T12:56:44Z", "creator": "markt@apache.org", "creation_time": "2016-09-22T12:56:44Z", "text": "Thanks for the report. This has been fixed in trunk for 1.2.42 onwards."}, {"attachment_id": null, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "text": "Hello Mark,\nWhat's the expected release date for mod_jk 1.2.42 ?\nThanks", "count": 4, "id": 193925, "time": "2016-09-22T14:10:07Z", "bug_id": 57485, "creation_time": "2016-09-22T14:10:07Z", "is_private": false}]