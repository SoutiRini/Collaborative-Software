[{"count": 0, "tags": [], "creator": "lgalfaso@gmail.com", "attachment_id": null, "id": 108555, "time": "2007-09-24T19:41:40Z", "bug_id": 43470, "creation_time": "2007-09-24T19:41:40Z", "is_private": false, "text": "NamingResources reads\n\n    public void removeLocalEjb(String name) {\n\n        entries.remove(name);\n\n        ContextLocalEjb localEjb = null;\n        synchronized (localEjbs) {\n            localEjb = (ContextLocalEjb) ejbs.remove(name);\n        }\n        if (localEjb != null) {\n            support.firePropertyChange(\"localEjb\", localEjb, null);\n            localEjb.setNamingResources(null);\n        }\n\n    }\n\nif should be \n\n    public void removeLocalEjb(String name) {\n\n        entries.remove(name);\n\n        ContextLocalEjb localEjb = null;\n        synchronized (localEjbs) {\n            localEjb = (ContextLocalEjb) localEjbs.remove(name); // The error\nwas in this line\n        }\n        if (localEjb != null) {\n            support.firePropertyChange(\"localEjb\", localEjb, null);\n            localEjb.setNamingResources(null);\n        }\n\n    }\n\nRegards,\n  lg"}, {"count": 1, "attachment_id": null, "bug_id": 43470, "is_private": false, "id": 108557, "time": "2007-09-24T20:02:04Z", "creator": "lgalfaso@gmail.com", "creation_time": "2007-09-24T20:02:04Z", "tags": [], "text": "There are some more bug at this same class\nIt reads\n\n    public void addResourceEnvRef(ContextResourceEnvRef resource) {\n\n        if (entries.containsKey(resource.getName())) {\n            return;\n        } else {\n            entries.put(resource.getName(), resource.getType());\n        }\n\n        synchronized (localEjbs) { // This is wrong\n            resource.setNamingResources(this);\n            resourceEnvRefs.put(resource.getName(), resource);\n        }\n        support.firePropertyChange(\"resourceEnvRef\", null, resource);\n\n    }\n\nCorrected version\n\n    public void addResourceEnvRef(ContextResourceEnvRef resource) {\n\n        if (entries.containsKey(resource.getName())) {\n            return;\n        } else {\n            entries.put(resource.getName(), resource.getType());\n        }\n\n        synchronized (resource) { // This is correct\n            resource.setNamingResources(this);\n            resourceEnvRefs.put(resource.getName(), resource);\n        }\n        support.firePropertyChange(\"resourceEnvRef\", null, resource);\n\n    }\n\n\n\nand\n\n    public void removeResourceEnvRef(String name) {\n\n        entries.remove(name);\n\n        String type = null;\n        synchronized (resourceEnvRefs) {\n            type = (String) resourceEnvRefs.remove(name);\n        }\n        if (type != null) {\n            support.firePropertyChange(\"resourceEnvRef\",\n                                       name + \":\" + type, null);\n        }\n\n    }\n\n\nShould be\n\n    public void removeResourceEnvRef(String name) {\n\n        entries.remove(name);\n\n        ContextResourceEnvRef resourceEventRef = null;\n        synchronized (resourceEnvRefs) {\n            resourceEventRef = (ContextResourceEnvRef) resourceEnvRefs.remove(name);\n        }\n        if (resourceEventRef != null) {\n            support.firePropertyChange(\"resourceEnvRef\",\n                                       name + \":\" + resourceEventRef.getType(),\nnull);\n        }\n\n    }\n\n\nRegards,\n  lg"}, {"count": 2, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 108559, "time": "2007-09-24T20:47:44Z", "bug_id": 43470, "creation_time": "2007-09-24T20:47:44Z", "is_private": false, "text": "Thanks for all your patches. Could you provide them in diff -u format as they\nare easier to read and apply that way. Cheers."}, {"count": 3, "tags": [], "creator": "markt@apache.org", "text": "Thanks for the patch. I had to make a few tweaks. See http://svn.apache.org/viewvc?rev=651675&view=rev\n\nIt has been committed to trunk and proposed for 6.0.x", "id": 115887, "time": "2008-04-25T11:17:47Z", "bug_id": 43470, "creation_time": "2008-04-25T11:17:47Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 43470, "attachment_id": null, "text": "This patch has been committed to 6.0.x and will be included in 6.0.17", "id": 116111, "time": "2008-05-01T12:18:57Z", "creator": "markt@apache.org", "creation_time": "2008-05-01T12:18:57Z", "is_private": false}]