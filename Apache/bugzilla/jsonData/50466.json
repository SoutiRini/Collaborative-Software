[{"count": 0, "text": "There appears to be an issue with Apache web server not being able to recycle one of the httpd processes.  It appears to be stuck and consumed 100% CPU power.  This is happening despite the following settings as appeared on my phpinfo() page.\nMax Requests \tPer Child: 10000 - Keep Alive: on - Max Per Connection: 100 \n\n\nTo illustrate this, please look at PID 4188 from the following 2 \"top\" capture over a span of 3 days.  Any additional details required please let me know.  This is running on CentOS 5.5 64-bit 2.6.18-194.el5.\n\n\n1 day later\ntop - 08:11:06 up 122 days, 11:05, 1 user, load average: 1.05, 1.04, 0.97\nTasks: 135 total, 3 running, 132 sleeping, 0 stopped, 0 zombie\nCpu0 : 5.7%us, 0.7%sy, 0.0%ni, 90.7%id, 1.7%wa, 0.7%hi, 0.7%si, 0.0%st\nCpu1 : 73.4%us, 26.6%sy, 0.0%ni, 0.0%id, 0.0%wa, 0.0%hi, 0.0%si, 0.0%st\nMem: 2059516k total, 1906896k used, 152620k free, 154016k buffers\nSwap: 4095992k total, 80k used, 4095912k free, 1005564k cached\n\nPID USER PR NI VIRT RES SHR S %CPU %MEM TIME+ COMMAND\n4188 daemon 25 0 115m 18m 2948 R 100.2 0.9 43:25.32 httpd\n6602 daemon 15 0 109m 12m 2856 S 2.7 0.6 0:00.17 httpd\n6678 daemon 15 0 105m 8416 2600 S 1.3 0.4 0:00.05 httpd\n\n\n\n3 days later\ntop - 06:16:14 up 124 days,  9:10,  1 user,  load average: 1.03, 1.20, 1.18\nTasks: 128 total,   3 running, 125 sleeping,   0 stopped,   0 zombie\nCpu0  : 12.3%us,  1.3%sy,  0.0%ni, 85.3%id,  0.0%wa,  0.3%hi,  0.7%si,  0.0%st\nCpu1  : 73.8%us, 26.2%sy,  0.0%ni,  0.0%id,  0.0%wa,  0.0%hi,  0.0%si,  0.0%st\nMem:   2059516k total,  1923432k used,   136084k free,   157940k buffers\nSwap:  4095992k total,       80k used,  4095912k free,   986552k cached\n\n  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND\n 4188 daemon    25   0  115m  18m 2948 R 99.9  0.9   2806:08 httpd\n  645 daemon    15   0  108m  10m 2852 S  4.7  0.5   0:00.15 httpd\n  550 daemon    15   0  109m  12m 2868 S  2.7  0.6   0:00.56 httpd\n  632 daemon    15   0  108m  11m 2836 S  2.7  0.6   0:00.15 httpd\n  633 daemon    15   0  109m  11m 2832 S  2.0  0.6   0:00.19 httpd\n  647 daemon    16   0  106m 8860 2740 S  1.7  0.4   0:00.05 httpd\n  476 daemon    16   0  108m  11m 2932 S  0.7  0.6   0:01.63 httpd", "bug_id": 50466, "is_private": false, "id": 142646, "time": "2010-12-13T10:08:24Z", "creator": "cheungtitus@hotmail.com", "creation_time": "2010-12-13T10:08:24Z", "tags": [], "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 50466, "attachment_id": null, "is_private": false, "id": 142652, "time": "2010-12-13T11:19:03Z", "creator": "covener@gmail.com", "creation_time": "2010-12-13T11:19:03Z", "text": "processes don't exit until they're done processing all requests they've accepted. \n\nIf a process is looping, it will never have a chance to exit. Where does a backtrace of the process say it's looping?"}, {"count": 2, "tags": [], "bug_id": 50466, "attachment_id": null, "id": 142678, "creation_time": "2010-12-14T11:10:27Z", "time": "2010-12-14T11:10:27Z", "creator": "cheungtitus@hotmail.com", "text": "(In reply to comment #1)\n> processes don't exit until they're done processing all requests they've\n> accepted. \n> \n> If a process is looping, it will never have a chance to exit. Where does a\n> backtrace of the process say it's looping?\n\nSorry how can I do a back trace when this happens again?  Is there any log where I can find this information?", "is_private": false}, {"count": 3, "text": "Hi, this just happened again today, since a restart was done about a week ago.  The same symptoms occurred.  Any idea if I can turn on more logging to see what a specific httpd process is doing?", "bug_id": 50466, "attachment_id": null, "id": 142840, "time": "2010-12-19T10:31:41Z", "creator": "cheungtitus@hotmail.com", "creation_time": "2010-12-19T10:31:41Z", "tags": [], "is_private": false}, {"count": 4, "text": "gdb -p 4188 (or whatever the pid of the looping process is)\nbt full\n\nTo be really useful, you would need the debugging symbols installed (don't know how that works under centos).\n\nMaybe http://httpd.apache.org/dev/debugging.html helps.", "bug_id": 50466, "attachment_id": null, "id": 142844, "time": "2010-12-19T16:14:23Z", "creator": "sf@sfritsch.de", "creation_time": "2010-12-19T16:14:23Z", "tags": [], "is_private": false}]