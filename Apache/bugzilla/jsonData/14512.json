[{"count": 0, "tags": [], "bug_id": 14512, "text": "The attached patches allow creating a <connection> within the build file and \nreferencing it from the <sql> task rather than having to define all of the \nconnection information each time.\n\nAlso, it adds a <database> condition that can be used to query the database for \nthe existence of a schema, a catalog, a table or view within a schema/catalog, \nor a column/index on a table.\n\nThere are three attachments.  One is a patch file, the other two are new \nsources.", "id": 26193, "time": "2002-11-13T16:47:49Z", "creator": "thierry.lach@bbdodetroit.com", "creation_time": "2002-11-13T16:47:49Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "thierry.lach@bbdodetroit.com", "is_private": false, "text": "Created attachment 3824\nPatch as described.", "id": 26194, "time": "2002-11-13T16:48:39Z", "bug_id": 14512, "creation_time": "2002-11-13T16:48:39Z", "attachment_id": 3824}, {"count": 2, "attachment_id": 3825, "bug_id": 14512, "is_private": false, "id": 26195, "time": "2002-11-13T16:50:22Z", "creator": "thierry.lach@bbdodetroit.com", "creation_time": "2002-11-13T16:50:22Z", "tags": [], "text": "Created attachment 3825\nJava source file - place in org/apache/tools/ant/types"}, {"count": 3, "tags": [], "bug_id": 14512, "attachment_id": 3826, "id": 26196, "time": "2002-11-13T16:51:17Z", "creator": "thierry.lach@bbdodetroit.com", "creation_time": "2002-11-13T16:51:17Z", "is_private": false, "text": "Created attachment 3826\nJava source file - place in org/apache/tools/ant/taskdefs/condition"}, {"count": 4, "attachment_id": null, "bug_id": 14512, "is_private": false, "id": 26202, "time": "2002-11-13T16:59:38Z", "creator": "thierry.lach@bbdodetroit.com", "creation_time": "2002-11-13T16:59:38Z", "tags": [], "text": "Here is an example build file (based upon the one I used to test this) that \ndemonstrates some of the syntax.  Note:  I ran ant with -debug to see what \nproperties were set as a result of the conditions, so there is no explicit use \nof the \"xxxxx.is.present\" property values.  (Their use is left as an exercise \nto the reader ;-)\n\n<?xml version=\"2.0\"?>\n<project default=\"main\" basedir=\".\">\n\n  <path id=\"classes12\">\n    <pathelement location=\"c:/software/jdbc/classes12.jar\"/>\n  </path>\n\n  <!-- Make sure the connection works properly with a classpath -->\n  <connection id=\"connection1\"\n              driver=\"oracle.jdbc.driver.OracleDriver\"\n              url=\"jdbc:oracle:thin:@localhost:1521:ORCL\"\n\t      userid=\"lacht\"\n\t      password=\"none_of_your_business\"\n\t      classpath=\"c:/software/jdbc/classes12.jar\"/>\n\n  <!-- Make sure the connection works properly with a classpathref -->\n  <connection id=\"connection2\"\n              driver=\"oracle.jdbc.driver.OracleDriver\"\n              url=\"jdbc:oracle:thin:@localhost:1521:ORCL\"\n\t      userid=\"lacht\"\n\t      password=\"none_of_your_business\"\n\t      classpathref=\"classes12\"/>\n\n  <target name=\"main\">\n\n    <!-- Make sure it still works the old way -->\n    <sql\n              driver=\"oracle.jdbc.driver.OracleDriver\"\n              url=\"jdbc:oracle:thin:@localhost:1521:ORCL\"\n\t      userid=\"lacht\"\n\t      password=\"none_of_your_business\"\n\t      classpathref=\"classes12\">\n        <transaction>\n\t    select * from dual\n\t</transaction>\n    </sql>\n\n    <!-- The same thing with a connectionref -->\n    <sql connectionref=\"connection1\">\n        <transaction>\n\t    select * from dual\n\t</transaction>\n    </sql>\n\n    <condition property=\"schema.is.present\">\n        <database connectionref=\"connection2\"\n\t          type=\"schema\"\n\t\t  name=\"LACHT\"/>\n    </condition>\n\n    <condition property=\"table.is.present\">\n        <database connectionref=\"connection2\"\n\t          catalog=\"\"\n\t          type=\"table\"\n\t\t  schema=\"LACHT\"\n\t\t  name=\"TURBINE_USER\"/>\n    </condition>\n\n    <condition property=\"column.is.present\">\n        <or>\n          <database connectionref=\"connection1\"\n\t            catalog=\"\"\n\t            type=\"column\"\n\t\t    schema=\"LACHT\"\n\t\t    table=\"TURBINE_USER\"\n\t\t    name=\"OBJECT_DATA\"/>\n          <database connectionref=\"connection2\"\n\t            catalog=\"\"\n\t            type=\"column\"\n\t\t    schema=\"LACHT\"\n\t\t    table=\"TURBINE_USER\"\n\t\t    name=\"OBJECTDATA\"/>\n        </or>\n    </condition>\n\n  </target>\n\n</project>\n"}]