[{"count": 0, "tags": [], "creator": "keeskuip@technologist.com", "text": "When the classpath of the taskdef task is not correct a wrong errormessage\nis displayed.\n\nI have made an user-defined task \"VBSFGenerator\".\nThe task itself is in the jarfile \"antVBSF.jar\"\nVBSFGenerator uses classes from the jarfiles \"schema.jar\" and \"maptool2.jar\".\n\nI have in my build.xml :\n\n  <path id=\"vbsf.ant.tasks\">\n    <pathelement location=\"${tools}/lib/ant/antVBSF.jar\"/>\n  </path>\n\n  <target name=\"generate\">\n\n   <!-- Declare the Task before it can be used -->\n    <taskdef name=\"VBSFGenerator\"\n             className=\"org.gti.ant.taskdefs.VBSFGenerator\">\n      <classpath refid=\"vbsf.ant.tasks\"/>\n    </taskdef>\n \n  </target>\n\nNote : I forgot to add \"schema.jar\" and \"maptool2.jar\" in the refid !\nThe errormessage when I run this is :\n\n  taskdef class org.gti.ant.taskdefs.VBSFGenerator cannot be found\n\nThis errormessage is wrong,\nbecause it was able to load VBSFGenerator but it was not able to \nload a different class ! namely :   \n     com/objectmatter/bsf/mapping/schema/InvalidMappingException\n\nIf print out the stacktrace (obtained through use of the -debug flat)\nI see :\nBUILD FAILED\n/usr/local/project/projecten/DutchCocoa/klant/build.xml:83: taskdef class org.gt\ni.ant.taskdefs.VBSFGenerator cannot be found\n        at org.apache.tools.ant.taskdefs.Definer.addDefinition(Definer.java:204)\n        at org.apache.tools.ant.taskdefs.Definer.execute(Definer.java:130)\n        at org.apache.tools.ant.Task.perform(Task.java:313)\n        at org.apache.tools.ant.Target.execute(Target.java:309)\n        at org.apache.tools.ant.Target.performTasks(Target.java:334)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1216)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1160)\n        at org.apache.tools.ant.Main.runBuild(Main.java:605)\n        at org.apache.tools.ant.Main.start(Main.java:195)\n        at org.apache.tools.ant.Main.main(Main.java:234)\n--- Nested Exception ---\njava.lang.NoClassDefFoundError: com/objectmatter/bsf/mapping/schema/InvalidMappi\nngException\n        at java.lang.Class.getDeclaredConstructors0(Native Method)\n        at java.lang.Class.privateGetDeclaredConstructors(Class.java:1590)\n        at java.lang.Class.getDeclaredConstructors(Class.java:1152)\n        at org.apache.tools.ant.AntClassLoader.initializeClass(AntClassLoader.ja\nva:478)\n        at org.apache.tools.ant.taskdefs.Definer.addDefinition(Definer.java:195)\n        at org.apache.tools.ant.taskdefs.Definer.execute(Definer.java:130)\n        at org.apache.tools.ant.Task.perform(Task.java:313)\n        at org.apache.tools.ant.Target.execute(Target.java:309)\n        at org.apache.tools.ant.Target.performTasks(Target.java:334)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1216)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1160)\n        at org.apache.tools.ant.Main.runBuild(Main.java:605)\n        at org.apache.tools.ant.Main.start(Main.java:195)\n        at org.apache.tools.ant.Main.main(Main.java:234)\n\n\nI think the errormessage should mention all messages from all \nNested Exceptions !\n\nSo the correct (i think) should be :\n\n/usr/local/project/projecten/DutchCocoa/klant/build.xml:83: taskdef class\norg.gti.ant.taskdefs.VBSFGenerator cannot be found\n--- Nested Exception ---\njava.lang.NoClassDefFoundError: com/objectmatter/bsf/mapping/schema/InvalidMappi\nngException\n\n\nKees.", "id": 26890, "time": "2002-11-24T12:29:03Z", "bug_id": 14806, "creation_time": "2002-11-24T12:29:03Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 14806, "attachment_id": null, "text": "I've now spent at least a day cursing the \"incompetent\" ant class loader because of this.\nChanging org.apache.tools.ant.taskdefs.Definer.addDefinition so the catch for \nNoClassDefFoundError (starting line 237) reads:\n\n        } catch (NoClassDefFoundError ncdfe) {\n            String msg = getTaskName() + \"A class needed on loading by class \" + value \n                + \" cannot be found: \" + ncdfe.getMessage();\n            throw new BuildException(msg, ncdfe, location);\n        }\n\nresults in a default message that clearly identifies the nature of the problem and the \nmissing class.", "id": 28146, "time": "2002-12-21T14:50:31Z", "creator": "davidjencks@directvinternet.com", "creation_time": "2002-12-21T14:50:31Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 14806, "attachment_id": null, "text": "David's patch applied", "id": 28147, "time": "2002-12-21T15:06:27Z", "creator": "conor@apache.org", "creation_time": "2002-12-21T15:06:27Z", "is_private": false}]