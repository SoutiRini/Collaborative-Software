[{"count": 0, "tags": [], "bug_id": 58355, "text": "On TIKA-1733, Christophe Lacroix reported this exception and attached a triggering document.\n\nI can reproduce this bug with POI's trunk.\n\nWhen I iterate through the ranges in the overall range (headerStories.getRange()), it looks like the paragraph for the first page footer should be at 2044 to 2045...then with proper handling (is this in table? yes, grab the table text), this shows that the full table offsets are 2044 through 2353.\n\nP OFFSETS:2044 -> 2045\ntable text: > <\n<ROW> Prosys - 23, rue du Capitaine Ferber - 92130 Issy-les-Moulineaux - Tel : +33 (0)1 41 23 27 77 - Fax : +33 (0)1 41 23 27 99 - www.prosys.fr - Une soci\u00e9t\u00e9 du Groupe Moniteur\u0007\u0007</ROW>\n<ROW>SAS au capital de 780 000 euros - SIRET : 344 894 985 000 52 RCS Nanterre - APE : 6202 A - TVA intracommunautaire : FR 32 344 894\u00a0985\u0007\u0007</ROW>\ntable Offsets: 2044 -> 2353\n\nWhen I run this same iteration through headerStories.getFirstFooterSubrange(),the target range is 2045-> 2355.\n\nRANGE: 2045 : 2355\nP OFFSETS:2045 : 2217\ntable text: >Prosys - 23, rue du Capitaine Ferber - 92130 Issy-les-Moulineaux - Tel : +33 (0)1 41 23 27 77 - Fax : +33 (0)1 41 23 27 99 - www.prosys.fr - Une soci\u00e9t\u00e9 du Groupe Moniteur\u0007<\n\njava.lang.IllegalArgumentException: This paragraph is not the first one in the table\n\tat org.apache.poi.hwpf.usermodel.Range.getTable(Range.java:927)\n\tat org.apache.poi.hwpf.TestHWPFRangeParts.testTableInFirstPageFooter(TestHWPFRangeParts.java:214)\n\n\nIs the file corrupt or is this an area for improvement within POI\n\nBasic debugging code:\n\tpublic void testTableInFirstPageFooter() throws Exception {\n\t\tHWPFDocument d = HWPFTestDataSamples.openSampleFile(\"TIKA-1733.doc\");\n\t\tHeaderStories headerStories = new HeaderStories(d);\n//\t\tRange r = headerStories.getFirstFooterSubrange();\n        int i = 0;\n        for (Range r : new Range[]{\n              //  headerStories.getRange(),\n                //headerStories.getFirstHeaderSubrange(),\n                headerStories.getFirstFooterSubrange(),\n                //headerStories.getOddFooterSubrange()\n        }) {\n            if (r != null) {\n                System.out.println(\"RANGE: \"+r.getStartOffset() + \" : \"+r.getEndOffset());\n                for (int j = 0; j < r.numParagraphs(); j++) {\n                    Paragraph p = r.getParagraph(j);\n                    System.out.println(\"P OFFSETS:\" +\n                            p.getStartOffset() + \" : \" +\n                            p.getEndOffset());\n                    if (p.isInTable()) {\n                        System.out.println(\"table text: >\" + p.text().replaceAll(\"[\\\\r\\\\n]\", \" \")+\"<\");\n                        Table t = r.getTable(p);\n                        for (int rNum = 0; rNum < t.numRows(); rNum++) {\n                            TableRow row = t.getRow(rNum);\n                            System.out.println(\"<ROW>\"+row.text().replaceAll(\"[\\\\r\\\\n]\", \" \")\n                                    +\"</ROW>\");\n                        }\n                        System.out.println(\"table Offsets: \" + t.getStartOffset() + \" -> \" + t.getEndOffset());\n                        j += t.numParagraphs()-1;\n                    }\n                }\n            }\n            i++;\n        }", "id": 185081, "time": "2015-09-10T16:08:32Z", "creator": "tallison@mitre.org", "creation_time": "2015-09-10T16:08:32Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 58355, "text": "Any help available on this one?  This area of the code base is new to me.  Thank you!", "id": 187394, "time": "2016-01-05T14:32:41Z", "creator": "tallison@mitre.org", "creation_time": "2016-01-05T14:32:41Z", "is_private": false, "attachment_id": null}]