[{"count": 0, "tags": [], "bug_id": 56342, "text": "Created attachment 31468\nlog file\n\nHi,\nI'm building apr with minGW-w64 (x86_64-4.8.2-release-win32-seh-rt_v3-rev3) on windows 7 but failed. Attached file is the log, can someone help me? Thanks very much.", "id": 174233, "time": "2014-04-03T03:43:46Z", "creator": "lhh@lequiossoft.com.tw", "creation_time": "2014-04-03T03:43:46Z", "is_private": false, "attachment_id": 31468}, {"count": 1, "tags": [], "bug_id": 56342, "text": "Can confirm this with MSYS2/MinGW-w64.  I'm getting the exact same build errors as lhh.\n\nError snippet:\n\nIn file included from C:/msys64/mingw64/x86_64-w64-mingw32/include/objbase.h:66:0,\n                 from C:/msys64/mingw64/x86_64-w64-mingw32/include/ole2.h:17,\n                 from C:/msys64/mingw64/x86_64-w64-mingw32/include/wtypes.h:12,\n                 from C:/msys64/mingw64/x86_64-w64-mingw32/include/accctrl.h:10,\n                 from C:/Users/Shane/Downloads/apr-1.5.1/include/arch/win32/apr_private.h:52,\n                 from C:/Users/Shane/Downloads/apr-1.5.1/include/arch/win32/apr_arch_dso.h:20,\n                 from C:/Users/Shane/Downloads/apr-1.5.1/dso/win32/dso.c:17:\nC:/msys64/mingw64/x86_64-w64-mingw32/include/objidl.h:10935:9: error: unknown type name 'CLIPFORMAT'\n typedef CLIPFORMAT *LPCLIPFORMAT;\n         ^\n\n\nFrom what I can tell, the problem lies in file dso.c when the header accctrl.h (windows API header) is imported by include/arch/win32/apr_private.h .  I've tested accctrl.h out in a small test C program and it compiles fine.  I'm inclined to believe this is an issue with the way accctrl.h is being included, as the first error reported indicates that the type CLIPFORMAT is undefined, yet this type is defined by wtypes.h (or rather, objidl.h which is included indirectly by wtypes.h), which is included by accctrl.h.  I'll do some more investigating tomorrow and come up with a patch if I can find the root cause.  My guess is that somewhere, one of the include guards for some header that includes objidl.h is being tripped up by a falsely defined macro.", "id": 175891, "time": "2014-06-19T08:53:45Z", "creator": "lookatyouhacker@gmail.com", "creation_time": "2014-06-19T08:53:45Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 56342, "text": "Hi, \n\nI just comment out the lines of the following two files, FYI\n\n1. \nmingw64/x86_64-w64-mingw32/include/wtypes.h\nline #12\n- #include <ole2.h>\n+ //#include <ole2.h>\n\n2. \nmingw64/x86_64-w64-mingw32/include/wtypesbase.h\nline #12\n- #include <ole2.h>\n+ //#include <ole2.h>", "id": 175892, "time": "2014-06-19T09:14:05Z", "creator": "lhh@lequiossoft.com.tw", "creation_time": "2014-06-19T09:14:05Z", "is_private": false, "attachment_id": null}, {"count": 3, "attachment_id": null, "creator": "trawick@apache.org", "is_private": false, "id": 175956, "time": "2014-06-21T12:27:14Z", "bug_id": 56342, "creation_time": "2014-06-21T12:27:14Z", "tags": [], "text": "Do source files other than dso.c that include apr_private.h compile successfully?"}, {"count": 4, "attachment_id": 31788, "creator": "jschewe@bbn.com", "text": "Created attachment 31788\napr-0.patch\n\nI've seen this bug as well when building apr_getpass.c. I found what appears to be an error in include/arch/win32/apr_private.h. __wtypes_h__ is defined in there rather than including it. Here is the patch that works for me using mingw 4.9.0.", "id": 176201, "time": "2014-07-03T17:59:49Z", "bug_id": 56342, "creation_time": "2014-07-03T17:59:49Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "bug_id": 56342, "is_private": false, "id": 176266, "creation_time": "2014-07-07T14:14:33Z", "time": "2014-07-07T14:14:33Z", "creator": "jschewe@bbn.com", "text": "Created attachment 31800\napr-0.patch\n\nI posted too soon. The previous patch fixes the error about CLIPFORMAT, but now I've got an error about LPMSG. I'm building apr-1.4.6 with mingw 4.8.2.\n\nThis patch fixes the LPMSG errors as well. It looks like more things are being put into wtypes.h now, so it needs to actually be included rather than just faked. There may actually be a bug in mingw around the definition and use of LPMSG as including wtypes.h *may* include ole2.h which eventually references LPMSG before it's defined in wtypes.h", "attachment_id": 31800}, {"count": 6, "attachment_id": null, "creator": "timothygu99@gmail.com", "is_private": false, "id": 179075, "time": "2014-11-13T06:18:29Z", "bug_id": 56342, "creation_time": "2014-11-13T06:18:29Z", "tags": [], "text": "Hi, I can reproduce this, and applying Jon's patch fixes this cleanly.\n\n@Jeff passwd/apr_getpass.c does not compile either, because it includes the offending header.\n\nI am changing the bug status back to NEW as I don't see any information still is to be provided, and a working patch is here."}, {"count": 7, "tags": [], "bug_id": 56342, "text": "One should rather define COM_NO_WINDOWS_H in the project to fix instead of adding patches to mingw headers.\n\nAPR compiles just fine now.", "id": 187227, "time": "2015-12-29T18:32:10Z", "creator": "sc.venkatesh@gmail.com", "creation_time": "2015-12-29T18:32:10Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 56342, "attachment_id": null, "text": "Reopening.  Nobody needs to look in bugzilla for secret sauce... If COM_NO_WINDOWS_H is the answer that should land in mingw configure.in hints.", "id": 187229, "time": "2015-12-29T20:00:54Z", "creator": "wrowe@apache.org", "creation_time": "2015-12-29T20:00:54Z", "is_private": false}]