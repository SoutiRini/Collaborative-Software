[{"count": 0, "attachment_id": null, "creator": "marjan.blatnik@gov.si", "is_private": false, "id": 30394, "time": "2003-01-31T09:28:18Z", "bug_id": 16630, "creation_time": "2003-01-31T09:28:18Z", "tags": [], "text": "1.\nFor each downloaded document from https server with client authentication, a\nbrowser (IE 5.5, IE 6.0, Mozilla-1.2.1) ask for a private key password.\n\nOn server side, I tested next combinations:\n - openssl-0.9.6g\n   openssl-0.9.7\n - Apache httpd-2.0.40\n   Apache httpd-2.0.44\n - build-in sdbm\n   gdbm 1.8.0\n - CA cert uses 2048-bits\n - server and user certs use 1024-bits\n - HP-UX 11.00: HP-UX mailhub2 B.11.00 U 9000/800 154C....\n\nI increase LogLevel to debug and next lines shows, that the session is not\nstored in dbm (sdbm or gdbm):\n[Fri Jan 31 08:26:20 2003] [debug] ssl_engine_kernel.c(1604): Inter-Process\nSession Cache: request=SET status=BAD id=04547FF214...59BCE46 timeout=294s\n(session caching)\n[Fri Jan 31 08:26:20 2003] [debug] ssl_engine_kernel.c(1604): Inter-Process\nSession Cache: request=GET status=MISSED id=04547FF214...59E159BCE46 (session\nrenewal)\n[Fri Jan 31 08:26:22 2003] [debug] ssl_engine_kernel.c(1604): Inter-Process\nSession Cache: request=SET status=BAD id=7A1E667FF...39E175C275EE timeout=298s\n(session caching)\n[Fri Jan 31 08:26:47 2003] [debug] ssl_engine_kernel.c(1604): Inter-Process\nSession Cache: request=GET status=MISSED id=7A1E667FF3...39E175C275EE (session\nrenewal)\n[Fri Jan 31 08:26:49 2003] [debug] ssl_engine_kernel.c(1604): Inter-Process\nSession Cache: request=SET status=BAD id=3B83F5CB51...AB44344 timeout=298s\n(session caching)\n[Fri Jan 31 08:26:55 2003] [debug] ssl_engine_kernel.c(1604): Inter-Process\nSession Cache: request=GET status=MISSED id=3B83F5CB51...AB44344 (session renewal)\n\nI add some debuging code to the\nmodules/ssl/ssl_scache_dbm.c:ssl_scache_dbm_store which shows, that idlen is 32\nbytes, nData(i2d_SSL_SESSION(sess, NULL)) is 1387 bytes, together 1419 bytes,\nthat is more then 950 bytes (default dbm limit in\nmodules/ssl/ssl_scache_dbm.c:ssl_scache_dbm_store).\n\nAs workaround, I change\n - modules/ssl/ssl_scache_dbm.c:ssl_scache_dbm_store\n   from\n     if ((idlen + nData) >= 950 /* at least less than approx. 1KB */)\n        return FALSE;\n   to\n     # Additional debuging code\n     # char logstr[501];\n     # snprintf(logstr,500,\"Dbm pairsize: idlen: %d,  nData: %d,  sum: %d, \nlimit: less then 2000\",idlen,nData,idlen+nData);\n     # ap_log_error(APLOG_MARK, APLOG_DEBUG, 0, s, logstr);\n     if ((idlen + nData) >= 2000\n        return FALSE;\n - srclib/apr-util/dbm/sdbm/sdbm_private.h   \n   from\n     #define DBLKSIZ 4096\n     #define PBLKSIZ 1024\n     #define PAIRMAX 1008                    /* arbitrary on PBLKSIZ-N */\n   to\n     #define DBLKSIZ 16384\n     #define PBLKSIZ 8192\n     #define PAIRMAX 8008                    /* arbitrary on PBLKSIZ-N */\n\n2. Not a bug, just for information\nAt the upgrade from openssl-0.9.6g to openssl-0.9.7 I noticed that the\nserial number atribute name in env. variable SSL_CLIENT_S_DN changed from\nSN=... to serialNumber=..."}, {"count": 1, "tags": [], "bug_id": 16630, "attachment_id": null, "text": "This is one of the limitations of the dbm session cache; using the shmcb session\ncache instead is the best option; so this bug is a WONTFIX really.  A log\nmessage was added for this issue in recent 2.0 release, to make it easier to\ndiagnose.  \n\nThanks for the report.", "id": 58600, "time": "2004-06-03T09:00:17Z", "creator": "jorton@redhat.com", "creation_time": "2004-06-03T09:00:17Z", "is_private": false}]