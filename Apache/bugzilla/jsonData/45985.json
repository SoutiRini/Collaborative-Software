[{"count": 0, "attachment_id": null, "bug_id": 45985, "is_private": false, "id": 121396, "time": "2008-10-10T03:48:15Z", "creator": "jiri.walek@polarion.com", "creation_time": "2008-10-10T03:48:15Z", "tags": [], "text": "When navigating to http://host/webbapp the url is changed to http://host/webapp/?.\nEspecially ugly for AJAX applications where the # navigation is used heavily. In our product the url http://HOST/polarion  is changed to http://HOST/polarion/? and later http://HOST/polarion/?#/project/demo.\n\nThe fix is trivial, applicable also to Tomcat 6.\n\nIn CoyoteAdapter\n(http://svn.apache.org/repos/asf/tomcat/trunk/java/org/apache/catalina/connector/CoyoteAdapter.java)\n\nchange \n\n            if (query != null) {\n                // This is not optimal, but as this is not very common, it\n                // shouldn't matter\n                redirectPath = redirectPath + \"?\" + query;\n            }\n\nto \n            if (query != null && query.length()>0) {\n                // This is not optimal, but as this is not very common, it\n                // shouldn't matter\n                redirectPath = redirectPath + \"?\" + query;\n            }\n\nTested on patched version apache-tomcat-5.5.16-embed and it works fine."}, {"count": 1, "tags": [], "bug_id": 45985, "text": "This is a regression that is fixed in 5.5.17 onwards and all of 6.0.x", "id": 121399, "time": "2008-10-10T05:02:21Z", "creator": "markt@apache.org", "creation_time": "2008-10-10T05:02:21Z", "is_private": false, "attachment_id": null}]