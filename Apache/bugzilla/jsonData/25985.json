[{"count": 0, "tags": [], "bug_id": 25985, "text": "In mode MATCH_MULTILINE the end-of-line char $ does not work.\n\nTest case:\n\nRE re = new RE(\"^a$\", RE.MATCH_MULTILINE);\nSystem.out.println(re.match(\"\\r\\na\\r\\n\"));\nSystem.out.println(re.subst(\"\\r\\na\\r\\n\", \"b\", RE.REPLACE_BACKREFERENCES));\n\nExcepted results:\ntrue / b\n\nActual results:\nfalse / a", "id": 50245, "time": "2004-01-08T12:55:13Z", "creator": "nhb_web@nexgo.de", "creation_time": "2004-01-08T12:55:13Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 25985, "attachment_id": null, "text": "I think that match() doesn't work due to bug #4137.\nI've verified that the problem is gone when suggested fix for 4137 applied.\n\nBut after this I get exception in subst()\nException in thread \"main\" java.lang.StringIndexOutOfBoundsException: String ind\nex out of range: -1\n        at java.lang.String.substring(String.java:1480)\n        at org.apache.regexp.RE.subst(RE.java:1784)\n        at Bug25985.main(Bug25985.java:9)\nIt occured because we specify RE.REPLACE_BACKREFERENCES flag for subst(), but \nsubstitution parameter dosn't contain any such references.  Thus we try to \nexecute the following line:\n                // Append everything after the last $ sign\n                ret.append(substitution.substring(lLastPosition+2,lLength));\nwhen lLength == 1 and lLastPosition == 0 (so, start position more then end one)\nTo fix this problem we can just change default value of lLastPosition to -2\n(so if there is no $ in substitution param we will add substitution itself)\n", "id": 50300, "time": "2004-01-09T04:15:20Z", "creator": "son@sparc.spb.su", "creation_time": "2004-01-09T04:15:20Z", "is_private": false}, {"count": 2, "tags": [], "creator": "vgritsenko@apache.org", "attachment_id": null, "is_private": false, "id": 51512, "time": "2004-01-31T00:15:22Z", "bug_id": 25985, "creation_time": "2004-01-31T00:15:22Z", "text": "Ok, changing initial value of lLastPosition to -2 fixed exception in case of:\n  r = new RE(\"^a$\");\n  s = r.subst(\"a\", \"b\", RE.REPLACE_BACKREFERENCES);\n\nBut in case when input has new lines result after subst also contains new lines.\nSo this:\n  r = new RE(\"^a$\", RE.MATCH_MULTILINE);\n  s = r.subst(\"\\r\\na\\r\\n\", \"b\", RE.REPLACE_BACKREFERENCES);\nResults in s == \"\\r\\nb\\r\\n\".\nIs this expected?\n\nVadim\n"}, {"count": 3, "tags": [], "creator": "son@sparc.spb.su", "attachment_id": null, "text": "I think this is correct behavior because after\n  r = new RE(\"^a$\", RE.MATCH_MULTILINE);\n  s = re.match(\"\\r\\na\\r\\n\");\n\ns == \"a\" (neither \"\\r\\na\\r\\n\", \"\\r\\na\" or \"a\\r\\n\"), and we replace it with \"b\"", "id": 52059, "time": "2004-02-10T15:56:54Z", "bug_id": 25985, "creation_time": "2004-02-10T15:56:54Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 25985, "text": "Patches are already applied; closing this bug.", "id": 53078, "time": "2004-02-27T02:39:28Z", "creator": "vgritsenko@apache.org", "creation_time": "2004-02-27T02:39:28Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 25985, "text": "*** Bug 27740 has been marked as a duplicate of this bug. ***", "id": 54237, "time": "2004-03-18T18:45:40Z", "creator": "vgritsenko@apache.org", "creation_time": "2004-03-18T18:45:40Z", "is_private": false, "attachment_id": null}]