[{"count": 0, "tags": [], "bug_id": 19237, "attachment_id": null, "is_private": false, "id": 35829, "time": "2003-04-22T22:43:39Z", "creator": "riznob@hotmail.com", "creation_time": "2003-04-22T22:43:39Z", "text": "The success/failure of the sshexec task is only dependant on whether or not you \ncan connect to the remote host. The task should evaluate the exit status of the \nremote command to determine the success or failure of the task."}, {"count": 1, "tags": [], "text": "This looks to me to be a deficiency in the underlying jsch API. The code is in\nthat library to get the exit status (there's a commented out System.out.println\nfor the proper exit status in the Session.java file where they handle the ssh\nexit_status message), but it seems to be thrown away with no way to return it to\nthe caller.\n\nThis is probably not too hard to fixup, but it does require (I think) modifying\nthe jsch library.", "is_private": false, "id": 43221, "creation_time": "2003-08-24T22:43:30Z", "time": "2003-08-24T22:43:30Z", "creator": "rob@bigdis.com", "bug_id": 19237, "attachment_id": null}, {"count": 2, "tags": [], "text": "Created attachment 7931\nPatch to jsch 0.16 Session.java to support exit-status retrieval", "attachment_id": 7931, "id": 43223, "creator": "rob@bigdis.com", "time": "2003-08-25T04:08:57Z", "bug_id": 19237, "creation_time": "2003-08-25T04:08:57Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 19237, "attachment_id": 7932, "id": 43224, "time": "2003-08-25T04:10:07Z", "creator": "rob@bigdis.com", "creation_time": "2003-08-25T04:10:07Z", "is_private": false, "text": "Created attachment 7932\nPatch for SSHExec.java task to retrieve status code (requries patch to jsch)"}, {"count": 4, "attachment_id": null, "bug_id": 19237, "is_private": false, "id": 43225, "time": "2003-08-25T04:13:24Z", "creator": "rob@bigdis.com", "creation_time": "2003-08-25T04:13:24Z", "tags": [], "text": "I've included two patches; one for SSHExec.java on the ant side, and one for\njsch (against .16) that allow retrieval of the status codes. It's likely an\nawful hack, but it does seem to work. Of course, this would have to incorporated\ninto jsch itself if the ant patch were to be included (assuming that the method\nI used on the jsch side is correct and okay)."}, {"count": 5, "tags": [], "bug_id": 19237, "attachment_id": 7947, "id": 43303, "time": "2003-08-26T03:48:10Z", "creator": "rob@bigdis.com", "creation_time": "2003-08-26T03:48:10Z", "is_private": false, "text": "Created attachment 7947\nNew patch compatible with jsch .17 changes."}, {"count": 6, "tags": [], "bug_id": 19237, "attachment_id": null, "id": 43304, "time": "2003-08-26T03:51:11Z", "creator": "rob@bigdis.com", "creation_time": "2003-08-26T03:51:11Z", "is_private": false, "text": "The changes to jsch were no good; the developers there straightened things out\nand incorporate them into .17 which should be out very shortly. The latest\nattachment (patch.17) is the version of SSHExec.java that will work property\nagainst the new jsch libs, as tested against jsch-0.17-rc3. Tested that the\ndesired results happened with a successful command, unsucessful command, and\nboth ways again with \"failonerror\" disabled."}, {"count": 7, "tags": [], "bug_id": 19237, "attachment_id": null, "id": 43315, "time": "2003-08-26T07:42:19Z", "creator": "bodewig@apache.org", "creation_time": "2003-08-26T07:42:19Z", "is_private": false, "text": "I'll look into the patch once jsch 0.17 has been released."}, {"count": 8, "tags": [], "text": "OK, fixed with nightly build 2003-08-29.\n\nI've modified the patch slightly to make the failonerror handling more explicit.\nI also added a comment that the code is going to fail if the remote OS is\nOpenVMS as the exit code semantics are different there.  Unfortunately I don't see\na way to detect the remote OS.", "attachment_id": null, "bug_id": 19237, "id": 43424, "time": "2003-08-28T07:15:08Z", "creator": "bodewig@apache.org", "creation_time": "2003-08-28T07:15:08Z", "is_private": false}, {"count": 9, "attachment_id": null, "bug_id": 19237, "is_private": false, "id": 43430, "time": "2003-08-28T14:37:23Z", "creator": "rob@bigdis.com", "creation_time": "2003-08-28T14:37:23Z", "tags": [], "text": "That's a good point about exit codes; I've probably seen some individual\ncommands  on more common OS's before that do strange things with exit codes. How\nabout if an attribute was added to the task that just defaulted to zero but\nallowed the user to override what exit code constituted a success like\n\"successcode=0\" or =1, or =127, or whatever makes sense for the command/OS that\nyou are using?\n\nPatch for code (SSHExec.java) and documentation (sshexec.html) included if\ninterested."}, {"count": 10, "tags": [], "bug_id": 19237, "attachment_id": 7983, "is_private": false, "id": 43435, "time": "2003-08-28T14:53:35Z", "creator": "rob@bigdis.com", "creation_time": "2003-08-28T14:53:35Z", "text": "Created attachment 7983\nPatch to support changing exit-status definition of success"}, {"count": 11, "attachment_id": 7984, "bug_id": 19237, "is_private": false, "id": 43436, "time": "2003-08-28T14:53:57Z", "creator": "rob@bigdis.com", "creation_time": "2003-08-28T14:53:57Z", "tags": [], "text": "Created attachment 7984\ndocumentation update associated with successcode patch."}]