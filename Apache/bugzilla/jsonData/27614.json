[{"count": 0, "tags": [], "text": "Below is the full thread dump:\n\nFull thread dump Java HotSpot(TM) Client VM (1.4.1_05-b01 mixed mode):\n\n\"Thread-8\" daemon prio=5 tid=0xc89e8 nid=0x17 runnable [f1eff000..f1effc24]\n        at java.io.FileInputStream.readBytes(Native Method)\n        at java.io.FileInputStream.read(FileInputStream.java:174)\n        at java.lang.UNIXProcess$DeferredCloseInputStream.read\n(UNIXProcess.java:210)\n        at org.apache.tools.ant.taskdefs.StreamPumper.run(StreamPumper.java:82)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"Thread-7\" daemon prio=5 tid=0xc8850 nid=0x16 runnable [f1fff000..f1fffc24]\n        at java.io.FileOutputStream.writeBytes(Native Method)\n        at java.io.FileOutputStream.write(FileOutputStream.java:257)\n        at java.io.PrintStream.write(PrintStream.java:258)\n        - locked <f2f82fa0> (a java.io.PrintStream)\n        at java.io.PrintStream.write(PrintStream.java:258)\n        - locked <f2f199a8> (a java.io.PrintStream)\n        at sun.nio.cs.StreamEncoder$CharsetSE.writeBytes(StreamEncoder.java:336)\n        at sun.nio.cs.StreamEncoder$CharsetSE.implFlushBuffer\n(StreamEncoder.java:404)\n        at sun.nio.cs.StreamEncoder.flushBuffer(StreamEncoder.java:115)\n        - locked <f2f23828> (a java.io.OutputStreamWriter)\n        at java.io.OutputStreamWriter.flushBuffer(OutputStreamWriter.java:169)\n        at java.io.PrintStream.write(PrintStream.java:305)\n        - locked <f2f199a8> (a java.io.PrintStream)\n        at java.io.PrintStream.print(PrintStream.java:448)\n        at java.io.PrintStream.println(PrintStream.java:585)\n        - locked <f2f199a8> (a java.io.PrintStream)\n        at org.apache.tools.ant.DefaultLogger.printMessage\n(DefaultLogger.java:293)\n        at org.apache.tools.ant.DefaultLogger.messageLogged\n(DefaultLogger.java:259)\n        at org.apache.tools.ant.Project.fireMessageLoggedEvent\n(Project.java:1907)\n        - locked <f2f82f18> (a org.apache.tools.ant.Project)\n        at org.apache.tools.ant.Project.fireMessageLogged(Project.java:1956)\n        at org.apache.tools.ant.Project.log(Project.java:396)\n        at org.apache.tools.ant.Task.log(Task.java:347)\n        at org.apache.tools.ant.taskdefs.LogOutputStream.processLine\n(LogOutputStream.java:116)\n        at org.apache.tools.ant.taskdefs.LogOutputStream.processLine\n(LogOutputStream.java:107)\n        at org.apache.tools.ant.taskdefs.LogOutputStream.processBuffer\n(LogOutputStream.java:97)\n        at org.apache.tools.ant.taskdefs.LogOutputStream.write\n(LogOutputStream.java:77)\n        at org.apache.tools.ant.taskdefs.LogOutputStream.write\n(LogOutputStream.java:159)\n        at org.apache.tools.ant.taskdefs.StreamPumper.run(StreamPumper.java:83)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"process reaper\" daemon prio=5 tid=0xc7c48 nid=0x15 runnable \n[f1dff000..f1dffc24]\n        at java.lang.UNIXProcess.waitForProcessExit(Native Method)\n        at java.lang.UNIXProcess.access$1000(UNIXProcess.java:20)\n        at java.lang.UNIXProcess$3.run(UNIXProcess.java:84)\n\n\"Signal Dispatcher\" daemon prio=10 tid=0xb9bb0 nid=0x7 waiting on condition \n[0..0]\n\n\"Finalizer\" daemon prio=8 tid=0xb60c0 nid=0x4 in Object.wait() \n[faaff000..faaffc24]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <f2f82ea8> (a java.lang.ref.ReferenceQueue$Lock)\n        at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:111)\n        - locked <f2f82ea8> (a java.lang.ref.ReferenceQueue$Lock)\n        at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:127)\n        at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:159)\n\n\"Reference Handler\" daemon prio=10 tid=0xb47a0 nid=0x3 in Object.wait() \n[fcd7f000..fcd7fc24]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <f2f82f10> (a java.lang.ref.Reference$Lock)\n        at java.lang.Object.wait(Object.java:426)\n        at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:113)\n        - locked <f2f82f10> (a java.lang.ref.Reference$Lock)\n\n\"main\" prio=5 tid=0x2d6b0 nid=0x1 in Object.wait() [ffbfd000..ffbfe7cc]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <f3752858> (a java.lang.UNIXProcess)\n        at java.lang.Object.wait(Object.java:426)\n        at java.lang.UNIXProcess.waitFor(UNIXProcess.java:113)\n        - locked <f3752858> (a java.lang.UNIXProcess)\n        at org.apache.tools.ant.taskdefs.Execute.waitFor(Execute.java:532)\n        at org.apache.tools.ant.taskdefs.Execute.execute(Execute.java:481)\n        at \norg.apache.tools.ant.taskdefs.optional.junit.JUnitTask.executeAsForked\n(JUnitTask.java:778)\n        at org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.execute\n(JUnitTask.java:629)\n        at org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.execute\n(JUnitTask.java:600)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:269)\n        at org.apache.tools.ant.Task.perform(Task.java:364)\n        at org.apache.tools.ant.Target.execute(Target.java:301)\n        at org.apache.tools.ant.Target.performTasks(Target.java:328)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1215)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1063)\n        at org.apache.tools.ant.Main.runBuild(Main.java:632)\n        at org.apache.tools.ant.Main.startAnt(Main.java:183)\n        at org.apache.tools.ant.Main.start(Main.java:147)\n        at org.apache.tools.ant.Main.main(Main.java:230)\n\n\"VM Thread\" prio=5 tid=0xb3318 nid=0x2 runnable\n\n\"VM Periodic Task Thread\" prio=10 tid=0xb8910 nid=0x5 waiting on condition\n\"Suspend Checker Thread\" prio=10 tid=0xb9260 nid=0x6 runnable\n\n\nThis happens to Ant 1.5.4 also and the thread dump follows:\n\n^\\Full thread dump Java HotSpot(TM) Client VM (1.4.1_05-b01 mixed mode):\n\n\"Thread-7\" daemon prio=5 tid=0x81ac00 nid=0x11 runnable [f1fff000..f1fffc24]\n        at java.io.FileInputStream.readBytes(Native Method)\n        at java.io.FileInputStream.read(FileInputStream.java:174)\n        at java.lang.UNIXProcess$DeferredCloseInputStream.read\n(UNIXProcess.java:210)\n        at org.apache.tools.ant.taskdefs.StreamPumper.run(StreamPumper.java:105)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"Thread-6\" daemon prio=5 tid=0x81aa68 nid=0x10 runnable [f1dff000..f1dffc24]\n        at java.io.FileInputStream.readBytes(Native Method)\n        at java.io.FileInputStream.read(FileInputStream.java:191)\n        at java.lang.UNIXProcess$DeferredCloseInputStream.read\n(UNIXProcess.java:219)\n        at java.io.BufferedInputStream.fill(BufferedInputStream.java:183)\n        at java.io.BufferedInputStream.read1(BufferedInputStream.java:222)\n        at java.io.BufferedInputStream.read(BufferedInputStream.java:277)\n        - locked <f4055398> (a java.io.BufferedInputStream)\n        at java.io.FilterInputStream.read(FilterInputStream.java:90)\n        at org.apache.tools.ant.taskdefs.StreamPumper.run(StreamPumper.java:105)\n        at java.lang.Thread.run(Thread.java:536)\n\n\"process reaper\" daemon prio=5 tid=0x81a8d0 nid=0xf runnable \n[f1eff000..f1effc24]\n        at java.lang.UNIXProcess.waitForProcessExit(Native Method)\n        at java.lang.UNIXProcess.access$1000(UNIXProcess.java:20)\n        at java.lang.UNIXProcess$3.run(UNIXProcess.java:84)\n\n\"Signal Dispatcher\" daemon prio=10 tid=0xb9058 nid=0x7 waiting on condition \n[0..0]\n\n\"Finalizer\" daemon prio=8 tid=0xb5568 nid=0x4 in Object.wait() \n[f2b7f000..f2b7fc24]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <f3360cc0> (a java.lang.ref.ReferenceQueue$Lock)\n        at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:111)\n        - locked <f3360cc0> (a java.lang.ref.ReferenceQueue$Lock)\n        at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:127)\n        at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:159)\n\n\"Reference Handler\" daemon prio=10 tid=0xb3c48 nid=0x3 in Object.wait() \n[facff000..facffc24]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <f3360d28> (a java.lang.ref.Reference$Lock)\n        at java.lang.Object.wait(Object.java:426)\n        at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:113)\n        - locked <f3360d28> (a java.lang.ref.Reference$Lock)\n\n\"main\" prio=5 tid=0x2cb48 nid=0x1 in Object.wait() [ffbfe000..ffbfed94]\n        at java.lang.Object.wait(Native Method)\n        - waiting on <f40554b0> (a java.lang.UNIXProcess)\n        at java.lang.Object.wait(Object.java:426)\n        at java.lang.UNIXProcess.waitFor(UNIXProcess.java:113)\n        - locked <f40554b0> (a java.lang.UNIXProcess)\n        at org.apache.tools.ant.taskdefs.Execute.waitFor(Execute.java:466)\n        at org.apache.tools.ant.taskdefs.Execute.execute(Execute.java:448)\n        at \norg.apache.tools.ant.taskdefs.optional.junit.JUnitTask.executeAsForked\n(JUnitTask.java:685)\n        at org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.execute\n(JUnitTask.java:559)\n        at org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.execute\n(JUnitTask.java:532)\n        at org.apache.tools.ant.Task.perform(Task.java:341)\n        at org.apache.tools.ant.Target.execute(Target.java:309)\n        at org.apache.tools.ant.Target.performTasks(Target.java:336)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1339)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1255)\n        at org.apache.tools.ant.Main.runBuild(Main.java:609)\n        at org.apache.tools.ant.Main.start(Main.java:196)\n        at org.apache.tools.ant.Main.main(Main.java:235)\n\n\"VM Thread\" prio=5 tid=0xb27b0 nid=0x2 runnable\n\n\"VM Periodic Task Thread\" prio=10 tid=0xb7db8 nid=0x5 waiting on condition\n\"Suspend Checker Thread\" prio=10 tid=0xb8708 nid=0x6 runnable", "attachment_id": null, "bug_id": 27614, "id": 53890, "time": "2004-03-11T19:36:17Z", "creator": "henry.li@expeditors.com", "creation_time": "2004-03-11T19:36:17Z", "is_private": false}, {"count": 1, "tags": [], "text": "With the Ant 1.5.4, it hangs sometime but passes sometime. With Ant 1.6.1 it \nhangs everytime so far. The same set of JUnit test cases ran without being hang \nif not ran under Ant.", "attachment_id": null, "id": 53892, "creator": "henry.li@expeditors.com", "time": "2004-03-11T20:01:35Z", "bug_id": 27614, "creation_time": "2004-03-11T20:01:35Z", "is_private": false}, {"count": 2, "attachment_id": null, "bug_id": 27614, "text": "Can you provide an example build file that shows the problem?", "id": 67801, "time": "2004-12-02T18:43:15Z", "creator": "peterreilly@apache.org", "creation_time": "2004-12-02T18:43:15Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "text": "Does it hang if you don't fork <junit>?\n\nAre you writing to System.out/.err in your tests or reading from System.in?", "attachment_id": null, "id": 72215, "creator": "bodewig@apache.org", "time": "2005-03-11T17:13:10Z", "bug_id": 27614, "creation_time": "2005-03-11T17:13:10Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 27614, "attachment_id": null, "id": 94786, "time": "2006-10-12T13:32:40Z", "creator": "toby@caboteria.org", "creation_time": "2006-10-12T13:32:40Z", "is_private": false, "text": "I've got the same thing happening to me, but I'm using the <java> task instead\nof <junit>.  If I fork=\"true\" the child and run it in the background (in\nGNU/Linux) then it blocks on a signal, and if I don't fork it it's fine.  If,\nafter it blocks, I bring it to the foreground, it will then proceed.\n\nI worked around the problem by adding an input=\"/dev/null\" attribute to the java\nelement, so it looks as if some code in junit depends on having stdin (even\nthough it doesn't appear to read from it).\n\nDoes anyone know how to get a thread dump of the child process?  If I redirect\nthe child's stdout and stderr to files and \"kill -3\" the child I don't get the\nthread dump in either the out or err files."}, {"count": 5, "tags": [], "bug_id": 27614, "attachment_id": null, "id": 95215, "time": "2006-10-30T16:22:54Z", "creator": "jglick@apache.org", "creation_time": "2006-10-30T16:22:54Z", "is_private": false, "text": "Anything involving <java> would be a separate bug. BTW to get a thread dump on\nrecent JDKs you can use jstack; find the right process using jps -lm."}, {"count": 6, "tags": [], "bug_id": 27614, "text": "can't fix without more information", "id": 118471, "time": "2008-07-10T08:04:34Z", "creator": "bodewig@apache.org", "creation_time": "2008-07-10T08:04:34Z", "is_private": false, "attachment_id": null}]