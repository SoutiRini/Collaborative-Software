[{"count": 0, "tags": [], "creator": "mmoiroux@sopragroup.com", "text": "Hello,\nI am using tomcat 5.0.27 embedded (great!) and i need to use datasource. I \nhave tried two differents ways to append a datasource to standardContext.\nFirst way work nice:\n     StandardContext standardContext = embedded.createContext(...,...)     \n     ...\n     ContextResource contextResource = new ContextResource();\n     contextResource.setType(DataSource.class.getName());\n     contextResource.setName(\"jdbc/name\");\n     standardContext.addResource(contextResource);\n     ....\nbut i was expected the second way works too (as it seems to me be only a \nshorter way to proceed):\n     StandardContext standardContext = embedded.createContext(...,...)     \n     ...\n     standardContext.addResource(\"jdbc/name\",DataSource.class.getName());\n     ...\nbut it throw a nullPointerException line 5220 in StandardContext because a \nvariable (namely \"managed\") is null after a call to Registry.findManagedBean\n(\"ContextResource\")...\n\nI hope it could help you. \nRegards,\nMatthieu Moiroux", "id": 61179, "time": "2004-07-27T14:21:31Z", "bug_id": 30347, "creation_time": "2004-07-27T14:21:31Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "yoavs@computer.org", "text": "If you do it the second way, you must ensure the JMX beans for the Context and \nits Container are properly initialized, via the preRegisterJMX and registerJMX \nmethod.\n\nI suggest using the first way with Tomcat 5.0.27.  For Tomcat 5.1, this code \nhas been seriously re-written and you will not run into this error again.  So \nrather than muck with this piece of code knowing it's already re-written for \nTomcat 5.1, I'm going to resolve this issue as WONTFIX.  Thanks for reporting \nit, though.", "id": 61246, "time": "2004-07-28T15:28:52Z", "bug_id": 30347, "creation_time": "2004-07-28T15:28:52Z", "is_private": false, "attachment_id": null}]