[{"count": 0, "tags": [], "bug_id": 41469, "attachment_id": null, "id": 98540, "creation_time": "2007-01-25T19:03:01Z", "time": "2007-01-25T19:03:01Z", "creator": "cqm56@yahoo.com.cn", "text": "code:\n  PowerPointExtractor pe = new PowerPointExtractor(getStreamToIndex());//error \n\t\t\tSystem.out.println(pe.getNotes());\n\t\t\tcontents = pe.getText(true , true);\n\t\t\tSystem.out.println(contents);\n\nException:\n\njava.lang.ArrayIndexOutOfBoundsException: 8\nat org.apache.poi.util.HexDump.toHex(HexDump.java:406)\n\tat org.apache.poi.util.HexDump.toHex(HexDump.java:397)\n\tat org.apache.poi.hpsf.UnsupportedVariantTypeException.<init>\n(UnsupportedVariantTypeException.java:46)\n\tat org.apache.poi.hpsf.ReadingNotSupportedException.<init>\n(ReadingNotSupportedException.java:44)\n\tat org.apache.poi.hpsf.VariantSupport.read(VariantSupport.java:276)\n\tat org.apache.poi.hpsf.Property.<init>(Property.java:162)\n\tat org.apache.poi.hpsf.Section.<init>(Section.java:280)\n\tat org.apache.poi.hpsf.PropertySet.init(PropertySet.java:453)\n\tat org.apache.poi.hpsf.PropertySet.<init>(PropertySet.java:248)\n\tat org.apache.poi.hpsf.PropertySetFactory.create\n(PropertySetFactory.java:60)\n\tat org.apache.poi.POIDocument.getPropertySet(POIDocument.java:91)\n\tat org.apache.poi.POIDocument.readProperties(POIDocument.java:68)\n\tat org.apache.poi.hslf.HSLFSlideShow.<init>(HSLFSlideShow.java:128)\n\tat org.apache.poi.hslf.HSLFSlideShow.<init>(HSLFSlideShow.java:94)\n\tat org.apache.poi.hslf.extractor.PowerPointExtractor.<init>\n(PowerPointExtractor.java:84)\n\tat lius.index.powerpoint.PPTIndexer.getContent(PPTIndexer.java:72)", "is_private": false}, {"count": 1, "tags": [], "text": "Seems to be an error from HPSF, when HSLF loads the properties.\n\nCould you attach the problem file to the bug, so some can look into why HPSF\nisn't liking it?", "is_private": false, "id": 98559, "creator": "apache@gagravarr.org", "time": "2007-01-26T04:38:24Z", "bug_id": 41469, "creation_time": "2007-01-26T04:38:24Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 41469, "attachment_id": null, "id": 98662, "time": "2007-01-28T19:11:27Z", "creator": "cqm56@yahoo.com.cn", "creation_time": "2007-01-28T19:11:27Z", "is_private": false, "text": "I don't change properties ,I just writed by prquick-guide.pdf simply.\n\ncode:\npublic String getContent() {\n\t\tString contents = \"\";\n\t\ttry {\n\t\t\t\n\t\t\t\n\t\t\t/**error*/\n\t\t\tPowerPointExtractor pe = new PowerPointExtractor\n(getStreamToIndex()); //getStreamToIndex() is InputStream\n\t\t\tSystem.out.println(pe.getNotes());\n\t\t\tcontents = pe.getText(true , true);\n\t\t\tSystem.out.println(contents);\n\t\t\t\n                         /**error too*/\n\t\t\t/*SlideShow ss = new SlideShow(new HSLFSlideShow\n(getStreamToIndex()));\n\t\t\tString text = ss.getSlides()[0].getNotesSheet\n().toString();\n\t\t\tSystem.out.println(text);*/\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t/****** success  ****/\n\t\t\t/*QuickButCruddyTextExtractor qt = new \nQuickButCruddyTextExtractor(getStreamToIndex());\n\t\t\tcontents =  qt.getTextAsString();\n\t\t\tSystem.out.println(contents);*/\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t\t\t\t\n\t\t\t\n\t\t\t\n\t\t} catch (Exception ex) {\n\t\t\tex.printStackTrace();\n\t\t\tlogger.error(ex.getMessage());\n\t\t}\n\t\treturn contents;\n\t}"}, {"count": 3, "tags": [], "bug_id": 41469, "attachment_id": null, "is_private": false, "id": 98673, "time": "2007-01-29T02:48:41Z", "creator": "apache@gagravarr.org", "creation_time": "2007-01-29T02:48:41Z", "text": "Can you attach the document you're working with?\n\nYou're not changing the properties, but HSLF still tries to load them when you\ninit the HSLFSlideShow object, and the HPSF properties stuff isn't liking your\ndocument."}, {"count": 4, "tags": [], "creator": "cqm56@yahoo.com.cn", "is_private": false, "text": "Created attachment 19482\nedit with Microsoft Office 2003\n\nI am a chinese user", "id": 98728, "time": "2007-01-29T18:32:51Z", "bug_id": 41469, "creation_time": "2007-01-29T18:32:51Z", "attachment_id": 19482}, {"count": 5, "tags": [], "bug_id": 41469, "attachment_id": null, "is_private": false, "id": 98737, "time": "2007-01-29T21:46:48Z", "creator": "klute@apache.org", "creation_time": "2007-01-29T21:46:48Z", "text": "I cannot see any problems with the document using a) poibrowser to display the\nproperties and b) running the HPSF testcases with the document in question in\nsrc/testcases/org/apache/poi/hpsf/data.\n\nPlease retry with the latest subversion repository snapshot and reopen the bug\nif necessary."}, {"count": 6, "tags": [], "text": "thanks for your solution.", "attachment_id": null, "id": 98738, "creator": "cqm56@yahoo.com.cn", "time": "2007-01-29T22:08:41Z", "bug_id": 41469, "creation_time": "2007-01-29T22:08:41Z", "is_private": false}]