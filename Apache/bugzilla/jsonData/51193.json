[{"count": 0, "tags": [], "text": "Created attachment 26994\nThe used Excel-File  with Exception\n\nHi ,\nI use the liblary poi-3.7-20101029.jar. By reading an excel-File in the function\ncell.getCellType() throw null exception.", "is_private": false, "id": 146294, "creator": "julia.faifer@capgemini.com", "time": "2011-05-13T08:48:36Z", "bug_id": 51193, "creation_time": "2011-05-13T08:48:36Z", "attachment_id": 26994}, {"count": 1, "tags": [], "creator": "julia.faifer@capgemini.com", "text": "The exception is thrown by reading the attachment file in the row number 1.", "id": 146295, "time": "2011-05-13T09:06:23Z", "bug_id": 51193, "creation_time": "2011-05-13T09:06:23Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "apache@gagravarr.org", "text": "Are you sure that your variable cell isn't null?\n\nCan you please post the code required to trigger your problem?", "id": 146299, "time": "2011-05-13T09:09:28Z", "bug_id": 51193, "creation_time": "2011-05-13T09:09:28Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "julia.faifer@capgemini.com", "text": "\t\tCell cell = sheet.getRow(getIntValueRowID(rowID)).getCell(getIntValue(colID));\n\t\t\t //  \tSystem.out.println(\"Type \" + cell.getCellType());\n\t\t\t   \t\n\t\t\t   \t\n\t\t\t   \t//System.out.println( cell.getCellStyle());\n\t\t\t   \t\n\t\t\t   \tswitch(cell.getCellType()) {\n\t\t\t\tcase org.apache.poi.ss.usermodel.Cell.CELL_TYPE_STRING:\n\t\t\t\t\tvalue = cell.getStringCellValue();\t\t\t\t\t\t\t\n\t\t\t\t\tbreak;\n\t\t\t\tcase org.apache.poi.ss.usermodel.Cell.CELL_TYPE_NUMERIC:\n\t\t\t\t\tif(org.apache.poi.hssf.usermodel.HSSFDateUtil.isCellDateFormatted(cell)) {\n\t\t\t\t\t\tvalue = cell.getDateCellValue().toString();\t\t\t\t\t\t\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalue = cell.getNumericCellValue() +\"\";\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase org.apache.poi.ss.usermodel.Cell.CELL_TYPE_BOOLEAN:\n\t\t\t\t\tvalue = Boolean.toString(cell.getBooleanCellValue());\t\t\t\t\t\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase org.apache.poi.ss.usermodel.Cell.CELL_TYPE_ERROR:\n\t\t\t\t\tvalue = null;\n\t\t\t\t    break;\n\t\t\t\t    \n\t\t\t\tcase org.apache.poi.ss.usermodel.Cell.CELL_TYPE_BLANK:\n\t\t\t\t\tvalue=null;\n\t\t\t\t    break;\n\t\t\t\t\n\t\t\t\tcase org.apache.poi.ss.usermodel.Cell.CELL_TYPE_FORMULA:\n\t\t\t\t\t//Formula cells have the formula string, as well as the formula result, which can be numeric or string.\t\t\t\t\n\t\t\t\t\ttry{\n\t\t\t\t\t\t// get the formula result as string\n\t\t\t\t\t\tvalue = cell.getStringCellValue();\t\n\t\t\t\t\t}\t\n\t\t\t\t    catch (Exception e) {\n\t\t\t\t\t\t//wenn eine Exception ausf\u00e4llt, dann gib es als ein Number wert zur\u00fcck\n\t\t\t\t    \tvalue = Double.toString((cell.getNumericCellValue()));\t\t\n\t\t\t\t    }\n\t\t\t\t\tbreak;\t\t\t\t\t\n\t\t\t\tdefault:\n\t\t\t\t\tvalue = null;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t   \t\t\t\t\t\t\t\t\t\n\t\t\t    String errorMessage = null;\n\t\t\n\t\t\t    if (checkEmpty && (value == null || value.length() == 0)) {\n\t\t\t\t    \terrorMessage = \"Wert in Feld: \" + colID + rowID + \" ist leer!\";\n\t\t\t    } else if (datatype != null) {\n\t\t\t\t\tif (!checkDataType(value, datatype)) {\t\t\t\t\t\n\t\t\t\t\t   // vorgegeben typen: String, numerische datens\t\t\t\t \n\t     \t\t\t   errorMessage = TEXT_UNERWARTET + colID + rowID + \", Arbeitsblatt: \" + sheetName + \" Erwartet war: \"+ datatype;\n\t\t\t\t\t}\n\t\t\t    }\t\n\t\t\t    // Fehler Ausgeben falls vorhanden\n\t\t\t    if (errorMessage != null) {\n\t\t\t    \thandleError(errorMessage);\n\t\t\t    }\n\t\t\t}catch(Exception e){\n\t\t\t\t//throw new ContentAccessException(\"Zugriff auf Zelle \" + colID + rowID + \" nicht m\u00f6glich.\" + e.getMessage());\n\t\t\t\t String message = \"Zugriff auf Zelle \" + colID + rowID + \" nicht m\u00f6glich.\"+ e.getMessage();\n    \t\t\t reportError(message);\n\t\t\t}", "id": 146647, "time": "2011-05-26T09:09:18Z", "bug_id": 51193, "creation_time": "2011-05-26T09:09:18Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "julia.faifer@capgemini.com", "text": "i get the exception, if the cell is cell.getCellType(). i think,\nyou have right.", "id": 146649, "time": "2011-05-26T09:13:24Z", "bug_id": 51193, "creation_time": "2011-05-26T09:13:24Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "text": "You don't appear to be checking that a cell isn't null after retrieving it, but before asking for the type. Cells may not be there, if they're not in the file, unless you have set a MissingCellPolicy\n\nCheck the cell is there before using it and you'll be fine", "attachment_id": null, "bug_id": 51193, "id": 146652, "time": "2011-05-26T10:54:27Z", "creator": "apache@gagravarr.org", "creation_time": "2011-05-26T10:54:27Z", "is_private": false}]