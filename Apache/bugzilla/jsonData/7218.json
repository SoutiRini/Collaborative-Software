[{"count": 0, "tags": [], "bug_id": 7218, "attachment_id": null, "is_private": false, "id": 11957, "time": "2002-03-18T20:05:04Z", "creator": "sabreware@earthlink.net", "creation_time": "2002-03-18T20:05:04Z", "text": "When I try this:\n\n<sql:transaction>\n   <sql:update>\n               INSERT INTO CUSTOMERS ('1', 'Joe White',\n               '(221)552-8244', '142 Moor Dr.' 'Houston', 'Texas')\n\n               INSERT INTO CUSTOMERS ('2', 'Bill Black',\n               '(301)453-9284', '1 Scott Dr.' 'Sequim', 'Washington')\n   </sql:update>\n</sql:transaction>\n\nI get this exception:\n\njavax.servlet.ServletException: It is illegal to specify a DataSource when \nnested within a <transaction>\n...\n\nFrom reading the spec, it appears that the preceeding code is valid."}, {"count": 1, "tags": [], "text": "Created attachment 1486\none of two patches that resolves this bug", "attachment_id": 1486, "id": 12838, "creator": "jsc@alum.mit.edu", "time": "2002-04-05T07:01:26Z", "bug_id": 7218, "creation_time": "2002-04-05T07:01:26Z", "is_private": false}, {"count": 2, "tags": [], "creator": "jsc@alum.mit.edu", "is_private": false, "text": "Created attachment 1487\nsecond of two patches that fixes this bug", "id": 12839, "time": "2002-04-05T07:02:02Z", "bug_id": 7218, "creation_time": "2002-04-05T07:02:02Z", "attachment_id": 1487}, {"count": 3, "tags": [], "bug_id": 7218, "attachment_id": null, "id": 12840, "time": "2002-04-05T07:05:49Z", "creator": "jsc@alum.mit.edu", "creation_time": "2002-04-05T07:05:49Z", "is_private": false, "text": "Oops. I attached two patches to this bug; they don't say what files they are \nfor. The first is for UpdateTagSupport.java, the second for \nQueryTagSupport.java, in org.apache.taglibs.standard.tag.common.sql.\n\nIn fact, the error thrown is more in the realm of syntax checking than an \nactual error, since even if an explicit datasource is specified it would be \nignored."}, {"count": 4, "tags": [], "bug_id": 7218, "attachment_id": null, "id": 13066, "time": "2002-04-08T21:33:43Z", "creator": "justyna.horwat@sun.com", "creation_time": "2002-04-08T21:33:43Z", "is_private": false, "text": "Jin, thanks for the patches. I looked them over and you're right, the error\nstemmed from not differentiating between transparent and explicit collaboration\nwhen verifying how the dataSource object was set. \n\nUnfortunately I can't just check to see if the datasource scoped variable is\nnull or not. I must know whether the query or the update tag have a datasource\nattribute and are nested in a transaction tag. For that purpose, I have a\nrawDataSource object that is set if the tags include the attribute. I changed\nthe logic to test whether the rawDataSource was set or not in a nested query or\nupdate action."}]