[{"count": 0, "text": "Creating a CellReference from a Name's \"refers to formula\" when that named range has been half deleted throws a misleading exception:\n\n\"java.lang.RuntimeException: Mismatched quotes: ('MySheetName'!#REF!)\"\n\nIf a Name has been half deleted (e.g. one row out of the two the Name refers to is deleted) then the method Name.getRefersToFormula() will return something like:\n\n'MySheetName'!#REF!\n\nWhen creating a CellReference from this string the org.apache.poi.ss.util.CellReference.parseSheetName(CellReference.java:376) method will fail as it does not expect the string to contain two \"!\" characters.\n\nThe CellReference is created as follows:\n\nAreaReference aref = new AreaReference(namedRange.getRefersToFormula());\n\nThe exception is misleading as the real error is that the \"refers to formula\" (the \"reference\" param in the parseSheetName() method) is really invalid. Both quotes are present thus the error \"Mismatched quotes\" is not correct.\n\n\nThe relevant stack trace is:\n\njava.lang.RuntimeException: Mismatched quotes: ('MySheetTitle'!#REF!)\n\tat org.apache.poi.ss.util.CellReference.parseSheetName(CellReference.java:376)\n\tat org.apache.poi.ss.util.CellReference.separateRefParts(CellReference.java:340)\n\tat org.apache.poi.ss.util.CellReference.<init>(CellReference.java:88)\n\tat org.apache.poi.ss.util.AreaReference.<init>(AreaReference.java:55)\n\tat org.apache.poi.hssf.util.AreaReference.<init>(AreaReference.java:28)", "bug_id": 50718, "is_private": false, "id": 143972, "time": "2011-02-03T22:37:17Z", "creator": "carl.pritchett@gmail.com", "creation_time": "2011-02-03T22:37:17Z", "tags": [], "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 50718, "text": "Fixed in r1078039 - now gives a more helpful:\n  IllegalArgumentException - Cell reference invalid: Sheet1!#REF!", "id": 144739, "time": "2011-03-04T11:18:06Z", "creator": "apache@gagravarr.org", "creation_time": "2011-03-04T11:18:06Z", "is_private": false, "attachment_id": null}]