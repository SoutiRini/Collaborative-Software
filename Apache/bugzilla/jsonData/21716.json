[{"count": 0, "tags": [], "bug_id": 21716, "attachment_id": null, "id": 40942, "time": "2003-07-18T18:49:13Z", "creator": "mariano@fuegolabs.com", "creation_time": "2003-07-18T18:49:13Z", "is_private": false, "text": "If I create a jar with the jar task, including the manifest elements with a\nclasspath entry, when I run the jar with java -jar myJar.jar, it does not get\nthe jars in the manifest. but if I extract the jar and jar it again with the jar\ncommand, it works."}, {"count": 1, "tags": [], "bug_id": 21716, "attachment_id": null, "id": 41058, "time": "2003-07-21T11:38:33Z", "creator": "peter.reilly@corvil.com", "creation_time": "2003-07-21T11:38:33Z", "is_private": false, "text": "The following works for me:\n<project name=\"manifest\" default=\"manifest\">\n  <target name=\"manifest\">\n    <mkdir dir=\"classes\"/>\n    <javac srcdir=\"src\" destdir=\"classes\"/>\n    <jar  destfile=\"hello.jar\">\n      <fileset dir=\"classes\" includes=\"Hello.class\"/>\n    </jar>\n    <delete quiet=\"yes\" file=\"callhello.jar\"/>\n    <jar  destfile=\"callhello.jar\">\n      <manifest>\n        <attribute name=\"Class-Path\" value=\"hello.jar\"/>\n        <attribute name=\"Main-Class\" value=\"CallHello\"/>\n      </manifest>\n      <fileset dir=\"classes\" includes=\"CallHello.class\"/>\n    </jar>\n    <exec executable=\"java\" dir=\"${basedir}\">\n      <arg value=\"-jar\"/>\n      <arg value=\"callhello.jar\"/>\n    </exec>\n  </target>\n</project>"}, {"count": 2, "tags": [], "bug_id": 21716, "attachment_id": null, "text": "I tested this in J2SE 1.4.2 for windows and linux, and invoking the class from\nthe command line, and did not find the referenced classes.\n\nBTW, shouldn't be resolved as WORKSFORME instead of INVALID?\n\nAnd I'm positive that the problem exists. The piece of ant is:\n\n        <jar jarfile=\"${lib.dir}/${jar.name}\" basedir=\"${build.dir}\" index=\"true\">\n            <manifest>\n                <attribute name=\"Fuego-Version\" value=\"${fuego.version.full}\"/>\n                <attribute name=\"Built-By\" value=\"${user.name}\"/>\n                <attribute name=\"Class-Path\" value=\"jide.jar\"/>\n                <attribute name=\"Main-Class\" value=\"fuego.boot.Loader\"/>\n            </manifest>\n        </jar>", "id": 41074, "time": "2003-07-21T14:08:56Z", "creator": "mariano@fuegolabs.com", "creation_time": "2003-07-21T14:08:56Z", "is_private": false}, {"count": 3, "attachment_id": null, "bug_id": 21716, "text": "Yep, you are right that I should have set the error to WorksForMe.\nWe use the jar command with a manifest class-path of approx 15 jars for our\nproduct for linux, windows and solaris using  java 1.4.{0,1,2} so I am suprised\nthat you have a problem.\n", "id": 41083, "time": "2003-07-21T15:18:50Z", "creator": "peter.reilly@corvil.com", "creation_time": "2003-07-21T15:18:50Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 21716, "text": "It is strange since the only context where the jar classpath is not considered\nis when I try to use the referenced jar classes in the Main Class.\n\nI also use the jar task for 20+ jars in my project, but cannot add jars in the\nclasspath of the \"booting\" jar due to this error.\n\nI check the System Class loader and the referenced jars are not in the classpath.\n\nI launched the command with -debug and it could not find the class and no\nreferences to the jars... :(\n\nPlease let me know of anything I can check to help discover the bug :)", "id": 41084, "attachment_id": null, "creator": "mariano@fuegolabs.com", "creation_time": "2003-07-21T15:32:07Z", "time": "2003-07-21T15:32:07Z", "is_private": false}, {"count": 5, "attachment_id": null, "bug_id": 21716, "text": "The problem is the index=\"true\" attribute for the jar\ntask.\n\nThis creates an INDEX.LIST file in the META-INF directory\nof the jar file system. The jar task populates this with\nthe classes from the jar file and NOT the classes from\nthe jars in the Class-Path. If the INDEX.LIST file is present\nthe java -jar command will use this to search for classes and\nif they are not there, it will not bother to check the jars\nthemselves.\n\nThe jar task would need to be extended to support the index attribute\nin combination with the Class-Path manifest entry, but this may be\na little tricky (where is the jar in the source/build tree that\ncorresponds to the entry in the Class-Path).\n\nAs a current work-around, dropping the index=\"true\" attribute should\nbe sufficient.\n", "id": 41131, "time": "2003-07-22T08:10:46Z", "creator": "peter.reilly@corvil.com", "creation_time": "2003-07-22T08:10:46Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "bug_id": 21716, "text": "See bug 14225.", "id": 41138, "attachment_id": null, "creator": "bodewig@apache.org", "creation_time": "2003-07-22T09:31:03Z", "time": "2003-07-22T09:31:03Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 21716, "text": "Sorry, bug 14255.", "id": 41139, "attachment_id": null, "creator": "bodewig@apache.org", "creation_time": "2003-07-22T09:31:50Z", "time": "2003-07-22T09:31:50Z", "is_private": false}, {"count": 8, "tags": [], "creator": "peter.reilly@corvil.com", "attachment_id": null, "id": 41140, "time": "2003-07-22T09:37:20Z", "bug_id": 21716, "creation_time": "2003-07-22T09:37:20Z", "is_private": false, "text": "Yep, this is a duplicate, (I should have\ndone a search....)\n\n\n*** This bug has been marked as a duplicate of 14255 ***"}]