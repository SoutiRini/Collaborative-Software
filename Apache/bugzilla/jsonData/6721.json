[{"count": 0, "tags": [], "bug_id": 6721, "text": "I tried to create a JDBCRealm connecting to Firebird 1.0 using Interclient-JDBC\ndrivers. My configuration of server.xml/web.xml is nearly the same as described\nin the Tomcat examples. The configuration worked fine with mySQL. When using\nFirebird, I got the following exception, when I entered the JDBCRealm:\n\njava.lang.NullPointerException\n\tat interbase.interclient.PreparedStatement.setString(PreparedStatement.java:979)\n\tat org.apache.catalina.realm.JDBCRealm.credentials(JDBCRealm.java:484)\n\tat org.apache.catalina.realm.JDBCRealm.authenticate(JDBCRealm.java:376)\n\tat org.apache.catalina.realm.JDBCRealm.authenticate(JDBCRealm.java:326)\n\nI found out that on the first time you enter a ressource in the JDBCRealm, the\nmethod credential sets the username to null:\n  preparedCredentials.setString(1, username);\nSome JDBC drivers want to have a correct set String. The following patch of the\nmethod authenticate(Connection dbConnection, String username, String\ncredentials) did the job:\n\n [snip]\n        // Look up the user's credentials\n        String dbCredentials = null;\n        PreparedStatement stmt = null;\n        ResultSet rs = null;\n        \n        try {\n            stmt = credentials(dbConnection, username);\n            rs = stmt.executeQuery();\n            while (rs.next()) {\n                dbCredentials = rs.getString(1).trim();\n            }\n            rs.close();\n        }\n        catch (Exception ex) {\n            // some JDBC drivers are throwing a null pointer exception\n            // if the prepared statement parameter is set to null\n        }\n\n        if (dbCredentials == null) {\n            return (null);\n        }\n   [snip]", "id": 11218, "attachment_id": null, "creator": "dfreund@beam.ag", "creation_time": "2002-02-27T15:12:31Z", "time": "2002-02-27T15:12:31Z", "is_private": false}, {"count": 1, "text": "This looks like a bug in the JDBC driver itself, so the JDBC driver should be fixed.", "creator": "remm@apache.org", "is_private": false, "id": 11225, "time": "2002-02-27T17:03:17Z", "bug_id": 6721, "creation_time": "2002-02-27T17:03:17Z", "tags": [], "attachment_id": null}]