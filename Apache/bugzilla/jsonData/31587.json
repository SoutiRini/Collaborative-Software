[{"count": 0, "tags": [], "bug_id": 31587, "attachment_id": null, "id": 64776, "time": "2004-10-07T19:29:11Z", "creator": "mark.horstman@att.com", "creation_time": "2004-10-07T19:29:11Z", "is_private": false, "text": "I cannot get the jakarta-tomcat-connectors/jk/native2/configure script to work\nwithout errors under HP-UX 11.0.  The problems occur when the script does\nsomething like:\n\n\tif ${TEST} \"${apxs_support}\" = \"false\" ; then\n\nor\n\n\tif ${TEST} -z \"$tempval\" ; then\n\nand the variable being tested has not been previously set.  With 'set -x' turned\non to assist in debugging, the first test gives an error of:\n\n\t+ /usr/bin/test  = false\n\t/usr/bin/test[7]: test: Specify a parameter with this command.\n\nwhile the second ones gives:\n\n\t+ /usr/bin/test -z\n\t/usr/bin/test[7]: test: Specify a parameter with this command.\n\nThis style of variable checking is used extensively throughout the script. \nShort of hacking each one to be something like:\n\n\tif ${TEST} \"${apxs_support}x\" = \"falsex\" ; then\n\nor\n\n\tif ${TEST} \"${tempval}x\" = \"x\" ; then\n\ndoes anyone have any ideas how I can get around this?  Is this an autoconf\nissue?  I've tried re-generating the configure script using buildconf.sh by\ninstalling GNU autoconf-2.58, automake-1.9.2 and libtool-1.5.8 but I get the\nsame problems.\n\n\n\nDIFF PATCH TO FIX\n---8<--- snip snip ---8<---\ndiff -rc\njakarta-tomcat-5.0.28-src/jakarta-tomcat-connectors/jk/native2/configure.in\njakarta-tomcat-5.0.28-src.new/jakarta-tomcat-connectors/jk/native2/configure.in\n*** jakarta-tomcat-5.0.28-src/jakarta-tomcat-connectors/jk/native2/configure.in\nSat Aug 28 19:14:22 2004\n---\njakarta-tomcat-5.0.28-src.new/jakarta-tomcat-connectors/jk/native2/configure.in\nTue Oct 5 14:00:50 2004\n***************\n*** 157,163 ****\nAC_SUBST(PCRE_LIBS)\ndnl Check that at least one WEBSERVER has been given\n! if ${TEST} -z \"$WEBSERVERS\" ; then\nAC_MSG_ERROR(Cannot find any WebServer)\nfi\n--- 157,163 ----\nAC_SUBST(PCRE_LIBS)\ndnl Check that at least one WEBSERVER has been given\n! if ${TEST} \"${WEBSERVERS}x\" = \"x\" ; then\nAC_MSG_ERROR(Cannot find any WebServer)\nfi\n***************\n*** 164,181 ****\nAC_SUBST(WEBSERVERS)\ndnl if --with-apr is specified, --with-apr-util must be too\n! if ${TEST} ! -z \"$APR_BUILD\" -a -z \"$APR_UTIL_DIR\"; then\nAC_MSG_ERROR([--with-apr and --with-apr-util must be used together])\nfi\ndnl apache 1.3 consistancy checks\n! if ! ${TEST} -z \"$APACHE_HOME\" ; then\ndnl check if apache 1.3 was selected without apr sources\n! if ${TEST} -z \"$APR_BUILD\"; then\nAC_MSG_ERROR([Apache 1.3 requires apr to built from source, use --with-apr and\n--with-apr-util])\nfi\ndnl make sure compiler matchs apxs\n! if ${TEST} -n \"$APACHE_CC\" -a \"$APACHE_CC\" != \"$CC\"; then\nAC_MSG_RESULT([error])\nAC_MSG_RESULT([compiler discovered by configure: ${CC}])\nAC_MSG_RESULT([compiler used by apache: ${APACHE_CC}])\n--- 164,181 ----\nAC_SUBST(WEBSERVERS)\ndnl if --with-apr is specified, --with-apr-util must be too\n! if ${TEST} \"${APR_BUILD}x\" != \"x\" -a \"${APR_UTIL_DIR}x\" = \"x\" ; then\nAC_MSG_ERROR([--with-apr and --with-apr-util must be used together])\nfi\ndnl apache 1.3 consistancy checks\n! if ${TEST} \"${APACHE_HOME}x\" != \"x\" ; then\ndnl check if apache 1.3 was selected without apr sources\n! if ${TEST} \"${APR_BUILD}x\" = \"x\" ; then\nAC_MSG_ERROR([Apache 1.3 requires apr to built from source, use --with-apr and\n--with-apr-util])\nfi\ndnl make sure compiler matchs apxs\n! if ${TEST} \"${APACHE_CC}x\" != \"x\" -a \"${APACHE_CC}x\" != \"${CC}x\"; then\nAC_MSG_RESULT([error])\nAC_MSG_RESULT([compiler discovered by configure: ${CC}])\nAC_MSG_RESULT([compiler used by apache: ${APACHE_CC}])\n***************\n*** 185,197 ****\nfi\ndnl apache 2 consistancy checks\n! if ${TEST} ! -z \"$APACHE2_HOME\" ; then\ndnl check if apache 2 was selected with apr sources\n! if ${TEST} ! -z \"$APR_BUILD\"; then\nAC_MSG_ERROR([Use apr that comes with Apache 2, remove --with-apr])\nfi\ndnl make sure compiler matchs apxs\n! if ${TEST} -n \"$APACHE2_CC\" -a \"$APACHE2_CC\" != \"$CC\"; then\nAC_MSG_RESULT([error])\nAC_MSG_RESULT([compiler discovered by configure: ${CC}])\nAC_MSG_RESULT([compiler used by apache: ${APACHE2_CC}])\n--- 185,197 ----\nfi\ndnl apache 2 consistancy checks\n! if ${TEST} \"${APACHE2_HOME}x\" != \"x\" ; then\ndnl check if apache 2 was selected with apr sources\n! if ${TEST} \"${APR_BUILD}x\" != \"x\" ; then\nAC_MSG_ERROR([Use apr that comes with Apache 2, remove --with-apr])\nfi\ndnl make sure compiler matchs apxs\n! if ${TEST} \"${APACHE2_CC}x\" != \"x\" -a \"${APACHE2_CC}x\" != \"${CC}x\"; then\nAC_MSG_RESULT([error])\nAC_MSG_RESULT([compiler discovered by configure: ${CC}])\nAC_MSG_RESULT([compiler used by apache: ${APACHE2_CC}])\ndiff -rc\njakarta-tomcat-5.0.28-src/jakarta-tomcat-connectors/jk/support/jk_apr.m4\njakarta-tomcat-5.0.28-src.new/jakarta-tomcat-connectors/jk/support/jk_apr.m4\n*** jakarta-tomcat-5.0.28-src/jakarta-tomcat-connectors/jk/support/jk_apr.m4 Sat\nAug 28 19:14:24 2004\n--- jakarta-tomcat-5.0.28-src.new/jakarta-tomcat-connectors/jk/support/jk_apr.m4\nTue Oct 5 13:45:00 2004\n***************\n*** 78,84 ****\nAC_MSG_ERROR(can't locate ${tempval}/$1)\nfi\n! if ${TEST} ! -z \"$tempval\" ; then\nAPR_BUILD=\"apr-build\"\nAPR_CFLAGS=\"-I ${tempval}/include\"\nAPR_CLEAN=\"apr-clean\"\n--- 78,84 ----\nAC_MSG_ERROR(can't locate ${tempval}/$1)\nfi\n! if ${TEST} \"${tempval}x\" != \"x\" ; then\nAPR_BUILD=\"apr-build\"\nAPR_CFLAGS=\"-I ${tempval}/include\"\nAPR_CLEAN=\"apr-clean\"\n***************\n*** 142,152 ****\nAC_MSG_ERROR(can't locate ${tempval}/$1)\nfi\n! if ${TEST} -z \"${APR_BUILD}\"; then\nAC_MSG_ERROR([--with-apr and --with-apr-util must be used together])\nfi\n! if ${TEST} ! -z \"$tempval\" ; then\nAPR_UTIL_DIR=${tempval}\nAPR_CFLAGS=\"${APR_CFLAGS} -I ${APR_UTIL_DIR}/include\"\nAPR_UTIL_INCDIR=\"${APR_UTIL_DIR}/include\"\n--- 142,152 ----\nAC_MSG_ERROR(can't locate ${tempval}/$1)\nfi\n! if ${TEST} \"${APR_BUILD}x\" = \"x\" ; then\nAC_MSG_ERROR([--with-apr and --with-apr-util must be used together])\nfi\n! if ${TEST} \"${tempval}x\" != \"x\" ; then\nAPR_UTIL_DIR=${tempval}\nAPR_CFLAGS=\"${APR_CFLAGS} -I ${APR_UTIL_DIR}/include\"\nAPR_UTIL_INCDIR=\"${APR_UTIL_DIR}/include\"\n***************\n*** 207,213 ****\nAC_MSG_ERROR(can't locate ${tempval}/$1)\nfi\n! if ${TEST} ! -z \"$tempval\" ; then\nAPR_BUILD=\"\"\nAPR_CFLAGS=\"-I${tempval}\"\nAPR_CLEAN=\"\"\n--- 207,213 ----\nAC_MSG_ERROR(can't locate ${tempval}/$1)\nfi\n! if ${TEST} \"${tempval}x\" != \"x\" ; then\nAPR_BUILD=\"\"\nAPR_CFLAGS=\"-I${tempval}\"\nAPR_CLEAN=\"\"\n***************\n*** 250,256 ****\nAC_MSG_ERROR(Not a directory: ${tempval})\nfi\n! if ${TEST} ! -z \"$tempval\" ; then\nAPR_BUILD=\"\"\nAPR_CLEAN=\"\"\nAPR_DIR=\"\"\n--- 250,256 ----\nAC_MSG_ERROR(Not a directory: ${tempval})\nfi\n! if ${TEST} \"${tempval}x\" != \"x\" ; then\nAPR_BUILD=\"\"\nAPR_CLEAN=\"\"\nAPR_DIR=\"\"\n***************\n*** 282,288 ****\nAC_MSG_ERROR([cannot find apr-config file in $2])\nfi\njk_apr_get_tempval=`$2/apr-config --link-libtool 2> /dev/null`\n! if ${TEST} -z \"${jk_apr_get_tempval}\" ; then\nAC_MSG_ERROR([$2/apr-config --link-libtool failed])\nfi\njk_apr_get_tempval=`basename ${jk_apr_get_tempval}`\n--- 282,288 ----\nAC_MSG_ERROR([cannot find apr-config file in $2])\nfi\njk_apr_get_tempval=`$2/apr-config --link-libtool 2> /dev/null`\n! if ${TEST} \"${jk_apr_get_tempval}x\" = \"x\" ; then\nAC_MSG_ERROR([$2/apr-config --link-libtool failed])\nfi\njk_apr_get_tempval=`basename ${jk_apr_get_tempval}`\n***************\n*** 306,312 ****\nAC_MSG_ERROR([cannot find apu-config file in $2])\nfi\njk_apu_get_tempval=`$2/apu-config --link-libtool 2> /dev/null`\n! if ${TEST} -z \"${jk_apu_get_tempval}\" ; then\nAC_MSG_ERROR([$2/apu-config --link-libtool failed])\nfi\njk_apu_get_tempval=`basename ${jk_apu_get_tempval}`\n--- 306,312 ----\nAC_MSG_ERROR([cannot find apu-config file in $2])\nfi\njk_apu_get_tempval=`$2/apu-config --link-libtool 2> /dev/null`\n! if ${TEST} \"${jk_apu_get_tempval}x\" = \"x\" ; then\nAC_MSG_ERROR([$2/apu-config --link-libtool failed])\nfi\njk_apu_get_tempval=`basename ${jk_apu_get_tempval}`\ndiff -rc\njakarta-tomcat-5.0.28-src/jakarta-tomcat-connectors/jk/support/jk_apxs.m4\njakarta-tomcat-5.0.28-src.new/jakarta-tomcat-connectors/jk/support/jk_apxs.m4\n*** jakarta-tomcat-5.0.28-src/jakarta-tomcat-connectors/jk/support/jk_apxs.m4\nSat Aug 28 19:14:24 2004\n---\njakarta-tomcat-5.0.28-src.new/jakarta-tomcat-connectors/jk/support/jk_apxs.m4\nTue Oct 5 12:08:16 2004\n***************\n*** 62,68 ****\n${APXS$1} -q PREFIX >/dev/null 2>/dev/null || apxs_support=false\n! if ${TEST} \"${apxs_support}\" = \"false\" ; then\nAC_MSG_RESULT(could not find ${APXS$1})\nAC_MSG_ERROR(You must specify a valid --with-apxs$1 path)\nfi\n--- 62,68 ----\n${APXS$1} -q PREFIX >/dev/null 2>/dev/null || apxs_support=false\n! if ${TEST} \"${apxs_support}x\" = \"falsex\" ; then\nAC_MSG_RESULT(could not find ${APXS$1})\nAC_MSG_ERROR(You must specify a valid --with-apxs$1 path)\nfi\n***************\n*** 101,111 ****\nAPR_UTIL_INCDIR=\"-I`${APXS$1} -q APU_INCLUDEDIR`\"\nAPACHE2_LIBDIR=\"`${APXS$1} -q LIBDIR`\"\nLIBTOOL=`${APXS$1} -q LIBTOOL`\n! if ${TEST} -f ${APACHE2_LIBDIR}/libapr-1.so -o -f\n${APACHE2_LIBDIR}/libapr-1.dylib; then\nAPR_LIBS=\"-L${APACHE2_LIBDIR} -lapr-1\"\n! elif ${TEST} -f ${APACHE2_LIBDIR}/libapr-0.so -o -f\n${APACHE2_LIBDIR}/libapr-0.dylib; then\nAPR_LIBS=\"-L${APACHE2_LIBDIR} -lapr-0\"\n! elif ${TEST} -f ${APACHE2_LIBDIR}/libapr.so -o -f\n${APACHE2_LIBDIR}/libapr.dylib; then\nAPR_LIBS=\"-L${APACHE2_LIBDIR} -lapr\"\nelse\nAC_MSG_ERROR(can't locate libapr)\n--- 101,111 ----\nAPR_UTIL_INCDIR=\"-I`${APXS$1} -q APU_INCLUDEDIR`\"\nAPACHE2_LIBDIR=\"`${APXS$1} -q LIBDIR`\"\nLIBTOOL=`${APXS$1} -q LIBTOOL`\n! if ${TEST} -f ${APACHE2_LIBDIR}/libapr-1.so -o -f\n${APACHE2_LIBDIR}/libapr-1.dylib -o -f ${APACHE2_LIBDIR}/libapr-1.sl ; then\nAPR_LIBS=\"-L${APACHE2_LIBDIR} -lapr-1\"\n! elif ${TEST} -f ${APACHE2_LIBDIR}/libapr-0.so -o -f\n${APACHE2_LIBDIR}/libapr-0.dylib -o -f ${APACHE2_LIBDIR}/libapr-0.sl ; then\nAPR_LIBS=\"-L${APACHE2_LIBDIR} -lapr-0\"\n! elif ${TEST} -f ${APACHE2_LIBDIR}/libapr.so -o -f\n${APACHE2_LIBDIR}/libapr.dylib -o -f ${APACHE2_LIBDIR}/libapr.sl ; then\nAPR_LIBS=\"-L${APACHE2_LIBDIR} -lapr\"\nelse\nAC_MSG_ERROR(can't locate libapr)\ndiff -rc\njakarta-tomcat-5.0.28-src/jakarta-tomcat-connectors/jk/support/jk_dominohome.m4\njakarta-tomcat-5.0.28-src.new/jakarta-tomcat-connectors/jk/support/jk_dominohome.m4\n***\njakarta-tomcat-5.0.28-src/jakarta-tomcat-connectors/jk/support/jk_dominohome.m4\nSat Aug 28 19:14:24 2004\n---\njakarta-tomcat-5.0.28-src.new/jakarta-tomcat-connectors/jk/support/jk_dominohome.m4\nTue Oct 5 13:22:15 2004\n***************\n*** 60,66 ****\nesac\n]) ! if ${TEST} -z \"$tempval\" ; then\nAC_MSG_RESULT(not provided)\nelse\n[$2]=${tempval}\n--- 60,66 ----\nesac\n]) ! if ${TEST} \"${tempval}x\" = \"x\" ; then\nAC_MSG_RESULT(not provided)\nelse\n[$2]=${tempval}\ndiff -rc\njakarta-tomcat-5.0.28-src/jakarta-tomcat-connectors/jk/support/jk_exec.m4\njakarta-tomcat-5.0.28-src.new/jakarta-tomcat-connectors/jk/support/jk_exec.m4\n*** jakarta-tomcat-5.0.28-src/jakarta-tomcat-connectors/jk/support/jk_exec.m4\nSat Aug 28 19:06:02 2004\n---\njakarta-tomcat-5.0.28-src.new/jakarta-tomcat-connectors/jk/support/jk_exec.m4\nTue Oct 5 11:22:57 2004\n***************\n*** 35,41 ****\n[JK_EXEC],\n[\njk_exec_curdir=\"`pwd`\"\n! if test -d \"$4\" ; then\ncd \"$4\"\nelse\nAC_MSG_ERROR([can't switch to directory $4])\n--- 35,41 ----\n[JK_EXEC],\n[\njk_exec_curdir=\"`pwd`\"\n! if ${TEST} -d \"$4\" ; then\ncd \"$4\"\nelse\nAC_MSG_ERROR([can't switch to directory $4])\n***************\n*** 47,53 ****\nset $2\njk_exec_file=[$]1\n! if test ! -x \"${jk_exec_file}\" ; then\ncd \"${jk_exec_curdir}\"\nAC_MSG_ERROR([cannot find or execute \\\"${jk_exec_file}\\\" in \\\"$4\\\"])\nexit 1\n--- 47,53 ----\nset $2\njk_exec_file=[$]1\n! if ${TEST} ! -x \"${jk_exec_file}\" ; then\ncd \"${jk_exec_curdir}\"\nAC_MSG_ERROR([cannot find or execute \\\"${jk_exec_file}\\\" in \\\"$4\\\"])\nexit 1\n***************\n*** 62,74 ****\njk_exec_ret=0\nwhile true ; do\nread jk_exec_first jk_exec_line\n! if test ! \"$?\" -eq \"0\" ; then\nbreak\nelse\n! if test \"${jk_exec_first}\" = \"jk_exec_retvalue\" ; then\njk_exec_ret=\"${jk_exec_line}\"\nelse\n! if test -n \"${jk_exec_line}\" ; then\necho \" $3: ${jk_exec_first} ${jk_exec_line}\"\nfi\nfi\n--- 62,74 ----\njk_exec_ret=0\nwhile true ; do\nread jk_exec_first jk_exec_line\n! if ${TEST} ! \"$?\" -eq \"0\" ; then\nbreak\nelse\n! if ${TEST} \"${jk_exec_first}x\" = \"jk_exec_retvaluex\" ; then\njk_exec_ret=\"${jk_exec_line}\"\nelse\n! if ${TEST} \"${jk_exec_line}x\" != \"x\" ; then\necho \" $3: ${jk_exec_first} ${jk_exec_line}\"\nfi\nfi\ndiff -rc\njakarta-tomcat-5.0.28-src/jakarta-tomcat-connectors/jk/support/jk_java.m4\njakarta-tomcat-5.0.28-src.new/jakarta-tomcat-connectors/jk/support/jk_java.m4\n*** jakarta-tomcat-5.0.28-src/jakarta-tomcat-connectors/jk/support/jk_java.m4\nSat Aug 28 19:14:24 2004\n---\njakarta-tomcat-5.0.28-src.new/jakarta-tomcat-connectors/jk/support/jk_java.m4\nTue Oct 5 11:23:33 2004\n***************\n*** 41,47 ****\n*) use_jni=true ;;\nesac\n! if ${TEST} \"${use_jni}\" = \"true\"; then\nHAVE_JNI=\"-DHAVE_JNI\"\nJNI_BUILD=\"jni-build\"\nfi\n--- 41,47 ----\n*) use_jni=true ;;\nesac\n! if ${TEST} \"${use_jni}x\" = \"truex\"; then\nHAVE_JNI=\"-DHAVE_JNI\"\nJNI_BUILD=\"jni-build\"\nfi\n***************\n*** 51,60 ****\nAC_DEFUN(\n[JK_JDK],\n[\n! if ${TEST} \"${use_jni}\" = \"true\"; then\ntempval=\"\"\nAC_MSG_CHECKING([for JDK location (please wait)])\n! if ${TEST} -n \"${JAVA_HOME}\" ; then\nJAVA_HOME_ENV=\"${JAVA_HOME}\"\nelse\nJAVA_HOME_ENV=\"\"\n--- 51,60 ----\nAC_DEFUN(\n[JK_JDK],\n[\n! if ${TEST} \"${use_jni}x\" = \"truex\"; then\ntempval=\"\"\nAC_MSG_CHECKING([for JDK location (please wait)])\n! if ${TEST} \"${JAVA_HOME}x\" != \"x\" ; then\nJAVA_HOME_ENV=\"${JAVA_HOME}\"\nelse\nJAVA_HOME_ENV=\"\"\n***************\n*** 86,98 ****\n# Since Sun uses JAVA_HOME a lot, we check it first and ignore the\n# JAVA_HOME, otherwise just use whatever JAVA_HOME was specified.\n! if ${TEST} -n \"${JAVA_HOME_ENV}\" ; then\nJAVA_HOME=${JAVA_HOME_ENV}\nAC_MSG_RESULT(${JAVA_HOME_ENV} from environment)\nfi\n])\n! if ${TEST} -z \"${JAVA_HOME}\" ; then\n# Oh well, nobody set neither JAVA_HOME nor JAVA_HOME, have to guess\n# The following code is based on the code submitted by Henner Zeller\n--- 86,98 ----\n# Since Sun uses JAVA_HOME a lot, we check it first and ignore the\n# JAVA_HOME, otherwise just use whatever JAVA_HOME was specified.\n! if ${TEST} \"${JAVA_HOME_ENV}x\" != \"x\" ; then\nJAVA_HOME=${JAVA_HOME_ENV}\nAC_MSG_RESULT(${JAVA_HOME_ENV} from environment)\nfi\n])\n! if ${TEST} \"${JAVA_HOME}x\" = \"x\" ; then\n# Oh well, nobody set neither JAVA_HOME nor JAVA_HOME, have to guess\n# The following code is based on the code submitted by Henner Zeller\n***************\n*** 119,149 ****\nfi\ndone\n! if ${TEST} -n \"${JAVA_HOME}\" ; then\nbreak;\nfi\ndone\n! if ${TEST} -n \"${JAVA_HOME}\" ; then\nbreak;\nfi\ndone\n! if ${TEST} -n \"${JAVA_HOME}\" ; then\nbreak;\nfi\ndone\n! if ${TEST} ! -n \"${JAVA_HOME}\" ; then\nAC_MSG_ERROR(can't locate a valid JDK location)\nfi\nfi\n! if ${TEST} -n \"${JAVA_PLATFORM}\"; then\nAC_MSG_RESULT(Java Platform detected - 1.${JAVA_PLATFORM})\nelse\nAC_MSG_CHECKING(Java platform)\n--- 119,149 ----\nfi\ndone\n! if ${TEST} \"${JAVA_HOME}x\" != \"x\" ; then\nbreak;\nfi\ndone\n! if ${TEST} \"${JAVA_HOME}x\" != \"x\" ; then\nbreak;\nfi\ndone\n! if ${TEST} \"${JAVA_HOME}x\" != \"x\" ; then\nbreak;\nfi\ndone\n! if ${TEST} \"${JAVA_HOME}x\" = \"x\" ; then\nAC_MSG_ERROR(can't locate a valid JDK location)\nfi\nfi\n! if ${TEST} \"${JAVA_PLATFORM}x\" != \"x\" ; then\nAC_MSG_RESULT(Java Platform detected - 1.${JAVA_PLATFORM})\nelse\nAC_MSG_CHECKING(Java platform)\n***************\n*** 163,169 ****\nesac\n],\n[\n! if ${TEST} -n \"${JAVA_PLATFORM}\"; then\nAC_MSG_RESULT(Java Platform detected - 1.${JAVA_PLATFORM})\nelse\nAC_MSG_CHECKING(Java platform)\n--- 163,169 ----\nesac\n],\n[\n! if ${TEST} \"${JAVA_PLATFORM}x\" != \"x\" ; then\nAC_MSG_RESULT(Java Platform detected - 1.${JAVA_PLATFORM})\nelse\nAC_MSG_CHECKING(Java platform)\n***************\n*** 184,190 ****\nAC_DEFUN(\n[JK_JDK_OS],\n[\n! if ${TEST} \"${use_jni}\" = \"true\"; then\ntempval=\"\"\nOS=\"\"\nAC_ARG_WITH(os-type,\n--- 184,190 ----\nAC_DEFUN(\n[JK_JDK_OS],\n[\n! if ${TEST} \"${use_jni}x\" = \"truex\" ; then\ntempval=\"\"\nOS=\"\"\nAC_ARG_WITH(os-type,\n***************\n*** 210,216 ****\necho \" ${OS}\"\nfi\ndone\n! if ${TEST} -z \"${OS}\"; then\nAC_MSG_RESULT(Cannot find jni_md.h in ${JAVA_HOME}/${OS})\nAC_MSG_ERROR(You should retry --with-os-type=SUBDIR)\nfi\n--- 210,216 ----\necho \" ${OS}\"\nfi\ndone\n! if ${TEST} \"${OS}x\" = \"x\" ; then\nAC_MSG_RESULT(Cannot find jni_md.h in ${JAVA_HOME}/${OS})\nAC_MSG_ERROR(You should retry --with-os-type=SUBDIR)\nfi\ndiff -rc\njakarta-tomcat-5.0.28-src/jakarta-tomcat-connectors/jk/support/jk_tchome.m4\njakarta-tomcat-5.0.28-src.new/jakarta-tomcat-connectors/jk/support/jk_tchome.m4\n*** jakarta-tomcat-5.0.28-src/jakarta-tomcat-connectors/jk/support/jk_tchome.m4\nSat Aug 28 19:14:24 2004\n---\njakarta-tomcat-5.0.28-src.new/jakarta-tomcat-connectors/jk/support/jk_tchome.m4\nTue Oct 5 11:23:14 2004\n***************\n*** 59,65 ****\nesac\n]) ! if ${TEST} -z \"$tempval\" ; then\nAC_MSG_RESULT(not provided)\nelse\n[$2]=${tempval}\n--- 59,65 ----\nesac\n]) ! if ${TEST} \"${tempval}x\" = \"x\" ; then\nAC_MSG_RESULT(not provided)\nelse\n[$2]=${tempval}\ndiff -rc jakarta-tomcat-5.0.28-src/jakarta-tomcat-connectors/jk/support/jk_ws.m4\njakarta-tomcat-5.0.28-src.new/jakarta-tomcat-connectors/jk/support/jk_ws.m4\n*** jakarta-tomcat-5.0.28-src/jakarta-tomcat-connectors/jk/support/jk_ws.m4 Sat\nAug 28 19:14:24 2004\n--- jakarta-tomcat-5.0.28-src.new/jakarta-tomcat-connectors/jk/support/jk_ws.m4\nTue Oct 5 11:22:52 2004\n***************\n*** 56,62 ****\nAC_MSG_ERROR(can't locate ${tempval}/$3)\nfi\n! if ${TEST} ! -z \"$tempval\" ; then\n$2_BUILD=\"true\"\n$2_CFLAGS=\"-I ${tempval}/include\"\n$2_DIR=${tempval}\n--- 56,62 ----\nAC_MSG_ERROR(can't locate ${tempval}/$3)\nfi\n! if ${TEST} \"${tempval}x\" != \"x\" ; then\n$2_BUILD=\"true\"\n$2_CFLAGS=\"-I ${tempval}/include\"\n$2_DIR=${tempval}\n***************\n*** 69,75 ****\nif ${TEST} -d ${withval}/src/include ; then\n# read osdir from the existing apache.\nosdir=`${GREP} '^OSDIR=' ${withval}/src/Makefile.config | ${SED} -e\n's:^OSDIR=.*/os:os:'`\n! if ${TEST} -z \"${osdir}\" ; then\nosdir=os/unix\nfi\n$2_INCL=\"-I${tempval}/src/include -I${withval}/src/${osdir}\"\n--- 69,75 ----\nif ${TEST} -d ${withval}/src/include ; then\n# read osdir from the existing apache.\nosdir=`${GREP} '^OSDIR=' ${withval}/src/Makefile.config | ${SED} -e\n's:^OSDIR=.*/os:os:'`\n! if ${TEST} \"${osdir}x\" = \"x\" ; then\nosdir=os/unix\nfi\n$2_INCL=\"-I${tempval}/src/include -I${withval}/src/${osdir}\"\n***************\n*** 112,118 ****\nesac\n])\n! if ${TEST} -z \"$tempval\" ; then\nAC_MSG_RESULT(not provided)\nelse\nAC_MSG_RESULT(${tempval})\n--- 112,118 ----\nesac\n])\n! if ${TEST} \"${tempval}x\" = \"x\" ; then\nAC_MSG_RESULT(not provided)\nelse\nAC_MSG_RESULT(${tempval})\n***************\n*** 153,159 ****\nAC_MSG_ERROR(can't locate ${tempval}/$3)\nfi\n! if ${TEST} ! -z \"$tempval\" ; then\n$2_BUILD=\"\"\n$2_CFLAGS=\"-I${tempval}\"\n$2_CLEAN=\"\"\n--- 153,159 ----\nAC_MSG_ERROR(can't locate ${tempval}/$3)\nfi\n! if ${TEST} \"${tempval}x\" != \"x\" ; then\n$2_BUILD=\"\"\n$2_CFLAGS=\"-I${tempval}\"\n$2_CLEAN=\"\"\n***************\n*** 202,208 ****\nAC_MSG_ERROR(Not a directory: ${tempval})\nfi\n! if ${TEST} ! -z \"$tempval\" ; then\n$2_BUILD=\"\"\n$2_CLEAN=\"\"\n$2_DIR=\"\"\n--- 202,208 ----\nAC_MSG_ERROR(Not a directory: ${tempval})\nfi\n! if ${TEST} \"${tempval}x\" != \"x\" ; then\n$2_BUILD=\"\"\n$2_CLEAN=\"\"\n$2_DIR=\"\"\n---8<--- snip snip ---8<---"}, {"count": 1, "tags": [], "bug_id": 31587, "attachment_id": null, "id": 64781, "time": "2004-10-07T19:39:21Z", "creator": "yoavs@computer.org", "creation_time": "2004-10-07T19:39:21Z", "is_private": false, "text": "Changing cmoopnent to Native:Integration."}, {"count": 2, "tags": [], "creator": "mark.horstman@att.com", "is_private": false, "id": 64782, "creation_time": "2004-10-07T19:47:04Z", "time": "2004-10-07T19:47:04Z", "bug_id": 31587, "text": "Created attachment 12985\nOops... sorry about the size of the original patch report.  I didn't know you could provide an attachment.", "attachment_id": 12985}, {"count": 3, "tags": [], "bug_id": 31587, "attachment_id": null, "id": 67400, "time": "2004-11-23T22:33:27Z", "creator": "yoavs@computer.org", "creation_time": "2004-11-23T22:33:27Z", "is_private": false, "text": "Can you please provide the patch in diff -u format?"}, {"count": 4, "tags": [], "text": "If you don't provide a diff -u formatted patch, as opposed to the whole file, \nchances are the patch will be ignored altogether ;(  Please provide a diff -u \npatch if possible.  Thank you.", "attachment_id": null, "id": 67577, "creator": "yoavs@computer.org", "time": "2004-11-29T21:05:26Z", "bug_id": 31587, "creation_time": "2004-11-29T21:05:26Z", "is_private": false}, {"count": 5, "tags": [], "text": "Created attachment 13594\n'diff -ru' format of same diff attached before\n\n------- Additional Comments From yoavs@computer.org  2004-11-23 22:33 -------\nCan you please provide the patch in diff -u format?\n\n----------\nNeither Solaris or HP-UX diff have a '-u' option.  I re-applied my patch (using\npatch -p0), then I found a Linux box whose (gnu?) diff supports that option,\nbut '-u' by itself does not output anything useful so I combined it with '-r'\nand attached the output.  If that's not what you need, please let me know.", "attachment_id": 13594, "id": 67620, "creator": "mark.horstman@att.com", "time": "2004-11-30T14:52:45Z", "bug_id": 31587, "creation_time": "2004-11-30T14:52:45Z", "is_private": false}, {"count": 6, "attachment_id": null, "bug_id": 31587, "is_private": false, "id": 67640, "time": "2004-11-30T18:27:29Z", "creator": "yoavs@computer.org", "creation_time": "2004-11-30T18:27:29Z", "tags": [], "text": "That's a good format.  Thanks for going through that effort."}, {"count": 7, "attachment_id": null, "bug_id": 31587, "is_private": false, "id": 71916, "time": "2005-03-07T19:43:50Z", "creator": "mturk@apache.org", "creation_time": "2005-03-07T19:43:50Z", "tags": [], "text": "JK2 is deprected. See\nhttp://jakarta.apache.org/tomcat/connectors-doc/news/20041100.html#20041115.1\n\nUse JK insted.\n"}]