[{"count": 0, "tags": [], "text": "The API contract for java.util.Enumeration states that implementations should throw java.util.NoSuchElementException when nextElement() is called and the enumeration is exhausted. \n\nAs of Ant 1.8.2 AntClassLoader$ResourceEnumeration _does not_ throw an exception under this condition but rather returns null instead. Code that relies on the exception being thrown does not work properly as enumerations returned by Ant's class loader do not faithfully implement the API contract.", "is_private": false, "bug_id": 51579, "id": 148262, "time": "2011-07-28T20:59:58Z", "creator": "carej@us.ibm.com", "creation_time": "2011-07-28T20:59:58Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 51579, "is_private": false, "text": "Assuming I can get it through IBM Legal I have a simple patch for this", "id": 148263, "time": "2011-07-28T21:10:31Z", "creator": "carej@us.ibm.com", "creation_time": "2011-07-28T21:10:31Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 51579, "attachment_id": null, "id": 148267, "time": "2011-07-29T03:16:13Z", "creator": "bodewig@apache.org", "creation_time": "2011-07-29T03:16:13Z", "is_private": false, "text": "I'm sure we'll find a way that somebody else could work out the fix without forcing you or IBM's lawyers to sign papers, it doesn't look too difficult 8-)\n\nThe very initial version of ResourceEnumeration committed more than ten years ago already has this problem, http://svn.apache.org/viewvc/ant/core/trunk/src/main/org/apache/tools/ant/AntClassLoader.java?r1=269024&r2=269258 and I'm not sure we should fix it now, even if you are correct (you are)."}, {"count": 3, "tags": [], "bug_id": 51579, "is_private": false, "text": "(In reply to comment #2)\n> The very initial version of ResourceEnumeration committed more than ten years\n> ago already has this problem,\n> http://svn.apache.org/viewvc/ant/core/trunk/src/main/org/apache/tools/ant/AntClassLoader.java?r1=269024&r2=269258\n> and I'm not sure we should fix it now, even if you are correct (you are).\n\nI'm of two minds on this:\n\n...on the one hand Ant's code is clearly breaking the API contract, so IMO anyone relying on the current behavior (i.e. returning null instead of throwing an exception) is wrong;\n\n...on the other hand our code that exposed this is relying on a design pattern that I don't think is sound (enumeration traversal inside an infinite loop, relying on the exception being thrown to exit the loop).\n\nI've already patched our code to use enumerations properly so I'm okay with not fixing the Ant code if there is a strong feeling to leave it as is but the pendant in me thinks that the Ant code should be fixed as well.", "id": 148274, "time": "2011-07-29T13:32:13Z", "creator": "carej@us.ibm.com", "creation_time": "2011-07-29T13:32:13Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 51579, "attachment_id": null, "text": "fixed with svn revision 1155197", "id": 148498, "time": "2011-08-09T03:29:25Z", "creator": "bodewig@apache.org", "creation_time": "2011-08-09T03:29:25Z", "is_private": false}]