[{"count": 0, "text": "Created attachment 30201\nCheck the table cell with the value -\n\nI have written code to extract the text from the table in the PPT file.\n\nSample Code :-\n\n//Import POI classes\nimport org.apache.poi.poifs.filesystem.*;\nimport org.apache.poi.hslf.*;\nimport org.apache.poi.hslf.model.*;\nimport org.apache.poi.hslf.usermodel.*;\n\npublic class createTextFrmPPTTable\n{\npublic static void main( String[] args )\n{\nString filename = args[ 0 ];\ntry\n{\n\n  SlideShow ppt = new SlideShow( new HSLFSlideShow( filename ) );\n  Slide[] slides = ppt.getSlides();\n  for( int i=0; i<slides.length; i++ )\n  {\n   System.out.println(\"\\tTable Object\");\n   Shape[] sh = slides[i].getShapes();\n   \n   for (int k = 0; k < sh.length; k++) {  \n     if (sh[k] instanceof ShapeGroup){ //got a table \n       ShapeGroup table = (ShapeGroup)sh[k]; \n       Shape[] ch = table.getShapes(); \n            \n       for (int l=0; l<ch.length; l++){     \t   \n         if (ch[l] instanceof TextBox){ \n           TextBox txt = (TextBox)ch[l]; \n           String text = txt.getText(); //text in a table cell\n           System.out.println(\"Textbox text :\" + text);\n         } else if (ch[l] instanceof AutoShape){\n        \tAutoShape t = (AutoShape)ch[l];\n         \tSystem.out.println(\"AutoShape text :\" +t.getText());\n         }  \n     } \n   }\n   }\n  }\n}\ncatch( Exception e )\n{\n  e.printStackTrace();\n}\n}\n}\n\n===============================\n\nWhen you run this code against the given sample file , it gives \"null\" for the table cell where you have \"-\" .", "bug_id": 54853, "is_private": false, "id": 166648, "time": "2013-04-16T09:25:35Z", "creator": "gargpar@gmail.com", "creation_time": "2013-04-16T09:25:35Z", "tags": [], "attachment_id": 30201}, {"count": 1, "tags": [], "text": "In the meantime, this has been fixed - this was my test code:\n\n@Test\npublic void testGetText() throws IOException {\n    HSLFSlideShow ppt = \n(HSLFSlideShow)SlideShowFactory.create(_slTests.getFile(\"Apache_POI_Issue_1.ppt\"));\n    HSLFSlide slide = ppt.getSlides().get(0);\n    HSLFTable tab = (HSLFTable)slide.getShapes().get(0);\n    int rows = tab.getNumberOfRows();\n    int cols = tab.getNumberOfColumns();\n    String exp[] = { \"Test\", \"Test1 \u2013 sadsa\", \"Test2\", \"Test3\" };\n    int expI = 0;\n    for (int row=0; row<rows; row++) {\n        for (int col=0; col<cols; col++) {\n            assertEquals(exp[expI], tab.getCell(row, col).getText());\n            expI++;\n        }\n    }\n    ppt.close();\n}", "attachment_id": null, "bug_id": 54853, "id": 186414, "time": "2015-11-17T00:24:09Z", "creator": "kiwiwings@apache.org", "creation_time": "2015-11-17T00:24:09Z", "is_private": false}]