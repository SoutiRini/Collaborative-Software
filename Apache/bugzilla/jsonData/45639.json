[{"count": 0, "tags": [], "creator": "asharapov@tengry.com", "text": "This is the exception that occurs when i try to group columns on sheet:\njava.lang.ArrayIndexOutOfBoundsException: -2\n\tat java.util.ArrayList.get(ArrayList.java:323)\n\tat org.apache.poi.hssf.record.aggregates.ColumnInfoRecordsAggregate.getColInfo(ColumnInfoRecordsAggregate.java:151)\n\tat org.apache.poi.hssf.record.aggregates.ColumnInfoRecordsAggregate.collapseColInfoRecords(ColumnInfoRecordsAggregate.java:448)\n\tat org.apache.poi.hssf.record.aggregates.ColumnInfoRecordsAggregate.groupColumnRange(ColumnInfoRecordsAggregate.java:492)\n\tat org.apache.poi.hssf.model.Sheet.groupColumnRange(Sheet.java:1194)\n\tat org.apache.poi.hssf.usermodel.HSSFSheet.groupColumn(HSSFSheet.java:1596)\n\nexample code:\n        final HSSFWorkbook wb = new HSSFWorkbook();\n        final HSSFSheet sheet = wb.createSheet(\"test\");\n        sheet.groupColumn((short)7, (short)9);\n        sheet.groupColumn((short)4, (short)12);\n        sheet.groupColumn((short)1, (short)15);\n\nTested on current poi version (poi-3.2-alpha1-20080817)", "id": 119872, "time": "2008-08-17T04:08:46Z", "bug_id": 45639, "creation_time": "2008-08-17T04:08:46Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "O.Diehl@proPlant.de", "attachment_id": null, "id": 120513, "time": "2008-09-10T06:09:44Z", "bug_id": 45639, "creation_time": "2008-09-10T06:09:44Z", "is_private": false, "text": "A simple patch is to comment out the performance tuning with fromIdx in ColumnInfoRecordsAggregate.groupColumnRange(short fromColumn, short toColumn, boolean indent). It does not work because the column records are NOT ordered by column no:\n\n// taken from 3.1 FINAL org.apache.poi.hssf.record.aggregates.ColumnInfoRecordsAggregate:\n\n    public void groupColumnRange(short fromColumn, short toColumn, boolean indent)\n    {\n      ...\n// OD bug fix: records NOT ordered by column no\n//                fromIdx = columnIdx - 1; // subtract 1 just in case this column is collapsed later.\n      ...\n    }\n"}, {"count": 2, "text": "fixed in svn 694534.\n\nAs you pointed out, the ColumnInfoRecords were not being kept in proper order.  Rather than disable the optimisation, I fixed the logic to keep the records sorted.  There were a few other methods besides groupColumnRange() that relied on proper ordering.\n\nJunit added for groupColumnRange() and collapseColumn()/expandColumn() ", "bug_id": 45639, "attachment_id": null, "id": 120550, "time": "2008-09-11T16:24:52Z", "creator": "josh@apache.org", "creation_time": "2008-09-11T16:24:52Z", "tags": [], "is_private": false}]