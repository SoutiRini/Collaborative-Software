[{"count": 0, "tags": [], "creator": "hae@zuehlke.com", "text": "Created attachment 31097\nFile which causes a NPE when exporting xml data from\n\nI created a simple excel document with a mapped xml schema. I then tried to export the xml data from the excel sheet. This failed with a null pointer exception.\n\nHere is the stacktrace:\n\njava.lang.NullPointerException\n\tat org.apache.poi.xssf.extractor.XSSFExportToXml.indexOfElementInComplexType(XSSFExportToXml.java:430)\n\tat org.apache.poi.xssf.extractor.XSSFExportToXml.compare(XSSFExportToXml.java:411)\n\tat org.apache.poi.xssf.extractor.XSSFExportToXml.compare(XSSFExportToXml.java:77)\n\tat java.util.TimSort.countRunAndMakeAscending(TimSort.java:324)\n\tat java.util.TimSort.sort(TimSort.java:203)\n\tat java.util.TimSort.sort(TimSort.java:173)\n\tat java.util.Arrays.sort(Arrays.java:659)\n\tat java.util.Collections.sort(Collections.java:217)\n\tat org.apache.poi.xssf.extractor.XSSFExportToXml.exportToXML(XSSFExportToXml.java:157)\n\nThis is the code which calls the poi api:\n\nXSSFMap map = mapInfo.getXSSFMapById(1);\nXSSFExportToXml exporter = new XSSFExportToXml(map);\nByteArrayOutputStream os = new ByteArrayOutputStream();\nexporter.exportToXML(os, true); // It fails here with a NPE\nString xmlData = os.toString(\"UTF-8\");\n\n\nAnd I also attached the excel file.", "id": 171605, "time": "2013-12-06T08:16:16Z", "bug_id": 55850, "creation_time": "2013-12-06T08:16:16Z", "is_private": false, "attachment_id": 31097}, {"count": 1, "tags": [], "bug_id": 55850, "attachment_id": 31099, "text": "Created attachment 31099\nPatch for NPE\n\nincluding Unit Test", "id": 171607, "time": "2013-12-06T09:08:24Z", "creator": "hae@zuehlke.com", "creation_time": "2013-12-06T09:08:24Z", "is_private": false}, {"count": 2, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "text": "Committed as r1549007, good catch, thanks a lot for the Patch!", "id": 171633, "time": "2013-12-08T08:38:37Z", "bug_id": 55850, "creation_time": "2013-12-08T08:38:37Z", "is_private": false}]