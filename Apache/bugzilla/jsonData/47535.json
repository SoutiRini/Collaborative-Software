[{"attachment_id": null, "tags": [], "creator": "max.valjanski@gmail.com", "text": "getFootnoteText can fail with different exceptions caused by incorrect range calculations for empty footnote block:\n\njava.lang.ArrayIndexOutOfBoundsException: 60\n\tat org.apache.poi.util.LittleEndian.getShort(LittleEndian.java:46)\n\tat org.apache.poi.hwpf.sprm.SprmOperation.<init>(SprmOperation.java:54)\n\tat org.apache.poi.hwpf.sprm.SprmIterator.next(SprmIterator.java:45)\n\tat org.apache.poi.hwpf.sprm.ParagraphSprmUncompressor.uncompressPAP(ParagraphSprmUncompressor.java:58)\n\tat org.apache.poi.hwpf.model.PAPX.getParagraphProperties(PAPX.java:130)\n\tat org.apache.poi.hwpf.usermodel.Range.getParagraph(Range.java:819)\n\tat org.apache.poi.hwpf.extractor.WordExtractor.getParagraphText(WordExtractor.java:140)\n\tat org.apache.poi.hwpf.extractor.WordExtractor.getFootnoteText(WordExtractor.java:121)\n\nor\n\njava.lang.IllegalArgumentException: The end (1062) must not be before the start (2029)\n\tat org.apache.poi.hwpf.usermodel.Range.sanityCheckStartEnd(Range.java:244)\n\tat org.apache.poi.hwpf.usermodel.Range.<init>(Range.java:178)\n\tat org.apache.poi.hwpf.usermodel.Paragraph.<init>(Paragraph.java:98)\n\tat org.apache.poi.hwpf.usermodel.Range.getParagraph(Range.java:827)\n\tat org.apache.poi.hwpf.extractor.WordExtractor.getParagraphText(WordExtractor.java:139)\n\tat org.apache.poi.hwpf.extractor.WordExtractor.getFootnoteText(WordExtractor.java:120)", "count": 0, "id": 128869, "time": "2009-07-15T05:37:32Z", "bug_id": 47535, "creation_time": "2009-07-15T05:37:32Z", "is_private": false}, {"count": 1, "tags": [], "creator": "max.valjanski@gmail.com", "attachment_id": null, "text": "Patch does two things:\n\n1) Adds footnote/endnote extraction to WordExtractor.getText(). This breaks TestWordExtractor since POI test suite already contains file with this problem\n\n2) Fixes bug in Range.findRange (this also fixes TestWordExtractor test case)", "id": 128870, "time": "2009-07-15T05:41:29Z", "bug_id": 47535, "creation_time": "2009-07-15T05:41:29Z", "is_private": false}, {"text": "Created attachment 23987\npatch", "tags": [], "creator": "max.valjanski@gmail.com", "attachment_id": 23987, "count": 2, "id": 128871, "time": "2009-07-15T05:43:50Z", "bug_id": 47535, "creation_time": "2009-07-15T05:43:50Z", "is_private": false}, {"count": 3, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "text": "Patch applied in r795333\n\nThanks,\nYegor", "id": 128970, "time": "2009-07-18T03:03:56Z", "bug_id": 47535, "creation_time": "2009-07-18T03:03:56Z", "is_private": false}]