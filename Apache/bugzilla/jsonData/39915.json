[{"attachment_id": null, "tags": [], "bug_id": 39915, "text": "In some configurations, SSLProxyMachineCertificateFile causes Apache to\nseg-fault on startup.  The following small configuration works as expected:\n\n    Listen 80\n    Listen 443\n\n    LoadModule proxy_module modules/mod_proxy.so\n    LoadModule proxy_http_module modules/mod_proxy_http.so\n    LoadModule ssl_module modules/mod_ssl.so\n\n    User nobody\n    Group #-1\n    TypesConfig conf/mime.types\n\n    #<VirtualHost *>\n    #</VirtualHost>\n    <VirtualHost _default_:443>\n    SSLEngine on\n    SSLCertificateFile server.cert\n    </VirtualHost>\n\n    SSLProxyEngine on\n    SSLProxyMachineCertificateFile server.cert\n\n    ProxyPass /foo https://www2.metnet.navy.mil/\n\nRequests for /foo on either 80 or 443 will be reverse-proxied to an HTTPS\nserver, using a client cert.\n\nHowever, if you uncomment the commented VirtualHost lines, Apache seg-faults\non startup.  I haven't investigated the reason.\n\nThis does not seem to be related to bug 24030 (which should be fixed in\napache 2.0.55).", "count": 0, "id": 90707, "time": "2006-06-28T04:49:58Z", "creator": "andrew@pimlott.net", "creation_time": "2006-06-28T04:49:58Z", "is_private": false}, {"count": 1, "tags": [], "creator": "andrew@pimlott.net", "text": "Oh, server.cert is just a dummy self-signed cert plus key.  For ease of\nreproducing, here it is:\n\n-----BEGIN RSA PRIVATE KEY-----\nMIICXwIBAAKBgQCsxmVAUyU3wCtyCE75p2imqRkv2t43Nw6jTe+me2sCAUYoE+ls\nn39/WnUGk299Yg30W1DQDixD1Q15Kv9qlvL+2FylQqH3teS21MDjWYWi2zwS/u53\nShhrUkKJ98Oj1Cqo26wijLCA3+eEpQO+ydj0uk+m2We4HkNnWXAyOq+OGQIDAQAB\nAoGBAIUOeRVzstrfhNXZ7jA3q9GFsp73GGE/Zmd/csssivlNT+E3jHGZ18+VM0Cw\nNJFD/WktFexUreRDZI/m/DLzMwip4Cq3ySkzIXsOAaMOtz9KGET/K9LcRpYh1byO\nFCV+z+43L7Q+Uh8TeKe/Hj+Sh9kA79JamYPtcMKUfUeBbWB9AkEA3hYrwBUf5/xP\npWwc17YtChAox1e/hCE07rAiW5CxtJNI4z2QEFysISGBtFzHSaiIFQEhrJnOI+9p\nMYLtyP/ACwJBAMcoh8NdFUIDNsC7o8QBonS48UPqRwcKPH0bKj4HmcvFTb7P2aIw\nknAqY71Lx65UOfr8z3NRqtLojEDAQF4VTOsCQQDZ4nSP4enIpsDZMaVmeMPdUJdB\nY7RwhEezOTisDtxZpfpnf1mcw97YLlBbTH70pBTGTrLj7I3SsarJuYNipI+bAkEA\nvSnaCc3X6yNyVg3jtsB2tbcUMhXL8PvgCFRNAy3k/o8hESQK6uqHrNIWei4IM6T8\njVCjGj1vq3QGA1qXyMUikQJBAMn5Yj6xh2piPSEvfFifLlerpqNbrKrhMov1oTWN\nboMMQpjW3tnXiqd04nTXjQCxN+4CWNcIdCfuO4OqCfQ5Lrs=\n-----END RSA PRIVATE KEY-----\n-----BEGIN CERTIFICATE-----\nMIICJTCCAY4CCQDEZpgxQTJ07DANBgkqhkiG9w0BAQUFADBXMQswCQYDVQQGEwJV\nUzETMBEGA1UECBMKQ2FsaWZvcm5pYTERMA8GA1UEBxMITW9udGVyZXkxDzANBgNV\nBAoTBkFuZHJldzEPMA0GA1UEAxMGQW5kcmV3MB4XDTA2MDYyODA0NDUxMFoXDTA2\nMDcyODA0NDUxMFowVzELMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNhbGlmb3JuaWEx\nETAPBgNVBAcTCE1vbnRlcmV5MQ8wDQYDVQQKEwZBbmRyZXcxDzANBgNVBAMTBkFu\nZHJldzCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEArMZlQFMlN8ArcghO+ado\npqkZL9reNzcOo03vpntrAgFGKBPpbJ9/f1p1BpNvfWIN9FtQ0A4sQ9UNeSr/apby\n/thcpUKh97XkttTA41mFots8Ev7ud0oYa1JCiffDo9QqqNusIoywgN/nhKUDvsnY\n9LpPptlnuB5DZ1lwMjqvjhkCAwEAATANBgkqhkiG9w0BAQUFAAOBgQCKe9Mjaeut\nlA6cM6vxhfOsbtc1L1Lz2fA3arXM9dv15jAQGpCDAPzC81ortnQpfohJv1wymIN4\nVSDjmbsZi4R6AqK5Pjh/JoCKppdtHmBUaA2EFAkld9CDJAa02vfQAQfupqurN9zf\nA+kd+smwWefqu0Ea/I6WAX6wad7omNiKBQ==\n-----END CERTIFICATE-----\n\nYou should be able to run my config (from the initial report) with something like\n\napache2 -X -d $PWD -f httpd.conf\n\nif you put the config in httpd.conf and the cert in server.cert in the same\ndirectory.  You'll have to create a few other files, but you're smart, you'll\nfigure it out.", "id": 90708, "time": "2006-06-28T05:12:27Z", "bug_id": 39915, "creation_time": "2006-06-28T05:12:27Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "jorton@redhat.com", "is_private": false, "text": "Can you get a backtrace?\n\ngdb /path/to/httpd\n...\n(gdb) run -X\n...\n(gdb) bt\n", "id": 90713, "time": "2006-06-28T07:35:03Z", "bug_id": 39915, "creation_time": "2006-06-28T07:35:03Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 39915, "attachment_id": null, "is_private": false, "id": 90734, "time": "2006-06-28T16:39:11Z", "creator": "andrew@pimlott.net", "creation_time": "2006-06-28T16:39:11Z", "text": "Hmm, I didn't realize I'd get a reasonable backtrace without recompiling\neverything with debugging.  Here it is:\n\n#0  0xa7e19c61 in CRYPTO_add_lock () from /usr/lib/i686/cmov/libcrypto.so.0.9.8\n#1  0xa7e9dcae in X509_INFO_free () from /usr/lib/i686/cmov/libcrypto.so.0.9.8\n#2  0xa7e83660 in sk_pop_free () from /usr/lib/i686/cmov/libcrypto.so.0.9.8\n#3  0xa7989008 in ssl_init_ModuleKill () from /home/andrew/u/modules/mod_ssl.so\n#4  0xa7c7ee4d in apr_pool_tag () from /usr/lib/libapr-0.so.0\n#5  0xa7c7fd27 in apr_pool_clear () from /usr/lib/libapr-0.so.0\n#6  0x0807e64d in main ()"}, {"attachment_id": null, "tags": [], "bug_id": 39915, "is_private": false, "count": 4, "id": 90756, "time": "2006-06-29T09:50:44Z", "creator": "jorton@redhat.com", "creation_time": "2006-06-29T09:50:44Z", "text": "That doesn't ring any bells.  What version of OpenSSL, what distribution? Is\nthis reproducible with 2.2.2?  What is the error_log output with \"LogLevel debug\"?"}, {"count": 5, "tags": [], "text": "Never mind, I can reproduce this.", "is_private": false, "id": 90757, "creator": "jorton@redhat.com", "time": "2006-06-29T09:56:56Z", "bug_id": 39915, "creation_time": "2006-06-29T09:56:56Z", "attachment_id": null}, {"count": 6, "tags": [], "text": "Fixed on the trunk:\n\n  http://svn.apache.org/viewvc?view=rev&revision=417988\n\nand will propose for 2.2.x.  Thanks for the report.\n", "is_private": false, "id": 90758, "creator": "jorton@redhat.com", "time": "2006-06-29T10:34:06Z", "bug_id": 39915, "creation_time": "2006-06-29T10:34:06Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 39915, "text": "Thanks so much for figuring this out.  Sorry for forgetting all my version\ndetails; somehow the mind just goes when filing bug reports.", "count": 7, "id": 90769, "time": "2006-06-29T20:03:18Z", "creator": "andrew@pimlott.net", "creation_time": "2006-06-29T20:03:18Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 39915, "text": "*** Bug 48824 has been marked as a duplicate of this bug. ***", "count": 8, "id": 135048, "time": "2010-03-04T13:08:32Z", "creator": "s9flschr@stud.uni-saarland.de", "creation_time": "2010-03-04T13:08:32Z", "is_private": false}]