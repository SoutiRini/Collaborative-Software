[{"count": 0, "tags": [], "bug_id": 49874, "attachment_id": 25979, "id": 139643, "time": "2010-09-03T02:51:29Z", "creator": "martin.studer@mirai-solutions.com", "creation_time": "2010-09-03T02:51:29Z", "is_private": false, "text": "Created attachment 25979\nZip file with the mentioned workbooks (Test.xls and Test.xlsx)\n\nI have an Excel file with three sheets called AAA, BBB, CCC. On each of them there is a name defined: AA on AAA, BB on BBB, CC on CCC. If I'm now removing sheet BBB, the behaviour for a HSSF workbook is different than for a XSSF workbook. The following is what I observe:\n\n- HSSF: Sheets AAA and CCC remain (which is ok), but left are only names AA and BB. This is strange. I would understand if BB would be missing but CC should definitely still be around I guess. Also, if you open the file with an older version of Excel (< 2007) you are confronted with a dialog saying that the file has been repaired. Excel 2007+ seems to do that behind the scenes.\n\n- XSSF: Sheets AAA and CCC remain (again, this is ok), and so do the names AA and CC. This behaviour seems ok to me.\n\nPlease find a snippet of code that can be used to reproduce the problem:\n\n\nWorkbook wb = WorkbookFactory.create(new FileInputStream(\"C:/Users/mstuder/Documents/Test.xls\"));\nwb.removeSheetAt(wb.getSheetIndex(\"BBB\"));\nwb.write(new FileOutputStream(\"C:/Users/mstuder/Documents/Test2.xls\"));\n\nAlso, please find attached the two corresponding Excel files (*.xls and *.xlsx).\n\nOS: Windows 7\nPOI: 3.7-beta2\nJava: 1.6.0_20 64-bit"}, {"count": 1, "tags": [], "creator": "awm@mbcli.com", "is_private": false, "text": "As of last night's trunk AA, BB, and CC all appear in xlsx version after BBB is deleted.  I didn't try the OLE2.\n\nI think leaving the BB named range is the proper outcome.", "id": 142934, "time": "2010-12-23T20:19:00Z", "bug_id": 49874, "creation_time": "2010-12-23T20:19:00Z", "attachment_id": null}]