[{"count": 0, "tags": [], "bug_id": 21094, "attachment_id": null, "text": "<uptodate>\n  <srcfiles dir=\"../siblingdir\" includes=\"subdir/*.java\"/>\n  <mapper type=\"glob\" from=\"subdir/*.java\"\n          to=\"another-subdir/*.class\"/>\n</uptodate>\n\nDesired: change \"../siblingdir/subdir/*.java\" to \"another-subdir/*.class\".\nActual: all changes must be w/r/t the srcfiles dir; if \".\" is used, the \nabove \"../siblingdir\" does not work with \"includes\". \n\nThe srcfiles \"dir\" setting seems to apply to the mapper's \"to\" attribute but not\nto its \"from\" attribute.", "id": 39435, "time": "2003-06-25T20:08:55Z", "creator": "twall@users.sourceforge.net", "creation_time": "2003-06-25T20:08:55Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 21094, "attachment_id": null, "id": 39462, "time": "2003-06-26T07:33:05Z", "creator": "peter.reilly@corvil.com", "creation_time": "2003-06-26T07:33:05Z", "is_private": false, "text": "This is as designed.\nNormally one should do:\n    <mkdir dir=\"../sib/a/b/c\"/>\n    <touch file=\"../sib/a/b/c/file.xml\"/>\n    <property name=\"sib.dir\" location=\"../sib\"/>\n    \n    <uptodate property=\"upto.date\">\n        <srcfiles dir=\"${sib.dir}\" includes=\"a/**/*.xml\"/>\n        <mapper type=\"glob\" from=\"a/*.xml\"\n                to=\"${sib.dir}/javafiles/*.java\"/>\n    </uptodate>"}, {"count": 2, "tags": [], "text": "The desired target directory is not a sibling directory, but a subdirectory of\nthe current one.  The \"to\" path must be relative to the srcfiles dir, which a)\nmakes for a convoluted path and b) doesn't work if \"to\" cannot be specified\nrelative to the srcfiles dir and c) requires knowlege of what the current\ndirectory is named.\n\n    <mkdir dir=\"../sib/a/b/c\"/>\n    <touch file=\"../sib/a/b/c/file.xml\"/>\n    <property name=\"sib.dir\" location=\"../sib\"/>\n    <property name=\"target.dir\" location=\"output\"/>\n    \n    <uptodate property=\"upto.date\">\n        <srcfiles dir=\"${sib.dir}\" includes=\"a/**/*.xml\"/>\n        <mapper type=\"glob\" from=\"a/*.xml\"\n                to=\"${output}/javafiles/*.java\"/>\n    </uptodate>\n\nThe line given above does not work.  In this case, \"to\" must be\n\"../{$pwd?}/${output}/javafiles/*.java\" to work.  \"from\" evaluates to\na/b/c/file.xml, \"to\" evaluates to $PWD/a/b/c/javafiles/file.java (as reported by\n\"ant -v\").", "is_private": false, "bug_id": 21094, "id": 39477, "time": "2003-06-26T12:01:02Z", "creator": "twall@users.sourceforge.net", "creation_time": "2003-06-26T12:01:02Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 21094, "attachment_id": null, "id": 39478, "time": "2003-06-26T12:28:50Z", "creator": "peter.reilly@corvil.com", "creation_time": "2003-06-26T12:28:50Z", "is_private": false, "text": "Sorry I do not understand the problem.\n    <mkdir dir=\"../sib/a/b/c\"/>\n    <touch file=\"../sib/a/b/c/file.xml\"/>\n    <property name=\"sib.dir\" location=\"../sib\"/>\n    <property name=\"target.dir\" location=\"output\"/>\n    \n    <uptodate property=\"upto.date\">\n        <srcfiles dir=\"${sib.dir}\" includes=\"a/**/*.xml\"/>\n        <mapper type=\"glob\" from=\"a/*.xml\"\n                to=\"${target.dir}/javafiles/*.java\"/>\n    </uptodate>\n\nant -verbose gives:\nparsing buildfile /home/preilly/proj/learning/map/mapper.xml with URI =\nfile:///home/preilly/proj/learning/map/mapper.xml\nProject base dir set to: /home/preilly/proj/learning/map\na/b/c/file.xml added as\n/home/preilly/proj/learning/map/output/javafiles/b/c/file.java doesn't exist.\n\nMappers are difficult to use and a bit unintutive - but they\ndo work as designed."}, {"count": 4, "tags": [], "creator": "twall@users.sourceforge.net", "attachment_id": null, "id": 39485, "time": "2003-06-26T14:18:46Z", "bug_id": 21094, "creation_time": "2003-06-26T14:18:46Z", "is_private": false, "text": "I see the problem.   If you replace ${target.dir} with simply \"output\", then the target is no \nlonger an absolute output directory.    \n\n    <uptodate property=\"upto.date\">\n        <srcfiles dir=\"${sib.dir}\" includes=\"a/**/*.xml\"/>\n        <mapper type=\"glob\" from=\"a/*.xml\"\n                to=\"output/javafiles/*.java\"/>\n    </uptodate>\n\nThe file path preceding \"a/**/*.xml\" is effectively invisible to the mapper (i.e. you can't use \nit in the \"from\") but it will tack it on to the \"to\" path unless the \"to\" pattern is an absolute \npath."}, {"count": 5, "attachment_id": null, "bug_id": 21094, "text": "BTW, the reason it wasn't working for me was that I had\n\n<property name=\"target.dir\" value=\"subdir\"/>\n\nrather than\n\n<property name=\"target.dir\" location=\"subdir\"/>", "id": 39486, "time": "2003-06-26T14:19:52Z", "creator": "twall@users.sourceforge.net", "creation_time": "2003-06-26T14:19:52Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "creator": "antoine@apache.org", "attachment_id": null, "is_private": false, "id": 39598, "time": "2003-06-29T17:01:01Z", "bug_id": 21094, "creation_time": "2003-06-29T17:01:01Z", "text": "It sounds like Peter Reilly's explanations have fixed the issue.\nSo I am closing the report."}]