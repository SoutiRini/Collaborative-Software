[{"count": 0, "tags": [], "bug_id": 33549, "is_private": false, "text": "Scenario:\nI insert into a method which has a parameterized argument some instructions and\ntwo local variables.\nThe methods signature looks like this:\npublic void doSomething( double d, ArrayList<Integer> list )\nThe method is situated in the class MyClassFile.\n\nResult:\nLoading the class MyClassFile which contains the new method 'doSomething'\nresults in a ClassFormatError:\nLVTT entry for 'list' in class file MyClassFile does not match any LVT entry\n\nThis error is not produced if the method declaration is done without generics:\npublic void doSomething( double d, ArrayList list )\n\nThe difference is the LocalVariableTypeTable. It is not present if I do not use\ngenerics. \nDue to the insertion of the new instructions the start_pc and the length of the\nlocal variable have to be updated in the LocalVariableTable, which is done. \nBut the corresponding entry in the LocalVariableTypeTable gets not updated its\nstart_pc and length entries.\n\nLocalVariableTable ( BEFORE INSERTION ):\nstart_pc, length, index, name\n0, 26, 0, this\n0, 26, 1, d\n0, 26, 3, list\nLocalVariableTypeTable( BEFORE INSERTION ):\n0, 26, 3, list\n\nLocalVariableTable ( AFTER INSERTION ):\nstart_pc, length, index, name\n44, 33, 0, this\n44, 33, 1, d\n44, 33, 3, list\n1, 85, 4, wrapper_argumentlist\n26, 60, 5, wrapper\nLocalVariableTypeTable( AFTER INSERTION ):\n0, 26, 3, list\n\nThe class works fine before the insertion.\nI've done bcel CVS checkout, but it did not help.\nThe original instructions of the methods are not modified.\nI simply install a wrapper around the original body. \nI add an exception handler, therefore there is also an additional entry in\nthe exceptiontable.\nI can toggle the error behaviour by using or not using the generic argument.\ngeneric -> error \nno generic -> no error\nI tried JDK 5.0 build 1.5.0-b64 and eclipse 3.1.0 build 200412162000 as a compiler.\nI use the JVR of the above mentioned JDK.", "id": 70912, "time": "2005-02-14T03:00:03Z", "creator": "marco.petris@web.de", "creation_time": "2005-02-14T03:00:03Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 33549, "attachment_id": null, "id": 70914, "time": "2005-02-14T05:00:04Z", "creator": "jhp@csail.mit.edu", "creation_time": "2005-02-14T05:00:04Z", "is_private": false, "text": "One possible workaround before BCEL supports Local Variable type Tables\nis to simply remove the table.  It is optional and everything seems to\nwork fine if you remove it.  Simply loop through the attributes and\nremove the one named \"LocalVariableTypeTable\".  I think the only\ndownside is that the information won't be available to a debugger."}, {"count": 2, "tags": [], "text": "The proposed workaround works even with the \nInstrumentation.redefineClasses( ClassDefinition[] definitions ) of JDK1.5", "is_private": false, "id": 70919, "creator": "marco.petris@web.de", "time": "2005-02-14T12:03:13Z", "bug_id": 33549, "creation_time": "2005-02-14T12:03:13Z", "attachment_id": null}, {"count": 3, "tags": [], "text": "So we this should be fixed for proper jdk 1.5 support", "attachment_id": null, "id": 85104, "creator": "tcurdt@apache.org", "time": "2006-01-27T14:16:57Z", "bug_id": 33549, "creation_time": "2006-01-27T14:16:57Z", "is_private": false}, {"text": "It looks like a dup of http://issues.apache.org/bugzilla/show_bug.cgi?id=39695", "tags": [], "bug_id": 33549, "is_private": false, "count": 4, "id": 101311, "time": "2007-04-01T15:16:22Z", "creator": "erik@jpox.org", "creation_time": "2007-04-01T15:16:22Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 33549, "attachment_id": null, "text": "i have  loop through the attributes and\nremove the one named \"LocalVariableTypeTabe\". The problem still occurs", "id": 124866, "time": "2009-02-16T01:19:02Z", "creator": "psramkumar@adventnet.com", "creation_time": "2009-02-16T01:19:02Z", "is_private": false}]