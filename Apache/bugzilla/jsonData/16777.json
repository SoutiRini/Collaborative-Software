[{"count": 0, "tags": [], "bug_id": 16777, "attachment_id": null, "text": "After rapid image requests (in my test case images in a drop down javascript \nmenu) requests cease to be processed (servlet doGet is not called). This \nsituation persists until IE 6.0 reconnects to the server after a timeout \nperiod. The problem ONLY occurs when the server is running on Windows XP (all \nupdates have been applied) and occurs frequently when requesting images in \nbatchs of around 15 at a time. The servlet code to deliver the image is very \nsimple and is as follows:\n            // caching is disabled only exacerbate the problem by causing more\n            // image request\n            response.setHeader(\"Cache-Control\", \"no-store\");\n            response.setContentLength(imageBytes.length);\n            response.getOutputStream().write(imageBytes);\n\nPausing the server during this condition reveals two threads reading from \nconnected sockets. After a period of time (in my case 20 seconds) the reads \ntimeout and the following exception occurs (this is caught internally and not \nlogged):\njava.net.SocketTimeoutException: Read timed out\n\tat java.net.SocketInputStream.socketRead0(Native Method)\n\tat java.net.SocketInputStream.read(SocketInputStream.java:129)\n\tat org.apache.coyote.http11.InternalInputBuffer.fill\n(InternalInputBuffer.java:771)\n\tat org.apache.coyote.http11.InternalInputBuffer.parseRequestLine\n(InternalInputBuffer.java:429)\n\tat org.apache.coyote.http11.Http11Processor.process\n(Http11Processor.java:407)\n\tat \norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnecti\non(Http11Protocol.java:386)\n\tat org.apache.tomcat.util.net.TcpWorkerThread.runIt\n(PoolTcpEndpoint.java:534)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:530)\n\tat java.lang.Thread.run(Thread.java:536)\n\nFurther notes:\n    - When the server is in this state other browsers may connect to the \nserver and it responds to requests properly.\n    - the problem also occurs using Connector:HTTP/1.1\n    - the problem does NOT occur using Tomcat 3.3a\n    - When repeating this problem the following exceptions occur frequently \n(these are caught internally and not logged):\njava.net.SocketException: Connection reset\n\tat java.net.SocketInputStream.read(SocketInputStream.java:168)\n\tat org.apache.coyote.http11.InternalInputBuffer.fill\n(InternalInputBuffer.java:771)\n\tat org.apache.coyote.http11.InternalInputBuffer.parseRequestLine\n(InternalInputBuffer.java:429)\n\tat org.apache.coyote.http11.Http11Processor.process\n(Http11Processor.java:407)\n\tat \norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnecti\non(Http11Protocol.java:386)\n\tat org.apache.tomcat.util.net.TcpWorkerThread.runIt\n(PoolTcpEndpoint.java:534)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:530)\n\tat java.lang.Thread.run(Thread.java:536)", "id": 30680, "time": "2003-02-04T20:22:11Z", "creator": "rknight@conceptwave.com", "creation_time": "2003-02-04T20:22:11Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "remm@apache.org", "is_private": false, "count": 1, "id": 30684, "time": "2003-02-04T21:10:19Z", "bug_id": 16777, "creation_time": "2003-02-04T21:10:19Z", "text": "There is a problem because (likely) your IE messed up, and as it is only using\ntwo connections to download images, it gets stuck. The stack traces you mention\nare normal when using HTTP/1.1 keep alive, and does not indicate anything wrong.\nIf you can actually point out to something which is not HTTP/1.1 compliant in\nthe HTTP/1.1 connector, please report it (otherwise, please do not reopen this bug).\n\nTomcat 3.3 couldn't have this \"problem\" because it is not attempting to keep\nalive a connection."}, {"attachment_id": null, "tags": [], "creator": "rknight@conceptwave.com", "is_private": false, "count": 2, "id": 30694, "time": "2003-02-04T22:17:43Z", "bug_id": 16777, "creation_time": "2003-02-04T22:17:43Z", "text": "Yes, I found an open IE bug (http://support.microsoft.com/default.aspx?\nscid=kb;en-us;269802) that describes this problem exactly."}]