[{"count": 0, "tags": [], "creator": "trejkaz@trypticon.org", "is_private": false, "text": "The support I provided for getting pictures was only getting out the bitmaps. \nThe following patch adds support for any kind of image stored in a BLIP.", "id": 106769, "time": "2007-08-14T18:40:31Z", "bug_id": 43125, "creation_time": "2007-08-14T18:40:31Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 43125, "text": "Created attachment 20663\nProposed patch", "id": 106770, "time": "2007-08-14T18:40:50Z", "creator": "trejkaz@trypticon.org", "creation_time": "2007-08-14T18:40:50Z", "is_private": false, "attachment_id": 20663}, {"count": 2, "tags": [], "creator": "trejkaz@trypticon.org", "attachment_id": null, "id": 106771, "time": "2007-08-14T18:48:24Z", "bug_id": 43125, "creation_time": "2007-08-14T18:48:24Z", "is_private": false, "text": "On second thought it looks like this will need a little more work.  The binary\nexposed is in itself not the picture data.  I'll get a better patch in once I've\nfigured out how this F01A blip works.\n"}, {"count": 3, "tags": [], "bug_id": 43125, "text": "Created attachment 20666\nProposed patch, v2\n\nHere's a better version, defines an EscherMetafileBlip class which properly\nhandles at least EMF.\n\nI can't find the record IDs for WMF and PICT anywhere.\tIf someone could create\na file with those types of BLIP inside, I would be grateful, but even if I put\na WMF into the document on my copy of Word, I seem to get an EMF.", "id": 106775, "time": "2007-08-14T20:27:42Z", "creator": "trejkaz@trypticon.org", "creation_time": "2007-08-14T20:27:42Z", "is_private": false, "attachment_id": 20666}, {"count": 4, "tags": [], "creator": "dfisher@jmlafferty.com", "attachment_id": null, "is_private": false, "id": 106776, "time": "2007-08-14T20:40:13Z", "bug_id": 43125, "creation_time": "2007-08-14T20:40:13Z", "text": "I'm pretty sure that Yegor will have a look at this patch some time next week,\nhe'll have an example of a PICT and maybe an EMF."}, {"count": 5, "tags": [], "creator": "dfisher@jmlafferty.com", "attachment_id": null, "text": "I meant WMF, not EMF.", "id": 106777, "time": "2007-08-14T20:41:15Z", "bug_id": 43125, "creation_time": "2007-08-14T20:41:15Z", "is_private": false}, {"count": 6, "attachment_id": null, "bug_id": 43125, "is_private": false, "id": 107266, "time": "2007-08-26T09:01:34Z", "creator": "yegor@dinom.ru", "creation_time": "2007-08-26T09:01:34Z", "tags": [], "text": "I reviewed and committed the patch. The code works fine for EMF and WMF but \nfails on PICT.\nSee how I read PICT in org.apache.poi.hslf.blip.PICT. The header is different \nfrom WMF/EMF and you \nshould skip different number of bytes before inflating the data.  \n\nHow did you test your code? Would you provide a unit test? \n\nI provided two xls files:\n\nsrc\\testcases\\org\\apache\\poi\\hssf\\data\\SimpleWithImages.xls\nCreated on Windows. Contains JPEG, PNG, EMF and WMF. \n\nsrc\\testcases\\org\\apache\\poi\\hssf\\data\\SimpleWithImages-mac.xls\nCreated on MAC. Contains JPEG, PNG and PICT. \n\nThe point is that MS Office for MAC automatically converts WMF and EMF into \nPICT and vise versa - \nMS Office for Windows automatically stores PICT as WMF. So there are two test \nfiles. \n\nAll the pictures can be found in \nsrc\\scratchpad\\testcases\\org\\apache\\poi\\hslf\\data\\\n\nsrc\\testcases\\org\\apache\\poi\\hssf\\usermodel\\TestHSSFPictureData.java\nAdd your test logic in this file. It already contains tests for JPEG and PNG. \n\nRegards,\nYegor"}, {"count": 7, "tags": [], "creator": "trejkaz@trypticon.org", "is_private": false, "text": "I'll get onto writing that unit test as soon as I'm done with my current round\nof changes.  At the moment my own code is in disarray from working on another\nfeature.\n", "id": 107268, "time": "2007-08-26T16:18:58Z", "bug_id": 43125, "creation_time": "2007-08-26T16:18:58Z", "attachment_id": null}, {"count": 8, "tags": [], "creator": "poi-support@buni.org", "attachment_id": null, "text": "make sure this doesn't break the existing stuff for drawing Escher images in\nExcel...", "id": 108027, "time": "2007-09-11T08:01:00Z", "bug_id": 43125, "creation_time": "2007-09-11T08:01:00Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 43125, "attachment_id": null, "is_private": false, "id": 197143, "time": "2017-02-18T17:59:31Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2017-02-18T17:59:31Z", "text": "I think most of these changes are applied since some time and there was updated support for EMF/WMF in some areas lately (more exctraction than HSSF directly though), however I don't think this is still applicable and thus won't be applied unless someone comes up with an up-to-date set of changes."}]