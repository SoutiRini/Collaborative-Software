[{"count": 0, "tags": [], "bug_id": 47747, "text": "Created attachment 24176\nThis zip contains the original and processed spreadsheets.\n\nI have tried version 3.5, 3.6 and 3.7.\n\nWhen trying to run the following code to go through a spreadsheet and update\nthe formula values, I get several errors (java.lang.RuntimeException: Shared\nFormula Conversion: Coding Error).  When I open the newly created spreadsheet,\nseveral cells have #REF issues.  I will attach the original and processed\nspreadsheets.\n\npublic static void RecalculateFormulas(String filename) throws\nFileNotFoundException, IOException\n    {   try{\n        FileInputStream fis = new FileInputStream(filename);\n        FileOutputStream out = new\nFileOutputStream(filename.replaceAll(\".xls\",\"temp.xls\"));\n        HSSFWorkbook wb = new HSSFWorkbook(fis); //or new\nXSSFWorkbook(\"/somepath/test.xls\")\n        FormulaEvaluator evaluator =\nwb.getCreationHelper().createFormulaEvaluator();\n        for(int sheetNum = 0; sheetNum < wb.getNumberOfSheets(); sheetNum++) {\n            org.apache.poi.ss.usermodel.Sheet sheet = wb.getSheetAt(sheetNum);\n            for(org.apache.poi.ss.usermodel.Row r : sheet) {\n                for(org.apache.poi.ss.usermodel.Cell c : r) {\n                    if(c.getCellType() ==\norg.apache.poi.ss.usermodel.Cell.CELL_TYPE_FORMULA) {\n                        try{evaluator.evaluateFormulaCell(c);}\n                        catch(Exception e)\n                        {System.out.println(e.toString());}\n                    }\n                }\n            }\n        }\n        wb.write(out);\n        out.close();\n        }\n        catch(Exception e)\n        {System.out.println(e.toString());\n        }\n    }", "id": 129980, "time": "2009-08-27T06:21:18Z", "creator": "kevinrmckee@hotmail.com", "creation_time": "2009-08-27T06:21:18Z", "is_private": false, "attachment_id": 24176}, {"count": 1, "attachment_id": 24191, "creator": "Petr.Udalau@exigenservices.com", "text": "Created attachment 24191\nPatch resolves the problem.", "id": 130058, "time": "2009-08-31T03:59:21Z", "bug_id": 47747, "creation_time": "2009-08-31T03:59:21Z", "tags": [], "is_private": false}, {"count": 2, "attachment_id": null, "creator": "kevinrmckee@hotmail.com", "text": "(In reply to comment #1)\n> Created an attachment (id=24191) [details]\n> Patch resolves the problem.\n\nThanks, but is there a new build of the JAR file which will contain this patch, or do I have to download all of the source and rebuild it?", "id": 130119, "time": "2009-09-02T10:40:21Z", "bug_id": 47747, "creation_time": "2009-09-02T10:40:21Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "creator": "dfisher@jmlafferty.com", "attachment_id": null, "is_private": false, "id": 130120, "time": "2009-09-02T11:04:26Z", "bug_id": 47747, "creation_time": "2009-09-02T11:04:26Z", "text": "Until a POI developer evaluates this patch and applies it to the trunk the patch is only available here or from the contributing developer."}, {"count": 4, "tags": [], "creator": "kevinrmckee@hotmail.com", "attachment_id": null, "is_private": false, "id": 130123, "time": "2009-09-02T14:07:54Z", "bug_id": 47747, "creation_time": "2009-09-02T14:07:54Z", "text": "(In reply to comment #3)\n> Until a POI developer evaluates this patch and applies it to the trunk the\n> patch is only available here or from the contributing developer.\n\nAny idea when that might happen so I can utilize this new fix? How often do patches get added to the trunk?\n\nThanks"}, {"count": 5, "attachment_id": null, "creator": "kevinrmckee@hotmail.com", "text": "(In reply to comment #3)\n> Until a POI developer evaluates this patch and applies it to the trunk the\n> patch is only available here or from the contributing developer.\n\nI downloaded http://encore.torchbox.com/poi-svn-build/poi-3.5-beta7-20090909.jar but I still have the same error.  Has this patch been included in the version I downloaded?", "id": 130252, "time": "2009-09-09T08:54:26Z", "bug_id": 47747, "creation_time": "2009-09-09T08:54:26Z", "tags": [], "is_private": false}, {"count": 6, "attachment_id": null, "creator": "dfisher@jmlafferty.com", "text": "*** Bug 47855 has been marked as a duplicate of this bug. ***", "id": 130473, "time": "2009-09-16T20:11:01Z", "bug_id": 47747, "creation_time": "2009-09-16T20:11:01Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "creator": "josh@apache.org", "attachment_id": null, "is_private": false, "id": 130499, "time": "2009-09-17T17:44:53Z", "bug_id": 47747, "creation_time": "2009-09-17T17:44:53Z", "text": "Fixed in svn r816417\n\nThere was a problem with the way POI associated formula records with the corresponding shared formula records.  The actual fix needed to be made much earlier than where the patch suggested (By that stage the formula record had already been attached to the wrong shared formula)."}]