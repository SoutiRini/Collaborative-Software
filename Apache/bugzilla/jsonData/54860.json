[{"attachment_id": null, "tags": [], "bug_id": 54860, "text": "org.apache.poi.hwpf.usermodel.Range.getTable(Paragraph) checks if a given Paragraph is the first in the table by comparing it with the previous paragraph. So the previous paragraph is created in line 926 by calling \n\n<code>\n            Paragraph previous = Paragraph.newParagraph( this,\n                    _paragraphs.get( r._parStart - 1 ) );\n</code>\n\nUnfortunatly, the end index in the sections list of the Range of the previous Paragraph is not correctly initialized.\n\nSo the comparison in line 931 fails, if r._sectionStart is larger than 1 (as previous._sectionEnd is still 0.\n\n<code>\n            if ( previous.isInTable() && //\n                    previous.getTableLevel() == tableLevel //\n                    && previous._sectionEnd >= r._sectionStart )\n</code>\n\nResolution: Initialize the previous Paragraph by calling initAll():\n\n<code>\n        if ( r._parStart != 0 )\n        {\n            Paragraph previous = Paragraph.newParagraph( this,\n                    _paragraphs.get( r._parStart - 1 ) );\n            previous.initAll(); // initialize sections for proper comparison\n            if ( previous.isInTable() && //\n                    previous.getTableLevel() == tableLevel //\n                    && previous._sectionEnd >= r._sectionStart )\n            {\n                throw new IllegalArgumentException(\n                        \"This paragraph is not the first one in the table\" );\n            }\n        }\n\n</code>", "count": 0, "id": 166687, "time": "2013-04-18T08:01:26Z", "creator": "bork@yatta.de", "creation_time": "2013-04-18T08:01:26Z", "is_private": false}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 166689, "time": "2013-04-18T09:59:40Z", "bug_id": 54860, "creation_time": "2013-04-18T09:59:40Z", "is_private": false, "text": "Are you able to put together a small unit test that shows off the problem, and shows that your proposed fix solves it?"}, {"count": 2, "tags": [], "creator": "bork@yatta.de", "text": "Created attachment 30244\nTestcase", "id": 166964, "time": "2013-04-30T14:32:22Z", "bug_id": 54860, "creation_time": "2013-04-30T14:32:22Z", "is_private": false, "attachment_id": 30244}, {"count": 3, "tags": [], "bug_id": 54860, "text": "Created attachment 30245\nExample document for the testcase", "id": 166965, "time": "2013-04-30T14:32:48Z", "creator": "bork@yatta.de", "creation_time": "2013-04-30T14:32:48Z", "is_private": false, "attachment_id": 30245}, {"attachment_id": null, "tags": [], "bug_id": 54860, "text": "Please find here a test case for the bug.", "count": 4, "id": 166966, "time": "2013-04-30T14:33:26Z", "creator": "bork@yatta.de", "creation_time": "2013-04-30T14:33:26Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 54860, "attachment_id": null, "text": "I tried to finally apply this, but unfortunately this change breaks some existing tests: TestWordExtractorBugs.testProblemMetadata, I could not see quickly why it happens now and how to resolve this...", "id": 201899, "time": "2017-11-04T13:00:17Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2017-11-04T13:00:17Z", "is_private": false}]