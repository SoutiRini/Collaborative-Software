[{"count": 0, "tags": [], "text": "While porting mod_watch to Apache 2.0, I looked at mod_auth_digest as an example\nof a module using shared memory and mutexes.  While looking at it I found what I\nwould consider to be some serious problems with the code:\n\na) No where in the module is client_rmm initialised before being used.\n\nb) Line 1103 has the following:\n\n    apr_global_mutex_lock(opaque_lock);\n    op = (*opaque_cntr)++;\n    apr_global_mutex_lock(opaque_lock);\n\nI think the second apr_global_mutex_lock() should be apr_global_mutex_unlock().", "is_private": false, "id": 29341, "creator": "achowe@snert.com", "time": "2003-01-14T08:22:38Z", "bug_id": 16057, "creation_time": "2003-01-14T08:22:38Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "trawick@apache.org", "attachment_id": null, "text": "ugh... that isn't the only massive suckage...  client_shm is initialized\nbut not used for anything but a flag...  in add_client(), a lock is obtained\nbut not released on an error path...\n", "id": 29407, "time": "2003-01-15T16:52:02Z", "bug_id": 16057, "creation_time": "2003-01-15T16:52:02Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 16057, "attachment_id": null, "id": 31403, "time": "2003-02-17T05:01:01Z", "creator": "jerenkrantz@apache.org", "creation_time": "2003-02-17T05:01:01Z", "is_private": false, "text": "Either we should fix this (ouch, it is soooo broken), or just toss the shmem usage from mod_auth_digest.  It's always disabled now.  If someone wants to add it back, they would probably be better starting off from scratch than trying to sort out the current mess."}, {"count": 3, "tags": [], "creator": "chip@force-elite.com", "attachment_id": null, "text": "We should just remove the shmem code from head, since it has never been used anyways..", "id": 62697, "time": "2004-08-30T03:49:44Z", "bug_id": 16057, "creation_time": "2004-08-30T03:49:44Z", "is_private": false}, {"count": 4, "tags": [], "text": "Seems fairly easy, but nothing yet after three years.", "is_private": false, "id": 104237, "creator": "davi@apache.org", "time": "2007-06-08T13:49:53Z", "bug_id": 16057, "creation_time": "2007-06-08T13:49:53Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 16057, "attachment_id": null, "is_private": false, "id": 127243, "time": "2009-05-21T08:15:06Z", "creator": "poirier@pobox.com", "creation_time": "2009-05-21T08:15:06Z", "text": "Still seems fairly easy, only six years since the problem was opened :-)"}, {"count": 6, "tags": [], "bug_id": 16057, "attachment_id": 23921, "id": 128481, "time": "2009-07-02T07:11:30Z", "creator": "poirier@pobox.com", "creation_time": "2009-07-02T07:11:30Z", "is_private": false, "text": "Created attachment 23921\nReplace use of shared memory with socache\n\nHere's a first pass at replacing mod_auth_digest's use of shared memory with socache.  The changes are more pervasive than I'd like to make all at once, but the assumptions about use of shared memory went through a lot of the code.\n\nFeedback, criticism, suggestions for improvement welcome."}, {"count": 7, "text": "Instead of completely re-writing it, I fixed the shared memory,\nrmm, and lock usage problems that have been reported or that I\ncame across while fixing those.\n\nFixed in trunk rev 808150", "creator": "poirier@pobox.com", "is_private": false, "id": 129962, "time": "2009-08-26T11:30:11Z", "bug_id": 16057, "creation_time": "2009-08-26T11:30:11Z", "tags": [], "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 16057, "is_private": false, "count": 8, "id": 167510, "time": "2013-05-30T14:47:34Z", "creator": "covener@gmail.com", "creation_time": "2013-05-30T14:47:34Z", "text": "Fixed as far back as anyone is probably willing to go (fixed in trunk before 2.4.x branch)"}, {"attachment_id": null, "tags": [], "bug_id": 16057, "is_private": false, "count": 9, "id": 177038, "time": "2014-08-10T06:54:01Z", "creator": "christophe.jaillet@wanadoo.fr", "creation_time": "2014-08-10T06:54:01Z", "text": "Also see PR51711 ?"}, {"count": 10, "tags": [], "bug_id": 16057, "attachment_id": null, "id": 195579, "time": "2016-12-20T21:42:02Z", "creator": "wrowe@apache.org", "creation_time": "2016-12-20T21:42:02Z", "is_private": false, "text": "Users applying this patch to earlier 2.0/2.2 sources should be aware of\nr1773069 correcting CVE-2016-2161 - a defect exposed by enabling shm\n(which seems to have been effectively impossible before this fix.)"}]