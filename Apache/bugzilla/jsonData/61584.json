[{"count": 0, "tags": [], "bug_id": 61584, "attachment_id": null, "id": 201302, "time": "2017-10-05T11:58:07Z", "creator": "marko@friedemann.email", "creation_time": "2017-10-05T11:58:07Z", "is_private": false, "text": "XDGFPage getPageOffset contains a wrong check for null, causing an NPE for .vsdx documents that don't have the YRulerOrigin set.\n\nThe code in question has been there ever since this was contributed, so it appears to affect all versions.\n\n,-- XDGFPage.java, lines 99ff [1] --\n   99    if (xoffcell != null)\n  100        xoffset = Double.parseDouble(xoffcell.getValue());\n  101\n  102    if (xoffcell != null)\n  103        yoffset = Double.parseDouble(yoffcell.getValue());\n`-----\n\nThe fix is trivial, line 102 should check yoffcell for being null.\n\n[1] https://apache.googlesource.com/poi/+/refs/heads/trunk/src/ooxml/java/org/apache/poi/xdgf/usermodel/XDGFPage.java#102"}, {"count": 1, "tags": [], "bug_id": 61584, "attachment_id": null, "text": "Can you provide a sample document that we can use to verify the fix?", "id": 201319, "time": "2017-10-06T11:51:54Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2017-10-06T11:51:54Z", "is_private": false}, {"count": 2, "tags": [], "text": "I am afraid I can't, as the document in question originated with a customer and I don't have a Visio version capable of generating .vsdx.\n\nWhile I can understand the question of reproducability and verification, could an exception be made here, as this specific bug should be trivial and obvious enough to be handled?\n\nIf it helps, I added the fix to my copy and can now import the document without issue.", "attachment_id": null, "bug_id": 61584, "id": 201400, "time": "2017-10-11T08:14:29Z", "creator": "marko@friedemann.email", "creation_time": "2017-10-11T08:14:29Z", "is_private": false}, {"count": 3, "tags": [], "creator": "dustin@virtualroadside.com", "attachment_id": null, "id": 201477, "time": "2017-10-16T01:36:16Z", "bug_id": 61584, "creation_time": "2017-10-16T01:36:16Z", "is_private": false, "text": "I no longer have Visio installed with, but you're right that this is obviously a typo. Pushed fix @ 1812240."}, {"count": 4, "tags": [], "text": "No longer have Visio installed either*", "is_private": false, "bug_id": 61584, "id": 201478, "time": "2017-10-16T01:37:50Z", "creator": "dustin@virtualroadside.com", "creation_time": "2017-10-16T01:37:50Z", "attachment_id": null}]