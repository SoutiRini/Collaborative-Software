[{"count": 0, "tags": [], "bug_id": 15852, "attachment_id": null, "text": "looks like a possible RFC 2616 MUST violation\n\nsee attached trace for details and ways to reproduce\n\ntest case IDs in the trace link to human-oriented test case description and RFC quotes, if available", "id": 28948, "time": "2003-01-07T19:07:49Z", "creator": "coad@measurement-factory.com", "creation_time": "2003-01-07T19:07:49Z", "is_private": false}, {"count": 1, "tags": [], "creator": "coad@measurement-factory.com", "text": "Created attachment 4349\ntest case trace", "id": 28949, "time": "2003-01-07T19:09:21Z", "bug_id": 15852, "creation_time": "2003-01-07T19:09:21Z", "is_private": false, "attachment_id": 4349}, {"count": 2, "tags": [], "creator": "rsushma@novell.com", "text": "Created attachment 7115\nAdded the check for age > 24 hours, to print heuristic expiration warning.", "id": 40042, "time": "2003-07-07T08:35:37Z", "bug_id": 15852, "creation_time": "2003-07-07T08:35:37Z", "is_private": false, "attachment_id": 7115}, {"count": 3, "tags": [], "creator": "rsushma@novell.com", "text": "Created attachment 7116\nComments related to the patch.", "id": 40048, "time": "2003-07-07T09:16:12Z", "bug_id": 15852, "creation_time": "2003-07-07T09:16:12Z", "is_private": false, "attachment_id": 7116}, {"count": 4, "tags": [], "bug_id": 15852, "attachment_id": 7127, "is_private": false, "id": 40093, "time": "2003-07-07T20:02:03Z", "creator": "coad@measurement-factory.com", "creation_time": "2003-07-07T20:02:03Z", "text": "Created attachment 7127\nsame proposed changes, now in unified diff format"}, {"count": 5, "attachment_id": null, "bug_id": 15852, "is_private": false, "id": 40094, "time": "2003-07-07T20:04:49Z", "creator": "coad@measurement-factory.com", "creation_time": "2003-07-07T20:04:49Z", "tags": [], "text": "The proposed changes show no effect on the \ntest case outcome for 2.0.46. The corresponding test\ncase trace will be attached.\n\nNote that Apache seems to think that the age of\nthe entity is zero rather than correct\n24 hours. Apache cache might be ignoring the\noriginal Age response header in its calculations\nof entity age.\n"}, {"count": 6, "attachment_id": 7130, "bug_id": 15852, "is_private": false, "id": 40095, "time": "2003-07-07T20:06:04Z", "creator": "coad@measurement-factory.com", "creation_time": "2003-07-07T20:06:04Z", "tags": [], "text": "Created attachment 7130\ntest case trace, against patched 2.0.46"}, {"count": 7, "tags": [], "creator": "rsushma@novell.com", "text": "Created attachment 7152\nFix for adding warning 113", "id": 40150, "time": "2003-07-08T06:47:52Z", "bug_id": 15852, "creation_time": "2003-07-08T06:47:52Z", "is_private": false, "attachment_id": 7152}, {"count": 8, "attachment_id": null, "bug_id": 15852, "is_private": false, "id": 40151, "time": "2003-07-08T06:50:38Z", "creator": "rsushma@novell.com", "creation_time": "2003-07-08T06:50:38Z", "tags": [], "text": "Attached the patch for printing the 113 warning (Attachment ID 7152).\n\nWith this fix, if the origin server response \nhas the Age value greater than 24 hours, 113 warning \nwill be added to the response header, and the Age\nwill have the value computed by mod_cache.\n\nAbout the problem, Age of the entity becoming zero,\nIn the test case ID 4349 the cached response header\nis having TWO age directives, Age: 86403 and Age: 0.\nIs this the correct behavior?\n\n"}, {"count": 9, "tags": [], "creator": "rederpj@remulak.net", "text": "According to RFC 13.2.3 this is incorrect. There should be at most a *single*\nAge header present.\n\n13.2.3\n                                     ... When a response is\n   generated from a cache entry, the cache MUST include a single Age\n   header field in the response with a value equal to the cache entry's\n   current_age.", "id": 40168, "time": "2003-07-08T14:09:32Z", "bug_id": 15852, "creation_time": "2003-07-08T14:09:32Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 15852, "attachment_id": null, "text": "You are correct. The RFC requirements you quoted, however, might\nlead someone to believe that the cache must _add_ an Age header,\nin addition to the one(s) that are already present. The format\nof the Age header prohibits that:\n\n    Age = \"Age\" \":\" age-value\n    age-value = delta-seconds\n\nTo allow for multiple age values, the header would have to be\ndefined using a #list expression.\n\nNote that the latest test case (trace #7130) does not show \nApache generating multiple Age headers so perhaps that bug got\nfixed.\n", "id": 40193, "time": "2003-07-08T17:14:32Z", "creator": "coad@measurement-factory.com", "creation_time": "2003-07-08T17:14:32Z", "is_private": false}, {"count": 11, "tags": [], "bug_id": 15852, "is_private": false, "text": "Created attachment 7172\nunified diff version of attachment 7152", "id": 40215, "time": "2003-07-08T20:39:59Z", "creator": "coad@measurement-factory.com", "creation_time": "2003-07-08T20:39:59Z", "attachment_id": 7172}, {"count": 12, "tags": [], "bug_id": 15852, "is_private": false, "text": "Created attachment 7173\nimmediate hit case trace, 2.0.46 patched with attachment 7172 (success)", "id": 40216, "time": "2003-07-08T20:53:28Z", "creator": "coad@measurement-factory.com", "creation_time": "2003-07-08T20:53:28Z", "attachment_id": 7173}, {"count": 13, "attachment_id": 7174, "bug_id": 15852, "is_private": false, "id": 40217, "time": "2003-07-08T20:55:03Z", "creator": "coad@measurement-factory.com", "creation_time": "2003-07-08T20:55:03Z", "tags": [], "text": "Created attachment 7174\ndelayed hit case trace, 2.0.46 patched with attachment 7172 (violation)"}, {"count": 14, "attachment_id": null, "bug_id": 15852, "is_private": false, "id": 40220, "time": "2003-07-08T21:00:07Z", "creator": "coad@measurement-factory.com", "creation_time": "2003-07-08T21:00:07Z", "tags": [], "text": "The patch in attachment 7172 brings partial success: Apache now passes\na simple case when cached object is revisited immediately (attachment 7173).\nApache still violates the case when the object ages in the cache; that is,\nwhen the object was less than 24 hours old when it was cached, but\nbecame more than 24 hours old in the cache (attachment 7174).\n\nPerhaps you are using the cached age as opposed to the computed/actual\nage at the time of request? Or the age calculation is broken.\n\nPlease note that only attachment 7172 patch was applied. \nWhen submitting patches, please generate unified diffs if at\nall possible."}, {"count": 15, "tags": [], "creator": "rsushma@novell.com", "text": "Created attachment 7202\nPatch for printing 113 warning, when the origin server sends the aged object or the object gets aged in the cache.", "id": 40312, "time": "2003-07-10T07:44:51Z", "bug_id": 15852, "creation_time": "2003-07-10T07:44:51Z", "is_private": false, "attachment_id": 7202}, {"count": 16, "attachment_id": null, "bug_id": 15852, "is_private": false, "id": 41102, "time": "2003-07-21T20:14:49Z", "creator": "coad@measurement-factory.com", "creation_time": "2003-07-21T20:14:49Z", "tags": [], "text": "With the patch in attachment 7202, Apache passes\nall test cases in this test clause.\n"}, {"count": 17, "tags": [], "bug_id": 15852, "attachment_id": 7434, "is_private": false, "id": 41107, "time": "2003-07-21T22:12:58Z", "creator": "rederpj@remulak.net", "creation_time": "2003-07-21T22:12:58Z", "text": "Created attachment 7434\nAdjusted version of attachement 7202."}, {"count": 18, "tags": [], "creator": "rederpj@remulak.net", "text": "I have attached a slightly altered version of attachement 7202.\n\nIn the existing util_script code, any headers that do not specifically have\ncases in the switch should get added to the err_headers_out table by default.\nHeaders that need to be passed on, regardless of request processing outcome, are\nsupposed to be added to err_headers_out. Attachement 7202 essentially moved the\nExpires and Age headers from the err_headers_out over to the headers_out table.\nThis is not correct.\n\nThe correct action is to look in both places for the header and update it in the\nlocation that it was found. You will find that the ap_cache_check_freshness\nfunction in cache_util.c now checks for the Age header in both locations. My\nattached version of the patch (7434) checks both locations for the Expires\nheader. The code should also add the warning to the existing Warning header\n(wherever it finds it).\n\nThe 7202 patch also checked if ((age + age_c) > 86400)). This is incorrect\nbecause \"age\" is the corrected age, which is based on \"age_c\". Adding the two\nbasically doubles the age. It should simply be (age > 86400).\n\nThe final difference in the two versions of the patch is that RFC 2616 13.2.4\nindicates that the 113 warning should be added \"if such warning has not already\nbeen added.\" My altered patch checks if 113 is there before adding it.\n\nCould you folks at Measurement-Factory please verify that the attached patch\n(7434) works for you. If so, this will be the version I commit.\n\nThanks for your work Sushma Rai and Co-Advisor.", "id": 41110, "time": "2003-07-21T22:32:48Z", "bug_id": 15852, "creation_time": "2003-07-21T22:32:48Z", "is_private": false, "attachment_id": null}, {"count": 19, "tags": [], "creator": "coad@measurement-factory.com", "text": "Created attachment 7435\ndelayed hit case trace, 2.0.46 patched with attachment 7434 (violation)", "id": 41116, "time": "2003-07-21T23:00:26Z", "bug_id": 15852, "creation_time": "2003-07-21T23:00:26Z", "is_private": false, "attachment_id": 7435}, {"count": 20, "tags": [], "creator": "coad@measurement-factory.com", "text": "With the patch in attachment 7434, Apache violates\nboth test cases in this test clause. I've attached\nthe \"6 second delay\" case trace. Note that Apache\nis returning two Age headers now.\n\nThe patch was applied to virgin 2.0.46. Are we doing\nsomething wrong when testing this patch?\n\n", "id": 41117, "time": "2003-07-21T23:04:10Z", "bug_id": 15852, "creation_time": "2003-07-21T23:04:10Z", "is_private": false, "attachment_id": null}, {"count": 21, "attachment_id": null, "bug_id": 15852, "is_private": false, "id": 41174, "time": "2003-07-22T17:52:46Z", "creator": "rederpj@remulak.net", "creation_time": "2003-07-22T17:52:46Z", "tags": [], "text": "Sorry, I do all my testing using 2.1-dev. That might explain some of the\ndifference. Other differences might relate to the cache method used. I'm betting\nyou are using mod_disk_cache? I usually use mod_mem_cache. I'm working on\ntracking down the differences between 2.0 and 2.1-dev and between mod_disk_cache\nand mod_mem_cache. They should both work the same, but I know that\nmod_disk_cache has more problems than mod_mem_cache."}, {"count": 22, "tags": [], "bug_id": 15852, "attachment_id": null, "is_private": false, "id": 42826, "time": "2003-08-15T21:18:04Z", "creator": "coad@measurement-factory.com", "creation_time": "2003-08-15T21:18:04Z", "text": "Yes, we use the disk cache:\n./configure --enable-proxy --enable-cache --enable-disk-cache\n\nWe had been testing using 2.1-dev as well, but were \nforced to downgrade to 2.0 because most of the patches\ndevelopers want us to test were against 2.0. If possible,\nwe would prefer to wait for a version of your patch that\nworks with 2.0.\n\nWe can test 2.0 with memory cache if that helps.\n"}, {"count": 23, "tags": [], "bug_id": 15852, "is_private": false, "id": 47800, "attachment_id": null, "creator": "trawick@apache.org", "creation_time": "2003-11-21T17:13:23Z", "time": "2003-11-21T17:13:23Z", "text": "I'm going through the bug db to make sure patches are findable.  Please see \nhttp://httpd.apache.org/dev/patches.html\n"}, {"count": 24, "tags": [], "bug_id": 15852, "attachment_id": null, "text": "This looks like it has been resolved in the current releases of httpd mod_cache.\n\nThanks1", "id": 66893, "time": "2004-11-15T01:19:10Z", "creator": "jerenkrantz@apache.org", "creation_time": "2004-11-15T01:19:10Z", "is_private": false}]