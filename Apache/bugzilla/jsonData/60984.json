[{"count": 0, "attachment_id": null, "bug_id": 60984, "is_private": false, "id": 198281, "time": "2017-04-13T12:59:42Z", "creator": "e.aivaloglou@tudelft.nl", "creation_time": "2017-04-13T12:59:42Z", "tags": [], "text": "When parsing 2-argument formula _xll.HEAT($B3,$C3), FormulaParser creates an org.apache.poi.ss.formula.ptg.FuncVarPtg [#external# nArgs=3] token with _numberOfArgs = 3 and 3 children, the first of which contains the function name (a org.apache.poi.ss.formula.ptg.NameXPxg [sheet=null ! name=_xll.HEAT] token).\n\n_xll.HEAT is an Excel add-in function, but he same applies to UDF functions, eg for formula myUDF(23, F4).\n\nIs this intentional? The parse tree structure does not seem correct, because it is inconsistent with the case of build-in Excel functions, whose arguments in the parse tree only include actual arguments and not the function name."}, {"count": 1, "tags": [], "creator": "onealj@apache.org", "is_private": false, "id": 199255, "creation_time": "2017-06-16T20:46:03Z", "time": "2017-06-16T20:46:03Z", "bug_id": 60984, "text": "Yes, external functions include the function name as the first token. This is correct.\nAdding are essentially a collection of UDFs. I believe this is how functions in the AnalysisToolPak are parsed into tokens.", "attachment_id": null}]