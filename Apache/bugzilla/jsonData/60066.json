[{"count": 0, "tags": [], "text": "", "is_private": false, "bug_id": 60066, "id": 193405, "time": "2016-08-30T11:34:29Z", "creator": "apache_bugzilla@zwiers.ca", "creation_time": "2016-08-30T11:34:29Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "apache_bugzilla@zwiers.ca", "attachment_id": 34184, "is_private": false, "id": 193407, "time": "2016-08-30T11:42:42Z", "bug_id": 60066, "creation_time": "2016-08-30T11:42:42Z", "text": "Created attachment 34184\nQuick hack of AbstractJDBCTestElement to support CLOB OUT\n\nIntended for hints/guidance only."}, {"count": 2, "attachment_id": null, "bug_id": 60066, "is_private": false, "id": 193408, "time": "2016-08-30T11:43:58Z", "creator": "apache_bugzilla@zwiers.ca", "creation_time": "2016-08-30T11:43:58Z", "tags": [], "text": "A discussion on the mailing list (http://jmeter.512774.n5.nabble.com/CLOB-Supported-in-JDBC-Sampler-tt5724712.html) highlighted that a CLOB OUT / INOUT parameter does not have it's content returned by the JDBC Sampler.\n\nThe cause is that AbstractJDBCTestElement.resultSetsToString() loops through the declared variables and (if not an instance of java.sql.ResultSet) simply calls o.toString().  This is not sufficient to get content from a CLOB (at least not from an Oracle DB).\n\nThe mailing list item points out that there may be nuances to different DB / JDBC Driver implementations around CLOB.\n\nA patch is provided and attached here with the caveat that it was simply \"good enough\" to get the data I was looking for.  There is no attempt to validate / support IN CLOB parameters, integrate code style with JMeter, validate that all Java features are provided in the JMeter supported version of Java, etc. and and there was very little testing / validation of the code.\n\nProvided simply as a hint to anyone stumbling across this looking for a hint or quick implementation."}, {"count": 3, "tags": [], "text": "Do you think it would be helpful, to use the resultSetHandler variable to decide, whether we want the clob as an object, or a string representation? \n\nAnd would it be a good idea, to specify an upper limit for the string representation that is lower than Integer.MAX_VALUE?", "is_private": false, "bug_id": 60066, "id": 193526, "time": "2016-09-06T19:24:53Z", "creator": "felix.schumacher@internetallee.de", "creation_time": "2016-09-06T19:24:53Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "apache_bugzilla@zwiers.ca", "attachment_id": null, "is_private": false, "id": 193544, "time": "2016-09-07T12:02:42Z", "bug_id": 60066, "creation_time": "2016-09-07T12:02:42Z", "text": "Not sure if those questions were for me or for more general discussion... but I'll take a stab.\n\nre/ resultSetHandler I'll leave it to you.  I'm generally a user of JMeter and this is only my second time looking into the code in any detail. I'm sure there are preferences and/or conventions that I'm not aware or and therefore don't feel qualified to comment here.\n\nre/ Integer.MAX_VALUE   That's only used if the CLOB itself provides a length (type long) which is larger than the Integer.MAX_VALUE which the CharBuffer accepts.  Otherwise, the upper limit is the declared .length() of the CLOB.  Maybe that's what you're asking... after you get to 2GB of text you've probably got other issues.  A lower threshold would likely be advisable.  Either way, a warning if data is truncated.\n\nAs other comments indicate, the implementation was designed to get only what I need and to do it quickly.  The code is likely problematic in other areas.  For example, the value of totalRead is incorrect and doesn't get propagated.  Provided for inspiration rather than as a claim of solid implementation."}, {"count": 5, "tags": [], "text": "Created attachment 34229\nHandle BLOBs and CLOBs\n\nAnother patch for converting CLOBs and CLOBs.\n\nThis one limits the results stored in the sampler to the value of jdbcsampler.max_retain_result_size (which defaults to 64k).\n\nCould you try it out?", "is_private": false, "bug_id": 60066, "id": 193619, "time": "2016-09-10T19:23:40Z", "creator": "felix.schumacher@internetallee.de", "creation_time": "2016-09-10T19:23:40Z", "attachment_id": 34229}, {"count": 6, "tags": [], "creator": "felix.schumacher@internetallee.de", "attachment_id": null, "id": 193853, "time": "2016-09-20T19:20:35Z", "bug_id": 60066, "creation_time": "2016-09-20T19:20:35Z", "is_private": false, "text": "Date: Tue Sep 20 18:55:08 2016\nNew Revision: 1761614\n\nURL: http://svn.apache.org/viewvc?rev=1761614&view=rev\nLog:\nHandle CLOBs and BLOBs and limit them if necessary when storing them in result sampler.\n\nBugzilla Id: 60085\n\nModified:\n    jmeter/trunk/bin/jmeter.properties\n    jmeter/trunk/src/protocol/jdbc/org/apache/jmeter/protocol/jdbc/AbstractJDBCTestElement.java\n    jmeter/trunk/xdocs/changes.xml\n    jmeter/trunk/xdocs/usermanual/component_reference.xml\n    jmeter/trunk/xdocs/usermanual/properties_reference.xml\n\nDate: Tue Sep 20 19:19:52 2016\nNew Revision: 1761624\n\nURL: http://svn.apache.org/viewvc?rev=1761624&view=rev\nLog:\nFollowup to r1761614. The correct bugzilla id is 60066.\n\nModified:\n    jmeter/trunk/xdocs/changes.xml"}]