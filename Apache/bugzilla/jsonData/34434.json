[{"count": 0, "tags": [], "bug_id": 34434, "attachment_id": null, "id": 73610, "time": "2005-04-13T13:14:36Z", "creator": "skn@ppi.de", "creation_time": "2005-04-13T13:14:36Z", "is_private": false, "text": "We use the tapestry-framework for our webapplications and get this exception\noften during a running session.\nI was able to track this down to the method realWriteBytes in the module\norg.apache.coyote.http11.InternalOutputBuffer (line 747).\nThe code here seems to be unstable:\n\n    /**\n     * Callback to write data from the buffer.\n     */\n    public void realWriteBytes(byte cbuf[], int off, int len)\n        throws IOException {\n        if (len > 0) {\n            outputStream.write(cbuf, off, len);\n        }\n    }\n\nShould be:\n\n    /**\n     * Callback to write data from the buffer.\n     */\n    public void realWriteBytes(byte cbuf[], int off, int len)\n        throws IOException {\n        if (len > 0 && outputstream != null) {\n            outputStream.write(cbuf, off, len);\n        }\n    }\n\nor somehow the exception should be handled in the caller of this.\nHere is my stacktrace:\n2078 AbstractEngine [WARN] Exception during post-request cleanup.\nClientAbortException:  java.net.SocketException: Connection reset by peer:\nsocket write error\n\tat org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:327)\n\tat org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:293)\n\tat\norg.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:85)\n\tat\norg.apache.tapestry.request.ResponseOutputStream.forceFlush(ResponseOutputStream.java:149)\n\tat org.apache.tapestry.engine.AbstractEngine.service(AbstractEngine.java:900)\n\tat org.apache.tapestry.ApplicationServlet.doService(ApplicationServlet.java:177)\n\tat de.ppi.tapestry.webtech.Controller.doService(Controller.java:76)\n\tat org.apache.tapestry.ApplicationServlet.doGet(ApplicationServlet.java:141)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:689)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n\tat\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n\tat\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n\tat de.ppi.tapestry.webtech.Redirector.doChain(Redirector.java:1008)\n\tat de.ppi.tapestry.webtech.Redirector.doFilter(Redirector.java:976)\n\tat\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:202)\n\tat\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n\tat\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:214)\n\tat\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\n\tat org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:526)\n\tat\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)\n\tat org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:825)\n\tat\norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:738)\n\tat\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:526)\n\tat\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)\n\tat\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n\tat java.lang.Thread.run(Thread.java:534)\n\t..."}, {"count": 1, "tags": [], "bug_id": 34434, "text": "Please post on tomcat-user instead.", "id": 73611, "time": "2005-04-13T13:18:16Z", "creator": "remm@apache.org", "creation_time": "2005-04-13T13:18:16Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 34434, "attachment_id": null, "id": 73612, "time": "2005-04-13T13:33:23Z", "creator": "skn@ppi.de", "creation_time": "2005-04-13T13:33:23Z", "is_private": false, "text": "(In reply to comment #1)\n> Please post on tomcat-user instead.\n\nHello, for what is this bugtracking-system, when one is not allowed to create a\nnew issue. just putting this to RESOLVED seems to be a little bit arrogant after\n10 seconds, sorry :("}, {"count": 3, "tags": [], "bug_id": 34434, "attachment_id": null, "text": "This is a bug tracking system, not a support system for asking questions about\nwell known issues.\n\nIt might be worth you reading the FAQ entries on bugs:\nhttp://jakarta.apache.org/tomcat/faq/bugs.html", "id": 73633, "time": "2005-04-13T21:10:34Z", "creator": "markt@apache.org", "creation_time": "2005-04-13T21:10:34Z", "is_private": false}]