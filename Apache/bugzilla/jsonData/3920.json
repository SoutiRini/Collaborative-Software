[{"count": 0, "tags": [], "creator": "polverini@explo-it.com", "attachment_id": null, "id": 6275, "time": "2001-10-02T08:54:27Z", "bug_id": 3920, "creation_time": "2001-10-02T08:54:27Z", "is_private": false, "text": "Hello,\nI'm developing a servlet implementing the HttpSessionBindingListener.\nThe method valueBound(HttpSessionBindingEvent e) is correctly called when a \nsession is created but valueUnbound(HttpSessionBindingEvent e) is not.\nI have been able to verify that the session expires but the bindind event is \nnot thrown.\nThe servlet runs fine with tomcat 3.2.3 but I'm forced to use tomcat 3.3 \nbecause I need more than 100 concurrent connections.\nIf you can help me on configuring tomcat 3.2.3 for more concurrent connections \nI would be very glad.\n\nThanks,\nAlex"}, {"count": 1, "tags": [], "bug_id": 3920, "text": "A simple test webapp shows this working for me.  valueUnbound is called for\nsession expiration and session.invalidate().  If you set debug=\"1\" on the\nServlet22Interceptor you should see log messages that include the session\nrelated handling for calling valueUnbound.\n\nIf you continue to have problems, please attach a simple web application\nthat demonstrates the problem.  At this point, I can't guess what you may\nbe doing different to determine if the problem is in Tomcat or your webapp.\n", "id": 6286, "time": "2001-10-02T12:14:30Z", "creator": "Larry.Isaacs@sas.com", "creation_time": "2001-10-02T12:14:30Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 3920, "is_private": false, "count": 2, "id": 6288, "time": "2001-10-02T13:39:57Z", "creator": "polverini@explo-it.com", "creation_time": "2001-10-02T13:39:57Z", "text": "Ok,\nI traced the bug: the valueUnbound is correctly called but I get an Exception \nwhen I try to get the session identifier with the instruction:\n    String sessionId = e.getSession().getId();\nthat previously (tomcat 3.2.3) worked.\nI think this is a bug, otherwise I'll appreciate a workaround: I really need \nthe sessionId for the correct execution.\n\nThanks very much for the help,\nAlex\n\nP.S.: This is the stack trace:\nServlet22Interceptor: Exception during unbound - \njava.lang.IllegalStateException: getAttributeNames: Session already invalidated\n        at \norg.apache.tomcat.facade.HttpSessionFacade.checkValid(HttpSessionFacade.java:307)\n        at \norg.apache.tomcat.facade.HttpSessionFacade.getId(HttpSessionFacade.java:116)\n        at com.explo_it.iene.IeneServlet.valueUnbound(IeneServlet.java:515)\n        at \norg.apache.tomcat.facade.Servlet22Interceptor.sessionState(Servlet22Interceptor.java:194)\n        at \norg.apache.tomcat.core.ServerSession.setState(ServerSession.java:184)\n        at \norg.apache.tomcat.modules.session.SessionExpirer$SessionExpireCallback.expired(SessionExpirer.java:166)\n        at org.apache.tomcat.util.threads.Expirer.runIt(Expirer.java:181)\n        at org.apache.tomcat.util.threads.Reaper.run(Reaper.java:144)\n"}, {"count": 3, "tags": [], "bug_id": 3920, "attachment_id": null, "id": 6346, "time": "2001-10-03T19:24:57Z", "creator": "william.barker@wilshire.com", "creation_time": "2001-10-03T19:24:57Z", "is_private": false, "text": "This is now fixed in the latest CVS.\n\nNote that the session is still \"invalid\", so get/setAttribute will still fail.  \nHowever getId will work."}]