[{"attachment_id": null, "tags": [], "creator": "kclaver@yahoo.com", "text": "Hi, I've seen several posts related to this bug, but most if not all are marked resolved or invalid.  Unfortunately, I am still seeing the issue.  I've been able to narrow it down to tomcat on Linux.\n\nIssue: Tomcat does not redirect to the HMAExceptionHandlerServlet servlet I have configured in the application specific web.xml when running on Linux\n\nI've tried searching all of the lists for an answer to this question.  I've seen several postings by people having the same issue, but never a solution.\n\nMy Tomcat version:\n\nApache Tomcat 5.5.27 (I've also tried 5.5.33 and 6.0.32)\n\nrunning on:\n\nFedora 2.6.27.5-117.fc10.x86_64\n\nwith JDK version:\n\n1.6.0_25\n\nA few things I would like to note:\n\n1.  This is a vanilla Tomcat 5.5.27 install.\n\n2.  When I copy the web application directly from the Linux Tomcat install to a Vanilla Tomcat install on Windows 7, the 500 redirect to my custom error servlet works.\n\n3.  When I invoke the Java HMAExceptionHandlerServlet configured to be used in the error-page block in the application specific web.xml directly from the URL in the browser, it works.  It also works if I invoke it using the /error/ExceptionHandler servlet mapping url pattern.\n\n4.  If I change the error code to be 404, Tomcat correctly redirects to the custom error page.\n\n5.  Tomcat 5.5.33 does correctly redirect to the error-page when running on a Windows 7 machine.  The only time I have an issue is on the Linux configuration above.\n\n6.  I see the error code logged in the access log.\n\n192.168.xxx.xxx - - [02/Jun/2011:13:53:14 -0600] \"POST /HMAApp/faces/main/TaskSearchTab.jsp HTTP/1.0\" 500 1000\n\n7.  I see both the com.sun.rave.web.ui.appbase.ApplicationException and the java.lang.NullPointerException in the localhost log (both are configured in the application specific web.xml to redirect to the custom error servlet.\n\nJun 2, 2011 1:53:14 PM org.apache.catalina.core.StandardWrapperValve invoke\nSEVERE: Servlet.service() for servlet Faces Servlet threw exception\ncom.sun.rave.web.ui.appbase.ApplicationException\n        at com.sun.rave.web.ui.appbase.faces.ViewHandlerImpl.cleanup(ViewHandlerImpl.java:559)\n        at com.sun.rave.web.ui.appbase.faces.ViewHandlerImpl.renderView(ViewHandlerImpl.java:276)\n        at com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:107)\n        at com.sun.faces.lifecycle.LifecycleImpl.phase(LifecycleImpl.java:245)\n        at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:137)\n        at javax.faces.webapp.FacesServlet.service(FacesServlet.java:214)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:269)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n        at com.sun.rave.web.ui.util.UploadFilter.doFilter(UploadFilter.java:198)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:215)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:172)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:117)\n        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:581)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:108)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:174)\n        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:879)\n        at org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:665)\n        at org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:528)\n        at org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:81)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:689)\n        at java.lang.Thread.run(Thread.java:662)\nCaused by: java.lang.NullPointerException\n        at hmaapp.utilmanagement.OPProcMain.prerender(OPProcMain.java:2355)\n        at com.sun.rave.web.ui.appbase.faces.ViewHandlerImpl.prerender(ViewHandlerImpl.java:771)\n        at com.sun.rave.web.ui.appbase.faces.ViewHandlerImpl.renderView(ViewHandlerImpl.java:268)\n        ... 22 more\n\nMy application specific web.xml (located in <tomcat \\\ninstall>/webapps/<application>/WEB-INF folder) :\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<web-app version=\"2.4\" xmlns=\"http://java.sun.com/xml/ns/j2ee\" \\\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" \\\nxsi:schemaLocation=\"http://java.sun.com/xml/ns/j2ee \\\nhttp://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd\">     <context-param>\n        <param-name>javax.faces.STATE_SAVING_METHOD</param-name>\n        <param-value>server</param-value>\n    </context-param>\n    <context-param>\n        <param-name>javax.faces.CONFIG_FILES</param-name>\n        <param-value>/WEB-INF/navigation.xml,/WEB-INF/managed-beans.xml</param-value>\n    </context-param>\n    <context-param>\n        <param-name>com.sun.faces.validateXml</param-name>\n        <param-value>true</param-value>\n    </context-param>\n    <context-param>\n        <param-name>com.sun.faces.verifyObjects</param-name>\n        <param-value>false</param-value>\n    </context-param>\n    <filter>\n        <filter-name>UploadFilter</filter-name>\n        <filter-class>com.sun.rave.web.ui.util.UploadFilter</filter-class>\n        <init-param>\n            <description>\n          The maximum allowed upload size in bytes.  If this is set\n          to a negative value, there is no maximum.  The default\n          value is 1000000.\n            </description>\n            <param-name>maxSize</param-name>\n            <param-value>1000000</param-value>\n        </init-param>\n        <init-param>\n            <description>\n          The size (in bytes) of an uploaded file which, if it is\n          exceeded, will cause the file to be written directly to\n          disk instead of stored in memory.  Files smaller than or\n          equal to this size will be stored in memory.  The default\n          value is 4096.\n            </description>\n            <param-name>sizeThreshold</param-name>\n            <param-value>4096</param-value>\n        </init-param>\n    </filter>\n    <filter-mapping>\n        <filter-name>UploadFilter</filter-name>\n        <servlet-name>Faces Servlet</servlet-name>\n    </filter-mapping>\n    <servlet>\n        <servlet-name>Faces Servlet</servlet-name>\n        <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>\n        <load-on-startup>1</load-on-startup>\n    </servlet>\n    <servlet>\n        <servlet-name>ThemeServlet</servlet-name>\n        <servlet-class>com.sun.rave.web.ui.theme.ThemeServlet</servlet-class>\n    </servlet>\n    <servlet>\n        <servlet-name>HMAExceptionHandlerServlet</servlet-name>\n        <servlet-class>hmaapp.common.HMAExceptionHandlerServlet</servlet-class>\n    </servlet>\n    <servlet-mapping>\n        <servlet-name>Faces Servlet</servlet-name>\n        <url-pattern>/faces/*</url-pattern>\n    </servlet-mapping>\n    <servlet-mapping>\n        <servlet-name>HMAExceptionHandlerServlet</servlet-name>\n        <url-pattern>/error/ExceptionHandler</url-pattern>\n    </servlet-mapping>\n    <servlet-mapping>\n        <servlet-name>ThemeServlet</servlet-name>\n        <url-pattern>/theme/*</url-pattern>\n    </servlet-mapping>\n    <servlet-mapping>\n        <servlet-name>InterqualJSServlet</servlet-name>\n        <url-pattern>/InterqualJSServlet</url-pattern>\n    </servlet-mapping>\n    <servlet-mapping>\n        <servlet-name>HMAExceptionHandlerServlet</servlet-name>\n        <url-pattern>/HMAExceptionHandlerServlet</url-pattern>\n    </servlet-mapping>\n    <welcome-file-list>\n        <welcome-file>faces/SignOn.jsp</welcome-file>\n    </welcome-file-list>\n    <error-page>\n        <exception-type>javax.servlet.ServletException</exception-type>\n        <location>/error/ExceptionHandler</location>\n    </error-page>\n    <error-page>\n        <exception-type>java.io.IOException</exception-type>\n        <location>/error/ExceptionHandler</location>\n    </error-page>\n    <error-page>\n        <exception-type>javax.faces.FacesException</exception-type>\n        <location>/error/ExceptionHandler</location>\n    </error-page>\n    <error-page>\n        <exception-type>com.sun.rave.web.ui.appbase.ApplicationException</exception-ty \\\npe>         <location>/error/ExceptionHandler</location>\n    </error-page>\n    <error-page>\n        <error-code>500</error-code>\n        <location>/error/ExceptionHandler</location>\n    </error-page>\n    <error-page>\n        <exception-type>java.lang.NullPointerException</exception-type>\n        <location>/error/ExceptionHandler</location>\n    </error-page>\n    <jsp-config>\n        <jsp-property-group>\n            <url-pattern>*.jspf</url-pattern>\n            <is-xml>true</is-xml>\n        </jsp-property-group>\n    </jsp-config>\n</web-app>\n\nThanks!", "count": 0, "id": 146835, "time": "2011-06-03T15:44:46Z", "bug_id": 51316, "creation_time": "2011-06-03T15:44:46Z", "is_private": false}, {"count": 1, "tags": [], "text": "This works for me, on linux, with the latest 5.5.x.\n\nBefore re-opening this issue, you'll need to provide the simplest possible test case that reproduces it on a clean 5.5.x install using the latest 5.5.x version. Based on the description, just two servlets and a web.xml should be all that are required.\n\nRight now, this looks like an issue in the framework you are using rather than a Tomcat issue.", "attachment_id": null, "id": 146848, "creator": "markt@apache.org", "time": "2011-06-03T21:03:12Z", "bug_id": 51316, "creation_time": "2011-06-03T21:03:12Z", "is_private": false}]