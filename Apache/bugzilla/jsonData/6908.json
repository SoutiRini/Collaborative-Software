[{"count": 0, "tags": [], "bug_id": 6908, "attachment_id": null, "text": "When trying to implement a compiler plugin for the eclipse java compiler\n( to work around the javac memory leaks )\nI came to the conclusion that the setOutputDir of the JavaCompiler is only\ncalled with null as a parameter, this means that I have to deduce the intended\noutput directory myself based on the source parameter of the compile method.\n\nIs the the expected behaviour?", "id": 11500, "time": "2002-03-06T10:17:17Z", "creator": "dylans@xs4all.nl", "creation_time": "2002-03-06T10:17:17Z", "is_private": false}, {"count": 1, "attachment_id": null, "creator": "kin-man.chung@sun.com", "is_private": false, "id": 12520, "time": "2002-03-30T00:08:37Z", "bug_id": 6908, "creation_time": "2002-03-30T00:08:37Z", "tags": [], "text": "That is not the expected behavior, and should not happen.\n\nHow did you arrive at the conclusion that JavaCompiler.setOutputDir is called\nwith only null parameter?  It wouldn't have worked for even the simplest jsp\npage if it were so.  If you care to search the sources for setOutputDir, you'll\nsee that it is called in compiler/Compiler.java, and the logic that computes the\noutdir is in servlet/JspServlet.java."}, {"count": 2, "attachment_id": 1462, "creator": "dylans@xs4all.nl", "is_private": false, "id": 12661, "time": "2002-04-02T10:13:32Z", "bug_id": 6908, "creation_time": "2002-04-02T10:13:32Z", "tags": [], "text": "Created attachment 1462\ncompiler wrapper test-app"}, {"count": 3, "tags": [], "bug_id": 6908, "attachment_id": null, "text": "I have retested this bug and I am still seeing calls to setOutputDir\nwith a null parameter. I have attached a simple web-app that demonstrates\nthe problem. It wraps the SunJaveCompiler Class in the DummyCompiler\n(in WEB-INF\\src\\nl\\secorp\\jsp\\compiler\\DummyCompiler.java)\n\nThe following is printed to stdout  if http://localhost:8080/compiler-\ntest/index.jsp is requested:\n\n====== START STDOUT ===========\nsetEncoding(UTF8)\nsetClasspath(c:\\program files\\java\\j2re1.4.0\\lib\\rt.jar;c:\\jakarta-tomcat-4.0\n\\bin\\bootstrap.jar;C:/jakarta-tomcat-4.0/webapps/compiler-test/WEB-\nINF/classes;C:/jakarta-tomcat-4.0/webapps/compiler-test/WEB-\nINF/classes;C:/jakarta-tomcat-4.0/classes/;C:/jakarta-tomcat-4.0/lib/jasper-\ncompiler.jar;C:/jakarta-tomcat-4.0/lib/jasper-runtime.jar;C:/jakarta-tomcat-\n4.0/lib/naming-factory.jar;C:/jakarta-tomcat-\n4.0/lib/nl.secorp.guid.jar;C:/jakarta-tomcat-\n4.0/lib/nl.secorp.jsp.jar;C:/jakarta-tomcat-\n4.0/lib/org.eclipse.java.compiler.jar;C:/jakarta-tomcat-\n4.0/common/classes/;C:/jakarta-tomcat-4.0/common/lib/mm.mysql-2.0.11-\nbin.jar;C:/jakarta-tomcat-4.0/common/lib/naming-common.jar;C:/jakarta-tomcat-\n4.0/common/lib/naming-resources.jar;C:/jakarta-tomcat-\n4.0/common/lib/servlet.jar;C:/jakarta-tomcat-4.0/common/lib/tools.jar)\nsetOutputDir(null)\nsetMsgOutput()\nsetClassDebugInfo(false)\ncompile(C:\\jakarta-tomcat-4.0\\work\\localhost\\compiler-test\\\\index$jsp.java)\n====== END STDOUT ===========\n", "id": 12662, "time": "2002-04-02T10:16:57Z", "creator": "dylans@xs4all.nl", "creation_time": "2002-04-02T10:16:57Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 6908, "text": "I have a feeling that the command line jsp compiler works OK\nsince it uses CommandLineContext\n\nCommandLineContext.getJavacOutputDir returns scratchdir\nJspEngineContext.getJavacOutputDir returns null!\n\n", "id": 12664, "time": "2002-04-02T10:31:41Z", "creator": "dylans@xs4all.nl", "creation_time": "2002-04-02T10:31:41Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 6908, "is_private": false, "text": "When I executed the test page index.jsp, and got the expected reponse\n\n    The lines below are just some jsp code to make sure this page compiles 1 \n\nand DummyCompiler is never executed.\n\nsetOutputDir has been working correctly, for both SunJavaCompiler and\nJikesJavaCompiler, and if it doesn't work for you, you'll just need to debug\nyour code.  Sorry.  If you can find places in the source that's wrong, please\nsubmit a patch, but I examined the code again and couldn't find anything that's\nobviously wrong.", "id": 14364, "time": "2002-04-22T20:50:48Z", "creator": "kin-man.chung@sun.com", "creation_time": "2002-04-22T20:50:48Z", "attachment_id": null}]