[{"count": 0, "tags": [], "bug_id": 29723, "attachment_id": null, "id": 59681, "time": "2004-06-21T17:03:16Z", "creator": "deepak.daglur@thehartford.com", "creation_time": "2004-06-21T17:03:16Z", "is_private": false, "text": "The record task is not generating the output files relative to the basedir\nfolder of a build script, but the loadfile task seems to be loading files\nrelative to the basedir???\n\nBackground;\nI have an outer task wherein I record a log file (jspcompile.log) using the\nrecord task (start and stop). Subsequent to the stop task, I attempt to read in\njspcompile.log using the loadfile task and I get a java.io.FileNotFoundException.\n\nReason;\nAssume that you have the following folder structure.\nRoot\n |----build\n        |----antxml\n        |----scripts\nI invoked the script file from the \"scripts\" folder. I set the basedir to Root\npassing in -Dbasedir=\"..\\..\".\nThe record task created jspcompile.log file in the scripts folder and loadfile\nlooks for jspcompile.log file in the Root folder.\n\nActual build task;\n\n    <target name=\"jspcompile\" if=\"module.name\">\n        <record name=\"jspcompile.log\" action=\"start\" loglevel=\"verbose\"/>\n        <wljspc src=\"${webstaging}\\${module.name}\"\n                dest=\"${classesdir}\\webcompile\\${module.name}\"\n                package=\"jsp\">\n            <classpath refid=\"compile.class.path\"/>\n        </wljspc>\n        <record name=\"jspcompile.log\" action=\"stop\"/>\n\n        <loadfile property=\"jspcompile.output\"\n                  srcfile=\"jspcompile.log\" failonerror=\"false\"/>\n        <condition property=\"jspcompile.failure\">\n            <or>\n                <contains string=\"${build.output}\"\n                          substring=\"BUILD FAILED\" />\n                <contains string=\"${build.output}\"\n                          substring=\" error\"/>\n            </or>\n        </condition>\n\n        <fail message=\"Jsp compile failed. See jspcompile.log for more info\"\n              if=\"jspcompile.failure\"/>\n    </target>"}, {"attachment_id": null, "tags": [], "creator": "bodewig@apache.org", "text": "> The record task is not generating the output files relative to the basedir\n> folder of a build script, but the loadfile task seems to be loading files\n> relative to the basedir???\n\nBoth assertions are correct.\n\n<record>'s behavior is wrong - it always uses the current working directory to base\nrelative file names on.  Unfortunately we can't fix it without breaking backwards\ncompatibility.  The task is with us since Ant 1.2 and it has always been wrong.\n\n<lodafile> behaves as all Ant tasks should do.\n\nWorkaround:  Use an absolute path or ${basedir}/some/path as value for the name\nattribute in <record>.", "count": 1, "id": 59971, "time": "2004-06-28T08:05:06Z", "bug_id": 29723, "creation_time": "2004-06-28T08:05:06Z", "is_private": false}]