[{"count": 0, "tags": [], "bug_id": 44371, "attachment_id": null, "id": 113504, "time": "2008-02-06T22:31:21Z", "creator": "josh@apache.org", "creation_time": "2008-02-06T22:31:21Z", "is_private": false, "text": "Filled out implementation for Offset.java.\n\nSome difficulties were encountered performing this work, because the OFFSET \nfunction requires access to the workbook/sheet which is not part of the \nevaluate() method signature for all functions implemented so far.  This \nrequirement seems to be rare.  A quick browse found one other unimplemented \nfunction (INDIRECT) with the same problem.\n\nI decided to model this requirement with a dedicated interface \n(FreeRefFunction), which has a similar evaluate method but takes two extra \nparameters.  Some rearranging inside HSSFFormulaEvaluator was necessary to \ninvoke FreeRefFunction.evaluate() when needed.  This has left a little \nugliness in HSSFFormulaEvaluator.invokeOperation().  An alternative approach \nmight be to make the OperationEval interface aware of this requirement, but I \nthought the flow on effects might be worse.\n\nA mostly complete implementation of OFFSET() has been added.  The need to \nevaluate area refs on the fly caused some more refactoring within \nHSSFFormulaEvaluator to expose that functionality.\n\nA junit (TestOffset) was added, though this only tests trivial parts of \nOffset.java so far.  More thorough testing can easily be achieved through \nFormulaEvalTestData.xls, but there is a much larger pending change to the same \nfile in patch 44364. \n\nIndirect.java was modified to implement the correct interface.  Javadoc was \nadded, but the method is still empty."}, {"count": 1, "tags": [], "text": "Created attachment 21487\nsvn diff for 9 changed files", "is_private": false, "id": 113505, "creator": "josh@apache.org", "time": "2008-02-06T22:33:17Z", "bug_id": 44371, "creation_time": "2008-02-06T22:33:17Z", "attachment_id": 21487}, {"count": 2, "tags": [], "text": "Created attachment 21488\ntar bz2 of 2 added files", "is_private": false, "id": 113506, "creator": "josh@apache.org", "time": "2008-02-06T22:34:50Z", "bug_id": 44371, "creation_time": "2008-02-06T22:34:50Z", "attachment_id": 21488}, {"attachment_id": null, "tags": [], "bug_id": 44371, "is_private": false, "count": 3, "id": 113955, "time": "2008-02-21T07:08:26Z", "creator": "apache@gagravarr.org", "creation_time": "2008-02-21T07:08:26Z", "text": "Was a little bit of a faff to apply, as didn't include the fix for bug #44410,\nbut that's probably our fault for not applying your patch quick enough...\n\nCommitted to svn trunk"}]