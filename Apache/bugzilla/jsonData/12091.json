[{"count": 0, "tags": [], "text": "The Apache 2 modules in the httpd-ldap sub-project (which should be moved \ninto 'experimental' in my opinion and have standard MSVC++ projects created, \netc -- though I have no vote) crash on Windows 2000 in Apache 2.0.40.\n\nThe issue is use of uninitialized memory in util_ldap_cache_init() [in \nutil_ldap_cache.c].  This routine declares a variable on stack, 'rmm_lock', and \npasses it to apr_rmm_init() without initializing it.  apr_rmm_init() expects \nthis argument to be initialized and causes a later crash on Windows as a result \nof finding random gargly-gook in this structure and interpretting it in such a \nway that does not match the reality of the situation.\n\nMy patch (sorry I'm new at this and don't know how to generate proper patches :-\n(  ) is to no longer declare this variable and pass NULL to apr_rmm_init() in \nits place -- as apr_rmm_init() can take a NULL for this argument.  This seems \nto work fine on Windows and Solaris -- though I can't get this module to load \non AIX (no, I've not yet tried the original code....)\n\nThe line are (in patch pseudo-syntax):\n\nLines 293-297:\n  apr_status_t util_ldap_cache_init(apr_pool_t *pool, apr_size_t reqsize)\n  {\n-     apr_anylock_t rmm_lock;\n\n  #if APR_HAS_SHARED_MEMORY\n\nand lines 305-308:\n      /* This will create a rmm \"handler\" to get into the shared memory area */\n  -    apr_rmm_init(&util_ldap_rmm, &rmm_lock,\n  +    apr_rmm_init(&util_ldap_rmm, NULL,\n              (void *)apr_shm_baseaddr_get(util_ldap_shm), reqsize, pool);\n  #endif\n\nThe only alternative that I see is to add a call to initialize 'rmm_lock', but \nfrom my brief (and possibly completely wrong) scan of the code it would appear \nthat passing null is a more efficient way of accomplishing the same thing.", "is_private": false, "id": 21818, "creator": "jessh@ptc.com", "time": "2002-08-27T17:32:35Z", "bug_id": 12091, "creation_time": "2002-08-27T17:32:35Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 12091, "attachment_id": null, "id": 21918, "time": "2002-08-28T19:18:47Z", "creator": "trawick@apache.org", "creation_time": "2002-08-28T19:18:47Z", "is_private": false, "text": "Your fix has been committed.\n\nThanks for your report and thanks for using Apache!"}]