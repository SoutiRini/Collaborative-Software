[{"count": 0, "tags": [], "text": "The <rpm> task is documented to try rpmbuild first, then rpm, when building.\n\nrpmbuild is indeed installed on this system (openSUSE 11.4):\n\n    $ which rpmbuild\n    /usr/bin/rpmbuild\n\nIn ant 1.8.2, however, it only tries rpm. The result is this error:\n\n      [rpm] -bb: unknown option\n            'rpm' failed with exit code 1\n\nI verified this behavior via strace:\n\n      [rpm] Building the RPM based on the pexp-web.spec file\n[pid 24339] clone(Process 24346 attached\nchild_stack=0, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0xb482ebd8) = 24346\n[pid 24346] execve(\"/home/archie/bin/rpm\", [\"rpm\", \"--define\", \"_topdir /home/archie/svn/ops/pex\"..., \"-bb\", \"--define\", \"_topdir /home/archie/svn/ops/pex\"..., \"--define\", \"svn_revision exported\", \"SPECS/pexp-web.spec\"], [/* 51 vars */]) = -1 ENOENT (No such file or directory)\n[pid 24346] execve(\"/usr/local/bin/rpm\", [\"rpm\", \"--define\", \"_topdir /home/archie/svn/ops/pex\"..., \"-bb\", \"--define\", \"_topdir /home/archie/svn/ops/pex\"..., \"--define\", \"svn_revision exported\", \"SPECS/pexp-web.spec\"], [/* 51 vars */]) = -1 ENOENT (No such file or directory)\n[pid 24346] execve(\"/usr/bin/rpm\", [\"rpm\", \"--define\", \"_topdir /home/archie/svn/ops/pex\"..., \"-bb\", \"--define\", \"_topdir /home/archie/svn/ops/pex\"..., \"--define\", \"svn_revision exported\", \"SPECS/pexp-web.spec\"], [/* 51 vars */]) = -1 ENOENT (No such file or directory)\n[pid 24346] execve(\"/bin/rpm\", [\"rpm\", \"--define\", \"_topdir /home/archie/svn/ops/pex\"..., \"-bb\", \"--define\", \"_topdir /home/archie/svn/ops/pex\"..., \"--define\", \"svn_revision exported\", \"SPECS/pexp-web.spec\"], [/* 51 vars */]) = 0\n[pid 24339] waitpid(24346, 0xb482e29c, WNOHANG) = 0\n[pid 24289] clone(Process 24347 attached (waiting for parent)\nProcess 24347 resumed (parent 24289 ready)\nchild_stack=0xb382c484, flags=CLONE_VM|CLONE_FS|CLONE_FILES|CLONE_SIGHAND|CLONE_THREAD|CLONE_SYSVSEM|CLONE_SETTLS|CLONE_PARENT_SETTID|CLONE_CHILD_CLEARTID, parent_tidptr=0xb382cbd8, {entry_number:6, base_addr:0xb382cb70, limit:1048575, seg_32bit:1, contents:0, read_exec_only:0, limit_in_pages:1, seg_not_present:0, useable:1}, child_tidptr=0xb382cbd8) = 24347\n[pid 24289] clone(Process 24348 attached (waiting for parent)\nProcess 24348 resumed (parent 24289 ready)\nchild_stack=0xb402d484, flags=CLONE_VM|CLONE_FS|CLONE_FILES|CLONE_SIGHAND|CLONE_THREAD|CLONE_SYSVSEM|CLONE_SETTLS|CLONE_PARENT_SETTID|CLONE_CHILD_CLEARTID, parent_tidptr=0xb402dbd8, {entry_number:6, base_addr:0xb402db70, limit:1048575, seg_32bit:1, contents:0, read_exec_only:0, limit_in_pages:1, seg_not_present:0, useable:1}, child_tidptr=0xb402dbd8) = 24348\n[pid 24346] exit_group(1)               = ?\nProcess 24346 detached\n[pid 24339] --- SIGCHLD (Child exited) @ 0 (0) ---\n[pid 24339] waitpid(24346, [{WIFEXITED(s) && WEXITSTATUS(s) == 1}], WNOHANG) = 24346\n      [rpm] -bb: unknown option\n[pid 24347] --- SIGHUP (Hangup) @ 0 (0) ---\n[pid 24347] _exit(0)                    = ?\nProcess 24347 detached\n[pid 24348] --- SIGHUP (Hangup) @ 0 (0) ---\n[pid 24348] _exit(0)                    = ?\nProcess 24348 detached\n[pid 24289] clone(Process 24349 attached (waiting for parent)\nProcess 24349 resumed (parent 24289 ready)\nchild_stack=0xb402d484, flags=CLONE_VM|CLONE_FS|CLONE_FILES|CLONE_SIGHAND|CLONE_THREAD|CLONE_SYSVSEM|CLONE_SETTLS|CLONE_PARENT_SETTID|CLONE_CHILD_CLEARTID, parent_tidptr=0xb402dbd8, {entry_number:6, base_addr:0xb402db70, limit:1048575, seg_32bit:1, contents:0, read_exec_only:0, limit_in_pages:1, seg_not_present:0, useable:1}, child_tidptr=0xb402dbd8) = 24349\n[pid 24349] _exit(0)                    = ?\nProcess 24349 detached\n\nBUILD FAILED\n/home/archie/svn/ops/pexp-web/build.xml:9: The following error occurred while executing this line:\n/home/archie/svn/ops/pexp-web/src/build/macros.xml:411: 'rpm' failed with exit code 1", "is_private": false, "id": 147375, "creation_time": "2011-06-22T18:44:12Z", "time": "2011-06-22T18:44:12Z", "creator": "archie@dellroad.org", "bug_id": 51421, "attachment_id": null}]