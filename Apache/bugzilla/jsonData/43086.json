[{"count": 0, "tags": [], "creator": "komisarskip@student.mini.pw.edu.pl", "is_private": false, "id": 106589, "creation_time": "2007-08-10T06:21:05Z", "time": "2007-08-10T06:21:05Z", "bug_id": 43086, "text": "this is my code\n\nfor(int i=0;i<30;i++)\n    sheet.autoSizeColumn((short)i);\n\n\n\nand this is stacktrace:\n\njava.lang.ArrayIndexOutOfBoundsException: -32721\n\tat java.util.ArrayList.get(ArrayList.java:323)\n\tat \norg.apache.poi.hssf.model.WorkbookRecordList.get(WorkbookRecordList.java:54)\n\tat org.apache.poi.hssf.model.Workbook.getExFormatAt(Workbook.java:624)\n\tat \norg.apache.poi.hssf.usermodel.HSSFCell.getCellStyle(HSSFCell.java:856)\n\tat \norg.apache.poi.hssf.usermodel.HSSFSheet.autoSizeColumn(HSSFSheet.java:1424)", "attachment_id": null}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "text": "Your document probably contains some sort of invalid styling. It looks like the\nautoSizing code is trying to fetch the font details for the cell, and is failing\nwhen it can't find it.\n\nIf you upload the problem file, we can look at throwing a more helpful error", "id": 107177, "time": "2007-08-23T10:46:49Z", "bug_id": 43086, "creation_time": "2007-08-23T10:46:49Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "text": "i have no file.\nI'm trying to generate one....", "is_private": false, "bug_id": 43086, "id": 107221, "time": "2007-08-24T04:29:43Z", "creator": "komisarskip@student.mini.pw.edu.pl", "creation_time": "2007-08-24T04:29:43Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 43086, "text": "please post a full test case. \nI can't reproduce it. \n\nRegards,\nYegor", "count": 3, "id": 107234, "time": "2007-08-24T11:04:55Z", "creator": "yegor@dinom.ru", "creation_time": "2007-08-24T11:04:55Z", "is_private": false}, {"count": 4, "attachment_id": 21072, "creator": "wim.deblauwe@gmail.com", "is_private": false, "id": 110064, "time": "2007-10-31T09:18:50Z", "bug_id": 43086, "creation_time": "2007-10-31T09:18:50Z", "tags": [], "text": "Created attachment 21072\nTestcase for this bug\n\nThe attached test program reproduces the bug. I also get the same stacktrace\nand ArrayIndexOutOfBoundsException.\n\nregards,\n\nWim"}, {"count": 5, "tags": [], "bug_id": 43086, "attachment_id": null, "id": 110255, "time": "2007-11-05T22:36:31Z", "creator": "yegor@dinom.ru", "creation_time": "2007-11-05T22:36:31Z", "is_private": false, "text": "thanks for the test case. \nI will find time to look into it.\n\nYegor"}, {"count": 6, "attachment_id": null, "creator": "yegor@dinom.ru", "text": "Improper usage. \n\nThe maximum number of fonts in a workbook is 32767 ( the maximum positive short).   \nYou are creating a new font for each cell in a loop and finally the font index\nbecomes negative. \nThe subsequent call of HSSFSheet.autoSizeColumn results in\nArrayIndexOutOfBoundsException.\n\nSee how I suggest rewriting your sample code. It should work fine. \n\nP.S. I'm going to change HSSFWorkbook.createFont and throw an exception if the\nfont index becomes greater than 32767. \nThis way users will get a clearer indication of the problem. I will commit the\nfix in a little while.\n\nRegards,\nYegor", "id": 110262, "time": "2007-11-06T05:28:01Z", "bug_id": 43086, "creation_time": "2007-11-06T05:28:01Z", "tags": [], "is_private": false}, {"count": 7, "attachment_id": 21091, "creator": "yegor@dinom.ru", "text": "Created attachment 21091\nImproved version of the test case by Wim Deblauwe", "id": 110263, "time": "2007-11-06T05:29:50Z", "bug_id": 43086, "creation_time": "2007-11-06T05:29:50Z", "tags": [], "is_private": false}, {"count": 8, "tags": [], "creator": "wim.deblauwe@gmail.com", "is_private": false, "text": "Thank you for looking into this. You might want to add a note to the busy\ndevelopers guide (http://poi.apache.org/hssf/quick-guide.html#WorkingWithFonts)\nfor this.", "id": 110265, "time": "2007-11-06T06:13:24Z", "bug_id": 43086, "creation_time": "2007-11-06T06:13:24Z", "attachment_id": null}]