[{"count": 0, "tags": [], "creator": "Edwin_STEELE@rta.nsw.gov.au", "attachment_id": null, "id": 46022, "time": "2003-10-22T01:45:04Z", "bug_id": 23987, "creation_time": "2003-10-22T01:45:04Z", "is_private": false, "text": "(the summary could also read: scp task doesn't make a sensible default for the\nremote directory).\n\nWhen using scp from the commandline, it is possible to omit a remote directory\nand have scp place files in the home directory of the user. i.e.\nscp /etc/passwd user@remotehost:\nwill successfully place the passwd file in user's home directory on remotehost\n\nIf I run this task:\n<target name=\"scptest\">\n    <scp file=\"C:\\winnt\\notepad.exe\" todir=\"user@remotehost:\" password=\"pwd\"/>\n</target>\n\nI get:\n\nscptest:\n      [scp] Connecting to remotehost:22\n      [scp] java.io.FileNotFoundException: C:\\Documents and\nSettings\\user\\.ssh\\known_hosts (The system cannot find the path specified)\n\nBUILD FAILED\nfile:H:/Projects/Construction/deploy.xml:1703: java.io.IOException: Pipe closed\n\nI would either expect the build to fail because a remote directory wasn't\nspecified or (better) the scp task to work with the same amount of information\nthat the commandline scp does and make assumptions.\n\nThis is reasonably closely related to bug 23986."}, {"attachment_id": null, "tags": [], "bug_id": 23987, "is_private": false, "count": 1, "id": 46063, "time": "2003-10-22T14:54:47Z", "creator": "bodewig@apache.org", "creation_time": "2003-10-22T14:54:47Z", "text": "It seems to depend on the receiving side (or your jsch version).\n\nUsing JSch 0.1.8, Ant 1.6beta2 and OpenSSH on the receiving end, leaving\nout the directory puts the file into my home dir for me.\n\nWhich version of JSch are you using?"}, {"count": 2, "tags": [], "creator": "Edwin_STEELE@rta.nsw.gov.au", "text": "I'm using jsch 0.1.8, ant1.6beta2.\nI've tried running this with a win2k client and a redhat7.3 client with the same\nresult. Both are connecting to a rh7.3 machine.\nssh -V on the server machine gives:\nOpenSSH_3.1p1, SSH protocols 1.5/2.0, OpenSSL 0x0090602f\n\nI'll see if I can find another version to test against.\n\nWhat version are you using?\n", "id": 46099, "time": "2003-10-23T01:39:32Z", "bug_id": 23987, "creation_time": "2003-10-23T01:39:32Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "Edwin_STEELE@rta.nsw.gov.au", "text": "The behaviour is the same to debian woody remote host, where ssh -V gives:\nOpenSSH_3.4p1 Debian 1:3.4p1-1.woody.3, SSH protocols 1.5/2.0, OpenSSL 0x0090603f", "id": 46100, "time": "2003-10-23T02:07:46Z", "bug_id": 23987, "creation_time": "2003-10-23T02:07:46Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 46113, "time": "2003-10-23T09:46:53Z", "bug_id": 23987, "creation_time": "2003-10-23T09:46:53Z", "is_private": false, "text": "OpenSSH_3.1p1, SSH protocols 1.5/2.0, OpenSSL 0x0090602f\n\non RedHat 7.3.  Strange.\n\nDoes it work with . as directory?  We could make that the default if the directory\nhas been omited."}, {"count": 5, "tags": [], "bug_id": 23987, "attachment_id": null, "text": "The error you are getting says that ant cannot find your known_hosts file.\n\nDo you have a known_hosts file in\nC:\\Documents and Settings\\user\\.ssh\\known_hosts\n\n??", "id": 46180, "time": "2003-10-23T20:33:31Z", "creator": "riznob@hotmail.com", "creation_time": "2003-10-23T20:33:31Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 23987, "is_private": false, "count": 6, "id": 46198, "time": "2003-10-24T02:21:16Z", "creator": "Edwin_STEELE@rta.nsw.gov.au", "creation_time": "2003-10-24T02:21:16Z", "text": "How odd that we get different results.\nIt works fine when I use dot as the remote directory i.e.\n<target name=\"scptest\">\n    <scp file=\"/etc/sysctl.conf\" todir=\"user@remotemachine:.\" password=\"pwd\"/>\n</target>\n\nThe problem also happens regardless of whether I use a keyfile or password auth.\n\nI have a suspicion that this behaviour is being triggered by a problem in jsch.\nI've been looking at the logging produced by sshd with a LOGLEVEL of DEBUG3 and\nit appears that sshd doesn't always get an eof and when using the target above,\nsshd gets and eof but doesn't close the stream that it's reading from in a nice\nmanner. FWIW, openssh causes sshd to do everything \"normally\"\n\nI've posted to the jsch-users list and hope to get some answers. The post isn't\narchived just yet, but you should be able to find it eventually at:\nhttp://sourceforge.net/mailarchive/forum.php?forum_id=12628\nunder a thread \"puzzling rcvd and close_ messages\"\n\nEither way, Stefan's suggestion to make \".\" the default target directory solves\nthis issue, regardless of whether it's ant or jsch\n\nRobert, the known_hosts warning has been fixed in beta2, so I'm not getting it\nanymore. Thanks."}, {"count": 7, "tags": [], "bug_id": 23987, "attachment_id": null, "text": "Fixed by making remotedir default to \".\", I'll take care of Atsuhiko's other\nsuggestions separately.", "id": 46214, "time": "2003-10-24T08:02:11Z", "creator": "bodewig@apache.org", "creation_time": "2003-10-24T08:02:11Z", "is_private": false}]