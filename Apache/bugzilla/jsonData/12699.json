[{"count": 0, "tags": [], "bug_id": 12699, "is_private": false, "text": "Hi all, \n\nwe are using the above depicted configuation and I have difficulties in \nreceiving more than one cookie.\n\nThe existing application, which works fine with apache1.3 + tc4.0 and jk1 sends \nback two cookies for the same domain but with different keys. \nBoth cookies are valid for the current session only. \n\nThe code fragment looks like the following: \n\nif ( userAuthorized_KIB ) {\n          cookie = new Cookie (COOKIE_KEY_KIB, user);\n          cookie.setMaxAge(-1);\n          cookie.setPath(\"/\");\n          cookie.setDomain(COOKIE_DOMAIN);\n          res.addCookie(cookie);\n          System.out.println(\"Cookie KIB set\");\n        }\n          if ( userAuthorized_FS ) {\n          cookie = new Cookie(COOKIE_KEY_FS, user);\n          cookie.setMaxAge(-1);\n          cookie.setPath(\"/\");\n          cookie.setDomain(COOKIE_DOMAIN);\n          res.addCookie(cookie);\n          System.out.println(\"Cookie FS set\");\n        }\n\nI always get back the last written cookie only. Here in the above example the FS \ncookie. \nIf  I change the code (the KIB cookie is set last) I'll get back the KIB cookie.\n\nEven if try the same with the method addHeader only last added header set-Cookie   \ncounts. \n\nOliver", "id": 22943, "time": "2002-09-16T18:05:42Z", "creator": "oliver.lauer@sk-koeln.de", "creation_time": "2002-09-16T18:05:42Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "robertf@kw.com", "text": "We have the same problem with 1.3.23 with mod_perl, mod_php, mod_proxy, and \nmod_ssl.", "id": 24130, "time": "2002-10-08T13:20:14Z", "bug_id": 12699, "creation_time": "2002-10-08T13:20:14Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 12699, "text": "I have found the same problem, using Apache 2.0.43, Tomcat 4.1.12, and JK2 on\nLinux.  mod_webapp does not exhibit this behavior (although I have different\nproblems getting it to work).", "id": 24627, "time": "2002-10-16T15:16:30Z", "creator": "brett.neumeier@ualloyalty.com", "creation_time": "2002-10-16T15:16:30Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 12699, "attachment_id": null, "is_private": false, "id": 24629, "time": "2002-10-16T15:25:07Z", "creator": "hgomez@apache.org", "creation_time": "2002-10-16T15:25:07Z", "text": "Could you try with JK (1.2.0) and told us if it still don't works ?\n\n"}, {"count": 4, "attachment_id": null, "bug_id": 12699, "text": "Hum, I means Apache 2.0.43, Tomcat 4.1.12, and JK (1.2.0)\n\n", "id": 24630, "time": "2002-10-16T15:26:34Z", "creator": "hgomez@apache.org", "creation_time": "2002-10-16T15:26:34Z", "tags": [], "is_private": false}, {"count": 5, "attachment_id": null, "bug_id": 12699, "is_private": false, "id": 24657, "time": "2002-10-16T19:39:10Z", "creator": "brett.neumeier@ualloyalty.com", "creation_time": "2002-10-16T19:39:10Z", "tags": [], "text": "I have tested the configuration: Apache/2.0.43, mod_jk/1.2.0 Tocmat/4.1.12, on\nlinux.  In this configuration the response is correct; that is, the HTTP\nresponse contains multiple Set-Cookie: headers.\n\nLet me know if there is anything further I can do to assist.\n"}, {"count": 6, "tags": [], "text": "Could you send us an example servlet/jsp so I could make more tests and try to\nlocate this one ?", "is_private": false, "id": 24771, "creator": "hgomez@apache.org", "time": "2002-10-17T09:34:20Z", "bug_id": 12699, "creation_time": "2002-10-17T09:34:20Z", "attachment_id": null}, {"count": 7, "tags": [], "text": "Delighted to.  I'm appending servlet code (a modified version of\nHelloWorldExample), the HTTP request I submit via telnet to port 80 on my\nmachine, and the responses from apache with JK1 and apache with JK2.\n\n-----------servlet code-------------\nimport java.io.*;\nimport javax.servlet.*;\nimport javax.servlet.http.*;\n\npublic class HelloWorldExample extends HttpServlet {\n    public void doGet(HttpServletRequest request,\n                      HttpServletResponse response)\n        throws IOException, ServletException {\n        response.setContentType(\"text/html\");\n        response.addCookie(new Cookie(\"fee\", \"fie\"));\n        response.addCookie(new Cookie(\"foe\", \"fum\"));\n        response.addCookie(new Cookie(\"foo\", \"bar\"));\n        PrintWriter out = response.getWriter();\n\n        out.println(\"<html>\");\n        out.println(\"<head>\");\n\tString title = \"Hello, World!\";\n\tout.println(\"<title>\" + title + \"</title>\");\n        out.println(\"</head>\");\n        out.println(\"<body bgcolor=\\\"white\\\">\");\n        out.println(\"<h1>\" + title + \"</h1>\");\n        out.println(\"</body>\");\n        out.println(\"</html>\");\n    }\n}\n-----------------HTTP REQUEST-----------------------\nGET /examples/servlet/HelloWorldExample HTTP/1.1\nHost: bn.mypoints.com\nConnection: close\n-----------------HTTP RESPONSE, JK1-----------------\nHTTP/1.1 200 OK\nDate: Thu, 17 Oct 2002 15:27:37 GMT\nServer: Apache/2.0.43 (Unix) mod_ssl/2.0.43 OpenSSL/0.9.6g mod_jk/1.2.0\nSet-Cookie: fee=fie\nSet-Cookie: foe=fum\nSet-Cookie: foo=bar\nConnection: close\nTransfer-Encoding: chunked\nContent-Type: text/html; charset=ISO-8859-1\n\n71\n<html>\n<head>\n<title>Hello, World!</title>\n</head>\n<body bgcolor=\"white\">\n<h1>Hello, World!</h1>\n</body>\n</html>\n\n0\n------------------------HTTP RESPONSE, JK2--------------------\nHTTP/1.1 200 \nDate: Thu, 17 Oct 2002 15:24:32 GMT\nServer: Apache/2.0.43 (Unix) mod_ssl/2.0.43 OpenSSL/0.9.6g mod_jk2/2.0.0\nContent-Type: text/html; charset=ISO-8859-1\nSet-Cookie: foo=bar\nContent-Length: 113\nConnection: close\n\n<html>\n<head>\n<title>Hello, World!</title>\n</head>\n<body bgcolor=\"white\">\n<h1>Hello, World!</h1>\n</body>\n</html>", "is_private": false, "id": 24792, "creator": "brett.neumeier@ualloyalty.com", "time": "2002-10-17T15:35:21Z", "bug_id": 12699, "creation_time": "2002-10-17T15:35:21Z", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 12699, "attachment_id": null, "is_private": false, "id": 24848, "time": "2002-10-18T07:40:48Z", "creator": "mturk@apache.org", "creation_time": "2002-10-18T07:40:48Z", "text": "Fixed in the CVS."}, {"count": 9, "attachment_id": null, "creator": "brett.neumeier@ualloyalty.com", "is_private": false, "id": 25403, "time": "2002-10-31T00:13:24Z", "bug_id": 12699, "creation_time": "2002-10-31T00:13:24Z", "tags": [], "text": "*** Bug 10891 has been marked as a duplicate of this bug. ***"}]