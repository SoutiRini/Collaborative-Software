[{"count": 0, "tags": [], "creator": "pencilethics@gmail.com", "text": "Errors in the _install target (which is called by installd and installr) of\nMakefile.win in trunk (Revision 170110 - 2.1.5-dev) prevent a successful\ninstall; a trivial error in the configuration copying portion causes nmake to\nchoke when copying httpd-dav.conf to the install location. This error is only\nvisible on a \"fresh\" install; the error-causing lines that cause nmake to choke\nare behind \"if not exists\" clauses. Some additional flaws cause unnecessary\nduplicate configuration files (which do not get processed by awk) to be copied\nto $(INSTDIR)\\conf\\original.\n\nThe erroneous lines are 678-679, 664, 680, 696, 712, 728, 749, 766, 783, 786,\n789 and 792. If you compare lines 678-679 with lines 694-695 you will notice\nthat they are identical, and careful analysis tells you that 678-679 should be\nreferring to httpd-autoindex.conf, not httpd-dav.conf (since httpd-dav.conf does\nnot exist when these lines are processed); the remaining lines copy the extra\nconfiguration files to the incorrect location and as a result the following\nlines look for them in the wrong place, producing unnecessary duplicates which\ndo not get processed with awk. Careful scrutiny should point out that the\noffending lines should be copying the files to $(INSTDIR)\\conf\\original\\extra,\nnot $(INSTDIR)\\conf\\original.\n\nTo avoid irritating Win32 users who compile and install from source, these\nproblems should be fixed. (However the only \"critical\" error which halts the\nbuild process is present in lines 678-679.)\n\nSteps to Reproduce:\n\n1) Checkout trunk and APR (apr, apr-iconv, apr-util) from SVN repository\n(Revision 170114 as of writing)\n2) Build OpenSSL 0.9.7g (for mod_ssl) and zlib 1.2.2 (for mod_deflate) and copy\ninto srclib.\n3) Open Apache.dsw in Visual C++ 6.0 and export makefiles.\n4) nmake /f Makefile.win installr INSTDIR=C:\\Somefolder\n5) Error results during file copying - nmake halts with something to the effect\nof \"NMAKE Stop: copy returned 0x1 - httpd-dav.conf does not exist\"\n\ninstalld should produce the same error, since it also calls the _install target.\n\nUsing:\n1) Windows Server 2003 SP1\n2) Platform SDK for Windows XP SP2\n3) Visual C++ 6.0 SP6", "id": 74869, "time": "2005-05-14T03:57:04Z", "bug_id": 34915, "creation_time": "2005-05-14T03:57:04Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 34915, "text": "Created attachment 15027\nPatch to Makefile.win", "id": 74870, "attachment_id": 15027, "creator": "pencilethics@gmail.com", "creation_time": "2005-05-14T03:59:19Z", "time": "2005-05-14T03:59:19Z", "is_private": false}, {"count": 2, "tags": [], "creator": "pencilethics@gmail.com", "text": "Comment on attachment 15027\nPatch to Makefile.win\n\n><HTML imagetoolbarenabled=\"true\"><HEAD/><BODY><PRE>--- Makefile.win\t2005-05-13 00:35:33.203125000 +1200\n>+++ Makefile.win\t2005-05-14 12:59:49.937500000 +1200\n>@@ -661,7 +661,7 @@\n> <<\n> \tif not exist \"$(INSTDIR)\\conf\\httpd.conf\" \\\n> \t    copy \"$(INSTDIR)\\conf\\original\\httpd.conf\" \"$(INSTDIR)\\conf\\httpd.conf\"\n>-\tcopy docs\\conf\\extra\\httpd-autoindex.conf.in \"$(INSTDIR)\\conf\\original\\httpd-autoindex.conf\" <.y\n>+\tcopy docs\\conf\\extra\\httpd-autoindex.conf.in \"$(INSTDIR)\\conf\\original\\extra\\httpd-autoindex.conf\" <.y\n> \t-awk -f <<script.awk \"docs/conf/extra/httpd-autoindex.conf.in\" \"$(INSTDIR)\" > \"$(INSTDIR)\\conf\\original\\extra\\httpd-autoindex.conf\"\n>     BEGIN { \n> \tserverroot = ARGV[2];\n>@@ -675,9 +675,9 @@\n> \tprint $$0;\n>     }\n> <<\n>-\tif not exist \"$(INSTDIR)\\conf\\extra\\httpd-dav.conf\" \\\n>-\t    copy \"$(INSTDIR)\\conf\\original\\extra\\httpd-dav.conf\" \"$(INSTDIR)\\conf\\extra\\httpd-dav.conf\"\n>-\tcopy docs\\conf\\extra\\httpd-dav.conf.in \"$(INSTDIR)\\conf\\original\\httpd-dav.conf\" <.y\n>+\tif not exist \"$(INSTDIR)\\conf\\extra\\httpd-autoindex.conf\" \\\n>+\t    copy \"$(INSTDIR)\\conf\\original\\extra\\httpd-autoindex.conf\" \"$(INSTDIR)\\conf\\extra\\httpd-autoindex.conf\"\n>+\tcopy docs\\conf\\extra\\httpd-dav.conf.in \"$(INSTDIR)\\conf\\original\\extra\\httpd-dav.conf\" <.y\n> \t-awk -f <<script.awk \"docs/conf/extra/httpd-dav.conf.in\" \"$(INSTDIR)\" > \"$(INSTDIR)\\conf\\original\\extra\\httpd-dav.conf\"\n>     BEGIN { \n> \tserverroot = ARGV[2];\n>@@ -693,7 +693,7 @@\n> <<\n> \tif not exist \"$(INSTDIR)\\conf\\extra\\httpd-dav.conf\" \\\n> \t    copy \"$(INSTDIR)\\conf\\original\\extra\\httpd-dav.conf\" \"$(INSTDIR)\\conf\\extra\\httpd-dav.conf\"\n>-\tcopy docs\\conf\\extra\\httpd-manual.conf.in \"$(INSTDIR)\\conf\\original\\httpd-manual.conf\" <.y\n>+\tcopy docs\\conf\\extra\\httpd-manual.conf.in \"$(INSTDIR)\\conf\\original\\extra\\httpd-manual.conf\" <.y\n> \t-awk -f <<script.awk \"docs/conf/extra/httpd-manual.conf.in\" \"$(INSTDIR)\" > \"$(INSTDIR)\\conf\\original\\extra\\httpd-manual.conf\"\n>     BEGIN { \n> \tserverroot = ARGV[2];\n>@@ -709,7 +709,7 @@\n> <<\n> \tif not exist \"$(INSTDIR)\\conf\\extra\\httpd-manual.conf\" \\\n> \t    copy \"$(INSTDIR)\\conf\\original\\extra\\httpd-manual.conf\" \"$(INSTDIR)\\conf\\extra\\httpd-manual.conf\"\n>-\tcopy docs\\conf\\extra\\httpd-multilang-errordoc.conf.in \"$(INSTDIR)\\conf\\original\\httpd-multilang-errordoc.conf\" <.y\n>+\tcopy docs\\conf\\extra\\httpd-multilang-errordoc.conf.in \"$(INSTDIR)\\conf\\original\\extra\\httpd-multilang-errordoc.conf\" <.y\n> \t-awk -f <<script.awk \"docs/conf/extra/httpd-multilang-errordoc.conf.in\" \"$(INSTDIR)\" > \"$(INSTDIR)\\conf\\original\\extra\\httpd-multilang-errordoc.conf\"\n>     BEGIN { \n> \tserverroot = ARGV[2];\n>@@ -725,7 +725,7 @@\n> <<\n> \tif not exist \"$(INSTDIR)\\conf\\extra\\httpd-multilang-errordoc.conf\" \\\n> \t    copy \"$(INSTDIR)\\conf\\original\\extra\\httpd-multilang-errordoc.conf\" \"$(INSTDIR)\\conf\\extra\\httpd-multilang-errordoc.conf\"\n>-\tcopy docs\\conf\\extra\\httpd-ssl.conf.in \"$(INSTDIR)\\conf\\original\\httpd-ssl.conf\" <.y\n>+\tcopy docs\\conf\\extra\\httpd-ssl.conf.in \"$(INSTDIR)\\conf\\original\\extra\\httpd-ssl.conf\" <.y\n> \t-awk -f <<script.awk \"docs/conf/extra/httpd-ssl.conf.in\" \"$(INSTDIR)\" > \"$(INSTDIR)\\conf\\original\\extra\\httpd-ssl.conf\"\n>     BEGIN { \n> \tserverroot = ARGV[2];\n>@@ -746,7 +746,7 @@\n> <<\n> \tif not exist \"$(INSTDIR)\\conf\\extra\\httpd-ssl.conf\" \\\n> \t    copy \"$(INSTDIR)\\conf\\original\\extra\\httpd-ssl.conf\" \"$(INSTDIR)\\conf\\extra\\httpd-ssl.conf\"\n>-\tcopy docs\\conf\\extra\\httpd-userdir.conf.in \"$(INSTDIR)\\conf\\original\\httpd-userdir.conf\" <.y\n>+\tcopy docs\\conf\\extra\\httpd-userdir.conf.in \"$(INSTDIR)\\conf\\original\\extra\\httpd-userdir.conf\" <.y\n> \t-awk -f <<script.awk \"docs/conf/extra/httpd-userdir.conf.in\" \"$(INSTDIR)\" > \"$(INSTDIR)\\conf\\original\\extra\\httpd-userdir.conf\"\n>     BEGIN { \n> \tserverroot = ARGV[2];\n>@@ -763,7 +763,7 @@\n> <<\n> \tif not exist \"$(INSTDIR)\\conf\\extra\\httpd-userdir.conf\" \\\n> \t    copy \"$(INSTDIR)\\conf\\original\\extra\\httpd-userdir.conf\" \"$(INSTDIR)\\conf\\extra\\httpd-userdir.conf\"\n>-\tcopy docs\\conf\\extra\\httpd-mpm.conf.in \"$(INSTDIR)\\conf\\original\\httpd-mpm.conf\" <.y\n>+\tcopy docs\\conf\\extra\\httpd-mpm.conf.in \"$(INSTDIR)\\conf\\original\\extra\\httpd-mpm.conf\" <.y\n> \t-awk -f <<script.awk \"docs/conf/extra/httpd-mpm.conf.in\" \"$(INSTDIR)\" > \"$(INSTDIR)\\conf\\original\\extra\\httpd-mpm.conf\"\n>     BEGIN { \n> \tserverroot = ARGV[2];\n>@@ -780,16 +780,16 @@\n> <<\n> \tif not exist \"$(INSTDIR)\\conf\\extra\\httpd-mpm.conf\" \\\n> \t    copy \"$(INSTDIR)\\conf\\original\\extra\\httpd-mpm.conf\" \"$(INSTDIR)\\conf\\extra\\httpd-mpm.conf\"\n>-\tcopy docs\\conf\\extra\\httpd-default.conf.in \"$(INSTDIR)\\conf\\original\\httpd-default.conf\" <.y\n>+\tcopy docs\\conf\\extra\\httpd-default.conf.in \"$(INSTDIR)\\conf\\original\\extra\\httpd-default.conf\" <.y\n> \tif not exist \"$(INSTDIR)\\conf\\extra\\httpd-default.conf\" \\\n> \t    copy \"$(INSTDIR)\\conf\\original\\extra\\httpd-default.conf\" \"$(INSTDIR)\\conf\\extra\\httpd-default.conf\"\n>-\tcopy docs\\conf\\extra\\httpd-info.conf.in \"$(INSTDIR)\\conf\\original\\httpd-info.conf\" <.y\n>+\tcopy docs\\conf\\extra\\httpd-info.conf.in \"$(INSTDIR)\\conf\\original\\extra\\httpd-info.conf\" <.y\n> \tif not exist \"$(INSTDIR)\\conf\\extra\\httpd-info.conf\" \\\n> \t    copy \"$(INSTDIR)\\conf\\original\\extra\\httpd-info.conf\" \"$(INSTDIR)\\conf\\extra\\httpd-info.conf\"\n>-\tcopy docs\\conf\\extra\\httpd-languages.conf.in \"$(INSTDIR)\\conf\\original\\httpd-languages.conf\" <.y\n>+\tcopy docs\\conf\\extra\\httpd-languages.conf.in \"$(INSTDIR)\\conf\\original\\extra\\httpd-languages.conf\" <.y\n> \tif not exist \"$(INSTDIR)\\conf\\extra\\httpd-languages.conf\" \\\n> \t    copy \"$(INSTDIR)\\conf\\original\\extra\\httpd-languages.conf\" \"$(INSTDIR)\\conf\\extra\\httpd-languages.conf\"\n>-\tcopy docs\\conf\\extra\\httpd-vhosts.conf.in \"$(INSTDIR)\\conf\\original\\httpd-vhosts.conf\" <.y\n>+\tcopy docs\\conf\\extra\\httpd-vhosts.conf.in \"$(INSTDIR)\\conf\\original\\extra\\httpd-vhosts.conf\" <.y\n> \tif not exist \"$(INSTDIR)\\conf\\extra\\httpd-vhosts.conf\" \\\n> \t    copy \"$(INSTDIR)\\conf\\original\\extra\\httpd-vhosts.conf\" \"$(INSTDIR)\\conf\\extra\\httpd-vhosts.conf\"\n> \t-awk -f <<script.awk \"support/dbmmanage.in\" >\"$(INSTDIR)\\bin\\dbmmanage.pl\"", "id": 74878, "time": "2005-05-14T10:58:36Z", "bug_id": 34915, "creation_time": "2005-05-14T10:58:36Z", "is_private": false, "attachment_id": 15027}, {"count": 3, "tags": [], "bug_id": 34915, "attachment_id": 15028, "text": "Created attachment 15028\nPatch to Makefile.win (edited)\n\nPlease ignore comment #2 - I messed up editing the attachment.", "id": 74880, "time": "2005-05-14T11:02:17Z", "creator": "pencilethics@gmail.com", "creation_time": "2005-05-14T11:02:17Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 34915, "text": "Makefile.win has been fixed up in 2.2.0 w/ patches.", "id": 83286, "attachment_id": null, "creator": "chip@force-elite.com", "creation_time": "2005-12-06T07:43:34Z", "time": "2005-12-06T07:43:34Z", "is_private": false}]