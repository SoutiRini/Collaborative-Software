[{"count": 0, "tags": [], "bug_id": 34826, "attachment_id": null, "text": "Found on Oracle 10g. \n\nThis error happens when the following criteria are met:\n1) running sql task with keepformat=true\n2) Comments are found OUTSIDE a sql block (like at the top of the file). \n\nYou get the following error message:\nMessage: ORA-00600: internal error code, arguments: [12259], [], [], [], [], [],\n[], [] \n\nA solution would be to have the task determine whether it is currently in the\nmiddle of an SQL block while it is iterating through the file. A proposed fix\npatch will be attached.", "id": 74637, "time": "2005-05-09T23:32:42Z", "creator": "glenn.h.brown@jpmorgan.com", "creation_time": "2005-05-09T23:32:42Z", "is_private": false}, {"count": 1, "tags": [], "creator": "glenn.h.brown@jpmorgan.com", "attachment_id": 14976, "id": 74638, "time": "2005-05-09T23:40:21Z", "bug_id": 34826, "creation_time": "2005-05-09T23:40:21Z", "is_private": false, "text": "Created attachment 14976\nProposed patch\n\n1) It sets a boolean called statementBody. It starts out as false\n2) If the line is not a comment or blank like statementBody gets set to true. \n3) If the line is a comment and statementBody is still false the comment gets\nthrown on the floor and a debug message is issued saying that it was skipped. \nIf it is not a comment it gets appended to the sql string. \n4) If the line ends with a delimiter, sql gets executed and statementBody is\nset back to false."}, {"count": 2, "tags": [], "bug_id": 34826, "attachment_id": null, "text": "This would remove comments from SQL files for databases that don't have problems\nwith it at all as well.  In particular it subverts the whole purpose of the\nkeepformat attribute.\n\nTo me it looks like a bug in Oracle that may as well get fixed in a later version,\nwe shouldn't punish all other DB users because of it.\n\nIn your case, is keepformat really required?  Can you run a striplinecomments\nfilter reader over your SQL file before execting it?", "id": 74828, "time": "2005-05-12T22:12:16Z", "creator": "bodewig@apache.org", "creation_time": "2005-05-12T22:12:16Z", "is_private": false}, {"count": 3, "tags": [], "creator": "glenn.h.brown@jpmorgan.com", "attachment_id": null, "id": 74829, "time": "2005-05-12T22:56:57Z", "bug_id": 34826, "creation_time": "2005-05-12T22:56:57Z", "is_private": false, "text": "striplinecomments wouldnt work for us - there are some line comments within the \nsql that we would like to keep. \n\nKeep in mind that this would not strip all comments out of a file - only those \nthat are not inside a sql block. \n\nI CAN see your point however - although I might get some push-back from Oracle \nabout whether or not it is their bug. I think I will try the following: \n\n1) Write a standard Java app running the exact same sql code using the same \nJDBC driver. \n\n2) If it fails the same way I will close this bug and open one with Oracle.\n\nHowever,\n\n3) If it doesn't and it appears to be the way Ant parses the file, I will \ncreate another patch that will perform the same action but will require an \noption to do so. \n\nDeal?"}, {"count": 4, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "is_private": false, "id": 74835, "time": "2005-05-13T09:03:45Z", "bug_id": 34826, "creation_time": "2005-05-13T09:03:45Z", "text": "Sounds OK.\n\nMaybe a tailfilter would work for you as a workaround?"}, {"count": 5, "tags": [], "bug_id": 34826, "attachment_id": null, "id": 74857, "time": "2005-05-13T18:08:45Z", "creator": "glenn.h.brown@jpmorgan.com", "creation_time": "2005-05-13T18:08:45Z", "is_private": false, "text": "Confirmed an Oracle Bug. Closing. "}]