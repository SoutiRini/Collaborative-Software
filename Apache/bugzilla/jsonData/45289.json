[{"count": 0, "tags": [], "bug_id": 45289, "attachment_id": null, "text": "The current COUNTIF funztion implementation in HSSF can handle espression like\n\nCOUNTIF(A1:A5; \"12\")\n\nCOUNTIF(A1:A5; \"right\")\n\nbut not analogous ones like\n\nCOUNTIF(A1:A5; \"=12\")\n\nCOUNTIF(A1:A5; \"=right\")\n\nA simple patch could consist of small editing of createGeneralMatchPredicate method:\n\n1) replace the first statement\n\nString value = stringEval.getStringValue();\n\nwith\n\nString value = stringEval.getStringValue().replaceAll(\"^=\", \"\");\n\n2) comment out the\n\ncase '=':\n\nstatement (preserving the throw statement right next)", "id": 118015, "time": "2008-06-26T09:07:27Z", "creator": "domenico.napoletano@exprivia.it", "creation_time": "2008-06-26T09:07:27Z", "is_private": false}, {"count": 1, "tags": [], "text": "This looks like an OK fix to me.\n\nJosh - as our current formula guru, does it make sense to you too?", "is_private": false, "bug_id": 45289, "id": 118096, "time": "2008-06-28T11:59:55Z", "creator": "apache@gagravarr.org", "creation_time": "2008-06-28T11:59:55Z", "attachment_id": null}, {"count": 2, "tags": [], "text": "Fixed in svn r675853.\n\nAdded support for all operators (=, <>, <, <=, >, >=), also wildcard criteria.\nFixed up POI to follow COUNTIF's funny type conversion rules.\n\nJunits added.", "is_private": false, "bug_id": 45289, "id": 118540, "time": "2008-07-11T01:03:40Z", "creator": "josh@apache.org", "creation_time": "2008-07-11T01:03:40Z", "attachment_id": null}]