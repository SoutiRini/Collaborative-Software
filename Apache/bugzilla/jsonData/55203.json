[{"count": 0, "text": "The BSF and JSR223 test elements share some common classes and code.\n\nIt looks like the Bean Code is getting confused, because the list of languages for BSF and JSR223 always displays the same.\n\nThere are several common entries, but there are some languages that are only supported by one of the scripting interfaces. For example:\n\nBoth\nbeanshell\njava\n\nBSF only\nbeanbasic\nbml\nxslt\n\nJSR223 only\necmascript\nrhino\n\nI think this is related to the fact that the same field name is used for both sets of classes. It looks like only one of the \"language\" field definitions is being found by JMeter; sometimes it will be the wrong one.", "bug_id": 55203, "attachment_id": null, "id": 168323, "time": "2013-07-06T13:55:49Z", "creator": "sebb@apache.org", "creation_time": "2013-07-06T13:55:49Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "vlahovic74@gmail.com", "attachment_id": null, "id": 168336, "time": "2013-07-07T06:10:49Z", "bug_id": 55203, "creation_time": "2013-07-07T06:10:49Z", "is_private": false, "text": "This issue started in 2.9. In 2.8 it is all good."}, {"count": 2, "tags": [], "text": "Broken in 2.8 for me.\n\nI first tried adding BSF and JSR223 samplers to Workbench - looked OK.\nI then moved them under Thread Group and saved as JMX (to follow).\nOn reload, both the drop-downs showed the same list.\n\nI think the problem is that the same PropertyDescriptor instances are created for what should be different beans. I don't know why that is yet, probably because the beans share inherited information. Maybe the Introspector parameters are wrong.", "attachment_id": null, "bug_id": 55203, "id": 168341, "time": "2013-07-07T11:19:09Z", "creator": "sebb@apache.org", "creation_time": "2013-07-07T11:19:09Z", "is_private": false}, {"count": 3, "tags": [], "text": "Created attachment 30561\nTest case", "attachment_id": 30561, "bug_id": 55203, "id": 168342, "time": "2013-07-07T11:19:59Z", "creator": "sebb@apache.org", "creation_time": "2013-07-07T11:19:59Z", "is_private": false}, {"count": 4, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "attachment_id": null, "id": 168352, "time": "2013-07-07T19:38:00Z", "bug_id": 55203, "creation_time": "2013-07-07T19:38:00Z", "is_private": false, "text": "I think regression came from 54110.\n\nsebb regarding your test case, I just put them as children of Workbench and I see they have the same language while they should not"}, {"count": 5, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "attachment_id": null, "id": 168353, "time": "2013-07-07T20:05:53Z", "bug_id": 55203, "creation_time": "2013-07-07T20:05:53Z", "is_private": false, "text": "Date: Sun Jul  7 20:04:34 2013\nNew Revision: 1500526\n\nURL: http://svn.apache.org/r1500526\nLog:\nBug 55203 - TestBeanGUI - wrong language settings found\nBugzilla Id: 55203\n\nModified:\n    jmeter/trunk/src/protocol/java/org/apache/jmeter/protocol/java/sampler/JSR223SamplerBeanInfo.java"}, {"count": 6, "tags": [], "text": "Debugging I see the 2 classes share the same PropertyDescriptor instance.", "attachment_id": null, "bug_id": 55203, "id": 168354, "time": "2013-07-07T20:36:48Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2013-07-07T20:36:48Z", "is_private": false}, {"count": 7, "text": "Yes, they share the same rootBeanInfo class, i.e. java.beans.GenericBeanInfo, which I think is the problem here. Although they are obviously different instances, the class is what seems to be used for distinguishing cached elements.", "bug_id": 55203, "attachment_id": null, "id": 168357, "time": "2013-07-07T22:17:23Z", "creator": "sebb@apache.org", "creation_time": "2013-07-07T22:17:23Z", "tags": [], "is_private": false}, {"count": 8, "tags": [], "creator": "sebb@apache.org", "attachment_id": null, "is_private": false, "id": 168358, "time": "2013-07-07T22:17:56Z", "bug_id": 55203, "creation_time": "2013-07-07T22:17:56Z", "text": "(In reply to Philippe Mouawad from comment #5)\n> Date: Sun Jul  7 20:04:34 2013\n> New Revision: 1500526\n> \n> URL: http://svn.apache.org/r1500526\n> Log:\n> Bug 55203 - TestBeanGUI - wrong language settings found\n> Bugzilla Id: 55203\n> \n> Modified:\n>    \n> jmeter/trunk/src/protocol/java/org/apache/jmeter/protocol/java/sampler/\n> JSR223SamplerBeanInfo.java\n\nGood catch, but unfortunately not the solution."}, {"count": 9, "tags": [], "creator": "sebb@apache.org", "attachment_id": null, "id": 168360, "time": "2013-07-07T22:51:44Z", "bug_id": 55203, "creation_time": "2013-07-07T22:51:44Z", "is_private": false, "text": "I tried removing the shared setup from the ScriptingBeanInfoSupport class and copied it down to the BSF and JSR223 classes, and that does not make any difference either"}, {"count": 10, "tags": [], "creator": "sebb@apache.org", "attachment_id": null, "is_private": false, "id": 168362, "time": "2013-07-07T23:27:04Z", "bug_id": 55203, "creation_time": "2013-07-07T23:27:04Z", "text": "(In reply to Philippe Mouawad from comment #4)\n> I think regression came from 54110.\n\nBug 54110 moved the common fields and setters/getters to a shared super-class.\n\nI just tried moving them back, and it does not fix the issue."}, {"count": 11, "tags": [], "creator": "sebb@apache.org", "attachment_id": null, "id": 168365, "time": "2013-07-08T00:46:05Z", "bug_id": 55203, "creation_time": "2013-07-08T00:46:05Z", "is_private": false, "text": "(In reply to Sebb from comment #10)\n> (In reply to Philippe Mouawad from comment #4)\n> > I think regression came from 54110.\n> \n> Bug 54110 moved the common fields and setters/getters to a shared\n> super-class.\n> \n> I just tried moving them back, and it does not fix the issue.\n\nOops, sorry - I thought the lists looked the same, but I'd forgotten I'd converted JSR223 to all lower case and I was looking for an uppercase entry.\nShould have checked more carefully.\n\nThe problem does seem to be the shared class with different requirements for the TAG field.\n\nHowever, it does not seem to be a problem for the other shared fields where the attributes may vary - e.g. scripting.displayName which shows the different script variables that are available."}, {"count": 12, "tags": [], "creator": "sebb@apache.org", "attachment_id": null, "id": 168366, "time": "2013-07-08T00:50:53Z", "bug_id": 55203, "creation_time": "2013-07-08T00:50:53Z", "is_private": false, "text": "Hopefully this fixes the issue:\n\nURL: http://svn.apache.org/r1500556\nLog:\nTestBeanGUI - wrong language settings found\nBugzilla Id: 55203\n\nModified:\n    jmeter/trunk/src/core/org/apache/jmeter/util/BSFTestElement.java\n    jmeter/trunk/src/core/org/apache/jmeter/util/JSR223TestElement.java\n    jmeter/trunk/src/core/org/apache/jmeter/util/ScriptingTestElement.java\n    jmeter/trunk/xdocs/changes.xml\n\nLeaving open for now in case there are other shared parameters that need moving"}, {"count": 13, "text": "(In reply to Sebb from comment #7)\n> Yes, they share the same rootBeanInfo class, i.e.\n> java.beans.GenericBeanInfo, which I think is the problem here. Although they\n> are obviously different instances, the class is what seems to be used for\n> distinguishing cached elements.\n\nThey really share the same instance.\nIssue also affects short description for example.", "bug_id": 55203, "attachment_id": null, "id": 168372, "time": "2013-07-08T06:56:51Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2013-07-08T06:56:51Z", "tags": [], "is_private": false}, {"count": 14, "tags": [], "text": "Issue no more apparent with moving scriptLanguage to 2 subclasses", "is_private": false, "bug_id": 55203, "id": 168373, "time": "2013-07-08T07:06:55Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2013-07-08T07:06:55Z", "attachment_id": null}, {"count": 15, "tags": [], "text": "I think it must have been a combination of the two issues.\n\nJMeter 2.7 has the problem, and was before the properties were moved to the shared super-class. However the JSR223SamplerBeanInfo class extended the wrong base class.\n\n==\n\nThere are still properties that are shared between GUI classes - e.g. all the JSR223 classes share the same definition of the \"script\" property.\n\nThe TAGS field is an attribute of the \"script\" PropertyDescriptor which varies between sub-classes whereas the other attributes are identical to all sub-classes.\n\nI think that is probably why they work OK; the PropertyDescriptor is used to look-up the names and types of the properties which don't vary. It was only the TAGS attribute that varied.", "is_private": false, "bug_id": 55203, "id": 168374, "time": "2013-07-08T08:10:28Z", "creator": "sebb@apache.org", "creation_time": "2013-07-08T08:10:28Z", "attachment_id": null}]