[{"count": 0, "attachment_id": null, "bug_id": 1253, "text": "When running Tomcat 3.2.2b2 and Apache together on a high load site, connected\nvia mod_jk on the same box, the following exceptions are frequently printed to\ntomcat's stderr.\n\nI am not sure if this has any user impact, or whether it is due to Apache\nchildren spawning and dying off.  If it is not harmful, the exception log should\nprobably be supressed to avoid false alarms.\n\n\n\njava.net.SocketException: Connection reset by peer: Connection reset by peer\n        at java.net.SocketInputStream.socketRead(Native Method)\n        at java.net.SocketInputStream.socketRead(Compiled Code)\n        at java.net.SocketInputStream.read(Compiled Code)\n        at\norg.apache.tomcat.service.connector.TcpConnector.receiveFully(Compiled Code)\n        at org.apache.tomcat.service.connector.TcpConnector.receive(Compiled Code)\n        at\norg.apache.tomcat.service.connector.Ajp13ConnectionHandler.processConnection(Compiled\nCode)\n        at org.apache.tomcat.service.TcpWorkerThread.runIt(Compiled Code)\n        at org.apache.tomcat.util.ThreadPool$ControlRunnable.run(Compiled Code)\n        at java.lang.Thread.run(Compiled Code)\njava.net.SocketException: Connection reset by peer: Connection reset by peer\n        at java.net.SocketInputStream.socketRead(Native Method)\n        at java.net.SocketInputStream.socketRead(Compiled Code)\n        at java.net.SocketInputStream.read(Compiled Code)\n        at\norg.apache.tomcat.service.connector.TcpConnector.receiveFully(Compiled Code)\n        at org.apache.tomcat.service.connector.TcpConnector.receive(Compiled Code)\n        at\norg.apache.tomcat.service.connector.Ajp13ConnectionHandler.processConnection(Compiled\nCode)\n        at org.apache.tomcat.service.TcpWorkerThread.runIt(Compiled Code)\n        at org.apache.tomcat.util.ThreadPool$ControlRunnable.run(Compiled Code)\n        at java.lang.Thread.run(Compiled Code)", "id": 1773, "time": "2001-04-06T13:18:59Z", "creator": "pogo_tomcat@yahoo.com", "creation_time": "2001-04-06T13:18:59Z", "tags": [], "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 1253, "is_private": false, "id": 2290, "time": "2001-05-07T07:38:30Z", "creator": "hgomez@slib.fr", "creation_time": "2001-05-07T07:38:30Z", "tags": [], "text": "This bug happen when Apache is incorrectly \nconfigured and have too many childs running.\nI encounter the same problem and fixes by setting \napache with :\n\nMinSpareServer: 10\nMaxSpareServer: 20\nStartServer:    10\nMaxClients:    250\n\nMy ajp13 in server.xml was :\n\nmax_threads=200\nmax_spare_threads=150\nmin_spare_threads=150\n\n\n"}, {"count": 2, "tags": [], "bug_id": 1253, "attachment_id": null, "is_private": false, "id": 2321, "time": "2001-05-08T10:52:19Z", "creator": "pogo_tomcat@yahoo.com", "creation_time": "2001-05-08T10:52:19Z", "text": "Thanks for your comment in bug 1253.  I was curious why you said that the \nApache was misconfigured, though.  What do you mean by too many Apache \nchildren?  If there are more Tomcat threads in the thread pool than Apache \nchildren, then shouldn't Tomcat be OK?\n\nOur config is:\n\nMinSpareServers 5\nMaxSpareServers 50\nStartServers 50\nMaxClients 256\n\najp13:\nmax_threads 300"}, {"count": 3, "tags": [], "bug_id": 1253, "attachment_id": null, "is_private": false, "id": 3772, "time": "2001-07-17T09:42:01Z", "creator": "kasvosve@hotmail.com", "creation_time": "2001-07-17T09:42:01Z", "text": "I do not use Apache, just Tomcat, and I get this error a lot.\nIt is halting some cutting-edge development we have been doing which heavily \nutilizes sockets.\nAny help would be appreciated.\n"}, {"count": 4, "tags": [], "text": "It's a problem related to configuration.\n", "is_private": false, "bug_id": 1253, "id": 3943, "time": "2001-07-23T23:20:51Z", "creator": "hgomez@slib.fr", "creation_time": "2001-07-23T23:20:51Z", "attachment_id": null}, {"count": 5, "tags": [], "text": "What is the configuration problem that you mention?  Please be specific.\n", "is_private": false, "bug_id": 1253, "id": 3967, "time": "2001-07-24T10:53:53Z", "creator": "pogo_tomcat@yahoo.com", "creation_time": "2001-07-24T10:53:53Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 1253, "is_private": false, "text": "Reopening - I still see this, and I don't think there is anything wrong with my \nconfig.  If there is, please respond to my above comments and explain what is \nwrong.\n", "id": 3968, "time": "2001-07-24T10:55:34Z", "creator": "pogo_tomcat@yahoo.com", "creation_time": "2001-07-24T10:55:34Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 1253, "text": "The error means the socket connection was broken. On tomcat standalone it can mean the user hit 'stop', interrupting the transfer. On apache+tomcat it can happen if the apache process is exiting. We can hide the message, but it's not a high priority. \n\nApache 1.3.x is exiting after a number of requests ( configurable ), and a fresh process is created. It is possible mod_jk is not closing the connection \n'properly' - but again that doesn't affect normal operation. \n\nI'll mark it as LATER, if someone sends a patch we can include it in 3.3.1 or a future release. Probably j-t-c will resolve this as part of refactoring and move to apr. ", "count": 7, "id": 6019, "time": "2001-09-25T13:22:55Z", "creator": "cmanolache@yahoo.com", "creation_time": "2001-09-25T13:22:55Z", "is_private": false}]