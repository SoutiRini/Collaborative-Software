[{"count": 0, "tags": [], "bug_id": 31268, "is_private": false, "text": "When testing a server, the \"Host:\" header can matter. I needed a way to\ndisconnect the target host as derived from the URL on the command line and the\n\"Host:\" header that ab sends.\n\nI wrote a patch against ab from 2.0.50 that adds a \"-F hostname\" option (which I\nwill attach once this ticket exists).\n\nSay I have a new server and want to see how it compares with an existing one\nwith a vhost named www.example.com. Rather than play with hosts files or DNS,\nthis patch allows you to test \"newbox\" by running:\n\nab -F newbox http://www.example.com/", "id": 63675, "time": "2004-09-16T19:42:14Z", "creator": "gauze@omnimental.tmetic.com", "creation_time": "2004-09-16T19:42:14Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 31268, "attachment_id": 12753, "text": "Created attachment 12753\npatch to add hostname override option to ab", "id": 63676, "time": "2004-09-16T19:48:02Z", "creator": "gauze@omnimental.tmetic.com", "creation_time": "2004-09-16T19:48:02Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "chip@force-elite.com", "is_private": false, "count": 2, "id": 63704, "time": "2004-09-17T04:49:19Z", "bug_id": 31268, "creation_time": "2004-09-17T04:49:19Z", "text": "This seems invalid to me.\n\nWe can send the Host: Header as part of the address... but specifying it again\nwith a special flag just seems wrong."}, {"attachment_id": null, "tags": [], "creator": "trawick@apache.org", "is_private": false, "count": 3, "id": 63723, "time": "2004-09-17T12:16:17Z", "bug_id": 31268, "creation_time": "2004-09-17T12:16:17Z", "text": "I've had to add same feature (host to connect to != host in Host request header\nfield) to specialized testing clients so that I could do some automated vhost\ntesting without hacking the system.\n\nAny other opinions from the crowd?"}, {"count": 4, "tags": [], "bug_id": 31268, "attachment_id": null, "text": "I also considered doing something along the lines of the enhancement request\n#26554 method for overriding the \"User-Agent:\" header. Maybe a better way?", "id": 63744, "time": "2004-09-17T16:19:25Z", "creator": "gauze@omnimental.tmetic.com", "creation_time": "2004-09-17T16:19:25Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 31268, "text": "hmm. Yes, I would condier a generic method to set any Header in a Key = Value\nFormat to be better than specific methods for each header.", "id": 63745, "time": "2004-09-17T16:24:23Z", "creator": "chip@force-elite.com", "creation_time": "2004-09-17T16:24:23Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 31268, "is_private": false, "text": "Created attachment 19526\nPatch to override headers using the existing -H option\n\nHave attached a patch using which one can override the value of the Host,\nUser-Agent and/or Accept header that ab tacks onto requests, by specifying an\nalternate value for the header using the existing -H option.", "id": 99008, "time": "2007-02-06T02:28:12Z", "creator": "arvind.srinivasan@sun.com", "creation_time": "2007-02-06T02:28:12Z", "attachment_id": 19526}, {"count": 7, "tags": [], "bug_id": 31268, "attachment_id": null, "is_private": false, "id": 99021, "time": "2007-02-06T08:35:53Z", "creator": "sander@temme.net", "creation_time": "2007-02-06T08:35:53Z", "text": "-1 on implementation, but +1 on concept. Arvind, I think your solution is pretty elegant, and am in \nfavor of using the existing -H option to override the headers in question. However, you are no longer \nsending the Accept: and User-Agent headers to POST Requests when they are not overridden. \n\nAlso, the logic regarding the overridable headers in the if (posting <= 0) block is hard to read because \nof the inversion (only print the headers when their opt_foo is NOT set). Perhaps you can pull the part \nwhere you construct these headers outside the if (posting <= 0) block (bonus: you avoid duplicating \nthe logic), use proper if () statements instead of the ? operator and put a comment on both branches of \nthe if() to tell the reader what is going on like /* Header not overridden, print default */ and /* Header \noverridden, no need to send because it is already in the hdrs string */. \n\nWould you like to fix the above and resubmit?"}, {"count": 8, "tags": [], "text": "\nThanks for your feedback. I'll address the issues you've pointed out and resubmit.", "is_private": false, "id": 99035, "creation_time": "2007-02-06T20:39:12Z", "time": "2007-02-06T20:39:12Z", "creator": "arvind.srinivasan@sun.com", "bug_id": 31268, "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 31268, "attachment_id": 19535, "is_private": false, "id": 99047, "time": "2007-02-07T02:06:00Z", "creator": "arvind.srinivasan@sun.com", "creation_time": "2007-02-07T02:06:00Z", "text": "Created attachment 19535\nRevised patch to override headers using the existing -H option\n\nThe attached patch address the following issues that were identified with the\nprevious revision of this patch:\n* POST requests send an Accept: and User-Agent: header when they are not\noverridden\n* Logic regarding the overrideable headers has been pulled outside the if\n(posting <= 0) block\n* Uses if () statements (with appropriate comments) instead of the ? operator"}, {"count": 10, "tags": [], "bug_id": 31268, "attachment_id": null, "is_private": false, "id": 99963, "time": "2007-03-01T23:22:41Z", "creator": "sander@temme.net", "creation_time": "2007-03-01T23:22:41Z", "text": "+1 to Arvind's revised patch. "}, {"count": 11, "tags": [], "bug_id": 31268, "attachment_id": null, "text": "Thanks for reviewing the patch Sander.\n\nThe patch also fixes http://issues.apache.org/bugzilla/show_bug.cgi?id=26554", "id": 100473, "time": "2007-03-16T06:32:44Z", "creator": "arvind.srinivasan@sun.com", "creation_time": "2007-03-16T06:32:44Z", "is_private": false}, {"count": 12, "tags": [], "text": "Committed in r526872. Thanks Arvind for your patch. ", "is_private": false, "id": 101537, "creation_time": "2007-04-09T11:52:20Z", "time": "2007-04-09T11:52:20Z", "creator": "sander@temme.net", "bug_id": 31268, "attachment_id": null}, {"count": 13, "tags": [], "bug_id": 31268, "attachment_id": null, "text": "Backported to 2.2.x as r660576 (http://svn.apache.org/viewvc?rev=660576&view=rev).", "id": 117054, "time": "2008-05-27T15:13:11Z", "creator": "rpluem@apache.org", "creation_time": "2008-05-27T15:13:11Z", "is_private": false}]