[{"count": 0, "tags": [], "bug_id": 57181, "attachment_id": null, "text": "Hi \n\nBelow is the code base to read xlsm file :\n\n             Sheet sheet = null;\n\t\ttry\n\t\t{\n\t\t\tbyte[] filedata = attachmentValue.getFileData();\n\t\t\tInputStream inputFileStream = new ByteArrayInputStream(filedata);\n\t         \n                        //Create Workbook instance for xlsm file input stream\n\t                 Workbook workbook = null;\n\t       \n                       if(attachmentValue.getFileName().toLowerCase().endsWith(\"xlsm\") ){\n\t                       workbook = new XSSFWorkbook(inputFileStream);\n\t                }\n\t        \n\t                  sheet = workbook.getSheetAt(0);\n\t\t}\n\t\tcatch (Exception e) {\n                }\n\n      \nThe above highlighted code is working fine with the xlsm file created with Microsoft Office 2010 but throwing below exception with Microsoft office 2007 :\n\n[11/3/14 23:09:26:424 SGT] 0000019e SystemErr     R org.apache.poi.POIXMLException: org.apache.poi.openxml4j.exceptions.InvalidFormatException: Package should contain a content type part [M1.13]\n[11/3/14 23:09:26:425 SGT] 0000019e SystemErr     R \tat org.apache.poi.util.PackageHelper.open(PackageHelper.java:41)\n[11/3/14 23:09:26:426 SGT] 0000019e SystemErr     R \tat org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:204)\n\nPlease suggest if anyone has identified & fixed same kind of issues.", "id": 178944, "time": "2014-11-04T11:17:05Z", "creator": "suyogkasawa2007@gmail.com", "creation_time": "2014-11-04T11:17:05Z", "is_private": false}, {"count": 1, "tags": [], "text": "3.9 is a little old, can you please re-test with 3.11 beta 2, or even better, a recent nightly build? (3.11 beta 3 should be out in a few days)", "is_private": false, "id": 178945, "creator": "apache@gagravarr.org", "time": "2014-11-04T11:20:07Z", "bug_id": 57181, "creation_time": "2014-11-04T11:20:07Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "suyogkasawa2007@gmail.com", "text": "Tried with poi-bin-3.10-FINAL, but getting same issue", "id": 178947, "time": "2014-11-04T11:30:23Z", "bug_id": 57181, "creation_time": "2014-11-04T11:30:23Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 57181, "is_private": false, "text": "xlsm files created with Microsoft 2010 are working fine but issue is with files created/updtaed on 2007.\n\nEven if we open the file in 2010 & just without any chnage, those are working fine", "id": 178948, "time": "2014-11-04T11:32:35Z", "creator": "suyogkasawa2007@gmail.com", "creation_time": "2014-11-04T11:32:35Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 57181, "attachment_id": null, "is_private": false, "id": 178949, "time": "2014-11-04T11:34:59Z", "creator": "suyogkasawa2007@gmail.com", "creation_time": "2014-11-04T11:34:59Z", "text": "xlsm files created with Microsoft 2010 are working fine but issue is with files created/updtaed on 2007.\n\nEven if we open the 2007 updtaed/creted file which is failling in 2010 & just save it without any chnage, those are working fine"}, {"count": 5, "tags": [], "bug_id": 57181, "attachment_id": null, "is_private": false, "id": 178950, "time": "2014-11-04T11:38:17Z", "creator": "apache@gagravarr.org", "creation_time": "2014-11-04T11:38:17Z", "text": "Try with a recent nightly build / build from svn?"}, {"count": 6, "tags": [], "creator": "dominik.stadler@gmx.at", "text": "Also can you attach two such files, one created with Excel 2007 and one with Excel 2010?", "id": 179012, "time": "2014-11-09T19:27:45Z", "bug_id": 57181, "creation_time": "2014-11-09T19:27:45Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 57181, "is_private": false, "text": "Hello,\nI read xlsm file properly but have the same problem when add \"Protect Workbook\" on Revision tab. I use 3.11 beta 3 version", "id": 179410, "time": "2014-12-01T17:06:15Z", "creator": "leleweb28@libero.it", "creation_time": "2014-12-01T17:06:15Z", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 57181, "text": "Created attachment 32946\nExample-File which fails to open", "id": 184234, "attachment_id": 32946, "creator": "x-mago@gmx.de", "creation_time": "2015-07-30T15:00:33Z", "time": "2015-07-30T15:00:33Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 57181, "attachment_id": null, "is_private": false, "id": 184235, "time": "2015-07-30T15:03:10Z", "creator": "x-mago@gmx.de", "creation_time": "2015-07-30T15:03:10Z", "text": "I am using POI 3.12.\n\nOpening attached File raises the following Exception.\n\norg.apache.poi.POIXMLException: java.lang.reflect.InvocationTargetException\nat org.apache.poi.xssf.usermodel.XSSFFactory.createDocumentPart(XSSFFactory.java:62)\nat org.apache.poi.POIXMLDocumentPart.read(POIXMLDocumentPart.java:456)\nat org.apache.poi.POIXMLDocumentPart.read(POIXMLDocumentPart.java:461)\nat org.apache.poi.POIXMLDocument.load(POIXMLDocument.java:162)\nat org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:271)"}, {"count": 10, "tags": [], "bug_id": 57181, "is_private": false, "text": "Can you try with 3.13 beta 1?", "id": 184236, "time": "2015-07-30T15:05:45Z", "creator": "apache@gagravarr.org", "creation_time": "2015-07-30T15:05:45Z", "attachment_id": null}, {"count": 11, "text": "Yes, I did.\n\nResulted basically in the same Exception.\n\norg.apache.poi.POIXMLException: java.lang.reflect.InvocationTargetException\n  at org.apache.poi.xssf.usermodel.XSSFFactory.createDocumentPart(XSSFFactory.java:62)\n  at org.apache.poi.POIXMLDocumentPart.read(POIXMLDocumentPart.java:456)\n  at org.apache.poi.POIXMLDocumentPart.read(POIXMLDocumentPart.java:461)\n  at org.apache.poi.POIXMLDocument.load(POIXMLDocument.java:163)\n  at org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:279)", "bug_id": 57181, "is_private": false, "id": 184237, "time": "2015-07-30T15:21:22Z", "creator": "x-mago@gmx.de", "creation_time": "2015-07-30T15:21:22Z", "tags": [], "attachment_id": null}, {"count": 12, "tags": [], "bug_id": 57181, "text": "I've just tried the attached file on trunk, and it opens just fine. Unit test which shows that added in r1693676. Do we need to do something different to what's in that unit test to trigger the problem? Or is it already fixed?", "id": 184263, "time": "2015-08-01T00:26:35Z", "creator": "apache@gagravarr.org", "creation_time": "2015-08-01T00:26:35Z", "is_private": false, "attachment_id": null}, {"count": 13, "tags": [], "text": "It works and has been my fault from the beginning.\nI did no included the ooxml-schemas lib.\nBut in my stack-trace I saw this hint not before I used the nightly.\nGoing back to 3.12 I fond out, that it opens xlsm well and I am able to access the content.\n\nThanks anyway!", "is_private": false, "id": 184283, "creator": "x-mago@gmx.de", "time": "2015-08-03T07:43:05Z", "bug_id": 57181, "creation_time": "2015-08-03T07:43:05Z", "attachment_id": null}]