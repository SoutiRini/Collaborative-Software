[{"count": 0, "attachment_id": null, "bug_id": 61991, "text": "This simple code:\n\n        FileInputStream fis = new FileInputStream(filename);\n        document = new XWPFDocument(fis);\n\nUsing Tiki the mime of the file being attempted:\n application/vnd.openxmlformats-officedocument.wordprocessingml.document\n\nGenerates:\nWARNING: An illegal reflective access operation has occurred\nWARNING: Illegal reflective access by org.apache.poi.openxml4j.util.ZipSecureFile$1 (file:/C:/javadev/workspace/poi-3.17/poi-ooxml-3.17.jar) to field java.io.FilterInputStream.in\nWARNING: Please consider reporting this to the maintainers of org.apache.poi.openxml4j.util.ZipSecureFile$1\nWARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations\nWARNING: All illegal access operations will be denied in a future release\n\n--> the blocker\njava.lang.NoSuchMethodException: org.openxmlformats.schemas.wordprocessingml.x2006.main.impl.CTPictureBaseImpl.<init>(org.apache.xmlbeans.SchemaType, boolean)\n\n\nJar files in use:\nPOI Core came from file:/C:/javadev/workspace/poi-3.17/poi-3.17.jar!/org/apache/poi/poifs/filesystem/POIFSFileSystem.class\nPOI OOXML came from file:/C:/javadev/workspace/poi-3.17/poi-ooxml-3.17.jar!/org/apache/poi/POIXMLDocument.class\nPOI Scratchpad came from file:/C:/javadev/workspace/poi-3.17/poi-scratchpad-3.17.jar!/org/apache/poi/hslf/usermodel/HSLFSlideShow.class\n\nI have tried work arounds nothing so far successful.  I've tried switching between JVMs 1.7,1.8,1.9. Looking for jar dependencies and tried different files.\n\nI am building / running in Eclipse version: Oxygen.2 Release (4.7.2) Build id: 20171218-0600\n\nLibraries on build path:\ndom4j-2.1.0.jar\npoi-3.17.jar\npoi-ooxml-3.17.jar\npoi-ooxml-schemas-3.17.jar\npoi-scratchpad-3.17.jar\nstax-api-1.0.1.jar\ntika-eval-1.17.jar\nxmlbeans-2.6.0.jar", "id": 203230, "time": "2018-01-11T23:43:44Z", "creator": "wcgrnway@cox.net", "creation_time": "2018-01-11T23:43:44Z", "tags": [], "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 61991, "is_private": false, "id": 203231, "time": "2018-01-12T00:02:21Z", "creator": "wcgrnway@cox.net", "creation_time": "2018-01-12T00:02:21Z", "tags": [], "text": "Many of the examples for OOXML (XWPFDocument) refer to version 3.9.  I gathered all the 3.9 jars, recompiled.  Code works."}, {"count": 2, "tags": [], "bug_id": 61991, "text": "For the Java 9 warning check [1] and add the addOpens & Co. to your java command.\nDon't use POI 3.9.\nThis basic example should work - for other cases try the full schema instead of poi-ooxml-schema.\n\n[1] http://poi.apache.org/faq.html#faq-N102B0", "id": 203232, "time": "2018-01-12T08:02:26Z", "creator": "kiwiwings@apache.org", "creation_time": "2018-01-12T08:02:26Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "\n\nI was able to get 3.17 to work by adding this to the VM Arguments page of the project:\n-Xmx1524m --add-modules=java.xml.bind --add-opens=java.xml/com.sun.org.apache.xerces.internal.util=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED -Duser.language=en -Duser.country=US -Djava9addmods=--add-modules=java.xml.bind -Djavadoc9addmods=--add-modules=java.xml.bind -Djava9addmodsvalue=-Dsun.reflect.debugModuleAccessChecks=true -Djava9addopens1=--add-opens=java.xml/com.sun.org.apache.xerces.internal.util=ALL-UNNAMED -Djava9addopens2=--add-opens=java.base/java.io=ALL-UNNAMED -Djava9addopens3=--add-opens=java.base/java.nio=ALL-UNNAMED -Djava9addopens4=--add-opens=java.base/java.lang=ALL-UNNAMED -Djava9addopens5=--add-opens=java.base/jdk.internal.ref=ALL-UNNAMED -Djava.locale.providers=JRE,CLDR -Dcoverage.enabled=true\n\nI also added the ooxml-schemas-1.3.jar to the classpath.\n\nIf the full version is necessary just to instantiate XWPFDocument, shouldn't it be a little easier to find (or included with the download)?", "is_private": false, "id": 203246, "creator": "wcgrnway@cox.net", "time": "2018-01-12T20:37:19Z", "bug_id": 61991, "creation_time": "2018-01-12T20:37:19Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 61991, "text": "(In reply to Will Greenway from comment #3)\n> If the full version is necessary just to instantiate XWPFDocument, shouldn't\n> it be a little easier to find (or included with the download)?\n\nAlmost all files should be processable by the standard \"minimum\" smaller poi-ooxml-schemas jar. However, there's always the odd one that uses something else...\n\nPlease see this FAQ for more details on the why, the how, and how to get the smaller schemas jar updated to handle your odd file: http://poi.apache.org/faq.html#faq-N10025", "id": 203251, "time": "2018-01-13T05:30:20Z", "creator": "apache@gagravarr.org", "creation_time": "2018-01-13T05:30:20Z", "is_private": false, "attachment_id": null}, {"count": 5, "attachment_id": null, "bug_id": 61991, "is_private": false, "id": 203413, "time": "2018-01-23T12:17:27Z", "creator": "fanningpj@yahoo.com", "creation_time": "2018-01-23T12:17:27Z", "tags": [], "text": "\n\n*** This bug has been marked as a duplicate of bug 61572 ***"}, {"count": 6, "attachment_id": null, "bug_id": 61991, "is_private": false, "id": 203431, "time": "2018-01-23T18:07:45Z", "creator": "tallison@mitre.org", "creation_time": "2018-01-23T18:07:45Z", "tags": [], "text": "Added triggering file from TIKA-2549 to include CTPictureBaseImpl in our smaller ooxml jar.\n\nr1822033"}, {"count": 7, "tags": [], "creator": "wcgrnway@cox.net", "attachment_id": null, "id": 203432, "time": "2018-01-23T18:13:28Z", "bug_id": 61991, "creation_time": "2018-01-23T18:13:28Z", "is_private": false, "text": "Wanted to add that the file I was reading that caused the issue was docx output from GoogleDocs, which I'd take to be fairly common."}, {"count": 8, "tags": [], "bug_id": 61991, "attachment_id": null, "id": 203433, "time": "2018-01-23T18:17:31Z", "creator": "tallison@mitre.org", "creation_time": "2018-01-23T18:17:31Z", "is_private": false, "text": "Interesting.  Note that the content was still extracted without exception, but the exception was logged.  Now we're good -- Java 9 aside. :)  Thank you!"}]