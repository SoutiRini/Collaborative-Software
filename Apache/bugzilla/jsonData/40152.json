[{"attachment_id": null, "tags": [], "bug_id": 40152, "is_private": false, "count": 0, "id": 91765, "time": "2006-08-01T13:54:59Z", "creator": "powell.hazzard@hp.com", "creation_time": "2006-08-01T13:54:59Z", "text": "Hello,\n\n   The RMIC task with Ant 1.7 appears to adds a default \"-vcompat\" option for \ncompatibility.  Since the default changed in Java 5.0 I can see where we might \nneed to add this option for compatibility; however when building IIOP stubs I \ndon't believe the \u201c-vcompat\" options should be supplied as a default.  If we \nsupply this option rmic attempts to build a JRMP stub and not an IIOP stub \nfile.\n \nExample:   While testing the Ant 1.7 against the jboss junit tests I came \nacross the following failure:\n...\n     [rmic] '-vcompat'\n     [rmic] '-iiop'\n     [rmic] '-g'\n     [rmic]\n     [rmic] The ' characters around the executable and arguments are\n     [rmic] not part of the command.\n     [rmic] Files to be compiled:    \norg.jboss.test.txpropiiop.interfaces.a.SessionA    \norg.jboss.test.txpropiiop.interfaces.a.Sessi\nonAHome    org.jboss.test.txpropiiop.interfaces.b.SessionB    \norg.jboss.test.txpropiiop.interfaces.b.SessionBHome\n     [rmic] error: org.jboss.test.txpropiiop.interfaces.b.SessionBHome is an \ninterface; stubs are needed only for remote object clas ses.\n...\n\n   \"-vcompat\" was not supplied during with Ant 1.6.5, and if I supply the \nfollowing patch to DefaultRmiAdapter.java, Ant 1.7 builds the rmi test stubs \ncorrectly.  This also continues to supply \u201c-vcompat\u201d as a default option if \u201c-\niiop\u201d is not supplied.\n\n# diff DefaultRmicAdapter.java_orig DefaultRmicAdapter.java > \nDefaultRmicAdapter.diffs\n# cat DefaultRmicAdapter.diffs\n209c209,210\n<         cmd.createArgument().setValue(stubOption);\n---\n>         if (stubVersion == null && !attributes.getIiop())\n>            cmd.createArgument().setValue(stubOption);\n\nNote: this is not specific to OpenVMS; I receive the same failures under \nWindows as well.\n\nBest Regards,\n\nPowell Hazzard\nHP Java Engineering"}, {"count": 1, "tags": [], "text": "I that added this. I did it because the switch to java1.5 was breaking things,\nas suddenly, silently, rmic wasnt creating backwards compatible bits. You dont\nfind out that you've stopped creating compatible stubs when \n\nNow, regarding the patch\n\n<         cmd.createArgument().setValue(stubOption);\n---\n>         if (stubVersion == null && !attributes.getIiop())\n>            cmd.createArgument().setValue(stubOption);\n\nUm, what happens if stubVersion!=null? Surely we'd actualy want the stub version\npeople asked for to be set.\n\nI will commit a patch that works, if it comes with\n -unit tests that fail before they are applied (antunit ones are good)\n -rmic tests that set a stub version and which don't fail when the patch goes in.\n\n-steve", "is_private": false, "bug_id": 40152, "id": 91834, "time": "2006-08-02T18:16:19Z", "creator": "stevel@apache.org", "creation_time": "2006-08-02T18:16:19Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 40152, "attachment_id": null, "text": "Steve,\n\n  You are right.  I will work up the -unit tests for the before and after.\n\nPowell", "id": 91836, "time": "2006-08-02T18:53:41Z", "creator": "powell.hazzard@hp.com", "creation_time": "2006-08-02T18:53:41Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 40152, "attachment_id": null, "text": "-idl should probably be treated the same way as -iiop", "id": 91994, "time": "2006-08-07T04:19:24Z", "creator": "bodewig@apache.org", "creation_time": "2006-08-07T04:19:24Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 40152, "is_private": false, "count": 4, "id": 92456, "time": "2006-08-23T10:40:16Z", "creator": "stevel@apache.org", "creation_time": "2006-08-23T10:40:16Z", "text": "Fixed in SVN_HEAD, with tests. Please check the 1.7beta when it comes out."}]