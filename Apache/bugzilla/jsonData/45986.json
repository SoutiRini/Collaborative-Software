[{"count": 0, "tags": [], "bug_id": 45986, "attachment_id": null, "is_private": false, "id": 121410, "time": "2008-10-10T08:24:43Z", "creator": "danielt@consol.de", "creation_time": "2008-10-10T08:24:43Z", "text": "Hello,\n\ntoday, I was debugging a CGI application, which after logging in, writes\nsome HTML data to the document root and redirects the client to it.\n\nBut the redirection was not successful, the request was answered with a\nclosed connection. The entire response was missing.\n\nSince this runs on a clustered environment (DocumentRoot is shared over\nNFS), I thought this was an NFS problem, because I could receive the\ncontent on the second server. Long story short, I was off the track.\n\nAfter I set the LogLevel to debug the following message appeared in the\nErrorLog:\n\n  [info] [client 160.xx.xx.xx] (22)Invalid argument: core_output_filter: writing data to the network\n\nI grepped the httpd source for this message to get an idea what's going\non here and found the FAQ entry. EnableSendfile Off, everything is fine\nnow.\n\nBut I really think that this should be at least an error instead of an\ninfo. httpd was not able to send the response, this is worse than \"file\nnot found\" which is logged as an error.\n\nHere is the patch:\n--- server/core.c.orig  2006-07-12 09:40:55.000000000 +0200\n+++ server/core.c       2008-10-10 17:21:36.000000000 +0200\n@@ -4327,7 +4327,7 @@\n         }\n \n         if (rv != APR_SUCCESS) {\n-            ap_log_cerror(APLOG_MARK, APLOG_INFO, rv, c,\n+            ap_log_cerror(APLOG_MARK, APLOG_ERR, rv, c,\n                           \"core_output_filter: writing data to the network\");\n \n             if (more)\n\nRegards,\nDanijel"}, {"count": 1, "tags": [], "creator": "covener@gmail.com", "attachment_id": null, "is_private": false, "id": 121411, "time": "2008-10-10T08:47:45Z", "bug_id": 45986, "creation_time": "2008-10-10T08:47:45Z", "text": "I'd rather see it trap the specific errno, because this looks like the same path as a host of normal client issues which I don't agree should be loglevel error."}, {"count": 2, "tags": [], "text": "Hm, I see the problem. I agree with Marc.\n\n       EAGAIN Non-blocking I/O has been  selected  using  O_NONBLOCK  and  the\n              write would block.\n\n       EBADF  The input file was not opened for reading or the output file was\n              not opened for writing.\n\n       EFAULT Bad address.\n\n       EINVAL Descriptor is not valid or locked, or an mmap(2)-like  operation\n              is not available for in_fd.\n\n       EIO    Unspecified error while reading from in_fd.\n\n       ENOMEM Insufficient memory to read from in_fd.\n\nThis are the errors sendfile could raise. At least an error should be\nlogged, if sendfile raises EIO, ENOMEN or EINVAL\n\nI'm not sure about about EFAULT, EBADF and EGAIN.\n", "attachment_id": null, "bug_id": 45986, "id": 121743, "time": "2008-10-21T12:15:47Z", "creator": "danielt@consol.de", "creation_time": "2008-10-21T12:15:47Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 45986, "attachment_id": null, "id": 121776, "time": "2008-10-22T06:45:29Z", "creator": "covener@gmail.com", "creation_time": "2008-10-22T06:45:29Z", "is_private": false, "text": "(In reply to comment #2)\n> Hm, I see the problem. I agree with Marc.\n\n> This are the errors sendfile could raise. At least an error should be\n> logged, if sendfile raises EIO, ENOMEN or EINVAL\n\n\nThis log message is not sendfile-specific, though."}]