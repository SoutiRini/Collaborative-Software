[{"count": 0, "tags": [], "creator": "mgarcia@uibuk.com", "attachment_id": null, "is_private": false, "id": 150815, "time": "2011-10-21T09:32:55Z", "bug_id": 52067, "creation_time": "2011-10-21T09:32:55Z", "text": "I have a worksheet with 2 sheets. In the 1st sheet i have the data and in the 2nd one a graph - i open it thru java and load data into 1st sheet and then i need to create some series in 2nd tab's graph dynamically depending on data.\n\nThe graph already have a dummy series - I need it to have setSeriesTitle working and I will delete it later.\n\nWhen I add a new series to the graph, it works fine. The problem is if I add more than one. My file gets corrupted and if I add 4 series to the graph it only displays 3...\n\nThis is my code:\n\nHSSFSeries series;\nint employeeGradedPercColumn=4;\nCellRangeAddress productsRange = new CellRangeAddress(rowStartingSecondReport+1, rowStartingSecondReport+totalProducts, 1, 1) ;            \nIterator<String> iterator = employeeSeriesHeader.iterator();\nwhile(iterator.hasNext()){            \t\n            \tseries = chart.createSeries();\n                series.setCategoryLabelsCellRange(productsRange) ;\n                series.setValuesCellRange( new CellRangeAddress( rowStartingSecondReport+1, rowStartingSecondReport+totalProducts, employeeGradedPercColumn, employeeGradedPercColumn)) ;\n                series.setSeriesTitle(iterator.next()); \n                employeeGradedPercColumn=employeeGradedPercColumn+2;                 \n            }\n\nThanks,\nMaria"}, {"count": 1, "tags": [], "text": "I'm seeing the exact same behavior using version 3.9.\nI create lots of series in a loop, using a pre-constructed excel file (template). When I open up the modified file in Excel, the charts shows series 1,2,3, then series 11,12,13, then 18,19,20. All other series are missing.\n\nCan someone please provide a solution or workaround?", "attachment_id": null, "bug_id": 52067, "id": 165038, "time": "2013-02-03T17:09:46Z", "creator": "s.boutsis@gmail.com", "creation_time": "2013-02-03T17:09:46Z", "is_private": false}, {"count": 2, "tags": [], "text": "I think I pinned down this bug. Reason is new series are cloned into sheet records one index too late.\n\nLines 1208~1209:\n/* next index in the records list where the new series can be inserted */\nidx = endSeriesRecordIdx + 1;\n\njust change idx to:\nidx = endSeriesRecordIdx;\n\nWorks for me. Unfortunately I am not able to provide test case covering this - bug shows only after opening file in Excel.", "attachment_id": null, "bug_id": 52067, "id": 165490, "time": "2013-02-26T14:32:35Z", "creator": "maciej.szatkowski@gmail.com", "creation_time": "2013-02-26T14:32:35Z", "is_private": false}]