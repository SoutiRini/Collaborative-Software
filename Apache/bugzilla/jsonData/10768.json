[{"count": 0, "tags": [], "bug_id": 10768, "attachment_id": null, "id": 19466, "time": "2002-07-13T08:40:08Z", "creator": "josmhinkle@netscape.net", "creation_time": "2002-07-13T08:40:08Z", "is_private": false, "text": "When the directive \"AddHandler cgi-script cgi\" is used, and presumably similar \nconstructions, matches will be made on filenames containing \".cgi\" and not just \nfiles with the extension \".cgi\" (or .pl, or other).\n\nThis was discovered when a CGI program was compiled from source named \n\"compiled.cgi.c\" and the executable output was \"compiled.cgi\".  When both are \nvisible on an index page delivered from Apache, clicking on \"compiled.cgi.c\" \nshould cause it to deliver a plain text document.  Instead, Apache attempts to \nrun it as a cgi program.\n\nThe compilation itself runs as expected because Apache properly delivers \n\"compiled.cgi\" to the handler.\n\nSomewhere (mod_mime ?) an improper match is made on file extensions.  I couldn't \nfind it myself."}, {"count": 1, "tags": [], "creator": "slive@apache.org", "attachment_id": null, "text": "An \"extension\" in apache is any period-delimited part of the filename after the\nfirst period.  So in one.two.three.four, all of two, three and four are\nextensions.\n\nThis is documented in the \"Files with multiple extensions\" section of\nhttp://httpd.apache.org/docs-2.0/mod/mod_mime.html\nand at\nhttp://httpd.apache.org/docs-2.0/mod/directive-dict.html#Syntax\nunder \"extension\".", "id": 19510, "time": "2002-07-14T22:40:06Z", "bug_id": 10768, "creation_time": "2002-07-14T22:40:06Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "josmhinkle@netscape.net", "is_private": false, "count": 2, "id": 19531, "time": "2002-07-15T04:26:30Z", "bug_id": 10768, "creation_time": "2002-07-15T04:26:30Z", "text": "Joshua Slive points out something missed.\n\nThe solution is to use the pattern matching capabilities of Apache:\n\n<Files ~ \"\\.cgi$\">\n   SetHandler cgi-script\n</Files>\n\ninstead of the \"AddHandler cgi-script .cgi\" as in the default configuration \nfile.\n\n"}, {"count": 3, "tags": [], "bug_id": 10768, "attachment_id": null, "id": 181055, "time": "2015-02-13T17:39:10Z", "creator": "apache@chrispennello.com", "creation_time": "2015-02-13T17:39:10Z", "is_private": false, "text": "Note that using the regular expression \"\\.cgi$\" to identify CGI scripts has the potentially unintended consequence of employing the cgi-script handler on the hidden file \".cgi\"."}]