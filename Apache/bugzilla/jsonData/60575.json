[{"count": 0, "tags": [], "bug_id": 60575, "text": "Created attachment 34610\nJMX\n\nWhen executing the attached JMX (one single HTTPS request), it works fine on JMeter 3.0 (with HttpClient 4.5.2, HttpCore 4.4.4). It fails with JMeter 3.1 (HttpClient 4.5.2, HttpCore 4.4.5), the server throws an Http 500 error.\n\nWorks fine with HttpClient 3.1 in both version, but it's an EOL client. Nothing shown in JMeter logs, from JMeter point of view everything is fine.", "id": 195988, "time": "2017-01-11T19:35:50Z", "creator": "loisel.jerome@gmail.com", "creation_time": "2017-01-11T19:35:50Z", "is_private": false, "attachment_id": 34610}, {"count": 1, "tags": [], "creator": "loisel.jerome@gmail.com", "attachment_id": null, "text": "The detailed stack on server side when running with JMeter 3.1: (although it doesn't help much)\n\n<html><head><title>Apache Tomcat/7.0.52 - Rapport d''erreur</title><style><!--H1 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:22px;} H2 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:16px;} H3 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:14px;} BODY {font-family:Tahoma,Arial,sans-serif;color:black;background-color:white;} B {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;} P {font-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:12px;}A {color : black;}A.name {color : black;}HR {color : #525D76;}--></style> </head><body><h1>Etat HTTP 500 - Unexpected exception occurred: runtime.support.UnimplementedMethodOptionException</h1><HR size=\"1\" noshade=\"noshade\"><p><b>type</b> Rapport d''exception</p><p><b>message</b> <u>Unexpected exception occurred: runtime.support.UnimplementedMethodOptionException</u></p><p><b>description</b> <u>Le serveur a rencontr\u00e9 une erreur interne qui l''a emp\u00each\u00e9 de satisfaire la requ\u00eate.</u></p><p><b>exception</b> <pre>runtime.support.InternalException: Unexpected exception occurred: runtime.support.UnimplementedMethodOptionException\n\tcom.pearson.powerschool.web.interceptor.LegacySystemInterceptor$ActionRunner.run(LegacySystemInterceptor.java:44)\n\tcom.pearson.powerschool.web.interceptor.LegacySystemHandler.runInHandler(LegacySystemHandler.java:34)\n\tcom.pearson.powerschool.web.interceptor.LegacySystemInterceptor.intercept(LegacySystemInterceptor.java:27)\n\tcom.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:244)\n\tcom.pearson.powerschool.web.interceptor.PowerSchoolEnabledInterceptor.intercept(PowerSchoolEnabledInterceptor.java:21)\n\tcom.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:244)\n\tcom.pearson.powerschool.web.interceptor.HttpHeadInterceptor.intercept(HttpHeadInterceptor.java:25)\n\tcom.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:244)\n\torg.apache.struts2.impl.StrutsActionProxy.execute(StrutsActionProxy.java:54)\n\torg.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:564)\n\torg.apache.struts2.dispatcher.ng.ExecuteOperations.executeAction(ExecuteOperations.java:81)\n\torg.apache.struts2.dispatcher.ng.filter.StrutsExecuteFilter.doFilter(StrutsExecuteFilter.java:93)\n\tcom.opensymphony.sitemesh.webapp.SiteMeshFilter.obtainContent(SiteMeshFilter.java:129)\n\tcom.opensymphony.sitemesh.webapp.SiteMeshFilter.doFilter(SiteMeshFilter.java:77)\n\tcom.pearson.powerschool.web.filter.PSSiteMeshFilter.doFilter(PSSiteMeshFilter.java:76)\n\torg.apache.struts2.dispatcher.ng.filter.StrutsPrepareFilter.doFilter(StrutsPrepareFilter.java:91)\n\tcom.pearson.powerschool.web.filter.LTKFilter.doFilterGuarded(LTKFilter.java:350)\n\tcom.pearson.powerschool.web.filter.LTKFilter.doFilter(LTKFilter.java:164)\n\tcom.pearson.powerschool.web.filter.ResponseTimeMonitorFilter.doFilter(ResponseTimeMonitorFilter.java:66)\n\tcom.pearson.powerschool.web.filter.PSSAMLDelegatingFilterProxy.doFilter(PSSAMLDelegatingFilterProxy.java:79)\n\tcom.pearson.powerschool.web.filter.CleanupFilter.doFilter(CleanupFilter.java:146)\n\tcom.pearson.powerschool.web.servlet.TrustedForwardedForResolutionFilter.doFilter(TrustedForwardedForResolutionFilter.java:328)\n\torg.apache.logging.log4j.web.Log4jServletFilter.doFilter(Log4jServletFilter.java:71)\n</pre></p><p><b>cause m\u00e8re</b> <pre>runtime.support.UnimplementedMethodOptionException: Unexpected call to WEB__ProcessUpload! ContentType=text/plain; charset=ISO-8859-1\n\tcom.pearson.powerschool.webserver.web.WEB__ProcessUpload.WEB__ProcessUpload(WEB__ProcessUpload.java:86)\n\tcom.pearson.powerschool.webserver.web.WEB_ReceiveMessageBody.WEB_ReceiveMessageBody(WEB_ReceiveMessageBody.java:176)\n\tcom.pearson.powerschool.web.interceptor.PublicInterceptor.intercept(PublicInterceptor.java:32)\n\tcom.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:244)\n\tcom.pearson.powerschool.web.interceptor.PageHitInterceptor.intercept(PageHitInterceptor.java:59)\n\tcom.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:244)\n\tcom.pearson.powerschool.web.interceptor.HandleHitInterceptor.intercept(HandleHitInterceptor.java:168)\n\tcom.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:244)\n\torg.apache.struts2.interceptor.FileUploadInterceptor.intercept(FileUploadInterceptor.java:253)\n\tcom.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:244)\n\tcom.pearson.powerschool.web.interceptor.LegacySystemInterceptor$ActionRunner.run(LegacySystemInterceptor.java:42)\n\tcom.pearson.powerschool.web.interceptor.LegacySystemHandler.runInHandler(LegacySystemHandler.java:34)\n\tcom.pearson.powerschool.web.interceptor.LegacySystemInterceptor.intercept(LegacySystemInterceptor.java:27)\n\tcom.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:244)\n\tcom.pearson.powerschool.web.interceptor.PowerSchoolEnabledInterceptor.intercept(PowerSchoolEnabledInterceptor.java:21)\n\tcom.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:244)\n\tcom.pearson.powerschool.web.interceptor.HttpHeadInterceptor.intercept(HttpHeadInterceptor.java:25)\n\tcom.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:244)\n\torg.apache.struts2.impl.StrutsActionProxy.execute(StrutsActionProxy.java:54)\n\torg.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:564)\n\torg.apache.struts2.dispatcher.ng.ExecuteOperations.executeAction(ExecuteOperations.java:81)\n\torg.apache.struts2.dispatcher.ng.filter.StrutsExecuteFilter.doFilter(StrutsExecuteFilter.java:93)\n\tcom.opensymphony.sitemesh.webapp.SiteMeshFilter.obtainContent(SiteMeshFilter.java:129)\n\tcom.opensymphony.sitemesh.webapp.SiteMeshFilter.doFilter(SiteMeshFilter.java:77)\n\tcom.pearson.powerschool.web.filter.PSSiteMeshFilter.doFilter(PSSiteMeshFilter.java:76)\n\torg.apache.struts2.dispatcher.ng.filter.StrutsPrepareFilter.doFilter(StrutsPrepareFilter.java:91)\n\tcom.pearson.powerschool.web.filter.LTKFilter.doFilterGuarded(LTKFilter.java:350)\n\tcom.pearson.powerschool.web.filter.LTKFilter.doFilter(LTKFilter.java:164)\n\tcom.pearson.powerschool.web.filter.ResponseTimeMonitorFilter.doFilter(ResponseTimeMonitorFilter.java:66)\n\tcom.pearson.powerschool.web.filter.PSSAMLDelegatingFilterProxy.doFilter(PSSAMLDelegatingFilterProxy.java:79)\n\tcom.pearson.powerschool.web.filter.CleanupFilter.doFilter(CleanupFilter.java:146)\n\tcom.pearson.powerschool.web.servlet.TrustedForwardedForResolutionFilter.doFilter(TrustedForwardedForResolutionFilter.java:328)\n\torg.apache.logging.log4j.web.Log4jServletFilter.doFilter(Log4jServletFilter.java:71)\n</pre></p><p><b>note</b> <u>La trace compl\u00e8te de la cause m\u00e8re de cette erreur est disponible dans les fichiers journaux de Apache Tomcat/7.0.52.</u></p><HR size=\"1\" noshade=\"noshade\"><h3>Apache Tomcat/7.0.52</h3></body></html>", "id": 195989, "time": "2017-01-11T19:41:00Z", "bug_id": 60575, "creation_time": "2017-01-11T19:41:00Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 60575, "text": "Hello J\u00e9r\u00f4me,\nCould you add in user.properties:\n\nlog_level.org.apache.http.wire=ERROR\nlog_level.org.apache.http=DEBUG\n\nWith each version and attach jmeter.log file for each version ?\nThank you", "id": 195990, "time": "2017-01-11T19:45:28Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2017-01-11T19:45:28Z", "is_private": false, "attachment_id": null}, {"count": 3, "text": "I think I got the issue: JMeter 3.1 has added support for GET request body. It seems like it's sending a get body, even if none have been set. By simply adding a GET parameter name=value, it works again.\n\nSo the bug is linked to GET request body support.", "bug_id": 60575, "attachment_id": null, "id": 195991, "time": "2017-01-11T19:46:45Z", "creator": "loisel.jerome@gmail.com", "creation_time": "2017-01-11T19:46:45Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 60575, "text": "Got a little further, found this in the jmx:\n<boolProp name=\"HTTPSampler.postBodyRaw\">true</boolProp>\n\nPossibly my mistake, I had body data field tab open in the request, with nothing set.", "id": 195993, "time": "2017-01-11T19:51:51Z", "creator": "loisel.jerome@gmail.com", "creation_time": "2017-01-11T19:51:51Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 60575, "text": "Closing as invalid, since it's a misconfiguration i've made, not a JMeter bug. :)", "id": 195995, "time": "2017-01-11T20:13:27Z", "creator": "loisel.jerome@gmail.com", "creation_time": "2017-01-11T20:13:27Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 60575, "text": "Reopening since the issue is not resolved. It still happens with the following JMX. It contains the request both with and without a dummy http query parameter.\n\nWhen the query parameter is absent, a get body is sent to the server which doesn't expect this. The server fails and throws an exception, because it doesn't support GET request body. (Tomcat 7.0.52)", "id": 196014, "time": "2017-01-12T12:07:05Z", "creator": "loisel.jerome@gmail.com", "creation_time": "2017-01-12T12:07:05Z", "is_private": false, "attachment_id": null}, {"count": 7, "attachment_id": 34614, "creator": "loisel.jerome@gmail.com", "is_private": false, "id": 196015, "time": "2017-01-12T12:09:21Z", "bug_id": 60575, "creation_time": "2017-01-12T12:09:21Z", "tags": [], "text": "Created attachment 34614\nJMX showing the error\n\nJMX reproducing the error. It seems that JMeter is always sending a GET request body (even when empty) for GET requests without parameters."}, {"count": 8, "tags": [], "bug_id": 60575, "text": "*** Bug 60579 has been marked as a duplicate of this bug. ***", "id": 196026, "time": "2017-01-12T14:26:40Z", "creator": "felix.schumacher@internetallee.de", "creation_time": "2017-01-12T14:26:40Z", "is_private": false, "attachment_id": null}, {"count": 9, "attachment_id": 34617, "creator": "felix.schumacher@internetallee.de", "is_private": false, "id": 196027, "time": "2017-01-12T14:28:51Z", "bug_id": 60575, "creation_time": "2017-01-12T14:28:51Z", "tags": [], "text": "Created attachment 34617\nOnly send Parameters as Post-Body, if there are Parameters"}, {"count": 10, "tags": [], "bug_id": 60575, "text": "Thanks Felix for the patch :)\n\nIs there any release date for JMeter 3.2 which includes this patch?", "id": 196031, "time": "2017-01-12T14:47:40Z", "creator": "loisel.jerome@gmail.com", "creation_time": "2017-01-12T14:47:40Z", "is_private": false, "attachment_id": null}, {"count": 11, "tags": [], "creator": "felix.schumacher@internetallee.de", "attachment_id": null, "text": "Discussion about the next release is taking place on the mailing list, it could be soon.\n\nOn the other hand, the patch makes one test (PutWriterTest) fail. I believe the test is not correct and I think it uncovers a problem in PutWriter#setHeaders.\n\nThere it tests for sampler.getSendParameterValuesAsPostBody() and assumes that there are arguments in the sampler - which is not true for the cited test above. That path of code will lead to a Content-Type header with no body (which is probably wrong even for a PUT request.).", "id": 196062, "time": "2017-01-13T17:48:08Z", "bug_id": 60575, "creation_time": "2017-01-13T17:48:08Z", "is_private": false}, {"count": 12, "tags": [], "bug_id": 60575, "text": "Hi Felix,\nCould you merge your patch so that we test as much as possible before release?\nThanks", "id": 196176, "time": "2017-01-19T06:38:18Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2017-01-19T06:38:18Z", "is_private": false, "attachment_id": null}, {"count": 13, "text": "Date: Thu Jan 19 20:19:57 2017\nNew Revision: 1779520\n\nURL: http://svn.apache.org/viewvc?rev=1779520&view=rev\nLog:\nSplit up test case to test only one thing at a time. Correct the second\ntest case at the same time. PutWriter would use all unnamed arguments for\nthe body of the request, so set them. This is in preparation for Bug 60575.\n\nBugzilla Id: 60575\n\nModified:\n    jmeter/trunk/test/src/org/apache/jmeter/protocol/http/sampler/PutWriterTest.java", "bug_id": 60575, "attachment_id": null, "id": 196211, "time": "2017-01-19T20:25:05Z", "creator": "felix.schumacher@internetallee.de", "creation_time": "2017-01-19T20:25:05Z", "tags": [], "is_private": false}, {"count": 14, "attachment_id": null, "creator": "felix.schumacher@internetallee.de", "is_private": false, "id": 196212, "time": "2017-01-19T20:39:10Z", "bug_id": 60575, "creation_time": "2017-01-19T20:39:10Z", "tags": [], "text": "Date: Thu Jan 19 20:35:15 2017\nNew Revision: 1779521\n\nURL: http://svn.apache.org/viewvc?rev=1779521&view=rev\nLog:\nClarify and correct logic of getSendParameterValuesAsPostBody, so that it only\nreturns true, when there are parameters and none of those have a name.\n\nWithout this requests could have a content-type header without a body.\n\nBugzilla Id: 60575\n\nModified:\n    jmeter/trunk/src/protocol/http/org/apache/jmeter/protocol/http/sampler/HTTPSamplerBase.java"}, {"count": 15, "attachment_id": null, "bug_id": 60575, "text": "\nCan you test a current nightly (well, the one from next night) and report, if it solves your problem? If so, please close this bug.", "id": 196213, "time": "2017-01-19T20:41:33Z", "creator": "felix.schumacher@internetallee.de", "creation_time": "2017-01-19T20:41:33Z", "tags": [], "is_private": false}, {"count": 16, "attachment_id": null, "creator": "loisel.jerome@gmail.com", "is_private": false, "id": 196233, "time": "2017-01-20T08:27:52Z", "bug_id": 60575, "creation_time": "2017-01-20T08:27:52Z", "tags": [], "text": "Hi, tested nightly svn revision r1779529: it works fine now. Thanks for the fix :)"}, {"count": 17, "tags": [], "creator": "felix.schumacher@internetallee.de", "attachment_id": null, "text": "Date: Fri Jan 20 18:17:01 2017\nNew Revision: 1779663\n\nURL: http://svn.apache.org/viewvc?rev=1779663&view=rev\nLog:\nAdd changes.xml entry for bug 60575\n\nModified:\n    jmeter/trunk/xdocs/changes.xml", "id": 196253, "time": "2017-01-20T18:19:01Z", "bug_id": 60575, "creation_time": "2017-01-20T18:19:01Z", "is_private": false}, {"count": 18, "attachment_id": null, "creator": "luborpetr@gmail.com", "is_private": false, "id": 196664, "time": "2017-02-02T10:44:40Z", "bug_id": 60575, "creation_time": "2017-02-02T10:44:40Z", "tags": [], "text": "Hello,\n\nI see regression of the issue in latest Jenkins build #5787 - JMeter r1781326.\n\n\nSee example:\nGET https://www.google.com/\n\nGET data:\n\n[no cookies]\n\nRequest Headers:\nConnection: keep-alive\nHost: www.google.com\nUser-Agent: Apache-HttpClient/4.5.3 (Java/1.8.0_111)"}, {"count": 19, "attachment_id": null, "creator": "felix.schumacher@internetallee.de", "is_private": false, "id": 196688, "time": "2017-02-03T16:25:10Z", "bug_id": 60575, "creation_time": "2017-02-03T16:25:10Z", "tags": [], "text": "(In reply to lpetr from comment #18)\n> Hello,\n> \n> I see regression of the issue in latest Jenkins build #5787 - JMeter\n> r1781326.\n> \n> \n> See example:\n> GET https://www.google.com/\n> \n> GET data:\n> \n> [no cookies]\n> \n> Request Headers:\n> Connection: keep-alive\n> Host: www.google.com\n> User-Agent: Apache-HttpClient/4.5.3 (Java/1.8.0_111)\n\nCan you be a bit more specific, what you are expecting and what you think fails?\n\nI have no problem doing a get request on Google."}, {"count": 20, "attachment_id": null, "creator": "p.mouawad@ubik-ingenierie.com", "is_private": false, "id": 196726, "time": "2017-02-04T20:52:50Z", "bug_id": 60575, "creation_time": "2017-02-04T20:52:50Z", "tags": [], "text": "*** Bug 60682 has been marked as a duplicate of this bug. ***"}, {"count": 21, "tags": [], "creator": "luborpetr@gmail.com", "attachment_id": null, "text": "Hello,\n\nAs I explained in the ticket #60579 (which was linked to this issue as duplicate), since JMeter 3.1 \"HTTP request\" sampler adds unnecessary \"Content-Type: text/plain; charset=ISO-8859-1\" header into GET requests which has NO DATA in body.\nIt could cause request rejection on FW, because it's considered malicious.\n\n\nRFC2616 section 7.2.1 says:\n\n\"A Content-Type specifies the media type of the underlying data. A Content-Encoding may be used to indicate any additional content coding applied to the type, usually for the purpose of data compression, that is a property of the resource requested. The default for the content encoding is none (i.e., the identity function).\"\n\nIf my understanding is correct, the header \"Content-Type\" should not be present for simple GET requests without \"entity-body\", because there are no \"underlying data\".\n\n\nHere are GET requests to google for simple comparison of JMeter 3.0 and JMeter 3.1 behavior:\n\n------\nBehavior of the JMeter 3.0 HTTP Sampler (NO content type and length header -  expected):\n------\nGET https://google.com/\n\n[no cookies]\n\nRequest Headers:\nConnection: keep-alive\nHost: google.com\nUser-Agent: Apache-HttpClient/4.5.2 (Java/1.8.0_111)\n\n\n-----\nBehavior of the JMeter 3.1 HTTP Sampler (Content type header send - possible problem):\n-----\nGET http://www.google.com/\n\nGET data:\n[no cookies]\n\nRequest Headers:\nConnection: keep-alive\nContent-Length: 0\nContent-Type: text/plain; charset=ISO-8859-1\nHost: www.google.com\nUser-Agent: Apache-HttpClient/4.5.2 (Java/1.8.0_111)", "id": 196737, "time": "2017-02-05T18:43:03Z", "bug_id": 60575, "creation_time": "2017-02-05T18:43:03Z", "is_private": false}, {"count": 22, "attachment_id": null, "bug_id": 60575, "text": "Hello,\n\n\nI did a retest with build #5796 and it works as expected! \nYou can ignore my previous comments #18, #21..\n\nThanks for support!", "id": 196738, "time": "2017-02-05T19:11:10Z", "creator": "luborpetr@gmail.com", "creation_time": "2017-02-05T19:11:10Z", "tags": [], "is_private": false}, {"count": 23, "attachment_id": null, "bug_id": 60575, "text": "*** Bug 60941 has been marked as a duplicate of this bug. ***", "id": 198081, "time": "2017-03-30T13:44:19Z", "creator": "support@ubikloadpack.com", "creation_time": "2017-03-30T13:44:19Z", "tags": [], "is_private": false}]