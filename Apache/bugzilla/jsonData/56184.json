[{"count": 0, "tags": [], "creator": "gkislin@yandex.ru", "text": "Also tested at Tomcat 8.03\n\nIn apache-tomcat-7.0.50 I've changed connector according http://blog.yamanyar.com/2013/09/dont-forget-to-use-nio-if-you-are-doing.html\n\nAsync servlet is very simple:\n\n@WebServlet(asyncSupported = true, value = \"/sendMailAsync\")\npublic class SendMailServletAsync extends SendMailServlet {\n\nprivate static final ExecutorService EXE = Executors.newFixedThreadPool(500);\n\n@Override\nprotected void doProcess(HttpServletRequest request, HttpServletResponse response, Map<String, String> params) throws IOException, ServletException {\n    final AsyncContext ac = request.startAsync(); // obtain async context\n    Runnable worker = new Runnable() {\n        @Override\n        public void run() {\n            try {\n                Thread.sleep(5000);   // wait 5 sec\n                logger.info(\"Finish\");\n            } catch (Exception e) {\n                logger.error(\"Exception during process async request\", e);\n            } finally {\n                ac.complete();\n            }\n        }\n    };\n\n    EXE.execute(worker);\n    logger.info(\"Async request in progress\");\n}\n\nTest was done by apache ab\n\nResults for sync and async servlets is the same:\n\nRequests per second:    19.68 [#/sec] (mean)", "id": 173457, "time": "2014-02-24T22:10:32Z", "bug_id": 56184, "creation_time": "2014-02-24T22:10:32Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "gkislin@yandex.ru", "is_private": false, "text": "Sorry, performance depends of ab concurrency level\nab -n 1000 -c 100 http://127.0.0.1:8080/web/sendMailAsync give ~20r/s\nab -n 1000 -c 500 http://127.0.0.1:8080/web/sendMailAsync give ~100r/s", "id": 173459, "time": "2014-02-25T06:55:56Z", "bug_id": 56184, "creation_time": "2014-02-25T06:55:56Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "gkislin@yandex.ru", "text": "My test show that Async servlet performance depends mostly of thread pool size and could be achieved by configuring \nExecutor name=\"tomcatThreadPool\" and\n\nConnector executor=\"tomcatThreadPool\"\n\nSo, async servlet is useful only for Commet, if for long calculation we could just configure tomcatThreadPool?", "id": 173460, "time": "2014-02-25T07:00:24Z", "bug_id": 56184, "creation_time": "2014-02-25T07:00:24Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "Bugzilla is not a support forum. Please use the Apache Tomcat users mailing lists if you require help understanding how Servlet async processing works.", "attachment_id": null, "id": 173462, "creation_time": "2014-02-25T08:17:41Z", "time": "2014-02-25T08:17:41Z", "creator": "markt@apache.org", "bug_id": 56184, "is_private": false}]