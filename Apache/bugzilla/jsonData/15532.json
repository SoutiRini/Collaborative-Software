[{"count": 0, "tags": [], "bug_id": 15532, "text": "Ajp13 does not always contain the correct server name. Tomcat version\nis 3.3.1.\n\nAccording to the Servlet API specification\nServletRequest#getServerName() should return the same value as the CGI\nenvironment variable SERVER_NAME.\n\nThis is not the case if Tomcat is used with mod_jk and the Apache has\na special server name set with the \"ServerName\" directive and\n\"UseCanonicalName on\":\n\n* The Ajp13 request does not contain this server name. Instead\n  it always includes the name given in the \"Host\" HTTP header of\n  the original request, which is then returned by getServerName().\n\n* A CGI script executed by this Apache does get the correct\n  SERVER_NAME, though.\n\nThe bug is that mod_jk.c does not use the server name in Ajp13\nrequests as determined by the web server.\n\nI haven't tried it but propably the fix is to\nreplace mod_jk.c:431\n\n    s->server_name  = (char *)(r->hostname ? r->hostname :\n          r->server->server_hostname);\n\nby \n\n   s->server_name = app_get_server_name(r);", "id": 28056, "time": "2002-12-19T14:51:17Z", "creator": "olaf.jahn@zamioculcas.net", "creation_time": "2002-12-19T14:51:17Z", "is_private": false, "attachment_id": null}, {"count": 1, "attachment_id": null, "bug_id": 15532, "is_private": false, "id": 28057, "time": "2002-12-19T15:23:14Z", "creator": "hgomez@apache.org", "creation_time": "2002-12-19T15:23:14Z", "tags": [], "text": "Fixed since JK 1.2.1, just get the updated release"}]