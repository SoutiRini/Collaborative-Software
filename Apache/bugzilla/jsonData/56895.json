[{"count": 0, "tags": [], "bug_id": 56895, "attachment_id": null, "id": 177411, "time": "2014-08-27T22:43:50Z", "creator": "lucastheisen@apache.org", "creation_time": "2014-08-27T22:43:50Z", "is_private": false, "text": "When composing JAVA_OPTS, the current bat script uses this approach:\n\nset JAVA_OPTS=%JAVA_OPTS% %OTHER_STUFF%\n\nHowever, this leads to issues if the existing JAVA_OPTS had some sort of escape sequence in it.  For example, in my setenv.bat, I add some proxy info:\n\nSET \"JAVA_OPTS=-Dhttp.proxyHost=myproxy.localdomain -Dhttp.nonProxyHosts=*.localdomain^|localhost^|appserver.localdomain\"\n\nUsing the existing approach, the escape sequence ^| gets processed into | leaving the next evaluation to treat it as a command pipe, which causes immediate failure.\n\nIf instead you use this approach:\n\nset \"JAVA_OPTS=%JAVA_OPTS% %OTHER_STUFF%\"\n\nThen those escape sequences are preserved.  Here is the patch for version 7.0.54:\n\n--- catalina.bat_ORIGINAL       2014-08-27 18:37:05.173641700 -0400\n+++ catalina.bat        2014-08-27 18:06:22.779721000 -0400\n@@ -176,12 +176,12 @@\n if not exist \"%CATALINA_BASE%\\conf\\logging.properties\" goto noJuliConfig\n set LOGGING_CONFIG=-Djava.util.logging.config.file=\"%CATALINA_BASE%\\conf\\logging.properties\"\n :noJuliConfig\n-set JAVA_OPTS=%JAVA_OPTS% %LOGGING_CONFIG%\n+set \"JAVA_OPTS=%JAVA_OPTS% %LOGGING_CONFIG%\"\n\n if not \"%LOGGING_MANAGER%\" == \"\" goto noJuliManager\n set LOGGING_MANAGER=-Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager\n :noJuliManager\n-set JAVA_OPTS=%JAVA_OPTS% %LOGGING_MANAGER%\n+set \"JAVA_OPTS=%JAVA_OPTS% %LOGGING_MANAGER%\"\n\n rem ----- Execute The Requested Command ---------------------------------------"}, {"count": 1, "tags": [], "text": "Fixed in 8.0.x for 8.0.12 onwards and in 7.0.x for 7.0.56 onwards.", "attachment_id": null, "id": 177512, "creator": "markt@apache.org", "time": "2014-09-03T14:11:08Z", "bug_id": 56895, "creation_time": "2014-09-03T14:11:08Z", "is_private": false}, {"count": 2, "tags": [], "text": "(In reply to Mark Thomas from comment #1)\n> Fixed in 8.0.x for 8.0.12 onwards and in 7.0.x for 7.0.56 onwards.\n\nFTR, 8.0.12 was already released at the moment the patch is applied. 8.0.13 iz skipped, therefore, it is 8.0.14 onwards.\n\n-Ognjen", "is_private": false, "id": 178252, "creator": "ognjen.d.blagojevic@gmail.com", "time": "2014-10-03T07:15:01Z", "bug_id": 56895, "creation_time": "2014-10-03T07:15:01Z", "attachment_id": null}]