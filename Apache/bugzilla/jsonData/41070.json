[{"count": 0, "tags": [], "bug_id": 41070, "text": "I am deploying updated war file of my web application to test using samba (copy\nwar to /webapps) and it takes few seconds to write the file.\nOften, tomcat tries to read the file while it is not fully written yet and so\nreceives errors, like the next:\nNov 29, 2006 2:02:16 PM org.apache.catalina.startup.HostConfig checkResources\nINFO: Undeploying context [/upm55]\nNov 29, 2006 2:02:17 PM org.apache.catalina.startup.HostConfig deployWAR\nINFO: Deploying web application archive upm55.war\nNov 29, 2006 2:02:17 PM org.apache.catalina.startup.ContextConfig init\nSEVERE: Exception fixing docBase: {0} \njava.util.zip.ZipException: error in opening zip file\n\tat java.util.zip.ZipFile.open(Native Method)\n\tat java.util.zip.ZipFile.<init>(ZipFile.java:203)\n\tat java.util.jar.JarFile.<init>(JarFile.java:132)\n\tat java.util.jar.JarFile.<init>(JarFile.java:70)\n\tat sun.net.www.protocol.jar.URLJarFile.<init>(URLJarFile.java:56)\n\tat sun.net.www.protocol.jar.URLJarFile.getJarFile(URLJarFile.java:41)\n\tat sun.net.www.protocol.jar.JarFileFactory.get(JarFileFactory.java:68)\n\tat sun.net.www.protocol.jar.JarURLConnection.connect(JarURLConnection.java:102)\n\tat sun.net.www.protocol.jar.JarURLConnection.getJarFile(JarURLConnection.java:69)\n\tat org.apache.catalina.startup.ExpandWar.expand(ExpandWar.java:140)\n\tat org.apache.catalina.startup.ContextConfig.fixDocBase(ContextConfig.java:869)\n\tat org.apache.catalina.startup.ContextConfig.init(ContextConfig.java:987)\n\tat org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:278)\n\tat\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n\tat org.apache.catalina.core.StandardContext.init(StandardContext.java:5066)\n\tat org.apache.catalina.core.StandardContext.start(StandardContext.java:3979)\n\tat org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:759)\n\tat org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:739)\n\tat org.apache.catalina.core.StandardHost.addChild(StandardHost.java:524)\n\tat org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:809)\n\tat org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:698)\n\tat org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:472)\n\tat org.apache.catalina.startup.HostConfig.check(HostConfig.java:1190)\n\tat org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:292)\n\tat\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n\tat\norg.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1305)\n\tat\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1569)\n\tat\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1578)\n\tat\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1558)\n\tat java.lang.Thread.run(Thread.java:595)\nNov 29, 2006 2:02:17 PM org.apache.catalina.core.StandardContext resourcesStart\nSEVERE: Error starting static Resources\njava.lang.IllegalArgumentException: Invalid or unreadable WAR file : error in\nopening zip file\n\tat org.apache.naming.resources.WARDirContext.setDocBase(WARDirContext.java:134)\n\tat\norg.apache.catalina.core.StandardContext.resourcesStart(StandardContext.java:3848)\n\tat org.apache.catalina.core.StandardContext.start(StandardContext.java:4019)\n\tat org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:759)\n\tat org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:739)\n\tat org.apache.catalina.core.StandardHost.addChild(StandardHost.java:524)\n\tat org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:809)\n\tat org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:698)\n\tat org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:472)\n\tat org.apache.catalina.startup.HostConfig.check(HostConfig.java:1190)\n\tat org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:292)\n\tat\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n\tat\norg.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1305)\n\tat\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1569)\n\tat\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1578)\n\tat\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1558)\n\tat java.lang.Thread.run(Thread.java:595)\nNov 29, 2006 2:02:17 PM org.apache.catalina.core.StandardContext start\nSEVERE: Error in resourceStart()\nNov 29, 2006 2:02:17 PM org.apache.catalina.core.StandardContext start\nSEVERE: Error getConfigured\nNov 29, 2006 2:02:17 PM org.apache.catalina.core.StandardContext start\nSEVERE: Context [/upm55] startup failed due to previous errors\nNov 29, 2006 2:02:17 PM org.apache.catalina.core.StandardContext stop\nINFO: Container\norg.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/upm55] has not\nbeen started\n\nAlso to be noted, it does not undeploy the application that failed to deploy and\nany try to start it gives you different errors.", "id": 96341, "attachment_id": null, "creator": "tivv@gtech-ua.com", "creation_time": "2006-11-29T04:16:50Z", "time": "2006-11-29T04:16:50Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 41070, "text": "There are already several mechanisms you could use to prevent this:\n- use the manager to deploy your app\n- remove the app from the deployer's control via JMX during update\n- mark the app as being serviced via JMX during update\n\nTomcat could do better in the circumstances you describe but there are plenty of\nalternative approaches that would achieve the desired result. I am therefore\nmarking this as an enhancement request. I suspect there won't be much interest,\nparticularly without a patch.", "id": 96446, "time": "2006-11-30T17:15:08Z", "creator": "markt@apache.org", "creation_time": "2006-11-30T17:15:08Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "yoavs@computer.org", "text": "I'm interpreting the lack of response as lack of interest or as happiness with\nthe alternatives mark suggested.", "count": 2, "id": 100888, "time": "2007-03-25T09:22:25Z", "bug_id": 41070, "creation_time": "2007-03-25T09:22:25Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 41070, "attachment_id": null, "is_private": false, "id": 100950, "time": "2007-03-26T01:49:41Z", "creator": "tivv@gtech-ua.com", "creation_time": "2007-03-26T01:49:41Z", "text": "I'd leave it open. Simply because It's a bug. Yes it has workarounds, but It\nleaves it a bug."}, {"count": 4, "attachment_id": null, "creator": "yoavs@computer.org", "text": "Please understand that WONTFIX means WONTFIX.  The ONLY impact of leaving a\nWONTFIX bug open is a delay in fixing other bugs.", "id": 100955, "time": "2007-03-26T04:00:57Z", "bug_id": 41070, "creation_time": "2007-03-26T04:00:57Z", "tags": [], "is_private": false}]