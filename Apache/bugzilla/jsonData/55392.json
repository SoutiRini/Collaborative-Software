[{"count": 0, "tags": [], "bug_id": 55392, "is_private": false, "text": "Prequisites:\nmod_vhost_alias is enabled\nmod_access is enabled\n\nI have 1 virtualhost config in my sites-enabled:\nsites-enabled/[000-site.conf -> ../sites-available/000-site.conf]\n\nMy apache.conf is configured as such:\n#\n#\n#\n<Directory />\n  # default config\n  Options none\n  AllowOverride none\n  Require all denied\n</Directory>\n\n#\n# Commented out.\n# I've normally disabled the default document root\n# in Apache 2.2 and below so vhosts can't see each other.\n#\n#<Directory /var/www>\n#  Options all\n#  AllowOverride all\n#  Require all granted\n#</Directory>\n\n\n\nMy 1 virtualhost container (000-site.conf) is configured as such:\n<VirtualHost *:80>\n\tUseCanonicalName Off\n\tServerName server.com\n\tServerAlias *.server.com\n\tVirtualDocumentRoot /var/www/%0/public\n\t \n  <Directory /var/www/%0/public>\n\t\tRequire all granted\n  </Directory>\n</VirtualHost>\n\n\nThe default directory configuration denies requests to the virtual host.\nEven <Directory /var/www/%0>Require all granted</Directory> fails.\n\nTo test this, configure as described. My test below assumes a subfolder exists in the following layout:\n/var/www/something.server.com/public\n\n\nFrom your cli:\ncurl something.server.com\n\nResult:\nHTTP/1.1 403 FORBIDDEN\n\nExpected:\nHTTP/1.1 200 OK\n\nTake a peek at error.log:\n[Thu Aug 08 03:49:22.018179 2013] [access_compat:error] [pid 13791] [client 127.0.0.1:57471] AH01797: client denied by server configuration: /var/www/something.server.com/public/\n\n\nAdding the default directory back into apache.conf and changing the access requirement fixes the problem.\napache.conf\n+ <Directory /var/www>\n+  Require all granted\n+ </Directory>\n\nsudo service apache2 restart\n\n\nFrom your cli:\ncurl something.server.com\n\nResult:\nHTTP/1.1 200 OK\n\n\n\nIn apache 2.2, the <Directory> for the default DocumentRoot did NOT need to be defined for vhosts to work.\nIn apache 2.4, my virtual hosts ONLY work if this is specified.\n\nDo <Directory> directives take precedence and cascade over vhost <Directory> directives??\nDo <Directory> directives for parent folders cascade over children?\n\n\n\nRelated issues: \n- https://issues.apache.org/bugzilla/show_bug.cgi?id=36588\n- https://issues.apache.org/bugzilla/show_bug.cgi?id=47696", "id": 169318, "time": "2013-08-09T05:37:51Z", "creator": "wjaspers4@gmail.com", "creation_time": "2013-08-09T05:37:51Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 55392, "is_private": false, "count": 1, "id": 169455, "time": "2013-08-15T02:09:52Z", "creator": "wjaspers4@gmail.com", "creation_time": "2013-08-15T02:09:52Z", "text": "Likely invalid per my bad configuration.\nSee: https://issues.apache.org/bugzilla/show_bug.cgi?id=55408"}]