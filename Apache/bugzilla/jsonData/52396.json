[{"count": 0, "tags": [], "bug_id": 52396, "text": "In my test case, I must re-use two TCP connections. For example, firstly I created a TCP connection to the target address 10.0.0.2/554 and select the check box \"Re-use connection\" for I want to re-use it later; then I created another TCP connection to 10.0.0.2/555 and select the option \"Re-use connection\" also.\nBut I found my second data will be sent from the first connection to 10.0.0.2/554, and no new connection to 10.0.0.2/555 is created. Obviously it's not my expected result.\n\nMy suggestion:\nAdding the judgement about the target IP and Port, if they are different, the first connection should be closed and a new connection should be created even the check-boxes \"Re-use connection\" in these two Samplers both are chosen. In this way, we can avoid send the data to unexpected target address.\n\nBut the better way is to support re-using for multi-connections. And they should be closed when \"Re-use connection\" is unchecked or the thread exiting. This feature is just what I want now. Thanks.", "id": 152460, "time": "2011-12-29T08:08:09Z", "creator": "sanjiely@gmail.com", "creation_time": "2011-12-29T08:08:09Z", "is_private": false, "attachment_id": null}, {"count": 1, "attachment_id": null, "bug_id": 52396, "text": "Date: Thu Dec 29 16:45:11 2011\nNew Revision: 1225587\n\nURL: http://svn.apache.org/viewvc?rev=1225587&view=rev\nLog:\nBug 52396 - TCP Sampler in \"reuse connection mode\" reuses previous sampler's connection even if it's configured with other host, port, user or password\n\nModified:\n   jmeter/trunk/src/protocol/tcp/org/apache/jmeter/protocol/tcp/sampler/TCPSampler.java\n   jmeter/trunk/xdocs/changes.xml", "id": 152463, "time": "2011-12-29T16:45:54Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2011-12-29T16:45:54Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 52396, "attachment_id": null, "id": 152464, "time": "2011-12-29T16:46:59Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2011-12-29T16:46:59Z", "is_private": false, "text": "Fixed in trunk, use nightly build as soon as it's available and report if issue is fixed or not:\nhttps://builds.apache.org/job/JMeter-trunk/lastSuccessfulBuild/artifact/trunk/dist/"}, {"count": 3, "tags": [], "bug_id": 52396, "attachment_id": null, "text": "Hi,\n   Thank you for your quick reply.\n   I haven't tried the nightly build but read the code, and I find it is able to support multi-connections reused now. But maybe here is a minor issue, from the method \"threadFinished\":\n    public void threadFinished() {\n        log.debug(\"Thread Finished\"); //$NON-NLS-1$\n        closeSocket();\n        if (protocolHandler != null){\n            protocolHandler.teardownTest();\n        }\n   The closeSocket method is called, and it will only remove and close the current TCP connection. The other re-used connections will not be closed. Maybe we need a method like closeAllSockets called by threadFinished to traverse all connections to close them.\n   Thanks.", "id": 152484, "time": "2011-12-31T05:56:26Z", "creator": "sanjiely@gmail.com", "creation_time": "2011-12-31T05:56:26Z", "is_private": false}, {"count": 4, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "text": "Good point, fixed.\nDate: Sat Dec 31 10:52:39 2011\nNew Revision: 1226061\n\nURL: http://svn.apache.org/viewvc?rev=1226061&view=rev\nLog:\nBug 52396 - TCP Sampler in \"reuse connection mode\" reuses previous sampler's connection even if it's configured with other host, port, user or password\n\nModified:\n   jmeter/trunk/src/protocol/tcp/org/apache/jmeter/protocol/tcp/sampler/TCPSampler.java", "id": 152485, "time": "2011-12-31T10:53:27Z", "bug_id": 52396, "creation_time": "2011-12-31T10:53:27Z", "is_private": false, "attachment_id": null}]