[{"count": 0, "tags": [], "text": "(I consider this one critical as it can easily bog down a server.)\n\nI run 2.0.49 in Linux 2.4.25. In order to protect from too much memory \nallocation for CGI scripts, in set in my httpd.conf\n\nRLimitCPU 6\nRLimitNPROC 4\n\nHowever, this does not seem to work. I invoke my PHP as CGI by using the \nbinfmt-misc package. .php files are treated like normal CGI scripts. If I load a \nsimple <? phpinfo(); ?> script and open it 20 time simultaneously, it can crash \nmy server and get as high as load 60 (!). A lot of php instances are started and \nkept open for ages.\n\nShouldn't the above settings limit that?", "attachment_id": null, "bug_id": 28449, "id": 55942, "time": "2004-04-17T15:54:27Z", "creator": "floeff@arcor.de", "creation_time": "2004-04-17T15:54:27Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 28449, "is_private": false, "count": 1, "id": 55943, "time": "2004-04-17T16:07:46Z", "creator": "nd@perlig.de", "creation_time": "2004-04-17T16:07:46Z", "text": "RLimitNPROC determines, how many processes the user that the CGI scripts runs\ncan fork. It does NOT limit, how many CGIs can be started simultaneously.\n\nFrom the docs:\n\nRLimitNPROC Directive\n\n  Description:\tLimits the number of processes that can be launched by processes\nlaunched by Apache children\n[...]\n\nSee also setrlimit(2)"}, {"count": 2, "attachment_id": null, "creator": "floeff@arcor.de", "text": "Is there any configuration directive to limit the CGI script usage of either the\nwhole server or a user? I don't want these scripts to \"eat up\" all of my memory\nand take my machine to a high load...", "id": 55944, "time": "2004-04-17T16:10:32Z", "bug_id": 28449, "creation_time": "2004-04-17T16:10:32Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 28449, "attachment_id": null, "id": 55945, "time": "2004-04-17T16:22:26Z", "creator": "nd@perlig.de", "creation_time": "2004-04-17T16:22:26Z", "is_private": false, "text": "You can limit CPU usage with RLimitCPU and Memory usage with RLimitMEM."}, {"count": 4, "attachment_id": null, "creator": "floeff@arcor.de", "is_private": false, "id": 55946, "time": "2004-04-17T16:26:01Z", "bug_id": 28449, "creation_time": "2004-04-17T16:26:01Z", "tags": [], "text": "And these are valid for executed CGI scripts as well?"}, {"count": 5, "tags": [], "bug_id": 28449, "text": "only for CGI scripts. Feel free to look into the docs :)", "id": 55947, "time": "2004-04-17T16:29:50Z", "creator": "nd@perlig.de", "creation_time": "2004-04-17T16:29:50Z", "is_private": false, "attachment_id": null}, {"count": 6, "attachment_id": null, "creator": "floeff@arcor.de", "text": "I just tried out RLimitMEM 31457280 and it seems to help against my \"DOS\nattack\". ;-)\n\nJust one last question: RLimitMEM - is this valid for ALL scripts together (i.e.\ncumulated) or - if I use suEXEC - per user?", "id": 55948, "time": "2004-04-17T16:37:26Z", "bug_id": 28449, "creation_time": "2004-04-17T16:37:26Z", "tags": [], "is_private": false}, {"count": 7, "attachment_id": null, "creator": "nd@perlig.de", "text": "These directives set process attributes, so it is per CGI script. If it goes\nthrough suexec may depend on the OS (under linux there's no problem).", "id": 55949, "time": "2004-04-17T16:43:07Z", "bug_id": 28449, "creation_time": "2004-04-17T16:43:07Z", "tags": [], "is_private": false}, {"count": 8, "tags": [], "bug_id": 28449, "text": "It works exactly as I wanted it to. Thanks a lot, you really helped me out. I \nowe you one! ;-)", "id": 55950, "time": "2004-04-17T16:50:10Z", "creator": "floeff@arcor.de", "creation_time": "2004-04-17T16:50:10Z", "is_private": false, "attachment_id": null}]