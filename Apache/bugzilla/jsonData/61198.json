[{"count": 0, "tags": [], "creator": "taclayto@us.ibm.com", "attachment_id": 35060, "id": 199271, "time": "2017-06-19T02:29:31Z", "bug_id": 61198, "creation_time": "2017-06-19T02:29:31Z", "is_private": false, "text": "Created attachment 35060\nExample JMeter Scripts\n\n***Use Case***\nOur testing team makes heavy use of Test Fragments, Include Controllers and Backend Listeners. \n\nWe have a Thread Group in almost every jmx file that we use for testing while developing the Test Fragment. This Thread Group contains a Module Controller and several listeners, one of which is a Backend Listener. \n\nThis Backend Listener in the included jmx file is not a part of the Test Fragment and is scoped only to the Thread Group.\n\n***Defect Description***\nPlease reference the attached jmx files:\n- toBeIncluded.jmx (defines it's samplers in a Test Fragment, has a Thread Group that references the Fragment through a Module Controller) \n- includerScript.jmx (includes toBeIncluded.jmx and defines it's own listeners)\n\nWhen attempting to run our test from the main .jmx file (either in gui or from cmd line) we see a Null Pointer Exception when the test ends, causing the main process to never stop. \n\nThis is reproducible by running the attached script \"includerScript.jmx\"\n\nI attempted to trace this behavior through the code and came across the constructor in the BackendListener class.\n--------------------------------------------------------\n/**\n* Create a BackendListener.\n*/\npublic BackendListener() {\n  synchronized (LOCK) {\n    queuesByTestElementName.clear();\n  }\n  \n  setArguments(new Arguments());\n}\n--------------------------------------------------------\n\nThis constructor is called every time a file is loaded that contains a Backend Listener. I am not familiar enough with the distributed testing feature in JMeter to know why this might be necessary, but looking through the rest of the code, I can't make sense of why this would need to be here.\n\nCommenting out the .clear() command works for the above use case.\n\n***Expected Behavior***\nI expect the attached JMeter scripts to work properly. The Backend Listener in the included .jmx file should not affect the main .jmx file's Backend Listener just by virtue of being loaded through JMeter's Save Service."}, {"count": 1, "tags": [], "bug_id": 61198, "attachment_id": null, "text": "Author: pmouawad\nDate: Sat Jul 22 13:52:34 2017\nNew Revision: 1802695\n\nURL: http://svn.apache.org/viewvc?rev=1802695&view=rev\nLog:\nBug 61198 - Backend Listener does not work properly in main script when included scripts also contain Backend Listener\nBugzilla Id: 61198\n\nModified:\n    jmeter/trunk/src/components/org/apache/jmeter/visualizers/backend/BackendListener.java\n    jmeter/trunk/xdocs/changes.xml", "id": 199950, "time": "2017-07-22T13:52:56Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2017-07-22T13:52:56Z", "is_private": false}, {"count": 2, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "attachment_id": null, "id": 199951, "time": "2017-07-22T13:53:41Z", "bug_id": 61198, "creation_time": "2017-07-22T13:53:41Z", "is_private": false, "text": "Hello,\nThanks for precise report and analysis.\n\nIssue should be fixed in trunk, can you please next nightly build and confirm issue is fixed in both GUI and NON GUI modes ?\n\nThanks\nRegards"}, {"count": 3, "tags": [], "creator": "taclayto@us.ibm.com", "text": "Hi, works for me on JMeter4.0-SNAPSHOT.20180126\n\nSorry for taking so long to get around to verifying!", "id": 203507, "time": "2018-01-26T16:40:17Z", "bug_id": 61198, "creation_time": "2018-01-26T16:40:17Z", "is_private": false, "attachment_id": null}]