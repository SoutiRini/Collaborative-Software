[{"count": 0, "tags": [], "creator": "Yuri.X.Abelev@kp.org", "text": "I've got a problem opening Excel file after it was populated by using POI 1.5.1\n\nThis is the code I'm using:\n\n        POIFSFileSystem fs      =\n            new POIFSFileSystem(new FileInputStream(\"Book1.xls\"));\n        HSSFWorkbook wb = new HSSFWorkbook(fs);\n        HSSFSheet sheet = wb.getSheetAt(0);\n        // If number of rows 402 or smaller - Excel file opens OK\t\n        for (iRow=0; iRow <403; iRow++){  \n          HSSFRow row = sheet.createRow((short)iRow);\n          row = sheet.createRow((short)iRow);\n          for (sCell=0; sCell<10; sCell++){\n              HSSFCell cell = row.createCell((short)(sCell));\n              cell = row.createCell((short)sCell);\n              HSSFCellStyle style = wb.createCellStyle();\n              style.setBorderBottom(HSSFCellStyle.BORDER_THIN);\n              style.setBottomBorderColor(HSSFCellStyle.BLACK);\n              style.setBorderLeft(HSSFCellStyle.BORDER_THIN);\n              style.setLeftBorderColor(HSSFCellStyle.BLACK);\n              style.setBorderRight(HSSFCellStyle.BORDER_THIN);\n              style.setRightBorderColor(HSSFCellStyle.BLACK);\n              style.setBorderTop(HSSFCellStyle.BORDER_THIN);\n              style.setTopBorderColor(HSSFCellStyle.BLACK);\n              style.setAlignment(HSSFCellStyle.ALIGN_CENTER);\n              cell.setCellStyle(style);\n              cell.setCellValue(\"my cell\");\n          }\n        }\n\n        // Write the output to a file\n        FileOutputStream fileOut = new FileOutputStream(\"Book2.xls\");\n        wb.write(fileOut);\n        fileOut.close();\n\nWhen I open Book2.xls, it gives an error message \"Too Many Different Cell \nFormats\".\nWhen I decrease number of rows from 403 to 402 or smaller, Book2.xls opens with \nno problem.\n\nI found this article on the Microsoft Knowledge Base website : \nhttp://support.microsoft.com/default.aspx?scid=KB;en-us;213904& \nIt says: \" This problem occurs when the workbook contains more than \napproximately 4,000 different combinations of cell formats.\"\nBut my code has only 1 formatting combination not 4000! However, the number of \ncells on my worksheet is about 4000 (403 X 10).\nThe problem goes away if I comment all code with 'style\" (HSSFCellStyle).\n\nBut how can I format my cells then?", "id": 27034, "time": "2002-11-27T03:54:16Z", "bug_id": 14879, "creation_time": "2002-11-27T03:54:16Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "jheight@apache.org", "text": "Just write your code differently:\n\n ...\n HSSFCellStyle style = wb.createCellStyle();\n style.setBorderBottom(HSSFCellStyle.BORDER_THIN);\n style.setBottomBorderColor(HSSFCellStyle.BLACK);\n style.setBorderLeft(HSSFCellStyle.BORDER_THIN);\n style.setLeftBorderColor(HSSFCellStyle.BLACK);\n style.setBorderRight(HSSFCellStyle.BORDER_THIN);\n style.setRightBorderColor(HSSFCellStyle.BLACK);\n style.setBorderTop(HSSFCellStyle.BORDER_THIN);\n style.setTopBorderColor(HSSFCellStyle.BLACK);\n style.setAlignment(HSSFCellStyle.ALIGN_CENTER);\n\n for (iRow=0; iRow <403; iRow++){  \n   HSSFRow row = sheet.createRow((short)iRow);\n   row = sheet.createRow((short)iRow);\n   for (sCell=0; sCell<10; sCell++){\n     HSSFCell cell = row.createCell((short)(sCell));\n     cell = row.createCell((short)sCell);\n     cell.setCellStyle(style);\n     cell.setCellValue(\"my cell\");\n   }\n }\n\n\nJason", "id": 27035, "time": "2002-11-27T04:04:31Z", "bug_id": 14879, "creation_time": "2002-11-27T04:04:31Z", "is_private": false, "attachment_id": null}]