[{"count": 0, "tags": [], "bug_id": 42618, "attachment_id": null, "id": 104200, "time": "2007-06-08T08:03:52Z", "creator": "nshashank1982@rediffmail.com", "creation_time": "2007-06-08T08:03:52Z", "is_private": false, "text": "I am trying to read a formula as is from the excel file.\n\nThe formula is =CHOOSE(2,A2,A3,A4)\n\nBut I am getting the following error.\n\nException in thread \"main\" org.apache.poi.hssf.record.RecordFormatException: \nUnable to construct record instance\n        at org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java:191)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java:115)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:205)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:257)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:238)\n        at excelFileReader.ParseExcel.main(ParseExcel.java:14)\nCaused by: java.lang.reflect.InvocationTargetException\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native \nMethod)\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown \nSource)\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown \nSource)\n        at java.lang.reflect.Constructor.newInstance(Unknown Source)\n        at org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java:179)\n        ... 5 more\nCaused by: org.apache.poi.hssf.record.RecordFormatException: \njava.lang.UnsupportedOperationException:  Unknown Ptg in Formula: 0x0 (0)\n        at org.apache.poi.hssf.record.FormulaRecord.fillFields\n(FormulaRecord.java:109)\n        at org.apache.poi.hssf.record.Record.<init>(Record.java:56)\n        at org.apache.poi.hssf.record.FormulaRecord.<init>\n(FormulaRecord.java:89)\n        ... 10 more\nCaused by: java.lang.UnsupportedOperationException:  Unknown Ptg in Formula: \n0x0 (0)\n        at org.apache.poi.hssf.record.formula.Ptg.createPtg(Ptg.java:357)\n        at org.apache.poi.hssf.record.formula.Ptg.createParsedExpressionTokens\n(Ptg.java:98)\n        at org.apache.poi.hssf.record.FormulaRecord.fillFields\n(FormulaRecord.java:107)\n        ... 12 more"}, {"count": 1, "tags": [], "bug_id": 42618, "attachment_id": null, "id": 113135, "time": "2008-01-25T08:37:41Z", "creator": "apache@gagravarr.org", "creation_time": "2008-01-25T08:37:41Z", "is_private": false, "text": "I'm unable to replicate this using poi from svn trunk\n\nI've created a file with the supplied formula in it, and written a test that\ntries to load the file with the formula. This works just fine, so I assume this\nbug has been fixed since whatever version you're using.\n\nIf it's still there for you with a svn trunk checkout, please re-open the bug\nand upload your problem file"}, {"count": 2, "tags": [], "text": "Nick, are you sure the test passes? \n\nyegor@yegornb ~/poi\n$  ant -Dtestcase=org.apache.poi.hssf.usermodel.TestBugs single-test\nBuildfile: build.xml\n\n-test-property-check:\n\ncheck-jars:\n\nfetch-jars:\n\ninit:\n\nwith.clover:\n\nfail-unless-xslt-is-available:\n\nfail-xslt:\n\ncompile-main:\n    [javac] Compiling 1 source file to\nD:\\java\\apache\\jakarta-poi\\poi\\trunk\\build\\classes\n\nsingle-test:\n    [junit] Running org.apache.poi.hssf.usermodel.TestBugs\n    [junit] Test\n    [junit] Tests run: 49, Failures: 0, Errors: 1, Time elapsed: 2.625 sec\n    [junit] Testsuite: org.apache.poi.hssf.usermodel.TestBugs\n    [junit] Tests run: 49, Failures: 0, Errors: 1, Time elapsed: 2.625 sec\n    [junit] ------------- Standard Output ---------------\n    [junit] Test\n    [junit] ------------- ---------------- ---------------\n\n    [junit] Testcase: test15228 took 1.406 sec\n    [junit] Testcase: test13796 took 0 sec\n    [junit] Testcase: test23094 took 0.016 sec\n    [junit] Testcase: test15353 took 0 sec\n    [junit] Testcase: test14460 took 0 sec\n    [junit] Testcase: test14330 took 0.015 sec\n    [junit] Testcase: test15375 took 0 sec\n    [junit] Testcase: test15375_2 took 0.328 sec\n    [junit] Testcase: test22568 took 0.063 sec\n    [junit] Testcase: test15556 took 0.031 sec\n    [junit] Testcase: test22742 took 0.016 sec\n    [junit] Testcase: test12561_1 took 0.015 sec\n    [junit] Testcase: test12561_2 took 0 sec\n    [junit] Testcase: test12843_1 took 0.157 sec\n    [junit] Testcase: test12843_2 took 0.015 sec\n    [junit] Testcase: test13224 took 0 sec\n    [junit] Testcase: test19599 took 0.032 sec\n    [junit] Testcase: test24215 took 0.015 sec\n    [junit] Testcase: test18800 took 0 sec\n    [junit] Testcase: test22720 took 0 sec\n    [junit] Testcase: testUnicodeStringFormulaRead took 0 sec\n    [junit] Testcase: test32822 took 0.016 sec\n    [junit] Testcase: test15573 took 0 sec\n    [junit] Testcase: test27852 took 0 sec\n    [junit] Testcase: test33082 took 0.015 sec\n    [junit] Testcase: test34775 took 0.016 sec\n    [junit] Testcase: test37630 took 0 sec\n    [junit] Testcase: test25183 took 0.016 sec\n    [junit] Testcase: test26100 took 0 sec\n    [junit] Testcase: test27933 took 0.015 sec\n    [junit] Testcase: test29206 took 0 sec\n    [junit] Testcase: test29675 took 0 sec\n    [junit] Testcase: test29942 took 0.047 sec\n    [junit] Testcase: test29982 took 0.063 sec\n    [junit] Testcase: test30540 took 0.015 sec\n    [junit] Testcase: test31749 took 0.047 sec\n    [junit] Testcase: test31979 took 0.016 sec\n    [junit] Testcase: test35564 took 0.031 sec\n    [junit] Testcase: test35565 took 0.031 sec\n    [junit] Testcase: test37376 took 0 sec\n    [junit] Testcase: test40285 took 0 sec\n    [junit] Testcase: test40296 took 0 sec\n    [junit] Testcase: test38266 took 0.016 sec\n    [junit] Testcase: test40738 took 0 sec\n    [junit] Testcase: test44200 took 0 sec\n    [junit] Testcase: test44201 took 0.016 sec\n    [junit] Testcase: test37684 took 0.046 sec\n    [junit] Testcase: test41139 took 0.032 sec\n    [junit] Testcase: test42618 took 0 sec\n    [junit]     Caused an ERROR\n    [junit] Unable to construct record instance\n    [junit] org.apache.poi.hssf.record.RecordFormatException: Unable to\nconstruct record instance\n    [junit]     at\norg.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:199)\n    [junit]     at\norg.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:117)\n    [junit]     at\norg.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:207)\n    [junit]     at\norg.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:259)\n    [junit]     at\norg.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:240)\n    [junit]     at\norg.apache.poi.hssf.usermodel.TestBugs.test42618(TestBugs.java:1019)\n    [junit]     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    [junit]     at\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    [junit]     at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java\n:25)\n    [junit]     at java.lang.reflect.Method.invoke(Method.java:585)\n    [junit]     at junit.framework.TestCase.runTest(TestCase.java:154)\n    [junit]     at junit.framework.TestCase.runBare(TestCase.java:127)\n    [junit]     at junit.framework.TestResult$1.protect(TestResult.java:106)\n    [junit]     at junit.framework.TestResult.runProtected(TestResult.java:124)\n    [junit]     at junit.framework.TestResult.run(TestResult.java:109)\n    [junit]     at junit.framework.TestCase.run(TestCase.java:118)\n    [junit]     at junit.framework.TestSuite.runTest(TestSuite.java:208)\n    [junit]     at junit.framework.TestSuite.run(TestSuite.java:203)\n    [junit]     at\norg.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.\njava:289)\n    [junit]     at\norg.apache.tools.ant.taskdefs.optional.junit.JUnitTask.executeInVM(JUnitTask.java\n:1061)\n    [junit]     at\norg.apache.tools.ant.taskdefs.optional.junit.JUnitTask.execute(JUnitTask.java:676\n)\n    [junit]     at\norg.apache.tools.ant.taskdefs.optional.junit.JUnitTask.executeOrQueue(JUnitTask.j\nava:1413)\n    [junit]     at\norg.apache.tools.ant.taskdefs.optional.junit.JUnitTask.execute(JUnitTask.java:633\n)\n    [junit]     at\norg.apache.tools.ant.UnknownElement.execute(UnknownElement.java:275)\n    [junit]     at org.apache.tools.ant.Task.perform(Task.java:364)\n    [junit]     at org.apache.tools.ant.Target.execute(Target.java:341)\n    [junit]     at org.apache.tools.ant.Target.performTasks(Target.java:369)\n    [junit]     at org.apache.tools.ant.Project.executeTarget(Project.java:1214)\n    [junit]     at org.apache.tools.ant.Project.executeTargets(Project.java:1062)\n    [junit]     at org.apache.tools.ant.Main.runBuild(Main.java:673)\n    [junit]     at org.apache.tools.ant.Main.startAnt(Main.java:188)\n    [junit]     at org.apache.tools.ant.launch.Launcher.run(Launcher.java:196)\n    [junit]     at org.apache.tools.ant.launch.Launcher.main(Launcher.java:55)\n    [junit] Caused by: java.lang.reflect.InvocationTargetException\n    [junit]     at\nsun.reflect.GeneratedConstructorAccessor19.newInstance(Unknown Source)\n    [junit]     at\nsun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAc\ncessorImpl.java:27)\n    [junit]     at java.lang.reflect.Constructor.newInstance(Constructor.java:494)\n    [junit]     at\norg.apache.poi.hssf.record.RecordFactory.createRecord(RecordFactory.java:187)\n    [junit]     ... 32 more\n    [junit] Caused by: org.apache.poi.hssf.record.RecordFormatException:\njava.lang.UnsupportedOperat\nionException:  Unknown Ptg in Formula: 0x0 (0)\n    [junit]     at\norg.apache.poi.hssf.record.FormulaRecord.fillFields(FormulaRecord.java:109)\n    [junit]     at org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n    [junit]     at\norg.apache.poi.hssf.record.FormulaRecord.<init>(FormulaRecord.java:89)\n    [junit]     ... 36 more\n    [junit] Caused by: java.lang.UnsupportedOperationException:  Unknown Ptg in\nFormula: 0x0 (0)\n    [junit]     at org.apache.poi.hssf.record.formula.Ptg.createPtg(Ptg.java:357)\n    [junit]     at\norg.apache.poi.hssf.record.formula.Ptg.createParsedExpressionTokens(Ptg.java:98)\n    [junit]     at\norg.apache.poi.hssf.record.FormulaRecord.fillFields(FormulaRecord.java:107)\n    [junit]     ... 38 more\n\n    [junit] Test org.apache.poi.hssf.usermodel.TestBugs FAILED\n\nBUILD SUCCESSFUL\nTotal time: 5 seconds\n\nIt blocks the release and I had to comment it out.\n\nYegor", "attachment_id": null, "id": 113141, "creator": "yegor@dinom.ru", "time": "2008-01-25T11:23:05Z", "bug_id": 42618, "creation_time": "2008-01-25T11:23:05Z", "is_private": false}, {"count": 3, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "I think eclipse hates me - it was claiming that test was passing :(\n\nThis now opens properly - had to make some tweaks to the Ptg generation, and\nwrite a new test for how we parse the low level FormulaRecord in this case", "id": 113179, "time": "2008-01-28T04:18:53Z", "bug_id": 42618, "creation_time": "2008-01-28T04:18:53Z", "is_private": false}, {"count": 4, "tags": [], "text": "What version of POI is this bug fixed in?", "attachment_id": null, "id": 116110, "creator": "Peter.krum@cna.com", "time": "2008-05-01T12:16:25Z", "bug_id": 42618, "creation_time": "2008-05-01T12:16:25Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 42618, "attachment_id": null, "id": 116119, "time": "2008-05-01T14:27:02Z", "creator": "josh@apache.org", "creation_time": "2008-05-01T14:27:02Z", "is_private": false, "text": "(In reply to comment #4)\n> What version of POI is this bug fixed in?\n> \n\nNick seems to have applied the last change on Jan-28 (svn r615859), which was between 3.0.2-BETA2 and 3.0.2-FINAL.\n"}]