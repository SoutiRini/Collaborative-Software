[{"count": 0, "tags": [], "text": "According to the Servlet 2.3 SPEC, this is a correct specification for a \nlistener:\n\n<web-app>\n<display-name>MyListeningApplication</display-name>\n<listener>\n<listener-class>com.acme.MyConnectionManager</listener-class>\n</listener>\n<listener>\n<listener-class>com.acme.MyLoggingModule</listener-class>\n</listener>\n<servlet>\n<display-name>RegistrationServlet</display-name>\n...etc\n</servlet>\n</web-app>\n\nHowever, when I do this in my web.xml, I get this error on startup:\nStarting service Tomcat-Standalone\nApache Tomcat/4.0\nPARSE error at line 11 column -1\norg.xml.sax.SAXParseException: Element \"web-app\" does not allow \"listener\" here.\n\nStarting service Tomcat-Apache\nApache Tomcat/4.0\n\nWhat is the correct way to declare a listener?", "attachment_id": null, "bug_id": 5224, "id": 8503, "time": "2001-12-01T13:55:05Z", "creator": "edburns@acm.org", "creation_time": "2001-12-01T13:55:05Z", "is_private": false}, {"count": 1, "tags": [], "creator": "edburns@acm.org", "attachment_id": null, "id": 8504, "time": "2001-12-01T14:24:17Z", "bug_id": 5224, "creation_time": "2001-12-01T14:24:17Z", "is_private": false, "text": "USER ERROR.  web.xml referenced 2.2 dtd."}, {"count": 2, "tags": [], "text": "Created attachment 2060\nA valid web.xml file which will not parse", "is_private": false, "bug_id": 5224, "id": 17633, "time": "2002-06-11T23:16:16Z", "creator": "chenesy@agris.com", "creation_time": "2002-06-11T23:16:16Z", "attachment_id": 2060}, {"count": 3, "attachment_id": null, "creator": "chenesy@agris.com", "is_private": false, "id": 17634, "time": "2002-06-11T23:17:36Z", "bug_id": 5224, "creation_time": "2002-06-11T23:17:36Z", "tags": [], "text": "Attached a valid (as near as I can tell after staring at it for 3.5 hours)\nweb.xml that won't parse using Tomcat 4.0.1\n\nI get this:\n[INFO,Default] PARSE error at line 18 column -1\n[INFO,Default] org.xml.sax.SAXParseException: Element \"web-app\" does not allow\n\"listener\" here.\n[ERROR,EmbeddedCatalinaServiceSX] ContextConfig[] Parse error in application web.xml\norg.xml.sax.SAXParseException: Element \"web-app\" does not allow \"listener\" here.\n\tat org.apache.crimson.parser.Parser2.error(Parser2.java:3086)\n\tat\norg.apache.crimson.parser.ValidatingParser$ChildrenValidator.consume(ValidatingParser.java:349)\n\tat org.apache.crimson.parser.Parser2.maybeElement(Parser2.java:1311)\n\tat org.apache.crimson.parser.Parser2.content(Parser2.java:1766)\n\tat org.apache.crimson.parser.Parser2.maybeElement(Parser2.java:1494)\n\tat org.apache.crimson.parser.Parser2.parseInternal(Parser2.java:500)\n\tat org.apache.crimson.parser.Parser2.parse(Parser2.java:305)\n\tat org.apache.crimson.parser.XMLReaderImpl.parse(XMLReaderImpl.java:433)\n\tat org.xml.sax.helpers.XMLReaderAdapter.parse(XMLReaderAdapter.java:223)\n\tat javax.xml.parsers.SAXParser.parse(SAXParser.java:326)\n\tat javax.xml.parsers.SAXParser.parse(SAXParser.java:101)\n\tat org.apache.catalina.util.xml.XmlMapper.readXml(XmlMapper.java:275)\n\tat\norg.apache.catalina.startup.ContextConfig.applicationConfig(ContextConfig.java:256)\n\tat org.apache.catalina.startup.ContextConfig.start(ContextConfig.java:824)\n\tat org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:224)\n\tat\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:155)\n\tat org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1131)\n\tat org.apache.catalina.core.StandardContext.start(StandardContext.java:3334)\n\tat org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:785)\n\tat org.apache.catalina.core.StandardHost.addChild(StandardHost.java:454)\n\tat\norg.jboss.web.catalina.EmbeddedCatalinaServiceSX.createWebContext(EmbeddedCatalinaServiceSX.java:428)\n\tat\norg.jboss.web.catalina.EmbeddedCatalinaServiceSX.performDeploy(EmbeddedCatalinaServiceSX.java:282)\n\tat org.jboss.web.AbstractWebContainer.deploy(AbstractWebContainer.java:191)\n\tat java.lang.reflect.Method.invoke(Native Method)\n\tat com.sun.management.jmx.MBeanServerImpl.invoke(MBeanServerImpl.java:1628)\n\tat com.sun.management.jmx.MBeanServerImpl.invoke(MBeanServerImpl.java:1523)\n\tat org.jboss.deployment.J2eeDeployer.startModules(J2eeDeployer.java:505)\n\tat org.jboss.deployment.J2eeDeployer.startApplication(J2eeDeployer.java:459)\n\tat org.jboss.deployment.J2eeDeployer.deploy(J2eeDeployer.java:190)\n\tat java.lang.reflect.Method.invoke(Native Method)\n\tat com.sun.management.jmx.MBeanServerImpl.invoke(MBeanServerImpl.java:1628)\n\tat com.sun.management.jmx.MBeanServerImpl.invoke(MBeanServerImpl.java:1523)\n\tat org.jboss.deployment.AutoDeployer.deploy(AutoDeployer.java:395)\n\tat org.jboss.deployment.AutoDeployer.run(AutoDeployer.java:233)\n\tat java.lang.Thread.run(Thread.java:484)\n"}, {"count": 4, "attachment_id": null, "creator": "chenesy@agris.com", "is_private": false, "id": 17636, "time": "2002-06-11T23:42:08Z", "bug_id": 5224, "creation_time": "2002-06-11T23:42:08Z", "tags": [], "text": "I feel like an idiot.  I only changed part of the doctype line.\nFor the record, if you have this problem, make sure that your doctype looks like\nthis:\n\n<!DOCTYPE web-app\n  PUBLIC \"-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN\"\n  \"http://java.sun.com/j2ee/dtds/web-app_2_3.dtd\">"}]