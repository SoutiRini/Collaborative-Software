[{"count": 0, "tags": [], "bug_id": 4838, "text": "The example below contains SVG text inside an FO document.  There are two\nSVG diagrams which are almost identical - their contents should be shown\nidentically.  The only difference is that in the second case all the dimensions\nhave been reduced by a factor of ten, which is balanced by an increase by the\nsame factor in an enclosing scale transform.\n\nWith strokeSVGText=true (the default) it works fine.\n\nWith strokeSVGText=false, the first version is shown correctly.   In the second\nversion, only the second two text items are shown.  It seems that text items\nwith a font-size of less than 1 are not plotted.  That's a font-size of less\nthan 1 actually specified on the svg:text element, not after scaling has\nbeen taken into account.\n\nI have reported another issue where something similar happens to stroke-width\n(bug 4766) - is this related?\n\nThis is with FOP 0.20.2-RC.\n\nI would be very grateful for any feedback since without a fix I will have to\nengineer a very messy workaround...\n\nHere is the example:\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<fo:root xmlns:fo=\"http://www.w3.org/1999/XSL/Format\">\n  <fo:layout-master-set>\n    <fo:simple-page-master margin-right=\"25mm\" margin-left=\"25mm\"\n                           margin-bottom=\"20mm\" margin-top=\"15mm\"\n                           page-height=\"297mm\" page-width=\"210mm\"\n                           master-name=\"a4\">\n      <fo:region-before extent=\"10mm\"/>\n      <fo:region-after extent=\"10mm\"/>\n      <fo:region-body margin-bottom=\"15mm\" margin-top=\"15mm\"/>\n    </fo:simple-page-master>\n  </fo:layout-master-set>\n  <fo:page-sequence master-name=\"a4\">\n    <fo:flow flow-name=\"xsl-region-body\">\n\n      <fo:block>\n        <fo:instream-foreign-object>\n          <svg:svg xmlns:svg=\"http://www.w3.org/2000/svg\"\n                   width=\"15cm\" height=\"11cm\"\n                   viewBox=\"0 0 4500 3300\"\n                   contentStyleType=\"text/css\">\n            <svg:g transform=\"scale(30)\">\n              <svg:text fill=\"#000000\" text-anchor=\"middle\" font-size=\"1\"\n                        x=\"80\" y=\"10\">ABC</svg:text>\n              <svg:text fill=\"#000000\" text-anchor=\"middle\" font-size=\"3\"\n                        x=\"80\" y=\"20\">ABC</svg:text>\n              <svg:text fill=\"#000000\" text-anchor=\"middle\" font-size=\"10\"\n                        x=\"80\" y=\"40\">ABC</svg:text>\n              <svg:text fill=\"#000000\" text-anchor=\"middle\" font-size=\"30\"\n                        x=\"80\" y=\"80\">ABC</svg:text>\n            </svg:g>\n          </svg:svg>\n        </fo:instream-foreign-object>\n      </fo:block>\n\n      <fo:block>\n        <fo:instream-foreign-object>\n          <svg:svg xmlns:svg=\"http://www.w3.org/2000/svg\"\n                   width=\"15cm\" height=\"11cm\"\n                   viewBox=\"0 0 4500 3300\"\n                   contentStyleType=\"text/css\">\n            <svg:g transform=\"scale(300)\">\n              <svg:text fill=\"#000000\" text-anchor=\"middle\" font-size=\"0.1\"\n                        x=\"8\" y=\"1\">ABC</svg:text>\n              <svg:text fill=\"#000000\" text-anchor=\"middle\" font-size=\"0.3\"\n                        x=\"8\" y=\"2\">ABC</svg:text>\n              <svg:text fill=\"#000000\" text-anchor=\"middle\" font-size=\"1.0\"\n                        x=\"8\" y=\"4\">ABC</svg:text>\n              <svg:text fill=\"#000000\" text-anchor=\"middle\" font-size=\"3.0\"\n                        x=\"8\" y=\"8\">ABC</svg:text>\n            </svg:g>\n          </svg:svg>\n        </fo:instream-foreign-object>\n      </fo:block>\n\n    </fo:flow>\n  </fo:page-sequence>\n</fo:root>", "id": 7855, "time": "2001-11-13T06:25:32Z", "creator": "spam_from_apache_bugzilla@chezphil.org", "creation_time": "2001-11-13T06:25:32Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "spam_from_apache_bugzilla@chezphil.org", "text": "I have started to look at the java source code for the SVG-to-PDF stuff in\nan effort to work out what is going on here.  My suspicion is that something\nis being rounded to an integer when it shouldn't be.  Warning: I don't write\njava.  I have never looked at this code before.  I know next-to-nothing\nabout PDF.\n\nIn svg/PDFGraphics2D.java I have found places in drawString where the font\nsize is stored in an integer.  It looks to me as if the FontState class\nstores font sizes in integers representing thousanths of a unit; there are\n*1000 and /1000 conversions going on.  This may be OK.  But the variables siz\nand size used in this function are integers, and size is written into the PDF\noutput stream.  I suspect that this ought to be a float.\n\nI'm going to change the component for this bug from pdf renderer to svg, since\nthis this code is in the svg directory.\n", "id": 7868, "attachment_id": null, "bug_id": 4838, "creation_time": "2001-11-13T07:57:34Z", "time": "2001-11-13T07:57:34Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 4838, "attachment_id": null, "is_private": false, "id": 16145, "time": "2002-05-15T11:58:10Z", "creator": "j3322ptm@yahoo.de", "creation_time": "2002-05-15T11:58:10Z", "text": "No visible problem with 0.20.3, in particular the small text is\ndisplayed for the second SVG."}, {"count": 3, "tags": [], "creator": "gadams@apache.org", "text": "batch transition pre-FOP1.0 resolved+fixed bugs to closed+fixed", "id": 155848, "time": "2012-04-01T06:44:31Z", "bug_id": 4838, "creation_time": "2012-04-01T06:44:31Z", "is_private": false, "attachment_id": null}]