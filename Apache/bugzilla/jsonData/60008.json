[{"count": 0, "tags": [], "bug_id": 60008, "attachment_id": null, "is_private": false, "id": 193132, "time": "2016-08-16T04:27:57Z", "creator": "schandra@kodiakptt.com", "creation_time": "2016-08-16T04:27:57Z", "text": "The CORS filter not allowing request and returning 403 when the request is as follows.\n\nRequest Headers\nPOST http://kodiakptt.com/poc/ HTTP/1.1\nAccept: application/json, text/plain, */*\nOrigin: file://\nUser-Agent: Mozilla/5.0 (Linux; Android 4.4.2; XT1033 Build/KXB20.25-1.31) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/30.0.0.0 Mobile Safari/537.36\nContent-Type: application/json;charset=UT\n\nWe have a app which accesses the resource from tomcat web server, if UI is part of the app and using hosted JSCDE/mobile API js file, the webview send the request with Origin: file:// which tomcat rejects with 403 Forbidden."}, {"count": 1, "tags": [], "bug_id": 60008, "text": "No configuration has been provided for the CORS filter so the working assumption is going to be that this is a configuarion error.\n\nPlease use the users@tomcat.apache.org mailing list to debug this further. If that discussion concludes that there is a valid bug here then this issue can be re-opened and the necessary details required to reproduce the issue added.", "id": 193133, "time": "2016-08-16T04:45:40Z", "creator": "markt@apache.org", "creation_time": "2016-08-16T04:45:40Z", "is_private": false, "attachment_id": null}, {"count": 2, "attachment_id": null, "bug_id": 60008, "text": "Below is the cors filter configuration in tomcat web.xml file \n<filter>\n  <filter-name>CorsFilter</filter-name>\n  <filter-class>org.apache.catalina.filters.CorsFilter</filter-class>\n  <init-param>\n    <param-name>cors.allowed.origins</param-name>\n    <param-value>*</param-value>\n  </init-param>\n    <!--<init-param>\n      <param-name>cors.allow.nullorigin</param-name>\n      <param-value>true</param-value>       \n   </init-param>-->\n  <init-param>\n    <param-name>cors.allowed.methods</param-name>\n    <param-value>GET,POST,HEAD,OPTIONS,PUT</param-value>\n  </init-param>\n  <init-param>\n    <param-name>cors.allowed.headers</param-name>\n    <param-value>Content-Type,X-Requested-With,accept,Origin,Access-Control-Request-Method,Access-Control-Request-Headers,KN-X-UserAgent</param-value>\n  </init-param>\n  <init-param>\n    <param-name>cors.exposed.headers</param-name>\n    <param-value>Access-Control-Allow-Origin,Access-Control-Allow-Credentials</param-value>\n  </init-param>\n  <init-param>\n    <param-name>cors.support.credentials</param-name>\n    <param-value>true</param-value>\n  </init-param>\n  <init-param>\n    <param-name>cors.preflight.maxage</param-name>\n    <param-value>10</param-value>\n  </init-param>\n</filter>\n<filter-mapping>\n  <filter-name>CorsFilter</filter-name>\n  <url-pattern>/*</url-pattern>\n</filter-mapping>\n</web-app>", "id": 193134, "time": "2016-08-16T04:53:36Z", "creator": "schandra@kodiakptt.com", "creation_time": "2016-08-16T04:53:36Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 60008, "text": "OK. I see the problem. \"file://\" is not a valid URI so Tomcat was rejecting it. However the spec for origin is that if the scheme is file the rest could be anything. I've modified the filter to allow any URI (valid or not) with a scheme of file.\n\nThis has been fixed in the following branches:\n- 9.0.x for 9.0.0.M10 onwards\n- 8.5.x for 8.5.5 onwards\n- 8.0.x for 8.0.37 onwards\n- 7.0.x for 7.0.71 onwards", "id": 193279, "time": "2016-08-23T11:03:37Z", "creator": "markt@apache.org", "creation_time": "2016-08-23T11:03:37Z", "is_private": false, "attachment_id": null}]