[{"count": 0, "text": "Created attachment 29910\nmaven projet with an input file and a sample main method.\n\nWhen shifting rows in an HSSFSheet, formulas such as \"=sum(C[1])\" do not use new cells' values.\n\nYou need to open the resulting file in excel and edit (F2) the cell in order for the formula to use the cell's value.\n\nSample file and code in the attachment.", "bug_id": 54509, "is_private": false, "id": 164954, "time": "2013-01-31T10:33:29Z", "creator": "sylvain.delafoy@gmail.com", "creation_time": "2013-01-31T10:33:29Z", "tags": [], "attachment_id": 29910}, {"count": 1, "tags": [], "creator": "dominik.stadler@gmx.at", "is_private": false, "id": 177469, "attachment_id": null, "bug_id": 54509, "creation_time": "2014-08-31T12:05:17Z", "time": "2014-08-31T12:05:17Z", "text": "I tried this with latest POI and it did work fine, seems some of the related fixes since POI 3.9 has fixed this as well."}, {"attachment_id": null, "tags": [], "creator": "sylvain.delafoy@gmail.com", "is_private": false, "count": 2, "id": 177555, "time": "2014-09-05T09:26:18Z", "bug_id": 54509, "creation_time": "2014-09-05T09:26:18Z", "text": "Looks like the difference comes from the software used to open the file. I checked my example this morning with Excel 2010 and the latest libreoffice and both showed 10. Unfortunately, I don't have access to the computer where I noticed this problem to check excel's version.\n\nHowever, if I add\n\nSystem.out.println(new HSSFWorkbook(new FileInputStream(\"out.xls\")).getSheetAt(0).getRow(0).getCell(0).getNumericCellValue());\n\nand use POI version 3.10.1 or 3.11-beta2 at the end of the test, the output is 7.\n\nHowever, I wonder if it's a POI bug or not.\n\nPS: My apologies to clean code, there is obviously a lot of stream closing to be done. If this bug is reopened, I volunteer for writing a clean unit test."}, {"attachment_id": null, "tags": [], "creator": "dominik.stadler@gmx.at", "text": "reopen to investigate some more", "count": 3, "id": 177717, "time": "2014-09-11T05:54:28Z", "bug_id": 54509, "creation_time": "2014-09-11T05:54:28Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "sylvain.delafoy@gmail.com", "is_private": false, "count": 4, "id": 188089, "time": "2016-01-31T17:53:35Z", "bug_id": 54509, "creation_time": "2016-01-31T17:53:35Z", "text": "I'm sorry I can't help more, I left the company at which I encountered this issue so no access to the original excel version anymore.\n\nCan I help in any other way?"}]