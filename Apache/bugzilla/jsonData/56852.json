[{"count": 0, "tags": [], "text": "hello,\n\nOur project will need to import the excel for some data init. cell will be added the comment about the reasons of error, so there may be add more than 1024 comments, but will only display the last 1024.\n\ne.g.\nHSSFWorkbook wb = new HSSFWorkbook();\nHSSFSheet sheet = wb.createSheet(\"mysheet\");\nHSSFPatriarch p = null;\nfinal Map<HSSFSheet, HSSFPatriarch> drawings = new HashMap<HSSFSheet, HSSFPatriarch>();\nif(drawings.containsKey(sheet)) {\n  p = drawings.get(sheet);\n} else {\n  p = sheet.createDrawingPatriarch();\n}\nfor (int i = 0; i < 2000; i++) {\n  HSSFCell cell = sheet.createRow(i).createCell(1);\n  cell.setCellValue(new HSSFRichTextString(\"comment\" + i));\n  HSSFAnchor anchor = new HSSFClientAnchor(0, 0, 0, 0, (short) 1, i, (short) 3, i + 3);\n  HSSFComment comment = p.createComment(anchor);\n  comment.setAuthor(\"fzb\");\n  comment.setString(new HSSFRichTextString(\"add the comment\" + i + \"success!\"));\n  cell.setCellComment(comment);\n}\n\t\t\nFileOutputStream out = new FileOutputStream(\"writerPostil.xls\");\nwb.write(out);\n\nRegards", "attachment_id": null, "id": 177154, "creator": "silencon@gmail.com", "time": "2014-08-14T07:21:06Z", "bug_id": 56852, "creation_time": "2014-08-14T07:21:06Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 56852, "attachment_id": null, "id": 177292, "time": "2014-08-21T07:45:04Z", "creator": "silencon@gmail.com", "creation_time": "2014-08-21T07:45:04Z", "is_private": false, "text": "i fixed this problem."}, {"count": 2, "tags": [], "bug_id": 56852, "attachment_id": null, "is_private": false, "id": 177307, "time": "2014-08-22T08:29:53Z", "creator": "robertsdjguard-poidev@yahoo.com", "creation_time": "2014-08-22T08:29:53Z", "text": "Would you mind creating a patch or sharing how you fixed the problem please? \n\nThis issue has come up a few times and since I also need more than 1024 comments in my project it would be good for it to be fixed once and for all."}, {"count": 3, "tags": [], "creator": "silencon@gmail.com", "attachment_id": null, "id": 178497, "time": "2014-10-16T02:25:28Z", "bug_id": 56852, "creation_time": "2014-10-16T02:25:28Z", "is_private": false, "text": "(In reply to Darren Roberts from comment #2)\n> Would you mind creating a patch or sharing how you fixed the problem please? \n> \n> This issue has come up a few times and since I also need more than 1024\n> comments in my project it would be good for it to be fixed once and for all.\n\nthe class HSSFShape HSSFShapeGroup HSSFComment will set the shape id through the setSharpId method, the setSharpId value is sharpId % 1024, this is the problem.\nHSSFPatriarch's createCellComment method will call the class EscherAggregate's addTailRecord method finally.\nthe addTailRecord is:\ntailRec.put(note.getShapeId(), note);\nthe tailRec is the LinkedHashMap<Integer, NoteRecord> object.\n\nthe type of map key is Integer. the key's value is note.getShapeId().\n\nthe key --> sharpId % 1024 --> the value of key will be repeated.\n\nthe size of the tailRec is 1024 forever.\n\nthis is the point of the problem."}, {"count": 4, "tags": [], "bug_id": 56852, "attachment_id": null, "is_private": false, "id": 181679, "time": "2015-03-11T20:07:37Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-03-11T20:07:37Z", "text": "This and bug 55275 actually handle the same thing as far as I see.\n\n*** This bug has been marked as a duplicate of bug 55275 ***"}]