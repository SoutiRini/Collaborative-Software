[{"count": 0, "tags": [], "creator": "zhouyanming@gmail.com", "attachment_id": null, "is_private": false, "id": 142935, "time": "2010-12-24T00:29:33Z", "bug_id": 50518, "creation_time": "2010-12-24T00:29:33Z", "text": "jdk1.6.0_20 works fine,maybe this is a bug of jdk1.6.0_23\nI hope tomcat team could explain why,thanks."}, {"count": 1, "tags": [], "bug_id": 50518, "attachment_id": null, "id": 142939, "time": "2010-12-24T05:29:47Z", "creator": "bugzilla@pidster.com", "creation_time": "2010-12-24T05:29:47Z", "is_private": false, "text": "Bugzilla is not a support forum. Please ask this question on the Tomcat Users mailing list."}, {"count": 2, "tags": [], "bug_id": 50518, "attachment_id": null, "id": 142997, "time": "2010-12-30T08:36:00Z", "creator": "makub@ics.muni.cz", "creation_time": "2010-12-30T08:36:00Z", "is_private": false, "text": "This is a bug. I can confirm that the same happens with Tomcat 6.0.26.\n\nThis problem is specific to Tomcat and jdk 1.6.0_23. All other applications I have tried are reported to jps and jvisualvm without problems. It also works for Tomcat and jdk 1.6.0_22. Please note that a new JVM version 19.0 was introduced in 1.6.0_23.\n\nI have tracked down the problem to the fact that both jps and jvisualvm detect running JVMs by looking into /tmp/hsperfdata_$USER directory, which is created automatically by all SUN JVMs since JDK 1.4.0_02.  \n\nFor some unknown reason the JVM running Tomcat does not create the files in the /tmp/hsperfdata_$USER directory. Even using -XX:+UsePerfData doesn not help.\n\nThis bug prevents monitoring production servers running Tomcat with jvisualvm."}, {"count": 3, "tags": [], "creator": "jessh@ptc.com", "attachment_id": null, "id": 143000, "time": "2010-12-30T09:06:07Z", "bug_id": 50518, "creation_time": "2010-12-30T09:06:07Z", "is_private": false, "text": "A very short investigation shows the issue.\n\n1) Tomcat specifies -Djava.io.tmpdir=$CATALINA_BASE/temp in its JVM options.\n2) Java 6 Update 23 places the hsperfdata_$USER directory in this directory rather than in the normal location where jps, visualvm, etc, expect it.\n\nIt looks like Oracle needs to either undo this change or provide a means of decoupling these directories, e.g. a temp dir setting that does *not* change the hsperfdata location.\n\nI believe this is a bug in Java 6 Update 23.  If hsperfdata is to be placed in other locations then jps, visualvm, etc, must know how to find it.  This seems unreasonable, so I'd conclude that the hsperfdata location should not be impacted by the java.io.tmpdir setting."}, {"attachment_id": null, "tags": [], "bug_id": 50518, "is_private": false, "count": 4, "id": 143009, "time": "2010-12-30T14:51:11Z", "creator": "mdeggers@gmail.com", "creation_time": "2010-12-30T14:51:11Z", "text": "I briefly tested a temporary work-around.\n\nLaunch visualvm as follows:\n\nvisualvm -J-Djava.io.tmpdir=(Tomcat temp directory)\n\nThere are some caveats. The user running visualvm has to have the correct permissions in order to read the hsperfdata_xxxx data. That instance of visualvm will not be able to monitor other Java processes on the system."}, {"attachment_id": null, "tags": [], "bug_id": 50518, "is_private": false, "count": 5, "id": 143010, "time": "2010-12-30T15:04:37Z", "creator": "mdeggers@gmail.com", "creation_time": "2010-12-30T15:04:37Z", "text": "This looks like fallout from the following:\n\nhttp://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6938627"}, {"attachment_id": null, "tags": [], "bug_id": 50518, "is_private": false, "count": 6, "id": 143011, "time": "2010-12-30T16:23:56Z", "creator": "bugzilla@pidster.com", "creation_time": "2010-12-30T16:23:56Z", "text": "We can close this issue then, as this is a Java problem and not Tomcat\nspecific?"}, {"count": 7, "tags": [], "text": "Thank you for your investigation.\n\nLooks like something that we cannot fix, but we may mention it in\nRELEASE-NOTES, or on the FAQ page on the Wiki site (editable by everyone). It\nis a regression in JDK and concerns not only Tomcat, but any java application\nthat runs with its own value of java.io.tmpdir.\n\n(In reply to comment #3)\n> A very short investigation shows the issue.\n> \n> 1) Tomcat specifies -Djava.io.tmpdir=$CATALINA_BASE/temp in its JVM options.\n\nNote, that if you are using catalina.(sh|bat) to start Tomcat, then the path to\nthe temporary directory can be customized by setting the \"CATALINA_TMPDIR\"\nenvironment variable.\n\nOne can set it either before running the scripts, or in a bin/setenv.(bat|sh)\nfile.\n\n> 2) Java 6 Update 23 places the hsperfdata_$USER directory in this directory\n> rather than in the normal location where jps, visualvm, etc, expect it.\n>", "is_private": false, "id": 143012, "creator": "knst.kolinko@gmail.com", "time": "2010-12-30T16:24:33Z", "bug_id": 50518, "creation_time": "2010-12-30T16:24:33Z", "attachment_id": null}, {"count": 8, "tags": [], "text": "Yep - this is a JVM issue, not a Tomcat bug. I've added a known issues section to the FAQ.", "attachment_id": null, "bug_id": 50518, "id": 143048, "time": "2011-01-04T07:37:45Z", "creator": "markt@apache.org", "creation_time": "2011-01-04T07:37:45Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 50518, "is_private": false, "count": 9, "id": 143194, "time": "2011-01-07T18:35:22Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2011-01-07T18:35:22Z", "text": "(In reply to comment #8)\n> I've added a known issues section to the FAQ.\n\nFor reference:\nThe known issues FAQ page is [1].\nThe Sun/Oracle bug page for this issue is [2].\n\n[1] http://wiki.apache.org/tomcat/FAQ/KnownIssues#OracleJREIssues\n\n[2] http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7009828"}]