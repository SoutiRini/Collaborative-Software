[{"count": 0, "tags": [], "text": "Created attachment 30363\nA patch file containing CORS filter source code, units tests, and changes to tomcat documentation's filter.xml.\n\nCORS Filter implementation\n\nThis is an enhancement request to include CORS Filter as one of Tomcat's container provided filters.\n\nCORS (Cross Origin Resource Sharing) is a W3C specification (http://www.w3.org/TR/cors/) that defines a mechanism to enable cross origin requests. This is a Java Servlet Filter implementation of server-side CORS.\n\nHere are few reasons that makes this implementation is a good fit:\n* Implements all required sections of the spec for servers. Handles simple/actual and pre-flight requests as per the specification.\n* Written specifically to fit well with Tomcat's source, and is formatted the same as Tomcat's source.\n* Filter implementation is just one class and is well Javadoc'd\n* Includes ample unit tests to validate the implementation against the spec\n* Simple to configure minimally and use\n* Easy to override default configuration, if required\n* Protects against CRLF injection / response splitting attacks.\n\nWe(eBay) would like to contribute this implementation to Apache Software\nFoundation, to be included in Tomcat 8. And, I would also like to maintain and develop it, going forward. \n\nIt's true that as a Servlet Filter, any webapp developer may add it to their app whether Tomcat includes it or not, but we believe that this is fundamental server behavior that should be present and easy to enable in the server, as it is in some other servers.", "is_private": false, "bug_id": 55046, "id": 167573, "time": "2013-06-02T00:48:49Z", "creator": "mohitsoni1989@gmail.com", "creation_time": "2013-06-02T00:48:49Z", "attachment_id": 30363}, {"count": 1, "tags": [], "bug_id": 55046, "attachment_id": 30364, "text": "Created attachment 30364\nCORS Filter's request processing flowchart.\n\nPlease include this flowchart image into webapps/docs/images/ folder. I have linked this from CORS documentation section in filter.xml.", "id": 167574, "time": "2013-06-02T00:53:15Z", "creator": "mohitsoni1989@gmail.com", "creation_time": "2013-06-02T00:53:15Z", "is_private": false}, {"count": 2, "tags": [], "text": "Comment on attachment 30363\nA patch file containing CORS filter source code, units tests, and changes to tomcat documentation's filter.xml.\n\nMarked attachment as a patch.", "attachment_id": 30363, "bug_id": 55046, "id": 167575, "time": "2013-06-02T00:54:00Z", "creator": "mohitsoni1989@gmail.com", "creation_time": "2013-06-02T00:54:00Z", "is_private": false}, {"count": 3, "tags": [], "text": "I've started to merge the patch into Tomcat trunk (with the assumption it will be back-ported to 7.0.x). So far I have the following comments:\n- ALv2 license headers are missing\n- No i18n (use of StringManager)\n- Trailing whitespace\n- No use of <> (Tomcat 8 is Java 7 minimum)\n- Javadoc warnings\n- Generics warnings\n- Autoboxing warnings\n- In Tomcat unit tests mock objects are named TesterXxx\n- There is already a mock HttpServletRequest that could have been re-used\n- Missing @Override\n\nThe issues are all minor but this is a large patch so there are a fair few of them.\n\nIn addition to expecting a clean build (with Checkstyle enabled) we also provide IDE settings for Eclipse that can help with aligning patches with the coding standards (such as there are) for Tomcat.\n\nI'll continue working on this tomorrow.", "attachment_id": null, "bug_id": 55046, "id": 167638, "time": "2013-06-03T22:26:32Z", "creator": "markt@apache.org", "creation_time": "2013-06-03T22:26:32Z", "is_private": false}, {"count": 4, "attachment_id": 30384, "creator": "mohitsoni1989@gmail.com", "text": "Created attachment 30384\nRevised patch to address several comments.\n\nThanks Mark, it's great to know that a back-port for 7.0.x is being considered.\n\nI have provided a new patch with:\n+ ALv2 license headers\n+ Removed trailing whitespace (ran ant -Dexecute.validate=true validate, to verify)\n+ Updated test code to use Generics.\n+ Removed Generics warnings\n+ Renamed mock object to follow TesterXxx pattern.\n+ Added missing @Override for interface implementations.\n+ Fixed Autoboxing warnings\n+ Fixed Javadoc warnings\n\nStill pending:\n- No i18n (use of StringManager)\n  Saw couple of examples from other tomcat classes. Should CORSFilter extends from FilterBase to use the StringManager ? \n- There is already a mock HttpServletRequest that could have been re-used.\n  Not sure, which one you are referring to. Found couple of implementations. But, agree that a duplicate shouldn't be there. Can you recommend one that can be used ?", "id": 167644, "time": "2013-06-04T05:41:12Z", "bug_id": 55046, "creation_time": "2013-06-04T05:41:12Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "text": "Thanks for the updated patch but as I has already started work on the previous patch I have continued with that. The feedback was intended for future patches rather than a list of changes required for this patch.\nAdditional notes from this morning's work:\n- Use of ServletContext.log() has been removed\n- Visibility, particularly of methods, has been reduced\n- line length in docs\n- s/Ex/Eg/\n\nThe patch has been applied to trunk.\n\nI'll wait on back-porting it to 7.0.x to give you a chance to review the applied patch. I'd like to include this in 7.0.41 which will be tagged in the next day or so the sooner you can review the applied patch the better.", "attachment_id": null, "bug_id": 55046, "id": 167650, "time": "2013-06-04T10:53:58Z", "creator": "markt@apache.org", "creation_time": "2013-06-04T10:53:58Z", "is_private": false}, {"count": 6, "tags": [], "text": "Created attachment 30395\nUpdated documentation filter.xml.\n\nI have reviewed the last patch, it looks fine to me functionality wise. \n\nI have updated the filter.xml to reflect change in class name from CORSFilter to CorsFilter, and have made other minor changes to documentation.\n\nReally excited to know that it's getting included in 7.0.41 as well.", "attachment_id": 30395, "bug_id": 55046, "id": 167672, "time": "2013-06-05T01:54:06Z", "creator": "mohitsoni1989@gmail.com", "creation_time": "2013-06-05T01:54:06Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 55046, "text": "The updated docs has been applied to trunk and the CORS filter changes have been back-ported to 7.0.x and will be included in 7.0.41 onwards.\n\nThanks for the patch.", "id": 167677, "time": "2013-06-05T10:01:34Z", "creator": "markt@apache.org", "creation_time": "2013-06-05T10:01:34Z", "is_private": false, "attachment_id": null}]