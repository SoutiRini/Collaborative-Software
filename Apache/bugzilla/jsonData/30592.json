[{"count": 0, "tags": [], "bug_id": 30592, "text": "Using a .htaccess to authenticate against an LDAP server:\n\nAuthType Basic\nAuthLDAPURL \"ldap://localhost ldap.host.com:10389/ou=myorg?uid?sub\"\nRequire valid-user\n\nFailover is only working if all LDAP servers using the same port.\nThe port number can only be specified after the last server.\n\nIt should be possible to specify port numbers for all ldap servers.", "id": 61817, "time": "2004-08-11T13:22:39Z", "creator": "eruff@web.de", "creation_time": "2004-08-11T13:22:39Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "text": "The URL handling follows the RFC for LDAP URL handling, and is controlled by the\nLDAP library being used - which may or may not allow what you describe.\n\nIn v2.1 of httpd, which now uses apr v1.0, the URL handling is no longer done by\nthe LDAP library, but by custom code in apr-util instead, making this possible.\n\nWill have to check RFC implications first though.\n", "attachment_id": null, "id": 65239, "creator": "minfrin@apache.org", "time": "2004-10-17T18:10:45Z", "bug_id": 30592, "creation_time": "2004-10-17T18:10:45Z", "is_private": false}, {"count": 2, "tags": [], "creator": "bnicholes@apache.org", "attachment_id": null, "text": "I have already been looking into this one.  The issue is that the URL_parse \nfunction assigns the port value to the first :port that it find in the URL.  \nIt uses that port in the ldap_init() call which becomes the default port for \nany host that does not also specify a port.  The solution is to always pass \nthe default ports (ie. 389 or 636) in the ldap_init() calls in apr_ldap_init\n().  This will cause the default ports to be used if the host does not specify \na port.  LDAP will do the right thing for any other host:port in the URL.", "id": 65277, "time": "2004-10-18T14:00:53Z", "bug_id": 30592, "creation_time": "2004-10-18T14:00:53Z", "is_private": false}, {"count": 3, "tags": [], "creator": "bnicholes@apache.org", "attachment_id": null, "text": "There are 2 patches for this bug, one in apr_ldap_url.c and the other in \nutil_ldap.c.  The parsing function in apr_ldap_url.c was assuming that the \nhost string would only contain a single host.  Therefore it truncated the host \nportion of the URL after the first :port that it found.  If the last host in \nthe URL also specified a :port, then it assumed that all hosts could be \nreachable on the same port.\n\nOnce this was fixed then util_ldap.c needed to call apr_ldap_init() always \nspecifying the default ports for LDAP and LDAPS.  If the host string also \nincludes ports, they will override any port specified in the port parameter. \n\nBoth of these fixes have been committed to HEAD and need to be backported.  ", "id": 65660, "time": "2004-10-25T18:41:06Z", "bug_id": 30592, "creation_time": "2004-10-25T18:41:06Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 30592, "text": "As Graham mentioned above, the ldap url parsing in 2.0 is handled by the LDAP \nlibraries.  ldap_parse_url() truncates the host list after the first host:port \nis found.  There appears to be some inconsistencies between the different \nSDK's with regards to this function.  To fix this issue in 2.0, at least the \nrecent patches to apr_ldap_url.c would have to be backported and all of the \nplatforms would have to use the apr version of ldap_parse_url() rather than \nthe LDAP library version.", "id": 65675, "time": "2004-10-25T23:54:56Z", "creator": "bnicholes@apache.org", "creation_time": "2004-10-25T23:54:56Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "minfrin@apache.org", "attachment_id": null, "text": "I am assuming that the patches have been applied. If not, please reopen this bug.\n", "id": 69954, "time": "2005-01-21T23:07:56Z", "bug_id": 30592, "creation_time": "2005-01-21T23:07:56Z", "is_private": false}]