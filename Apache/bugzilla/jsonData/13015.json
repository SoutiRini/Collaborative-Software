[{"count": 0, "tags": [], "bug_id": 13015, "text": "PROBLEM:\n\nIn conf/server.xml, Tomcat can't deploy a web application\nwhose <Context> tag includes <Resources> tag\nin the case that it has JAR file in /WEB-INF/lib directory.\n\n\nFor example, Tomcat can't deploy an application 'ttt' for which\n<Context> and <Resource> tag are put in conf/server.xml like:\n\n  <Context path=\"/ttt\" docBase=\"ttt\">\n    <Resource className=\"org.apache.naming.resources.FileDirContext\" />\n  </Context>\n\n\nTomcat says as following:\n\n2002-09-26 11:28:07 ContextConfig[/ttt]:  Accumulating TLD resource paths\n2002-09-26 11:28:07 ContextConfig[/ttt]:   Scanning <taglib> elements in web.xml\n2002-09-26 11:28:07 ContextConfig[/ttt]:   Scanning TLDs in /WEB-INF subdirector\ny\n2002-09-26 11:28:07 ContextConfig[/ttt]:   Scanning JARs in /WEB-INF/lib subdire\nctory\n2002-09-26 11:28:07 ContextConfig[/ttt]:    Adding path '/WEB-INF/lib/ttt.jar'\n2002-09-26 11:28:07 ContextConfig[/ttt]:  Scanning JAR at resource path '/WEB-IN\nF/lib/ttt.jar'\n2002-09-26 11:28:07 ContextConfig[/ttt] Exception processing JAR at resource pat\nh /WEB-INF/lib/ttt.jar\njavax.servlet.ServletException: Exception processing JAR at resource path /WEB-I\nNF/lib/ttt.jar\n        at org.apache.catalina.startup.ContextConfig.tldScanJar(ContextConfig.ja\n        va:932)\n\n...\n----- Root Cause -----\njava.io.FileNotFoundException\n        at org.apache.naming.resources.DirContextURLConnection.getInputStream(Di\nrContextURLConnection.java:344)\n...\n\n\nCAUSE:\n\nIn org.apache.catalina.startup.ContextRuleSet#addRuleInstances(),\ndigester.addSetNext(prefix + \"Context/Resources\", \"setResources\",\n\"javax.naming.directory.DirContext\") method (Line 242) is called\nafter digester.addSetNext(prefix + \"Context\", \"addChild\",\n\"org.apache.catalina.Container\") method (Line 162) is called.\nHowever, ACTUALLY addChild() method is called after setResources()\nmethod.\n\nTherefore, getParent() method (Line 771 In org.apache.catalina.core.\nContainerBase) returns null\nin org.apache.catalina.core.ContainerBase#setResources() and Tomcat\nworks wrong when it searches for JAR files in /WEB-INF/lib directory.\n(setParent() method MUST be called from addChild() method\nbefore setResources() is called.)", "id": 23406, "time": "2002-09-26T06:37:42Z", "creator": "takehiko.yokota@toshiba.co.jp", "creation_time": "2002-09-26T06:37:42Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 13015, "text": "*** Bug 13017 has been marked as a duplicate of this bug. ***", "id": 23417, "time": "2002-09-26T08:18:36Z", "creator": "remm@apache.org", "creation_time": "2002-09-26T08:18:36Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 13015, "attachment_id": null, "text": "This has been fixed. The fix will be included in Tomcat 4.1.13. I've also\nrefactored the whole handling of the resources to make it cleaner.", "id": 23424, "time": "2002-09-26T10:27:43Z", "creator": "remm@apache.org", "creation_time": "2002-09-26T10:27:43Z", "is_private": false}]