[{"count": 0, "tags": [], "text": "While trying to generate an EMF+ image file by creating a picture in Office, I\nfound something slightly interesting.\n\nUsing getDocument().getPicturesTable().getAllPictures() on a Word 2003 document\nresults in an image coming out as four bytes of data, equal to 0x80000000\n(little endian.)\n\nThis is probably a placeholder indicating that the actual data is stored\nelsewhere, but I'm not yet sure where.", "is_private": false, "bug_id": 41898, "id": 100646, "time": "2007-03-19T22:34:10Z", "creator": "trejkaz@trypticon.org", "creation_time": "2007-03-19T22:34:10Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 41898, "text": "Created attachment 19749\nTest document containing a single image, possibly in EMF+ format", "id": 100647, "time": "2007-03-19T22:34:49Z", "creator": "trejkaz@trypticon.org", "creation_time": "2007-03-19T22:34:49Z", "is_private": false, "attachment_id": 19749}, {"count": 2, "text": "Is it possible to also get the original image you added to the document?\n\n(We can then go hunting for byte sequences from the original image, which might\nmake it easier to figure out how to turn the 4 byte value into a way to get at\nthe image)", "bug_id": 41898, "is_private": false, "id": 100654, "time": "2007-03-20T03:29:52Z", "creator": "apache@gagravarr.org", "creation_time": "2007-03-20T03:29:52Z", "tags": [], "attachment_id": null}, {"count": 3, "text": "It was drawn in the picture editor.  I found the bytes in there (search \nfor \"This\" encoded as UTF-16 LE.)\n\nIf I had the raw bytes for the image already then I wouldn't go through this \nconvoluted mechanism of trying to obtain them.  My own goal is just to acquire \nan EMF+ image.  I think I've failed to do so but in the process I found this \ninteresting situation. :-)", "creator": "trejkaz@trypticon.org", "is_private": false, "id": 100655, "time": "2007-03-20T03:46:50Z", "bug_id": 41898, "creation_time": "2007-03-20T03:46:50Z", "tags": [], "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "apache@gagravarr.org", "is_private": false, "count": 4, "id": 101168, "time": "2007-03-29T10:37:49Z", "bug_id": 41898, "creation_time": "2007-03-29T10:37:49Z", "text": "I've added your word doc to svn, and included a test of the current (incorrect)\nbehavour in usermodel.TestPictures\n\nDid you have any luck finding a real offset anywhere? I wonder if the 0x8000...\nis some sort of mask you have to apply to a value to get the real offset, but\nthat could be wrong."}, {"count": 5, "tags": [], "text": "I can't see another offset no matter how hard I look.\n\nMaybe it's stored elsewhere, like in the WordDocument stream where the image \nis embedded (which would mean we'd have to either read through the \nWordDocument to find the images, or locate images by scanning for that magic \nnumber instead of assuming the next one starts at the same spot.)\n", "is_private": false, "bug_id": 41898, "id": 101206, "time": "2007-03-30T01:05:04Z", "creator": "trejkaz@trypticon.org", "creation_time": "2007-03-30T01:05:04Z", "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 41898, "text": "The image is not stored as EMF, but as Office Drawing format.\n\nYou can access shape id (1044) using new OfficeDrawings interface. After that you will need additional work with org.apache.poi.ddf package to draw/extract/convert picture.\n\nThus I'm closing this issue as INVALID.", "id": 148506, "time": "2011-08-09T13:03:30Z", "creator": "vlsergey@gmail.com", "creation_time": "2011-08-09T13:03:30Z", "is_private": false, "attachment_id": null}]