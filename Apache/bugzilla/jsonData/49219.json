[{"attachment_id": 25371, "tags": [], "bug_id": 49219, "is_private": false, "count": 0, "id": 136515, "time": "2010-04-29T08:24:50Z", "creator": "erhan14@yahoo.com", "creation_time": "2010-04-29T08:24:50Z", "text": "Created attachment 25371\nsample excel file that gives error\n\nWhen reading the following file which contains macros POI gives the following error.\n\n\norg.apache.poi.hssf.record.RecordFormatException: Not enough data (0) to read requested (1) bytes\n\tat org.apache.poi.hssf.record.RecordInputStream.checkRecordPosition(RecordInputStream.java:215)\n\tat org.apache.poi.hssf.record.RecordInputStream.readByte(RecordInputStream.java:223)\n\tat org.apache.poi.hssf.record.RecordInputStream.readUByte(RecordInputStream.java:253)\n\tat org.apache.poi.hssf.record.ExternalNameRecord.<init>(ExternalNameRecord.java:148)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:494)\n\tat org.apache.poi.hssf.record.RecordFactory$ReflectionRecordCreator.create(RecordFactory.java:56)\n\tat org.apache.poi.hssf.record.RecordFactory.createSingleRecord(RecordFactory.java:263)\n\tat org.apache.poi.hssf.record.RecordFactoryInputStream.readNextRecord(RecordFactoryInputStream.java:270)\n\tat org.apache.poi.hssf.record.RecordFactoryInputStream.nextRecord(RecordFactoryInputStream.java:236)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:392)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:276)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:201)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:317)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:298)\n\tat com.amwebexpert.tags.workbook.model.InMemoryWorkbook.loadWorkbook(InMemoryWorkbook.java:180)\n\tat com.amwebexpert.tags.workbook.model.InMemoryWorkbook.<init>(InMemoryWorkbook.java:121)\n\tat com.amwebexpert.tags.workbook.model.InMemoryWorkbook.<init>(InMemoryWorkbook.java:92)\n\tat com.amwebexpert.tags.workbook.model.InMemoryWorkbookWebUtils.getInMemoryWorkbook(InMemoryWorkbookWebUtils.java:62)\n\tat com.amwebexpert.tags.workbook.WorkbookTag.doStartTag(WorkbookTag.java:81)\n\tat org.apache.jsp.demo01_jsp._jspx_meth_wkb_005fworkbook_005f0(demo01_jsp.java:125)\n\tat org.apache.jsp.demo01_jsp._jspService(demo01_jsp.java:84)\n\tat org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n\tat org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:393)\n\tat org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:320)\n\tat org.apache.jasper.servlet.JspServlet.service(JspServlet.java:266)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:263)\n\tat org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:844)\n\tat org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:584)\n\tat org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)\n\tat java.lang.Thread.run(Thread.java:595)"}, {"count": 1, "tags": [], "bug_id": 49219, "is_private": false, "text": "Looking at the spec closely, it seems that the DDE Link operation part is optional, and we assumed it was there.\n\nFixed in r1082958.", "id": 145088, "time": "2011-03-18T11:52:15Z", "creator": "apache@gagravarr.org", "creation_time": "2011-03-18T11:52:15Z", "attachment_id": null}]