[{"count": 0, "tags": [], "bug_id": 52296, "attachment_id": 28043, "is_private": false, "id": 152028, "time": "2011-12-06T21:18:24Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2011-12-06T21:18:24Z", "text": "Created attachment 28043\nTest plan to reproduce issue\n\nRunning the attached Test Plan (I simplified by replacing HTTP Sampler by Debug Sampler), I get the following message:\n2011/12/06 22:13:53 WARN  - jmeter.control.TransactionController: Could not fetch SamplePackage \n2011/12/06 22:13:53 ERROR - jmeter.samplers.SampleResult: sampleEnd called twice java.lang.Throwable: Invalid call sequence\n\tat org.apache.jmeter.samplers.SampleResult.sampleEnd(SampleResult.java:985)\n\tat org.apache.jmeter.control.TransactionController.next2(TransactionController.java:177)\n\tat org.apache.jmeter.control.TransactionController.next(TransactionController.java:101)\n\tat org.apache.jmeter.control.GenericController.nextIsAController(GenericController.java:195)\n\tat org.apache.jmeter.control.TransactionController.nextIsAController(TransactionController.java:139)\n\tat org.apache.jmeter.control.GenericController.next(GenericController.java:148)\n\tat org.apache.jmeter.control.TransactionController.next2(TransactionController.java:171)\n\tat org.apache.jmeter.control.TransactionController.next(TransactionController.java:101)\n\tat org.apache.jmeter.control.GenericController.nextIsAController(GenericController.java:195)\n\tat org.apache.jmeter.control.TransactionController.nextIsAController(TransactionController.java:139)\n\tat org.apache.jmeter.control.GenericController.next(GenericController.java:148)\n\tat org.apache.jmeter.control.TransactionController.next2(TransactionController.java:171)\n\tat org.apache.jmeter.control.TransactionController.next(TransactionController.java:101)\n\tat org.apache.jmeter.control.GenericController.nextIsAController(GenericController.java:186)\n\tat org.apache.jmeter.control.GenericController.next(GenericController.java:148)\n\tat org.apache.jmeter.control.LoopController.next(LoopController.java:108)\n\tat org.apache.jmeter.threads.AbstractThreadGroup.next(AbstractThreadGroup.java:75)\n\tat org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:268)\n\tat java.lang.Thread.run(Thread.java:680)\n\n\nIssue occurs on 2.5.1 , 2.5 and 2.4."}, {"count": 1, "tags": [], "text": "Created attachment 28044\nMuch simpler Test Plan", "is_private": false, "id": 152030, "creator": "p.mouawad@ubik-ingenierie.com", "time": "2011-12-06T21:28:31Z", "bug_id": 52296, "creation_time": "2011-12-06T21:28:31Z", "attachment_id": 28044}, {"count": 2, "tags": [], "bug_id": 52296, "attachment_id": 28045, "id": 152032, "time": "2011-12-06T21:57:24Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2011-12-06T21:57:24Z", "is_private": false, "text": "Created attachment 28045\nTest case where issue is always reproduced\n\nIn fact, issue occurs when Throughput Controller decides not to run sample.\n\nSo I created Test Plan where %  is equal to 0 with one user and one iteration to simplify analysis."}, {"count": 3, "tags": [], "text": "Issue is due to the fact that when TPC decides to execute NO sampler, in next2 method of TransactionSampler:\nSampler returnValue = super.next();\nreturnValue will be null so TransactionSampler thinks it has reached end of Controller so it executes sampleEnd, then next time when it has really reached end of controller we get  the error.", "is_private": false, "id": 152033, "creator": "p.mouawad@ubik-ingenierie.com", "time": "2011-12-06T22:08:49Z", "bug_id": 52296, "creation_time": "2011-12-06T22:08:49Z", "attachment_id": null}, {"count": 4, "tags": [], "text": "Date: Tue Dec  6 22:28:51 2011\nNew Revision: 1211209\n\nURL: http://svn.apache.org/viewvc?rev=1211209&view=rev\nLog:\nBug 52296 - Getting ERROR sampleEnd called twice java.lang.Throwable: Invalid call sequence\n\nModified:\n   jmeter/trunk/src/core/org/apache/jmeter/control/TransactionController.java\n   jmeter/trunk/xdocs/changes.xml", "is_private": false, "id": 152036, "creator": "p.mouawad@ubik-ingenierie.com", "time": "2011-12-06T22:29:53Z", "bug_id": 52296, "creation_time": "2011-12-06T22:29:53Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 52296, "text": "Date: Tue Dec  6 22:34:05 2011\nNew Revision: 1211212\n\nURL: http://svn.apache.org/viewvc?rev=1211212&view=rev\nLog:\nBug 52296 - Getting ERROR sampleEnd called twice java.lang.Throwable: Invalid call sequence\nBug 52296 - TransactionController with Child ThrouputController : Getting ERROR sampleEnd called twice java.lang.Throwable: Invalid call sequence when TPC does not run sample\n\nRenamed issue", "id": 152037, "time": "2011-12-06T22:34:45Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2011-12-06T22:34:45Z", "is_private": false, "attachment_id": null}, {"text": "Created attachment 28051\nTest plan to reproduce", "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "attachment_id": 28051, "count": 6, "id": 152059, "time": "2011-12-07T19:13:18Z", "bug_id": 52296, "creation_time": "2011-12-07T19:13:18Z", "is_private": false}, {"count": 7, "tags": [], "text": "Issue is still here if TransactionSampler contains Controllers that may or may not execute sampler and in case of TPC if the total is not equal to 100%", "is_private": false, "id": 152061, "creator": "p.mouawad@ubik-ingenierie.com", "time": "2011-12-07T19:56:35Z", "bug_id": 52296, "creation_time": "2011-12-07T19:56:35Z", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 52296, "attachment_id": null, "is_private": false, "id": 152062, "time": "2011-12-07T21:54:56Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2011-12-07T21:54:56Z", "text": "Date: Wed Dec  7 21:52:39 2011\nNew Revision: 1211656\n\nURL: http://svn.apache.org/viewvc?rev=1211656&view=rev\nLog:\nBug 52296 - TransactionController with Child ThrouputController : Getting ERROR sampleEnd called twice java.lang.Throwable: Invalid call sequence when TPC does not run sample\n\nModified:\n   jmeter/trunk/src/core/org/apache/jmeter/control/TransactionController.java\n   jmeter/trunk/xdocs/changes.xml"}, {"text": "Issue affects TransactionController that have one or more children of type:\n- InterleaveController and subclasses\n- IfController\n- ThroughputController\n\nWhere one of the children Controllers does not execute every time.", "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "attachment_id": null, "count": 9, "id": 152072, "time": "2011-12-08T18:03:27Z", "bug_id": 52296, "creation_time": "2011-12-08T18:03:27Z", "is_private": false}]