[{"count": 0, "tags": [], "creator": "okiddle@yahoo.co.uk", "attachment_id": null, "is_private": false, "id": 120557, "time": "2008-09-12T03:41:55Z", "bug_id": 45789, "creation_time": "2008-09-12T03:41:55Z", "text": "I'm including a PNG file in a document and FOP is crashing with the following exception. This previously worked in fop 0.94. Note that there's a typo in the error message and that could also be fixed.\n\njava.lang.IllegalStateException: The resolution mus be set\n        at org.apache.fop.cli.InputHandler.transformTo(InputHandler.java:217)\n        at org.apache.fop.cli.InputHandler.renderTo(InputHandler.java:125)\n        at org.apache.fop.cli.Main.startFOP(Main.java:166)\n        at org.apache.fop.cli.Main.main(Main.java:197)\n\n---------\n\njava.lang.IllegalStateException: The resolution mus be set\n        at org.apache.xmlgraphics.image.loader.ImageSize.calcSizeFromPixels(ImageSize.java:210)\n\nThe PNG file in question was created using Dia. pngcheck for the image shows:\nOK: a.png (567x400, 24-bit RGB, non-interlaced, 96.0%)\npngmeta showed nothing. My guess is that there is no information in the image to indicate DPI. Surely, in this situation, it should just be guessing. The XSL-FO used is as follows:\n<fo:external-graphic src=\"url(a.png)\" width=\"432pt\" height=\"auto\" content-width=\"scale-to-fit\" content-height=\"scale-to-fit\" content-type=\"content-type:image/png\" text-align=\"center\"/>\nGiven that it is scaling, I would have thought that the resolution should be irrelevant. The XSL-FO file came from Docbook-xsl but I can reproduce it by copying the file into a hello world XSL-FO file.\n\nI'd prefer not to post the image file publicly but if anyone needs it, I can e-mail it privately.\n\nOliver Kiddle"}, {"count": 1, "tags": [], "bug_id": 45789, "text": "Oliver sent me a test file off-list. The PNG contains a pHYs chunk but the resolution is set to 0. This PNG is certainly bad but it is possible to make XML Graphics Commons's image loader framework more robust so it doesn't throw an exception in such a case. Will commit a fix shortly.", "id": 120774, "time": "2008-09-19T00:45:11Z", "creator": "jeremias@apache.org", "creation_time": "2008-09-19T00:45:11Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 45789, "text": "Fixed now in XML Graphics Commons Trunk:\nhttp://svn.apache.org/viewvc?rev=696964&view=rev", "id": 120775, "attachment_id": null, "creator": "jeremias@apache.org", "creation_time": "2008-09-19T00:50:16Z", "time": "2008-09-19T00:50:16Z", "is_private": false}]