[{"count": 0, "attachment_id": null, "creator": "ed_l_wong@hotmail.com", "text": "Hello All,\n\nI've been able to consistantly reproduce a GPF on Apache service shutdown\nusing Openssl 0.9.6i, and Apache 2.0.44.\n\nSwapping to an older version of Openssl (0.9.6g) resolved the GPF.\n\nTo reproduce, simply download and build OpenSSL 0.9.6i and Apache 2.0.44.\nBe sure to configure ssl to use the shmcb ssl session caching.  Launch\napache as a service and browse to the server using SSL.  Then try to stop\nthe apache service.  During shutdown, Apache will GPF.\n\nOddly, if you don't browse to the webserver using SSL, Apache will not GPF\non shutdown.\n\nIf it helps, the call stack looks as follows:\n\nNTDLL! 77f51baa()\nNTDLL! 77f7561d()\napr_file_write(apr_file_t * 0x005e91c8, const void * 0x0006dd6c, unsigned\nint * 0x0006dd58) line 316\napr_file_puts(const char * 0x0006dd6c, apr_file_t * 0x005e91c8) line 441\nlog_error_core(const char * 0x6fd1d948, int 117, int 4, int 720006, const\nserver_rec * 0x00602700, const request_rec * 0x00000000, apr_pool_t *\n0x00000000, const char * 0x6fd1d924, char * 0x0006fdd0) line 543\nap_log_error(const char * 0x6fd1d948, int 117, int 4, int 720006, const\nserver_rec * 0x00602700, const char * 0x6fd1d924) line 561 + 37 bytes\nssl_mutex_on(server_rec * 0x00602700) line 118 + 28 bytes\nssl_scache_shmcb_remove(server_rec * 0x00602700, unsigned char * 0x00689dd8,\nint 32) line 476 + 9 bytes\nssl_scache_remove(server_rec * 0x00602700, unsigned char * 0x00689dd8, int\n32) line 158 + 17 bytes\nssl_callback_DelSessionCacheEntry(ssl_ctx_st * 0x00645240, ssl_session_st *\n0x00689d90) line 1722 + 17 bytes\ntimeout(ssl_session_st * 0x00689d90, timeout_param_st * 0x0006fe6c) line 602\n+ 18 bytes\nlh_doall_arg(lhash_st * 0x006453d0, void (void)* 0x1001a516\ntimeout(ssl_session_st *, timeout_param_st *), void * 0x0006fe6c) line 290 +\n13 bytes\nSSL_CTX_flush_sessions(ssl_ctx_st * 0x00645240, long 0) line 619 + 18 bytes\nSSL_CTX_free(ssl_ctx_st * 0x00645240) line 1259 + 11 bytes\nssl_init_ctx_cleanup(modssl_ctx_t * 0x0064ef68) line 1197 + 21 bytes\nssl_init_ctx_cleanup_server(modssl_ctx_t * 0x0064ef68) line 1213 + 9 bytes\nssl_init_ModuleKill(void * 0x0030c458) line 1249 + 12 bytes\nrun_cleanups(cleanup_t * * 0x0030a5d0) line 1976 + 13 bytes\napr_pool_destroy(apr_pool_t * 0x0030a5c0) line 755 + 12 bytes\napr_pool_destroy(apr_pool_t * 0x00308588) line 752 + 12 bytes\ndestroy_and_exit_process(process_rec * 0x00308618, int 0) line 247\nmain(int 3, const char * const * 0x003024a8) line 658 + 11 bytes\nmainCRTStartup() line 338 + 17 bytes\nKERNEL32! 77e814c7()\n\nThe error in log_error_core is:\n[Mon Mar 03 12:43:04 2003] [warn] (OS 6)The handle is invalid.  : Failed to\nacquire global mutex lock.\n\nThis issue is currently in the dev list, but not as an \"official\" bug.  The \ndev list thread is: http://marc.theaimsgroup.com/?l=apache-\nmodssl&m=104679773921600&w=2.", "id": 32515, "time": "2003-03-05T23:21:42Z", "bug_id": 17701, "creation_time": "2003-03-05T23:21:42Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "jorton@redhat.com", "text": "Thanks for the report.  Since bug 20462 has the most detailed explanation of the\ncause of the problem, marking as duplicate of that bug.\n\n*** This bug has been marked as a duplicate of 20462 ***", "id": 48886, "time": "2003-12-11T10:06:31Z", "bug_id": 17701, "creation_time": "2003-12-11T10:06:31Z", "is_private": false, "attachment_id": null}]