[{"count": 0, "tags": [], "bug_id": 6802, "is_private": false, "text": "[ 507900 ] Format Cells... dialog does not popup\nEmail:    (?)\nDate:\n2002-01-24 01:29 Priority:\n5\nSubmitted By:\nAki Nieminen (akini) Assigned To:\nGlen Stampoultzis (gstamp)\nCategory:\nHSSFSerializer Status:\nOpen\nSummary:\nFormat Cells... dialog does not popup\nI have created a testrun case, which is using your\ntestprogram. This testrun will show few problems:\nhttp://www.mbnet.fi/~akini/java/poi/hssf_testrun.zip\n\nProblem1: 2nd mouse button/Format Cells... dialog does\nnot popup on every cell.\n\nAdd A Comment:\nPlease log in!\n\nIf you cannot login, then enter your email address here:\n\nDO NOT enter passwords or confidential information in your message!\n\nFollowups:\n\nMessage\n\nDate: 2002-01-25 20:55\nSender: gstamp\nLogged In: YES \nuser_id=421925\n\nWierd... even pasting into a new workbook does not fix the \nissue.  Creating a cell manually with same style does not \nseem to cause a problem however.  Might try producing two \nsamples manually and one automatically and use biffview to \nlook at the differences.\n\nDate: 2002-01-24 13:59\nSender: acoliver2\nLogged In: YES \nuser_id=287767\n\nI've seen this.  I'm not sure its a bug in HSSF.. .  It\nseems to happen in *other* files as well.  (I had an old\nformula1 file this seemed to happen in)\n\nDate: 2002-01-24 13:59\nSender: acoliver2\nLogged In: YES \nuser_id=287767\n\nI've seen this.  I'm not sure its a bug in HSSF.. .  It\nseems to happen in *other* files as well.  (I had an old\nformula1 file this seemed to happen in)\n\nAttached Files:\nName Description Download\nNo Files Currently Attached\nChanges:\n\nField Old Value Date By\nassigned_to acoliver2 2002-01-24 13:59 acoliver2", "id": 11365, "time": "2002-03-01T21:15:53Z", "creator": "poi-support@buni.org", "creation_time": "2002-03-01T21:15:53Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "poi-support@buni.org", "attachment_id": null, "is_private": false, "id": 11530, "time": "2002-03-07T02:51:51Z", "bug_id": 6802, "creation_time": "2002-03-07T02:51:51Z", "text": "anyone know anything about this and how we can fix it?  Its kinda annoying."}, {"count": 2, "tags": [], "creator": "william.barker@wilshire.com", "attachment_id": null, "id": 11532, "time": "2002-03-07T05:56:45Z", "bug_id": 6802, "creation_time": "2002-03-07T05:56:45Z", "is_private": false, "text": "I just was playing around with Poi, and just managed to \"fix\" this in my test \nservlet.  It was broken when I did just:\n\trow1.setBorderBottom(HSSFCellStyle.BORDER_DOUBLE);\n(where row1 is instanceof HSSFCellStyle).\nExcel suddenly becomes happy when I do:\n\trow1.setBorderBottom(HSSFCellStyle.BORDER_DOUBLE);\n\trow1.setBottomBorderColor(HSSFCellStyle.PALE_BLUE);\n\t\nThe really strange thing is that both row-1 and row-2 (which has no border \nstyles in my case) are broken.  All the other rows work (which also have no \nborder styles).\n\nI'm still a BIFF novice, so no patch.  But I hope this helps."}, {"count": 3, "tags": [], "bug_id": 6802, "attachment_id": null, "id": 11621, "time": "2002-03-10T10:50:03Z", "creator": "glens@apache.org", "creation_time": "2002-03-10T10:50:03Z", "is_private": false, "text": "Having trouble downloading the test case.  Can someone paste in if they can get \nto it?"}, {"count": 4, "tags": [], "creator": "glens@apache.org", "attachment_id": null, "is_private": false, "id": 11625, "time": "2002-03-10T12:22:29Z", "bug_id": 6802, "creation_time": "2002-03-10T12:22:29Z", "text": "Okay very wierd.  It appears it doesn't like black as a border colour.  Very \nstrange.  Will need to ask Andy about this as I don't know much about how Excel \nhandles colours."}, {"count": 5, "tags": [], "bug_id": 6802, "attachment_id": null, "id": 11627, "creation_time": "2002-03-10T14:37:26Z", "time": "2002-03-10T14:37:26Z", "creator": "poi-support@buni.org", "text": "I'll have to play with this some. . I wonder if it would care if we set the\nborder to white and yet turned it off.  If it didn't then that might be just\nwhat we need.  not sure what we'd do for a black border that is on..  Glen, we\nshould both look at this (I probably won't get to it until next weekend at\nbest), do a sheet with a single cell with a black border, then do the same in\nHSSF -- what's different?  (use our BiffViewer) -- I'm betting there is some\nkind of flag we're not setting if we do not EXPLICITY set it to black...  Just a\nguess though.  Might also want to check Microsoft's \"Knowledge\" base..  There\nare a few Doc bugs for the Dev kit in there.  \"And thats all I have to say aobut\nthat\"\n\nchanged version to 1.5 (target)", "is_private": false}, {"count": 6, "tags": [], "creator": "glens@apache.org", "is_private": false, "text": "Okay, turns out we were using incorrect colour constants for black and \nautomatic.  Now fixed in CVS.  Should be included in the final 1.5 release.", "id": 11640, "time": "2002-03-11T01:55:38Z", "bug_id": 6802, "creation_time": "2002-03-11T01:55:38Z", "attachment_id": null}, {"count": 7, "tags": [], "creator": "poi-support@buni.org", "attachment_id": null, "is_private": false, "id": 11909, "time": "2002-03-17T23:58:19Z", "bug_id": 6802, "creation_time": "2002-03-17T23:58:19Z", "text": "yeppers.. . including only the libraries in the distribution plus the examples\nand running yields this:\n\nException in thread \"main\" java.lang.NoClassDefFoundError:\norg/apache/commons/logging/LogFactory\n\tat org.apache.poi.util.POILogFactory.<clinit>(POILogFactory.java:76)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<clinit>(HSSFWorkbook.java:113)\n\tat org.apache.poi.hssf.usermodel.examples.NewSheet.main(NewSheet.java:73)\n"}, {"count": 8, "tags": [], "creator": "ddb@wamu.net", "is_private": false, "id": 21932, "creation_time": "2002-08-28T22:34:11Z", "time": "2002-08-28T22:34:11Z", "bug_id": 6802, "text": "Tried the 1.5.1 release, used the following code to set the background and border:\n\n        HSSFCellStyle otherStyle = wb.createCellStyle();\n        otherStyle.setFillPattern(HSSFCellStyle.SPARSE_DOTS);\n        otherStyle.setFillBackgroundColor(HSSFColorConstants.YELLOW);\n        otherStyle.setBorderBottom(HSSFCellStyle.BORDER_THICK);\n        HSSFRow anotherRow = sheet.createRow((short)10);\n        anotherRow.createCell((short)7).setCellValue(\"a label\");\n        anotherRow.getCell((short)7).setCellStyle(otherStyle);    \n\n(wb is an instance of HSSFWorkbook, sheet is an HSSFSheet)\n\nStill can't get the \"Format Cells...\" menu selection to work in Excel (from\nOffice XP).  Even if the cell is copied and pasted, Format Cells doesn't work.", "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 6802, "attachment_id": null, "is_private": false, "id": 21934, "time": "2002-08-28T23:13:54Z", "creator": "poi-support@buni.org", "creation_time": "2002-08-28T23:13:54Z", "text": "Don't use HSSFColorConstants.  Use HSSFColor.\n\nhttp://jakarta.apache.org/poi/hssf/quick-guide.html\n\nIf it still doesn't work then let me know."}, {"count": 10, "tags": [], "bug_id": 6802, "attachment_id": 3327, "id": 23809, "time": "2002-10-03T05:18:54Z", "creator": "mark.odonohue@cytopia.com.au", "creation_time": "2002-10-03T05:18:54Z", "is_private": false, "text": "Created attachment 3327\npatch to load my \"=Name\" formula"}, {"count": 11, "tags": [], "bug_id": 6802, "attachment_id": null, "id": 23820, "creation_time": "2002-10-03T10:39:39Z", "time": "2002-10-03T10:39:39Z", "creator": "poi-support@buni.org", "text": "attachment was a mistake (it doesn't have anything to do with this bug)", "is_private": false}, {"count": 12, "tags": [], "creator": "price_ellington@yahoo.com", "attachment_id": null, "id": 26277, "time": "2002-11-14T15:35:05Z", "bug_id": 6802, "creation_time": "2002-11-14T15:35:05Z", "is_private": false, "text": "I'm still having the same problem after changing my code to use HSSFColor \ninstead of HSSFColorConstants, I'm not able to get the format cell dialog box.  \nIs this still an open issue, or am I doing someting wrong?  Below is how I'm \ncreating cells and their styles.  Please let me know if there is a fix when you \nget a chance.  Thanks.\n\nHSSFWorkbook wb = new HSSFWorkbook();       \nHSSFSheet s = wb.createSheet();        \nHSSFRow r = null;\nHSSFCell c = null;\n\nHSSFCellStyle cs_amt = wb.createCellStyle();\nHSSFFont f = wb.createFont();                        \nf.setFontHeightInPoints((short)10);\nf.setBoldweight(f.BOLDWEIGHT_BOLD);\n\ncs_amt.setBorderBottom(cs_amt.BORDER_THIN);\ncs_amt.setBorderLeft(cs_amt.BORDER_THIN);\ncs_amt.setBorderRight(cs_amt.BORDER_THIN);\ncs_amt.setAlignment(cs_amt.ALIGN_RIGHT);\ncs_amt.setVerticalAlignment(cs_amt.VERTICAL_BOTTOM);\ncs_amt.setDataFormat(HSSFDataFormat.getFormat(\"(#,##0.00_);(#,##0.00)\"));\ncs_amt.setFont(f);"}, {"count": 13, "tags": [], "creator": "poi-support@buni.org", "attachment_id": null, "id": 26295, "time": "2002-11-14T19:13:05Z", "bug_id": 6802, "creation_time": "2002-11-14T19:13:05Z", "is_private": false, "text": "if you're going to create a style...and put nothing in it...for now make sure\nyou set all the colors to BLACK or AUTO... I'll bet we initialize it to\n0...which is wrong...this is probably abug."}, {"count": 14, "tags": [], "bug_id": 6802, "attachment_id": null, "id": 49928, "creation_time": "2004-01-01T08:59:59Z", "time": "2004-01-01T08:59:59Z", "creator": "avik@apache.org", "text": "Actually, even a7-ab are reported to be percentage formats. So, its best to keep\nthe whole thing out. ", "is_private": false}, {"count": 15, "tags": [], "bug_id": 6802, "attachment_id": null, "id": 49929, "time": "2004-01-01T09:01:04Z", "creator": "avik@apache.org", "creation_time": "2004-01-01T09:01:04Z", "is_private": false, "text": "sorry, disregard previous comment! "}, {"count": 16, "tags": [], "creator": "jheight@apache.org", "attachment_id": null, "is_private": false, "id": 78866, "time": "2005-08-23T05:07:16Z", "bug_id": 6802, "creation_time": "2005-08-23T05:07:16Z", "text": "Now seems to work with CVS HEAD. Test case used, also i created a cell and that\nworked as well.\n\nJason"}]