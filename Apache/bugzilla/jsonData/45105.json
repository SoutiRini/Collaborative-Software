[{"count": 0, "tags": [], "creator": "dominic.adatia@uk.bnpparibas.com", "attachment_id": null, "id": 117189, "time": "2008-05-30T11:26:10Z", "bug_id": 45105, "creation_time": "2008-05-30T11:26:10Z", "is_private": false, "text": "I would like confirmation that this is not a problem due to my local excel setup-\n\n\nWhen I generate a blank workbook and look inside, the columns are all 64 pixels wide - this corresponds to the defaultColumnWidth value in a HSSFSheet.\n\nA call to getColumnWidth((short)1) results in 2048, which is as expected (2048/32 = 64) \n\nIf, however, I do \"setColumnWidth((short)1, (short)2048)\", this results in column(1) being 56 pixels wide.\n\nI tested a few widths, and each time, the pixel width in the spreadsheet is = \n(width/32) * 7/8 (an eighth goes missing!)\n\nSo:\n\nsetColumnWidth(1,2048) -> Column is 56 pixels (expected 64)\nsetColumnWidth(1, 4096) -> Column is 112 pixels (expected 128)"}, {"count": 1, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "id": 117497, "time": "2008-06-09T02:11:33Z", "bug_id": 45105, "creation_time": "2008-06-09T02:11:33Z", "is_private": false, "text": "This is how Excel works.\nThe width of 1 pixel measured in Excel units (1/256th of a character) is different for columns width default and modified width.\n\nFor columns with the default width 1px=32, so 2048/32=64px\nFor columns with modified width 1px=36.56  and 2048/36.56=56px \n\nThe constant 36.56 was found empirically. The Excel spec says nothing about it. \n\nHere is a mock up of a method which returns column width in pixels. \n\n    public int getColumnWidthInPixels(HSSFSheet sheet, short column){\n\n        float px_default = 32.00f;  //width of 1px in columns with the default width\n        float px_modified = 36.56f; //width of 1px in columns with modifed width\n\n        //column width in units of 1/256th of a character\n        int cw = sheet.getColumnWidth(column);\n\n        //default column width in units of 1/256th of a character\n        int dw = sheet.getDefaultColumnWidth()*256;\n\n        float px = cw/(cw == dw ? px_default : px_modified);\n\n        return Math.round(px);\n    }\n\n\nRegards,\nYegor"}]