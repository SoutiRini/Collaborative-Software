[{"count": 0, "attachment_id": null, "creator": "nils@meiers.net", "is_private": false, "id": 85794, "time": "2006-02-15T04:48:53Z", "bug_id": 38648, "creation_time": "2006-02-15T04:48:53Z", "tags": [], "text": "I'm running the attached simply xsl-fo (foo.xml) through the FOTreeBuilder -\nwith \"border=inherit\" this fails because of a NPE below.\n\nSomehow org.apache.fop.fo.properties.PropertyMaker.make(PropertyMaker.java:391)\npasses a defaultValue=null down the line which doesn't fare well.\n\nThanks\nNils\n\n----\n\njava.lang.NullPointerException\n\tat org.apache.fop.fo.expr.PropertyTokenizer.<init>(PropertyTokenizer.java:67)\n\tat org.apache.fop.fo.expr.PropertyParser.<init>(PropertyParser.java:103)\n\tat org.apache.fop.fo.expr.PropertyParser.parse(PropertyParser.java:88)\n\tat org.apache.fop.fo.properties.PropertyMaker.make(PropertyMaker.java:423)\n\tat org.apache.fop.fo.properties.PropertyMaker.make(PropertyMaker.java:391)\n\tat org.apache.fop.fo.properties.PropertyMaker.get(PropertyMaker.java:298)\n\tat org.apache.fop.fo.PropertyList.get(PropertyList.java:171)\n\tat org.apache.fop.fo.StaticPropertyList.get(StaticPropertyList.java:71)\n\tat org.apache.fop.fo.PropertyList.get(PropertyList.java:152)\n\tat org.apache.fop.fo.PropertyList.getFromParent(PropertyList.java:208)\n\tat org.apache.fop.fo.properties.PropertyMaker.make(PropertyMaker.java:412)\n\tat org.apache.fop.fo.PropertyList.convertAttributeToProperty(PropertyList.java:344)\n\tat org.apache.fop.fo.PropertyList.addAttributesToList(PropertyList.java:300)\n\tat org.apache.fop.fo.FObj.processNode(FObj.java:118)\n\tat org.apache.fop.fo.FOTreeBuilder.startElement(FOTreeBuilder.java:216)"}, {"count": 1, "tags": [], "text": "Created attachment 17700\ntest input with simple table using border=inherit in cells", "attachment_id": 17700, "bug_id": 38648, "id": 85795, "time": "2006-02-15T04:50:42Z", "creator": "nils@meiers.net", "creation_time": "2006-02-15T04:50:42Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 38648, "is_private": false, "count": 2, "id": 85802, "time": "2006-02-15T08:53:17Z", "creator": "jeremias@apache.org", "creation_time": "2006-02-15T08:53:17Z", "text": "Hmm, surrounding the code in the PropertyTokenizer's constructor with an \"if (s\n!= null)\" fixes the NPE, but \"inherit\" still doesn't work because only the\ndirect parent gets evaluated. The property value is not properly inherited.\nLooks like this will need further inspection.\n\nWork-around for now: Explicitely specify the border property on every\ntable-cell. Use attribute-sets in XSLT."}, {"count": 3, "tags": [], "text": "I'll have a look at that, since I'm currently active in that part of the source code...\n\nFor now: the only real problem here is that if border has a value of \"inherit\", then only the parent is \nchecked. Which is correct, since the border shorthand is a non-inherited property. Since there are no \nborders specified on the table-row (and the table-body), there is no border to be inherited.\n\nThe error message, however, is confusing and misleading for the end-user, so this definitely needs to \nbe looked at.\n\nAnother possible workaround is to use: border=\"from-nearest-specified-value()\" on the table-cells. I \nhave tried this, and it seems to work nicely... Haven't checked the results yet, but might be an option \nfor Nils.\n\nCheers,\n\nAndreas", "is_private": false, "bug_id": 38648, "id": 85807, "time": "2006-02-15T11:02:03Z", "creator": "adelmelle@apache.org", "creation_time": "2006-02-15T11:02:03Z", "attachment_id": null}, {"count": 4, "tags": [], "text": "Argh, missed that. I thought \"inherit\" meant the same as\nfrom-nearest-specified-value(), not as from-parent(). D'oh! Thanks for setting\nme straight.", "attachment_id": null, "bug_id": 38648, "id": 85808, "time": "2006-02-15T11:07:39Z", "creator": "jeremias@apache.org", "creation_time": "2006-02-15T11:07:39Z", "is_private": false}, {"count": 5, "tags": [], "text": "FWIW: I still stumble over these inheritance issues myself from time to time... :-)\n\nI think the cause for the NPE being thrown is the fact that there is no default set on the PropertyMaker for \nthe border shorthand (see: FOPropertyMapping.createShorthandProperties()). As such, the call to \nPropertyList.getFromParent() returns null (instead of, say, an empty string \"\") This leads to \nPropertyMaker.make() trying to run that null value through the PropertyParser, and the parser chokes on it.\n\nI'll add this ASAP, but would like to add a little warning as well. \nSomething like: \"Specified value of 'inherit', but the property was not found on the parent... Using default \nvalue.\"", "attachment_id": null, "bug_id": 38648, "id": 85809, "time": "2006-02-15T11:58:07Z", "creator": "adelmelle@apache.org", "creation_time": "2006-02-15T11:58:07Z", "is_private": false}, {"count": 6, "tags": [], "text": "Added a default value of \"\" to avoid the NPE being thrown.\n\nStill TODO: add the warning. Property now silently falls back to the default value...\n\nMain issue is fixed: FOP doesn't crash anymore in this case.\n\nSee: http://svn.apache.org/viewcvs?rev=378003&view=rev", "is_private": false, "id": 85813, "creation_time": "2006-02-15T14:11:03Z", "time": "2006-02-15T14:11:03Z", "creator": "adelmelle@apache.org", "bug_id": 38648, "attachment_id": null}, {"count": 7, "tags": [], "creator": "nils@meiers.net", "attachment_id": null, "id": 85814, "time": "2006-02-15T15:01:36Z", "bug_id": 38648, "creation_time": "2006-02-15T15:01:36Z", "is_private": false, "text": "(In reply to comment #3)\n> For now: the only real problem here is that if border has \n> a value of \"inherit\", then only the parent is checked. \n> Which is correct, since the border shorthand is a \n> non-inherited property. Since there are no borders specified \n> on the table-row (and the table-body), there is no border to \n> be inherited.\n\njust to clarify - there's a border property on the 'table'.\nThat doesn't count for inherit? I can't specify a border on\n'table-body' because with border-collapse=\"separate\" FOP \nreports \"borders cannot be specified on a fo:table-body\".\n\nI know I can set the border on each cell but i wanted to \nnot repeat that border property if i don't have to :)\n\nThanks\nNils"}, {"count": 8, "attachment_id": null, "creator": "adelmelle@apache.org", "is_private": false, "id": 85815, "time": "2006-02-15T15:11:30Z", "bug_id": 38648, "creation_time": "2006-02-15T15:11:30Z", "tags": [], "text": "Nils,\n\nYour comment is correct. Because border (just like the individual border-* properties) is not an \ninherited property, the value is not automatically inherited by the descendant table-body and table-\nrow. So, the property gets its default/initial value on the table-row --null in this case, but this has been \nrectified-- and that value is then inherited by the table-cell.\n\nThe only ways I see to avoid having to specify border=\"inherit\" on the intermediate table-body and \ntable-row, is to follow either my suggestion, and use border=\"from-nearest-specified-value()\" or \nJeremias' option of repeating the border specs on every table-cell.\n\nCheers,\n\nAndreas"}, {"count": 9, "tags": [], "creator": "adelmelle@apache.org", "attachment_id": null, "id": 85816, "time": "2006-02-15T15:16:17Z", "bug_id": 38648, "creation_time": "2006-02-15T15:16:17Z", "is_private": false, "text": "Just thought of a third option: use border=\"inherit\" on the table-columns --they will inherit the table's \nborders--, and have the table-cells get that value through border=\"from-table-column()\"\n"}, {"count": 10, "tags": [], "creator": "gadams@apache.org", "attachment_id": null, "id": 155597, "time": "2012-04-01T06:29:56Z", "bug_id": 38648, "creation_time": "2012-04-01T06:29:56Z", "is_private": false, "text": "batch transition pre-FOP1.0 resolved+fixed bugs to closed+fixed"}]