[{"count": 0, "attachment_id": null, "bug_id": 56050, "text": "We run tomcat with a few web applications, recently tomcat was updated from 7.0.35 to 7.0.50 and now on server shutdown an exception is reported for every context:\n\nJan 21, 2014 4:47:06 PM org.apache.catalina.loader.WebappClassLoader clearReferencesJdbc\nWARNING: JDBC driver de-registration failed for web application [/manager]\njava.lang.NullPointerException\n\tat org.apache.catalina.loader.WebappClassLoader.clearReferencesJdbc(WebappClassLoader.java:2054)\n\tat org.apache.catalina.loader.WebappClassLoader.clearReferences(WebappClassLoader.java:1990)\n\tat org.apache.catalina.loader.WebappClassLoader.stop(WebappClassLoader.java:1902)\n\tat org.apache.catalina.loader.WebappLoader.stopInternal(WebappLoader.java:662)\n\tat org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:232)\n\tat org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:5527)\n\tat org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:232)\n\tat org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1575)\n\tat org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1564)\n\tat java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:166)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1146)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n\tat java.lang.Thread.run(Thread.java:701)\n\njava -version\njava version \"1.6.0_27\"\nOpenJDK Runtime Environment (IcedTea6 1.12.6) (6b27-1.12.6-1ubuntu0.12.04.4)\nOpenJDK 64-Bit Server VM (build 20.0-b12, mixed mode)\n\nUbuntu 12.04 with binary packages from https://launchpad.net/ubuntu/+source/tomcat7\n\nI am sure how it fails, the referenced lines are:\n\n2053:            Class<?> lpClass =\n2054:                defineClass(\"org.apache.catalina.loader.JdbcLeakPrevention\",\n2055:                    classBytes, 0, offset, this.getClass().getProtectionDomain());", "id": 172609, "time": "2014-01-22T06:12:17Z", "creator": "alex.panchenko@gmail.com", "creation_time": "2014-01-22T06:12:17Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "text": "Please user the users mailing list if you require further assistance with this warning message about an application memory leak.", "id": 172610, "time": "2014-01-22T07:48:17Z", "bug_id": 56050, "creation_time": "2014-01-22T07:48:17Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 56050, "attachment_id": null, "is_private": false, "id": 172611, "time": "2014-01-22T07:49:05Z", "creator": "markt@apache.org", "creation_time": "2014-01-22T07:49:05Z", "text": "Ignore my last. I read the stacktrace too quickly. The NPE shouldn't happen. I'll take a look."}, {"count": 3, "tags": [], "creator": "knst.kolinko@gmail.com", "is_private": false, "text": "How can it happen?\n\nhttp://svn.apache.org/viewvc/tomcat/tc7.0.x/tags/TOMCAT_7_0_50/java/org/apache/catalina/loader/WebappClassLoader.java?view=markup#l2054\n\nThe only dereferences on that line are in \"this.getClass().getProtectionDomain()\" so \"this\" is null, or \"this.getClass()\" is null?\nBoth of those should not happen.\n\nIs \"ClassLoader.defineClass(..)\" a native method on that JVM, so it is not included in stacktrace?\n\nIs that JVM broken?", "id": 172612, "time": "2014-01-22T08:49:07Z", "bug_id": 56050, "creation_time": "2014-01-22T08:49:07Z", "attachment_id": null}, {"text": "Let's close it for now. It had happened a few times in the beginning of the week on all our servers, but was not happening since then.\nSorry for the false alert.", "tags": [], "creator": "alex.panchenko@gmail.com", "is_private": false, "count": 4, "id": 172658, "time": "2014-01-24T06:44:01Z", "bug_id": 56050, "creation_time": "2014-01-24T06:44:01Z", "attachment_id": null}]