[{"count": 0, "attachment_id": null, "creator": "eaepstein@gmail.com", "text": "The Mac build defines DSO_USE_DYLD which specifies the use of\nNSCreateObjectFileImageFromFile() instead of dlopen(). As a result, the standard\nOSX library path, DYLD_LIBRARY_PATH, is ignored and apr_dso_load is broken.\n\nThe Apple developer site says the use of NSCreateObjectFileImageFromFile is\ndiscouraged. See\nhttp://developer.apple.com/documentation/DeveloperTools/Reference/MachOReference/Reference/reference.html\n\nWhy not use dlopen() on the Mac as is done with most other UNIX?\n\nEddie", "id": 98160, "time": "2007-01-16T13:36:48Z", "bug_id": 41386, "creation_time": "2007-01-16T13:36:48Z", "tags": [], "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 41386, "text": "Renaming the incident to make the issue clearer for review.", "id": 101823, "time": "2007-04-17T15:18:49Z", "creator": "wrowe@apache.org", "creation_time": "2007-04-17T15:18:49Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 41386, "text": "The autoconf code was explicitly written to check for dyld.  Are you sure there\nare no Darwin platforms which e.g. have a present but broken dlopen?  Can you\nbring this up on dev@apr?", "id": 102510, "time": "2007-04-26T09:26:44Z", "creator": "jorton@redhat.com", "creation_time": "2007-04-26T09:26:44Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "wrowe@apache.org", "attachment_id": null, "is_private": false, "id": 110007, "time": "2007-10-31T01:52:28Z", "bug_id": 41386, "creation_time": "2007-10-31T01:52:28Z", "text": "We have a window of opportunity to change this behavior with OS/X 10.5,\nunfortunately there's been no response on the list.\n\nIn general, you cannot count on apr_dso_load searching any path, that would\nbe a platform specific oddity.  Your code will be more portable using the\nexplicit path, so I can't equate this to a bug (purpose of this issue tracker).\n\nSince you hadn't added feedback to Joe's comment, and we will likely address\nthis at some point in the future, I'm closing the report as insufficient and\nwe'll proceed with on list discussion, if you would like to join."}, {"text": "Actually, I did reply to Joe on the apr-dev list back in April. These are added\nbelow. I'm shocked (SHOCKED!) that the behavior for apr_dso_load would not\ninclude searching the current system library load path. It works correctly, that\nis it follows the path for Linux and Windows, just broken for Mac because it is\nusing an antiquated Mac OS9 based API.\n\nEddie\n\n-------------------------\nFrom\t\"Eddie Epstein\" <eaepst...@gmail.com>\nSubject\tFwd: [Bug 41386] - apr_dso_load ignores DYLD_LIBRARY_PATH on Mac OSX\nDate\tFri, 18 May 2007 13:59:22 GMT\n\nFinally got access to the OSX machine. config.log reported:\n  configure:11077: checking whether the gcc linker (/usr/bin/ld)\nsupports shared libraries\n  configure:11973: result: yes\n  configure:12044: checking dynamic linker characteristics\n  configure:12598: result: darwin8.8.1 dyld\n\nThe change to make apr_dso_load this work properly is:\n\ndiff dso.c*\n27,32d26\n< #if defined(DSO_USE_DYLD)\n< #define DSO_USE_DLFCN\n< #undef DSO_USE_DYLD\n< #endif\n<\n<\n\nRegards,\nEddie\n\n---------- Forwarded message ----------\nFrom: Eddie Epstein <eaepstein@gmail.com>\nDate: Apr 27, 2007 5:49 PM\nSubject: [Bug 41386] - apr_dso_load ignores DYLD_LIBRARY_PATH on Mac OSX\nTo: dev@apr.apache.org\n\n\nHi,\n\nUnfortunately I have lost access to the Mac used for development and\ncannot check the output of configure. I will try to get back access to\nthe machine in order to check the configure log.\n\n There are two other pieces of information that could be of interest.\nFirst, a small C program using dlopen() respected DYLD_LIBRARY_PATH\nproperly. Second, the v1.2.7 apr built and installed by Darwin ports\nalso had a broken apr_dso_load().\n\nRegards,\nEddie\n\n------- Additional Comments From jorton@redhat.com  2007-04-26 09:26 -------\nThe autoconf code was explicitly written to check for dyld.  Are you sure there\nare no Darwin platforms which e.g. have a present but broken dlopen?  Can you\nbring this up on dev@apr?\n\n", "tags": [], "bug_id": 41386, "is_private": false, "count": 4, "id": 110027, "time": "2007-10-31T06:01:48Z", "creator": "eaepstein@gmail.com", "creation_time": "2007-10-31T06:01:48Z", "attachment_id": null}, {"count": 5, "attachment_id": null, "creator": "wrowe@apache.org", "text": "This is fixed in apr 1.2.12.\n\nAlthough depreciated, we will not break any previous builds of apr.  If you\nwant this functionality you must compile to OS/X 10.5, or you can hand edit\nthe detection of apr_dso configure flags, which is an exercise left to the\nstudent.", "id": 112446, "time": "2008-01-02T19:42:57Z", "bug_id": 41386, "creation_time": "2008-01-02T19:42:57Z", "tags": [], "is_private": false}, {"count": 6, "tags": [], "bug_id": 41386, "is_private": false, "text": "This is fixed in apr 1.2.12.\n\nAlthough depreciated, we will not break any previous builds of apr.  If you\nwant this functionality you must compile to OS/X 10.5, or you can hand edit\nthe detection of apr_dso configure flags, which is an exercise left to the\nstudent.", "id": 112447, "time": "2008-01-02T19:43:10Z", "creator": "wrowe@apache.org", "creation_time": "2008-01-02T19:43:10Z", "attachment_id": null}]