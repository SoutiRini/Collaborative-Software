[{"count": 0, "tags": [], "creator": "hauser@acm.org", "attachment_id": null, "id": 52760, "time": "2004-02-22T12:55:47Z", "bug_id": 27141, "creation_time": "2004-02-22T12:55:47Z", "is_private": false, "text": "My tomcat spontaneously shuts down. Sometimes after a week or even a month,\nsometimes after a few hours:\n<<GlobalResourcesLifecycleListener: Destroying MBeans for Global JNDI Resources\nStopping service myApp-Standalone\nFATAL [Thread-1] (myServlet.java:236) - Feb 22, 2004 6:21:11 AM: shutting down ...?\nStopping service myApp-Port8080\nHttpConnector[8080] Stopping background thread\nEngineConfig: EngineConfig: Processing STOP\nHostConfig[www.mydom.com]: HostConfig: Processing STOP\nHostConfig[www.mydom.com]: Undeploying deployed web applications\nHostConfig[www.mydom.com]: Undeploying web application at context path\nStandardHost[www.mydom.com]: Removing web application at context path\nStandardContext[]: Stopping\nStandardContext[]: Stopping filters\nStandardContext[]: Sending application stop events\nStandardContext[]: Processing standard container shutdown\nContextConfig[]: ContextConfig: Processing STOP\nStandardContext[]: Stopping complete\nStopping service myApp2\nFATAL [Thread-1] (myServlet.java:236) - Feb 22, 2004 6:21:11 AM: shutting down\n...?>> in non of the logs, I see a reason why.\n\nSometimes, it happens minutes up to an hour after an out-of-memory event.\n\nIs there any way to find out why a shutdown was initiated?\n\n\nA long time ago, others appear to have had similar problems with no reported\nresolution: Bug 6028 or\nhttp://marc.theaimsgroup.com/?l=tomcat-user&m=102680354726732&w=2, ..."}, {"count": 1, "tags": [], "bug_id": 27141, "attachment_id": null, "text": "What code is at line 236 in myservlet.java?", "id": 52830, "time": "2004-02-23T23:27:05Z", "creator": "markt@apache.org", "creation_time": "2004-02-23T23:27:05Z", "is_private": false}, {"count": 2, "tags": [], "creator": "hauser@acm.org", "attachment_id": null, "id": 52835, "time": "2004-02-24T05:53:00Z", "bug_id": 27141, "creation_time": "2004-02-24T05:53:00Z", "is_private": false, "text": "public void destroy() {\n\t\tString stringDate = DateFormat.getDateTimeInstance().format(new Date());\n\t\tlog.fatal( //line 236\n\t\t\tstringDate\n\t\t\t\t+ \": shutting down DB - perhaps due to ...?\");\n\t\tsuper.destroy();\n\t}"}, {"count": 3, "tags": [], "bug_id": 27141, "attachment_id": null, "is_private": false, "id": 54306, "time": "2004-03-20T11:41:36Z", "creator": "markt@apache.org", "creation_time": "2004-03-20T11:41:36Z", "text": "Just had a thought. Try throwing an exception in your destroy() method, \ncatching it and logging the associated stack trace. This might at least give \nus somewhere to start looking."}, {"count": 4, "tags": [], "bug_id": 27141, "attachment_id": null, "text": "done, although that last few weeks, it didn't happen. I'll report if it happens\nagain!", "id": 54307, "time": "2004-03-20T12:21:53Z", "creator": "hauser@acm.org", "creation_time": "2004-03-20T12:21:53Z", "is_private": false}, {"count": 5, "tags": [], "creator": "hauser@acm.org", "attachment_id": null, "id": 54367, "time": "2004-03-22T07:18:02Z", "bug_id": 27141, "creation_time": "2004-03-22T07:18:02Z", "is_private": false, "text": "this time, the shut-down wasn't as clean as before since there was a SEVERE\nexception before the shutdown started, but the 2nd stack-trace is caused by your\nsuggested \n\nnew Exception().printStackTrace();\n\nin the servlet's destroy() method\n\n--> bug 27829"}, {"count": 6, "attachment_id": null, "bug_id": 27141, "text": "this time, it seems to have shut down \"clean\" again:\n\nGlobalResourcesLifecycleListener: Destroying MBeans for Global JNDI Resources\nStopping service myApp-Standalone\njava.lang.Exception\n        at com.privasphere.myApp.myPackage.myServlet.destroy(myServlet.java:444)\n        at org.apache.catalina.core.StandardWrapper.unload(StandardWrapper.java\\\n:1124)\n        at org.apache.catalina.core.StandardWrapper.stop(StandardWrapper.java:1356)\n        at org.apache.catalina.core.ContainerBase.removeChild(ContainerBase.jav\\\na:1036)\n        at org.apache.catalina.startup.ContextConfig.stop(ContextConfig.java:70\\\n1)\n        at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConf\\\nig.java:245)\n        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(Lifecyc\\\nleSupport.java:166)\n        at org.apache.catalina.core.StandardContext.stop(StandardContext.java:3\\\n676)\n        at org.apache.catalina.core.ContainerBase.removeChild(ContainerBase.jav\\\na:1036)\n        at org.apache.catalina.core.StandardHostDeployer.remove(StandardHostDep\\\nloyer.java:470)\n        at org.apache.catalina.core.StandardHost.remove(StandardHost.java:852)\n        at org.apache.catalina.startup.HostConfig.undeployApps(HostConfig.java:\\\n758)\n        at org.apache.catalina.startup.HostConfig.stop(HostConfig.java:738)\n        at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.jav\\\na:360)\n        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(Lifecyc\\\nleSupport.java:166)\n        at org.apache.catalina.core.ContainerBase.stop(ContainerBase.java:1221)\n        at org.apache.catalina.core.ContainerBase.stop(ContainerBase.java:1233)\n        at org.apache.catalina.core.StandardService.stop(StandardService.java:554)\n        at org.apache.catalina.core.StandardServer.stop(StandardServer.java:222\\\n5)\n        at org.apache.catalina.startup.Catalina$CatalinaShutdownHook.run(Catali\\\nna.java:624)\nFATAL [Thread-1] (myServlet.java:452) - Mar 22, 2004 6:52:29 PM: shutting down ...", "id": 54453, "time": "2004-03-23T05:22:49Z", "creator": "hauser@acm.org", "creation_time": "2004-03-23T05:22:49Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 54518, "time": "2004-03-24T00:03:11Z", "bug_id": 27141, "creation_time": "2004-03-24T00:03:11Z", "is_private": false, "text": "OK. The stack trace shows that the shutdown hook has been called. This \nindicates that the JVM has signalled to Tomcat it is shutting down.\n\nEverywhere that Tomcat does a System.exit() is precedded by a log message.\n\nI can only conclude that some external process is causing the JVM to shutdown. \nWhat other processes are you running, particularly anything that might \ninteract with the JVM eg debugger, performance monitor, etc.\n\nI am afraid that Linux is not my area of expertise so I am unable to give you \nany other pointers.\n\nI'll leave this bug open for now, but the indications are that this is not a \ntomcat issue. It is likely to get resolved as INVALID."}, {"count": 8, "tags": [], "bug_id": 27141, "attachment_id": null, "text": "Just spotted this duplicate.\n\n*** This bug has been marked as a duplicate of 27829 ***", "id": 60511, "time": "2004-07-12T18:32:34Z", "creator": "markt@apache.org", "creation_time": "2004-07-12T18:32:34Z", "is_private": false}]