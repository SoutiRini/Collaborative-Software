[{"count": 0, "tags": [], "bug_id": 57685, "attachment_id": 32555, "id": 181653, "time": "2015-03-10T19:36:12Z", "creator": "Chaosed0@gmail.com", "creation_time": "2015-03-10T19:36:12Z", "is_private": false, "text": "Created attachment 32555\nDelay cgi requests made before the cgid daemon has started\n\nThere is a short interval where httpd has started up and is accepting requests, but the cgid daemon has not yet created a listening socket. In this interval, any cgi requests made will receive a 503 response. While that response is technically correct, it seems like a retry system could be more appropriate."}, {"count": 1, "attachment_id": 32577, "bug_id": 57685, "is_private": false, "id": 181810, "time": "2015-03-16T15:27:43Z", "creator": "Chaosed0@gmail.com", "creation_time": "2015-03-16T15:27:43Z", "tags": [], "text": "Created attachment 32577\nDelay cgi requests made before the cgid daemon has started\n\nRebased the patch onto trunk. Also made it not retry if the socket somehow goes away."}, {"count": 2, "tags": [], "bug_id": 57685, "attachment_id": null, "id": 181811, "time": "2015-03-16T15:57:41Z", "creator": "ylavic.dev@gmail.com", "creation_time": "2015-03-16T15:57:41Z", "is_private": false, "text": "(In reply to Edward Lu from comment #1)\n> Rebased the patch onto trunk. Also made it not retry if the socket somehow\n> goes away.\n\nYou probably need to save errno after connect() and use that value in late checks."}, {"count": 3, "tags": [], "creator": "Chaosed0@gmail.com", "is_private": false, "text": "Created attachment 32578\nDelay cgi requests made before the cgid daemon has started\n\nGood point. The errno currently isn't being saved in trunk, but it's being used only in the log; I guess since we're using it for more in this patch, it's better to be safe.", "id": 181817, "time": "2015-03-16T17:22:49Z", "bug_id": 57685, "creation_time": "2015-03-16T17:22:49Z", "attachment_id": 32578}, {"count": 4, "tags": [], "bug_id": 57685, "text": "Maybe declare connect_errno = 0 in the loop block so that it is initialized when connect() succeeds?", "id": 181819, "time": "2015-03-16T17:44:53Z", "creator": "ylavic.dev@gmail.com", "creation_time": "2015-03-16T17:44:53Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "text": "Created attachment 32579\nDelay cgi requests made before the cgid daemon has started\n\nDone.", "is_private": false, "id": 181820, "creator": "Chaosed0@gmail.com", "time": "2015-03-16T18:07:02Z", "bug_id": 57685, "creation_time": "2015-03-16T18:07:02Z", "attachment_id": 32579}, {"count": 6, "attachment_id": 32580, "bug_id": 57685, "is_private": false, "id": 181821, "time": "2015-03-16T18:14:16Z", "creator": "Chaosed0@gmail.com", "creation_time": "2015-03-16T18:14:16Z", "tags": [], "text": "Created attachment 32580\nDelay cgi requests made before the cgid daemon has started\n\nForgot to take out a call to sleep I was using while testing. Sorry about all the revision spam."}, {"count": 7, "tags": [], "bug_id": 57685, "attachment_id": null, "id": 181846, "time": "2015-03-17T20:14:09Z", "creator": "covener@gmail.com", "creation_time": "2015-03-17T20:14:09Z", "is_private": false, "text": "Thanks Ed and Yann, committed with minor tweaks in r1667385"}, {"count": 8, "tags": [], "creator": "brad.newman@gmail.com", "attachment_id": null, "text": "I encountered this problem with httpd 2.4.9, and tried the patch.  \n\nUnfortunately, the 503 responses with the same \"(2)No such file or directory: AH01257: unable to connect to cgi daemon after multiple tries\" error also happen after a *graceful* restart of httpd.  \n\nBut the graceful restarts don't reset the scoreboard's restart_time, so if httpd has been running for more than a minute when the graceful restart occurs, we end up in the APLOGNO(02831) branch and don't benefit from any retries.", "id": 183042, "time": "2015-05-19T17:51:08Z", "bug_id": 57685, "creation_time": "2015-05-19T17:51:08Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 57685, "text": "This has been merged in 2.4.x in r1669559.\n\nIs is part of 2.4.13", "id": 198878, "time": "2017-05-25T12:22:16Z", "creator": "christophe.jaillet@wanadoo.fr", "creation_time": "2017-05-25T12:22:16Z", "is_private": false, "attachment_id": null}]