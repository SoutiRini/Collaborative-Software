[{"count": 0, "tags": [], "bug_id": 43330, "attachment_id": null, "text": "Hallo,\n\nI found more practical to include the password as part of the CVS url than using\nthe cvspass file (manually or through ant task). It works fine for me, but I am\na bit worried because when the command fails for some reason, the cvs task\nprints a message like this:\n\n-----------------------------------------------------------------------\ncheckout:\n      [cvs] Fatal error, aborting.\n      [cvs] dummyuser: no such user\n\nBUILD FAILED\n/tmp/.newdeploy/deployServer/chacaDeploy/scripts/deploy.xml:13: The following\nerror occurred while executing this line:\n/tmp/.newdeploy/deployServer/chacaDeploy/scripts/deployCommon.xml:30: cvs exited\nwith error code 1\nCommand line was [Executing 'cvs' with arguments:\n'-d:pserver:dummyuser:dummypwd@some.cvsserver.com:/usr/local/cvsroot'\n'checkout'\n'-P'\n'pps_build/version'\n'pps_build/chacaDeploy'\n\nThe ' characters around the executable and arguments are\nnot part of the command.\n]\n-----------------------------------------------------------------------\n\nAs you can see, the password is shown (given it was included in the CVS url). I\nsolved the problem by doing a little local hack, in order to hide the cvs\npassword (if it was there). I was thinking that it may be a good addition to the\ncode base. In general, is not useful not print the password ;-]\n\nThe change is the following (AbstractCvsTask.java):\n\nIn the runCommand method, I changed the section where the failure is printed\n(the addition was only the call to hidePassword):\n\n  /*Throw an exception if cvs exited with error. (Iulian)*/\n            if (failOnError && Execute.isFailure(retCode)) {\n                throw new BuildException(\"cvs exited with error code \"\n                                         + retCode\n                                         + StringUtils.LINE_SEP\n                                         + \"Command line was [\"\n                                         + hidePassword(actualCommandLine) + \"]\",\n                                         getLocation());\n            }\n\nWhere \"hidePassword\" is defined by:\n\n  /**\n   *  Hides password from command line.\n   *\n   *  It could the the case that a password in plain form was used as\n   *  part of the CVS url; if that is the case, hide it by replacing\n   *  with a dummy string.\n   *\n   *  The pattern where the password can occurs is something like\n   *  this: \n   *\n   *  -d:pserver:user:pwd@cvs.server.com:/usr/local/cvsroot\n   *\n   *  @param The CVS command line\n   */\n  private String hidePassword(String cmd)\n  {\n    return\n      cmd.replaceAll(\"-d:([^:]+):([^:]+):([^:]+)@([^:]+):(.*)\", \n                     \"-d:$1:$2:<hidden password>@$4:$5\");\n  }\n\n\nMy boss does not like my hack, because it is not official ant release. Given\nthat, I will need to use cvs password file, but maybe in the near future ant\ncould have this addition?\n\nThanks in advance.", "id": 107830, "time": "2007-09-07T12:33:10Z", "creator": "dario.mx@gmail.com", "creation_time": "2007-09-07T12:33:10Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 43330, "attachment_id": null, "text": "Similar solution, that does not depend on jdk 1.4 introduced, password replaced\nby asterisks.", "id": 107859, "time": "2007-09-08T08:22:10Z", "creator": "jkf@apache.org", "creation_time": "2007-09-08T08:22:10Z", "is_private": false}]