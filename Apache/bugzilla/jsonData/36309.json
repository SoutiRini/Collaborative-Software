[{"count": 0, "tags": [], "bug_id": 36309, "is_private": false, "text": "The wmf transcoder package lacks some functionalities, so often the conversion\nfrom standard Metafiles generated by MS PPT shows a lot of differences from the\noriginal.\n\nI have enhanced / hacked the actual transcoder code (as of version 1.6) and\nadded / corrected the following functionalities :\n- manage SVG images size (currently the transcoder keeps the virtual Metafile\nsize, which is very large)\n- manage fonts whose charset is different from the standard Latin (ex: Greek)\n- manage text size and decoration (style, alignment, strikeout, underline,\nescaping, clipping, background)\n- manage stroke width and dash pattern\n- fill with hatched and textured patterns \n- draw bitmaps enclosed in Metafiles\n- correction of some errors when the size of a WMF record generated by PPT is\ngreater than expected\n- add some of the WMF record type that are not handled by Batik 1.6\n\nI wish to donate the associated attached code to APACHE.\n\nattachements are :\n- path file for the modifications of Batik classes\n- text file for some test classes that can be useful to test the modifications\nand view the structure of any WMF files\n- some test cases :\n  - testChart.wmf : text decorations, stroke width and dash patterns, fill with\n   hatched and textured patterns\n  - testGreek.wmf : charsets\n  - blackShapes.wmf : PATBLT record\n  - BatikWMF.wmf : images", "id": 78848, "time": "2005-08-23T00:52:35Z", "creator": "herve.girod@club-internet.fr", "creation_time": "2005-08-23T00:52:35Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 36309, "text": "Created attachment 16146\nThe classes donated to APACHE", "id": 78849, "time": "2005-08-23T00:53:57Z", "creator": "herve.girod@club-internet.fr", "creation_time": "2005-08-23T00:53:57Z", "is_private": false, "attachment_id": 16146}, {"count": 2, "text": "Created attachment 16147\nthe classes  that can be used to test the package modifications", "bug_id": 36309, "is_private": false, "id": 78850, "time": "2005-08-23T00:54:32Z", "creator": "herve.girod@club-internet.fr", "creation_time": "2005-08-23T00:54:32Z", "tags": [], "attachment_id": 16147}, {"count": 3, "tags": [], "bug_id": 36309, "is_private": false, "text": "Created attachment 16148\nmap of the patches", "id": 78851, "time": "2005-08-23T00:54:59Z", "creator": "herve.girod@club-internet.fr", "creation_time": "2005-08-23T00:54:59Z", "attachment_id": 16148}, {"count": 4, "tags": [], "bug_id": 36309, "text": "Created attachment 16149\ntest case : text decorations, stroke width and dash patterns, fill with\r\n   hatched and textured patterns", "id": 78852, "time": "2005-08-23T00:55:28Z", "creator": "herve.girod@club-internet.fr", "creation_time": "2005-08-23T00:55:28Z", "is_private": false, "attachment_id": 16149}, {"count": 5, "tags": [], "text": "Created attachment 16150\ntest case : charsets", "is_private": false, "id": 78853, "creator": "herve.girod@club-internet.fr", "time": "2005-08-23T00:55:49Z", "bug_id": 36309, "creation_time": "2005-08-23T00:55:49Z", "attachment_id": 16150}, {"count": 6, "tags": [], "bug_id": 36309, "text": "Created attachment 16151\ntest case : images", "id": 78854, "time": "2005-08-23T00:56:14Z", "creator": "herve.girod@club-internet.fr", "creation_time": "2005-08-23T00:56:14Z", "is_private": false, "attachment_id": 16151}, {"count": 7, "tags": [], "bug_id": 36309, "text": "Created attachment 16152\ntest case : PATBLT record", "id": 78855, "time": "2005-08-23T00:56:29Z", "creator": "herve.girod@club-internet.fr", "creation_time": "2005-08-23T00:56:29Z", "is_private": false, "attachment_id": 16152}, {"count": 8, "tags": [], "bug_id": 36309, "attachment_id": 16149, "text": "Comment on attachment 16149\ntest case : text decorations, stroke width and dash patterns, fill with\r\n   hatched and textured patterns\n\ntext decorations, stroke width and dash patterns, fill with\n   hatched and textured patterns", "id": 78856, "time": "2005-08-23T00:57:56Z", "creator": "herve.girod@club-internet.fr", "creation_time": "2005-08-23T00:57:56Z", "is_private": false}, {"count": 9, "tags": [], "creator": "herve.girod@club-internet.fr", "text": "Comment on attachment 16151\ntest case : images\n\nimages", "id": 78857, "time": "2005-08-23T00:58:14Z", "bug_id": 36309, "creation_time": "2005-08-23T00:58:14Z", "is_private": false, "attachment_id": 16151}, {"count": 10, "tags": [], "bug_id": 36309, "text": "Comment on attachment 16152\ntest case : PATBLT record\n\nPATBLT record", "id": 78858, "time": "2005-08-23T00:58:32Z", "creator": "herve.girod@club-internet.fr", "creation_time": "2005-08-23T00:58:32Z", "is_private": false, "attachment_id": 16152}, {"count": 11, "tags": [], "bug_id": 36309, "is_private": false, "text": "Comment on attachment 16150\ntest case : charsets\r\n\n\ncharsets", "id": 78859, "time": "2005-08-23T00:58:54Z", "creator": "herve.girod@club-internet.fr", "creation_time": "2005-08-23T00:58:54Z", "attachment_id": 16150}, {"count": 12, "tags": [], "bug_id": 36309, "text": "Created attachment 16299\nThe new version 2 of the classes", "id": 79363, "time": "2005-09-04T02:12:06Z", "creator": "herve.girod@club-internet.fr", "creation_time": "2005-09-04T02:12:06Z", "is_private": false, "attachment_id": 16299}, {"count": 13, "tags": [], "bug_id": 36309, "text": "Created attachment 16300\ntest class for text decoration handling in SVGGraphics2D", "id": 79364, "attachment_id": 16300, "creator": "herve.girod@club-internet.fr", "creation_time": "2005-09-04T02:13:03Z", "time": "2005-09-04T02:13:03Z", "is_private": false}, {"count": 14, "tags": [], "creator": "herve.girod@club-internet.fr", "text": "Created attachment 16381\nversion 3 of the classes", "id": 79850, "attachment_id": 16381, "bug_id": 36309, "creation_time": "2005-09-13T01:51:37Z", "time": "2005-09-13T01:51:37Z", "is_private": false}, {"count": 15, "tags": [], "bug_id": 36309, "text": "Created attachment 16382\ntest case : images", "id": 79851, "time": "2005-09-13T01:52:31Z", "creator": "herve.girod@club-internet.fr", "creation_time": "2005-09-13T01:52:31Z", "is_private": false, "attachment_id": 16382}, {"count": 16, "tags": [], "bug_id": 36309, "text": "Changed the patch to address a bug I found when having images + geometric\nfigures in the same WMF image. The overtall width an layout of the image was not\nall right in this case.\nPlus changed the test sample for images to be able to check the behavior in this\ncase", "id": 79852, "time": "2005-09-13T01:55:41Z", "creator": "herve.girod@club-internet.fr", "creation_time": "2005-09-13T01:55:41Z", "is_private": false, "attachment_id": null}, {"count": 17, "tags": [], "bug_id": 36309, "text": "Many thanks Herve,\n\nThis has been applied to both svg11 and trunk.\nI had to make some changes to the AttributeCharacterIterator stuff\nsince it wasn't \"playing nicely\" with the way the SVGGraphics2D was\nmanaging properties, but the result is quite nice.\nAlso be warned that I significantly changed the style of the XML output\nfrom the XMLWriter, otherwise it would introduce incorrect spaces\nin 'tspan' elements.\n\nI also created a WMF Transcoder test which can be used to convert any\nWMF file to SVG and compare it to a reference SVG similar to the\ntests for SVGGraphics2D.", "id": 80454, "time": "2005-09-25T22:06:51Z", "creator": "deweese@apache.org", "creation_time": "2005-09-25T22:06:51Z", "is_private": false, "attachment_id": null}, {"count": 18, "tags": [], "bug_id": 36309, "is_private": false, "text": "(In reply to comment #17)\n\nThanks for yor work : That was a lot of changes to apply (and things to fix too\n!) and associated test cases to handle...\n\nAs for the WMF transparency that is not carried through, Bitmap fill\nalignements, and Polygon / Polyline bad \"independance\u00e9, I will try to look at\nit. If I am able how to correct it, and if your OK with that, I will fill a new\nRFE with a proposed patch (I'm sure way much shorter that this one...)", "id": 80494, "time": "2005-09-26T22:42:05Z", "creator": "herve.girod@club-internet.fr", "creation_time": "2005-09-26T22:42:05Z", "attachment_id": null}]