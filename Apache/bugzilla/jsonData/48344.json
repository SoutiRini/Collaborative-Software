[{"count": 0, "tags": [], "bug_id": 48344, "is_private": false, "text": "I have tried using the setRowStyle() method of a HSSFRow  object .\nIt is not working .\nIn a similar manner I have tried using setCellStyle() method of HSSFCell object ,that is working fine .\nIn some of the forums it was suggested that may be a misplaced jar files or conflict within the jars can be a reason . But I used only the \npoi-3.5-FINAL-20090928.jar as well as a combination of jar files such as \n\n1.poi-3.5-FINAL-20090928.jar\n2.poi-contrib-3.5-FINAL-20090928.jar\n3.poi-ooxml-3.5-FINAL-20090928.jar\n4.poi-scratchpad-3.5-FINAL-20090928.jar\n\nIn both cases setRowStyle() is not working .", "id": 132639, "time": "2009-12-07T01:28:15Z", "creator": "mrayandutta@gmail.com", "creation_time": "2009-12-07T01:28:15Z", "attachment_id": null}, {"count": 1, "attachment_id": null, "bug_id": 48344, "text": "You're going to need to be more specific than \"It is not working\" ....\n\nSee org.apache.poi.hssf.usermodel.TestRowStyle for a number of unit tests which appear to show POI able to set, read and process row styles just fine\n\nPlease upload a failing unit test if you have problems, showing what bit isn't working, so we have something to work against.", "id": 138818, "time": "2010-08-02T12:01:00Z", "creator": "apache@gagravarr.org", "creation_time": "2010-08-02T12:01:00Z", "tags": [], "is_private": false}, {"count": 2, "attachment_id": null, "bug_id": 48344, "text": "Based on the various unit tests that pass, I believe this one is not a bug in the latest POI.\n\nIf you still have the problem with a recent nightly / poi 3.8 beta 1, please re-open the bug and provide details for how to reproduce the problem", "id": 144560, "time": "2011-02-25T16:55:22Z", "creator": "apache@gagravarr.org", "creation_time": "2011-02-25T16:55:22Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 48344, "is_private": false, "text": "Created attachment 27627\nsetRowStyle bug\n\nCode that reproduces setRowStyle bug", "id": 149910, "time": "2011-09-28T13:55:10Z", "creator": "d.k.brazz@gmail.com", "creation_time": "2011-09-28T13:55:10Z", "attachment_id": 27627}, {"count": 4, "tags": [], "bug_id": 48344, "is_private": false, "id": 149911, "creation_time": "2011-09-28T13:56:17Z", "time": "2011-09-28T13:56:17Z", "creator": "d.k.brazz@gmail.com", "text": "I also encountered this problem.\nI confirm that the method setRowStyle() is not working properly.\nI try to paint background. But the background is not painted in created cells, but only empty ones.\n\nHere is code which reproduces the bug.", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 48344, "attachment_id": 27628, "is_private": false, "id": 149912, "time": "2011-09-28T14:03:39Z", "creator": "d.k.brazz@gmail.com", "creation_time": "2011-09-28T14:03:39Z", "text": "Created attachment 27628\nScreenshot"}, {"count": 6, "attachment_id": null, "bug_id": 48344, "text": "(In reply to comment #4)\n> I also encountered this problem.\n> I confirm that the method setRowStyle() is not working properly.\n> I try to paint background. But the background is not painted in created cells,\n> but only empty ones.\n> \n> Here is code which reproduces the bug.\n\ntested with both POI 3.7 and 3.8 beta4", "id": 149917, "time": "2011-09-28T14:47:46Z", "creator": "d.k.brazz@gmail.com", "creation_time": "2011-09-28T14:47:46Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "bug_id": 48344, "is_private": false, "text": "(In reply to comment #6)\n> (In reply to comment #4)\n> > I also encountered this problem.\n> > I confirm that the method setRowStyle() is not working properly.\n> > I try to paint background. But the background is not painted in created cells,\n> > but only empty ones.\n> > \n> > Here is code which reproduces the bug.\n> \n> tested with both POI 3.7 and 3.8 beta4\n\nIf I replace all HSSF by XSSF in this example it works as expected. (3.8 only).\nSo HSSF and XSSF have different implementations of setRowStyle(). And old one (from HSSF) is buggy.", "id": 149918, "time": "2011-09-28T15:07:22Z", "creator": "d.k.brazz@gmail.com", "creation_time": "2011-09-28T15:07:22Z", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 48344, "text": "Is the problem with how POI sees the styling, or only with Excel?\n\ni.e. if you style a row in POI, save it, re-open it and check the style, will POI see the correct styling even if Excel won't?\n\nAdditionally, if you run the Microsoft Binary File Format Validator against the POI styled file, does it pass?", "id": 149919, "time": "2011-09-28T15:11:19Z", "creator": "apache@gagravarr.org", "creation_time": "2011-09-28T15:11:19Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 48344, "is_private": false, "text": "(In reply to comment #8)\n> Is the problem with how POI sees the styling, or only with Excel?\n> \n> i.e. if you style a row in POI, save it, re-open it and check the style, will\n> POI see the correct styling even if Excel won't?\n\nIn reopened file:\nsheet.getRow(2).getRowStyle(); // returns style which defined previosly by setRowStyle().\nstyle = sheet.getRow(2).getCell(0).getCellStyle(); // returns default workbook style\n\n> Additionally, if you run the Microsoft Binary File Format Validator against the\n> POI styled file, does it pass?\nlog.xml for my example attached", "id": 149937, "time": "2011-09-29T12:51:14Z", "creator": "d.k.brazz@gmail.com", "creation_time": "2011-09-29T12:51:14Z", "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 48344, "is_private": false, "id": 149939, "creation_time": "2011-09-29T12:53:02Z", "time": "2011-09-29T12:53:02Z", "creator": "d.k.brazz@gmail.com", "text": "Created attachment 27633\nlog.xml\n\nLog of Microsoft Binary File Format Validator against the\nPOI styled file", "attachment_id": 27633}, {"count": 11, "tags": [], "bug_id": 48344, "is_private": false, "id": 149940, "creation_time": "2011-09-29T12:54:47Z", "time": "2011-09-29T12:54:47Z", "creator": "d.k.brazz@gmail.com", "text": "Created attachment 27634\nTestRowStyle.java\n\ncreate and test setRowStyle()", "attachment_id": 27634}, {"count": 12, "attachment_id": null, "bug_id": 48344, "text": "(In reply to comment #9)\n> In reopened file:\n> sheet.getRow(2).getRowStyle(); // returns style which defined previosly by\n> setRowStyle().\n> style = sheet.getRow(2).getCell(0).getCellStyle(); // returns default workbook\n> style\n\nIf you set a style on a row in Excel, what gets written for the cell styles for cells with the default style? Does excel go through and change all the cells in the row, or does it just inherit?", "id": 149943, "time": "2011-09-29T13:24:06Z", "creator": "apache@gagravarr.org", "creation_time": "2011-09-29T13:24:06Z", "tags": [], "is_private": false}, {"count": 13, "attachment_id": null, "creator": "apache@gagravarr.org", "text": "(In reply to comment #10)\n> Created attachment 27633 [details]\n> log.xml\n> \n> Log of Microsoft Binary File Format Validator against the\n> POI styled file\n\nLooks like it's complaining about the IndexRecord not correctly holding the offset of the DefaultColWidthRecord in field 4. Any chance you could open a new bug for this?", "id": 149944, "time": "2011-09-29T13:33:47Z", "bug_id": 48344, "creation_time": "2011-09-29T13:33:47Z", "tags": [], "is_private": false}, {"count": 14, "tags": [], "bug_id": 48344, "is_private": false, "id": 150443, "attachment_id": null, "creator": "d.k.brazz@gmail.com", "creation_time": "2011-10-10T20:48:18Z", "time": "2011-10-10T20:48:18Z", "text": "(In reply to comment #12)\n> (In reply to comment #9)\n> > In reopened file:\n> > sheet.getRow(2).getRowStyle(); // returns style which defined previosly by\n> > setRowStyle().\n> > style = sheet.getRow(2).getCell(0).getCellStyle(); // returns default workbook\n> > style\n> \n> If you set a style on a row in Excel, what gets written for the cell styles for\n> cells with the default style? Does excel go through and change all the cells in\n> the row, or does it just inherit?\n\nIf I set a style on a row Excel sets same style for each cell in this row.\nIterate over all cells in a row shows that cells with default style have style equivalent to style of row:\nrowstyle.getIndex()==stylecell.getIndex() -> true\nrowstyle.equals(cellstyle) -> true\nrowstyle.hashCode()==cellstyle.hashCode -> true"}, {"count": 15, "tags": [], "bug_id": 48344, "text": "Hello,\n\nI'm changing the status of this bug back to NEW because I'm also having this problem with poi 3.8.\n\nI also ran the test file attached to this bug \"TestRowStyle.java (3.36 KB, text/plain) 2011-09-29 12:54 UTC, Denis Kurochkin\" and it successfully reproduces the bug in my environment. \n\nCould you please run \"TestRowStyle.java\" and see what is the result in your environment?\n\nThank you,\nBruno.", "id": 162803, "time": "2012-10-17T21:55:27Z", "creator": "bnegrao@gmail.com", "creation_time": "2012-10-17T21:55:27Z", "is_private": false, "attachment_id": null}, {"count": 16, "tags": [], "bug_id": 48344, "is_private": false, "id": 178080, "creation_time": "2014-09-24T13:50:12Z", "time": "2014-09-24T13:50:12Z", "creator": "jeffrey_tilby@mastercard.com", "text": "I have also had a problem with setRowStyle. It sets the style on the row OK but all the cells on the row have their style set to \"Default\", overriding the row style.\n\ne.g. If save as XML:\n\n<?xml version=\"1.0\"?>\n<?mso-application progid=\"Excel.Sheet\"?>\n<Workbook xmlns=\"urn:schemas-microsoft-com:office:spreadsheet\"\n xmlns:o=\"urn:schemas-microsoft-com:office:office\"\n xmlns:x=\"urn:schemas-microsoft-com:office:excel\"\n xmlns:ss=\"urn:schemas-microsoft-com:office:spreadsheet\"\n xmlns:html=\"http://www.w3.org/TR/REC-html40\">\n <DocumentProperties xmlns=\"urn:schemas-microsoft-com:office:office\">\n  <Author>Fred Bloggs</Author>\n  <LastAuthor>tecdvp3</LastAuthor>\n  <Created>2014-09-24T12:58:38Z</Created>\n  <LastSaved>2014-09-24T12:58:38Z</LastSaved>\n  <Version>14.00</Version>\n </DocumentProperties>\n <OfficeDocumentSettings xmlns=\"urn:schemas-microsoft-com:office:office\">\n  <AllowPNG/>\n </OfficeDocumentSettings>\n <ExcelWorkbook xmlns=\"urn:schemas-microsoft-com:office:excel\">\n  <WindowHeight>9150</WindowHeight>\n  <WindowWidth>14940</WindowWidth>\n  <WindowTopX>360</WindowTopX>\n  <WindowTopY>270</WindowTopY>\n  <ProtectStructure>False</ProtectStructure>\n  <ProtectWindows>False</ProtectWindows>\n </ExcelWorkbook>\n <Styles>\n  <Style ss:ID=\"Default\" ss:Name=\"Normal\">\n   <Alignment ss:Vertical=\"Bottom\"/>\n   <Borders/>\n   <Font ss:FontName=\"Arial\"/>\n   <Interior/>\n   <NumberFormat/>\n   <Protection/>\n  </Style>\n  <Style ss:ID=\"s21\">\n   <Font ss:FontName=\"Eurostyle\" ss:Bold=\"1\" ss:Underline=\"Single\"/>\n  </Style>\n </Styles>\n <Worksheet ss:Name=\"Hello World\">\n  <Table ss:ExpandedColumnCount=\"2\" ss:ExpandedRowCount=\"3\" x:FullColumns=\"1\"\n   x:FullRows=\"1\">\n   <Column ss:AutoFitWidth=\"0\" ss:Width=\"102.75\"/>\n   <Column ss:AutoFitWidth=\"0\" ss:Width=\"204.75\"/>\n   <Row ss:StyleID=\"s21\">\n    <Cell ss:StyleID=\"Default\"><Data ss:Type=\"String\">Col 1</Data></Cell>\n    <Cell ss:StyleID=\"Default\"><Data ss:Type=\"String\">Col 2</Data></Cell>\n   </Row>\n   <Row>\n    <Cell><Data ss:Type=\"String\">Hello</Data></Cell>\n    <Cell><Data ss:Type=\"String\">World</Data></Cell>\n   </Row>\n   <Row>\n    <Cell><Data ss:Type=\"String\">&#45;&#45;&#45;&#45;-</Data></Cell>\n    <Cell><Data ss:Type=\"String\">&#45;&#45;&#45;&#45;-</Data></Cell>\n   </Row>\n  </Table>\n  <WorksheetOptions xmlns=\"urn:schemas-microsoft-com:office:excel\">\n   <Print>\n    <ValidPrinterInfo/>\n    <HorizontalResolution>300</HorizontalResolution>\n    <VerticalResolution>300</VerticalResolution>\n   </Print>\n   <Selected/>\n   <ProtectObjects>False</ProtectObjects>\n   <ProtectScenarios>False</ProtectScenarios>\n  </WorksheetOptions>\n </Worksheet>\n</Workbook>", "attachment_id": null}]