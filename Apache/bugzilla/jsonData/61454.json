[{"count": 0, "tags": [], "text": "Created attachment 35253\nScreenshot of the broken layout - column with long content.\n\nIn class org.apache.poi.ss.examples.html.ToHtml POI provides a very good way of converting Excel sheets to HTML. The resulting html document contains the correct formatting etc. But column width of the original excel file is not respeceted; instead the resulting table is formatted with css directive \"table-layout:auto\".\n\nIn general this is not a problem. Only for there are excel cells with long content (especially if there are no blanks), the resulting table shows a very wide column and the remaining columns can only be seen by using the scroll bar. See attached screenshot.\n\nTo fix it, I provide the patch. Patch is based on POI 3.16, but these classes have not changed since a year or so; therefore it shouldn't be a problem to apply to 3.18.", "is_private": false, "id": 200445, "creator": "cfr2017@gmx.net", "time": "2017-08-24T20:23:03Z", "bug_id": 61454, "creation_time": "2017-08-24T20:23:03Z", "attachment_id": 35253}, {"count": 1, "tags": [], "bug_id": 61454, "is_private": false, "text": "Created attachment 35254\nProposed patch for Bug 61454 - git patch file", "id": 200446, "time": "2017-08-24T20:27:40Z", "creator": "cfr2017@gmx.net", "creation_time": "2017-08-24T20:27:40Z", "attachment_id": 35254}, {"count": 2, "tags": [], "creator": "cfr2017@gmx.net", "attachment_id": 35255, "is_private": false, "id": 200447, "time": "2017-08-24T20:28:58Z", "bug_id": 61454, "creation_time": "2017-08-24T20:28:58Z", "text": "Created attachment 35255\nScreenshot after the fix"}, {"count": 3, "tags": [], "creator": "cfr2017@gmx.net", "attachment_id": 35256, "text": "Created attachment 35256\nExcel file used for testing", "id": 200448, "time": "2017-08-24T20:47:09Z", "bug_id": 61454, "creation_time": "2017-08-24T20:47:09Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 61454, "text": "Thanks for your contribution.\n\nUnfortunately, due to licensing issues, I don't think we can use the poiWidthToPixels function without the consent of the author.\nI've seen several other width to pixel converter codes [1], so it seems there's no one conversion formula that will work on all systems with the variety of display resolutions and densities, OS and JVMs, and installed fonts.\n\nI applied your changes with a simplified poiWidthToPixels function in r1808816.\n\nIf we can find a conversion formula that works for everybody (or most everybody), then we should add it somewhere in the main poi package (and simplify this example). Feel free to open a new bug if you want to suggest a conversion formula.\n\n[1] https://mail-archives.apache.org/mod_mbox/poi-user/200810.mbox/%3CBAY124-W1137A2B874ADEEBF932518BA310@phx.gbl%3E", "id": 200944, "time": "2017-09-19T03:34:38Z", "creator": "onealj@apache.org", "creation_time": "2017-09-19T03:34:38Z", "is_private": false, "attachment_id": null}]