[{"count": 0, "tags": [], "bug_id": 31919, "attachment_id": null, "is_private": false, "id": 65836, "time": "2004-10-27T15:09:05Z", "creator": "jonas@webkonsulterna.com", "creation_time": "2004-10-27T15:09:05Z", "text": "The following only works when the totaly number of virutal hosts is under 300.\nI after that if i access a web page i get error 403 access denied error on all \nsites on my server. It looks lite its file decriptors error or something.\nMy kernel log says Oct 27 16:15:43 linux-www2 kernel: memory.c:100: bad pmd \nbfffec00\n\nIf i change back the loggin to standard loggin:\nCustomLog /home/webhosting/xxxx/xxxx.com/logfiles/access.log combinedis works \nagen. Is it possible that pipes eats up more file descriptors then ordinay log \nlines?\n\nTHIS DOES NOT WORK WITH TO MANY SITES (over 340)\nCustomLog \"|/usr/sbin/rotatelogs /home/webhosting/xxxx/xxxx.com/logfiles/access\n.%Y-%m-%d.log 86400\" combined\n\nI need all logfiles to be rotated daily becouse of the size. And I can't use \nthe stnadard routated program becouse i have a statistiks server that crashes\nif a logfile is routated while it reads it.\n\nI need apache to save the logfiles in the same way as IIS does. \nCreate a new filename every day."}, {"count": 1, "tags": [], "bug_id": 31919, "is_private": false, "text": "I expect that you can work around this issue by increasing your limit on file\ndescriptors.\n\nThe problem (more file descriptors used when using piped logger vs. plain log\nfile) is because the descriptors for input from the logger and error output to\nthe logger are both kept open by Apache, even though Apache will never read from\nthe logger nor write to the logger through the error output descriptor.  We need\nto investigate closing both of those \"handles\" to reduce our file descriptor\nconsumption.", "id": 65842, "time": "2004-10-27T16:24:30Z", "creator": "trawick@apache.org", "creation_time": "2004-10-27T16:24:30Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "trawick@apache.org", "text": "I withdraw my prior detailed comments about the nature of these extra\ndescriptors ;)  After stepping through some of the code I can see that they are\nnot accurate.\n", "count": 2, "id": 65853, "time": "2004-10-27T19:07:05Z", "bug_id": 31919, "creation_time": "2004-10-27T19:07:05Z", "is_private": false}, {"count": 3, "attachment_id": null, "creator": "jorton@redhat.com", "text": "Uh, I remember that I came to that conclusion too when I looked at that before\ntoo, but I can't see why now.  What is it that uses the read side of the pipe in\nhttpd?\n\nIt doesn't look like *anything* is ever done with the fd registered with the\notherchild code either.\n", "id": 65856, "time": "2004-10-27T19:24:03Z", "bug_id": 31919, "creation_time": "2004-10-27T19:24:03Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "creator": "jorton@redhat.com", "text": "Oh, that's it, it's because when the piped logger disappears it just gets\nspawned again without creating a new pipe.  This whole\npiped-logger/EOF-vs-graceful thing is on my todo list for november fwliw.", "id": 65857, "time": "2004-10-27T19:31:58Z", "bug_id": 31919, "creation_time": "2004-10-27T19:31:58Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 31919, "is_private": false, "id": 127291, "creation_time": "2009-05-22T08:10:15Z", "time": "2009-05-22T08:10:15Z", "creator": "poirier@pobox.com", "text": "I think this code has been reworked since then, and increasing file handles should work around it anyway.  Closing the report.", "attachment_id": null}]