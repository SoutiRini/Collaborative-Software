[{"count": 0, "tags": [], "creator": "rfreilich@rim.net", "is_private": false, "id": 21649, "attachment_id": null, "bug_id": 11993, "creation_time": "2002-08-23T21:19:47Z", "time": "2002-08-23T21:19:47Z", "text": "It would appear that mod_proxy/http_proxy cannot forward byterange requests.  \nRunning Apache 2.0.40 on Linux 7.3 which Proxys back to IIS on Win2K - PDFs \nload fine from the Win2K server or from the Linux server when accessed \ndirectly.  They come up blank (only when the client is running IE with Acroboat \nReader 4.x) when going through the ProxyPass.  Always works with Acrobat Reader \n5."}, {"count": 1, "tags": [], "text": "I am seeing the same situation with Apache 2.0.40 and 2.0.39 on Linux 7.2 and \n7.3.  When using apache as a reverse proxy for a variety of web servers \nincluding iis4, iis5, apache 1.3.26, apache 1.3.22.  I also see this only with \nclient running IE and Acrobat 4.x.   Likewise works fine with Acrobat Reader \n5.x  One additional not is that the failure occurs on pdf file greater than \n32K.  PDF files smaller than 32K seem to work.\n\n", "is_private": false, "bug_id": 11993, "id": 23080, "time": "2002-09-19T03:46:32Z", "creator": "duane@sdofnd.com", "creation_time": "2002-09-19T03:46:32Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 11993, "attachment_id": null, "text": "Hello!\n\nI suppose that this is not Apache bug. More likely that your PDF files was not \nprepared for 'byteserving'. Please read full details on: \nhttp://www.adobe.com/support/techguides/acrobat/byteserve/byteserv03.html. My \nEnglish is too poor to explain details myself.\n\nBest regards,\nAlexander Shishilov.\n\n", "id": 23499, "time": "2002-09-27T06:15:22Z", "creator": "alexandersh@rj.aha.ru", "creation_time": "2002-09-27T06:15:22Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 11993, "attachment_id": null, "text": "\n  This is not resolved, nor fixed.\n\n  The proxy is byteranging the response from the proxied server,\n  which had already byteranged ITS response based on the proxy\n  request.\n\n  Simple solutions; we must either remove the HTTP_BYTERANGE filter\n  from the proxy server, or drop the Range: header from the proxy\n  request.  The first breaks any other filters in the proxy request\n  and makes the response uncachable.  The later consumes additional\n  bandwidth of the response isn't cached.\n", "id": 24232, "time": "2002-10-09T20:11:46Z", "creator": "wrowe@apache.org", "creation_time": "2002-10-09T20:11:46Z", "is_private": false}, {"count": 4, "tags": [], "text": "*** Bug 11618 has been marked as a duplicate of this bug. ***", "is_private": false, "bug_id": 11993, "id": 24234, "time": "2002-10-09T20:13:12Z", "creator": "wrowe@apache.org", "creation_time": "2002-10-09T20:13:12Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 11993, "attachment_id": null, "text": ">>The proxy is byteranging the response from the proxied server,\n>>which had already byteranged ITS response based on the proxy\n>>request.\n\nThe proxy is byteranging the response, but the backend server is NOT sending \nbyteranded response. Backend server should always send the full document \nwhenever it receive the request from the proxy.\n\nBut if PDF file was not prepared for byteserving correctly the client fails.\n\n", "id": 24246, "time": "2002-10-10T05:26:53Z", "creator": "alexandersh@rj.aha.ru", "creation_time": "2002-10-10T05:26:53Z", "is_private": false}, {"count": 6, "tags": [], "text": "We had this problem a lot w/ 2.0.40 but it seems to have disappeared in our\ntesting of 2.0.43.  I've read the change logs and didn't notice anything\nmatching this *exactly* but there did appear to be some changes to how streamed\ndata is returned, which is often the case when serving PDFs.  Curious thing, it\nseemed from the changes to fix had to do with mod_cache, which we've turned-off.", "is_private": false, "bug_id": 11993, "id": 24628, "time": "2002-10-16T15:24:56Z", "creator": "tgagne@wideopenwest.com", "creation_time": "2002-10-16T15:24:56Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 11993, "attachment_id": null, "text": "\n  Reclassifying this as closed.  We should be forwarding all proxy requests\n  to the backend server without caching (we can't cache partial responses)\n  and not manipulating the results.\n\n  Further, in 2.0.44 we don't strip the C-L from the response either, IIRC,\n  which is the basis for the Acrobat Viewer/IE bug.\n\n  If proxy continues to demonstrate this misbehavior *with mod_cache disabled*\n  in 2.0.44, please reopen the incident.  If mod_cache changes (breaks) the \n  expected behavior, please open a new incident for 'mod_cache interferes with\n  proxied PDF byterange requests'.\n", "id": 28759, "time": "2002-12-30T18:18:35Z", "creator": "wrowe@apache.org", "creation_time": "2002-12-30T18:18:35Z", "is_private": false}, {"count": 8, "tags": [], "creator": "alum@security.gft.com", "attachment_id": null, "is_private": false, "id": 33921, "time": "2003-03-27T14:41:00Z", "bug_id": 11993, "creation_time": "2003-03-27T14:41:00Z", "text": "I am seeing this situation in Apache 2.0.44. The server is configured as a reverse proxy \nusing ProxyPass and ProxyPassReverse. \n \nWhen the client is running IE (5.x or 6.x) with Acrobat 5.x and request a pdf under \n15-20 kb the acrobat plugin is launched and the result is a blank page. No problem \nwith bigger pdf's. \n \nTested with mod_cache enabled and disabled. "}, {"count": 9, "tags": [], "creator": "alum@security.gft.com", "attachment_id": 5584, "id": 34223, "time": "2003-04-01T08:51:26Z", "bug_id": 11993, "creation_time": "2003-04-01T08:51:26Z", "is_private": false, "text": "Created attachment 5584\nWorkaround patch. No additional misbehavior detected."}, {"count": 10, "tags": [], "text": "We have a similiar problem that was originally filed as different bug and the \nnreclassified as this one.\n\nWhat we see is that any proxy requested that is chunked loses its  Chunked \nHeaders, chunk number and never has Content-Length added into the header \nstream.\n\nThis results in all content of the request being lost.\n\nBug : 11618\n\nhttp://nagoya.apache.org/bugzilla/show_bug.cgi?id=11618\n\nThanks\nJohn-", "is_private": false, "id": 34252, "creation_time": "2003-04-01T15:42:39Z", "time": "2003-04-01T15:42:39Z", "creator": "siberian@siberian.org", "bug_id": 11993, "attachment_id": null}, {"count": 11, "tags": [], "bug_id": 11993, "attachment_id": null, "text": "We earlier reported a bug [11618] \n\nhttp://nagoya.apache.org/bugzilla/show_bug.cgi?id=11618\n\nThis bug was closed and pointed here.\n\nIn this bug what happens is that anything using chunked encoding via mod_proxy \nis stripped of its chunk information and header however no Content-length \nheader is added to the sub-request and thus the receiving server has no way \nand handling the data ( post without length ).\n\nThis bug still occurs in the latest build of apache 2.x and was never resolved.\n\n", "id": 34263, "time": "2003-04-01T17:54:33Z", "creator": "siberian@siberian.org", "creation_time": "2003-04-01T17:54:33Z", "is_private": false}, {"count": 12, "tags": [], "text": "Note, it also occurs in 1.x as well, its not specific to 2.x\n", "is_private": false, "bug_id": 11993, "id": 34264, "time": "2003-04-01T17:55:28Z", "creator": "siberian@siberian.org", "creation_time": "2003-04-01T17:55:28Z", "attachment_id": null}, {"count": 13, "tags": [], "text": "Fixed in 2.0.45: \n \n *) Don't remove the Content-Length from responses in mod_proxy \n    PR: 8677 [Brian Pane] \n \n \n ", "is_private": false, "bug_id": 11993, "id": 34314, "time": "2003-04-02T10:27:55Z", "creator": "alum@security.gft.com", "creation_time": "2003-04-02T10:27:55Z", "attachment_id": null}, {"count": 14, "tags": [], "creator": "alum@security.gft.com", "attachment_id": null, "is_private": false, "id": 34317, "time": "2003-04-02T10:50:31Z", "bug_id": 11993, "creation_time": "2003-04-02T10:50:31Z", "text": "The diff is basically the patch above ;) \n \n--- proxy_http.c.orig   2003-04-02 12:43:15.000000000 +0200 \n+++ proxy_http.c        2003-02-03 18:31:50.000000000 +0100 \n@@ -1,7 +1,7 @@ \n /* \n==================================================================== \n  * The Apache Software License, Version 1.1 \n  * \n- * Copyright (c) 2000-2002 The Apache Software Foundation.  All rights \n+ * Copyright (c) 2000-2003 The Apache Software Foundation.  All rights \n  * reserved. \n  * \n  * Redistribution and use in source and binary forms, with or without \n@@ -907,16 +907,12 @@ \n \n             /* We need to copy the output headers and treat them as input \n              * headers as well.  BUT, we need to do this before we remove \n-             * TE and C-L, so that they are preserved accordingly for \n+             * TE, so that they are preserved accordingly for \n              * ap_http_filter to know where to end. \n              */ \n             rp->headers_in = apr_table_copy(r->pool, r->headers_out); \n \n-            /* In order for ap_set_keepalive to work properly, we can NOT \n-             * have any length information stored in the output headers. \n-             */ \n             apr_table_unset(r->headers_out,\"Transfer-Encoding\"); \n-            apr_table_unset(r->headers_out,\"Content-Length\"); \n \n             ap_log_error(APLOG_MARK, APLOG_DEBUG, 0, r->server, \n                          \"proxy: start body send\"); \n "}, {"count": 15, "tags": [], "bug_id": 11993, "attachment_id": null, "text": "Hi,\n\nIf you wanna disable byterange transfert to enabled one-shot transfert of your\nPDF (and no more have your PDF blank) you can modify the Apache source code to\nforce it send the \"Accept-Range:\" header to the \"none\" value (instead of \"bytes\"\nvalue).\nI've made a patch for the 1.3.27 version, it's surely applicable to all other\nversion of Apache. Get it at http://www.rvbone.com/pdfpatch (use it with patch\n-p0 < pdfpatch at the apache-1.3.27 leveldir).\nOr modify directly with vi the src/main/http_core.c file:\n  ap_table_setn(r->headers_out, \"Accept-Ranges\", \"bytes\");\n  change \"bytes\" with \"none\" !\nThen recompile Apache.\nYou have to do this modification on the target server, it's useless on the proxy\nserver.\n\nIt's just a tips, waiting for a real solution from Apache team !", "id": 34354, "time": "2003-04-02T15:44:20Z", "creator": "rvb@rvbone.com", "creation_time": "2003-04-02T15:44:20Z", "is_private": false}, {"count": 16, "tags": [], "creator": "siberian@siberian.org", "attachment_id": null, "id": 34647, "time": "2003-04-07T21:45:23Z", "bug_id": 11993, "creation_time": "2003-04-07T21:45:23Z", "is_private": false, "text": "The .45 release fixes it for the RESPONSE but not the REQUEST.\n\nSo when my chunked query comes in from a client, the headers are stripped \nbefore the sub-request is made.\n\nThis means that the backend server that I am ProxyPass'ing to gets a munged \nrequest that is useless since it has no content-length and has lost its \nchunking information."}, {"count": 17, "tags": [], "bug_id": 11993, "attachment_id": null, "text": "In an effort to possibly get this bug resolved more quickly I am offering a \n$500 bounty for the first person to get a confirmed fix into the apache \nrelease. Once its verified fixed and in the source tree for release into the \nnext version of the 2.x release we will send the bounty to you! \n\nSend email to siberian@siberian.org and I will get you my contact info so you \ncan confirm offline that the bounty does indeed exist and we are serious about \nit.\n\nCash cash cash cash!", "id": 35475, "time": "2003-04-18T00:47:52Z", "creator": "siberian@siberian.org", "creation_time": "2003-04-18T00:47:52Z", "is_private": false}, {"count": 18, "tags": [], "creator": "J.Gao@isu.usyd.edu.au", "is_private": false, "id": 44919, "attachment_id": null, "bug_id": 11993, "creation_time": "2003-10-01T04:59:51Z", "time": "2003-10-01T04:59:51Z", "text": "I am seeing this bug in 2.0.47(frontend)and 1.3.27(backend) as well"}, {"count": 19, "tags": [], "creator": "kn@sifira.dk", "attachment_id": null, "is_private": false, "id": 67479, "time": "2004-11-26T10:03:20Z", "bug_id": 11993, "creation_time": "2004-11-26T10:03:20Z", "text": "We are seeing the issue with mod_proxy stripping both Transfer-Encoding and\nContent-Length from requests in Apache 2.0.52."}, {"count": 20, "tags": [], "bug_id": 11993, "attachment_id": null, "text": "This is quite confusing: the comments indicate rather a lot of people discussing\ndifferent behaviours, some fixed, some fixable by configuration.  Not helped by\nlisting 1.3, so those of us who search on 2.0 have never seen this report.\n\n\n* Byterange requests: the best solution is probably to use mod_headers to disable\nbyteranges for proxied requests.  Comment #3 suggests making apache do this\nautomatically, but it's also easy for a server admin.  Comment #7 indicates done.\n\n* Comment 10 introduces a different issue.  Comments #13 and #16 follow up\nindicating part of the problem fixed.  The remaining unfixed issue is reported,\nless confusingly, in Bug 15859.  So to reduce confusion, I'm redirecting there.\n\n*** This bug has been marked as a duplicate of 15859 ***", "id": 67484, "time": "2004-11-26T11:31:28Z", "creator": "nick@webthing.com", "creation_time": "2004-11-26T11:31:28Z", "is_private": false}]