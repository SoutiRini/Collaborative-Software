[{"count": 0, "tags": [], "text": "I am creating a workbook in a Struts action and streaming it to the browser \nusing the following snippet:\n\n// execute the ExcelQuery and write the results to the stream\n\tif (excelquery != null) {\n\t\n\tHSSFWorkbook wb = excelquery.getWorkbookSQL(user, messages);\n\tServletOutputStream stream = response.getOutputStream();\n\tString fileName = selectedQuery + \".xls\";\n\t\t\n\tresponse.setHeader(\n\t\t\t\"Content-Disposition\",\n\t\t\t\"attachment; filename=\\\"\" + fileName + \"\\\"\");\n\tresponse.setContentType(\"application/vnd.ms-excel\");\n\t\t\t\n\twb.write(stream);\n\tstream.flush();\n\tstream.close();\n\treturn (null);\n     }\n\nThe user sees a File Download dialog that allows them to Open or Save the \nExcel file.  Either choice works GREAT in W2000/Office2000, XP/OfficeXP, but \ncauses an Excel error in Win98/Excel97 SR-2.  The error says: EXCEL caused an \ninvalid page fault in module EXCEL.EXE at 0177:300fa329.  If I take the \noffending xls to another computer, XP or 2000 can open the xls just fine.  I \ncan save the xls back to the Win98 pc and open it normally in Excel97.  I will \nattach an example (when I figure out how) of an xls that I can't open and the \nsame one after it has been opened/saved using Excel XP.\n\nAny assistance would be greatly appreciated!  This is a critical project.\n\nThank you very much,\nKendall", "attachment_id": null, "id": 24210, "creator": "kendall.coolidge@ccbai.com", "time": "2002-10-09T15:52:50Z", "bug_id": 13461, "creation_time": "2002-10-09T15:52:50Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 13461, "attachment_id": 3404, "id": 24211, "time": "2002-10-09T15:59:33Z", "creator": "kendall.coolidge@ccbai.com", "creation_time": "2002-10-09T15:59:33Z", "is_private": false, "text": "Created attachment 3404\nCauses error in Excel 97 when opened"}, {"count": 2, "tags": [], "bug_id": 13461, "text": "Created attachment 3405\nCan open this in Excel 97 without error", "id": 24212, "time": "2002-10-09T16:00:37Z", "creator": "kendall.coolidge@ccbai.com", "creation_time": "2002-10-09T16:00:37Z", "is_private": false, "attachment_id": 3405}, {"count": 3, "tags": [], "bug_id": 13461, "text": "not only do I not see anything wrong with the file in BiffViewer\n(org.apache.poi.hssf.dev.BiffViewer) but my copy of Excel97 opens it just fine.\n You should discuss this on the poi-user list perhaps someone else has\nexperienced a similar problem.", "id": 24213, "attachment_id": null, "creator": "poi-support@buni.org", "creation_time": "2002-10-09T16:27:06Z", "time": "2002-10-09T16:27:06Z", "is_private": false}]