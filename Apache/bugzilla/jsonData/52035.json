[{"count": 0, "tags": [], "bug_id": 52035, "attachment_id": null, "text": "Word6.0 file with 32MB size\n\nIt appears that it should be unsigned instead of signed. This patch appears to fix the problem on read. I checked and it appears to still be a problem against poi-3.8-beta4.\n\n\ndiff -uNr ../old/poi-3.7/src/scratchpad/src/org/apache/poi/hwpf/model/OldCHPBinTable.java ./src/scratchpad/src/org/apache/poi/hwpf/model/OldCHPBinTable.java\n--- ../old/poi-3.7/src/scratchpad/src/org/apache/poi/hwpf/model/OldCHPBinTable.java 2010-10-14 04:50:23.000000000 -0600\n+++ ./src/scratchpad/src/org/apache/poi/hwpf/model/OldCHPBinTable.java 2011-10-14 17:16:45.414557055 -0600\n@@ -49,7 +49,7 @@\n{\nGenericPropertyNode node = binTable.getProperty(x);\n\n- int pageNum = LittleEndian.getShort(node.getBytes());\n+ int pageNum = LittleEndian.getUShort(node.getBytes());\nint pageOffset = POIFSConstants.SMALLER_BIG_BLOCK_SIZE * pageNum;\n\nCHPFormattedDiskPage cfkp = new CHPFormattedDiskPage(documentStream,\ndiff -uNr ../old/poi-3.7/src/scratchpad/src/org/apache/poi/hwpf/model/OldPAPBinTable.java ./src/scratchpad/src/org/apache/poi/hwpf/model/OldPAPBinTable.java\n--- ../old/poi-3.7/src/scratchpad/src/org/apache/poi/hwpf/model/OldPAPBinTable.java 2010-10-14 04:50:23.000000000 -0600\n+++ ./src/scratchpad/src/org/apache/poi/hwpf/model/OldPAPBinTable.java 2011-10-14 17:18:00.047660407 -0600\n@@ -40,7 +40,7 @@\n{\nGenericPropertyNode node = binTable.getProperty(x);\n\n- int pageNum = LittleEndian.getShort(node.getBytes());\n+ int pageNum = LittleEndian.getUShort(node.getBytes());\nint pageOffset = POIFSConstants.SMALLER_BIG_BLOCK_SIZE * pageNum;\n\nPAPFormattedDiskPage pfkp = new PAPFormattedDiskPage(documentStream,", "id": 150599, "time": "2011-10-14T23:50:25Z", "creator": "kim.ebert@perfectsearchcorp.com", "creation_time": "2011-10-14T23:50:25Z", "is_private": false}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "text": "Thanks, patch applied in r1183629.", "id": 150611, "time": "2011-10-15T12:24:13Z", "bug_id": 52035, "creation_time": "2011-10-15T12:24:13Z", "is_private": false, "attachment_id": null}]