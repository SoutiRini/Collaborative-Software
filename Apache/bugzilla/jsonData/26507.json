[{"count": 0, "tags": [], "bug_id": 26507, "text": "JSP Code in\n- DataField implements Serializable\n\n<jsp:useBean id=\"arrayPath\" scope=\"request\" class=\"DataField[]\"/>\n\nGenerator.java run....\n---------------------\n  DataField[] arrayPath = null;\n  synchronized (request) {\n\tarrayPath = (DataField[]) pageContext.getAttribute(\"arrayPath\", \nPageContext.REQUEST_SCOPE);\n\tif (arrayPath == null){\n\t  arrayPath = new DataField[]();  # this code is Compile Error & \nGenerator Error\n\t  pageContext.setAttribute(\"arrayPath\", arrayPath, \nPageContext.REQUEST_SCOPE);\n\t}\n  }\n-------------------------------------------\n--- Generator.java.orig\t2004-01-27 17:29:06.671875000 +0900\n+++ Generator.java\t2004-01-28 10:27:49.953125000 +0900\n@@ -1259,41 +1259,37 @@\n                         className =\n                             attributeValue(beanName, false, String.class);\n                     }\n-                    out.printil(\"try {\");\n-                    out.pushIndent();\n-                    out.printin(name);\n-                    out.print(\" = (\");\n-                    out.print(type);\n-                    out.print(\") java.beans.Beans.instantiate(\");\n-                    out.print(\"this.getClass().getClassLoader(), \");\n-                    out.print(className);\n-                    out.println(\");\");\n-                    out.popIndent();\n-                    /*\n-                     * Note: Beans.instantiate throws ClassNotFoundException\n-                     * if the bean class is abstract.\n-                     */\n-                    out.printil(\"} catch (ClassNotFoundException exc) {\");\n-                    out.pushIndent();\n-                    out.printil(\n-                        \"throw new InstantiationException(exc.getMessage());\");\n-                    out.popIndent();\n-                    out.printil(\"} catch (Exception exc) {\");\n-                    out.pushIndent();\n-                    out.printin(\"throw new ServletException(\");\n-                    out.print(\"\\\"Cannot create bean of class \\\" + \");\n-                    out.print(className);\n-                    out.println(\", exc);\");\n-                    out.popIndent();\n-                    out.printil(\"}\"); // close of try\n-                } else {\n-                    // Implies klass is not null\n-                    // Generate codes to instantiate the bean class\n-                    out.printin(name);\n-                    out.print(\" = new \");\n-\t\t\t\t\tout.print(klass);\n-\t\t\t\t\tout.print(\"();\");\n-                }\n+\t\t\t\t} else {\n+\t\t\t\t\tclassName = klass;\n+\t\t\t\t}\n+                out.printil(\"try {\");\n+                out.pushIndent();\n+                out.printin(name);\n+                out.print(\" = (\");\n+                out.print(type);\n+                out.print(\") java.beans.Beans.instantiate(\");\n+                out.print(\"this.getClass().getClassLoader(), \\\"\");\n+                out.print(className);\n+                out.println(\"\\\");\");\n+                out.popIndent();\n+                /*\n+                 * Note: Beans.instantiate throws ClassNotFoundException\n+                 * if the bean class is abstract.\n+                 */\n+                out.printil(\"} catch (ClassNotFoundException exc) {\");\n+                out.pushIndent();\n+                out.printil(\n+                    \"throw new InstantiationException(exc.getMessage());\");\n+                out.popIndent();\n+                out.printil(\"} catch (Exception exc) {\");\n+                out.pushIndent();\n+                out.printin(\"throw new ServletException(\");\n+                out.print(\"\\\"Cannot create bean of class \\\" + \\\"\");\n+                out.print(className);\n+                out.println(\"\\\", exc);\");\n+                out.popIndent();\n+                out.printil(\"}\"); // close of try\n+                \n                 /*\n                  * Set attribute for bean in the specified scope\n                  */", "id": 51363, "time": "2004-01-29T01:37:00Z", "creator": "thinker0@kornet.net", "creation_time": "2004-01-29T01:37:00Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 26507, "is_private": false, "id": 51384, "creation_time": "2004-01-29T08:44:25Z", "time": "2004-01-29T08:44:25Z", "creator": "remm@apache.org", "text": "Even if that does work for you, useBean is used to manipulate JavaBeans. Look\ninto the Java spec for what a JavaBean is, but it's certainly not an array.", "attachment_id": null}, {"count": 2, "attachment_id": null, "creator": "thinker0@kornet.net", "text": "It hits, but is not an error and the summer solstice it holds?", "id": 51560, "time": "2004-02-02T01:05:25Z", "bug_id": 26507, "creation_time": "2004-02-02T01:05:25Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 26507, "text": "Tomcat 5.0.15 introduced the problem (rev 215 of Generator). I propose reverting\nthe change, as the performance enhancement does not comply with the spec wording.\nWhat you are doing with your useBean is a hack, though.", "id": 51604, "time": "2004-02-02T18:10:57Z", "creator": "remm@apache.org", "creation_time": "2004-02-02T18:10:57Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "text": "This is fixed.", "is_private": false, "id": 51607, "creation_time": "2004-02-02T18:18:41Z", "time": "2004-02-02T18:18:41Z", "creator": "remm@apache.org", "bug_id": 26507, "attachment_id": null}, {"count": 5, "attachment_id": null, "creator": "remm@apache.org", "is_private": false, "id": 51645, "time": "2004-02-03T08:31:52Z", "bug_id": 26507, "creation_time": "2004-02-03T08:31:52Z", "tags": [], "text": "."}, {"count": 6, "tags": [], "bug_id": 26507, "text": "The patch for this has been reverted as throuwing a translation error has been\ndeemed better by the specification gurus. Please don't reopen the report.", "id": 51646, "time": "2004-02-03T08:33:28Z", "creator": "remm@apache.org", "creation_time": "2004-02-03T08:33:28Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 26507, "is_private": false, "text": "For future reference ... the clarification email to the tomcat-dev list from\nMark Roth, JSP 2.0 Co-Specification Lead\n\nhttp://marc.theaimsgroup.com/?l=tomcat-dev&m=107576431813265&w=2", "id": 51654, "time": "2004-02-03T11:42:27Z", "creator": "funkman@joedog.org", "creation_time": "2004-02-03T11:42:27Z", "attachment_id": null}, {"count": 8, "tags": [], "text": "*** Bug 27056 has been marked as a duplicate of this bug. ***", "is_private": false, "id": 52524, "creation_time": "2004-02-19T02:37:48Z", "time": "2004-02-19T02:37:48Z", "creator": "jan.luehe@sun.com", "bug_id": 26507, "attachment_id": null}]