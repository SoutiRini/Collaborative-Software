[{"count": 0, "tags": [], "text": "When we submit a cyrillic text with this JSP:\n\n\n<%@ page contentType=\"text/html;charset=windows-1251\" %>\n<form method=\"GET\" action=\"bug.jsp\">\n\t<input type=\"text\" name=\"param\">\n\t<input type=\"submit\">\n</form>\n<%\n\trequest.setCharacterEncoding(\"cp1251\");\n\tString param = request.getParameter(\"param\");\n%>\nParameter = <%= param %>\n\n\nwe obtain questionmarks instead of cyrillic characters.\n\nI seems that it is a bug. I tested in on Tomcat 4.1.24 and worked well.\n\nAlso if I use HTTP POST method, it works.\nAlso if I skip to set the response encoding (<%@ page \ncontentType=\"text/html;charset=windows-1251\" %>) it works.\n\nThe problem persists with any browser (I tested with IE 6.0 and Mozilla 1.6).\n\nIt seems that setting response's encoding to windows-1251\ncauses parameters comming from HTTP GET request to be decoded incorrectly.", "attachment_id": null, "bug_id": 28352, "id": 55661, "time": "2004-04-12T19:38:18Z", "creator": "tomcat@nakov.com", "creation_time": "2004-04-12T19:38:18Z", "is_private": false}, {"count": 1, "tags": [], "creator": "markt@apache.org", "text": "There are a number of situations where there may be a requirement to use non-\nUS ASCII characters in a URI. These include:\n- Parameters in the query string\n- Servlet paths\n\nThere is a standard for encoding URIs (http://www.w3.org/International/O-URL-\ncode.html) but this standard is not consistently followed by clients. This \ncauses a number of problems.\n\nThe functionality provided by Tomcat (4 and 5) to handle this less than ideal \nsituation is described below.\n\n1. The Coyote HTTP/1.1 connector has a useBodyEncodingForURI attribute which \nif set to true will use the request body encoding to decode the URI query \nparameters.\n  - The default value is true for TC4 (breaks spec but gives consistent \nbehaviour across TC4 versions)\n  - The default value is false for TC5 (spec compliant but there may be \nmigration issues for some apps)\n2. The Coyote HTTP/1.1 connector has a URIEncoding attribute which defaults to \nISO-8859-1.\n3. The parameters class (o.a.t.u.http.Parameters) has a QueryStringEncoding \nfield which defaults to the URIEncoding. It must be set before the parameters \nare parsed to have an effect.\n\nThings to note regarding the servlet API:\n1. HttpServletRequest.setCharacterEncoding() normally only applies to the \nrequest body NOT the URI.\n2. HttpServletRequest.getPathInfo() is decoded by the web container.\n3. HttpServletRequest.getRequestURI() is not decoded by container.\n\nOther tips:\n1. Use POST with forms to return parameters as the parameters are then part of \nthe request body.", "id": 55662, "time": "2004-04-12T19:46:19Z", "bug_id": 28352, "creation_time": "2004-04-12T19:46:19Z", "is_private": false, "attachment_id": null}]