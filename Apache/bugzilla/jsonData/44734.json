[{"count": 0, "tags": [], "text": "Created attachment 21758\nhttpd.conf\n\nApache crashes when attempting to rename a top level directory (meaning, the\ndirectory named in the <Directory> directive).\n\nCreate a test directory: \n\n# mkdir /tmp/test\n# mkdir /tmp/test/foo\n# chmod -R a+w /tmp/test\n\nMake the directory visible via httpd by adding a block to the config:\n\nAlias \"/foo/bar\" \"/tmp/test/foo/bar\"\n<Directory \"/tmp/test/foo/bar\">\n   Dav On\n   Options Indexes\n   IndexOptions +FancyIndexing\n   Allow from all\n</Directory>\n\nRun httpd -X in a debugger.\n\nAttempt to rename the directory from a client, in this case cadaver:\n\n# cadaver http://localhost:8080/foo/bar\ndav:/foo/bar/> mv /foo/bar/ /foo/barf\n\nhttpd crashes with this stack trace:\n\n(dbx) where\ncurrent thread: t@1\n=>[1] dav_get_resource(r = 0x8238380, label_allowed = 0, use_checked_in = 0, res_p = 0x8047a50), line 726 in \"mod_dav.c\"\n  [2] dav_method_copymove(r = 0x823c390, is_move = 1), line 2643 in \"mod_dav.c\"\n  [3] dav_handler(r = 0x823c390), line 4660 in \"mod_dav.c\"\n  [4] ap_run_handler(0x823c390), at 0x80ae02c \n  [5] ap_invoke_handler(r = 0x823c390), line 372 in \"config.c\"\n  [6] ap_process_request(r = 0x823c390), line 258 in \"http_request.c\"\n  [7] ap_process_http_connection(c = 0x82305f8), line 190 in \"http_core.c\"\n  [8] ap_run_process_connection(0x82305f8), at 0x80b6e9c \n  [9] ap_process_connection(c = 0x82305f8, csd = 0x8230360), line 178 in \"connection.c\"\n  [10] child_main(child_num_arg = 0), line 640 in \"prefork.c\"\n  [11] make_child(s = 0x816bab0, slot = 0), line 680 in \"prefork.c\"\n  [12] ap_mpm_run(_pconf = 0x8163bf8, plog = 0x81add20, s = 0x816bab0), line 956 in \"prefork.c\"\n  [13] main(argc = 2, argv = 0x8047cd0), line 730 in \"main.c\"\n\n(dbx) print conf->provider\nconf->provider = (nil)\n\n\nI expect that attempting to rename a directory explicitly named in the\n<Directory> block should probably be forbidden.", "attachment_id": 21758, "id": 115210, "creator": "fred.oliver@sun.com", "time": "2008-04-01T15:39:20Z", "bug_id": 44734, "creation_time": "2008-04-01T15:39:20Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 44734, "attachment_id": 21772, "text": "Created attachment 21772\nPatch against 2.2.x\n\nCan you please try if the following patch fixes your problem?", "id": 115265, "time": "2008-04-02T12:39:43Z", "creator": "rpluem@apache.org", "creation_time": "2008-04-02T12:39:43Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 44734, "is_private": false, "text": "(In reply to comment #1)\n> Created an attachment (id=21772) [details]\n> Patch against 2.2.x\n> \n> Can you please try if the following patch fixes your problem?\n> \n\nThe patch solves this problem, returning \"405 Method Not Allowed\"\nto the client.  Thank you.", "id": 115266, "time": "2008-04-02T13:25:21Z", "creator": "fred.oliver@sun.com", "creation_time": "2008-04-02T13:25:21Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 44734, "attachment_id": null, "text": "Committed to trunk as r644050 (http://svn.apache.org/viewvc?rev=644050&view=rev). Thanks for testing.", "id": 115268, "time": "2008-04-02T13:59:11Z", "creator": "rpluem@apache.org", "creation_time": "2008-04-02T13:59:11Z", "is_private": false}, {"count": 4, "tags": [], "text": "Proposed for backport to 2.2.x as r660284 (http://svn.apache.org/viewvc?rev=660284&view=rev).", "attachment_id": null, "id": 116981, "creator": "rpluem@apache.org", "time": "2008-05-26T13:05:16Z", "bug_id": 44734, "creation_time": "2008-05-26T13:05:16Z", "is_private": false}, {"count": 5, "tags": [], "text": "Backport to 2.2.x as r660571\n(http://svn.apache.org/viewvc?rev=660571&view=rev).", "is_private": false, "bug_id": 44734, "id": 117019, "time": "2008-05-27T09:03:27Z", "creator": "rpluem@apache.org", "creation_time": "2008-05-27T09:03:27Z", "attachment_id": null}]