[{"count": 0, "tags": [], "text": "Created attachment 24805\nTest spreadsheet\n\nI have an excel spreadsheet with one worksheet which I use as a template for multiple worksheets.  Prior to cloning the worksheet sometimes I need to insert a row into the worksheet.  When the program is trying to save the spreadsheet I receive the following exception:\n\norg.apache.xmlbeans.impl.values.XmlValueDisconnectedException\n\tat org.apache.xmlbeans.impl.values.XmlObjectBase.check_orphaned(XmlObjectBase.java:1213)\n\tat org.openxmlformats.schemas.spreadsheetml.x2006.main.impl.CTRowImpl.setCArray(Unknown Source)\n\tat org.apache.poi.xssf.usermodel.XSSFRow.onDocumentWrite(XSSFRow.java:392)\n\tat org.apache.poi.xssf.usermodel.XSSFSheet.write(XSSFSheet.java:2362)\n\tat org.apache.poi.xssf.usermodel.XSSFSheet.commit(XSSFSheet.java:2328)\n\tat org.apache.poi.POIXMLDocumentPart.onSave(POIXMLDocumentPart.java:177)\n\tat org.apache.poi.POIXMLDocumentPart.onSave(POIXMLDocumentPart.java:181)\n\tat org.apache.poi.POIXMLDocument.write(POIXMLDocument.java:214)\n\tat test.AATest.main(AATest.java:21)\n\nI found this bug when converting from HSSF.\n\nThis is the test program that shows the error:\npackage test;\nimport java.io.*;\n\nimport org.apache.poi.ss.usermodel.*;\nimport org.apache.poi.xssf.usermodel.*;\npublic class AATest {\n\n\t/**\n\t * @param args\n\t */\n\tpublic static void main(String[] args) {\n\t\ttry {\n\t\t\tWorkbook wb = new XSSFWorkbook(\"AATest.xlsx\");\n\t\t\tSheet sheet = wb.getSheetAt(0);\n\t\t\tsheet.shiftRows(2, sheet.getLastRowNum(), 1, true, false);\n\t\t\tRow newRow = sheet.getRow(2);\n\t\t\tif (newRow == null) newRow = sheet.createRow(2);\n\t\t\tnewRow.createCell(0).setCellValue(\" Another Header\");\n\t\t\twb.cloneSheet(0);\n\t\t    FileOutputStream fileOut = new FileOutputStream(\"newWorkbook.xlsx\");\n\t\t    wb.write(fileOut);\n\t\t    fileOut.close();\n\t\t} catch (Exception e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t\tSystem.out.println(\"Done\");\n\t}\n}\n\nIt only happens when the worksheet is cloned.\n\n\nI'll attach the spreadsheet.", "is_private": false, "id": 133392, "creator": "bstox@yahoo.com", "time": "2010-01-06T11:23:25Z", "bug_id": 48495, "creation_time": "2010-01-06T11:23:25Z", "attachment_id": 24805}, {"count": 1, "tags": [], "bug_id": 48495, "attachment_id": null, "text": "I could not reproduce this any more with the latest version of POI, please try with that version and reopen the bug with an updated testcase which reproduces the problem.", "id": 169678, "time": "2013-08-23T18:27:19Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2013-08-23T18:27:19Z", "is_private": false}]