[{"count": 0, "tags": [], "creator": "lrvaliente@gmail.com", "attachment_id": null, "id": 195786, "time": "2017-01-02T14:49:18Z", "bug_id": 60540, "creation_time": "2017-01-02T14:49:18Z", "is_private": false, "text": "I have an issue with the digital signer. I tried add digital sign to Microsoft Office Document, I attach the Exception:\n\njavax.xml.crypto.URIReferenceException: com.sun.org.apache.xml.internal.security.utils.resolver.ResourceResolverException: Cannot resolve element with ID idSignedProperties\n\tat org.jcp.xml.dsig.internal.dom.DOMURIDereferencer.dereference(DOMURIDereferencer.java:121)\n\tat org.apache.poi.poifs.crypt.dsig.OOXMLURIDereferencer.dereference(OOXMLURIDereferencer.java:85)\n\tat org.jcp.xml.dsig.internal.dom.DOMReference.dereference(DOMReference.java:430)\n\tat org.jcp.xml.dsig.internal.dom.DOMReference.digest(DOMReference.java:364)\n\tat org.jcp.xml.dsig.internal.dom.DOMXMLSignature.digestReference(DOMXMLSignature.java:496)\n\tat org.jcp.xml.dsig.internal.dom.DOMXMLSignature.sign(DOMXMLSignature.java:379)\n\tat org.apache.poi.poifs.crypt.dsig.SignatureInfo.preSign(SignatureInfo.java:522)\n\tat org.apache.poi.poifs.crypt.dsig.SignatureInfo.confirmSignature(SignatureInfo.java:335)\n\tat py.gov.senatics.SignerOfficeHelper.signOfficeXML(SignerOfficeHelper.java:221)\n\tat py.gov.senatics.SignerOfficeHelper$1.run(SignerOfficeHelper.java:115)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat java.security.AccessController.doPrivilegedWithCombiner(AccessController.java:332)\n\tat py.gov.senatics.SignerOfficeHelper.pressFirmarOnLinux(SignerOfficeHelper.java:92)\n\tat py.gov.senatics.SenaticsFirma.signDocument(SenaticsFirma.java:667)\n\tat py.gov.senatics.SenaticsFirma$2$1.run(SenaticsFirma.java:367)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: com.sun.org.apache.xml.internal.security.utils.resolver.ResourceResolverException: Cannot resolve element with ID idSignedProperties\n\tat com.sun.org.apache.xml.internal.security.utils.resolver.implementations.ResolverFragment.engineResolveURI(ResolverFragment.java:89)\n\tat com.sun.org.apache.xml.internal.security.utils.resolver.ResourceResolver.resolve(ResourceResolver.java:313)\n\tat com.sun.org.apache.xml.internal.security.utils.resolver.ResourceResolver.resolve(ResourceResolver.java:298)\n\tat org.jcp.xml.dsig.internal.dom.DOMURIDereferencer.dereference(DOMURIDereferencer.java:114)\n\t... 15 more\n\nI copied the code publiced in your site and I think I applied correctly I attached your site URL: http://poi.apache.org/encryption.html#Signing+an+office+document, but don't work for me. Could you tell me about this error?. What could be the fix?\n\nI'm very grateful if you could give me a solution"}, {"count": 1, "tags": [], "creator": "dominik.stadler@gmx.at", "text": "Can you provide a sample file with password that allows to reproduce this?", "id": 195789, "time": "2017-01-02T19:15:42Z", "bug_id": 60540, "creation_time": "2017-01-02T19:15:42Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "kiwiwings@apache.org", "is_private": false, "text": "So lets imagine, how we would try to resolve that issue:\n1. we need a document\n2. we would try to sign it with a self-signed certificate\n\nif in that process, the error happens again, then we could fix it ... otherwise we would resolve the issue as \"works for me\"\n\nTo debug that error yourself, you could check what \"uri\" is dereference at OOXMLURIDereferencer.java:85 ... maybe it's an external uri?", "id": 195801, "time": "2017-01-02T21:16:10Z", "bug_id": 60540, "creation_time": "2017-01-02T21:16:10Z", "attachment_id": null}]