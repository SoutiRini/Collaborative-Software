[{"count": 0, "tags": [], "bug_id": 23325, "attachment_id": null, "id": 44436, "creation_time": "2003-09-22T11:01:34Z", "time": "2003-09-22T11:01:34Z", "creator": "aw@soloplan.de", "text": "Hi,\n\nin the tomcat administration frontend i get a null pointer exception when i\nwant to view the datasources of app context. To configure the datasource i am\nusing the context.xml file in the META-INF directory of my web application. \nTHe context.xml looks like : \n\n<Context path=\"/auftragserfassung\" docBase=\"auftragserfassung\" debug=\"3\"\n         reloadable=\"true\" crossContext=\"true\">\n  <Logger className=\"org.apache.catalina.logger.FileLogger\"\n          prefix=\"localhost_inetorder_log.\" suffix=\".txt\"\n          timestamp=\"false\"/>\n\n  <Resource name=\"jdbc/mysql_inetorder_pk\" auth=\"Container\"\ntype=\"javax.sql.DataSource\"/>\n\n  <ResourceParams name=\"jdbc/mysql_inetorder_pk\">\n    <parameter>\n      <name>username</name>\n      <value>dmp</value>\n    </parameter>\n    <parameter>\n      <name>password</name>\n      <value>dmp</value>\n    </parameter>\n    <parameter>\n      <name>driverClassName</name>\n      <value>com.mysql.jdbc.Driver</value>\n    </parameter>\n    <parameter>\n      <name>url</name>\n      <value>jdbc:mysql://localhost/inetorder_pk</value>\n    </parameter>\n  </ResourceParams>\n  \n</Context>\n\nthe driver for the mysql database is in the webapps/WEB-INF/lib directory and\nthe $TOMCAT_HOEM/common/lib directory, so should always be found.\n\nThe exception that occurs in the manager is the following one : \n\norg.apache.jasper.JasperException: Exception retrieving attribute 'driverClassName'\n\tat org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:254)\n\tat org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:295)\n\tat org.apache.jasper.servlet.JspServlet.service(JspServlet.java:241)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat\norg.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)\n\tat\norg.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:432)\n\tat\norg.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:356)\n\tat org.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1069)\n\tat\norg.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:455)\n\tat org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:279)\n\tat org.apache.struts.action.ActionServlet.process(ActionServlet.java:1482)\n\tat org.apache.struts.action.ActionServlet.doGet(ActionServlet.java:507)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:740)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat\norg.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)\n\tat\norg.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:432)\n\tat\norg.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:356)\n\tat org.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1069)\n\tat\norg.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:455)\n\tat org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:279)\n\tat org.apache.struts.action.ActionServlet.process(ActionServlet.java:1482)\n\tat org.apache.struts.action.ActionServlet.doGet(ActionServlet.java:507)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:740)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:247)\n\tat\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)\n\tat\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:256)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat\norg.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:553)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardContext.invoke(StandardContext.java:2416)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:180)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat\norg.apache.catalina.valves.ErrorDispatcherValve.invoke(ErrorDispatcherValve.java:171)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:172)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:174)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.coyote.tomcat4.CoyoteAdapter.service(CoyoteAdapter.java:223)\n\tat org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:601)\n\tat\norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:392)\n\tat org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:565)\n\tat\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:619)\n\tat java.lang.Thread.run(Thread.java:479)\n\nroot cause\n\njavax.servlet.ServletException: Exception retrieving attribute 'driverClassName'\n\tat\norg.apache.jasper.runtime.PageContextImpl.handlePageException(PageContextImpl.java:533)\n\tat org.apache.jsp.listDataSources_jsp._jspService(listDataSources_jsp.java:494)\n\tat org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:137)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:210)\n\tat org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:295)\n\tat org.apache.jasper.servlet.JspServlet.service(JspServlet.java:241)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat\norg.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)\n\tat\norg.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:432)\n\tat\norg.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:356)\n\tat org.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1069)\n\tat\norg.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:455)\n\tat org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:279)\n\tat org.apache.struts.action.ActionServlet.process(ActionServlet.java:1482)\n\tat org.apache.struts.action.ActionServlet.doGet(ActionServlet.java:507)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:740)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat\norg.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)\n\tat\norg.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:432)\n\tat\norg.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:356)\n\tat org.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1069)\n\tat\norg.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:455)\n\tat org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:279)\n\tat org.apache.struts.action.ActionServlet.process(ActionServlet.java:1482)\n\tat org.apache.struts.action.ActionServlet.doGet(ActionServlet.java:507)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:740)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n\tat\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:247)\n\tat\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:193)\n\tat\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:256)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat\norg.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:553)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.catalina.core.StandardContext.invoke(StandardContext.java:2416)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:180)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat\norg.apache.catalina.valves.ErrorDispatcherValve.invoke(ErrorDispatcherValve.java:171)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:172)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:641)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:174)\n\tat\norg.apache.catalina.core.StandardPipeline$StandardPipelineValveContext.invokeNext(StandardPipeline.java:643)\n\tat org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:480)\n\tat org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:995)\n\tat org.apache.coyote.tomcat4.CoyoteAdapter.service(CoyoteAdapter.java:223)\n\tat org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:601)\n\tat\norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:392)\n\tat org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:565)\n\tat\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:619)\n\tat java.lang.Thread.run(Thread.java:479)\n\n\nThe driverClassName is definitely defined, as you can see in the content of the\ncontext.xml file !\n\nWhen i try to use the data source in the jndi context i get the following\nexception (i dump that out on system.out) :\n\njava.sql.SQLException: Cannot load JDBC driver class 'null'\n        at\norg.apache.commons.dbcp.BasicDataSource.createDataSource(BasicDataSource.java:529)\n        at\norg.apache.commons.dbcp.BasicDataSource.setLogWriter(BasicDataSource.java:381)\n        at\nde.soloplan.util.database.JNDIConnectionPool.init(JNDIConnectionPool.java:106)\n        at\nde.soloplan.util.database.JNDIConnectionPool.<init>(JNDIConnectionPool.java:61)\n        at\nde.soloplan.util.database.JNDIConnectionPool.getInstance(JNDIConnectionPool.java:80)\n        at\nde.soloplan.util.database.InitJNDIDBServlet.init(InitJNDIDBServlet.java:142)\n        at javax.servlet.GenericServlet.init(GenericServlet.java:256)\n        at\norg.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:935)\n        at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:823)\n        at\norg.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:3421)\n        at org.apache.catalina.core.StandardContext.start(StandardContext.java:3609)\n        at\norg.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:821)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:807)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:579)\n        at\norg.apache.catalina.core.StandardHostDeployer.install(StandardHostDeployer.java:307)\n        at org.apache.catalina.core.StandardHost.install(StandardHost.java:772)\n        at\norg.apache.catalina.startup.HostConfig.deployDirectories(HostConfig.java:559)\n        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:401)\n        at org.apache.catalina.startup.HostConfig.start(HostConfig.java:718)\n        at\norg.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:358)\n        at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:166)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1196)\n        at org.apache.catalina.core.StandardHost.start(StandardHost.java:738)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1188)\n        at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:347)\n        at org.apache.catalina.core.StandardService.start(StandardService.java:497)\n        at org.apache.catalina.core.StandardServer.start(StandardServer.java:2190)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:512)\n        at org.apache.catalina.startup.Catalina.execute(Catalina.java:400)\n        at org.apache.catalina.startup.Catalina.process(Catalina.java:180)\n        at java.lang.reflect.Method.invoke(Native Method)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:203)\n\n\nI am using tomcat 4.1.27 with default configuration. i applied the hotfix\nbut that is the only thing i changed. the jdk version is 1.3.1\n\nif you need more information tell me.\n\nThanks in advance,\n\n Andreas", "is_private": false}, {"count": 1, "tags": [], "bug_id": 23325, "attachment_id": null, "text": "Hi again,\n\none thing i forgot to metion : \nwhen i put the context configuration from the context.xml file to the \n$TOMCAT_HOME/conf/server.xml file and remove the context.xml file everything\nworks just fine. The error only occurs when i use the context.xml file in the\nMETA-INF directory.\n\nThanks,\n\nAndreas", "id": 44442, "time": "2003-09-22T11:46:32Z", "creator": "aw@soloplan.de", "creation_time": "2003-09-22T11:46:32Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 23325, "text": "This works for me. Please follow up on Tomcat user if you are still experiencing\nproblems.\n\nA few things to note are:\n - In 4.1.x a context.xml in META-INF is only used by the ManagerServlet during\ndeployment\n - a <resource-ref> in web.xml that refers to a resource that does not exist\nwill cause an error that looks like this. I have improved the error message when\nthis occurs so it is easier to see which resource is not properly defined.", "id": 76303, "time": "2005-06-11T17:53:54Z", "creator": "markt@apache.org", "creation_time": "2005-06-11T17:53:54Z", "is_private": false, "attachment_id": null}]