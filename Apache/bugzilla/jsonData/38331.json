[{"count": 0, "tags": [], "bug_id": 38331, "attachment_id": null, "is_private": false, "id": 84819, "time": "2006-01-20T15:35:04Z", "creator": "josh_rodman-bgz@vmail.mckee.com", "creation_time": "2006-01-20T15:35:04Z", "text": "This code generates an exception when running with jdk1.3.1_17:\n\nRE r123 = new RE(\"((a|b){1637})\");\nr123.match(\"a\");\n\nThis code works properly:\n\nRE r123 = new RE(\"((a|b){1638})\");\nr123.match(\"a\");\n\nThis code shows that depending on the number requested, regexp switches between \nworking and not working:\n\nboolean lastvalue = true;\nfor(int i = 1; i < 3650; i+=1) {\n    try {\n        RE r = new RE(\"((a|b){\" + i + \"})\");\n        r.match(\"a\");\n\tif (!lastvalue) { System.out.println(\"Switching from NOT to WORKING \nat \" + i + \" (\" + i + \" works) \"+lastvalue); }\n\tlastvalue = true;\n    } catch (Exception ex) {\n\tif (lastvalue) { System.out.println(\"Switching from WORKING to NOT at \" \n+ i + \" (\" + i + \" doesn't work) \"+lastvalue); }\n\tlastvalue = false;\n    }\n}\n\nThis behavior, if \"i\" was allowed past 3650, would switch back and forth a \ncouple more times before 10000, however seen it happen above 7000 (this is as \nfar as I let it test). In RE.java, look under the following signature:\n\nprotected int matchNodes(int firstNode, int lastNode, int idxStart)\n\nLook for this line:\n\nnext   = node + (short)instruction[node + offsetNext];\n\nChange it to say:\n\nnext   = node + (int)instruction[node + offsetNext];\n\nRecompile and test and this problem appears to go away, however I cannot \nconfirm that it doesn't break something else. I'm not sure why \"short\" would \nhave been chosen over \"int\". Maybe there is a hidden reason."}, {"count": 1, "tags": [], "bug_id": 38331, "text": "instruction is an array of chars, which means it has two bytes values. Offset\nfrom one instruction to another takes one char in the array, so it must be\nwithin [Short.MIN_VALUE, MAX_VALUE]. Some of the programs (like a{8192}) in\ncurrent version are compiled into code exceeding this size (more than\nShort.MAX_VALUE instructions), and so can not be expressed correctly.\n\nAdded check for this condition to RECompiler.", "id": 100167, "time": "2007-03-07T16:25:20Z", "creator": "vgritsenko@apache.org", "creation_time": "2007-03-07T16:25:20Z", "is_private": false, "attachment_id": null}]