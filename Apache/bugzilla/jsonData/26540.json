[{"count": 0, "attachment_id": null, "creator": "jmorace@jons.net", "is_private": false, "id": 51437, "time": "2004-01-29T22:49:26Z", "bug_id": 26540, "creation_time": "2004-01-29T22:49:26Z", "tags": [], "text": "I was having a problems with my sessions not sticking to the correct web\nserver in a load balanced cluster.  If I set tomcatId/jvmRoute to a\nvalue that does not contain a period, the problem goes away.  I'm using\nApache 2.0.47 with JK 2.0.2.\n\n---- Example error configuration ----\n\n# This configuration appears to fail because the jvmRoute becomes\n# server.mydomain.com:8009 (contains . characters).\n\n[shm:]\nfile=${serverRoot}/logs/jk2.shm\nsize=1048576\n\n[lb:load_balancer]\n\n[channel.socket:server.mydomain.com:8009]\nport=8009\nhost=server.mydomain.com\ngroup=load_balancer\nlb_factor=1\n\n[channel.socket:server.mydomain.com:8019]\nport=8019\nhost=server.mydomain.com\ngroup=load_balancer\nlb_factor=1\n\n[uri:/test/*]\ngroup=lb:load_balancer\n\n---- Example working configuration (using localhost) ----\n\n# This configuration works because it constructs a jvmRoute that\n# looks like localhost:8009 (no periods).\n\n[shm:]\nfile=${serverRoot}/logs/jk2.shm\nsize=1048576\n\n[lb:load_balancer]\n\n[channel.socket:localhost:8009]\nport=8009\nhost=localhost\ngroup=load_balancer\nlb_factor=1\n\n[channel.socket:localhost:8019]\nport=8019\nhost=localhost\ngroup=load_balancer\nlb_factor=1\n\n[uri:/test/*]\ngroup=lb:load_balancer\n\n---- Example working configuration (using tomcatId) ----\n\n# This configuration works because the tomcatId sets the jvmRoute\n# to server1 (no periods).\n\n[shm:]\nfile=${serverRoot}/logs/jk2.shm\nsize=1048576\n\n[lb:load_balancer]\n\n[channel.socket:server.mydomain.com:8009]\nport=8009\nhost=server.mydomain.com\ngroup=load_balancer\nlb_factor=1\ntomcatId=server1\n\n[channel.socket:server.mydomain.com:8019]\nport=8019\nhost=server.mydomain.com\ngroup=load_balancer\nlb_factor=1\ntomcatId=server2\n\n[uri:/test/*]\ngroup=lb:load_balancer"}, {"count": 1, "attachment_id": null, "creator": "funkman@joedog.org", "is_private": false, "id": 51440, "time": "2004-01-29T23:00:17Z", "bug_id": 26540, "creation_time": "2004-01-29T23:00:17Z", "tags": [], "text": "Tomcat does sticky sessions by appending a . and jvmRoute to the sessionid. (For\nexample:  06A863B10B3500AA3FBA2A9EF808E876.tomcat4)\n\nSo if your jvmRoute contains a . - then it will break."}, {"count": 2, "attachment_id": null, "creator": "jmorace@jons.net", "text": "I guess something I forgot to mention in this bug is that the default jvmRoute \nis \"host:port\".  Since most host names contain at least one \".\", such \nas \"172.18.1.1\" or \"jakarta.apache.org\", it seems like this will be a common \nproblem.  I'm reopening this bug because it caused me a lot of confusion, and \nit seems like something worth fixing.  There is not even an error to indicate \nan invalid jvmRoute is being used, it just doesn't work.", "id": 51442, "time": "2004-01-29T23:12:48Z", "bug_id": 26540, "creation_time": "2004-01-29T23:12:48Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 26540, "text": "Unless you provide a patch (or a committer reopens this) please do not reopen.\nThe sticky session design has been this way (I think)  since it has been\nwritten. (a few years ago)\n\nImplementing a fix would make jk(1) implementations odd since those config file\nare of the form:\nworker.WORKERNAME.property=value", "id": 51446, "time": "2004-01-30T00:56:36Z", "creator": "funkman@joedog.org", "creation_time": "2004-01-30T00:56:36Z", "is_private": false, "attachment_id": null}]