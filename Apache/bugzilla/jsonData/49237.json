[{"count": 0, "tags": [], "bug_id": 49237, "text": "This code rises exception (see attached file):\nnew HSSFWorkbook(new FileInputStream(\"2.xls\")).getSheetAt(0).getRow(0).getRowStyle();\n\nException rises in cases when row has double line border:\nException in thread \"main\" java.lang.IndexOutOfBoundsException: Index: 12345, Size: 71\n\tat java.util.ArrayList.RangeCheck(ArrayList.java:547)\n\tat java.util.ArrayList.get(ArrayList.java:322)\n\tat org.apache.poi.hssf.model.WorkbookRecordList.get(WorkbookRecordList.java:50)\n\tat org.apache.poi.hssf.model.Workbook.getExFormatAt(Workbook.java:787)\n\tat org.apache.poi.hssf.usermodel.HSSFRow.getRowStyle(HSSFRow.java:575)", "id": 136571, "time": "2010-04-30T08:07:58Z", "creator": "najh.ru@gmail.com", "creation_time": "2010-04-30T08:07:58Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 49237, "text": "Created attachment 25385\nExample", "id": 136572, "time": "2010-04-30T08:10:22Z", "creator": "najh.ru@gmail.com", "creation_time": "2010-04-30T08:10:22Z", "is_private": false, "attachment_id": 25385}, {"count": 2, "attachment_id": null, "creator": "apache@gagravarr.org", "is_private": false, "id": 143336, "time": "2011-01-14T05:59:24Z", "bug_id": 49237, "creation_time": "2011-01-14T05:59:24Z", "tags": [], "text": "Does the problem still occur with a recent nightly build / recent svn checkout?"}, {"count": 3, "tags": [], "bug_id": 49237, "attachment_id": null, "id": 158972, "time": "2012-05-11T09:51:10Z", "creator": "i8c.alex@gmail.com", "creation_time": "2012-05-11T09:51:10Z", "is_private": false, "text": "I can verify that this bug still exists in 3.8. I got this error dump:\n\njava.lang.IndexOutOfBoundsException: Index: 8400, Size: 589\nat java.util.ArrayList.RangeCheck(ArrayList.java:547)\nat java.util.ArrayList.get(ArrayList.java:322)\nat org.apache.poi.hssf.model.WorkbookRecordList.get(WorkbookRecordList.java:50)\nat org.apache.poi.hssf.model.InternalWorkbook.getExFormatAt(InternalWorkbook.java:832)\nat org.apache.poi.hssf.usermodel.HSSFRow.getRowStyle(HSSFRow.java:587)\nat org.apache.poi.hssf.usermodel.HSSFRow.getRowStyle(HSSFRow.java:39)"}, {"count": 4, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "text": "(In reply to comment #3)\n> I can verify that this bug still exists in 3.8. I got this error dump:\n> \n> java.lang.IndexOutOfBoundsException: Index: 8400, Size: 589\n> at java.util.ArrayList.RangeCheck(ArrayList.java:547)\n> at java.util.ArrayList.get(ArrayList.java:322)\n> at\n> org.apache.poi.hssf.model.WorkbookRecordList.get(WorkbookRecordList.java:50)\n> at\n> org.apache.poi.hssf.model.InternalWorkbook.getExFormatAt(InternalWorkbook.\n> java:832)\n> at org.apache.poi.hssf.usermodel.HSSFRow.getRowStyle(HSSFRow.java:587)\n> at org.apache.poi.hssf.usermodel.HSSFRow.getRowStyle(HSSFRow.java:39)\n\nPOI can read the attached file and we have a unit test for it. \nCan you upload a sample file that demonstrates the problem?", "id": 159672, "time": "2012-06-04T12:21:34Z", "bug_id": 49237, "creation_time": "2012-06-04T12:21:34Z", "is_private": false}, {"count": 5, "attachment_id": 30993, "creator": "kiwiwings@apache.org", "is_private": false, "id": 170977, "time": "2013-11-01T22:33:43Z", "bug_id": 49237, "creation_time": "2013-11-01T22:33:43Z", "tags": [], "text": "Created attachment 30993\n[PATCH] Bug 49237 - limit xfIndex read to 12 bits\n\nCurrently the RowRecord class tries to read the full 16 bits for the xfIndex, but spec only specifies 12 bits. (see http://msdn.microsoft.com/en-us/library/dd906757(v=office.12).aspx).\n\nIn the original test file the higher bits for top and border bottom were also set, so this led to the wrong style index"}, {"count": 6, "attachment_id": null, "bug_id": 49237, "is_private": false, "id": 171133, "time": "2013-11-07T21:57:22Z", "creator": "apache@gagravarr.org", "creation_time": "2013-11-07T21:57:22Z", "tags": [], "text": "Thanks for this Andreas. The patch looks good, applied with a few minor tweaks in r1539837."}]