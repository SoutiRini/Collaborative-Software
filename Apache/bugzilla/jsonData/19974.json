[{"count": 0, "tags": [], "bug_id": 19974, "attachment_id": null, "is_private": false, "id": 37292, "time": "2003-05-16T00:23:55Z", "creator": "george_x_zhou@yahoo.com", "creation_time": "2003-05-16T00:23:55Z", "text": "Set each cell encoding to ENCODING_UTF_16.\nWrite 6 cells in a row.  The 2nd, 3rd, 4th and 5th cells have long strings \n(9000 characters).  The 1st and last are very short.\nTry to open the generated excel, got \"Not Enough Memory\" or \"Corrupted file\".\nSee attached program.\nHowever, the file will be fine with out the last cell (Comment out line 40 of \nthe attached file) or without the encoding.\n\nimport java.io.FileOutputStream;\n\nimport org.apache.poi.hssf.usermodel.HSSFCell;\nimport org.apache.poi.hssf.usermodel.HSSFCellStyle;\nimport org.apache.poi.hssf.usermodel.HSSFFont;\nimport org.apache.poi.hssf.usermodel.HSSFRow;\nimport org.apache.poi.hssf.usermodel.HSSFSheet;\nimport org.apache.poi.hssf.usermodel.HSSFWorkbook;\nimport org.apache.poi.hssf.util.HSSFColor;\n \npublic class PoiTest \n{\n\tprivate int longStringSize = 9000;\n\t\n\tpublic static void main(String[] args) \n\t{\n\t\tPoiTest pt = new PoiTest();\n\t\tpt.writeExcel();\n\t}\n\n    public PoiTest() {\n    }\n    \n\tpublic void writeExcel(){\n\t\ttry {\n\t    HSSFWorkbook wb = new HSSFWorkbook();\n\t    HSSFSheet sheet = wb.createSheet(\"new sheet\");\n\t\n\t    // Create a row and put some cells in it. Rows are 0 based.\n\t    HSSFRow row = sheet.createRow((short)0);\n\t    // Create a cell and put a value in it.\n\t    \n\t    String longString = createLongString();\n\t    \n\t    createCellWithString(row, 0, \"1\");\n\t    createCellWithString(row, 1, longString);\n\t    createCellWithString(row, 2, longString);\n\t    createCellWithString(row, 3, longString);\n\t    createCellWithString(row, 4, longString);\n\t    createCellWithString(row, 5, \"end\");\n\t    \n\t    // Write the output to a file\n\t    FileOutputStream fileOut = new FileOutputStream(\"workbook.xls\");\n\t    wb.write(fileOut);\n\t    fileOut.close();\n\t\t} catch (Exception e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n\t\n\tprivate void createCellWithString(HSSFRow row,\n\t    int cellId, String cellStr) {\n\t    HSSFCell cell = row.createCell((short) cellId);\n\t    cell.setEncoding(HSSFCell.ENCODING_UTF_16);\n\t    cell.setCellValue(cellStr);\n\t}\n\t\n\tprivate String createLongString() {\n\t\tStringBuffer sb = new StringBuffer();\n\t\tfor (int i=0; i<longStringSize; i++) {\n\t\t\tsb.append('a');\n\t\t}\n\t\tsb.append(longStringSize);\n\t\treturn sb.toString();\n\t}\n}"}, {"count": 1, "tags": [], "text": "upgrade.", "is_private": false, "bug_id": 19974, "id": 37293, "time": "2003-05-16T00:42:56Z", "creator": "poi-support@buni.org", "creation_time": "2003-05-16T00:42:56Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 19974, "attachment_id": null, "text": "Just tried with the latest version 1.10.  Still got the same problem.", "id": 37347, "time": "2003-05-16T17:37:00Z", "creator": "george_x_zhou@yahoo.com", "creation_time": "2003-05-16T17:37:00Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 19974, "attachment_id": null, "text": "*** Bug 20045 has been marked as a duplicate of this bug. ***", "id": 39756, "time": "2003-07-01T15:01:33Z", "creator": "avik@apache.org", "creation_time": "2003-07-01T15:01:33Z", "is_private": false}, {"count": 4, "tags": [], "text": "This needs to be fixed, but I think it makes more sense to do it in 3.0.  9000\ncharacters is an awfully long strong.  I suspect I know why.  I bet that we're\nnot continuing such a thing correctly....  Its suspiciously close to the max SST\nrecord size.", "attachment_id": null, "id": 41394, "creator": "poi-support@buni.org", "time": "2003-07-24T16:34:56Z", "bug_id": 19974, "creation_time": "2003-07-24T16:34:56Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 19974, "attachment_id": null, "text": "Fixed in head. Problem with sst serializer dealing with multiple continue records.", "id": 65035, "time": "2004-10-13T03:40:44Z", "creator": "jheight@apache.org", "creation_time": "2004-10-13T03:40:44Z", "is_private": false}]