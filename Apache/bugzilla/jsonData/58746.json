[{"text": "Hi all,\nwhen I create a xls that contains a cell formula that refers to other cells in others sheets AND after I re-order the sheet with this formula, the cell doesn't contain the correct formula: POI has changed the sheet names into the formula!\n\nExample code:\n\nHSSFWorkbook workbook = new HSSFWorkbook();\nHSSFSheet first = workbook.createSheet(\"first\");\nfirst.createRow(0).createCell(0).setCellValue(1);\nHSSFSheet second = workbook.createSheet(\"second\");\nsecond.createRow(0).createCell(0).setCellValue(2);\nHSSFSheet third = workbook.createSheet(\"third\");\nHSSFRow row = third.createRow(0);\nrow.createCell(0).setCellFormula(\"first!A1\");\nrow.createCell(1).setCellFormula(\"second!A1\");\n// re-order for sheet \"third\"\nworkbook.setSheetOrder(\"third\", 0);\n\nWhat I obtain into the sheet \"third\":\n- A1: \"=second!A1\" > it must be \"=first!A1\"!!\n- B1: \"=first!A1\" > it must be \"=second!A1\"!!\n\nCould you please correct this bug as soon as possible? This is very important for the work i'm doing.\n\nThis bug is the same of 57474 but here I provide a simple code for reproduce the problem.\n\nThanks very much,\nMichele", "tags": [], "creator": "michele.bissoli.83@gmail.com", "attachment_id": null, "count": 0, "id": 186997, "time": "2015-12-17T09:51:19Z", "bug_id": 58746, "creation_time": "2015-12-17T09:51:19Z", "is_private": false}, {"count": 1, "tags": [], "creator": "michele.bissoli.83@gmail.com", "attachment_id": null, "text": "For everyone who have this problem, I have found a workaround: at start create all the sheets and only after insert all the data, so without execute a re-order.\n\nExample:\nHSSFWorkbook workbook = new HSSFWorkbook();\nHSSFSheet first = workbook.createSheet(\"first\");\nHSSFSheet second = workbook.createSheet(\"second\");\nHSSFSheet third = workbook.createSheet(\"third\");\nfirst.createRow(0).createCell(0).setCellValue(1);\nsecond.createRow(0).createCell(0).setCellValue(2);\nHSSFRow row = third.createRow(0);\nrow.createCell(0).setCellFormula(\"first!A1\");\nrow.createCell(1).setCellFormula(\"second!A1\");\n\nThis is only a workaround, the problem still exists.", "id": 187114, "time": "2015-12-24T10:55:16Z", "bug_id": 58746, "creation_time": "2015-12-24T10:55:16Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 58746, "attachment_id": null, "id": 187202, "time": "2015-12-29T08:20:31Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-12-29T08:20:31Z", "is_private": false, "text": "*** Bug 57474 has been marked as a duplicate of this bug. ***"}, {"count": 3, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "text": "Fixed via r1722410, we now try to adjust references to sheets in formulas correctly when sheets are re-ordered.", "id": 187272, "time": "2015-12-30T20:34:43Z", "bug_id": 58746, "creation_time": "2015-12-30T20:34:43Z", "is_private": false}]