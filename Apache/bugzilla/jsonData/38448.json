[{"attachment_id": null, "tags": [], "bug_id": 38448, "text": "In a reverse proxy setup I encountered a problem with user directories; it\nseemed like every now and then users got redirected to http://host/%7Euser\ninstead of the correct http://host/~user. After some debugging I figured out\nthat the frontend mod_proxy was \"canonicalizing\" URLs, thereby encoding ~ as\n%7E. This would not be an issue but for lots of backend server software that\nrelied on the URL passed to the backend server to be the same as the one the\nuser saw in their browsers. Now, this is of course a bad assumption *but* I\ndon't really know why the canonicalization happens in the first place, or even\nwhy ~ is not considered a safe character.\n\nI have attached a patch that simply adds '~' to the set of \"reserved\" characters\nfor modules/proxy/proxy_util.c:ap_proxy_canonenc. It does the job on my site. Is\nthere any reason not to apply it?\n\nNote: I tried to subscribe to apache-users@ to ask around for other people\nexperiencing this bug bug the list never confirmed my emails...", "count": 0, "id": 85199, "time": "2006-01-30T16:27:39Z", "creator": "stijn@sandcat.nl", "creation_time": "2006-01-30T16:27:39Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 38448, "text": "Created attachment 17536\npatch to reserve ~ character in mod_proxy\n\nHere is the trivial patch.", "id": 85200, "time": "2006-01-30T16:28:35Z", "creator": "stijn@sandcat.nl", "creation_time": "2006-01-30T16:28:35Z", "is_private": false, "attachment_id": 17536}, {"count": 2, "tags": [], "creator": "stijn@sandcat.nl", "attachment_id": null, "is_private": false, "id": 92015, "time": "2006-08-08T10:01:05Z", "bug_id": 38448, "creation_time": "2006-08-08T10:01:05Z", "text": "well.. guess nobody's interested either way?"}, {"count": 3, "tags": [], "creator": "nick@webthing.com", "is_private": false, "text": "(In reply to comment #2)\n> well.. guess nobody's interested either way?\n\n~ may or may not be a reserved character according to which edition of the RFC \nyou read.  Encoding it as %7E is a safe option.\n\nI don't see any strong reason to apply your patch (but feel free to try and \nconvince me).  Neither do I see any reason to close this report - it's marked \nas PatchAvailable for the benefit of anyone who wants it.", "id": 92020, "time": "2006-08-08T12:48:20Z", "bug_id": 38448, "creation_time": "2006-08-08T12:48:20Z", "attachment_id": null}, {"count": 4, "attachment_id": null, "bug_id": 38448, "text": "I changed my mind since my previous comment, and I've committed this \nto /trunk/.  Thanks:-)", "id": 92070, "time": "2006-08-08T23:33:18Z", "creator": "nick@webthing.com", "creation_time": "2006-08-08T23:33:18Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "creator": "stijn@sandcat.nl", "text": "Many thanks! That's one less customized package to maintain!", "id": 92103, "time": "2006-08-10T07:00:55Z", "bug_id": 38448, "creation_time": "2006-08-10T07:00:55Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "text": "Fixed in 2.2 branch (r571456).  Closing.", "attachment_id": null, "id": 107544, "creation_time": "2007-08-31T06:28:30Z", "time": "2007-08-31T06:28:30Z", "creator": "nick@webthing.com", "bug_id": 38448, "is_private": false}]