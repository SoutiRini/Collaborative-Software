[{"attachment_id": null, "tags": [], "creator": "lfi123@yahoo.com", "text": "Though the Junit's report engine uses the name defined by the setName method, \nANT's Junit task does not pickup it up, and uses the class name instead.\n\nThe setName method should over-ride the class name.", "count": 0, "id": 31211, "time": "2003-02-13T06:07:09Z", "bug_id": 17040, "creation_time": "2003-02-13T06:07:09Z", "is_private": false}, {"count": 1, "tags": [], "creator": "lfi123@yahoo.com", "text": "This is due to the fact that xml reporter is adding the element at the \nstartTest.  This was the 'easy' solution, rather then adding to the end test, \nwhich would create duplicate entries.  To resolve this one, I introduced a \ninteger flag to determine if the element was created previously by and error, \nor failure.\n\nThe proposed resolution are as follows:\n- Create a private integer var to detect if element was used\n- Set the flag to != 0, when error or failure method is called.\n- Move the element generation to the 'endTest'.  Wrapp it with if statement to \ncheck if the element was created by another method.\n\nIf nobody has any issues, I've made the appropriate code changes, and tested it \nout.  If nobody has an issue with the new design in next week, I would like to \nassign the defect to myself and submit the changes.\n\nThanks!\n\nLeigh", "id": 31320, "time": "2003-02-15T00:39:40Z", "bug_id": 17040, "creation_time": "2003-02-15T00:39:40Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 17040, "text": "Just attach your proposed changes and we'll have a look.", "id": 31331, "time": "2003-02-15T08:20:26Z", "creator": "conor@apache.org", "creation_time": "2003-02-15T08:20:26Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 17040, "attachment_id": 5544, "is_private": false, "id": 33976, "time": "2003-03-27T18:49:20Z", "creator": "igglue@yahoo.com", "creation_time": "2003-03-27T18:49:20Z", "text": "Created attachment 5544\njava file with the fix in it.  You can diff with the 1.5.1 released source code to see the changes."}, {"count": 4, "tags": [], "creator": "igglue@yahoo.com", "attachment_id": null, "is_private": false, "id": 33977, "time": "2003-03-27T18:50:54Z", "bug_id": 17040, "creation_time": "2003-03-27T18:50:54Z", "text": "I've made a fix to the xmljunitresultformatter.java, which addresses a bug in \nthe xml reporting file, which involves with the reporting.  Essentially, \nsetName method (which sets the test case name) does not work, due to a code \ndefect in this java file.  The call is made before the setName method is \ninvoked and thus the class name is used.  Code was moved, and conditional flag \nwas set to make sure that correct behavior is invoked.  I've tested this on \nwin32 environment, and see no gression.\n\n-Leigh"}, {"count": 5, "tags": [], "bug_id": 17040, "attachment_id": null, "text": "I've just committed a modified version of your patch to CVS HEAD.  Please try\nthe nightly build of 2003-03-29 (or later) to confirm that things work as\nexpected.\n\nI've made sure that the changes don't affect building of any project built by\nJakarta's nightly Gump runs, so we are reasonably save here, I guess.", "id": 34039, "time": "2003-03-28T12:23:10Z", "creator": "bodewig@apache.org", "creation_time": "2003-03-28T12:23:10Z", "is_private": false}, {"count": 6, "tags": [], "creator": "lfi123@yahoo.com", "text": "Stefan,\n\nThe failed test cases are being reported twice.  To avoid this, we need to \nadd \"failedTests.put(test, test);\" in the addFailure section as below.\n\n    public void addFailure(Test test, AssertionFailedError t) {\n        addFailure(test, (Throwable) t);\n\tfailedTests.put(test, test); \n    }\n\nSorry that this took long, as I haven't found a 1.6 build that worked for me.  \nI simply took the source, and re-compiled it with the 1.5.1 environment to \nverify the bug.", "id": 36153, "time": "2003-04-25T19:01:21Z", "bug_id": 17040, "creation_time": "2003-04-25T19:01:21Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "is_private": false, "id": 36213, "time": "2003-04-28T10:02:43Z", "bug_id": 17040, "creation_time": "2003-04-28T10:02:43Z", "text": "Hmm,\n\nthe failed test is supposed to be added to the failedTests hash in formatError,\nI don't see how your patch would fix this.\n\nAs for 1.6 builds that don't work for you - what is wrong with Ant's nightly\nbuilds?\n"}, {"count": 8, "tags": [], "bug_id": 17040, "text": "Well, actually neither of us was right.\n\nI didn't look at the code carefully.  Your solution isn't working, because you \nare calling the endTest before the test is added to the hash.  My solution is a \nhack and shouldn't be done.  The actual solution is to swap the order.\n\n    private void formatError(String type, Test test, Throwable t) {\n        if (test != null) {\n            endTest(test);\n            failedTests.put(test, test);\n        }\n\nshould be...\n\n    private void formatError(String type, Test test, Throwable t) {\n        if (test != null) {\n            failedTests.put(test, test);\n            endTest(test);\n        }\n\nThat should do it.\n\nLeigh", "id": 36302, "time": "2003-04-29T18:10:59Z", "creator": "lfi123@yahoo.com", "creation_time": "2003-04-29T18:10:59Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 17040, "text": "OK, I don't get the duplicate elements myself.\n\nendTest will be called twice, obce from formatError and once again at the\nend of the test.  It is correct to add the test to failedTests after calling\nendTest from formatError as we won't get the <testcase> element for it otherwise.\n\n", "id": 36587, "time": "2003-05-02T15:07:55Z", "creator": "bodewig@apache.org", "creation_time": "2003-05-02T15:07:55Z", "is_private": false, "attachment_id": null}]