[{"count": 0, "tags": [], "bug_id": 58483, "text": "Hello,\n\nwe get sometimes a Segmentation Fault on our Linux Webserver.\n\na Debug with gdb give us this:\n\nCore was generated by `/usr/sbin/apache2 -k start'.\nProgram terminated with signal SIGSEGV, Segmentation fault.\n#0  find_block_of_size (size=size@entry=48, rmm=0x7f2b6b497148)\n    at /build/buildd/apr-util-1.5.3/misc/apr_rmm.c:106\n106             if (blk->size == size)\n\n\nThe bug comes sometimes often and someimes there is nothing.", "id": 185646, "time": "2015-10-06T08:16:19Z", "creator": "patrick.baltz@eh-darmstadt.de", "creation_time": "2015-10-06T08:16:19Z", "is_private": false, "attachment_id": null}, {"count": 1, "attachment_id": null, "creator": "patrick.baltz@eh-darmstadt.de", "text": "The Linux is a Ubuntu Server 14.04.3 LTS,\nand is running on VMWARE.", "id": 185647, "time": "2015-10-06T08:20:13Z", "bug_id": 58483, "creation_time": "2015-10-06T08:20:13Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 58483, "attachment_id": null, "id": 185649, "time": "2015-10-06T08:21:48Z", "creator": "patrick.baltz@eh-darmstadt.de", "creation_time": "2015-10-06T08:21:48Z", "is_private": false, "text": "*** Bug 58482 has been marked as a duplicate of this bug. ***"}, {"count": 3, "attachment_id": null, "bug_id": 58483, "is_private": false, "id": 185650, "time": "2015-10-06T08:28:15Z", "creator": "ylavic.dev@gmail.com", "creation_time": "2015-10-06T08:28:15Z", "tags": [], "text": "Could you please provide the full gdb backtrace with \"thread apply all bt\"?"}, {"count": 4, "attachment_id": null, "bug_id": 58483, "is_private": false, "id": 185654, "time": "2015-10-06T10:13:12Z", "creator": "patrick.baltz@eh-darmstadt.de", "creation_time": "2015-10-06T10:13:12Z", "tags": [], "text": "Thread 1 (Thread 0x7f2b6b4f3780 (LWP 6508)):\n#0  find_block_of_size (size=size@entry=48, rmm=0x7f2b6b497148)\n    at /build/buildd/apr-util-1.5.3/misc/apr_rmm.c:106\n        blk = 0x7574d268c0879c3d\n        next = 8463481122625367093\n        best = 185896\n        bestsize = 3185506394507793239\n#1  0x00007f2b6abfe2f8 in apr_rmm_calloc (rmm=0x7f2b6b497148, reqsize=<optimized out>)\n    at /build/buildd/apr-util-1.5.3/misc/apr_rmm.c:342\n        size = 48\n        this = <optimized out>\n#2  0x00007f2b64bcf0ba in util_ald_alloc (cache=0x7f2b6b387c88, size=48)\n    at util_ldap_cache_mgr.c:105\n        block = 8463481122625367093\n#3  0x00007f2b64bcf85f in util_ald_cache_insert (cache=0x7f2b6b387c88,\n    payload=payload@entry=0x7fff6e2a1ea0) at util_ldap_cache_mgr.c:470\n        hashval = <optimized out>\n        tmp_payload = <optimized out>\n        node = <optimized out>\n#4  0x00007f2b64bcc047 in uldap_cache_checkuserid (r=<optimized out>, ldc=0x7f2b6b48d0a0,\n    url=<optimized out>, basedn=<optimized out>, scope=<optimized out>, attrs=0x7f2b6b40a410,\n    filter=0x7fff6e2a1fc0 \"(&(objectClass=*)(sAMAccountName=moritz.jirka))\",\n    bindpw=0x7f2b6b3672c5 \"929567\", binddn=0x7fff6e2a1f60, retvals=0x7f2b6b3672f0)\n    at util_ldap.c:1846\n        vals = 0x7f2b6b367368\n        numvals = 2\n        result = <optimized out>\n        res = 0x7f2b6d2d2af0\n        entry = 0x7f2b6d2d2af0\n        dn = <optimized out>\n        count = <optimized out>\n        failures = <optimized out>\n        curl = 0x7f2b6b38a1a8\n        curnode = {\n          url = 0x7f2b6b40a370 \"ldap://de++++++++/ou=benutzer,dc=e+++,dc=local?sAMAccountName?sub?(objectClass=*)\", search_cache = 0x7f2b6a9c45e7 <apr_pmemdup+39>, compare_cache = 0x7f2b8fba80be,\n          dn_compare_cache = 0x7f2b6b36a0a0}\n        search_nodep = 0x0\n        the_search_node = {\n          username = 0x7fff6e2a1fc0 \"(&(objectClass=*)(sAMAccountName=moritz.jirka))\",\n          dn = 0x7f2b6b367310 \"CN=Moritz Jirka,OU=SozA_WS_2015,OU=WS2015,OU=Studenten,OU=Benutzer,DC=efhd,DC=local\", bindpw = 0x7f2b6b3672c5 \"929567\", lastbind = 1444059799669958,\n          vals = 0x7f2b6b367368, numvals = 2}\n        curtime = <optimized out>\n        st = <optimized out>\n#5  0x00007f2b68f4d3ed in authn_ldap_check_password (r=0x7f2b6b36a0a0,\n    user=0x7f2b6b3672d0 \"moritz.jirka\", password=0x7f2b6b3672c5 \"929567\") at mod_authnz_ldap.c:528\n        filtbuf = \"(&(objectClass=*)(sAMAccountName=moritz.jirka))\\000\\252r\\177=\\355\\231\\070\\314M(g\\342\\264\\257\\342\\004\\305\\316r\\315\\030\\357\u0792\\300F\\311\\374\\022zk\\350\\301\\303\\177\\356\\n+5~\\330\\034\\353\\003\\067\\210\\353\\274K\\326\\346\\032\\363,\\v\\336`\\021!w\\001\\350=T3c\\340\u0299\\f\\233\\342\\202d_S\\226\\361)\\036\\302Df\\020\\024\\331\\031$iD\\036C9\\316 D\u06bf\\236\\204\\246u\\203xY\\233A\\201]\\002tg\\235\u04d64\\310z\\364Zw\\005\\262\\246\\364+4\\326(\\301M\\347%!H\\372\\001\\350\\\\\\276pb\\265^)\\364\\314\\331$7Y\\307\\066XZ\\325>q\"...\n        sec = 0x7f2b6b409b08\n        ldc = 0x7f2b6b48d0a0\n        result = 0\n        remote_user_attribute_set = 0\n        dn = 0x7f2b6b367310 \"CN=Moritz Jirka,OU=SozA_WS_2015,OU=WS2015,OU=Studenten,OU=Benutzer,DC=efhd,DC=local\"\n---Type <return> to continue, or q <return> to quit---\n#6  0x00007f2b6955b94e in authenticate_basic_user (r=0x7f2b6b36a0a0) at mod_auth_basic.c:383\n        provider = 0x7f2b691518d0 <authn_ldap_provider>\n        conf = 0x7f2b6b367000\n        sent_user = 0x7f2b6b3672d0 \"moritz.jirka\"\n        sent_pw = 0x7f2b6b3672c5 \"929567\"\n        current_auth = <optimized out>\n        realm = 0x0\n        digest = 0x0\n        auth_result = <optimized out>\n        current_provider = 0x7f2b6b409af0\n#7  0x00007f2b6b2bc250 in ap_run_check_user_id (r=0x7f2b6b36a0a0) at request.c:81\n        pHook = 0x7f2b6b49e088\n        n = 1\n        rv = 1431252021\n#8  0x00007f2b6b2bf1e2 in ap_process_request_internal (r=r@entry=0x7f2b6b36a0a0) at request.c:273\n        file_req = <optimized out>\n        access_status = <optimized out>\n        d = <optimized out>\n#9  0x00007f2b6b2db6a8 in ap_process_async_request (r=r@entry=0x7f2b6b36a0a0) at http_request.c:315\n        access_status = -1\n#10 0x00007f2b6b2db994 in ap_process_request (r=r@entry=0x7f2b6b36a0a0) at http_request.c:363\n        bb = <optimized out>\n        b = <optimized out>\n        c = 0x7f2b6b381290\n        rv = <optimized out>\n#11 0x00007f2b6b2d8432 in ap_process_http_sync_connection (c=0x7f2b6b381290) at http_core.c:190\n        r = 0x7f2b6b36a0a0\n        cs = 0x0\n        csd = 0x7f2b6b3810a0\n        mpm_state = 1\n#12 ap_process_http_connection (c=0x7f2b6b381290) at http_core.c:231\nNo locals.\n#13 0x00007f2b6b2cf210 in ap_run_process_connection (c=0x7f2b6b381290) at connection.c:41\n        pHook = 0x7f2b6b49de10\n        n = 0\n        rv = 1431252021\n#14 0x00007f2b6b2cf5f8 in ap_process_connection (c=c@entry=0x7f2b6b381290, csd=<optimized out>)\n    at connection.c:202\n        rc = <optimized out>\n#15 0x00007f2b647bb767 in child_main (child_num_arg=child_num_arg@entry=17) at prefork.c:704\n        current_conn = 0x7f2b6b381290\n        csd = 0x7f2b6b3810a0\n        thd = 0x7f2b6b3830a0\n        osthd = 139824460674944\n        ptrans = 0x7f2b6b381028\n        allocator = 0x7f2b6d2d22e0\n        status = <optimized out>\n        i = <optimized out>\n        lr = <optimized out>\n        pollset = 0x7f2b6b383158\n        sbh = 0x7f2b6b383150\n        bucket_alloc = 0x7f2b6b37d028\n        last_poll_idx = 1\n        lockfile = <optimized out>\n#16 0x00007f2b647bb9a6 in make_child (s=0x7f2b6b4c1de0, slot=17) at prefork.c:800\n        pid = 0\n#17 0x00007f2b647bc60e in perform_idle_server_maintenance (p=<optimized out>) at prefork.c:902\n        i = <optimized out>\n        idle_count = <optimized out>\n ws = <optimized out>\n        free_length = <optimized out>\n        free_slots = {14, 17, 18, 19, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58,\n          0 <repeats 16 times>}\n        last_non_dead = <optimized out>\n        total_non_dead = <optimized out>\n#18 prefork_run (_pconf=<optimized out>, plog=<optimized out>, s=<optimized out>) at prefork.c:1090\n        status = 0\n        pid = {pid = -1, in = 0x7f2b6b2e6608, out = 0xa, err = 0x7f2b6a9c4ff6 <find_entry+134>}\n        child_slot = <optimized out>\n        exitwhy = APR_PROC_EXIT\n        processed_status = <optimized out>\n        index = <optimized out>\n        remaining_children_to_start = 0\n        rv = <optimized out>\n#19 0x00007f2b6b2ac8ae in ap_run_mpm (pconf=0x7f2b6b4f9028, plog=0x7f2b6b4c7028, s=0x7f2b6b4c1de0)\n    at mpm_common.c:96\n        pHook = 0x7f2b6b49e268\n        n = 0\n        rv = 1431252021\n#20 0x00007f2b6b2a6046 in main (argc=3, argv=0x7fff6e2a4638) at main.c:777\n        c = 0 '\\000'\n        showcompile = 0\n        showdirectives = 0\n        confname = 0x7f2b6b2e5bc7 \"apache2.conf\"\n        def_server_root = 0x7f2b6b2e5bba \"/etc/apache2\"\n        temp_error_log = 0x0\n        error = <optimized out>\n        process = 0x7f2b6b4fb118\n        pconf = 0x7f2b6b4f9028\n        plog = 0x7f2b6b4c7028\n        ptemp = 0x7f2b6b4c3028\n        pcommands = 0x7f2b6b4d1028\n        opt = 0x7f2b6b4d1118\n        rv = <optimized out>\n        mod = 0x7f2b6b507160 <ap_prelinked_modules+64>\n        opt_arg = 0x7f2b6b4fb028 \"(\\360Ok+\\177\"\n        signal_server = <optimized out>"}, {"count": 5, "tags": [], "creator": "rpluem@apache.org", "is_private": false, "id": 185655, "creation_time": "2015-10-06T11:48:15Z", "time": "2015-10-06T11:48:15Z", "bug_id": 58483, "text": "Can you please execute the following commands in gdb:\n\nthread 1\nframe 0\nprint *rmm", "attachment_id": null}, {"count": 6, "attachment_id": null, "bug_id": 58483, "text": "The Password for the User moritz.jirka is only his Matrickel numer, there are no special characters only 6 numbers.\n\nHere are the output of the commands.\n\nCore was generated by `/usr/sbin/apache2 -k start'.\nProgram terminated with signal SIGSEGV, Segmentation fault.\n#0  find_block_of_size (size=size@entry=48, rmm=0x7f2b6b497148)\n    at /build/buildd/apr-util-1.5.3/misc/apr_rmm.c:106\n106             if (blk->size == size)\n(gdb) thread 1\n[Switching to thread 1 (Thread 0x7f2b6b4f3780 (LWP 6508))]\n#0  find_block_of_size (size=size@entry=48, rmm=0x7f2b6b497148)\n    at /build/buildd/apr-util-1.5.3/misc/apr_rmm.c:106\n106             if (blk->size == size)\n(gdb) frame 0\n#0  find_block_of_size (size=size@entry=48, rmm=0x7f2b6b497148)\n    at /build/buildd/apr-util-1.5.3/misc/apr_rmm.c:106\n106             if (blk->size == size)\n(gdb) print *rmm\n$1 = {p = 0x7f2b6b497028, base = 0x7f2b6b387008, size = 500000, lock = {type = apr_anylock_none,\n    lock = {pm = 0x0, tm = 0x0, rw = 0x0}}}\n(gdb)", "id": 185656, "time": "2015-10-06T12:06:05Z", "creator": "patrick.baltz@eh-darmstadt.de", "creation_time": "2015-10-06T12:06:05Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "bug_id": 58483, "attachment_id": null, "is_private": false, "id": 185660, "time": "2015-10-06T13:03:24Z", "creator": "rpluem@apache.org", "creation_time": "2015-10-06T13:03:24Z", "text": "Thanks. Please also execute the following commands in addition:\n\nprint blk\nprint next\nprint *rmm->base"}, {"attachment_id": null, "tags": [], "bug_id": 58483, "is_private": false, "count": 8, "id": 185661, "time": "2015-10-06T13:04:33Z", "creator": "patrick.baltz@eh-darmstadt.de", "creation_time": "2015-10-06T13:04:33Z", "text": "(gdb) print blk\n$1 = (struct rmm_block_t *) 0x7574d268c0879c3d\n(gdb) print next\n$2 = 8463481122625367093\n(gdb) print *rmm->base\n$3 = {abssize = 500000, firstused = 24, firstfree = 185896}\n(gdb)"}, {"count": 9, "tags": [], "text": "(In reply to Patrick Baltz from comment #8)\n> (gdb) print blk\n> $1 = (struct rmm_block_t *) 0x7574d268c0879c3d\n> (gdb) print next\n> $2 = 8463481122625367093\n> (gdb) print *rmm->base\n> $3 = {abssize = 500000, firstused = 24, firstfree = 185896}\n> (gdb)\n\nLooks like the rmm internal structures got corrupted somehow (next is far too large), but currently I have no idea how this could have happened.", "attachment_id": null, "bug_id": 58483, "id": 185695, "time": "2015-10-08T07:19:01Z", "creator": "rpluem@apache.org", "creation_time": "2015-10-08T07:19:01Z", "is_private": false}]