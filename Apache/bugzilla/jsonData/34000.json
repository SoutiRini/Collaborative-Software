[{"count": 0, "tags": [], "bug_id": 34000, "attachment_id": null, "id": 72321, "time": "2005-03-14T09:04:00Z", "creator": "grig@supportwizard.com", "creation_time": "2005-03-14T09:04:00Z", "is_private": false, "text": "create a servlet map\n\n  <servlet-mapping>\n    <servlet-name>javascript</servlet-name>\n    <url-pattern>*.js</url-pattern>\n  </servlet-mapping>\n\nExpected result: it should process only *.js, not *.js* (like JSP, JSPF, JSF \netc.)\n\nReal result: the servlet processes all of requested resources with \nextensions \"js*\" , i.e. it takes *.jsp, *.js, *.jspf like if url-pattern was \nset to \n\n<url-pattern>*.js*</url-pattern>"}, {"count": 1, "tags": [], "bug_id": 34000, "text": "This works for me with the current 5.5.x builds. As the mapper has not changed\nsignificantly since those builds, I have to think it works as well on 5.0.x.", "id": 72335, "time": "2005-03-14T10:41:59Z", "creator": "remm@apache.org", "creation_time": "2005-03-14T10:41:59Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 34000, "text": "I am sorry, but the bug exists for me. Our deployment descriptor is here, as I \nnotice nothing conflicts with my declaration of the servlet mapping:\n\n<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\n<!DOCTYPE web-app PUBLIC \"-//Sun Microsystems, Inc.//DTD Web Application \n2.3//EN\"  \"http://java.sun.com/dtd/web-app_2_3.dtd\">\n<web-app>\n\n  <!-- Compression filters -->\n  <filter>\n    <filter-name>Cleaner Filter</filter-name>\n    <filter-\nclass>com.supportwizard.gui2.servlets.system.GUIHTMLCleaner</filter-class>\n  </filter>\n  <filter>\n    <filter-name>Compression Filter</filter-name>\n    <filter-\nclass>com.supportwizard.gui2.servlets.system.CompressionFilter</filter-class>\n    <init-param>\n      <param-name>compressionThreshold</param-name>\n      <param-value>8192</param-value>\n    </init-param>\n  </filter>\n  <filter>\n    <filter-name>NDCFilter</filter-name>\n    <filter-class>com.supportwizard.gui2.servlets.system.NDCFilter</filter-\nclass>\n  </filter>\n\n  <!-- Cactus filter redirector -->\n  <filter>\n    <filter-name>FilterRedirector</filter-name>\n    <filter-class>org.apache.cactus.server.FilterTestRedirector</filter-class>\n  </filter>\n\n  <filter-mapping>\n    <filter-name>FilterRedirector</filter-name>\n    <url-pattern>/tests/FilterRedirector</url-pattern>\n  </filter-mapping>\n\n  <filter-mapping>\n    <filter-name>Compression Filter</filter-name>\n    <url-pattern>/styles</url-pattern>\n  </filter-mapping>\n  <filter-mapping>\n    <filter-name>Cleaner Filter</filter-name>\n    <url-pattern>/*</url-pattern>\n  </filter-mapping>\n\n  <filter-mapping>\n    <filter-name>NDCFilter</filter-name>\n    <url-pattern>/*</url-pattern>\n  </filter-mapping>\n  <!-- GUIAction Servlet Configuration -->\n  <servlet>\n    <servlet-name>action</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.system.GUIActionServlet</servlet-class>\n    <init-param>\n      <param-name>application</param-name>\n      <param-value>com.supportwizard.gui2.GUI2</param-value>\n    </init-param>\n    <init-param>\n      <param-name>config</param-name>\n      <param-value>/WEB-INF/struts-config.xml</param-value>\n    </init-param>\n    <init-param>\n      <param-name>config/admin</param-name>\n      <param-value>/WEB-INF/admin-struts-config.xml</param-value>\n    </init-param>\n    <init-param>\n      <param-name>debug</param-name>\n      <param-value>2</param-value>\n    </init-param>\n    <init-param>\n      <param-name>detail</param-name>\n      <param-value>2</param-value>\n    </init-param>\n    <init-param>\n      <param-name>validate</param-name>\n      <param-value>true</param-value>\n    </init-param>\n    <init-param>\n      <param-name>multipartClass</param-name>\n      <param-value>org.apache.struts.upload.DiskMultipartRequestHandler</param-\nvalue>\n    </init-param>\n    <load-on-startup>2</load-on-startup>\n  </servlet>\n  <servlet>\n    <servlet-name>setup</servlet-name>\n    <servlet-class>com.supportwizard.gui2.servlets.SetupServlet</servlet-class>\n    <load-on-startup>1</load-on-startup>\n  </servlet>\n  <servlet>\n    <servlet-name>attachment</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.auxiliary.GUIAttachGetter</servlet-class>\n  </servlet>\n  <servlet>\n    <servlet-name>reportRun</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.auxiliary.ReportRunGetter</servlet-class>\n  </servlet>\n  <servlet>\n    <servlet-name>nls</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.auxiliary.NLSGetter</servlet-class>\n  </servlet>\n  <servlet>\n    <servlet-name>images</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.imagereg.GUIImageGetter</servlet-class>\n  </servlet>\n  <servlet>\n    <servlet-name>styles</servlet-name>\n    <servlet-class>com.supportwizard.gui2.servlets.css.GUICSSServlet</servlet-\nclass>\n  </servlet>\n  <servlet>\n    <servlet-name>javascript</servlet-name>\n    <servlet-class>com.supportwizard.gui2.servlets.system.GUIJsGetter</servlet-\nclass>\n  </servlet>\n  <servlet>\n    <servlet-name>settings</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.auxiliary.GUISettingsSetter</servlet-\nclass>\n  </servlet>\n  <servlet>\n    <servlet-name>BugSubmitter</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.auxiliary.BugSubmitter</servlet-class>\n  </servlet>\n  <servlet>\n    <servlet-name>DeleteAction</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.workflow.DeleteAction</servlet-class>\n  </servlet>\n  <servlet>\n    <servlet-name>DeleteGuard</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.workflow.DeleteGuard</servlet-class>\n  </servlet>\n  <!-- Servlets for communicating with workflow applet -->\n  <servlet>\n    <servlet-name>LogServlet</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.workflow.LogServlet</servlet-class>\n  </servlet>\n  <servlet>\n    <servlet-name>GetWF</servlet-name>\n    <servlet-class>com.supportwizard.gui2.servlets.workflow.GetWF</servlet-\nclass>\n  </servlet>\n  <servlet>\n    <servlet-name>SaveWF</servlet-name>\n    <servlet-class>com.supportwizard.gui2.servlets.workflow.SaveWF</servlet-\nclass>\n  </servlet>\n  <servlet>\n    <servlet-name>ListActions</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.workflow.ListActions</servlet-class>\n  </servlet>\n  <servlet>\n    <servlet-name>ListGuards</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.workflow.ListGuards</servlet-class>\n  </servlet>\n  <servlet>\n    <servlet-name>MakeGuard</servlet-name>\n    <servlet-class>com.supportwizard.gui2.servlets.workflow.MakeGuard</servlet-\nclass>\n  </servlet>\n  <servlet>\n    <servlet-name>MakeAction</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.workflow.MakeAction</servlet-class>\n  </servlet>\n  <servlet>\n    <servlet-name>GetGuardData</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.workflow.GetGuardData</servlet-class>\n  </servlet>\n  <servlet>\n    <servlet-name>GetActionData</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.workflow.GetActionData</servlet-class>\n  </servlet>\n  <servlet>\n    <servlet-name>GetSubtypeFields</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.workflow.GetSubtypeFields</servlet-class>\n  </servlet>\n  <servlet>\n    <servlet-name>GetGroupInfo</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.workflow.GetGroupInfo</servlet-class>\n  </servlet>\n  <!-- OSW Servlets -->\n  <servlet>\n    <servlet-name>GetContactHierarchy</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.osw.contacts.GetContactHierarchy</servlet\n-class>\n  </servlet>\n  <servlet>\n    <servlet-name>GetContactSubtype</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.osw.contacts.GetContactSubtype</servlet-\nclass>\n  </servlet>\n  <servlet>\n    <servlet-name>GetContactMappingList</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.osw.contacts.GetContactMappingList</servl\net-class>\n  </servlet>\n  <servlet>\n    <servlet-name>GetContactMapping</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.osw.contacts.GetContactMapping</servlet-\nclass>\n  </servlet>\n  <servlet>\n    <servlet-name>SaveContactMapping</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.osw.contacts.SaveContactMapping</servlet-\nclass>\n  </servlet>\n  <servlet>\n    <servlet-name>SaveContactForSubtype</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.osw.contacts.SaveContactForSubtype</servl\net-class>\n  </servlet>\n  <servlet>\n    <servlet-name>GetContactsForSubtype</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.osw.contacts.GetContactsForSubtype</servl\net-class>\n  </servlet>\n  <servlet>\n    <servlet-name>RemoveContactMapping</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.osw.contacts.RemoveContactMapping</servle\nt-class>\n  </servlet>\n  <servlet>\n    <servlet-name>GetContactPropertyList</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.osw.contacts.GetContactPropertyList</serv\nlet-class>\n  </servlet>\n  <servlet>\n    <servlet-name>GetSwFilterInfo</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.osw.contacts.GetSwFilterInfo</servlet-\nclass>\n  </servlet>\n  <servlet>\n    <servlet-name>GetContactsNumber</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.osw.contacts.GetContactsNumber</servlet-\nclass>\n  </servlet>\n  <!-- Barcode generation servlet -->\n  <servlet>\n    <servlet-name>BarcodeGeneratorServlet</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.print.BarCodeGeneratorServlet</servlet-\nclass>\n    <init-param>\n      <param-name>default-width</param-name>\n      <param-value>200</param-value>\n    </init-param>\n    <init-param>\n      <param-name>default-height</param-name>\n      <param-value>80</param-value>\n    </init-param>\n  </servlet>\n  <!-- Redirecting servlet -->\n  <servlet>\n    <servlet-name>redirect</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.system.GUIRedirector</servlet-class>\n  </servlet>\n  <!-- Cactus redirectors -->\n  <servlet>\n    <servlet-name>ServletRedirector</servlet-name>\n    <servlet-class>org.apache.cactus.server.ServletTestRedirector</servlet-\nclass>\n  </servlet>\n  <servlet>\n    <servlet-name>JsTestCaseServlet</servlet-name>\n    <servlet-class>com.supportwizard.tests.gui2.JsTestCaseServlet</servlet-\nclass>\n  </servlet>\n  <!-- views repair servlet -->\n  <servlet>\n    <servlet-name>viewsRepair</servlet-name>\n    <servlet-class>com.supportwizard.gui2.servlets.ViewsRepairServlet</servlet-\nclass>\n  </servlet>\n  <servlet>\n    <servlet-name>MemoryMonitor</servlet-name>\n    <servlet-\nclass>com.supportwizard.gui2.servlets.MemoryMonitorServlet</servlet-class>\n    <load-on-startup>10000</load-on-startup>\n  </servlet>\n\n  <!--\n@servletMappings@\n  -->\n\n\n  <!-- Action Servlet Mapping -->\n  <servlet-mapping>\n    <servlet-name>BugSubmitter</servlet-name>\n    <url-pattern>/submitBug</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>LogServlet</servlet-name>\n    <url-pattern>/workflow/LogServlet</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>GetWF</servlet-name>\n    <url-pattern>/workflow/GetWF</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>SaveWF</servlet-name>\n    <url-pattern>/workflow/SaveWF</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>ListActions</servlet-name>\n    <url-pattern>/workflow/ListActions</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>ListGuards</servlet-name>\n    <url-pattern>/workflow/ListGuards</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>MakeAction</servlet-name>\n    <url-pattern>/workflow/MakeAction</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>MakeGuard</servlet-name>\n    <url-pattern>/workflow/MakeGuard</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>GetGuardData</servlet-name>\n    <url-pattern>/workflow/GetGuardData</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>GetActionData</servlet-name>\n    <url-pattern>/workflow/GetActionData</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>GetSubtypeFields</servlet-name>\n    <url-pattern>/workflow/GetSubtypeFields</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>GetGroupInfo</servlet-name>\n    <url-pattern>/workflow/GetGroupInfo</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>DeleteAction</servlet-name>\n    <url-pattern>/workflow/DeleteAction</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>DeleteGuard</servlet-name>\n    <url-pattern>/workflow/DeleteGuard</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>redirect</servlet-name>\n    <url-pattern>/redirect</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>action</servlet-name>\n    <url-pattern>/do/*</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>action</servlet-name>\n    <url-pattern>*.do</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>nls</servlet-name>\n    <url-pattern>/nls/download/*</url-pattern>\n  </servlet-mapping>\n  <!-- Action Servlet Mapping -->\n  <servlet-mapping>\n    <servlet-name>attachment</servlet-name>\n    <url-pattern>/attach/*</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>reportRun</servlet-name>\n    <url-pattern>/charts/run/view/*</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>settings</servlet-name>\n    <url-pattern>/settings</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>images</servlet-name>\n    <url-pattern>/images/*</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>images</servlet-name>\n    <url-pattern>*.gif</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>images</servlet-name>\n    <url-pattern>*.jpg</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>styles</servlet-name>\n    <url-pattern>/styles</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>javascript</servlet-name>\n    <url-pattern>*.js</url-pattern>\n  </servlet-mapping>\n  <!-- OSW Servlet Mapping -->\n  <servlet-mapping>\n    <servlet-name>GetContactHierarchy</servlet-name>\n    <url-pattern>/osw/contacts/GetHierarchy</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>GetContactSubtype</servlet-name>\n    <url-pattern>/osw/contacts/GetSubtype</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>GetContactMappingList</servlet-name>\n    <url-pattern>/osw/contacts/GetMappingList</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>GetContactMapping</servlet-name>\n    <url-pattern>/osw/contacts/GetMapping</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>SaveContactMapping</servlet-name>\n    <url-pattern>/osw/contacts/SaveMapping</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>RemoveContactMapping</servlet-name>\n    <url-pattern>/osw/contacts/RemoveMapping</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>GetContactsForSubtype</servlet-name>\n    <url-pattern>/osw/contacts/GetContactsForSubtype</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>SaveContactForSubtype</servlet-name>\n    <url-pattern>/osw/contacts/SaveContactForSubtype</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>GetContactPropertyList</servlet-name>\n    <url-pattern>/osw/contacts/GetPropertyList</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>GetSwFilterInfo</servlet-name>\n    <url-pattern>/osw/contacts/GetSwFilterInfo</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>GetContactsNumber</servlet-name>\n    <url-pattern>/osw/contacts/GetContactsNumber</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>BarcodeGeneratorServlet</servlet-name>\n    <url-pattern>/print/BarcodeGenerator</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>viewsRepair</servlet-name>\n    <url-pattern>/repair/RepairViews</url-pattern>\n  </servlet-mapping>\n  <!-- Cactus redirectors -->\n  <servlet-mapping>\n    <servlet-name>ServletRedirector</servlet-name>\n    <url-pattern>/tests/ServletRedirector</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>JsTestCaseServlet</servlet-name>\n    <url-pattern>/tests/JsTestCaseServlet</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>MemoryMonitor</servlet-name>\n    <url-pattern>/memory/MemoryMonitor</url-pattern>\n  </servlet-mapping>\n\n  <welcome-file-list>\n    <welcome-file>login.jsp</welcome-file>\n  </welcome-file-list>\n  <!--error page -->\n  <error-page>\n    <error-code>500</error-code>\n    <location>/error.jsp</location>\n  </error-page>\n  <error-page>\n    <exception-type>java.lang.RuntimeException</exception-type>\n    <location>/error.jsp</location>\n  </error-page>\n  <taglib>\n    <taglib-uri>/WEB-INF/struts-bean.tld</taglib-uri>\n    <taglib-location>/WEB-INF/struts-bean.tld</taglib-location>\n  </taglib>\n  <taglib>\n    <taglib-uri>/WEB-INF/struts-html.tld</taglib-uri>\n    <taglib-location>/WEB-INF/struts-html.tld</taglib-location>\n  </taglib>\n  <taglib>\n    <taglib-uri>/WEB-INF/struts-logic.tld</taglib-uri>\n    <taglib-location>/WEB-INF/struts-logic.tld</taglib-location>\n  </taglib>\n</web-app>\n\n", "id": 72345, "time": "2005-03-14T11:41:51Z", "creator": "grig@supportwizard.com", "creation_time": "2005-03-14T11:41:51Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "here is the GUIJsGetter servlet\n\n/*\n * SupportWizard 2\n *\n * Copyright (C) 2001 ISC corp. All Rights Reserved.\n *\n * $Id: GUIJsGetter,v 1.44 2005/02/03 15:24:34 grig Exp $\n */\n\npackage com.supportwizard.gui2.servlets.system;\n\nimport com.supportwizard.utils.RevisionHelper;\nimport java.io.*;\nimport javax.servlet.ServletException;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport org.apache.log4j.Category;\nimport org.apache.log4j.Logger;\n\n/**\n * javascript getter\n * @author Grigory Danileyko\n */\npublic class GUIJsGetter extends HttpServlet {\n\n  private final static String CONTENT_TYPE_VALUE = \"text/javascript\";\n  private static final String CACHE_CONTROL_KEY = \"Cache-Control\";\n  private static final String PRIVATE_CACHE_VALUE = \"private\";\n  private static final String STORING_RULES = \"max-age=\" + 1 + \", must-\nrevalidate\";\n\n  /**\n   * logger instance\n   */\n  private final static Category log = Logger.getInstance(GUIJsGetter.class);\n\n  protected void doPost(HttpServletRequest request, HttpServletResponse \nresponse) throws IOException {\n    response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED);\n  }\n\n  /**\n   * do get\n   * @param request\n   * @param response\n   * @throws ServletException\n   * @throws IOException\n   */\n  protected void doGet(HttpServletRequest request, HttpServletResponse \nresponse) throws ServletException, IOException {\n    final File file = getFileInfo(request);\n    if (!file.getPath().endsWith(\".js\")) {\n      log.warn(file.getPath() + \" is not javascript page.\");\n      throw new ServletException(\"it is not a javascript page\");\n\n    } else {\n      log.warn(\"doGet for \" + file.getPath());\n      if (file.exists()) {\n        try {\n          doContentInfo(response, file.length());\n          doFile(file, response);\n        } catch (IOException e) {\n          log.error(e);\n          response.sendError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);\n        }\n      } else {\n        log.error(\"the requested file \" + file.getPath() + \" not found\");\n        response.sendError(HttpServletResponse.SC_NOT_FOUND);\n      }\n    }\n  }\n\n  private final File getFileInfo(final HttpServletRequest newRequest) {\n    final String path = getServletContext().getRealPath\n(newRequest.getServletPath());\n    return new File(path);\n  }\n\n  protected void doHead(HttpServletRequest request, HttpServletResponse \nresponse) throws ServletException, IOException {\n    final File file = getFileInfo(request);\n    log.warn(\"doHead for \" + file.getPath());\n    if (file.exists()) {\n      doContentInfo(response, file.length());\n\n    } else {\n      response.sendError(HttpServletResponse.SC_NOT_FOUND);\n    }\n  }\n\n  /**\n   * reads the requested file and put out it to browser.\n   * @param newFile\n   * @param response\n   * @throws IOException\n   */\n  private static final void doFile(final File newFile, final \nHttpServletResponse response) throws IOException {\n    final PrintWriter out = response.getWriter();\n    final BufferedReader reader = new BufferedReader(new FileReader(newFile));\n    try {\n      String line;\n      while ((line = reader.readLine()) != null)\n        out.println(line);\n\n    } finally {\n      reader.close();\n    }\n  }\n\n  protected long getLastModified(final HttpServletRequest request) {\n    final String path = getServletContext().getRealPath(request.getServletPath\n());\n    final File file = new File(path);\n    log.warn(\"getLastModified for \" + path);\n    return Math.max(RevisionHelper.getBuildDateUtc(), file.lastModified());\n  }\n\n  private final static void doContentInfo(final HttpServletResponse response, \nfinal long newLength) {\n    response.setContentLength((int) newLength);\n    response.setContentType(CONTENT_TYPE_VALUE);\n    response.setHeader(CACHE_CONTROL_KEY, PRIVATE_CACHE_VALUE);\n    response.setHeader(CACHE_CONTROL_KEY, STORING_RULES);\n  }\n}\n", "attachment_id": null, "bug_id": 34000, "id": 72423, "time": "2005-03-15T03:59:18Z", "creator": "grig@supportwizard.com", "creation_time": "2005-03-15T03:59:18Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 34000, "is_private": false, "count": 4, "id": 72424, "time": "2005-03-15T04:07:32Z", "creator": "grig@supportwizard.com", "creation_time": "2005-03-15T04:07:32Z", "text": "The abstract picture that describes my test (I do not want to write down the\noriginal code because it's too long and won't clarify anything more)\n\n--test.jsp---------\n<script src=\"<html:rewrite page=\"/myattachment.js\" />\"></script>\n<script src=\"<html:rewrite page=\"/myattachment.jsp\" />\"></script>\n-------------------\n\n--myattachment.jsp--\nsome jsp/javascript code\n--------------------\n\n--my attachment.js--\nsome text/javascript code\n--------------------\n\nExpected result : GUIJsGetter should process the first attachment only.\n                The second one should be done by the default servlet\n                (org.apache.struts.action.ActionServlet of Struts 2.3).\n                \nActual result   : GUIJsGetter has to deal with both the GET's despite \n                I set to work only with *.js, not *.js*\n\nPlease let me know if I should explain it more detailed. Thanks."}, {"count": 5, "tags": [], "creator": "grig@supportwizard.com", "attachment_id": null, "id": 72425, "time": "2005-03-15T04:09:09Z", "bug_id": 34000, "creation_time": "2005-03-15T04:09:09Z", "is_private": false, "text": "SUN JDK 1.4.2-03"}, {"count": 6, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "id": 72429, "time": "2005-03-15T08:11:18Z", "bug_id": 34000, "creation_time": "2005-03-15T08:11:18Z", "is_private": false, "text": "Please provide a ready to test war with a *minimal* web.xml. I will not look\ninto it otherwise, as I believe the report to be invalid."}, {"count": 7, "text": "Sorry for involving you. The bug does not exist.", "creator": "grig@supportwizard.com", "attachment_id": null, "id": 72476, "time": "2005-03-16T10:19:59Z", "bug_id": 34000, "creation_time": "2005-03-16T10:19:59Z", "tags": [], "is_private": false}]