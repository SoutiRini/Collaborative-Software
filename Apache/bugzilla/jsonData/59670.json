[{"count": 0, "tags": [], "creator": "cbradford@lintottcs.co.uk", "is_private": false, "id": 191447, "attachment_id": null, "bug_id": 59670, "creation_time": "2016-06-07T14:38:16Z", "time": "2016-06-07T14:38:16Z", "text": "When using the HSSF library when I print the current sheet name it prints the correct one. If I then get the cell value of a known cell in that sheet it will return the value of the cell in the next sheet along.\n\nHow I get the sheet:\nprivate static Sheet getSheet(Workbook wb, String sheetName){\n        Sheet s = null;\n        \n        int numberOfSheets = workbook.getNumberOfSheets();\n        \n        for (int i = 0; i < numberOfSheets; i++) {\n            \n            s = wb.getSheet(sheetName);\n            \n            if( s.getSheetName().equals(sheetName)){\n                return s;\n            }\n       }\n       return s;\n    }\n\nHow I get the cell value:\nprivate static double getCellValue(Cell cell) {\n        switch (cell.getCellType()) {\n            case Cell.CELL_TYPE_NUMERIC:\n                return cell.getNumericCellValue();\n            case Cell.CELL_TYPE_BLANK:\n                return 0;\n        }\n      return 0;\n}\n\ndouble DOLabour = getCellValue(s.getRow(16).getCell(4));"}, {"count": 1, "tags": [], "creator": "kiwiwings@apache.org", "attachment_id": null, "text": "Please add also your example sheet", "id": 191450, "time": "2016-06-07T15:55:23Z", "bug_id": 59670, "creation_time": "2016-06-07T15:55:23Z", "is_private": false}, {"count": 2, "tags": [], "creator": "cbradford@lintottcs.co.uk", "attachment_id": 33925, "text": "Created attachment 33925\nWorkbook", "id": 191462, "time": "2016-06-08T08:02:11Z", "bug_id": 59670, "creation_time": "2016-06-08T08:02:11Z", "is_private": false}, {"count": 3, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "Won't the logic of your sheet selection loop mean that if the name doesn't match, the last sheet will always be returned + used? Could that actually be the cause of your issue?\n\nIf not, any chance you could turn your test code into a junit unit test that we can use with your attached file to investigate more?", "id": 191466, "time": "2016-06-08T12:33:28Z", "bug_id": 59670, "creation_time": "2016-06-08T12:33:28Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 59670, "attachment_id": null, "id": 191469, "time": "2016-06-08T12:42:13Z", "creator": "cbradford@lintottcs.co.uk", "creation_time": "2016-06-08T12:42:13Z", "is_private": false, "text": "I have stepped through the code and if I am looking for the \"PP1\" sheet the function will return the \"PP1\" sheet and it will print this out using s.getSheetName(). When I then get the cell value using:\n\nHow I get the cell value:\nprivate static double getCellValue(Cell cell) {\n        switch (cell.getCellType()) {\n            case Cell.CELL_TYPE_NUMERIC:\n                return cell.getNumericCellValue();\n            case Cell.CELL_TYPE_BLANK:\n                return 0;\n        }\n      return 0;\n}\n\ndouble DOLabour = getCellValue(s.getRow(16).getCell(4))\n\nIt will actually return the value of the \"Application\" sheet not the \"PP1\" sheet.\n\nI have also noticed that when I loop through the sheets the first sheet is called \"Module1\" not \"PP1\"."}, {"count": 5, "tags": [], "creator": "cbradford@lintottcs.co.uk", "is_private": false, "id": 191655, "attachment_id": null, "bug_id": 59670, "creation_time": "2016-06-15T07:13:15Z", "time": "2016-06-15T07:13:15Z", "text": "Have you had any further developments with this bug?"}, {"count": 6, "tags": [], "creator": "kiwiwings@apache.org", "attachment_id": null, "is_private": false, "id": 191656, "time": "2016-06-15T07:40:04Z", "bug_id": 59670, "creation_time": "2016-06-15T07:40:04Z", "text": "(In reply to cbradford from comment #5)\n> Have you had any further developments with this bug?\n\nI had a quick try on this and can only confirm the bug.\nAlthougn the bound name is correct, I suspect that the vba sheet is causing an error with the sheet references ... but maybe someone else with a deeper knowledge of hssf can jump in?"}]