[{"count": 0, "tags": [], "bug_id": 7274, "attachment_id": null, "id": 12060, "time": "2002-03-20T09:58:06Z", "creator": "christian@damsgaard.biz", "creation_time": "2002-03-20T09:58:06Z", "is_private": false, "text": "I'm using Tomcat 4.0.1 final with no problems, but with Tomcat 4.0.2 LE final \non JDK 1.4.0 the following does not work:\n\nI have a PostgreSQL 7.2 database build with theese options:\n\n  ./configure --enable-multibyte=UNICODE --enable-locale\n\nI have create a database named \"bildb\" and a user \"biluser\" which owns this \ndatabase. I'm using PosgreSQL jdbc driver: jdbc7.1-1.2.jar which have been \nplaced in $CATALINA_HOME/common/lib. I have the following entry in my \n$CATALINE_HOME/conf/server.xml under service/engine/host/context:\n\n<Resource name=\"jdbc/bildb\" auth=\"Container\" type=\"javax.sql.DataSource\"/>\n\n<ResourceParams name=\"jdbc/bildb\">\n  <parameter>\n    <name>user</name><value>biluser</value>\n  </parameter>\n  <parameter>\n    <name>password</name><value>abcdef42</value>\n  </parameter>\n  <parameter>\n    <name>driverClassName</name><value>org.postgresql.Driver</value>\n  </parameter>\n  <parameter>\n    <name>driverName</name><value>jdbc:postgresql:bildb</value>\n  </parameter>\n</ResourceParams>\n\nI have testet that I can connect to the database with the above credentials: \npsql -h localhost -p 5432 -U biluser -W bildb\n\nI have the following in my WEB-INF/web.xml file:\n\n<resource-ref>\n  <description>Bildb connection</description>\n  <res-ref-name>jdbc/bildb</res-ref-name>\n  <res-type>javax.sql.DataSource</res-type>\n  <res-auth>Container</res-auth>\n</resource-ref>\n\nI'm using the following test JSP code to access the database:\n\n1: Context initCtx = new javax.naming.InitialContext();\n2: DataSource ds = (javax.sql.DataSource) initCtx.lookup\n                                          (\"java:comp/env/jdbc/bildb\");\n3: Connection conn = ds.getConnection();\n4: conn.close();\n\nWhen returning from the lookup call in line 2, I'm left with a null object, \nwhich of cause make the rest of the lines (3) go haywire. Changing the name of \nthe resource to an invalid value makes the lookup throw an exception that the \nresource is not bound, which of course is what to except.\n\nI can't se any trace in the log files for any error, so I'm quite stuck right \nnow.\n\nPlease let me know if you need any further information.\n\nYours sincerely\nChristian Damsgaard"}, {"count": 1, "tags": [], "bug_id": 7274, "attachment_id": null, "is_private": false, "id": 12086, "time": "2002-03-20T16:04:01Z", "creator": "remm@apache.org", "creation_time": "2002-03-20T16:04:01Z", "text": "Tyrex is now configured so that it would actually pool connections. \nUnfortunately, the configuration changes a bit. I'm not a Tyrex guru \nunfortunately (and for the next major TC version, we'll be using commons-dbcp \ninstead of Tyrex). There were some faqs posted on tomcat-user; searching the \narchives should bring some information.\nAlso, the next TC version will be more verbose about the error which occurs."}]