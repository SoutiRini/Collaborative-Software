[{"count": 0, "tags": [], "bug_id": 53517, "attachment_id": 29037, "id": 160482, "time": "2012-07-07T11:21:17Z", "creator": "info@rublack.org", "creation_time": "2012-07-07T11:21:17Z", "is_private": false, "text": "Created attachment 29037\nformatted Template\n\nIf using a formatted sheet as template and e.g setting row.height at Row 510\nraise nullpointer exception when iterate over rows using LastRowNr.\n\nCode:\nfor (int i=0; i <= workbook.getSheet(\"template\").getLastRowNum(); i++)\n{\nRow actRow = workbook.getSheet(\"template\").getRow(i);\n}\n\nbecause it looks like a empty sheet hast normally only 500 rows and formatting \na row after 500 at this row to the row list. \nNow the row treeMap has 501 entries, with keys 0 to 499 and the additional key 510 \nfrom the formatted row as entry 501 .\nCalling workbook.getSheetAt(0).getLastRowNum() get the key 510 and iterate like above raise Nullpointer in workbook.getSheetAt(0).getRow(i) because keys 500 to 509 are not in the treeMap.\n\nI put the template file as attachment"}, {"count": 1, "tags": [], "bug_id": 53517, "text": "The Excel file format is a sparse format. If rows aren't used, and have never been used, then they'll never be present in the file\n\nIf you only want defined rows, then use the RowIterator on a sheet. If you you iterate between the FirstRowNum and LastRowNum, then you need to check that the row isn't null before using it. See the website for more info on all of this", "id": 160483, "time": "2012-07-07T11:37:00Z", "creator": "apache@gagravarr.org", "creation_time": "2012-07-07T11:37:00Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 53517, "text": "Hi Nick,\nthx for your hint", "id": 160486, "time": "2012-07-07T13:26:56Z", "creator": "info@rublack.org", "creation_time": "2012-07-07T13:26:56Z", "is_private": false, "attachment_id": null}]