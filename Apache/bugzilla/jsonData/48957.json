[{"count": 0, "tags": [], "bug_id": 48957, "attachment_id": null, "text": "apache httpd crash in mod_deflate when static file changed frequently. \n\nSteps to Reproduce: \n1. enable mod_deflate in httpd.conf \nSetOutputFilter DEFLATE \n\n2.  in anthor shell, change the index.html frenquently with mv command. eg: \n\nc=1\nwhile [ $c -le 1 ]  \ndo\ncp -r big/index.html tmp/\nmv tmp/* ../htdocs/\ncp -r small/index.html  tmp/\nmv tmp/* ../htdocs/\ndone\n\nthe small/index.html size is 67086 bytes, and the  big/index.html size is 45139 bytes\n\n3.  Stress test with apache ab\n./ab -n 1000000 -c 10  -H 'Accept-Encoding: gzip'  http://localhost:8080/\n\nActual Results: \n\nApache httpd v2.2.13 crashed, core dump stack: \n\nCore was generated by `/home/work/duchuanying/apache2/bin/httpd -d /home/work/duchuanying/apache2 -k'.\nProgram terminated with signal 7, Bus error.\n\n(gdb) bt\n#0  0x000000302b6022d6 in crc32 () from /usr/lib64/libz.so.1\n#1  0x0000002a959f012b in deflate_out_filter (f=0x6faf38, bb=0x6fb430) at mod_deflate.c:681\n#2  0x0000000000432ecd in default_handler (r=0x6f6648) at core.c:3757\n#3  0x0000000000438963 in ap_run_handler (r=0x6f6648) at config.c:157\n#4  0x0000000000438e01 in ap_invoke_handler (r=0x6f6648) at config.c:372\n#5  0x0000000000474390 in ap_process_request (r=0x6f6648) at http_request.c:282\n#6  0x0000000000471add in ap_process_http_connection (c=0x6ea7d8) at http_core.c:190\n#7  0x000000000043f423 in ap_run_process_connection (c=0x6ea7d8) at connection.c:43\n#8  0x00000000004a0de0 in child_main (child_num_arg=Variable \"child_num_arg\" is not available.\n) at prefork.c:662\n#9  0x00000000004a1034 in make_child (s=0x601e60, slot=3) at prefork.c:758\n#10 0x00000000004a10ce in startup_children (number_to_start=2) at prefork.c:776\n#11 0x00000000004a18dd in ap_mpm_run (_pconf=Variable \"_pconf\" is not available.\n) at prefork.c:997\n#12 0x0000000000426345 in main (argc=Variable \"argc\" is not available.\n) at main.c:740\n(gdb) bt full\n#0  0x000000302b6022d6 in crc32 () from /usr/lib64/libz.so.1\nNo symbol table info available.\n#1  0x0000002a959f012b in deflate_out_filter (f=0x6faf38, bb=0x6fb430) at mod_deflate.c:681\n        data = 0x2a95d6f000 <Address 0x2a95d6f000 out of bounds>\n        b = Variable \"b\" is not available.\n\n\nThis bug is related to apr/linux mmap , mod_deflate, file changes.", "id": 135527, "time": "2010-03-22T13:17:48Z", "creator": "hustdcy@gmail.com", "creation_time": "2010-03-22T13:17:48Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 48957, "text": "\"Deleting or truncating a file while httpd  has it memory-mapped can cause httpd to crash with a segmentation fault. \"\n\nat\n\nhttp://httpd.apache.org/docs/2.2/mod/core.html#enablemmap", "id": 135528, "time": "2010-03-22T13:23:07Z", "creator": "trawick@apache.org", "creation_time": "2010-03-22T13:23:07Z", "is_private": false, "attachment_id": null}]