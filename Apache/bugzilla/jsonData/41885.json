[{"count": 0, "text": "Dear all,\n\n    Hi.  This is imacat from Taiwan.  In the Apache 2.2 documentation:\n\nhttp://httpd.apache.org/docs/2.2/content-negotiation.html#type-map\n\n    \"A type map is a document which is associated with the handler named\ntype-map (or, for backwards-compatibility with older Apache configurations, the\nMIME-type application/x-type-map).\"\n\n    I tried and get really confused with this for several days of working. \nAfter digging into mod_negotiation.c it turned out that the MIME-type\n\"application/x-type-map\" is still in use.  It is NOT only for\nbackwards-compatibility, as static.  If you create a type map page.html.var for\nthe URL page.html and expect it to work, as the example on the documentation\nsays, you have to:\n\n    1. Turn on MultiViews.\n    2. Add this line: \"AddType application/x-type-map .var\".\n\n    This is contrary to what the documentation says.  As a result, the example\nwon't work if you follow the documentation.\n\n    I think this should be corrected.", "bug_id": 41885, "attachment_id": null, "id": 100563, "time": "2007-03-19T00:02:40Z", "creator": "imacat@mail.imacat.idv.tw", "creation_time": "2007-03-19T00:02:40Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "slive@apache.org", "text": "AddHandler type-map\ncertainly does work.  We use it on apache.org.\n\nThere must be something else going on in your config.", "id": 100613, "time": "2007-03-19T11:40:43Z", "bug_id": 41885, "creation_time": "2007-03-19T11:40:43Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "imacat@mail.imacat.idv.tw", "attachment_id": null, "id": 100620, "time": "2007-03-19T12:32:33Z", "bug_id": 41885, "creation_time": "2007-03-19T12:32:33Z", "is_private": false, "text": "    Well, I believe you did not read my report carefully.  It does not work IN\nCERTAIN CONDITION.  To be specific, in the example stated in the documentation.\n I have created a simple test case and attached a console log so that you can\nexaming it.  It is excactly the example in the documentation, not a single word\nchanged.\n\n    Please tell me if you need any more information.  And, PLEASE, do not close\na bug so quickly.\n\n=====================\nimacat@rine ~ % ls /tmp/apache/htdocs\nfoo.en.html  foo.fr.de.html  foo.var\nimacat@rine ~ % cat /tmp/apache/htdocs/foo.var\nURI: foo\n\nURI: foo.en.html\nContent-type: text/html\nContent-language: en\n\nURI: foo.fr.de.html\nContent-type: text/html;charset=iso-8859-2\nContent-language: fr, de\nimacat@rine ~ % cat /tmp/apache/htdocs/foo.en.html\nThis is foo.en.html.\nimacat@rine ~ % cat /tmp/apache/htdocs/foo.fr.de.html\nThis is foo.fr.de.html.\nimacat@rine ~ % cat /tmp/apache/request\nGET /foo HTTP/1.1\nHost: localhost\nAccept-Language: de,en;q=0.5\nConnection: close\n\nimacat@rine ~ % cat /tmp/apache/httpd-00.conf\nUser nobody\nGroup nogroup\nServerName localhost\nServerAdmin webmaster@localhost\nServerRoot /tmp/apache\nDocumentRoot /tmp/apache/htdocs\nPidFile /tmp/apache/httpd.pid\nLoadModule mime_module /usr/lib/apache2/mod_mime.so\nLoadModule negotiation_module /usr/lib/apache2/mod_negotiation.so\nListen 50080\nErrorLog /tmp/apache/error_log\n\nAddHandler type-map .var\nimacat@rine ~ % /usr/sbin/httpd -f /tmp/apache/httpd-00.conf\nimacat@rine ~ % nc localhost 50080 < /tmp/apache/request\nHTTP/1.1 404 Not Found\nDate: Mon, 19 Mar 2007 19:22:31 GMT\nServer: Apache/2.2.4 (Unix)\nContent-Length: 201\nConnection: close\nContent-Type: text/html; charset=iso-8859-1\n\n<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\n<html><head>\n<title>404 Not Found</title>\n</head><body>\n<h1>Not Found</h1>\n<p>The requested URL /foo was not found on this server.</p>\n</body></html>\nimacat@rine ~ % kill $(</tmp/apache/httpd.pid)\nimacat@rine ~ % cat /tmp/apache/httpd-m0.conf\nUser nobody\nGroup nogroup\nServerName localhost\nServerAdmin webmaster@localhost\nServerRoot /tmp/apache\nDocumentRoot /tmp/apache/htdocs\nPidFile /tmp/apache/httpd.pid\nLoadModule mime_module /usr/lib/apache2/mod_mime.so\nLoadModule negotiation_module /usr/lib/apache2/mod_negotiation.so\nListen 50080\nErrorLog /tmp/apache/error_log\n\nAddHandler type-map .var\nOptions +MultiViews\nimacat@rine ~ % /usr/sbin/httpd -f /tmp/apache/httpd-m0.conf\nimacat@rine ~ % nc localhost 50080 < /tmp/apache/request\nHTTP/1.1 404 Not Found\nDate: Mon, 19 Mar 2007 19:22:35 GMT\nServer: Apache/2.2.4 (Unix)\nContent-Length: 201\nConnection: close\nContent-Type: text/html; charset=iso-8859-1\n\n<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\n<html><head>\n<title>404 Not Found</title>\n</head><body>\n<h1>Not Found</h1>\n<p>The requested URL /foo was not found on this server.</p>\n</body></html>\nimacat@rine ~ % kill $(</tmp/apache/httpd.pid)\nimacat@rine ~ % cat /tmp/apache/httpd-0t.conf\nUser nobody\nGroup nogroup\nServerName localhost\nServerAdmin webmaster@localhost\nServerRoot /tmp/apache\nDocumentRoot /tmp/apache/htdocs\nPidFile /tmp/apache/httpd.pid\nLoadModule mime_module /usr/lib/apache2/mod_mime.so\nLoadModule negotiation_module /usr/lib/apache2/mod_negotiation.so\nListen 50080\nErrorLog /tmp/apache/error_log\n\nAddHandler type-map .var\nAddType application/x-type-map .var\nimacat@rine ~ % /usr/sbin/httpd -f /tmp/apache/httpd-0t.conf\nimacat@rine ~ % nc localhost 50080 < /tmp/apache/request\nHTTP/1.1 404 Not Found\nDate: Mon, 19 Mar 2007 19:22:39 GMT\nServer: Apache/2.2.4 (Unix)\nContent-Length: 201\nConnection: close\nContent-Type: text/html; charset=iso-8859-1\n\n<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\n<html><head>\n<title>404 Not Found</title>\n</head><body>\n<h1>Not Found</h1>\n<p>The requested URL /foo was not found on this server.</p>\n</body></html>\nimacat@rine ~ % kill $(</tmp/apache/httpd.pid)\nimacat@rine ~ % cat /tmp/apache/httpd-mt.conf\nUser nobody\nGroup nogroup\nServerName localhost\nServerAdmin webmaster@localhost\nServerRoot /tmp/apache\nDocumentRoot /tmp/apache/htdocs\nPidFile /tmp/apache/httpd.pid\nLoadModule mime_module /usr/lib/apache2/mod_mime.so\nLoadModule negotiation_module /usr/lib/apache2/mod_negotiation.so\nListen 50080\nErrorLog /tmp/apache/error_log\n\nAddHandler type-map .var\nAddType application/x-type-map .var\nOptions +MultiViews\nimacat@rine ~ % /usr/sbin/httpd -f /tmp/apache/httpd-mt.conf\nimacat@rine ~ % nc localhost 50080 < /tmp/apache/request\nHTTP/1.1 200 OK\nDate: Mon, 19 Mar 2007 19:22:43 GMT\nServer: Apache/2.2.4 (Unix)\nContent-Location: foo.fr.de.html\nVary: negotiate,accept-language,accept-charset\nTCN: choice\nLast-Modified: Mon, 19 Mar 2007 19:06:24 GMT\nETag: \"2a9687-18-42c0c49122c00;2a9630-a1-42c0c47486880\"\nAccept-Ranges: bytes\nContent-Length: 24\nConnection: close\nContent-Type: text/html\n\nThis is foo.fr.de.html.\nimacat@rine ~ % kill $(</tmp/apache/httpd.pid)\nimacat@rinse ~ %\n"}, {"count": 3, "tags": [], "creator": "imacat@mail.imacat.idv.tw", "attachment_id": 19743, "id": 100621, "time": "2007-03-19T12:35:07Z", "bug_id": 41885, "creation_time": "2007-03-19T12:35:07Z", "is_private": false, "text": "Created attachment 19743\nThe Test Case That I Used, All the 4 Configuration Files and the Script\n\nPlease examine the test case I attached."}, {"count": 4, "text": "Type-maps do indeed work as documented. You are *not* supposed to be combining\ntype-maps with MultiViews -- they are alternatives (they docs say \"This is done\nin one of two ways\", not \"use both of these\").  \n\nIf you have\nAddHandler type-map .var\nthen you need to request the file including the .var extension.  Check\nconf/extra/httpd-manual.conf to see how it is done (where .html is designated as\nbeing a type-map).\n\nWhen you try to combine MultiViews and type-maps, things get really confusing. I\nwouldn't recommend it at all, and the fact that you got it to work using a\nbackward-compat feature is probably accidental.\n\nBut it seems there is some code trying to handle that case, so I'll leave this\nbug report open in case anyone is interested in trying to make it work more\npredictably.", "bug_id": 41885, "is_private": false, "id": 100644, "time": "2007-03-19T19:44:25Z", "creator": "slive@apache.org", "creation_time": "2007-03-19T19:44:25Z", "tags": [], "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 41885, "attachment_id": null, "text": "(In reply to comment #4)\n> Type-maps do indeed work as documented. You are *not* supposed to be combining\n> type-maps with MultiViews -- they are alternatives (they docs say \"This is done\n> in one of two ways\", not \"use both of these\").\n\n    Yes, I'm not supposed to do so.  I don't know that I have to do so in order\nto get the documented example working after several days of trying.\n\n    Please understand that I classify this as a \"bug in the documentation\". \nSince I have looked into the code, I do understand its logic.\n\n    The last sentence in the second paragraph under the heading \"Using a\ntype-map file\" says:\n\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=41885#add_comment\n\n    \"This file would be named foo.var, as it describes a resource named foo.\"\n\n    In an earlier paragraph \"About Content Negotiation\", the first sentence of\nthe last paragraph:\n\nhttp://httpd.apache.org/docs/2.2/content-negotiation.html#about\n\n    \"A resource is a conceptual entity identified by a URI (RFC 2396).\"\n\n    As for \"a resource named foo\", what's wrong if I request for foo?  Am I\nsupposed to request \"foo.var\" for \"a resource named foo\"?\n\n    Also, the second paragraph under \"Using a type-map file\":\n\n    \"It is conventional to begin a map file with an entry for the combined\nentity as a whole (although this is not required, and if present will be ignored).\"\n\n    I suppose this means the first line \"URI: foo\" in the example.  So I request\nthe \"combined entity\", the \"foo\".  What's wrong with this anyway?  If there is\nno such combined entity \"foo\", why does it say so?  If foo.var is describing a\nresource named foo.var, shouldn't it be documented this way?\n\n> If you have\n> AddHandler type-map .var\n> then you need to request the file including the .var extension.  Check\n> conf/extra/httpd-manual.conf to see how it is done (where .html is designated as\n> being a type-map).\n\n    Actually, it is the first thing I checked, even before I read the\ndocumentation, in order to get our local documentation copy working.\n\n> But it seems there is some code trying to handle that case, so I'll leave this\n> bug report open in case anyone is interested in trying to make it work more\n> predictably.\n\n    Please fix this in the documentation.  I would not like to see another one\nwasting so much time on this.", "id": 100645, "time": "2007-03-19T20:53:09Z", "creator": "imacat@mail.imacat.idv.tw", "creation_time": "2007-03-19T20:53:09Z", "is_private": false}, {"count": 6, "tags": [], "creator": "rbowen@apache.org", "text": "Moving docs bugs to docs@httpd.a.o ownership.", "id": 141225, "time": "2010-10-29T11:07:31Z", "bug_id": 41885, "creation_time": "2010-10-29T11:07:31Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "creator": "poirier@pobox.com", "text": "This is three years old.  I think it's just been sitting because it makes no sense.  Sorry. \n\n(Bug says it doesn't work to use MultiView with type maps.  Doc says to use one or the other, so no conflict there.  Bug says the example doesn't work.  The doc doesn't have an example.)\n\nSo, closing this.  Original poster is welcome to re-open if they think they can explain what the problem is.", "id": 141437, "time": "2010-11-04T18:26:48Z", "bug_id": 41885, "creation_time": "2010-11-04T18:26:48Z", "is_private": false, "attachment_id": null}]