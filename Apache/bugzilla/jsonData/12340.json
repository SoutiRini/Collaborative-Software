[{"count": 0, "tags": [], "creator": "tjcw@us.ibm.com", "text": "I'm using Apache as a cacheing proxy on a WindowsXP system (the upstream\nlink is Starband satellite, the downstream link is a wireless LAN around my\nhouse). Apache2 breaks with messages below in the log; the web browsers get\nsome rather disjointed sessions. Apache1 works fine. I get notices about Apache\nwanting to notify\nMicrosoft about the problem, which I duly allow it to do.\nI'm not sure whether the problem is related to Apache on WindowsXP, or\n'mod_proxy' etc.\nI am running without any upstream proxies. Starband have a\nstrange scheme involving running half the TCP stack on my computer and the\nother half back that their satellite base station, but it works most of the\ntime.\n[Tue Aug 27 08:33:11 2002] [notice] Parent: child process exited with\nstatus 3221225477 -- Restarting.\n[Tue Aug 27 08:33:11 2002] [notice] Parent: Created child process 4684\n[Tue Aug 27 08:33:11 2002] [notice] Child 4684: Child process is running\n[Tue Aug 27 08:33:11 2002] [notice] Child 4684: Acquired the start mutex.\n[Tue Aug 27 08:33:11 2002] [notice] Child 4684: Starting 250 worker\nthreads.\n[Tue Aug 27 08:33:15 2002] [notice] Parent: child process exited with\nstatus 3221225477 -- Restarting.\n[Tue Aug 27 08:33:15 2002] [notice] Parent: Created child process 3768\n[Tue Aug 27 08:33:15 2002] [notice] Child 3768: Child process is running\n[Tue Aug 27 08:33:15 2002] [notice] Child 3768: Acquired the start mutex.\n[Tue Aug 27 08:33:15 2002] [notice] Child 3768: Starting 250 worker\nthreads.\n[Tue Aug 27 08:33:19 2002] [notice] Parent: child process exited with\nstatus 3221225477 -- Restarting.\n[Tue Aug 27 08:33:19 2002] [notice] Parent: Created child process 5728", "id": 22328, "time": "2002-09-05T17:12:31Z", "bug_id": 12340, "creation_time": "2002-09-05T17:12:31Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 12340, "attachment_id": null, "text": "\nProxy crash in mod_proxy.c, function proxy_map_location():\n   +--- mod_proxy.c --------------------------------------------\n   |static int proxy_map_location(request_rec *r)\n   |{\n   |    int access_status;\n   |\n ->|    if (!r->proxyreq || strncmp(r->filename, \"proxy:\", 6) != 0)\n   |        return DECLINED;\n   +------------------------------------------------------------\nr->filename points to NULL, cause strncmp access to\nviolation exception (0xC0000005).\n\nBug also in apache 2.0.39 in same place.\n", "id": 22432, "time": "2002-09-07T22:24:11Z", "creator": "berrywizard@mechanicalfrog.com", "creation_time": "2002-09-07T22:24:11Z", "is_private": false}, {"count": 2, "tags": [], "creator": "ianh@apache.org", "text": "Can you please attach your httpd.config file,\nand the actual URL requested which gives the crash ?\n\nif this is a forward proxy, the r->filename should already by mapped to\nproxy:http://foobar/uri by the time it gets into this function (or else it would\nbe breaking for >every< request anyone does, so there is something funky about\nyour config I'm thinking", "id": 22470, "time": "2002-09-08T18:19:06Z", "bug_id": 12340, "creation_time": "2002-09-08T18:19:06Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 12340, "attachment_id": null, "is_private": false, "id": 22471, "time": "2002-09-08T20:14:46Z", "creator": "berrywizard@mechanicalfrog.com", "creation_time": "2002-09-08T20:14:46Z", "text": "Here proposed patch for fixing this bug (maked by \"diff mod_proxy.c\nfixed/mod_proxy.c\" command):\n\n255,256c255,256\n<     if (!r->proxyreq || strncmp(r->filename, \"proxy:\", 6) != 0)\n<         return DECLINED;\n---\n>     if (!r->proxyreq) return DECLINED;\n>     if (strncmp(r->filename, \"proxy:\", 6) != 0) return DECLINED;\n\n\n\nIt seems that in \"if\" operator (in compiled code) both condition are checked\neven though first already truly."}, {"attachment_id": null, "tags": [], "bug_id": 12340, "is_private": false, "count": 4, "id": 22511, "time": "2002-09-09T13:04:57Z", "creator": "tjcw@us.ibm.com", "creation_time": "2002-09-09T13:04:57Z", "text": "Thanks for high-speed fix. I take it that you don't need my config file any\nmore; if you want it, let me know.\nExecuting code to evaluate 'b' in (a || b) when it is not logically needed\nsounds like a compiler bug. Whose compiler do you build Apache for Windows with\n? Would they be interested in a bug report ?\n\nThe oddity in my configuration is that I run an Apache proxy on Windows. "}, {"count": 5, "tags": [], "creator": "tjcw@us.ibm.com", "is_private": false, "text": "I am running 2.0.42 now, and the problem is fixed. Thanks !", "id": 24217, "time": "2002-10-09T17:40:11Z", "bug_id": 12340, "creation_time": "2002-10-09T17:40:11Z", "attachment_id": null}, {"count": 6, "attachment_id": null, "bug_id": 12340, "is_private": false, "id": 45262, "time": "2003-10-08T21:51:32Z", "creator": "tjcw@us.ibm.com", "creation_time": "2003-10-08T21:51:32Z", "tags": [], "text": "This is giving me the same breakage again in 2.0.47; has the broken code crept\nback in ?"}, {"count": 7, "tags": [], "creator": "tjcw@us.ibm.com", "text": "*** Bug 18963 has been marked as a duplicate of this bug. ***", "id": 45264, "time": "2003-10-08T21:55:53Z", "bug_id": 12340, "creation_time": "2003-10-08T21:55:53Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "creator": "dramalho@blackorange.pt", "text": "  I'm running Win2K Advanced Server, Apache 2.0.47 with PHP 4.3.3 and NO \nmod_proxy loaded, and I'm reporting the same problems. Some of the times the \nservice actually stops (it's automaticaly restarted by Win 60 s latter), the \nrest of the times Apache seems to handle it on his own . I have a low thread \ncount (15) because of persistent connections do the database and the server is \npretty much exclusive. \n  Before I had 2.0.39 and all was fine, I tried downgrading to 2.0.46 and the \nproblem persisted. Didn't really wanted to downgrade much further, so I'll wait \nfor the outcome of this 'bug' :).\n\n  Further log details in : \n  http://nagoya.apache.org/bugzilla/show_bug.cgi?id=23300", "id": 45419, "time": "2003-10-11T12:27:24Z", "bug_id": 12340, "creation_time": "2003-10-11T12:27:24Z", "is_private": false, "attachment_id": null}, {"count": 9, "attachment_id": null, "bug_id": 12340, "is_private": false, "id": 45479, "time": "2003-10-13T09:00:22Z", "creator": "tjcw@us.ibm.com", "creation_time": "2003-10-13T09:00:22Z", "tags": [], "text": "I'm using 'squid' as cacheing proxy now (under WindowsXP Home). Works fine, and\nthe license terms are just as good.\nApache good web server, squid good proxycache, XMail good mailrouterthing ..."}, {"count": 10, "tags": [], "creator": "ck@atlantix-net.de", "is_private": false, "text": "I'm experiencing the same problem with Apache 2.0.54 with PHP 5.0.4 on WinXP \nSP1, mod_proxy is not loaded.\nThe error occurs sporadically, sometimes with the page partly sent to the \nclient. After Apache has automatically restarted, reloading the page does not \nreproduce the error.", "id": 76400, "time": "2005-06-14T15:16:50Z", "bug_id": 12340, "creation_time": "2005-06-14T15:16:50Z", "attachment_id": null}, {"count": 11, "attachment_id": null, "bug_id": 12340, "is_private": false, "id": 77078, "time": "2005-07-07T17:34:22Z", "creator": "nico.haase@gmx.de", "creation_time": "2005-07-07T17:34:22Z", "tags": [], "text": "I also receive this error on using phpmyadmin. Here is one of the URLs causing\nthe error:\n\nhttp://localhost/phpmy/sql.php?lang=de-utf-8&server=1&collation_connection=utf8_general_ci&db=phpbb&table=phpbb_auth_access&sql_query=SELECT+%2A+FROM+%60phpbb_auth_access%60&pos=0&goto=tbl_properties_structure.php"}, {"count": 12, "tags": [], "creator": "cp_coder_2006@yahoo.com", "is_private": false, "text": "(In reply to comment #0)\nI'm using XAMPP 1.5.1 on Windows XP Home with SP1 and SP2.\nNo other server running.\n\nI have the error, too. I'm not using Perl when it's running.I did not compile, I\nused the .zip version, unzipped in top-level directory.I've read all the bug\nreports here, and it seems this bug dissappeared, then reappeared again.\n\nI have the following in my httpd-mpm.conf\n\n<IfModule mpm_winnt_module>\n    ThreadsPerChild     250\n    MaxRequestsPerChild   0\n    Win32DisableAcceptEx\n</IfModule>\n\nand httpd.conf has the appropriate line uncommented to Apache will read\nhttpd-mpm.conf.\n\nThat was the suggested fix for problem when CPU usage maxes out on XP Home.\nProposed fix does not work. When I attempt to view an HTML page that processes a\nPHP script (whether hard-coded in the HTML or called via SSI virtual), very\noften the CPU usage goes to 100%, Windows gives me an error \"Apache has\nencountered a problem and needs to close\", and the page never loads.\n\nThere is no port conflict, but I tried changing to port 8080 just to see if that\nhelped, and it doesn't. My firewall is not blocking anything, the first time I\nstarted Apache I chose to allow Apache to run as a server and to have the\nfirewall remember this answer.\n\nAppropriate section of log file:\n\n[Wed Feb 22 16:36:47 2006] [notice] Apache/2.2.0 (Win32) DAV/2 mod_ssl/2.2.0\nOpenSSL/0.9.8a mod_autoindex_color PHP/5.1.1 configured -- resuming normal\noperations\n[Wed Feb 22 16:36:47 2006] [notice] Server built: Dec  1 2005 18:36:53\n[Wed Feb 22 16:36:47 2006] [notice] Parent: Created child process 3416\n[Wed Feb 22 16:37:21 2006] [notice] Child 3416: Child process is running\n[Wed Feb 22 16:37:22 2006] [notice] Child 3416: Acquired the start mutex.\n[Wed Feb 22 16:37:22 2006] [notice] Child 3416: Starting 250 worker threads.\n[Wed Feb 22 16:37:22 2006] [notice] Child 3416: Starting thread to listen on\nport 8080.\n[Wed Feb 22 16:37:22 2006] [notice] Child 3416: Starting thread to listen on\nport 443.\n[Wed Feb 22 16:42:43 2006] [notice] Parent: child process exited with status\n3221225477 -- Restarting.\n[Wed Feb 22 16:42:55 2006] [crit] (22)Invalid argument: unable to replace stderr\nwith error_log\n[Wed Feb 22 16:42:55 2006] [crit] (2)No such file or directory: unable to\nreplace stderr with /dev/null\n[Wed Feb 22 16:42:59 2006] [notice] Apache/2.2.0 (Win32) DAV/2 mod_ssl/2.2.0\nOpenSSL/0.9.8a mod_autoindex_color PHP/5.1.1 configured -- resuming normal\noperations(In reply to comment #0)\n> I'm using Apache as a cacheing proxy on a WindowsXP system (the upstream\n> link is Starband satellite, the downstream link is a wireless LAN around my\n> house). Apache2 breaks with messages below in the log; the web browsers get\n> some rather disjointed sessions. Apache1 works fine. I get notices about Apache\n> wanting to notify\n> Microsoft about the problem, which I duly allow it to do.\n> I'm not sure whether the problem is related to Apache on WindowsXP, or\n> 'mod_proxy' etc.\n> I am running without any upstream proxies. Starband have a\n> strange scheme involving running half the TCP stack on my computer and the\n> other half back that their satellite base station, but it works most of the\n> time.\n> [Tue Aug 27 08:33:11 2002] [notice] Parent: child process exited with\n> status 3221225477 -- Restarting.\n> [Tue Aug 27 08:33:11 2002] [notice] Parent: Created child process 4684\n> [Tue Aug 27 08:33:11 2002] [notice] Child 4684: Child process is running\n> [Tue Aug 27 08:33:11 2002] [notice] Child 4684: Acquired the start mutex.\n> [Tue Aug 27 08:33:11 2002] [notice] Child 4684: Starting 250 worker\n> threads.\n> [Tue Aug 27 08:33:15 2002] [notice] Parent: child process exited with\n> status 3221225477 -- Restarting.\n> [Tue Aug 27 08:33:15 2002] [notice] Parent: Created child process 3768\n> [Tue Aug 27 08:33:15 2002] [notice] Child 3768: Child process is running\n> [Tue Aug 27 08:33:15 2002] [notice] Child 3768: Acquired the start mutex.\n> [Tue Aug 27 08:33:15 2002] [notice] Child 3768: Starting 250 worker\n> threads.\n> [Tue Aug 27 08:33:19 2002] [notice] Parent: child process exited with\n> status 3221225477 -- Restarting.\n> [Tue Aug 27 08:33:19 2002] [notice] Parent: Created child process 5728\n\n", "id": 86122, "time": "2006-02-23T07:47:53Z", "bug_id": 12340, "creation_time": "2006-02-23T07:47:53Z", "attachment_id": null}, {"count": 13, "attachment_id": null, "bug_id": 12340, "text": "This seems anything but a httpd bug. could you try to reproduce the issue and get a backtrace? Thanks.\nInstructions at http://httpd.apache.org/dev/debugging.html#backtrace-win", "id": 104214, "time": "2007-06-08T09:48:48Z", "creator": "davi@apache.org", "creation_time": "2007-06-08T09:48:48Z", "tags": [], "is_private": false}, {"count": 14, "attachment_id": null, "bug_id": 12340, "is_private": false, "id": 109086, "time": "2007-10-07T16:59:22Z", "creator": "nick@webthing.com", "creation_time": "2007-10-07T16:59:22Z", "tags": [], "text": "No response to davi's request for detail.  And if there is a bug, it's clearly\nNOT the one originally reported, which is long-since fixed."}]