[{"count": 0, "tags": [], "bug_id": 20447, "attachment_id": null, "text": "Error message from httpd when upgraded from 2.0.43 to 2.0.46.  (ld.so.1 failed \nto start can't find libgcc_s.so.1) File exists, works with previous version, \nand is  in same location.", "id": 38258, "time": "2003-06-03T14:02:35Z", "creator": "wgreen@gastro.org", "creation_time": "2003-06-03T14:02:35Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 20447, "attachment_id": null, "id": 38260, "time": "2003-06-03T14:34:23Z", "creator": "trawick@apache.org", "creation_time": "2003-06-03T14:34:23Z", "is_private": false, "text": "did you try setting the LD_LIBRARY_PATH environment variable to point to the\ndirectory that contains libgcc_s.so.1?"}, {"count": 2, "attachment_id": null, "creator": "wgreen@gastro.org", "text": "Why would the LD_LIBRARY_PATH environment variable change just because of an \nupgrade? And if it did change how do I fix.", "id": 38266, "time": "2003-06-03T14:49:46Z", "bug_id": 20447, "creation_time": "2003-06-03T14:49:46Z", "tags": [], "is_private": false}, {"count": 3, "attachment_id": null, "bug_id": 20447, "text": "I didn't mean to suggest that it would change by upgrading.  I just would like\nto verify that using it will allow Apache to start.\n\nAnother thing to check:  please send output of ldd done on your old httpd and on\nyour new httpd\n\n$ ldd /path/to/old/httpd\n(output here)\n$ ldd /path/to/new/httpd\n(output here)\n\nAnother question:\n\nDid you unpack the tarball and do ./configure, or did you run ./buildconf first?\n This tarball was built with a newer version of libtool.\n\nIs this the same gcc that 2.0.43 was built with, and you didn't have to add\nanything to bin/envvars for the 2.0.43 build to work?\n\n\n", "id": 38291, "time": "2003-06-03T20:10:50Z", "creator": "trawick@apache.org", "creation_time": "2003-06-03T20:10:50Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 20447, "attachment_id": null, "text": "Thank you for your help.\n\nI ran the ($ ldd /path/to/old/httpd and ../new/httpd), it stated that \n(libaprutil-0.so.0 and libapr-0.so.0) - were not found. Do I need these to \ncompile apache?\n\nI unpacked the taraball file with the last version 2.0.43 using ./config \nnot ./buildconf.\n\nDo I have to upgrade the libtool each time I update apache?", "id": 38379, "time": "2003-06-04T20:01:23Z", "creator": "wgreen@gastro.org", "creation_time": "2003-06-04T20:01:23Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 20447, "attachment_id": null, "text": "I'm puzzled about why libapr-0.so and libaprutil-0.so weren't found by \"ldd\nhttpd\", but the point of asking for the output of both ldd commands was to see\nwhether or not libgcc_s.so.1 was a dependency of 2.0.43.  Can you post the\nresults of the two ldd commands?\n\n>Do I have to upgrade the libtool each time I update apache?\n\nYou're not supposed to have to do anything with libtool.  \n\nBy knowing that you didn't run ./buildconf, we now know that you were using\nlibtool 1.5 (the one bundled in httpd-2.0.46.tar.gz).\n", "id": 38380, "time": "2003-06-04T20:16:08Z", "creator": "trawick@apache.org", "creation_time": "2003-06-04T20:16:08Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 20447, "attachment_id": null, "id": 38381, "time": "2003-06-04T20:24:16Z", "creator": "wgreen@gastro.org", "creation_time": "2003-06-04T20:24:16Z", "is_private": false, "text": "ldd /local01/apache2/bin/httpd\n       libssl.so.0.9.6 =>       /usr/local/ssl/lib/libs\n       libcrypto.so.0.9.6 =>    /usr/local/ssl/lib/libc\n       libexpat.so.0 =>         /usr/lib/libexpat.so.0\n       libiconv.so.2 =>         /usr/lib/libiconv.so.2\n       librt.so.1 =>    /usr/lib/librt.so.1\n       libm.so.1 =>     /usr/lib/libm.so.1\n       libsocket.so.1 =>        /usr/lib/libsocket.so.1\n       libnsl.so.1 =>   /usr/lib/libnsl.so.1\n       libresolv.so.2 =>        /usr/lib/libresolv.so.2\n       libdl.so.1 =>    /usr/lib/libdl.so.1\n       libpthread.so.1 =>       /usr/lib/libpthread.so.\n       libc.so.1 =>     /usr/lib/libc.so.1\n       libaio.so.1 =>   /usr/lib/libaio.so.1\n       libmp.so.2 =>    /usr/lib/libmp.so.2\n       libthread.so.1 =>        /usr/lib/libthread.so.1\n       /usr/platform/SUNW,Ultra-250/lib/libc_psr.so.1\n ldd /local01/apache2b/bin/httpd\n       libaprutil-0.so.0 =>     (file not found)\n       libexpat.so.0 =>         /usr/local/lib/libexpat\n       libiconv.so.2 =>         /usr/local/lib/libiconv\n       libapr-0.so.0 =>         (file not found)\n       librt.so.1 =>    /usr/lib/librt.so.1\n       libm.so.1 =>     /usr/lib/libm.so.1\n       libsocket.so.1 =>        /usr/lib/libsocket.so.1\n       libnsl.so.1 =>   /usr/lib/libnsl.so.1\n       libresolv.so.2 =>        /usr/lib/libresolv.so.2\n       libdl.so.1 =>    /usr/lib/libdl.so.1\n       libpthread.so.1 =>       /usr/lib/libpthread.so.\n       libc.so.1 =>     /usr/lib/libc.so.1\n       libaio.so.1 =>   /usr/lib/libaio.so.1\n       libmp.so.2 =>    /usr/lib/libmp.so.2\n       libthread.so.1 =>        /usr/lib/libthread.so.1\n       /usr/platform/SUNW,Ultra-250/lib/libc_psr.so.1"}, {"count": 7, "tags": [], "text": "I guess that /local01/apache2/bin/httpd is 2.0.46 and\n/local01/apache2b/bin/httpd is 2.0.43?\n\nlibgcc_s.so.1 isn't a dependency of either httpd, so if the lack of\nlibgcc_s.so.1 is keeping httpd to start, then it must be a dependency of some\nlibrary that 2.0.46's httpd references but 2.0.43's httpd does not.\n\nSuch libraries could be libssl or libcrypto.\n\n       libssl.so.0.9.6 =>       /usr/local/ssl/lib/libs\n       libcrypto.so.0.9.6 =>    /usr/local/ssl/lib/libc\n\nDoes either of those reference libgcc_s.so.1?\n\nApparently you built 2.0.46 with different features (mod_ssl) than 2.0.43, since\nthe libraries they depend on are different.  Perhaps that is the change that has\ntriggered this problem?  Perhaps you didn't notice that some crypto library\nneeded libgcc_s.so.1 before because your 2.0.43 httpd didn't need it.\n", "attachment_id": null, "bug_id": 20447, "id": 38388, "time": "2003-06-04T21:25:09Z", "creator": "trawick@apache.org", "creation_time": "2003-06-04T21:25:09Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 20447, "attachment_id": null, "id": 38389, "time": "2003-06-04T21:43:11Z", "creator": "wgreen@gastro.org", "creation_time": "2003-06-04T21:43:11Z", "is_private": false, "text": "Your reply:\n\nI guess that /local01/apache2/bin/httpd is 2.0.46 and\n/local01/apache2b/bin/httpd is 2.0.43?\n\nActually it the other way around. Would that make a difference?\n\napache2 = 2.0.43 and apache2b = 2.0.46"}, {"count": 9, "tags": [], "bug_id": 20447, "attachment_id": null, "text": "It makes a difference, because now I've lost my only theory for why 2.0.46's\nhttpd won't load due to libgcc, even though httpd itself doesn't depend on libgcc :)\n\nMaybe the message is bogus and the problem is that libapr-0 and libaprutil-0\naren't found.\n\nDon't they exist in /usr/local/apache2b/lib?\n\nDoes it fail when you invoke httpd directly but work when you invoke apachectl\ndirectly?  (apachectl should update LD_LIBRARY_PATH to include\n/usr/local/apache2b/lib)\n\nWas /usr/local/apache2b the original install path for 2.0.46?  (i.e., you did\n--prefix=/usr/local/apache2b on your configure invocation?)\n\n", "id": 38390, "time": "2003-06-04T21:50:29Z", "creator": "trawick@apache.org", "creation_time": "2003-06-04T21:50:29Z", "is_private": false}, {"count": 10, "tags": [], "text": "Before I updated to apache 2.0.43 = apache2, I cp it for later use in case the \nupgrade had problems.\n\nI ./config (apache 2.0.46) to apache2, it loaded fine but when I went to start \n(../apache2/bin/apachectl start) that's when I got the error message, so I \nrename apache2 to apache2b and mv my orginal copy back over and my orginal \nstarted with no problems.  That's where I am now.", "attachment_id": null, "id": 38392, "creator": "wgreen@gastro.org", "time": "2003-06-04T21:58:25Z", "bug_id": 20447, "creation_time": "2003-06-04T21:58:25Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 20447, "text": "can you show the output of\n\nldd /local01/apache2b/lib/libapr-0.so.0\nldd /local01/apache2b/lib/libaprutil-0.so.0\n\n?\n\nI suspect that the final answer is going to be this:\n\ngcc code generation for libapr or libaprutil changed between 2.0.43 and 2.0.46,\nand the generated code now depends on libgcc, and your fix would be to edit\nApache's bin/envvars to add the directory containing libgcc to the setting of\nLD_LIBRARY_PATH\n\nto test this theory, you'd need to get /local01/apache2b renamed to\n/local01/apache2 again, then edit /local01/apache2/bin/envvars... but first\nverify with ldd that /local01/apache2b/lib/libapr* is what depends on libgcc\n\nand in the future, some people have found this a useful way to test a new server\nwithout renaming the old directories\n\nalways install apache-2.0.x into\n\n/usr/local/apache-2.0.x  (or for you, /local01/apache-2.0.x)\n\nand use a symlink /usr/local/apache to the desired flavor\n\nso when you upgrade to 2.0.47, it gets installed in /usr/local/apache-2.0.47,\nand you can play with it there to make sure it works, and then change the\nsymlink /usr/local/apache to point to /usr/local/apache-2.0.47\n", "count": 11, "id": 38394, "time": "2003-06-04T22:29:42Z", "creator": "trawick@apache.org", "creation_time": "2003-06-04T22:29:42Z", "is_private": false}, {"count": 12, "attachment_id": null, "creator": "wgreen@gastro.org", "text": "I took your advice and rename (apache2b) back to (apache2, the (libapr or \nlibaprutil) is still looking for the libgcc. \n\nSo, I took your other suggestion and re-compiled Apache under the directory \n(/local01/apache-2.0.46. It still would not start, so I \n\nldd /local01/apache-2.0.46/lib/libapr-0.so.0\n\nI got the message ligcc_s.so.1 = (file not found).\n\nI also check ran\n\nldd /usr/local/ssl/lib/libssl.so.9.6\n\nand got the message = libcrypto.so.0.9.6 (file not found), but they're in the \nsame directoty.  ???", "id": 38639, "time": "2003-06-09T22:55:49Z", "bug_id": 20447, "creation_time": "2003-06-09T22:55:49Z", "tags": [], "is_private": false}, {"count": 13, "tags": [], "bug_id": 20447, "attachment_id": null, "id": 38668, "time": "2003-06-10T12:49:49Z", "creator": "trawick@apache.org", "creation_time": "2003-06-10T12:49:49Z", "is_private": false, "text": "To fix libgcc_s.so not being found, you're going to have to set LD_LIBRARY_PATH\nto point to the directory with libgcc_s.so.  That is the fix to Apache not\nstarting due to that library not being found.\n\n>ldd /usr/local/ssl/lib/libssl.so.9.6\n>and got the message = libcrypto.so.0.9.6 (file not found), \n>but they're in the same directoty.  ???\n\nIt doesn't matter whether or not the libraries are in the same directory.\nA library is found if it is in the default dynamic loader search sequence* or in\nthe list of directories specified by the LD_LIBRARY_PATH environment variable.\nSo add /usr/local/ssl/lib to LD_LIBRARY_PATH too.\n\n*I don't know how to set the default dynamic loader search sequence on Solaris.\n You might check in a Solaris news group.\n\nSo the next step is to try this:  (replace /path/to/gcc with the name of the\ndirectory containing libgcc_s.so)\n\nLD_LIBRARY_PATH=/path/to/gcc:/usr/local/ssl/lib apachectl start\n\nIf it works, then edit Apache's bin/envvars file and update the setting of\nLD_LIBRARY_PATH to include those two additional directories.\n\nIf it doesn't work, what is the error message?\n"}, {"count": 14, "tags": [], "bug_id": 20447, "text": "no further comments from submitter\n\nresolution: the gcc-generated code requires that libgcc_s.so.1 be accessible\nat run-time, and that library isn't in the default search path for the dynamic\nloader, so user needs to get the library findable by editing the LD_LIBRARY_PATH\nsetting in apache's bin/envvars or copying the library to Apache's lib\ndirectory, which is already searched, or by having the loader search in the\ndirectory containing libgcc_s.so.1 by default", "id": 38991, "time": "2003-06-18T02:13:00Z", "creator": "trawick@apache.org", "creation_time": "2003-06-18T02:13:00Z", "is_private": false, "attachment_id": null}]