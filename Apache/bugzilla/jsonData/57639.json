[{"count": 0, "tags": [], "bug_id": 57639, "attachment_id": null, "text": "I created a plug-in project. In runtime eclipse, I did set up a command and added to menu in order to convert selected IFile(docx) file to XWPFDocument which I can parse it later in other java class. However, when I try to cast IFile to XWPFDocument, I get an MethodRequestor.java/InvocationTargetException.\n\nException detail: org.apache.poi.xwpf.usermodel.XWPFDocument cannot be found by eu.modelwriter.architecture.textconnectors.docx.command.ui_1.0.0.qualifier\n\nOn the other hand in my java project, which is referenced in this plugin project, this line is working properly. Same jars included in both projects.\n\nMy command handler is like below:\n\npublic Object execute(ExecutionEvent event) throws ExecutionException {\n    // TODO Auto-generated method stub\n\n    XWPFDocument document = null;\n    Shell shell = HandlerUtil.getActiveShell(event);\n    ISelection sel = HandlerUtil.getActiveMenuSelection(event);\n    IStructuredSelection selection = (IStructuredSelection) sel;\n\n    Object firstElement = selection.getFirstElement();\n\n    if(firstElement instanceof IFile){\n\n        try {\n\n            IFile ifile = (IFile) Platform.getAdapterManager().getAdapter(firstElement, IFile.class);\n\n            if (ifile == null) {\n                if (firstElement instanceof IAdaptable) {\n                    ifile = (IFile) ((IAdaptable) firstElement).getAdapter(IFile.class);\n                }\n            }\n\n            if (ifile != null) {\n\n                File f = ifile.getFullPath().toFile();\n                document = new XWPFDocument(new FileInputStream(f)); //throws exception\n            }\n\n\n        } catch (FileNotFoundException e1) {\n            // TODO Auto-generated catch block\n            e1.printStackTrace();\n        } catch (IOException e) {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        }\n}", "id": 181349, "time": "2015-02-26T15:05:39Z", "creator": "furkan.tanriverdi@unitbilisim.com", "creation_time": "2015-02-26T15:05:39Z", "is_private": false}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "The problematic classes seem to live under the eu.modelwriter.architecture.textconnectors namespace, which is not Apache POI. You'd be best off reporting this problem to whoever it is that produces that library", "id": 181350, "time": "2015-02-26T15:11:51Z", "bug_id": 57639, "creation_time": "2015-02-26T15:11:51Z", "is_private": false}, {"count": 2, "tags": [], "creator": "furkan.tanriverdi@unitbilisim.com", "attachment_id": null, "text": "I used XWPFDocument in my java project. POI libraries were working fine. the time when I want to use class inside that project from handler class in plug-in project, I get an exception. frustrating.", "id": 181366, "time": "2015-02-27T09:12:54Z", "bug_id": 57639, "creation_time": "2015-02-27T09:12:54Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 57639, "attachment_id": null, "text": "Sounds like your problem is either with how you build your project, or with the other classes you use. That's not a POI problem, so you'll need to work out which it is then ask it elsewhere, sorry", "id": 181370, "time": "2015-02-27T09:42:44Z", "creator": "apache@gagravarr.org", "creation_time": "2015-02-27T09:42:44Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 57639, "attachment_id": null, "text": "You description sounds related to OSGi classloading. It sounds like \"in my java project it works\", means \"without OSGi it works\", if that is the case I would investigate how OSGi handles third party jars here, i.e. are they in the same bundle or are correct export/import definitions defined in the bundle manifests, ...", "id": 181373, "time": "2015-02-27T11:42:05Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-02-27T11:42:05Z", "is_private": false}]