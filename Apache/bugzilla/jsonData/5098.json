[{"attachment_id": null, "tags": [], "bug_id": 5098, "text": "Internal and anonymous classes cannot be found.\nThis code compiles but cannot run:\n\n<%!\n\nclass MyEntityResolver implements EntityResolver {\n\tpublic InputSource resolveEntity(String publicId, String systemId) {\n\t\tif (systemId.indexOf(\"web-app_2_3.dtd\") >= 0) {\n\t\t\treturn new \nInputSource(\"c:\\\\j2sdkee1.3\\\\conf\\\\web-app_2_3.dtd\");\n\t\t} else {\n\t\t\treturn new InputSource(systemId);\n\t\t}\n\t}\n}\n//private MyEntityResolver _entityResolver = new MyEntityResolver();\nprivate DocumentBuilderFactory _xmlFactory = \nDocumentBuilderFactory.newInstance();\npublic void init() {\n}\n%>\n\nSo does this:\n\n  db.setEntityResolver(new EntityResolver() {\n     public InputSource resolveEntity(String publicId, String systemId) {\n\tif (systemId.indexOf(\"web-app_2_3.dtd\") >= 0) {\n\t   return new InputSource(\"c:\\\\j2sdkee1.3\\\\conf\\\\web-app_2_3.dtd\");\n\t} else {\n\t   return new InputSource(systemId);\n\t}\t\n     }\n   });\n\nThe class cannot be found.", "count": 0, "id": 8278, "time": "2001-11-26T12:17:09Z", "creator": "hretter@conciselogic.com", "creation_time": "2001-11-26T12:17:09Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 5098, "attachment_id": null, "text": "I tried to create a test servlet to reproduce the problem. I added this to the \nservlet:\n\n            try {\n                DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance\n();\n                DocumentBuilder db = dbf.newDocumentBuilder();\n                db.setEntityResolver(new EntityResolver() {\n                        public InputSource resolveEntity(String publicId, \nString systemId) {\n                            if (systemId.indexOf(\"web-app_2_3.dtd\") >= 0) {\n                                return new InputSource(\"c:\\\\j2sdkee1.3\n\\\\conf\\\\web-app_2_3.dtd\");\n                            } else {\n                                return new InputSource(systemId);\n                            }\t\n                        }\n                    });\n\n            } catch (Throwable t) {\n                t.printStackTrace();\n            }\n\n            System.out.println(\"OK\");\n\nMy servlet class is \"S3\". The compiler creates a \"S3$1\" class, which is then \nloaded by the CL (I added some traces to WebappClassLoader.findClassInternal):\nFCI:S3$1\nFCI:javax.xml.parsers.DocumentBuilder\nOK\n\n\"OK\" is printed, and no exception occurs, so it seems it does work for me.", "id": 8290, "time": "2001-11-26T17:11:20Z", "creator": "remm@apache.org", "creation_time": "2001-11-26T17:11:20Z", "is_private": false}, {"count": 2, "tags": [], "creator": "remm@apache.org", "is_private": false, "text": "Using the same test case, I haven't been able to reproduce the bug. If you have\nadditional details, please let me know.", "id": 8346, "time": "2001-11-27T11:58:56Z", "bug_id": 5098, "creation_time": "2001-11-27T11:58:56Z", "attachment_id": null}]