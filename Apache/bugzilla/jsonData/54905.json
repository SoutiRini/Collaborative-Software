[{"count": 0, "tags": [], "creator": "roy@adallom.com", "is_private": false, "id": 166939, "attachment_id": null, "bug_id": 54905, "creation_time": "2013-04-29T14:30:17Z", "time": "2013-04-29T14:30:17Z", "text": "After a random time (sometimes on startup, sometimes later) Apache 2.4.4 gets into a segfault loop (child processes are faulting and dying, while parent attempts to recreate child that are faulting again).\nI've tried it on various machines - with no success.\nI have tried disabling all irrelevant modules (I'm not using php, and anyway it happens when not serving any requests!)\n\nAttached is the stack-trace from gdb, from all threads.\n\n(gdb) thread apply all bt\n\nThread 28 (LWP 4568):\n#0  0x00007f3cc2bc8707 in kill () from /lib/x86_64-linux-gnu/libc.so.6\n#1  <signal handler called>\n#2  0x00007f3cc38168d2 in ?? () from /lib64/ld-linux-x86-64.so.2\n#3  0x00007f3cc3806be4 in ?? () from /lib64/ld-linux-x86-64.so.2\n#4  0x00007f3cc381184b in ?? () from /lib64/ld-linux-x86-64.so.2\n#5  0x00007f3cc380d176 in ?? () from /lib64/ld-linux-x86-64.so.2\n#6  0x00007f3cc381131a in ?? () from /lib64/ld-linux-x86-64.so.2\n#7  0x00007f3cc2cc2612 in ?? () from /lib/x86_64-linux-gnu/libc.so.6\n#8  0x00007f3cc380d176 in ?? () from /lib64/ld-linux-x86-64.so.2\n#9  0x00007f3cc2cc26d4 in __libc_dlopen_mode () from /lib/x86_64-linux-gnu/libc.so.6\n#10 0x00007f3cc2f613bc in pthread_cancel_init () from /lib/x86_64-linux-gnu/libpthread.so.0\n#11 0x00007f3cc2f6157c in _Unwind_ForcedUnwind () from /lib/x86_64-linux-gnu/libpthread.so.0\n#12 0x00007f3cc2f5f6a0 in __pthread_unwind () from /lib/x86_64-linux-gnu/libpthread.so.0\n#13 0x00007f3cc2f59ff5 in pthread_exit () from /lib/x86_64-linux-gnu/libpthread.so.0\n#14 0x00007f3cc31933b6 in apr_thread_exit (thd=<optimized out>, retval=<optimized out>) at threadproc/unix/thread.c:207\n#15 0x0000000000465f27 in start_threads (thd=0xa26b48, dummy=0xa26ac8) at event.c:2001\n#16 0x00007f3cc2f58e9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0\n#17 0x00007f3cc2c85ccd in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#18 0x0000000000000000 in ?? ()\n\nThread 27 (Thread 0x7f3cadfeb700 (LWP 4594)):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cadfeb700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 26 (Thread 0x7f3cae7ec700 (LWP 4593)):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cae7ec700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 25 (Thread 0x7f3caefed700 (LWP 4592)):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3caefed700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 24 (Thread 0x7f3caf7ee700 (LWP 4591)):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3caf7ee700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 23 (LWP 4590):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3caffef700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 22 (LWP 4589):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cbe80e700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 21 (Thread 0x7f3cb0ff1700 (LWP 4588)):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cb07f0700 in ?? ()\n---Type <return> to continue, or q <return> to quit---\n#3  0x0000000000000000 in ?? ()\n\nThread 20 (LWP 4587):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cb0ff1700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 19 (LWP 4586):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cb3ff7700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 18 (LWP 4585):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cb1ff3700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 17 (LWP 4584):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cb2ff5700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 16 (Thread 0x7f3cbe80e700 (LWP 4569)):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cb37f6700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 15 (LWP 4583):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cb17f2700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 14 (LWP 4582):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cb47f8700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 13 (LWP 4581):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cb27f4700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 12 (Thread 0x7f3cbe00d700 (LWP 4570)):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cb4ff9700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 11 (LWP 4580):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cb57fa700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\n---Type <return> to continue, or q <return> to quit---\nThread 10 (LWP 4579):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cb5ffb700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 9 (LWP 4578):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cb5ffb700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 8 (Thread 0x7f3cbd80c700 (LWP 4571)):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cbd80c700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 7 (LWP 4577):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cb67fc700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 6 (Thread 0x7f3cbd00b700 (LWP 4572)):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cb7fff700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 5 (LWP 4576):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cbc80a700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 4 (LWP 4575):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cbd00b700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 3 (Thread 0x7f3cb7fff700 (LWP 4574)):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cb6ffd700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 2 (Thread 0x7f3cbc80a700 (LWP 4573)):\n#0  0x00007f3cc2c85c91 in clone () from /lib/x86_64-linux-gnu/libc.so.6\n#1  0x00007f3cc2f58dc0 in ?? () from /lib/x86_64-linux-gnu/libpthread.so.0\n#2  0x00007f3cb77fe700 in ?? ()\n#3  0x0000000000000000 in ?? ()\n\nThread 1 (Thread 0x7f3cc3a12700 (LWP 4544)):\n#0  0x00007f3cc2f5fd2d in read () from /lib/x86_64-linux-gnu/libpthread.so.0\n#1  0x0000000000467764 in read (__nbytes=1, __buf=0x7fff7ad826ef, __fd=<optimized out>) at /usr/include/x86_64-linux-gnu/bits/unistd.h:45\n#2  ap_event_pod_check (pod=<optimized out>) at pod.c:58\n#3  0x0000000000427f1f in child_main (child_num_arg=4) at event.c:2185\n#4  0x0000000000465b37 in make_child (s=0x951508, slot=4) at event.c:2272\n#5  0x00000000004667d2 in perform_idle_server_maintenance () at event.c:2469\n#6  server_main_loop (remaining_children_to_start=0) at event.c:2597\n---Type <return> to continue, or q <return> to quit---\n#7  event_run (_pconf=<optimized out>, plog=<optimized out>, s=<optimized out>) at event.c:2656\n#8  0x000000000042ee96 in ap_run_mpm (pconf=0x928138, plog=0x955378, s=0x951508) at mpm_common.c:98\n#9  0x00000000004289b3 in main (argc=3, argv=0x7fff7ad82ac8) at main.c:777"}, {"count": 1, "tags": [], "bug_id": 54905, "attachment_id": null, "id": 166940, "time": "2013-04-29T15:07:14Z", "creator": "roy@adallom.com", "creation_time": "2013-04-29T15:07:14Z", "is_private": false, "text": "The error log looks something like this:\n\n[Mon Apr 29 16:33:01.153356 2013] [core:notice] [pid 1885:tid 139898956883712] AH00052: child pid 18240 exit signal Segmentation fault (11)\n[Mon Apr 29 16:33:02.334155 2013] [core:notice] [pid 1885:tid 139898956883712] AH00052: child pid 18242 exit signal Segmentation fault (11)\n[Mon Apr 29 16:33:02.335361 2013] [core:notice] [pid 1885:tid 139898956883712] AH00052: child pid 18264 exit signal Segmentation fault (11)\n[Mon Apr 29 16:33:02.335485 2013] [core:notice] [pid 1885:tid 139898956883712] AH00052: child pid 18326 exit signal Segmentation fault (11)\n[Mon Apr 29 16:33:02.335662 2013] [core:notice] [pid 1885:tid 139898956883712] AH00052: child pid 18327 exit signal Segmentation fault (11)\n[Mon Apr 29 16:33:02.335806 2013] [core:notice] [pid 1885:tid 139898956883712] AH00052: child pid 18329 exit signal Segmentation fault (11)\n[Mon Apr 29 16:33:02.335883 2013] [core:notice] [pid 1885:tid 139898956883712] AH00052: child pid 18384 exit signal Segmentation fault (11)\n[Mon Apr 29 16:33:02.335943 2013] [core:notice] [pid 1885:tid 139898956883712] AH00052: child pid 18411 exit signal Segmentation fault (11)\n[Mon Apr 29 16:33:02.336000 2013] [core:notice] [pid 1885:tid 139898956883712] AH00052: child pid 18412 exit signal Segmentation fault (11)\n[Mon Apr 29 16:33:02.336056 2013] [core:notice] [pid 1885:tid 139898956883712] AH00052: child pid 18447 exit signal Segmentation fault (11)\n[Mon Apr 29 16:33:02.336112 2013] [core:notice] [pid 1885:tid 139898956883712] AH00052: child pid 18524 exit signal Segmentation fault (11)\n\n\nand goes on and on..."}, {"count": 2, "tags": [], "bug_id": 54905, "attachment_id": null, "id": 167032, "time": "2013-05-04T11:44:49Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2013-05-04T11:44:49Z", "is_private": false, "text": "Sounds to me like a platform bug. Which Linux distribution is it exactly? Can you check with your distributor?\n\napr_thread_exit() simply calls pthread_exit(NULL). IMHO nothing to fix here.\n\nCould it be a low memory situation on the system, so that it kills the processes?\n\nRegards,\n\nRainer"}, {"count": 3, "tags": [], "creator": "sf@sfritsch.de", "text": "Doing 'bt full' for the thread that crashes could give further hints if there is a problem in httpd. If there is a package with debug symbols for libc, installing that beforehand may be a good idea, too. For example, on Debian, this is called libc6-dbg. Is there anything else interesting in the error log? Try \"grep -v AH00052 ...\"", "id": 167043, "attachment_id": null, "bug_id": 54905, "creation_time": "2013-05-05T18:16:52Z", "time": "2013-05-05T18:16:52Z", "is_private": false}]