[{"count": 0, "tags": [], "bug_id": 51921, "attachment_id": null, "is_private": false, "id": 149957, "time": "2011-09-30T05:48:33Z", "creator": "baraiya.yatin@gmail.com", "creation_time": "2011-09-30T05:48:33Z", "text": "Currently i am using the apache tika 0.9[plus tika 0.9's dependent jar file] and apache poi 3.7 jar for text extraction .\n\ni get the exception when i used some Microsoft office document. i have attached document zip file. Please check it with said jar file.\n\ni get the following exception when  we upload '1_1.doc' document from the attached zip file.\n\nCaused by: org.apache.tika.exception.TikaException: Unexpected RuntimeException\nfrom org.apache.tika.parser.microsoft.OfficeParser@d8e54c\n    at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:199)\n    at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:197)\n    at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:135)\n    at\norg.apache.tika.parser.ParsingReader$ParsingTask.run(ParsingReader.java:232)\n    ... 1 more\nCaused by: java.lang.NullPointerException\n    at\norg.apache.poi.hwpf.sprm.CharacterSprmUncompressor.uncompressCHP(CharacterSprmUncompressor.java:39)\n    at org.apache.poi.hwpf.model.CHPX.getCharacterProperties(CHPX.java:61)\n    at org.apache.poi.hwpf.usermodel.CharacterRun.<init>(CharacterRun.java:98)\n    at org.apache.poi.hwpf.usermodel.Range.getCharacterRun(Range.java:797)\n    at\norg.apache.poi.hwpf.model.PicturesTable.getAllPictures(PicturesTable.java:191)\n    at\norg.apache.tika.parser.microsoft.WordExtractor$PicturesSource.<init>(WordExtractor.java:430)\n    at\norg.apache.tika.parser.microsoft.WordExtractor$PicturesSource.<init>(WordExtractor.java:420)\n    at\norg.apache.tika.parser.microsoft.WordExtractor.parse(WordExtractor.java:75)\n    at\norg.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:182)\n    at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:197)\n    ... 4 more\n\n\n\ni get the following exception when  we upload 'Book1.xlsb' and 'MSPPT2007.thmx' documents from the attached zip file.\n\nCaused by: org.apache.tika.exception.TikaException: TIKA-418: RuntimeException\nwhile getting content for thmx and xps file types\n    at\norg.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:86)\n    at\norg.apache.tika.parser.microsoft.ooxml.OOXMLParser.parse(OOXMLParser.java:67)\n    at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:197)\n    at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:197)\n    at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:135)\n    at\norg.apache.tika.parser.ParsingReader$ParsingTask.run(ParsingReader.java:232)\n    ... 1 more\nCaused by: java.lang.IllegalArgumentException: No supported documents found in\nthe OOXML package (found\napplication/vnd.ms-excel.sheet.binary.macroEnabled.main)\n    at\norg.apache.poi.extractor.ExtractorFactory.createExtractor(ExtractorFactory.java:191)\n    at\norg.apache.poi.extractor.ExtractorFactory.createExtractor(ExtractorFactory.java:152)\n    at\norg.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:65)\n    ... 6 more\n\ni get the following exception when  we upload 'MSPPT2007.xps' document from the attached zip file.\n\nCaused by: org.apache.tika.exception.TikaException: Error creating OOXML\nextractor\n    at\norg.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:90)\n    at\norg.apache.tika.parser.microsoft.ooxml.OOXMLParser.parse(OOXMLParser.java:67)\n    at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:197)\n    at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:197)\n    at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:135)\n    at\norg.apache.tika.parser.ParsingReader$ParsingTask.run(ParsingReader.java:232)\n    ... 1 more\nCaused by: java.lang.IllegalArgumentException: Invalid OOXML Package received -\nexpected 1 core document, found 0\n    at\norg.apache.poi.extractor.ExtractorFactory.createExtractor(ExtractorFactory.java:161)\n    at\norg.apache.poi.extractor.ExtractorFactory.createExtractor(ExtractorFactory.java:152)\n    at\norg.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:65)\n    ... 6 more\n\n\nPlease try to resolve this issue.\n\nThanks & Regards\nYatin Baraiya"}, {"count": 1, "tags": [], "bug_id": 51921, "attachment_id": null, "text": "*** Bug 51920 has been marked as a duplicate of this bug. ***", "id": 150120, "time": "2011-10-04T12:27:47Z", "creator": "yegor@dinom.ru", "creation_time": "2011-10-04T12:27:47Z", "is_private": false}, {"count": 2, "tags": [], "creator": "yegor@dinom.ru", "is_private": false, "text": "Please try the latest Tika 0.10 which depends on POI 3.8-beta4. Also, I forgot to attach the problematic file.\n\nYegor", "id": 150121, "time": "2011-10-04T12:32:29Z", "bug_id": 51921, "creation_time": "2011-10-04T12:32:29Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "apache-bugzilla@struxxn.de", "attachment_id": null, "text": "I could reproduce the error with Apache Tika 0.10 and the attached document (Word-Crash067.doc). Same thing with current trunk (Revision 1180244).\n\nAs soon as I delete the style 'Tabellenzeilenaufschrift klein' (see screenshot.png and resulting Word-Crash067-ok.doc) or save the document as .docx (Word-Crash067.docx), everything works as expected. I tested this with Microsoft Office Word 2003 (11.8328.8341) SP3.", "id": 150379, "time": "2011-10-09T13:50:35Z", "bug_id": 51921, "creation_time": "2011-10-09T13:50:35Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 51921, "attachment_id": 27744, "text": "Created attachment 27744\nWord-Document to throw exception 'CharacterSprmUncompressor.java:48'", "id": 150380, "time": "2011-10-09T13:53:13Z", "creator": "apache-bugzilla@struxxn.de", "creation_time": "2011-10-09T13:53:13Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 51921, "is_private": false, "text": "Created attachment 27745\nWord-Document without the problematic style", "id": 150381, "time": "2011-10-09T13:54:13Z", "creator": "apache-bugzilla@struxxn.de", "creation_time": "2011-10-09T13:54:13Z", "attachment_id": 27745}, {"count": 6, "tags": [], "bug_id": 51921, "is_private": false, "text": "Created attachment 27746\nScreenshot of the problematic style", "id": 150382, "time": "2011-10-09T13:54:40Z", "creator": "apache-bugzilla@struxxn.de", "creation_time": "2011-10-09T13:54:40Z", "attachment_id": 27746}, {"count": 7, "tags": [], "creator": "apache-bugzilla@struxxn.de", "is_private": false, "text": "Created attachment 27747\nSame Word-Document as Word-Crash067.doc but saved as .docx", "id": 150383, "time": "2011-10-09T13:55:27Z", "bug_id": 51921, "creation_time": "2011-10-09T13:55:27Z", "attachment_id": 27747}, {"count": 8, "tags": [], "bug_id": 51921, "is_private": false, "text": "I hopefully provided the necessaray information some days ago. Setting the status back to new...", "id": 150990, "time": "2011-10-28T06:24:02Z", "creator": "apache-bugzilla@struxxn.de", "creation_time": "2011-10-28T06:24:02Z", "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 51921, "attachment_id": null, "text": "@Yegor: Are there any updates on this issue?", "id": 152218, "time": "2011-12-16T14:38:30Z", "creator": "n.scheer@binserv.de", "creation_time": "2011-12-16T14:38:30Z", "is_private": false}, {"count": 10, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "text": "The provided sample files do work now, so the bug seems to have been fixed some time ago already.", "id": 181969, "time": "2015-03-22T19:44:59Z", "bug_id": 51921, "creation_time": "2015-03-22T19:44:59Z", "is_private": false}]