[{"count": 0, "tags": [], "text": "Created attachment 34289\nfile from TIKA-2069\n\nWhile working on TIKA-2069, I found that I wasn't able to extract macros from a test ppt file that I generated.  May be user error in generating the test file.  However, POI successfully extracted macros from the original 'pptm' file that I saved as ppt.", "is_private": false, "bug_id": 60162, "id": 193902, "time": "2016-09-22T01:07:48Z", "creator": "tallison@mitre.org", "creation_time": "2016-09-22T01:07:48Z", "attachment_id": 34289}, {"count": 1, "tags": [], "text": "\"Sub Embolden()\" and \"Sub Italicize\" should show up in the text of the macros.", "is_private": false, "bug_id": 60162, "id": 193903, "time": "2016-09-22T01:09:35Z", "creator": "tallison@mitre.org", "creation_time": "2016-09-22T01:09:35Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 60162, "attachment_id": null, "is_private": false, "id": 194511, "time": "2016-10-18T17:45:37Z", "creator": "tallison@mitre.org", "creation_time": "2016-10-18T17:45:37Z", "text": "The macros are stored in a POIFS within an ExOleObjStg within the \"PowerPoint Document\".  Brilliant!!! \n\nIf you add this to the end of buildRecords() in HSLFSlideShowImpl:\n\n        for (Record r : _records) {\n            if (r.getRecordType() == 4113) {\n                ExOleObjStg exOleObjStg = (ExOleObjStg) r;\n                try {\n                    NPOIFSFileSystem npoifs = new POIFSFileSystem(exOleObjStg.getData());\n                    VBAMacroReader reader = new VBAMacroReader(npoifs);\n                    System.out.println(reader.readMacros());\n                } catch (IOException e) {\n                    e.printStackTrace();\n                }\n\n            }\n        }\n\nThe macros are correctly read.\n\nRecommendations for the least smelly way to extract these?  Unlike the other document formats, this requires a full parse of the document, we can't just pass in the parent POIFs.\n\nAdd a getMacros() to HSLFSlideShowImpl for now?"}, {"count": 3, "tags": [], "text": "As always, Yegor had already figured this out:\n\nhttps://bz.apache.org/bugzilla/show_bug.cgi?id=43376\n\n:)", "is_private": false, "bug_id": 60162, "id": 194512, "time": "2016-10-18T17:54:48Z", "creator": "tallison@mitre.org", "creation_time": "2016-10-18T17:54:48Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "tallison@mitre.org", "attachment_id": null, "text": "Y, so it wasn't just Yegor, but just about the entire POI team already knew this...\n\nThanks to Javen for pointing 59302 out to me.  Sorry for the duplicate!\n\n*** This bug has been marked as a duplicate of bug 59302 ***", "id": 194548, "time": "2016-10-19T11:59:28Z", "bug_id": 60162, "creation_time": "2016-10-19T11:59:28Z", "is_private": false}]