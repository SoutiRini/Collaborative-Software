[{"count": 0, "tags": [], "creator": "goldenfish@linuxsoft.cz", "attachment_id": null, "id": 119690, "time": "2008-08-11T11:45:47Z", "bug_id": 45616, "creation_time": "2008-08-11T11:45:47Z", "is_private": false, "text": "I have been tracking problem with incorrecty displayed table in rtf format in openoffice.\n\nThis part openoffice openoffice.org display incorrectly (original document).\n2 columns are displayed as 1 column.\n\n{\\trowd \\trpaddt20 \\trpaddft3 \\clpadt20 \\clpadft3 \\clbrdrl \\ql \\cellx5669 \\ql \\clpadt20 \\clpadft3 \\clbrdrr \\ql \\cellx9637 \\ql \\intbl \\ql {{\\fs24 547}\n}\n\\ql \\cell \\intbl \\ql {{\\fs24 Jungmannova}\n}\n\\ql \\cell \\row }\n\nThis part openoffice display correctly (edited document - deleted \\ql element before last \\cellx element:\n\n{\\trowd \\trpaddt20 \\trpaddft3 \\clpadt20 \\clpadft3 \\clbrdrl \\cellx5669 \\clpadt20 \\clpadft3 \\clbrdrr \\cellx9637 \\ql \\intbl \\ql {{\\fs24 Soucek Kamil}\n}\n\\ql \\cell \\intbl \\ql {{\\fs24 organizacn\u00ed slozka }\n}\n\\ql \\cell \\row }\n\n\nThere is simple and \"ugly\" patch for simulating current problem.\n\n### Eclipse Workspace Patch 1.0\n#P apache-fop\nIndex: src/java/org/apache/fop/render/rtf/rtflib/rtfdoc/RtfTableCell.java\n===================================================================\n--- src/java/org/apache/fop/render/rtf/rtflib/rtfdoc/RtfTableCell.java\t(revision 684771)\n+++ src/java/org/apache/fop/render/rtf/rtflib/rtfdoc/RtfTableCell.java\t(working copy)\n@@ -256,6 +256,8 @@\n \n         //these lines added by Chris Scott, Westinghouse\n         //some attributes need to be writting before opening block\n+        \n+        /*\n         if (setCenter) {\n             writeControlWord(\"qc\");\n         } else if (setRight) {\n@@ -263,12 +265,13 @@\n         } else {\n             writeControlWord(\"ql\");\n         }\n+        */\n         writeAttributes (attrib, ITableAttributes.CELL_VERT_ALIGN);\n \n         writeControlWord(\"cellx\" + xPos);\n \n         //TODO Why is this here, right after an alignment command is written (see above)?\n-        writeControlWord(\"ql\");\n+       /*writeControlWord(\"ql\");*/\n \n         return xPos;\n \nIndex: src/java/org/apache/fop/render/rtf/rtflib/rtfdoc/RtfTableRow.java\n===================================================================\n--- src/java/org/apache/fop/render/rtf/rtflib/rtfdoc/RtfTableRow.java\t(revision 684771)\n+++ src/java/org/apache/fop/render/rtf/rtflib/rtfdoc/RtfTableRow.java\t(working copy)\n@@ -265,10 +265,11 @@\n \n                 // write cell's definition\n                 xPos = rtfcell.writeCellDef(xPos);\n+                \n             }\n           index++; // Added by Boris POUDEROUS on 2002/07/02\n         }\n-\n+        writeControlWord(\"ql\"); // TEST-CASE\n         newLine();\n     }\n \n\nQuestion: is there bug in OpenOffice.org rtf parser or bug in rtf generator (rtf \nspecification implementation ?)\n\nTestCase:\n- create rtf document with table with 2 columns at least in row.\n- create rtf document with and without patch\n- open document with openoffice.org (2.4 or 3.x version)\n- compare output - tables"}, {"count": 1, "attachment_id": 22449, "bug_id": 45616, "is_private": false, "id": 119860, "time": "2008-08-15T10:28:57Z", "creator": "goldenfish@linuxsoft.cz", "creation_time": "2008-08-15T10:28:57Z", "tags": [], "text": "Created attachment 22449\nrow formating patch - fix for OpenOffice\n\nAttached patch fix this problem.\n\nhttp://www.biblioscape.com/rtf15_spec.htm#Heading40  (next page)\n\n Row Formatting\n\\trql \tLeft-justifies a table row with respect to its containing column.\n\\trqr \tRight-justifies a table row with respect to its containing column.\n\\trqc \tCenters a table row with respect to its containing column.\n\ntested by OpenOffice 3.x , Abiword 2.6.4; Linux OS."}, {"count": 2, "tags": [], "bug_id": 45616, "attachment_id": null, "text": "Patch verified with Word 2007 Viewer and OpenOffice 2.4. Patch applied to FOP Trunk:\nhttp://svn.apache.org/viewvc?rev=693742&view=rev\n\nThanks a lot, Pavel. Sorry for the delay.", "id": 120510, "time": "2008-09-10T02:02:09Z", "creator": "jeremias@apache.org", "creation_time": "2008-09-10T02:02:09Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 45616, "attachment_id": null, "text": "batch transition pre-FOP1.0 resolved+fixed bugs to closed+fixed", "id": 156331, "time": "2012-04-01T07:10:31Z", "creator": "gadams@apache.org", "creation_time": "2012-04-01T07:10:31Z", "is_private": false}]