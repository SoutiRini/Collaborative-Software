[{"count": 0, "attachment_id": null, "bug_id": 18804, "is_private": false, "id": 34702, "time": "2003-04-08T09:34:39Z", "creator": "jcouillaud@net2s.com", "creation_time": "2003-04-08T09:34:39Z", "tags": [], "text": "This is an odd bug (in tomcat's code or in the webapp code) from a code I do not\nmaintain and hardly can modify.\n\nThere is an applet that tries to communicate with a web application by sending\nthe servlet an XML query the following way:\n\n            url = new URL(urlString);\n            conn = url.openConnection();\n            conn.setDoInput(true);\n            conn.setDoOutput(true);\n            conn.setRequestProperty(\"APPLETENCODING\", encoding);\n            conn.setRequestProperty(\"APPLETXMLENCODING\", xmlEncoding);\n            conn.setRequestProperty(\"APPLETCHARSET\", charset);\n            BufferedWriter bw = new BufferedWriter(new\nOutputStreamWriter(conn.getOutputStream(), encoding));\n            bw.write(appRequest.toString()); // appRequest contains the XML query\n            bw.flush();\n            bw.close();\n\n\nThen, in the servlet called via the urlString argument above, the application\ntries to get the argument and use it the following way:\n\n        encoding = request.getHeader(\"PORTALAPPLETENCODING\");\n        xmlEncoding = request.getHeader(\"PORTALAPPLETXMLENCODING\");\n        charset = request.getHeader(\"PORTALAPPLETCHARSET\");\n\n        in = request.getInputStream();\n        reader = new InputStreamReader(in, encoding);\n        br = new BufferedReader(reader);\n\nThe appRequest sent in the applet is a raw XML string\n(<something><asd></asd></something>)\n\nThe problem is the following:\n- On tomcat 3.3a with mod_jk, the XML string arrives properly and the servlet\nhandles it properly.\n- On tomcat 4.1.24 without mod_jk, the XML string arrives properly too ...\n- On tomcat 4.1.24 with mod_jk, the XML string arrives truncated !\n\nThe only conclusion I've come is the following:\n- There is a bug in the ajp13 connector in tomcat 4.1.x\nOR\n- The way this webapp sends this XML string to the servlet is invalid and the\nfact that it worked with the ajp13 connector of tomcat 3.3a wasn't a\nfunctionnality at all and that the developper was just lucky it worked.\n\nWe badly need to get it working, either by downgrading to tomcat 3.3a or by\ngetting tomcat 4.1.x patched.\n\nThx in advance."}, {"count": 1, "tags": [], "creator": "jcouillaud@net2s.com", "is_private": false, "id": 34706, "creation_time": "2003-04-08T09:42:36Z", "time": "2003-04-08T09:42:36Z", "bug_id": 18804, "text": "Sorry about the typo, read:\n\n        encoding = request.getHeader(\"APPLETENCODING\");\n        xmlEncoding = request.getHeader(\"PORTALAPPLETXMLENCODING\");\n        charset = request.getHeader(\"APPLETCHARSET\");\n\ninstead of:\n\n        encoding = request.getHeader(\"PORTALAPPLETENCODING\");\n        xmlEncoding = request.getHeader(\"PORTALAPPLETXMLENCODING\");\n        charset = request.getHeader(\"PORTALAPPLETCHARSET\");\n\n", "attachment_id": null}, {"count": 2, "tags": [], "creator": "remm@apache.org", "is_private": false, "id": 35526, "creation_time": "2003-04-18T13:49:17Z", "time": "2003-04-18T13:49:17Z", "bug_id": 18804, "text": "Try using the Coyote JK 2 connector on the Tomcat side (you can keep mod_jk on\nthe native side). The old AJP connector is deprecated.", "attachment_id": null}, {"count": 3, "tags": [], "text": "This component is now deprecated. If you still experience this issue, please \nupgrade to the Coyote JK2 connector.\n\nNo further work will take place against this bug report.\n\n", "attachment_id": null, "bug_id": 18804, "id": 59495, "time": "2004-06-18T18:42:53Z", "creator": "markt@apache.org", "creation_time": "2004-06-18T18:42:53Z", "is_private": false}]