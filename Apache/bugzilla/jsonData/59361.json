[{"count": 0, "text": "Reproduction steps:\n\n1. Have an existing XLSX file (call it a template), that has data validation rules defined on certain cells\n2. Open the file and parse it with XSSF \n3. Select the worksheet that has data validation and change at least one cell's value\n4. Output the updated workbook into a new file.\n\nObserved behaviour:\n\nThe XML file for the template stores the data validation rules with HTML codes when describing \"greater than\" or \"less than\" rules. The result file has these HTML codes replaced with the character possibly causing issues with the parsing & validation application. Example:\n\nTemplate file <worksheet1.xml>\n-------------\n<f t=\"shared\" ref=\"CD5:CD36\" si=\"33\">\nIF(ISERROR(OR(N5&lt;&gt;INT(N5),NOT(ISNUMBER(N5)))),1,IF(OR(N5&lt;&gt;INT(N5),NOT(ISNUMBER(N5))),1,0))</f>\n\n...\n\n<f t=\"shared\" ref=\"CF5:CF36\" si=\"35\">\nIF(AND(AP5&gt;0,ISBLANK(R5),ISBLANK($R$4)),1,0)</f>\n-------------\n\nResults file <worksheet1.xml>\n-------------\n<f t=\"shared\" ref=\"CD5:CD36\" si=\"33\">\nIF(ISERROR(OR(N5&lt;>\nINT(N5),NOT(ISNUMBER(N5)))),1,IF(OR(N5&lt;>\nINT(N5),NOT(ISNUMBER(N5))),1,0))</f>\n\n...\n\n<f t=\"shared\" ref=\"CF5:CF36\" si=\"35\">\nIF(AND(AP5>\n0,ISBLANK(R5),ISBLANK($R$4)),1,0)</f>\n-------------\n\nSymptom:\n\nWhen opening the result file with Excel, the validation seems to be broken, i.e. misfiring and marking fields that pass failed, and vice versa.", "bug_id": 59361, "is_private": false, "id": 190414, "time": "2016-04-20T15:00:27Z", "creator": "mate.marjai@gmail.com", "creation_time": "2016-04-20T15:00:27Z", "tags": [], "attachment_id": null}, {"count": 1, "tags": [], "text": "Can you provide your sample file to make it easier to reproduce this?", "is_private": false, "bug_id": 59361, "id": 191115, "time": "2016-05-19T19:10:49Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-05-19T19:10:49Z", "attachment_id": null}]