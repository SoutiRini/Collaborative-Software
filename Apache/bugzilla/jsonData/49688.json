[{"count": 0, "tags": [], "bug_id": 49688, "attachment_id": 25828, "id": 138815, "time": "2010-08-02T08:41:59Z", "creator": "berger@wlp-systems.de", "creation_time": "2010-08-02T08:41:59Z", "is_private": false, "text": "Created attachment 25828\njava code for creating a test file, reproducing the unexpected behaviour\n\nUsing both, poi-bin-3.7-beta1-20100620 or poi-bin-3.6-20091214, when creating a formula based conditional formatting referencing another cell, the formatting is not (re-)calculated properly.\n\nThe attached file contains a test case where a cell (B1) should be formatted with a yellow background if another cell (A1) is blank, what is the initial state of the created sheet. When opening the file, the format is correct (A1 is not blank, thus B1 has a yellow background). If I clear cell A1, cell B1 will not be formatted with a white background (as I just notice, it seems that just the small part hidden by the cursor will be formatted correctly).\n\nComing from http://article.gmane.org/gmane.comp.jakarta.poi.user/13767/, I tried to find a way to set CFHeaderRecord.setNeedRecalculation(boolean b) to true (which, as long as I can see, is never used in POI's sources except in a test case), without success.\nPatching the constructor of CFHeaderRecord to initially calling setNeedRecalculation(true) or changing HSSFConditionalFormatting's getCFRecordsAggregate() to public, so i was able to access it, resulted in a excel file with the correct behaviour."}, {"count": 1, "tags": [], "bug_id": 49688, "attachment_id": null, "id": 149327, "time": "2011-09-16T14:53:29Z", "creator": "ivano.diana@ext.bhuman.it", "creation_time": "2011-09-16T14:53:29Z", "is_private": false, "text": "I've been encountering a problem very similar to that described in here. When setting conditional formatting in a sheet by means of POI, if I choose to set a rule with a formula that contain a reference to a cell that is not present in the range defined by \"CellRangeAddress\" object, the cells included in this region (the CellRangeAddress object) will not update to the formatting associated to the rule.\nBetter to post some code:\n-------------------------------------------------------------------\nSheetConditionalFormatting sheetCF = heet.getSheetConditionalFormatting();\n\n        ConditionalFormattingRule rule1 = \nsheetCF.createConditionalFormattingRule(\"$A$15>75\");\n\nPatternFormatting fill1 = rule1.createPatternFormatting();\nfill1.setFillBackgroundColor(IndexedColors.BLUE.index);\nfill1.setFillPattern(PatternFormatting.SOLID_FOREGROUND);\n\nCellRangeAddress[] regions = {CellRangeAddress.valueOf(\"A18:A20\")};\n\nsheetCF.addConditionalFormatting(regions, rule1);\n-------------------------------------------------------------------\n\nIf I change the formula in \"$A$18>75\", that is if the cell involved in the formula is included in the region defined by CellRangeAddress object, opening the file with excel the cells are formatted correctly."}, {"count": 2, "tags": [], "bug_id": 49688, "attachment_id": null, "is_private": false, "id": 149494, "time": "2011-09-19T13:50:29Z", "creator": "ivano.diana@ext.bhuman.it", "creation_time": "2011-09-19T13:50:29Z", "text": "I've checked out the POI project from SVN and tryed to use method \"setNeedRecalculation(true)\" from the object CFHeaderRecord to solve the problem about conditional formatting recalculation. Indeed it seems it's going to work but I'm not sure my changes can be adequate to patch the problem. \nThe only change I've made is in constructor method \"CFRecordsAggregate(CFHeaderRecord pHeader, CFRuleRecord[] pRules)\" where I added the row:\n\n//----------------------------------\nheader.setNeedRecalculation(true);\t\t//---------------------------------- \n\nI'm going to test again the changes to avoid regressions and then I'll let you know."}, {"count": 3, "attachment_id": null, "creator": "sebastian.esch@ibsolution.de", "is_private": false, "id": 163311, "time": "2012-11-09T13:53:13Z", "bug_id": 49688, "creation_time": "2012-11-09T13:53:13Z", "tags": [], "text": "Running the examples from https://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/ss/examples/ConditionalFormats.java with -xls results in no conditional formattings displayed MultiCell, Errors, Hide Dups and Duplicates examples.\n\nI used Excel 2007 to open the xls file. Apache POI Version is 3.8."}, {"count": 4, "tags": [], "creator": "sebastian.esch@ibsolution.de", "attachment_id": null, "id": 163312, "time": "2012-11-09T13:55:46Z", "bug_id": 49688, "creation_time": "2012-11-09T13:55:46Z", "is_private": false, "text": "(In reply to comment #3)\n> Running the examples from\n> https://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/\n> ss/examples/ConditionalFormats.java with -xls results in no conditional\n> formattings displayed MultiCell, Errors, Hide Dups and Duplicates examples.\n> \n> I used Excel 2007 to open the xls file. Apache POI Version is 3.8.\n\nThe CF Rules are present in the xls file and editing and not changing them results in the correct display of the CF."}, {"count": 5, "attachment_id": null, "creator": "yegor@dinom.ru", "is_private": false, "id": 163319, "time": "2012-11-09T17:21:20Z", "bug_id": 49688, "creation_time": "2012-11-09T17:21:20Z", "tags": [], "text": "Please try with the latest build from trunk. Many bugs have been fixed since POI-3.8 including suport for CF. \n\nA link to daily builds is on http://poi.apache.org/\n\nYegor"}, {"text": "No update on this one for a long time, also bug 52122 seems to handle a similar issue. Therefore resolving this as duplicate.\n\n*** This bug has been marked as a duplicate of bug 52122 ***", "tags": [], "bug_id": 49688, "is_private": false, "count": 6, "id": 181894, "time": "2015-03-18T20:58:03Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-03-18T20:58:03Z", "attachment_id": null}]