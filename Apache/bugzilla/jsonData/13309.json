[{"attachment_id": null, "tags": [], "bug_id": 13309, "is_private": false, "count": 0, "id": 23948, "time": "2002-10-04T19:12:25Z", "creator": "justin@somanetworks.com", "creation_time": "2002-10-04T19:12:25Z", "text": "Catalina calls System.exit()from several locations:\n  -- core/StandardServer calls it\n  -- several classes in startup call it\n\nThis makes life difficult for application developers who wish to embedd Tomcat\ninto their application, such as to attach a web interface to an application\nwhich is otherwise not a web application.\n\nIn particular it may not be a critical failure if tomcat fails to start up\nsuccessfully, except that Catalina calls System.exit. It may also be a\nrecoverable error, as the containing system could try re-starting it with\ndifferent arguments. \n\nPlease note that the documentation for CatalinaService at least in part implies\nthat it is expected to be used in this fashion: \"designed to allow easier\nwrapping by system level components\".\n\nSo, I think Catalina should not call System.exit(), or should only call\nSystem.exit() from a loader which is not intended to be wrapped by a system\nlevel component."}, {"count": 1, "tags": [], "bug_id": 13309, "attachment_id": null, "is_private": false, "id": 23959, "time": "2002-10-04T20:26:10Z", "creator": "remm@apache.org", "creation_time": "2002-10-04T20:26:10Z", "text": "Use the BootstrapService class (instead of Bootstrap), and the offending code\nwill never be called."}, {"attachment_id": null, "tags": [], "bug_id": 13309, "is_private": false, "count": 2, "id": 23969, "time": "2002-10-04T22:06:36Z", "creator": "justin@somanetworks.com", "creation_time": "2002-10-04T22:06:36Z", "text": "\nUsing BootstrapService does not avoid the problem. BootstrapService simply wraps\naround CatalinaService and Catalina itself. \n\nSince Catalina.java contains calls to System.exit(), it can still happen even if\nyou use BootstrapService. Calling System.exit() in response to an exception, no\nmatter how unlikely the exception, makes it dangerous to embedd Catalina into a\nlarger system. \n\nInstead of calling System.exit() in response to an exception, Catalina.java (and\nother locations) should propagate an exception to the calling class, deferring\nthe decision to terminate the JVM as much as possible.\n\nIdeally you should only call System.exit() from a main() method, as a means of\nensuring that all threads terminate--and it would still be nice to interrupt all\nthe running threads, and invoke any shutdown hooks, prior to killing the JVM.\n"}, {"count": 3, "tags": [], "creator": "justin@somanetworks.com", "attachment_id": null, "id": 23970, "time": "2002-10-04T22:11:21Z", "bug_id": 13309, "creation_time": "2002-10-04T22:11:21Z", "is_private": false, "text": "\ncore/StandardServer.java also calls System.exit() from it's await() method, if\nit gets an IOException trying to create the ServerSocket.\n"}, {"count": 4, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "id": 23990, "time": "2002-10-05T08:12:52Z", "bug_id": 13309, "creation_time": "2002-10-05T08:12:52Z", "is_private": false, "text": "If you use the **Service class, which is used by the NT service, then\nStandardServer.await will never get called (it prevents anyone from shutting\ndown the service, except by using the NT service control features, which is a\nlot more secure). Please check code coverage before starting to complain.\n\nIf you have specific needs, it's easy to either:\n- use Embedded\n- extend the existing wrapper classes, which will never be able to totally fit\nwhat you want to do"}, {"count": 5, "tags": [], "bug_id": 13309, "attachment_id": null, "text": "\nThe await() call is only one place where Catalina calls System.exit(). It will\nalso call System.exit() from CatalinaService if the digester throws an\nexception. This bug should remain open until it's verified that CatalinaService\nwill never call System.exit(), or until it's decided that it's clarified that\nit's OK for CatalinaService to call System.exit().", "id": 24070, "time": "2002-10-07T15:52:39Z", "creator": "justin@somanetworks.com", "creation_time": "2002-10-07T15:52:39Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 13309, "is_private": false, "text": "The existing Tomcat 7 calls are valid.", "id": 142321, "time": "2010-12-02T16:12:00Z", "creator": "markt@apache.org", "creation_time": "2010-12-02T16:12:00Z", "attachment_id": null}]