[{"count": 0, "tags": [], "bug_id": 21122, "attachment_id": null, "is_private": false, "id": 39508, "time": "2003-06-26T18:43:54Z", "creator": "chatpert@email.com", "creation_time": "2003-06-26T18:43:54Z", "text": "Redhat 9, 2.4.20-18.9smp,\nrpm -q httpd\nhttpd-2.0.40-21.3\nhttpd -v\nServer version: Apache/2.0.40\nServer built:   May 20 2003 10:15:29\n\nThis happens on 2 machines in the past 3 weeks. It has happened 4 or 5 times.\nEach time after 4am, apache becomes very slow and our monitoring program reports\nit cannot connect to port 80. Then a cron job tries to restart apache, but\nfails. After a while(like 10 minutes), the connection to 80 seems ok, but loading\npages is extremely slow. \"top\" command also showed some strange stats. I usually\nsee one httpd process(memory usage around 7M), but when the problem occurred,\nthere are multiple HTTP processes displayed by top, and each of them uses about\n9M bytes of memory. Once I restart apache(stop, and then start), things are \nback to normal.\n\nI wonder if it has something to do with logrotate of apache, as logrotate is run\nat 4:02am set by redhat. Does apache close the port temporarily during logrotate? \n\nsome lines from error_log\n\n\n[Thu Jun 26 04:02:06 2003] [notice] Digest: generating secret for digest\nauthentication ...\n[Thu Jun 26 04:02:06 2003] [notice] Digest: done\n[Thu Jun 26 04:02:07 2003] [notice] Apache configured -- resuming normal operations\n[Thu Jun 26 04:02:16 2003] [warn] child process 24251 still did not exit,\nsending a SIGTERM\n[Thu Jun 26 04:02:33 2003] [warn] child process 24251 still did not exit,\nsending a SIGTERM\n[Thu Jun 26 04:03:40 2003] [warn] child process 24251 still did not exit,\nsending a SIGTERM\n[Thu Jun 26 04:08:08 2003] [error] child process 24251 still did not exit,\nsending a SIGKILL\n[Thu Jun 26 04:10:09 2003] [notice] SIGHUP received.  Attempting to restart\n[Thu Jun 26 04:10:10 2003] [notice] Digest: generating secret for digest\nauthentication ...\n[Thu Jun 26 04:10:10 2003] [notice] Digest: done\n[Thu Jun 26 04:10:11 2003] [notice] Apache configured -- resuming normal operations"}, {"count": 1, "tags": [], "creator": "nd@perlig.de", "is_private": false, "text": "Please check if this happens with a recent version of apache (2.0.40 is quite\noutdated) and that it's not redhat specific (try searching in their bug-db\nand/or file a bug there).\n\nPerhaps it's a problem within the cron environment (sticter limits).\n\nThanks for using Apache.", "id": 39591, "time": "2003-06-29T16:23:18Z", "bug_id": 21122, "creation_time": "2003-06-29T16:23:18Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 21122, "attachment_id": null, "is_private": false, "id": 40564, "time": "2003-07-13T00:54:00Z", "creator": "chatpert@email.com", "creation_time": "2003-07-13T00:54:00Z", "text": "maybe this is a redhat problem. I have a workaround now. The monitoring program\nused to telnet to port 80, and restart apache httpd if the connection fails, at\nexactly 4:02am, that is also the time when redhat schedules logrotate.\nI changed the monitored program schedule to 4:01am, and this problem has not \nhappened since then."}]