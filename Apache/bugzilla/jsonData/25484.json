[{"attachment_id": null, "tags": [], "creator": "hiran.chaudhuri@softwareag.com", "text": "Apache, once started from command line (apache.exe) cannot be stopped via \ncommand line (apache.exe -k stop).\nThis seems to be connected with bug 14555, but also appears in the most recent \nversion (2.0.48) under Windows XP.\n\nWe need this feature to embed Apache into some other software, which cannot use \napache as a service.", "count": 0, "id": 48990, "time": "2003-12-12T16:53:32Z", "bug_id": 25484, "creation_time": "2003-12-12T16:53:32Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 25484, "text": "Applied same priority and severity as bug 14555.", "id": 49842, "time": "2003-12-30T09:25:15Z", "creator": "hiran.chaudhuri@softwareag.com", "creation_time": "2003-12-30T09:25:15Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "text": "Talking to JanC revealed this bug is not connected with the Win9x bug.\nIn Win9x, the \"apache -k stop\" process hangs completely, while on Win XP\nit says \"There is no apache service running\" and terminates.\n\nJanC suspects from the error message the code only looks for running \nservices, which is certainly not what the docs describe.\n\nKilling Apache using it's PID does not work around this problem, as Apache \nstarts child processes, which are not affected if the main process is killed.\n", "is_private": false, "id": 50165, "creator": "hiran.chaudhuri@softwareag.com", "time": "2004-01-07T09:14:29Z", "bug_id": 25484, "creation_time": "2004-01-07T09:14:29Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 25484, "attachment_id": null, "is_private": false, "id": 75805, "time": "2005-06-02T16:54:01Z", "creator": "eddiearmeen@yahoo.co.uk", "creation_time": "2005-06-02T16:54:01Z", "text": "The -k is only for controlling the apache service ( the code says it is only \nfor dealing with the SCM - i.e. services) and the docs:\n\nhttp://httpd.apache.org/docs-2.0/platform/windows.html\n\nshow that -k is used when running apache as a service.\n\n\nIf you still need to shutdown the process *i know the bug is quite old ;)* you \ncould search through all processes, find each apache process and search the \nparent pids until you get to the top parent then close that first then each of \nthe children (for a hint on getting parent pids look at \nhttp://www.codeproject.com/threads/ParentPID.asp )"}, {"count": 4, "attachment_id": null, "creator": "chip@force-elite.com", "text": "Looks like -k was bring used in the wrong way.", "id": 75881, "time": "2005-06-03T01:44:34Z", "bug_id": 25484, "creation_time": "2005-06-03T01:44:34Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "bug_id": 25484, "attachment_id": null, "text": "So there is no other way to shut down an apache process not running as a service?\nWe cannot just kill all the httpd processes found since there may be several\nservers running on the same machine. Finding out which process tree to kill is\nwhat works marvelous on unix machines - thought that Windows might behave\nsimilar, especially since it was the case with Apache httpd 1.x.\n\nCurrently our workaround is really to kill the process by pid. There is no\nprocess hierarchy as by httpd.conf we tell apache not to spawn child processes,\nso killing the one parent is sufficient. To find the correct PID we keep the\nhandle to the process which is returned by the system call to spawn the apache\nprocess.", "id": 76072, "time": "2005-06-06T15:30:18Z", "creator": "hiran.chaudhuri@softwareag.com", "creation_time": "2005-06-06T15:30:18Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "mike.j.burr@gmail.com", "is_private": false, "count": 6, "id": 94007, "time": "2006-09-22T13:21:46Z", "bug_id": 25484, "creation_time": "2006-09-22T13:21:46Z", "text": "I'm a bit confused.  The referenced docs at:\n\nhttp://httpd.apache.org/docs-2.0/platform/windows.html\n\nshow the \"-k install\", \"-k uninstall\" and \"-k start\" start options only in the\n\"Running Apache as a Service\" section, but list \"-k shutdown/stop\" and \"-k\nrestart\" under BOTH \"Running Apache as a Service\" AND \"Running Apache as a\nConsole Application\".  This would seem to imply that I SHOULD be able to use \"-k\nshutdown\" on an Apache running in a console (as I could in 1.3)."}, {"count": 7, "tags": [], "text": "*** Bug 36556 has been marked as a duplicate of this bug. ***", "is_private": false, "id": 97308, "creator": "wrowe@apache.org", "time": "2006-12-25T22:00:37Z", "bug_id": 25484, "creation_time": "2006-12-25T22:00:37Z", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 25484, "attachment_id": null, "is_private": false, "id": 112009, "time": "2007-12-21T20:14:34Z", "creator": "wrowe@apache.org", "creation_time": "2007-12-21T20:14:34Z", "text": "apache -k stop does not support shutting down a console, and the console\nmode really isn't designed for such things.  httpd is a daemon (a service,\nin windows parlance) so there isn't a large amount of attention paid to it.\n\nSending a control C event to the console will terminate apache.  If you were\nrunning five of them, how do you suppose -k stop would know which to shut down?\n\nIn any case, I agree it's a documentation bug that should be resolved by removing\nthe -k stop from featured \"Running Apache as a Console Application\" options.\n"}, {"count": 9, "tags": [], "text": "We had a deadline that passed long ago & ended up working around this by writing\na trivial .exe that accepts -f and -k command line options (that have the same\nmeaning as the corresponding apache command line options), finds the PidFile\nline in the apache config file, reads the pid file, then calls SetEvent() on the\nevent indicated by the pid and the -k parameter.  It's been awhile, but IIRC the\nmajority of this logic was copied from the code that made this work in 1.3.  I\nlooked at reincorporating this function into the 2.x base, but schedules were\ntight & it was quicker to write a standalone .exe.\n\nAs I said, we worked around this problem long ago so I don't really have a\nstrong interest in how this bug is addressed.  If there is any interest in our\nlittle hack, the company I work for contributes pretty regularly to the Apache\nweb server & I can't imagine they would mind making the source for our simple\n.exe available if I asked.\n\n(In reply to comment #8)\n\n> Sending a control C event to the console will terminate apache.  If you were\n> running five of them, how do you suppose -k stop would know which to shut down?\n\nBy consulting the -f parameter (see description above).", "is_private": false, "id": 112126, "creator": "mike.j.burr@gmail.com", "time": "2007-12-22T19:05:21Z", "bug_id": 25484, "creation_time": "2007-12-22T19:05:21Z", "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 25484, "is_private": false, "text": "Mike,\n\nI concur it's worth fixing; solving it in the MPM isn't really that hard\n(using the pidfile as on unix).  I'll leave this assigned for consideration\nand for want of a patch (that I don't have cycles to write, right now).", "id": 112313, "time": "2007-12-30T21:30:06Z", "creator": "wrowe@apache.org", "creation_time": "2007-12-30T21:30:06Z", "attachment_id": null}, {"count": 11, "tags": [], "bug_id": 25484, "text": "Correct priority in relation to supported uses of httpd/win32.", "id": 112318, "time": "2007-12-30T22:12:18Z", "creator": "wrowe@apache.org", "creation_time": "2007-12-30T22:12:18Z", "is_private": false, "attachment_id": null}, {"count": 12, "tags": [], "bug_id": 25484, "attachment_id": null, "is_private": false, "id": 152967, "time": "2012-01-20T08:31:12Z", "creator": "apache@nobswolf.info", "creation_time": "2012-01-20T08:31:12Z", "text": "still valid\n\ntested on:\n\nWindows 7 Ultimate 64 Bit \nApache 2.2.21\n\nnot conform with released documentation:\n\nhttp://httpd.apache.org/docs/2.2/platform/windows.html#wincons"}]