[{"count": 0, "tags": [], "bug_id": 14493, "text": "I am using an Excel 2000 file. POI works perfectly on a Linux env. When I try \nto use the same thing on a solaris box, it comes back with \"An Invalid Header \nSignature\" Error.", "id": 26161, "time": "2002-11-12T22:30:56Z", "creator": "monica@cicat.com", "creation_time": "2002-11-12T22:30:56Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 14493, "attachment_id": null, "id": 26162, "time": "2002-11-12T22:32:47Z", "creator": "poi-support@buni.org", "creation_time": "2002-11-12T22:32:47Z", "is_private": false, "text": "Does it happen in 1.5.x?  (1.0.2 was a looooong time ago)"}, {"count": 2, "tags": [], "bug_id": 14493, "attachment_id": null, "id": 27082, "time": "2002-11-27T18:55:30Z", "creator": "monica@cicat.com", "creation_time": "2002-11-27T18:55:30Z", "is_private": false, "text": "Happens with 1.5.1 also"}, {"count": 3, "tags": [], "bug_id": 14493, "text": "attach us a file that exhibits this problem.  The minimum amount of code\nnecessary to reproduce it.  Ensure that your file loads in excel (that no one\nhas CR/LF converted it by accident while ftping in ASC mode).  Also try with a\nnightly build to ensure that this isn't a \"default encoding\" problem (which was\nrecently fixed but I can probably give you a workaround for 1.5.1).  Also what\nversion of Solaris?  And I'm asuming this is Soalris Solaris and not x86 Solaris.", "id": 27083, "time": "2002-11-27T19:09:23Z", "creator": "poi-support@buni.org", "creation_time": "2002-11-27T19:09:23Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 14493, "text": "Invalid header signature; read 4547016314657521471, expected -\n2226271756974174256\ngets generated for J2SE v 1.4.1\n\nWorked OK with  J2SE v 1.2.2\n\n \n ", "id": 27899, "time": "2002-12-16T20:14:03Z", "creator": "monica@cicat.com", "creation_time": "2002-12-16T20:14:03Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 14493, "text": "Has anyone else seen this?  This looks like an Endian problem but that makes no\nsense.  Can we see some files/code?", "id": 41295, "time": "2003-07-24T13:46:59Z", "creator": "poi-support@buni.org", "creation_time": "2003-07-24T13:46:59Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "quitejack@hotmail.com", "is_private": false, "count": 6, "id": 47471, "time": "2003-11-17T06:38:44Z", "bug_id": 14493, "creation_time": "2003-11-17T06:38:44Z", "text": "Hi, I got this error while reading a file into POIFSFileSystem by using POI. The\nplatform is Win2000, jdk1.3.1 MS Excel could open this file, but failed with POI\n1.5.1\n\njava.io.IOException: Invalid header signature; read 3546922463590896708, expecte\nd -2226271756974174256\n        at org.apache.poi.poifs.storage.HeaderBlockReader.<init>(HeaderBlockRead\ner.java:124)\n        at org.apache.poi.poifs.filesystem.POIFSFileSystem.<init>(POIFSFileSyste\nm.java:120)\n        at excel2xml.readExcelFilesFromDir(excel2xml.java:54)\n        at excel2xml.main(excel2xml.java:210)"}, {"attachment_id": null, "tags": [], "creator": "avik@apache.org", "is_private": false, "count": 7, "id": 47472, "time": "2003-11-17T06:47:51Z", "bug_id": 14493, "creation_time": "2003-11-17T06:47:51Z", "text": "Nothing has happened on this bug since no files were attached. Nothing is likely\nto happen unless example files are attached. It is not possible to debug a file\nopen problem without seeing the file!"}, {"count": 8, "tags": [], "bug_id": 14493, "is_private": false, "id": 50632, "creation_time": "2004-01-16T04:41:21Z", "time": "2004-01-16T04:41:21Z", "creator": "perry.tew@cibavision.novartis.com", "text": "I encountered this same error.  I was using an excel document as a template for\ngenerating an excel report via the web.  The webserver threw the same exception\nso I copied the template from my build tree to /tmp and stripped down my jsp\npage to a bare essentials java class and it worked. So, I then executed a diff\non my xls file in my build directory and the one deployed by weblogic and they\ndiffered!\n\nI'm using ANT to handle my building and packaging.  I mistakenly added filtering\n to a copy task that included my excel files.  That was enough to corrupt my xls\nfiles.   After splitting out the xls files from the filtered copy task all is well.\n\nWell, I just wanted to comment on my mistake to hopefully help others down the road.\nThanks.", "attachment_id": null}, {"count": 9, "tags": [], "creator": "avik@apache.org", "attachment_id": null, "id": 67132, "time": "2004-11-18T14:58:47Z", "bug_id": 14493, "creation_time": "2004-11-18T14:58:47Z", "is_private": false, "text": "Almost every case of \"Invalid Header Signatures\" that we've seen on the POI\nlists has been due to operator error, feeding the wrong or corrupted file to\nPOI. Examples have included trying to read CSV files, or files getting corrupted\nin webserver response.  Perry Tew's anectode above explains another such\nscenario. This is all the more likely in this bug, as the description talks\nabout code working in one env, and not another. Moreover, no file has been\nattached to this bug, making it impossible to debug. Hence marking invalid. "}, {"attachment_id": 14465, "tags": [], "creator": "abhijat01@yahoo.com", "is_private": false, "count": 10, "id": 72248, "time": "2005-03-11T23:51:19Z", "bug_id": 14493, "creation_time": "2005-03-11T23:51:19Z", "text": "Created attachment 14465\nExcel file that reproduces this bug -  fails when I use HSSFWorkbook \n\nThis file opens when I use Microsoft Excel 2000 (9.0.2720) but fails when I use\nHSSFWorkbook. I  have read issues regarding  xl files being created  using web\nresponses etc. and this indeed is a file which was generated by a web\napplication (and downloaded). However this file opens when I use Microsoft\nExcel 2000."}, {"count": 11, "tags": [], "bug_id": 14493, "attachment_id": 14466, "is_private": false, "id": 72249, "time": "2005-03-11T23:52:41Z", "creator": "abhijat01@yahoo.com", "creation_time": "2005-03-11T23:52:41Z", "text": "Created attachment 14466\nJava code  to use with the Excel file I  attached"}, {"attachment_id": 14465, "tags": [], "bug_id": 14493, "is_private": false, "count": 12, "id": 72250, "time": "2005-03-11T23:55:26Z", "creator": "abhijat01@yahoo.com", "creation_time": "2005-03-11T23:55:26Z", "text": "Comment on attachment 14465\nExcel file that reproduces this bug -  fails when I use HSSFWorkbook \n\njava version used - JDK1.4.2. OS - Linux\npoi file name - \npoi-bin-2.5.1-final-20040804.zip"}, {"count": 13, "tags": [], "bug_id": 14493, "attachment_id": null, "id": 72251, "time": "2005-03-11T23:58:29Z", "creator": "abhijat01@yahoo.com", "creation_time": "2005-03-11T23:58:29Z", "is_private": false, "text": "I have added an xl file that opens in Microsoft Excel 2000 (9.0.2720)  but  \nthrows exception - \n\njava.io.IOException: Invalid header signature; read 8026294563841076540, \nexpected -2226271756974174256\n        at org.apache.poi.poifs.storage.HeaderBlockReader.<init>\n(HeaderBlockReader.java:88)\n        at org.apache.poi.poifs.filesystem.POIFSFileSystem.<init>\n(POIFSFileSystem.java:83)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:210)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:191)\n        at test.msxl.ReadXL.readWB(ReadXL.java:25)\n        at test.msxl.ReadXL.main(ReadXL.java:48)\n\n\nUsing JDK1.4.2  on Linux . \n"}, {"count": 14, "tags": [], "creator": "abhijat01@yahoo.com", "text": "OK.. here is more information The file  is really HTML and NOT XL . . so sorry \nabout all the posts . ", "id": 72259, "time": "2005-03-12T01:38:43Z", "bug_id": 14493, "creation_time": "2005-03-12T01:38:43Z", "is_private": false, "attachment_id": null}]