[{"count": 0, "tags": [], "creator": "edcrane@itzed-solutions.co.uk", "is_private": false, "text": "I am using Jmeter 3.2 via the jmeter-maven-plugin (2.2.0) via jenkins\n\nI'm not sure whether this would be an issue with JMeter or the plugin. But I have to raise an issue on one first and I chose Jmeter.\n\nI have a simple jmx file which reads a single line or data from CSV file (CSV Data Set Config), uses the CSV data to build a SQL query to a DB via JDBC Request and then uses Save Responses to a File to save the data into a filename which is created using the CSV data (identical to the CSV Data used in the SQL query).\n\nThe thread group in the JMX runs 200 threads with a rampup of 1s\n\nI was previously using Jmeter 2.13 via the jmeter-maven-plugin (1.10.1) via jenkins. With this version all of the 200 unique files are always generated.\n\nWhen I switched to Jmeter 3.2 via the jmeter-maven-plugin (2.2.0) I found that not all of the 200 files were created, some were at random skipped. I did some digging in the *.log and found;\n\nCSV Data Set Config opens the config files (based on threadnum) 1-200 as expected\nJDBC Request sends 200 unique queries based on the CSV data as expected\nSave Responses to a File writes 200 files, but some filenames are saved more than once. i.e. instead of filename_10_1,filename_10_2,filename_10_10,filename_10_19 .....etc being saved I get  filename_10_1,filename_10_2,filename_10_2,filename_10_2 .... etc saved. Resulting in a variable number of filenames being created. But less than the 200 expected\n\nSo to debug further I set the rampup to 200 ... so that none of the threads would overlap (DB response is 5-30ms). When slowed down all of the 200 unique filenames are saved.\n\nThis indicates to me that something within the Save Responses to a File is not Thread Safe ... as when the threads run concurrently there are issues .\n\nI am running on Ubuntu 16.04\n\n I couldn't find any issues already covering this fault. If you need further information please let me know", "id": 199334, "time": "2017-06-22T15:11:18Z", "bug_id": 61209, "creation_time": "2017-06-22T15:11:18Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "Created attachment 35068\nTest that shows some errors (might be the ones that this bug is about)\n\nI tried to setup a simple test plan, that shows the described behaviour.\n\nIn this plan, there are 200 threads looping 100 times and doing a java test sample. All of that is listened by the result saver, that saves its results into files that are prefixed by /tmp/test_${__threadNum}_\n\nIn my runs I get a few exceptions, when the filename gets calculated:\n\n2017-06-22 20:23:56,823 ERROR o.a.j.t.ListenerNotifier: Detected problem in Listener.\njava.lang.NullPointerException: null\n>-------at org.apache.jmeter.services.FileServer.resolveBaseRelativeName(FileServer.java:571) ~[ApacheJMeter_core.jar:3.3-SNAPSHOT.20170622]\n>-------at org.apache.jmeter.reporters.ResultSaver.makeFileName(ResultSaver.java:218) ~[ApacheJMeter_core.jar:3.3-SNAPSHOT.20170622]\n>-------at org.apache.jmeter.reporters.ResultSaver.saveSample(ResultSaver.java:185) ~[ApacheJMeter_core.jar:3.3-SNAPSHOT.20170622]\n>-------at org.apache.jmeter.reporters.ResultSaver.processSample(ResultSaver.java:162) ~[ApacheJMeter_core.jar:3.3-SNAPSHOT.20170622]\n>-------at org.apache.jmeter.reporters.ResultSaver.sampleOccurred(ResultSaver.java:152) ~[ApacheJMeter_core.jar:3.3-SNAPSHOT.20170622]\n>-------at org.apache.jmeter.threads.ListenerNotifier.notifyListeners(ListenerNotifier.java:65) [ApacheJMeter_core.jar:3.3-SNAPSHOT.20170622]\n>-------at org.apache.jmeter.threads.JMeterThread.notifyListeners(JMeterThread.java:903) [ApacheJMeter_core.jar:3.3-SNAPSHOT.20170622]\n>-------at org.apache.jmeter.threads.JMeterThread.executeSamplePackage(JMeterThread.java:530) [ApacheJMeter_core.jar:3.3-SNAPSHOT.20170622]\n>-------at org.apache.jmeter.threads.JMeterThread.processSampler(JMeterThread.java:425) [ApacheJMeter_core.jar:3.3-SNAPSHOT.20170622]\n>-------at org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:254) [ApacheJMeter_core.jar:3.3-SNAPSHOT.20170622]\n>-------at java.lang.Thread.run(Thread.java:748) [?:1.8.0_131]\n\nNow I have two questions. First, is this the same bug that itzed reported and second, why is the filename null.", "attachment_id": 35068, "id": 199337, "creator": "felix.schumacher@internetallee.de", "time": "2017-06-22T18:31:00Z", "bug_id": 61209, "creation_time": "2017-06-22T18:31:00Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 61209, "attachment_id": null, "is_private": false, "id": 199338, "time": "2017-06-22T18:32:09Z", "creator": "felix.schumacher@internetallee.de", "creation_time": "2017-06-22T18:32:09Z", "text": "@itzed can you look, if you have exceptions in your jmeter.log file?\nIs the attached test plan like the one you described?"}, {"count": 3, "attachment_id": 35081, "bug_id": 61209, "is_private": false, "id": 199450, "time": "2017-06-27T16:39:19Z", "creator": "edcrane@itzed-solutions.co.uk", "creation_time": "2017-06-27T16:39:19Z", "tags": [], "text": "Created attachment 35081\nExample JMX"}, {"count": 4, "tags": [], "creator": "edcrane@itzed-solutions.co.uk", "attachment_id": null, "text": "Felix,\n\nI took a look and your testplan looks significantly different to mine (see attached example with proprietary info removed)\n\nI think the issues are different.\n\nI saw no exceptions in the log. It is tricky to attach as this also contains proprietary information and would take some time to sanitise.", "id": 199451, "time": "2017-06-27T16:41:36Z", "bug_id": 61209, "creation_time": "2017-06-27T16:41:36Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 61209, "text": "Hello\n@Felix, I am not able to see any issue with result-saver-threads.jmx, what are you seeing ?\n\n@Itzed, in the test plan you attached I see many problems:\n- You use ${__threadNum} in CSV Data Set Config, see http://jmeter.apache.org/usermanual/functions.html#__threadNum\n- You number your files based on your own CSV data, not the number generated by ResultSaver\n\nSo for now , I am closing issue as WORKSFORME as I cannot reproduce issue.\n\nFeel free to reopen with a test plan reproducing issue.\nThanks", "id": 199827, "time": "2017-07-16T14:23:43Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2017-07-16T14:23:43Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 61209, "text": "(In reply to Philippe Mouawad from comment #5)\n> Hello\n> @Felix, I am not able to see any issue with result-saver-threads.jmx, what\n> are you seeing ?\n\nI got null pointer exceptions in jmeter.log as described in #1\n\n> \n> @Itzed, in the test plan you attached I see many problems:\n> - You use ${__threadNum} in CSV Data Set Config, see\n> http://jmeter.apache.org/usermanual/functions.html#__threadNum\n> - You number your files based on your own CSV data, not the number generated\n> by ResultSaver\n> \n> So for now , I am closing issue as WORKSFORME as I cannot reproduce issue.\n> \n> Feel free to reopen with a test plan reproducing issue.\n> Thanks", "id": 199831, "time": "2017-07-16T15:02:25Z", "creator": "felix.schumacher@internetallee.de", "creation_time": "2017-07-16T15:02:25Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "text": "(In reply to Felix Schumacher from comment #6)\n> (In reply to Philippe Mouawad from comment #5)\n> > Hello\n> > @Felix, I am not able to see any issue with result-saver-threads.jmx, what\n> > are you seeing ?\n> \n> I got null pointer exceptions in jmeter.log as described in #1\n\nDo you still get them ?\n> \n> > \n> > @Itzed, in the test plan you attached I see many problems:\n> > - You use ${__threadNum} in CSV Data Set Config, see\n> > http://jmeter.apache.org/usermanual/functions.html#__threadNum\n> > - You number your files based on your own CSV data, not the number generated\n> > by ResultSaver\n> > \n> > So for now , I am closing issue as WORKSFORME as I cannot reproduce issue.\n> > \n> > Feel free to reopen with a test plan reproducing issue.\n> > Thanks", "attachment_id": null, "id": 199832, "creator": "p.mouawad@ubik-ingenierie.com", "time": "2017-07-16T15:06:04Z", "bug_id": 61209, "creation_time": "2017-07-16T15:06:04Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 61209, "text": "(In reply to Philippe Mouawad from comment #7)\n> (In reply to Felix Schumacher from comment #6)\n> > (In reply to Philippe Mouawad from comment #5)\n> > > Hello\n> > > @Felix, I am not able to see any issue with result-saver-threads.jmx, what\n> > > are you seeing ?\n> > \n> > I got null pointer exceptions in jmeter.log as described in #1\n> \n> Do you still get them ?\n\nYes. I tried to run it with \n\n$ ./bin/jmeter -n -t /tmp/result-saver-threads.jmx\n\nAfter the test run I check the created files with\n\n$ ls /tmp/test_* | wc -l\n\nIf there are not 20.000 files, than there should be an exception in jmeter.log like the following:\n\nERROR o.a.j.t.ListenerNotifier: Detected problem in Listener.\njava.lang.NullPointerException: null\n>-------at org.apache.jmeter.services.FileServer.resolveBaseRelativeName(FileServer.java:571) ~[ApacheJMeter_core.jar:3.3-SNAPSHOT.20170716]\n>-------at org.apache.jmeter.reporters.ResultSaver.makeFileName(ResultSaver.java:218) ~[ApacheJMeter_core.jar:3.3-SNAPSHOT.20170716]\n>-------at org.apache.jmeter.reporters.ResultSaver.saveSample(ResultSaver.java:185) ~[ApacheJMeter_core.jar:3.3-SNAPSHOT.20170716]\n>-------at org.apache.jmeter.reporters.ResultSaver.processSample(ResultSaver.java:162) ~[ApacheJMeter_core.jar:3.3-SNAPSHOT.20170716]\n>-------at org.apache.jmeter.reporters.ResultSaver.sampleOccurred(ResultSaver.java:152) ~[ApacheJMeter_core.jar:3.3-SNAPSHOT.20170716]\n>-------at org.apache.jmeter.threads.ListenerNotifier.notifyListeners(ListenerNotifier.java:65) [ApacheJMeter_core.jar:3.3-SNAPSHOT.20170716]\n>-------at org.apache.jmeter.threads.JMeterThread.notifyListeners(JMeterThread.java:903) [ApacheJMeter_core.jar:3.3-SNAPSHOT.20170716]\n>-------at org.apache.jmeter.threads.JMeterThread.executeSamplePackage(JMeterThread.java:530) [ApacheJMeter_core.jar:3.3-SNAPSHOT.20170716]\n>-------at org.apache.jmeter.threads.JMeterThread.processSampler(JMeterThread.java:425) [ApacheJMeter_core.jar:3.3-SNAPSHOT.20170716]\n>-------at org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:254) [ApacheJMeter_core.jar:3.3-SNAPSHOT.20170716]\n>-------at java.lang.Thread.run(Thread.java:748) [?:1.8.0_131]", "id": 199834, "time": "2017-07-16T15:30:05Z", "creator": "felix.schumacher@internetallee.de", "creation_time": "2017-07-16T15:30:05Z", "is_private": false, "attachment_id": null}]