[{"count": 0, "tags": [], "creator": "gooyozh@gmail.com", "attachment_id": 28953, "is_private": false, "id": 160070, "time": "2012-06-18T08:28:14Z", "bug_id": 53432, "creation_time": "2012-06-18T08:28:14Z", "text": "Created attachment 28953\nTest case, slightly modified snippet for adding an image from \"quick guide\".\n\nAttached is the code to reproduce exception. This is basically snippet from \"Busy developers' guide\" to add a picture except that saving workbook part is skipped, instead there is a call to wb.getAllPictures() which throws NullPointerException:\n\njava.lang.NullPointerException\n\tat org.apache.poi.hssf.record.AbstractEscherHolderRecord.decode(AbstractEscherHolderRecord.java:261)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.getAllPictures(HSSFWorkbook.java:1639)\n\tat ExcelImageNpeTest.test(ExcelImageNpeTest.java:46)\n\nThis also happens if instead of creating a workbook you open existing one without any images inside, add image and call getAllPictures(). \nThis does not happen when opening a workbook without images and calling getAllPictures() without adding an image. \nThis does not happen when opening a workbook with images inside and adding a new one (but getAllPictures().size() will return previous number of images, i.e. will not take into account just added one).\n\nAlso happens with PNG images.\nDoes not happen with XSSF workbook.\n\nTested with 3.8 and build 20120613 from Jenkins."}, {"count": 1, "tags": [], "creator": "superrubiroyd@gmail.com", "attachment_id": null, "is_private": false, "id": 161414, "time": "2012-08-15T09:07:27Z", "bug_id": 53432, "creation_time": "2012-08-15T09:07:27Z", "text": "This problem should be fixed in trunk.\n\nPlease try with a nightly build - see download links on http://poi.apache.org/\nor build yourself from SVN trunk, see http://poi.apache.org/subversion.html"}, {"count": 2, "tags": [], "text": "Build 3.9-beta1-20120815 works for me. Thanks!", "is_private": false, "id": 161417, "creation_time": "2012-08-15T09:33:36Z", "time": "2012-08-15T09:33:36Z", "creator": "gooyozh@gmail.com", "bug_id": 53432, "attachment_id": null}]