[{"count": 0, "tags": [], "text": "Hy Folks,\n\nI'm working on a project with Oracle as well MS-SQLServer. My webcontainer is \ntomcat 4.0.4.\nUsing the RDBMSRealm via Oracle-JDBC-Driver with the oracle database\nis no problem.\nBut if i switch to RDBMSRealm with the \"Microsoft SQL Server 2000 Driver for\nJDBC\" there is no connect via Realm possible.\n\nThe error is as follows:\njava.sql.SQLException:\n[Microsoft][SQLServer 2000 Driver for JDBC]\ncan't open clone connection because you are in implicit Transactionmode.\n\n\nI guess the reason is in the source tomcat4.0.4-class package\n\"org.apache.catalina.realm.JNDIRealm\" in line 549 where the autocommit is set \nto FALSE. \nThere are two security-check prepeared-SELECT-statements with no \"stmt.close\n();\" in between. (normally OK...)\n\nThe first prepeared-SELECT-Statement works, the second doesn't.\nThe SQLServer is in implicit Transactionmode and in that way (with prepared-\nStatements) it can't work, \nbecause there is an explicit commit (autocommit(true)) or a stmt.close() \nnecessary. If i try the same\nwith NOTprepared Statements it works also.\n\n\nthank you", "is_private": false, "id": 21582, "creator": "stefan.rutenkolk@fiprox.com", "time": "2002-08-23T10:05:35Z", "bug_id": 11964, "creation_time": "2002-08-23T10:05:35Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 11964, "attachment_id": null, "is_private": false, "id": 21588, "time": "2002-08-23T11:52:16Z", "creator": "andrewconrad@iname.com", "creation_time": "2002-08-23T11:52:16Z", "text": "This is not a bug in Tomcat, but rather a shortcoming with the default \nparameters of the driver; they fail when autocomit is false;\n\nchange your connection url to include  SelectMethod=cursor and look in \nMicrosoft's JDBC Driver Documentation for a better explanation to SelectMethod\n\nexample url: \njdbc:microsoft:sqlserver://localhost:1433;SelectMethod=cursor\n(note the comma after the port)"}]