[{"count": 0, "tags": [], "bug_id": 20219, "attachment_id": null, "id": 37758, "time": "2003-05-25T01:05:23Z", "creator": "james@squish.net", "creation_time": "2003-05-25T01:05:23Z", "is_private": false, "text": "Enclosed is a patch for mod_jk to give Apache 1.3 an additional string for \ndisplaying in standard 500 error messages when Tomcat cannot be contacted.\n\nI'm certain that the function below could be used in mod_jk2 and that Apache 2 \ncan't be much different.\n\nThe message reads \"The mod_jk connector was unable handle the request for \n<URI>.  This may mean an application server could not be contacted to service \nthis request. Please try again later.\"\n\nThis is much better than the average \"internal server error\", especially for \nsystem administrators who have to administer other user's Tomcat instances.\n\n--- jk/native/apache-1.3/mod_jk.c.orig  Mon Sep 23 10:24:34 2002\n+++ jk/native/apache-1.3/mod_jk.c       Thu Oct  3 19:32:18 2002\n@@ -1490,6 +1490,23 @@\n     {NULL}\n };\n\n+static int jk_error(request_rec *r)\n+{\n+    ap_table_setn(r->notes, \"error-notes\", ap_pstrcat(r->pool,\n+        \"<p>The mod_jk connector was unable handle the request for \",\n+        \"<em><a href=\\\"\", ap_escape_uri(r->pool, r->uri), \"\\\">\",\n+        ap_escape_html(r->pool, r->uri), \"</a></em></p>\\n\",\n+        \"<p>This may mean an application server could not be contacted to \"\n+        \"service this request. Please try again later.\", NULL));\n+\n+    /* Allow \"error-notes\" string to be printed by ap_send_error_response() */\n+    ap_table_setn(r->notes, \"verbose-error-to\", ap_pstrdup(r->pool, \"*\"));\n+\n+    r->status_line = ap_psprintf(r->pool, \"%3.3u mod_jk error\",\n+                                 HTTP_INTERNAL_SERVER_ERROR);\n+    return HTTP_INTERNAL_SERVER_ERROR;\n+}\n+\n /* ====================================================================== */\n /* The JK module handlers                                                 */\n /* ====================================================================== */\n@@ -1591,7 +1607,7 @@\n         }\n     }\n\n-    return HTTP_INTERNAL_SERVER_ERROR;\n+    return jk_error(r);\n }\n\n /*"}, {"count": 1, "tags": [], "bug_id": 20219, "attachment_id": null, "id": 59517, "time": "2004-06-18T18:43:24Z", "creator": "markt@apache.org", "creation_time": "2004-06-18T18:43:24Z", "is_private": false, "text": "This component is now deprecated. If you still experience this issue, please \nupgrade to the Coyote JK2 connector.\n\nNo further work will take place against this bug report.\n\n"}]