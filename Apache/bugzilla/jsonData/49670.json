[{"count": 0, "tags": [], "bug_id": 49670, "attachment_id": null, "is_private": false, "id": 138739, "time": "2010-07-29T10:43:35Z", "creator": "chornsey@hotmail.com", "creation_time": "2010-07-29T10:43:35Z", "text": "I have two web applications; neither declare a realm in the context.xml and both are configured for authentication in the web.xml using standard tomcat authentication methods.  I have enabled the tomcat valve in the host and have added a realm to the host as well.\n\n      <Host name=\"localhost\"  appBase=\"webapps\" unpackWARs=\"true\" autoDeploy=\"true\">\n      \t<Realm className=\"org.apache.catalina.realm.JAASRealm\" appName=\"SSO\" userClassNames=\"a.b.c\" roleClassNames=\"a.b.c\" useContextClassLoader=\"false\"/>\n        <!-- SingleSignOn valve, share authentication between web applications\n             Documentation at: /docs/config/valve.html -->\n        <Valve className=\"org.apache.catalina.authenticator.SingleSignOn\"/>\n        <!-- Access log processes all example.\n             Documentation at: /docs/config/valve.html -->\n        <!--\n        <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"  \n               prefix=\"localhost_access_log.\" suffix=\".txt\" pattern=\"common\" resolveHosts=\"false\"/>\n        -->\n\nI have added a jaas configuration for the SSO app in the jaas.conf file for the server.  I am certain that the realm, jaas.conf are all configured properly as the web applications do require a user to authenticate before accessing the application, but if I have authenticated to one application I still am required to authenticate before accessing the other application.\n\nI have this exact same configuration working on a tomcat 6 environment, but an identical configuration will not operate on a tomcat 7 server."}, {"count": 1, "text": "Can you provide a simple test case which demonstrates the problem?", "creator": "pidster@apache.org", "is_private": false, "id": 138835, "time": "2010-08-03T05:47:07Z", "bug_id": 49670, "creation_time": "2010-08-03T05:47:07Z", "tags": [], "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 49670, "attachment_id": 25879, "id": 139060, "time": "2010-08-11T23:14:16Z", "creator": "chornsey@hotmail.com", "creation_time": "2010-08-11T23:14:16Z", "is_private": false, "text": "Created attachment 25879\nFirst participating war file.\n\nPlease add the jaas.jar file from this project o you tomcat/lib folder as i contains the jaas principal and login module implementation."}, {"count": 3, "tags": [], "bug_id": 49670, "is_private": false, "text": "Created attachment 25880\nSecond participating web appliaction.", "id": 139061, "time": "2010-08-11T23:14:56Z", "creator": "chornsey@hotmail.com", "creation_time": "2010-08-11T23:14:56Z", "attachment_id": 25880}, {"count": 4, "tags": [], "bug_id": 49670, "attachment_id": 25881, "id": 139062, "time": "2010-08-11T23:16:18Z", "creator": "chornsey@hotmail.com", "creation_time": "2010-08-11T23:16:18Z", "is_private": false, "text": "Created attachment 25881\nThe tomcat jaas configuration file used on the test server."}, {"count": 5, "tags": [], "bug_id": 49670, "is_private": false, "id": 139063, "creation_time": "2010-08-11T23:17:43Z", "time": "2010-08-11T23:17:43Z", "creator": "chornsey@hotmail.com", "text": "Created attachment 25882\nserver.xml with sso valve enabled.", "attachment_id": 25882}, {"count": 6, "tags": [], "bug_id": 49670, "attachment_id": 25883, "id": 139064, "time": "2010-08-11T23:21:31Z", "creator": "chornsey@hotmail.com", "creation_time": "2010-08-11T23:21:31Z", "is_private": false, "text": "Created attachment 25883\neclipse jaas implementation project zipped.\n\nThis is the zipped eclipse project for all of the jaas files.  Includes the source for the login module and principals."}, {"count": 7, "tags": [], "bug_id": 49670, "is_private": false, "id": 139065, "creation_time": "2010-08-11T23:23:54Z", "time": "2010-08-11T23:23:54Z", "creator": "chornsey@hotmail.com", "text": "I have added two war files, he server configuration, jaas configuration and the source code for the jaas implementation I used in this test case.\n\nAccessing the first web app requires a log in.  Accessing the second app does not require a login.  Using this test case in 6.x requires a login when accessing app 1, but not on the subsequent request for app2.", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 49670, "attachment_id": null, "id": 139391, "time": "2010-08-23T16:16:42Z", "creator": "markt@apache.org", "creation_time": "2010-08-23T16:16:42Z", "is_private": false, "text": "Sorry about that. I broke SSO when I did the Lifecycle refactoring for 7.0.x\n\nI have fixed this in trunk and it will be included in 7.0.3 onwards."}]