[{"attachment_id": null, "tags": [], "bug_id": 59229, "text": "https://tomcat.apache.org/tomcat-7.0-doc/config/http.html\n\nIt says NIO connector is blocking for reading http request, actually it is non-blocking.", "count": 0, "id": 189694, "time": "2016-03-24T05:57:53Z", "creator": "huxing.zhang@gmail.com", "creation_time": "2016-03-24T05:57:53Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 59229, "text": "This used to be described as \"sim-blocking\" but evidently that caused confusion.\n\nBecause the servlet API is stream-based, the behavior of request/response read/write is always effectively \"blocking\" -- at least as far as the application is concerned. The request-processing thread will be tied-up waiting for the read/write request to complete before returning to the servlet.\n\nSo even though non-blocking IO is being used under the covers, the application isn't using a non-blocking API to make IO requests. That's why the description is \"blocking\" in that table.", "count": 1, "id": 189705, "time": "2016-03-24T12:52:49Z", "creator": "chris@christopherschultz.net", "creation_time": "2016-03-24T12:52:49Z", "is_private": false}, {"count": 2, "tags": [], "creator": "huxing.zhang@gmail.com", "text": "Hi,\n\nI understand what you mean, but the following documentation are all saying that NIO connector is Non-blocking when reading request:\n\nhttps://tomcat.apache.org/tomcat-9.0-doc/config/http.html\nhttps://tomcat.apache.org/tomcat-8.0-doc/config/http.html\nhttps://tomcat.apache.org/tomcat-6.0-doc/config/http.html\n\nAt least they should keep consistent.", "id": 189706, "time": "2016-03-24T13:00:05Z", "bug_id": 59229, "creation_time": "2016-03-24T13:00:05Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "chris@christopherschultz.net", "is_private": false, "text": "Aah, yes, sorry. I didn't read the description carefully enough. Specifically, reading the \"Request\" (that is, specifically, the request-line of the HTTP request) is in fact non-blocking. I think that extends to the HTTP headers as well.\n\nBut it doesn't extend to the request body.", "id": 189707, "time": "2016-03-24T13:08:55Z", "bug_id": 59229, "creation_time": "2016-03-24T13:08:55Z", "attachment_id": null}, {"count": 4, "tags": [], "text": "Yes, I mean the description is wrong about non-blocking for reading http request line (request header).", "is_private": false, "id": 189708, "creator": "huxing.zhang@gmail.com", "time": "2016-03-24T13:14:21Z", "bug_id": 59229, "creation_time": "2016-03-24T13:14:21Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 59229, "attachment_id": 33703, "is_private": false, "id": 189709, "time": "2016-03-24T13:37:17Z", "creator": "huxing.zhang@gmail.com", "creation_time": "2016-03-24T13:37:17Z", "text": "Created attachment 33703\nPatch to fix the wrong description about NIO connector"}, {"count": 6, "attachment_id": null, "bug_id": 59229, "is_private": false, "id": 189710, "time": "2016-03-24T13:50:04Z", "creator": "huxing.zhang@gmail.com", "creation_time": "2016-03-24T13:50:04Z", "tags": [], "text": "This seems to be a regression, which is introduced by the following commit:\n\nhttps://github.com/apache/tomcat70/commit/b0b4cfff188c5fe4d5a78ea995a1ace3a72f6c65\n\nOh I forgot the AJP part in my patch, will update it later."}, {"count": 7, "tags": [], "creator": "huxing.zhang@gmail.com", "text": "Created attachment 33704\nPatch to fix the wrong description about HTTP/AJP NIO connector", "id": 189711, "time": "2016-03-24T13:53:54Z", "bug_id": 59229, "creation_time": "2016-03-24T13:53:54Z", "is_private": false, "attachment_id": 33704}, {"count": 8, "tags": [], "creator": "huxing.zhang@gmail.com", "is_private": false, "text": "I think the documentation in AJP is more clear. In webapps/docs/config/ajp.xml it says,  \"Read Request Headers\" is Non Blocking. In webapps/docs/config/http.xml it says, \"Read HTTP Request\" is Non Blocking. HTTP Request includes header and body, so I think specifying \"Read HTTP Request Headers\" is more accurate.", "id": 189712, "time": "2016-03-24T14:00:05Z", "bug_id": 59229, "creation_time": "2016-03-24T14:00:05Z", "attachment_id": null}, {"count": 9, "tags": [], "creator": "markt@apache.org", "text": "Thanks for the report and for digging out the commit that introduced the error.\n\nNote: AJP IS blocking for all connectors for Request Headers and Request Bodies.\n\nI've corrected the HTTP docs for 7.0.x and improved the row titles for 7.0x through 9.0.x.", "id": 189830, "time": "2016-03-30T11:02:16Z", "bug_id": 59229, "creation_time": "2016-03-30T11:02:16Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "creator": "huxing.zhang@gmail.com", "text": "Thanks for clarifying AJP is blocking for NIO connector for reading http headers and request. \nMy bad not digging into the AJP code. I will take care from next time.", "id": 189851, "time": "2016-03-31T00:19:31Z", "bug_id": 59229, "creation_time": "2016-03-31T00:19:31Z", "is_private": false, "attachment_id": null}]