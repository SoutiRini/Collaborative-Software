[{"count": 0, "tags": [], "bug_id": 46331, "attachment_id": null, "text": "When a custom condition is implemented (Condition interface), there is no direct way to get the related Ant Task.\nThis is useful - for logging purpose - to link a logged message to the related task.\n\nIn the example below, I want to associated the message logged in the Groovy script to the waitfor task, because I use XmlLogger to generate my report and the message must be associated to the task XML element to be properly displayed in the HTML report.\nThe workaround consists in setting an id to the waitfor task to be able to get them through project references.\nBut, I've read in Ant manual that setting an id for task won't be supported in Ant future versions:\nhttp://ant.apache.org/manual/using.html#tasks\n\nExample (and workaround):\n        <waitfor maxwait=\"${maxwait}\" maxwaitunit=\"${maxwait.unit}\"\n                 checkevery=\"${checkevery}\" checkeveryunit=\"${checkevery.unit}\"\n                 timeoutproperty=\"DataInsWaitDvAvailable.timeout\"\n                 id=\"DataInsWaitDvAvailable_waitfor\">\n            <scriptcondition language=\"groovy\" value=\"false\">\n                import groovy.sql.Sql\n\n                def sql = Sql.newInstance(\n                    \"jdbc:oracle:thin:${dbUrl}\",\n                    \"${dbUserViewer}\", \"${dbUserViewerPassword}\",\n                    \"oracle.jdbc.driver.OracleDriver\")\n\n                def fields = []\n                def row = sql.firstRow(\"${sqlQuery}\", fields)\n                def task = project.references.DataInsWaitDvAvailable_waitfor\n\n                project.log(task, \"Count=${row[0]} (expected=${expectedCount})\", project.MSG_INFO)\n\n                if (row[0] == (expectedCount as Integer)) {\n                    self.setValue(true);\n                } else {\n                    self.setValue(false);\n                }\n            </scriptcondition>\n        </waitfor>", "id": 123037, "time": "2008-12-03T03:36:22Z", "creator": "gdelalondre@infovista.com", "creation_time": "2008-12-03T03:36:22Z", "is_private": false}]