[{"count": 0, "tags": [], "bug_id": 10563, "attachment_id": null, "id": 19126, "time": "2002-07-08T18:15:53Z", "creator": "gregw@mortbay.org", "creation_time": "2002-07-08T18:15:53Z", "is_private": false, "text": "If multiple requests are presented for the same JSP at the same time, then\nmultiple instances of org.apache.jasper.compiler.JspCompiler are created and\nmultiple javac compilations are started at the same time.\n\nWhile this eventually gives the correct results, it can make start up of a\nJSP site very slow in the presences of live traffic (and the user is JspC\nresistant for some unknown reason?)\n\nI have tested a simple fix of synchronizing on a static in\norg.apache.jasper.compiler.Compiler.compile:\n\n        if (!isOutDated())\n            return false;\n        synchronized(Compiler.class)\n        {\n            if (!isOutDated())\n                return false;\n\n\nand it appears to work OK - but may not be optimal?"}, {"count": 1, "tags": [], "bug_id": 10563, "attachment_id": null, "is_private": false, "id": 19354, "time": "2002-07-11T20:07:21Z", "creator": "H.Zeller@acm.org", "creation_time": "2002-07-11T20:07:21Z", "text": "Probably better in JspCompilationContext, since there is the place, where \nthe isOutDated() is checked. And: it should be synchronized with the \njspCompiler object, not the Compiler.class, since this would serialize \ncompilation completely; synchronizing the compiler will only serialize \nattempts to compile the same file. \n----------[ from JspCompilationContext.compile() ] -- \n   if (jspCompiler.isOutDated()) { \n            try { \n\t\tsynchronized (jspCompiler) { \n\t\t    if (jspCompiler.isOutDated()) { \n\t\t\tjspCompiler.compile(); \n\t\t\treload = true; \n\t\t    } \n\t\t} \n            } catch (Exception ex) { \n                //.... \n            } \n        } \n------- "}, {"count": 2, "tags": [], "creator": "gregw@mortbay.org", "is_private": false, "text": "Oops - I raised this against jasper2, it was meant to be against normal jasper.", "id": 21435, "time": "2002-08-21T10:19:01Z", "bug_id": 10563, "creation_time": "2002-08-21T10:19:01Z", "attachment_id": null}, {"count": 3, "attachment_id": null, "bug_id": 10563, "is_private": false, "id": 50292, "time": "2004-01-08T23:48:01Z", "creator": "medthomas@ntlworld.com", "creation_time": "2004-01-08T23:48:01Z", "tags": [], "text": "\n\n*** This bug has been marked as a duplicate of 14077 ***"}]