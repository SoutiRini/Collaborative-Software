[{"count": 0, "tags": [], "text": "I have to write data more than 70 columns and 40K rows. \nAfter some no of columns CellStyle is not applying for entire column.\nWhat i am doing is i am preparing one CellStyle per one column, while writing to data i am applying cellstyle to each cell.\nMy code is as follows.\n    HSSFWorkbook workbook = new HSSFWorkbook();\n    HSSFWorkbook workbook = new HSSFWorkbook();\n    Sheet sheet = null;\n    Row row = null;\n    Cell cell = null;\n    CellStyle[] cellStyle = new CellStyle[noofcolumnscount];\n\n            cellStyle[colcount] = workbook.createCellStyle();\n            cellStyle[colcount].setFont(dataFont);\n            if (rptDetailsBean.getColumnDataType() != null && (\"NUMBER\".equalsIgnoreCase(rptDetailsBean.getColumnDataType()) || \"CURRENCY\".equalsIgnoreCase(rptDetailsBean.getColumnDataType()))) {\n              cellStyle[colcount].setAlignment(HSSFCellStyle.ALIGN_RIGHT);\n            } else {\n              cellStyle[colcount].setAlignment(HSSFCellStyle.ALIGN_LEFT);\n            }\n            if (rptDetailsBean != null && rptDetailsBean.getFormat() != null) {\n              if (!isFormatValid(rptDetailsBean.getFormat(), rptDetailsBean.getColumnDataType())) {\n                throw new java.lang.Exception(\"Format at \" + (colcount) + \"is not valid\");\n              }\n              cellStyle[colcount].setDataFormat(createHelper.createDataFormat().getFormat(rptDetailsBean.getFormat()));\n            }\ni am applying style while writing each cell while looping trough resultset\n\ncell = row.createCell(colcount);\n              int dataLength = 15;\n              if (\"DATE\".equalsIgnoreCase(rptDetailsBean.getColumnDataType())) {\n                if (rs.getTimestamp(selectClause) != null) {\n                  cell.setCellValue(rs.getTimestamp(selectClause));\n                  cell.setCellStyle(cellStyle[colcount]);\n                } else {\n                  cell.setCellValue(\"\");\n                  cell.setCellStyle(cellStyle[colcount]);\n                }\n              } else {\n                if (\"NUMBER\".equalsIgnoreCase(rptDetailsBean.getColumnDataType()) || \"CURRENCY\".equalsIgnoreCase(rptDetailsBean.getColumnDataType())) {\n                  if ((Double) rs.getDouble(selectClause) != null && !rs.wasNull())       {\n                    cell.setCellValue(rs.getDouble(selectClause));\n                    cell.setCellStyle(cellStyle[colcount]);\n                  } else {\n                    cell.setCellValue(\"\");\n                    cell.setCellStyle(cellStyle[colcount]);\n                  }\n                } else {\n                  if (rs.getString(selectClause) != null) {\n                    dataLength = rs.getString(selectClause).length();\n                    cell.setCellValue(rs.getString(selectClause));\n                    cell.setCellStyle(cellStyle[colcount]);\n                  } else {\n                    cell.setCellValue(\"\");\n                    cell.setCellStyle(cellStyle[colcount]);\n                  }\n                }\n              }\n\nCan you help in this.", "is_private": false, "bug_id": 57426, "id": 180227, "time": "2015-01-08T11:06:18Z", "creator": "srinu.ydlp@gmail.com", "creation_time": "2015-01-08T11:06:18Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "Created attachment 32357\nsample", "is_private": false, "bug_id": 57426, "id": 180228, "time": "2015-01-08T11:10:05Z", "creator": "srinu.ydlp@gmail.com", "creation_time": "2015-01-08T11:10:05Z", "attachment_id": 32357}, {"count": 2, "tags": [], "bug_id": 57426, "attachment_id": 32454, "is_private": false, "id": 180952, "time": "2015-02-11T12:21:02Z", "creator": "p50p100@yahoo.co.jp", "creation_time": "2015-02-11T12:21:02Z", "text": "Created attachment 32454\nThe result that I edit sample excel book to look cell value type.\n\nWhat column is invalid? I see that the alignment of NUMBER type is right."}, {"count": 3, "tags": [], "bug_id": 57426, "attachment_id": null, "id": 181414, "time": "2015-03-01T18:32:04Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-03-01T18:32:04Z", "is_private": false, "text": "I tried to reproduce this with a simple test, but couldn't. Any chance you can create a self-contained unit-test which does not rely on any other code or variables? \n\nAlso we have version 3.11 and 3.12-beta1 available with a number of fixes, can you verify that it still happens with those versions?\n\nThis will make it much easier to reproduce and look for a possible fix."}, {"count": 4, "text": "No response for some time, therefore resolving this for now, please reopen with the additional information described in the previous comment if this is still a problem for you with the latest version of POI.", "creator": "dominik.stadler@gmx.at", "is_private": false, "id": 183666, "time": "2015-06-20T21:31:11Z", "bug_id": 57426, "creation_time": "2015-06-20T21:31:11Z", "tags": [], "attachment_id": null}]