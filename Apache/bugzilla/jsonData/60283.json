[{"count": 0, "tags": [], "bug_id": 60283, "attachment_id": null, "is_private": false, "id": 194578, "time": "2016-10-20T13:24:23Z", "creator": "etornam.banini@cerner.com", "creation_time": "2016-10-20T13:24:23Z", "text": "Hi,\n\nWhen downloading a large file from using rails, Phusion Passenger 5.0.18 and Apache 2.2.15 the thread size will continue to grow the longer the download takes. We are using this code:\n\n    path = '/home/data/test.tar.gz'\n    pack_content_type = 'application/octet-stream'\n    send_file path, :type => pack_content_type, :x_sendfile=>true\n\n\nA number of file sizes have been tested and have found the larger the file, the larger the httpd thread grows.\nie: 50 GB file => 2 GB httpd thread size\n    80 GB file => 3.2 GB httpd thread size\n\nThe downloads are done on a Red Hat 6.6 node and the behaviour/size is consistant for every download."}, {"count": 1, "tags": [], "bug_id": 60283, "attachment_id": null, "is_private": false, "id": 194579, "time": "2016-10-20T13:29:58Z", "creator": "covener@gmail.com", "creation_time": "2016-10-20T13:29:58Z", "text": "Sounds like a potential passenger bug. If all of the rails/passenger stuff is not necessary for the memory growth, please show a basic configuration and memory growth observations for a static file."}, {"count": 2, "tags": [], "creator": "etornam.banini@cerner.com", "text": "(In reply to Eric Covener from comment #1)\n> Sounds like a potential passenger bug. If all of the rails/passenger stuff\n> is not necessary for the memory growth, please show a basic configuration\n> and memory growth observations for a static file.\n\nWe have looked into it from the passenger side and have determined that passenger is not the cause of the memory issue. We are using a simple rails app to download a static file from one folder and write it elsewhere. We are using a simple curl to initiate the download. \n\nFile size(GB) |  Thread size\n    10        |   ~1\n    20        |    1.5\n    50        |    2\n    80        |    3.2\n    100       |    4", "id": 194580, "time": "2016-10-20T13:53:16Z", "bug_id": 60283, "creation_time": "2016-10-20T13:53:16Z", "is_private": false, "attachment_id": null}]