[{"attachment_id": null, "tags": [], "bug_id": 56649, "text": "The following code has concurrent issue.\n\nJspCompilationContext ctxt = compiler.getCompilationContext();\n        JspRuntimeContext rctxt = ctxt.getRuntimeContext();\n\n        synchronized (rctxt) {\n            JspServletWrapper wrapper = rctxt.getWrapper(wrapperUri);\n\nIn case when multiple org.apache.jasper.servlet.JspServlet are registered\nin web.xml, distict JspCompilationContext will be used for each\nservlet mappings.\n\nFor instance, if there are two jspServlets a and b registered in web.xml,\na's compilation of a tag file won't be protected from b's encounter.", "count": 0, "id": 175921, "time": "2014-06-20T05:35:17Z", "creator": "howeverking@gmail.com", "creation_time": "2014-06-20T05:35:17Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 56649, "attachment_id": null, "text": "Correction:\n-->\nIn case when multiple org.apache.jasper.servlet.JspServlet are registered\nin web.xml, **distinct JspRuntimeContext** will be used for each\nservlet mappings.", "id": 175922, "time": "2014-06-20T05:52:06Z", "creator": "howeverking@gmail.com", "creation_time": "2014-06-20T05:52:06Z", "is_private": false}, {"count": 2, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 175927, "time": "2014-06-20T09:20:44Z", "bug_id": 56649, "creation_time": "2014-06-20T09:20:44Z", "is_private": false, "text": "The JSP servlet is not designed to support more than one instance per web application. Before this gets resolved as invalid (possibly with an update to the docs to make the single instance point clear) what is your use case for configuring more than one JSP servlet?"}, {"count": 3, "tags": [], "bug_id": 56649, "attachment_id": null, "text": "If there are several JspServlet instances, it is possible to configure them to write to different directories, so that there is no conflict.\n\n// EmbeddedServletOptions.java\nString dir = config.getInitParameter(\"scratchdir\");\n\n\nIf there are several JspServlet instances, each one will have its own copy of a Tag (loaded by a different class loader).", "id": 175935, "time": "2014-06-20T16:09:39Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2014-06-20T16:09:39Z", "is_private": false}, {"count": 4, "tags": [], "creator": "howeverking@gmail.com", "text": "(In reply to Mark Thomas from comment #2)\n> The JSP servlet is not designed to support more than one instance per web\n> application. Before this gets resolved as invalid (possibly with an update\n> to the docs to make the single instance point clear) what is your use case\n> for configuring more than one JSP servlet?\n\n\ndifferent Jsp options to be applied to different url-mappings.\n(for instance, an option like genStringAsCharArray to be applied to\nto specific Jsps with a large String)\n\nallowing to register multiple Jsps will give users an impression that\nconfiguring as above is possible.\n\nWhat about throwing an exception when multiple JspServlets are registered\nin web.xml to make it clear that multiple Jsps are not allowed?", "id": 176058, "time": "2014-06-26T04:24:04Z", "bug_id": 56649, "creation_time": "2014-06-26T04:24:04Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "markt@apache.org", "text": "Konstantin is right. Dedicated scratch directories should take care of this. I should have realised that the original Jasper developers would have thought of this. If separate directories doesn't address this, please feel free to re-open, explain what the problem is and we'll take another look.", "id": 176214, "time": "2014-07-04T19:28:30Z", "bug_id": 56649, "creation_time": "2014-07-04T19:28:30Z", "is_private": false, "attachment_id": null}]