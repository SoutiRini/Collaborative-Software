[{"attachment_id": null, "tags": [], "bug_id": 52142, "is_private": false, "count": 0, "id": 151227, "time": "2011-11-05T20:06:31Z", "creator": "suresh54145@gmail.com", "creation_time": "2011-11-05T20:06:31Z", "text": "I am able to open the excel 2007 but when I protect it with structure locking..I am not able to open it. I am using poi-3.8.beta4.\n\nI dont think something is wrong with excel sheet.\n\nCode:\n\n XSSFWorkbook workbook=null;\n\t\t\tInputStream inputStream = null;\n\n\t\t\t\tinputStream = new FileInputStream(new File(\"G:\\\\test.xlsx\"));\n\n\t\t\tworkbook=\t new XSSFWorkbook(inputStream);\n\n\nError:\n\n\nException in thread \"main\" org.apache.poi.POIXMLException: org.apache.poi.openxml4j.exceptions.InvalidFormatException: Package should contain a content type part [M1.13]\n\tat org.apache.poi.util.PackageHelper.open(PackageHelper.java:41)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:178)\n\tat com.poi.xssf.XSSFWorkBook.main(XSSFWorkBook.java:97)\nCaused by: org.apache.poi.openxml4j.exceptions.InvalidFormatException: Package should contain a content type part [M1.13]\n\tat org.apache.poi.openxml4j.opc.ZipPackage.getPartsImpl(ZipPackage.java:148)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.getParts(OPCPackage.java:615)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.open(OPCPackage.java:229)\n\tat org.apache.poi.util.PackageHelper.open(PackageHelper.java:39)\n\t... 2 more"}, {"count": 1, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "text": "It is hard to tell what is wrong without a sample file.\n\nPlease post the initial file (not locked), the locked file and detailed instructions how you created it in Excel, i.e. what operations you did to produce content that POI cannot read.\n\nYegor", "id": 151254, "time": "2011-11-07T07:18:14Z", "bug_id": 52142, "creation_time": "2011-11-07T07:18:14Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 52142, "is_private": false, "text": "It is hard to tell what is wrong without a sample file.\n\nPlease post the initial file (not locked), the locked file and detailed instructions how you created it in Excel, i.e. what operations you did to produce content that POI cannot read.\n\nYegor", "id": 151255, "time": "2011-11-07T07:19:14Z", "creator": "yegor@dinom.ru", "creation_time": "2011-11-07T07:19:14Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "suresh54145@gmail.com", "attachment_id": null, "text": "I have created test.xlsx sheet and added text 'test' in the first cell. I have added the latest jar files of poi 3.8 beta 4 version on build path.\n\nBelow is the code used to read the sheet.\n\n\t\t   XSSFWorkbook workbook=null;\n\t            InputStream inputStream = null;\n\n\t                inputStream = new FileInputStream(new File(\"G:\\\\test.xlsx\"));\n\n\t            workbook=     new XSSFWorkbook(inputStream);\n\t            XSSFSheet sheet=workbook.getSheetAt(0);\n\t            XSSFRow row=sheet.getRow(0);\n\t            XSSFCell cell=row.getCell(0);\n\t            System.out.println(\"cell value is--\"+cell.toString());\n\noutput:\n\ncell value is--test\n\nI used the review-->protect workbook-->protect structure and windows..then gave 'suresh' as password and save the excel sheet as 'test_structure_locked.xlsx'.\n\nthen I tried to read this new file with the below code. It seems it is not able to read the excel sheet whose structure is locked.\n\n XSSFWorkbook workbook=null;\n\t            InputStream inputStream = null;\n\n\t                inputStream = new FileInputStream(new File(\"G:\\\\test_structure_locked.xlsx\"));\n\n\t            workbook=     new XSSFWorkbook(inputStream);\n\t            XSSFSheet sheet=workbook.getSheetAt(0);\n\t            XSSFRow row=sheet.getRow(0);\n\t            XSSFCell cell=row.getCell(0);\n\t            System.out.println(\"cell value is--\"+cell.toString());\n\nError:\nException in thread \"main\" org.apache.poi.POIXMLException: org.apache.poi.openxml4j.exceptions.InvalidFormatException: Package should contain a content type part [M1.13]\n\tat org.apache.poi.util.PackageHelper.open(PackageHelper.java:41)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:178)\n\tat com.poi.xssf.XSSFWorkBook.main(XSSFWorkBook.java:98)\nCaused by: org.apache.poi.openxml4j.exceptions.InvalidFormatException: Package should contain a content type part [M1.13]\n\tat org.apache.poi.openxml4j.opc.ZipPackage.getPartsImpl(ZipPackage.java:148)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.getParts(OPCPackage.java:615)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.open(OPCPackage.java:229)\n\tat org.apache.poi.util.PackageHelper.open(PackageHelper.java:39)\n\t... 2 more\n\n\n\n\n\n(In reply to comment #0)\n> I am able to open the excel 2007 but when I protect it with structure\n> locking..I am not able to open it. I am using poi-3.8.beta4.\n> \n> I dont think something is wrong with excel sheet.\n> \n> Code:\n> \n>  XSSFWorkbook workbook=null;\n>             InputStream inputStream = null;\n> \n>                 inputStream = new FileInputStream(new File(\"G:\\\\test.xlsx\"));\n> \n>             workbook=     new XSSFWorkbook(inputStream);\n> \n> \n> Error:\n> \n> \n> Exception in thread \"main\" org.apache.poi.POIXMLException:\n> org.apache.poi.openxml4j.exceptions.InvalidFormatException: Package should\n> contain a content type part [M1.13]\n>     at org.apache.poi.util.PackageHelper.open(PackageHelper.java:41)\n>     at org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:178)\n>     at com.poi.xssf.XSSFWorkBook.main(XSSFWorkBook.java:97)\n> Caused by: org.apache.poi.openxml4j.exceptions.InvalidFormatException: Package\n> should contain a content type part [M1.13]\n>     at\n> org.apache.poi.openxml4j.opc.ZipPackage.getPartsImpl(ZipPackage.java:148)\n>     at org.apache.poi.openxml4j.opc.OPCPackage.getParts(OPCPackage.java:615)\n>     at org.apache.poi.openxml4j.opc.OPCPackage.open(OPCPackage.java:229)\n>     at org.apache.poi.util.PackageHelper.open(PackageHelper.java:39)\n>     ... 2 more\n\n(In reply to comment #0)\n> I am able to open the excel 2007 but when I protect it with structure\n> locking..I am not able to open it. I am using poi-3.8.beta4.\n> \n> I dont think something is wrong with excel sheet.\n> \n> Code:\n> \n>  XSSFWorkbook workbook=null;\n>             InputStream inputStream = null;\n> \n>                 inputStream = new FileInputStream(new File(\"G:\\\\test.xlsx\"));\n> \n>             workbook=     new XSSFWorkbook(inputStream);\n> \n> \n> Error:\n> \n> \n> Exception in thread \"main\" org.apache.poi.POIXMLException:\n> org.apache.poi.openxml4j.exceptions.InvalidFormatException: Package should\n> contain a content type part [M1.13]\n>     at org.apache.poi.util.PackageHelper.open(PackageHelper.java:41)\n>     at org.apache.poi.xssf.usermodel.XSSFWorkbook.<init>(XSSFWorkbook.java:178)\n>     at com.poi.xssf.XSSFWorkBook.main(XSSFWorkBook.java:97)\n> Caused by: org.apache.poi.openxml4j.exceptions.InvalidFormatException: Package\n> should contain a content type part [M1.13]\n>     at\n> org.apache.poi.openxml4j.opc.ZipPackage.getPartsImpl(ZipPackage.java:148)\n>     at org.apache.poi.openxml4j.opc.OPCPackage.getParts(OPCPackage.java:615)\n>     at org.apache.poi.openxml4j.opc.OPCPackage.open(OPCPackage.java:229)\n>     at org.apache.poi.util.PackageHelper.open(PackageHelper.java:39)\n>     ... 2 more", "id": 151270, "time": "2011-11-07T15:12:46Z", "bug_id": 52142, "creation_time": "2011-11-07T15:12:46Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 52142, "is_private": false, "text": "Created attachment 27910\nexcel used to check the funtionality\n\nHi,\n\nI have added the excel sheets used to test the code mentioned in the previous post.\n\nThanks,\nSuresh A", "id": 151291, "time": "2011-11-08T16:12:07Z", "creator": "suresh54145@gmail.com", "creation_time": "2011-11-08T16:12:07Z", "attachment_id": 27910}, {"count": 5, "tags": [], "bug_id": 52142, "text": "I am also getting same issue with file created/updated using Microsoft office 2007.\n\nPlease let me know if you find any solution", "id": 178946, "time": "2014-11-04T11:21:59Z", "creator": "suyogkasawa2007@gmail.com", "creation_time": "2014-11-04T11:21:59Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "We've added some more descriptive exceptions in 3.15 beta 1 for the most common incorrect file types. If you pass in a .ODS or a .XLS, for example, the exception will not tell you that you've done that.\n\nSo, it might be worth re-testing for this case with a nightly build / 3.15 beta 1 when released", "id": 189490, "time": "2016-03-15T12:43:52Z", "bug_id": 52142, "creation_time": "2016-03-15T12:43:52Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 52142, "is_private": false, "text": "Latest trunk reports this as follows\n\norg.apache.poi.openxml4j.exceptions.OLE2NotOfficeXmlFileException: The supplied data appears to be in the OLE2 Format. You are calling the part of POI that deals with OOXML (Office Open XML) Documents. You need to call a different part of POI to process this data (eg HSSF instead of XSSF)\n\nSo I think we can close this as WORKSFORME, you seem to have an xls file with a .xlsx extension which means you actually need HSSF.... classes to work with such files. Alternatively you can use WorkbookFactory and the underlying base interfaces (Workbook, Sheet, Row, Cell, ...) to make your code independent of the actual file-format.", "id": 192663, "time": "2016-07-26T19:48:47Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-07-26T19:48:47Z", "attachment_id": null}]