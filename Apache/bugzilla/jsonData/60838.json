[{"count": 0, "tags": [], "text": "Created attachment 34809\nexample\n\nHi:\n    I have a question. Execute the following code, office2010 is no problem, but for office2013 AP after column style will be lost.  I use poi version 3.12.\n\nCode:\n\n// for test\n\tpublic static void main(String[] args) {\n\t\tString[][] data = new String[][] { { \"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \n\n\"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \n\n\"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \n\n\"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\" }, { \"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \n\n\"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \n\n\"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \n\n\"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\" }, {  \"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \n\n\"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \n\n\"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\", \n\n\"456\", \"789\", \"012\",\"123\", \"456\", \"789\", \"012\",\"123\"} };\n\t\texportExcel(data, \"E:\\\\excelutil-write.xls\");\n\t}\n\npublic static boolean exportExcel(String[][] data, String filePath) {\n\t\tif (data == null || data.length == 0) {\n\t\t\treturn false;\n\t\t}\n\t\tboolean flag = true;\n\t\tHSSFWorkbook workbook = new HSSFWorkbook();\n\t\ttry {\n\t\t\tFile file = new File(filePath);\n\t\t\tif (file.exists()) {\n\t\t\t\tfile.delete();\n\t\t\t}\n\t\t\tFileOutputStream outputStream = new FileOutputStream(file);\n\t\t\tSheet sheet = workbook.createSheet();\n\t\t\tworkbook.setSheetName(0, \"sheet1\");\n\t\t\tRow row = null;\n\t\t\tCell cell = null;\n\t\t\tint rowCount = data.length;\n\t\t\tint colCount = data[0].length;\n\t\t\tCellStyle style = workbook.createCellStyle();\n\t\t\tstyle.setBorderBottom(CellStyle.BORDER_THIN);\n\t\t\tstyle.setBorderLeft(CellStyle.BORDER_THIN);\n\t\t\tstyle.setBorderRight(CellStyle.BORDER_THIN);\n\t\t\tstyle.setBorderTop(CellStyle.BORDER_THIN);\n\t\t\tstyle.setVerticalAlignment(CellStyle.VERTICAL_CENTER);\n\t\t\tstyle.setAlignment(CellStyle.ALIGN_CENTER);\n\t\t\tList<CellStyle> dList = new ArrayList<CellStyle>(); \n\t\t\tfor (int i = 0; i < colCount; i++) {\n\t\t\t\tCellStyle dstyle = workbook.createCellStyle();\n\t\t\t\tdstyle.cloneStyleFrom(style);\n\t\t\t\tdstyle.setAlignment(CellStyle.ALIGN_CENTER);\n\t\t\t\tdList.add(dstyle);\n\t\t\t}\n\t\t\tfor (int i = 0; i < rowCount; i++) {\n\t\t\t\trow = sheet.createRow(i);\n\t\t\t\tfor (int j = 0; j < colCount; j++) {\n\t\t\t\t\tcell = row.createCell(j);\n\t\t\t\t\tcell.setCellType(XSSFCell.CELL_TYPE_STRING);\n\t\t\t\t\tcell.setCellValue(data[i][j]);\n\t\t\t\t\tCellStyle cStyle = dList.get(j);\n\t\t\t\t\t//cStyle.cloneStyleFrom(dList.get(j));\n\t\t\t\t\tcell.setCellStyle(cStyle);\n\t\t\t\t}\n\t\t\t}\n\t\t\tworkbook.write(outputStream);\n\t\t\toutputStream.close();\n\t\t} catch (IOException ex) {\n\t\t\tflag = false;\n\t\t\tloger.error(ex);\n\t\t} finally {\n\t\t\ttry {\n\t\t\t\tworkbook.close();\n\t\t\t} catch (IOException e) {\n\t\t\t}\n\t\t}\n\t\treturn flag;\n\t}", "is_private": false, "id": 197556, "creation_time": "2017-03-09T02:44:07Z", "time": "2017-03-09T02:44:07Z", "creator": "171207538@qq.com", "bug_id": 60838, "attachment_id": 34809}, {"count": 1, "tags": [], "bug_id": 60838, "attachment_id": null, "id": 197795, "time": "2017-03-18T19:15:20Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2017-03-18T19:15:20Z", "is_private": false, "text": "There were many fixes in newer versions, maybe this one is already solved. Can you verify with the latest, preferably 3.16-beta2 to check if it still happens in the latest version?"}]