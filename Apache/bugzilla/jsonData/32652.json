[{"count": 0, "tags": [], "text": "Contrary to popular believe and contrary to the apache documentation, it is\ncurrently possible to use name virual hosting over ssl as long as all virtual\nhosts share the same ssl-setup (server-certificate, client-certificates, etc).\nUsing the subjectAltName extension of x509 v3 it is possible for this one\nserver-certificate to be valid for all ssl-virtual hosts. subjectAltName is\nsupported at least by current Mozilla browsers and Internet Explorer versions.\nLook at http://www.es.net/pub/esnet-doc/SubjectAltName.pdf (found via Google)\nfor more details.\n\nThe setup works perfectly with Apache 2.0.52 (Debian Package), even though\napache complains once per virtual host about the CN of the certificate not\nmatching ServerName.\n\nPlease change the documentation or at least include a hint that subjectAltName\nexists, it could be very usefull for small sites. It could also stimulate\nbrowser support for subjectAltName if it became widly known.\n\n\n\n\n------------------------------------------------------------------------------\n\nhttpd.conf (only relevent parts)\n\nNameVirtualHost *:80\n\n<VirtualHost *:80>\n  # Default\n<VirtualHost>\n\n<VirtualHost *:80>\n  ServerName asdf.com\n</VirtualHost>\n\nSSLCipherSuite CipherSpec:foo\nSSLCertificateFile /path/to/CertificateFile\nSSLCertificateKeyFile /path/to/KeyFile\n# all the other common SSL options\n\nNameVirtualHost *:443\n\n<VirtualHost *:443>\n  # Default\n  SSLEngine on\n<VirtualHost>\n\n<VirtualHost *:443>\n  ServerName asdf.com\n  SSLEngine on\n</VirtualHost>", "is_private": false, "id": 68318, "creator": "nospam@indoktrination.at", "time": "2004-12-12T00:28:13Z", "bug_id": 32652, "creation_time": "2004-12-12T00:28:13Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 32652, "attachment_id": null, "text": "It would be nice if mod_ssl checked the subjectAltName extension and didn't warn\nabout CN mismatches if there is a mataching subjectAltName for the server host, yes.\n\nYour assertion that \"it's possible to do name-based vhosting with SSL so long as\nall your vhosts share the same configuration\" really belies the meaning of\n\"name-based vhosting\", i.e. being able to have multiple server configurations\none of which is chosen based on the hostname used in the Host header.", "id": 69630, "time": "2005-01-13T14:11:21Z", "creator": "jorton@redhat.com", "creation_time": "2005-01-13T14:11:21Z", "is_private": false}, {"count": 2, "attachment_id": null, "creator": "steve@openssl.org", "text": "I've attached a patch which checks subjectAltName and also multiple commonName\ntypes if subjectAltName is not present. It can also handle alternative string\ntypes in commonName.\n\nLogging errors isn't quite as straight forward because several names could be\nmatched. I've set this to initially check a match, then if and only if it fails\nlog all the mismatches.\n\nIf nothing else the patch should give a few pointers.", "id": 111418, "time": "2007-12-04T06:13:34Z", "bug_id": 32652, "creation_time": "2007-12-04T06:13:34Z", "tags": [], "is_private": false}, {"count": 3, "attachment_id": 21226, "creator": "steve@openssl.org", "is_private": false, "id": 111420, "time": "2007-12-04T06:15:02Z", "bug_id": 32652, "creation_time": "2007-12-04T06:15:02Z", "tags": [], "text": "Created attachment 21226\nExample code checking subjectAltName"}, {"count": 4, "tags": [], "bug_id": 32652, "text": "This is still happening, 6 years since the bug was found, 3 years since a patch was supplied. :(", "id": 142889, "time": "2010-12-21T08:52:52Z", "creator": "apache-dev@lists.grepular.com", "creation_time": "2010-12-21T08:52:52Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 32652, "attachment_id": null, "id": 149875, "time": "2011-09-28T06:54:13Z", "creator": "asfbugz@velox.ch", "creation_time": "2011-09-28T06:54:13Z", "is_private": false, "text": "I have committed a fix for trunk in r1176752, which takes the dNSName entries in the subjectAltName extension into account when checking against the ServerName. Wildcard matching is performed as well, but only in a restrictive fashion: the wildcard character must be THE left-most DNS label, and it is not allowed to match a dot (this basically reflects what common browsers do nowadays)."}, {"count": 6, "tags": [], "bug_id": 32652, "text": "*** Bug 47051 has been marked as a duplicate of this bug. ***", "id": 149877, "time": "2011-09-28T06:57:20Z", "creator": "asfbugz@velox.ch", "creation_time": "2011-09-28T06:57:20Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 32652, "attachment_id": null, "text": "(In reply to comment #5)\n> I have committed a fix for trunk in r1176752, which takes the dNSName entries\n\nr1176752 - hopefully Bugzilla properly hyperlinks it this time.", "id": 149878, "time": "2011-09-28T07:01:54Z", "creator": "asfbugz@velox.ch", "creation_time": "2011-09-28T07:01:54Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 32652, "text": "fixed in 2.4.1", "id": 154177, "time": "2012-02-26T16:35:44Z", "creator": "sf@sfritsch.de", "creation_time": "2012-02-26T16:35:44Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 32652, "text": "Minor issue with this fix. You need to call:\n\nsk_GENERAL_NAME_pop_free(names, GENERAL_NAME_free);\n\nand not just sk_GENERAL_NAME_free or you leak memory.", "id": 154258, "time": "2012-02-26T17:19:40Z", "creator": "steve@openssl.org", "creation_time": "2012-02-26T17:19:40Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 32652, "attachment_id": null, "text": "(In reply to comment #9)\n> Minor issue with this fix. You need to call:\n\nThanks for pointing this out. Fixed for trunk in r1294471 - backport for 2.4 proposed.", "id": 154304, "time": "2012-02-28T06:03:31Z", "creator": "asfbugz@velox.ch", "creation_time": "2012-02-28T06:03:31Z", "is_private": false}, {"count": 11, "tags": [], "bug_id": 32652, "attachment_id": null, "text": "Memleak fix backported to 2.4 in r1294602 - will appear in 2.4.2", "id": 154337, "time": "2012-02-28T17:48:57Z", "creator": "asfbugz@velox.ch", "creation_time": "2012-02-28T17:48:57Z", "is_private": false}]