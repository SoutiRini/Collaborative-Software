[{"count": 0, "tags": [], "text": "Created attachment 29155\nant-generated patch text file\n\nBugfixes and addons of some formula evaluations.\nI used EXCEL 2010 as basis to get the excel behaviour. I used the modifications on a quite complex XLS with HSSFWorkbook only.\n\nChanges in detail:\n\n- FunctionEval\n  + added function no. 70 (WeekdayFunc)\n\n- WeekdayFunc\n  + complete new implementation\n  + tested manually for several cases (unit tests todo, sorry)\n\n- Address\n  + third parameter can be left out, support for this added\n\n- TestAddress\n  + unit test for above situation added\n\n- BooleanFunction\n  + parameters can be left out (e.g. \"OR(true,,false,)\", support for this added\n\n- DateUtil\n  + made some constants public because they are of general use and the class is the right place\n  + added getJavaCalendar() functions that are similar to existing getJavaDate() but return a Calendar\n  + getJavaDate() use the new getJavaCalendar() internally (because the originally create a Calendar and drop it)\n  + commented out an \"if (false)\" because this is just a comment inside, so no need for dead code\n\n- CalendarFieldFunction\n  + bug fix: XLS performs rounding on sub-second level\n  + bug fix: XLS HOUR() does not care about daylight saving, so use UTC timezone for getting hour\n  + uses new DateUtil methods (see above)\n\n- TestCalendarFieldFunction\n  + unit tests for above fixed situations added\n\n- eval-devguide.xml\n  + some typos fixed\n  + weekday mentioned\n\n- patch.xml\n  + the regexps were to generic, the generated patch for the above files included \"Address.java\" and \"TestAdress.java\" as new files because the contain a capital \"A\". The svn change indicator is in the first column, so added a ^ in the regexp. PLEASE, TEST THIS in different development environments, because I am not sure, if this change is generically correct or just works for me.\n\n\nA side note to the POI developers:\nSetup of the project is great. \"svn checkout\" + \"ant jar\" worked out of the box (for me). With this \"organisational stuff\" working without problems, giving back own modifications/fixes to the POI project is fun. Keep up the great work!", "attachment_id": 29155, "id": 161067, "creator": "twapache@online.de", "time": "2012-08-02T14:37:47Z", "bug_id": 53644, "creation_time": "2012-08-02T14:37:47Z", "is_private": false}, {"count": 1, "tags": [], "text": "Created attachment 29156\nant-generated patch tar-gz file", "is_private": false, "id": 161068, "creator": "twapache@online.de", "time": "2012-08-02T14:38:34Z", "bug_id": 53644, "creation_time": "2012-08-02T14:38:34Z", "attachment_id": 29156}, {"count": 2, "tags": [], "bug_id": 53644, "attachment_id": null, "id": 161265, "time": "2012-08-11T16:17:28Z", "creator": "yegor@dinom.ru", "creation_time": "2012-08-11T16:17:28Z", "is_private": false, "text": "Thanks for the patch, applied in r1371969\n\nsmall request: the javadoc for WeekdayFunc.evaluate is in German, can you translate it to English? \n\nDanke,\nYegor"}, {"count": 3, "tags": [], "bug_id": 53644, "attachment_id": 29333, "is_private": false, "id": 161965, "time": "2012-09-05T13:12:44Z", "creator": "twapache@online.de", "creation_time": "2012-09-05T13:12:44Z", "text": "Created attachment 29333\nEnglish javadoc for WeekdayFunc\n\nJavadoc for WeekdayFunc translated to English."}]