[{"count": 0, "tags": [], "bug_id": 60962, "attachment_id": null, "is_private": false, "id": 198202, "time": "2017-04-07T09:31:23Z", "creator": "polynomial-c@gentoo.org", "creation_time": "2017-04-07T09:31:23Z", "text": "Hello,\n\nthis is _not_ a duplicate of bug #60061\n\n\nWhen trying to compile httpd-2.4.25 against openssl-1.1 that was compiled with either \"--api=1.1.0\" or \"no-deprecated\" option, the build fails because openssl-1.1 no longer provides any features that its developers marked as deprecated.\n\n\nThe build failure looks like this:\n\n/usr/share/build-1/libtool --silent --mode=link x86_64-pc-linux-gnu-gcc  -pthread  -march=native -mtune=native -O2 -pipe    -L/var/tmp/portage/dev-libs/apr-util-1.5.4-r1/temp  -Wl,-O1 -Wl,--hash-style=gnu -Wl,--sort-common -Wl,--as-needed -Wl,--no-as-needed -o htdbm  htdbm.lo passwd_common.lo       -laprutil-1 -ldb-6.2 -lgdbm -lexpat -lapr-1 -luuid -lrt -lcrypt -lpthread -ldl -lcrypt\n/usr/share/build-1/libtool --silent --mode=compile x86_64-pc-linux-gnu-gcc   -pthread  -march=native -mtune=native -O2 -pipe    -DLINUX -D_REENTRANT -D_GNU_SOURCE   \\\n      -I. -I/var/tmp/portage/www-servers/apache-2.4.25/work/httpd-2.4.25/os/unix -I/var/tmp/portage/www-servers/apache-2.4.25/work/httpd-2.4.25/include -I/usr/include/apr-1 -I/usr/include/db6.2 -I/var/tmp/portage/www-servers/apache-2.4.25/work/httpd-2.4.25/modules/aaa -I/var/tmp/portage/www-servers/apache-2.4.25/work/httpd-2.4.25/modules/cache -I/var/tmp/portage/www-servers/apache-2.4.25/work/httpd-2.4.25/modules/core -I/var/tmp/portage/www-servers/apache-2.4.25/work/httpd-2.4.25/modules/database -I/var/tmp/portage/www-servers/apache-2.4.25/work/httpd-2.4.25/modules/filters -I/var/tmp/portage/www-servers/apache-2.4.25/work/httpd-2.4.25/modules/ldap -I/var/tmp/portage/www-servers/apache-2.4.25/work/httpd-2.4.25/modules/loggers -I/var/tmp/portage/www-servers/apache-2.4.25/work/httpd-2.4.25/modules/lua -I/var/tmp/portage/www-servers/apache-2.4.25/work/httpd-2.4.25/modules/proxy -I/var/tmp/portage/www-servers/apache-2.4.25/work/httpd-2.4.25/modules/session -I/var/tmp/portage/www-servers/apache-2.4.25/work/httpd-2.4.25/modules/ssl -I/var/tmp/portage/www-servers/apache-2.4.25/work/httpd-2.4.25/modules/test -I/var/tmp/portage/www-servers/apache-2.4.25/work/httpd-2.4.25/server -I/var/tmp/portage/www-servers/apache-2.4.25/work/httpd-2.4.25/modules/arch/unix -I/var/tmp/portage/www-servers/apache-2.4.25/work/httpd-2.4.25/modules/dav/main -I/var/tmp/portage/www-servers/apache-2.4.25/work/httpd-2.4.25/modules/generators -I/var/tmp/portage/www-servers/apache-2.4.25/work/httpd-2.4.25/modules/mappers  -prefer-non-pic -static -c ab.c && touch ab.lo\nab.c: In function \u2018ssl_print_cert_info\u2019:\nab.c:642:29: warning: implicit declaration of function \u2018X509_get_notBefore\u2019 [-Wimplicit-function-declaration]\n     ASN1_UTCTIME_print(bio, X509_get_notBefore(cert));\n                             ^\nab.c:642:29: warning: passing argument 2 of \u2018ASN1_UTCTIME_print\u2019 makes pointer from integer without a cast [-Wint-conversion]\nIn file included from /usr/include/openssl/rsa.h:16:0,\n                 from ab.c:161:\n/usr/include/openssl/asn1.h:751:5: note: expected \u2018const ASN1_UTCTIME * {aka const struct asn1_string_st *}\u2019 but argument is of type \u2018int\u2019\n int ASN1_UTCTIME_print(BIO *fp, const ASN1_UTCTIME *a);\n     ^\nab.c:646:29: warning: implicit declaration of function \u2018X509_get_notAfter\u2019 [-Wimplicit-function-declaration]\n     ASN1_UTCTIME_print(bio, X509_get_notAfter(cert));\n                             ^\nab.c:646:29: warning: passing argument 2 of \u2018ASN1_UTCTIME_print\u2019 makes pointer from integer without a cast [-Wint-conversion]\nIn file included from /usr/include/openssl/rsa.h:16:0,\n                 from ab.c:161:\n/usr/include/openssl/asn1.h:751:5: note: expected \u2018const ASN1_UTCTIME * {aka const struct asn1_string_st *}\u2019 but argument is of type \u2018int\u2019\n int ASN1_UTCTIME_print(BIO *fp, const ASN1_UTCTIME *a);\n     ^\nab.c: In function \u2018main\u2019:\nab.c:2398:28: warning: implicit declaration of function \u2018SSLv2_client_method\u2019 [-Wimplicit-function-declaration]\n                     meth = SSLv2_client_method();\n                            ^\nab.c:2398:26: warning: assignment makes pointer from integer without a cast [-Wint-conversion]\n                     meth = SSLv2_client_method();\n                          ^\nab.c:2412:28: warning: implicit declaration of function \u2018TLSv1_1_client_method\u2019 [-Wimplicit-function-declaration]\n                     meth = TLSv1_1_client_method();\n                            ^\nab.c:2412:26: warning: assignment makes pointer from integer without a cast [-Wint-conversion]\n                     meth = TLSv1_1_client_method();\n                          ^\nab.c:2414:28: warning: implicit declaration of function \u2018TLSv1_2_client_method\u2019 [-Wimplicit-function-declaration]\n                     meth = TLSv1_2_client_method();\n                            ^\nab.c:2414:26: warning: assignment makes pointer from integer without a cast [-Wint-conversion]\n                     meth = TLSv1_2_client_method();\n                          ^\nab.c:2417:28: warning: implicit declaration of function \u2018TLSv1_client_method\u2019 [-Wimplicit-function-declaration]\n                     meth = TLSv1_client_method();\n                            ^\nab.c:2417:26: warning: assignment makes pointer from integer without a cast [-Wint-conversion]\n                     meth = TLSv1_client_method();\n                          ^\nab.c:2468:5: warning: implicit declaration of function \u2018CRYPTO_malloc_init\u2019 [-Wimplicit-function-declaration]\n     CRYPTO_malloc_init();\n     ^\nab.c:2470:5: warning: implicit declaration of function \u2018SSL_load_error_strings\u2019 [-Wimplicit-function-declaration]\n     SSL_load_error_strings();\n     ^\nab.c:2471:5: warning: implicit declaration of function \u2018SSL_library_init\u2019 [-Wimplicit-function-declaration]\n     SSL_library_init();\n     ^\n/usr/share/build-1/libtool --silent --mode=link x86_64-pc-linux-gnu-gcc  -pthread  -march=native -mtune=native -O2 -pipe -lssl -lcrypto -luuid -lrt -lcrypt -lpthread -ldl  \\\n      -L/var/tmp/portage/dev-libs/apr-util-1.5.4-r1/temp  -Wl,-O1 -Wl,--hash-style=gnu -Wl,--sort-common -Wl,--as-needed -Wl,--no-as-needed -o ab  ab.lo       -laprutil-1 -ldb-6.2 -lgdbm -lexpat -lapr-1 -luuid -lrt -lcrypt -lpthread -ldl -lm\nab.o: In function `ssl_print_cert_info':\nab.c:(.text+0x7e4): undefined reference to `X509_get_notBefore'\nab.c:(.text+0x817): undefined reference to `X509_get_notAfter'\nab.o: In function `main':\nab.c:(.text.startup+0x463): undefined reference to `TLSv1_client_method'\nab.c:(.text.startup+0x8f2): undefined reference to `SSLv2_client_method'\nab.c:(.text.startup+0x93f): undefined reference to `TLSv1_1_client_method'\nab.c:(.text.startup+0x94c): undefined reference to `TLSv1_2_client_method'\nab.c:(.text.startup+0xa10): undefined reference to `CRYPTO_malloc_init'\nab.c:(.text.startup+0xa17): undefined reference to `SSL_load_error_strings'\nab.c:(.text.startup+0xa1e): undefined reference to `SSL_library_init'\ncollect2: error: ld returned 1 exit status\nmake[2]: *** [Makefile:60: ab] Error 1"}]