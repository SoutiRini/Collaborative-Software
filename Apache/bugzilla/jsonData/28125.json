[{"count": 0, "tags": [], "text": "If rewrite rules are used within a <Proxy *></Proxy> block mod_rewrite\nunconditionally sets r->proxyreq = PROXYREQ_REVERSE which causes\nmodules/proxy/proxy_http.c to add the following headers to all regular,\ni.e. forward proxy requests:\n\nX-Forwarded-For: <local-client-ip>\nX-Forwarded-Host: <local-client-hostname>\nX-Forwarded-Server: <local-proxy-hostname>\n\nTo prevent this privacy leak mod_rewrite must not change the value of\nr->proxyreq if it already has the value of PROXYREQ_PROXY.\n\nNote that this is a very valid scenario as mod_rewrite can be used\ne.g. to deny certain buggy user agents access to the proxy.\n\nPatch follows.", "attachment_id": null, "bug_id": 28125, "id": 55039, "time": "2004-04-01T12:23:58Z", "creator": "ast@domdv.de", "creation_time": "2004-04-01T12:23:58Z", "is_private": false}, {"count": 1, "tags": [], "creator": "ast@domdv.de", "attachment_id": 11080, "id": 55040, "time": "2004-04-01T12:24:59Z", "bug_id": 28125, "creation_time": "2004-04-01T12:24:59Z", "is_private": false, "text": "Created attachment 11080\nprevent mod_rewrite caused privacy leak in http proxy"}, {"count": 2, "tags": [], "bug_id": 28125, "attachment_id": null, "id": 55230, "time": "2004-04-03T20:35:19Z", "creator": "nd@perlig.de", "creation_time": "2004-04-03T20:35:19Z", "is_private": false, "text": "Fixed in 2.1 and proposed for backport into the 2.0 branch.\n\nThanks for the report and thanks for using Apache!"}]