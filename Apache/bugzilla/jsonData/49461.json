[{"count": 0, "tags": [], "bug_id": 49461, "attachment_id": 25611, "is_private": false, "id": 137733, "time": "2010-06-18T06:15:06Z", "creator": "pankaj@instacoll.com", "creation_time": "2010-06-18T06:15:06Z", "text": "Created attachment 25611\nThis document throws throws RecordFormatException: Unable to construct record instance, while reading.\n\nHi,\nI am trying to read a xls file which has images, radio buttons and dropdowns.\nWhile reading:\n\nInputStream input = new FileInputStream(parentDir + File.separator + \"Temp\" + File.separator + filename);\nwb = new HSSFWorkbook(input);\n\nIt throws RecordFormatException as below:\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\tat org.apache.poi.hssf.record.RecordFactory$ReflectionRecordCreator.create(RecordFactory.java:64)\n\tat org.apache.poi.hssf.record.RecordFactory.createSingleRecord(RecordFactory.java:263)\n\tat org.apache.poi.hssf.record.RecordFactoryInputStream.readNextRecord(RecordFactoryInputStream.java:270)\n\tat org.apache.poi.hssf.record.RecordFactoryInputStream.nextRecord(RecordFactoryInputStream.java:236)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:392)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:276)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:201)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:317)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:298)\n\tat com.instasecure.apps.spreadsheet.SpreadsheetPOI.readWorkbook(SpreadsheetPOI.java:105)\n\tat com.instasecure.apps.spreadsheet.TransformSpreadSheet.transformOOToLDXml(TransformSpreadSheet.java:27)\n\tat com.instasecure.apps.spreadsheet.TransformSpreadSheet.transform(TransformSpreadSheet.java:12)\n\tat com.instasecure.util.openoffice.LocalOOAccess.transformSpreadSheet(LocalOOAccess.java:283)\n\tat com.instasecure.util.openoffice.LocalOOAccess.convert(LocalOOAccess.java:241)\n\tat com.instasecure.util.openoffice.LocalOOAccess.call(LocalOOAccess.java:78)\n\tat com.instasecure.util.openoffice.OOAccessHelper.call(OOAccessHelper.java:62)\n\tat com.instasecure.secure.DocumentSecuringHelper.saveSpreadSheetRelatedFiles(DocumentSecuringHelper.java:611)\n\tat com.instasecure.secure.DocumentSecuringHelper.saveDocRelatedFiles(DocumentSecuringHelper.java:185)\n\tat com.instasecure.secure.DocumentSecurer.secure(DocumentSecurer.java:164)\n\tat com.instasecure.command.DocumentSecureCmd.secureDocAndUpdateDB(DocumentSecureCmd.java:109)\n\tat com.instasecure.action.DocumentSecureAction.execute(DocumentSecureAction.java:112)\n\tat com.instasecure.action.InstaSecureAction.execute(InstaSecureAction.java:79)\n\tat org.apache.struts.action.RequestProcessor.processActionPerform(RequestProcessor.java:425)\n\tat org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:228)\n\tat org.apache.struts.action.ActionServlet.process(ActionServlet.java:1913)\n\tat org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:462)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:710)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n\tat com.instasecure.requestprocessing.InstaSecureActionServlet.service(InstaSecureActionServlet.java:26)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n\tat com.instasecure.requestprocessing.InstaSecureSessionFilter.doFilter(InstaSecureSessionFilter.java:141)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n\tat com.instasecure.requestprocessing.AllowRequestFilter.doFilter(AllowRequestFilter.java:126)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:228)\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:104)\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:216)\n\tat org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:844)\n\tat org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:634)\n\tat org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:445)\n\tat java.lang.Thread.run(Thread.java:619)\nCaused by: java.lang.RuntimeException: Unexpected end-of-file\n\tat org.apache.poi.util.LittleEndianInputStream.checkEOF(LittleEndianInputStream.java:123)\n\tat org.apache.poi.util.LittleEndianInputStream.readUByte(LittleEndianInputStream.java:53)\n\tat org.apache.poi.util.LittleEndianInputStream.readByte(LittleEndianInputStream.java:44)\n\tat org.apache.poi.util.StringUtil.readUnicodeString(StringUtil.java:137)\n\tat org.apache.poi.hssf.record.LbsDataSubRecord$LbsDropData.<init>(LbsDataSubRecord.java:305)\n\tat org.apache.poi.hssf.record.LbsDataSubRecord.<init>(LbsDataSubRecord.java:127)\n\tat org.apache.poi.hssf.record.SubRecord.createSubRecord(SubRecord.java:59)\n\tat org.apache.poi.hssf.record.ObjRecord.<init>(ObjRecord.java:96)\n\tat sun.reflect.GeneratedConstructorAccessor47.newInstance(Unknown Source)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:513)\n\tat org.apache.poi.hssf.record.RecordFactory$ReflectionRecordCreator.create(RecordFactory.java:56)\n\t... 46 more\n\n\nPlease help. I am also attaching the document for reference.\n\nThanks & Regards,\n\nPankaj Dubey\nSoftware Engineer\nTeam Live Documents | InstaColl, Bangalore\nContact: pankaj@instacoll.com | +91-9916129921"}, {"count": 1, "attachment_id": null, "bug_id": 49461, "is_private": false, "id": 137803, "time": "2010-06-22T06:02:59Z", "creator": "apache@gagravarr.org", "creation_time": "2010-06-22T06:02:59Z", "tags": [], "text": "It looks like org.apache.poi.hssf.record.LbsDataSubRecord is expecting more data than exists in your file\n\nHow was the file created? Excel or something else? If you load the file in excel, and \"Save As\", does the new file work with poi?"}, {"count": 2, "tags": [], "bug_id": 49461, "text": "(In reply to comment #1)\n\nHi Nick,\nThanks for the prompt response.\nActually, the file was created as XLS with MS Office.\nIf we open the file with MS Office and then save it as XLSX and then again convert the XLSX file to XLS with open OpenOffice, the POI is having no issues in reading that document(XLS file).\nBut POI is failing to read the document directly, as mentioned earlier.\nI am not able to understand why this is happening, There is no change in the document contents after saving it as XLS with OpenOffice. \n\n\nThanks & Regards,\n\nPankaj Dubey\nSoftware Engineer\nTeam Live Documents | InstaColl, Bangalore\nContact: pankaj@instacoll.com | +91-9916129921", "id": 137805, "time": "2010-06-22T06:19:24Z", "creator": "pankaj@instacoll.com", "creation_time": "2010-06-22T06:19:24Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 49461, "attachment_id": null, "text": "I think you're going to need to do some investigating of LbsDataSubRecord\n\nYou'll need to download the microsoft file format specs, and compare the data in your record with what the spec says should be there, and with what poi expects. The LbsDataSubRecord looks a little complicated (lots of bits that may or may not be there based on what else is there), so it's always possible that one of these clauses is missing\n\nOnce you figure out the problem, do please report back / send in a patch!", "id": 137981, "time": "2010-06-29T09:44:37Z", "creator": "apache@gagravarr.org", "creation_time": "2010-06-29T09:44:37Z", "is_private": false}]