[{"count": 0, "tags": [], "bug_id": 48526, "is_private": false, "text": "Hai Experts,\n\n        While i generating Excel report using POI 3.5-FINAL API it throws an error \"Not Yet Implemented\" for the formula RANDBETWEEN(-20,27)*0.1 i used in the\nExcel template. Whether this has been inplemented in the further release or please make a note on how to do this with this API version.\n\nThanks\njai", "id": 133529, "time": "2010-01-11T20:47:57Z", "creator": "jaibabus@gmail.com", "creation_time": "2010-01-11T20:47:57Z", "attachment_id": null}, {"text": "Hai Experts,\n\n   Is there any release with this function fix \"RANDBETWEEN()\".\n\nThanks\nJaibabu.J", "tags": [], "bug_id": 48526, "is_private": false, "count": 1, "id": 133873, "time": "2010-01-24T20:01:30Z", "creator": "jaibabus@gmail.com", "creation_time": "2010-01-24T20:01:30Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 48526, "is_private": false, "text": "I guess RANDBETWEEN is not a very popular function.  If you are able to write an implementation yourself and submit a patch, it is likely to get added more quickly.\n\nSimilar functions already exist in NumericFunction.java:\nhttp://svn.apache.org/viewvc/poi/trunk/src/java/org/apache/poi/hssf/record/formula/functions/NumericFunction.java?annotate=893403\n\n\nContributions are always welcome.", "id": 133874, "time": "2010-01-24T23:17:05Z", "creator": "josh@apache.org", "creation_time": "2010-01-24T23:17:05Z", "attachment_id": null}, {"text": "Created attachment 25876\nAdds support for RANDBETWEEN() function. The zip file contains a svn diff and a tar file which contains an Excel spreadsheet for testing\n\nRANDBETWEEN is one of the Analysis Toolpak formula and I have implemented it as such rather than an entry in NumericFunctions\n\nOne strange behavior I noticed while formulating Testcases for the function was that it can't be assigned into a workbook created directly in POI. The same is true for all the currently implemented ATP functions ISEVEN(), ISODD() and YEARFRAC()\n\nIf you run the following\n\nWorkbook wb = new HSSFWorkbook();\t\nSheet sheet = wb.createSheet(\"ATPSheet\");\nRow row = sheet.createRow(0);\nCell formulaCell = row.createCell(0, HSSFCell.CELL_TYPE_FORMULA);\nformulaCell.setCellFormula(\"ISEVEN()\");\n\nYou will get the following exception:\n\nException in thread \"main\" org.apache.poi.ss.formula.FormulaParseException: Name 'ISEVEN' is completely unknown in the current workbook\n\tat org.apache.poi.ss.formula.FormulaParser.function(FormulaParser.java:914)\n\tat org.apache.poi.ss.formula.FormulaParser.parseNonRange(FormulaParser.java:552)\n\tat org.apache.poi.ss.formula.FormulaParser.parseRangeable(FormulaParser.java:423)\n\tat org.apache.poi.ss.formula.FormulaParser.parseRangeExpression(FormulaParser.java:266)\n\tat org.apache.poi.ss.formula.FormulaParser.parseSimpleFactor(FormulaParser.java:1113)\n\tat org.apache.poi.ss.formula.FormulaParser.percentFactor(FormulaParser.java:1073)\n\tat org.apache.poi.ss.formula.FormulaParser.powerFactor(FormulaParser.java:1060)\n\tat org.apache.poi.ss.formula.FormulaParser.Term(FormulaParser.java:1420)\n\tat org.apache.poi.ss.formula.FormulaParser.additiveExpression(FormulaParser.java:1520)\n\tat org.apache.poi.ss.formula.FormulaParser.concatExpression(FormulaParser.java:1504)\n\tat org.apache.poi.ss.formula.FormulaParser.comparisonExpression(FormulaParser.java:1461)\n\tat org.apache.poi.ss.formula.FormulaParser.unionExpression(FormulaParser.java:1441)\n\tat org.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:1562)\n\tat org.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:174)\n\tat org.apache.poi.hssf.model.HSSFFormulaParser.parse(HSSFFormulaParser.java:72)\n\tat org.apache.poi.hssf.usermodel.HSSFCell.setCellFormula(HSSFCell.java:598)\n\nIf you open a Workbook that has the ATP formula already present they you are able to assign the formula to new cells without issue.\n\nIs this expected behavior or is there a defect with the ATP functions? Or do you need to alter the workbook after creation to support the ATP functions?", "tags": [], "bug_id": 48526, "attachment_id": 25876, "count": 3, "id": 139047, "time": "2010-08-10T18:36:17Z", "creator": "brendan.nolan@gmail.com", "creation_time": "2010-08-10T18:36:17Z", "is_private": false}, {"count": 4, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "text": "Thanks for the patch, applied in r984796\n\n> If you open a Workbook that has the ATP formula already present they you are\n> able to assign the formula to new cells without issue.\n> \n> Is this expected behavior or is there a defect with the ATP functions? Or do\n> you need to alter the workbook after creation to support the ATP functions?\n\nThis is currently a limitation of POI. We can evaluate UDFs from the Analysis Toolpack but we cannot assign formulas containing these functions. It may seem an easy task, but unfortunately it is not. \n\nFirstly, FormulaParser needs additional information to process a user defined formula token. This additional information should describe the number of arguments and their type, type of the returned value, etc. For built-in functions this is described by org.apache.poi.hssf.record.formula.functionFunctionMetadata and functionMetadata.txt, I guess we will need something similar for the Analysis Toolpack.  \n\nSecondly, each UDF used in a workbook must have a corresponding EXTERNALNAME record, this is how Excel resolves user-defined functions. Suppose you open a Workbook that has formulas with ATP functions. Each used ATP has a corresponding EXTERNALNAME record and is registered in the workbook-global LinkTable:\n\nISEVEN      --> EXTERNALNAME \nRANDBETWEEN --> EXTERNALNAME \n\nwhere all EXTERNALNAME records are aggregated in a LinkTable.\n\nWhen you assign more formulas with ISEVEN and RANDBETWEEN, the FormulaParser resolves their names via the list of EXTERNALNAME and the assignment is successful. When you assign formulas with ISEVEN and RANDBETWEEN to a new workbook then the LinkTable is empty and you get a \"completely unknown\" exception.\n\nYegor", "id": 139073, "time": "2010-08-12T10:27:42Z", "bug_id": 48526, "creation_time": "2010-08-12T10:27:42Z", "is_private": false}]