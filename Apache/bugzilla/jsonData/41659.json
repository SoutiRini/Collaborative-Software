[{"count": 0, "tags": [], "text": "Whilst I didn't ever meet a problem caused by this, I spotted a possible flaw in\napr_os_locale_encoding() as shown in the following part:\n\n--- \nAPR_DECLARE(const char*) apr_os_locale_encoding (apr_pool_t *pool)\n{\n#if defined(HAVE_NL_LANGINFO) && defined(CODESET)\n    const char *charset;\n\n    charset = nl_langinfo(CODESET);\n    if (charset && *charset) {\n#ifdef _OSD_POSIX /* Bug workaround - delete as soon as fixed in OSD_POSIX */\n        /* Some versions of OSD_POSIX return nl_langinfo(CODESET)=\"^[nN]\" */\n        /* Ignore the bogus information and use apr_os_default_encoding() */\n        if (charset[0] != '^')\n#endif\n        return charset;\n    }\n#endif\n\n    return apr_os_default_encoding(pool);\n}\n--- \n\nAs stated in the nl_langinfo() spec\n(http://www.opengroup.org/onlinepubs/009695399/functions/nl_langinfo.html ), the\npointer returned by nl_langinfo() may be transient and subject to race\nconditions as well, so it's better off duplicating it instead of returning the\noriginal one.\n\nHTH,\nMoriyoshi", "is_private": false, "bug_id": 41659, "id": 99570, "time": "2007-02-20T00:08:27Z", "creator": "moriyoshi@at.wakwak.com", "creation_time": "2007-02-20T00:08:27Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 41659, "attachment_id": null, "id": 101821, "time": "2007-04-17T14:36:51Z", "creator": "wrowe@apache.org", "creation_time": "2007-04-17T14:36:51Z", "is_private": false, "text": "fixed in r529774 and it's backports to the next 0.9 and 1.2\n\nthanks for the report!"}]