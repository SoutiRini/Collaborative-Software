[{"count": 0, "attachment_id": null, "bug_id": 51753, "text": "consider following setup:\n\nTomcat server.xml:\n------------------\n<?xml version='1.0' encoding='utf-8'?>\n<Server port=\"8005\" shutdown=\"SHUTDOWN\">\n  <!--Initialize Jasper prior to webapps are loaded. Documentation at /docs/jasper-howto.html -->\n  <Listener className=\"org.apache.catalina.core.JasperListener\" />\n  <!-- JMX Support for the Tomcat server. Documentation at /docs/non-existent.html -->\n  <Listener className=\"org.apache.catalina.mbeans.ServerLifecycleListener\" />\n  <Listener className=\"org.apache.catalina.mbeans.GlobalResourcesLifecycleListener\" />\n\n  <GlobalNamingResources>\n  </GlobalNamingResources>\n<Service name=\"Catalina\">\n    <Connector port=\"8080\" protocol=\"HTTP/1.1\" maxThreads=\"150\"\n               connectionTimeout=\"20000\" URIEncoding=\"UTF-8\" useBodyEncodingForURI=\"false\"\n               redirectPort=\"443\" />\n\t<Connector port=\"8009\" protocol=\"AJP/1.3\" URIEncoding=\"UTF-8\" useBodyEncodingForURI=\"false\" redirectPort=\"443\" />\n    <Engine name=\"Catalina\" defaultHost=\"localhost\">\n\t\t<Host name=\"localhost\"  appBase=\"webapps\"\n            unpackWARs=\"true\" autoDeploy=\"false\" deployOnStartup=\"true\"\n            xmlValidation=\"false\" xmlNamespaceAware=\"false\"/>\n    </Engine>\n  </Service>  \n<Service name=\"CatalinaMobile\">\n    <Connector port=\"9090\" protocol=\"HTTP/1.1\" maxThreads=\"150\"\n               connectionTimeout=\"20000\" URIEncoding=\"UTF-8\" useBodyEncodingForURI=\"false\"\n               redirectPort=\"443\" />\n\t<Connector port=\"9009\" protocol=\"AJP/1.3\" URIEncoding=\"UTF-8\" useBodyEncodingForURI=\"false\" redirectPort=\"443\" />\n    <Engine name=\"CatalinaMobile\" defaultHost=\"localhost\">\n\t\t<Host name=\"localhost\"  appBase=\"webapps-mobile\"\n            unpackWARs=\"true\" autoDeploy=\"false\" deployOnStartup=\"true\"\n            xmlValidation=\"false\" xmlNamespaceAware=\"false\"/>\n    </Engine>\n  </Service>\n  \n</Server>\n\n\nAll the directories have been created (conf/CatalineMobile/localhost, webapps-mobile)\n\nBoth Engines have a ROOT webapp deployed. However, when starting tomcat,\nonly the applications for the FIRST <Service> are being started\n\nSee below the output from tomcat:\n\n\n\ncmd /c E:\\dev-env\\tomcat\\bin\\catalina.bat run\n-Xms256M -Xmx1024M -Dsolr.solr.home=E:\\dev-env\\solr\\ -Xdebug -Xrunjdwp:transport=dt_socket,address=127.0.0.1:4933,suspend=y,server=n \nUsing CATALINA_BASE:   \"C:\\Documents and Settings\\nd828245\\.IntelliJIdea10\\system\\tomcat\\Unnamed_ecommerce\"\nUsing CATALINA_HOME:   \"E:\\dev-env\\tomcat\"\nUsing CATALINA_TMPDIR: \"E:\\dev-env\\tomcat\\temp\"\nUsing JRE_HOME:        \"E:\\dev-env\\java\"\nUsing CLASSPATH:       \"E:\\dev-env\\tomcat\\bin\\bootstrap.jar\"\nConnected to the target VM, address: '127.0.0.1:4933', transport: 'socket'\n1-sep-2011 17:30:58 org.apache.coyote.http11.Http11Protocol init\nINFO: Initializing Coyote HTTP/1.1 on http-9090\n1-sep-2011 17:30:58 org.apache.coyote.http11.Http11Protocol init\nINFO: Initializing Coyote HTTP/1.1 on http-8080\n1-sep-2011 17:30:58 org.apache.catalina.startup.Catalina load\nINFO: Initialization processed in 402 ms\n1-sep-2011 17:30:58 org.apache.catalina.realm.JAASRealm setContainer\nINFO: Set JAAS app name CatalinaMobile\n1-sep-2011 17:30:58 org.apache.catalina.realm.JAASRealm setContainer\nINFO: Set JAAS app name Catalina\n1-sep-2011 17:30:58 org.apache.catalina.core.StandardService start\nINFO: Starting service CatalinaMobile\n1-sep-2011 17:30:58 org.apache.catalina.core.StandardEngine start\nINFO: Starting Servlet Engine: Apache Tomcat/6.0.29\n1-sep-2011 17:30:58 org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory ROOT\n1-sep-2011 17:30:59 org.apache.catalina.core.ApplicationContext log\n\n<----- SNIP APPLICATION BOOTSTRAP LOGGING ---->\n\n1-sep-2011 17:31:23 org.apache.coyote.http11.Http11Protocol start\nINFO: Starting Coyote HTTP/1.1 on http-9090\n1-sep-2011 17:31:23 org.apache.jk.common.ChannelSocket init\nINFO: JK: ajp13 listening on /0.0.0.0:9009\n1-sep-2011 17:31:23 org.apache.jk.server.JkMain start\nINFO: Jk running ID=0 time=0/32  config=null\n1-sep-2011 17:31:23 org.apache.catalina.core.StandardService start\nINFO: Starting service Catalina\n1-sep-2011 17:31:23 org.apache.catalina.core.StandardEngine start\nINFO: Starting Servlet Engine: Apache Tomcat/6.0.29\n1-sep-2011 17:31:23 org.apache.coyote.http11.Http11Protocol start\nINFO: Starting Coyote HTTP/1.1 on http-8080\n1-sep-2011 17:31:23 org.apache.jk.common.ChannelSocket init\nINFO: JK: ajp13 listening on /0.0.0.0:8009\n1-sep-2011 17:31:23 org.apache.jk.server.JkMain start\nINFO: Jk running ID=0 time=0/0  config=null\n1-sep-2011 17:31:23 org.apache.catalina.startup.Catalina start\nINFO: Server startup in 24969 ms\nConnected to server\n\n\nAs you can see, no attempt to even start any application is made for the second Service.\nSwapping the order of the <Service> elements in server.xml indicates only the FIRST one is taken into account.", "id": 148956, "time": "2011-09-01T15:43:03Z", "creator": "niki.driessen@gmail.com", "creation_time": "2011-09-01T15:43:03Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "text": "By the way, as you will notice in the server.xml I supplied (which is a tomcat 6 one), I also tested this on tomcat 6, same result...\nThe same setup on tomcat 7 produces the exact same result\n\nTested on:\nTomcat 6\nTomcat 7.0.20\n\nTested on:\nWindows XP\nRedhat Linux Enterprise 5", "attachment_id": null, "id": 148957, "creator": "niki.driessen@gmail.com", "time": "2011-09-01T15:59:47Z", "bug_id": 51753, "creation_time": "2011-09-01T15:59:47Z", "is_private": false}, {"count": 2, "attachment_id": null, "creator": "markt@apache.org", "is_private": false, "id": 148983, "time": "2011-09-02T12:42:40Z", "bug_id": 51753, "creation_time": "2011-09-02T12:42:40Z", "tags": [], "text": "This works for me on Tomcat 7 using the server.xml you provided.\n\nThis looks like a configuration problem and the users list is the place to seek help.\n\nIf you do re-open this issue, you'll need to provide the exact steps to reproduce this issue on a clean install of the latest release of Tomcat 7.0.x."}, {"count": 3, "attachment_id": null, "bug_id": 51753, "text": "I tried it on clean installs of each version\nAnyway, issue seems related to the IDE used to start Tomcat\nso I reported the bug on their side now\n\nThanks for looking into it and apologies for not considering in the first place that the IDE might have something to do with it :-s", "id": 148997, "time": "2011-09-02T16:53:26Z", "creator": "niki.driessen@gmail.com", "creation_time": "2011-09-02T16:53:26Z", "tags": [], "is_private": false}]