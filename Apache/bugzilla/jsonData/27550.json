[{"count": 0, "attachment_id": null, "bug_id": 27550, "is_private": false, "id": 53762, "time": "2004-03-09T22:10:05Z", "creator": "dilinger@voxel.net", "creation_time": "2004-03-09T22:10:05Z", "tags": [], "text": "Currently, apache2 includes a full version of pcre-3.9 in its sources;\nthis is built during compilation, and statically linked against.  The\nsymbols from this library, are exported to apache modules.  This is\nundesirable for some apache modules; for example, php.  Php links\nagainst libpcre on the system; however, it will happily pick up the pcre\nsymbols in the apache binary before the symbols in the pcre shared\nlibrary.  This breaks php functions such as pcre_match(), which expect a\nrelatively new version of pcre to be used (3.9 doesn't cut it; it always\nfails w/ that).\n\nThere are a number of solutions, here.  I attempted upgrading the pcre\nincluded in apache; however, I had no way to know if the various win32\nhacks introduced to the pcre build system would still work.  I opted to\nnot bother, since I have no way to test such work except for on a unix\nsystem.\n\nAn alternate solution is to check for pcre on the build system, and link\nagainst that instead of building pcre for apache.  This works, but\nintroduces other issues.  With apache2 looking for the posix regex\nfunctions in shared libraries, it ends up using the glibc\nimplementations for reg{comp,exec,free,error} instead of the pcre\nimplementations of these function.  On my system, the glibc\nimplementations segfault somewhere inside glibc; it's much safer to\nstick w/ the pcre versions.  So, aside from the autoconf-ery that's\nnecessary to do the pcre system checks, there are some additional code\nchanges necessary to make sure that the pcre functions are called\ninstead of the glibc functions.  This is mainly some ugly code\nduplication.  The patch that implements this change is here:\n<http://sloth.voxel.net/~dilinger/020-external_pcre.patch>\n\nA third solution is to simply change the internal pcre library to have\nits own namespace.  This ensures that apache uses a pcre that it's been\nfully tested with, while apache modules don't use them in place of a\nsystem-supplied pcre.  What I've done in the following patch is to\nprefix the posix regex functions in pcre with ap_pcreposix, and to\nprefix the other pcre regex functions with ap_pcre.  The interface that\napache is _suppose to_ export to modules has not changed.  That patch is\nhere:\n<http://sloth.voxel.net/~dilinger/021-pcre_mangle_symbols.patch>\n\nI prefer the 021-pcre_mangle_symbols.patch patch, even though it's\nlarger; it ensures stability, at the cost of some code duplication.  The\n020-external_pcre.patch patch isn't as clean as I'd hoped, and for the\nadded complexity, not much memory is saved.\n\nAnyways, links to both patches are supplied so that you folks can decide\nbetween the preferred method.  Please consider applying either one of my\npatches, or an equivalent patch, so that pcre issues in external apache\nmodules are solved."}, {"count": 1, "tags": [], "bug_id": 27550, "attachment_id": 10733, "text": "Created attachment 10733\npatch to link against external libpcre", "id": 53763, "time": "2004-03-09T22:11:47Z", "creator": "dilinger@voxel.net", "creation_time": "2004-03-09T22:11:47Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 27550, "attachment_id": 10734, "id": 53764, "time": "2004-03-09T22:12:19Z", "creator": "dilinger@voxel.net", "creation_time": "2004-03-09T22:12:19Z", "is_private": false, "text": "Created attachment 10734\npatch to rename internal pcre functions"}, {"count": 3, "tags": [], "bug_id": 27550, "attachment_id": null, "text": "*** Bug 26088 has been marked as a duplicate of this bug. ***", "id": 53779, "time": "2004-03-09T23:57:30Z", "creator": "jorton@redhat.com", "creation_time": "2004-03-09T23:57:30Z", "is_private": false}, {"count": 4, "tags": [], "text": "hi all,\n\nthis problem's been around for awhile ... for at least a couple of years!\n\thttp://groups.google.com/groups?hl=en&lr=&ie=UTF\n-8&scoring=d&q=pcre+apache+%22multiple+definitions+of+symbol%22&btnG=Search\n\nit keeps getting reported primarily to the php boards, and repeatedly referred *back* as an Apache bug.\n\nbottom line:\n\t\n######################################################################\nAndres' patch (http://nagoya.apache.org/bugzilla/showattachment.cgi?attach_id=10734) \nseems to fix the problem.  can this get integrated into HEAD & the 2.0.50 RELEASE?\n######################################################################\n\non OSX, for quite awhile, i've been able to get around it by buildg httpd with its internal/included \npcre39, building an external build of pcre39, and linking php against the external lib via the LDFLACGS \n& CPPFLAGS\n\nhowever, with recent (for me, since yesterday)  httpd-head, building php --with-apxs aagain causes \nconflicts with apache's included pcre.  any inclusion/combination of any other (later) version, OR the \ninclusion of the php config param \"--with-pcre-regex=...\" results in 'make' errors/failures.\n\nreading thru Andres' patch submission here, i tried the 'replace-namespace' patch (link above).  per \nAndres, it seems to do the trick for Debian ...\n\nas for me, with patch applied in OSX, i'm now able to successfully build httpd w/ internal pcre -- now in \nits own namespace -- and build php500 --with-pcre against an external build of pcre45.\n\nhere _my_ 'recipe' for success ...\n\nthree 'pieces':\n(1) pcre 45\n(2) httpd 2.0.50 (there's a few other issues i'm having with latest HEAD, so i dropped back to 2.0.50 for \nthis)\n(3) php 500 release\n\nalso:\n\t% uname -v\n\t\tDarwin Kernel Version 7.5.0: Thu Aug  5 19:26:16 PDT 2004; root:xnu/xnu-517.7.21.obj~3/\nRELEASE_PPC \n\t% glibtool --version\n\t\tltmain.sh (GNU libtool) 1.5.8 (1.1220.2.117 2004/08/04 14:12:05)\n\t% automake --version\n\t\tautomake (GNU automake) 1.9\n\t% autoconf --version\n\t\tautoconf (GNU Autoconf) 2.59\n\t% gcc --version\n\t\tgcc (GCC) 3.3 20030304 (Apple Computer, Inc. build 1666)\n\t% /usr/local/ssl/bin/openssl version\n\t\tOpenSSL 0.9.7d 17 Mar 2004\n\n\n############################################################\npcre-4.5\nwget ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/pcre-4.5.tar.gz\ngnutar zxf pcre-4.5.tar.gz\ncd /usr/ports/pcre-4.5\nunsetenv CFLAGS CPPFLAGS CXX CXXFLAGS LDFLAGS LDDLFLAGS LD_PREBIND LINGUAS LC_ALL LANG\nglibtoolize --force --copy && aclocal && autoconf\n./configure \\\n--prefix=/usr/local/pcre45 \\\n--enable-shared --disable-static\nmake\nmake install\n\n############################################################\nhttpd-2.0.50\n\nwget ftp://apache.secsup.org/pub/apache/dist/httpd/httpd-2.0.50.tar.gz\ngnutar zxf httpd-2.0.50.tar.gz\ncd /usr/ports/httpd-2.0.50\n\ncurl -f -L -o patch.pcre.txt \"http://nagoya.apache.org/bugzilla/showattachment.cgi?attach_id=10734\"\npatch -p2 < patch.pcre.txt\nunsetenv CFLAGS CPPFLAGS CXX CXXFLAGS LDFLAGS LDDLFLAGS LD_PREBIND LC_ALL LANG LINGUAS\n./buildconf\n\n# enable linking against dlcompat's libdl\n=============================================================\n(EDITOR) /usr/ports/httpd-2.0.50/srclib/apr/configure\n@10433\n---\tenable_dlopen=no\n+++\tenable_dlopen=yes\n\tenable_win32_dll=no\n=============================================================\n\n./configure \\\n--with-mpm=worker \\\n--enable-layout=Darwin --with-port=80 \\\n--enable-mods-shared=all --enable-so --disable-static \\\n--sysconfdir=/etc/apache2 \\\n--enable-dav --enable-dav-fs --enable-dav-lock \\\n--enable-ssl --with-ssl=/usr/local/ssl \\\n--disable-suexec \\\n--with-z \\\n--enable-cgi \\\n--enable-proxy \\\n--enable-proxy-connect \\\n--enable-proxy-ftp \\\n--enable-proxy-http \\\n--enable-logio \\\n--enable-authn-dbm --enable-authz-dbm \\\n--with-imap\n\n\n# these lib links won't pick up from cmd line ... do it manually for now\n=============================================================\n(EDITOR) /usr/ports/httpd-2.0.50/build/config_vars.mk\n\tEXTRA_CFLAGS = -g -O2\n\tEXTRA_CXXFLAGS =\n---\tEXTRA_LDFLAGS = -L/usr/local/lib  -L/usr/local/ssl/lib\n+++\tEXTRA_LDFLAGS = -bind_at_load -L/usr/local/lib  -L/usr/local/ssl/lib\n---\tEXTRA_LIBS = -lssl -lcrypto\n+++\tEXTRA_LIBS = -lssl -lcrypto -lz -ldl -lexpat\n=============================================================\n\nmake\nmake install\n\n#################################################################\nphp-5.0.0\nwget http://us2.php.net/distributions/php-5.0.0.tar.gz\ngnutar zxf php-5.0.0.tar.gz\n\nunsetenv CFLAGS CPPFLAGS CXX CXXFLAGS LDFLAGS LDDLFLAGS LD_PREBIND EXTRA_LDFLAGS \nEXTRA_LIBS LC_ALL LANG LINGUAS ;\\\nsetenv LC_ALL C ;\\\nsetenv LANG C ;\\\nsetenv CPPFLAGS \"-I/usr/local/ssl/include -I/usr/local/pcre45/include -I/usr/local/include\" ;\\\nsetenv LDFLAGS \"-bind_at_load  -L/usr/local/ssl/lib -lssl -lcrypto -L/usr/local/pcre45/lib -lpcre\"\n\n=============================================================\n(EDITOR) /usr/ports/php-5.0.0/configure.in\n---\tAC_PROG_RANLIB\n+++\tAC_PROG_LIBTOOL\n=============================================================\n\ncd /usr/ports/php-5.0.0\nautoconf\nranlib /usr/local/pgsql/lib/libpq.a\n\n./configure \\\n--disable-debug \\\n--prefix=/usr --with-layout=PHP \\\n--with-config-file-path=/etc/php5 --sysconfdir=/etc/php5 \\\n--enable-shared --disable-static \\\n--libdir=/System/Library/PHP \\\n--includedir=/usr/include \\\n--mandir=/usr/local/man \\\n--localstatedir=/var/php4 \\\n--with-db4=/usr \\\n--with-pgsql=/usr/local/pgsql --without-mysql \\\n--enable-cli --with-pear=/System/Library/PHP \\\n--disable-cgi \\\n--with-apxs2=/usr/sbin/apxs \\\n--disable-dmalloc \\\n--with-tsrm-pthreads \\\n--enable-shmop --enable-sockets \\\n--enable-inline-optimization \\\n--enable-xml --enable-libxml --with-libxml-dir=/usr \\\n--with-java=/Library/Java/Home \\\n--with-openssl=/usr/local/ssl --with-openssl-dir=/usr/local/ssl \\\n--with-zlib --with-zlib-dir=/usr \\\n--with-imap=/usr/local/imap --enable-mailparse \\\n--with-imap-ssl=/usr/local/ssl \\\n--with-mcrypt --with-mhash \\\n--with-gmp=/usr/local \\\n--with-gd=/usr/local/gd \\\n--with-png-dir=/usr/local \\\n--with-jpeg-dir=/usr/local \\\n--with-tiff-dir=/usr/local \\\n--enable-magic-quotes \\\n--enable-calendar \\\n--disable-mbstring \\\n--with-kerberos=/usr \\\n--with-freetype-dir=/usr/X11R6 \\\n--with-xpm-dir=/usr/X11R6 \\\n--enable-exif \\\n--enable-ftp \\\n--enable-bcmath \\\n--with-pcre-regex=/usr/local/pcre45\n\nmake\nmake install\n\ncheers,\n\nrichard", "attachment_id": null, "id": 61740, "creator": "apache-bugs.20.openmacnews@spamgourmet.com", "time": "2004-08-10T06:52:48Z", "bug_id": 27550, "creation_time": "2004-08-10T06:52:48Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 27550, "attachment_id": null, "id": 62735, "time": "2004-08-30T07:27:22Z", "creator": "chip@force-elite.com", "creation_time": "2004-08-30T07:27:22Z", "is_private": false, "text": "*** Bug 23952 has been marked as a duplicate of this bug. ***"}, {"count": 6, "tags": [], "creator": "rich@annexia.org", "attachment_id": null, "is_private": false, "id": 63076, "time": "2004-09-04T13:06:52Z", "bug_id": 27550, "creation_time": "2004-09-04T13:06:52Z", "text": "This bug is really important to fix.  I can't get my mod_caml module\nworking with Apache 2.0 until it's fixed.  This prevents a significant\nuserbase from migrating to Apache 2.\n\nMy duplicate bug report contains some other information: Bug 23952"}, {"count": 7, "tags": [], "creator": "alan.schmitt@polytechnique.org", "attachment_id": null, "is_private": false, "id": 63149, "time": "2004-09-07T11:00:58Z", "bug_id": 27550, "creation_time": "2004-09-07T11:00:58Z", "text": "I just had this problem as well, trying to install a Caml based wiki. If I add\nthe \"LoadModule caml_module modules/mod_caml.so\" to my httpd.conf file, apache\njust keeps segfaulting.\n\nUnfortunately this is on a server where we need apache2, so this means that\nuntil this fix is integrated, I cannot use mod_caml (and every other mod that\nneed a recent pcre library, it seems)."}, {"count": 8, "tags": [], "creator": "nick@webthing.com", "attachment_id": null, "id": 63683, "time": "2004-09-16T23:22:38Z", "bug_id": 27550, "creation_time": "2004-09-16T23:22:38Z", "is_private": false, "text": "Adding PatchAvailable keyword"}, {"count": 9, "tags": [], "creator": "apache-bugs.20.openmacnews@spamgourmet.com", "attachment_id": null, "id": 63761, "time": "2004-09-18T02:33:26Z", "bug_id": 27550, "creation_time": "2004-09-18T02:33:26Z", "is_private": false, "text": "just building httpd2.0.51 ...\n\nit seems this bug is STILL not resolved.\n\nthere's a demonstrated, working patch (cref: Andreas, below) that fixed the issue in 2.0.50, and \n(seemingly) applies to 2.0.51 as well ... \n\nis there a particular reason why this known/reported/fixed issue is NOT being integrated?\n\nthx,\n\nrichard"}, {"count": 10, "tags": [], "bug_id": 27550, "is_private": false, "text": "There are some subtle issues with this: \n\n1) with an httpd built to use an external pcre, the include/pcre.h which gets\ninstalled does not match the pcre which is actually used.  It's possible that\nsome third-party modules will depend on this.\n\n2) Renaming both the reg* and pcre_* functions is a binary compatibility issue.", "id": 63763, "time": "2004-09-18T07:22:05Z", "creator": "jorton@redhat.com", "creation_time": "2004-09-18T07:22:05Z", "attachment_id": null}, {"count": 11, "tags": [], "creator": "apache-bugs.20.openmacnews@spamgourmet.com", "attachment_id": null, "is_private": false, "id": 64445, "time": "2004-09-30T17:52:29Z", "bug_id": 27550, "creation_time": "2004-09-30T17:52:29Z", "text": "hi,\n\ni'm back again!\n\ni'm building httpd 2.0.52 + php 5.0.2 on OSX 10.3.5\n\nthe ONLY way i'm able to get httpd & php to 'play nice' together -- avoiding later/'downstream' pcre \nconflicts -- is to make sure that they're built using the SAME version of pcre.\n\nthere are two options to that end ...\n\n(a)\n        build httpd w/ INTERNAL pcre (v3.9)\n        build external pcre3.9\n        build php 502 against pcre3.9/external\n\n(b)\n        apply Andreas' patch to httpd (*luckily* the patch still works against 2.0.52 ...)\n        build external pcre5.0\n        build httpd 2.0.52 against pcre5.0/external\n        build php 5.0.2 against pcre5.0/external\n\n(a), of course, locks PHP into the use of pcre3.9 ... which is simply not acceptable/tenable for a variety \nof other apps that need >= v4.5\n\nso, (b) is really the only functional option here ...\n\nacknowledging 'possible subleties' from  Joe's reference above, the php issue is neither subtle, nor \nsimply possible ... others as well (cref above) are noting problems with, e.g., mod_caml that requires a \nmore recent pcre.\n\nwhat need to be done to get this solution addressed/integrated?  even ASSIGNED would be a good start!\n\nthis has been an unaddressed issue problem for QUITE awhile ...\n\nrichard"}, {"count": 12, "attachment_id": null, "creator": "rich@annexia.org", "is_private": false, "id": 64447, "time": "2004-09-30T18:00:30Z", "bug_id": 27550, "creation_time": "2004-09-30T18:00:30Z", "tags": [], "text": "Agree with the previous comment.\n\nmod_caml cannot use anything except an external, modern PCRE, so somehow\nlinking it against Apache's ancient version of PCRE is a non-starter,\neven if it were possible.\n\nThis bug is a showstopper for a variety of important modules, so it\nshould be fixed (particularly, since there's even a patch to do it)."}, {"count": 13, "tags": [], "bug_id": 27550, "attachment_id": 13377, "is_private": false, "id": 66660, "time": "2004-11-10T09:16:24Z", "creator": "rich@annexia.org", "creation_time": "2004-11-10T09:16:24Z", "text": "Created attachment 13377\nAmended version of patch by Andres Salomon, with typo fixed by Paul Argentoff"}, {"count": 14, "attachment_id": null, "bug_id": 27550, "is_private": false, "id": 66661, "time": "2004-11-10T09:17:28Z", "creator": "rich@annexia.org", "creation_time": "2004-11-10T09:17:28Z", "tags": [], "text": "The following notes were sent to me by Paul Argentoff to\naccompany the preceeding patch.\n\n  - - - - - -\n\nThis is patch by Andres Salomon <dilinger@voxel.net>, with typo fixed by Paul\nArgentoff <argentoff@rtelekom.ru>\n\nThis patch fixes problems seen by apache modules attempting to run regex\nstuff, and getting apache's internal pcre implementation.  It contains\ntwo parts; the first (the autoconf stuff) checks if libpcre is installed\non the host system.  If it is, that pcre is used to build apache2.  If\nit's not, apache2 compiles its own pcre, and statically links against\nit.  \n\nThe second part of this patch forces pcre to be used.  Apache, by\ndefault, calls the posix regex functions (reg{exec,comp,free,error})\ninternally.  If glibc was sane, this would be fine.  Unfortunately, it's\nnot.  So, when apache calls these regex functions, it's anyones guess as\nto whether it will use glibc's regex functions, or the pcre regex\nfunctions.  The glibc regex functions segfault (within glibc) on my\nsystem.  So, to ensure sanity, we force use of pcre regex functions.\n\nI need to do a bit more testing w/ apache's internal pcre, but for\ndebian's purposes (pcre in /usr), it works fine.\n"}, {"count": 15, "tags": [], "creator": "ogunden@phauna.org", "attachment_id": null, "id": 67370, "time": "2004-11-23T00:30:23Z", "bug_id": 27550, "creation_time": "2004-11-23T00:30:23Z", "is_private": false, "text": "Pleeeeeeeeeeeeease incorporate this fix?  I'll bake you cookies!"}, {"count": 16, "tags": [], "text": "Ok, I've created a new patch that should supercede both other patches.  This\npatch checks for regex support via libc, and will use that if found.  If the\nlibc doesn't support POSIX.2 regex functions, it will then check for\nan external pcre; if found, it links against that.  If it doesn't find\nthat, it finally falls back to compiling and linking against its own\ninternal pcre library.\n\nThis patch is also significantly smaller than my other two patches, as it\ndoesn't require any widespread symbol changes.  I've tested compilation\nwith and without regex.h and pcre-dev.  Testers whose libc specifically lacks\nregex support are requested (all testers welcome, of course :)\n\nI'll follow up w/ fixes as necessary.", "is_private": false, "bug_id": 27550, "id": 67997, "time": "2004-12-06T22:01:08Z", "creator": "dilinger@voxel.net", "creation_time": "2004-12-06T22:01:08Z", "attachment_id": null}, {"count": 17, "tags": [], "bug_id": 27550, "attachment_id": null, "id": 67998, "time": "2004-12-06T22:04:26Z", "creator": "nd@perlig.de", "creation_time": "2004-12-06T22:04:26Z", "is_private": false, "text": "We won't use any POSIX regex stuff. The PCRE is used on purpose..."}, {"count": 18, "tags": [], "bug_id": 27550, "attachment_id": 13661, "id": 67999, "time": "2004-12-06T22:07:12Z", "creator": "dilinger@voxel.net", "creation_time": "2004-12-06T22:07:12Z", "is_private": false, "text": "Created attachment 13661\nmore intelligent patch to link against PCRE\n\nPatch against apache 2.0.52; use libc's regex functions, falling back to\nexternal pcre, and finally building internal pcre only if absolutely necessary."}, {"count": 19, "tags": [], "bug_id": 27550, "is_private": false, "text": "(In reply to comment #17)\n> We won't use any POSIX regex stuff. The PCRE is used on purpose...\n\nWhy not?  What specifically is broken regarding the libc-provided POSIX regex\nstuff?  And, why not test for breakage, instead of unconditionally using PCRE\nwhen   it's probably not even necessary?", "id": 68000, "time": "2004-12-06T22:09:44Z", "creator": "dilinger@voxel.net", "creation_time": "2004-12-06T22:09:44Z", "attachment_id": null}, {"count": 20, "tags": [], "bug_id": 27550, "attachment_id": null, "id": 68001, "time": "2004-12-06T22:14:37Z", "creator": "nd@perlig.de", "creation_time": "2004-12-06T22:14:37Z", "is_private": false, "text": "Consistency among the various installations and way more power."}, {"count": 21, "attachment_id": null, "bug_id": 27550, "is_private": false, "id": 68006, "time": "2004-12-06T22:46:51Z", "creator": "dilinger@voxel.net", "creation_time": "2004-12-06T22:46:51Z", "tags": [], "text": "In that case, instead of using the POSIX functions, we should probably just be\nusing the PCRE functions..."}, {"count": 22, "tags": [], "text": "That's a good point and I personally agree. This should be discussed on dev@\nanyway. The best would be with a patch backhand :)", "attachment_id": null, "id": 68008, "creator": "nd@perlig.de", "time": "2004-12-06T22:55:58Z", "bug_id": 27550, "creation_time": "2004-12-06T22:55:58Z", "is_private": false}, {"count": 23, "tags": [], "creator": "jorton@redhat.com", "attachment_id": null, "is_private": false, "id": 68010, "time": "2004-12-06T23:07:00Z", "bug_id": 27550, "creation_time": "2004-12-06T23:07:00Z", "text": "More than that, httpd *cannot* use a real POSIX regex implementation rather than\nPCRE: even the default config actually uses some of the Perl extensions to the\nregex grammar (the \"(?:\" stuff IIRC?)."}, {"count": 24, "attachment_id": null, "creator": "jorton@redhat.com", "is_private": false, "id": 70842, "time": "2005-02-11T16:47:21Z", "bug_id": 27550, "creation_time": "2005-02-11T16:47:21Z", "tags": [], "text": "This is all now done on the trunk based on Andres' patches - thanks a lot!\n\nAgain, it can't really be backported to 2.0, unfortunately, because it changes\nthe module interface."}, {"count": 25, "tags": [], "creator": "apache-bugs.20.openmacnews@spamgourmet.com", "attachment_id": null, "id": 70845, "time": "2005-02-11T17:04:45Z", "bug_id": 27550, "creation_time": "2005-02-11T17:04:45Z", "is_private": false, "text": "hi,\n\n> Again, it can't really be backported to 2.0, unfortunately, because it changes the module interface.\n\nso iiuc, then, we've two options at this point:\n\n(1) STABLE 2.0.x release source + Andres' patches (assuming/hoping they continue to apply ...)\n(2) UNSTABLE cvs source, w/ functionality included.\n\ni.e., no STABLE solution until 2.1 release ... \n\nam i correct?\n\nthanks for the update!\n\nrichard"}, {"count": 26, "tags": [], "bug_id": 27550, "is_private": false, "text": "(In reply to comment #25)\n\nI just tried the most recent patch with Apache 2.0.53 and make failed:\n\nlibtool: link: cannot find the library `/Users/me/Desktop/webserver/httpd-2.0.53/srclib/pcre/\nlibpcre.la'\nmake[2]: *** [htpasswd] Error 1\nmake[1]: *** [all-recursive] Error 1\nmake: *** [all-recursive] Error 1", "id": 70911, "time": "2005-02-13T23:32:08Z", "creator": "apache@mailinator.com", "creation_time": "2005-02-13T23:32:08Z", "attachment_id": null}, {"count": 27, "attachment_id": null, "bug_id": 27550, "is_private": false, "id": 70933, "time": "2005-02-14T15:45:45Z", "creator": "jorton@redhat.com", "creation_time": "2005-02-14T15:45:45Z", "tags": [], "text": "(In reply to comment #25)\n> > Again, it can't really be backported to 2.0, unfortunately, because it\nchanges > > the module interface.\n> \n> so iiuc, then, we've two options at this point:\n\nYes, that's correct."}, {"count": 28, "tags": [], "text": "If anyone else is following this, the 2.1.3 alpha is out now, and it solved my problems.", "is_private": false, "bug_id": 27550, "id": 71405, "time": "2005-02-23T16:12:20Z", "creator": "apache@mailinator.com", "creation_time": "2005-02-23T16:12:20Z", "attachment_id": null}, {"count": 29, "tags": [], "bug_id": 27550, "attachment_id": null, "id": 71525, "time": "2005-02-25T17:45:54Z", "creator": "jorton@redhat.com", "creation_time": "2005-02-25T17:45:54Z", "is_private": false, "text": "*** Bug 28781 has been marked as a duplicate of this bug. ***"}, {"count": 30, "attachment_id": null, "bug_id": 27550, "is_private": false, "id": 75237, "time": "2005-05-23T20:59:07Z", "creator": "pkl@datatech.ru", "creation_time": "2005-05-23T20:59:07Z", "tags": [], "text": "I have applied most recent Andres' patch (id=13661) against most recent current\nstable Apache - 2.0.54. Patched sources compile cleanly, but at run-time Apaches\ncrashes/segfaults immediately after parsing any regex in config file.\n\nHere are some details: in my system this patch selects glibc's implementation of\nregex. If there are not regexes in config file, then apache starts successfully.\nIf there is regex in config file, it compiles without problem. Using gdb,\n\n(gdb) break regcomp\n(gdb) r\n(gdb) bt\n#0  0x403bf852 in regcomp () from /lib/libc.so.6\n#1  0x08071714 in ap_pregcomp (p=0x809b0a8, pattern=0x80d3bd0 \"^\\\\.ht\",\ncflags=135085008) at util.c:268\n#2  0x0807ca4e in filesection (cmd=0xbffff990, mconfig=0x80d3bd0, arg=0x80d3bc1\n\"\") at core.c:1837\n#3  0x0806b5f1 in invoke_cmd (cmd=0x808e2e8, parms=0xbffff990,\nmconfig=0x80b59f0, args=0x80d2b90 \"~ \\\"^\\\\.ht\\\">\")\n    at config.c:797\n#4  0x0806bf06 in ap_walk_config (current=0x80d2b70, parms=0xbffff990,\nsection_vector=0x80b58e0) at config.c:1060\n#5  0x0806cd2f in ap_process_config_tree (s=0x80d3bd8, conftree=0x80d3bd0,\np=0x809b0a8, ptemp=0x80d3bd0)\n    at config.c:1643\n#6  0x0806fa6b in main (argc=5, argv=0xbffffab4) at main.c:539\n\nBut, shortly, segfaults occurs:\n(gdb) cont\nContinuing.\n\nProgram received signal SIGSEGV, Segmentation fault.\ntrie_node_alloc (p=0x809b0a8, parent=0x809b518, c=95 '_') at util_filter.c:113\n113                 if (c == parent->children[i].c) {\n(gdb) bt\n#0  trie_node_alloc (p=0x809b0a8, parent=0x809b518, c=95 '_') at util_filter.c:113\n#1  0x080766a3 in register_filter (name=0x809b518 \"core_in\", filter_func=\n      {out_func = 0x807ed90 <core_input_filter>, in_func = 0x807ed90\n<core_input_filter>}, filter_init=0, ftype=0, \n    reg_filter_set=0x809b518) at util_filter.c:217\n#2  0x08080611 in register_hooks (p=0x809b0a8) at core.c:4509\n#3  0x0806fb4f in main (argc=5, argv=0xbffffab4) at main.c:578"}, {"count": 31, "attachment_id": null, "creator": "dilinger@voxel.net", "is_private": false, "id": 75240, "time": "2005-05-23T21:49:29Z", "bug_id": 27550, "creation_time": "2005-05-23T21:49:29Z", "tags": [], "text": "This should be fixed in apache-2.1; Joe Orton incorported my patch into it, plus\nadded some additional fixes.  If you're going to use 2.0, don't use my patches\n(I'm not keeping them up-to-date); use Debian's.  Adam Conrad backported Joe's\nchanges for 2.0, and they're being kept up-to-date.\n\nftp://ftp.debian.org/debian/pool/main/a/apache2/\n\napt-get source apache2, or grab the patch out of the .diff.gz."}]