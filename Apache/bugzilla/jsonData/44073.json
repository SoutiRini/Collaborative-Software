[{"count": 0, "tags": [], "bug_id": 44073, "attachment_id": null, "id": 111762, "time": "2007-12-13T07:04:00Z", "creator": "yl@bee-ware.net", "creation_time": "2007-12-13T07:04:00Z", "is_private": false, "text": "The following code in httpd-2.2.6/modules/ssl/ssl_expr_eval.c assume a\nnul-terminated string which isn't (always) :\n\napr_array_header_t *ssl_extlist_by_oid(request_rec *r, const char *oidstr)\n{\n<snip>\n           BIO *bio = BIO_new(BIO_s_mem());\n\n           if (X509V3_EXT_print(bio, ext, 0, 0) == 1) {\n                BUF_MEM *buf;\n                char **new = apr_array_push(val_array);\n\n                BIO_get_mem_ptr(bio, &buf);\n\n                *new = apr_pstrdup(r->pool, buf->data);\n            }\n<snip>\n    if (val_array->nelts == 0)\n        return NULL;\n    else\n        return val_array;\n}\n\nNeither X509V3_EXT_print() nor BIO_get_mem_ptr() nul-terminate the BIO buffer,\nso 'buf->data' should be used in the limit of 'buf->length', that is :\n\n    *new = apr_pstrndup(r->pool, buf->data, buf->length);\n\nWhen SSLRequire is used with OIDs, the server can crash (exploitable?), or the\ncertificate extensions requirements can be bypassed since the value may contain\narbitrary trailing data."}, {"attachment_id": null, "tags": [], "creator": "yl@bee-ware.net", "text": "Sorry, httpd-2.2.6 is concerned by this bug, not the version 2.0.61 which\ndoesn't implement the certificate OIDs requirements.\n\nI want to submit a patch on httpd-2.0.61 for this to be handled, hence my confusion.", "count": 1, "id": 111765, "time": "2007-12-13T07:13:37Z", "bug_id": 44073, "creation_time": "2007-12-13T07:13:37Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 44073, "attachment_id": null, "id": 111786, "time": "2007-12-13T12:08:34Z", "creator": "rpluem@apache.org", "creation_time": "2007-12-13T12:08:34Z", "is_private": false, "text": "Proposed patch for inclusion to 2.2.x in r604012\n(http://svn.apache.org/viewvc/httpd/httpd/branches/2.2.x/STATUS?r1=604012&r2=604011&pathrev=604012)"}, {"count": 3, "tags": [], "text": "Ok for the patch in 2.2.x, but the problem is there in trunk too :\n           *ptr = apr_pstrmemdup(p, buf->data, buf->length);\nThis will not create a nul-terminated string either, while it is supposed to, I\nsuggest to use apr_strndup here too.\n\nShould I open a new ticket for trunk ?", "attachment_id": null, "bug_id": 44073, "id": 111803, "time": "2007-12-14T04:25:47Z", "creator": "yl@bee-ware.net", "creation_time": "2007-12-14T04:25:47Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 44073, "attachment_id": null, "text": "Trunk changes in http://svn.apache.org/viewvc?view=rev&revision=289444 has moved\nthe problem described above in httpd-trunk/modules/ssl/ssl_engine_vars.c,\nfunction ssl_ext_list()", "id": 111804, "time": "2007-12-14T04:34:00Z", "creator": "yl@bee-ware.net", "creation_time": "2007-12-14T04:34:00Z", "is_private": false}, {"count": 5, "tags": [], "text": "pstrmemdup does NUL-terminate the returned string.", "is_private": false, "id": 111815, "creator": "jorton@redhat.com", "time": "2007-12-14T12:38:27Z", "bug_id": 44073, "creation_time": "2007-12-14T12:38:27Z", "attachment_id": null}, {"count": 6, "tags": [], "creator": "rpluem@apache.org", "text": "Included in 2.2.x per r604403 (http://svn.apache.org/viewvc?rev=604403&view=rev).", "id": 111818, "time": "2007-12-15T00:44:36Z", "bug_id": 44073, "creation_time": "2007-12-15T00:44:36Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 44073, "attachment_id": null, "id": 111828, "time": "2007-12-17T01:45:33Z", "creator": "yl@bee-ware.net", "creation_time": "2007-12-17T01:45:33Z", "is_private": false, "text": "Sorry, I didn't notice that, the name drove me wrong.\nThanks for the patch."}]