[{"count": 0, "tags": [], "creator": "victor@mlnk.net", "text": "Hi,\nI tried to generate excel file from template. When opening generated file with \nExcel (2002) it displayed the message: \"File error. Some number formats may \nhave been lost.\".\n\nHere are the files:\n - template file (http://www.geocities.com/et_victor/template.xls)\n - generated file (http://www.geocities.com/et_victor/result.xls)\n \nThe source of a generator program follows:\nimport java.io.*;\nimport java.util.*;\nimport java.sql.*;\n\nimport beans.common.*;\nimport beans.customers.*;\n\nimport util.transfer.*;\n\nimport org.apache.poi.hssf.usermodel.*;\nimport org.apache.poi.poifs.filesystem.*;\n\npublic class ExcelGenerator\n{\n private static void generate(File objTemplate, File objTarget) throws Exception\n {\n  //open\n  FileInputStream fis = new FileInputStream(objTemplate);\n  POIFSFileSystem fs = new POIFSFileSystem(fis);\n  HSSFWorkbook wb = new HSSFWorkbook(fs);\n  fis.close();\n\n  FileOutputStream fileOut = new FileOutputStream(objTarget);\n  wb.write(fileOut);\n  fileOut.close();\n }\n\n public static void main(String[] args)\n {\n  try\n  {\n   File objTemplate = new File(\"c:/temp/template.xls\");\n   File objTarget = new File(\"c:/temp/result.xls\");\n   generate(objTemplate, objTarget);\n  }catch (Exception ex)\n  {\n   ex.printStackTrace();\n  }\n }\n}", "id": 23217, "time": "2002-09-22T06:50:10Z", "bug_id": 12899, "creation_time": "2002-09-22T06:50:10Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "victor@mlnk.net", "text": "Created attachment 3165\nTemplate file", "id": 23222, "time": "2002-09-22T10:59:37Z", "bug_id": 12899, "creation_time": "2002-09-22T10:59:37Z", "is_private": false, "attachment_id": 3165}, {"count": 2, "tags": [], "bug_id": 12899, "attachment_id": 3166, "text": "Created attachment 3166\nGenerated Excel file (corrupted)", "id": 23223, "time": "2002-09-22T11:02:40Z", "creator": "victor@mlnk.net", "creation_time": "2002-09-22T11:02:40Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 12899, "attachment_id": null, "text": "There are what I presume is an extended character in the custom number formats\nsaved in the file.  I bet HSSF is trying to render them as 8-bit (\"compressed\nunicode\") strings.  That of course is not going to work.\n\nSince this area has been recently enhanced please try this with the 1.8\ndevelopment release and report back.", "id": 23225, "time": "2002-09-22T16:58:32Z", "creator": "poi-support@buni.org", "creation_time": "2002-09-22T16:58:32Z", "is_private": false}, {"count": 4, "attachment_id": null, "creator": "victor@mlnk.net", "text": "Success!\nDevelopment release 1.8 fixes this.\nGenerated Excel file is read without any problems or error messages.\nGood work, guys!", "id": 23227, "time": "2002-09-22T20:04:36Z", "bug_id": 12899, "creation_time": "2002-09-22T20:04:36Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "bug_id": 12899, "attachment_id": null, "id": 23232, "time": "2002-09-23T00:25:39Z", "creator": "poi-support@buni.org", "creation_time": "2002-09-23T00:25:39Z", "is_private": false, "text": "Excellent.  Because this is a 2.0 feature, I'm marking it fixed in the 2.0-dev\nseries.  This feature won't be backported to 1.5.x."}]