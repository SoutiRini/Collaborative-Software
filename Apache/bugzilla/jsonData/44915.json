[{"count": 0, "tags": [], "bug_id": 44915, "attachment_id": null, "id": 116094, "time": "2008-05-01T07:18:43Z", "creator": "david.green@morganstanley.com", "creation_time": "2008-05-01T07:18:43Z", "is_private": false, "text": "I have a 'clean' target which deletes my build/lib and dist directories.\n\nI encountered a build error after build/lib was created and when I re-ran ant I get a error \"48: Jar's directory not found\".  Line 48 is the manifestclasspath piece.\n\nRe-running with 'ant clean' gets same error, even though 'clean' never attempts to create the jar and hence should never need to look to the manifestclasspath.\n\nRemoving manifestclasspath, rebuilding, adding manifestclasspath and rebuilding is the workaround I am using.\n\nIncidentally if you put a full dependency (e.g. ant 'all') for clean,copystatic,compile,jar,install there is NO error encountered so full successful builds aren't affected by this issue."}, {"count": 1, "tags": [], "creator": "peterreilly@apache.org", "attachment_id": null, "text": "There is not enough information here to debug your build file. \n\nPlease try to make the smallest build file that shows the\nissue and add it as an attachment to the bug report.\n", "id": 116096, "time": "2008-05-01T07:29:08Z", "bug_id": 44915, "creation_time": "2008-05-01T07:29:08Z", "is_private": false}, {"count": 2, "tags": [], "creator": "david.green@morganstanley.com", "is_private": false, "text": "<project name=\"SomeApplication\" default=\"all\">\n\n    <!-- PROJECT BASE / MAIN CLASS -->\n    <property name=\"basedir\" value=\".\" />\n    <property name=\"main.class\" value=\"com.anyapps.start.${ant.project.name}\" />\n\t\n    <!-- BUILD DIRECTORIES -->\n    <property name=\"source.dir\" value=\"${basedir}/src\" />\n    <property name=\"build.dir\" value=\"${basedir}/build\" />\n    <property name=\"classes.dir\" value=\"${build.dir}/classes\" />\n    <property name=\"jar.dir\" value=\"${build.dir}/jar\" />\n    <property name=\"jar.lib.dir\" value=\"${jar.dir}/lib\" />\n\t\n    <!-- DIST DIRECTORIES (see install target) -->\n    <property name=\"dist.dir\" value=\"${basedir}/dist\" />\n    <property name=\"lib.dir\" value=\"${dist.dir}/lib\" />\n\t\n    <target name=\"clean\">\n        <delete dir=\"${build.dir}\" />\n        <mkdir dir=\"${build.dir\" />\n        <mkdir dir=\"${classes.dir}\" />\n    </target>\n\t\n    <target name=\"copylib\" depends=\"clean\">\n        <delete dir=\"${dist.dir}\" />\n        <mkdir dir=\"${dist.dir}\" />\n        <mkdir dir=\"${jar.dir}\" />\n        <mkdir dir=\"${jar.lib.dir}\" />\n        <copy todir=\"${jar.lib.dir}\" overwrite=\"true\"> <!-- Copy Spring/Hibernate/JDBC libraries etc. -->\n            <fileset dir=\"${basedir}/lib\" />\n        </copy>\n        <mkdir dir=\"${lib.dir}\" />\n        <copy todir=\"${lib.dir}\" overwrite=\"true\">\n            <fileset dir=\"${basedir}/lib\" />\n        </copy>\n    </target>\n   \n\t<path id=\"build.classpath\">\n\t\t<fileset dir=\"${jar.lib.dir}\" includes=\"*.jar\" />\n\t</path>\n\t\n    <target name=\"compile\">\n        <javac srcdir=\"${source.dir}\" destdir=\"${classes.dir}\" classpathref=\"build.classpath\" />\n    </target>\n\t\n    <manifestclasspath property=\"jar.classpath\" jarfile=\"${jar.dir}/classpathjar.jar\">\n        <classpath refid=\"build.classpath\" />\n    </manifestclasspath>\n\t\t\n    <target name=\"jar\" depends=\"compile\">\n        <copy todir=\"${classes.dir}\"> <!-- Copy Hibernate, log4J config files etc. -->\n            <fileset dir=\"${source.dir}\" exclude=\"**/*.java\" />\n        </copy>\n        <jar destfile=\"${jar.dir}/${ant.project.name}.jar\" basedir=\"${classes.dir}\" index=\"no\">\n            <manifest>\n                <attribute name=\"Main-Class\" value=\"${main.class}\" />\n                <attribute name=\"Created-By\" value=\"DG\" />\n                <attribute name=\"Class-Path\" value=\"${jar-classpath}\" />\n            </manifest>\n        </jar>\n    </target>\n    \n    <target name=\"install\">\n        <copy file=\"${jar.dir}/${ant.project.name}.jar\" todir=\"${dist.dir}\" />\n    </target>\n\n    <target name=\"all\" depends=\"copylib, jar, install\" />\n        \n</project>", "id": 116097, "time": "2008-05-01T08:14:26Z", "bug_id": 44915, "creation_time": "2008-05-01T08:14:26Z", "attachment_id": null}, {"count": 3, "tags": [], "text": "Incidentally if I specified index=\"true\" when building the jar the classpath in the classpath specified in teh manifest is NOT searched.\n\nI think this could trip a lot of people up.  Recommend a warning in the build output that manifestclasspath and index=\"true\" cancel each other out.", "is_private": false, "id": 116099, "creator": "david.green@morganstanley.com", "time": "2008-05-01T08:21:52Z", "bug_id": 44915, "creation_time": "2008-05-01T08:21:52Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 44915, "text": "Thanks,\nthe build file contains a <manifestclasspath> task\noutside a <target>, this means that it gets\nrun before any target.\n\nThe manifestclasspath task will fail if\nthere is no directory for the task.\n\nmove the manifestclasspath task to\nthe line before the <jar>, or any\ntime after the classpath dir is made\n(for example after the <mkdir> task\nin the \"copylib\".\n\nI notice that the \"compile\" target\ndoes not depend on the \"copylib\" target.\nIt is good practice to declare all the target\ndependencies.\nPeter\n\n", "id": 116100, "time": "2008-05-01T08:25:22Z", "creator": "peterreilly@apache.org", "creation_time": "2008-05-01T08:25:22Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 44915, "attachment_id": null, "id": 121007, "time": "2008-09-26T03:04:52Z", "creator": "bodewig@apache.org", "creation_time": "2008-09-26T03:04:52Z", "is_private": false, "text": "does it fail if manifestclasspath is inside a target?"}, {"count": 6, "tags": [], "text": "please reopen when more information is available", "attachment_id": null, "id": 122569, "creator": "bodewig@apache.org", "time": "2008-11-17T08:12:17Z", "bug_id": 44915, "creation_time": "2008-11-17T08:12:17Z", "is_private": false}]