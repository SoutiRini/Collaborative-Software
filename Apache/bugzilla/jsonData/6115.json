[{"count": 0, "tags": [], "bug_id": 6115, "attachment_id": null, "id": 10046, "time": "2002-01-29T23:38:25Z", "creator": "peter.nuetzel@inglobo.de", "creation_time": "2002-01-29T23:38:25Z", "is_private": false, "text": "If an URI starts with a fragment identifier (e.g. '#anchor')\nresponse.encodeURL() inserts the session id in front of it (result:\n';jsessionid=...#anchor').\nI think this is not the intended behaviour cause browsers don't interpret such\nan URI as internal link of the current document.\n\norg.apache.catalina.connector.HttpResponseBase.isEncodeable() checks if the\npassed URI starts with '#' but this fails because encodeURL() passes the\nresolved absolute URI to this method.\n\n(PS: with Tomcat 4.0.1 the session id is appended to the anchor which is really\nwrong.)"}, {"count": 1, "tags": [], "creator": "dlr@finemaltcoding.com", "attachment_id": null, "text": "This was fixed by Larry in rev 1.43 of HttpResponseBase:\n\nrevision 1.43 \ndate: 2002/01/05 22:39:12;  author: larryi;  state: Exp;  lines: +11 -4 \nPort Bill Barker's fix to place \";jsessionid\" in the correct location in \nthe presence of an anchor in the URL. \n\n@@ -724,14 +724,21 @@ \n  \n         String path = url; \n         String query = \"\"; \n+        String anchor = \"\"; \n         int question = url.indexOf('?'); \n         if (question >= 0) { \n             path = url.substring(0, question); \n             query = url.substring(question); \n         } \n+        int pound = path.indexOf('#'); \n+        if (pound >= 0) { \n+            anchor = path.substring(pound); \n+            path = path.substring(0, pound); \n+        } \n         StringBuffer sb = new StringBuffer(path); \n         sb.append(\";jsessionid=\"); \n         sb.append(sessionId); \n+        sb.append(anchor); \n         sb.append(query); \n         return (sb.toString()); ", "id": 10052, "time": "2002-01-30T01:01:53Z", "bug_id": 6115, "creation_time": "2002-01-30T01:01:53Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 6115, "attachment_id": null, "id": 10058, "time": "2002-01-30T03:50:18Z", "creator": "william.barker@wilshire.com", "creation_time": "2002-01-30T03:50:18Z", "is_private": false, "text": "Actually, it is fixed now in the CVS HEAD, and should show up in 1/30 nightly."}, {"count": 3, "tags": [], "bug_id": 6115, "text": "*** Bug 6267 has been marked as a duplicate of this bug. ***", "id": 10391, "attachment_id": null, "creator": "remm@apache.org", "creation_time": "2002-02-06T14:33:17Z", "time": "2002-02-06T14:33:17Z", "is_private": false}, {"count": 4, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "text": "*** Bug 6267 has been marked as a duplicate of this bug. ***", "id": 10395, "time": "2002-02-06T15:26:13Z", "bug_id": 6115, "creation_time": "2002-02-06T15:26:13Z", "is_private": false}]