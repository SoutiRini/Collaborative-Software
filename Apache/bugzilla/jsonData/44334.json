[{"count": 0, "tags": [], "creator": "hgoldwire@emusic.com", "is_private": false, "text": "We have an apache 2.2.8 + mod_proxy balancer using mod_proxy_ajp BalancerMembers\nto talk to several identical tomcat5 app servers.  The tomcat5 AJP/1.3 connector\nhas connectionTimeout=\"500\".  Occasionally a client doing a POST will take\nlonger than 500ms to send its POST, and tomcat will hang up on apache.  \n\nUnder apache 1.3+modjk, we see apache wait until the client finishes its POST\nthen retry the connection successfully.\n\nUnder apache 2.2.8 we see apache wait until the client finishes its POST, then\nmake maxattempts retries and each retry fails after 500ms.  sniffer capture\nshows that the retries' headers are identical to the first attempt [valid], but\napache never sends the request body, which should include the POST parameters.\n\nI've seen threads indicating that modjk has problems with retries if the body is\nlarger than the ajp buffer, but in our test the POST has content-length of 35 bytes.\n\nI can provide sniffer output if it helps.", "id": 113325, "time": "2008-01-31T14:04:51Z", "bug_id": 44334, "creation_time": "2008-01-31T14:04:51Z", "attachment_id": null}, {"count": 1, "attachment_id": null, "bug_id": 44334, "is_private": false, "id": 113326, "time": "2008-01-31T14:17:37Z", "creator": "rpluem@apache.org", "creation_time": "2008-01-31T14:17:37Z", "tags": [], "text": "Sniffer output would be helpful (please attach as tcpdump / snoop / wireshark\ndump file if possible). Furthermore it would be helpful to increase the loglevel\nto DEBUG and attach the error log."}, {"count": 2, "tags": [], "creator": "hgoldwire@emusic.com", "attachment_id": 21458, "is_private": false, "id": 113342, "time": "2008-02-01T11:42:39Z", "bug_id": 44334, "creation_time": "2008-02-01T11:42:39Z", "text": "Created attachment 21458\ntcpdump capture of bad ajp13 POST retries\n\nAttached is tcpdump capture with snaplen 1500 demonstrating bad mod_proxy_ajp\nPOST retries.  \n\nThis is a deliberately pathological example where the client didn't send POST\nmessage body until 3 seconds after it sent POST headers.  As you can see,\ntomcat ajp13 connector hangs up on the first request after 500ms (FIN, packet\n6).  At 3.5s the client completes the POST request, apache sends the message\nbody to tomcat (packet 8), and tomcat replies with RST (packet 10).\n\nAt that point apache has the complete POST and it retries the request.\tIt\nreconnects and sends the message header (packet 15) and nothing else.  500ms\nlater tomcat ajp13 connector hangs up on it.  \n\nRepeat until maxattempts exhausted.\n\nA useful way to see this in wireshark is \nView -> Time Display Format -> Seconds Since previous Capture Packet"}, {"count": 3, "attachment_id": 21459, "bug_id": 44334, "is_private": false, "id": 113343, "time": "2008-02-01T11:49:45Z", "creator": "hgoldwire@emusic.com", "creation_time": "2008-02-01T11:49:45Z", "tags": [], "text": "Created attachment 21459\ndebug log\n\n\ndebug log. not taken from the same request as the tcpdump capture, but taken\nfrom an identical subsequent request."}, {"count": 4, "tags": [], "creator": "rpluem@apache.org", "attachment_id": null, "text": "You are correct that there is bug here, but the bug is different from what you\nexpect. mod_proxy_balancer should not even try to sent the failed request to a\ndifferent member of the cluster. This is because:\n\n1. A POST request is non idempotent and thus it is not allowed to resend it \n   without user confirmation once its sending had started (RFC2616 8.1.4 / 9.1.2).\n\n2. Your request contains a request body. httpd handles request bodies as streams\n   and does not store them. This means once it has sent it to a Tomcat it is gone\n   and cannot be sent again to another Tomcat as httpd does not have its data\n   available any longer.\n\nThis is now fixed in trunk by r617822 (http://svn.apache.org/viewvc?rev=617822\n&view=rev). Nevertheless the problem you see will persist even with this patch.\nThe only possibility to avoid this would be waiting to connect / send headers\nuntil there is request body data available, but this does not make sense for\nmost other people. So I fear the only solution to your problem is to increase\nthe value for connectionTimeout on Tomcat to something like 4 seconds or to fix\nyour client to send the request body immediately.", "id": 113368, "time": "2008-02-02T08:50:05Z", "bug_id": 44334, "creation_time": "2008-02-02T08:50:05Z", "is_private": false}, {"count": 5, "tags": [], "creator": "rpluem@apache.org", "attachment_id": 21459, "is_private": false, "id": 113379, "time": "2008-02-02T12:21:36Z", "bug_id": 44334, "creation_time": "2008-02-02T12:21:36Z", "text": "Comment on attachment 21459\ndebug log\n\n>\n>[Fri Feb 01 11:25:56 2008] [debug] mod_proxy_balancer.c(41): proxy: \n>BALANCER: canonicalising URL //ajphttp/search.html\n>[Fri Feb 01 11:25:56 2008] [debug] mod_proxy_balancer.c(258): proxy: \n>BALANCER: Found value (null) for stickysession JSESSIONID|jsessionid\n>[Fri Feb 01 11:25:56 2008] [debug] mod_proxy_balancer.c(950): proxy: \n>Entering byrequests for BALANCER (balancer://ajphttp)\n>[Fri Feb 01 11:25:56 2008] [debug] proxy_util.c(1790): proxy: BALANCER: \n>retrying the worker for (localhost)\n>[Fri Feb 01 11:25:56 2008] [debug] proxy_util.c(1796): proxy: BALANCER: \n>worker for (localhost) has been marked for retry\n>[Fri Feb 01 11:25:56 2008] [debug] mod_proxy_balancer.c(517): proxy: \n>BALANCER (balancer://ajphttp) worker (ajp://localhost:8009) rewritten to \n>ajp://localhost:8009/search.html\n>[Fri Feb 01 11:25:56 2008] [debug] mod_proxy.c(819): Running scheme \n>balancer handler (attempt 0)\n>[Fri Feb 01 11:25:56 2008] [debug] mod_proxy_http.c(1683): proxy: HTTP: \n>declining URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:25:56 2008] [debug] mod_proxy_ajp.c(520): proxy: AJP: \n>serving URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:25:56 2008] [debug] proxy_util.c(1852): proxy: AJP: has \n>acquired connection for (localhost)\n>[Fri Feb 01 11:25:56 2008] [debug] proxy_util.c(1913): proxy: connecting \n>ajp://localhost:8009/search.html to localhost:8009\n>[Fri Feb 01 11:25:56 2008] [debug] proxy_util.c(2012): proxy: connected \n>/search.html to localhost:8009\n>[Fri Feb 01 11:25:56 2008] [debug] proxy_util.c(2169): proxy: AJP: fam 2 \n>socket created to connect to localhost\n>[Fri Feb 01 11:25:56 2008] [debug] ajp_header.c(218): Into \n>ajp_marshal_into_msgb\n>[Fri Feb 01 11:25:56 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[0] [Host] = [www.emusic.com]\n>[Fri Feb 01 11:25:56 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[1] [Content-Type] = \n>[application/x-www-form-urlencoded]\n>[Fri Feb 01 11:25:56 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[2] [Content-Length] = [35]\n>[Fri Feb 01 11:25:56 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[3] [Max-Forwards] = [10]\n>[Fri Feb 01 11:25:56 2008] [debug] ajp_header.c(424): \n>ajp_marshal_into_msgb: Done\n>[Fri Feb 01 11:26:00 2008] [debug] mod_proxy_ajp.c(201): proxy: \n>APR_BUCKET_IS_EOS\n>[Fri Feb 01 11:26:00 2008] [debug] mod_proxy_ajp.c(206): proxy: data to \n>read (max 8186 at 4)\n>[Fri Feb 01 11:26:00 2008] [debug] mod_proxy_ajp.c(221): proxy: got 35 \n>bytes of data\n>[Fri Feb 01 11:26:00 2008] [error] (70014)End of file found: \n>ajp_ilink_receive() can't receive header\n>[Fri Feb 01 11:26:00 2008] [error] ajp_read_header: ajp_ilink_receive failed\n>[Fri Feb 01 11:26:00 2008] [error] (120006)APR does not understand this \n>error code: proxy: read response failed from (null) (localhost)\n>[Fri Feb 01 11:26:00 2008] [debug] proxy_util.c(1870): proxy: AJP: has \n>released connection for (localhost)\n>[Fri Feb 01 11:26:00 2008] [debug] mod_proxy_balancer.c(258): proxy: \n>BALANCER: Found value (null) for stickysession JSESSIONID|jsessionid\n>[Fri Feb 01 11:26:00 2008] [debug] mod_proxy_balancer.c(950): proxy: \n>Entering byrequests for BALANCER (balancer://ajphttp)\n>[Fri Feb 01 11:26:00 2008] [debug] proxy_util.c(1790): proxy: BALANCER: \n>retrying the worker for (localhost)\n>[Fri Feb 01 11:26:00 2008] [debug] proxy_util.c(1796): proxy: BALANCER: \n>worker for (localhost) has been marked for retry\n>[Fri Feb 01 11:26:00 2008] [debug] mod_proxy_balancer.c(517): proxy: \n>BALANCER (balancer://ajphttp) worker (ajp://localhost:8009) rewritten to \n>ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:00 2008] [debug] mod_proxy.c(819): Running scheme \n>balancer handler (attempt 1)\n>[Fri Feb 01 11:26:00 2008] [debug] mod_proxy_http.c(1683): proxy: HTTP: \n>declining URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:00 2008] [debug] mod_proxy_ajp.c(520): proxy: AJP: \n>serving URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:00 2008] [debug] proxy_util.c(1852): proxy: AJP: has \n>acquired connection for (localhost)\n>[Fri Feb 01 11:26:00 2008] [debug] proxy_util.c(1913): proxy: connecting \n>ajp://localhost:8009/search.html to localhost:8009\n>[Fri Feb 01 11:26:00 2008] [debug] proxy_util.c(2012): proxy: connected \n>/search.html to localhost:8009\n>[Fri Feb 01 11:26:00 2008] [debug] proxy_util.c(2169): proxy: AJP: fam 2 \n>socket created to connect to localhost\n>[Fri Feb 01 11:26:00 2008] [debug] ajp_header.c(218): Into \n>ajp_marshal_into_msgb\n>[Fri Feb 01 11:26:00 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[0] [Host] = [www.emusic.com]\n>[Fri Feb 01 11:26:00 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[1] [Content-Type] = \n>[application/x-www-form-urlencoded]\n>[Fri Feb 01 11:26:00 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[2] [Content-Length] = [35]\n>[Fri Feb 01 11:26:00 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[3] [Max-Forwards] = [10]\n>[Fri Feb 01 11:26:00 2008] [debug] ajp_header.c(424): \n>ajp_marshal_into_msgb: Done\n>[Fri Feb 01 11:26:00 2008] [debug] mod_proxy_ajp.c(201): proxy: \n>APR_BUCKET_IS_EOS\n>[Fri Feb 01 11:26:00 2008] [debug] mod_proxy_ajp.c(206): proxy: data to \n>read (max 8186 at 4)\n>[Fri Feb 01 11:26:00 2008] [debug] mod_proxy_ajp.c(221): proxy: got 0 \n>bytes of data\n>[Fri Feb 01 11:26:01 2008] [error] (70014)End of file found: \n>ajp_ilink_receive() can't receive header\n>[Fri Feb 01 11:26:01 2008] [error] ajp_read_header: ajp_ilink_receive failed\n>[Fri Feb 01 11:26:01 2008] [error] (120006)APR does not understand this \n>error code: proxy: read response failed from (null) (localhost)\n>[Fri Feb 01 11:26:01 2008] [debug] proxy_util.c(1870): proxy: AJP: has \n>released connection for (localhost)\n>[Fri Feb 01 11:26:01 2008] [debug] mod_proxy_balancer.c(258): proxy: \n>BALANCER: Found value (null) for stickysession JSESSIONID|jsessionid\n>[Fri Feb 01 11:26:01 2008] [debug] mod_proxy_balancer.c(950): proxy: \n>Entering byrequests for BALANCER (balancer://ajphttp)\n>[Fri Feb 01 11:26:01 2008] [debug] proxy_util.c(1790): proxy: BALANCER: \n>retrying the worker for (localhost)\n>[Fri Feb 01 11:26:01 2008] [debug] proxy_util.c(1796): proxy: BALANCER: \n>worker for (localhost) has been marked for retry\n>[Fri Feb 01 11:26:01 2008] [debug] mod_proxy_balancer.c(517): proxy: \n>BALANCER (balancer://ajphttp) worker (ajp://localhost:8009) rewritten to \n>ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:01 2008] [debug] mod_proxy.c(819): Running scheme \n>balancer handler (attempt 2)\n>[Fri Feb 01 11:26:01 2008] [debug] mod_proxy_http.c(1683): proxy: HTTP: \n>declining URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:01 2008] [debug] mod_proxy_ajp.c(520): proxy: AJP: \n>serving URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:01 2008] [debug] proxy_util.c(1852): proxy: AJP: has \n>acquired connection for (localhost)\n>[Fri Feb 01 11:26:01 2008] [debug] proxy_util.c(1913): proxy: connecting \n>ajp://localhost:8009/search.html to localhost:8009\n>[Fri Feb 01 11:26:01 2008] [debug] proxy_util.c(2012): proxy: connected \n>/search.html to localhost:8009\n>[Fri Feb 01 11:26:01 2008] [debug] proxy_util.c(2169): proxy: AJP: fam 2 \n>socket created to connect to localhost\n>[Fri Feb 01 11:26:01 2008] [debug] ajp_header.c(218): Into \n>ajp_marshal_into_msgb\n>[Fri Feb 01 11:26:01 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[0] [Host] = [www.emusic.com]\n>[Fri Feb 01 11:26:01 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[1] [Content-Type] = \n>[application/x-www-form-urlencoded]\n>[Fri Feb 01 11:26:01 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[2] [Content-Length] = [35]\n>[Fri Feb 01 11:26:01 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[3] [Max-Forwards] = [10]\n>[Fri Feb 01 11:26:01 2008] [debug] ajp_header.c(424): \n>ajp_marshal_into_msgb: Done\n>[Fri Feb 01 11:26:01 2008] [debug] mod_proxy_ajp.c(201): proxy: \n>APR_BUCKET_IS_EOS\n>[Fri Feb 01 11:26:01 2008] [debug] mod_proxy_ajp.c(206): proxy: data to \n>read (max 8186 at 4)\n>[Fri Feb 01 11:26:01 2008] [debug] mod_proxy_ajp.c(221): proxy: got 0 \n>bytes of data\n>[Fri Feb 01 11:26:02 2008] [error] (70014)End of file found: \n>ajp_ilink_receive() can't receive header\n>[Fri Feb 01 11:26:02 2008] [error] ajp_read_header: ajp_ilink_receive failed\n>[Fri Feb 01 11:26:02 2008] [error] (120006)APR does not understand this \n>error code: proxy: read response failed from (null) (localhost)\n>[Fri Feb 01 11:26:02 2008] [debug] proxy_util.c(1870): proxy: AJP: has \n>released connection for (localhost)\n>[Fri Feb 01 11:26:02 2008] [debug] mod_proxy_balancer.c(258): proxy: \n>BALANCER: Found value (null) for stickysession JSESSIONID|jsessionid\n>[Fri Feb 01 11:26:02 2008] [debug] mod_proxy_balancer.c(950): proxy: \n>Entering byrequests for BALANCER (balancer://ajphttp)\n>[Fri Feb 01 11:26:02 2008] [debug] proxy_util.c(1790): proxy: BALANCER: \n>retrying the worker for (localhost)\n>[Fri Feb 01 11:26:02 2008] [debug] proxy_util.c(1796): proxy: BALANCER: \n>worker for (localhost) has been marked for retry\n>[Fri Feb 01 11:26:02 2008] [debug] mod_proxy_balancer.c(517): proxy: \n>BALANCER (balancer://ajphttp) worker (ajp://localhost:8009) rewritten to \n>ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:02 2008] [debug] mod_proxy.c(819): Running scheme \n>balancer handler (attempt 3)\n>[Fri Feb 01 11:26:02 2008] [debug] mod_proxy_http.c(1683): proxy: HTTP: \n>declining URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:02 2008] [debug] mod_proxy_ajp.c(520): proxy: AJP: \n>serving URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:02 2008] [debug] proxy_util.c(1852): proxy: AJP: has \n>acquired connection for (localhost)\n>[Fri Feb 01 11:26:02 2008] [debug] proxy_util.c(1913): proxy: connecting \n>ajp://localhost:8009/search.html to localhost:8009\n>[Fri Feb 01 11:26:02 2008] [debug] proxy_util.c(2012): proxy: connected \n>/search.html to localhost:8009\n>[Fri Feb 01 11:26:02 2008] [debug] proxy_util.c(2169): proxy: AJP: fam 2 \n>socket created to connect to localhost\n>[Fri Feb 01 11:26:02 2008] [debug] ajp_header.c(218): Into \n>ajp_marshal_into_msgb\n>[Fri Feb 01 11:26:02 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[0] [Host] = [www.emusic.com]\n>[Fri Feb 01 11:26:02 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[1] [Content-Type] = \n>[application/x-www-form-urlencoded]\n>[Fri Feb 01 11:26:02 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[2] [Content-Length] = [35]\n>[Fri Feb 01 11:26:02 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[3] [Max-Forwards] = [10]\n>[Fri Feb 01 11:26:02 2008] [debug] ajp_header.c(424): \n>ajp_marshal_into_msgb: Done\n>[Fri Feb 01 11:26:02 2008] [debug] mod_proxy_ajp.c(201): proxy: \n>APR_BUCKET_IS_EOS\n>[Fri Feb 01 11:26:02 2008] [debug] mod_proxy_ajp.c(206): proxy: data to \n>read (max 8186 at 4)\n>[Fri Feb 01 11:26:02 2008] [debug] mod_proxy_ajp.c(221): proxy: got 0 \n>bytes of data\n>[Fri Feb 01 11:26:03 2008] [error] (70014)End of file found: \n>ajp_ilink_receive() can't receive header\n>[Fri Feb 01 11:26:03 2008] [error] ajp_read_header: ajp_ilink_receive failed\n>[Fri Feb 01 11:26:03 2008] [error] (120006)APR does not understand this \n>error code: proxy: read response failed from (null) (localhost)\n>[Fri Feb 01 11:26:03 2008] [debug] proxy_util.c(1870): proxy: AJP: has \n>released connection for (localhost)\n>[Fri Feb 01 11:26:03 2008] [debug] mod_proxy_balancer.c(258): proxy: \n>BALANCER: Found value (null) for stickysession JSESSIONID|jsessionid\n>[Fri Feb 01 11:26:03 2008] [debug] mod_proxy_balancer.c(950): proxy: \n>Entering byrequests for BALANCER (balancer://ajphttp)\n>[Fri Feb 01 11:26:03 2008] [debug] proxy_util.c(1790): proxy: BALANCER: \n>retrying the worker for (localhost)\n>[Fri Feb 01 11:26:03 2008] [debug] proxy_util.c(1796): proxy: BALANCER: \n>worker for (localhost) has been marked for retry\n>[Fri Feb 01 11:26:03 2008] [debug] mod_proxy_balancer.c(517): proxy: \n>BALANCER (balancer://ajphttp) worker (ajp://localhost:8009) rewritten to \n>ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:03 2008] [debug] mod_proxy.c(819): Running scheme \n>balancer handler (attempt 4)\n>[Fri Feb 01 11:26:03 2008] [debug] mod_proxy_http.c(1683): proxy: HTTP: \n>declining URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:03 2008] [debug] mod_proxy_ajp.c(520): proxy: AJP: \n>serving URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:03 2008] [debug] proxy_util.c(1852): proxy: AJP: has \n>acquired connection for (localhost)\n>[Fri Feb 01 11:26:03 2008] [debug] proxy_util.c(1913): proxy: connecting \n>ajp://localhost:8009/search.html to localhost:8009\n>[Fri Feb 01 11:26:03 2008] [debug] proxy_util.c(2012): proxy: connected \n>/search.html to localhost:8009\n>[Fri Feb 01 11:26:03 2008] [debug] proxy_util.c(2169): proxy: AJP: fam 2 \n>socket created to connect to localhost\n>[Fri Feb 01 11:26:03 2008] [debug] ajp_header.c(218): Into \n>ajp_marshal_into_msgb\n>[Fri Feb 01 11:26:03 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[0] [Host] = [www.emusic.com]\n>[Fri Feb 01 11:26:03 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[1] [Content-Type] = \n>[application/x-www-form-urlencoded]\n>[Fri Feb 01 11:26:03 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[2] [Content-Length] = [35]\n>[Fri Feb 01 11:26:03 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[3] [Max-Forwards] = [10]\n>[Fri Feb 01 11:26:03 2008] [debug] ajp_header.c(424): \n>ajp_marshal_into_msgb: Done\n>[Fri Feb 01 11:26:03 2008] [debug] mod_proxy_ajp.c(201): proxy: \n>APR_BUCKET_IS_EOS\n>[Fri Feb 01 11:26:03 2008] [debug] mod_proxy_ajp.c(206): proxy: data to \n>read (max 8186 at 4)\n>[Fri Feb 01 11:26:03 2008] [debug] mod_proxy_ajp.c(221): proxy: got 0 \n>bytes of data\n>[Fri Feb 01 11:26:04 2008] [error] (70014)End of file found: \n>ajp_ilink_receive() can't receive header\n>[Fri Feb 01 11:26:04 2008] [error] ajp_read_header: ajp_ilink_receive failed\n>[Fri Feb 01 11:26:04 2008] [error] (120006)APR does not understand this \n>error code: proxy: read response failed from (null) (localhost)\n>[Fri Feb 01 11:26:04 2008] [debug] proxy_util.c(1870): proxy: AJP: has \n>released connection for (localhost)\n>[Fri Feb 01 11:26:04 2008] [debug] mod_proxy_balancer.c(258): proxy: \n>BALANCER: Found value (null) for stickysession JSESSIONID|jsessionid\n>[Fri Feb 01 11:26:04 2008] [debug] mod_proxy_balancer.c(950): proxy: \n>Entering byrequests for BALANCER (balancer://ajphttp)\n>[Fri Feb 01 11:26:04 2008] [debug] proxy_util.c(1790): proxy: BALANCER: \n>retrying the worker for (localhost)\n>[Fri Feb 01 11:26:04 2008] [debug] proxy_util.c(1796): proxy: BALANCER: \n>worker for (localhost) has been marked for retry\n>[Fri Feb 01 11:26:04 2008] [debug] mod_proxy_balancer.c(517): proxy: \n>BALANCER (balancer://ajphttp) worker (ajp://localhost:8009) rewritten to \n>ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:04 2008] [debug] mod_proxy.c(819): Running scheme \n>balancer handler (attempt 5)\n>[Fri Feb 01 11:26:04 2008] [debug] mod_proxy_http.c(1683): proxy: HTTP: \n>declining URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:04 2008] [debug] mod_proxy_ajp.c(520): proxy: AJP: \n>serving URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:04 2008] [debug] proxy_util.c(1852): proxy: AJP: has \n>acquired connection for (localhost)\n>[Fri Feb 01 11:26:04 2008] [debug] proxy_util.c(1913): proxy: connecting \n>ajp://localhost:8009/search.html to localhost:8009\n>[Fri Feb 01 11:26:04 2008] [debug] proxy_util.c(2012): proxy: connected \n>/search.html to localhost:8009\n>[Fri Feb 01 11:26:04 2008] [debug] proxy_util.c(2169): proxy: AJP: fam 2 \n>socket created to connect to localhost\n>[Fri Feb 01 11:26:04 2008] [debug] ajp_header.c(218): Into \n>ajp_marshal_into_msgb\n>[Fri Feb 01 11:26:04 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[0] [Host] = [www.emusic.com]\n>[Fri Feb 01 11:26:04 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[1] [Content-Type] = \n>[application/x-www-form-urlencoded]\n>[Fri Feb 01 11:26:04 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[2] [Content-Length] = [35]\n>[Fri Feb 01 11:26:04 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[3] [Max-Forwards] = [10]\n>[Fri Feb 01 11:26:04 2008] [debug] ajp_header.c(424): \n>ajp_marshal_into_msgb: Done\n>[Fri Feb 01 11:26:04 2008] [debug] mod_proxy_ajp.c(201): proxy: \n>APR_BUCKET_IS_EOS\n>[Fri Feb 01 11:26:04 2008] [debug] mod_proxy_ajp.c(206): proxy: data to \n>read (max 8186 at 4)\n>[Fri Feb 01 11:26:04 2008] [debug] mod_proxy_ajp.c(221): proxy: got 0 \n>bytes of data\n>[Fri Feb 01 11:26:05 2008] [error] (70014)End of file found: \n>ajp_ilink_receive() can't receive header\n>[Fri Feb 01 11:26:05 2008] [error] ajp_read_header: ajp_ilink_receive failed\n>[Fri Feb 01 11:26:05 2008] [error] (120006)APR does not understand this \n>error code: proxy: read response failed from (null) (localhost)\n>[Fri Feb 01 11:26:05 2008] [debug] proxy_util.c(1870): proxy: AJP: has \n>released connection for (localhost)\n>[Fri Feb 01 11:26:05 2008] [debug] mod_proxy_balancer.c(258): proxy: \n>BALANCER: Found value (null) for stickysession JSESSIONID|jsessionid\n>[Fri Feb 01 11:26:05 2008] [debug] mod_proxy_balancer.c(950): proxy: \n>Entering byrequests for BALANCER (balancer://ajphttp)\n>[Fri Feb 01 11:26:05 2008] [debug] proxy_util.c(1790): proxy: BALANCER: \n>retrying the worker for (localhost)\n>[Fri Feb 01 11:26:05 2008] [debug] proxy_util.c(1796): proxy: BALANCER: \n>worker for (localhost) has been marked for retry\n>[Fri Feb 01 11:26:05 2008] [debug] mod_proxy_balancer.c(517): proxy: \n>BALANCER (balancer://ajphttp) worker (ajp://localhost:8009) rewritten to \n>ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:05 2008] [debug] mod_proxy.c(819): Running scheme \n>balancer handler (attempt 6)\n>[Fri Feb 01 11:26:05 2008] [debug] mod_proxy_http.c(1683): proxy: HTTP: \n>declining URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:05 2008] [debug] mod_proxy_ajp.c(520): proxy: AJP: \n>serving URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:05 2008] [debug] proxy_util.c(1852): proxy: AJP: has \n>acquired connection for (localhost)\n>[Fri Feb 01 11:26:05 2008] [debug] proxy_util.c(1913): proxy: connecting \n>ajp://localhost:8009/search.html to localhost:8009\n>[Fri Feb 01 11:26:05 2008] [debug] proxy_util.c(2012): proxy: connected \n>/search.html to localhost:8009\n>[Fri Feb 01 11:26:05 2008] [debug] proxy_util.c(2169): proxy: AJP: fam 2 \n>socket created to connect to localhost\n>[Fri Feb 01 11:26:05 2008] [debug] ajp_header.c(218): Into \n>ajp_marshal_into_msgb\n>[Fri Feb 01 11:26:05 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[0] [Host] = [www.emusic.com]\n>[Fri Feb 01 11:26:05 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[1] [Content-Type] = \n>[application/x-www-form-urlencoded]\n>[Fri Feb 01 11:26:05 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[2] [Content-Length] = [35]\n>[Fri Feb 01 11:26:05 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[3] [Max-Forwards] = [10]\n>[Fri Feb 01 11:26:05 2008] [debug] ajp_header.c(424): \n>ajp_marshal_into_msgb: Done\n>[Fri Feb 01 11:26:05 2008] [debug] mod_proxy_ajp.c(201): proxy: \n>APR_BUCKET_IS_EOS\n>[Fri Feb 01 11:26:05 2008] [debug] mod_proxy_ajp.c(206): proxy: data to \n>read (max 8186 at 4)\n>[Fri Feb 01 11:26:05 2008] [debug] mod_proxy_ajp.c(221): proxy: got 0 \n>bytes of data\n>[Fri Feb 01 11:26:06 2008] [error] (70014)End of file found: \n>ajp_ilink_receive() can't receive header\n>[Fri Feb 01 11:26:06 2008] [error] ajp_read_header: ajp_ilink_receive failed\n>[Fri Feb 01 11:26:06 2008] [error] (120006)APR does not understand this \n>error code: proxy: read response failed from (null) (localhost)\n>[Fri Feb 01 11:26:06 2008] [debug] proxy_util.c(1870): proxy: AJP: has \n>released connection for (localhost)\n>[Fri Feb 01 11:26:06 2008] [debug] mod_proxy_balancer.c(258): proxy: \n>BALANCER: Found value (null) for stickysession JSESSIONID|jsessionid\n>[Fri Feb 01 11:26:06 2008] [debug] mod_proxy_balancer.c(950): proxy: \n>Entering byrequests for BALANCER (balancer://ajphttp)\n>[Fri Feb 01 11:26:06 2008] [debug] proxy_util.c(1790): proxy: BALANCER: \n>retrying the worker for (localhost)\n>[Fri Feb 01 11:26:06 2008] [debug] proxy_util.c(1796): proxy: BALANCER: \n>worker for (localhost) has been marked for retry\n>[Fri Feb 01 11:26:06 2008] [debug] mod_proxy_balancer.c(517): proxy: \n>BALANCER (balancer://ajphttp) worker (ajp://localhost:8009) rewritten to \n>ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:06 2008] [debug] mod_proxy.c(819): Running scheme \n>balancer handler (attempt 7)\n>[Fri Feb 01 11:26:06 2008] [debug] mod_proxy_http.c(1683): proxy: HTTP: \n>declining URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:06 2008] [debug] mod_proxy_ajp.c(520): proxy: AJP: \n>serving URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:06 2008] [debug] proxy_util.c(1852): proxy: AJP: has \n>acquired connection for (localhost)\n>[Fri Feb 01 11:26:06 2008] [debug] proxy_util.c(1913): proxy: connecting \n>ajp://localhost:8009/search.html to localhost:8009\n>[Fri Feb 01 11:26:06 2008] [debug] proxy_util.c(2012): proxy: connected \n>/search.html to localhost:8009\n>[Fri Feb 01 11:26:06 2008] [debug] proxy_util.c(2169): proxy: AJP: fam 2 \n>socket created to connect to localhost\n>[Fri Feb 01 11:26:06 2008] [debug] ajp_header.c(218): Into \n>ajp_marshal_into_msgb\n>[Fri Feb 01 11:26:06 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[0] [Host] = [www.emusic.com]\n>[Fri Feb 01 11:26:06 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[1] [Content-Type] = \n>[application/x-www-form-urlencoded]\n>[Fri Feb 01 11:26:06 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[2] [Content-Length] = [35]\n>[Fri Feb 01 11:26:06 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[3] [Max-Forwards] = [10]\n>[Fri Feb 01 11:26:06 2008] [debug] ajp_header.c(424): \n>ajp_marshal_into_msgb: Done\n>[Fri Feb 01 11:26:06 2008] [debug] mod_proxy_ajp.c(201): proxy: \n>APR_BUCKET_IS_EOS\n>[Fri Feb 01 11:26:06 2008] [debug] mod_proxy_ajp.c(206): proxy: data to \n>read (max 8186 at 4)\n>[Fri Feb 01 11:26:06 2008] [debug] mod_proxy_ajp.c(221): proxy: got 0 \n>bytes of data\n>[Fri Feb 01 11:26:07 2008] [error] (70014)End of file found: \n>ajp_ilink_receive() can't receive header\n>[Fri Feb 01 11:26:07 2008] [error] ajp_read_header: ajp_ilink_receive failed\n>[Fri Feb 01 11:26:07 2008] [error] (120006)APR does not understand this \n>error code: proxy: read response failed from (null) (localhost)\n>[Fri Feb 01 11:26:07 2008] [debug] proxy_util.c(1870): proxy: AJP: has \n>released connection for (localhost)\n>[Fri Feb 01 11:26:07 2008] [debug] mod_proxy_balancer.c(258): proxy: \n>BALANCER: Found value (null) for stickysession JSESSIONID|jsessionid\n>[Fri Feb 01 11:26:07 2008] [debug] mod_proxy_balancer.c(950): proxy: \n>Entering byrequests for BALANCER (balancer://ajphttp)\n>[Fri Feb 01 11:26:07 2008] [debug] proxy_util.c(1790): proxy: BALANCER: \n>retrying the worker for (localhost)\n>[Fri Feb 01 11:26:07 2008] [debug] proxy_util.c(1796): proxy: BALANCER: \n>worker for (localhost) has been marked for retry\n>[Fri Feb 01 11:26:07 2008] [debug] mod_proxy_balancer.c(517): proxy: \n>BALANCER (balancer://ajphttp) worker (ajp://localhost:8009) rewritten to \n>ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:07 2008] [debug] mod_proxy.c(819): Running scheme \n>balancer handler (attempt 8)\n>[Fri Feb 01 11:26:07 2008] [debug] mod_proxy_http.c(1683): proxy: HTTP: \n>declining URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:07 2008] [debug] mod_proxy_ajp.c(520): proxy: AJP: \n>serving URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:07 2008] [debug] proxy_util.c(1852): proxy: AJP: has \n>acquired connection for (localhost)\n>[Fri Feb 01 11:26:07 2008] [debug] proxy_util.c(1913): proxy: connecting \n>ajp://localhost:8009/search.html to localhost:8009\n>[Fri Feb 01 11:26:07 2008] [debug] proxy_util.c(2012): proxy: connected \n>/search.html to localhost:8009\n>[Fri Feb 01 11:26:07 2008] [debug] proxy_util.c(2169): proxy: AJP: fam 2 \n>socket created to connect to localhost\n>[Fri Feb 01 11:26:07 2008] [debug] ajp_header.c(218): Into \n>ajp_marshal_into_msgb\n>[Fri Feb 01 11:26:07 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[0] [Host] = [www.emusic.com]\n>[Fri Feb 01 11:26:07 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[1] [Content-Type] = \n>[application/x-www-form-urlencoded]\n>[Fri Feb 01 11:26:07 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[2] [Content-Length] = [35]\n>[Fri Feb 01 11:26:07 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[3] [Max-Forwards] = [10]\n>[Fri Feb 01 11:26:07 2008] [debug] ajp_header.c(424): \n>ajp_marshal_into_msgb: Done\n>[Fri Feb 01 11:26:07 2008] [debug] mod_proxy_ajp.c(201): proxy: \n>APR_BUCKET_IS_EOS\n>[Fri Feb 01 11:26:07 2008] [debug] mod_proxy_ajp.c(206): proxy: data to \n>read (max 8186 at 4)\n>[Fri Feb 01 11:26:07 2008] [debug] mod_proxy_ajp.c(221): proxy: got 0 \n>bytes of data\n>[Fri Feb 01 11:26:08 2008] [error] (70014)End of file found: \n>ajp_ilink_receive() can't receive header\n>[Fri Feb 01 11:26:08 2008] [error] ajp_read_header: ajp_ilink_receive failed\n>[Fri Feb 01 11:26:08 2008] [error] (120006)APR does not understand this \n>error code: proxy: read response failed from (null) (localhost)\n>[Fri Feb 01 11:26:08 2008] [debug] proxy_util.c(1870): proxy: AJP: has \n>released connection for (localhost)\n>[Fri Feb 01 11:26:08 2008] [debug] mod_proxy_balancer.c(258): proxy: \n>BALANCER: Found value (null) for stickysession JSESSIONID|jsessionid\n>[Fri Feb 01 11:26:08 2008] [debug] mod_proxy_balancer.c(950): proxy: \n>Entering byrequests for BALANCER (balancer://ajphttp)\n>[Fri Feb 01 11:26:08 2008] [debug] proxy_util.c(1790): proxy: BALANCER: \n>retrying the worker for (localhost)\n>[Fri Feb 01 11:26:08 2008] [debug] proxy_util.c(1796): proxy: BALANCER: \n>worker for (localhost) has been marked for retry\n>[Fri Feb 01 11:26:08 2008] [debug] mod_proxy_balancer.c(517): proxy: \n>BALANCER (balancer://ajphttp) worker (ajp://localhost:8009) rewritten to \n>ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:08 2008] [debug] mod_proxy.c(819): Running scheme \n>balancer handler (attempt 9)\n>[Fri Feb 01 11:26:08 2008] [debug] mod_proxy_http.c(1683): proxy: HTTP: \n>declining URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:08 2008] [debug] mod_proxy_ajp.c(520): proxy: AJP: \n>serving URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:08 2008] [debug] proxy_util.c(1852): proxy: AJP: has \n>acquired connection for (localhost)\n>[Fri Feb 01 11:26:08 2008] [debug] proxy_util.c(1913): proxy: connecting \n>ajp://localhost:8009/search.html to localhost:8009\n>[Fri Feb 01 11:26:08 2008] [debug] proxy_util.c(2012): proxy: connected \n>/search.html to localhost:8009\n>[Fri Feb 01 11:26:08 2008] [debug] proxy_util.c(2169): proxy: AJP: fam 2 \n>socket created to connect to localhost\n>[Fri Feb 01 11:26:08 2008] [debug] ajp_header.c(218): Into \n>ajp_marshal_into_msgb\n>[Fri Feb 01 11:26:08 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[0] [Host] = [www.emusic.com]\n>[Fri Feb 01 11:26:08 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[1] [Content-Type] = \n>[application/x-www-form-urlencoded]\n>[Fri Feb 01 11:26:08 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[2] [Content-Length] = [35]\n>[Fri Feb 01 11:26:08 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[3] [Max-Forwards] = [10]\n>[Fri Feb 01 11:26:08 2008] [debug] ajp_header.c(424): \n>ajp_marshal_into_msgb: Done\n>[Fri Feb 01 11:26:08 2008] [debug] mod_proxy_ajp.c(201): proxy: \n>APR_BUCKET_IS_EOS\n>[Fri Feb 01 11:26:08 2008] [debug] mod_proxy_ajp.c(206): proxy: data to \n>read (max 8186 at 4)\n>[Fri Feb 01 11:26:08 2008] [debug] mod_proxy_ajp.c(221): proxy: got 0 \n>bytes of data\n>[Fri Feb 01 11:26:09 2008] [error] (70014)End of file found: \n>ajp_ilink_receive() can't receive header\n>[Fri Feb 01 11:26:09 2008] [error] ajp_read_header: ajp_ilink_receive failed\n>[Fri Feb 01 11:26:09 2008] [error] (120006)APR does not understand this \n>error code: proxy: read response failed from (null) (localhost)\n>[Fri Feb 01 11:26:09 2008] [debug] proxy_util.c(1870): proxy: AJP: has \n>released connection for (localhost)\n>[Fri Feb 01 11:26:09 2008] [debug] mod_proxy_balancer.c(258): proxy: \n>BALANCER: Found value (null) for stickysession JSESSIONID|jsessionid\n>[Fri Feb 01 11:26:09 2008] [debug] mod_proxy_balancer.c(950): proxy: \n>Entering byrequests for BALANCER (balancer://ajphttp)\n>[Fri Feb 01 11:26:09 2008] [debug] proxy_util.c(1790): proxy: BALANCER: \n>retrying the worker for (localhost)\n>[Fri Feb 01 11:26:09 2008] [debug] proxy_util.c(1796): proxy: BALANCER: \n>worker for (localhost) has been marked for retry\n>[Fri Feb 01 11:26:09 2008] [debug] mod_proxy_balancer.c(517): proxy: \n>BALANCER (balancer://ajphttp) worker (ajp://localhost:8009) rewritten to \n>ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:09 2008] [debug] mod_proxy.c(819): Running scheme \n>balancer handler (attempt 10)\n>[Fri Feb 01 11:26:09 2008] [debug] mod_proxy_http.c(1683): proxy: HTTP: \n>declining URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:09 2008] [debug] mod_proxy_ajp.c(520): proxy: AJP: \n>serving URL ajp://localhost:8009/search.html\n>[Fri Feb 01 11:26:09 2008] [debug] proxy_util.c(1852): proxy: AJP: has \n>acquired connection for (localhost)\n>[Fri Feb 01 11:26:09 2008] [debug] proxy_util.c(1913): proxy: connecting \n>ajp://localhost:8009/search.html to localhost:8009\n>[Fri Feb 01 11:26:09 2008] [debug] proxy_util.c(2012): proxy: connected \n>/search.html to localhost:8009\n>[Fri Feb 01 11:26:09 2008] [debug] proxy_util.c(2169): proxy: AJP: fam 2 \n>socket created to connect to localhost\n>[Fri Feb 01 11:26:09 2008] [debug] ajp_header.c(218): Into \n>ajp_marshal_into_msgb\n>[Fri Feb 01 11:26:09 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[0] [Host] = [www.emusic.com]\n>[Fri Feb 01 11:26:09 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[1] [Content-Type] = \n>[application/x-www-form-urlencoded]\n>[Fri Feb 01 11:26:09 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[2] [Content-Length] = [35]\n>[Fri Feb 01 11:26:09 2008] [debug] ajp_header.c(284): \n>ajp_marshal_into_msgb: Header[3] [Max-Forwards] = [10]\n>[Fri Feb 01 11:26:09 2008] [debug] ajp_header.c(424): \n>ajp_marshal_into_msgb: Done\n>[Fri Feb 01 11:26:09 2008] [debug] mod_proxy_ajp.c(201): proxy: \n>APR_BUCKET_IS_EOS\n>[Fri Feb 01 11:26:09 2008] [debug] mod_proxy_ajp.c(206): proxy: data to \n>read (max 8186 at 4)\n>[Fri Feb 01 11:26:09 2008] [debug] mod_proxy_ajp.c(221): proxy: got 0 \n>bytes of data\n>[Fri Feb 01 11:26:10 2008] [error] (70014)End of file found: \n>ajp_ilink_receive() can't receive header\n>[Fri Feb 01 11:26:10 2008] [error] ajp_read_header: ajp_ilink_receive failed\n>[Fri Feb 01 11:26:10 2008] [error] (120006)APR does not understand this \n>error code: proxy: read response failed from (null) (localhost)\n>[Fri Feb 01 11:26:10 2008] [debug] proxy_util.c(1870): proxy: AJP: has \n>released connection for (localhost)"}, {"count": 6, "tags": [], "creator": "rpluem@apache.org", "is_private": false, "text": "Proposed for backport as r660209.", "id": 116975, "time": "2008-05-26T08:11:25Z", "bug_id": 44334, "creation_time": "2008-05-26T08:11:25Z", "attachment_id": null}]