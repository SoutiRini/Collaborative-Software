[{"count": 0, "tags": [], "text": "For a test plan with 2 samplers\n\tSampler A\n\tSampler B\n\nSwitching from A to B will trigger too many gui (JMeterGUIComponent) updates / configuration\nPrecisely :\n\t1 JMeterGUIComponent#modifyTestElement for A\n\t3 JMeterGUIComponent#modifyTestElement for B\n\t4 JMeterGUIComponent#configure for B\n\t3 JMeterGUIComponent#clearGui for B\n\nThe root cause is GuiPackage #getCurrentGui being call 3 times\n\tEditCommand : 2 times\n\tMenuFactory#addFileMenu : 1\n\nFor components which do costly computation in JMeterGUIComponent#configure (eg : WebServiceSamplerGui) this bug introduce a lag the jmeter gui usage.\nIf the component displays a popup in JMeterGUIComponent#configure, it will be displayed 3 times\u2026\n\nI think we should review the way GuiPackage #getCurrentGui is used and at least rename it because this method is doing much more than getting the current gui.\n\nThe first patch does not correct the root cause but save 1 invocation.", "is_private": false, "id": 149268, "creator": "benoit.wiart@gmail.com", "time": "2011-09-15T13:13:07Z", "bug_id": 51822, "creation_time": "2011-09-15T13:13:07Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "Created attachment 27501\nSave 1 invocation of GuiPackage #getCurrentGui\n\nSave 1 invocation of GuiPackage#getCurrentGui\n\nBenoit Wiart\nUbik Ing\u00e9nierie\nwww.ubik-ingenierie.com", "is_private": false, "bug_id": 51822, "id": 149270, "time": "2011-09-15T13:16:00Z", "creator": "benoit.wiart@gmail.com", "creation_time": "2011-09-15T13:16:00Z", "attachment_id": 27501}, {"count": 2, "tags": [], "bug_id": 51822, "attachment_id": null, "text": "GuiPackage#updateCurrentGui is almost identical to GuiPackage#getCurrentGui except it does not call clearGui\n\nWhat could be done :\n  change updateCurrentGui to match getCurrentGui (add clearGui and try-catch)\n  change getCurrentGui to simply return the current gui (nothing more)\n\nSome call sites of getCurrentGui rely on the fact it will \"save\" the current gui\neg GuiPackage#localeChanged or JMeterTreeModel#addComponent\nthey must be updated to call updateCurrentGui\n\nI have a working prototype which do not regress on bugs (43122\n30120, 41078, 39427, 50221, 42346) or revisions (325250, 324131) \n\nDear Jmeter maintainers let me know what you think about that...\n\nBenoit Wiart", "id": 149338, "time": "2011-09-16T19:45:49Z", "creator": "benoit.wiart@gmail.com", "creation_time": "2011-09-16T19:45:49Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 51822, "attachment_id": null, "text": "(In reply to comment #2)\n> GuiPackage#updateCurrentGui is almost identical to GuiPackage#getCurrentGui\n> except it does not call clearGui\n> \n> What could be done :\n>   change updateCurrentGui to match getCurrentGui (add clearGui and try-catch)\n>   change getCurrentGui to simply return the current gui (nothing more)\n> \n> Some call sites of getCurrentGui rely on the fact it will \"save\" the current\n> gui\n> eg GuiPackage#localeChanged or JMeterTreeModel#addComponent\n> they must be updated to call updateCurrentGui\n\nPlease raise a separate issue for this.", "id": 149340, "time": "2011-09-16T21:03:35Z", "creator": "sebb@apache.org", "creation_time": "2011-09-16T21:03:35Z", "is_private": false}, {"count": 4, "tags": [], "text": "(In reply to comment #3)\n> (In reply to comment #2)\n> > GuiPackage#updateCurrentGui is almost identical to GuiPackage#getCurrentGui\n> > except it does not call clearGui\n> > \n> > What could be done :\n> >   change updateCurrentGui to match getCurrentGui (add clearGui and try-catch)\n> >   change getCurrentGui to simply return the current gui (nothing more)\n> > \n> > Some call sites of getCurrentGui rely on the fact it will \"save\" the current\n> > gui\n> > eg GuiPackage#localeChanged or JMeterTreeModel#addComponent\n> > they must be updated to call updateCurrentGui\n> \n> Please raise a separate issue for this.\n\nHi Sebb\n\nMy comment 2 seems out of context...\nBUT the change on updateCurrentGui and getCurrentGui is a way to correct this issue by removing the 'extra work' done in getCurrentGui.\n\nUnless you really want to, I don't think it should be part of another bug", "is_private": false, "bug_id": 51822, "id": 149341, "time": "2011-09-16T21:52:52Z", "creator": "benoit.wiart@gmail.com", "creation_time": "2011-09-16T21:52:52Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 51822, "is_private": false, "count": 5, "id": 149347, "time": "2011-09-17T00:05:23Z", "creator": "sebb@apache.org", "creation_time": "2011-09-17T00:05:23Z", "text": "Seems to me that a better solution to the WebServiceSamplerGui.configure issue would be to move the expensive computation elsewhere.\n\nThe configure() method was intended for copying the TestElement fields to the GUI, not for doing GUI display manipulation."}, {"attachment_id": null, "tags": [], "bug_id": 51822, "is_private": false, "count": 6, "id": 149359, "time": "2011-09-17T06:42:17Z", "creator": "benoit.wiart@gmail.com", "creation_time": "2011-09-17T06:42:17Z", "text": "(In reply to comment #5)\n> Seems to me that a better solution to the WebServiceSamplerGui.configure issue\n> would be to move the expensive computation elsewhere.\n> \n> The configure() method was intended for copying the TestElement fields to the\n> GUI, not for doing GUI display manipulation.\n\nI agree, we could also add some caching in wdslhelper\n\nBut we should also correct the multiples calls to JMeterGUIComponent#modifyTestElement, JMeterGUIComponent#configure, JMeterGUIComponent#clearGui done through getCurrentGui\n\nTell me if you don't want to impact getCurrentGui / updateCurrentGui : then you can only apply the first patch.\nOtherwise I will create a patch from my prototype.\n\nI'm waiting for your 'GO / NOGO'"}, {"count": 7, "tags": [], "text": "(In reply to comment #1)\n> Created attachment 27501 [details]\n> Save 1 invocation of GuiPackage #getCurrentGui\n> \n> Save 1 invocation of GuiPackage#getCurrentGui\n> \n\nThanks, that should help.\n\nURL: http://svn.apache.org/viewvc?rev=1171938&view=rev\nLog:\nBug 51822 - (part 1) save 1 invocation of GuiPackage#getCurrentGui\n\nModified:\n   jakarta/jmeter/trunk/src/core/org/apache/jmeter/gui/action/EditCommand.java\n   jakarta/jmeter/trunk/xdocs/changes.xml", "is_private": false, "id": 149363, "creator": "sebb@apache.org", "time": "2011-09-17T10:20:57Z", "bug_id": 51822, "creation_time": "2011-09-17T10:20:57Z", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 51822, "attachment_id": null, "id": 151931, "time": "2011-12-02T21:43:08Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2011-12-02T21:43:08Z", "is_private": false, "text": "Hello Benoit,\nCan you provide the patch you describe in comment 1 and 6  ?\n\nI change this to an enhancement.\n\nRegards\nPhilippe"}]