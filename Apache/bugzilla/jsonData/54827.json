[{"count": 0, "tags": [], "text": "Recently I've upgraded from 2.2.23 to 2.2.24. Graceful and normal restarts started taking ages (like 5 minutes instead of 5 seconds).\n\nStracing shows that it does it's tls 1.0 dummy close for few minutes and after that finally server finishes restarting.\n\nChanging order so Listen 80 is after Listen 443 also fixes that problem - graceful restart takes seconds and not minutes (since internal dummy connection is non-ssl then).\n\nSo likely 2.2.24 regression is caused by:\n  *) core: Use a TLS 1.0 close_notify alert for internal dummy connection if\n     the chosen listener is configured for https. [Joe Orton]\n\n\nand I suggest backporting PR 39653 fix to 2.2.x:\n    * server/mpm_common.c (dummy_connection): If possible, use a non-SSL\n      listening port to use for the dummy connection, to avoid causing\n      (confusing) error log spam by sending EOF down an SSL port\n\notherwise tls 1.0 close notify hack can become pain for more people.\n\n\nUsing openssl 1.0.1e here. (There is also possibility that the bug is in openssl and not in apache but still PR 39653 fix is worth backporting IMO)", "is_private": false, "id": 166521, "creator": "arekm@maven.pl", "time": "2013-04-10T18:44:07Z", "bug_id": 54827, "creation_time": "2013-04-10T18:44:07Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "arekm@maven.pl", "attachment_id": null, "is_private": false, "id": 166625, "time": "2013-04-15T11:46:51Z", "bug_id": 54827, "creation_time": "2013-04-15T11:46:51Z", "text": "Something else was hiding behind slowdown:\nhttp://mail-archives.apache.org/mod_mbox/httpd-dev/201304.mbox/browser"}]