[{"count": 0, "tags": [], "bug_id": 44391, "is_private": false, "text": "In org.apache.catalina.ssi.SSIProcessor the method parseParamNames is broken. If\nI have a SSI directive like <!--#set var=\"test\" value=\"blubb\\\"\\\"\" --> the method\ndetects three parameters instead of two. This is because there are two\nconsecutive escaped characters. Although the first one \\\" is detected correctly\nthe next one isn't because the flag escaped is still set to true, although this\ncharacter isn't escaped anymore.\n\nYou have to replace\n\nboolean escaped = false;\nfor (; bIdx < cmd.length() && quotes != 2; bIdx++) {\n  char c = cmd.charAt(bIdx);\n  // Need to skip escaped characters\n  if (c == '\\\\' && !escaped) {\n    escaped = true;\n    bIdx++;\n    continue;\n  }\n  escaped = false;\n  if (c == '\"') quotes++;\n}\n\nby \n\nfor (; bIdx < cmd.length() && quotes != 2; bIdx++) {\n  char c = cmd.charAt(bIdx);\n  // Need to skip escaped characters\n  if (c == '\\\\') {\n    bIdx++;\n    continue;\n  }\n  if (c == '\"') quotes++;\n}\n\nJust removing the flag escaped is sufficient, because you don't have to remember\nwhether the last character was escaped and that should have no influence to\nconsecutive characters.\n\nThe bug still exists in the HEAD revision of the repository.", "id": 113615, "time": "2008-02-11T04:37:40Z", "creator": "konrad_w@gmx.de", "creation_time": "2008-02-11T04:37:40Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 44391, "text": "Your proposed patch isn't quire right. For example, you have to know if the previous character is escaped or not if you have two \\ in a row.\n\nI have committed a fix to trunk and proposed it for 6.0.x. ", "id": 115561, "time": "2008-04-11T14:25:54Z", "creator": "markt@apache.org", "creation_time": "2008-04-11T14:25:54Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "text": "The patch has been applied to 6.0.x and will be in 6.0.17 onwards.", "id": 115680, "time": "2008-04-17T10:53:10Z", "bug_id": 44391, "creation_time": "2008-04-17T10:53:10Z", "is_private": false}]