[{"count": 0, "tags": [], "bug_id": 60975, "text": "Hi,\nIn this case I am trying to convert a .doc document into an html,\nThe particular thing is that the document word is product of making a correspondence with data in a table of excel, that is to say, from word I use the option of \"correspondence\" which allows me to bring values \u200b\u200bof some excel table, when this happens, in the Word words are brought to perfection, but word internally adds them MERGEFIELD {FIELD} VALUE.\nThe problem is that if to these words or sentences that I have in the word I add an ENTER, when I try to convert to an html by means of wordToHtmlConverter.processDocument (doc), this duplicates the words that are after ENTER.\nExample:\nIn the .doc document:\nPhrase brought from\nExcel\n\nAfter the processDocument method:\nPhrase brought from excel\nExcel\n\nprocessDocument->AbstractWordConverter->org.apache.poi.hwpf.converter->poi-scratchpad-3.8-beta4.jar\n\nAs a test to rule out that it is a problem that was solved with the future versions, what I did was to update one by one each version until the last 3.16, but the bug persists.\n\nMy code:\n\nFileInputStream finStream=new FileInputStream(docFile.getAbsolutePath()); \n            HWPFDocument doc=new HWPFDocument(finStream);\n            WordExtractor wordExtract=new WordExtractor(doc);\n            Document newDocument = DocumentBuilderFactory.newInstance() .newDocumentBuilder().newDocument();\n            WordToHtmlConverter wordToHtmlConverter = new WordToHtmlConverter(newDocument) ;\n            wordToHtmlConverter.processDocument(doc);\n\n            StringWriter stringWriter = new StringWriter();\n            Transformer transformer = TransformerFactory.newInstance().newTransformer();\n\n            transformer.setOutputProperty(OutputKeys.INDENT, \"yes\");\n            transformer.setOutputProperty(OutputKeys.ENCODING, \"utf-8\");\n            transformer.setOutputProperty(OutputKeys.METHOD, \"html\");\n            transformer.transform(new DOMSource( wordToHtmlConverter.getDocument()), new StreamResult( stringWriter ) );\n\n            String html = stringWriter.toString();\n\nThanks.", "id": 198258, "time": "2017-04-12T11:22:40Z", "creator": "ricardo.martin.aguirre.sanchez@everis.com", "creation_time": "2017-04-12T11:22:40Z", "is_private": false, "attachment_id": null}]