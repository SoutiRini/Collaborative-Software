[{"count": 0, "tags": [], "text": "The program generates excel using POI and set style using HSSFCellStyle, such as fill background color, set border or display the number in thousand or million unit. The generated excel file's style works fine in Excel 2010 version. However, when open the same file using Excel 2013, some cells' style is lost whilst some are still there. Further we found that the program totally creates around 3000 HSSFCellStyle objects. If we reduce the number of instances of HSSFCellStyle objects. It helps to ease the issue, less cells' style lost.\n\nIs it a known issue ? Is there in place solution already ?\n\nSample,\n\nimport org.apache.poi.hssf.usermodel.HSSFCell;\nimport org.apache.poi.hssf.usermodel.HSSFCellStyle;\nimport org.apache.poi.hssf.usermodel.HSSFDataFormat;\nimport org.apache.poi.hssf.usermodel.HSSFFont;\nimport org.apache.poi.hssf.usermodel.HSSFRow;\nimport org.apache.poi.hssf.usermodel.HSSFSheet;\nimport org.apache.poi.hssf.usermodel.HSSFWorkbook;\nimport org.apache.poi.hssf.util.HSSFColor;\n\nHSSFCellStyle lvHcs = wb.createCellStyle(); //wb's class is HSSFWorkbook\nlvHcs.setAlignment(HSSFCellStyle.ALIGN_GENERAL);\nlvHcs.setVerticalAlignment(HSSFCellStyle.VERTICAL_BOTTOM);\nlvHcs.setWrapText(true);\nlvHcs.setFont(getFont(false, DEFAULT_FONT_SIZE));\nlvHcs.setBorderTop(pBorderType);\nlvHcs.setTopBorderColor(pBorderColor);\nlvHcs.setBorderLeft(pBorderType);\nlvHcs.setLeftBorderColor(pBorderColor);\nlvCell.setCellStyle(lvHcs); //lvCell's class is HSSFCell", "attachment_id": null, "bug_id": 58974, "id": 188241, "time": "2016-02-05T10:47:30Z", "creator": "alencai@163.com", "creation_time": "2016-02-05T10:47:30Z", "is_private": false}, {"count": 1, "tags": [], "text": "Microsoft Office imposes a limit on the number of styles that a Workbook can maintain. That's why you ideally need to create your styles once and re-use them, or failing that optimise the styles after creation. (The limit imposed by office is quite a bit lower than what the file format can actually cope with). See https://support.office.com/en-GB/article/Excel-specifications-and-limits-16c69c74-3d6a-4aaf-ba35-e6eb276e8eaa", "attachment_id": null, "bug_id": 58974, "id": 188244, "time": "2016-02-05T13:11:54Z", "creator": "apache@gagravarr.org", "creation_time": "2016-02-05T13:11:54Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 58974, "attachment_id": null, "id": 200393, "time": "2017-08-21T09:55:29Z", "creator": "manisha.barnwal@schrodinger.com", "creation_time": "2017-08-21T09:55:29Z", "is_private": false, "text": "Hi Nick Burch, even I am having the same problem and the link of MS Office Excel you have shared, shows same number of, maximum number of cell styles (64,000) in MS Excel 2010 and MS Excel 2013. In that case, how is the maximum of cell styles limiting MS Excel 2013 to show some cell styles while MS Excel 2010 is able to show those cell styles?"}]