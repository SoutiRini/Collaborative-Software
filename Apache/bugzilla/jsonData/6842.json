[{"count": 0, "tags": [], "text": "Using swing or awt one can use something called \"FontMetrics\".  FontMetrics lets\nyou pass in a String and the font info and you get out the lenght in various\nunits.  Currently, user's and POI people alike have to \"guess\" or create \"magic\nformulas\" that just happen to be right in order to get the cell sizing, etc.\ncorrect.  We cannot just use the swing or awt fontmetrics because 1> thats gui\nstuff 2> swing is a yucky libarary we don't want to depend on and 3> it creates\na dependancy on X.  Whoever creates a clean room (and differently named)\nFontMetrics will be revealed as a really cool joe (or jo)!", "is_private": false, "bug_id": 6842, "id": 11428, "time": "2002-03-04T13:05:11Z", "creator": "poi-support@buni.org", "creation_time": "2002-03-04T13:05:11Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 6842, "text": "For the record, jdk1.4 allows headless operations, so this is moot. However its\nobviously still relevant for jdk1.3 and below. If we need such functionality in\nPOI, maybe  a conditional compilation/execution may be tried in the interim\nbefore such an implementation is available?", "id": 18157, "time": "2002-06-20T10:07:57Z", "creator": "avik@apache.org", "creation_time": "2002-06-20T10:07:57Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "glens@apache.org", "text": "It will probably still be an issue even with 1.4.  What if the server you're\nrunning on doesn't have the font you require?  A fair bet if the server's not\nwindows.", "id": 18164, "time": "2002-06-20T11:53:07Z", "bug_id": 6842, "creation_time": "2002-06-20T11:53:07Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "Look at the FOP project; they have font managing utilities we could use.\n\nJDK headless is not a 100% solution, and FontMetrics sucks on most\nimplementation, and is generally not consistent between versions and platforms.", "is_private": false, "id": 18165, "creator": "nicolaken@apache.org", "time": "2002-06-20T12:16:23Z", "bug_id": 6842, "creation_time": "2002-06-20T12:16:23Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 6842, "is_private": false, "count": 4, "id": 18176, "time": "2002-06-20T13:32:50Z", "creator": "poi-support@buni.org", "creation_time": "2002-06-20T13:32:50Z", "text": "agreed (all around)"}, {"count": 5, "tags": [], "text": "Agreed. and corrected. ", "is_private": false, "bug_id": 6842, "id": 18181, "time": "2002-06-20T13:44:35Z", "creator": "avik@apache.org", "creation_time": "2002-06-20T13:44:35Z", "attachment_id": null}, {"count": 6, "tags": [], "creator": "poi-support@buni.org", "is_private": false, "text": "This might just be a job for super-glen or Ken (the XML boyz).  The FOP stuff is\nin XML, in theory we could generate our implementation from their XML...hehe..", "id": 18182, "time": "2002-06-20T14:00:28Z", "bug_id": 6842, "creation_time": "2002-06-20T14:00:28Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 6842, "is_private": false, "id": 117740, "attachment_id": null, "creator": "jukka@apache.org", "creation_time": "2008-06-16T14:05:22Z", "time": "2008-06-16T14:05:22Z", "text": "Also, the PDFBox project that's currently incubating has pretty good font\nmetrics in place. The code should hit Apache svn pretty soon, and I'll\ntake a look at whether it could be reused in POI."}, {"count": 8, "tags": [], "text": "See http://svn.apache.org/repos/asf/pdfbox/trunk/pdfbox/src/main/appended-resources/META-INF/LICENSE\n\nApache PDFBox should have code that we can use to provide Font Metrics. Unfortunately, this is only for the Base 14 fonts. The usefulness of having non-Java font handling is to be able to measure text for a document where you do not have the real font.\n\nIf you have the real font on your system then you can run in headless mode and use standard routines. If you do not have the correct font, if you can detect whether you are using a fixed, serif or non-serif then one of the base 14 can be a reasonable though not accurate stand in for the font.\n\nSomething to discuss at Apachecon 2010", "is_private": false, "id": 141247, "creator": "dfisher@jmlafferty.com", "time": "2010-10-29T17:44:26Z", "bug_id": 6842, "creation_time": "2010-10-29T17:44:26Z", "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 6842, "text": "Description of the changes made in the patch:\n\nXSSFImportFromXML will now consider the data type defined in the XML schema when filling the data of the xml into cells. It differentiates between Boolean, Integer, Data and String. Any unknown data types are handled as Strings. If the string value can't be parsed into the required data type (e.g. Integer or Date) it will result in a IllegalArgumentException. \nCurrently not all STXmlDataTypes are handled.\nFor an example refer to the test and test data in the patch.", "id": 182838, "attachment_id": null, "creator": "sandra.weber@zuehlke.com", "creation_time": "2015-05-05T10:28:05Z", "time": "2015-05-05T10:28:05Z", "is_private": false}, {"count": 10, "tags": [], "bug_id": 6842, "text": "(In reply to Sandra from comment #9)\n> Description of the changes made in the patch:\n> \n> XSSFImportFromXML will now consider the data type defined in the XML schema\n> when filling the data of the xml into cells. It differentiates between\n> Boolean, Integer, Data and String. Any unknown data types are handled as\n> Strings. If the string value can't be parsed into the required data type\n> (e.g. Integer or Date) it will result in a IllegalArgumentException. \n> Currently not all STXmlDataTypes are handled.\n> For an example refer to the test and test data in the patch.\n\nSorry wrong bug. Please ignore", "id": 182839, "time": "2015-05-05T10:29:58Z", "creator": "sandra.weber@zuehlke.com", "creation_time": "2015-05-05T10:29:58Z", "is_private": false, "attachment_id": null}, {"count": 11, "tags": [], "bug_id": 6842, "text": "I don't think anybody was actively looking at this for years, therefore closing this for now, please reopen if you plan to work on something like this.", "id": 190114, "time": "2016-04-10T20:57:34Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-04-10T20:57:34Z", "is_private": false, "attachment_id": null}]