[{"count": 0, "tags": [], "creator": "arkadi@mebius.lv", "text": "Apache is started with mod_ssl enabled. When doing graceful restart a lot of\nmessages about SSL handshake failed are written to error.log. Every apache child\nprocess thinks incoming connection is arrived. The restart is completed sucessfully.\nThe OS is FreeBSD 4.11.\n\n[Wed May 24 14:12:27 2006] [notice] Graceful restart requested, doing restart\n[Wed May 24 14:12:27 2006] [info] [client 62.85.37.81] Connection to child 1\nestablished (server idea.hosting.lv:443)\n[Wed May 24 14:12:27 2006] [info] [client 62.85.37.81] Connection to child 5\nestablished (server idea.hosting.lv:443)\n[Wed May 24 14:12:27 2006] [info] [client 62.85.37.81] Connection to child 6\nestablished (server idea.hosting.lv:443)\n[Wed May 24 14:12:27 2006] [info] [client 62.85.37.81] Connection to child 2\nestablished (server idea.hosting.lv:443)\n[Wed May 24 14:12:27 2006] [info] [client 62.85.37.81] Connection to child 0\nestablished (server idea.hosting.lv:443)\n[Wed May 24 14:12:27 2006] [info] [client 62.85.37.81] Connection to child 7\nestablished (server idea.hosting.lv:443)\n[Wed May 24 14:12:27 2006] [info] [client 62.85.37.81] Connection to child 4\nestablished (server idea.hosting.lv:443)\n[Wed May 24 14:12:27 2006] [info] [client 62.85.37.81] Connection to child 8\nestablished (server idea.hosting.lv:443)\n[Wed May 24 14:12:27 2006] [info] [client 62.85.37.81] Connection to child 3\nestablished (server idea.hosting.lv:443)\n[Wed May 24 14:12:27 2006] [info] [client 62.85.37.81] Connection to child 9\nestablished (server idea.hosting.lv:443)\n[Wed May 24 14:12:27 2006] [info] Seeding PRNG with 136 bytes of entropy\n[Wed May 24 14:12:27 2006] [info] Seeding PRNG with 136 bytes of entropy\n[Wed May 24 14:12:27 2006] [info] Seeding PRNG with 136 bytes of entropy\n[Wed May 24 14:12:27 2006] [info] Seeding PRNG with 136 bytes of entropy\n[Wed May 24 14:12:27 2006] [info] Seeding PRNG with 136 bytes of entropy\n[Wed May 24 14:12:27 2006] [info] Seeding PRNG with 136 bytes of entropy\n[Wed May 24 14:12:27 2006] [info] Seeding PRNG with 136 bytes of entropy\n[Wed May 24 14:12:27 2006] [info] Seeding PRNG with 136 bytes of entropy\n[Wed May 24 14:12:27 2006] [info] Seeding PRNG with 136 bytes of entropy\n[Wed May 24 14:12:27 2006] [info] Seeding PRNG with 136 bytes of entropy\n[Wed May 24 14:12:27 2006] [info] [client 62.85.37.81] SSL handshake failed:\nHTTP spoken on HTTPS port; trying to send HTML er\n[Wed May 24 14:12:27 2006] [info] [client 62.85.37.81] SSL handshake failed:\nHTTP spoken on HTTPS port; trying to send HTML er\n[Wed May 24 14:12:27 2006] [info] [client 62.85.37.81] SSL handshake failed:\nHTTP spoken on HTTPS port; trying to send HTML er\n[Wed May 24 14:12:27 2006] [info] [client 62.85.37.81] SSL handshake failed:\nHTTP spoken on HTTPS port; trying to send HTML er\n[Wed May 24 14:12:27 2006] [info] [client 62.85.37.81] SSL handshake failed:\nHTTP spoken on HTTPS port; trying to send HTML er\n[Wed May 24 14:12:27 2006] [info] [client 62.85.37.81] SSL handshake failed:\nHTTP spoken on HTTPS port; trying to send HTML er\n[Wed May 24 14:12:27 2006] [info] [client 62.85.37.81] SSL handshake failed:\nHTTP spoken on HTTPS port; trying to send HTML er\n[Wed May 24 14:12:27 2006] [info] [client 62.85.37.81] SSL handshake failed:\nHTTP spoken on HTTPS port; trying to send HTML er\n[Wed May 24 14:12:27 2006] [info] [client 62.85.37.81] SSL handshake failed:\nHTTP spoken on HTTPS port; trying to send HTML er\n[Wed May 24 14:12:27 2006] [info] [client 62.85.37.81] SSL handshake failed:\nHTTP spoken on HTTPS port; trying to send HTML er\n[Wed May 24 14:12:27 2006] [info] SSL Library Error: 336027804\nerror:1407609C:SSL routines:SSL23_GET_CLIENT_HELLO:http request\n[Wed May 24 14:12:27 2006] [info] SSL Library Error: 336027804\nerror:1407609C:SSL routines:SSL23_GET_CLIENT_HELLO:http request\n[Wed May 24 14:12:27 2006] [info] SSL Library Error: 336027804\nerror:1407609C:SSL routines:SSL23_GET_CLIENT_HELLO:http request\n[Wed May 24 14:12:27 2006] [info] SSL Library Error: 336027804\nerror:1407609C:SSL routines:SSL23_GET_CLIENT_HELLO:http request\n[Wed May 24 14:12:27 2006] [info] SSL Library Error: 336027804\nerror:1407609C:SSL routines:SSL23_GET_CLIENT_HELLO:http request\n[Wed May 24 14:12:27 2006] [info] SSL Library Error: 336027804\nerror:1407609C:SSL routines:SSL23_GET_CLIENT_HELLO:http request\n[Wed May 24 14:12:27 2006] [info] SSL Library Error: 336027804\nerror:1407609C:SSL routines:SSL23_GET_CLIENT_HELLO:http request\n[Wed May 24 14:12:27 2006] [info] SSL Library Error: 336027804\nerror:1407609C:SSL routines:SSL23_GET_CLIENT_HELLO:http request\n[Wed May 24 14:12:27 2006] [info] SSL Library Error: 336027804\nerror:1407609C:SSL routines:SSL23_GET_CLIENT_HELLO:http request", "id": 89439, "time": "2006-05-24T12:39:32Z", "bug_id": 39653, "creation_time": "2006-05-24T12:39:32Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "chip@force-elite.com", "text": "This is caused by the core trying to activate any accept filters that might\nleave a process stuck waiting for data from a client.", "id": 90426, "time": "2006-06-21T09:16:59Z", "bug_id": 39653, "creation_time": "2006-06-21T09:16:59Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 39653, "attachment_id": null, "text": "I don't think it's really worth making real SSL connections to fix this; what\nwould be useful though is that dummy_connection() could specifically look for a\nnon-SSL vhost to use.  But ->protocol is not getting set to \"https\" for such\nservers at the moment unless explicitly configured :(", "id": 90434, "time": "2006-06-21T12:15:38Z", "creator": "jorton@redhat.com", "creation_time": "2006-06-21T12:15:38Z", "is_private": false}, {"count": 3, "tags": [], "creator": "jorton@redhat.com", "text": "Fixing this is an RFE for the core, current behaviour is not really causing\nincorrect server operation, just some error_log spam.", "id": 90830, "time": "2006-07-03T11:51:04Z", "bug_id": 39653, "creation_time": "2006-07-03T11:51:04Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 39653, "attachment_id": null, "id": 90831, "time": "2006-07-03T11:54:54Z", "creator": "arkadi@mebius.lv", "creation_time": "2006-07-03T11:54:54Z", "is_private": false, "text": "There are also access_log records. Not nice when monitoring status codes."}, {"count": 5, "tags": [], "bug_id": 39653, "attachment_id": null, "text": "*** Bug 41459 has been marked as a duplicate of this bug. ***", "id": 99856, "time": "2007-02-27T09:05:54Z", "creator": "jorton@redhat.com", "creation_time": "2007-02-27T09:05:54Z", "is_private": false}, {"count": 6, "tags": [], "creator": "chip@force-elite.com", "text": "*** Bug 41191 has been marked as a duplicate of this bug. ***", "id": 100061, "time": "2007-03-05T11:56:12Z", "bug_id": 39653, "creation_time": "2007-03-05T11:56:12Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "creator": "csross@optonline.net", "text": "I have a new 64 bit apache 2.2.4 server on Solaris 10 with openssl 0.9.8e. When \nI DO NOT have the ssl.conf file included and I \"apachectl graceful\" to apache, \nall my processes that are gracefully shutdown are shown by a dash (-). When I \nhave the Include line for the ssl.conf file uncommented, the number of Gs never \nchanges, like it is locked in the graceful shutdown. \n\nany suggestions", "id": 103524, "time": "2007-05-22T16:30:57Z", "bug_id": 39653, "creation_time": "2007-05-22T16:30:57Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "creator": "poromenos@poromenos.org", "text": "I have a suspicion that this bug caused my apache to spawn 150 processes (as \nmany as MaxClients would allow), thus repeatedly crashing the server (once per \nday).\n\nThis bug makes about one request per second, I suspect causing apache to spawn \nmultiple instances, although I don't know why it would spawn as many as \nMaxSpareServers and not as many as MaxClients right away.", "id": 105313, "time": "2007-07-12T01:42:49Z", "bug_id": 39653, "creation_time": "2007-07-12T01:42:49Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "creator": "takashi.asfbugzilla@tks.st", "text": "*** Bug 43978 has been marked as a duplicate of this bug. ***", "id": 111183, "time": "2007-11-27T16:15:38Z", "bug_id": 39653, "creation_time": "2007-11-27T16:15:38Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 39653, "attachment_id": null, "text": "Is there a workaround?\nI don't like my access_log filled with several thousand erroneous lines a day\n", "id": 111191, "time": "2007-11-27T23:28:43Z", "creator": "markus@senoner.com", "creation_time": "2007-11-27T23:28:43Z", "is_private": false}, {"count": 11, "tags": [], "creator": "glenn@apache.org", "text": "I am seeing the same problem with apache 2.2.6 from ports on FreeBSD \n6.2-RELEASE-p4 FreeBSD 6.2-RELEASE-p4 #0 .\n\nWe recently upgraded to Apache 2.2 from Apache 2.0. With apache 2.0 we\ncould do an apachectl graceful at will with no impact to those visiting\nthe sites we host. With apache 2.2 apachectl graceful causes a large load\nspike which results in a disruption serving requests. We have had to limit\nour apachectl graceful's to times when there is low request volume.", "id": 111287, "time": "2007-11-29T14:51:32Z", "bug_id": 39653, "creation_time": "2007-11-29T14:51:32Z", "is_private": false, "attachment_id": null}, {"count": 12, "tags": [], "creator": "takashi.asfbugzilla@tks.st", "text": "One of the workarounds is using Worker MPM", "id": 111291, "time": "2007-11-29T15:45:33Z", "bug_id": 39653, "creation_time": "2007-11-29T15:45:33Z", "is_private": false, "attachment_id": null}, {"count": 13, "tags": [], "bug_id": 39653, "attachment_id": null, "text": "I reinstalled apache 2.2.6 with the worker MPM on FreeBSD 6.2-RELEASE-p4 #0.\n\nThe number of \"GET /\" 400 480 \"-\" \"-\" log entries have pretty much gone away,\nI am still seeing a few.\n\nWe still see a large load spike when we graceful apache.", "id": 112583, "time": "2008-01-07T07:51:39Z", "creator": "glenn@apache.org", "creation_time": "2008-01-07T07:51:39Z", "is_private": false}, {"count": 14, "tags": [], "text": "I fixed this behaviour by putting \"listen 443\" before \"listen 80\". Is it possible that apache uses last provided port for connecting to clients?", "attachment_id": null, "bug_id": 39653, "id": 119853, "time": "2008-08-15T02:21:05Z", "creator": "uhlar@fantomas.sk", "creation_time": "2008-08-15T02:21:05Z", "is_private": false}, {"count": 15, "tags": [], "bug_id": 39653, "attachment_id": null, "id": 123263, "time": "2008-12-12T08:09:36Z", "creator": "jorton@redhat.com", "creation_time": "2008-12-12T08:09:36Z", "is_private": false, "text": "Best we can do for this is I think as committed to trunk in r726065."}]