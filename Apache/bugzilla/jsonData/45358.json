[{"count": 0, "tags": [], "bug_id": 45358, "text": "When running HSSFFormulaEvaluator.evaluateAllFormulaCells(wb); the following exception occurs:\n\njava.lang.IllegalArgumentException: Array size should be (0) but was (114)\n\tat org.apache.poi.hssf.record.formula.eval.AreaEvalBase.<init>(AreaEvalBase.java:50)\n\tat org.apache.poi.hssf.record.formula.eval.Area3DEval.<init>(Area3DEval.java:32)\n\tat org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluateArea3dPtg(HSSFFormulaEvaluator.java:510)\n\tat org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluateCell(HSSFFormulaEvaluator.java:414)\n\tat org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.internalEvaluate(HSSFFormulaEvaluator.java:338)\n\tat org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluateFormulaCell(HSSFFormulaEvaluator.java:183)\n\tat org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluateAllFormulaCells(HSSFFormulaEvaluator.java:278)\n\tat inavero.excelReporter.Generator.start(Generator.java:59)\n\tat inavero.excelReporter.App$2.handleEvent(App.java:58)\n\tat org.eclipse.swt.widgets.EventTable.sendEvent(Unknown Source)\n\tat org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source)\n\tat org.eclipse.swt.widgets.Display.runDeferredEvents(Unknown Source)\n\tat org.eclipse.swt.widgets.Display.readAndDispatch(Unknown Source)\n\tat inavero.excelReporter.App.main(App.java:70)\n\nI will try and put together a sanitized spreadsheet as soon as I can that still reproduces the error.", "id": 118369, "time": "2008-07-07T15:34:45Z", "creator": "zack.manning@gmail.com", "creation_time": "2008-07-07T15:34:45Z", "is_private": false, "attachment_id": null}, {"count": 1, "attachment_id": null, "creator": "apache@gagravarr.org", "is_private": false, "id": 118504, "time": "2008-07-10T14:56:52Z", "bug_id": 45358, "creation_time": "2008-07-10T14:56:52Z", "tags": [], "text": "Alas without the sample spreadsheet, we won't be able to figure out what's going wrong (none of our current tests manage to trigger this)\n\nIf you could please upload a spreadsheet that triggers this, that'd be wonderful.\n\n(You'll probably find that replacing all the strings and numbers with dummy values using poi will yield a file that triggers the error, but is uploadable to bugzilla)"}, {"count": 2, "tags": [], "creator": "bogguard@gmail.com", "attachment_id": null, "text": "I have the same issue and it is reproduced by the VLOOKUP function\nfor example : VLOOKUP(D28;$Z$129:$AE$276;2;0)\nAll the data within the VLOOKUP does not contain functions.\n\nKind regards", "id": 119540, "time": "2008-08-07T03:17:22Z", "bug_id": 45358, "creation_time": "2008-08-07T03:17:22Z", "is_private": false}, {"count": 3, "attachment_id": 22446, "creator": "amoreno@citic.es", "is_private": false, "id": 119828, "time": "2008-08-14T03:41:28Z", "bug_id": 45358, "creation_time": "2008-08-14T03:41:28Z", "tags": [], "text": "Created attachment 22446\nTemplate that produce the error\n\nThis file produce a similar error:\n\njava.lang.IllegalArgumentException: Array size should be (-2) but was (1998)\n\tat org.apache.poi.hssf.record.formula.eval.AreaEvalBase.<init>(AreaEvalBase.java:50)\n\tat org.apache.poi.hssf.record.formula.eval.Area3DEval.<init>(Area3DEval.java:32)\n\tat org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluateArea3dPtg(HSSFFormulaEvaluator.java:510)\n\tat org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluateCell(HSSFFormulaEvaluator.java:414)\n\tat org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.internalEvaluate(HSSFFormulaEvaluator.java:338)\n\tat org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluateFormulaCell(HSSFFormulaEvaluator.java:183)\n\n\nI hope that it is a help to resolve the problem.\n\nPS: The file is compress because it's was so big."}, {"count": 4, "attachment_id": null, "creator": "josh@apache.org", "text": "There were 3 problems encountered getting the sample spreadsheet to work with HSSFFormulaEvaluator.evaluateAllFormulaCells(wb).\n\nThe first bug was that 3-d area refs like \"Sheet1!A10:A40000\" had a 16-bit signed/unsigned error. Fixed and junit added in svn r690772.\n\nSecondly there was a major performance problem with all the recursive evaluation of the large areas referenced by the formulas.  Before the fix, evaluation was extremely slow (a test run was terminated after 4 minutes, with no sign of progress).  After the fix, the whole spreadsheet evaluates in about 10 seconds.  It's also likely that the fix for bug 45376 (when it happens) will alleviate things further. This was fixed in  r690835.\n\nLastly there was a ClassCastException in the implementation of 'IF' due to the first arg not being a plain BoolEval. Fix and junit added in svn r690836.\n\n\n\n\n", "id": 120248, "time": "2008-08-31T19:34:47Z", "bug_id": 45358, "creation_time": "2008-08-31T19:34:47Z", "tags": [], "is_private": false}]