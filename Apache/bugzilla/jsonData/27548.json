[{"count": 0, "tags": [], "bug_id": 27548, "text": "This bug happens on 1.5.1, 2.0 Final and version is 2.5 Final.\n\nI don't see anyway to attach the excel file that fails.\nI can e-mail the file, just give me the e-mail address.\n\nstack trace:\njava.lang.reflect.InvocationTargetException\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance\n(NativeConstructorAccessorImpl.java:39)\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance\n(DelegatingConstructorAccessorImpl.java:27)\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:274)\n        at org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java:224)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java:160)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:165)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:132)\n...\nCaused by: java.lang.IllegalArgumentException: Illegal length\n        at org.apache.poi.util.StringUtil.getFromUnicodeHigh(StringUtil.java:76)\n        at org.apache.poi.hssf.record.FontRecord.fillFields(FontRecord.java:135)\n        at org.apache.poi.hssf.record.Record.fillFields(Record.java:90)\n        at org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n        at org.apache.poi.hssf.record.FontRecord.<init>(FontRecord.java:88)\n...\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record \ninstance, the following exception occured: null\n        at org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java:237)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java:160)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:165)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:132)", "id": 53744, "attachment_id": null, "creator": "lancew@jeld-wen.com", "creation_time": "2004-03-09T19:39:56Z", "time": "2004-03-09T19:39:56Z", "is_private": false}, {"count": 1, "tags": [], "creator": "dmui@apache.org", "text": "Click \"Create a new attachment\" after the initial bug submission", "id": 53745, "time": "2004-03-09T19:44:01Z", "bug_id": 27548, "creation_time": "2004-03-09T19:44:01Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "lancew@jeld-wen.com", "text": "Created attachment 10729\nHere is the file that causes this error", "id": 53746, "time": "2004-03-09T19:44:38Z", "bug_id": 27548, "creation_time": "2004-03-09T19:44:38Z", "is_private": false, "attachment_id": 10729}, {"count": 3, "attachment_id": 10793, "bug_id": 27548, "is_private": false, "id": 54035, "time": "2004-03-15T19:35:44Z", "creator": "lancew@jeld-wen.com", "creation_time": "2004-03-15T19:35:44Z", "tags": [], "text": "Created attachment 10793\nA simple test java file that shows the error"}, {"count": 4, "tags": [], "creator": "lancew@jeld-wen.com", "text": "I attached a simple java file that ilistrates the error.\n\nexecute it something like this:\njava -cp poi-2.5-final-20040302.jar;. xlstest 2004TimeSheet.xls", "id": 54036, "time": "2004-03-15T19:38:09Z", "bug_id": 27548, "creation_time": "2004-03-15T19:38:09Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 27548, "text": "I believe this happens because the workbook is encrypted. If you run through \nBiffViewer, you can see that the WRITEPROTECT record is present, and the first \nrecords after WRITEPROTECT contain very strange data. The first record after \nthe WRITEPROTECT that contains a String is the FONT record, but the font name \ncannot be read because the name and length are encrypted. POI does not support \nencryption and cannot read a workbook which is password protected.\n\nTry removing the protection and see if the program works.", "id": 54046, "attachment_id": null, "creator": "zalewski@optonline.net", "creation_time": "2004-03-16T03:08:29Z", "time": "2004-03-16T03:08:29Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 27548, "attachment_id": null, "text": "We are using POI to read the text of an Excel file.  Then we use lucene for \nindexing, and searching our our website.\n\nFor business needs some files could be write protected.\n\nIs there a better way to get the text our of the excell files.  Or is it \nposible to give a better exception such as FileProtectedException?", "id": 54090, "time": "2004-03-16T17:32:04Z", "creator": "lancew@jeld-wen.com", "creation_time": "2004-03-16T17:32:04Z", "is_private": false}, {"count": 7, "tags": [], "creator": "b.hirtsiefer@eggheads.de", "attachment_id": 11074, "id": 54969, "time": "2004-03-31T15:22:23Z", "bug_id": 27548, "creation_time": "2004-03-31T15:22:23Z", "is_private": false, "text": "Created attachment 11074\npossible workaround: jakarta-poi-1.10.0"}, {"count": 8, "tags": [], "bug_id": 27548, "text": "I've tracked this down a little bit more.\n\nIf I password protect a sheet, it works fine, I can read all the data.\nBut If I password protect the workbook, it fails.\n\nIt seems to me if you have code to read a paswword protected sheet, reading a \npassword protected woorkbook shouldn't be much different.", "id": 55552, "attachment_id": null, "creator": "lancew@jeld-wen.com", "creation_time": "2004-04-09T00:25:50Z", "time": "2004-04-09T00:25:50Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 27548, "attachment_id": null, "text": "The same exception is being thrown when the Excel file has AutoFilter enabled.", "id": 55708, "time": "2004-04-13T16:28:11Z", "creator": "t.neumann@ff-muenchen.de", "creation_time": "2004-04-13T16:28:11Z", "is_private": false}, {"count": 10, "tags": [], "creator": "tony.nys@aditel.be", "text": "Created attachment 11311\nsample excel file to generate this error: simple AutoFilter", "id": 56251, "time": "2004-04-22T15:08:45Z", "bug_id": 27548, "creation_time": "2004-04-22T15:08:45Z", "is_private": false, "attachment_id": 11311}, {"count": 11, "tags": [], "creator": "tony.nys@aditel.be", "attachment_id": null, "id": 56253, "time": "2004-04-22T15:09:47Z", "bug_id": 27548, "creation_time": "2004-04-22T15:09:47Z", "is_private": false, "text": "You can simply generate it by creating an excel file\nwith an autofilter dropdown box, see my attachment\n\nThis worked with POI 1.11"}, {"count": 12, "tags": [], "creator": "jheight@apache.org", "text": "*** Bug 39190 has been marked as a duplicate of this bug. ***", "id": 92580, "time": "2006-08-27T11:55:12Z", "bug_id": 27548, "creation_time": "2006-08-27T11:55:12Z", "is_private": false, "attachment_id": null}, {"count": 13, "tags": [], "bug_id": 27548, "attachment_id": null, "text": "Original issue is due to encrypted workbook. HSSF does not currently support\nthis (see FAQ).\n\nAutoFilter worksforme.\n\nMarking this WONTFIX\n\nJason", "id": 92581, "time": "2006-08-27T12:00:36Z", "creator": "jheight@apache.org", "creation_time": "2006-08-27T12:00:36Z", "is_private": false}, {"count": 14, "tags": [], "creator": "josh@apache.org", "text": "(In reply to comment #13)\n> Original issue is due to encrypted workbook. HSSF does not currently support\n> this (see FAQ).\nPOI was fixed to throw an explicit exception in svn r437370", "id": 125301, "time": "2009-03-03T15:27:37Z", "bug_id": 27548, "creation_time": "2009-03-03T15:27:37Z", "is_private": false, "attachment_id": null}, {"count": 15, "tags": [], "bug_id": 27548, "attachment_id": null, "text": "(In reply to comment #14)\n> POI was fixed to throw an explicit exception in svn r43737\n\nSorry about the typo (missing last digit).  The change is here: svn r437370", "id": 125303, "time": "2009-03-03T15:56:48Z", "creator": "josh@apache.org", "creation_time": "2009-03-03T15:56:48Z", "is_private": false}]