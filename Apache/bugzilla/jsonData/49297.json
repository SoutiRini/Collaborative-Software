[{"count": 0, "tags": [], "bug_id": 49297, "attachment_id": 25441, "text": "Created attachment 25441\n2010-05-15_tc7_attribute_name_whitespace-test.patch\n\nThe /test/webapp-3.0/bug45nnn/bug45015b.jsp page of trunk contains the following text:\n<tags:echo echo=\"hello \"wo\"rld\" />\n\nRunning the test (testBug45015b of org.apache.jasper.compiler.TestGenerator) produces the following message:\n\norg.apache.jasper.JasperException: /bug45nnn/bug45015b.jsp(21,30) equal symbol expected\n\n\nIt means, that the parser interprets \"wo\" as an attribute name, ignoring the fact that there is no whitespace before it.\n\n\nIf I write\n<tags:echo echo=\"hello \"wo=\"rld\" />\nthe test complains that attribute \"wo\" is invalid for the tag,\n\nand finally if I write\n<tags:echo echo=\"hello \"echo=\"rld\" />\nthe test succeeds, while I would expect it to fail.\n\nI am attaching a patch that adds a testcase based on the last example, though a better testcase is needed that does not use the same attribute name twice.\n\nI think it is a minor issue, because this issue does not affect valid JSP pages, though allows to run some invalid ones.\n\n\nIt is reproducible in the current 6.0 and 5.5 as well (thus 6.0.26, 5.5.29):\nif I add the following to /webapps/examples/jsp/simpletag/foo.jsp of TC6 (or the respective page in TC5.5):\n<ul>\n<eg:foo att1=\"1\"att2=\"2\"att3=\"3\">\n<li><%= member %></li>\n</eg:foo>\n</ul>\n\nand call http://localhost:8080/examples/jsp/simpletag/foo.jsp\nthe page runs successfully and displays \"1, 2, 3\" list items among its output.\n\nExpected result: show some compilation error, e.g. \">, /> or whitespace was expected\".", "id": 136878, "time": "2010-05-15T15:58:53Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2010-05-15T15:58:53Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 49297, "attachment_id": null, "text": "(In reply to comment #0)\n> It means, that the parser interprets \"wo\" as an attribute name, ignoring the\n> fact that there is no whitespace before it.\n\nWhich spec requires there to be white-space before an attribute name? I can't see why it would be necessary.\n\n> If I write\n> <tags:echo echo=\"hello \"wo=\"rld\" />\n> the test complains that attribute \"wo\" is invalid for the tag,\n\nI don't see this issue here. That is what I would expect to happen.\n\n\n> and finally if I write\n> <tags:echo echo=\"hello \"echo=\"rld\" />\n> the test succeeds, while I would expect it to fail.\n\nThat is a little more odd. I'm not sure what I would expect in that case. I'd need to do some spec research on that one.", "id": 136883, "time": "2010-05-15T18:39:34Z", "creator": "markt@apache.org", "creation_time": "2010-05-15T18:39:34Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 49297, "attachment_id": null, "text": "(In reply to comment #1)\n> (In reply to comment #0)\n> > It means, that the parser interprets \"wo\" as an attribute name, ignoring the\n> > fact that there is no whitespace before it.\n> \n> Which spec requires there to be white-space before an attribute name? I can't\n> see why it would be necessary.\n> \n\nFrom jsp-2_1-fr-spec.pdf:\n\nJSP.1.3.2 Element Syntax\n\"Action elements follow the syntax of an XML element.\"\n\nJSP.1.3.10.1 EBNF Grammar for JSP Syntax\n\nAllBody ::= ...\n    ( \u2018<\u2018 CustomAction CustomActionBody )\n\nCustomAction ::= TagPrefix \u2019:\u2019 CustomActionName\n\nCustomActionBody ::= ( Attributes CustomActionEnd )\n\nAttributes ::= ( S Attribute )* S?\n[ vc: UniqueAttSpec ]\n\nThe 'S' before Attribute means that a space is required, and UniqueAttSpec says that the same attribute name cannot appear more than once.", "id": 136885, "time": "2010-05-15T19:01:53Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2010-05-15T19:01:53Z", "is_private": false}, {"count": 3, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 136887, "time": "2010-05-15T19:21:40Z", "bug_id": 49297, "creation_time": "2010-05-15T19:21:40Z", "is_private": false, "text": "(In reply to comment #2)\n> The 'S' before Attribute means that a space is required\n\nThanks for the reference. It still seems pointless, but we should fix it. Not something I think we need to worry about for 7.0.0.\n\n>UniqueAttSpec says that the same attribute name cannot appear more than once.\n\nNow that I can see the point of. More important, but still not a show stopper for 7.0.0 in my view."}, {"count": 4, "tags": [], "bug_id": 49297, "attachment_id": null, "text": "Fixed in 7.0.x and will be included in 7.0.5 onwards.", "id": 140822, "time": "2010-10-19T09:21:56Z", "creator": "markt@apache.org", "creation_time": "2010-10-19T09:21:56Z", "is_private": false}, {"text": "Created attachment 26275\nFix the spec broken code in related code of this bug.\n\nHello, the fix of this bug recently result in some JSP TCK failures of geronimo. According to jsp spec :\n\n\"A translation error will occur if the page directive defines duplicate attribute/values within a given   translation unit, unless the values for the duplicate attributes are identical for all occurrences. The   import and pageEncoding attributes are exempt from this rule and can appear multiple times.\"\n\nAdding a patch with testcases to fix this.", "tags": [], "bug_id": 49297, "attachment_id": 26275, "count": 5, "id": 141583, "time": "2010-11-09T22:52:42Z", "creator": "genspring@gmail.com", "creation_time": "2010-11-09T22:52:42Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 49297, "attachment_id": null, "id": 141584, "time": "2010-11-09T22:53:37Z", "creator": "genspring@gmail.com", "creation_time": "2010-11-09T22:53:37Z", "is_private": false, "text": "Reopen it because we have regressions here."}, {"count": 7, "tags": [], "bug_id": 49297, "attachment_id": 26276, "id": 141585, "time": "2010-11-09T22:57:39Z", "creator": "genspring@gmail.com", "creation_time": "2010-11-09T22:57:39Z", "is_private": false, "text": "Created attachment 26276\nFix the spec broken code in related code of this bug.\n\nops, update the patch to include a missed block."}, {"count": 8, "tags": [], "creator": "markt@apache.org", "text": "The quote above along with some comments in the patch suggests an ambiguity in the spec. The JSP 2.2 language is quite clear:\n<quote>\nThere shall be only one occurrence of any attribute/value pair defined by this directive in a given translation unit, unless the values for the duplicate attributes are identical for all occurrences. The import and pageEncoding\nattributes are exempt from this rule and can appear multiple times. Multiple uses of the import attribute are cumulative (with ordered set union semantics). The pageEncoding attribute can occur at most once per file (or a translation error will result), and applies only to the file in which it appears.\n</quote>", "id": 141660, "time": "2010-11-12T08:45:02Z", "bug_id": 49297, "creation_time": "2010-11-12T08:45:02Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "creator": "markt@apache.org", "text": "Thanks for the patch. I didn't use it exactly but I did base the final fix on your patch.\n\nThe fix is in 7.0.x and will be included in 7.0.5 onwards.", "id": 141676, "time": "2010-11-12T11:53:09Z", "bug_id": 49297, "creation_time": "2010-11-12T11:53:09Z", "is_private": false, "attachment_id": null}, {"text": "Thank Mark, The fix works like a charm with pageDirective, but we should include the same logic for tag Directive according to the spec.  \n\nPer JSP.8.5.1 The tag Directive\n\n\"The tag directive is similar to the page directive, but applies to tag files instead\nof JSPs. Like the page directive, a translation unit can contain more than one\ninstance of the tag directive, all the attributes will apply to the complete translation unit (i.e. tag directives are position independent). There shall be only one occurrence of any attribute/value defined by this directive in a given translation unit,unless the values for the duplicate attributes are identical for all occurrences. The import and pageEncoding attributes are exempt from this rule and can appear multiple times. Multiple uses of the import attribute are cumulative (with ordered set union semantics). Other such multiple attribute/value (re)de\ufb01nitions result in a fatal translation error if the values do not match.\"", "tags": [], "bug_id": 49297, "attachment_id": null, "count": 10, "id": 141703, "time": "2010-11-14T02:18:15Z", "creator": "genspring@gmail.com", "creation_time": "2010-11-14T02:18:15Z", "is_private": false}, {"count": 11, "tags": [], "creator": "markt@apache.org", "text": "Tag directives fixed too", "id": 141844, "time": "2010-11-19T13:22:37Z", "bug_id": 49297, "creation_time": "2010-11-19T13:22:37Z", "is_private": false, "attachment_id": null}, {"count": 12, "tags": [], "creator": "arifchy@gmail.com", "text": "I have tried on apache-tomcat-7.0.11 problem is still there and not yet fixed. if fixed by this time. please guide us how to resolve.", "id": 145101, "time": "2011-03-19T06:07:04Z", "bug_id": 49297, "creation_time": "2011-03-19T06:07:04Z", "is_private": false, "attachment_id": null}, {"count": 13, "text": "This issue is fixed.\n\nBugzilla is not a support forum. Please direct your enquiry to the Tomcat users mailing list.", "bug_id": 49297, "is_private": false, "id": 145102, "time": "2011-03-19T06:29:53Z", "creator": "markt@apache.org", "creation_time": "2011-03-19T06:29:53Z", "tags": [], "attachment_id": null}]