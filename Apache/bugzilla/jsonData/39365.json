[{"count": 0, "tags": [], "creator": "xxpitch@21cn.com", "attachment_id": null, "id": 88319, "time": "2006-04-20T13:44:59Z", "bug_id": 39365, "creation_time": "2006-04-20T13:44:59Z", "is_private": false, "text": "Bug Description:\nSet the formula like this:\n  cell.setCellType(HSSFCell.CELL_TYPE_FORMULA);\n  cell.setCellFormula(\"NotExcelFormula(A1,A2)\");\n\nThis formula displays in the Excel is wrong: \n  =A1(A2)\u0013NOTEXCELFORMULA\nThe method FormulaParser.function() put a NamePtg at the end of the function \ntokens, however the NamePtg must be the first of the tokens. \nI have fixed the method \"FormulaParser.function()\" as the following:\n\nFormulaParser.function(String name){ \n     //average 2 args per function \n     this.functionTokens.add(0, new ArrayList(2)); \n     short funcIndex = AbstractFunctionPtg.lookupIndex(name); \n     //NamePtg at the first \n     if (funcIndex == AbstractFunctionPtg.INDEX_EXTERNAL) { \n          tokens.add(new NamePtg(name, this.book)); \n     } \n     Match('('); \n     int numArgs = Arguments(); \n     Match(')'); \n     //argument number must be plus 1 \n     if (funcIndex == AbstractFunctionPtg.INDEX_EXTERNAL) { \n         numArgs++; \n     } \n     AbstractFunctionPtg functionPtg = getFunction(name,(byte)numArgs); \n     tokens.add(functionPtg); \n//        if (functionPtg.getName().equals(\"externalflag\")) { \n//            tokens.add(new NamePtg(name, this.book)); \n//        } \n//remove what we just put in \n     this.functionTokens.remove(0); \n}"}, {"count": 1, "tags": [], "creator": "josh@apache.org", "attachment_id": null, "id": 116452, "time": "2008-05-10T17:42:52Z", "bug_id": 39365, "creation_time": "2008-05-10T17:42:52Z", "is_private": false, "text": "Retested in OK 3.1-beta1.\n\nThis was probably fixed in bug 44504 (svn r633547)"}]