[{"count": 0, "text": "When porting make to ant we need to see what is the difference between the \nbuild files when done from make and when done from ant. In such case it would \nbe better to have DirDiff Task which takes in src and dest directories to \ncompare and also the full file name(including path as we support for javac \nincludes and excludes) patterns sets to compare.\n\nI have one written see if this code helps\n\nThis code does not compare the files with-in the jar files. We may think of \nsupporting this in the official ant task of DirDiff.\n\n\nimport org.apache.tools.ant.DirectoryScanner;\n\nimport java.io.File;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.List;\n\npublic final class DirDiff\n{\n    final DirectoryScanner masterDS;\n    final DirectoryScanner childDS;\n\n    public DirDiff( final DirectoryScanner aMasterDS,\n\t\t    final DirectoryScanner aChildDS )\n    {\n\tmasterDS = aMasterDS;\n\tchildDS = aChildDS;\n    }//constructor\n\n    public void diff()\n    {\n\tList exactMatchers = new ArrayList();\n\tList missingInChild = new ArrayList();\n\tList differsInChild = new ArrayList();\n\tList extraInChild = new ArrayList();\n\textraInChild.addAll( Arrays.asList( childDS.getIncludedFiles() ) );\n\n\tString[] masterFiles = masterDS.getIncludedFiles();\n\tfor ( int j = 0; j < masterFiles.length; j++ )\n\t{\n\t    File bMasterFile = new File( masterDS.getBasedir(), masterFiles\n[j] );\n\t    File bChildFile = new File( childDS.getBasedir(), masterFiles[j] );\n\t    if ( bMasterFile.exists() )\n\t    {\n\t\tif ( !bChildFile.exists() )\n\t\t{\n\t\t    missingInChild.add( masterFiles[j] + \"\\n\" );\n\t\t}\n\t\telse if ( bMasterFile.length() == bChildFile.length() )\n\t\t{\n\t\t    exactMatchers.add( masterFiles[j] + \"\\n\" );\n\t\t}\n\t\telse\n\t\t{\n\t\t    differsInChild.add(\n\t\t\t    masterFiles[j] + \"(\" + (bMasterFile.length() - \nbChildFile.length()) +\n\t\t\t    \")\\n\" );\n\t\t}\n\t\textraInChild.remove( masterFiles[j] );\n\t    }\n\t}\n\n\tSystem.out.println( \"\\n\\nmissing In Child:\" + missingInChild );\n\tSystem.out.println( \"\\n\\ndiffers In Child:\" + differsInChild );\n\tSystem.out.println( \"\\n\\nextra In Child:\" + extraInChild );\n\t//System.out.println( \"Exact Match files:\" + exactMatchers );\n    }\n\n    public static void main( String[] args )\n    {\n\tDirectoryScanner master = new DirectoryScanner();\n\tmaster.setBasedir( \"c:/temp\" );\n\tDirectoryScanner child = master;\n\tnew DirDiff( master, child ).diff();\n    }//main()\n}//class DirDiff", "bug_id": 29633, "attachment_id": null, "id": 59383, "time": "2004-06-17T08:08:13Z", "creator": "Nagendra.Raja@sun.com", "creation_time": "2004-06-17T08:08:13Z", "tags": [], "is_private": false}]