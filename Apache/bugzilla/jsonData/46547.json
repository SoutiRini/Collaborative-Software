[{"count": 0, "tags": [], "creator": "matthew.knl@gmail.com", "is_private": false, "text": "I use following code to execute shiftRows(...) method in HSSFSheet instance, it throws ClassCastException.\n\n--\n\nFileInputStream fis = new FileInputStream(\"9000000001.xls\");\nPOIFSFileSystem fs = new POIFSFileSystem(fis);\nWorkbook wb = new HSSFWorkbook(fs);\nSheet sheet = wb.getSheet(\"HouseShippingInstruction\");\nsheet.shiftRows(1, sheet.getLastRowNum(), 1, false, true);\n\n--\n\njava.lang.ClassCastException: org.apache.poi.hssf.record.aggregates.DataValidityTable cannot be cast to org.apache.poi.hssf.record.Record\n\tat org.apache.poi.hssf.model.RecordOrderer.findInsertPosForNewCondFormatTable(RecordOrderer.java:163)\n\tat org.apache.poi.hssf.model.RecordOrderer.findSheetInsertPos(RecordOrderer.java:102)\n\tat org.apache.poi.hssf.model.RecordOrderer.addNewSheetRecord(RecordOrderer.java:90)\n\tat org.apache.poi.hssf.model.Sheet.getConditionalFormattingTable(Sheet.java:493)\n\tat org.apache.poi.hssf.model.Sheet.updateFormulasAfterCellShift(Sheet.java:448)\n\tat org.apache.poi.hssf.usermodel.HSSFSheet.shiftRows(HSSFSheet.java:1238)\n\tat org.apache.poi.hssf.usermodel.HSSFSheet.shiftRows(HSSFSheet.java:1133)\n\n--\n\nThanks a lot!", "id": 124116, "time": "2009-01-16T00:30:23Z", "bug_id": 46547, "creation_time": "2009-01-16T00:30:23Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "matthew.knl@gmail.com", "attachment_id": 23131, "is_private": false, "id": 124117, "time": "2009-01-16T00:30:59Z", "bug_id": 46547, "creation_time": "2009-01-16T00:30:59Z", "text": "Created attachment 23131\nexcel file which causes the error."}, {"attachment_id": null, "tags": [], "bug_id": 46547, "is_private": false, "count": 2, "id": 124196, "time": "2009-01-19T17:57:18Z", "creator": "josh@apache.org", "creation_time": "2009-01-19T17:57:18Z", "text": "There are two bugs here.  \n\nThe first (little) one is that the ConditionalFormattingTable is being created while moving sheet rows even though it will remain empty.  A simple fix would be to check the field before calling the lazy getter in Sheet.updateFormulasAfterCellShift().\n\nThe second (more serious) bug is that POI cannot add conditional formatting to the supplied spreadsheet.  There is probably something a little unusual in ordering of BIFF records in this spreadsheet that RecordOrderer.java was not expecting."}, {"count": 3, "tags": [], "text": "Both bugs fixed in svn r736175.\n\nTestcases added.", "attachment_id": null, "bug_id": 46547, "id": 124212, "time": "2009-01-20T16:39:09Z", "creator": "josh@apache.org", "creation_time": "2009-01-20T16:39:09Z", "is_private": false}, {"count": 4, "tags": [], "creator": "josh@apache.org", "attachment_id": null, "is_private": false, "id": 125010, "time": "2009-02-19T19:56:46Z", "bug_id": 46547, "creation_time": "2009-02-19T19:56:46Z", "text": "*** Bug 46740 has been marked as a duplicate of this bug. ***"}, {"count": 5, "tags": [], "bug_id": 46547, "attachment_id": null, "id": 133165, "time": "2009-12-29T01:32:04Z", "creator": "liangyue_829@163.com", "creation_time": "2009-12-29T01:32:04Z", "is_private": false, "text": "Hi Josh,\n\nThis bug is also issued with POI 3.2. Can you or someone please fix this bug in POI 3.2 as well, or please give me some instruction how to fix it in POI 3.2 by modifying the source code.\n\nI have to use POI 3.2 since my project is working on JDK 1.4, but JDK 1.5 is the prerequisite to the POI 3.5.\n\nThanks for your time.\n-Lion Liang"}, {"attachment_id": 24770, "tags": [], "bug_id": 46547, "is_private": false, "count": 6, "id": 133182, "time": "2009-12-29T12:01:04Z", "creator": "josh@apache.org", "creation_time": "2009-12-29T12:01:04Z", "text": "Created attachment 24770\nsame bugfix rebased to 3.2 final\n\nYou'll have to build your own patched version of POI from the sources.  Source code for POI 3.2 can be found here:\nhttp://archive.apache.org/dist/poi/release/src/\n\nAssuming you unzipped the source to a folder called /poi-3.2-FINAL/, you can use patch like this:\n\npatch -p1 -i patch46547-rebasedTo703644.txt -d poi-3.2-FINAL\n\nAlternatively, you can do the patch by hand since the changes are very simple."}, {"attachment_id": null, "tags": [], "bug_id": 46547, "is_private": false, "count": 7, "id": 133183, "time": "2009-12-29T12:54:14Z", "creator": "josh@apache.org", "creation_time": "2009-12-29T12:54:14Z", "text": "You should be able to use the same technique to take any POI bug-fix and apply it to your local version.  However, keep in mind that there have been *many* bugs fixed since version 3.2 so this may not be a practical approach to keeping you up and running.\n\nAnother approach to consider involves converting the latest POI release to run on a 1.4 JRE.  There are tools that can do this. For example Retroweaver is a one that has been successfully used on other Apache projects."}, {"count": 8, "tags": [], "text": "Hi Josh,\n\nThanks very much for your instructions.\n\nshiftRows function works for me now in POI 3.2.\n\n- Lion Liang", "is_private": false, "id": 133193, "creator": "liangyue_829@163.com", "time": "2009-12-30T01:52:50Z", "bug_id": 46547, "creation_time": "2009-12-30T01:52:50Z", "attachment_id": null}, {"count": 9, "attachment_id": null, "creator": "josh@apache.org", "is_private": false, "id": 133236, "time": "2009-12-30T12:47:06Z", "bug_id": 46547, "creation_time": "2009-12-30T12:47:06Z", "tags": [], "text": "Changed to FIXED because this status applies to the original bug which was fixed during development of 3.5.  WORKSFORME actually means \"The details provided by the bug poster are insufficient to produce the alleged bug.\""}, {"count": 10, "tags": [], "bug_id": 46547, "attachment_id": null, "id": 133671, "time": "2010-01-17T21:27:41Z", "creator": "liangyue_829@163.com", "creation_time": "2010-01-17T21:27:41Z", "is_private": false, "text": "Hi Josh,\n\nThanks for your thorough help on this fix. Just wondering if I could request an official build of POI 3.2 to include this change? \n\nI could have this fixed locally and rebuild a version of POI 3.2, but I thought there was possibly some other users experienced with this issue and they would like to request a new 3.2 build not just fixed locally.\n\nThanks,\nLion Liang\n\n(In reply to comment #9)\n> Changed to FIXED because this status applies to the original bug which was\n> fixed during development of 3.5.  WORKSFORME actually means \"The details\n> provided by the bug poster are insufficient to produce the alleged bug.\""}]