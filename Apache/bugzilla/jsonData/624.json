[{"attachment_id": null, "tags": [], "bug_id": 624, "text": "The copy task uses org.apache.ant.tools.ant.Project.copyFile() which\ncontains a minor bug. It uses a BufferWriter or FileOutputStream and starts\ncopying the file contents, without removing the original file.\nIf the original file is a soft link (on Unix), it changes the contents of the \nfile that the soft link points to, which is not what you want IMHO.\nOne would expect the copy task to work more similar to the Unix 'cp' command\nwhich creates a new file (in essence wiping out the previous file.)\n\nTo fix this, add something like this before copying the contents:\n\n//--- Original code\n\n...\nif (parent.exists())\n{\n    parent.mkdirs();\n}\n\n//--- Start of insertion:\n\nFile dest = new File(destFile);\nif (dest.exists()) dest.delete();\n\n//---- End of insertion. Rest of original code:\n\nif (filtering) ...\n\n//--- etc.\n\nI'm not sure what should happen if the existing file is a directory.\nMy guess is you would want to delete it anyway, so I don't think you need\nto test for that.\n\nI was using Ant 1.2 on Solaris, but the problem concerns any platform that\nhas (soft) links.", "count": 0, "id": 715, "time": "2001-02-15T15:49:00Z", "creator": "ederksen@arrow.lz.att.com", "creation_time": "2001-02-15T15:49:00Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 624, "attachment_id": null, "is_private": false, "id": 3399, "time": "2001-07-04T07:40:34Z", "creator": "bodewig@apache.org", "creation_time": "2001-07-04T07:40:34Z", "text": "applied your proposed modification for nightly build 2001-07-05"}]