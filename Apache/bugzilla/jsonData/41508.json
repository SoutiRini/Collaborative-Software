[{"count": 0, "tags": [], "creator": "vtregner@csas.cz", "attachment_id": null, "id": 98831, "time": "2007-01-31T04:35:47Z", "bug_id": 41508, "creation_time": "2007-01-31T04:35:47Z", "is_private": false, "text": "Hello,\nwe are running on Weblogic 8.1 and using FOP for rendering report PDF's with\nimages. It works fine, but sometimes (till now 2x) it happens that all threads\nin  WLS are blocked at the same place - when rendering PDF and loading some\nimage. Threads never get awaked, restart of WLS is needed. I attach piece of\nthread dump. All threads have the same stacktrace as seen bellow.\nVasek Tregner\n\n\"ExecuteThread: '19' for queue: 'weblogic.kernel.Default'\" daemon prio=8\ntid=000b1980 nid=52 lwp_id=1404872 waiting on condition [0x12a89000\n..0x12a884f0]\n        at java.lang.Thread.sleep(Native Method)\n        at org.apache.fop.image.GifImage.loadImage(Unknown Source)\n        at org.apache.fop.image.AbstractFopImage.getBitmaps(Unknown Source)\n        at org.apache.fop.pdf.PDFXObject.output(Unknown Source)\n        at org.apache.fop.pdf.PDFDocument.output(Unknown Source)\n        at org.apache.fop.render.pdf.PDFRenderer.render(Unknown Source)\n        at org.apache.fop.apps.StreamRenderer.queuePage(Unknown Source)\n        - locked <4f570c80> (a org.apache.fop.apps.StreamRenderer)\n        at org.apache.fop.layout.AreaTree.addPage(Unknown Source)\n        at org.apache.fop.fo.pagination.PageSequence.format(Unknown Source)\n        at org.apache.fop.apps.StreamRenderer.render(Unknown Source)\n        at org.apache.fop.fo.FOTreeBuilder.endElement(Unknown Source)\n        at org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)\n        at\norg.apache.xerces.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown Source)\n        at\norg.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown\nSource)\n        at\norg.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)\n        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)\n        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\n        at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)\n        at org.apache.fop.apps.Driver.render(Unknown Source)\n        - locked <4f570fd8> (a org.apache.fop.apps.Driver)\n        at org.apache.fop.apps.Driver.run(Unknown Source)\n        - locked <4f570fd8> (a org.apache.fop.apps.Driver)\n        at cz.csas.cicnet.tapestry.services.PdfService.service(PdfService.java:75)"}, {"count": 1, "tags": [], "text": "Sorry, but we won't look into this bug. Since the code of GifImage didn't change\nmuch I'd assume it would resurface in your particular environment even if you\nupgraded to FOP 0.93. We're likely to soon drop support for JDK 1.3 which\nremoves the necessity to keep GifImage around in the first place, as image\nloading for GIF will be done through ImageIO. BTW, it would have been\ninteresting to know the maker and version of the JVM you're using.\n\nAnyway, I've got a possible work-around (no guarantees) for you if you\nabsolutely have to stay with FOP 0.20.4 which is by now 4 years old: Make JAI\navailable to FOP and change org/apache/fop/image/FopImageFactory by changing the\nfollowing code section:\n\n        if (\"image/gif\".equals(imgMimeType)) {\n            imgClassName = \"org.apache.fop.image.GifImage\";\n            // imgClassName = \"org.apache.fop.image.JAIImage\";\n\nComment the line with \"GifImage\" and uncomment the line below. Recompile FOP\nfrom the sources and FOP will attempt to load GIF images through JAI.\n\nUpgrading to FOP 0.20.5 won't help in this case as the code is pretty much the\nsame. You could also try to use a different JVM in your environment as I don't\nthink this is just a FOP bug. After all, a lot of people used GIF images with\nFOP 0.20.4 and 0.20.5 and it worked for them.\n\nIf you can upgrade to FOP 0.93 that particular problem would go away anyway but\nyou have to do a migration which may be more work for you.\n\nGood luck!", "is_private": false, "id": 98845, "creator": "jeremias@apache.org", "time": "2007-01-31T11:17:06Z", "bug_id": 41508, "creation_time": "2007-01-31T11:17:06Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 41508, "attachment_id": null, "is_private": false, "id": 156431, "time": "2012-04-01T13:48:00Z", "creator": "gadams@apache.org", "creation_time": "2012-04-01T13:48:00Z", "text": "batch transition to closed remaining pre-FOP1.0 resolved bugs"}]