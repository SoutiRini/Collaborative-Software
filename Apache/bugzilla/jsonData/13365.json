[{"count": 0, "tags": [], "bug_id": 13365, "is_private": false, "text": "The fix for the JSP source disclosure security hole is incomplete.  Currently, \nit rejects servlet names starting with org.apache.catalina, but this solution \nfails to take into account the fact that servlets can be invoked by their name, \nand not just their class name.  To see an example of this, on a stock 4.1.12 \ninstallation, uncomment the invoker servlet mapping in the default web.xml and \ngo to this URL:\n\nhttp://localhost:8080/examples/servlet/default/jsp/snp/snoop.jsp\n\nThe important part is the \"/servlet/default\" fragment, which will bypass the \nnew security checks and invoke the default servlet.\n\nAlthough this is less of a problem than the one discovered originally (since \nthe servlet mapping is commented out by default) I believe that a lot of people \nusing Tomcat are relying on the invoker servlet, and so uncommented the mapping \nin their 4.0.5 and 4.1.12 installations.  Therefore there's reason to believe \nthat there are still a large number of vulnerable servers out there.\n\nI haven't tested this on 4.0.5, but I'm assuming that it's also vulnerable.", "id": 24073, "time": "2002-10-07T16:05:17Z", "creator": "tmoore@blackboard.com", "creation_time": "2002-10-07T16:05:17Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 13365, "is_private": false, "id": 24080, "attachment_id": null, "creator": "super-creek@jcom.home.ne.jp", "creation_time": "2002-10-07T16:41:45Z", "time": "2002-10-07T16:41:45Z", "text": "For examples, by applying the following patch, is this bug fixed ???\n\nIndex: jakarta-tomcat-4.0/catalina/src/conf/web.xml\n===================================================================\nRCS file: /home/cvspublic/jakarta-tomcat-4.0/catalina/src/conf/web.xml,v\nretrieving revision 1.44\ndiff -u -w -r1.44 web.xml\n--- jakarta-tomcat-4.0/catalina/src/conf/web.xml\t21 Sep 2002 16:23:28 -\n0000\t1.44\n+++ jakarta-tomcat-4.0/catalina/src/conf/web.xml\t7 Oct 2002 16:21:49 -\n0000\n@@ -41,7 +41,7 @@\n   <!--                       rejected?  [true]                              -->\n \n     <servlet>\n-        <servlet-name>default</servlet-name>\n+        <servlet-name>org.apache.catalina.servlets.DefaultServlet</servlet-\nname>\n         <servlet-class>\n           org.apache.catalina.servlets.DefaultServlet\n         </servlet-class>\n@@ -265,7 +265,7 @@\n \n     <!-- The mapping for the default servlet -->\n     <servlet-mapping>\n-        <servlet-name>default</servlet-name>\n+        <servlet-name>org.apache.catalina.servlets.DefaultServlet</servlet-\nname>\n         <url-pattern>/</url-pattern>\n     </servlet-mapping>\n \n\n# I individually think that a fundamental means to solve this problem is\n# to abolish or remove Invoker itself.\n"}, {"count": 2, "tags": [], "bug_id": 13365, "text": "Ok, this is fixed in all branches, and Tomcat 4.0.6 has been released (the\ndefault Tomcat 4.0.5 installation was vulnerable).\n\nHowever, NEVER EVER DISCUSS A POTENTIAL SECURITY PROBLEM ON A PUBLIC\nCOMMUNICATION CHANNEL, because this puts all Tomcat users at risk. The Tomcat\nTeam also cannot release a new version within minutes a security problem is\npublished. Thanks. There are *private* mailing lists for that (security at\napache.org), and you will be given all the credit you want or deserve.\n\nI used the patch submitted as a patch which can be applied to Tomcat 4.0.5 to\nresolve the problem without upgrading to 4.0.6.", "id": 24205, "time": "2002-10-09T14:23:40Z", "creator": "remm@apache.org", "creation_time": "2002-10-09T14:23:40Z", "is_private": false, "attachment_id": null}]