[{"count": 0, "attachment_id": null, "bug_id": 58437, "is_private": false, "id": 185388, "time": "2015-09-21T16:28:43Z", "creator": "javier.gusano@hpe.com", "creation_time": "2015-09-21T16:28:43Z", "tags": [], "text": "I have downloaded the latest version of Apache 2.5-DEV from its repository. Next, I have installed and compiled this version using the following script (developed by me):\nhttps://github.com/jgm1986/Apache_mod_h2/blob/master/apache.sh\n\nOn Apache \"httpd.conf\" file, I have uncommented the following module line:\nLoadModule h2_module modules/mod_h2.so\n\nAnd I have added these lines to my virtual host file:\n    Protocols h2c http/1.1\n    ProtocolsHonorOrder on\n\nI have tested this Apache configuration using nghttp2 client (on localhost). The most interesting is that I can use h2c on \"direct mode\" (this mode is only for development purposes).\nThe problem occurs when I try to use HTTP/2 on clear mode (h2c) using \"upgrade\" from HTTP/1.1. Apache continues using HTTP/1.1. These lines are the NGHTTP2 output:\n---------------------------------------------------------------------------\nsrc/nghttp -uvs http://127.0.0.1:80\n[  0.000] Connected\n[  0.000] HTTP Upgrade request\nGET / HTTP/1.1\nHost: 127.0.0.1\nConnection: Upgrade, HTTP2-Settings\nUpgrade: h2c\nHTTP2-Settings: AAMAAABkAAQAAP__\nAccept: */*\nUser-Agent: nghttp2/1.3.2\n\n\n[  0.001] HTTP Upgrade response\nHTTP/1.1 200 OK\n---------------------------------------------------------------------------\n\nCan someone help me to check if it could be an Apache 2.5-DEV bug?\nThanks.\n\nPS: My computer uses:\nLinux 3.16.0-49-generic #65~14.04.1-Ubuntu SMP Wed Sep 9 10:03:23 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux"}, {"count": 1, "tags": [], "bug_id": 58437, "attachment_id": null, "text": "Not sure to follow here.\nThe request is HTTP/1.1, and so is to be the response.\nThat's after the connection is upgraded that HTTP/2.0 starts, Am I missing something?", "id": 185390, "time": "2015-09-21T18:47:08Z", "creator": "ylavic.dev@gmail.com", "creation_time": "2015-09-21T18:47:08Z", "is_private": false}, {"count": 2, "attachment_id": null, "creator": "javier.gusano@hpe.com", "is_private": false, "id": 185416, "time": "2015-09-22T08:20:30Z", "bug_id": 58437, "creation_time": "2015-09-22T08:20:30Z", "tags": [], "text": "(In reply to Yann Ylavic from comment #1)\n> Not sure to follow here.\n> The request is HTTP/1.1, and so is to be the response.\n> That's after the connection is upgraded that HTTP/2.0 starts, Am I missing\n> something?\n\nThanks for your answer. Probably I have not explained myself clearly... sorry. I'm trying to make this situation: https://tools.ietf.org/html/rfc7540#section-3.2\n\n     http/1.1 ---> (upgrade h2c) ---> http/2\n\nThe response from Apache should be the following:\n\n     HTTP/1.1 101 Switching Protocols\n     Connection: Upgrade\n     Upgrade: h2c\n\n     [ HTTP/2 connection ...\n\nAt the moment, Apache only sends me the following response:\n\n     [  0.001] HTTP Upgrade response\n     HTTP/1.1 200 OK\n\nIt means that Apache does not support HTTP/2 on Clear Text (h2c). Then I'm not sure if I'm doing something wrong during my Apache installation/configuration or if it could be a bug.\n\nIn reference to the support ticket place, I think that this is the correct place to put this post. According to Apache docummentation, \"mod_h2\" is a new Apache module for HTTP/2 support.\nhttp://httpd.apache.org/docs/trunk/mod/mod_h2.html \nThen if you think that this post should not be here, please, show me the correct place to publish it. Thanks!"}, {"count": 3, "attachment_id": null, "creator": "ylavic.dev@gmail.com", "text": "Oups, sorry for the noise.\n\nIs nghttp2 installed too (--with-nghttp2)?\nCan you please attach your config.log file?", "id": 185419, "time": "2015-09-22T09:29:21Z", "bug_id": 58437, "creation_time": "2015-09-22T09:29:21Z", "tags": [], "is_private": false}, {"count": 4, "attachment_id": 33131, "bug_id": 58437, "is_private": false, "id": 185420, "time": "2015-09-22T09:40:26Z", "creator": "javier.gusano@hpe.com", "creation_time": "2015-09-22T09:40:26Z", "tags": [], "text": "Created attachment 33131\nApache config.log."}, {"count": 5, "tags": [], "bug_id": 58437, "text": "(In reply to Yann Ylavic from comment #3)\n> Oups, sorry for the noise.\n> \n> Is nghttp2 installed too (--with-nghttp2)?\n> Can you please attach your config.log file?\n\nNo problem! ;) I have attached the config.log file to this message. Thanks for your help!", "id": 185421, "time": "2015-09-22T09:41:01Z", "creator": "javier.gusano@hpe.com", "creation_time": "2015-09-22T09:41:01Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "creator": "ylavic.dev@gmail.com", "attachment_id": null, "text": "Can you try with \"--enable-http2\" for configure and \"LoadModule http2_module modules/mod_http2.so\" for httpd.conf?", "id": 185422, "time": "2015-09-22T09:51:42Z", "bug_id": 58437, "creation_time": "2015-09-22T09:51:42Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 58437, "attachment_id": null, "text": "H2Direct is on for cleartext, this is not a developer mode, see rfc 7540 Section 3.4. As H2Direct needs to be checked *before* the first request is seen, it does only work in servers, not vhosts on cleartext. Documentation/checks need to be added.\n\nSomething must prevent the Upgrade from happening on your site, maybe a bug triggered by your config? I see the Upgrade performed on my test server from httpd/trunk.", "id": 185423, "time": "2015-09-22T09:59:41Z", "creator": "stefan@eissing.org", "creation_time": "2015-09-22T09:59:41Z", "is_private": false}, {"count": 8, "attachment_id": null, "bug_id": 58437, "is_private": false, "id": 185426, "time": "2015-09-22T11:26:22Z", "creator": "javier.gusano@hpe.com", "creation_time": "2015-09-22T11:26:22Z", "tags": [], "text": "(In reply to Yann Ylavic from comment #6)\n> Can you try with \"--enable-http2\" for configure and \"LoadModule http2_module\n> modules/mod_http2.so\" for httpd.conf?\n\nI have compiled and installed using \"--enable-http2\" on ./configure. I have modified it on my Apache installation script: https://github.com/jgm1986/Apache_mod_h2/blob/master/apache.sh\n\nThe changes on Apache httpd.conf file that you mentioned: \"LoadModule http2_module modules/mod_http2.so\" isn't correct. The correct line should be the following:\n\"LoadModule h2_module modules/mod_h2.so\"\n\nThe module with \"mod_http2.so\" name does't exists (at least I can't found it...). Thanks for your help!\n\nPS: Now I'll write Stefan in a new response ;)"}, {"count": 9, "tags": [], "bug_id": 58437, "text": "(In reply to Stefan Eissing from comment #7)\n> H2Direct is on for cleartext, this is not a developer mode, see rfc 7540\n> Section 3.4. As H2Direct needs to be checked *before* the first request is\n> seen, it does only work in servers, not vhosts on cleartext.\n> Documentation/checks need to be added.\n> \n> Something must prevent the Upgrade from happening on your site, maybe a bug\n> triggered by your config? I see the Upgrade performed on my test server from\n> httpd/trunk.\n\nHi Stefan! Yes, you're right, the h2c direct is on rfc... I was wrong... I have changed the \"httpd.conf\" according your indications. Now the \"H2Direct on\" is on it! and the \"httpd-vhosts.conf\" contains:\n<VirtualHost *:80>\n...\n    Protocols h2c http/1.1\n    ProtocolsHonorOrder on\n    H2AltSvc h2=:443\n</VirtualHost>\n\n<VirtualHost *:443>\n...\n    Protocols h2c http/1.1\n    ProtocolsHonorOrder on\n    H2AltSvc h2c=:80\n</VirtualHost>\n\nI can confirm you that now HTTP/2 Cleart text is working correctly on port 80 (upgrade and direct mode). One more time, thanks you Stefan!\n\nBut..., the HTTP/2 over port 443 doesn't works... Maybe I forgot enable or install some plugin... could you check if the directives for the virtualhost on port 443 are correct for HTTP/2 (h2)? Thanks!", "id": 185428, "time": "2015-09-22T11:38:10Z", "creator": "javier.gusano@hpe.com", "creation_time": "2015-09-22T11:38:10Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 58437, "attachment_id": null, "text": "I'm sorry, I mean: \n\n<VirtualHost *:443>\n...\n    Protocols h2 http/1.1\n    ProtocolsHonorOrder on\n    H2AltSvc h2c=:80\n</VirtualHost>\n\nCheers,", "id": 185429, "time": "2015-09-22T11:40:01Z", "creator": "javier.gusano@hpe.com", "creation_time": "2015-09-22T11:40:01Z", "is_private": false}, {"count": 11, "tags": [], "bug_id": 58437, "text": "Was just about to tell you that \"h2\" is needed for TLS connections.\n\nLooks good. One reason that TLS negotiation of HTTP/2 might not work is that ALPN support is missing in the linked openssl. In doubt, set\n\n  LogLevel ssl:debug\n  LogLevel core:debug\n\nand try a TLS connection. The log should give some information if ALPN was triggered and what protocol was negotiated.", "id": 185430, "attachment_id": null, "creator": "stefan@eissing.org", "creation_time": "2015-09-22T11:43:47Z", "time": "2015-09-22T11:43:47Z", "is_private": false}, {"count": 12, "tags": [], "creator": "javier.gusano@hpe.com", "is_private": false, "text": "(In reply to Stefan Eissing from comment #11)\n> Was just about to tell you that \"h2\" is needed for TLS connections.\n> \n> Looks good. One reason that TLS negotiation of HTTP/2 might not work is that\n> ALPN support is missing in the linked openssl. In doubt, set\n> \n>   LogLevel ssl:debug\n>   LogLevel core:debug\n> \n> and try a TLS connection. The log should give some information if ALPN was\n> triggered and what protocol was negotiated.\n\nIt seems that ALPN is not enabled... There are any tutorial about how I can enable it?", "id": 185431, "time": "2015-09-22T11:59:12Z", "bug_id": 58437, "creation_time": "2015-09-22T11:59:12Z", "attachment_id": null}, {"count": 13, "tags": [], "creator": "ylavic.dev@gmail.com", "text": "Maybe I can try a correct answer here :p\n\n(In reply to Javier Gusano Martinez from comment #12)\n> \n> It seems that ALPN is not enabled... There are any tutorial about how I can\n> enable it?\n\nOpenSSL > 1.0.2(a) is required.", "id": 185432, "time": "2015-09-22T12:07:38Z", "bug_id": 58437, "creation_time": "2015-09-22T12:07:38Z", "is_private": false, "attachment_id": null}, {"count": 14, "tags": [], "bug_id": 58437, "attachment_id": null, "is_private": false, "id": 185433, "time": "2015-09-22T12:44:43Z", "creator": "javier.gusano@hpe.com", "creation_time": "2015-09-22T12:44:43Z", "text": "(In reply to Yann Ylavic from comment #13)\n> Maybe I can try a correct answer here :p\n> \n> (In reply to Javier Gusano Martinez from comment #12)\n> > \n> > It seems that ALPN is not enabled... There are any tutorial about how I can\n> > enable it?\n> \n> OpenSSL > 1.0.2(a) is required.\n\nOK, thanks! I have uninstalled openssl 1.0.1 from my system. Next, I have downloaded and installed openssl on /usr directory: OpenSSL 1.0.2d 9 Jul 2015\nI used the following commands:\n   wget https://www.openssl.org/source/openssl-1.0.2d.tar.gz\n   tar xfv openssl-1.0.2d.tar.gz\n   cd openssl-1.0.2d/\n   sudo aptitude remove openssl libssl-dev\n   ./config --prefix=/usr\n   make\n   make test\n   sudo make install\n\nNow I suppose that Apache should be recompile and install using the following parameters. Isn't it?:\n   ./configure --with-included-apr --prefix=/home/sysadmin/apache2.5 --enable-ssl --enable-so --enable-h2 --enable-http2 --with-nghttp2=/home/sysadmin/Apache_mod_h2/downloads/nghttp2-1.3.2/lib/.libs/libnghttp2.so.14"}, {"count": 15, "tags": [], "bug_id": 58437, "attachment_id": null, "text": "What I use is something like:\n\n./configure --prefix=/opt/apache-trunk --enable-mpms-shared=all --with-included-apr --with-crypto --enable-ssl --enable-maintainer-mode --with-ssl=/opt/apache-trunk --enable-h2 --with-nghttp2=/opt/apache-trunk/\n\nwhich for you might translate to\n\n./configure --prefix=/opt/apache-trunk  --enable-mpms-shared=all --with-crypto --enable-ssl --with-ssl=/usr --enable-h2 --with-nghttp2=/home/sysadmin/Apache_mod_h2/downloads/nghttp2-1.3.2/lib/.libs/libnghttp2.so.14\n\nOf course, you might not need the enable-moms-shared=all if you know what you want.", "id": 185434, "time": "2015-09-22T12:50:33Z", "creator": "stefan@eissing.org", "creation_time": "2015-09-22T12:50:33Z", "is_private": false}, {"count": 16, "tags": [], "bug_id": 58437, "attachment_id": null, "text": "(In reply to Stefan Eissing from comment #15)\n> What I use is something like:\n> \n> ./configure --prefix=/opt/apache-trunk --enable-mpms-shared=all\n> --with-included-apr --with-crypto --enable-ssl --enable-maintainer-mode\n> --with-ssl=/opt/apache-trunk --enable-h2 --with-nghttp2=/opt/apache-trunk/\n> \n> which for you might translate to\n> \n> ./configure --prefix=/opt/apache-trunk  --enable-mpms-shared=all\n> --with-crypto --enable-ssl --with-ssl=/usr --enable-h2\n> --with-nghttp2=/home/sysadmin/Apache_mod_h2/downloads/nghttp2-1.3.2/lib/.\n> libs/libnghttp2.so.14\n> \n> Of course, you might not need the enable-moms-shared=all if you know what\n> you want.\n\nI think that I have followed your instructions but It doesn't works for me... I have published on the installation repository (https://github.com/jgm1986/Apache_mod_h2) the steps for the installation (inside apache.sh script file).\n\nOn the other hand, I have published the following two Apache config files:\n- httpd.conf\n- httpd-vhosts.conf\n\nThis is the cURL output:\n\n$ curl --http2 -v https://127.0.0.1:443\n* Rebuilt URL to: https://127.0.0.1:443/\n*   Trying 127.0.0.1...\n* Connected to 127.0.0.1 (127.0.0.1) port 443 (#0)\n* Cipher selection: ALL:!EXPORT:!EXPORT40:!EXPORT56:!aNULL:!LOW:!RC4:@STRENGTH\n* successfully set certificate verify locations:\n*   CAfile: /etc/ssl/certs/ca-certificates.crt\n  CApath: none\n* TLSv1.2 (OUT), TLS handshake, Client hello (1):\n* TLSv1.2 (IN), TLS handshake, Server hello (2):\n* TLSv1.2 (IN), TLS handshake, Certificate (11):\n* TLSv1.2 (IN), TLS handshake, Server key exchange (12):\n* TLSv1.2 (IN), TLS handshake, Server finished (14):\n* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):\n* TLSv1.2 (OUT), TLS change cipher, Client hello (1):\n* TLSv1.2 (OUT), TLS handshake, Finished (20):\n* TLSv1.2 (IN), TLS change cipher, Client hello (1):\n* TLSv1.2 (IN), TLS handshake, Finished (20):\n* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256\n* Server certificate:\n*        subject: C=ES; ST=Madrid; L=Madrid; O=Telefonica Investigacion y Desarrollo; CN=*.bluevia.com\n*        start date: 2014-10-06 00:00:00 GMT\n*        expire date: 2016-01-05 23:59:59 GMT\n* SSL: certificate subject name '*.bluevia.com' does not match target host name '127.0.0.1'\n* Closing connection 0\n* TLSv1.2 (OUT), TLS alert, Client hello (1):\n\nAs you can see, ALPN is not present... -_-' Thanks for your help!", "id": 185439, "time": "2015-09-22T14:57:33Z", "creator": "javier.gusano@hpe.com", "creation_time": "2015-09-22T14:57:33Z", "is_private": false}, {"count": 17, "tags": [], "bug_id": 58437, "attachment_id": null, "is_private": false, "id": 185440, "time": "2015-09-22T15:03:59Z", "creator": "stefan@eissing.org", "creation_time": "2015-09-22T15:03:59Z", "text": "What does \n\n> curl -V\n\nsay? It should list the openssl version."}, {"count": 18, "attachment_id": null, "creator": "javier.gusano@hpe.com", "is_private": false, "id": 185441, "time": "2015-09-22T15:13:09Z", "bug_id": 58437, "creation_time": "2015-09-22T15:13:09Z", "tags": [], "text": "\"curl -V\" is used for \"verbose\" cURL mode. I only can see the supported ciphers but nothing shows NPN or ALPN. I don't know if my answer resolve your question."}, {"count": 19, "tags": [], "bug_id": 58437, "is_private": false, "text": "Capital 'V' is for Version.\nYour system's curl is probably compiled with your (now removed) system's openssl.", "id": 185442, "time": "2015-09-22T15:25:59Z", "creator": "ylavic.dev@gmail.com", "creation_time": "2015-09-22T15:25:59Z", "attachment_id": null}, {"count": 20, "attachment_id": null, "creator": "javier.gusano@hpe.com", "is_private": false, "id": 185443, "time": "2015-09-22T17:17:13Z", "bug_id": 58437, "creation_time": "2015-09-22T17:17:13Z", "tags": [], "text": "(In reply to Yann Ylavic from comment #19)\n> Capital 'V' is for Version.\n> Your system's curl is probably compiled with your (now removed) system's\n> openssl.\n\nI have tried to download and install cURL with the last version of OpenSSL, but unfortunately.... it continues using 1.0.1.f. Maybe the problem is that my Apache installation is using this old version of OpenSSL.\n\ncurl 7.44.0 (x86_64-unknown-linux-gnu) libcurl/7.44.0 OpenSSL/1.0.1f zlib/1.2.8 libssh2/1.4.3 nghttp2/1.3.2\nProtocols: dict file ftp ftps gopher http https imap imaps ldap ldaps pop3 pop3s rtsp scp sftp smb smbs smtp smtps telnet tftp\nFeatures: IPv6 Largefile NTLM NTLM_WB SSL libz TLS-SRP HTTP2 UnixSockets\n\nI'm triying to install Apache but using this option on ./configure:\n --with-ssl=/usr/local/ssl\n\nI'll tell you if it works..."}, {"count": 21, "tags": [], "bug_id": 58437, "text": "IMHO, you shouldn't replace your system's libs like this, and may want to set/export LD_LIBRARY_PATH=\"/path/to/openssl-1.0.2-or-more/lib\" at runtime for httpd and curl, or alternatively use \"configure 'LDFLAGS=-Wl,-rpath,/path/to/openssl-1.0.2-or-more/lib' ...\" at build time (with gcc/elf) for both too.", "id": 185447, "time": "2015-09-22T20:14:44Z", "creator": "ylavic.dev@gmail.com", "creation_time": "2015-09-22T20:14:44Z", "is_private": false, "attachment_id": null}, {"count": 22, "tags": [], "creator": "javier.gusano@hpe.com", "is_private": false, "text": "(In reply to Yann Ylavic from comment #19)\n> Capital 'V' is for Version.\n> Your system's curl is probably compiled with your (now removed) system's\n> openssl.\n\nNow it looks that cURL is using right version of Openssl 1.0.2:\n\n$ curl -V\ncurl 7.44.0 (x86_64-unknown-linux-gnu) libcurl/7.44.0 OpenSSL/1.0.2d zlib/1.2.8 nghttp2/1.3.2\nProtocols: dict file ftp ftps gopher http https imap imaps pop3 pop3s rtsp smb smbs smtp smtps telnet tftp\nFeatures: IPv6 Largefile NTLM NTLM_WB SSL libz TLS-SRP HTTP2 UnixSockets\n\n\nBut Apache continues without http2 suport when I use https://\n\n\ncurl -v --http2 https://localhost:443\n* Rebuilt URL to: https://localhost:443/\n*   Trying 127.0.0.1...\n* Connected to localhost (127.0.0.1) port 443 (#0)\n* Cipher selection: ALL:!EXPORT:!EXPORT40:!EXPORT56:!aNULL:!LOW:!RC4:@STRENGTH\n* successfully set certificate verify locations:\n*   CAfile: /etc/ssl/certs/ca-certificates.crt\n  CApath: none\n* TLSv1.2 (OUT), TLS Unknown, Certificate Status (22):\n* TLSv1.2 (OUT), TLS handshake, Client hello (1):\n* TLSv1.2 (IN), TLS handshake, Server hello (2):\n* TLSv1.2 (IN), TLS handshake, Certificate (11):\n* TLSv1.2 (IN), TLS handshake, Server key exchange (12):\n* TLSv1.2 (IN), TLS handshake, Server finished (14):\n* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):\n* TLSv1.2 (OUT), TLS change cipher, Client hello (1):\n* TLSv1.2 (OUT), TLS handshake, Finished (20):\n* TLSv1.2 (IN), TLS change cipher, Client hello (1):\n* TLSv1.2 (IN), TLS handshake, Finished (20):\n* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256\n* Server certificate:\n*        subject: C=ES; ST=Madrid; L=Madrid; O=Telefonica Investigacion y Desarrollo; CN=*.bluevia.com\n*        start date: 2014-10-06 00:00:00 GMT\n*        expire date: 2016-01-05 23:59:59 GMT\n*        subjectAltName does not match localhost\n* SSL: no alternative certificate subject name matches target host name 'localhost'\n* Closing connection 0\n* TLSv1.2 (OUT), TLS alert, Client hello (1):\ncurl: (51) SSL: no alternative certificate subject name matches target host name 'localhost'\n\n\nSome idea about what's happening here? :S", "id": 185559, "time": "2015-09-30T11:40:41Z", "bug_id": 58437, "creation_time": "2015-09-30T11:40:41Z", "attachment_id": null}, {"count": 23, "tags": [], "bug_id": 58437, "attachment_id": null, "text": "(In reply to Stefan Eissing from comment #11)\n> Was just about to tell you that \"h2\" is needed for TLS connections.\n> \n> Looks good. One reason that TLS negotiation of HTTP/2 might not work is that\n> ALPN support is missing in the linked openssl. In doubt, set\n> \n>   LogLevel ssl:debug\n>   LogLevel core:debug\n> \n> and try a TLS connection. The log should give some information if ALPN was\n> triggered and what protocol was negotiated.\n\nHi Stefan\n\nNow Apache is using OpenSSL 1.0.2d:\n\ncurl -v --http2 http://localhost\n* Rebuilt URL to: http://localhost/\n*   Trying 127.0.0.1...\n* Connected to localhost (127.0.0.1) port 80 (#0)\n> GET / HTTP/1.1\n> Host: localhost\n> User-Agent: curl/7.44.0\n> Accept: */*\n> Connection: Upgrade, HTTP2-Settings\n> Upgrade: h2c\n> HTTP2-Settings: AAMAAABkAAQAAP__\n>\n< HTTP/1.1 101 Switching Protocols\n< Upgrade: h2c\n< Connection: Upgrade\n* Received 101\n* Using HTTP2, server supports multi-use\n* Connection state changed (HTTP/2 confirmed)\n* Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=27\n* http2_recv: 16384 bytes buffer at 0xeb0cf0 (stream 1)\n* http2_recv: returns 289 for stream 1\n< HTTP/2.0 200\n< date:Wed, 30 Sep 2015 11:45:30 GMT\n< server:Apache/2.5.0-dev (Unix) OpenSSL/1.0.2d PHP/5.6.13\n< last-modified:Wed, 30 Sep 2015 10:02:27 GMT\n< etag:\"2d-520f4071f7f05\"\n< accept-ranges:bytes\n< content-length:45\n< content-type:text/html\n\n\nBut continues without HTTP2 support when I use https://\n\nInside error log file I have found this:\n\n[Wed Sep 30 10:16:32.942716 2015] [mpm_event:notice] [pid 14226:tid 140086991066944] AH00489: Apache/2.5.0-dev (Unix) PHP/5.6.13 configured -- resuming normal operations\n[Wed Sep 30 10:16:32.942779 2015] [core:notice] [pid 14226:tid 140086991066944] AH00094: Command line: '/home/sysadmin/apache2.5/bin/httpd'\n[Wed Sep 30 10:24:27.603303 2015] [mpm_event:notice] [pid 14226:tid 140086991066944] AH00494: SIGHUP received.  Attempting to restart\nAH00534: httpd: Configuration error: The MPM cannot be changed during restart.\n[Wed Sep 30 10:25:27.885133 2015] [ssl:warn] [pid 14497] AH01873: Init: Session Cache is not configured [hint: SSLSessionCache]\n[Wed Sep 30 10:25:27.889499 2015] [core:warn] [pid 14497] AH00098: pid file /home/sysadmin/apache2.5/logs/httpd.pid overwritten -- Unclean shutdown of previous Apache run?\n[Wed Sep 30 10:25:27.890866 2015] [mpm_prefork:notice] [pid 14497] AH00163: Apache/2.5.0-dev (Unix) OpenSSL/1.0.1f PHP/5.6.13 configured -- resuming normal operations\n[Wed Sep 30 10:25:27.890900 2015] [core:notice] [pid 14497] AH00094: Command line: '/home/sysadmin/apache2.5/bin/httpd'\n[Wed Sep 30 10:32:06.312202 2015] [mpm_prefork:notice] [pid 14497] AH00169: caught SIGTERM, shutting down\n[Wed Sep 30 11:22:14.503739 2015] [ssl:warn] [pid 26718] AH01873: Init: Session Cache is not configured [hint: SSLSessionCache]\n[Wed Sep 30 11:22:14.508693 2015] [mpm_prefork:notice] [pid 26718] AH00163: Apache/2.5.0-dev (Unix) OpenSSL/1.0.2d PHP/5.6.13 configured -- resuming normal operations\n[Wed Sep 30 11:22:14.508727 2015] [core:notice] [pid 26718] AH00094: Command line: '/home/sysadmin/apache2.5/bin/httpd'\n[Wed Sep 30 11:31:42.169607 2015] [mpm_prefork:notice] [pid 26718] AH00169: caught SIGTERM, shutting down\n[Wed Sep 30 11:35:09.698121 2015] [ssl:warn] [pid 11518] AH01873: Init: Session Cache is not configured [hint: SSLSessionCache]\n[Wed Sep 30 11:35:09.704063 2015] [mpm_prefork:notice] [pid 11518] AH00163: Apache/2.5.0-dev (Unix) OpenSSL/1.0.2d PHP/5.6.13 configured -- resuming normal operations\n[Wed Sep 30 11:35:09.704096 2015] [core:notice] [pid 11518] AH00094: Command line: '/home/sysadmin/apache2.5/bin/httpd'\n[Wed Sep 30 11:44:32.406140 2015] [mpm_prefork:notice] [pid 11518] AH00173: SIGHUP received.  Attempting to restart\n[Wed Sep 30 11:44:32.417233 2015] [ssl:warn] [pid 11518] AH01873: Init: Session Cache is not configured [hint: SSLSessionCache]\n[Wed Sep 30 11:44:32.417248 2015] [ssl:info] [pid 11518] AH01887: Init: Initializing (virtual) servers for SSL\n[Wed Sep 30 11:44:32.418064 2015] [ssl:info] [pid 11518] AH01876: mod_ssl/2.5.0-dev compiled against Server: Apache/2.5.0-dev, Library: OpenSSL/1.0.1f\n[Wed Sep 30 11:44:32.422386 2015] [mpm_prefork:notice] [pid 11518] AH00163: Apache/2.5.0-dev (Unix) OpenSSL/1.0.2d PHP/5.6.13 configured -- resuming normal operations\n[Wed Sep 30 11:44:32.422406 2015] [core:notice] [pid 11518] AH00094: Command line: '/home/sysadmin/apache2.5/bin/httpd'\n[Wed Sep 30 11:44:32.422410 2015] [core:debug] [pid 11518] log.c(1497): AH02639: Using SO_REUSEPORT: yes (1)\n\n\nIt looks that Apache is using OpenSSL 1.0.1f library... I don't understand why...", "id": 185560, "time": "2015-09-30T11:57:28Z", "creator": "javier.gusano@hpe.com", "creation_time": "2015-09-30T11:57:28Z", "is_private": false}, {"count": 24, "tags": [], "creator": "javier.gusano@hpe.com", "text": "Finally I have fixed the problems! Thanks Stefan & Yann for your help. The solution to this problem is inside this script:\n\nhttps://github.com/jgm1986/Apache_mod_h2/blob/master/apache.sh\n\nMaybe it could be helpfull for someone in a future.\n\nCheers,\n\nJavier Gusano Mart\u00ednez", "id": 185572, "time": "2015-10-01T07:27:12Z", "bug_id": 58437, "creation_time": "2015-10-01T07:27:12Z", "is_private": false, "attachment_id": null}, {"count": 25, "tags": [], "creator": "7raivis@inbox.lv", "attachment_id": null, "text": "Why not to land it in version 2.4.x ?\nStill not supported in httpd 2.4.18.", "id": 187121, "time": "2015-12-24T21:17:40Z", "bug_id": 58437, "creation_time": "2015-12-24T21:17:40Z", "is_private": false}, {"count": 26, "tags": [], "bug_id": 58437, "attachment_id": null, "text": "It doesn't work on httpd 2.4.18.\nAnd https://github.com/apache/httpd there aren't such a branch as 2.5.", "id": 188553, "time": "2016-02-18T06:37:15Z", "creator": "7raivis@inbox.lv", "creation_time": "2016-02-18T06:37:15Z", "is_private": false}, {"count": 27, "tags": [], "bug_id": 58437, "attachment_id": null, "text": "(In reply to Binyamin from comment #26)\n> It doesn't work on httpd 2.4.18.\n> And https://github.com/apache/httpd there aren't such a branch as 2.5.\n\nI use the Apache 2.5 version only for testing prupose. The 2.5 is de develop brunch. You can get it using SVN:\n\nsvn checkout http://svn.apache.org/repos/asf/httpd/httpd/trunk httpd-trunk", "id": 188558, "time": "2016-02-18T08:05:47Z", "creator": "javier.gusano@hpe.com", "creation_time": "2016-02-18T08:05:47Z", "is_private": false}, {"count": 28, "tags": [], "bug_id": 58437, "text": "Javier, why not to land this fix in 2.4.X?\nI expect httpd 2.5 even doesn't have ETA.", "id": 188560, "attachment_id": null, "creator": "7raivis@inbox.lv", "creation_time": "2016-02-18T09:17:08Z", "time": "2016-02-18T09:17:08Z", "is_private": false}, {"count": 29, "tags": [], "bug_id": 58437, "text": "(In reply to Binyamin from comment #28)\n> Javier, why not to land this fix in 2.4.X?\n> I expect httpd 2.5 even doesn't have ETA.\n\nBecause initially the https://github.com/jgm1986/Apache_mod_h2 project was designed to test early version of \"mod_h2\" module (only available on 2.5-dev). Today, this module has been included on Apache by default but, I don't have free time to update the installation script on my repository and test it on Ubuntu. However, it's a pending task.", "id": 188561, "attachment_id": null, "creator": "javier.gusano@hpe.com", "creation_time": "2016-02-18T09:23:00Z", "time": "2016-02-18T09:23:00Z", "is_private": false}]