[{"count": 0, "tags": [], "creator": "bshen@lehman.com", "attachment_id": null, "id": 49546, "time": "2003-12-22T16:09:04Z", "bug_id": 25702, "creation_time": "2003-12-22T16:09:04Z", "is_private": false, "text": "Hello, i am using:\n\nredhat linux enterprise\nweblogic6.1\njava 1.3.1\n\nWhen generating a 1000+ row x 54 col excel sheet using HSSF, the java servlet \nthrows an outofmemory exception everytime (if i do one with 600 rows or less, \nit works fine). This is the first time i am using hssf and I followed the \ntutorial code:\n\nHSSFRow title = sheet.createRow((short)0);\ntitle.createCell((short)0).setCellValue(\"columnname1\");\ntitle.createCell((short)1).setCellValue(\"columnname2\");\n......etc.....\ntitle.createCell((short)54).setCellValue(\"columnname53\");\n\nResultSet rs = getresultset();\nint rowcount=1;\nrs = executeQuery(sql); //get resultset, leftout some jdbc codes\nwhile (rs.next()) //has 1000+ rows\n{\n      HSSFRow datarow = sheet.createRow((short)rowcount);\n      rowcount++;\n      for(int colcount=0; colcount<55;colcount++)\n      {\t\n\tdatarow.createCell((short)colcount).setCellValue(rs.getString\n(colcount+1));\n      }\n}\n\nHere's memory usage log file from 2 tries, both resulted in outofmemory:\n\n[GC 13773K->10735K(32640K), 0.0287972 secs]\n<Dec 22, 2003 10:04:35 AM EST> <Debug> <DEBUG> <*********************FIRST FOR \nLOOP:0> \n......\n<Dec 22, 2003 10:07:04 AM EST> <Debug> <DEBUG> <CELL COUNT:50 CELL \nVALUE:0>  //*****Note this row never finished, cell count should reach 54 like \nevery other row.\n[Full GC 32639K->29327K(32640K), 1.8477303 secs]\n[Full GC 29327K->29289K(32640K), 1.8480125 secs]\n<Dec 22, 2003 10:07:08 AM EST> <Error> <HTTP> <[WebAppServletContext\n(2438883,yyy,/yyy)] Servlet failed with Exception\njava.lang.OutOfMemoryError\n\t<<no stack trace available>>\n\n\n--------------\n\n\n[GC 11797K->8490K(32640K), 0.0076758 secs]\n[GC 11818K->8461K(32640K), 0.0067751 secs]\n<Dec 22, 2003 10:15:11 AM EST> <Debug> <DEBUG> <*********************FIRST FOR \nLOOP:0>\n.......\n<Dec 22, 2003 10:17:12 AM EST> <Debug> <DEBUG> <CELL COUNT:54 CELL VALUE:0> \n[Full GC 30728K->27639K(32640K), 1.7628752 secs]\n[Full GC 32457K->28945K(32640K), 2.1956773 secs]\n[Full GC 28945K->28945K(32640K), 1.7103354 secs]\n<Dec 22, 2003 10:17:19 AM EST> <Error> <HTTP> <[WebAppServletContext\n(2438883,yyy,/yyy)] Servlet failed with Exception\njava.lang.OutOfMemoryError\n\t<<no stack trace available>>\n\n\nFrom the log it seems the machine is not out of memory? I am really not sure \nwhat is going on with hssf now. Please help, thank you\n\ngaga"}, {"count": 1, "tags": [], "bug_id": 25702, "is_private": false, "text": "Please start your JVM with more memory. \nhttp://java.sun.com/j2se/1.3/docs/tooldocs/linux/java.html\n\nWhile POI obviously needs a significant amount of memory to create large files,\nthis is not a bug, and resolving Out of Memroy errors have nothing to ddo with POI. ", "id": 49547, "time": "2003-12-22T16:18:26Z", "creator": "avik@apache.org", "creation_time": "2003-12-22T16:18:26Z", "attachment_id": null}]