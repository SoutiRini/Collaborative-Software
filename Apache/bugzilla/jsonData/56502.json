[{"count": 0, "tags": [], "bug_id": 56502, "attachment_id": 31600, "id": 175109, "time": "2014-05-08T12:35:57Z", "creator": "apachebugzilla@lucanet.com", "creation_time": "2014-05-08T12:35:57Z", "is_private": false, "text": "Created attachment 31600\nlncore-7698_source.xlsx\n\nIf you have a Cell with External Formula ( LUCANET(\"Ist\")) and you want to shift Rows, the\nRows will not be shift:\n\nPOIFSFileSystem fileSystem = new POIFSFileSystem(new FileInputStream(\"lncore-7698_source.xlsx\"));\n\nHSSFWorkbook workbook = new HSSFWorkbook(fileSystem);\n\nHSSFSheet sheet = workbook.getSheetAt(0);\n\nsheet.shiftRows(1, sheet.getLastRowNum(), 1);\n\n\n\nBug:\n\norg.apache.poi.ss.formula.FormulaParseException: Parse error near char 0 '[' in specified formula '[1]!LUCANET(\"Ist\")'. Expected number, string, or defined name\n\tat org.apache.poi.ss.formula.FormulaParser.expected(FormulaParser.java:219)\n\tat org.apache.poi.ss.formula.FormulaParser.parseNonRange(FormulaParser.java:549)\n\tat org.apache.poi.ss.formula.FormulaParser.parseRangeable(FormulaParser.java:429)\n\tat org.apache.poi.ss.formula.FormulaParser.parseRangeExpression(FormulaParser.java:268)\n\tat org.apache.poi.ss.formula.FormulaParser.parseSimpleFactor(FormulaParser.java:1119)\n\tat org.apache.poi.ss.formula.FormulaParser.percentFactor(FormulaParser.java:1079)\n\tat org.apache.poi.ss.formula.FormulaParser.powerFactor(FormulaParser.java:1066)\n\tat org.apache.poi.ss.formula.FormulaParser.Term(FormulaParser.java:1426)\n\tat org.apache.poi.ss.formula.FormulaParser.additiveExpression(FormulaParser.java:1526)\n\tat org.apache.poi.ss.formula.FormulaParser.concatExpression(FormulaParser.java:1510)\n\tat org.apache.poi.ss.formula.FormulaParser.comparisonExpression(FormulaParser.java:1467)\n\tat org.apache.poi.ss.formula.FormulaParser.unionExpression(FormulaParser.java:1447)\n\tat org.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:1568)\n\tat org.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:176)\n\tat org.apache.poi.xssf.usermodel.helpers.XSSFRowShifter.shiftFormula(XSSFRowShifter.java:189)\n\tat org.apache.poi.xssf.usermodel.helpers.XSSFRowShifter.updateRowFormulas(XSSFRowShifter.java:153)\n\tat org.apache.poi.xssf.usermodel.helpers.XSSFRowShifter.updateSheetFormulas(XSSFRowShifter.java:140)\n\tat org.apache.poi.xssf.usermodel.helpers.XSSFRowShifter.updateFormulas(XSSFRowShifter.java:127)\n\tat org.apache.poi.xssf.usermodel.XSSFSheet.shiftRows(XSSFSheet.java:2465)\n\tat org.apache.poi.xssf.usermodel.XSSFSheet.shiftRows(XSSFSheet.java:2399)\n\tat ApacheBugShiftRows.testFillRowsAndKeepGroupingXLSX(ApacheBugShiftRows.java:45)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)\n\tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n\tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)\n\tat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\n\tat org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)\n\tat org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)\n\tat org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)\n\tat org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)\n\tat org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)\n\tat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)\n\tat org.junit.runners.ParentRunner.run(ParentRunner.java:300)\n\tat org.junit.runner.JUnitCore.run(JUnitCore.java:157)\n\tat com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:74)\n\tat com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:202)\n\tat com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:65)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat com.intellij.rt.execution.application.AppMain.main(AppMain.java:120)"}, {"count": 1, "attachment_id": null, "creator": "apachebugzilla@lucanet.com", "text": "correct Example:\n\n\nPOIFSFileSystem fileSystem = new POIFSFileSystem(new FileInputStream(\"lncore-7698_source.xlsx\"));\n\nXSSFWorkbook workbook = new XSSFWorkbook(fileSystem);\n\nXSSFSheet sheet = workbook.getSheetAt(0);\n\nsheet.shiftRows(1, sheet.getLastRowNum(), 1);", "id": 175110, "time": "2014-05-08T12:40:23Z", "bug_id": 56502, "creation_time": "2014-05-08T12:40:23Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "As of r1614916, the shift can now be performed\n\n(We still can't handle the formula, which seems to be a reference to a UDF in another file, but instead of failing we now log the problem and move onto the next cell)", "id": 176807, "time": "2014-07-31T15:12:33Z", "bug_id": 56502, "creation_time": "2014-07-31T15:12:33Z", "is_private": false}]