[{"count": 0, "tags": [], "bug_id": 37760, "text": "public void setMapper(String type, String from, String to) {\n        Mapper m = createMapper();\n        Mapper.MapperType mapperType = new Mapper.MapperType();\n        mapperType.setValue(type);\n        m.setFrom(from);\n        m.setTo(to);\n    }\n\nNote that mapperType is never added to the mapper. This creates a hard-to-debug\nproblem (especially for a dumb newb like me).\nI found this problem on 1.6.5 version of Ant (above link is for current\nsubversion state for this file). For me the problem occured when I tried to use\n<script> to create a CallTarget task with PropertySet.", "id": 83153, "time": "2005-12-02T19:36:45Z", "creator": "gverig@yahoo.com", "creation_time": "2005-12-02T19:36:45Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "text": "I agree this looks wrong but for some reason I am having trouble evoking the\nwrong behavior.  Do you have a working test case you could attach?\n\nThanks,\nMatt", "attachment_id": null, "id": 83235, "creator": "mbenson@apache.org", "time": "2005-12-05T16:42:38Z", "bug_id": 37760, "creation_time": "2005-12-05T16:42:38Z", "is_private": false}, {"count": 2, "tags": [], "creator": "mbenson@apache.org", "attachment_id": null, "text": "(In reply to comment #1)\n> Do you have a working test case you could attach?\n\nOr rather \"not working\" ?  :)", "id": 83236, "time": "2005-12-05T16:43:17Z", "bug_id": 37760, "creation_time": "2005-12-05T16:43:17Z", "is_private": false}, {"count": 3, "tags": [], "creator": "stevel@apache.org", "attachment_id": null, "text": "It probably depends upon createMapper() not only creating the mapper, but adding\nit to the list. Which is exactly what it does:\n\n   public Mapper createMapper() {\n        assertNotReference();\n        if (mapper != null) {\n            throw new BuildException(\"Too many <mapper>s!\");\n        }\n        mapper = new Mapper(getProject());\n        return mapper;\n    }\n\nI don't think this is the cause of whatever problem you encountered.", "id": 83238, "time": "2005-12-05T17:15:50Z", "bug_id": 37760, "creation_time": "2005-12-05T17:15:50Z", "is_private": false}, {"count": 4, "tags": [], "creator": "mbenson@apache.org", "attachment_id": null, "id": 83254, "time": "2005-12-05T19:57:22Z", "bug_id": 37760, "creation_time": "2005-12-05T19:57:22Z", "is_private": false, "text": "duh, I didn't even notice that the offending method doesn't even conform to Ant\nintrospection stuff.  But for an API user it looks like a problem.  This looks\ncorrect from that perspective."}, {"attachment_id": null, "tags": [], "creator": "gverig@yahoo.com", "is_private": false, "count": 5, "id": 83263, "time": "2005-12-05T21:47:09Z", "bug_id": 37760, "creation_time": "2005-12-05T21:47:09Z", "text": "(In reply to comment #0)\n> public void setMapper(String type, String from, String to) {\n>         Mapper m = createMapper();\n>         Mapper.MapperType mapperType = new Mapper.MapperType();\n>         mapperType.setValue(type);\n>         m.setFrom(from);\n>         m.setTo(to);\n>     }\n> \n> Note that mapperType is never added to the mapper. This creates a hard-to-debug\n> problem (especially for a dumb newb like me).\n> I found this problem on 1.6.5 version of Ant (above link is for current\n> subversion state for this file). For me the problem occured when I tried to use\n> <script> to create a CallTarget task with PropertySet.\n\n(In reply to comment #3)\n> It probably depends upon createMapper() not only creating the mapper, but adding\n> it to the list. Which is exactly what it does:\n> \n>    public Mapper createMapper() {\n>         assertNotReference();\n>         if (mapper != null) {\n>             throw new BuildException(\"Too many <mapper>s!\");\n>         }\n>         mapper = new Mapper(getProject());\n>         return mapper;\n>     }\n> \n> I don't think this is the cause of whatever problem you encountered.\n\nNo, attaching Mapper to the task is not a problem. The problem is that\nmapeprType is never attached to the mapper\nAfter\n  Mapper.MapperType mapperType = new Mapper.MapperType();\n  mapperType.setValue(type);\nThere needs to be\n  m.setType(mapperType);\n\nI do not have a [not] working scrip, I will try to add it by the end of the day,\nbut basically what I did is I added a task through\nproject.createTask(\"antcall\"); , obtained property set and tried to add Mapper\nwith setMapper method. Which failed with message stating that type was not\ndefined (see the code, type is created but never attached to the mapper)."}, {"attachment_id": null, "tags": [], "creator": "mbenson@apache.org", "text": "so everybody's right here.  :)  The error you discovered does exist, but only\nfor API users.  You should be able to work around this in a number of ways, but\nwe will fix in SVN as well.\n\n-Matt", "count": 6, "id": 83265, "time": "2005-12-05T22:05:41Z", "bug_id": 37760, "creation_time": "2005-12-05T22:05:41Z", "is_private": false}, {"count": 7, "tags": [], "creator": "mbenson@apache.org", "text": "fixed for 1.7", "id": 83266, "time": "2005-12-05T22:18:47Z", "bug_id": 37760, "creation_time": "2005-12-05T22:18:47Z", "is_private": false, "attachment_id": null}]