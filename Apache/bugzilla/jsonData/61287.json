[{"count": 0, "tags": [], "creator": "lejingw@163.com", "attachment_id": null, "text": "in the construtor method of `org.apache.poi.hssf.record.HeaderFooterBase#HeaderFooterBase(org.apache.poi.hssf.record.RecordInputStream)`, it will throw RecordFormatException in the method call `in.readByte()` when variable field_1_footer_len equals to 0 \n\nthe constrator is as follows:\n\n\tprotected HeaderFooterBase(RecordInputStream in) {\n\t\tif (in.remaining() > 0) {\n\t\t\tint field_1_footer_len = in.readShort();\n\t\t\tfield_2_hasMultibyte = in.readByte() != 0x00;\n\n\t\t\tif (field_2_hasMultibyte) {\n\t\t\t\tfield_3_text = in.readUnicodeLEString(field_1_footer_len);\n\t\t\t} else {\n\t\t\t\tfield_3_text = in.readCompressedUnicode(field_1_footer_len);\n\t\t\t}\n\t\t} else {\n\t\t\t// Note - this is unusual for BIFF records in general, but normal for header / footer records:\n\t\t\t// when the text is empty string, the whole record is empty (just the 4 byte BIFF header)\n\t\t\tfield_3_text = \"\";\n\t\t}\n\t}\n\nand the exception stack is as follows:\n\norg.apache.poi.hssf.record.RecordFormatException: Not enough data (0) to read requested (1) bytes\n\tat org.apache.poi.hssf.record.RecordInputStream.checkRecordPosition(RecordInputStream.java:237)\n\tat org.apache.poi.hssf.record.RecordInputStream.readByte(RecordInputStream.java:246)\n\tat org.apache.poi.hssf.record.HeaderFooterBase.<init>(HeaderFooterBase.java:39)\n\tat org.apache.poi.hssf.record.HeaderRecord.<init>(HeaderRecord.java:36)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n\tat org.apache.poi.hssf.record.RecordFactory$ReflectionConstructorRecordCreator.create(RecordFactory.java:84)\n\tat org.apache.poi.hssf.record.RecordFactory.createSingleRecord(RecordFactory.java:345)\n\tat org.apache.poi.hssf.record.RecordFactoryInputStream.readNextRecord(RecordFactoryInputStream.java:288)\n\tat org.apache.poi.hssf.record.RecordFactoryInputStream.nextRecord(RecordFactoryInputStream.java:254)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords(RecordFactory.java:494)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:348)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:405)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:386)", "id": 199751, "time": "2017-07-13T02:40:31Z", "bug_id": 61287, "creation_time": "2017-07-13T02:40:31Z", "is_private": false}, {"count": 1, "tags": [], "creator": "lejingw@163.com", "attachment_id": 35125, "text": "Created attachment 35125\nthe excel to be read with exception", "id": 199752, "time": "2017-07-13T02:42:50Z", "bug_id": 61287, "creation_time": "2017-07-13T02:42:50Z", "is_private": false}, {"count": 2, "tags": [], "creator": "tallison@mitre.org", "attachment_id": null, "text": "Thank you for opening this issue and sharing a triggering document.  I'm not able to reproduce this with trunk.  Are you using 3.17-beta1 or an earlier version of POI?", "id": 199765, "time": "2017-07-13T17:01:21Z", "bug_id": 61287, "creation_time": "2017-07-13T17:01:21Z", "is_private": false}, {"count": 3, "tags": [], "creator": "tallison@mitre.org", "attachment_id": null, "text": "(In reply to Tim Allison from comment #2)\n> Thank you for opening this issue and sharing a triggering document.  I'm not\n> able to reproduce this with trunk.  Are you using 3.17-beta1 or an earlier\n> version of POI?\n\nDoh.  Right, you selected 3.16-final above.  This looks to be fixed now.  Please reopen if you are having problems with 3.17-beta1.", "id": 199766, "time": "2017-07-13T17:02:31Z", "bug_id": 61287, "creation_time": "2017-07-13T17:02:31Z", "is_private": false}, {"count": 4, "tags": [], "creator": "lejingw@163.com", "attachment_id": 35136, "text": "Created attachment 35136\npach file to be validated\n\ni have updated the attachment, the exception still exists in 3.17-beta1.", "id": 199787, "time": "2017-07-14T01:24:48Z", "bug_id": 61287, "creation_time": "2017-07-14T01:24:48Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 61287, "text": "Created attachment 35137\nthe excel to be read with exception", "id": 199788, "time": "2017-07-14T01:26:07Z", "creator": "lejingw@163.com", "creation_time": "2017-07-14T01:26:07Z", "is_private": false, "attachment_id": 35137}, {"count": 6, "tags": [], "bug_id": 61287, "attachment_id": null, "id": 199799, "time": "2017-07-14T13:54:46Z", "creator": "tallison@mitre.org", "creation_time": "2017-07-14T13:54:46Z", "is_private": false, "text": "Thank you for reporting this, diagnosing the problem and sharing triggering files!"}]