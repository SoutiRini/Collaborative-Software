[{"count": 0, "attachment_id": null, "creator": "loney@spiritedsw.com", "is_private": false, "id": 1635, "time": "2001-03-28T15:48:39Z", "bug_id": 1144, "creation_time": "2001-03-28T15:48:39Z", "tags": [], "text": "Ouput is not written to file as expected unless formatter useFile option is set \nto true. Details below from junit discussion \ngroup (http://groups.yahoo.com/group/junit). Workaround is described as well.\n\nFrom:  loney@spiritedsw.com\nDate:  Wed Mar 28, 2001 11:32pm\nSubject:  Re: JUnit 3.5 & Ant 1.3\n\nOn further investigation, the problem is that the FormatterElement \nuseFile flag is mysteriously reset to false. I've spent way too much \ntime on this bug hunt, so somebody else can pick it up from here if \ninterested.\n\n--- In junit@y..., loney@s... wrote:\n> Failure to produce output is a bug in the junit ant task code. The \n> class JUnitTask that implements the output mechanism is completely \n> bypassed; deleting it from the jar has no effect. Rather, the task's \n> TestRunner makes JUnitTest objects directly without wrapping them in \na \n> JUnitTask. Work-around is to explictly define the junit task \nformatter \n> usefile option, e.g.:\n> \n>       <formatter type=\"xml\" usefile=\"true\" />\n> \n> and add a todir option to the test, e.g.\n> \n>       <test name=\"myClass\" todir=\"myDir\" />\n> \n> The junit ant task is otherwise a handy feature and the various \n> authors are to be congratulated.\n> \n> --- In junit@y..., Fred Loney <loney@s...> wrote:\n> > Alas, it is often the case that expectation ~= reality. Although \n> defining the junit task _should_ not be necessary, myself and others \n> have observed that it is. It is correct that junit.jar only needs to \n> be added to the junit task classpath if fork=\"true\". The other steps \n> described below proved necessary, and no configuration yields \noutput. \n> Again, is there an example of an ant 1.3 junit 3.5 task that prints \n> output for failed tests?\n> > \n> > I notice that ant terminates without returning control to a Win2k \n> batch file that executes it. Perhaps the missing output defect is a \n> manifestation of a larger control issue.\n> > \n> > Vitezslav Stejskal wrote:\n> > \n> > > Fred Loney wrote:\n> > >\n> > > > I encountered this problem, and had to do the following:\n> > > >\n> > > > o add junit.jar to the classpath of the ant executable\n> > > > o add the ant optional jar to the classpath of the ant \n> executable\n> > > >\n> > >\n> > > As I understand Ant and junit, only above two things are\n> > > necceassary to do when you want to use junit optional task.\n> > >\n> > > > o aadd junit.jar to the classpath of the junit task\n> > >\n> > > This and maybe other jars from ${ANT_HOME}/lib you will need to\n> > > add to junit task's classpath when you use the fork=yes \nattribute\n> > > to run your tests in separate JVM.\n> > >\n> > > >\n> > > > o explicitly define the junit task\n> > >\n> > > Definitely, this is not neccessary ...\n> > >\n> > > >\n> > > >\n> > > > The ant directives are shown below.\n> > > >\n> > > > However, given all of that, junit executes as expected and ant \n> shows the summary result for each test (success or failure).  \nHowever, \n> ant does not produce any output file under any circumstances or \n> settings. Has anybody successfully used the junit task with ant 1.3 \n> and junit 3.5? If so, could you post a sample?\n> > > >\n> > > >   <!-- Add optional junit task; requires invoking ant with \n> optional ant jar -->\n> > > >   <taskdef name=\"junit\" \n> classname=\"org.apache.tools.ant.taskdefs.optional.junit.JUnitTask\" \n/>\n> > > >     ...\n> > > >   <path id=\"test.class.path\">\n> > > >     <path refid=\"app.class.path\" />\n> > > >     <pathelement location=\"${ext.lib}/junit.jar\" />\n> > > >   </path>\n> > > >    ...\n> > > >   <!-- Run the test suite -->\n> > > >   <target name=\"test\" depends=\"testbed\">\n> > > >     <junit>\n> > > >       <classpath refid=\"test.class.path\" />\n> > > >       <batchtest>\n> > > >         <fileset dir=\"${source}\" \n> includes=\"${test.dir}/**/*.java\">\n> > > >         </fileset>\n> > > >       </batchtest>\n> > > >     </junit>\n> > > >   </target>\n> > > >"}, {"count": 1, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 2259, "time": "2001-05-04T02:00:40Z", "bug_id": 1144, "creation_time": "2001-05-04T02:00:40Z", "is_private": false, "text": "could you please check whether the last set of patches I committed for the\nnightly build 2001-05-04 fixes the output problem?\n\nprintsummary now has an option named withOutAndErr to also include the test\noutput and all output should be captured by the formatters - always.\n\nStefan"}, {"count": 2, "tags": [], "bug_id": 1144, "attachment_id": null, "text": "Confirmed to be fixed by Fred Loney, thanks.", "id": 2591, "time": "2001-05-22T02:35:06Z", "creator": "bodewig@apache.org", "creation_time": "2001-05-22T02:35:06Z", "is_private": false}]