[{"count": 0, "tags": [], "creator": "gmorin@sysif.net", "attachment_id": null, "text": "Hello,\n\nI tried the new module mod_proxy_balancer from apache 2.2. last week and I\nget a strange behaviour with it. It doesn't conserv the \"Host:\" header of the\nHTTP request when forwarding to the backend servers. Let me illustrate it :\n\nHere is the virtual host configuration of my test :\n\n<VirtualHost *>\n    ServerName testlb.spider.xxx\n    ErrorLog /var/www2/logs/testlb/error_log\n    CustomLog /var/www2/logs/testlb/access_log combined\n\n    ProxyPass / balancer://cluster stickysession=mysessionid nofailover=On\n    <Proxy balancer://cluster>\n        BalancerMember http://127.0.0.1:8080\n    </Proxy>\n\n</VirtualHost>\n\nI run in a terminal \"nc -l -p 8080\" and then open with my browser the url\n\"http://testlb.spider.xxx\".\n\nThat's what I got :\n\nGET / HTTP/1.1\nHost: 127.0.0.1:8080\nUser-Agent: ELinks/0.10.6-1-debian (textmode; Linux 2.6.11.11 i686; 80x35-2)\nAccept: */*\nAccept-Encoding: gzip\nAccept-Language: fr\nMax-Forwards: 10\nX-Forwarded-For: 192.168.5.242\nX-Forwarded-Host: testlb.spider.xxx:80\nX-Forwarded-Server: testlb.spider.xxx\n\nThat's not what I expected. Most of the load balancer (like pound or haproxy for\nexample) would send something like :\n\nGET / HTTP/1.1\nHost: testlb.spider.xxx\n\nThis make possible the use of virtualhosting behind the load balancer.\n\nI know it is not really a 'bug', but it makes this module useless in my\nsituation, and I think many users will have the same problem.\n\nPerhaps am I wrong ?\nIs there something I miss ?\n\nThank you for your work,\n\nGuillaume Morin", "id": 84123, "time": "2006-01-02T14:48:16Z", "bug_id": 38096, "creation_time": "2006-01-02T14:48:16Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 38096, "attachment_id": null, "id": 84200, "time": "2006-01-04T03:50:55Z", "creator": "slive@apache.org", "creation_time": "2006-01-04T03:50:55Z", "is_private": false, "text": "Have you tried the ProxyPreserveHost directive?"}, {"count": 2, "tags": [], "bug_id": 38096, "text": "No, I didn't try, was just looking to the mod_proxy_balancer documentation. \n\nIt works fine, I'm really sorry for the bother.\n\nPerhaps ProxyPreserveHost could be enabled by default when using\nmod_proxy_balancer ?\n\nGuillaume Morin\n", "id": 84204, "time": "2006-01-04T12:01:54Z", "creator": "gmorin@sysif.net", "creation_time": "2006-01-04T12:01:54Z", "is_private": false, "attachment_id": null}]