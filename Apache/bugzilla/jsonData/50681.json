[{"count": 0, "tags": [], "creator": "bryan_coleman@dart.biz", "text": "Using version 3.7\n\nXSSFSheet.autoSizeColumn calculates the size of a large column beyond the 255 character maximum.  The HSSFSheet.autoSizeColumn does not do this.  I noticed that bug 50211 combined the XSSF and HSSF autoSizeColumn methods.  I have not tried the latest developer release; however, I wanted to get this in there to make sure this bug isn't carried over from the XSSF class.\n\nTo reproduce:\n\nimport org.apache.poi.xssf.usermodel.*;\nimport java.io.*;\n\npublic class AutoSizeTest {\n\n    public static void main(String args[]) {\n        XSSFWorkbook workbook = new XSSFWorkbook();\n        XSSFSheet    sheet = workbook.createSheet(\"\");\n        XSSFRow      row = sheet.createRow(0);\n        XSSFCell     cell0 = row.createCell(0);\n\n        cell0.setCellValue(\"www.hostname.com, www.hostname.com, www.hostname.com, www.hostname.com, www.hostname.com, www.hostname.com, \nwww.hostname.com, www.hostname.com, www.hostname.com, www.hostname.com, \nwww.hostname.com, www.hostname.com, www.hostname.com, www.hostname.com, \nwww.hostname.com, www.hostname.com, www.hostname.com, www.hostname.com\");\n\n        sheet.autoSizeColumn(0);\n        sheet.setColumnWidth(0, sheet.getColumnWidth(0)); // FAILS HERE\n\n        try {\n            FileOutputStream out = new FileOutputStream(\"working.xls\");\n            workbook.write(out);\n            out.close();\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    } // main\n}", "id": 143757, "time": "2011-01-28T11:48:52Z", "bug_id": 50681, "creation_time": "2011-01-28T11:48:52Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 50681, "attachment_id": null, "id": 143758, "creation_time": "2011-01-28T11:56:34Z", "time": "2011-01-28T11:56:34Z", "creator": "apache@gagravarr.org", "text": "Please re-test with a recent svn checkout / nightly build and confirm if the problem is there or not.", "is_private": false}, {"count": 2, "tags": [], "bug_id": 50681, "is_private": false, "id": 144027, "attachment_id": null, "creator": "bryan_coleman@dart.biz", "creation_time": "2011-02-07T14:50:58Z", "time": "2011-02-07T14:50:58Z", "text": "I do not have available time in the near future to test with the latest code base.  If anyone has time available, please test using the code provided.  If there is a jar that I can just drop into my application, I would probably have the fifteen minutes to try that within the next few weeks just let me know where to find it."}, {"count": 3, "tags": [], "bug_id": 50681, "attachment_id": null, "text": "I have tested the above code in 3.8 beta 3 and it failed.\n\nThere is also a regression for HSSF Sheets.\n\nThe following code works in POI 3.7, but fails in POI 3.8 beta3.\n\npackage org.apache.poi.ss.examples;\nimport org.apache.poi.hssf.usermodel.*;\nimport org.apache.poi.xssf.usermodel.*;\n\nimport java.io.*;\n\npublic class AutoSizeTest {\n\n    public static void main(String args[]) {\n        HSSFWorkbook workbook = new HSSFWorkbook();\n        HSSFSheet    sheet = workbook.createSheet(\"Sheet1\");\n        HSSFRow      row = sheet.createRow(0);\n        HSSFCell     cell0 = row.createCell(0);\n\n        String longValue = \"www.hostname.com, www.hostname.com, \" +\n        \t\t\"www.hostname.com, www.hostname.com, www.hostname.com, \" +\n        \t\t\"www.hostname.com, www.hostname.com, www.hostname.com, \" +\n        \t\t\"www.hostname.com, www.hostname.com, www.hostname.com, \" +\n        \t\t\"www.hostname.com, www.hostname.com, www.hostname.com, \" +\n        \t\t\"www.hostname.com, www.hostname.com, www.hostname.com, www.hostname.com\";\n        \n        cell0.setCellValue(longValue);\n\n        sheet.autoSizeColumn(0);\n        sheet.setColumnWidth(0, sheet.getColumnWidth(0)); // FAILS HERE\n\n        try {\n            FileOutputStream out = new FileOutputStream(\"C:/workspace/working.xls\");\n            workbook.write(out);\n            out.close();\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    } // main\n}", "id": 147162, "time": "2011-06-15T20:44:06Z", "creator": "jxz164@hotmail.com", "creation_time": "2011-06-15T20:44:06Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 50681, "is_private": false, "text": "Fixed in r1136330, junit added.\n\nYegor", "id": 147186, "time": "2011-06-16T08:59:15Z", "creator": "yegor@dinom.ru", "creation_time": "2011-06-16T08:59:15Z", "attachment_id": null}]