[{"attachment_id": null, "tags": [], "bug_id": 8317, "is_private": false, "count": 0, "id": 14106, "time": "2002-04-19T22:36:43Z", "creator": "Lance.Andersen@Sun.COM", "creation_time": "2002-04-19T22:36:43Z", "text": "<sql:setDataSource dataSource=\"${jstlDS}\"  />  and it's RT cousin  do not work\ncorrectly when passed a DataSource or a list of DriverManager parameters...\n\n\n\n<%@ taglib prefix=\"c\" uri=\"http://java.sun.com/jstl/core\" %>\n<%@ taglib prefix=\"sql\" uri=\"http://java.sun.com/jstl/sql\" %>\n<%@ taglib prefix=\"sql_rt\" uri=\"http://java.sun.com/jstl/sql_rt\" %>\n<%@ taglib prefix=\"tck\" uri=\"http://java.sun.com/jstltck/jstltck-util\" %>\n<%@ page import=\"javax.sql.*, java.util.*\" %>\n\n<tck:test testName=\"positiveSetDataSourceQueryNoVarAttributeDataSourceTest\">\n\n  <!-- EL: Validate sql:query and sql:setDataSource actions by specifying a \n        DataSource Object for javax.servlet.jsp.jstl.sql.dataSource-->\n\n   <h1>Validate sql:query and sql:setDataSource actions by specifying a\n       DataSource object for javax.servlet.jsp.jstl.sql.dataSource using EL</h1>\n   <p>\n\n  <c:catch var=\"ex\"  >\n      <sql:setDataSource dataSource=\"${jstlDS}\"  />  \n  </c:catch>\n\n   <c:choose>\n      <c:when test=\"${!empty ex}\">\n         <H2>ERROR:</H2>\n         Could not create a dataSource using  a <strong>DataSource Object\n         </strong> for javax.servlet.jsp.jstl.sql.dataSource! The Exception that\n         was raised is: <strong><c:out value='${ex}' escapeXml='false'\n/></strong>.\n         <p>\n      </c:when>\n      <c:otherwise>\n         Successfully created a DataSource.\n         <p>\n      </c:otherwise>\n   </c:choose>\n \n\n  <c:catch var=\"ex2\"  >\n      <sql:query var='resultSet'>        \n         <c:out value=\"${sqlProps.Simple_Select_Query}\" />  \n      </sql:query>\n   </c:catch>\n\n   <c:choose>\n      <c:when test=\"${!empty ex2}\">\n         <H2>ERROR:</H2>\n         Could not execute the query <strong><c:out\nvalue=\"${sqlProps.Simple_Select_Query}\" />\n         </strong> when using  a <strong>DataSource Object </strong> for \n          javax.servlet.jsp.jstl.sql.dataSource! The Exception that was raised\nis: \n         <strong><c:out value='${ex2}' escapeXml='false' /></strong>.\n         <p>\n      </c:when>\n      <c:otherwise>\n         Successfully executed the query when\njavax.servlet.jsp.jstl.sql.dataSource \n         was provided a DataSource Object.\n         <p>\n      </c:otherwise>\n   </c:choose>\n \n\n   <!-- RT: Validate sql:query and sql:setDataSource actions by specifying a \n        DataSource Object for javax.servlet.jsp.jstl.sql.dataSource-->\n\n   <h1>Validate sql:query and sql:setDataSource actions by specifying a\n       DataSource object for javax.servlet.jsp.jstl.sql.dataSource using RT</h1>\n   <p>\n <c:catch var=\"ex3\"  >\n      <sql_rt:setDataSource \n          dataSource='<%=(DataSource) pageContext.getAttribute(\"jstlDS\",\nPageContext.APPLICATION_SCOPE) %>'\n          /> \n  </c:catch>\n\n   <c:choose>\n      <c:when test=\"${!empty ex3}\">\n         <H2>ERROR:</H2>\n         Could not create a dataSource using  a <strong>DataSource Object\n         </strong> for javax.servlet.jsp.jstl.sql.dataSource! The Exception that \n         was raised is: <strong><c:out value='${ex3}'  escapeXml='false'\n/></strong>.\n         <p>\n      </c:when>\n      <c:otherwise>\n         Successfully created a DataSource.\n         <p>\n      </c:otherwise>\n   </c:choose>\n \n\n  <c:catch var=\"ex4\"  >\n    <sql_rt:query var=\"resultSet2\" >\n                 \n         <c:out value=\"${sqlProps.Simple_Select_Query}\" /> \n      </sql_rt:query>\n      \n   </c:catch>\n\n   <c:choose>\n      <c:when test=\"${!empty ex4}\">\n         <H2>ERROR:</H2>\n         Could not execute the query <strong><c:out\nvalue=\"${sqlProps.Simple_Select_Query}\" />\n         </strong> when using  a<strong>DataSource Object</strong> for\n         javax.servlet.jsp.jstl.sql.dataSource! The Exception that was raised\nis: \n         <strong><c:out value='${ex2}' escapeXml='false' /></strong>.         \n         <p>\n      </c:when>\n      <c:otherwise>\n         Successfully executed the query when\njavax.servlet.jsp.jstl.sql.dataSource  \n         was provided a DataSource Object.  \n         <p>\n      </c:otherwise>\n   </c:choose>\n \n</tck:test>"}, {"attachment_id": null, "tags": [], "creator": "jan.luehe@sun.com", "is_private": false, "count": 1, "id": 14371, "time": "2002-04-22T21:50:10Z", "bug_id": 8317, "creation_time": "2002-04-22T21:50:10Z", "text": "<sql:setDataSource> was setting the javax.servlet.jsp.jstl.sql.dataSource\nconfiguration variable using pageContext.setAttribute() instead of Config.set()."}]