[{"count": 0, "tags": [], "creator": "jaboydjr@netwalk.com", "attachment_id": null, "text": "The Apache2 docs suggest that a script with an absolute pathname can be used by\nDirectoryIndex to provide indexing for a requested directory, e.g.\n\n \tDirectoryIndex index.html /cgi-bin/index.cgi\n\nis the example given.  The problem is that the request url and all other\ninformation available to such a script identifies the script, not the\nrequested directory.  Especially if directories are aliased, it may be\nimpossible to locate the requested directory in order to process it.\n\nI am attaching my workaround for this problem, and would stress that I only\nconsider it a workaround.  This workaround adds REQUEST_DIR to the\nenvironment passed to a script to which mod_dir passes a request, so that\nthe script can easily determine what directory is to be indexed.\nThis is a minimally disruptive patch, with the problem that REQUEST_DIR is\nnot a standard CGI variable.\n\n=============================================================================\n--- httpd-2.0.45/modules/mappers/mod_dir.c.orig\t2003-02-03 12:31:43.000000000 -0500\n+++ httpd-2.0.45/modules/mappers/mod_dir.c\t2003-04-18 18:44:56.000000000 -0400\n@@ -183,6 +183,8 @@\n         num_names = 1;\n     }\n \n+    apr_table_setn(r->subprocess_env, \"REQUEST_DIR\", r->filename);\n+\n     for (; num_names; ++names_ptr, --num_names) {\n         /* XXX: Is this name_ptr considered escaped yet, or not??? */\n         char *name_ptr = *names_ptr;", "id": 37638, "time": "2003-05-22T20:35:19Z", "bug_id": 20168, "creation_time": "2003-05-22T20:35:19Z", "is_private": false}, {"count": 1, "tags": [], "creator": "davi@apache.org", "attachment_id": null, "text": "I can't reproduce the problem with 2.0.60-dev, the requested directory is present\nin the REQUEST_URI and SCRIPT_URL environment variables. If more information\nappears later, please re-open the bug.\n\nhttpd.conf: DirectoryIndex index.html index.html.var /cgi-bin/printenv\n\n[davi@montefiori ~]$ lynx -source http://localhost:8080/test/\nDOCUMENT_ROOT=\"/opt/apache-2.0/htdocs\"\nGATEWAY_INTERFACE=\"CGI/1.1\"\nHTTP_ACCEPT=\"text/html, text/plain, audio/mod, image/*, application/msword, application/pdf, \napplication/postscript, text/sgml, */*;q=0.01\"\nHTTP_ACCEPT_LANGUAGE=\"en\"\nHTTP_HOST=\"localhost:8080\"\nHTTP_USER_AGENT=\"Lynx/2.8.5rel.1 libwww-FM/2.14 SSL-MM/1.4.1 OpenSSL/0.9.7f\"\nPATH=\"/usr/kerberos/bin:/usr/local/bin:/bin:/usr/bin:/usr/X11R6/bin:/home/davi/bin\"\nQUERY_STRING=\"\"\nREMOTE_ADDR=\"308f:4008:f8ae:edbf:ea8d:908:448f:4008\"\nREMOTE_PORT=\"57254\"\nREQUEST_METHOD=\"GET\"\nREQUEST_URI=\"/test/\"\nSCRIPT_FILENAME=\"/opt/apache-2.0/cgi-bin/printenv\"\nSCRIPT_NAME=\"/cgi-bin/printenv\"\nSCRIPT_URI=\"http://localhost:8080/test/\"\nSCRIPT_URL=\"/test/\"\nSERVER_ADDR=\"127.0.0.1\"\nSERVER_ADMIN=\"you@example.com\"\nSERVER_NAME=\"localhost\"\nSERVER_PORT=\"8080\"\nSERVER_PROTOCOL=\"HTTP/1.0\"\nSERVER_SIGNATURE=\"<address>Apache/2.0.60-dev (Unix) Server at localhost Port 8080</address>\\n\"\nSERVER_SOFTWARE=\"Apache/2.0.60-dev (Unix)\"\n", "id": 104262, "time": "2007-06-09T06:02:15Z", "bug_id": 20168, "creation_time": "2007-06-09T06:02:15Z", "is_private": false}]