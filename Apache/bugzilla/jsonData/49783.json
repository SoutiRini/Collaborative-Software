[{"count": 0, "tags": [], "text": "Created attachment 25914\nUpdates error code from 0x1D to 0x17 for REF value\n\nIn org.apache.poi.ss.usermodel.FormulaError, the REF and NAME values have the same error code (0x1D). This results in an \"IllegalArgumentException\" when running forString()/forInt(). REF should instead have code 0x17 as it is also defined in other places (e.g. org.apache.poi.ss.usermodel.ErrorConstants)\n\nTo reproduce this: \n- make an excel file (tested with OOXML)\n- make a reference to a cell from another cell\n- delete the first cell\n- run the second cell through \"org.apache.poi.ss.usermodel.FormulaEvaluator.evaluateInCell()\". \n\nThe \"IllegalArgumentException\" will state \"Unknown error type: 23\".", "is_private": false, "id": 139243, "creator": "i8c.alex@gmail.com", "time": "2010-08-19T08:35:40Z", "bug_id": 49783, "creation_time": "2010-08-19T08:35:40Z", "attachment_id": 25914}, {"count": 1, "tags": [], "bug_id": 49783, "text": "I can't reproduce the problem. I created two excel files as you described, one binary and the other OOXML. \n\nThe binary .xls file evaluates OK and the correct error value is set. \n\nThe OOXML workbook evaluates with exception, but with a different one:\n\norg.apache.poi.ss.formula.FormulaParseException: Cell reference expected after sheet name at index 8.\n\tat org.apache.poi.ss.formula.FormulaParser.parseRangeable(FormulaParser.java:420)\n\tat org.apache.poi.ss.formula.FormulaParser.parseRangeExpression(FormulaParser.java:266)\n\tat org.apache.poi.ss.formula.FormulaParser.parseSimpleFactor(FormulaParser.java:1113)\n\nCan you upload a sample workbook that exhibits the problem ? It would be helpful to properly diagnose the problem and also write a unit test against a real file. \n\nYegor", "id": 139253, "time": "2010-08-19T13:48:09Z", "creator": "yegor@dinom.ru", "creation_time": "2010-08-19T13:48:09Z", "is_private": false, "attachment_id": null}, {"attachment_id": 25918, "tags": [], "bug_id": 49783, "text": "Created attachment 25918\nExample file and code\n\nRunning this throws the following exception:\n\nException in thread \"main\" java.lang.IllegalArgumentException: Unknown error type: 23\n\tat org.apache.poi.ss.usermodel.FormulaError.forInt(FormulaError.java:131)\n\tat org.apache.poi.xssf.usermodel.XSSFCell.setCellErrorValue(XSSFCell.java:611)\n\tat org.apache.poi.xssf.usermodel.XSSFFormulaEvaluator.setCellValue(XSSFFormulaEvaluator.java:203)\n\tat org.apache.poi.xssf.usermodel.XSSFFormulaEvaluator.evaluateInCell(XSSFFormulaEvaluator.java:175)\n\tat org.apache.poi.xssf.usermodel.XSSFFormulaEvaluator.evaluateInCell(XSSFFormulaEvaluator.java:46)\n\tat Example.main(Example.java:20)", "count": 2, "id": 139274, "time": "2010-08-20T01:43:34Z", "creator": "i8c.alex@gmail.com", "creation_time": "2010-08-20T01:43:34Z", "is_private": false}, {"count": 3, "tags": [], "creator": "i8c.alex@gmail.com", "text": "Please note that I forgot to tag the first attachment as a \"patch\", but it is indeed a patch.", "id": 139275, "time": "2010-08-20T01:44:52Z", "bug_id": 49783, "creation_time": "2010-08-20T01:44:52Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "yegor@dinom.ru", "is_private": false, "count": 4, "id": 139445, "time": "2010-08-25T09:31:09Z", "bug_id": 49783, "creation_time": "2010-08-25T09:31:09Z", "text": "Fixed in r989100, junit added.\n\nThanks,\nYegor"}]