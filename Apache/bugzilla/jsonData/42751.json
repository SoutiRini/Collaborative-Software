[{"count": 0, "tags": [], "bug_id": 42751, "attachment_id": null, "id": 104748, "time": "2007-06-26T21:12:50Z", "creator": "jabugs@amar.com", "creation_time": "2007-06-26T21:12:50Z", "is_private": false, "text": "A Windows Server 2003 share mounted on a Linux system that works in otherwise\nevery other way fails to transfer files through apache 2.2.4\n\n/etc/fstab entry:\n//server/share   /mnt/data               cifs  \ncredentials=/root/.samba/credentials       0 0\n\n(alse experimented with\nrsize=32768,file_mode=0664,dir_mode=0775,nomapchars,noacl,nobrl,sfu,gid=apache,uid=apache)\n\nThe virtualhost is simply:\n\n<VirtualHost *:80>\n    ServerAdmin xxx@9jr.com\n    # DocumentRoot /web/9jr.com/html\n    DocumentRoot /mnt/data\n    ServerName 9jr.com\n    ServerAlias *.9jr.com\n    ErrorLog logs/9jr.com-error_log\n    # CustomLog /dev/null common\n    CustomLog logs/9jr.com-access_log common\n\n    # RewriteEngine On\n\n    # Pattern Substitution\n\n\n        <Location />\n    Options Indexes FollowSymlinks MultiViews\n        </Location>\n\n        Alias /pics \"/BACKUP/pics\"\n        <Directory \"/BACKUP/pics\">\n                Options Indexes FollowSymLinks MultiViews\n        </Directory>\n\n    DirectoryIndex index.cgi index.html index.htm\n</VirtualHost>\n\nNo other mounted filesystem displays this behavior\n\nThis behavior was confirmed on FC7 and CentOS5"}, {"count": 1, "tags": [], "bug_id": 42751, "attachment_id": null, "id": 104749, "time": "2007-06-26T21:18:31Z", "creator": "jabugs@amar.com", "creation_time": "2007-06-26T21:18:31Z", "is_private": false, "text": "Directory traversing works great.\n\nOn CentOS 5, around 32K is transmitted before the connection is closed. \nA larger image than 32K can be eventually downloaded with repeated go button push.\n\nOn FC7, 0 bytes are transmitted.\n\nI used wget to see what happens:\n\n$ wget http://dev.9jr.com/Mvc-005s.jpg\n--21:17:57--  http://dev.9jr.com/Mvc-005s.jpg\n           => `Mvc-005s.jpg'\nResolving dev.9jr.com... 66.92.42.141\nConnecting to dev.9jr.com|66.92.42.141|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 25,177 (25K) [image/jpeg]\n\n 0% [                                                                          \n                                                                               \n               ] 0             --.--K/s             \n\n21:18:00 (0.00 B/s) - Connection closed at byte 0. Retrying.\n\n--21:18:01--  http://dev.9jr.com/Mvc-005s.jpg\n  (try: 2) => `Mvc-005s.jpg'\nConnecting to dev.9jr.com|66.92.42.141|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 25,177 (25K) [image/jpeg]\nMvc-005s.jpg has sprung into existence.\nRetrying.\n\n--21:18:03--  http://dev.9jr.com/Mvc-005s.jpg\n  (try: 3) => `Mvc-005s.jpg.1'\nConnecting to dev.9jr.com|66.92.42.141|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 25,177 (25K) [image/jpeg]\n\n 0% [                                                                          \n                                                                               \n               ] 0             --.--K/s             \n\n21:18:03 (0.00 B/s) - Connection closed at byte 0. Retrying."}, {"count": 2, "tags": [], "text": "Please set the following configuration directives in your httpd configuration\nand check if the problem persists:\n\nEnableSendfile Off\nEnableMMAP Off\n\nSee also\n\nhttp://httpd.apache.org/docs/2.2/en/mod/core.html#enablesendfile\nhttp://httpd.apache.org/docs/2.2/en/mod/core.html#enablemmap\n\nIt is well know that network mounted file systems like NFS, SMB or CIFS can\ncause these kind of problems in conjunction with sendfile and mmap.\n", "is_private": false, "bug_id": 42751, "id": 104750, "time": "2007-06-27T00:56:54Z", "creator": "rpluem@apache.org", "creation_time": "2007-06-27T00:56:54Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 42751, "text": "Thank you!\n\nEnableSendfile Off \ndid the trick. I guess I limited my searches to CIFS because I was not seeing a\nproblem with NFS mounts.\n\nI wonder if I should contact the APR list about this, as apr_socket_sendfile\nmust be the culprit.\n\nAlso, should I set the status of the bug to 'FIXED' or something else like\n'WONTFIX' ?\n\nThanks again", "id": 104766, "time": "2007-06-27T07:53:22Z", "creator": "jabugs@amar.com", "creation_time": "2007-06-27T07:53:22Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 42751, "attachment_id": null, "id": 104773, "time": "2007-06-27T09:02:15Z", "creator": "rpluem@apache.org", "creation_time": "2007-06-27T09:02:15Z", "is_private": false, "text": "(In reply to comment #3)\n> Thank you!\n> \n> EnableSendfile Off \n> did the trick. I guess I limited my searches to CIFS because I was not seeing a\n> problem with NFS mounts.\n> \n> I wonder if I should contact the APR list about this, as apr_socket_sendfile\n> must be the culprit.\n\nNo need to do. This is a well known OS problem with sendfile and network file\nsystems on OS'es that support sendfile.\n\n> \n> Also, should I set the status of the bug to 'FIXED' or something else like\n> 'WONTFIX' ?\n\nI mark it as invalid as it is the documented behaviour.\n\n"}]