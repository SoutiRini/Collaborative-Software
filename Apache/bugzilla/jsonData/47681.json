[{"count": 0, "text": "Hello,\n\nI am having an issue with using the count function to count the number of entries in an XML document.  \n\nFor example, given the JSP text:\n-------------------\n<%@ taglib uri =\"http://java.sun.com/jsp/jstl/core\" prefix =\"c\"%>\n<%@ taglib uri =\"http://java.sun.com/jsp/jstl/xml\" prefix =\"x\"%>\n\n<x:parse var=\"doc\" xml=\"<?xml version=\\\"1.0\\\" encoding=\\\"ISO-8859-1\\\" ?><world><country><id>1</id><name>Canada</name></country><country><id>2</id><name>USA</name></country></world>\" /> \n\n<x:out select=\"count($doc/world/country)\"/>  \n<br>\n<x:out select=\"count($doc/country)\"/>\n\n-------------------\n\nwill result in the count($doc/world/country) always returns 0 (zero)\nbut the count($doc/country) will return 2.\n\nIs this a bug?  I have tried debugging the taglib code but I cannot figure out what is going wrong.\n\nRegards,\nJason", "bug_id": 47681, "attachment_id": null, "id": 129633, "time": "2009-08-11T13:24:21Z", "creator": "jsartoris@hotmail.com", "creation_time": "2009-08-11T13:24:21Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 47681, "text": "Just an addition to my original post.  \nThe \"count($doc/world/country)\" call will return zero (I think it should return 2.  But when you put the $doc/world/country in a x:forEach tag it will behave correctly and result in two iterations...like this:\n\n<x:forEach select=\"$doc/world/country\" var=\"test\">\n   found a country<br>\n</x:forEach>\n\nThis will result in \"found a country<br>\" being printed out twice..which is expected. \n\nIt seems that once the expression is wrapped in the count function it is not handled properly.  \n\nI noticed in the XPathUtil.adaptParamsForXalan method is only checking if the xpath variable starts with a '$' in order to create the appropriate Node and resolve the variable.  In the case of the count($doc/world/country) expression this does not start with a '$' and will result in the method creating a DummyDocument instead of resolving the variable appropriately.  \n\nRegards,\nJason", "id": 129654, "time": "2009-08-12T06:31:27Z", "creator": "jsartoris@hotmail.com", "creation_time": "2009-08-12T06:31:27Z", "is_private": false, "attachment_id": null}, {"count": 2, "text": "Update assignee to Tomcat dev list", "creator": "markt@apache.org", "attachment_id": null, "id": 129733, "time": "2009-08-17T01:55:54Z", "bug_id": 47681, "creation_time": "2009-08-17T01:55:54Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "creator": "bayard@apache.org", "attachment_id": null, "text": "Resolving. Taglib has been retired.", "id": 132451, "time": "2009-11-29T19:48:33Z", "bug_id": 47681, "creation_time": "2009-11-29T19:48:33Z", "is_private": false}]