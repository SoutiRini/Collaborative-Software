[{"count": 0, "tags": [], "text": "I am getting a JSP compilation error in 4.1.9test that I had not been getting in\n4.0.3.\n\nTHE ERROR (trimmed for brevity)\n---------\norg.apache.jasper.JasperException: Unable to compile class for JSP\n\tat org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:477)\n\tat org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:182)\n\tat org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:289)\n\tat org.apache.jasper.servlet.JspServlet.service(JspServlet.java:240)\n...\n\nroot cause\n\norg.apache.jasper.JasperException: Unable to compile class for JSP\n\nAn error occurred at line: 264 in the jsp file: /netmarkets/jsp/util/begin.jsp\n\nGenerated servlet error:\nDetected Java version: 1.3 in: d:\\jdk1.3.1_02\\jre\nDetected OS: Windows 2000\n    [javac] netmarkets\\jsp\\netmarkets\\view_jsp.java added as\nD:\\jakarta-tomcat-4.1.9\\work\\Tomcat-ForumPass\\localhost\\forumpass\\netmarkets\\jsp\\netmarkets\\view_jsp.class\ndoesn't exist.\n    [javac] Compiling 1 source file\n    [javac] Using modern compiler\n    [javac] Compilation arguments:\n    [javac] '-classpath'\n    [javac]\n'D:\\jdk1.3.1_02\\lib\\tools.jar;D:\\jakarta-tomcat-4.1.9\\bin\\bootstrap.jar;D:\\jakarta-tomcat-4.1.9\\common\\lib\\servlet.jar;D:\\jakarta-tomcat-4.1.9\\common\\endorsed\\xercesImpl.jar;D:\\jakarta-tomcat-4.1.9\\common\\endorsed\\xmlParserAPIs.jar;D:\\ptc\\Windchill\\codebase;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\ie.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\JGL.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\HTTPClient.jar;D:\\evincible\\jlib\\privacy.jar;D:\\evincible\\jlib\\xercesImpl.jar;D:\\evincible\\jlib\\xalan.jar;D:\\evincible\\jlib\\iaik_jce.jar;D:\\evincible\\jlib\\xss4j.jar;D:\\evincible\\jlib\\log4j.jar;D:\\evincible\\jlib\\classes12_9.jar;D:\\evincible\\jlib\\xml-apis.jar;D:\\evincible\\jlib\\kmcsp.jar;D:\\evincible\\jlib\\kmjava.jar;D:\\evincible\\jlib\\nfjava.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\CommonCoreMeta.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\Copy\nof\nxalan.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\JClass.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\OracleThinDrivers.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\RetrievalWare.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\activation.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\avalon-framework-4.0.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\batik-awt-util.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\batik-bridge.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\batik-css.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\batik-dom.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\batik-ext.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\batik-extension.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\batik-gui-util.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\batik-gvt.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\batik-parser.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\batik-script.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\batik-svg-dom.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\batik-svggen.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\batik-transcoder.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\batik-util.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\batik-xml.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\borland.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\fop.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\jakarta-regexp-1.2.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\javaCup.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\jaxp.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\jcert.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\jms.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\jnet.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\jsse.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\ldap.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\logkit-1.0b4.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\magelang.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\mail.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\providerutil.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\saxon-fop.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\saxon-jdom.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\saxon.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\sfc.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\soap.jar;D:\\ptc\\Windchill\\codebase\\WEB-INF\\lib\\xerces.jar;D:\\jakarta-tomcat-4.1.9\\shared\\classes;D:\\jakarta-tomcat-4.1.9\\shared\\lib\\jasper-compiler.jar;D:\\jakarta-tomcat-4.1.9\\shared\\lib\\jasper-runtime.jar;D:\\jakarta-tomcat-4.1.9\\common\\classes;D:\\jakarta-tomcat-4.1.9\\common\\lib\\activation.jar;D:\\jakarta-tomcat-4.1.9\\common\\lib\\ant.jar;D:\\jakarta-tomcat-4.1.9\\common\\lib\\commons-collections.jar;D:\\jakarta-tomcat-4.1.9\\common\\lib\\commons-dbcp.jar;D:\\jakarta-tomcat-4.1.9\\common\\lib\\commons-lang.jar;D:\\jakarta-tomcat-4.1.9\\common\\lib\\commons-logging-api.jar;D:\\jakarta-tomcat-4.1.9\\common\\lib\\commons-pool.jar;D:\\jakarta-tomcat-4.1.9\\common\\lib\\jasper-compiler.jar;D:\\jakarta-tomcat-4.1.9\\common\\lib\\jasper-runtime.jar;D:\\jakarta-tomcat-4.1.9\\common\\lib\\jdbc2_0-stdext.jar;D:\\jakarta-tomcat-4.1.9\\common\\lib\\jndi.jar;D:\\jakarta-tomcat-4.1.9\\common\\lib\\jta-spec1_0_1.jar;D:\\jakarta-tomcat-4.1.9\\common\\lib\\mail.jar;D:\\jakarta-tomcat-4.1.9\\common\\lib\\naming-common.jar;D:\\jakarta-tomcat-4.1.9\\common\\lib\\naming-factory.jar;D:\\jakarta-tomcat-4.1.9\\common\\lib\\naming-resources.jar'\n    [javac] '-sourcepath'\n    [javac] 'D:\\jakarta-tomcat-4.1.9\\work\\Tomcat-ForumPass\\localhost\\forumpass'\n    [javac] '-encoding'\n    [javac] 'UTF8'\n    [javac] '-g'\n    [javac] \n    [javac] The ' characters around the executable and arguments are\n    [javac] not part of the command.\n    [javac] File to be compiled:\n    [javac]    \nD:\\jakarta-tomcat-4.1.9\\work\\Tomcat-ForumPass\\localhost\\forumpass\\netmarkets\\jsp\\netmarkets\\view_jsp.java\nD:\\jakarta-tomcat-4.1.9\\work\\Tomcat-ForumPass\\localhost\\forumpass\\netmarkets\\jsp\\netmarkets\\view_jsp.java:961:\n'else' without 'if'\n         else\n         ^\nAn error occurred at line: 264 in the jsp file: /netmarkets/jsp/util/begin.jsp\n\nGenerated servlet error:\nNote:\nD:\\jakarta-tomcat-4.1.9\\work\\Tomcat-ForumPass\\localhost\\forumpass\\netmarkets\\jsp\\netmarkets\\view_jsp.java\nuses or overrides a deprecated API.\nNote: Recompile with -deprecation for details.\n1 error\n\nTHE SOURCE JSP (a snip of begin.jsp, including the offending line 264)\n--------------\n259 <BASE HREF=\"<%=urlFactoryBean.getFullyQualifiedRequestURI()%>\"><%\n260          String ua = request.getHeader(\"User-Agent\").toLowerCase();\n261 \n262          if (ua.indexOf(\"wildfire withtrail\")>=0)\n263              %><SCRIPT LANGUAGE=\"JavaScript1.2\">var is_Wildfire=true</SCRIPT><%\n264          else\n265             %><SCRIPT LANGUAGE=\"JavaScript1.2\">var is_Wildfire=false</SCRIPT><%\n266          // include files containing CSS\n267          for (Iterator i =\npresentationBean.getData().getCssFiles().iterator(); i.hasNext(); ) {\n268             String cssFile = (String)i.next();\n269             %><LINK REL=stylesheet\nHREF=\"<%=urlFactoryBean.getHREF(cssFile)%>\" TYPE=\"text/css\"><%\n270          }\n\nTHE JASPER2 GENERATED .JAVA (a snip of **/work/**/view_jsp.java, including the\noffending line 961)\n---------------------------\n951      out.write(\"<BASE HREF=\\\"\");\n952      out.print(urlFactoryBean.getFullyQualifiedRequestURI());\n953      out.write(\"\\\">\");\n954\n955         String ua = request.getHeader(\"User-Agent\").toLowerCase();\n956\n957         if (ua.indexOf(\"wildfire withtrail\")>=0)\n958                   out.write(\"<SCRIPT LANGUAGE=\\\"JavaScript1.2\\\">var\nis_Wildfire=true\");\n959      out.write(\"</SCRIPT>\");\n960\n961         else\n962                  out.write(\"<SCRIPT LANGUAGE=\\\"JavaScript1.2\\\">var\nis_Wildfire=false\");\n963      out.write(\"</SCRIPT>\");\n964\n965         // include files containing CSS\n966         for (Iterator i =\npresentationBean.getData().getCssFiles().iterator(); i.hasNext(); ) {\n967            String cssFile = (String)i.next();\n968                  out.write(\"<LINK REL=stylesheet HREF=\\\"\");\n969      out.print(urlFactoryBean.getHREF(cssFile));\n970      out.write(\"\\\" TYPE=\\\"text/css\\\">\");\n971\n972         }\n\nTHE TOMCAT 4.0.3 GENERATED .JAVA (equivalent snip as above, minus the comments)\n--------------------------------\n                out.write(\"\\\">\\r\\n<BASE HREF=\\\"\");\n                out.print(urlFactoryBean.getFullyQualifiedRequestURI());\n                out.write(\"\\\">\");\n                \n                         String ua = request.getHeader(\"User-Agent\").toLowerCase();\n                \n                         if (ua.indexOf(\"wildfire withtrail\")>=0)\n                             \n                out.write(\"<SCRIPT LANGUAGE=\\\"JavaScript1.2\\\">var\nis_Wildfire=true</SCRIPT>\");\n                \n                         else\n\n                out.write(\"<SCRIPT LANGUAGE=\\\"JavaScript1.2\\\">var\nis_Wildfire=false</SCRIPT>\");\n\n                         // include files containing CSS\n                         for (Iterator i =\npresentationBean.getData().getCssFiles().iterator(); i.hasNext(); ) {\n                            String cssFile = (String)i.next();\n                            \n                out.write(\"<LINK REL=stylesheet HREF=\\\"\");\n                out.print(urlFactoryBean.getHREF(cssFile));\n                out.write(\"\\\" TYPE=\\\"text/css\\\">\");\n                \nI would guess by looking at the two generated .java listings that 958 and 959\nshould be enclosed in braces.\n\nPS. The performance gains of 4.1.x over 4.0.x are terrific!", "is_private": false, "id": 20943, "creator": "arjaquith@mindspring.com", "time": "2002-08-13T05:31:12Z", "bug_id": 11646, "creation_time": "2002-08-13T05:31:12Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "You need to add '{' and '}' in your scriplet IMO, unless you can point at some\npart of the spec which says the JSP container can't split constant strings. BTW,\nscriplets are evil (esp when then look like the ones in your example).", "attachment_id": null, "id": 20949, "creator": "remm@apache.org", "time": "2002-08-13T11:00:45Z", "bug_id": 11646, "creation_time": "2002-08-13T11:00:45Z", "is_private": false}, {"count": 2, "tags": [], "text": "Agreed -- scriplets are evil. I probably wouldn't do it this way myself, but\nthen this isn't my code (it is from a commercial software package).\n\nI've got no problem going back to the vendor with this issue, however I would\npoint out that this behavior does *not* manifest itself under Tomcat 4.0.x. I'll\nbet that there are other JSPs -- that don't strictly comply with the spec --\nthat will have this issue also.\n\nThanks for your prompt reply; much appreciated.", "is_private": false, "id": 20966, "creator": "arjaquith@mindspring.com", "time": "2002-08-13T15:51:16Z", "bug_id": 11646, "creation_time": "2002-08-13T15:51:16Z", "attachment_id": null}]