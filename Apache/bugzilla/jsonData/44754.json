[{"count": 0, "tags": [], "creator": "mihail.ursu@bnm.md", "attachment_id": null, "text": "=============================\nEnvironment\n=============================\nApache 2.2.6\nNovell eDirectory 8.7.3\nWindows XP Pro SP 2\n=============================\nDescription of BUG\n=============================\nServer crashes while trying to authorize user via LDAP.\n\n=============================\nHTTPD.CONF\n=============================\n\n\nThreadsPerChild 250\nMaxRequestsPerChild  0\n\n\nServerRoot \"C:/Program Files/Apache Software Foundation/Apache2.2\"\n\nListen 10.0.0.2:80\n\nLoadModule authn_alias_module modules/mod_authn_alias.so\nLoadModule authnz_ldap_module modules/mod_authnz_ldap.so\nLoadModule ldap_module modules/mod_ldap.so\nLoadModule actions_module modules/mod_actions.so\nLoadModule alias_module modules/mod_alias.so\nLoadModule asis_module modules/mod_asis.so\nLoadModule auth_basic_module modules/mod_auth_basic.so\nLoadModule auth_digest_module modules/mod_auth_digest.so\nLoadModule authn_default_module modules/mod_authn_default.so\nLoadModule authn_file_module modules/mod_authn_file.so\nLoadModule authz_default_module modules/mod_authz_default.so\nLoadModule authz_groupfile_module modules/mod_authz_groupfile.so\nLoadModule authz_host_module modules/mod_authz_host.so\nLoadModule authz_user_module modules/mod_authz_user.so\nLoadModule autoindex_module modules/mod_autoindex.so\nLoadModule cgi_module modules/mod_cgi.so\nLoadModule dir_module modules/mod_dir.so\nLoadModule env_module modules/mod_env.so\nLoadModule expires_module modules/mod_expires.so\nLoadModule headers_module modules/mod_headers.so\nLoadModule imagemap_module modules/mod_imagemap.so\nLoadModule include_module modules/mod_include.so\nLoadModule isapi_module modules/mod_isapi.so\nLoadModule log_config_module modules/mod_log_config.so\nLoadModule mime_module modules/mod_mime.so\nLoadModule negotiation_module modules/mod_negotiation.so\nLoadModule rewrite_module modules/mod_rewrite.so\nLoadModule setenvif_module modules/mod_setenvif.so\nLoadModule userdir_module modules/mod_userdir.so\nLoadModule ssl_module modules/mod_ssl.so\nLoadModule php5_module php/php5apache2_2.dll\n\tAddType application/x-httpd-php .php\n\tAddType application/x-httpd-php-source .phps\n\n\nServerAdmin mihail.ursu@example.com\nPHPIniDir \"C:/Program Files/Apache Software Foundation/Apache2.2/php\"\nServerName 10.0.0.2:80\n\nDocumentRoot \"C:/Program Files/Apache Software Foundation/Apache2.2/htdocs\"\n\n<Directory />\n    Options FollowSymLinks\n    AllowOverride None\n    Order deny,allow\n    Deny from all\n    Satisfy all\n</Directory>\n<Directory /phpmyadmin/>\n    Options FollowSymLinks\n    AllowOverride None\n    Order deny,allow\n    Deny from all\n\tAllow from All\n</Directory>\n\n<Directory \"C:/Program Files/Apache Software Foundation/Apache2.2/htdocs\">\n    Options Indexes FollowSymLinks\n\tAllowOverride All\n\tOrder allow,deny\n    Allow from all\n\t</Directory>\n\n<IfModule dir_module>\n    DirectoryIndex index.html index.php\n</IfModule>\n\n<FilesMatch \"^\\.ht\">\n    Order allow,deny\n    Deny from all\n</FilesMatch>\n\nErrorLog logs/error.log\n\nLogLevel debug\n\n<IfModule log_config_module>\n    LogFormat \"%h %l %u %t \\\"%r\\\" %>s %b \\\"%{Referer}i\\\" \\\"%{User-Agent}i\\\"\" combined\n    LogFormat \"%h %l %u %t \\\"%r\\\" %>s %b\" common\n\n    <IfModule logio_module>\n          LogFormat \"%h %l %u %t \\\"%r\\\" %>s %b \\\"%{Referer}i\\\" \\\"%{User-Agent}i\\\" %I %O\" combinedio\n    </IfModule>\n\n    \n    CustomLog logs/access.log common\n\n    \n</IfModule>\n\n<IfModule alias_module>\n    \n    ScriptAlias /cgi-bin/ \"C:/Program Files/Apache Software Foundation/Apache2.2/cgi-bin/\"\n\n</IfModule>\n\n<Directory \"C:/Program Files/Apache Software Foundation/Apache2.2/cgi-bin\">\n    AllowOverride None\n    Options None\n    Order allow,deny\n    Allow from all\n</Directory>\n\nDefaultType text/plain\n\n<IfModule mime_module>\n    AddType application/x-compress .Z\n    AddType application/x-gzip .gz .tgz\n\n</IfModule>\n\n<IfModule ssl_module>\nSSLRandomSeed startup builtin\nSSLRandomSeed connect builtin\n</IfModule>\n\n\nLDAPSharedCacheSize 200000\nLDAPCacheEntries 1024\nLDAPCacheTTL 600\nLDAPOpCacheEntries 1024\nLDAPOpCacheTTL 600\n\n<Location /ldap-status>\nSetHandler ldap-status\n</Location>\n\n<AuthnProviderAlias ldap ldap-alias1>\n\tAuthLDAPUrl ldap://10.0.0.1/ou=AUTO,o=ABC?cn\n</AuthnProviderAlias>\n\n=============================\nDocumentRoot/pula/.htaccess\n=============================\nAuthDigestProvider ldap-alias1\nAuthType Digest\nAuthName LDAP_Protected_Place\nAuthzLDAPAuthoritative off\nrequire valid-user\n\n=============================\nACCESS LOG\n=============================\n10.0.0.2 - - [04/Apr/2008:10:44:58 +0300] \"GET /pula HTTP/1.0\" 401 401\n=============================\nERROR LOG\n=============================\n[Fri Apr 04 10:44:48 2008] [info] Init: Seeding PRNG with 136 bytes of entropy\n[Fri Apr 04 10:44:48 2008] [info] Init: Generating temporary RSA private keys (512/1024 bits)\n[Fri Apr 04 10:44:48 2008] [info] Init: Generating temporary DH parameters (512/1024 bits)\n[Fri Apr 04 10:44:48 2008] [info] Init: Initializing (virtual) servers for SSL\n[Fri Apr 04 10:44:48 2008] [info] mod_ssl/2.2.6 compiled against Server: Apache/2.2.6, Library: OpenSSL/0.9.8e\n[Fri Apr 04 10:44:49 2008] [debug] util_ldap.c(1324): [2244] ldap cache: Setting shared memory  cache size to 200000 bytes.\n[Fri Apr 04 10:44:49 2008] [debug] util_ldap.c(1396): [2244] ldap cache: Setting search cache size to 1024 entries.\n[Fri Apr 04 10:44:49 2008] [debug] util_ldap.c(1372): [2244] ldap cache: Setting cache TTL to 600000000 microseconds.\n[Fri Apr 04 10:44:49 2008] [debug] util_ldap.c(1441): [2244] ldap cache: Setting operation cache size to 1024 entries.\n[Fri Apr 04 10:44:49 2008] [debug] util_ldap.c(1417): [2244] ldap cache: Setting operation cache TTL to 600000000 microseconds.\n[Fri Apr 04 10:44:49 2008] [debug] mod_authnz_ldap.c(876): [2244] auth_ldap url parse: `ldap://10.0.0.1/ou=AUTO,o=ABC?cn'\n[Fri Apr 04 10:44:49 2008] [debug] mod_authnz_ldap.c(885): [2244] auth_ldap url parse: Host:10.0.0.1\n[Fri Apr 04 10:44:49 2008] [debug] mod_authnz_ldap.c(887): [2244] auth_ldap url parse: Port: 389\n[Fri Apr 04 10:44:49 2008] [debug] mod_authnz_ldap.c(889): [2244] auth_ldap url parse: DN: ou=AUTO,o=ABC\n[Fri Apr 04 10:44:49 2008] [debug] mod_authnz_ldap.c(891): [2244] auth_ldap url parse: attrib: cn\n[Fri Apr 04 10:44:49 2008] [debug] mod_authnz_ldap.c(893): [2244] auth_ldap url parse: scope: base\n[Fri Apr 04 10:44:49 2008] [debug] mod_authnz_ldap.c(898): [2244] auth_ldap url parse: filter: (null)\n[Fri Apr 04 10:44:49 2008] [debug] mod_authnz_ldap.c(978): LDAP: auth_ldap not using SSL connections\n[Fri Apr 04 10:44:49 2008] [notice] Digest: generating secret for digest authentication ...\n[Fri Apr 04 10:44:49 2008] [notice] Digest: done\n[Fri Apr 04 10:44:49 2008] [debug] util_ldap.c(1952): LDAP merging Shared Cache conf: shm=0x716638 rmm=0x716660 for VHOST: 10.0.0.2\n[Fri Apr 04 10:44:49 2008] [info] APR LDAP: Built with Microsoft Corporation. LDAP SDK\n[Fri Apr 04 10:44:49 2008] [info] LDAP: SSL support unavailable: LDAP: CA certificates cannot be set using this method, as they are stored in the registry instead.\n[Fri Apr 04 10:44:49 2008] [info] Init: Seeding PRNG with 136 bytes of entropy\n[Fri Apr 04 10:44:49 2008] [info] Init: Generating temporary RSA private keys (512/1024 bits)\n[Fri Apr 04 10:44:49 2008] [info] Init: Generating temporary DH parameters (512/1024 bits)\n[Fri Apr 04 10:44:49 2008] [debug] ssl_scache_shmcb.c(374): shmcb_init allocated 512000 bytes of shared memory\n[Fri Apr 04 10:44:49 2008] [debug] ssl_scache_shmcb.c(554): entered shmcb_init_memory()\n[Fri Apr 04 10:44:49 2008] [debug] ssl_scache_shmcb.c(576): for 512000 bytes, recommending 4266 indexes\n[Fri Apr 04 10:44:49 2008] [debug] ssl_scache_shmcb.c(619): shmcb_init_memory choices follow\n[Fri Apr 04 10:44:49 2008] [debug] ssl_scache_shmcb.c(621): division_mask = 0x1F\n[Fri Apr 04 10:44:49 2008] [debug] ssl_scache_shmcb.c(623): division_offset = 64\n[Fri Apr 04 10:44:49 2008] [debug] ssl_scache_shmcb.c(625): division_size = 15998\n[Fri Apr 04 10:44:49 2008] [debug] ssl_scache_shmcb.c(627): queue_size = 1604\n[Fri Apr 04 10:44:49 2008] [debug] ssl_scache_shmcb.c(629): index_num = 133\n[Fri Apr 04 10:44:49 2008] [debug] ssl_scache_shmcb.c(631): index_offset = 8\n[Fri Apr 04 10:44:49 2008] [debug] ssl_scache_shmcb.c(633): index_size = 12\n[Fri Apr 04 10:44:49 2008] [debug] ssl_scache_shmcb.c(635): cache_data_offset = 8\n[Fri Apr 04 10:44:49 2008] [debug] ssl_scache_shmcb.c(637): cache_data_size = 14386\n[Fri Apr 04 10:44:49 2008] [debug] ssl_scache_shmcb.c(650): leaving shmcb_init_memory()\n[Fri Apr 04 10:44:49 2008] [info] Shared memory session cache initialised\n[Fri Apr 04 10:44:49 2008] [info] Init: Initializing (virtual) servers for SSL\n[Fri Apr 04 10:44:49 2008] [info] mod_ssl/2.2.6 compiled against Server: Apache/2.2.6, Library: OpenSSL/0.9.8e\n[Fri Apr 04 10:44:49 2008] [notice] Apache/2.2.6 (Win32) mod_ssl/2.2.6 OpenSSL/0.9.8e configured -- resuming normal operations\n[Fri Apr 04 10:44:49 2008] [notice] Server built: Sep  5 2007 08:58:56\n[Fri Apr 04 10:44:49 2008] [notice] Parent: Created child process 3500\n[Fri Apr 04 10:44:49 2008] [debug] mpm_winnt.c(487): Parent: Sent the scoreboard to the child\n[Fri Apr 04 10:44:49 2008] [info] Init: Seeding PRNG with 136 bytes of entropy\n[Fri Apr 04 10:44:49 2008] [info] Init: Generating temporary RSA private keys (512/1024 bits)\n[Fri Apr 04 10:44:50 2008] [info] Init: Generating temporary DH parameters (512/1024 bits)\n[Fri Apr 04 10:44:50 2008] [info] Init: Initializing (virtual) servers for SSL\n[Fri Apr 04 10:44:50 2008] [info] mod_ssl/2.2.6 compiled against Server: Apache/2.2.6, Library: OpenSSL/0.9.8e\n[Fri Apr 04 10:44:50 2008] [debug] util_ldap.c(1324): [3500] ldap cache: Setting shared memory  cache size to 200000 bytes.\n[Fri Apr 04 10:44:50 2008] [debug] util_ldap.c(1396): [3500] ldap cache: Setting search cache size to 1024 entries.\n[Fri Apr 04 10:44:50 2008] [debug] util_ldap.c(1372): [3500] ldap cache: Setting cache TTL to 600000000 microseconds.\n[Fri Apr 04 10:44:50 2008] [debug] util_ldap.c(1441): [3500] ldap cache: Setting operation cache size to 1024 entries.\n[Fri Apr 04 10:44:50 2008] [debug] util_ldap.c(1417): [3500] ldap cache: Setting operation cache TTL to 600000000 microseconds.\n[Fri Apr 04 10:44:50 2008] [debug] mod_authnz_ldap.c(876): [3500] auth_ldap url parse: `ldap://10.0.0.1/ou=AUTO,o=ABC?cn'\n[Fri Apr 04 10:44:50 2008] [debug] mod_authnz_ldap.c(885): [3500] auth_ldap url parse: Host:10.0.0.1\n[Fri Apr 04 10:44:50 2008] [debug] mod_authnz_ldap.c(887): [3500] auth_ldap url parse: Port: 389\n[Fri Apr 04 10:44:50 2008] [debug] mod_authnz_ldap.c(889): [3500] auth_ldap url parse: DN: ou=AUTO,o=ABC\n[Fri Apr 04 10:44:50 2008] [debug] mod_authnz_ldap.c(891): [3500] auth_ldap url parse: attrib: cn\n[Fri Apr 04 10:44:50 2008] [debug] mod_authnz_ldap.c(893): [3500] auth_ldap url parse: scope: base\n[Fri Apr 04 10:44:50 2008] [debug] mod_authnz_ldap.c(898): [3500] auth_ldap url parse: filter: (null)\n[Fri Apr 04 10:44:50 2008] [debug] mod_authnz_ldap.c(978): LDAP: auth_ldap not using SSL connections\n[Fri Apr 04 10:44:50 2008] [notice] Digest: generating secret for digest authentication ...\n[Fri Apr 04 10:44:50 2008] [notice] Digest: done\n[Fri Apr 04 10:44:50 2008] [debug] util_ldap.c(1952): LDAP merging Shared Cache conf: shm=0x714378 rmm=0x7143a0 for VHOST: 10.0.0.2\n[Fri Apr 04 10:44:50 2008] [info] APR LDAP: Built with Microsoft Corporation. LDAP SDK\n[Fri Apr 04 10:44:50 2008] [info] LDAP: SSL support unavailable: LDAP: CA certificates cannot be set using this method, as they are stored in the registry instead.\n[Fri Apr 04 10:44:50 2008] [info] Init: Seeding PRNG with 136 bytes of entropy\n[Fri Apr 04 10:44:50 2008] [info] Init: Generating temporary RSA private keys (512/1024 bits)\n[Fri Apr 04 10:44:50 2008] [info] Init: Generating temporary DH parameters (512/1024 bits)\n[Fri Apr 04 10:44:50 2008] [debug] ssl_scache_shmcb.c(374): shmcb_init allocated 512000 bytes of shared memory\n[Fri Apr 04 10:44:50 2008] [debug] ssl_scache_shmcb.c(554): entered shmcb_init_memory()\n[Fri Apr 04 10:44:50 2008] [debug] ssl_scache_shmcb.c(576): for 512000 bytes, recommending 4266 indexes\n[Fri Apr 04 10:44:50 2008] [debug] ssl_scache_shmcb.c(619): shmcb_init_memory choices follow\n[Fri Apr 04 10:44:50 2008] [debug] ssl_scache_shmcb.c(621): division_mask = 0x1F\n[Fri Apr 04 10:44:50 2008] [debug] ssl_scache_shmcb.c(623): division_offset = 64\n[Fri Apr 04 10:44:50 2008] [debug] ssl_scache_shmcb.c(625): division_size = 15998\n[Fri Apr 04 10:44:50 2008] [debug] ssl_scache_shmcb.c(627): queue_size = 1604\n[Fri Apr 04 10:44:50 2008] [debug] ssl_scache_shmcb.c(629): index_num = 133\n[Fri Apr 04 10:44:50 2008] [debug] ssl_scache_shmcb.c(631): index_offset = 8\n[Fri Apr 04 10:44:50 2008] [debug] ssl_scache_shmcb.c(633): index_size = 12\n[Fri Apr 04 10:44:50 2008] [debug] ssl_scache_shmcb.c(635): cache_data_offset = 8\n[Fri Apr 04 10:44:50 2008] [debug] ssl_scache_shmcb.c(637): cache_data_size = 14386\n[Fri Apr 04 10:44:50 2008] [debug] ssl_scache_shmcb.c(650): leaving shmcb_init_memory()\n[Fri Apr 04 10:44:50 2008] [info] Shared memory session cache initialised\n[Fri Apr 04 10:44:50 2008] [info] Init: Initializing (virtual) servers for SSL\n[Fri Apr 04 10:44:50 2008] [info] mod_ssl/2.2.6 compiled against Server: Apache/2.2.6, Library: OpenSSL/0.9.8e\n[Fri Apr 04 10:44:50 2008] [notice] Child 3500: Child process is running\n[Fri Apr 04 10:44:50 2008] [debug] mpm_winnt.c(408): Child 3500: Retrieved our scoreboard from the parent.\n[Fri Apr 04 10:44:50 2008] [info] Parent: Duplicating socket 192 and sending it to child process 3500\n[Fri Apr 04 10:44:50 2008] [info] Parent: Duplicating socket 188 and sending it to child process 3500\n[Fri Apr 04 10:44:50 2008] [debug] mpm_winnt.c(605): Parent: Sent 2 listeners to child 3500\n[Fri Apr 04 10:44:50 2008] [debug] mpm_winnt.c(564): Child 3500: retrieved 2 listeners from parent\n[Fri Apr 04 10:44:50 2008] [notice] Child 3500: Acquired the start mutex.\n[Fri Apr 04 10:44:50 2008] [notice] Child 3500: Starting 250 worker threads.\n[Fri Apr 04 10:44:50 2008] [notice] Child 3500: Starting thread to listen on port 443.\n[Fri Apr 04 10:44:50 2008] [notice] Child 3500: Starting thread to listen on port 80.\n[Fri Apr 04 10:45:16 2008] [notice] Parent: Received shutdown signal -- Shutting down the server.\n[Fri Apr 04 10:45:16 2008] [notice] Child 3500: Exit event signaled. Child process is ending.\n[Fri Apr 04 10:45:17 2008] [info] Child 3500: Accept thread exiting.\n[Fri Apr 04 10:45:17 2008] [info] Child 3500: Accept thread exiting.\n[Fri Apr 04 10:45:17 2008] [notice] Child 3500: Released the start mutex\n[Fri Apr 04 10:45:17 2008] [info] Child 3500: 249 threads blocked on the completion port\n[Fri Apr 04 10:45:18 2008] [notice] Child 3500: Waiting for 250 worker threads to exit.\n[Fri Apr 04 10:45:27 2008] [notice] Parent: Child process exited successfully.\n[Fri Apr 04 10:45:27 2008] [info] removed PID file C:/Program Files/Apache Software Foundation/Apache2.2/logs/httpd.pid (pid=2244)\nError in my_thread_global_end(): 1 threads didn't exit\n===============================================================================", "id": 115311, "time": "2008-04-04T00:52:49Z", "bug_id": 44754, "creation_time": "2008-04-04T00:52:49Z", "is_private": false}, {"count": 1, "tags": [], "creator": "mihail.ursu@bnm.md", "attachment_id": 21798, "text": "Created attachment 21798\ndrwatson report", "id": 115457, "time": "2008-04-09T05:52:40Z", "bug_id": 44754, "creation_time": "2008-04-09T05:52:40Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 44754, "text": "Created attachment 21799\ndrwatson", "id": 115458, "time": "2008-04-09T05:53:22Z", "creator": "mihail.ursu@bnm.md", "creation_time": "2008-04-09T05:53:22Z", "is_private": false, "attachment_id": 21799}, {"count": 3, "tags": [], "text": "If you can open in notepad your full dr. watson crash dump report, and save-as\nutf-8, that would be helpful.  The second attach is apparently the loaded module\nsummary and nothing else from dr. watson.\n ", "attachment_id": null, "id": 117382, "creator": "wrowe@apache.org", "time": "2008-06-05T07:56:31Z", "bug_id": 44754, "creation_time": "2008-06-05T07:56:31Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 44754, "attachment_id": null, "id": 127333, "time": "2009-05-23T14:37:53Z", "creator": "covener@gmail.com", "creation_time": "2009-05-23T14:37:53Z", "is_private": false, "text": "mod_authnz_ldap simply can't be used with AuthDigestProvider. You get an error if you use it directly, and a crash if you use it indirectly via authn_alias.\n\n*** This bug has been marked as a duplicate of bug 45196 ***"}, {"count": 5, "tags": [], "bug_id": 44754, "attachment_id": null, "id": 127335, "time": "2009-05-23T14:38:42Z", "creator": "covener@gmail.com", "creation_time": "2009-05-23T14:38:42Z", "is_private": false, "text": "meant to add that this is trapped by the authn_alias code now in 2.2.10 and later"}]