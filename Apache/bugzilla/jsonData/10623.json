[{"count": 0, "tags": [], "text": "Using mysql and FORM-authentication. I check the passwords in the DB using \njava -cp catalina.jar org.apache.catalina.realm.RealmBase -a MD5 xxxxx\nand they are correct. Still after the web application changes the passwords a\nfew times (also using the above class), tomcat will stop authenticating users.\nIf its restarted it will work againg for a while.\nUsing SHA doesn't appear to have the same problem.\nCould the org.apache.catalina.realm.RealmBase fail to correctly create the\ndigest after being used a few times?", "attachment_id": null, "bug_id": 10623, "id": 19231, "time": "2002-07-10T03:10:34Z", "creator": "ricardo@agrafo.com", "creation_time": "2002-07-10T03:10:34Z", "is_private": false}, {"text": "SHA also doesn't work.\nIt apears to be ok if I do not use any Digest.", "tags": [], "bug_id": 10623, "attachment_id": null, "count": 1, "id": 19277, "time": "2002-07-10T19:42:01Z", "creator": "ricardo@agrafo.com", "creation_time": "2002-07-10T19:42:01Z", "is_private": false}, {"count": 2, "tags": [], "creator": "ricardo@agrafo.com", "attachment_id": null, "id": 19295, "time": "2002-07-11T02:03:07Z", "bug_id": 10623, "creation_time": "2002-07-11T02:03:07Z", "is_private": false, "text": "I've finnaly sorted it out. I couldn't reproduce the problem so it was very\ndificult do figure it out. It afects JBDCRealm regardless of using a digest or not.\n\nThe problem is in org.apache.catalina.realm.JDBCRealm about line 402 in method\n\"authenticate\".\n\nThe transaction is only commited if the credentials are validated, otherwise the\nmethod returns without commiting the database transactions and thus will be\nunaware of changes made to the database.\n\nIf a user forgets its password and a new one is inserted into the database, he\nwill never be able to login, unless someone else logs in, thus commiting the\ntransaction and making the changes visible to JDBCRealm.\n\nAparently tomcat uses two instances of JDBCRealm, so one has to insert a wrong\npassword twice, and them update the password in the database, in order to\nreproduce the problem.\n\nThis seems very easy to solve. Wope it can be fixed for the next tomcat release.\nThanks. Keep up the excelent work."}, {"count": 3, "tags": [], "creator": "danpayne00@yahoo.com", "attachment_id": 6448, "id": 37568, "time": "2003-05-21T22:35:17Z", "bug_id": 10623, "creation_time": "2003-05-21T22:35:17Z", "is_private": false, "text": "Created attachment 6448\nShould be an adequate fix to the bug. File is the modified JDBCRealm.java source file."}, {"count": 4, "tags": [], "creator": "funkman@joedog.org", "attachment_id": null, "is_private": false, "id": 43297, "time": "2003-08-26T01:14:40Z", "bug_id": 10623, "creation_time": "2003-08-26T01:14:40Z", "text": "Fixed for tomcat5 - please confirm with HEAD of tomcat 5 (or when 5.0.10 is\navailable). Upon confirmation - will backport to tomcat 4.1 Will not port to\ntomcat 4.0.\n"}]