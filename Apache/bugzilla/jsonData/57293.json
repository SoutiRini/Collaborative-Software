[{"count": 0, "tags": [], "creator": "lheadley@kcptech.com", "attachment_id": null, "text": "given file prep.js with contents:\nhi\n\nand the following build.xml\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project name=\"abc\" default=\"build\">\n  <target name=\"build\">\n    <replaceregexp file=\"./prep.js\"\n                   match=\"(.*)\"\n                   replace=\"\\(abcd\\)\"/>\n  </target>\n\n</project>\n\nrunning \"ant\" results in prep.js containing:\n(abcd)\n\nrather than the expected:\n\\(abcd\\)\n\nWe ran into this bug in a production system using replaceregexp to insert the contents of one file into another. This method is widely recommended on the webs and will fail for any file containing, e.g. a regular expression matching a parenthesis (e.g. the javascript /\\(/).", "id": 179416, "time": "2014-12-01T18:45:22Z", "bug_id": 57293, "creation_time": "2014-12-01T18:45:22Z", "is_private": false}, {"count": 1, "tags": [], "creator": "jan@materne.de", "attachment_id": null, "text": "The problem is that the \\ starts a backreference (like \\1) so it must be quotet.\nFour slashes ...\n\nThis one works for me:\n\n    <target name=\"testMatching_Bug57293\">\n        <mkdir dir=\"${output}\"/>\n        <echo file=\"${output}/text.txt\">Hello, world!</echo>\n        <replaceregexp match=\"(\\w*)\" replace=\"\\\\\\\\(abcd\\\\\\\\)\">\n          <file file=\"${output}/text.txt\"/>\n        </replaceregexp>\n        <au:assertResourceContains\n           resource=\"${output}/text.txt\" value=\"\\(abcd\\), world!\"/>\n    </target>", "id": 179434, "time": "2014-12-02T07:51:51Z", "bug_id": 57293, "creation_time": "2014-12-02T07:51:51Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 57293, "attachment_id": null, "id": 179452, "time": "2014-12-02T17:17:03Z", "creator": "lheadley@kcptech.com", "creation_time": "2014-12-02T17:17:03Z", "is_private": false, "text": "I am now thinking this should simply be mentioned in the documentation, as various people are using replaceregexp (in combination with loadfile) to insert files into other files, and I don't see any awareness of this issue among them."}]