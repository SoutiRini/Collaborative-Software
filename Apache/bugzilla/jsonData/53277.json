[{"count": 0, "tags": [], "bug_id": 53277, "text": "The HashTree class currently uses a HashMap to store test elements.\n\nNow a HashMap cannot store two Objects which compare equal and have the same hash code. Test elements currently use the system hash code, so collisions are unlikely; however they are not impossible. It's quite easy to create multiple test elements which compare equal.\n\nSo there is a risk that a new element which is added to the HashTree could displace an existing entry.\n\nOne solution to this is to use IdentityHashMap instead of HashMap; this uses == rather than equals when comparing elements.", "id": 159245, "time": "2012-05-22T22:32:09Z", "creator": "sebb@apache.org", "creation_time": "2012-05-22T22:32:09Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 53277, "text": "Unfortunately, this causes unit test failures in\n\nPackageTest.testEqualsAndHashCode1()\nPackageTest.testEqualsAndHashCode2()\n\nIt looks like supporting HashTree equality will need additional work.\nSo for now at least we probably have to accept the theoretical risk of a hash code and equals collision.", "id": 159246, "time": "2012-05-22T22:40:12Z", "creator": "sebb@apache.org", "creation_time": "2012-05-22T22:40:12Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 53277, "text": "Hi,\n\nI think I just ran into this bug, proving it is not only theoretical. Th exception I got looks like:\n\n2012/06/19 14:56:30 ERROR - jmeter.JMeter: Error in NonGUIDriver java.lang.NullPointerException\n        at org.apache.jorphan.collections.HashTree.traverseInto(HashTree.java:975)\n        at org.apache.jorphan.collections.HashTree.traverseInto(HashTree.java:975)\n        at org.apache.jorphan.collections.HashTree.traverse(HashTree.java:959)\n        at org.apache.jmeter.engine.StandardJMeterEngine.configure(StandardJMeterEngine.java:176)\n        at org.apache.jmeter.JMeter.runNonGui(JMeter.java:778)\n        at org.apache.jmeter.JMeter.startNonGui(JMeter.java:716)\n        at org.apache.jmeter.JMeter.start(JMeter.java:377)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.apache.jmeter.NewDriver.main(NewDriver.java:216)\n\nThis was caused by two identical Include-Controllers on the main (and same) level of a thread group. After I moved the second Include-Controller one level up, as a child of a Simple Controller, the problem was solved. Not sure but it can be related to the usage of HashMap. Just one funny remark, I only got this NullPointerException when running jmeter with the -n option.", "id": 160098, "time": "2012-06-19T13:32:36Z", "creator": "geert-jan.willemse@ericsson.com", "creation_time": "2012-06-19T13:32:36Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 53277, "text": "Which version of JMeter were you using?\n\nI think you have hit Bug 50898 which is fixed in 2.7.\n\n[It's unlikely that this bug will cause an NPE]\n\nThe behaviour in non-GUI mode is likely different because in GUI mode there are  additional variables that affect the hash code.", "id": 160100, "time": "2012-06-19T14:43:08Z", "creator": "sebb@apache.org", "creation_time": "2012-06-19T14:43:08Z", "is_private": false, "attachment_id": null}]