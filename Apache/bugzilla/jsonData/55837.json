[{"count": 0, "tags": [], "creator": "oschina.net@gmail.com", "attachment_id": null, "id": 171541, "time": "2013-12-03T08:03:13Z", "bug_id": 55837, "creation_time": "2013-12-03T08:03:13Z", "is_private": false, "text": "[code]\nString path = servletContext.getRealPath('/test');\n\nif no file or folder named '/test' exist in webroot \nthen path return null\n\nbut int tomcat 5\\6\\7, it will return the correct value , ex /data/oschina/webapp/test"}, {"count": 1, "tags": [], "creator": "chuck.caldarale@unisys.com", "text": "(In reply to oschina.net from comment #0)\n> if no file or folder named '/test' exist in webroot \n> then path return null\n\nThe container is under no obligation to return anything other than null for getRealPath().  Read the doc for the API:\n\n\"This method returns null if the servlet container cannot translate the virtual path to a real path for any reason (such as when the content is being made available from a .war archive).\"", "id": 171544, "time": "2013-12-03T12:45:25Z", "bug_id": 55837, "creation_time": "2013-12-03T12:45:25Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 55837, "attachment_id": null, "text": "(In reply to Chuck Caldarale from comment #1)\n> (In reply to oschina.net from comment #0)\n> > if no file or folder named '/test' exist in webroot \n> > then path return null\n> \n> The container is under no obligation to return anything other than null for\n> getRealPath().  Read the doc for the API:\n> \n> \"This method returns null if the servlet container cannot translate the\n> virtual path to a real path for any reason (such as when the content is\n> being made available from a .war archive).\"\n\nbut in same condition\uff0ctomcat 7 & 8 return different value (not .war archive)", "id": 171547, "time": "2013-12-03T14:51:17Z", "creator": "oschina.net@gmail.com", "creation_time": "2013-12-03T14:51:17Z", "is_private": false}, {"count": 3, "attachment_id": null, "bug_id": 55837, "text": "The short version is that this should return a file (that doesn't exist) in this case.\n\nThe long version is that this is just about defined in the Servlet specification but only tenuously.\n\nThe use of virtual path and real path in the Javadoc ServletContext.getRealPath() and HttpServletRequest.getPathTranslated() suggests strongly that they have the same meanings in both cases.\n\nHttpServletRequest.getPathTranslated() states it has the \"Same as the\nvalue of the CGI variable PATH_TRANSLATED\". A little googling lead me to\nRFC 3875. While that is not a formal standard, it does define 'current\npractice' which is as good as you are ever going to get for CGI.\n\nSection 4.1.6 of RFC 3875 addresses PATH_TRANSLATED. At the top of page\n15 about half way through section 4.1.6 there is the following text:\n\"The value is derived in this way irrespective of whether it maps to a\n valid repository location.\"\n\nTherefore a real path doesn't have to exist.\n\nTherefore getRealPath() doesn't can return a file that doesn't exist.\n\nFinally, there is nothing I could see in the spec that prevents getRealPath() returning a valid file even if that file does not exist.\n\nGiven I had to dig into this for the Servlet EG I'm surprised that Tomcat 8 is doing the wrong thing. Probably an oversight on my part. I'll take a look.", "id": 171557, "time": "2013-12-04T12:22:55Z", "creator": "markt@apache.org", "creation_time": "2013-12-04T12:22:55Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "creator": "markt@apache.org", "text": "Thanks for the report. This has been fixed in 8.0.x and will be included in 8.0.0-RC6 onwards.", "id": 171565, "time": "2013-12-04T17:19:07Z", "bug_id": 55837, "creation_time": "2013-12-04T17:19:07Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "chris@christopherschultz.net", "text": "Here come the complaints that getRealPath returns bogus paths...", "id": 171624, "time": "2013-12-07T05:38:28Z", "bug_id": 55837, "creation_time": "2013-12-07T05:38:28Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 55837, "text": "Should the method return the CanonicalPath or AbsolutePath?\n\nI used this method in Tomcat 4 and it returned AbsolutePath and now I found that it returns CanonicalPath which means the I couldn't locate my file anymore due to symbolic link is used for my docBase.", "count": 6, "id": 173345, "time": "2014-02-19T01:16:04Z", "creator": "patrick.mi@touchpoint.co.nz", "creation_time": "2014-02-19T01:16:04Z", "is_private": false}, {"count": 7, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 173349, "time": "2014-02-19T09:07:07Z", "bug_id": 55837, "creation_time": "2014-02-19T09:07:07Z", "is_private": false, "text": "(In reply to Patrick Mi from comment #6)\n> Should the method return the CanonicalPath or AbsolutePath?\n> \n> I used this method in Tomcat 4 and it returned AbsolutePath and now I found\n> that it returns CanonicalPath which means the I couldn't locate my file\n> anymore due to symbolic link is used for my docBase.\n\nBugzilla is not a support forum. Please use the Apache Tomcat users' mailing list."}, {"count": 8, "tags": [], "creator": "mitch.tux@gmail.com", "attachment_id": null, "id": 174598, "time": "2014-04-15T15:06:11Z", "bug_id": 55837, "creation_time": "2014-04-15T15:06:11Z", "is_private": false, "text": "(In reply to Mark Thomas from comment #4)\n> Thanks for the report. This has been fixed in 8.0.x and will be included in\n> 8.0.0-RC6 onwards.\n\nI'm still seeing this in 8.0.5. Could I get an update?"}, {"count": 9, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 174631, "time": "2014-04-16T13:37:37Z", "bug_id": 55837, "creation_time": "2014-04-16T13:37:37Z", "is_private": false, "text": "(In reply to Mitch Kyle from comment #8)\n> (In reply to Mark Thomas from comment #4)\n> > Thanks for the report. This has been fixed in 8.0.x and will be included in\n> > 8.0.0-RC6 onwards.\n> \n> I'm still seeing this in 8.0.5. Could I get an update?\n\nIt was fixed in 8.0.0-RC6 and is still fixed in 8.0.x. Please use the users mailing list if you need further help."}, {"attachment_id": null, "tags": [], "bug_id": 55837, "text": "Just tested this in 8.0.3\n\n      log.info(\"Path3: \"+request.getRealPath(\"/\")); // Works\n      log.info(\"Path4: \"+request.getRealPath(\"\\\\\")); // returns null!!\n      log.info(\"Path2: \"+request.getRealPath(File.separator));\n\nSecond version returns null - however was working fine in Tomcat 7.\nThird version works on Unix, fails on Windows (for obvious reasons, but documenting it as a variation).\n\nIndependent of whether it should be fixed or not - I am just adding the comment for future reference (someone else will stumble on it eventually).", "count": 10, "id": 179472, "time": "2014-12-03T00:17:24Z", "creator": "jo_desmet@yahoo.com", "creation_time": "2014-12-03T00:17:24Z", "is_private": false}]