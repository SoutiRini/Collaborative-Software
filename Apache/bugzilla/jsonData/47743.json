[{"count": 0, "tags": [], "bug_id": 47743, "attachment_id": null, "is_private": false, "id": 129958, "time": "2009-08-26T09:04:13Z", "creator": "minfrin@sharp.fm", "creation_time": "2009-08-26T09:04:13Z", "text": "On server startup, mod_so segfaults as follows:\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x007a7c93 in ap_find_loaded_module_symbol (s=0x9338a40, modname=0x93400b1 \"mod_imagechef.c\") at /usr/src/debug/httpd-2.2.3/modules/mappers/mod_so.c:340\n340 modie = (ap_module_symbol_t *)sconf->loaded_modules->elts;\n(gdb) bt full\n#0 0x007a7c93 in ap_find_loaded_module_symbol (s=0x9338a40, modname=0x93400b1 \"mod_imagechef.c\") at /usr/src/debug/httpd-2.2.3/modules/mappers/mod_so.c:340\ni = <value optimized out> \n\nThe code that explodes looks like this:\n\nstatic module *ap_find_loaded_module_symbol(server_rec *s, const char *modname)\n{\n    so_server_conf *sconf;\n    ap_module_symbol_t *modi;\n    ap_module_symbol_t *modie;\n    int i;\n\n    sconf = (so_server_conf *)ap_get_module_config(s->module_config,\n                                                   &so_module);\n    modie = (ap_module_symbol_t *)sconf->loaded_modules->elts;\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n    for (i = 0; i < sconf->loaded_modules->nelts; i++) {\n        modi = &modie[i];\n        if (modi->name != NULL && strcmp(modi->name, modname) == 0) {\n            return modi->modp;\n        }\n    }\n    return NULL;\n}\n\nCurrently, the suspicion is that a module compiled for v2.2.12 is being installed in v2.2.3, but this should either work, or give an error, it shouldn't segfault."}, {"attachment_id": null, "tags": [], "bug_id": 47743, "is_private": false, "count": 1, "id": 129965, "time": "2009-08-26T12:33:43Z", "creator": "rpluem@apache.org", "creation_time": "2009-08-26T12:33:43Z", "text": "What are the values of sconf and sconf->loaded_modules?"}, {"count": 2, "tags": [], "text": "sconf seems valid, but sconf->loaded_modules is NULL.\n\nI am struggling to convince gdb to tell me the address of sconf->loaded_modules when the sconf is created so I can set a watchpoint, gdb keeps telling me the variable soc in so_sconf_create() doesn't exist.", "attachment_id": null, "bug_id": 47743, "id": 129992, "time": "2009-08-27T09:41:15Z", "creator": "minfrin@sharp.fm", "creation_time": "2009-08-27T09:41:15Z", "is_private": false}]