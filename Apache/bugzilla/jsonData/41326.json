[{"count": 0, "tags": [], "creator": "Juergen.Busch@sew-eurodrive.de", "text": "I'm runnig apache2.2.3, Win 2003 as reverse proxy , mod_rewrite; mod_proxy; \nmod_security\nThe MaxRequestPerChild directive is set to 250, evertyhing is running smoothly, \nhttpd.exe is recycling  frequently\nAfter a certain load i  an an error in the eventlog:\nFaulting application httpd.exe, version 2.2.3.0, faulting module libhttpd.dll, \nversion 2.2.3.0, fault address 0x0001e440.\nFrom that time on httpd.exe is growing 10-20 Mbyte per Minute and i have to \nrestart apache service.\n1. Question what cause the error message and what cause the memory leak", "id": 97801, "time": "2007-01-08T23:43:20Z", "bug_id": 41326, "creation_time": "2007-01-08T23:43:20Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 41326, "is_private": false, "text": "\"Faulting application httpd.exe, version 2.2.3.0, faulting module libhttpd.dll, \nversion 2.2.3.0, fault address 0x0001e440.\"\n\nNeed to see your dr. watson backtrace, please?", "id": 97802, "time": "2007-01-09T00:14:13Z", "creator": "wrowe@apache.org", "creation_time": "2007-01-09T00:14:13Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "Juergen.Busch@sew-eurodrive.de", "text": "o.k here is error.log\n\n[Tue Jan 09 08:26:26 2007] [notice] mod_security/1.9.4 configured\n[Tue Jan 09 08:26:27 2007] [notice] Child 444: Child process is running\n[Tue Jan 09 08:26:27 2007] [notice] Child 444: Acquired the start mutex.\n[Tue Jan 09 08:26:27 2007] [notice] Child 444: Starting 250 worker threads.\n[Tue Jan 09 08:26:27 2007] [notice] Child 444: Starting thread to listen on \nport 443.\n[Tue Jan 09 08:26:27 2007] [notice] Child 444: Starting thread to listen on \nport 80.\n[Tue Jan 09 08:29:25 2007] [notice] Child 3032: Terminating 1 threads that \nfailed to exit.", "id": 97811, "time": "2007-01-09T02:45:20Z", "bug_id": 41326, "creation_time": "2007-01-09T02:45:20Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 41326, "attachment_id": null, "text": "[Tue Jan 09 08:26:26 2007] [notice] mod_security/1.9.4 configured\n[Tue Jan 09 08:26:27 2007] [notice] Child 444: Child process is running\n[Tue Jan 09 08:26:27 2007] [notice] Child 444: Acquired the start mutex.\n[Tue Jan 09 08:26:27 2007] [notice] Child 444: Starting 250 worker threads.\n[Tue Jan 09 08:26:27 2007] [notice] Child 444: Starting thread to listen on \nport 443.\n[Tue Jan 09 08:26:27 2007] [notice] Child 444: Starting thread to listen on \nport 80.\n[Tue Jan 09 08:29:25 2007] [notice] Child 3032: Terminating 1 threads that \nfailed to exit.", "id": 97813, "time": "2007-01-09T03:46:14Z", "creator": "Juergen.Busch@sew-eurodrive.de", "creation_time": "2007-01-09T03:46:14Z", "is_private": false}, {"count": 4, "tags": [], "creator": "Juergen.Busch@sew-eurodrive.de", "text": "Are there any known problems with hyperthreading an apache ?\nErrorLog:\n\n[Tue Jan 09 20:50:53 2007] [notice] Child 4896: Process exiting because it \nreached MaxRequestsPerChild. Signaling the parent to restart a new child \nprocess.\n[Tue Jan 09 20:50:53 2007] [notice] Parent: Received restart signal -- \nRestarting the server.\n[Tue Jan 09 20:50:54 2007] [notice] Apache/2.2.3 (Win32) mod_ssl/2.2.3 \nOpenSSL/0.9.8d configured -- resuming normal operations\n[Tue Jan 09 20:50:54 2007] [notice] Server built: Sep 28 2006 21:57:41\n[Tue Jan 09 20:50:54 2007] [notice] Parent: Created child process 4808\nWarning: DocumentRoot [C:/www/docs/dummy-host.example.com] does not exist\nWarning: DocumentRoot [C:/www/docs/dummy-host2.example.com] does not exist\n[Tue Jan 09 20:50:54 2007] [notice] Child 4896: Released the start mutex\n[Tue Jan 09 20:50:55 2007] [notice] mod_security/1.9.4 configured\n[Tue Jan 09 20:50:55 2007] [notice] Child 4896: Waiting for 250 worker threads \nto exit.\n[Tue Jan 09 20:50:56 2007] [notice] Child 4808: Child process is running\n[Tue Jan 09 20:50:56 2007] [notice] Child 4808: Acquired the start mutex.\n[Tue Jan 09 20:50:56 2007] [notice] Child 4808: Starting 250 worker threads.\n[Tue Jan 09 20:50:56 2007] [notice] Child 4808: Starting thread to listen on \nport 443.\n[Tue Jan 09 20:50:56 2007] [notice] Child 4808: Starting thread to listen on \nport 80.\n[Tue Jan 09 20:53:55 2007] [notice] Child 4896: Terminating 1 threads that \nfailed to exit.\n[Wed Jan 10 07:26:23 2007] [notice] Parent: Received restart signal -- \nRestarting the server.\nWarning: DocumentRoot [C:/www/docs/dummy-host.example.com] does not exist\nWarning: DocumentRoot [C:/www/docs/dummy-host2.example.com] does not exist\n[Wed Jan 10 07:26:23 2007] [notice] Child 4808: Exit event signaled. Child \nprocess is ending.\n[Wed Jan 10 07:26:24 2007] [notice] Apache/2.2.3 (Win32) mod_ssl/2.2.3 \nOpenSSL/0.9.8d configured -- resuming normal operations\n[Wed Jan 10 07:26:24 2007] [notice] Server built: Sep 28 2006 21:57:41\n[Wed Jan 10 07:26:24 2007] [notice] Parent: Created child process 2764\nWarning: DocumentRoot [C:/www/docs/dummy-host.example.com] does not exist\nWarning: DocumentRoot [C:/www/docs/dummy-host2.example.com] does not exist\n[Wed Jan 10 07:26:25 2007] [notice] mod_security/1.9.4 configured\n[Wed Jan 10 07:26:25 2007] [notice] Child 4808: Waiting for 249 worker threads \nto exit.\n[Wed Jan 10 07:26:25 2007] [crit] [Wed Jan 10 07:26:25 2007] \nfile .\\\\server\\\\mpm\\\\winnt\\\\child.c, line 1120, assertion \"(rv >= 0) && (rv < \nthreads_created)\" failed\n[Wed Jan 10 07:26:26 2007] [notice] Child 2764: Child process is running\n[Wed Jan 10 07:26:26 2007] [notice] Child 2764: Acquired the start mutex.\n[Wed Jan 10 07:26:26 2007] [notice] Child 2764: Starting 250 worker threads.\n[Wed Jan 10 07:26:26 2007] [notice] Child 2764: Starting thread to listen on \nport 443.\n[Wed Jan 10 07:26:26 2007] [notice] Child 2764: Starting thread to listen on \nport 80.\n", "id": 97859, "time": "2007-01-09T22:45:01Z", "bug_id": 41326, "creation_time": "2007-01-09T22:45:01Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "text": "I met the same issue. anyone can help on this?\n\n[Fri May 18 01:32:41 2007] [notice] Disabled use of AcceptEx() WinSock2 API\n[Fri May 18 01:32:41 2007] [notice] Child 2928: Child process is running\n[Fri May 18 01:32:42 2007] [notice] Child 1324: Released the start mutex\n[Fri May 18 01:32:42 2007] [notice] Child 2928: Acquired the start mutex.\n[Fri May 18 01:32:42 2007] [notice] Child 2928: Starting 100 worker threads.\n[Fri May 18 01:32:42 2007] [notice] Child 1324: Waiting for 100 worker threads\nto exit.\n[Fri May 18 01:32:42 2007] [notice] Child 2928: Listening on port 80.\n[Fri May 18 01:32:46 2007] [notice] Child 1324: All worker threads have exited.\n[Fri May 18 01:32:46 2007] [notice] Child 1324: Child process is exiting\n[Fri May 18 01:36:50 2007] [notice] Child 2928: Process exiting because it\nreached MaxRequestsPerChild. Signaling the parent to restart a new child process.\n[Fri May 18 01:36:50 2007] [notice] Parent: Received restart signal --\nRestarting the server.\n[Fri May 18 01:36:50 2007] [notice] Apache/2.2.4 (Win32) configured -- resuming\nnormal operations\n[Fri May 18 01:36:50 2007] [notice] Server built: Jan  9 2007 23:17:20\n[Fri May 18 01:36:50 2007] [notice] Parent: Created child process 4056\n[Fri May 18 01:36:50 2007] [notice] Disabled use of AcceptEx() WinSock2 API\n[Fri May 18 01:36:50 2007] [notice] Child 4056: Child process is running\n[Fri May 18 01:36:51 2007] [notice] Child 2928: Released the start mutex\n[Fri May 18 01:36:51 2007] [notice] Child 4056: Acquired the start mutex.\n[Fri May 18 01:36:51 2007] [notice] Child 4056: Starting 100 worker threads.\n[Fri May 18 01:36:51 2007] [notice] Child 2928: Waiting for 100 worker threads\nto exit.\n[Fri May 18 01:36:51 2007] [notice] Child 4056: Listening on port 80.\n[Fri May 18 01:36:55 2007] [notice] Child 2928: All worker threads have exited.\n[Fri May 18 01:36:55 2007] [notice] Child 2928: Child process is exiting\n[Fri May 18 01:40:34 2007] [notice] Child 4056: Process exiting because it\nreached MaxRequestsPerChild. Signaling the parent to restart a new child process.\n[Fri May 18 01:40:34 2007] [notice] Parent: Received restart signal --\nRestarting the server.\n[Fri May 18 01:40:34 2007] [notice] Apache/2.2.4 (Win32) configured -- resuming\nnormal operations\n[Fri May 18 01:40:34 2007] [notice] Server built: Jan  9 2007 23:17:20\n[Fri May 18 01:40:34 2007] [notice] Parent: Created child process 800\n[Fri May 18 01:40:34 2007] [notice] Disabled use of AcceptEx() WinSock2 API\n[Fri May 18 01:40:34 2007] [notice] Child 800: Child process is running\n[Fri May 18 01:40:35 2007] [notice] Child 4056: Released the start mutex\n[Fri May 18 01:40:35 2007] [notice] Child 800: Acquired the start mutex.\n[Fri May 18 01:40:35 2007] [notice] Child 800: Starting 100 worker threads.\n[Fri May 18 01:40:35 2007] [notice] Child 4056: Waiting for 100 worker threads\nto exit.\n[Fri May 18 01:40:35 2007] [notice] Child 800: Listening on port 80.\n[Fri May 18 01:43:35 2007] [notice] Child 4056: Terminating 1 threads that\nfailed to exit.\n\n\n\nEvent Type:\tError\nEvent Source:\tApplication Error\nEvent Category:\t(100)\nEvent ID:\t1000\nDate:\t\t2007-5-18\nTime:\t\t1:43:39\nUser:\t\tN/A\nComputer:\tPIANYIBA\nDescription:\nFaulting application httpd.exe, version 2.2.4.0, faulting module libhttpd.dll,\nversion 2.2.4.0, fault address 0x0001c9ca.\n\nFor more information, see Help and Support Center at\nhttp://go.microsoft.com/fwlink/events.asp.\nData:\n0000: 41 70 70 6c 69 63 61 74   Applicat\n0008: 69 6f 6e 20 46 61 69 6c   ion Fail\n0010: 75 72 65 20 20 68 74 74   ure  htt\n0018: 70 64 2e 65 78 65 20 32   pd.exe 2\n0020: 2e 32 2e 34 2e 30 20 69   .2.4.0 i\n0028: 6e 20 6c 69 62 68 74 74   n libhtt\n0030: 70 64 2e 64 6c 6c 20 32   pd.dll 2\n0038: 2e 32 2e 34 2e 30 20 61   .2.4.0 a\n0040: 74 20 6f 66 66 73 65 74   t offset\n0048: 20 30 30 30 31 63 39 63    0001c9c\n0050: 61                        a     ", "attachment_id": null, "bug_id": 41326, "id": 103320, "time": "2007-05-17T15:58:54Z", "creator": "shuiqing.li@gmail.com", "creation_time": "2007-05-17T15:58:54Z", "is_private": false}, {"count": 6, "tags": [], "text": "reassign...", "attachment_id": null, "bug_id": 41326, "id": 103322, "time": "2007-05-17T16:52:28Z", "creator": "shuiqing.li@gmail.com", "creation_time": "2007-05-17T16:52:28Z", "is_private": false}, {"count": 7, "tags": [], "creator": "wrowe@apache.org", "attachment_id": null, "is_private": false, "id": 103351, "time": "2007-05-18T11:57:42Z", "bug_id": 41326, "creation_time": "2007-05-18T11:57:42Z", "text": "The -backtrace- I refer to is spelled out at\n\nhttp://httpd.apache.org/dev/debugging.html#backtrace-win\n\nnote you don't want the 'live' backtrace, but the faulted backtrace from the\ncrash (immediately before the runaway memory problem)\n\nWhat your oodles of information do -not- convey is which thread crashed\n(there will be a FAULT >>> comment next to the offending bytecode) and the\nbacktrace of which function called which function called which function which\nthen faulted.  *that's* what we want to see to help you further."}, {"count": 8, "tags": [], "creator": "greg.stump@hsc.utah.edu", "text": "I have generated a backtrace following the instructions posted at \nhttp://httpd.apache.org/dev/debugging.html#backtrace-win and have the \ndrwtsn32.log file, as well as, the user.dmp file.  I'm interested in this \ntopic because our organization's Apache 2.2.4 installations on Windows 2003 \nserver are setup similar to what is described above and having similar \nproblems, what exactly are we seeking in the backtrace?  It is nearly 2 MB in \nsize.\n\n(In reply to comment #7)\n> The -backtrace- I refer to is spelled out at\n> http://httpd.apache.org/dev/debugging.html#backtrace-win\n> note you don't want the 'live' backtrace, but the faulted backtrace from the\n> crash (immediately before the runaway memory problem)\n> What your oodles of information do -not- convey is which thread crashed\n> (there will be a FAULT >>> comment next to the offending bytecode) and the\n> backtrace of which function called which function called which function which\n> then faulted.  *that's* what we want to see to help you further.\n\n", "id": 106312, "time": "2007-08-03T15:16:56Z", "bug_id": 41326, "creation_time": "2007-08-03T15:16:56Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 41326, "attachment_id": null, "text": "I did find one \"FAULT ->\" entry in the drwtsn32.log file at the very bottom of \nall the data.  I will include this 'state dump for thread' section below.  The \nmemory problem we are experiencing does not cause a crash until eventually all \nthe available RAM is used.  The process memory simply continues growing as \ndynamic requests come in from the time the service starts until it can grow no \nlarger.\n\nTherefore getting a faulted backtrace from immediately before the runaway \nmemory problem occurs may not be possible as far as I can tell.  Here is the \nstate dump section but I'm not sure if it's what is needed:\n\n*----> State Dump for Thread Id 0x6f0 <----*\n\neax=7ffd7000 ebx=00000001 ecx=00000002 edx=00000003 esi=00000004 edi=00000005\neip=7c81a3e1 esp=08a0ffcc ebp=08a0fff4 iopl=0         nv up ei pl zr na po nc\ncs=001b  ss=0023  ds=0023  es=0023  fs=0038  gs=0000             efl=00000246\n\nfunction: ntdll!DbgBreakPoint\n        7c81a3ca f00fc11e         lock    xadd [esi],ebx\n        7c81a3ce 43               inc     ebx\n        7c81a3cf 83fbff           cmp     ebx,0xffffffff\n        7c81a3d2 0f85db2e0200     jne     ntdll!RtlLockHeap+0x28e (7c83d2b3)\n        7c81a3d8 5e               pop     esi\n        7c81a3d9 5b               pop     ebx\n        7c81a3da 33c0             xor     eax,eax\n        7c81a3dc 5f               pop     edi\n        7c81a3dd 5d               pop     ebp\n        7c81a3de c20400           ret     0x4\nFAULT ->ntdll!DbgBreakPoint:\n7c81a3e1 cc               int     3\n        7c81a3e2 c3               ret\n        7c81a3e3 90               nop\n        7c81a3e4 8bff             mov     edi,edi\n        ntdll!DbgUserBreakPoint:\n        7c81a3e6 cc               int     3\n        7c81a3e7 c3               ret\n        7c81a3e8 8bff             mov     edi,edi\n        7c81a3ea 8b442404         mov     eax,[esp+0x4]\n        7c81a3ee cc               int     3\n        7c81a3ef c20400           ret     0x4\n\n*----> Stack Back Trace <----*\nChildEBP RetAddr  Args to Child              \n08a0fff4 00000000 00000000 00000000 00000000 ntdll!DbgBreakPoint\n\n*----> Raw Stack Dump <----*\n0000000008a0ffcc  d8 fd 83 7c 05 00 00 00 - 04 00 00 00 01 00 00 \n00  ...|............\n0000000008a0ffdc  d0 ff a0 08 f8 8c 17 b6 - ff ff ff ff 70 82 82 \n7c  ............p..|\n0000000008a0ffec  f0 fd 83 7c 00 00 00 00 - 00 00 00 00 00 00 00 \n00  ...|............\n0000000008a0fffc  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 \n00  ................\n0000000008a1000c  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 \n00  ................\n0000000008a1001c  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 \n00  ................\n0000000008a1002c  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 \n00  ................\n0000000008a1003c  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 \n00  ................\n0000000008a1004c  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 \n00  ................\n0000000008a1005c  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 \n00  ................\n0000000008a1006c  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 \n00  ................\n0000000008a1007c  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 \n00  ................\n0000000008a1008c  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 \n00  ................\n0000000008a1009c  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 \n00  ................\n0000000008a100ac  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 \n00  ................\n0000000008a100bc  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 \n00  ................\n0000000008a100cc  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 \n00  ................\n0000000008a100dc  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 \n00  ................\n0000000008a100ec  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 \n00  ................\n0000000008a100fc  00 00 00 00 00 00 00 00 - 00 00 00 00 00 00 00 \n00  ................\n\n", "id": 106406, "time": "2007-08-06T13:18:33Z", "creator": "greg.stump@hsc.utah.edu", "creation_time": "2007-08-06T13:18:33Z", "is_private": false}, {"count": 10, "tags": [], "creator": "wrowe@apache.org", "text": "It's still not the backtrace of that specific thread (and yes, that's exactly\nthe thread we were interested in!)\n\nUnfortunately\n\n*----> Stack Back Trace <----*\nChildEBP RetAddr  Args to Child              \n08a0fff4 00000000 00000000 00000000 00000000 ntdll!DbgBreakPoint\n\nstill doesn't give us enough to go on, because you should have a series of \nnested functions where this fault occured, and this has no backtrace.\n\nFYI - I did not mean for you to interrupt the server while running well, but\nto let it crash once you have dr watson configured.  It should then make you\na dr watson log at the point of failure.", "id": 112332, "time": "2007-12-30T23:04:11Z", "bug_id": 41326, "creation_time": "2007-12-30T23:04:11Z", "is_private": false, "attachment_id": null}, {"count": 11, "tags": [], "creator": "wrowe@apache.org", "text": "Insufficient information provided to diagnose; closing.", "id": 117407, "time": "2008-06-05T13:27:17Z", "bug_id": 41326, "creation_time": "2008-06-05T13:27:17Z", "is_private": false, "attachment_id": null}]