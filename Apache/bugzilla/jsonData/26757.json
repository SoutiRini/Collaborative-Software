[{"count": 0, "tags": [], "bug_id": 26757, "attachment_id": null, "is_private": false, "id": 51876, "time": "2004-02-07T14:59:59Z", "creator": "eric.jain@gmail.com", "creation_time": "2004-02-07T14:59:59Z", "text": "Using the sshexec task in the following way causes the specified command to be \nexecuted, but after that the task hangs and never returns.\n\n  <sshexec\n    host=\"${host}\"\n    username=\"${user}\"\n    password=\"${pass}\"\n    trust=\"yes\"\n    command=\"ls\"\n  />\n\nTried both jsch 0.1.9 and the latest release, 0.1.13.\n\nRunning 'ssh user@host ls' from the command line works fine. \n\nSeems to have been observed by someone else as well: \nhttp://marc.theaimsgroup.com/?l=ant-user&m=106442868402154&w=2\n\nscp, on the other hand, seems to be working fine."}, {"count": 1, "tags": [], "text": "I am also seeing this bug.  Using the following snippet...\n\t  <echo>Creating dir\n${global.deploy.machinename}:${global.deploy.target.dir}</echo>\n\t  <sshexec host=\"${global.deploy.machinename}\"\n\t\t  username=\"${global.deploy.remote.user}\"\n\t\t  trust=\"true\"\n\t\t  password=\"${global.deploy.remote.password}\"\n\t\t  command=\"perl -ver\"\n\t\t  timeout=\"60000\" />\n\t  <echo>finished with perl</echo>\n\nFor us it seems to work against a sun solaris box but fails when trying to\nconnect to f-secure sshd service running on w2k.  Our client box is a w2k box\nrunning ant 1.6.1\n\nThe behavior is that it returns output for the command, but hangs there until\nthe timeout is exceeded and then it fails.", "attachment_id": null, "id": 54204, "creator": "glee@ebay.com", "time": "2004-03-18T08:25:56Z", "bug_id": 26757, "creation_time": "2004-03-18T08:25:56Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 26757, "attachment_id": null, "id": 54235, "time": "2004-03-18T18:38:02Z", "creator": "riznob@hotmail.com", "creation_time": "2004-03-18T18:38:02Z", "is_private": false, "text": "This is probably a bug in the jsch code, not the Ant task."}, {"count": 3, "tags": [], "bug_id": 26757, "attachment_id": null, "is_private": false, "id": 59106, "time": "2004-06-11T14:22:18Z", "creator": "jan-schroeder@gmx.net", "creation_time": "2004-06-11T14:22:18Z", "text": "according to the developer of jsch this is not a jsch bug.\nHere is his email:\n\nHi,\n\nThis is not a bug of jsch. That comes from the usage of jsch by Ant.\nJSch allows you to run simultaneously multiple exec channels on\nthe single ssh session.  I guess that, in that problem, ssh session has \nbeen kept and sshexec task should explicitly disconnect that \nsession at the end of exec operation.\n\n\nThanks,\n--\nymnk"}, {"count": 4, "tags": [], "bug_id": 26757, "attachment_id": 11829, "id": 59120, "time": "2004-06-11T16:46:53Z", "creator": "riznob@hotmail.com", "creation_time": "2004-06-11T16:46:53Z", "is_private": false, "text": "Created attachment 11829\nPatch to disconnect session explicitely when done"}, {"attachment_id": 11830, "tags": [], "creator": "riznob@hotmail.com", "is_private": false, "count": 5, "id": 59121, "time": "2004-06-11T16:47:10Z", "bug_id": 26757, "creation_time": "2004-06-11T16:47:10Z", "text": "Created attachment 11830\nPatch to disconnect session explicitely when done"}, {"count": 6, "tags": [], "creator": "riznob@hotmail.com", "attachment_id": null, "text": "Please test the attached patch. I just added after line 199...\n\nsession.disconnect();\n\n\nNote: Both patches are the same. I accidentilly hit the refresh button in my \nbrowser after attaching the patch, so it uploaded it again.", "id": 59122, "time": "2004-06-11T16:51:01Z", "bug_id": 26757, "creation_time": "2004-06-11T16:51:01Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 26757, "text": "this did not fix it. Task never reaches the disconnect() method.\nI played some with jsch and believe it is indeed a jsch problem. Contacted jsch\nmaintainer with a fix.", "count": 7, "id": 59132, "time": "2004-06-11T19:25:03Z", "creator": "jan-schroeder@gmx.net", "creation_time": "2004-06-11T19:25:03Z", "is_private": false}, {"attachment_id": 13688, "tags": [], "creator": "gregharris73@yahoo.com", "is_private": false, "count": 8, "id": 68142, "time": "2004-12-08T23:50:33Z", "bug_id": 26757, "creation_time": "2004-12-08T23:50:33Z", "text": "Created attachment 13688\nit's a fix to use for JSCH, not ANT!! \n\nI have fixed this myself using the source for JSCH.  However, I'm not\ncompletely sure whether or not what I did is the absolute right way it should\nbehave, but I'm assuming it is.  The problem with SSHExec in ANT is that it is\nwaiting for Channel.isEOF(), but the channel never says it's done.  The Session\nobject has a case statement in the run() method for different SSH replies from\nthe server, in my case at least:\n\nSSH_MSG_CHANNEL_CLOSE:\n@ Line: 1043 says channel.disconnect() but this method never does anything\nabout making  eof=true; or Channel.eof(); (what ant is waiting for).\n\nAlso seems environmental, I do not have the problem on a Solaris Box using:\n\nOpenSSH_3.7.1p1, SSH protocols 1.5/2.0, OpenSSL 0.9.7c 30 Sep 2003\n\nbut do have it using an otherwise identicle box using:\n\nssh: SSH Secure Shell 3.2.5 (non-commercial version) on sparc-sun-solaris2.8\n\nWe also don't have this problem on all our linux boxes, also using OpenSSH. \nHope that's helpful to someone and I'll send this on to folks at JCraft to see\nwhat they say."}, {"count": 9, "tags": [], "bug_id": 26757, "attachment_id": null, "is_private": false, "id": 72213, "time": "2005-03-11T17:08:00Z", "creator": "bodewig@apache.org", "creation_time": "2005-03-11T17:08:00Z", "text": "It probably doesn't hurt to disconnect in Ant anyway, even if it doesn't help\nin this case."}, {"count": 10, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "text": "fixed as good as we can from within Ant.", "id": 72329, "time": "2005-03-14T10:03:08Z", "bug_id": 26757, "creation_time": "2005-03-14T10:03:08Z", "is_private": false}]