[{"count": 0, "tags": [], "bug_id": 52219, "attachment_id": null, "text": "My Test File\n\nimport java.io.FileOutputStream;\nimport java.io.IOException;\n\nimport org.apache.poi.ss.usermodel.CreationHelper;\nimport org.apache.poi.ss.usermodel.Drawing;\nimport org.apache.poi.ss.usermodel.Sheet;\nimport org.apache.poi.ss.usermodel.Workbook;\nimport org.apache.poi.xssf.usermodel.XSSFClientAnchor;\nimport org.apache.poi.xssf.usermodel.XSSFColor;\nimport org.apache.poi.xssf.usermodel.XSSFDrawing;\nimport org.apache.poi.xssf.usermodel.XSSFFont;\nimport org.apache.poi.xssf.usermodel.XSSFRichTextString;\nimport org.apache.poi.xssf.usermodel.XSSFWorkbook;\nimport org.apache.poi.xssf.usermodel.XSSFTextBox;\n\npublic class TestXSSFTextBox{\n\tpublic static void main(String[] args) throws IOException{\n\t\tWorkbook wb = new XSSFWorkbook();\n\t\tSheet sheet=wb.createSheet();\n\t\tDrawing drawing2 =sheet.createDrawingPatriarch();\n\t\tCreationHelper helper = wb.getCreationHelper();\n\t\tXSSFClientAnchor a1 = (XSSFClientAnchor) helper.createClientAnchor();\n\t    a1.setRow1(0);\n\t    a1.setRow2(5);\n\t    a1.setCol1(0);\n\t    a1.setCol2(5);\n\t    \n\t    XSSFTextBox textbox2 =((XSSFDrawing) drawing2).createTextbox(a1);\n\t    XSSFRichTextString str = new XSSFRichTextString(\"Fontcolor is white!You can not reset it!\");\n\t    XSSFFont font = (XSSFFont) wb.createFont();\n\t    XSSFColor col=new XSSFColor(new java.awt.Color(0, 0, 255));\n\t    font.setColor(col);\n\t    font.setItalic(true);\n\t    font.setFontName(\"sss\");\n\t    font.setBold(true);\n\t    str.applyFont(font);\n\t    textbox2.setText(str);\n\t    textbox2.setNoFill(true);\n\t    \n\t    String file = \"c:\\\\111.xlsx\";\n\t\tFileOutputStream fileOut = new FileOutputStream(file);\n\t\ttry{\n\t\t\twb.write(fileOut);\n\t\t}finally{\n\t\t\tfileOut.close();\n\t\t}\n\t}\n}", "id": 151681, "time": "2011-11-21T05:02:32Z", "creator": "wangxujiajia@126.com", "creation_time": "2011-11-21T05:02:32Z", "is_private": false}, {"count": 1, "tags": [], "creator": "yegor@dinom.ru", "is_private": false, "text": "It was a bug in XSSF: setting font color and size had no effect because not all text attributes were copied to xml. \n\nShould be fixed in r1220642.\n\n\nRegards,\nYegor", "id": 152281, "time": "2011-12-19T08:27:15Z", "bug_id": 52219, "creation_time": "2011-12-19T08:27:15Z", "attachment_id": null}]