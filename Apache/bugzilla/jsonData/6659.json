[{"count": 0, "tags": [], "creator": "drew.cox@epredix.com", "attachment_id": null, "id": 11122, "creation_time": "2002-02-25T18:08:44Z", "time": "2002-02-25T18:08:44Z", "bug_id": 6659, "text": "We have a \"Invalid URL\" error page that is forwarded to using the\n<error-code> and <exception-type> elements of the web.xml.\n\nOn that page we use the HttpUtils.getRequestURL (req) call to get the\n(invalid) requested URL for display.  Under Tomcat 3.3a this works fine,\nunder tomcat 4.0.2 this give the URL of the error page itself.\n\nI understand the entire HttpUtils class is deprecated under the Servlet 2.3\nspec.  And the replacement call HttpServletRequest.getRequestURL() appears\nto work fine on 4.0.2.  But it would be great for our migration strategy is\nthe deprecated call functioned the same.", "is_private": false}, {"count": 1, "tags": [], "bug_id": 6659, "attachment_id": null, "id": 17403, "time": "2002-06-07T14:55:04Z", "creator": "bob@jadn.com", "creation_time": "2002-06-07T14:55:04Z", "is_private": false, "text": "\nSo... Does it make sence to just change the method \n\n\tHttpUtils.getRequestURL( request )\n\nso that it simply has 1 line,\n\n\treturn request.getRequestURL() \n\nSince HttpServletRequest.getRequestURL() returns the correct answer?\n\nI implemented this and tested it for me. and it seems to work just fine.\n\nie, this patch...\nIndex: jakarta-servletapi-4/src/share/javax/servlet/http/HttpUtils.java\n===================================================================\nRCS file:\n/home/cvspublic/jakarta-servletapi-4/src/share/javax/servlet/http/HttpUtils.java,v\nretrieving revision 1.1.1.1\ndiff -u -r1.1.1.1 HttpUtils.java\n--- jakarta-servletapi-4/src/share/javax/servlet/http/HttpUtils.java    9 Jan\n2001 03:24:20 -0000       1.1.1.1\n+++ jakarta-servletapi-4/src/share/javax/servlet/http/HttpUtils.java    7 Jun\n2002 14:47:19 -0000\n@@ -324,28 +324,7 @@\n      */\n \n     public static StringBuffer getRequestURL (HttpServletRequest req) {\n-       StringBuffer url = new StringBuffer ();\n-       String scheme = req.getScheme ();\n-       int port = req.getServerPort ();\n-       String urlPath = req.getRequestURI();\n-\n-       //String                servletPath = req.getServletPath ();\n-       //String                pathInfo = req.getPathInfo ();\n-\n-       url.append (scheme);            // http, https\n-       url.append (\"://\");\n-       url.append (req.getServerName ());\n-       if ((scheme.equals (\"http\") && port != 80)\n-               || (scheme.equals (\"https\") && port != 443)) {\n-           url.append (':');\n-           url.append (req.getServerPort ());\n-       }\n-       //if (servletPath != null)\n-       //    url.append (servletPath);\n-       //if (pathInfo != null)\n-       //    url.append (pathInfo);\n-       url.append(urlPath);\n-       return url;\n+       return req.getRequestURL();\n     }\n }\n"}, {"count": 2, "tags": [], "creator": "funkman@joedog.org", "attachment_id": null, "is_private": false, "id": 51866, "time": "2004-02-07T14:40:16Z", "bug_id": 6659, "creation_time": "2004-02-07T14:40:16Z", "text": "Based on the writeup, this appears to be a bug/change in the implementation of\nHttpUtils. HttpUtils lives under javax.sun.*. Because of this, tomcat team is\nnot allowed to make this change. A change would need to go through Sun's servlet\nfeedback.\n"}]