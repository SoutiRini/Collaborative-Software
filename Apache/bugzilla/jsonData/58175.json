[{"count": 0, "tags": [], "text": "Created attachment 32934\nSample program\n\nWhen adding a comment to a specific cell using Cell.setCellComment(), it seems like it's corrupting the .xlsx file. Excel shows a message explaining that the content is not readable, and removes the comment in section \"/xl/comments1.xml\"\n\nTo reproduce the problem I used the snippet available at https://poi.apache.org/spreadsheet/quick-guide.html#CellComments. The full source to reproduce the problem is attached down below.\n\nBy the tests I have made, it only happens with SXSSF and Microsoft Excel. If I use XSSF (Non-streamed) or HSSF, the message is not displayed in Excel. Also, if opening the \"corrupted\" .xlsx with LibreOffice, no message is shown and the comment is displayed correctly.\n\nAlso, this behaviour started since we updated from version 3.9 to version 3.12 to fix some problems we had with images, and in version 3.9 it works perfetly. I also tested it in version 3.13-beta1-20150723 and the problem persists. I did not test in 3.10 and 3.11\n\nApache POI full version: poi-3.12-20150511\nMicrosoft Excel version: Microsoft Excel 2010 (14.0.7153.5000) SP2 MSO", "attachment_id": 32934, "bug_id": 58175, "id": 184152, "time": "2015-07-23T18:58:19Z", "creator": "nicolas@rech.com.br", "creation_time": "2015-07-23T18:58:19Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 58175, "attachment_id": null, "text": "This sounds related to bug 57571, can you try the workaround posted there.", "id": 184153, "time": "2015-07-23T20:46:38Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-07-23T20:46:38Z", "is_private": false}, {"count": 2, "tags": [], "text": "This seems to have been caused by changes for bug 54920, we need to find out how to solve this for both cases...", "attachment_id": null, "bug_id": 58175, "id": 184154, "time": "2015-07-24T07:14:56Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-07-24T07:14:56Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 58175, "attachment_id": null, "text": "I guess I missed that bug. The workaround specified there works fine for me, seems like both bugs are the same", "id": 184159, "time": "2015-07-24T11:05:22Z", "creator": "nicolas@rech.com.br", "creation_time": "2015-07-24T11:05:22Z", "is_private": false}, {"count": 4, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "id": 184161, "time": "2015-07-24T12:03:30Z", "bug_id": 58175, "creation_time": "2015-07-24T12:03:30Z", "is_private": false, "text": "This is now fixed again via r1692483, it was a regression that was introduced in 2013 as part of fixing Bug 54920."}]