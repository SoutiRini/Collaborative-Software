[{"count": 0, "tags": [], "bug_id": 29835, "attachment_id": null, "id": 59965, "time": "2004-06-28T06:05:12Z", "creator": "w.fukushima@pfu.fujitsu.com", "creation_time": "2004-06-28T06:05:12Z", "is_private": false, "text": "I'm using log4j 1.2.8 on Windows XP.\nI'd like to achieve automatic-old-log-deletion when the log rolls over.\n\nI have made a subclass of DailyRollingFileAppender and have had two problems.\n\nProblem1)rollOver() is package private method in DailyRollingFileAppender, so\nthat I have to override subAppend(), which is not smart way to sense a rollover\ntiming.\n\nProblem2)one of my subclass's constructor is look like this:\n\n  public AutomaticallyRemovingDailyRollingFileAppender\n    (Layout layout, String filename, String datePattern)\n  throws IOException {\n    super(layout, filename, datePattern);\n  }\n\nWhen a client code calls this constructor like this:\n\n  AutomaticallyRemovingDailyRollingFileAppender appender\n    = new AutomaticallyRemovingDailyRollingFileAppender(\n      new PatternLayout(), // appropriate\n      \"log.txt\",           // also appropriate\n      \"hogehoge\"           // not appropriate as date pattern string\n    );\n\n  DailyRollingFileAppender's constructor calls its super class's constructor,\nwhich results to open the specified file, and then\nDailyRollingFileAppender#activateOptions() try to invoke\nSimpleDateFormat#format() with specified date pattern ( i.e. \"hoge\" in this\nexample). The format() method throws IllegalArgumentException, so that\nDailyRollingFileAppender's constructor throws IllegalArgumentException. This\nmeans that\n\nA) The client code can not get a AutomaticallyRemovingDailyRollingFileAppender's\ninstance.\nB) The log file is opend, even though there is no way to close it.\n\n\nThese are very annoying problems. My suggestion is:\n\nAnswerForProblem1) Change accessibility of rollOver() to protected.\n\nAnswerForProblem2) Insert an error handling code for closing the log file in\nDailyRollingFileAppender's constructor, or check whether the specified date\npattern is valid or not."}, {"attachment_id": null, "tags": [], "creator": "yoavs@computer.org", "text": "Check out log4j 1.3's new RollingPolicy and related classes.  They solve your \nproblem #1 directly and should make resolution of the other one significantly \neasier.", "count": 1, "id": 68570, "time": "2004-12-15T16:29:34Z", "bug_id": 29835, "creation_time": "2004-12-15T16:29:34Z", "is_private": false}]