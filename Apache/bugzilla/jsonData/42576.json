[{"count": 0, "tags": [], "bug_id": 42576, "attachment_id": null, "is_private": false, "id": 104025, "time": "2007-06-04T03:25:06Z", "creator": "v8emtdstg529g9b@jetable.org", "creation_time": "2007-06-04T03:25:06Z", "text": "The force-page-count does not work as expected for the end-on-odd and\nend-on-even values.\n\nAs a side effect, the initial-page-number does not work either, as the\nimplementation uses force-page-count to simulate its effect.\n\nThere are two bugs-in-one here:\n- The first page does not respect the force-page-count attribute\n- Intermediate (ie. not first nor last) page-sequence erroneously implement the\nend-on-* values by breaking at the first page, resulting in a first page being\nempty, and the flow being shifted to the 2nd page.\n\nThe attached FO file, modified from the FAQ, demonstrates the issue. This file\nspecifies a document that should render 3 short page-sequence as follows:\n- Page sequence 1 should be 2 pages: 1 first page with text, 1 blank page\n- Page sequence 2 should be 2 pages: 1 first page with text, 1 blank page\n- Page sequence 3 should be 2 pages: 1 first page with text, 1 blank page\n\nFOP renders instead:\n- Page sequence 1 is 1 page: 1 first page with text\n- Page sequence 2 is 2 pages: 1 first page empty, 1 page with text\n- Page sequence 3 is 3 pages: 1 first page empty, 1 page with text, 1 blank page\n\nNote that the three page-sequence are strictly identical, and should therefore\nbe rendered exactly the same."}, {"count": 1, "tags": [], "creator": "v8emtdstg529g9b@jetable.org", "attachment_id": null, "id": 104026, "time": "2007-06-04T03:28:07Z", "bug_id": 42576, "creation_time": "2007-06-04T03:28:07Z", "is_private": false, "text": "Sample.fo that demonstrates the bug:\n\n\n\n<?xml version=\"1.0\"?>\n<fo:root xmlns:fo=\"http://www.w3.org/1999/XSL/Format\">\n  <fo:layout-master-set>\n\n    <fo:simple-page-master master-name=\"first\"\n      page-height=\"297mm\" page-width=\"210mm\"\n      margin-top=\"20mm\" margin-bottom=\"20mm\"\n      margin-left=\"25mm\" margin-right=\"25mm\">\n      <fo:region-body margin-bottom=\"20mm\"/>\n      <fo:region-before region-name=\"header-normal\" extent=\"10mm\"/>\n      <fo:region-after region-name=\"footer-normal\" extent=\"10mm\"/>\n    </fo:simple-page-master>\n\n    <fo:simple-page-master master-name=\"normal\"\n      page-height=\"297mm\" page-width=\"210mm\"\n      margin-top=\"20mm\" margin-bottom=\"20mm\"\n      margin-left=\"25mm\" margin-right=\"25mm\">\n      <fo:region-body margin-bottom=\"20mm\"/>\n      <fo:region-after region-name=\"footer-normal\" extent=\"10mm\"/>\n    </fo:simple-page-master>\n\n    <fo:simple-page-master master-name=\"blank\"\n      page-height=\"297mm\" page-width=\"210mm\"\n      margin-top=\"20mm\" margin-bottom=\"20mm\"\n      margin-left=\"25mm\" margin-right=\"25mm\">\n      <fo:region-body/>\n      <fo:region-before region-name=\"header-blank\" extent=\"297mm\"/>\n    </fo:simple-page-master>\n\n    <fo:page-sequence-master master-name=\"document\">\n\n      <fo:single-page-master-reference master-reference=\"first\"/>\n\n      <fo:repeatable-page-master-alternatives>\n        <fo:conditional-page-master-reference blank-or-not-blank=\"not-blank\"\n          master-reference=\"normal\"/>\n        <fo:conditional-page-master-reference blank-or-not-blank=\"blank\"\n          master-reference=\"blank\"/>\n      </fo:repeatable-page-master-alternatives>\n\n    </fo:page-sequence-master>\n  </fo:layout-master-set>\n\n  <fo:page-sequence master-reference=\"document\" force-page-count=\"end-on-even\">\n    <fo:static-content flow-name=\"footer-normal\">\n      <fo:block text-align=\"center\">Normal footer</fo:block>\n    </fo:static-content>\n    <fo:static-content flow-name=\"header-normal\">\n      <fo:block text-align=\"center\">FIRST PAGE OF SEQUENCE</fo:block>\n    </fo:static-content>\n    <fo:static-content flow-name=\"header-blank\">\n      <fo:block space-before=\"100mm\" text-align-last=\"center\">\n        Intentionally left blank.</fo:block>\n    </fo:static-content>\n    <fo:flow flow-name=\"xsl-region-body\">\n      <fo:block>\n\tTEST\n      </fo:block>\n    </fo:flow>\n  </fo:page-sequence>\n\n  <fo:page-sequence master-reference=\"document\" force-page-count=\"end-on-even\">\n    <fo:static-content flow-name=\"footer-normal\">\n      <fo:block text-align=\"center\">Normal footer</fo:block>\n    </fo:static-content>\n    <fo:static-content flow-name=\"header-normal\">\n      <fo:block text-align=\"center\">FIRST PAGE OF SEQUENCE</fo:block>\n    </fo:static-content>\n    <fo:static-content flow-name=\"header-blank\">\n      <fo:block space-before=\"100mm\" text-align-last=\"center\">\n        Intentionally left blank.</fo:block>\n    </fo:static-content>\n    <fo:flow flow-name=\"xsl-region-body\">\n      <fo:block>\n\tTEST\n      </fo:block>\n    </fo:flow>\n  </fo:page-sequence>\n\n  <fo:page-sequence master-reference=\"document\" force-page-count=\"end-on-even\">\n    <fo:static-content flow-name=\"footer-normal\">\n      <fo:block text-align=\"center\">Normal footer</fo:block>\n    </fo:static-content>\n    <fo:static-content flow-name=\"header-normal\">\n      <fo:block text-align=\"center\">FIRST PAGE OF SEQUENCE</fo:block>\n    </fo:static-content>\n    <fo:static-content flow-name=\"header-blank\">\n      <fo:block space-before=\"100mm\" text-align-last=\"center\">\n        Intentionally left blank.</fo:block>\n    </fo:static-content>\n    <fo:flow flow-name=\"xsl-region-body\">\n      <fo:block>\n\tTEST\n      </fo:block>\n    </fo:flow>\n  </fo:page-sequence>\n\n</fo:root>\n"}, {"count": 2, "text": "Created attachment 20321\npatch file to fix page sequence master sequencing bug\n\nThis patch also includes some log bracing on the Files that required\nmodification, i.e.\n\nlog.trace(\"blah\");\n\nbecomes...\n\nif (log.isTraceEnabled()) {\n    log.trace(\"blah\");\n}\n\nThe problem as I saw it was that the subsequence position of the page sequence\nmaster was being reset prior to the completion of processing the current\nsequence.  I have tested the fix with the sample FO you provided and also\ncarried out some of my own tests and I believe this now fixes the problem.\n\nAdrian.", "creator": "dev@cumiskey.com", "attachment_id": 20321, "id": 104168, "time": "2007-06-07T05:16:21Z", "bug_id": 42576, "creation_time": "2007-06-07T05:16:21Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 42576, "attachment_id": null, "id": 104170, "time": "2007-06-07T07:54:54Z", "creator": "bowditch_chris@hotmail.com", "creation_time": "2007-06-07T07:54:54Z", "is_private": false, "text": "Thanks for the Patch Adrian!"}, {"count": 4, "tags": [], "text": "I applied the patch, and tested it on a bigger sample (some specific and larger\ndocuments I am working on), and it fixes the bug correctly (tested on PDF and\nPCL output).\n\nThanks a lot !\n", "is_private": false, "id": 104171, "creator": "v8emtdstg529g9b@jetable.org", "time": "2007-06-07T07:55:56Z", "bug_id": 42576, "creation_time": "2007-06-07T07:55:56Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 42576, "attachment_id": 20380, "id": 104594, "time": "2007-06-21T06:47:43Z", "creator": "dev@cumiskey.com", "creation_time": "2007-06-21T06:47:43Z", "is_private": false, "text": "Created attachment 20380\nxml unit test\n\nxml unit test to verify this bug fix."}, {"count": 6, "tags": [], "text": "Patch Applied - Thanks Adrian!", "attachment_id": null, "id": 104626, "creator": "bowditch_chris@hotmail.com", "time": "2007-06-22T03:27:08Z", "bug_id": 42576, "creation_time": "2007-06-22T03:27:08Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 42576, "attachment_id": null, "is_private": false, "id": 155906, "time": "2012-04-01T06:47:54Z", "creator": "gadams@apache.org", "creation_time": "2012-04-01T06:47:54Z", "text": "batch transition pre-FOP1.0 resolved+fixed bugs to closed+fixed"}]