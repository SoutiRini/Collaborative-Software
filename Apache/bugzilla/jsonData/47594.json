[{"count": 0, "tags": [], "bug_id": 47594, "text": "The method TextShape.resizeToFitText() calculates a height that is too small for the TextShape if the text contains many lines.\nI tried poi-versions from 3.1 to 3.5 and java-versions from 1.4 to 1.6\n\n\nSample Code:\n\nSlideShow ppt = new SlideShow();\nSlide slide = ppt.createSlide();\nTextBox txtBox = new TextBox();\nslide.addShape(txtBox);\ntxtBox.setLineColor(Color.BLACK);\ntxtBox.setText(\"Line One\\nLine Two\\nThree\\nFour\\nFive\\nSix\\nSeven\\Eight\");\ntxtBox.resizeToFitText();\n    \nFileOutputStream out = new FileOutputStream(\"test.ppt\");\nppt.write(out);\nout.close();", "id": 129200, "time": "2009-07-28T05:27:37Z", "creator": "f_bullitt@yahoo.de", "creation_time": "2009-07-28T05:27:37Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "There's code in TextShape.resizeToFitText() that appears to handle the height stuff in a way I'd expect to work.\n\nCould it be a font issue? Can you confirm that the font that your text is using really is present (and available to java!) on the machine where you're running your poi code? Also, if you try changing the font, does the height mismatch change, or is at say always out by ~10%?", "id": 129201, "time": "2009-07-28T05:54:50Z", "bug_id": 47594, "creation_time": "2009-07-28T05:54:50Z", "is_private": false}, {"count": 2, "tags": [], "text": "The font I use is arial.ttf and it is present and available to Java.\n\nBut as you said, I tested two other fonts (times.ttf and kartika.ttf) and with these two fonts, the height seems to be calculated correctly.\nUnfortunately I have to use arial in the PPT.", "attachment_id": null, "id": 129204, "creator": "f_bullitt@yahoo.de", "time": "2009-07-28T06:35:29Z", "bug_id": 47594, "creation_time": "2009-07-28T06:35:29Z", "is_private": false}, {"count": 3, "tags": [], "creator": "f_bullitt@yahoo.de", "attachment_id": null, "text": "By the way, in the RichTextRun I set setBold(true).\nI tried the Windows-Font arialbd.ttf and now the calculation of height works correctly!\nMaybe the normal arial.ttf does not really work with bold.\n\nSo I don't know if this is still a bug.\n\nThank you.", "id": 129211, "time": "2009-07-28T06:54:36Z", "bug_id": 47594, "creation_time": "2009-07-28T06:54:36Z", "is_private": false}, {"count": 4, "tags": [], "text": "No progress and discussion indicates that it likely is related to the actual font that is used and the font-file that is installed on the machine. There hopefully were some fixes in newer versions of Java which make this work better, so I am resolving this for now as there is likely not much we can do here unless someone comes up with a patch.", "attachment_id": null, "id": 183943, "creator": "dominik.stadler@gmx.at", "time": "2015-07-07T20:03:59Z", "bug_id": 47594, "creation_time": "2015-07-07T20:03:59Z", "is_private": false}]