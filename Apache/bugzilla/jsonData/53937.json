[{"count": 0, "tags": [], "bug_id": 53937, "text": "Created attachment 29422\nBug Fix for the double apr_pool_destroy()\n\nWhen OCSP checking is enabled, the code checks the OCSP server. If the OCSP server is contacted everything goes fine. However if the OCSP server cannot be contacted, this leads to a double apr_pool_destroy() that crashes the thread, can lead to TOMCAT crash. The problem exists in \nstatic int ssl_ocsp_request(X509 *cert, X509 *issuer);\n\nand the problem exists in the following code:\n\n    if (ocsp_urls != NULL) {\n        OCSP_RESPONSE *resp;\n        /* for the time being just check for the fist response .. a better                                                                                    \n           approach is to iterate for all the possible ocsp urls */\n        resp = get_ocsp_response(cert, issuer, ocsp_urls[0]);\n\n        apr_pool_destroy(p);\n        if (resp != NULL)\n            return process_ocsp_response(resp);\n    }\n    apr_pool_destroy(p);\n    return OCSP_STATUS_UNKNOWN;\n}\n\nIf get_ocsp_response returns NULL, then apr_pool_destroy(p) is called twice.\n\nI believe that this should also affect 1.1.23\n\nA bug fix is included in the attached patch", "id": 162423, "time": "2012-09-26T16:40:19Z", "creator": "arisg@noc.edunet.gr", "creation_time": "2012-09-26T16:40:19Z", "is_private": false, "attachment_id": 29422}, {"count": 1, "tags": [], "creator": "chris@christopherschultz.net", "attachment_id": null, "is_private": false, "id": 168792, "time": "2013-07-25T21:01:43Z", "bug_id": 53937, "creation_time": "2013-07-25T21:01:43Z", "text": "Fixed in 1.1 branch. Will be available in 1.1.28."}]