[{"count": 0, "tags": [], "creator": "midha.rakesh@gmail.com", "attachment_id": null, "id": 93199, "time": "2006-09-08T09:38:25Z", "bug_id": 40443, "creation_time": "2006-09-08T09:38:25Z", "is_private": false, "text": "Executing import usecase doesn't work because of missing missing nodetype in\nregistry. \n\n{http://apache.org/cocoon/lenya/page-envelope/1.0}contentNode\n\norg.apache.cocoon.ProcessingException: Error calling continuation at\nfile:/C:/marquis1/Lenya1.4_3108/lenya-1.4.x/build/lenya/webapp/lenya/usecases/usecases.js:263:-1\nat <map:call> -\nfile:/C:/marquis1/Lenya1.4_3108/lenya-1.4.x/build/lenya/webapp/lenya/usecases/usecase.xmap:97:39\nat <map:mount> -\nfile:/C:/marquis1/Lenya1.4_3108/lenya-1.4.x/build/lenya/webapp/lenya/usecase.xmap:56:128\nat <map:mount> -\nfile:/C:/marquis1/Lenya1.4_3108/lenya-1.4.x/build/lenya/webapp/global-sitemap.xmap:309:105\nat <map:mount> -\nfile:/C:/marquis1/Lenya1.4_3108/lenya-1.4.x/build/lenya/webapp/sitemap.xmap:668:106\n\ncause: javax.jcr.nodetype.NoSuchNodeTypeException:\n{http://apache.org/cocoon/lenya/page-envelope/1.0}contentNode\n\njavax.jcr.nodetype.NoSuchNodeTypeException:\n{http://apache.org/cocoon/lenya/page-envelope/1.0}contentNode\n\tat\norg.apache.jackrabbit.core.nodetype.NodeTypeRegistry.getEffectiveNodeType(NodeTypeRegistry.java:829)\n\tat\norg.apache.jackrabbit.core.nodetype.NodeTypeManagerImpl.getNodeType(NodeTypeManagerImpl.java:159)\n\tat org.apache.jackrabbit.core.NodeImpl.addMixin(NodeImpl.java:967)\n\tat org.apache.jackrabbit.core.NodeImpl.addMixin(NodeImpl.java:2420)\n\tat\norg.apache.lenya.cms.jcr.LenyaJCRSourceFactory.createFileNode(LenyaJCRSourceFactory.java:34)\n\tat\norg.apache.cocoon.jcr.source.JCRNodeSource.getOutputStream(JCRNodeSource.java:387)\n\tat org.apache.lenya.cms.cocoon.source.SourceUtil.copy(SourceUtil.java:76)\n\tat org.apache.lenya.cms.cocoon.source.SourceUtil.copy(SourceUtil.java:118)\n\tat org.apache.lenya.cms.cocoon.source.SourceUtil.copy(SourceUtil.java:137)\n\tat org.apache.lenya.cms.jcr.usecases.Import.doExecute(Import.java:91)\n\nLooks like the problem is caused after removal of  some code in LenyaRepository.java\n\nThis code is commented...which was actually registering nodetype CONTENT_NODE\n\n        /*\n        if (!registry.isRegistered(new QName( LenyaMetaData.NAMESPACE,\nCONTENT_NODE))) {\n           \n            List propDefs = new ArrayList();\n            Map key2namespace = new HashMap();\n\n            String[] lenyaKeys = LenyaMetaData.ELEMENTS;\n            for (int i = 0; i < lenyaKeys.length; i++) {\n                key2namespace.put(lenyaKeys[i], LenyaMetaData.NAMESPACE);\n            }\n\n            List dcKeyList = DublinCoreImpl.getAttributeNames ();\n            String[] dcKeys = (String[]) dcKeyList.toArray(new\nString[dcKeyList.size()]);\n            for (int i = 0; i < dcKeys.length; i++) {\n                key2namespace.put(dcKeys[i], DublinCore.DC_NAMESPACE );\n            }\n\n            NodeTypeDef def = new NodeTypeDef();\n            def.setMixin(true);\n            def.setName(new QName(LenyaMetaData.NAMESPACE, CONTENT_NODE));\n\n            for (Iterator i = key2namespace.keySet().iterator(); i.hasNext();) {\n                String key = (String) i.next();\n                String namespace = (String) key2namespace.get(key);\n                PropDefImpl propDef = new PropDefImpl();\n                propDef.setDeclaringNodeType(def.getName());\n                propDef.setName(new QName(namespace, key));\n                propDef.setMandatory(false);\n                propDef.setRequiredType(PropertyType.STRING );\n                propDef.setMultiple(true);\n                propDefs.add(propDef);\n            }\n\n            def.setPropertyDefs((PropDef[]) propDefs.toArray(new\nPropDef[propDefs.size()]));\n\n            registry.registerNodeType(def);\n        }\n        */"}, {"count": 1, "tags": [], "creator": "midha.rakesh@gmail.com", "text": "Created attachment 18842\nCode to register nodetypes for PageEnvelope\n\nUncommented and changed the code in LenyaRepository.java to add the lenyaKeys\nwith namespace PageEnvelope.NAMESPACE instead of LenyaMetaData.NAMESPACE.\n\nPlease review and commit attached patch", "id": 93200, "time": "2006-09-08T10:17:17Z", "bug_id": 40443, "creation_time": "2006-09-08T10:17:17Z", "is_private": false, "attachment_id": 18842}, {"count": 2, "tags": [], "text": "\nAlso I must say, with this patch added Import usecase works fine.", "is_private": false, "bug_id": 40443, "id": 93202, "time": "2006-09-08T10:23:48Z", "creator": "midha.rakesh@gmail.com", "creation_time": "2006-09-08T10:23:48Z", "attachment_id": null}, {"count": 3, "text": "+ String[] lenyaKeys =     { \"resourceType\", \"contentType\", \"workflowVersion\", \n+ \"placeholder\", \"height\", \"width\" };\n\nThis is obsolete. Maybe there is a generic way to handle the meta data?", "bug_id": 40443, "attachment_id": null, "id": 93743, "time": "2006-09-18T15:25:11Z", "creator": "andreas@apache.org", "creation_time": "2006-09-18T15:25:11Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "creator": "midha.rakesh@gmail.com", "text": "I think you are right.... somehow adding \n    <component-instance\nclass=\"org.apache.lenya.cms.metadata.ConfigurableElementSet\"\nname=\"http://apache.org/cocoon/lenya/page-envelope/1.0\">\n      <element multiple=\"false\" name=\"resourceType\"/>\n      <element multiple=\"false\" name=\"contentType\"/>\n      <element multiple=\"false\" name=\"workflowVersion\"/>\n      <element multiple=\"false\" name=\"placeholder\"/>\n      <element multiple=\"false\" name=\"height\"/>\n      <element multiple=\"false\" name=\"width\"/>\n    </component-instance>\n\nin cocoon.xconf file should solve the problem.\n\nWhat do you say.\n\nthanks\nRakesh\n(In reply to comment #3)\n> + String[] lenyaKeys =     { \"resourceType\", \"contentType\", \"workflowVersion\", \n> + \"placeholder\", \"height\", \"width\" };\n> \n> This is obsolete. Maybe there is a generic way to handle the meta data?\n\n", "id": 95135, "time": "2006-10-27T01:39:18Z", "bug_id": 40443, "creation_time": "2006-10-27T01:39:18Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "rfrovarp@apache.org", "text": "JCR integration is a goal for the next version of Lenya. Modification of Lenya 2.x to have proper support for JCR will not happen at this time. Thank you for your submission.", "id": 138319, "time": "2010-07-10T05:24:10Z", "bug_id": 40443, "creation_time": "2010-07-10T05:24:10Z", "is_private": false, "attachment_id": null}]