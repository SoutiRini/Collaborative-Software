[{"count": 0, "tags": [], "bug_id": 58636, "attachment_id": null, "is_private": false, "id": 186492, "time": "2015-11-23T06:16:57Z", "creator": "onealj@apache.org", "creation_time": "2015-11-23T06:16:57Z", "text": "ClientAnchor uses static final ints to get and set the anchor type. This is the perfect place for an enum.\n\nhttps://poi.apache.org/apidocs/org/apache/poi/ss/usermodel/ClientAnchor.html\nhttps://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/HSSFClientAnchor.html\nhttps://poi.apache.org/apidocs/org/apache/poi/xssf/usermodel/XSSFClientAnchor.html\n\nCode:\nhttp://svn.apache.org/viewvc/poi/trunk/src/java/org/apache/poi/ss/usermodel/ClientAnchor.java?revision=1639217&view=markup#l34"}, {"count": 1, "tags": [], "bug_id": 58636, "attachment_id": 33291, "is_private": false, "id": 186517, "time": "2015-11-24T11:03:50Z", "creator": "onealj@apache.org", "creation_time": "2015-11-24T11:03:50Z", "text": "Created attachment 33291\nAdd AnchorType enum inside ClientAnchor\n\nI'd like to minimize the code impact on existing projects, but I wasn't able to figure out a way to make enums work while allowing the following contrived example code to not break:\nif (anchor.getAnchorType() != ClientAnchor.MOVE_AND_RESIZE) {\n    anchor.setAnchorType(ClientAnchor.MOVE_AND_RESIZE);\n}\n\nBecause the enum is a class inside the ClientAnchor, the above code would need to be rewritten as \nif (anchor.getAnchorType() != AnchorType.MOVE_AND_RESIZE) {\n    anchor.setAnchorType(AnchorType.MOVE_AND_RESIZE);\n}\n\nExisting code using int literals rather than the named constant will break, and I don't have a problem with that.\n\nPlease look over ClientAnchor.java, XSSFClientAnchor.java, and HSSFClientAnchor.java, the first 3 files in the attached patch, to let me know how this could be better implemented.\n\nOtherwise, I'll assume this is good and deploy it."}, {"count": 2, "tags": [], "bug_id": 58636, "attachment_id": 33292, "is_private": false, "id": 186518, "time": "2015-11-24T11:05:19Z", "creator": "onealj@apache.org", "creation_time": "2015-11-24T11:05:19Z", "text": "Created attachment 33292\nAdd AnchorType enum inside ClientAnchor"}, {"count": 3, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 186522, "time": "2015-11-24T18:40:15Z", "bug_id": 58636, "creation_time": "2015-11-24T18:40:15Z", "is_private": false, "text": "For backwards compatibility, couldn't you alias in the constants to ClientAnchor with something like this?\n\n@Deprecated\npublic static final AnchorType MOVE_AND_RESIZE = AnchorType.MOVE_AND_RESIZE;"}, {"count": 4, "tags": [], "bug_id": 58636, "attachment_id": null, "is_private": false, "id": 186534, "time": "2015-11-25T07:24:59Z", "creator": "onealj@apache.org", "creation_time": "2015-11-25T07:24:59Z", "text": "(In reply to Nick Burch from comment #3)\n> @Deprecated\n> public static final AnchorType MOVE_AND_RESIZE = AnchorType.MOVE_AND_RESIZE;\n\nThanks. That answers the remaining questions/discomfort with what I had.\n\nAdded in r1716313. Updated docs in r1716314."}, {"count": 5, "tags": [], "bug_id": 58636, "attachment_id": null, "is_private": false, "id": 193690, "time": "2016-09-14T05:34:46Z", "creator": "onealj@apache.org", "creation_time": "2016-09-14T05:34:46Z", "text": "(In reply to Javen O'Neal from bug 59907 comment #8)\n> In r1760617, I have restored ClientAnchor#setAnchorType(int) to regain\n> backwards compatibility with POI 3.13 that was broken in POI 3.14 beta 1\n> thru POI 3.15 final RC2. ClientAnchor#setAnchorType(int) will be available\n> in 3.15 final RC3 and removed no earlier than 3.17.\n> \n> I have opened discussion for how to handle getAnchorType() returns int or\n> AnchorType enum on the dev mailing list. Reverting back to 3.13's behavior\n> of returning an int would break backwards compatibility for those who\n> upgraded to 3.14, and break compatibility when we switch to only supporting\n> enums."}]