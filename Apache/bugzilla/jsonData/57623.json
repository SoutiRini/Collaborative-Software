[{"count": 0, "tags": [], "creator": "effenberger.felix@gmail.com", "attachment_id": 32509, "is_private": false, "id": 181252, "time": "2015-02-23T12:57:51Z", "bug_id": 57623, "creation_time": "2015-02-23T12:57:51Z", "text": "Created attachment 32509\nExample code creating nested column groups\n\nExcel supports nested column groups, but this feature is broken in POI (both in HSSF and XSSF implementations).\n\nAssume that one wants to create two levels of column groupings, e.g. a group of columns 0 to 6 and two \"sub-groups\" of columns 0,2 and 4,6 as depicted below:\n\n| A | B | C | D | E | F | G |\n|++++++++++GROUP 1++++++++++|\n|+++GROUP 2+++|+++GROUP 3+++|\n\nThe problem is that although the groups can be created, access to the groups is lost after creation (e.g. to set their collapsed/expanded attribute), as the POI API only provides methods to access column groups by columns they contain and no means to access groups on a given level; for fully overlapping groups thus access is lost, see function setColumnGroupCollapsed, https://poi.apache.org/apidocs/org/apache/poi/ss/usermodel/Sheet.html#setColumnGroupCollapsed(int,%20boolean)\n\nExample code for XSSF is attached. The xlsx should contain the nested column groups as described above, with all of them being collapsed initially. This is not the case though, as access to the groups 2 and 3 is lost.\n\nThanks for investigating this!"}]