[{"count": 0, "tags": [], "bug_id": 14336, "attachment_id": null, "id": 25850, "time": "2002-11-07T10:29:27Z", "creator": "ai@vsu.ru", "creation_time": "2002-11-07T10:29:27Z", "is_private": false, "text": "httpd 2.0.42 with the same config and httpd.conf is working ok.\n\nCompile with or without _LINUX_SOURCE_COMPAT:\n\nCC=\"cc_r -g -D_LINUX_SOURCE_COMPAT\" \\\nCFLAGS=\"-qmaxmem=16384 -qarch=604 -qtune=604 -qinline -qsuppress=1500-036\" \\\nCPPFLAGS=\"-D_LARGE_THREADS -DDEFAULT_THREAD_LIMIT=1024\" \\\n./configure \\\n    --prefix=/opt/local/apache2 \\\n    --enable-mods-shared=\"access actions alias asis auth autoindex \\\n                          cgid charset-lite \\\n                          deflate dir \\\n                          env expires ext-filter \\\n                          file_cache \\\n                          headers \\\n                          imap include \\\n                          log_config \\\n                          mime mime_magic \\\n                          negotiation \\\n                          rewrite \\\n                          setenvif ssl status suexec \\\n                          unique-id userdir usertrack\" \\\n    --enable-threads \\\n    --enable-http \\\n    --enable-so \\\n    --disable-ipv6 \\\n    --with-mpm=worker \\\n    --with-ssl=/usr/linux \\\n    --with-egd=/etc/entropy \\\n    \\\n    --with-suexec-caller=httpd \\\n    --with-suexec-uidmin=xxx \\\n    --with-suexec-gidmin=xxx \\\n    --with-suexec-docroot=/var/httpd/htdocs \\\n    --with-suexec-logfile=/var/httpd/logs/suexec_log\n\n\n---------------------------------------------------------------------------------\n# dbx ./httpd\nType 'help' for help.\nreading symbolic information ...\n(dbx) run\n\nSegmentation fault in create_auth_dir_config at line 99 in file \"\" ($t1)\ncould not read \"mod_auth.c\"\n(dbx) where\ncreate_auth_dir_config(p = 0x200ea634, d = (nil)), line 99 in \"mod_auth.c\"\nmod_auth.register_hooks(p = 0x20088470), line 343 in \"mod_auth.c\"\nap_register_hooks(0x200ea0d8, 0x20088470), line 439 in \"config.c\"\nap_add_module(0x200ea0d8, 0x20088470), line 510 in \"config.c\"\nap_add_loaded_module(0x200ea0d8, 0x20088470), line 565 in \"config.c\"\nload_module(0x2ff227c0, 0x2ff206ec, 0x200ba660, 0x200ba670), line 323 in\n\"mod_so.c\"\ninvoke_cmd(0x200668f0, 0x2ff227c0, 0x2ff206ec, 0x2ff20792), line 739 in\n\"config.c\"\nexecute_now(0x200ba610, 0x2ff20773, 0x2ff227c0, 0x20088470, 0x200b8170,\n0x2ff206ec, 0x0), line 1345 in \"config.c\"\nunnamed block $b88, line 942 in \"config.c\"\nap_build_config_sub(0x20088470, 0x200b8170, 0x2ff20768, 0x2ff227c0, 0x2ff20760,\n0x2ff20764, 0x20065598), line 942 in \"config.c\"\nap_build_config(0x2ff227c0, 0x20088470, 0x200b8170, 0x20065598), line 1149 in\n\"config.c\"\nap_process_resource_config(0x200a6230, 0x200a69a0, 0x20065598, 0x20088470,\n0x200b8170), line 1554 in \"config.c\"\nap_read_config(0x200864e0, 0x200b8170, 0x2005b600, 0x20065598), line 1832 in\n\"config.c\"\nmain(argc = 1, argv = 0x2ff22ab0), line 557 in \"main.c\""}, {"count": 1, "tags": [], "bug_id": 14336, "attachment_id": null, "id": 26077, "time": "2002-11-11T17:48:30Z", "creator": "trawick@apache.org", "creation_time": "2002-11-11T17:48:30Z", "is_private": false, "text": "Try it without\n\n  -qarch=604 -qtune=604 -qinline \n\nand see if it starts working.\n"}, {"attachment_id": null, "tags": [], "bug_id": 14336, "text": "The same resault. [and, as i have said in my first report,\nhttpd 2.0.42 with the same config and httpd.conf is working ok.]\n\nfor some reason, apr_palloc starts returns a NULL pointer when the first DSO\nmodule\nis being loaded. no matter how it is named - e.g. if i comment out the first\nLoadModule,\nit will segfault while loading the second one.\n\nthe code where the below particular run segfaulted is in mod_auth.c:\n\n===============\nstatic void *create_auth_dir_config(apr_pool_t *p, char *d)\n{\n    auth_config_rec *conf = apr_palloc(p, sizeof(*conf));\n===============\n\n\n# dbx ./httpd\nType 'help' for help.\nreading symbolic information ...\n(dbx) run\n\nSegmentation fault in create_auth_dir_config at line 99 in file \"\" ($t1)\ncould not read \"mod_auth.c\"\n(dbx) where\ncreate_auth_dir_config(p = 0x200eb634, d = (nil)), line 99 in \"mod_auth.c\"\nmod_auth.register_hooks(p = 0x20089290), line 343 in \"mod_auth.c\"\nap_register_hooks(0x200eb0d8, 0x20089290), line 439 in \"config.c\"\nap_add_module(0x200eb0d8, 0x20089290), line 510 in \"config.c\"\nap_add_loaded_module(0x200eb0d8, 0x20089290), line 565 in \"config.c\"\nload_module(0x2ff227c0, 0x2ff206ec, 0x200bb660, 0x200bb670), line 323 in\n\"mod_so.c\"\ninvoke_cmd(0x20067718, 0x2ff227c0, 0x2ff206ec, 0x2ff20792), line 739 in\n\"config.c\"\nexecute_now(0x200bb610, 0x2ff20773, 0x2ff227c0, 0x20089290, 0x200b9170,\n0x2ff206ec, 0x0), line 1345 in \"config.c\"\nunnamed block $b88, line 942 in \"config.c\"\nap_build_config_sub(0x20089290, 0x200b9170, 0x2ff20768, 0x2ff227c0, 0x2ff20760,\n0x2ff20764, 0x200663c0), line 942 in \"config.c\"\nap_build_config(0x2ff227c0, 0x20089290, 0x200b9170, 0x200663c0), line 1149 in\n\"config.c\"\nap_process_resource_config(0x200a7230, 0x200a79a0, 0x200663c0, 0x20089290,\n0x200b9170), line 1554 in \"config.c\"\nap_read_config(0x20087300, 0x200b9170, 0x2005c428, 0x200663c0), line 1832 in\n\"config.c\"\nmain(argc = 1, argv = 0x2ff22ab0), line 557 in \"main.c\"\n", "count": 2, "id": 26081, "time": "2002-11-11T18:39:44Z", "creator": "ai@vsu.ru", "creation_time": "2002-11-11T18:39:44Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 14336, "attachment_id": null, "id": 26279, "time": "2002-11-14T16:05:39Z", "creator": "johannes.grumboeck@porsche.co.at", "creation_time": "2002-11-14T16:05:39Z", "is_private": false, "text": "Hi,\n\nI've got the same problem on AIX 4.3.3 but with xlc 5.0.0.0\n\nI've configured my apache with:\nCC=\"cc\"; export CC \\\n\"configure\" \\\n\"--prefix=/www/apache2\" \\\n\"--with-mpm=worker\" \\\n\"--enable-mods-shared=ssl rewrite proxy dav cache\"\n\nThe core dump is also thrown at the very first DSO which is loaded,\nnot depending on the module.\n\n[root@yoda]/www/apache2/bin> httpd -V\nServer version: Apache/2.0.43\nServer built:   Nov 14 2002 15:06:12\nServer's Module Magic Number: 20020903:0\nArchitecture:   32-bit\nServer compiled with....\n -D APACHE_MPM_DIR=\"server/mpm/worker\"\n -D APR_HAS_SENDFILE\n -D APR_HAS_MMAP\n -D APR_HAVE_IPV6\n -D APR_USE_PROC_PTHREAD_SERIALIZE\n -D APR_USE_PTHREAD_SERIALIZE\n -D SINGLE_LISTEN_UNSERIALIZED_ACCEPT\n -D APR_HAS_OTHER_CHILD\n -D AP_HAVE_RELIABLE_PIPED_LOGS\n -D HTTPD_ROOT=\"/www/apache2\"\n -D SUEXEC_BIN=\"/www/apache2/bin/suexec\"\n -D DEFAULT_SCOREBOARD=\"logs/apache_runtime_status\"\n -D DEFAULT_ERRORLOG=\"logs/error_log\"\n -D AP_TYPES_CONFIG_FILE=\"conf/mime.types\"\n -D SERVER_CONFIG_FILE=\"conf/httpd.conf\"\n[root@yoda]/www/apache2/bin> \n[root@yoda]/www/apache2/bin> dbx httpd\nType 'help' for help.\nreading symbolic information ...\n[using memory image in core]\n\nSegmentation fault in glink.apr_optional_hook_get at 0xd1247a40 ($t1)\n0xd1247a40 (apr_optional_hook_get+0x30) 800c0000        lwz   r0,0x0(r12)\n(dbx) where\nglink.apr_optional_hook_get() at 0xd1247a40\nmod_proxy.register_hooks(0x30034fb0), line 1089 in \"mod_proxy.c\"\nap_register_hooks(0x30099b50, 0x30034fb0), line 439 in \"config.c\"\nap_add_module(0x30099b50, 0x30034fb0), line 510 in \"config.c\"\nap_add_loaded_module(0x30099b50, 0x30034fb0), line 565 in \"config.c\"\nload_module(0x2ff227e0, 0x2ff2071c, 0x30078d40, 0x30078d50), line 323 \nin \"mod_so.c\"\ninvoke_cmd(0x30012730, 0x2ff227e0, 0x2ff2071c, 0x2ff207b4), line 739 \nin \"config.c\"\nexecute_now(0x30078ce8, 0x2ff20793, 0x2ff227e0, 0x30034fb0, 0x300731e0, \n0x2ff2071c, 0x0), line 1345 in \"config.c\"\nunnamed block $b287, line 942 in \"config.c\"\nap_build_config_sub(0x30034fb0, 0x300731e0, 0x2ff20788, 0x2ff227e0, 0x2ff20780, \n0x2ff20784, 0x3000a3ec), line 942 in \"config.c\"\nap_build_config(0x2ff227e0, 0x30034fb0, 0x300731e0, 0x3000a3ec), line 1149 \nin \"config.c\"\nap_process_resource_config(0x3003bdc0, 0x30076608, 0x3000a3ec, 0x30034fb0, \n0x300731e0), line 1554 in \"config.c\"\nap_read_config(0x30033020, 0x300731e0, 0x30000480, 0x3000a3ec), line 1832 \nin \"config.c\"\nmain(argc = 2, argv = 0x2ff22acc), line 557 in \"main.c\"\n(dbx) quit\n[root@yoda]/www/apache2/bin> \n\n\nCan anybody help us to solve this problem?\n\nbest regards,\n\nJohannes Grumb\u00f6ck\njohannes@grumboeck.net / johannes.grumboeck@porsche.co.at"}, {"count": 4, "tags": [], "bug_id": 14336, "text": "These funky problems (segfaults on lines that shouldn't segfault) seem to\nbe problems I saw a long time ago before the DSO stuff was straightened out\nfor AIX.\n\nPlease see\n\n  http://www.apache.org/~trawick/apache-2-on-aix.html\n  http://www.apache.org/~trawick/aixstatus.html\n\nIt is extremely important to use your own libtool installation and ./buildconf\nas described in the first document.\n\nJohannes, I added you to cc: since you are interested in this PR.\n", "id": 26280, "time": "2002-11-14T16:24:11Z", "creator": "trawick@apache.org", "creation_time": "2002-11-14T16:24:11Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 14336, "attachment_id": null, "id": 26353, "time": "2002-11-15T11:36:16Z", "creator": "ai@vsu.ru", "creation_time": "2002-11-15T11:36:16Z", "is_private": false, "text": "$ ./buildconf\nrebuilding srclib/apr/configure\nbuildconf: checking installation...\nbuildconf: autoconf version 2.53 (ok)\nbuildconf: libtool version 1.4.2 (ok)\nCopying libtool helper files ...\nCreating include/arch/unix/apr_private.h.in ...\nWARNING: Using auxiliary files such as `acconfig.h', `config.h.bot'\nWARNING: and `config.h.top', to define templates for `config.h.in'\nWARNING: is deprecated and discouraged.\n\nWARNING: Using the third argument of `AC_DEFINE' and\nWARNING: `AC_DEFINE_UNQUOTED' allows to define a template without\nWARNING: `acconfig.h':\n\nWARNING:   AC_DEFINE([NEED_MAIN], 1,\nWARNING:             [Define if a function `main' is needed.])\n\nWARNING: More sophisticated templates can also be produced, see the\nWARNING: documentation.\nautoheader: `include/arch/unix/apr_private.h.in' is unchanged\nCreating configure ...\nrebuilding srclib/apr-util/configure\nCreating include/private/apu_config.h ...\nautoheader: `include/private/apu_config.h.in' is unchanged\nCreating configure ...\nInvoking xml/expat/buildconf.sh ...\nIncorporating /usr/share/aclocal/libtool.m4 into aclocal.m4 ...\nCopying libtool helper files ...\nCreating config.h.in ...\nWARNING: Using auxiliary files such as `acconfig.h', `config.h.bot'\nWARNING: and `config.h.top', to define templates for `config.h.in'\nWARNING: is deprecated and discouraged.\n\nWARNING: Using the third argument of `AC_DEFINE' and\nWARNING: `AC_DEFINE_UNQUOTED' allows to define a template without\nWARNING: `acconfig.h':\n\nWARNING:   AC_DEFINE([NEED_MAIN], 1,\nWARNING:             [Define if a function `main' is needed.])\n\nWARNING: More sophisticated templates can also be produced, see the\nWARNING: documentation.\nautoheader: `config.h.in' is updated\nCreating configure ...\nrebuilding srclib/pcre/configure\nrebuilding include/ap_config_auto.h.in\nWARNING: Using auxiliary files such as `acconfig.h', `config.h.bot'\nWARNING: and `config.h.top', to define templates for `config.h.in'\nWARNING: is deprecated and discouraged.\n\nWARNING: Using the third argument of `AC_DEFINE' and\nWARNING: `AC_DEFINE_UNQUOTED' allows to define a template without\nWARNING: `acconfig.h':\n\nWARNING:   AC_DEFINE([NEED_MAIN], 1,\nWARNING:             [Define if a function `main' is needed.])\n\nWARNING: More sophisticated templates can also be produced, see the\nWARNING: documentation.\nautoheader: `include/ap_config_auto.h.in' is created\nrebuilding configure\n"}, {"count": 6, "tags": [], "bug_id": 14336, "attachment_id": null, "text": "2.0.43 is working ok after ./buildconf & building.\n\nTnx!\n", "id": 26366, "time": "2002-11-15T13:28:57Z", "creator": "ai@vsu.ru", "creation_time": "2002-11-15T13:28:57Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 14336, "attachment_id": null, "text": "Andy indicated that this is fixed with Jeff's latest suggestion (i.e. special\ndirections for libtool and buildconf use).", "id": 26397, "time": "2002-11-15T16:48:00Z", "creator": "rederpj@remulak.net", "creation_time": "2002-11-15T16:48:00Z", "is_private": false}]