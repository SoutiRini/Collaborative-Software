[{"count": 0, "tags": [], "bug_id": 46648, "attachment_id": null, "id": 124595, "time": "2009-02-02T12:38:43Z", "creator": "praveen.x.pant@jpmchase.com", "creation_time": "2009-02-02T12:38:43Z", "is_private": false, "text": "Hi,\nWe are trying to compile 64 bit of Apache on a solaris 10 machine . We run into an issue when running the compile with the error messages in the log as :\n\n\n\n gcc -DHAVE_CONFIG_H -DPACKAGE=\\\"expat\\\" -DVERSION=\\\"expat_1.95.2\\\" -I. -I.. -I/local/apache22build_64/httpd-2\n.2.11/srclib/apr-util/xml/expat/lib -m64 -DSSL_EXPERIMENTAL_ENGINE -c xmlrole.c  -fPIC -DPIC -o .libs/xmlrole.\no\n gcc -DHAVE_CONFIG_H -DPACKAGE=\\\"expat\\\" -DVERSION=\\\"expat_1.95.2\\\" -I. -I.. -I/local/apache22build_64/httpd-2\n.2.11/srclib/apr-util/xml/expat/lib -m64 -DSSL_EXPERIMENTAL_ENGINE -c xmlrole.c -o xmlrole.o >/dev/null 2>&1\n/bin/bash ../libtool --mode=link  gcc -version-info 1:0:1 -DSSL_EXPERIMENTAL_ENGINE  -o libexpat.la -rpath /lo\ncal/apache22build_64/apache22_64/lib  xmlparse.lo xmltok.lo xmlrole.lo\ngcc -shared -Wl,-h -Wl,libexpat.so.0 -o .libs/libexpat.so.0.1.0  .libs/xmlparse.o .libs/xmltok.o .libs/xmlrole\n.o  -lc\nld: fatal: file .libs/xmlparse.o: wrong ELF class: ELFCLASS64\nld: fatal: File processing errors. No output written to .libs/libexpat.so.0.1.0\ncollect2: ld returned 1 exit status\n*** Error code 1\nmake: Fatal error: Command failed for target `libexpat.la'\nCurrent working directory /local/apache22build_64/httpd-2.2.11/srclib/apr-util/xml/expat/lib\n*** Error code 1\nThe following command caused the error:\nlist='lib'; \\\nfor dir in $list; do \\\n  cd $dir; make; cd ..; \\\ndone\nmake: Fatal error: Command failed for target `build-subdirs'\nCurrent working directory /local/apache22build_64/httpd-2.2.11/srclib/apr-util/xml/expat\n*** Error code 1\nThe following command caused the error:\notarget=`echo all-recursive | sed s/-recursive//`; \\\nlist='xml dbd dbm encoding hooks buckets misc crypto uri strmatch memcache dbm/sdbm ldap xlate xml/expat'; \\\nfor i in $list; do \\\n    if test -f \"$i/Makefile\"; then \\\n        target=\"$otarget\"; \\\n        echo \"Making $target in $i\"; \\\n\n\n\nThe configure command that we used is : \nexport CFLAGS=-m64\n        export CPPFLAGS=-m64\n        ./configure \\\n                --prefix=/local/apache22build_64/apache22_$arch  \\\n                --enable-mods-shared=all \\\n                --enable-deflate \\\n                --enable-so \\\n                --enable-proxy=shared \\\n                --enable-ssl=static \\\n                --enable-cgid=shared \\\n                --enable-cache=shared \\\n                --enable-mem-cache=shared \\\n                --enable-file-cache=shared \\\n                --enable-disk-cache=shared \\\n                --with-z \\\n                --with-ssl=/local/apache22build_64/apache22_$arch/openssl \\\n                --without-gdbm \\\n                --without-ndbm \\\n                --without-berkeley-db \\\n                --with-mpm=$mpm \\\n                CFLAGS=-DSSL_EXPERIMENTAL_ENGINE \\\n                CPPFLAGS=-m64"}, {"count": 1, "text": "This is trying and failing to build expat: i don't know why, and I can't reproduce it.  Is this a cross-compile you're attempting?  What's your configure line?\n\nI agree it's a bug to bundle expat, and doubly so if it won't even build.  However, the workaround is simple: just install expat before building apr or httpd.  You should see the crucial files:\n/usr/include/expat.h\n/usr/lib/libexpat.so\nand apache's configure will pick them up.  In a cross-compile, you should also be able to use the target system's native expat.\n\nMarking severity down to \"normal\" because of the workaround.", "bug_id": 46648, "is_private": false, "id": 127349, "time": "2009-05-24T17:26:55Z", "creator": "nick@webthing.com", "creation_time": "2009-05-24T17:26:55Z", "tags": [], "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 46648, "attachment_id": null, "id": 149421, "time": "2011-09-17T19:44:54Z", "creator": "covener@gmail.com", "creation_time": "2011-09-17T19:44:54Z", "is_private": false, "text": "Usually it's safer/suggested to set CC to include your compiler and arch selection flags for the apache build with included dependencies.  e.g CC=\"gcc -m64\""}]