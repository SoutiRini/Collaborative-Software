[{"count": 0, "attachment_id": null, "bug_id": 35620, "is_private": false, "id": 77015, "time": "2005-07-05T22:33:44Z", "creator": "ashokkumar.sankaran@chase.com", "creation_time": "2005-07-05T22:33:44Z", "tags": [], "text": "The following is my problem :-\n\n\tI have two simple excel files \"eightcontrols.xls\" \nand \"ninecontrols.xls\".\n\n\t\"eightcontrols.xls\" contains 8 command buttons.\n\t\"ninecontrols.xls\"  contains 9 command buttons.\n\n\tThe below code works fine with \"eightcontrols.xls\", but gives \nan \"Unable to read file\" error with \"ninecontrols.xls\" \n\n\tAlso, we noticed there is a loss of size on the \"ninecontrols.xls\" run.\n\nCode------------------------------------------------\n\n\t\tPOIFSFileSystem fs = null;\n\t\tHSSFWorkbook wb = null;\n\n\n\t\tURL fileURL = context.getResource\n(\"/xlfiles/eightcontrols.xls\"); // Unix convention\n\t\t//URL fileURL = context.getResource\n(\"c:\\xlfiles\\eightcontrols.xls\"); // Windows convention\n\n\t\tInputStream in = fileURL.openStream();\n\n\t\tfs = new POIFSFileSystem(in);\n\n\t\twb = new HSSFWorkbook(fs);\n\n      \t\tByteArrayOutputStream output = new ByteArrayOutputStream();\n\t\t\n\n        try {\n            wb.write(output);\n            System.out.println(\"File Size = \" + output.size());\n\n            wb.write(new FileOutputStream(\"c:/temp/test.xls\"));\n            \n            response.reset();\n            response.setContentType(\"application/vnd.ms-excel\");\n            response.setHeader(\"Content-Disposition\",\"attachment; filename=\\\"\" \n+ filename + \"\\\"\");\n            response.getOutputStream().write(output.toByteArray());         \n            response.flushBuffer();\n            \n        } catch (Exception e) {\n       \t    logger_.trace(\"Exception raised while producing Raw XL data for \nVertical COMPS..\");            \n            e.printStackTrace();\n        }\n\n\t\t\t\nCode------------------------------------------------"}, {"count": 1, "attachment_id": 15599, "bug_id": 35620, "text": "Created attachment 15599\nExcel file with eight command buttons\n\nExcel file with eight command buttons", "id": 77016, "time": "2005-07-05T22:35:51Z", "creator": "ashokkumar.sankaran@chase.com", "creation_time": "2005-07-05T22:35:51Z", "tags": [], "is_private": false}, {"count": 2, "attachment_id": 15600, "bug_id": 35620, "is_private": false, "id": 77017, "time": "2005-07-05T22:36:26Z", "creator": "ashokkumar.sankaran@chase.com", "creation_time": "2005-07-05T22:36:26Z", "tags": [], "text": "Created attachment 15600\nExcel file with nine command buttons\n\nExcel file with nine command buttons"}, {"count": 3, "tags": [], "bug_id": 35620, "attachment_id": null, "text": "WORKSFORME. At leats with the code in CVS HEAD. Maybe something got fixed recently.\n\nA new release should be happening soon!\n\nJason", "id": 78957, "time": "2005-08-25T05:37:42Z", "creator": "jheight@apache.org", "creation_time": "2005-08-25T05:37:42Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 35620, "attachment_id": null, "text": "When do you think we can expect a  new release.\nIs there any we can get the latest from CVS HEAD.?\nWhen HSSF is going to support Office 2002 or Office XP.\n", "id": 78994, "time": "2005-08-25T15:57:09Z", "creator": "ashokkumar.sankaran@chase.com", "creation_time": "2005-08-25T15:57:09Z", "is_private": false}]