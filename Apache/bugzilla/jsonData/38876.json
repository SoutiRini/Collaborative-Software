[{"text": "It seems that the PEM-encoded certificate coming out of OpenSSL (0.9.8a in my\ncase) contains new lines without leading space, which is interpreted as a new\nHTTP header.\nEven more important, the last empty line leads to 2 new lines without leading\nspace, which is interpreted as the end of all HTTP headers.\n\nThis could be fixed by removing all new lines in the PEM-encoded certificate, in\nssl_engine_vars.c:\n\nstatic char *ssl_var_lookup_ssl_cert_PEM(apr_pool_t *p, X509 *xs)\n{\n    ...\n    BIO_free(bio);\n\n+ /* remove all new lines (CR & LF) */\n+ {\n+  char *source, *target;\n+  for ( source = target = result; *source; source++ ) {\n+   if ( (*source != 0x0A) && (*source != 0x0D) ) *target++ = *source;\n+  }\n+  *target = NUL;\n+ }\n\n    return result;\n}\n\n\nRemark: the test\n   if ( (*source != 0x0A) && (*source != 0x0D) )\ncould also be replaced by a more general one:\n   if ( *source <= ' ' )", "tags": [], "bug_id": 38876, "is_private": false, "count": 0, "id": 86559, "time": "2006-03-07T10:59:37Z", "creator": "marc.stern@approach.be", "creation_time": "2006-03-07T10:59:37Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "Solved in 2.2, in mod_headers\n\nBackport available: http://people.apache.org/~jorton/mod_headers-2.0-ssl.diff", "attachment_id": null, "bug_id": 38876, "id": 87105, "time": "2006-03-22T14:48:42Z", "creator": "marc.stern@approach.be", "creation_time": "2006-03-22T14:48:42Z", "is_private": false}]