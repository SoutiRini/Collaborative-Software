[{"count": 0, "tags": [], "creator": "joekislos@gmail.com", "attachment_id": null, "id": 122715, "time": "2008-11-21T08:34:21Z", "bug_id": 46261, "creation_time": "2008-11-21T08:34:21Z", "is_private": false, "text": "Context with %2F in name causes tomcat crash on shutdown\n\nSeveral years ago I worked on integrating tomcat 5.5 into our web application management infrastructure.  During the process I fixed several tomcat 5.5 bugs, but apparently never sent the fixes upstream.  Oops.\n\nOur application needs to be deployed to create a URL that looks like this:\n\n/product/customername/servlet\n\nI worked with several people on IRC to get tomcat5.5 to do this.  We had previously been using the path= parameter in the context xml file element with tomcat 4.1.  Unfortunately, it appears this feature was removed from tomcat5.5, and tomcat5.5 does not recurse into subdirectories when reading .xml context files.  The recommendation on IRC (after several suggestions which would not work for our environment) was to put %2F in the context xml file's name.  Such as this\n\nproduct%2Fcustomername.xml\n\nThis does work, however when you try to shutdown tomcat 6.0.18, you will get this crash:\n\nNov 9, 2008 10:56:17 PM org.apache.coyote.http11.Http11Protocol pause\nINFO: Pausing Coyote HTTP/1.1 on http-8180\nNov 9, 2008 10:56:18 PM org.apache.catalina.core.StandardService stop\nINFO: Stopping service Catalina\nNov 9, 2008 10:56:18 PM org.apache.catalina.startup.HostConfig undeployApps\nWARNING: Error while removing context [/product%2Fcustomername]\njava.lang.NullPointerException\n        at org.apache.catalina.core.ContainerBase.removeChild(ContainerBase.java:915)\n        at org.apache.catalina.startup.HostConfig.undeployApps(HostConfig.java:1191)\n        at org.apache.catalina.startup.HostConfig.stop(HostConfig.java:1162)\n        at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:313)\n        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:117)\n        at org.apache.catalina.core.ContainerBase.stop(ContainerBase.java:1086)\n        at org.apache.catalina.core.ContainerBase.stop(ContainerBase.java:1098)\n        at org.apache.catalina.core.StandardEngine.stop(StandardEngine.java:448)\n        at org.apache.catalina.core.StandardService.stop(StandardService.java:584)\n        at org.apache.catalina.core.StandardServer.stop(StandardServer.java:744)\n        at org.apache.catalina.startup.Catalina.stop(Catalina.java:628)\n        at org.apache.catalina.startup.Catalina$CatalinaShutdownHook.run(Catalina.java:671)\nNov 9, 2008 10:56:18 PM org.apache.coyote.http11.Http11Protocol destroy\nINFO: Stopping Coyote HTTP/1.1 on http-8180"}, {"count": 1, "tags": [], "creator": "joekislos@gmail.com", "attachment_id": 22910, "id": 122716, "time": "2008-11-21T08:35:26Z", "bug_id": 46261, "creation_time": "2008-11-21T08:35:26Z", "is_private": false, "text": "Created attachment 22910\nProposed patch"}, {"count": 2, "tags": [], "bug_id": 46261, "text": "I have attached a patch that I have been using to work around this issue. It modifies findChild to decode the name if the initial lookup fails.", "id": 122717, "time": "2008-11-21T08:36:13Z", "creator": "joekislos@gmail.com", "creation_time": "2008-11-21T08:36:13Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 46261, "is_private": false, "text": "The correct way to do this in 6.0.18 is to use the # character rather than %2F.\n\n%2F should be interpreted literally.", "id": 122720, "time": "2008-11-21T08:45:56Z", "creator": "markt@apache.org", "creation_time": "2008-11-21T08:45:56Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 46261, "is_private": false, "text": "This has been fixed in trunk. I want to do some more testing of this and look at bug 46262 before proposed anything for 6.0.x", "id": 123546, "time": "2008-12-26T15:51:04Z", "creator": "markt@apache.org", "creation_time": "2008-12-26T15:51:04Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 123571, "time": "2008-12-28T15:59:35Z", "bug_id": 46261, "creation_time": "2008-12-28T15:59:35Z", "is_private": false, "text": "*** Bug 46262 has been marked as a duplicate of this bug. ***"}, {"count": 6, "tags": [], "bug_id": 46261, "is_private": false, "text": "I couldn't break my fix in my testing so I have proposed the fix for 6.0.x", "id": 123572, "time": "2008-12-28T16:03:37Z", "creator": "markt@apache.org", "creation_time": "2008-12-28T16:03:37Z", "attachment_id": null}, {"count": 7, "tags": [], "text": "This has been fixed in 6.0.x and will be included in 6.0.19 onwards.", "attachment_id": null, "id": 124553, "creator": "markt@apache.org", "time": "2009-01-31T00:42:50Z", "bug_id": 46261, "creation_time": "2009-01-31T00:42:50Z", "is_private": false}]