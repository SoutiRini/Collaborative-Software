[{"count": 0, "attachment_id": null, "bug_id": 61573, "text": "Hi,\n\nwould someone tell me the reason of following issue?\n\n \n\nCell\"CC24\" contains the following formula;\n\n=ROUND\uff08\uff08I24*Q24*U24*Y24*AC24*(AG24+AK24*AO24/AS24)*(AW24-BA24)*(BE24-BI24)*(BM24+BQ24))*BU24/BY24 , -1 \uff09\n\n\n    and the result is; \n\n        before ROUND : 1514.6689635\n\n        after ROUND Excel result :1510\n\n        after ROUND POI result :1520\n\n \n\nI expected that APACHE_POI returns \"1510\" as Excel, but the result is \"1520\".\n\n \n\n \n\n \n\nAdditionaly, I know the following points;\n\n \n\n1.APACHE_POI returns \"1510\" when I put additional parenthesis in formula.\n\n \n\n\u3000\u3000ex\uff1a put parenthesis around \"I24*Q24*U24*Y24*AC24\" and \"BU24/BY24\" \n\u3000\u3000\u3000=ROUND(( ( I24*Q24*U24*Y24*AC24 ) *(AG24+AK24*AO24/AS24)*(AW24-BA24)*(BE24-BI24)*(BM24+BQ24))* ( BU24/BY24 ) ,-1)\n\n\n  and the result is; \n\n        before ROUND : 1514.6689635\n\n        after ROUND Excel result :1510\n\n        after ROUND POI result :1510\n\n \n\n2.APACHE_POI returns \"1510\" when I substitute real numbers for functions.\n\n \n\n    ex1. I24*Q24=100\u3000\u21d2 substitute \"100\" for I24*Q24\n\n                                     (100*U24*Y24*AC24*(AG24+AK24*AO24/AS24)*(AW24-BA24)*(BE24-BI24)*(BM24+BQ24))*BU24/BY24 \n\n \n\n    ex2. Q24*U24=0.21\u3000\u21d2 substitute \"0.21\" for Q24*U24\n\n                                     (I24*0.21*Y24*AC24*(AG24+AK24*AO24/AS24)*(AW24-BA24)*(BE24-BI24)*(BM24+BQ24))*BU24/BY24  \n\n \n\n    ex3. U24*Y24=0.03746862\u21d2 substitute \"0.03746862\" for U24*Y24\n\n                                    (I24*Q24*0.03746862*AC24*(AG24+AK24*AO24/AS24)*(AW24-BA24)*(BE24-BI24)*(BM24+BQ24))*BU24/BY24  \n\n\n     ex4. Y24*AC24=1784.22\u21d2 substitute \"1784.22\" for Y24*AC24\n\n                                    (I24*Q24*U24*1784.22*(AG24+AK24*AO24/AS24)*(AW24-BA24)*(BE24-BI24)*(BM24+BQ24))*BU24/BY24 \n\n   \n\n and the results are; \n         before ROUND : 1514.6689635\n\n        after ROUND Excel result :1510\n\n        after ROUND POI result :1510", "id": 201212, "time": "2017-09-29T04:49:20Z", "creator": "wtpgjadmwtpgjadw@yahoo.co.jp", "creation_time": "2017-09-29T04:49:20Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 201213, "time": "2017-09-29T04:57:06Z", "bug_id": 61573, "creation_time": "2017-09-29T04:57:06Z", "is_private": false, "text": "Does the same behaviour occur with Apache POI 3.17?\n\nIf you aren't already using Java 8, does the same behaviour occur on Java 8 with POI 3.17?"}, {"count": 2, "tags": [], "creator": "wtpgjadmwtpgjadw@yahoo.co.jp", "attachment_id": null, "text": "The version of Apache POI is 3.7.\nThe Java version is 6.\nIt is not possible to check the operation in Java 8 and 3.17.", "id": 201214, "time": "2017-09-29T05:17:31Z", "bug_id": 61573, "creation_time": "2017-09-29T05:17:31Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 61573, "attachment_id": null, "text": "Can you attach the Excel file or provide a unit test which triggers this?", "id": 201215, "time": "2017-09-29T06:02:32Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2017-09-29T06:02:32Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 61573, "text": "POI 3.7 is no longer supported.\n\nI think github-43 fixed this issue in POI 3.17.\n\nIf for no other reason, you should upgrade to 3.17 due to several important security fixes.", "id": 201217, "time": "2017-09-29T07:22:19Z", "creator": "onealj@apache.org", "creation_time": "2017-09-29T07:22:19Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "apache@gagravarr.org", "text": "Apache POI 3.7 is ancient. Please try upgrading to a more recent version, this bug may well have been fixed in the 7 years (7!) since 3.7 was released", "id": 201220, "time": "2017-09-29T08:38:06Z", "bug_id": 61573, "creation_time": "2017-09-29T08:38:06Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "creator": "wtpgjadmwtpgjadw@yahoo.co.jp", "text": "Thank you very much.\nI will test it with the latest version.\nPlease tell me what the contents of the fixed bug are like.", "id": 201221, "time": "2017-09-29T08:54:13Z", "bug_id": 61573, "creation_time": "2017-09-29T08:54:13Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 61573, "attachment_id": null, "text": "We don't have any single bug to state, rather Nick tried to state that there were literally hundreds of bugfixes since that version in all areas of Apache POI, so you should use a newer version for various reasons and we hope your problem will be solved as well then.\n\nI will close this for now, please reopen with an attached sample Excel file which allows to reproduce this if you still see this problem in version 3.17 or newer.", "id": 201299, "time": "2017-10-04T18:45:18Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2017-10-04T18:45:18Z", "is_private": false}]