[{"count": 0, "tags": [], "bug_id": 53985, "attachment_id": null, "text": "In fact the xls-File (opened with 7-zip) contained the following entries:\n\n[5]SummaryInformation\nBook\n[1]CompObj\n[5]DocumentSummaryInformation\n\nThe Excel version read from CompObj was\nMicrosoft Office Excel 2003\nExcel.Sheet.8\n\n\njava.lang.RuntimeException: java.io.FileNotFoundException: no such entry: \"Workbook\"\n\tat org.apache.poi.hssf.extractor.EventBasedExcelExtractor.getText(EventBasedExcelExtractor.java:141)\n\tat ...\nCaused by: java.io.FileNotFoundException: no such entry: \"Workbook\"\n\tat org.apache.poi.poifs.filesystem.DirectoryNode.getEntry(DirectoryNode.java:375)\n\tat org.apache.poi.poifs.filesystem.DirectoryNode.createDocumentInputStream(DirectoryNode.java:177)\n\tat org.apache.poi.hssf.eventusermodel.HSSFEventFactory.processWorkbookEvents(HSSFEventFactory.java:63)\n\tat org.apache.poi.hssf.extractor.EventBasedExcelExtractor.triggerExtraction(EventBasedExcelExtractor.java:157)\n\tat org.apache.poi.hssf.extractor.EventBasedExcelExtractor.getText(EventBasedExcelExtractor.java:134)\n\t... 6 more", "id": 162646, "time": "2012-10-09T13:21:12Z", "creator": "emergency.shower@gmail.com", "creation_time": "2012-10-09T13:21:12Z", "is_private": false}, {"count": 1, "tags": [], "text": "Do you know where the file comes from? Normal excel files use \"Workbook\" not \"Book\" as the POIFS entry holding the data", "attachment_id": null, "bug_id": 53985, "id": 162647, "time": "2012-10-09T13:23:32Z", "creator": "apache@gagravarr.org", "creation_time": "2012-10-09T13:23:32Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 53985, "attachment_id": null, "text": "Hi,\n\nI have the same issue. I have two different excel files from which cannot be read. Both have the \"Book\" entry and do not have \"Workbook\". If I open them  in Excel 2007 and 'save as => excel 97-2003', then the files successfully open in POI. \n\nI have altered my code to try to read 'Book' entry instead of 'Workbook'. Both files produce following exception: \n\n\norg.springframework.web.util.NestedServletException: Request processing failed; nested exception is org.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\torg.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:894)\n\torg.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:647)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:728)\n\torg.netbeans.modules.web.monitor.server.MonitorFilter.doFilter(MonitorFilter.java:393)\nroot cause\n\norg.apache.poi.hssf.record.RecordFormatException: Unable to construct record instance\n\torg.apache.poi.hssf.record.RecordFactory$ReflectionConstructorRecordCreator.create(RecordFactory.java:65)\n\torg.apache.poi.hssf.record.RecordFactory.createSingleRecord(RecordFactory.java:301)\n\torg.apache.poi.hssf.record.RecordFactoryInputStream$StreamEncryptionInfo.<init>(RecordFactoryInputStream.java:65)\n\torg.apache.poi.hssf.record.RecordFactoryInputStream.<init>(RecordFactoryInputStream.java:182)\n\torg.apache.poi.hssf.eventusermodel.HSSFEventFactory.genericProcessEvents(HSSFEventFactory.java:139)\n\torg.apache.poi.hssf.eventusermodel.HSSFEventFactory.processEvents(HSSFEventFactory.java:106)\n\tpl.veracomp.service.SpreadsheetImportService.process(SpreadsheetImportService.java:369)\n\tpl.veracomp.controller.uploadController.onSubmit(uploadController.java:57)\n\torg.springframework.web.servlet.mvc.SimpleFormController.processFormSubmission(SimpleFormController.java:272)\n\torg.springframework.web.servlet.mvc.AbstractFormController.handleRequestInternal(AbstractFormController.java:268)\n\torg.springframework.web.servlet.mvc.AbstractController.handleRequest(AbstractController.java:153)\n\torg.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter.handle(SimpleControllerHandlerAdapter.java:48)\n\torg.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:923)\n\torg.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)\n\torg.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)\n\torg.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:647)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:728)\n\torg.netbeans.modules.web.monitor.server.MonitorFilter.doFilter(MonitorFilter.java:393)\nroot cause\n\norg.apache.poi.hssf.record.RecordFormatException: Not enough data (0) to read requested (2) bytes\n\torg.apache.poi.hssf.record.RecordInputStream.checkRecordPosition(RecordInputStream.java:216)\n\torg.apache.poi.hssf.record.RecordInputStream.readShort(RecordInputStream.java:233)\n\torg.apache.poi.hssf.record.InterfaceHdrRecord.<init>(InterfaceHdrRecord.java:43)\n\tsun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tsun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n\tsun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n\tjava.lang.reflect.Constructor.newInstance(Constructor.java:513)\n\torg.apache.poi.hssf.record.RecordFactory$ReflectionConstructorRecordCreator.create(RecordFactory.java:57)\n\torg.apache.poi.hssf.record.RecordFactory.createSingleRecord(RecordFactory.java:301)\n\torg.apache.poi.hssf.record.RecordFactoryInputStream$StreamEncryptionInfo.<init>(RecordFactoryInputStream.java:65)\n\torg.apache.poi.hssf.record.RecordFactoryInputStream.<init>(RecordFactoryInputStream.java:182)\n\torg.apache.poi.hssf.eventusermodel.HSSFEventFactory.genericProcessEvents(HSSFEventFactory.java:139)\n\torg.apache.poi.hssf.eventusermodel.HSSFEventFactory.processEvents(HSSFEventFactory.java:106)\n\tpl.veracomp.service.SpreadsheetImportService.process(SpreadsheetImportService.java:369)\n\tpl.veracomp.controller.uploadController.onSubmit(uploadController.java:57)\n\torg.springframework.web.servlet.mvc.SimpleFormController.processFormSubmission(SimpleFormController.java:272)\n\torg.springframework.web.servlet.mvc.AbstractFormController.handleRequestInternal(AbstractFormController.java:268)\n\torg.springframework.web.servlet.mvc.AbstractController.handleRequest(AbstractController.java:153)\n\torg.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter.handle(SimpleControllerHandlerAdapter.java:48)\n\torg.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:923)\n\torg.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)\n\torg.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)\n\torg.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:647)\n\tjavax.servlet.http.HttpServlet.service(HttpServlet.java:728)\n\torg.netbeans.modules.web.monitor.server.MonitorFilter.doFilter(MonitorFilter.java:393)\n\n\nUnfortunatelly I cannot attach the files. They contain confidential data, which I cannot remove without correcting the files. \n\nAny ideas? How can I help resolve this issue?", "id": 166649, "time": "2013-04-16T10:18:48Z", "creator": "wilkolazki@gmail.com", "creation_time": "2013-04-16T10:18:48Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 53985, "attachment_id": 30202, "text": "Created attachment 30202\nThe file which produces FileNotFound Exception (missing Workbook entry)", "id": 166650, "time": "2013-04-16T11:02:35Z", "creator": "wilkolazki@gmail.com", "creation_time": "2013-04-16T11:02:35Z", "is_private": false}, {"count": 4, "tags": [], "creator": "wilkolazki@gmail.com", "attachment_id": null, "id": 166651, "time": "2013-04-16T11:04:18Z", "bug_id": 53985, "creation_time": "2013-04-16T11:04:18Z", "is_private": false, "text": "I have attached the file which helps reproduce the issue. It seems that the problem is with Excel 5.0/95 file format. \n\nIs this format supported, or do I need to force users to update the file format and resubmit to my app?"}, {"count": 5, "tags": [], "bug_id": 53985, "attachment_id": null, "text": "As listed on the POI site <http://poi.apache.org/spreadsheet/index.html> only Excel 97+ formats are supported, Excel 95 (and before) are between a little and a lot too different, and are not handled by POI, sorry.\n\n(POI can give you the parts of the OLE2 document using POIFS, but not parse the records)", "id": 167422, "time": "2013-05-26T17:38:28Z", "creator": "apache@gagravarr.org", "creation_time": "2013-05-26T17:38:28Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 53985, "attachment_id": null, "text": "I think based on the last comment this bug should be resolved WONTFIX, please note that the Text-Extraction functionality (https://poi.apache.org/text-extraction.html) can read some parts of older formats, please try the latest version as the support has improved in the last releases.", "id": 183266, "time": "2015-06-01T21:17:18Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-06-01T21:17:18Z", "is_private": false}]