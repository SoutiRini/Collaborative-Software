[{"count": 0, "tags": [], "text": "We're using JUnit tests extensively in our codebase and I recently added the \njunitreports functionality to our build file.  I get the following errors \nperiodically.  it seems that a NullPointerException causes the JUnit test to \nhang in the process of creating an XML results file.\n\nJava Vesion : Java(TM) 2 Runtime Environment, Standard Edition (build 1.3.0_02)\nJava HotSpot(TM) Client VM (build 1.3.0_02, mixed mode)\n\nsb\n\n\n[junit] Exception in thread \"main\" java.lang.NullPointerException\n    [junit] \tat \norg.apache.tools.ant.taskdefs.optional.junit.XMLJUnitResultFormatter.endTest\n(XMLJUnitResultFormatter.java:177)\n    [junit] \tat \norg.apache.tools.ant.taskdefs.optional.junit.XMLJUnitResultFormatter.formatError\n(XMLJUnitResultFormatter.java:211)\n    [junit] \tat \norg.apache.tools.ant.taskdefs.optional.junit.XMLJUnitResultFormatter.addError\n(XMLJUnitResultFormatter.java:206)\n    [junit] \tat junit.framework.TestResult.addError(TestResult.java:36)\n    [junit] \tat junit.framework.TestResult.runProtected(TestResult.java:133)\n    [junit] \tat com.raplix.rolloutexpress.RaplixTestSuite.run\n(RaplixTestSuite.java:63)\n    [junit] \tat \norg.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run\n(JUnitTestRunner.java:209)\n    [junit] \tat \norg.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main\n(JUnitTestRunner.java:342)", "is_private": false, "bug_id": 2442, "id": 3379, "time": "2001-07-03T14:16:30Z", "creator": "sbix@yahoo.com", "creation_time": "2001-07-03T14:16:30Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 2442, "attachment_id": null, "id": 6091, "creation_time": "2001-09-27T03:47:22Z", "time": "2001-09-27T03:47:22Z", "creator": "bodewig@apache.org", "text": "could you please verify whether the problem still exists in Ant 1.4?", "is_private": false}, {"count": 2, "tags": [], "creator": "devajx@yahoo.com", "attachment_id": null, "id": 6479, "time": "2001-10-08T14:49:38Z", "bug_id": 2442, "creation_time": "2001-10-08T14:49:38Z", "is_private": false, "text": "I think this problem occurs because XMLJUnitResultFormatter is not re-entrant. \nIf you have a test suite that runs a bunch of tests in multiple threads \n(junit.extensions.ActiveTestSuite) then the startTest method can be called in \nmultiple threads, in which case you have a race condition as this method \nmodifies two instance variables currentTest and lastTestStart.\nA quick fix will be to modify the class to encapsulate these instance variables \nin java.lang.ThreadLocal objects."}, {"count": 3, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 7245, "time": "2001-10-29T06:35:58Z", "bug_id": 2442, "creation_time": "2001-10-29T06:35:58Z", "is_private": false, "text": "supposed to be fixed with nightly build 2001-10-30, could you please verify that\nit works now and close the bug?\n\nWe couldn't use ThreadLocal as Ant 1.x is supposed to be JDK 1.1 compatible."}, {"count": 4, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 7846, "time": "2001-11-13T04:34:19Z", "bug_id": 2442, "creation_time": "2001-11-13T04:34:19Z", "is_private": false, "text": "I assume the problem has disappeared, closing this issue."}]