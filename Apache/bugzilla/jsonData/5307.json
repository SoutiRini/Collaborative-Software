[{"count": 0, "tags": [], "creator": "christophe.aubry@temis-group.com", "text": "I tried to make some tests on a client/server application, using Ant.\nI used the JAVA task to run different test processes.\nI also want to select different JVM modes, so I use a JVMARG nested element to \nset -hotspot or -server mode.\n\nThe problem is the following: if I use the JAR attribute, Ant returns an error \nwhile launching the JVM (unrecognized option: -server). If I use the CLASSPATH \nand CLASSNAME attributes instead, the task is executed normally (mode of the \nJVM is correct).\n\nThen,\n\n        <java jar=\"MyServer.jar\"\n              fork=\"true\">\n          <jvmarg value=\"-server\"/>\n          ...\n        </java>\n\nmust be replaced with\n\n        <java classname=\"MyServer\"\n              classpath=\"MyServer.jar\"\n              fork=\"true\">\n          <jvmarg value=\"-server\"/>\n          ...\n        </java>\n\nI think that the correction is minor but it takes some time to find this issue!\n\nHoping this can help.", "id": 8673, "time": "2001-12-06T09:42:01Z", "bug_id": 5307, "creation_time": "2001-12-06T09:42:01Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "umagesh@apache.org", "attachment_id": null, "id": 10200, "time": "2002-02-02T06:09:54Z", "bug_id": 5307, "creation_time": "2002-02-02T06:09:54Z", "is_private": false, "text": "I notice a strange comment/piece of code in CommandlineJava.java.  This is the\ncause of this problem:\n\n// -jar must be the first option in the command line.\nif (executeJar){\n    result[pos++] = \"-jar\";\n}\n\nWho ever said -jar must be the first option in the command line??  \n\nThis link clearly states the *real* rules...\nhttp://java.sun.com/products/jdk/1.2/docs/tooldocs/solaris/java.html#-jar\n\nIt says java [ options ] -jar file.jar [ argument ... ]\n             ^^^^^^^^^^^\n\nI will wait for a day or two to hear back, before I apply a patch.\n"}, {"count": 2, "tags": [], "bug_id": 5307, "attachment_id": null, "text": "Christophe, thanks for reporting. For easier VM debugging in the future you \nmight want to set the environment variable _JAVA_LAUNCHER_DEBUG to any value it \nwill spit some info to the console which are sometimes useful to identify \nproblems, alternatively you can use Ant mode -verbose to look at the invoked \ncommand line.\n\nFor a pertinent answer rather than a gratuitous personal attack toward someone, \nthis bug is due to an inconsistency between the JDK documentation, the usage \ncommand line and what is done in the JDK 1.3.x code when parsing the command \nline (this won't be of any problem in JDK 1.4.x, see below).\n\nCommand line says:\nUsage: java [-options] class [args...]\n           (to execute a class)\n   or  java -jar [-options] jarfile [args...]\n           (to execute a jar file)\n[...]\n\nDocumentation says:\n   or  java [-options] -jar jarfile [args...]\n           (to execute a jar file)\n\nJDK 1.3.x code enforces another order which is none but for the jvmtype that \nmust always be the first option. That is:\n\njava [-jvmtype] [-options] [classname|jarfile] args...\n\nThis bug has been fixed in JDK 1.4.x, the jvmtype can now be specified anywhere \nas part of the options.\n\nSo appending the -jar option rather than prepending as specified in usage \ncommand line should work since we'll let the burden of specifying correctly the \njvmtype first to the user for JDK < 1.4.x\n\nI fixed it in CVS now, so you might want to try it.\n\nAlternatively I filled a bug to Sun (139128 and 139129, might take a week to \nappear) since the doc inconsistency still exists in JDK 1.4.rc1 but as any \norder works this is a minor documentation issue. Anyway, we'd better help fix \nthings like you do, this is how we make things better. (In a better world..in a \nbetter place... you know :)\n\nThanks.\n", "id": 10221, "time": "2002-02-02T12:31:38Z", "creator": "sbailliez@apache.org", "creation_time": "2002-02-02T12:31:38Z", "is_private": false}, {"count": 3, "tags": [], "text": "> Command line says:\n> Usage: java [-options] class [args...]\n>            (to execute a class)\n>   or  java -jar [-options] jarfile [args...]\n>           (to execute a jar file)\n\nVery good point, Stephane.  Thanks for clarifying.  Is this the reason why\ndocumentation and code must be together in the same place? ;-)\n", "attachment_id": null, "bug_id": 5307, "id": 10226, "time": "2002-02-02T16:35:55Z", "creator": "umagesh@apache.org", "creation_time": "2002-02-02T16:35:55Z", "is_private": false}, {"count": 4, "tags": [], "text": "Thanks for this correction and for your good explanation of the issue...\nI'll use your tips in the future (debug and verbose options).\n\nI enjoy working with Apache tools. You really help us having a better \n(development) world :)\n\n", "is_private": false, "bug_id": 5307, "id": 10257, "time": "2002-02-03T15:33:59Z", "creator": "christophe.aubry@temis-group.com", "creation_time": "2002-02-03T15:33:59Z", "attachment_id": null}]