[{"count": 0, "tags": [], "bug_id": 60021, "attachment_id": null, "text": "In POI's EncryptionInfo, there is this reflection-based provider loading going on:\n\n    protected static EncryptionInfoBuilder getBuilder(EncryptionMode encryptionMode) throws ClassNotFoundException, IllegalAccessException, InstantiationException {\n        ClassLoader cl = Thread.currentThread().getContextClassLoader();\n        EncryptionInfoBuilder eib = (EncryptionInfoBuilder)cl.loadClass(encryptionMode.builder).newInstance();\n        return eib;\n    }\n\nThis ends up trying to load a class called org.apache.poi.poifs.crypt.agile.AgileEncryptionInfoBuilder and getting a ClassNotFoundException.\n\nThis class is in the poi-ooxml jar, but this jar is *not* listed as a dependency of poi, even as a runtime dependency, despite the fact that EncryptionInfo cannot work without it. We're not using POI to support OOXML, only for OLE2-based formats, so we should not have to depend on OOXML directly ourselves either.", "id": 193207, "time": "2016-08-19T01:12:02Z", "creator": "trejkaz@trypticon.org", "creation_time": "2016-08-19T01:12:02Z", "is_private": false}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "text": "Hmm, pesky. Some of the OOXML CT schema classes seem to be needed to power the agile encryption code. \n\nYou *ought* to be able to use HSSF without needing poi-ooxml or poi-scratchpad, and you *ought* to be able to use HWPF + HSLF without needing poi-ooxml. However, this looks to be one edge case, where an apparently OLE2-only thing actually turns out to be partly OOXML under the hood.\n\nWe don't want to make almost all POI OLE2-only users suck in the OOXML stuff when they don't need to\n\nWould updating the documentation, to help people know that they're accidentally roaming into OOXML territory when they might think they're still in pure-OLE2 land, be enough do you think?", "id": 193239, "time": "2016-08-20T14:55:33Z", "bug_id": 60021, "creation_time": "2016-08-20T14:55:33Z", "is_private": false, "attachment_id": null}, {"count": 2, "attachment_id": null, "bug_id": 60021, "is_private": false, "id": 193243, "time": "2016-08-20T16:20:51Z", "creator": "kiwiwings@apache.org", "creation_time": "2016-08-20T16:20:51Z", "tags": [], "text": "Maybe I just throw out that xmlbeans and update the encryption xml elements with plain DOM calls ..."}, {"count": 3, "tags": [], "creator": "onealj@apache.org", "text": "I updated the Javadocs in r1763944 to mention that poi-ooxml may be required.", "id": 194258, "time": "2016-10-09T05:41:59Z", "bug_id": 60021, "creation_time": "2016-10-09T05:41:59Z", "is_private": false, "attachment_id": null}]