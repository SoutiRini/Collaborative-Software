[{"attachment_id": null, "tags": [], "creator": "Robert_Flaherty@Hyperion.com", "is_private": false, "count": 0, "id": 46076, "time": "2003-10-22T17:50:56Z", "bug_id": 24015, "creation_time": "2003-10-22T17:50:56Z", "text": "- Related to my post #23631 about PaneRecord missing from both.\n- In addition, RecalcIdRecord is missing from EventRecordFactory.\n- Both are missing many others (not sure if this is intentional).  Would we be \nbetter served changing the static block of code in say RecordFactory to use \nreflection to get all *Record.class files in org.apache.poi.hssf.record and \neliminate Record and UnknownRecord.  Then expose the static Class[] with a \ngetter for EventRecordFactory.  Anyway, here's the list:\n[missing]AreaFormatRecord\n[missing]AreaRecord\n[missing]AxisLineFormatRecord\n[missing]AxisOptionsRecord\n[missing]AxisParentRecord\n[missing]AxisRecord\n[missing]AxisUsedRecord\n[       ]BackupRecord\n[missing]BarRecord\n[missing]BeginRecord\n[       ]BlankRecord\n[       ]BOFRecord\n[       ]BookBoolRecord\n[       ]BoolErrRecord\n[       ]BottomMarginRecord\n[       ]BoundSheetRecord\n[       ]CalcCountRecord\n[       ]CalcModeRecord\n[missing]CategorySeriesAxisRecord\n[missing]ChartFormatRecord\n[missing]ChartRecord\n[       ]CodepageRecord\n[       ]ColumnInfoRecord\n[       ]ContinueRecord\n[       ]CountryRecord\n[missing]DataFormatRecord\n[       ]DateWindow1904Record\n[missing]DatRecord\n[       ]DBCellRecord\n[       ]DefaultColWidthRecord\n[missing]DefaultDataLabelTextPropertiesRecord\n[       ]DefaultRowHeightRecord\n[       ]DeltaRecord\n[       ]DimensionsRecord\n[       ]DSFRecord\n[missing]EndRecord\n[       ]EOFRecord\n[       ]ExtendedFormatRecord\n[       ]ExternSheetRecord\n[missing]ExternSheetSubRecord\n[missing]ExtSSTInfoSubRecord\n[       ]ExtSSTRecord\n[       ]FnGroupCountRecord\n[missing]FontBasisRecord\n[missing]FontIndexRecord\n[       ]FontRecord\n[       ]FooterRecord\n[       ]FormatRecord\n[       ]FormulaRecord\n[missing]FrameRecord\n[       ]GridsetRecord\n[       ]GutsRecord\n[       ]HCenterRecord\n[       ]HeaderRecord\n[       ]HideObjRecord\n[       ]IndexRecord\n[       ]InterfaceEndRecord\n[       ]InterfaceHdrRecord\n[       ]IterationRecord\n[       ]LabelRecord\n[       ]LabelSSTRecord\n[       ]LeftMarginRecord\n[missing]LegendRecord\n[missing]LineFormatRecord\n[missing]LinkedDataRecord\n[       ]MergeCellsRecord\n[       ]MMSRecord\n[       ]MulBlankRecord\n[       ]MulRKRecord\n[       ]NameRecord\n[missing]NumberFormatIndexRecord\n[       ]NumberRecord\n[missing]ObjectLinkRecord\n[       ]PaletteRecord\n[missing]PaneRecord\n[       ]PasswordRecord\n[       ]PasswordRev4Record\n[missing]PlotAreaRecord\n[missing]PlotGrowthRecord\n[       ]PrecisionRecord\n[       ]PrintGridlinesRecord\n[       ]PrintHeadersRecord\n[       ]PrintSetupRecord\n[       ]ProtectionRev4Record\n[       ]ProtectRecord\n[       ]RecalcIdRecord\n[       ]RefModeRecord\n[       ]RefreshAllRecord\n[       ]RightMarginRecord\n[       ]RKRecord\n[       ]RowRecord\n[       ]SaveRecalcRecord\n[missing]SCLRecord\n[       ]SelectionRecord\n[missing]SeriesChartGroupIndexRecord\n[missing]SeriesIndexRecord\n[missing]SeriesLabelsRecord\n[missing]SeriesListRecord\n[missing]SeriesRecord\n[missing]SeriesTextRecord\n[missing]SeriesToChartGroupRecord\n[       ]SharedFormulaRecord\n[missing]SheetPropertiesRecord\n[       ]SSTRecord\n[       ]StringRecord\n[       ]StyleRecord\n[missing]SupBookRecord\n[       ]TabIdRecord\n[missing]TextRecord\n[missing]TickRecord\n[       ]TopMarginRecord\n[missing]UnitsRecord\n[       ]UseSelFSRecord\n[missing]ValueRangeRecord\n[       ]VCenterRecord\n[       ]WindowOneRecord\n[       ]WindowProtectRecord\n[       ]WindowTwoRecord\n[       ]WriteAccessRecord\n[       ]WSBoolRecord"}, {"count": 1, "tags": [], "bug_id": 24015, "attachment_id": null, "id": 46090, "creation_time": "2003-10-22T22:08:55Z", "time": "2003-10-22T22:08:55Z", "creator": "jheight@apache.org", "text": "Hi Robert,\n\nIn so far as eliminating UnknownRecord, this record is actually quite useful\nwhen debugging and extending HSSF with newer record types. There are some\nrecords that we simply dont implement. This may be due to the fact that i use\nExcel XP here at work and it has introduced new record types that we dont\nsupport, or there are records that we have chosed not to support.\n\nNow just scanning your list the missing records seem to mainly be chart records.\nSome such as ExtSSTInfoSubRecord are actually not really true excel records but\nhave been implemented that way.\n\nHowever, Is anyone actively working on charts? Can we add these records to be\nread/written in the head. \n\nUnless someone beats me to it, i will have a look at the non-graph records that\nyou mention.\n\nEveryone: I assume that there is no reason why the non graph records havent been\nadded to the factory?\n\nJason", "is_private": false}, {"count": 2, "tags": [], "creator": "Robert_Flaherty@Hyperion.com", "text": "Jason, I wasn't suggesting that we remove the UnknownRecord class itself, just \nthat if we use reflection to enumerate all of the record classes to use in the \nfactory, we should special case Record and UnknownRecord and not add them to \nthe list b/c we'll never get a record read in from the stream for them (Record \nhas no sid, and UnknownRecord has a 0 sid); UnknownRecord is created as a \ncatch all.  What do you think about using reflection to prevent further \nmissing classes?", "id": 46101, "time": "2003-10-23T03:11:14Z", "bug_id": 24015, "creation_time": "2003-10-23T03:11:14Z", "is_private": false, "attachment_id": null}, {"count": 3, "attachment_id": null, "creator": "josh@apache.org", "is_private": false, "id": 116280, "time": "2008-05-05T19:53:32Z", "bug_id": 24015, "creation_time": "2008-05-05T19:53:32Z", "tags": [], "text": "Automatically generating the list of Record classes to be served by EventRecordFactory won't work at the moment, because there are some records which must not be created directly (this was discovered while working on bug 44894).\n\nThe first step will be to remove all old code from RecordFactory and use EventRecordFactory alone. \n\nThere might still be ways to improve the management of the record classes list."}]