[{"count": 0, "tags": [], "text": "Created attachment 24733\nthe corrected Squiggle.app/Contents/MacOS/Squiggle shell script\n\nOverview:\nThe Mac OS X application bundle for Squiggle (a GUI front-end for Batik) refuses to run if it is installed in a path containing spaces, and possibly some other odd characters.  However, it does not produce any error messages; it just doesn't start.\n\nSteps to Reproduce:\n1. Create a folder whose name contains one or more spaces.\n2. Download the Mac OS X disk image from\nhttp://xmlgraphics.apache.org/batik/download.cgi#Download+a+distribution\n3. Most OS X native browsers will mount the disk image automatically.  If your browser is a ported browser that doesn't do this, find the downloaded disk image and double-click on it to mount it.\n4. Install the Squiggle application by dragging it from the disk image to the folder created in step 1, or to a sub-folder of a folder whose name contains one or more spaces.\n5. Un-mount (eject) the disk image.\n6. Double-click on the installed Squiggle application to launch it.\n7. When the computer displays the message '\u201cSquiggle\u201d is an application which was downloaded from the Internet. Are you sure you want to open it?' click Open.\n\nActual Results:\nThe Squiggle icon that appeared in the Dock in step 7 disappears.  On subsequent attempted launches (when the computer does not ask for confirmation) the icon appears very briefly in the Dock and then disappears.  No splash screens etc appear.  The following is written to the Console (which can be read by opening /Applications/Utilities/Console.app):\n\nDec 18 15:45:25 Beetle [0x0-0x135135].org.apache.batik[77397]: usage: dirname path\nDec 18 15:45:25 Beetle [0x0-0x135135].org.apache.batik[77397]: Unable to access jarfile /../Resources/batik-squiggle.jar\nDec 18 15:45:25 Beetle com.apple.launchd[158] ([0x0-0x135135].org.apache.batik[77397]): Exited with exit code: 1\n\nExpected Results:\nThe Squiggle application should launch, display a splash screen and continue to run, and its icon should remain in the Dock until the user desires the application to quit.\n\nBuild Date & Platform:\nBuild 2008-01-06 on Mac OS 10.5.8\n\nAdditional Builds and Platforms:\nThis only affects the Mac OS X application.  The JAR file works just fine.\n\nAdditional Information:\nI know how to fix this.\n\nInside the Mac OS X application bundle (applications on OS X are really just folders whose name ends in '.app') there is a file at Squiggle.app/Contents/MacOS/Squiggle.  It is an executable shell script that is run when the user double-clicks on the application.  It attempts to start up the JAR located at Squiggle.app/Contents/Resources/batik-squiggle.jar.  It is this file that contains the bug.  This script reads as follows:\n\n#!/bin/sh\n\nJAVA=/usr/bin/java\n[ -e \"$JAVA_HOME/bin/java\" ] && JAVA=\"$JAVA_HOME/bin/java\"\n\n\"$JAVA\" -Dcom.apple.mrj.application.apple.menu.about.name=Squiggle -jar \"`dirname $0`/../Resources/batik-squiggle.jar\"\n\nThe problem is in the last line.  The script should read as follows:\n\n#!/bin/sh\n\nJAVA=/usr/bin/java\n[ -e \"$JAVA_HOME/bin/java\" ] && JAVA=\"$JAVA_HOME/bin/java\"\n\n\"$JAVA\" -Dcom.apple.mrj.application.apple.menu.about.name=Squiggle -jar \"`dirname \\\"$0\\\"`/../Resources/batik-squiggle.jar\"\n\nI have also attached the corrected script.", "is_private": false, "id": 132935, "creator": "jalexanderdatkins@googlemail.com", "time": "2009-12-18T08:01:10Z", "bug_id": 48411, "creation_time": "2009-12-18T08:01:10Z", "attachment_id": 24733}, {"count": 1, "tags": [], "bug_id": 48411, "is_private": false, "text": "The corrected Mac OS X disk image can be downloaded from\n\nhttp://www.atkinsfamily.ukonline.co.uk/Squiggle-1.7.dmg", "id": 132938, "time": "2009-12-18T09:46:54Z", "creator": "jalexanderdatkins@googlemail.com", "creation_time": "2009-12-18T09:46:54Z", "attachment_id": null}, {"count": 2, "tags": [], "text": "Make that\n\nhttp://www.atkinsfamily.ukonline.co.uk/Squiggle-1.7.dmg.zip", "is_private": false, "id": 132939, "creator": "jalexanderdatkins@googlemail.com", "time": "2009-12-18T09:55:46Z", "bug_id": 48411, "creation_time": "2009-12-18T09:55:46Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "helder.magalhaes@gmail.com", "text": "(In reply to comment #0)\n> The problem is in the last line.  The script should read as follows:\n[...]\n> \"$JAVA\" -Dcom.apple.mrj.application.apple.menu.about.name=Squiggle -jar\n> \"`dirname \\\"$0\\\"`/../Resources/batik-squiggle.jar\"\n\nI've checked that this is still present [1] in the trunk version, so I'm adjusting the bug's metadata.\n\nA quick web crawl validates [2] your suggestion. Thanks for the hint! ;-)\n\n\n[1] http://svn.apache.org/viewvc/xmlgraphics/batik/trunk/build.xml?revision=774981&view=markup#l513\n[2] http://www.unix.com/shell-programming-scripting/109120-find-dirname-problems-white-spaces-directories.html", "id": 132948, "time": "2009-12-19T11:29:54Z", "bug_id": 48411, "creation_time": "2009-12-19T11:29:54Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 48411, "text": "Created attachment 24735\nPatch from the suggested fix", "id": 132949, "attachment_id": 24735, "creator": "helder.magalhaes@gmail.com", "creation_time": "2009-12-19T11:33:12Z", "time": "2009-12-19T11:33:12Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 48411, "text": "Available patch is pretty simple and seems very safe to apply. Could it be committed?", "id": 132950, "time": "2009-12-19T11:34:45Z", "creator": "helder.magalhaes@gmail.com", "creation_time": "2009-12-19T11:34:45Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "text": "I can confirm this bug, and its solution.\n\nIn fact, I wanted to submit the same patch, since I did not find this page before. To aid other users who encounter the same problem, here are the errors that I got:\n\n% open Squiggle.app\nLSOpenFromURLSpec() failed with error -10810 for the file /Applications/Image viewer/Squiggle.app.\n\n% cat /var/log/system.log\n[0x0-0x63d63d].org.apache.batik[95014]: Unable to access jarfile /../Resources/batik-squiggle.jar\ncom.apple.launchd[119] ([0x0-0x63d63d].org.apache.batik[95014]): Exited with exit code: 1\n[0x0-0x63e63e].org.apache.batik[95018]: usage: dirname path", "is_private": false, "id": 134078, "creator": "public@macfreek.nl", "time": "2010-01-31T12:31:09Z", "bug_id": 48411, "creation_time": "2010-01-31T12:31:09Z", "attachment_id": null}, {"count": 7, "attachment_id": null, "creator": "helder.magalhaes@gmail.com", "text": "Fixed in revision 907210. Thanks to Alexander Atkins for the report and suggested fix, and to Freek Dijkstra for testing the solution! :-)\n\nIf possible, please download a nightly build and/or update your SVN repositories and verify the resolution (marking the issue as \"verified\"). ;-)", "id": 134266, "time": "2010-02-06T05:23:25Z", "bug_id": 48411, "creation_time": "2010-02-06T05:23:25Z", "tags": [], "is_private": false}]