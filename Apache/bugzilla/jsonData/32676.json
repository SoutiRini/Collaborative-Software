[{"count": 0, "tags": [], "creator": "jesse_demmel@yahoo.com", "attachment_id": null, "is_private": false, "id": 68438, "time": "2004-12-14T01:10:36Z", "bug_id": 32676, "creation_time": "2004-12-14T01:10:36Z", "text": "I have a simple XML that only has one task, replaceregexp, on a single file.  It\nkept writing the file back with nothing in it, 0 bytes.  After some\ninvestigation and lucky intuition, I discovered that my java.io.tmpdir\n(/var/tmp) was full.  After making some room there, the task worked correctly. \nThis was the only thing I changed to get it to work.  Neither debug or verbose\ngave me any clue that this was a problem.  At best, I would expect an Ant error\nthat it can't successfully write the file to /var/tmp.  An ok solution would be\nan indication in either -debug or -verbose.\n\nRunning the following ant command:\n\nant -f test.xml -d -v -diagnostics\n\nContents of test.xml:\n\n<project name=\"automated\" default=\"test\">\n        <replaceregexp match=\"log.dir=\" replace=\"log.dir=foo\" byline=\"true\">\n            <fileset dir=\"/myhomedir\" includes=\"ConfigResources.properties\"/>\n        </replaceregexp>\n   </target>\n</project>\n\nDisplay of -debug and -verbose (the original test.xml had more properties in it):\n\n16:12 condor /export/home/nightjunitlst211>ant -f test.xml -v -d\nApache Ant version 1.6.0 compiled on December 18 2003\nApache Ant version 1.6.0 compiled on December 18 2003\nBuildfile: test.xml\nAdding reference: ant.PropertyHelper\nDetected Java version: 1.4 in: /apps/java/j2sdk1.4.2/jre\nDetected OS: SunOS\nAdding reference: ant.ComponentHelper\nSetting ro project property: ant.version -> Apache Ant version 1.6.0 compiled on\nDecember 18 2003\nSetting ro project property: ant.file -> /export/home/nightjunitlst211/test.xml\nAdding reference: ant.projectHelper\nAdding reference: ant.parsing.context\nAdding reference: ant.targets\nparsing buildfile /export/home/nightjunitlst211/test.xml with URI =\nfile:///export/home/nightjunitlst211/test.xml\nSetting ro project property: ant.project.name -> automated\nAdding reference: automated\nSetting ro project property: ant.file.automated ->\n/export/home/nightjunitlst211/test.xml\nProject base dir set to: /export/home/nightjunitlst211\n +Target:\n +Target: test\nSetting project property: automated.home -> /export/home/nightjunitlst211\nSetting project property: catalina.home ->\n/export/home/nightjunitlst211/jakarta-tomcat-4.1.24\nSetting project property: lst.home -> /export/home/nightjunitlst211/lst\nSetting project property: db.user -> nightlyjunit21\nSetting project property: db.password -> nightlyjunit21\nSetting project property: db.host -> condor\nSetting project property: db.port -> 1521\nSetting project property: db.instance -> LSTBLDR\nSetting project property: lm.ipaddress -> 10.30.8.174\nSetting project property: lm.port -> 5110\nBuild sequence for target `test' is [test]\nComplete build sequence is [test, ]\n\ntest:\nCould not load a dependent class (com/sun/media/jai/codec/FileSeekableStream)\nfor type image\nCould not load a dependent class (com/jcraft/jsch/UserInfo) for type sshexec\nCould not load a dependent class (com/jcraft/jsch/UserInfo) for type scp\nCould not load a dependent class (org/apache/commons/net/SocketClient) for type\nrexec\nCould not load a dependent class (com/starbase/starteam/Item) for type stlist\nCould not load a dependent class (org/apache/commons/net/SocketClient) for type\ntelnet\nCould not load a dependent class (org/apache/commons/net/ftp/FTP) for type ftp\nCould not load a dependent class (jdepend/xmlui/JDepend) for type jdepend\nCould not load a dependent class (com/starbase/starteam/Item) for type stcheckin\nCould not load a dependent class (com/starbase/starteam/Item) for type stcheckout\nfileset: Setup scanner in dir /export/home/nightjunitlst211/lst with patternSet{\nincludes: [ConfigResources.properties] excludes: [] }\n[replaceregexp] Replacing pattern 'log.dir=' with 'foo' in\n'/export/home/nightjunitlst211/lst/ConfigResources.properties' by line.\n\nFinally, if you care, the results of `ant -diagnostics`:\n\n------- Ant diagnostics report -------\nApache Ant version 1.6.0 compiled on December 18 2003\n\n-------------------------------------------\n Implementation Version (JDK1.2+ only)\n-------------------------------------------\ncore tasks     : 1.6.0\noptional tasks : 1.6.0\n\n-------------------------------------------\n ANT_HOME/lib jar listing\n-------------------------------------------\nant.home: /apps/java/apache-ant-1.6.0\nant-antlr.jar (5652 bytes)\nant-apache-bsf.jar (12331 bytes)\nant-apache-resolver.jar (4102 bytes)\nant-commons-logging.jar (3855 bytes)\nant-commons-net.jar (34911 bytes)\nant-icontract.jar (9675 bytes)\nant-jai.jar (21535 bytes)\nant-jakarta-bcel.jar (8646 bytes)\nant-jakarta-log4j.jar (3024 bytes)\nant-jakarta-oro.jar (47895 bytes)\nant-jakarta-regexp.jar (3720 bytes)\nant-javamail.jar (6759 bytes)\nant-jdepend.jar (7968 bytes)\nant-jmf.jar (6617 bytes)\nant-jsch.jar (21460 bytes)\nant-junit.jar (68986 bytes)\nant-launcher.jar (8199 bytes)\nant-netrexx.jar (9906 bytes)\nant-nodeps.jar (394801 bytes)\nant-starteam.jar (35537 bytes)\nant-stylebook.jar (2326 bytes)\nant-swing.jar (6627 bytes)\nant-trax.jar (67074 bytes)\nant-vaj.jar (48386 bytes)\nant-weblogic.jar (14447 bytes)\nant-xalan1.jar (3937 bytes)\nant-xalan2.jar (2489 bytes)\nant-xslp.jar (2236 bytes)\nant.jar (952104 bytes)\nxercesImpl.jar (949628 bytes)\nxml-apis.jar (124724 bytes)\nbsf.jar (175348 bytes)\njs.jar (390767 bytes)\njunit37.jar (117522 bytes)\n\n-------------------------------------------\n Tasks availability\n-------------------------------------------\nimage : Missing dependency com.sun.media.jai.codec.FileSeekableStream\nsshexec : Missing dependency com.jcraft.jsch.UserInfo\nscp : Missing dependency com.jcraft.jsch.UserInfo\nrexec : Missing dependency org.apache.commons.net.SocketClient\nstlist : Missing dependency com.starbase.starteam.Item\ntelnet : Missing dependency org.apache.commons.net.SocketClient\nftp : Missing dependency org.apache.commons.net.ftp.FTP\njdepend : Missing dependency jdepend.xmlui.JDepend\nstcheckin : Missing dependency com.starbase.starteam.Item\nstcheckout : Missing dependency com.starbase.starteam.Item\n-------------------------------------------\n org.apache.env.Which diagnostics\n-------------------------------------------\nNot available.\nDownload it at http://xml.apache.org/commons/\n\n-------------------------------------------\n XML Parser information\n-------------------------------------------\nXML Parser : org.apache.xerces.jaxp.SAXParserImpl\nXML Parser Location: /apps/java/apache-ant-1.6.0/lib/xercesImpl.jar\n-------------------------------------------\n System properties\n-------------------------------------------\njava.runtime.name : Java(TM) 2 Runtime Environment, Standard Edition\nsun.boot.library.path : /apps/java/j2sdk1.4.2/jre/lib/sparc\njava.vm.version : 1.4.2-b28\njava.vm.vendor : Sun Microsystems Inc.\njava.vendor.url : http://java.sun.com/\npath.separator : :\njava.vm.name : Java HotSpot(TM) Client VM\nfile.encoding.pkg : sun.io\nsun.os.patch.level : unknown\njava.vm.specification.name : Java Virtual Machine Specification\nuser.dir : /export/home/nightjunitlst211\njava.runtime.version : 1.4.2-b28\njava.awt.graphicsenv : sun.awt.X11GraphicsEnvironment\njava.endorsed.dirs : /apps/java/j2sdk1.4.2/jre/lib/endorsed\nos.arch : sparc\njava.io.tmpdir : /var/tmp/\nline.separator :\njava.vm.specification.vendor : Sun Microsystems Inc.\nos.name : SunOS\nant.home : /apps/java/apache-ant-1.6.0\nsun.java2d.fontpath :\njava.library.path :\n/apps/java/j2sdk1.4.2/jre/lib/sparc/client:/apps/java/j2sdk1.4.2/\njre/lib/sparc:/apps/java/j2sdk1.4.2/jre/../lib/sparc:/usr/lib/lwp::/opt/sfw/lib:/usr/\nX11R6/lib:/usr/lib:/usr/openwin/lib:/opt/gnome/lib:/usr/lib\njava.specification.name : Java Platform API Specification\njava.class.version : 48.0\njava.util.prefs.PreferencesFactory : java.util.prefs.FileSystemPreferencesFactory\nos.version : 5.8\nuser.home : /users/gwager\nuser.timezone : US/Mountain\njava.awt.printerjob : sun.print.PSPrinterJob\nfile.encoding : ISO646-US\njava.specification.version : 1.4\njava.class.path :\n/apps/java/apache-ant-1.6.0/lib/ant-launcher.jar:/export/home/rick/\ndev/glue5/lib/glue-all.jar:/export/home/rick/dev/glue5/lib/glue-examples.jar:/apps/ja\nva/apache-ant-1.6.0/lib/ant-antlr.jar:/apps/java/apache-ant-1.6.0/lib/ant-apache-bsf.\njar:/apps/java/apache-ant-1.6.0/lib/ant-apache-resolver.jar:/apps/java/apache-ant-1.6\n.0/lib/ant-commons-logging.jar:/apps/java/apache-ant-1.6.0/lib/ant-commons-net.jar:/a\npps/java/apache-ant-1.6.0/lib/ant-icontract.jar:/apps/java/apache-ant-1.6.0/lib/ant-j\nai.jar:/apps/java/apache-ant-1.6.0/lib/ant-jakarta-bcel.jar:/apps/java/apache-ant-1.6\n.0/lib/ant-jakarta-log4j.jar:/apps/java/apache-ant-1.6.0/lib/ant-jakarta-oro.jar:/app\ns/java/apache-ant-1.6.0/lib/ant-jakarta-regexp.jar:/apps/java/apache-ant-1.6.0/lib/an\nt-javamail.jar:/apps/java/apache-ant-1.6.0/lib/ant-jdepend.jar:/apps/java/apache-ant-\n1.6.0/lib/ant-jmf.jar:/apps/java/apache-ant-1.6.0/lib/ant-jsch.jar:/apps/java/apache-\nant-1.6.0/lib/ant-junit.jar:/apps/java/apache-ant-1.6.0/lib/ant-launcher.jar:/apps/ja\nva/apache-ant-1.6.0/lib/ant-netrexx.jar:/apps/java/apache-ant-1.6.0/lib/ant-nodeps.ja\nr:/apps/java/apache-ant-1.6.0/lib/ant-starteam.jar:/apps/java/apache-ant-1.6.0/lib/an\nt-stylebook.jar:/apps/java/apache-ant-1.6.0/lib/ant-swing.jar:/apps/java/apache-ant-1\n.6.0/lib/ant-trax.jar:/apps/java/apache-ant-1.6.0/lib/ant-vaj.jar:/apps/java/apache-a\nnt-1.6.0/lib/ant-weblogic.jar:/apps/java/apache-ant-1.6.0/lib/ant-xalan1.jar:/apps/ja\nva/apache-ant-1.6.0/lib/ant-xalan2.jar:/apps/java/apache-ant-1.6.0/lib/ant-xslp.jar:/\napps/java/apache-ant-1.6.0/lib/ant.jar:/apps/java/apache-ant-1.6.0/lib/xercesImpl.jar\n:/apps/java/apache-ant-1.6.0/lib/xml-apis.jar:/apps/java/apache-ant-1.6.0/lib/bsf.jar\n:/apps/java/apache-ant-1.6.0/lib/js.jar:/apps/java/apache-ant-1.6.0/lib/junit37.jar:/\napps/java/j2sdk1.4.2/lib/tools.jar\nuser.name : gwager\njava.vm.specification.version : 1.0\njava.home : /apps/java/j2sdk1.4.2/jre\nsun.arch.data.model : 32\nuser.language : en\njava.specification.vendor : Sun Microsystems Inc.\njava.vm.info : mixed mode\njava.version : 1.4.2\njava.ext.dirs : /apps/java/j2sdk1.4.2/jre/lib/ext\nsun.boot.class.path :\n/apps/java/j2sdk1.4.2/jre/lib/rt.jar:/apps/java/j2sdk1.4.2/jre/\nlib/i18n.jar:/apps/java/j2sdk1.4.2/jre/lib/sunrsasign.jar:/apps/java/j2sdk1.4.2/jre/l\nib/jsse.jar:/apps/java/j2sdk1.4.2/jre/lib/jce.jar:/apps/java/j2sdk1.4.2/jre/lib/chars\nets.jar:/apps/java/j2sdk1.4.2/jre/classes\njava.vendor : Sun Microsystems Inc.\nfile.separator : /\njava.vendor.url.bug : http://java.sun.com/cgi-bin/bugreport.cgi\nsun.io.unicode.encoding : UnicodeBig\nsun.cpu.endian : big\nsun.cpu.isalist : sparcv9+vis sparcv9 sparcv8plus+vis sparcv8plus sparcv8\nsparcv8-fsm uld sparcv7 sparc"}, {"count": 1, "attachment_id": null, "bug_id": 32676, "is_private": false, "id": 70635, "time": "2005-02-08T20:00:43Z", "creator": "stevel@apache.org", "creation_time": "2005-02-08T20:00:43Z", "tags": [], "text": "Ant -diagnostics in CVS_HEAD now checks that the tempdir is writeable (by\ncreating a 32k file)\n\nLooking at regexp, it should print out an error (and continue)  if anything\nhappened during execution. If you didnt see anything either the code is wrong,\nor the JVM/OS is hiding some of the details, a miracle of buffered IO. \n\nMaybe ant -diagnostics should check this by *reading* the file back and\nverifying its contents. hmmm."}, {"count": 2, "attachment_id": null, "bug_id": 32676, "text": "At the very least a known number of bytes should be written (32k sounds fine),\nthen the size of the file checked to be sure it is correct.  I say this based on\nthe reported behavior of Java when writing to a full volume (there is a thread\non the dev list about it).  Then you get into having to sleep waiting for some\nOSes to catch up on writing the file to disk.", "id": 70767, "time": "2005-02-10T17:03:53Z", "creator": "mbenson@apache.org", "creation_time": "2005-02-10T17:03:53Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "creator": "bodewig@apache.org", "is_private": false, "id": 123422, "attachment_id": null, "bug_id": 32676, "creation_time": "2008-12-19T05:39:28Z", "time": "2008-12-19T05:39:28Z", "text": "svn revision 728019"}]