[{"count": 0, "tags": [], "bug_id": 49017, "attachment_id": null, "id": 135758, "time": "2010-03-29T14:27:39Z", "creator": "bluenogujj@yahoo.com", "creation_time": "2010-03-29T14:27:39Z", "is_private": false, "text": "We have two tomcat instances[6.0.18] running on 2 boxes.\nThe OS on both of them is Windows 2003 Server.\nThey are clustered and fronted by Apache httpd and the configuration is as below :\n<Engine name=\"Catalina\" defaultHost=\"localhost\" jvmRoute=\"jvm1\">\n\n  <Cluster className=\"org.apache.catalina.ha.tcp.SimpleTcpCluster\"\n  channelSendOptions=\"4\" clusterName=\"multiplancluster\">\n\n    <Manager className=\"org.apache.catalina.ha.session.BackupManager\"\n      expireSessionsOnShutdown=\"false\"\n      notifyListenersOnReplication=\"true\"\n      mapSendOptions=\"6\"/>\n\n    <Channel className=\"org.apache.catalina.tribes.group.GroupChannel\">\n    <Membership className=\"org.apache.catalina.tribes.membership.McastService\"\n      address=\"224.0.0.1\"\n      port=\"45564\"\n      frequency=\"500\"\n      dropTime=\"3000\"/>\n\n    <Receiver className=\"org.apache.catalina.tribes.transport.nio.NioReceiver\"\n      address=\"node1\"\n      port=\"4000\"\n      autoBind=\"100\"\n      selectorTimeout=\"5000\"\n      maxThreads=\"6\"/>\n\n    <Sender className=\"org.apache.catalina.tribes.transport.ReplicationTransmitter\">\n      <Transport className=\"org.apache.catalina.tribes.transport.nio.PooledParallelSender\"/>\n    </Sender>\n\n    <Interceptor className=\"org.apache.catalina.tribes.group.interceptors.TcpFailureDetector\"/>\n    <Interceptor className=\"org.apache.catalina.tribes.group.interceptors.MessageDispatch15Interceptor\"/>\n    <Interceptor className=\"org.apache.catalina.tribes.group.interceptors.ThroughputInterceptor\"/>\n    </Channel>\n\n    <Valve className=\"org.apache.catalina.ha.tcp.ReplicationValve\" />\n    <ClusterListener className=\"org.apache.catalina.ha.session.ClusterSessionListener\"/>\n  </Cluster>\n  <Realm className=\"org.apache.catalina.realm.UserDatabaseRealm\"\n  <Host name=\"localhost\"  appBase=\"webapps\"\n    unpackWARs=\"true\" autoDeploy=\"true\"\n    xmlValidation=\"false\" xmlNamespaceAware=\"false\">\n  </Host>\n</Engine>\n\nThe above config is similar on both nodes.\nEverything appears fine on startup, however when a request is sent to one node an NullPointerException is thrown on the other node and appears in the logs as below :\norg.apache.catalina.connector.CoyoteAdapter service\nSEVERE: An exception or error occurred in the container during the request processing\njava.lang.NullPointerException\n        at org.apache.catalina.ha.tcp.ReplicationValve.invoke(ReplicationValve.java:348)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286)\n        at org.apache.jk.server.JkCoyoteHandler.invoke(JkCoyoteHandler.java:190)\n        at org.apache.jk.common.HandlerRequest.invoke(HandlerRequest.java:283)\n        at org.apache.jk.common.ChannelSocket.invoke(ChannelSocket.java:767)\n        at org.apache.jk.common.ChannelSocket.processConnection(ChannelSocket.java:697)\n        at org.apache.jk.common.ChannelSocket$SocketConnection.runIt(ChannelSocket.java:889)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:690)\n        at java.lang.Thread.run(Thread.java:595) <<logs.zip>>"}, {"count": 1, "tags": [], "bug_id": 49017, "attachment_id": null, "text": "This was fixed some time ago. The fix is available in 6.0.19 onwards.", "id": 135760, "time": "2010-03-29T14:36:20Z", "creator": "markt@apache.org", "creation_time": "2010-03-29T14:36:20Z", "is_private": false}]