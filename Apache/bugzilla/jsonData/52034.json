[{"attachment_id": 27779, "tags": [], "bug_id": 52034, "text": "Created attachment 27779\nJmeter testPlan\n\nr1183374 (and I believe it is in 2.5.1 as well) \nActiveMQ-all-5.3.1.jar\n\nI will provide the issue by Use-case.\n\n1) Use attached TP. The TP can be described as:\n\nThead (Continue, Forever)\n  JMS Subscriber\n  JMS Publisher (disabled)\nView Results Tree Listener\n\nBoth samples are pointing to same queue.\nThe queue is empty (precondition).\n\n2) Run the TP and the listener will show JMS Subscribers in red as expected (Response message: 0 message(s) received successfully) as expected;\n2.1)Stop running by Stop in menu;\n\n3) enable the JMS Publisher;\nthe one is placing one message to the same queue;\n\n4) run TP:\nER4: (expected result) \n4.1: the first call JMS Subscriber will fail with error as in step#2 as expected;\n4.2: JMS Publisher is placing one message in the queue without any error;\n4.3: second call of JMS Subcriber has to read the message (created on 4.2 step);\netc.\n\nAR:\n4.3: JMS Subscriber has always failed with the error - \"Response message: 0 message(s) received successfully\";\nand the queue is just growing;\n\nWork-around: restart Jmeter.\n\nMay 51997 issue be related to this one?", "count": 0, "id": 150591, "time": "2011-10-14T21:13:36Z", "creator": "slavko_h@yahoo.com", "creation_time": "2011-10-14T21:13:36Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 52034, "attachment_id": null, "text": "Hello,\nYour test plan has something strange.\nYou use publish/subscribe but your destination\nIs a dynamic queue.\n\nIs this regular ?\nYou Will note That if you run your test plan with\nOpenjms and Topic named topic1 n\u00f4 receiver\nWill receive any message since messages are not persistent.\nAnd I Think it is ok.\n\nRegards\nPhilippe", "id": 150596, "time": "2011-10-14T22:34:23Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2011-10-14T22:34:23Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 52034, "attachment_id": null, "text": "There are many cases in fact for JMS Topics and Non Persistent messages:\n\nDurable Subscription:\n- A subscriber must receive all messages that were sent to topic even if it was down (Note that I opened a bug with AMQ regarding this, bug id is 52036)\n\nNon Durable subscription:\n- A subscriber only receives messages that are sent to topic while subscriber is up\n\nRead this:\nhttp://download.oracle.com/javaee/1.3/jms/tutorial/1_3_1-fcs/doc/advanced.html#1024758\n\n\nYour case using Queues is not defined for me, it is strange that it even works.", "id": 150610, "time": "2011-10-15T12:17:49Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2011-10-15T12:17:49Z", "is_private": false}, {"count": 3, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "text": "Note that AMQ has same behaviour as OpenJMS when topics are used with Subscriber.\n\nDurable : Receive sees messages\nNon Durable : It does not see them\n\nOK according to JMS spec", "id": 150616, "time": "2011-10-15T12:56:25Z", "bug_id": 52034, "creation_time": "2011-10-15T12:56:25Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 52034, "attachment_id": null, "text": "Hi,\n\n1) that queue is regular (non-dynamic, just naming) and non-durable subscription.\n\n2) how you can explain the fact that if you stop TP by menu when the queue is empty - Jmeter is not closing established connection to AMQ;\n\nMy understanding is that \"JMS Subscriber\" has to close the connection.\n\n\nReopened", "id": 150677, "time": "2011-10-17T18:37:36Z", "creator": "slavko_h@yahoo.com", "creation_time": "2011-10-17T18:37:36Z", "is_private": false}, {"count": 5, "tags": [], "creator": "p.mouawad@ubik-ingenierie.com", "attachment_id": null, "id": 150682, "time": "2011-10-17T18:49:00Z", "bug_id": 52034, "creation_time": "2011-10-17T18:49:00Z", "is_private": false, "text": "(In reply to comment #4)\n> Hi,\n> \n> 1) that queue is regular (non-dynamic, just naming) and non-durable\n> subscription.\n> \nAS explained there is no issue when shutdown is used.\nIf durable subscriber is used it works\nOtherwise Subscriber (If only one) doesn't receive messages since it is not here when messsage is emitted to topic.\nAs also explained, Published works with Topics not Queues.\n\nI will mark this issue as duplicate of 51997 if you don't agree please reopen issue and explain what is the issue except for non closed connection.\n\n> 2) how you can explain the fact that if you stop TP by menu when the queue is\n> empty - Jmeter is not closing established connection to AMQ;\n> \n> My understanding is that \"JMS Subscriber\" has to close the connection.\n> \nSee issue 51997, it is an AMQ bug with interrupt().\n\n> \n> Reopened\n\n*** This bug has been marked as a duplicate of bug 51997 ***"}, {"attachment_id": null, "tags": [], "bug_id": 52034, "text": "r1183374\n\nI have used Shutdown from menu - same result as for Stop - the connection will not be closed;\n\nI agree that the issues is related to \"closing connection\" issue and can be marked as duplicated to some one.", "count": 6, "id": 150689, "time": "2011-10-17T19:38:32Z", "creator": "slavko_h@yahoo.com", "creation_time": "2011-10-17T19:38:32Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 52034, "attachment_id": null, "text": "I am sorry I don't reproduce the bug when using shutdown.\n\nAre you sure you restarted JMeter after using stop ? \n\nCan you attach the Test plan and describe precisely the scenario to reproduce issue ?\n\nThank you", "id": 150690, "time": "2011-10-17T19:52:12Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2011-10-17T19:52:12Z", "is_private": false}, {"count": 8, "tags": [], "creator": "slavko_h@yahoo.com", "attachment_id": null, "id": 150719, "time": "2011-10-18T18:18:18Z", "bug_id": 52034, "creation_time": "2011-10-18T18:18:18Z", "is_private": false, "text": "You are right.\nShutdown works fine.\n\nMarked as duplicated to 51997.\n\n*** This bug has been marked as a duplicate of bug 51997 ***"}]