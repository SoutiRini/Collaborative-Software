[{"count": 0, "tags": [], "bug_id": 41257, "is_private": false, "text": "Whenever I try to use any EL (either $ or # syntax) in a taglib tag's dynamic\nattribute in Tomcat 6.0.7, I get the following exception:\n\njava.lang.NullPointerException\n   at\norg.apache.jasper.compiler.Generator$GenerateVisitor.evaluateAttribute(Generator.java:2777)\n   at\norg.apache.jasper.compiler.Generator$GenerateVisitor.generateSetters(Generator.java:2988)\n   at\norg.apache.jasper.compiler.Generator$GenerateVisitor.generateCustomStart(Generator.java:2169)\n   at\norg.apache.jasper.compiler.Generator$GenerateVisitor.visit(Generator.java:1689)\n   at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1507)\n   at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2336)\n   at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2386)\n   at\norg.apache.jasper.compiler.Generator$GenerateVisitor.visit(Generator.java:1705)\n   at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1507)\n   at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2336)\n\nI traced into the source code of Tomcat 6.0.7 with a debugger and found out the\nexception is caused by the code at the mentioned line 2777 of Generator.java,\nwhich is trying to request a TagAttributeInfo from the current attribute, but\nfor a dynamic attribute the JspAttribute.tai field is always null.\n\nWhen I debug the evaluateAttribute method in question, I see that for\nNode.JspAttribute attr, the \"dynamic\" field (attr.dynamic) is correctly set to \ntrue and attr.getLocalName() returns the correct name of the dynamic attribute.\nAt line 2771 attr.isELInterpreterInput() returns true, since attr.el != null.\nWhen I inspect attr.el, I see the EL expresion is correctly parsed. Only, a few\nlines below that the code fails with the NPE upon accessing the TagAttributeInfo\nobject tai (which is, as said always null for dynamic attributes).", "id": 97435, "time": "2006-12-29T02:22:33Z", "creator": "arjan.tijms@mbuyu.nl", "creation_time": "2006-12-29T02:22:33Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 41257, "is_private": false, "text": "*** Bug 41258 has been marked as a duplicate of this bug. ***", "id": 97551, "time": "2007-01-02T17:03:51Z", "creator": "funkman@joedog.org", "creation_time": "2007-01-02T17:03:51Z", "attachment_id": null}, {"attachment_id": 21048, "tags": [], "creator": "lgalfaso@gmail.com", "text": "Created attachment 21048\nFix for Bug 41258\n\nI am not sure that bug 41257 and bug 41258 are the same issue, but I will trust\nfunkman as he knows more about Tomcat that what I do (and bug 41257 is not a\nvery clear description of the bug anyhow.)\n  This patch fixes the issue raised by 41258, this is literal expressions that\nmake use of EL escape syntax within custom tag attributes values are not\nunescaped.", "count": 2, "id": 109767, "time": "2007-10-25T21:37:08Z", "bug_id": 41257, "creation_time": "2007-10-25T21:37:08Z", "is_private": false}, {"count": 3, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "text": "With all the recent changes to EL processing in trunk a simple test case for this works for me.\n\nIf you still have a test case that fails with the latest source from trunk please feel free to re-open this bug and add your test case.", "id": 122181, "time": "2008-11-04T09:33:28Z", "bug_id": 41257, "creation_time": "2008-11-04T09:33:28Z", "is_private": false}]