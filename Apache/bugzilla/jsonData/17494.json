[{"count": 0, "tags": [], "creator": "stephen@basit.com", "attachment_id": null, "id": 32093, "time": "2003-02-27T15:45:16Z", "bug_id": 17494, "creation_time": "2003-02-27T15:45:16Z", "is_private": false, "text": "In 1.5.1 final:\nI read in an xls file that was previously created in Excel.\nI add several cells with values, and then\nI add several rows of cells that have a style with borders on three sides\n(I am creating a table with bordered cells).\nI am using a style repeatedly, which is created via this code:\n\nprivate static void constructExcelShadedCellStyleAX()\n{\nexcelShadedCellStyleAX = wb.createCellStyle();\nHSSFFont f = wb.createFont();\nf.setFontHeightInPoints((short) 10);\nexcelShadedCellStyleAX.setFont(f);\nexcelShadedCellStyleAX.setFillForegroundColor(HSSFColor.PALE_BLUE.index);\nexcelShadedCellStyleAX.setFillPattern(HSSFCellStyle.SOLID_FOREGROUND);\nexcelShadedCellStyleAX.setBorderLeft(HSSFCellStyle.BORDER_THIN);\nexcelShadedCellStyleAX.setBorderRight(HSSFCellStyle.BORDER_THIN);\nexcelShadedCellStyleAX.setBorderBottom(HSSFCellStyle.BORDER_THIN);\n}\n\nAfter modifying the file, I write it out to an xls file.\nThen I open it in Excel.\nWhen I use a style WITHOUT BORDERS, it works fine.\nWhen I use the above style, WITH BORDERS, when I open the\nnew Excel file, and put the cursor in any cell that touches\none of the cells where I have set the border, and then do\nfrom the Excel menu:  Format...Cells\nNothing happens at all. I do NOT get the normal \"Format Cells\"\ndialog box.  For other cells, it works normally. After\ntrying several cells, the Format...Cells function starts\nto work properly -- except that it still does not work\nfor those cells directly above and directly below the cells\nthat were formatted with a border."}, {"count": 1, "tags": [], "creator": "stephen@basit.com", "attachment_id": null, "id": 32095, "time": "2003-02-27T15:49:32Z", "bug_id": 17494, "creation_time": "2003-02-27T15:49:32Z", "is_private": false, "text": "Omit the statement:\nAfter trying several cells, the Format...Cells function starts\nto work properly.\nIt does NOT start to work properly."}, {"count": 2, "tags": [], "creator": "poi-support@buni.org", "attachment_id": null, "is_private": false, "id": 41355, "time": "2003-07-24T15:53:59Z", "bug_id": 17494, "creation_time": "2003-07-24T15:53:59Z", "text": "Has this been fixed in the 2.0-pre2 release?  I think it was some time ago. \nPlease let us know if it works with 2.0-pre2."}, {"count": 3, "tags": [], "creator": "avik@apache.org", "attachment_id": null, "id": 46522, "time": "2003-10-30T17:00:48Z", "bug_id": 17494, "creation_time": "2003-10-30T17:00:48Z", "is_private": false, "text": "Can someone do a compilable testcase please? I dont understand this bug!!"}, {"text": "Can someone do a compilable testcase please? I dont understand this bug!!", "tags": [], "bug_id": 17494, "is_private": false, "count": 4, "id": 46523, "time": "2003-10-30T17:01:30Z", "creator": "avik@apache.org", "creation_time": "2003-10-30T17:01:30Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "avik@apache.org", "attachment_id": null, "id": 46524, "time": "2003-10-30T17:02:03Z", "bug_id": 17494, "creation_time": "2003-10-30T17:02:03Z", "is_private": false, "text": "sorry, didnt mean to close bug"}, {"count": 6, "tags": [], "creator": "asf@sty.cjb.net", "attachment_id": null, "is_private": false, "id": 82125, "time": "2005-11-04T11:56:56Z", "bug_id": 17494, "creation_time": "2005-11-04T11:56:56Z", "text": "Just add a border to a cell using the usermodel, save the file\nand open it with Excel (2000, or XP or whatever).\n\nWhen you try to RightClick on the bordered cell to view\nthe cell format dialog it does not work.\nThe Cell format dialog does not appear at all.\n\nMaybe are the biff codes for cell borders not well\nwritten? It's a major flaw if you think the end user\nmay want to retouch manually the spreadsheet.\n"}, {"count": 7, "tags": [], "text": "The bug is still active for POI-3.0.1-FINAL.\n\nJust set a border style of a cell:\n\n\ncell.getCellStyle().setBorderLeft(HSSFCellStyle.BORDER_THIN)\n\n\nand the a right click on the bordered cell in Excel XP to view\nthe cell format dialog it does not work.", "attachment_id": null, "bug_id": 17494, "id": 106256, "time": "2007-08-03T05:20:18Z", "creator": "c.wolters@gmx.de", "creation_time": "2007-08-03T05:20:18Z", "is_private": false}, {"count": 8, "tags": [], "text": "You should set both border style and border color:\n\n style.setBorderTop(HSSFCellStyle.BORDER_THIN);\n style.setTopBorderColor(HSSFColor.BLACK.index);\n\nThis way it works fine for me.\n\nRegards,\nYegor", "attachment_id": null, "id": 106263, "creation_time": "2007-08-03T06:05:53Z", "time": "2007-08-03T06:05:53Z", "creator": "yegor@dinom.ru", "bug_id": 17494, "is_private": false}, {"count": 9, "tags": [], "text": "As you mentioned, I tried the following:\n\n style.setBorderTop(HSSFCellStyle.BORDER_THIN);\n style.setTopBorderColor(HSSFColor.BLACK.index);\n\nand it works.\n\nBut if I try to copy a color from a different cell style, the same problem occurs:\n\n style.setBorderTop(HSSFCellStyle.BORDER_THIN);\n style.setTopBorderColor(otherValidCellStyle.getTopBorderColor());\n\nHSSFColor.BLACK.index = 8\notherValidCellStyle.getTopBorderColor() = 0\n\nSetting the BorderColor to zero will result in the problem that the cell format\ndialog does not appear anymore.\n", "attachment_id": null, "bug_id": 17494, "id": 106266, "time": "2007-08-03T06:25:42Z", "creator": "c.wolters@gmx.de", "creation_time": "2007-08-03T06:25:42Z", "is_private": false}, {"count": 10, "tags": [], "text": "zero is not valid color index.\nIf otherValidCellStyle.getTopBorderColor() returns 0 it means that\notherValidCellStyle does not have top border. But if you call\notherValidCellStyleWithTopBorder.getTopBorderColor() it should work. \n\nRegards,\nYegor ", "attachment_id": null, "id": 106267, "creation_time": "2007-08-03T06:34:48Z", "time": "2007-08-03T06:34:48Z", "creator": "yegor@dinom.ru", "bug_id": 17494, "is_private": false}]