[{"count": 0, "tags": [], "text": "Defect report - briefly:\nTomcat implements \u201cvirtual webapp\u201d feature. For details, see http://tomcat.apache.org/tomcat-7.0-doc/config/context.html#Virtual_webapp\nTomcat 7.0.28 implementation of \u201cvirtual webapp\u201d has a defect \u2013 it does not allow developer to use tag library from WEB-INF/lib/*.jar. For example, developer can\u2019t put well known jstl-1.2.jar into WEB-INF/lib/ and use it.\n\nDefect report \u2013 detailed:\nProof of concept web application - lite-filter-mdot-1.0.0-BUILD-SNAPSHOT-sources.jar. Really, it\u2019s a sample web app downloaded from Spring Source.  You can download it from https://github.com/SpringSource/spring-mobile-samples. I just changed POM a little bit to remove redundant samples.\n\nError screenshot \u2013 error.png\n\nZipped tomcat CONF directory \u2013 defect-conf.zip\n======From Spring.xml========\n<Context path=\"/spring\" docBase=\"C:/Users/Filipp_Zuev/workspace/lite-filter-mdot/src/main/webapp\" >\n  <Resources className=\"org.apache.naming.resources.VirtualDirContext\"\n    extraResourcePaths=\n      \"/WEB-INF/classes=C:/Users/Filipp_Zuev/workspace/lite-filter-mdot/target/classes,/WEB-INF/lib=C:/Users/Filipp_Zuev/workspace/lite-filter-mdot/target/lite-filter-mdot-1.0.0-BUILD-SNAPSHOT/WEB-INF/lib\" />\n  <Loader className=\"org.apache.catalina.loader.VirtualWebappLoader\"\n    virtualClasspath=\"C:/Users/Filipp_Zuev/workspace/lite-filter-mdot/target/classes;\n      C:/Users/Filipp_Zuev/workspace/lite-filter-mdot/target/lite-filter-mdot-1.0.0-BUILD-SNAPSHOT/WEB-INF/lib/*.jar\" />\n  <JarScanner scanAllDirectories=\"true\" />\n</Context>\n=============\nTomcat log file - catalina.2012-07-12.log\n\nDefect\u2013fix suggested:\nAdd this method to org.apache.naming.resources.VirtualDirContext\n@Override\n\tprotected String doGetRealPath(String path) {\n        File file = file(path);\n        if(null!=file){\n        \treturn file.getAbsolutePath();\n        }else{\n        \treturn null;\n        }\n    }\n\nDefect\u2013fix suggested-proof of concept:\n1.\tDeploy attached tomcat-extension-0.0.1-SNAPSHOT.jar with me.tomcat.bugfix.workaround.VirtualDirContext.class into Tomcat\u2019s common lib directory.\n2.\tIn the Context configuration for the proof of concept application replace org.apache.naming.resources.VirtualDirContext for me.tomcat.bugfix.workaround.VirtualDirContext\n3.\tRestart tomcat. \nDefect fixed!", "is_private": false, "id": 160610, "creator": "philipzuev@gmail.com", "time": "2012-07-12T18:16:08Z", "bug_id": 53541, "creation_time": "2012-07-12T18:16:08Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 53541, "attachment_id": null, "is_private": false, "id": 160611, "time": "2012-07-12T18:29:58Z", "creator": "philipzuev@gmail.com", "creation_time": "2012-07-12T18:29:58Z", "text": "All configs, sources, logs mentioned in the defect report, can be downloaded here - https://docs.google.com/open?id=0B1YRF9AZ53VhSlJaRkY5dS1aZW8\n\nP.S.\nBugzilla limited me to 1kb per attachement, it's very unuseful."}, {"count": 2, "tags": [], "text": "For the record, the maximum permitted attachment size is 1MB, not 1KB. 1MB should be more than enough for any test case - even one packaged as a WAR - providing it meets the standard of \"the minimum necessary to demonstrate the bug\".", "is_private": false, "id": 161241, "creator": "markt@apache.org", "time": "2012-08-10T16:27:23Z", "bug_id": 53541, "creation_time": "2012-08-10T16:27:23Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 53541, "attachment_id": null, "id": 161243, "time": "2012-08-10T19:57:30Z", "creator": "markt@apache.org", "creation_time": "2012-08-10T19:57:30Z", "is_private": false, "text": "This has been fixed in trunk and 7.0.x and will be included in 7.0.30 onwards.\n\nRegarding the test case, it would have been a lot easier to work with if necessary files to recreate this were provided in a zip/tar.gz that matched the necessary file structure. A lot of reverse engineering was required to recreate the test case before the bug could be investigated."}, {"count": 4, "tags": [], "bug_id": 53541, "attachment_id": null, "is_private": false, "id": 161252, "time": "2012-08-11T05:44:34Z", "creator": "philipzuev@gmail.com", "creation_time": "2012-08-11T05:44:34Z", "text": "(In reply to comment #3)\n> This has been fixed in trunk and 7.0.x and will be included in 7.0.30\n> onwards.\n> \n> Regarding the test case, it would have been a lot easier to work with if\n> necessary files to recreate this were provided in a zip/tar.gz that matched\n> the necessary file structure. A lot of reverse engineering was required to\n> recreate the test case before the bug could be investigated.\nThank you for your response, Mark.\nIt's my pleasure to help you improve Tomcat!\nSorry, if test case was non convenient. Next time it will be better."}]