[{"count": 0, "tags": [], "bug_id": 55906, "attachment_id": 31132, "id": 171820, "time": "2013-12-18T20:21:27Z", "creator": "rado.georgiev@ontario.ca", "creation_time": "2013-12-18T20:21:27Z", "is_private": false, "text": "Created attachment 31132\nPatch to correct HSSF evaluator/parser\n\nThis patch modifies the parse/evaluator to enable multisheet references in formulae to be properly evaluated. Such formulae take the form SheetA:SheetB, such as SUM(Sheet1:Sheet3!A1). POI usually ignores the second sheet and only thinks the formulae is SUM(Sheet1!A1).\n\nSteps to reproduce\n1. Create a workbook with two sheets (Sheet1, Sheet2)\n2. On each tab enter 1 for cell A1\n3. On the first sheet enter formula '=SUM(Sheet1:Sheet2!A1)' for the formula for cell A2\n\nExpected Result:\nA2 should be equal to 2\n\nActual Result:\nA2 equals 1\n\nFixed checked with 3.8, 3.9, 3.10-beta1, 3.10-beta2, 3.10-beta3. It works with all versions.\n\nNote: I have only fixed the XLS evaluator/parser (HSSF), the XLSX (XSSF) does not yet work.\n\nNote2: There are unit tests for XSSF that currently as well (they fail since the fix is not ported to XSSF)."}, {"count": 1, "tags": [], "creator": "mark_golden@btinternet.com", "attachment_id": null, "text": "Hi,\n\nI am using poi-3.10-FINAL-20140208.jar and am encountering this 55906 error. I see there is a patch for this problem but I would not have a clue where to start as I'm not a JAVA programmer.\n\nIs there any date set that it will be included in the '.jar' file?\n\nRegards,\nMark.", "id": 176132, "time": "2014-07-01T12:57:48Z", "bug_id": 55906, "creation_time": "2014-07-01T12:57:48Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 55906, "attachment_id": null, "id": 176134, "time": "2014-07-01T14:19:01Z", "creator": "apache@gagravarr.org", "creation_time": "2014-07-01T14:19:01Z", "is_private": false, "text": "This is a fairly hefty patch, so it needs some review, ideally by someone who knows about formulas\n\nFor now, it would be helpful if someone could try applying it to a svn checkout from trunk, then report:\n * Does it apply cleanly to trunk?\n * Do all the unit tests pass with it applied?\n * Do normal formulas still work with it?\n * Do multisheet ones work?\n\nIf we know all of those are good, it'll hopefully be quicker for one of our formula experts to then review + apply the patch"}, {"count": 3, "tags": [], "creator": "mark_golden@btinternet.com", "attachment_id": null, "text": "Hi Nick,\n\nThanks for the reply. I'll wait for the patch to be applied.  \n\nThanks,\nMark.", "id": 176135, "time": "2014-07-01T14:39:35Z", "bug_id": 55906, "creation_time": "2014-07-01T14:39:35Z", "is_private": false}, {"count": 4, "tags": [], "text": "I've done some work on this today, cherrypicking bits out of this patch, and doing some fairly liberal refactoring of the formula code too. (Now we have external name / sheet support in the XSSF formula parser, it's much clearer which bits of the hssf external sheet support can be refactored and which ones matter). It's quite a lot of work, but without this patch it's more than I'd have considered even starting!\n\nAs of r1613317, POI can now correctly read and render a multi-sheet formula string from a cell, i.e. cell.getCellFormula() now returns the right thing. If you ask FormulaParser to parse a multi-sheet reference, it no longer objects, and returns useful ptgs, but it doesn't yet do enough to support a round-tripping of a formula\n\nNext step - get the round-tripping working, so that the last part of TestFormulaParser.testMultiSheetReference() can be enabled\n\nFuture step - evaluator support", "attachment_id": null, "id": 176676, "creator": "apache@gagravarr.org", "time": "2014-07-24T22:54:58Z", "bug_id": 55906, "creation_time": "2014-07-24T22:54:58Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 55906, "text": "As of r1613467, I believe that full support (including evaluation, for those functions which support it) is now in place\n\nThe remaining this is to add in the unit tests kindly provided by Radoslav in the patch, and use those to verify it's completely implemented now", "id": 176688, "time": "2014-07-25T16:43:59Z", "creator": "apache@gagravarr.org", "creation_time": "2014-07-25T16:43:59Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 55906, "text": "Unit tests added in r1613654, thanks for providing such a good set!", "id": 176694, "time": "2014-07-26T15:20:32Z", "creator": "apache@gagravarr.org", "creation_time": "2014-07-26T15:20:32Z", "is_private": false, "attachment_id": null}]