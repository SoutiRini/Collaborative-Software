[{"count": 0, "attachment_id": null, "bug_id": 37470, "text": "1. Create a httpd.conf with 1500 websites. Every VirtualHost section should be \nlike this:\n\n<VirtualHost xxxx>\nServerName testXXX\nServerAlias testXXX.com\nServerAdmin webmaster@testXXX.com\nDocumentRoot /home/testXXX/public_html\nScriptAlias /cgi-local/ /home/testXXX/public_html/cgi-local/\nSetEnv LOG_SUBDIR testXXX\nSuexecUserGroup testXXX testXXX\nJkMount /*.jsp ajp13\nJkMount /servlet/* ajp13\n</VirtualHost>\n<VirtualHost xxxx:443>\nServerName testXXX\nServerAlias testXXX.com\nServerAdmin webmaster@testXXX.com\nDocumentRoot /home/testXXX/public_html\nScriptAlias /cgi-local/ /home/testXXX/public_html/cgi-local/\nSetEnv LOG_SUBDIR testXXX\nSuexecUserGroup testXXX testXXX\nJkMount /*.jsp ajp13\nJkMount /servlet/* ajp13\n</VirtualHost>\n\n2. create a simple script:\n\n#!/usr/bin/perl\n\nprint \"Content-Type: text/html\\n\\n\";\nprint \"Test!!\";\n\n3. execute on the web\n  \nActual results:\n\nIn a Dual Xeon, zero load, it takes 2 seconds to run.\n\nI did some straces:\n\nstrace -T -f -p xxxxx\n\n[pid 30864] read(4, \"\", 4096)           = 0 <0.000022>\n[pid 30864] close(4)                    = 0 <0.000016>\n[pid 30864] read(3, \"\", 4096)           = 0 <0.000014>\n[pid 30864] close(3)                    = 0 <0.000012>\n[pid 30864] write(1, \"Content-Type: text/html\\n\\nTest\"..., 72) = 72 <0.000020>\n[pid 30785] <... poll resumed> [{fd=26, events=POLLIN, revents=POLLIN}, {fd=28, \nevents=POLLIN}], 2, 30000) = 1 <2.120682>\n\nIn \"LogLevel debug\", I see: \n\n[Fri Nov 11 12:55:50 2005] [25756:39072] [debug] jk_cleanup_shmem::mod_jk.c \n(1761): Shmem cleanup\n[Fri Nov 11 12:55:53 2005] [25756:39072] [debug] jk_cleanup_shmem::mod_jk.c \n(1761): Shmem cleanup\n\n(> 2 seconds !!)\n\nIf I remove all the JkMount mapping, the CGI execution is very fast. So there \nis definitely an issue with mod_jk. \n\nwith mod_jk -> more than 2 seconds\nwithout mod_jk -> a few milliseconds\n\nOBS: Those tests were done in a server without load. I simply turn apache \n2.0.52 on and requested the CGI execution. \n\nI can test any patch.", "id": 82396, "time": "2005-11-11T18:07:36Z", "creator": "reweiner@yahoo.com", "creation_time": "2005-11-11T18:07:36Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 37470, "attachment_id": null, "id": 82584, "time": "2005-11-16T20:15:25Z", "creator": "yoavs@computer.org", "creation_time": "2005-11-16T20:15:25Z", "is_private": false, "text": "\n\n*** This bug has been marked as a duplicate of 37469 ***"}]