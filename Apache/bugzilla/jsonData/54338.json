[{"count": 0, "tags": [], "creator": "xshao@ebay.com", "text": "Created attachment 29786\nTest case for \"Set\"\n\nIt uses \"Class.cast\" to convert an object to a given class in the code generated by tagPlugin \"Set\".\n\nIt causes an exception when the value is primitive type,\nHere is a sample,\n\nCaused by: java.lang.ClassCastException: Cannot cast class java.lang.Integer to int\n        at java.lang.Class.cast(Class.java:1711)\n        at org.apache.jsp.WEB_002dINF.views.error_jsp._jspService(error_jsp.java:108)\n        at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:668)\n        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)\n        ... 52 more\n\n\nThe correct way is to use \"ELSupport.coerceToType\".\nAttached a patch and test case for this issue.", "id": 164200, "time": "2012-12-21T12:00:09Z", "bug_id": 54338, "creation_time": "2012-12-21T12:00:09Z", "is_private": false, "attachment_id": 29786}, {"count": 1, "attachment_id": 29787, "bug_id": 54338, "text": "Created attachment 29787\nPatch for Set.java", "id": 164201, "time": "2012-12-21T12:00:56Z", "creator": "xshao@ebay.com", "creation_time": "2012-12-21T12:00:56Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "text": "Is it appropriate to perform a \"coerce\" instead of a simple cast? (I don't know whether the spec covers this case). If the only problem is primitive types, I think this can be solved without the complexity of formal coercion.", "is_private": false, "id": 164343, "creator": "chris@christopherschultz.net", "time": "2013-01-03T04:00:34Z", "bug_id": 54338, "creation_time": "2013-01-03T04:00:34Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 54338, "is_private": false, "count": 3, "id": 164370, "time": "2013-01-04T07:04:05Z", "creator": "xshao@ebay.com", "creation_time": "2013-01-04T07:04:05Z", "text": "Yes.\n\nThe problem isn't only from primitive types.\nPerform a \"coerce\" is a better choice.\n\n(In reply to comment #2)\n> Is it appropriate to perform a \"coerce\" instead of a simple cast? (I don't\n> know whether the spec covers this case). If the only problem is primitive\n> types, I think this can be solved without the complexity of formal coercion."}, {"count": 4, "attachment_id": null, "bug_id": 54338, "text": "It is not a question of what is appropriate or what is best, the JSTL specification requires that an EL coerce is used.\n\nI'm looking at this now. The test case is going to need some work.", "id": 164386, "time": "2013-01-04T21:35:14Z", "creator": "markt@apache.org", "creation_time": "2013-01-04T21:35:14Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "creator": "markt@apache.org", "text": "Many thanks for the patch. It has been applied to trunk and 7.0.x and will be included in 7.0.35 onwards.\n\nI added a different test case to trunk that tests that the coercion works rather than tests the source code for a particular string. Note that the trunk tests for the tag plug-ins depend on the new resources implementation so they have not been back-ported to 7.0.x.", "id": 164394, "time": "2013-01-04T22:10:32Z", "bug_id": 54338, "creation_time": "2013-01-04T22:10:32Z", "is_private": false, "attachment_id": null}]