[{"count": 0, "tags": [], "creator": "justin.sands@actechnology.com", "text": "The EntityResolver set on XMLReader via XMLReader.setEntityResolver(ER) is\nsometimes called and sometimes not called depending on the format of the URI for\nthe DTD.\n\nI am trying to use my entity resolver to load the DTD out of the classpath.\n\nHowever, my Entity Resolver, ER is not always called.  The behavior seems to\ndepend on the format of the URI.  If the parser thinks it knows how to resolve\nthe URI then it does not call the entity resolver and instead tries to use some\ndefault resolver (which cant find the DTD since i'm loading it out of the\nclasspath).\n\nFor example:\n\nThese entities will try to use the default resolver\n <!DOCTYPE Modules SYSTEM \"MatchingEngineEngineConfig.dtd\">\n <!DOCTYPE Modules SYSTEM \"justin:MatchingEngineEngineConfig.dtd\">\n <!DOCTYPE Modules SYSTEM \"classpath:MatchingEngineEngineConfig.dtd\">\n\nHowever these entities will use the custom resolver.\n <!DOCTYPE Modules SYSTEM \"file://MatchingEngineEngineConfig.dtd\">\n\nI see 1 bug, and one missing feature here:\n 1) The javadoc for XMLReader.setEntityResolver() needs to be updated\n    to specify this behavior.  I would like to know specifically when\n    the custom entity resolver will be called and when it wont.\n\n 2) There should be some way to FORCE the parser to use the entity resolver\n    no matter what.  This behavior is intimately coupled with using the \n    XMLReader.parse(InputSource) method instead of using the \n    XMLReader.parse(systemID) method.  There should be a method:\n\n              XMLReader.parse(InputSource, EntityResolver) \n\n    since when you are using an input source you have some reason \n    to avoid the nomral file system mechanisms.\n    (i.e. you have XML and DTDs in a database or an encrypted jar file).\n\n---[ code snippet : getting and configuring the reader ]----------\n\nXMLContentHandler handler = new XMLContentHandler();\nXMLReader reader = null;\nSAXParserFactory factory = javax.xml.parsers.SAXParserFactory.newInstance();\nSAXParser parser = factory.newSAXParser();\nreader = parser.getXMLReader();\nreader.setFeature(\"http://xml.org/sax/features/validation\", true);\nreader.setContentHandler(handler);\nreader.setDTDHandler(handler);\nreader.setEntityResolver(new ClasspathDTDResolver(\"com/mycorp/mypackage\"));\nreader.setErrorHandler(handler);\n\nInputStream xmlInputStream=getClass().getClassLoader().getResourceAsStream(xmlFile);\nreader.parse(new InputSource(xmlInputStream));\n\n------------------------", "id": 63911, "time": "2004-09-20T19:34:42Z", "bug_id": 31317, "creation_time": "2004-09-20T19:34:42Z", "is_private": false, "attachment_id": null}]