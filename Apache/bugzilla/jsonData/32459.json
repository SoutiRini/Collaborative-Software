[{"count": 0, "tags": [], "bug_id": 32459, "text": "Mladen's changes to introduce the balancer/worker abstractions included a\nserious regression: \"module-driven\" reverse-proxying no longer works; i.e. a\nnon-proxy module can no longer decide to force a request to be reverse-proxied.\n\nThis is used by the pretty essential mod_rewrite feature, \"RewriteRule ... [P]\",\nfor example, but also by users of mod_perl.\n\nThis should probably be a showstopper for taking 2.1 out of \"alpha\".", "id": 67653, "time": "2004-11-30T21:23:40Z", "creator": "jorton@redhat.com", "creation_time": "2004-11-30T21:23:40Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 32459, "is_private": false, "count": 1, "id": 67654, "time": "2004-11-30T21:24:54Z", "creator": "jorton@redhat.com", "creation_time": "2004-11-30T21:24:54Z", "text": "The t/modules/rewrite.t tests in httpd-test test for this feature."}, {"count": 2, "tags": [], "creator": "mturk@apache.org", "text": "Can you write a simple two line config example where it breaks.\nI think fixing this shouldn't be a problem cause we have a generic worker\nfor forward proxies that can be used for reverse too.\n\nThe t/modules/rewrite.t is written in perl that I newer learned neither\nhave plans to do so :).\n", "id": 67659, "time": "2004-11-30T21:54:33Z", "bug_id": 32459, "creation_time": "2004-11-30T21:54:33Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "One line is sufficient:\n\nRewriteRule ^/(.*) http://www.apache.org/$1 [P]\n\nthis should be functionally equivalent to\n\nProxyPass / http://www.apache.org/\n", "is_private": false, "id": 67660, "creator": "jorton@redhat.com", "time": "2004-11-30T22:02:50Z", "bug_id": 32459, "creation_time": "2004-11-30T22:02:50Z", "attachment_id": null}, {"count": 4, "tags": [], "text": "Solution is to add a generic reverse proxy worker like there is a \ngeneric forward worker.\nThe problem is how to enable this worker.\nCurrent forward worker is created when you put 'ProxyRequests On'.\nI can enable one by default, but IMO adding an extra directive like\n'ProxyReverse On' will be better, but it would require an extra config line.\n\nI have both solution patches workable.\n", "is_private": false, "bug_id": 32459, "id": 67684, "time": "2004-12-01T09:27:49Z", "creator": "mturk@apache.org", "creation_time": "2004-12-01T09:27:49Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 32459, "text": "I think ideally it should work by default with no extra mod_proxy configuration\nneeded.", "count": 5, "id": 67685, "time": "2004-12-01T09:32:17Z", "creator": "jorton@redhat.com", "creation_time": "2004-12-01T09:32:17Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 32459, "is_private": false, "count": 6, "id": 67686, "time": "2004-12-01T09:46:37Z", "creator": "mturk@apache.org", "creation_time": "2004-12-01T09:46:37Z", "text": "Commited.\nYou'll need to recompile entire proxy.\n\nCan you run all the tests against this patch?\nIt works with Rewrite, but it might break something on the road."}, {"count": 7, "tags": [], "bug_id": 32459, "is_private": false, "id": 67692, "attachment_id": null, "creator": "jorton@redhat.com", "creation_time": "2004-12-01T14:17:04Z", "time": "2004-12-01T14:17:04Z", "text": "Thanks for looking into this, Mladen.\n\nThe basic regression is fixed but it seems that the QUERY_STRING is not getting\npassed through with the example RewriteRule I gave, so it looks like there are\nstill some issues.  That area was rather a nightmare already though...\n"}, {"count": 8, "tags": [], "text": "OK. I think I got the idea about the problem.\nI'll dig into it and drop a note when resolved.\n\n", "is_private": false, "bug_id": 32459, "id": 67693, "time": "2004-12-01T14:58:02Z", "creator": "mturk@apache.org", "creation_time": "2004-12-01T14:58:02Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 32459, "is_private": false, "count": 9, "id": 70095, "time": "2005-01-26T12:12:08Z", "creator": "jorton@redhat.com", "creation_time": "2005-01-26T12:12:08Z", "text": "Any progress on this, Mladen?"}, {"count": 10, "tags": [], "bug_id": 32459, "attachment_id": null, "is_private": false, "id": 70098, "time": "2005-01-26T15:40:53Z", "creator": "mturk@apache.org", "creation_time": "2005-01-26T15:40:53Z", "text": "Sorry, forgot to drop the note as promised :)\nI've added generic reverse worker and it should work now.\nCan you check too and close the issue?\n"}, {"count": 11, "tags": [], "text": "Per discussion above: it passes simple tests except that the QUERY_STRING is not\nbeing passed through.", "is_private": false, "bug_id": 32459, "id": 70101, "time": "2005-01-26T16:12:15Z", "creator": "jorton@redhat.com", "creation_time": "2005-01-26T16:12:15Z", "attachment_id": null}, {"count": 12, "tags": [], "text": "The problem is with FIX_15027.\nYou can comment the define and it works.\nFIX_15027 fixed a lot (well, not so sure),\nbut now proxy_canon hook is never called, and thus r->filename\nis not set. I'll try to see how to re-enable proxy_canon hook.\n", "is_private": false, "id": 70312, "creator": "mturk@apache.org", "time": "2005-02-01T18:30:21Z", "bug_id": 32459, "creation_time": "2005-02-01T18:30:21Z", "attachment_id": null}, {"count": 13, "tags": [], "bug_id": 32459, "text": "Jim committed a fix for this: and I apologise for blaming Mladen since this was\nunrelated to the balancer/worker code!\n\nhttp://svn.apache.org/viewcvs.cgi?rev=151153&view=rev", "id": 70501, "attachment_id": null, "creator": "jorton@redhat.com", "creation_time": "2005-02-04T15:18:03Z", "time": "2005-02-04T15:18:03Z", "is_private": false}]