[{"count": 0, "tags": [], "bug_id": 49428, "attachment_id": 25584, "id": 137567, "time": "2010-06-11T07:34:22Z", "creator": "past@ebs.gr", "creation_time": "2010-06-11T07:34:22Z", "is_private": false, "text": "Created attachment 25584\nThe patch for WebdavServlet\n\nThe WebdavServlet does not work with native Windows clients besides the deprecated Web Folders. The more modern, common and supported by Microsoft client, Windows Mini-Redirector that allows mapping of WebDAV shares to local drives cannot mount a WebDAV share served by tomcat's WebdavServlet.\n\nYou can observe this by using the following command from a windows machine:\n\n> net use * http://hostname:8080/webdav\n\nIt should fail without the attached patch. The reason is that:\n\nDAV: namespaced elements in a PROPFIND responses can not use a default namespace; each element must be explicitly prefixed with a namespace prefix defined in itself or a parent. If a default namespace is used the client will give no errors, but will not display any resources.\n\nThis is mentioned here, albeit for a single Windows version, Windows Server 2003:\n\nhttp://www.greenbytes.de/tech/webdav/webdav-redirector-list.html\n\nI have verified that the patch fixes WebDAV mounts for Windows XP, Vista & 7."}, {"count": 1, "tags": [], "creator": "past@ebs.gr", "text": "I should mention that the patch is against trunk revision 953660 and that I have also tested that it works fine for OS X and Linux clients.", "id": 137571, "time": "2010-06-11T08:11:23Z", "bug_id": 49428, "creation_time": "2010-06-11T08:11:23Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "creator": "markt@apache.org", "text": "Please run the litmus test suite with your patch. Whilst the current implementation has some failures (and patches for those would be welcome too) the current patch for this issue causes additional failures.\n\nI have taken a quick look at what is going on with tcpmon from the Apache Axis project and it looks like xmlns:D=\"DAV:\" is being added in some circumstances without D: then being added to some (all?) elements.\n\nI'd be happy to apply this patch once it does not add to the number of litmus failures.", "id": 138136, "time": "2010-07-04T18:08:41Z", "bug_id": 49428, "creation_time": "2010-07-04T18:08:41Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "past@ebs.gr", "text": "(In reply to comment #2)\n> Please run the litmus test suite with your patch. Whilst the current\n> implementation has some failures (and patches for those would be welcome too)\n> the current patch for this issue causes additional failures.\n> \n> I have taken a quick look at what is going on with tcpmon from the Apache Axis\n> project and it looks like xmlns:D=\"DAV:\" is being added in some circumstances\n> without D: then being added to some (all?) elements.\n> \n> I'd be happy to apply this patch once it does not add to the number of litmus\n> failures.\n\nI did run the litmus tests before submitting the patch and AFAIR there were no regressions. Do you have a list of the tests that fail with the patch?", "id": 138174, "time": "2010-07-05T11:13:54Z", "bug_id": 49428, "creation_time": "2010-07-05T11:13:54Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "markt@apache.org", "text": "The additional failures were in the lock tests. Test 6 failed first and that triggered multiple additional failures.", "id": 138176, "time": "2010-07-05T12:27:53Z", "bug_id": 49428, "creation_time": "2010-07-05T12:27:53Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 49428, "attachment_id": 25764, "text": "Created attachment 25764\nThe patch for WebdavServlet\n\nThis new patch fixes the regressions in the litmus lock tests. Now the litmus tests score the same with and without the patch (but of course Windows Mini-Redirector clients only work with the latter).", "id": 138441, "time": "2010-07-15T11:29:16Z", "creator": "past@ebs.gr", "creation_time": "2010-07-15T11:29:16Z", "is_private": false}, {"count": 6, "attachment_id": null, "creator": "markt@apache.org", "text": "Patch applied to 7.0.x and will be in 7.0.1\n\nMany thanks.\n\nNote: I'll need to update the WebDAVFixFilter to take account of this.", "id": 138459, "time": "2010-07-16T08:01:18Z", "bug_id": 49428, "creation_time": "2010-07-16T08:01:18Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "bug_id": 49428, "attachment_id": null, "text": "Hi All - \n\nFor each element we are putting D: prefix. But still we have the issue in Windows7, Linux and Mac. It works fine in XP.  Below is the XMl response content generated by XMLWriter.\nWe have our own webdav servlet which extends webdavserlet\norg.apache.catalina.servlets.WebdavServlet;\npublic class FolderServlet extends WebdavServlet {\n\n@@@@@@@@@@@@@@@@@@@@@@ \n\n<?xml version=\"1.0\" encoding=\"utf-8\" ?> \n- <D:multistatus xmlns:D=\"DAV:\" xmlns:b=\"urn:uuid:c2f41010-65b3-11d1-a29f-00aa00c14882/\">\n- <D:response>\n  <D:href>SimpleFolder</D:href> \n- <D:propstat>\n- <D:prop>\n+ <D:creationdate b:dt=\"dateTime.tz\">\n- <![CDATA[ 2010-09-30T15:36:21Z\n  ]]> \n  </D:creationdate>\n- <D:getlastmodified b:dt=\"dateTime.rfc1123\">\n- <![CDATA[ Thu, 30 Sep 2010 19:36:21 GMT\n  ]]> \n  </D:getlastmodified>\n  <D:displayname>SimpleFolder</D:displayname> \n- <D:resourcetype>\n  <D:collection /> \n  </D:resourcetype>\n  <D:source /> \n- <D:supportedlock>\n- <D:lockentry>\n- <D:lockscope>\n  <D:exclusive /> \n  </D:lockscope>\n- <D:locktype>\n  <D:write /> \n  </D:locktype>\n  </D:lockentry>\n- <D:lockentry>\n- <D:lockscope>\n  <D:shared /> \n  </D:lockscope>\n- <D:locktype>\n  <D:write /> \n  </D:locktype>\n  </D:lockentry>\n  </D:supportedlock>\n  </D:prop>\n  <D:status>HTTP/1.1 200 OK</D:status> \n  </D:propstat>\n- <D:propstat>\n- <D:prop>\n  <D:name /> \n  <D:parentname /> \n  <D:ishidden /> \n  <D:isreadonly /> \n  <D:getcontenttype /> \n  <D:contentclass /> \n  <D:getcontentlanguage /> \n  <D:lastaccessed /> \n  <D:getcontentlength /> \n  <D:iscollection /> \n  <D:isstructureddocument /> \n  <D:defaultdocument /> \n  <D:isroot /> \n  </D:prop>\n  <D:status>HTTP/1.1 404 Not Found</D:status> \n  </D:propstat>\n  </D:response>\n  </D:multistatus>", "id": 140335, "time": "2010-09-30T16:26:26Z", "creator": "saiyedzahid@hotmail.com", "creation_time": "2010-09-30T16:26:26Z", "is_private": false}, {"count": 8, "tags": [], "bug_id": 49428, "attachment_id": null, "id": 140336, "time": "2010-09-30T16:29:03Z", "creator": "saiyedzahid@hotmail.com", "creation_time": "2010-09-30T16:29:03Z", "is_private": false, "text": "What happens is we are able to map the drive in windows explorer in windows7 but it creates three mappings and when you click on each mapping it does not open the sub folders on the right side of the windows explorer so you can't edit them. It works fine in XP but not in Windows7, Mac and linux. \n\n(In reply to comment #7)\n> Hi All - \n> For each element we are putting D: prefix. But still we have the issue in\n> Windows7, Linux and Mac. It works fine in XP.  Below is the XMl response\n> content generated by XMLWriter.\n> We have our own webdav servlet which extends webdavserlet\n> org.apache.catalina.servlets.WebdavServlet;\n> public class FolderServlet extends WebdavServlet {\n> @@@@@@@@@@@@@@@@@@@@@@ \n> <?xml version=\"1.0\" encoding=\"utf-8\" ?> \n> - <D:multistatus xmlns:D=\"DAV:\"\n> xmlns:b=\"urn:uuid:c2f41010-65b3-11d1-a29f-00aa00c14882/\">\n> - <D:response>\n>   <D:href>SimpleFolder</D:href> \n> - <D:propstat>\n> - <D:prop>\n> + <D:creationdate b:dt=\"dateTime.tz\">\n> - <![CDATA[ 2010-09-30T15:36:21Z\n>   ]]> \n>   </D:creationdate>\n> - <D:getlastmodified b:dt=\"dateTime.rfc1123\">\n> - <![CDATA[ Thu, 30 Sep 2010 19:36:21 GMT\n>   ]]> \n>   </D:getlastmodified>\n>   <D:displayname>SimpleFolder</D:displayname> \n> - <D:resourcetype>\n>   <D:collection /> \n>   </D:resourcetype>\n>   <D:source /> \n> - <D:supportedlock>\n> - <D:lockentry>\n> - <D:lockscope>\n>   <D:exclusive /> \n>   </D:lockscope>\n> - <D:locktype>\n>   <D:write /> \n>   </D:locktype>\n>   </D:lockentry>\n> - <D:lockentry>\n> - <D:lockscope>\n>   <D:shared /> \n>   </D:lockscope>\n> - <D:locktype>\n>   <D:write /> \n>   </D:locktype>\n>   </D:lockentry>\n>   </D:supportedlock>\n>   </D:prop>\n>   <D:status>HTTP/1.1 200 OK</D:status> \n>   </D:propstat>\n> - <D:propstat>\n> - <D:prop>\n>   <D:name /> \n>   <D:parentname /> \n>   <D:ishidden /> \n>   <D:isreadonly /> \n>   <D:getcontenttype /> \n>   <D:contentclass /> \n>   <D:getcontentlanguage /> \n>   <D:lastaccessed /> \n>   <D:getcontentlength /> \n>   <D:iscollection /> \n>   <D:isstructureddocument /> \n>   <D:defaultdocument /> \n>   <D:isroot /> \n>   </D:prop>\n>   <D:status>HTTP/1.1 404 Not Found</D:status> \n>   </D:propstat>\n>   </D:response>\n>   </D:multistatus>"}, {"count": 9, "tags": [], "creator": "markt@apache.org", "text": "There are lots of things that can go wrong with WebDAV. The users list is the place to get help.\n\nMeanwhile, I've propose this fix for 6.0.x", "id": 140339, "time": "2010-09-30T17:53:02Z", "bug_id": 49428, "creation_time": "2010-09-30T17:53:02Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 49428, "attachment_id": null, "text": "Patch has been withdrawn for 6.0.x and reverted for 7.0.x\n\nSee http://tomcat.markmail.org/thread/u5i5blwrsxf2h3zv for reasoning.", "id": 140720, "time": "2010-10-13T10:23:56Z", "creator": "markt@apache.org", "creation_time": "2010-10-13T10:23:56Z", "is_private": false}, {"count": 11, "attachment_id": null, "creator": "knst.kolinko@gmail.com", "text": "I reimplemented the fix in trunk in r1022120 and it will be in 7.0.4.\nProposed it for 6.0.x.", "id": 140726, "time": "2010-10-13T11:37:54Z", "bug_id": 49428, "creation_time": "2010-10-13T11:37:54Z", "tags": [], "is_private": false}, {"count": 12, "tags": [], "creator": "markt@apache.org", "text": "Alternative patch applied to 6.0.x and will be in 6.0.30 onwards.", "id": 140753, "time": "2010-10-14T11:07:35Z", "bug_id": 49428, "creation_time": "2010-10-14T11:07:35Z", "is_private": false, "attachment_id": null}]