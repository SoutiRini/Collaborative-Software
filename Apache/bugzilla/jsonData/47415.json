[{"count": 0, "tags": [], "creator": "luc.girardin@macrofocus.com", "text": "Created attachment 23866\nExcel document that throws RecordFormatException\n\nTrying to read various XLS files (example attached) created by Excel 2008 for Mac (v. 12.1.9) using POI 3.5 beta 6 systematically throws the following exception with :\n\norg.apache.poi.hssf.record.RecordFormatException: Duplicate PageSettingsBlock record (sid=0x4d)\n\tat org.apache.poi.hssf.record.aggregates.PageSettingsBlock.checkNotPresent(PageSettingsBlock.java:202)\n\tat org.apache.poi.hssf.record.aggregates.PageSettingsBlock.readARecord(PageSettingsBlock.java:168)\n\tat org.apache.poi.hssf.record.aggregates.PageSettingsBlock.<init>(PageSettingsBlock.java:80)\n\tat org.apache.poi.hssf.model.Sheet.<init>(Sheet.java:221)\n\tat org.apache.poi.hssf.model.Sheet.createSheet(Sheet.java:161)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:288)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:202)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:318)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:299)\n\tat org.apache.poi.ss.usermodel.WorkbookFactory.create(WorkbookFactory.java:60)\n\nPOI 3.5 beta 5 had no problem with these files. The same document in XLSX format reads just fine.", "id": 128226, "time": "2009-06-24T04:37:37Z", "bug_id": 47415, "creation_time": "2009-06-24T04:37:37Z", "is_private": false, "attachment_id": 23866}, {"count": 1, "tags": [], "creator": "josh@apache.org", "attachment_id": null, "text": "Fixed in svn r788157\n\njunit added\n\nDo you have any details as to how to add setup info for two printers on the one worksheet?  It wasn't obvious how to do this in my Excel(Win/2007).", "id": 128242, "time": "2009-06-24T12:47:45Z", "bug_id": 47415, "creation_time": "2009-06-24T12:47:45Z", "is_private": false}, {"count": 2, "tags": [], "creator": "dfisher@jmlafferty.com", "attachment_id": 23872, "text": "Created attachment 23872\nThe original file printed in landscape and printed once from 12.1.9 Excel 2008 - 090515\n\nJosh,I opened and saved the OP's file using Excel 12.1.9 (090515) on my Office 2008. The resulting file was slightly larger. This version was switched to landscape and printed before saving. Maybe this will help.\n\nBTW - there are two spots where Excel for mac allows the page setup to be changed, one is on the Print dialog and the other is from the File menu's Page Setup item. Could this be the difference? Could the Print dialog save a driver specific form of the PageSettings block?\n\nLet me know if you want me to perform more careful testing.", "id": 128246, "time": "2009-06-24T13:56:38Z", "bug_id": 47415, "creation_time": "2009-06-24T13:56:38Z", "is_private": false}, {"count": 3, "tags": [], "creator": "josh@apache.org", "text": "(In reply to comment #2)\n> Created an attachment (id=23872) [details]\n\nSo the new attachment has both PLS records present but minor changes seem to be made in each.  When I re-saved the file with my Excel(Win/2007), both PLS records were removed.  This might have happened because my machine didn't know anything about the printers specified (in those records).\n\nI guess it's not too important right now (how multiple PLS records work) but this information might be useful in the future if someone wants to extend POI support for print setup.", "id": 128247, "time": "2009-06-24T14:14:45Z", "bug_id": 47415, "creation_time": "2009-06-24T14:14:45Z", "is_private": false, "attachment_id": null}]