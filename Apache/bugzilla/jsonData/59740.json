[{"count": 0, "tags": [], "creator": "solid.danil@gmail.com", "attachment_id": 33971, "is_private": false, "id": 191880, "time": "2016-06-22T08:17:47Z", "bug_id": 59740, "creation_time": "2016-06-22T08:17:47Z", "text": "Created attachment 33971\ntests and patch\n\nAfter Bug 58443 was implemented, on row shifting it's possible to get next error: \"Cannot add merged region A1:F1 to sheet because it overlaps with an existing merged region (A1:G1)\".\n\nSteps to reproduce:\n1. Create merged region A1:G1 in row 0\n2. Create merged region A1:F1 in row 1\n3. Shift row 1 to 0 position.\n\nI've fixed it by deleting overlapped by shifting merged regions. Tests are provided. Please review and apply."}, {"count": 1, "tags": [], "creator": "onealj@apache.org", "attachment_id": null, "is_private": false, "id": 191891, "time": "2016-06-22T18:27:13Z", "bug_id": 59740, "creation_time": "2016-06-22T18:27:13Z", "text": "Correction:\n(In reply to Danil Lopatin from comment #0)\n> Steps to reproduce:\n> 1. Create merged region A1:G1 in row 0\n> 2. Create merged region *A2:F2* in row 1\n> 3. Shift row 1 to 0 position.\n\nThanks for the patch and test.  Silently deleting merged regions seems reasonable to me as long as we document is behavior the least surprising behavior here?\n\n* Silently deleting merged regions: would the merged regions in the source or destination row get deleted? Probably delete destination. We could certainly write this event to the POILogger for those who check it.\n* Throwing an exception: any changes would need to be backed out or the check would need to be done before rows are removed"}, {"count": 2, "tags": [], "bug_id": 59740, "is_private": false, "id": 191892, "creation_time": "2016-06-22T18:29:42Z", "time": "2016-06-22T18:29:42Z", "creator": "onealj@apache.org", "text": "> Thanks for the patch and test.  Silently deleting merged regions seems\n> reasonable to me as long as we document its behavior.\n\n> What are people's thoughts on the least surprising\n> behavior here?", "attachment_id": null}, {"count": 3, "tags": [], "text": "I hope this fix will be included in 3.15 version.\nIf you want, I could update documentation.", "attachment_id": null, "bug_id": 59740, "id": 192243, "time": "2016-07-08T14:06:58Z", "creator": "solid.danil@gmail.com", "creation_time": "2016-07-08T14:06:58Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 59740, "is_private": false, "text": "(In reply to Danil Lopatin from comment #3)\n> If you want, I could update documentation.\n\nYes, please include a patch for the updated documentation, and I will commit the code changes and documentation together.", "id": 192251, "time": "2016-07-08T18:09:05Z", "creator": "onealj@apache.org", "creation_time": "2016-07-08T18:09:05Z", "attachment_id": null}, {"count": 5, "tags": [], "creator": "solid.danil@gmail.com", "attachment_id": 34042, "is_private": false, "id": 192406, "time": "2016-07-15T16:40:33Z", "bug_id": 59740, "creation_time": "2016-07-15T16:40:33Z", "text": "Created attachment 34042\npatch, tests and updated javadoc\n\nI updated java documentation. Hope haven't missed some other documentations (like src/documentation). If so, please let me know. Thanks."}, {"count": 6, "tags": [], "bug_id": 59740, "is_private": false, "text": "Applied via r1752997, thanks a lot for the patch and test-cases!", "id": 192425, "time": "2016-07-16T20:54:06Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-07-16T20:54:06Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 59740, "is_private": false, "id": 196750, "creation_time": "2017-02-06T10:24:36Z", "time": "2017-02-06T10:24:36Z", "creator": "david.leniniven@amalto.com", "text": "The shiftRows method works as expected if we shift only one row at a time, but if we try to shift several rows in a single call, it removes all merged areas for the shifted rows.\n\nFor instance, if we have a Xlsx document with 2 merged cells A3:B3\nAssuming lastRowNum = sheet.getLastRowNum();\n\nExecuting the following code will removed this merged region : \n\nsheet.shiftRows(1, lastRowNum+1, -1, true, false);\n\nWhereas the following code will keep the shift the merged region into A2:B2 \n\nfor(int currentRow = 1; currentRow <=lastRowNum+1; currentRow++) {\n    sheet.shiftRows(currentRow, currentRow, -1, true, false);\n}", "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 59740, "is_private": false, "text": "(In reply to David Le Niniven from comment #7)\n> The shiftRows method works as expected if we shift only one row at a time,\n> but if we try to shift several rows in a single call, it removes all merged\n> areas for the shifted rows.\n\nPlease open a new bug, adding bug 59740 as a blocker for the new bug.", "id": 196839, "time": "2017-02-08T06:32:05Z", "creator": "onealj@apache.org", "creation_time": "2017-02-08T06:32:05Z", "attachment_id": null}]