[{"count": 0, "tags": [], "creator": "limesdevelopment@gmail.com", "text": "I got the message : Exception in thread \"main\" org.apache.poi.openxml4j.exceptions.OpenXML4JRuntimeException: Rule M2.4 exception : this error should NEVER happen! Please raise a bug at https://bz.apache.org/bugzilla/enter_bug.cgi?product=POI and attach a file that triggers it, thanks!\n\tat org.apache.poi.openxml4j.opc.internal.ContentTypeManager.getContentType(ContentTypeManager.java:343)\n\tat org.apache.poi.openxml4j.opc.internal.ContentTypeManager.removeContentType(ContentTypeManager.java:256)\n\tat org.apache.poi.openxml4j.opc.OPCPackage.removePart(OPCPackage.java:943)\n\tat org.apache.poi.openxml4j.opc.PackagePart.getOutputStream(PackagePart.java:522)\n\tat org.apache.poi.xssf.usermodel.XSSFWorkbook.commit(XSSFWorkbook.java:1678)\n\tat org.apache.poi.POIXMLDocumentPart.onSave(POIXMLDocumentPart.java:341)\n\tat org.apache.poi.POIXMLDocument.write(POIXMLDocument.java:206)\n\nSince the file that triggers it is fairly big I'm attaching the code that triggers it.\nThis code is the very beginning, the only lines before it are declarations and initializations. Written in Java 8 u 74. Good luck ! :)\n\nfor(String folder : godine){\n            XSSFWorkbook wbTemp = new XSSFWorkbook();\n            wbTemp.createSheet();\n            FileOutputStream fo = new FileOutputStream(lokacijaResursa+\"\\\\statistika-\"+folder+\".xlsx\");\n            HashMap<String,Integer> pozicija = new HashMap<>();\n            napraviCelije(wbTemp,100,200);\n            for(int i=1;i<=12;i++) {\n                try {\n                    XSSFWorkbook mjesec = new XSSFWorkbook(new FileInputStream(new File(lokacijaResursa + \"\\\\\" + folder + \"\\\\\" + i + \".xlsx\")));\n                    XSSFSheet sheetMjesec = mjesec.getSheetAt(0);\n                    popuni(wbTemp, mjesec, pozicija, i);\n                }\n                catch (Exception ex){}\n            }\n            wbTemp.write(fo);\n            fo.close();\n            XSSFWorkbook wb = new XSSFWorkbook(new FileInputStream(lokacijaResursa+\"\\\\statistika-\"+folder+\".xlsx\"));\n            int numOfCells = 0;\n            try{\n                for(int i=3;;i++){\n                    Row r = wb.getSheetAt(0).getRow(1);\n                    Cell c = r.getCell(i,Row.CREATE_NULL_AS_BLANK);\n                    if(c.getCellType() == Cell.CELL_TYPE_BLANK)\n                        break;\n                    numOfCells++;\n                }\n                for(int i=2;;i++){\n                    Row r = wb.getSheetAt(0).getRow(i);\n                    if(r.getCell(0,Row.CREATE_NULL_AS_BLANK).getCellType() == Cell.CELL_TYPE_BLANK)\n                        break;\n                    for(int j=3;j<numOfCells;j++){\n                        Cell c = r.getCell(j,Row.CREATE_NULL_AS_BLANK);\n                        if(c.getCellType() == Cell.CELL_TYPE_BLANK)\n                            break;\n                        else c.setCellValue(0);\n                    }\n                }\n            }\n            catch (NullPointerException ex){\n                System.out.println(\"Nema fajlova\");\n                System.exit(0);\n            }\n            wb.close();\n            fo = new FileOutputStream(new File(lokacijaResursa+\"\\\\statistika-\"+folder+\".xlsx\"));\n            wb.write(fo);\n            fo.close();\n        }", "id": 189333, "time": "2016-03-10T01:03:19Z", "bug_id": 59159, "creation_time": "2016-03-10T01:03:19Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 59159, "attachment_id": null, "text": "Duplicate of bug 59159 as far as I see, please reopen with description why it should be handled separatedely if this is not the case.\n\n*** This bug has been marked as a duplicate of bug 59158 ***", "id": 189388, "time": "2016-03-11T22:36:21Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2016-03-11T22:36:21Z", "is_private": false}]