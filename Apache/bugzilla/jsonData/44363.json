[{"count": 0, "tags": [], "text": "Moving out site onto a new Windows 2003 server, same Apache config, static \nfile downloads are limited to 350-600Kb/sec.  The new server is on a gigE \nconnection.  The previous server gave us 2MB/sec download.  Both are similar \nhardware - Dell 2950/1950 with 4GB RAM and dual quad-core xeon.  Both on same \nOS.\n\nInstall of IIS maxes out bandwidth of the visitor's connection - I've seen \n2.5MB/sec.\n\nFTP maxes out connection, even when testing on port 80.\n\nSince IIS & FileZilla FTP both max out the connection and Apache is 1/6 the \nspeed, I'm assumming there is an incompatiblity somewhere.  I reinstalled both \n2.2.8 and 2.2.6 without SSL, vanilla and wiped out the httpd.conf - but no \nbetter.", "is_private": false, "id": 113460, "creation_time": "2008-02-05T20:33:38Z", "time": "2008-02-05T20:33:38Z", "creator": "apache@codeinfusion.com", "bug_id": 44363, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 44363, "text": "This is a question that should be tried first on a user-support forum like the\nusers@httpd.apache.org mailing list before filing a bug report.\n\n(Before you post to the users list, try the standard win32 trick:\nEnableSendfile off\nEnableMMAP off\nWin32DiableAcceptEx\n)", "id": 113489, "time": "2008-02-06T10:54:23Z", "creator": "slive@apache.org", "creation_time": "2008-02-06T10:54:23Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 44363, "attachment_id": null, "is_private": false, "id": 113490, "time": "2008-02-06T11:19:33Z", "creator": "trawick@apache.org", "creation_time": "2008-02-06T11:19:33Z", "text": "(In reply to comment #1)\n> This is a question that should be tried first on a user-support forum like the\n> users@httpd.apache.org mailing list before filing a bug report.\n> \n> (Before you post to the users list, try the standard win32 trick:\n\nanother thing to try \n\nSendBufferSize 10000000\n\n(number is probably overkill, but sufficient for testing the theory; I saw a\ncomplaint recently that Apache on Windows was using much smaller TCP windows\nthan IIS; I don't think \"ReceiveBufferSize 10000000\" would help here)\n"}, {"attachment_id": null, "tags": [], "bug_id": 44363, "is_private": false, "count": 3, "id": 113497, "time": "2008-02-06T13:21:39Z", "creator": "apache@codeinfusion.com", "creation_time": "2008-02-06T13:21:39Z", "text": "I tried all of the tricks suggested with no significant success.  I did notice \nthat EnableSendfile off did double my download speeds to 700Kb/sec, but \nunfortunately, the other options didn't make a difference.  I had great hope \nfor the ReceiveBufferSize, but it seems that my Window Size is sufficent."}, {"count": 4, "tags": [], "bug_id": 44363, "text": "I've noticed that file download sent via PHP \"streaming\" using the PEAR \nHTTP_Download package are sending at full speed.  Just static content is \nslowed.", "id": 113503, "time": "2008-02-06T21:53:19Z", "creator": "apache@codeinfusion.com", "creation_time": "2008-02-06T21:53:19Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "wrowe@apache.org", "attachment_id": null, "text": "Just to verify...\n\nYou did confirm that EnableSendfile Off speeds things up?  Does EnableMMAP Off\nfurther change the performance for better or worse?", "id": 113507, "time": "2008-02-07T00:08:42Z", "bug_id": 44363, "creation_time": "2008-02-07T00:08:42Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 44363, "is_private": false, "count": 6, "id": 113524, "time": "2008-02-07T06:23:40Z", "creator": "apache@codeinfusion.com", "creation_time": "2008-02-07T06:23:40Z", "text": "EnableSendfile Off speeds up static file transfers from about 350Kb/sec to \n750Kb/sec.  No other setting helps.  \nPHP streaming transfers max out the visitor's connection speed - for me it is \nabout 2MB/sec."}, {"count": 7, "tags": [], "creator": "apache@codeinfusion.com", "attachment_id": null, "text": "(In reply to comment #6)\nEnableMMAP Off had no noticable effect.\n\n", "id": 113525, "time": "2008-02-07T06:24:34Z", "bug_id": 44363, "creation_time": "2008-02-07T06:24:34Z", "is_private": false}, {"count": 8, "tags": [], "text": "If all these dont work:\n\nEnableSendfile off\nEnableMMAP off\nWin32DiableAcceptEx\nSendBufferSize ...\n\nThen this is one last thing to try (it did the trick for me on W2k3 R2):\nSet in your Windows registry\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Afd\\Parameters\n\nDefaultSendWindow\nDefaultReceiveWindow\n\nTo something like 65535. You'll probably have to create the DWORD values. Reboot afterwards and that should do the trick.\n\nIt appears that Apache fails to set the buffer size (without printing warnings) or its setting is ignored by Windows for some reason.", "attachment_id": null, "bug_id": 44363, "id": 144001, "time": "2011-02-05T17:42:48Z", "creator": "df@forlix.org", "creation_time": "2011-02-05T17:42:48Z", "is_private": false}, {"count": 9, "tags": [], "creator": "covener@gmail.com", "attachment_id": null, "text": "Please let us know if the global send buffer size was different then the directive.  I've observed this myself.", "id": 148450, "time": "2011-08-07T00:15:25Z", "bug_id": 44363, "creation_time": "2011-08-07T00:15:25Z", "is_private": false}]