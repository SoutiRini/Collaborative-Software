[{"count": 0, "tags": [], "text": "I'm getting the following exception from time to time, when generating a complex\nchart graphic:\n\njava.lang.ArrayIndexOutOfBoundsException: 28 >= 10\n\tat java.util.Vector.elementAt(Vector.java:432)\n\tat org.apache.batik.svggen.DOMTreeManager.appendGroup(DOMTreeManager.java:175)\n\tat org.apache.batik.svggen.DOMGroupManager.addElement(DOMGroupManager.java:159)\n\tat org.apache.batik.svggen.SVGGraphics2D.fill(SVGGraphics2D.java:1384)\n\tat\norg.apache.batik.ext.awt.g2d.AbstractGraphics2D.drawGlyphVector(AbstractGraphics2D.java:960)\n\tat sun.font.ExtendedTextSourceLabel.handleDraw(ExtendedTextSourceLabel.java:131)\n\tat sun.font.Decoration.drawTextAndDecorations(Decoration.java:99)\n\tat sun.font.ExtendedTextSourceLabel.draw(ExtendedTextSourceLabel.java:135)\n\tat java.awt.font.TextLine.draw(TextLine.java:550)\n\tat java.awt.font.TextLayout.draw(TextLayout.java:2699)\n\tat com.werum.chartgen.Axis.drawYAxis(Axis.java:313)\n\tat com.werum.chartgen.Axis.draw(Axis.java:130)\n\tat com.werum.chartgen.CoordPlane.drawAxes(CoordPlane.java:165)\n\tat com.werum.chartgen.CoordPlane.draw(CoordPlane.java:138)\n\tat com.werum.chartgen.Chart.draw(Chart.java:144)\n\tat com.werum.chartgen.Chart.draw(Chart.java:155)\n\tat com.werum.chartgen.test.TestChart02.run(TestChart02.java:87)\n\tat com.werum.chartgen.test.TestChart02.main(TestChart02.java:261)\n\nThe code of method DOMTreeManager.appendGroup is rather short:\n\n    public void appendGroup(Element group, DOMGroupManager groupManager){\n        topLevelGroup.appendChild(group);\n        int nManagers = groupManagers.size();\n        for(int i=0; i<nManagers; i++){\n            DOMGroupManager gm = (DOMGroupManager)groupManagers.elementAt(i);\n            if( gm != groupManager )\n                gm.recycleCurrentGroup();\n        }\n    }\n\nI think the problem has something to do with the disposer thread running in the\nbackground and modifying the 'groupManagers' Vector during the iteration. This\nhappens when SVGGraphics2D objects are disposed:\n\n    public void dispose() {\n        this.domTreeManager.removeGroupManager(this.domGroupManager);\n    }\n\nMy proposal is to protect the 'groupManagers' Vector against modifications\nduring iterations in class DOMTreeManager. Because I have compiled batik from\nsource, I will make the modification and test it in my environment.\n\nCurrently I'm working on a Fedora Core5 Linux using Eclipse 3.2 and JDK\n1.5.0_09, but I have seen the same problem on a Windows XP environment.\n\nBernd", "is_private": false, "id": 94523, "creator": "bernd.fechner@werum.de", "time": "2006-10-05T07:06:18Z", "bug_id": 40686, "creation_time": "2006-10-05T07:06:18Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 40686, "attachment_id": 18999, "text": "Created attachment 18999\nModified class DOMTreeManager\n\nThis is the modified DOMTreeManager with synchronization around the\ngroupManagers member. It works in my test environment.", "id": 94808, "time": "2006-10-13T07:08:55Z", "creator": "bernd.fechner@werum.de", "creation_time": "2006-10-13T07:08:55Z", "is_private": false}, {"count": 2, "tags": [], "creator": "info@dvholten.de", "text": "fixed in svn 522302", "id": 100898, "time": "2007-03-25T10:07:35Z", "bug_id": 40686, "creation_time": "2007-03-25T10:07:35Z", "is_private": false, "attachment_id": null}]