[{"count": 0, "tags": [], "bug_id": 3589, "attachment_id": null, "id": 5483, "time": "2001-09-13T09:39:17Z", "creator": "rickard@xpedio.com", "creation_time": "2001-09-13T09:39:17Z", "is_private": false, "text": "When deploying a WAR file ny putting it in /webapps and starting Catalina \"the \nusual way\", it works.\n\nWhen deploying the same WAR file through the JMX EmbeddedManager MBean (from \nwithin JBoss) it chokes while parsing the TLD somehow. The Catalina logs say \nthis:\n2001-09-13 17:12:35 ContextConfig[/webwork]: Scanning web.xml tag libraries\n2001-09-13 17:12:35 ContextConfig[/webwork]:   URI='webwork', \nResourcePath='/WEB-INF/lib/webwork.jar'\n2001-09-13 17:12:35 ContextConfig[/webwork]:     \ntldConfigJar(/WEB-INF/lib/webwork.jar): java.lang.IllegalStateException: zip \nfile closed\n2001-09-13 17:12:35 ContextConfig[/webwork]:     \ntldConfigTld(/WEB-INF/lib/webwork.jar): org.xml.sax.SAXParseException: The \nmarkup in the document preceding the root element must be well-formed.\n2001-09-13 17:12:35 ContextConfig[/webwork]: Scanning library JAR files\n...\n\nWhat could be wrong? Is it in Catalina or the calling code? Any ideas?\n\nThis is the last stumbling block before I have Catalina integrated with JBoss...\n\n/Rickard"}, {"count": 1, "tags": [], "bug_id": 3589, "attachment_id": null, "text": "Can I build the full package from the jBoss tree ?\n\nI assume the problem is with the Embedded deployment scenario, but I \nwould have assumed we would have had that issue reported by the J2EE \nRI, since they also use the Embedded class (the wrapper MBean just \ncalls it without doing anything significant).", "id": 5486, "time": "2001-09-13T14:31:38Z", "creator": "remm@apache.org", "creation_time": "2001-09-13T14:31:38Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 3589, "attachment_id": null, "text": "I tried reproducing the problem with the Embedded class itself, using the \nincluded example (the Main method), and Webwork 0.95.\nTo summarize, it worked for me.\n\nI put all the jars in my server/lib dir, and typed:\njava -Dcatalina.home=D:\\cvs\\jakarta-tomcat-4.0\\build -cp jakarta-regexp-\n1.2.jar;jaxp.jar;crimson.jar;catalina.jar;servlets-common.jar;servlets-\ncgi.jar;servlets-cgi.jar;servlets-default.jar;servlets-invoker.jar;servlets-\nmanager.jar;servlets-snoop.jar;servlets-ssi.jar;servlets-\nwebdav.jar;naming.jar;resources.jar;servlet.jar;bootstrap.jar;jasper-\ncompiler.jar;jasper-runtime.jar;namingfactory.jar;tools.jar \norg.apache.catalina.startup.Embedded\n\nIn Embedded.Main, I added:\n        Context webwork = embedded.createContext(\"/webwork\", home \n+ \"/webapps/webwork\");\n        host.addChild(webwork);\n\nThe logs are (with a few added debug lines):\n<snip/>\nXmlMapper: org.apache.catalina.core.StandardContext.addServletMapping( \n*.action, action)\nXmlMapper: org.apache.catalina.core.StandardContext.addWelcomeFile( index.jsp)\nXmlMapper: org.apache.catalina.core.StandardContext.addTaglib( webwork, /WEB-\nINF/lib/webwork.jar)\nXmlMapper: Debug level: 3\nXmlMapper: Validating = true\nContextConfig[/webwork]: Scanning web.xml tag libraries\nContextConfig[/webwork]:   URI='webwork', ResourcePath='/WEB-\nINF/lib/webwork.jar'\nContextConfig[/webwork]:     tldConfigJar(/WEB-INF/lib/webwork.jar): Processing \nentry 'META-INF/taglib.tld'\nXmlMapper: Set locator : org.apache.crimson.parser.Parser2$DocLocator@7ebe1\nResolve: -//Sun Microsystems, Inc.//DTD JSP Tag Library 1.1//EN \nhttp://java.sun.com/j2ee/dtds/web-jsptaglib_1_1.dtd\n  Using alternate DTD /javax/servlet/jsp/resources/web-jsptaglibrary_1_1.dtd\nContextConfig[/webwork]: Scanning library JAR files\nContextConfig[/webwork]:     tldConfigJar(/WEB-INF/lib/webwork.jar): Processing \nentry 'META-INF/taglib.tld'\nXmlMapper: Set locator : org.apache.crimson.parser.Parser2$DocLocator@d85f79\nResolve: -//Sun Microsystems, Inc.//DTD JSP Tag Library 1.1//EN \nhttp://java.sun.com/j2ee/dtds/web-jsptaglib_1_1.dtd\n  Using alternate DTD /javax/servlet/jsp/resources/web-jsptaglibrary_1_1.dtd\nContextConfig[/webwork]: Added certificates -> request attribute Valve\nContextConfig[/webwork]: Pipline Configuration:\nContextConfig[/webwork]:   org.apache.catalina.valves.CertificatesValve/1.0\nContextConfig[/webwork]:   org.apache.catalina.core.StandardContextValve/1.0\nContextConfig[/webwork]: ======================\nStandardContext[/webwork]: Configuring application event listeners\n<snip/>\n\nTo add additional info, apply this patch to the ContextConfig source:\nRCS file: /home/cvs/jakarta-tomcat-\n4.0/catalina/src/share/org/apache/catalina/startup/ContextConfig.java,v\nretrieving revision 1.52\ndiff -r1.52 ContextConfig.java\n1112a1113\n>             e.printStackTrace();\n\nThat should tell us which operation caused the problem.\n\nNote: All this is tested using Win2k + JDK 1.4 b2", "id": 5514, "time": "2001-09-13T22:21:32Z", "creator": "remm@apache.org", "creation_time": "2001-09-13T22:21:32Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 3589, "attachment_id": null, "text": "This was fixed by using the WebappLoader instead of the StandardLoader.\n\nSo, JBoss can now use Catalina as webserver for WAR deployments. Neat.\n\nThx for your help in finding this bug!\n\n/R\n", "id": 5534, "time": "2001-09-14T05:31:35Z", "creator": "rickard@xpedio.com", "creation_time": "2001-09-14T05:31:35Z", "is_private": false}]