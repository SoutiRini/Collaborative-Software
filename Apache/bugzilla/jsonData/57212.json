[{"count": 0, "tags": [], "bug_id": 57212, "attachment_id": null, "id": 179097, "time": "2014-11-14T05:31:58Z", "creator": "vasilev@fastvps.ru", "creation_time": "2014-11-14T05:31:58Z", "is_private": false, "text": "Apache Internal error with send headers > 8Kb, for example:\n\nfunction randomPassword($len) {\n    $alphabet = \"abcdefghijklmnopqrstuwxyzABCDEFGHIJKLMNOPQRSTUWXYZ0123456789\";\n    for ($i = 0; $i < $len; $i++) {\n        $n = rand(0, count($alphabet)-1);\n        $pass .= $alphabet[$n];\n    }\n    return $pass;\n}\nsetcookie(\"test\", randomPassword(8173));\n\nAnd this code OK:\n\nfunction randomPassword($len) {\n    $alphabet = \"abcdefghijklmnopqrstuwxyzABCDEFGHIJKLMNOPQRSTUWXYZ0123456789\";\n    for ($i = 0; $i < $len; $i++) {\n        $n = rand(0, count($alphabet)-1);\n        $pass .= $alphabet[$n];\n    }\n    return $pass;\n}\nsetcookie(\"test\", randomPassword(8172));\n\nDifference in one byte.\n\nPlease, check."}, {"count": 1, "tags": [], "bug_id": 57212, "text": "This is a restriction imposed by the core APIs which modules like mod_fcgid use to read the response header (ap_scan_script_header_err_core() and friends).", "id": 179104, "time": "2014-11-14T21:48:19Z", "creator": "trawick@apache.org", "creation_time": "2014-11-14T21:48:19Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 57212, "text": "(In reply to Jeff Trawick from comment #1)\n> This is a restriction imposed by the core APIs which modules like mod_fcgid\n> use to read the response header (ap_scan_script_header_err_core() and\n> friends).\n\nYou can fix this? How?", "id": 179107, "time": "2014-11-14T23:38:28Z", "creator": "vasilev@fastvps.ru", "creation_time": "2014-11-14T23:38:28Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "trawick@apache.org", "attachment_id": null, "text": ">You can fix this? How?\n\nIt may be possible to recompile everything with a bigger MAX_STRING_LEN, but I can't confirm that.\n\nThe right solution seems to be new APIs in httpd core, and changes to modules like mod_fcgid to use the new APIs.  The new APIs would respect user configuration of higher limits for script header size, just as the LimitRequestFieldSize directive controls something similar for client request headers.", "id": 179109, "time": "2014-11-14T23:47:12Z", "bug_id": 57212, "creation_time": "2014-11-14T23:47:12Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "vasilev@fastvps.ru", "text": "#define MAX_STRING_LEN 256(In reply to Jeff Trawick from comment #3)\n\nHow much increase?\nLimitRequestFieldSize present in Apache 2.2, but does not help :(\n\n> >You can fix this? How?\n> \n> It may be possible to recompile everything with a bigger MAX_STRING_LEN, but\n> I can't confirm that.\n> \n> The right solution seems to be new APIs in httpd core, and changes to\n> modules like mod_fcgid to use the new APIs.  The new APIs would respect user\n> configuration of higher limits for script header size, just as the\n> LimitRequestFieldSize directive controls something similar for client\n> request headers.", "count": 4, "id": 179110, "time": "2014-11-15T00:04:40Z", "bug_id": 57212, "creation_time": "2014-11-15T00:04:40Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 57212, "attachment_id": null, "id": 179111, "time": "2014-11-15T00:37:18Z", "creator": "trawick@apache.org", "creation_time": "2014-11-15T00:37:18Z", "is_private": false, "text": ">define MAX_STRING_LEN 256\n\nThat's the definition in a couple of utility programs.\n\nIt would need to be edited in httpd.h to be larger than 8192.  It is probably less risky to keep MAX_STRING_LEN and HUGE_STRING_LEN equivalent, so\n\n/* old value: #define HUGE_STRING_LEN 8192 */\n#define HUGE_STRING_LEN 10000\n\n10000 assumes that your cookies aren't so big.\n\nYou'd have to recompile all of httpd, mod_fcgid, and any other third-party modules that use HUGE_STRING_LEN.  And I'm not sure if it would all work.\n\nPerhaps you can reduce the size of your cookie."}, {"count": 6, "tags": [], "bug_id": 57212, "attachment_id": null, "id": 179112, "time": "2014-11-15T01:45:27Z", "creator": "vasilev@fastvps.ru", "creation_time": "2014-11-15T01:45:27Z", "is_private": false, "text": "Yes, this solved problem. Thanks!\n\n(In reply to Jeff Trawick from comment #5)\n> >define MAX_STRING_LEN 256\n> \n> That's the definition in a couple of utility programs.\n> \n> It would need to be edited in httpd.h to be larger than 8192.  It is\n> probably less risky to keep MAX_STRING_LEN and HUGE_STRING_LEN equivalent, so\n> \n> /* old value: #define HUGE_STRING_LEN 8192 */\n> #define HUGE_STRING_LEN 10000\n> \n> 10000 assumes that your cookies aren't so big.\n> \n> You'd have to recompile all of httpd, mod_fcgid, and any other third-party\n> modules that use HUGE_STRING_LEN.  And I'm not sure if it would all work.\n> \n> Perhaps you can reduce the size of your cookie."}, {"text": "Let's leave this open to track a better solution in the future.  Many users, such as those that obtain httpd from the OS, aren't able to recompile everything.", "tags": [], "creator": "trawick@apache.org", "attachment_id": null, "count": 7, "id": 179116, "time": "2014-11-15T12:29:57Z", "bug_id": 57212, "creation_time": "2014-11-15T12:29:57Z", "is_private": false}]