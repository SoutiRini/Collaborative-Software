[{"count": 0, "tags": [], "text": "", "is_private": false, "id": 177394, "creation_time": "2014-08-27T11:30:05Z", "time": "2014-08-27T11:30:05Z", "creator": "cmb-apache@corefiling.co.uk", "bug_id": 56892, "attachment_id": null}, {"count": 1, "tags": [], "text": "Created attachment 31948\nPatch to add XSSFSheet.addNumberStoredAsTextIgnoredError\n\nThe attached patch adds methods on XSSFSheet to set number-stored-as-text warnings as ignored for a region without requiring the caller to dig into CTWorksheet.", "is_private": false, "id": 177395, "creation_time": "2014-08-27T11:31:44Z", "time": "2014-08-27T11:31:44Z", "creator": "cmb-apache@corefiling.co.uk", "bug_id": 56892, "attachment_id": 31948}, {"count": 2, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "Thanks for this\n\nLooking at the code and unit test, I wonder if it might be worth making it a bit more general?\n\nFor example, define an enum of the kinds of errors that can be ignored (taken from the ones CTIgnoredError defines), then have the method be more like:\n\naddIgnoredError(CellRangeAddress, IgnoredErrorType)\n\n(Or does that need to be a list/array of ignored types? Does Excel support setting multiple?)\n\nBonus marks (=possible pint of your choice in a handy Oxford pub!) if you could also provide a nice getter for these ignored errors too :)", "id": 177399, "time": "2014-08-27T12:02:43Z", "bug_id": 56892, "creation_time": "2014-08-27T12:02:43Z", "is_private": false}, {"count": 3, "tags": [], "text": "See also bug 54868, bug 46136", "is_private": false, "id": 183488, "creation_time": "2015-06-12T15:41:10Z", "time": "2015-06-12T15:41:10Z", "creator": "dtn-asfbugs@corefiling.co.uk", "bug_id": 56892, "attachment_id": null}, {"count": 4, "tags": [], "text": "Excel supports multiple ignoredError elements. Furthermore, the flags on each one are not mutually exclusive, so if a given cell range has the same error(s) they can be expressed by one element.\n\nI'll work on generalising the API as suggested.", "is_private": false, "bug_id": 56892, "id": 187621, "time": "2016-01-13T17:16:52Z", "creator": "dtn-asfbugs@corefiling.co.uk", "creation_time": "2016-01-13T17:16:52Z", "attachment_id": null}, {"count": 5, "tags": [], "text": "I've checked in an attempt at a generalised API in SVN r1724469\n\nNick, is that approximately what you had in mind?\n\nWhether this can be generalised to cover HSSF too is best left for bug 46136, I think. It's unclear whether all the types of ignored error are applicable to the HSSF format.", "attachment_id": null, "id": 187625, "creation_time": "2016-01-13T17:54:59Z", "time": "2016-01-13T17:54:59Z", "creator": "dtn-asfbugs@corefiling.co.uk", "bug_id": 56892, "is_private": false}, {"count": 6, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 187658, "time": "2016-01-14T09:44:06Z", "bug_id": 56892, "creation_time": "2016-01-14T09:44:06Z", "is_private": false, "text": "For the HSSF stuff, look at FeatFormulaErr2\n\nLooks at first glance like the list is almost the same. Assuming that's really the case, it'd probably be best to put the IgnoredErrorType interface into the common SS usermodel, but without the CT stuff. Add a helper / child interface in xssf that does that part\n\nIt might be good to create test .xls and .xlsx files, with some ignored errors in them, then write a XSSF-specific getter test for it\n\nI think that writing a HSSF getter for existing ignores should be quite quick, as we have the record code needed. We could then use the same test to check it\n\nWriting the HSSF add will take a bit more, as you need to create / update the right records in the right order"}, {"count": 7, "tags": [], "text": "David - are you happy to make these changes, or do you need someone else to try?", "attachment_id": null, "id": 188360, "creation_time": "2016-02-11T15:18:00Z", "time": "2016-02-11T15:18:00Z", "creator": "apache@gagravarr.org", "bug_id": 56892, "is_private": false}, {"count": 8, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "id": 188440, "time": "2016-02-15T15:01:25Z", "bug_id": 56892, "creation_time": "2016-02-15T15:01:25Z", "is_private": false, "text": "As of r1730543, I've moved the enum into the main ss package, and documented those entries that I can from the XLS spec. That leaves a couple needing descriptions that I think are XLSX-only.\n\nI haven't added the matching HSSF support using FeatFormulaErr2, that remains for #46136"}]