[{"count": 0, "attachment_id": null, "bug_id": 38486, "is_private": false, "id": 85337, "time": "2006-02-02T11:19:42Z", "creator": "thestonefox@hotmail.com", "creation_time": "2006-02-02T11:19:42Z", "tags": [], "text": "When I try and use the getFillBackgroundColor() method it does not return the\ncorrect index\n\nit returns 64 if the cell has a colour (regardless of what the colour is)\nand it returns 65 if the cell has no colour\n\ngetFillForegroundColor() returns the correct colour index though, so I assume\nthis is a bug in getFillBackgroundColour()\n\nI am using this on Excel 2003 if that makes any difference.\n\n\nexample code\n\nint maxRows=sheet.getPhysicalNumberOfRows();\n\nfor (int i=0;i<maxRows;i++)\n\t{\n\t//check background colour\n\tHSSFRow checkRow = sheet.getRow(i);\n\tHSSFCell checkCell = checkRow.getCell((short)0);\n\tHSSFCellStyle bgCol=checkCell.getCellStyle();\n\tString myCol=String.valueOf(bgCol.getFillBackgroundColor());\n\tSystem.out.println(i+\" \"+myCol+ \" : \"+checkCell.getNumericCellValue());\n\t}"}, {"count": 1, "text": "Ok i have looked into the issue and committed a change to svn.\n\nFrom experiments, i have found that the value 64 (dec) is a special case. It is\n actually the AUTOMATIC or default color in excel. This is true for everything\nexcept the font color (Doh!) which retains 7FFF as its default color.\n\nHOWEVER, for some reason excel uses 65 (dec) for the background when a\nforeground is set to AUTOMATIC ie No Fill. Wierd.\n\nI have added a HSSFColor.AUTOMATIC class with the 64 special case. In addition i\nhave \"hidden\" the 65 case in the HSSFCellStyle, it will not return 64 when 65\nand perform the necessary conversion automatically and internally. A byproduct\nof the conversion is that Foreground needs to be set before Background. this is\nnoted in the javadoc.\n\nSeems to work OK, reopen if you have any issues.\n\nJason", "creator": "jheight@apache.org", "is_private": false, "id": 91536, "time": "2006-07-24T12:18:13Z", "bug_id": 38486, "creation_time": "2006-07-24T12:18:13Z", "tags": [], "attachment_id": null}]