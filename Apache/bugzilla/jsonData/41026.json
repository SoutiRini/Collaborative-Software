[{"count": 0, "tags": [], "bug_id": 41026, "attachment_id": null, "text": "Calling the method ValueRecordsAgregate.rowHasCells(int) with the parameter\nequals to the length of the records throws an ArrayIndexOutOfBoundsException.\nThis happened when I called the method HSSFWorkbook.write(OutputStream):\n\nThe stacktrace:\njava.lang.ArrayIndexOutOfBoundsException: 30\n\tat\norg.apache.poi.hssf.record.aggregates.ValueRecordsAggregate.rowHasCells(ValueRecordsAggregate.java:195)\n\tat org.apache.poi.hssf.model.Sheet.getSize(Sheet.java:2112)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.getBytes(HSSFWorkbook.java:920)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.write(HSSFWorkbook.java:875)\n\nI join two patches:\nOne for ValueRecordsAggregate, and one for TestValueRecordsAggregate.", "id": 96118, "time": "2006-11-23T05:45:27Z", "creator": "julien.ayme@gmail.com", "creation_time": "2006-11-23T05:45:27Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 41026, "attachment_id": 19166, "text": "Created attachment 19166\nPatch for the class org.apache.poi.hssf.record.aggregates.ValueRecordsAggregate\n\nA little bug: just an '>=' instead of '>' and its all done.", "id": 96119, "time": "2006-11-23T05:48:55Z", "creator": "julien.ayme@gmail.com", "creation_time": "2006-11-23T05:48:55Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 41026, "attachment_id": 19167, "id": 96120, "time": "2006-11-23T05:50:31Z", "creator": "julien.ayme@gmail.com", "creation_time": "2006-11-23T05:50:31Z", "is_private": false, "text": "Created attachment 19167\nPatch for the class org.apache.poi.hssf.record.aggregates.TestValueRecordsAggregate\n\nAdds a test corresponding to the bug."}, {"count": 3, "tags": [], "creator": "rajneesh.gupta@logicacmg.com", "attachment_id": null, "id": 96479, "time": "2006-12-03T04:12:58Z", "bug_id": 41026, "creation_time": "2006-12-03T04:12:58Z", "is_private": false, "text": "(In reply to comment #0)\n> Calling the method ValueRecordsAgregate.rowHasCells(int) with the parameter\n> equals to the length of the records throws an ArrayIndexOutOfBoundsException.\n> This happened when I called the method HSSFWorkbook.write(OutputStream):\n> \n> The stacktrace:\n> java.lang.ArrayIndexOutOfBoundsException: 30\n> \tat\n>\norg.apache.poi.hssf.record.aggregates.ValueRecordsAggregate.rowHasCells(ValueRecordsAggregate.java:195)\n> \tat org.apache.poi.hssf.model.Sheet.getSize(Sheet.java:2112)\n> \tat org.apache.poi.hssf.usermodel.HSSFWorkbook.getBytes(HSSFWorkbook.java:920)\n> \tat org.apache.poi.hssf.usermodel.HSSFWorkbook.write(HSSFWorkbook.java:875)\n> \n> I join two patches:\n> One for ValueRecordsAggregate, and one for TestValueRecordsAggregate.\n\nModifying the source of\norg.apache.poi.hssf.record.aggregates.ValueRecordsAggregate.rowHasCells method\ndosent work either. [    if (row >= records.length)    ]\n\nSame exception is thrown again. "}, {"count": 4, "attachment_id": null, "creator": "avik@apache.org", "text": "Can someone please put in a testcase that triggers this bug? Its quite \ndifficult to fix otherwise. Thanks. ", "id": 97924, "time": "2007-01-11T04:04:37Z", "bug_id": 41026, "creation_time": "2007-01-11T04:04:37Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "bug_id": 41026, "attachment_id": null, "text": "The same expection is thrown now on reading the file attached to Bug 37684 .\nWithout a testcase here, cannot confirm if the bug is the same... the symptoms\nseem similar. The attached patch does not fix this. ", "id": 98135, "time": "2007-01-16T07:51:07Z", "creator": "avik@apache.org", "creation_time": "2007-01-16T07:51:07Z", "is_private": false}, {"count": 6, "tags": [], "creator": "julien.ayme@gmail.com", "attachment_id": null, "text": "This has been fixed with the commit \n<a href=\"http://svn.apache.org/viewvc?view=rev&revision=513609\">#513609</a>", "id": 100045, "time": "2007-03-05T02:38:19Z", "bug_id": 41026, "creation_time": "2007-03-05T02:38:19Z", "is_private": false}]