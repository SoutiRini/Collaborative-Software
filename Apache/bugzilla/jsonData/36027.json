[{"attachment_id": null, "tags": [], "bug_id": 36027, "text": "I had apache 2.0.52 with the following configuration\n\nStartServers       16\nMinSpareServers    8\nMaxSpareServers    16\nServerLimit        64\nMaxClients         64\nMaxRequestsPerChild 8000\n\nCompiled with PHP 4.3.11 libphp4.so. I have php scripts thats uses lots of LDAP\nconnections ... Every thing works perfect and optimal.\n\nAfter upgrading to apache 2.0.54 I have experienced drastic performance degrade\nin apache processes (prefork MPM) its now using 99.9% CPU all the time and\ngiving timeouts.\n\nI have recompiled libphp4.so for apache 2.0.54 and results are same ... also\nused older libphp4.so that was compiled for apache 2.0.52 (which was working\nfine) but it didnt worked fine with 2.0.54.\n\nThe problem is somewhere in apache 2.0.54 when I use php based connections for\nLDAP. whereas apache 2.0.52 works perfect !\n\nPlease respond this is very critical ...\n\nThankyou.", "count": 0, "id": 78110, "time": "2005-08-04T14:33:24Z", "creator": "uzair@infinilogic.com", "creation_time": "2005-08-04T14:33:24Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 36027, "is_private": false, "count": 1, "id": 78115, "time": "2005-08-04T15:08:32Z", "creator": "jorton@redhat.com", "creation_time": "2005-08-04T15:08:32Z", "text": "Can you try applying this patch:\n\nhttp://svn.apache.org/viewcvs.cgi/httpd/httpd/branches/2.0.x/modules/experimental/util_ldap.c?rev=227253&r1=170805&r2=227253&makepatch=1&diff_format=u\n"}, {"attachment_id": null, "tags": [], "bug_id": 36027, "text": "2.0.54 cannot be patched with this link ... Kindly provide instructions, if\nsomeone thinks if it really works.\n\nhttp://svn.apache.org/viewcvs.cgi/httpd/httpd/branches/2.0.x/modules/experimental/util_ldap.c?rev=227253&r1=170805&r2=227253&makepatch=1&diff_format=u", "count": 2, "id": 78491, "time": "2005-08-15T07:15:52Z", "creator": "uzair@infinilogic.com", "creation_time": "2005-08-15T07:15:52Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 36027, "text": "This should apply directly to 2.0.54:\n\nhttp://people.apache.org/~jorton/httpd-2.0.54-ldapconn.patch", "count": 3, "id": 79551, "time": "2005-09-07T17:22:15Z", "creator": "jorton@redhat.com", "creation_time": "2005-09-07T17:22:15Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 36027, "text": "If I compile apache 2.0.54 without mod_ldap at all, libphp4.so will use its own\nfunctions for LDAP, in this case the problem is solved.\n\nSo I am concluding this to a bug related to interfacing between mod_ldap and\nphp, which was not present in earlier versions then 2.0.54.\n\nAppling this patch doesnot solve the problem at all as well\nhttp://people.apache.org/~jorton/httpd-2.0.54-ldapconn.patch\nThanks Joe Orton\n\nThis bug is not related to ldap connectios, but related to recursive searches in\nthe nodes. PHP library handels it correctly, whereas changes in 2.0.54 for ldap\nis a cause for this bug. \n\nRight now I am not sure exactly what is the cause. I look forward if someone\nchecks LDAP recursive searches using an Apache C module.\n\nNote:\nFrom recursive I mean, LDAP search result will reflect in next search parsing\nthat result. upto 3 or 4 searches at max.", "id": 79919, "time": "2005-09-14T08:56:12Z", "creator": "uzair@infinilogic.com", "creation_time": "2005-09-14T08:56:12Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 36027, "text": "So to confirm, you see this issue without having any LDAP authentication\nconfigured in httpd; the issue occurs merely when loading mod_ldap into the server?", "count": 5, "id": 80177, "time": "2005-09-20T13:25:07Z", "creator": "jorton@redhat.com", "creation_time": "2005-09-20T13:25:07Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 36027, "text": "My only guess is that this is some odd side-effect caused by one of the\nldap_set_option calls.  But the only one which changed between .52 and .54 is\nthe connection timeout handling so it's weird that this has regressed.\n\nUzair, are you absolutely sure you have applied that patch and recompiled and\nreinstalled properly?  (\"make clean; make; make install\" if not sure)\n\nWhat version of OpenLDAP is being used here?", "id": 80179, "time": "2005-09-20T13:31:45Z", "creator": "jorton@redhat.com", "creation_time": "2005-09-20T13:31:45Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "creator": "uzair@infinilogic.com", "attachment_id": null, "id": 80195, "time": "2005-09-20T18:04:41Z", "bug_id": 36027, "creation_time": "2005-09-20T18:04:41Z", "is_private": false, "text": "Yes this problem is faced when mod_ldap is compiled.\nI agree about the changes, its really weird.\n\nI have this setup on 5 different machines, all were recompiled after \"make\ndistclean & make clean\". And also extracting the orignal source packages.\n\nOpenLDAP and its libraries are, 2.2.23.\n\nThanks"}, {"count": 8, "tags": [], "creator": "minfrin@sharp.fm", "attachment_id": null, "id": 111139, "time": "2007-11-27T08:28:21Z", "bug_id": 36027, "creation_time": "2007-11-27T08:28:21Z", "is_private": false, "text": "Is this problem still present on httpd v2.2.x?\n"}, {"count": 9, "tags": [], "bug_id": 36027, "attachment_id": null, "text": "silent for 6 years and 2.0 retired", "id": 174848, "time": "2014-04-24T16:55:35Z", "creator": "takashi.asfbugzilla@tks.st", "creation_time": "2014-04-24T16:55:35Z", "is_private": false}]