[{"count": 0, "tags": [], "bug_id": 60541, "attachment_id": 34576, "id": 195795, "time": "2017-01-02T20:02:30Z", "creator": "cs@theta-soft.de", "creation_time": "2017-01-02T20:02:30Z", "is_private": false, "text": "Created attachment 34576\nCode to reproduce the erroneous behavior\n\nWhen reading an OOXML Excel document from a file, the \"collapsed\" attribute of any column is always set, even if the attribute was not set in the input file. If the attribute was not present in the input file, it will be set to \"false\". If the attribute was present in the input file, it will be set to \"true\", regardless of the actual value of the attribute. By saving and loading the document multiple times, the attribute will eventually have a true value, regardless of its initial state.\n\nExample to reproduce this behavior is attached.\n\nThe error occurs in line 259 of org.apache.poi.xssf.usermodel.helpers.ColumnHelper. The existing line:\n\ntoCol.setCollapsed(fromCol.isSetCollapsed());\n\n... should either be changed to:\n\ntoCol.setCollapsed(fromCol.getCollapsed());\n\n... or removed at all."}, {"count": 1, "tags": [], "text": "Created attachment 34580\nProposed patch from comment 0\n\nIt looks like that line was added in r775731 for bug 46161 with the commit message \"xssf support for setGroupColumnCollapsed() setGroupRowCollapsed()\".\n\nhttps://svn.apache.org/viewvc/poi/trunk/src/ooxml/java/org/apache/poi/xssf/usermodel/helpers/ColumnHelper.java?annotate=775731&pathrev=775731#l221\n> r636729       nick     public void setColumnAttributes(CTCol fromCol, CTCol toCol) {\n> r1561435 kiwiwings         if(fromCol.isSetBestFit()) toCol.setBestFit(fromCol.getBestFit());\n> ...\n> r747895      yegor         if(fromCol.isSetCollapsed()) toCol.setCollapsed(fromCol.getCollapsed());\n> ...\n> r775731       nick         toCol.setCollapsed(fromCol.isSetCollapsed());\n> r615258       nick     }\n\nI'm in favor of deleting the unguarded toCol.setCollapsed, but it currently breaks TestXSSFSheet#setColumnGroupCollapsed.\nThis old unit test appears to have many problems, such as confusing isSetCollapsed with getCollapsed, assuming hidden is the same as collapsed, among many other problems. I am rewriting this unit test before making your changes to avoid regressions.", "is_private": false, "id": 195808, "creator": "onealj@apache.org", "time": "2017-01-03T02:21:46Z", "bug_id": 60541, "creation_time": "2017-01-03T02:21:46Z", "attachment_id": 34580}]