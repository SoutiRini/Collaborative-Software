[{"count": 0, "tags": [], "bug_id": 44916, "attachment_id": null, "text": "In POI 3.0.2-FINAL:\n\nAfter creating a drawing patriarch on a sheet, retrieving the patriarch via the \"getDrawingPatriarch\" method may cause a NullPointerException, due to an unset, unchecked rawData value in AbstractEscherHolderRecord.\n\n\"convertRawBytesToEscherRecords()\" Line 99:\n  convertToEscherRecords(0, rawData.length, rawData);\n                               ^\n                               |- Not checked for null, causes NPE\n\nTo reproduce:\n1. Create drawing patriarch\n  HSSFPatriarch patr = sheet.createDrawingPatriarch();\n\n2. Use patriarch\n  HSSFClientAnchor anchor = new HSSFClientAnchor(0,0, 600,245, (short)1,1, (short)1,2);\n  anchor.setAnchorType(3);\n  patr.createPicture(anchor, loadImage(LOGO_PATH, HSSFWorkbook.PICTURE_TYPE_JPEG));\n\n3. Try to re-use patriarch later\n  HSSFPatriarch existingPatr = sheet.getDrawingPatriarch();\n\n4. Kaboom.", "id": 116095, "time": "2008-05-01T07:18:53Z", "creator": "apache@lonbinder.com", "creation_time": "2008-05-01T07:18:53Z", "is_private": false}, {"count": 1, "tags": [], "creator": "josh@apache.org", "attachment_id": null, "id": 116101, "time": "2008-05-01T08:44:35Z", "bug_id": 44916, "creation_time": "2008-05-01T08:44:35Z", "is_private": false, "text": "Easy to reproduce. As it turns out, step 2 is not required to get the NPE\n\nadded disabled junit for this bug in svn r652561\n\n"}, {"count": 2, "tags": [], "bug_id": 44916, "text": "Created attachment 24900\npatch to fix bug 44916\n\nfixed the bug and enable the junit test", "id": 133993, "time": "2010-01-28T05:02:50Z", "creator": "pierre.tholence@gmail.com", "creation_time": "2010-01-28T05:02:50Z", "is_private": false, "attachment_id": 24900}, {"count": 3, "tags": [], "bug_id": 44916, "text": "Thanks. Committed with some tweaks in r948880.", "id": 137177, "time": "2010-05-27T12:28:03Z", "creator": "apache@gagravarr.org", "creation_time": "2010-05-27T12:28:03Z", "is_private": false, "attachment_id": null}]