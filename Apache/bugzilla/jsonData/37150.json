[{"count": 0, "tags": [], "text": "Hi,\n\nI find some time to try to understand why sometimes my tomcat burns the CPU\n\nThe fact:\nwith long request (for example complex jsp or big dir listing) and if there is\nmore than 1 simultaneous connection (is easy to reproduce the case with many\nconnections); catalina stop responding, java takes all the CPU!\n\nI have tested that with default conf (perhaps there are some parameters to\ntune), I have create many files in a directory and many threads trying to get\nthe directory listing.\n\nTomcat version from 5.5.0 to 5.5.11 included are vulnerable, 5.5.12 seems to be\nok. I have not tested older version.\n\nHave I missed something in the conf ?\n\ncheers\n\nDavid Maciejak", "attachment_id": null, "bug_id": 37150, "id": 81351, "time": "2005-10-18T23:16:59Z", "creator": "david.maciejak@gmail.com", "creation_time": "2005-10-18T23:16:59Z", "is_private": false}, {"count": 1, "tags": [], "creator": "david.maciejak@gmail.com", "text": "v5.0.28 seems ok", "id": 81354, "attachment_id": null, "bug_id": 37150, "creation_time": "2005-10-19T00:03:16Z", "time": "2005-10-19T00:03:16Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 37150, "text": "This bug report does not make any sense, sorry.", "id": 82251, "time": "2005-11-08T22:12:21Z", "creator": "remm@apache.org", "creation_time": "2005-11-08T22:12:21Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 37150, "is_private": false, "id": 82253, "creation_time": "2005-11-08T22:51:38Z", "time": "2005-11-08T22:51:38Z", "creator": "markt@apache.org", "text": "It does make sense and I have reproduced it.", "attachment_id": null}, {"count": 4, "attachment_id": null, "creator": "remm@apache.org", "is_private": false, "id": 82255, "time": "2005-11-08T22:54:56Z", "bug_id": 37150, "creation_time": "2005-11-08T22:54:56Z", "tags": [], "text": "Cool. Do you have an explanation for: \"Tomcat version from 5.5.0 to 5.5.11\nincluded are vulnerable, 5.5.12 seems to be ok.\" ?"}, {"count": 5, "tags": [], "bug_id": 37150, "attachment_id": null, "id": 82257, "time": "2005-11-08T23:05:57Z", "creator": "markt@apache.org", "creation_time": "2005-11-08T23:05:57Z", "is_private": false, "text": "(In reply to comment #4)\n> Cool. Do you have an explanation for: \"Tomcat version from 5.5.0 to 5.5.11\n> included are vulnerable, 5.5.12 seems to be ok.\" ?\n\nLooks like his testing of 5.5.12 was bad. I can easily reproduce this using the\nlatest source from SVN and the problem area has remained unchanged. I posted an\nexplanation of what is going on to the dev list.\n\n"}, {"count": 6, "tags": [], "creator": "remm@apache.org", "is_private": false, "id": 82261, "attachment_id": null, "bug_id": 37150, "creation_time": "2005-11-08T23:45:05Z", "time": "2005-11-08T23:45:05Z", "text": "(In reply to comment #5)\n> Looks like his testing of 5.5.12 was bad. I can easily reproduce this using the\n> latest source from SVN and the problem area has remained unchanged. I posted an\n> explanation of what is going on to the dev list.\n\nThe abstraction layer will make directory listings expensive (actually,\ndirectory listings in Java are going to be expensive regardless), so I don't see\nhow this can be optimized. The fact remains however that this bug report is\nnonsense.\n"}, {"count": 7, "attachment_id": null, "creator": "david.maciejak@gmail.com", "text": "(In reply to comment #5)\n> (In reply to comment #4)\n> > Cool. Do you have an explanation for: \"Tomcat version from 5.5.0 to 5.5.11\n> > included are vulnerable, 5.5.12 seems to be ok.\" ?\n> \n> Looks like his testing of 5.5.12 was bad. I can easily reproduce this using the\n> latest source from SVN and the problem area has remained unchanged. I posted an\n> explanation of what is going on to the dev list.\n> \n\nIn fact, I have not been able to reproduce the problem on 5.5.12. The java\nthread burns the cpu during some time and after waiting enough all goes to a\n'normal' state.", "id": 82264, "time": "2005-11-09T00:30:23Z", "bug_id": 37150, "creation_time": "2005-11-09T00:30:23Z", "tags": [], "is_private": false}, {"count": 8, "tags": [], "bug_id": 37150, "text": "This is now fixed.\n\nThe obvious optimisation has been made in the code but this only has a marginal\nimpact.\n\nGiven the high cost of generating the listings in Java, this code cannot be\noptimised to the point where large directory listings will not place a\ndisproportionate load on the server. Therefore, directory listing is now\ndisabled by default and warnings have been added to both the documentation and\nthe file where this is configured.\n\nThese changes will be included in versions 5.5.13+, 5.0.31+ and 4.1.32+\n\nNote that releases of the 4.1.x and 5.0.x branches are now infrequent and that\nnone are planned at present.", "id": 82321, "time": "2005-11-09T23:18:33Z", "creator": "markt@apache.org", "creation_time": "2005-11-09T23:18:33Z", "is_private": false, "attachment_id": null}]