[{"count": 0, "tags": [], "text": "I am working on pulling source files for my project from Visual SourceSafe.  \nCreated a small ant file just to work on this issue.  At the version prompt, if \nI just hit return, I get all of my files.  If I put a version number such \nas '0.04.002', some of the files return but at arbitrary locations it breaks \nand fails.  I know the label exists in the VSS database because I get some \nresults, just not all results.\n\n===============  Build.xml ==========================================\n<?xml version = '1.0' encoding = 'ISO-8859-1' ?>\n<project name=\"VSS Ant Script\" default=\"getit\">\n\n<property name=\"localDirectory\" value=\"c:\\ant_vss\"/>\n\n\n<target name=\"getit\" description=\"pull files from vss\" depends=\"setLabel\">\n\t<delete dir=\"${localDirectory}\"/>\n\t<mkdir dir=\"${localDirectory}\"/>\n\t<vssget localPath=\"${localDirectory}\"\n\t\trecursive=\"true\"\n\t\tlabel=\"${vssLabel}\"\n\t\tvsspath=\"/uber\"/>\n</target>\n\n<target name=\"setLabel\" description=\"get label from user\">\n\t<input message=\"Version Number (return for latest)\" \naddproperty=\"vssLabel\"/>\n</target>\n\n\n</project>\n=====================================================================\n=================== Error Message ===================================\nBUILD FAILED\nfile:C:/buildme/build.xml:13: Failed executing: ss Get $/uber -GLC:\\ant_vss -I-\n-R -VL0.04.002\n        at org.apache.tools.ant.taskdefs.optional.vss.MSVSSGET.execute(MSVSSGET.\njava:187)\n        at org.apache.tools.ant.Task.perform(Task.java:319)\n        at org.apache.tools.ant.Target.execute(Target.java:309)\n        at org.apache.tools.ant.Target.performTasks(Target.java:336)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1306)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1250)\n        at org.apache.tools.ant.Main.runBuild(Main.java:610)\n        at org.apache.tools.ant.Main.start(Main.java:196)\n        at org.apache.tools.ant.Main.main(Main.java:235)\n\nTotal time: 29 seconds\n=====================================================================\n=============  My Input at the Prompt ===============================\n0.04.002\n=====================================================================", "is_private": false, "id": 31549, "creator": "bichojunk@hotmail.com", "time": "2003-02-18T21:03:07Z", "bug_id": 17181, "creation_time": "2003-02-18T21:03:07Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "sweiner@ebidenergy.com", "attachment_id": null, "is_private": false, "id": 35009, "time": "2003-04-11T17:58:16Z", "bug_id": 17181, "creation_time": "2003-04-11T17:58:16Z", "text": "I'm seeing the same thing. Debugging a bit it looks to me as if a space needs \nto exist between -VL and the label when the command is executed by ss.exe. When \nI put a space in the property, the whole string is quoted, which also doesn't \nwork."}, {"count": 2, "tags": [], "bug_id": 17181, "text": "I take it back - the space does not seem to be the issue.\n\nIt seems that the GET at a label is working for first level items, but not sub-\nfolders. If I manually go in and label each subfolder (in the VSS GUI) the GET \nworks. This led me to believe that my VSS DB was less that clean.\n\nI think I've fixed this for myself. I did two things:\n\n1) Created a new VSS DB (Using VSS6.0 sp5)\n2) Figured out that I can specify the database directory in the vssget task \n(not documented) using the serverpath attribute as follows:\n<vssget ssdir=\"${vss.ssdir}\"\nserverpath=\"${vss.serverpath}\"\nvsspath=\"${cm.vss.path}\"\nlocalpath=\".\"\nlogin=\"${vss.login}, ${vss.passwd}\"\nlabel=\"${cm.vss.label}\"\nwritable=\"false\"\nrecursive=\"true\"/>\n\nI can now recursively GET from VSS at a label using ant.\n", "id": 35033, "time": "2003-04-11T21:35:28Z", "creator": "sweiner@ebidenergy.com", "creation_time": "2003-04-11T21:35:28Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "text": "The 'serverpath' attribute is documented.\n\nsee\n\nhttp://ant.apache.org/manual/OptionalTasks/vss.html#vssget\n\nfor more details.\n\nJesse", "is_private": false, "id": 35034, "creator": "jesse@cryptocard.com", "time": "2003-04-11T21:55:33Z", "bug_id": 17181, "creation_time": "2003-04-11T21:55:33Z", "attachment_id": null}]