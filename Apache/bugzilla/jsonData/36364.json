[{"count": 0, "tags": [], "text": "To test this, I did variations of:\n\n    <Directory \"/path/to/files\">\n        Options FollowSymlinks Indexes\n        AllowOverride AuthConfig\n    </Directory>\n\nIn /usr/local/www/data:\n\n    ln -s /path/to/files .\n\nAnd I go to the browser:\n\n    http://mysite.com/files\n\n\nwhich generates this error:\n\n    You don't have permission to access /files on this server.\n\n    Additionally, a 403 Forbidden error was encountered while trying to use an\nErrorDocument to handle the request.\n\nI also tried tweaking SymlinksIfOwnerMatch, etc.  I verified that the\npermissions are okay (as far as I can tell).\n\nFurther, I placed in the <Directory /> and in <Directory /usr/local/data/www>\nboth options of Options All and AllowOverride All to test, and this continues to\nfail.", "attachment_id": null, "id": 79023, "creator": "forrie@forrie.com", "time": "2005-08-26T00:48:01Z", "bug_id": 36364, "creation_time": "2005-08-26T00:48:01Z", "is_private": false}, {"count": 1, "tags": [], "creator": "nick@webthing.com", "text": "\"Under 2.0.54\"?  What other version have you tested with? \n \nLooks like a file permissions issue.  Read Rich Bowen's article on Forbidden  \nerrors (somewhere at ORA/Onlamp), and reopen once you've done all the things  \nhe tells you to deal with the problem.  Or once you've found an earlier Apache \nversion that works as you expect with the identical system and config. ", "id": 79027, "time": "2005-08-26T01:04:37Z", "bug_id": 36364, "creation_time": "2005-08-26T01:04:37Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "text": "To the best of my knowledge, this is not a problem in 1.3.x, using the same\nconfiguration directives and scenario.   I've used Options All in my site.conf\nto try and allow everything, as well as AllowOverride AuthConfig, to no avail.", "is_private": false, "bug_id": 36364, "id": 79111, "time": "2005-08-27T22:14:16Z", "creator": "forrie@forrie.com", "creation_time": "2005-08-27T22:14:16Z", "attachment_id": null}, {"count": 3, "tags": [], "text": "Did you check what the error log said?", "attachment_id": null, "id": 79112, "creator": "chip@force-elite.com", "time": "2005-08-27T22:25:17Z", "bug_id": 36364, "creation_time": "2005-08-27T22:25:17Z", "is_private": false}, {"count": 4, "attachment_id": null, "creator": "forrie@forrie.com", "is_private": false, "id": 79261, "time": "2005-09-01T07:36:29Z", "bug_id": 36364, "creation_time": "2005-09-01T07:36:29Z", "tags": [], "text": "(In reply to comment #3)\n> Did you check what the error log said?\n\nYes:\n\n[Thu Sep 01 01:33:39 2005] [error] [client 192.168.1.99] Symbolic link not\nallowed: /usr/local/www/data/mp3\n\nIt makes NO difference if I permit FollowSymLinks on / or in the VirtualHost\nentry.  I've tried a stripped down configuration, with no other possible\nconflicts, and have the same problem.\n"}, {"count": 5, "tags": [], "text": "What is your docroot?  You mention four different paths here:\n\n    <Directory \"/path/to/files\">\nIn /usr/local/www/data:\n<Directory /> \n<Directory /usr/local/data/www>\n\nnote the transposed \"data\" and \"www\".  If you want to allow symlinks in the\ndocroot to be followed you need to set the option in a <Directory\n/path/to/docroot> context, not for the *destination* of the symlink.\n\nThis looks like a configuration error to me; try running the server like:\n\n  truss ./bin/httpd -X\n\nto see the actually system calls used to verify the configuration; else try\nusers@httpd.apache.org for further help.\n", "is_private": false, "bug_id": 36364, "id": 79540, "time": "2005-09-07T16:37:12Z", "creator": "jorton@redhat.com", "creation_time": "2005-09-07T16:37:12Z", "attachment_id": null}, {"count": 6, "tags": [], "creator": "forrie@forrie.com", "attachment_id": null, "id": 79573, "time": "2005-09-07T19:05:32Z", "bug_id": 36364, "creation_time": "2005-09-07T19:05:32Z", "is_private": false, "text": "Sorry for the different paths, however the bug still persists.\n\nHere are the steps to repeat it on the platform I described:\n\nDocumentRoot:  /usr/local/www\n\n   1. cd /usr/local/www\n   2. ln -s /usr/local/directory/files sharename\n   3. ls -l sharename\n   4. sharename -> /usr/local/directory/files\n   5. Go to http://mydomain.com/sharename, get this error:\n\n    Forbidden\n\n    You don't have permission to access /mp3share on this server.\n\n    Additionally, a 403 Forbidden error was encountered while trying to use an\nErrorDocument to handle the request.\n\n\nI have an explicit directive in httpd.conf:\n\n<Directory \"/usr/local/www/data/mp3share\">\n    Options All\n</Directory>\n\nWhich is more than sufficient.   No go.\n\nThis is a bug, I'm convinced of it - as the same scenario works on Apache-1.3.x.\n\nFYI, I posted a detailed report of this to users@httpd.apache.org, and received\nnot a single response.\n\n\"truss\" appears to be broken here on FreeBSD-6.0-BETA2.  I'll do a buildworld\nand see if that's repaired.\n"}, {"count": 7, "tags": [], "text": "Sorry for the persistence but you're not really inspiring me that this is not a\nbasic config confusion!\n\nYou're creating a symlink at /usr/local/www/sharename.\n\nBut you're talking about enabling FollowSymLinks at\n\"/usr/local/www/data/mp3share\", which makes no sense.  You need to enable it in\n/usr/local/www.  That's where the symlink will or will not be dereferenced.\n\nFollowSymLinks controls whether or not a symlink in the contained context will\nbe followed.  Not whether a symlink can be followed *to* the contained context.\nAre we on the same page here?", "is_private": false, "id": 79579, "creator": "jorton@redhat.com", "time": "2005-09-07T20:34:33Z", "bug_id": 36364, "creation_time": "2005-09-07T20:34:33Z", "attachment_id": null}, {"count": 8, "tags": [], "text": "Maybe my example was bad.  The symlink exists in\n/usr/local/www/data/<symlinkname>, which POINTS to\n/usr/local/shares/<somedirectory>.   That is semantically correct, as far as I\ncan tell.  Again, this same config works fine on my 1.3.x installation.\n\n", "is_private": false, "id": 79590, "creator": "forrie@forrie.com", "time": "2005-09-07T21:00:41Z", "bug_id": 36364, "creation_time": "2005-09-07T21:00:41Z", "attachment_id": null}, {"count": 9, "tags": [], "text": "Please attach the 1.3 config and the new 2.0 config.", "attachment_id": null, "id": 79592, "creation_time": "2005-09-07T21:05:13Z", "time": "2005-09-07T21:05:13Z", "creator": "nd@perlig.de", "bug_id": 36364, "is_private": false}, {"count": 10, "tags": [], "text": "Here is the 1.3 configuration:\n\nFirst, the relevant directives for the DocumentRoot:\n\n<Directory />\n    Options FollowSymLinks\n    AllowOverride All\n</Directory>\n\nfor the mp3 area:\n\n<Directory /mp3>\n        AllowOverride All\n        Options Indexes Multiviews\n</Directory>\n\nIn the DocumentRoot area, I have:\n\n/usr/local/apache/htdocs/mp3\n\nsymlinked to,\n\n/local2/mp3\n\nIn that stated configuration, it works fine.\n\nWhen I try this same method with Apache2, I get:\n\n[Wed Sep 07 17:41:16 2005] [error] [client 192.168.1.99] Symbolic link not\nallowed: /usr/local/www/data/mp3share\n\nUsing the configuration I had stated in my previous message.\n\nThe place where I'm link to is on another partition, but that shouldn't make a\ndifference, as above (the 1.3 config) the link is to a different hard drive\naltogether.\n", "is_private": false, "bug_id": 36364, "id": 79604, "time": "2005-09-08T00:42:49Z", "creator": "forrie@forrie.com", "creation_time": "2005-09-08T00:42:49Z", "attachment_id": null}, {"count": 11, "tags": [], "text": "Please attach both complete configurations. Then one can decide what's relevant.\nThanks.", "attachment_id": null, "id": 79617, "creation_time": "2005-09-08T05:58:32Z", "time": "2005-09-08T05:58:32Z", "creator": "nd@perlig.de", "bug_id": 36364, "is_private": false}, {"count": 12, "tags": [], "bug_id": 36364, "attachment_id": null, "is_private": false, "id": 79619, "time": "2005-09-08T07:29:25Z", "creator": "forrie@forrie.com", "creation_time": "2005-09-08T07:29:25Z", "text": "I stripped down my Apache2.x configuration to barebones, using the directives I\nspecified initially.  I think that's the best place to start.  The old machine I\nmentioned is offline.\n\nI doubt everyone wants to see my httpd.conf; but here you go:\n\nDocumentRoot \"/usr/local/www/data\"\nServerRoot \"/usr/local\"\nTimeout 300\nKeepAlive On\nMaxKeepAliveRequests 100\nKeepAliveTimeout 15\nPidFile /var/run/httpd.pid\nUser www\nGroup www\nServerAdmin webmaster@forrie.com\nServerName www.forrie.com:80\nUseCanonicalName Off\nDirectoryIndex index.html index.html.var index.php\nAccessFileName .htaccess\nTypesConfig etc/apache2/mime.types\nDefaultType text/plain\nHostnameLookups Off\nServerTokens Prod\nServerSignature Off\n\nListen 80\n\nCustomLog /var/log/apache/forrie.com/access_log common env=!skip_log\nErrorLog /var/log/apache/forrie.com/error_log\n\nLogLevel warn\nLogFormat \"%h %l %u %t \\\"%r\\\" %>s %b \\\"%{Referer}i\\\" \\\"%{User-Agent}i\\\"\" combined\nLogFormat \"%h %l %u %t \\\"%r\\\" %>s %b\" common\nLogFormat \"%{Referer}i -> %U\" referer\nLogFormat \"%{User-agent}i\" agent\n\n<IfModule prefork.c>\nStartServers         5\nMinSpareServers      5\nMaxSpareServers     10\nMaxClients         150\nMaxRequestsPerChild  0\n</IfModule>\n\n<IfModule worker.c>\nStartServers         2\nMaxClients         150\nMinSpareThreads     25\nMaxSpareThreads     75 \nThreadsPerChild     25\nMaxRequestsPerChild  0\n</IfModule>\n\n<IfModule perchild.c>\nNumServers           5\nStartThreads         5\nMinSpareThreads      5\nMaxSpareThreads     10\nMaxThreadsPerChild  20\nMaxRequestsPerChild  0\n</IfModule>\n\nLoadModule access_module libexec/apache2/mod_access.so\nLoadModule auth_module libexec/apache2/mod_auth.so\nLoadModule auth_anon_module libexec/apache2/mod_auth_anon.so\nLoadModule auth_dbm_module libexec/apache2/mod_auth_dbm.so\nLoadModule charset_lite_module libexec/apache2/mod_charset_lite.so\nLoadModule include_module libexec/apache2/mod_include.so\nLoadModule deflate_module libexec/apache2/mod_deflate.so\nLoadModule log_config_module libexec/apache2/mod_log_config.so\nLoadModule logio_module libexec/apache2/mod_logio.so\nLoadModule env_module libexec/apache2/mod_env.so\nLoadModule mime_magic_module libexec/apache2/mod_mime_magic.so\nLoadModule cern_meta_module libexec/apache2/mod_cern_meta.so\nLoadModule expires_module libexec/apache2/mod_expires.so\nLoadModule headers_module libexec/apache2/mod_headers.so\nLoadModule usertrack_module libexec/apache2/mod_usertrack.so\nLoadModule unique_id_module libexec/apache2/mod_unique_id.so\nLoadModule setenvif_module libexec/apache2/mod_setenvif.so\n<IfDefine SSL>\nLoadModule ssl_module libexec/apache2/mod_ssl.so\n</IfDefine>\nLoadModule mime_module libexec/apache2/mod_mime.so\nLoadModule status_module libexec/apache2/mod_status.so\nLoadModule autoindex_module libexec/apache2/mod_autoindex.so\nLoadModule asis_module libexec/apache2/mod_asis.so\nLoadModule info_module libexec/apache2/mod_info.so\nLoadModule cgi_module libexec/apache2/mod_cgi.so\nLoadModule vhost_alias_module libexec/apache2/mod_vhost_alias.so\nLoadModule negotiation_module libexec/apache2/mod_negotiation.so\nLoadModule dir_module libexec/apache2/mod_dir.so\nLoadModule imap_module libexec/apache2/mod_imap.so\nLoadModule actions_module libexec/apache2/mod_actions.so\nLoadModule speling_module libexec/apache2/mod_speling.so\nLoadModule userdir_module libexec/apache2/mod_userdir.so\nLoadModule alias_module libexec/apache2/mod_alias.so\nLoadModule rewrite_module libexec/apache2/mod_rewrite.so\nLoadModule php5_module        libexec/apache2/libphp5.so\n\n<Directory />\n    AllowOverride None\n    Order Deny,Allow\n    Deny from all \n</Directory>\n\n<Directory \"/usr/local/www\">\n    AllowOverride None\n    Order allow,deny\n    Allow from all\n</Directory>\n\n<Files ~ \"^\\.ht\">\n    Order allow,deny\n    Deny from all\n</Files>\n\n<IfModule mod_mime_magic.c>\n    MIMEMagicFile etc/apache2/magic\n</IfModule>\n\nAlias /icons/ \"/usr/local/www/icons/\"\n\n<Directory \"/usr/local/www/icons\">\n    Options Indexes MultiViews\n    AllowOverride None\n    Order allow,deny\n    Allow from all\n</Directory>\n\nIndexOptions FancyIndexing VersionSort\n\nAddIconByEncoding (CMP,/icons/compressed.gif) x-compress x-gzip\n\nAddIconByType (TXT,/icons/text.gif) text/*\nAddIconByType (IMG,/icons/image2.gif) image/*\nAddIconByType (SND,/icons/sound2.gif) audio/*\nAddIconByType (VID,/icons/movie.gif) video/*\n\nAddIcon /icons/binary.gif .bin .exe\nAddIcon /icons/binhex.gif .hqx\nAddIcon /icons/tar.gif .tar\nAddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv\nAddIcon /icons/compressed.gif .Z .z .tgz .gz .zip\nAddIcon /icons/a.gif .ps .ai .eps\nAddIcon /icons/layout.gif .html .shtml .htm .pdf\nAddIcon /icons/text.gif .txt\nAddIcon /icons/c.gif .c\nAddIcon /icons/p.gif .pl .py\nAddIcon /icons/f.gif .for\nAddIcon /icons/dvi.gif .dvi\nAddIcon /icons/uuencoded.gif .uu\nAddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl\nAddIcon /icons/tex.gif .tex\nAddIcon /icons/bomb.gif core\n\nAddIcon /icons/back.gif ..\nAddIcon /icons/hand.right.gif README\nAddIcon /icons/folder.gif ^^DIRECTORY^^\nAddIcon /icons/blank.gif ^^BLANKICON^^\n\nDefaultIcon /icons/unknown.gif\n\nReadmeName README.html\nHeaderName HEADER.html\n\nIndexIgnore .??* *~ *# HEADER* README* RCS CVS *,v *,t\n\n# DefaultLanguage and AddLanguage allows you to specify the language of \n# language code is pl) may wish to use \"AddLanguage pl .po\" to\nAddLanguage ca .ca\nAddLanguage cs .cz .cs\nAddLanguage da .dk\nAddLanguage de .de\nAddLanguage el .el\nAddLanguage en .en\nAddLanguage eo .eo\nAddLanguage es .es\nAddLanguage et .et\nAddLanguage fr .fr\nAddLanguage he .he\nAddLanguage hr .hr\nAddLanguage it .it\nAddLanguage ja .ja\nAddLanguage ko .ko\nAddLanguage ltz .ltz\nAddLanguage nl .nl\nAddLanguage nn .nn\nAddLanguage no .no\nAddLanguage pl .po\nAddLanguage pt .pt\nAddLanguage pt-BR .pt-br\nAddLanguage ru .ru\nAddLanguage sv .sv\nAddLanguage zh-CN .zh-cn\nAddLanguage zh-TW .zh-tw\n\nLanguagePriority en ca cs da de el eo es et fr he hr it ja ko ltz nl nn no pl pt\npt-BR ru sv zh-CN zh-TW\n\n# ForceLanguagePriority allows you to serve a result page rather than\nForceLanguagePriority Prefer Fallback\n#        LanguagePriority en cs de es fr it ja ko nl pl pt-br ro sv tr\n#        ForceLanguagePriority Prefer Fallback\nForceLanguagePriority Prefer Fallback\n\nAddCharset ISO-8859-1  .iso8859-1  .latin1\nAddCharset ISO-8859-2  .iso8859-2  .latin2 .cen\nAddCharset ISO-8859-3  .iso8859-3  .latin3\nAddCharset ISO-8859-4  .iso8859-4  .latin4\nAddCharset ISO-8859-5  .iso8859-5  .latin5 .cyr .iso-ru\nAddCharset ISO-8859-6  .iso8859-6  .latin6 .arb\nAddCharset ISO-8859-7  .iso8859-7  .latin7 .grk\nAddCharset ISO-8859-8  .iso8859-8  .latin8 .heb\nAddCharset ISO-8859-9  .iso8859-9  .latin9 .trk\nAddCharset ISO-2022-JP .iso2022-jp .jis\nAddCharset ISO-2022-KR .iso2022-kr .kis\nAddCharset ISO-2022-CN .iso2022-cn .cis\nAddCharset Big5        .Big5       .big5\nAddCharset WINDOWS-1251 .cp-1251   .win-1251\nAddCharset CP866       .cp866\nAddCharset KOI8-r      .koi8-r .koi8-ru\nAddCharset KOI8-ru     .koi8-uk .ua\nAddCharset ISO-10646-UCS-2 .ucs2\nAddCharset ISO-10646-UCS-4 .ucs4\nAddCharset UTF-8       .utf8\n\nAddCharset GB2312      .gb2312 .gb \nAddCharset utf-7       .utf7\nAddCharset utf-8       .utf8\nAddCharset big5        .big5 .b5\nAddCharset EUC-TW      .euc-tw\nAddCharset EUC-JP      .euc-jp\nAddCharset EUC-KR      .euc-kr\nAddCharset shift_jis   .sjis\n\nAddType application/x-compress .Z\nAddType application/x-gzip .gz .tgz\nAddType application/x-httpd-php .php\nAddHandler type-map var\n\nBrowserMatch \"Mozilla/2\" nokeepalive\nBrowserMatch \"MSIE 4\\.0b2;\" nokeepalive downgrade-1.0 force-response-1.0\nBrowserMatch \"RealPlayer 4\\.0\" force-response-1.0\nBrowserMatch \"Java/1\\.0\" force-response-1.0\nBrowserMatch \"JDK/1\\.0\" force-response-1.0\n\nBrowserMatch \"Microsoft Data Access Internet Publishing Provider\" redirect-carefully\nBrowserMatch \"^WebDrive\" redirect-carefully\nBrowserMatch \"^WebDAVFS/1.[012]\" redirect-carefully\nBrowserMatch \"^gnome-vfs\" redirect-carefully\n\n<IfModule mod_ssl.c>\n    Include etc/apache2/Includes/ssl.conf\n</IfModule>\n\nNameVirtualHost *:80\n\nInclude etc/apache2/Includes/worms.conf\n\n# Here is where I've tried various combinations of direct filesystem path\n# and actual DocRoot path.  It doesn't work, either way.\n\n<Directory \"/mp3share\">\n\tOptions All\n</Directory>\n"}, {"count": 13, "tags": [], "bug_id": 36364, "attachment_id": null, "id": 79625, "time": "2005-09-08T09:55:41Z", "creator": "nick@webthing.com", "creation_time": "2005-09-08T09:55:41Z", "is_private": false, "text": "You've posted two bits of 'relevant' config in the past few hours.  Both of \nthem should clearly NOT allow symlinks from /usr/local/www/data/mp3share \n \nPlease use a user support forum to ask questions about your setup. "}, {"count": 14, "attachment_id": null, "creator": "forrie@forrie.com", "is_private": false, "id": 79690, "time": "2005-09-08T23:32:45Z", "bug_id": 36364, "creation_time": "2005-09-08T23:32:45Z", "tags": [], "text": "Based on the published manual, etc., please provide what you believe to be the\ncorrect measure.   I posted this to users@httpd.apache.org and received no\nresponse.  I've run across 5 other people who have this same problem.  Please\nidentify where you think this is wrong.  Given we've tried FollowSymLinks in the\nroot (DocumentRoot) as well, and it still doesn't work.\n"}, {"count": 15, "tags": [], "bug_id": 36364, "attachment_id": null, "is_private": false, "id": 79727, "time": "2005-09-09T15:31:46Z", "creator": "slive@apache.org", "creation_time": "2005-09-09T15:31:46Z", "text": "In fact, you did receive a response:\nhttp://mail-archives.apache.org/mod_mbox/httpd-users/200509.mbox/%3ce498c1660509081759230e9b7e@mail.gmail.com%3e\n"}]