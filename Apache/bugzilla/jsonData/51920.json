[{"count": 0, "tags": [], "bug_id": 51920, "attachment_id": null, "id": 149956, "time": "2011-09-30T05:46:11Z", "creator": "baraiya.yatin@gmail.com", "creation_time": "2011-09-30T05:46:11Z", "is_private": false, "text": "Currently i am using the apache tika 0.9[plus tika 0.9's dependent jar file] and apache poi 3.7 jar for text extraction .\n\ni get the exception when i used some Microsoft office document. i have attached document zip file. Please check it with said jar file.\n\ni get the following exception when  we upload '1_1.doc' document from the attached zip file.\n\nCaused by: org.apache.tika.exception.TikaException: Unexpected RuntimeException\nfrom org.apache.tika.parser.microsoft.OfficeParser@d8e54c\n    at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:199)\n    at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:197)\n    at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:135)\n    at\norg.apache.tika.parser.ParsingReader$ParsingTask.run(ParsingReader.java:232)\n    ... 1 more\nCaused by: java.lang.NullPointerException\n    at\norg.apache.poi.hwpf.sprm.CharacterSprmUncompressor.uncompressCHP(CharacterSprmUncompressor.java:39)\n    at org.apache.poi.hwpf.model.CHPX.getCharacterProperties(CHPX.java:61)\n    at org.apache.poi.hwpf.usermodel.CharacterRun.<init>(CharacterRun.java:98)\n    at org.apache.poi.hwpf.usermodel.Range.getCharacterRun(Range.java:797)\n    at\norg.apache.poi.hwpf.model.PicturesTable.getAllPictures(PicturesTable.java:191)\n    at\norg.apache.tika.parser.microsoft.WordExtractor$PicturesSource.<init>(WordExtractor.java:430)\n    at\norg.apache.tika.parser.microsoft.WordExtractor$PicturesSource.<init>(WordExtractor.java:420)\n    at\norg.apache.tika.parser.microsoft.WordExtractor.parse(WordExtractor.java:75)\n    at\norg.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:182)\n    at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:197)\n    ... 4 more\n\n\n\ni get the following exception when  we upload 'Book1.xlsb' and 'MSPPT2007.thmx' documents from the attached zip file.\n\nCaused by: org.apache.tika.exception.TikaException: TIKA-418: RuntimeException\nwhile getting content for thmx and xps file types\n    at\norg.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:86)\n    at\norg.apache.tika.parser.microsoft.ooxml.OOXMLParser.parse(OOXMLParser.java:67)\n    at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:197)\n    at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:197)\n    at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:135)\n    at\norg.apache.tika.parser.ParsingReader$ParsingTask.run(ParsingReader.java:232)\n    ... 1 more\nCaused by: java.lang.IllegalArgumentException: No supported documents found in\nthe OOXML package (found\napplication/vnd.ms-excel.sheet.binary.macroEnabled.main)\n    at\norg.apache.poi.extractor.ExtractorFactory.createExtractor(ExtractorFactory.java:191)\n    at\norg.apache.poi.extractor.ExtractorFactory.createExtractor(ExtractorFactory.java:152)\n    at\norg.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:65)\n    ... 6 more\n\ni get the following exception when  we upload 'MSPPT2007.xps' document from the attached zip file.\n\nCaused by: org.apache.tika.exception.TikaException: Error creating OOXML\nextractor\n    at\norg.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:90)\n    at\norg.apache.tika.parser.microsoft.ooxml.OOXMLParser.parse(OOXMLParser.java:67)\n    at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:197)\n    at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:197)\n    at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:135)\n    at\norg.apache.tika.parser.ParsingReader$ParsingTask.run(ParsingReader.java:232)\n    ... 1 more\nCaused by: java.lang.IllegalArgumentException: Invalid OOXML Package received -\nexpected 1 core document, found 0\n    at\norg.apache.poi.extractor.ExtractorFactory.createExtractor(ExtractorFactory.java:161)\n    at\norg.apache.poi.extractor.ExtractorFactory.createExtractor(ExtractorFactory.java:152)\n    at\norg.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:65)\n    ... 6 more\n\n\nPlease try to resolve this issue.\n\nThanks & Regards\nYatin Baraiya"}, {"count": 1, "attachment_id": null, "creator": "yegor@dinom.ru", "text": "\n\n*** This bug has been marked as a duplicate of bug 51921 ***", "id": 150119, "time": "2011-10-04T12:27:47Z", "bug_id": 51920, "creation_time": "2011-10-04T12:27:47Z", "tags": [], "is_private": false}]