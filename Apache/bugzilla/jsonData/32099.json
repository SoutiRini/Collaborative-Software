[{"count": 0, "tags": [], "bug_id": 32099, "attachment_id": null, "id": 66572, "time": "2004-11-07T04:51:45Z", "creator": "tim@peierls.net", "creation_time": "2004-11-07T04:51:45Z", "is_private": false, "text": "The Apt task currently inherits the default value of false for the fork\nattribute from Javac. On my Windows box (and, I expect, on any platform/OS),\nthis means that two distinct class loaders end up loading\nAnnotationProcessorFactory, one via org.apache.tools.ant.launch.Launcher.run and\none via com.sun.tools.apt.comp.Apt.main. \n\nBecause of this, if tools.jar is not on the factorypath/classpath/bootclasspath,\nApt throws a NoClassDefFoundError for AnnotationProcessorFactory even though an\nAnnotationProcessorFactory class was loaded by Launcher). \n\nOTOH, if tools.jar _is_ on the factorypath/classpath/bootclasspath, a class\nimplementing AnnotationProcessorFactory will produce the message \"Specified\nfactory, 'xxx', is not an AnnotationProcessorFactory\", because the implementing\nclass is loaded by the apt class loader and the AnnotationProcessorFactory class\nit gets cast to was loaded by another class loader, so the cast fails. \n\nThe point is that it can be very difficult to get the Apt task to work with\nfork=\"false\". There would be a lot less head-scratching if fork just defaulted\nto true or there were some mention in the docs about using fork=\"true\" if you\nhave trouble with fork=\"false\"."}, {"count": 1, "tags": [], "creator": "stevel@apache.org", "is_private": false, "id": 70636, "creation_time": "2005-02-08T20:01:04Z", "time": "2005-02-08T20:01:04Z", "bug_id": 32099, "text": "Fixed in CVS. Please test.", "attachment_id": null}]