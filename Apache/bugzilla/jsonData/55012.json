[{"count": 0, "tags": [], "creator": "jwood68@gmail.com", "text": "Created attachment 30315\nSimple JMX file that shows error\n\nI am trying to get the name of a threadgroup as a value to use as part of a filename. Google suggests that to do this I should use\n\n${__BeanShell(ctx.getThreadGroup().getName())}\n\nbut when I use it in the filename textbox of a SimpleDataWriter node\nI get the following error\n\n=============================================================================\n2013/05/23 13:48:06 ERROR - jmeter.util.BeanShellInterpreter: Error invoking bsh method: eval\tSourced file: inline evaluation of: ``ctx.getThreadGroup().getName();'' \n2013/05/23 13:48:06 WARN  - jmeter.functions.BeanShell: Error running BSH script org.apache.jorphan.util.JMeterException: Error invoking bsh method: eval\tSourced file: inline evaluation of: ``ctx.getThreadGroup().getName();''\n\tat org.apache.jmeter.util.BeanShellInterpreter.bshInvoke(BeanShellInterpreter.java:192)\n\tat org.apache.jmeter.util.BeanShellInterpreter.eval(BeanShellInterpreter.java:198)\n\tat org.apache.jmeter.functions.BeanShell.execute(BeanShell.java:103)\n\tat org.apache.jmeter.engine.util.CompoundVariable.execute(CompoundVariable.java:146)\n\tat org.apache.jmeter.engine.util.CompoundVariable.execute(CompoundVariable.java:120)\n\tat org.apache.jmeter.testelement.property.FunctionProperty.getStringValue(FunctionProperty.java:92)\n\tat org.apache.jmeter.testelement.AbstractTestElement.getPropertyAsString(AbstractTestElement.java:273)\n\tat org.apache.jmeter.reporters.ResultCollector.getFilename(ResultCollector.java:170)\n\tat org.apache.jmeter.reporters.ResultCollector.initializeFileOutput(ResultCollector.java:554)\n\tat org.apache.jmeter.reporters.ResultCollector.testStarted(ResultCollector.java:261)\n\tat org.apache.jmeter.reporters.ResultCollector.testStarted(ResultCollector.java:283)\n\tat org.apache.jmeter.engine.StandardJMeterEngine.notifyTestListenersOfStart(StandardJMeterEngine.java:209)\n\tat org.apache.jmeter.engine.StandardJMeterEngine.run(StandardJMeterEngine.java:325)\n\tat java.lang.Thread.run(Thread.java:662)\nCaused by: java.lang.reflect.InvocationTargetException\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\tat java.lang.reflect.Method.invoke(Method.java:597)\n\tat org.apache.jmeter.util.BeanShellInterpreter.bshInvoke(BeanShellInterpreter.java:171)\n\t... 13 more\nCaused by: Sourced file: inline evaluation of: ``ctx.getThreadGroup().getName();'' : at Line: 1 : in file: inline evaluation of: ``ctx.getThreadGroup().getName();'' : .getName ( ) \n\nTarget exception: java.lang.NullPointerException: Attempt to invoke method getName on null value\n\n\tat bsh.UtilTargetError.toEvalError(UtilTargetError.java:70)\n\tat bsh.UtilEvalError.toEvalError(UtilEvalError.java:90)\n\tat bsh.Reflect.invokeObjectMethod(Reflect.java:82)\n\tat bsh.BSHPrimarySuffix.doName(BSHPrimarySuffix.java:176)\n\tat bsh.BSHPrimarySuffix.doSuffix(BSHPrimarySuffix.java:120)\n\tat bsh.BSHPrimaryExpression.eval(BSHPrimaryExpression.java:80)\n\tat bsh.BSHPrimaryExpression.eval(BSHPrimaryExpression.java:47)\n\tat bsh.Interpreter.eval(Interpreter.java:645)\n\tat bsh.Interpreter.eval(Interpreter.java:739)\n\tat bsh.Interpreter.eval(Interpreter.java:728)\n\t... 18 more\n\n\n=============================================================================\n\nothers on the user mailinglist say that it works in other node types (samplers /pre and post processors), just not listener nodes. Is this a limitation or a bug?\n\nI traced it as far as JMeterContext.java, where the threadGroup() method returns NULL for some reason.\n\nI am using:\n> java -version\njava version \"1.6.0_26\"\nJava(TM) SE Runtime Environment (build 1.6.0_26-b03)\nJava HotSpot(TM) 64-Bit Server VM (build 20.1-b02, mixed mode)", "id": 167374, "time": "2013-05-23T12:58:33Z", "bug_id": 55012, "creation_time": "2013-05-23T12:58:33Z", "is_private": false, "attachment_id": 30315}, {"count": 1, "attachment_id": null, "bug_id": 55012, "text": "I suspect the issue is one of timing - Listener file names are processed quite early on, so maybe the context has not yet been fully set up.", "id": 167380, "time": "2013-05-23T13:56:11Z", "creator": "sebb@apache.org", "creation_time": "2013-05-23T13:56:11Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 55012, "attachment_id": null, "text": "ResultCollector is initialized in StandardJMeterEngine thread before launch of any ThreadGroup so ctx.getThreadGroup() will return null.\n\nIt is by feature.\nI don't think it is worth changing this.", "id": 167842, "time": "2013-06-15T19:08:32Z", "creator": "p.mouawad@ubik-ingenierie.com", "creation_time": "2013-06-15T19:08:32Z", "is_private": false}]