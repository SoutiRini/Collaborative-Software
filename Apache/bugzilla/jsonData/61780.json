[{"count": 0, "tags": [], "creator": "lazar.kirchev@gmail.com", "text": "When AuthConfigFactoryImpl.getRegistrationIDs() is called with null parameter in order to get all active registrations' IDs, it always returns in the result list the default registration id, even if there is no registration with this ID.\n \nIt adds the default registration ID to the list if the default registration map is not null, but it actually is always non-null becuase it is created upon creation of the AuthConfigFactoryImpl instance.", "id": 202223, "time": "2017-11-18T13:58:59Z", "bug_id": 61780, "creation_time": "2017-11-18T13:58:59Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "text": "This pull request contains a test case, which illustrates the problem and a fix for it: https://github.com/apache/tomcat/pull/88\n\nOne comment - in the proposed fix I add a check if the default registrations map is empty. However, here the check for null seems not to be necessary as the map is created upon creation of the AuthConfigFactoryImpl instance.", "is_private": false, "id": 202224, "creator": "lazar.kirchev@gmail.com", "time": "2017-11-18T14:00:45Z", "bug_id": 61780, "creation_time": "2017-11-18T14:00:45Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 61780, "is_private": false, "id": 202266, "attachment_id": null, "creator": "markt@apache.org", "creation_time": "2017-11-20T13:24:44Z", "time": "2017-11-20T13:24:44Z", "text": "Agreed. It looks like some refactoring took place that wasn't fully taken into account. The null check is unnecessary. As is making the map volatile."}, {"count": 3, "attachment_id": null, "bug_id": 61780, "text": "Thanks for the pull request. I tweaked it slightly as per my previous comment before applying it.\n\nFixed in:\n- trunk for 9.0.2 onwards\n- 8.5.x for 8.5.24 onwards", "id": 202267, "time": "2017-11-20T13:39:47Z", "creator": "markt@apache.org", "creation_time": "2017-11-20T13:39:47Z", "tags": [], "is_private": false}]