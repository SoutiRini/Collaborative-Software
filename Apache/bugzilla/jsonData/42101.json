[{"count": 0, "tags": [], "creator": "alex.kiernan@gmail.com", "attachment_id": null, "text": "Using Sun CC (Sun C 5.8 Patch 121015-04 2007/01/10) using these options:\n\n-fast -g -xs -v -xstrconst -xtarget=ultra3 -xarch=v8plusa\n\nAt line 1221 of ssl_scache_shmcb.c in Apache 2.2.24 we get a bus error. The \nproblem is that given this struct:\n\ntypedef struct {\n    time_t expires;\n    unsigned int offset;\n    unsigned char s_id2;\n    unsigned char removed;\n} SHMCBIndex;\n\nWhich is stored in shared memory at offset 0xfe42afba (the idx variable)\n\nFor the code:\n\n(idx->s_id2 == id[1]) && !idx->removed\n\nthe compiler generates\n\nld       [%l2 + 8], %o0\n\n(i.e. add 8 to %l2, dereference it and store the result in %o0)\n\nin order to retrieve s_id2 and removed in one operation, only %l2 isn't \nnaturally aligned so you get a bus error.", "id": 101622, "time": "2007-04-12T08:21:14Z", "bug_id": 42101, "creation_time": "2007-04-12T08:21:14Z", "is_private": false}, {"count": 1, "tags": [], "creator": "jorton@redhat.com", "attachment_id": null, "text": "Nice work tracking this down, thanks.  It probably needs more _safe_ wrapper\nfunctions to avoid this (if possible).\n\nThe trunk version of shmcb has been rewritten to avoid alignment issues; it\nshould be possible to drop this in as a replacement: any results from testing\nvery welcome:\n\nhttp://svn.apache.org/viewvc/httpd/httpd/trunk/modules/ssl/ssl_scache_shmcb.c?revision=420983", "id": 102208, "time": "2007-04-24T02:59:20Z", "bug_id": 42101, "creation_time": "2007-04-24T02:59:20Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 42101, "text": "The shmcb rewrite is now committed to 2.2.x:\n\nhttp://svn.apache.org/viewvc?rev=686398&view=rev", "id": 119879, "time": "2008-08-18T02:05:34Z", "creator": "jorton@redhat.com", "creation_time": "2008-08-18T02:05:34Z", "is_private": false, "attachment_id": null}]