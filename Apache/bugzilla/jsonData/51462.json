[{"count": 0, "tags": [], "bug_id": 51462, "is_private": false, "id": 147677, "attachment_id": null, "creator": "kai@hbt.de", "creation_time": "2011-07-01T12:37:19Z", "time": "2011-07-01T12:37:19Z", "text": "I was happy to see that \"sync\" supports the \"zipfileset\" because I need to sync a destination folder with the contents of a source .jar/.zip file.\n\nI cannot just unzip the contents of the .jar/.zip file because dangling files that were removed in the .zip file would still be present in the target directory.\nSo, I really need a sync here.\n\nNow, I have the following simple target:\n\n<target name=\"test\">\n\t<sync todir=\"dir\">\n\t\t<zipfileset src=\"test.zip\" />\n\t</sync>\n</target>\n\nThe \"test.zip\" is a simple zip file which has one entry. The directory \"dir\" is initially empty.\n\nExecuting this target results in the entry of the zip file being copied into \"dir\".\nBUT: Executing the target a second time results in the copied file being removed from \"dir\" and \"dir\" is afterwards empty!\n\nIt seems that files that exist both in the target folder and the source file are removed from the target folder and files that only exist in the source file are copied into the target folder..."}, {"count": 1, "tags": [], "bug_id": 51462, "attachment_id": null, "id": 148190, "time": "2011-07-26T20:01:32Z", "creator": "ahagerup@yahoo.com", "creation_time": "2011-07-26T20:01:32Z", "is_private": false, "text": "This seems to be a general problem with <sync> support for resource collections. The following exhibits the same behavior:\n\n<target name=\"test\">\n  <sync todir=\"tgt\">\n    <mappedresources>\n      <fileset dir=\"src\"/>\n      <globmapper from=\"*\" to=\"test/*\"/>\n    </mappedresources>\n  </sync>\n</target>\n\nAlso, according to the documentation, the <sync> task \"Synchronize a target directory from the files defined in one or more Resource Collections\", however only one resource collection is allowed (multiple <fileset>'s work).\n\nThe following fails with \"Restrict$1 expects exactly one nested resource collection\":\n\n<target name=\"test\">\n  <sync todir=\"tgt\">\n    <mappedresources>\n      <fileset dir=\"src1\"/>\n      <globmapper from=\"*\" to=\"test1/*\"/>\n    </mappedresources>\n    <mappedresources>\n      <fileset dir=\"src2\"/>\n      <globmapper from=\"*\" to=\"test2/*\"/>\n    </mappedresources>\n  </sync>\n</target>\n\nOn a final documentation note, it says that \"To use a resource collection, the todir attribute must be set\", which is very redundant since the todir attribute is required for the <sync> task. Probably a copy/paste from the <copy> task."}, {"count": 2, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 148200, "creation_time": "2011-07-27T07:38:42Z", "time": "2011-07-27T07:38:42Z", "bug_id": 51462, "text": "with svn revision 1151369 sync really supports multiple resource collections (and the todir reference has been removed from the manual).\n\nI have a failing AntUnit test based on mappedResources that reproduces the bug, will look into it.", "is_private": false}, {"count": 3, "attachment_id": null, "bug_id": 51462, "is_private": false, "id": 148202, "time": "2011-07-27T08:51:02Z", "creator": "bodewig@apache.org", "creation_time": "2011-07-27T08:51:02Z", "tags": [], "text": "should be fixed with svn revision 1151386"}]