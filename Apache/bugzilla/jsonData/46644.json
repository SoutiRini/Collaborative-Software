[{"count": 0, "tags": [], "bug_id": 46644, "attachment_id": null, "id": 124567, "time": "2009-01-31T13:40:31Z", "creator": "matt@mattmccutchen.net", "creation_time": "2009-01-31T13:40:31Z", "is_private": false, "text": "It's sometimes desirable to have a suexec-ed CGI script read a custom environment variable to find out what it is supposed to do.  I described my scenario, where a CGI script needed to know which of three RewriteRules called it, at:\n\nhttp://marc.info/?l=apache-httpd-users&m=123166031312092&w=2\n\nThe problem is that, for good security reasons, suexec strips out all environment variables except for a whitelist consisting of standard ones set by the Web server.  I would like a safe, supported convention for passing custom environment variables.  (I can stuff them in the HTTP_ namespace, but that's a hack.)  Furthermore, internal redirects should not break the convention.\n\nThe obvious solution is to allocate a new namespace.  I previously suggested CGI_, but now I'm thinking SUEXEC_ may be better.  REDIRECT_SUEXEC_ vars could either be passed through or renamed to SUEXEC_REDIRECT_ .  An interesting additional possibility would be to prepend SUEXEC_ to unsafe variables instead of dropping them; this way, the entire environment would be available to suexec-ed CGI scripts (but not in a form that could subvert them) without any extra work on the Apache side."}, {"count": 1, "tags": [], "creator": "graham@reg.ca", "attachment_id": null, "text": "Seconded.  This really is a feature request rather than a bug, so I'm updating the version to reflect head.", "id": 147877, "time": "2011-07-11T22:00:27Z", "bug_id": 46644, "creation_time": "2011-07-11T22:00:27Z", "is_private": false}]