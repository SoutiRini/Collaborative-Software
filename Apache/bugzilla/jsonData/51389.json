[{"count": 0, "tags": [], "bug_id": 51389, "attachment_id": null, "id": 147219, "time": "2011-06-17T07:28:37Z", "creator": "vlsergey@gmail.com", "creation_time": "2011-06-17T07:28:37Z", "is_private": false, "text": "Add support for sprmPJc paragraph SPRM, including support for logical justification. See Bug49820.doc (header 8 and header 9) for example."}, {"count": 1, "tags": [], "creator": "vlsergey@gmail.com", "attachment_id": 27166, "is_private": false, "id": 147220, "time": "2011-06-17T07:29:45Z", "bug_id": 51389, "creation_time": "2011-06-17T07:29:45Z", "text": "Created attachment 27166\npap_type.xml patch\n\nUpdate pap_type.xml with sorting from specification, optional descriptions and fBiDi field definition."}, {"count": 2, "tags": [], "bug_id": 51389, "attachment_id": 27167, "id": 147221, "time": "2011-06-17T07:33:06Z", "creator": "vlsergey@gmail.com", "creation_time": "2011-06-17T07:33:06Z", "is_private": false, "text": "Created attachment 27167\nscratchpad patch"}, {"count": 3, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "is_private": false, "id": 147240, "time": "2011-06-18T08:59:05Z", "bug_id": 51389, "creation_time": "2011-06-18T08:59:05Z", "text": "Applied in r1137143\n\nThanks,\nYegor"}, {"count": 4, "tags": [], "bug_id": 51389, "text": "Created attachment 27174\ntest case\n\ntest case", "id": 147252, "time": "2011-06-18T19:22:23Z", "creator": "vlsergey@gmail.com", "creation_time": "2011-06-18T19:22:23Z", "is_private": false, "attachment_id": 27174}, {"count": 5, "tags": [], "bug_id": 51389, "attachment_id": null, "id": 147264, "time": "2011-06-20T06:14:05Z", "creator": "vlsergey@gmail.com", "creation_time": "2011-06-20T06:14:05Z", "is_private": false, "text": "Yegor,\n\nOne change to ParagraphSprmUncompressor.java lost\n\nIndex: ParagraphSprmUncompressor.java\n===================================================================\n--- ParagraphSprmUncompressor.java\t(revision 1137143)\n+++ ParagraphSprmUncompressor.java\t(working copy)\n@@ -346,7 +346,8 @@\n         }\n         break;\n       case 0x41:\n-        // sprmPFBiDi \n+        // sprmPFBiDi\n+        newPAP.setFBiDi((byte) sprm.getOperand());\n         break;\n       case 0x43:\n \nIt is required for correct processing of logical left-right justification."}, {"count": 6, "tags": [], "bug_id": 51389, "text": "Should be fixed in r1137538\n\nThe missing line wasn't in the patch.  Below are the changes for ParagraphSprmUncompressor from the scratchpad patch:\n\n--- src/org/apache/poi/hwpf/sprm/ParagraphSprmUncompressor.java\t(revision 1135282)\n+++ src/org/apache/poi/hwpf/sprm/ParagraphSprmUncompressor.java\t(working copy)\n@@ -346,8 +346,7 @@\n         }\n         break;\n       case 0x41:\n-\n-        // undocumented\n+        // sprmPFBiDi \n         break;\n       case 0x43:\n \n@@ -387,7 +386,8 @@\n         newPAP.setFTtpEmbedded((byte)sprm.getOperand());\n         break;\n       case 0x61:\n-        // Logicial justification of the paragraph, eg left, centre, right\n+        // sprmPJc \n+        newPAP.setJustificationLogical((byte) sprm.getOperand());\n         break;\n       default:\n         break;\n\n\nRegards,\nYegor\n\n(In reply to comment #5)\n> Yegor,\n> \n> One change to ParagraphSprmUncompressor.java lost\n> \n> Index: ParagraphSprmUncompressor.java\n> ===================================================================\n> --- ParagraphSprmUncompressor.java    (revision 1137143)\n> +++ ParagraphSprmUncompressor.java    (working copy)\n> @@ -346,7 +346,8 @@\n>          }\n>          break;\n>        case 0x41:\n> -        // sprmPFBiDi \n> +        // sprmPFBiDi\n> +        newPAP.setFBiDi((byte) sprm.getOperand());\n>          break;\n>        case 0x43:\n> \n> It is required for correct processing of logical left-right justification.", "id": 147265, "time": "2011-06-20T08:09:44Z", "creator": "yegor@dinom.ru", "creation_time": "2011-06-20T08:09:44Z", "is_private": false, "attachment_id": null}]