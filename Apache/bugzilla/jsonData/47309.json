[{"count": 0, "text": "It seems to me that the number of cell comments that can be added to a spreadsheet using HSSF without messing up the ordering is limited to 65536 comments. \n\n* Create sheet with comments using HSSFComment\n* write sheet to output stream\n* read sheet with input stream\n-> comments do not appear in correct row/col anymore\n\nNOTE: MS-Excel can read the comments correctly!!\n\n\nThe HSSFCell.findComments() method hashes TextObjectRecords with their Short datatype IDs, which explains the number limit. Using Integer here (and when serializing/deserializing) messes up the format so that not even MS-Excel can read it.\n\n\nAttachment:\n\nprovides JUnit test file that produces a spreadsheet with more than 65536 comments, writes to a file, reads the file in again and compares the order of comments between the two sheets.\nComments contain just row/col index numbers for comparison with cell content.", "bug_id": 47309, "is_private": false, "id": 127589, "time": "2009-06-03T06:38:42Z", "creator": "algonquin637@yahoo.de", "creation_time": "2009-06-03T06:38:42Z", "tags": [], "attachment_id": null}, {"count": 1, "text": "Created attachment 23748\nJUnit test case", "bug_id": 47309, "is_private": false, "id": 127590, "time": "2009-06-03T06:39:19Z", "creator": "algonquin637@yahoo.de", "creation_time": "2009-06-03T06:39:19Z", "tags": [], "attachment_id": 23748}, {"count": 2, "tags": [], "text": "Ken,\n\nThanks for the good bug report, you've done 50 percent of the job to fix the problem. I committed the fix in r782398. \n\nShapeId is unsigned short and matching cells and comments by it works fine only if the number of comments is less than  65536.  The fact that Excel can handle sheets with greater numbers of comments made me think it uses a different logic. In fact, Excel uses a simple ordinal relationship: i-th NoteRecord corresponds to the i-th drawing group containing TextObjectRecord with the comment's text. This heuristics works fine for any number cell comments.\n\nRegards,\nYegor", "is_private": false, "id": 127721, "creation_time": "2009-06-07T08:25:50Z", "time": "2009-06-07T08:25:50Z", "creator": "yegor@dinom.ru", "bug_id": 47309, "attachment_id": null}]