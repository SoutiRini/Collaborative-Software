[{"count": 0, "tags": [], "bug_id": 14453, "is_private": false, "text": "We are using mod_rewrite with an external rewrite program to produce an inbound \nproxy that splits requests between staff and student back-end servers.\n\nOccassionally the rewrite program starts returning results that relate to \nprevious requests, rather than the current one and the server has to be\nrestarted.\n\nHaving added some extra debugging to mod_rewrite.c I have determined that (at\nleast on the last occassion) the problem is with someone trying to access a\nURL that has a newline character encoded in it :\n\nhttp://www.cems.uwe.ac.uk/~opkgyaas%0a/images/livingeaston.JPG\n\nThe customised debug output when this happens is :\n\nlookup_map_program: called for /~jsmith/ec/perm+csp/sld026.htm\nrewritelock_alloc: called for /~jsmith/ec/perm+csp/sld026.htm\nfd_lock: called for /~jsmith/ec/perm+csp/sld026.htm\nfd_lock: ended fcntl() loop [rc=0, errno=11, EINTR=4] for /~jsmith/ec/perm+csp/s\nld026.htm\nfd_lock: got lock for /~jsmith/ec/perm+csp/sld026.htm\nlookup_map_program: rewrote -\n        203.197.98.2,/~jsmith/ec/perm+csp/sld026.htm to http://web03.cems.uwe.ac\n.uk/~jsmith/ec/perm+csp/sld026.htm\n                 for /~jsmith/ec/perm+csp/sld026.htm\nrewritelock_free: called for /~jsmith/ec/perm+csp/sld026.htm\nfd_unlock: called for /~jsmith/ec/perm+csp/sld026.htm\nfd_unlock: unlocked for /~jsmith/ec/perm+csp/sld026.htm\nlookup_map_program: called for /~jsmith/ec/perm+csp/img026.gif\nrewritelock_alloc: called for /~jsmith/ec/perm+csp/img026.gif\nfd_lock: called for /~jsmith/ec/perm+csp/img026.gif\nfd_lock: ended fcntl() loop [rc=0, errno=11, EINTR=4] for /~jsmith/ec/perm+csp/i\nmg026.gif\nfd_lock: got lock for /~jsmith/ec/perm+csp/img026.gif\nlookup_map_program: rewrote -\n        203.197.98.2,/~jsmith/ec/perm+csp/img026.gif to http://web03.cems.uwe.ac\n.uk/~jsmith/ec/perm+csp/img026.gif\n                 for /~jsmith/ec/perm+csp/img026.gif\nrewritelock_free: called for /~jsmith/ec/perm+csp/img026.gif\nfd_unlock: called for /~jsmith/ec/perm+csp/img026.gif\nfd_unlock: unlocked for /~jsmith/ec/perm+csp/img026.gif\nlookup_map_program: called for /~opkgyaas\n/images/livingeaston.JPG\nrewritelock_alloc: called for /~opkgyaas\n/images/livingeaston.JPG\nfd_lock: called for /~opkgyaas\n/images/livingeaston.JPG\nfd_lock: ended fcntl() loop [rc=0, errno=2, EINTR=4] for /~opkgyaas\n/images/livingeaston.JPG\nfd_lock: got lock for /~opkgyaas\n/images/livingeaston.JPG\nlookup_map_program: rewrote -\n        209.237.238.163,/~opkgyaas\n/images/livingeaston.JPG to http://www.cems.uwe.ac.uk/blocked.html\n                 for /~opkgyaas\n/images/livingeaston.JPG\nrewritelock_free: called for /~opkgyaas\n/images/livingeaston.JPG\nfd_unlock: called for /~opkgyaas\n/images/livingeaston.JPG\nfd_unlock: unlocked for /~opkgyaas\n/images/livingeaston.JPG\nlookup_map_program: called for /~jsmith/ec/perm+csp/sld027.htm\nrewritelock_alloc: called for /~jsmith/ec/perm+csp/sld027.htm\nfd_lock: called for /~jsmith/ec/perm+csp/sld027.htm\nfd_lock: ended fcntl() loop [rc=0, errno=11, EINTR=4] for /~jsmith/ec/perm+csp/s\nld027.htm\nfd_lock: got lock for /~jsmith/ec/perm+csp/sld027.htm\nlookup_map_program: rewrote -\n        203.197.98.2,/~jsmith/ec/perm+csp/sld027.htm to NULL\n                 for /~jsmith/ec/perm+csp/sld027.htm\nrewritelock_free: called for /~jsmith/ec/perm+csp/sld027.htm\nfd_unlock: called for /~jsmith/ec/perm+csp/sld027.htm\nfd_unlock: unlocked for /~jsmith/ec/perm+csp/sld027.htm\nlookup_map_program: called for /~ngunton/worksheets/shell.pdf\nrewritelock_alloc: called for /~ngunton/worksheets/shell.pdf\nfd_lock: called for /~ngunton/worksheets/shell.pdf\nfd_lock: ended fcntl() loop [rc=0, errno=11, EINTR=4] for /~ngunton/worksheets/s\nhell.pdf\nfd_lock: got lock for /~ngunton/worksheets/shell.pdf\nlookup_map_program: rewrote -\n        66.130.224.176,/~ngunton/worksheets/shell.pdf to http://web03.cems.uwe.a\nc.uk/~jsmith/ec/perm+csp/sld027.htm\n                 for /~ngunton/worksheets/shell.pdf\nrewritelock_free: called for /~ngunton/worksheets/shell.pdf\nfd_unlock: called for /~ngunton/worksheets/shell.pdf\nfd_unlock: unlocked for /~ngunton/worksheets/shell.pdf\nlookup_map_program: called for /~ngunton/worksheets/first.gif\nrewritelock_alloc: called for /~ngunton/worksheets/first.gif\nfd_lock: called for /~ngunton/worksheets/first.gif\nfd_lock: ended fcntl() loop [rc=0, errno=9, EINTR=4] for /~ngunton/worksheets/fi\nrst.gif\nfd_lock: got lock for /~ngunton/worksheets/first.gif\nlookup_map_program: rewrote -\n        66.130.224.176,/~ngunton/worksheets/first.gif to http://web03.cems.uwe.a\nc.uk/~ngunton/worksheets/shell.pdf\n                 for /~ngunton/worksheets/first.gif\nrewritelock_free: called for /~ngunton/worksheets/first.gif\nfd_unlock: called for /~ngunton/worksheets/first.gif\nfd_unlock: unlocked for /~ngunton/worksheets/first.gif\n\n\nSince the external rewrite programs rely on receiving newline delimited data\non stdin, any newlines should really be stripped out, or URL encoded, before\nthey receive them.", "id": 26078, "time": "2002-11-11T17:53:01Z", "creator": "Philip.Naylor@uwe.ac.uk", "creation_time": "2002-11-11T17:53:01Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "Created attachment 7543\nPatch we use successfully since monthes about this problem", "attachment_id": 7543, "bug_id": 14453, "id": 41639, "time": "2003-07-28T11:08:52Z", "creator": "cedric.gavage@unixtech.be", "creation_time": "2003-07-28T11:08:52Z", "is_private": false}, {"count": 2, "tags": [], "creator": "nd@perlig.de", "attachment_id": null, "id": 45134, "time": "2003-10-06T10:02:21Z", "bug_id": 14453, "creation_time": "2003-10-06T10:02:21Z", "is_private": false, "text": "This was fixed in 2.1 some time ago and waits for backport approval (another\nvote from a core developer).\n\nThanks for your report!"}, {"count": 3, "tags": [], "creator": "nd@perlig.de", "attachment_id": null, "is_private": false, "id": 45139, "time": "2003-10-06T10:18:55Z", "bug_id": 14453, "creation_time": "2003-10-06T10:18:55Z", "text": "*** Bug 21975 has been marked as a duplicate of this bug. ***"}, {"count": 4, "tags": [], "text": "It will be fixed in 1.3.30 and 2.0.49 versions.", "is_private": false, "bug_id": 14453, "id": 50422, "time": "2004-01-12T19:32:15Z", "creator": "nd@perlig.de", "creation_time": "2004-01-12T19:32:15Z", "attachment_id": null}]