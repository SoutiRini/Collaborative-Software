[{"count": 0, "tags": [], "bug_id": 46949, "attachment_id": null, "id": 125925, "time": "2009-04-01T01:22:39Z", "creator": "sander.de.boer@eo.nl", "creation_time": "2009-04-01T01:22:39Z", "is_private": false, "text": "I have upgraded my apache 2.2.6 box with the _prefork_ mpm to apache\n2.2.11 with the _worker_ mpm. It's a reverse proxy for 2 backend tomcat(ajp)\nservers. Apache is also used as balancer.\n\n<Proxy balancer://patmos>\n  BalancerMember ajp://tomcat2:8009 route=mmbase01 min=5 smax=10 max=15\n  BalancerMember ajp://tomcat1:8009 route=mmbase02 min=5 smax=10 max=15\n</Proxy>\n\nSince this upgrade apache serves sometimes wrong content. It seems that the\nserved content comes from another thread. Something like a thread-safe problem.\n\nAfter this upgrade I tried figure out what the problem is. A downgrade to 2.2.6 with _worker_ mpm resolve the problem. After that I upgraded to 2.2.10 without problems again.\n\nMy conclusion: This bug is introduced in 2.2.11."}, {"count": 1, "tags": [], "bug_id": 46949, "attachment_id": null, "id": 125929, "time": "2009-04-01T08:10:56Z", "creator": "rpluem@apache.org", "creation_time": "2009-04-01T08:10:56Z", "is_private": false, "text": "Please provide\n\n- A small test case including a small web application and a request that shows the behaviour\n- The Tomcat version you are using and what kind of Tomcat connector you are using\n- What clients trigger this issue (e.g. which browser, is it a POST or a GET request)\n- A network sniff that exposes the problem"}, {"count": 2, "tags": [], "bug_id": 46949, "text": "Please provide the lines in the error log file containing proxy:", "id": 125930, "time": "2009-04-01T08:13:34Z", "creator": "rpluem@apache.org", "creation_time": "2009-04-01T08:13:34Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 46949, "text": "Since this seems to be difficult to reproduce in general, and it's easy for you, could you please confirm, that your 2.2.10 and 2.2.11 tests were done on the same systems, using the same backends, both versions using worker MPM, same version of the APR libraries and same configuration?\n\nIf yes, then it should be interesting to redo the tests with\n\n- httpd 2.2.10 using mod_proxy, mod_proxy_ajp and mod_proxy_balancer from 2.2.11\n- the other way round, using httpd 2.2.11 and the proxy modules from 2.2.10\n\nAs far as I can see, the mixed environments should work in principle. In case the problem shows only up with one of the two combinations we would know, whether the root cause is in the core or the proxy modules.\n\nOf course the info requested in comments #1 and #2 will be very helpful as well.", "id": 125960, "time": "2009-04-02T14:34:25Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2009-04-02T14:34:25Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "sander.de.boer@eo.nl", "attachment_id": null, "text": "I am using apache-tomcat-6.0.16 with the following connector:\n  <Connector port=\"8009\" protocol=\"AJP/1.3\" redirectPort=\"443\" maxThreads=\"512\" enableLookups=\"false\" />\n\nThis bug is hard to reproduce. It seems that this is only a problem onder load. Even on a test envoirement I can't reproduce it.\n\nBecause many of our clients complain to this issue, I set up a wget loop that downloaded a test.jsp containing the word 'hello'. In this way I saw there was sometimes other content downloaded than the word 'hello'.\n\nI think that the errors in the error log are not related to this issue, because the time doesnt match:\n[Sun Mar 29 16:35:00 2009] [error] proxy: read zero bytes, expecting 1902 bytes\n[Sun Mar 29 16:38:03 2009] [error] proxy: read zero bytes, expecting 1902 bytes\n[Sun Mar 29 16:51:49 2009] [error] proxy: read zero bytes, expecting 1902 bytes\n\nI will try a mixed version of .10 and .11, but first weekend!", "id": 125969, "time": "2009-04-03T04:26:20Z", "bug_id": 46949, "creation_time": "2009-04-03T04:26:20Z", "is_private": false}, {"count": 5, "tags": [], "creator": "rpluem@apache.org", "attachment_id": null, "text": "Committed a fix to trunk (r763394) that was tested successfully by Sander.", "id": 126118, "time": "2009-04-08T14:12:15Z", "bug_id": 46949, "creation_time": "2009-04-08T14:12:15Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 46949, "text": "A patch for 2.2.11 can be also found in some hours at the mirrors and at http://www.apache.org/dist/httpd/patches/apply_to_2.2.11", "id": 126122, "time": "2009-04-08T14:26:30Z", "creator": "rpluem@apache.org", "creation_time": "2009-04-08T14:26:30Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "creator": "jakob.ericsson@gmail.com", "attachment_id": null, "text": "We are experiencing the same problem on Windows 2003 server (httpd 2.2.11).\nWill patch be available in 2.2.12?", "id": 126319, "time": "2009-04-17T00:22:45Z", "bug_id": 46949, "creation_time": "2009-04-17T00:22:45Z", "is_private": false}, {"text": "Backport to 2.2.x as r768506.", "tags": [], "creator": "rpluem@apache.org", "attachment_id": null, "count": 8, "id": 126518, "time": "2009-04-25T02:59:23Z", "bug_id": 46949, "creation_time": "2009-04-25T02:59:23Z", "is_private": false}, {"text": "Can you confirm that this problem has been fixed on Apache 2.4.x? Many thanks!", "tags": [], "creator": "danieledanieleee@libero.it", "attachment_id": null, "count": 9, "id": 198747, "time": "2017-05-09T15:45:01Z", "bug_id": 46949, "creation_time": "2017-05-09T15:45:01Z", "is_private": false}]