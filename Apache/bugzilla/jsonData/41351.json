[{"count": 0, "tags": [], "creator": "covener@gmail.com", "is_private": false, "text": "Attached is a patch for allowing aprutil LDAP to use the Tivoli\nDirectory Server SDK from IBM.\n\nSimple SSL connections work without any explicit configuration because\nthe SDK ships with a Key Database that contains the usual public CAs\nThis Key Database used for Certificate Authorities and private keys\ncan only effectively be set during the one-time\nldap_ssl_client_init()/apr_ldap_ssl_init() and this does work via\napr-util if the application passes in the cert_auth_file\n\nA private key can be selected for client authentication during the\nper-connection ldap_ssl_init()/apr_ldap_init() but this doesn't mesh\nvery well with the current apr-util LDAP interface.  Allowing this\nwould only require a addl char* passed to apr_ldap_init()\n\nNeither the keyring or the name of the private cert are settable via\nthe ldap_set_option interface which unfortunately differs from other\nsupported LDAP SDKs.\n\nI was able to get a small test program to work over ssl, as well as\nhttpd with a tiny change to actually pass the \"secure\" parameter to\napr_ldap_init()\n\nv5.2 SDK readme:\nhttp://publib.boulder.ibm.com/tividd/td/IBMDS/IDSCreadme52/en_US/HTML/client.htm\nv5.2 SDK programmers reference:\nhttp://publib.boulder.ibm.com/tividd/td/IBMDS/IDSprogref52/en_US/HTML/progref.htm\nProduct Page: (appears client/SDK bundled in large ldap server package)\nhttp://www-306.ibm.com/software/tivoli/products/directory-server/", "id": 97951, "time": "2007-01-11T09:25:11Z", "bug_id": 41351, "creation_time": "2007-01-11T09:25:11Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "Created attachment 19394\ninitial tivoli ldap support (ldap, ldaps)", "attachment_id": 19394, "id": 97952, "creator": "covener@gmail.com", "time": "2007-01-11T09:26:04Z", "bug_id": 41351, "creation_time": "2007-01-11T09:26:04Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 41351, "attachment_id": null, "is_private": false, "id": 111172, "time": "2007-11-27T14:37:08Z", "creator": "minfrin@sharp.fm", "creation_time": "2007-11-27T14:37:08Z", "text": "Following the docs at\nhttp://publib.boulder.ibm.com/infocenter/zos/v1r9/index.jsp?topic=/com.ibm.zos.r9.glpa100/ssl_client_init.htm,\nI have overhauled the patch to support the ldap_ssl_client_init() and\nldap_ssl_init() initialisation sequences, in line with the current behavior of\napr-util.\n\nThe ldap_ssl_client_init() routine has been embedded in apr_ldap_set_options()\nto be in line with the rest of the apr code.\n\nThe certificate label in ldap_ssl_init is set to NULL, which causes the\nfollowing behaviour according to the docs:\n\n\"Specify NULL for this parameter to use the GSK_KEY_LABEL environment variable.\nIf NULL is specified for this parameter and the GSK_KEY_LABEL environment\nvariable is not defined, the default certificate for the SSL key database or SAF\nkey ring can be used. A client certificate is needed only when the LDAP server\nis configured for client authentication.\"\n\nSupport for starttls has been added in this new patch.\n\nCan you test it out for me? I don't have access to a machine...\n"}, {"count": 3, "tags": [], "bug_id": 41351, "attachment_id": 21198, "id": 111174, "time": "2007-11-27T14:41:14Z", "creator": "minfrin@sharp.fm", "creation_time": "2007-11-27T14:41:14Z", "is_private": false, "text": "Created attachment 21198\nUpdated patch with standard apr_ldap_set_option support, and starttls support"}, {"count": 4, "tags": [], "bug_id": 41351, "attachment_id": null, "is_private": false, "id": 127841, "time": "2009-06-10T13:31:40Z", "creator": "markt@apache.org", "creation_time": "2009-06-10T13:31:40Z", "text": "Reset assignee so mails go to list."}, {"count": 5, "tags": [], "bug_id": 41351, "attachment_id": null, "id": 146730, "time": "2011-05-29T16:08:19Z", "creator": "i.galic@brainsware.org", "creation_time": "2011-05-29T16:08:19Z", "is_private": false, "text": "Graham, Eric: This bug is now > 4 years old. I don't see the code added (in trunk), so I assume it's still outstanding. As of yet the support for Tivoli I can see in the code is very basic. Graham's \"advanced\" StartTLS is completely missing."}, {"count": 6, "tags": [], "bug_id": 41351, "attachment_id": null, "is_private": false, "id": 146783, "time": "2011-05-31T20:29:19Z", "creator": "covener@gmail.com", "creation_time": "2011-05-31T20:29:19Z", "text": "This is a confusing PR.\n\nThis bug was originally for basic Tivoli support, including basic SSL.  \n\nBasic non-SSL Tivoli support was added in a later mailing-list only thread, and somehow this PR morphed into \"SSL support with Tivoli SDK\".\n\nA half-public/half-private thread with Graham says this 11/27 patch did not work for me.  \n\nMeanwhile, in the Apache-based webserver that I work with that bundles tivoli LDAP exclusively, we've done the guts of ldaps directly in httpd to get around the issues with the timing of the SSL initialization vs. the APR/APU API.\n\nNeeds a fresh working session to get beyond NEEDINFO, sometime in future httpd"}, {"count": 7, "tags": [], "bug_id": 41351, "attachment_id": null, "id": 147510, "time": "2011-06-26T10:49:51Z", "creator": "minfrin@sharp.fm", "creation_time": "2011-06-26T10:49:51Z", "is_private": false, "text": "Can you confirm specifically what about the 11/27 patch didn't work for you?\n\nHaving just looked at mod_ldap, there is an initialisation bug that exists where SSL is hard coded as switched off in util_ldap_post_config() for toolkits that require SSL switched on at the init step. Then, there is a second bug in apr_ldap_ssl_init() itself where the flag being passed is the wrong type. These two would need to be fixed before this patch would work."}, {"count": 8, "tags": [], "bug_id": 41351, "attachment_id": null, "is_private": false, "id": 147512, "time": "2011-06-26T11:37:02Z", "creator": "minfrin@sharp.fm", "creation_time": "2011-06-26T11:37:02Z", "text": "Actually, looking this deeper, util_ldap_post_config() doesn't seem to have a bug, but apr_ldap_ssl_init() does. This shouldn't affect Tivoli support though."}]