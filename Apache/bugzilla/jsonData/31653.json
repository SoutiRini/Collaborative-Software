[{"count": 0, "tags": [], "bug_id": 31653, "attachment_id": null, "text": "Auditing code of Apache 2.0.50\n\n\nObserving in some mod of apache, indeed in mod of it breaks that\nthis in /modulos/cache and whose I modulate calls\nmod_file_cache.c i found in 110 lines 109 and a function badly programmed that\nallows to\nexplode I cosay already indicated\n\n\nchar mtimestr[APR_RFC822_DATE_LEN];\nchar sizestr[21];\n\nThese lines indeed are the vulnerable ones since it is not taken\npertinent care to assure the series character that are\nassigned on this pile and the security is not taken either stops\nthat carateres is assigned surely.\nThese circumstances usually are taken advantage of to mount buffer\noverflow attacks", "id": 64946, "time": "2004-10-11T19:35:33Z", "creator": "mmardones@gmail.com", "creation_time": "2004-10-11T19:35:33Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 31653, "attachment_id": null, "is_private": false, "id": 65417, "time": "2004-10-21T07:02:40Z", "creator": "mmardones@gmail.com", "creation_time": "2004-10-21T07:02:40Z", "text": "\n[root@cdtboys flawfinder-1.26]# ./flawfinder \n/root/httpd-2.0.50/modules/cache/mod_file_cache.c\nFlawfinder version 1.26, (C) 2001-2004 David A. Wheeler.\nNumber of dangerous functions in C/C++ ruleset: 158\nExamining /root/httpd-2.0.50/modules/cache/mod_file_cache.c\n/root/httpd-2.0.50/modules/cache/mod_file_cache.c:109:  [2] (buffer) char:\n  Statically-sized arrays can be overflowed. Perform bounds checking,\n  use functions that limit length, or ensure that the size is larger than\n  the maximum possible length.\n/root/httpd-2.0.50/modules/cache/mod_file_cache.c:110:  [2] (buffer) char:\n  Statically-sized arrays can be overflowed. Perform bounds checking,\n  use functions that limit length, or ensure that the size is larger than\n  the maximum possible length.\n/root/httpd-2.0.50/modules/cache/mod_file_cache.c:203:  [1] (buffer) strlen:\n  Does not handle strings that are not \\0-terminated (it could cause a\n  crash if unprotected).\n\nHits = 3\nLines analyzed = 415 in 3.01 seconds (165 lines/second)\nPhysical Source Lines of Code (SLOC) = 256\nHits@level = [0]   0 [1]   1 [2]   2 [3]   0 [4]   0 [5]   0\nHits@level+ = [0+]   3 [1+]   3 [2+]   2 [3+]   0 [4+]   0 [5+]   0\nHits/KSLOC@level+ = [0+] 11.7188 [1+] 11.7188 [2+] 7.8125 [3+]   0 [4+]   0 [5+]   0\nMinimum risk level = 1\nNot every hit is necessarily a security vulnerability.\nThere may be other security vulnerabilities; review your code!\n\n-----------\n\n[root@cdtboys rats-2.1]# ./rats -i /root/httpd-2.0.50/modules/cache/mod_file_cache.c\nEntries in perl database: 33\nEntries in python database: 62\nEntries in c database: 334\nEntries in php database: 55\nAnalyzing /root/httpd-2.0.50/modules/cache/mod_file_cache.c\n/root/httpd-2.0.50/modules/cache/mod_file_cache.c:109: High: fixed size local buffer\n/root/httpd-2.0.50/modules/cache/mod_file_cache.c:110: High: fixed size local buffer\nExtra care should be taken to ensure that character arrays that are allocated\non the stack are used safely.  They are prime targets for buffer overflow\nattacks.\n\nTotal lines analyzed: 416\nTotal time 0.003928 seconds\n105906 lines per second\n\n\n"}, {"count": 2, "tags": [], "creator": "chip@force-elite.com", "attachment_id": null, "id": 66393, "time": "2004-11-04T02:30:41Z", "bug_id": 31653, "creation_time": "2004-11-04T02:30:41Z", "is_private": false, "text": "I believe this is safe. ( I don't like the style... but..)\n\nIt is only used by apr_rfc822_date(...).  This function guarantees the safety of\nusing this length."}]