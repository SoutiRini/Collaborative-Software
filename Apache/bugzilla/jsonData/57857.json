[{"count": 0, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "There seems to be increasing demand for an official OSGi bundle version of Apache POI. Some other Apache projects (eg ServiceMix) will sometimes produce their own copy, but not that often, which leaves our OSGi users on older versions or struggling themselves\n\nThrough the use of Apache Felix and friends, it ought to be fairly straightforward to build a bundle. Based on the Apache Tika OSGi bundle work of late, we can also include a unit test which checks that the bundle comes up and main parts of the API work", "id": 182620, "time": "2015-04-25T01:52:18Z", "bug_id": 57857, "creation_time": "2015-04-25T01:52:18Z", "is_private": false}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "To try the work so far, you can use the \"osgi\" ant target, or you can build + install the maven poms locally with the \"mvn-install\" ant target then in the osgi directory run \"mvn -Dpoi.version=3.12-beta2 install\". However, it isn't yet working...", "id": 182621, "time": "2015-04-25T02:18:09Z", "bug_id": 57857, "creation_time": "2015-04-25T02:18:09Z", "is_private": false}, {"count": 2, "tags": [], "text": "So just as a quick experiment I did get the service mix 3.11 bundle running but it did take some toying around:\n\nIn the config I had to add:\norg.osgi.framework.system.packages.extra=org.w3c.dom,org.w3c.dom.html,org.w3c.dom.traversal,org.w3c.dom.ranges,org.w3c.dom.views\n\nThis exposes the JRE classes to the osgi container.\n\n\nAlso below is the log out of the bundles that I had in play to get it to spin up.  The bundles I added are 1, 7-12,16.  \nSTART LEVEL 1\n   ID|State      |Level|Name\n    0|Active     |    0|System Bundle (4.6.1)\n    1|Active     |    1|Apache Commons Codec (1.9.0)\n    2|Active     |    1|Apache Felix Bundle Repository (2.0.2)\n    3|Active     |    1|Apache Felix Configuration Admin Service (1.8.2)\n    4|Active     |    1|Apache Felix Gogo Command (0.14.0)\n    5|Active     |    1|Apache Felix Gogo Runtime (0.12.1)\n    6|Active     |    1|Apache Felix Gogo Shell (0.10.0)\n    7|Active     |    1|Apache ServiceMix :: Bundles :: bcel (5.2.0.4)\n    8|Active     |    1|Apache ServiceMix :: Bundles :: poi (3.11.0)\n    9|Active     |    1|Apache ServiceMix :: Bundles :: xalan (2.7.1.4)\n   10|Active     |    1|Apache ServiceMix :: Bundles :: xercesImpl (2.9.1.4)\n   11|Active     |    1|Apache ServiceMix :: Bundles :: xmlresolver (1.2.0.5)\n   12|Active     |    1|Apache ServiceMix :: Bundles :: xmlsec (1.4.3.3)\n   13|Active     |    1|Apache Sling OSGi LogService Implementation (1.0.4)\n   14|Active     |    1|OPS4J Pax Logging - API (1.8.2)\n   15|Active     |    1|OPS4J Pax Logging - Log4j v2 (1.8.2)\n   16|Active     |    1|Apache XML Security for Java (2.0.1)", "attachment_id": null, "id": 182634, "creation_time": "2015-04-26T15:40:50Z", "time": "2015-04-26T15:40:50Z", "creator": "bob@apache.org", "bug_id": 57857, "is_private": false}, {"count": 3, "tags": [], "bug_id": 57857, "text": "So just as a quick experiment I did get the service mix 3.11 bundle running but it did take some toying around:\n\nIn the config I had to add:\norg.osgi.framework.system.packages.extra=org.w3c.dom,org.w3c.dom.html,org.w3c.dom.traversal,org.w3c.dom.ranges,org.w3c.dom.views\n\nThis exposes the JRE classes to the osgi container.\n\n\nAlso below is the log out of the bundles that I had in play to get it to spin up.  The bundles I added are 1, 7-12,16.  \nSTART LEVEL 1\n   ID|State      |Level|Name\n    0|Active     |    0|System Bundle (4.6.1)\n    1|Active     |    1|Apache Commons Codec (1.9.0)\n    2|Active     |    1|Apache Felix Bundle Repository (2.0.2)\n    3|Active     |    1|Apache Felix Configuration Admin Service (1.8.2)\n    4|Active     |    1|Apache Felix Gogo Command (0.14.0)\n    5|Active     |    1|Apache Felix Gogo Runtime (0.12.1)\n    6|Active     |    1|Apache Felix Gogo Shell (0.10.0)\n    7|Active     |    1|Apache ServiceMix :: Bundles :: bcel (5.2.0.4)\n    8|Active     |    1|Apache ServiceMix :: Bundles :: poi (3.11.0)\n    9|Active     |    1|Apache ServiceMix :: Bundles :: xalan (2.7.1.4)\n   10|Active     |    1|Apache ServiceMix :: Bundles :: xercesImpl (2.9.1.4)\n   11|Active     |    1|Apache ServiceMix :: Bundles :: xmlresolver (1.2.0.5)\n   12|Active     |    1|Apache ServiceMix :: Bundles :: xmlsec (1.4.3.3)\n   13|Active     |    1|Apache Sling OSGi LogService Implementation (1.0.4)\n   14|Active     |    1|OPS4J Pax Logging - API (1.8.2)\n   15|Active     |    1|OPS4J Pax Logging - Log4j v2 (1.8.2)\n   16|Active     |    1|Apache XML Security for Java (2.0.1)", "id": 182635, "time": "2015-04-26T15:41:19Z", "creator": "bob@apache.org", "creation_time": "2015-04-26T15:41:19Z", "is_private": false, "attachment_id": null}, {"text": "Created attachment 32736\nPAX-EXAM Patch", "tags": [], "bug_id": 57857, "attachment_id": 32736, "count": 4, "id": 182988, "time": "2015-05-14T22:10:06Z", "creator": "bob@apache.org", "creation_time": "2015-05-14T22:10:06Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 57857, "attachment_id": null, "id": 182989, "time": "2015-05-14T22:17:26Z", "creator": "bob@apache.org", "creation_time": "2015-05-14T22:17:26Z", "is_private": false, "text": "Attached is a Patch that sets up a PAX-Exam test for the POI bundle project.  The setup is based on the servicemix project work to configure the optional imports but I tried to keep the exports as minimal as possible.  The tests pass for 3.11 but not 3.12-beta2 because it appears that the org.etsi.uri.x01903.v14 and org.etsi.uri.x01903.v14.impl packages have been removed from the poi-ooxml-schemas jar at 3.12-beta2.  Either these packages need to be removed from the poi jar or they need to be added back into the poi-ooxml-schemas jar."}, {"count": 6, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "id": 184673, "time": "2015-08-20T19:27:54Z", "bug_id": 57857, "creation_time": "2015-08-20T19:27:54Z", "is_private": false, "text": "*** Bug 53866 has been marked as a duplicate of this bug. ***"}, {"attachment_id": 34336, "tags": [], "creator": "kiwiwings@apache.org", "is_private": false, "count": 7, "id": 194232, "time": "2016-10-08T17:20:05Z", "bug_id": 57857, "creation_time": "2016-10-08T17:20:05Z", "text": "Created attachment 34336\nServiceMix patch\n\nThis is a preliminary patch for Apache ServiceMix (i.e not for POI itself), which still needs to be tweaked when POI 3.16 comes out, which contains the fix for #60226\n\nThe tweak might contain additions like ...\n- org.apache.xml.security.signature;resolution:=optional,\n\n\nfyi - this is related to the SO issue [1]\n\n[1] http://stackoverflow.com/questions/38791416/apache-poi-felix-xslf-table-is-empty"}]