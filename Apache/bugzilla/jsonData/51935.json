[{"count": 0, "attachment_id": 27655, "bug_id": 51935, "is_private": false, "id": 150012, "time": "2011-10-01T11:54:46Z", "creator": "aperri@operamail.com", "creation_time": "2011-10-01T11:54:46Z", "tags": [], "text": "Created attachment 27655\nYou will notice from the PDF snap that the Apache FOP places a break between \"2.1.1 Bay: BFO and its accompanying image\n\nApache FOP does not properly handle the <xsl:attribute name=\"keep-with-next.within-page\">always</xsl:attribute> and <xsl:attribute name=\"keep-together.within-page\">always</xsl:attribute> options in basic blocks."}, {"count": 1, "tags": [], "bug_id": 51935, "text": "please rewrite bug report in terms of XSL-FO (not XSLT), provide an FO input file and a PDF output file exhibiting problem\n\nalso, see http://xmlgraphics.apache.org/fop/compliance.html#fo-property-keep-with-next", "id": 150017, "time": "2011-10-01T13:56:12Z", "creator": "gadams@apache.org", "creation_time": "2011-10-01T13:56:12Z", "is_private": false, "attachment_id": null}, {"attachment_id": 27859, "tags": [], "bug_id": 51935, "is_private": false, "count": 2, "id": 150989, "time": "2011-10-28T06:16:49Z", "creator": "aperri@operamail.com", "creation_time": "2011-10-28T06:16:49Z", "text": "Created attachment 27859\nzip file containing riddle.fo and riddle.pdf file\n\nApache FOP does not properly handle the <xsl:attribute\nname=\"keep-with-next.within-page\">always</xsl:attribute> and <xsl:attribute\nname=\"keep-together.within-page\">always</xsl:attribute> options in basic\nblocks.\n\nYou will notice from the PDF snap that the Apache FOP places a break between\n2.1.1. Bay: 25 and its accompanying image. (To get to this section in the PDF expand Section 2. Substation Riddle Section 2.1. Voltage level: D).\n\nI have compared Apache FOP (Vrsn: fop-1.0) with RenderX XEP (Vrsn: xep-4.19-20110414) XSL-FO using processors using XMLmind XSL Utility (Vrsn: 4.5.0-01) to render DITA Files into PDF format. The Apache FOP does not properly handle the <xsl:attribute name=\"keep-with-next.within-page\">always</xsl:attribute> option."}, {"count": 3, "tags": [], "bug_id": 51935, "text": "(In reply to comment #2)\n> Created attachment 27859 [details]\n> zip file containing riddle.fo and riddle.pdf file\n> \n> Apache FOP does not properly handle the <xsl:attribute\n> name=\"keep-with-next.within-page\">always</xsl:attribute> and <xsl:attribute\n> name=\"keep-together.within-page\">always</xsl:attribute> options in basic\n> blocks.\n> \n> You will notice from the PDF snap that the Apache FOP places a break between\n> 2.1.1. Bay: 25 and its accompanying image. (To get to this section in the PDF\n> expand Section 2. Substation Riddle Section 2.1. Voltage level: D).\n> \n> I have compared Apache FOP (Vrsn: fop-1.0) with RenderX XEP (Vrsn:\n> xep-4.19-20110414) XSL-FO using processors using XMLmind XSL Utility (Vrsn:\n> 4.5.0-01) to render DITA Files into PDF format. The Apache FOP does not\n> properly handle the <xsl:attribute\n> name=\"keep-with-next.within-page\">always</xsl:attribute> option.\n\nYour description of the problem remains in the XSLT domain, not XSL-FO.\n\nThere is no such thing as <xsl:attribute name=\"keep-with-next.within-page\">always</xsl:attribute> in XSL-FO.\n\nIn XSL-FO, this is a property on an FO object, e.g.,\n\n<fo:block keep-with-next.within-page=\"always\">...</fo:block>\n\nAlso, I would advise you to try to narrow down the problem to the smallest XSL-FO input that reproduces the problem. It is difficult to have to wade through the 1MB riddle.fo file to look for the problem area, which I see is contained in the following XSL-FO fragment:\n\n<fo:block space-before.optimum=\"1.5em\" space-before.minimum=\"1.2em\" space-before.maximum=\"1.8em\" space-after.optimum=\"0.75em\" space-after.minimum=\"0.6em\" space-after.maximum=\"0.9em\" hyphenate=\"false\" font-family=\"sans-serif\" font-weight=\"bold\" text-align=\"left\" keep-with-next.within-column=\"always\" font-size=\"140%\" padding-bottom=\"0.05em\" border-bottom=\"0.6pt solid blue\" keep-with-next.within-page=\"always\">2.1.1. Bay: 25\n</fo:block>\n<fo:block space-before.optimum=\"0.75em\" space-before.minimum=\"0.6em\" space-before.maximum=\"0.9em\" space-after.optimum=\"0.75em\" space-after.minimum=\"0.6em\" space-after.maximum=\"0.9em\">\n  <fo:block space-before.optimum=\"0.75em\" space-before.minimum=\"0.6em\" space-before.maximum=\"0.9em\" space-after.optimum=\"0.75em\" space-after.minimum=\"0.6em\" space-after.maximum=\"0.9em\" id=\"_4WuGAAEqEeG8i4jXCiAfTQ__I_io3oa_\">\n    <fo:block space-before.optimum=\"0.75em\" space-before.minimum=\"0.6em\" space-before.maximum=\"0.9em\" space-after.optimum=\"0.75em\" space-after.minimum=\"0.6em\" space-after.maximum=\"0.9em\" hyphenate=\"false\" font-family=\"sans-serif\" font-weight=\"bold\" text-align=\"left\" keep-with-next.within-column=\"always\" font-size=\"120%\"/>\n    <fo:block space-before.optimum=\"1.5em\" space-before.minimum=\"1em\" space-before.maximum=\"2em\"\nspace-after.optimum=\"1.5em\" space-after.minimum=\"1em\" space-after.maximum=\"2em\" id=\"_4WuGAAEqEeG8i4jXCiAfTQ__I_d16yk_\">\n      <fo:block border-before-width.conditionality=\"discard\" border-after-width.conditionality=\"discard\">\n        <fo:block space-before.optimum=\"0.75em\" space-before.minimum=\"0.6em\" space-before.maximum=\"0.9em\" space-after.optimum=\"0.75em\" space-after.minimum=\"0.6em\" space-after.maximum=\"0.9em\" font-size=\"110%\" text-indent=\"1em\"/>\n        <fo:block text-align=\"center\">\n          <fo:external-graphic src=\"url(file:/C:/helinks/workspace/workspaces/r2be/build.com.helinks.sts/workspaces/riddle/Report/items/Ridde_D_25_fun.png)\" content-width=\"247px\"/>\n        </fo:block>\n      </fo:block>\n      <fo:block hyphenate=\"false\" font-style=\"italic\" space-before.optimum=\"0.5em\" space-before.minimum=\"0.4em\" space-before.maximum=\"0.6em\" space-after.optimum=\"0.5em\" space-after.minimum=\"0.4em\" space-after.maximum=\"0.6em\" text-align=\"left\" keep-with-previous.within-column=\"always\">Figure 2. Function Diagram of Ridde/D/25</fo:block>\n    </fo:block>\n  </fo:block>\n</fo:block>\n</fo:block>\n\nFor example, if you started with the above fragment, then removed as much extraneous material that still exhibits the problem, then you would have reduced it to a manageable level.\n\nFinally, note that there is already a test for keep-with-next.within-page=\"always\" in the FOP test suite (I will attach an edited version of this test to this bug report which you can use as a template). Perhaps you could verify this yourself and then modify this using your minimal data to try to reproduce your problem.", "id": 150991, "time": "2011-10-28T07:02:40Z", "creator": "gadams@apache.org", "creation_time": "2011-10-28T07:02:40Z", "is_private": false, "attachment_id": null}, {"count": 4, "attachment_id": 27860, "bug_id": 51935, "is_private": false, "id": 150992, "time": "2011-10-28T07:06:47Z", "creator": "gadams@apache.org", "creation_time": "2011-10-28T07:06:47Z", "tags": [], "text": "Created attachment 27860\ncurrent FO test content for keep-with-next.within-page on fo:block\n\nSee comment 3."}, {"count": 5, "tags": [], "bug_id": 51935, "text": "Created attachment 27864\n\"keep-with-next-problem.zip\" containing files to examine \"keep-with-next\" problem\n\nHi Glenn,\n\n  i have created a new project to run tests against the keep-with-next.within-page=\"always\" property on an FO object.\n\nThe XSL-FO for the project is included in the \"keep-with-next-problem.zip\" called \"mytest.fo\".\n\nTo help narrow down the <fo:block keep-with-next.within-page=\"always\">...</fo:block> where i believe there is a problem i have extracted from the\" mytest.fo\" file, with my limited knowledge about Appache FOP, as well as i could two places where the problem occurs.\n\nThese blocks i have saved to the files \"keep-with-next-problem1.fo\" and \"keep-with-next-problem1.fo\". These files are also included in the  \"keep-with-next-problem.zip\" file.\n\nIn mytest.pdf file the \"keep-with-next\" problem can be viewed in two locations. The first location 1.1. MySubstaion SLD Diagram. The second location is where 2.1.1. Bay: Bay1. In both places you will see that the section heading is segregated from its image.\n\nAccording to the \"Keeps and Breaks Properties\" in the W3C XSL-FO 1.1 standard compliance table my understanding of the \"keep-with-next\" property is that it supposed to keep both the section heading and image together providing that the implemented block-level FOs are not inline-level FOs or integer specified. I have run my tests with the \"keep-together\" property and this does not seem to be the case.\n\nTo get a real sense of how the \"keep-with-next\" and \"keep-together\" i have run my tests against RenderX XEP (Vrsn: xep-4.19-20110414) XSL-FO and sure enough both the section heading and image together are keep together.\n\nDespite the fact that you have created a wonderful template where i can insert the problematic blocks to be run against the \"keep-with-next.within-page=\"always\" test case\" I am not experienced enough to know how to do this yet, and if so doing whether or not i am doing it right to determine whether indeed there is a problem.\n\nPlease let me know if the information and files i have included in this report is sufficient for you to examine this matter.\n\nRegards,\nAlberto Perri", "id": 151027, "time": "2011-10-29T08:17:36Z", "creator": "aperri@operamail.com", "creation_time": "2011-10-29T08:17:36Z", "is_private": false, "attachment_id": 27864}, {"count": 6, "tags": [], "text": "For additional comments see \"keep-with-next-problem.zip\" containing files to examine \"keep-with-next\" problem Details", "is_private": false, "id": 151028, "creator": "aperri@operamail.com", "time": "2011-10-29T08:20:44Z", "bug_id": 51935, "creation_time": "2011-10-29T08:20:44Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "gadams@apache.org", "text": "resetting P2 open bugs to P3 pending further review", "count": 7, "id": 157514, "time": "2012-04-07T01:44:05Z", "bug_id": 51935, "creation_time": "2012-04-07T01:44:05Z", "is_private": false}, {"count": 8, "tags": [], "text": "i'm afraid i need to ask you to work harder to provide a \"maximally minimal\" but *complete* input FO test file and corresponding output PDF file that demonstrates the problem (along with any external graphics that are referenced by this maximally minimal FO file)\n\nthe two keep-with-next-problem* files are (1) not complete FO files, and (2) not maximally minimal;\n\nby maximally minimal, I mean you should remove all constructs of the FO file until you are able to remove nothing else while still demonstrating the problem", "is_private": false, "id": 157722, "creator": "gadams@apache.org", "time": "2012-04-09T07:46:35Z", "bug_id": 51935, "creation_time": "2012-04-09T07:46:35Z", "attachment_id": null}, {"count": 9, "attachment_id": null, "bug_id": 51935, "is_private": false, "id": 158157, "time": "2012-04-18T07:32:16Z", "creator": "aperri@operamail.com", "creation_time": "2012-04-18T07:32:16Z", "tags": [], "text": "Dear Apache Team,\n\n  i am not an xml expert so please excuse me if i am using the XML terminology incorrectly. \n\n  What i reported now several months ago is not a bug but a great misunderstanding on my part. When using the keep-together or keep-with-next FO Attributes it is important to know which elements you want to keep together. There must be at least two different elements/blocks that have this attribute. My experience is that if this is not specified nothing will happen. I realized this when at the request of Glenn Adams i went about butting together a \"maximally minimal\" but *complete* input FO test file and corresponding output PDF file that\ndemonstrates the problem (along with any external graphics that are referenced\nby this maximally minimal FO file)."}, {"count": 10, "tags": [], "text": "Dear Apache Team,\n\n  i am not an xml expert so please excuse me if i am using the XML terminology incorrectly. \n\n  What i reported now several months ago is not a bug but a great misunderstanding on my part. When using the keep-together or keep-with-next FO Attributes it is important to know which elements you want to keep together. There must be at least two different elements/blocks that have this attribute. My experience is that if this is not specified nothing will happen. I realized this when at the request of Glenn Adams i went about butting together a \"maximally minimal\" but *complete* input FO test file and corresponding output PDF file that\ndemonstrates the problem (along with any external graphics that are referenced\nby this maximally minimal FO file).  \n\nPlease find in the RiddleTest.rar file the files Riddle.fo, Riddle.png, RiddleSysteDiagram.png and Riddle.pdf that demonstrate that the keep-together attribute does indeed work.", "is_private": false, "id": 158158, "creator": "aperri@operamail.com", "time": "2012-04-18T07:41:36Z", "bug_id": 51935, "creation_time": "2012-04-18T07:41:36Z", "attachment_id": null}, {"count": 11, "attachment_id": 28634, "bug_id": 51935, "is_private": false, "id": 158162, "time": "2012-04-18T08:01:09Z", "creator": "aperri@operamail.com", "creation_time": "2012-04-18T08:01:09Z", "tags": [], "text": "Created attachment 28634\nkeep-together attribute used correctly"}, {"count": 12, "tags": [], "creator": "gadams@apache.org", "attachment_id": null, "text": "per reporter, the problem was the user's misunderstanding rather than a behavior or feature problem", "id": 158185, "time": "2012-04-18T22:52:23Z", "bug_id": 51935, "creation_time": "2012-04-18T22:52:23Z", "is_private": false}, {"count": 13, "tags": [], "bug_id": 51935, "is_private": false, "text": "batch transition resolved+wontfix to closed+wontfix", "id": 158578, "time": "2012-04-30T00:14:58Z", "creator": "gadams@apache.org", "creation_time": "2012-04-30T00:14:58Z", "attachment_id": null}, {"count": 14, "tags": [], "bug_id": 51935, "is_private": false, "text": "batch transition resolved+wontfix to closed+wontfix; if you believe this remains a bug and can demonstrate it with appropriate input FO file and output PDF file (as applicable), then you may reopen", "id": 158623, "time": "2012-04-30T00:17:23Z", "creator": "gadams@apache.org", "creation_time": "2012-04-30T00:17:23Z", "attachment_id": null}]