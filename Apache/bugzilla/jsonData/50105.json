[{"count": 0, "tags": [], "creator": "oliver@siegmar.de", "attachment_id": null, "text": "Section 1.18.2 of the 2.1 JSP-EL spec (Coerce A to String) says \"if A is Enum, return A.name()\". This is not always the case in Tomcat 6.0.29. To demonstrate the bug, I created some custom code (enum, Tag, JSP):\n\nTag:\n\npublic class MyCustomTag implements Tag {\n    public void setValue(String value) {\n        System.out.println(value);\n    }\n    @Override public void setPageContext(PageContext pc) {}\n    @Override public void setParent(Tag t) {}\n    @Override public Tag getParent() { return null; }\n    @Override public int doStartTag() throws JspException { return SKIP_BODY; }\n    @Override public int doEndTag() throws JspException { return EVAL_PAGE; }\n    @Override public void release() {}\n}\n\nTLD:\n\n<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n<taglib xsi:schemaLocation=\"http://java.sun.com/xml/ns/javaeeweb-\njsptaglibrary_2_1.xsd\" xmlns=\"http://java.sun.com/xml/ns/javaee\" \nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" version=\"2.1\">\n    <tlibversion>1.0</tlibversion>\n    <uri>http://my-domain.org/customLib</uri>\n    <tag>\n        <name>customTag</name>\n        <tagclass>mypackage.MyCustomTag</tagclass>\n        <bodycontent>empty</bodycontent>\n        <attribute>\n            <name>value</name>\n            <required>true</required>\n            <rtexprvalue>true</rtexprvalue>\n        </attribute>\n    </tag>\n</taglib>\n\nEnum:\n\npublic enum MyEnum {\n\n    APPLE, ORANGE;\n\n    @Override\n    public String toString() {\n        return \"this is a \" + name();\n    }\n\n}\n\nJSP:\n\n<%@taglib prefix=\"myLib\" uri=\"http://my-domain.org/customLib\"%>\n\n<myLib:customTag value=\"${myEnum}\"/>\n<myLib:customTag value=\"foo.${myEnum}.bar\"/>\n\nBecause the value myEnum is was set to MyEnum.ORANGE, i would expect, that this outputs:\n\nORANGE\nfoo.ORANGE.bar\n\nBut the output in catalina.out instead is:\n\nORANGE\nfoo.this is a ORANGE.bar\n\n\nWhich is a violation of the JSP-EL spec (if I understood it right).", "id": 140785, "time": "2010-10-17T05:26:20Z", "bug_id": 50105, "creation_time": "2010-10-17T05:26:20Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 50105, "attachment_id": null, "id": 140820, "time": "2010-10-19T09:06:18Z", "creator": "markt@apache.org", "creation_time": "2010-10-19T09:06:18Z", "is_private": false, "text": "You understood it right.\n\nI have fixed this in trunk which will be included in 7.0.5 onwards. I have also proposed the same fix for 6.0.x."}, {"count": 2, "tags": [], "bug_id": 50105, "attachment_id": null, "id": 141004, "time": "2010-10-25T12:03:37Z", "creator": "markt@apache.org", "creation_time": "2010-10-25T12:03:37Z", "is_private": false, "text": "This has been fixed in 6.0.x and will be included in 6.0.30 onwards."}]