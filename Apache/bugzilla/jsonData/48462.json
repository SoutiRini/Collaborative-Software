[{"count": 0, "tags": [], "creator": "liangyue_829@163.com", "text": "Created attachment 24773\na jpeg describes the usage of namebox for the relationship between single cell and a range name\n\nExcel Name Box could not display the range name corresponding to the singlecell after create/change the range name using POI.\n\nBelow is the codes:\n\nInputStream inp = new FileInputStream(\"testRF.xls\");\nHSSFWorkbook wb = new HSSFWorkbook(inp);\nHSSFName name = wb.getNameAt(wb.getNameIndex(\"testCell\"));\n\nCellReference reference = new CellReference(\"Sheet1!A2\");\nname.setReference(reference.formatAsString());\n\nFile file = new File(\"output_testRF.xls\");\nif(file.exists())\n\tfile.delete();\nFileOutputStream fileOut = new FileOutputStream(\"output_testRF.xls\");\nwb.write(fileOut);\nfileOut.close();", "id": 133198, "time": "2009-12-30T02:15:44Z", "bug_id": 48462, "creation_time": "2009-12-30T02:15:44Z", "is_private": false, "attachment_id": 24773}, {"count": 1, "tags": [], "bug_id": 48462, "attachment_id": 24774, "text": "Created attachment 24774\nsource excel file", "id": 133199, "time": "2009-12-30T02:17:23Z", "creator": "liangyue_829@163.com", "creation_time": "2009-12-30T02:17:23Z", "is_private": false}, {"count": 2, "attachment_id": 24775, "bug_id": 48462, "is_private": false, "id": 133200, "time": "2009-12-30T02:17:52Z", "creator": "liangyue_829@163.com", "creation_time": "2009-12-30T02:17:52Z", "tags": [], "text": "Created attachment 24775\nPOI output excel file"}, {"count": 3, "tags": [], "bug_id": 48462, "attachment_id": null, "text": "I can observe the funny behaviour you describe, but I think it is actually part of normal Excel functionality.  The anomaly seems to arise from using relative coordinates in the cell reference (i.e. missing '$').  You can achieve the same affect by setting the  'Refers To' property in the 'Name Manager' dialog to the same value as you did in the java example.  When 'navigating' to a defined name by using the 'Name Box', different behaviour is observed depending on whether the coordinates are absolute or relative.\n\nThe simple fix is to use absolute coordinates in your cell reference.  For example: \"Sheet1!$A$2\"\n\nBTW - you should replace uses of the method HSSFName.setReference() to HSSFName.setRefersToFormula(), as the old method will not be available in future POI versions.", "id": 133255, "time": "2009-12-31T13:27:59Z", "creator": "josh@apache.org", "creation_time": "2009-12-31T13:27:59Z", "is_private": false}, {"count": 4, "attachment_id": null, "bug_id": 48462, "is_private": false, "id": 133289, "time": "2010-01-03T22:20:19Z", "creator": "liangyue_829@163.com", "creation_time": "2010-01-03T22:20:19Z", "tags": [], "text": "Thanks Josh.\n\nI just find using \"Sheet1!$A$2\" is working well on POI 3.5 for my requirement, but still not work for POI 3.2 Final. this might be something like a POI bug fix or enhancement after 3.2 final release. \n\nHowever I am still using POI 3.2 for my work, I can't find the corresponding bug or change list for this feature by searching in Bugzilla, could you please attach it here if you could find it? Thanks! \n\nBTW, I didn't have a chance to look at the way to use Retroweaver(you told me this in Bug 46547) to convert the latest POI release to run\non a 1.4 JRE yet, but I'll definitely try it later. Thanks again for your helps.\n\nSorry I have to put this bug to REOPENED to ensure it could be copied to you."}, {"count": 5, "tags": [], "bug_id": 48462, "text": "The problem is fixed in POI 3.5+ and I don't see why this ticket should stay open.\n\nYegor", "id": 147492, "time": "2011-06-25T12:41:28Z", "creator": "yegor@dinom.ru", "creation_time": "2011-06-25T12:41:28Z", "is_private": false, "attachment_id": null}]