[{"count": 0, "tags": [], "bug_id": 54277, "attachment_id": null, "is_private": false, "id": 164018, "time": "2012-12-11T07:01:49Z", "creator": "psfung@clustertech.com", "creation_time": "2012-12-11T07:01:49Z", "text": "When 2 filters are registered through Servlet 3.0 API,\n\nservletContext.addFilter(\"A\", filterA)\n    .addMappingForUrlPatterns(null, false, \"*.jsp\");\n        \nservletContext.addFilter(\"B\", filterB)\n    .addMappingForUrlPatterns(null, false, \"*.jsp\");\n\nFilter B should come before A in the chain, according to the API spec of 2nd bool param isMatchAfter. In Tomcat 7.0.33, the actual order is reversed. I've also tested in Jetty 8.1.8, the order is consistent with the spec."}, {"count": 1, "tags": [], "text": "There was a change due to bug 53758. Did it break?\nr1377536\n\nIt needs a testcase (there seems to be no testcase for bug 53758 in Tomcat sources either).", "is_private": false, "id": 164019, "creator": "knst.kolinko@gmail.com", "time": "2012-12-11T07:29:21Z", "bug_id": 54277, "creation_time": "2012-12-11T07:29:21Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 54277, "attachment_id": null, "is_private": false, "id": 164020, "time": "2012-12-11T07:57:18Z", "creator": "psfung@clustertech.com", "creation_time": "2012-12-11T07:57:18Z", "text": "The fix to bug 53758 is correct for registering 1 filter, but there is still problem when registering more.\n\ninterface org.apache.catalina.Context {\n\n/*Add a filter mapping to this Context before the mappings defined in the deployment descriptor but after any other mappings added via this method.*/\npublic void addFilterMapBefore(FilterMap filterMap);\n\n}\n\nBut the Servlet spec says\n\"... to be matched before any declared filter mappings of the ServletContext...\""}, {"count": 3, "tags": [], "bug_id": 54277, "attachment_id": null, "id": 164021, "time": "2012-12-11T09:13:08Z", "creator": "markt@apache.org", "creation_time": "2012-12-11T09:13:08Z", "is_private": false, "text": "You need to read the all of the Javadoc for FilterRegistration.Dynamic#addMappingForUrlPatterns(), not just some of it.\n\n1. <quote>Filter mappings are matched in the order in which they were added.</quote>\n\n2. A declared filter mapping is one that is not created programmatically. i.e. a declared filter is one defined in web.xml, web-fragment.xml or via annotations."}, {"count": 4, "tags": [], "text": "FYI posted in Jetty Bugzilla\nhttps://bugs.eclipse.org/bugs/show_bug.cgi?id=396253", "is_private": false, "id": 164022, "creator": "psfung@clustertech.com", "time": "2012-12-11T10:01:03Z", "bug_id": 54277, "creation_time": "2012-12-11T10:01:03Z", "attachment_id": null}]