[{"count": 0, "tags": [], "creator": "ayu168@gmail.com", "attachment_id": null, "is_private": false, "id": 64057, "time": "2004-09-22T16:11:55Z", "bug_id": 31366, "creation_time": "2004-09-22T16:11:55Z", "text": "Apache 2.0.51 running on a Windows Server 2003 machine.\n\nIn Apache Service Monitor, two crash windows appear after the log displays \"The\nApache2 service is stopping.\"\n\nFaulting application Apache.exe, version 2.0.51.0, faulting module libapr.dll,\nversion 0.0.0.0, fault address 0x00004ae0.\n\nFaulting application Apache.exe, version 2.0.51.0, faulting module libapr.dll,\nversion 0.0.0.0, fault address 0x00004ae0.\n\nNo problem starting the servie.  Only sees this problem when these two modules\nare loaded.\n\nLoadModule ldap_module modules/util_ldap.so\nLoadModule auth_ldap_module modules/mod_auth_ldap.so"}, {"count": 1, "tags": [], "text": "Can you check if this problem still appears in either v2.0.52 or the latest\nsnapshot?\n\nThere have been some fixes which have affected crashes on shutdown.\n", "is_private": false, "bug_id": 31366, "id": 65250, "time": "2004-10-17T18:51:09Z", "creator": "minfrin@apache.org", "creation_time": "2004-10-17T18:51:09Z", "attachment_id": null}, {"count": 2, "tags": [], "text": "I have the same problem with v2.0.52 running on Windows XP Professional with\nService Pack 2. The problem is exactly the same as described earlier that the\ndll will report a application fault when attempt to shutdown the Apache2 web\nservice.", "is_private": false, "bug_id": 31366, "id": 65317, "time": "2004-10-19T14:56:14Z", "creator": "zerox@singnet.com.sg", "creation_time": "2004-10-19T14:56:14Z", "attachment_id": null}, {"count": 3, "tags": [], "text": "I am having the same symptoms.  I am runnging Win2K3 with Apache 2.0.52.\nThe problem occurs with both a precompiled and complied version of Apache.\nI have mod_auth_ldap and util_ldap modules loaded.  The have tired compiling \nwith and without the 2.0.52 \"util_ldap_cache_mgr.c.patch\".\n\nIf LDAPSharedCacheSize is set to 0 (disable caching) I can successfully stop \nthe Apache service.  If is set at the default of 102400 (enable caching) the \nlibapr.dll crashes twice as reported by otheres.\n\nAuthentication works with and without the cache enabled.  The service just will \nnot stop or restart without the libapr.dll crashes.\n\nI don't know what else to try.", "is_private": false, "bug_id": 31366, "id": 65381, "time": "2004-10-20T20:14:35Z", "creator": "rollettj@uww.edu", "creation_time": "2004-10-20T20:14:35Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "rollettj@uww.edu", "attachment_id": null, "id": 65429, "time": "2004-10-21T12:10:59Z", "bug_id": 31366, "creation_time": "2004-10-21T12:10:59Z", "is_private": false, "text": "I have been able to reproduce this bug on two different servers.  I have tried \nusing the LDAPSharedCacheFile directive to specify a file.  LDAP functions \nnormally using memory or a file for caching but the libapr.dll still crashes \ntwice when the Apache service stops.  I am currently running with caching \ndisabled on two servers while I try to resolve this.  While LDAP caching works \nfine, the danger is that should some other excpetion trigger the Apache \nservice to restart, the service will be down.\n\nCan any anyone else verify that disabling caching is a workaround for this bug?"}, {"count": 5, "tags": [], "text": "i have the same problem at Win2K3 with Apache 2.0.52. with a normal precompiled .msi\n\nto reproduce the crash i only had to change in httpd.conf:\n\nLoadModule ldap_module modules/util_ldap.so \nLDAPSharedCacheSize 1000000\n\nand without caching (LDAPSharedCacheSize 0) it seems to work, but its very very\nslow (i use svn with authn_ldap) so i decided to leave the cach working and i\nhope that someone fixes the bug ;-)", "is_private": false, "bug_id": 31366, "id": 68591, "time": "2004-12-15T22:16:58Z", "creator": "bn4@inf.tu-dresden.de", "creation_time": "2004-12-15T22:16:58Z", "attachment_id": null}, {"count": 6, "tags": [], "text": "Can you test for me whether this bug exists in the latest version of httpd v2.1?\n\nThe code in httpd v2.0 is impractical to fix without major changes to APR v0.9,\nso the focus has instead shifted to make httpd v2.1 work with APR v1.1 or later.", "is_private": false, "bug_id": 31366, "id": 69943, "time": "2005-01-21T22:32:32Z", "creator": "minfrin@apache.org", "creation_time": "2005-01-21T22:32:32Z", "attachment_id": null}, {"count": 7, "tags": [], "text": "Looking for feedback from the reporter.", "is_private": false, "bug_id": 31366, "id": 75884, "time": "2005-06-03T01:50:28Z", "creator": "chip@force-elite.com", "creation_time": "2005-06-03T01:50:28Z", "attachment_id": null}, {"count": 8, "tags": [], "text": "\n  There were many LDAP cache bugs in Apache 2.0.53 and prior, I'd strongly\n  suggest you upgrade to Apache 2.0.55 once it becomes available.\n\n  If your LDAP server is sitting on the same local LAN, you are much better\n  off simply turning off the LDAP cache.  I even suspect that wldap32 (the\n  Microsoft LDAP client) has some internal caching, making the Apache\n  cache redundant.\n\n  In Apache 2.1 this code has been nearly completely refactored, and is much,\n  much cleaner.  That's why ldap is experimental in 2.0, and will be supported\n  (release quality) in Apache 2.2.\n", "is_private": false, "bug_id": 31366, "id": 79565, "time": "2005-09-07T18:06:55Z", "creator": "wrowe@apache.org", "creation_time": "2005-09-07T18:06:55Z", "attachment_id": null}, {"count": 9, "tags": [], "text": "This buf is still actual for 2.0.55\nI think I've fixed it.\n\nIt's util_ldap_cache.c:util_ldap_cache_module_kill()\n...\nif (st->cache_shm != NULL) {\n   apr_status_t result = apr_shm_destroy(st->cache_shm);\n       st->cache_shm = NULL;\n       apr_file_remove(st->cache_file, st->pool);\n\nIt should be checked either we do have cache file befor attempt to delete it.\nBecause initially it is NULL and it remains null unless\nLDAPSharedCacheFile is set in config. And if shared memory has been\ninitialized it does not mean that file has been created.\nThis bug appears only on Win because Win attempts to recode the string\n(file name) to Unicode and null reference fails in this function.\n\nThis works for me:\nif (st->cache_shm != NULL) {\n   apr_status_t result = apr_shm_destroy(st->cache_shm);\n       st->cache_shm = NULL;\n       if(st->cache_file != NULL) {\n           apr_file_remove(st->cache_file, st->pool);\n               st->cache_file = NULL;\n\n\nThis works for the situation when there is no LDAPSharedCacheFile\nattribute in config.\nBut when there is one, it still crashes. I'm looking ito it. There is something\nwrong with releasing nodes.", "is_private": false, "bug_id": 31366, "id": 81575, "time": "2005-10-23T01:32:04Z", "creator": "kot.begemot@gmail.com", "creation_time": "2005-10-23T01:32:04Z", "attachment_id": null}, {"count": 10, "tags": [], "creator": "mike_mcangus@wendys.com", "attachment_id": null, "id": 82369, "time": "2005-11-10T20:59:18Z", "bug_id": 31366, "creation_time": "2005-11-10T20:59:18Z", "is_private": false, "text": "This error still occurs while using:\n    Apache 2.0.55 - apache_2.0.55-win32-x86-no_ssl.msi binary installation\n    SunONE Directory Server v5.1 SP2 \n    Windows XP Professional SP2\n    Windows 2003 Standard Server SP1\n\nWindows Event Message (both OSs):\n    Faulting application Apache.exe, version 2.0.55.0, faulting module \n    libapr.dll, version 0.9.7.0, fault address 0x00004902.\n\nThis message occurs twice in the Event log for each shutdown event, approx 5\nseconds between the two messages.\n\nI do not have any of the LDAP Cache directives set in the httpd.conf file.  The\nApache2 error.log contains the following (timestamps removed) for one\nstartup/shutdown cycle:\n    [notice] LDAP: Built with Microsoft LDAP SDK\n    [notice] LDAP: SSL support available\n    [notice] Apache/2.0.55 (Win32) configured -- resuming normal operations\n    [notice] Server built: Oct  9 2005 19:16:56\n    [notice] Parent: Created child process 3392\n    [notice] LDAP: Built with Microsoft LDAP SDK\n    [notice] LDAP: SSL support available\n    [notice] Child 3392: Child process is running\n    [notice] Child 3392: Acquired the start mutex.\n    [notice] Child 3392: Starting 250 worker threads.\n    [notice] Parent: Received shutdown signal -- Shutting down the server.\n    [notice] Child 3392: Exit event signaled. Child process is ending.\n    [notice] Child 3392: Released the start mutex\n    [notice] Child 3392: Waiting for 250 worker threads to exit.\n    [notice] Child 3392: All worker threads have exited.\n    [notice] Child 3392: Child process is exiting\n    [notice] Parent: Child process exited successfully."}, {"count": 11, "tags": [], "creator": "photto35@yahoo.com", "attachment_id": null, "id": 88041, "time": "2006-04-14T10:10:33Z", "bug_id": 31366, "creation_time": "2006-04-14T10:10:33Z", "is_private": false, "text": "This is still in 2.2.0\n\nLast month i had it on W Server2003, now i have it on W XP Sp2.\n\nhttp://www.otto.net/img/failure.gif\n\nFixes in the httpd.conf didnt help me.. \n\nSo.. is there a solution or workaround..? "}, {"count": 12, "tags": [], "text": "(In reply to comment #11)\n> This is still in 2.2.0\n> Last month i had it on W Server2003, now i have it on W XP Sp2.\n> http://www.otto.net/img/failure.gif\n> Fixes in the httpd.conf didnt help me.. \n> So.. is there a solution or workaround..? \n\n[Edit] Sorry it's :\nhttp://www.otto2.net/img/failure.gif\n\n\n", "is_private": false, "bug_id": 31366, "id": 88042, "time": "2006-04-14T10:13:55Z", "creator": "photto35@yahoo.com", "creation_time": "2006-04-14T10:13:55Z", "attachment_id": null}, {"count": 13, "tags": [], "bug_id": 31366, "attachment_id": null, "text": "Obtaining and Unpacking into the installed program files\\apache group\\apache2\ndirectory the corresponding -symbols.zip file for your installed Apache version\nfrom;\n\nhttp://archive.apache.org/dist/httpd/binaries/win32/symbols/\n\nand following directions about capturing the crash dump with dr. watson that are\nposted at\n\nhttp://httpd.apache.org/dev/debugging.html\n\nyou will greatly help isolate this error.  Providing specifics of how you\ninvoked ab would also help (command line options).\n\nPlease do this for httpd 2.2.9 when it is released in the coming week or so and\nreport back, there are a host of fixes applied to the sources and ldap support.", "id": 117410, "time": "2008-06-05T13:31:19Z", "creator": "wrowe@apache.org", "creation_time": "2008-06-05T13:31:19Z", "is_private": false}, {"count": 14, "tags": [], "creator": "trawick@apache.org", "attachment_id": null, "id": 161524, "time": "2012-08-20T00:01:47Z", "bug_id": 31366, "creation_time": "2012-08-20T00:01:47Z", "is_private": false, "text": "bug in NEEDINFO state for years...\n\nIf still reproducible with latest 2.2.x, follow the debugging instructions posted previously."}]