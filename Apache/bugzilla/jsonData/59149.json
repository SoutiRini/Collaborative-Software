[{"count": 0, "tags": [], "bug_id": 59149, "attachment_id": 33652, "id": 189292, "time": "2016-03-09T06:57:28Z", "creator": "balendra.pathak@gmail.com", "creation_time": "2016-03-09T06:57:28Z", "is_private": false, "text": "Created attachment 33652\nJMX file and data file been used is given as an attachment\n\nI am able to parse JSON without any issue while running same java code in eclipse .But same code on Bean Shell Post processor gives error in log.Below are data and log file given with sample code tried on both eclipse and Bean Shell post processor.\n\nJSON Data where parsing fails:\n\"streamProfiles\": [{\n        \n        \"mediaPlaylist\": \"#EXT-X-STREAM-INF:BANDWIDTH=565400,AVERAGE-BANDWIDTH=565400,CODECS=\\\"avc1.77.30,mp4a.40.2\\\",RESOLUTION=640x360\",\n        \"channels\": 0,\n        \"mime_type\": \"audio\\/x-mpegurl\",\n        \"host\": \"http:\\/\\/yahooios2-i.akamaihd.net\\/hls\\/live\\/224964\\/iosstream\\/esports_us_main_highprofile\\/master_514.m3u8\",\n    },  \n\n\nJmeter Log:\n2016/03/08 12:05:02 INFO  - jmeter.util.BeanShellTestElement: Error in my script Unexpected character (#) at position 0.\n\tat org.json.simple.parser.Yylex.yylex(Unknown Source)\n\tat org.json.simple.parser.JSONParser.nextToken(Unknown Source)\n\tat org.json.simple.parser.JSONParser.parse(Unknown Source)\n\tat org.json.simple.parser.JSONParser.parse(Unknown Source)\n\tat org.json.simple.parser.JSONParser.parse(Unknown Source)\n\tat sun.reflect.GeneratedMethodAccessor40.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat bsh.Reflect.invokeMethod(Reflect.java:134)\n\tat bsh.Reflect.invokeObjectMethod(Reflect.java:80)\n\tat bsh.Name.invokeMethod(Name.java:858)\n\tat bsh.BSHMethodInvocation.eval(BSHMethodInvocation.java:75)\n\tat bsh.BSHPrimaryExpression.eval(BSHPrimaryExpression.java:102)\n\tat bsh.BSHPrimaryExpression.eval(BSHPrimaryExpression.java:47)\n\tat bsh.BSHCastExpression.eval(BSHCastExpression.java:60)\n\tat bsh.BSHAssignment.eval(BSHAssignment.java:77)\n\tat bsh.BSHBlock.evalBlock(BSHBlock.java:130)\n\tat bsh.BSHBlock.eval(BSHBlock.java:80)\n\tat bsh.BSHBlock.eval(BSHBlock.java:46)\n\tat bsh.BSHTryStatement.eval(BSHTryStatement.java:86)\n\tat bsh.Interpreter.eval(Interpreter.java:645)\n\tat bsh.Interpreter.eval(Interpreter.java:739)\n\tat bsh.Interpreter.eval(Interpreter.java:728)\n\tat sun.reflect.GeneratedMethodAccessor35.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.jmeter.util.BeanShellInterpreter.bshInvoke(BeanShellInterpreter.java:170)\n\tat org.apache.jmeter.util.BeanShellInterpreter.eval(BeanShellInterpreter.java:197)\n\tat org.apache.jmeter.util.BeanShellTestElement.processFileOrScript(BeanShellTestElement.java:151)\n\tat org.apache.jmeter.extractor.BeanShellPostProcessor.process(BeanShellPostProcessor.java:64)\n\tat org.apache.jmeter.threads.JMeterThread.runPostProcessors(JMeterThread.java:750)\n\tat org.apache.jmeter.threads.JMeterThread.process_sampler(JMeterThread.java:452)\n\tat org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:261)\n\tat java.lang.Thread.run(Thread.java:745)\n\nAnother character which was creating issue while parsing:\n\n2016/03/08 11:34:09 INFO  - jmeter.util.BeanShellTestElement: Error in my script Unexpected character (\\) at position 1.\n\tat org.json.simple.parser.Yylex.yylex(Unknown Source)\n\tat org.json.simple.parser.JSONParser.nextToken(Unknown Source)\n\tat org.json.simple.parser.JSONParser.parse(Unknown Source)\n\tat org.json.simple.parser.JSONParser.parse(Unknown Source)\n\tat org.json.simple.parser.JSONParser.parse(Unknown Source)\n\tat sun.reflect.GeneratedMethodAccessor40.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat bsh.Reflect.invokeMethod(Reflect.java:134)\n\tat bsh.Reflect.invokeObjectMethod(Reflect.java:80)\n\tat bsh.Name.invokeMethod(Name.java:858)\n\tat bsh.BSHMethodInvocation.eval(BSHMethodInvocation.java:75)\n\tat bsh.BSHPrimaryExpression.eval(BSHPrimaryExpression.java:102)\n\tat bsh.BSHPrimaryExpression.eval(BSHPrimaryExpression.java:47)\n\tat bsh.BSHCastExpression.eval(BSHCastExpression.java:60)\n\tat bsh.BSHAssignment.eval(BSHAssignment.java:77)\n\tat bsh.BSHBlock.evalBlock(BSHBlock.java:130)\n\tat bsh.BSHBlock.eval(BSHBlock.java:80)\n\tat bsh.BSHBlock.eval(BSHBlock.java:46)\n\tat bsh.BSHTryStatement.eval(BSHTryStatement.java:86)\n\tat bsh.Interpreter.eval(Interpreter.java:645)\n\tat bsh.Interpreter.eval(Interpreter.java:739)\n\tat bsh.Interpreter.eval(Interpreter.java:728)\n\tat sun.reflect.GeneratedMethodAccessor35.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.jmeter.util.BeanShellInterpreter.bshInvoke(BeanShellInterpreter.java:170)\n\tat org.apache.jmeter.util.BeanShellInterpreter.eval(BeanShellInterpreter.java:197)\n\tat org.apache.jmeter.util.BeanShellTestElement.processFileOrScript(BeanShellTestElement.java:151)\n\tat org.apache.jmeter.extractor.BeanShellPostProcessor.process(BeanShellPostProcessor.java:64)\n\tat org.apache.jmeter.threads.JMeterThread.runPostProcessors(JMeterThread.java:750)\n\tat org.apache.jmeter.threads.JMeterThread.process_sampler(JMeterThread.java:452)\n\tat org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:261)\n\tat java.lang.Thread.run(Thread.java:745)\n\nTo Parse JSON Below jar been used:\njson-simple-1.1.jar\n\nand below is sample code:\nin Bean shell:\nimport org.json.simple.JSONObject;\nimport java.io.*;\nimport java.io.FileNotFoundException;\nimport java.io.FileReader;\nimport java.io.IOException;\n#String jsonString = prev.getResponseDataAsString();\n\nFileReader reader = new FileReader(\"/Users/balendrapathak/my-app/src/main/java/com/mycompany/app/json.txt\");\n\nlog.info(\"This is Output Data: \");\nJSONParser jsonParser = new JSONParser();\n\t\t\t\tJSONObject jsonobj = null;\n\t\ttry {\n\t\t\tjsonobj = (JSONObject) jsonParser.parse(reader);\n\t\t} catch (ParseException e) {\n\t\t\t// TODO Auto-generated catch block\n\t\t\tlog.info(\"Error in my script\", e);\n\t\t\te.printStackTrace();\n\t\t}\n\t\t//System.out.println(\"This is object :\"+jsonobj.toString());\n\t\tJSONObject obj= (JSONObject)jsonobj.get(\"query\");\n\t\tJSONObject obj1= (JSONObject)obj.get(\"results\");\n\t\tJSONArray objarr=(JSONArray) obj1.get(\"mediaObj\");\n\t\tfor(int i=0;i<objarr.size();i++){\n\t\t\t\n\t\t\t//System.out.println(\"Print all json oobject under mediaObj :\"+objarr.get(i).toString());\n\t\t\tJSONObject jsobj= (JSONObject) objarr.get(i);\n\t\t\tJSONArray ar=(JSONArray) jsobj.get(\"streamProfiles\");\n\t\t\tJSONObject obj3= (JSONObject)ar.get(0);\n\t\t\t//System.out.println(obj3.get(\"host\"));\n\t\t\tlog.info(\"This is host extracted Data: \"+host);\n\n\t\t\t}\n\t\t\nSame code in eclipse runs properly.\n\nPlease help to understand if this is an issue or I need to do some preprocessing before parsing."}, {"count": 1, "tags": [], "text": "The error message is:\n\n2016/03/08 12:05:02 INFO  - jmeter.util.BeanShellTestElement: Error in my script Unexpected character (#) at position 0.\n\n\nThe BeanShell script contains:\n\n.\n.\nimport java.io.IOException;\n#String jsonString = prev.getResponseDataAsString();", "attachment_id": null, "id": 189294, "creator": "sebb@apache.org", "time": "2016-03-09T10:19:35Z", "bug_id": 59149, "creation_time": "2016-03-09T10:19:35Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 59149, "attachment_id": null, "id": 189312, "time": "2016-03-09T16:53:00Z", "creator": "balendra.pathak@gmail.com", "creation_time": "2016-03-09T16:53:00Z", "is_private": false, "text": "I think that was mistakenly left out # in script itself but its not able to parse JSON .\n\nThe real Bean shell code:\n\nimport org.json.simple.JSONArray;\nimport org.json.simple.JSONObject;\nimport org.json.simple.parser.JSONParser;\nimport org.json.simple.parser.ParseException;\nimport java.lang.String;\nimport java.util.*;\nimport java.lang.Integer;\nimport org.json.simple.JSONObject;\nimport java.io.*;\nimport java.io.FileNotFoundException;\nimport java.io.FileReader;\nimport java.io.IOException;\nString jsonString = prev.getResponseDataAsString();\n\n\n\nlog.info(\"This is Output Data: \"+jsonString);\nJSONParser jsonParser = new JSONParser();\n\t\t\t\tJSONObject jsonobj = null;\n\t\ttry {\n\t\t\tjsonobj = (JSONObject) jsonParser.parse(jsonString);\n\t\t} catch (ParseException e) {\n\t\t\t// TODO Auto-generated catch block\n\t\t\tlog.info(\"Error in my script\", e);\n\t\t\te.printStackTrace();\n\t\t}\n\t\t//System.out.println(\"This is object :\"+jsonobj.toString());\n\t\tJSONObject obj= (JSONObject)jsonobj.get(\"query\");\n\t\tJSONObject obj1= (JSONObject)obj.get(\"results\");\n\t\tJSONArray objarr=(JSONArray) obj1.get(\"mediaObj\");\n\t\tfor(int i=0;i<objarr.size();i++){\n\t\t\t\n\t\t\t//System.out.println(\"Print all json oobject under mediaObj :\"+objarr.get(i).toString());\n\t\t\tJSONObject jsobj= (JSONObject) objarr.get(i);\n\t\t\tJSONArray ar=(JSONArray) jsobj.get(\"streamProfiles\");\n\t\t\tJSONObject obj3= (JSONObject)ar.get(0);\n\t\t\t//System.out.println(obj3.get(\"host\"));\n\t\t\tlog.info(\"This is host extracted Data: \"+host);\n\n\t\t\t}\n\n\n###### Log file:\n2016/03/09 08:48:06 INFO  - jmeter.util.BeanShellTestElement: Error in my script Unexpected character (#) at position 0.\n\tat org.json.simple.parser.Yylex.yylex(Unknown Source)\n\tat org.json.simple.parser.JSONParser.nextToken(Unknown Source)\n\tat org.json.simple.parser.JSONParser.parse(Unknown Source)\n\tat org.json.simple.parser.JSONParser.parse(Unknown Source)\n\tat org.json.simple.parser.JSONParser.parse(Unknown Source)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat bsh.Reflect.invokeMethod(Reflect.java:134)\n\tat bsh.Reflect.invokeObjectMethod(Reflect.java:80)\n\tat bsh.Name.invokeMethod(Name.java:858)\n\tat bsh.BSHMethodInvocation.eval(BSHMethodInvocation.java:75)\n\tat bsh.BSHPrimaryExpression.eval(BSHPrimaryExpression.java:102)\n\tat bsh.BSHPrimaryExpression.eval(BSHPrimaryExpression.java:47)\n\tat bsh.BSHCastExpression.eval(BSHCastExpression.java:60)\n\tat bsh.BSHAssignment.eval(BSHAssignment.java:77)\n\tat bsh.BSHBlock.evalBlock(BSHBlock.java:130)\n\tat bsh.BSHBlock.eval(BSHBlock.java:80)\n\tat bsh.BSHBlock.eval(BSHBlock.java:46)\n\tat bsh.BSHTryStatement.eval(BSHTryStatement.java:86)\n\tat bsh.Interpreter.eval(Interpreter.java:645)\n\tat bsh.Interpreter.eval(Interpreter.java:739)\n\tat bsh.Interpreter.eval(Interpreter.java:728)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.jmeter.util.BeanShellInterpreter.bshInvoke(BeanShellInterpreter.java:170)\n\tat org.apache.jmeter.util.BeanShellInterpreter.eval(BeanShellInterpreter.java:197)\n\tat org.apache.jmeter.util.BeanShellTestElement.processFileOrScript(BeanShellTestElement.java:151)\n\tat org.apache.jmeter.extractor.BeanShellPostProcessor.process(BeanShellPostProcessor.java:64)\n\tat org.apache.jmeter.threads.JMeterThread.runPostProcessors(JMeterThread.java:750)\n\tat org.apache.jmeter.threads.JMeterThread.process_sampler(JMeterThread.java:452)\n\tat org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:261)\n\tat java.lang.Thread.run(Thread.java:745)\n\n2016/03/09 08:48:06 ERROR - jmeter.util.BeanShellInterpreter: Error invoking bsh method: eval\tSourced file: inline evaluation of: ``import org.json.simple.JSONArray; import org.json.simple.JSONObject; import org. . . . '' : Typed variable declaration \n\n\nJust import the jmx given and paste above Bean Shell Post processor."}, {"count": 3, "tags": [], "bug_id": 59149, "attachment_id": null, "id": 189330, "time": "2016-03-10T00:30:02Z", "creator": "sebb@apache.org", "creation_time": "2016-03-10T00:30:02Z", "is_private": false, "text": "The problem is not in Beanshell or JMeter.\n\nIt's clear from the stack trace that the error was detected by the JSON library."}]