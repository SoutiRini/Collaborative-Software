[{"count": 0, "tags": [], "creator": "ryampolsky@yahoo.com", "text": "In HSSFPicture.getPreferredSize().  This line:\n\n h += (1 - anchor.dy1/256)* getRowHeightInPixels(anchor.row1);\n\ndoesn't work right.  It computes (1 - anchor.dy1/256) as an integer before applying it as a fraction to getRowHeightInPixels.  So you always get h incremented by 1 full row height (anchor.dy/256 evaluates to 0).  It works if I change it to:\n\n h += ((float)1 - (float)anchor.dy1/256)* getRowHeightInPixels(anchor.row1);\n\nSame problem with the code to apply an initial x-offset to the image width:\n\n //space in the leftmost cell\n w += getColumnWidthInPixels(anchor.col1)*(1 - anchor.dx1/1024);\n\nshould be:\n w += getColumnWidthInPixels(anchor.col1)*((float)1 - (float)anchor.dx1/1024);", "id": 122417, "time": "2008-11-12T11:05:28Z", "bug_id": 46197, "creation_time": "2008-11-12T11:05:28Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "yegor@dinom.ru", "text": "Thanks for the suggestion. Applied in r718023.\n\nP.S. Inspired by the \"images and anchors - controlling image size\" thread in poi-user, I added HSSFPicture.resize(double scale).\nscale is the amount by which image dimensions are multiplied relative to the original size:\n\npicture.resize(); //resets to 100% size\npicture.resize(1); //resets to 100% size\npicture.resize(2); //resets to 200% size\npicture.resize(0.5); //resets to 50% size\n\nYegor", "id": 122532, "time": "2008-11-16T05:28:23Z", "bug_id": 46197, "creation_time": "2008-11-16T05:28:23Z", "is_private": false, "attachment_id": null}]