[{"count": 0, "attachment_id": 33285, "creator": "c.pagenkopp@googlemail.com", "text": "Created attachment 33285\nTest class and sample files\n\nHello,\n\nwe have an Excel workbook (XLSX) which we would like to read and modify.\nIn the end we would like to sign it.\n\nUnfortunately we get an NullPointerException while signing, when we have deleted the first sheet before:\njava.lang.NullPointerException\n\tat org.apache.poi.poifs.crypt.dsig.facets.OOXMLSignatureFacet.addManifestReferences(OOXMLSignatureFacet.java:164)\n\tat org.apache.poi.poifs.crypt.dsig.facets.OOXMLSignatureFacet.addManifestObject(OOXMLSignatureFacet.java:100)\n\tat org.apache.poi.poifs.crypt.dsig.facets.OOXMLSignatureFacet.preSign(OOXMLSignatureFacet.java:89)\n\tat org.apache.poi.poifs.crypt.dsig.SignatureInfo.preSign(SignatureInfo.java:472)\n\tat org.apache.poi.poifs.crypt.dsig.SignatureInfo.confirmSignature(SignatureInfo.java:315)\n\nPlease note that this problem does not occur when we delete another sheet instead.\n\nPlease find attached a test class and sample files.\n\nThanks and best regards\nConstantin", "id": 186462, "time": "2015-11-20T15:10:01Z", "bug_id": 58630, "creation_time": "2015-11-20T15:10:01Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 58630, "text": "Thank you for providing a good test and example file - this made things easy \nfor me.\nPatched with r1715438\n\nI've tried to recreate the error by creating a file from scratch and \nsave/reloading it,\nbut this didn't triggered the reference path error.\nI've only spent little time to compare the output of the scratch file to your \ntemplate.xlsx -\non a quick view they look quite similar ... I guess you are happy when the \nsigning works :)\n\nAndi", "id": 186467, "time": "2015-11-20T22:46:07Z", "creator": "kiwiwings@apache.org", "creation_time": "2015-11-20T22:46:07Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 58630, "attachment_id": null, "id": 186535, "time": "2015-11-25T08:50:19Z", "creator": "c.pagenkopp@googlemail.com", "creation_time": "2015-11-25T08:50:19Z", "is_private": false, "text": "Hi!\n\nThank you very much! Signing is working right now!\n\nBest regards\nConstantin"}]