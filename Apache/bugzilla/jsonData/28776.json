[{"attachment_id": null, "tags": [], "creator": "oliver@rossmueller.com", "is_private": false, "count": 0, "id": 56842, "time": "2004-05-05T02:27:34Z", "bug_id": 28776, "creation_time": "2004-05-05T02:27:34Z", "text": "When extracting tar files created with Ant's tar task, tar logs a warning like\n'tar: A lone zero block at *'. While all the file contents is extracted\ncorrectly this message causes confusion for lots of users. The reason for the\nmessage is that tar expects TWO empty records marking the end of the archive but\nAnt is writing only ONE. To fix this, method TarOutputStream.finish() should\nlook like\n\n    public void finish() throws IOException {\n        this.writeEOFRecord();\n        this.writeEOFRecord(); // TWO empty records required\n    }"}, {"count": 1, "tags": [], "bug_id": 28776, "attachment_id": 11429, "id": 56843, "time": "2004-05-05T02:29:12Z", "creator": "oliver@rossmueller.com", "creation_time": "2004-05-05T02:29:12Z", "is_private": false, "text": "Created attachment 11429\nTarOutputStream.java patch"}, {"count": 2, "tags": [], "bug_id": 28776, "attachment_id": null, "text": "The patch of Oliver Rossmueller is making another 0 block.\nMaybe we need more than that ?\nWhat I am missing is a document defining the specification of tar.\n\nI searched to find an implementation of tar in c, and here is what I found :\nhttp://savannah.gnu.org/cgi-bin/viewcvs/tar/tar/src/create.c?rev=1.85&content-type=text/vnd.viewcvs-markup\n/* Write the EOT block(s).  Zero at least two blocks, through the end\n   of the record.  Old tar, as previous versions of GNU tar, writes\n   garbage after two zeroed blocks.  */\nvoid\nwrite_eot (void)\n{\n  union block *pointer = find_next_block ();\n  memset (pointer->buffer, 0, BLOCKSIZE);\n  set_next_block_after (pointer);\n  pointer = find_next_block ();\n  memset (pointer->buffer, 0, available_space_after (pointer));\n  set_next_block_after (pointer);\n}", "id": 60703, "time": "2004-07-16T15:15:21Z", "creator": "antoine@apache.org", "creation_time": "2004-07-16T15:15:21Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 28776, "attachment_id": null, "text": "*** Bug 31984 has been marked as a duplicate of this bug. ***", "id": 66233, "time": "2004-11-01T09:11:33Z", "creator": "peterreilly@apache.org", "creation_time": "2004-11-01T09:11:33Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 28776, "text": "I have found some doc on this.\ninfo tar for gnu tar 1.13.25 (installed on fedora core 2) says this:\n\"The Standard Format\"\n===================\n..\n..\n   Physically, an archive consists of a series of file entries\nterminated by an end-of-archive entry, which consists of 512 zero\nbytes.\n\nGoogling came up with a defintion for gnu tar 1.15.1:\n\"Basic Tar format\"\n..\n..\nPhysically, an archive consists of a series of file entries terminated by an\nend-of-archive entry, which consists of two 512 blocks of zero bytes. \n\nNote the difference in definition!.\n\nI suppose we need to look in the gnu tar cvs for reasons for the\nchange in definition.\n\n", "id": 69494, "time": "2005-01-10T17:13:51Z", "creator": "peterreilly@apache.org", "creation_time": "2005-01-10T17:13:51Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 28776, "attachment_id": null, "text": "Ok, I have found a \"NEWS\" entry for tar:\nhttp://savannah.gnu.org/cgi-bin/viewcvs/tar/tar/NEWS?rev=1.83&content-type=text/vnd.viewcvs-markup\nthe relavent section is:\nversion 1.13.9 - Paul Eggert, 1999-08-18.\n\n* `tar' now writes two zero blocks at end-of-archive instead of just one.\n  POSIX.1 requires this, and some other `tar' implementations check for it.\n\n\nSo it looks like it is a good idea to output two zero blocks.\nAs a zero block is used to finish an archive, there should\nbe no BC problems with having two.\n\nI have committed the change to ant cvs and ant cvs 1.6 branch, it\nshould be in the next release of ant.\nThanks for the patch.\n\n", "id": 69537, "time": "2005-01-11T19:32:25Z", "creator": "peterreilly@apache.org", "creation_time": "2005-01-11T19:32:25Z", "is_private": false}]