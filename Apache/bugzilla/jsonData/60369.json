[{"count": 0, "attachment_id": 34441, "creator": "oldzitterhand78@gmail.com", "is_private": false, "id": 194965, "time": "2016-11-14T12:13:23Z", "bug_id": 60369, "creation_time": "2016-11-14T12:13:23Z", "tags": [], "text": "Created attachment 34441\nsample file with TEXT-formula\n\nHi!\n\nI have an Excel sheet with two columns.\nColumn A contains a formula and column B date values.\n\nIn column A1 there is =TEXT(B1;\"MMMMM\")\nIn column A2 there is =TEXT(B2;\"MMMMM\")\nAnd so on..\n\nWhen reading the values of column A in POI I will receive a wrong value for dates with march as the month. Instead of getting an 'M' I am getting '&#8226; M\u00e4r &#8226;'. (so 'bullet point' M\u00e4r 'bullet point'). My local is German.\n\nI have only seen this behavior when using Java 8, with Java 7 everything seems fine.\n\nBug?\n\n\nRegards,\nPatrick"}, {"count": 1, "attachment_id": null, "creator": "oldzitterhand78@gmail.com", "is_private": false, "id": 194974, "time": "2016-11-14T14:28:56Z", "bug_id": 60369, "creation_time": "2016-11-14T14:28:56Z", "tags": [], "text": "I think we found the place where things go wrong.\n\nIt's in the class 'ExcelStyleDateFormatter':\n\n        // Now handle our special cases\n        if (s.indexOf(MMMMM_START_SYMBOL) != -1) {\n            s = s.replaceAll(\n                    MMMMM_START_SYMBOL + \"(\\\\w)\\\\w+\" + MMMMM_TRUNCATE_SYMBOL,\n                    \"$1\"\n            );\n        }\n\nIn Java 8 the short form for 'March' in German is now 'M\u00e4r', in Java 7 this was 'Mrz'. So the above regex does not work in this case as there is an Umlaut which is not handled by \\w.\n\n\nCheers\nPatrick"}, {"count": 2, "tags": [], "bug_id": 60369, "attachment_id": null, "id": 195184, "creation_time": "2016-11-24T13:10:59Z", "time": "2016-11-24T13:10:59Z", "creator": "dannyboyhex@gmail.com", "text": "Hi ,\n\nIs there any update on this ? Is POI support for Java 8 out ?", "is_private": false}, {"count": 3, "tags": [], "bug_id": 60369, "attachment_id": null, "id": 195189, "time": "2016-11-24T20:52:20Z", "creator": "onealj@apache.org", "creation_time": "2016-11-24T20:52:20Z", "is_private": false, "text": "POI works on Java 8: https://builds.apache.org/job/POI-JDK8/\n\nWe were busy with the 3.16 beta 1 release, so code changes were limited in the past 2 weeks.\nIf you have time to put together a unit test that passes on JDK6, JDK7, and JDK8 with your regex fixes, it would be greatly appreciated. See https://poi.apache.org/guidelines.html#Submitting+Patches"}, {"count": 4, "tags": [], "bug_id": 60369, "attachment_id": null, "id": 195208, "time": "2016-11-25T13:33:22Z", "creator": "oldzitterhand78@gmail.com", "creation_time": "2016-11-25T13:33:22Z", "is_private": false, "text": "I have added a zip-file containing the patched ExcelStyleDateFormatter, a test class TestExcelStyleDateFormatter and the diff-file for the patch.\n\nI hope everything is in the format it should be, as I was not able to download the read-only svn repository.\nAlso I am not sure if the test provided would actually belong in some other class, my provided class is a new class in the package org.apache.poi.ss.usermodel."}, {"count": 5, "tags": [], "text": "Created attachment 34476\nZip-file containing proposed patch for bug 60369, test-class and diff-file.\n\nThis file contains a zip-file with the patched ExcelStyleDateFormatter, a test class TestExcelStyleDateFormatter and the diff-file.", "is_private": false, "id": 195209, "creator": "oldzitterhand78@gmail.com", "time": "2016-11-25T13:36:45Z", "bug_id": 60369, "creation_time": "2016-11-25T13:36:45Z", "attachment_id": 34476}, {"count": 6, "attachment_id": null, "creator": "dominik.stadler@gmx.at", "is_private": false, "id": 195738, "time": "2016-12-30T22:21:30Z", "bug_id": 60369, "creation_time": "2016-12-30T22:21:30Z", "tags": [], "text": "Applied via r1776646, thanks for the patch and unit-tests. I slightly adjusted the regex-pattern, the second pipe-symbol seemed unnecessary."}]