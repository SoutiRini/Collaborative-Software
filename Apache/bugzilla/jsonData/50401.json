[{"count": 0, "text": "Created attachment 26364\nPowerpoint file containing a shape with a .Name property\n\nIn some cases, it is possible to create an EscherComplexProperty of an org.apache.poi.ddf.EscherOptRecord\nthat returns  'unknown' for getName(), but where the EscherOptRecord.toString() method correctly returns a string containing propName: <real property name>.\n\nAs an example:  In the attached ppt file, I've used the VBA macro that follows to set the .Name property of the blue square to a string.\n\nUsing HSLF and poi (using jython), I can write:\n\nss=SlideShow(HSLFSlideShow('x.ppt'))\nss.slides[0].shapes[-1].getSpContainer()\n\nI then see that the last property in my EscherOpt record is:\n\npropNum: 896, propName: groupshape.shapename, complex: true, blipId: true, data: \n00: 3C, 00, 50, 00, 41, 00, 54, 00, 48, 00, 2E (etc)\n\n(notice the groupshape.shapename)\n\n\nHowever, when I use POI/HSLF to iterate over the container, as follows:\n\nitt=ss.slides[0].shapes[-1].getSpContainer().getIterator()\nwhile(itt.hasNext()):\n   curRecord=itt.next()\n   if curRecord.recordName=='Opt':\n       props=curRecord.getEscherProperties()\n       for p in props:\n           print p.getClass(), p.getName()\n\nI get:\n\n<type 'org.apache.poi.ddf.EscherSimpleProperty'> text.wraptext\n<type 'org.apache.poi.ddf.EscherSimpleProperty'> text.anchortext\n<type 'org.apache.poi.ddf.EscherRGBProperty'> fill.fillcolor\n<type 'org.apache.poi.ddf.EscherRGBProperty'> fill.fillbackcolor\n<type 'org.apache.poi.ddf.EscherBoolProperty'> fill.nofillhittest\n<type 'org.apache.poi.ddf.EscherRGBProperty'> linestyle.color\n<type 'org.apache.poi.ddf.EscherBoolProperty'> linestyle.nolinedrawdash\n<type 'org.apache.poi.ddf.EscherRGBProperty'> shadowstyle.color\n<type 'org.apache.poi.ddf.EscherComplexProperty'> unknown\n\nAs you can see, the last one (the EscherComplexProperty) does not properly return the propName stored in the property, and the only way that I can get to this is by using the toString method and parsing the result.\n\nThis makes it hard to visit the names of all objects\n\n\nVBA Macro to set name property on a shape.\n\nSub NameIt()\n  Dim sResponse As String\n\n  With ActiveWindow.Selection.ShapeRange(1)\n    sResponse = InputBox(\"new name ...\", \"Rename Shape\", .Name)\n    Select Case sResponse\n     ' blank names not allowed\n     Case Is = \"\"\n       Exit Sub\n     ' no change?\n     Case Is = .Name\n       Exit Sub\n     Case Else\n       On Error Resume Next\n       .Name = sResponse\n       If Err.Number <> 0 Then\n         MsgBox \"Unable to rename this shape\"\n       End If\n    End Select\n  End With\n\nEnd Sub", "bug_id": 50401, "attachment_id": 26364, "id": 142308, "time": "2010-12-02T10:31:04Z", "creator": "gregory.bronner@barcap.com", "creation_time": "2010-12-02T10:31:04Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "text": "Fixed in r1149111, junit added.\n\nThanks for patience,\nYegor", "attachment_id": null, "bug_id": 50401, "id": 148057, "time": "2011-07-21T11:01:19Z", "creator": "yegor@dinom.ru", "creation_time": "2011-07-21T11:01:19Z", "is_private": false}]