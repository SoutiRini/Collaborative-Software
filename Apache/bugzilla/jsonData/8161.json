[{"count": 0, "tags": [], "bug_id": 8161, "attachment_id": null, "text": "$> cd httpd-2.0.35\n$> make clean\n$> ./configure --enable-so --with-mpm=perchild --enable-info --disable-cgid\n--enable-cgi\n$> make && make install\n\n$> /usr/local/apache2/bin/apachectl start\n\nserver works, all content one delivers\n\nafter the deliver...\n$> cat /usr/local/apache2/logs/error_log\n[...]\n[Tue Apr 16 14:21:23 2002] [notice] child pid 7072 exit signal Segmentation\nfault (11)\n[Tue Apr 16 14:21:23 2002] [notice] child pid 7067 exit signal Segmentation\nfault (11)\n[Tue Apr 16 14:21:23 2002] [notice] child pid 7066 exit signal Segmentation\nfault (11)\n[Tue Apr 16 14:21:23 2002] [notice] child pid 7065 exit signal Segmentation\nfault (11)\n[...]\n\nany ideas ... ???", "id": 13758, "time": "2002-04-16T12:29:12Z", "creator": "foobar@web.de", "creation_time": "2002-04-16T12:29:12Z", "is_private": false}, {"count": 1, "attachment_id": 1598, "creator": "foobar@web.de", "text": "Created attachment 1598\nhttpd.conf", "id": 13759, "time": "2002-04-16T12:30:54Z", "bug_id": 8161, "creation_time": "2002-04-16T12:30:54Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "jwoolley@apache.org", "attachment_id": null, "id": 13798, "time": "2002-04-16T22:05:45Z", "bug_id": 8161, "creation_time": "2002-04-16T22:05:45Z", "is_private": false, "text": "- perchild is still classified as experimental \n- you can't use mod_cgi instead of mod_cgid with a threaded MPM \n- there are several segfaults already fixed or being fixed for 2.0.36  \n \nI'm going to assume the problem is one of the above and close out this bug.  If you can \nproduce a backtrace for us (see http://httpd.apache.org/dev/debugging.html), feel free to \nsubmit the backtrace as a new PR. \n \nThanks for using Apache! "}, {"count": 3, "tags": [], "bug_id": 8161, "text": "vi server/mpm/perchild/perchild.c\n...\n1556 len = strlen(foo);\n...\n\nfoo is a null pointer ;(\n\n\nroot@rayman:/RAY/apa20/httpd-2.0.35 > gdb /usr/local/apache2/bin/httpd \nGNU gdb 5.1.1\nCopyright 2002 Free Software Foundation, Inc.\nGDB is free software, covered by the GNU General Public License, and you are\nwelcome to change it and/or distribute copies of it under certain conditions.\nType \"show copying\" to see the conditions.\nThere is absolutely no warranty for GDB.  Type \"show warranty\" for details.\nThis GDB was configured as \"i386-suse-linux\"...\n(gdb) b pass_request\nBreakpoint 1 at 0x80829e5: file perchild.c, line 1541.\n(gdb) run -X -d /usr/local/apache2\nStarting program: /usr/local/apache2/bin/httpd -X -d /usr/local/apache2\n[New Thread 1024 (LWP 29631)]\n[New Thread 2049 (LWP 29633)]\n[New Thread 1026 (LWP 29634)]\n[New Thread 2051 (LWP 29635)]\n[New Thread 3076 (LWP 29636)]\n[New Thread 4101 (LWP 29637)]\n[New Thread 5126 (LWP 29638)]\n[New Thread 6151 (LWP 29639)]\n[Switching to Thread 1026 (LWP 29634)]\n\nBreakpoint 1, pass_request (r=0x8139e50) at perchild.c:1541\n1541        apr_socket_t *thesock =\nap_get_module_config(r->connection->conn_config, &core_module);\n(gdb) n\n1547        apr_bucket_brigade *bb = apr_brigade_create(r->pool, c->bucket_alloc);\n(gdb) n\n1541        apr_socket_t *thesock =\nap_get_module_config(r->connection->conn_config, &core_module);\n(gdb) n\n1547        apr_bucket_brigade *bb = apr_brigade_create(r->pool, c->bucket_alloc);\n(gdb) n\n1548        perchild_server_conf *sconf = (perchild_server_conf *)\n(gdb) n\n1558        apr_os_sock_get(&sfd, thesock);\n(gdb) n\n1548        perchild_server_conf *sconf = (perchild_server_conf *)\n(gdb) n\n1556        len = strlen(foo);\n(gdb) n\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x08082a50 in pass_request (r=0x8139e50) at perchild.c:1556\n1556        len = strlen(foo);\n(gdb) bt\n#0  0x08082a50 in pass_request (r=0x8139e50) at perchild.c:1556\n#1  0x08082de4 in perchild_post_read (r=0x8139e50) at perchild.c:1673\n#2  0x0809371c in ap_run_post_read_request (r=0x8139e50) at protocol.c:1563\n#3  0x080925b8 in ap_read_request (conn=0x8117ea0) at protocol.c:944\n#4  0x0806a2a1 in ap_process_http_connection (c=0x8117ea0) at http_core.c:304\n#5  0x0808e74d in ap_run_process_connection (c=0x8117ea0) at connection.c:85\n#6  0x0808ea90 in ap_process_connection (c=0x8117ea0, csd=0x8117dc8) at\nconnection.c:207\n#7  0x08080f9b in process_socket (p=0x8117d90, sock=0x8117dc8, conn_id=0,\nbucket_alloc=0x8148848) at perchild.c:570\n#8  0x0808161a in worker_thread (thd=0x810fff0, arg=0x810fda8) at perchild.c:807\n#9  0x4003bfe3 in dummy_worker (opaque=0x810fff0) at thread.c:127\n#10 0x40196e67 in pthread_start_thread () from /lib/libpthread.so.0\n#11 0x40196eb5 in pthread_start_thread_event () from /lib/libpthread.so.0\n(gdb) \n", "id": 13842, "time": "2002-04-17T11:37:56Z", "creator": "foobar@web.de", "creation_time": "2002-04-17T11:37:56Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "jwoolley@apache.org", "attachment_id": null, "id": 13881, "time": "2002-04-17T17:25:59Z", "bug_id": 8161, "creation_time": "2002-04-17T17:25:59Z", "is_private": false, "text": "Thanks for the backtrace.  I'm reopening this PR since the backtrace will \nprobably be helpful to the developers working on making perchild more stable. \n \nThanks for using Apache! "}, {"count": 5, "tags": [], "bug_id": 8161, "attachment_id": null, "text": "This code was re-written recently, and that variable no longer exists.  The file\ndescriptor passing isn't working yet, but the segfault is gone, and the MPM does\nserve pages correclty again.  It does not, however, use the correct uid/gid for\nall pages, that support will be fixed later this week.", "id": 18879, "time": "2002-07-02T20:19:14Z", "creator": "rbb@apache.org", "creation_time": "2002-07-02T20:19:14Z", "is_private": false}]