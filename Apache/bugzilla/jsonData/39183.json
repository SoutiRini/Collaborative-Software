[{"count": 0, "tags": [], "text": "Everytime Sun introduces new Java keywords - let it be \"assert\" in Java 1.4 or\n\"enum\" in Java 1.5 - there are zillions of Java projects stopping to compile. To\naddress that issue Sun was that enlightened to give javac this nice \"-source\"\ncommand line switch. Unfortunatly it is not use that often.\n\nIt is my strong believe that the transition to new Java versions would be much\nmore pleasant, if maintainers of Java projects would be forced to explicitly\nexpress the Java dialect the project targets. To start embracing this good\npractice, Ant could make the source attribute of it's javac task mandatory.\nSurly this will put some burden on the shoulders of few project maintainers\nwhoms projects to not compile anymore and who have to incooperate build.xml\npatches adding this tiny switch. But in return it takes the burden from much the\nlarger group of users of those packages, who fiddle with the build.xml files\nmanually.\n\nIf you don't see this problem as an issue, just as a random maintainer of an OS\ndistributing prebuilt Java packages.", "attachment_id": null, "bug_id": 39183, "id": 87514, "time": "2006-04-02T18:39:29Z", "creator": "mathias.hasselmann@gmx.de", "creation_time": "2006-04-02T18:39:29Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 39183, "attachment_id": null, "is_private": false, "id": 87515, "time": "2006-04-02T20:47:05Z", "creator": "stevel@apache.org", "creation_time": "2006-04-02T20:47:05Z", "text": "I know this is a problem with building third party libraries, and I'm not happy\nwith it either.\n\nBut we cannot just switch on target= and source= things without breaking so many\nbuild files out there it wouldnt be funny.\n\nSo this leaves us two other options\n1. select a fixed language version (say java1.4), which is the default unless\nsomething else is asked for.\n\n2. add a back door property like ant._internal.javac.source which can be set to\na source to fix those build files that dont otherwise build on java1.5"}, {"count": 2, "tags": [], "text": "Guess this ant._internal.javac.source property could work to get arround all\nthose broken packages. As I understand this breaking apps issue: What about\nissuing a warning, if \"source\" is not set? Don't care that much about \"target\"\nas it is implied by \"source\".", "attachment_id": null, "bug_id": 39183, "id": 87527, "time": "2006-04-03T08:35:50Z", "creator": "mathias.hasselmann@gmx.de", "creation_time": "2006-04-03T08:35:50Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 39183, "attachment_id": null, "text": "The source attribute is documented with this (bolded) warning:\n\nNote that the default value depends on the JVM that is running Ant. We highly\nrecommend to always specify this attribute.\n\nIf users choose to ignore this warning in the documentation, I don't know that I\ncan see the point of noising up builds in addition.  :|  I would be -0 on such a\nruntime warning.", "id": 87531, "time": "2006-04-03T15:22:56Z", "creator": "mbenson@apache.org", "creation_time": "2006-04-03T15:22:56Z", "is_private": false}, {"count": 4, "tags": [], "text": "A simple <presetdef> or <presetdef> with <import> (if you do not want to modify\noriginal build file) can solve this issue. All conversation about internal\nsecret properties is about emulating <presetdef> with property files. I think it\nis useful - it would be externally configurable, but a solution is already\navailable.", "is_private": false, "bug_id": 39183, "id": 87534, "time": "2006-04-03T15:34:55Z", "creator": "alexeys@inventigo.com", "creation_time": "2006-04-03T15:34:55Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 39183, "attachment_id": null, "text": "aah, but <presetdef> changes the type of teh return of\nproject.createTask(\"javac\"), which could toast any custom task that assumed it\nwas castable. \n\nA property would let us fix everything on gump that is broken", "id": 87547, "time": "2006-04-03T21:24:03Z", "creator": "stevel@apache.org", "creation_time": "2006-04-03T21:24:03Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 39183, "is_private": false, "id": 87548, "attachment_id": null, "creator": "alexeys@inventigo.com", "creation_time": "2006-04-03T21:43:02Z", "time": "2006-04-03T21:43:02Z", "text": ">aah, but <presetdef> changes the type of teh return of\n>project.createTask(\"javac\"), which could toast any custom task that assumed it\n>was castable. \n\nIt is <presetdef> problem (or feature) that can be fixed. There is no reason for\n<presetdef> to change task implementation class, instead project.createTask()\nshould set default values (maybe set by external properties or <presetdef>)."}, {"count": 7, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "text": "ant.build.javac.source and ant.build.javac.target are now there", "id": 87775, "time": "2006-04-11T19:20:23Z", "bug_id": 39183, "creation_time": "2006-04-11T19:20:23Z", "is_private": false}, {"count": 8, "tags": [], "creator": "jglick@apache.org", "attachment_id": null, "text": "I agree with Mathias on this. Wouldn't it be preferable to make the source attrs\nsemimandatory, warning if unset? Maybe you will get a lot of warnings from Gump\n- good. To me that just means that we are informing a lot of projects built on\nGump that they forgot to do something important - set this attr, according to\nthe actual source level of the project being built. Using \"1.4\" for a 1.5\nproject is obviously impossible, and using \"1.5\" for a 1.4 project is in some\ncases possible but not reliably - it may turn reasonably common code like\n\n  Enumeration enum = loader.getResources(\"foo.properties\");\n\nfrom a warning into an error.\n\nTo Matt re. adding verbosity to builds for users who \"choose to ignore the\ndocumentation's boldface warning\" - I doubt most people ever read the manual\nvery carefully (or at all). They see someone using <javac> somewhere, they copy\nit, it seems to work, done. I can't imagine any case where you would\nintentionally omit the 'source' attr except out of pure laziness.", "id": 88244, "time": "2006-04-18T23:26:54Z", "bug_id": 39183, "creation_time": "2006-04-18T23:26:54Z", "is_private": false}, {"count": 9, "tags": [], "bug_id": 39183, "attachment_id": null, "is_private": false, "id": 88273, "time": "2006-04-19T13:57:09Z", "creator": "mbenson@apache.org", "creation_time": "2006-04-19T13:57:09Z", "text": "(In reply to comment #8)\n> To Matt re. adding verbosity to builds for users who \"choose to ignore the\n> documentation's boldface warning\" - I doubt most people ever read the manual\n> very carefully (or at all). They see someone using <javac> somewhere, they copy\n> it, it seems to work, done. I can't imagine any case where you would\n> intentionally omit the 'source' attr except out of pure laziness.\n\nGuilty.  ;)"}]