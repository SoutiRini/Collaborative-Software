[{"count": 0, "tags": [], "bug_id": 40079, "attachment_id": null, "text": "I a tried to run server under limited user account which do not have access to \nall file system except its root directory (E:\\usr\\local\\Apache2). Server \ninstalled as a service. When I run it I see the error and this message in the \nsystem event log: \n\nhttpd.exe: Could not open configuration file bin/conf/httpd.conf: path not found\n\nConf file located in /conf subdirectory of the server root directory. \nWinternals FileMon show the httpd.exe tried to open D:\\WINDOWS\\System32\n\\bin\\conf\\httpd.cfg only, without searching in other directories from the Path \nenvironment variable, only in first, with 'bin'. Okay, I put the key -\nd \"E:\\usr\\local\\Apache2\" into the command line of service execution. After this \napache found the httpd.conf file but do not start. EventLog now has another \nerror: \n\nhttpd.exe: Syntax error on line 4 of E:\\\\usr\\\\local\\\\Apache2/conf/httpd.conf: \nServerRoot must be a valid directory\n\nIn line 4 I have this string: 'ServerRoot \"E:/usr/local/Apache2\"'. Then I tried \nto comment it but have same error in another line. And this error continues \nwith all paths in the config.\n\nBUT! If I run the service under system account - I have no errors, without \nchanges of anything. All works fine.\n\nLimited user account have full access to the E:/usr/local/Apache2 directory.", "id": 91431, "time": "2006-07-20T14:24:08Z", "creator": "speller@yandex.ru", "creation_time": "2006-07-20T14:24:08Z", "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 40079, "text": "Interesting; this bug should not be closed until we determine why exactly\nthe -d argument was required in your specific case if you had a valid -f.\nThat said...\n\n\"Limited user account have full access to the E:/usr/local/Apache2 directory.\"\n\nIn order to prevent directory and configuration paths from being confused and\nignored, Apache will FindFile to obtain the 'true' directory name all the way\nfrom the root drive letter, up to the path.  This means your limited user acct\nMUST have permission to list files and get the directory permissions info in \ne:\\, e:\\usr, e:\\usr\\local, e:\\usr\\local\\apache2.  That is, every directory\nthat your configuration implies.\n\nIt doesn't need read access to the actual files in those higher-level dirs,\njust what unix would call '555' access.  On windows, this is \"Read and Execute\"\nal la Traverse Folder, List Folder, Read Attribs, Read Extended Attribs, and\nand Read Permissions.\n\nKeep us informed of your progress!\n\nKeep us informed of your efforts.\n", "id": 91445, "time": "2006-07-20T21:17:13Z", "creator": "wrowe@apache.org", "creation_time": "2006-07-20T21:17:13Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 40079, "text": "Is it riquired to list up-level directories? Why server can not \"live\" only in \nits directory? Why not only check given path exists, without listing of parent \ndirectories?", "id": 91449, "time": "2006-07-21T01:04:31Z", "creator": "speller@yandex.ru", "creation_time": "2006-07-21T01:04:31Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 40079, "attachment_id": null, "text": "You was right. I permit the apache user to list directories and server started \nsuccessfully. But I do not want permit apache look anywhere instead of its root \ndirectory. I am programmer, and I do not see any reason to list parent \ndirectories.\n\n>> why exactly the -d argument was required in your specific case if you had a \n>> valid -f\n\nThe apache service runs with this command: \n\n\"E:\\usr\\local\\Apache2\\bin\\httpd.exe\" -k runservice\n\nIn my first post I wrote Apache can not find its config. Then I modified this \ncommand to \n\n\"E:\\usr\\local\\Apache2\\bin\\httpd.exe\" -k runservice -d \"E:\\usr\\local\\Apache2\"\n\nAnd Apache found its config. So, I think this is a bug, but from a few another \ncase.", "id": 91450, "time": "2006-07-21T01:23:26Z", "creator": "speller@yandex.ru", "creation_time": "2006-07-21T01:23:26Z", "is_private": false}, {"count": 4, "attachment_id": null, "bug_id": 40079, "text": "\"Is it riquired to list up-level directories? Why server can not \"live\" only in \nits directory? Why not only check given path exists, without listing of parent \ndirectories?\"\n\nBecause Apache cannot be permitted to confuse e:\\Apache2Server with e:\\Apache~1\nor the HOST of various conflicts which can occur because windows chooses to be\nCAST INSENSITIVE, but moreso because it's also NOT CANONICAL.  The file path\n\"e:\\Apache2Server\\\" is equivilant to \"e:\\Apache2Server.\", for example.\n\nTherefore we **INSIST** on canonicalizing the path.  If we have nothing but list\naccess to see dir FOO exists, this isn't a security problem.  If we accept both\ne:\\Apache~1\\ and e:\\Apache2Server as two different names, there IS A HUGE\nsecurity problem.\n\nMarked as invalid.  Parent directories must be list/traverse accessible to\ndifferentiate them on Win32.", "id": 96624, "time": "2006-12-07T11:48:00Z", "creator": "wrowe@apache.org", "creation_time": "2006-12-07T11:48:00Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "bug_id": 40079, "text": "(In reply to comment #4)\n> Because Apache cannot be permitted to confuse e:\\Apache2Server with \ne:\\Apache~1\n> or the HOST of various conflicts which can occur because windows chooses to be\n> CAST INSENSITIVE, but moreso because it's also NOT CANONICAL.  The file path\n> \"e:\\Apache2Server\\\" is equivilant to \"e:\\Apache2Server.\", for example.\n> \n> Therefore we **INSIST** on canonicalizing the path.  If we have nothing but \nlist\n> access to see dir FOO exists, this isn't a security problem.  If we accept \nboth\n> e:\\Apache~1\\ and e:\\Apache2Server as two different names, there IS A HUGE\n> security problem.\n> \n> Marked as invalid.  Parent directories must be list/traverse accessible to\n> differentiate them on Win32.\n\nIs this statement true for both, windows and unix? Or for windows only?\n\nThanks.", "id": 103133, "time": "2007-05-12T10:54:21Z", "creator": "a.alfimov@gmail.com", "creation_time": "2007-05-12T10:54:21Z", "is_private": false, "attachment_id": null}]