[{"count": 0, "tags": [], "bug_id": 33618, "is_private": false, "id": 71121, "creation_time": "2005-02-17T13:30:14Z", "time": "2005-02-17T13:30:14Z", "creator": "claudiu.cucos@gmail.com", "text": "When I try to call telnet task with a property name-value pair defined on the \ncommand line, a NullPointerException is thrown. There are two cases:\n1. a normal telnet session to a host --> it works fine\n\n    <target name=\"demo_telnet\" description=\"Telnet Demo\">\n        <telnet server=\"${host_address}\"\n            userid=\"${telnet_host_user}\"\n            password=\"${telnet_host_password}\"\n            timeout=\"30\">\n            <read string=\"${telnet_prompt}\"/>\n            <write string=\"exit\"/>\n        </telnet>\n    </target>\n\nThis is the result:\n\nC:\\Idea\\Practice\\src\\ant\\bug-telnet>ant demo_telnet -\nDhost_address=\"192.168.100.119\"\nBuildfile: build.xml\n\ndemo_telnet:\n   [telnet] Welcome to Microsoft Telnet Service\n   [telnet]\n   [telnet]\n   [telnet] login:\n   [telnet] galati\\nicub\n   [telnet]  galati\\nicub\n   [telnet]\n   [telnet] password:\n   [telnet]  ===============================================================\nWelcome to Microsoft Telnet Server.\n===============================================================\nC:\\Documents and Settings\\nicub>\n   [telnet] exit\n\nBUILD SUCCESSFUL\nTotal time: 18 seconds\n\n2. a telnet session to a http server --> it fails\n\n    <target name=\"demo_http\" description=\"Http Demo\">\n        <telnet server=\"${host_address}\"\n            port=\"80\"\n            timeout=\"20\">\n            <read/>\n            <write string=\"GET /infochiosc/admin/tree/create_index.jsp \nHTTP/1.1\"/>\n            <write string=\"Host: ${host}\"/>\n            <write/>\n            <read string=\"&lt;/html&gt;\"/>\n        </telnet>\n    </target>\n\nThis is the result:\n\nC:\\Idea\\Practice\\src\\ant\\bug-telnet>ant -v demo_http -Dhost=\"192.168.100.119\"\nApache Ant version 1.6.2 compiled on July 16 2004\nBuildfile: build.xml\nDetected Java version: 1.4 in: C:\\j2sdk1.4.2_04\\jre\nDetected OS: Windows XP\nparsing buildfile C:\\Idea\\Practice\\src\\ant\\bug-telnet\\build.xml with URI = \nfile:///C:/Idea/Practice/src/ant/bug-telnet/b\nuild.xml\nProject base dir set to: C:\\Idea\\Practice\\src\\ant\\bug-telnet\n [property] Loading C:\\Idea\\Practice\\src\\ant\\bug-telnet\\broadcast.properties\nBuild sequence for target `demo_http' is [demo_http]\nComplete build sequence is [demo_http, demo_telnet, ]\n\ndemo_http:\nProperty ${host_address} has not been set\n\nBUILD FAILED\nC:\\Idea\\Practice\\src\\ant\\bug-telnet\\build.xml:8: java.lang.NullPointerException\n        at org.apache.tools.ant.Task.perform(Task.java:373)\n        at org.apache.tools.ant.Target.execute(Target.java:341)\n        at org.apache.tools.ant.Target.performTasks(Target.java:369)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1214)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1062)\n        at org.apache.tools.ant.Main.runBuild(Main.java:673)\n        at org.apache.tools.ant.Main.startAnt(Main.java:188)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:196)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:55)\nCaused by: java.lang.NullPointerException\n        at org.apache.commons.net.telnet.TelnetClient.disconnect\n(TelnetClient.java:125)\n        at org.apache.tools.ant.taskdefs.optional.net.TelnetTask.execute\n(TelnetTask.java:119)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:275)\n        at org.apache.tools.ant.Task.perform(Task.java:364)\n        ... 8 more\n--- Nested Exception ---\njava.lang.NullPointerException\n        at org.apache.commons.net.telnet.TelnetClient.disconnect\n(TelnetClient.java:125)\n        at org.apache.tools.ant.taskdefs.optional.net.TelnetTask.execute\n(TelnetTask.java:119)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:275)\n        at org.apache.tools.ant.Task.perform(Task.java:364)\n        at org.apache.tools.ant.Target.execute(Target.java:341)\n        at org.apache.tools.ant.Target.performTasks(Target.java:369)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1214)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1062)\n        at org.apache.tools.ant.Main.runBuild(Main.java:673)\n        at org.apache.tools.ant.Main.startAnt(Main.java:188)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:196)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:55)\n\nTotal time: 2 seconds", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 33618, "is_private": false, "id": 71160, "creation_time": "2005-02-18T11:47:55Z", "time": "2005-02-18T11:47:55Z", "creator": "bodewig@apache.org", "text": "For some reason you don't seem to set host_address on your second invocation.\n\nAlso, it is quite possible that this is a big in common-net.  Which version are\nyou using?\n\nCan you give us a --debug output for the task?", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 33618, "attachment_id": null, "id": 71161, "creation_time": "2005-02-18T12:00:55Z", "time": "2005-02-18T12:00:55Z", "creator": "bodewig@apache.org", "text": "OK, I think I see the problem.  We call disconnect even when connect fails and\ndisconnect in commons-net tries to close a stream that hasn't been opened unless\nconnect succeeded.\n\nThis should be fixed in CVS now, could you please try a nightly build of 2005-02-19\nor later to verify it?\n", "is_private": false}, {"count": 3, "tags": [], "creator": "claudiu.cucos@gmail.com", "attachment_id": null, "id": 71293, "time": "2005-02-21T09:15:29Z", "bug_id": 33618, "creation_time": "2005-02-21T09:15:29Z", "is_private": false, "text": "Yes. It's possible you have right. It's quite possible to be a problem of \ncommon-net. I have used 1.30 version. This is the output with -debug. \n\nC:\\Idea\\Practice\\src\\ant\\bug-telnet>ant -debug demo_http -\nDhost_address=\"192.168.100.119\"\nApache Ant version 1.6.2 compiled on July 16 2004\nBuildfile: build.xml\nAdding reference: ant.PropertyHelper\nDetected Java version: 1.4 in: C:\\j2sdk1.4.2_04\\jre\nDetected OS: Windows XP\nAdding reference: ant.ComponentHelper\nSetting ro project property: ant.version -> Apache Ant version 1.6.2 compiled \non July 16 2004\nSetting ro project property: host_address -> 192.168.100.119\nSetting ro project property: ant.file -> C:\\Idea\\Practice\\src\\ant\\bug-\ntelnet\\build.xml\nAdding reference: ant.projectHelper\nAdding reference: ant.parsing.context\nAdding reference: ant.targets\nparsing buildfile C:\\Idea\\Practice\\src\\ant\\bug-telnet\\build.xml with URI = \nfile:///C:/Idea/Practice/src/ant/bug-telnet/b\nuild.xml\nSetting ro project property: ant.project.name -> broadcast\nAdding reference: broadcast\nSetting ro project property: ant.file.broadcast -> \nC:\\Idea\\Practice\\src\\ant\\bug-telnet\\build.xml\nProject base dir set to: C:\\Idea\\Practice\\src\\ant\\bug-telnet\n +Target:\n +Target: demo_http\n +Target: demo_telnet\n [property] Loading C:\\Idea\\Practice\\src\\ant\\bug-telnet\\broadcast.properties\nSetting project property: telnet_host_password -> platon\nSetting project property: telnet_prompt -> C:\\Documents and Settings\\nicub>\nSetting project property: telnet_host_user -> galati\\nicub\nBuild sequence for target `demo_http' is [demo_http]\nComplete build sequence is [demo_http, demo_telnet, ]\n\ndemo_http:\n\nBUILD FAILED\nC:\\Idea\\Practice\\src\\ant\\bug-telnet\\build.xml:8: java.lang.NullPointerException\n        at org.apache.tools.ant.Task.perform(Task.java:373)\n        at org.apache.tools.ant.Target.execute(Target.java:341)\n        at org.apache.tools.ant.Target.performTasks(Target.java:369)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1214)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1062)\n        at org.apache.tools.ant.Main.runBuild(Main.java:673)\n        at org.apache.tools.ant.Main.startAnt(Main.java:188)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:196)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:55)\nCaused by: java.lang.NullPointerException\n        at org.apache.commons.net.telnet.TelnetClient.disconnect\n(TelnetClient.java:125)\n        at org.apache.tools.ant.taskdefs.optional.net.TelnetTask.execute\n(TelnetTask.java:119)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:275)\n        at org.apache.tools.ant.Task.perform(Task.java:364)\n        ... 8 more\n--- Nested Exception ---\njava.lang.NullPointerException\n        at org.apache.commons.net.telnet.TelnetClient.disconnect\n(TelnetClient.java:125)\n        at org.apache.tools.ant.taskdefs.optional.net.TelnetTask.execute\n(TelnetTask.java:119)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:275)\n        at org.apache.tools.ant.Task.perform(Task.java:364)\n        at org.apache.tools.ant.Target.execute(Target.java:341)\n        at org.apache.tools.ant.Target.performTasks(Target.java:369)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1214)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1062)\n        at org.apache.tools.ant.Main.runBuild(Main.java:673)\n        at org.apache.tools.ant.Main.startAnt(Main.java:188)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:196)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:55)\n\nTotal time: 1 second\n\n(In reply to comment #1)\n> For some reason you don't seem to set host_address on your second invocation.\n> Also, it is quite possible that this is a big in common-net.  Which version \nare\n> you using?\n> Can you give us a --debug output for the task?\n\n"}, {"count": 4, "tags": [], "bug_id": 33618, "is_private": false, "id": 71299, "creation_time": "2005-02-21T11:05:08Z", "time": "2005-02-21T11:05:08Z", "creator": "bodewig@apache.org", "text": "This time Ant doesn't complain about host_address not being defined.\n\nI'm unsure why Ant would fail to connect, the current NPE probably masks the\noriginal error since it gets thrown in a finally block.\n\nPlease try the nightly build, the NPE should go away and give you a hint why\n<telnet> fails to connect in the first place.\n", "attachment_id": null}]