[{"attachment_id": null, "tags": [], "bug_id": 56741, "is_private": false, "count": 0, "id": 176491, "time": "2014-07-18T14:32:40Z", "creator": "cedric.walter@gmail.com", "creation_time": "2014-07-18T14:32:40Z", "text": "Similar to the patch provided in Bug 56315\nthe ROUNDDOWN() function is not behaving like excel and required a similar patch as for the ROUND() function.\n\nNew code\n\npublic static double roundDown(double n, int p) {\n double retval;\n if (Double.isNaN(n) || Double.isInfinite(n)) {\n   retval = Double.NaN;\n } else {\n   retval = new BigDecimal(NumberToTextConverter.toText(n)).setScale(p, java.math.RoundingMode.DOWN).doubleValue();\n }\n return retval;\n}\n\nI will provide a patch, unit tests and integration test FormulaEvalTestData.xls soon"}, {"count": 1, "tags": [], "text": "Created attachment 31829\nPatch.txt", "is_private": false, "bug_id": 56741, "id": 176492, "time": "2014-07-18T14:57:29Z", "creator": "cedric.walter@gmail.com", "creation_time": "2014-07-18T14:57:29Z", "attachment_id": 31829}, {"attachment_id": 31830, "tags": [], "bug_id": 56741, "is_private": false, "count": 2, "id": 176493, "time": "2014-07-18T14:58:01Z", "creator": "cedric.walter@gmail.com", "creation_time": "2014-07-18T14:58:01Z", "text": "Created attachment 31830\ntest-data/spreadsheet/FormulaEvalTestData.xls\n\nIntegration test"}, {"count": 3, "tags": [], "bug_id": 56741, "text": "this patch break the ROUNDDOWN method in \"some\" cases and should not be merged!\n\nPatch require further analysis\n\nBTW the rounddup function also do not behave in POI like in excel and will hopefully be solved soon.", "id": 176617, "time": "2014-07-23T10:07:11Z", "creator": "cedric.walter@gmail.com", "creation_time": "2014-07-23T10:07:11Z", "is_private": false, "attachment_id": null}]