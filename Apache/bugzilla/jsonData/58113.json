[{"count": 0, "tags": [], "creator": "scottd@fluidlife.com", "attachment_id": null, "is_private": false, "id": 183946, "time": "2015-07-07T20:18:01Z", "bug_id": 58113, "creation_time": "2015-07-07T20:18:01Z", "text": "Test code below works fine in version 3.11, gives null pointer exception in 3.12:\n\nWorkbook wb = new SXSSFWorkbook();\nSheet sheet = wb.createSheet( \"Test\" );\n\nRow row = sheet.createRow( 0 );\nrow.setHeightInPoints( 16.00f );\n\nCell cell = row.createCell( 0 );\nString str = null;\ncell.setCellValue( str );\n\nAccording to the documentation null should be a valid: \n\n\"value - value to set the cell to. For formulas we'll set the formula string, for String cells we'll set its value. For other types we will change the cell to a string cell and set its value. If value is null then we will change the cell to a Blank cell.\"\n\nAfter downloading the source for 3.11 and 3.12, the problem is pretty clear, it's now trying to check the length of value without checking if it's null first.\n\n3.11:\npublic void setCellValue(String value)\n{\n    ensureTypeOrFormulaType(CELL_TYPE_STRING);\n    if(_value.getType()==CELL_TYPE_FORMULA)\n        ((StringFormulaValue)_value).setPreEvaluatedValue(value);\n    else\n        ((PlainStringValue)_value).setValue(value);\n}\n\n3.12:\npublic void setCellValue(String value)\n{\n    ensureTypeOrFormulaType(CELL_TYPE_STRING);\n        \n    if(value.length() > SpreadsheetVersion.EXCEL2007.getMaxTextLength()){\n        throw new IllegalArgumentException(\"The maximum length of cell contents (text) is 32,767 characters\");\n    }\n\n    if(_value.getType()==CELL_TYPE_FORMULA)\n        ((StringFormulaValue)_value).setPreEvaluatedValue(value);\n    else\n        ((PlainStringValue)_value).setValue(value);\n}"}, {"count": 1, "tags": [], "bug_id": 58113, "text": "Fixed via r1690652, we now allow null-values again and have unit tests for all variants (HSSF, XSSF, SXSSF) which verify that it works.", "id": 184011, "time": "2015-07-13T12:58:47Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-07-13T12:58:47Z", "is_private": false, "attachment_id": null}]