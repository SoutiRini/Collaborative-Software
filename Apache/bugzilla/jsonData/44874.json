[{"count": 0, "tags": [], "creator": "sssivasankari@hotmail.com", "attachment_id": null, "is_private": false, "id": 115875, "time": "2008-04-25T08:53:26Z", "bug_id": 44874, "creation_time": "2008-04-25T08:53:26Z", "text": "While engaging rampart module(1.3) for axis2(2.1.3) WSSecurity authentication, rampart internally is looking for Canonicalizer's which get initialized by classes in xmlsec.jar (version used is 1.4.1)\n\nThe initialization of canonicalizer is performed when the rampart module is engaged, and they are used during the runtime addition of WSSecurity to axis2 SOAP message.\n\ncanonicalizer and other config elements stored in the config.xml file inside the xmlsec,  xml-security-src-1_4_1\\xml-security-1_4_1\\src\\org\\apache\\xml\\security\\resource directory is not getting initialized, because of the fact that the following condition in XMLUtils.selectNodes() does not get satisfied anytime:\n\nif (nodeName.equals(sibling.getLocalName())\n    \t\t\t\t&& uri==sibling.getNamespaceURI()) \n\nAs observed the object comparison uri==sibling.getNamespaceURI() will not be true any time, it must have been as a String comparison like the nodeName comparison.\n\nAfter correcting it as:\n\nif (nodeName.equals(sibling.getLocalName())\n    \t\t\t\t&& uriiequals(sibling.getNamespaceURI())) \n\nthe config file got initialized properly and no exception was thrown by rampart.\n\nThe XMLUtils.java has other methods which has the same kind of object comparison for the uri namespace, which also needs this fix.\n\n\n\nFor Reference the Eception stacktrace:\n\norg.apache.xml.security.c14n.InvalidCanonicalizerException: Unknown canonicalizer. No handler installed for URI http://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments\n\n      at org.apache.xml.security.c14n.Canonicalizer.<init>(Unknown Source)\n\n      at org.apache.xml.security.c14n.Canonicalizer.getInstance(Unknown Source)\n\n      at org.apache.xml.security.utils.XMLUtils.outputDOM(Unknown Source)\n\n      at org.apache.rampart.util.Axis2Util.getSOAPEnvelopeFromDOMDocument(Axis2Util.java:209)\n\n      at org.apache.rampart.handler.WSDoAllSender.processBasic(WSDoAllSender.java:218)\n\n      at org.apache.rampart.handler.WSDoAllSender.processMessage(WSDoAllSender.java:64)\n\n      at org.apache.rampart.handler.WSDoAllHandler.invoke(WSDoAllHandler.java:72)\n\n      at org.apache.axis2.engine.Phase.invoke(Phase.java:292)\n\n      at org.apache.axis2.engine.AxisEngine.invoke(AxisEngine.java:212)\n\n      at org.apache.axis2.engine.AxisEngine.send(AxisEngine.java:377)\n\n      at org.apache.axis2.description.OutInAxisOperationClient.send(OutInAxisOperation.java:374)\n\n      at org.apache.axis2.description.OutInAxisOperationClient.executeImpl(OutInAxisOperation.java:211)\n\n      at org.apache.axis2.client.OperationClient.execute(OperationClient.java:163)\n\n      at org.example.types.EcrmInRWSServiceStub.getCustInv(EcrmInRWSServiceStub.java:747)\n\n      at org.apache.jsp.testInRresult_jsp._jspService(testInRresult_jsp.java:107)\n\n      at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:98)\n\n      at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n\n      at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:328)\n\n      at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:315)\n\n      at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:265)\n\n      at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n\n      at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:269)\n\n      at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n\n      at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:210)\n\n      at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:174)\n\n      at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n\n      at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:117)\n\n      at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:108)\n\n      at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:151)\n\n      at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:870)\n\n      at org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:665)\n\n      at org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:528)\n\n      at org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:81)\n\n      at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:685)\n\n      at java.lang.Thread.run(Unknown Source)\n\n\nThanks\nShiv"}, {"count": 1, "tags": [], "creator": "sean.mullan@oracle.com", "attachment_id": null, "is_private": false, "id": 115894, "time": "2008-04-25T13:07:30Z", "bug_id": 44874, "creation_time": "2008-04-25T13:07:30Z", "text": "See https://issues.apache.org/bugzilla/show_bug.cgi?id=40897 for more discussion about this issue and why XMLSec is implemented the way it is. \n\nIn 1.4.2 there will be an  \norg.apache.xml.utils.ElementChecker interface and you can implement the\nguaranteeThatElementInCorrectSpace method and compare the namespaces using the\nequals method.\n\nWe still need to add a mechanism to allow you to specify your own ElementChecker from an application though. Right now you would have to modify the ElementProxy source to use a different one.\n"}, {"text": "\nThis is a duplicate of Bug 40897, and is now fixed.\n\nColm.\n\n*** This bug has been marked as a duplicate of bug 40897 ***", "tags": [], "bug_id": 44874, "attachment_id": null, "count": 2, "id": 140789, "time": "2010-10-17T14:55:21Z", "creator": "coheigea@apache.org", "creation_time": "2010-10-17T14:55:21Z", "is_private": false}]