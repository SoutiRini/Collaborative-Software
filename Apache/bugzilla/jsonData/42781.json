[{"count": 0, "tags": [], "bug_id": 42781, "attachment_id": null, "is_private": false, "id": 104911, "time": "2007-06-29T09:24:27Z", "creator": "ew@omikron.net", "creation_time": "2007-06-29T09:24:27Z", "text": "If task scp with sftp enabled is used, and the remote dir name contains \"~\"\n(example: ~/), the task will fail with an \"No such file\" exception. I spent two\nhours searching for the reason. The exception should be more meaningful.\n\nAdditionally the scp task will fail if the remote dir does not exist. The remote\ndir should be created automatically if it does not exist.\n\nHere is the patch for the changes I made on\norg.apache.tools.ant.taskdefs.optional.ssh.ScpToMessageBySftp.java:\n\n148a149\n> \t\t\t// change dir on remote machine to the upload dir. create it if it does not\nexist\n149a151,158\n> \t\t        try {\n> \t\t            channel.stat(remotePath);\n> \t\t        } catch (SftpException e) {\n> \t\t            // dir does not exist.\n> \t\t            if (e.id == ChannelSftp.SSH_FX_NO_SUCH_FILE) {\n> \t\t                channel.mkdir(remotePath);\n> \t\t            }\n> \t\t        }\n150a160,165\n>             } catch (SftpException e) {\n>             \tthrow new JSchException(\"failed changing remote dir to\n'\"+remotePath+\"': \"+e.toString());\n>         \t}\n> \n>         \tDirectory current = null;\n>         \ttry {\n152c167\n<                     Directory current = (Directory) i.next();\n---\n>                     current = (Directory) i.next();\n156c171,175\n<                 throw new JSchException(e.toString());\n---\n>             \tif (current != null) {\n>                 \tthrow new JSchException(e.toString()+\" during sending\ndirectory '\"+current.getDirectory().getName()+\"'\");\n>                 } else {\n>                 \tthrow new JSchException(e.toString());\n>                 }"}, {"count": 1, "tags": [], "text": "subversion revision 677211", "is_private": false, "id": 118698, "creator": "bodewig@apache.org", "time": "2008-07-16T02:33:04Z", "bug_id": 42781, "creation_time": "2008-07-16T02:33:04Z", "attachment_id": null}]