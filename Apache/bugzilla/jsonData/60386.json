[{"count": 0, "tags": [], "bug_id": 60386, "attachment_id": null, "is_private": false, "id": 195056, "time": "2016-11-17T04:33:52Z", "creator": "katzyn@gmail.com", "creation_time": "2016-11-17T04:33:52Z", "text": "If F5 is pressed and holded on some page accessed via HTTP/2 in Chromium 54, Tomcat produces warnings.\n\n6:57:23 AM org.apache.coyote.http2.Http2UpgradeHandler pruneClosedStreams\nWARNING: Connection [297] Failed to fully prune the connection because streams were active / used in the priority tree. There are [8] too many streams\n6:57:37 AM org.apache.coyote.http2.Http2UpgradeHandler pruneClosedStreams\nWARNING: Connection [297] Failed to fully prune the connection because streams were active / used in the priority tree. There are [18] too many streams\n.....\n7:01:13 AM org.apache.coyote.http2.Http2UpgradeHandler pruneClosedStreams\nWARNING: Connection [297] Failed to fully prune the connection because streams were active / used in the priority tree. There are [678] too many stream\n\nThis issue is not reproducible with Firefox 49.\n\nIt may be a browser bug, but anyway this sutuation should be handled without much noise on production servers."}, {"count": 1, "tags": [], "creator": "remm@apache.org", "is_private": false, "text": "(In reply to Evgenij Ryazanov from comment #0)\n> It may be a browser bug, but anyway this sutuation should be handled without\n> much noise on production servers.\n\nI disagree with that. This looks to me like rather legitimate logging. If you don't like it, you should adjust the log category level, but no change will be made in Tomcat about this.\n\nWe will determine if the rest is a bug or a client issue (in such a scenario, it could simply abruptly disconnect).", "id": 195059, "time": "2016-11-17T08:34:47Z", "bug_id": 60386, "creation_time": "2016-11-17T08:34:47Z", "attachment_id": null}, {"count": 2, "tags": [], "creator": "katzyn@gmail.com", "is_private": false, "id": 195071, "attachment_id": null, "bug_id": 60386, "creation_time": "2016-11-18T00:44:11Z", "time": "2016-11-18T00:44:11Z", "text": "The only issue with logging is that single one connection produces a lot of similar records and all of them have WARNING level, from my point of view it's may be better to log following at DEBUG level.\n\nBut this bug report is not about log pollution. Number of streams can increase beyond any reasonable limit and this can be used by malicious client to exhaust resources on server. Also it's not clear for me why regular web browser creates so many streams, it's browser's fault, or something wrong with streams on server side?"}, {"count": 3, "tags": [], "bug_id": 60386, "text": "Chrome structures the priority tree in an unexpected way so Tomcat is unable to prune it. I'm in the process of writing a more sophisticated pruning algorithm.", "id": 195182, "attachment_id": null, "creator": "markt@apache.org", "creation_time": "2016-11-24T11:50:23Z", "time": "2016-11-24T11:50:23Z", "is_private": false}, {"count": 4, "attachment_id": null, "creator": "markt@apache.org", "is_private": false, "id": 195185, "time": "2016-11-24T14:42:05Z", "bug_id": 60386, "creation_time": "2016-11-24T14:42:05Z", "tags": [], "text": "Fixed in:\n- trunk for 9.0.0.M14 onwards\n- 8.5.x for 8.5.9 onwards"}]