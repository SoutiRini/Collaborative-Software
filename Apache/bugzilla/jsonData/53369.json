[{"count": 0, "tags": [], "bug_id": 53369, "attachment_id": null, "id": 159740, "time": "2012-06-06T03:32:59Z", "creator": "orion@cora.nwra.com", "creation_time": "2012-06-06T03:32:59Z", "is_private": false, "text": "Trying to build apache-poi 3.8 for Fedora 17 with openjdk 1.7.0 I'm getting the following failure:\n\ncompile-ooxml-lite:\n     [java] Collecting unit tests from /export/home/orion/fedora/apache-poi/poi-3.8/build/ooxml-test-classes\n     [java] ......F...................................\n     [java] .........................................\n     [java] .........................................\n     [java] .........................................\n     [java] .........................................\n     [java] .........................................\n     [java] .........................................\n     [java] .........................................\n     [java] .........................................\n     [java] .........................................\n     [java] .........................................\n     [java] .........................................\n     [java] .........................................\n     [java] .........................................\n     [java] .........................................\n     [java] .........................................\n     [java] .........................................\n     [java] .........................................\n     [java] .........................................\n     [java] ...................................\n     [java] Time: 163.944\n     [java] There was 1 failure:\n     [java] 1) testDateFormat(org.apache.poi.ss.format.TestCellFormatPart)junit.framework.ComparisonFailure: format \"org.apache.poi.ss.format.CellFormatPart@dbcd0e\" expected:<\"11-10-[]52\"> but was:<\"11-10-[19]52\">\n     [java]     at org.apache.poi.ss.format.CellFormatTestBase$CellValue.equivalent(CellFormatTestBase.java:95)\n     [java]     at org.apache.poi.ss.format.CellFormatTestBase.tryColor(CellFormatTestBase.java:247)\n     [java]     at org.apache.poi.ss.format.CellFormatTestBase.tryFormat(CellFormatTestBase.java:221)\n     [java]     at org.apache.poi.ss.format.CellFormatTestBase.runFormatTests(CellFormatTestBase.java:130)\n     [java]     at org.apache.poi.ss.format.TestCellFormatPart.testDateFormat(TestCellFormatPart.java:77)\n     [java]     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n     [java]     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n     [java]     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n     [java]     at org.apache.poi.util.OOXMLLite.build(OOXMLLite.java:103)\n     [java]     at org.apache.poi.util.OOXMLLite.main(OOXMLLite.java:78)\n     [java] \n     [java] FAILURES!!!\n     [java] Tests run: 814,  Failures: 1,  Errors: 0\n\n\n\n    [junit] Running org.apache.poi.ss.format.TestCellFormatPart\n    [junit] Tests run: 2, Failures: 1, Errors: 0, Time elapsed: 1.732 sec\n\nLet me know if there is anything else I can provide."}, {"attachment_id": null, "tags": [], "creator": "yegor@dinom.ru", "text": "It looks like POI does not build on JDK 1.7\n\nI was able to reproduce the trouble with Oracle JDK 1.7.01. Same test fails, only the message is a bit different:\n\n    [java] There was 1 failure:\n    [java] 1) testDateFormat(org.apache.poi.ss.format.TestCellFormatPart)junit.framework.ComparisonFailure: format \"org\napache.poi.ss.format.CellFormatPart@289e637e\" expected:<......> but was:<...19...>\n    [java]     at org.apache.poi.ss.format.CellFormatTestBase$CellValue.equivalent(CellFormatTestBase.java:95)\n    [java]     at org.apache.poi.ss.format.CellFormatTestBase.tryColor(CellFormatTestBase.java:247)\n    [java]     at org.apache.poi.ss.format.CellFormatTestBase.tryFormat(CellFormatTestBase.java:221)\n    [java]     at org.apache.poi.ss.format.CellFormatTestBase.runFormatTests(CellFormatTestBase.java:130)\n    [java]     at org.apache.poi.ss.format.TestCellFormatPart.testDateFormat(TestCellFormatPart.java:77)\n    [java]     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    [java]     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n    [java]     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    [java]     at org.apache.poi.util.OOXMLLite.build(OOXMLLite.java:103)\n    [java]     at org.apache.poi.util.OOXMLLite.main(OOXMLLite.java:78)\n    [java]", "count": 1, "id": 159745, "time": "2012-06-06T07:04:51Z", "bug_id": 53369, "creation_time": "2012-06-06T07:04:51Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 53369, "attachment_id": null, "id": 159748, "time": "2012-06-06T09:11:52Z", "creator": "apache@gagravarr.org", "creation_time": "2012-06-06T09:11:52Z", "is_private": false, "text": "I can confirm the same issue with OpenJDK 1.7\n\njava version \"1.7.0_03\"\nOpenJDK Runtime Environment (IcedTea7 2.1.1pre) (7~u3-2.1.1~pre1-1ubuntu3)\nOpenJDK 64-Bit Server VM (build 22.0-b10, mixed mode)\n\n    [junit] Running org.apache.poi.ss.format.TestCellFormatPart\n    [junit] Tests run: 3, Failures: 1, Errors: 0, Time elapsed: 0.247 sec\n\njunit.framework.ComparisonFailure: format \"org.apache.poi.ss.format.CellFormatPart@416ba050\" expected:<......> but was:<...19...>\n\nIs anyone able to get their IDE running with Java 1.7, and debug / step in to work out exactly what is going wrong and where?"}, {"attachment_id": null, "tags": [], "creator": "yegor@dinom.ru", "text": "I put this bug in my punch list.", "count": 3, "id": 159749, "time": "2012-06-06T09:16:31Z", "bug_id": 53369, "creation_time": "2012-06-06T09:16:31Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 53369, "text": "I can confirm the same issue with JDK1.7\njava version \"1.7.0\"\nJava(TM) SE Runtime Environment (build 1.7.0-b147)\nJava HotSpot(TM) 64-Bit Server VM (build 21.0-b17, mixed mode)\n\n\nIt's coused by SimpleDateFormat format.\n\nnew java.text.SimpleDateFormat(\"d-M-y\").format(new Date()) \nis  \"12-7-2012\",\nbut in excel the format result is \"12-7-12\".\n\nCould fixed in DatePartHandler(org.apache.poi.ss.format.CellDateFormatter).", "id": 160598, "time": "2012-07-12T06:24:09Z", "creator": "makeit2008@gmail.com", "creation_time": "2012-07-12T06:24:09Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "makeit2008@gmail.com", "text": "\nI fixed it simply by change \ndateFmt = new SimpleDateFormat(descBuf.toString());\nto \ndateFmt = new SimpleDateFormat(\n  descBuf.toString().replaceAll(\"((y)(?!y))(?<!yy)\", \"yy\"),LOCALE.US);\nin org.apache.poi.ss.format.CellDateFormatter at line 153.", "id": 160600, "time": "2012-07-12T08:08:29Z", "bug_id": 53369, "creation_time": "2012-07-12T08:08:29Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 53369, "attachment_id": 29059, "text": "Created attachment 29059\njdk17 patch\n\nThat fixes the build for me.  Attached a patch.", "id": 160630, "time": "2012-07-13T23:08:25Z", "creator": "orion@cora.nwra.com", "creation_time": "2012-07-13T23:08:25Z", "is_private": false}, {"count": 7, "tags": [], "creator": "yegor@dinom.ru", "text": "Thanks for the patch, applied in r1364058\n\nRegards,\nYegor", "id": 160769, "time": "2012-07-21T10:08:37Z", "bug_id": 53369, "creation_time": "2012-07-21T10:08:37Z", "is_private": false, "attachment_id": null}]