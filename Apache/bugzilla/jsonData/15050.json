[{"count": 0, "tags": [], "creator": "kamoshida.toshiaki@future.co.jp", "is_private": false, "text": "Hello,\n\nWhen I tried to clone a sheet by calling HSSFWorkbook#cloneSheet(int), \nHSSFWorkbook#cloneSheet(int) throws RuntimeException from \norg.apache.poi.hssf.record.Record#clone(),because some subclasses of \norg.apache.poi.hssf.record.Record has no individual implementation of clone() \nmethod.", "id": 27379, "time": "2002-12-04T05:27:11Z", "bug_id": 15050, "creation_time": "2002-12-04T05:27:11Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 15050, "text": "Created attachment 4036\nTo Fix simply is,Record implements Cloneable.", "id": 27381, "attachment_id": 4036, "creator": "kamoshida.toshiaki@future.co.jp", "creation_time": "2002-12-04T05:30:00Z", "time": "2002-12-04T05:30:00Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 15050, "text": "Cloneable is very convenience.\nIf one subclass's instance has only primitive or immutable object's reference \nfields,it is no need to override clone() method,each fields are automatically \ncopied on native method at java.lang.Object,and there is no other bad effects.", "id": 27387, "time": "2002-12-04T05:45:42Z", "creator": "kamoshida.toshiaki@future.co.jp", "creation_time": "2002-12-04T05:45:42Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 15050, "text": "1. Can u please supply a simple testcase for this error? \n\n2. Anybody has any objections to my applying this? I tend to agree that Record\nshould implement cloneable, but am not very conversant with the cloneSheet\nimplementation (All the more reason why there should be a test case!!)", "id": 27706, "time": "2002-12-12T08:43:59Z", "creator": "avik@apache.org", "creation_time": "2002-12-12T08:43:59Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "text": "Created attachment 4140\nThis is minimum testcase to \"find\" this problem,but not enough for this patch...", "attachment_id": 4140, "id": 27711, "creator": "kamoshida.toshiaki@future.co.jp", "time": "2002-12-12T10:13:15Z", "bug_id": 15050, "creation_time": "2002-12-12T10:13:15Z", "is_private": false}, {"count": 5, "tags": [], "creator": "kamoshida.toshiaki@future.co.jp", "is_private": false, "text": "When I set a breakpoint at org.apache.poi.hssf.record.Record#clone(),\nand execute cloneSheet() by using \"My\" Excel file on a debuggar,I found there \nis no implementation of clone() at thease classes.If the target sheet has one \nof them,cloneSheet() will fail.\n\n1. org.apache.poi.hssf.record.MargeCellsRecord\n2. org.apache.poi.hssf.record.ColumnInfoRecord\n3. org.apache.poi.hssf.record.BottomMarginRecord\n4. org.apache.poi.hssf.record.LeftMarginRecord\n5. org.apache.poi.hssf.record.RightMarginRecord\n6. org.apache.poi.hssf.record.TopMarginRecord\n\nMaybe some other classes are same,I don't know.\n\nI feel,the testcase for this patch should use a sheet that has at least one \ninstance of all each Record's subclass.But I can't create it easily. Please \nsomeone make it:)\n", "id": 27713, "time": "2002-12-12T10:51:01Z", "bug_id": 15050, "creation_time": "2002-12-12T10:51:01Z", "attachment_id": null}, {"count": 6, "tags": [], "text": "thanks. thats what i wanted .. to be sure i am not solving the wrong problem. \n\nI tend to agree that getting Record to implement cloneable should be a simple\nfix without too many side effects. I'll wait a while to see if Jason (who\nimplemented most of the cloning stuff) has any alternate ideas, and then go\nahead (hopefully with some unit tests)", "is_private": false, "id": 27723, "creator": "avik@apache.org", "time": "2002-12-12T12:49:36Z", "bug_id": 15050, "creation_time": "2002-12-12T12:49:36Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 15050, "text": "This is a duplicate of #14487, which I created. However, this one now has more\ninfo, so if you want to mark #14487 as the duplicate, feel free.", "id": 27735, "time": "2002-12-12T14:17:09Z", "creator": "dennis@righthandmanager.com", "creation_time": "2002-12-12T14:17:09Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 15050, "text": "OK I originally wrote the cloneSheet implementation.\n\nThe reason for not implementing clonable was that at the time I did not know \nwhich records were sheet based and which are workbook based. As such i wanted \nto know which records i still needed to implement. Instead of making Record \nimplement Clonable it may be better to fix the records that dont have their own \nclone method.\n\nInitially there was some debate whether a shallow clone is appropriate (ie by \nimplementing Clonable), and the suggestion from the list (Andy?) was to perform \ndeep clones, which is how it is done.\n\nJason", "id": 27755, "time": "2002-12-12T20:41:20Z", "creator": "jheight@apache.org", "creation_time": "2002-12-12T20:41:20Z", "is_private": false, "attachment_id": null}, {"count": 9, "tags": [], "text": "Oh I forgot to mention, I did initially implement shallow clones and that \nworked fine. If my memory serves me its only the aggregate records that need to \nbe deep cloned. \n\nI can implement the extra Records listed in this bug report next week if you \nwant, or we can just implement Clonable and hope for the best.\n\nJason", "attachment_id": null, "id": 27756, "creator": "jheight@apache.org", "time": "2002-12-12T20:53:16Z", "bug_id": 15050, "creation_time": "2002-12-12T20:53:16Z", "is_private": false}, {"count": 10, "tags": [], "bug_id": 15050, "text": "*** Bug 14487 has been marked as a duplicate of this bug. ***", "id": 27781, "time": "2002-12-13T04:49:15Z", "creator": "avik@apache.org", "creation_time": "2002-12-13T04:49:15Z", "is_private": false, "attachment_id": null}, {"count": 11, "tags": [], "creator": "avik@apache.org", "is_private": false, "text": "I'll only be able to look at it next weekend, so if you can do something next\nweek, go ahead. ", "id": 27782, "time": "2002-12-13T04:53:15Z", "bug_id": 15050, "creation_time": "2002-12-13T04:53:15Z", "attachment_id": null}, {"count": 12, "tags": [], "text": "Shawn does this work?", "is_private": false, "id": 28282, "creator": "poi-support@buni.org", "time": "2002-12-27T04:58:06Z", "bug_id": 15050, "creation_time": "2002-12-27T04:58:06Z", "attachment_id": null}, {"count": 13, "tags": [], "creator": "avik@apache.org", "is_private": false, "text": "*** Bug 17474 has been marked as a duplicate of this bug. ***", "id": 32080, "time": "2003-02-27T13:32:54Z", "bug_id": 15050, "creation_time": "2003-02-27T13:32:54Z", "attachment_id": null}, {"count": 14, "tags": [], "creator": "avik@apache.org", "is_private": false, "text": "*** Bug 17540 has been marked as a duplicate of this bug. ***", "id": 32220, "time": "2003-03-01T14:30:15Z", "bug_id": 15050, "creation_time": "2003-03-01T14:30:15Z", "attachment_id": null}, {"count": 15, "tags": [], "bug_id": 15050, "text": "fixed, afaik, with all records mentioned herein. ", "id": 32221, "time": "2003-03-01T14:32:09Z", "creator": "avik@apache.org", "creation_time": "2003-03-01T14:32:09Z", "is_private": false, "attachment_id": null}, {"count": 16, "attachment_id": null, "bug_id": 15050, "text": "This class needs a clone() Method too:\n\norg.apache.poi.hssf.record.aggregates.FormulaRecordAggregate\n", "id": 32472, "time": "2003-03-05T16:51:44Z", "creator": "ndz43wv02@sneakemail.com", "creation_time": "2003-03-05T16:51:44Z", "tags": [], "is_private": false}, {"count": 17, "tags": [], "bug_id": 15050, "text": "Created attachment 5441\nAdded clone Method for org.apache.poi.hssf.record.aggregates.FormulaRecordAggregate", "id": 33533, "attachment_id": 5441, "creator": "ndz43wv02@sneakemail.com", "creation_time": "2003-03-20T10:20:56Z", "time": "2003-03-20T10:20:56Z", "is_private": false}, {"count": 18, "tags": [], "bug_id": 15050, "attachment_id": null, "text": "Modified version comitted (made it deeper clone). Thanks Henning. \nPls cross check. ", "id": 33566, "time": "2003-03-20T20:03:51Z", "creator": "avik@apache.org", "creation_time": "2003-03-20T20:03:51Z", "is_private": false}]