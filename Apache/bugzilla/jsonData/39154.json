[{"count": 0, "tags": [], "bug_id": 39154, "attachment_id": null, "text": "I have a problem with apache 2.2.0 + mod_ssl and mod_dav\nIf I try to upload a file over a Client-Certificate secured connection to\nWebdav-folder on Apache-Server, I get a unspecified error on the Webdav-client\n(MS Explorer) and a \u201crequest body exceeds maximum size for SSL buffer\u201d-error on\nthe Apache-side. \nIf I\u2019 take off the Client-Certificate-Authentication everything works fine.\n\nI think that is a bug in the mod_ssl module.\n\nThank's\nGregory\n\n\n----------------\nLogfile:\n\nError.log\n[Thu Mar 30 13:25:26 2006] [error] [client 217.228.63.33] request body exceeds\nmaximum size for SSL buffer\n[Thu Mar 30 13:25:26 2006] [error] [client 217.228.63.33] could not buffer\nmessage body to allow SSL renegotiation to proceed\n\naccess.log\n217.228.63.33 - - [30/Mar/2006:13:25:15 +0200] \"PROPFIND /freunde/upload/test\nHTTP/1.1\" 207 853 \"-\" \"Microsoft Data Access Internet Publishing Provider DAV\"\n217.228.63.33 - - [30/Mar/2006:13:25:15 +0200] \"PROPFIND /freunde/upload/test\nHTTP/1.1\" 207 963 \"-\" \"Microsoft Data Access Internet Publishing Provider DAV\"\n217.228.63.33 - - [30/Mar/2006:13:25:20 +0200] \"HEAD\n/freunde/upload/test/test.jpg HTTP/1.1\" 404 - \"-\" \"Microsoft Data Access\nInternet Publishing Provider DAV\"\n217.228.63.33 - - [30/Mar/2006:13:25:20 +0200] \"PUT\n/freunde/upload/test/test.jpg HTTP/1.1\" 413 1090 \"-\" \"Microsoft Data Access\nInternet Publishing Provider DAV\"\n\n----------------\nConfiguration:\nhttp.conf:\n\n\u2026\n<VirtualHost 80.xx.xx.xx:443>\n\tServerName   www.xxxxxxx.de\n\n\tDocumentRoot /home/xxxxxxx.de/httpsdocs\n\tCustomLog  /home/xxxxxxx.de/statistics/logs/access_ssl.log \n       CustomLog /home/xxxxxxx.de/statistics/logs/request_ssl.log \\\n                    \"%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \\\"%r\\\" %b\"\n\tErrorLog     /home/xxxxxxx.de/statistics/logs/error_ssl.log\n\n\tSSLEngine on\t\t\n\tSSLOptions +StrictRequire \t\n. . . \nDavLockDB /home/xxxxxx.de/conf/webdav/lockdb\n\nAlias /freunde/upload /home/xxxxxx.de/webdav/freunde\n    \t<Directory  /home/xxxxxx.de/webdav/freunde>\n\t\tSSLVerifyClient require\n\t\tSSLRequire (%{SSL_CIPHER} !~ m/^(EXP|NULL)/ and %{SSL_CLIENT_S_DN_O} eq\n\"Xxxxxx\" &&  %{SSL_CLIENT_S_DN_CN} in {\"Gregor Meinusch\"} )\n\t\t     \n  \t       Dav On\n\t\t<LimitExcept GET HEAD OPTIONS>       \n\t\t</LimitExcept>\t  \t\t\t\n\t\t\n\t\tOptions +SymLinksIfOwnerMatch -Includes -ExecCGI\n\t</Directory>\n\n. . .\n</virtualhost>\n\n\n\nSsl-global.conf\nAddType application/x-x509-ca-cert .crt\n\tAddType application/x-pkcs7-crl    .crl\n\tSSLPassPhraseDialog  builtin\n\n\t\n\t#SSLSessionCache        nonenotnull\n\t#SSLSessionCache         dbm:/var/lib/apache2/ssl_cache \n\t#SSLSessionCache          shmht:/var/lib/apache2/ssl_scache(512000)\n\t#SSLSessionCache \t\tshm:/var/lib/apache2/ssl_cache(512000)\n\tSSLSessionCache         shmcb:/var/lib/apache2/ssl_scache\n\tSSLSessionCacheTimeout  600\n\n\tSSLMutex  file:/var/lib/apache2/ssl_mutex\n\tSSLMutex  sem\n\t\n\tSSLCipherSuite ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL\n        SSLProtocol all -SSLv2\t\n\n\tSSLCertificateFile \t/home/xxxxxx.de/conf/certificates/www.xxx.de.cert\n\tSSLCertificateKeyFile \t/home/xxxxxx.de/conf/certificates/www.xxx.de.key\n\tSSLCACertificateFile \t/home/xxxxxx.de/conf/certificates/cacerts.pem\n\tSSLVerifyDepth  2\n\n\tSSLRandomSeed startup builtin\n\tSSLRandomSeed connect builtin", "id": 87428, "time": "2006-03-30T14:46:35Z", "creator": "gmeinusch@yahoo.de", "creation_time": "2006-03-30T14:46:35Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 39154, "attachment_id": null, "text": "This does not work on directory level with large files, because we currently do\nnot buffer the request body on disk but only 128k at max in memory. Moving\nSSLVerifyClient require to virtual host level will make it work (see also PR12355)\n\n*** This bug has been marked as a duplicate of 12355 ***", "id": 87440, "time": "2006-03-30T21:16:14Z", "creator": "rpluem@apache.org", "creation_time": "2006-03-30T21:16:14Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 39154, "attachment_id": null, "text": "Thank you! Now it works perfectly! ", "id": 87460, "time": "2006-03-31T07:12:03Z", "creator": "gmeinusch@yahoo.de", "creation_time": "2006-03-31T07:12:03Z", "is_private": false}]