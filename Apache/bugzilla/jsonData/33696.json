[{"count": 0, "tags": [], "bug_id": 33696, "text": "The rotatelogs support executable cannot find libgcc_s.so.1 when started by \napache, but runs fine from the command line.  Here is the error output:\n\npiped log program ' /usr/apps/apache/apache-\n2.0.53+rsa/bin/rotatelogs /usr/apps/apache/apache-2.0.53+rsa/logs/access_log' \nfailed unexpectedly\nld.so.1: /usr/apps/apache/apache-2.0.53+rsa/bin/rotatelogs: fatal: \nlibgcc_s.so.1: open failed: No such file or directory\n\nAnd this is the directive in question (from httpd.conf):\nCustomLog \"| /usr/apps/apache/apache-\n2.0.53+rsa/bin/rotatelogs /usr/apps/apache/apache-2.0.53+rsa/logs/access_log\" \ncommon\n\nI have found the problem only with 2.0.53, and have been able to reproduce it \non the same box with a clean build, and another similar box (both are running \nSolaris 9 on Sun hardware).  2.0.52 does NOT have this problem.\n\nThe configuration for this build is this:\n\n./configure --prefix=/usr/apps/apache/apache-2.0.53+rsa --enable-proxy --enable-\nproxy-http --with-mpm=worker --enable-so --with-ssl=/usr/local/ssl\n\nThe LD_LIBRARY_PATH is:\n\n/usr/lib:/usr/local/ssl/lib:/usr/local/lib\n\nWhen running rotatelogs at the command line, there is no error (just the simple \nusage message, or output written to a file if run in a similar fashion to \nCustomLog directive), and it behaves as expected.\n\nI tried replacing the rotatelogs binary with the one from a 2.0.52 \ninstallation, and my error log shows repeated output of the \"usage\" message as \nthough the executable were run from the command line with no parameters.\n\nGCC version:\n\ngcc (GCC) 3.4.2\n\n-Jim Boehmer", "id": 71363, "time": "2005-02-22T19:30:02Z", "creator": "James.Boehmer@verizonwireless.com", "creation_time": "2005-02-22T19:30:02Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "text": "Set LD_LIBRARY_PATH to the path in the GCC installation tree where libgcc_s.so.1\nis found, or build GCC using --disable-shared so that you don't get a shared\nlibgcc, etc.", "attachment_id": null, "id": 71384, "creation_time": "2005-02-23T11:50:43Z", "time": "2005-02-23T11:50:43Z", "creator": "jorton@redhat.com", "bug_id": 33696, "is_private": false}, {"count": 2, "attachment_id": null, "bug_id": 33696, "text": "(In reply to comment #1)\n> Set LD_LIBRARY_PATH to the path in the GCC installation tree where\n> libgcc_s.so.1 is found,\n\nlibgcc_s.so.1 is already in the LD_LIBRARY_PATH.  I've tried making its \ndirectory the only one in the ld_library_path to no avail.  I'm still inclined \nto believe this is a bug in 2.0.53, given that 2.0.52 works as expected in the \nexact same environment, with the exact same build configuration.\n\n> or build GCC using --disable-shared so that you don't get a shared\n> libgcc, etc.\n\nUnfortunately for me, rebuilding GCC is not an option (so say the powers that \nbe), perhaps someone with a similar environment could try this?  I'm pretty \ncertain rebuilding GCC without the shared libraries would break many \napplications anyway, and seems like the wrong (and long) way around.  I'm going \nto reopen the bug once more just to see if anyone else is having this problem \nin a solaris environment.", "id": 71392, "time": "2005-02-23T14:01:26Z", "creator": "James.Boehmer@verizonwireless.com", "creation_time": "2005-02-23T14:01:26Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "bug_id": 33696, "attachment_id": null, "id": 71394, "time": "2005-02-23T14:11:00Z", "creator": "jorton@redhat.com", "creation_time": "2005-02-23T14:11:00Z", "is_private": false, "text": "Oh, sorry, this is the piped-loggers-don't-inherit-the-environment bug, right,\nmy mistake.\n\nYou can work around it by e.g setting LD_RUN_PATH=/path/to/my/gcc/libs during\nthe build so that the binaries all get a hard-coded RPATH.  \n\nAlternatively try the patch:\n\nhttp://svn.apache.org/viewcvs.cgi/httpd/httpd/trunk/server/log.c?rev=103796&r1=103627&r2=103796&diff_format=u"}, {"count": 4, "tags": [], "bug_id": 33696, "attachment_id": null, "text": "That patch worked like a charm.  I can't find the original bug (presuming this \nis a duplicate), so I'll just mark it resolved with a big thanks!", "id": 71398, "time": "2005-02-23T14:47:47Z", "creator": "James.Boehmer@verizonwireless.com", "creation_time": "2005-02-23T14:47:47Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 33696, "attachment_id": null, "id": 77043, "time": "2005-07-06T18:22:43Z", "creator": "jorton@redhat.com", "creation_time": "2005-07-06T18:22:43Z", "is_private": false, "text": "*** Bug 35624 has been marked as a duplicate of this bug. ***"}]