[{"count": 0, "tags": [], "bug_id": 14118, "is_private": false, "text": "This happens on both Windows 2000 and XP.\nThis doesn't happen under JRE 1.3.0.  It does happen under JRE 1.4.0\nand 1.4.0_02.\n\nI have a single servlet inside Tomcat.  It does... well... a lot.  Too much\nto really describe in a bug here.  And so far, I can't narrow down a test\ncase too well, but I thought I'd throw in yet another bug against the NT\nService.  I suspect, because the timing is not always the same, that the \nJVM may die mid-gc or something similar.\n\nTomcat runs never crashes when I start it \"by hand\" via any of the scripts or\nvia the start menu items the installer creates that invoke java similarly.\n\nHowever, quite reliably, after a few uses of the servlet, the JRE/Tomcat\nwill reliably disappear completely when started as an NT Service.  \nI'm not really sure how to debug this either.  I suppose I should drag down a\ncopy of JavaService.exe and use it myself to set the command line options for\nthe JVM, right?", "id": 25416, "time": "2002-10-31T09:27:38Z", "creator": "bloch@clearwellsystems.com", "creation_time": "2002-10-31T09:27:38Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 14118, "attachment_id": null, "id": 25417, "time": "2002-10-31T09:32:03Z", "creator": "remm@apache.org", "creation_time": "2002-10-31T09:32:03Z", "is_private": false, "text": "JVM crashes are VM bugs. If you can identify a specific flaw in Tomcat, please\nlet us know."}, {"count": 2, "tags": [], "creator": "bloch@clearwellsystems.com", "text": "It would help me a lot if you could describe accurately the difference\nbetween the way the tomcat 4.1 NT service invokes the JVM and\nthe way the startup scripts do.  Assume default invocations.  I want\nto eventually pass some gc debugging params to the jvm.\n\nI'm attempting to install the NT service by hand using javaservice.exe\n(which I nabbed from the javaservice website itself; latest bits) \nand when I use (from cygwin)\n\n% JavaService.exe -install \"Apache Tomcat 4.1x\" \\\n          $JAVA_HOME\\\\jre\\\\bin\\\\server\\\\jvm.dll \\\n         -Djava.class.path=\"$TOMCAT_HOME\\\\bin\\\\bootstrap.jar\" \\\n         -Dcatalina.home=\"$TOMCAT_HOME\" \\\n         -Djava.endorsed.dirs=\"$TOMCAT_HOME\\\\common\\\\endorsed\" \\\n         -start org.apache.catalina.startup.BootstrapService \\\n         -params start \\\n         -stop org.apache.catalina.startup.BootstrapService \\\n         -params stop \\  \n         -out \"$TOMCAT_HOME\\\\logs\\\\stdout2.log\" \\\n         -err \"$TOMCAT_HOME\\\\logs\\\\stderr2.log\"\n\n$TOMCAT_HOME is C:\\Tomcat4.1 where I've installed tomcat and\n$JAVA_HOME is C:\\j2sdk1.4.0_02 .\n\nI get the following in stderr2.log\n\nCreated catalinaLoader in: C:\\WINNT\\system32\\server\\lib\njava.lang.ClassNotFoundException: org.apache.catalina.startup.CatalinaService\n        at org.apache.catalina.loader.StandardClassLoader.loadClass(StandardClas\nsLoader.java:992)\n        at org.apache.catalina.loader.StandardClassLoader.loadClass(StandardClas\nsLoader.java:857)\n        at org.apache.catalina.startup.BootstrapService.init(BootstrapService.ja\nva:198)\n        at org.apache.catalina.startup.BootstrapService.main(BootstrapService.ja\nva:297)\njava.lang.NullPointerException\n        at org.apache.catalina.startup.BootstrapService.stop(BootstrapService.ja\nva:259)\n        at org.apache.catalina.startup.BootstrapService.main(BootstrapService.ja\nva:309)\n\nI didn't see this class in the bootstrap.jar and I'm wondering how it's \nspose to be found.\n\nThanks!\n-Eric", "id": 25418, "time": "2002-10-31T09:51:47Z", "bug_id": 14118, "creation_time": "2002-10-31T09:51:47Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 14118, "attachment_id": null, "id": 25421, "time": "2002-10-31T10:19:41Z", "creator": "bloch@clearwellsystems.com", "creation_time": "2002-10-31T10:19:41Z", "is_private": false, "text": "I had a typo in my commandline to JavaService.\nI can now start up tomcat the same way the ntservice does.\n\nI think this is a bug in the ntservice wrapper and not the JVM\nsince the arguments I pass to the ntservice wrapper are precisely\nthe same ones I pass to the startup scripts.\n\nI see numerous similar bugs filed ... all with 'worksforme' or something\nsimilar.  I suspect... as soon as I can get a smaller case... we \ncan find the problem (jvm or windows service code).  The strange\nthing is that there is no error or anything bad that happens.  The process\nsimply disappears.  I'm afraid I'm going to have to build/debug the nt\nservice wrapper myself!\n\n-E\n"}, {"attachment_id": null, "tags": [], "bug_id": 14118, "is_private": false, "count": 4, "id": 25437, "time": "2002-10-31T16:32:02Z", "creator": "lkarpel@eloquent.com", "creation_time": "2002-10-31T16:32:02Z", "text": "Eric ..\n\nWe had similar problems with the 1.4.x VMs. The Tomcat Service would sometimes \njust disappear. Sometimes with a NULL pointer exception without traceback .. \nsometimes without any reason. This problem did not occur with any of the 1.3.x \nVMs.\n\nFor us we were able to 'prove' that this problem ONLY occurs with the \n1.4.x 'server' VMs and did NOT occur with the 'client' VMs. \n\nThat is specifying:\n\n  $JAVA_HOME\\\\jre\\\\bin\\\\client\\\\jvm.dll \n\nfor the VM to be used by the service.\n\nWhen you run by hand you probably are running with the client VM !!"}, {"count": 5, "tags": [], "bug_id": 14118, "is_private": false, "text": "I think this could be a *real* bug in the JavaService bits used\nby Tomcat.  \n\nI do not see the bug if I change the tomcat startup.bat\nscript to point to the server JVM.\n\n-Eric", "id": 25573, "time": "2002-11-03T00:40:10Z", "creator": "bloch@clearwellsystems.com", "creation_time": "2002-11-03T00:40:10Z", "attachment_id": null}, {"count": 6, "tags": [], "text": "I think I may have a related problem.  I'll describe it and you can make the \nappropriate determination.\n\nI have a .jar file that contains an InitialContextFactory class that my webapp \nneeds to use to look up an EJB (in another container).  I tried placing the jar \nfile in the JAVA_HOME\\jre\\lib\\ext directory and if I start tomcat from the \nStartup script everything works fine.  However, if I start tomcat as a service \nit fails to load the class from the .jar file and I get stderr log telling me \nthat it can't instantiate the Factory class.  I tried moving the .jar file to \nthe webapp/{mywebapp}/WEB-INF/lib directory and still the thing happens.  In \norder to get it to work when Tomcat is launched as a service I have to place \nthe jar in the CATALINA_HOME/shared/lib directory, which, I don't believe \nshould be necessary.  Like I indicated above I'm using Tomcat 4.1.12 on XP, \nJAVA_HOME is C:\\j2sdk1.4.1_01.  (BTW It works as it should with my Tomcat 4.0 \ninstallation.)  I hope this is clear.  Thanks.\n\n-- Joe\n", "attachment_id": null, "id": 27508, "creator": "jpantella@comcast.net", "time": "2002-12-07T03:23:15Z", "bug_id": 14118, "creation_time": "2002-12-07T03:23:15Z", "is_private": false}, {"count": 7, "tags": [], "text": "From the comments this is either a JVM or a JavaService bug. Either way, it is \nnot a Tomact bug.", "is_private": false, "id": 53064, "creator": "markt@apache.org", "time": "2004-02-26T22:17:29Z", "bug_id": 14118, "creation_time": "2004-02-26T22:17:29Z", "attachment_id": null}]