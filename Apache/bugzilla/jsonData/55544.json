[{"count": 0, "tags": [], "bug_id": 55544, "is_private": false, "text": "Trying to create an EncryptionInfo from an encrypted Excel 2013 file results in an org.apache.poi.EncryptedDocumentException exception. The hashAlgorithm in the EncryptionHeader of the document is \"SHA512\" and EncryptionHeader has this:\n\n        String hashAlg = keyData.getNamedItem(\"hashAlgorithm\").getNodeValue();\n        int hashSize = Integer.parseInt(keyData.getNamedItem(\"hashSize\")\n                                        .getNodeValue());\n\n        if (\"SHA1\".equals(hashAlg) && hashSize == 20)\n            hashAlgorithm = HASH_SHA1;\n        else\n            throw new EncryptedDocumentException(\"Unsupported hash algorithm\");\n \nWould be good to have support for Excel 2013 documents", "id": 170011, "time": "2013-09-10T18:31:30Z", "creator": "bknippen@abinitio.com", "creation_time": "2013-09-10T18:31:30Z", "attachment_id": null}, {"count": 1, "text": "Could you please upload a small sample file that shows the problem?", "bug_id": 55544, "is_private": false, "id": 170015, "time": "2013-09-10T20:26:45Z", "creator": "apache@gagravarr.org", "creation_time": "2013-09-10T20:26:45Z", "tags": [], "attachment_id": null}, {"count": 2, "tags": [], "creator": "bknippen@abinitio.com", "text": "Created attachment 30816\nexample workbook for reproducing probelm\n\npassword for EncryptedBook.xlsx is: \"this is a test\"", "id": 170031, "time": "2013-09-11T14:00:18Z", "bug_id": 55544, "creation_time": "2013-09-11T14:00:18Z", "is_private": false, "attachment_id": 30816}, {"attachment_id": null, "tags": [], "bug_id": 55544, "text": "As of r1522074 it's hopefully supported. I've added a simple unit test that shows we can now process the header, please re-open the bug if anything further down the line fails with it!", "count": 3, "id": 170053, "time": "2013-09-11T22:24:40Z", "creator": "apache@gagravarr.org", "creation_time": "2013-09-11T22:24:40Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 55544, "attachment_id": 31092, "text": "Created attachment 31092\nanother test case (password \"welcome1\")\n\nGenerated by a third-party server process.\nThe EncryptionInfo says, among other things:\n     keyBits=\"256\" hashSize=\"64\" hashAlgorithm=\"SHA512\"", "id": 171566, "time": "2013-12-04T17:37:13Z", "creator": "jeff@prolifics.com", "creation_time": "2013-12-04T17:37:13Z", "is_private": false}, {"count": 5, "tags": [], "creator": "jeff@prolifics.com", "text": "I have uploaded a new test case, per Andreas' request.  Problem posting in the archive at:\nhttp://mail-archives.apache.org/mod_mbox/poi-user/201311.mbox/%3C6997BC53406F47B4AB0F17A07F2EED83@ad.prolifics.com%3E\n\nAlso, per Andreas' request, I have verified that we are using the correct JCE version.", "id": 171567, "time": "2013-12-04T17:41:59Z", "bug_id": 55544, "creation_time": "2013-12-04T17:41:59Z", "is_private": false, "attachment_id": null}, {"count": 6, "text": "As per #55818 this has been fixed too, so I'm closing this for now.\n\n> Jeff wrote on 21.12.2013 04:34:\n>\n> Short answer:  The code works.\n>\n> Long answer:  The code wasn't working, no matter what JCE files we tried, no matter what JVM we tried.  Then, I wondered whether our test file -- the one with all the birthdays, not the one I had made for you -- was the problem.  I acquired eight more of them and... sure enough they all open just fine.\n>\n> Commit the branch, mark the bug, I'm happy.\n>\n> Jeff", "creator": "kiwiwings@apache.org", "is_private": false, "id": 172849, "time": "2014-02-01T20:34:01Z", "bug_id": 55544, "creation_time": "2014-02-01T20:34:01Z", "tags": [], "attachment_id": null}]