[{"count": 0, "attachment_id": null, "bug_id": 39946, "text": "Given the following build.xml:\n\n<project name=\"x\" default=\"x\">\n  <target name=\"x\">\n    <javac srcdir=\".\" classpath=\"junit-4.1.jar\" />\n    <junit fork=\"true\" timeout=\"100\">\n      <test name=\"x\" />\n      <classpath>\n        <pathelement location=\"junit-4.1.jar\" />\n      </classpath>\n      <formatter type=\"brief\" usefile=\"false\" />\n    </junit>\n  </target>\n</project>\n\nx.java:\n\nimport org.junit.Test;\n\npublic class x {\n    @Test public void foo () {\n        while (true) ;\n    }\n}\n\nAnd junit-4.1.jar in the directory, when executing the build, the following\nerror occurs:\n\n[bmaurer@omega x]$ ../ant/apache-ant-1.7alpha/bin/ant\nBuildfile: build.xml\n\nx:\n\nBUILD FAILED\n/home/bmaurer/x/build.xml:4: Using loader\nAntClassLoader[/home/bmaurer/x/junit-4.1.jar:/home/bmaurer/ant/apache-ant-1.7alpha/lib/ant-launcher.jar:/home/bmaurer/ant/apache-ant-1.7alpha/lib/ant.jar:/home/bmaurer/ant/apache-ant-1.7alpha/lib/ant-junit.jar]\non class org.apache.tools.ant.taskdefs.optional.junit.BriefJUnitResultFormatter:\njava.lang.NoClassDefFoundError: junit/framework/TestListener\n\nTotal time: 0 seconds", "id": 90813, "time": "2006-07-02T18:23:14Z", "creator": "bmaurer@andrew.cmu.edu", "creation_time": "2006-07-02T18:23:14Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 39946, "attachment_id": null, "id": 90814, "time": "2006-07-02T20:49:26Z", "creator": "jkf@apache.org", "creation_time": "2006-07-02T20:49:26Z", "is_private": false, "text": "Have you made sure that junit.jar and the class files for the junit task\n(ant-junit.jar) have been made available from the same source?\n(from the manual:)\n\nNote: You must have junit.jar and the class files for the <junit> task in the\nsame classpath. You can do one of:\n\n   1. Put both junit.jar and the optional tasks jar file in ANT_HOME/lib.\n   2. Do not put either in ANT_HOME/lib, and instead include their locations in\nyour CLASSPATH environment variable.\n   3. Do neither of the above, and instead, specify their locations using a\n<classpath> element in the build file. See the FAQ for details. \n\nYour build file only specifies the junit.jar file in the classpath, and your\nANT_HOME/lib probably only has ant-junit.jar. Please make the two jar files\navailable the same way, and report if it still does not work."}, {"count": 2, "tags": [], "bug_id": 39946, "text": "This is ant 1.7, so I am doing one of the new options added:\n\nLeave ant-junit.jar in its default location in ANT_HOME/lib but include\njunit.jar in the <classpath> passed to <junit>. (since Ant 1.7)\n\nJUnit works fine *except* when there is a timeout. In that case, it will display\nthis error. I assume that the timeout codepath has not been updated for the 1.7\nbehavior.", "id": 90815, "time": "2006-07-02T21:53:49Z", "creator": "bmaurer@andrew.cmu.edu", "creation_time": "2006-07-02T21:53:49Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 39946, "text": "I have applied a fix to HEAD, please verify", "id": 90841, "time": "2006-07-03T20:21:12Z", "creator": "jkf@apache.org", "creation_time": "2006-07-03T20:21:12Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 39946, "attachment_id": null, "id": 90845, "time": "2006-07-03T21:55:13Z", "creator": "bmaurer@andrew.cmu.edu", "creation_time": "2006-07-03T21:55:13Z", "is_private": false, "text": "This is better. However, in the xml file, I get:\n\n\n  <testcase\nclassname=\"org.apache.tools.ant.taskdefs.optional.junit.JUnitTaskMirrorImpl$1\"\nname=\"unknown\" time=\"0.01\">\n\nIdeally, this would be the name of the failing test, or at least some better\nindication of what actually happened."}, {"count": 5, "tags": [], "bug_id": 39946, "text": "The output has been enhanced to include (only!) the testcase that was running \nduring the timeout / unexpected termination.\nPlease next time use a different bug report to report another issue / request, \nand not reuse an existing one, it makes life easier when tracking issues.\n\noutput now:\n  <testcase classname=\"x\" name=\"foo\" time=\"0.0\">\n\n    <error message=\"Timeout occurred. Please note the time in the report does \nnot reflect the time until the timeout.\" \ntype=\"junit.framework.AssertionFailedError\">junit.framework.AssertionFailedErro\nr: Timeout occurred. Please note the time in the report does not reflect the \ntime until the timeout.\n\n</error>\n\n  </testcase>\nand was:\n\n  <testcase \nclassname=\"org.apache.tools.ant.taskdefs.optional.junit.JUnitTaskMirrorImpl$1\" \nname=\"unknown\" time=\"0.0\">\n\n    <error message=\"Timeout occurred\" \ntype=\"junit.framework.AssertionFailedError\">junit.framework.AssertionFailedErro\nr: Timeout occurred.\n\n</error>\n\n  </testcase>\n", "id": 91024, "time": "2006-07-08T21:25:40Z", "creator": "jkf@apache.org", "creation_time": "2006-07-08T21:25:40Z", "is_private": false, "attachment_id": null}]