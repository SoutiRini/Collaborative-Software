[{"count": 0, "tags": [], "bug_id": 47188, "is_private": false, "text": "Created attachment 23648\nAttachment for the bug\n\nXSSFComment comment = sheet.createComment() and then calling\ncell.setCellComment(comment);\n\ncorrupts the workbook.\n\nOpening the workbook gives the following error:\n\nRemoved Records: Comments from /xl/comments1.xml part (Comments)", "id": 126967, "time": "2009-05-12T23:33:58Z", "creator": "vinu.kumar@gmail.com", "creation_time": "2009-05-12T23:33:58Z", "attachment_id": 23648}, {"count": 1, "tags": [], "bug_id": 47188, "text": "the problem should be fixed in r884918.\n\nWas the attached template created by POI? If so, please re-create it using the\nlatest build from trunk. Your template contains comments not having visual\nproperties that are stored in the vmlDrawing.vml part. r884918 fixed this and\nsome other bugs.\n\nYegor", "id": 132459, "time": "2009-11-30T06:45:11Z", "creator": "yegor@dinom.ru", "creation_time": "2009-11-30T06:45:11Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "vinu.kumar@gmail.com", "is_private": false, "count": 2, "id": 132572, "time": "2009-12-01T23:57:41Z", "bug_id": 47188, "creation_time": "2009-12-01T23:57:41Z", "text": "Now setting comment on a xlsx file works!"}, {"count": 3, "tags": [], "creator": "rsingh@ketera.com", "attachment_id": null, "text": "Hi,\nI have tried creating comments in the excel file, using below code\n\nClientAnchor anchor = ch.createClientAnchor();\n                    Comment comment = drawing.createCellComment(anchor);\n                    comment.setString(ch.createRichTextString(alias));\n                    cell.setCellComment(comment);\n\nafter writing the xls and opening the file it gives error \"File error data may have been lost\" and opens the file\n\nIn the file, content is anchored to first cell as well as minimized which you need to expand to see the comment. \n\nRajeev", "id": 133009, "time": "2009-12-21T03:32:09Z", "bug_id": 47188, "creation_time": "2009-12-21T03:32:09Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 47188, "is_private": false, "text": "Reopening the bug.", "id": 133011, "time": "2009-12-21T03:39:47Z", "creator": "rsingh@ketera.com", "creation_time": "2009-12-21T03:39:47Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "yegor@dinom.ru", "is_private": false, "count": 5, "id": 133021, "time": "2009-12-21T06:29:20Z", "bug_id": 47188, "creation_time": "2009-12-21T06:29:20Z", "text": "Rajeev,\n\nPlease attach sample code to reproduce the problem. The code snippet you posted is not enough. If your code uses a template then attach it as well. \n\nWhich version of POI are you using? Make sure it is POI-3.6 or 3.7-SNAPSHOT. \n\nYegor"}, {"count": 6, "tags": [], "bug_id": 47188, "attachment_id": null, "text": "yes I am using 3.6 and without any template\nbelow is the code snippet\n\n\tClientAnchor anchor = ch.createClientAnchor();\n                    \tanchor.setCol1(6+i);\n                    \tanchor.setRow1(4+i);\n                    \tanchor.setCol2(12+i);\n                    \tanchor.setRow2(13+i);\n                    \tanchor.setDx1(i*4);\n                    \tanchor.setDy1(i*4);\n                    \tanchor.setDx2(i*4);\n                    \tanchor.setDy2(i*4);\n                    \t\n                    \tComment comment = drawing.createCellComment(anchor);\n                    \tcomment.setString(ch.createRichTextString(alias));\n                    \tcomment.setColumn(i);\n                    \tcomment.setRow(0);\n                    \tcell.setCellComment(comment);\n\nSetting co-ordinates solved the anchoring problem but still i guess the same old error\n\nOpening the workbook gives the following error:\n\nRemoved Records: Comments from /xl/comments1.xml part (Comments)\n\nNot sure whether I am missing anything.", "id": 133380, "time": "2010-01-06T03:58:33Z", "creator": "rsingh@ketera.com", "creation_time": "2010-01-06T03:58:33Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 47188, "text": "changing the status after providing asked info", "id": 133382, "time": "2010-01-06T04:53:36Z", "creator": "rsingh@ketera.com", "creation_time": "2010-01-06T04:53:36Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 47188, "is_private": false, "text": "Rajeev,\n\nI can't reproduce the problem with the current trunk. The following code snippet works fine and produces readable output: \n\n    public static void main(String[] args) throws Exception {\n        Workbook wb = new XSSFWorkbook();\n        Sheet sh = wb.createSheet();\n\n        int i = 0;\n        Cell cell = sh.createRow(0).createCell(i);\n        CreationHelper ch = wb.getCreationHelper();\n        Drawing drawing = sh.createDrawingPatriarch();\n\n        ClientAnchor anchor = ch.createClientAnchor();\n        anchor.setCol1(6+i);\n        anchor.setRow1(4+i);\n        anchor.setCol2(12+i);\n        anchor.setRow2(13+i);\n        anchor.setDx1(i*4);\n        anchor.setDy1(i*4);\n        anchor.setDx2(i*4);\n        anchor.setDy2(i*4);\n\n        Comment comment = drawing.createCellComment(anchor);\n        comment.setString(ch.createRichTextString(\"Testing 47188\"));\n        comment.setColumn(i);\n        comment.setRow(0);\n        cell.setCellComment(comment);\n\n        FileOutputStream out = new FileOutputStream(\"/temp/47188.xlsx\");\n        wb.write(out);\n        out.close();\n    }\n\nTry the latest build from trunk. Nightly builds can be downloaded from http://encore.torchbox.com/poi-svn-build/. \n\nIf the problem persists, please attach full sample code to reproduce, ideally a junit test case.\n\nYegor", "id": 133858, "time": "2010-01-24T06:00:33Z", "creator": "yegor@dinom.ru", "creation_time": "2010-01-24T06:00:33Z", "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 47188, "is_private": false, "text": "I believe this is now fixed, please re-open if the problem remains with a recent svn nightly build / recent release, and include details of how to replicate the problem", "id": 144565, "time": "2011-02-25T17:04:02Z", "creator": "apache@gagravarr.org", "creation_time": "2011-02-25T17:04:02Z", "attachment_id": null}]