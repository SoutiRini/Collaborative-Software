[{"count": 0, "tags": [], "bug_id": 38738, "attachment_id": null, "text": "I am seeing a difference in the Excel file when I do a \"Open and Save\" from \nthe File Dialog versus a \"Save\" only.  I tried to use a tool called DiffDoc \nthat I found on the web to analyze the differences between the two files.  The \ntool could not open the file that I did not open before saving.", "id": 86024, "time": "2006-02-21T17:39:58Z", "creator": "azelinsk@alzinc.com", "creation_time": "2006-02-21T17:39:58Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 38738, "text": "Huh?  don't see a bug here", "id": 86026, "time": "2006-02-21T18:32:02Z", "creator": "poi-support@buni.org", "creation_time": "2006-02-21T18:32:02Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 38738, "attachment_id": null, "id": 86030, "time": "2006-02-21T19:32:43Z", "creator": "azelinsk@alzinc.com", "creation_time": "2006-02-21T19:32:43Z", "is_private": false, "text": "This is the error message that I receive when I try to upload the file that \nhas only been saved - it was never opened.\n\n2006-02-21 12:30:15,366 ERROR \ncom.grainger.framework.struts.SystemExceptionHandl\ner - execute() :\nError Code is 3\ncom.grainger.framework.exception.ApplicationException\nCaused by:\ncom.grainger.framework.exception.ApplicationException\nCaused by:\njava.io.IOException: Unable to read entire block; 245 bytes read; expected 512 \nb\nytes\n        at org.apache.poi.poifs.storage.RawDataBlock.<init>\n(RawDataBlock.java:99\n)\n        at org.apache.poi.poifs.storage.RawDataBlockList.<init>\n(RawDataBlockList\n.java:88)\n        at org.apache.poi.poifs.filesystem.POIFSFileSystem.<init>\n(POIFSFileSyste\nm.java:123)\n        at \ncom.grainger.framework.document.handlers.impl.poi.ExcelDocumentHandle\nr.initialize(Unknown Source)\n        at com.grainger.framework.auth.upload.UploadMaster.initialize(Unknown \nSo\nurce)\n        at \ncom.grainger.fauth.ejb.session.UploadSessionFacadeBean.createReloadBa\ntch(Unknown Source)\n        at \ncom.grainger.fauth.ejb.session.UploadSessionFacade_n7kmsw_EOImpl.crea\nteReloadBatch(UploadSessionFacade_n7kmsw_EOImpl.java:46)\n        at com.grainger.fauth.web.delegates.UploadDelegate.uploadBatch(Unknown \nS\nource)\n        at com.grainger.fauth.web.actions.UploadAction.processBatch(Unknown \nSour\nce)\n        at com.grainger.fauth.web.actions.UploadAction.execute(Unknown Source)\n        at org.apache.struts.action.RequestProcessor.processActionPerform\n(Reques\ntProcessor.java:421)\n        at com.grainger.framework.struts.LoginRequestProcessor.process(Unknown \nS\nource)\n        at org.apache.struts.action.ActionServlet.process\n(ActionServlet.java:116\n4)\n        at org.apache.struts.action.ActionServlet.doPost\n(ActionServlet.java:415)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:760)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:853)\n        at \nweblogic.servlet.internal.ServletStubImpl$ServletInvocationAction.run\n(ServletStubImpl.java:1006)\n        at weblogic.servlet.internal.ServletStubImpl.invokeServlet\n(ServletStubIm\npl.java:419)\n        at weblogic.servlet.internal.ServletStubImpl.invokeServlet\n(ServletStubIm\npl.java:315)\n        at \nweblogic.servlet.internal.WebAppServletContext$ServletInvocationActio\nn.run(WebAppServletContext.java:6718)\n        at weblogic.security.acl.internal.AuthenticatedSubject.doAs\n(Authenticate\ndSubject.java:321)\n        at weblogic.security.service.SecurityManager.runAs\n(SecurityManager.java:\n121)\n        at weblogic.servlet.internal.WebAppServletContext.invokeServlet\n(WebAppSe\nrvletContext.java:3764)\n        at weblogic.servlet.internal.ServletRequestImpl.execute\n(ServletRequestIm\npl.java:2644)\n        at weblogic.kernel.ExecuteThread.execute(ExecuteThread.java:219)\n        at weblogic.kernel.ExecuteThread.run(ExecuteThread.java:178)"}, {"count": 3, "tags": [], "bug_id": 38738, "attachment_id": null, "id": 90819, "time": "2006-07-03T05:32:23Z", "creator": "maulin20@yahoo.com", "creation_time": "2006-07-03T05:32:23Z", "is_private": false, "text": "Even i am getting a similar Exception when I try to upload the file that \nhas only been saved - it was never opened.\nThe foll was the sequence of Actions:\n1)I created an Excel File using POI APIs and saved it at a location (say\nD:\\POI-Files\\Download\\test1.xls)\n2) Now Without opening the test1.xls file, i try to create a HSSFWorkbook as\nfollows:\nHSSFWorkbook wrkBook = new HSSFWorkbook(new FileInputStream(filePath));\n[here filePath is a String set to \"D:\\\\POI-Files\\\\Download\\\\test1.xls\"]\n\nIt gives me the foll Exception at the above line:\njava.io.IOException: Unable to read entire block; 2 bytes read; expected 512 bytes\nat org.apache.poi.poifs.storage.RawDataBlock.<init>(RawDataBlock.java:62)\nat org.apache.poi.poifs.storage.RawDataBlockList.<init>(RawDataBlockList.java:51)\nat org.apache.poi.poifs.filesystem.POIFSFileSystem.<init>(POIFSFileSystem.java:86)\nat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:210)\nat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:191)\nat com.project.web.ExcelHelper.getWorkbookFromFilePath(ExcelHelper.java:124)\n...\n\nInstead of using the new HSSFWorkbook(InputStream) method, i tried using the\nfollowing block of Code, but still the Exception Persists!!!\n        {\n        InputStream w_ipStream = new FileInputStream(a_filePath);\n\n        // read entire stream into byte array:\n        ByteArrayOutputStream byteOS = new ByteArrayOutputStream();\n        byte[] buffer = new byte[1024];\n        int count;\n        count= w_ipStream.read(buffer);\n        System.out.println(\"getWorkbookFromFilePath count = \"+count);\n        while(count != -1)\n        {\n            byteOS.write(buffer,0,count);\n            count=w_ipStream.read(buffer);\n            System.out.println(\"getWorkbookFromFilePath count = \"+count);\n        }\n        byteOS.close();\n        byte[] allBytes = byteOS.toByteArray();\n\n        // create workbook from array:\n        InputStream byteIS = new ByteArrayInputStream(allBytes);\n\n        return new HSSFWorkbook(byteIS);\n        }\n\n"}, {"count": 4, "tags": [], "bug_id": 38738, "text": "In my experiments I wouldn't reproduce it. Looks like it is not a bug in 3.0 RC.\n\nIf you have a particular test case that still throws exception with the latest\n3.0 RC jar, please upload it. Otherwise it's not a bug.\n\nYegor", "id": 101711, "time": "2007-04-14T04:11:12Z", "creator": "yegor@dinom.ru", "creation_time": "2007-04-14T04:11:12Z", "is_private": false, "attachment_id": null}]