[{"count": 0, "tags": [], "bug_id": 53144, "text": "Created attachment 28674\nTest output file. res.xls\n\nA cell's comment is not cloned.\nThe comment is a comment processed by the 1st.\uff08May be\uff09\n\npublic static void test() {\n try {\n  InputStream is= new FileInputStream(\"test.xls\");\t\n  Workbook workbook = WorkbookFactory.create(is);\n  is.close();\n\n  Sheet sheet = workbook.cloneSheet(workbook.getSheetIndex(\"TEST1\"));\n  workbook.setSheetName(workbook.getSheetIndex(sheet), \"TEST2\");\n\n  FileOutputStream os = new FileOutputStream(\"res.xls\");\n  workbook.write(os);\n  os.close();\n } catch (Exception e) {\n  e.printStackTrace();\n }\n}\n\n[res.xls : attachment]\n A sheet(TEST1) has 2 cells(A1,B1) that has comment.\n A cell(A1) on sheet(TEST2) has not comment.\n TEST2 cloned from TEST1.", "id": 158403, "time": "2012-04-25T07:05:55Z", "creator": "ishii@infoteria.com", "creation_time": "2012-04-25T07:05:55Z", "is_private": false, "attachment_id": 28674}, {"count": 1, "tags": [], "creator": "superrubiroyd@gmail.com", "attachment_id": null, "text": "This problem should be fixed in trunk.\n\nPlease try with a nightly build - see download links on http://poi.apache.org/\nor build yourself from SVN trunk, see http://poi.apache.org/subversion.html", "id": 161507, "time": "2012-08-18T14:44:22Z", "bug_id": 53144, "creation_time": "2012-08-18T14:44:22Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 53144, "attachment_id": null, "id": 161526, "time": "2012-08-20T06:21:45Z", "creator": "ishii@infoteria.com", "creation_time": "2012-08-20T06:21:45Z", "is_private": false, "text": "I get source files from SVN trunk,and Test on 20 august.\nException at [workbook.write(os);]\n\njava.lang.IllegalStateException: found multiple cell comments for cell $B$1\n\tat org.apache.poi.hssf.usermodel.HSSFPatriarch.preSerialize(HSSFPatriarch.java:110)\n\tat org.apache.poi.hssf.usermodel.HSSFSheet.preSerialize(HSSFSheet.java:144)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.getBytes(HSSFWorkbook.java:1248)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.write(HSSFWorkbook.java:1167)"}, {"count": 3, "tags": [], "text": "According to the exception one of your sheets contains two or more comments for single cell. Please attach to this ticket source code and input file to reproduce this exception.\n\nRegards, Evgeniy", "is_private": false, "id": 161528, "creator": "superrubiroyd@gmail.com", "time": "2012-08-20T07:06:28Z", "bug_id": 53144, "creation_time": "2012-08-20T07:06:28Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 53144, "text": "Created attachment 29282\nA file for test input", "id": 161719, "time": "2012-08-27T02:33:40Z", "creator": "ishii@infoteria.com", "creation_time": "2012-08-27T02:33:40Z", "is_private": false, "attachment_id": 29282}, {"count": 5, "tags": [], "creator": "ishii@infoteria.com", "attachment_id": null, "text": "Test source code is the same as before. \nThe Excel file(test.xls) used for the test attached at 2012-08-27 02:33. \n\nRegards,", "id": 161720, "time": "2012-08-27T02:38:08Z", "bug_id": 53144, "creation_time": "2012-08-27T02:38:08Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 53144, "attachment_id": null, "id": 161741, "time": "2012-08-27T18:57:49Z", "creator": "superrubiroyd@gmail.com", "creation_time": "2012-08-27T18:57:49Z", "is_private": false, "text": "Hi Arimitsu\n\nSource file you've attached contains 2 comments for cell B1. However Excel correctly reads this file. Can you please explain me, how did you create such file using Excel or POI tools, so I will understand whether this file is corrupted and you should only create new file or consider this situation more detailed.\n\nRegards, Evgeniy"}, {"count": 7, "tags": [], "bug_id": 53144, "attachment_id": null, "id": 161916, "time": "2012-09-03T04:48:10Z", "creator": "ishii@infoteria.com", "creation_time": "2012-09-03T04:48:10Z", "is_private": false, "text": "Hi\n\nI should have checked again using other files. \nI'm sorry.\nI have forgotten how the old test file was created.\n\nI created test file newly and checked that a clone of the first comment was performed.\n\nRegards,"}]