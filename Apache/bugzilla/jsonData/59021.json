[{"count": 0, "tags": [], "creator": "tallison@mitre.org", "attachment_id": null, "text": "On TIKA-1859, Movses raised an issue that he can extract content with POI from a specific xlsx file but not from Tika.\n\nI confirmed that the content is extractable with XSSFWorkbook.\n\nHowever, Tika does a streaming read with XSSFSheetXMLHandler.  XSSFSheetXMLHandler relies on qName to find \"row\" and \"c\".  In the submitted problematic file, the qName includes the namespace (i.e. \"x:row\", \"x:c\") and the sheet handler entirely skips that content.\n\nWhen I switched the string processing in startElement and endElement in XSSFSheetXMLHandler to rely on localName, instead of qName, content was correctly extracted.\n\nMovses ranked this a blocker on Tika.  It would be great if we could get the fix in before we cut 3.14...  I should have time tonight so make the fix in trunk.", "id": 188523, "time": "2016-02-17T20:46:16Z", "bug_id": 59021, "creation_time": "2016-02-17T20:46:16Z", "is_private": false}, {"count": 1, "tags": [], "creator": "tallison@mitre.org", "text": "I'm hesitant to rely on localName because that's the whole point of namespaces.\n\nShould we test that the URI == \"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" in startElement and endElement to make sure we're dealing with the right \"c\" and \"row\"?  \n\nOr is there a more elegant option?", "id": 188524, "time": "2016-02-17T20:50:20Z", "bug_id": 59021, "creation_time": "2016-02-17T20:50:20Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 59021, "is_private": false, "text": "It'll be a bit more verbose, but checking both the namespace and the tag name is the safest way to do it", "id": 188545, "time": "2016-02-17T23:38:04Z", "creator": "apache@gagravarr.org", "creation_time": "2016-02-17T23:38:04Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 59021, "text": "Thank you, Nick!  Done.\n\nr1730992", "id": 188548, "time": "2016-02-18T01:51:02Z", "creator": "tallison@mitre.org", "creation_time": "2016-02-18T01:51:02Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "edwardchu521@hotmail.com", "text": "Created attachment 34294\nExcel file broken with the change\n\nThe attached excel file is generated by Microsoft Excel 2016 for Mac. The file can no longer be extracted since 3.14 after the change in this ticket is introduced. As I debug startElement() function call, uri is empty but not null (\"\"). Also localName is empty while qName is present.", "id": 193938, "time": "2016-09-22T19:29:29Z", "bug_id": 59021, "creation_time": "2016-09-22T19:29:29Z", "is_private": false, "attachment_id": 34294}, {"count": 5, "tags": [], "bug_id": 59021, "text": "(In reply to Ed Chu from comment #4)\n> Created attachment 34294 [details]\n> Excel file broken with the change\n\nCan you try with a more recent version of POI? I've just tried with the most recent, and I see the same text from POI and Tika as I do in OpenOffice (\"Table 1\" but that's about it)", "id": 193943, "time": "2016-09-22T21:01:28Z", "creator": "apache@gagravarr.org", "creation_time": "2016-09-22T21:01:28Z", "is_private": false, "attachment_id": null}]