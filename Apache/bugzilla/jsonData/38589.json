[{"count": 0, "attachment_id": null, "bug_id": 38589, "text": "Uploaded files are not (directly) released by JAVA after the ant-WebDAV-put-task.\nSo file manipulations (like delete) fails, because the uploaded file seems still\nto be used on the local system.\n\nIdea: Close the uploaded files explicit:\n\nIn org.apache.webdav.ant.taskdefs.put.uploadFile: \nchange code to\n            if (this.filterSets.hasFilters()) {\n               [...]\n               reader.close();\n               Utils.putFile(getHttpClient(), url, \n                     new ByteArrayInputStream(out.toByteArray()), \n                     contentType, this.locktoken);\n            } else {\n               FileInputStream reader = new FileInputStream(file);\n               Utils.putFile(getHttpClient(), url,\n                     reader, \n                     contentType, this.locktoken);\n               reader.close();\n            }", "id": 85628, "time": "2006-02-09T12:35:06Z", "creator": "klaus.allwicher@nuance.com", "creation_time": "2006-02-09T12:35:06Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "simesj@gmail.com", "attachment_id": null, "text": "Additionally if you try to get round this issue by using\nputMethod(FileInputStream, path) you can come across problems with Bad Request\nerrors particularly with Oracle AS (mod_oradav). \n\n(In reply to comment #0)\n> Uploaded files are not (directly) released by JAVA after the ant-WebDAV-put-task.\n> So file manipulations (like delete) fails, because the uploaded file seems still\n> to be used on the local system.\n> \n> Idea: Close the uploaded files explicit:\n> \n> In org.apache.webdav.ant.taskdefs.put.uploadFile: \n> change code to\n>             if (this.filterSets.hasFilters()) {\n>                [...]\n>                reader.close();\n>                Utils.putFile(getHttpClient(), url, \n>                      new ByteArrayInputStream(out.toByteArray()), \n>                      contentType, this.locktoken);\n>             } else {\n>                FileInputStream reader = new FileInputStream(file);\n>                Utils.putFile(getHttpClient(), url,\n>                      reader, \n>                      contentType, this.locktoken);\n>                reader.close();\n>             }\n\n", "id": 93134, "time": "2006-09-07T09:35:06Z", "bug_id": 38589, "creation_time": "2006-09-07T09:35:06Z", "is_private": false}, {"count": 2, "tags": [], "creator": "simesj@gmail.com", "attachment_id": null, "is_private": false, "id": 93155, "time": "2006-09-07T13:40:23Z", "bug_id": 38589, "creation_time": "2006-09-07T13:40:23Z", "text": "Sorry for my earlier comment it relates to the same issue but with\nWebDavResource not the Ant task put. \n\nHowever this is also a problem with the WebDavResource.putMethod(String File),\nas the FileInputStream created from the File is not closed in the method,\nmaintaining a link to the file to be uploaded.\n"}]