[{"count": 0, "tags": [], "bug_id": 46872, "attachment_id": null, "text": "Currently I am using a apache 2.2.11 instance with a balancer configuration:\n\n<Proxy balancer://patmos>\n  BalancerMember ajp://10.0.0.208:8009 route=tomcat01 min=50 smax=80 max=100 \n  BalancerMember ajp://10.0.0.228:8009 route=tomcat02 min=50 smax=80 max=100 \n</Proxy>\nProxyPass / balancer://patmos/ stickysession=JSESSIONID|jsessionid nofailover=Off \n\nMy tomcat servers are configured to accept max 512 connections.\n\nThe tomcat servers has +/- 512 established ajp connections each(seen with a netstat). That's more than the max=100 what is configured on the BalancerMember.\n\nBecause 512 is the max for a tomcat instance, Apache got connection refused errors and disables that BalanceMember and the website is offline. \n\nIt seems to me Apache is not listening to the smax and max params on the BalancerMember.", "id": 125609, "time": "2009-03-18T03:04:44Z", "creator": "sander.de.boer@eo.nl", "creation_time": "2009-03-18T03:04:44Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 46872, "attachment_id": null, "text": "It seems when ServerLimit 1 the max is correct.\n\nConclusion: the max on a balancerMember is multiplied by the count of active servers.\n\nIs this a bug?", "id": 125612, "time": "2009-03-18T04:11:40Z", "creator": "sander.de.boer@eo.nl", "creation_time": "2009-03-18T04:11:40Z", "is_private": false}, {"count": 2, "tags": [], "creator": "rpluem@apache.org", "is_private": false, "text": "(In reply to comment #1)\n> It seems when ServerLimit 1 the max is correct.\n> \n> Conclusion: the max on a balancerMember is multiplied by the count of active\n> servers.\n> \n> Is this a bug?\n\nNo this no bug, or at least no code bug (maybe a documentation bug). Max limits the maximum numbers of connection *one* server process can do. The highest max setting you can do is the number of threads that are running per process (so this is 1 for prefork and ThreadsPerChild for worker). Higher values are cut off.\nSo you have to coordinate your balancer settings with your MPM servers and ThreadsPerChild settings.", "id": 125613, "time": "2009-03-18T05:54:23Z", "bug_id": 46872, "creation_time": "2009-03-18T05:54:23Z", "attachment_id": null}]