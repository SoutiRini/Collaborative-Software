[{"count": 0, "tags": [], "creator": "dsmirnov@topsbi.ru", "attachment_id": 22855, "is_private": false, "id": 122375, "time": "2008-11-11T06:47:20Z", "bug_id": 46186, "creation_time": "2008-11-11T06:47:20Z", "text": "Created attachment 22855\nexcel file\n\nreroducing step:\n1. I'm created src.xls file in Excel and after that \n2. I'm create HSSFWorkbook on the basis of existing excel file\n3. group some row\n4. I'm open new dst.xls and group row id absent. \n\nThis is bug. src.xls in attach\n\n\nsimple code:\npublic class Test {\n\n    public static void main(String[] args) throws Exception {\n\n       HSSFWorkbook(StreamUtil.getInputStream(\"c:\\\\src.xls\"));\n       HSSFSheet sheet = wb.getSheetAt(0);\n       sheet.groupRow(5,10); // <-- look here\n       final FileOutputStream out = new FileOutputStream(new File(\"C:\\\\dst.xls\"));\n       try {\n            wb.write(out);\n        } finally {\n            out.close();\n        }\n    }\n}"}, {"count": 1, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "is_private": false, "id": 122378, "time": "2008-11-11T08:19:36Z", "bug_id": 46186, "creation_time": "2008-11-11T08:19:36Z", "text": "Did it work with earlier versions of POI? I checked your code with 3.0.2 and it doesn't work either. It seems to be not a regression, something is special with your src.xls. \n\nHow was this file created? Using POI or manually in Excel? Which version?\n\ngroupRow() works fine when creating new sheets but somehow doesn't work for the attached file.\n\nYegor"}, {"count": 2, "tags": [], "bug_id": 46186, "attachment_id": null, "id": 122379, "time": "2008-11-11T08:32:22Z", "creator": "dsmirnov@topsbi.ru", "creation_time": "2008-11-11T08:32:22Z", "is_private": false, "text": "this is excel file was created in 2003 excel sp3 and save as microsoft excel 97...\nIm tested it on poi 3.2 version.\nFor  poi version 3.0.1 groupRow working fine.\n\nsorry for bad test, this is better\n public static void main(String[] args) throws Exception {\n        HSSFWorkbook wb = new HSSFWorkbook(new FileInputStream(\"c:\\\\src.xls\"));\n        HSSFSheet sheet = wb.getSheetAt(0);\n        sheet.groupRow(5, 10); // <-- look here\n        final FileOutputStream out = new FileOutputStream(new File(\"C:\\\\dst.xls\"));\n        try {\n            wb.write(out);\n        } finally {\n            out.close();\n        }\n    }\n\n\n"}, {"count": 3, "tags": [], "text": "Same problem with 3.5 Beta 4, using Office 2003 (Windows) or Office 2007/8 (Mac)\n\nIf Workbook / Sheet was created new --> works\nIf Workbook / Sheet was loaded from file --> doesn't work\n\nI tried the attached src.xls, tried a new one - fresh created with same data, tried an empty one - created inside Windows explorer with create new Excel.\n\n", "is_private": false, "id": 123446, "creator": "ralf.tossenberger@cool2work.com", "time": "2008-12-20T07:42:21Z", "bug_id": 46186, "creation_time": "2008-12-20T07:42:21Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 46186, "attachment_id": null, "text": "The Problem was that in 3.2 a new variable was added to the Sheet class _gutsRecord but it was never initialized when in the Sheet(RecordStream rs) constructor.  I just added the code to check for the GutsRecord.sid and the assign the record to the variable", "id": 125554, "time": "2009-03-13T12:05:20Z", "creator": "bstox@dkintl.com", "creation_time": "2009-03-13T12:05:20Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 46186, "attachment_id": null, "id": 126349, "time": "2009-04-18T02:09:38Z", "creator": "yegor@dinom.ru", "creation_time": "2009-04-18T02:09:38Z", "is_private": false, "text": "Fixed in r766273\n\nRegards,\nYegor"}]