[{"count": 0, "tags": [], "bug_id": 42017, "is_private": false, "id": 101316, "creation_time": "2007-04-02T03:06:53Z", "time": "2007-04-02T03:06:53Z", "creator": "f.dalan@mbm.it", "text": "Hi, when I use the MBean architecture with mx4j implementation to manage the \nlogging parameters, I have an InstanceAlreadyExistsException. This happen when \nthe org.apache.log4j.jmx.AppenderDynamicMBean try to register a layout \n(registerLayoutMBean method) because do not check if the MBean is already \nregistered. Here there is the code that I use\n\nMBeanServer server = MBeanServerFactory.createMBeanServer();\nHierarchyDynamicMBean hdm = new HierarchyDynamicMBean();\n...\nLoggerRepository r = LogManager.getLoggerRepository();\nEnumeration enum = r.getCurrentLoggers();\nLogger logger = null;\nwhile (enum.hasMoreElements()) {\n  logger = (Logger) enum.nextElement();\n  ObjectName dummy = new ObjectName(\"log4j\", \"logger\", logger.getName());\n  if (!server.isRegistered(dummy))\n    hdm.addLoggerMBean(logger.getName());\n}\n\nand the log4j.properties\n\n# Console is set to be a ConsoleAppender.\nlog4j.appender.Console=org.apache.log4j.ConsoleAppender\nlog4j.appender.Console.layout=org.apache.log4j.PatternLayout\nlog4j.appender.Console.layout.ConversionPattern=%d %-5p %c{1}.%M - %m%n\n\n# FileConsole is set to be a FileAppender.\nlog4j.appender.FileConsole.File=\\\\wcubecoils.log\nlog4j.appender.FileConsole=org.apache.log4j.FileAppender\nlog4j.appender.FileConsole.layout=org.apache.log4j.PatternLayout\nlog4j.appender.FileConsole.layout.ConversionPattern=%d %-5p %c{1}.%M - %m%n\n\n# the root logger\nlog4j.rootLogger=INFO, FileConsole\n\n# wcube logging configuration...\nlog4j.logger.it.mbm.wcube.processmessage=TRACE, FileConsole\nlog4j.logger.it.mbm.wcube.mq.bo.action=TRACE, FileConsole", "attachment_id": null}, {"count": 1, "tags": [], "creator": "f.dalan@mbm.it", "attachment_id": 19866, "text": "Created attachment 19866\nAdds a test before register a MBean\n\nThe patch have been marked by the patch comment", "id": 101318, "time": "2007-04-02T03:46:02Z", "bug_id": 42017, "creation_time": "2007-04-02T03:46:02Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 42017, "text": "Created attachment 19867\nAdds a test before register a MBean\n\nThe patch have been marked by the patch comment", "id": 101319, "time": "2007-04-02T03:46:31Z", "creator": "f.dalan@mbm.it", "creation_time": "2007-04-02T03:46:31Z", "is_private": false, "attachment_id": 19867}, {"count": 3, "attachment_id": null, "creator": "psmith@apache.org", "text": "1.2.15 candidate", "id": 102172, "time": "2007-04-23T15:10:19Z", "bug_id": 42017, "creation_time": "2007-04-23T15:10:19Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 42017, "text": "Done in revision 531643", "id": 102175, "time": "2007-04-23T16:09:36Z", "creator": "psmith@apache.org", "creation_time": "2007-04-23T16:09:36Z", "is_private": false, "attachment_id": null}]