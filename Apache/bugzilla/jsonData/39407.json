[{"count": 0, "tags": [], "bug_id": 39407, "is_private": false, "text": "Currently, <xslt> task accepts the stylesheet via its \"style\" attribute only as a file. Modify it so that it \ncan accept the stylesheet as a resource:\n\n<xslt in=\"somedata.xml\" out=\"someresult.html\">\n    <file file=\"style.xml\"/>\n</xslt>\n\nor \n\n<xslt in=\"somedata.xml\" out=\"someresult.html\">\n    <url url=\"style.xml\"/>\n</xslt>", "id": 88489, "time": "2006-04-26T05:59:50Z", "creator": "rambiusparkisanius@yahoo.com", "creation_time": "2006-04-26T05:59:50Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "rambiusparkisanius@yahoo.com", "is_private": false, "id": 88490, "attachment_id": 18183, "bug_id": 39407, "creation_time": "2006-04-26T06:05:19Z", "time": "2006-04-26T06:05:19Z", "text": "Created attachment 18183\nContains the patch for <xslt> task and some testcase\n\nThe file contains the patches for the following files:\nsrc/main/org/apache/tools/ant/taskdefs/XSLTProcess.java\nsrc/main/org/apache/tools/ant/taskdefs/optional/TraXLiaison.java\nsrc/main/org/apache/tools/ant/taskdefs/XSLTLiaison.java\nsrc/etc/testcases/taskdefs/style/build.xml\nsrc/testcases/org/apache/tools/ant/taskdefs/StyleTest.java\n\nXSLTProcess (<xslt> task) delegates all of the xslt transformation to an\ninstance of XSLTLiaison, so I had to hack it and its descendants as well."}, {"attachment_id": null, "tags": [], "creator": "antoine@apache.org", "is_private": false, "count": 2, "id": 88534, "time": "2006-04-27T01:01:41Z", "bug_id": 39407, "creation_time": "2006-04-27T01:01:41Z", "text": "This bit in the patch concerning \nsrc/main/org/apache/tools/ant/taskdefs/optional/TraXLiaison.java\n-    public void setStylesheet(File stylesheet) throws Exception {\n+    public void setStylesheet(Resource stylesheet) throws Exception {\ncannot be submitted as is.\nWe need to keep setStylesheet(File stylesheet) and have it delegate to the\nnew method.\nsetStylesheet(File stylesheet) can be marked as deprecated with Ant 1.7"}, {"attachment_id": null, "tags": [], "creator": "antoine@apache.org", "text": "2nd comment :\nin src/main/org/apache/tools/ant/taskdefs/XSLTProcess.java\nthe code resolving the stylesheet as file from the attribute entered as string\nshould remain better in the execute method. The reason is that the attribute\nbasedir might not be known yet when the attribute style gets set.\nAlso, exceptions should be thrown if both the resource and the style attribute\nget set.\nRegards,\nAntoine", "count": 3, "id": 88535, "time": "2006-04-27T01:39:53Z", "bug_id": 39407, "creation_time": "2006-04-27T01:39:53Z", "is_private": false}, {"attachment_id": 18196, "tags": [], "creator": "rambiusparkisanius@yahoo.com", "is_private": false, "count": 4, "id": 88600, "time": "2006-04-27T23:56:18Z", "bug_id": 39407, "creation_time": "2006-04-27T23:56:18Z", "text": "Created attachment 18196\nImproved patch implementing Antoine's remarks"}, {"count": 5, "tags": [], "text": "Created attachment 18197\nA new XSLTLiaison containing setStylesheet(Resource)", "attachment_id": 18197, "bug_id": 39407, "id": 88601, "time": "2006-04-27T23:57:13Z", "creator": "rambiusparkisanius@yahoo.com", "creation_time": "2006-04-27T23:57:13Z", "is_private": false}, {"attachment_id": null, "tags": [], "creator": "rambiusparkisanius@yahoo.com", "text": "The new patch xslt.diff implements Antoine's remarks:\n- it adds XSLTPorocess.addConfigured(Resource stylesheet) method, which handles\nthe nested stylesheet resource;\n- private variable xslFile in XSLTProcess is restored and it contains the value\nof style attribute; if it is not null it is resolved to a File in\nXSLTProcess.execute() and the File is then converted to a FileResource, which is\nused as a stylesheet resource;\n- if both style attribute and nested stylesheet resource are supplied a\nBuildException is thrown; if none is supplied again a BuildException is thrown;\n- Instead of adding setStylesheet(Resource) to XSLTLiaison2 interface (which can\nbreak bwc), a new interface XSLTLiaison3 is created, which extends XSLTLiaison2\nand declares setStylesheet(Resource). TraXLiaison implements now XSLTLiaison3", "count": 6, "id": 88602, "time": "2006-04-28T00:07:05Z", "bug_id": 39407, "creation_time": "2006-04-28T00:07:05Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 39407, "attachment_id": null, "id": 89476, "time": "2006-05-25T12:39:31Z", "creator": "antoine@apache.org", "creation_time": "2006-05-25T12:39:31Z", "is_private": false, "text": "Thanks Ivan, your bug report has been committed.\nRegards,\nAntoine"}, {"count": 8, "tags": [], "bug_id": 39407, "is_private": false, "text": "The patch has created issues for build projects which use xsl:include or entity\nincludes, because the SystemId does not get set properly any more.\nsee http://marc.theaimsgroup.com/?l=fop-dev&m=114889708308181&w=2\n\nRegards,\n\nAntoine", "id": 89822, "time": "2006-06-06T16:42:44Z", "creator": "antoine@apache.org", "creation_time": "2006-06-06T16:42:44Z", "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 39407, "text": "Created attachment 18418\nFixes for setStylesheet(File) and for systemId", "id": 89856, "time": "2006-06-07T07:43:32Z", "creator": "rambiusparkisanius@yahoo.com", "creation_time": "2006-06-07T07:43:32Z", "is_private": false, "attachment_id": 18418}, {"count": 10, "tags": [], "text": "I did the required corrections:\n1) setStylesheet(File) now invokes setStylesheet(Resource)\n2) I changed \nsrc.setSystemId(resource.getName())\nto\nsrc.setSystemId(resourceToURI(resource)),\nwhere resourceToURI(resource) is a method that returns the URL corresponding to a resource.\n\nPerhaps it would be better if we add a method getUrl() in Resource class.", "is_private": false, "bug_id": 39407, "id": 89857, "time": "2006-06-07T07:55:51Z", "creator": "rambiusparkisanius@yahoo.com", "creation_time": "2006-06-07T07:55:51Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "antoine@apache.org", "text": "Ivan,\n\nthanks for the patch which is now submitted.\n\nI will add a reply to this on the dev mailing list.\n\nThanks,\n\nAntoine", "count": 11, "id": 89874, "time": "2006-06-07T13:38:40Z", "bug_id": 39407, "creation_time": "2006-06-07T13:38:40Z", "is_private": false}]