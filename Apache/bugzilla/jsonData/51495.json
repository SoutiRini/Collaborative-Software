[{"count": 0, "tags": [], "creator": "max@cxib.net", "attachment_id": null, "id": 147857, "time": "2011-07-11T00:40:17Z", "bug_id": 51495, "creation_time": "2011-07-11T00:40:17Z", "is_private": false, "text": "In my opinion CPU and memory limit for mod_substitute is missing here.\nThe first problem in this module, is not limiting execution time and\nmemory. It allow to local denial of service. We don't need convince that\nthe use of PCRE is dangerous. So we need limit output time and memory in\nmod_substitute.\n\n-memory-exhaustion-\nAddOutputFilterByType SUBSTITUTE text/html\nSubstitute \"s|(.*(!?))||if\"\n-memory-exhaustion-\nResult:\nJul  5 13:16:04 127 /netbsd: UVM: pid 1768 (httpd), uid 1006 killed: out\nof swap\n\n\n-crash-\nAddOutputFilterByType SUBSTITUTE text/html\nSubstitute \"s|((.*){2222,}(.*){2222,})||iq\"\n-crash-\nResult:\n[Mon Jul 11 02:57:29 2011] [notice] child pid 28 exit signal Illegal\ninstruction (4)\n\n\n-cpu-exhaustion-\nAddOutputFilterByType SUBSTITUTE text/html\nSubstitute \"s|(.*+(.*){2222,}(.*)+(.*){22,})||iq\"\n-cpu-exhaustion-\nResult:\nLong executing time, providing to memory exhaustion"}]