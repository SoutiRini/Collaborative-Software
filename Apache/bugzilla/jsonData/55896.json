[{"count": 0, "tags": [], "bug_id": 55896, "attachment_id": 31123, "text": "Created attachment 31123\nadded html headers which made the security flag to disappear.\n\nHi,\nWhen running OWASP ZAP web security tool, I get the following flag:\nSecure page can be cached in browser.  Cache control is not set in HTTP header nor HTML header.  Sensitive content can be recovered from browser storage.\n\nI was surprised since i had the no cache header in both html code and httpd header.\n\nAfter investigating the flag, i noticed that the response was a generic 302 found error response from Apach (located in apache/src/modules/http/http_protocol.c).\n\nI have added a patch to code when adding the cache-control & pragma html headers with no-cache - and that had solved the security flag (patch attached).\n\nfull response given:\nheader:\nHTTP/1.1 302 Found\nDate: Sat, 30 Nov 2013 10:44:40 GMT\nServer: Apache\nX-Frame-Options: DENY\nLocation: https://10.209.0.81/admin/launch?script=rh&template=login&v_error=Incorrect%20user%20id%20or%20password.&f_user_id=ZAP\nContent-Length: 376\nContent-Type: text/html; charset=iso-8859-1\n\nbody:\n<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\n<html><head>\n<title>302 Found</title>\n</head><body>\n<h1>Found</h1>\n<p>The document has moved <a href=\"https://10.209.0.81/admin/launch?script=rh&amp;template=login&amp;v_error=Incorrect%20user%20id%20or%20password.&amp;f_user_id=ZAP\">here</a>.</p>\n<hr>\n<address>Apache Server at 10.209.0.81 Port 443</address>\n</body></html>\n\n\nIn conclusion:\n1. bug is \"Secure page can be cached in browser.\" (found by owasp zap) for https page response \"302 Found\" from Apache.\n\n2. recomended solution: add to http_protocol.c the no-cache in html head in case https was called.\n\n3. test case could be taken from OWASP ZAP on https url.\n\nWould appreciate if it could be fixed, even in a patch manner, and i would test it localy.\n\nThanks,\nMeir", "id": 171789, "time": "2013-12-17T13:52:38Z", "creator": "meirre@mellanox.com", "creation_time": "2013-12-17T13:52:38Z", "is_private": false}, {"count": 1, "tags": [], "text": "Does it happen on a contemporary maintenance level?\n\n A response received with any other status code (e.g. status codes 302 and 307) MUST NOT be returned in a reply to a subsequent request unless there are cache-control directives or another header(s) that explicitly allow it. For example, these include the following: an Expires header (section 14.21); a \"max-age\", \"s-maxage\", \"must- revalidate\", \"proxy-revalidate\", \"public\" or \"private\" cache-control directive (section 14.9).", "is_private": false, "id": 171792, "creator": "covener@gmail.com", "time": "2013-12-17T14:16:20Z", "bug_id": 55896, "creation_time": "2013-12-17T14:16:20Z", "attachment_id": null}, {"count": 2, "tags": [], "text": ">  A response received with any other status code (e.g. status codes 302 and\n> 307) MUST NOT be returned in a reply to a subsequent request unless there\n> are cache-control directives or another header(s) that explicitly allow it.\n> For example, these include the following: an Expires header (section 14.21);\n> a \"max-age\", \"s-maxage\", \"must- revalidate\", \"proxy-revalidate\", \"public\" or\n> \"private\" cache-control directive (section 14.9).\n\nSorry, I realize now that Apache did not cache anything, so the above is n/a.", "is_private": false, "id": 171793, "creator": "covener@gmail.com", "time": "2013-12-17T14:41:05Z", "bug_id": 55896, "creation_time": "2013-12-17T14:41:05Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 55896, "attachment_id": null, "text": "The response was already un-cacheable, see the final sentence below:\n\n10.3.3 302 Found\n\n   The requested resource resides temporarily under a different URI.\n   Since the redirection might be altered on occasion, the client SHOULD\n   continue to use the Request-URI for future requests.  This response\n   is only cacheable if indicated by a Cache-Control or Expires header\n   field.", "id": 171794, "time": "2013-12-17T14:42:02Z", "creator": "covener@gmail.com", "creation_time": "2013-12-17T14:42:02Z", "is_private": false}, {"count": 4, "tags": [], "text": "Hi Eric,\nthanks for your response.\nYour explanation did not fit the current state.\n\n1. How could you explain that the test returned it as cached?\n2. If No \"no-cahce\" flag was entered in the header, how could the response avoid being cached by the browser?\n\n3. Do you believe that test case by Owasp ZAP tool is wrong?\n\nI would appreciate if you could recheck it.\n\nThanks,\nMeir", "is_private": false, "id": 171814, "creator": "meirre@mellanox.com", "time": "2013-12-18T14:37:53Z", "bug_id": 55896, "creation_time": "2013-12-18T14:37:53Z", "attachment_id": null}, {"count": 5, "attachment_id": null, "bug_id": 55896, "is_private": false, "id": 171815, "time": "2013-12-18T14:48:33Z", "creator": "covener@gmail.com", "creation_time": "2013-12-18T14:48:33Z", "tags": [], "text": "Don't reopen bugs to carry on discussions unless you have some further evidence of a bug.  \n\nThe test tool emulates a browser. httpd bugzilla is no place to discuss its implementation."}, {"count": 6, "tags": [], "creator": "meirre@mellanox.com", "is_private": false, "text": "Could you please refer to my question please:\n\n2. If No \"no-cahce\" flag was entered in the header, how could the response avoid being cached by the browser?\n\nIf it is not explicitly mentioned, isn't it a seucrity risk over apache generic response?", "id": 171816, "time": "2013-12-18T14:54:47Z", "bug_id": 55896, "creation_time": "2013-12-18T14:54:47Z", "attachment_id": null}, {"count": 7, "attachment_id": null, "bug_id": 55896, "text": "(In reply to meirre from comment #6)\n> Could you please refer to my question please:\n> \n> 2. If No \"no-cahce\" flag was entered in the header, how could the response\n> avoid being cached by the browser?\n> \n> If it is not explicitly mentioned, isn't it a seucrity risk over apache\n> generic response?\n\nNo idea what you're talking about. Try the users mailing list.", "id": 171817, "time": "2013-12-18T15:06:09Z", "creator": "covener@gmail.com", "creation_time": "2013-12-18T15:06:09Z", "tags": [], "is_private": false}]