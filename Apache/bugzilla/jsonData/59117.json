[{"count": 0, "tags": [], "bug_id": 59117, "attachment_id": null, "id": 189098, "time": "2016-03-04T14:41:56Z", "creator": "apache_bugzilla@valgronda.com", "creation_time": "2016-03-04T14:41:56Z", "is_private": false, "text": "In following example the backreference $1 is always empty when match occurs:\n\nSetEnvIf HTTP_HOST \"^(.*)(:.*)?\" HTTP_HOST_NOPORT=$1\n\nMy use case is as follows:\n- virtual host example.com on non standard http port\n- virtual host example.com on non standard https port\n- several SeverAliases are defined on both (example1, example2, etc)\n- all http traffic should be redirected to https (also on non-standard port)\n\nSo I tried to configure\n\nSetEnvIf HTTP_HOST \"^(.*)(:.*)?\" HTTP_HOST_NOPORT=$1\nRewriteRule ^/(.*)$ https://%{ENV:HTTP_HOST_NOPORT}:4443/$1 [NC,R=301,L,NE]\n\nThis will result in a redirect with wrong \"Location: https://:4443/\" if a request to http://example.com:8080 or http://example1.com:8080 is done. Expected would be a \"Location: https://example.com:4443\" or \"Location: https://example1.com:4443\" (according to the server alias used for the request)\n\nThis behavior with HTTP_ environment variables of SetEnvIf is in contrast to e.g.\n\nSetEnvIf REQUEST_URI \"\\.(.*)$\" EXTENSION=$1\n\nIn that example you can use %{ENV:EXTENSION} in a RewriteRule."}, {"count": 1, "tags": [], "creator": "covener@gmail.com", "attachment_id": null, "text": "Multiple issues in your SetEnvIf. Try\n\nSetEnvIf HOST \"^([^:]*)\" HTTP_HOST_NOPORT=$1", "id": 189100, "time": "2016-03-04T14:50:49Z", "bug_id": 59117, "creation_time": "2016-03-04T14:50:49Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 59117, "text": "Wow, thanks for the hint Eric.\n\nUse \"HOST\" instead of \"HTTP_HOST\" solved the problem (I had also tested with SetEnvIf HTTP_HOST \"(.*)\" - but this match was of course also empty every time...)", "id": 189105, "time": "2016-03-04T15:43:31Z", "creator": "apache_bugzilla@valgronda.com", "creation_time": "2016-03-04T15:43:31Z", "is_private": false, "attachment_id": null}]