[{"count": 0, "tags": [], "bug_id": 55093, "attachment_id": 30428, "id": 167784, "time": "2013-06-12T11:44:54Z", "creator": "tcarter@noggin.com.au", "creation_time": "2013-06-12T11:44:54Z", "is_private": false, "text": "Created attachment 30428\nPatch to explictly apr_file_seek() after truncating the request body temp file\n\nmod_fcgid 2.3.7 causes silent truncation of all but the first request that is larger than MaxRequestInMem in any given keepalive when used with the default RHEL/CentOS v5 httpd (patched 2.2.3).\n\nThis is caused by the fact that when the temporary file used to spool the requst body is truncated for reuse on subsequent requests the version of apr_file_trunc() bundled with httpd 2.2.3 doesn't lseek() to the truncated position.\n\nThis is fixed in the current httpd 2.2 (2.2.24), but given the nature of the problem (silent data truncation), the number of RHEL/CentOS 5 systems still around and the fact that the fix is very straightforward I'd suggest it's worth considering working around.\n\nThe attached patch resolves the issue by explicitly calling apr_file_seek() after apr_file_trunc() which I think should have minimal performance impact even when it's not strictly required."}]