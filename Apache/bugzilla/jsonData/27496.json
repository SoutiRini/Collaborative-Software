[{"count": 0, "tags": [], "creator": "hironori@jajakarta.org", "text": "I tried page break feature of POI-2.5-FINAL, and got trouble.\nI create a new workbook file with Excel and call HSSFSheet#getRowBreaks(), then \nit raises NullPointerException.\n\n(1) create a new workbook file (three sheets and no data) with Excel.\nI tried with Excel 2000 and XP.\n(2) create HSSFWorkbook instance for (1)'s workbook.\n(3) call workbook.getSheetAt() to get sheet.\n(4) call sheet.getRowBreaks(). It raises NPE.\n\nEnvironments:\n  Windows2000\n  J2SE 1.4.2_03\n  MS Excel2000\n  POI-2.5-FINAL\n\n\nHere is the stack trace.\n---\njava.lang.NullPointerException\n\tat org.apache.poi.hssf.model.Sheet.getNumRowBreaks(Sheet.java:2764)\n\tat org.apache.poi.hssf.usermodel.HSSFSheet.getRowBreaks(HSSFSheet.java:\n1144)\n\tat POISample.handleSheet(POISample.java:41)\n\tat POISample.main(POISample.java:26)\nException in thread \"main\" \n---\n\nand sample code\n---\npublic class POISample\n{\n\n  public static void main(final String[] args)\n    throws Exception\n  {\n    final HSSFWorkbook book = new HSSFWorkbook(new FileInputStream(args[0]));\n    POISample.handleSheet(book.getSheetAt(0));\n    book.write(new FileOutputStream(args[1]));\n  }\n\n  private static void handleSheet(final HSSFSheet sheet)\n  {\n    for (int i = 0; i < 5; ++i)\n    {\n      final HSSFRow row = sheet.createRow(i);\n      for (short j = 0; j < 5; ++j)\n      {\n        final HSSFCell cell = row.createCell(j);\n        cell.setCellValue(i + \":\" + j);\n      }\n    }\n    final int[] breaks = sheet.getRowBreaks();\n    sheet.setRowBreak(1);\n  }\n\n}\n---\n\nAdditionally, in some cases i succeeded calling getRowBreaks().\nIf the sheet already has some page breaks, or the sheet is created with \nHSSFWorkbook#createSheet(), it succeeds.\n\nkind regards.\n\nIRIE Hironori", "id": 53559, "time": "2004-03-06T17:13:11Z", "bug_id": 27496, "creation_time": "2004-03-06T17:13:11Z", "is_private": false, "attachment_id": null}, {"count": 1, "attachment_id": null, "bug_id": 27496, "text": "I'm getting a very similar problem with POI2.5-final when using\nHSSFSheet.setRowBreak(int). NPE if the workbook has not already RowBreaks.\nMy workaround: As I use a template originally without RowBreaks I introduce a\ntemporary RowBreaks into the template which I then delete from the application\n(using getRowBreaks()) and after this I put the real RowBreaks at the lines they\nshould go.\nJan-Martin Roth (jmroth@mtg.de)", "id": 58632, "time": "2004-06-03T13:02:34Z", "creator": "jmroth@mtg.de", "creation_time": "2004-06-03T13:02:34Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "text": "fixed in SVN\n\nJason", "attachment_id": null, "id": 93253, "creator": "jheight@apache.org", "time": "2006-09-08T21:06:56Z", "bug_id": 27496, "creation_time": "2006-09-08T21:06:56Z", "is_private": false}, {"count": 3, "attachment_id": null, "bug_id": 27496, "text": "I'm so sorry for my late verification.\nI checked with POI 3.0.1 and worked collect.", "id": 108150, "time": "2007-09-13T07:44:09Z", "creator": "hironori@jajakarta.org", "creation_time": "2007-09-13T07:44:09Z", "tags": [], "is_private": false}]