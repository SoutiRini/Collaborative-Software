[{"count": 0, "tags": [], "bug_id": 41563, "text": "Hi,\nI'm using Apache2.0.59, mod_jk1.2.20 and Tomcat5.0.28.\nThe resources are located in the area where is protected by Tomcat's\nBASIC authentication.\nWhen I send a request via HEAD method without account nor password,\nthe values of response headers are not recorded into the Apache2's\naccess log file.\nIn the following case of log related parameters for Apache2:\n\n LogFormat \"\\\"%{WWW-Authenticate}o\\\"\" combined\n CustomLog /var/log/httpd/access_log combined\n\nDespite the response includes a WWW-Authenticate header that are not\nempty values,\nthe log is set as \"-\" value.\n\nThis phenomenon does not happen at the case of neither Apache1.3.37\nnor the combination of Apache2.2.4 and mod_proxy_ajp.\n\nI guess that the return value from jk_handler's function causes this\nunexpected result.\nSince the generation of Apache2,\nthe value of 'sent_bodyct' has not been set as '1' when the\n'header_only' value is '1'\n&#65288;see httpd-2.0.59/modules/http/http_protocol.c L1765&#65289;.\nAs a result, the condition at\ntomcat-connectors-1.2.20-src/native/apache-2.0/mod_jk.c L2118\n      /* If tomcat returned no body and the status is not OK,\n         let apache handle the error code */\n      if (!r->sent_bodyct && r->status >= HTTP_BAD_REQUEST) {\n          jk_log(xconf->log, JK_LOG_INFO, \"No body with status=%d\"\n                 \" for worker=%s\",\n                 r->status, worker_name);\n          JK_TRACE_EXIT(xconf->log);\n          return r->status;\n      -- snip --\n      return OK;      /* NOT r->status, even if it has changed. */\nis true, and jk_handler returns the \"NOT OK\" value.\nFinnaly, the contents of headers table for Apache2 are all cleared.\n\nI suggest to mend the 'if'-condition clause as below:\n      if (!r->header_only && !r->sent_bodyct && r->status >=\nHTTP_BAD_REQUEST) {\n\nWhat do you think about this, bug or not?\nI would like to resolve this probelm.\n\nRegards,\n\nTaka J.S.", "id": 99079, "time": "2007-02-07T16:46:59Z", "creator": "jstaka@gmail.com", "creation_time": "2007-02-07T16:46:59Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "rbchung@gmail.com", "text": "Hi, \nWe also have Apache2.0.59, and we just upgraded mod_jk from 1.2.15 to 1.2.20.\nAfter upgrade, the web servers crashed few times causing major production\nissues, so we had to roll back mod_jk. We still don't know exactly why, but we\nwere also seeing \"-\" value as well assuming Taka is referring to the same.\n\n[22/Feb/2007:20:37:58 -0800] \"HEAD /index.html HTTP/1.0\" 200 - \"-\" \"Mozilla/4.06\n[en] (WinNT; I)\"\n[22/Feb/2007:20:38:03 -0800] \"HEAD /index.html HTTP/1.0\" 200 - \"-\" \"Mozilla/4.06\n[en] (WinNT; I)\"\n[22/Feb/2007:20:38:08 -0800] \"HEAD /index.html HTTP/1.0\" 200 - \"-\" \"Mozilla/4.06\n[en] (WinNT; I)\"\n[22/Feb/2007:20:38:13 -0800] \"HEAD /index.html HTTP/1.0\" 200 - \"-\" \"Mozilla/4.06\n[en] (WinNT; I)\"\n\nIs this known issue? We would like to have features on 1.2.20. What's\nrecommendation here?\n\nThanks.\n-rc\n", "count": 1, "id": 99736, "time": "2007-02-23T16:23:17Z", "bug_id": 41563, "creation_time": "2007-02-23T16:23:17Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 41563, "text": "Seems to work for 1.2.25-dev.", "id": 106389, "time": "2007-08-06T08:21:07Z", "creator": "rainer.jung@kippdata.de", "creation_time": "2007-08-06T08:21:07Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "rainer.jung@kippdata.de", "text": "Move a couple of fixed JK issues from resolved to closed.", "count": 3, "id": 112382, "time": "2008-01-01T16:32:26Z", "bug_id": 41563, "creation_time": "2008-01-01T16:32:26Z", "is_private": false}]