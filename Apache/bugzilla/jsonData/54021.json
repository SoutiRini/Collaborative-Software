[{"count": 0, "attachment_id": null, "creator": "wernernaehle@gmail.com", "text": "Hi, \n\nI have problems with differents MSG files. I open a file MSG with Oulook 2010 (32bit) and I can not read the body because the Outlook do not detect the content of the body. \n\nBut I know that the MSG file has a body and I can read the body when I open the body with the Internet Explorer. \nIt can make so: Actions-->View in the Browser \n\nThen, the POI library can neither processed the body from the MSG file. \n\nCan anybody help me? \n\nThanks, \n\nWarmest regards. \n\nWerner", "id": 162798, "time": "2012-10-17T17:55:59Z", "bug_id": 54021, "creation_time": "2012-10-17T17:55:59Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 54021, "attachment_id": null, "text": "Can you please upload a problematic file, and ideally a testcase that shows what you're trying to do with POI and what isn't working?", "id": 162799, "time": "2012-10-17T18:08:43Z", "creator": "apache@gagravarr.org", "creation_time": "2012-10-17T18:08:43Z", "is_private": false}, {"count": 2, "tags": [], "text": "Created attachment 29494\nThis is a MSG file example", "attachment_id": 29494, "id": 162808, "creator": "wernernaehle@gmail.com", "time": "2012-10-18T07:26:16Z", "bug_id": 54021, "creation_time": "2012-10-18T07:26:16Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 54021, "text": "\nFirstly, thanks for your answer.\n\nOk, I have uploaded a example file.\n\nRegards", "id": 162809, "time": "2012-10-18T07:28:19Z", "creator": "wernernaehle@gmail.com", "creation_time": "2012-10-18T07:28:19Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "creator": "wernernaehle@gmail.com", "attachment_id": null, "id": 162810, "time": "2012-10-18T07:45:32Z", "bug_id": 54021, "creation_time": "2012-10-18T07:45:32Z", "is_private": false, "text": "Hi, \n\nI use the following code to get a embedded MSG file:\n\nMAPIMessage msg = new MAPIMessage(INPUTFILE);\nAttachmentChunks[] attachments = msg.getAttachmentFiles();\n\nfor(AttachmentChunks attachment : attachments) {\n\n   DirectoryChunk chunkDirectory = attachment.attachmentDirectory;\n   MAPIMessage attachmentMSG = chunkDirectory.getAsEmbededMessage();"}, {"count": 5, "tags": [], "creator": "wernernaehle@gmail.com", "attachment_id": null, "id": 162811, "time": "2012-10-18T08:06:31Z", "bug_id": 54021, "creation_time": "2012-10-18T08:06:31Z", "is_private": false, "text": "Hi, \n\nI use the following code to get a embedded MSG file:\n\nMAPIMessage msg = new MAPIMessage(INPUTFILE);\nAttachmentChunks[] attachments = msg.getAttachmentFiles();\n\nfor(AttachmentChunks attachment : attachments) {\n\n   DirectoryChunk chunkDirectory = attachment.attachmentDirectory;\n   MAPIMessage attachmentMSG = chunkDirectory.getAsEmbededMessage();\n   String body = attachmentMSG.getTextBody(); \n}\n\nThe body is null because the library can not detect the content of the body and Outlook 2010 neither. But it can read the body with the Internet Explorer."}, {"count": 6, "attachment_id": 34595, "creator": "onealj@apache.org", "text": "Created attachment 34595\nunit test\n\nYou got a ChunkNotFoundException when calling getTextBody() because the message had an Html body instead of a plain text body. Only one body type (plain text, html, rtf) can be saved in a message.\n\nThis is the error that you would get if you checked getTextBody() on a message containing an html body.\n\nChunk not found\norg.apache.poi.hsmf.exceptions.ChunkNotFoundException: Chunk not found\n        at org.apache.poi.hsmf.MAPIMessage.getStringFromChunk(MAPIMessage.java:181)\n        at org.apache.poi.hsmf.MAPIMessage.getTextBody(MAPIMessage.java:194)\n        at org.apache.poi.hsmf.TestFileWithAttachmentsRead.test54021_read_text_body(TestFileWithAttachmentsRead.java:190)", "id": 195871, "time": "2017-01-05T10:38:42Z", "bug_id": 54021, "creation_time": "2017-01-05T10:38:42Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "bug_id": 54021, "text": "(In reply to Javen O'Neal from comment #6)\n>  Only one body type (plain text, html, rtf) can be saved in a message.\nIt appears that this is a false statement.\n\nA message can contain more than one body type, as indicated in test-data/hpsf/outlook_30_msg.msg from scratchpad/testcases/o.a.p.hpsf.TestBasics#testBody [1] in r1777463. However, a message is not required to store a plain text chunk. It's up to the mail client to figure out how to display a message by rendering the HTML or RTF if a text version is not present (plain text seems like a fallback anyways).\n\n[1] http://svn.apache.org/viewvc/poi/trunk/src/scratchpad/testcases/org/apache/poi/hsmf/TestBasics.java?r1=1777463&r2=1777462&pathrev=1777463", "id": 195875, "time": "2017-01-05T12:53:04Z", "creator": "onealj@apache.org", "creation_time": "2017-01-05T12:53:04Z", "is_private": false, "attachment_id": null}]