[{"count": 0, "attachment_id": null, "bug_id": 21646, "text": "Hello\n\nI have a similar problem as bug 15375 but I can simulate it with very little \ncode.\n\n\nHere is a class that creates two spreadsheets, one good and one bad.\n\n\nimport java.io.FileOutputStream;\n\nimport org.apache.poi.hssf.usermodel.HSSFCell;\nimport org.apache.poi.hssf.usermodel.HSSFRow;\nimport org.apache.poi.hssf.usermodel.HSSFSheet;\nimport org.apache.poi.hssf.usermodel.HSSFWorkbook;\n\n/**\n * HSSFTest.java\n * \n * @author mjeffery\n * @created 2003/07/16\n * @version 1a\n */\npublic class HSSFTest {\n\n  HSSFWorkbook wb = null;\n  HSSFSheet sheet = null;\n  HSSFRow row = null;\n  HSSFCell cell = null;\n\n  public void createSheetThatCanOpen() {\n    try {\n\n      wb = new HSSFWorkbook();\n      sheet = wb.createSheet();\n\n      for (int i = 0; i < 6000; i++) {\n\n        row = sheet.createRow((short)i);\n\n        cell = row.createCell((short)0);\n        cell.setCellValue(\"Test0\");\n        cell = row.createCell((short)1);\n        cell.setCellValue(\"Test1\");\n        cell = row.createCell((short)2);\n        cell.setCellValue(\"Test2\");\n      }\n\n      FileOutputStream fileOut = new FileOutputStream(\"c:/warrawarra/good.xls\");\n      wb.write(fileOut);\n      fileOut.close();\n\n    } catch (Exception e) {\n      e.printStackTrace();\n    }\n  }\n\n  public void createSheetThatCannotOpen() {\n    try {\n\n      wb = new HSSFWorkbook();\n      sheet = wb.createSheet();\n\n      String tmp1 = null;\n      String tmp2 = null;\n      String tmp3 = null;\n\n      for (int i = 0; i < 6000; i++) {\n        tmp1 = \"Test1\" + i;\n        tmp2 = \"Test2\" + i;\n        tmp3 = \"Test3\" + i;\n\n        row = sheet.createRow((short)i);\n\n        cell = row.createCell((short)0);\n        cell.setCellValue(tmp1);\n        cell = row.createCell((short)1);\n        cell.setCellValue(tmp2);\n        cell = row.createCell((short)2);\n        cell.setCellValue(tmp3);\n      }\n\n      FileOutputStream fileOut = new FileOutputStream(\"c:/warrawarra/bad.xls\");\n      wb.write(fileOut);\n      fileOut.close();\n\n    } catch (Exception e) {\n      e.printStackTrace();\n    }\n  }\n\n  public static void main(String[] args) {\n    HSSFTest test = new HSSFTest();\n\n    test.createSheetThatCanOpen();\n    test.createSheetThatCannotOpen();\n  }\n\n}\n\n\nIt seems as if when passing a hardcoded String to the setCellValue method it \nworks fine but when passing a variable String it does not correctly create the \nspreadsheet.\n\nThe strange thing is when reducing the loop size to 50 in the \ncreateSheetThatCannotOpen() method, it works fine ?\n\nThis problem does not exist in jakarta-poi-1.5.1-final-20020615.\n\nAny help will be appreciated.", "id": 40803, "time": "2003-07-16T11:03:06Z", "creator": "dandare100@yahoo.com", "creation_time": "2003-07-16T11:03:06Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "text": "Created attachment 7327\nClass that simulates the described bug", "attachment_id": 7327, "id": 40804, "creation_time": "2003-07-16T11:04:32Z", "time": "2003-07-16T11:04:32Z", "creator": "dandare100@yahoo.com", "bug_id": 21646, "is_private": false}, {"count": 2, "attachment_id": null, "bug_id": 21646, "is_private": false, "id": 41426, "time": "2003-07-24T17:13:23Z", "creator": "poi-support@buni.org", "creation_time": "2003-07-24T17:13:23Z", "tags": [], "text": "we should fix this."}, {"count": 3, "attachment_id": null, "bug_id": 21646, "is_private": false, "id": 41641, "time": "2003-07-28T11:15:41Z", "creator": "dandare100@yahoo.com", "creation_time": "2003-07-28T11:15:41Z", "tags": [], "text": "I have noticed that (In my case) as soon as the SST table becomes very big this \nhappens.\n\nI can put thousands of strings into a spreadsheet as long as there are not too \nmany unique ones. As soon as there are plenty unique strings the sheet can't \nopen.\n\nUsing the BIFF Viewer, I see that CONTINUE RECORD's are written for the \nspreadsheet that can't open and none are written for a spreadsheet that can \nopen.\n\nFrom looking at the source (I am not sure though) it seems that these CONTINUE \nRECORDs are a major change between POI 1.5.1 and POI2.\n\nAm I on the wrong track ???"}, {"count": 4, "tags": [], "bug_id": 21646, "attachment_id": null, "id": 41683, "time": "2003-07-28T20:10:40Z", "creator": "sanjay.tated@oracle.com", "creation_time": "2003-07-28T20:10:40Z", "is_private": false, "text": "Hello \n I have a similiar problem while populating the excel sheet. if the rows are\nmore then 3000(Apprx 640kb). then i am not able to open the excel file. It just\nflash. \nElse it is ok. Iam populating the excel sheet from database. \nI can see the size of the downloaded file eg: 900kb.\n\nLet me know if you have any resolution for this. Or any planned fix for the bug.\n\nDo you think the size may be the problem.\n\nthanks\nSanjay "}, {"count": 5, "tags": [], "creator": "avik@apache.org", "attachment_id": null, "text": "This is the same as bug 15375. The testcase here has been attached to 15375 as\nwell. Marking this invalid, please track 15375 (not marking this as duplicate\nsince the mailing list on 15375 is already more than 10 people, dont want to\nspam them further!!)", "id": 45129, "time": "2003-10-06T09:51:37Z", "bug_id": 21646, "creation_time": "2003-10-06T09:51:37Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 21646, "text": "Will mark this as duplicate to ensure correct records for future use!", "count": 6, "id": 45211, "time": "2003-10-07T15:57:37Z", "creator": "avik@apache.org", "creation_time": "2003-10-07T15:57:37Z", "is_private": false}, {"count": 7, "tags": [], "creator": "avik@apache.org", "is_private": false, "text": "\n\n*** This bug has been marked as a duplicate of 15375 ***", "id": 45212, "time": "2003-10-07T15:58:02Z", "bug_id": 21646, "creation_time": "2003-10-07T15:58:02Z", "attachment_id": null}]