[{"count": 0, "tags": [], "bug_id": 4794, "attachment_id": null, "id": 7755, "time": "2001-11-11T05:56:33Z", "creator": "keeskuip@technologist.com", "creation_time": "2001-11-11T05:56:33Z", "is_private": false, "text": "I sometimes get an java.lang.InternalError when compiling with ant.\nThis happens on windowsNT and Linux.\nI'm using jdk1.3.1_01 from sun.\n\nThe strange thing is that when I start ant again, it compiles without\n  any errors.\n\nCould it be that ant (javac) is trying to use a corrupted jar-file. \nIt then throws away that jar-file. And the next time the jar-file is \nnot there, so it rebuilds that jar-file.\n\nThe errortrace is below :\n\n\n[kees@chocomel]# ant\nBuildfile: build.xml\n\nprepare:\n     [echo] *** project/batchEngine ***\n\nprepare:\n     [echo] *** klant ***\n\ncheck_for_optional_packages:\n\ncompile:\n\njar:\n      [jar] Building jar:\n/usr/local/project/projecten/Verkade/build/lib/klant/ini.jar\n\ncheck_for_optional_packages:\n\ncompile:\n    [javac] Compiling 1 source file to\n/usr/local/project/projecten/Verkade/project/batchEngine/classes\n    [javac] An exception has occurred in the compiler (1.3.1_01). Please file a\nbug at the Java Developer Connection\n(http://java.sun.com/cgi-bin/bugreport.cgi).  Include your program and the\nfollowing diagnostic in your report.  Thank you.\n    [javac] java.lang.InternalError: jzentry == 0\n    [javac] \tat java.util.zip.ZipFile$2.nextElement(ZipFile.java:297)\n    [javac] \tat\ncom.sun.tools.javac.v8.code.ClassReader.openArchive(ClassReader.java:893)\n    [javac] \tat com.sun.tools.javac.v8.code.ClassReader.list(ClassReader.java:1095)\n    [javac] \tat com.sun.tools.javac.v8.code.ClassReader.listAll(ClassReader.java:1191)\n    [javac] \tat com.sun.tools.javac.v8.code.ClassReader.fillIn(ClassReader.java:1213)\n    [javac] \tat com.sun.tools.javac.v8.code.ClassReader.complete(ClassReader.java:955)\n    [javac] \tat com.sun.tools.javac.v8.code.Symbol.complete(Symbol.java:366)\n    [javac] \tat com.sun.tools.javac.v8.comp.Enter._case(Enter.java:424)\n    [javac] \tat com.sun.tools.javac.v8.tree.Tree$TopLevel.visit(Tree.java:349)\n    [javac] \tat com.sun.tools.javac.v8.comp.Enter.classEnter(Enter.java:392)\n    [javac] \tat com.sun.tools.javac.v8.comp.Enter.classEnter(Enter.java:410)\n    [javac] \tat com.sun.tools.javac.v8.comp.Enter.main(Enter.java:540)\n    [javac] \tat com.sun.tools.javac.v8.JavaCompiler.compile(JavaCompiler.java:357)\n    [javac] \tat com.sun.tools.javac.v8.Main.compile(Main.java:247)\n    [javac] \tat com.sun.tools.javac.Main.compile(Main.java:26)\n    [javac] \tat java.lang.reflect.Method.invoke(Native Method)\n    [javac] \tat\norg.apache.tools.ant.taskdefs.compilers.Javac13.execute(Javac13.java:92)\n    [javac] \tat org.apache.tools.ant.taskdefs.Javac.execute(Javac.java:530)\n    [javac] \tat org.apache.tools.ant.Task.perform(Task.java:217)\n    [javac] \tat org.apache.tools.ant.Target.execute(Target.java:164)\n    [javac] \tat org.apache.tools.ant.Target.performTasks(Target.java:182)\n    [javac] \tat org.apache.tools.ant.Project.executeTarget(Project.java:601)\n    [javac] \tat org.apache.tools.ant.Project.executeTargets(Project.java:560)\n    [javac] \tat org.apache.tools.ant.Main.runBuild(Main.java:454)    [javac] \tat\norg.apache.tools.ant.Main.start(Main.java:153)\n    [javac] \tat org.apache.tools.ant.Main.main(Main.java:176)\n\nBUILD FAILED\n\n/usr/local/project/projecten/Verkade/project/batchEngine/build.xml:94: Compile\nfailed, messages should have been provided.\n\nTotal time: 4 seconds"}, {"count": 1, "tags": [], "creator": "sbailliez@apache.org", "is_private": false, "text": "This looks like is a javac bug (or ZipFile)...\nAs specified please report to Sun it's probably of interest to them.\n\nI have been observing a similar bug in certain circumstances with a previous \nJDK 1.3 version but it was fixed in 1.3.1.\nSee http://developer.java.sun.com/developer/bugParade/bugs/4256830.html\n\nI quickly looked at javac ClassReader code in the JDK source and there is \nreally nothing special in it, it is opening a zipfile and looping around the \nentries.\n\nCould you please file this bug to Sun and set this one as Invalid ?\nFor the records, could you please confirm that the jar you are building is the \none used by javac just after ?", "id": 7887, "time": "2001-11-13T14:49:40Z", "bug_id": 4794, "creation_time": "2001-11-13T14:49:40Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 4794, "attachment_id": null, "id": 10213, "time": "2002-02-02T08:13:29Z", "creator": "umagesh@apache.org", "creation_time": "2002-02-02T08:13:29Z", "is_private": false, "text": "Marking as invalid.  Stephane has already stated reasons."}, {"count": 3, "tags": [], "creator": "keeskuip@technologist.com", "text": "\nThe workaround I use for this bug is setting the property \nbuild.compiler to extJavac.\nso :\n  <property name=\"build.compiler\" value=\"extJavac\"/>\n\nI still believe it is a problem with ant and the way it uses javac.\n\n\n", "id": 10450, "attachment_id": null, "bug_id": 4794, "creation_time": "2002-02-07T15:03:09Z", "time": "2002-02-07T15:03:09Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 4794, "is_private": false, "id": 10455, "creation_time": "2002-02-07T15:17:24Z", "time": "2002-02-07T15:17:24Z", "creator": "umagesh@apache.org", "text": "If that is the case, I would need more from you:  for example, you have to\nhelp me reproduce the problem in a consistent manner by providing me with the\nnecessary source & Ant build files.  But don't send me your whole application\nsource or something like that :-)  Just send me the testcase that would fail.\n", "attachment_id": null}]