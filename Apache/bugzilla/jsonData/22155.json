[{"count": 0, "tags": [], "bug_id": 22155, "attachment_id": null, "id": 42225, "time": "2003-08-06T04:04:32Z", "creator": "kevin@rocketred.com.au", "creation_time": "2003-08-06T04:04:32Z", "is_private": false, "text": "Any xpath expression that returns anything but a nodeset will fail.\nFor example these three queries all result in exception.\n\nboolean(//person)\nstring(//person[first='John' and last='Smith']/first)\ncount(//person[first='John' and last='Smith'])\n\nTo support this the we will need to update the NodeSet implementation to support\nother datatypes.\n\nI've added unit tests to the test suite that expose this problem"}, {"count": 1, "tags": [], "creator": "vgritsenko@apache.org", "attachment_id": null, "is_private": false, "id": 53423, "time": "2004-03-04T13:23:34Z", "bug_id": 22155, "creation_time": "2004-03-04T13:23:34Z", "text": "Fixed, Closed."}, {"attachment_id": null, "tags": [], "creator": "ysimmhan@cs.indiana.edu", "text": "Problem in XPathQueryResolver.ResultSet.prepareNextNode() when iterating over \nCollection and empty document i.e. '<?xml version=\"1.0\" encoding=\"UTF-8\"?>' is \nreturned. Then the node returned by the document is null and a an exception is \nthrown at xp.execute(xpc, n, pfx) -- (exception attached at end). Checking for \nnode != null fixes this problem. I'm not sure though how the empty document go \ninto the DB in the first place.\n\nDBDocument d = (DBDocument) context.getDocument(keySet[keyPos++]);\n// dom2str(d) == \"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\"\nif (d == null) {\n  continue;\n}\nNode n = d.getDocumentElement();\n// n == null\nif(n == null) continue; // added to fix the problem\n\n\nException thrown by xp.execute(xpc, n, pfx):\njava.lang.IllegalArgumentException: Node must be non-null for \ngetDTMHandleFromNode\n\tat org.apache.xml.dtm.ref.DTMManagerDefault.getDTMHandleFromNode\n(DTMManagerDefault.java:543)\n\tat org.apache.xpath.XPathContext.getDTMHandleFromNode\n(XPathContext.java:220)\n\tat org.apache.xpath.XPath.execute(XPath.java:274)\n\tat \norg.apache.xindice.core.query.XPathQueryResolver$ResultSet.prepareNextNode\n(XPathQueryResolver.java:1211)\n\tat \norg.apache.xindice.core.query.XPathQueryResolver$ResultSet.getNextNode\n(XPathQueryResolver.java:1267)\n\tat org.apache.xindice.core.query.QueryUtil.queryResultsToDOM\n(QueryUtil.java:75)\n\tat org.apache.xindice.core.query.QueryUtil.queryResultsToDOM\n(QueryUtil.java:134)\n\tat org.apache.xindice.client.xmldb.embed.CollectionImpl.query\n(CollectionImpl.java:437)\n\tat org.apache.xindice.client.xmldb.XindiceCollection.query\n(XindiceCollection.java:259)\n\tat org.apache.xindice.client.xmldb.services.QueryService.query\n(QueryService.java:90)\n\tat edu.indiana.extreme.gsx.util.XindiceUtil.executeXPath\n(XindiceUtil.java:514)\n\nThanks.\n--Yogesh\n\n", "count": 2, "id": 53543, "time": "2004-03-05T22:51:25Z", "bug_id": 22155, "creation_time": "2004-03-05T22:51:25Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 22155, "text": "Thanks for your observation. Can you also turn on DEBUG and see may be there are\nsome ignored exceptions preceding this?", "id": 53544, "time": "2004-03-05T23:39:24Z", "creator": "vgritsenko@apache.org", "creation_time": "2004-03-05T23:39:24Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "vgritsenko@apache.org", "text": "Yogesh, any updates?", "count": 4, "id": 54308, "time": "2004-03-20T13:48:55Z", "bug_id": 22155, "creation_time": "2004-03-20T13:48:55Z", "is_private": false}, {"count": 5, "tags": [], "creator": "vgritsenko@apache.org", "attachment_id": null, "text": "Added test for null getDocumentElement() with log statement.", "id": 57791, "time": "2004-05-21T12:48:21Z", "bug_id": 22155, "creation_time": "2004-05-21T12:48:21Z", "is_private": false}]