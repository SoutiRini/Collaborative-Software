[{"count": 0, "tags": [], "bug_id": 40548, "attachment_id": null, "text": "Our application programmatically sets certain rows as header columns for \nprinting purposes, and makes use of the setRepeatingRowsAndColumns() method of \nHSSFWorkbook to accomplish this.  However, on certain spreadsheets, that \nmethod throws an exception similar to the following:\n\njava.lang.ArrayIndexOutOfBoundsException: -1\n\tat java.util.ArrayList.get(Unknown Source)\n\tat org.apache.poi.hssf.record.ExternSheetRecord.getREFRecordAt\n(ExternSheetRecord.java:122)\n\tat org.apache.poi.hssf.model.Workbook.getSheetIndexFromExternSheetIndex\n(Workbook.java:1799)\n\tat \norg.apache.poi.hssf.usermodel.HSSFWorkbook.findExistingRowColHeaderNameRecordId\nx(HSSFWorkbook.java:730)\n\tat \norg.apache.poi.hssf.usermodel.HSSFWorkbook.findExistingRowColHeaderNameRecord\n(HSSFWorkbook.java:717)\n\tat \norg.apache.poi.hssf.usermodel.HSSFWorkbook.setRepeatingRowsAndColumns\n(HSSFWorkbook.java:650)\n\tat com.tcg.Bug6839TestHarness.main(Bug6839TestHarness.java:44)\n\nWe *think* that this happens in spreadsheets with pre-existing print areas, \nbut we're not sure.  We have observed this behavior in both 2.5.1 final and \nthe 3.0alpha2.  Test case and example spreadsheet to come.", "id": 93795, "time": "2006-09-19T16:50:58Z", "creator": "rich.renomeron@tcg.com", "creation_time": "2006-09-19T16:50:58Z", "is_private": false}, {"count": 1, "tags": [], "text": "Created attachment 18886\nSpreadsheet that causes the exception\n\nHere's an example spreadsheet that causes the exception when\nHSSFWorkbook.setRepeatingRowsAndColumns() is run on it.", "is_private": false, "id": 93796, "creator": "rich.renomeron@tcg.com", "time": "2006-09-19T16:56:01Z", "bug_id": 40548, "creation_time": "2006-09-19T16:56:01Z", "attachment_id": 18886}, {"count": 2, "tags": [], "bug_id": 40548, "attachment_id": 18887, "text": "Created attachment 18887\nJava code for testing\n\nJava class that shows the error.  Run the example spreadsheet with this.", "id": 93797, "time": "2006-09-19T16:58:04Z", "creator": "rich.renomeron@tcg.com", "creation_time": "2006-09-19T16:58:04Z", "is_private": false}, {"count": 3, "tags": [], "creator": "poi-support@buni.org", "text": "Created attachment 19333\nOutput from non-crashing code\n\nThis is the output from my patch that I will commit shortly.", "id": 97503, "time": "2006-12-31T10:41:59Z", "bug_id": 40548, "creation_time": "2006-12-31T10:41:59Z", "is_private": false, "attachment_id": 19333}, {"count": 4, "tags": [], "bug_id": 40548, "is_private": false, "id": 97504, "attachment_id": 19334, "creator": "poi-support@buni.org", "creation_time": "2006-12-31T10:43:22Z", "time": "2006-12-31T10:43:22Z", "text": "Created attachment 19334\nupdated test case to generate foobar.xls attachment (now writes output)\n\nUpdated test case based on attachment 18887 which takes output file (and writes\nit)"}, {"count": 5, "tags": [], "creator": "poi-support@buni.org", "text": "The problem was caused by HSSF set Repeating Rows/Cols function (BTW that\nfunction has a repugnantly cryptic interface, we should make friendlier helper\nfunctions that do the -1 magic for you).  It didn't take into account \"global\"\n\"NAME\" records with a \"0\" in field 6 (thus we ended up looking for sheet record\n-1).  this patch ignores globals when using the extern sheet ref function. ", "id": 97505, "time": "2006-12-31T10:46:52Z", "bug_id": 40548, "creation_time": "2006-12-31T10:46:52Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "text": "Created attachment 19335\npatch to fix this problem\n\npatch that fixes problem (committed after further testing)", "is_private": false, "id": 97506, "creator": "poi-support@buni.org", "time": "2006-12-31T10:47:50Z", "bug_id": 40548, "creation_time": "2006-12-31T10:47:50Z", "attachment_id": 19335}, {"count": 7, "tags": [], "creator": "poi-support@buni.org", "text": "(fix to fulfill a bunisoft support contract)", "id": 97507, "time": "2006-12-31T10:50:16Z", "bug_id": 40548, "creation_time": "2006-12-31T10:50:16Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "bug_id": 40548, "attachment_id": null, "text": "Assuming that this is fixed.\n\nHSSFWorkbook has been refactored and this patch whether actually applied or not, is no longer relevant.\n\nPlease advise if this needs further work.", "id": 123599, "time": "2008-12-29T16:06:38Z", "creator": "dfisher@jmlafferty.com", "creation_time": "2008-12-29T16:06:38Z", "is_private": false}]