[{"count": 0, "tags": [], "creator": "phil@ipom.com", "attachment_id": null, "id": 70487, "time": "2005-02-04T05:25:02Z", "bug_id": 33398, "creation_time": "2005-02-04T05:25:02Z", "is_private": false, "text": "ServerName and Port are available for virtualization, proxying to apache, and\nload balancing so that apache knows how to refer to itself in such situations.\n\nHowever, in an SSL offloading situation, we need to be able to tell apache that\nit's scheme is 'https' not http so that when it creates self-referencing URLS,\nthey have the right scheme.\n\nSo I'd like a \"Scheme\" or \"ServerScheme\" type of Directive so that SSL\noffloading can happen with an application having specifically override this.\n\nThanks"}, {"count": 1, "attachment_id": null, "bug_id": 33398, "text": "Additional note: In 2.0 \"ServerName\" and \"Port\" were collapsed into one, but\nstill have the same problem - ServerName can't be prefixed with a scheme. So the\nproblem/request is still valid for 2.0 even though the report was made against 1.x", "id": 70492, "time": "2005-02-04T08:26:21Z", "creator": "phil@ipom.com", "creation_time": "2005-02-04T08:26:21Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 33398, "attachment_id": null, "is_private": false, "id": 70496, "time": "2005-02-04T09:54:21Z", "creator": "chip@force-elite.com", "creation_time": "2005-02-04T09:54:21Z", "text": "A generic method to identify a scheme would be better.  This would also fix the\nissues with TCP_DEFER and AcceptFilters in /trunk/\n\nI think something like mod_acceptfiler is the best path to take:\nhttp://marc.theaimsgroup.com/?l=apache-httpd-dev&m=110297187029584&w=2\n\n\n-Paul"}, {"count": 3, "tags": [], "creator": "phil@ipom.com", "is_private": false, "id": 70505, "attachment_id": null, "bug_id": 33398, "creation_time": "2005-02-04T18:09:26Z", "time": "2005-02-04T18:09:26Z", "text": "I really don't see how mod_acceptfilter solves this problem. It would allow me\nto not accept http, but that's not what I need - that's the equivalent of adding\nscheme to \"Listen.\"\n\nI need to add scheme to \"ServerName\" -- I want the server to LISTEN on http, but\nknow that it should be referenced by https. In the same way I can listen on\nbackend.domain.com but know that people refer to be on service.domain.com which\nis one a load balancer in front of me so that I create self-referencing URLs\nproperly."}, {"count": 4, "tags": [], "creator": "phil@ipom.com", "is_private": false, "id": 72312, "attachment_id": null, "bug_id": 33398, "creation_time": "2005-03-13T23:19:08Z", "time": "2005-03-13T23:19:08Z", "text": "I'm changing the severity on this, as it's actually causing us pretty big issues\nnow, and I can't imagine this isn't causing other people problems. In my opinion\nthis is the bug in the apache virtualization feature.\n\n- Phil"}, {"count": 5, "tags": [], "bug_id": 33398, "attachment_id": null, "id": 72313, "time": "2005-03-13T23:20:32Z", "creator": "phil@ipom.com", "creation_time": "2005-03-13T23:20:32Z", "is_private": false, "text": "BTW, there's a similar bug report for Tomcat:\n\nhttp://issues.apache.org/bugzilla/show_bug.cgi?id=33970\n"}, {"count": 6, "tags": [], "bug_id": 33398, "text": "I would like to kill two bugs with one patch.  The Accept Filter issue could almost be considered a \nblocker on 2.2 since it breaks mod_nntp tests....", "id": 72315, "time": "2005-03-14T00:09:17Z", "creator": "chip@force-elite.com", "creation_time": "2005-03-14T00:09:17Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "text": "Per the comments, I'm changing this to blocker - I thought I did this already,\nbut it appears I didn't.", "attachment_id": null, "id": 73203, "creation_time": "2005-04-02T07:57:55Z", "time": "2005-04-02T07:57:55Z", "creator": "phil@ipom.com", "bug_id": 33398, "is_private": false}, {"count": 8, "attachment_id": null, "bug_id": 33398, "text": "Any update on this? I suspect the code should be similar to the virtualization\ncode for ServerName and Port... \n\nI keep trying to look into changing this myself, but I keep not having the time. ;(\n\n- Phil", "id": 77600, "time": "2005-07-23T05:52:49Z", "creator": "phil@ipom.com", "creation_time": "2005-07-23T05:52:49Z", "tags": [], "is_private": false}, {"count": 9, "tags": [], "text": "AcceptFilter code is in, and SSL can now be enabled by setting:\n\nListen 443 https\n\n<VirtualHost 1.2.3.4:443>\n# Protocol https in inherient, and SSLEngine is not required.\n</VirtualHost>", "attachment_id": null, "id": 77604, "creator": "chip@force-elite.com", "time": "2005-07-24T21:05:31Z", "bug_id": 33398, "creation_time": "2005-07-24T21:05:31Z", "is_private": false}, {"count": 10, "tags": [], "text": "That doesn't really solve the problem (if I understand your config snippet right).\n\nWhat would be needed is more like:\n\n<VirtualHost 1.2.3.4:80>\n   Scheme SSL\n   SSLEnine off\n</VirtualHost>\n\nThe idea here is that we're doing SSL offloading (much like when we virtualize\nthe name for load balancing). The traffic we get is non-SSL on port 80, but all\nself-referencing URLs need to be https:// because that's what the load balancer\nneeds. It's the same way we can set Host and Port even if it's not the host and\nport we're listening on.\n\n- Phil", "attachment_id": null, "id": 77606, "creation_time": "2005-07-24T21:26:54Z", "time": "2005-07-24T21:26:54Z", "creator": "phil@ipom.com", "bug_id": 33398, "is_private": false}, {"count": 11, "tags": [], "text": "Any update?", "attachment_id": null, "id": 85384, "creation_time": "2006-02-03T10:27:21Z", "time": "2006-02-03T10:27:21Z", "creator": "phil@ipom.com", "bug_id": 33398, "is_private": false}, {"count": 12, "attachment_id": null, "bug_id": 33398, "text": "This was fixed on the trunk:\n\n  http://svn.apache.org/viewvc?diff_format=h&view=rev&revision=399947\n\nand has been proposed for backport to 2.2.x:\n\n  http://people.apache.org/~sctemme/servername_22x.patch\n\nThis isn't going to get fixed for 1.3.x, see Sander's comments here:\n\nhttp://mail-archives.apache.org/mod_mbox/httpd-dev/200605.mbox/%3c726B10D7-6436-4BC5-ABA1-DE8E41C8A5CC@apache.org%3e\n\nso I'm going to mark this as fixed.", "id": 89337, "time": "2006-05-22T09:54:56Z", "creator": "jorton@redhat.com", "creation_time": "2006-05-22T09:54:56Z", "tags": [], "is_private": false}, {"count": 13, "tags": [], "bug_id": 33398, "attachment_id": null, "text": "Backported to 2.2.x as r425051 (http://svn.apache.org/viewvc?rev=425051&view=rev).", "id": 91544, "time": "2006-07-24T13:59:55Z", "creator": "rpluem@apache.org", "creation_time": "2006-07-24T13:59:55Z", "is_private": false}, {"count": 14, "tags": [], "creator": "phil@ipom.com", "attachment_id": null, "id": 91564, "time": "2006-07-25T04:11:32Z", "bug_id": 33398, "creation_time": "2006-07-25T04:11:32Z", "is_private": false, "text": "This is excellent, thanks guys! SSL-offloading applications in apache just\nbecame a whole lot easier.\n\n- Phil"}]