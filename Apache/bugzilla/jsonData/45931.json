[{"count": 0, "tags": [], "creator": "meetesh.karia@alumni.duke.edu", "text": "Created attachment 22665\nreplace whitespace with single space\n\nEnabling trimSpaces collapses all spaces to nothing which can end up removing desired whitespace from the generated html.\n\nA possible solution to this is to reduce whitespace to a single space rather than removing it altogether.  The attached patch has this implementation.", "id": 121138, "time": "2008-10-01T12:43:22Z", "bug_id": 45931, "creation_time": "2008-10-01T12:43:22Z", "is_private": false, "attachment_id": 22665}, {"count": 1, "tags": [], "bug_id": 45931, "attachment_id": null, "is_private": false, "id": 121175, "time": "2008-10-03T07:20:41Z", "creator": "markt@apache.org", "creation_time": "2008-10-03T07:20:41Z", "text": "trimSpaces is equivalent to trimDirectiveWhitespaces\n\nSection JSP.3.3.8 is clear that the whitespace must be removed completely.\n\ntrimSpaces can currently be true or false. I would not be against an enhancement that added the value \"single\" and in that case using the code in your patch.\n\nLet us know if you need some pointers on writing a new patch."}, {"count": 2, "tags": [], "text": "Hi Mark,\n\nThanks for the comment.  The main question I have is whether you'd want to leave the -trimspaces option for JspC backwards-compatible (ie, if there's no \"true\", \"false\", or \"single\" after it, treat it as \"true\"), or whether you'd be ok with changing the behavior to requiring the value after the flag.\n\nAlso, if there's anything else that's important to keep in mind when writing a patch for tomcat, please share.\n\nThanks!\n\n(In reply to comment #1)\n> trimSpaces is equivalent to trimDirectiveWhitespaces\n> \n> Section JSP.3.3.8 is clear that the whitespace must be removed completely.\n> \n> trimSpaces can currently be true or false. I would not be against an\n> enhancement that added the value \"single\" and in that case using the code in\n> your patch.\n> \n> Let us know if you need some pointers on writing a new patch.\n> \n\n", "is_private": false, "id": 121181, "creator": "meetesh.karia@alumni.duke.edu", "time": "2008-10-03T10:22:50Z", "bug_id": 45931, "creation_time": "2008-10-03T10:22:50Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 45931, "attachment_id": null, "is_private": false, "id": 121182, "time": "2008-10-03T10:50:13Z", "creator": "markt@apache.org", "creation_time": "2008-10-03T10:50:13Z", "text": "Keep the current behaviour (ie true) if nothing is specified for trimspaces since that is backwards compatible.\n\nThings to keep in mind:\n - patches should be in diff -u format\n - avoid changing stuff that isn't relevant (ie don't mix a functional patch with code clean-up)\n - keep the patch as simple as you can\n\nNote I have re-opened this as an enhancement so it doesn't get lost."}, {"count": 4, "tags": [], "bug_id": 45931, "attachment_id": 22843, "is_private": false, "id": 122294, "time": "2008-11-07T13:30:40Z", "creator": "meetesh.karia@alumni.duke.edu", "creation_time": "2008-11-07T13:30:40Z", "text": "Created attachment 22843\nAdds a third state for the trimSpaces flag\n\nThis patch adds the \"single\" value for trimSpaces.  I wasn't able to find any automated tests for jasper so I did lots of manual testing.  If there is a test suite and someone can point me to it, I can add in an automated test or two.\n\nAlso, when trying to manually test this, I noticed that precompiling tags that worked against 6.0.18 didn't work against the trunk.  So, I was able to test the embeddable servlet option functionality against the trunk but only able to test the jspc functionality against 6.0.18.  Also, none of the places of code affected by the patch appear to have been changed between 6.0.18 and the current trunk."}, {"attachment_id": null, "tags": [], "bug_id": 45931, "is_private": false, "count": 5, "id": 123204, "time": "2008-12-09T11:04:21Z", "creator": "meetesh.karia@alumni.duke.edu", "creation_time": "2008-12-09T11:04:21Z", "text": "Hi all, I was just wondering if there was a timeline for review/inclusion of this patch.  Thanks!\n"}, {"count": 6, "tags": [], "text": "(In reply to comment #5)\n> Hi all, I was just wondering if there was a timeline for review/inclusion of\n> this patch.  Thanks!\n\nI'm wondering this as well.  Any ETA for a release?", "is_private": false, "id": 125650, "creator": "tcook@interprisesoftware.com", "time": "2009-03-20T06:33:31Z", "bug_id": 45931, "creation_time": "2009-03-20T06:33:31Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 45931, "text": "I think it's worth mentioning that adding this feature potentially makes Tomcat incompatible with other app servers: if people use this \"single\" feature, and then move to another app server that doesn't support this kind of configuration, they'll have to change all their JSPs to suit.\n\nIf this feature is added, it should be very clear in the documentation that its use should be restricted to dire circumstances, and that JSP authors should be using the more portable workaround to forcing spaces to appear between directives, etc.:\n\n${thingOne}${' '}${thingTwo}", "id": 131218, "time": "2009-10-19T08:08:58Z", "creator": "chris@christopherschultz.net", "creation_time": "2009-10-19T08:08:58Z", "is_private": false, "attachment_id": null}, {"count": 8, "tags": [], "creator": "knst.kolinko@gmail.com", "is_private": false, "text": "(In reply to comment #7)\n> I think it's worth mentioning that adding this feature potentially makes Tomcat\n> incompatible with other app servers: if people use this \"single\" feature, and\n> then move to another app server that doesn't support this kind of\n> configuration, they'll have to change all their JSPs to suit.\n>\n\nIn other web servers the space will not be removed at all. They will render several spaces instead of that single one. Nothing is lost, but just wasting some bandwidth.", "id": 139473, "time": "2010-08-25T17:06:38Z", "bug_id": 45931, "creation_time": "2010-08-25T17:06:38Z", "attachment_id": null}, {"count": 9, "tags": [], "creator": "markt@apache.org", "text": "First of all, let me apologise for letting this one slip through the cracks.\n\nI'm currently reviewing all open Tomcat enhancement requests as part of the end-of-life process.\n\nI am struggling to see a use case for this option. trimSpaces applies to each block of template text in turn. I'm struggling to see a (non-contrived) use case where the option for a single space would be useful. Therefore, I am resolving this as WONTFIX.\n\nI'd be more than happy to revisit this but I would ask that a sample JSP be provided (ideally one that works when dropped into a clean Tomcat install) that demonstrates a use case for this new option.", "id": 198204, "time": "2017-04-07T14:18:53Z", "bug_id": 45931, "creation_time": "2017-04-07T14:18:53Z", "is_private": false, "attachment_id": null}, {"count": 10, "tags": [], "bug_id": 45931, "attachment_id": null, "is_private": false, "id": 198938, "time": "2017-05-29T11:26:55Z", "creator": "david.kavanagh@marfeel.com", "creation_time": "2017-05-29T11:26:55Z", "text": "Hello,\n\nI am reopening this enhancement request, at the request of Mark Thomas.\nI have come across an issue with trimSpace removing white space from\nparts of the HTML code.\nThe use case is found in the following mailing list thread.\n\nhttp://mail-archives.apache.org/mod_mbox/tomcat-users/201705.mbox/%3CCAFOY9=DN=Y-_7iZm38Kf4waGSOpzw4NyuLYOLA_PLxfm7VO4Cg@mail.gmail.com%3E\n\nThanks"}, {"attachment_id": null, "tags": [], "bug_id": 45931, "text": "A variation of this patch has been applied to 9.0.x for 9.0.0.M22 onwards.", "count": 11, "id": 199075, "time": "2017-06-06T12:10:45Z", "creator": "markt@apache.org", "creation_time": "2017-06-06T12:10:45Z", "is_private": false}]