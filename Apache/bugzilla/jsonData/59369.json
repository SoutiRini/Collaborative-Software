[{"count": 0, "tags": [], "bug_id": 59369, "text": "When using JavaMail and Tomcat 9.0.0.M4\n\nJavaMail checks for META-INF/javamail.providers and META-INF/javamail.address.map resources on the class loader of the javax.mail.Authenticator class.  If the resources do not exist, a null pointer exception is thrown instead of returning null.\n\nhttp://docs.oracle.com/javase/6/docs/api/java/lang/ClassLoader.html#getResourceAsStream(java.lang.String)\n\nSession.getResourceAsStream only catches a PrivilegedActionException.  This causes Session.getInstance to fail.\n\nA fix/workaround involves either \n1. putting empty META-INF entries in the jar, \nor \n2. catching the NPE in Session.getResourceAsStream and re-throwing it as an IO exception.\n\njava.lang.NullPointerException\n        at org.apache.catalina.loader.WebappClassLoaderBase.getResourceAsStream(WebappClassLoaderBase.java:1089)\n        at java.lang.Class.getResourceAsStream(Class.java:2223)\n        at javax.mail.Session$4.run(Session.java:1232)\n        at javax.mail.Session$4.run(Session.java:1230)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at javax.mail.Session.getResourceAsStream(Session.java:1229)\n        at javax.mail.Session.loadResource(Session.java:1123)\n        at javax.mail.Session.loadAllResources(Session.java:1203)\n        at javax.mail.Session.loadProviders(Session.java:934)\n        at javax.mail.Session.<init>(Session.java:224)\n        at javax.mail.Session.getInstance(Session.java:251)\n\n\nJavaMail Workaround\n\ntry {\n\t    return AccessController.doPrivileged(\n\t\t    new PrivilegedExceptionAction<InputStream>() {\n\t\t\tpublic InputStream run() throws IOException {\n\t\t\t\ttry {\n\t\t\t\t\treturn c.getResourceAsStream(name);\n\t\t\t\t} catch (Exception e) {\n\t\t\t\t\tthrow new IOException(e);\n\t\t\t\t}\n\t\t\t}\n\t\t    }\n\t    );\n\t} catch (PrivilegedActionException e) {\n\t    throw (IOException)e.getException();\n\t}\n    }\n\nfiled on JavaMail as well \nhttps://kenai.com/bugzilla/show_bug.cgi?id=7356", "id": 190496, "time": "2016-04-23T05:32:55Z", "creator": "steven@twelvetone.tv", "creation_time": "2016-04-23T05:32:55Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "text": "Already fixed for 9.0.0.M5 with r1736489.", "id": 190525, "time": "2016-04-24T19:02:09Z", "bug_id": 59369, "creation_time": "2016-04-24T19:02:09Z", "is_private": false}]