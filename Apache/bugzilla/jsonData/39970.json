[{"attachment_id": null, "tags": [], "bug_id": 39970, "text": "ArrayIndexOutOfBoundsException Occured when opening EXCEL file that contains \nvalues in such a way that some values span to other columns but some doesn't \nspan to other columns is display.\n\nThe error stacktrace is-\n\njava.lang.reflect.InvocationTargetException: \njava.lang.ArrayIndexOutOfBoundsException\n\tat java.lang.System.arraycopy(Native Method)\n\tat org.apache.poi.hssf.record.UnknownRecord.<init>\n(UnknownRecord.java:62)\n\tat org.apache.poi.hssf.record.SubRecord.createSubRecord\n(SubRecord.java:57)\n\tat org.apache.poi.hssf.record.ObjRecord.fillFields(ObjRecord.java:99)\n\tat org.apache.poi.hssf.record.Record.fillFields(Record.java(Compiled \nCode))\n\tat org.apache.poi.hssf.record.Record.<init>(Record.java(Compiled Code))\n\tat org.apache.poi.hssf.record.ObjRecord.<init>(ObjRecord.java:61)\n\tat java.lang.reflect.Constructor.newInstance(Native Method)\n\tat org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java(Compiled Code))\n\tat org.apache.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java(Compiled Code))\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:163)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:210)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:191)\n\tat com.mastercard.mcideas.atmdir.util.ExcelUtil.openWorkBook\n(ExcelUtil.java:263)\n\tat com.mastercard.mcideas.atmdir.util.ExcelUtil.TestReadingWorkBook\n(ExcelUtil.java:399)\n\tat com.mastercard.mcideas.atmdir.util.ExcelUtil.main\n(ExcelUtil.java:318)\n\nThe problem is with System.arrayCopy() method call in UnknownRecord class. A \nfix can be applied to this problem as follows (By making sure the array \ndoesn't go beyond limits)\n\n\n public UnknownRecord( short id, short size, byte[] data, int offset )\n    {\n        sid     = id;\n        thedata = new byte[size];\n        \n        if((data.length - offset) < size)\n\t\tsize = (short)(data.length - offset);\n        \n        \n        System.arraycopy(data, offset, thedata, 0, size);\n    }", "count": 0, "id": 90919, "time": "2006-07-05T18:18:40Z", "creator": "visu5678@yahoo.com", "creation_time": "2006-07-05T18:18:40Z", "is_private": false}, {"id": 91604, "tags": [], "bug_id": 39970, "attachment_id": null, "count": 1, "text": "Completely invalid bug, if there is an excel file that is generating this\nexception then upload/attach it to a bug report. \n\nFeel free to repoen this bug, if you can upload the excel causing the troyble.\n\nJason", "time": "2006-07-26T12:00:50Z", "creator": "jheight@apache.org", "creation_time": "2006-07-26T12:00:50Z", "is_private": false}]