[{"count": 0, "tags": [], "creator": "tsveg1@gmail.com", "attachment_id": null, "id": 121525, "time": "2008-10-15T02:56:56Z", "bug_id": 46011, "creation_time": "2008-10-15T02:56:56Z", "is_private": false, "text": "Cannot access to Principal via Subject.getSubject(AccessController.getContext()).\n\nProblem is that in method internalDoFilter of ApplicationFilterChain in call of filter chain the code determinate the Principal but don't use it:\n\n                if( Globals.IS_SECURITY_ENABLED ) {\n                    final ServletRequest req = request;\n                    final ServletResponse res = response;\n                    Principal principal = \n                        ((HttpServletRequest) req).getUserPrincipal();\n\n                    Object[] args = new Object[]{req, res, this};\n                    SecurityUtil.doAsPrivilege\n                        (\"doFilter\", filter, classType, args);\n                    \n                    args = null;\n                } else {  \n\nIn this manner a SecurityUtil.doAsPrivilege will be called with Principal == null\nand method execute create a Subject with no Principals.\nThen call a Subject.doAsPrivileged(subject, pea, null);  and this do not propagate Principals. I obtain a Subject without Principals calling Subject.getSubject(AccessController.getContext()).\n\nIn attachment we send our solution"}, {"count": 1, "tags": [], "creator": "tsveg1@gmail.com", "attachment_id": 22731, "id": 121526, "time": "2008-10-15T02:57:50Z", "bug_id": 46011, "creation_time": "2008-10-15T02:57:50Z", "is_private": false, "text": "Created attachment 22731\na patch for the problem"}, {"count": 2, "tags": [], "bug_id": 46011, "attachment_id": null, "id": 122213, "creation_time": "2008-11-05T08:19:58Z", "time": "2008-11-05T08:19:58Z", "creator": "markt@apache.org", "text": "many thanks for the patch. This has been committed to trunk and proposed for 6.0.19", "is_private": false}, {"count": 3, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 122945, "time": "2008-11-30T15:25:36Z", "bug_id": 46011, "creation_time": "2008-11-30T15:25:36Z", "is_private": false, "text": "This has been applied to 6.0.x and will be in 6.0.19 onwards. Thanks again for the patch."}]