[{"count": 0, "tags": [], "bug_id": 48668, "text": "In some cases text that happens to look similar to a deferred expression (#{..}) can get mangled even if the EL is not active. This appears to only happen if the text in question immediately proceeds a custom tag (either a full blown custom tag or a simple .tag file tag). The initial # and { characters get removed.\n\nThis happens in Tomcat v6.0.24 but did not happen in v6.0.20 so appears to be unintentional.\n\nWe have been upgrading legacy sites to Tomcat v6 and have hit this problem.\n\nThis problem can be recreated in a bog standard install of Tomcat v6.0.24. Create a simple .tag file that does nothing more than say 'hello'. Place a reference to this tag into a JSP with the offending text immediately after it. \n\nA test JSP that looks something like (note that EL is being ignored)...\n\n<%@ page isELIgnored=\"true\" %>\n<%@ taglib tagdir=\"/WEB-INF/tags/custom\" prefix=\"custom\" %>\n<html>\n<title>Test</title>\n</head>\n<body>\n  <custom:example />#{foo.bar}\n</body>\n</html>\n\nWhere the custom example tag (/WEB-INF/tags/custom/example.tag) looks like this...\n\nHello\n\nRather than the page returning the following...\n\n<html>\n<title>Test</title>\n</head>\n<body>\n  Hello#{foo.bar}\n</body>\n</html>\n\nIt will return...\n\n<html>\n<title>Test</title>\n</head>\n<body>\n  Hellofoo.bar}\n</body>\n</html>\n\nNotice the missing # and { from the text.\n\nI don't believe the platform Tomcat is running on matters. Have seen this behaviour on both Mac OS X and Linux.", "id": 134183, "time": "2010-02-03T09:22:59Z", "creator": "support@netxtra.net", "creation_time": "2010-02-03T09:22:59Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "markt@apache.org", "text": "Thanks for the report. This has been fixed in trunk and proposed for 6.0.x", "id": 134294, "time": "2010-02-07T18:03:40Z", "bug_id": 48668, "creation_time": "2010-02-07T18:03:40Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "text": "This has been fixed in 6.0.x and will be included in 6.0.25 onwards.", "is_private": false, "bug_id": 48668, "id": 134841, "time": "2010-02-23T23:00:13Z", "creator": "markt@apache.org", "creation_time": "2010-02-23T23:00:13Z", "attachment_id": null}, {"count": 3, "attachment_id": null, "creator": "knst.kolinko@gmail.com", "text": "Reopening.\n\nAdditional tests added in r919847.\nSome of them are failing.\n\nThis issue is also reproducible in the current 5.5 using /test/webapp/bug48668a.jsp from trunk. (bug48668b.jsp is not applicable to 5.5)", "id": 135125, "time": "2010-03-06T20:51:09Z", "bug_id": 48668, "creation_time": "2010-03-06T20:51:09Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 48668, "is_private": false, "text": "Additional fixes have been applied to trunk and 6.0.x and will be included in 6.0.26 onwards.", "id": 135201, "time": "2010-03-09T15:10:23Z", "creator": "markt@apache.org", "creation_time": "2010-03-09T15:10:23Z", "attachment_id": null}]