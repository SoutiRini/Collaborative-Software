[{"count": 0, "tags": [], "bug_id": 53302, "is_private": false, "text": "Created attachment 28839\nFile from existing bugzilla bug to show current implementation defect\n\nWhen a worksheet contains drawing objects (shapes, pictures, etc.), the drawing parts in the BIFF format are stored together in a so called drawing aggregate. The object that handles this logic in HSSF is org.apache.poi.hssf.record.EscherAggregate. Current implementation assumes that a drawing aggregate consists of DrawingRecord, ObjRecord and TextObjectRecord objects. In reality, a drawing aggregate can include one or more Continue records at arbitrary positions. Current aggregation logic terminates at the first Continue record and, as result, the aggregated data is not complete. When parsing such incorrectly aggregated data into Escher tree, user can see warnings in stdout: \"WARNING: N bytes remaining but no space left\" and the parsed tree will not contain all shapes from the worksheet.  \n\n\n..........\nRowRecordsAggregate\nDrawingRecord          <-- start of the drawing aggregate\nObjRecord\nDrawingRecord\nTextObjectRecord\nDrawingRecord\nObjRecord\nDrawingRecord\nTextObjectRecord\nDrawingRecord\nObjRecord\nDrawingRecord\nTextObjectRecord\nDrawingRecord\nObjRecord\nDrawingRecord\nTextObjectRecord\nContinueRecord         <-- current implementation reads up to this point   \nObjRecord\nContinueRecord\nTextObjectRecord       <-- end of the drawing aggregate\nWindowTwoRecord\n..........", "id": 159359, "time": "2012-05-27T20:48:41Z", "creator": "superrubiroyd@gmail.com", "creation_time": "2012-05-27T20:48:41Z", "attachment_id": 28839}, {"count": 1, "tags": [], "creator": "superrubiroyd@gmail.com", "attachment_id": 28840, "is_private": false, "id": 159361, "time": "2012-05-27T20:52:43Z", "bug_id": 53302, "creation_time": "2012-05-27T20:52:43Z", "text": "Created attachment 28840\nPatch which fixes bug and addes unit tests"}, {"count": 2, "tags": [], "creator": "yegor@dinom.ru", "attachment_id": null, "is_private": false, "id": 159389, "time": "2012-05-28T12:15:55Z", "bug_id": 53302, "creation_time": "2012-05-28T12:15:55Z", "text": "Applied in r1343218\n\nYegor"}]