[{"count": 0, "tags": [], "creator": "ld_development@hotmail.com", "attachment_id": null, "id": 44723, "time": "2003-09-25T22:12:27Z", "bug_id": 23425, "creation_time": "2003-09-25T22:12:27Z", "is_private": false, "text": "I believe there is a scoping issue with Jasper with respect to variables \nexported from TEI implementations.  Specifically I am using the Struts <define> \ntag, which exports a variable marked as VariableInfo.AT_END.  Which according \nto the Spec: \n\u2022AT_END, if the scripting variable is available after the end tag of the action\nthat defines it until the end of the scope.\n\nHowever, in the scenario where the tag is used in 2 seperate scopes (within an \nif/else) the variable is not redefined in the second scope.  I believe that \naccording to spec the second scope should recieve a new declaration of the \nexported var.  \n\nI have included only examples of the problem and can provide more detail if the \nfollowing does not sufficiently explain.\n\nExample JSP - \n<%if (some boolean){%>\n   <struts:define id=\"varName\" ...../>\n   ......\n<%}else{%>\n   <struts:define id=\"varName\" ...../>\n   ......\n<%}%>\n\nJSP compilation will fail in this scenario as the Jasper output would look \nsomething like:\nif(same boolean value) {\n\n/* ----  bean:define ---- */\n          org.apache.struts.taglib.bean.DefineTag _jspx_th_bean_define_0 = new \norg.apache.struts.taglib.bean.DefineTag();\n          _jspx_th_bean_define_0.setPageContext(pageContext);\n          _jspx_th_bean_define_0.setParent(_jspx_parent tag);\n          _jspx_th_bean_define_0.setId(\"varName\");\n          _jspx_th_bean_define_0.setName(\"...\");\n          _jspx_th_bean_define_0.setProperty(\"...\");\n          _jspx_th_bean_define_0.setType(\"java.lang.String\");\n          int _jspx_eval_bean_define_0 = _jspx_th_bean_define_0.doStartTag();\n          if (_jspx_th_bean_define_0.doEndTag() == \njavax.servlet.jsp.tagext.Tag.SKIP_PAGE)\n            return;\n          java.lang.String propertyname = null;\n          propertyname = (java.lang.String) pageContext.findAttribute\n(\"varName\");\n\n......\n\n} else {\n /* ----  bean:define ---- */\n          org.apache.struts.taglib.bean.DefineTag _jspx_th_bean_define_1 = new \norg.apache.struts.taglib.bean.DefineTag();\n          _jspx_th_bean_define_1.setPageContext(pageContext);\n          _jspx_th_bean_define_1.setParent(_jspx_parent tag);\n          _jspx_th_bean_define_1.setId(\"varName\");\n          _jspx_th_bean_define_1.setName(\"...\");\n          _jspx_th_bean_define_1.setProperty(\"...\");\n          _jspx_th_bean_define_1.setType(\"java.lang.String\");\n          int _jspx_eval_bean_define_1 = _jspx_th_bean_define_1.doStartTag();\n          if (_jspx_th_bean_define_1.doEndTag() == \njavax.servlet.jsp.tagext.Tag.SKIP_PAGE)\n            return;\n          propertyname = (java.lang.String) pageContext.findAttribute\n(\"varName\"); //compilation fails here//\n.......\n\n}"}, {"count": 1, "tags": [], "bug_id": 23425, "attachment_id": null, "text": "Theer are a number of duplicates of this issue. It is worth reading through the\nvarious comments associated with the reports.\n\nSee bug 21390 for a good explanation of this.\n\nIn your case, I think using the JSTL tag <c:if> might enable this to work the\nway you want. I have tested this with a simple test tag but not with any struts\ntags.\n\n*** This bug has been marked as a duplicate of 19491 ***", "id": 77625, "time": "2005-07-25T18:51:59Z", "creator": "markt@apache.org", "creation_time": "2005-07-25T18:51:59Z", "is_private": false}]