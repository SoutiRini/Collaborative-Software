[{"count": 0, "tags": [], "bug_id": 29989, "attachment_id": null, "id": 60329, "time": "2004-07-09T04:24:56Z", "creator": "quan.ma@nordsan.com", "creation_time": "2004-07-09T04:24:56Z", "is_private": false, "text": "I'm using Win2kServer + Apache2.0.50 + Tomcat5.0.16 (or 5.0.25) + jk2-2.0.4-\nwin32-apache2.0.49.\nAfter I copied mod_jk2.so (comes from jk2-2.0.4-win32-apache2.0.49) to \n${APACHE2_HOME}/modules, and finish all necessary configurations, start Apache2 \nservice, I got these messages from ${APACHE2_HOME}/logs/error.log:\n\n[Fri Jul 09 12:06:20 2004] [notice] Parent: Created child process 444\n[Fri Jul 09 12:06:20 2004] [notice] Child 444: Child process is running\n[Fri Jul 09 12:06:20 2004] [error] workerEnv.initChannel() init failed for \nchannel.jni:jni\n[Fri Jul 09 12:06:20 2004] [error] workerEnv.initWorkers() init failed for \nworker.jni:onStartup\n[Fri Jul 09 12:06:20 2004] [error] workerEnv.initWorkers() init failed for \nworker.jni:onShutdown\n[Fri Jul 09 12:06:20 2004] [notice] Child 444: Acquired the start mutex.\n[Fri Jul 09 12:06:20 2004] [notice] Child 444: Starting 100 worker threads.\n\nso, as a result, the jni can not work.\nI spent lot of time trying to solve the problem, but nothing happens.\nFinally, I decide to look for the jk2 source code, see what's the matter of \nthat.\nThen, I found the following code in jakarta-tomcat-connectors-jk2-2.0.4-\nsrc\\jk\\native2\\server\\apache2\\mod_jk2.c:608 -\n\n        ...\n        if (workerEnv->maxDaemons < 2) {\n            workerEnv->childId = proc.pid; //  HERE IS IT!!\n            env->l->jkLog(env, env->l, JK_LOG_INFO,\n                          \"jk2_init() Setting scoreboard slot 0 for child %d\\n\",\n                          proc.pid);\n        }\n        ...\n\nbut, in jakarta-tomcat-connectors-jk2-2.0.4-src\\jk\\native2\n\\common\\jk_channel_jni.c:91 -\n\n        ...\n    if (wEnv->childId != 0) { // AND THIS ??\n        if (jniW->worker != NULL)\n            jniW->worker->mbean->disabled = JK_TRUE;\n        return JK_ERR;\n    }\n        ...\n\nThat's it.\nSo, I chang it to -\n        ...\n        if (workerEnv->maxDaemons < 2) {\n            workerEnv->childId = 0; //  HERE IS IT!!\n            env->l->jkLog(env, env->l, JK_LOG_INFO,\n                          \"jk2_init() Setting scoreboard slot 0 for child %d\\n\",\n                          proc.pid);\n        }\n        ...\n\nI don't really know what it means, but it works for me now   :)"}, {"count": 1, "tags": [], "bug_id": 29989, "text": "JNI is not supported right now on jk2 and is still considered experimental", "id": 60533, "time": "2004-07-13T10:12:41Z", "creator": "hgomez@apache.org", "creation_time": "2004-07-13T10:12:41Z", "is_private": false, "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 29989, "is_private": false, "count": 2, "id": 67570, "time": "2004-11-29T20:18:22Z", "creator": "remm@apache.org", "creation_time": "2004-11-29T20:18:22Z", "text": "As of November 15, 2004, JK2 is no longer supported. All bugs related to JK2 \nwill be marked as WONTFIX. In its place, some of its features have been \nbackported to jk1. Most of those features will be seen in 1.2.7, which is \nslated for release on November 30th, 2004.\n\nAnother alternative is the ajp addition to mod_proxy which will be part of \napache 2.\n\nFor more information on the Tomat connectors docs at\nhttp://jakarta.apache.org/tomcat/connectors-doc/"}]