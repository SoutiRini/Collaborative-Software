[{"count": 0, "tags": [], "text": "Description:\nThis bug applies to both XSSF and HSSF:\nIn a workbook, I create a bold font.\nSetting this font to a cell using method CellUtil.setFont fails.\nInstead, the font at index 0 is used.\n\nTest Code:\n\n        Workbook workbook = new XSSFWorkbook();\n        Sheet sheet = workbook.createSheet();\n\n        Row row = sheet.createRow(0);\n        Cell cell = row.createCell(0);\n        cell.setCellValue(\"TestCell\");\n        \n        Font font = workbook.createFont();\n        font.setBoldweight(Font.BOLDWEIGHT_BOLD);\n        font.setFontHeightInPoints((short) 20);\n        \n        // This fails\n        CellUtil.setFont(cell, workbook, font);\n        // Workaround\n//        short fontIndex = font.getIndex();\n//        CellUtil.setCellStyleProperty(cell, workbook, CellUtil.FONT, Short.valueOf(fontIndex));\n\n        workbook.write(new FileOutputStream(new File(\"test-font.xlsx\")));\n\nEvaluation:\nCellUtil.setFont calls method setCellStyleProperty and passes-in a Font object as parameter \"propertyValue\". It fails a find a style that it can reuse and creates a new one. Then it calls setFormatProperties which in turn looks up the font using method getShort. Tha map passed-in contains almost only Short object as values, but a Font object for property \"font\". Thus it returns the default value 0. \n\nWorkaround:\nAvoid method CellUtil.setFont and use the workaround (as commented-out in the  above test code).", "is_private": false, "id": 136657, "creation_time": "2010-05-05T11:17:56Z", "time": "2010-05-05T11:17:56Z", "creator": "thomas.herre@abosco.com", "bug_id": 49254, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 49254, "is_private": false, "id": 136658, "creation_time": "2010-05-05T11:25:38Z", "time": "2010-05-05T11:25:38Z", "creator": "apache@gagravarr.org", "text": "Should be fixed in r941342.\n\nNote that things in contrib don't always receive the same level of testing as in the main jar file, as they generally lack unit tests :/", "attachment_id": null}]