[{"count": 0, "tags": [], "text": "[See prev. ref PR number 10090 Pablo Delgado, and my one]\n\nIn mod_rewrite.c [from Apache 1.3.23 until 2.0.36], there is a bug that cause\nRewriteMap MapType 'rnd' not working.\n\nHere is the funcion:\n--------------------\n\n3044:static int rewrite_rand(int l, int h)\n3045:{\n3046:    rewrite_rand_init();\n3047:\n3048:    /* Get [0,1) and then scale to the appropriate range. Note that using\n3049:     * a floating point value ensures that we use all bits of the rand()\n3050:     * result. Doing an integer modulus would only use the lower-order bits\n3051:     * which may not be as uniformly random.\n3052:     */\n3053:    return (int)((double)(rand() % 32000) / 32000) * (h - l + 1) + l;\n3054:}\n\n\n\n\nThis is the correct one:\n------------------------\n\n\n3044:static int rewrite_rand(int l, int h)\n3045:{\n3046:    rewrite_rand_init();\n3047:\n3048:    /* Get [0,1) and then scale to the appropriate range. Note that using\n3049:     * a floating point value ensures that we use all bits of the rand()\n3050:     * result. Doing an integer modulus would only use the lower-order bits\n3051:     * which may not be as uniformly random.\n3052:     */\n3053:    return (int)(((double)(rand() % 32000) / 32000) * (h - l + 1) + l);\n3054:}\n\n\nIn line 3053, if the additionals brackets are missing, the function return\nalways the value of 'l', [= 1, the call is few lines after],\nbecause ((double)(rand() % 32000) / 32000) is always = 0.\n\n\nPaolo Ferrario\n\nskooks@tiscali.it", "attachment_id": null, "id": 17607, "creation_time": "2002-06-11T15:54:44Z", "time": "2002-06-11T15:54:44Z", "creator": "skooks@tiscali.it", "bug_id": 9783, "is_private": false}, {"count": 1, "tags": [], "bug_id": 9783, "attachment_id": null, "id": 17629, "time": "2002-06-11T22:01:36Z", "creator": "slive@apache.org", "creation_time": "2002-06-11T22:01:36Z", "is_private": false, "text": "Interesting how these things seem to come in spurts.\n\n*** This bug has been marked as a duplicate of 9770 ***"}]