[{"count": 0, "tags": [], "text": "java.lang.ClassCastException: org.apache.poi.hssf.record.LabelRecord\n\tjava.util.TreeMap.compare(TreeMap.java:1093)\n\tjava.util.TreeMap.put(TreeMap.java:465)\n\torg.apache.poi.hssf.record.aggregates.ValueRecordsAggregate.insertCell\n(ValueRecordsAggregate.java:65)\n\torg.apache.poi.hssf.record.aggregates.ValueRecordsAggregate.construct\n(ValueRecordsAggregate.java:130)\n\torg.apache.poi.hssf.model.Sheet.createSheet(Sheet.java:210)\n\torg.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:172)\n\torg.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:130)\n\torg.springframework.web.servlet.view.document.AbstractExcelView.getTemp\nlateSource(AbstractExcelView.java:165)\n\torg.springframework.web.servlet.view.document.AbstractExcelView.renderM\nergedOutputModel(AbstractExcelView.java:132)\n\torg.springframework.web.servlet.view.AbstractView.render\n(AbstractView.java:250)\n\nWhile trying to use the template already given by Client which has Gaphs an \ndthe base data", "is_private": false, "id": 93327, "creator": "hepzibahr@hotmail.com", "time": "2006-09-11T08:37:19Z", "bug_id": 40460, "creation_time": "2006-09-11T08:37:19Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 40460, "attachment_id": 18847, "is_private": false, "id": 93328, "time": "2006-09-11T08:42:29Z", "creator": "hepzibahr@hotmail.com", "creation_time": "2006-09-11T08:42:29Z", "text": "Created attachment 18847\nthis is the template i want to use"}, {"count": 2, "tags": [], "bug_id": 40460, "text": "Created attachment 19767\nProposed fix to kludge for LabelRecord data type\n\nThe current kludge for converting out-dated LabelRecords to LabelSSTRecords\ngenerated ClassCastExceptions when I tried to read a spreadsheet created by MS\nWorks, supposedly saved in Excel 97/2000 format.\n\nThe problem appears to be that the conversion method :\n    sheet.convertLabelRecords(workbook);\nis called too late in the sequence.  By the time it is called, the records have\nalready been processed, and it is during that processing that the exception\nfails.\tThe specific issue is that LabelRecord does not implement Comparator\ninterface, but there is a secondary problem that the LabelRecords are inserted\ninto a second data structure (ValueRecordsAggregate\t cells) during that\nprocess and those entries are not converted to LabelSSTRecords during the\nconversion.\n\nI believe the better way to handle this is to do the conversion in\nusermodel.HSSFWorkbook.java prior to creating the Sheet objects.  This appears\nto work for me.  The code changes in the attached file are located between line\nnumbers 170 and 210.  They do the conversion on the records structure and\ncomment out the call to convertLabelRecords in Sheet.  That method might be\neliminated if this patch is applied.", "id": 100730, "time": "2007-03-21T08:03:44Z", "creator": "gwghome@comcast.net", "creation_time": "2007-03-21T08:03:44Z", "is_private": false, "attachment_id": 19767}, {"count": 3, "tags": [], "text": "Retested OK in 3.1-beta1.\n\nProbably fixed in svn r353774 (for bug 19053)\n\n\n*** This bug has been marked as a duplicate of bug 19053 ***", "is_private": false, "id": 116282, "creator": "josh@apache.org", "time": "2008-05-05T20:18:32Z", "bug_id": 40460, "creation_time": "2008-05-05T20:18:32Z", "attachment_id": null}]