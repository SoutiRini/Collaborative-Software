[{"count": 0, "tags": [], "creator": "sarthy2000@yahoo.co.uk", "attachment_id": null, "id": 118175, "time": "2008-07-01T17:09:21Z", "bug_id": 45322, "creation_time": "2008-07-01T17:09:21Z", "is_private": false, "text": "Attached the ExcelReportGenerator.java\n1) If I do NOT call the autoSizeColumn method, then I am able to get the excel report. Attached the excel report without calling autoSizeColumn method.\n\n2) When I call the autoSizeColumn method, I get the below output and exception.\n\nformatFontCount =5\ncolumnValueStyles.length =25\ncolumn Count = 25\ncalled autoSizeColumn for the following values of i\n 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24\n\njava.lang.ArrayIndexOutOfBoundsException: -1\n\tat java.util.Vector.get(Vector.java:712)\n\tat org.apache.poi.hssf.usermodel.HSSFDataFormat.getFormat(HSSFDataFormat.java:266)\n\tat org.apache.poi.hssf.usermodel.HSSFSheet.autoSizeColumn(HSSFSheet.java:1815)\n\tat com.jbhunt.report.generator.ExcelReportGenerator.setAutoColumnWidths(ExcelReportGenerator.java:457)\n\tat com.jbhunt.report.generator.ExcelReportGenerator.generateHSSFWorkbook(ExcelReportGenerator.java:110)\n\tat com.jbhunt.report.generator.ExcelReportGenerator.generateReport(ExcelReportGenerator.java:65) \tat com.jbhunt.report.service.GenerateReportSvc.generateReport(GenerateReportSvc.java:59)\n\tat com.jbhunt.pace.biz.reports.ReportHandler.getReportUsingCustomJavaAPI(ReportHandler.java:635)\n\tat com.jbhunt.pace.biz.reports.ejb.ReportsBean.getReportUsingCustomJavaAPI(ReportsBean.java:338)\n\tat com.jbhunt.pace.biz.reports.test.CustomJavaReportTest.main(CustomJavaReportTest.java:29)\n14540 [main] ERROR service.GenerateReportSvc  - Error in generate Excel report.\ncom.jbhunt.report.exception.ReportServiceException: Error in generate Excel report.\n\tat com.jbhunt.report.generator.ExcelReportGenerator.generateReport(ExcelReportGenerator.java:70)\n\tat com.jbhunt.report.service.GenerateReportSvc.generateReport(GenerateReportSvc.java:59)\n\tat com.jbhunt.pace.biz.reports.ReportHandler.getReportUsingCustomJavaAPI(ReportHandler.java:635)\n\tat com.jbhunt.pace.biz.reports.ejb.ReportsBean.getReportUsingCustomJavaAPI(ReportsBean.java:338)\n\tat com.jbhunt.pace.biz.reports.test.CustomJavaReportTest.main(CustomJavaReportTest.java:29)\nCaused by: java.lang.ArrayIndexOutOfBoundsException: -1\n\tat java.util.Vector.get(Vector.java:712)\n\tat org.apache.poi.hssf.usermodel.HSSFDataFormat.getFormat(HSSFDataFormat.java:266)\n\tat org.apache.poi.hssf.usermodel.HSSFSheet.autoSizeColumn(HSSFSheet.java:1815)\n\tat com.jbhunt.report.generator.ExcelReportGenerator.setAutoColumnWidths(ExcelReportGenerator.java:457)\n\tat com.jbhunt.report.generator.ExcelReportGenerator.generateHSSFWorkbook(ExcelReportGenerator.java:110)\n\tat com.jbhunt.report.generator.ExcelReportGenerator.generateReport(ExcelReportGenerator.java:65)\n\t... 4 more\ncom.jbhunt.report.exception.ReportServiceException: Error in generate Excel report.\n\tat com.jbhunt.report.generator.ExcelReportGenerator.generateReport(ExcelReportGenerator.java:70)\n\tat com.jbhunt.report.service.GenerateReportSvc.generateReport(GenerateReportSvc.java:59)\n\tat com.jbhunt.pace.biz.reports.ReportHandler.getReportUsingCustomJavaAPI(ReportHandler.java:635)\n\tat com.jbhunt.pace.biz.reports.ejb.ReportsBean.getReportUsingCustomJavaAPI(ReportsBean.java:338)\n\tat com.jbhunt.pace.biz.reports.test.CustomJavaReportTest.main(CustomJavaReportTest.java:29)\nCaused by: java.lang.ArrayIndexOutOfBoundsException: -1\n\tat java.util.Vector.get(Vector.java:712)\n\tat org.apache.poi.hssf.usermodel.HSSFDataFormat.getFormat(HSSFDataFormat.java:266)\n\tat org.apache.poi.hssf.usermodel.HSSFSheet.autoSizeColumn(HSSFSheet.java:1815)\n\tat com.jbhunt.report.generator.ExcelReportGenerator.setAutoColumnWidths(ExcelReportGenerator.java:457)\n\tat com.jbhunt.report.generator.ExcelReportGenerator.generateHSSFWorkbook(ExcelReportGenerator.java:110)\n\tat com.jbhunt.report.generator.ExcelReportGenerator.generateReport(ExcelReportGenerator.java:65)\n\t... 4 more\nException in thread \"main\" com.jbhunt.report.exception.ReportServiceException: Error in generate Excel report.\n\tat com.jbhunt.report.service.GenerateReportSvc.generateReport(GenerateReportSvc.java:65)\n\tat com.jbhunt.pace.biz.reports.ReportHandler.getReportUsingCustomJavaAPI(ReportHandler.java:635)\n\tat com.jbhunt.pace.biz.reports.ejb.ReportsBean.getReportUsingCustomJavaAPI(ReportsBean.java:338)\n\tat com.jbhunt.pace.biz.reports.test.CustomJavaReportTest.main(CustomJavaReportTest.java:29)"}, {"count": 1, "text": "Created attachment 22205\nSample report generated without calling autoSizeColumn", "bug_id": 45322, "attachment_id": 22205, "id": 118176, "time": "2008-07-01T17:10:46Z", "creator": "sarthy2000@yahoo.co.uk", "creation_time": "2008-07-01T17:10:46Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 45322, "attachment_id": 22206, "id": 118177, "creation_time": "2008-07-01T17:11:39Z", "time": "2008-07-01T17:11:39Z", "creator": "sarthy2000@yahoo.co.uk", "text": "Created attachment 22206\nExcel Report Generator which is used to create the attached sample excel file", "is_private": false}, {"count": 3, "tags": [], "bug_id": 45322, "is_private": false, "id": 118178, "creation_time": "2008-07-01T17:18:13Z", "time": "2008-07-01T17:18:13Z", "creator": "sarthy2000@yahoo.co.uk", "text": "First, I was using POI-3.1 beta-2 version.\nThen, tried with POI-3.1 Final Version.\nI get the same ArrayIndexOutOfBoundException: -1 in both the versions.\n\nI sent the code to Production. It is working fine for some scenario and not working for some other scenarios.", "attachment_id": null}, {"count": 4, "text": "Fixed in r676995.\n\nThe method threw ArrayIndexOutOfBoundsException when style.getDataFormat() returned -1. \n\nYegor", "bug_id": 45322, "attachment_id": null, "id": 118681, "time": "2008-07-15T11:16:57Z", "creator": "yegor@dinom.ru", "creation_time": "2008-07-15T11:16:57Z", "tags": [], "is_private": false}, {"count": 5, "tags": [], "creator": "michael.ramirez@apollogrp.edu", "attachment_id": null, "is_private": false, "id": 131475, "time": "2009-10-28T12:25:46Z", "bug_id": 45322, "creation_time": "2009-10-28T12:25:46Z", "text": "FYI: The following line of code was added to bypass the exception:\n\nif ( null != row.getCell(i) && null != row.getCell(i).getCellStyle() && row.getCell(i).getCellStyle().getDataFormat() > -1 )\n\nWith that line removed, the exception occurs at:\n\nsheet.autoSizeColumn((short)i);"}]