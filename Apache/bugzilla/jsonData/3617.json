[{"count": 0, "tags": [], "creator": "mak-apache-bugzilla@greenhills.co.uk", "text": "A JSP <%@ page import %> problem in an error page caused an error message:\n\n  org.apache.jasper.JasperException: Unable to compile class for \n  JSPnull/crab/mak/tomcat/work/localhost/example/error$jsp.java:4:\n  Class ... not found in import.\n\nNote the \"null\"; That is returned by findMapping() to getJspLineErrors()\nin jasper/src/share/org/apache/jasper/compiler/Compiler.java\n\nGiven that null is a possible result for findMapping(), getJspLineErrors()\nshould check for it before using the value. But I expect findMapping()\nwas actually supposed to find some mapping for this line. I haven't had the\ntime to look into this further.", "id": 5551, "time": "2001-09-14T08:55:24Z", "bug_id": 3617, "creation_time": "2001-09-14T08:55:24Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "craig.mcclanahan@sun.com", "attachment_id": null, "id": 5616, "time": "2001-09-15T16:53:37Z", "bug_id": 3617, "creation_time": "2001-09-15T16:53:37Z", "is_private": false, "text": "Fixed in nightly build 20010916 (and 4.0 final)\n"}, {"count": 2, "tags": [], "bug_id": 3617, "attachment_id": null, "id": 5717, "time": "2001-09-18T08:49:18Z", "creator": "mak-apache-bugzilla@greenhills.co.uk", "creation_time": "2001-09-18T08:49:18Z", "is_private": false, "text": "That change isn't right. The \"null\" has gone, but so has the servlet \nfilename and line number, and the result is badly formatted:\n\n  <%@ page import=\"sss\" %>\n\nnow produces:\n\n  org.apache.jasper.JasperException: Unable to compile class for JSPimport sss;\n         ^\n  1 error\n\nNotice the missing separator between \"JSP\" and \"import\", the missing\nfilename and line number, and the misplaced caret.\nAlso findMapping is called twice unnecesarrily.\n\nHaving looked a little further into this, I see that the intent is to map\nthe servlet errors back to corresponding lines in the JSP page. This has\nbeen implemented for scriplets, but not for directives, so findMapping\nsimply hasn't got the data it needs. The ideal fix would be to implement\nthe line number mapping for directives, but that seems like a fairly major\nchange which is probably not recommended given that the 4.0 release is\nimminent, and given that Jasper is being comprehensively rewritten for\nsome future release.\n\nSo for now it makes more sense to just ensure that the error message\nis properly generated.\n\nAs a minimal fix http://www.greenhills.co.uk/mak/apache/jasper-errormsg.diff\nproduces:\n\n  org.apache.jasper.JasperException: Unable to compile class for JSP\n  /crab/mak/tomcat/work/localhost/example/a$jsp.java:3: Class sss not found in\nimport.\n  import sss;\n\nwhich at least restores the servlet filename and formatting.\n\nAlternatively http://www.greenhills.co.uk/mak/apache/jasper-errormsg2.diff\nis a patch that recognises this case specifically. The advantage is that\nthe error formatting is more similar to the other cases, the disadvantage\nis that it's really not very informative. Note that I have not included\nthe necesarry translations for _es and _ja.\n\nI would suggest something like the first patch is preferable.\n"}, {"count": 3, "tags": [], "bug_id": 3617, "attachment_id": 573, "id": 5718, "time": "2001-09-18T08:53:03Z", "creator": "mak-apache-bugzilla@greenhills.co.uk", "creation_time": "2001-09-18T08:53:03Z", "is_private": false, "text": "Created attachment 573\npossible patch #1"}, {"count": 4, "tags": [], "bug_id": 3617, "attachment_id": 574, "id": 5719, "time": "2001-09-18T08:53:44Z", "creator": "mak-apache-bugzilla@greenhills.co.uk", "creation_time": "2001-09-18T08:53:44Z", "is_private": false, "text": "Created attachment 574\npossible patch #2"}, {"count": 5, "tags": [], "bug_id": 3617, "attachment_id": null, "id": 6041, "time": "2001-09-25T19:43:09Z", "creator": "craig.mcclanahan@sun.com", "creation_time": "2001-09-25T19:43:09Z", "is_private": false, "text": "Fixed in nightly builds.  Will be fixed in Tomcat 4.0.1.\n"}]