[{"count": 0, "tags": [], "text": "A cell format such as:\n\n    [$-409]mmmm dd yyyy  h:mm AM/PM\n\nshould format explicitly in English. A cell format such as:\n\n    [$-804]mmmm dd yyyy  h:mm AM/PM\n\nshould format in Chinese (although in an inappropriate order for Chinese.)\n\nWhen I do this using POI though, CellFormat.apply(double) or CellFormat.apply(Cell) throw NullPointerException for both formats.", "attachment_id": null, "id": 160386, "creation_time": "2012-07-02T02:36:19Z", "time": "2012-07-02T02:36:19Z", "creator": "trejkaz@trypticon.org", "bug_id": 53494, "is_private": false}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "Could you try with a recent nightly build / svn checkout? There was a fix for locales in formats a few weeks ago, which may have solved this too.\n\nIf the problem still remains with a recent build, could you please post the full stacktrace, and ideally a unit test that highlights the problem?", "id": 160392, "time": "2012-07-02T09:21:20Z", "bug_id": 53494, "creation_time": "2012-07-02T09:21:20Z", "is_private": false}, {"attachment_id": null, "tags": [], "bug_id": 53494, "is_private": false, "count": 2, "id": 160408, "time": "2012-07-02T23:06:56Z", "creator": "trejkaz@trypticon.org", "creation_time": "2012-07-02T23:06:56Z", "text": "Current trunk build seems to be broken.\n\n/Data/Projects/vendor/poi/trunk/build.xml:412: taskdef class org.apache.xmlbeans.impl.tool.XMLBean cannot be found\n using the classloader AntClassLoader[/Data/Projects/vendor/poi/trunk/ooxml-lib/xmlbeans-2.3.0.jar:/Data/Projects/vendor/poi/trunk/ooxml-lib/stax-api-1.0.1.jar]\n\nSearching on Google found a post which suggests that xmlbeans-2.3.0.jar might be corrupt. It is in fact corrupt, but after deleting it, another corrupt copy is downloaded the next time I run the build. :/"}, {"count": 3, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "is_private": false, "id": 160409, "time": "2012-07-02T23:18:08Z", "bug_id": 53494, "creation_time": "2012-07-02T23:18:08Z", "text": "Could you perhaps have a broken webproxy in front of you, which is wrecking your downloads?\n\nI'd suggest you either download the jar manually, or download an older binary/source release and grab a known good jar out of that"}, {"attachment_id": null, "tags": [], "bug_id": 53494, "text": "Manually downloaded that file and another one which the build downloaded a corrupt copy of. And no, there is no web proxy in front of me at all. There might be one in front of the mirror server which the build is downloading from.\n\nLooks like the issue still occurs (same NullPointerException.)", "count": 4, "id": 160410, "time": "2012-07-02T23:21:56Z", "creator": "trejkaz@trypticon.org", "creation_time": "2012-07-02T23:21:56Z", "is_private": false}, {"count": 5, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "text": "Any chance of the full stacktrace so we can see where the NPE is triggered, and ideally also a unit test?", "id": 160411, "time": "2012-07-02T23:26:58Z", "bug_id": 53494, "creation_time": "2012-07-02T23:26:58Z", "is_private": false}, {"count": 6, "attachment_id": null, "bug_id": 53494, "text": "    @Test\n    public void testCellFormatDateLocales() throws Exception\n    {\n        CellFormat englishFormat = CellFormat.getInstance(\"[$-409]mmmm dd yyyy  h:mm AM/PM\");\n        assertThat(englishFormat.apply(26995.477777777778).text, is(equalTo(\"November 27 1973  11:28 AM\")));\n\n        CellFormat chineseFormat = CellFormat.getInstance(\"[$-804]mmmm dd yyyy  h:mm AM/PM\");\n        assertThat(chineseFormat.apply(26995.477777777778).text, is(equalTo(\"\\u5341\\u4E00\\u6708 27 1973  11:28 \\u4E0A\\u5348\")));\n    }\n\nThis should be enough to reproduce it. I'm not 100% sure if the expected text is exactly correct because I took this double value from the debugger while our own test was running and floating point often ruins precision...", "id": 160413, "time": "2012-07-02T23:52:57Z", "creator": "trejkaz@trypticon.org", "creation_time": "2012-07-02T23:52:57Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "bug_id": 53494, "attachment_id": null, "text": "Still occurs in 3.9, but the stack trace is different now, now the NPE is in CellFormat.getApplicableFormatPart(CellFormat.java:365)", "id": 165071, "time": "2013-02-05T06:11:56Z", "creator": "trejkaz@trypticon.org", "creation_time": "2013-02-05T06:11:56Z", "is_private": false}, {"count": 8, "tags": [], "creator": "apache@gagravarr.org", "is_private": false, "text": "Thanks for the test\n\nI've added a slightly modified form in r1614741, which shows that trunk is now able to parse these style of formats without error", "id": 176778, "time": "2014-07-30T19:02:17Z", "bug_id": 53494, "creation_time": "2014-07-30T19:02:17Z", "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 53494, "text": "We now get a different problem on the exact same test case we posted in the comment here, but I'll open a new ticket about it, since it at least isn't a NPE anymore.", "id": 191473, "time": "2016-06-09T06:38:58Z", "creator": "trejkaz@trypticon.org", "creation_time": "2016-06-09T06:38:58Z", "is_private": false, "attachment_id": null}]