[{"count": 0, "text": "I'm seeing a NullPointerException when trying to read an HSSF spreadsheet using POI 3.9.0. The error happens here:\n\nExternSheetNameResolver.prependSheetName(FormulaRenderingWorkbook, int, String) line: 34\t\nRef3DPtg.toFormulaString(FormulaRenderingWorkbook) line: 91\t\nFormulaRenderer.toFormulaString(FormulaRenderingWorkbook, Ptg[]) line: 92\t\nHSSFFormulaParser.toFormulaString(HSSFWorkbook, Ptg[]) line: 83\t\nHSSFCell.getCellFormula() line: 621\t\n\nDebugging it, I see in ExternSheetNameResolver.prependSheetName() that the sheet name coming back from the ExternalSheet object is null. (This comes from LinkTable.getExternalBookAndSheetName(), where shIx gets the value -1).\n\nThe spreadsheet in question has a couple of external references of the form 'NNNN.xls'#$''.D1, which is where the error occurs. (I'm unfortunately not able to attach the spreasheet as it contains confidential information)", "bug_id": 54316, "attachment_id": null, "id": 164125, "time": "2012-12-17T09:16:37Z", "creator": "jan.stette@gmail.com", "creation_time": "2012-12-17T09:16:37Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 54316, "text": "I believe this has been solved in 3.11 beta 1, with the various updates to how external spreadsheets are supported\n\nIf the problem still remains for you with 3.11, please create a simple excel file which shows the problem, and an associated small junit unit test, and re-open the bug.", "id": 176829, "time": "2014-08-01T13:56:52Z", "creator": "apache@gagravarr.org", "creation_time": "2014-08-01T13:56:52Z", "is_private": false, "attachment_id": null}]