[{"count": 0, "tags": [], "bug_id": 60866, "attachment_id": 34826, "id": 197662, "time": "2017-03-14T16:19:14Z", "creator": "martin.studer@mirai-solutions.com", "creation_time": "2017-03-14T16:19:14Z", "is_private": false, "text": "Created attachment 34826\nPatch adding support for named cell styles\n\nDear all,\n\nI was working on support for named cell styles in SS Common. Please find attached a patch with the proposed changes. Would be great if someone could review that.\n\nWhile HSSFCellStyle allowed setting a user style name for a while, this was not possible with XSSFCellStyle. Generally, the model in XSSF is a bit more complicated due to the separation of cell and cell style formatting records (cell xfs vs cell style xfs). An XSSFCellStyle in POI is generally a combination of both a cell xf and a cell style xf. Only the latter (actually only cell styles (CTCellStyle) which reference a cell style xf) can have a name. The idea of supporting named cell styles in XSSFCellStyle is therefore the following:\n\n- an XSSFCellStyle which references an \"empty\" cell xf (i.e. no cell-specific formatting) which in turn references a cell style xf which has a name through a cell style record (CTCellStyle) is considered a named XSSFCellStyle\n- a named XSSFCellStyle can be created at any time from a (non-named) XSSFCellStyle by merging the cell xf and cell style xf information and creating a new cell style xf record and an appropriate CTCellStyle entry; the XSSFCellStyle can be updated by using the newly created cell style xf and an empty cell xf\n\nA test case which illustrates the use is included in the attached patch.\n\nBest regards,\nMartin"}]