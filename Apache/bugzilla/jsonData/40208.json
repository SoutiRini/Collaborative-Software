[{"count": 0, "tags": [], "bug_id": 40208, "attachment_id": null, "id": 92021, "time": "2006-08-08T13:00:16Z", "creator": "fun.peters@gmx.de", "creation_time": "2006-08-08T13:00:16Z", "is_private": false, "text": "Sometimes requests to an error.jsp, configured as an ErrorDocument in \nhttpd.conf, result in request dumps in catalina.out.\n\nDetails: \n\nWe use an environment with apache 1.3.27, mod_jk 1.2.6 and tomcat 5.0.28 on \nLinux.\n\nIn our httpd.conf an error.jsp page is configured to report violations of \naccess restrictions (Response code 403) or 'URL not found' (404) to the user. \nMost of the time this works fine.\n\nIn some cases we find a request dump in our catalina.out file, when apache \ndirects such an error.jsp request to mod_jk. Unfortunately I can't see the \noriginal request, which produced the fault. \n\nSince we use the apache module ModSecurity (version 1.9.3) we have the problem, \nthat a deny of a request with status 403 results reproducible in such a request \ndump. Then no Response is sent back to the user. There is also no entry in the \naccess logfile of apache. This error case is reproducable with apache 1.3.37, \nmod_jk 1.2.18 and tomcat 5.0.28.\n\nmod_jk 1.2.18 reports the following log infos in debug mode:\n\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] \nmap_uri_to_worker::jk_uri_worker_map.c (520): Attempting to map context \nURI '/error/*.jsp'\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] \nmap_uri_to_worker::jk_uri_worker_map.c (534): Found a wildchar match ajp13 -\n> /error/*.jsp\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] \nwc_get_worker_for_name::jk_worker.c (111): found a worker ajp13\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] wc_maintain::jk_worker.c (301): \nMaintaining worker ajp13\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] \najp_get_endpoint::jk_ajp_common.c (2164): acquired connection pool slot=0\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] \najp_marshal_into_msgb::jk_ajp_common.c (566): ajp marshaling done\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] ajp_service::jk_ajp_common.c \n(1698): processing ajp13 with 2 retries\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] jk_open_socket::jk_connect.c \n(329): socket TCP_NODELAY set to On\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] jk_open_socket::jk_connect.c \n(427): trying to connect socket 6 to 127.0.0.1:8009\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] jk_open_socket::jk_connect.c \n(453): socket 6 connected to 127.0.0.1:8009\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] \najp_connect_to_endpoint::jk_ajp_common.c (864): Connected socket 6 to \n(127.0.0.1:8009)\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] \najp_connection_tcp_send_message::jk_ajp_common.c (909): sending to ajp13 pos=4 \nlen=966 max=8192\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] \najp_connection_tcp_send_message::jk_ajp_common.c (909): 0000    12 34 03 C2 02 \n02 00 08 48 54 54 50 2F 31 2E 31  - .4......HTTP/1.1\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] \najp_connection_tcp_send_message::jk_ajp_common.c (909): 0010    00 00 13 2F 65 \n72 72 6F 72 2F 65 72 72 6F 72 34  - .../error/error4\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] \najp_connection_tcp_send_message::jk_ajp_common.c (909): 0020    30 33 2E 6A 73 \n70 00 00 0B 31 30 2E 31 30 30 2E  - 03.jsp...10.100.\n...(following the dump of the request)...\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] \najp_connection_tcp_send_message::jk_ajp_common.c (909): 0330    5F 73 65 63 75 \n72 69 74 79 2D 61 63 74 69 6F 6E  - _security-action\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] \najp_connection_tcp_send_message::jk_ajp_common.c (909): 0340    00 00 03 34 30 \n33 00 00 14 6D 6F 64 5F 73 65 63  - ...403...mod_sec\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] \najp_connection_tcp_send_message::jk_ajp_common.c (909): 0350    75 72 69 74 79 \n2D 6D 65 73 73 61 67 65 00 00 64  - urity-message..d\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] \najp_connection_tcp_send_message::jk_ajp_common.c (909): 0360    41 63 63 65 73 \n73 20 64 65 6E 69 65 64 20 77 69  - Access.denied.wi\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] \najp_connection_tcp_send_message::jk_ajp_common.c (909): 0370    74 68 20 63 6F \n64 65 20 34 30 33 2E 20 50 61 74  - th.code.403..Pat\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] \najp_connection_tcp_send_message::jk_ajp_common.c (909): 0380    74 65 72 6E 20 \n6D 61 74 63 68 20 22 6A 73 65 73  - tern.match.\"jses\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] \najp_connection_tcp_send_message::jk_ajp_common.c (909): 0390    73 69 6F 6E 69 \n64 22 20 61 74 20 41 52 47 53 5F  - sionid\".at.ARGS_\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] \najp_connection_tcp_send_message::jk_ajp_common.c (909): 03a0    56 41 4C 55 45 \n53 28 22 78 79 7A 22 29 20 5B 73  - VALUES(\"xyz\").[s\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] \najp_connection_tcp_send_message::jk_ajp_common.c (909): 03b0    65 76 65 72 69 \n74 79 20 22 45 4D 45 52 47 45 4E  - everity.\"EMERGEN\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] \najp_connection_tcp_send_message::jk_ajp_common.c (909): 03c0    43 59 22 5D 00 \nFF 00 00 00 00 00 00 00 00 00 00  - CY\"]............\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] \najp_send_request::jk_ajp_common.c (1264): request body to send 24 - request \nbody to resend 0\n[Tue Aug 08 14:43:38 2006] [30177:0000] [info]  \najp_read_into_msg_buff::jk_ajp_common.c (1118): Receiving data from client \nfailed. Connection aborted or network problems\n[Tue Aug 08 14:43:38 2006] [30177:0000] [info]  ajp_service::jk_ajp_common.c \n(1775): Sending request to tomcat failed, because of client error without \nrecovery in send loop 0\n[Tue Aug 08 14:43:38 2006] [30177:0000] [debug] ajp_done::jk_ajp_common.c \n(2107): recycling connection pool slot=0 for worker ajp13\n\nThe same output is reported by tomcat in catalina.out. \n\nDo you have any idea, what might be the problem? Should I post this error to \nthe apache bug database?"}, {"count": 1, "tags": [], "bug_id": 40208, "attachment_id": null, "id": 97349, "time": "2006-12-26T16:31:17Z", "creator": "yoavs@computer.org", "creation_time": "2006-12-26T16:31:17Z", "is_private": false, "text": "I wouldn't post this as an httpd bug, unless you're also seeing strange behavior\nwith httpd standalone (no Tomcat, no mod_jk, static HTML error page).\n\nI don't suppose you can test this with Tomcat 5.5.20 and a more recent mod_jk or\nApache httpd (or both)?  That would help us prioritize fixing this issue.\n\nWhat happens if you turn off the ErrorDocument directive in httpd (temporarily),\nand just use the Tomcat error page for Tomcat errors?  Does that at least work\nproperly?"}, {"attachment_id": null, "tags": [], "creator": "rainer.jung@kippdata.de", "is_private": false, "count": 2, "id": 150905, "time": "2011-10-25T18:21:05Z", "bug_id": 40208, "creation_time": "2011-10-25T18:21:05Z", "text": "No response for about 5 years.\nClosing as invalid."}]