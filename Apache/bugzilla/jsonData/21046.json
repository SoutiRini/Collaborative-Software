[{"count": 0, "tags": [], "creator": "keeper@fly.srk.fer.hr", "attachment_id": null, "id": 39343, "time": "2003-06-24T14:25:59Z", "bug_id": 21046, "creation_time": "2003-06-24T14:25:59Z", "is_private": false, "text": "I've compiled apache 2.0.36 on AIX 4.3.\nI cannot Load php module. I get the following error:\nbash-2.05a$ /stage/keeper/apache2/bin/apachectl start\nSyntax error on line 233 of /stage/keeper/apache2/conf/httpd.conf:\nCannot load /stage/keeper/apache2/modules/libphp4.so into server:\n\nOn another AIX server with apache2, I have similar problem with loading \nconnector for mod_jrun:\nSyntax error on line 1076 of /usr/local/apache2/conf/httpd.conf:\nCannot load \n/usr/portal/aim/jrun4/lib/connectors/apache/ppc-aix/prebuilt/mod_jrun20.so into \nserver:"}, {"count": 1, "tags": [], "creator": "trawick@apache.org", "attachment_id": null, "id": 39346, "time": "2003-06-24T14:35:09Z", "bug_id": 21046, "creation_time": "2003-06-24T14:35:09Z", "is_private": false, "text": "Please send me the following info off-line (trawick@apache.org):\n\nthe two .so files\ndump -THv /path/to/apache2/httpd\n\nNote that it is only fairly recently that PHP has included the right ldflags for\nAIX.  4.3.0 was definitely broken.  I don't know what PHP versions have the fix.\n\nRegarding mod_jrun*...  I corresponded with somebody some weeks ago regarding\nthat but the last I heard was that the vendor was going to look into the issue,\nand I never got a copy of the module to look at.\n\n"}, {"count": 2, "tags": [], "bug_id": 21046, "text": "current status:\n\nPHP isn't loading because it wants to import ap_max_requests_per_child, but it\nisn't exported by httpd.  It isn't exported by httpd because it doesn't have the\nformal API wrappers around the declarations in include/mpm_common.h.\n\nI think the proper way for a module to get that information is via\n\nap_mpm_query(AP_MPM_MAX_REQUESTS_DAEMON, &max_requests_per_child);\n\nI'll check and see what other folks think about whether\nap_max_requests_per_child is really part of the API.  In the meantime, apply\nthis patch to Apache to cause that variable to be exported will httpd-ers and\nphp-ers figure out the best fix.\n\nIndex: include/mpm_common.h\n===================================================================\nRCS file: /home/cvs/httpd-2.0/include/mpm_common.h,v\nretrieving revision 1.42\ndiff -u -r1.42 mpm_common.h\n--- include/mpm_common.h        9 Apr 2003 16:58:28 -0000       1.42\n+++ include/mpm_common.h        24 Jun 2003 16:16:06 -0000\n@@ -229,11 +229,11 @@\n  * The maximum number of requests each child thread or\n  * process handles before dying off\n  */\n-#ifdef AP_MPM_WANT_SET_MAX_REQUESTS\n-extern int ap_max_requests_per_child;\n+\n+AP_DECLARE_DATA extern int ap_max_requests_per_child;\n const char *ap_mpm_set_max_requests(cmd_parms *cmd, void *dummy,\n                                     const char *arg);\n-#endif\n+\n\nI'll update when I can figure out whats up with mod_jrun2\n", "id": 39360, "attachment_id": null, "creator": "trawick@apache.org", "creation_time": "2003-06-24T18:13:59Z", "time": "2003-06-24T18:13:59Z", "is_private": false}, {"count": 3, "tags": [], "text": "update on the mod_jrun2 issue:\n\nI can load your mod_jrun2.so with my gcc builds of 2.0.46 on AIX 4.3.3 ML 11 and\nAIX 5.1 ML 2.  Comparing your dump -THv output with mine, I do not think that it\nis a symbol resolution problem.\n\nMaybe there is some OS level dependency somewhere that is independent of symbol\nresolution?  (If you didn't build mod_jrun2.so yourself, maybe it was built on a\nhigher level of AIX and your dynamic loader is missing the ability to load it\nfor reasons I won't even try to guess.)\n\nThe only suggestions I have are:\n\na) install autoconf 2.13 and libtool 1.4.2 from source and see if by chance\nhttpd ends up getting linked with some different property (that I don't know how\nto check for) that allows mod_jrun2 to be loaded.\n\nb) contact the vendor of mod_jrun2 and get them to help debug it\n\nc) let me try to load mod_jrun2.so with YOUR httpd on my machine and see if it\nloads (tell me privately where to download it)...  that would perhaps support\nthe theory that there is an OS level issue causing the problem\n\n(to other Apache developers who may see this traffic: no Apache bugs suspected\nso far on either issue, but I'll leave this PR open until we can at least\nresolve the problem that mod_php depends on an interface that we don't mark as\npart of the API)\n", "attachment_id": null, "id": 39572, "creator": "trawick@apache.org", "time": "2003-06-28T14:20:52Z", "bug_id": 21046, "creation_time": "2003-06-28T14:20:52Z", "is_private": false}, {"count": 4, "tags": [], "text": "There are no known Apache problems behind these DSO load failures.\n\nThe PHP issue with ap_max_requests_per_child has been fixed in PHP as of PHP\n4.3.4.  It now calls ap_mpm_query(AP_MPMQ_MAX_REQUESTS_DAEMON, &max_requests)\ninstead of referencing the variable ap_max_requests_per_child.\n\nIf the mod_jrun2 problem still occurs, contact the vendor.\n\nThanks for using Apache!\n", "attachment_id": null, "bug_id": 21046, "id": 47257, "time": "2003-11-12T16:21:23Z", "creator": "trawick@apache.org", "creation_time": "2003-11-12T16:21:23Z", "is_private": false}]