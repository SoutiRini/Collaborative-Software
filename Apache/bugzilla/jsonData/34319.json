[{"count": 0, "tags": [], "creator": "tom@squeat.com", "attachment_id": null, "id": 73324, "time": "2005-04-06T04:12:25Z", "bug_id": 34319, "creation_time": "2005-04-06T04:12:25Z", "is_private": false, "text": "Using a session store such as JDBCStore with the default configuration \n(Engine.backgroundProcessorDelay=10 and StandardManager.processExpiresFrequency=6), \nStoreBase.processExpires() will wake up once a minute and load all stored sessions into memory.   So, \nwith the default 30-minute session-timeout setting, this means we are loading up to 29 minutes worth \nof sessions that won't be ready to expire.   In this example we load 30x more sessions than we actually \nneed to. \n\nSince the purpose of StoreBase.processExpires() is to find sessions that are ready to be expired, it \ndoesn't make sense to load ALL session for cases where we could pre-filter sessions BEFORE loading \nthem.   For example, JDBCStore could use a where clause to reduce the number of sessions loaded as \ncandidates to be expired and FileStore could query the filesystem for the age of the files before loading.    \nThe current behavior could be the worst-case fallback for Stores in which it is not possible to get age \ninformation.\n\nI propose that StoreBase.processExpires() be refactored to load only keys of old sessions when possible \nby providing an oldKeys() method that may be overriden.   By default this would just return all keys but \nit should be easy to extend this in specialized versions (I will provide a sample patch to illustrate for \nJDBCStore)."}, {"count": 1, "tags": [], "creator": "tom@squeat.com", "attachment_id": 14627, "id": 73325, "time": "2005-04-06T04:14:57Z", "bug_id": 34319, "creation_time": "2005-04-06T04:14:57Z", "is_private": false, "text": "Created attachment 14627\nJDBCStore example\n\nThis is just one way of doing it.   In any case I'd be happy with any\nalternative that achieves the same goal."}, {"count": 2, "tags": [], "creator": "tom@squeat.com", "attachment_id": 14654, "id": 73422, "time": "2005-04-07T22:49:59Z", "bug_id": 34319, "creation_time": "2005-04-07T22:49:59Z", "is_private": false, "text": "Created attachment 14654\nJDBCStore.processExpires()\n\nHere's a better idea.\tInstead of loading in any sessions at all, why not\noverride processExpires() to simply remove the old sessions.   This\naccomplishes exactly the same thing without all of the loading and deleting of\nsessions.   This is a huge performance (and memory usage) improvment."}, {"count": 3, "tags": [], "bug_id": 34319, "text": "Changing the severity to enhancement and updating the version.\n\nI have only skimmed the patches but the first one looks plausible. The approach\nof the second bypasses the listener notification and therefore would not work.", "id": 93319, "time": "2006-09-11T02:52:33Z", "creator": "markt@apache.org", "creation_time": "2006-09-11T02:52:33Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 34319, "attachment_id": null, "text": "Closing this as WONTFIX given how much time has passed with no activity, votes,\nor comments on the issue.  If the original poster still cares enough to submit a\npatch that does not bypass the listener, he can reopen this issue and attach\nsaid patch at that time.", "id": 97217, "time": "2006-12-24T08:11:07Z", "creator": "yoavs@computer.org", "creation_time": "2006-12-24T08:11:07Z", "is_private": false}, {"count": 5, "tags": [], "creator": "felix.schumacher@internetallee.de", "attachment_id": null, "id": 186470, "creation_time": "2015-11-21T13:18:24Z", "time": "2015-11-21T13:18:24Z", "bug_id": 34319, "text": "*** Bug 47281 has been marked as a duplicate of this bug. ***", "is_private": false}, {"count": 6, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 186471, "time": "2015-11-21T18:47:34Z", "bug_id": 34319, "creation_time": "2015-11-21T18:47:34Z", "is_private": false, "text": "Re-opening for fixing in a latter version."}, {"count": 7, "tags": [], "bug_id": 34319, "attachment_id": null, "id": 188271, "creation_time": "2016-02-07T19:25:27Z", "time": "2016-02-07T19:25:27Z", "creator": "markt@apache.org", "text": "A variation of this patch was applied to 9.0.x for 9.0.0.M3 onwards.", "is_private": false}]