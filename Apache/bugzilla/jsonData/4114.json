[{"count": 0, "tags": [], "creator": "mike@ds808.net", "attachment_id": null, "id": 6607, "time": "2001-10-11T23:20:26Z", "bug_id": 4114, "creation_time": "2001-10-11T23:20:26Z", "is_private": false, "text": "Downloaded and running default (as distributed) 3.3 rc1 under -sandbox.\nThe following examples jsp's display security manager access problem.  I've \nincluded the stack and additional comments below.  NB: All other jsp and \nservlets in the /examples app work fine.\n\njsp-servlet-jsp\nforward\ninclude\nerrorpage - only if error page is invoked.\n\nHere is the following error msg:\nRoot cause:\njava.security.AccessControlException: access denied \n(java.lang.RuntimePermission setContextClassLoader)\n\tat java.security.AccessControlContext.checkPermission\n(AccessControlContext.java:272)\n\tat java.security.AccessController.checkPermission\n(AccessController.java:399)\n\tat java.lang.SecurityManager.checkPermission(SecurityManager.java:545)\n\tat java.lang.Thread.setContextClassLoader(Thread.java:1140)\n\tat org.apache.tomcat.util.compat.Jdk12Support.setContextClassLoader\n(Jdk12Support.java:115)\n\tat org.apache.tomcat.modules.generators.Jdk12Interceptor.postServletInit\n(Jdk12Interceptor.java:102)\n\tat org.apache.tomcat.facade.ServletHandler.init(ServletHandler.java:260)\n\tat org.apache.tomcat.facade.ServletHandler.service\n(ServletHandler.java:419)\n\tat org.apache.tomcat.facade.RequestDispatcherImpl.doForward\n(RequestDispatcherImpl.java:270)\n\tat org.apache.tomcat.facade.RequestDispatcherImpl.access$100\n(RequestDispatcherImpl.java:103)\n\tat org.apache.tomcat.facade.RequestDispatcherImpl$RDIAction.run\n(RequestDispatcherImpl.java:571)\n\tat org.apache.tomcat.util.compat.Jdk12Support$PrivilegedProxy.run\n(Jdk12Support.java:183)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat org.apache.tomcat.util.compat.Jdk12Support.doPrivileged\n(Jdk12Support.java:100)\n\tat org.apache.tomcat.facade.RequestDispatcherImpl.forward\n(RequestDispatcherImpl.java:167)\n\tat org.apache.jasper.runtime.PageContextImpl.forward\n(PageContextImpl.java:423)\n\tat jsp.jsptoserv.jsptoservlet_1._jspService(jsptoservlet_1.java:57)\n\tat org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:119)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java)\n\tat org.apache.tomcat.facade.ServletHandler.doService\n(ServletHandler.java:484)\n\tat org.apache.tomcat.core.Handler.invoke(Handler.java:322)\n\tat org.apache.tomcat.core.Handler.service(Handler.java:235)\n\tat org.apache.tomcat.facade.ServletHandler.service\n(ServletHandler.java:432)\n\tat org.apache.tomcat.core.ContextManager.internalService\n(ContextManager.java:915)\n\tat org.apache.tomcat.core.ContextManager.service\n(ContextManager.java:831)\n\tat org.apache.tomcat.modules.server.Http10Interceptor.processConnection\n(Http10Interceptor.java:161)\n\tat org.apache.tomcat.util.net.TcpWorkerThread.runIt\n(PoolTcpEndpoint.java:477)\n\tat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:517)\n\tat java.lang.Thread.run(Thread.java:484)\n= = = = = = = = = = = = = = = = = = = = = = = = = \n\nCOMMENTS:\nThe only way i could get it to work was to slip the following statement into \ntomcat.policy:\n\ngrant codeBase \"file:${tomcat.home}/webapps/examples/-\" {\n    permission java.security.AllPermission;\n};"}, {"count": 1, "tags": [], "bug_id": 4114, "attachment_id": null, "id": 6640, "time": "2001-10-12T11:12:00Z", "creator": "Larry.Isaacs@sas.com", "creation_time": "2001-10-12T11:12:00Z", "is_private": false, "text": "Thanks for reporting this.  We will address this in Tomcat 3.3.1"}, {"count": 2, "tags": [], "bug_id": 4114, "attachment_id": null, "id": 6643, "time": "2001-10-12T11:33:53Z", "creator": "mike@ds808.net", "creation_time": "2001-10-12T11:33:53Z", "is_private": false, "text": "Can someone please confirm this bug as being a bug?  This seems unusual that \nthe test examples do not work under the sandbox system provided.  The \nworkaround noted is not practical in a real server environment with hundreds of \ncontext's that need to be secured.  Please fix this before releasing Tomcat 330."}, {"count": 3, "tags": [], "creator": "cmanolache@yahoo.com", "text": "Confirmed :-)\nThe fix is not difficult, we're using a bad AccessControlContext when doing \ndoPriviledged. I'll check it in tonight, this will be fixed in 3.3FCS", "id": 6650, "time": "2001-10-12T13:43:36Z", "bug_id": 4114, "creation_time": "2001-10-12T13:43:36Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 4114, "text": "Costin, THANK YOU!  Without a working Java Security Manager in place, we would \nbe unable to host and support Tomcat 33.\n\nMike", "id": 6661, "time": "2001-10-12T17:23:36Z", "creator": "mike@ds808.net", "creation_time": "2001-10-12T17:23:36Z", "is_private": false, "attachment_id": null}]