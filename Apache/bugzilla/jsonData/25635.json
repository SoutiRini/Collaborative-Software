[{"count": 0, "tags": [], "bug_id": 25635, "text": "I'm trying to use a RewriteMap and a RewriteRule for load balancing. I use a \npython script in the RewriteMap to modify the URL but I get a newline character \nin the URL which causes a browser error.\n\nHTTP ERROR: 404 /ctms/%0D Not Found \n\nMy environment is as follows: \n 1. Apache 2.0.48 \n 2. Win2K 5.00.2195 Service Pack 3 \n 3. Python23 \n\nMy httpd.conf looks as follows: \n\nRewriteEngine on \nRewriteLogLevel 20 \nRewriteLog rewrite.log \nRewriteMap servers \"prg:C:/Tools/Python23/python.exe c:/proxy.py\" \nRewriteRule ^/ctms/(.*) ${servers:$1}  [P,L] \n\nMy python script: \n\n#!c:\\Tools\\Python23\\python.exe \n\ncount=0 \n\nimport sys \nimport string \nimport os \n\nif __name__ == \"__main__\": \n    servers = ['http://server1:8080/ctms/','http://server2:8080/ctms/'] \n    while 1: \n        data = sys.stdin.readline() \n        if not data: \n            break \n        count = (count+1) % 2 \n        print servers[count]  ( remaps correctly but puts newline character in \nURL ) \n#        sys.stdout.write(\"%s\" % servers[count])  (tried this but causes hang) \n#        sys.stdout.write(\"%s\\n\" % servers[count])  (tried this, same as print) \n        sys.stdout.flush()  ( if I don't have this, does not remap ) \n\n\n\nRewrite.log: \n\n(2) init rewrite engine with requested uri /ctms/ \n(3) applying pattern '^/ctms/(.*)' to uri '/ctms/' \n(2) init rewrite engine with requested uri /ctms/ \n(3) applying pattern '^/ctms/(.*)' to uri '/ctms/' \n(5) map lookup OK: map=servers key= -> val=http://server1:8080/ctms/ \n198.213.32.14 - - [17/Dec/2003:15:12:20 --0600] [server1/sid#23c590]\n[rid#47e9c0/initial] (2) rewrite /ctms/ -> http://server1:8080/ctms/ \n198.213.32.14 - - [17/Dec/2003:15:12:20 --0600] [server1/sid#23c590]\n[rid#47e9c0/initial] (2) forcing proxy-throughput with \nhttp://server1:8080/ctms/ 198.213.32.14 - - [17/Dec/2003:15:12:20 --0600] \n[server1/sid#23c590][rid#47e9c0/initial] (1) go-ahead with proxy request \nproxy:http://server1:8080/ctms/<newline character here> [OK]", "id": 49372, "time": "2003-12-18T19:17:22Z", "creator": "mark.thias@bnpi.com", "creation_time": "2003-12-18T19:17:22Z", "is_private": false, "attachment_id": null}, {"count": 1, "attachment_id": null, "creator": "nd@perlig.de", "is_private": false, "id": 51136, "time": "2004-01-25T16:00:32Z", "bug_id": 25635, "creation_time": "2004-01-25T16:00:32Z", "tags": [], "text": "FYI: Fixed in 2.1\n\nThanks for the report and thanks for using Apache."}]