[{"count": 0, "tags": [], "bug_id": 54971, "is_private": false, "text": "1. fileName parameter / relative vs absolute\nfilaName parameter specification in\n<1><JSR-000315 Java Servlet 3.0 Final Release javadocs>\nis different from the <2><javax API tomcat refers to>.\n\n<1> <JSR-000315 Java Servlet 3.0 Final Release javadocs>\n\nParameters:fileName - the name of the file to which the stream will be written. The file is created relative to the location as specified in the MultipartConfig\n\n<2> javax. API tomcat refers to\n\n * @param fileName  The location into which the uploaded part should be\n     *                  stored. Relative locations are relative to {@link\n     *                  javax.servlet.MultipartConfigElement#getLocation()}\n\n\nTomcat is implemented as specified in <2> so that it can process \"absolute path\",\nbut it should only accept \"relative path\" as specified in <1>\n<JSR-000315 Java Servlet 3.0 Final Release javadocs>\n\n2.\nIf MultiPartConfig.location is not set,\nwrite( String relative path ) throws FileNotFound Exception.\nA default location needs to be set in order to avoid such exception.\n\nexample) os: windows8\n\npart.write(\"/test\");\n\njava.io.IOException: java.io.FileNotFoundException: \\test (Access is denied)\n\tat org.apache.catalina.core.ApplicationPart.write(ApplicationPart.java:123)\n\tat servlet.multipart.MultipleUploadServlet.doPost(MultipleUploadServlet.java:76)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:647)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:728)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)\n\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)\n\tat org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:947)\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:408)\n\tat org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1009)\n\tat org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)\n\tat org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)\n\tat java.lang.Thread.run(Thread.java:662)", "id": 167206, "time": "2013-05-15T02:16:03Z", "creator": "howeverking@gmail.com", "creation_time": "2013-05-15T02:16:03Z", "attachment_id": null}, {"count": 1, "tags": [], "text": "http://docs.oracle.com/javaee/6/api/javax/servlet/http/Part.html#write%28java.lang.String%29", "attachment_id": null, "bug_id": 54971, "id": 167207, "time": "2013-05-15T02:24:43Z", "creator": "howeverking@gmail.com", "creation_time": "2013-05-15T02:24:43Z", "is_private": false}, {"count": 2, "tags": [], "text": "For the problem 2, the default location of MultipartConfig is avax.servlet.context.tempdir as defined by 8.1.5\n@MultipartConfig.", "attachment_id": null, "id": 167211, "creator": "bluewolf.chung@gmail.com", "time": "2013-05-15T05:19:49Z", "bug_id": 54971, "creation_time": "2013-05-15T05:19:49Z", "is_private": false}, {"count": 3, "tags": [], "text": "(In reply to comment #0)\n> 1. fileName parameter / relative vs absolute\n\nTomcat is implementing a container specific extension that allows absolute paths to be specified. I thought that there had been some discussion of this previously but I can't find anything in the archives.\n\nAny specification compliant input (i.e. a relative path) will work so nothing is broken w.r.t. to the spec here.", "is_private": false, "bug_id": 54971, "id": 167217, "time": "2013-05-15T11:02:40Z", "creator": "markt@apache.org", "creation_time": "2013-05-15T11:02:40Z", "attachment_id": null}, {"count": 4, "tags": [], "text": "(In reply to comment #2)\n> For the problem 2, the default location of MultipartConfig is\n> avax.servlet.context.tempdir as defined by 8.1.5\n> @MultipartConfig.\n\nAgreed. Tomcat applies that default elsewhere but it is missing in this case. Tomcat also handles relative locations by making them relative to javax.servlet.context.tempdir\n\nI'll see about getting this fixed.", "is_private": false, "bug_id": 54971, "id": 167219, "time": "2013-05-15T11:09:49Z", "creator": "markt@apache.org", "creation_time": "2013-05-15T11:09:49Z", "attachment_id": null}, {"count": 5, "attachment_id": null, "bug_id": 54971, "text": "This has been fixed in trunk and 7.0.x and will be included in 7.0.41 onwards.", "id": 167460, "time": "2013-05-28T14:49:08Z", "creator": "markt@apache.org", "creation_time": "2013-05-28T14:49:08Z", "tags": [], "is_private": false}]