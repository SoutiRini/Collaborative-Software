[{"count": 0, "tags": [], "bug_id": 26610, "text": "The formula document on the HSSF website instructed to report all occurrences of #VALUE! when \nattempting to programmatically assign a formula to a cell, so here goes:\n\nIF(A1 > 5, \"big number\", \"small number\")\n\nThis formula works, and displays correctly when opened in Excel.\n\n#VALUE! is only displayed if the outer IF branches to an inner IF.  For example:\n\n> IF(A1 > 5, \"big number\", IF(A1 < 2, \"really small number\", \"small number\"))\n\n#VALUE! is displayed if \"A1 > 5\" evaluates to false, and branches to the \"else\" argument, where \nthere's a nested IF.  If \"A1 > 5\" evaluates to true, the formula displays correctly, because there's no \nnested if in the \"true\" argument.\n\n#VALUE! is always displayed if both the true and false arguments contain nested IF's.\n\n-The cell displays #VALUE!\n-but if I type it in directly in Excel, the formula works\n-also, clicking in the formula bar of POI-generated formula, then hitting Enter, fixes the formula\n\nThanks,\n\n-Sasha Borodin", "id": 51606, "time": "2004-02-02T18:18:05Z", "creator": "sasha@WhoIsSasha.com", "creation_time": "2004-02-02T18:18:05Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "text": "Having AND in the eval part of a If in a formula results in #Value err too.\n\nIf user goes to the output cell and presses F2 in Excel then presses enter ( \nmakes Excel re evaluate it) the formula shows up ok.\nUsing Calc now in Excel menu does not work\n\nAutomated work around - placing a loop macro that touches all formula .\n'In workbook\n\nPrivate Sub Workbook_Open()\nIf Sheets(1).Range(\"iv1001\").Value = \"0\" Then\n    Sheets(1).Range(\"iv1001\").Value = \"1\"\n    Sheets(1).touchFormlas\nEnd If\nEnd Sub\n\n'in sheet\nSub touchFormlas()\nOn Local Error GoTo errH\nDim wkBk As Workbook\nDim sht As Worksheet\nDim i As Long\nDim colFrom As Long\nDim colTo As Long\nDim rwFrm As Long\nDim rwTo As Long\n\nSet wkBk = Workbooks(ActiveSheet.Cells(1, 2).Value)\n\nSet sht = wkBk.Sheets(ActiveSheet.Cells(2, 2).Value)\n\nrwFrm = ActiveSheet.Cells(3, 2).Value\n\nrwTo = ActiveSheet.Cells(4, 2).Value\ncolFrom = ActiveSheet.Cells(5, 2).Value\n\ncolTo = ActiveSheet.Cells(6, 2).Value\n\nIf rwTo < 0 Then\n    rwTo = rwFrm\n    Do While Len(sht.Cells(rwTo, colFrom).Value) > 0\n        rwTo = rwTo + 1\n    Loop\n    \nEnd If\n\n'touch all cells formulas - workaround for #value POI bug\n'run this macro in workbook open ( keep a flag in cell BI5000 so it does not \nrun everytime u open - only first time)\nFor i = rwFrm To rwTo\n    For j = colFrom To colTo\n        If sht.Cells(i, j).Formula <> \"\" Then\n            z = sht.Cells(i, j).Formula\n            sht.Cells(i, j).Formula = \"\"\n            sht.Cells(i, j).Value = \"=3\"\n            sht.Cells(i, j).Formula = z 'sht.Cells(i, j).Formula\n        End If\n        'sht.Cells(i, j).Refresh\n    Next\n    \nNext\nErr.Clear\nIf Err.Number <> 0 Then\nerrH:\n    Debug.Print Err.Number, Err.Description\n    Resume Next\nEnd If\nEnd Sub", "attachment_id": null, "id": 80106, "creator": "tgkprog@gmail.com", "time": "2005-09-19T13:13:27Z", "bug_id": 26610, "creation_time": "2005-09-19T13:13:27Z", "is_private": false}, {"count": 2, "tags": [], "creator": "tgkprog@gmail.com", "attachment_id": null, "id": 80107, "time": "2005-09-19T13:18:05Z", "bug_id": 26610, "creation_time": "2005-09-19T13:18:05Z", "is_private": false, "text": "egample of formula that has AND\n=IF(AND(BH3<>0,BH3<>\"\",BK3<>\"\"),BH3*BK3,0)\n\nworkaround tried - nested if - that does not work\n\nin this case had another work around :\n=IF((BH4>BX4),BH4,0)*IF(BK4>BX4,BK4,0)\n"}, {"count": 3, "tags": [], "bug_id": 26610, "attachment_id": null, "text": "Retested OK in 3.1-beta1\n\nProbably fixed in 3.0.1-alpha due to work on bug 24925 (2004-04-29, svn r353553)", "id": 116262, "time": "2008-05-05T13:51:13Z", "creator": "josh@apache.org", "creation_time": "2008-05-05T13:51:13Z", "is_private": false}]