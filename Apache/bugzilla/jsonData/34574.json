[{"count": 0, "tags": [], "text": "Hello, \n\nFirst of all, i know it is not a recommended practice to use antcall in a \nmacro, but i don't see many other options to achieve my goals. What i actually \nwant to do is to do some conditional things inside a macro. I have a macro that \ngenerates hibernate files using xdoclet, but only if the hibernate mapping \nfiles are not up to date. This conditional logic is (in standard ant) only \npossible though the use of conditional targets ( if/unless attributes). This \nmeans that i have to call a target inside a macro, leading to the antcall. \n\nThe problem if i define in my macro eg a patternset with a macro element as \ncontent, this patternset cannot be used in the target called by antcall. It \nseems that the macro elements are not replaced correctly anymore after a call \nto antcall. \n\nThis stripped down build file shows the problem. \n\n<project name=\"test\">\n\n    <target name=\"doclet_check\">\n        <uptodate property=\"doclet.uptodate\" value=\"true\" \ntargetfile=\"${basedir}\">\n            <srcfiles dir=\"${basedir}\">\n                <patternset refid=\"doclet.src.pattern\"/> <!-- reference to a \npattern defined by the macro.. -->\n            </srcfiles>\n        </uptodate>\n    </target>\n\n    <target name=\"doclet\" depends=\"doclet_check\" unless=\"doclet.uptodate\">\n    </target>\n\n    <macrodef name=\"docletmacro\">\n        <element name=\"optionalpatterns\" implicit=\"yes\"/>\n        <sequential>\n            <patternset id=\"doclet.src.pattern\">\n                <optionalpatterns/>\n            </patternset>\n            <antcall target=\"doclet\" inheritRefs=\"true\">\n            </antcall>\n        </sequential>\n    </macrodef>\n\n    <target name=\"test\">\n        <docletmacro>\n            <include name=\"*.java\"/>\n        </docletmacro>\n    </target>\n\n</project>\n\n\nexecuting the 'test' target leads to the following exception:\n\nC:\\views\\janssk1_hp\\elisa_dev\\ni\\components\\test\\testbuild.xml:26: The \nfollowing error occurred whil\ne executing this line:\nC:\\views\\janssk1_hp\\elisa_dev\\ni\\components\\test\\testbuild.xml:20: The \nfollowing error occurred whil\ne executing this line:\nC:\\views\\janssk1_hp\\elisa_dev\\ni\\components\\test\\testbuild.xml:4: The \n<patternset> type doesn't supp\nort the nested \"optionalpatterns\" element.", "is_private": false, "id": 73975, "creator": "janssk1@hotmail.com", "time": "2005-04-22T14:01:54Z", "bug_id": 34574, "creation_time": "2005-04-22T14:01:54Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "peterreilly@apache.org", "attachment_id": null, "is_private": false, "id": 73976, "time": "2005-04-22T14:06:31Z", "bug_id": 34574, "creation_time": "2005-04-22T14:06:31Z", "text": "\n\n*** This bug has been marked as a duplicate of 34458 ***"}]