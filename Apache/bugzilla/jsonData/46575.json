[{"count": 0, "tags": [], "creator": "juergen.wehren@framesoft.com", "is_private": false, "id": 124226, "attachment_id": 23147, "bug_id": 46575, "creation_time": "2009-01-21T03:54:24Z", "time": "2009-01-21T03:54:24Z", "text": "Created attachment 23147\nPatch for NPX in HSSFWorkbook.convertLabelRecords()\n\nWhen reading an Excel Sheet with an embedded Excel Diagram a Nullpointer Exception occurs at HSSFWorkbook.convertLabelRecords:\n\nCaused by: java.lang.NullPointerException\n\tat org.apache.poi.hssf.record.UnicodeString.setString(UnicodeString.java:343)\n\tat org.apache.poi.hssf.record.UnicodeString.<init>(UnicodeString.java:104)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.convertLabelRecords(HSSFWorkbook.java:303)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:215)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>(HSSFWorkbook.java:259)\n\tat com.framesoft.ffr.dms.lucene.documentHandler.ExcelPoiHSSFHandler.getDocumentContent(ExcelPoiHSSFHandler.java:25)\n\t... 1 more\n\nI fixed this issue for our project where we extract the text from multiple Excel Documents by changing this Line:\n\nworkbook.addSSTString(new UnicodeString(oldrec.getValue()));\n\nwith this Line:\n\nworkbook.addSSTString((oldrec.getValue() == null ? null : new UnicodeString(oldrec.getValue())));\n\nI don't know if this is a valid solution for this issue but for us it fixed the problem. \n\nMaybe there is a problem with some of the ExcelSheets we are trying to read that have a LabelRecord with a Null value. The Nullpointer did not occur if one of the embedded ExcelDiagrams was removed. The Diagram is referencing a Table with an empty row, so maybe that is the reason for the problem. \n\nI attached an example for this diagram that will result in an NPX."}, {"count": 1, "tags": [], "creator": "juergen.wehren@framesoft.com", "text": "Created attachment 23148\nExcel Sheet with an embedded Diagram/Chart that will cause the NPX", "id": 124228, "attachment_id": 23148, "bug_id": 46575, "creation_time": "2009-01-21T03:56:27Z", "time": "2009-01-21T03:56:27Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 46575, "text": "The patch is specified to be applied against latest svn trunk, but the bug is no longer visible there.  The stacktrace provided is from an old version of POI.  The problem was fixed with bug 42570 (from version 3.1-beta2 onwards).\n\nPlease do a search first to save time in future. e.g.:\nhttp://www.google.com/search?q=NullPointerException+convertLabelRecords\n\n*** This bug has been marked as a duplicate of bug 42570 ***", "id": 124507, "time": "2009-01-29T16:24:39Z", "creator": "josh@apache.org", "creation_time": "2009-01-29T16:24:39Z", "is_private": false, "attachment_id": null}]