[{"count": 0, "text": "org.apache.coyote.tomcat4.CoyoteServerSocketFactory seems to be ignoring the \nkeystoreType attribute. I'm trying to get it to work with a PKCS12 file. It \nworks fine if I used the legacy HTTP connection, but, it doesn't work if I use \nthe new Coyote connector.\n\nI'm using the following in my server.xml.\n\n                <Connector \nclassName=\"org.apache.coyote.tomcat4.CoyoteConnector\"\n                        port=\"443\"\n                        minProcessors=\"5\"\n                        maxProcessors=\"75\"\n                        enableLookups=\"true\"\n                        acceptCount=\"10\"\n                        debug=\"0\"\n                        scheme=\"https\"\n                        secure=\"true\">\n                        <Factory \nclassName=\"org.apache.coyote.tomcat4.CoyoteServerSocketFactory\"\n                                keystoreType=\"pkcs12\"\n                                clientAuth=\"false\"\n                                protocol=\"TLS\"/>\n                </Connector>\n\nAnd I receive the following error in catalina.out.\n\nJun 6, 2002 4:48:00 PM org.apache.commons.logging.impl.Jdk14Logger info\nINFO: Attribute port: 443\nJun 6, 2002 4:48:00 PM org.apache.commons.logging.impl.Jdk14Logger info\nINFO: Attribute maxThreads: 75\nJun 6, 2002 4:48:00 PM org.apache.commons.logging.impl.Jdk14Logger info\nINFO: Attribute backlog: 10\nJun 6, 2002 4:48:00 PM org.apache.commons.logging.impl.Jdk14Logger info\nINFO: Attribute tcpNoDelay: true\nJun 6, 2002 4:48:00 PM org.apache.commons.logging.impl.Jdk14Logger info\nINFO: Attribute soTimeout: 60000\nJun 6, 2002 4:48:00 PM org.apache.commons.logging.impl.Jdk14Logger info\nINFO: Attribute timeout: 60000\nJun 6, 2002 4:48:00 PM org.apache.commons.logging.impl.Jdk14Logger info\nINFO: Attribute secure: true\nJun 6, 2002 4:48:00 PM org.apache.commons.logging.impl.Jdk14Logger info\nINFO: Attribute algorithm: null\nJun 6, 2002 4:48:00 PM org.apache.commons.logging.impl.Jdk14Logger info\nINFO: Attribute keystore: /root/.keystore\nJun 6, 2002 4:48:00 PM org.apache.commons.logging.impl.Jdk14Logger info\nINFO: Attribute protocol: TLS\nJun 6, 2002 4:48:00 PM org.apache.commons.logging.impl.Jdk14Logger info\nINFO: Attribute sslImplementation: null\nJun 6, 2002 4:48:00 PM org.apache.commons.logging.impl.Jdk14Logger error\nSEVERE: Error initializing endpoint\njava.io.IOException: Invalid keystore format\n        at sun.security.provider.JavaKeyStore.engineLoad(JavaKeyStore.java:606)\n        at java.security.KeyStore.load(KeyStore.java:652)\n        at org.apache.tomcat.util.net.JSSESocketFactory.initKeyStore\n(JSSESocketFactory.java:251)\n        at org.apache.tomcat.util.net.JSSESocketFactory.initProxy\n(JSSESocketFactory.java:182)\n        at org.apache.tomcat.util.net.JSSESocketFactory.createSocket\n(JSSESocketFactory.java:127)\n        at org.apache.tomcat.util.net.PoolTcpEndpoint.initEndpoint\n(PoolTcpEndpoint.java:263)\n        at org.apache.coyote.http11.Http11Protocol.init\n(Http11Protocol.java:150)\n        at org.apache.coyote.tomcat4.CoyoteConnector.initialize\n(CoyoteConnector.java:1002)\n        at org.apache.catalina.core.StandardService.initialize\n(StandardService.java:582)\n        at org.apache.catalina.core.StandardServer.initialize\n(StandardServer.java:2243)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:509)\n        at org.apache.catalina.startup.Catalina.execute(Catalina.java:400)\n        at org.apache.catalina.startup.Catalina.process(Catalina.java:180)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke\n(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:324)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:203)\nCatalina.start: LifecycleException:  Protocol handler initialization failed: \njava.io.IOException: Invalid keystore format\nLifecycleException:  Protocol handler initialization failed: \njava.io.IOException: Invalid keystore format\n        at org.apache.coyote.tomcat4.CoyoteConnector.initialize\n(CoyoteConnector.java:1004)\n        at org.apache.catalina.core.StandardService.initialize\n(StandardService.java:582)\n        at org.apache.catalina.core.StandardServer.initialize\n(StandardServer.java:2243)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:509)\n        at org.apache.catalina.startup.Catalina.execute(Catalina.java:400)\n        at org.apache.catalina.startup.Catalina.process(Catalina.java:180)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke\n(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:324)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:203)\nCatalina.stop: LifecycleException:  This server has not yet been started\nLifecycleException:  This server has not yet been started\n        at org.apache.catalina.core.StandardServer.stop\n(StandardServer.java:2210)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:541)\n        at org.apache.catalina.startup.Catalina.execute(Catalina.java:400)\n        at org.apache.catalina.startup.Catalina.process(Catalina.java:180)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke\n(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:324)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:203)\n\nIf I use the legacy HTTP connector like this, it works OK.\n\n                <Connector \nclassName=\"org.apache.catalina.connector.http.HttpConnector\"\n                        port=\"443\"\n                        minProcessors=\"5\"\n                        maxProcessors=\"75\"\n                        enableLookups=\"true\"\n                        acceptCount=\"10\"\n                        debug=\"0\"\n                        scheme=\"https\"\n                        secure=\"true\">\n                        <Factory \nclassName=\"org.apache.catalina.net.SSLServerSocketFactory\"\n                                keystoreType=\"pkcs12\"\n                                clientAuth=\"false\"\n                                protocol=\"TLS\"/>\n                </Connector>", "bug_id": 9676, "is_private": false, "id": 17359, "time": "2002-06-06T21:58:00Z", "creator": "jemiller@uchicago.edu", "creation_time": "2002-06-06T21:58:00Z", "tags": [], "attachment_id": null}, {"count": 1, "text": "This should be fixed now (there was an obvious bug setting the keystore type\nattribute). If you want to test it, you can try to build from CVS or wait for\nthe next release.", "bug_id": 9676, "is_private": false, "id": 17377, "time": "2002-06-07T01:11:02Z", "creator": "remm@apache.org", "creation_time": "2002-06-07T01:11:02Z", "tags": [], "attachment_id": null}]