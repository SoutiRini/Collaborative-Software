[{"count": 0, "tags": [], "creator": "garfid.n.rena@gmail.com", "attachment_id": 35230, "is_private": false, "id": 200319, "time": "2017-08-16T05:39:35Z", "bug_id": 61421, "creation_time": "2017-08-16T05:39:35Z", "text": "Created attachment 35230\nThe file caused the exeption"}, {"count": 1, "tags": [], "bug_id": 61421, "attachment_id": null, "id": 200320, "time": "2017-08-16T05:43:53Z", "creator": "garfid.n.rena@gmail.com", "creation_time": "2017-08-16T05:43:53Z", "is_private": false, "text": "Code that caused the drop\n\nXWPFDocument docx = new XWPFDocument(new FileInputStream(\"D:\\\\curs.docx\"));\n            ArrayList<Segment> topic = new ArrayList<>();\n\n            int i = 0;\n            for(XWPFParagraph paragraph : docx.getParagraphs()){\n                byte sid = paragraph.getStyleID() != null ? (byte) paragraph.getStyleID().charAt(0) : 0;\n                if (sid >= 49 && sid <=52 ){\n                    if (paragraph.getText().length() > 0) {\n                        System.out.println(paragraph.getStyleID() + \":\" + paragraph.getText());\n                        Segment segment = new Segment(paragraph.getText(), Integer.valueOf(paragraph.getStyleID().charAt(0)));\n                        segment.doc = new XWPFDocument(docx.getPackage());\n                        segment.from = i;\n                        if(topic.size() > 0){\n                            topic.get(topic.size() - 1).to = i - 1;\n                        }\n                        topic.add(segment);\n\n                    }\n                }\n                i++;\n            }\n\n            for(Segment segment : topic){\n                i = 0;\n                for(XWPFParagraph paragraph : docx.getParagraphs()) {\n                    if(!(i >= segment.from && i <=segment.to)){\n                        int pPos = segment.doc.getPosOfParagraph(paragraph);\n                        segment.doc.removeBodyElement(pPos);\n                    }\n                    i++;\n                }\n                segment.doc.write(new FileOutputStream(new File(\"D:\\\\test\\\\\" + segment.title + \".docx\")));\n                segment.doc.close();\n            }"}, {"count": 2, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "text": "I don't think using the existing parts for creating new XWFPDocument instances like you try to do here will work, probably better to immediately retrieve the necessary information from the part and not create many instances of XWPFDocument here.\n\nIf you still cannot get it to work when not doing this copying, then please reopen this issue and attach a real self-sufficient unit-test, your example relies on some classes that are not included, so it cannot be reproduced easily.", "id": 201138, "time": "2017-09-26T14:43:40Z", "bug_id": 61421, "creation_time": "2017-09-26T14:43:40Z", "is_private": false}]