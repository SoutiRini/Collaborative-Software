[{"count": 0, "attachment_id": null, "creator": "loic.rodier@gmail.com", "text": "Hi,\n\nWe encountered an error using tomcat.jdbc in acceptance.\nThis pool is used by default on TomEE 1.6.0.2. Some application using DB2 had the issue after a night or at least some hours of inactivity.\nSome broken connections seems to be in pool.\nChanging the pool implementation to Common JDBC fix the problem.\n\nI am not sure it is very interesting to solve issue on DB2 but maybe...\n\nTomEE 1.6.0.2 use Tomcat 7.0.53\nThe driver used is DataDirect 5.1.3\nHere is the pool configuration is:\n\nJdbcDriver com.merant.datadirect.jdbc.db2.DB2Driver\n\t\tJdbcUrl jdbc:datadirect:db2://ooooo:uuu;locationName=xxxx;packageCollection=JDBCV5R0\n\t\tUserName XXXXXX\n\t\tPassword XXXXXX\n\t\tJtaManaged true\n\t\tInitialSize 3\n\t\tMaxActive 20\n\t\tMinIdle 3\n\t\tMaxIdle 10\n\t\tTestOnBorrow true\n\t\ttestOnReturn true\n\t\ttestWhileIdle true\n\t\tnumTestsPerEvictionRun 1\n\t\tPoolPreparedStatements true\n\t\tMaxOpenPreparedStatements 128\n\t\tValidationQuery select current date from sysibm.sysdummy1\n\t\ttimeBetweenEvictionRunsMillis 100000\n\nThe stack trace is:\n\nCaused by: java.sql.SQLException: [DataDirect][DB2 JDBC Driver]Object has been closed.\n\tat com.ddtek.jdbc.db2base.ddcf.b(Unknown Source)\n\tat com.ddtek.jdbc.db2base.ddcf.a(Unknown Source)\n\tat com.ddtek.jdbc.db2base.ddce.b(Unknown Source)\n\tat com.ddtek.jdbc.db2base.ddce.a(Unknown Source)\n\tat com.ddtek.jdbc.db2base.BaseConnection.rollback(Unknown Source)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n\tat java.lang.reflect.Method.invoke(Unknown Source)\n\tat org.apache.tomcat.jdbc.pool.ProxyConnection.invoke(ProxyConnection.java:126)\n\tat org.apache.tomcat.jdbc.pool.JdbcInterceptor.invoke(JdbcInterceptor.java:109)\n\tat org.apache.tomcat.jdbc.pool.interceptor.AbstractCreateStatementInterceptor.invoke(AbstractCreateStatementInterceptor.java:71)\n\tat org.apache.tomcat.jdbc.pool.interceptor.StatementCache.invoke(StatementCache.java:180)\n\tat org.apache.tomcat.jdbc.pool.JdbcInterceptor.invoke(JdbcInterceptor.java:109)\n\tat org.apache.tomcat.jdbc.pool.TrapException.invoke(TrapException.java:41)\n\tat org.apache.tomcat.jdbc.pool.JdbcInterceptor.invoke(JdbcInterceptor.java:109)\n\tat org.apache.tomcat.jdbc.pool.DisposableConnectionFacade.invoke(DisposableConnectionFacade.java:80)\n\tat com.sun.proxy.$Proxy71.rollback(Unknown Source)\n\tat org.apache.openejb.resource.jdbc.managed.local.LocalXAResource.rollback(LocalXAResource.java:158)\n\t... 36 more", "id": 180366, "time": "2015-01-19T10:17:50Z", "bug_id": 57460, "creation_time": "2015-01-19T10:17:50Z", "tags": [], "is_private": false}]