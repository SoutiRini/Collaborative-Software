[{"count": 0, "tags": [], "creator": "mprewitt@chelsea.net", "attachment_id": null, "id": 3654, "time": "2001-07-11T12:50:21Z", "bug_id": 2586, "creation_time": "2001-07-11T12:50:21Z", "is_private": false, "text": "Using the JRE 1.3.1 plug-in with netscape 4.77 or 6.01 over an SSL connection, \nwhen we try and run an applet which uses log4j, we get the following exception:\n\njava.lang.ClassFormatError: org/apache/log4j/PatternLayoutBeanInfo (Bad magic \nnumber)\nat java.lang.ClassLoader.defineClass0(Native Method)\nat java.lang.ClassLoader.defineClass(Unknown Source)\nat java.security.SecureClassLoader.defineClass(Unknown Source)\nat sun.applet.AppletClassLoader.findClass(Unknown Source)\nat sun.plugin.security.PluginClassLoader.findClass(Unknown Source)\nat java.lang.ClassLoader.loadClass(Unknown Source)\nat sun.applet.AppletClassLoader.loadClass(Unknown Source)\nat java.lang.ClassLoader.loadClass(Unknown Source)\nat java.beans.Introspector.instantiate(Unknown Source)\nat java.beans.Introspector.findInformant(Unknown Source)\nat java.beans.Introspector.<init>(Unknown Source)\nat java.beans.Introspector.getBeanInfo(Unknown Source)\nat org.apache.log4j.config.PropertySetter.introspect(PropertySetter.java:66)\nat \norg.apache.log4j.config.PropertySetter.getPropertyDescriptor(PropertySetter.java\n:234)\nat org.apache.log4j.config.PropertySetter.setProperty(PropertySetter.java:146)\nat org.apache.log4j.config.PropertySetter.setProperties(PropertySetter.java:120)\nat org.apache.log4j.config.PropertySetter.setProperties(PropertySetter.java:87)\nat \norg.apache.log4j.PropertyConfigurator.parseAppender(PropertyConfigurator.java:63\n2)\nat \norg.apache.log4j.PropertyConfigurator.parseCategory(PropertyConfigurator.java:59\n5)\nat \norg.apache.log4j.PropertyConfigurator.configureRootCategory(PropertyConfigurator\n.java:502)\nat \norg.apache.log4j.PropertyConfigurator.doConfigure(PropertyConfigurator.java:410)\nat\norg.apache.log4j.PropertyConfigurator.doConfigure(PropertyConfigurator.java:436)\nat\norg.apache.log4j.helpers.OptionConverter.selectAndConfigure(OptionConverter.java\n:455)\nat org.apache.log4j.Category.<clinit>(Category.java:146)\n\nThis problem doesn't happen with netscape over a non-SSL page and it also \ndoesn't happen with IE.  However, we need to run this on an SSL page for \nsecurity reasons.\n\nFrom the web server logs, we have determined that PatternLayoutBeanInfo.class is \nbeing requested from the server and the Netscape is interpreting the returned \nnot found error page as a class file.  In Netscape non-SSL and IE SSL and non, \nthe class is also requested but the plug-in correctly handles the return code \nand continues as if it couldn't find the class.  \n\nWe tried a small patch to PropertySetter to change the Introspecter call to not \nuse the Bean info like this:\n\n  BeanInfo bi = Introspector.getBeanInfo(obj.getClass(), \nIntrospector.IGNORE_ALL_BEANINFO);\n\n\nHowever, this doesn't help as getBeanInfo still seems to look for the BeanInfo \nclass somewhere deeper in the Introspector code.\n\nCurrently, as a work-around, we have used JBuilder's automatic BeanInfo creator \nto build a PatternLayoutBeanInfo.class file which we have included in our \nlog4j.jar file.  \n\nI'm sure the real solution here lies with fixing the Netscape SSL/Java plug-in \nbehavior.  However, something else odd seems to being going on odd in the log4j \nintrospector code. \n\nWe are currently using log4j version 1.1.3.\n\nThanks,\nMarc Prewitt\nChelsea Networks"}, {"count": 1, "tags": [], "creator": "mprewitt@chelsea.net", "attachment_id": null, "id": 3675, "time": "2001-07-12T06:22:09Z", "bug_id": 2586, "creation_time": "2001-07-12T06:22:09Z", "is_private": false, "text": "On Sun's Java Plug-in Troubleshooting FAQ, I found the following which confirms \nthat this is a Netscape HTTPS bug.  However, there is no work-around \nmentioned.  The only work-around we've found is to include the BeanInfo.class \nfile as I mentioned in the original bug-report.\n\nFrom http://java.sun.com/products/plugin/1.3/troubleshooting.faq.html:\n\nQ: I keep getting a ClassFormatError exception when my webpage that uses Java \nPlug-in Software 1.3 is loaded with HTTPS in Netscape Navigator. Why? \n\nA: This is caused by an applet specifying a nonexistent .jar or .class file in \nthe EMBED tag. Due to limitation of what information can be returned via HTTPS \nin Navigator, the web server's \"File Not Found\" HTML page is returned instead \nof the appropriate status. This HTML page is treated as a .class file which \ncauses the exception. "}, {"count": 2, "tags": [], "bug_id": 2586, "attachment_id": null, "is_private": false, "id": 15678, "time": "2002-05-07T22:33:10Z", "creator": "ceki@apache.org", "creation_time": "2002-05-07T22:33:10Z", "text": "\nI don't see how I can help you. As such, I am marking this bug as INVALID."}]