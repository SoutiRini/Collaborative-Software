[{"count": 0, "tags": [], "bug_id": 32487, "is_private": false, "id": 67757, "creation_time": "2004-12-02T08:28:38Z", "time": "2004-12-02T08:28:38Z", "creator": "cowwoc@bbs.darktech.org", "text": "I've got the following task:\n\n<uptodate>\n  <srcfiles dir=\".\" includes=\"DesktopBeautifierShared/source/**/*.java\"/>\n  <mapper type=\"glob\" from=\"DesktopBeautifierShared/source/*.java\"\nto=\"java/classes/*.class\"/>\n</uptodate>\n\nAnd what I notice is that if I run \"ant -v\" under win32, the paths returned by\n<srcfiles> contain \\\\ style directory slashes and the mapper specified fails to\nmatch the resulting path because it uses a different slash.\n\nExpected behavior: <mapper> should be smart enough to convert slashes to the\nappropriate format returned by <srcfiles> or vice-versa.", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 32487, "is_private": false, "id": 67863, "creation_time": "2004-12-03T06:50:46Z", "time": "2004-12-03T06:50:46Z", "creator": "cowwoc@bbs.darktech.org", "text": "This issue is made worse by the fact that if you specify a drive as part of the\npath, the matcher expects a case-sensitive match for it. For example:\n\n<uptodate srcfile=\"c:/windows/system32/msvcr71d.dll\">\n  <mapper type=\"glob\" from=\"c:\\windows\\system32\\*\" to=\"debug/*\"/>\n</uptodate>\n\nwill fail to find a match because <uptodate> sends\n\"C:\\windows\\system32\\msvcp71d.dll\" to <mapper> and the mapper uses a lowercase\ndrive letter so it fails to match. Clearly this behavior is undesirable under win32.\n\nI'm waiting for some feedback from you guys... Please, throw me a bone :)", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 32487, "attachment_id": null, "id": 67869, "time": "2004-12-03T11:37:18Z", "creator": "peterreilly@apache.org", "creation_time": "2004-12-03T11:37:18Z", "is_private": false, "text": "The case insensitive issue is covered by bug 16686.\nThe solution is to provide an embedded globmapper with an\nattribute to specify if the directory characters / and \\ are\nto mapped together (Note that on unix \\ is a valid character\nto have in a filename - although it is infrequent!)\nThe name of the attribute is an issue - I can think of \"mapdirectorycharacter\"\nbut it is a bit long winded....\nin any case the proposed syntax is:\n<uptodate srcfile=\"c:/windows/system32/msvcr71d.dll\">\n  <mapper>\n    <globmapper from=\"c:\\windows\\system32\\*\" to=\"debug/*\" ignorecase=\"yes\"\n                mapdirectorycharacter=\"yes\"/>\n  </mapper>\n</uptodate>\nor\n<uptodate srcfile=\"c:/windows/system32/msvcr71d.dll\">\n  <mapper>\n    <globmapper from=\"c:/windows/system32/*\" to=\"debug/*\" ignorecase=\"yes\"\n                mapdirectorycharacter=\"yes\"/>\n  </mapper>\n</uptodate>\n\n\n"}, {"count": 3, "tags": [], "bug_id": 32487, "attachment_id": null, "id": 67888, "time": "2004-12-03T17:48:50Z", "creator": "cowwoc@bbs.darktech.org", "creation_time": "2004-12-03T17:48:50Z", "is_private": false, "text": "eek, I simply wanted to be able to do this:\n\n<uptodate srcfile=\"c:/windows/system32/msvcr71d.dll\">\n  <mapper type=\"glob\" from=\"c:/windows/system32/*\" to=\"debug/*\"/>\n</uptodate>\n\nThat is, using unix-style slashes everywhere and have it work under win32 in a\ncase-insensitive manner. Case-insensitivity should be on by default under win32\nand using the unix-style slash should work as well. I don't think one should\nhave to specify any special attributes to make this work."}, {"attachment_id": null, "tags": [], "creator": "peterreilly@apache.org", "text": "I can see that this may be a nice thing to have. But I do not\nthink that it is possible to do this due to backward compitible issues.\nFor example, the mapper element does not have to be used to process\nfilenames, it could also be used to process url's. Also, even on\nwindows, it is (or was) possible to set the file system to be\ncase sensitive.\n\nIt will be possible to add the attributes quickly and perhaps later\nwe can have a short-cut syntax to do the same think with less keystrokes.\n(Unfortuanlly neither macrodef or presetdef work too good in this case).\nIt think the name of the attribute will be \"ignoredirchar\", but am open\nto a better name.\n\nOne could do this:\n\n<presetdef name=\"glob\">\n   <globmapper ignorecase=\"yes\" ignoredirchar=\"yes\"/>\n</presetdef>\n\n<uptodate srcfile=\"c:/windows/system32/msvcr71d.dll\">\n  <mapper>\n    <glob from=\"c:/windows/system32/*\" to=\"debug/*\"/>\n  </mapper>\n</uptodate>\n", "count": 4, "id": 67892, "time": "2004-12-03T18:46:54Z", "bug_id": 32487, "creation_time": "2004-12-03T18:46:54Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 32487, "attachment_id": null, "text": "Is it not possible to apply case-insensitivity and slash fixes for non-URLs and\nfor file:// URLs only under win32? I don't think this will break backwards\ncompatibility. As for win32 allowing case-sensitivity, I don't think anyone has\never heard of or used this feature and if they have we can detect it at runtime\nand not apply case-insensitivity. We should concern ourselves with making Ant\nwork on the most-frequently used configuration and fine tune specific varients\nlater.\n\nSorry but I am against adding attributes if they can be avoided altogether. We\nknow what the ideal behavior of Ant should be. Let's just work at it\nincrementally, one case at a time.", "id": 67894, "time": "2004-12-03T19:10:30Z", "creator": "cowwoc@bbs.darktech.org", "creation_time": "2004-12-03T19:10:30Z", "is_private": false}, {"count": 6, "attachment_id": null, "creator": "peterreilly@apache.org", "text": "Actually in a number of important ways windows file system is case-sensitive.\nFor example, with a class called Test.class in the current directory\none can do \"java -cp . Test\", but *not* \"java -cp . test\" on the\ncommand line.\n\nThe pattern matching in ant (the include element and includes attribute\nin fileset, patternset etc and the name attribute in the filename selector)\nare case-sensitive (in unix or on windows - or macos).\n\nThere is *zero* chance that they will be made case-insensitive on windows. So\nthere is also no change that the glob mapper will be case-insensitive, unless\ndirected to do so by a script author.\n\nThe case for magic converting of slashes is much stronger as this is done in\na number of places and it is one of the FAQs on globmapper.\nThe standard answer is to do \n<mapper type=\"glob\" \n   from=\"DesktopBeautifierShared${file.separator}source${file.separator}*.java\"\n   to=\"java/classes/*.class\"/>\nbut this is long-winded and not nice.\n<globmapper from=\"DesktopBeautifierShared/source/*.java\" \n            to=\"java/classes/*.class\" ignoredirchar=\"yes\"/>\nis a little better.\n\n", "id": 67988, "time": "2004-12-06T19:41:33Z", "bug_id": 32487, "creation_time": "2004-12-06T19:41:33Z", "tags": [], "is_private": false}, {"count": 7, "tags": [], "bug_id": 32487, "attachment_id": null, "id": 67995, "time": "2004-12-06T21:45:41Z", "creator": "stevel@apache.org", "creation_time": "2004-12-06T21:45:41Z", "is_private": false, "text": "Note also that some filesystems you can mount on windows are *strongly* case\nsensitive, meaning you can have two files that differ only in case. Samba, NFS\nand Clearcase mounts spring to mind. "}, {"attachment_id": null, "tags": [], "creator": "cowwoc@bbs.darktech.org", "text": "Peter,\n\nI think one needs to differentiate between case-sensitive FSs and case-aware\nFSs. NTFS is case-aware in that it retains the original case whenever possible\n(although there is no guarantee that it won't get lost when various tools are\nused against a file) and certain tools such as \"java\" *chooses* to differentiate\nbetween \"test\" and \"Test\" but this is not a matter of java actually saying that\nthe two files differ. The Java specification simply states that the filename\ncasing must map to the class name casing, which is strictly case-sensitive, so\nthey choose to enforce that. Why? Because Java is strictly concerned with\nportability and Sun wants to ensure that if you transfer these files onto\nanother operating system they will be guaranteed to work out-of-the-box. The\nquestion we must then ask is, is there a analogous concern for Ant? ... I guess\nI will say, yes, there is.\n\nThough I wish to point out that I really only meant that drive-letters should be\nhandled in a case-insensitive manner and I don't think anyone here (Steve\nincluded) will argue that drive letters are ever case-sensitive under Windows. \n\nCan we agree to treat '/'-style slashes as equivilent to '\\'-style slashes under\nwin32 as well as case-insensitive drive letters in the path? I think that'll\nplease Samba, NFS and ClearCase as well.", "count": 8, "id": 68020, "time": "2004-12-07T03:54:38Z", "bug_id": 32487, "creation_time": "2004-12-07T03:54:38Z", "is_private": false}, {"count": 9, "tags": [], "creator": "peterreilly@apache.org", "attachment_id": null, "text": "<globmapper> and <regexpmapper> have been updated\nto have \"casesensitive\" (default true) and \"handledirchar\" (default false)\nattributes.\nIt was the consenses on ant-dev (well 2.5 votes to 0.5) that the handledirchar\nshould be explicitly turned on.\n\nThis will be in ant 1.6.3.", "id": 68654, "time": "2004-12-17T15:32:19Z", "bug_id": 32487, "creation_time": "2004-12-17T15:32:19Z", "is_private": false}, {"count": 10, "attachment_id": null, "creator": "cowwoc@bbs.darktech.org", "text": "Peter,\n\nWhat is the benefit of having to explicitly turn handledirchar on? What is the\ndanger of having it on by default?\n\nGili", "id": 68667, "time": "2004-12-17T18:23:07Z", "bug_id": 32487, "creation_time": "2004-12-17T18:23:07Z", "tags": [], "is_private": false}]