[{"count": 0, "tags": [], "bug_id": 18073, "attachment_id": null, "id": 33297, "time": "2003-03-17T16:53:35Z", "creator": "ronald-lists@klop.ws", "creation_time": "2003-03-17T16:53:35Z", "is_private": false, "text": "I'm using 4.1.23 and gzip is not working if I use compression=\"on\", but only if \ncompression=\"force\".\n\n\n\n\nI think it is in this piece of code:\n\n\nhttp11/src/java/org/apache/coyote/http11/Http11Processor.java:1130\n\n\n\n\nif ((contentLength == -1)\n\n\n        || (contentLength > compressionMinSize)) \n\n\n    // Check for compatible MIME-TYPE\n\n\n    if (compressableMimeTypes != null)\n\n\n        return (inStringArray(compressableMimeTypes,\n\n\n                        response.getContentType()));\n\n\n}\n\n\n\n\nI don't have the possibility to compile and test everything, but I think \nresponse.getContentType() returns \"text/html;charset=iso-8859-1\" and \ninStringArray compares this to \"text/html\" which returns false.\n\n\n\n\nAnd maybe bug 2820 can be closed if this works."}, {"count": 1, "tags": [], "creator": "ronald-lists@klop.ws", "attachment_id": 5385, "id": 33316, "time": "2003-03-18T00:53:46Z", "bug_id": 18073, "creation_time": "2003-03-18T00:53:46Z", "is_private": false, "text": "Created attachment 5385\nAdd method to extract the mime type from a content type. Everything before the first \";\"."}, {"count": 2, "attachment_id": 5386, "bug_id": 18073, "is_private": false, "id": 33317, "time": "2003-03-18T00:54:47Z", "creator": "ronald-lists@klop.ws", "creation_time": "2003-03-18T00:54:47Z", "tags": [], "text": "Created attachment 5386\nRemove the charset from the content type."}, {"count": 3, "attachment_id": null, "bug_id": 18073, "text": "I've added two (untested) simple patches which might solve this problem. Can somebody look at it and commit it (or not)?", "id": 33318, "time": "2003-03-18T00:56:58Z", "creator": "ronald-lists@klop.ws", "creation_time": "2003-03-18T00:56:58Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "text": "Created attachment 5489\nNew tested patch.", "attachment_id": 5489, "bug_id": 18073, "id": 33738, "time": "2003-03-25T10:49:04Z", "creator": "ronald-lists@klop.ws", "creation_time": "2003-03-25T10:49:04Z", "is_private": false}, {"count": 5, "tags": [], "creator": "ronald-lists@klop.ws", "attachment_id": 5491, "id": 33740, "time": "2003-03-25T10:49:19Z", "bug_id": 18073, "creation_time": "2003-03-25T10:49:19Z", "is_private": false, "text": "Created attachment 5491\nNew tested patch."}, {"count": 6, "tags": [], "bug_id": 18073, "text": "I made two new patches which replace the first two.\n\n\nThese are tested and known to be working.\n\n\nThese patches fix the handling of content-types for gzip compression.\n\n\nIs somebody willing to look at this and maybe commit it?\n", "id": 33742, "time": "2003-03-25T10:52:01Z", "creator": "ronald-lists@klop.ws", "creation_time": "2003-03-25T10:52:01Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 54194, "time": "2004-03-17T23:14:22Z", "bug_id": 18073, "creation_time": "2004-03-17T23:14:22Z", "is_private": false, "text": "Alternative patches have been applied (4.1.28 onwards) which should resolve \nthe issues you are seeing."}]