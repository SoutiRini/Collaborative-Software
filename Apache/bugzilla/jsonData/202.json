[{"count": 0, "attachment_id": null, "bug_id": 202, "is_private": false, "id": 180, "time": "2000-10-26T11:34:48Z", "creator": "dev@tomcat.apache.org", "creation_time": "2000-10-26T11:34:48Z", "tags": [], "text": "in src/share/org/apache/tomcat/request/StaticInterceptor.java, line apporx 354, we've got\r\n\r\n    public void doService(Request req, Response res)\r\n        throws Exception\r\n    {\r\n        // this is how ge...\r\n        // the next round of optimizations\r\n        Locale locale=RequestUtil.getLocale(req);\r\n        StringManager sm=StringManager.getManager(\"org.apache.tomcat.resources\",locale);\r\n        DateFormat dateFormat =\r\n            new SimpleDateFormat(datePattern,locale );\r\n            ...\r\nand later, at line around 488 (at the end of doService()) we've got\r\n                ...\r\n                buf.append(\"<td align=right><tt>\");\r\n                buf.append(dateFormat.format(new Date(f.lastModified())));\r\n                ...\r\nwhich resulted in the following exception \r\n\r\njava.io.IOException: Not an ISO 8859_1 character:?\r\n\tat java.lang.Throwable.(Throwable.java:96)\r\n\tat java.lang.Exception.(Exception.java:44)\r\n\tat java.io.IOException.(IOException.java:49)\r\n\tat org.apache.tomcat.core.BufferedServletOutputStream.print(BufferedServletOutputStream.java(Compiled Code))\r\n\tat org.apache.tomcat.request.DirHandler.doService(StaticInterceptor.java:538)\r\n\tat org.apache.tomcat.core.Handler.service(Handler.java:263)\r\n\tat org.apache.tomcat.core.ServletWrapper.service(ServletWrapper.java:371)\r\n\tat org.apache.tomcat.core.ContextManager.internalService(ContextManager.java:786)\r\n\tat org.apache.tomcat.core.ContextManager.service(ContextManager.java:732)\r\n\tat org.apache.tomcat.service.http.HttpConnectionHandler.processConnection(HttpConnectionHandler.java:210)\r\n\tat org.apache.tomcat.service.TcpWorkerThread.runIt(PoolTcpEndpoint.java:407)\r\n\tat org.apache.tomcat.util.ThreadPool$ControlRunnable.run(ThreadPool.java:498)\r\n\tat java.lang.Thread.run(Thread.java:498)\r\n\r\nwhen the request contains russina locale\r\n(don't pay too much attention to line numbers I've got 'em a little bit wrong cause to my modifications .. ;) \r\n\r\n\r\nIn short that is the line \r\n             ServletOutputStream out=res.getOutputStream();\r\n              out.print(buf.toString());\r\n\r\n\r\nI've also dumped the buf to a file (just for my pleasure), here it is:\r\n=============================================\r\njava.io.IOException: Not an ISO 8859_1 character:?                                                                                                                     \r\n<html>                                                      \r\n<head>                                                      <title>Directory Listing for:/</title>                                               </head><body bgcolor=white>                                              <table width=90% cellspacing=0 cellpadding=5 align=center><tr><td colspan=3><font size=+2><strong>Directory Listing for:/</strong></td></tr>                           \r\n<tr><td colspan=3 bgcolor=#cccccc><font size=+2><strong>Subdirectories:</strong>                    </font></td></tr>                                           <tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<tt><a href=\"/cocoonsamples\">cocoonsamples/</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>                                   \r\n</td><td><tt>&nbsp;&nbsp;</tt></td><td align=right><tt>??, 21 ??? 2000 00:39 GMT+04:00</tt></td></tr>                                    <tr><td colspan=3 bgcolor=#ffffff>&nbsp;</td></tr>                            <tr><td colspan=4 bgcolor=#cccccc><font size=+2><strong>Files:</strong></font></td></tr><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                            <tt><a href=\"/m.html\">m.html</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td>                                                 <td align=right><tt>0.0 KB</tt></td><td align=right><tt>??, 23 ??? 2000 15:04 GMT+04:00</tt></td></tr>                                    <tr><td colspan=3 bgcolor=#ffffff>&nbsp;</td></tr><tr><td colspan=3 bgcolor=#cccccc><font size=-1>Tomcat Web Server v3.2 beta 6\r\n</font></td></tr></table></body></html> \r\n\r\nHere we can see that some parts of the date got wrong...\r\n"}, {"count": 1, "attachment_id": null, "bug_id": 202, "is_private": false, "id": 2553, "time": "2001-05-20T14:43:41Z", "creator": "cmanolache@yahoo.com", "creation_time": "2001-05-20T14:43:41Z", "tags": [], "text": "Fixed in 3.3, the whole conversion mechansim had to be rewritten.\nCheck next nightly for more fixes ( url encoding, etc )"}]