[{"count": 0, "tags": [], "bug_id": 58368, "is_private": false, "text": "Reported by RV-Predict (a dynamic race detector) when running the test suite:\nData race on field org.apache.catalina.core.ApplicationFilterFactory.factory: {{{\n    Concurrent read in thread T27 (locks held: {Monitor@3bb9edae})\n ---->  at org.apache.catalina.core.ApplicationFilterFactory.getInstance(ApplicationFilterFactory.java:54)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:182)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:106)\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:502)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:142)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:88)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:518)\n        at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1091)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:673)\n        at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:277)\n        - locked Monitor@3bb9edae at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:259) \n        at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\n    T27 is created by T15\n        at java.util.concurrent.ThreadPoolExecutor.addWorker(ThreadPoolExecutor.java:1010)\n\n    Concurrent write in thread T28 (locks held: {Monitor@6d627e28})\n ---->  at org.apache.catalina.core.ApplicationFilterFactory.getInstance(ApplicationFilterFactory.java:55)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:182)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:106)\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:502)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:142)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:88)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:518)\n        at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1091)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:673)\n        at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:277)\n        - locked Monitor@6d627e28 at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:259) \n        at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\n    T28 is created by T15\n        at java.util.concurrent.ThreadPoolExecutor.addWorker(ThreadPoolExecutor.java:1010)\n}}}\n\nAnother non-thread-safe implementation of lazy initialization.", "id": 185125, "time": "2015-09-12T01:02:07Z", "creator": "yilong.li@runtimeverification.com", "creation_time": "2015-09-12T01:02:07Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "markt@apache.org", "text": "I've simplified the code in trunk but I'm not yet convinced that this race condition will trigger anything worse than the creation of multiple ApplicationFilterFactory instances where the additional instances will quickly become eligible for GC.", "id": 185189, "time": "2015-09-13T16:58:28Z", "bug_id": 58368, "creation_time": "2015-09-13T16:58:28Z", "is_private": false, "attachment_id": null}, {"count": 2, "attachment_id": null, "bug_id": 58368, "text": "I am now convinced that there is a rare/unlikely issue here. It has been fixed in 8.0.x for 8.0.27 onwards.", "id": 185206, "time": "2015-09-13T20:43:54Z", "creator": "markt@apache.org", "creation_time": "2015-09-13T20:43:54Z", "tags": [], "is_private": false}]