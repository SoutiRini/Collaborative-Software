[{"count": 0, "tags": [], "bug_id": 17377, "attachment_id": null, "id": 31923, "time": "2003-02-25T16:11:22Z", "creator": "brody@gebit.de", "creation_time": "2003-02-25T16:11:22Z", "is_private": false, "text": "Hi there,\nas I discovered by extending log4j patternlayout for integrating more \ninformation from an extended loggingevent, the format() method doesn't handle \nthe case of making long strings shorter correctly, e.g. if I have following log \nmessages:\na) log.debug(\"a debug info\");\nb) log.info(\"an info\");\n\nand\nuse the following pattern \"%3.3p\" I would expect the following output:\na) BUG\nb) NFO\n\nThis is delivered by the format() method, but less useful - I wanted to get the \nfirst three chars of the priority - so I would suggest to use \"%-3.3p\" (left \nalign is ON), but I get the same output as above.\n\nThe fix is as easy. Change the PatternConverter.format() method as follows:\n<   if(len > max)\n<     sbuf.append(s.substring(len-max));\n<   else if(len < min) {\n-- \n>   if(len > max)\n>     if (leftAlign) {\n>        sbuf.append(s.substring(0,max));\n>     } else {\n>        sbuf.append(s.substring(len-max));\n>     }\n>   else if(len < min) {"}, {"count": 1, "tags": [], "text": "I've applied your patch: thanks for noting and submitting it.  It'd be great if \nyou had a test case that went along with it...", "is_private": false, "bug_id": 17377, "id": 68497, "time": "2004-12-14T19:57:41Z", "creator": "yoavs@computer.org", "creation_time": "2004-12-14T19:57:41Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 17377, "attachment_id": null, "id": 68670, "time": "2004-12-17T20:55:07Z", "creator": "ceki@apache.org", "creation_time": "2004-12-17T20:55:07Z", "is_private": false, "text": "\nWolfgang,\n\nThis patch seems reasonable but it is actually flawed. The - flag means left \njustification. With your patch, it means left justification *and* truncation from \nthe right. Log4j uses left truncation for a reason. \n\nEven though your use case may be legitimate, its implementation is not. An \nadditional flag should be introduced for truncation from the right."}]