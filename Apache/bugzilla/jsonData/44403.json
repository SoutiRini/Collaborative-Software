[{"count": 0, "tags": [], "bug_id": 44403, "text": "Overview Description\n---------------------\nThe Excel function MID(text, start_num, num_chars) which has been implemented in\nPOI does not evaulate correctly.  It appears the function actually implements\nMID(text, start_num, *end_num*) instead.\n\nSteps to Reproduce\n------------------\n1/ Create a worksheet with the formula =MID(\"galactica\", 3, 4) in a cell\n2/ Notice in Excel, it evaulates to \"lact\" as expected\n3/ Parse the file evaulating cell formulas \n(i.e. using \nHSSFFormulaEvaluator.CellValue cellValue = evaluator.evaluate(cell);\nfor example)\n4/ Output will show \"la\" for the evaulated cell from 1/\n\nActual Results\n--------------\nAs stated, actual results are \"la\"\n\nExpected Results\n----------------\nAs stated, expected results are \"lact\", given the Excel function signature for\nMID is \"MID(text, start_num, num_chars)\" - Excel 2003\n\nBuild Date & Platform\n---------------------\n2008-02-07 on Windows XP\n\nAdditional Information\n----------------------\nIn ./src/scratchpad/src/org/apache/poi/hssf/record/formula/functions/Mid.java, I\nbelieve the following change needs to be made:\n\nline 93:\n\n   retval = new StringEval(str.substring(startNum - 1, numChars));\n\nshould be replaced with:\n\n  retval = new StringEval(str.substring(startNum - 1, (numChars + startNum - 1)));\n\nMuch thanks as always", "id": 113678, "time": "2008-02-13T00:40:18Z", "creator": "dave.webster@virginmedia.co.uk", "creation_time": "2008-02-13T00:40:18Z", "is_private": false, "attachment_id": null}, {"count": 1, "text": "Thanks for the patch, fixed in svn, and a test added", "creator": "apache@gagravarr.org", "is_private": false, "id": 113782, "time": "2008-02-15T03:45:18Z", "bug_id": 44403, "creation_time": "2008-02-15T03:45:18Z", "tags": [], "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 44403, "text": "Sorry to re-open this bug but while investigating I found many more problems \nwith MID().  I am attaching a patch which contains junit tests to show the \nbugs and the fix to MID.\n", "id": 113810, "time": "2008-02-15T17:53:42Z", "creator": "josh@apache.org", "creation_time": "2008-02-15T17:53:42Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "creator": "josh@apache.org", "attachment_id": 21541, "id": 113812, "time": "2008-02-15T17:55:24Z", "bug_id": 44403, "creation_time": "2008-02-15T17:55:24Z", "is_private": false, "text": "Created attachment 21541\nsvn diff of 2 modified files (Mid.java and a test suite)"}, {"count": 4, "tags": [], "creator": "josh@apache.org", "attachment_id": 21542, "is_private": false, "id": 113813, "time": "2008-02-15T17:56:22Z", "bug_id": 44403, "creation_time": "2008-02-15T17:56:22Z", "text": "Created attachment 21542\ntar bz2 of 3 added files (one test and two eval utility classes)"}, {"count": 5, "text": "Applied to svn trunk, thanks", "bug_id": 44403, "is_private": false, "id": 113922, "time": "2008-02-20T10:15:02Z", "creator": "apache@gagravarr.org", "creation_time": "2008-02-20T10:15:02Z", "tags": [], "attachment_id": null}]