[{"count": 0, "tags": [], "creator": "mkalen@apache.org", "text": "Attached patch will extend the JDBCStore configuration possibilities\nto allow setting of all (arbitrary in fact) Commons DBCP configuration\nproperties and to pass properties directly to the underlying JDBC-driver.\n\nThis patch addresses the following issues:\n\n\n 1. Cannot set (or control usage of) the DBCP connection validation query\n\n\n    After applying the patch, any DBCP properties like validationQuery,\n    testOnBorrow, testWhileIdle, can be set in the Slide domain configuration\n    with a \"dbcp.\" prefix.\n\n\n    Example nodestore config for Oracle:\n\n\n        <parameter name=\"dbcpPooling\">true</parameter>\n        <parameter name=\"dbcp.maxWait\">5000</parameter>\n        <parameter name=\"dbcp.maxActive\">50</parameter>\n        <parameter name=\"dbcp.maxIdle\">25</parameter>\n        <parameter name=\"dbcp.validationQuery\">SELECT 1 FROM DUAL</parameter>\n        <parameter name=\"dbcp.testOnBorrow\">true</parameter>\n        <parameter name=\"dbcp.testOnReturn\">false</parameter>\n        <parameter name=\"dbcp.testWhileIdle\">false</parameter>\n\n\n\n 2. Cannot pass properties to the JDBC-driver\n\n\n    (With MySQL it was previously possible, but not all drivers support\n    extending the JDBC URL with ?property=value. Oracle for one does not.)\n\n\n    After applying the patch, it is now possible to pass a list of JDBC-driver\n    properties from the Slide domain configuration through the\n    \"dbcp.connectionProperties\" setting. The format is semicolon separated,\n    eg \"defaultRowPrefetch=30;disableDefineColumnType=true\" for setting\n    Oracle row-prefetching to 30 rows per server rountrip and switching to\n    the Oracle-recommended default of disableDefineColumnType=true for\n    the Oracle 10 JDBC thin-driver.\n\n\n\n 3. Shutting down the Slide JDBCStore does not shutdown DBCP pool\n\n\n    After applying the patch, the DBCP pool will be decommisioned on\n    the disconnect() call on a clean Slide exit (it can be reconnected\n    by calling connect() and the isConnected semantics is updated\n    so that connectIfNeeded will call connect() if the pool is down).\n\n\n\n 4. Synchronization issue when using DBCP in multiple JDBCStore-\n    instances within a Domain\n\n\n    Naming the DBCP connection pool with System.identityHashCode is not\n    guaranteed to be unique withing the Domain.\n\n\n    After applying the patch, the JDBCStore will use the DBPC\n    BasicDataSource with a Store-local (protected instance var)\n    reference and it will be guaranteed that each Store instance\n    uses a unique DBCP DataSource/pool instance.", "id": 76063, "time": "2005-06-06T12:49:54Z", "bug_id": 35235, "creation_time": "2005-06-06T12:49:54Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "mkalen@apache.org", "text": "Created attachment 15312\nImproved usage of Commons DBCP\n\nImproved usage of Commons DBCP Connection-pooling in JDBCStore. Created against\nCVS HEAD rev1.23 of JDBCStore.java (Slide 2.2pre1).", "id": 76064, "time": "2005-06-06T12:51:58Z", "bug_id": 35235, "creation_time": "2005-06-06T12:51:58Z", "is_private": false, "attachment_id": 15312}, {"count": 2, "attachment_id": 15313, "bug_id": 35235, "is_private": false, "id": 76065, "time": "2005-06-06T13:12:39Z", "creator": "mkalen@apache.org", "creation_time": "2005-06-06T13:12:39Z", "tags": [], "text": "Created attachment 15313\nUpdated documentation with new DBCP configuration.\n\nUpdated documentation with new DBCP configuration. Use CDATA section in forrest\npage template to avoid having to escape all nodes in PRE-sections for\nconfiguration examples."}, {"count": 3, "tags": [], "bug_id": 35235, "attachment_id": 15314, "id": 76066, "time": "2005-06-06T13:18:42Z", "creator": "mkalen@apache.org", "creation_time": "2005-06-06T13:18:42Z", "is_private": false, "text": "Created attachment 15314\nUpdated 2.2 release notes for new DBCP features\n\nUpdated 2.2 release notes with new DBCP- and JDBC-configuration features."}, {"count": 4, "attachment_id": null, "bug_id": 35235, "is_private": false, "id": 76340, "time": "2005-06-13T14:56:32Z", "creator": "unico@apache.org", "creation_time": "2005-06-13T14:56:32Z", "tags": [], "text": "Thanks for the good-looking patch Martin. It's been applied."}]