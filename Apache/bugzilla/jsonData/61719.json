[{"count": 0, "tags": [], "creator": "94544458@qq.com", "attachment_id": null, "text": "With http2 enabled(h2 with https), after AsyncContext started,\n\nServletInputStream sis = request.getInputStream();\n  sis.setReadListener(this);  //this line throw exception\n\n\njava.lang.NullPointerException\n\tat org.apache.coyote.http2.Stream$StreamInputBuffer.registerReadInterest(Stream.java:920)\n\tat org.apache.coyote.http2.StreamProcessor.registerReadInterest(StreamProcessor.java:176)\n\tat org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:453)\n\tat org.apache.coyote.Request.action(Request.java:430)\n\tat org.apache.catalina.connector.InputBuffer.isReady(InputBuffer.java:287)\n\tat org.apache.catalina.connector.InputBuffer.setReadListener(InputBuffer.java:243)\n\tat org.apache.catalina.connector.CoyoteInputStream.setReadListener(CoyoteInputStream.java:207)\n\n\nIf the post data as query string, then no problem.\nbut if the post data as http request body, then I got the above exception.", "id": 201875, "time": "2017-11-03T14:28:19Z", "bug_id": 61719, "creation_time": "2017-11-03T14:28:19Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 61719, "attachment_id": null, "is_private": false, "id": 201876, "time": "2017-11-03T14:31:26Z", "creator": "94544458@qq.com", "creation_time": "2017-11-03T14:31:26Z", "text": "By the way,  the code is in a AsyncContextHandler\n\nServletInputStream sis = request.getInputStream();\n  sis.setReadListener(this);  //this line throw exception, this is the ACHandler\n\nany way, this will never be null, it has nothing to do with this. And it is easy to see in Stream.java."}, {"count": 2, "tags": [], "bug_id": 61719, "attachment_id": null, "id": 201879, "time": "2017-11-03T14:40:51Z", "creator": "remm@apache.org", "creation_time": "2017-11-03T14:40:51Z", "is_private": false, "text": "Fixed in 9.0.2. I don't know if there's a root cause that needs to be fixed."}, {"count": 3, "tags": [], "text": "By the way, If I remove\n\n        <UpgradeProtocol className=\"org.apache.coyote.http2.Http2Protocol\" />\n\nfrom the https connector then I will not got this NullPointerException.\n\nGood to know, you people have already fixed it. Great.", "is_private": false, "id": 201882, "creator": "94544458@qq.com", "time": "2017-11-03T15:12:28Z", "bug_id": 61719, "creation_time": "2017-11-03T15:12:28Z", "attachment_id": null}, {"count": 4, "tags": [], "creator": "94544458@qq.com", "attachment_id": null, "text": "9.0.1 is still in beta, where can I download the 9.0.2 in alpha or something?", "id": 201883, "time": "2017-11-03T15:15:34Z", "bug_id": 61719, "creation_time": "2017-11-03T15:15:34Z", "is_private": false}, {"count": 5, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "text": "The fix will be included in 9.0.2 and 8.5.24.", "id": 201884, "time": "2017-11-03T15:35:23Z", "bug_id": 61719, "creation_time": "2017-11-03T15:35:23Z", "is_private": false}]