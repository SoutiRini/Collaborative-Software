[{"count": 0, "tags": [], "bug_id": 2685, "attachment_id": null, "text": "When using substitution groups Xerces fails to move up the type hierarchy when \ntesting for type compatibility, proceeding only as far as the first type derived \nfrom.\n\nFor the sample XSD and related XML listed below, Xerces validates the XML \ncorrectly in the case where the substituted item's type is directly derived from \nthe type of the substitution group (DerivedItem's type = DerivedItem1). If the \nsubstitution item's type is not immediately derived from the substitution \ngroup's type (DerviedItem's type = DerivedItem2/3) validation fails with the \nerror:\n\nSchema error: Element DerivedItem has a type whose base is \nhttp://bug.test/,DerivedItem1; this basetype does not derive from the type  of \nthe element at the head of the substitution group.\n\n------------------------------------------\nExample files: BUGTEST.XSD and BUGTEST.XML\n------------------------------------------\nBUGTEST.XSD\n===========\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<schema xmlns=\"http://www.w3.org/2001/XMLSchema\" xmlns:bt=\"http://bug.test/\"  \ntargetNamespace=\"http://bug.test/\" elementFormDefault=\"qualified\" \nversion=\"2.05\">\n\n  <element name=\"bugtest\" type=\"bt:BugTestType\"/>\n  <element name=\"SubItem\" type=\"bt:SubItemType\"/>\n  <element name=\"DerivedItem\" type=\"bt:DerivedItem1\" \nsubstitutionGroup=\"bt:SubItem\"/>\n\n  <complexType name=\"SubItemType\">\n  </complexType>\n\n  <complexType name=\"DerivedItem1\">\n    <complexContent>\n      <restriction base=\"bt:SubItemType\">\n      </restriction>\n    </complexContent>\n  </complexType>\n\n  <complexType name=\"DerivedItem2\">\n    <complexContent>\n      <restriction base=\"bt:DerivedItem1\">\n      </restriction>\n    </complexContent>\n  </complexType>\n\n  <complexType name=\"DerivedItem3\">\n    <complexContent>\n      <restriction base=\"bt:DerivedItem2\">\n      </restriction>\n    </complexContent>\n  </complexType>\n\n  <complexType name=\"BugTestType\">\n    <sequence>\n      <element ref=\"bt:SubItem\"/>\n    </sequence>\n  </complexType>\n\n</schema>\n\nBUGTEST.XML\n===========\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<bugtest xmlns=\"http://bug.test/\" \nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" \nxsi:schemaLocation=\"http://bug.test/ BUGTEST.xsd\">\n  <DerivedItem/>\n</bugtest>", "id": 3832, "time": "2001-07-18T21:34:23Z", "creator": "James.Murty@cmis.csiro.au", "creation_time": "2001-07-18T21:34:23Z", "is_private": false}, {"count": 1, "tags": [], "creator": "sandygao@ca.ibm.com", "text": "Hi James. This bug was fixed some time ago. I tried your schema/instance files, \nand got no error. Grab the latest version from CVS, and it should work.", "id": 3843, "time": "2001-07-19T09:50:06Z", "bug_id": 2685, "creation_time": "2001-07-19T09:50:06Z", "is_private": false, "attachment_id": null}]