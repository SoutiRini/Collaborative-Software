[{"count": 0, "tags": [], "bug_id": 13703, "attachment_id": null, "id": 24650, "time": "2002-10-16T17:43:39Z", "creator": "cybersam@alum.rpi.edu", "creation_time": "2002-10-16T17:43:39Z", "is_private": false, "text": "I was trying to use the following ECMAScript with Batik 1.5 beta 4's Squiggle, \nbut I noticed some inconsistent behavior:\n\n========= START CODE =========\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.0//EN\" \"http://www.w3.org/TR/2001/REC-\nSVG-20010904/DTD/svg10.dtd\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" height=\"100%\" id=\"testSVG\">\n    <script type=\"text/ecmascript\"><![CDATA[\n    function TestObj()\n    {\n        this.root = document.documentElement;\n        this.abc = 123;\n        this.myFunc = function()\n        { alert(this.abc); }\n        this.root.addEventListener(\"click\", this.myFunc, false);\n    }\n    var obj = new TestObj();\n    ]]></script>\n    <rect width=\"100%\" height=\"100%\" fill=\"green\"/>\n    <rect x=\"45%\" y=\"45%\" width=\"10%\" height=\"10%\" onmouseover=\"obj.myFunc()\"/>\n</svg> \n ========= END CODE =========\n\nWhen addEventListener() is explicitly called to add the TestObj.myFunc method \nas an event listener, and myFunc gets called as the result of an event, \nthe \"instance variable\" this.abc is undefined.  However, if I add the same \nfunction as an event listener via an onmouseover attribute, that instance \nvariable is defined.  This inconsistent behavior exists Adobe's viewer as well.\n\nTo see the undefined variable behavior, click anywhere in the SVG window.  To \nsee the \"proper\" behavior, mouse over the black rectangle.\n\nIt seems to me the click behavior should be the same as the mouseover behavior.\n\nProbably, addEventListener() is treating its function argument as a simple \nfunction instaed of an object method."}, {"count": 1, "tags": [], "bug_id": 13703, "attachment_id": null, "id": 27028, "time": "2002-11-27T00:04:37Z", "creator": "cybersam@alum.rpi.edu", "creation_time": "2002-11-27T00:04:37Z", "is_private": false, "text": "I changed the Severity from Normal to Major, since:\n(1) Not all events have a corresponding \"onxxx\" attribute to use as a \nworkaround.  For instance none of the MutationEvents work properly.\n(2) If you are using the Java binding to the DOM, you would be forced to \nadd \"onxxx\" attributes (assuming they are even legal) to the appropriate \nelements, instead of calling addEventListener().  Even if this worked \nproperly, which I haven't verified, it would be very ugly and inefficient."}, {"count": 2, "tags": [], "bug_id": 13703, "attachment_id": null, "id": 39679, "time": "2003-06-30T16:09:52Z", "creator": "vincent.hardy@sun.com", "creation_time": "2003-06-30T16:09:52Z", "is_private": false, "text": "Modifying this to a non issue. To register an event listener, you need to pass\nan object which has a 'handleEvent' method. The modified code is:\n\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.0//EN\" \"http://www.w3.org/TR/2001/REC-\nSVG-20010904/DTD/svg10.dtd\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" height=\"100%\" id=\"testSVG\">\n    <script type=\"text/ecmascript\"><![CDATA[\n    function TestObj()\n    {\n        this.root = document.documentElement;\n        this.abc = 123;\n        this.handleEvent = function()\n        { alert(this.abc); }\n        this.root.addEventListener(\"click\", this, false);\n    }\n\n \n    var obj = new TestObj();\n    ]]></script>\n    <rect width=\"100%\" height=\"100%\" fill=\"green\"/>\n    <rect x=\"45%\" y=\"45%\" width=\"10%\" height=\"10%\" onmouseover2=\"obj.myFunc()\"/>\n</svg> \n"}]