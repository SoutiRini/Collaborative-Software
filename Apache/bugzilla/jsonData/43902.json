[{"count": 0, "tags": [], "bug_id": 43902, "attachment_id": null, "id": 110707, "time": "2007-11-19T04:14:07Z", "creator": "andreas.radauer@porsche.co.at", "creation_time": "2007-11-19T04:14:07Z", "is_private": false, "text": "The autoSizeColumn method does not consider merged regions:\n\nHSSFWorkbook wb = new HSSFWorkbook();\n\t    HSSFSheet sheet = wb.createSheet(\"new sheet\");\n\t    //add two rows with each a cell\n\t    HSSFRow row = sheet.createRow((short)0);\n\t    HSSFCell cell = row.createCell((short)0);\n\t    cell.setCellValue(new HSSFRichTextString(\"This is a Text\"));\n\t    HSSFRow row2 = sheet.createRow((short)1);\n\t    HSSFCell cell2 = row2.createCell((short)0);\n\t    cell2.setCellValue(new HSSFRichTextString(\"This is a very long \nlong long Text\"));\n\t    \n\t    //create a region over the 2nd row\n\t    sheet.addMergedRegion(new Region(1,(short)0,1,(short)1));\n\t    //auto size the Collumns\n\t    sheet.autoSizeColumn((short)0);\n\t    sheet.autoSizeColumn((short)1);\n\n\t    // Write the output to a file\n\t    FileOutputStream fileOut = new FileOutputStream(\"workbook.xls\");\n\t    wb.write(fileOut);\n\t    fileOut.close();\n\nIf you use the autoSizeColumn function in Excel (double click) on the collumn \nheading, the collumn has the size of the first line. If you use the \nauotSizeColumn method of HSSFSheet it has the size of the 2nd."}, {"count": 1, "tags": [], "bug_id": 43902, "attachment_id": null, "id": 110723, "time": "2007-11-19T06:07:58Z", "creator": "yegor@dinom.ru", "creation_time": "2007-11-19T06:07:58Z", "is_private": false, "text": "Thanks for the bug report. I will look into it. \nLooks like Excel does not autosize merged columns, i.e. merged columns should be\nskipped in the autoSizeColumn().  \n\nYegor"}, {"count": 2, "tags": [], "bug_id": 43902, "attachment_id": 21362, "id": 112672, "time": "2008-01-09T01:45:51Z", "creator": "paolo.moz@gmail.com", "creation_time": "2008-01-09T01:45:51Z", "is_private": false, "text": "Created attachment 21362\nThis patch resolves 43902 bug\n\nThe autoSizeColumn method has to ignore the rows that are part of a merged\nregion. This is the Excel behavior.\nthe next attached document has to be saved as:\nsrc/testcases/org/apache/poi/hssf/data/43902.xls"}, {"count": 3, "tags": [], "bug_id": 43902, "text": "Created attachment 21363\nAttached document for autoSizeColumn test\n\nsave this attachment as:\nsrc/testcases/org/apache/poi/hssf/data/43902.xls", "id": 112673, "time": "2008-01-09T01:47:33Z", "creator": "paolo.moz@gmail.com", "creation_time": "2008-01-09T01:47:33Z", "is_private": false, "attachment_id": 21363}, {"count": 4, "tags": [], "bug_id": 43902, "text": "Thanks for that patch Paolo, applied to svn", "id": 112674, "time": "2008-01-09T01:56:03Z", "creator": "apache@gagravarr.org", "creation_time": "2008-01-09T01:56:03Z", "is_private": false, "attachment_id": null}]