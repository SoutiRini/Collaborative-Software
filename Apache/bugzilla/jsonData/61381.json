[{"count": 0, "tags": [], "text": "Created attachment 35200\nExample\n\nZipHelper tries to be efficient when checking the header by reusing PushbackInputStreams that are given as input, but these streams may not hold the 8 bytes that are pushed back, and can cause an exception.\n\nTestable example is attached.\n\nWorkaround: Wrap InputStreams in BufferedInputStream before passing them to anything that uses ZipHelper.\n\nSolutions:\n- always create a new PushbackInputStream\n- stop using PushbackInputStream and switch to mark/reset + BufferedInputStream", "attachment_id": 35200, "id": 200186, "creator": "ket1999@gmail.com", "time": "2017-08-04T01:55:33Z", "bug_id": 61381, "creation_time": "2017-08-04T01:55:33Z", "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 61381, "is_private": false, "id": 200207, "time": "2017-08-06T17:20:16Z", "creator": "kiwiwings@apache.org", "creation_time": "2017-08-06T17:20:16Z", "tags": [], "text": "Thanks for pointing this out.\n\nI'm currently replacing the PushbackInputStream calls (option 2) and refactor the file magic checks in one spot."}, {"count": 2, "tags": [], "creator": "kiwiwings@apache.org", "is_private": false, "text": "patched via r1804854", "id": 200276, "time": "2017-08-11T20:49:23Z", "bug_id": 61381, "creation_time": "2017-08-11T20:49:23Z", "attachment_id": null}]