[{"count": 0, "text": "I'm trying to write an application that works whether a session is present or not.  I want to handle \nthe case when the target browser doen't support cookies, so I am using \n\"response.encodeURL(String url)\".  But, I have discovered that this statement creates a \nsession if one is not already present.  In my opinion, this is not how this method should work.  I've \ntraced this probem to line 1033 of HttpResponseBase.java which reads:\n\n\"return \n(toEncoded(url, hreq.getSession().getId()));\"\n\nI think this line should be changed \nto:\n\n\"return (toEncoded(url, hreq.getRequestedSessionId()));\"\n\nThe method \n\"hreq.getRequestedSessionId()\" will return null if a session doesn't exist, and the method \n\"toEncoded(String url, String sessionId)\" (line 736 of HttpResponseBase.java) will work \ncorrectly if it is passed a null session ID.\n\nThis same problem exists in the method \n\"encodeRedirectURL(String url)\" (line 1000 of HttpResponseBase.java)", "creator": "jasonheath9@yahoo.com", "attachment_id": null, "id": 32592, "time": "2003-03-06T20:06:11Z", "bug_id": 17740, "creation_time": "2003-03-06T20:06:11Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "jasonheath9@yahoo.com", "attachment_id": null, "is_private": false, "id": 32595, "time": "2003-03-06T20:42:16Z", "bug_id": 17740, "creation_time": "2003-03-06T20:42:16Z", "text": "I just realized that \"HttpServletRequest.getRequestedSessionId()\" will return null after a \nsession is first created.  This is a problem for the solution I presented.  One way to avoid this \nproblem would be to add the follwoing code after line 1187 of HttpRequestBase.java (in the method \ndoGetSession):\n\n\"requestedSessionId = session.getId();\"\n\nI'm not sure if this will \ncause other things to break though."}, {"count": 2, "tags": [], "creator": "remm@apache.org", "attachment_id": null, "is_private": false, "id": 36056, "time": "2003-04-25T08:58:11Z", "bug_id": 17740, "creation_time": "2003-04-25T08:58:11Z", "text": "This code is deprecated. Calling encodeURL should not create a session if one\ndoes not exist already (I check in the code, getSession(false) is being used)."}]