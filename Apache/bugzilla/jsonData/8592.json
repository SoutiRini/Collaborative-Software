[{"count": 0, "tags": [], "creator": "poi-support@buni.org", "attachment_id": null, "is_private": false, "id": 14923, "time": "2002-04-27T22:17:13Z", "bug_id": 8592, "creation_time": "2002-04-27T22:17:13Z", "text": "In the event more than 3 rows contain formuls the following exception occurs:\n\nThere was 1 error:\n1) testAddIntegers(org.apache.poi.hssf.usermodel.TestFormulas)\njava.lang.ArrayIndexOutOfBoundsException\n        at org.apache.poi.util.LittleEndian.putNumber(LittleEndian.java:536)\n        at org.apache.poi.util.LittleEndian.putShort(LittleEndian.java:243)\n        at\norg.apache.poi.hssf.record.SelectionRecord.serialize(SelectionRecord.java:262)\n        at org.apache.poi.hssf.model.Sheet.serialize(Sheet.java:584)\n        at\norg.apache.poi.hssf.usermodel.HSSFWorkbook.getBytes(HSSFWorkbook.java:522)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.write(HSSFWorkbook.java:474)\n        at\norg.apache.poi.hssf.usermodel.TestFormulas.testAddIntegers(TestFormulas.java:130)\n        at org.apache.poi.hssf.usermodel.TestFormulas.main(TestFormulas.java:157)"}, {"count": 1, "tags": [], "bug_id": 8592, "is_private": false, "text": "*** Bug 8593 has been marked as a duplicate of this bug. ***", "id": 14931, "time": "2002-04-28T00:42:14Z", "creator": "poi-support@buni.org", "creation_time": "2002-04-28T00:42:14Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "creator": "poi-support@buni.org", "text": "Turned out that formulas only worked by cooincidence.  There was a horrid\nmismatch between Formula Records and Value Records aggregate.  Basically we\ncouldn't handle records whose size changed later.  Calculating it earlier was\nmore efficient but later lets us handle this.  At some point this should be\nrevisited for optimization.  If some manner of lightweight notification could be\nperformed then we could calculate size early and only update the deltas.  Might\nnot be worth it for most sheets.  (Then again...it might)  Another approach\nmight make a collection of only VariableSizeCellRecords (of which there are\nfewer on average) and only calculate them at the end.  Regardless this works now.", "count": 2, "id": 14932, "time": "2002-04-28T00:48:25Z", "bug_id": 8592, "creation_time": "2002-04-28T00:48:25Z", "is_private": false}]