[{"attachment_id": null, "tags": [], "bug_id": 50503, "is_private": false, "count": 0, "id": 142874, "time": "2010-12-21T01:42:21Z", "creator": "kfujino@apache.org", "creation_time": "2010-12-21T01:42:21Z", "text": "In Engine level clustering, the name of the cluster manager is  \"HostName#contextName\". \nSimpleTcpCluster#getManagerName(String, Manager) is as follows. \n====\npublic String getManagerName(String name, Manager manager) {\n    String clusterName = name ;\n    if ( clusterName == null ) clusterName = manager.getContainer().getName();\n    if(getContainer() instanceof Engine) {\n        Container context = manager.getContainer() ;\n        if(context != null && context instanceof Context) {\n            Container host = ((Context)context).getParent();\n            if(host != null && host instanceof Host && clusterName!=null && !(clusterName.indexOf(\"#\")>=0))\n                clusterName = host.getName() +\"#\" + clusterName ;\n        }\n    }\n    return clusterName;\n}\n====\n\nIn this method, clusterName.indexOf(\"#\") >= 0 is checked. \n\nBecause the context name becomes contextName##version if the web application has a version, \nthe name of the cluster manager doesn't become a format of \"HostName#contextName\". \nAs a result, Engine level Clustering doesn't work correctly. \n\nBest regards."}, {"count": 1, "tags": [], "bug_id": 50503, "attachment_id": 26431, "text": "Created attachment 26431\nI made a patch.\n\nI changed \"clusterName.indexOf(\"#\") >= 0\" into \"clusterName.startsWith(host.getName() +\"#\")\".", "id": 142875, "time": "2010-12-21T01:44:09Z", "creator": "kfujino@apache.org", "creation_time": "2010-12-21T01:44:09Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 50503, "attachment_id": null, "id": 142877, "time": "2010-12-21T01:58:22Z", "creator": "kfujino@apache.org", "creation_time": "2010-12-21T01:58:22Z", "is_private": false, "text": "Fixed in 7.0.x and will be in 7.0.6 onwards."}]