[{"count": 0, "tags": [], "creator": "raghavendra064@gmail.com", "attachment_id": null, "id": 185736, "time": "2015-10-12T17:36:09Z", "bug_id": 58495, "creation_time": "2015-10-12T17:36:09Z", "is_private": false, "text": "Sheetname:\"Test Suite\" \n\ntest case\t   Description\t                                   Runmode\nLogin\t        http://newtours.demoaut.com/ - login\t              Y\nBook a flight\tBook a flight without changing any options.\t      Y\nLogout\t        Logout successfully\t                              N\n\n\nLogin test executed successfully because total rowcount returned=4 and the current row id=1. Before executing Book a flight,  the current row id=2 but rowcount returned=0. As a result, execution stops. \n\nPOI code:\n\npublic class ExcelReader \n{\npublic String path;\npublic FileInputStream fis;\npublic FileOutputStream fos;\nstatic XSSFWorkbook workbook;\nstatic XSSFSheet sheet;\nstatic XSSFRow row;\nstatic XSSFCell cell;\nint col_num=0;\nint index=0;\n\npublic ExcelReader(String path)\n{\n\tthis.path=path;\n    try\n    {\n    fis = new FileInputStream(path);\n    workbook = new XSSFWorkbook(fis);\n    fis.close();\n    }\n    catch(Exception e)\n    {\n    \tSystem.out.println(\"File not found\");\n    }\n}\npublic int getRowCount(String sheetname)\n{\n\tindex = workbook.getSheetIndex(sheetname);\n\tif(index==-1)\n\treturn 0;\n\telse\n\tsheet = workbook.getSheetAt(index);\n\tint rownum=sheet.getPhysicalNumberOfRows();\n\treturn rownum;\n}\n}\n\nEven though the same sheetname is passed to getrowcount method after executing 'login' test, the rowcount returned is zero because the index is set to -1. \n\n        Integer suitetestID = new Integer(2);\n\tInteger casetestid = new Integer(2);\n\tInteger steptestid = new Integer(2);\n\tInteger datatestid = new Integer(2);\n\t\n\t\npublic SuiteDriver() throws Exception\n{\n       read = new ExcelReader(\"C:\\\\Learning_Framework\\\\xls\\\\testsuite.xlsx\");\n}\n\npublic void suite1() \n{\t\n\ntry\n{\t\nwhile(suitetestID.intValue()<=read.getrowcount(Constants.test_suite_sheet))\n{\ntid=suitetestID;\nSystem.out.println(\"Number of rows in suite(before)\"+read.getrowcount(\"Test Suite\");\n\nsuite_runmode = read.getcelldata(Constants.test_suite_sheet, tid,Constants.runmode);\n\t\nif(suite_runmode.equals(Constants.runmode_yes))\n{\n\nsuitetestID++;\n\n//Stores the test name\ntestcase=read.getcelldata(Constants.test_suite_sheet,tid, Constants.test_suite_sheet_test_case_col);\n\nSystem.out.println(\"Suite T/F \"+\" \"+(suitetestID<=read.getrowcount(\"Test Suite\")));\n//Here, the output is 4\n\ntestcaseDriver(testcase); -->Passes login String to another method to perform login actions.\n\nSystem.out.println(\"Number of rows in suite(after)\"+read.getrowcount(Constants.test_suite_sheet));\n//Here, the output is 0\n\n}\n}"}, {"count": 1, "tags": [], "bug_id": 58495, "text": "Please note, \n\nSystem.out.println(\"Number of rows in suite(after)\"+read.getrowcount(Constants.test_suite_sheet));\n//Here, the output is 0\n\nIn the above mentioned statement, Constants is a class and test_suite_sheet is a static String which is initialized as \"Test Suite\".", "id": 185737, "attachment_id": null, "creator": "raghavendra064@gmail.com", "creation_time": "2015-10-12T17:39:00Z", "time": "2015-10-12T17:39:00Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 58495, "text": "Any chance you could turn this into a small junit test that shows the problem, and upload the spreadsheet needed to trigger it? As it stands, it's a little hard to follow what the problem is\n\nAlso, make sure you've read the Sheet javadocs, eg the note on https://poi.apache.org/apidocs/org/apache/poi/ss/usermodel/Sheet.html#getPhysicalNumberOfRows%28%29", "id": 185738, "time": "2015-10-12T17:43:39Z", "creator": "apache@gagravarr.org", "creation_time": "2015-10-12T17:43:39Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 58495, "text": "Can you please attach the file that is demonstrating the problem and reduce your code to the bare minimum needed to reproduce the problem?\n\nAlso, can you fix your code so that it compiles? Is getrowcount different from getRowCount?\n\nI'm guessing the problem is in your code:\nif (index==-1)\n  return 0;\n\nMake sure the sheet name you pass in is identical", "id": 185739, "attachment_id": null, "creator": "onealj@apache.org", "creation_time": "2015-10-12T17:48:44Z", "time": "2015-10-12T17:48:44Z", "is_private": false}, {"count": 4, "tags": [], "creator": "raghavendra064@gmail.com", "attachment_id": null, "id": 185740, "time": "2015-10-12T18:35:48Z", "bug_id": 58495, "creation_time": "2015-10-12T18:35:48Z", "is_private": false, "text": "Please have a look at the first comment written by me for more clarity. Sorry for changing the method name as getRowCount while pasting the code here.It is actually still getrowcount in my code. And also, 0 is returned even if getLastRowNum() is used instead of getPhysicalNumberOfRows()."}, {"count": 5, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "id": 186117, "time": "2015-10-30T17:38:37Z", "bug_id": 58495, "creation_time": "2015-10-30T17:38:37Z", "is_private": false, "text": "Hm, it's very hard to see what happens with all the code-pieces that are not included in your code-extract. \n\nSo unless you can provide a more self-contained example about your problem I fear we cannot do much, therefore I am closing this as WORKSFORME for now, please reopen if you can provide test-code which runs without all your specific things that prevent us from reproducing the problem."}]