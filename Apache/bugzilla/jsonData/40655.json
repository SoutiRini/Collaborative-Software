[{"count": 0, "tags": [], "bug_id": 40655, "attachment_id": null, "text": "Overview Description: \nIf the user has set an output file on a user agent, but the file doesn't include\nan extension, a StringIndexOutOfBoundsException is thrown when the PNGRenderer\nattempts to deduce the \"file prefix\" to be used for the various pages, causing\nthe rendering attempt to fail unexpectedly.\n\nThe attached patch will allow a file name missing an extension to be used in its\nentirety as the prefix for pages being rendered.\n\n\nSteps to Reproduce: \n\n1) Create a FOPFactory object.\n     FopFactory fopFactory = FopFactory.newInstance();\n\n2) Create an FOUserAgent object.\n     org.apache.fop.apps.FOUserAgent agent = fopFactory.newFOUserAgent();\n\n3) Set the \"output file\" for the agent, making sure that the file name does not\ninclude an extension.\n     agent.setOutputFile( new java.io.File( \"/var/tmp/ProjectSummaryReport\" ) );\n\n4) Create a Fop object, using the configured agent, and targeting PNG as the\noutput format.\n     Fop fop = fopFactory.newFop( org.apache.fop.apps.MimeConstants.MIME_PNG, out );\n\n5) Use the Fop object to try to render an FO document.\n\nActual Results: \n\nA StringIndexOutOfBoundsException is thrown when the PNGRenderer attempts to\ndeduce the \"file prefix\" to be used for the various pages, causing the rendering\nattempt to fail unexpectedly.\n\nExpected Results:\n\nEither the renderer should accept the file name (e.g., \"ProjectSummaryReport\")\nas the full prefix, or else it should throw an exception (probably IOException,\ngiven the context) to indicate that an inappropriate output file has been\nspecified.  \n\n\nBuild Date & Platform: \n\nSubversion repository version 451762, on Mac OS X 10.4.7.  (29Sep06)\n\nAdditional Builds and Platforms: \n\nIssue also occurs under Solaris and Windows, and should presumably arise\nanywhere this is attempted.\n\n\nAdditional information:\n\nThis isn't likely to be an issue under many circumstances, since users will\nfrequently specify the file name using an extension (e.g.,\n\"/Volumes/Stuff/ProjectReport.png\"), but if the user is accustomed to working on\nan OS that doesn't place as high a premium on file extensions (e.g., OS X) and\nis using an existing file as the basis for the output being generated by the\nrenderer, this problem could come up. \n\nDuring discussion on the mailing list, Andreas Delmelle suggested that the\nrenderer should probably not accept alternate extensions (i.e., other than\n\".png\").  This changes is also included in the attached patch.", "id": 94375, "time": "2006-10-02T08:37:38Z", "creator": "mjh@cs.rit.edu", "creation_time": "2006-10-02T08:37:38Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 40655, "attachment_id": 18951, "is_private": false, "id": 94376, "time": "2006-10-02T08:38:48Z", "creator": "mjh@cs.rit.edu", "creation_time": "2006-10-02T08:38:48Z", "text": "Created attachment 18951\nPatch for PNGRenderer, adding handling of files without extensions"}, {"count": 2, "tags": [], "creator": "spepping@apache.org", "text": "Patch applied in revision 454331. Thanks.", "id": 94650, "time": "2006-10-09T03:34:56Z", "bug_id": 40655, "creation_time": "2006-10-09T03:34:56Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 40655, "attachment_id": null, "text": "batch transition pre-FOP1.0 resolved+fixed bugs to closed+fixed", "id": 155756, "time": "2012-04-01T06:39:22Z", "creator": "gadams@apache.org", "creation_time": "2012-04-01T06:39:22Z", "is_private": false}]