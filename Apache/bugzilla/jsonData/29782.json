[{"count": 0, "tags": [], "bug_id": 29782, "text": "Excel has a nifty feature called \"validation\" whereby it allows you to specify \na list of possible values for a column and it will use the list to populate a \ndrop-down list when a cell that uses that format has been highlighted (i.e. \ncursor is on it).  There is an incompatibility between the latest version of \nPOI/HSSFS and this feature.  It fails every-time without fail.  Here are the \nexact steps to reproduce:\n\n1. Create a spreadsheet using the validation feature I spoke about (or use the \none that have/will uploaded to the bug).\n\n2. Position your cursor overtop of the validation cell (highligh it) so as to \ncause the selector to appear.\n\n3. SAVE the workbook! Its important to save the workbook with the cursor \novertop of this cell.\n\n4. Now read the workbook with POI/HSSF.  You will see a stacktrace comparable \nto the following:\n\njava.lang.reflect.InvocationTargetException\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance\n(NativeConstructorAccessorImpl.java:39)\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance\n(DelegatingConstructorAccessorImpl.java:27)\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:274)\n        at org.apache.poi.hssf.record.RecordFactory.createRecord\n(RecordFactory.java:224)\n        at org.apache.poi.hssf.record.RecordFactory.createRecords\n(RecordFactory.java:160)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:165)\n        at org.apache.poi.hssf.usermodel.HSSFWorkbook.<init>\n(HSSFWorkbook.java:132)\n        at \ncom.dorado.app.ppe.service.client.shell.lib.excel.PMExcelToDif.getBook\n(PMExcelToDif.java:406)\n        at \ncom.dorado.app.ppe.service.client.shell.lib.excel.PMExcelToDif.parseBook\n(PMExcelToDif.java:93)\n        at com.dorado.app.ppe.service.client.shell.lib.excel.PMExcelToDif.main\n(PMExcelToDif.java:429)\n        at com.dorado.app.ppe.service.client.shell.PMShell.main(PMShell.java:79)\nCaused by: java.lang.ArrayIndexOutOfBoundsException\n        at java.lang.System.arraycopy(Native Method)\n        at org.apache.poi.hssf.record.UnknownRecord.<init>\n(UnknownRecord.java:62)\n        at org.apache.poi.hssf.record.SubRecord.createSubRecord\n(SubRecord.java:57)\n        at org.apache.poi.hssf.record.ObjRecord.fillFields(ObjRecord.java:99)\n        at org.apache.poi.hssf.record.Record.fillFields(Record.java:90)\n        at org.apache.poi.hssf.record.Record.<init>(Record.java:55)\n        at org.apache.poi.hssf.record.ObjRecord.<init>(ObjRecord.java:61)\n        ... 16 more\ncom.dorado.app.ppe.service.client.shell.lib.excel.WorkbookNotFoundException: \nFatal: Workbook \"C:\\dummy.xls\" not found or invalid.\n        at \ncom.dorado.app.ppe.service.client.shell.lib.excel.PMExcelToDif.getBook\n(PMExcelToDif.java:411)\n        \n...\netc.", "id": 59831, "time": "2004-06-24T08:20:29Z", "creator": "dave@esmond.com", "creation_time": "2004-06-24T08:20:29Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "text": "Created attachment 11940\nsample spreadsheet that crashes POI/HSSF", "is_private": false, "id": 59832, "creation_time": "2004-06-24T08:22:39Z", "time": "2004-06-24T08:22:39Z", "creator": "dave@esmond.com", "bug_id": 29782, "attachment_id": 11940}, {"attachment_id": null, "tags": [], "bug_id": 29782, "is_private": false, "count": 2, "id": 77814, "time": "2005-07-29T04:49:57Z", "creator": "jheight@apache.org", "creation_time": "2005-07-29T04:49:57Z", "text": "Works for me with latest CVS version.\n\nJason\n"}, {"count": 3, "tags": [], "creator": "rob.cash@nortel.com", "is_private": false, "text": "(In reply to comment #2)\n> Works for me with latest CVS version.\n> \n> Jason\n> \n\nSince the latest binary distribution (2.5.1-final) DOES have the problem, is\nthere a patch that can be applied to fix this problem? It's been a while since\nthere was an official release...\n\nRob\n", "id": 93173, "time": "2006-09-07T21:13:30Z", "bug_id": 29782, "creation_time": "2006-09-07T21:13:30Z", "attachment_id": null}]