[{"count": 0, "tags": [], "bug_id": 55995, "is_private": false, "text": "Null pointer exception when running JSPC from a Shell Script.\n\nJspCServletContext.java:344\n    /**\n     * Return a URL object of a resource that is mapped to the\n     * specified context-relative path.\n     *\n     * @param path Context-relative path of the desired resource\n     *\n     * @exception MalformedURLException if the resource path is\n     *  not properly formed\n     */\n    @Override\n    public URL getResource(String path) throws MalformedURLException {\n\n        if (!path.startsWith(\"/\"))\n            throw new MalformedURLException(\"Path '\" + path +\n                                            \"' does not start with '/'\");\n\nTldCache.java:124\n\n    private long[] getLastModified(TldResourcePath tldResourcePath) {\n        long[] result = new long[2];\n        result[0] = -1;\n        result[1] = -1;\n        try {\n            URL url = servletContext.getResource(tldResourcePath.getWebappPath());\n\n\n/usr/java/jdk1.7.0_45/bin/java -classpath :/home/tomcat/apache-tomcat-8.0.0-RC10/lib/catalina-storeconfig.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-websocket.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-i18n-es.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/catalina-tribes.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/catalina-ha.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-i18n-ja.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/jsp-api.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-util.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-jni.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/jasper.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/websocket-api.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/ecj-4.3.1.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-i18n-fr.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-api.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-coyote.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/servlet-api.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/jasper-el.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/catalina.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-dbcp.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-jdbc.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/annotations-api.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-util-scan.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/catalina-ant.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/el-api.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-spdy.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/bin/tomcat-juli.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/bin/bootstrap.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/bin/commons-daemon.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/webapps/examples/WEB-INF/lib/jstl.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/webapps/examples/WEB-INF/lib/standard.jar:/home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/lib/ant-1.6.5.jar org.apache.jasper.JspC \t-d /home/java/source/HEAD/work/tomcat80 \t-v \t-l \t-uriroot /home/java/source/HEAD/work/jsp_compile_shared /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/dialog/qbAxesDlg.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/dialog/qbManualGecodingDlg.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/fmtdlg.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/index.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/joindlg.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/producer.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/simplefilter.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/selectvaluedlg.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/binddowsTestView.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/variableeditordlg.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/filterprompteditor.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/ajax_response.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/fontdlg.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/join_fields.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/tree_component.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/waiting_banner.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/folderblock/BID_FolderBlockInit.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/folderblock/BID_FolderBlockBoot.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/BID_EmptyContent.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/xml/BID_UrlProperties.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/xml/BID_IBFSpathToHrefs.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/xml/BID_xmlresponse.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/xml/BID_statusResponse.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/favorites/BID_favorites_tree.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/favorites/BID_FavoritesBlockBoot.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/favorites/BID_FavoritesBlockInit.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/favorites/BID_favorites_tree_boot.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/favorites/BID_listToXML.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/index.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_InternalPage.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_SearchTree_Boot.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_SATree_Boot.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_BiFrame.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_initView.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_ShowToolbar.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_ExternalPage.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_SATreeBiFrame.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_initBindows.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_SearchTreeBiFrame.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/recents/BID_recents_tree_boot.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/recents/BID_recents_tree.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/recents/BID_listToXML.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/error.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/groups/BID_listToXML.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/search/BID_searchListToXML.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/search/BID_listToXML.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/tree/BID_MrPropertiesToXML.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/tree/BID_flatListToXML.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/tree/BID_PlainText.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/tree/BID_listToXML.jsp\t  2>&1\n\t\n\t\nException in thread \"main\" java.lang.NullPointerException\n\tat org.apache.jasper.servlet.JspCServletContext.getResource(JspCServletContext.java:344)\n\tat org.apache.jasper.compiler.TldCache.getLastModified(TldCache.java:124)\n\tat org.apache.jasper.compiler.TldCache.<init>(TldCache.java:70)\n\tat org.apache.jasper.JspC.initServletContext(JspC.java:1468)\n\tat org.apache.jasper.JspC.execute(JspC.java:1321)\n\tat org.apache.jasper.JspC.main(JspC.java:269)", "id": 172320, "time": "2014-01-13T05:55:30Z", "creator": "peter_lenahan@ibi.com", "creation_time": "2014-01-13T05:55:30Z", "attachment_id": null}, {"count": 1, "tags": [], "creator": "markt@apache.org", "text": "I can't reproduce this with the latest 8.0.x source. Neither do I see anything in the change history since RC10 that looks like it would have fixed this.\n\nWithout the JSP source it is hard to see what might be triggering this. Please provide the simplest possible JSP that demonstrates this issue along with any additional files (tags etc) that may be required to reproduce it.", "id": 172341, "time": "2014-01-13T17:48:43Z", "bug_id": 55995, "creation_time": "2014-01-13T17:48:43Z", "is_private": false, "attachment_id": null}, {"count": 2, "attachment_id": null, "creator": "markt@apache.org", "text": "Drop severity to a realistic level. It isn't functionality used by most users and in at least some cases JspC still works.", "id": 172342, "time": "2014-01-13T17:50:28Z", "bug_id": 55995, "creation_time": "2014-01-13T17:50:28Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "text": "Created attachment 31203\njspc_55995_test.bat\n\nI can reproduce this NPE with 8.0-RC10 and with trunk.\n\nSee the attached Windows batch file. Essentially, it uses Tomcat's bin/cpappend.bat to reproduce classpath from Comment 0. That is\n\n1. ant.jar\n2. all jars from %CATALINA_HOME%\\bin and %CATALINA_HOME%\\lib\n3. libs from the examples webapp (the JSTL jars)\n\nThen it tries to compile examples\\jsp\\tagplugin\\choose.jsp.\nThis results in the same NullPointerException, as reported by OP.\n\nException in thread \"main\" java.lang.NullPointerException\n        at org.apache.jasper.servlet.JspCServletContext.getResource(JspCServletContext.java:344)\n        at org.apache.jasper.compiler.TldCache.getLastModified(TldCache.java:124)\n        at org.apache.jasper.compiler.TldCache.<init>(TldCache.java:70)\n        at org.apache.jasper.JspC.initServletContext(JspC.java:1468)\n        at org.apache.jasper.JspC.execute(JspC.java:1321)\n        at org.apache.jasper.JspC.main(JspC.java:269)\n\n4. If I comment-out the line that adds JSTL jars to the classpath,\nJspC completes successfully and generates Java source text for the page.\nNote, that the JSTL tag library in the WEB-INF/lib directory of the web application is successfully recognized and processed by JspC.", "is_private": false, "bug_id": 55995, "id": 172348, "time": "2014-01-13T22:39:03Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2014-01-13T22:39:03Z", "attachment_id": 31203}, {"count": 4, "tags": [], "bug_id": 55995, "is_private": false, "id": 172357, "creation_time": "2014-01-14T12:05:30Z", "time": "2014-01-14T12:05:30Z", "creator": "markt@apache.org", "text": "Thanks for the test case. The bit I was missing as explicitly putting the JARs containing TLDs on the class path.\n\nThis has been fixed in 8.0.x and will be included in 8.0.0 onwards.", "attachment_id": null}, {"count": 5, "tags": [], "creator": "peter_lenahan@ibi.com", "is_private": false, "text": "Konstantin, Mark,\n\nThank you both for reproducing the problem in a better way and fixing it so fast.\n\nPeter", "id": 172365, "time": "2014-01-14T14:49:02Z", "bug_id": 55995, "creation_time": "2014-01-14T14:49:02Z", "attachment_id": null}]