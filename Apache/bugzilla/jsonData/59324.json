[{"count": 0, "tags": [], "bug_id": 59324, "is_private": false, "text": "Created attachment 33762\nSample document to reproduce the issue\n\nWhen processing a Word Document with 'Track Changes' enabled, when trying to get a list within a table, we get the following exception.\nSample file is attached and code is as follows\n\nCODE:\n\nimport org.apache.poi.hwpf.HWPFDocument;\nimport org.apache.poi.hwpf.HWPFDocumentCore;\nimport org.apache.poi.hwpf.converter.WordToHtmlConverter;\nimport org.apache.poi.hwpf.usermodel.HWPFList;\nimport org.apache.poi.hwpf.usermodel.Paragraph;\nimport org.w3c.dom.Document;\nimport org.w3c.dom.Element;\n\nimport javax.xml.parsers.DocumentBuilderFactory;\nimport java.io.File;\nimport java.io.FileInputStream;\n\npublic class PoiIssues {\n\n    public static void main(String[] args) throws Exception {\n        File file = new File(\"C:\\\\word-doc-revised-with-row-removed.doc\");\n        FileInputStream fileInputStream = new FileInputStream(file);\n        Document document = DocumentBuilderFactory.newInstance().newDocumentBuilder().newDocument();\n        WordToHtmlConverter wordToHtmlConverter = new MyWordToHtmlConverter(document);\n        HWPFDocumentCore hwpfDocumentCore = new HWPFDocument(HWPFDocumentCore.verifyAndBuildPOIFS(fileInputStream));\n        wordToHtmlConverter.processDocument(hwpfDocumentCore);\n        System.out.println(document.toString());\n        System.out.println(\"Process Complete\");\n    }\n\n    public static class MyWordToHtmlConverter extends WordToHtmlConverter {\n        public MyWordToHtmlConverter(Document document) {\n            super(document);\n        }\n\n        @Override\n        protected void processParagraph( HWPFDocumentCore hwpfDocument,\n                                         Element parentElement, int currentTableLevel, Paragraph paragraph,\n                                         String bulletText )\n        {\n            super.processParagraph(hwpfDocument, parentElement, currentTableLevel, paragraph, bulletText);\n            HWPFList list = paragraph.getList();\n            System.out.println(\"List \" + list);\n        }\n    }\n}\n\nEXCEPTION : \n\nException in thread \"main\" java.util.NoSuchElementException: LFO with ilfo 47 not found. lfoMac is 38\n\tat org.apache.poi.hwpf.model.PlfLfo.getLfo(PlfLfo.java:174)\n\tat org.apache.poi.hwpf.model.ListTables.getLfo(ListTables.java:125)\n\tat org.apache.poi.hwpf.usermodel.HWPFList.<init>(HWPFList.java:92)\n\tat org.apache.poi.hwpf.usermodel.Paragraph.getList(Paragraph.java:607)\n\tat PoiIssues$MyWordToHtmlConverter.processParagraph(PoiIssues.java:39)\n\tat org.apache.poi.hwpf.converter.AbstractWordConverter.processParagraphes(AbstractWordConverter.java:1111)\n\tat org.apache.poi.hwpf.converter.WordToHtmlConverter.processTable(WordToHtmlConverter.java:683)\n\tat org.apache.poi.hwpf.converter.AbstractWordConverter.processParagraphes(AbstractWordConverter.java:1073)\n\tat org.apache.poi.hwpf.converter.WordToHtmlConverter.processSingleSection(WordToHtmlConverter.java:608)\n\tat org.apache.poi.hwpf.converter.AbstractWordConverter.processDocument(AbstractWordConverter.java:721)\n\tat PoiIssues.main(PoiIssues.java:23)", "id": 190250, "time": "2016-04-14T16:06:48Z", "creator": "adityagaitonde@gmail.com", "creation_time": "2016-04-14T16:06:48Z", "attachment_id": 33762}]