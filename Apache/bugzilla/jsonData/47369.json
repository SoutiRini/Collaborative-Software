[{"count": 0, "tags": [], "creator": "fujino.keiichi@oss.ntt.co.jp", "attachment_id": null, "is_private": false, "id": 127949, "time": "2009-06-15T03:34:59Z", "bug_id": 47369, "creation_time": "2009-06-15T03:34:59Z", "text": "DeltaRequest is never reset after the session replication when BackupManager is used. \nThis means information on the previous session replication replicate again. \nactions.size() of DeltaRequest increases until the session becomes invalid.\n\nI think that I should reset DeltaRequest in each session replication. \nFor instance, as follows.\n\n[start.]\n\nIndex: java/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java\n===================================================================\n--- java/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java\t(revision 763870)\n+++ java/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java\t(working copy)\n@@ -401,6 +401,7 @@\n                                          rentry.getDiff(),\n                                          entry.getPrimary(),\n                                          entry.getBackupNodes());\n+                    rentry.resetDiff();\n                 } catch (IOException x) {\n                     log.error(\"Unable to diff object. Will replicate the entire object instead.\", x);\n                 } finally {\n\n\n[end.]\n\nBest regards"}, {"count": 1, "tags": [], "bug_id": 47369, "is_private": false, "text": "Fixed in trunk, proposed for backport into 6.0.x\n\nThank you for the patch, much appreciated.", "id": 127952, "time": "2009-06-15T10:37:08Z", "creator": "fhanik@apache.org", "creation_time": "2009-06-15T10:37:08Z", "attachment_id": null}]