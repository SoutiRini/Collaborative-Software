[{"count": 0, "tags": [], "bug_id": 42287, "is_private": false, "text": "When I send a POST request to a php/perl script. Chunked Response from apache\n2.2.x/trunk is abruptly closed. Sometimes it works fine and sometimes we don't\nsee last 0 in chunked response.\n\n\ntelnet hostname 4004\nTrying 192.18.120.216...\nConnected to localhost\nEscape character is '^]'.\nPOST /cgi-bin/test2.php HTTP/1.1\nHost: localhost:4004\nAccept: */*\nContent-Type: application/x-www-form-urlencoded\nConnection: close\nContent-Length: 6\n\nx=abcd\nHTTP/1.1 200 OK\nDate: Sat, 28 Apr 2007 03:12:05 GMT\nServer: Apache/2.3.0-dev (Unix) mod_ssl/2.3.0-dev OpenSSL/0.9.8a DAV/2\nX-Powered-By: PHP/5.2.1\nConnection: close\nTransfer-Encoding: chunked\nContent-Type: text/html\n\n2c\nx=abcd\npostdata =  ++\ntest2.php cgi script!\n\n-------------------------------------------\n$ curl -H \"Connection: close\" --data \"x=abcd\" --dump-header -\nhttp://hostname:4014/cgi-bin/test2.pl\nHTTP/1.1 200 OK\nDate: Sun, 29 Apr 2007 03:24:03 GMT\nServer: Apache/2.2.5-dev (Unix) mod_ssl/2.2.5-dev OpenSSL/0.9.8a DAV/2\nContent-type : text/html\nConnection: close\nTransfer-Encoding: chunked\nContent-Type: text/plain\n\ntest2.pl cgi script!\ncurl: (18) transfer closed with outstanding read data remaining\n-------------------------------------------\n#!/opt/php5.2.1/bin/php\n<?\nforeach ($_POST as $key => $value)\n{\n    print \"$key=$value\\n\";\n}\nprint \"postdata = $HTTP_RAW_POST_DATA ++\\n\";\nprint \"test2.php cgi script!\\n\";\n\n\n?>\n-------------------------------------------\n#!/usr/bin/perl\n\nprint \"Content-type : text/html\\r\\n\";\nprint \"\\r\\n\";\n\nprint \"test2.pl cgi script!\\n\";\n\n\n-------------------------------------------\nIn error log sometimes I saw this message.\n[Sat Apr 28 20:27:25 2007] [error] [client 192.18.120.216] (104)Connection reset\nby peer: ap_content_length_filter: apr_bucket_read() failed\n-------------------------------------------\n\nThis happens with both httpd-2.2.x and trunk.\nI am using apr and apr-util from trunk.\nThis could potentially be apr bug too.\n\nThe behavior is not at all predictable. It sometimes works ok and sometimes fails.", "id": 102606, "time": "2007-04-28T20:42:31Z", "creator": "basant.kukreja@sun.com", "creation_time": "2007-04-28T20:42:31Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 42287, "attachment_id": null, "id": 119831, "time": "2008-08-14T04:45:33Z", "creator": "rahul.g.nair@gmail.com", "creation_time": "2008-08-14T04:45:33Z", "is_private": false, "text": "Not able to reproduce in trunk, \nThis is what I used with test2.pl, I do not get an error here or in the error logs\n\nfor x in $(seq -w 00 99);\ndo (echo \"POST /cgi-bin/test2.pl HTTP/1.1\nHost:agneyam\nAccept: */*\nContent-Type:application/x-www-form-urlencoded\nConnection:close\nContent-length:6\n\nx=abcd\" | nc agneyam 8080 > resp/r.$x || echo err &);\ndone\n"}]