[{"count": 0, "tags": [], "creator": "ahti333+apachebugs@gmail.com", "attachment_id": null, "id": 170335, "time": "2013-09-28T15:22:33Z", "bug_id": 55607, "creation_time": "2013-09-28T15:22:33Z", "is_private": false, "text": "I think it is pretty inconvenient that one can't refer to the HOME environment variable in SuExec'd scripts.\n\nSuExec already gets the target users pw information (and his home directory) while performing security checks. It would be reasonable, imho, to set the HOME env variable to this value.\n\nI can not come up with any way how this could impact security, a script could do this lookup itself (although this is annoying, because most libraries rely on the HOME variable being set), so this would not expose any additional information.\n\nI would suggest to add something like this (code not tested):\n\n    /*\n     * Add the Home-directory from pw to the environment\n     */\n    {\n        char **ep;\n        char homebuf[256];\n        \n        sprintf(homebuf, \"HOME=%s\", target_homedir);\n        \n        ep = environ;\n        while (*ep != NULL) ++ep;\n        *ep = strdup(homebuf);\n        if (*ep == NULL) {\n            log_err(\"failed to malloc memory for environment\\n\");\n            exit(124);\n        }\n        *(ep + 1) = NULL;\n    }\n\nat line 472 in suexec.c\n\nWhat do You think?"}]