[{"count": 0, "tags": [], "bug_id": 32174, "attachment_id": null, "is_private": false, "id": 66699, "time": "2004-11-11T04:51:07Z", "creator": "max@berger.name", "creation_time": "2004-11-11T04:51:07Z", "text": "Dear Developers,\n\neverytime i try and render a document created via the docbook-xsl stylesheets,\nit crashes with IndexOutOfBoundsException in LineLayoutManager. I am using a\ncurrent (Nov 11 04) cvs checkout. jdk version is 1.4.2. The same error happens\nif I try with the -awt output. Fop 0.25 renders the same document fine.\n\nIf you need the .fo file, I could provide that.\n\nThanks\n\n$ ../../JavaLib/xml-fop/fop.bat -d silenus.fo -pdf silenus.pdf\nBuilding formatting object tree\nCurrent heap size: 1015Kb\nStarting layout\nNo set of breaking points found with maxAdjustment = 1.0\nNo set of breaking points found with maxAdjustment = 5.0\nNo set of breaking points found with maxAdjustment = 1.0\nNo set of breaking points found with maxAdjustment = 1.0 and hyphenation\nEnding layout\nCurrent heap size: 2177Kb\nStarting layout\nnull implementation of getWordSpaceIPD() called!\nNo set of breaking points found with maxAdjustment = 1.0\nnull implementation of getWordChars() called!\nNo set of breaking points found with maxAdjustment = 1.0 and hyphenation\nCould not find a set of breaking points\nnull implementation of getWordSpaceIPD() called!\nNo set of breaking points found with maxAdjustment = 1.0\nnull implementation of getWordChars() called!\nNo set of breaking points found with maxAdjustment = 1.0 and hyphenation\nCould not find a set of breaking points\nEnding layout\nCurrent heap size: 2972Kb\nStarting layout\nnull implementation of getWordSpaceIPD() called!\nNo set of breaking points found with maxAdjustment = 1.0\nnull implementation of getWordChars() called!\nNo set of breaking points found with maxAdjustment = 1.0 and hyphenation\nCould not find a set of breaking points\nEnding layout\nCurrent heap size: 3483Kb\nStarting layout\nNo set of breaking points found with maxAdjustment = 1.0\nNo set of breaking points found with maxAdjustment = 5.0\nCould not find a set of breaking points\nNo set of breaking points found with maxAdjustment = 1.0\nNo set of breaking points found with maxAdjustment = 1.0 and hyphenation\nNo set of breaking points found with maxAdjustment = 1.0\nNo set of breaking points found with maxAdjustment = 1.0 and hyphenation\nNo set of breaking points found with maxAdjustment = 1.0\nNo set of breaking points found with maxAdjustment = 1.0 and hyphenation\nNo set of breaking points found with maxAdjustment = 1.0\nNo set of breaking points found with maxAdjustment = 1.0 and hyphenation\nNo set of breaking points found with maxAdjustment = 1.0\nNo set of breaking points found with maxAdjustment = 1.0 and hyphenation\nnull implementation of getWordSpaceIPD() called!\nNo set of breaking points found with maxAdjustment = 1.0\nnull implementation of getWordChars() called!\nNo set of breaking points found with maxAdjustment = 1.0 and hyphenation\nCould not find a set of breaking points\nNo set of breaking points found with maxAdjustment = 1.0\nNo set of breaking points found with maxAdjustment = 1.0 and hyphenation\nNo set of breaking points found with maxAdjustment = 1.0\nNo set of breaking points found with maxAdjustment = 1.0 and hyphenation\nNo set of breaking points found with maxAdjustment = 1.0\nNo set of breaking points found with maxAdjustment = 1.0 and hyphenation\nnull implementation of getWordSpaceIPD() called!\nNo set of breaking points found with maxAdjustment = 1.0\nnull implementation of getWordChars() called!\nNo set of breaking points found with maxAdjustment = 1.0 and hyphenation\nCould not find a set of breaking points\nNo set of breaking points found with maxAdjustment = 1.0\nNo set of breaking points found with maxAdjustment = 1.0 and hyphenation\nEnding layout\nCurrent heap size: 5073Kb\nStarting layout\nNo set of breaking points found with maxAdjustment = 1.0\nNo set of breaking points found with maxAdjustment = 5.0\nCould not find a set of breaking points\nException\njava.lang.IndexOutOfBoundsException: Index: 0, Size: 0\n\tat org.apache.fop.apps.InputHandler.render(InputHandler.java:123)\n\tat org.apache.fop.apps.Fop.main(Fop.java:153)\n\n---------\n\njava.lang.IndexOutOfBoundsException: Index: 0, Size: 0\n\tat java.util.ArrayList.RangeCheck(Unknown Source)\n\tat java.util.ArrayList.get(Unknown Source)\n\tat\norg.apache.fop.layoutmgr.LineLayoutManager.getNextBreakPoss(LineLayoutManager.java:522)\n\tat\norg.apache.fop.layoutmgr.BlockLayoutManager.getNextBreakPoss(BlockLayoutManager.java:208)\n\tat\norg.apache.fop.layoutmgr.BlockLayoutManager.getNextBreakPoss(BlockLayoutManager.java:208)\n\tat\norg.apache.fop.layoutmgr.BlockLayoutManager.getNextBreakPoss(BlockLayoutManager.java:208)\n\tat\norg.apache.fop.layoutmgr.BlockLayoutManager.getNextBreakPoss(BlockLayoutManager.java:208)\n\tat\norg.apache.fop.layoutmgr.BlockLayoutManager.getNextBreakPoss(BlockLayoutManager.java:208)\n\tat\norg.apache.fop.layoutmgr.BlockLayoutManager.getNextBreakPoss(BlockLayoutManager.java:208)\n\tat\norg.apache.fop.layoutmgr.FlowLayoutManager.getNextBreakPoss(FlowLayoutManager.java:83)\n\tat\norg.apache.fop.layoutmgr.PageSequenceLayoutManager.getNextBreakPoss(PageSequenceLayoutManager.java:266)\n\tat\norg.apache.fop.layoutmgr.PageSequenceLayoutManager.doLayout(PageSequenceLayoutManager.java:230)\n\tat\norg.apache.fop.layoutmgr.PageSequenceLayoutManager.run(PageSequenceLayoutManager.java:177)\n\tat org.apache.fop.area.AreaTreeHandler.endPageSequence(AreaTreeHandler.java:254)\n\tat org.apache.fop.fo.pagination.PageSequence.endOfNode(PageSequence.java:202)\n\tat org.apache.fop.fo.FOTreeBuilder.endElement(FOTreeBuilder.java:291)\n\tat org.apache.xalan.transformer.TransformerIdentityImpl.endElement(Unknown Source)\n\tat org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)\n\tat org.apache.xerces.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown Source)\n\tat\norg.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown\nSource)\n\tat org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown\nSource)\n\tat org.apache.xerces.parsers.DTDConfiguration.parse(Unknown Source)\n\tat org.apache.xerces.parsers.DTDConfiguration.parse(Unknown Source)\n\tat org.apache.xerces.parsers.XMLParser.parse(Unknown Source)\n\tat org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)\n\tat org.apache.xalan.transformer.TransformerIdentityImpl.transform(Unknown Source)\n\tat org.apache.fop.apps.InputHandler.render(InputHandler.java:120)\n\tat org.apache.fop.apps.Fop.main(Fop.java:153)"}, {"count": 1, "tags": [], "creator": "lfurini@cs.unibo.it", "attachment_id": null, "id": 66708, "time": "2004-11-11T09:54:13Z", "bug_id": 32174, "creation_time": "2004-11-11T09:54:13Z", "is_private": false, "text": "The fo file would be very useful to see what goes wrong, but a minimal fo file \nshowing this bug would be even better! :-)\n\nIt seems that the problem concerns a fo:block in the 5th fo:page-sequence: if \npossible, please attach the shortest fo file still presenting this bug.\n\nThanks!\n\n    Luca"}, {"id": 66710, "tags": [], "creator": "adelmelle@apache.org", "is_private": false, "count": 2, "text": "Hi Luca,\n\nI have been running into the same problem, and haven't been able to fully \nisolate the cause just yet, but I strongly suspect this has something to do \nwith fo:blocks containing nothing but a non-breaking space (&#xA0;). \n\nIf you take a look at line 522 in LineLayoutManager, it would seem that the \nIOOBException is being thrown because the list of possible linebreak positions \nis empty...\n\nAttached the most basic FO I could think of :-)\n\nGreetz,\n\nAndreas", "time": "2004-11-11T11:11:41Z", "bug_id": 32174, "creation_time": "2004-11-11T11:11:41Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 32174, "attachment_id": 13396, "id": 66711, "time": "2004-11-11T11:13:06Z", "creator": "adelmelle@apache.org", "creation_time": "2004-11-11T11:13:06Z", "is_private": false, "text": "Created attachment 13396\nFO demonstrating possible cause"}, {"count": 4, "tags": [], "bug_id": 32174, "attachment_id": 13411, "id": 66763, "time": "2004-11-11T22:23:51Z", "creator": "max@berger.name", "creation_time": "2004-11-11T22:23:51Z", "is_private": false, "text": "Created attachment 13411\nVery cut down example, same error. fop 0.20.5 renders it fine"}, {"count": 5, "tags": [], "bug_id": 32174, "attachment_id": null, "is_private": false, "id": 66764, "time": "2004-11-11T22:27:58Z", "creator": "max@berger.name", "creation_time": "2004-11-11T22:27:58Z", "text": "I've added a new testcase, which is attached. Very interesting: If i delete the\nline:\n\n<fo:marker marker-class-name=\"section.head.marker\">SORCER</fo:marker>\n\nIt renders fine. If i leave it in there it crashes (Index out of bounds)"}, {"count": 6, "tags": [], "creator": "glenmazza@yahoo.com", "attachment_id": null, "text": "You do know that 1.0 is in development right now, correct?  I am very doubtful\nthat it can handle the docbook xsl stylesheets--there are probably dozen of\nissues right now (after the one below) that still need fixing/implementation.\n\nGlen", "id": 66766, "time": "2004-11-11T22:35:57Z", "bug_id": 32174, "creation_time": "2004-11-11T22:35:57Z", "is_private": false}, {"count": 7, "tags": [], "bug_id": 32174, "attachment_id": null, "is_private": false, "id": 66767, "time": "2004-11-11T23:13:09Z", "creator": "max@berger.name", "creation_time": "2004-11-11T23:13:09Z", "text": "Glen,\n\nI realize that there will be multiple issues. Even if I delete all the\n\"fo:marker\"  lines from my .fo file (which makes it actually work!) the output\nis far from perfect. \n\nBut in the end fop 1.0 should be able to render my document. And as far as I\nunderstand (please correct me if i am wrong on this), unless the issue is\nalready documented as missing / not working in some test case this is the place\nto report it."}, {"count": 8, "tags": [], "creator": "adelmelle@apache.org", "attachment_id": null, "id": 66771, "time": "2004-11-11T23:51:18Z", "bug_id": 32174, "creation_time": "2004-11-11T23:51:18Z", "is_private": false, "text": "All right! So now it's narrowed down to two cases for which the code needs a \nbit of fine-tuning:\n\n- markers: however, it's a distinct possibility that there's a slightly \ndifferent cause for this --I don't really see how a marker that isn't retrieved \ncan trigger the creation of a LineLayoutManager in the first place. That should \nonly happen *if* and *when* the marker is retrieved.\n\n- (pseudo-)empty blocks (mainly used in case one has empty table-cells)\n\nBTW: Max, you are absolutely right in that this is THE place to report such \nerrors, and of course we appreciate your input --how else would we be able to \narrive at a working solution in the end?\n"}, {"count": 9, "tags": [], "text": "<Q>\nI understand (please correct me if i am wrong on this), unless the issue is\nalready documented as missing / not working in some test case this is the place\nto report it.\n</Q>\n\nAbsolutely, Max, you are doing the right thing in reporting the bugs.  Please\ncontinue!  I just don't want you to be *surprised* that there are bugs in the\n1.0 release--that you're aware that the 1.0 system isn't complete ATM.\n\nThanks,\nGlen", "attachment_id": null, "id": 66772, "creator": "glenmazza@yahoo.com", "time": "2004-11-12T02:48:21Z", "bug_id": 32174, "creation_time": "2004-11-12T02:48:21Z", "is_private": false}, {"count": 10, "tags": [], "creator": "max@berger.name", "attachment_id": null, "id": 66776, "time": "2004-11-12T04:43:47Z", "bug_id": 32174, "creation_time": "2004-11-12T04:43:47Z", "is_private": false, "text": "Glen,\n\nsorry I appear to have misunderstood you. I know that the software will not be\nperfect for a while.\n\nThe reason I filed this bug because I needed some other functionality, wanted to\nwrite a patch for it. But there is no point in patching the stable branch, so I\nam stuck with 1.0dev.\n\nAs for this bug, I've looked into the code but I am missing the necessary\nunderstanding of this project to make any useful contributions :(\n"}, {"count": 11, "tags": [], "creator": "bckfnn@worldonline.dk", "attachment_id": null, "id": 66781, "time": "2004-11-12T08:11:41Z", "bug_id": 32174, "creation_time": "2004-11-12T08:11:41Z", "is_private": false, "text": "The case with markers fail due to a conflict between FObj.addMarker() which\ntries to remove empty elements before a marker and Block.addChildNode() which\nstill hangs on to the firstInlineChild even after it is removed by FObj.addMarker().\n\nPerhaps Block should use an integer index to point to the first inline child\ninstead of a reference."}, {"id": 66859, "tags": [], "creator": "spepping@apache.org", "is_private": false, "count": 12, "text": "In Andreas' test file:\n\nknuthParagraphs is an empty list, therefore breakpoints is an empty\nlist, and breakpoints.get(iReturnedLBP ++) throws an\nIndexOutOfBoundsException. I think a paragraph that is ended by a\nforced linebreak should never be empty, order to honour the forced\nlinebreak.\n", "time": "2004-11-13T20:40:36Z", "bug_id": 32174, "creation_time": "2004-11-13T20:40:36Z", "attachment_id": null}, {"id": 66962, "tags": [], "creator": "spepping@apache.org", "is_private": false, "count": 13, "text": "I applied a quick and dirty hack to prevent this Exception in the case of\nAndreas' test file. It will throw away the linebreak though.", "time": "2004-11-15T22:02:10Z", "bug_id": 32174, "creation_time": "2004-11-15T22:02:10Z", "attachment_id": null}, {"count": 14, "tags": [], "creator": "spepping@apache.org", "attachment_id": null, "id": 84454, "time": "2006-01-10T21:28:29Z", "bug_id": 32174, "creation_time": "2006-01-10T21:28:29Z", "is_private": false, "text": "The problem no longer occurs."}, {"count": 15, "tags": [], "text": "batch transition pre-FOP1.0 resolved+fixed bugs to closed+fixed", "attachment_id": null, "bug_id": 32174, "id": 156059, "time": "2012-04-01T06:56:10Z", "creator": "gadams@apache.org", "creation_time": "2012-04-01T06:56:10Z", "is_private": false}]