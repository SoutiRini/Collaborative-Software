[{"count": 0, "tags": [], "bug_id": 55800, "attachment_id": 31058, "text": "Created attachment 31058\nFull java code of this copy.\n\nSource file: InStyleSheet.xlsx (existing)\nDestination file: Output.xlsx (not existing yet)\n\nCreate new file Output.xlsx\nWrite data value to cell A1.\nClone CellStyle in cell A1 of InStyleSheet.xlsx to apply on A1 of Output.xlsx\nThis is done by using:\n\t\tCell oldCell = inpWb.getSheetAt(0).getRow(0).getCell(0);\n\t\tCellStyle cellStyle = outWb.createCellStyle();\n\t\tcellStyle.cloneStyleFrom(oldCell.getCellStyle());\n\t\tnewCell.setCellStyle(cellStyle);\n\nSave Output.xlsx and exit.\n\nError: \nJava: no error.\nExcel: Complains: Excel found unreadable content in \"Output.xlsx\". Do you want to recover the contents of this workbook? If you trust the source of this workbook, click Yes.", "id": 171337, "time": "2013-11-20T04:29:30Z", "creator": "tienduong.nk@gmail.com", "creation_time": "2013-11-20T04:29:30Z", "is_private": false}, {"count": 1, "tags": [], "creator": "apache@gagravarr.org", "attachment_id": null, "is_private": false, "id": 171348, "time": "2013-11-20T11:59:34Z", "bug_id": 55800, "creation_time": "2013-11-20T11:59:34Z", "text": "Does this happen for all cell styles, or just this one?\n\nCan you identify what about the cell style breaks it? Eg style in A1 clones fine, A2 is A1 plus XXXX, which then fails? That'll help narrow down what's going wrong"}, {"count": 2, "tags": [], "creator": "tienduong.nk@gmail.com", "attachment_id": null, "is_private": false, "id": 171366, "time": "2013-11-21T08:25:47Z", "bug_id": 55800, "creation_time": "2013-11-21T08:25:47Z", "text": "Hi. This problem happened for all cells in the sheet. \nI tried the sheet with few hundred cells data, all cells got formatting issue. \nIn the code that I sent, I only checked 1 cell, it came with the same issue. \n\nConclusion: Error happened for all cells."}, {"count": 3, "tags": [], "bug_id": 55800, "attachment_id": null, "text": "All cells in that workbook, or all cells in all workbooks?\n\nFor example, if you create a new empty workbook, can you clone from that? What about if you start with an empty workbook, and begin styling a cell there. Does it fail immediately? When it almost looks like a cell in your problem file? When it exactly matches?", "id": 171367, "time": "2013-11-21T09:21:11Z", "creator": "apache@gagravarr.org", "creation_time": "2013-11-21T09:21:11Z", "is_private": false}, {"count": 4, "text": "My test was:\n- Create brand new One.xlsx file. Do formatting for cell A1 as follow:\n\ncellStyle.setFillForegroundColor(IndexedColors.YELLOW.getIndex());\ncellStyle.setFillPattern(CellStyle.SOLID_FOREGROUND);\nmyCell.setCellStyle(cellStyle);\n\n- Save file. Close.\n\n- Create brand new Two.xlsx file. Clone cellstyle from One.xlxs :\nCell oldCell = oneWorkbook.getSheetAt(0).getRow(0).getCell(0);\ncellStyle2.cloneStyleFrom(oldCell.getCellStyle());\nnewCell.setCellStyle(cellStyle2);\n\n- Save file. Close.\n\n===> Error happened for Two.xlxs (Unreadable content.)", "bug_id": 55800, "attachment_id": null, "id": 172046, "time": "2014-01-03T01:12:29Z", "creator": "tienduong.nk@gmail.com", "creation_time": "2014-01-03T01:12:29Z", "tags": [], "is_private": false}, {"text": "The reason is it won't copy the XSSFCellFill and XSSFCellBorder. This also gives problem with borders. I have added a method in org.apache.poi.xssf.model.StylesTable which will help in creating a copy of workbook. \n\npublic void copyTo(StylesTable stylesTable){\n\t    stylesTable.numberFormats.clear();\n\t    stylesTable.fonts.clear();\n\t    stylesTable.fills.clear();\n\t    stylesTable.borders.clear();\n\t    stylesTable.styleXfs.clear();\n\t    stylesTable.xfs.clear();\n\t    stylesTable.dxfs.clear();\n\t    \n\t    for(String str : numberFormats.values())\n\t        stylesTable.putNumberFormat(str);\n\t    \n\t    for(XSSFFont font : fonts){\n\t        XSSFFont fontNew = new XSSFFont(font.getCTFont());\n\t        fontNew.registerTo(stylesTable);\n\t    }\n\t    for(XSSFCellFill fill : fills){\n\t        XSSFCellFill fillNew = new XSSFCellFill(fill.getCTFill());\n\t        stylesTable.putFill(fillNew);\n\t    }\n\t    for(XSSFCellBorder border : borders){\n\t        XSSFCellBorder borderNew = new XSSFCellBorder(border.getCTBorder());\n\t        stylesTable.putBorder(borderNew);\n\t    }\n\t    for(CTXf ctxf : styleXfs){\n\t        CTXf ctxfNew = (CTXf)ctxf.copy();\n\t        stylesTable.putCellStyleXf(ctxfNew);\n\t    }\n\t    for(CTXf ctxf : xfs){\n\t        CTXf ctxfNew = (CTXf)ctxf.copy();\n\t        stylesTable.putCellXf(ctxfNew);\n\t    }\n\t    for(CTDxf dxf : dxfs){\n\t        CTDxf dxfNew = (CTDxf)dxf.copy();\n\t        stylesTable.putDxf(dxfNew);\n\t    }\n\t}", "tags": [], "bug_id": 55800, "is_private": false, "count": 5, "id": 173924, "time": "2014-03-19T00:43:08Z", "creator": "kiransringeri@gmail.com", "creation_time": "2014-03-19T00:43:08Z", "attachment_id": null}, {"text": "Hello,\n\nwill there be a bugfix available in the near future?\n\nThanks in advance", "tags": [], "bug_id": 55800, "is_private": false, "count": 6, "id": 179151, "time": "2014-11-17T07:30:49Z", "creator": "j.zimmer@t-p.com", "creation_time": "2014-11-17T07:30:49Z", "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 55800, "attachment_id": null, "text": "There were two bugfixes done for bug 56295 which also could fix this, can you re-try this with a recent trunk-build, e.g. from https://builds.apache.org/job/POI/lastSuccessfulBuild/artifact/build/dist and report here if the problem still happens?", "id": 181878, "time": "2015-03-18T19:06:44Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-03-18T19:06:44Z", "is_private": false}, {"count": 8, "tags": [], "creator": "543002649@qq.com", "attachment_id": null, "is_private": false, "id": 182642, "time": "2015-04-27T08:42:34Z", "bug_id": 55800, "creation_time": "2015-04-27T08:42:34Z", "text": "just as i say above.\nyou can do a simple demo to vertify my word."}, {"count": 9, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "is_private": false, "id": 185233, "time": "2015-09-14T18:03:26Z", "bug_id": 55800, "creation_time": "2015-09-14T18:03:26Z", "text": "This looks related to bug 58084 where similar corrupted files are reported after using cloneStyleFrom()."}, {"count": 10, "tags": [], "creator": "dominik.stadler@gmx.at", "attachment_id": null, "text": "I believe bug 58084 will fix this one as well.\n\n*** This bug has been marked as a duplicate of bug 58084 ***", "id": 186787, "time": "2015-12-04T13:55:00Z", "bug_id": 55800, "creation_time": "2015-12-04T13:55:00Z", "is_private": false}]