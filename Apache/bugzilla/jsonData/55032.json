[{"count": 0, "tags": [], "bug_id": 55032, "attachment_id": null, "text": "Problem Description:\n\nif you enter a formula like\n=PV(0.08/12, 20*12, 500, ,0)\n\nNotice the 4th argument is missing. In this case, 4th and 5th arguments are both optional.\n\n\nActual:\nit throws java.lang.RuntimeException: Unexpected arg eval type (org.apache.poi.ss.formula.eval.MissingArgEval)\n\n\nExpected:\nIt seems it cannot accept an optional argument in the middle of argument list. But Excel can accept and treat the omitted arguments as 0.", "id": 167524, "time": "2013-05-31T07:46:19Z", "creator": "hawkchen@potix.com", "creation_time": "2013-05-31T07:46:19Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 55032, "attachment_id": null, "id": 167525, "time": "2013-05-31T08:13:14Z", "creator": "hawkchen@potix.com", "creation_time": "2013-05-31T08:13:14Z", "is_private": false, "text": "Suggested solution:\nin\npublic abstract class FinanceFunction implements Function3Arg, Function4Arg {\n...\n\tpublic ValueEval evaluate(ValueEval[] args, int srcRowIndex, int srcColumnIndex) {\n\t\tswitch (args.length) {\n\t\t\tcase 3:\n\t\t\t\treturn evaluate(srcRowIndex, srcColumnIndex, args[0], args[1], args[2], DEFAULT_ARG3, DEFAULT_ARG4);\n\t\t\tcase 4:\n\t\t\t\treturn evaluate(srcRowIndex, srcColumnIndex, args[0], args[1], args[2], args[3], DEFAULT_ARG4);\n\t\t\tcase 5:\n\t\t\t\treturn evaluate(srcRowIndex, srcColumnIndex, args[0], args[1], args[2], args[3], args[4]);\n\t\t}\n\t\treturn ErrorEval.VALUE_INVALID;\n\t}\n\nConvert MissArgEval to DEFAULT_ARG3 or DEFAULT_ARG4 in case 4 and case 5."}, {"count": 2, "tags": [], "text": "This should be fixed in trunk via r1706254 now.", "is_private": false, "bug_id": 55032, "id": 185575, "time": "2015-10-01T14:06:21Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-10-01T14:06:21Z", "attachment_id": null}]