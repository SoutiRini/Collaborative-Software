[{"count": 0, "tags": [], "bug_id": 9526, "text": "The javadocs for HttpServletRequest.getHeaders(String name) states that this\nmethod will yield an enumeration of all values associated with the specified header.\n\nHowever, the result will yield unexpected results if the header is presented in\na certain fashion.\n\nFor example, take the following:\n------------------------------------------------\nGET /test.jsp HTTP/1.0\nheader1: val1\nheader1: val2\n\nHTTP/1.1 200 OK\nContent-Type: text/html;ISO-8859-1\nSet-Cookie: JSESSIONID=5952D8602392F093E5203582AACC4A65; Path=/\nDate: Thu, 30 May 2002 18:50:14 GMT\nServer: Apache Coyote HTTP/1.1 Connector [1.0]\nConnection: close\n\nval1\nval2\n\n--------------------------------------------------------\n\nNow consider the same request, except in this case,\ninstead of sending two request headers, the values\nare aggregated into a comma-separated list of values:\n\n--------------------------------------------------------------\n\nTrying 127.0.0.1...\nConnected to localhost.\nEscape character is '^]'.\nGET /test.jsp HTTP/1.0\nheader1: val1, val2\n\nHTTP/1.1 200 OK\nContent-Type: text/html;ISO-8859-1\nSet-Cookie: JSESSIONID=94E82F0181EE1001D109531544CAE960; Path=/\nDate: Thu, 30 May 2002 18:55:36 GMT\nServer: Apache Coyote HTTP/1.1 Connector [1.0]\nConnection: close\n\nval1, val2\n\n\nConnection closed by foreign host.\n-------------------------------------------------------------------\n\nIn the above case, the call to getHeaders() is returning the list of values\nas a single enumerated entity.  This seems to go against what is described in\nthe javadocs.", "id": 16953, "time": "2002-05-30T18:02:30Z", "creator": "Ryan.Lubke@Sun.COM", "creation_time": "2002-05-30T18:02:30Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "text": "If this is indeed a bug (it looks like it), it is a limitation of the header\nparser from j-t-c/util (unless the precondition for adding a value to a header\nis that it is \"comma-parsed\" but I doubt it, as it would break stuff).", "attachment_id": null, "bug_id": 9526, "id": 17019, "time": "2002-05-31T22:07:38Z", "creator": "remm@apache.org", "creation_time": "2002-05-31T22:07:38Z", "is_private": false}, {"count": 2, "tags": [], "creator": "jfclere@gmail.com", "attachment_id": null, "id": 17135, "time": "2002-06-04T06:59:09Z", "bug_id": 9526, "creation_time": "2002-06-04T06:59:09Z", "is_private": false, "text": "When using a proxy if the browser sends:\nheader1: val1\nheader1: val2\n\nIt could \"optimise\" the header to:\nheader1: val1, val2\n\nhttpd-2.0 is something like that. That is why some of the watchdog tests failed\nwhen using mod_webapp or mod_jk."}, {"count": 3, "tags": [], "text": "This really needs to be fixed!  Yes, there are workarounds such as using\ngetHeader(headerName) and seeing if the value you are looking for exists in the\nstring, but this totally defeats the purpose of getHeaders(headerName).  In\naddition anyone who is counting on it to work (and why shouldn't they?) and\nfinds it works on other servers, which are compliant with the servlet spec, will\nfind their code mysteriously failing because they expected a single value for\neach enumerated element rather than a single enumerated element with the same\nvalue they would get had they called getHeader(headerName).\n\nIf this won't be fixed in Tomcat 4.x.x, will it, at least, be fixed in Tomcat 5?\n It isn't fixed currently based on the testing the latest nightly buid.  I get\nthe same mis-behavior as in Tomcat-4.1.18.\n\nJake", "is_private": false, "bug_id": 9526, "id": 28887, "time": "2003-01-05T07:29:27Z", "creator": "hoju@visi.com", "creation_time": "2003-01-05T07:29:27Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 9526, "text": "A lengthy discussion started on tomcat-dev, and it turns out it was decided it\nis not a bug.\nBTW, could you stop whining ? Thanks.", "id": 28889, "time": "2003-01-05T07:44:47Z", "creator": "remm@apache.org", "creation_time": "2003-01-05T07:44:47Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "hoju@visi.com", "attachment_id": null, "id": 28892, "time": "2003-01-05T19:27:53Z", "bug_id": 9526, "creation_time": "2003-01-05T19:27:53Z", "is_private": false, "text": "Whining?  Please.  I thought this was a spec compliance issue... and after I\nspent an hour trying to figure out why my code using getHeaders() wasn't working\nas I expected it to based on the, quite clear, description of the method in the\nservlet spec, I searched for bugs and found this which was marked as \"NEW\".  If\nyou had marked it as \"INVALID\" before with a link to the discussion, I would not\nhave bothered to \"whine\".  Thanks setting me straight.\n\nJake"}]