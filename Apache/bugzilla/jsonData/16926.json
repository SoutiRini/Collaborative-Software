[{"count": 0, "attachment_id": null, "creator": "david.bernier@unilog.fr", "text": "Hi,\ni use cocoon to export xml data to xls spreadsheet. In order to, i use the\nHSSFSerializer to serialize the xml stream. If i test my export on websphere\nserver, it's work fine but on tomcat there is only one row created (the last\none). Furthemore, if i use an another serializer (like XMLSerializer) on tomcat,\nit's work fine. So i don't know if it's a problem with an incompatibility of\njars between the xls serializer and the libs of tomcat or it's a cocoon's\nproblem or anything else...\n\nThis is my xml file :\n\n<?xml version=\"1.0\" encoding=\"iso-8859-1\"?>\n\n<RowSet>\n  <properties>\n    <command>0</command>\n    <concurrency>1007</concurrency>\n    <datasource>0</datasource>\n    <escape-processing>true</escape-processing>\n    <fetch-direction>0</fetch-direction>\n    <fetch-size>0</fetch-size>\n    <isolation-level>2</isolation-level>\n    <key-columns>\n    </key-columns>\n    <map></map>\n    <max-field-size>0</max-field-size>\n    <max-rows>0</max-rows>\n    <query-timeout>0</query-timeout>\n    <read-only>true</read-only>\n    <rowset-type>1004</rowset-type>\n    <show-deleted>false</show-deleted>\n    <table-name>0</table-name>\n    <url>0</url>\n  </properties>\n  <metadata>\n    <column-count>10</column-count>\n    <column-definition>\n      <column-index>1</column-index>\n      <auto-increment>false</auto-increment>\n      <case-sensitive>false</case-sensitive>\n      <currency>true</currency>\n      <nullable>0</nullable>\n      <signed>true</signed>\n      <searchable>true</searchable>\n      <column-display-size>21</column-display-size>\n      <column-label>DEMANDE_CODE</column-label>\n      <column-name>DEMANDE_CODE</column-name>\n      <schema-name></schema-name>\n      <column-precision>8</column-precision>\n      <column-scale>0</column-scale>\n      <table-name></table-name>\n      <catalog-name></catalog-name>\n      <column-type>2</column-type>\n      <column-type-name>NUMBER</column-type-name>\n    </column-definition>\n    <column-definition>\n      <column-index>2</column-index>\n      <auto-increment>false</auto-increment>\n      <case-sensitive>false</case-sensitive>\n      <currency>true</currency>\n      <nullable>1</nullable>\n      <signed>true</signed>\n      <searchable>true</searchable>\n      <column-display-size>21</column-display-size>\n      <column-label>DEMANDE_MILLESIME</column-label>\n      <column-name>DEMANDE_MILLESIME</column-name>\n      <schema-name></schema-name>\n      <column-precision>4</column-precision>\n      <column-scale>0</column-scale>\n      <table-name></table-name>\n      <catalog-name></catalog-name>\n      <column-type>2</column-type>\n      <column-type-name>NUMBER</column-type-name>\n    </column-definition>\n    <column-definition>\n      <column-index>3</column-index>\n      <auto-increment>false</auto-increment>\n      <case-sensitive>true</case-sensitive>\n      <currency>false</currency>\n      <nullable>1</nullable>\n      <signed>true</signed>\n      <searchable>true</searchable>\n      <column-display-size>20</column-display-size>\n      <column-label>DEMANDE_CODEXT</column-label>\n      <column-name>DEMANDE_CODEXT</column-name>\n      <schema-name></schema-name>\n      <column-precision>20</column-precision>\n      <column-scale>0</column-scale>\n      <table-name></table-name>\n      <catalog-name></catalog-name>\n      <column-type>12</column-type>\n      <column-type-name>VARCHAR2</column-type-name>\n    </column-definition>\n    <column-definition>\n      <column-index>4</column-index>\n      <auto-increment>false</auto-increment>\n      <case-sensitive>true</case-sensitive>\n      <currency>false</currency>\n      <nullable>1</nullable>\n      <signed>true</signed>\n      <searchable>true</searchable>\n      <column-display-size>30</column-display-size>\n      <column-label>TYPDEM_LIB</column-label>\n      <column-name>TYPDEM_LIB</column-name>\n      <schema-name></schema-name>\n      <column-precision>30</column-precision>\n      <column-scale>0</column-scale>\n      <table-name></table-name>\n      <catalog-name></catalog-name>\n      <column-type>12</column-type>\n      <column-type-name>VARCHAR2</column-type-name>\n    </column-definition>\n    <column-definition>\n      <column-index>5</column-index>\n      <auto-increment>false</auto-increment>\n      <case-sensitive>true</case-sensitive>\n      <currency>false</currency>\n      <nullable>1</nullable>\n      <signed>true</signed>\n      <searchable>true</searchable>\n      <column-display-size>30</column-display-size>\n      <column-label>TIERS_LIB</column-label>\n      <column-name>TIERS_LIB</column-name>\n      <schema-name></schema-name>\n      <column-precision>30</column-precision>\n      <column-scale>0</column-scale>\n      <table-name></table-name>\n      <catalog-name></catalog-name>\n      <column-type>12</column-type>\n      <column-type-name>VARCHAR2</column-type-name>\n    </column-definition>\n    <column-definition>\n      <column-index>6</column-index>\n      <auto-increment>false</auto-increment>\n      <case-sensitive>true</case-sensitive>\n      <currency>false</currency>\n      <nullable>1</nullable>\n      <signed>true</signed>\n      <searchable>true</searchable>\n      <column-display-size>30</column-display-size>\n      <column-label>CDR_LIB</column-label>\n      <column-name>CDR_LIB</column-name>\n      <schema-name></schema-name>\n      <column-precision>30</column-precision>\n      <column-scale>0</column-scale>\n      <table-name></table-name>\n      <catalog-name></catalog-name>\n      <column-type>12</column-type>\n      <column-type-name>VARCHAR2</column-type-name>\n    </column-definition>\n    <column-definition>\n      <column-index>7</column-index>\n      <auto-increment>false</auto-increment>\n      <case-sensitive>true</case-sensitive>\n      <currency>false</currency>\n      <nullable>0</nullable>\n      <signed>true</signed>\n      <searchable>true</searchable>\n      <column-display-size>30</column-display-size>\n      <column-label>ETAT</column-label>\n      <column-name>ETAT</column-name>\n      <schema-name></schema-name>\n      <column-precision>30</column-precision>\n      <column-scale>0</column-scale>\n      <table-name></table-name>\n      <catalog-name></catalog-name>\n      <column-type>12</column-type>\n      <column-type-name>VARCHAR2</column-type-name>\n    </column-definition>\n    <column-definition>\n      <column-index>8</column-index>\n      <auto-increment>false</auto-increment>\n      <case-sensitive>true</case-sensitive>\n      <currency>false</currency>\n      <nullable>1</nullable>\n      <signed>true</signed>\n      <searchable>true</searchable>\n      <column-display-size>3</column-display-size>\n      <column-label>COMPLET</column-label>\n      <column-name>COMPLET</column-name>\n      <schema-name></schema-name>\n      <column-precision>3</column-precision>\n      <column-scale>0</column-scale>\n      <table-name></table-name>\n      <catalog-name></catalog-name>\n      <column-type>12</column-type>\n      <column-type-name>VARCHAR2</column-type-name>\n    </column-definition>\n    <column-definition>\n      <column-index>9</column-index>\n      <auto-increment>false</auto-increment>\n      <case-sensitive>false</case-sensitive>\n      <currency>true</currency>\n      <nullable>1</nullable>\n      <signed>true</signed>\n      <searchable>true</searchable>\n      <column-display-size>21</column-display-size>\n      <column-label>TIERS_CODE</column-label>\n      <column-name>TIERS_CODE</column-name>\n      <schema-name></schema-name>\n      <column-precision>8</column-precision>\n      <column-scale>0</column-scale>\n      <table-name></table-name>\n      <catalog-name></catalog-name>\n      <column-type>2</column-type>\n      <column-type-name>NUMBER</column-type-name>\n    </column-definition>\n    <column-definition>\n      <column-index>10</column-index>\n      <auto-increment>false</auto-increment>\n      <case-sensitive>false</case-sensitive>\n      <currency>true</currency>\n      <nullable>1</nullable>\n      <signed>true</signed>\n      <searchable>true</searchable>\n      <column-display-size>21</column-display-size>\n      <column-label>LOTDEM_CODE</column-label>\n      <column-name>LOTDEM_CODE</column-name>\n      <schema-name></schema-name>\n      <column-precision>8</column-precision>\n      <column-scale>0</column-scale>\n      <table-name></table-name>\n      <catalog-name></catalog-name>\n      <column-type>2</column-type>\n      <column-type-name>NUMBER</column-type-name>\n    </column-definition>\n  </metadata>\n  <data>\n    <row>\n      <col>1</col>\n      <col>2003</col>\n      <col>APA-Dupont</col>\n      <col>Test CGIS - Type de demande 1</col>\n      <col>TRESORIER CAJARC</col>\n      <col>Dept. des routes (exe)</col>\n      <col>Sold\u00e9e</col>\n      <col>Non</col>\n      <col>15</col>\n      <col>66</col>\n    </row>\n    <row>\n      <col>2</col>\n      <col>2003</col>\n      <col>APA-Durand</col>\n      <col>Aide principale</col>\n      <col>MARS</col>\n      <col>Fonctions de bases 1 (exe)</col>\n      <col>Enregistr\u00e9e</col>\n      <col>Non</col>\n      <col>1498</col>\n      <col>0</col>\n    </row>\n  </data>\n</RowSet>\n\nAnd this is my XSL stylesheet :\n<?xml version=\"1.0\" encoding=\"iso-8859-1\"?>\n\n<xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"\n                              xmlns:gmr=\"http://www.gnome.org/gnumeric/v7\" >\n<xsl:output method=\"xml\"\n            version=\"4.0\"\n            doctype-public=\"-//W3C//DTD HTML 4.0 Transitional//EN\"\n            encoding=\"iso-8859-1\"\n            indent=\"yes\"/>\n\n  <xsl:template match=\"RowSet\">\n   <gmr:Workbook xmlns:gmr=\"http://www.gnome.org/gnumeric/v7\">\n     <gmr:Sheets>\n       <xsl:call-template name=\"worksheet1\" />\n \t   <xsl:call-template name=\"worksheet2\" />\n     </gmr:Sheets>\n    </gmr:Workbook>\n  </xsl:template>\n\n\n\n  <xsl:template name=\"WorkbookAttributes\">\n  \n  \t<gmr:Attributes>\n    \t<gmr:Attribute>\n      \t\t<gmr:name>WorkbookView::show_horizontal_scrollbar</gmr:name>\n      \t\t<gmr:type>4</gmr:type>\n      \t\t<gmr:value>TRUE</gmr:value>\n    \t</gmr:Attribute>\n    \t<gmr:Attribute>\n      \t\t<gmr:name>WorkbookView::show_vertical_scrollbar</gmr:name>\n      \t\t<gmr:type>4</gmr:type>\n      \t\t<gmr:value>TRUE</gmr:value>\n    \t</gmr:Attribute>\n    \t<gmr:Attribute>\n      \t\t<gmr:name>WorkbookView::show_notebook_tabs</gmr:name>\n      \t\t<gmr:type>4</gmr:type>\n      \t\t<gmr:value>TRUE</gmr:value>\n    \t</gmr:Attribute>\n  \t</gmr:Attributes>\n  \t\n  </xsl:template>\n  \n  <xsl:template name=\"DocumentProperties\">\n  <gmr:Summary>\n    <gmr:Item>\n      <gmr:name>codepage</gmr:name>\n      <gmr:val-string>1252</gmr:val-string>\n    </gmr:Item>\n    <gmr:Item>\n      <gmr:name>last_saved</gmr:name>\n      <gmr:val-string/>\n    </gmr:Item>\n    <gmr:Item>\n      <gmr:name>created</gmr:name>\n      <gmr:val-string/>\n    </gmr:Item>\n    <gmr:Item>\n      <gmr:name>security</gmr:name>\n      <gmr:val-int>0</gmr:val-int>\n    </gmr:Item>\n    <gmr:Item>\n      <gmr:name>thumbnail_scaling</gmr:name>\n      <gmr:val-string>False</gmr:val-string>\n    </gmr:Item>\n    <gmr:Item>\n      <gmr:name>links_uptodate</gmr:name>\n      <gmr:val-string>False</gmr:val-string>\n    </gmr:Item>\n    <gmr:Item>\n      <gmr:name>last_author</gmr:name>\n      <gmr:val-string>Unilog IT Service GDA</gmr:val-string>\n    </gmr:Item>\n    <gmr:Item>\n      <gmr:name>application</gmr:name>\n      <gmr:val-string>Microsoft Excel</gmr:val-string>\n    </gmr:Item>\n    <gmr:Item>\n      <gmr:name>author</gmr:name>\n      <gmr:val-string>Unilog IT Service Grand Angle</gmr:val-string>\n    </gmr:Item>\n    <gmr:Item>\n      <gmr:name>company</gmr:name>\n      <gmr:val-string>Unilog Grand Angle</gmr:val-string>\n    </gmr:Item>\n  </gmr:Summary>\n  </xsl:template>\n  \n  \n  <xsl:template name=\"worksheet2\">\n \n         <gmr:Sheet DisplayFormulas=\"false\" HideZero=\"false\" HideGrid=\"false\"\nHideColHeader=\"false\" HideRowHeader=\"false\" DisplayOutlines=\"true\"\nOutlineSymbolsBelow=\"true\" OutlineSymbolsRight=\"true\">\n\t         <gmr:Name>Feuille supplementaire</gmr:Name>\n        \t <xsl:call-template name=\"ColsInfo\" />\n        \t <xsl:call-template name=\"RowsInfo\" />\n        \t <xsl:call-template name=\"SelectionInfo\" />\n        \t <xsl:call-template name=\"ObjectsInfo\" />\n \t\t \t <gmr:Cells>\n     \t\t\t\t<gmr:Cell Col=\"0\" Row=\"0\" ValueType=\"60\">\n          \t\t\t<gmr:Content><null/></gmr:Content>\n        \t</gmr:Cell>    \t\t\t\n        </gmr:Cells> \n     \t</gmr:Sheet>\n  </xsl:template>\n  \n  \n  <xsl:template name=\"worksheet1\">\n  \n  \t\t<gmr:Sheet DisplayFormulas=\"false\" HideZero=\"false\" HideGrid=\"false\"\nHideColHeader=\"false\" HideRowHeader=\"false\" DisplayOutlines=\"true\"\nOutlineSymbolsBelow=\"true\" OutlineSymbolsRight=\"true\">\n\t         <gmr:Name>Donnees Exportees</gmr:Name>\n        \t \n        \t <xsl:call-template name=\"ColsInfo\" />\n        \t <xsl:call-template name=\"RowsInfo\" />\n        \t <xsl:call-template name=\"SelectionInfo\" />\n        \t <xsl:call-template name=\"ObjectsInfo\" />\n        \t \n     \t\t <xsl:call-template name=\"Cells\"/>\n     \t\t \n     \t</gmr:Sheet>   \n   </xsl:template>   \t\n     \t\n    \n   <xsl:template name=\"ColsInfo\">\n    <gmr:Cols DefaultSizePts=\"60\">\n        <gmr:ColInfo No=\"0\" Unit=\"78.8\" MarginA=\"2\" MarginB=\"2\" HardSize=\"1\"/>\n    </gmr:Cols>\n     </xsl:template>\n     \n     <xsl:template name=\"RowsInfo\">\n      <gmr:Rows DefaultSizePts=\"12.8\">\n        <gmr:RowInfo No=\"0\" Unit=\"17.2\" MarginA=\"0\" MarginB=\"0\" HardSize=\"1\"\nCount=\"13\"/>\n      </gmr:Rows>\n     </xsl:template>\n      \n     <xsl:template name=\"SelectionInfo\">\n      <gmr:Selections CursorCol=\"1\" CursorRow=\"1\">\n        <gmr:Selection startCol=\"1\" startRow=\"1\" endCol=\"1\" endRow=\"1\"/>\n      </gmr:Selections>\n     </xsl:template> \n    \n     <xsl:template name=\"ObjectsInfo\">  \n      <gmr:Objects>\n        <gmr:SheetObjectFilled />\n      </gmr:Objects>\n   </xsl:template>   \n   \n   \n   <xsl:template name=\"Cells\">   \n   \t\t<gmr:Cells>\n     \t\t\t<xsl:apply-templates select=\"metadata\"/>\n     \t\t\t<xsl:apply-templates select=\"data\"/>    \t\t\t\n        </gmr:Cells>   \n   </xsl:template>   \n   \n   <xsl:template match=\"metadata\">  \n   \t\t<xsl:apply-templates select=\"column-definition\"/>\n   </xsl:template>\n   \n   \n   <xsl:template match=\"column-definition\"> \n   \n   \t\t<xsl:variable name=\"cpt\" select=\"position()-1\"/>\n          \n   \t\t<gmr:Cell Col=\"{$cpt}\" Row=\"0\" ValueType=\"60\">\n   \t\t\t<gmr:Content><xsl:value-of select=\"column-label\"/></gmr:Content>\n        </gmr:Cell> \n        \n   </xsl:template>\n   \n   <xsl:template match=\"data\"> \n   \t\t \n   \t\t<xsl:for-each select=\"row\">\n         \n            <xsl:apply-templates select=\"col\">\n            \t<xsl:with-param name=\"numRow\" select=\"position()\" />\n            </xsl:apply-templates>\n             \n      </xsl:for-each>\t\n   \t\t\n   </xsl:template>\n   \n   \n    <xsl:template match=\"col\"> \n    \t<xsl:param name=\"numRow\"/>\n    \t<xsl:variable name=\"cpt\" select=\"position()-1\"/>\n    \t\n    \t\n   \t\t<gmr:Cell Col=\"{$cpt}\" Row=\"{$numRow}\" >\n   \t\t\t<xsl:call-template name=\"type\"/>\n          \t<gmr:Content><xsl:value-of select=\".\"/></gmr:Content>\n        </gmr:Cell> \n        \n   </xsl:template>\n     \t\n \t<xsl:template name=\"styles\">\n      \n    </xsl:template>\n    \n   \n   <xsl:template name=\"type\">\n    \n    <xsl:variable name=\"cpteur\" select=\"position()\"/>\n    <xsl:variable name=\"type\"\nselect=\"//metadata/column-definition[$cpteur]/column-type\" />\n    \n    \t<xsl:choose>   \n    \t  <!-- Nombres :  Mysql 2 == DECIMAL\n    \t  \t\t\t \t  Oracle 3 == Number   -->    \t\t\t\t\n          <xsl:when test=\"$type=2 or $type=3\">\n          \t\t<xsl:attribute name=\"ValueType\">40</xsl:attribute>\n          </xsl:when>\n          <!-- Date :  Mysql 91\n    \t  \t\t\t \t  Oracle 93 -->\n          <xsl:when test=\"$type=91 or $type=93\">\n          \t \t <!-- <xsl:attribute name=\"ss:Type\">DateTime</xsl:attribute> -->\n          \t \t <xsl:attribute name=\"ValueType\">60</xsl:attribute>\n          </xsl:when> \n          <xsl:otherwise>\n          \t\t<xsl:attribute name=\"ValueType\">60</xsl:attribute>\n          </xsl:otherwise>\n     \t</xsl:choose>\n     \t\t\n    </xsl:template> \n    \n</xsl:stylesheet>\n\n\nPlease help.", "id": 30997, "time": "2003-02-10T11:30:07Z", "bug_id": 16926, "creation_time": "2003-02-10T11:30:07Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "poi-support@buni.org", "text": "Bugzilla is NOT where you ask questions.  See the mail list.", "id": 31001, "time": "2003-02-10T13:44:31Z", "bug_id": 16926, "creation_time": "2003-02-10T13:44:31Z", "is_private": false, "attachment_id": null}]