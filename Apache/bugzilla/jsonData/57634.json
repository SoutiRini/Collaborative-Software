[{"count": 0, "tags": [], "text": "After update to poi 3.11, picture resizing works incorrect. It stretches picture by height and width with methods Picture.resize(double) and Picture.resize(double, double) for XSSFPicture.\n\nSteps to reproduce:\n1. Load image less by size than target cell.\n2. Create anchor and set col1 and row1\n3. Put image on anchor\n4. Resize it by Picture.resize(). Now we adjusted anchor to image size.\n5. Resize it again with Picture.resize(1.0).\n6. Write workbook.\n\nWhat is expected:\n\nPicture with original size.\n\nWhat is actual:\n\nPicture is stretched by width and height with different scale.\n\n\n\nThe problem in new method\nDimension org.apache.poi.ss.util.ImageUtils.getDimensionFromAnchor(Picture picture).\nLine 231 and 251: w = sheet.getColumnWidthInPixels(col2++); h = getRowHeightInPixels(sheet,row2++); Here we ALWAYS take cell dimension and in next steps add additional sizes based on getDy2 and getDx2.", "is_private": false, "bug_id": 57634, "id": 181317, "time": "2015-02-25T09:37:46Z", "creator": "solid.danil@gmail.com", "creation_time": "2015-02-25T09:37:46Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 57634, "attachment_id": null, "text": "Are you able to produce a junit unit test showing the problem, and/or a patch to correct the logic?", "id": 181318, "time": "2015-02-25T09:40:34Z", "creator": "apache@gagravarr.org", "creation_time": "2015-02-25T09:40:34Z", "is_private": false}, {"count": 2, "tags": [], "text": "Have you looked into my comment in #55967? (the original issue to image resizing)\n\nIf you aren't satisfied with the reasoning, please reopen and continue the discussion there\n\n*** This bug has been marked as a duplicate of bug 55967 ***", "attachment_id": null, "id": 181330, "creator": "kiwiwings@apache.org", "time": "2015-02-25T14:45:16Z", "bug_id": 57634, "creation_time": "2015-02-25T14:45:16Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 57634, "is_private": false, "text": "Yes, I read your comment and saw what you did.\nHave you tried steps to reproduce it which were provided here?\n\nWill provide test or/and patch in process of time.", "id": 181332, "time": "2015-02-25T14:51:35Z", "creator": "solid.danil@gmail.com", "creation_time": "2015-02-25T14:51:35Z", "attachment_id": null}]