[{"count": 0, "tags": [], "bug_id": 45652, "text": "Created attachment 22455\nTest JSP\n\nHi everyone,\n\nThere is an old post from Matt Raible regarding an XSS vulnerability present in all tomcat installations by default:\nhttp://raibledesigns.com/rd/entry/java_web_frameworks_and_xss\n\nThe JSP I have attached shows a quick-and-dirty test to inject arbitrary HTML into your page using EL expressions like ${foobar}. I know that \"<c:out>\" can be used as a workaround, but it is quite verbose and easy to miss.\n\nAs part of my job as a developer of Loom (http://www.loom.extrema-sistemas.com/) I have prepared a patch for Generator.java so XML content obtained from EL expressions can be configured to be escaped defaulting to false (to keep current behavior, but maybe true would be the safe bet here).\n\nRegards\nRafa", "id": 119919, "time": "2008-08-19T08:15:41Z", "creator": "werkins@gmail.com", "creation_time": "2008-08-19T08:15:41Z", "is_private": false, "attachment_id": 22455}, {"count": 1, "attachment_id": 22456, "bug_id": 45652, "is_private": false, "id": 119920, "time": "2008-08-19T08:19:06Z", "creator": "werkins@gmail.com", "creation_time": "2008-08-19T08:19:06Z", "tags": [], "text": "Created attachment 22456\nPatch\n\nHere is the patch for the trunk.\n\nTo start escaping XML content just add \"-Dgenerator.escapeXml=true\" to your VM arguments."}, {"count": 2, "tags": [], "bug_id": 45652, "attachment_id": null, "id": 119968, "time": "2008-08-20T16:41:04Z", "creator": "markt@apache.org", "creation_time": "2008-08-20T16:41:04Z", "is_private": false, "text": "I don't see a need for this to be a system property. It should be another parameter on the JSP Servlet like trimSpaces. Could you re-work the patch?"}, {"count": 3, "tags": [], "creator": "werkins@gmail.com", "is_private": false, "text": "Created attachment 22472\nReworked patch\n\nHi Mark,\n\nI think you are right about the way this should be configured, so here is the new patch. The JspServlet parameter to en/disable XML escaping is named escapeXml.\n\nBTW, I have changed the current behavior, so ${foo} escapes XML by default.\n\nRegards\nRafa", "id": 120023, "time": "2008-08-22T05:50:40Z", "bug_id": 45652, "creation_time": "2008-08-22T05:50:40Z", "attachment_id": 22472}, {"count": 4, "tags": [], "bug_id": 45652, "text": "Thanks for this. There are some other EL issues I want to get fixed first and then I'll look at integrating this patch. I'll change the default though to the current, spec compliant, behaviour.", "id": 120024, "attachment_id": null, "creator": "markt@apache.org", "creation_time": "2008-08-22T06:03:18Z", "time": "2008-08-22T06:03:18Z", "is_private": false}, {"count": 5, "attachment_id": null, "bug_id": 45652, "is_private": false, "id": 120032, "time": "2008-08-22T07:43:09Z", "creator": "remm@apache.org", "creation_time": "2008-08-22T07:43:09Z", "tags": [], "text": "The default value should probably be (! strict_spec_complaince), and the name of the parameter should be fixed so that it refers to EL. escapeElOutput ?"}, {"count": 6, "tags": [], "bug_id": 45652, "attachment_id": null, "id": 120090, "time": "2008-08-25T23:27:16Z", "creator": "mraible@apache.org", "creation_time": "2008-08-25T23:27:16Z", "is_private": false, "text": "This seems similar to the enhancement request I added last September:\n\nhttps://issues.apache.org/bugzilla/show_bug.cgi?id=43497"}, {"count": 7, "text": "\n\n*** This bug has been marked as a duplicate of bug 43497 ***", "creator": "markt@apache.org", "is_private": false, "id": 120241, "time": "2008-08-31T10:34:16Z", "bug_id": 45652, "creation_time": "2008-08-31T10:34:16Z", "tags": [], "attachment_id": null}]