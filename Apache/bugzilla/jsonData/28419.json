[{"count": 0, "tags": [], "bug_id": 28419, "attachment_id": null, "id": 55860, "time": "2004-04-15T21:16:17Z", "creator": "tmpuser@scummer.org", "creation_time": "2004-04-15T21:16:17Z", "is_private": false, "text": "I've encountered an issue with the Jar task, evidenced by the\nsequence contained in the sample build.xml content below:\n\n===== BEGIN build.xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project basedir=\".\" default=\"bugdemo\" name=\"Jar deletion bug demo\">\n\n        <target name=\"bugdemo\">\n                <echo message=\"Remove any existing jar file\" />\n                <delete file=\"bugdemo.jar\" />\n                <exec executable=\"/bin/ls\">\n                        <arg value=\"-la\" />\n                        <arg value=\"bugdemo.jar\" />\n                </exec>\n\n                <echo message=\"Create a read-only jar file\" />\n                <touch file=\"fileone\"/>\n                <jar basedir=\".\" includes=\"fileone\" destfile=\"bugdemo.jar\" />\n                <chmod file=\"bugdemo.jar\" perm=\"444\" verbose=\"true\" />\n                <exec executable=\"/bin/ls\">\n                        <arg value=\"-la\" />\n                        <arg value=\"bugdemo.jar\" />\n                </exec>\n\n                <echo message=\"Try to overwrite the read-only jar file\" />\n                <touch file=\"filetwo\"/>\n                <jar basedir=\".\" includes=\"filetwo\" destfile=\"bugdemo.jar\" />\n\n                <!-- This line not reached... -->\n\n                <exec executable=\"/bin/ls\">\n                        <arg value=\"-la\" /> \n                        <arg value=\"bugdemo.jar\" />\n                </exec>\n        </target>\n</project>\n===== END build.xml\n\nWhen executed, the above produces the following output:\n\n=====  BEGIN OUTPUT\nBuildfile: build.xml\n\nbugdemo:\n     [echo] Remove any existing jar file\n     [exec] bugdemo.jar: No such file or directory\n\n\n     [exec] Result: 2\n     [echo] Create a read-only jar file\n      [jar] Building jar: /home/mcumings/cvs/swie/Project/jaxb/bugdemo.jar\n\n\n    [chmod] Applied chmod to 1 file and 0 directories.\n     [exec] -r--r--r--   1 mcumings staff        418 Apr 15 14:08 bugdemo.jar\n\n\n     [echo] Try to overwrite the read-only jar file\n      [jar] Building jar: /home/mcumings/cvs/swie/Project/jaxb/bugdemo.jar\n\nBUILD FAILED\n/home/mcumings/cvs/swie/Project/jaxb/build.xml:23: Problem creating jar: \n/home/mcumings/cvs/swie/Project/jaxb/bugdemo.jar (Permission denied)\n\n    Total time: 6 seconds\n=====  END OUTPUT\n\nThe problem lies in the fact that in the process of failing, the Jar\ntask seems to like to remove the read-only jar file target, as evidenced\nin the following output of 'ls -la':\n\n===== BEGIN OUTPUT\ntotal 25\ndrwxr-xr-x   2 user staff         512 Apr 15 14:08 ./\ndrwxr-xr-x  33 user staff        1024 Apr 14 12:22 ../\n-rw-r--r--   1 user staff         907 Apr 15 14:07 build.xml\n-rw-r--r--   1 user staff           0 Apr 15 14:08 fileone\n-rw-r--r--   1 user staff           0 Apr 15 14:08 filetwo\n===== END OUTPUT\n\nMy use of Ant in this case is a bit out of the ordinary, but read/write\npermissions setup by the operating system should be observed and handled\nproperly within Ant."}, {"count": 1, "attachment_id": null, "creator": "bodewig@apache.org", "text": "I can reproduce that.  Strange that Java doesn'r obey the permissions here.\n\nInvestigating.", "id": 55880, "time": "2004-04-16T09:25:02Z", "bug_id": 28419, "creation_time": "2004-04-16T09:25:02Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "creator": "bodewig@apache.org", "text": "fixed in CVS.\n\nI also checked that <tar> doesn't show the same problem.", "id": 55881, "time": "2004-04-16T09:36:12Z", "bug_id": 28419, "creation_time": "2004-04-16T09:36:12Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 28419, "text": "in answer to the java being allowed to delete a read-only file,\nthe delete previlage is for the directory and not the file.", "id": 55882, "attachment_id": null, "creator": "peter.reilly@corvil.com", "creation_time": "2004-04-16T09:47:40Z", "time": "2004-04-16T09:47:40Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 28419, "attachment_id": null, "is_private": false, "id": 55883, "time": "2004-04-16T09:54:51Z", "creator": "bodewig@apache.org", "creation_time": "2004-04-16T09:54:51Z", "text": "I knew that as soon as I pressed the submit button 8-)\n\nThanks anyway."}]