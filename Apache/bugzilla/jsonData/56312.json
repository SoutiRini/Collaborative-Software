[{"count": 0, "tags": [], "bug_id": 56312, "attachment_id": null, "text": "Let's take an example config that configures 3 different balancer workers named cluster_100, cluster_200, cluster_300 that each have a different timeout of 100s, 200s and 300s. Now we want to ProxyPass specific application paths to those configured workers as we know that those different applications need different timeout values to handle requests properly e.g. /ajax/test_200 needs up to 200s to write a response to a request so we map it to balancer://cluster_200/ajax/test_200.\n\n<IfModule mod_proxy_http.c>\n  ProxyRequests Off\n  ProxyStatus On\n  ProxyPreserveHost On\n\n  <IfModule mod_status.c>\n    <Location /balancer-manager>\n      SetHandler balancer-manager\n      Order Allow,Deny\n      Allow from all\n    </Location>\n  </IfModule>\n\n  # Define default Proxy container\n  <Proxy balancer://cluster_100>\n      Order deny,allow\n      Allow from all\n      BalancerMember http://127.0.0.1:8009 timeout=100 smax=0 ttl=60 retry=0 loadfactor=50 keepalive=On route=member1\n      #BalancerMember http://your_additional_member:8009 timeout=100 smax=0 ttl=60 retry=0 loadfactor=50 keepalive=On route=member2\n      ProxySet stickysession=JSESSIONID|jsessionid scolonpathdelim=On\n      SetEnv proxy-initial-not-pooled\n      SetEnv proxy-sendchunked\n  </Proxy>\n\n  <Proxy balancer://cluster_200>\n      Order deny,allow\n      Allow from all\n      BalancerMember http://127.0.0.1:8009 timeout=200 smax=0 ttl=60 retry=0 loadfactor=50 keepalive=On route=member1\n      #BalancerMember http://your_additional_member:8009 timeout=200 smax=0 ttl=60 retry=0 loadfactor=50 keepalive=On route=member2\n      ProxySet stickysession=JSESSIONID|jsessionid scolonpathdelim=On\n      SetEnv proxy-initial-not-pooled\n      SetEnv proxy-sendchunked\n  </Proxy>\n\n  <Proxy balancer://cluster_300>\n      Order deny,allow\n      Allow from all\n      BalancerMember http://127.0.0.1:8009 timeout=300 smax=0 ttl=60 retry=0 loadfactor=50 keepalive=On route=member1\n      #BalancerMember http://your_additional_member:8009 timeout=300 smax=0 ttl=60 retry=0 loadfactor=50 keepalive=On route=member2\n      ProxySet stickysession=JSESSIONID|jsessionid scolonpathdelim=On\n      SetEnv proxy-initial-not-pooled\n      SetEnv proxy-sendchunked\n  </Proxy>\n\n  ProxyPass /ajax/test_100        balancer://cluster_100/ajax/test_100\n  ProxyPass /ajax/test_200        balancer://cluster_200/ajax/test_200\n  ProxyPass /ajax/test_300        balancer://cluster_300/ajax/test_300\n  ProxyPass /ajax                 balancer://cluster_100/ajax\n  ProxyPass /servlet              balancer://cluster_100/servlet\n\n</IfModule>\n\nAll of this works as expected in 2.4.6.\n\nTesting this with 2.2.16 (debian squeeze) or 2.2.22 (debian wheezy) though fails as requests to /ajax/test_200 which need 200s or to /ajax/test_300 which need 300s to return a result are terminated after 100s, the timeout configured for balancer://cluster_100.\n\n\nRaising the LogLevel to debug informs us about the following:\n service apache2 restart\n[....] Restarting web server: apache2[Tue Mar 25 17:18:30 2014] [info] worker http://192.168.32.50:8009 already used by another worker\n[Tue Mar 25 17:18:30 2014] [info] worker http://192.168.32.50:8009 already used by another worker\n ... waiting [Tue Mar 25 17:18:31 2014] [info] worker http://192.168.32.50:8009 already used by another worker\n[Tue Mar 25 17:18:31 2014] [info] worker http://192.168.32.50:8009 already used by another worker\n. ok", "id": 174074, "time": "2014-03-25T16:21:39Z", "creator": "marc.arens@open-xchange.com", "creation_time": "2014-03-25T16:21:39Z", "is_private": false}]