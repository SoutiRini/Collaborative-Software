[{"count": 0, "tags": [], "creator": "akerr@fluid.com", "is_private": false, "id": 635, "attachment_id": null, "bug_id": 567, "creation_time": "2001-02-09T11:17:11Z", "time": "2001-02-09T11:17:11Z", "text": "Suppose I have two <security-constraints> set up in my web app's web.xml file.  \nOne of them pertains to the <url-pattern> \"/abc/*\", while the other pertains to \n\"/abc123/*\"\n\nNow suppose I attempt to access the URL /abc123/test.jsp.\n\nAccessInterceptor incorrectly determines that both <url-patterns> /abc/* and \n/abc123/* match this URL, which can mess up the authorization process.\n\nThe code in question is in AccessInterceptor.match():\n\ncase Container.PREFIX_MAP:\n  return path.startsWith( ctPath.substring(0, ctPathL - 2  ));\n\nIt seems to me that changing this to ...\n\ncase Container.PREFIX_MAP:\n  return path.startsWith( ctPath.substring(0, ctPathL - 1  ));\n\n...would correct the problem, since the trailing '/' would cause us to no longer \nmatch /abc/.\n\nSection 10.1 of the 2.2 servlet spec seems to indicate that this fix would cause \nthe desired behaviour."}, {"count": 1, "tags": [], "bug_id": 567, "text": "Fixed for Tomcat 3.2.2", "id": 671, "time": "2001-02-13T19:51:29Z", "creator": "marc.saegesser@apropos.com", "creation_time": "2001-02-13T19:51:29Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 567, "attachment_id": null, "id": 716, "time": "2001-02-15T20:10:28Z", "creator": "Larry.Isaacs@sas.com", "creation_time": "2001-02-15T20:10:28Z", "is_private": false, "text": "According to the spec, a servlet mapped to the url-pattern \"/abc/*\" should\nbe invoked if the URL \"/abc\" is used.  The proposed fix allows \"/abc\" to fail\nto match \"/abc/*\" when used in a security-constraint, allowing it to escape\nauthorization.  \n\nThe Tomcat 3.3 version of the fix has been applied, which avoids this problem.\n\nFor query purposes, mark as fixed in Tomcat 3.2.2 and Tomcat 3.3.\nFixed in Tomcat 3.2.2\nFixed in Tomcat 3.3\n"}]