[{"count": 0, "tags": [], "bug_id": 60366, "text": "catalina.bat adds logging manager and logging configuration parameters to JAVA_OPTS. This can cause issues when sub-processes are spawned. As far as I understand, the sub-process tries to use java.util.logging but throws an ClassNotFoundException because org.apache.juli.ClassLoaderLogManager is not on classpath.\n\nThis has already been solved for catalina.sh back in 2013, see bug 54601 for further explanations (https://bz.apache.org/bugzilla/show_bug.cgi?id=54601)\n\nThe same issuses as described in bug 54601, with Jenkins and Gradle, are still present in the Windows version of Tomcat 8.5.8. Since the catalina.bat file looks the same in this regard for tomcat 7 and 9 it is reasonable to believe these versions are affected as well.\n\nA solution similar to the one for catalina.sh solves the issue for me.\n\nRemove the assignments to JAVA_OPTS in lines 213 and 218 and add the LOGGING_CONFIG and LOGGING_MANAGER variables to where the JAVA_OPTS is used in lines 336, 339, 343, 346\n\n208 if not \"%LOGGING_CONFIG%\" == \"\" goto noJuliConfig\n209 set LOGGING_CONFIG=-Dnop\n210 if not exist \"%CATALINA_BASE%\\conf\\logging.properties\" goto noJuliConfig\n211 set LOGGING_CONFIG=-Djava.util.logging.config.file=\"%CATALINA_BASE%\\conf\\logging.properties\"\n212 :noJuliConfig\n213 - set \"JAVA_OPTS=%JAVA_OPTS% %LOGGING_CONFIG%\"\n214\n215 if not \"%LOGGING_MANAGER%\" == \"\" goto noJuliManager\n216 set LOGGING_MANAGER=-Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager\n217 :noJuliManager\n218 - set \"JAVA_OPTS=%JAVA_OPTS% %LOGGING_MANAGER%\"\n\n336 - %_EXECJAVA% %JAVA_OPTS% %CATALINA_OPTS% %DEBUG_OPTS% -classpath \"%CLASSPATH%\"\n336 + %_EXECJAVA% %LOGGING_CONFIG% %LOGGING_MANAGER% %JAVA_OPTS% %CATALINA_OPTS% %DEBUG_OPTS% -classpath \"%CLASSPATH%\"", "id": 194957, "time": "2016-11-13T20:59:14Z", "creator": "icermann@gmail.com", "creation_time": "2016-11-13T20:59:14Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 60366, "attachment_id": null, "id": 195067, "time": "2016-11-17T19:44:12Z", "creator": "violetagg@apache.org", "creation_time": "2016-11-17T19:44:12Z", "is_private": false, "text": "Hi,\n\nThanks for the report and the patch.\nThis has been fixed in\n- 9.0.x for 9.0.0.M14 onwards\n- 8.5.x for 8.5.9 onwards\n- 8.0.x for 8.0.40 onwards and\n- 7.0.x for 7.0.74 onwards\n\nRegards,\nVioleta"}]