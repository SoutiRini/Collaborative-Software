[{"count": 0, "tags": [], "bug_id": 49878, "attachment_id": null, "id": 139668, "time": "2010-09-03T10:53:16Z", "creator": "martin.studer@mirai-solutions.com", "creation_time": "2010-09-03T10:53:16Z", "is_private": false, "text": "setSheetHidden on an XSSF workbook does not work as documented. Basically, I found that \n\nint hidden = 2 --> means 'hidden'\nint hidden = 3 --> means 'very hidden'\n\ninstead of as documented:\nint hidden = 1 --> means 'hidden'\nint hidden = 2 --> means 'very hidden'\n\nOn HSSF workbooks setSheetHidden is working fine and as documented.\n\nPOI: 3.7-beta2\nOS: Windows 7 64bit\nJava: 1.6.0_20 64bit"}, {"count": 1, "tags": [], "bug_id": 49878, "attachment_id": null, "id": 139669, "time": "2010-09-03T11:08:14Z", "creator": "apache@gagravarr.org", "creation_time": "2010-09-03T11:08:14Z", "is_private": false, "text": "Any chance you could upload a simple .xlsx file, which has 3 sheets? One should be normal, one hidden, and one very hidden\n\nWe can then use this as a basis for a unit test for when we fix this.\n\n(HSSF and XSSF should be using the same meaning for the hidden flags, so it's probably an off-by-one in the xssf code somewhere)"}, {"count": 2, "tags": [], "text": "Created attachment 25985\nXSSF workbook with a series of sheets some of which are hidden and very hidden\n\nXSSF workbook with 5 sheets: AAA, BBB, CCC, DDD, EEE\n\nSheet 'BBB' is hidden\nSheet 'DDD' is very hidden\n\nthe rest of the sheets are normally visible (not hidden)", "attachment_id": 25985, "bug_id": 49878, "id": 139670, "time": "2010-09-03T11:12:35Z", "creator": "martin.studer@mirai-solutions.com", "creation_time": "2010-09-03T11:12:35Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 49878, "attachment_id": null, "id": 139703, "time": "2010-09-05T09:09:48Z", "creator": "yegor@dinom.ru", "creation_time": "2010-09-05T09:09:48Z", "is_private": false, "text": "Fixed in r992772.\n\nNick is right, it was a off-by-one issue. On the low level, the 'hidden' argument is converted into a XmlBeans enum and in XmlBeans ordinals of enums start with 1. \n\nI also improved the API. Passing an anonymous constant as the second argument of setSheetHidden(int sheetIx, int hidden) is not good. \n\nI added three constants to the Workbook interface:\n\nWorkbook.SHEET_STATE_VISIBLE\nWorkbook.SHEET_STATE_HIDDEN\nWorkbook.SHEET_STATE_VERY_HIDDEN\n\nthe correct usage of setSheetHidden is as  follows:\n\nworkbook.setSheetHidden(sheetIx, Workbook.SHEET_STATE_HIDDEN).\n\nThe method throws IllegalArgumentException if the view state is invalid.\n\n\nYegor"}]