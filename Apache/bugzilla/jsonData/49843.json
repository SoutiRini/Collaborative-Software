[{"count": 0, "tags": [], "creator": "i8c.alex@gmail.com", "attachment_id": null, "id": 139553, "time": "2010-08-30T07:39:00Z", "bug_id": 49843, "creation_time": "2010-08-30T07:39:00Z", "is_private": false, "text": "The DateUtil.getJavaDate() service uses a calendar with the local timezone to transform an excel double into a java.util.Date.\n\nConsider however the following example:\nA user fills in \"00:00\" in a cell and formats it as a time. The user then \"drags\" the bottom right corner downwards until row \"27\" is reached. This row will read \"02:00:00\". \n\nBecause excel starts counting on the 31st of december 1899, rows 25, 26 and 27 are times expressed on the 1st of january 1900. Suppose that the system default for timezone is \"Europe/Paris\". If i then wish to format that date with SimpleDateFormat with timezone set to the same default, everything works fine:\n1899-12-31 22:00:00 CET \n1899-12-31 23:00:00 CET \n1900-01-01 00:00:00 CET \n1900-01-01 01:00:00 CET \n1900-01-01 02:00:00 CET \n\nHowever if we set the timezone of the simpledateformat to \"UTC\", we get the following:\n1899-12-31 22:00:00 UTC \n1899-12-31 23:00:00 UTC \n1900-01-01 00:50:39 UTC \n1900-01-01 01:50:39 UTC \n\nIf we set the system timezone to UTC (so the calendar uses UTC) then everything works again. Also note the results for default timezone \"Europe/Brussels\" with formatting for \"UTC\":\n1899-12-31 22:00:00 UTC \n1900-01-01 00:00:00 UTC \n1900-01-01 01:00:00 UTC \n1900-01-01 02:00:00 UTC \n\nCan we get an overloaded getJavaDate() call where we can define the timezone for the calendar in question?\n\nThe attachment is an example xlsx with java code."}, {"text": "Excel dates don't have timezones attached to them\n\nAs such, when working with the dates, you need to remember this!\n\nYou should therefore either correct the timezone where known in your code, or ensure that your DateFormats are equally timezone naive. If you try to mix timezone naive and timezone specified things, it'll probably go wrong. There's a reason why Python warns you of this...", "tags": [], "bug_id": 49843, "attachment_id": null, "count": 1, "id": 139722, "time": "2010-09-06T11:30:04Z", "creator": "apache@gagravarr.org", "creation_time": "2010-09-06T11:30:04Z", "is_private": false}]