[{"count": 0, "tags": [], "bug_id": 56314, "text": "This issue is similar to Bug 43857 - exiting prefork child doesn't clear request pool. The bug 43857 is related to prefork child, this is related to mpm-worker child.\n\nstack trace:\n\nThread 1 (Thread 0x7fafad5e0740 (LWP 14219)):\n#0  0x00007fafac77b425 in raise () from /lib/x86_64-linux-gnu/libc.so.6\nNo symbol table info available.\n#1  0x00007fafac77eb8b in abort () from /lib/x86_64-linux-gnu/libc.so.6\nNo symbol table info available.\n#2  0x00007fafac7740ee in ?? () from /lib/x86_64-linux-gnu/libc.so.6\nNo symbol table info available.\n#3  0x00007fafac774192 in __assert_fail () from /lib/x86_64-linux-gnu/libc.so.6\nNo symbol table info available.\n#4  0x00007fafacf7ce3f in reslist_cleanup (data_=0x7fafae9e8bd0) at misc/apr_reslist.c:161\n        rv = 0\n        rl = 0x7fafae9e8bd0\n        res = 0x7fffb9044920\n        __PRETTY_FUNCTION__ = \"reslist_cleanup\"\n#5  0x00007fafacd40c30 in run_cleanups (cref=0x7fafae9e8b78) at memory/unix/apr_pools.c:2352\n        c = 0x7fafae9e8d10\n#6  0x00007fafacd3fabf in apr_pool_destroy (pool=0x7fafae9e8b58) at memory/unix/apr_pools.c:814\n        active = 0x7fafaeaed640\n        allocator = 0x7fafae8be010\n#7  0x00007fafacd3faa2 in apr_pool_destroy (pool=0x7fafae95a268) at memory/unix/apr_pools.c:811\n        active = 0x7fafae95a268\n        allocator = 0x7fafaeb8aa08\n#8  0x00007fafad67895e in clean_child_exit (code=0) at worker.c:430\nNo locals.\n#9  0x00007fafad67ad59 in child_main (child_num_arg=11) at worker.c:1367\n        threads = 0x7fafaecd9cf0\n        rv = 1\n        ts = 0x7fafae95be10\n        thread_attr = 0x7fafae95be30\n        start_thread_id = 0x7fafae95be90\n#10 0x00007fafad67ae58 in make_child (s=0x7fafae8ed4c0, slot=11) at worker.c:1418\n        pid = 0\n#11 0x00007fafad67b59f in perform_idle_server_maintenance () at worker.c:1626\n        i = 0\n        j = 25\n        idle_thread_count = 73\n        ws = 0x7fafad485f60\n        ps = 0x7fafad44e1e0\n        free_length = 1\n        totally_free_length = 1\n        free_slots = {11, 2, 3, 4, 5, 6, 1, 2, 3, 4, -1388432843, 32687, 134, 0, 6, 0, 5952, 0, -1386065568, 32687, -1190900960, 32767, -1395325068, 32687, 1395745853, 0, -1400690833, 32687, 0, 0, -1395323367, 32687}\n        last_non_dead = 14\n        total_non_dead = 15\n        active_thread_count = 155\n#12 0x00007fafad67b916 in server_main_loop (remaining_children_to_start=0) at worker.c:1752\n        old_gen = -1365807208\n        child_slot = 0\n        exitwhy = 6\n        status = 6\n        processed_status = 0\n        pid = {pid = -1, in = 0x7fafae976f98, out = 0x0, err = 0xffffffffffffffff}\n        i = 25\n#13 0x00007fafad67bd69 in worker_run (_pconf=0x7fafae8c4138, plog=0x7fafae8f1378, s=0x7fafae8ed4c0) at worker.c:1823\n        remaining_children_to_start = 0\n        rv = 0\n#14 0x00007fafad62eebb in ap_run_mpm (pconf=0x7fafae8c4138, plog=0x7fafae8f1378, s=0x7fafae8ed4c0) at mpm_common.c:98\n        pHook = 0x7fafae963600\n        n = 0\n        rv = -1\n#15 0x00007fafad62717c in main (argc=11, argv=0x7fffb9044f28) at main.c:777\n        c = 68 'D'\n        showcompile = 0\n        showdirectives = 0\n        confname = 0x7fafad67fe73 \"conf/httpd.conf\"\n        def_server_root = 0x7fafad67fe83 \"/opt/bg/deploy/apache24\"\n        temp_error_log = 0x0\n        error = 0x0\n        process = 0x7fafae8c2218\n        pconf = 0x7fafae8c4138\n        plog = 0x7fafae8f1378\n        ptemp = 0x7fafae8ef348\n        pcommands = 0x7fafae8e6248\n        opt = 0x7fafae8e6338\n        rv = 0\n        mod = 0x7fafad89d800\n        opt_arg = 0x7fffb9046c54 \"env_prod\"\n        signal_server = 0x7fafad6625aa\n\n\nAt apr_reslist.c:161\n#4  0x00007fafacf7ce3f in reslist_cleanup (data_=0x7fafae9e8bd0)\n    at misc/apr_reslist.c:161=\n\nassert(rl->ntotal == 0);\n\n(gdb) print rl->ntotal\n$1 = 9\n(gdb) print rl->nidle\n$2 = 0", "id": 174086, "time": "2014-03-25T20:45:18Z", "creator": "ywu@bitglass.com", "creation_time": "2014-03-25T20:45:18Z", "is_private": false, "attachment_id": null}]