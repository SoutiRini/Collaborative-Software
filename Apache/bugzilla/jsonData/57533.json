[{"count": 0, "tags": [], "creator": "softwareproduction@visus.com", "attachment_id": null, "is_private": false, "id": 180748, "time": "2015-02-04T08:49:00Z", "bug_id": 57533, "creation_time": "2015-02-04T08:49:00Z", "text": "Ant scripts are failing time by time because of a NPE (see stacktrace below).\n\nlooking at the sourcecode (ResourceUtils.java line:439) a null-reference for \"project\" must be the culprit:\na)\n   try {\n        copyUsingFileChannels(sourceFile, destFile);\n        copied = true;\n    } catch (IOException ex) {\n        project.log(\"Attempt to copy \" + sourceFile\n                    + \" to \" + destFile + \" using NIO Channels\"\n                    + \" failed due to '\" + ex.getMessage()\n                    + \"'.  Falling back to streams.\",\n                    Project.MSG_WARN);\n    }\n \nb) It would also crash in the streamCopy-fallback at the second location with a NPE because auf procect=null\n\tat line 439:\n\t    private static OutputStream getOutputStream(Resource resource, boolean append, Project project)\n            throws IOException {\n        if (append) {\n            Appendable a = resource.as(Appendable.class);\n            if (a != null) {\n                return a.getAppendOutputStream();\n            }\n            project.log(\"Appendable OutputStream not available for non-appendable resource \"\n                    + resource + \"; using plain OutputStream\", Project.MSG_VERBOSE);\n        }\n        return resource.getOutputStream();\n    }\n\nGuess it would be worth fixing in the next release :-> \n\nSchlauberger Spruch am Ende: and a good NPE-checker of the IDE should have detected this, too :-> \n\n//////////////////////////////////////////////////////////////////////////\n\n\nSTACKTRACE:\n  (project=null is set in FileUtils.java line 409)\njava.lang.NullPointerException\n\tat org.apache.tools.ant.util.ResourceUtils.copyResource(ResourceUtils.java line:439)\n\tat org.apache.tools.ant.util.FileUtils.copyFile(FileUtils.java line:559)\n\tat org.apache.tools.ant.util.FileUtils.copyFile(FileUtils.java line:519)\n\tat org.apache.tools.ant.util.FileUtils.copyFile(FileUtils.java line:480)\n\tat org.apache.tools.ant.util.FileUtils.copyFile(FileUtils.java line:443)\n\tat org.apache.tools.ant.util.FileUtils.copyFile(FileUtils.java line:409)\n\tat org.apache.tools.ant.util.FileUtils.copyFile(FileUtils.java line:384)\n\tat org.apache.tools.ant.util.FileUtils.copyFile(FileUtils.java line:322)\n\tat org.apache.tools.ant.util.FileUtils.rename(FileUtils.java line:1317)\n\tat org.apache.tools.ant.taskdefs.Replace.processFile(Replace.java line:691)\n\tat org.apache.tools.ant.taskdefs.Replace.execute(Replace.java line:530)\n\tat org.apache.tools.ant.UnknownElement.execute(UnknownElement.java line:292)"}, {"text": "This is a situation that probably doesn't happen too often - source and target location of rename are on different file systems and an IOException occurs while copying.  Still it's strange it hasn't been reported before.  Thanks!\n\ngit commit dc37a17", "tags": [], "bug_id": 57533, "is_private": false, "count": 1, "id": 180750, "time": "2015-02-04T10:15:06Z", "creator": "bodewig@apache.org", "creation_time": "2015-02-04T10:15:06Z", "attachment_id": null}]