[{"count": 0, "attachment_id": null, "bug_id": 49224, "is_private": false, "id": 136526, "time": "2010-04-29T11:15:49Z", "creator": "mpassell@grovehillsoftware.com", "creation_time": "2010-04-29T11:15:49Z", "tags": [], "text": "I'm using jdbc-pool (version 1.0.8.5) to connect to a DataSource requiring no authentication.  Unless I explicitly set the username and password in the PoolProperties object to empty String (as opposed to leaving them null), a NullPointerException is thrown on lines 215 or 216 of PooledConnection.connectUsingDriver()."}, {"count": 1, "tags": [], "bug_id": 49224, "attachment_id": null, "text": "I'm guessing that the solution is as simple as changing lines 215 and 216 of PooledConnection to the following:\n\npoolProperties.getDbProperties().setProperty(\"user\", usr != null ? usr : \"\");\npoolProperties.getDbProperties().setProperty(\"password\", pwd != null ? pwd : \"\");\n\n--Matt", "id": 136528, "time": "2010-04-29T11:18:10Z", "creator": "mpassell@grovehillsoftware.com", "creation_time": "2010-04-29T11:18:10Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 49224, "attachment_id": null, "is_private": false, "id": 136543, "time": "2010-04-29T18:19:28Z", "creator": "fhanik@apache.org", "creation_time": "2010-04-29T18:19:28Z", "text": "(In reply to comment #1)\n> I'm guessing that the solution is as simple as changing lines 215 and 216 of\n> PooledConnection to the following:\n> \n> poolProperties.getDbProperties().setProperty(\"user\", usr != null ? usr : \"\");\n> poolProperties.getDbProperties().setProperty(\"password\", pwd != null ? pwd :\n> \"\");\n> \n> --Matt\n\n\"\" is not the same as null, my guess is that the property should not even be set of the value is null"}, {"count": 3, "text": "(In reply to comment #2)\n> \"\" is not the same as null, my guess is that the property should not even be\n> set of the value is null\n\nGood point.  That's even better, as long as you make sure that any code calling PoolProperties.getDbProperties().getProperty() is null-tolerant as well.", "bug_id": 49224, "attachment_id": null, "id": 136544, "time": "2010-04-29T18:24:28Z", "creator": "mpassell@grovehillsoftware.com", "creation_time": "2010-04-29T18:24:28Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "bug_id": 49224, "attachment_id": 25427, "is_private": false, "id": 136784, "time": "2010-05-11T13:07:05Z", "creator": "mpassell@grovehillsoftware.com", "creation_time": "2010-05-11T13:07:05Z", "text": "Created attachment 25427\nonly set username and password if the values are not null\n\nLooking at how the dbProperties are just passed to the driver, it's clear that any driver willing to accept a connection without a username or password should be fine without values for those properties being passed through.  So, the patch I'm attaching does just what Filip was suggesting and only sets the username/password if they're not null."}, {"attachment_id": null, "tags": [], "bug_id": 49224, "text": "Patch applied. Many thanks.", "count": 5, "id": 136801, "time": "2010-05-12T06:29:12Z", "creator": "markt@apache.org", "creation_time": "2010-05-12T06:29:12Z", "is_private": false}]