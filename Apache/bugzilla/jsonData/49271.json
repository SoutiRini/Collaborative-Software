[{"count": 0, "tags": [], "creator": "deBakker_Bas@emc.com", "attachment_id": null, "text": "The xslt task no longer heeds the classpath property. The reason is that in XSLTProcess.java, the resolveProcessor method does not (in the default case) call the loadClass method and therefore the thread context class loader is not set.\n\nThis is a regression from 1.8.0.", "id": 136777, "time": "2010-05-11T10:05:01Z", "bug_id": 49271, "creation_time": "2010-05-11T10:05:01Z", "is_private": false}, {"count": 1, "tags": [], "text": "As a workaround, you can explicitly specify\nprocessor=\"org.apache.tools.ant.taskdefs.optional.TraXLiaison\"\nas an attribute of the xslt task.", "attachment_id": null, "id": 136778, "creation_time": "2010-05-11T10:16:01Z", "time": "2010-05-11T10:16:01Z", "creator": "deBakker_Bas@emc.com", "bug_id": 49271, "is_private": false}, {"count": 2, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "text": "fixed with svn revision 943143", "id": 136779, "time": "2010-05-11T11:17:19Z", "bug_id": 49271, "creation_time": "2010-05-11T11:17:19Z", "is_private": false}, {"count": 3, "tags": [], "creator": "jglick@apache.org", "attachment_id": null, "text": "The fix looks wrong to me. TraXLiaison is part of primary Ant sources, so we should not be loading *it* using some special class loader - unnecessary and risks weird CCEs.\n\nThe use of getContextClassLoader in TraXLiaison.getFactory is also strange, because it relies on some undocumented side effects from the task. It seems XSLTProcess sets and restores the thread's CCL - but it only sets it in loadClass. 943143 works only because loadClass is called at all - it could throw away the result! Also, using Class.forName(String) from TraXLiaison.getFactory is probably unnecessary and wrong.\n\nPerhaps the proper fix is as follows:\n\n1. Back out 943143; as part of assuming JDK 1.4+ I intentionally loaded TraXLiaison directly, since it does not depend on anything outside the JRE.\n\n2. Simplify TraXLiaison.getFactory to not call Class.forName(String). It can continue to use TransformerFactory.newInstance for an unspecified factory; or Class.forName with CCL on a specified factory. (Note that if you are bothering to specify a classpath for the processor, you should very likely be specifying the factory too - else how do you know for sure what you are getting? You could be getting some unrelated factory that happened to be elsewhere in the classpath.)\n\n3. Make XSLTProcess.execute always create loader and call setThreadContextLoader in case classpath != null; do not do this logic in loadClass.", "id": 136787, "time": "2010-05-11T14:14:56Z", "bug_id": 49271, "creation_time": "2010-05-11T14:14:56Z", "is_private": false}, {"count": 4, "tags": [], "bug_id": 49271, "attachment_id": null, "id": 136912, "creation_time": "2010-05-17T05:29:30Z", "time": "2010-05-17T05:29:30Z", "creator": "bodewig@apache.org", "text": "I agree with all of your points.", "is_private": false}, {"count": 5, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "text": "svn revision 982729 is along the lines of point 1 and 3 of comment #3\n\nI extracted the loader creation into a method that is invoked from execute as\nwell as loadClass since loadClass may be invoked via the protected getLiaison\nmethod and there wouldn't be any guarantee that execute has been called at all.\n\nI've skipped point 2 since I don't think falling back to Class.forName(string)\nlikely doesn't do any harm (we shouldn't be getting there anyway).", "id": 138918, "time": "2010-08-05T14:50:57Z", "bug_id": 49271, "creation_time": "2010-08-05T14:50:57Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 49271, "attachment_id": null, "id": 141059, "time": "2010-10-26T09:00:39Z", "creator": "bodewig@apache.org", "creation_time": "2010-10-26T09:00:39Z", "is_private": false, "text": "I think it is fixed again and assume Jesse can live with the current trunk code."}, {"count": 7, "tags": [], "creator": "jglick@apache.org", "attachment_id": null, "text": "Looked OK last I checked.", "id": 141067, "time": "2010-10-26T12:43:00Z", "bug_id": 49271, "creation_time": "2010-10-26T12:43:00Z", "is_private": false}, {"count": 8, "tags": [], "creator": "jglick@apache.org", "attachment_id": null, "text": "*** Bug 50289 has been marked as a duplicate of this bug. ***", "id": 141800, "time": "2010-11-18T10:03:36Z", "bug_id": 49271, "creation_time": "2010-11-18T10:03:36Z", "is_private": false}]