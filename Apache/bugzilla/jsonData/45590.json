[{"count": 0, "tags": [], "bug_id": 45590, "attachment_id": 22402, "id": 119550, "time": "2008-08-07T09:11:06Z", "creator": "dgoldenberg@attivio.com", "creation_time": "2008-08-07T09:11:06Z", "is_private": false, "text": "Created attachment 22402\nThe presentation as a ppt with no header/footer data.\n\nI have attempted to use the code outlined here for the extraction of headers and footers from .ppt files:\n\nhttp://poi.apache.org/hslf/how-to-shapes.html#HeadersFooters\n\nHowever, all the values I got were null.\n\nThe test file I used was a .ppt file created in PowerPoint 2007.  I.e. it was saved in the compatibility mode.  This is a very important use-case, since I have no access to any other version of Office and our customers are very likely to have a lot of files like this.\n\nI am attaching the following:\n\n1. a simple presentation, both in pptx and ppt formats (ppt saved in compatibility mode from '07)\n2. the same presentation with set headers / footers, both in ppt and pptx formats.\n\nNote that for the files with headers/footers, the following header/footer data is defined:\n\n1. Slide header/footer data:\n- Fixed date: August 06, 2008\n- Slide number is checked\n- Slide footer is set to \"THE FOOTER TEXT\" for all slides but the second, where it is actually set to \"THE FOOTER TEXT FOR SLIDE 2\"\n\n2. Notes and Handouts\n- Date and time is selected to 'update automatically'\n- Header is set to \"THE NOTES HEADER TEXT\"\n- Page number is selected\n- Footer is set to \"THE NOTES FOOTER TEXT\"\n\nThis feature is critical for us."}, {"count": 1, "tags": [], "text": "Created attachment 22403\nThe presentation as a pptx, no header/footer data.", "is_private": false, "bug_id": 45590, "id": 119551, "time": "2008-08-07T09:12:29Z", "creator": "dgoldenberg@attivio.com", "creation_time": "2008-08-07T09:12:29Z", "attachment_id": 22403}, {"count": 2, "tags": [], "bug_id": 45590, "attachment_id": 22404, "is_private": false, "id": 119552, "time": "2008-08-07T09:13:11Z", "creator": "dgoldenberg@attivio.com", "creation_time": "2008-08-07T09:13:11Z", "text": "Created attachment 22404\nThe presentation as ppt, with header and footer data."}, {"count": 3, "tags": [], "text": "Created attachment 22405\nThe presentation as pptx, with header and footer data.", "is_private": false, "bug_id": 45590, "id": 119553, "time": "2008-08-07T09:13:41Z", "creator": "dgoldenberg@attivio.com", "creation_time": "2008-08-07T09:13:41Z", "attachment_id": 22405}, {"count": 4, "tags": [], "bug_id": 45590, "attachment_id": null, "is_private": false, "id": 119700, "time": "2008-08-11T23:57:44Z", "creator": "yegor@dinom.ru", "creation_time": "2008-08-11T23:57:44Z", "text": "Fixed in r685054. \nI hope I figured out how PPT 2007 stores headers / footers - quite differently from PPT 2003. If you have a big set of such ppt 2007 files, please exercise the code against it. \n\nYegor"}, {"count": 5, "tags": [], "bug_id": 45590, "is_private": false, "text": "I just got the latest POI sources and my testing code still returns all nulls for all the headers and footers. I used the document you can find attached to this issue, marked as \"The presentation as ppt, with header and footer data.\"\n\nThanks. Below is my tester code:\n\n\npackage com.attivio.test;\n\nimport java.io.FileInputStream;\n\nimport org.apache.poi.hslf.model.HeadersFooters;\nimport org.apache.poi.hslf.model.Slide;\nimport org.apache.poi.hslf.usermodel.SlideShow;\n\npublic class HslfHeaderFooterExtractor {\n  public static void main(String[] args) throws Exception {\n    FileInputStream fis = new FileInputStream(args[0]);\n    SlideShow ppt = new SlideShow();\n    fis.close();\n    Slide[] slides = ppt.getSlides();\n\n    // presentation-scope headers / footers\n    HeadersFooters hdd = ppt.getSlideHeadersFooters();\n    String headerText = hdd.getHeaderText();\n    String footerText = hdd.getFooterText();\n\n    System.out.println(\">> Global header: \" + headerText);\n    System.out.println(\">> Global footer: \" + footerText);\n    \n    HeadersFooters notesHdd = ppt.getNotesHeadersFooters();\n    headerText = notesHdd.getHeaderText();\n    footerText = notesHdd.getFooterText();\n    String dateTimeText = notesHdd.getDateTimeText();\n    \n    System.out.println(\">> Notes header: \" + headerText);\n    System.out.println(\">> Notes footer: \" + footerText);\n    System.out.println(\">> Notes date time text: \" + dateTimeText);\n\n    // per-slide headers / footers\n    for (int i = 0; i < slides.length; i++) {\n      \n      System.out.println(\">> SLIDE #\" + (i + 1));\n      \n      HeadersFooters hdd2 = slides[i].getHeadersFooters();\n      headerText = hdd2.getHeaderText();\n      footerText = hdd2.getFooterText();\n      dateTimeText = hdd2.getDateTimeText();\n      int slideNum = slides[i].getSlideNumber();\n      \n      System.out.println(\">> HEADER: \" + headerText);\n      System.out.println(\">> FOOTER: \" + footerText);\n      System.out.println(\">> DATE TIME: \" + dateTimeText);\n      System.out.println(\">> SLIDE NUM: \" + slideNum);\n      \n    }\n\n  }\n}\n", "id": 119741, "time": "2008-08-12T10:41:45Z", "creator": "dgoldenberg@attivio.com", "creation_time": "2008-08-12T10:41:45Z", "attachment_id": null}, {"count": 6, "attachment_id": null, "creator": "yegor@dinom.ru", "is_private": false, "id": 119779, "time": "2008-08-13T06:20:30Z", "bug_id": 45590, "creation_time": "2008-08-13T06:20:30Z", "tags": [], "text": "Dmitry,\n\nYou don't pass FileInputStream to SlideShow:\n\n      FileInputStream fis = new FileInputStream(args[0]);\n      SlideShow ppt = new SlideShow();  //ERROR\n      fis.close();\n      Slide[] slides = ppt.getSlides();\n\nit should be \n\n      SlideShow ppt = new SlideShow(fis);  //OK\n\nBelow is the output:\n\n>> Global header: null\n>> Global footer: THE FOOTER TEXT\n>> Notes header: THE NOTES HEADER TEXT\n>> Notes footer: THE NOTES FOOTER TEXT\n>> Notes date time text: null\n>> SLIDE #1\n>> HEADER: null\n>> FOOTER: THE FOOTER TEXT\n>> DATE TIME: Wednesday, August 06, 2008\n>> SLIDE NUM: 1\n>> SLIDE #2\n>> HEADER: null\n>> FOOTER: THE FOOTER TEXT FOR SLIDE 2\n>> DATE TIME: August 06, 2008\n>> SLIDE NUM: 2\n>> SLIDE #3\n>> HEADER: null\n>> FOOTER: THE FOOTER TEXT\n>> DATE TIME: Wednesday, August 06, 2008\n>> SLIDE NUM: 3\n\n\nRegards,\nYegor\n\n(In reply to comment #5)\n> I just got the latest POI sources and my testing code still returns all nulls\n> for all the headers and footers. I used the document you can find attached to\n> this issue, marked as \"The presentation as ppt, with header and footer data.\"\n> \n> Thanks. Below is my tester code:\n> \n> \n> package com.attivio.test;\n> \n> import java.io.FileInputStream;\n> \n> import org.apache.poi.hslf.model.HeadersFooters;\n> import org.apache.poi.hslf.model.Slide;\n> import org.apache.poi.hslf.usermodel.SlideShow;\n> \n> public class HslfHeaderFooterExtractor {\n>   public static void main(String[] args) throws Exception {\n>     FileInputStream fis = new FileInputStream(args[0]);\n>     SlideShow ppt = new SlideShow();\n>     fis.close();\n>     Slide[] slides = ppt.getSlides();\n> \n>     // presentation-scope headers / footers\n>     HeadersFooters hdd = ppt.getSlideHeadersFooters();\n>     String headerText = hdd.getHeaderText();\n>     String footerText = hdd.getFooterText();\n> \n>     System.out.println(\">> Global header: \" + headerText);\n>     System.out.println(\">> Global footer: \" + footerText);\n> \n>     HeadersFooters notesHdd = ppt.getNotesHeadersFooters();\n>     headerText = notesHdd.getHeaderText();\n>     footerText = notesHdd.getFooterText();\n>     String dateTimeText = notesHdd.getDateTimeText();\n> \n>     System.out.println(\">> Notes header: \" + headerText);\n>     System.out.println(\">> Notes footer: \" + footerText);\n>     System.out.println(\">> Notes date time text: \" + dateTimeText);\n> \n>     // per-slide headers / footers\n>     for (int i = 0; i < slides.length; i++) {\n> \n>       System.out.println(\">> SLIDE #\" + (i + 1));\n> \n>       HeadersFooters hdd2 = slides[i].getHeadersFooters();\n>       headerText = hdd2.getHeaderText();\n>       footerText = hdd2.getFooterText();\n>       dateTimeText = hdd2.getDateTimeText();\n>       int slideNum = slides[i].getSlideNumber();\n> \n>       System.out.println(\">> HEADER: \" + headerText);\n>       System.out.println(\">> FOOTER: \" + footerText);\n>       System.out.println(\">> DATE TIME: \" + dateTimeText);\n>       System.out.println(\">> SLIDE NUM: \" + slideNum);\n> \n>     }\n> \n>   }\n> }\n> \n\n"}, {"count": 7, "tags": [], "creator": "dgoldenberg@attivio.com", "attachment_id": null, "id": 119840, "time": "2008-08-14T11:33:34Z", "bug_id": 45590, "creation_time": "2008-08-14T11:33:34Z", "is_private": false, "text": "OMG I had a dumb bug in my tester, sorry! :)"}]