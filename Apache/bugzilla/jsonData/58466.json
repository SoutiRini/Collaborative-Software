[{"count": 0, "tags": [], "bug_id": 58466, "attachment_id": 33151, "is_private": false, "id": 185541, "time": "2015-09-29T17:00:30Z", "creator": "cmb-apache@corefiling.co.uk", "creation_time": "2015-09-29T17:00:30Z", "text": "Created attachment 33151\nMore tests of ColumnHelper, 2 of which fail\n\nI attach a patch adding some more tests of ColumnHelper, 2 of which fail:\n\n* testAddCleanColIntoColsExactOverlap\n  * Adds CTCol(min=1, max=1, hidden=true)\n  * Adds CTCol(min=1, max=1, bestFit=true)\n  * Expected: CTCol(min=1, max=1, hidden=true, bestFit=true)\n  * Actual:   CTCol(min=1, max=1, hidden=true)\n\n* testAddCleanColIntoColsNewOverlapsOverhangingLeftNotRightExactRight:\n  * Adds CTCol(min=2 max=3 hidden=true)\n  * Adds CTCol(min=1 max=3 bestFit=true)\n    * Note that a sort happens, meaning 1-3 is encountered first in the combine operation.\n  * Expected: (min=1, max=1, bestFit=true), (min=2, max=3, bestFit=true, hidden=true)\n  * Actual:   (min=1, max=1, bestFit=true), (min=2, max=3, bestFit=true)\n\nWe have our own different implementation of a fast column merger which passes these; it pre-dates trunk's current implementation introduced in r1561435 under bug 54283. We can look at contributing our replacement if that's easier than fixing the current implementation."}, {"count": 1, "tags": [], "bug_id": 58466, "attachment_id": null, "id": 185628, "time": "2015-10-05T10:33:10Z", "creator": "dtn-asfbugs@corefiling.co.uk", "creation_time": "2015-10-05T10:33:10Z", "is_private": false, "text": "As discussed at ApacheCon, replaced the fix from bug 54283 with our implementation; this appears to work better and has improved the behaviour of column group collapsing too (made it closer to what Excel does).\n\nFixed in SVN r1706789\n\nThanks to Chris, and to Matt Hillsdon, for their work on this one."}, {"count": 2, "tags": [], "bug_id": 58466, "attachment_id": null, "id": 185693, "time": "2015-10-08T04:40:04Z", "creator": "onealj@apache.org", "creation_time": "2015-10-08T04:40:04Z", "is_private": false, "text": "I got some weird errors from the changes in r1706789. For example, XSSFSheet.autoSizeColumn(col) changes the size of col and an adjacent column. In some cases, autoSizeColumn ended up hiding columns that were previously visible.\n\nI'll see if I can pair down my Excel template to a SSCCE. Right now I can't reproduce the problem if I start with a blank workbook."}]