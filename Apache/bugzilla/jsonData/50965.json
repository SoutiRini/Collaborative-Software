[{"count": 0, "tags": [], "bug_id": 50965, "attachment_id": null, "text": "r1069154 refactored some code to the function BlockContainerLayoutManager.setupAreaDimensions()\n\ncontentRectOffsetX and contentRectOffsetY are now only initialised to 0, when the class is instantiated. The previous version did this for every execution of this code.\nAs setupAreaDimensions() can be executed multiple times, this yields to layout errors.\n\n--- a/src/java/org/apache/fop/layoutmgr/BlockContainerLayoutManager.java\n+++ b/src/java/org/apache/fop/layoutmgr/BlockContainerLayoutManager.java\n@@ -346,6 +346,8 @@ public class BlockContainerLayoutManager extends BlockStackingLayoutManager\n             updateContentAreaIPDwithOverconstrainedAdjust(contentWidth);\n         }\n\n+        contentRectOffsetX = 0;\n+        contentRectOffsetY = 0;\n         contentRectOffsetX += fo.getCommonMarginBlock().startIndent.getValue(this);\n         contentRectOffsetY += fo.getCommonBorderPaddingBackground().getBorderBeforeWidth(false);\n         contentRectOffsetY += fo.getCommonBorderPaddingBackground().getPaddingBefore(false, this);", "id": 145234, "time": "2011-03-24T07:21:31Z", "creator": "martin.koegler@brz.gv.at", "creation_time": "2011-03-24T07:21:31Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 50965, "attachment_id": null, "is_private": false, "id": 145243, "time": "2011-03-24T13:53:48Z", "creator": "adelmelle@apache.org", "creation_time": "2011-03-24T13:53:48Z", "text": "(In reply to comment #0)\n> r1069154 refactored some code to the function\n> BlockContainerLayoutManager.setupAreaDimensions()\n> \n> contentRectOffsetX and contentRectOffsetY are now only initialised to 0, when\n> the class is instantiated. The previous version did this for every execution of\n> this code.\n\nApparently a scenario for which we do not yet have a regression test. Since you discovered it, can you please attach a small FO that reproduces the issue so we can add that to our test suite?\n\nThanks!"}, {"count": 2, "tags": [], "bug_id": 50965, "is_private": false, "text": "Please compare the area tree before/after this change:\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<fo:root xmlns:fo=\"http://www.w3.org/1999/XSL/Format\">\n  <fo:layout-master-set>\n    <fo:simple-page-master master-name=\"page\" page-height=\"100mm\" page-width=\"100mm\">\n      <fo:region-body/>\n    </fo:simple-page-master>\n    <fo:page-sequence-master master-name=\"ps\">\n      <fo:repeatable-page-master-alternatives>\n        <fo:conditional-page-master-reference master-reference=\"page\" page-position=\"first\"/>\n        <fo:conditional-page-master-reference master-reference=\"page\" page-position=\"rest\"/>\n        <fo:conditional-page-master-reference master-reference=\"page\" page-position=\"last\"/>\n      </fo:repeatable-page-master-alternatives>\n    </fo:page-sequence-master>\n  </fo:layout-master-set>\n  <fo:page-sequence master-reference=\"ps\">\n    <fo:flow flow-name=\"xsl-region-body\">\n      <fo:block-container margin-left=\"20mm\">\n        <fo:block-container page-break-before=\"always\">\n          <fo:block>A</fo:block>\n        </fo:block-container>\n      </fo:block-container>\n    </fo:flow>\n  </fo:page-sequence>\n</fo:root>", "id": 145244, "time": "2011-03-24T18:00:33Z", "creator": "martin.koegler@brz.gv.at", "creation_time": "2011-03-24T18:00:33Z", "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 50965, "attachment_id": null, "text": "\nFixed in r1085820 (see: http://svn.apache.org/viewvc?rev=1085820&view=rev)\n\nThanks for reporting!", "id": 145301, "time": "2011-03-26T18:44:28Z", "creator": "adelmelle@apache.org", "creation_time": "2011-03-26T18:44:28Z", "is_private": false}, {"count": 4, "tags": [], "text": "batch transition to closed; if someone wishes to restore one of these to resolved in order to perform a verification step, then feel free to do so", "attachment_id": null, "id": 155481, "creator": "gadams@apache.org", "time": "2012-04-01T06:18:28Z", "bug_id": 50965, "creation_time": "2012-04-01T06:18:28Z", "is_private": false}]