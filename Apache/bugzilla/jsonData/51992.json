[{"count": 0, "tags": [], "creator": "jsg8pitt@yahoo.com", "attachment_id": 27727, "text": "Created attachment 27727\npatch\n\nA coworker and I ran into some ArrayIndexOutOfBoundsExceptions while \nprocessing ppt files using POI (by way of Tika), and tracked the problem \ndown to some of the code in VariantSupport.\n\nI can't attach the actual ppt files that we had that provoked the problem, but I'll see if can create some new ones.", "id": 150315, "time": "2011-10-07T14:53:09Z", "bug_id": 51992, "creation_time": "2011-10-07T14:53:09Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 51992, "attachment_id": null, "id": 150316, "time": "2011-10-07T15:19:15Z", "creator": "jsg8pitt@yahoo.com", "creation_time": "2011-10-07T15:19:15Z", "is_private": false, "text": "1093 [Thrown class java.lang.ArrayIndexOutOfBoundsException] \n \nRestarts: \n 0: [QUIT] Quit to the SLIME top level  \n 1: [ABORT] ABORT to SLIME level 0   \n \nBacktrace:   \n  0: org.apache.poi.hpsf.VariantSupport.read(VariantSupport.java:262) \n  1: org.apache.poi.hpsf.Property.<init>(Property.java:164)  \n  2: org.apache.poi.hpsf.Section.<init>(Section.java:277) \n  3: org.apache.poi.hpsf.PropertySet.init(PropertySet.java:452) \n  4: org.apache.poi.hpsf.PropertySet.<init>(PropertySet.java:247)  \n  5: org.apache.tika.parser.microsoft.SummaryExtractor.parseSummaryEntryIfExists(SummaryExtractor.java:67)   \n  6: org.apache.tika.parser.microsoft.SummaryExtractor.parseSummaries(SummaryExtractor.java:58)  \n  7: org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:182)   \n  8: org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242) \n  9: org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242) \n 10: org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:129) \n\n----\n\nSadly, I cannot recreate the issue in a new ppt -- a new one created in libreoffice doesn't display the issue, and if I make changes to the one that I have to anonymize it then the saved version doesn't display the problem either. :("}, {"count": 2, "tags": [], "creator": "yegor@dinom.ru", "text": "Which version of Tika and POI? \n\nCan you obfuscate the problematic ppt file ? The problem is with reading the document properties and this is all we need to track the problem.\nOpen the problematic ppt file in PowerPoint, delete all content from the slides and save. Is the file readable by Tika ? \n\nYegor", "id": 153488, "attachment_id": null, "bug_id": 51992, "creation_time": "2012-02-06T07:06:38Z", "time": "2012-02-06T07:06:38Z", "is_private": false}, {"count": 3, "tags": [], "text": "No, that won't work.  If I open edit and save the file, then it no longer displays the problem.\n\nI will try to track down the file again, and if I can find it, I would be willing to set up an appointment for a developer to ssh into my machine and work with the file here.\n\nIn the meantime, though, I'm curious if there are any test files for the project for which the aforementioned code is actually correct -- it seems to me that it's just written incorrectly and wouldn't work for any test file that exercises the code (but, of course, these being office formats, I wouldn't be surprised if I'm completely wrong).", "attachment_id": null, "id": 153506, "creator": "jsg8pitt@yahoo.com", "time": "2012-02-06T14:49:06Z", "bug_id": 51992, "creation_time": "2012-02-06T14:49:06Z", "is_private": false}, {"count": 4, "tags": [], "creator": "kiwiwings@apache.org", "attachment_id": null, "text": "The patch can't be applied anymore - please test if the latest version of POI \nis still affected and ideally add a sample file.", "id": 190969, "time": "2016-05-14T21:25:50Z", "bug_id": 51992, "creation_time": "2016-05-14T21:25:50Z", "is_private": false}]