[{"count": 0, "attachment_id": null, "creator": "cpyofkev@hotmail.com", "text": "I ran into a infinite loop when acceptNode() returns FILTEP_SKIP in \nTreeWalkerImpl class.  Here are changes I made to fix the problem.\n\n    Node getNextSibling(Node node) {\n        \n        if (node == null || node == fRoot) return null;\n        \n        Node newNode = node.getNextSibling();\n        if (newNode == null) {\n            return null;\n        }\n        \n        int accept = acceptNode(newNode);\n        \n        if (accept == NodeFilter.FILTER_ACCEPT) {\n            return newNode;\n        }\n        else if (accept == NodeFilter.FILTER_SKIP) {\n            Node fChild =  getFirstChild(newNode);\n            if (fChild == null) {\n                return getNextSibling(newNode);\n            }\n            return fChild;\n        }\n        else { //if (accept == NodeFilter.REJECT_NODE) \n            return getNextSibling(newNode);\n        }\n        \n    }\n\n    \n    /** Internal function.\n     *  Return the first child Node, from the input node\n     *  after applying filter, whatToshow.\n     *  The current node is not consulted or set.\n     */\n    Node getFirstChild(Node node) {\n        Node childNode= null;\n\n        if (node == null) {\n          return null;\n        }\n\n        if ( !fEntityReferenceExpansion\n             && node.getNodeType() == Node.ENTITY_REFERENCE_NODE) {\n            return null;\n        }\n   \n        childNode = node.getFirstChild();\n        if (childNode == null) {\n          return null;\n        }\n        \n        int accept = acceptNode(childNode);\n        \n        if (accept == NodeFilter.FILTER_ACCEPT) {\n            return childNode;\n        }\n        else if (accept == NodeFilter.FILTER_SKIP\n                 && childNode.hasChildNodes()) {\n            Node descendentNode= getFirstChild(childNode);\n            if (null == descendentNode) {\n              return getNextSibling(childNode);;\n            }\n            else {\n              return descendentNode;\n            }\n        }\n        else { //if (accept == NodeFilter.REJECT_NODE) \n            Node siblingNode= getNextSibling(childNode);\n            return siblingNode;\n        }\n    }", "id": 3253, "time": "2001-06-26T01:01:22Z", "bug_id": 2322, "creation_time": "2001-06-26T01:01:22Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "creator": "elena@apache.org", "is_private": false, "text": "Your patch seem to have conflict with the specs behaviour of nextSibling. The \nproblem was originaly reported in: \nhttp://nagoya.apache.org/bugzilla/show_bug.cgi?id=1541 and fix applying the \npatch in this bug report.\nPick up code from CVS for the latest fix. Tell us if you have any problems.", "id": 3266, "time": "2001-06-26T07:21:02Z", "bug_id": 2322, "creation_time": "2001-06-26T07:21:02Z", "attachment_id": null}]