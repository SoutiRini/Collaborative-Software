[{"count": 0, "tags": [], "creator": "kamoshida.toshiaki@future.co.jp", "text": "Because Record#fillFields() in some Concrete Record classes,use Constractor of \njava.lang.String with no Encoding Indicator to decode 8bit compressed \ncharcter's byte array,so some string values will garble on different \nplatforms,depends on the effect of \"DEFAULT ENCODING OF RUNTIME\".", "id": 34951, "attachment_id": null, "bug_id": 18947, "creation_time": "2003-04-11T10:17:21Z", "time": "2003-04-11T10:17:21Z", "is_private": false}, {"count": 1, "tags": [], "text": "Created attachment 5795\nTestcases to find problems easily.  \\testcases\\org\\apache\\poi\\hssf\\usermodel\\TestSBCSOnDefaultEncoding.java", "is_private": false, "bug_id": 18947, "id": 34952, "time": "2003-04-11T10:19:28Z", "creator": "kamoshida.toshiaki@future.co.jp", "creation_time": "2003-04-11T10:19:28Z", "attachment_id": 5795}, {"count": 2, "tags": [], "creator": "kamoshida.toshiaki@future.co.jp", "text": "Sorry,I can't find ways to realize other bugs with testcases outside \nhssf.usermodel...\nPlease add testcases to find and fix others.\nThe places using constractor of String are;\nrecord\\FontRecord.java(167)\nrecord\\FormatRecord.java(135)\nrecord\\LabelRecord.java(160)\nrecord\\StringRecord.java(137)\nrecord\\StyleRecord.java(137)\nrecord\\UnicodeString.java(154)\nrecord\\WriteAccessRecord.java(118)\nrecord\\formula\\StringPtg.java(82)", "id": 34953, "attachment_id": null, "bug_id": 18947, "creation_time": "2003-04-11T10:28:24Z", "time": "2003-04-11T10:28:24Z", "is_private": false}, {"count": 3, "text": "Created attachment 5797\nPATCH to fix FooterRecord,HeaderRecord,BoundSheetRecord,and NameRecord", "bug_id": 18947, "is_private": false, "id": 34955, "time": "2003-04-11T10:43:38Z", "creator": "kamoshida.toshiaki@future.co.jp", "creation_time": "2003-04-11T10:43:38Z", "tags": [], "attachment_id": 5797}, {"count": 4, "tags": [], "bug_id": 18947, "text": "The testcase is using sun.io.Converters to emulate the situation easily,\nSo it may works on Sun JRE.Please attention.", "id": 34956, "time": "2003-04-11T10:46:36Z", "creator": "kamoshida.toshiaki@future.co.jp", "creation_time": "2003-04-11T10:46:36Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "kamoshida.toshiaki@future.co.jp", "text": "I found to realize the bug fully in your env easily.\nPlease tested by BiffViewer (I didn't know there is BiffViewer XP)with the \nbootstrap like this;\n\npublic class Test {\n  public static void main(String[] args){\n   System.setProperty(\"file.encoding\",\"UTF-16\");\n   sun.io.Converters.resetDefaultEncodingName();\n   org.apache.poi.hssf.dev.BiffViewer.main(args);\n  }\n}\n\nand you can emulate executing POI at another platforms.\nPlease check the sheets Elvira Gurevich submitted at Bug 17791 with this.", "id": 35694, "attachment_id": null, "bug_id": 18947, "creation_time": "2003-04-21T10:49:42Z", "time": "2003-04-21T10:49:42Z", "is_private": false}, {"count": 6, "tags": [], "bug_id": 18947, "text": "Created attachment 5923\nPATCH to fix ALL problems.", "id": 35695, "time": "2003-04-21T10:51:55Z", "creator": "kamoshida.toshiaki@future.co.jp", "creation_time": "2003-04-21T10:51:55Z", "is_private": false, "attachment_id": 5923}, {"count": 7, "tags": [], "creator": "kamoshida.toshiaki@future.co.jp", "is_private": false, "id": 35697, "attachment_id": null, "bug_id": 18947, "creation_time": "2003-04-21T11:08:19Z", "time": "2003-04-21T11:08:19Z", "text": "Of course,-Dfile.encoding=NATIVE_ENCODING_NAME may be able to test it,but in my \nenv,this way cause;\n\nError occurred during initialization of VM\njava.lang.Error: Can't find java.home ??\n\nIt means,when solving System property java.home,because of the Decoder related \nto NATIVE_ENCODING_NAME,VM can't solve the property.\n\nSo it is more safety that we change defaut encoding after main thread is \nstarted."}, {"count": 8, "tags": [], "creator": "poi-support@buni.org", "attachment_id": null, "text": "Here is what I got: \n\nD:\\cygwin\\home\\androliv\\deleteme\\jakarta-poi\\build\\java\\org\\apache\\poi\\hssf\\reco\nrd\\NameRecord.java:759: cannot resolve symbol\nsymbol  : method getFromCompressedUnicode (byte[],int,int)\nlocation: class org.apache.poi.util.StringUtil\n            field_12_name_text = StringUtil.getFromCompressedUnicode(data, 15 +\noffset,\n                                           ^\nD:\\cygwin\\home\\androliv\\deleteme\\jakarta-poi\\build\\java\\org\\apache\\poi\\hssf\\reco\nrd\\NameRecord.java:767: cannot resolve symbol\nsymbol  : method getFromCompressedUnicode (byte[],int,int)\nlocation: class org.apache.poi.util.StringUtil\n            field_14_custom_menu_text       = StringUtil.getFromCompressedUnicod\ne(data, start_of_custom_menu_text + offset,\n                                                        ^\nD:\\cygwin\\home\\androliv\\deleteme\\jakarta-poi\\build\\java\\org\\apache\\poi\\hssf\\reco\nrd\\NameRecord.java:771: cannot resolve symbol\nsymbol  : method getFromCompressedUnicode (byte[],int,int)\nlocation: class org.apache.poi.util.StringUtil\n            field_15_description_text       = StringUtil.getFromCompressedUnicod\ne(data, start_of_description_text + offset,\n                                                        ^\nD:\\cygwin\\home\\androliv\\deleteme\\jakarta-poi\\build\\java\\org\\apache\\poi\\hssf\\reco\nrd\\NameRecord.java:775: cannot resolve symbol\nsymbol  : method getFromCompressedUnicode (byte[],int,int)\nlocation: class org.apache.poi.util.StringUtil\n            field_16_help_topic_text        = StringUtil.getFromCompressedUnicod\ne(data, start_of_help_topic_text + offset,\n                                                        ^\nD:\\cygwin\\home\\androliv\\deleteme\\jakarta-poi\\build\\java\\org\\apache\\poi\\hssf\\reco\nrd\\NameRecord.java:779: cannot resolve symbol\nsymbol  : method getFromCompressedUnicode (byte[],int,int)\nlocation: class org.apache.poi.util.StringUtil\n            field_17_status_bar_text        = StringUtil.getFromCompressedUnicod\ne(data, start_of_status_bar_text +  offset,\n                                                        ^\nD:\\cygwin\\home\\androliv\\deleteme\\jakarta-poi\\build\\java\\org\\apache\\poi\\hssf\\reco\nrd\\FontRecord.java:167: cannot resolve symbol\nsymbol  : method getFromCompressedUnicode (byte[],int,int)\nlocation: class org.apache.poi.util.StringUtil\n                field_11_font_name = StringUtil.getFromCompressedUnicode(data, 1\n6,\n                                               ^\nD:\\cygwin\\home\\androliv\\deleteme\\jakarta-poi\\build\\java\\org\\apache\\poi\\hssf\\reco\nrd\\HeaderRecord.java:122: cannot resolve symbol\nsymbol  : method getFromCompressedUnicode (byte[],int,int)\nlocation: class org.apache.poi.util.StringUtil\n            field_2_header     = StringUtil.getFromCompressedUnicode(data, 3 + o\nffset, // [Shawn] Changed 1 to 3 for offset of string\n                                           ^\nD:\\cygwin\\home\\androliv\\deleteme\\jakarta-poi\\build\\java\\org\\apache\\poi\\hssf\\reco\nrd\\FooterRecord.java:122: cannot resolve symbol\nsymbol  : method getFromCompressedUnicode (byte[],int,int)\nlocation: class org.apache.poi.util.StringUtil\n            field_2_footer     = StringUtil.getFromCompressedUnicode(data, 3 + o\nffset, // [Shawn] Changed 1 to 3 for offset of string\n                                           ^\nD:\\cygwin\\home\\androliv\\deleteme\\jakarta-poi\\build\\java\\org\\apache\\poi\\hssf\\reco\nrd\\StringRecord.java:137: cannot resolve symbol\nsymbol  : method getFromCompressedUnicode (byte[],int,int)\nlocation: class org.apache.poi.util.StringUtil\n            field_3_string = StringUtil.getFromCompressedUnicode(data, 3 + offse\nt, field_1_string_length);\n                                       ^\nD:\\cygwin\\home\\androliv\\deleteme\\jakarta-poi\\build\\java\\org\\apache\\poi\\hssf\\reco\nrd\\BoundSheetRecord.java:145: cannot resolve symbol\nsymbol  : method getFromCompressedUnicode (byte[],int,int)\nlocation: class org.apache.poi.util.StringUtil\n            field_5_sheetname = StringUtil.getFromCompressedUnicode( data, 8 + o\nffset, nameLength );\n                                          ^\nD:\\cygwin\\home\\androliv\\deleteme\\jakarta-poi\\build\\java\\org\\apache\\poi\\hssf\\reco\nrd\\FormatRecord.java:135: cannot resolve symbol\nsymbol  : method getFromCompressedUnicode (byte[],int,short)\nlocation: class org.apache.poi.util.StringUtil\n          field_4_formatstring = StringUtil.getFromCompressedUnicode(data, 5 + o\nffset, field_3_unicode_len );\n                                           ^\nD:\\cygwin\\home\\androliv\\deleteme\\jakarta-poi\\build\\java\\org\\apache\\poi\\hssf\\reco\nrd\\LabelRecord.java:160: cannot resolve symbol\nsymbol  : method getFromCompressedUnicode (byte[],int,short)\nlocation: class org.apache.poi.util.StringUtil\n            field_6_value = StringUtil.getFromCompressedUnicode(data, 9 + offset\n, getStringLength());\n                                      ^\nD:\\cygwin\\home\\androliv\\deleteme\\jakarta-poi\\build\\java\\org\\apache\\poi\\hssf\\reco\nrd\\StyleRecord.java:137: cannot resolve symbol\nsymbol  : method getFromCompressedUnicode (byte[],int,int)\nlocation: class org.apache.poi.util.StringUtil\n            field_3_name        = StringUtil.getFromCompressedUnicode(data, 3 +\noffset,\n                                            ^\nD:\\cygwin\\home\\androliv\\deleteme\\jakarta-poi\\build\\java\\org\\apache\\poi\\hssf\\reco\nrd\\WriteAccessRecord.java:118: cannot resolve symbol\nsymbol  : method getFromCompressedUnicode (byte[],int,int)\nlocation: class org.apache.poi.util.StringUtil\n        field_1_username = StringUtil.getFromCompressedUnicode(data, 3 + offset,\n data.length - 4);\n                                     ^\n14 errors\n\nBUILD FAILED\nD:\\cygwin\\home\\androliv\\deleteme\\jakarta-poi\\tools\\cents\\centipede.cent\\xbuild.x\nml:28: Compile failed; see the compiler error output for details.\n\nTotal time: 1 minute 2 seconds\n\nandroliv@ANDROLIV-W2K01 ~/deleteme/jakarta-poi\n$\n\nPlease fix and reopen.", "id": 35726, "time": "2003-04-21T21:18:50Z", "bug_id": 18947, "creation_time": "2003-04-21T21:18:50Z", "is_private": false}, {"count": 9, "tags": [], "text": "Created attachment 5939\nSorry,my private text editor seems to be dealing about the RETURN CODE at StringUtil incorrectly.If this patch is incorrect,please you insert StringUtil#putUncompressedUnicode() at the right position anywhere...", "is_private": false, "bug_id": 18947, "id": 35748, "time": "2003-04-22T03:50:07Z", "creator": "kamoshida.toshiaki@future.co.jp", "creation_time": "2003-04-22T03:50:07Z", "attachment_id": 5939}, {"count": 10, "tags": [], "bug_id": 18947, "text": "I resubmitted a PATCH.\nI changed the position of StringUtil#putUncomporessedUnicode().\nIf this patch is incorrect,please you insert StringUtil#putUncompressedUnicode\n() at the right position anywhere...", "id": 35749, "time": "2003-04-22T03:54:43Z", "creator": "kamoshida.toshiaki@future.co.jp", "creation_time": "2003-04-22T03:54:43Z", "is_private": false, "attachment_id": null}, {"count": 11, "tags": [], "text": "applied.  Thanks!", "is_private": false, "bug_id": 18947, "id": 35810, "time": "2003-04-22T16:41:25Z", "creator": "poi-support@buni.org", "creation_time": "2003-04-22T16:41:25Z", "attachment_id": null}, {"count": 12, "attachment_id": null, "bug_id": 18947, "is_private": false, "id": 41357, "time": "2003-07-24T15:55:17Z", "creator": "poi-support@buni.org", "creation_time": "2003-07-24T15:55:17Z", "tags": [], "text": "*** Bug 17791 has been marked as a duplicate of this bug. ***"}]