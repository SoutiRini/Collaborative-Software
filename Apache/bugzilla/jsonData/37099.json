[{"count": 0, "tags": [], "text": "I have an XML-formatted junit task declared as follows\n\n<junit printsummary=\"withOutAndErr\" haltonfailure=\"no\" \n  haltonerror=\"no\" showoutput=\"true\" fork=\"yes\" >\n   <classpath>\n     <pathelement path=\"${test.classpath}\" />\n   </classpath>                \n   <batchtest todir=\"${build}/test/junit-reports\">\n     <fileset dir=\"${unittest.classes}\">\n       <include name=\"**/Test*.*\" />\n       <exclude name=\"**/Test*$*.*\" />\n     </fileset>\n   </batchtest>\n   <formatter type=\"xml\" />\n</junit>\n\nIt works perfectly until I try to use forkmode=\"once\" or forkmode=\"perbatch\"\n(the default forkmode=\"pertest\" works fine.\n\n\nThe error on the console is that there was an error on the first test class on\nthe fileset. A closer look (on the XML file it produces) reveals the following:\n\n  <error\nmessage=\"testsfile=C:\\work\\branches\\HEAD\\workspace31\\fcdashboard\\junittestcases1710912823/properties\"\ntype=\"java.lang.ClassNotFoundException\">java.lang.ClassNotFoundException:\ntestsfile=C:\\work\\branches\\HEAD\\workspace31\\fcdashboard\\junittestcases1710912823/properties\nat java.lang.Class.forName0(Native Method) at\njava.lang.Class.forName(Class.java:141)</error> \n\nIt looks like it is not passing the class name of the junit test runner to the\nchild vm, so the VM tries to interpret the first parameter\n(message=\"testfile..\") as the class name.\n\nThis does not happen when the forkmode is pertest.\n\nTried (and failed) on ant 1.6.5 and ant 1.6.2, with junit 3.8.1.", "is_private": false, "bug_id": 37099, "id": 81170, "time": "2005-10-15T00:47:04Z", "creator": "david@hackerdude.com", "creation_time": "2005-10-15T00:47:04Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 37099, "attachment_id": null, "text": "Add the follow line to your classpath element in your junit section:\n<pathelement path=\"${java.class.path}\"/>\n\nIt Works for me.", "id": 87656, "time": "2006-04-07T07:40:49Z", "creator": "Rogier.Enders@logicacmg.com", "creation_time": "2006-04-07T07:40:49Z", "is_private": false}, {"count": 2, "tags": [], "text": "Check if you have an older version of ant hiding earlier on the classpath. This\ntiggered the same problem for me - in my case it was weblogic.jar which\nindirectly contained an old ant.\n\nOlder versions of the junit test runner don't know that a first argument\nstarting with 'testsfile=' mean 'multi-file' mode.", "is_private": false, "bug_id": 37099, "id": 91698, "time": "2006-07-28T14:16:34Z", "creator": "tony@palamon.ie", "creation_time": "2006-07-28T14:16:34Z", "attachment_id": null}, {"count": 3, "tags": [], "creator": "peterreilly@apache.org", "text": "Marking as WORKSFORME.\n#2 is most likely the correct reason for the issue.", "id": 94854, "time": "2006-10-16T07:47:32Z", "bug_id": 37099, "creation_time": "2006-10-16T07:47:32Z", "is_private": false, "attachment_id": null}]