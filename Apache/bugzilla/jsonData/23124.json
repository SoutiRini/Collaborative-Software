[{"count": 0, "tags": [], "bug_id": 23124, "text": "On Tru64 5.1A, if I try to configure Apache as\n\n./configure \\\n        --with-mpm=worker \\\n        --enable-threads \\\n        ...\n\nI get the following output from the configure processing:\n\n...\nChecking for Threads...\nchecking for pthreads_cflags... -pthread\nchecking for pthreads_lib... \nchecking pthread.h usability... yes\nchecking pthread.h presence... no\nconfigure: WARNING: pthread.h: accepted by the compiler, rejected by the preprocessor!\nconfigure: WARNING: pthread.h: proceeding with the preprocessor's result\nchecking for pthread.h... no\nAPR will be non-threaded\nchecking for sigsuspend... yes\nchecking for sigwait... no\nchecking for poll... yes\nchecking for getpwnam_r... yes\nchecking for getpwuid_r... yes\nchecking for getgrnam_r... yes\nchecking for getgrgid_r... yes\n...\n\nIf I specify CPPFLAGS=\"-pthread\" to ./configure, threads are correctly configured:\n\n...\nChecking for Threads...\nchecking for pthreads_cflags... \nchecking for pthreads_lib... \nchecking pthread.h usability... yes\nchecking pthread.h presence... yes\nchecking for pthread.h... yes\nchecking whether pthread_getspecific takes two arguments... no\nchecking whether pthread_attr_getdetachstate takes one argument... no\nchecking for pthread_key_delete... yes\nchecking for pthread_rwlock_init... yes\nAPR will use threads\nchecking for readdir in -lc_r... yes\nchecking for gethostbyname in -lc_r... yes\nchecking for gethostbyaddr in -lc_r... yes\nchecking for gethostbyname_r... yes\nchecking for gethostbyaddr_r... yes\nchecking for sigsuspend... yes\nchecking for sigwait... no\nchecking for poll... yes\nchecking for getpwnam_r... yes\nchecking for getpwuid_r... yes\nchecking for getgrnam_r... yes\nchecking for getgrgid_r... yes\n...\n\nAlternatively, the following patch to srclib/apr/build/apr_hints.m4 makes the explicit setting of \nCPPFLAGS unnecessary:\n\n*** apr_hints.m4.orig   Thu Sep 11 23:26:34 2003\n--- apr_hints.m4        Thu Sep 11 23:27:33 2003\n***************\n*** 155,161 ****\n        APR_SETIFNULL(apr_posixsem_is_global, [yes])\n        ;;\n      *-dec-osf*)\n!       APR_ADDTO(CPPFLAGS, [-DOSF1])\n        ;;\n      *-nto-qnx*)\n        ;;\n--- 155,161 ----\n        APR_SETIFNULL(apr_posixsem_is_global, [yes])\n        ;;\n      *-dec-osf*)\n!       APR_ADDTO(CPPFLAGS, [-DOSF1 -pthread])\n        ;;\n      *-nto-qnx*)\n        ;;", "id": 44081, "time": "2003-09-12T03:58:54Z", "creator": "Eric.J.Bivona@Dartmouth.EDU", "creation_time": "2003-09-12T03:58:54Z", "is_private": false, "attachment_id": null}, {"count": 1, "tags": [], "creator": "jorton@redhat.com", "attachment_id": null, "id": 51152, "time": "2004-01-25T18:25:13Z", "bug_id": 23124, "creation_time": "2004-01-25T18:25:13Z", "is_private": false, "text": "Thanks for the patch - I wonder if this is safe to do for all versions of Tru64,\nthough."}, {"count": 2, "tags": [], "creator": "Eric.J.Bivona@Dartmouth.EDU", "text": "This patch is needed for Tru64 5.1B as well, but it doesn't appear to be needed for Tru64 4.0D or \n4.0F, but I had other problems building under 4.0[DF] so I can't say for sure in that regard.", "id": 51224, "time": "2004-01-27T05:22:31Z", "bug_id": 23124, "creation_time": "2004-01-27T05:22:31Z", "is_private": false, "attachment_id": null}, {"count": 3, "tags": [], "bug_id": 23124, "text": "Can you confirm whether this is still necessary using the version of APR\nincluded in httpd 2.0.49, which has slightly different pthread detection logic?", "id": 59113, "time": "2004-06-11T15:29:57Z", "creator": "jorton@redhat.com", "creation_time": "2004-06-11T15:29:57Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 23124, "attachment_id": null, "text": "This appears to be resolved in the httpd-2.0.49 version of the code base.  Thanks!", "id": 59130, "time": "2004-06-11T18:45:44Z", "creator": "Eric.J.Bivona@Dartmouth.EDU", "creation_time": "2004-06-11T18:45:44Z", "is_private": false}]