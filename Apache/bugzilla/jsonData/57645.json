[{"attachment_id": null, "tags": [], "bug_id": 57645, "text": "The getContext() method incorrectly returns null when requesting the ROOT context (\"/\"). The following fix resolves the issue:\n\n    public ServletContext getContext(String uri) {\n\n        // Validate the format of the specified argument\n        if ((uri == null) || (!uri.startsWith(\"/\")))\n            return (null);\n\n        Context child = null;\n        try {\n            // Look for an exact match\n            Container host = context.getParent();\n            child = (Context) host.findChild(uri);\n            if ( (child == null) && \"/\".equals(uri) ) { // fix\n              child = (Context) host.findChild(\"\");     // fix\n            }                                           // fix\n\nThe root context was created via:\n\n  Context context = embedded.addWebapp(\"\", \"/path/to/webapps/ROOT\");", "count": 0, "id": 181385, "time": "2015-02-27T21:27:38Z", "creator": "karl.olson@gmail.com", "creation_time": "2015-02-27T21:27:38Z", "is_private": false}, {"count": 1, "tags": [], "creator": "chris@christopherschultz.net", "attachment_id": null, "id": 181389, "time": "2015-02-27T22:43:48Z", "bug_id": 57645, "creation_time": "2015-02-27T22:43:48Z", "is_private": false, "text": "I believe this was reported recently as a regression due to the fix for bug #57190 and fixed in r1661867 (trunk) r1662178 (Tomcat 8) and r1662179 (Tomcat 7).\n\nThere was no previous BZ issue for it, so this one is as good as any to document it.\n\nChangelog for the Tomcat 7 fix:\n\n  <fix>\n    Correct a regression in the fix for <bug>57190</bug> that incorrectly\n    required the path passed to\n    <code>ServletContext.getContext(String)</code> to be an exact match to a\n    path to an existing context. (markt)\n  </fix>\n\nThis fix will be included in Tomcat 7.0.60 and later."}, {"count": 2, "tags": [], "bug_id": 57645, "attachment_id": null, "is_private": false, "id": 181935, "time": "2015-03-21T22:06:06Z", "creator": "chris@christopherschultz.net", "creation_time": "2015-03-21T22:06:06Z", "text": "*** Bug 57733 has been marked as a duplicate of this bug. ***"}, {"count": 3, "tags": [], "bug_id": 57645, "attachment_id": null, "id": 187226, "creation_time": "2015-12-29T17:25:35Z", "time": "2015-12-29T17:25:35Z", "creator": "markt@apache.org", "text": "*** Bug 57733 has been marked as a duplicate of this bug. ***", "is_private": false}, {"count": 4, "tags": [], "bug_id": 57645, "attachment_id": null, "id": 187268, "creation_time": "2015-12-30T19:32:14Z", "time": "2015-12-30T19:32:14Z", "creator": "markt@apache.org", "text": "*** Bug 57733 has been marked as a duplicate of this bug. ***", "is_private": false}, {"count": 5, "tags": [], "bug_id": 57645, "attachment_id": null, "id": 187289, "creation_time": "2015-12-31T17:50:33Z", "time": "2015-12-31T17:50:33Z", "creator": "knst.kolinko@gmail.com", "text": "(In reply to Christopher Schultz from comment #1)\n> I believe this was reported recently as a regression due to the fix for bug\n> #57190 and fixed in r1661867 (trunk) r1662178 (Tomcat 8) and r1662179\n> (Tomcat 7).\n> \n> There was no previous BZ issue for it, so this one is as good as any to\n> document it.\n> \n\nFor a reference,\ndiscussion about ServletContext.getContext() API on dev@ list of that time,\n\nThread \"Two serious issues have been introduced in Tomcat 7 and Tomcat 8...\"\nstarted 2015-02-23,\nhttp://markmail.org/thread/wwfgnc6qwgaenwol", "is_private": false}, {"count": 6, "tags": [], "creator": "paul.taylor@trapezegroup.com", "attachment_id": null, "id": 200056, "time": "2017-07-26T13:14:02Z", "bug_id": 57645, "creation_time": "2017-07-26T13:14:02Z", "is_private": false, "text": "It looks like this bug was re-introduced on the Tomcat 7 branch in 7.0.61"}, {"count": 7, "tags": [], "bug_id": 57645, "attachment_id": null, "id": 200057, "creation_time": "2017-07-26T13:44:48Z", "time": "2017-07-26T13:44:48Z", "creator": "knst.kolinko@gmail.com", "text": "(In reply to Paul Taylor from comment #6)\n\nQuick test: It does work in 7.0.78.\n\nNote that the ServletContext.getContext() method is disabled by default for security reasons. It must be explicitly enabled by setting crossContext=\"true\" in Context configuration of the calling web application.", "is_private": false}, {"count": 8, "tags": [], "creator": "knst.kolinko@gmail.com", "attachment_id": 35180, "id": 200058, "time": "2017-07-26T13:48:23Z", "bug_id": 57645, "creation_time": "2017-07-26T13:48:23Z", "is_private": false, "text": "Created attachment 35180\ntest.war\n\nSample web application that demonstrates that the feature is working successfully.\n\nSteps:\n1. Deploy it as webapps/test.war\n2. Start Tomcat\n3. Access http://localhost:8080/test/\nIt prints:\ngetContext(\"/\"): org.apache.catalina.core.ApplicationContextFacade@16b6c55\n\nTested with 7.0.78."}]