[{"count": 0, "tags": [], "creator": "jrlawson@sbcglobal.net", "attachment_id": null, "text": "When I upgrade to Ant 1.5 my JUnit targets (that worked perfectly under \n1.4.1) barf. It seems like I don't have an appropriate parser. What should I \ndo????? I get the following trace:\n\nmaketestreports:\n    [junit] Running \ntest.com.mantra.huxley.ga.predicate.UnitTest_AndStopPredicate\n\nBUILD FAILED\njava.lang.LinkageError: loader constraints violated when linking \norg/w3c/dom/Document class\n        at \norg.apache.xerces.jaxp.DocumentBuilderFactoryImpl.newDocumentBuilder(DocumentBui\nlderFactoryImpl.java:88)\n        at \norg.apache.tools.ant.taskdefs.optional.junit.XMLJUnitResultFormatter.getDocument\nBuilder(XMLJUnitResultFormatter.java:\n93)\n        at \norg.apache.tools.ant.taskdefs.optional.junit.XMLJUnitResultFormatter.startTestSu\nite(XMLJUnitResultFormatter.java:138)\n\n        at \norg.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.fireStartTestSuite(\nJUnitTestRunner.java:433)\n        at \norg.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner\n.java:279)\n        at \norg.apache.tools.ant.taskdefs.optional.junit.JUnitTask.executeInVM(JUnitTask.jav\na:804)\n        at \norg.apache.tools.ant.taskdefs.optional.junit.JUnitTask.execute(JUnitTask.java:55\n1)\n        at \norg.apache.tools.ant.taskdefs.optional.junit.JUnitTask.execute(JUnitTask.java:52\n7)\n        at org.apache.tools.ant.Task.perform(Task.java:317)\n        at org.apache.tools.ant.Target.execute(Target.java:309)\n        at org.apache.tools.ant.Target.performTasks(Target.java:334)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1306)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1250)\n        at org.apache.tools.ant.Main.runBuild(Main.java:610)\n        at org.apache.tools.ant.Main.start(Main.java:196)\n        at org.apache.tools.ant.Main.main(Main.java:235)\n\n\nThe target looks like this:\n\n<target name=\"maketestreports\" depends=\"init,compile\">\n    <junit printsummary=\"yes\" haltonfailure=\"yes\">\n        <formatter type=\"xml\" usefile=\"yes\" />\n        <classpath>\n            <pathelement path=\"${temp.classes}\" />\n            <pathelement path=\"${model.classpath}\" />\n            <pathelement path=\"${product.classpath}\" />\n            <pathelement path=\"${java.class.path}\" />\n        </classpath>\n        <batchtest todir=\"${metrics.dir}/unittests\">\n    \t    <fileset dir=\"${classes.dir}\">\n      \t        <include name=\"test/**/*UnitTest_*.class\" />\n    \t    </fileset>\n  \t</batchtest>\t\t\t\n    </junit>\n</target>", "id": 19735, "time": "2002-07-18T01:23:06Z", "bug_id": 10931, "creation_time": "2002-07-18T01:23:06Z", "is_private": false}, {"count": 1, "tags": [], "creator": "joachim.simon@web.de", "attachment_id": null, "text": "In AntClassLoader(ClassLoader parent, Project project, Path classpath, boolean\nparentFirst) the package prefixes of jre packages are set.\nChanging the code to\n\n        addJavaLibraries();\n//        addSystemPackageRoot(\"java\");\n//        addSystemPackageRoot(\"javax\");\n\nsolved the problem. But perhaps there still was a reason for commenting out the\ncall to addJavaLibraries?\nThere is also a bug (one dot too many) in JavaEnvUtils.buildJrePackages(),\ncalled from addJavaLibraries, in the default branch of the switch statement,\nwhich lead to a ClassNotFoundException for sun.**.", "id": 20031, "time": "2002-07-23T09:24:20Z", "bug_id": 10931, "creation_time": "2002-07-23T09:24:20Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 10931, "attachment_id": null, "id": 20069, "time": "2002-07-23T18:15:14Z", "creator": "stevel@apache.org", "creation_time": "2002-07-23T18:15:14Z", "is_private": false, "text": "Joachim: We havent turned the addLibraries() on for ant1.5 as it went in too\nlate for rigorous testing, so it was left off, but left in there for people in\nemergencies. I might just turn it on now in the 1.6alpha to see what happens.\nCorrected the \"sun.\" to \"sun\", though, since we just use indexOf, it may be\nbetter to go the other way and have sun., java. javax., etc in the list. \n"}, {"count": 3, "tags": [], "creator": "stevel@apache.org", "attachment_id": null, "text": "Jamie.\n\nOne change from 1.4.1 to 1.5 is the move to xerces over crimson. we did find\nsome funnies with locating xml parsers in the betas, but thought we had fixed\nthem with a modification of the manifest of ant.jar\n\nWhat happens if you fork junit?", "id": 20070, "time": "2002-07-23T18:17:47Z", "bug_id": 10931, "creation_time": "2002-07-23T18:17:47Z", "is_private": false}, {"count": 4, "tags": [], "creator": "sbailliez@apache.org", "attachment_id": null, "text": "Setting as duplicate to the meta bug concerning classloaders and \nchanged 'formatter' to 'classloading' in the summary title as it was \nmisleading.\n\n*** This bug has been marked as a duplicate of 6606 ***", "id": 21170, "time": "2002-08-16T15:26:17Z", "bug_id": 10931, "creation_time": "2002-08-16T15:26:17Z", "is_private": false}]