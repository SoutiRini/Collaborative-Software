[{"count": 0, "tags": [], "bug_id": 33718, "attachment_id": null, "id": 71428, "time": "2005-02-23T22:31:53Z", "creator": "bugzilla@soebes.de", "creation_time": "2005-02-23T22:31:53Z", "is_private": false, "text": "Using an <scp> Task using the following:\n\n<scp keyfile=\"/home/kama/keys/${scp.key.file}\"\n     file=\"index.html\"\n     todir=\"${scp.user}@${scp.host}:${scp.destination}\" />\nThis will result in the Message:\n\"neither password nor passphrase for user root has been given.  Can't authenticate\"\n\nI have taken a look into the Ant sources where i have found the\nFile scp.java (Method parseUri ()) where it will be checked the user@host:dest\ncombination but it will be ignored that i have given a keyfile.\n\nBTW: The functionality is described in the Ant Manual."}, {"count": 1, "tags": [], "creator": "alexeys@inventigo.com", "attachment_id": null, "text": "Please check that you can do it on a command line. It is possible that /root/.ssh \nfolder has wrong permissions, so the key files are ignored. It is also a bad idea \nto log (even automatically!) as a root. The prefered way is to login as a normal \nuser and setup sudo to run some commands.", "id": 71429, "time": "2005-02-23T22:37:19Z", "bug_id": 33718, "creation_time": "2005-02-23T22:37:19Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 33718, "attachment_id": null, "is_private": false, "id": 71434, "time": "2005-02-23T22:46:26Z", "creator": "bugzilla@soebes.de", "creation_time": "2005-02-23T22:46:26Z", "text": "scp -i keyfile sourcefile root@host:/destination \nis correcly working on command line under the same user as working with Ant.\n(Thanks for the security issues).\n"}, {"count": 3, "tags": [], "bug_id": 33718, "attachment_id": null, "is_private": false, "id": 71437, "time": "2005-02-23T22:51:23Z", "creator": "alexeys@inventigo.com", "creation_time": "2005-02-23T22:51:23Z", "text": "Try specifying \"-v\" option to ANT. Please make sure that the path to keyfile is correct.\nIf nothing helps you still can use <exec> to run scp."}, {"count": 4, "tags": [], "text": "I have added the -v option to the calling of Ant:\nI got the following output:\nBUILD FAILED\n/home/kama/public_html/www.soebes.de.neu/build.xml:50: neither password nor\npassphrase for user root has been given.  Can't authenticate.\n        at org.apache.tools.ant.taskdefs.optional.ssh.Scp.execute(Scp.java:187)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:275)\n        at org.apache.tools.ant.Task.perform(Task.java:364)\n        at org.apache.tools.ant.Target.execute(Target.java:341)\n        at org.apache.tools.ant.Target.performTasks(Target.java:369)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1214)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1062)\n        at org.apache.tools.ant.Main.runBuild(Main.java:673)\n        at org.apache.tools.ant.Main.startAnt(Main.java:188)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:196)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:55)\nCaused by: neither password nor passphrase for user root has been given.  Can't\nauthenticate.\n        at org.apache.tools.ant.taskdefs.optional.ssh.Scp.parseUri(Scp.java:276)\n        at org.apache.tools.ant.taskdefs.optional.ssh.Scp.upload(Scp.java:245)\n        at org.apache.tools.ant.taskdefs.optional.ssh.Scp.execute(Scp.java:176)\n        ... 10 more\n--- Nested Exception ---\nneither password nor passphrase for user root has been given.  Can't authenticate.\n        at org.apache.tools.ant.taskdefs.optional.ssh.Scp.parseUri(Scp.java:276)\n        at org.apache.tools.ant.taskdefs.optional.ssh.Scp.upload(Scp.java:245)\n        at org.apache.tools.ant.taskdefs.optional.ssh.Scp.execute(Scp.java:176)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:275)\n        at org.apache.tools.ant.Task.perform(Task.java:364)\n        at org.apache.tools.ant.Target.execute(Target.java:341)\n        at org.apache.tools.ant.Target.performTasks(Target.java:369)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1214)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1062)\n        at org.apache.tools.ant.Main.runBuild(Main.java:673)\n        at org.apache.tools.ant.Main.startAnt(Main.java:188)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:196)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:55)\n\nThis will show that the checking will done in the Scp.java file as i wrote but\nignoring the keyfile attribute.\n", "is_private": false, "id": 71438, "creator": "bugzilla@soebes.de", "time": "2005-02-23T22:55:38Z", "bug_id": 33718, "creation_time": "2005-02-23T22:55:38Z", "attachment_id": null}, {"count": 5, "tags": [], "bug_id": 33718, "attachment_id": null, "id": 71598, "time": "2005-02-28T11:27:59Z", "creator": "eric.jain@gmail.com", "creation_time": "2005-02-28T11:27:59Z", "is_private": false, "text": "The problem here is that the scp task insists on having a passphrase when using\nkey authentication, but it is quite possible to have a key without a passphrase!\n\nYou can trick the task by specifying a passphrase that consists of a single\nspace... \n\nPerhaps the passphrase property should be optional?"}, {"count": 6, "tags": [], "bug_id": 33718, "attachment_id": null, "is_private": false, "id": 71923, "time": "2005-03-07T21:06:46Z", "creator": "bugzilla@soebes.de", "creation_time": "2005-03-07T21:06:46Z", "text": "> The problem here is that the scp task insists on having a passphrase when using\n> key authentication, but it is quite possible to have a key without a passphrase!\n> \n> You can trick the task by specifying a passphrase that consists of a single\n> space...\nOk. That worked but now i got the following message if i try to transfer\na while dir tree... \n\n/home/kama/public_html/www.soebes.de.neu/build.xml:63: server indicated an\nerror: scp: protocol error: received directory without -r\n        at org.apache.tools.ant.taskdefs.optional.ssh.Scp.execute(Scp.java:187)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:275)\n        at org.apache.tools.ant.Task.perform(Task.java:364)\n        at org.apache.tools.ant.Target.execute(Target.java:341)\n        at org.apache.tools.ant.Target.performTasks(Target.java:369)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1214)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1062)\n        at org.apache.tools.ant.Main.runBuild(Main.java:673)\n        at org.apache.tools.ant.Main.startAnt(Main.java:188)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:196)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:55)\nCaused by: server indicated an error: scp: protocol error: received directory\nwithout -r\n        at\norg.apache.tools.ant.taskdefs.optional.ssh.AbstractSshMessage.waitForAck(AbstractSshMessage.java:93)\n        at\norg.apache.tools.ant.taskdefs.optional.ssh.ScpToMessage.sendDirectoryToRemote(ScpToMessage.java:156)\n        at\norg.apache.tools.ant.taskdefs.optional.ssh.ScpToMessage.sendDirectory(ScpToMessage.java:142)\n        at\norg.apache.tools.ant.taskdefs.optional.ssh.ScpToMessage.doMultipleTransfer(ScpToMessage.java:125)\n        at\norg.apache.tools.ant.taskdefs.optional.ssh.ScpToMessage.execute(ScpToMessage.java:87)\n        at org.apache.tools.ant.taskdefs.optional.ssh.Scp.upload(Scp.java:234)\n        at org.apache.tools.ant.taskdefs.optional.ssh.Scp.execute(Scp.java:174)\n        ... 10 more\n--- Nested Exception ---\nserver indicated an error: scp: protocol error: received directory without -r\n        at\norg.apache.tools.ant.taskdefs.optional.ssh.AbstractSshMessage.waitForAck(AbstractSshMessage.java:93)\n        at\norg.apache.tools.ant.taskdefs.optional.ssh.ScpToMessage.sendDirectoryToRemote(ScpToMessage.java:156)\n        at\norg.apache.tools.ant.taskdefs.optional.ssh.ScpToMessage.sendDirectory(ScpToMessage.java:142)\n        at\norg.apache.tools.ant.taskdefs.optional.ssh.ScpToMessage.doMultipleTransfer(ScpToMessage.java:125)\n        at\norg.apache.tools.ant.taskdefs.optional.ssh.ScpToMessage.execute(ScpToMessage.java:87)\n        at org.apache.tools.ant.taskdefs.optional.ssh.Scp.upload(Scp.java:234)\n        at org.apache.tools.ant.taskdefs.optional.ssh.Scp.execute(Scp.java:174)\n        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:275)\n        at org.apache.tools.ant.Task.perform(Task.java:364)\n        at org.apache.tools.ant.Target.execute(Target.java:341)\n        at org.apache.tools.ant.Target.performTasks(Target.java:369)\n        at org.apache.tools.ant.Project.executeTarget(Project.java:1214)\n        at org.apache.tools.ant.Project.executeTargets(Project.java:1062)\n        at org.apache.tools.ant.Main.runBuild(Main.java:673)\n        at org.apache.tools.ant.Main.startAnt(Main.java:188)\n        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:196)\n        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:55)\n\nTotal time: 4 seconds\n\n"}, {"count": 7, "tags": [], "bug_id": 33718, "attachment_id": null, "id": 118726, "time": "2008-07-16T08:43:39Z", "creator": "bodewig@apache.org", "creation_time": "2008-07-16T08:43:39Z", "is_private": false, "text": "I'll make this issue about not supporting keyfiles without passphrases.\n\nComment #6 should be addressed separately if it still exists in Ant 1.7.1 and a recent JSch version."}, {"count": 8, "tags": [], "bug_id": 33718, "attachment_id": null, "is_private": false, "id": 118747, "time": "2008-07-17T01:23:30Z", "creator": "bodewig@apache.org", "creation_time": "2008-07-17T01:23:30Z", "text": "as of subversion revision 677532 passphrase is no longer a required attribute."}]