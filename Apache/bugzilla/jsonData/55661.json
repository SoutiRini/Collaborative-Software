[{"count": 0, "tags": [], "bug_id": 55661, "attachment_id": null, "is_private": false, "id": 170647, "time": "2013-10-17T11:16:43Z", "creator": "ofra@ivu.de", "creation_time": "2013-10-17T11:16:43Z", "text": "Hi,\nexcel provides the option \"shrink to fit\" for a cell, which autosizes the content of the cell, if it is too long.\nUnfortunately it is not possible to set this option using POI.\n\nSince the class \"org.openxmlformats.schemas.spreadsheetml.x2006.main.CTCellAlignment\" already supports this option, the necessessary enhancement should be quite simple.\nI just need the following methods in XSSFCellStyle:\n\npublic void setShrinkToFit(boolean shrinkToFit) {\n    getCellAlignment().setShrinkToFit(shrinkToFit);\n}\n\npublic boolean getShrinkToFit() {\n    CTCellAlignment align = _cellXf.getAlignment();\n    return align != null && align.isSetShrinkToFit();\n}\n\nRegards\nOliver"}, {"attachment_id": null, "tags": [], "bug_id": 55661, "is_private": false, "count": 1, "id": 170755, "time": "2013-10-22T22:12:50Z", "creator": "apache@gagravarr.org", "creation_time": "2013-10-22T22:12:50Z", "text": "Does Excel support this for .xls files, or is it .xlsx only?\n\n(That would affect if we need to put it on the interface or not, and if we therefore need to get a test .xls file to identify the record there)"}, {"count": 2, "tags": [], "creator": "ofra@ivu.de", "attachment_id": 30956, "text": "Created attachment 30956\nTest file containing the option \"shrink to fit\"\n\nExcel supports this for .xls files too. I've added a test document which contains a cell with this option.", "id": 170760, "time": "2013-10-23T06:21:49Z", "bug_id": 55661, "creation_time": "2013-10-23T06:21:49Z", "is_private": false}, {"count": 3, "tags": [], "text": "If you have some time, any chance you could create two very similar and simple .xls files? Firstly create one without shrink to fit, then open the same file + set shrink to fit + save-as. (Should help ensure they're very similar). Then, run org.apache.poi.hssf.dev.BiffViewer against the two, and diff the output. With any luck, that will flag up the record that gets changed, along with the option to do it!", "is_private": false, "id": 170763, "creator": "apache@gagravarr.org", "time": "2013-10-23T09:49:56Z", "bug_id": 55661, "creation_time": "2013-10-23T09:49:56Z", "attachment_id": null}, {"count": 4, "tags": [], "text": "Hi POI developer,\nexcel provides the option \"shrink to fit\" for a cell, which autosizes the content of the cell, if it is too long in version 3.7. but I can't find the method 'setShrinkToFit' in class \"org.apache.poi.hssf.usermodel.HSSFCellStyle\" at version 3.9.", "attachment_id": null, "id": 170822, "creator": "lsj8080@yeah.net", "time": "2013-10-25T02:41:06Z", "bug_id": 55661, "creation_time": "2013-10-25T02:41:06Z", "is_private": false}, {"count": 5, "tags": [], "text": "I've created both test files (with and without shrink to fit) and diffed the output of BiffViewer. Unfortunately there are 275 differences between them.\nBut in the output for the file with shrink to fit a found the entry \".shrinktoft= true\" in line 3475. I hope/guess this is the important difference between these files.", "attachment_id": null, "id": 170830, "creator": "ofra@ivu.de", "time": "2013-10-25T08:08:00Z", "bug_id": 55661, "creation_time": "2013-10-25T08:08:00Z", "is_private": false}, {"attachment_id": 30967, "tags": [], "bug_id": 55661, "is_private": false, "count": 6, "id": 170831, "time": "2013-10-25T08:08:41Z", "creator": "ofra@ivu.de", "creation_time": "2013-10-25T08:08:41Z", "text": "Created attachment 30967\nThe output of BiffViewer for a file without shrink to fit"}, {"count": 7, "tags": [], "creator": "ofra@ivu.de", "attachment_id": 30968, "text": "Created attachment 30968\nThe output of BiffViewer for a file with shrink to fit", "id": 170832, "time": "2013-10-25T08:09:29Z", "bug_id": 55661, "creation_time": "2013-10-25T08:09:29Z", "is_private": false}, {"count": 8, "tags": [], "text": "(In reply to Oliver Frank from comment #5)\n>  for the file with shrink to fit a found the entry\n> \".shrinktoft= true\" in line 3475.\n\nThat looks very likely to be what we need! Which record does this live in? (Should be a few lines about that in the output)", "is_private": false, "id": 170872, "creator": "apache@gagravarr.org", "time": "2013-10-28T11:29:15Z", "bug_id": 55661, "creation_time": "2013-10-28T11:29:15Z", "attachment_id": null}, {"count": 9, "tags": [], "bug_id": 55661, "attachment_id": null, "id": 170901, "time": "2013-10-29T07:24:35Z", "creator": "ofra@ivu.de", "creation_time": "2013-10-29T07:24:35Z", "is_private": false, "text": "Here is the record, in which this line occurs:\nOffset=0x00000C9A(3226) recno=114 sid=0x00E0 size=0x0014(20)\n[EXTENDEDFORMAT]\n CELL_RECORD_TYPE\n    .fontindex       = 0\n    .formatindex     = 0\n    .celloptions     = 1\n          .islocked  = true\n          .ishidden  = false\n          .recordtype= 0\n          .parentidx = 0\n    .alignmentoptions= 20\n          .alignment = 0\n          .wraptext  = false\n          .valignment= 2\n          .justlast  = 0\n          .rotation  = 0\n    .indentionoptions= 1010\n          .indent    = 0\n          .shrinktoft= true\n          .mergecells= false\n          .readngordr= 0\n          .formatflag= false\n          .fontflag  = false\n          .prntalgnmt= true\n          .borderflag= false\n          .paternflag= false\n          .celloption= false\n    .borderoptns     = 0\n          .lftln     = 0\n          .rgtln     = 0\n          .topln     = 0\n          .btmln     = 0\n    .paleteoptns     = 0\n          .leftborder= 0\n          .rghtborder= 0\n          .diag      = 0\n    .paleteoptn2     = 2000000\n          .topborder = 0\n          .botmborder= 0\n          .adtldiag  = 0\n          .diaglnstyl= 0\n          .fillpattrn= 0\n    .fillpaloptn     = 20c0\n          .foreground= 40\n          .background= 41\n[/EXTENDEDFORMAT]\n\nDoes this contain the information, that you need?"}, {"attachment_id": null, "tags": [], "bug_id": 55661, "is_private": false, "count": 10, "id": 171136, "time": "2013-11-07T22:39:57Z", "creator": "apache@gagravarr.org", "creation_time": "2013-11-07T22:39:57Z", "text": "Thanks for your investigations, and test files\n\nI've added support in r1539848, along with unit tests for it in r1539850."}]