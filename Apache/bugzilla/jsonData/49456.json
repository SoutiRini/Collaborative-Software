[{"count": 0, "tags": [], "bug_id": 49456, "attachment_id": 25607, "id": 137714, "time": "2010-06-17T11:48:00Z", "creator": "Clement_Pellerin@ibi.com", "creation_time": "2010-06-17T11:48:00Z", "is_private": false, "text": "Created attachment 25607\nsource code patch and new junit\n\nThe return type of StorageResolver.next() is X509Certificate, but the implementation attempts to return a StorageResolverSpi instance causing a ClassCastException. The way the KeyResolvers call this method, it appears the API is correct but the implementation is wrong."}, {"count": 1, "tags": [], "text": "\nThanks, I'll take a look. You may have missed my reply to your mail on the security-dev list (reproduced below):\n\nHi Clement,\n\nI took a look at this issue after applying your patches for the other\nStorageResolver stuff.\n\nThere's clearly an issue in StorageResolver, in that calling \"next\"\nreturns the next object in the StorageResolverIterator, which is a\nStorageResolverSpi instance, not an X509Certificate. The solution here\nis to fix the StorageResolverIterator so that it iterates over both\nthe \"outer\" and \"inner\" iterators looking for the next certificate.\n\nI also noticed that a few other StorageResolverSpi instances cache the\niterator rather than create a new one each time, which is clearly a\nbug.\n\nI don't like the \"hasNext()\" and \"next()\" methods of StorageResolver.\nInstead the user should get the iterator and use that instead. I will\nmake these changes, and create a patch in a new Bugzilla entry which\nyou can review, if you'd like.\n\nColm.", "attachment_id": null, "id": 137715, "creator": "coheigea@apache.org", "time": "2010-06-17T11:53:18Z", "bug_id": 49456, "creation_time": "2010-06-17T11:53:18Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 49456, "attachment_id": null, "id": 137720, "time": "2010-06-17T12:29:47Z", "creator": "Clement_Pellerin@ibi.com", "creation_time": "2010-06-17T12:29:47Z", "is_private": false, "text": "Maybe your email was caught in our spam filter. I'll know tomorrow.\nI already logged a patch for this in Bug 49458.\nSince the summary line is so small, I'm trying to keep each bug separate."}, {"count": 3, "tags": [], "bug_id": 49456, "attachment_id": null, "text": "\nPatch applied, thanks.\n\nColm.", "id": 137738, "time": "2010-06-18T07:20:16Z", "creator": "coheigea@apache.org", "creation_time": "2010-06-18T07:20:16Z", "is_private": false}]