[{"count": 0, "tags": [], "bug_id": 46509, "attachment_id": null, "id": 123927, "creation_time": "2009-01-10T19:02:53Z", "time": "2009-01-10T19:02:53Z", "creator": "curufir@googlemail.com", "text": "The problem happens when using the security example (jsp-examples/security/) in tomcat 5.5.\n\nIf the user enters their password incorrectly they are redirected to error.jsp which has a link back to login.jsp. If you use this link and login with the correct credentials login.jsp is reloaded. If you try to login a 2nd time with the correct credentials you receive an error \"The requested resource (/jsp-examples/security/protected/j_security_check) is not available.\"\n\nThe problem is pretty simple. Since login.jsp, index.jsp and error.jsp are all in a secure realm using the link in error.jsp to reach login.jsp triggers authentication which brings up login.jsp as this is specified as <form-login-page> in web.xml.\n\nWhen the user is authenticated they are taken to the page in the realm they requested, which in this case is login.jsp. When they try to login for the 2nd time they get the error because they have already been authenticated and they are trying to load j_security_check (loading index.jsp proves they are logged in).\n\nThis fixes it:\n\nIn /jsp-examples/security/protected/error.jsp\n\nChange:\n<a href='<%= response.encodeURL(\"login.jsp\") %>'>again</a>.\n\nTo:\n<a href='<%= response.encodeURL(\"/\") %>'>again</a>.\n\nOnly checked on Windows and Linux, but since Tomcat is doing what it's supposed to do I imagine the example exhibits this behaviour on all platforms.", "is_private": false}, {"count": 1, "attachment_id": null, "bug_id": 46509, "is_private": false, "id": 123928, "time": "2009-01-10T20:12:55Z", "creator": "curufir@googlemail.com", "creation_time": "2009-01-10T20:12:55Z", "tags": [], "text": "Typo in the fix\n\nIn /jsp-examples/security/protected/error.jsp\n\nChange:\n<a href='<%= response.encodeURL(\"login.jsp\") %>'>again</a>.\n\nTo:\n<a href='<%= response.encodeURL(\"index.jsp\") %>'>again</a>.\n"}, {"count": 2, "tags": [], "bug_id": 46509, "attachment_id": null, "id": 126102, "time": "2009-04-08T10:17:34Z", "creator": "markt@apache.org", "creation_time": "2009-04-08T10:17:34Z", "is_private": false, "text": "Thanks for the patch. It has been applied to trunk and proposed for 6.0.x and 5.5.x"}, {"count": 3, "tags": [], "creator": "markt@apache.org", "text": "This has been fixed in 6.0.x and will be included in 6.0.20 onwards.", "id": 126733, "time": "2009-05-02T18:19:49Z", "bug_id": 46509, "creation_time": "2009-05-02T18:19:49Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 46509, "text": "This has been fixed in 5.5.x and will be included in 5.5.28 onwards. Thanks again for the patch.", "id": 127638, "time": "2009-06-04T07:37:44Z", "creator": "markt@apache.org", "creation_time": "2009-06-04T07:37:44Z", "is_private": false, "attachment_id": null}]