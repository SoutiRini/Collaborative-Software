[{"count": 0, "tags": [], "creator": "Petr.Udalau@exigenservices.com", "attachment_id": 24235, "text": "Created attachment 24235\nPatch with implementation.\n\nSystematized work of ToolPacks(Created ToolPack interface and class\nMainToolPacksHandler). Improved resolving of UDFs(in class\nUserDefinedFunction). Workbook now contains Map of UDFs by name(added methods\nto register and find).", "id": 130237, "time": "2009-09-09T04:20:11Z", "bug_id": 47809, "creation_time": "2009-09-09T04:20:11Z", "is_private": false}, {"count": 1, "tags": [], "bug_id": 47809, "attachment_id": null, "id": 130346, "time": "2009-09-13T09:25:32Z", "creator": "yegor@dinom.ru", "creation_time": "2009-09-13T09:25:32Z", "is_private": false, "text": "Petr,\n\nThe patch looks OK, but I'm very reluctant to apply it without a single unit test.\nCan you upload some? Unit tests are needed not only for quality assurance, but they also serve as code examples helping users to understand how the code works and  how to use it.\n\nRegards,\nYegor"}, {"count": 2, "tags": [], "bug_id": 47809, "attachment_id": 24268, "id": 130412, "time": "2009-09-15T05:06:58Z", "creator": "Petr.Udalau@exigenservices.com", "creation_time": "2009-09-15T05:06:58Z", "is_private": false, "text": "Created attachment 24268\nzip with patch and TestData\n\nThere is a patch with test.\nTest: internal VB function and function in ToolPack.\n\nAlso there is one problem with Names of Workbook: if I set value for cell inside the POI cell.setCellFormula(\"ISODD(1)\")(function \"ISODD\" defined in AnalysisToolPak) error will occur:\norg.apache.poi.ss.formula.FormulaParser$FormulaParseException: Name 'ISODD' is completely unknown in the current workbook\n\tat org.apache.poi.ss.formula.FormulaParser.function(FormulaParser.java:932)\n\tat org.apache.poi.ss.formula.FormulaParser.parseNonRange(FormulaParser.java:570)\n\tat org.apache.poi.ss.formula.FormulaParser.parseRangeable(FormulaParser.java:442)\n\tat org.apache.poi.ss.formula.FormulaParser.parseRangeExpression(FormulaParser.java:285)\n\tat org.apache.poi.ss.formula.FormulaParser.parseSimpleFactor(FormulaParser.java:1131)\n\tat org.apache.poi.ss.formula.FormulaParser.percentFactor(FormulaParser.java:1091)\n\tat org.apache.poi.ss.formula.FormulaParser.powerFactor(FormulaParser.java:1078)\n\tat org.apache.poi.ss.formula.FormulaParser.Term(FormulaParser.java:1400)\n\tat org.apache.poi.ss.formula.FormulaParser.additiveExpression(FormulaParser.java:1500)\n\tat org.apache.poi.ss.formula.FormulaParser.concatExpression(FormulaParser.java:1484)\n\tat org.apache.poi.ss.formula.FormulaParser.comparisonExpression(FormulaParser.java:1441)\n\tat org.apache.poi.ss.formula.FormulaParser.unionExpression(FormulaParser.java:1421)\n\tat org.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:1542)\n\tat org.apache.poi.ss.formula.FormulaParser.parse(FormulaParser.java:193)\n\tat org.apache.poi.hssf.model.HSSFFormulaParser.parse(HSSFFormulaParser.java:69)\n\tat org.apache.poi.hssf.usermodel.HSSFCell.setCellFormula(HSSFCell.java:598).\n\nWork with Names must be fixed."}, {"count": 3, "tags": [], "bug_id": 47809, "attachment_id": null, "id": 130461, "time": "2009-09-16T12:22:59Z", "creator": "yegor@dinom.ru", "creation_time": "2009-09-16T12:22:59Z", "is_private": false, "text": "Applied in r815928\n\nFormulaParseException is another issue, I'm sure we will fix it in nearest future.\n\nThanks,\nYegor"}, {"count": 4, "tags": [], "text": "Major modifications made in svn r816016\n\nThere were a few problems with the code as originally submitted:\n\n (1) Naming - The name \"ToolPack\" is not general enough  (\"AnalysisToolPak\" is just one \"Add-in\" library).  The sub-package has been changed to \"udf\".  The classes have been changed to \"*UDFFinder\". \"UDFFinder\" refers to any collection of UDFs: external (\"Add-ins\" libraries) or internal (VB modules).\n\n (2) Mutability - Implementors of UDFFinder should be immutable (there is no need to change UDFs once evaluation has begun).\n\n (3) Registration - since we are only dealing with evaluation of UDFs, this a concern of the formula evaluator (not the xSSFWorkbook).  The patch code seemed to suggest that it was also maintaining the defined name records within the workbook, but that code looked too simple to be complete.  I am pretty sure that additional updates needed elsewhere in the LinkTable, like the SUPBOOK records.  We will probably need some method that does this (creating DEFINEDNAME records etc for UDFs used in a workbook) to address the parser error you describe above.  In any case, the workbook does not need to know about the the UDF evaluation implementation - e.g. the user may be writing formulas but not evaluating them.  \n\n\n\n\nPlease take a look at the changes and make sure that the functionality you desire is still available.", "is_private": false, "id": 130471, "creator": "josh@apache.org", "time": "2009-09-16T17:46:47Z", "bug_id": 47809, "creation_time": "2009-09-16T17:46:47Z", "attachment_id": null}]