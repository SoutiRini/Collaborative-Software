[{"count": 0, "tags": [], "bug_id": 49441, "attachment_id": null, "id": 137645, "time": "2010-06-15T04:02:34Z", "creator": "aristar@mail.ru", "creation_time": "2010-06-15T04:02:34Z", "is_private": false, "text": "If used an encoding other than Cp1252 StringChunk returns incorrect value. To solve this issue whe added setCharset method to MAPIMessage, Chunks and StringChunk."}, {"text": "Have you tried with a recent nightly build? HSMF has undergone a lot of changes since 3.6\n\nFor String chunks which aren't stored as unicode, we assume they're CP1252 based on all the files we've seen - outlook should generally store them as one of those two. If you have found a file that differs, please do upload it, and also please help us track down where in the file that charset is stored!", "tags": [], "bug_id": 49441, "attachment_id": null, "count": 1, "id": 137662, "time": "2010-06-15T09:48:13Z", "creator": "apache@gagravarr.org", "creation_time": "2010-06-15T09:48:13Z", "is_private": false}, {"count": 2, "tags": [], "text": "Created attachment 25594\nMessage with cyrillic fields", "is_private": false, "id": 137670, "creator": "aristar@mail.ru", "time": "2010-06-16T01:21:18Z", "bug_id": 49441, "creation_time": "2010-06-16T01:21:18Z", "attachment_id": 25594}, {"count": 3, "tags": [], "bug_id": 49441, "attachment_id": null, "is_private": false, "id": 137671, "time": "2010-06-16T01:22:18Z", "creator": "aristar@mail.ru", "creation_time": "2010-06-16T01:22:18Z", "text": "I dont tried other versions than 3.6, but in the head revision StringChunk (from SVN) hardcoded Cp1252. (1251 - Cyrillic)"}, {"count": 4, "tags": [], "bug_id": 49441, "attachment_id": null, "is_private": false, "id": 137979, "time": "2010-06-29T09:30:33Z", "creator": "apache@gagravarr.org", "creation_time": "2010-06-29T09:30:33Z", "text": "Unfortunately I can't seem to spot anything in the file which indicates the encoding\n\nIf you open the file on a different machine which has a different system language set, does it look correct or do you get the wrong characters showing up?"}, {"count": 5, "tags": [], "bug_id": 49441, "attachment_id": null, "is_private": false, "id": 138203, "time": "2010-07-06T03:57:19Z", "creator": "aristar@mail.ru", "creation_time": "2010-07-06T03:57:19Z", "text": "I tried on a system with an English localization. If not set the Language for Non-Unicode Programs to Russian then message open with wrong characters."}, {"count": 6, "tags": [], "bug_id": 49441, "attachment_id": null, "id": 138847, "time": "2010-08-03T12:07:45Z", "creator": "apache@gagravarr.org", "creation_time": "2010-08-03T12:07:45Z", "is_private": false, "text": "Fixed in r981947.\n\nThere is now a guess7BitEncoding() method on MAPIMessage, which looks in the headers to guess the encoding, then calls the new set encoding method on the string chunks"}]