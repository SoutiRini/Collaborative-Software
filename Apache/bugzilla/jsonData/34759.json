[{"count": 0, "tags": [], "creator": "eross@m-qube.com", "attachment_id": null, "id": 74481, "time": "2005-05-05T15:13:54Z", "bug_id": 34759, "creation_time": "2005-05-05T15:13:54Z", "is_private": false, "text": "Suggested change:\n\n1.\n class PatternConverter {\n\n-  protected abstract StringBuffer convert(LoggingEvent event);\n+  protected abstract void convert(StringBuffer sb, LoggingEvent event);\n\n2. Make Layout thread-safe.\n3. Change PatternConverter to append to a StringBuffer first, then the writer.  \nReason:\n\n* Overall performance is about twice the old implementation, and you get a\nbetter API and underlying code to boot.\n* Using a Writer (even CharArrayWriter) may be slow since each call requires a\ncheck if the Writer is closed, among other things.\n* Allows PatternConverter to create no additional StringBuffer objects, and also\nbe written in a thread-safe manner\n* According to some, the JVM cannot optimize locks very well if objects are\nbeing reused between threads.\n* Allows the implemented PatternConverter instances to be re-used (object\npooling) if this makes sense in the future.\n* Allows Layout to be written in a thread-safe manner.  Meaning, a Layout class\ncan be called from multiple threads."}, {"count": 1, "tags": [], "bug_id": 34759, "attachment_id": 14940, "is_private": false, "id": 74482, "time": "2005-05-05T15:14:23Z", "creator": "eross@m-qube.com", "creation_time": "2005-05-05T15:14:23Z", "text": "Created attachment 14940\nChanges to src tree"}, {"count": 2, "tags": [], "creator": "carnold@apache.org", "attachment_id": null, "text": "An abstract member in a public class can not be deleted and replaced with a\ndifferent signature without breaking source and binary compatibility.  With the\npatch dated 2005-05-05, any user provided PatternConverter would fail (I'm\nguessing with a NoSuchMethodException).  There are also public members removed\nfrom classes which also would break compatibility, but with likely less drastic\naffects.\n\nThe existing signature is ugly, but it can't simply be changed in a 1.2 or 1.3\nrelease.  I'm marking as NEEDINFO in case you want to resubmit a patch that\naddresses the issue without breaking compatibility, but should eventually be\nclosed if no patch is submitted.", "id": 95844, "time": "2006-11-14T14:34:27Z", "bug_id": 34759, "creation_time": "2006-11-14T14:34:27Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 34759, "attachment_id": null, "text": "\nThis is out of date.", "id": 98632, "time": "2007-01-28T03:04:04Z", "creator": "genman@noderunner.net", "creation_time": "2007-01-28T03:04:04Z", "is_private": false}, {"count": 4, "tags": [], "creator": "genman@noderunner.net", "attachment_id": null, "text": "This is out of date.", "id": 98633, "time": "2007-01-28T03:04:11Z", "bug_id": 34759, "creation_time": "2007-01-28T03:04:11Z", "is_private": false}]