[{"count": 0, "tags": [], "bug_id": 59062, "attachment_id": null, "text": "Hello,\n\nSporadically i get this exception in catalina.out.\nThis exeption appeared since upgrading from tomcat 7.0.61.\nI made the upgrade due to meamory leak with websocket.\nI submitted a bug since the exception i raised internally in tomcat.\n\nI use NIO connector.\nOn the client side Tyrus 1.10 is used.\n\nBR,\nHugo\n\nFeb 21, 2016 1:05:57 PM org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer doClose\nINFO: Failed to close the ServletOutputStream connection cleanly\njava.io.IOException: Broken pipe\n        at sun.nio.ch.FileDispatcherImpl.write0(Native Method)\n        at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)\n        at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)\n        at sun.nio.ch.IOUtil.write(IOUtil.java:51)\n        at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:492)\n        at org.apache.tomcat.util.net.SecureNioChannel.flush(SecureNioChannel.java:141)\n        at org.apache.tomcat.util.net.SecureNioChannel.close(SecureNioChannel.java:385)\n        at org.apache.tomcat.util.net.SecureNioChannel.close(SecureNioChannel.java:413)\n        at org.apache.coyote.http11.upgrade.NioServletOutputStream.doClose(NioServletOutputStream.java:138)\n        at org.apache.coyote.http11.upgrade.AbstractServletOutputStream.close(AbstractServletOutputStream.java:129)\n        at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doClose(WsRemoteEndpointImplServer.java:138)\n        at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.close(WsRemoteEndpointImplBase.java:692)\n        at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.onWritePossible(WsRemoteEndpointImplServer.java:113)\n        at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:81)\n        at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:455)\n        at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.startMessage(WsRemoteEndpointImplBase.java:343)\n        at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.startMessageBlock(WsRemoteEndpointImplBase.java:275)\n        at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:559)\n        at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:465)\n        at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.onError(WsHttpUpgradeHandler.java:162)\n        at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.access$300(WsHttpUpgradeHandler.java:48)\n        at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler$WsReadListener.onError(WsHttpUpgradeHandler.java:230)\n        at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler$WsReadListener.onDataAvailable(WsHttpUpgradeHandler.java:213)\n        at org.apache.coyote.http11.upgrade.AbstractServletInputStream.onDataAvailable(AbstractServletInputStream.java:203)\n        at org.apache.coyote.http11.upgrade.AbstractProcessor.upgradeDispatch(AbstractProcessor.java:93)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:623)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1757)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1716)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\n        at java.lang.Thread.run(Thread.java:745)", "id": 188760, "time": "2016-02-24T11:47:09Z", "creator": "hugo.larson@yahoo.com", "creation_time": "2016-02-24T11:47:09Z", "is_private": false}, {"count": 1, "tags": [], "creator": "markt@apache.org", "attachment_id": null, "id": 188989, "time": "2016-03-01T10:35:06Z", "bug_id": 59062, "creation_time": "2016-03-01T10:35:06Z", "is_private": false, "text": "That is an INFO level message so it is providing you with information on what is going on. In this case it is that the client has dropped the connection. Some users find these useful when trying to debug networking issues but if you don't want to see them you can configure the logger for WsRemoteEndpointImplServer appropriately e.g. for WARN or above."}, {"count": 2, "tags": [], "bug_id": 59062, "attachment_id": null, "id": 189045, "time": "2016-03-03T09:34:52Z", "creator": "hugo.larson@yahoo.com", "creation_time": "2016-03-03T09:34:52Z", "is_private": false, "text": "Hello,\n\nThanks for the info.\n\nDo you think that calling ClientManager.shutdown() in the client is a good idea to avoid the exception?\n\nBR,"}]