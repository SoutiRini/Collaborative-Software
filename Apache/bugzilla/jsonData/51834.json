[{"count": 0, "tags": [], "bug_id": 51834, "attachment_id": 27508, "id": 149313, "creation_time": "2011-09-16T11:47:25Z", "time": "2011-09-16T11:47:25Z", "creator": "roger.varley@googlemail.com", "text": "Created attachment 27508\nOpening and re-writing this file corrupts the output\n\nThis code run against the attached document results in a corrupt word document that crashes MSWord 2003 and 2007 refuses to open.\n\n\tprivate void start() throws FileNotFoundException, IOException {\n\n        POIFSFileSystem fsfilesystem = null;\n        HWPFDocument hwpfdoc = null;\n        \n        InputStream resourceAsStream =  getClass().getResourceAsStream(\"/com/blackbox/admin/templates/rma.doc\");       \n        try {\n\t\t\tfsfilesystem = new POIFSFileSystem(resourceAsStream );\n\t\t\thwpfdoc = new HWPFDocument(fsfilesystem);\n\t\t\t\n\t\t\tFileOutputStream fos = new FileOutputStream(new File(\"C:\\\\temp\\\\newTemplate.doc\"));\n\t\t\thwpfdoc.write(fos);\n\t\t\tfos.flush();\n\t\t\tfos.close();\n\t\t\t\n\t\t} catch (FileNotFoundException e) {\n\t\t\te.printStackTrace();\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t}\n        \n\t\tSystem.out.println(\"Opened\");\n\n}", "is_private": false}, {"count": 1, "tags": [], "bug_id": 51834, "text": "Please, check latest code from trunk and attachment with saved document. It is passed Microsoft BFFValidator.\n\nSeveral bugs were fixed:\n - summary properties handling\n - extended FIB handling\n - lists handling", "id": 150039, "time": "2011-10-02T01:08:32Z", "creator": "vlsergey@gmail.com", "creation_time": "2011-10-02T01:08:32Z", "is_private": false, "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 51834, "attachment_id": 27667, "text": "Created attachment 27667\nResult doc (correct one)", "id": 150040, "time": "2011-10-02T01:09:18Z", "creator": "vlsergey@gmail.com", "creation_time": "2011-10-02T01:09:18Z", "is_private": false}, {"count": 3, "tags": [], "creator": "vlsergey@gmail.com", "text": "Created attachment 27668\nValidation result", "id": 150041, "time": "2011-10-02T01:09:48Z", "bug_id": 51834, "creation_time": "2011-10-02T01:09:48Z", "is_private": false, "attachment_id": 27668}, {"count": 4, "tags": [], "bug_id": 51834, "attachment_id": 28099, "is_private": false, "id": 152408, "time": "2011-12-26T16:23:03Z", "creator": "poi.dev.art@gmail.com", "creation_time": "2011-12-26T16:23:03Z", "text": "Created attachment 28099\nOpening and re-writing this file corrupts the output\n\nTable cells seems to be problematic.\n\nTested : \nMerging any cells (using WORD 2007) from the input document before re-writing it makes the output clean.\nRemoving the table produces a clean output too"}, {"attachment_id": null, "tags": [], "bug_id": 51834, "is_private": false, "count": 5, "id": 152409, "time": "2011-12-26T16:25:06Z", "creator": "poi.dev.art@gmail.com", "creation_time": "2011-12-26T16:25:06Z", "text": "Reopening for 3.8-beta5 : See previous comment"}, {"count": 6, "tags": [], "creator": "melanie.reiter@ars.de", "text": "This bug still exists in Version 3.10 final.\n\nThe following Situation occured:\n\nMy Word Document contains a table and I want to replace some text in a cell.\nThis works fine and I can open the file with Word 2010, but not with Word 2003 (It is a doc file).\n\nThere are three cases after replacing the text:\n\n1. same length of the text: no problem, it is possible to open the file in Word 2003\n\n2. old one is longer than replacement: open and repair is possible with Word 2003\n\n3. old one is shorter than replacement: Word 2003 crashes\n\nIt is possible to open all documents with Word 2010.\n\nAnother test was to replace a text that is contained in an enumeration, but not in a table and it has got the same behavior.", "id": 173746, "time": "2014-03-11T11:54:10Z", "bug_id": 51834, "creation_time": "2014-03-11T11:54:10Z", "is_private": false, "attachment_id": null}]