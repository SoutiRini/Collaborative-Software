[{"count": 0, "attachment_id": null, "bug_id": 18721, "text": "apxs writes wrong LoadModule into httpd.conf, if module name is something\ndifferent from mod_WORD-WITHOUT-UNDERLINES.\nHow to reproduce: take mod_auth.c alone from source tree (note: internal module\nname is auth_module) and run:\n# apxs -c mod_auth.c\n# apxs -e -a -n auth mod_auth.so\nYou will get in httpd.conf:\nLoadModule auth_module modules/mod_auth.so\nAddModule mod_auth.c\nEverything is fine.\n\nNow take mod_log_agent.c (note: internal module name is agent_log_module):\n# apxs -c mod_log_agent.c\n# apxs -e -a -n log_agent mod_log_agent.so\nYou will get:\nLoadModule log_agent_module modules/mod_log_agent.so\nAddModule mod_log_agent.c\n\nBut module name is agent_log_module !\nIf you try\n# apxs -e -a -n agent_log mod_log_agent.so\n, you will get correct LoadModule:\nLoadModule agent_log_module modules/mod_log_agent.so\n, but incorrect AddModule:\nAddModule mod_agent_log.c\nmod_agent_log.c doesn't exist\n, and apxs will try to handle mod_agent_log.conf instead of mod_log_agent.conf\nin case of add-on modules configuration files.\n\nThis happens because internal module name is usually constructed of file name,\nbut the words (if there are more than 1 word after mod_ and before _module) go\nin reverse order. apxs does not handle this.\n\nThis bug is not seen when building standard apache modules, because apxs -e -a\nis not run for them, but shipped httpd.conf is used, which contains right\nLoad/AddModule lines. The bug arises when trying to build RPM for 3rd party\nmodules, which are called something like mod_log_sql, mod_auth_mysql and so on.\n\nThe bug makes impossible to automate (de)activation of modules in RPM scripts,\nalthough it works fine for mod_throttle and other one-word named modules.\n\nI suggest fixing the bug via using join(\"_\", reverse (split (\"_\", $something))\nwhen building LoadModule line. I don't use/know perl, so can't fix the code myself.", "id": 34553, "time": "2003-04-04T19:37:02Z", "creator": "pilot@nv.com.ua", "creation_time": "2003-04-04T19:37:02Z", "tags": [], "is_private": false}]