[{"count": 0, "tags": [], "bug_id": 43693, "is_private": false, "text": "If you create a workbook from an existing xls file, the setLandscape method has\nno effect.\n\nIf you create a new sheet instead of using the loaded one, the landscape option\nworks fine. (Commented line)\n\nWhat i did exactly:\n\n    public static void main(String[] args)\n    {        \n        try{\n            // Read in a template xls document\n            InputStream stream = new FileInputStream(\"c:/temp/template.xls\");\n           \n            HSSFWorkbook wb = new HSSFWorkbook(stream);\n            HSSFSheet sheet = wb.getSheetAt(0);\n            // HSSFSheet sheet = wb.createSheet(\"New Sheet\");\n            \n            HSSFPrintSetup setup = sheet.getPrintSetup();\n            setup.setLandscape(true);\n            \n            // Create a row and put some cells in it. Rows are 0 based.\n            HSSFRow row = sheet.createRow((short) 1);\n            HSSFCell cell = row.createCell((short) 2);\n            cell.setCellValue(\"XXXX\");\n    \n            // Write the output to a file\n            FileOutputStream fileOut = new FileOutputStream(\"c:/temp/workbook.xls\");\n            wb.write(fileOut);\n            fileOut.close();\n        }catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n\nThe template.xls is simple a new created and saved xls document. (I would have\nattached it, but did not know how.)\n\nUsed versions:\n\nPOI: poi-3.0.1-FINAL-20070705.jar\nJava: jdk150_04", "id": 109706, "time": "2007-10-24T09:25:14Z", "creator": "andreas.kramer@post.ch", "creation_time": "2007-10-24T09:25:14Z", "attachment_id": null}, {"count": 1, "attachment_id": 21037, "creator": "andreas.kramer@post.ch", "text": "Created attachment 21037\nthe template file", "id": 109707, "time": "2007-10-24T09:26:57Z", "bug_id": 43693, "creation_time": "2007-10-24T09:26:57Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 43693, "is_private": false, "text": "Created attachment 21038\nThe workbook i created with the given reproduce code", "id": 109708, "time": "2007-10-24T09:28:05Z", "creator": "andreas.kramer@post.ch", "creation_time": "2007-10-24T09:28:05Z", "attachment_id": 21038}, {"count": 3, "attachment_id": null, "creator": "apache@gagravarr.org", "text": "I've added two new tests to\nsrc/testcases/org/apache/poi/hssf/usermodel/TestHSSFSheet.java\n\nOne of these does setLandscape on an existing sheet, the other on a newly\ncreated sheet. (Methods are testPrintSetupLandscapeNew() and\ntestPrintSetupLandscapeExisting())\n\nAfter doing a save and a re-open, getLandscape is correctly working for both of\nthem.\n\nCould you please create a failing testcase for your problem, and attach that to\nthe bug? As it is, I'm unable to replicate your problem.", "id": 112627, "time": "2008-01-08T05:30:45Z", "bug_id": 43693, "creation_time": "2008-01-08T05:30:45Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "text": "I am able to reproduce this behaviour. The methods work fine in xlsx file while they dont work in xls file. The client in MS Excel 2007. \n\n            PrintSetup setup = s.getPrintSetup();\n            setup.setPaperSize(PrintSetup.LEGAL_PAPERSIZE);\n            setup.setLandscape(true);\n\nPrint properties for an xlsx file show the paper size as LEGAL and it is also set to landscape mode, whereas in xls file the paper size is A4 (default) and its set to portrait.\n\nNote: The get methods show the correct values", "is_private": false, "bug_id": 43693, "id": 132533, "time": "2009-11-30T23:59:03Z", "creator": "vinu.kumar@gmail.com", "creation_time": "2009-11-30T23:59:03Z", "attachment_id": null}, {"count": 5, "attachment_id": null, "creator": "vinu.kumar@gmail.com", "is_private": false, "id": 132534, "time": "2009-12-01T00:00:38Z", "bug_id": 43693, "creation_time": "2009-12-01T00:00:38Z", "tags": [], "text": "I am using POI 3.5 final"}, {"count": 6, "attachment_id": null, "creator": "walter.higgins@gmail.com", "is_private": false, "id": 133059, "time": "2009-12-22T07:08:58Z", "bug_id": 43693, "creation_time": "2009-12-22T07:08:58Z", "tags": [], "text": "The following code can be used to reproduce this problem.\nCreate a standard blank workbook and save it as test.xls.\nCompile and run the following TestPOI.java source.\nOpen the out.xls file in excel and choose 'File' -> 'Page Setup' from the application menu. The page orientation has not changed to Landscape.\n\nimport java.io.*;\n\nimport org.apache.poi.hssf.usermodel.*;\nimport java.util.*;\n\npublic class TestPOI {\n\n    public static void main(String[] args) throws Exception{\n\n        HSSFWorkbook workbook = new HSSFWorkbook(new FileInputStream(\"test.xls\"));\n        int sheetCount = workbook.getNumberOfSheets();\n\n        for (int i = 0; i < sheetCount; i++){\n            System.out.println(i);\n            HSSFSheet sheet = workbook.getSheetAt(i);\n            HSSFPrintSetup print = sheet.getPrintSetup();\n            print.setLandscape(true);\n        }\n\n        workbook.write(new FileOutputStream(\"out.xls\"));\n    }\n}"}, {"attachment_id": null, "tags": [], "creator": "walter.higgins@gmail.com", "text": "(In reply to comment #6)\n\nThis problem still occurs in poi-3.6-20091214", "count": 7, "id": 133061, "time": "2009-12-22T07:20:09Z", "bug_id": 43693, "creation_time": "2009-12-22T07:20:09Z", "is_private": false}, {"count": 8, "tags": [], "text": "It seems Excel has some strange checking on the values set in the PrintSetup, so if you do not set all of them to useful values, Excel may ignore the settings and use defaults, e.g. what did work for me was the following:\n\n        setup.setLandscape(true);\n        setup.setPaperSize(PrintSetup.A4_PAPERSIZE);\n        setup.setScale((short)100);\n        setup.setValidSettings(false);\n\nAlso the setValidSettings() could be interferring here. Generally it should be \"false\" to not make Excel use default values!\n\nHowever I don't think we can re-implement the checking that Excel does internally as it is not part of the Spec and thus a complete mystery to us, so I think this is WONTFIX for us unless someone comes up with a better way to handle the print settings.", "is_private": false, "bug_id": 43693, "id": 182790, "time": "2015-05-01T19:55:10Z", "creator": "dominik.stadler@gmx.at", "creation_time": "2015-05-01T19:55:10Z", "attachment_id": null}]