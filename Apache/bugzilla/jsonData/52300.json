[{"count": 0, "tags": [], "bug_id": 52300, "attachment_id": 28048, "id": 152053, "time": "2011-12-07T12:33:54Z", "creator": "stefan.helfert@googlemail.com", "creation_time": "2011-12-07T12:33:54Z", "is_private": false, "text": "Created attachment 28048\nTemplate File\n\nHi, \n\nIam using templateFiles (*.xlt) and want to copy some sheets to reuse them.\nThe template files contains a image.\n\nBut during the copy progress I got the following error:\nWARNING: 8 bytes remaining but no space left\n\nWhen I want to open the new file afterwards I got a Errormessage and Excel repairs it.\n\nAfter that the file is open and still looks good (Image is on both sheets).\n\nI attached the template file and a litte Testprogram.\n\npublic class POITemplateCopyTest {\n\n\t/**\n\t * @param args\n\t * @throws IOException \n\t */\n\tpublic static void main(String[] args) throws IOException {\n\tInputStream is = new FileInputStream(new File(\"D:\\\\BugReport\\\\SourceTemplate.xlt\"));\n\tPOIFSFileSystem poifs = new POIFSFileSystem(is);\n\tHSSFWorkbook wb = new HSSFWorkbook(poifs);\n\tis.close();\n\t\n\twb.cloneSheet(1);\n\t\n\twb.write(new FileOutputStream(new File(\"D:\\\\BugReport\\\\TemplateTestCopy.xls\")));\n\tSystem.out.println(\"Done\");\n\t\n\t}\n\n}"}, {"attachment_id": 28049, "tags": [], "bug_id": 52300, "is_private": false, "count": 1, "id": 152054, "time": "2011-12-07T12:34:16Z", "creator": "stefan.helfert@googlemail.com", "creation_time": "2011-12-07T12:34:16Z", "text": "Created attachment 28049\nCreated corrupted File"}, {"count": 2, "tags": [], "creator": "stefan.helfert@googlemail.com", "is_private": false, "text": "Created attachment 28050\nTestprogram", "id": 152055, "time": "2011-12-07T12:34:30Z", "bug_id": 52300, "creation_time": "2011-12-07T12:34:30Z", "attachment_id": 28050}, {"count": 3, "tags": [], "text": "*** Bug 52312 has been marked as a duplicate of this bug. ***", "is_private": false, "id": 152127, "creator": "anton_bastynets@epam.com", "time": "2011-12-12T12:51:09Z", "bug_id": 52300, "creation_time": "2011-12-12T12:51:09Z", "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 52300, "attachment_id": null, "id": 152128, "time": "2011-12-12T13:12:49Z", "creator": "anton_bastynets@epam.com", "creation_time": "2011-12-12T13:12:49Z", "is_private": false, "text": "Hi. I had even bug. More often it becomes apparent for cloning sheets with shapes. \nAnd when I clone sheet with 20 images and 3 shapes, I have exception:\nWARNING: 32 bytes remaining but no space left\nWARNING: 136 bytes remaining but no space left\nWARNING: 32 bytes remaining but no space left\nWARNING: 136 bytes remaining but no space left\nWARNING: 32 bytes remaining but no space left\nWARNING: 136 bytes remaining but no space left\nWARNING: 32 bytes remaining but no space left\nWARNING: 136 bytes remaining but no space left\nException in thread \"main\" org.apache.poi.hssf.record.RecordFormatException: 9192 bytes written but getRecordSize() reports 9296\n\tat org.apache.poi.hssf.record.EscherAggregate.serialize(EscherAggregate.java:488)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook$SheetRecordCollector.serialize(HSSFWorkbook.java:1263)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.getBytes(HSSFWorkbook.java:1309)\n\tat org.apache.poi.hssf.usermodel.HSSFWorkbook.write(HSSFWorkbook.java:1209)\n\tat TestWorkbookCreating.main(TestWorkbookCreating.java:44)\n\nI added this file to attachments."}, {"count": 5, "tags": [], "text": "Created attachment 28067\nXls-file with 20 images and 3 shapes\n\nDuring cloning the shape with name \"cb_en\" of this file occurs an exception.", "is_private": false, "id": 152129, "creator": "anton_bastynets@epam.com", "time": "2011-12-12T13:25:16Z", "bug_id": 52300, "creation_time": "2011-12-12T13:25:16Z", "attachment_id": 28067}, {"count": 6, "tags": [], "creator": "superrubiroyd@gmail.com", "is_private": false, "text": "This problem should be fixed in trunk.\n\nPlease try with a nightly build - see download links on http://poi.apache.org/\nor build yourself from SVN trunk, see http://poi.apache.org/subversion.html", "id": 161294, "time": "2012-08-12T11:41:19Z", "bug_id": 52300, "creation_time": "2012-08-12T11:41:19Z", "attachment_id": null}]