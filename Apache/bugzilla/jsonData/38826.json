[{"count": 0, "tags": [], "bug_id": 38826, "attachment_id": null, "id": 86361, "time": "2006-03-02T02:41:15Z", "creator": "dnavitaniuk@fastmail.fm", "creation_time": "2006-03-02T02:41:15Z", "is_private": false, "text": "Hi all!\n\nIn Servlet spec, Filters section (SRV.6) I didnt found any\nmentions that error-handling process should bypass filters.\n\nMy problem is:\nI have lot of heavy-working jsps in my app (yes I know bad design etc but at the\nmoment there is no way to rewrite it). Sometimes, when one of jsps generated\n200K of output the app-level error is encountered and is thrown to web\ncontainer. It should return the error-page + status-code of 500 but such a big\noutput in front of it leaded to \"early\" flush (status code 200 + part of html\nresponse was already sent to client).\n\nSuch big amount of output data should be buffered to prevent \"early\" commit. I\ncreated a bufferer-filter for this purposes. \nBut when I finally got an exception and execution is passed to error page I see\nthat error-page don't use HttpServletResponseWrapper I defined in my filter.\nInstead of it error-page works with unwrapped object\n\"org.apache.catalina.connector.ResponseFacade\" and obviously bypass my filtering\nlogic."}, {"count": 1, "tags": [], "text": "<spec-quote version=\"2.4\" section=\"9.9.1\">\nThe original unwrapped request and response objects created by the container\nare passed to the servlet or JSP page.\n</spec-quote>", "is_private": false, "id": 86364, "creator": "william.barker@wilshire.com", "time": "2006-03-02T02:51:24Z", "bug_id": 38826, "creation_time": "2006-03-02T02:51:24Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 38826, "attachment_id": null, "id": 86395, "time": "2006-03-02T13:41:01Z", "creator": "dnavitaniuk@fastmail.fm", "creation_time": "2006-03-02T13:41:01Z", "is_private": false, "text": "(In reply to comment #1)\n> <spec-quote version=\"2.4\" section=\"9.9.1\">\n> The original unwrapped request and response objects created by the container\n> are passed to the servlet or JSP page.\n> </spec-quote>\n\nI think I found another issue...\nif the \"exception-thrower\" jsp contains <%@ page ...errorPage=\"error.jsp\"%>\nand it generates lots of output, I receive the \nSEVERE: Exception Processing ErrorPage[exceptionType=java.lang.Throwable,\nlocation=/error.jsp]\njava.lang.IllegalStateException\n        at org.apache.coyote.Response.reset(Response.java:296)\n        at org.apache.catalina.connector.Response.reset(Response.java:642)\n        at org.apache.catalina.connector.Response.reset(Response.java:908)\nit isnt quite good for me but at least it is understandable\n\nwhat I think isnt is the following:\nif there was a small output prior to exception occurence with conditions above\nthen error.jsp is working with wrapped request/response...\n\nif I remove a explicit error.jsp form \"page\" attributes in jsp then error.jsp is\nworking with unwrapped request/response..."}, {"count": 3, "tags": [], "bug_id": 38826, "attachment_id": null, "id": 86396, "time": "2006-03-02T13:48:55Z", "creator": "funkman@joedog.org", "creation_time": "2006-03-02T13:48:55Z", "is_private": false, "text": "Bugzilla is not a support forum. \n\nPlease do not reopen bugs for new issues. This bug will be re-marked as invalid\nwith respect to the original bug report. \n\nFeel free to open a new bug with the new issue.\n\nBut at this point - this seems to be a debugging exercise in user code. Please\nuse the tomcat-user list for help. "}]