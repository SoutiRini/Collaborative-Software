[{"count": 0, "tags": [], "bug_id": 44861, "attachment_id": null, "is_private": false, "id": 115806, "time": "2008-04-23T09:11:12Z", "creator": "e.fougeras@gmail.com", "creation_time": "2008-04-23T09:11:12Z", "text": "Tested with poi-3.0.2-FINAL\n\njava.lang.ClassCastException: org.apache.poi.hssf.record.aggregates.FormulaRecordAggregate cannot be cast to org.apache.poi.hssf.record.LabelSSTRecord\n        at org.apache.poi.hssf.usermodel.HSSFCell.setCellValue(HSSFCell.java:625)\n        at org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluateFormulaCell(HSSFFormulaEvaluator.java:253)\n\n\nMy code :\n\nprivate final void updateAllFormulas(final HSSFWorkbook parWorkbook) {\n    final int locNumberOfSheets = parWorkbook.getNumberOfSheets();\n    for (int locSheetNum = 0; locSheetNum < locNumberOfSheets; locSheetNum++) {\n      final HSSFSheet locSheet = parWorkbook.getSheetAt(locSheetNum);\n      final HSSFFormulaEvaluator locEvaluator = new HSSFFormulaEvaluator(locSheet, parWorkbook);\n\n      for (final Iterator locSheetIter = locSheet.rowIterator(); locSheetIter.hasNext();) {\n        final HSSFRow locRow = (HSSFRow) locSheetIter.next();\n        locEvaluator.setCurrentRow(locRow);\n\n        for (final Iterator locCellIter = locRow.cellIterator(); locCellIter.hasNext();) {\n          final HSSFCell locCell = (HSSFCell) locCellIter.next();\n          if (locCell.getCellType() == HSSFCell.CELL_TYPE_FORMULA) {\n            locEvaluator.evaluateFormulaCell(locCell);            \n          }\n        }\n      }\n    }\n  }"}, {"count": 1, "tags": [], "text": "Please upload the problem excel file, so we can take a look and see what POI is doing wrong (the stacktrace shows something happening that ought not to)", "is_private": false, "id": 115924, "creator": "apache@gagravarr.org", "time": "2008-04-27T11:00:29Z", "bug_id": 44861, "creation_time": "2008-04-27T11:00:29Z", "attachment_id": null}, {"count": 2, "tags": [], "bug_id": 44861, "attachment_id": 21870, "text": "Created attachment 21870\nTestcase", "id": 115971, "time": "2008-04-28T10:43:02Z", "creator": "e.fougeras@gmail.com", "creation_time": "2008-04-28T10:43:02Z", "is_private": false}, {"count": 3, "tags": [], "bug_id": 44861, "attachment_id": null, "id": 115972, "time": "2008-04-28T10:44:43Z", "creator": "e.fougeras@gmail.com", "creation_time": "2008-04-28T10:44:43Z", "is_private": false, "text": "The problem excel file is in attachments."}, {"count": 4, "tags": [], "bug_id": 44861, "text": "Just tried on svn trunk, and works just fine, no exception. Test added to svn verifies this\n\nPlease retry with 3.1 beta 1 (should be on mirrors shortly) or a svn nightly build. ", "id": 115973, "time": "2008-04-28T10:53:16Z", "creator": "apache@gagravarr.org", "creation_time": "2008-04-28T10:53:16Z", "is_private": false, "attachment_id": null}, {"count": 5, "tags": [], "creator": "josh@apache.org", "is_private": false, "text": "The stack trace seems to be the same as that from bug 44606\n\n*** This bug has been marked as a duplicate of bug 44606 ***", "id": 115984, "time": "2008-04-28T12:00:17Z", "bug_id": 44861, "creation_time": "2008-04-28T12:00:17Z", "attachment_id": null}]