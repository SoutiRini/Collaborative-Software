[{"count": 0, "tags": [], "bug_id": 47168, "is_private": false, "id": 126873, "attachment_id": null, "creator": "martineigenbrodt@googlemail.com", "creation_time": "2009-05-08T02:30:24Z", "time": "2009-05-08T02:30:24Z", "text": "The doc says the includeEmptyDirs value defaults to true.\nI've tried unzipping a zip containing empty dirs using copy and the zipfileset and needed to explicitly set includeEmptyDirs to true.\nSo either the implementation or the doc is wrong."}, {"count": 1, "tags": [], "creator": "bodewig@apache.org", "attachment_id": null, "id": 126939, "time": "2009-05-11T07:05:36Z", "bug_id": 47168, "creation_time": "2009-05-11T07:05:36Z", "is_private": false, "text": "what you see is not related to the includeemptydirs attribute at all, which does default to true.\n\nThis test here \n\n  <target name=\"testIncludeEmptyDirsDefaultsToTrue\"\n          description=\"https://issues.apache.org/bugzilla/show_bug.cgi?id=47168\">\n    <mkdir dir=\"${input}/foo\"/>\n    <mkdir dir=\"${output}\"/>\n    <copy todir=\"${output}\">\n      <fileset dir=\"${input}\"/>\n    </copy>\n    <au:assertFileExists file=\"${output}/foo\"/>\n  </target>\n\npasses.\n\nIf you change the target to use a zipfileset (this is what I understand from your description)\n\n  <target name=\"XtestIncludeEmptyDirsAndZipfileset\"\n          description=\"https://issues.apache.org/bugzilla/show_bug.cgi?id=47168\">\n    <mkdir dir=\"${input}/foo\"/>\n    <mkdir dir=\"${output}/final\"/>\n    <zip destfile=\"${output}/zipfile.zip\">\n      <fileset dir=\"${input}\"/>\n    </zip>\n    <copy todir=\"${output}/final\">\n      <zipfileset src=\"${output}/zipfile.zip\"/>\n    </copy>\n    <au:assertFileExists file=\"${output}/final/foo\"/>\n  </target>\n\nit fails.\n\nThe reason that it fails lies in zipfileset, though.  Or more exactly in AbstractFileSet's implementation of the iterator() method which only returns non-directory resources at all."}, {"count": 2, "tags": [], "creator": "martineigenbrodt@googlemail.com", "attachment_id": null, "id": 126955, "time": "2009-05-12T04:46:28Z", "bug_id": 47168, "creation_time": "2009-05-12T04:46:28Z", "is_private": false, "text": "Your right. Thanks for pointing the right direction. I've changed the summary."}, {"count": 3, "tags": [], "creator": "adam.apache@bryzak.net", "text": "(In reply to comment #1)\n> The reason that it fails lies in zipfileset, though.  Or more exactly in\n> AbstractFileSet's implementation of the iterator() method which only returns\n> non-directory resources at all.\n\nUnfortunately it's also not quite as simple as that either. Updating ArchiveFileSet to return both file and directory entries doesn't quite work. The copy task will still ignore the directories as they get filtered out of the resources to copy by the SourceFileScanner in the buildMap method.", "id": 128503, "time": "2009-07-05T02:47:09Z", "bug_id": 47168, "creation_time": "2009-07-05T02:47:09Z", "is_private": false, "attachment_id": null}]