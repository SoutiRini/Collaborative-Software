[{"count": 0, "tags": [], "creator": "Greg.Robinson@dsto.defence.gov.au", "attachment_id": null, "text": "I usually compile programs as myself, and then install as root.\nThe make install script re-directs output to temporary files in the\napache src directory, but this fails as root cannont write to that\ndisk (it is NFS sharred without root permission).\n\neg:\n\n...\n\nmkdir /opt/local/apache/proxy\n./src/helpers/PrintPath: pp.t.15350: cannot create\n./src/helpers/PrintPath: pp.t.15357: cannot create\nchown nobody /opt/local/apache/proxy\nchgrp nobody /opt/local/apache/proxy\n<=== [mktree]\n===> [programs: Installing Apache httpd program and shared objects]\n./src/helpers/install.sh -c -m 755 ./src/httpd /opt/local/apache/bin/httpd\n./src/helpers/install.sh -c -m 644 ./src/support/httpd.8\n/opt/local/apache/man/man8/httpd.8\ntouch: cannot change times on src/.apaci.install.conf\n*** Error code 1 (ignored)\n<=== [programs]\n===> [support: Installing Apache support programs and scripts]\n./src/helpers/install.sh -c -m 755 -s ./src/support/ab /opt/local/apache/bin/ab\n\n...\n\n\nI have made 2 context diff's and they have worked for me.\nNote, there is at least 1 more redirection in Makefile.tmpl which I\ndid not correct, as there was no error for it.  You'll get the\ngeneral idea from my patch.\n\n*** PrintPath   Tue May  7 11:53:35 2002\n--- PrintPath.apache    Thu Apr 22 00:00:26 1999\n***************\n*** 70,76 ****\n          s/:$/:./\n          s/:/ /g' `\n      # Here is how we test to see if test/[] can handle -x\n!     testfile=\"/tmp/pp.t.$$\"\n  \n      cat > $testfile <<ENDTEST\n  #!/bin/sh\n--- 70,76 ----\n          s/:$/:./\n          s/:/ /g' `\n      # Here is how we test to see if test/[] can handle -x\n!     testfile=\"pp.t.$$\"\n  \n      cat > $testfile <<ENDTEST\n  #!/bin/sh\n\n\n\n\n\n2nd patch:\n\n*** Makefile.tmpl.apache        Thu Mar 14 07:35:27 2002\n--- Makefile.tmpl       Tue May  7 12:26:37 2002\n***************\n*** 85,90 ****\n--- 85,91 ----\n  CP              = cp\n  LN              = ln\n  RM              = rm -f\n+ TMP           = /tmp\n  MKDIR           = $(TOP)/$(AUX)/mkdir.sh\n  INSTALL         = $(TOP)/$(AUX)/install.sh -c\n  IFLAGS_PROGRAM  = @IFLAGS_PROGRAM@\n***************\n*** 232,238 ****\n                install-mktree install-programs $(install-support) \\\n                install-include install-data install-config\n        -@$(RM) $(SRC)/.apaci.install.tmp\n!       -@$(RM) $(SRC)/.apaci.install.conf\n        -@if [ \".$(QUIET)\" != .1 ]; then \\\n                if [ \".$(TARGET)\" = .httpd ]; then \\\n                        apachectl='apachectl'; \\\n--- 233,239 ----\n                install-mktree install-programs $(install-support) \\\n                install-include install-data install-config\n        -@$(RM) $(SRC)/.apaci.install.tmp\n!       -@$(RM) $(TMP)/.apaci.install.conf\n        -@if [ \".$(QUIET)\" != .1 ]; then \\\n                if [ \".$(TARGET)\" = .httpd ]; then \\\n                        apachectl='apachectl'; \\\n***************\n*** 321,327 ****\n                fi; \\\n        fi\n        $(INSTALL_DATA) $(TOP)/$(SRC)/support/httpd.8\n$(root)$(mandir)/man8/$(TARGET).8\n!       -@$(RM) $(SRC)/.apaci.install.conf; touch $(SRC)/.apaci.install.conf\n        -@if [ \".`grep '^[      ]*SharedModule'\n$(TOP)/$(SRC)/Configuration.apaci`\" != . ]; then \\\n                for mod in `egrep '^[   ]*SharedModule'\n$(TOP)/$(SRC)/Configuration.apaci |\\\n                        sed -e 's/^[    ]*SharedModule[         ]*//'`; do \\\n--- 322,328 ----\n                fi; \\\n        fi\n        $(INSTALL_DATA) $(TOP)/$(SRC)/support/httpd.8\n$(root)$(mandir)/man8/$(TARGET).8\n!       -@$(RM) $(TMP)/.apaci.install.conf; touch $(TMP)/.apaci.install.conf\n        -@if [ \".`grep '^[      ]*SharedModule'\n$(TOP)/$(SRC)/Configuration.apaci`\" != . ]; then \\\n                for mod in `egrep '^[   ]*SharedModule'\n$(TOP)/$(SRC)/Configuration.apaci |\\\n                        sed -e 's/^[    ]*SharedModule[         ]*//'`; do \\\n***************\n*** 330,347 ****\n                        $(INSTALL_DSO) $(TOP)/$(SRC)/$${mod}\n$(root)$(libexecdir)/$${file}; \\\n                        name=`$(TOP)/$(AUX)/fmn.sh $(TOP)/$(SRC)/$${mod}`; \\\n                        echo dummy | awk '{ printf(\"LoadModule %-18s %s\\n\",\nmodname, modpath); }' \\\n!                       modname=\"$${name}\"\nmodpath=\"$(libexecdir_relative)$${file}\" >>$(SRC)/.apaci.install.conf; \\\n                done; \\\n!               echo \"\" >>$(SRC)/.apaci.install.conf; \\\n!               echo \"#  Reconstruction of the complete module list from all\navailable modules\" >>$(SRC)/.apaci.install.conf; \\\n!               echo \"#  (static and shared ones) to achieve correct module\nexecution order.\" >>$(SRC)/.apaci.install.conf; \\\n!               echo \"#  [WHENEVER YOU CHANGE THE LOADMODULE SECTION ABOVE\nUPDATE THIS, TOO]\" >>$(SRC)/.apaci.install.conf; \\\n!               echo \"ClearModuleList\" >>$(SRC)/.apaci.install.conf; \\\n                egrep \"^[       ]*(Add|Shared)Module\" $(SRC)/Configuration.apaci\n|\\\n                sed     -e 's:SharedModule:AddModule:' \\\n                        -e 's:modules/[^/]*/::' \\\n                        -e 's:[     ]lib: mod_:' \\\n!                       -e 's:\\.[soam].*$$:.c:' >>$(SRC)/.apaci.install.conf; \\\n        fi\n        @echo \"<=== [programs]\"\n  \n--- 331,348 ----\n                        $(INSTALL_DSO) $(TOP)/$(SRC)/$${mod}\n$(root)$(libexecdir)/$${file}; \\\n                        name=`$(TOP)/$(AUX)/fmn.sh $(TOP)/$(SRC)/$${mod}`; \\\n                        echo dummy | awk '{ printf(\"LoadModule %-18s %s\\n\",\nmodname, modpath); }' \\\n!                       modname=\"$${name}\"\nmodpath=\"$(libexecdir_relative)$${file}\" >>$(TMP)/.apaci.install.conf; \\\n                done; \\\n!               echo \"\" >>$(TMP)/.apaci.install.conf; \\\n!               echo \"#  Reconstruction of the complete module list from all\navailable modules\" >>$(TMP)/.apaci.install.conf; \\\n!               echo \"#  (static and shared ones) to achieve correct module\nexecution order.\" >>$(TMP)/.apaci.install.conf; \\\n!               echo \"#  [WHENEVER YOU CHANGE THE LOADMODULE SECTION ABOVE\nUPDATE THIS, TOO]\" >>$(TMP)/.apaci.install.conf; \\\n!               echo \"ClearModuleList\" >>$(TMP)/.apaci.install.conf; \\\n                egrep \"^[       ]*(Add|Shared)Module\" $(SRC)/Configuration.apaci\n|\\\n                sed     -e 's:SharedModule:AddModule:' \\\n                        -e 's:modules/[^/]*/::' \\\n                        -e 's:[     ]lib: mod_:' \\\n!                       -e 's:\\.[soam].*$$:.c:' >>$(TMP)/.apaci.install.conf; \\\n        fi\n        @echo \"<=== [programs]\"\n  \n\nBasically, replace the locations of > .apaci.install.conf with\n> /tmp/.apaci.install.conf.\n\nThe workaround is, of course, to move the apache source tree to a root\nwritable directory, like /var/tmp, and install from there.\n\ngcc: gcc version 2.95.2 19991024 (release)\nSolaris 2.8 2/02.  Latest recommended patches.\nconfigured with:\n./configure --prefix=/opt/local/apache --exec-prefix=/opt/local/apache\n--enable-module=so", "id": 15604, "time": "2002-05-07T03:03:33Z", "bug_id": 8849, "creation_time": "2002-05-07T03:03:33Z", "is_private": false}, {"count": 1, "tags": [], "creator": "Greg.Robinson@dsto.defence.gov.au", "attachment_id": null, "id": 15606, "time": "2002-05-07T03:52:33Z", "bug_id": 8849, "creation_time": "2002-05-07T03:52:33Z", "is_private": false, "text": "Sorry, version 1.3.24.\n"}, {"count": 2, "tags": [], "creator": "jerenkrantz@apache.org", "attachment_id": null, "id": 15988, "time": "2002-05-13T07:25:08Z", "bug_id": 8849, "creation_time": "2002-05-13T07:25:08Z", "is_private": false, "text": "Can you please resumbit as a unified diff (diff -u) and include this as an\nattachment (see \"Create a new attachment\" in Bugzilla)?\n\nThanks for using Apache!"}, {"attachment_id": 1850, "tags": [], "creator": "Greg.Robinson@dsto.defence.gov.au", "is_private": false, "count": 3, "id": 16039, "time": "2002-05-14T00:11:25Z", "bug_id": 8849, "creation_time": "2002-05-14T00:11:25Z", "text": "Created attachment 1850\ndiff -u patch for PrintPath relative to apache_1.3.24"}, {"count": 4, "tags": [], "creator": "Greg.Robinson@dsto.defence.gov.au", "attachment_id": 1851, "text": "Created attachment 1851\ndiff -u patch for Makefile.tmpl relative to apache_1.3.24", "id": 16040, "time": "2002-05-14T00:12:11Z", "bug_id": 8849, "creation_time": "2002-05-14T00:12:11Z", "is_private": false}, {"count": 5, "tags": [], "creator": "fielding@apache.org", "attachment_id": null, "id": 119236, "time": "2008-08-01T16:38:37Z", "bug_id": 8849, "creation_time": "2008-08-01T16:38:37Z", "is_private": false, "text": "This problem is specific to the APACI alternative build system in 1.3.x,\nwhich was replaced by autoconf in 2.x.  Although this problem still exists\nin the 1.3.x source, the only way to fix it correctly is to rewrite APACI\nso that it does all its work during \"make\" and not during \"make install\".\nIn other words, replace it with autoconf.\n\nLeaving this as wontfix, since the workaround of copying the tree\nto an editable filesystem is the common case.\n"}]