[{"count": 0, "tags": [], "bug_id": 53029, "attachment_id": null, "text": "I am trying to use mod_session_dbd to store our session information (from mod_auth_form) in our DB. We had previously been using mod_session_cookie which was working just fine. Once we switched to mod_session_dbd we started getting segfaults while running httpd (with no error message) whenever we rebooted our machines.\n\nAfter some trial and error it turns out that the segfault occurs because there is no cookie for the site using mod_session_dbd present in the browser. You can recreate the problem very easily by enabling mod_session_dbd and deleting any cookies for your site from your browser then trying to load a page. To \"fix\" the problem you can enable mod_session_cookie, go to the site (which generates a cookie), shutdown httpd, re-enable mod_session_dbd and go to the site. This time it will work and you can see the cookie be renamed and changed based on mod_session_dbd. But if you delete that cookie and restart httpd the segfaults will return.\n\nAnother weird item is the first time you load the page after enabling mod_session_dbd (with a cookie present from mod_session_cookie) the guid saves in the cookie and DB is all zeros. The next time you load the page it gets a random guid.\n\nmod_session_dbd config:\n\nDBDPrepareSQL \"DELETE FROM apache_session WHERE id = %s\" deletesession\nDBDPrepareSQL \"UPDATE apache_session SET value = %s, expiry = %lld WHERE id = %s\" updatesession\nDBDPrepareSQL \"INSERT INTO apache_session (value, expiry, id) VALUES (%s, %lld, %s)\" insertsession\nDBDPrepareSQL \"SELECT value FROM apache_session WHERE id = %s AND (expiry = 0 OR expiry > %lld)\" selectsession\nDBDPrepareSQL \"DELETE FROM apache_session WHERE expiry != 0 AND expiry < %lld\" cleansession\n\nLoadModule session_module modules/mod_session.so\nLoadModule session_dbd_module modules/mod_session_dbd.so\n#LoadModule session_cookie_module modules/mod_session_cookie.so\nLoadModule session_crypto_module modules/mod_session_crypto.so\n\nSession On\nSessionCryptoPassphrase secret\n#SessionCookieName session path=/\nSessionDBDCookieName session path=/", "id": 157107, "time": "2012-04-03T16:32:00Z", "creator": "chris@cxtsoftware.com", "creation_time": "2012-04-03T16:32:00Z", "is_private": false}, {"count": 1, "tags": [], "creator": "chris@cxtsoftware.com", "attachment_id": null, "id": 160913, "time": "2012-07-26T03:07:46Z", "bug_id": 53029, "creation_time": "2012-07-26T03:07:46Z", "is_private": false, "text": "53452 is more accurate of an assessment.\n\n*** This bug has been marked as a duplicate of bug 53452 ***"}]