[{"count": 0, "attachment_id": null, "creator": "andrewconrad@msn.com", "is_private": false, "id": 18979, "time": "2002-07-03T22:15:55Z", "bug_id": 10458, "creation_time": "2002-07-03T22:15:55Z", "tags": [], "text": "Editing a User causes a JavaScript error because the script is trying to focus \non a hidden object.\n\nline 20 of /webapp/admin/users/user.jsp\n---\n<html:form method=\"POST\" action=\"/users/saveUser\" focus=\"username\">\n---\n\nbut username is not guaranteed to be focusable because if your editing an \nexisting user, the field is hidden. (non focusable object IE5+)\n\n\nThis bug also occurs in role.jsp and group.jsp\n\ntwo fixes:\n1) remove focus attribute from  html:form element\n\n2) update to Struts nightly build 20020624 or greater, but this will require a \nfew updates to the admin package because the admin package uses a deprecated \nclass, org.apache.struts.util.PropertyUtils in the class \norg.apache.webapp.admin.AttributeTag.  I included the changes below, because \neventually these updates have to be made, even if they are not for this fix.\n\nI don't agree with the changes to the html:form element to check for object \nexistence in the browser.  It should check it on the server, and output the \ncorrect code accordingly, but thats their issue.\n\n\nThe changes to org/apache/webapp/adminAttributeTag.java should be\n---- starting line 73 --\n//import org.apache.struts.util.PropertyUtils; //Not avail. in Struts 1.1.b1+\nimport org.apache.commons.beanutils.PropertyUtils; // New Location\n---- end --\n\nthen the admin build.xml needs to be updated to get access to the commons-\nbeanutils.jar\n\n--- new build.xml  ---\n<project name=\"admin\" default=\"build-main\" basedir=\".\">\n\n\n  <!-- ===================== Initialize Property Values =================== -->\n\n  <!-- See \"build.properties.sample\" in the top level directory for all     -->\n  <!-- property values you must customize for successful building!!!        -->\n  <property file=\"build.properties\"/>\n  <property file=\"../build.properties\"/>\n  <property file=\"../../build.properties\"/>\n  <property file=\"${user.home}/build.properties\"/>\n\n  <!-- Build Defaults -->\n  <property name=\"build.compiler\"  value=\"classic\"/>\n  <property name=\"webapps.build\"   value=\"${basedir}/../build\"/>\n  <property name=\"webapps.dist\"    value=\"${basedir}/../dist\"/>\n  <property name=\"webapp.name\"     value=\"admin\"/>\n\n  <!-- Construct Admin classpath -->\n  <path id=\"admin.classpath\">\n    <pathelement location=\"${commons-modeler.jar}\"/>\n    <pathelement location=\"${jmx.jar}\"/>\n    <pathelement location=\"${servlet.jar}\"/>\n    <pathelement location=\"${struts.jar}\"/>\n    <pathelement location=\"${commons-beanutils.jar}\"/>\n  </path>\n\n\n  <!-- =================== BUILD: Set compile flags ======================= -->\n  <target name=\"flags\">\n\n    <!-- JDK flags -->\n    <available property=\"jdk.1.2.present\" classname=\"java.util.HashMap\" />\n    <available property=\"jdk.1.3.present\"\n     classname=\"java.lang.reflect.Proxy\" />\n    <available property=\"jdk.1.4.present\" classname=\"java.nio.Buffer\" />\n\n    <!-- Ant flags -->\n    <available property=\"style.available\"\n     classname=\"org.apache.tools.ant.taskdefs.optional.TraXLiaison\" />\n\n    <!-- Class availability flags -->\n    <condition property=\"jaxp.present\">\n      <and>\n        <available classname=\"javax.xml.parsers.SAXParser\"\n         classpath=\"${xerces.jar}\" />\n        <available classname=\"org.xml.sax.ContentHandler\"\n         classpath=\"${xerces.jar}\" />\n      </and>\n    </condition>\n    <available property=\"jmx.present\"\n     classname=\"javax.management.MBeanServer\"\n     classpath=\"${jmx.jar}\" />\n    <available property=\"modeler.present\"\n     classname=\"org.apache.commons.modeler.Registry\"\n     classpath=\"${commons-modeler.jar}\"/>\n    <available property=\"servlet.present\"\n     classname=\"javax.servlet.Servlet\"\n     classpath=\"${servlet.jar}\" />\n    <available property=\"struts.present\"\n     classname=\"org.apache.struts.action.ActionForm\"\n     classpath=\"${struts.jar}\" />\n    <available property=\"beanutils.present\"\n    \tclassname=\"org.apache.commons.beanutils.PropertyUtils\"\n    \tclasspath=\"${common-beanutils.jar}\" />\n\n    <!-- JAR files availability flags -->\n    <available property=\"jmx.jar.present\"   file=\"${jmx.jar}\" />\n    <available property=\"modeler.jar.present\" file=\"${commons-modeler.jar}\" />\n    <available property=\"servlet.jar.present\" file=\"${servlet.jar}\" />\n    <available property=\"struts.jar.present\"  file=\"${struts.jar}\" />\n    <available property=\"beanutils.jar.present\" file=\"${commons-\nbeanutils.jar}\" />\n\n    <!-- Conditional compilation flags (determined from the flags above) -->\n    <condition property=\"compile.admin\">\n      <or>\n        <equals arg1=\"${full.dist}\" arg2=\"on\" />\n        <and>\n          <equals arg1=\"${struts.present}\" arg2=\"true\" />\n          <equals arg1=\"${jmx.present}\" arg2=\"true\" />\n          <equals arg1=\"${modeler.present}\" arg2=\"true\" />\n          <available file=\"${struts.lib}/struts-bean.tld\" />\n          <available file=\"${struts.lib}/struts-html.tld\" />\n          <available file=\"${struts.lib}/struts-logic.tld\" />\n        </and>\n      </or>\n    </condition>\n\n    <!-- Conditional copy flags (determined from the flags above) -->\n    <condition property=\"copy.struts.jar\">\n      <or>\n        <equals arg1=\"${full.dist}\" arg2=\"on\" />\n        <equals arg1=\"${struts.jar.present}\" arg2=\"true\" />\n      </or>\n    </condition>\n\n  </target>\n\n\n  <!-- =================== BUILD: Set compile flags ======================= -->\n  <target name=\"flags.display\" depends=\"flags\" unless=\"flags.hide\">\n\n    <echo message=\"--- Build environment for Tomcat Server Configuration \nApplication ---\" />\n\n    <echo message=\"If ${property_name} is displayed, then the property is not \nset)\" />\n\n    <echo message=\"--- Build options ---\" />\n    <echo message=\"full.dist=${full.dist}\" />\n    <echo message=\"build.sysclasspath=${build.sysclasspath}\" />\n    <echo message=\"compile.debug=${compile.debug}\" />\n    <echo message=\"compile.deprecation=${compile.deprecation}\" />\n    <echo message=\"compile.optimize=${compile.optimize}\" />\n\n    <echo message=\"--- Ant Flags ---\" />\n    <echo message=\"&lt;style&gt; task available (required)\n=${style.available}\" />\n\n    <echo message=\"--- JDK ---\" />\n    <echo message=\"jdk.1.2.present=${jdk.1.2.present}\" />\n    <echo message=\"jdk.1.3.present=${jdk.1.3.present}\" />\n    <echo message=\"jdk.1.4.present=${jdk.1.4.present}\" />\n\n    <echo message=\"--- Required Libraries ---\" />\n    <echo message=\"jaxp.present=${jaxp.present}\" />\n    <echo message=\"jmx.present=${jmx.present}\" />\n    <echo message=\"modeler.present=${modeler.present}\" />\n    <echo message=\"servlet.present=${servlet.present}\" />\n\n    <echo message=\"--- Required JARs ---\" />\n    <echo message=\"jmx.jar.present=${jmx.jar.present}\" />\n    <echo message=\"modeler.jar.present=${modeler.jar.present}\" />\n    <echo message=\"servlet.jar.present=${servlet.jar.present}\" />\n    <echo message=\"struts.jar.present=${struts.jar.present}\" />\n\t\t<echo \nmessage=\"beanutils.jar.present=${beanutils.jar.present}\" />\n\n    <echo message=\"--- Optional JARs ---\" />\n\n    <echo message=\"--- Conditional compilation flags ---\" />\n    <echo message=\"compile.admin=${compile.admin}\" />\n\n    <echo message=\"--- Distribution flags ---\" />\n    <echo message=\"copy.struts.jar=${copy.struts.jar}\" />\n\n  </target>\n\n\n  <!-- ======================== BUILD: Copy JARs ========================== -->\n  <target name=\"copy-struts.jar\" if=\"struts.present\">\n    <copy todir=\"${webapps.build}/${webapp.name}/WEB-INF/lib\" \nfile=\"${struts.jar}\"/>\n    <copy todir=\"${webapps.build}/${webapp.name}/WEB-INF\" \nfile=\"${struts.lib}/struts-bean.tld\"/>\n    <copy todir=\"${webapps.build}/${webapp.name}/WEB-INF\" \nfile=\"${struts.lib}/struts-html.tld\"/>\n    <copy todir=\"${webapps.build}/${webapp.name}/WEB-INF\" \nfile=\"${struts.lib}/struts-logic.tld\"/>\n  </target>\n\n\n  <!-- =================== BUILD: Create Directories ====================== -->\n  <target name=\"build-prepare\">\n    <mkdir dir=\"${webapps.build}\"/>\n    <mkdir dir=\"${webapps.build}/${webapp.name}\"/>\n    <mkdir dir=\"${webapps.build}/${webapp.name}/WEB-INF\"/>\n    <mkdir dir=\"${webapps.build}/${webapp.name}/WEB-INF/classes\"/>\n    <mkdir dir=\"${webapps.build}/${webapp.name}/WEB-INF/lib\"/>\n  </target>\n\n\n  <!-- ================ BUILD: Copy Static Files ========================== -->\n  <target name=\"build-static\" depends=\"flags,flags.display,build-prepare,copy-\nstruts.jar\">\n    <copy todir=\"${webapps.build}/${webapp.name}\">\n      <fileset dir=\".\">\n        <exclude name=\"build.*\"/>\n        <exclude name=\"**/*.java\"/>\n      </fileset>\n    </copy>\n    <copy tofile=\"${webapps.build}/${webapp.name}/WEB-\nINF/classes/org/apache/webapp/admin/ApplicationResources.properties\" \nfile=\"${webapps.build}/${webapp.name}/WEB-\nINF/classes/org/apache/webapp/admin/ApplicationResources_en.properties\">\n    </copy>\n  </target>\n\n\n  <!-- ================= BUILD: Compile Server Components ================= -->\n  <target name=\"build-main\" depends=\"build-static\" if=\"compile.admin\">\n\n    <javac   srcdir=\"WEB-INF/classes\"\n             destdir=\"${webapps.build}/${webapp.name}/WEB-INF/classes\"\n             debug=\"${compile.debug}\" deprecation=\"${compile.deprecation}\"\n             optimize=\"${compile.optimize}\"\n             excludes=\"**/CVS/**\">\n      <classpath refid=\"admin.classpath\" />\n    </javac>\n\n  </target>\n\n\n  <!-- ==================== BUILD: Rebuild Everything ===================== -->\n  <target name=\"all\" depends=\"build-clean,build-main\"\n   description=\"Clean and build admin webapp\"/>\n\n\n  <!-- ======================= BUILD: Clean Directory ===================== -->\n  <target name=\"build-clean\">\n    <delete dir=\"${webapps.build}\"/>\n  </target>\n\n\n  <!-- ======================= DIST: Create Directories =================== -->\n  <target name=\"dist-prepare\">\n    <mkdir dir=\"${webapps.dist}\"/>\n  </target>\n\n\n  <!-- ======================= DIST: Create Distribution Files ============ -->\n  <target name=\"dist\" depends=\"build-main,dist-prepare\"\n   description=\"Create admin webapp binary distribution\">\n      <jar   jarfile=\"${webapps.dist}/${webapp.name}.war\"\n             basedir=\"${webapps.build}/${webapp.name}\" includes=\"**\"/>\n  </target>\n\n\n  <!-- ======================= DIST: Clean Directory ====================== -->\n  <target name=\"dist-clean\">\n    <deltree dir=\"${dist.dir}\"/>\n  </target>\n\n\n  <!-- ====================== Convenient Synonyms ========================= -->\n  <target name=\"clean\" depends=\"build-clean,dist-clean\"\n   description=\"Clean build and dist directories\"/>\n\n\n</project>\n--- end of build.xml ---"}, {"count": 1, "attachment_id": 2257, "creator": "andrewconrad@msn.com", "text": "Created attachment 2257\nnew admin build.xml", "id": 18980, "time": "2002-07-03T22:17:16Z", "bug_id": 10458, "creation_time": "2002-07-03T22:17:16Z", "tags": [], "is_private": false}, {"count": 2, "tags": [], "bug_id": 10458, "text": "Created attachment 2258\nnew org.apache.webapp.admin.AttributeTag.java file", "id": 18981, "time": "2002-07-03T22:19:40Z", "creator": "andrewconrad@msn.com", "creation_time": "2002-07-03T22:19:40Z", "is_private": false, "attachment_id": 2258}, {"count": 3, "attachment_id": 2261, "creator": "andrewconrad@msn.com", "text": "Created attachment 2261\nPatch for  webapp/admin/build.xml", "id": 19017, "time": "2002-07-04T21:14:38Z", "bug_id": 10458, "creation_time": "2002-07-04T21:14:38Z", "tags": [], "is_private": false}, {"count": 4, "tags": [], "creator": "andrewconrad@msn.com", "attachment_id": 2262, "id": 19018, "time": "2002-07-04T21:16:41Z", "bug_id": 10458, "creation_time": "2002-07-04T21:16:41Z", "is_private": false, "text": "Created attachment 2262\nPatch for org.apache.webapp.admin.AttributeTag.java"}, {"count": 5, "attachment_id": null, "creator": "amyroh@apache.org", "is_private": false, "id": 21185, "time": "2002-08-16T22:27:31Z", "bug_id": 10458, "creation_time": "2002-08-16T22:27:31Z", "tags": [], "text": "I applied the patches, however, the bug still appears in IE5+.  I removed the \nfocus attribute from the three files and the bug no longer exists. "}, {"count": 6, "tags": [], "bug_id": 10458, "attachment_id": null, "text": "The patches were only if you decided to use Struts 1.1B2 with a nightly build \nafter 20020624.  But since it is still in beta, that doesn't seem like a good \nchoice.  Thanks", "id": 21186, "time": "2002-08-16T22:54:00Z", "creator": "andrewconrad@msn.com", "creation_time": "2002-08-16T22:54:00Z", "is_private": false}]