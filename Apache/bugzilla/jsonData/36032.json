[{"count": 0, "tags": [], "text": "The problem manifests when CFLAGS is defined to contain -Wall, then\nconfigure run on Linux fails to detect glibc2 style of gethostbyname_r()\n(neither getnameinfo() nor getaddrinfo() available, like with\n-Dgetnameinfo=xx1 -Dgetaddrinfo=xx2) \n\nAs a result, sockaddr.c compilation fails (due to unmatched number\nof arguments vs. gethostbyname_r's prototype).\n\nSynopsis:\n./configure produces:\nchecking style of gethostbyname_r routine... none\n\n./srclib/apr/config.log:\nconfigure:40481: checking style of gethostbyname_r routine\nconftest.c:19: warning: second argument of 'main' should be 'char **'\nconfigure: failed or warning program:\n#include \"confdefs.h\"\n\n#ifdef HAVE_SYS_TYPES_H\n#include <sys/types.h>\n#endif\n#ifdef HAVE_NETINET_IN_H\n#include <netinet/in.h>\n#endif\n#ifdef HAVE_ARPA_INET_H\n#include <arpa/inet.h>\n#endif\n#ifdef HAVE_NETDB_H\n#include <netdb.h>\n#endif\n#ifdef HAVE_STDLIB_H\n#include <stdlib.h>\n#endif\n\nint main(int argc, const char * const argv) {\n\nint tmp = gethostbyname_r((const char *) 0, (struct hostent *) 0,\n                          (char *) 0, 0, (struct hostent **) 0, &tmp);\n\n; return 0; }\nconfigure:40534: result: none\n\nReason:\nBAD main() prototyping is coming from:\n\n./srclib/apr/build/apr_common.m4:466:\nint main(int argc, const char * const argv[])\n\nwith the square brakets get stripped.\n\n\nCORRECTION NEEDED:\nProper escaping of the square brakets to be preserved for argv.\n\n\n2.0.52 has exactly the same problem, and I did not check how\ndeep in revision history the problem goes..", "is_private": false, "bug_id": 36032, "id": 78127, "time": "2005-08-04T22:29:20Z", "creator": "lavr@ncbi.nlm.nih.gov", "creation_time": "2005-08-04T22:29:20Z", "attachment_id": null}, {"count": 1, "tags": [], "bug_id": 36032, "attachment_id": null, "text": "Thanks for the report.  It's clearly a bug, but you should not really be putting\n-Wall in CFLAGS in the first place - put it in NOTEST_CFLAGS instead.", "id": 78139, "time": "2005-08-05T10:16:49Z", "creator": "jorton@redhat.com", "creation_time": "2005-08-05T10:16:49Z", "is_private": false}, {"count": 2, "tags": [], "text": "Committed revision 382560.\nFixed.", "is_private": false, "bug_id": 36032, "id": 86421, "time": "2006-03-03T00:25:22Z", "creator": "maxb@apache.org", "creation_time": "2006-03-03T00:25:22Z", "attachment_id": null}]