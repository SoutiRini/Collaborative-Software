[{"count": 0, "attachment_id": null, "bug_id": 24005, "text": "Consider a plain text file that responds to HEAD with:\n\n200\nETag: W/\"66-1066832095456\"\nLast-Modified: Wed, 22 Oct 2003 14:14:55 GMT\nContent-Type: text/plain\nContent-Length: 66\nDate: Wed, 22 Oct 2003 14:16:44 GMT\nServer: Apache Coyote/1.0\n\nHowever PROPFIND returns:\n\n1) <getcontentlanguage>de_DE</getcontentlanguage>\n2) <getcontenttype>null</getcontenttype>\n3) <getetag>66-1066832095456</getetag>\n\nRe 1) If the content language is unknown, the DAV:getcontentlaguage header\nshould not be present. That's better than defaulting to a value which will be\nwrong in many cases.\n\nRe 2) If the content type is unknown, don't return the property. However, in\nthis case it seems that the server knows it (see HEAD response), thus the\nproperty value should be the same.\n\nRe 3) RFC2518 says that the value of DAV:getetag should be whatever GET/HEAD\nreturn -- in this case quoting and the weakness indicator ('W/') are missing.", "id": 46058, "time": "2003-10-22T14:26:06Z", "creator": "julian.reschke@gmx.de", "creation_time": "2003-10-22T14:26:06Z", "tags": [], "is_private": false}, {"count": 1, "tags": [], "bug_id": 24005, "attachment_id": null, "text": "I have had a look at this with partial success.\n1) The default servlet never returns langauge information, so I have removed \nreturning the language from the webdav servlet.\n3) The webdav servlet had its own, less complete, method for determining the \netag. I have removed this and modified the webdav servlet to use the default \nservlet implementation.\n\n2) I have double-checked the code and all the places where content-type is \nreturned (unless it is a null-resource where null is returned) uses exactly \nthe same method as the default servlet. I can't figure this one out. Could you \ndouble check it? A example web-app that reproduces the problem would be a big \nhelp so I can debug it and trace the source.\n\nI'll attach a patch that addresses 1 & 3.\n", "id": 47412, "time": "2003-11-15T22:45:32Z", "creator": "medthomas@ntlworld.com", "creation_time": "2003-11-15T22:45:32Z", "is_private": false}, {"count": 2, "tags": [], "bug_id": 24005, "text": "Created attachment 9129\nPartial TC5 patch", "id": 47413, "time": "2003-11-15T22:47:01Z", "creator": "medthomas@ntlworld.com", "creation_time": "2003-11-15T22:47:01Z", "is_private": false, "attachment_id": 9129}, {"count": 3, "tags": [], "bug_id": 24005, "text": "ok, here's a recipe to reproduce issue 2 (tested with 4.1.29):\n\n- install tomcat\n- enable write access on webdav\n- connect Microsoft webfolder\n- copy a file with no extension to /webdav/ (this causes a PUT request with not \ncontent-type header)\n- PROPFIND on the resulting resource", "id": 47424, "time": "2003-11-16T12:12:08Z", "creator": "julian.reschke@gmx.de", "creation_time": "2003-11-16T12:12:08Z", "is_private": false, "attachment_id": null}, {"count": 4, "tags": [], "bug_id": 24005, "attachment_id": null, "text": "I have just check this with both TC4 and TC5 and the content type header is \nnot returned. I have been having problems with the MS webfolders so I have \nbeen using telnet and I am 100% certain that the content-type header is not \nincluded in the response to HEAD in the circumstances you describe in 2.", "id": 47431, "time": "2003-11-16T16:54:50Z", "creator": "medthomas@ntlworld.com", "creation_time": "2003-11-16T16:54:50Z", "is_private": false}, {"count": 5, "tags": [], "creator": "julian.reschke@gmx.de", "text": "Maybe that's correct for HEAD, but I was doing a PROPFIND.\n", "id": 47433, "time": "2003-11-16T17:28:02Z", "bug_id": 24005, "creation_time": "2003-11-16T17:28:02Z", "is_private": false, "attachment_id": null}, {"count": 6, "tags": [], "bug_id": 24005, "text": "Sorry, I didn't make myself clear in my last comment. The point I was trying \nto make was that HEAD didn't return a content-type header. Anyway, I have \nmodified the return from PROPFIND so content-type is returned if it is null. \nThis fix is included in the patch in 23999.\n\nA complete patch for this bug (and 23999, 24001) is attached to bug23999.", "id": 47731, "time": "2003-11-20T21:26:02Z", "creator": "medthomas@ntlworld.com", "creation_time": "2003-11-20T21:26:02Z", "is_private": false, "attachment_id": null}, {"count": 7, "tags": [], "bug_id": 24005, "attachment_id": null, "text": "The necessary changes have been committed to CVS and will be included in the \nnext release.", "id": 48864, "time": "2003-12-10T21:39:37Z", "creator": "medthomas@ntlworld.com", "creation_time": "2003-12-10T21:39:37Z", "is_private": false}]