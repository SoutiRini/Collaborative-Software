[{"count": 0, "tags": [], "bug_id": 53752, "attachment_id": 29257, "text": "Created attachment 29257\ntomcat.log\n\nDuring the load test Tomcat restarts, with error :java.lang.ArrayIndexOutOfBoundsException: -60\nINFO: Initialization processed in 501 ms\nAug 17, 2012 1:58:08 PM org.apache.catalina.core.StandardService start\nINFO: Starting service TspWebGui\nAug 17, 2012 1:58:08 PM org.apache.catalina.core.StandardEngine start\nINFO: Starting Servlet Engine: Apache Tomcat/6.0.24\nAug 17, 2012 1:58:08 PM org.apache.catalina.startup.HostConfig deployWAR\nINFO: Deploying web application archive tsp.war\nAug 17, 2012 1:58:08 PM org.apache.coyote.http11.Http11Protocol start\nINFO: Starting Coyote HTTP/1.1 on http-9099\nAug 17, 2012 1:58:08 PM org.apache.catalina.startup.Catalina start\nINFO: Server startup in 354 ms\nAug 17, 2012 2:15:42 PM org.apache.coyote.http11.Http11Processor process\nSEVERE: Error finishing request\njava.lang.ArrayIndexOutOfBoundsException: -60\n\tat org.apache.coyote.http11.filters.ChunkedInputFilter.parseChunkHeader(ChunkedInputFilter.java:284)\n\tat org.apache.coyote.http11.filters.ChunkedInputFilter.doRead(ChunkedInputFilter.java:132)\n\tat org.apache.coyote.http11.filters.ChunkedInputFilter.end(ChunkedInputFilter.java:189)\n\tat org.apache.coyote.http11.InternalInputBuffer.endRequest(InternalInputBuffer.java:336)\n\tat org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:886)\n\tat org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)\n\tat org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)\n\tat java.lang.Thread.run(Thread.java:662)\n\nAttached the tomcat.log file.", "id": 161555, "time": "2012-08-21T09:52:46Z", "creator": "thyag_020@yahoo.co.in", "creation_time": "2012-08-21T09:52:46Z", "is_private": false}, {"count": 1, "text": "Can this really be CRITICAL if it hasn't been identified in the 10 releases since 6.0.24 what you are using?\n\nYour log file is useless: it contains nothing other than your CLASSPATH and the stack trace you already provided. At least it confirms you are using a very old version of Tomcat 6: 6.0.24 (2.5 years old).\n\nPlease re-test with 6.0.latest. If you can still get it to crash, attach a minimal webapp (or better yet, use the examples webapp that ships with Tomcat) and a JMeter configuration file (or similar) so we can reproduce the crash. Then you can mark it as CRITICAL.", "bug_id": 53752, "is_private": false, "id": 161753, "time": "2012-08-27T22:12:53Z", "creator": "chris@christopherschultz.net", "creation_time": "2012-08-27T22:12:53Z", "tags": [], "attachment_id": null}, {"count": 2, "text": "> During the load test Tomcat restarts\n\nWhat do you mean by \"restarts\"? Tomcat cannot restart itself.\n\nThe restart process is not reflected in your log file, as Christopher correctly noted.\n\n\n> java.lang.ArrayIndexOutOfBoundsException: -60\n\nThe exception is caused by invalid request data. Tomcat should have rejected it silently. Does your testing framework notice that Tomcat has been restarted?\n\nAIOOBE also causes the request to be rejected, so besides the nasty log message the behaviour does not differ much from the intended one.\n\nI'll fix the AIOOBE. Thank you for the report.\n\nI am closing this report as DUPLICATE, as there has been an earlier report for this issue.\n\n*** This bug has been marked as a duplicate of bug 42181 ***", "bug_id": 53752, "attachment_id": null, "id": 161758, "time": "2012-08-27T22:54:41Z", "creator": "knst.kolinko@gmail.com", "creation_time": "2012-08-27T22:54:41Z", "tags": [], "is_private": false}, {"count": 3, "tags": [], "creator": "thyag_020@yahoo.co.in", "attachment_id": null, "is_private": false, "id": 161802, "time": "2012-08-29T04:41:26Z", "bug_id": 53752, "creation_time": "2012-08-29T04:41:26Z", "text": ">>Does your testing framework notice that Tomcat has been restarted?\nyes our framework sees that Tomcat is not stable and i will restart tomcat.\n\nBelow are the logs from our framework, where it check for status of tomcat at regular intervals and if the service is not consistent it will restart.\n27-08-2012 18:24:52  119-70    information  \"TSP:atcacscfn16.RtpSnm01: RtpTomcatCheck -p 99 exits with ExitCode = 102\"\n27-08-2012 18:24:52  119-49    warning      \"TSP:atcacscfn16.RtpSnm01: Subsystem TOMCAT (Id=7) detector failed - ExitCode = 102\"\n27-08-2012 18:24:52  119-8     minor        \"TSP:atcacscfn16.RtpSnm01: Restart required for subsystem TOMCAT - Exitcode = 102\"\n\n27-08-2012 18:25:39  119-6     clear        \"TSP:atcacscfn16.RtpSnm01: Subsystem TOMCAT successfully stopped\"\n27-08-2012 18:25:45  119-3     clear        \"TSP:atcacscfn16.RtpSnm01: Subsystem TOMCAT successfully started\"\n\nmore information about the testcase.\nCodenomicon is a well known Commercial robustness testing tool available for various protocols. While running Codenomicom Diameter Server suite (which sends both valid and invalid malicious Diameter messages to test the robustness of the Diameter interface), the tomcat subsystem which hosts Platforms TSP GUI goes for restart. During this time TSP GUI access fails. During a long run of the codenomicon suite it is observed that the tomcat process restarts.\n\nThe testcase or the test case group where the issue is noticed is as below:\n\n==================================\n#260820\nIndex\n\u2190 260820 \u2192\nGroup\nhttp-suite.regular-payload.http-request.request.http-request-header.main-req-headers.link.uri.absoluteuri.hier_part.abs_path.rel_path.query.uric.unreserved.extra.\nAnomaly\nRepeat of 8 octets: '\\'' 0x00\nCategory\nOverflow CWE-633 CWE-150 CWE-138 CWE-122 CWE-120 CWE-119 CWE-118 CWE-20 CWE-19 CWE-18 CWE-17\nHash\n0x3FAF3B685873AEB\nScores\nAttack Modifier = +50 CVSS/BS = 10.0 (components)\n\n HTTP Request [with anomaly]\n \n 000000 \nGET\u2022/\u2022HTTP/1.1\\r\\n\n 000010 \nHost:\u2022www.example.com\\r\\n\n 000027 \nUser-Agent:\u2022HTTP\u2022Test\u2022Suite\u2022(X11;\u2022U;\u2022Linux\u2022x86_32;\u2022en-US;\u2022rv:1.8.0.10)\\r\\n\n 00006f \nAccept:\u2022text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5\\r\\n\n 0000dc \nAccept-Language:\u2022en-us,en;q=0.5\\r\\n\n 0000fd \nAccept-Encoding:\u2022gzip,deflate\\r\\n\n 00011c \nAccept-Charset:\u2022ISO-8859-1,utf-8;q=0.7,*;q=0.7\\r\\n\n 00014c \nKeep-Alive:\u2022300\\r\\n\n 00015d \nConnection:\u2022keep-alive\\r\\n\n 000175"}, {"count": 4, "tags": [], "bug_id": 53752, "attachment_id": null, "text": " You are confusing multiple issues.\n\nThe first issue is the  invalid request triggers an exception. This was logged and is now silently swallowed. That is a minor cosmetic issue.\n\nThe second issue is that *your* framework detects that Tomcat is \"not stable\" and *you* then restart Tomcat. Based on the limited information provided here, there is no Tomcat issue.\n\nYou have provided no information that defines \"not stable\" nor have you provided any information on how to trigger this condition. The processing of the invalid request (with or without the message in the logs) certainly does not meet any definition of \"not stable\" that the Tomcat developers accept.", "id": 162227, "time": "2012-09-17T07:25:05Z", "creator": "markt@apache.org", "creation_time": "2012-09-17T07:25:05Z", "is_private": false}, {"count": 5, "tags": [], "bug_id": 53752, "attachment_id": null, "id": 162241, "time": "2012-09-18T11:38:57Z", "creator": "thyag_020@yahoo.co.in", "creation_time": "2012-09-18T11:38:57Z", "is_private": false, "text": "Hi,\n\nThere are no two issues reported.\nits all the same issue: tomcat is inconsistent and it is restarted.\nRtpTomcatCheck -p 99 is a script which runs perodically for tomcat when the exitcode is not 0, it will restart.\n\nbelow are the log when the check is done using RtpTomcatCheck.\nI felt that this have no connection with this issue, so i did not provide earlier.\n\n2012/07/27-20:47:19 RtpTomcatCheck started\n2012/07/27-20:47:19 readFromPipe entered\n2012/07/27-20:47:19 readFromPipe: totalBytesRead 5\n2012/07/27-20:47:19 pkgparam: bytes read from pipe: 5\n2012/07/27-20:47:19 pkgparam, return: 9000\n2012/07/27-20:47:19 Webserver port: 9099\n2012/07/27-20:47:19 Check timeout : 10\n2012/07/27-20:47:19 Retry count   : 1\n2012/07/27-20:47:19 Retry period  : 10\n2012/07/27-20:47:19 ---\n2012/07/27-20:47:19 Webserver check #1\n2012/07/27-20:47:19 Connect call failed: 111 [Connection refused]\n2012/07/27-20:47:19 Could not establish connection to webserver\n2012/07/27-20:47:19 Webserver check failed, trying SSL Webserver check\n2012/07/27-20:47:19 before SSL_library_init()\n2012/07/27-20:47:19 before BIO_do_connect() to localhost:9099\n2012/07/27-20:47:19 Error connecting to SSL server\n2012/07/27-20:47:19 Reason:\n[pid]:error:[error code]:[library name]:[function name]:[reason string]:[file name]:[line]:[optional text message]\n4151228152:error:0200206F:system library:connect:Connection refused:bss_conn.c:269:host=localhost:9099\n4151228152:error:20073067:BIO routines:CONN_STATE:connect error:bss_conn.c:273:\n2012/07/27-20:47:19 before BIO_free_all()\n2012/07/27-20:47:19 Giving up: All webserver checks failed\n2012/07/27-20:47:19 exit status = 102"}]