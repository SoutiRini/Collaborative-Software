[{"count": 0, "tags": [], "text": "For Windows JVM's that return \"Windows Server 2003\" as their os.name property,\nant gets confused and thinks it's an Win9x box.  Then it tries to exec\n\"command.com\" instead of \"cmd.exe\", causing an error.\n\nThe following small change in org/apache/tools/ant/taskdefs/condition/Os.java\nis a workaround.  A mild kludge that's good enough for this century (or until\nthey re-brand windows again...) =)\n\n\n223c223\n<                           osName.indexOf(\"20\") >= 0 ||\n---\n>                           osName.indexOf(\"2000\") >= 0 ||", "is_private": false, "id": 30360, "creator": "jolly.chen@bea.com", "time": "2003-01-30T17:47:05Z", "bug_id": 16611, "creation_time": "2003-01-30T17:47:05Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 16611, "is_private": false, "count": 1, "id": 30369, "time": "2003-01-30T19:19:42Z", "creator": "stevel@apache.org", "creation_time": "2003-01-30T19:19:42Z", "text": "aha, it looks like the successor to the Windows XP Java1.4 bug has\nsurfaced...the patch to this should be something we ought to get into ant1.5.2\nbefore anyone else notices.\n\nJolly, What version of Java are you running? Also, what happens on a build file\nwith the  <property env=\"env\" /> declaration?"}, {"count": 2, "tags": [], "bug_id": 16611, "attachment_id": null, "id": 30374, "time": "2003-01-30T20:10:45Z", "creator": "jolly.chen@bea.com", "creation_time": "2003-01-30T20:10:45Z", "is_private": false, "text": "I'm running a pre-release version of BEA's JRockit.  We will be returning the\nos.name string of \"Windows Server 2003\" as I imagine a number of other VMs will\nas well.\n\nIn fact, we found the problem because our build file croaked on <property\nenvironment=\"env\"/>    It generated a java.io.FileNotFoundException because \norg.apache.tools.ant.taskdefs.Execute$Java13CommandLauncher.exec was trying to\nfork an \"command.com\" to determine the environment variables.  That's how I\ntracked it down to Os.java and saw the explicit check for nt/2000/xp in the name.\n\n"}, {"count": 3, "tags": [], "creator": "stevel@apache.org", "attachment_id": null, "id": 30380, "time": "2003-01-30T20:58:37Z", "bug_id": 16611, "creation_time": "2003-01-30T20:58:37Z", "is_private": false, "text": "the short term hack is as you suggest. The smarter approach would be to fallback\nto command.com, or better yet, probe for it somehow (which will be hard, until\nwe can get at the environment).\n\nyou know if all the JVMs re-enabled getenv() life would be much simpler :)\n"}, {"count": 4, "tags": [], "text": "I wonder, I wonder if there is a way in java we can probe the OS to see what OS\nit really is. \n\nAlternatively, since the win9x lineup is frozen, if we work out what versions of\nwindows 9x we can see, all others have to be the nt family (ignoring WinCE).\nRight now we default to win9x, which is not the most robust solution.\n\nFor now maybe I'll just add the 2003 test, or the \"20\" test -what do people think?", "is_private": false, "id": 30390, "creator": "stevel@apache.org", "time": "2003-01-31T06:38:32Z", "bug_id": 16611, "creation_time": "2003-01-31T06:38:32Z", "attachment_id": null}, {"attachment_id": null, "tags": [], "bug_id": 16611, "is_private": false, "count": 5, "id": 30435, "time": "2003-01-31T16:38:13Z", "creator": "alexeys@inventigo.com", "creation_time": "2003-01-31T16:38:13Z", "text": "Maybe cmd.exe should be a default shell for unknown Windows systems, since\nWindows 9X is not developed any more. The fix could just change default shell."}, {"count": 6, "tags": [], "bug_id": 16611, "attachment_id": null, "id": 30436, "time": "2003-01-31T16:51:38Z", "creator": "snewton@io.com", "creation_time": "2003-01-31T16:51:38Z", "is_private": false, "text": "Agree 100% with  Alexey Solofnenko's suggestion on changing the default. \nWindows 95 has been EOL'd and 98 will be on June 30, 2004. \nhttp://www.microsoft.com/windows/lifecycle/desktop/business/default.mspx"}, {"count": 7, "tags": [], "creator": "jolly.chen@bea.com", "attachment_id": null, "is_private": false, "id": 30437, "time": "2003-01-31T17:58:14Z", "bug_id": 16611, "creation_time": "2003-01-31T17:58:14Z", "text": "agree on the change of default.  Anyone who's doing serious java development on\nWin9x is probably not a happy camper anyway... =)\n\nSince there are also hardcoded executable names for the other platforms (e.g.\n/bin/env, /usr/bin/env), it might be nice to factor that somehow so it can be\noverridden at runtime.  As of now, if Execute.getProcEnvCommand() can't figure\nout the Os family, it falls through to a null string which almost certainly will\nbomb."}, {"count": 8, "tags": [], "creator": "stevel@apache.org", "attachment_id": null, "is_private": false, "id": 30438, "time": "2003-01-31T18:08:36Z", "bug_id": 16611, "creation_time": "2003-01-31T18:08:36Z", "text": "yes, we should check for the null string. \n\nTo probe for win9x we need a list of all OS responses we can get on the win9x\nproduct line: '95, '95OSR2, '98, '98se, winME. Is there a listing somewhere?"}, {"count": 9, "tags": [], "text": "OK, there is a completely dumb fix in CVS now, so that 1.5.2 will be without this\nproblem, but we certainly need a better solution.\n\nThis is why I don't close the report.", "attachment_id": null, "id": 30823, "creation_time": "2003-02-06T16:29:14Z", "time": "2003-02-06T16:29:14Z", "creator": "bodewig@apache.org", "bug_id": 16611, "is_private": false}, {"count": 10, "tags": [], "text": "Degrading to enhancement as the immediate problem is fixed (but only for 2003).", "is_private": false, "id": 31517, "creation_time": "2003-02-18T14:23:05Z", "time": "2003-02-18T14:23:05Z", "creator": "bodewig@apache.org", "bug_id": 16611, "attachment_id": null}, {"count": 11, "tags": [], "text": "With nightly build 2003-05-31 the logic has been reversed from \"I know all variants\nwith cmd.exe\" to \"I know all variants with command.com\".\n\nWhat needs to be proven now, is that this list is both complete and doesn't\ncontain versions that have cmd.exe.  At least it will mean that new Windows\nversions will be considered as cmd.exe flavors.", "is_private": false, "id": 38032, "creator": "bodewig@apache.org", "time": "2003-05-30T09:33:59Z", "bug_id": 16611, "creation_time": "2003-05-30T09:33:59Z", "attachment_id": null}, {"count": 12, "attachment_id": null, "bug_id": 16611, "is_private": false, "id": 143080, "time": "2011-01-05T03:53:32Z", "creator": "bodewig@apache.org", "creation_time": "2011-01-05T03:53:32Z", "tags": [], "text": "*** Bug 50542 has been marked as a duplicate of this bug. ***"}]