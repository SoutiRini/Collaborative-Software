[{"count": 0, "tags": [], "creator": "behr@postmail.ch", "attachment_id": null, "id": 59866, "time": "2004-06-25T10:17:43Z", "bug_id": 29802, "creation_time": "2004-06-25T10:17:43Z", "is_private": false, "text": "Using the Library: poi-src-2.5-final-20040302\n\nreading a XLS-File containing Images is possible. The subsequent creation of a \nXLS is possible but the file is erroneous.\n\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\n\nimport org.apache.poi.hssf.usermodel.HSSFCell;\nimport org.apache.poi.hssf.usermodel.HSSFRow;\nimport org.apache.poi.hssf.usermodel.HSSFSheet;\nimport org.apache.poi.hssf.usermodel.HSSFWorkbook;\nimport org.apache.poi.poifs.filesystem.POIFSFileSystem;\n\n\npublic class ReadWriteWorkbook {\n\tpublic static void main(String[] args) throws IOException {\n\t\tString fp= File.separator;\n\t\t\n\t\tString file = \"someFile.xls\";\n\t\t\n\t\tPOIFSFileSystem fs = new POIFSFileSystem(new FileInputStream\n(file));\n\t\tHSSFWorkbook wb = new HSSFWorkbook(fs);\n\t\t\n\t\tHSSFSheet sheet = wb.getSheetAt(0);\n\t\tHSSFRow row = sheet.getRow(0);\n\t\t\n\t\tif (row == null)\n\t\t\trow = sheet.createRow(0);\n\t\tHSSFCell cell = row.getCell((short) 0);\n\t\tif (cell == null)\n\t\t\tcell = row.createCell((short) 0);\n\t\tcell.setCellType(HSSFCell.CELL_TYPE_STRING);\n\t\tcell.setCellValue(\"a test\");\n\n\t\t// Write the output to a file\n\t\tFileOutputStream fileOut = new FileOutputStream(\"workbook.xls\");\n\t\twb.write(fileOut);\n\t\tfileOut.close();\n\n\t}\n}"}, {"count": 1, "tags": [], "creator": "zalewski@optonline.net", "attachment_id": null, "id": 59887, "time": "2004-06-25T16:48:38Z", "bug_id": 29802, "creation_time": "2004-06-25T16:48:38Z", "is_private": false, "text": "Try the patch I described on bug 28203.\n\nOr attach an Excel file (the source) which exhibits the problem. (I.e., we \nwould need \"someFile.xls\").\n"}, {"count": 2, "tags": [], "text": "Since I've since applied this patch to REL_2_BRANCH I'm closing this.  If the\nproblem persists reopen the bug report.", "attachment_id": null, "id": 59937, "creator": "glens@apache.org", "time": "2004-06-27T11:29:41Z", "bug_id": 29802, "creation_time": "2004-06-27T11:29:41Z", "is_private": false}]