[{"count": 0, "text": "Description:\nIt appears that the field_1_index_code field in the \norg.apache.poi.hssf.record.FormatRecord class can attain a value of -1.\n \nThis causes the HSSFDataFormat to throw an ArrayIndexOutOfBoundsException on \nline 109 because the FormatRecord\u2019s field_1_index_code field is used as an \nindex into a Vector where all the FormatRecords for the workbook are stored. \n\nSteps to Reproduce:\n\nOpen the file: http://tonto.eia.doe.gov/oog/ftparea/wogirs/xls/psw14.xls and an \nArrayIndexOutOfBoundsException is thrown on line 109 of HSSFDataFormat.\n\nThis error occurs for version 2.0 and 2.5\n\nNotes:\nThe format record is read in and is stored to the Workbook on line 192 of the \norg.apache.poi.hssf.model.Workbook.java. \n\nBackGround:\nAfter reading the OpenOffice document for FormatRecord, \nhttp://sc.openoffice.org/excelfileformat.pdf, it appears that -1 is an invalid \nindex for a Format Record but I am not sure if the -1 is caused from HSSF \nincorrectly reading the Excel File or if the actual FormatRecord is stored with \nan index of -1.", "bug_id": 29262, "is_private": false, "id": 58268, "time": "2004-05-28T00:06:07Z", "creator": "lonny@ze.com", "creation_time": "2004-05-28T00:06:07Z", "tags": [], "attachment_id": null}, {"count": 1, "tags": [], "creator": "avik@apache.org", "attachment_id": null, "id": 75129, "time": "2005-05-20T13:40:58Z", "bug_id": 29262, "creation_time": "2005-05-20T13:40:58Z", "is_private": false, "text": "Could you tell us how this file was created? "}, {"count": 2, "tags": [], "text": "When i open that file URL in excel is already complains about DataFormats being\nlost.\n\nSugest that whatever generated this file (probably an early version of POI who\nknows!!!) was not generating a correct file structure.\n\nWhen i resave in excel, no exception is raised (when calling\nHSSFWorkbook.createDataFormat())\n\nJason", "is_private": false, "bug_id": 29262, "id": 91540, "time": "2006-07-24T12:52:18Z", "creator": "jheight@apache.org", "creation_time": "2006-07-24T12:52:18Z", "attachment_id": null}]